
# FOCUS: FermiOniC qUantum Simulation #

*** TODOs: New Techniques & Platforms ***
	   New Insights & Innovations 

--- Core functionalities ---

 20200219 Makefile, IO, integrals
 20200221 fock space util - onstate
 20200224 fock space util - onspace
 20200226 fock space util - hamiltonian
 20200227 linear algebra framework 
 	  - use EIGEN for the moment 
	  [not flexible for eigenvalue]
 20200227 brute-force fci for benchmark
 20200229 matrix class for 2RDM:
	  - pack/unpack indices
	  - special matrix: iden,rand 
	  - linalg: dgemm, dsyevd, dnrm2
 20200301 analysis tools:
	  - 0. sorting and printing
	  - 1. entropy measure
	  - 2. <N>, <Na>, <Nb>
	  - 3. in general, n-RDM [!!!]
 20200306 multi-state Davidson diagonalization
	  - sigma-vector formation
	  - change to COLUMN-MAJOR matrix for BLAS/LAPACK
          - dvdson algorithm 
 20200306 larger FCI problem [12o,8e: C2 ~200,000, ~500s MVP]

--- SCI ---

 20200313 efficient algorithm for direct CI 
          - substrings and coupling table
 	  - optimization [use array instead of vector for diff_orb]
          - optimization [use direct product structure in forming H]
 20200316 optimized RDM implementation 
	  - reuse information & avoid O(Ndet) call of redundant functions
 20200324 selection procedure 
	  - control the space size for large problem
	  - needs to be optimized for Fe8S7
	  - implement the TR symmetry? => add flip centers
 20200326 UHF/CC/CI support
	  - unrestricted/generalized (noncollinear) hartree-fock
 	  - integrals to interface with SCI: UHF-SCI
 20200331 pt2 util & storage/serialization:
 	  - primilinary implementation of deterministic pt2

--- TNS --- 

 Main observation: denseH as in [Fe2S2], pt2 is not sufficient unlike c2/cr2!
		   non-perturbative treatment / high-order PT?
		   more efficient capture of entanglement?

 20200405 bipartition analysis for arbitrary parition of rhos!
	  - permutation => sign
	  - bipartite entanglement analysis
	  - project rhos to local groups => optimized states!

 20200408 genetic ordering for minimizing entanglement?
	  - fielder ordering
	  - test for 2d hubbard modelï¼
	  - relevance for quantum computing, which could 
	    reduce the depth of circuits in limited topology (e.g.,1D)

 20200409 grouping orbitals - meaningful structure & interpretation!!!
	  - Coarse-Graining? Hierachical Clustering??? 
	  - Can coarse-graining improve 2D-Hubbard Model description?
	  - Possibility to reduce entanglement?

 20200410 question: what types of configurations 
		    are relevant for S-T gap in Fe2S2???

--- Comb TNS ---

 20200417 Comb structure [topology/coord/support/sweep]

 20200420 SCI as initial guess? 
          - projection for obtaining schmidt basis {|r>}
	  - optimized implementation for Fe8S7 (eigen+svd)

 20200422 build local sites:
	  - A[n]=<ln|L> for MPS: become slow at the end, 
	    because the no. of underlying dets is large! 
	  - W[n]=<r1r2|r12> for Comb: type3 nodes
	  - check right canonical form by computing overlap Sr

 20200424 central wavefunction:
	  - implement wf for the last site from SCI wf
 	  - implement <n|comb> for checking

 20200427 refactorize the tns part to make them more modular
	  - essential for future developement
	  - separate into qsym, phys, qtensor[2,3,4]
	  - implement tensor contraction kernels for qtensor
	  - checked by evaluating <Comb|Comb> 

 20200508 initialize normal & complementary operators (MOST CHALLENGING PART)
	  - data structure for operators: qtensor2
	  - operators on dot (in memory)
	  - serializaiton: -lboost_system -lboost_filesystem
	  - implement recursive build of rops (blocking & renormalization)
	    - normal operators:
	      - a_pL^+
	      - a_pL^+a_qL (checked against fci_rdm1 for <psi1|p^+q|psi2>)
	      - a_pL^+a_qL^+
	    - complementary operators:
	      - lazy construction (to be improved in future - checked):
	        - Q_pLsL^R
	        - P_pLqL^R
	      - typeAB/typePQ decomposition (to be cheked by H1e & H2e):
	        - S_pL^R
	        - H^R
	  - check by evaluating energies
	  - note: currently the adjoint is used for operators like ap,
		  hence the renorm functions work only for <comb1|o|comb2>,
		  not for <combA|o|combB> where sites are different for A,B.
		  The impelementation of state-specific transition properties
		  requires more operators to be constructed in future.
		  Also, we do not use Hermicity of Bpq/Qps, which allows to 
		  compute <rdm1|p^+q|rdm2> for state-averaged comb states.
 
 20200516 improved data structure for operators/wavefunction/decimations
	  - better data structure to handle {L,C,R} neigbors [DONE@20200510] 
	  - data structure for wavefunction (wf) [DONE@20200512]
	    - qtensor2 (with sym) : operators O
  	    - qtensor3 (with sym) : site tensor A and O*A 
	    - qtensor3 (with dir) : wf on one site 
 	  - rewrite tns_oper to put all operators in memory [DONE@20200514] 
	  - conversion among qt4,qt3,qt2 [DONE@20200515]
	  - change convention for rsite [DONE@20200516]
            - rows for renormalized states 
	    - update rcanon
	    - update alg
 	    - update operator construction

 20200525 a WORKING version of sweep algorithm [key part!]  
	  - 1. symmetry processing (depending on configuration of dots)
	       - check symmetry handling by using random wf 
 		 (no need for H*x & renorm ops)
	       - one-dot opt: only decimation is different
	       - two-dot opt: setting up qops is also different
	  - 2. different decimation schemes for sweeps [DONE@2020517]
	  - 3. universal operator renormalization (lops & rops) [DONE@20200520]
	       - general combination of two qops (lc,cr,lr)
	       - strategy for constructing operators? (P,Q,S,H)
	  - 4. hamiltonian operations: one-dot opt: Hdiag & HVec [DONE@20200522]
	       - dealing with partition and sign in OIwf/IOwf/OOwf
	       - dealing with dagger transformation such as P^+|wf>
	       - check consistency of HVec with Hdiag
          - 5. two-dot opt: Hdiag & Hvec [DONE@20200522]
          - 6. special treatment of AB|AB case (middle) [DONE@20200525]
	       - use the fact that Pwf/Qwf works in this case
	  - 7. examine the correctness by comparing against FCI on H4,6 [DONE@20200525]
	       - making MPS correct
	       - special topology 

 20200601 an IMPROVED version with more functionalities
	  - printing: discarded weight, dimension, etc. [DONE@20200527]
	  - support for state-average calculations [DONE@20200526]
	  - correct formulation of decimation in lr case,
	    checked by one-dot and two-dot opt for different topologies [DONE@20200528]
	  - noise for pRDM? |Lr> -> O_L|Lr> -> merge -> trace out |r> => |L'><L| [DONE@20200529]
	    only apply noise correction for one-dot optimizaiton!
	  - better sweep control schedule [DONE@20200529]
 	  - propogation of initial guess to next site [!]
	    - one-dot MPS: |lc>,|cr> [DONE@20200531]
	    - one-dot Comb: |lr> - special in both directions! [DONE@20200531]
	    - initial site? [DONE@20200531] 
	    - two-dot extension: first site, configurations (lc1, lr, c2r, c1r2) 
	      - elegantly done by combining the wf3 obtained from previous decimation 
		and an appropriate l/rsite on the optimized bond [DONE@20200601]

 202006xx random sampling?
	  - implement a general sampling algorithm for any comb-tns
	  - generating det according to p(n) for computing Sdiag [hardness of SCI cal]

 202006xx an OPTIMIZED version:
	  - documentation of each step in formula & diagrams
	  - prepare benchmark data
	  - faster low-level implementation: 
	    - benchmarking scalability
	    - preconstruction of P/Q from A/B to accelerate efficiency in H*v?
	    - better data structure
 	  - parallelizaiton: 
	    - different sweep schedule [backbone & branch] 
	    - naturally leads to branch-based parallelization!!!
	  - large-scale applications: fe2s2/fe4s4/fe8s7/femoco?

--- Advanced functionalities ---

 2020xxxx implement 2-rdms: restarted from fully converged comb state

 2020xxxx complex version: relativistic SCI/DMRG
	  - may require a redesign of low-level functionalities (including SCI)
	  - implementation of time-reversal symmetry for efficiency? 
 	  - g-tensor [IMPORTANT!!! - appliable for quantum computation] 
		      <Psi|sigma K|Psi>? G-matrix;
		      How <Psi1|H|Psi2> are measured?
		      For VQE this can be made symmetric,
		      <0|(U1d*H*U2)|0> - Hardmard test]

 2020xxxx operator compression?

--- FUTURE ---

 2020xxxx entanglement localizaiton of SCI wavefunction? 
	  - orbital optimization
	  - 1-body & 2-body disentanglers?
 
 2020xxxx spectra and excited states: HCI/DMRG for RIXS 
  	  - Core excitations? complex propogator? (A-w-i*gamma)x(w)=r
	  - also relevant for quantum computation

 2020xxxx exploring more compact representation of many-body wavefunctions
	  - VMC-c-MPS ansatz?
	  - Neural network states?

=============
 Note on SCI
=============

Selected CI fails in two forms:

   1. computational time increases when ci coefficients are dense!
   
   2. pt2 does not work well in providing good corrections (too small)

but it works when there is a few dominant configurations

Such situations appear in 

   a) geuine strongly correlated systems
   
   b) noninteracting molecules (while CC works) like stretched (H2)n

=========
 Targets
=========
 
   0) quantum supremacy : FeMoco?

   a) doublet benchmark sets: CO+, CN, N2+

   b) O2: SOC and ZSF testing ground!

   c) IP of gold

