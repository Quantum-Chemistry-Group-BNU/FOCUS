
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Wed Mar  1 13:15:41 2023

GIT_HASH = a92a4d9dbea92104396346a91dbd1480a627e21d

mpisize = 1 maxthreads = 4

input file = results/input.dat

schedule::read fname = results/input.dat
----------------------------------------------------------------------
dtype 0
nelec 5
twoms 1
integral_file moleinfo/fmole.info 
scratch ./scratch

$sci
dets 
0 1 2 3 4 
end
nroots 4
eps0 1.e-6
schedule
0 1.e-2
end
maxiter 6
$end

$ctns
verbose 1
qkind rNSz
nroots 2
maxdets 500 #000
topology_file topology/topo0
thresh_ortho 1.e-8
thresh_proj 1.e-14
schedule
# (n-th, dot, Dcut, dvdson, noise)
0 2 10 1.e-4 1.e-4
1 2 20 1.e-4 0.0
2 2 20 1.e-4 0.0
end
maxsweep 6
task_dmrg
alg_hvec 6
$end

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
nelec = 5
twoms = 1
integral_file = moleinfo/fmole.info

===== params_sci::print =====
nroots = 4
no. of unique seeds = 1
0-th det: 0 1 2 3 4 
flip = 0
eps0 = 1e-06
miniter = 0
maxiter = 6
schedule: iter eps1
0 0.01
1 0.01
2 0.01
3 0.01
4 0.01
5 0.01
convergence parameters
deltaE = 1e-10
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 0
load = 0
ci_file = ci.info
cthrd = 0.01

===== params_ctns::print =====
qkind = rNSz
topology_file = topology/topo0
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
task_restart = 0
rsweep = -1
rbond = -1
maxdets = 500
thresh_proj = 1.000000e-14
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
nroots = 2
guess = 1
dbranch = 0
maxsweep = 6
maxbond = -1
lastdot = 0
schedule: isweep, dots, dcut, eps, noise
0 2 10 1.000000e-04 1.000000e-04
1 2 20 1.000000e-04 0.000000e+00
2 2 20 1.000000e-04 0.000000e+00
3 2 20 1.000000e-04 0.000000e+00
4 2 20 1.000000e-04 0.000000e+00
5 2 20 1.000000e-04 0.000000e+00
alg_hvec = 6
alg_renorm = 2
ifdist1 = 0
save_formulae = 0
sort_formulae = 1
hxorder = 0
batchgemm = 1
batchsize = 10000
batchcase = 1
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
rcanon_load = 0
rcanon_file = rcanon.info
iomode = 0
ioasync = 0
iroot = 0
nsample = 100000
ndetprt = 10

io::create_scratch scratch=./scratch

ctns::topology::read fname=topology/topo0
0
1
2
3
4

ctns::topology::print ntotal=5 nphysical=5 nbackbone=5
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
rcoord:
 idx=0 coord=(4,0) node: pindex=4 type=0 center=(-1,-1) left=(3,0) right=(-2,-2)
 idx=1 coord=(3,0) node: pindex=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=2 coord=(2,0) node: pindex=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=3 coord=(1,0) node: pindex=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=4 coord=(0,0) node: pindex=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(4,0) rsupport: 4 ; lsupport: 0 1 2 3 
 idx=1 coord=(3,0) rsupport: 3 4 ; lsupport: 0 1 2 
 idx=2 coord=(2,0) rsupport: 2 3 4 ; lsupport: 0 1 
 idx=3 coord=(1,0) rsupport: 1 2 3 4 ; lsupport: 0 
 idx=4 coord=(0,0) rsupport: 0 1 2 3 4 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(4,0) corbs: 4 ; rorbs: ; lorbs: 0 1 2 3 
 idx=1 coord=(3,0) corbs: 3 ; rorbs: 4 ; lorbs: 0 1 2 
 idx=2 coord=(2,0) corbs: 2 ; rorbs: 3 4 ; lorbs: 0 1 
 idx=3 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 ; lorbs: 0 
 idx=4 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9

fci::ci_load fname=./scratch/ci.info

fci::ci_truncate maxdets=500 ifortho=1
 reduction from 52 to 52 dets
 iroot=0 ova=1.000000000000e+00
 iroot=1 ova=1.000000000000e+00
 iroot=2 ova=1.000000000000e+00
 iroot=3 ova=1.000000000000e+00

ctns::rcanon_init qkind=rNSz

ctns::init_rbases rdm_svd=1.50e+00 thresh_proj=1.00e-14

idx=
idx=0
idx=1 node=(3,0) type=1 rsupport=
idx=3 node= node=(4,0) type=0 rsupport=4 
2 node=(2,0) type=1 rsupport=2 3 4 
(1,0) type=1 rsupport=1 2 3 4 
3 4 

idx=4 node=(0,0) type=0 rsupport=0 1 2 3 4 
ctns::right_projection<Km> thresh_proj=1.00e-14
ctns::right_projection<Km> thresh_proj=1.00e-14
ctns::right_projection<Km> thresh_proj=1.00e-14
ctns::right_projection<Km> thresh_proj=1.00e-14
 qr=(1,1) dimB,dimBi=2,2 popBi=2.74e-01 popBc=2.74e-01 1-popBc=7.26e-01
 qr=(0,0) dimB,dimBi=1,1 popBi=4.36e-01 popBc=4.36e-01 1-popBc=5.64e-01
 qr=(3,1) dimB,dimBi=12,4 popBi= qr=(2,0) dimB,dimBi=9,8 popBi=7.39e-01 popBc=7.39e-01 1-popBc=2.61e-01
5.64e-01 popBc=8.38e-01 1-popBc=1.62e-01
 qr=(5,1) dimB,dimBi=52,4 popBi=1.00e+00 popBc=1.00e+00 1-popBc=-2.22e-16
 qr=(1,-1) dimB,dimBi=2,2 popBi= qr=2.12e-01 popBc=6.48e-01 1-popBc=3.52e-01
dim(space,lspace,rspace)=52,1,52 dimBc=4 popBc=1.00e+00 SvN=2.00e+00
----- TIMING FOR ctns::right_projection<Km> : 0.000e+00 S -----
(4,0) dimB,dimBi=20,4 popBi=0.243 popBc=0.982 1-popBc=0.0182
 qr=(1,1) dimB,dimBi=2,2 popBi=0.309 popBc=0.958 1-popBc=0.0424
 qr=(4,2) dimB,dimBi=8,4 popBi= qr=0.0135 popBc=0.995 1-popBc=0.00475
 qr=(2,-2) dimB,dimBi=1,1 popBi=0.00083 popBc=0.958 1-popBc=0.0415
(2,2) dimB,dimBi=3,3 popBi=0.114 popBc=0.952 1-popBc=0.0478
 qr=(2,0) dimB,dimBi=4,4 popBi=0.0341 popBc=0.993 1-popBc=0.00739
 qr=(5,1) dimB,dimBi=12,4 popBi=0.00475 popBc=1 1-popBc=3.33e-16
dim(space,lspace,rspace)= qr=52,4,52 dimBc=16 popBc=(2,2) dimB,dimBi=1,1 popBi=1 SvN=2.460.00454 qr= popBc=0.997 1-popBc=0.00285
(3,-1) dimB,dimBi=5,4 popBi=
----- TIMING FOR ctns::right_projection<Km> : 1.000e-03 S -----
0.00962 qr=(3,-1) dimB,dimBi=2 popBc=,2 popBi=0.000828 popBc=0.9620.998 1-popBc=0.00202
 1-popBc=0.0382
 qr=(3,1) dimB,dimBi=2,2 popBi=0.00192 popBc=1 1-popBc=0.000106
 qr=(4,0) dimB,dimBi=1,1 popBi=0.000106 popBc=1 1-popBc=0
dim(space,lspace,rspace)=52, qr=43,16 dimBc=16 popBc=(3,1)1 SvN=2.04
----- TIMING FOR ctns::right_projection<Km> : 1.000e-03 S -----
 dimB,dimBi=9,9 popBi=0.0321 popBc=0.994 1-popBc=0.00605
 qr=(3,3) dimB,dimBi=1,1 popBi=0.000357 popBc=0.994 1-popBc=0.00569
 qr=(4,0) dimB,dimBi=9,8 popBi=0.005 popBc=0.999 1-popBc=0.000688
 qr=(4,2) dimB,dimBi=3,3 popBi=0.000581 popBc=1 1-popBc=0.000107
 qr=(5,1) dimB,dimBi=2,2 popBi=0.000107 popBc=1 1-popBc=-2.22e-16
dim(space,lspace,rspace)=52,16,43 dimBc=40 popBc=1 SvN=2.86
----- TIMING FOR ctns::right_projection<Km> : 2.000e-03 S -----

final rbases with thresh_proj=1e-14
 idx=0 node=(4,0) type=0 shape=4,4
 idx=1 node=(3,0) type=1 shape=16,16
 idx=2 node=(2,0) type=1 shape=43,40
 idx=3 node=(1,0) type=1 shape=52,16
 idx=4 node=(0,0) type=0 shape=52,4
maximum bond dimension = 40
----- TIMING FOR ctns::init_rbases : 2.000e-03 S -----

ctns::init_rsites qkind=rNSz thresh_ortho=1e-08
 idx=0 node=(4,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 TIMING=0.000e+00 S
 idx=1 node=(3,0)[1] shape(l,r,c)=(16,4,4) maxdiff=6.910e-16 TIMING=0.000e+00 S
 idx=2 node=(2,0)[1] shape(l,r,c)=(40,16,4) maxdiff=2.079e-15 TIMING=0.000e+00 S
 idx=3 node=(1,0)[1] shape(l,r,c)=(16,40,4) maxdiff=2.234e-15 TIMING=0.000e+00 S
 idx=4 node=(0,0)[0] shape(l,r,c)=(4,16,4) maxdiff=1.340e-15 TIMING=0.000e+00 S
----- TIMING FOR ctns::init_rsites : 0.000e+00 S -----

ctns::init_rwfuns qkind=rNSz thresh_ortho=1e-08
stensor2: wf2 own=1 _data=0x6000019ecc80
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=4
 (5,1):4
 qbond: qcol nsym=1 dimAll=4
 (5,1):4
total no. of nonzero blocks=1 nblocks=1 size=16:0.000122MB

check state overlaps ...
matrix: ova_rwfuns size=(4,4)
      1.0000e+00      -2.7949e-17       5.7508e-17      -2.9019e-18 
     -2.7949e-17       1.0000e+00      -3.3307e-16      -7.2858e-17 
      5.7508e-17      -3.3307e-16       1.0000e+00      -8.3267e-17 
     -2.9019e-18      -7.2858e-17      -8.3267e-17       1.0000e+00 
matrix: ova0_vs size=(4,4)
      1.0000e+00       1.3878e-17       0.0000e+00       0.0000e+00 
      1.3878e-17       1.0000e+00      -5.5511e-17       5.5511e-17 
      0.0000e+00      -5.5511e-17       1.0000e+00       8.3267e-17 
      0.0000e+00       5.5511e-17       8.3267e-17       1.0000e+00 
diff of ova matrices = 1.244e-15
----- TIMING FOR ctns::init_rwfuns : 0.000e+00 S -----
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=0 mem=0:0MB:0GB
 psi: len=0 mem=0:0MB:0GB
total mem of comb=795:0.00607MB:5.92e-06GB
----- TIMING FOR ctns::rcanon_init : 3.000e-03 S -----

ctns::rcanon_save fname=./scratch/rcanon.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Dtot=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Dtot=16 maxdiff=6.91e-16
 idx=2 node=(2,0) Dtot=40 maxdiff=2.08e-15
 idx=3 node=(1,0) Dtot=16 maxdiff=2.23e-15
 idx=4 node=(0,0) Dtot=4 maxdiff=1.34e-15

integral::load fname = moleinfo/fmole.info
sorb = 10
size(int1e) = 100:7.63e-04MB:7.45e-07GB
size(int2e) = 1080:8.24e-03MB:8.05e-06GB
ecore = 3.40e+00
----- TIMING FOR integral::load_integral : 1.000e-03 S -----

io::remove_scratch scratch=./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=rNSz
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/cop(4,0) size=0.00111MB speed=infMB/s
fsize=0.00111MB ratio=1 usage=1.31e-06GB available=735GB
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(4,0) size=0.00111MB speed=infMB/s
fsize=0.00111MB ratio=1 usage=2.62e-06GB available=735GB
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/cop(3,0) size=0.00111MB speed=infMB/s
fsize=0.00111MB ratio=1 usage=3.93e-06GB available=735GB
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/cop(2,0) size=0.00111MB speed=infMB/s
fsize=0.00111MB ratio=1 usage=5.24e-06GB available=735GB
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/cop(1,0) size=0.00111MB speed=infMB/s
fsize=0.00111MB ratio=1 usage=6.55e-06GB available=735GB
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/cop(0,0) size=0.00111MB speed=infMB/s
fsize=0.00111MB ratio=1 usage=7.86e-06GB available=735GB
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(0,0) size=0.00111MB speed=infMB/s
fsize=0.00111MB ratio=1 usage=9.17e-06GB available=735GB
----- TIMING FOR ctns::oper_init : 8.000e-03 S -----
T[ctns::oper_init](comp/save/tot)=0,0,0

idx=1 coord=(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.000e-03 S -----
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=448:0.00342MB:3.34e-06GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.004  T(cal/comm)=0.004,0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(3,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=1.98e-05GB available=735GB

idx=2 coord=(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=36 wfsize=292 worktot=3648:0.0278MB:2.72e-05GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=40,40 size(op)=252:0.00192MB size(tot)=9246:0.0705MB:6.89e-05GB
TIMING for Renormalization : 0.004  T(cal/comm)=0.004,0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(2,0) size=0.0705MB speed=infMB/s
fsize=0.0705MB ratio=1 usage=8.9e-05GB available=735GB

idx=3 coord=(1,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
ctns::oper_renorm_opAll coord=(1,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=79 : 1.000e-03 S -----
preprocess for renorm: opsize=252 wfsize=356 worktot=5280:0.0403MB:3.93e-05GB
 qops: oplist=CABPQSH nops=C:8 A:28 B:36 P:1 Q:3 S:2 H:1 
        dim(bra,ket)=16,16 size(op)=64:0.000488MB size(tot)=2336:0.0178MB:1.74e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(1,0) size=0.0178MB speed=infMB/s
fsize=0.0178MB ratio=1 usage=0.000107GB available=735GB

idx=4 coord=(0,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
ctns::oper_renorm_opAll coord=(0,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=111 : 1.000e-03 S -----
preprocess for renorm: opsize=64 wfsize=64 worktot=1024:0.00781MB:7.63e-06GB
 qops: oplist=CABPQSH nops=C:10 A:45 B:55 P:0 Q:0 S:0 H:1 
        dim(bra,ket)=4,4 size(op)=16:0.000122MB size(tot)=496:0.00378MB:3.7e-06GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(0,0) size=0.00378MB speed=infMB/s
fsize=0.00378MB ratio=1 usage=0.000111GB available=735GB
----- TIMING FOR ctns::oper_env_right : 3.200e-02 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.008,0.001,0.015,0,0.024
matrix: Hij size=(4,4)
     -2.65451697e+00       7.96286466e-16      -4.24738296e-16      -6.16924564e-16 
      7.96286466e-16      -2.27865403e+00       7.60502772e-15       2.91780489e-15 
     -4.24738296e-16       7.54951657e-15      -2.24308285e+00       1.41553436e-15 
     -6.16924564e-16       2.95249936e-15       1.38777878e-15      -1.91229192e+00 
matrix: Sij size=(4,4)
      1.0000e+00      -7.3943e-17       9.0907e-17      -2.1142e-16 
     -7.7412e-17       1.0000e+00      -5.5010e-16      -7.6762e-16 
      7.8741e-17      -5.9081e-16       1.0000e+00       1.8526e-17 
     -2.1099e-16      -8.2399e-16       3.0625e-17       1.0000e+00 

ctns::sweep_opt maxsweep=6
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.012e-07GB
 rsites: len=5 mem=752:0.005737MB:5.603e-06GB
 rwfuns: len=4 mem=16:0.0001221MB:1.192e-07GB
 lsites: len=5 mem=4:3.052e-05MB:2.98e-08GB
 psi: len=0 mem=0:0MB:0GB
total mem of comb=799:0.006096MB:5.953e-06GB

ctns::topology::get_sweeps
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=3 bond=(1,0)-(2,0) forward=0 cturn=0
======================================================================
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0.0001
======================================================================

=== start rank=0 ibond=0
ISWEEP,IBOND=0,0

isweep=0 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 3.000e-03 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=4:3.05e-05MB:2.98e-08GB
 psi: len=0 mem=0:0MB:0GB
total mem of comb=799:0.0061MB:5.95e-06GB
===== CPUmem(GB): tot=1.96e-05 (comb,oper,dvdson,hvec,renorm)=5.95e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8b914d30
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (0,0):1 (1,-1):2 (1,1):2 (2,-2):1 (2,0):4 (2,2):1 (3,-1):2 (3,1):2 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 4.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.008,0.008
----- TIMING FOR preprocess_formulae_Hxlist2 : 8.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000631 (comb,oper,dvdson,hvec,renorm)=5.95e-06,1.36e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00322
--- time_cost_gemm_reduction=0.000883
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=2.45e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00139
--- time_cost_gemm_reduction=1.3e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.66e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966941  -1.00e+03   4.48e-05    2     2   5.00e-03  2.50e-03
    1   1 +      -2.278654025976  -1.00e+03   6.71e-05    2     2   5.00e-03  2.50e-03
TIMING for Davidson : 5.00e-03  T(cal/comm/rest)=5.00e-03,0.00e+00,0.00e+00
optimized energies: isweep=0 dots=2 ibond=0 e[0]=-2.65451696694
optimized energies: isweep=0 dots=2 ibond=0 e[1]=-2.27865402598
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond0.txt
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: 16->10 dwt=+2.885e-03 SvN=1.645e+00
===== CPUmem(GB): tot=1.956e-05 (comb,oper,dvdson,hvec,renorm)=5.953e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=4 wfsize=26 worktot=328:0.0025MB:2.44e-06GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=730:0.00557MB:5.44e-06GB
TIMING for Renormalization : 0.004  T(cal/comm)=0.004,0
===== CPUmem(GB): tot=1.99e-05 (comb,oper,dvdson,hvec,renorm)=5.95e-06,1.36e-05,0,0,3.05e-07 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=30:0.000229MB:2.24e-07GB
 psi: len=2 mem=156:0.00119MB:1.16e-06GB
total mem of comb=981:0.00748MB:7.31e-06GB
===== CPUmem(GB): tot=2.67e-05 (comb,oper,dvdson,hvec,renorm)=7.31e-06,1.9e-05,0,0,3.05e-07 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(1,0) size=0.00557MB speed=infMB/s
fsize=0.00557MB ratio=1 usage=0.000117GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 4.10e-02 S #####
 T(fetch) = 3.00e-03 S  per =  7.3  per(accum) = 7.3
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 7.3
 T(dvdsn) = 3.10e-02 S  per =   76  per(accum) = 83
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 83
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 83
 T(renrm) = 4.00e-03 S  per =  9.8  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -5.4e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 5.4e+12
end rank=0 sweep_twodot
##### time_sweep: 4.10e-02 S #####
 T(fetch) = 3.00e-03 S  per =  7.3  per(accum) = 7.3
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 7.3
 T(dvdsn) = 3.10e-02 S  per =   76  per(accum) = 83
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 83
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 83
 T(renrm) = 4.00e-03 S  per =  9.8  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -5.4e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 5.4e+12
##### time_global: 4.10e-02 S #####
 T(fetch) = 3.00e-03 S  per =  7.3  per(accum) = 7.3
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 7.3
 T(dvdsn) = 3.10e-02 S  per =   76  per(accum) = 83
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 83
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 83
 T(renrm) = 4.00e-03 S  per =  9.8  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -5.4e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 5.4e+12

=== end rank=0 ibond=0

=== start rank=0 ibond=1
ISWEEP,IBOND=0,1

isweep=0 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.000e-03 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=730:0.00557MB:5.44e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1168:0.00891MB:8.7e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=30:0.000229MB:2.24e-07GB
 psi: len=2 mem=156:0.00119MB:1.16e-06GB
total mem of comb=981:0.00748MB:7.31e-06GB
===== CPUmem(GB): tot=1.6e-05 (comb,oper,dvdson,hvec,renorm)=7.31e-06,8.7e-06,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(10,4,4,4) nnz=78:0.000595MB
stensor4: wf own=1 _data=0x7fbf8b905370
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=6 dimAll=10
 (2,0):4 (3,1):2 (1,1):1 (3,-1):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=42 nblocks=384 size=78:0.000595MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 5.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=506:0.00386MB:3.77e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.005,0.005
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.000e-03 S -----
preprocess for Hx: ndim=78 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000624 (comb,oper,dvdson,hvec,renorm)=7.31e-06,8.7e-06,1.16e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00118
--- time_cost_gemm_reduction=1.5e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.59e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00114
--- time_cost_gemm_reduction=1.7e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.73e+07
settings: ndim=78 neig=2 maxcycle=30 nbuff=4 memory=1.05e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.650929828294  -1.00e+03   1.40e-02    2     2   2.00e-03  1.00e-03
    1   1 -      -2.272369770221  -1.00e+03   1.99e-02    2     2   2.00e-03  1.00e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.11e-03
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.89e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.11e-03
--- time_cost_gemm_reduction=1.20e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.90e+07
    2   0 -      -2.651065954307  -1.36e-04   5.04e-03    4     4   4.00e-03  1.00e-03
    2   1 -      -2.272592302873  -2.23e-04   5.22e-03    4     4   4.00e-03  1.00e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.10e-03
--- time_cost_gemm_reduction=2.00e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.91e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.15e-03
--- time_cost_gemm_reduction=1.00e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.70e+07
    3   0 -      -2.651089357548  -2.34e-05   2.26e-03    6     6   7.00e-03  1.17e-03
    3   1 -      -2.272615199224  -2.29e-05   2.46e-03    6     6   7.00e-03  1.17e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.19e-03
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.53e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.10e-03
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.94e+07
    4   0 -      -2.651092508234  -3.15e-06   6.33e-04    6     8   9.00e-03  1.13e-03
    4   1 -      -2.288566409400  -1.60e-02   2.74e-01    6     8   9.00e-03  1.13e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.10e-03
--- time_cost_gemm_reduction=1.80e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.91e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.10e-03
--- time_cost_gemm_reduction=1.00e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.90e+07
    5   0 -      -2.651092802004  -2.94e-07   2.05e-04    6    10   1.10e-02  1.10e-03
    5   1 -      -2.395068641418  -1.07e-01   1.97e-01    6    10   1.10e-02  1.10e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.10e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.91e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.11e-03
--- time_cost_gemm_reduction=1.10e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.89e+07
    6   0 +      -2.651092829822  -2.78e-08   5.88e-05    6    12   1.40e-02  1.17e-03
    6   1 -      -2.424390556116  -2.93e-02   6.59e-02    6    12   1.40e-02  1.17e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.12e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.82e+07
    7   0 +      -2.651092829823  -9.06e-14   5.88e-05    5    13   1.50e-02  1.15e-03
    7   1 -      -2.427320246231  -2.93e-03   1.83e-02    5    13   1.50e-02  1.15e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.12e-03
--- time_cost_gemm_reduction=1.10e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.85e+07
    8   0 +      -2.651092829829  -6.54e-12   5.87e-05    4    14   1.60e-02  1.14e-03
    8   1 -      -2.427591971209  -2.72e-04   8.00e-03    4    14   1.60e-02  1.14e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.22e-03
--- time_cost_gemm_reduction=1.20e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.43e+07
    9   0 +      -2.651092829832  -2.82e-12   5.87e-05    4    15   1.80e-02  1.20e-03
    9   1 -      -2.427635684199  -4.37e-05   2.90e-03    4    15   1.80e-02  1.20e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.16e-03
--- time_cost_gemm_reduction=1.00e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.65e+07
   10   0 +      -2.651092829844  -1.17e-11   5.87e-05    4    16   1.90e-02  1.19e-03
   10   1 -      -2.427641833630  -6.15e-06   1.23e-03    4    16   1.90e-02  1.19e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.10e-03
--- time_cost_gemm_reduction=2.20e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.92e+07
   11   0 +      -2.651092829880  -3.60e-11   5.84e-05    4    17   2.00e-02  1.18e-03
   11   1 -      -2.427642971117  -1.14e-06   4.16e-04    4    17   2.00e-02  1.18e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.11e-03
--- time_cost_gemm_reduction=8.00e-06
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.87e+07
   12   0 +      -2.651092829896  -1.62e-11   5.85e-05    4    18   2.10e-02  1.17e-03
   12   1 -      -2.427643148032  -1.77e-07   1.59e-04    4    18   2.10e-02  1.17e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.27e-03
--- time_cost_gemm_reduction=2.10e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.26e+07
   13   0 +      -2.651092830034  -1.38e-10   5.69e-05    4    19   2.30e-02  1.21e-03
   13   1 +      -2.427643176512  -2.85e-08   9.80e-05    4    19   2.30e-02  1.21e-03
TIMING for Davidson : 2.30e-02  T(cal/comm/rest)=1.90e-02,0.00e+00,4.00e-03
optimized energies: isweep=0 dots=2 ibond=1 e[0]=-2.65109283003
optimized energies: isweep=0 dots=2 ibond=1 e[1]=-2.42764317651
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond1.txt
 qbond: qsuper nsym=12 dimAll=40
 (3,1):8 (4,0):8 (2,0):5 (3,-1):5 (4,2):3 (5,1):3 (2,2):2 (5,-1):2 (1,1):1 (3,3):1 (4,-2):1 (6,0):1
decimation summary: 40->10 dwt=+9.638e-03 SvN=1.843e+00
===== CPUmem(GB): tot=1.601e-05 (comb,oper,dvdson,hvec,renorm)=7.309e-06,8.702e-06,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.000e-03 S -----
preprocess for renorm: opsize=24 wfsize=62 worktot=840:0.00641MB:6.26e-06GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=775:0.00591MB:5.77e-06GB
TIMING for Renormalization : 0.002  T(cal/comm)=0.002,0
===== CPUmem(GB): tot=1.68e-05 (comb,oper,dvdson,hvec,renorm)=7.31e-06,8.7e-06,0,0,7.82e-07 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=90:0.000687MB:6.71e-07GB
 psi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=933:0.00712MB:6.95e-06GB
===== CPUmem(GB): tot=2.22e-05 (comb,oper,dvdson,hvec,renorm)=6.95e-06,1.45e-05,0,0,7.82e-07 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(2,0) size=0.00591MB speed=infMB/s
fsize=0.00591MB ratio=1 usage=5.49e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 5.00e-02 S #####
 T(fetch) = 1.00e-03 S  per =    2  per(accum) = 2
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 2
 T(dvdsn) = 4.30e-02 S  per =   86  per(accum) = 88
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 88
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 88
 T(renrm) = 3.00e-03 S  per =    6  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -3.9e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 3.9e+12
end rank=0 sweep_twodot
##### time_sweep: 9.10e-02 S #####
 T(fetch) = 4.00e-03 S  per =  4.4  per(accum) = 4.4
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 4.4
 T(dvdsn) = 7.40e-02 S  per =   81  per(accum) = 86
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 86
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 86
 T(renrm) = 7.00e-03 S  per =  7.7  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -3.36e+09 S  per = -4.5e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 3.36e+09 S  per = 4.5e+12
##### time_global: 9.10e-02 S #####
 T(fetch) = 4.00e-03 S  per =  4.4  per(accum) = 4.4
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 4.4
 T(dvdsn) = 7.40e-02 S  per =   81  per(accum) = 86
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 86
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 86
 T(renrm) = 7.00e-03 S  per =  7.7  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -3.36e+09 S  per = -4.5e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 3.36e+09 S  per = 4.5e+12

=== end rank=0 ibond=1

=== start rank=0 ibond=2
ISWEEP,IBOND=0,2

isweep=0 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=730:0.00557MB:5.44e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1168:0.00891MB:8.7e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=90:0.000687MB:6.71e-07GB
 psi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=933:0.00712MB:6.95e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=6.95e-06,1.45e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(10,4,4,4) nnz=78:0.000595MB
stensor4: wf own=1 _data=0x7fbf8ea04080
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=6 dimAll=10
 (2,0):4 (3,1):2 (1,1):1 (3,-1):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=42 nblocks=384 size=78:0.000595MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=506:0.00386MB:3.77e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=78 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000629 (comb,oper,dvdson,hvec,renorm)=6.95e-06,1.45e-05,1.16e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00113
--- time_cost_gemm_reduction=1.7e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.78e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00122
--- time_cost_gemm_reduction=1.6e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.42e+07
settings: ndim=78 neig=2 maxcycle=30 nbuff=4 memory=1.05e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.640924855960  -1.00e+03   1.43e-01    2     2   2.00e-03  1.00e-03
    1   1 -      -2.405171775286  -1.00e+03   1.99e-01    2     2   2.00e-03  1.00e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.11e-03
--- time_cost_gemm_reduction=1.80e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.89e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.10e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.91e+07
    2   0 -      -2.650500961964  -9.58e-03   3.19e-02    4     4   4.00e-03  1.00e-03
    2   1 -      -2.425164417896  -2.00e-02   5.86e-02    4     4   4.00e-03  1.00e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.11e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.87e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.10e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.91e+07
    3   0 -      -2.651051794667  -5.51e-04   6.68e-03    6     6   7.00e-03  1.17e-03
    3   1 -      -2.427538124887  -2.37e-03   1.15e-02    6     6   7.00e-03  1.17e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.17e-03
--- time_cost_gemm_reduction=1.10e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.62e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.13e-03
--- time_cost_gemm_reduction=1.90e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.80e+07
    4   0 -      -2.651086699978  -3.49e-05   2.38e-03    6     8   9.00e-03  1.13e-03
    4   1 -      -2.427625899756  -8.78e-05   4.42e-03    6     8   9.00e-03  1.13e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.11e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.87e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.23e-03
--- time_cost_gemm_reduction=1.00e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.39e+07
    5   0 -      -2.651091761092  -5.06e-06   1.21e-03    6    10   1.20e-02  1.20e-03
    5   1 -      -2.427640482073  -1.46e-05   1.74e-03    6    10   1.20e-02  1.20e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.19e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.54e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.11e-03
--- time_cost_gemm_reduction=1.30e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.88e+07
    6   0 -      -2.651092751203  -9.90e-07   3.54e-04    6    12   1.40e-02  1.17e-03
    6   1 -      -2.427643023657  -2.54e-06   4.45e-04    6    12   1.40e-02  1.17e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.11e-03
--- time_cost_gemm_reduction=1.40e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.87e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.18e-03
--- time_cost_gemm_reduction=1.40e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=4.58e+07
    7   0 +      -2.651092827043  -7.58e-08   9.15e-05    6    14   1.60e-02  1.14e-03
    7   1 -      -2.427643166555  -1.43e-07   1.33e-04    6    14   1.60e-02  1.14e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.78e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=3.04e+07
    8   0 +      -2.651092827043  -2.12e-13   9.15e-05    5    15   1.80e-02  1.20e-03
    8   1 +      -2.427643182158  -1.56e-08   5.46e-05    5    15   1.80e-02  1.20e-03
TIMING for Davidson : 1.80e-02  T(cal/comm/rest)=1.50e-02,0.00e+00,3.00e-03
optimized energies: isweep=0 dots=2 ibond=2 e[0]=-2.65109282704
optimized energies: isweep=0 dots=2 ibond=2 e[1]=-2.42764318216
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: 16->10 dwt=+1.386e-03 SvN=1.072e+00
===== CPUmem(GB): tot=2.143e-05 (comb,oper,dvdson,hvec,renorm)=6.951e-06,1.448e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=4 wfsize=26 worktot=328:0.0025MB:2.44e-06GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=764:0.00583MB:5.69e-06GB
TIMING for Renormalization : 0.004  T(cal/comm)=0.004,0
===== CPUmem(GB): tot=2.17e-05 (comb,oper,dvdson,hvec,renorm)=6.95e-06,1.45e-05,0,0,3.05e-07 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=742:0.00566MB:5.53e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=90:0.000687MB:6.71e-07GB
 psi: len=2 mem=124:0.000946MB:9.24e-07GB
total mem of comb=999:0.00762MB:7.44e-06GB
===== CPUmem(GB): tot=2.79e-05 (comb,oper,dvdson,hvec,renorm)=7.44e-06,2.02e-05,0,0,3.05e-07 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(3,0) size=0.00583MB speed=infMB/s
fsize=0.00583MB ratio=1 usage=5.12e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 4.50e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 3.80e-02 S  per =   84  per(accum) = 84
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 4.00e-03 S  per =  8.9  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -4.4e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 4.4e+12
end rank=0 sweep_twodot
##### time_sweep: 1.36e-01 S #####
 T(fetch) = 4.00e-03 S  per =  2.9  per(accum) = 2.9
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 2.9
 T(dvdsn) = 1.12e-01 S  per =   82  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 1.10e-02 S  per =  8.1  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -5.03e+09 S  per = -4.5e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 5.03e+09 S  per = 4.5e+12
##### time_global: 1.36e-01 S #####
 T(fetch) = 4.00e-03 S  per =  2.9  per(accum) = 2.9
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 2.9
 T(dvdsn) = 1.12e-01 S  per =   82  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 1.10e-02 S  per =  8.1  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -5.03e+09 S  per = -4.5e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 5.03e+09 S  per = 4.5e+12

=== end rank=0 ibond=2

=== start rank=0 ibond=3
ISWEEP,IBOND=0,3

isweep=0 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.000e-03 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=764:0.00583MB:5.69e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1202:0.00917MB:8.96e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=742:0.00566MB:5.53e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=90:0.000687MB:6.71e-07GB
 psi: len=2 mem=124:0.000946MB:9.24e-07GB
total mem of comb=999:0.00762MB:7.44e-06GB
===== CPUmem(GB): tot=1.64e-05 (comb,oper,dvdson,hvec,renorm)=7.44e-06,8.96e-06,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,10,4,4) nnz=72:0.000549MB
stensor4: wf own=1 _data=0x7fbf8ea825c0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=5 dimAll=10
 (2,0):4 (1,-1):2 (1,1):2 (0,0):1 (2,2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=33 nblocks=320 size=72:0.000549MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 4.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=506:0.00386MB:3.77e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.005,0.005
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.000e-03 S -----
preprocess for Hx: ndim=72 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000623 (comb,oper,dvdson,hvec,renorm)=7.44e-06,8.96e-06,1.07e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.001
--- time_cost_gemm_reduction=1.2e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=4.5e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.000849
--- time_cost_gemm_reduction=9e-06
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.32e+07
settings: ndim=72 neig=2 maxcycle=30 nbuff=4 memory=9.66e-06GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.649584713827  -1.00e+03   5.61e-02    2     2   1.00e-03  5.00e-04
    1   1 -      -2.422873626622  -1.00e+03   1.13e-01    2     2   1.00e-03  5.00e-04
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.02e-04
--- time_cost_gemm_reduction=1.10e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.63e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=7.97e-04
--- time_cost_gemm_reduction=1.40e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.67e+07
    2   0 -      -2.651942776245  -2.36e-03   1.27e-02    4     4   3.00e-03  7.50e-04
    2   1 -      -2.430205342392  -7.33e-03   2.58e-02    4     4   3.00e-03  7.50e-04
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=7.97e-04
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.67e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.67e-04
--- time_cost_gemm_reduction=8.00e-06
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.21e+07
    3   0 -      -2.652054181765  -1.11e-04   5.06e-03    6     6   5.00e-03  8.33e-04
    3   1 -      -2.430611175527  -4.06e-04   9.32e-03    6     6   5.00e-03  8.33e-04
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.10e-04
--- time_cost_gemm_reduction=9.00e-06
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.58e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.00e-04
--- time_cost_gemm_reduction=1.20e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.65e+07
    4   0 -      -2.652078566393  -2.44e-05   1.91e-03    6     8   7.00e-03  8.75e-04
    4   1 -      -2.430673358775  -6.22e-05   4.16e-03    6     8   7.00e-03  8.75e-04
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.07e-04
--- time_cost_gemm_reduction=9.00e-06
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.60e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.39e-04
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.39e+07
    5   0 -      -2.652080842744  -2.28e-06   5.13e-04    6    10   9.00e-03  9.00e-04
    5   1 -      -2.430687478243  -1.41e-05   1.80e-03    6    10   9.00e-03  9.00e-04
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=9.91e-04
--- time_cost_gemm_reduction=1.40e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=4.56e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.94e-04
--- time_cost_gemm_reduction=1.80e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.05e+07
    6   0 -      -2.652081069574  -2.27e-07   1.76e-04    6    12   1.10e-02  9.17e-04
    6   1 -      -2.430689675148  -2.20e-06   5.57e-04    6    12   1.10e-02  9.17e-04
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.57e-04
--- time_cost_gemm_reduction=5.00e-06
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.27e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=9.78e-04
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=4.62e+07
    7   0 +      -2.652081089524  -1.99e-08   6.38e-05    6    14   1.30e-02  9.29e-04
    7   1 -      -2.430689869830  -1.95e-07   1.13e-04    6    14   1.30e-02  9.29e-04
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.54e-04
--- time_cost_gemm_reduction=1.30e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.29e+07
    8   0 +      -2.652081089524  -2.84e-13   6.38e-05    5    15   1.40e-02  9.33e-04
    8   1 +      -2.430689878738  -8.91e-09   3.44e-05    5    15   1.40e-02  9.33e-04
TIMING for Davidson : 1.40e-02  T(cal/comm/rest)=3.00e-03,0.00e+00,1.10e-02
optimized energies: isweep=0 dots=2 ibond=3 e[0]=-2.65208108952
optimized energies: isweep=0 dots=2 ibond=3 e[1]=-2.43068987874
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=11 dimAll=40
 (2,0):9 (3,1):7 (3,-1):6 (4,0):4 (1,-1):3 (1,1):3 (2,2):3 (2,-2):2 (0,0):1 (3,3):1 (4,2):1
decimation summary: 40->10 dwt=+9.505e-03 SvN=1.828e+00
===== CPUmem(GB): tot=1.640e-05 (comb,oper,dvdson,hvec,renorm)=7.443e-06,8.956e-06,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.000e-03 S -----
preprocess for renorm: opsize=26 wfsize=62 worktot=848:0.00647MB:6.32e-06GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=775:0.00591MB:5.77e-06GB
TIMING for Renormalization : 0.002  T(cal/comm)=0.002,0
===== CPUmem(GB): tot=1.72e-05 (comb,oper,dvdson,hvec,renorm)=7.44e-06,8.96e-06,0,0,7.9e-07 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=510:0.00389MB:3.8e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=90:0.000687MB:6.71e-07GB
 psi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=691:0.00527MB:5.15e-06GB
===== CPUmem(GB): tot=2.07e-05 (comb,oper,dvdson,hvec,renorm)=5.15e-06,1.47e-05,0,0,7.9e-07 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(2,0) size=0.00591MB speed=infMB/s
fsize=0.00591MB ratio=1 usage=5.21e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 3.70e-02 S #####
 T(fetch) = 1.00e-03 S  per =  2.7  per(accum) = 2.7
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 2.7
 T(dvdsn) = 3.00e-02 S  per =   81  per(accum) = 84
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 2.00e-03 S  per =  5.4  per(accum) = 89
 T( save) = 0.00e+00 S  per =    0  per(accum) = 89
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -5.6e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 5.6e+12
end rank=0 sweep_twodot
##### time_sweep: 1.73e-01 S #####
 T(fetch) = 5.00e-03 S  per =  2.9  per(accum) = 2.9
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 2.9
 T(dvdsn) = 1.42e-01 S  per =   82  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 1.30e-02 S  per =  7.5  per(accum) = 92
 T( save) = 0.00e+00 S  per =    0  per(accum) = 92
 T(preprocess_op_wf           ) = -6.71e+09 S  per = -4.7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 6.71e+09 S  per = 4.7e+12
##### time_global: 1.73e-01 S #####
 T(fetch) = 5.00e-03 S  per =  2.9  per(accum) = 2.9
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 2.9
 T(dvdsn) = 1.42e-01 S  per =   82  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 1.30e-02 S  per =  7.5  per(accum) = 92
 T( save) = 0.00e+00 S  per =    0  per(accum) = 92
 T(preprocess_op_wf           ) = -6.71e+09 S  per = -4.7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 6.71e+09 S  per = 4.7e+12

=== end rank=0 ibond=3

======================================================================
sweep_data::summary isweep=0
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0.0001
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=10 dwt=+2.885e-03 nmvp=2 e[0]=-2.65451696694 e[1]=-2.27865402598
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=10 dwt=+9.638e-03 nmvp=19 e[0]=-2.65109283003 e[1]=-2.42764317651
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=10 dwt=+1.386e-03 nmvp=15 e[0]=-2.65109282704 e[1]=-2.42764318216
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=10 dwt=+9.505e-03 nmvp=15 e[0]=-2.65208108952 e[1]=-2.43068987874
 eav_max=-2.46658549646 [ibond=0]  dwt_min=0.00138579656831 [ibond=2]
 eav_min=-2.54138548413 [ibond=3]  dwt_max=0.00963788482842 [ibond=1]
 eav_diff=0.0747999876727
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+9.505e-03 e[0]=-2.65208108952
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+9.505e-03 e[1]=-2.43068987874
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Tav/S | Taccum/S| t_kernel/S | t_reduction/S 
         0  2  10  1.00e-04  1.00e-04 | 51 | 1.78e-01 | 3.49e-03 | 1.78e-01 | 5.30e-03 | 6.20e-05
results: isweep, dcut, dwt, energies (delta_e)
         0      10 +9.51e-03 e[0]=-2.65208108952 (0.00e+00) e[1]=-2.43068987874 (0.00e+00)
======================================================================

======================================================================
sweep parameters: isweep=1 dots=2 dcut=20 eps=1.00e-04 noise=0.00e+00
======================================================================

=== start rank=0 ibond=0
ISWEEP,IBOND=1,0

isweep=1 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=764:0.00583MB:5.69e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1202:0.00917MB:8.96e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=510:0.00389MB:3.8e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=90:0.000687MB:6.71e-07GB
 psi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=691:0.00527MB:5.15e-06GB
===== CPUmem(GB): tot=1.99e-05 (comb,oper,dvdson,hvec,renorm)=5.15e-06,1.47e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,10,4,4) nnz=72:0.000549MB
stensor4: wf own=1 _data=0x7fbf8bd0c920
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=5 dimAll=10
 (2,0):4 (1,-1):2 (1,1):2 (0,0):1 (2,2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=33 nblocks=320 size=72:0.000549MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=506:0.00386MB:3.77e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.005,0.006
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.000e-03 S -----
preprocess for Hx: ndim=72 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000627 (comb,oper,dvdson,hvec,renorm)=5.15e-06,1.47e-05,1.07e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.000866
--- time_cost_gemm_reduction=1e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.22e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.000807
--- time_cost_gemm_reduction=9e-06
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.6e+07
settings: ndim=72 neig=2 maxcycle=30 nbuff=4 memory=9.66e-06GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.641998458023  -1.00e+03   1.43e-01    2     2   1.00e-03  5.00e-04
    1   1 -      -2.409549170753  -1.00e+03   1.87e-01    2     2   1.00e-03  5.00e-04
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.45e-04
--- time_cost_gemm_reduction=9.00e-06
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.35e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=7.98e-04
--- time_cost_gemm_reduction=1.90e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.66e+07
    2   0 -      -2.651381055754  -9.38e-03   3.40e-02    4     4   3.00e-03  7.50e-04
    2   1 -      -2.428926260601  -1.94e-02   5.14e-02    4     4   3.00e-03  7.50e-04
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.07e-04
--- time_cost_gemm_reduction=1.30e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.60e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.01e-03
--- time_cost_gemm_reduction=1.10e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=4.47e+07
    3   0 -      -2.652042676030  -6.62e-04   6.55e-03    6     6   5.00e-03  8.33e-04
    3   1 -      -2.430569433535  -1.64e-03   1.22e-02    6     6   5.00e-03  8.33e-04
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.55e-04
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.29e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=9.64e-04
--- time_cost_gemm_reduction=1.40e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=4.69e+07
    4   0 -      -2.652077167029  -3.45e-05   1.94e-03    6     8   7.00e-03  8.75e-04
    4   1 -      -2.430677272760  -1.08e-04   3.53e-03    6     8   7.00e-03  8.75e-04
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.01e-04
--- time_cost_gemm_reduction=1.10e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.64e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.39e-04
--- time_cost_gemm_reduction=1.20e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.39e+07
    5   0 -      -2.652080298593  -3.13e-06   9.85e-04    6    10   9.00e-03  9.00e-04
    5   1 -      -2.430686752249  -9.48e-06   1.83e-03    6    10   9.00e-03  9.00e-04
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.05e-04
--- time_cost_gemm_reduction=1.30e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.61e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.99e-04
--- time_cost_gemm_reduction=1.30e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.03e+07
    6   0 -      -2.652081027011  -7.28e-07   3.12e-04    6    12   1.10e-02  9.17e-04
    6   1 -      -2.430689426190  -2.67e-06   7.42e-04    6    12   1.10e-02  9.17e-04
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.50e-04
--- time_cost_gemm_reduction=6.00e-06
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.32e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.21e-04
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.50e+07
    7   0 +      -2.652081087251  -6.02e-08   8.25e-05    6    14   1.20e-02  8.57e-04
    7   1 -      -2.430689830982  -4.05e-07   2.50e-04    6    14   1.20e-02  8.57e-04
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=8.60e-04
--- time_cost_gemm_reduction=1.30e-05
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=5.25e+07
    8   0 +      -2.652081087251  -1.78e-15   8.25e-05    5    15   1.30e-02  8.67e-04
    8   1 +      -2.430689876389  -4.54e-08   6.80e-05    5    15   1.30e-02  8.67e-04
TIMING for Davidson : 1.30e-02  T(cal/comm/rest)=1.00e-03,0.00e+00,1.20e-02
optimized energies: isweep=1 dots=2 ibond=0 e[0]=-2.65208108725
optimized energies: isweep=1 dots=2 ibond=0 e[1]=-2.43068987639
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=2.0e-05 (comb,oper,dvdson,hvec,renorm)=5.1e-06,1.5e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=448:0.00342MB:3.34e-06GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.004  T(cal/comm)=0.004,0
===== CPUmem(GB): tot=2.03e-05 (comb,oper,dvdson,hvec,renorm)=5.15e-06,1.47e-05,0,0,4.17e-07 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=510:0.00389MB:3.8e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=100:0.000763MB:7.45e-07GB
 psi: len=2 mem=144:0.0011MB:1.07e-06GB
total mem of comb=797:0.00608MB:5.94e-06GB
===== CPUmem(GB): tot=3.14e-05 (comb,oper,dvdson,hvec,renorm)=5.94e-06,2.51e-05,0,0,4.17e-07 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(1,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=5.7e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 3.60e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 2.90e-02 S  per =   81  per(accum) = 81
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 81
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 81
 T(renrm) = 4.00e-03 S  per =   11  per(accum) = 92
 T( save) = 0.00e+00 S  per =    0  per(accum) = 92
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -5.8e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 5.8e+12
end rank=0 sweep_twodot
##### time_sweep: 3.60e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 2.90e-02 S  per =   81  per(accum) = 81
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 81
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 81
 T(renrm) = 4.00e-03 S  per =   11  per(accum) = 92
 T( save) = 0.00e+00 S  per =    0  per(accum) = 92
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -5.8e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 5.8e+12
##### time_global: 2.09e-01 S #####
 T(fetch) = 5.00e-03 S  per =  2.4  per(accum) = 2.4
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 2.4
 T(dvdsn) = 1.71e-01 S  per =   82  per(accum) = 84
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 1.70e-02 S  per =  8.1  per(accum) = 92
 T( save) = 0.00e+00 S  per =    0  per(accum) = 92
 T(preprocess_op_wf           ) = -8.39e+09 S  per = -4.9e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 8.39e+09 S  per = 4.9e+12

=== end rank=0 ibond=0

=== start rank=0 ibond=1
ISWEEP,IBOND=1,1

isweep=1 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.000e-03 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=510:0.00389MB:3.8e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=100:0.000763MB:7.45e-07GB
 psi: len=2 mem=144:0.0011MB:1.07e-06GB
total mem of comb=797:0.00608MB:5.94e-06GB
===== CPUmem(GB): tot=1.95e-05 (comb,oper,dvdson,hvec,renorm)=5.94e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8bc113c0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.00063 (comb,oper,dvdson,hvec,renorm)=5.94e-06,1.36e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00142
--- time_cost_gemm_reduction=2.2e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.56e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00128
--- time_cost_gemm_reduction=1.9e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=6.18e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652081087251  -1.00e+03   7.61e-02    2     2   2.00e-03  1.00e-03
    1   1 -      -2.430689876389  -1.00e+03   1.16e-01    2     2   2.00e-03  1.00e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.36e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.81e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.46e-03
--- time_cost_gemm_reduction=2.00e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.42e+07
    2   0 -      -2.654436755681  -2.36e-03   1.10e-02    4     4   5.00e-03  1.25e-03
    2   1 -      -2.436722360483  -6.03e-03   1.83e-02    4     4   5.00e-03  1.25e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.27e-03
--- time_cost_gemm_reduction=1.90e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.22e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.54e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.13e+07
    3   0 -      -2.654509457874  -7.27e-05   3.58e-03    6     6   8.00e-03  1.33e-03
    3   1 -      -2.436951014557  -2.29e-04   5.90e-03    6     6   8.00e-03  1.33e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.28e-03
--- time_cost_gemm_reduction=1.10e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.17e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.27e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.22e+07
    4   0 -      -2.654516214560  -6.76e-06   1.01e-03    6     8   1.10e-02  1.37e-03
    4   1 -      -2.436975310129  -2.43e-05   1.78e-03    6     8   1.10e-02  1.37e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.49e-03
--- time_cost_gemm_reduction=2.00e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.29e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.69e-03
--- time_cost_gemm_reduction=2.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=4.66e+07
    5   0 -      -2.654516839742  -6.25e-07   4.21e-04    6    10   1.40e-02  1.40e-03
    5   1 -      -2.436977310239  -2.00e-06   4.24e-04    6    10   1.40e-02  1.40e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.72e-03
--- time_cost_gemm_reduction=3.90e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=4.59e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.28e-03
--- time_cost_gemm_reduction=1.30e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.18e+07
    6   0 -      -2.654516957904  -1.18e-07   1.26e-04    6    12   1.70e-02  1.42e-03
    6   1 -      -2.436977427914  -1.18e-07   1.80e-04    6    12   1.70e-02  1.42e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.44e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.50e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.26e-03
--- time_cost_gemm_reduction=2.20e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.26e+07
    7   0 +      -2.654516967213  -9.31e-09   3.92e-05    6    14   2.00e-02  1.43e-03
    7   1 +      -2.436977447783  -1.99e-08   6.16e-05    6    14   2.00e-02  1.43e-03
TIMING for Davidson : 2.00e-02  T(cal/comm/rest)=1.40e-02,0.00e+00,6.00e-03
optimized energies: isweep=1 dots=2 ibond=1 e[0]=-2.65451696721
optimized energies: isweep=1 dots=2 ibond=1 e[1]=-2.43697744778
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep1_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=1.954e-05 (comb,oper,dvdson,hvec,renorm)=5.938e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.000e-03 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=1944:0.0148MB:1.45e-05GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=5.94e-06,1.36e-05,0,0,1.81e-06 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=510:0.00389MB:3.8e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=839:0.0064MB:6.25e-06GB
===== CPUmem(GB): tot=4.1e-05 (comb,oper,dvdson,hvec,renorm)=6.25e-06,3.3e-05,0,0,1.81e-06 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=7.21e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 5.00e-02 S #####
 T(fetch) = 1.00e-03 S  per =    2  per(accum) = 2
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 2
 T(dvdsn) = 4.30e-02 S  per =   86  per(accum) = 88
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 88
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 88
 T(renrm) = 3.00e-03 S  per =    6  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -3.9e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 3.9e+12
end rank=0 sweep_twodot
##### time_sweep: 8.60e-02 S #####
 T(fetch) = 1.00e-03 S  per =  1.2  per(accum) = 1.2
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.2
 T(dvdsn) = 7.20e-02 S  per =   84  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 7.00e-03 S  per =  8.1  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -3.36e+09 S  per = -4.7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 3.36e+09 S  per = 4.7e+12
##### time_global: 2.59e-01 S #####
 T(fetch) = 6.00e-03 S  per =  2.3  per(accum) = 2.3
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 2.3
 T(dvdsn) = 2.14e-01 S  per =   83  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 2.00e-02 S  per =  7.7  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -1.01e+10 S  per = -4.7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.01e+10 S  per = 4.7e+12

=== end rank=0 ibond=1

=== start rank=0 ibond=2
ISWEEP,IBOND=1,2

isweep=1 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=510:0.00389MB:3.8e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=839:0.0064MB:6.25e-06GB
===== CPUmem(GB): tot=3.92e-05 (comb,oper,dvdson,hvec,renorm)=6.25e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8be04cf0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.007,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.00065 (comb,oper,dvdson,hvec,renorm)=6.25e-06,3.3e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.0013
--- time_cost_gemm_reduction=1e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=6.08e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00132
--- time_cost_gemm_reduction=1.6e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.99e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588771076  -1.00e+03   7.01e-02    2     2   2.00e-03  1.00e-03
    1   1 -      -2.436093960617  -1.00e+03   4.92e-02    2     2   2.00e-03  1.00e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.32e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.00e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.37e-03
--- time_cost_gemm_reduction=1.20e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.78e+07
    2   0 -      -2.654426819280  -1.84e-03   1.26e-02    4     4   5.00e-03  1.25e-03
    2   1 -      -2.436959163109  -8.65e-04   5.19e-03    4     4   5.00e-03  1.25e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.37e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.78e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.31e-03
--- time_cost_gemm_reduction=1.40e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.02e+07
    3   0 -      -2.654508896837  -8.21e-05   3.56e-03    6     6   8.00e-03  1.33e-03
    3   1 -      -2.436975274429  -1.61e-05   1.59e-03    6     6   8.00e-03  1.33e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.44e-03
--- time_cost_gemm_reduction=1.80e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.47e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.27e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.19e+07
    4   0 -      -2.654515664927  -6.77e-06   1.29e-03    6     8   1.10e-02  1.37e-03
    4   1 -      -2.436977078524  -1.80e-06   5.94e-04    6     8   1.10e-02  1.37e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.28e-03
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.18e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.32e-03
--- time_cost_gemm_reduction=1.00e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.97e+07
    5   0 -      -2.654516771391  -1.11e-06   5.13e-04    6    10   1.30e-02  1.30e-03
    5   1 -      -2.436977369938  -2.91e-07   2.87e-04    6    10   1.30e-02  1.30e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.32e-03
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.99e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.27e-03
--- time_cost_gemm_reduction=2.00e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.22e+07
    6   0 -      -2.654516945145  -1.74e-07   1.83e-04    6    12   1.60e-02  1.33e-03
    6   1 -      -2.436977443895  -7.40e-08   1.16e-04    6    12   1.60e-02  1.33e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.36e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.79e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.50e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.28e+07
    7   0 +      -2.654516966639  -2.15e-08   4.64e-05    6    14   1.90e-02  1.36e-03
    7   1 +      -2.436977450693  -6.80e-09   2.69e-05    6    14   1.90e-02  1.36e-03
TIMING for Davidson : 1.90e-02  T(cal/comm/rest)=1.40e-02,0.00e+00,5.00e-03
optimized energies: isweep=1 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=1 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.9e-05 (comb,oper,dvdson,hvec,renorm)=6.3e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=448:0.00342MB:3.34e-06GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=3.96e-05 (comb,oper,dvdson,hvec,renorm)=6.25e-06,3.3e-05,0,0,4.17e-07 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=520:0.00397MB:3.87e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=953:0.00727MB:7.1e-06GB
===== CPUmem(GB): tot=5.08e-05 (comb,oper,dvdson,hvec,renorm)=7.1e-06,4.33e-05,0,0,4.17e-07 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(3,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=7.69e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 4.60e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 4.00e-02 S  per =   87  per(accum) = 87
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 87
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 87
 T(renrm) = 4.00e-03 S  per =  8.7  per(accum) = 96
 T( save) = 0.00e+00 S  per =    0  per(accum) = 96
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -4.2e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 4.2e+12
end rank=0 sweep_twodot
##### time_sweep: 1.32e-01 S #####
 T(fetch) = 1.00e-03 S  per = 0.76  per(accum) = 0.76
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0.76
 T(dvdsn) = 1.12e-01 S  per =   85  per(accum) = 86
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 86
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 86
 T(renrm) = 1.10e-02 S  per =  8.3  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -5.03e+09 S  per = -4.5e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 5.03e+09 S  per = 4.5e+12
##### time_global: 3.05e-01 S #####
 T(fetch) = 6.00e-03 S  per =    2  per(accum) = 2
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 2
 T(dvdsn) = 2.54e-01 S  per =   83  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 2.40e-02 S  per =  7.9  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -1.17e+10 S  per = -4.6e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.17e+10 S  per = 4.6e+12

=== end rank=0 ibond=2

=== start rank=0 ibond=3
ISWEEP,IBOND=1,3

isweep=1 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.000e-03 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=520:0.00397MB:3.87e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=953:0.00727MB:7.1e-06GB
===== CPUmem(GB): tot=2.07e-05 (comb,oper,dvdson,hvec,renorm)=7.1e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8be04e40
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000632 (comb,oper,dvdson,hvec,renorm)=7.1e-06,1.36e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00156
--- time_cost_gemm_reduction=1.7e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.08e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00152
--- time_cost_gemm_reduction=2.1e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.2e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966639  -1.00e+03   4.64e-05    2     2   3.00e-03  1.50e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   3.00e-03  1.50e-03
TIMING for Davidson : 3.00e-03  T(cal/comm/rest)=2.00e-03,0.00e+00,1.00e-03
optimized energies: isweep=1 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=1 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep1_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=2.071e-05 (comb,oper,dvdson,hvec,renorm)=7.100e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.000e-03 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=1944:0.0148MB:1.45e-05GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=2.25e-05 (comb,oper,dvdson,hvec,renorm)=7.1e-06,1.36e-05,0,0,1.81e-06 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4.18e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.81e-06 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=7.84e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 3.10e-02 S #####
 T(fetch) = 1.00e-03 S  per =  3.2  per(accum) = 3.2
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 3.2
 T(dvdsn) = 2.40e-02 S  per =   77  per(accum) = 81
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 81
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 81
 T(renrm) = 3.00e-03 S  per =  9.7  per(accum) = 90
 T( save) = 0.00e+00 S  per =    0  per(accum) = 90
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 7e+12
end rank=0 sweep_twodot
##### time_sweep: 1.63e-01 S #####
 T(fetch) = 2.00e-03 S  per =  1.2  per(accum) = 1.2
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.2
 T(dvdsn) = 1.36e-01 S  per =   83  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 1.40e-02 S  per =  8.6  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -6.71e+09 S  per = -4.9e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 6.71e+09 S  per = 4.9e+12
##### time_global: 3.36e-01 S #####
 T(fetch) = 7.00e-03 S  per =  2.1  per(accum) = 2.1
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 2.1
 T(dvdsn) = 2.78e-01 S  per =   83  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 2.70e-02 S  per =    8  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -1.34e+10 S  per = -4.8e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.34e+10 S  per = 4.8e+12

=== end rank=0 ibond=3

======================================================================
sweep_data::summary isweep=1
----------------------------------------------------------------------
sweep parameters: isweep=1 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=15 e[0]=-2.65208108725 e[1]=-2.43068987639
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=14 e[0]=-2.65451696721 e[1]=-2.43697744778
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069
 eav_max=-2.54138548182 [ibond=0]  dwt_min=0 [ibond=0]
 eav_min=-2.54574720867 [ibond=2]  dwt_max=0.000578414067149 [ibond=1]
 eav_diff=0.00436172684621
 sweep energies: isweep=1 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[0]=-2.65451696664
 sweep energies: isweep=1 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=1
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Tav/S | Taccum/S| t_kernel/S | t_reduction/S 
         0  2  10  1.00e-04  1.00e-04 | 51 | 1.78e-01 | 3.49e-03 | 1.78e-01 | 5.30e-03 | 6.20e-05
         1  2  20  1.00e-04  0.00e+00 | 45 | 1.69e-01 | 3.76e-03 | 3.47e-01 | 5.14e-03 | 7.20e-05
results: isweep, dcut, dwt, energies (delta_e)
         0      10 +9.51e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
         1      20 +0.00e+00 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

======================================================================
sweep parameters: isweep=2 dots=2 dcut=20 eps=1.00e-04 noise=0.00e+00
======================================================================

=== start rank=0 ibond=0
ISWEEP,IBOND=2,0

isweep=2 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8ba05990
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000651 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00142
--- time_cost_gemm_reduction=2.5e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.55e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00159
--- time_cost_gemm_reduction=2.5e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=4.95e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701465761  -1.00e+03   6.88e-02    2     2   3.00e-03  1.50e-03
    1   1 -      -2.436233901586  -1.00e+03   4.38e-02    2     2   3.00e-03  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.38e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.73e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.37e-03
--- time_cost_gemm_reduction=2.20e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.77e+07
    2   0 -      -2.654428675224  -1.73e-03   1.26e-02    4     4   6.00e-03  1.50e-03
    2   1 -      -2.436964455562  -7.31e-04   4.22e-03    4     4   6.00e-03  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.37e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.75e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.40e-03
--- time_cost_gemm_reduction=2.10e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.63e+07
    3   0 -      -2.654509664616  -8.10e-05   3.66e-03    6     6   8.00e-03  1.33e-03
    3   1 -      -2.436976459235  -1.20e-05   1.11e-03    6     6   8.00e-03  1.33e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.37e-03
--- time_cost_gemm_reduction=2.10e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.78e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.40e-03
--- time_cost_gemm_reduction=2.00e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.63e+07
    4   0 -      -2.654516020750  -6.36e-06   1.14e-03    6     8   1.10e-02  1.37e-03
    4   1 -      -2.436977285929  -8.27e-07   4.03e-04    6     8   1.10e-02  1.37e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.62e-03
--- time_cost_gemm_reduction=1.90e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=4.88e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.37e-03
--- time_cost_gemm_reduction=1.90e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.78e+07
    5   0 -      -2.654516818919  -7.98e-07   4.45e-04    6    10   1.40e-02  1.40e-03
    5   1 -      -2.436977409924  -1.24e-07   2.05e-04    6    10   1.40e-02  1.40e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.37e-03
--- time_cost_gemm_reduction=2.30e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.78e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.35e-03
--- time_cost_gemm_reduction=2.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.83e+07
    6   0 -      -2.654516950785  -1.32e-07   1.57e-04    6    12   1.70e-02  1.42e-03
    6   1 +      -2.436977447170  -3.72e-08   7.42e-05    6    12   1.70e-02  1.42e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.59e-03
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=4.97e+07
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   1.90e-02  1.46e-03
    7   1 +      -2.436977447171  -1.33e-15   7.42e-05    5    13   1.90e-02  1.46e-03
TIMING for Davidson : 1.90e-02  T(cal/comm/rest)=1.30e-02,0.00e+00,6.00e-03
optimized energies: isweep=2 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=2 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=448:0.00342MB:3.34e-06GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.004  T(cal/comm)=0.004,0
===== CPUmem(GB): tot=4.04e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,4.17e-07 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=5.15e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,4.17e-07 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(1,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=7.84e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 4.70e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 4.00e-02 S  per =   85  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 4.00e-03 S  per =  8.5  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -4.2e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 4.2e+12
end rank=0 sweep_twodot
##### time_sweep: 4.70e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 4.00e-02 S  per =   85  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 4.00e-03 S  per =  8.5  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -4.2e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 4.2e+12
##### time_global: 3.83e-01 S #####
 T(fetch) = 7.00e-03 S  per =  1.8  per(accum) = 1.8
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.8
 T(dvdsn) = 3.18e-01 S  per =   83  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 3.10e-02 S  per =  8.1  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -1.51e+10 S  per = -4.7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.51e+10 S  per = 4.7e+12

=== end rank=0 ibond=0

=== start rank=0 ibond=1
ISWEEP,IBOND=2,1

isweep=2 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.000e-03 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8baa6fa0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000632 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00142
--- time_cost_gemm_reduction=1.6e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.55e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00138
--- time_cost_gemm_reduction=2.1e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.73e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   2.00e-03  1.00e-03
    1   1 +      -2.436977447170  -1.00e+03   7.42e-05    2     2   2.00e-03  1.00e-03
TIMING for Davidson : 3.00e-03  T(cal/comm/rest)=2.00e-03,0.00e+00,1.00e-03
optimized energies: isweep=2 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=2 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep2_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=1944:0.0148MB:1.45e-05GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=2.32e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,1.81e-06 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4.18e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.81e-06 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=7.99e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 3.30e-02 S #####
 T(fetch) = 1.00e-03 S  per =    3  per(accum) = 3
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 3
 T(dvdsn) = 2.40e-02 S  per =   73  per(accum) = 76
 T(decim) = 1.00e-03 S  per =    3  per(accum) = 79
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 79
 T(renrm) = 3.00e-03 S  per =  9.1  per(accum) = 88
 T( save) = 0.00e+00 S  per =    0  per(accum) = 88
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 7e+12
end rank=0 sweep_twodot
##### time_sweep: 8.00e-02 S #####
 T(fetch) = 1.00e-03 S  per =  1.2  per(accum) = 1.2
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.2
 T(dvdsn) = 6.40e-02 S  per =   80  per(accum) = 81
 T(decim) = 1.00e-03 S  per =  1.2  per(accum) = 82
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 82
 T(renrm) = 7.00e-03 S  per =  8.8  per(accum) = 91
 T( save) = 0.00e+00 S  per =    0  per(accum) = 91
 T(preprocess_op_wf           ) = -3.36e+09 S  per = -5.2e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 3.36e+09 S  per = 5.2e+12
##### time_global: 4.16e-01 S #####
 T(fetch) = 8.00e-03 S  per =  1.9  per(accum) = 1.9
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.9
 T(dvdsn) = 3.42e-01 S  per =   82  per(accum) = 84
 T(decim) = 1.00e-03 S  per = 0.24  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 3.40e-02 S  per =  8.2  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -1.68e+10 S  per = -4.9e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+10 S  per = 4.9e+12

=== end rank=0 ibond=1

=== start rank=0 ibond=2
ISWEEP,IBOND=2,2

isweep=2 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8bea2c60
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 5.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.006
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000651 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00137
--- time_cost_gemm_reduction=1.5e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.77e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00134
--- time_cost_gemm_reduction=1.9e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.9e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819590  -1.00e+03   7.01e-02    2     2   2.00e-03  1.00e-03
    1   1 -      -2.436094100139  -1.00e+03   4.92e-02    2     2   2.00e-03  1.00e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.43e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.54e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.34e-03
--- time_cost_gemm_reduction=2.10e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.91e+07
    2   0 -      -2.654426863106  -1.84e-03   1.26e-02    4     4   5.00e-03  1.25e-03
    2   1 -      -2.436959129206  -8.65e-04   5.19e-03    4     4   5.00e-03  1.25e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.35e-03
--- time_cost_gemm_reduction=2.20e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.87e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.38e-03
--- time_cost_gemm_reduction=2.00e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.72e+07
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   8.00e-03  1.33e-03
    3   1 -      -2.436975259479  -1.61e-05   1.59e-03    6     6   8.00e-03  1.33e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.35e-03
--- time_cost_gemm_reduction=1.10e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.85e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.33e-03
--- time_cost_gemm_reduction=2.40e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.93e+07
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   1.10e-02  1.37e-03
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   1.10e-02  1.37e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.42e-03
--- time_cost_gemm_reduction=1.80e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.55e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.34e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.91e+07
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   1.40e-02  1.40e-03
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   1.40e-02  1.40e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.47e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.38e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.33e-03
--- time_cost_gemm_reduction=2.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.93e+07
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   1.70e-02  1.42e-03
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   1.70e-02  1.42e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.41e-03
--- time_cost_gemm_reduction=2.00e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.61e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.34e-03
--- time_cost_gemm_reduction=1.40e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.91e+07
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   2.00e-02  1.43e-03
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   2.00e-02  1.43e-03
TIMING for Davidson : 2.00e-02  T(cal/comm/rest)=1.40e-02,0.00e+00,6.00e-03
optimized energies: isweep=2 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=2 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=448:0.00342MB:3.34e-06GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.004  T(cal/comm)=0.004,0
===== CPUmem(GB): tot=4.04e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,4.17e-07 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=5.15e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,4.17e-07 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(3,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=7.99e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 4.80e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 4.20e-02 S  per =   88  per(accum) = 88
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 88
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 88
 T(renrm) = 4.00e-03 S  per =  8.3  per(accum) = 96
 T( save) = 0.00e+00 S  per =    0  per(accum) = 96
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -4e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 4e+12
end rank=0 sweep_twodot
##### time_sweep: 1.28e-01 S #####
 T(fetch) = 1.00e-03 S  per = 0.78  per(accum) = 0.78
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0.78
 T(dvdsn) = 1.06e-01 S  per =   83  per(accum) = 84
 T(decim) = 1.00e-03 S  per = 0.78  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 1.10e-02 S  per =  8.6  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -5.03e+09 S  per = -4.7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 5.03e+09 S  per = 4.7e+12
##### time_global: 4.64e-01 S #####
 T(fetch) = 8.00e-03 S  per =  1.7  per(accum) = 1.7
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.7
 T(dvdsn) = 3.84e-01 S  per =   83  per(accum) = 84
 T(decim) = 1.00e-03 S  per = 0.22  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 3.80e-02 S  per =  8.2  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -1.85e+10 S  per = -4.8e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.85e+10 S  per = 4.8e+12

=== end rank=0 ibond=2

=== start rank=0 ibond=3
ISWEEP,IBOND=2,3

isweep=2 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.000e-03 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8be04cf0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.006
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000632 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00146
--- time_cost_gemm_reduction=2.3e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.42e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00149
--- time_cost_gemm_reduction=1.9e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.32e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   3.00e-03  1.50e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   3.00e-03  1.50e-03
TIMING for Davidson : 3.00e-03  T(cal/comm/rest)=2.00e-03,0.00e+00,1.00e-03
optimized energies: isweep=2 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=2 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep2_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.000e-03 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=1944:0.0148MB:1.45e-05GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=2.32e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,1.81e-06 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4.18e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.81e-06 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=8.14e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 3.10e-02 S #####
 T(fetch) = 1.00e-03 S  per =  3.2  per(accum) = 3.2
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 3.2
 T(dvdsn) = 2.40e-02 S  per =   77  per(accum) = 81
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 81
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 81
 T(renrm) = 3.00e-03 S  per =  9.7  per(accum) = 90
 T( save) = 0.00e+00 S  per =    0  per(accum) = 90
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 7e+12
end rank=0 sweep_twodot
##### time_sweep: 1.59e-01 S #####
 T(fetch) = 2.00e-03 S  per =  1.3  per(accum) = 1.3
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.3
 T(dvdsn) = 1.30e-01 S  per =   82  per(accum) = 83
 T(decim) = 1.00e-03 S  per = 0.63  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 1.40e-02 S  per =  8.8  per(accum) = 92
 T( save) = 0.00e+00 S  per =    0  per(accum) = 92
 T(preprocess_op_wf           ) = -6.71e+09 S  per = -5.2e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 6.71e+09 S  per = 5.2e+12
##### time_global: 4.95e-01 S #####
 T(fetch) = 9.00e-03 S  per =  1.8  per(accum) = 1.8
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.8
 T(dvdsn) = 4.08e-01 S  per =   82  per(accum) = 84
 T(decim) = 1.00e-03 S  per =  0.2  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 4.10e-02 S  per =  8.3  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -2.01e+10 S  per = -4.9e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.01e+10 S  per = 4.9e+12

=== end rank=0 ibond=3

======================================================================
sweep_data::summary isweep=2
----------------------------------------------------------------------
sweep parameters: isweep=2 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069
 eav_max=-2.54574720706 [ibond=1]  dwt_min=0 [ibond=0]
 eav_min=-2.54574720867 [ibond=2]  dwt_max=0.000578360234058 [ibond=1]
 eav_diff=1.60478741407e-09
 sweep energies: isweep=2 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[0]=-2.65451696664
 sweep energies: isweep=2 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=2
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Tav/S | Taccum/S| t_kernel/S | t_reduction/S 
         0  2  10  1.00e-04  1.00e-04 | 51 | 1.78e-01 | 3.49e-03 | 1.78e-01 | 5.30e-03 | 6.20e-05
         1  2  20  1.00e-04  0.00e+00 | 45 | 1.69e-01 | 3.76e-03 | 3.47e-01 | 5.14e-03 | 7.20e-05
         2  2  20  1.00e-04  0.00e+00 | 31 | 1.65e-01 | 5.32e-03 | 5.12e-01 | 5.79e-03 | 7.10e-05
results: isweep, dcut, dwt, energies (delta_e)
         0      10 +9.51e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
         1      20 +0.00e+00 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.66e-13)
         2      20 +0.00e+00 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

======================================================================
sweep parameters: isweep=3 dots=2 dcut=20 eps=1.00e-04 noise=0.00e+00
======================================================================

=== start rank=0 ibond=0
ISWEEP,IBOND=3,0

isweep=3 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8ba05990
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 4.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000651 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00149
--- time_cost_gemm_reduction=2.1e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.3e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00154
--- time_cost_gemm_reduction=2.4e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.12e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891  -1.00e+03   6.88e-02    2     2   3.00e-03  1.50e-03
    1   1 -      -2.436233901339  -1.00e+03   4.38e-02    2     2   3.00e-03  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.45e-03
--- time_cost_gemm_reduction=2.40e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.43e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.45e-03
--- time_cost_gemm_reduction=1.90e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.44e+07
    2   0 -      -2.654428675110  -1.73e-03   1.26e-02    4     4   6.00e-03  1.50e-03
    2   1 -      -2.436964455587  -7.31e-04   4.22e-03    4     4   6.00e-03  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.64e-03
--- time_cost_gemm_reduction=2.00e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=4.81e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.46e-03
--- time_cost_gemm_reduction=2.00e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.41e+07
    3   0 -      -2.654509664652  -8.10e-05   3.66e-03    6     6   9.00e-03  1.50e-03
    3   1 -      -2.436976459250  -1.20e-05   1.11e-03    6     6   9.00e-03  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.51e-03
--- time_cost_gemm_reduction=1.90e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.24e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.45e-03
--- time_cost_gemm_reduction=2.20e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.45e+07
    4   0 -      -2.654516020764  -6.36e-06   1.14e-03    6     8   1.20e-02  1.50e-03
    4   1 -      -2.436977285934  -8.27e-07   4.03e-04    6     8   1.20e-02  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.45e-03
--- time_cost_gemm_reduction=2.10e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.44e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.42e-03
--- time_cost_gemm_reduction=2.30e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.56e+07
    5   0 -      -2.654516818921  -7.98e-07   4.45e-04    6    10   1.50e-02  1.50e-03
    5   1 -      -2.436977409925  -1.24e-07   2.05e-04    6    10   1.50e-02  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.38e-03
--- time_cost_gemm_reduction=2.70e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.71e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.53e-03
--- time_cost_gemm_reduction=2.40e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.15e+07
    6   0 -      -2.654516950786  -1.32e-07   1.57e-04    6    12   1.80e-02  1.50e-03
    6   1 +      -2.436977447171  -3.72e-08   7.42e-05    6    12   1.80e-02  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.42e-03
--- time_cost_gemm_reduction=2.70e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.55e+07
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   2.00e-02  1.54e-03
    7   1 +      -2.436977447171   0.00e+00   7.42e-05    5    13   2.00e-02  1.54e-03
TIMING for Davidson : 2.00e-02  T(cal/comm/rest)=1.30e-02,0.00e+00,7.00e-03
optimized energies: isweep=3 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=3 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=448:0.00342MB:3.34e-06GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=4.04e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,4.17e-07 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=5.15e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,4.17e-07 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(1,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=8.14e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 4.80e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 4.20e-02 S  per =   88  per(accum) = 88
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 88
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 88
 T(renrm) = 4.00e-03 S  per =  8.3  per(accum) = 96
 T( save) = 0.00e+00 S  per =    0  per(accum) = 96
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -4e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 4e+12
end rank=0 sweep_twodot
##### time_sweep: 4.80e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 4.20e-02 S  per =   88  per(accum) = 88
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 88
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 88
 T(renrm) = 4.00e-03 S  per =  8.3  per(accum) = 96
 T( save) = 0.00e+00 S  per =    0  per(accum) = 96
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -4e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 4e+12
##### time_global: 5.43e-01 S #####
 T(fetch) = 9.00e-03 S  per =  1.7  per(accum) = 1.7
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.7
 T(dvdsn) = 4.50e-01 S  per =   83  per(accum) = 85
 T(decim) = 1.00e-03 S  per = 0.18  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 4.50e-02 S  per =  8.3  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -2.18e+10 S  per = -4.8e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.18e+10 S  per = 4.8e+12

=== end rank=0 ibond=0

=== start rank=0 ibond=1
ISWEEP,IBOND=3,1

isweep=3 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.000e-03 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8bc12c90
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000632 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00147
--- time_cost_gemm_reduction=2.1e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.37e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00134
--- time_cost_gemm_reduction=1.7e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.9e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   2.00e-03  1.00e-03
    1   1 +      -2.436977447171  -1.00e+03   7.42e-05    2     2   2.00e-03  1.00e-03
TIMING for Davidson : 2.00e-03  T(cal/comm/rest)=2.00e-03,0.00e+00,0.00e+00
optimized energies: isweep=3 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=3 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep3_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.000e-03 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=1944:0.0148MB:1.45e-05GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=2.32e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,1.81e-06 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4.18e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.81e-06 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=8.29e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 3.00e-02 S #####
 T(fetch) = 1.00e-03 S  per =  3.3  per(accum) = 3.3
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 3.3
 T(dvdsn) = 2.30e-02 S  per =   77  per(accum) = 80
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 80
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 80
 T(renrm) = 3.00e-03 S  per =   10  per(accum) = 90
 T( save) = 0.00e+00 S  per =    0  per(accum) = 90
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -7.3e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 7.3e+12
end rank=0 sweep_twodot
##### time_sweep: 7.80e-02 S #####
 T(fetch) = 1.00e-03 S  per =  1.3  per(accum) = 1.3
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.3
 T(dvdsn) = 6.50e-02 S  per =   83  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 7.00e-03 S  per =    9  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -3.36e+09 S  per = -5.2e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 3.36e+09 S  per = 5.2e+12
##### time_global: 5.73e-01 S #####
 T(fetch) = 1.00e-02 S  per =  1.7  per(accum) = 1.7
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.7
 T(dvdsn) = 4.73e-01 S  per =   83  per(accum) = 84
 T(decim) = 1.00e-03 S  per = 0.17  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 4.80e-02 S  per =  8.4  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -2.35e+10 S  per = -5e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.35e+10 S  per = 5e+12

=== end rank=0 ibond=1

=== start rank=0 ibond=2
ISWEEP,IBOND=3,2

isweep=3 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8ba05990
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.007,0.008
----- TIMING FOR preprocess_formulae_Hxlist2 : 8.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000651 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.0014
--- time_cost_gemm_reduction=1.1e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.63e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00128
--- time_cost_gemm_reduction=2e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=6.15e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592  -1.00e+03   7.01e-02    2     2   2.00e-03  1.00e-03
    1   1 -      -2.436094100141  -1.00e+03   4.92e-02    2     2   2.00e-03  1.00e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.28e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.17e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.32e-03
--- time_cost_gemm_reduction=1.40e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.96e+07
    2   0 -      -2.654426863105  -1.84e-03   1.26e-02    4     4   5.00e-03  1.25e-03
    2   1 -      -2.436959129202  -8.65e-04   5.19e-03    4     4   5.00e-03  1.25e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.33e-03
--- time_cost_gemm_reduction=1.80e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.95e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.34e-03
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.88e+07
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   8.00e-03  1.33e-03
    3   1 -      -2.436975259478  -1.61e-05   1.59e-03    6     6   8.00e-03  1.33e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.29e-03
--- time_cost_gemm_reduction=1.80e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.14e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.40e-03
--- time_cost_gemm_reduction=1.80e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.66e+07
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   1.10e-02  1.37e-03
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   1.10e-02  1.37e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.48e-03
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.34e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.27e-03
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.20e+07
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   1.40e-02  1.40e-03
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   1.40e-02  1.40e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.81e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=4.36e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.32e-03
--- time_cost_gemm_reduction=1.00e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.00e+07
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   1.70e-02  1.42e-03
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   1.70e-02  1.42e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.36e-03
--- time_cost_gemm_reduction=1.30e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.80e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.59e-03
--- time_cost_gemm_reduction=1.80e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=4.96e+07
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   2.00e-02  1.43e-03
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   2.00e-02  1.43e-03
TIMING for Davidson : 2.00e-02  T(cal/comm/rest)=1.40e-02,0.00e+00,6.00e-03
optimized energies: isweep=3 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=3 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=448:0.00342MB:3.34e-06GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.004  T(cal/comm)=0.004,0
===== CPUmem(GB): tot=4.04e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,4.17e-07 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=5.15e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,4.17e-07 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(3,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=8.29e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 4.90e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 4.20e-02 S  per =   86  per(accum) = 86
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 86
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 86
 T(renrm) = 4.00e-03 S  per =  8.2  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -4e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 4e+12
end rank=0 sweep_twodot
##### time_sweep: 1.27e-01 S #####
 T(fetch) = 1.00e-03 S  per = 0.79  per(accum) = 0.79
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0.79
 T(dvdsn) = 1.07e-01 S  per =   84  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 1.10e-02 S  per =  8.7  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -5.03e+09 S  per = -4.7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 5.03e+09 S  per = 4.7e+12
##### time_global: 6.22e-01 S #####
 T(fetch) = 1.00e-02 S  per =  1.6  per(accum) = 1.6
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.6
 T(dvdsn) = 5.15e-01 S  per =   83  per(accum) = 84
 T(decim) = 1.00e-03 S  per = 0.16  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 5.20e-02 S  per =  8.4  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -2.52e+10 S  per = -4.9e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.52e+10 S  per = 4.9e+12

=== end rank=0 ibond=2

=== start rank=0 ibond=3
ISWEEP,IBOND=3,3

isweep=3 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.000e-03 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8ea04320
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000632 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.0015
--- time_cost_gemm_reduction=2.3e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.25e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00145
--- time_cost_gemm_reduction=2.2e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.45e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   3.00e-03  1.50e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   3.00e-03  1.50e-03
TIMING for Davidson : 3.00e-03  T(cal/comm/rest)=2.00e-03,0.00e+00,1.00e-03
optimized energies: isweep=3 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=3 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep3_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.000e-03 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=1944:0.0148MB:1.45e-05GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=2.32e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,1.81e-06 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4.18e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.81e-06 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=8.44e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 3.10e-02 S #####
 T(fetch) = 1.00e-03 S  per =  3.2  per(accum) = 3.2
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 3.2
 T(dvdsn) = 2.40e-02 S  per =   77  per(accum) = 81
 T(decim) = 1.00e-03 S  per =  3.2  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 3.00e-03 S  per =  9.7  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 7e+12
end rank=0 sweep_twodot
##### time_sweep: 1.58e-01 S #####
 T(fetch) = 2.00e-03 S  per =  1.3  per(accum) = 1.3
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.3
 T(dvdsn) = 1.31e-01 S  per =   83  per(accum) = 84
 T(decim) = 1.00e-03 S  per = 0.63  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 1.40e-02 S  per =  8.9  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -6.71e+09 S  per = -5.1e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 6.71e+09 S  per = 5.1e+12
##### time_global: 6.53e-01 S #####
 T(fetch) = 1.10e-02 S  per =  1.7  per(accum) = 1.7
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.7
 T(dvdsn) = 5.39e-01 S  per =   83  per(accum) = 84
 T(decim) = 2.00e-03 S  per = 0.31  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 5.50e-02 S  per =  8.4  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -2.68e+10 S  per = -5e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.68e+10 S  per = 5e+12

=== end rank=0 ibond=3

======================================================================
sweep_data::summary isweep=3
----------------------------------------------------------------------
sweep parameters: isweep=3 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069
 eav_max=-2.54574720706 [ibond=1]  dwt_min=0 [ibond=0]
 eav_min=-2.54574720867 [ibond=2]  dwt_max=0.00057836023195 [ibond=1]
 eav_diff=1.60474877831e-09
 sweep energies: isweep=3 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[0]=-2.65451696664
 sweep energies: isweep=3 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=3
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Tav/S | Taccum/S| t_kernel/S | t_reduction/S 
         0  2  10  1.00e-04  1.00e-04 | 51 | 1.78e-01 | 3.49e-03 | 1.78e-01 | 5.30e-03 | 6.20e-05
         1  2  20  1.00e-04  0.00e+00 | 45 | 1.69e-01 | 3.76e-03 | 3.47e-01 | 5.14e-03 | 7.20e-05
         2  2  20  1.00e-04  0.00e+00 | 31 | 1.65e-01 | 5.32e-03 | 5.12e-01 | 5.79e-03 | 7.10e-05
         3  2  20  1.00e-04  0.00e+00 | 31 | 1.64e-01 | 5.29e-03 | 6.76e-01 | 5.80e-03 | 8.40e-05
results: isweep, dcut, dwt, energies (delta_e)
         0      10 +9.51e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
         1      20 +0.00e+00 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.66e-13)
         2      20 +0.00e+00 e[0]=-2.65451696664 (-4.44e-16) e[1]=-2.43697745069 (-4.44e-16)
         3      20 +0.00e+00 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

======================================================================
sweep parameters: isweep=4 dots=2 dcut=20 eps=1.00e-04 noise=0.00e+00
======================================================================

=== start rank=0 ibond=0
ISWEEP,IBOND=4,0

isweep=4 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8ba05990
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 4.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000651 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00147
--- time_cost_gemm_reduction=1.6e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.39e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.0015
--- time_cost_gemm_reduction=2.1e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.28e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891  -1.00e+03   6.88e-02    2     2   3.00e-03  1.50e-03
    1   1 -      -2.436233901339  -1.00e+03   4.38e-02    2     2   3.00e-03  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.37e-03
--- time_cost_gemm_reduction=2.00e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.75e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.48e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.33e+07
    2   0 -      -2.654428675110  -1.73e-03   1.26e-02    4     4   6.00e-03  1.50e-03
    2   1 -      -2.436964455587  -7.31e-04   4.22e-03    4     4   6.00e-03  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.43e-03
--- time_cost_gemm_reduction=1.80e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.53e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.38e-03
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.73e+07
    3   0 -      -2.654509664652  -8.10e-05   3.66e-03    6     6   9.00e-03  1.50e-03
    3   1 -      -2.436976459250  -1.20e-05   1.11e-03    6     6   9.00e-03  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.47e-03
--- time_cost_gemm_reduction=1.30e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.39e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.41e-03
--- time_cost_gemm_reduction=2.30e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.61e+07
    4   0 -      -2.654516020764  -6.36e-06   1.14e-03    6     8   1.20e-02  1.50e-03
    4   1 -      -2.436977285934  -8.27e-07   4.03e-04    6     8   1.20e-02  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.54e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.14e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.43e-03
--- time_cost_gemm_reduction=1.90e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.53e+07
    5   0 -      -2.654516818921  -7.98e-07   4.45e-04    6    10   1.50e-02  1.50e-03
    5   1 -      -2.436977409925  -1.24e-07   2.05e-04    6    10   1.50e-02  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.42e-03
--- time_cost_gemm_reduction=2.40e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.58e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.37e-03
--- time_cost_gemm_reduction=2.40e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.75e+07
    6   0 -      -2.654516950786  -1.32e-07   1.57e-04    6    12   1.80e-02  1.50e-03
    6   1 +      -2.436977447171  -3.72e-08   7.42e-05    6    12   1.80e-02  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.54e-03
--- time_cost_gemm_reduction=2.40e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.13e+07
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   1.90e-02  1.46e-03
    7   1 +      -2.436977447171  -2.66e-15   7.42e-05    5    13   1.90e-02  1.46e-03
TIMING for Davidson : 1.90e-02  T(cal/comm/rest)=1.30e-02,0.00e+00,6.00e-03
optimized energies: isweep=4 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=4 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=448:0.00342MB:3.34e-06GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=4.04e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,4.17e-07 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=5.15e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,4.17e-07 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(1,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=8.44e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 4.70e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 4.00e-02 S  per =   85  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 4.00e-03 S  per =  8.5  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -4.2e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 4.2e+12
end rank=0 sweep_twodot
##### time_sweep: 4.70e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 4.00e-02 S  per =   85  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 4.00e-03 S  per =  8.5  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -4.2e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 4.2e+12
##### time_global: 7.00e-01 S #####
 T(fetch) = 1.10e-02 S  per =  1.6  per(accum) = 1.6
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.6
 T(dvdsn) = 5.79e-01 S  per =   83  per(accum) = 84
 T(decim) = 2.00e-03 S  per = 0.29  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 5.90e-02 S  per =  8.4  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -2.85e+10 S  per = -4.9e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.85e+10 S  per = 4.9e+12

=== end rank=0 ibond=0

=== start rank=0 ibond=1
ISWEEP,IBOND=4,1

isweep=4 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.000e-03 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8baad530
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 4.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.007,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000632 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00133
--- time_cost_gemm_reduction=1.9e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.93e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00128
--- time_cost_gemm_reduction=2.1e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=6.16e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   2.00e-03  1.00e-03
    1   1 +      -2.436977447171  -1.00e+03   7.42e-05    2     2   2.00e-03  1.00e-03
TIMING for Davidson : 2.00e-03  T(cal/comm/rest)=2.00e-03,0.00e+00,0.00e+00
optimized energies: isweep=4 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=4 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep4_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.000e-03 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=1944:0.0148MB:1.45e-05GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=2.32e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,1.81e-06 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4.18e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.81e-06 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=8.59e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 3.20e-02 S #####
 T(fetch) = 1.00e-03 S  per =  3.1  per(accum) = 3.1
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 3.1
 T(dvdsn) = 2.50e-02 S  per =   78  per(accum) = 81
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 81
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 81
 T(renrm) = 3.00e-03 S  per =  9.4  per(accum) = 91
 T( save) = 0.00e+00 S  per =    0  per(accum) = 91
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -6.7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 6.7e+12
end rank=0 sweep_twodot
##### time_sweep: 7.90e-02 S #####
 T(fetch) = 1.00e-03 S  per =  1.3  per(accum) = 1.3
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.3
 T(dvdsn) = 6.50e-02 S  per =   82  per(accum) = 84
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 7.00e-03 S  per =  8.9  per(accum) = 92
 T( save) = 0.00e+00 S  per =    0  per(accum) = 92
 T(preprocess_op_wf           ) = -3.36e+09 S  per = -5.2e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 3.36e+09 S  per = 5.2e+12
##### time_global: 7.32e-01 S #####
 T(fetch) = 1.20e-02 S  per =  1.6  per(accum) = 1.6
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.6
 T(dvdsn) = 6.04e-01 S  per =   83  per(accum) = 84
 T(decim) = 2.00e-03 S  per = 0.27  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 6.20e-02 S  per =  8.5  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -3.02e+10 S  per = -5e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 3.02e+10 S  per = 5e+12

=== end rank=0 ibond=1

=== start rank=0 ibond=2
ISWEEP,IBOND=4,2

isweep=4 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8bb05080
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000651 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00131
--- time_cost_gemm_reduction=1.4e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=6.02e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00127
--- time_cost_gemm_reduction=1.1e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=6.2e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592  -1.00e+03   7.01e-02    2     2   2.00e-03  1.00e-03
    1   1 -      -2.436094100141  -1.00e+03   4.92e-02    2     2   2.00e-03  1.00e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.31e-03
--- time_cost_gemm_reduction=1.90e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.02e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.27e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.22e+07
    2   0 -      -2.654426863105  -1.84e-03   1.26e-02    4     4   5.00e-03  1.25e-03
    2   1 -      -2.436959129202  -8.65e-04   5.19e-03    4     4   5.00e-03  1.25e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.48e-03
--- time_cost_gemm_reduction=1.80e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.32e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.31e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.04e+07
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   8.00e-03  1.33e-03
    3   1 -      -2.436975259478  -1.61e-05   1.59e-03    6     6   8.00e-03  1.33e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.31e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.01e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.27e-03
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.20e+07
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   1.10e-02  1.37e-03
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   1.10e-02  1.37e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.27e-03
--- time_cost_gemm_reduction=1.20e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.20e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.32e-03
--- time_cost_gemm_reduction=1.40e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.98e+07
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   1.30e-02  1.30e-03
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   1.30e-02  1.30e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.40e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.66e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.52e-03
--- time_cost_gemm_reduction=2.10e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.19e+07
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   1.60e-02  1.33e-03
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   1.60e-02  1.33e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.29e-03
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=6.10e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.40e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.65e+07
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   1.90e-02  1.36e-03
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   1.90e-02  1.36e-03
TIMING for Davidson : 1.90e-02  T(cal/comm/rest)=1.40e-02,0.00e+00,5.00e-03
optimized energies: isweep=4 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=4 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=448:0.00342MB:3.34e-06GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=4.04e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,4.17e-07 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=5.15e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,4.17e-07 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(3,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=8.59e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 4.70e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 4.10e-02 S  per =   87  per(accum) = 87
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 87
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 87
 T(renrm) = 4.00e-03 S  per =  8.5  per(accum) = 96
 T( save) = 0.00e+00 S  per =    0  per(accum) = 96
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -4.1e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 4.1e+12
end rank=0 sweep_twodot
##### time_sweep: 1.26e-01 S #####
 T(fetch) = 1.00e-03 S  per = 0.79  per(accum) = 0.79
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0.79
 T(dvdsn) = 1.06e-01 S  per =   84  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 1.10e-02 S  per =  8.7  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -5.03e+09 S  per = -4.7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 5.03e+09 S  per = 4.7e+12
##### time_global: 7.79e-01 S #####
 T(fetch) = 1.20e-02 S  per =  1.5  per(accum) = 1.5
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.5
 T(dvdsn) = 6.45e-01 S  per =   83  per(accum) = 84
 T(decim) = 2.00e-03 S  per = 0.26  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 6.60e-02 S  per =  8.5  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -3.19e+10 S  per = -4.9e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 3.19e+10 S  per = 4.9e+12

=== end rank=0 ibond=2

=== start rank=0 ibond=3
ISWEEP,IBOND=4,3

isweep=4 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.000e-03 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8bc126a0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.006
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000632 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00193
--- time_cost_gemm_reduction=2.2e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=4.09e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00158
--- time_cost_gemm_reduction=2.6e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.01e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   3.00e-03  1.50e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   3.00e-03  1.50e-03
TIMING for Davidson : 3.00e-03  T(cal/comm/rest)=3.00e-03,0.00e+00,0.00e+00
optimized energies: isweep=4 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=4 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep4_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.000e-03 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=1944:0.0148MB:1.45e-05GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=2.32e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,1.81e-06 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4.18e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.81e-06 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=8.74e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 3.30e-02 S #####
 T(fetch) = 1.00e-03 S  per =    3  per(accum) = 3
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 3
 T(dvdsn) = 2.40e-02 S  per =   73  per(accum) = 76
 T(decim) = 1.00e-03 S  per =    3  per(accum) = 79
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 79
 T(renrm) = 4.00e-03 S  per =   12  per(accum) = 91
 T( save) = 0.00e+00 S  per =    0  per(accum) = 91
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 7e+12
end rank=0 sweep_twodot
##### time_sweep: 1.59e-01 S #####
 T(fetch) = 2.00e-03 S  per =  1.3  per(accum) = 1.3
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.3
 T(dvdsn) = 1.30e-01 S  per =   82  per(accum) = 83
 T(decim) = 1.00e-03 S  per = 0.63  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 1.50e-02 S  per =  9.4  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -6.71e+09 S  per = -5.2e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 6.71e+09 S  per = 5.2e+12
##### time_global: 8.12e-01 S #####
 T(fetch) = 1.30e-02 S  per =  1.6  per(accum) = 1.6
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.6
 T(dvdsn) = 6.69e-01 S  per =   82  per(accum) = 84
 T(decim) = 3.00e-03 S  per = 0.37  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 7.00e-02 S  per =  8.6  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -3.36e+10 S  per = -5e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 3.36e+10 S  per = 5e+12

=== end rank=0 ibond=3

======================================================================
sweep_data::summary isweep=4
----------------------------------------------------------------------
sweep parameters: isweep=4 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069
 eav_max=-2.54574720706 [ibond=1]  dwt_min=0 [ibond=0]
 eav_min=-2.54574720867 [ibond=3]  dwt_max=0.00057836023195 [ibond=1]
 eav_diff=1.60474744604e-09
 sweep energies: isweep=4 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[0]=-2.65451696664
 sweep energies: isweep=4 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=4
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Tav/S | Taccum/S| t_kernel/S | t_reduction/S 
         0  2  10  1.00e-04  1.00e-04 | 51 | 1.78e-01 | 3.49e-03 | 1.78e-01 | 5.30e-03 | 6.20e-05
         1  2  20  1.00e-04  0.00e+00 | 45 | 1.69e-01 | 3.76e-03 | 3.47e-01 | 5.14e-03 | 7.20e-05
         2  2  20  1.00e-04  0.00e+00 | 31 | 1.65e-01 | 5.32e-03 | 5.12e-01 | 5.79e-03 | 7.10e-05
         3  2  20  1.00e-04  0.00e+00 | 31 | 1.64e-01 | 5.29e-03 | 6.76e-01 | 5.80e-03 | 8.40e-05
         4  2  20  1.00e-04  0.00e+00 | 31 | 1.65e-01 | 5.32e-03 | 8.41e-01 | 5.80e-03 | 8.70e-05
results: isweep, dcut, dwt, energies (delta_e)
         0      10 +9.51e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
         1      20 +0.00e+00 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.68e-13)
         2      20 +0.00e+00 e[0]=-2.65451696664 (4.44e-16) e[1]=-2.43697745069 (-2.22e-15)
         3      20 +0.00e+00 e[0]=-2.65451696664 (8.88e-16) e[1]=-2.43697745069 (-1.78e-15)
         4      20 +5.26e-04 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

======================================================================
sweep parameters: isweep=5 dots=2 dcut=20 eps=1.00e-04 noise=0.00e+00
======================================================================

=== start rank=0 ibond=0
ISWEEP,IBOND=5,0

isweep=5 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8ea044d0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 4.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.007,0.008
----- TIMING FOR preprocess_formulae_Hxlist2 : 8.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000651 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00144
--- time_cost_gemm_reduction=1.2e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.5e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00167
--- time_cost_gemm_reduction=1.7e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=4.74e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891  -1.00e+03   6.88e-02    2     2   3.00e-03  1.50e-03
    1   1 -      -2.436233901339  -1.00e+03   4.38e-02    2     2   3.00e-03  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.48e-03
--- time_cost_gemm_reduction=3.90e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.34e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.62e-03
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=4.87e+07
    2   0 -      -2.654428675110  -1.73e-03   1.26e-02    4     4   6.00e-03  1.50e-03
    2   1 -      -2.436964455587  -7.31e-04   4.22e-03    4     4   6.00e-03  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.40e-03
--- time_cost_gemm_reduction=2.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.66e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.47e-03
--- time_cost_gemm_reduction=2.00e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.38e+07
    3   0 -      -2.654509664652  -8.10e-05   3.66e-03    6     6   9.00e-03  1.50e-03
    3   1 -      -2.436976459250  -1.20e-05   1.11e-03    6     6   9.00e-03  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.40e-03
--- time_cost_gemm_reduction=2.10e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.66e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.39e-03
--- time_cost_gemm_reduction=1.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.67e+07
    4   0 -      -2.654516020764  -6.36e-06   1.14e-03    6     8   1.20e-02  1.50e-03
    4   1 -      -2.436977285934  -8.27e-07   4.03e-04    6     8   1.20e-02  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.52e-03
--- time_cost_gemm_reduction=1.90e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.20e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.59e-03
--- time_cost_gemm_reduction=2.50e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=4.96e+07
    5   0 -      -2.654516818921  -7.98e-07   4.45e-04    6    10   1.50e-02  1.50e-03
    5   1 -      -2.436977409925  -1.24e-07   2.05e-04    6    10   1.50e-02  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.61e-03
--- time_cost_gemm_reduction=1.40e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=4.91e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.39e-03
--- time_cost_gemm_reduction=1.80e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.67e+07
    6   0 -      -2.654516950786  -1.32e-07   1.57e-04    6    12   1.80e-02  1.50e-03
    6   1 +      -2.436977447171  -3.72e-08   7.42e-05    6    12   1.80e-02  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.57e-03
--- time_cost_gemm_reduction=2.10e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.04e+07
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   2.00e-02  1.54e-03
    7   1 +      -2.436977447171  -3.55e-15   7.42e-05    5    13   2.00e-02  1.54e-03
TIMING for Davidson : 2.00e-02  T(cal/comm/rest)=1.30e-02,0.00e+00,7.00e-03
optimized energies: isweep=5 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=5 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=448:0.00342MB:3.34e-06GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.004  T(cal/comm)=0.004,0
===== CPUmem(GB): tot=4.04e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,4.17e-07 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=5.15e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,4.17e-07 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(1,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=8.74e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 5.00e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 4.40e-02 S  per =   88  per(accum) = 88
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 88
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 88
 T(renrm) = 4.00e-03 S  per =    8  per(accum) = 96
 T( save) = 0.00e+00 S  per =    0  per(accum) = 96
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -3.8e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 3.8e+12
end rank=0 sweep_twodot
##### time_sweep: 5.00e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 4.40e-02 S  per =   88  per(accum) = 88
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 88
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 88
 T(renrm) = 4.00e-03 S  per =    8  per(accum) = 96
 T( save) = 0.00e+00 S  per =    0  per(accum) = 96
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -3.8e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 3.8e+12
##### time_global: 8.62e-01 S #####
 T(fetch) = 1.30e-02 S  per =  1.5  per(accum) = 1.5
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.5
 T(dvdsn) = 7.13e-01 S  per =   83  per(accum) = 84
 T(decim) = 3.00e-03 S  per = 0.35  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 7.40e-02 S  per =  8.6  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -3.52e+10 S  per = -4.9e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 3.52e+10 S  per = 4.9e+12

=== end rank=0 ibond=0

=== start rank=0 ibond=1
ISWEEP,IBOND=5,1

isweep=5 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.000e-03 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8af0e230
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000632 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00134
--- time_cost_gemm_reduction=1.8e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.9e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00137
--- time_cost_gemm_reduction=1.5e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.76e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   2.00e-03  1.00e-03
    1   1 +      -2.436977447171  -1.00e+03   7.42e-05    2     2   2.00e-03  1.00e-03
TIMING for Davidson : 2.00e-03  T(cal/comm/rest)=2.00e-03,0.00e+00,0.00e+00
optimized energies: isweep=5 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=5 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep5_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.000e-03 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=1944:0.0148MB:1.45e-05GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=2.32e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,1.81e-06 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4.18e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.81e-06 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=8.89e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 3.00e-02 S #####
 T(fetch) = 1.00e-03 S  per =  3.3  per(accum) = 3.3
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 3.3
 T(dvdsn) = 2.30e-02 S  per =   77  per(accum) = 80
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 80
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 80
 T(renrm) = 3.00e-03 S  per =   10  per(accum) = 90
 T( save) = 0.00e+00 S  per =    0  per(accum) = 90
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -7.3e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 7.3e+12
end rank=0 sweep_twodot
##### time_sweep: 8.00e-02 S #####
 T(fetch) = 1.00e-03 S  per =  1.2  per(accum) = 1.2
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.2
 T(dvdsn) = 6.70e-02 S  per =   84  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 7.00e-03 S  per =  8.8  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -3.36e+09 S  per = -5e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 3.36e+09 S  per = 5e+12
##### time_global: 8.92e-01 S #####
 T(fetch) = 1.40e-02 S  per =  1.6  per(accum) = 1.6
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.6
 T(dvdsn) = 7.36e-01 S  per =   83  per(accum) = 84
 T(decim) = 3.00e-03 S  per = 0.34  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 7.70e-02 S  per =  8.6  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -3.69e+10 S  per = -5e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 3.69e+10 S  per = 5e+12

=== end rank=0 ibond=1

=== start rank=0 ibond=2
ISWEEP,IBOND=5,2

isweep=5 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8ea08d30
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 4.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.007,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000651 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00141
--- time_cost_gemm_reduction=2.2e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.6e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00172
--- time_cost_gemm_reduction=2.4e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=4.6e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592  -1.00e+03   7.01e-02    2     2   3.00e-03  1.50e-03
    1   1 -      -2.436094100141  -1.00e+03   4.92e-02    2     2   3.00e-03  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.34e-03
--- time_cost_gemm_reduction=1.70e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.88e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.40e-03
--- time_cost_gemm_reduction=1.80e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.63e+07
    2   0 -      -2.654426863105  -1.84e-03   1.26e-02    4     4   6.00e-03  1.50e-03
    2   1 -      -2.436959129202  -8.65e-04   5.19e-03    4     4   6.00e-03  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.39e-03
--- time_cost_gemm_reduction=2.10e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.66e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.34e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.90e+07
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   9.00e-03  1.50e-03
    3   1 -      -2.436975259478  -1.61e-05   1.59e-03    6     6   9.00e-03  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.34e-03
--- time_cost_gemm_reduction=1.60e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.89e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.34e-03
--- time_cost_gemm_reduction=2.20e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.88e+07
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   1.10e-02  1.37e-03
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   1.10e-02  1.37e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.35e-03
--- time_cost_gemm_reduction=2.30e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.85e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.54e-03
--- time_cost_gemm_reduction=1.40e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.12e+07
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   1.50e-02  1.50e-03
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   1.50e-02  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.37e-03
--- time_cost_gemm_reduction=1.40e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.77e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.49e-03
--- time_cost_gemm_reduction=1.80e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.29e+07
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   1.80e-02  1.50e-03
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   1.80e-02  1.50e-03
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.36e-03
--- time_cost_gemm_reduction=1.40e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.82e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=1.40e-03
--- time_cost_gemm_reduction=1.30e-05
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=5.65e+07
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   2.00e-02  1.43e-03
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   2.00e-02  1.43e-03
TIMING for Davidson : 2.00e-02  T(cal/comm/rest)=1.40e-02,0.00e+00,6.00e-03
optimized energies: isweep=5 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=5 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.000e-03 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=448:0.00342MB:3.34e-06GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.004  T(cal/comm)=0.004,0
===== CPUmem(GB): tot=4.04e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,4.17e-07 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=5.15e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,4.17e-07 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(3,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=8.89e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 5.20e-02 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 4.50e-02 S  per =   87  per(accum) = 87
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 87
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 87
 T(renrm) = 4.00e-03 S  per =  7.7  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -3.7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 3.7e+12
end rank=0 sweep_twodot
##### time_sweep: 1.32e-01 S #####
 T(fetch) = 1.00e-03 S  per = 0.76  per(accum) = 0.76
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0.76
 T(dvdsn) = 1.12e-01 S  per =   85  per(accum) = 86
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 86
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 86
 T(renrm) = 1.10e-02 S  per =  8.3  per(accum) = 94
 T( save) = 0.00e+00 S  per =    0  per(accum) = 94
 T(preprocess_op_wf           ) = -5.03e+09 S  per = -4.5e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 5.03e+09 S  per = 4.5e+12
##### time_global: 9.44e-01 S #####
 T(fetch) = 1.40e-02 S  per =  1.5  per(accum) = 1.5
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.5
 T(dvdsn) = 7.81e-01 S  per =   83  per(accum) = 84
 T(decim) = 3.00e-03 S  per = 0.32  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 8.10e-02 S  per =  8.6  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -3.86e+10 S  per = -4.9e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 3.86e+10 S  per = 4.9e+12

=== end rank=0 ibond=2

=== start rank=0 ibond=3
ISWEEP,IBOND=5,3

isweep=5 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=6 alg_renorm=2 mpisize=1 maxthreads=4
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.000e-03 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x7fbf8ba05990
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.000e-03 S -----
intermediates<Tm>::init maxthreads=4
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.006,0.007
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.000e-03 S -----
preprocess for Hx: ndim=100 blksize=4 worktot=80000:0.61MB:0.000596GB
===== CPUmem(GB): tot=0.000632 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0.000596,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00152
--- time_cost_gemm_reduction=2.2e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.19e+07
--- preprocess_Hx_batch ---
--- time_cost_gemm_kernel=0.00145
--- time_cost_gemm_reduction=2.4e-05
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=5.44e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   3.00e-03  1.50e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   3.00e-03  1.50e-03
TIMING for Davidson : 3.00e-03  T(cal/comm/rest)=2.00e-03,0.00e+00,1.00e-03
optimized energies: isweep=5 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=5 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep5_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.000e-03 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=1944:0.0148MB:1.45e-05GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=2.32e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,1.81e-06 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4.18e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.81e-06 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=9.04e-05GB available=735GB
=== lzd ===0
--- lzd ---0
##### time_local: 3.10e-02 S #####
 T(fetch) = 1.00e-03 S  per =  3.2  per(accum) = 3.2
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 3.2
 T(dvdsn) = 2.40e-02 S  per =   77  per(accum) = 81
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 81
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 81
 T(renrm) = 3.00e-03 S  per =  9.7  per(accum) = 90
 T( save) = 0.00e+00 S  per =    0  per(accum) = 90
 T(preprocess_op_wf           ) = -1.68e+09 S  per = -7e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.68e+09 S  per = 7e+12
end rank=0 sweep_twodot
##### time_sweep: 1.63e-01 S #####
 T(fetch) = 2.00e-03 S  per =  1.2  per(accum) = 1.2
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.2
 T(dvdsn) = 1.36e-01 S  per =   83  per(accum) = 85
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 85
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 85
 T(renrm) = 1.40e-02 S  per =  8.6  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -6.71e+09 S  per = -4.9e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 6.71e+09 S  per = 4.9e+12
##### time_global: 9.75e-01 S #####
 T(fetch) = 1.50e-02 S  per =  1.5  per(accum) = 1.5
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.5
 T(dvdsn) = 8.05e-01 S  per =   83  per(accum) = 84
 T(decim) = 3.00e-03 S  per = 0.31  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 8.40e-02 S  per =  8.6  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -4.03e+10 S  per = -5e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 4.03e+10 S  per = 5e+12

=== end rank=0 ibond=3

======================================================================
sweep_data::summary isweep=5
----------------------------------------------------------------------
sweep parameters: isweep=5 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069
 eav_max=-2.54574720706 [ibond=1]  dwt_min=0 [ibond=0]
 eav_min=-2.54574720867 [ibond=2]  dwt_max=0.00057836023195 [ibond=1]
 eav_diff=1.60474744604e-09
 sweep energies: isweep=5 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[0]=-2.65451696664
 sweep energies: isweep=5 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=5
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Tav/S | Taccum/S| t_kernel/S | t_reduction/S 
         0  2  10  1.00e-04  1.00e-04 | 51 | 1.78e-01 | 3.49e-03 | 1.78e-01 | 5.30e-03 | 6.20e-05
         1  2  20  1.00e-04  0.00e+00 | 45 | 1.69e-01 | 3.76e-03 | 3.47e-01 | 5.14e-03 | 7.20e-05
         2  2  20  1.00e-04  0.00e+00 | 31 | 1.65e-01 | 5.32e-03 | 5.12e-01 | 5.79e-03 | 7.10e-05
         3  2  20  1.00e-04  0.00e+00 | 31 | 1.64e-01 | 5.29e-03 | 6.76e-01 | 5.80e-03 | 8.40e-05
         4  2  20  1.00e-04  0.00e+00 | 31 | 1.65e-01 | 5.32e-03 | 8.41e-01 | 5.80e-03 | 8.70e-05
         5  2  20  1.00e-04  0.00e+00 | 31 | 1.70e-01 | 5.48e-03 | 1.01e+00 | 5.79e-03 | 7.30e-05
results: isweep, dcut, dwt, energies (delta_e)
         0      10 +9.51e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
         1      20 +0.00e+00 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.68e-13)
         2      20 +0.00e+00 e[0]=-2.65451696664 (-1.33e-15) e[1]=-2.43697745069 (-2.22e-15)
         3      20 +0.00e+00 e[0]=-2.65451696664 (-8.88e-16) e[1]=-2.43697745069 (-1.78e-15)
         4      20 +5.26e-04 e[0]=-2.65451696664 (-1.78e-15) e[1]=-2.43697745069 (0.00e+00)
         5      20 +0.00e+00 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

----- TIMING FOR ctns::sweep_opt : 1.014e+00 S -----
##### time_global: 9.75e-01 S #####
 T(fetch) = 1.50e-02 S  per =  1.5  per(accum) = 1.5
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 1.5
 T(dvdsn) = 8.05e-01 S  per =   83  per(accum) = 84
 T(decim) = 3.00e-03 S  per = 0.31  per(accum) = 84
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 84
 T(renrm) = 8.40e-02 S  per =  8.6  per(accum) = 93
 T( save) = 0.00e+00 S  per =    0  per(accum) = 93
 T(preprocess_op_wf           ) = -4.03e+10 S  per = -5e+12
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 0.00e+00 S  per =    0
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 0.00e+00 S  per =    0
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 4.03e+10 S  per = 5e+12

ctns::rcanon_save fname=./scratch/rcanon_new.info

Congrats! CTNS calculation finishes successfully. Wed Mar  1 13:15:42 2023

