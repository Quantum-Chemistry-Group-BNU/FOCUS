
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Fri Apr  7 18:02:43 2023

GIT_HASH = 27a35aada33af79d6cc064ed30b3aa59886d6866

mpisize = 1 maxthreads = 112

input file = results/input.dat

schedule::read fname = results/input.dat
----------------------------------------------------------------------
dtype 0
nelec 5
twoms 1
integral_file moleinfo/fmole.info 
scratch ./scratch

$sci
dets 
0 1 2 3 4 
end
nroots 4
eps0 1.e-6
schedule
0 1.e-2
end
maxiter 6
$end

$ctns
verbose 1
qkind rNSz
nroots 2
maxdets 500 #000
topology_file topology/topo0
thresh_ortho 1.e-8
thresh_proj 1.e-14
schedule
# (n-th, dot, Dcut, dvdson, noise)
0 2 10 1.e-4 1.e-4
1 2 20 1.e-4 0.0
2 2 20 1.e-4 0.0
end
maxsweep 6
task_dmrg
alg_hvec 19
alg_hinter 2
alg_renorm 19
alg_rinter 2
$end

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
nelec = 5
twoms = 1
integral_file = moleinfo/fmole.info

===== params_sci::print =====
nroots = 4
no. of unique seeds = 1
0-th det: 0 1 2 3 4 
flip = 0
eps0 = 1e-06
miniter = 0
maxiter = 6
schedule: iter eps1
0 0.01
1 0.01
2 0.01
3 0.01
4 0.01
5 0.01
convergence parameters
deltaE = 1e-10
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 0
load = 0
ci_file = ci.info
cthrd = 0.01

===== params_ctns::print =====
qkind = rNSz
topology_file = topology/topo0
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
restart_sweep = 0
restart_bond = 0
maxdets = 500
thresh_proj = 1.000000e-14
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
nroots = 2
guess = 1
dbranch = 0
maxsweep = 6
maxbond = -1
schedule: isweep, dots, dcut, eps, noise
0 2 10 1.000000e-04 1.000000e-04
1 2 20 1.000000e-04 0.000000e+00
2 2 20 1.000000e-04 0.000000e+00
3 2 20 1.000000e-04 0.000000e+00
4 2 20 1.000000e-04 0.000000e+00
5 2 20 1.000000e-04 0.000000e+00
alg_hvec = 19
alg_hinter = 2
alg_renorm = 19
alg_rinter = 2
ifdist1 = 0
save_formulae = 0
sort_formulae = 0
save_mmtask = 0
mmorder = 0
batchsize = 1000000000
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
rcanon_load = 0
rcanon_file = rcanon_ci.info
iomode = 0
ioasync = 0
iroot = 0
nsample = 100000
ndetprt = 10

io::create_scratch scratch=./scratch
rank=0 num_gpus=2 device_id=0 magma_queue=0x28c5580 allocated GPUmem(GB)=3.793683e+01

ctns::topology::read fname=topology/topo0
0
1
2
3
4

ctns::topology::print ntotal=5 nphysical=5 nbackbone=5
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
rcoord:
 idx=0 coord=(4,0) node: pindex=4 type=0 center=(-1,-1) left=(3,0) right=(-2,-2)
 idx=1 coord=(3,0) node: pindex=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=2 coord=(2,0) node: pindex=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=3 coord=(1,0) node: pindex=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=4 coord=(0,0) node: pindex=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(4,0) rsupport: 4 ; lsupport: 0 1 2 3 
 idx=1 coord=(3,0) rsupport: 3 4 ; lsupport: 0 1 2 
 idx=2 coord=(2,0) rsupport: 2 3 4 ; lsupport: 0 1 
 idx=3 coord=(1,0) rsupport: 1 2 3 4 ; lsupport: 0 
 idx=4 coord=(0,0) rsupport: 0 1 2 3 4 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(4,0) corbs: 4 ; rorbs: ; lorbs: 0 1 2 3 
 idx=1 coord=(3,0) corbs: 3 ; rorbs: 4 ; lorbs: 0 1 2 
 idx=2 coord=(2,0) corbs: 2 ; rorbs: 3 4 ; lorbs: 0 1 
 idx=3 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 ; lorbs: 0 
 idx=4 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9

fci::ci_load fname=./scratch/ci.info

fci::ci_truncate maxdets=500 ifortho=1
 reduction from 52 to 52 dets
 iroot=0 ova=1.000000000000e+00
 iroot=1 ova=1.000000000000e+00
 iroot=2 ova=1.000000000000e+00
 iroot=3 ova=1.000000000000e+00

ctns::rcanon_init qkind=rNSz

ctns::init_rbases rdm_svd=1.50e+00 thresh_proj=1.00e-14

idx=0 node=(4,0) type=0 rsupport=4 

idx=1 node=
idx=(3,20 node=)( type=2,0)1 type= rsupport=3 4 

idx=3 node=(1,0) type=1 rsupport=1 2 3 4 
ctns::right_projection<Km> thresh_proj=ctns::right_projection<Km> thresh_proj=1.00e-14
1.00e-14
1 rsupport=2 3 4 
ctns::right_projection<Km> thresh_proj=1.00e-14

idx=4 node=(0,0) type=0 rsupport=0 1 2 3 4 
ctns::right_projection<Km> thresh_proj=1.00e-14
 qr=(0,0) dimB,dimBi=1,1 popBi=4.36e-01 popBc=4.36e-01 1-popBc=5.64e-01
 qr=(3,1) dimB,dimBi=12,4 popBi=7.39e-01 popBc=7.39e-01 1-popBc=2.61e-01
 qr=(1,1) dimB,dimBi=2,2 popBi=2.74e-01 popBc=2.74e-01 1-popBc=7.26e-01
 qr=(4,0) dimB,dimBi=20,4 popBi=2.43e-01 popBc=9.82e-01 1-popBc=1.82e-02
 qr=(4,2) dimB,dimBi=8,4 popBi=1.35e-02 popBc=9.95e-01 1-popBc=4.75e-03
 qr=(5,1) dimB,dimBi=12,4 popBi=4.75e-03 popBc=1.00e+00 1-popBc=-4.44e-16
dim(space,lspace,rspace)=52,4,52 dimBc=16 popBc=1.00e+00 SvN=2.46e+00
----- TIMING FOR ctns::right_projection<Km> : 8.582e-04 S -----
 qr=(2,0) dimB,dimBi=9,8 popBi=0.564 popBc=0.838 1-popBc=0.162
 qr=(5,1) dimB,dimBi=52,4 popBi=1 popBc=1 1-popBc=-2.22e-16
dim(space,lspace,rspace)=52,1,52 dimBc=4 popBc=1 SvN=2
----- TIMING FOR ctns::right_projection<Km> : 7.380e-04 S -----
 qr=(2,2) dimB,dimBi=3,3 popBi=0.114 popBc=0.952 1-popBc=0.0478
 qr=(3,-1) dimB,dimBi=5,4 popBi=0.00962 popBc=0.962 1-popBc=0.0382
 qr=(1,-1) dimB,dimBi=2,2 popBi=0.212 popBc=0.648 1-popBc=0.352
 qr=(1,1) qr= dimB,dimBi=(3,1) dimB,dimBi=29,,2 popBi=9 popBi=0.309 popBc=0.03210.958 1-popBc=0.0424
 popBc=0.994 1-popBc=0.00605
 qr=(2,-2) dimB,dimBi=1,1 popBi=0.00083 popBc= qr=(3,3) dimB,dimBi=1,1 popBi=0.958 1-popBc=0.000357 popBc=0.0415
0.994 1-popBc=0.00569
 qr=(2,0) dimB,dimBi=4,4 popBi=0.0341 popBc=0.993 1-popBc=0.00739
 qr=(4,0) dimB,dimBi=9,8 popBi=0.005 popBc=0.999 1-popBc=0.000688
 qr=(2,2) dimB,dimBi=1,1 popBi=0.00454 popBc=0.997 1-popBc=0.00285
 qr=(4,2) dimB,dimBi=3,3 popBi=0.000581 popBc=1 1-popBc=0.000107
 qr= qr=(3,-1)(5,1) dimB,dimBi=2,2 popBi= dimB,dimBi=2,20.000107 popBi= popBc=1 1-popBc=5.55e-16
dim(space,lspace,rspace)=52,16,43 dimBc=40 popBc=1 SvN=2.86
0.000828----- TIMING FOR  popBc=ctns::right_projection<Km> : 0.998 1-popBc=1.500e-03 S -----
2.024e-03
 qr=(3,1) dimB,dimBi=2,2 popBi=0.00192 popBc=1 1-popBc=0.000106
 qr=(4,0) dimB,dimBi=1,1 popBi=0.000106 popBc=1 1-popBc=0
dim(space,lspace,rspace)=52,43,16 dimBc=16 popBc=1 SvN=2.04
----- TIMING FOR ctns::right_projection<Km> : 2.787e-03 S -----

final rbases with thresh_proj=1e-14
 idx=0 node=(4,0) type=0 shape=4,4
 idx=1 node=(3,0) type=1 shape=16,16
 idx=2 node=(2,0) type=1 shape=43,40
 idx=3 node=(1,0) type=1 shape=52,16
 idx=4 node=(0,0) type=0 shape=52,4
maximum bond dimension = 40
----- TIMING FOR ctns::init_rbases : 1.861e-02 S -----

ctns::init_rsites qkind=rNSz thresh_ortho=1e-08
 idx=0 node=(4,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 TIMING=1.367e-05 S
 idx=1 node=(3,0)[1] shape(l,r,c)=(16,4,4) maxdiff=3.163e-16 TIMING=7.177e-04 S
 idx=2 node=(2,0)[1] shape(l,r,c)=(40,16,4) maxdiff=1.995e-15 TIMING=9.880e-04 S
 idx=3 node=(1,0)[1] shape(l,r,c)=(16,40,4) maxdiff=1.810e-15 TIMING=6.197e-04 S
 idx=4 node=(0,0)[0] shape(l,r,c)=(4,16,4) maxdiff=9.494e-16 TIMING=5.184e-04 S
----- TIMING FOR ctns::init_rsites : 2.983e-03 S -----

ctns::init_rwfuns qkind=rNSz thresh_ortho=1e-08
stensor2: wf2 own=1 _data=0x448b1670
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=4
 (5,1):4
 qbond: qcol nsym=1 dimAll=4
 (5,1):4
total no. of nonzero blocks=1 nblocks=1 size=16:0.000122MB

check state overlaps ...
matrix: ova_rwfuns size=(4,4)
      1.0000e+00       6.9514e-18      -2.9241e-18      -1.0699e-17 
      6.9514e-18       1.0000e+00       9.3123e-17      -2.0232e-16 
     -2.9241e-18       9.3123e-17       1.0000e+00       1.8109e-16 
     -1.0699e-17      -2.0232e-16       1.8109e-16       1.0000e+00 
matrix: ova0_vs size=(4,4)
      1.0000e+00       0.0000e+00       1.3878e-17      -1.3878e-17 
      0.0000e+00       1.0000e+00      -1.3878e-17       5.5511e-17 
      1.3878e-17      -1.3878e-17       1.0000e+00       2.7756e-17 
     -1.3878e-17       5.5511e-17       2.7756e-17       1.0000e+00 
diff of ova matrices = 7.812e-16
----- TIMING FOR ctns::init_rwfuns : 1.657e-04 S -----
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=795:0.00607MB:5.92e-06GB
----- TIMING FOR ctns::rcanon_init : 2.182e-02 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Drow=16 maxdiff=3.16e-16
 idx=2 node=(2,0) Drow=40 maxdiff=2.00e-15
 idx=3 node=(1,0) Drow=16 maxdiff=1.81e-15
 idx=4 node=(0,0) Drow=4 maxdiff=9.49e-16
stensor2: wf2 own=1 _data=0x448b2c80
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=4
 (5,1):4
 qbond: qcol nsym=1 dimAll=4
 (5,1):4
total no. of nonzero blocks=1 nblocks=1 size=16:1.22e-04MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(4,4) size=16
 dtensor2: blk_0 size=(4,4) _data=0x448b2c80
      2.0817e-17       1.3878e-17      -1.0000e+00       1.3878e-17 
      1.0000e+00      -1.6653e-16       1.3878e-17       9.0496e-04 
      8.7814e-04      -2.4166e-01      -1.3878e-17      -9.7036e-01 
      2.1869e-04       9.7036e-01       2.0817e-17      -2.4166e-01 
 rwfuns: nroots=4 maxdiff=9.0466e-16
----- TIMING FOR ctns::rcanon_check : 1.812e-04 S -----

integral::load fname = moleinfo/fmole.info
 sorb = 10
 size(int1e) = 100:0.000763MB:7.45e-07GB
 size(int2e) = 1080:0.00824MB:8.05e-06GB
 ecore = 3.4
----- TIMING FOR integral::load_integral : 4.193e-04 S -----

io::remove_scratch scratch=./scratch/sweep
successfully removed ./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=rNSz
fname=./scratch/sweep/cop(4,0) size=1.09e-06GB T[save](info/data/tot)=0.000106,5.83e-05,0.000165 speed=0.00661GB/s disk[used]=1.31e-06GB
fname=./scratch/sweep/rop(4,0) size=1.09e-06GB T[save](info/data/tot)=5.88e-05,3.91e-05,9.79e-05 speed=0.0111GB/s disk[used]=2.62e-06GB
fname=./scratch/sweep/cop(3,0) size=1.09e-06GB T[save](info/data/tot)=5.03e-05,3.91e-05,8.94e-05 speed=0.0122GB/s disk[used]=3.93e-06GB
fname=./scratch/sweep/cop(2,0) size=1.09e-06GB T[save](info/data/tot)=5.25e-05,4.55e-05,9.8e-05 speed=0.0111GB/s disk[used]=5.24e-06GB
fname=./scratch/sweep/cop(1,0) size=1.09e-06GB T[save](info/data/tot)=5.27e-05,3.87e-05,9.14e-05 speed=0.0119GB/s disk[used]=6.55e-06GB
fname=./scratch/sweep/cop(0,0) size=1.09e-06GB T[save](info/data/tot)=4.94e-05,7.27e-05,0.000122 speed=0.00892GB/s disk[used]=7.86e-06GB
fname=./scratch/sweep/lop(0,0) size=1.09e-06GB T[save](info/data/tot)=5.49e-05,4.18e-05,9.68e-05 speed=0.0112GB/s disk[used]=9.17e-06GB
----- TIMING FOR ctns::oper_init : 1.759e-03 S -----
T[ctns::oper_init](comp/save/tot)=0.000612,0.00105,0.00166

idx=1 coord=(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.257e-04 S -----
 cqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.18e-06 (oper)(GB)=2.18e-06
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site)(GB)=2.18e-06,1.03e-05,2.68e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.943e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000724 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=6.89e-05,0.000347,0.000308 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=1.4e-05,0.00132,0.000233 cost=2.78e+04 flops[gemm]=2.11e+07
--- TIMING FOR renorm : t_inter=1.4e-05 t_gemm=0.00132 t_reduction=0.000233 tot=0.00156 ---
 renorm counter=1 i=0 t=0.000386 per=29.3 cost=1.82e+03 flops=4.72e+06
 renorm counter=1 i=1 t=0.00024 per=18.2 cost=3.23e+03 flops=1.34e+07
 renorm counter=1 i=2 t=0.000214 per=16.2 cost=1.91e+03 flops=8.91e+06
 renorm counter=1 i=3 t=0.000229 per=17.4 cost=3.14e+03 flops=1.37e+07
 renorm counter=1 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=1 i=5 t=1e-06 per=0.0759 cost=0 flops=0
 renorm counter=1 i=6 t=0.000248 per=18.8 cost=1.77e+04 flops=7.14e+07
 total GEMM cost=2.78e+04 flops=2.11e+07
--- TIMING FOR renorm_tot : t_inter=1.4e-05 t_gemm=0.00132 t_reduction=0.000233 tot=0.00156 ---
 renorm_tot counter=1 i=0 t=0.000386 per=29.3 cost=1.82e+03 flops=4.72e+06
 renorm_tot counter=1 i=1 t=0.00024 per=18.2 cost=3.23e+03 flops=1.34e+07
 renorm_tot counter=1 i=2 t=0.000214 per=16.2 cost=1.91e+03 flops=8.91e+06
 renorm_tot counter=1 i=3 t=0.000229 per=17.4 cost=3.14e+03 flops=1.37e+07
 renorm_tot counter=1 i=4 t=0 per=0 cost=0 flops=-nan
 renorm_tot counter=1 i=5 t=1e-06 per=0.0759 cost=0 flops=0
 renorm_tot counter=1 i=6 t=0.000248 per=18.8 cost=1.77e+04 flops=7.14e+07
 total GEMM cost=2.78e+04 flops=2.11e+07
check ||H-H.dagger||=7.85e-17 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0036 S T(init/kernel/comm)=0.00022,0.0033,1.1e-05 rank=0 -----
fname=./scratch/sweep/rop(3,0) size=1.03e-05GB T[save](info/data/tot)=8.06e-05,4.91e-05,0.00013 speed=0.0797GB/s disk[used]=1.98e-05GB
##### time_local: 4.08e-03 S #####
 T(fetch) = 2.62e-04 S  per =  6.4  per(accum) = 6.4
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 6.4
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 6.4
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 6.4
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 6.4
 T(renrm) = 3.63e-03 S  per =   89  per(accum) = 95
 T(save ) = 1.90e-04 S  per =  4.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 3.58e-03 S
 T(qops init                    ) = 2.22e-04 S  per =  6.2  per(accum) = 6.2
 T(qops_dict memcpy cpu2gpu     ) = 9.33e-05 S  per =  2.6  per(accum) = 8.8
 T(symbolic_formulae_renorm     ) = 3.02e-04 S  per =  8.4  per(accum) = 17
 T(rintermediate init           ) = 1.39e-05 S  per = 0.39  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 5.63e-06 S  per = 0.16  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 7.38e-04 S  per =   21  per(accum) = 38
 T(rmmtasks init                ) = 4.63e-04 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 3.36e-05 S  per = 0.94  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 1.66e-03 S  per =   46  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.72e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.13e-05 S  per = 0.32  per(accum) = 1e+02
##### time_sweep: 4.08e-03 S #####
 T(fetch) = 2.62e-04 S  per =  6.4  per(accum) = 6.4
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 6.4
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 6.4
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 6.4
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 6.4
 T(renrm) = 3.63e-03 S  per =   89  per(accum) = 95
 T(save ) = 1.90e-04 S  per =  4.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 3.58e-03 S
 T(qops init                    ) = 2.22e-04 S  per =  6.2  per(accum) = 6.2
 T(qops_dict memcpy cpu2gpu     ) = 9.33e-05 S  per =  2.6  per(accum) = 8.8
 T(symbolic_formulae_renorm     ) = 3.02e-04 S  per =  8.4  per(accum) = 17
 T(rintermediate init           ) = 1.39e-05 S  per = 0.39  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 5.63e-06 S  per = 0.16  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 7.38e-04 S  per =   21  per(accum) = 38
 T(rmmtasks init                ) = 4.63e-04 S  per =   13  per(accum) = 51
 T(qops memset                  ) = 3.36e-05 S  per = 0.94  per(accum) = 52
 T(preprocess_renorm_batchGPU   ) = 1.66e-03 S  per =   46  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.72e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.13e-05 S  per = 0.32  per(accum) = 1e+02

idx=2 coord=(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.647e-04 S -----
 cqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=40,40 size(op)=252:0.00192MB size(tot)=9246:0.0705MB:6.89e-05GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.14e-05 (oper)(GB)=1.14e-05
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=8.25e-05 (oper,qops,site)(GB)=1.14e-05,6.89e-05,2.18e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.003e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 2.677e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=8.32e-05 (oper,qops,site,rinter)(GB)=1.14e-05,6.89e-05,2.18e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Rlist : 0.000899 S size(rtasks)=63 size(Rlst)=1950 T(Rmu/Rxlist/sort)=5.67e-05,0.000413,0.00043 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.00257 (oper,qops,site,rinter,batch)(GB)=1.14e-05,6.89e-05,2.18e-06,6.85e-07,0.00248
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000208,0.00123,0.000213 cost=4.56e+05 flops[gemm]=3.71e+08
--- TIMING FOR renorm : t_inter=0.000208 t_gemm=0.00123 t_reduction=0.000213 tot=0.00165 ---
 renorm counter=2 i=0 t=0.000222 per=18.1 cost=1.15e+04 flops=5.18e+07
 renorm counter=2 i=1 t=0.00024 per=19.5 cost=2.3e+04 flops=9.57e+07
 renorm counter=2 i=2 t=0.000245 per=19.9 cost=3.36e+04 flops=1.37e+08
 renorm counter=2 i=3 t=0.000253 per=20.6 cost=5.94e+04 flops=2.35e+08
 renorm counter=2 i=4 t=1e-06 per=0.0814 cost=0 flops=0
 renorm counter=2 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=2 i=6 t=0.000268 per=21.8 cost=3.28e+05 flops=1.22e+09
 total GEMM cost=4.56e+05 flops=3.71e+08
--- TIMING FOR renorm_tot : t_inter=0.000222 t_gemm=0.00255 t_reduction=0.000446 tot=0.00321 ---
 renorm_tot counter=2 i=0 t=0.000608 per=23.9 cost=1.33e+04 flops=2.19e+07
 renorm_tot counter=2 i=1 t=0.00048 per=18.8 cost=2.62e+04 flops=5.46e+07
 renorm_tot counter=2 i=2 t=0.000459 per=18 cost=3.55e+04 flops=7.73e+07
 renorm_tot counter=2 i=3 t=0.000482 per=18.9 cost=6.26e+04 flops=1.3e+08
 renorm_tot counter=2 i=4 t=1e-06 per=0.0393 cost=0 flops=0
 renorm_tot counter=2 i=5 t=1e-06 per=0.0393 cost=0 flops=0
 renorm_tot counter=2 i=6 t=0.000516 per=20.3 cost=3.46e+05 flops=6.7e+08
 total GEMM cost=4.83e+05 flops=1.9e+08
check ||H-H.dagger||=1.97e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0039 S T(init/kernel/comm)=0.0002,0.0036,1.9e-05 rank=0 -----
fname=./scratch/sweep/rop(2,0) size=6.89e-05GB T[save](info/data/tot)=9.28e-05,8.33e-05,0.000176 speed=0.391GB/s disk[used]=8.9e-05GB
##### time_local: 4.32e-03 S #####
 T(fetch) = 1.92e-04 S  per =  4.4  per(accum) = 4.4
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 4.4
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 4.4
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 4.4
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 4.4
 T(renrm) = 3.89e-03 S  per =   90  per(accum) = 94
 T(save ) = 2.38e-04 S  per =  5.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 3.87e-03 S
 T(qops init                    ) = 2.04e-04 S  per =  5.3  per(accum) = 5.3
 T(qops_dict memcpy cpu2gpu     ) = 4.02e-05 S  per =    1  per(accum) = 6.3
 T(symbolic_formulae_renorm     ) = 2.06e-04 S  per =  5.3  per(accum) = 12
 T(rintermediate init           ) = 3.07e-05 S  per = 0.79  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 5.40e-06 S  per = 0.14  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 9.10e-04 S  per =   24  per(accum) = 36
 T(rmmtasks init                ) = 6.48e-04 S  per =   17  per(accum) = 53
 T(qops memset                  ) = 1.01e-05 S  per = 0.26  per(accum) = 53
 T(preprocess_renorm_batchGPU   ) = 1.75e-03 S  per =   45  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 4.41e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.92e-05 S  per =  0.5  per(accum) = 1e+02
##### time_sweep: 8.41e-03 S #####
 T(fetch) = 4.54e-04 S  per =  5.4  per(accum) = 5.4
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 5.4
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 5.4
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 5.4
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 5.4
 T(renrm) = 7.52e-03 S  per =   89  per(accum) = 95
 T(save ) = 4.29e-04 S  per =  5.1  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 7.45e-03 S
 T(qops init                    ) = 4.26e-04 S  per =  5.7  per(accum) = 5.7
 T(qops_dict memcpy cpu2gpu     ) = 1.33e-04 S  per =  1.8  per(accum) = 7.5
 T(symbolic_formulae_renorm     ) = 5.08e-04 S  per =  6.8  per(accum) = 14
 T(rintermediate init           ) = 4.46e-05 S  per =  0.6  per(accum) = 15
 T(rintermediates memcpy cpu2gpu) = 1.10e-05 S  per = 0.15  per(accum) = 15
 T(preprocess_formulae_Rlist2   ) = 1.65e-03 S  per =   22  per(accum) = 37
 T(rmmtasks init                ) = 1.11e-03 S  per =   15  per(accum) = 52
 T(qops memset                  ) = 4.37e-05 S  per = 0.59  per(accum) = 53
 T(preprocess_renorm_batchGPU   ) = 3.41e-03 S  per =   46  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 8.13e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 3.05e-05 S  per = 0.41  per(accum) = 1e+02

idx=3 coord=(1,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.497e-04 S -----
 cqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=40,40 size(op)=252:0.00192MB size(tot)=9246:0.0705MB:6.89e-05GB
ctns::oper_renorm_opAll coord=(1,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:8 A:28 B:36 P:1 Q:3 S:2 H:1 
        dim(bra,ket)=16,16 size(op)=64:0.000488MB size(tot)=2336:0.0178MB:1.74e-05GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=7e-05 (oper)(GB)=7e-05
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=9e-05 (oper,qops,site)(GB)=7e-05,1.74e-05,2.65e-06
----- TIMING FOR symbolic_formulae_renorm with size=79 : 1.548e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=79
 no. of rintermediate operators=20
 no. of coefficients=60:0.000458MB:4.47e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 1.933e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=9.05e-05 (oper,qops,site,rinter)(GB)=7e-05,1.74e-05,2.65e-06,4.47e-07
----- TIMING FOR preprocess_formulae_Rlist : 0.000459 S size(rtasks)=79 size(Rlst)=940 T(Rmu/Rxlist/sort)=4.35e-05,0.000196,0.000219 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.00111 (oper,qops,site,rinter,batch)(GB)=7e-05,1.74e-05,2.65e-06,4.47e-07,0.00102
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000186,0.0011,0.000189 cost=4.27e+05 flops[gemm]=3.89e+08
--- TIMING FOR renorm : t_inter=0.000186 t_gemm=0.0011 t_reduction=0.000189 tot=0.00147 ---
 renorm counter=3 i=0 t=0.000211 per=19.3 cost=8.34e+03 flops=3.95e+07
 renorm counter=3 i=1 t=0.000214 per=19.5 cost=1.65e+04 flops=7.72e+07
 renorm counter=3 i=2 t=0.000211 per=19.3 cost=7.06e+04 flops=3.35e+08
 renorm counter=3 i=3 t=0.000227 per=20.7 cost=1.61e+05 flops=7.08e+08
 renorm counter=3 i=4 t=1e-06 per=0.0912 cost=0 flops=0
 renorm counter=3 i=5 t=1e-06 per=0.0912 cost=0 flops=0
 renorm counter=3 i=6 t=0.000231 per=21.1 cost=1.71e+05 flops=7.38e+08
 total GEMM cost=4.27e+05 flops=3.89e+08
--- TIMING FOR renorm_tot : t_inter=0.000408 t_gemm=0.00364 t_reduction=0.000635 tot=0.00469 ---
 renorm_tot counter=3 i=0 t=0.000819 per=22.5 cost=2.17e+04 flops=2.64e+07
 renorm_tot counter=3 i=1 t=0.000694 per=19.1 cost=4.27e+04 flops=6.15e+07
 renorm_tot counter=3 i=2 t=0.00067 per=18.4 cost=1.06e+05 flops=1.58e+08
 renorm_tot counter=3 i=3 t=0.000709 per=19.5 cost=2.23e+05 flops=3.15e+08
 renorm_tot counter=3 i=4 t=2e-06 per=0.0549 cost=0 flops=0
 renorm_tot counter=3 i=5 t=2e-06 per=0.0549 cost=0 flops=0
 renorm_tot counter=3 i=6 t=0.000747 per=20.5 cost=5.16e+05 flops=6.91e+08
 total GEMM cost=9.1e+05 flops=2.5e+08
check ||H-H.dagger||=1.34e-15 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0028 S T(init/kernel/comm)=0.0002,0.0026,1e-05 rank=0 -----
fname=./scratch/sweep/rop(1,0) size=1.74e-05GB T[save](info/data/tot)=7.99e-05,5.41e-05,0.000134 speed=0.13GB/s disk[used]=0.000107GB
##### time_local: 3.24e-03 S #####
 T(fetch) = 1.77e-04 S  per =  5.5  per(accum) = 5.5
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 5.5
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 5.5
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 5.5
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 5.5
 T(renrm) = 2.86e-03 S  per =   88  per(accum) = 94
 T(save ) = 1.98e-04 S  per =  6.1  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 2.83e-03 S
 T(qops init                    ) = 2.00e-04 S  per =  7.1  per(accum) = 7.1
 T(qops_dict memcpy cpu2gpu     ) = 6.18e-05 S  per =  2.2  per(accum) = 9.3
 T(symbolic_formulae_renorm     ) = 1.61e-04 S  per =  5.7  per(accum) = 15
 T(rintermediate init           ) = 2.30e-05 S  per = 0.81  per(accum) = 16
 T(rintermediates memcpy cpu2gpu) = 5.51e-06 S  per = 0.19  per(accum) = 16
 T(preprocess_formulae_Rlist2   ) = 4.67e-04 S  per =   17  per(accum) = 32
 T(rmmtasks init                ) = 3.03e-04 S  per =   11  per(accum) = 43
 T(qops memset                  ) = 8.83e-06 S  per = 0.31  per(accum) = 43
 T(preprocess_renorm_batchGPU   ) = 1.56e-03 S  per =   55  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.76e-05 S  per = 0.97  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.01e-05 S  per = 0.36  per(accum) = 1e+02
##### time_sweep: 1.16e-02 S #####
 T(fetch) = 6.32e-04 S  per =  5.4  per(accum) = 5.4
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 5.4
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 5.4
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 5.4
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 5.4
 T(renrm) = 1.04e-02 S  per =   89  per(accum) = 95
 T(save ) = 6.26e-04 S  per =  5.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 1.03e-02 S
 T(qops init                    ) = 6.26e-04 S  per =  6.1  per(accum) = 6.1
 T(qops_dict memcpy cpu2gpu     ) = 1.95e-04 S  per =  1.9  per(accum) = 8
 T(symbolic_formulae_renorm     ) = 6.68e-04 S  per =  6.5  per(accum) = 14
 T(rintermediate init           ) = 6.76e-05 S  per = 0.66  per(accum) = 15
 T(rintermediates memcpy cpu2gpu) = 1.65e-05 S  per = 0.16  per(accum) = 15
 T(preprocess_formulae_Rlist2   ) = 2.12e-03 S  per =   21  per(accum) = 36
 T(rmmtasks init                ) = 1.41e-03 S  per =   14  per(accum) = 50
 T(qops memset                  ) = 5.25e-05 S  per = 0.51  per(accum) = 50
 T(preprocess_renorm_batchGPU   ) = 4.97e-03 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.09e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 4.06e-05 S  per = 0.39  per(accum) = 1e+02

idx=4 coord=(0,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.491e-04 S -----
 cqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:8 A:28 B:36 P:1 Q:3 S:2 H:1 
        dim(bra,ket)=16,16 size(op)=64:0.000488MB size(tot)=2336:0.0178MB:1.74e-05GB
ctns::oper_renorm_opAll coord=(0,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:10 A:45 B:55 P:0 Q:0 S:0 H:1 
        dim(bra,ket)=4,4 size(op)=16:0.000122MB size(tot)=496:0.00378MB:3.7e-06GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.85e-05 (oper)(GB)=1.85e-05
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.27e-05 (oper,qops,site)(GB)=1.85e-05,3.7e-06,4.77e-07
----- TIMING FOR symbolic_formulae_renorm with size=111 : 1.090e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=111
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=2.27e-05 (oper,qops,site,rinter)(GB)=1.85e-05,3.7e-06,4.77e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000115 S size(rtasks)=111 size(Rlst)=180 T(Rmu/Rxlist/sort)=4.4e-05,4.61e-05,2.46e-05 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=6.69e-05 (oper,qops,site,rinter,batch)(GB)=1.85e-05,3.7e-06,4.77e-07,0,4.43e-05
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7e-06,0.00104,0.000214 cost=4.7e+04 flops[gemm]=4.5e+07
--- TIMING FOR renorm : t_inter=7e-06 t_gemm=0.00105 t_reduction=0.000214 tot=0.00127 ---
 renorm counter=4 i=0 t=0.000217 per=20.8 cost=1.09e+03 flops=5.01e+06
 renorm counter=4 i=1 t=0.000207 per=19.8 cost=1.86e+03 flops=8.97e+06
 renorm counter=4 i=2 t=0.000207 per=19.8 cost=6.4e+03 flops=3.09e+07
 renorm counter=4 i=3 t=0.000204 per=19.5 cost=1.46e+04 flops=7.15e+07
 renorm counter=4 i=4 t=1e-06 per=0.0957 cost=0 flops=0
 renorm counter=4 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=4 i=6 t=0.000209 per=20 cost=2.3e+04 flops=1.1e+08
 total GEMM cost=4.7e+04 flops=4.5e+07
--- TIMING FOR renorm_tot : t_inter=0.000415 t_gemm=0.00469 t_reduction=0.000849 tot=0.00595 ---
 renorm_tot counter=4 i=0 t=0.00104 per=22.1 cost=2.28e+04 flops=2.2e+07
 renorm_tot counter=4 i=1 t=0.000901 per=19.2 cost=4.46e+04 flops=4.95e+07
 renorm_tot counter=4 i=2 t=0.000877 per=18.7 cost=1.12e+05 flops=1.28e+08
 renorm_tot counter=4 i=3 t=0.000913 per=19.5 cost=2.38e+05 flops=2.61e+08
 renorm_tot counter=4 i=4 t=3e-06 per=0.064 cost=0 flops=0
 renorm_tot counter=4 i=5 t=2e-06 per=0.0427 cost=0 flops=0
 renorm_tot counter=4 i=6 t=0.000956 per=20.4 cost=5.39e+05 flops=5.64e+08
 total GEMM cost=9.57e+05 flops=2.04e+08
check ||H-H.dagger||=5.13e-16 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.0019 S T(init/kernel/comm)=0.00019,0.0017,8.6e-06 rank=0 -----
fname=./scratch/sweep/rop(0,0) size=3.7e-06GB T[save](info/data/tot)=8.81e-05,4.46e-05,0.000133 speed=0.0279GB/s disk[used]=0.000111GB
##### time_local: 2.33e-03 S #####
 T(fetch) = 1.77e-04 S  per =  7.6  per(accum) = 7.6
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 7.6
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 7.6
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 7.6
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 7.6
 T(renrm) = 1.96e-03 S  per =   84  per(accum) = 91
 T(save ) = 2.00e-04 S  per =  8.6  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 1.94e-03 S
 T(qops init                    ) = 1.86e-04 S  per =  9.6  per(accum) = 9.6
 T(qops_dict memcpy cpu2gpu     ) = 4.03e-05 S  per =  2.1  per(accum) = 12
 T(symbolic_formulae_renorm     ) = 1.14e-04 S  per =  5.9  per(accum) = 18
 T(rintermediate init           ) = 1.07e-05 S  per = 0.55  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 5.27e-06 S  per = 0.27  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 1.23e-04 S  per =  6.4  per(accum) = 25
 T(rmmtasks init                ) = 6.96e-05 S  per =  3.6  per(accum) = 28
 T(qops memset                  ) = 4.63e-06 S  per = 0.24  per(accum) = 29
 T(preprocess_renorm_batchGPU   ) = 1.35e-03 S  per =   70  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 2.41e-05 S  per =  1.2  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.56e-06 S  per = 0.44  per(accum) = 1e+02
##### time_sweep: 1.40e-02 S #####
 T(fetch) = 8.08e-04 S  per =  5.8  per(accum) = 5.8
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 5.8
 T(dvdsn) = 0.00e+00 S  per =    0  per(accum) = 5.8
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 5.8
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 5.8
 T(renrm) = 1.23e-02 S  per =   88  per(accum) = 94
 T(save ) = 8.26e-04 S  per =  5.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 0.00e+00 S
 T(qops_dict memcpy cpu2gpu     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(symbolic_formulae_twodot     ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediate init           ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hintermediates memcpy cpu2gpu) = 0.00e+00 S  per =    0  per(accum) = 0
 T(preprocess_hformulae_Hxlist2 ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hmmtasks init                ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [Hx_batchGPU]  ) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [communication]) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdson solver [rest part]    ) = 0.00e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 1.22e-02 S
 T(qops init                    ) = 8.12e-04 S  per =  6.6  per(accum) = 6.6
 T(qops_dict memcpy cpu2gpu     ) = 2.35e-04 S  per =  1.9  per(accum) = 8.6
 T(symbolic_formulae_renorm     ) = 7.82e-04 S  per =  6.4  per(accum) = 15
 T(rintermediate init           ) = 7.83e-05 S  per = 0.64  per(accum) = 16
 T(rintermediates memcpy cpu2gpu) = 2.18e-05 S  per = 0.18  per(accum) = 16
 T(preprocess_formulae_Rlist2   ) = 2.24e-03 S  per =   18  per(accum) = 34
 T(rmmtasks init                ) = 1.48e-03 S  per =   12  per(accum) = 46
 T(qops memset                  ) = 5.71e-05 S  per = 0.47  per(accum) = 47
 T(preprocess_renorm_batchGPU   ) = 6.32e-03 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.33e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 4.91e-05 S  per =  0.4  per(accum) = 1e+02
----- TIMING FOR ctns::oper_env_right : 1.667e-02 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.00178,0.000808,0.0123,0.000826,0.0158
matrix: Hij size=(4,4)
     -2.65451697e+00      -4.61105007e-16      -6.70020081e-16       2.28167876e-16 
     -4.69749971e-16      -2.27865403e+00       3.95852973e-15      -3.63380217e-16 
     -6.38495525e-16       3.89822817e-15      -2.24308285e+00       4.16440009e-16 
     -2.94559737e-17      -1.20942457e-16       4.11421957e-16      -1.91229192e+00 
matrix: Sij size=(4,4)
      1.0000e+00      -8.0339e-17       9.1986e-17      -3.5887e-16 
     -7.9255e-17       1.0000e+00       1.9655e-16      -1.2091e-15 
      1.0851e-16       1.9653e-16       1.0000e+00      -1.3329e-16 
     -3.8381e-16      -1.2642e-15      -1.3334e-16       1.0000e+00 

ctns::sweep_opt maxsweep=6

ctns::topology::get_sweeps
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=3 bond=(1,0)-(2,0) forward=0 cturn=0
..... end of get_sweeps .....

======================================================================
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0.0001
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.012e-07GB
 sites: len=5 mem=692:0.00528MB:5.156e-06GB
 rwfuns: len=4 mem=16:0.0001221MB:1.192e-07GB
 cpsi: len=2 mem=178:0.001358MB:1.326e-06GB
total mem of comb=913:0.006966MB:6.802e-06GB

isweep=0 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 4.087e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=692:0.00528MB:5.16e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 cpsi: len=2 mem=178:0.00136MB:1.33e-06GB
total mem of comb=913:0.00697MB:6.8e-06GB
===== CPUmem(GB): tot=2.04e-05 (comb,oper,dvdson,hvec,renorm)=6.8e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44902820
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (0,0):1 (1,-1):2 (1,1):2 (2,-2):1 (2,0):4 (2,2):1 (3,-1):2 (3,1):2 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.079e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 2.727e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00292 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=6.8e-05,0.00129,0.00156 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=3.53e-05 (comb,oper,dvdson,hvec,renorm)=6.8e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=3e-05,0.000218,0.00209,0.000209 cost=7.9e+04 flops[gemm]=3.78e+07
--- TIMING FOR sigma : t_inter=0.000218 t_gemm=0.00209 t_reduction=0.000209 tot=0.00252 ---
 sigma counter=1 i=0 t=0.000255 per=12.2 cost=7.01e+03 flops=2.75e+07
 sigma counter=1 i=1 t=0.000274 per=13.1 cost=6.99e+03 flops=2.55e+07
 sigma counter=1 i=2 t=0.000251 per=12 cost=6.81e+03 flops=2.71e+07
 sigma counter=1 i=3 t=0.000255 per=12.2 cost=6.78e+03 flops=2.66e+07
 sigma counter=1 i=4 t=0.000264 per=12.6 cost=1.89e+04 flops=7.16e+07
 sigma counter=1 i=5 t=0.000269 per=12.9 cost=1.89e+04 flops=7.02e+07
 sigma counter=1 i=6 t=0.000271 per=13 cost=6.78e+03 flops=2.5e+07
 sigma counter=1 i=7 t=0.000253 per=12.1 cost=6.81e+03 flops=2.69e+07
 total GEMM cost=7.9e+04 flops=3.78e+07
--- TIMING FOR sigma_tot : t_inter=0.000218 t_gemm=0.00209 t_reduction=0.000209 tot=0.00252 ---
 sigma_tot counter=1 i=0 t=0.000255 per=12.2 cost=7.01e+03 flops=2.75e+07
 sigma_tot counter=1 i=1 t=0.000274 per=13.1 cost=6.99e+03 flops=2.55e+07
 sigma_tot counter=1 i=2 t=0.000251 per=12 cost=6.81e+03 flops=2.71e+07
 sigma_tot counter=1 i=3 t=0.000255 per=12.2 cost=6.78e+03 flops=2.66e+07
 sigma_tot counter=1 i=4 t=0.000264 per=12.6 cost=1.89e+04 flops=7.16e+07
 sigma_tot counter=1 i=5 t=0.000269 per=12.9 cost=1.89e+04 flops=7.02e+07
 sigma_tot counter=1 i=6 t=0.000271 per=13 cost=6.78e+03 flops=2.5e+07
 sigma_tot counter=1 i=7 t=0.000253 per=12.1 cost=6.81e+03 flops=2.69e+07
 total GEMM cost=7.9e+04 flops=3.78e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.9e-05,0.000213,0.00205,0.000205 cost=7.9e+04 flops[gemm]=3.85e+07
--- TIMING FOR sigma : t_inter=0.000213 t_gemm=0.00205 t_reduction=0.000205 tot=0.00247 ---
 sigma counter=2 i=0 t=0.000253 per=12.3 cost=7.01e+03 flops=2.77e+07
 sigma counter=2 i=1 t=0.000257 per=12.5 cost=6.99e+03 flops=2.72e+07
 sigma counter=2 i=2 t=0.000249 per=12.2 cost=6.81e+03 flops=2.74e+07
 sigma counter=2 i=3 t=0.000248 per=12.1 cost=6.78e+03 flops=2.74e+07
 sigma counter=2 i=4 t=0.000259 per=12.6 cost=1.89e+04 flops=7.3e+07
 sigma counter=2 i=5 t=0.000265 per=12.9 cost=1.89e+04 flops=7.13e+07
 sigma counter=2 i=6 t=0.000269 per=13.1 cost=6.78e+03 flops=2.52e+07
 sigma counter=2 i=7 t=0.000249 per=12.2 cost=6.81e+03 flops=2.74e+07
 total GEMM cost=7.9e+04 flops=3.85e+07
--- TIMING FOR sigma_tot : t_inter=0.000431 t_gemm=0.00414 t_reduction=0.000414 tot=0.00499 ---
 sigma_tot counter=2 i=0 t=0.000508 per=12.3 cost=1.4e+04 flops=2.76e+07
 sigma_tot counter=2 i=1 t=0.000531 per=12.8 cost=1.4e+04 flops=2.63e+07
 sigma_tot counter=2 i=2 t=0.0005 per=12.1 cost=1.36e+04 flops=2.73e+07
 sigma_tot counter=2 i=3 t=0.000503 per=12.1 cost=1.36e+04 flops=2.7e+07
 sigma_tot counter=2 i=4 t=0.000523 per=12.6 cost=3.78e+04 flops=7.23e+07
 sigma_tot counter=2 i=5 t=0.000534 per=12.9 cost=3.78e+04 flops=7.08e+07
 sigma_tot counter=2 i=6 t=0.00054 per=13 cost=1.36e+04 flops=2.51e+07
 sigma_tot counter=2 i=7 t=0.000502 per=12.1 cost=1.36e+04 flops=2.71e+07
 total GEMM cost=1.58e+05 flops=3.81e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966941  -1.00e+03   4.48e-05    2     2   5.33e-03  2.66e-03
    1   1 +      -2.278654025976  -1.00e+03   6.71e-05    2     2   5.33e-03  2.66e-03
TIMING for Davidson : 5.35e-03  T(cal/comm/rest)=5.26e-03,2.12e-07,8.46e-05
optimized energies: isweep=0 dots=2 ibond=0 e[0]=-2.65451696694
optimized energies: isweep=0 dots=2 ibond=0 e[1]=-2.27865402598
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond0.txt
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: 16->10 dwt=+2.890e-03 SvN=1.645e+00
===== CPUmem(GB): tot=2.041e-05 (comb,oper,dvdson,hvec,renorm)=6.802e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:1.831e-04MB size(tot)=730:5.569e-03MB:5.439e-06GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=2.176e-06 (oper)(GB)=2.176e-06
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=7.808e-06 (oper,qops,site)(GB)=2.176e-06,5.439e-06,1.937e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.424e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=7.81e-06 (oper,qops,site,rinter)(GB)=2.18e-06,5.44e-06,1.94e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000494 S size(rtasks)=63 size(Rlst)=987 T(Rmu/Rxlist/sort)=6.33e-05,0.000205,0.000226 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.00025 (oper,qops,site,rinter,batch)(GB)=2.18e-06,5.44e-06,1.94e-07,0,0.000243
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7e-06,0.00113,0.000195 cost=1.87e+04 flops[gemm]=1.65e+07
--- TIMING FOR renorm : t_inter=7e-06 t_gemm=0.00113 t_reduction=0.000195 tot=0.00133 ---
 renorm counter=1 i=0 t=0.000222 per=19.6 cost=1.33e+03 flops=6.01e+06
 renorm counter=1 i=1 t=0.000232 per=20.5 cost=1.89e+03 flops=8.16e+06
 renorm counter=1 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=1 i=3 t=1e-06 per=0.0884 cost=0 flops=0
 renorm counter=1 i=4 t=0.000215 per=19 cost=1.28e+03 flops=5.94e+06
 renorm counter=1 i=5 t=0.000214 per=18.9 cost=1.95e+03 flops=9.11e+06
 renorm counter=1 i=6 t=0.000247 per=21.8 cost=1.22e+04 flops=4.95e+07
 total GEMM cost=1.87e+04 flops=1.65e+07
--- TIMING FOR renorm_tot : t_inter=7e-06 t_gemm=0.00113 t_reduction=0.000195 tot=0.00133 ---
 renorm_tot counter=1 i=0 t=0.000222 per=19.6 cost=1.33e+03 flops=6.01e+06
 renorm_tot counter=1 i=1 t=0.000232 per=20.5 cost=1.89e+03 flops=8.16e+06
 renorm_tot counter=1 i=2 t=0 per=0 cost=0 flops=-nan
 renorm_tot counter=1 i=3 t=1e-06 per=0.0884 cost=0 flops=0
 renorm_tot counter=1 i=4 t=0.000215 per=19 cost=1.28e+03 flops=5.94e+06
 renorm_tot counter=1 i=5 t=0.000214 per=18.9 cost=1.95e+03 flops=9.11e+06
 renorm_tot counter=1 i=6 t=0.000247 per=21.8 cost=1.22e+04 flops=4.95e+07
 total GEMM cost=1.87e+04 flops=1.65e+07
check ||H-H.dagger||=5.66e-16 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0028 S T(init/kernel/comm)=0.0002,0.0026,9.7e-06 rank=0 -----
===== CPUmem(GB): tot=2e-05 (comb,oper,dvdson,hvec,renorm)=6.8e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=362:0.0028MB:2.7e-06GB
 rwfuns: len=4 mem=16:0.00012MB:1.2e-07GB
 cpsi: len=2 mem=156:0.0012MB:1.2e-06GB
total mem of comb=561:0.0043MB:4.2e-06GB
===== CPUmem(GB): tot=2.3e-05 (comb,oper,dvdson,hvec,renorm)=4.2e-06,1.9e-05,0,0,0 =====
fname=./scratch/sweep/lop(1,0) size=5.44e-06GB T[save](info/data/tot)=5.16e-05,4.54e-05,9.7e-05 speed=0.0561GB/s disk[used]=0.000119GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
##### time_local: 1.57e-02 S #####
 T(fetch) = 5.36e-04 S  per =  3.4  per(accum) = 3.4
 T(hdiag) = 1.13e-04 S  per = 0.72  per(accum) = 4.1
 T(dvdsn) = 1.10e-02 S  per =   71  per(accum) = 75
 T(decim) = 3.74e-04 S  per =  2.4  per(accum) = 77
 T(guess) = 1.18e-04 S  per = 0.76  per(accum) = 78
 T(renrm) = 2.88e-03 S  per =   18  per(accum) = 96
 T(save ) = 6.01e-04 S  per =  3.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.07e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.34e-05 S  per = 0.41  per(accum) = 0.41
 T(symbolic_formulae_twodot     ) = 3.17e-04 S  per =    3  per(accum) = 3.4
 T(hintermediate init           ) = 3.30e-05 S  per = 0.31  per(accum) = 3.7
 T(hintermediates memcpy cpu2gpu) = 4.78e-06 S  per = 0.045  per(accum) = 3.7
 T(preprocess_hformulae_Hxlist2 ) = 2.93e-03 S  per =   27  per(accum) = 31
 T(hmmtasks init                ) = 2.03e-03 S  per =   19  per(accum) = 50
 T(dvdson solver [Hx_batchGPU]  ) = 5.26e-03 S  per =   49  per(accum) = 99
 T(dvdson solver [communication]) = 2.12e-07 S  per = 0.002  per(accum) = 99
 T(dvdson solver [rest part]    ) = 8.46e-05 S  per = 0.79  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.83e-03 S
 T(qops init                    ) = 2.04e-04 S  per =  7.2  per(accum) = 7.2
 T(qops_dict memcpy cpu2gpu     ) = 4.03e-05 S  per =  1.4  per(accum) = 8.6
 T(symbolic_formulae_renorm     ) = 2.48e-04 S  per =  8.7  per(accum) = 17
 T(rintermediate init           ) = 1.19e-05 S  per = 0.42  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 5.66e-06 S  per =  0.2  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 5.04e-04 S  per =   18  per(accum) = 36
 T(rmmtasks init                ) = 3.48e-04 S  per =   12  per(accum) = 48
 T(qops memset                  ) = 9.76e-06 S  per = 0.34  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.42e-03 S  per =   50  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.10e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 9.75e-06 S  per = 0.34  per(accum) = 1e+02
##### time_sweep: 1.57e-02 S #####
 T(fetch) = 5.36e-04 S  per =  3.4  per(accum) = 3.4
 T(hdiag) = 1.13e-04 S  per = 0.72  per(accum) = 4.1
 T(dvdsn) = 1.10e-02 S  per =   71  per(accum) = 75
 T(decim) = 3.74e-04 S  per =  2.4  per(accum) = 77
 T(guess) = 1.18e-04 S  per = 0.76  per(accum) = 78
 T(renrm) = 2.88e-03 S  per =   18  per(accum) = 96
 T(save ) = 6.01e-04 S  per =  3.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.07e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.34e-05 S  per = 0.41  per(accum) = 0.41
 T(symbolic_formulae_twodot     ) = 3.17e-04 S  per =    3  per(accum) = 3.4
 T(hintermediate init           ) = 3.30e-05 S  per = 0.31  per(accum) = 3.7
 T(hintermediates memcpy cpu2gpu) = 4.78e-06 S  per = 0.045  per(accum) = 3.7
 T(preprocess_hformulae_Hxlist2 ) = 2.93e-03 S  per =   27  per(accum) = 31
 T(hmmtasks init                ) = 2.03e-03 S  per =   19  per(accum) = 50
 T(dvdson solver [Hx_batchGPU]  ) = 5.26e-03 S  per =   49  per(accum) = 99
 T(dvdson solver [communication]) = 2.12e-07 S  per = 0.002  per(accum) = 99
 T(dvdson solver [rest part]    ) = 8.46e-05 S  per = 0.79  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.83e-03 S
 T(qops init                    ) = 2.04e-04 S  per =  7.2  per(accum) = 7.2
 T(qops_dict memcpy cpu2gpu     ) = 4.03e-05 S  per =  1.4  per(accum) = 8.6
 T(symbolic_formulae_renorm     ) = 2.48e-04 S  per =  8.7  per(accum) = 17
 T(rintermediate init           ) = 1.19e-05 S  per = 0.42  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 5.66e-06 S  per =  0.2  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 5.04e-04 S  per =   18  per(accum) = 36
 T(rmmtasks init                ) = 3.48e-04 S  per =   12  per(accum) = 48
 T(qops memset                  ) = 9.76e-06 S  per = 0.34  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.42e-03 S  per =   50  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.10e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 9.75e-06 S  per = 0.34  per(accum) = 1e+02
##### time_global: 1.57e-02 S #####
 T(fetch) = 5.36e-04 S  per =  3.4  per(accum) = 3.4
 T(hdiag) = 1.13e-04 S  per = 0.72  per(accum) = 4.1
 T(dvdsn) = 1.10e-02 S  per =   71  per(accum) = 75
 T(decim) = 3.74e-04 S  per =  2.4  per(accum) = 77
 T(guess) = 1.18e-04 S  per = 0.76  per(accum) = 78
 T(renrm) = 2.88e-03 S  per =   18  per(accum) = 96
 T(save ) = 6.01e-04 S  per =  3.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.07e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.34e-05 S  per = 0.41  per(accum) = 0.41
 T(symbolic_formulae_twodot     ) = 3.17e-04 S  per =    3  per(accum) = 3.4
 T(hintermediate init           ) = 3.30e-05 S  per = 0.31  per(accum) = 3.7
 T(hintermediates memcpy cpu2gpu) = 4.78e-06 S  per = 0.045  per(accum) = 3.7
 T(preprocess_hformulae_Hxlist2 ) = 2.93e-03 S  per =   27  per(accum) = 31
 T(hmmtasks init                ) = 2.03e-03 S  per =   19  per(accum) = 50
 T(dvdson solver [Hx_batchGPU]  ) = 5.26e-03 S  per =   49  per(accum) = 99
 T(dvdson solver [communication]) = 2.12e-07 S  per = 0.002  per(accum) = 99
 T(dvdson solver [rest part]    ) = 8.46e-05 S  per = 0.79  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.83e-03 S
 T(qops init                    ) = 2.04e-04 S  per =  7.2  per(accum) = 7.2
 T(qops_dict memcpy cpu2gpu     ) = 4.03e-05 S  per =  1.4  per(accum) = 8.6
 T(symbolic_formulae_renorm     ) = 2.48e-04 S  per =  8.7  per(accum) = 17
 T(rintermediate init           ) = 1.19e-05 S  per = 0.42  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 5.66e-06 S  per =  0.2  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 5.04e-04 S  per =   18  per(accum) = 36
 T(rmmtasks init                ) = 3.48e-04 S  per =   12  per(accum) = 48
 T(qops memset                  ) = 9.76e-06 S  per = 0.34  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.42e-03 S  per =   50  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.10e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 9.75e-06 S  per = 0.34  per(accum) = 1e+02

isweep=0 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.588e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=730:0.00557MB:5.44e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1168:0.00891MB:8.7e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=362:0.00276MB:2.7e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 cpsi: len=2 mem=156:0.00119MB:1.16e-06GB
total mem of comb=561:0.00428MB:4.18e-06GB
===== CPUmem(GB): tot=1.29e-05 (comb,oper,dvdson,hvec,renorm)=4.18e-06,8.7e-06,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(10,4,4,4) nnz=78:0.000595MB
stensor4: wf own=1 _data=0x448bc940
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=6 dimAll=10
 (2,0):4 (3,1):2 (1,1):1 (3,-1):1 (4,0):1 (2,2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=42 nblocks=384 size=78:0.000595MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=8.7e-06 (oper)(GB)=8.7e-06
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.793e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 3.095e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=9.39e-06 (oper,hinter)(GB)=8.7e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00227 S size(H_formulae)=188 size(Hxlst)=4522 T(Hmu/Hxlist/sort)=6.61e-05,0.00105,0.00115 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000583 (oper,hinter,dvdson,batch)(GB)=8.7e-06,6.85e-07,1.16e-06,0.000573
===== CPUmem(GB): tot=2.45e-05 (comb,oper,dvdson,hvec,renorm)=4.18e-06,8.7e-06,1.16e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=78 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=3.1e-05,0.000215,0.002,0.000197 cost=5.42e+04 flops[gemm]=2.71e+07
--- TIMING FOR sigma : t_inter=0.000214 t_gemm=0.002 t_reduction=0.000197 tot=0.00241 ---
 sigma counter=3 i=0 t=0.000247 per=12.3 cost=5.06e+03 flops=2.05e+07
 sigma counter=3 i=1 t=0.000247 per=12.3 cost=5.01e+03 flops=2.03e+07
 sigma counter=3 i=2 t=0.000248 per=12.4 cost=5.18e+03 flops=2.09e+07
 sigma counter=3 i=3 t=0.000255 per=12.7 cost=5.15e+03 flops=2.02e+07
 sigma counter=3 i=4 t=0.000241 per=12 cost=5.06e+03 flops=2.1e+07
 sigma counter=3 i=5 t=0.000245 per=12.2 cost=5.01e+03 flops=2.05e+07
 sigma counter=3 i=6 t=0.000258 per=12.9 cost=1.18e+04 flops=4.59e+07
 sigma counter=3 i=7 t=0.00026 per=13 cost=1.18e+04 flops=4.56e+07
 total GEMM cost=5.42e+04 flops=2.71e+07
--- TIMING FOR sigma_tot : t_inter=0.000645 t_gemm=0.00614 t_reduction=0.000611 tot=0.0074 ---
 sigma_tot counter=3 i=0 t=0.000755 per=12.3 cost=1.91e+04 flops=2.53e+07
 sigma_tot counter=3 i=1 t=0.000778 per=12.7 cost=1.9e+04 flops=2.44e+07
 sigma_tot counter=3 i=2 t=0.000748 per=12.2 cost=1.88e+04 flops=2.51e+07
 sigma_tot counter=3 i=3 t=0.000758 per=12.3 cost=1.87e+04 flops=2.47e+07
 sigma_tot counter=3 i=4 t=0.000764 per=12.4 cost=4.28e+04 flops=5.61e+07
 sigma_tot counter=3 i=5 t=0.000779 per=12.7 cost=4.28e+04 flops=5.49e+07
 sigma_tot counter=3 i=6 t=0.000798 per=13 cost=2.54e+04 flops=3.18e+07
 sigma_tot counter=3 i=7 t=0.000762 per=12.4 cost=2.55e+04 flops=3.34e+07
 total GEMM cost=2.12e+05 flops=3.45e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2e-05,0.000206,0.00198,0.000197 cost=5.42e+04 flops[gemm]=2.74e+07
--- TIMING FOR sigma : t_inter=0.000206 t_gemm=0.00197 t_reduction=0.000197 tot=0.00238 ---
 sigma counter=4 i=0 t=0.000241 per=12.2 cost=5.06e+03 flops=2.1e+07
 sigma counter=4 i=1 t=0.000252 per=12.8 cost=5.01e+03 flops=1.99e+07
 sigma counter=4 i=2 t=0.000242 per=12.3 cost=5.18e+03 flops=2.14e+07
 sigma counter=4 i=3 t=0.000244 per=12.4 cost=5.15e+03 flops=2.11e+07
 sigma counter=4 i=4 t=0.000236 per=12 cost=5.06e+03 flops=2.14e+07
 sigma counter=4 i=5 t=0.000252 per=12.8 cost=5.01e+03 flops=1.99e+07
 sigma counter=4 i=6 t=0.000259 per=13.1 cost=1.18e+04 flops=4.57e+07
 sigma counter=4 i=7 t=0.000248 per=12.6 cost=1.18e+04 flops=4.78e+07
 total GEMM cost=5.42e+04 flops=2.74e+07
--- TIMING FOR sigma_tot : t_inter=0.000851 t_gemm=0.00812 t_reduction=0.000808 tot=0.00977 ---
 sigma_tot counter=4 i=0 t=0.000996 per=12.3 cost=2.41e+04 flops=2.42e+07
 sigma_tot counter=4 i=1 t=0.00103 per=12.7 cost=2.4e+04 flops=2.33e+07
 sigma_tot counter=4 i=2 t=0.00099 per=12.2 cost=2.4e+04 flops=2.42e+07
 sigma_tot counter=4 i=3 t=0.001 per=12.3 cost=2.39e+04 flops=2.38e+07
 sigma_tot counter=4 i=4 t=0.001 per=12.3 cost=4.79e+04 flops=4.79e+07
 sigma_tot counter=4 i=5 t=0.00103 per=12.7 cost=4.78e+04 flops=4.64e+07
 sigma_tot counter=4 i=6 t=0.00106 per=13 cost=3.73e+04 flops=3.53e+07
 sigma_tot counter=4 i=7 t=0.00101 per=12.4 cost=3.73e+04 flops=3.7e+07
 total GEMM cost=2.66e+05 flops=3.28e+07
settings: ndim=78 neig=2 maxcycle=30 nbuff=4 memory=1.05e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.650929828670  -1.00e+03   1.40e-02    2     2   5.10e-03  2.55e-03
    1   1 -      -2.272369772185  -1.00e+03   1.99e-02    2     2   5.10e-03  2.55e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.10e-05,2.05e-04,2.00e-03,1.99e-04 cost=5.42e+04 flops[gemm]=2.71e+07
--- TIMING FOR sigma : t_inter=2.05e-04 t_gemm=2.00e-03 t_reduction=1.99e-04 tot=2.41e-03 ---
 sigma counter=5 i=0 t=2.52e-04 per=1.26e+01 cost=5.06e+03 flops=2.01e+07
 sigma counter=5 i=1 t=2.62e-04 per=1.31e+01 cost=5.01e+03 flops=1.91e+07
 sigma counter=5 i=2 t=2.48e-04 per=1.24e+01 cost=5.18e+03 flops=2.09e+07
 sigma counter=5 i=3 t=2.44e-04 per=1.22e+01 cost=5.15e+03 flops=2.11e+07
 sigma counter=5 i=4 t=2.36e-04 per=1.18e+01 cost=5.06e+03 flops=2.14e+07
 sigma counter=5 i=5 t=2.45e-04 per=1.22e+01 cost=5.01e+03 flops=2.05e+07
 sigma counter=5 i=6 t=2.68e-04 per=1.34e+01 cost=1.18e+04 flops=4.42e+07
 sigma counter=5 i=7 t=2.47e-04 per=1.23e+01 cost=1.18e+04 flops=4.80e+07
 total GEMM cost=5.42e+04 flops=2.71e+07
--- TIMING FOR sigma_tot : t_inter=1.06e-03 t_gemm=1.01e-02 t_reduction=1.01e-03 tot=1.22e-02 ---
 sigma_tot counter=5 i=0 t=1.25e-03 per=1.23e+01 cost=2.92e+04 flops=2.34e+07
 sigma_tot counter=5 i=1 t=1.29e-03 per=1.28e+01 cost=2.90e+04 flops=2.25e+07
 sigma_tot counter=5 i=2 t=1.24e-03 per=1.22e+01 cost=2.92e+04 flops=2.36e+07
 sigma_tot counter=5 i=3 t=1.25e-03 per=1.23e+01 cost=2.90e+04 flops=2.33e+07
 sigma_tot counter=5 i=4 t=1.24e-03 per=1.22e+01 cost=5.30e+04 flops=4.28e+07
 sigma_tot counter=5 i=5 t=1.28e-03 per=1.26e+01 cost=5.28e+04 flops=4.14e+07
 sigma_tot counter=5 i=6 t=1.32e-03 per=1.31e+01 cost=4.91e+04 flops=3.71e+07
 sigma_tot counter=5 i=7 t=1.26e-03 per=1.24e+01 cost=4.92e+04 flops=3.91e+07
 total GEMM cost=3.20e+05 flops=3.17e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.02e-04,1.97e-03,2.08e-04 cost=5.42e+04 flops[gemm]=2.75e+07
--- TIMING FOR sigma : t_inter=2.02e-04 t_gemm=1.97e-03 t_reduction=2.08e-04 tot=2.38e-03 ---
 sigma counter=6 i=0 t=2.50e-04 per=1.27e+01 cost=5.06e+03 flops=2.02e+07
 sigma counter=6 i=1 t=2.42e-04 per=1.23e+01 cost=5.01e+03 flops=2.07e+07
 sigma counter=6 i=2 t=2.38e-04 per=1.21e+01 cost=5.18e+03 flops=2.17e+07
 sigma counter=6 i=3 t=2.43e-04 per=1.24e+01 cost=5.15e+03 flops=2.12e+07
 sigma counter=6 i=4 t=2.44e-04 per=1.24e+01 cost=5.06e+03 flops=2.07e+07
 sigma counter=6 i=5 t=2.43e-04 per=1.24e+01 cost=5.01e+03 flops=2.06e+07
 sigma counter=6 i=6 t=2.58e-04 per=1.31e+01 cost=1.18e+04 flops=4.59e+07
 sigma counter=6 i=7 t=2.49e-04 per=1.27e+01 cost=1.18e+04 flops=4.76e+07
 total GEMM cost=5.42e+04 flops=2.75e+07
--- TIMING FOR sigma_tot : t_inter=1.26e-03 t_gemm=1.21e-02 t_reduction=1.22e-03 tot=1.46e-02 ---
 sigma_tot counter=6 i=0 t=1.50e-03 per=1.24e+01 cost=3.42e+04 flops=2.29e+07
 sigma_tot counter=6 i=1 t=1.53e-03 per=1.27e+01 cost=3.40e+04 flops=2.22e+07
 sigma_tot counter=6 i=2 t=1.48e-03 per=1.22e+01 cost=3.43e+04 flops=2.33e+07
 sigma_tot counter=6 i=3 t=1.49e-03 per=1.23e+01 cost=3.42e+04 flops=2.29e+07
 sigma_tot counter=6 i=4 t=1.48e-03 per=1.22e+01 cost=5.80e+04 flops=3.92e+07
 sigma_tot counter=6 i=5 t=1.52e-03 per=1.26e+01 cost=5.78e+04 flops=3.81e+07
 sigma_tot counter=6 i=6 t=1.58e-03 per=1.31e+01 cost=6.10e+04 flops=3.85e+07
 sigma_tot counter=6 i=7 t=1.51e-03 per=1.25e+01 cost=6.10e+04 flops=4.05e+07
 total GEMM cost=3.75e+05 flops=3.10e+07
    2   0 -      -2.651065954409  -1.36e-04   5.04e-03    4     4   1.02e-02  2.55e-03
    2   1 -      -2.272592285910  -2.23e-04   5.21e-03    4     4   1.02e-02  2.55e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.10e-05,2.04e-04,1.98e-03,1.96e-04 cost=5.42e+04 flops[gemm]=2.73e+07
--- TIMING FOR sigma : t_inter=2.04e-04 t_gemm=1.98e-03 t_reduction=1.96e-04 tot=2.38e-03 ---
 sigma counter=7 i=0 t=2.50e-04 per=1.26e+01 cost=5.06e+03 flops=2.02e+07
 sigma counter=7 i=1 t=2.59e-04 per=1.31e+01 cost=5.01e+03 flops=1.94e+07
 sigma counter=7 i=2 t=2.45e-04 per=1.24e+01 cost=5.18e+03 flops=2.11e+07
 sigma counter=7 i=3 t=2.43e-04 per=1.23e+01 cost=5.15e+03 flops=2.12e+07
 sigma counter=7 i=4 t=2.34e-04 per=1.18e+01 cost=5.06e+03 flops=2.16e+07
 sigma counter=7 i=5 t=2.44e-04 per=1.23e+01 cost=5.01e+03 flops=2.05e+07
 sigma counter=7 i=6 t=2.57e-04 per=1.30e+01 cost=1.18e+04 flops=4.61e+07
 sigma counter=7 i=7 t=2.48e-04 per=1.25e+01 cost=1.18e+04 flops=4.78e+07
 total GEMM cost=5.42e+04 flops=2.74e+07
--- TIMING FOR sigma_tot : t_inter=1.46e-03 t_gemm=1.41e-02 t_reduction=1.41e-03 tot=1.69e-02 ---
 sigma_tot counter=7 i=0 t=1.75e-03 per=1.24e+01 cost=3.93e+04 flops=2.25e+07
 sigma_tot counter=7 i=1 t=1.79e-03 per=1.27e+01 cost=3.90e+04 flops=2.18e+07
 sigma_tot counter=7 i=2 t=1.72e-03 per=1.22e+01 cost=3.95e+04 flops=2.30e+07
 sigma_tot counter=7 i=3 t=1.73e-03 per=1.23e+01 cost=3.93e+04 flops=2.27e+07
 sigma_tot counter=7 i=4 t=1.71e-03 per=1.22e+01 cost=6.31e+04 flops=3.68e+07
 sigma_tot counter=7 i=5 t=1.76e-03 per=1.25e+01 cost=6.29e+04 flops=3.57e+07
 sigma_tot counter=7 i=6 t=1.84e-03 per=1.31e+01 cost=7.28e+04 flops=3.96e+07
 sigma_tot counter=7 i=7 t=1.75e-03 per=1.25e+01 cost=7.29e+04 flops=4.15e+07
 total GEMM cost=4.29e+05 flops=3.05e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.03e-04,1.98e-03,1.93e-04 cost=5.42e+04 flops[gemm]=2.74e+07
--- TIMING FOR sigma : t_inter=2.02e-04 t_gemm=1.98e-03 t_reduction=1.92e-04 tot=2.37e-03 ---
 sigma counter=8 i=0 t=2.53e-04 per=1.28e+01 cost=5.06e+03 flops=2.00e+07
 sigma counter=8 i=1 t=2.45e-04 per=1.24e+01 cost=5.01e+03 flops=2.05e+07
 sigma counter=8 i=2 t=2.37e-04 per=1.20e+01 cost=5.18e+03 flops=2.18e+07
 sigma counter=8 i=3 t=2.44e-04 per=1.24e+01 cost=5.15e+03 flops=2.11e+07
 sigma counter=8 i=4 t=2.51e-04 per=1.27e+01 cost=5.06e+03 flops=2.01e+07
 sigma counter=8 i=5 t=2.41e-04 per=1.22e+01 cost=5.01e+03 flops=2.08e+07
 sigma counter=8 i=6 t=2.59e-04 per=1.31e+01 cost=1.18e+04 flops=4.57e+07
 sigma counter=8 i=7 t=2.45e-04 per=1.24e+01 cost=1.18e+04 flops=4.84e+07
 total GEMM cost=5.42e+04 flops=2.74e+07
--- TIMING FOR sigma_tot : t_inter=1.66e-03 t_gemm=1.60e-02 t_reduction=1.60e-03 tot=1.93e-02 ---
 sigma_tot counter=8 i=0 t=2.00e-03 per=1.25e+01 cost=4.43e+04 flops=2.22e+07
 sigma_tot counter=8 i=1 t=2.04e-03 per=1.27e+01 cost=4.40e+04 flops=2.16e+07
 sigma_tot counter=8 i=2 t=1.96e-03 per=1.22e+01 cost=4.47e+04 flops=2.28e+07
 sigma_tot counter=8 i=3 t=1.98e-03 per=1.23e+01 cost=4.45e+04 flops=2.25e+07
 sigma_tot counter=8 i=4 t=1.97e-03 per=1.23e+01 cost=6.81e+04 flops=3.47e+07
 sigma_tot counter=8 i=5 t=2.00e-03 per=1.25e+01 cost=6.79e+04 flops=3.39e+07
 sigma_tot counter=8 i=6 t=2.10e-03 per=1.31e+01 cost=8.47e+04 flops=4.03e+07
 sigma_tot counter=8 i=7 t=2.00e-03 per=1.25e+01 cost=8.47e+04 flops=4.24e+07
 total GEMM cost=4.83e+05 flops=3.01e+07
    3   0 -      -2.651089358155  -2.34e-05   2.26e-03    6     6   1.53e-02  2.55e-03
    3   1 -      -2.272613090414  -2.08e-05   1.99e-03    6     6   1.53e-02  2.55e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,2.03e-04,1.99e-03,1.98e-04 cost=5.42e+04 flops[gemm]=2.71e+07
--- TIMING FOR sigma : t_inter=2.03e-04 t_gemm=2.00e-03 t_reduction=1.98e-04 tot=2.40e-03 ---
 sigma counter=9 i=0 t=2.49e-04 per=1.25e+01 cost=5.06e+03 flops=2.03e+07
 sigma counter=9 i=1 t=2.60e-04 per=1.30e+01 cost=5.01e+03 flops=1.93e+07
 sigma counter=9 i=2 t=2.47e-04 per=1.24e+01 cost=5.18e+03 flops=2.10e+07
 sigma counter=9 i=3 t=2.44e-04 per=1.22e+01 cost=5.15e+03 flops=2.11e+07
 sigma counter=9 i=4 t=2.37e-04 per=1.19e+01 cost=5.06e+03 flops=2.13e+07
 sigma counter=9 i=5 t=2.41e-04 per=1.21e+01 cost=5.01e+03 flops=2.08e+07
 sigma counter=9 i=6 t=2.72e-04 per=1.36e+01 cost=1.18e+04 flops=4.36e+07
 sigma counter=9 i=7 t=2.45e-04 per=1.23e+01 cost=1.18e+04 flops=4.84e+07
 total GEMM cost=5.42e+04 flops=2.71e+07
--- TIMING FOR sigma_tot : t_inter=1.87e-03 t_gemm=1.80e-02 t_reduction=1.80e-03 tot=2.17e-02 ---
 sigma_tot counter=9 i=0 t=2.25e-03 per=1.25e+01 cost=4.94e+04 flops=2.20e+07
 sigma_tot counter=9 i=1 t=2.30e-03 per=1.27e+01 cost=4.91e+04 flops=2.13e+07
 sigma_tot counter=9 i=2 t=2.20e-03 per=1.22e+01 cost=4.99e+04 flops=2.26e+07
 sigma_tot counter=9 i=3 t=2.22e-03 per=1.23e+01 cost=4.96e+04 flops=2.23e+07
 sigma_tot counter=9 i=4 t=2.20e-03 per=1.22e+01 cost=7.32e+04 flops=3.32e+07
 sigma_tot counter=9 i=5 t=2.25e-03 per=1.24e+01 cost=7.29e+04 flops=3.25e+07
 sigma_tot counter=9 i=6 t=2.37e-03 per=1.31e+01 cost=9.65e+04 flops=4.07e+07
 sigma_tot counter=9 i=7 t=2.24e-03 per=1.24e+01 cost=9.66e+04 flops=4.30e+07
 total GEMM cost=5.37e+05 flops=2.98e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.09e-04,1.96e-03,1.99e-04 cost=5.42e+04 flops[gemm]=2.77e+07
--- TIMING FOR sigma : t_inter=2.09e-04 t_gemm=1.96e-03 t_reduction=1.99e-04 tot=2.36e-03 ---
 sigma counter=10 i=0 t=2.42e-04 per=1.24e+01 cost=5.06e+03 flops=2.09e+07
 sigma counter=10 i=1 t=2.56e-04 per=1.31e+01 cost=5.01e+03 flops=1.96e+07
 sigma counter=10 i=2 t=2.37e-04 per=1.21e+01 cost=5.18e+03 flops=2.18e+07
 sigma counter=10 i=3 t=2.43e-04 per=1.24e+01 cost=5.15e+03 flops=2.12e+07
 sigma counter=10 i=4 t=2.38e-04 per=1.22e+01 cost=5.06e+03 flops=2.12e+07
 sigma counter=10 i=5 t=2.39e-04 per=1.22e+01 cost=5.01e+03 flops=2.10e+07
 sigma counter=10 i=6 t=2.57e-04 per=1.31e+01 cost=1.18e+04 flops=4.61e+07
 sigma counter=10 i=7 t=2.45e-04 per=1.25e+01 cost=1.18e+04 flops=4.84e+07
 total GEMM cost=5.42e+04 flops=2.77e+07
--- TIMING FOR sigma_tot : t_inter=2.08e-03 t_gemm=2.00e-02 t_reduction=2.00e-03 tot=2.41e-02 ---
 sigma_tot counter=10 i=0 t=2.49e-03 per=1.25e+01 cost=5.45e+04 flops=2.19e+07
 sigma_tot counter=10 i=1 t=2.55e-03 per=1.28e+01 cost=5.41e+04 flops=2.12e+07
 sigma_tot counter=10 i=2 t=2.44e-03 per=1.22e+01 cost=5.50e+04 flops=2.25e+07
 sigma_tot counter=10 i=3 t=2.46e-03 per=1.23e+01 cost=5.48e+04 flops=2.22e+07
 sigma_tot counter=10 i=4 t=2.44e-03 per=1.22e+01 cost=7.82e+04 flops=3.21e+07
 sigma_tot counter=10 i=5 t=2.48e-03 per=1.24e+01 cost=7.79e+04 flops=3.14e+07
 sigma_tot counter=10 i=6 t=2.63e-03 per=1.31e+01 cost=1.08e+05 flops=4.12e+07
 sigma_tot counter=10 i=7 t=2.49e-03 per=1.24e+01 cost=1.08e+05 flops=4.36e+07
 total GEMM cost=5.91e+05 flops=2.96e+07
    4   0 -      -2.651092508944  -3.15e-06   6.33e-04    6     8   2.04e-02  2.55e-03
    4   1 -      -2.281843638883  -9.23e-03   2.82e-01    6     8   2.04e-02  2.55e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,2.01e-04,1.98e-03,1.95e-04 cost=5.42e+04 flops[gemm]=2.73e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.98e-03 t_reduction=1.95e-04 tot=2.38e-03 ---
 sigma counter=11 i=0 t=2.47e-04 per=1.25e+01 cost=5.06e+03 flops=2.05e+07
 sigma counter=11 i=1 t=2.70e-04 per=1.36e+01 cost=5.01e+03 flops=1.86e+07
 sigma counter=11 i=2 t=2.38e-04 per=1.20e+01 cost=5.18e+03 flops=2.17e+07
 sigma counter=11 i=3 t=2.43e-04 per=1.23e+01 cost=5.15e+03 flops=2.12e+07
 sigma counter=11 i=4 t=2.35e-04 per=1.19e+01 cost=5.06e+03 flops=2.15e+07
 sigma counter=11 i=5 t=2.43e-04 per=1.23e+01 cost=5.01e+03 flops=2.06e+07
 sigma counter=11 i=6 t=2.58e-04 per=1.30e+01 cost=1.18e+04 flops=4.59e+07
 sigma counter=11 i=7 t=2.47e-04 per=1.25e+01 cost=1.18e+04 flops=4.80e+07
 total GEMM cost=5.42e+04 flops=2.73e+07
--- TIMING FOR sigma_tot : t_inter=2.28e-03 t_gemm=2.20e-02 t_reduction=2.20e-03 tot=2.64e-02 ---
 sigma_tot counter=11 i=0 t=2.74e-03 per=1.25e+01 cost=5.95e+04 flops=2.17e+07
 sigma_tot counter=11 i=1 t=2.82e-03 per=1.29e+01 cost=5.91e+04 flops=2.09e+07
 sigma_tot counter=11 i=2 t=2.68e-03 per=1.22e+01 cost=6.02e+04 flops=2.25e+07
 sigma_tot counter=11 i=3 t=2.71e-03 per=1.23e+01 cost=5.99e+04 flops=2.21e+07
 sigma_tot counter=11 i=4 t=2.67e-03 per=1.22e+01 cost=8.33e+04 flops=3.11e+07
 sigma_tot counter=11 i=5 t=2.73e-03 per=1.24e+01 cost=8.29e+04 flops=3.04e+07
 sigma_tot counter=11 i=6 t=2.89e-03 per=1.31e+01 cost=1.20e+05 flops=4.16e+07
 sigma_tot counter=11 i=7 t=2.74e-03 per=1.25e+01 cost=1.20e+05 flops=4.40e+07
 total GEMM cost=6.45e+05 flops=2.94e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.09e-04,1.96e-03,1.96e-04 cost=5.42e+04 flops[gemm]=2.76e+07
--- TIMING FOR sigma : t_inter=2.09e-04 t_gemm=1.96e-03 t_reduction=1.96e-04 tot=2.37e-03 ---
 sigma counter=12 i=0 t=2.40e-04 per=1.22e+01 cost=5.06e+03 flops=2.11e+07
 sigma counter=12 i=1 t=2.47e-04 per=1.26e+01 cost=5.01e+03 flops=2.03e+07
 sigma counter=12 i=2 t=2.38e-04 per=1.21e+01 cost=5.18e+03 flops=2.17e+07
 sigma counter=12 i=3 t=2.52e-04 per=1.28e+01 cost=5.15e+03 flops=2.04e+07
 sigma counter=12 i=4 t=2.38e-04 per=1.21e+01 cost=5.06e+03 flops=2.12e+07
 sigma counter=12 i=5 t=2.37e-04 per=1.21e+01 cost=5.01e+03 flops=2.11e+07
 sigma counter=12 i=6 t=2.56e-04 per=1.30e+01 cost=1.18e+04 flops=4.63e+07
 sigma counter=12 i=7 t=2.56e-04 per=1.30e+01 cost=1.18e+04 flops=4.63e+07
 total GEMM cost=5.42e+04 flops=2.76e+07
--- TIMING FOR sigma_tot : t_inter=2.49e-03 t_gemm=2.39e-02 t_reduction=2.39e-03 tot=2.88e-02 ---
 sigma_tot counter=12 i=0 t=2.98e-03 per=1.24e+01 cost=6.46e+04 flops=2.17e+07
 sigma_tot counter=12 i=1 t=3.07e-03 per=1.28e+01 cost=6.41e+04 flops=2.09e+07
 sigma_tot counter=12 i=2 t=2.92e-03 per=1.22e+01 cost=6.54e+04 flops=2.24e+07
 sigma_tot counter=12 i=3 t=2.96e-03 per=1.24e+01 cost=6.50e+04 flops=2.20e+07
 sigma_tot counter=12 i=4 t=2.91e-03 per=1.22e+01 cost=8.84e+04 flops=3.03e+07
 sigma_tot counter=12 i=5 t=2.96e-03 per=1.24e+01 cost=8.79e+04 flops=2.97e+07
 sigma_tot counter=12 i=6 t=3.14e-03 per=1.31e+01 cost=1.32e+05 flops=4.20e+07
 sigma_tot counter=12 i=7 t=2.99e-03 per=1.25e+01 cost=1.32e+05 flops=4.42e+07
 total GEMM cost=7.00e+05 flops=2.92e+07
    5   0 -      -2.651092802413  -2.93e-07   2.04e-04    6    10   2.54e-02  2.54e-03
    5   1 -      -2.392715775374  -1.11e-01   2.01e-01    6    10   2.54e-02  2.54e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,2.17e-04,2.06e-03,1.95e-04 cost=5.42e+04 flops[gemm]=2.62e+07
--- TIMING FOR sigma : t_inter=2.17e-04 t_gemm=2.06e-03 t_reduction=1.95e-04 tot=2.48e-03 ---
 sigma counter=13 i=0 t=2.47e-04 per=1.20e+01 cost=5.06e+03 flops=2.05e+07
 sigma counter=13 i=1 t=2.62e-04 per=1.27e+01 cost=5.01e+03 flops=1.91e+07
 sigma counter=13 i=2 t=2.48e-04 per=1.20e+01 cost=5.18e+03 flops=2.09e+07
 sigma counter=13 i=3 t=2.49e-04 per=1.21e+01 cost=5.15e+03 flops=2.07e+07
 sigma counter=13 i=4 t=2.45e-04 per=1.19e+01 cost=5.06e+03 flops=2.06e+07
 sigma counter=13 i=5 t=2.73e-04 per=1.32e+01 cost=5.01e+03 flops=1.84e+07
 sigma counter=13 i=6 t=2.96e-04 per=1.43e+01 cost=1.18e+04 flops=4.00e+07
 sigma counter=13 i=7 t=2.45e-04 per=1.19e+01 cost=1.18e+04 flops=4.84e+07
 total GEMM cost=5.42e+04 flops=2.62e+07
--- TIMING FOR sigma_tot : t_inter=2.70e-03 t_gemm=2.60e-02 t_reduction=2.59e-03 tot=3.13e-02 ---
 sigma_tot counter=13 i=0 t=3.23e-03 per=1.24e+01 cost=6.96e+04 flops=2.16e+07
 sigma_tot counter=13 i=1 t=3.33e-03 per=1.28e+01 cost=6.91e+04 flops=2.07e+07
 sigma_tot counter=13 i=2 t=3.17e-03 per=1.22e+01 cost=7.06e+04 flops=2.23e+07
 sigma_tot counter=13 i=3 t=3.21e-03 per=1.23e+01 cost=7.02e+04 flops=2.19e+07
 sigma_tot counter=13 i=4 t=3.16e-03 per=1.21e+01 cost=9.34e+04 flops=2.96e+07
 sigma_tot counter=13 i=5 t=3.24e-03 per=1.24e+01 cost=9.29e+04 flops=2.87e+07
 sigma_tot counter=13 i=6 t=3.44e-03 per=1.32e+01 cost=1.44e+05 flops=4.19e+07
 sigma_tot counter=13 i=7 t=3.24e-03 per=1.24e+01 cost=1.44e+05 flops=4.45e+07
 total GEMM cost=7.54e+05 flops=2.90e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.01e-04,1.95e-03,1.97e-04 cost=5.42e+04 flops[gemm]=2.78e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.95e-03 t_reduction=1.96e-04 tot=2.35e-03 ---
 sigma counter=14 i=0 t=2.43e-04 per=1.25e+01 cost=5.06e+03 flops=2.08e+07
 sigma counter=14 i=1 t=2.40e-04 per=1.23e+01 cost=5.01e+03 flops=2.09e+07
 sigma counter=14 i=2 t=2.37e-04 per=1.22e+01 cost=5.18e+03 flops=2.18e+07
 sigma counter=14 i=3 t=2.45e-04 per=1.26e+01 cost=5.15e+03 flops=2.10e+07
 sigma counter=14 i=4 t=2.36e-04 per=1.21e+01 cost=5.06e+03 flops=2.14e+07
 sigma counter=14 i=5 t=2.40e-04 per=1.23e+01 cost=5.01e+03 flops=2.09e+07
 sigma counter=14 i=6 t=2.57e-04 per=1.32e+01 cost=1.18e+04 flops=4.61e+07
 sigma counter=14 i=7 t=2.51e-04 per=1.29e+01 cost=1.18e+04 flops=4.72e+07
 total GEMM cost=5.42e+04 flops=2.78e+07
--- TIMING FOR sigma_tot : t_inter=2.90e-03 t_gemm=2.80e-02 t_reduction=2.78e-03 tot=3.36e-02 ---
 sigma_tot counter=14 i=0 t=3.47e-03 per=1.24e+01 cost=7.47e+04 flops=2.15e+07
 sigma_tot counter=14 i=1 t=3.57e-03 per=1.28e+01 cost=7.41e+04 flops=2.07e+07
 sigma_tot counter=14 i=2 t=3.40e-03 per=1.22e+01 cost=7.57e+04 flops=2.23e+07
 sigma_tot counter=14 i=3 t=3.45e-03 per=1.24e+01 cost=7.53e+04 flops=2.18e+07
 sigma_tot counter=14 i=4 t=3.39e-03 per=1.21e+01 cost=9.85e+04 flops=2.90e+07
 sigma_tot counter=14 i=5 t=3.48e-03 per=1.24e+01 cost=9.79e+04 flops=2.82e+07
 sigma_tot counter=14 i=6 t=3.69e-03 per=1.32e+01 cost=1.56e+05 flops=4.21e+07
 sigma_tot counter=14 i=7 t=3.49e-03 per=1.25e+01 cost=1.56e+05 flops=4.47e+07
 total GEMM cost=8.08e+05 flops=2.89e+07
    6   0 +      -2.651092830126  -2.77e-08   5.87e-05    6    12   3.06e-02  2.55e-03
    6   1 -      -2.424170523007  -3.15e-02   6.79e-02    6    12   3.06e-02  2.55e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.01e-04,1.97e-03,1.96e-04 cost=5.42e+04 flops[gemm]=2.75e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.97e-03 t_reduction=1.96e-04 tot=2.37e-03 ---
 sigma counter=15 i=0 t=2.53e-04 per=1.28e+01 cost=5.06e+03 flops=2.00e+07
 sigma counter=15 i=1 t=2.57e-04 per=1.30e+01 cost=5.01e+03 flops=1.95e+07
 sigma counter=15 i=2 t=2.35e-04 per=1.19e+01 cost=5.18e+03 flops=2.20e+07
 sigma counter=15 i=3 t=2.41e-04 per=1.22e+01 cost=5.15e+03 flops=2.14e+07
 sigma counter=15 i=4 t=2.37e-04 per=1.20e+01 cost=5.06e+03 flops=2.13e+07
 sigma counter=15 i=5 t=2.46e-04 per=1.25e+01 cost=5.01e+03 flops=2.04e+07
 sigma counter=15 i=6 t=2.58e-04 per=1.31e+01 cost=1.18e+04 flops=4.59e+07
 sigma counter=15 i=7 t=2.44e-04 per=1.24e+01 cost=1.18e+04 flops=4.86e+07
 total GEMM cost=5.42e+04 flops=2.75e+07
--- TIMING FOR sigma_tot : t_inter=3.11e-03 t_gemm=2.99e-02 t_reduction=2.98e-03 tot=3.60e-02 ---
 sigma_tot counter=15 i=0 t=3.72e-03 per=1.24e+01 cost=7.97e+04 flops=2.14e+07
 sigma_tot counter=15 i=1 t=3.83e-03 per=1.28e+01 cost=7.91e+04 flops=2.07e+07
 sigma_tot counter=15 i=2 t=3.64e-03 per=1.22e+01 cost=8.09e+04 flops=2.22e+07
 sigma_tot counter=15 i=3 t=3.69e-03 per=1.23e+01 cost=8.05e+04 flops=2.18e+07
 sigma_tot counter=15 i=4 t=3.63e-03 per=1.21e+01 cost=1.04e+05 flops=2.85e+07
 sigma_tot counter=15 i=5 t=3.72e-03 per=1.24e+01 cost=1.03e+05 flops=2.77e+07
 sigma_tot counter=15 i=6 t=3.95e-03 per=1.32e+01 cost=1.68e+05 flops=4.24e+07
 sigma_tot counter=15 i=7 t=3.73e-03 per=1.25e+01 cost=1.68e+05 flops=4.49e+07
 total GEMM cost=8.62e+05 flops=2.88e+07
    7   0 +      -2.651092830133  -6.90e-12   5.85e-05    5    13   3.31e-02  2.55e-03
    7   1 -      -2.427293692446  -3.12e-03   1.87e-02    5    13   3.31e-02  2.55e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.10e-05,2.03e-04,1.98e-03,1.95e-04 cost=5.42e+04 flops[gemm]=2.74e+07
--- TIMING FOR sigma : t_inter=2.03e-04 t_gemm=1.98e-03 t_reduction=1.95e-04 tot=2.38e-03 ---
 sigma counter=16 i=0 t=2.46e-04 per=1.24e+01 cost=5.06e+03 flops=2.06e+07
 sigma counter=16 i=1 t=2.53e-04 per=1.28e+01 cost=5.01e+03 flops=1.98e+07
 sigma counter=16 i=2 t=2.45e-04 per=1.24e+01 cost=5.18e+03 flops=2.11e+07
 sigma counter=16 i=3 t=2.43e-04 per=1.23e+01 cost=5.15e+03 flops=2.12e+07
 sigma counter=16 i=4 t=2.37e-04 per=1.20e+01 cost=5.06e+03 flops=2.13e+07
 sigma counter=16 i=5 t=2.42e-04 per=1.22e+01 cost=5.01e+03 flops=2.07e+07
 sigma counter=16 i=6 t=2.66e-04 per=1.34e+01 cost=1.18e+04 flops=4.45e+07
 sigma counter=16 i=7 t=2.46e-04 per=1.24e+01 cost=1.18e+04 flops=4.82e+07
 total GEMM cost=5.42e+04 flops=2.74e+07
--- TIMING FOR sigma_tot : t_inter=3.31e-03 t_gemm=3.19e-02 t_reduction=3.17e-03 tot=3.84e-02 ---
 sigma_tot counter=16 i=0 t=3.97e-03 per=1.24e+01 cost=8.48e+04 flops=2.14e+07
 sigma_tot counter=16 i=1 t=4.08e-03 per=1.28e+01 cost=8.41e+04 flops=2.06e+07
 sigma_tot counter=16 i=2 t=3.88e-03 per=1.22e+01 cost=8.61e+04 flops=2.22e+07
 sigma_tot counter=16 i=3 t=3.94e-03 per=1.23e+01 cost=8.56e+04 flops=2.18e+07
 sigma_tot counter=16 i=4 t=3.87e-03 per=1.21e+01 cost=1.09e+05 flops=2.81e+07
 sigma_tot counter=16 i=5 t=3.97e-03 per=1.24e+01 cost=1.08e+05 flops=2.72e+07
 sigma_tot counter=16 i=6 t=4.22e-03 per=1.32e+01 cost=1.79e+05 flops=4.25e+07
 sigma_tot counter=16 i=7 t=3.98e-03 per=1.25e+01 cost=1.80e+05 flops=4.51e+07
 total GEMM cost=9.16e+05 flops=2.87e+07
    8   0 +      -2.651092830134  -1.15e-12   5.86e-05    4    14   3.57e-02  2.55e-03
    8   1 -      -2.427585633457  -2.92e-04   8.38e-03    4    14   3.57e-02  2.55e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.01e-04,1.97e-03,2.04e-04 cost=5.42e+04 flops[gemm]=2.75e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.97e-03 t_reduction=2.04e-04 tot=2.38e-03 ---
 sigma counter=17 i=0 t=2.55e-04 per=1.29e+01 cost=5.06e+03 flops=1.98e+07
 sigma counter=17 i=1 t=2.57e-04 per=1.30e+01 cost=5.01e+03 flops=1.95e+07
 sigma counter=17 i=2 t=2.37e-04 per=1.20e+01 cost=5.18e+03 flops=2.18e+07
 sigma counter=17 i=3 t=2.41e-04 per=1.22e+01 cost=5.15e+03 flops=2.14e+07
 sigma counter=17 i=4 t=2.37e-04 per=1.20e+01 cost=5.06e+03 flops=2.13e+07
 sigma counter=17 i=5 t=2.41e-04 per=1.22e+01 cost=5.01e+03 flops=2.08e+07
 sigma counter=17 i=6 t=2.57e-04 per=1.30e+01 cost=1.18e+04 flops=4.61e+07
 sigma counter=17 i=7 t=2.46e-04 per=1.25e+01 cost=1.18e+04 flops=4.82e+07
 total GEMM cost=5.42e+04 flops=2.75e+07
--- TIMING FOR sigma_tot : t_inter=3.51e-03 t_gemm=3.39e-02 t_reduction=3.38e-03 tot=4.08e-02 ---
 sigma_tot counter=17 i=0 t=4.22e-03 per=1.25e+01 cost=8.99e+04 flops=2.13e+07
 sigma_tot counter=17 i=1 t=4.34e-03 per=1.28e+01 cost=8.92e+04 flops=2.05e+07
 sigma_tot counter=17 i=2 t=4.12e-03 per=1.22e+01 cost=9.13e+04 flops=2.22e+07
 sigma_tot counter=17 i=3 t=4.18e-03 per=1.23e+01 cost=9.08e+04 flops=2.17e+07
 sigma_tot counter=17 i=4 t=4.10e-03 per=1.21e+01 cost=1.14e+05 flops=2.77e+07
 sigma_tot counter=17 i=5 t=4.21e-03 per=1.24e+01 cost=1.13e+05 flops=2.69e+07
 sigma_tot counter=17 i=6 t=4.48e-03 per=1.32e+01 cost=1.91e+05 flops=4.27e+07
 sigma_tot counter=17 i=7 t=4.22e-03 per=1.25e+01 cost=1.91e+05 flops=4.53e+07
 total GEMM cost=9.70e+05 flops=2.86e+07
    9   0 +      -2.651092830134  -6.37e-13   5.85e-05    4    15   3.82e-02  2.55e-03
    9   1 -      -2.427634221137  -4.86e-05   3.09e-03    4    15   3.82e-02  2.55e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.10e-05,2.01e-04,1.99e-03,1.94e-04 cost=5.42e+04 flops[gemm]=2.73e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.99e-03 t_reduction=1.94e-04 tot=2.38e-03 ---
 sigma counter=18 i=0 t=2.50e-04 per=1.26e+01 cost=5.06e+03 flops=2.02e+07
 sigma counter=18 i=1 t=2.62e-04 per=1.32e+01 cost=5.01e+03 flops=1.91e+07
 sigma counter=18 i=2 t=2.44e-04 per=1.23e+01 cost=5.18e+03 flops=2.12e+07
 sigma counter=18 i=3 t=2.41e-04 per=1.21e+01 cost=5.15e+03 flops=2.14e+07
 sigma counter=18 i=4 t=2.36e-04 per=1.19e+01 cost=5.06e+03 flops=2.14e+07
 sigma counter=18 i=5 t=2.40e-04 per=1.21e+01 cost=5.01e+03 flops=2.09e+07
 sigma counter=18 i=6 t=2.68e-04 per=1.35e+01 cost=1.18e+04 flops=4.42e+07
 sigma counter=18 i=7 t=2.45e-04 per=1.23e+01 cost=1.18e+04 flops=4.84e+07
 total GEMM cost=5.42e+04 flops=2.73e+07
--- TIMING FOR sigma_tot : t_inter=3.71e-03 t_gemm=3.59e-02 t_reduction=3.57e-03 tot=4.31e-02 ---
 sigma_tot counter=18 i=0 t=4.47e-03 per=1.25e+01 cost=9.49e+04 flops=2.12e+07
 sigma_tot counter=18 i=1 t=4.60e-03 per=1.28e+01 cost=9.42e+04 flops=2.05e+07
 sigma_tot counter=18 i=2 t=4.36e-03 per=1.22e+01 cost=9.64e+04 flops=2.21e+07
 sigma_tot counter=18 i=3 t=4.42e-03 per=1.23e+01 cost=9.59e+04 flops=2.17e+07
 sigma_tot counter=18 i=4 t=4.34e-03 per=1.21e+01 cost=1.19e+05 flops=2.73e+07
 sigma_tot counter=18 i=5 t=4.45e-03 per=1.24e+01 cost=1.18e+05 flops=2.65e+07
 sigma_tot counter=18 i=6 t=4.74e-03 per=1.32e+01 cost=2.03e+05 flops=4.28e+07
 sigma_tot counter=18 i=7 t=4.47e-03 per=1.25e+01 cost=2.03e+05 flops=4.55e+07
 total GEMM cost=1.02e+06 flops=2.86e+07
   10   0 +      -2.651092830150  -1.53e-11   5.86e-05    4    16   4.08e-02  2.55e-03
   10   1 -      -2.427641420031  -7.20e-06   1.36e-03    4    16   4.08e-02  2.55e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.08e-04,1.98e-03,1.96e-04 cost=5.42e+04 flops[gemm]=2.74e+07
--- TIMING FOR sigma : t_inter=2.08e-04 t_gemm=1.97e-03 t_reduction=1.96e-04 tot=2.38e-03 ---
 sigma counter=19 i=0 t=2.47e-04 per=1.25e+01 cost=5.06e+03 flops=2.05e+07
 sigma counter=19 i=1 t=2.60e-04 per=1.32e+01 cost=5.01e+03 flops=1.93e+07
 sigma counter=19 i=2 t=2.37e-04 per=1.20e+01 cost=5.18e+03 flops=2.18e+07
 sigma counter=19 i=3 t=2.42e-04 per=1.23e+01 cost=5.15e+03 flops=2.13e+07
 sigma counter=19 i=4 t=2.44e-04 per=1.24e+01 cost=5.06e+03 flops=2.07e+07
 sigma counter=19 i=5 t=2.42e-04 per=1.23e+01 cost=5.01e+03 flops=2.07e+07
 sigma counter=19 i=6 t=2.56e-04 per=1.30e+01 cost=1.18e+04 flops=4.63e+07
 sigma counter=19 i=7 t=2.46e-04 per=1.25e+01 cost=1.18e+04 flops=4.82e+07
 total GEMM cost=5.42e+04 flops=2.74e+07
--- TIMING FOR sigma_tot : t_inter=3.92e-03 t_gemm=3.78e-02 t_reduction=3.77e-03 tot=4.55e-02 ---
 sigma_tot counter=19 i=0 t=4.72e-03 per=1.25e+01 cost=1.00e+05 flops=2.12e+07
 sigma_tot counter=19 i=1 t=4.86e-03 per=1.29e+01 cost=9.92e+04 flops=2.04e+07
 sigma_tot counter=19 i=2 t=4.60e-03 per=1.22e+01 cost=1.02e+05 flops=2.21e+07
 sigma_tot counter=19 i=3 t=4.66e-03 per=1.23e+01 cost=1.01e+05 flops=2.17e+07
 sigma_tot counter=19 i=4 t=4.58e-03 per=1.21e+01 cost=1.24e+05 flops=2.70e+07
 sigma_tot counter=19 i=5 t=4.69e-03 per=1.24e+01 cost=1.23e+05 flops=2.62e+07
 sigma_tot counter=19 i=6 t=5.00e-03 per=1.32e+01 cost=2.15e+05 flops=4.30e+07
 sigma_tot counter=19 i=7 t=4.71e-03 per=1.25e+01 cost=2.15e+05 flops=4.56e+07
 total GEMM cost=1.08e+06 flops=2.85e+07
   11   0 +      -2.651092830200  -5.06e-11   5.84e-05    4    17   4.33e-02  2.55e-03
   11   1 -      -2.427642854019  -1.43e-06   5.04e-04    4    17   4.33e-02  2.55e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.03e-04,1.98e-03,1.94e-04 cost=5.42e+04 flops[gemm]=2.74e+07
--- TIMING FOR sigma : t_inter=2.03e-04 t_gemm=1.98e-03 t_reduction=1.94e-04 tot=2.38e-03 ---
 sigma counter=20 i=0 t=2.48e-04 per=1.25e+01 cost=5.06e+03 flops=2.04e+07
 sigma counter=20 i=1 t=2.66e-04 per=1.34e+01 cost=5.01e+03 flops=1.88e+07
 sigma counter=20 i=2 t=2.39e-04 per=1.21e+01 cost=5.18e+03 flops=2.17e+07
 sigma counter=20 i=3 t=2.43e-04 per=1.23e+01 cost=5.15e+03 flops=2.12e+07
 sigma counter=20 i=4 t=2.35e-04 per=1.19e+01 cost=5.06e+03 flops=2.15e+07
 sigma counter=20 i=5 t=2.48e-04 per=1.25e+01 cost=5.01e+03 flops=2.02e+07
 sigma counter=20 i=6 t=2.56e-04 per=1.29e+01 cost=1.18e+04 flops=4.63e+07
 sigma counter=20 i=7 t=2.45e-04 per=1.24e+01 cost=1.18e+04 flops=4.84e+07
 total GEMM cost=5.42e+04 flops=2.74e+07
--- TIMING FOR sigma_tot : t_inter=4.12e-03 t_gemm=3.98e-02 t_reduction=3.96e-03 tot=4.79e-02 ---
 sigma_tot counter=20 i=0 t=4.97e-03 per=1.25e+01 cost=1.05e+05 flops=2.11e+07
 sigma_tot counter=20 i=1 t=5.13e-03 per=1.29e+01 cost=1.04e+05 flops=2.03e+07
 sigma_tot counter=20 i=2 t=4.84e-03 per=1.22e+01 cost=1.07e+05 flops=2.21e+07
 sigma_tot counter=20 i=3 t=4.90e-03 per=1.23e+01 cost=1.06e+05 flops=2.17e+07
 sigma_tot counter=20 i=4 t=4.82e-03 per=1.21e+01 cost=1.29e+05 flops=2.67e+07
 sigma_tot counter=20 i=5 t=4.94e-03 per=1.24e+01 cost=1.28e+05 flops=2.59e+07
 sigma_tot counter=20 i=6 t=5.26e-03 per=1.32e+01 cost=2.27e+05 flops=4.32e+07
 sigma_tot counter=20 i=7 t=4.96e-03 per=1.25e+01 cost=2.27e+05 flops=4.57e+07
 total GEMM cost=1.13e+06 flops=2.85e+07
   12   0 +      -2.651092830232  -3.17e-11   5.81e-05    4    18   4.59e-02  2.55e-03
   12   1 -      -2.427643127214  -2.73e-07   2.10e-04    4    18   4.59e-02  2.55e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.12e-04,1.97e-03,2.00e-04 cost=5.42e+04 flops[gemm]=2.75e+07
--- TIMING FOR sigma : t_inter=2.11e-04 t_gemm=1.97e-03 t_reduction=2.00e-04 tot=2.38e-03 ---
 sigma counter=21 i=0 t=2.46e-04 per=1.25e+01 cost=5.06e+03 flops=2.06e+07
 sigma counter=21 i=1 t=2.56e-04 per=1.30e+01 cost=5.01e+03 flops=1.96e+07
 sigma counter=21 i=2 t=2.38e-04 per=1.21e+01 cost=5.18e+03 flops=2.17e+07
 sigma counter=21 i=3 t=2.42e-04 per=1.23e+01 cost=5.15e+03 flops=2.13e+07
 sigma counter=21 i=4 t=2.37e-04 per=1.20e+01 cost=5.06e+03 flops=2.13e+07
 sigma counter=21 i=5 t=2.39e-04 per=1.21e+01 cost=5.01e+03 flops=2.10e+07
 sigma counter=21 i=6 t=2.57e-04 per=1.31e+01 cost=1.18e+04 flops=4.61e+07
 sigma counter=21 i=7 t=2.53e-04 per=1.29e+01 cost=1.18e+04 flops=4.68e+07
 total GEMM cost=5.42e+04 flops=2.75e+07
--- TIMING FOR sigma_tot : t_inter=4.33e-03 t_gemm=4.18e-02 t_reduction=4.16e-03 tot=5.03e-02 ---
 sigma_tot counter=21 i=0 t=5.21e-03 per=1.25e+01 cost=1.10e+05 flops=2.11e+07
 sigma_tot counter=21 i=1 t=5.38e-03 per=1.29e+01 cost=1.09e+05 flops=2.03e+07
 sigma_tot counter=21 i=2 t=5.08e-03 per=1.22e+01 cost=1.12e+05 flops=2.21e+07
 sigma_tot counter=21 i=3 t=5.15e-03 per=1.23e+01 cost=1.11e+05 flops=2.16e+07
 sigma_tot counter=21 i=4 t=5.06e-03 per=1.21e+01 cost=1.34e+05 flops=2.65e+07
 sigma_tot counter=21 i=5 t=5.17e-03 per=1.24e+01 cost=1.33e+05 flops=2.57e+07
 sigma_tot counter=21 i=6 t=5.51e-03 per=1.32e+01 cost=2.39e+05 flops=4.33e+07
 sigma_tot counter=21 i=7 t=5.21e-03 per=1.25e+01 cost=2.39e+05 flops=4.58e+07
 total GEMM cost=1.19e+06 flops=2.84e+07
   13   0 +      -2.651092830362  -1.30e-10   5.68e-05    4    19   4.85e-02  2.55e-03
   13   1 -      -2.427643172033  -4.48e-08   1.24e-04    4    19   4.85e-02  2.55e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,2.06e-04,1.96e-03,1.95e-04 cost=5.42e+04 flops[gemm]=2.76e+07
--- TIMING FOR sigma : t_inter=2.06e-04 t_gemm=1.96e-03 t_reduction=1.95e-04 tot=2.36e-03 ---
 sigma counter=22 i=0 t=2.50e-04 per=1.27e+01 cost=5.06e+03 flops=2.02e+07
 sigma counter=22 i=1 t=2.54e-04 per=1.29e+01 cost=5.01e+03 flops=1.97e+07
 sigma counter=22 i=2 t=2.37e-04 per=1.21e+01 cost=5.18e+03 flops=2.18e+07
 sigma counter=22 i=3 t=2.41e-04 per=1.23e+01 cost=5.15e+03 flops=2.14e+07
 sigma counter=22 i=4 t=2.36e-04 per=1.20e+01 cost=5.06e+03 flops=2.14e+07
 sigma counter=22 i=5 t=2.42e-04 per=1.23e+01 cost=5.01e+03 flops=2.07e+07
 sigma counter=22 i=6 t=2.57e-04 per=1.31e+01 cost=1.18e+04 flops=4.61e+07
 sigma counter=22 i=7 t=2.45e-04 per=1.25e+01 cost=1.18e+04 flops=4.84e+07
 total GEMM cost=5.42e+04 flops=2.76e+07
--- TIMING FOR sigma_tot : t_inter=4.54e-03 t_gemm=4.37e-02 t_reduction=4.36e-03 tot=5.26e-02 ---
 sigma_tot counter=22 i=0 t=5.46e-03 per=1.25e+01 cost=1.15e+05 flops=2.11e+07
 sigma_tot counter=22 i=1 t=5.64e-03 per=1.29e+01 cost=1.14e+05 flops=2.03e+07
 sigma_tot counter=22 i=2 t=5.31e-03 per=1.22e+01 cost=1.17e+05 flops=2.20e+07
 sigma_tot counter=22 i=3 t=5.39e-03 per=1.23e+01 cost=1.17e+05 flops=2.16e+07
 sigma_tot counter=22 i=4 t=5.29e-03 per=1.21e+01 cost=1.39e+05 flops=2.62e+07
 sigma_tot counter=22 i=5 t=5.42e-03 per=1.24e+01 cost=1.38e+05 flops=2.55e+07
 sigma_tot counter=22 i=6 t=5.77e-03 per=1.32e+01 cost=2.51e+05 flops=4.34e+07
 sigma_tot counter=22 i=7 t=5.46e-03 per=1.25e+01 cost=2.51e+05 flops=4.59e+07
 total GEMM cost=1.24e+06 flops=2.84e+07
   14   0 +      -2.651092830379  -1.64e-11   5.70e-05    4    20   5.10e-02  2.55e-03
   14   1 +      -2.427643183354  -1.13e-08   4.12e-05    4    20   5.10e-02  2.55e-03
TIMING for Davidson : 5.10e-02  T(cal/comm/rest)=5.02e-02,1.19e-06,7.75e-04
optimized energies: isweep=0 dots=2 ibond=1 e[0]=-2.65109283038
optimized energies: isweep=0 dots=2 ibond=1 e[1]=-2.42764318335
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond1.txt
 qbond: qsuper nsym=12 dimAll=40
 (4,0):8 (3,1):8 (2,0):5 (3,-1):5 (5,1):3 (4,2):3 (2,2):2 (5,-1):2 (1,1):1 (4,-2):1 (6,0):1 (3,3):1
decimation summary: 40->10 dwt=+9.637e-03 SvN=1.843e+00
===== CPUmem(GB): tot=1.288e-05 (comb,oper,dvdson,hvec,renorm)=4.180e-06,8.702e-06,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=10,10 size(op)=26:1.984e-04MB size(tot)=775:5.913e-03MB:5.774e-06GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=6.527e-06 (oper)(GB)=6.527e-06
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.275e-05 (oper,qops,site)(GB)=6.527e-06,5.774e-06,4.470e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.022e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 2.256e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.34e-05 (oper,qops,site,rinter)(GB)=6.53e-06,5.77e-06,4.47e-07,6.85e-07
----- TIMING FOR preprocess_formulae_Rlist : 0.000373 S size(rtasks)=63 size(Rlst)=777 T(Rmu/Rxlist/sort)=7.78e-05,0.00016,0.000136 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000204 (oper,qops,site,rinter,batch)(GB)=6.53e-06,5.77e-06,4.47e-07,6.85e-07,0.000191
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000187,0.00108,0.000196 cost=4.06e+04 flops[gemm]=3.76e+07
--- TIMING FOR renorm : t_inter=0.000187 t_gemm=0.00108 t_reduction=0.000196 tot=0.00146 ---
 renorm counter=2 i=0 t=0.000216 per=20 cost=2.63e+03 flops=1.22e+07
 renorm counter=2 i=1 t=0.00021 per=19.4 cost=2.79e+03 flops=1.33e+07
 renorm counter=2 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=2 i=3 t=1e-06 per=0.0926 cost=0 flops=0
 renorm counter=2 i=4 t=0.000208 per=19.3 cost=4.43e+03 flops=2.13e+07
 renorm counter=2 i=5 t=0.000215 per=19.9 cost=8.63e+03 flops=4.01e+07
 renorm counter=2 i=6 t=0.00023 per=21.3 cost=2.21e+04 flops=9.63e+07
 total GEMM cost=4.06e+04 flops=3.76e+07
--- TIMING FOR renorm_tot : t_inter=0.000194 t_gemm=0.00221 t_reduction=0.000391 tot=0.0028 ---
 renorm_tot counter=2 i=0 t=0.000438 per=19.8 cost=3.96e+03 flops=9.05e+06
 renorm_tot counter=2 i=1 t=0.000442 per=20 cost=4.69e+03 flops=1.06e+07
 renorm_tot counter=2 i=2 t=0 per=0 cost=0 flops=-nan
 renorm_tot counter=2 i=3 t=2e-06 per=0.0905 cost=0 flops=0
 renorm_tot counter=2 i=4 t=0.000423 per=19.1 cost=5.71e+03 flops=1.35e+07
 renorm_tot counter=2 i=5 t=0.000429 per=19.4 cost=1.06e+04 flops=2.47e+07
 renorm_tot counter=2 i=6 t=0.000477 per=21.6 cost=3.44e+04 flops=7.21e+07
 total GEMM cost=5.93e+04 flops=2.68e+07
check ||H-H.dagger||=8.01e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0027 S T(init/kernel/comm)=0.0002,0.0025,9.5e-06 rank=0 -----
===== CPUmem(GB): tot=1.3e-05 (comb,oper,dvdson,hvec,renorm)=4.2e-06,8.7e-06,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=130:0.00099MB:9.7e-07GB
 rwfuns: len=4 mem=16:0.00012MB:1.2e-07GB
 cpsi: len=2 mem=48:0.00037MB:3.6e-07GB
total mem of comb=221:0.0017MB:1.6e-06GB
===== CPUmem(GB): tot=1.6e-05 (comb,oper,dvdson,hvec,renorm)=1.6e-06,1.4e-05,0,0,0 =====
fname=./scratch/sweep/lop(2,0) size=5.77e-06GB T[save](info/data/tot)=5.22e-05,4.57e-05,9.79e-05 speed=0.059GB/s disk[used]=5.85e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
##### time_local: 5.96e-02 S #####
 T(fetch) = 3.51e-04 S  per = 0.59  per(accum) = 0.59
 T(hdiag) = 7.87e-05 S  per = 0.13  per(accum) = 0.72
 T(dvdsn) = 5.54e-02 S  per =   93  per(accum) = 94
 T(decim) = 3.88e-04 S  per = 0.65  per(accum) = 94
 T(guess) = 8.40e-05 S  per = 0.14  per(accum) = 94
 T(renrm) = 2.76e-03 S  per =  4.6  per(accum) = 99
 T(save ) = 5.73e-04 S  per = 0.96  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 5.51e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.26e-05 S  per = 0.077  per(accum) = 0.077
 T(symbolic_formulae_twodot     ) = 2.92e-04 S  per = 0.53  per(accum) = 0.61
 T(hintermediate init           ) = 3.59e-05 S  per = 0.065  per(accum) = 0.67
 T(hintermediates memcpy cpu2gpu) = 6.56e-06 S  per = 0.012  per(accum) = 0.68
 T(preprocess_hformulae_Hxlist2 ) = 2.28e-03 S  per =  4.1  per(accum) = 4.8
 T(hmmtasks init                ) = 1.45e-03 S  per =  2.6  per(accum) = 7.4
 T(dvdson solver [Hx_batchGPU]  ) = 5.02e-02 S  per =   91  per(accum) = 99
 T(dvdson solver [communication]) = 1.19e-06 S  per = 0.0022  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.75e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.71e-03 S
 T(qops init                    ) = 1.98e-04 S  per =  7.3  per(accum) = 7.3
 T(qops_dict memcpy cpu2gpu     ) = 3.74e-05 S  per =  1.4  per(accum) = 8.7
 T(symbolic_formulae_renorm     ) = 2.08e-04 S  per =  7.7  per(accum) = 16
 T(rintermediate init           ) = 2.62e-05 S  per = 0.97  per(accum) = 17
 T(rintermediates memcpy cpu2gpu) = 5.61e-06 S  per = 0.21  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 3.83e-04 S  per =   14  per(accum) = 32
 T(rmmtasks init                ) = 2.51e-04 S  per =  9.3  per(accum) = 41
 T(qops memset                  ) = 9.56e-06 S  per = 0.35  per(accum) = 41
 T(preprocess_renorm_batchGPU   ) = 1.55e-03 S  per =   57  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.78e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 9.54e-06 S  per = 0.35  per(accum) = 1e+02
##### time_sweep: 7.53e-02 S #####
 T(fetch) = 8.87e-04 S  per =  1.2  per(accum) = 1.2
 T(hdiag) = 1.91e-04 S  per = 0.25  per(accum) = 1.4
 T(dvdsn) = 6.64e-02 S  per =   88  per(accum) = 90
 T(decim) = 7.62e-04 S  per =    1  per(accum) = 91
 T(guess) = 2.02e-04 S  per = 0.27  per(accum) = 91
 T(renrm) = 5.64e-03 S  per =  7.5  per(accum) = 98
 T(save ) = 1.17e-03 S  per =  1.6  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 6.58e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 8.60e-05 S  per = 0.13  per(accum) = 0.13
 T(symbolic_formulae_twodot     ) = 6.09e-04 S  per = 0.92  per(accum) = 1.1
 T(hintermediate init           ) = 6.88e-05 S  per =  0.1  per(accum) = 1.2
 T(hintermediates memcpy cpu2gpu) = 1.13e-05 S  per = 0.017  per(accum) = 1.2
 T(preprocess_hformulae_Hxlist2 ) = 5.21e-03 S  per =  7.9  per(accum) = 9.1
 T(hmmtasks init                ) = 3.47e-03 S  per =  5.3  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 5.55e-02 S  per =   84  per(accum) = 99
 T(dvdson solver [communication]) = 1.40e-06 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 8.59e-04 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.54e-03 S
 T(qops init                    ) = 4.02e-04 S  per =  7.3  per(accum) = 7.3
 T(qops_dict memcpy cpu2gpu     ) = 7.78e-05 S  per =  1.4  per(accum) = 8.7
 T(symbolic_formulae_renorm     ) = 4.56e-04 S  per =  8.2  per(accum) = 17
 T(rintermediate init           ) = 3.81e-05 S  per = 0.69  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 1.13e-05 S  per =  0.2  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 8.86e-04 S  per =   16  per(accum) = 34
 T(rmmtasks init                ) = 5.99e-04 S  per =   11  per(accum) = 45
 T(qops memset                  ) = 1.93e-05 S  per = 0.35  per(accum) = 45
 T(preprocess_renorm_batchGPU   ) = 2.97e-03 S  per =   54  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.89e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.93e-05 S  per = 0.35  per(accum) = 1e+02
##### time_global: 7.53e-02 S #####
 T(fetch) = 8.87e-04 S  per =  1.2  per(accum) = 1.2
 T(hdiag) = 1.91e-04 S  per = 0.25  per(accum) = 1.4
 T(dvdsn) = 6.64e-02 S  per =   88  per(accum) = 90
 T(decim) = 7.62e-04 S  per =    1  per(accum) = 91
 T(guess) = 2.02e-04 S  per = 0.27  per(accum) = 91
 T(renrm) = 5.64e-03 S  per =  7.5  per(accum) = 98
 T(save ) = 1.17e-03 S  per =  1.6  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 6.58e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 8.60e-05 S  per = 0.13  per(accum) = 0.13
 T(symbolic_formulae_twodot     ) = 6.09e-04 S  per = 0.92  per(accum) = 1.1
 T(hintermediate init           ) = 6.88e-05 S  per =  0.1  per(accum) = 1.2
 T(hintermediates memcpy cpu2gpu) = 1.13e-05 S  per = 0.017  per(accum) = 1.2
 T(preprocess_hformulae_Hxlist2 ) = 5.21e-03 S  per =  7.9  per(accum) = 9.1
 T(hmmtasks init                ) = 3.47e-03 S  per =  5.3  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 5.55e-02 S  per =   84  per(accum) = 99
 T(dvdson solver [communication]) = 1.40e-06 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 8.59e-04 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.54e-03 S
 T(qops init                    ) = 4.02e-04 S  per =  7.3  per(accum) = 7.3
 T(qops_dict memcpy cpu2gpu     ) = 7.78e-05 S  per =  1.4  per(accum) = 8.7
 T(symbolic_formulae_renorm     ) = 4.56e-04 S  per =  8.2  per(accum) = 17
 T(rintermediate init           ) = 3.81e-05 S  per = 0.69  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 1.13e-05 S  per =  0.2  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 8.86e-04 S  per =   16  per(accum) = 34
 T(rmmtasks init                ) = 5.99e-04 S  per =   11  per(accum) = 45
 T(qops memset                  ) = 1.93e-05 S  per = 0.35  per(accum) = 45
 T(preprocess_renorm_batchGPU   ) = 2.97e-03 S  per =   54  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.89e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.93e-05 S  per = 0.35  per(accum) = 1e+02

isweep=0 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.374e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=730:0.00557MB:5.44e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1168:0.00891MB:8.7e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=130:0.000992MB:9.69e-07GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 cpsi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=221:0.00169MB:1.65e-06GB
===== CPUmem(GB): tot=1.61e-05 (comb,oper,dvdson,hvec,renorm)=1.65e-06,1.45e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(10,4,4,4) nnz=78:0.000595MB
stensor4: wf own=1 _data=0x4492ffc0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=6 dimAll=10
 (2,0):4 (3,1):2 (1,1):1 (3,-1):1 (4,0):1 (2,2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=42 nblocks=384 size=78:0.000595MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=8.7e-06 (oper)(GB)=8.7e-06
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.830e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 2.286e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=9.39e-06 (oper,hinter)(GB)=8.7e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00228 S size(H_formulae)=188 size(Hxlst)=4522 T(Hmu/Hxlist/sort)=6.56e-05,0.00106,0.00115 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000583 (oper,hinter,dvdson,batch)(GB)=8.7e-06,6.85e-07,1.16e-06,0.000573
===== CPUmem(GB): tot=2.77e-05 (comb,oper,dvdson,hvec,renorm)=1.65e-06,1.45e-05,1.16e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=78 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.8e-05,0.000207,0.00198,0.000198 cost=5.42e+04 flops[gemm]=2.74e+07
--- TIMING FOR sigma : t_inter=0.000207 t_gemm=0.00198 t_reduction=0.000198 tot=0.00238 ---
 sigma counter=23 i=0 t=0.000258 per=13 cost=5.06e+03 flops=1.96e+07
 sigma counter=23 i=1 t=0.000254 per=12.8 cost=5.01e+03 flops=1.97e+07
 sigma counter=23 i=2 t=0.000239 per=12.1 cost=5.18e+03 flops=2.17e+07
 sigma counter=23 i=3 t=0.000241 per=12.2 cost=5.15e+03 flops=2.14e+07
 sigma counter=23 i=4 t=0.000245 per=12.4 cost=5.06e+03 flops=2.06e+07
 sigma counter=23 i=5 t=0.000242 per=12.2 cost=5.01e+03 flops=2.07e+07
 sigma counter=23 i=6 t=0.000255 per=12.9 cost=1.18e+04 flops=4.65e+07
 sigma counter=23 i=7 t=0.000245 per=12.4 cost=1.18e+04 flops=4.84e+07
 total GEMM cost=5.42e+04 flops=2.74e+07
--- TIMING FOR sigma_tot : t_inter=0.00474 t_gemm=0.0457 t_reduction=0.00455 tot=0.055 ---
 sigma_tot counter=23 i=0 t=0.00572 per=12.5 cost=1.2e+05 flops=2.1e+07
 sigma_tot counter=23 i=1 t=0.00589 per=12.9 cost=1.19e+05 flops=2.02e+07
 sigma_tot counter=23 i=2 t=0.00555 per=12.1 cost=1.22e+05 flops=2.2e+07
 sigma_tot counter=23 i=3 t=0.00563 per=12.3 cost=1.22e+05 flops=2.16e+07
 sigma_tot counter=23 i=4 t=0.00554 per=12.1 cost=1.44e+05 flops=2.6e+07
 sigma_tot counter=23 i=5 t=0.00566 per=12.4 cost=1.43e+05 flops=2.53e+07
 sigma_tot counter=23 i=6 t=0.00603 per=13.2 cost=2.62e+05 flops=4.35e+07
 sigma_tot counter=23 i=7 t=0.0057 per=12.5 cost=2.62e+05 flops=4.6e+07
 total GEMM cost=1.3e+06 flops=2.83e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.9e-05,0.000204,0.00196,0.000194 cost=5.42e+04 flops[gemm]=2.76e+07
--- TIMING FOR sigma : t_inter=0.000204 t_gemm=0.00196 t_reduction=0.000194 tot=0.00236 ---
 sigma counter=24 i=0 t=0.000241 per=12.3 cost=5.06e+03 flops=2.1e+07
 sigma counter=24 i=1 t=0.00025 per=12.8 cost=5.01e+03 flops=2e+07
 sigma counter=24 i=2 t=0.000238 per=12.1 cost=5.18e+03 flops=2.17e+07
 sigma counter=24 i=3 t=0.00024 per=12.2 cost=5.15e+03 flops=2.14e+07
 sigma counter=24 i=4 t=0.000237 per=12.1 cost=5.06e+03 flops=2.13e+07
 sigma counter=24 i=5 t=0.00024 per=12.2 cost=5.01e+03 flops=2.09e+07
 sigma counter=24 i=6 t=0.00027 per=13.8 cost=1.18e+04 flops=4.39e+07
 sigma counter=24 i=7 t=0.000244 per=12.4 cost=1.18e+04 flops=4.86e+07
 total GEMM cost=5.42e+04 flops=2.76e+07
--- TIMING FOR sigma_tot : t_inter=0.00495 t_gemm=0.0477 t_reduction=0.00475 tot=0.0574 ---
 sigma_tot counter=24 i=0 t=0.00596 per=12.5 cost=1.25e+05 flops=2.1e+07
 sigma_tot counter=24 i=1 t=0.00614 per=12.9 cost=1.24e+05 flops=2.02e+07
 sigma_tot counter=24 i=2 t=0.00579 per=12.1 cost=1.28e+05 flops=2.2e+07
 sigma_tot counter=24 i=3 t=0.00587 per=12.3 cost=1.27e+05 flops=2.16e+07
 sigma_tot counter=24 i=4 t=0.00577 per=12.1 cost=1.49e+05 flops=2.58e+07
 sigma_tot counter=24 i=5 t=0.0059 per=12.4 cost=1.48e+05 flops=2.51e+07
 sigma_tot counter=24 i=6 t=0.0063 per=13.2 cost=2.74e+05 flops=4.36e+07
 sigma_tot counter=24 i=7 t=0.00595 per=12.5 cost=2.74e+05 flops=4.61e+07
 total GEMM cost=1.35e+06 flops=2.83e+07
settings: ndim=78 neig=2 maxcycle=30 nbuff=4 memory=1.05e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.640915766574  -1.00e+03   1.43e-01    2     2   5.04e-03  2.52e-03
    1   1 -      -2.405171106796  -1.00e+03   1.99e-01    2     2   5.04e-03  2.52e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,2.13e-04,1.98e-03,2.05e-04 cost=5.42e+04 flops[gemm]=2.74e+07
--- TIMING FOR sigma : t_inter=2.12e-04 t_gemm=1.98e-03 t_reduction=2.05e-04 tot=2.40e-03 ---
 sigma counter=25 i=0 t=2.57e-04 per=1.30e+01 cost=5.06e+03 flops=1.97e+07
 sigma counter=25 i=1 t=2.58e-04 per=1.30e+01 cost=5.01e+03 flops=1.94e+07
 sigma counter=25 i=2 t=2.39e-04 per=1.21e+01 cost=5.18e+03 flops=2.17e+07
 sigma counter=25 i=3 t=2.40e-04 per=1.21e+01 cost=5.15e+03 flops=2.14e+07
 sigma counter=25 i=4 t=2.42e-04 per=1.22e+01 cost=5.06e+03 flops=2.09e+07
 sigma counter=25 i=5 t=2.41e-04 per=1.22e+01 cost=5.01e+03 flops=2.08e+07
 sigma counter=25 i=6 t=2.58e-04 per=1.30e+01 cost=1.18e+04 flops=4.59e+07
 sigma counter=25 i=7 t=2.45e-04 per=1.24e+01 cost=1.18e+04 flops=4.84e+07
 total GEMM cost=5.42e+04 flops=2.74e+07
--- TIMING FOR sigma_tot : t_inter=5.16e-03 t_gemm=4.97e-02 t_reduction=4.95e-03 tot=5.98e-02 ---
 sigma_tot counter=25 i=0 t=6.22e-03 per=1.25e+01 cost=1.30e+05 flops=2.09e+07
 sigma_tot counter=25 i=1 t=6.40e-03 per=1.29e+01 cost=1.29e+05 flops=2.02e+07
 sigma_tot counter=25 i=2 t=6.03e-03 per=1.21e+01 cost=1.33e+05 flops=2.20e+07
 sigma_tot counter=25 i=3 t=6.11e-03 per=1.23e+01 cost=1.32e+05 flops=2.16e+07
 sigma_tot counter=25 i=4 t=6.02e-03 per=1.21e+01 cost=1.54e+05 flops=2.56e+07
 sigma_tot counter=25 i=5 t=6.14e-03 per=1.24e+01 cost=1.53e+05 flops=2.49e+07
 sigma_tot counter=25 i=6 t=6.55e-03 per=1.32e+01 cost=2.86e+05 flops=4.37e+07
 sigma_tot counter=25 i=7 t=6.19e-03 per=1.25e+01 cost=2.86e+05 flops=4.62e+07
 total GEMM cost=1.40e+06 flops=2.83e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.03e-04,1.96e-03,1.96e-04 cost=5.42e+04 flops[gemm]=2.76e+07
--- TIMING FOR sigma : t_inter=2.03e-04 t_gemm=1.96e-03 t_reduction=1.96e-04 tot=2.36e-03 ---
 sigma counter=26 i=0 t=2.37e-04 per=1.21e+01 cost=5.06e+03 flops=2.13e+07
 sigma counter=26 i=1 t=2.47e-04 per=1.26e+01 cost=5.01e+03 flops=2.03e+07
 sigma counter=26 i=2 t=2.48e-04 per=1.27e+01 cost=5.18e+03 flops=2.09e+07
 sigma counter=26 i=3 t=2.42e-04 per=1.24e+01 cost=5.15e+03 flops=2.13e+07
 sigma counter=26 i=4 t=2.35e-04 per=1.20e+01 cost=5.06e+03 flops=2.15e+07
 sigma counter=26 i=5 t=2.40e-04 per=1.23e+01 cost=5.01e+03 flops=2.09e+07
 sigma counter=26 i=6 t=2.63e-04 per=1.34e+01 cost=1.18e+04 flops=4.50e+07
 sigma counter=26 i=7 t=2.46e-04 per=1.26e+01 cost=1.18e+04 flops=4.82e+07
 total GEMM cost=5.42e+04 flops=2.77e+07
--- TIMING FOR sigma_tot : t_inter=5.36e-03 t_gemm=5.16e-02 t_reduction=5.15e-03 tot=6.21e-02 ---
 sigma_tot counter=26 i=0 t=6.46e-03 per=1.25e+01 cost=1.35e+05 flops=2.10e+07
 sigma_tot counter=26 i=1 t=6.65e-03 per=1.29e+01 cost=1.34e+05 flops=2.02e+07
 sigma_tot counter=26 i=2 t=6.28e-03 per=1.22e+01 cost=1.38e+05 flops=2.20e+07
 sigma_tot counter=26 i=3 t=6.35e-03 per=1.23e+01 cost=1.37e+05 flops=2.16e+07
 sigma_tot counter=26 i=4 t=6.25e-03 per=1.21e+01 cost=1.59e+05 flops=2.55e+07
 sigma_tot counter=26 i=5 t=6.38e-03 per=1.24e+01 cost=1.58e+05 flops=2.48e+07
 sigma_tot counter=26 i=6 t=6.82e-03 per=1.32e+01 cost=2.98e+05 flops=4.37e+07
 sigma_tot counter=26 i=7 t=6.44e-03 per=1.25e+01 cost=2.98e+05 flops=4.63e+07
 total GEMM cost=1.46e+06 flops=2.82e+07
    2   0 -      -2.650499349704  -9.58e-03   3.19e-02    4     4   1.01e-02  2.53e-03
    2   1 -      -2.425166040136  -2.00e-02   5.86e-02    4     4   1.01e-02  2.53e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.10e-05,2.03e-04,1.99e-03,1.99e-04 cost=5.42e+04 flops[gemm]=2.72e+07
--- TIMING FOR sigma : t_inter=2.02e-04 t_gemm=1.99e-03 t_reduction=1.99e-04 tot=2.39e-03 ---
 sigma counter=27 i=0 t=2.47e-04 per=1.24e+01 cost=5.06e+03 flops=2.05e+07
 sigma counter=27 i=1 t=2.61e-04 per=1.31e+01 cost=5.01e+03 flops=1.92e+07
 sigma counter=27 i=2 t=2.39e-04 per=1.20e+01 cost=5.18e+03 flops=2.17e+07
 sigma counter=27 i=3 t=2.51e-04 per=1.26e+01 cost=5.15e+03 flops=2.05e+07
 sigma counter=27 i=4 t=2.36e-04 per=1.19e+01 cost=5.06e+03 flops=2.14e+07
 sigma counter=27 i=5 t=2.39e-04 per=1.20e+01 cost=5.01e+03 flops=2.10e+07
 sigma counter=27 i=6 t=2.57e-04 per=1.29e+01 cost=1.18e+04 flops=4.61e+07
 sigma counter=27 i=7 t=2.57e-04 per=1.29e+01 cost=1.18e+04 flops=4.61e+07
 total GEMM cost=5.42e+04 flops=2.73e+07
--- TIMING FOR sigma_tot : t_inter=5.57e-03 t_gemm=5.36e-02 t_reduction=5.35e-03 tot=6.45e-02 ---
 sigma_tot counter=27 i=0 t=6.70e-03 per=1.25e+01 cost=1.40e+05 flops=2.09e+07
 sigma_tot counter=27 i=1 t=6.91e-03 per=1.29e+01 cost=1.39e+05 flops=2.02e+07
 sigma_tot counter=27 i=2 t=6.52e-03 per=1.22e+01 cost=1.43e+05 flops=2.19e+07
 sigma_tot counter=27 i=3 t=6.60e-03 per=1.23e+01 cost=1.42e+05 flops=2.16e+07
 sigma_tot counter=27 i=4 t=6.49e-03 per=1.21e+01 cost=1.64e+05 flops=2.53e+07
 sigma_tot counter=27 i=5 t=6.62e-03 per=1.23e+01 cost=1.63e+05 flops=2.46e+07
 sigma_tot counter=27 i=6 t=7.07e-03 per=1.32e+01 cost=3.10e+05 flops=4.38e+07
 sigma_tot counter=27 i=7 t=6.69e-03 per=1.25e+01 cost=3.10e+05 flops=4.63e+07
 total GEMM cost=1.51e+06 flops=2.82e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.02e-04,1.96e-03,1.94e-04 cost=5.42e+04 flops[gemm]=2.77e+07
--- TIMING FOR sigma : t_inter=2.02e-04 t_gemm=1.96e-03 t_reduction=1.94e-04 tot=2.35e-03 ---
 sigma counter=28 i=0 t=2.40e-04 per=1.23e+01 cost=5.06e+03 flops=2.11e+07
 sigma counter=28 i=1 t=2.53e-04 per=1.29e+01 cost=5.01e+03 flops=1.98e+07
 sigma counter=28 i=2 t=2.38e-04 per=1.22e+01 cost=5.18e+03 flops=2.17e+07
 sigma counter=28 i=3 t=2.42e-04 per=1.24e+01 cost=5.15e+03 flops=2.13e+07
 sigma counter=28 i=4 t=2.35e-04 per=1.20e+01 cost=5.06e+03 flops=2.15e+07
 sigma counter=28 i=5 t=2.44e-04 per=1.25e+01 cost=5.01e+03 flops=2.05e+07
 sigma counter=28 i=6 t=2.58e-04 per=1.32e+01 cost=1.18e+04 flops=4.59e+07
 sigma counter=28 i=7 t=2.46e-04 per=1.26e+01 cost=1.18e+04 flops=4.82e+07
 total GEMM cost=5.42e+04 flops=2.77e+07
--- TIMING FOR sigma_tot : t_inter=5.77e-03 t_gemm=5.56e-02 t_reduction=5.54e-03 tot=6.69e-02 ---
 sigma_tot counter=28 i=0 t=6.94e-03 per=1.25e+01 cost=1.45e+05 flops=2.09e+07
 sigma_tot counter=28 i=1 t=7.16e-03 per=1.29e+01 cost=1.44e+05 flops=2.01e+07
 sigma_tot counter=28 i=2 t=6.76e-03 per=1.22e+01 cost=1.48e+05 flops=2.19e+07
 sigma_tot counter=28 i=3 t=6.84e-03 per=1.23e+01 cost=1.47e+05 flops=2.15e+07
 sigma_tot counter=28 i=4 t=6.72e-03 per=1.21e+01 cost=1.69e+05 flops=2.52e+07
 sigma_tot counter=28 i=5 t=6.86e-03 per=1.24e+01 cost=1.68e+05 flops=2.45e+07
 sigma_tot counter=28 i=6 t=7.33e-03 per=1.32e+01 cost=3.22e+05 flops=4.39e+07
 sigma_tot counter=28 i=7 t=6.94e-03 per=1.25e+01 cost=3.22e+05 flops=4.63e+07
 total GEMM cost=1.57e+06 flops=2.82e+07
    3   0 -      -2.651051792159  -5.52e-04   6.68e-03    6     6   1.52e-02  2.53e-03
    3   1 -      -2.427538409660  -2.37e-03   1.15e-02    6     6   1.52e-02  2.53e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,2.07e-04,2.04e-03,1.97e-04 cost=5.42e+04 flops[gemm]=2.65e+07
--- TIMING FOR sigma : t_inter=2.07e-04 t_gemm=2.04e-03 t_reduction=1.97e-04 tot=2.45e-03 ---
 sigma counter=29 i=0 t=2.49e-04 per=1.22e+01 cost=5.06e+03 flops=2.03e+07
 sigma counter=29 i=1 t=2.51e-04 per=1.23e+01 cost=5.01e+03 flops=2.00e+07
 sigma counter=29 i=2 t=2.47e-04 per=1.21e+01 cost=5.18e+03 flops=2.10e+07
 sigma counter=29 i=3 t=2.64e-04 per=1.29e+01 cost=5.15e+03 flops=1.95e+07
 sigma counter=29 i=4 t=2.47e-04 per=1.21e+01 cost=5.06e+03 flops=2.05e+07
 sigma counter=29 i=5 t=2.52e-04 per=1.23e+01 cost=5.01e+03 flops=1.99e+07
 sigma counter=29 i=6 t=2.67e-04 per=1.31e+01 cost=1.18e+04 flops=4.44e+07
 sigma counter=29 i=7 t=2.67e-04 per=1.31e+01 cost=1.18e+04 flops=4.44e+07
 total GEMM cost=5.42e+04 flops=2.65e+07
--- TIMING FOR sigma_tot : t_inter=5.97e-03 t_gemm=5.76e-02 t_reduction=5.74e-03 tot=6.93e-02 ---
 sigma_tot counter=29 i=0 t=7.19e-03 per=1.25e+01 cost=1.51e+05 flops=2.09e+07
 sigma_tot counter=29 i=1 t=7.41e-03 per=1.29e+01 cost=1.49e+05 flops=2.01e+07
 sigma_tot counter=29 i=2 t=7.00e-03 per=1.22e+01 cost=1.53e+05 flops=2.19e+07
 sigma_tot counter=29 i=3 t=7.11e-03 per=1.23e+01 cost=1.53e+05 flops=2.15e+07
 sigma_tot counter=29 i=4 t=6.97e-03 per=1.21e+01 cost=1.74e+05 flops=2.50e+07
 sigma_tot counter=29 i=5 t=7.11e-03 per=1.24e+01 cost=1.73e+05 flops=2.43e+07
 sigma_tot counter=29 i=6 t=7.60e-03 per=1.32e+01 cost=3.33e+05 flops=4.39e+07
 sigma_tot counter=29 i=7 t=7.21e-03 per=1.25e+01 cost=3.34e+05 flops=4.63e+07
 total GEMM cost=1.62e+06 flops=2.81e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.10e-05,2.01e-04,1.95e-03,1.96e-04 cost=5.42e+04 flops[gemm]=2.77e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.95e-03 t_reduction=1.96e-04 tot=2.35e-03 ---
 sigma counter=30 i=0 t=2.40e-04 per=1.23e+01 cost=5.06e+03 flops=2.11e+07
 sigma counter=30 i=1 t=2.53e-04 per=1.30e+01 cost=5.01e+03 flops=1.98e+07
 sigma counter=30 i=2 t=2.37e-04 per=1.21e+01 cost=5.18e+03 flops=2.18e+07
 sigma counter=30 i=3 t=2.44e-04 per=1.25e+01 cost=5.15e+03 flops=2.11e+07
 sigma counter=30 i=4 t=2.36e-04 per=1.21e+01 cost=5.06e+03 flops=2.14e+07
 sigma counter=30 i=5 t=2.39e-04 per=1.22e+01 cost=5.01e+03 flops=2.10e+07
 sigma counter=30 i=6 t=2.58e-04 per=1.32e+01 cost=1.18e+04 flops=4.59e+07
 sigma counter=30 i=7 t=2.46e-04 per=1.26e+01 cost=1.18e+04 flops=4.82e+07
 total GEMM cost=5.42e+04 flops=2.77e+07
--- TIMING FOR sigma_tot : t_inter=6.18e-03 t_gemm=5.96e-02 t_reduction=5.94e-03 tot=7.17e-02 ---
 sigma_tot counter=30 i=0 t=7.43e-03 per=1.25e+01 cost=1.56e+05 flops=2.09e+07
 sigma_tot counter=30 i=1 t=7.66e-03 per=1.29e+01 cost=1.54e+05 flops=2.01e+07
 sigma_tot counter=30 i=2 t=7.24e-03 per=1.22e+01 cost=1.59e+05 flops=2.19e+07
 sigma_tot counter=30 i=3 t=7.35e-03 per=1.23e+01 cost=1.58e+05 flops=2.15e+07
 sigma_tot counter=30 i=4 t=7.21e-03 per=1.21e+01 cost=1.79e+05 flops=2.49e+07
 sigma_tot counter=30 i=5 t=7.35e-03 per=1.23e+01 cost=1.78e+05 flops=2.42e+07
 sigma_tot counter=30 i=6 t=7.86e-03 per=1.32e+01 cost=3.45e+05 flops=4.40e+07
 sigma_tot counter=30 i=7 t=7.45e-03 per=1.25e+01 cost=3.45e+05 flops=4.63e+07
 total GEMM cost=1.67e+06 flops=2.81e+07
    4   0 -      -2.651086709263  -3.49e-05   2.38e-03    6     8   2.03e-02  2.53e-03
    4   1 -      -2.427625986194  -8.76e-05   4.41e-03    6     8   2.03e-02  2.53e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.30e-05,2.06e-04,1.98e-03,2.02e-04 cost=5.42e+04 flops[gemm]=2.73e+07
--- TIMING FOR sigma : t_inter=2.06e-04 t_gemm=1.98e-03 t_reduction=2.02e-04 tot=2.39e-03 ---
 sigma counter=31 i=0 t=2.51e-04 per=1.27e+01 cost=5.06e+03 flops=2.01e+07
 sigma counter=31 i=1 t=2.60e-04 per=1.31e+01 cost=5.01e+03 flops=1.93e+07
 sigma counter=31 i=2 t=2.37e-04 per=1.19e+01 cost=5.18e+03 flops=2.18e+07
 sigma counter=31 i=3 t=2.45e-04 per=1.23e+01 cost=5.15e+03 flops=2.10e+07
 sigma counter=31 i=4 t=2.37e-04 per=1.19e+01 cost=5.06e+03 flops=2.13e+07
 sigma counter=31 i=5 t=2.42e-04 per=1.22e+01 cost=5.01e+03 flops=2.07e+07
 sigma counter=31 i=6 t=2.57e-04 per=1.30e+01 cost=1.18e+04 flops=4.61e+07
 sigma counter=31 i=7 t=2.55e-04 per=1.29e+01 cost=1.18e+04 flops=4.65e+07
 total GEMM cost=5.42e+04 flops=2.73e+07
--- TIMING FOR sigma_tot : t_inter=6.38e-03 t_gemm=6.15e-02 t_reduction=6.14e-03 tot=7.41e-02 ---
 sigma_tot counter=31 i=0 t=7.68e-03 per=1.25e+01 cost=1.61e+05 flops=2.09e+07
 sigma_tot counter=31 i=1 t=7.92e-03 per=1.29e+01 cost=1.59e+05 flops=2.01e+07
 sigma_tot counter=31 i=2 t=7.48e-03 per=1.21e+01 cost=1.64e+05 flops=2.19e+07
 sigma_tot counter=31 i=3 t=7.60e-03 per=1.23e+01 cost=1.63e+05 flops=2.14e+07
 sigma_tot counter=31 i=4 t=7.44e-03 per=1.21e+01 cost=1.84e+05 flops=2.48e+07
 sigma_tot counter=31 i=5 t=7.60e-03 per=1.23e+01 cost=1.83e+05 flops=2.41e+07
 sigma_tot counter=31 i=6 t=8.11e-03 per=1.32e+01 cost=3.57e+05 flops=4.40e+07
 sigma_tot counter=31 i=7 t=7.71e-03 per=1.25e+01 cost=3.57e+05 flops=4.63e+07
 total GEMM cost=1.73e+06 flops=2.81e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.06e-04,1.99e-03,1.96e-04 cost=5.42e+04 flops[gemm]=2.72e+07
--- TIMING FOR sigma : t_inter=2.06e-04 t_gemm=1.99e-03 t_reduction=1.96e-04 tot=2.39e-03 ---
 sigma counter=32 i=0 t=2.41e-04 per=1.21e+01 cost=5.06e+03 flops=2.10e+07
 sigma counter=32 i=1 t=2.68e-04 per=1.35e+01 cost=5.01e+03 flops=1.87e+07
 sigma counter=32 i=2 t=2.52e-04 per=1.27e+01 cost=5.18e+03 flops=2.05e+07
 sigma counter=32 i=3 t=2.42e-04 per=1.22e+01 cost=5.15e+03 flops=2.13e+07
 sigma counter=32 i=4 t=2.36e-04 per=1.19e+01 cost=5.06e+03 flops=2.14e+07
 sigma counter=32 i=5 t=2.47e-04 per=1.24e+01 cost=5.01e+03 flops=2.03e+07
 sigma counter=32 i=6 t=2.59e-04 per=1.30e+01 cost=1.18e+04 flops=4.57e+07
 sigma counter=32 i=7 t=2.45e-04 per=1.23e+01 cost=1.18e+04 flops=4.84e+07
 total GEMM cost=5.42e+04 flops=2.72e+07
--- TIMING FOR sigma_tot : t_inter=6.59e-03 t_gemm=6.35e-02 t_reduction=6.33e-03 tot=7.65e-02 ---
 sigma_tot counter=32 i=0 t=7.92e-03 per=1.25e+01 cost=1.66e+05 flops=2.09e+07
 sigma_tot counter=32 i=1 t=8.19e-03 per=1.29e+01 cost=1.64e+05 flops=2.01e+07
 sigma_tot counter=32 i=2 t=7.73e-03 per=1.22e+01 cost=1.69e+05 flops=2.19e+07
 sigma_tot counter=32 i=3 t=7.84e-03 per=1.23e+01 cost=1.68e+05 flops=2.14e+07
 sigma_tot counter=32 i=4 t=7.68e-03 per=1.21e+01 cost=1.89e+05 flops=2.47e+07
 sigma_tot counter=32 i=5 t=7.84e-03 per=1.23e+01 cost=1.88e+05 flops=2.40e+07
 sigma_tot counter=32 i=6 t=8.37e-03 per=1.32e+01 cost=3.69e+05 flops=4.41e+07
 sigma_tot counter=32 i=7 t=7.95e-03 per=1.25e+01 cost=3.69e+05 flops=4.64e+07
 total GEMM cost=1.78e+06 flops=2.81e+07
    5   0 -      -2.651091761462  -5.05e-06   1.21e-03    6    10   2.54e-02  2.54e-03
    5   1 -      -2.427640489990  -1.45e-05   1.74e-03    6    10   2.54e-02  2.54e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.20e-05,2.04e-04,2.04e-03,1.97e-04 cost=5.42e+04 flops[gemm]=2.65e+07
--- TIMING FOR sigma : t_inter=2.04e-04 t_gemm=2.04e-03 t_reduction=1.97e-04 tot=2.44e-03 ---
 sigma counter=33 i=0 t=2.48e-04 per=1.22e+01 cost=5.06e+03 flops=2.04e+07
 sigma counter=33 i=1 t=2.52e-04 per=1.24e+01 cost=5.01e+03 flops=1.99e+07
 sigma counter=33 i=2 t=2.59e-04 per=1.27e+01 cost=5.18e+03 flops=2.00e+07
 sigma counter=33 i=3 t=2.52e-04 per=1.24e+01 cost=5.15e+03 flops=2.04e+07
 sigma counter=33 i=4 t=2.46e-04 per=1.21e+01 cost=5.06e+03 flops=2.06e+07
 sigma counter=33 i=5 t=2.48e-04 per=1.22e+01 cost=5.01e+03 flops=2.02e+07
 sigma counter=33 i=6 t=2.73e-04 per=1.34e+01 cost=1.18e+04 flops=4.34e+07
 sigma counter=33 i=7 t=2.61e-04 per=1.28e+01 cost=1.18e+04 flops=4.54e+07
 total GEMM cost=5.42e+04 flops=2.66e+07
--- TIMING FOR sigma_tot : t_inter=6.79e-03 t_gemm=6.56e-02 t_reduction=6.53e-03 tot=7.89e-02 ---
 sigma_tot counter=33 i=0 t=8.17e-03 per=1.25e+01 cost=1.71e+05 flops=2.09e+07
 sigma_tot counter=33 i=1 t=8.44e-03 per=1.29e+01 cost=1.69e+05 flops=2.01e+07
 sigma_tot counter=33 i=2 t=7.99e-03 per=1.22e+01 cost=1.74e+05 flops=2.18e+07
 sigma_tot counter=33 i=3 t=8.09e-03 per=1.23e+01 cost=1.73e+05 flops=2.14e+07
 sigma_tot counter=33 i=4 t=7.92e-03 per=1.21e+01 cost=1.95e+05 flops=2.45e+07
 sigma_tot counter=33 i=5 t=8.09e-03 per=1.23e+01 cost=1.93e+05 flops=2.39e+07
 sigma_tot counter=33 i=6 t=8.65e-03 per=1.32e+01 cost=3.81e+05 flops=4.41e+07
 sigma_tot counter=33 i=7 t=8.22e-03 per=1.25e+01 cost=3.81e+05 flops=4.64e+07
 total GEMM cost=1.84e+06 flops=2.80e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.00e-04,1.96e-03,1.98e-04 cost=5.42e+04 flops[gemm]=2.77e+07
--- TIMING FOR sigma : t_inter=2.00e-04 t_gemm=1.96e-03 t_reduction=1.97e-04 tot=2.35e-03 ---
 sigma counter=34 i=0 t=2.40e-04 per=1.23e+01 cost=5.06e+03 flops=2.11e+07
 sigma counter=34 i=1 t=2.44e-04 per=1.25e+01 cost=5.01e+03 flops=2.05e+07
 sigma counter=34 i=2 t=2.38e-04 per=1.22e+01 cost=5.18e+03 flops=2.17e+07
 sigma counter=34 i=3 t=2.43e-04 per=1.24e+01 cost=5.15e+03 flops=2.12e+07
 sigma counter=34 i=4 t=2.46e-04 per=1.26e+01 cost=5.06e+03 flops=2.06e+07
 sigma counter=34 i=5 t=2.42e-04 per=1.24e+01 cost=5.01e+03 flops=2.07e+07
 sigma counter=34 i=6 t=2.60e-04 per=1.33e+01 cost=1.18e+04 flops=4.56e+07
 sigma counter=34 i=7 t=2.45e-04 per=1.25e+01 cost=1.18e+04 flops=4.84e+07
 total GEMM cost=5.42e+04 flops=2.77e+07
--- TIMING FOR sigma_tot : t_inter=6.99e-03 t_gemm=6.75e-02 t_reduction=6.73e-03 tot=8.12e-02 ---
 sigma_tot counter=34 i=0 t=8.41e-03 per=1.25e+01 cost=1.76e+05 flops=2.09e+07
 sigma_tot counter=34 i=1 t=8.69e-03 per=1.29e+01 cost=1.74e+05 flops=2.01e+07
 sigma_tot counter=34 i=2 t=8.23e-03 per=1.22e+01 cost=1.79e+05 flops=2.18e+07
 sigma_tot counter=34 i=3 t=8.33e-03 per=1.23e+01 cost=1.78e+05 flops=2.14e+07
 sigma_tot counter=34 i=4 t=8.17e-03 per=1.21e+01 cost=2.00e+05 flops=2.44e+07
 sigma_tot counter=34 i=5 t=8.33e-03 per=1.23e+01 cost=1.98e+05 flops=2.38e+07
 sigma_tot counter=34 i=6 t=8.91e-03 per=1.32e+01 cost=3.93e+05 flops=4.41e+07
 sigma_tot counter=34 i=7 t=8.46e-03 per=1.25e+01 cost=3.93e+05 flops=4.64e+07
 total GEMM cost=1.89e+06 flops=2.80e+07
    6   0 -      -2.651092751482  -9.90e-07   3.54e-04    6    12   3.05e-02  2.54e-03
    6   1 -      -2.427643024586  -2.53e-06   4.45e-04    6    12   3.05e-02  2.54e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,2.01e-04,2.02e-03,1.96e-04 cost=5.42e+04 flops[gemm]=2.68e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=2.02e-03 t_reduction=1.96e-04 tot=2.42e-03 ---
 sigma counter=35 i=0 t=2.47e-04 per=1.22e+01 cost=5.06e+03 flops=2.05e+07
 sigma counter=35 i=1 t=2.50e-04 per=1.24e+01 cost=5.01e+03 flops=2.00e+07
 sigma counter=35 i=2 t=2.55e-04 per=1.26e+01 cost=5.18e+03 flops=2.03e+07
 sigma counter=35 i=3 t=2.51e-04 per=1.24e+01 cost=5.15e+03 flops=2.05e+07
 sigma counter=35 i=4 t=2.45e-04 per=1.21e+01 cost=5.06e+03 flops=2.06e+07
 sigma counter=35 i=5 t=2.48e-04 per=1.23e+01 cost=5.01e+03 flops=2.02e+07
 sigma counter=35 i=6 t=2.70e-04 per=1.34e+01 cost=1.18e+04 flops=4.39e+07
 sigma counter=35 i=7 t=2.54e-04 per=1.26e+01 cost=1.18e+04 flops=4.66e+07
 total GEMM cost=5.42e+04 flops=2.68e+07
--- TIMING FOR sigma_tot : t_inter=7.19e-03 t_gemm=6.95e-02 t_reduction=6.92e-03 tot=8.37e-02 ---
 sigma_tot counter=35 i=0 t=8.66e-03 per=1.25e+01 cost=1.81e+05 flops=2.09e+07
 sigma_tot counter=35 i=1 t=8.94e-03 per=1.29e+01 cost=1.79e+05 flops=2.01e+07
 sigma_tot counter=35 i=2 t=8.48e-03 per=1.22e+01 cost=1.84e+05 flops=2.17e+07
 sigma_tot counter=35 i=3 t=8.58e-03 per=1.23e+01 cost=1.83e+05 flops=2.14e+07
 sigma_tot counter=35 i=4 t=8.42e-03 per=1.21e+01 cost=2.05e+05 flops=2.43e+07
 sigma_tot counter=35 i=5 t=8.58e-03 per=1.23e+01 cost=2.03e+05 flops=2.37e+07
 sigma_tot counter=35 i=6 t=9.18e-03 per=1.32e+01 cost=4.05e+05 flops=4.41e+07
 sigma_tot counter=35 i=7 t=8.71e-03 per=1.25e+01 cost=4.05e+05 flops=4.64e+07
 total GEMM cost=1.95e+06 flops=2.80e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.06e-04,1.99e-03,2.04e-04 cost=5.42e+04 flops[gemm]=2.72e+07
--- TIMING FOR sigma : t_inter=2.06e-04 t_gemm=1.99e-03 t_reduction=2.04e-04 tot=2.40e-03 ---
 sigma counter=36 i=0 t=2.52e-04 per=1.27e+01 cost=5.06e+03 flops=2.01e+07
 sigma counter=36 i=1 t=2.49e-04 per=1.25e+01 cost=5.01e+03 flops=2.01e+07
 sigma counter=36 i=2 t=2.53e-04 per=1.27e+01 cost=5.18e+03 flops=2.05e+07
 sigma counter=36 i=3 t=2.42e-04 per=1.22e+01 cost=5.15e+03 flops=2.13e+07
 sigma counter=36 i=4 t=2.46e-04 per=1.24e+01 cost=5.06e+03 flops=2.06e+07
 sigma counter=36 i=5 t=2.40e-04 per=1.21e+01 cost=5.01e+03 flops=2.09e+07
 sigma counter=36 i=6 t=2.58e-04 per=1.30e+01 cost=1.18e+04 flops=4.59e+07
 sigma counter=36 i=7 t=2.49e-04 per=1.25e+01 cost=1.18e+04 flops=4.76e+07
 total GEMM cost=5.42e+04 flops=2.72e+07
--- TIMING FOR sigma_tot : t_inter=7.40e-03 t_gemm=7.15e-02 t_reduction=7.13e-03 tot=8.61e-02 ---
 sigma_tot counter=36 i=0 t=8.91e-03 per=1.25e+01 cost=1.86e+05 flops=2.09e+07
 sigma_tot counter=36 i=1 t=9.19e-03 per=1.28e+01 cost=1.84e+05 flops=2.01e+07
 sigma_tot counter=36 i=2 t=8.73e-03 per=1.22e+01 cost=1.90e+05 flops=2.17e+07
 sigma_tot counter=36 i=3 t=8.82e-03 per=1.23e+01 cost=1.89e+05 flops=2.14e+07
 sigma_tot counter=36 i=4 t=8.66e-03 per=1.21e+01 cost=2.10e+05 flops=2.42e+07
 sigma_tot counter=36 i=5 t=8.82e-03 per=1.23e+01 cost=2.08e+05 flops=2.36e+07
 sigma_tot counter=36 i=6 t=9.43e-03 per=1.32e+01 cost=4.16e+05 flops=4.41e+07
 sigma_tot counter=36 i=7 t=8.96e-03 per=1.25e+01 cost=4.16e+05 flops=4.65e+07
 total GEMM cost=2.00e+06 flops=2.79e+07
    7   0 +      -2.651092827334  -7.59e-08   9.15e-05    6    14   3.56e-02  2.54e-03
    7   1 -      -2.427643167055  -1.42e-07   1.33e-04    6    14   3.56e-02  2.54e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.10e-05,2.00e-04,2.04e-03,1.99e-04 cost=5.42e+04 flops[gemm]=2.66e+07
--- TIMING FOR sigma : t_inter=2.00e-04 t_gemm=2.04e-03 t_reduction=1.99e-04 tot=2.44e-03 ---
 sigma counter=37 i=0 t=2.48e-04 per=1.22e+01 cost=5.06e+03 flops=2.04e+07
 sigma counter=37 i=1 t=2.57e-04 per=1.26e+01 cost=5.01e+03 flops=1.95e+07
 sigma counter=37 i=2 t=2.48e-04 per=1.22e+01 cost=5.18e+03 flops=2.09e+07
 sigma counter=37 i=3 t=2.49e-04 per=1.22e+01 cost=5.15e+03 flops=2.07e+07
 sigma counter=37 i=4 t=2.46e-04 per=1.21e+01 cost=5.06e+03 flops=2.06e+07
 sigma counter=37 i=5 t=2.53e-04 per=1.24e+01 cost=5.01e+03 flops=1.98e+07
 sigma counter=37 i=6 t=2.64e-04 per=1.30e+01 cost=1.18e+04 flops=4.49e+07
 sigma counter=37 i=7 t=2.71e-04 per=1.33e+01 cost=1.18e+04 flops=4.37e+07
 total GEMM cost=5.42e+04 flops=2.66e+07
--- TIMING FOR sigma_tot : t_inter=7.60e-03 t_gemm=7.36e-02 t_reduction=7.33e-03 tot=8.85e-02 ---
 sigma_tot counter=37 i=0 t=9.16e-03 per=1.25e+01 cost=1.91e+05 flops=2.08e+07
 sigma_tot counter=37 i=1 t=9.44e-03 per=1.28e+01 cost=1.89e+05 flops=2.01e+07
 sigma_tot counter=37 i=2 t=8.98e-03 per=1.22e+01 cost=1.95e+05 flops=2.17e+07
 sigma_tot counter=37 i=3 t=9.07e-03 per=1.23e+01 cost=1.94e+05 flops=2.14e+07
 sigma_tot counter=37 i=4 t=8.91e-03 per=1.21e+01 cost=2.15e+05 flops=2.41e+07
 sigma_tot counter=37 i=5 t=9.07e-03 per=1.23e+01 cost=2.13e+05 flops=2.35e+07
 sigma_tot counter=37 i=6 t=9.70e-03 per=1.32e+01 cost=4.28e+05 flops=4.42e+07
 sigma_tot counter=37 i=7 t=9.23e-03 per=1.26e+01 cost=4.28e+05 flops=4.64e+07
 total GEMM cost=2.05e+06 flops=2.79e+07
    8   0 +      -2.651092827334  -3.75e-13   9.15e-05    5    15   3.82e-02  2.55e-03
    8   1 +      -2.427643182575  -1.55e-08   5.44e-05    5    15   3.82e-02  2.55e-03
TIMING for Davidson : 3.82e-02  T(cal/comm/rest)=3.77e-02,1.13e-06,4.95e-04
optimized energies: isweep=0 dots=2 ibond=2 e[0]=-2.65109282733
optimized energies: isweep=0 dots=2 ibond=2 e[1]=-2.42764318258
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: 16->10 dwt=+1.379e-03 SvN=1.072e+00
===== CPUmem(GB): tot=1.612e-05 (comb,oper,dvdson,hvec,renorm)=1.647e-06,1.448e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:1.984e-04MB size(tot)=764:5.829e-03MB:5.692e-06GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=2.176e-06 (oper)(GB)=2.176e-06
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=8.062e-06 (oper,qops,site)(GB)=2.176e-06,5.692e-06,1.937e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.578e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=8.06e-06 (oper,qops,site,rinter)(GB)=2.18e-06,5.69e-06,1.94e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.00041 S size(rtasks)=63 size(Rlst)=784 T(Rmu/Rxlist/sort)=6.52e-05,0.000193,0.000151 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000201 (oper,qops,site,rinter,batch)(GB)=2.18e-06,5.69e-06,1.94e-07,0,0.000193
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7e-06,0.0011,0.000191 cost=1.92e+04 flops[gemm]=1.75e+07
--- TIMING FOR renorm : t_inter=7e-06 t_gemm=0.0011 t_reduction=0.000191 tot=0.00129 ---
 renorm counter=3 i=0 t=0.000217 per=19.8 cost=1.18e+03 flops=5.42e+06
 renorm counter=3 i=1 t=0.000232 per=21.1 cost=2.13e+03 flops=9.16e+06
 renorm counter=3 i=2 t=0.000209 per=19.1 cost=1.23e+03 flops=5.9e+06
 renorm counter=3 i=3 t=0.000212 per=19.3 cost=2.07e+03 flops=9.75e+06
 renorm counter=3 i=4 t=1e-06 per=0.0912 cost=0 flops=0
 renorm counter=3 i=5 t=1e-06 per=0.0912 cost=0 flops=0
 renorm counter=3 i=6 t=0.000225 per=20.5 cost=1.26e+04 flops=5.61e+07
 total GEMM cost=1.92e+04 flops=1.75e+07
--- TIMING FOR renorm_tot : t_inter=0.000201 t_gemm=0.00331 t_reduction=0.000582 tot=0.00409 ---
 renorm_tot counter=3 i=0 t=0.000655 per=19.8 cost=5.14e+03 flops=7.84e+06
 renorm_tot counter=3 i=1 t=0.000674 per=20.4 cost=6.81e+03 flops=1.01e+07
 renorm_tot counter=3 i=2 t=0.000209 per=6.32 cost=1.23e+03 flops=5.9e+06
 renorm_tot counter=3 i=3 t=0.000214 per=6.47 cost=2.07e+03 flops=9.66e+06
 renorm_tot counter=3 i=4 t=0.000424 per=12.8 cost=5.71e+03 flops=1.35e+07
 renorm_tot counter=3 i=5 t=0.00043 per=13 cost=1.06e+04 flops=2.46e+07
 renorm_tot counter=3 i=6 t=0.000702 per=21.2 cost=4.7e+04 flops=6.7e+07
 total GEMM cost=7.85e+04 flops=2.37e+07
check ||H-H.dagger||=3.14e-16 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0027 S T(init/kernel/comm)=0.00019,0.0025,1e-05 rank=0 -----
===== CPUmem(GB): tot=1.6e-05 (comb,oper,dvdson,hvec,renorm)=1.6e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=120:0.00092MB:8.9e-07GB
 rwfuns: len=4 mem=16:0.00012MB:1.2e-07GB
 cpsi: len=2 mem=124:0.00095MB:9.2e-07GB
total mem of comb=287:0.0022MB:2.1e-06GB
===== CPUmem(GB): tot=2.2e-05 (comb,oper,dvdson,hvec,renorm)=2.1e-06,2e-05,0,0,0 =====
fname=./scratch/sweep/rop(3,0) size=5.69e-06GB T[save](info/data/tot)=4.66e-05,3.91e-05,8.57e-05 speed=0.0664GB/s disk[used]=5.66e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
##### time_local: 4.65e-02 S #####
 T(fetch) = 9.13e-05 S  per =  0.2  per(accum) = 0.2
 T(hdiag) = 9.00e-05 S  per = 0.19  per(accum) = 0.39
 T(dvdsn) = 4.26e-02 S  per =   92  per(accum) = 92
 T(decim) = 3.32e-04 S  per = 0.71  per(accum) = 93
 T(guess) = 9.75e-05 S  per = 0.21  per(accum) = 93
 T(renrm) = 2.70e-03 S  per =  5.8  per(accum) = 99
 T(save ) = 5.89e-04 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.23e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.15e-05 S  per = 0.098  per(accum) = 0.098
 T(symbolic_formulae_twodot     ) = 2.89e-04 S  per = 0.68  per(accum) = 0.78
 T(hintermediate init           ) = 2.66e-05 S  per = 0.063  per(accum) = 0.84
 T(hintermediates memcpy cpu2gpu) = 4.65e-06 S  per = 0.011  per(accum) = 0.85
 T(preprocess_hformulae_Hxlist2 ) = 2.29e-03 S  per =  5.4  per(accum) = 6.3
 T(hmmtasks init                ) = 1.44e-03 S  per =  3.4  per(accum) = 9.7
 T(dvdson solver [Hx_batchGPU]  ) = 3.77e-02 S  per =   89  per(accum) = 99
 T(dvdson solver [communication]) = 1.13e-06 S  per = 0.0027  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.95e-04 S  per =  1.2  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.66e-03 S
 T(qops init                    ) = 1.94e-04 S  per =  7.3  per(accum) = 7.3
 T(qops_dict memcpy cpu2gpu     ) = 5.04e-05 S  per =  1.9  per(accum) = 9.2
 T(symbolic_formulae_renorm     ) = 2.64e-04 S  per =  9.9  per(accum) = 19
 T(rintermediate init           ) = 1.27e-05 S  per = 0.48  per(accum) = 20
 T(rintermediates memcpy cpu2gpu) = 6.22e-06 S  per = 0.23  per(accum) = 20
 T(preprocess_formulae_Rlist2   ) = 4.19e-04 S  per =   16  per(accum) = 36
 T(rmmtasks init                ) = 2.59e-04 S  per =  9.7  per(accum) = 45
 T(qops memset                  ) = 1.01e-05 S  per = 0.38  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 1.40e-03 S  per =   53  per(accum) = 98
 T(qops memcpy gpu2cpu          ) = 3.33e-05 S  per =  1.3  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.05e-05 S  per = 0.39  per(accum) = 1e+02
##### time_sweep: 1.22e-01 S #####
 T(fetch) = 9.78e-04 S  per =  0.8  per(accum) = 0.8
 T(hdiag) = 2.81e-04 S  per = 0.23  per(accum) = 1
 T(dvdsn) = 1.09e-01 S  per =   90  per(accum) = 91
 T(decim) = 1.09e-03 S  per =  0.9  per(accum) = 91
 T(guess) = 3.00e-04 S  per = 0.25  per(accum) = 92
 T(renrm) = 8.34e-03 S  per =  6.8  per(accum) = 99
 T(save ) = 1.76e-03 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.08e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 1.28e-04 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 8.98e-04 S  per = 0.83  per(accum) = 0.95
 T(hintermediate init           ) = 9.54e-05 S  per = 0.088  per(accum) = 1
 T(hintermediates memcpy cpu2gpu) = 1.60e-05 S  per = 0.015  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 7.50e-03 S  per =  6.9  per(accum) = 8
 T(hmmtasks init                ) = 4.91e-03 S  per =  4.5  per(accum) = 13
 T(dvdson solver [Hx_batchGPU]  ) = 9.32e-02 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 2.53e-06 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.35e-03 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(renrm): 8.20e-03 S
 T(qops init                    ) = 5.96e-04 S  per =  7.3  per(accum) = 7.3
 T(qops_dict memcpy cpu2gpu     ) = 1.28e-04 S  per =  1.6  per(accum) = 8.8
 T(symbolic_formulae_renorm     ) = 7.19e-04 S  per =  8.8  per(accum) = 18
 T(rintermediate init           ) = 5.08e-05 S  per = 0.62  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 1.75e-05 S  per = 0.21  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 1.31e-03 S  per =   16  per(accum) = 34
 T(rmmtasks init                ) = 8.58e-04 S  per =   10  per(accum) = 45
 T(qops memset                  ) = 2.94e-05 S  per = 0.36  per(accum) = 45
 T(preprocess_renorm_batchGPU   ) = 4.37e-03 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 9.21e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.98e-05 S  per = 0.36  per(accum) = 1e+02
##### time_global: 1.22e-01 S #####
 T(fetch) = 9.78e-04 S  per =  0.8  per(accum) = 0.8
 T(hdiag) = 2.81e-04 S  per = 0.23  per(accum) = 1
 T(dvdsn) = 1.09e-01 S  per =   90  per(accum) = 91
 T(decim) = 1.09e-03 S  per =  0.9  per(accum) = 91
 T(guess) = 3.00e-04 S  per = 0.25  per(accum) = 92
 T(renrm) = 8.34e-03 S  per =  6.8  per(accum) = 99
 T(save ) = 1.76e-03 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.08e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 1.28e-04 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 8.98e-04 S  per = 0.83  per(accum) = 0.95
 T(hintermediate init           ) = 9.54e-05 S  per = 0.088  per(accum) = 1
 T(hintermediates memcpy cpu2gpu) = 1.60e-05 S  per = 0.015  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 7.50e-03 S  per =  6.9  per(accum) = 8
 T(hmmtasks init                ) = 4.91e-03 S  per =  4.5  per(accum) = 13
 T(dvdson solver [Hx_batchGPU]  ) = 9.32e-02 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 2.53e-06 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.35e-03 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(renrm): 8.20e-03 S
 T(qops init                    ) = 5.96e-04 S  per =  7.3  per(accum) = 7.3
 T(qops_dict memcpy cpu2gpu     ) = 1.28e-04 S  per =  1.6  per(accum) = 8.8
 T(symbolic_formulae_renorm     ) = 7.19e-04 S  per =  8.8  per(accum) = 18
 T(rintermediate init           ) = 5.08e-05 S  per = 0.62  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 1.75e-05 S  per = 0.21  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 1.31e-03 S  per =   16  per(accum) = 34
 T(rmmtasks init                ) = 8.58e-04 S  per =   10  per(accum) = 45
 T(qops memset                  ) = 2.94e-05 S  per = 0.36  per(accum) = 45
 T(preprocess_renorm_batchGPU   ) = 4.37e-03 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 9.21e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.98e-05 S  per = 0.36  per(accum) = 1e+02

isweep=0 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.998e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=764:0.00583MB:5.69e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1202:0.00917MB:8.96e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=120:0.000916MB:8.94e-07GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 cpsi: len=2 mem=124:0.000946MB:9.24e-07GB
total mem of comb=287:0.00219MB:2.14e-06GB
===== CPUmem(GB): tot=1.11e-05 (comb,oper,dvdson,hvec,renorm)=2.14e-06,8.96e-06,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,10,4,4) nnz=72:0.000549MB
stensor4: wf own=1 _data=0x4495b880
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=5 dimAll=10
 (2,0):4 (1,1):2 (1,-1):2 (0,0):1 (2,2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=33 nblocks=320 size=72:0.000549MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=8.96e-06 (oper)(GB)=8.96e-06
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.035e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 2.454e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=9.64e-06 (oper,hinter)(GB)=8.96e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.0016 S size(H_formulae)=188 size(Hxlst)=3136 T(Hmu/Hxlist/sort)=7.92e-05,0.000777,0.000749 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000408 (oper,hinter,dvdson,batch)(GB)=8.96e-06,6.85e-07,1.07e-06,0.000397
===== CPUmem(GB): tot=2.18e-05 (comb,oper,dvdson,hvec,renorm)=2.14e-06,8.96e-06,1.07e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=72 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.8e-05,0.000205,0.00186,0.000205 cost=4.52e+04 flops[gemm]=2.43e+07
--- TIMING FOR sigma : t_inter=0.000205 t_gemm=0.00186 t_reduction=0.000205 tot=0.00227 ---
 sigma counter=38 i=0 t=0.000232 per=12.5 cost=3.82e+03 flops=1.65e+07
 sigma counter=38 i=1 t=0.000231 per=12.4 cost=4.32e+03 flops=1.87e+07
 sigma counter=38 i=2 t=0.000226 per=12.2 cost=3.83e+03 flops=1.7e+07
 sigma counter=38 i=3 t=0.00023 per=12.4 cost=4.12e+03 flops=1.79e+07
 sigma counter=38 i=4 t=0.000245 per=13.2 cost=1.06e+04 flops=4.31e+07
 sigma counter=38 i=5 t=0.000234 per=12.6 cost=1.06e+04 flops=4.52e+07
 sigma counter=38 i=6 t=0.000232 per=12.5 cost=4.12e+03 flops=1.78e+07
 sigma counter=38 i=7 t=0.000226 per=12.2 cost=3.83e+03 flops=1.7e+07
 total GEMM cost=4.52e+04 flops=2.43e+07
--- TIMING FOR sigma_tot : t_inter=0.0078 t_gemm=0.0754 t_reduction=0.00753 tot=0.0908 ---
 sigma_tot counter=38 i=0 t=0.00939 per=12.5 cost=1.95e+05 flops=2.07e+07
 sigma_tot counter=38 i=1 t=0.00968 per=12.8 cost=1.94e+05 flops=2e+07
 sigma_tot counter=38 i=2 t=0.00921 per=12.2 cost=1.99e+05 flops=2.16e+07
 sigma_tot counter=38 i=3 t=0.0093 per=12.3 cost=1.98e+05 flops=2.13e+07
 sigma_tot counter=38 i=4 t=0.00915 per=12.1 cost=2.25e+05 flops=2.46e+07
 sigma_tot counter=38 i=5 t=0.00931 per=12.3 cost=2.24e+05 flops=2.4e+07
 sigma_tot counter=38 i=6 t=0.00993 per=13.2 cost=4.32e+05 flops=4.35e+07
 sigma_tot counter=38 i=7 t=0.00946 per=12.5 cost=4.32e+05 flops=4.57e+07
 total GEMM cost=2.1e+06 flops=2.78e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.9e-05,0.000195,0.00186,0.000193 cost=4.52e+04 flops[gemm]=2.43e+07
--- TIMING FOR sigma : t_inter=0.000195 t_gemm=0.00186 t_reduction=0.000193 tot=0.00225 ---
 sigma counter=39 i=0 t=0.000232 per=12.5 cost=3.82e+03 flops=1.65e+07
 sigma counter=39 i=1 t=0.000229 per=12.3 cost=4.32e+03 flops=1.89e+07
 sigma counter=39 i=2 t=0.000232 per=12.5 cost=3.83e+03 flops=1.65e+07
 sigma counter=39 i=3 t=0.000229 per=12.3 cost=4.12e+03 flops=1.8e+07
 sigma counter=39 i=4 t=0.000235 per=12.6 cost=1.06e+04 flops=4.5e+07
 sigma counter=39 i=5 t=0.000235 per=12.6 cost=1.06e+04 flops=4.5e+07
 sigma counter=39 i=6 t=0.000243 per=13 cost=4.12e+03 flops=1.7e+07
 sigma counter=39 i=7 t=0.000228 per=12.2 cost=3.83e+03 flops=1.68e+07
 total GEMM cost=4.52e+04 flops=2.43e+07
--- TIMING FOR sigma_tot : t_inter=0.008 t_gemm=0.0773 t_reduction=0.00772 tot=0.093 ---
 sigma_tot counter=39 i=0 t=0.00962 per=12.5 cost=1.99e+05 flops=2.06e+07
 sigma_tot counter=39 i=1 t=0.0099 per=12.8 cost=1.98e+05 flops=2e+07
 sigma_tot counter=39 i=2 t=0.00944 per=12.2 cost=2.02e+05 flops=2.14e+07
 sigma_tot counter=39 i=3 t=0.00953 per=12.3 cost=2.02e+05 flops=2.12e+07
 sigma_tot counter=39 i=4 t=0.00939 per=12.1 cost=2.36e+05 flops=2.51e+07
 sigma_tot counter=39 i=5 t=0.00954 per=12.3 cost=2.34e+05 flops=2.46e+07
 sigma_tot counter=39 i=6 t=0.0102 per=13.2 cost=4.36e+05 flops=4.29e+07
 sigma_tot counter=39 i=7 t=0.00969 per=12.5 cost=4.36e+05 flops=4.5e+07
 total GEMM cost=2.14e+06 flops=2.77e+07
settings: ndim=72 neig=2 maxcycle=30 nbuff=4 memory=9.66e-06GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.649584713313  -1.00e+03   5.61e-02    2     2   4.80e-03  2.40e-03
    1   1 -      -2.422873629958  -1.00e+03   1.13e-01    2     2   4.80e-03  2.40e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,1.92e-04,1.87e-03,1.97e-04 cost=4.52e+04 flops[gemm]=2.41e+07
--- TIMING FOR sigma : t_inter=1.92e-04 t_gemm=1.87e-03 t_reduction=1.97e-04 tot=2.26e-03 ---
 sigma counter=40 i=0 t=2.32e-04 per=1.24e+01 cost=3.82e+03 flops=1.65e+07
 sigma counter=40 i=1 t=2.37e-04 per=1.27e+01 cost=4.32e+03 flops=1.82e+07
 sigma counter=40 i=2 t=2.40e-04 per=1.28e+01 cost=3.83e+03 flops=1.60e+07
 sigma counter=40 i=3 t=2.30e-04 per=1.23e+01 cost=4.12e+03 flops=1.79e+07
 sigma counter=40 i=4 t=2.39e-04 per=1.28e+01 cost=1.06e+04 flops=4.42e+07
 sigma counter=40 i=5 t=2.35e-04 per=1.26e+01 cost=1.06e+04 flops=4.50e+07
 sigma counter=40 i=6 t=2.32e-04 per=1.24e+01 cost=4.12e+03 flops=1.78e+07
 sigma counter=40 i=7 t=2.27e-04 per=1.21e+01 cost=3.83e+03 flops=1.69e+07
 total GEMM cost=4.52e+04 flops=2.41e+07
--- TIMING FOR sigma_tot : t_inter=8.19e-03 t_gemm=7.92e-02 t_reduction=7.92e-03 tot=9.53e-02 ---
 sigma_tot counter=40 i=0 t=9.86e-03 per=1.24e+01 cost=2.02e+05 flops=2.05e+07
 sigma_tot counter=40 i=1 t=1.01e-02 per=1.28e+01 cost=2.02e+05 flops=2.00e+07
 sigma_tot counter=40 i=2 t=9.68e-03 per=1.22e+01 cost=2.06e+05 flops=2.13e+07
 sigma_tot counter=40 i=3 t=9.76e-03 per=1.23e+01 cost=2.06e+05 flops=2.11e+07
 sigma_tot counter=40 i=4 t=9.63e-03 per=1.22e+01 cost=2.46e+05 flops=2.56e+07
 sigma_tot counter=40 i=5 t=9.78e-03 per=1.24e+01 cost=2.45e+05 flops=2.50e+07
 sigma_tot counter=40 i=6 t=1.04e-02 per=1.31e+01 cost=4.41e+05 flops=4.24e+07
 sigma_tot counter=40 i=7 t=9.92e-03 per=1.25e+01 cost=4.40e+05 flops=4.44e+07
 total GEMM cost=2.19e+06 flops=2.77e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.96e-04,1.86e-03,1.96e-04 cost=4.52e+04 flops[gemm]=2.43e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.86e-03 t_reduction=1.96e-04 tot=2.25e-03 ---
 sigma counter=41 i=0 t=2.29e-04 per=1.23e+01 cost=3.82e+03 flops=1.67e+07
 sigma counter=41 i=1 t=2.30e-04 per=1.24e+01 cost=4.32e+03 flops=1.88e+07
 sigma counter=41 i=2 t=2.28e-04 per=1.23e+01 cost=3.83e+03 flops=1.68e+07
 sigma counter=41 i=3 t=2.38e-04 per=1.28e+01 cost=4.12e+03 flops=1.73e+07
 sigma counter=41 i=4 t=2.31e-04 per=1.24e+01 cost=1.06e+04 flops=4.57e+07
 sigma counter=41 i=5 t=2.35e-04 per=1.26e+01 cost=1.06e+04 flops=4.50e+07
 sigma counter=41 i=6 t=2.33e-04 per=1.25e+01 cost=4.12e+03 flops=1.77e+07
 sigma counter=41 i=7 t=2.34e-04 per=1.26e+01 cost=3.83e+03 flops=1.64e+07
 total GEMM cost=4.52e+04 flops=2.43e+07
--- TIMING FOR sigma_tot : t_inter=8.39e-03 t_gemm=8.10e-02 t_reduction=8.12e-03 tot=9.75e-02 ---
 sigma_tot counter=41 i=0 t=1.01e-02 per=1.24e+01 cost=2.06e+05 flops=2.05e+07
 sigma_tot counter=41 i=1 t=1.04e-02 per=1.28e+01 cost=2.07e+05 flops=1.99e+07
 sigma_tot counter=41 i=2 t=9.91e-03 per=1.22e+01 cost=2.10e+05 flops=2.12e+07
 sigma_tot counter=41 i=3 t=1.00e-02 per=1.23e+01 cost=2.10e+05 flops=2.10e+07
 sigma_tot counter=41 i=4 t=9.86e-03 per=1.22e+01 cost=2.57e+05 flops=2.61e+07
 sigma_tot counter=41 i=5 t=1.00e-02 per=1.24e+01 cost=2.55e+05 flops=2.55e+07
 sigma_tot counter=41 i=6 t=1.06e-02 per=1.31e+01 cost=4.45e+05 flops=4.18e+07
 sigma_tot counter=41 i=7 t=1.01e-02 per=1.25e+01 cost=4.44e+05 flops=4.37e+07
 total GEMM cost=2.23e+06 flops=2.76e+07
    2   0 -      -2.651942776194  -2.36e-03   1.27e-02    4     4   9.64e-03  2.41e-03
    2   1 -      -2.430205342757  -7.33e-03   2.58e-02    4     4   9.64e-03  2.41e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.10e-05,1.94e-04,1.89e-03,1.97e-04 cost=4.52e+04 flops[gemm]=2.39e+07
--- TIMING FOR sigma : t_inter=1.94e-04 t_gemm=1.89e-03 t_reduction=1.97e-04 tot=2.28e-03 ---
 sigma counter=42 i=0 t=2.37e-04 per=1.25e+01 cost=3.82e+03 flops=1.61e+07
 sigma counter=42 i=1 t=2.56e-04 per=1.35e+01 cost=4.32e+03 flops=1.69e+07
 sigma counter=42 i=2 t=2.27e-04 per=1.20e+01 cost=3.83e+03 flops=1.69e+07
 sigma counter=42 i=3 t=2.29e-04 per=1.21e+01 cost=4.12e+03 flops=1.80e+07
 sigma counter=42 i=4 t=2.31e-04 per=1.22e+01 cost=1.06e+04 flops=4.57e+07
 sigma counter=42 i=5 t=2.46e-04 per=1.30e+01 cost=1.06e+04 flops=4.30e+07
 sigma counter=42 i=6 t=2.36e-04 per=1.25e+01 cost=4.12e+03 flops=1.75e+07
 sigma counter=42 i=7 t=2.31e-04 per=1.22e+01 cost=3.83e+03 flops=1.66e+07
 total GEMM cost=4.52e+04 flops=2.39e+07
--- TIMING FOR sigma_tot : t_inter=8.58e-03 t_gemm=8.29e-02 t_reduction=8.31e-03 tot=9.98e-02 ---
 sigma_tot counter=42 i=0 t=1.03e-02 per=1.24e+01 cost=2.10e+05 flops=2.04e+07
 sigma_tot counter=42 i=1 t=1.06e-02 per=1.28e+01 cost=2.11e+05 flops=1.99e+07
 sigma_tot counter=42 i=2 t=1.01e-02 per=1.22e+01 cost=2.14e+05 flops=2.11e+07
 sigma_tot counter=42 i=3 t=1.02e-02 per=1.23e+01 cost=2.14e+05 flops=2.10e+07
 sigma_tot counter=42 i=4 t=1.01e-02 per=1.22e+01 cost=2.68e+05 flops=2.65e+07
 sigma_tot counter=42 i=5 t=1.03e-02 per=1.24e+01 cost=2.66e+05 flops=2.59e+07
 sigma_tot counter=42 i=6 t=1.09e-02 per=1.31e+01 cost=4.49e+05 flops=4.13e+07
 sigma_tot counter=42 i=7 t=1.04e-02 per=1.25e+01 cost=4.47e+05 flops=4.31e+07
 total GEMM cost=2.28e+06 flops=2.75e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.03e-04,1.85e-03,1.99e-04 cost=4.52e+04 flops[gemm]=2.44e+07
--- TIMING FOR sigma : t_inter=2.03e-04 t_gemm=1.85e-03 t_reduction=1.99e-04 tot=2.25e-03 ---
 sigma counter=43 i=0 t=2.31e-04 per=1.25e+01 cost=3.82e+03 flops=1.65e+07
 sigma counter=43 i=1 t=2.31e-04 per=1.25e+01 cost=4.32e+03 flops=1.87e+07
 sigma counter=43 i=2 t=2.26e-04 per=1.22e+01 cost=3.83e+03 flops=1.70e+07
 sigma counter=43 i=3 t=2.30e-04 per=1.24e+01 cost=4.12e+03 flops=1.79e+07
 sigma counter=43 i=4 t=2.35e-04 per=1.27e+01 cost=1.06e+04 flops=4.50e+07
 sigma counter=43 i=5 t=2.35e-04 per=1.27e+01 cost=1.06e+04 flops=4.50e+07
 sigma counter=43 i=6 t=2.34e-04 per=1.27e+01 cost=4.12e+03 flops=1.76e+07
 sigma counter=43 i=7 t=2.27e-04 per=1.23e+01 cost=3.83e+03 flops=1.69e+07
 total GEMM cost=4.52e+04 flops=2.44e+07
--- TIMING FOR sigma_tot : t_inter=8.78e-03 t_gemm=8.48e-02 t_reduction=8.51e-03 tot=1.02e-01 ---
 sigma_tot counter=43 i=0 t=1.06e-02 per=1.24e+01 cost=2.14e+05 flops=2.03e+07
 sigma_tot counter=43 i=1 t=1.09e-02 per=1.28e+01 cost=2.15e+05 flops=1.98e+07
 sigma_tot counter=43 i=2 t=1.04e-02 per=1.22e+01 cost=2.18e+05 flops=2.10e+07
 sigma_tot counter=43 i=3 t=1.05e-02 per=1.23e+01 cost=2.18e+05 flops=2.09e+07
 sigma_tot counter=43 i=4 t=1.03e-02 per=1.22e+01 cost=2.78e+05 flops=2.69e+07
 sigma_tot counter=43 i=5 t=1.05e-02 per=1.24e+01 cost=2.77e+05 flops=2.64e+07
 sigma_tot counter=43 i=6 t=1.11e-02 per=1.31e+01 cost=4.53e+05 flops=4.08e+07
 sigma_tot counter=43 i=7 t=1.06e-02 per=1.25e+01 cost=4.51e+05 flops=4.25e+07
 total GEMM cost=2.32e+06 flops=2.74e+07
    3   0 -      -2.652054181748  -1.11e-04   5.06e-03    6     6   1.45e-02  2.41e-03
    3   1 -      -2.430611176914  -4.06e-04   9.32e-03    6     6   1.45e-02  2.41e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,1.94e-04,1.90e-03,1.99e-04 cost=4.52e+04 flops[gemm]=2.38e+07
--- TIMING FOR sigma : t_inter=1.94e-04 t_gemm=1.90e-03 t_reduction=1.98e-04 tot=2.29e-03 ---
 sigma counter=44 i=0 t=2.36e-04 per=1.24e+01 cost=3.82e+03 flops=1.62e+07
 sigma counter=44 i=1 t=2.57e-04 per=1.35e+01 cost=4.32e+03 flops=1.68e+07
 sigma counter=44 i=2 t=2.28e-04 per=1.20e+01 cost=3.83e+03 flops=1.68e+07
 sigma counter=44 i=3 t=2.31e-04 per=1.22e+01 cost=4.12e+03 flops=1.78e+07
 sigma counter=44 i=4 t=2.34e-04 per=1.23e+01 cost=1.06e+04 flops=4.52e+07
 sigma counter=44 i=5 t=2.43e-04 per=1.28e+01 cost=1.06e+04 flops=4.35e+07
 sigma counter=44 i=6 t=2.43e-04 per=1.28e+01 cost=4.12e+03 flops=1.70e+07
 sigma counter=44 i=7 t=2.28e-04 per=1.20e+01 cost=3.83e+03 flops=1.68e+07
 total GEMM cost=4.52e+04 flops=2.38e+07
--- TIMING FOR sigma_tot : t_inter=8.98e-03 t_gemm=8.67e-02 t_reduction=8.71e-03 tot=1.04e-01 ---
 sigma_tot counter=44 i=0 t=1.08e-02 per=1.24e+01 cost=2.18e+05 flops=2.02e+07
 sigma_tot counter=44 i=1 t=1.11e-02 per=1.28e+01 cost=2.20e+05 flops=1.98e+07
 sigma_tot counter=44 i=2 t=1.06e-02 per=1.22e+01 cost=2.22e+05 flops=2.09e+07
 sigma_tot counter=44 i=3 t=1.07e-02 per=1.23e+01 cost=2.23e+05 flops=2.08e+07
 sigma_tot counter=44 i=4 t=1.06e-02 per=1.22e+01 cost=2.89e+05 flops=2.73e+07
 sigma_tot counter=44 i=5 t=1.07e-02 per=1.24e+01 cost=2.87e+05 flops=2.67e+07
 sigma_tot counter=44 i=6 t=1.14e-02 per=1.31e+01 cost=4.57e+05 flops=4.03e+07
 sigma_tot counter=44 i=7 t=1.08e-02 per=1.25e+01 cost=4.55e+05 flops=4.20e+07
 total GEMM cost=2.37e+06 flops=2.73e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.96e-04,1.85e-03,1.94e-04 cost=4.52e+04 flops[gemm]=2.45e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.85e-03 t_reduction=1.94e-04 tot=2.24e-03 ---
 sigma counter=45 i=0 t=2.37e-04 per=1.28e+01 cost=3.82e+03 flops=1.61e+07
 sigma counter=45 i=1 t=2.29e-04 per=1.24e+01 cost=4.32e+03 flops=1.89e+07
 sigma counter=45 i=2 t=2.25e-04 per=1.22e+01 cost=3.83e+03 flops=1.70e+07
 sigma counter=45 i=3 t=2.28e-04 per=1.24e+01 cost=4.12e+03 flops=1.81e+07
 sigma counter=45 i=4 t=2.35e-04 per=1.27e+01 cost=1.06e+04 flops=4.50e+07
 sigma counter=45 i=5 t=2.34e-04 per=1.27e+01 cost=1.06e+04 flops=4.52e+07
 sigma counter=45 i=6 t=2.31e-04 per=1.25e+01 cost=4.12e+03 flops=1.78e+07
 sigma counter=45 i=7 t=2.26e-04 per=1.22e+01 cost=3.83e+03 flops=1.70e+07
 total GEMM cost=4.52e+04 flops=2.45e+07
--- TIMING FOR sigma_tot : t_inter=9.17e-03 t_gemm=8.85e-02 t_reduction=8.90e-03 tot=1.07e-01 ---
 sigma_tot counter=45 i=0 t=1.10e-02 per=1.25e+01 cost=2.22e+05 flops=2.01e+07
 sigma_tot counter=45 i=1 t=1.13e-02 per=1.28e+01 cost=2.24e+05 flops=1.97e+07
 sigma_tot counter=45 i=2 t=1.08e-02 per=1.22e+01 cost=2.25e+05 flops=2.08e+07
 sigma_tot counter=45 i=3 t=1.09e-02 per=1.23e+01 cost=2.27e+05 flops=2.08e+07
 sigma_tot counter=45 i=4 t=1.08e-02 per=1.22e+01 cost=2.99e+05 flops=2.77e+07
 sigma_tot counter=45 i=5 t=1.10e-02 per=1.24e+01 cost=2.98e+05 flops=2.71e+07
 sigma_tot counter=45 i=6 t=1.16e-02 per=1.31e+01 cost=4.61e+05 flops=3.98e+07
 sigma_tot counter=45 i=7 t=1.11e-02 per=1.25e+01 cost=4.59e+05 flops=4.15e+07
 total GEMM cost=2.41e+06 flops=2.73e+07
    4   0 -      -2.652078566392  -2.44e-05   1.91e-03    6     8   1.93e-02  2.41e-03
    4   1 -      -2.430673358958  -6.22e-05   4.16e-03    6     8   1.93e-02  2.41e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.10e-05,1.92e-04,1.87e-03,1.94e-04 cost=4.52e+04 flops[gemm]=2.42e+07
--- TIMING FOR sigma : t_inter=1.92e-04 t_gemm=1.87e-03 t_reduction=1.93e-04 tot=2.25e-03 ---
 sigma counter=46 i=0 t=2.35e-04 per=1.26e+01 cost=3.82e+03 flops=1.63e+07
 sigma counter=46 i=1 t=2.35e-04 per=1.26e+01 cost=4.32e+03 flops=1.84e+07
 sigma counter=46 i=2 t=2.44e-04 per=1.31e+01 cost=3.83e+03 flops=1.57e+07
 sigma counter=46 i=3 t=2.26e-04 per=1.21e+01 cost=4.12e+03 flops=1.82e+07
 sigma counter=46 i=4 t=2.33e-04 per=1.25e+01 cost=1.06e+04 flops=4.54e+07
 sigma counter=46 i=5 t=2.33e-04 per=1.25e+01 cost=1.06e+04 flops=4.54e+07
 sigma counter=46 i=6 t=2.39e-04 per=1.28e+01 cost=4.12e+03 flops=1.72e+07
 sigma counter=46 i=7 t=2.24e-04 per=1.20e+01 cost=3.83e+03 flops=1.71e+07
 total GEMM cost=4.52e+04 flops=2.42e+07
--- TIMING FOR sigma_tot : t_inter=9.37e-03 t_gemm=9.04e-02 t_reduction=9.10e-03 tot=1.09e-01 ---
 sigma_tot counter=46 i=0 t=1.13e-02 per=1.25e+01 cost=2.25e+05 flops=2.00e+07
 sigma_tot counter=46 i=1 t=1.16e-02 per=1.28e+01 cost=2.28e+05 flops=1.97e+07
 sigma_tot counter=46 i=2 t=1.11e-02 per=1.22e+01 cost=2.29e+05 flops=2.07e+07
 sigma_tot counter=46 i=3 t=1.11e-02 per=1.23e+01 cost=2.31e+05 flops=2.07e+07
 sigma_tot counter=46 i=4 t=1.10e-02 per=1.22e+01 cost=3.10e+05 flops=2.81e+07
 sigma_tot counter=46 i=5 t=1.12e-02 per=1.24e+01 cost=3.08e+05 flops=2.75e+07
 sigma_tot counter=46 i=6 t=1.18e-02 per=1.31e+01 cost=4.65e+05 flops=3.94e+07
 sigma_tot counter=46 i=7 t=1.13e-02 per=1.25e+01 cost=4.63e+05 flops=4.10e+07
 total GEMM cost=2.46e+06 flops=2.72e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.91e-04,1.87e-03,1.94e-04 cost=4.52e+04 flops[gemm]=2.42e+07
--- TIMING FOR sigma : t_inter=1.90e-04 t_gemm=1.87e-03 t_reduction=1.94e-04 tot=2.25e-03 ---
 sigma counter=47 i=0 t=2.40e-04 per=1.29e+01 cost=3.82e+03 flops=1.59e+07
 sigma counter=47 i=1 t=2.38e-04 per=1.27e+01 cost=4.32e+03 flops=1.82e+07
 sigma counter=47 i=2 t=2.28e-04 per=1.22e+01 cost=3.83e+03 flops=1.68e+07
 sigma counter=47 i=3 t=2.29e-04 per=1.23e+01 cost=4.12e+03 flops=1.80e+07
 sigma counter=47 i=4 t=2.34e-04 per=1.25e+01 cost=1.06e+04 flops=4.52e+07
 sigma counter=47 i=5 t=2.41e-04 per=1.29e+01 cost=1.06e+04 flops=4.39e+07
 sigma counter=47 i=6 t=2.31e-04 per=1.24e+01 cost=4.12e+03 flops=1.78e+07
 sigma counter=47 i=7 t=2.26e-04 per=1.21e+01 cost=3.83e+03 flops=1.70e+07
 total GEMM cost=4.52e+04 flops=2.42e+07
--- TIMING FOR sigma_tot : t_inter=9.56e-03 t_gemm=9.22e-02 t_reduction=9.29e-03 tot=1.11e-01 ---
 sigma_tot counter=47 i=0 t=1.15e-02 per=1.25e+01 cost=2.29e+05 flops=1.99e+07
 sigma_tot counter=47 i=1 t=1.18e-02 per=1.28e+01 cost=2.33e+05 flops=1.97e+07
 sigma_tot counter=47 i=2 t=1.13e-02 per=1.22e+01 cost=2.33e+05 flops=2.07e+07
 sigma_tot counter=47 i=3 t=1.14e-02 per=1.23e+01 cost=2.35e+05 flops=2.07e+07
 sigma_tot counter=47 i=4 t=1.13e-02 per=1.22e+01 cost=3.20e+05 flops=2.85e+07
 sigma_tot counter=47 i=5 t=1.14e-02 per=1.24e+01 cost=3.19e+05 flops=2.79e+07
 sigma_tot counter=47 i=6 t=1.21e-02 per=1.31e+01 cost=4.69e+05 flops=3.90e+07
 sigma_tot counter=47 i=7 t=1.15e-02 per=1.25e+01 cost=4.67e+05 flops=4.05e+07
 total GEMM cost=2.51e+06 flops=2.72e+07
    5   0 -      -2.652080842743  -2.28e-06   5.13e-04    6    10   2.41e-02  2.41e-03
    5   1 -      -2.430687478263  -1.41e-05   1.80e-03    6    10   2.41e-02  2.41e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,2.01e-04,1.87e-03,1.95e-04 cost=4.52e+04 flops[gemm]=2.41e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.87e-03 t_reduction=1.95e-04 tot=2.27e-03 ---
 sigma counter=48 i=0 t=2.35e-04 per=1.25e+01 cost=3.82e+03 flops=1.63e+07
 sigma counter=48 i=1 t=2.34e-04 per=1.25e+01 cost=4.32e+03 flops=1.85e+07
 sigma counter=48 i=2 t=2.39e-04 per=1.27e+01 cost=3.83e+03 flops=1.60e+07
 sigma counter=48 i=3 t=2.34e-04 per=1.25e+01 cost=4.12e+03 flops=1.76e+07
 sigma counter=48 i=4 t=2.32e-04 per=1.24e+01 cost=1.06e+04 flops=4.56e+07
 sigma counter=48 i=5 t=2.33e-04 per=1.24e+01 cost=1.06e+04 flops=4.54e+07
 sigma counter=48 i=6 t=2.33e-04 per=1.24e+01 cost=4.12e+03 flops=1.77e+07
 sigma counter=48 i=7 t=2.35e-04 per=1.25e+01 cost=3.83e+03 flops=1.63e+07
 total GEMM cost=4.52e+04 flops=2.41e+07
--- TIMING FOR sigma_tot : t_inter=9.76e-03 t_gemm=9.41e-02 t_reduction=9.49e-03 tot=1.13e-01 ---
 sigma_tot counter=48 i=0 t=1.17e-02 per=1.25e+01 cost=2.33e+05 flops=1.99e+07
 sigma_tot counter=48 i=1 t=1.21e-02 per=1.28e+01 cost=2.37e+05 flops=1.97e+07
 sigma_tot counter=48 i=2 t=1.15e-02 per=1.22e+01 cost=2.37e+05 flops=2.06e+07
 sigma_tot counter=48 i=3 t=1.16e-02 per=1.23e+01 cost=2.39e+05 flops=2.06e+07
 sigma_tot counter=48 i=4 t=1.15e-02 per=1.22e+01 cost=3.31e+05 flops=2.88e+07
 sigma_tot counter=48 i=5 t=1.17e-02 per=1.24e+01 cost=3.29e+05 flops=2.82e+07
 sigma_tot counter=48 i=6 t=1.23e-02 per=1.31e+01 cost=4.74e+05 flops=3.86e+07
 sigma_tot counter=48 i=7 t=1.17e-02 per=1.25e+01 cost=4.70e+05 flops=4.01e+07
 total GEMM cost=2.55e+06 flops=2.71e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.91e-04,1.85e-03,1.96e-04 cost=4.52e+04 flops[gemm]=2.45e+07
--- TIMING FOR sigma : t_inter=1.91e-04 t_gemm=1.85e-03 t_reduction=1.96e-04 tot=2.23e-03 ---
 sigma counter=49 i=0 t=2.27e-04 per=1.23e+01 cost=3.82e+03 flops=1.68e+07
 sigma counter=49 i=1 t=2.36e-04 per=1.28e+01 cost=4.32e+03 flops=1.83e+07
 sigma counter=49 i=2 t=2.27e-04 per=1.23e+01 cost=3.83e+03 flops=1.69e+07
 sigma counter=49 i=3 t=2.28e-04 per=1.23e+01 cost=4.12e+03 flops=1.81e+07
 sigma counter=49 i=4 t=2.31e-04 per=1.25e+01 cost=1.06e+04 flops=4.57e+07
 sigma counter=49 i=5 t=2.35e-04 per=1.27e+01 cost=1.06e+04 flops=4.50e+07
 sigma counter=49 i=6 t=2.36e-04 per=1.28e+01 cost=4.12e+03 flops=1.75e+07
 sigma counter=49 i=7 t=2.27e-04 per=1.23e+01 cost=3.83e+03 flops=1.69e+07
 total GEMM cost=4.52e+04 flops=2.45e+07
--- TIMING FOR sigma_tot : t_inter=9.95e-03 t_gemm=9.60e-02 t_reduction=9.68e-03 tot=1.16e-01 ---
 sigma_tot counter=49 i=0 t=1.20e-02 per=1.25e+01 cost=2.37e+05 flops=1.98e+07
 sigma_tot counter=49 i=1 t=1.23e-02 per=1.28e+01 cost=2.41e+05 flops=1.96e+07
 sigma_tot counter=49 i=2 t=1.18e-02 per=1.22e+01 cost=2.41e+05 flops=2.05e+07
 sigma_tot counter=49 i=3 t=1.18e-02 per=1.23e+01 cost=2.43e+05 flops=2.05e+07
 sigma_tot counter=49 i=4 t=1.17e-02 per=1.22e+01 cost=3.42e+05 flops=2.91e+07
 sigma_tot counter=49 i=5 t=1.19e-02 per=1.24e+01 cost=3.40e+05 flops=2.85e+07
 sigma_tot counter=49 i=6 t=1.25e-02 per=1.30e+01 cost=4.78e+05 flops=3.82e+07
 sigma_tot counter=49 i=7 t=1.20e-02 per=1.25e+01 cost=4.74e+05 flops=3.96e+07
 total GEMM cost=2.60e+06 flops=2.70e+07
    6   0 -      -2.652081069574  -2.27e-07   1.76e-04    6    12   2.89e-02  2.41e-03
    6   1 -      -2.430689675153  -2.20e-06   5.57e-04    6    12   2.89e-02  2.41e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,1.93e-04,1.88e-03,1.99e-04 cost=4.52e+04 flops[gemm]=2.41e+07
--- TIMING FOR sigma : t_inter=1.93e-04 t_gemm=1.88e-03 t_reduction=1.99e-04 tot=2.27e-03 ---
 sigma counter=50 i=0 t=2.42e-04 per=1.29e+01 cost=3.82e+03 flops=1.58e+07
 sigma counter=50 i=1 t=2.35e-04 per=1.25e+01 cost=4.32e+03 flops=1.84e+07
 sigma counter=50 i=2 t=2.39e-04 per=1.27e+01 cost=3.83e+03 flops=1.60e+07
 sigma counter=50 i=3 t=2.28e-04 per=1.22e+01 cost=4.12e+03 flops=1.81e+07
 sigma counter=50 i=4 t=2.38e-04 per=1.27e+01 cost=1.06e+04 flops=4.44e+07
 sigma counter=50 i=5 t=2.35e-04 per=1.25e+01 cost=1.06e+04 flops=4.50e+07
 sigma counter=50 i=6 t=2.33e-04 per=1.24e+01 cost=4.12e+03 flops=1.77e+07
 sigma counter=50 i=7 t=2.26e-04 per=1.20e+01 cost=3.83e+03 flops=1.70e+07
 total GEMM cost=4.52e+04 flops=2.41e+07
--- TIMING FOR sigma_tot : t_inter=1.01e-02 t_gemm=9.78e-02 t_reduction=9.88e-03 tot=1.18e-01 ---
 sigma_tot counter=50 i=0 t=1.22e-02 per=1.25e+01 cost=2.41e+05 flops=1.97e+07
 sigma_tot counter=50 i=1 t=1.25e-02 per=1.28e+01 cost=2.46e+05 flops=1.96e+07
 sigma_tot counter=50 i=2 t=1.20e-02 per=1.23e+01 cost=2.45e+05 flops=2.04e+07
 sigma_tot counter=50 i=3 t=1.21e-02 per=1.23e+01 cost=2.47e+05 flops=2.05e+07
 sigma_tot counter=50 i=4 t=1.20e-02 per=1.22e+01 cost=3.52e+05 flops=2.94e+07
 sigma_tot counter=50 i=5 t=1.21e-02 per=1.24e+01 cost=3.51e+05 flops=2.89e+07
 sigma_tot counter=50 i=6 t=1.28e-02 per=1.30e+01 cost=4.82e+05 flops=3.78e+07
 sigma_tot counter=50 i=7 t=1.22e-02 per=1.25e+01 cost=4.78e+05 flops=3.92e+07
 total GEMM cost=2.64e+06 flops=2.70e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,1.93e-04,1.88e-03,2.05e-04 cost=4.52e+04 flops[gemm]=2.41e+07
--- TIMING FOR sigma : t_inter=1.93e-04 t_gemm=1.88e-03 t_reduction=2.05e-04 tot=2.27e-03 ---
 sigma counter=51 i=0 t=2.29e-04 per=1.22e+01 cost=3.82e+03 flops=1.67e+07
 sigma counter=51 i=1 t=2.29e-04 per=1.22e+01 cost=4.32e+03 flops=1.89e+07
 sigma counter=51 i=2 t=2.31e-04 per=1.23e+01 cost=3.83e+03 flops=1.66e+07
 sigma counter=51 i=3 t=2.29e-04 per=1.22e+01 cost=4.12e+03 flops=1.80e+07
 sigma counter=51 i=4 t=2.33e-04 per=1.24e+01 cost=1.06e+04 flops=4.54e+07
 sigma counter=51 i=5 t=2.34e-04 per=1.25e+01 cost=1.06e+04 flops=4.52e+07
 sigma counter=51 i=6 t=2.33e-04 per=1.24e+01 cost=4.12e+03 flops=1.77e+07
 sigma counter=51 i=7 t=2.58e-04 per=1.38e+01 cost=3.83e+03 flops=1.49e+07
 total GEMM cost=4.52e+04 flops=2.41e+07
--- TIMING FOR sigma_tot : t_inter=1.03e-02 t_gemm=9.97e-02 t_reduction=1.01e-02 tot=1.20e-01 ---
 sigma_tot counter=51 i=0 t=1.24e-02 per=1.25e+01 cost=2.44e+05 flops=1.97e+07
 sigma_tot counter=51 i=1 t=1.28e-02 per=1.28e+01 cost=2.50e+05 flops=1.96e+07
 sigma_tot counter=51 i=2 t=1.22e-02 per=1.23e+01 cost=2.48e+05 flops=2.03e+07
 sigma_tot counter=51 i=3 t=1.23e-02 per=1.23e+01 cost=2.51e+05 flops=2.05e+07
 sigma_tot counter=51 i=4 t=1.22e-02 per=1.22e+01 cost=3.63e+05 flops=2.97e+07
 sigma_tot counter=51 i=5 t=1.24e-02 per=1.24e+01 cost=3.61e+05 flops=2.92e+07
 sigma_tot counter=51 i=6 t=1.30e-02 per=1.30e+01 cost=4.86e+05 flops=3.74e+07
 sigma_tot counter=51 i=7 t=1.25e-02 per=1.25e+01 cost=4.82e+05 flops=3.87e+07
 total GEMM cost=2.69e+06 flops=2.69e+07
    7   0 +      -2.652081089524  -1.99e-08   6.38e-05    6    14   3.38e-02  2.42e-03
    7   1 -      -2.430689869830  -1.95e-07   1.13e-04    6    14   3.38e-02  2.42e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.30e-05,2.17e-04,2.06e-03,2.14e-04 cost=4.52e+04 flops[gemm]=2.19e+07
--- TIMING FOR sigma : t_inter=2.17e-04 t_gemm=2.06e-03 t_reduction=2.14e-04 tot=2.49e-03 ---
 sigma counter=52 i=0 t=2.66e-04 per=1.29e+01 cost=3.82e+03 flops=1.44e+07
 sigma counter=52 i=1 t=2.66e-04 per=1.29e+01 cost=4.32e+03 flops=1.62e+07
 sigma counter=52 i=2 t=2.44e-04 per=1.19e+01 cost=3.83e+03 flops=1.57e+07
 sigma counter=52 i=3 t=2.56e-04 per=1.24e+01 cost=4.12e+03 flops=1.61e+07
 sigma counter=52 i=4 t=2.59e-04 per=1.26e+01 cost=1.06e+04 flops=4.08e+07
 sigma counter=52 i=5 t=2.55e-04 per=1.24e+01 cost=1.06e+04 flops=4.14e+07
 sigma counter=52 i=6 t=2.59e-04 per=1.26e+01 cost=4.12e+03 flops=1.59e+07
 sigma counter=52 i=7 t=2.54e-04 per=1.23e+01 cost=3.83e+03 flops=1.51e+07
 total GEMM cost=4.52e+04 flops=2.19e+07
--- TIMING FOR sigma_tot : t_inter=1.06e-02 t_gemm=1.02e-01 t_reduction=1.03e-02 tot=1.23e-01 ---
 sigma_tot counter=52 i=0 t=1.27e-02 per=1.25e+01 cost=2.48e+05 flops=1.96e+07
 sigma_tot counter=52 i=1 t=1.30e-02 per=1.28e+01 cost=2.54e+05 flops=1.95e+07
 sigma_tot counter=52 i=2 t=1.25e-02 per=1.22e+01 cost=2.52e+05 flops=2.02e+07
 sigma_tot counter=52 i=3 t=1.25e-02 per=1.23e+01 cost=2.56e+05 flops=2.04e+07
 sigma_tot counter=52 i=4 t=1.25e-02 per=1.22e+01 cost=3.73e+05 flops=3.00e+07
 sigma_tot counter=52 i=5 t=1.26e-02 per=1.24e+01 cost=3.72e+05 flops=2.94e+07
 sigma_tot counter=52 i=6 t=1.32e-02 per=1.30e+01 cost=4.90e+05 flops=3.70e+07
 sigma_tot counter=52 i=7 t=1.27e-02 per=1.25e+01 cost=4.86e+05 flops=3.82e+07
 total GEMM cost=2.73e+06 flops=2.68e+07
    8   0 +      -2.652081089524  -6.66e-15   6.38e-05    5    15   3.65e-02  2.44e-03
    8   1 +      -2.430689878738  -8.91e-09   3.44e-05    5    15   3.65e-02  2.44e-03
TIMING for Davidson : 3.66e-02  T(cal/comm/rest)=3.60e-02,1.40e-06,5.18e-04
optimized energies: isweep=0 dots=2 ibond=3 e[0]=-2.65208108952
optimized energies: isweep=0 dots=2 ibond=3 e[1]=-2.43068987874
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=11 dimAll=40
 (2,0):9 (3,1):7 (3,-1):6 (4,0):4 (1,1):3 (1,-1):3 (2,2):3 (2,-2):2 (0,0):1 (4,2):1 (3,3):1
decimation summary: 40->10 dwt=+9.505e-03 SvN=1.828e+00
===== CPUmem(GB): tot=1.109e-05 (comb,oper,dvdson,hvec,renorm)=2.138e-06,8.956e-06,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=10,10 size(op)=26:1.984e-04MB size(tot)=775:5.913e-03MB:5.774e-06GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=6.780e-06 (oper)(GB)=6.780e-06
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.300e-05 (oper,qops,site)(GB)=6.780e-06,5.774e-06,4.470e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 3.119e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 3.228e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.37e-05 (oper,qops,site,rinter)(GB)=6.78e-06,5.77e-06,4.47e-07,6.85e-07
----- TIMING FOR preprocess_formulae_Rlist : 0.000484 S size(rtasks)=63 size(Rlst)=677 T(Rmu/Rxlist/sort)=7.81e-05,0.000249,0.000157 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.00018 (oper,qops,site,rinter,batch)(GB)=6.78e-06,5.77e-06,4.47e-07,6.85e-07,0.000166
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000212,0.00116,0.000207 cost=3.91e+04 flops[gemm]=3.36e+07
--- TIMING FOR renorm : t_inter=0.000212 t_gemm=0.00116 t_reduction=0.000206 tot=0.00158 ---
 renorm counter=4 i=0 t=0.00023 per=19.8 cost=1.67e+03 flops=7.27e+06
 renorm counter=4 i=1 t=0.000238 per=20.5 cost=3.78e+03 flops=1.59e+07
 renorm counter=4 i=2 t=0.000225 per=19.3 cost=4.76e+03 flops=2.12e+07
 renorm counter=4 i=3 t=0.000227 per=19.5 cost=8.83e+03 flops=3.89e+07
 renorm counter=4 i=4 t=2e-06 per=0.172 cost=0 flops=0
 renorm counter=4 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=4 i=6 t=0.000241 per=20.7 cost=2.01e+04 flops=8.34e+07
 total GEMM cost=3.91e+04 flops=3.36e+07
--- TIMING FOR renorm_tot : t_inter=0.000413 t_gemm=0.00447 t_reduction=0.000788 tot=0.00567 ---
 renorm_tot counter=4 i=0 t=0.000885 per=19.8 cost=6.81e+03 flops=7.69e+06
 renorm_tot counter=4 i=1 t=0.000912 per=20.4 cost=1.06e+04 flops=1.16e+07
 renorm_tot counter=4 i=2 t=0.000434 per=9.71 cost=5.99e+03 flops=1.38e+07
 renorm_tot counter=4 i=3 t=0.000441 per=9.86 cost=1.09e+04 flops=2.47e+07
 renorm_tot counter=4 i=4 t=0.000426 per=9.53 cost=5.71e+03 flops=1.34e+07
 renorm_tot counter=4 i=5 t=0.00043 per=9.62 cost=1.06e+04 flops=2.46e+07
 renorm_tot counter=4 i=6 t=0.000943 per=21.1 cost=6.71e+04 flops=7.11e+07
 total GEMM cost=1.18e+05 flops=2.63e+07
check ||H-H.dagger||=4.78e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0032 S T(init/kernel/comm)=0.00023,0.003,1.2e-05 rank=0 -----
===== CPUmem(GB): tot=1.1e-05 (comb,oper,dvdson,hvec,renorm)=2.1e-06,9e-06,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=120:0.00092MB:8.9e-07GB
 rwfuns: len=4 mem=16:0.00012MB:1.2e-07GB
 cpsi: len=2 mem=48:0.00037MB:3.6e-07GB
total mem of comb=211:0.0016MB:1.6e-06GB
===== CPUmem(GB): tot=1.6e-05 (comb,oper,dvdson,hvec,renorm)=1.6e-06,1.5e-05,0,0,0 =====
fname=./scratch/sweep/rop(2,0) size=5.77e-06GB T[save](info/data/tot)=5.68e-05,5.37e-05,0.00011 speed=0.0523GB/s disk[used]=5.89e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
##### time_local: 4.51e-02 S #####
 T(fetch) = 4.01e-04 S  per = 0.89  per(accum) = 0.89
 T(hdiag) = 7.79e-05 S  per = 0.17  per(accum) = 1.1
 T(dvdsn) = 3.99e-02 S  per =   88  per(accum) = 90
 T(decim) = 4.83e-04 S  per =  1.1  per(accum) = 91
 T(guess) = 1.35e-04 S  per =  0.3  per(accum) = 91
 T(renrm) = 3.29e-03 S  per =  7.3  per(accum) = 98
 T(save ) = 8.07e-04 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.96e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.30e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 3.10e-04 S  per = 0.78  per(accum) = 0.89
 T(hintermediate init           ) = 2.84e-05 S  per = 0.072  per(accum) = 0.96
 T(hintermediates memcpy cpu2gpu) = 4.89e-06 S  per = 0.012  per(accum) = 0.98
 T(preprocess_hformulae_Hxlist2 ) = 1.61e-03 S  per =  4.1  per(accum) = 5.1
 T(hmmtasks init                ) = 1.05e-03 S  per =  2.7  per(accum) = 7.7
 T(dvdson solver [Hx_batchGPU]  ) = 3.60e-02 S  per =   91  per(accum) = 99
 T(dvdson solver [communication]) = 1.40e-06 S  per = 0.0035  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.18e-04 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(renrm): 3.23e-03 S
 T(qops init                    ) = 2.31e-04 S  per =  7.2  per(accum) = 7.2
 T(qops_dict memcpy cpu2gpu     ) = 4.99e-05 S  per =  1.5  per(accum) = 8.7
 T(symbolic_formulae_renorm     ) = 3.19e-04 S  per =  9.9  per(accum) = 19
 T(rintermediate init           ) = 3.73e-05 S  per =  1.2  per(accum) = 20
 T(rintermediates memcpy cpu2gpu) = 8.70e-06 S  per = 0.27  per(accum) = 20
 T(preprocess_formulae_Rlist2   ) = 4.97e-04 S  per =   15  per(accum) = 35
 T(rmmtasks init                ) = 3.16e-04 S  per =  9.8  per(accum) = 45
 T(qops memset                  ) = 1.03e-05 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 1.71e-03 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.49e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.23e-05 S  per = 0.38  per(accum) = 1e+02
##### time_sweep: 1.67e-01 S #####
 T(fetch) = 1.38e-03 S  per = 0.83  per(accum) = 0.83
 T(hdiag) = 3.59e-04 S  per = 0.22  per(accum) = 1
 T(dvdsn) = 1.49e-01 S  per =   89  per(accum) = 90
 T(decim) = 1.58e-03 S  per = 0.95  per(accum) = 91
 T(guess) = 4.35e-04 S  per = 0.26  per(accum) = 91
 T(renrm) = 1.16e-02 S  per =    7  per(accum) = 98
 T(save ) = 2.57e-03 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.48e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 1.71e-04 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 1.21e-03 S  per = 0.82  per(accum) = 0.93
 T(hintermediate init           ) = 1.24e-04 S  per = 0.084  per(accum) = 1
 T(hintermediates memcpy cpu2gpu) = 2.09e-05 S  per = 0.014  per(accum) = 1
 T(preprocess_hformulae_Hxlist2 ) = 9.11e-03 S  per =  6.2  per(accum) = 7.2
 T(hmmtasks init                ) = 5.97e-03 S  per =    4  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 1.29e-01 S  per =   87  per(accum) = 99
 T(dvdson solver [communication]) = 3.93e-06 S  per = 0.0027  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.87e-03 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.14e-02 S
 T(qops init                    ) = 8.28e-04 S  per =  7.2  per(accum) = 7.2
 T(qops_dict memcpy cpu2gpu     ) = 1.78e-04 S  per =  1.6  per(accum) = 8.8
 T(symbolic_formulae_renorm     ) = 1.04e-03 S  per =  9.1  per(accum) = 18
 T(rintermediate init           ) = 8.81e-05 S  per = 0.77  per(accum) = 19
 T(rintermediates memcpy cpu2gpu) = 2.62e-05 S  per = 0.23  per(accum) = 19
 T(preprocess_formulae_Rlist2   ) = 1.80e-03 S  per =   16  per(accum) = 35
 T(rmmtasks init                ) = 1.17e-03 S  per =   10  per(accum) = 45
 T(qops memset                  ) = 3.97e-05 S  per = 0.35  per(accum) = 45
 T(preprocess_renorm_batchGPU   ) = 6.08e-03 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.27e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 4.21e-05 S  per = 0.37  per(accum) = 1e+02
##### time_global: 1.67e-01 S #####
 T(fetch) = 1.38e-03 S  per = 0.83  per(accum) = 0.83
 T(hdiag) = 3.59e-04 S  per = 0.22  per(accum) = 1
 T(dvdsn) = 1.49e-01 S  per =   89  per(accum) = 90
 T(decim) = 1.58e-03 S  per = 0.95  per(accum) = 91
 T(guess) = 4.35e-04 S  per = 0.26  per(accum) = 91
 T(renrm) = 1.16e-02 S  per =    7  per(accum) = 98
 T(save ) = 2.57e-03 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.48e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 1.71e-04 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 1.21e-03 S  per = 0.82  per(accum) = 0.93
 T(hintermediate init           ) = 1.24e-04 S  per = 0.084  per(accum) = 1
 T(hintermediates memcpy cpu2gpu) = 2.09e-05 S  per = 0.014  per(accum) = 1
 T(preprocess_hformulae_Hxlist2 ) = 9.11e-03 S  per =  6.2  per(accum) = 7.2
 T(hmmtasks init                ) = 5.97e-03 S  per =    4  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 1.29e-01 S  per =   87  per(accum) = 99
 T(dvdson solver [communication]) = 3.93e-06 S  per = 0.0027  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.87e-03 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.14e-02 S
 T(qops init                    ) = 8.28e-04 S  per =  7.2  per(accum) = 7.2
 T(qops_dict memcpy cpu2gpu     ) = 1.78e-04 S  per =  1.6  per(accum) = 8.8
 T(symbolic_formulae_renorm     ) = 1.04e-03 S  per =  9.1  per(accum) = 18
 T(rintermediate init           ) = 8.81e-05 S  per = 0.77  per(accum) = 19
 T(rintermediates memcpy cpu2gpu) = 2.62e-05 S  per = 0.23  per(accum) = 19
 T(preprocess_formulae_Rlist2   ) = 1.80e-03 S  per =   16  per(accum) = 35
 T(rmmtasks init                ) = 1.17e-03 S  per =   10  per(accum) = 45
 T(qops memset                  ) = 3.97e-05 S  per = 0.35  per(accum) = 45
 T(preprocess_renorm_batchGPU   ) = 6.08e-03 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.27e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 4.21e-05 S  per = 0.37  per(accum) = 1e+02

======================================================================
sweep_data::summary isweep=0
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0.0001
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=10 dwt=+2.890e-03 nmvp=2 e[0]=-2.65451696694 e[1]=-2.27865402598 t=0.016
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=10 dwt=+9.637e-03 nmvp=20 e[0]=-2.65109283038 e[1]=-2.42764318335 t=0.06
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=10 dwt=+1.379e-03 nmvp=15 e[0]=-2.65109282733 e[1]=-2.42764318258 t=0.046
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=10 dwt=+9.505e-03 nmvp=15 e[0]=-2.65208108952 e[1]=-2.43068987874 t=0.045
 eav_max=-2.46658549646 [ibond=0]  dwt_min=1.379e-03 [ibond=2]
 eav_min=-2.54138548413 [ibond=3]  dwt_max=9.637e-03 [ibond=1]
 eav_diff=0.0747999876727
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+9.505e-03 e[0]=-2.65208108952
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+9.505e-03 e[1]=-2.43068987874
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.00e-04 1.00e-04 | 52 | 1.69e-01 | 1.69e-01 | 1.10e-02 1.06e-01 1.11e-02 1.28e-01 76.1
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.50e-03 e[0]=-2.65208108952 (0.00e+00) e[1]=-2.43068987874 (0.00e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep0.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_C0R1.txt
 qbond: qsuper nsym=9 dimAll=40
 (3,1):10 (4,0):6 (2,0):5 (4,2):5 (2,2):4 (5,1):3 (3,-1):3 (1,1):2 (3,3):2
decimation summary: 40->8 dwt=+0.000e+00 SvN=1.265e+00

Convert [C]RRR => [cR]RRR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00

ctns::rcanon_save fname=./scratch/rcanon_isweep0.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Drow=10 maxdiff=1.16e-15
 idx=2 node=(2,0) Drow=10 maxdiff=1.48e-15
 idx=3 node=(1,0) Drow=8 maxdiff=1.01e-15
 idx=4 node=(0,0) Drow=2 maxdiff=4.97e-16
stensor2: wf2 own=1 _data=0x448f8360
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.05e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x448f8360
      1.0000e+00      -1.5995e-17 
     -4.5427e-17       1.0000e+00 
 rwfuns: nroots=2 maxdiff=8.0529e-16
----- TIMING FOR ctns::rcanon_check : 1.304e-04 S -----
..... end of isweep = 0 .....

======================================================================
sweep parameters: isweep=1 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=142:0.00108MB:1.06e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=221:0.00169MB:1.65e-06GB

isweep=1 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.622e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=764:0.00583MB:5.69e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1202:0.00917MB:8.96e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=142:0.00108MB:1.06e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=221:0.00169MB:1.65e-06GB
===== CPUmem(GB): tot=1.64e-05 (comb,oper,dvdson,hvec,renorm)=1.65e-06,1.47e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,10,4,4) nnz=72:0.000549MB
stensor4: wf own=1 _data=0x4492b890
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=5 dimAll=10
 (2,0):4 (1,1):2 (1,-1):2 (0,0):1 (2,2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=33 nblocks=320 size=72:0.000549MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=8.96e-06 (oper)(GB)=8.96e-06
----- TIMING FOR symbolic_formulae_twodot with size=188 : 3.086e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 2.427e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=9.64e-06 (oper,hinter)(GB)=8.96e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.0016 S size(H_formulae)=188 size(Hxlst)=3136 T(Hmu/Hxlist/sort)=7.29e-05,0.000784,0.000742 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000408 (oper,hinter,dvdson,batch)(GB)=8.96e-06,6.85e-07,1.07e-06,0.000397
===== CPUmem(GB): tot=2.71e-05 (comb,oper,dvdson,hvec,renorm)=1.65e-06,1.47e-05,1.07e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=72 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.8e-05,0.000204,0.00187,0.000196 cost=4.52e+04 flops[gemm]=2.42e+07
--- TIMING FOR sigma : t_inter=0.000203 t_gemm=0.00187 t_reduction=0.000196 tot=0.00226 ---
 sigma counter=53 i=0 t=0.000234 per=12.5 cost=3.82e+03 flops=1.63e+07
 sigma counter=53 i=1 t=0.00023 per=12.3 cost=4.32e+03 flops=1.88e+07
 sigma counter=53 i=2 t=0.000235 per=12.6 cost=3.83e+03 flops=1.63e+07
 sigma counter=53 i=3 t=0.00023 per=12.3 cost=4.12e+03 flops=1.79e+07
 sigma counter=53 i=4 t=0.000235 per=12.6 cost=1.06e+04 flops=4.5e+07
 sigma counter=53 i=5 t=0.000235 per=12.6 cost=1.06e+04 flops=4.5e+07
 sigma counter=53 i=6 t=0.000237 per=12.7 cost=4.12e+03 flops=1.74e+07
 sigma counter=53 i=7 t=0.00023 per=12.3 cost=3.83e+03 flops=1.67e+07
 total GEMM cost=4.52e+04 flops=2.42e+07
--- TIMING FOR sigma_tot : t_inter=0.0108 t_gemm=0.104 t_reduction=0.0105 tot=0.125 ---
 sigma_tot counter=53 i=0 t=0.0129 per=12.5 cost=2.52e+05 flops=1.95e+07
 sigma_tot counter=53 i=1 t=0.0132 per=12.8 cost=2.59e+05 flops=1.95e+07
 sigma_tot counter=53 i=2 t=0.0127 per=12.3 cost=2.56e+05 flops=2.02e+07
 sigma_tot counter=53 i=3 t=0.0128 per=12.3 cost=2.6e+05 flops=2.03e+07
 sigma_tot counter=53 i=4 t=0.0127 per=12.2 cost=3.84e+05 flops=3.03e+07
 sigma_tot counter=53 i=5 t=0.0129 per=12.4 cost=3.82e+05 flops=2.97e+07
 sigma_tot counter=53 i=6 t=0.0135 per=13 cost=4.94e+05 flops=3.67e+07
 sigma_tot counter=53 i=7 t=0.0129 per=12.5 cost=4.9e+05 flops=3.78e+07
 total GEMM cost=2.78e+06 flops=2.68e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.9e-05,0.000196,0.00186,0.000192 cost=4.52e+04 flops[gemm]=2.43e+07
--- TIMING FOR sigma : t_inter=0.000196 t_gemm=0.00186 t_reduction=0.000192 tot=0.00224 ---
 sigma counter=54 i=0 t=0.000233 per=12.6 cost=3.82e+03 flops=1.64e+07
 sigma counter=54 i=1 t=0.000231 per=12.4 cost=4.32e+03 flops=1.87e+07
 sigma counter=54 i=2 t=0.000228 per=12.3 cost=3.83e+03 flops=1.68e+07
 sigma counter=54 i=3 t=0.000228 per=12.3 cost=4.12e+03 flops=1.81e+07
 sigma counter=54 i=4 t=0.000233 per=12.6 cost=1.06e+04 flops=4.54e+07
 sigma counter=54 i=5 t=0.00024 per=12.9 cost=1.06e+04 flops=4.4e+07
 sigma counter=54 i=6 t=0.000235 per=12.7 cost=4.12e+03 flops=1.75e+07
 sigma counter=54 i=7 t=0.000228 per=12.3 cost=3.83e+03 flops=1.68e+07
 total GEMM cost=4.52e+04 flops=2.43e+07
--- TIMING FOR sigma_tot : t_inter=0.0109 t_gemm=0.106 t_reduction=0.0107 tot=0.127 ---
 sigma_tot counter=54 i=0 t=0.0132 per=12.5 cost=2.56e+05 flops=1.94e+07
 sigma_tot counter=54 i=1 t=0.0135 per=12.8 cost=2.63e+05 flops=1.95e+07
 sigma_tot counter=54 i=2 t=0.0129 per=12.3 cost=2.6e+05 flops=2.01e+07
 sigma_tot counter=54 i=3 t=0.013 per=12.3 cost=2.64e+05 flops=2.03e+07
 sigma_tot counter=54 i=4 t=0.0129 per=12.2 cost=3.94e+05 flops=3.05e+07
 sigma_tot counter=54 i=5 t=0.0131 per=12.4 cost=3.93e+05 flops=3e+07
 sigma_tot counter=54 i=6 t=0.0137 per=13 cost=4.98e+05 flops=3.63e+07
 sigma_tot counter=54 i=7 t=0.0132 per=12.5 cost=4.93e+05 flops=3.75e+07
 total GEMM cost=2.82e+06 flops=2.67e+07
settings: ndim=72 neig=2 maxcycle=30 nbuff=4 memory=9.66e-06GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.641998458071  -1.00e+03   1.43e-01    2     2   4.80e-03  2.40e-03
    1   1 -      -2.409549170479  -1.00e+03   1.87e-01    2     2   4.80e-03  2.40e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.10e-05,2.08e-04,1.86e-03,1.96e-04 cost=4.52e+04 flops[gemm]=2.43e+07
--- TIMING FOR sigma : t_inter=2.08e-04 t_gemm=1.86e-03 t_reduction=1.96e-04 tot=2.26e-03 ---
 sigma counter=55 i=0 t=2.31e-04 per=1.24e+01 cost=3.82e+03 flops=1.65e+07
 sigma counter=55 i=1 t=2.30e-04 per=1.24e+01 cost=4.32e+03 flops=1.88e+07
 sigma counter=55 i=2 t=2.34e-04 per=1.26e+01 cost=3.83e+03 flops=1.64e+07
 sigma counter=55 i=3 t=2.30e-04 per=1.24e+01 cost=4.12e+03 flops=1.79e+07
 sigma counter=55 i=4 t=2.33e-04 per=1.26e+01 cost=1.06e+04 flops=4.54e+07
 sigma counter=55 i=5 t=2.36e-04 per=1.27e+01 cost=1.06e+04 flops=4.48e+07
 sigma counter=55 i=6 t=2.34e-04 per=1.26e+01 cost=4.12e+03 flops=1.76e+07
 sigma counter=55 i=7 t=2.28e-04 per=1.23e+01 cost=3.83e+03 flops=1.68e+07
 total GEMM cost=4.52e+04 flops=2.43e+07
--- TIMING FOR sigma_tot : t_inter=1.12e-02 t_gemm=1.07e-01 t_reduction=1.09e-02 tot=1.29e-01 ---
 sigma_tot counter=55 i=0 t=1.34e-02 per=1.25e+01 cost=2.60e+05 flops=1.94e+07
 sigma_tot counter=55 i=1 t=1.37e-02 per=1.28e+01 cost=2.67e+05 flops=1.95e+07
 sigma_tot counter=55 i=2 t=1.32e-02 per=1.23e+01 cost=2.64e+05 flops=2.00e+07
 sigma_tot counter=55 i=3 t=1.32e-02 per=1.23e+01 cost=2.68e+05 flops=2.02e+07
 sigma_tot counter=55 i=4 t=1.32e-02 per=1.23e+01 cost=4.05e+05 flops=3.08e+07
 sigma_tot counter=55 i=5 t=1.33e-02 per=1.24e+01 cost=4.03e+05 flops=3.02e+07
 sigma_tot counter=55 i=6 t=1.40e-02 per=1.30e+01 cost=5.02e+05 flops=3.60e+07
 sigma_tot counter=55 i=7 t=1.34e-02 per=1.25e+01 cost=4.97e+05 flops=3.71e+07
 total GEMM cost=2.87e+06 flops=2.67e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.92e-04,1.84e-03,1.94e-04 cost=4.52e+04 flops[gemm]=2.46e+07
--- TIMING FOR sigma : t_inter=1.92e-04 t_gemm=1.84e-03 t_reduction=1.94e-04 tot=2.22e-03 ---
 sigma counter=56 i=0 t=2.28e-04 per=1.24e+01 cost=3.82e+03 flops=1.68e+07
 sigma counter=56 i=1 t=2.32e-04 per=1.26e+01 cost=4.32e+03 flops=1.86e+07
 sigma counter=56 i=2 t=2.26e-04 per=1.23e+01 cost=3.83e+03 flops=1.70e+07
 sigma counter=56 i=3 t=2.27e-04 per=1.24e+01 cost=4.12e+03 flops=1.82e+07
 sigma counter=56 i=4 t=2.31e-04 per=1.26e+01 cost=1.06e+04 flops=4.57e+07
 sigma counter=56 i=5 t=2.35e-04 per=1.28e+01 cost=1.06e+04 flops=4.50e+07
 sigma counter=56 i=6 t=2.31e-04 per=1.26e+01 cost=4.12e+03 flops=1.78e+07
 sigma counter=56 i=7 t=2.25e-04 per=1.23e+01 cost=3.83e+03 flops=1.70e+07
 total GEMM cost=4.52e+04 flops=2.46e+07
--- TIMING FOR sigma_tot : t_inter=1.13e-02 t_gemm=1.09e-01 t_reduction=1.11e-02 tot=1.32e-01 ---
 sigma_tot counter=56 i=0 t=1.36e-02 per=1.25e+01 cost=2.64e+05 flops=1.93e+07
 sigma_tot counter=56 i=1 t=1.39e-02 per=1.28e+01 cost=2.71e+05 flops=1.95e+07
 sigma_tot counter=56 i=2 t=1.34e-02 per=1.23e+01 cost=2.68e+05 flops=2.00e+07
 sigma_tot counter=56 i=3 t=1.35e-02 per=1.23e+01 cost=2.72e+05 flops=2.02e+07
 sigma_tot counter=56 i=4 t=1.34e-02 per=1.23e+01 cost=4.16e+05 flops=3.10e+07
 sigma_tot counter=56 i=5 t=1.36e-02 per=1.24e+01 cost=4.14e+05 flops=3.05e+07
 sigma_tot counter=56 i=6 t=1.42e-02 per=1.30e+01 cost=5.07e+05 flops=3.57e+07
 sigma_tot counter=56 i=7 t=1.36e-02 per=1.25e+01 cost=5.01e+05 flops=3.68e+07
 total GEMM cost=2.91e+06 flops=2.67e+07
    2   0 -      -2.651381055680  -9.38e-03   3.40e-02    4     4   9.59e-03  2.40e-03
    2   1 -      -2.428926260058  -1.94e-02   5.14e-02    4     4   9.59e-03  2.40e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,1.94e-04,1.89e-03,1.98e-04 cost=4.52e+04 flops[gemm]=2.39e+07
--- TIMING FOR sigma : t_inter=1.94e-04 t_gemm=1.89e-03 t_reduction=1.98e-04 tot=2.28e-03 ---
 sigma counter=57 i=0 t=2.31e-04 per=1.22e+01 cost=3.82e+03 flops=1.65e+07
 sigma counter=57 i=1 t=2.33e-04 per=1.23e+01 cost=4.32e+03 flops=1.85e+07
 sigma counter=57 i=2 t=2.30e-04 per=1.22e+01 cost=3.83e+03 flops=1.67e+07
 sigma counter=57 i=3 t=2.35e-04 per=1.24e+01 cost=4.12e+03 flops=1.75e+07
 sigma counter=57 i=4 t=2.48e-04 per=1.31e+01 cost=1.06e+04 flops=4.26e+07
 sigma counter=57 i=5 t=2.34e-04 per=1.24e+01 cost=1.06e+04 flops=4.52e+07
 sigma counter=57 i=6 t=2.35e-04 per=1.24e+01 cost=4.12e+03 flops=1.75e+07
 sigma counter=57 i=7 t=2.42e-04 per=1.28e+01 cost=3.83e+03 flops=1.58e+07
 total GEMM cost=4.52e+04 flops=2.39e+07
--- TIMING FOR sigma_tot : t_inter=1.15e-02 t_gemm=1.11e-01 t_reduction=1.13e-02 tot=1.34e-01 ---
 sigma_tot counter=57 i=0 t=1.39e-02 per=1.25e+01 cost=2.67e+05 flops=1.93e+07
 sigma_tot counter=57 i=1 t=1.42e-02 per=1.28e+01 cost=2.76e+05 flops=1.95e+07
 sigma_tot counter=57 i=2 t=1.36e-02 per=1.23e+01 cost=2.71e+05 flops=1.99e+07
 sigma_tot counter=57 i=3 t=1.37e-02 per=1.23e+01 cost=2.76e+05 flops=2.02e+07
 sigma_tot counter=57 i=4 t=1.36e-02 per=1.23e+01 cost=4.26e+05 flops=3.13e+07
 sigma_tot counter=57 i=5 t=1.38e-02 per=1.24e+01 cost=4.25e+05 flops=3.07e+07
 sigma_tot counter=57 i=6 t=1.44e-02 per=1.30e+01 cost=5.11e+05 flops=3.54e+07
 sigma_tot counter=57 i=7 t=1.39e-02 per=1.25e+01 cost=5.05e+05 flops=3.64e+07
 total GEMM cost=2.96e+06 flops=2.66e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.94e-04,1.86e-03,1.93e-04 cost=4.52e+04 flops[gemm]=2.43e+07
--- TIMING FOR sigma : t_inter=1.94e-04 t_gemm=1.86e-03 t_reduction=1.93e-04 tot=2.24e-03 ---
 sigma counter=58 i=0 t=2.32e-04 per=1.25e+01 cost=3.82e+03 flops=1.65e+07
 sigma counter=58 i=1 t=2.30e-04 per=1.24e+01 cost=4.32e+03 flops=1.88e+07
 sigma counter=58 i=2 t=2.31e-04 per=1.24e+01 cost=3.83e+03 flops=1.66e+07
 sigma counter=58 i=3 t=2.30e-04 per=1.24e+01 cost=4.12e+03 flops=1.79e+07
 sigma counter=58 i=4 t=2.33e-04 per=1.26e+01 cost=1.06e+04 flops=4.54e+07
 sigma counter=58 i=5 t=2.36e-04 per=1.27e+01 cost=1.06e+04 flops=4.48e+07
 sigma counter=58 i=6 t=2.35e-04 per=1.27e+01 cost=4.12e+03 flops=1.75e+07
 sigma counter=58 i=7 t=2.29e-04 per=1.23e+01 cost=3.83e+03 flops=1.67e+07
 total GEMM cost=4.52e+04 flops=2.43e+07
--- TIMING FOR sigma_tot : t_inter=1.17e-02 t_gemm=1.13e-01 t_reduction=1.15e-02 tot=1.36e-01 ---
 sigma_tot counter=58 i=0 t=1.41e-02 per=1.25e+01 cost=2.71e+05 flops=1.93e+07
 sigma_tot counter=58 i=1 t=1.44e-02 per=1.28e+01 cost=2.80e+05 flops=1.94e+07
 sigma_tot counter=58 i=2 t=1.39e-02 per=1.23e+01 cost=2.75e+05 flops=1.99e+07
 sigma_tot counter=58 i=3 t=1.39e-02 per=1.23e+01 cost=2.80e+05 flops=2.01e+07
 sigma_tot counter=58 i=4 t=1.39e-02 per=1.23e+01 cost=4.37e+05 flops=3.15e+07
 sigma_tot counter=58 i=5 t=1.41e-02 per=1.24e+01 cost=4.35e+05 flops=3.10e+07
 sigma_tot counter=58 i=6 t=1.47e-02 per=1.30e+01 cost=5.15e+05 flops=3.51e+07
 sigma_tot counter=58 i=7 t=1.41e-02 per=1.25e+01 cost=5.09e+05 flops=3.61e+07
 total GEMM cost=3.00e+06 flops=2.66e+07
    3   0 -      -2.652042676037  -6.62e-04   6.55e-03    6     6   1.44e-02  2.40e-03
    3   1 -      -2.430569433550  -1.64e-03   1.22e-02    6     6   1.44e-02  2.40e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,1.98e-04,1.87e-03,1.94e-04 cost=4.52e+04 flops[gemm]=2.42e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.87e-03 t_reduction=1.94e-04 tot=2.26e-03 ---
 sigma counter=59 i=0 t=2.36e-04 per=1.26e+01 cost=3.82e+03 flops=1.62e+07
 sigma counter=59 i=1 t=2.33e-04 per=1.25e+01 cost=4.32e+03 flops=1.85e+07
 sigma counter=59 i=2 t=2.35e-04 per=1.26e+01 cost=3.83e+03 flops=1.63e+07
 sigma counter=59 i=3 t=2.29e-04 per=1.23e+01 cost=4.12e+03 flops=1.80e+07
 sigma counter=59 i=4 t=2.34e-04 per=1.25e+01 cost=1.06e+04 flops=4.52e+07
 sigma counter=59 i=5 t=2.36e-04 per=1.26e+01 cost=1.06e+04 flops=4.48e+07
 sigma counter=59 i=6 t=2.35e-04 per=1.26e+01 cost=4.12e+03 flops=1.75e+07
 sigma counter=59 i=7 t=2.29e-04 per=1.23e+01 cost=3.83e+03 flops=1.67e+07
 total GEMM cost=4.52e+04 flops=2.42e+07
--- TIMING FOR sigma_tot : t_inter=1.19e-02 t_gemm=1.15e-01 t_reduction=1.17e-02 tot=1.38e-01 ---
 sigma_tot counter=59 i=0 t=1.43e-02 per=1.25e+01 cost=2.75e+05 flops=1.92e+07
 sigma_tot counter=59 i=1 t=1.46e-02 per=1.27e+01 cost=2.84e+05 flops=1.94e+07
 sigma_tot counter=59 i=2 t=1.41e-02 per=1.23e+01 cost=2.79e+05 flops=1.98e+07
 sigma_tot counter=59 i=3 t=1.42e-02 per=1.23e+01 cost=2.84e+05 flops=2.01e+07
 sigma_tot counter=59 i=4 t=1.41e-02 per=1.23e+01 cost=4.47e+05 flops=3.17e+07
 sigma_tot counter=59 i=5 t=1.43e-02 per=1.24e+01 cost=4.46e+05 flops=3.12e+07
 sigma_tot counter=59 i=6 t=1.49e-02 per=1.30e+01 cost=5.19e+05 flops=3.49e+07
 sigma_tot counter=59 i=7 t=1.43e-02 per=1.25e+01 cost=5.13e+05 flops=3.58e+07
 total GEMM cost=3.05e+06 flops=2.65e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.93e-04,1.87e-03,1.92e-04 cost=4.52e+04 flops[gemm]=2.42e+07
--- TIMING FOR sigma : t_inter=1.93e-04 t_gemm=1.87e-03 t_reduction=1.92e-04 tot=2.25e-03 ---
 sigma counter=60 i=0 t=2.32e-04 per=1.24e+01 cost=3.82e+03 flops=1.65e+07
 sigma counter=60 i=1 t=2.30e-04 per=1.23e+01 cost=4.32e+03 flops=1.88e+07
 sigma counter=60 i=2 t=2.30e-04 per=1.23e+01 cost=3.83e+03 flops=1.67e+07
 sigma counter=60 i=3 t=2.36e-04 per=1.27e+01 cost=4.12e+03 flops=1.75e+07
 sigma counter=60 i=4 t=2.35e-04 per=1.26e+01 cost=1.06e+04 flops=4.50e+07
 sigma counter=60 i=5 t=2.36e-04 per=1.27e+01 cost=1.06e+04 flops=4.48e+07
 sigma counter=60 i=6 t=2.35e-04 per=1.26e+01 cost=4.12e+03 flops=1.75e+07
 sigma counter=60 i=7 t=2.31e-04 per=1.24e+01 cost=3.83e+03 flops=1.66e+07
 total GEMM cost=4.52e+04 flops=2.42e+07
--- TIMING FOR sigma_tot : t_inter=1.21e-02 t_gemm=1.17e-01 t_reduction=1.19e-02 tot=1.41e-01 ---
 sigma_tot counter=60 i=0 t=1.46e-02 per=1.25e+01 cost=2.79e+05 flops=1.92e+07
 sigma_tot counter=60 i=1 t=1.49e-02 per=1.27e+01 cost=2.89e+05 flops=1.94e+07
 sigma_tot counter=60 i=2 t=1.43e-02 per=1.23e+01 cost=2.83e+05 flops=1.98e+07
 sigma_tot counter=60 i=3 t=1.44e-02 per=1.23e+01 cost=2.89e+05 flops=2.00e+07
 sigma_tot counter=60 i=4 t=1.43e-02 per=1.23e+01 cost=4.58e+05 flops=3.19e+07
 sigma_tot counter=60 i=5 t=1.45e-02 per=1.24e+01 cost=4.56e+05 flops=3.14e+07
 sigma_tot counter=60 i=6 t=1.51e-02 per=1.30e+01 cost=5.23e+05 flops=3.46e+07
 sigma_tot counter=60 i=7 t=1.46e-02 per=1.25e+01 cost=5.16e+05 flops=3.55e+07
 total GEMM cost=3.09e+06 flops=2.65e+07
    4   0 -      -2.652077167029  -3.45e-05   1.94e-03    6     8   1.92e-02  2.40e-03
    4   1 -      -2.430677272750  -1.08e-04   3.53e-03    6     8   1.92e-02  2.40e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.95e-04,1.87e-03,1.93e-04 cost=4.52e+04 flops[gemm]=2.41e+07
--- TIMING FOR sigma : t_inter=1.95e-04 t_gemm=1.88e-03 t_reduction=1.93e-04 tot=2.26e-03 ---
 sigma counter=61 i=0 t=2.31e-04 per=1.23e+01 cost=3.82e+03 flops=1.65e+07
 sigma counter=61 i=1 t=2.34e-04 per=1.25e+01 cost=4.32e+03 flops=1.85e+07
 sigma counter=61 i=2 t=2.30e-04 per=1.23e+01 cost=3.83e+03 flops=1.67e+07
 sigma counter=61 i=3 t=2.31e-04 per=1.23e+01 cost=4.12e+03 flops=1.78e+07
 sigma counter=61 i=4 t=2.32e-04 per=1.24e+01 cost=1.06e+04 flops=4.56e+07
 sigma counter=61 i=5 t=2.40e-04 per=1.28e+01 cost=1.06e+04 flops=4.40e+07
 sigma counter=61 i=6 t=2.35e-04 per=1.25e+01 cost=4.12e+03 flops=1.75e+07
 sigma counter=61 i=7 t=2.42e-04 per=1.29e+01 cost=3.83e+03 flops=1.58e+07
 total GEMM cost=4.52e+04 flops=2.41e+07
--- TIMING FOR sigma_tot : t_inter=1.23e-02 t_gemm=1.19e-01 t_reduction=1.20e-02 tot=1.43e-01 ---
 sigma_tot counter=61 i=0 t=1.48e-02 per=1.25e+01 cost=2.83e+05 flops=1.91e+07
 sigma_tot counter=61 i=1 t=1.51e-02 per=1.27e+01 cost=2.93e+05 flops=1.94e+07
 sigma_tot counter=61 i=2 t=1.45e-02 per=1.23e+01 cost=2.87e+05 flops=1.97e+07
 sigma_tot counter=61 i=3 t=1.46e-02 per=1.23e+01 cost=2.93e+05 flops=2.00e+07
 sigma_tot counter=61 i=4 t=1.46e-02 per=1.23e+01 cost=4.68e+05 flops=3.22e+07
 sigma_tot counter=61 i=5 t=1.48e-02 per=1.25e+01 cost=4.67e+05 flops=3.16e+07
 sigma_tot counter=61 i=6 t=1.54e-02 per=1.30e+01 cost=5.27e+05 flops=3.43e+07
 sigma_tot counter=61 i=7 t=1.48e-02 per=1.25e+01 cost=5.20e+05 flops=3.52e+07
 total GEMM cost=3.14e+06 flops=2.65e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.96e-04,1.84e-03,1.91e-04 cost=4.52e+04 flops[gemm]=2.45e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.84e-03 t_reduction=1.91e-04 tot=2.23e-03 ---
 sigma counter=62 i=0 t=2.31e-04 per=1.25e+01 cost=3.82e+03 flops=1.65e+07
 sigma counter=62 i=1 t=2.32e-04 per=1.26e+01 cost=4.32e+03 flops=1.86e+07
 sigma counter=62 i=2 t=2.31e-04 per=1.25e+01 cost=3.83e+03 flops=1.66e+07
 sigma counter=62 i=3 t=2.26e-04 per=1.23e+01 cost=4.12e+03 flops=1.82e+07
 sigma counter=62 i=4 t=2.35e-04 per=1.27e+01 cost=1.06e+04 flops=4.50e+07
 sigma counter=62 i=5 t=2.32e-04 per=1.26e+01 cost=1.06e+04 flops=4.56e+07
 sigma counter=62 i=6 t=2.31e-04 per=1.25e+01 cost=4.12e+03 flops=1.78e+07
 sigma counter=62 i=7 t=2.26e-04 per=1.23e+01 cost=3.83e+03 flops=1.70e+07
 total GEMM cost=4.52e+04 flops=2.45e+07
--- TIMING FOR sigma_tot : t_inter=1.25e-02 t_gemm=1.20e-01 t_reduction=1.22e-02 tot=1.45e-01 ---
 sigma_tot counter=62 i=0 t=1.50e-02 per=1.25e+01 cost=2.87e+05 flops=1.91e+07
 sigma_tot counter=62 i=1 t=1.53e-02 per=1.27e+01 cost=2.97e+05 flops=1.94e+07
 sigma_tot counter=62 i=2 t=1.48e-02 per=1.23e+01 cost=2.91e+05 flops=1.97e+07
 sigma_tot counter=62 i=3 t=1.49e-02 per=1.23e+01 cost=2.97e+05 flops=2.00e+07
 sigma_tot counter=62 i=4 t=1.48e-02 per=1.23e+01 cost=4.79e+05 flops=3.24e+07
 sigma_tot counter=62 i=5 t=1.50e-02 per=1.25e+01 cost=4.77e+05 flops=3.18e+07
 sigma_tot counter=62 i=6 t=1.56e-02 per=1.29e+01 cost=5.31e+05 flops=3.41e+07
 sigma_tot counter=62 i=7 t=1.50e-02 per=1.25e+01 cost=5.24e+05 flops=3.49e+07
 total GEMM cost=3.18e+06 flops=2.64e+07
    5   0 -      -2.652080298591  -3.13e-06   9.85e-04    6    10   2.40e-02  2.40e-03
    5   1 -      -2.430686752248  -9.48e-06   1.83e-03    6    10   2.40e-02  2.40e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.95e-04,1.84e-03,1.91e-04 cost=4.52e+04 flops[gemm]=2.45e+07
--- TIMING FOR sigma : t_inter=1.95e-04 t_gemm=1.84e-03 t_reduction=1.91e-04 tot=2.23e-03 ---
 sigma counter=63 i=0 t=2.28e-04 per=1.24e+01 cost=3.82e+03 flops=1.68e+07
 sigma counter=63 i=1 t=2.28e-04 per=1.24e+01 cost=4.32e+03 flops=1.89e+07
 sigma counter=63 i=2 t=2.38e-04 per=1.29e+01 cost=3.83e+03 flops=1.61e+07
 sigma counter=63 i=3 t=2.26e-04 per=1.23e+01 cost=4.12e+03 flops=1.82e+07
 sigma counter=63 i=4 t=2.31e-04 per=1.25e+01 cost=1.06e+04 flops=4.57e+07
 sigma counter=63 i=5 t=2.32e-04 per=1.26e+01 cost=1.06e+04 flops=4.56e+07
 sigma counter=63 i=6 t=2.34e-04 per=1.27e+01 cost=4.12e+03 flops=1.76e+07
 sigma counter=63 i=7 t=2.26e-04 per=1.23e+01 cost=3.83e+03 flops=1.70e+07
 total GEMM cost=4.52e+04 flops=2.45e+07
--- TIMING FOR sigma_tot : t_inter=1.27e-02 t_gemm=1.22e-01 t_reduction=1.24e-02 tot=1.47e-01 ---
 sigma_tot counter=63 i=0 t=1.52e-02 per=1.25e+01 cost=2.90e+05 flops=1.90e+07
 sigma_tot counter=63 i=1 t=1.56e-02 per=1.27e+01 cost=3.02e+05 flops=1.94e+07
 sigma_tot counter=63 i=2 t=1.50e-02 per=1.23e+01 cost=2.94e+05 flops=1.96e+07
 sigma_tot counter=63 i=3 t=1.51e-02 per=1.23e+01 cost=3.01e+05 flops=2.00e+07
 sigma_tot counter=63 i=4 t=1.50e-02 per=1.23e+01 cost=4.90e+05 flops=3.26e+07
 sigma_tot counter=63 i=5 t=1.52e-02 per=1.25e+01 cost=4.88e+05 flops=3.20e+07
 sigma_tot counter=63 i=6 t=1.58e-02 per=1.29e+01 cost=5.35e+05 flops=3.38e+07
 sigma_tot counter=63 i=7 t=1.52e-02 per=1.25e+01 cost=5.28e+05 flops=3.46e+07
 total GEMM cost=3.23e+06 flops=2.64e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.93e-04,1.84e-03,1.93e-04 cost=4.52e+04 flops[gemm]=2.46e+07
--- TIMING FOR sigma : t_inter=1.93e-04 t_gemm=1.84e-03 t_reduction=1.93e-04 tot=2.22e-03 ---
 sigma counter=64 i=0 t=2.27e-04 per=1.23e+01 cost=3.82e+03 flops=1.68e+07
 sigma counter=64 i=1 t=2.43e-04 per=1.32e+01 cost=4.32e+03 flops=1.78e+07
 sigma counter=64 i=2 t=2.25e-04 per=1.22e+01 cost=3.83e+03 flops=1.70e+07
 sigma counter=64 i=3 t=2.26e-04 per=1.23e+01 cost=4.12e+03 flops=1.82e+07
 sigma counter=64 i=4 t=2.28e-04 per=1.24e+01 cost=1.06e+04 flops=4.64e+07
 sigma counter=64 i=5 t=2.33e-04 per=1.27e+01 cost=1.06e+04 flops=4.54e+07
 sigma counter=64 i=6 t=2.32e-04 per=1.26e+01 cost=4.12e+03 flops=1.78e+07
 sigma counter=64 i=7 t=2.25e-04 per=1.22e+01 cost=3.83e+03 flops=1.70e+07
 total GEMM cost=4.52e+04 flops=2.46e+07
--- TIMING FOR sigma_tot : t_inter=1.29e-02 t_gemm=1.24e-01 t_reduction=1.26e-02 tot=1.50e-01 ---
 sigma_tot counter=64 i=0 t=1.55e-02 per=1.25e+01 cost=2.94e+05 flops=1.90e+07
 sigma_tot counter=64 i=1 t=1.58e-02 per=1.27e+01 cost=3.06e+05 flops=1.94e+07
 sigma_tot counter=64 i=2 t=1.52e-02 per=1.23e+01 cost=2.98e+05 flops=1.96e+07
 sigma_tot counter=64 i=3 t=1.53e-02 per=1.23e+01 cost=3.05e+05 flops=1.99e+07
 sigma_tot counter=64 i=4 t=1.53e-02 per=1.23e+01 cost=5.00e+05 flops=3.28e+07
 sigma_tot counter=64 i=5 t=1.55e-02 per=1.25e+01 cost=4.99e+05 flops=3.22e+07
 sigma_tot counter=64 i=6 t=1.61e-02 per=1.29e+01 cost=5.40e+05 flops=3.36e+07
 sigma_tot counter=64 i=7 t=1.55e-02 per=1.25e+01 cost=5.32e+05 flops=3.44e+07
 total GEMM cost=3.27e+06 flops=2.64e+07
    6   0 -      -2.652081027011  -7.28e-07   3.12e-04    6    12   2.87e-02  2.39e-03
    6   1 -      -2.430689426190  -2.67e-06   7.42e-04    6    12   2.87e-02  2.39e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.94e-04,1.86e-03,1.94e-04 cost=4.52e+04 flops[gemm]=2.43e+07
--- TIMING FOR sigma : t_inter=1.93e-04 t_gemm=1.86e-03 t_reduction=1.94e-04 tot=2.25e-03 ---
 sigma counter=65 i=0 t=2.28e-04 per=1.23e+01 cost=3.82e+03 flops=1.68e+07
 sigma counter=65 i=1 t=2.27e-04 per=1.22e+01 cost=4.32e+03 flops=1.90e+07
 sigma counter=65 i=2 t=2.39e-04 per=1.28e+01 cost=3.83e+03 flops=1.60e+07
 sigma counter=65 i=3 t=2.35e-04 per=1.26e+01 cost=4.12e+03 flops=1.75e+07
 sigma counter=65 i=4 t=2.34e-04 per=1.26e+01 cost=1.06e+04 flops=4.52e+07
 sigma counter=65 i=5 t=2.33e-04 per=1.25e+01 cost=1.06e+04 flops=4.54e+07
 sigma counter=65 i=6 t=2.34e-04 per=1.26e+01 cost=4.12e+03 flops=1.76e+07
 sigma counter=65 i=7 t=2.31e-04 per=1.24e+01 cost=3.83e+03 flops=1.66e+07
 total GEMM cost=4.52e+04 flops=2.43e+07
--- TIMING FOR sigma_tot : t_inter=1.31e-02 t_gemm=1.26e-01 t_reduction=1.28e-02 tot=1.52e-01 ---
 sigma_tot counter=65 i=0 t=1.57e-02 per=1.25e+01 cost=2.98e+05 flops=1.90e+07
 sigma_tot counter=65 i=1 t=1.60e-02 per=1.27e+01 cost=3.10e+05 flops=1.94e+07
 sigma_tot counter=65 i=2 t=1.55e-02 per=1.23e+01 cost=3.02e+05 flops=1.95e+07
 sigma_tot counter=65 i=3 t=1.55e-02 per=1.23e+01 cost=3.09e+05 flops=1.99e+07
 sigma_tot counter=65 i=4 t=1.55e-02 per=1.23e+01 cost=5.11e+05 flops=3.30e+07
 sigma_tot counter=65 i=5 t=1.57e-02 per=1.25e+01 cost=5.09e+05 flops=3.24e+07
 sigma_tot counter=65 i=6 t=1.63e-02 per=1.29e+01 cost=5.44e+05 flops=3.34e+07
 sigma_tot counter=65 i=7 t=1.57e-02 per=1.25e+01 cost=5.36e+05 flops=3.41e+07
 total GEMM cost=3.32e+06 flops=2.64e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.91e-04,1.85e-03,1.97e-04 cost=4.52e+04 flops[gemm]=2.44e+07
--- TIMING FOR sigma : t_inter=1.91e-04 t_gemm=1.85e-03 t_reduction=1.97e-04 tot=2.24e-03 ---
 sigma counter=66 i=0 t=2.27e-04 per=1.23e+01 cost=3.82e+03 flops=1.68e+07
 sigma counter=66 i=1 t=2.39e-04 per=1.29e+01 cost=4.32e+03 flops=1.81e+07
 sigma counter=66 i=2 t=2.29e-04 per=1.24e+01 cost=3.83e+03 flops=1.67e+07
 sigma counter=66 i=3 t=2.28e-04 per=1.23e+01 cost=4.12e+03 flops=1.81e+07
 sigma counter=66 i=4 t=2.31e-04 per=1.25e+01 cost=1.06e+04 flops=4.57e+07
 sigma counter=66 i=5 t=2.33e-04 per=1.26e+01 cost=1.06e+04 flops=4.54e+07
 sigma counter=66 i=6 t=2.36e-04 per=1.28e+01 cost=4.12e+03 flops=1.75e+07
 sigma counter=66 i=7 t=2.26e-04 per=1.22e+01 cost=3.83e+03 flops=1.70e+07
 total GEMM cost=4.52e+04 flops=2.44e+07
--- TIMING FOR sigma_tot : t_inter=1.33e-02 t_gemm=1.28e-01 t_reduction=1.30e-02 tot=1.54e-01 ---
 sigma_tot counter=66 i=0 t=1.59e-02 per=1.25e+01 cost=3.02e+05 flops=1.89e+07
 sigma_tot counter=66 i=1 t=1.63e-02 per=1.27e+01 cost=3.15e+05 flops=1.93e+07
 sigma_tot counter=66 i=2 t=1.57e-02 per=1.23e+01 cost=3.06e+05 flops=1.95e+07
 sigma_tot counter=66 i=3 t=1.58e-02 per=1.23e+01 cost=3.13e+05 flops=1.99e+07
 sigma_tot counter=66 i=4 t=1.57e-02 per=1.23e+01 cost=5.21e+05 flops=3.31e+07
 sigma_tot counter=66 i=5 t=1.59e-02 per=1.25e+01 cost=5.20e+05 flops=3.26e+07
 sigma_tot counter=66 i=6 t=1.65e-02 per=1.29e+01 cost=5.48e+05 flops=3.32e+07
 sigma_tot counter=66 i=7 t=1.59e-02 per=1.25e+01 cost=5.39e+05 flops=3.39e+07
 total GEMM cost=3.36e+06 flops=2.63e+07
    7   0 +      -2.652081087251  -6.02e-08   8.25e-05    6    14   3.35e-02  2.39e-03
    7   1 -      -2.430689830982  -4.05e-07   2.50e-04    6    14   3.35e-02  2.39e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.92e-04,1.83e-03,1.91e-04 cost=4.52e+04 flops[gemm]=2.47e+07
--- TIMING FOR sigma : t_inter=1.92e-04 t_gemm=1.83e-03 t_reduction=1.91e-04 tot=2.21e-03 ---
 sigma counter=67 i=0 t=2.30e-04 per=1.26e+01 cost=3.82e+03 flops=1.66e+07
 sigma counter=67 i=1 t=2.24e-04 per=1.23e+01 cost=4.32e+03 flops=1.93e+07
 sigma counter=67 i=2 t=2.33e-04 per=1.28e+01 cost=3.83e+03 flops=1.65e+07
 sigma counter=67 i=3 t=2.25e-04 per=1.23e+01 cost=4.12e+03 flops=1.83e+07
 sigma counter=67 i=4 t=2.29e-04 per=1.25e+01 cost=1.06e+04 flops=4.61e+07
 sigma counter=67 i=5 t=2.33e-04 per=1.28e+01 cost=1.06e+04 flops=4.54e+07
 sigma counter=67 i=6 t=2.29e-04 per=1.25e+01 cost=4.12e+03 flops=1.80e+07
 sigma counter=67 i=7 t=2.23e-04 per=1.22e+01 cost=3.83e+03 flops=1.72e+07
 total GEMM cost=4.52e+04 flops=2.47e+07
--- TIMING FOR sigma_tot : t_inter=1.35e-02 t_gemm=1.30e-01 t_reduction=1.32e-02 tot=1.56e-01 ---
 sigma_tot counter=67 i=0 t=1.62e-02 per=1.25e+01 cost=3.06e+05 flops=1.89e+07
 sigma_tot counter=67 i=1 t=1.65e-02 per=1.27e+01 cost=3.19e+05 flops=1.93e+07
 sigma_tot counter=67 i=2 t=1.59e-02 per=1.23e+01 cost=3.10e+05 flops=1.94e+07
 sigma_tot counter=67 i=3 t=1.60e-02 per=1.23e+01 cost=3.17e+05 flops=1.98e+07
 sigma_tot counter=67 i=4 t=1.60e-02 per=1.23e+01 cost=5.32e+05 flops=3.33e+07
 sigma_tot counter=67 i=5 t=1.62e-02 per=1.25e+01 cost=5.30e+05 flops=3.28e+07
 sigma_tot counter=67 i=6 t=1.68e-02 per=1.29e+01 cost=5.52e+05 flops=3.29e+07
 sigma_tot counter=67 i=7 t=1.62e-02 per=1.25e+01 cost=5.43e+05 flops=3.36e+07
 total GEMM cost=3.41e+06 flops=2.63e+07
    8   0 +      -2.652081087251   8.88e-16   8.25e-05    5    15   3.59e-02  2.39e-03
    8   1 +      -2.430689876389  -4.54e-08   6.80e-05    5    15   3.59e-02  2.39e-03
TIMING for Davidson : 3.59e-02  T(cal/comm/rest)=3.55e-02,6.25e-07,4.08e-04
optimized energies: isweep=1 dots=2 ibond=0 e[0]=-2.65208108725
optimized energies: isweep=1 dots=2 ibond=0 e[1]=-2.43068987639
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=1.6e-05 (comb,oper,dvdson,hvec,renorm)=1.6e-06,1.5e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.357e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000653 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=6.2e-05,0.000268,0.000324 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8e-06,0.00111,0.000197 cost=2.78e+04 flops[gemm]=2.5e+07
--- TIMING FOR renorm : t_inter=8e-06 t_gemm=0.00111 t_reduction=0.000197 tot=0.00132 ---
 renorm counter=5 i=0 t=0.000218 per=19.6 cost=2.19e+03 flops=1.01e+07
 renorm counter=5 i=1 t=0.000217 per=19.5 cost=2.85e+03 flops=1.32e+07
 renorm counter=5 i=2 t=1e-06 per=0.09 cost=0 flops=0
 renorm counter=5 i=3 t=1e-06 per=0.09 cost=0 flops=0
 renorm counter=5 i=4 t=0.000212 per=19.1 cost=2.11e+03 flops=9.95e+06
 renorm counter=5 i=5 t=0.000212 per=19.1 cost=2.94e+03 flops=1.39e+07
 renorm counter=5 i=6 t=0.00025 per=22.5 cost=1.77e+04 flops=7.08e+07
 total GEMM cost=2.78e+04 flops=2.5e+07
--- TIMING FOR renorm_tot : t_inter=0.000421 t_gemm=0.00558 t_reduction=0.000985 tot=0.00699 ---
 renorm_tot counter=5 i=0 t=0.0011 per=19.8 cost=9e+03 flops=8.16e+06
 renorm_tot counter=5 i=1 t=0.00113 per=20.2 cost=1.34e+04 flops=1.19e+07
 renorm_tot counter=5 i=2 t=0.000435 per=7.79 cost=5.99e+03 flops=1.38e+07
 renorm_tot counter=5 i=3 t=0.000442 per=7.92 cost=1.09e+04 flops=2.47e+07
 renorm_tot counter=5 i=4 t=0.000638 per=11.4 cost=7.82e+03 flops=1.23e+07
 renorm_tot counter=5 i=5 t=0.000642 per=11.5 cost=1.35e+04 flops=2.11e+07
 renorm_tot counter=5 i=6 t=0.00119 per=21.4 cost=8.48e+04 flops=7.11e+07
 total GEMM cost=1.45e+05 flops=2.61e+07
check ||H-H.dagger||=0.00e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0029 S T(init/kernel/comm)=0.00011,0.0028,1e-05 rank=0 -----
===== CPUmem(GB): tot=1.6e-05 (comb,oper,dvdson,hvec,renorm)=1.6e-06,1.5e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=130:0.00099MB:9.7e-07GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=144:0.0011MB:1.1e-06GB
total mem of comb=305:0.0023MB:2.3e-06GB
===== CPUmem(GB): tot=2.7e-05 (comb,oper,dvdson,hvec,renorm)=2.3e-06,2.5e-05,0,0,0 =====
fname=./scratch/sweep/lop(1,0) size=1.03e-05GB T[save](info/data/tot)=5.94e-05,3.98e-05,9.91e-05 speed=0.104GB/s disk[used]=6.51e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
##### time_local: 4.31e-02 S #####
 T(fetch) = 1.31e-04 S  per =  0.3  per(accum) = 0.3
 T(hdiag) = 1.12e-04 S  per = 0.26  per(accum) = 0.56
 T(dvdsn) = 3.91e-02 S  per =   91  per(accum) = 91
 T(decim) = 7.58e-05 S  per = 0.18  per(accum) = 92
 T(guess) = 7.17e-05 S  per = 0.17  per(accum) = 92
 T(renrm) = 2.99e-03 S  per =  6.9  per(accum) = 99
 T(save ) = 6.03e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.89e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 5.78e-05 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 3.16e-04 S  per = 0.81  per(accum) = 0.96
 T(hintermediate init           ) = 2.82e-05 S  per = 0.072  per(accum) = 1
 T(hintermediates memcpy cpu2gpu) = 4.92e-06 S  per = 0.013  per(accum) = 1
 T(preprocess_hformulae_Hxlist2 ) = 1.61e-03 S  per =  4.1  per(accum) = 5.2
 T(hmmtasks init                ) = 1.05e-03 S  per =  2.7  per(accum) = 7.9
 T(dvdson solver [Hx_batchGPU]  ) = 3.55e-02 S  per =   91  per(accum) = 99
 T(dvdson solver [communication]) = 6.25e-07 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.08e-04 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.93e-03 S
 T(qops init                    ) = 1.09e-04 S  per =  3.7  per(accum) = 3.7
 T(qops_dict memcpy cpu2gpu     ) = 3.09e-05 S  per =  1.1  per(accum) = 4.8
 T(symbolic_formulae_renorm     ) = 2.41e-04 S  per =  8.2  per(accum) = 13
 T(rintermediate init           ) = 1.12e-05 S  per = 0.38  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 5.55e-06 S  per = 0.19  per(accum) = 14
 T(preprocess_formulae_Rlist2   ) = 6.64e-04 S  per =   23  per(accum) = 36
 T(rmmtasks init                ) = 4.18e-04 S  per =   14  per(accum) = 50
 T(qops memset                  ) = 9.43e-06 S  per = 0.32  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 1.40e-03 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.22e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.01e-05 S  per = 0.35  per(accum) = 1e+02
##### time_sweep: 4.31e-02 S #####
 T(fetch) = 1.31e-04 S  per =  0.3  per(accum) = 0.3
 T(hdiag) = 1.12e-04 S  per = 0.26  per(accum) = 0.56
 T(dvdsn) = 3.91e-02 S  per =   91  per(accum) = 91
 T(decim) = 7.58e-05 S  per = 0.18  per(accum) = 92
 T(guess) = 7.17e-05 S  per = 0.17  per(accum) = 92
 T(renrm) = 2.99e-03 S  per =  6.9  per(accum) = 99
 T(save ) = 6.03e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.89e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 5.78e-05 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 3.16e-04 S  per = 0.81  per(accum) = 0.96
 T(hintermediate init           ) = 2.82e-05 S  per = 0.072  per(accum) = 1
 T(hintermediates memcpy cpu2gpu) = 4.92e-06 S  per = 0.013  per(accum) = 1
 T(preprocess_hformulae_Hxlist2 ) = 1.61e-03 S  per =  4.1  per(accum) = 5.2
 T(hmmtasks init                ) = 1.05e-03 S  per =  2.7  per(accum) = 7.9
 T(dvdson solver [Hx_batchGPU]  ) = 3.55e-02 S  per =   91  per(accum) = 99
 T(dvdson solver [communication]) = 6.25e-07 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.08e-04 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.93e-03 S
 T(qops init                    ) = 1.09e-04 S  per =  3.7  per(accum) = 3.7
 T(qops_dict memcpy cpu2gpu     ) = 3.09e-05 S  per =  1.1  per(accum) = 4.8
 T(symbolic_formulae_renorm     ) = 2.41e-04 S  per =  8.2  per(accum) = 13
 T(rintermediate init           ) = 1.12e-05 S  per = 0.38  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 5.55e-06 S  per = 0.19  per(accum) = 14
 T(preprocess_formulae_Rlist2   ) = 6.64e-04 S  per =   23  per(accum) = 36
 T(rmmtasks init                ) = 4.18e-04 S  per =   14  per(accum) = 50
 T(qops memset                  ) = 9.43e-06 S  per = 0.32  per(accum) = 51
 T(preprocess_renorm_batchGPU   ) = 1.40e-03 S  per =   48  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.22e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.01e-05 S  per = 0.35  per(accum) = 1e+02
##### time_global: 2.10e-01 S #####
 T(fetch) = 1.51e-03 S  per = 0.72  per(accum) = 0.72
 T(hdiag) = 4.71e-04 S  per = 0.22  per(accum) = 0.94
 T(dvdsn) = 1.88e-01 S  per =   90  per(accum) = 90
 T(decim) = 1.65e-03 S  per = 0.79  per(accum) = 91
 T(guess) = 5.07e-04 S  per = 0.24  per(accum) = 92
 T(renrm) = 1.46e-02 S  per =    7  per(accum) = 98
 T(save ) = 3.17e-03 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.87e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 2.28e-04 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 1.52e-03 S  per = 0.82  per(accum) = 0.94
 T(hintermediate init           ) = 1.52e-04 S  per = 0.081  per(accum) = 1
 T(hintermediates memcpy cpu2gpu) = 2.58e-05 S  per = 0.014  per(accum) = 1
 T(preprocess_hformulae_Hxlist2 ) = 1.07e-02 S  per =  5.7  per(accum) = 6.8
 T(hmmtasks init                ) = 7.02e-03 S  per =  3.8  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 1.65e-01 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 4.55e-06 S  per = 0.0024  per(accum) = 99
 T(dvdson solver [rest part]    ) = 2.28e-03 S  per =  1.2  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.44e-02 S
 T(qops init                    ) = 9.37e-04 S  per =  6.5  per(accum) = 6.5
 T(qops_dict memcpy cpu2gpu     ) = 2.09e-04 S  per =  1.5  per(accum) = 8
 T(symbolic_formulae_renorm     ) = 1.28e-03 S  per =  8.9  per(accum) = 17
 T(rintermediate init           ) = 9.93e-05 S  per = 0.69  per(accum) = 18
 T(rintermediates memcpy cpu2gpu) = 3.17e-05 S  per = 0.22  per(accum) = 18
 T(preprocess_formulae_Rlist2   ) = 2.47e-03 S  per =   17  per(accum) = 35
 T(rmmtasks init                ) = 1.59e-03 S  per =   11  per(accum) = 46
 T(qops memset                  ) = 4.91e-05 S  per = 0.34  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 7.48e-03 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.59e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 5.22e-05 S  per = 0.36  per(accum) = 1e+02

isweep=1 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.785e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=130:0.000992MB:9.69e-07GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=144:0.0011MB:1.07e-06GB
total mem of comb=305:0.00233MB:2.27e-06GB
===== CPUmem(GB): tot=1.59e-05 (comb,oper,dvdson,hvec,renorm)=2.27e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44918920
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.782e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 2.290e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00276 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=6.44e-05,0.0012,0.00149 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=3.08e-05 (comb,oper,dvdson,hvec,renorm)=2.27e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.7e-05,0.000211,0.00202,0.000199 cost=7.9e+04 flops[gemm]=3.92e+07
--- TIMING FOR sigma : t_inter=0.000211 t_gemm=0.00202 t_reduction=0.000199 tot=0.00243 ---
 sigma counter=68 i=0 t=0.00025 per=12.4 cost=6.81e+03 flops=2.73e+07
 sigma counter=68 i=1 t=0.00026 per=12.9 cost=6.78e+03 flops=2.61e+07
 sigma counter=68 i=2 t=0.000245 per=12.1 cost=7.01e+03 flops=2.86e+07
 sigma counter=68 i=3 t=0.000249 per=12.3 cost=6.99e+03 flops=2.81e+07
 sigma counter=68 i=4 t=0.000243 per=12 cost=6.81e+03 flops=2.8e+07
 sigma counter=68 i=5 t=0.000246 per=12.2 cost=6.78e+03 flops=2.76e+07
 sigma counter=68 i=6 t=0.000269 per=13.3 cost=1.89e+04 flops=7.02e+07
 sigma counter=68 i=7 t=0.000255 per=12.6 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.9e+04 flops=3.92e+07
--- TIMING FOR sigma_tot : t_inter=0.0137 t_gemm=0.132 t_reduction=0.0134 tot=0.159 ---
 sigma_tot counter=68 i=0 t=0.0164 per=12.5 cost=3.12e+05 flops=1.9e+07
 sigma_tot counter=68 i=1 t=0.0168 per=12.7 cost=3.26e+05 flops=1.94e+07
 sigma_tot counter=68 i=2 t=0.0162 per=12.3 cost=3.17e+05 flops=1.96e+07
 sigma_tot counter=68 i=3 t=0.0162 per=12.3 cost=3.24e+05 flops=2e+07
 sigma_tot counter=68 i=4 t=0.0162 per=12.3 cost=5.39e+05 flops=3.33e+07
 sigma_tot counter=68 i=5 t=0.0164 per=12.5 cost=5.37e+05 flops=3.27e+07
 sigma_tot counter=68 i=6 t=0.017 per=12.9 cost=5.71e+05 flops=3.35e+07
 sigma_tot counter=68 i=7 t=0.0164 per=12.5 cost=5.62e+05 flops=3.43e+07
 total GEMM cost=3.49e+06 flops=2.65e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.9e-05,0.000207,0.00201,0.000202 cost=7.9e+04 flops[gemm]=3.93e+07
--- TIMING FOR sigma : t_inter=0.000207 t_gemm=0.00201 t_reduction=0.000202 tot=0.00242 ---
 sigma counter=69 i=0 t=0.000243 per=12.1 cost=6.81e+03 flops=2.8e+07
 sigma counter=69 i=1 t=0.000253 per=12.6 cost=6.78e+03 flops=2.68e+07
 sigma counter=69 i=2 t=0.000245 per=12.2 cost=7.01e+03 flops=2.86e+07
 sigma counter=69 i=3 t=0.000247 per=12.3 cost=6.99e+03 flops=2.83e+07
 sigma counter=69 i=4 t=0.000241 per=12 cost=6.81e+03 flops=2.83e+07
 sigma counter=69 i=5 t=0.000248 per=12.3 cost=6.78e+03 flops=2.74e+07
 sigma counter=69 i=6 t=0.000275 per=13.7 cost=1.89e+04 flops=6.87e+07
 sigma counter=69 i=7 t=0.000257 per=12.8 cost=1.89e+04 flops=7.35e+07
 total GEMM cost=7.9e+04 flops=3.93e+07
--- TIMING FOR sigma_tot : t_inter=0.0139 t_gemm=0.134 t_reduction=0.0136 tot=0.161 ---
 sigma_tot counter=69 i=0 t=0.0167 per=12.5 cost=3.19e+05 flops=1.92e+07
 sigma_tot counter=69 i=1 t=0.017 per=12.7 cost=3.33e+05 flops=1.96e+07
 sigma_tot counter=69 i=2 t=0.0164 per=12.3 cost=3.24e+05 flops=1.97e+07
 sigma_tot counter=69 i=3 t=0.0165 per=12.3 cost=3.31e+05 flops=2.01e+07
 sigma_tot counter=69 i=4 t=0.0164 per=12.3 cost=5.45e+05 flops=3.32e+07
 sigma_tot counter=69 i=5 t=0.0167 per=12.5 cost=5.44e+05 flops=3.27e+07
 sigma_tot counter=69 i=6 t=0.0173 per=12.9 cost=5.9e+05 flops=3.41e+07
 sigma_tot counter=69 i=7 t=0.0167 per=12.5 cost=5.81e+05 flops=3.49e+07
 total GEMM cost=3.57e+06 flops=2.67e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652081087251  -1.00e+03   7.61e-02    2     2   5.13e-03  2.56e-03
    1   1 -      -2.430689876389  -1.00e+03   1.16e-01    2     2   5.13e-03  2.56e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.09e-04,2.01e-03,2.00e-04 cost=7.90e+04 flops[gemm]=3.93e+07
--- TIMING FOR sigma : t_inter=2.09e-04 t_gemm=2.01e-03 t_reduction=1.99e-04 tot=2.42e-03 ---
 sigma counter=70 i=0 t=2.43e-04 per=1.21e+01 cost=6.81e+03 flops=2.80e+07
 sigma counter=70 i=1 t=2.54e-04 per=1.26e+01 cost=6.78e+03 flops=2.67e+07
 sigma counter=70 i=2 t=2.41e-04 per=1.20e+01 cost=7.01e+03 flops=2.91e+07
 sigma counter=70 i=3 t=2.49e-04 per=1.24e+01 cost=6.99e+03 flops=2.81e+07
 sigma counter=70 i=4 t=2.44e-04 per=1.22e+01 cost=6.81e+03 flops=2.79e+07
 sigma counter=70 i=5 t=2.46e-04 per=1.23e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=70 i=6 t=2.70e-04 per=1.34e+01 cost=1.89e+04 flops=7.00e+07
 sigma counter=70 i=7 t=2.61e-04 per=1.30e+01 cost=1.89e+04 flops=7.24e+07
 total GEMM cost=7.90e+04 flops=3.93e+07
--- TIMING FOR sigma_tot : t_inter=1.41e-02 t_gemm=1.36e-01 t_reduction=1.38e-02 tot=1.64e-01 ---
 sigma_tot counter=70 i=0 t=1.69e-02 per=1.25e+01 cost=3.26e+05 flops=1.93e+07
 sigma_tot counter=70 i=1 t=1.73e-02 per=1.27e+01 cost=3.39e+05 flops=1.97e+07
 sigma_tot counter=70 i=2 t=1.67e-02 per=1.23e+01 cost=3.31e+05 flops=1.98e+07
 sigma_tot counter=70 i=3 t=1.67e-02 per=1.23e+01 cost=3.38e+05 flops=2.02e+07
 sigma_tot counter=70 i=4 t=1.67e-02 per=1.23e+01 cost=5.52e+05 flops=3.31e+07
 sigma_tot counter=70 i=5 t=1.69e-02 per=1.25e+01 cost=5.51e+05 flops=3.26e+07
 sigma_tot counter=70 i=6 t=1.76e-02 per=1.30e+01 cost=6.09e+05 flops=3.46e+07
 sigma_tot counter=70 i=7 t=1.69e-02 per=1.25e+01 cost=6.00e+05 flops=3.55e+07
 total GEMM cost=3.65e+06 flops=2.69e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.05e-04,2.02e-03,1.95e-04 cost=7.90e+04 flops[gemm]=3.91e+07
--- TIMING FOR sigma : t_inter=2.05e-04 t_gemm=2.02e-03 t_reduction=1.95e-04 tot=2.42e-03 ---
 sigma counter=71 i=0 t=2.42e-04 per=1.20e+01 cost=6.81e+03 flops=2.82e+07
 sigma counter=71 i=1 t=2.59e-04 per=1.28e+01 cost=6.78e+03 flops=2.62e+07
 sigma counter=71 i=2 t=2.44e-04 per=1.21e+01 cost=7.01e+03 flops=2.87e+07
 sigma counter=71 i=3 t=2.48e-04 per=1.23e+01 cost=6.99e+03 flops=2.82e+07
 sigma counter=71 i=4 t=2.45e-04 per=1.21e+01 cost=6.81e+03 flops=2.78e+07
 sigma counter=71 i=5 t=2.52e-04 per=1.25e+01 cost=6.78e+03 flops=2.69e+07
 sigma counter=71 i=6 t=2.76e-04 per=1.37e+01 cost=1.89e+04 flops=6.85e+07
 sigma counter=71 i=7 t=2.53e-04 per=1.25e+01 cost=1.89e+04 flops=7.47e+07
 total GEMM cost=7.90e+04 flops=3.91e+07
--- TIMING FOR sigma_tot : t_inter=1.43e-02 t_gemm=1.38e-01 t_reduction=1.40e-02 tot=1.66e-01 ---
 sigma_tot counter=71 i=0 t=1.71e-02 per=1.24e+01 cost=3.33e+05 flops=1.94e+07
 sigma_tot counter=71 i=1 t=1.75e-02 per=1.27e+01 cost=3.46e+05 flops=1.98e+07
 sigma_tot counter=71 i=2 t=1.69e-02 per=1.23e+01 cost=3.38e+05 flops=2.00e+07
 sigma_tot counter=71 i=3 t=1.70e-02 per=1.23e+01 cost=3.45e+05 flops=2.03e+07
 sigma_tot counter=71 i=4 t=1.69e-02 per=1.23e+01 cost=5.59e+05 flops=3.30e+07
 sigma_tot counter=71 i=5 t=1.72e-02 per=1.25e+01 cost=5.57e+05 flops=3.25e+07
 sigma_tot counter=71 i=6 t=1.78e-02 per=1.30e+01 cost=6.27e+05 flops=3.52e+07
 sigma_tot counter=71 i=7 t=1.72e-02 per=1.25e+01 cost=6.19e+05 flops=3.60e+07
 total GEMM cost=3.73e+06 flops=2.71e+07
    2   0 -      -2.654436755680  -2.36e-03   1.10e-02    4     4   1.03e-02  2.56e-03
    2   1 -      -2.436722360481  -6.03e-03   1.83e-02    4     4   1.03e-02  2.56e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.07e-04,1.97e-03,1.93e-04 cost=7.90e+04 flops[gemm]=4.01e+07
--- TIMING FOR sigma : t_inter=2.07e-04 t_gemm=1.97e-03 t_reduction=1.92e-04 tot=2.37e-03 ---
 sigma counter=72 i=0 t=2.41e-04 per=1.22e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=72 i=1 t=2.42e-04 per=1.23e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=72 i=2 t=2.38e-04 per=1.21e+01 cost=7.01e+03 flops=2.94e+07
 sigma counter=72 i=3 t=2.48e-04 per=1.26e+01 cost=6.99e+03 flops=2.82e+07
 sigma counter=72 i=4 t=2.39e-04 per=1.21e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=72 i=5 t=2.44e-04 per=1.24e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=72 i=6 t=2.65e-04 per=1.34e+01 cost=1.89e+04 flops=7.13e+07
 sigma counter=72 i=7 t=2.55e-04 per=1.29e+01 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.90e+04 flops=4.01e+07
--- TIMING FOR sigma_tot : t_inter=1.45e-02 t_gemm=1.40e-01 t_reduction=1.42e-02 tot=1.68e-01 ---
 sigma_tot counter=72 i=0 t=1.74e-02 per=1.24e+01 cost=3.40e+05 flops=1.95e+07
 sigma_tot counter=72 i=1 t=1.78e-02 per=1.27e+01 cost=3.53e+05 flops=1.99e+07
 sigma_tot counter=72 i=2 t=1.72e-02 per=1.23e+01 cost=3.45e+05 flops=2.01e+07
 sigma_tot counter=72 i=3 t=1.72e-02 per=1.23e+01 cost=3.52e+05 flops=2.04e+07
 sigma_tot counter=72 i=4 t=1.72e-02 per=1.23e+01 cost=5.66e+05 flops=3.30e+07
 sigma_tot counter=72 i=5 t=1.74e-02 per=1.25e+01 cost=5.64e+05 flops=3.24e+07
 sigma_tot counter=72 i=6 t=1.81e-02 per=1.30e+01 cost=6.46e+05 flops=3.57e+07
 sigma_tot counter=72 i=7 t=1.74e-02 per=1.25e+01 cost=6.38e+05 flops=3.66e+07
 total GEMM cost=3.80e+06 flops=2.72e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,2.01e-04,1.99e-03,1.94e-04 cost=7.90e+04 flops[gemm]=3.97e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.99e-03 t_reduction=1.94e-04 tot=2.38e-03 ---
 sigma counter=73 i=0 t=2.42e-04 per=1.22e+01 cost=6.81e+03 flops=2.82e+07
 sigma counter=73 i=1 t=2.57e-04 per=1.29e+01 cost=6.78e+03 flops=2.64e+07
 sigma counter=73 i=2 t=2.38e-04 per=1.20e+01 cost=7.01e+03 flops=2.94e+07
 sigma counter=73 i=3 t=2.45e-04 per=1.23e+01 cost=6.99e+03 flops=2.85e+07
 sigma counter=73 i=4 t=2.38e-04 per=1.20e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=73 i=5 t=2.47e-04 per=1.24e+01 cost=6.78e+03 flops=2.75e+07
 sigma counter=73 i=6 t=2.67e-04 per=1.34e+01 cost=1.89e+04 flops=7.08e+07
 sigma counter=73 i=7 t=2.52e-04 per=1.27e+01 cost=1.89e+04 flops=7.50e+07
 total GEMM cost=7.90e+04 flops=3.98e+07
--- TIMING FOR sigma_tot : t_inter=1.47e-02 t_gemm=1.42e-01 t_reduction=1.44e-02 tot=1.71e-01 ---
 sigma_tot counter=73 i=0 t=1.76e-02 per=1.24e+01 cost=3.47e+05 flops=1.97e+07
 sigma_tot counter=73 i=1 t=1.80e-02 per=1.27e+01 cost=3.60e+05 flops=2.00e+07
 sigma_tot counter=73 i=2 t=1.74e-02 per=1.23e+01 cost=3.52e+05 flops=2.02e+07
 sigma_tot counter=73 i=3 t=1.75e-02 per=1.23e+01 cost=3.59e+05 flops=2.06e+07
 sigma_tot counter=73 i=4 t=1.74e-02 per=1.23e+01 cost=5.73e+05 flops=3.29e+07
 sigma_tot counter=73 i=5 t=1.76e-02 per=1.25e+01 cost=5.71e+05 flops=3.24e+07
 sigma_tot counter=73 i=6 t=1.84e-02 per=1.30e+01 cost=6.65e+05 flops=3.62e+07
 sigma_tot counter=73 i=7 t=1.77e-02 per=1.25e+01 cost=6.57e+05 flops=3.71e+07
 total GEMM cost=3.88e+06 flops=2.74e+07
    3   0 -      -2.654509457874  -7.27e-05   3.58e-03    6     6   1.53e-02  2.55e-03
    3   1 -      -2.436951014557  -2.29e-04   5.90e-03    6     6   1.53e-02  2.55e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.07e-04,1.99e-03,1.94e-04 cost=7.90e+04 flops[gemm]=3.97e+07
--- TIMING FOR sigma : t_inter=2.07e-04 t_gemm=1.99e-03 t_reduction=1.94e-04 tot=2.39e-03 ---
 sigma counter=74 i=0 t=2.42e-04 per=1.22e+01 cost=6.81e+03 flops=2.82e+07
 sigma counter=74 i=1 t=2.55e-04 per=1.28e+01 cost=6.78e+03 flops=2.66e+07
 sigma counter=74 i=2 t=2.42e-04 per=1.22e+01 cost=7.01e+03 flops=2.90e+07
 sigma counter=74 i=3 t=2.47e-04 per=1.24e+01 cost=6.99e+03 flops=2.83e+07
 sigma counter=74 i=4 t=2.38e-04 per=1.20e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=74 i=5 t=2.40e-04 per=1.21e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=74 i=6 t=2.69e-04 per=1.35e+01 cost=1.89e+04 flops=7.02e+07
 sigma counter=74 i=7 t=2.55e-04 per=1.28e+01 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.90e+04 flops=3.97e+07
--- TIMING FOR sigma_tot : t_inter=1.49e-02 t_gemm=1.44e-01 t_reduction=1.46e-02 tot=1.73e-01 ---
 sigma_tot counter=74 i=0 t=1.79e-02 per=1.24e+01 cost=3.53e+05 flops=1.98e+07
 sigma_tot counter=74 i=1 t=1.83e-02 per=1.27e+01 cost=3.66e+05 flops=2.01e+07
 sigma_tot counter=74 i=2 t=1.76e-02 per=1.23e+01 cost=3.59e+05 flops=2.04e+07
 sigma_tot counter=74 i=3 t=1.77e-02 per=1.23e+01 cost=3.66e+05 flops=2.07e+07
 sigma_tot counter=74 i=4 t=1.76e-02 per=1.23e+01 cost=5.79e+05 flops=3.28e+07
 sigma_tot counter=74 i=5 t=1.79e-02 per=1.25e+01 cost=5.78e+05 flops=3.23e+07
 sigma_tot counter=74 i=6 t=1.86e-02 per=1.30e+01 cost=6.84e+05 flops=3.67e+07
 sigma_tot counter=74 i=7 t=1.79e-02 per=1.25e+01 cost=6.76e+05 flops=3.77e+07
 total GEMM cost=3.96e+06 flops=2.76e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.02e-04,1.98e-03,1.93e-04 cost=7.90e+04 flops[gemm]=3.99e+07
--- TIMING FOR sigma : t_inter=2.02e-04 t_gemm=1.98e-03 t_reduction=1.93e-04 tot=2.37e-03 ---
 sigma counter=75 i=0 t=2.39e-04 per=1.21e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=75 i=1 t=2.55e-04 per=1.29e+01 cost=6.78e+03 flops=2.66e+07
 sigma counter=75 i=2 t=2.40e-04 per=1.21e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=75 i=3 t=2.45e-04 per=1.24e+01 cost=6.99e+03 flops=2.85e+07
 sigma counter=75 i=4 t=2.37e-04 per=1.20e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=75 i=5 t=2.44e-04 per=1.23e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=75 i=6 t=2.66e-04 per=1.34e+01 cost=1.89e+04 flops=7.10e+07
 sigma counter=75 i=7 t=2.53e-04 per=1.28e+01 cost=1.89e+04 flops=7.47e+07
 total GEMM cost=7.90e+04 flops=3.99e+07
--- TIMING FOR sigma_tot : t_inter=1.51e-02 t_gemm=1.46e-01 t_reduction=1.48e-02 tot=1.75e-01 ---
 sigma_tot counter=75 i=0 t=1.81e-02 per=1.24e+01 cost=3.60e+05 flops=1.99e+07
 sigma_tot counter=75 i=1 t=1.85e-02 per=1.27e+01 cost=3.73e+05 flops=2.01e+07
 sigma_tot counter=75 i=2 t=1.79e-02 per=1.23e+01 cost=3.66e+05 flops=2.05e+07
 sigma_tot counter=75 i=3 t=1.80e-02 per=1.23e+01 cost=3.73e+05 flops=2.08e+07
 sigma_tot counter=75 i=4 t=1.79e-02 per=1.23e+01 cost=5.86e+05 flops=3.28e+07
 sigma_tot counter=75 i=5 t=1.81e-02 per=1.25e+01 cost=5.85e+05 flops=3.22e+07
 sigma_tot counter=75 i=6 t=1.89e-02 per=1.30e+01 cost=7.03e+05 flops=3.72e+07
 sigma_tot counter=75 i=7 t=1.82e-02 per=1.25e+01 cost=6.94e+05 flops=3.82e+07
 total GEMM cost=4.04e+06 flops=2.78e+07
    4   0 -      -2.654516214560  -6.76e-06   1.01e-03    6     8   2.03e-02  2.54e-03
    4   1 -      -2.436975310129  -2.43e-05   1.78e-03    6     8   2.03e-02  2.54e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,2.04e-04,1.99e-03,1.91e-04 cost=7.90e+04 flops[gemm]=3.96e+07
--- TIMING FOR sigma : t_inter=2.04e-04 t_gemm=1.99e-03 t_reduction=1.90e-04 tot=2.39e-03 ---
 sigma counter=76 i=0 t=2.50e-04 per=1.25e+01 cost=6.81e+03 flops=2.73e+07
 sigma counter=76 i=1 t=2.54e-04 per=1.27e+01 cost=6.78e+03 flops=2.67e+07
 sigma counter=76 i=2 t=2.39e-04 per=1.20e+01 cost=7.01e+03 flops=2.93e+07
 sigma counter=76 i=3 t=2.51e-04 per=1.26e+01 cost=6.99e+03 flops=2.78e+07
 sigma counter=76 i=4 t=2.38e-04 per=1.19e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=76 i=5 t=2.40e-04 per=1.20e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=76 i=6 t=2.66e-04 per=1.33e+01 cost=1.89e+04 flops=7.10e+07
 sigma counter=76 i=7 t=2.55e-04 per=1.28e+01 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.90e+04 flops=3.96e+07
--- TIMING FOR sigma_tot : t_inter=1.53e-02 t_gemm=1.48e-01 t_reduction=1.50e-02 tot=1.78e-01 ---
 sigma_tot counter=76 i=0 t=1.84e-02 per=1.24e+01 cost=3.67e+05 flops=2.00e+07
 sigma_tot counter=76 i=1 t=1.88e-02 per=1.27e+01 cost=3.80e+05 flops=2.02e+07
 sigma_tot counter=76 i=2 t=1.81e-02 per=1.23e+01 cost=3.73e+05 flops=2.06e+07
 sigma_tot counter=76 i=3 t=1.82e-02 per=1.23e+01 cost=3.80e+05 flops=2.09e+07
 sigma_tot counter=76 i=4 t=1.81e-02 per=1.23e+01 cost=5.93e+05 flops=3.27e+07
 sigma_tot counter=76 i=5 t=1.84e-02 per=1.24e+01 cost=5.91e+05 flops=3.22e+07
 sigma_tot counter=76 i=6 t=1.92e-02 per=1.30e+01 cost=7.22e+05 flops=3.76e+07
 sigma_tot counter=76 i=7 t=1.84e-02 per=1.25e+01 cost=7.13e+05 flops=3.87e+07
 total GEMM cost=4.12e+06 flops=2.79e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.98e-04,1.97e-03,1.96e-04 cost=7.90e+04 flops[gemm]=4.01e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.97e-03 t_reduction=1.96e-04 tot=2.36e-03 ---
 sigma counter=77 i=0 t=2.38e-04 per=1.21e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=77 i=1 t=2.44e-04 per=1.24e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=77 i=2 t=2.39e-04 per=1.21e+01 cost=7.01e+03 flops=2.93e+07
 sigma counter=77 i=3 t=2.42e-04 per=1.23e+01 cost=6.99e+03 flops=2.89e+07
 sigma counter=77 i=4 t=2.35e-04 per=1.19e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=77 i=5 t=2.47e-04 per=1.25e+01 cost=6.78e+03 flops=2.75e+07
 sigma counter=77 i=6 t=2.70e-04 per=1.37e+01 cost=1.89e+04 flops=7.00e+07
 sigma counter=77 i=7 t=2.54e-04 per=1.29e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=4.01e+07
--- TIMING FOR sigma_tot : t_inter=1.55e-02 t_gemm=1.50e-01 t_reduction=1.52e-02 tot=1.80e-01 ---
 sigma_tot counter=77 i=0 t=1.86e-02 per=1.24e+01 cost=3.74e+05 flops=2.01e+07
 sigma_tot counter=77 i=1 t=1.90e-02 per=1.27e+01 cost=3.87e+05 flops=2.03e+07
 sigma_tot counter=77 i=2 t=1.84e-02 per=1.23e+01 cost=3.80e+05 flops=2.07e+07
 sigma_tot counter=77 i=3 t=1.85e-02 per=1.23e+01 cost=3.87e+05 flops=2.10e+07
 sigma_tot counter=77 i=4 t=1.84e-02 per=1.23e+01 cost=6.00e+05 flops=3.27e+07
 sigma_tot counter=77 i=5 t=1.86e-02 per=1.24e+01 cost=5.98e+05 flops=3.21e+07
 sigma_tot counter=77 i=6 t=1.94e-02 per=1.30e+01 cost=7.41e+05 flops=3.81e+07
 sigma_tot counter=77 i=7 t=1.87e-02 per=1.25e+01 cost=7.32e+05 flops=3.92e+07
 total GEMM cost=4.20e+06 flops=2.81e+07
    5   0 -      -2.654516839742  -6.25e-07   4.21e-04    6    10   2.53e-02  2.53e-03
    5   1 -      -2.436977310239  -2.00e-06   4.24e-04    6    10   2.53e-02  2.53e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.11e-04,1.98e-03,1.93e-04 cost=7.90e+04 flops[gemm]=3.98e+07
--- TIMING FOR sigma : t_inter=2.11e-04 t_gemm=1.98e-03 t_reduction=1.93e-04 tot=2.39e-03 ---
 sigma counter=78 i=0 t=2.42e-04 per=1.22e+01 cost=6.81e+03 flops=2.82e+07
 sigma counter=78 i=1 t=2.54e-04 per=1.28e+01 cost=6.78e+03 flops=2.67e+07
 sigma counter=78 i=2 t=2.39e-04 per=1.21e+01 cost=7.01e+03 flops=2.93e+07
 sigma counter=78 i=3 t=2.47e-04 per=1.25e+01 cost=6.99e+03 flops=2.83e+07
 sigma counter=78 i=4 t=2.37e-04 per=1.20e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=78 i=5 t=2.43e-04 per=1.23e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=78 i=6 t=2.66e-04 per=1.34e+01 cost=1.89e+04 flops=7.10e+07
 sigma counter=78 i=7 t=2.54e-04 per=1.28e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=3.98e+07
--- TIMING FOR sigma_tot : t_inter=1.57e-02 t_gemm=1.52e-01 t_reduction=1.54e-02 tot=1.83e-01 ---
 sigma_tot counter=78 i=0 t=1.88e-02 per=1.24e+01 cost=3.81e+05 flops=2.02e+07
 sigma_tot counter=78 i=1 t=1.93e-02 per=1.27e+01 cost=3.94e+05 flops=2.04e+07
 sigma_tot counter=78 i=2 t=1.86e-02 per=1.23e+01 cost=3.87e+05 flops=2.08e+07
 sigma_tot counter=78 i=3 t=1.87e-02 per=1.23e+01 cost=3.94e+05 flops=2.11e+07
 sigma_tot counter=78 i=4 t=1.86e-02 per=1.23e+01 cost=6.07e+05 flops=3.26e+07
 sigma_tot counter=78 i=5 t=1.89e-02 per=1.24e+01 cost=6.05e+05 flops=3.21e+07
 sigma_tot counter=78 i=6 t=1.97e-02 per=1.30e+01 cost=7.60e+05 flops=3.85e+07
 sigma_tot counter=78 i=7 t=1.90e-02 per=1.25e+01 cost=7.51e+05 flops=3.96e+07
 total GEMM cost=4.28e+06 flops=2.82e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,2.01e-04,1.97e-03,1.91e-04 cost=7.90e+04 flops[gemm]=4.01e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.97e-03 t_reduction=1.91e-04 tot=2.36e-03 ---
 sigma counter=79 i=0 t=2.39e-04 per=1.21e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=79 i=1 t=2.49e-04 per=1.26e+01 cost=6.78e+03 flops=2.72e+07
 sigma counter=79 i=2 t=2.40e-04 per=1.22e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=79 i=3 t=2.43e-04 per=1.23e+01 cost=6.99e+03 flops=2.88e+07
 sigma counter=79 i=4 t=2.38e-04 per=1.21e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=79 i=5 t=2.45e-04 per=1.24e+01 cost=6.78e+03 flops=2.77e+07
 sigma counter=79 i=6 t=2.66e-04 per=1.35e+01 cost=1.89e+04 flops=7.10e+07
 sigma counter=79 i=7 t=2.51e-04 per=1.27e+01 cost=1.89e+04 flops=7.53e+07
 total GEMM cost=7.90e+04 flops=4.01e+07
--- TIMING FOR sigma_tot : t_inter=1.59e-02 t_gemm=1.53e-01 t_reduction=1.55e-02 tot=1.85e-01 ---
 sigma_tot counter=79 i=0 t=1.91e-02 per=1.24e+01 cost=3.87e+05 flops=2.03e+07
 sigma_tot counter=79 i=1 t=1.95e-02 per=1.27e+01 cost=4.00e+05 flops=2.05e+07
 sigma_tot counter=79 i=2 t=1.88e-02 per=1.23e+01 cost=3.94e+05 flops=2.09e+07
 sigma_tot counter=79 i=3 t=1.90e-02 per=1.23e+01 cost=4.01e+05 flops=2.12e+07
 sigma_tot counter=79 i=4 t=1.88e-02 per=1.23e+01 cost=6.14e+05 flops=3.26e+07
 sigma_tot counter=79 i=5 t=1.91e-02 per=1.24e+01 cost=6.12e+05 flops=3.20e+07
 sigma_tot counter=79 i=6 t=2.00e-02 per=1.30e+01 cost=7.79e+05 flops=3.90e+07
 sigma_tot counter=79 i=7 t=1.92e-02 per=1.25e+01 cost=7.70e+05 flops=4.01e+07
 total GEMM cost=4.36e+06 flops=2.84e+07
    6   0 -      -2.654516957904  -1.18e-07   1.26e-04    6    12   3.04e-02  2.53e-03
    6   1 -      -2.436977427914  -1.18e-07   1.80e-04    6    12   3.04e-02  2.53e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.02e-04,1.98e-03,2.07e-04 cost=7.90e+04 flops[gemm]=4.00e+07
--- TIMING FOR sigma : t_inter=2.02e-04 t_gemm=1.97e-03 t_reduction=2.07e-04 tot=2.38e-03 ---
 sigma counter=80 i=0 t=2.37e-04 per=1.20e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=80 i=1 t=2.46e-04 per=1.25e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=80 i=2 t=2.37e-04 per=1.20e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=80 i=3 t=2.47e-04 per=1.25e+01 cost=6.99e+03 flops=2.83e+07
 sigma counter=80 i=4 t=2.48e-04 per=1.26e+01 cost=6.81e+03 flops=2.75e+07
 sigma counter=80 i=5 t=2.41e-04 per=1.22e+01 cost=6.78e+03 flops=2.81e+07
 sigma counter=80 i=6 t=2.65e-04 per=1.34e+01 cost=1.89e+04 flops=7.13e+07
 sigma counter=80 i=7 t=2.54e-04 per=1.29e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=4.00e+07
--- TIMING FOR sigma_tot : t_inter=1.61e-02 t_gemm=1.55e-01 t_reduction=1.58e-02 tot=1.87e-01 ---
 sigma_tot counter=80 i=0 t=1.93e-02 per=1.24e+01 cost=3.94e+05 flops=2.04e+07
 sigma_tot counter=80 i=1 t=1.98e-02 per=1.27e+01 cost=4.07e+05 flops=2.06e+07
 sigma_tot counter=80 i=2 t=1.91e-02 per=1.23e+01 cost=4.01e+05 flops=2.10e+07
 sigma_tot counter=80 i=3 t=1.92e-02 per=1.23e+01 cost=4.08e+05 flops=2.13e+07
 sigma_tot counter=80 i=4 t=1.91e-02 per=1.23e+01 cost=6.20e+05 flops=3.25e+07
 sigma_tot counter=80 i=5 t=1.93e-02 per=1.24e+01 cost=6.18e+05 flops=3.20e+07
 sigma_tot counter=80 i=6 t=2.02e-02 per=1.30e+01 cost=7.98e+05 flops=3.94e+07
 sigma_tot counter=80 i=7 t=1.95e-02 per=1.25e+01 cost=7.89e+05 flops=4.05e+07
 total GEMM cost=4.44e+06 flops=2.85e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.99e-04,1.95e-03,1.90e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.95e-03 t_reduction=1.90e-04 tot=2.34e-03 ---
 sigma counter=81 i=0 t=2.38e-04 per=1.22e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=81 i=1 t=2.40e-04 per=1.23e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=81 i=2 t=2.38e-04 per=1.22e+01 cost=7.01e+03 flops=2.94e+07
 sigma counter=81 i=3 t=2.39e-04 per=1.23e+01 cost=6.99e+03 flops=2.92e+07
 sigma counter=81 i=4 t=2.37e-04 per=1.22e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=81 i=5 t=2.41e-04 per=1.24e+01 cost=6.78e+03 flops=2.81e+07
 sigma counter=81 i=6 t=2.64e-04 per=1.36e+01 cost=1.89e+04 flops=7.16e+07
 sigma counter=81 i=7 t=2.51e-04 per=1.29e+01 cost=1.89e+04 flops=7.53e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=1.63e-02 t_gemm=1.57e-01 t_reduction=1.59e-02 tot=1.90e-01 ---
 sigma_tot counter=81 i=0 t=1.95e-02 per=1.24e+01 cost=4.01e+05 flops=2.05e+07
 sigma_tot counter=81 i=1 t=2.00e-02 per=1.27e+01 cost=4.14e+05 flops=2.07e+07
 sigma_tot counter=81 i=2 t=1.93e-02 per=1.23e+01 cost=4.08e+05 flops=2.11e+07
 sigma_tot counter=81 i=3 t=1.94e-02 per=1.23e+01 cost=4.15e+05 flops=2.14e+07
 sigma_tot counter=81 i=4 t=1.93e-02 per=1.23e+01 cost=6.27e+05 flops=3.25e+07
 sigma_tot counter=81 i=5 t=1.96e-02 per=1.24e+01 cost=6.25e+05 flops=3.19e+07
 sigma_tot counter=81 i=6 t=2.05e-02 per=1.30e+01 cost=8.16e+05 flops=3.98e+07
 sigma_tot counter=81 i=7 t=1.97e-02 per=1.25e+01 cost=8.08e+05 flops=4.10e+07
 total GEMM cost=4.51e+06 flops=2.87e+07
    7   0 +      -2.654516967213  -9.31e-09   3.92e-05    6    14   3.53e-02  2.52e-03
    7   1 +      -2.436977447783  -1.99e-08   6.16e-05    6    14   3.53e-02  2.52e-03
TIMING for Davidson : 3.53e-02  T(cal/comm/rest)=3.50e-02,7.21e-07,3.22e-04
optimized energies: isweep=1 dots=2 ibond=1 e[0]=-2.65451696721
optimized energies: isweep=1 dots=2 ibond=1 e[1]=-2.43697744778
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep1_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=1.588e-05 (comb,oper,dvdson,hvec,renorm)=2.272e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.737e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 1.988e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=3.26e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Rlist : 0.000737 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.81e-05,0.000398,0.000291 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000932 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07,0.0009
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00019,0.00109,0.000196 cost=1.55e+05 flops[gemm]=1.43e+08
--- TIMING FOR renorm : t_inter=0.000189 t_gemm=0.00109 t_reduction=0.000196 tot=0.00147 ---
 renorm counter=6 i=0 t=0.000209 per=19.3 cost=8.1e+03 flops=3.87e+07
 renorm counter=6 i=1 t=0.000207 per=19.1 cost=8.36e+03 flops=4.04e+07
 renorm counter=6 i=2 t=1e-06 per=0.0922 cost=0 flops=0
 renorm counter=6 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=6 i=4 t=0.000206 per=19 cost=1.65e+04 flops=8e+07
 renorm counter=6 i=5 t=0.000214 per=19.7 cost=2.89e+04 flops=1.35e+08
 renorm counter=6 i=6 t=0.000248 per=22.9 cost=9.32e+04 flops=3.76e+08
 total GEMM cost=1.55e+05 flops=1.43e+08
--- TIMING FOR renorm_tot : t_inter=0.00061 t_gemm=0.00667 t_reduction=0.00118 tot=0.00846 ---
 renorm_tot counter=6 i=0 t=0.00131 per=19.7 cost=1.71e+04 flops=1.3e+07
 renorm_tot counter=6 i=1 t=0.00134 per=20 cost=2.18e+04 flops=1.63e+07
 renorm_tot counter=6 i=2 t=0.000436 per=6.54 cost=5.99e+03 flops=1.37e+07
 renorm_tot counter=6 i=3 t=0.000442 per=6.63 cost=1.09e+04 flops=2.47e+07
 renorm_tot counter=6 i=4 t=0.000844 per=12.7 cost=2.43e+04 flops=2.88e+07
 renorm_tot counter=6 i=5 t=0.000856 per=12.8 cost=4.24e+04 flops=4.96e+07
 renorm_tot counter=6 i=6 t=0.00144 per=21.6 cost=1.78e+05 flops=1.23e+08
 total GEMM cost=3.01e+05 flops=4.51e+07
check ||H-H.dagger||=8.79e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0031 S T(init/kernel/comm)=7.5e-05,0.003,9.3e-06 rank=0 -----
===== CPUmem(GB): tot=1.6e-05 (comb,oper,dvdson,hvec,renorm)=2.3e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=220:0.0017MB:1.6e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=347:0.0026MB:2.6e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.6e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(2,0) size=1.94e-05GB T[save](info/data/tot)=5.27e-05,4.15e-05,9.43e-05 speed=0.205GB/s disk[used]=8.12e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
##### time_local: 4.49e-02 S #####
 T(fetch) = 3.69e-04 S  per = 0.82  per(accum) = 0.82
 T(hdiag) = 8.45e-05 S  per = 0.19  per(accum) = 1
 T(dvdsn) = 4.04e-02 S  per =   90  per(accum) = 91
 T(decim) = 3.23e-04 S  per = 0.72  per(accum) = 92
 T(guess) = 7.67e-05 S  per = 0.17  per(accum) = 92
 T(renrm) = 3.15e-03 S  per =    7  per(accum) = 99
 T(save ) = 5.58e-04 S  per =  1.2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.02e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.12e-05 S  per =  0.1  per(accum) = 0.1
 T(symbolic_formulae_twodot     ) = 2.84e-04 S  per = 0.71  per(accum) = 0.81
 T(hintermediate init           ) = 2.66e-05 S  per = 0.066  per(accum) = 0.88
 T(hintermediates memcpy cpu2gpu) = 4.40e-06 S  per = 0.011  per(accum) = 0.89
 T(preprocess_hformulae_Hxlist2 ) = 2.77e-03 S  per =  6.9  per(accum) = 7.8
 T(hmmtasks init                ) = 1.71e-03 S  per =  4.3  per(accum) = 12
 T(dvdson solver [Hx_batchGPU]  ) = 3.50e-02 S  per =   87  per(accum) = 99
 T(dvdson solver [communication]) = 7.21e-07 S  per = 0.0018  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.22e-04 S  per =  0.8  per(accum) = 1e+02
Detailed decomposition of T(renrm): 3.11e-03 S
 T(qops init                    ) = 7.55e-05 S  per =  2.4  per(accum) = 2.4
 T(qops_dict memcpy cpu2gpu     ) = 3.50e-05 S  per =  1.1  per(accum) = 3.6
 T(symbolic_formulae_renorm     ) = 1.78e-04 S  per =  5.7  per(accum) = 9.3
 T(rintermediate init           ) = 2.30e-05 S  per = 0.74  per(accum) = 10
 T(rintermediates memcpy cpu2gpu) = 4.92e-06 S  per = 0.16  per(accum) = 10
 T(preprocess_formulae_Rlist2   ) = 7.48e-04 S  per =   24  per(accum) = 34
 T(rmmtasks init                ) = 4.43e-04 S  per =   14  per(accum) = 49
 T(qops memset                  ) = 9.05e-06 S  per = 0.29  per(accum) = 49
 T(preprocess_renorm_batchGPU   ) = 1.55e-03 S  per =   50  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.88e-05 S  per = 0.93  per(accum) = 1e+02
 T(communication of opS and opH ) = 9.32e-06 S  per =  0.3  per(accum) = 1e+02
##### time_sweep: 8.81e-02 S #####
 T(fetch) = 5.00e-04 S  per = 0.57  per(accum) = 0.57
 T(hdiag) = 1.96e-04 S  per = 0.22  per(accum) = 0.79
 T(dvdsn) = 7.95e-02 S  per =   90  per(accum) = 91
 T(decim) = 3.99e-04 S  per = 0.45  per(accum) = 92
 T(guess) = 1.48e-04 S  per = 0.17  per(accum) = 92
 T(renrm) = 6.14e-03 S  per =    7  per(accum) = 99
 T(save ) = 1.16e-03 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 7.91e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 9.90e-05 S  per = 0.13  per(accum) = 0.13
 T(symbolic_formulae_twodot     ) = 6.00e-04 S  per = 0.76  per(accum) = 0.88
 T(hintermediate init           ) = 5.48e-05 S  per = 0.069  per(accum) = 0.95
 T(hintermediates memcpy cpu2gpu) = 9.32e-06 S  per = 0.012  per(accum) = 0.96
 T(preprocess_hformulae_Hxlist2 ) = 4.37e-03 S  per =  5.5  per(accum) = 6.5
 T(hmmtasks init                ) = 2.76e-03 S  per =  3.5  per(accum) = 10
 T(dvdson solver [Hx_batchGPU]  ) = 7.05e-02 S  per =   89  per(accum) = 99
 T(dvdson solver [communication]) = 1.35e-06 S  per = 0.0017  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.29e-04 S  per = 0.92  per(accum) = 1e+02
Detailed decomposition of T(renrm): 6.04e-03 S
 T(qops init                    ) = 1.85e-04 S  per =  3.1  per(accum) = 3.1
 T(qops_dict memcpy cpu2gpu     ) = 6.59e-05 S  per =  1.1  per(accum) = 4.1
 T(symbolic_formulae_renorm     ) = 4.19e-04 S  per =  6.9  per(accum) = 11
 T(rintermediate init           ) = 3.42e-05 S  per = 0.57  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 1.05e-05 S  per = 0.17  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 1.41e-03 S  per =   23  per(accum) = 35
 T(rmmtasks init                ) = 8.61e-04 S  per =   14  per(accum) = 49
 T(qops memset                  ) = 1.85e-05 S  per = 0.31  per(accum) = 50
 T(preprocess_renorm_batchGPU   ) = 2.95e-03 S  per =   49  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 6.11e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.94e-05 S  per = 0.32  per(accum) = 1e+02
##### time_global: 2.55e-01 S #####
 T(fetch) = 1.88e-03 S  per = 0.74  per(accum) = 0.74
 T(hdiag) = 5.55e-04 S  per = 0.22  per(accum) = 0.96
 T(dvdsn) = 2.28e-01 S  per =   90  per(accum) = 91
 T(decim) = 1.98e-03 S  per = 0.78  per(accum) = 91
 T(guess) = 5.84e-04 S  per = 0.23  per(accum) = 92
 T(renrm) = 1.78e-02 S  per =    7  per(accum) = 99
 T(save ) = 3.73e-03 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 2.27e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 2.70e-04 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 1.81e-03 S  per =  0.8  per(accum) = 0.92
 T(hintermediate init           ) = 1.79e-04 S  per = 0.079  per(accum) = 0.99
 T(hintermediates memcpy cpu2gpu) = 3.02e-05 S  per = 0.013  per(accum) = 1
 T(preprocess_hformulae_Hxlist2 ) = 1.35e-02 S  per =  5.9  per(accum) = 7
 T(hmmtasks init                ) = 8.73e-03 S  per =  3.8  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 2.00e-01 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 5.27e-06 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 2.60e-03 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.75e-02 S
 T(qops init                    ) = 1.01e-03 S  per =  5.8  per(accum) = 5.8
 T(qops_dict memcpy cpu2gpu     ) = 2.44e-04 S  per =  1.4  per(accum) = 7.2
 T(symbolic_formulae_renorm     ) = 1.46e-03 S  per =  8.3  per(accum) = 16
 T(rintermediate init           ) = 1.22e-04 S  per =  0.7  per(accum) = 16
 T(rintermediates memcpy cpu2gpu) = 3.67e-05 S  per = 0.21  per(accum) = 16
 T(preprocess_formulae_Rlist2   ) = 3.21e-03 S  per =   18  per(accum) = 35
 T(rmmtasks init                ) = 2.03e-03 S  per =   12  per(accum) = 47
 T(qops memset                  ) = 5.81e-05 S  per = 0.33  per(accum) = 47
 T(preprocess_renorm_batchGPU   ) = 9.03e-03 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.88e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 6.15e-05 S  per = 0.35  per(accum) = 1e+02

isweep=1 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.168e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=220:0.00168MB:1.64e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=347:0.00265MB:2.59e-06GB
===== CPUmem(GB): tot=3.55e-05 (comb,oper,dvdson,hvec,renorm)=2.59e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44953290
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.439e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 2.496e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00281 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.72e-05,0.00135,0.0014 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=5.04e-05 (comb,oper,dvdson,hvec,renorm)=2.59e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.6e-05,0.000205,0.00199,0.00019 cost=7.9e+04 flops[gemm]=3.97e+07
--- TIMING FOR sigma : t_inter=0.000205 t_gemm=0.00199 t_reduction=0.00019 tot=0.00238 ---
 sigma counter=82 i=0 t=0.000243 per=12.2 cost=6.81e+03 flops=2.8e+07
 sigma counter=82 i=1 t=0.000256 per=12.9 cost=6.78e+03 flops=2.65e+07
 sigma counter=82 i=2 t=0.000242 per=12.2 cost=7.01e+03 flops=2.9e+07
 sigma counter=82 i=3 t=0.000244 per=12.3 cost=6.99e+03 flops=2.86e+07
 sigma counter=82 i=4 t=0.000238 per=12 cost=6.81e+03 flops=2.86e+07
 sigma counter=82 i=5 t=0.000244 per=12.3 cost=6.78e+03 flops=2.78e+07
 sigma counter=82 i=6 t=0.000263 per=13.2 cost=1.89e+04 flops=7.18e+07
 sigma counter=82 i=7 t=0.000257 per=12.9 cost=1.89e+04 flops=7.35e+07
 total GEMM cost=7.9e+04 flops=3.97e+07
--- TIMING FOR sigma_tot : t_inter=0.0166 t_gemm=0.159 t_reduction=0.0161 tot=0.192 ---
 sigma_tot counter=82 i=0 t=0.0198 per=12.4 cost=4.08e+05 flops=2.06e+07
 sigma_tot counter=82 i=1 t=0.0203 per=12.7 cost=4.21e+05 flops=2.08e+07
 sigma_tot counter=82 i=2 t=0.0195 per=12.3 cost=4.15e+05 flops=2.12e+07
 sigma_tot counter=82 i=3 t=0.0197 per=12.3 cost=4.22e+05 flops=2.15e+07
 sigma_tot counter=82 i=4 t=0.0196 per=12.3 cost=6.34e+05 flops=3.24e+07
 sigma_tot counter=82 i=5 t=0.0198 per=12.4 cost=6.32e+05 flops=3.19e+07
 sigma_tot counter=82 i=6 t=0.0208 per=13 cost=8.35e+05 flops=4.02e+07
 sigma_tot counter=82 i=7 t=0.02 per=12.5 cost=8.27e+05 flops=4.14e+07
 total GEMM cost=4.59e+06 flops=2.88e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.7e-05,0.000202,0.00194,0.000189 cost=7.9e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0.000202 t_gemm=0.00194 t_reduction=0.000189 tot=0.00233 ---
 sigma counter=83 i=0 t=0.000234 per=12 cost=6.81e+03 flops=2.91e+07
 sigma counter=83 i=1 t=0.000237 per=12.2 cost=6.78e+03 flops=2.86e+07
 sigma counter=83 i=2 t=0.000237 per=12.2 cost=7.01e+03 flops=2.96e+07
 sigma counter=83 i=3 t=0.000244 per=12.6 cost=6.99e+03 flops=2.86e+07
 sigma counter=83 i=4 t=0.000235 per=12.1 cost=6.81e+03 flops=2.9e+07
 sigma counter=83 i=5 t=0.000238 per=12.3 cost=6.78e+03 flops=2.85e+07
 sigma counter=83 i=6 t=0.000262 per=13.5 cost=1.89e+04 flops=7.21e+07
 sigma counter=83 i=7 t=0.000255 per=13.1 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.9e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0.0168 t_gemm=0.161 t_reduction=0.0163 tot=0.194 ---
 sigma_tot counter=83 i=0 t=0.02 per=12.4 cost=4.15e+05 flops=2.07e+07
 sigma_tot counter=83 i=1 t=0.0205 per=12.7 cost=4.28e+05 flops=2.08e+07
 sigma_tot counter=83 i=2 t=0.0198 per=12.3 cost=4.22e+05 flops=2.13e+07
 sigma_tot counter=83 i=3 t=0.0199 per=12.3 cost=4.29e+05 flops=2.15e+07
 sigma_tot counter=83 i=4 t=0.0198 per=12.3 cost=6.41e+05 flops=3.24e+07
 sigma_tot counter=83 i=5 t=0.0201 per=12.4 cost=6.39e+05 flops=3.18e+07
 sigma_tot counter=83 i=6 t=0.021 per=13 cost=8.54e+05 flops=4.06e+07
 sigma_tot counter=83 i=7 t=0.0202 per=12.5 cost=8.46e+05 flops=4.18e+07
 total GEMM cost=4.67e+06 flops=2.9e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588771076  -1.00e+03   7.01e-02    2     2   4.95e-03  2.47e-03
    1   1 -      -2.436093960617  -1.00e+03   4.92e-02    2     2   4.95e-03  2.47e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.99e-04,1.94e-03,1.97e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.94e-03 t_reduction=1.97e-04 tot=2.34e-03 ---
 sigma counter=84 i=0 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=84 i=1 t=2.38e-04 per=1.23e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=84 i=2 t=2.36e-04 per=1.22e+01 cost=7.01e+03 flops=2.97e+07
 sigma counter=84 i=3 t=2.38e-04 per=1.23e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=84 i=4 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=84 i=5 t=2.38e-04 per=1.23e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=84 i=6 t=2.67e-04 per=1.37e+01 cost=1.89e+04 flops=7.08e+07
 sigma counter=84 i=7 t=2.57e-04 per=1.32e+01 cost=1.89e+04 flops=7.35e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=1.70e-02 t_gemm=1.63e-01 t_reduction=1.65e-02 tot=1.97e-01 ---
 sigma_tot counter=84 i=0 t=2.03e-02 per=1.24e+01 cost=4.21e+05 flops=2.08e+07
 sigma_tot counter=84 i=1 t=2.07e-02 per=1.27e+01 cost=4.34e+05 flops=2.09e+07
 sigma_tot counter=84 i=2 t=2.00e-02 per=1.23e+01 cost=4.29e+05 flops=2.14e+07
 sigma_tot counter=84 i=3 t=2.02e-02 per=1.23e+01 cost=4.36e+05 flops=2.16e+07
 sigma_tot counter=84 i=4 t=2.00e-02 per=1.23e+01 cost=6.48e+05 flops=3.23e+07
 sigma_tot counter=84 i=5 t=2.03e-02 per=1.24e+01 cost=6.46e+05 flops=3.18e+07
 sigma_tot counter=84 i=6 t=2.13e-02 per=1.30e+01 cost=8.73e+05 flops=4.10e+07
 sigma_tot counter=84 i=7 t=2.05e-02 per=1.25e+01 cost=8.65e+05 flops=4.22e+07
 total GEMM cost=4.75e+06 flops=2.91e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,2.01e-04,1.96e-03,1.92e-04 cost=7.90e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.96e-03 t_reduction=1.92e-04 tot=2.35e-03 ---
 sigma counter=85 i=0 t=2.42e-04 per=1.24e+01 cost=6.81e+03 flops=2.82e+07
 sigma counter=85 i=1 t=2.40e-04 per=1.23e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=85 i=2 t=2.35e-04 per=1.20e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=85 i=3 t=2.38e-04 per=1.21e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=85 i=4 t=2.37e-04 per=1.21e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=85 i=5 t=2.37e-04 per=1.21e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=85 i=6 t=2.73e-04 per=1.39e+01 cost=1.89e+04 flops=6.92e+07
 sigma counter=85 i=7 t=2.57e-04 per=1.31e+01 cost=1.89e+04 flops=7.35e+07
 total GEMM cost=7.90e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=1.72e-02 t_gemm=1.65e-01 t_reduction=1.67e-02 tot=1.99e-01 ---
 sigma_tot counter=85 i=0 t=2.05e-02 per=1.24e+01 cost=4.28e+05 flops=2.09e+07
 sigma_tot counter=85 i=1 t=2.10e-02 per=1.27e+01 cost=4.41e+05 flops=2.10e+07
 sigma_tot counter=85 i=2 t=2.03e-02 per=1.23e+01 cost=4.36e+05 flops=2.15e+07
 sigma_tot counter=85 i=3 t=2.04e-02 per=1.23e+01 cost=4.43e+05 flops=2.17e+07
 sigma_tot counter=85 i=4 t=2.03e-02 per=1.23e+01 cost=6.54e+05 flops=3.23e+07
 sigma_tot counter=85 i=5 t=2.05e-02 per=1.24e+01 cost=6.52e+05 flops=3.18e+07
 sigma_tot counter=85 i=6 t=2.16e-02 per=1.31e+01 cost=8.92e+05 flops=4.14e+07
 sigma_tot counter=85 i=7 t=2.07e-02 per=1.25e+01 cost=8.83e+05 flops=4.26e+07
 total GEMM cost=4.83e+06 flops=2.92e+07
    2   0 -      -2.654426819280  -1.84e-03   1.26e-02    4     4   9.88e-03  2.47e-03
    2   1 -      -2.436959163109  -8.65e-04   5.19e-03    4     4   9.88e-03  2.47e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,2.00e-04,1.94e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=2.00e-04 t_gemm=1.94e-03 t_reduction=1.89e-04 tot=2.33e-03 ---
 sigma counter=86 i=0 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=86 i=1 t=2.40e-04 per=1.24e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=86 i=2 t=2.40e-04 per=1.24e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=86 i=3 t=2.42e-04 per=1.25e+01 cost=6.99e+03 flops=2.89e+07
 sigma counter=86 i=4 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=86 i=5 t=2.40e-04 per=1.24e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=86 i=6 t=2.64e-04 per=1.36e+01 cost=1.89e+04 flops=7.16e+07
 sigma counter=86 i=7 t=2.48e-04 per=1.28e+01 cost=1.89e+04 flops=7.62e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=1.74e-02 t_gemm=1.67e-01 t_reduction=1.69e-02 tot=2.01e-01 ---
 sigma_tot counter=86 i=0 t=2.07e-02 per=1.24e+01 cost=4.35e+05 flops=2.10e+07
 sigma_tot counter=86 i=1 t=2.12e-02 per=1.27e+01 cost=4.48e+05 flops=2.11e+07
 sigma_tot counter=86 i=2 t=2.05e-02 per=1.23e+01 cost=4.43e+05 flops=2.16e+07
 sigma_tot counter=86 i=3 t=2.06e-02 per=1.23e+01 cost=4.50e+05 flops=2.18e+07
 sigma_tot counter=86 i=4 t=2.05e-02 per=1.23e+01 cost=6.61e+05 flops=3.23e+07
 sigma_tot counter=86 i=5 t=2.08e-02 per=1.24e+01 cost=6.59e+05 flops=3.17e+07
 sigma_tot counter=86 i=6 t=2.18e-02 per=1.31e+01 cost=9.11e+05 flops=4.17e+07
 sigma_tot counter=86 i=7 t=2.10e-02 per=1.26e+01 cost=9.02e+05 flops=4.30e+07
 total GEMM cost=4.91e+06 flops=2.94e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.96e-04,1.94e-03,1.90e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.94e-03 t_reduction=1.90e-04 tot=2.33e-03 ---
 sigma counter=87 i=0 t=2.38e-04 per=1.22e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=87 i=1 t=2.39e-04 per=1.23e+01 cost=6.78e+03 flops=2.84e+07
 sigma counter=87 i=2 t=2.39e-04 per=1.23e+01 cost=7.01e+03 flops=2.93e+07
 sigma counter=87 i=3 t=2.38e-04 per=1.22e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=87 i=4 t=2.38e-04 per=1.22e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=87 i=5 t=2.39e-04 per=1.23e+01 cost=6.78e+03 flops=2.84e+07
 sigma counter=87 i=6 t=2.64e-04 per=1.36e+01 cost=1.89e+04 flops=7.16e+07
 sigma counter=87 i=7 t=2.48e-04 per=1.28e+01 cost=1.89e+04 flops=7.62e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=1.76e-02 t_gemm=1.69e-01 t_reduction=1.71e-02 tot=2.04e-01 ---
 sigma_tot counter=87 i=0 t=2.10e-02 per=1.24e+01 cost=4.42e+05 flops=2.11e+07
 sigma_tot counter=87 i=1 t=2.15e-02 per=1.27e+01 cost=4.55e+05 flops=2.12e+07
 sigma_tot counter=87 i=2 t=2.07e-02 per=1.23e+01 cost=4.50e+05 flops=2.17e+07
 sigma_tot counter=87 i=3 t=2.09e-02 per=1.23e+01 cost=4.57e+05 flops=2.19e+07
 sigma_tot counter=87 i=4 t=2.07e-02 per=1.23e+01 cost=6.68e+05 flops=3.22e+07
 sigma_tot counter=87 i=5 t=2.10e-02 per=1.24e+01 cost=6.66e+05 flops=3.17e+07
 sigma_tot counter=87 i=6 t=2.21e-02 per=1.31e+01 cost=9.30e+05 flops=4.21e+07
 sigma_tot counter=87 i=7 t=2.12e-02 per=1.26e+01 cost=9.21e+05 flops=4.34e+07
 total GEMM cost=4.99e+06 flops=2.95e+07
    3   0 -      -2.654508896837  -8.21e-05   3.56e-03    6     6   1.48e-02  2.46e-03
    3   1 -      -2.436975274429  -1.61e-05   1.59e-03    6     6   1.48e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.99e-04,2.74e-03,1.90e-04 cost=7.90e+04 flops[gemm]=2.88e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=2.74e-03 t_reduction=1.90e-04 tot=3.13e-03 ---
 sigma counter=88 i=0 t=2.36e-04 per=8.62e+00 cost=6.81e+03 flops=2.89e+07
 sigma counter=88 i=1 t=2.40e-04 per=8.77e+00 cost=6.78e+03 flops=2.83e+07
 sigma counter=88 i=2 t=2.40e-04 per=8.77e+00 cost=7.01e+03 flops=2.92e+07
 sigma counter=88 i=3 t=2.43e-04 per=8.88e+00 cost=6.99e+03 flops=2.88e+07
 sigma counter=88 i=4 t=2.33e-04 per=8.51e+00 cost=6.81e+03 flops=2.92e+07
 sigma counter=88 i=5 t=2.40e-04 per=8.77e+00 cost=6.78e+03 flops=2.83e+07
 sigma counter=88 i=6 t=1.06e-03 per=3.86e+01 cost=1.89e+04 flops=1.79e+07
 sigma counter=88 i=7 t=2.50e-04 per=9.13e+00 cost=1.89e+04 flops=7.56e+07
 total GEMM cost=7.90e+04 flops=2.88e+07
--- TIMING FOR sigma_tot : t_inter=1.78e-02 t_gemm=1.72e-01 t_reduction=1.73e-02 tot=2.07e-01 ---
 sigma_tot counter=88 i=0 t=2.12e-02 per=1.23e+01 cost=4.49e+05 flops=2.12e+07
 sigma_tot counter=88 i=1 t=2.17e-02 per=1.26e+01 cost=4.61e+05 flops=2.13e+07
 sigma_tot counter=88 i=2 t=2.10e-02 per=1.22e+01 cost=4.57e+05 flops=2.18e+07
 sigma_tot counter=88 i=3 t=2.11e-02 per=1.23e+01 cost=4.64e+05 flops=2.20e+07
 sigma_tot counter=88 i=4 t=2.10e-02 per=1.22e+01 cost=6.75e+05 flops=3.22e+07
 sigma_tot counter=88 i=5 t=2.13e-02 per=1.24e+01 cost=6.73e+05 flops=3.16e+07
 sigma_tot counter=88 i=6 t=2.32e-02 per=1.35e+01 cost=9.49e+05 flops=4.10e+07
 sigma_tot counter=88 i=7 t=2.15e-02 per=1.25e+01 cost=9.40e+05 flops=4.38e+07
 total GEMM cost=5.07e+06 flops=2.95e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.96e-04,1.97e-03,1.93e-04 cost=7.90e+04 flops[gemm]=4.02e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.97e-03 t_reduction=1.93e-04 tot=2.35e-03 ---
 sigma counter=89 i=0 t=2.35e-04 per=1.20e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=89 i=1 t=2.42e-04 per=1.23e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=89 i=2 t=2.37e-04 per=1.21e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=89 i=3 t=2.39e-04 per=1.22e+01 cost=6.99e+03 flops=2.92e+07
 sigma counter=89 i=4 t=2.36e-04 per=1.20e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=89 i=5 t=2.47e-04 per=1.26e+01 cost=6.78e+03 flops=2.75e+07
 sigma counter=89 i=6 t=2.71e-04 per=1.38e+01 cost=1.89e+04 flops=6.97e+07
 sigma counter=89 i=7 t=2.59e-04 per=1.32e+01 cost=1.89e+04 flops=7.30e+07
 total GEMM cost=7.90e+04 flops=4.02e+07
--- TIMING FOR sigma_tot : t_inter=1.79e-02 t_gemm=1.74e-01 t_reduction=1.75e-02 tot=2.09e-01 ---
 sigma_tot counter=89 i=0 t=2.14e-02 per=1.23e+01 cost=4.56e+05 flops=2.12e+07
 sigma_tot counter=89 i=1 t=2.19e-02 per=1.26e+01 cost=4.68e+05 flops=2.13e+07
 sigma_tot counter=89 i=2 t=2.12e-02 per=1.22e+01 cost=4.64e+05 flops=2.19e+07
 sigma_tot counter=89 i=3 t=2.14e-02 per=1.23e+01 cost=4.71e+05 flops=2.21e+07
 sigma_tot counter=89 i=4 t=2.12e-02 per=1.22e+01 cost=6.82e+05 flops=3.22e+07
 sigma_tot counter=89 i=5 t=2.15e-02 per=1.24e+01 cost=6.80e+05 flops=3.16e+07
 sigma_tot counter=89 i=6 t=2.34e-02 per=1.35e+01 cost=9.68e+05 flops=4.13e+07
 sigma_tot counter=89 i=7 t=2.17e-02 per=1.25e+01 cost=9.59e+05 flops=4.41e+07
 total GEMM cost=5.15e+06 flops=2.96e+07
    4   0 -      -2.654515664927  -6.77e-06   1.29e-03    6     8   2.05e-02  2.56e-03
    4   1 -      -2.436977078524  -1.80e-06   5.94e-04    6     8   2.05e-02  2.56e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.07e-04,1.97e-03,1.91e-04 cost=7.90e+04 flops[gemm]=4.02e+07
--- TIMING FOR sigma : t_inter=2.07e-04 t_gemm=1.97e-03 t_reduction=1.91e-04 tot=2.37e-03 ---
 sigma counter=90 i=0 t=2.38e-04 per=1.21e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=90 i=1 t=2.40e-04 per=1.22e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=90 i=2 t=2.37e-04 per=1.20e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=90 i=3 t=2.50e-04 per=1.27e+01 cost=6.99e+03 flops=2.80e+07
 sigma counter=90 i=4 t=2.35e-04 per=1.19e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=90 i=5 t=2.37e-04 per=1.20e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=90 i=6 t=2.70e-04 per=1.37e+01 cost=1.89e+04 flops=7.00e+07
 sigma counter=90 i=7 t=2.60e-04 per=1.32e+01 cost=1.89e+04 flops=7.27e+07
 total GEMM cost=7.90e+04 flops=4.02e+07
--- TIMING FOR sigma_tot : t_inter=1.82e-02 t_gemm=1.76e-01 t_reduction=1.77e-02 tot=2.12e-01 ---
 sigma_tot counter=90 i=0 t=2.17e-02 per=1.23e+01 cost=4.62e+05 flops=2.13e+07
 sigma_tot counter=90 i=1 t=2.22e-02 per=1.26e+01 cost=4.75e+05 flops=2.14e+07
 sigma_tot counter=90 i=2 t=2.14e-02 per=1.22e+01 cost=4.71e+05 flops=2.20e+07
 sigma_tot counter=90 i=3 t=2.16e-02 per=1.23e+01 cost=4.78e+05 flops=2.21e+07
 sigma_tot counter=90 i=4 t=2.14e-02 per=1.22e+01 cost=6.89e+05 flops=3.21e+07
 sigma_tot counter=90 i=5 t=2.17e-02 per=1.24e+01 cost=6.86e+05 flops=3.16e+07
 sigma_tot counter=90 i=6 t=2.37e-02 per=1.35e+01 cost=9.87e+05 flops=4.16e+07
 sigma_tot counter=90 i=7 t=2.20e-02 per=1.25e+01 cost=9.78e+05 flops=4.44e+07
 total GEMM cost=5.23e+06 flops=2.97e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.98e-04,1.95e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.95e-03 t_reduction=1.89e-04 tot=2.33e-03 ---
 sigma counter=91 i=0 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=91 i=1 t=2.40e-04 per=1.23e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=91 i=2 t=2.35e-04 per=1.21e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=91 i=3 t=2.38e-04 per=1.22e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=91 i=4 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=91 i=5 t=2.49e-04 per=1.28e+01 cost=6.78e+03 flops=2.72e+07
 sigma counter=91 i=6 t=2.63e-04 per=1.35e+01 cost=1.89e+04 flops=7.18e+07
 sigma counter=91 i=7 t=2.54e-04 per=1.30e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=1.84e-02 t_gemm=1.78e-01 t_reduction=1.79e-02 tot=2.14e-01 ---
 sigma_tot counter=91 i=0 t=2.19e-02 per=1.23e+01 cost=4.69e+05 flops=2.14e+07
 sigma_tot counter=91 i=1 t=2.24e-02 per=1.26e+01 cost=4.82e+05 flops=2.15e+07
 sigma_tot counter=91 i=2 t=2.17e-02 per=1.22e+01 cost=4.78e+05 flops=2.20e+07
 sigma_tot counter=91 i=3 t=2.19e-02 per=1.23e+01 cost=4.85e+05 flops=2.22e+07
 sigma_tot counter=91 i=4 t=2.17e-02 per=1.22e+01 cost=6.95e+05 flops=3.21e+07
 sigma_tot counter=91 i=5 t=2.20e-02 per=1.24e+01 cost=6.93e+05 flops=3.15e+07
 sigma_tot counter=91 i=6 t=2.40e-02 per=1.35e+01 cost=1.01e+06 flops=4.20e+07
 sigma_tot counter=91 i=7 t=2.23e-02 per=1.25e+01 cost=9.97e+05 flops=4.48e+07
 total GEMM cost=5.30e+06 flops=2.98e+07
    5   0 -      -2.654516771391  -1.11e-06   5.13e-04    6    10   2.54e-02  2.54e-03
    5   1 -      -2.436977369938  -2.91e-07   2.87e-04    6    10   2.54e-02  2.54e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.03e-04,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=2.02e-04 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.33e-03 ---
 sigma counter=92 i=0 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=92 i=1 t=2.47e-04 per=1.27e+01 cost=6.78e+03 flops=2.75e+07
 sigma counter=92 i=2 t=2.32e-04 per=1.20e+01 cost=7.01e+03 flops=3.02e+07
 sigma counter=92 i=3 t=2.41e-04 per=1.24e+01 cost=6.99e+03 flops=2.90e+07
 sigma counter=92 i=4 t=2.34e-04 per=1.21e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=92 i=5 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=92 i=6 t=2.61e-04 per=1.34e+01 cost=1.89e+04 flops=7.24e+07
 sigma counter=92 i=7 t=2.47e-04 per=1.27e+01 cost=1.89e+04 flops=7.65e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=1.86e-02 t_gemm=1.80e-01 t_reduction=1.80e-02 tot=2.16e-01 ---
 sigma_tot counter=92 i=0 t=2.21e-02 per=1.23e+01 cost=4.76e+05 flops=2.15e+07
 sigma_tot counter=92 i=1 t=2.27e-02 per=1.26e+01 cost=4.89e+05 flops=2.15e+07
 sigma_tot counter=92 i=2 t=2.19e-02 per=1.22e+01 cost=4.85e+05 flops=2.21e+07
 sigma_tot counter=92 i=3 t=2.21e-02 per=1.23e+01 cost=4.92e+05 flops=2.23e+07
 sigma_tot counter=92 i=4 t=2.19e-02 per=1.22e+01 cost=7.02e+05 flops=3.21e+07
 sigma_tot counter=92 i=5 t=2.22e-02 per=1.24e+01 cost=7.00e+05 flops=3.15e+07
 sigma_tot counter=92 i=6 t=2.42e-02 per=1.35e+01 cost=1.02e+06 flops=4.23e+07
 sigma_tot counter=92 i=7 t=2.25e-02 per=1.25e+01 cost=1.02e+06 flops=4.51e+07
 total GEMM cost=5.38e+06 flops=3.00e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.95e-04,1.93e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.10e+07
--- TIMING FOR sigma : t_inter=1.95e-04 t_gemm=1.93e-03 t_reduction=1.87e-04 tot=2.31e-03 ---
 sigma counter=93 i=0 t=2.37e-04 per=1.23e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=93 i=1 t=2.36e-04 per=1.22e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=93 i=2 t=2.35e-04 per=1.22e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=93 i=3 t=2.39e-04 per=1.24e+01 cost=6.99e+03 flops=2.92e+07
 sigma counter=93 i=4 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=93 i=5 t=2.38e-04 per=1.23e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=93 i=6 t=2.62e-04 per=1.36e+01 cost=1.89e+04 flops=7.21e+07
 sigma counter=93 i=7 t=2.49e-04 per=1.29e+01 cost=1.89e+04 flops=7.59e+07
 total GEMM cost=7.90e+04 flops=4.10e+07
--- TIMING FOR sigma_tot : t_inter=1.87e-02 t_gemm=1.82e-01 t_reduction=1.82e-02 tot=2.19e-01 ---
 sigma_tot counter=93 i=0 t=2.24e-02 per=1.23e+01 cost=4.83e+05 flops=2.16e+07
 sigma_tot counter=93 i=1 t=2.29e-02 per=1.26e+01 cost=4.95e+05 flops=2.16e+07
 sigma_tot counter=93 i=2 t=2.21e-02 per=1.22e+01 cost=4.92e+05 flops=2.22e+07
 sigma_tot counter=93 i=3 t=2.23e-02 per=1.23e+01 cost=4.99e+05 flops=2.23e+07
 sigma_tot counter=93 i=4 t=2.21e-02 per=1.22e+01 cost=7.09e+05 flops=3.20e+07
 sigma_tot counter=93 i=5 t=2.25e-02 per=1.24e+01 cost=7.07e+05 flops=3.14e+07
 sigma_tot counter=93 i=6 t=2.45e-02 per=1.35e+01 cost=1.04e+06 flops=4.26e+07
 sigma_tot counter=93 i=7 t=2.28e-02 per=1.25e+01 cost=1.03e+06 flops=4.55e+07
 total GEMM cost=5.46e+06 flops=3.01e+07
    6   0 -      -2.654516945145  -1.74e-07   1.83e-04    6    12   3.03e-02  2.52e-03
    6   1 -      -2.436977443895  -7.40e-08   1.16e-04    6    12   3.03e-02  2.52e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.96e-04,1.94e-03,1.91e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.94e-03 t_reduction=1.91e-04 tot=2.33e-03 ---
 sigma counter=94 i=0 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=94 i=1 t=2.39e-04 per=1.23e+01 cost=6.78e+03 flops=2.84e+07
 sigma counter=94 i=2 t=2.45e-04 per=1.26e+01 cost=7.01e+03 flops=2.86e+07
 sigma counter=94 i=3 t=2.39e-04 per=1.23e+01 cost=6.99e+03 flops=2.92e+07
 sigma counter=94 i=4 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=94 i=5 t=2.38e-04 per=1.23e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=94 i=6 t=2.62e-04 per=1.35e+01 cost=1.89e+04 flops=7.21e+07
 sigma counter=94 i=7 t=2.45e-04 per=1.26e+01 cost=1.89e+04 flops=7.71e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=1.89e-02 t_gemm=1.84e-01 t_reduction=1.84e-02 tot=2.21e-01 ---
 sigma_tot counter=94 i=0 t=2.26e-02 per=1.23e+01 cost=4.90e+05 flops=2.16e+07
 sigma_tot counter=94 i=1 t=2.32e-02 per=1.26e+01 cost=5.02e+05 flops=2.17e+07
 sigma_tot counter=94 i=2 t=2.24e-02 per=1.22e+01 cost=4.99e+05 flops=2.23e+07
 sigma_tot counter=94 i=3 t=2.26e-02 per=1.23e+01 cost=5.06e+05 flops=2.24e+07
 sigma_tot counter=94 i=4 t=2.24e-02 per=1.22e+01 cost=7.16e+05 flops=3.20e+07
 sigma_tot counter=94 i=5 t=2.27e-02 per=1.24e+01 cost=7.13e+05 flops=3.14e+07
 sigma_tot counter=94 i=6 t=2.47e-02 per=1.35e+01 cost=1.06e+06 flops=4.29e+07
 sigma_tot counter=94 i=7 t=2.30e-02 per=1.25e+01 cost=1.05e+06 flops=4.58e+07
 total GEMM cost=5.54e+06 flops=3.02e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.96e-04,1.96e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.96e-03 t_reduction=1.88e-04 tot=2.34e-03 ---
 sigma counter=95 i=0 t=2.35e-04 per=1.20e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=95 i=1 t=2.38e-04 per=1.22e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=95 i=2 t=2.39e-04 per=1.22e+01 cost=7.01e+03 flops=2.93e+07
 sigma counter=95 i=3 t=2.39e-04 per=1.22e+01 cost=6.99e+03 flops=2.92e+07
 sigma counter=95 i=4 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=95 i=5 t=2.45e-04 per=1.25e+01 cost=6.78e+03 flops=2.77e+07
 sigma counter=95 i=6 t=2.70e-04 per=1.38e+01 cost=1.89e+04 flops=7.00e+07
 sigma counter=95 i=7 t=2.55e-04 per=1.30e+01 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=1.91e-02 t_gemm=1.86e-01 t_reduction=1.86e-02 tot=2.23e-01 ---
 sigma_tot counter=95 i=0 t=2.29e-02 per=1.23e+01 cost=4.96e+05 flops=2.17e+07
 sigma_tot counter=95 i=1 t=2.34e-02 per=1.26e+01 cost=5.09e+05 flops=2.18e+07
 sigma_tot counter=95 i=2 t=2.26e-02 per=1.22e+01 cost=5.06e+05 flops=2.24e+07
 sigma_tot counter=95 i=3 t=2.28e-02 per=1.23e+01 cost=5.13e+05 flops=2.25e+07
 sigma_tot counter=95 i=4 t=2.26e-02 per=1.22e+01 cost=7.23e+05 flops=3.20e+07
 sigma_tot counter=95 i=5 t=2.30e-02 per=1.24e+01 cost=7.20e+05 flops=3.14e+07
 sigma_tot counter=95 i=6 t=2.50e-02 per=1.35e+01 cost=1.08e+06 flops=4.32e+07
 sigma_tot counter=95 i=7 t=2.33e-02 per=1.25e+01 cost=1.07e+06 flops=4.61e+07
 total GEMM cost=5.62e+06 flops=3.03e+07
    7   0 +      -2.654516966639  -2.15e-08   4.64e-05    6    14   3.52e-02  2.51e-03
    7   1 +      -2.436977450693  -6.80e-09   2.69e-05    6    14   3.52e-02  2.51e-03
TIMING for Davidson : 3.52e-02  T(cal/comm/rest)=3.49e-02,9.29e-07,3.23e-04
optimized energies: isweep=1 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=1 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.6e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.005e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000547 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.02e-05,0.000244,0.000253 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8e-06,0.00106,0.000184 cost=2.78e+04 flops[gemm]=2.61e+07
--- TIMING FOR renorm : t_inter=8e-06 t_gemm=0.00106 t_reduction=0.000184 tot=0.00125 ---
 renorm counter=7 i=0 t=0.000207 per=19.5 cost=1.82e+03 flops=8.8e+06
 renorm counter=7 i=1 t=0.000209 per=19.7 cost=3.23e+03 flops=1.54e+07
 renorm counter=7 i=2 t=0.000201 per=18.9 cost=1.91e+03 flops=9.48e+06
 renorm counter=7 i=3 t=0.000208 per=19.6 cost=3.14e+03 flops=1.51e+07
 renorm counter=7 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=7 i=5 t=1e-06 per=0.0942 cost=0 flops=0
 renorm counter=7 i=6 t=0.000236 per=22.2 cost=1.77e+04 flops=7.5e+07
 total GEMM cost=2.78e+04 flops=2.62e+07
--- TIMING FOR renorm_tot : t_inter=0.000618 t_gemm=0.00773 t_reduction=0.00136 tot=0.00971 ---
 renorm_tot counter=7 i=0 t=0.00152 per=19.7 cost=1.89e+04 flops=1.25e+07
 renorm_tot counter=7 i=1 t=0.00154 per=20 cost=2.5e+04 flops=1.62e+07
 renorm_tot counter=7 i=2 t=0.000637 per=8.24 cost=7.9e+03 flops=1.24e+07
 renorm_tot counter=7 i=3 t=0.00065 per=8.41 cost=1.4e+04 flops=2.16e+07
 renorm_tot counter=7 i=4 t=0.000844 per=10.9 cost=2.43e+04 flops=2.88e+07
 renorm_tot counter=7 i=5 t=0.000857 per=11.1 cost=4.24e+04 flops=4.95e+07
 renorm_tot counter=7 i=6 t=0.00168 per=21.7 cost=1.96e+05 flops=1.17e+08
 total GEMM cost=3.28e+05 flops=4.25e+07
check ||H-H.dagger||=0.00e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=8.9e-05,0.0025,8.4e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.6e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(3,0) size=1.03e-05GB T[save](info/data/tot)=5.24e-05,3.53e-05,8.77e-05 speed=0.118GB/s disk[used]=8.68e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
##### time_local: 4.35e-02 S #####
 T(fetch) = 8.05e-05 S  per = 0.18  per(accum) = 0.18
 T(hdiag) = 8.48e-05 S  per = 0.19  per(accum) = 0.38
 T(dvdsn) = 4.00e-02 S  per =   92  per(accum) = 92
 T(decim) = 8.24e-05 S  per = 0.19  per(accum) = 93
 T(guess) = 8.77e-05 S  per =  0.2  per(accum) = 93
 T(renrm) = 2.65e-03 S  per =  6.1  per(accum) = 99
 T(save ) = 5.21e-04 S  per =  1.2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.99e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.09e-05 S  per =  0.1  per(accum) = 0.1
 T(symbolic_formulae_twodot     ) = 2.49e-04 S  per = 0.63  per(accum) = 0.73
 T(hintermediate init           ) = 2.84e-05 S  per = 0.071  per(accum) = 0.8
 T(hintermediates memcpy cpu2gpu) = 3.97e-06 S  per = 0.0099  per(accum) = 0.81
 T(preprocess_hformulae_Hxlist2 ) = 2.82e-03 S  per =  7.1  per(accum) = 7.9
 T(hmmtasks init                ) = 1.50e-03 S  per =  3.8  per(accum) = 12
 T(dvdson solver [Hx_batchGPU]  ) = 3.49e-02 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 9.29e-07 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.23e-04 S  per = 0.81  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.61e-03 S
 T(qops init                    ) = 8.89e-05 S  per =  3.4  per(accum) = 3.4
 T(qops_dict memcpy cpu2gpu     ) = 2.80e-05 S  per =  1.1  per(accum) = 4.5
 T(symbolic_formulae_renorm     ) = 2.05e-04 S  per =  7.9  per(accum) = 12
 T(rintermediate init           ) = 9.58e-06 S  per = 0.37  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.71e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.56e-04 S  per =   21  per(accum) = 34
 T(rmmtasks init                ) = 3.44e-04 S  per =   13  per(accum) = 47
 T(qops memset                  ) = 8.51e-06 S  per = 0.33  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.33e-03 S  per =   51  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.80e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.42e-06 S  per = 0.32  per(accum) = 1e+02
##### time_sweep: 1.32e-01 S #####
 T(fetch) = 5.81e-04 S  per = 0.44  per(accum) = 0.44
 T(hdiag) = 2.81e-04 S  per = 0.21  per(accum) = 0.66
 T(dvdsn) = 1.20e-01 S  per =   91  per(accum) = 91
 T(decim) = 4.81e-04 S  per = 0.37  per(accum) = 92
 T(guess) = 2.36e-04 S  per = 0.18  per(accum) = 92
 T(renrm) = 8.79e-03 S  per =  6.7  per(accum) = 99
 T(save ) = 1.68e-03 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.19e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 1.40e-04 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 8.49e-04 S  per = 0.71  per(accum) = 0.83
 T(hintermediate init           ) = 8.32e-05 S  per = 0.07  per(accum) = 0.9
 T(hintermediates memcpy cpu2gpu) = 1.33e-05 S  per = 0.011  per(accum) = 0.91
 T(preprocess_hformulae_Hxlist2 ) = 7.19e-03 S  per =    6  per(accum) = 7
 T(hmmtasks init                ) = 4.26e-03 S  per =  3.6  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 1.05e-01 S  per =   89  per(accum) = 99
 T(dvdson solver [communication]) = 2.28e-06 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.05e-03 S  per = 0.88  per(accum) = 1e+02
Detailed decomposition of T(renrm): 8.65e-03 S
 T(qops init                    ) = 2.73e-04 S  per =  3.2  per(accum) = 3.2
 T(qops_dict memcpy cpu2gpu     ) = 9.39e-05 S  per =  1.1  per(accum) = 4.2
 T(symbolic_formulae_renorm     ) = 6.25e-04 S  per =  7.2  per(accum) = 11
 T(rintermediate init           ) = 4.38e-05 S  per = 0.51  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 1.52e-05 S  per = 0.18  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 1.97e-03 S  per =   23  per(accum) = 35
 T(rmmtasks init                ) = 1.20e-03 S  per =   14  per(accum) = 49
 T(qops memset                  ) = 2.70e-05 S  per = 0.31  per(accum) = 49
 T(preprocess_renorm_batchGPU   ) = 4.28e-03 S  per =   49  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 8.91e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.79e-05 S  per = 0.32  per(accum) = 1e+02
##### time_global: 2.98e-01 S #####
 T(fetch) = 1.96e-03 S  per = 0.66  per(accum) = 0.66
 T(hdiag) = 6.40e-04 S  per = 0.21  per(accum) = 0.87
 T(dvdsn) = 2.68e-01 S  per =   90  per(accum) = 91
 T(decim) = 2.06e-03 S  per = 0.69  per(accum) = 92
 T(guess) = 6.71e-04 S  per = 0.22  per(accum) = 92
 T(renrm) = 2.04e-02 S  per =  6.8  per(accum) = 99
 T(save ) = 4.25e-03 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 2.67e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 3.11e-04 S  per = 0.12  per(accum) = 0.12
 T(symbolic_formulae_twodot     ) = 2.06e-03 S  per = 0.77  per(accum) = 0.89
 T(hintermediate init           ) = 2.07e-04 S  per = 0.078  per(accum) = 0.97
 T(hintermediates memcpy cpu2gpu) = 3.42e-05 S  per = 0.013  per(accum) = 0.98
 T(preprocess_hformulae_Hxlist2 ) = 1.63e-02 S  per =  6.1  per(accum) = 7.1
 T(hmmtasks init                ) = 1.02e-02 S  per =  3.8  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 2.35e-01 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 6.20e-06 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 2.93e-03 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.01e-02 S
 T(qops init                    ) = 1.10e-03 S  per =  5.5  per(accum) = 5.5
 T(qops_dict memcpy cpu2gpu     ) = 2.72e-04 S  per =  1.4  per(accum) = 6.8
 T(symbolic_formulae_renorm     ) = 1.66e-03 S  per =  8.3  per(accum) = 15
 T(rintermediate init           ) = 1.32e-04 S  per = 0.66  per(accum) = 16
 T(rintermediates memcpy cpu2gpu) = 4.14e-05 S  per = 0.21  per(accum) = 16
 T(preprocess_formulae_Rlist2   ) = 3.77e-03 S  per =   19  per(accum) = 35
 T(rmmtasks init                ) = 2.38e-03 S  per =   12  per(accum) = 47
 T(qops memset                  ) = 6.66e-05 S  per = 0.33  per(accum) = 47
 T(preprocess_renorm_batchGPU   ) = 1.04e-02 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.16e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 6.99e-05 S  per = 0.35  per(accum) = 1e+02

isweep=1 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.302e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x449147d0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.237e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 2.597e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00228 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.39e-05,0.000971,0.00126 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.5e-05,0.000211,0.00195,0.000189 cost=7.9e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0.000211 t_gemm=0.00195 t_reduction=0.000189 tot=0.00235 ---
 sigma counter=96 i=0 t=0.000238 per=12.2 cost=7.01e+03 flops=2.94e+07
 sigma counter=96 i=1 t=0.00025 per=12.8 cost=6.99e+03 flops=2.8e+07
 sigma counter=96 i=2 t=0.000233 per=12 cost=6.81e+03 flops=2.92e+07
 sigma counter=96 i=3 t=0.000237 per=12.2 cost=6.78e+03 flops=2.86e+07
 sigma counter=96 i=4 t=0.000253 per=13 cost=1.89e+04 flops=7.47e+07
 sigma counter=96 i=5 t=0.000257 per=13.2 cost=1.89e+04 flops=7.35e+07
 sigma counter=96 i=6 t=0.000247 per=12.7 cost=6.78e+03 flops=2.75e+07
 sigma counter=96 i=7 t=0.000232 per=11.9 cost=6.81e+03 flops=2.94e+07
 total GEMM cost=7.9e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0.0194 t_gemm=0.187 t_reduction=0.0188 tot=0.226 ---
 sigma_tot counter=96 i=0 t=0.0231 per=12.3 cost=5.03e+05 flops=2.18e+07
 sigma_tot counter=96 i=1 t=0.0236 per=12.6 cost=5.16e+05 flops=2.18e+07
 sigma_tot counter=96 i=2 t=0.0229 per=12.2 cost=5.13e+05 flops=2.24e+07
 sigma_tot counter=96 i=3 t=0.023 per=12.3 cost=5.2e+05 flops=2.26e+07
 sigma_tot counter=96 i=4 t=0.0229 per=12.2 cost=7.41e+05 flops=3.24e+07
 sigma_tot counter=96 i=5 t=0.0232 per=12.4 cost=7.39e+05 flops=3.18e+07
 sigma_tot counter=96 i=6 t=0.0253 per=13.5 cost=1.09e+06 flops=4.31e+07
 sigma_tot counter=96 i=7 t=0.0235 per=12.5 cost=1.08e+06 flops=4.6e+07
 total GEMM cost=5.7e+06 flops=3.04e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.8e-05,0.000199,0.00194,0.000186 cost=7.9e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0.000199 t_gemm=0.00194 t_reduction=0.000186 tot=0.00233 ---
 sigma counter=97 i=0 t=0.000234 per=12 cost=7.01e+03 flops=2.99e+07
 sigma counter=97 i=1 t=0.000245 per=12.6 cost=6.99e+03 flops=2.85e+07
 sigma counter=97 i=2 t=0.000237 per=12.2 cost=6.81e+03 flops=2.88e+07
 sigma counter=97 i=3 t=0.000237 per=12.2 cost=6.78e+03 flops=2.86e+07
 sigma counter=97 i=4 t=0.000254 per=13.1 cost=1.89e+04 flops=7.44e+07
 sigma counter=97 i=5 t=0.000256 per=13.2 cost=1.89e+04 flops=7.38e+07
 sigma counter=97 i=6 t=0.000245 per=12.6 cost=6.78e+03 flops=2.77e+07
 sigma counter=97 i=7 t=0.000234 per=12 cost=6.81e+03 flops=2.91e+07
 total GEMM cost=7.9e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0.0196 t_gemm=0.189 t_reduction=0.019 tot=0.228 ---
 sigma_tot counter=97 i=0 t=0.0233 per=12.3 cost=5.1e+05 flops=2.19e+07
 sigma_tot counter=97 i=1 t=0.0239 per=12.6 cost=5.23e+05 flops=2.19e+07
 sigma_tot counter=97 i=2 t=0.0231 per=12.2 cost=5.2e+05 flops=2.25e+07
 sigma_tot counter=97 i=3 t=0.0233 per=12.3 cost=5.27e+05 flops=2.26e+07
 sigma_tot counter=97 i=4 t=0.0231 per=12.2 cost=7.6e+05 flops=3.29e+07
 sigma_tot counter=97 i=5 t=0.0235 per=12.4 cost=7.58e+05 flops=3.23e+07
 sigma_tot counter=97 i=6 t=0.0255 per=13.5 cost=1.09e+06 flops=4.29e+07
 sigma_tot counter=97 i=7 t=0.0237 per=12.5 cost=1.09e+06 flops=4.58e+07
 total GEMM cost=5.78e+06 flops=3.05e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966639  -1.00e+03   4.64e-05    2     2   4.92e-03  2.46e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   4.92e-03  2.46e-03
TIMING for Davidson : 4.94e-03  T(cal/comm/rest)=4.89e-03,1.64e-07,4.28e-05
optimized energies: isweep=1 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=1 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep1_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.706e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 1.824e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=3.26e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Rlist : 0.00054 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.48e-05,0.000233,0.000261 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000932 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07,0.0009
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000182,0.00106,0.000184 cost=1.55e+05 flops[gemm]=1.46e+08
--- TIMING FOR renorm : t_inter=0.000182 t_gemm=0.00106 t_reduction=0.000183 tot=0.00142 ---
 renorm counter=8 i=0 t=0.000201 per=19 cost=5.64e+03 flops=2.81e+07
 renorm counter=8 i=1 t=0.000207 per=19.6 cost=1.13e+04 flops=5.45e+07
 renorm counter=8 i=2 t=0.000204 per=19.3 cost=1.66e+04 flops=8.12e+07
 renorm counter=8 i=3 t=0.000209 per=19.8 cost=2.89e+04 flops=1.38e+08
 renorm counter=8 i=4 t=1e-06 per=0.0947 cost=0 flops=0
 renorm counter=8 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=8 i=6 t=0.000234 per=22.2 cost=9.22e+04 flops=3.94e+08
 total GEMM cost=1.55e+05 flops=1.46e+08
--- TIMING FOR renorm_tot : t_inter=0.0008 t_gemm=0.00878 t_reduction=0.00155 tot=0.0111 ---
 renorm_tot counter=8 i=0 t=0.00172 per=19.6 cost=2.46e+04 flops=1.43e+07
 renorm_tot counter=8 i=1 t=0.00175 per=19.9 cost=3.63e+04 flops=2.07e+07
 renorm_tot counter=8 i=2 t=0.000841 per=9.57 cost=2.45e+04 flops=2.91e+07
 renorm_tot counter=8 i=3 t=0.000859 per=9.78 cost=4.29e+04 flops=5e+07
 renorm_tot counter=8 i=4 t=0.000845 per=9.62 cost=2.43e+04 flops=2.88e+07
 renorm_tot counter=8 i=5 t=0.000857 per=9.76 cost=4.24e+04 flops=4.95e+07
 renorm_tot counter=8 i=6 t=0.00191 per=21.8 cost=2.88e+05 flops=1.51e+08
 total GEMM cost=4.83e+05 flops=5.5e+07
check ||H-H.dagger||=8.59e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0028 S T(init/kernel/comm)=7.2e-05,0.0027,8.4e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(2,0) size=1.94e-05GB T[save](info/data/tot)=4.8e-05,3.86e-05,8.66e-05 speed=0.224GB/s disk[used]=8.93e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
##### time_local: 1.33e-02 S #####
 T(fetch) = 3.04e-04 S  per =  2.3  per(accum) = 2.3
 T(hdiag) = 7.04e-05 S  per = 0.53  per(accum) = 2.8
 T(dvdsn) = 9.13e-03 S  per =   69  per(accum) = 72
 T(decim) = 3.32e-04 S  per =  2.5  per(accum) = 74
 T(guess) = 7.84e-05 S  per = 0.59  per(accum) = 75
 T(renrm) = 2.81e-03 S  per =   21  per(accum) = 96
 T(save ) = 5.32e-04 S  per =    4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.94e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 4.17e-05 S  per = 0.47  per(accum) = 0.47
 T(symbolic_formulae_twodot     ) = 2.28e-04 S  per =  2.6  per(accum) = 3
 T(hintermediate init           ) = 2.92e-05 S  per = 0.33  per(accum) = 3.3
 T(hintermediates memcpy cpu2gpu) = 3.59e-06 S  per = 0.04  per(accum) = 3.4
 T(preprocess_hformulae_Hxlist2 ) = 2.29e-03 S  per =   26  per(accum) = 29
 T(hmmtasks init                ) = 1.41e-03 S  per =   16  per(accum) = 45
 T(dvdson solver [Hx_batchGPU]  ) = 4.89e-03 S  per =   55  per(accum) = 1e+02
 T(dvdson solver [communication]) = 1.64e-07 S  per = 0.0018  per(accum) = 1e+02
 T(dvdson solver [rest part]    ) = 4.28e-05 S  per = 0.48  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.75e-03 S
 T(qops init                    ) = 7.21e-05 S  per =  2.6  per(accum) = 2.6
 T(qops_dict memcpy cpu2gpu     ) = 3.50e-05 S  per =  1.3  per(accum) = 3.9
 T(symbolic_formulae_renorm     ) = 1.75e-04 S  per =  6.4  per(accum) = 10
 T(rintermediate init           ) = 2.11e-05 S  per = 0.77  per(accum) = 11
 T(rintermediates memcpy cpu2gpu) = 4.39e-06 S  per = 0.16  per(accum) = 11
 T(preprocess_formulae_Rlist2   ) = 5.48e-04 S  per =   20  per(accum) = 31
 T(rmmtasks init                ) = 3.60e-04 S  per =   13  per(accum) = 44
 T(qops memset                  ) = 8.02e-06 S  per = 0.29  per(accum) = 44
 T(preprocess_renorm_batchGPU   ) = 1.49e-03 S  per =   54  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.95e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.43e-06 S  per = 0.31  per(accum) = 1e+02
##### time_sweep: 1.45e-01 S #####
 T(fetch) = 8.85e-04 S  per = 0.61  per(accum) = 0.61
 T(hdiag) = 3.51e-04 S  per = 0.24  per(accum) = 0.85
 T(dvdsn) = 1.29e-01 S  per =   89  per(accum) = 90
 T(decim) = 8.13e-04 S  per = 0.56  per(accum) = 90
 T(guess) = 3.14e-04 S  per = 0.22  per(accum) = 90
 T(renrm) = 1.16e-02 S  per =    8  per(accum) = 98
 T(save ) = 2.21e-03 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 1.28e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 1.82e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 1.08e-03 S  per = 0.84  per(accum) = 0.98
 T(hintermediate init           ) = 1.12e-04 S  per = 0.088  per(accum) = 1.1
 T(hintermediates memcpy cpu2gpu) = 1.69e-05 S  per = 0.013  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 9.49e-03 S  per =  7.4  per(accum) = 8.5
 T(hmmtasks init                ) = 5.67e-03 S  per =  4.4  per(accum) = 13
 T(dvdson solver [Hx_batchGPU]  ) = 1.10e-01 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 2.44e-06 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 1.09e-03 S  per = 0.86  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.14e-02 S
 T(qops init                    ) = 3.46e-04 S  per =    3  per(accum) = 3
 T(qops_dict memcpy cpu2gpu     ) = 1.29e-04 S  per =  1.1  per(accum) = 4.2
 T(symbolic_formulae_renorm     ) = 8.00e-04 S  per =    7  per(accum) = 11
 T(rintermediate init           ) = 6.49e-05 S  per = 0.57  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 1.96e-05 S  per = 0.17  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 2.52e-03 S  per =   22  per(accum) = 34
 T(rmmtasks init                ) = 1.56e-03 S  per =   14  per(accum) = 48
 T(qops memset                  ) = 3.50e-05 S  per = 0.31  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 5.77e-03 S  per =   51  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.19e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 3.63e-05 S  per = 0.32  per(accum) = 1e+02
##### time_global: 3.12e-01 S #####
 T(fetch) = 2.26e-03 S  per = 0.73  per(accum) = 0.73
 T(hdiag) = 7.11e-04 S  per = 0.23  per(accum) = 0.95
 T(dvdsn) = 2.78e-01 S  per =   89  per(accum) = 90
 T(decim) = 2.39e-03 S  per = 0.77  per(accum) = 91
 T(guess) = 7.50e-04 S  per = 0.24  per(accum) = 91
 T(renrm) = 2.32e-02 S  per =  7.5  per(accum) = 98
 T(save ) = 4.78e-03 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 2.76e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 3.52e-04 S  per = 0.13  per(accum) = 0.13
 T(symbolic_formulae_twodot     ) = 2.29e-03 S  per = 0.83  per(accum) = 0.96
 T(hintermediate init           ) = 2.36e-04 S  per = 0.086  per(accum) = 1
 T(hintermediates memcpy cpu2gpu) = 3.77e-05 S  per = 0.014  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 1.86e-02 S  per =  6.7  per(accum) = 7.8
 T(hmmtasks init                ) = 1.16e-02 S  per =  4.2  per(accum) = 12
 T(dvdson solver [Hx_batchGPU]  ) = 2.40e-01 S  per =   87  per(accum) = 99
 T(dvdson solver [communication]) = 6.37e-06 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 2.97e-03 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.28e-02 S
 T(qops init                    ) = 1.17e-03 S  per =  5.1  per(accum) = 5.1
 T(qops_dict memcpy cpu2gpu     ) = 3.07e-04 S  per =  1.3  per(accum) = 6.5
 T(symbolic_formulae_renorm     ) = 1.84e-03 S  per =  8.1  per(accum) = 15
 T(rintermediate init           ) = 1.53e-04 S  per = 0.67  per(accum) = 15
 T(rintermediates memcpy cpu2gpu) = 4.58e-05 S  per =  0.2  per(accum) = 15
 T(preprocess_formulae_Rlist2   ) = 4.32e-03 S  per =   19  per(accum) = 34
 T(rmmtasks init                ) = 2.74e-03 S  per =   12  per(accum) = 46
 T(qops memset                  ) = 7.47e-05 S  per = 0.33  per(accum) = 47
 T(preprocess_renorm_batchGPU   ) = 1.19e-02 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.46e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 7.83e-05 S  per = 0.34  per(accum) = 1e+02

======================================================================
sweep_data::summary isweep=1
----------------------------------------------------------------------
sweep parameters: isweep=1 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=15 e[0]=-2.65208108725 e[1]=-2.43068987639 t=0.043
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=14 e[0]=-2.65451696721 e[1]=-2.43697744778 t=0.045
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.044
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.013
 eav_max=-2.54138548182 [ibond=0]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=3]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=0.00436172684617
 sweep energies: isweep=1 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[0]=-2.65451696664
 sweep energies: isweep=1 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=1
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.00e-04 1.00e-04 | 52 | 1.69e-01 | 1.69e-01 | 1.10e-02 1.06e-01 1.11e-02 1.28e-01 76.1
            1  2      20 1.00e-04 0.00e+00 | 45 | 1.46e-01 | 3.15e-01 | 2.04e-02 1.98e-01 2.05e-02 2.39e-01 76
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.50e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
            1      20 +5.26e-04 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep1.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep1_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
decimation summary: 80->8 dwt=-2.220e-16 SvN=1.326e+00

Convert [C]RRR => [cR]RRR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep1_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00

ctns::rcanon_save fname=./scratch/rcanon_isweep1.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.00e+00
 idx=2 node=(2,0) Drow=20 maxdiff=3.27e-15
 idx=3 node=(1,0) Drow=8 maxdiff=8.01e-16
 idx=4 node=(0,0) Drow=2 maxdiff=1.58e-16
stensor2: wf2 own=1 _data=0x446e94f0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.05e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x446e94f0
     -1.0000e+00       4.5134e-19 
      1.1299e-17       1.0000e+00 
 rwfuns: nroots=2 maxdiff=7.0233e-16
----- TIMING FOR ctns::rcanon_check : 8.011e-05 S -----
..... end of isweep = 1 .....

======================================================================
sweep parameters: isweep=2 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB

isweep=2 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.062e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB
===== CPUmem(GB): tot=3.61e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x449194a0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.274e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.857e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00224 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.9e-05,0.000957,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=5.1e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.5e-05,0.000203,0.00193,0.000191 cost=7.9e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=0.000203 t_gemm=0.00193 t_reduction=0.000191 tot=0.00233 ---
 sigma counter=98 i=0 t=0.000242 per=12.5 cost=7.01e+03 flops=2.9e+07
 sigma counter=98 i=1 t=0.000252 per=13 cost=6.99e+03 flops=2.77e+07
 sigma counter=98 i=2 t=0.000232 per=12 cost=6.81e+03 flops=2.94e+07
 sigma counter=98 i=3 t=0.000236 per=12.2 cost=6.78e+03 flops=2.87e+07
 sigma counter=98 i=4 t=0.000249 per=12.9 cost=1.89e+04 flops=7.59e+07
 sigma counter=98 i=5 t=0.000249 per=12.9 cost=1.89e+04 flops=7.59e+07
 sigma counter=98 i=6 t=0.000243 per=12.6 cost=6.78e+03 flops=2.79e+07
 sigma counter=98 i=7 t=0.00023 per=11.9 cost=6.81e+03 flops=2.96e+07
 total GEMM cost=7.9e+04 flops=4.09e+07
--- TIMING FOR sigma_tot : t_inter=0.0198 t_gemm=0.191 t_reduction=0.0192 tot=0.23 ---
 sigma_tot counter=98 i=0 t=0.0236 per=12.3 cost=5.17e+05 flops=2.2e+07
 sigma_tot counter=98 i=1 t=0.0241 per=12.6 cost=5.3e+05 flops=2.2e+07
 sigma_tot counter=98 i=2 t=0.0233 per=12.2 cost=5.26e+05 flops=2.26e+07
 sigma_tot counter=98 i=3 t=0.0235 per=12.3 cost=5.33e+05 flops=2.27e+07
 sigma_tot counter=98 i=4 t=0.0234 per=12.2 cost=7.79e+05 flops=3.34e+07
 sigma_tot counter=98 i=5 t=0.0237 per=12.4 cost=7.77e+05 flops=3.28e+07
 sigma_tot counter=98 i=6 t=0.0257 per=13.5 cost=1.1e+06 flops=4.28e+07
 sigma_tot counter=98 i=7 t=0.0239 per=12.5 cost=1.09e+06 flops=4.56e+07
 total GEMM cost=5.86e+06 flops=3.06e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.8e-05,0.000199,0.00198,0.000186 cost=7.9e+04 flops[gemm]=4e+07
--- TIMING FOR sigma : t_inter=0.000199 t_gemm=0.00197 t_reduction=0.000186 tot=0.00236 ---
 sigma counter=99 i=0 t=0.000241 per=12.2 cost=7.01e+03 flops=2.91e+07
 sigma counter=99 i=1 t=0.000255 per=12.9 cost=6.99e+03 flops=2.74e+07
 sigma counter=99 i=2 t=0.00024 per=12.2 cost=6.81e+03 flops=2.84e+07
 sigma counter=99 i=3 t=0.000242 per=12.3 cost=6.78e+03 flops=2.8e+07
 sigma counter=99 i=4 t=0.000256 per=13 cost=1.89e+04 flops=7.38e+07
 sigma counter=99 i=5 t=0.000256 per=13 cost=1.89e+04 flops=7.38e+07
 sigma counter=99 i=6 t=0.00025 per=12.7 cost=6.78e+03 flops=2.71e+07
 sigma counter=99 i=7 t=0.000235 per=11.9 cost=6.81e+03 flops=2.9e+07
 total GEMM cost=7.9e+04 flops=4e+07
--- TIMING FOR sigma_tot : t_inter=0.02 t_gemm=0.193 t_reduction=0.0194 tot=0.233 ---
 sigma_tot counter=99 i=0 t=0.0238 per=12.3 cost=5.24e+05 flops=2.2e+07
 sigma_tot counter=99 i=1 t=0.0244 per=12.6 cost=5.37e+05 flops=2.2e+07
 sigma_tot counter=99 i=2 t=0.0236 per=12.2 cost=5.33e+05 flops=2.26e+07
 sigma_tot counter=99 i=3 t=0.0238 per=12.3 cost=5.4e+05 flops=2.27e+07
 sigma_tot counter=99 i=4 t=0.0236 per=12.2 cost=7.98e+05 flops=3.38e+07
 sigma_tot counter=99 i=5 t=0.024 per=12.4 cost=7.96e+05 flops=3.32e+07
 sigma_tot counter=99 i=6 t=0.026 per=13.4 cost=1.11e+06 flops=4.26e+07
 sigma_tot counter=99 i=7 t=0.0242 per=12.5 cost=1.1e+06 flops=4.55e+07
 total GEMM cost=5.94e+06 flops=3.07e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701465761  -1.00e+03   6.88e-02    2     2   4.93e-03  2.47e-03
    1   1 -      -2.436233901586  -1.00e+03   4.38e-02    2     2   4.93e-03  2.47e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=3.10e-05,2.01e-04,1.95e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.95e-03 t_reduction=1.88e-04 tot=2.34e-03 ---
 sigma counter=100 i=0 t=2.43e-04 per=1.25e+01 cost=7.01e+03 flops=2.88e+07
 sigma counter=100 i=1 t=2.39e-04 per=1.23e+01 cost=6.99e+03 flops=2.92e+07
 sigma counter=100 i=2 t=2.41e-04 per=1.24e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=100 i=3 t=2.35e-04 per=1.20e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=100 i=4 t=2.57e-04 per=1.32e+01 cost=1.89e+04 flops=7.35e+07
 sigma counter=100 i=5 t=2.52e-04 per=1.29e+01 cost=1.89e+04 flops=7.50e+07
 sigma counter=100 i=6 t=2.45e-04 per=1.26e+01 cost=6.78e+03 flops=2.77e+07
 sigma counter=100 i=7 t=2.39e-04 per=1.23e+01 cost=6.81e+03 flops=2.85e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=2.02e-02 t_gemm=1.95e-01 t_reduction=1.95e-02 tot=2.35e-01 ---
 sigma_tot counter=100 i=0 t=2.41e-02 per=1.23e+01 cost=5.31e+05 flops=2.21e+07
 sigma_tot counter=100 i=1 t=2.46e-02 per=1.26e+01 cost=5.44e+05 flops=2.21e+07
 sigma_tot counter=100 i=2 t=2.38e-02 per=1.22e+01 cost=5.40e+05 flops=2.27e+07
 sigma_tot counter=100 i=3 t=2.40e-02 per=1.23e+01 cost=5.47e+05 flops=2.28e+07
 sigma_tot counter=100 i=4 t=2.39e-02 per=1.22e+01 cost=8.17e+05 flops=3.42e+07
 sigma_tot counter=100 i=5 t=2.42e-02 per=1.24e+01 cost=8.15e+05 flops=3.36e+07
 sigma_tot counter=100 i=6 t=2.62e-02 per=1.34e+01 cost=1.11e+06 flops=4.25e+07
 sigma_tot counter=100 i=7 t=2.44e-02 per=1.25e+01 cost=1.11e+06 flops=4.53e+07
 total GEMM cost=6.02e+06 flops=3.08e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.98e-04,1.95e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.94e-03 t_reduction=1.89e-04 tot=2.33e-03 ---
 sigma counter=101 i=0 t=2.34e-04 per=1.20e+01 cost=7.01e+03 flops=2.99e+07
 sigma counter=101 i=1 t=2.47e-04 per=1.27e+01 cost=6.99e+03 flops=2.83e+07
 sigma counter=101 i=2 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=101 i=3 t=2.36e-04 per=1.21e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=101 i=4 t=2.52e-04 per=1.30e+01 cost=1.89e+04 flops=7.50e+07
 sigma counter=101 i=5 t=2.59e-04 per=1.33e+01 cost=1.89e+04 flops=7.30e+07
 sigma counter=101 i=6 t=2.46e-04 per=1.26e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=101 i=7 t=2.40e-04 per=1.23e+01 cost=6.81e+03 flops=2.84e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=2.04e-02 t_gemm=1.97e-01 t_reduction=1.97e-02 tot=2.37e-01 ---
 sigma_tot counter=101 i=0 t=2.43e-02 per=1.23e+01 cost=5.38e+05 flops=2.22e+07
 sigma_tot counter=101 i=1 t=2.49e-02 per=1.26e+01 cost=5.51e+05 flops=2.21e+07
 sigma_tot counter=101 i=2 t=2.40e-02 per=1.22e+01 cost=5.47e+05 flops=2.27e+07
 sigma_tot counter=101 i=3 t=2.42e-02 per=1.23e+01 cost=5.54e+05 flops=2.29e+07
 sigma_tot counter=101 i=4 t=2.41e-02 per=1.22e+01 cost=8.36e+05 flops=3.47e+07
 sigma_tot counter=101 i=5 t=2.45e-02 per=1.24e+01 cost=8.34e+05 flops=3.40e+07
 sigma_tot counter=101 i=6 t=2.65e-02 per=1.34e+01 cost=1.12e+06 flops=4.23e+07
 sigma_tot counter=101 i=7 t=2.47e-02 per=1.25e+01 cost=1.11e+06 flops=4.51e+07
 total GEMM cost=6.09e+06 flops=3.09e+07
    2   0 -      -2.654428675224  -1.73e-03   1.26e-02    4     4   9.87e-03  2.47e-03
    2   1 -      -2.436964455562  -7.31e-04   4.22e-03    4     4   9.87e-03  2.47e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.98e-04,1.93e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.10e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.92e-03 t_reduction=1.87e-04 tot=2.31e-03 ---
 sigma counter=102 i=0 t=2.37e-04 per=1.23e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=102 i=1 t=2.37e-04 per=1.23e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=102 i=2 t=2.41e-04 per=1.25e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=102 i=3 t=2.40e-04 per=1.25e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=102 i=4 t=2.45e-04 per=1.27e+01 cost=1.89e+04 flops=7.71e+07
 sigma counter=102 i=5 t=2.50e-04 per=1.30e+01 cost=1.89e+04 flops=7.56e+07
 sigma counter=102 i=6 t=2.43e-04 per=1.26e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=102 i=7 t=2.31e-04 per=1.20e+01 cost=6.81e+03 flops=2.95e+07
 total GEMM cost=7.90e+04 flops=4.11e+07
--- TIMING FOR sigma_tot : t_inter=2.05e-02 t_gemm=1.99e-01 t_reduction=1.99e-02 tot=2.40e-01 ---
 sigma_tot counter=102 i=0 t=2.45e-02 per=1.23e+01 cost=5.45e+05 flops=2.22e+07
 sigma_tot counter=102 i=1 t=2.51e-02 per=1.26e+01 cost=5.58e+05 flops=2.22e+07
 sigma_tot counter=102 i=2 t=2.43e-02 per=1.22e+01 cost=5.54e+05 flops=2.28e+07
 sigma_tot counter=102 i=3 t=2.45e-02 per=1.23e+01 cost=5.61e+05 flops=2.29e+07
 sigma_tot counter=102 i=4 t=2.44e-02 per=1.22e+01 cost=8.55e+05 flops=3.51e+07
 sigma_tot counter=102 i=5 t=2.47e-02 per=1.24e+01 cost=8.52e+05 flops=3.45e+07
 sigma_tot counter=102 i=6 t=2.67e-02 per=1.34e+01 cost=1.13e+06 flops=4.22e+07
 sigma_tot counter=102 i=7 t=2.49e-02 per=1.25e+01 cost=1.12e+06 flops=4.50e+07
 total GEMM cost=6.17e+06 flops=3.10e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.30e-05,1.96e-04,1.95e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.95e-03 t_reduction=1.88e-04 tot=2.33e-03 ---
 sigma counter=103 i=0 t=2.37e-04 per=1.22e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=103 i=1 t=2.37e-04 per=1.22e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=103 i=2 t=2.42e-04 per=1.24e+01 cost=6.81e+03 flops=2.82e+07
 sigma counter=103 i=3 t=2.40e-04 per=1.23e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=103 i=4 t=2.54e-04 per=1.30e+01 cost=1.89e+04 flops=7.44e+07
 sigma counter=103 i=5 t=2.51e-04 per=1.29e+01 cost=1.89e+04 flops=7.53e+07
 sigma counter=103 i=6 t=2.47e-04 per=1.27e+01 cost=6.78e+03 flops=2.75e+07
 sigma counter=103 i=7 t=2.41e-04 per=1.24e+01 cost=6.81e+03 flops=2.83e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=2.07e-02 t_gemm=2.01e-01 t_reduction=2.01e-02 tot=2.42e-01 ---
 sigma_tot counter=103 i=0 t=2.48e-02 per=1.23e+01 cost=5.52e+05 flops=2.23e+07
 sigma_tot counter=103 i=1 t=2.54e-02 per=1.26e+01 cost=5.65e+05 flops=2.23e+07
 sigma_tot counter=103 i=2 t=2.45e-02 per=1.22e+01 cost=5.60e+05 flops=2.28e+07
 sigma_tot counter=103 i=3 t=2.47e-02 per=1.23e+01 cost=5.67e+05 flops=2.30e+07
 sigma_tot counter=103 i=4 t=2.46e-02 per=1.22e+01 cost=8.74e+05 flops=3.55e+07
 sigma_tot counter=103 i=5 t=2.50e-02 per=1.24e+01 cost=8.71e+05 flops=3.49e+07
 sigma_tot counter=103 i=6 t=2.70e-02 per=1.34e+01 cost=1.14e+06 flops=4.21e+07
 sigma_tot counter=103 i=7 t=2.51e-02 per=1.25e+01 cost=1.13e+06 flops=4.48e+07
 total GEMM cost=6.25e+06 flops=3.11e+07
    3   0 -      -2.654509664616  -8.10e-05   3.66e-03    6     6   1.48e-02  2.46e-03
    3   1 -      -2.436976459235  -1.20e-05   1.11e-03    6     6   1.48e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.98e-04,1.95e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.95e-03 t_reduction=1.88e-04 tot=2.33e-03 ---
 sigma counter=104 i=0 t=2.33e-04 per=1.20e+01 cost=7.01e+03 flops=3.01e+07
 sigma counter=104 i=1 t=2.52e-04 per=1.29e+01 cost=6.99e+03 flops=2.77e+07
 sigma counter=104 i=2 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=104 i=3 t=2.34e-04 per=1.20e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=104 i=4 t=2.54e-04 per=1.30e+01 cost=1.89e+04 flops=7.44e+07
 sigma counter=104 i=5 t=2.59e-04 per=1.33e+01 cost=1.89e+04 flops=7.30e+07
 sigma counter=104 i=6 t=2.44e-04 per=1.25e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=104 i=7 t=2.40e-04 per=1.23e+01 cost=6.81e+03 flops=2.84e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=2.09e-02 t_gemm=2.03e-01 t_reduction=2.03e-02 tot=2.44e-01 ---
 sigma_tot counter=104 i=0 t=2.50e-02 per=1.23e+01 cost=5.59e+05 flops=2.24e+07
 sigma_tot counter=104 i=1 t=2.56e-02 per=1.26e+01 cost=5.72e+05 flops=2.23e+07
 sigma_tot counter=104 i=2 t=2.48e-02 per=1.22e+01 cost=5.67e+05 flops=2.29e+07
 sigma_tot counter=104 i=3 t=2.49e-02 per=1.23e+01 cost=5.74e+05 flops=2.30e+07
 sigma_tot counter=104 i=4 t=2.49e-02 per=1.23e+01 cost=8.93e+05 flops=3.59e+07
 sigma_tot counter=104 i=5 t=2.52e-02 per=1.24e+01 cost=8.90e+05 flops=3.53e+07
 sigma_tot counter=104 i=6 t=2.72e-02 per=1.34e+01 cost=1.14e+06 flops=4.19e+07
 sigma_tot counter=104 i=7 t=2.54e-02 per=1.25e+01 cost=1.13e+06 flops=4.47e+07
 total GEMM cost=6.33e+06 flops=3.12e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,2.02e-04,1.95e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=2.02e-04 t_gemm=1.95e-03 t_reduction=1.88e-04 tot=2.34e-03 ---
 sigma counter=105 i=0 t=2.35e-04 per=1.21e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=105 i=1 t=2.48e-04 per=1.27e+01 cost=6.99e+03 flops=2.82e+07
 sigma counter=105 i=2 t=2.40e-04 per=1.23e+01 cost=6.81e+03 flops=2.84e+07
 sigma counter=105 i=3 t=2.36e-04 per=1.21e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=105 i=4 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=105 i=5 t=2.57e-04 per=1.32e+01 cost=1.89e+04 flops=7.35e+07
 sigma counter=105 i=6 t=2.44e-04 per=1.25e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=105 i=7 t=2.36e-04 per=1.21e+01 cost=6.81e+03 flops=2.89e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=2.11e-02 t_gemm=2.05e-01 t_reduction=2.05e-02 tot=2.47e-01 ---
 sigma_tot counter=105 i=0 t=2.52e-02 per=1.23e+01 cost=5.66e+05 flops=2.25e+07
 sigma_tot counter=105 i=1 t=2.59e-02 per=1.26e+01 cost=5.79e+05 flops=2.24e+07
 sigma_tot counter=105 i=2 t=2.50e-02 per=1.22e+01 cost=5.74e+05 flops=2.30e+07
 sigma_tot counter=105 i=3 t=2.52e-02 per=1.23e+01 cost=5.81e+05 flops=2.31e+07
 sigma_tot counter=105 i=4 t=2.51e-02 per=1.23e+01 cost=9.12e+05 flops=3.63e+07
 sigma_tot counter=105 i=5 t=2.55e-02 per=1.24e+01 cost=9.09e+05 flops=3.56e+07
 sigma_tot counter=105 i=6 t=2.75e-02 per=1.34e+01 cost=1.15e+06 flops=4.18e+07
 sigma_tot counter=105 i=7 t=2.56e-02 per=1.25e+01 cost=1.14e+06 flops=4.45e+07
 total GEMM cost=6.41e+06 flops=3.13e+07
    4   0 -      -2.654516020750  -6.36e-06   1.14e-03    6     8   1.97e-02  2.46e-03
    4   1 -      -2.436977285929  -8.27e-07   4.03e-04    6     8   1.97e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.06e-04,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=2.06e-04 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.33e-03 ---
 sigma counter=106 i=0 t=2.35e-04 per=1.21e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=106 i=1 t=2.47e-04 per=1.28e+01 cost=6.99e+03 flops=2.83e+07
 sigma counter=106 i=2 t=2.29e-04 per=1.18e+01 cost=6.81e+03 flops=2.98e+07
 sigma counter=106 i=3 t=2.36e-04 per=1.22e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=106 i=4 t=2.52e-04 per=1.30e+01 cost=1.89e+04 flops=7.50e+07
 sigma counter=106 i=5 t=2.62e-04 per=1.35e+01 cost=1.89e+04 flops=7.21e+07
 sigma counter=106 i=6 t=2.45e-04 per=1.27e+01 cost=6.78e+03 flops=2.77e+07
 sigma counter=106 i=7 t=2.30e-04 per=1.19e+01 cost=6.81e+03 flops=2.96e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=2.14e-02 t_gemm=2.07e-01 t_reduction=2.07e-02 tot=2.49e-01 ---
 sigma_tot counter=106 i=0 t=2.55e-02 per=1.23e+01 cost=5.73e+05 flops=2.25e+07
 sigma_tot counter=106 i=1 t=2.61e-02 per=1.26e+01 cost=5.86e+05 flops=2.24e+07
 sigma_tot counter=106 i=2 t=2.52e-02 per=1.22e+01 cost=5.81e+05 flops=2.30e+07
 sigma_tot counter=106 i=3 t=2.54e-02 per=1.23e+01 cost=5.88e+05 flops=2.31e+07
 sigma_tot counter=106 i=4 t=2.54e-02 per=1.23e+01 cost=9.30e+05 flops=3.67e+07
 sigma_tot counter=106 i=5 t=2.58e-02 per=1.25e+01 cost=9.28e+05 flops=3.60e+07
 sigma_tot counter=106 i=6 t=2.77e-02 per=1.34e+01 cost=1.16e+06 flops=4.17e+07
 sigma_tot counter=106 i=7 t=2.58e-02 per=1.25e+01 cost=1.15e+06 flops=4.44e+07
 total GEMM cost=6.49e+06 flops=3.14e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.98e-04,1.96e-03,1.90e-04 cost=7.90e+04 flops[gemm]=4.02e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.96e-03 t_reduction=1.89e-04 tot=2.35e-03 ---
 sigma counter=107 i=0 t=2.37e-04 per=1.21e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=107 i=1 t=2.44e-04 per=1.24e+01 cost=6.99e+03 flops=2.86e+07
 sigma counter=107 i=2 t=2.34e-04 per=1.19e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=107 i=3 t=2.40e-04 per=1.22e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=107 i=4 t=2.62e-04 per=1.33e+01 cost=1.89e+04 flops=7.21e+07
 sigma counter=107 i=5 t=2.62e-04 per=1.33e+01 cost=1.89e+04 flops=7.21e+07
 sigma counter=107 i=6 t=2.48e-04 per=1.26e+01 cost=6.78e+03 flops=2.74e+07
 sigma counter=107 i=7 t=2.37e-04 per=1.21e+01 cost=6.81e+03 flops=2.88e+07
 total GEMM cost=7.90e+04 flops=4.02e+07
--- TIMING FOR sigma_tot : t_inter=2.15e-02 t_gemm=2.09e-01 t_reduction=2.09e-02 tot=2.51e-01 ---
 sigma_tot counter=107 i=0 t=2.57e-02 per=1.23e+01 cost=5.80e+05 flops=2.26e+07
 sigma_tot counter=107 i=1 t=2.63e-02 per=1.26e+01 cost=5.93e+05 flops=2.25e+07
 sigma_tot counter=107 i=2 t=2.55e-02 per=1.22e+01 cost=5.88e+05 flops=2.31e+07
 sigma_tot counter=107 i=3 t=2.57e-02 per=1.23e+01 cost=5.94e+05 flops=2.32e+07
 sigma_tot counter=107 i=4 t=2.56e-02 per=1.23e+01 cost=9.49e+05 flops=3.70e+07
 sigma_tot counter=107 i=5 t=2.60e-02 per=1.25e+01 cost=9.47e+05 flops=3.64e+07
 sigma_tot counter=107 i=6 t=2.80e-02 per=1.34e+01 cost=1.16e+06 flops=4.16e+07
 sigma_tot counter=107 i=7 t=2.61e-02 per=1.25e+01 cost=1.15e+06 flops=4.43e+07
 total GEMM cost=6.57e+06 flops=3.14e+07
    5   0 -      -2.654516818919  -7.98e-07   4.45e-04    6    10   2.46e-02  2.46e-03
    5   1 -      -2.436977409924  -1.24e-07   2.05e-04    6    10   2.46e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.00e-04,1.92e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.11e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.92e-03 t_reduction=1.88e-04 tot=2.31e-03 ---
 sigma counter=108 i=0 t=2.35e-04 per=1.22e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=108 i=1 t=2.38e-04 per=1.24e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=108 i=2 t=2.39e-04 per=1.24e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=108 i=3 t=2.35e-04 per=1.22e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=108 i=4 t=2.51e-04 per=1.31e+01 cost=1.89e+04 flops=7.53e+07
 sigma counter=108 i=5 t=2.49e-04 per=1.30e+01 cost=1.89e+04 flops=7.59e+07
 sigma counter=108 i=6 t=2.45e-04 per=1.27e+01 cost=6.78e+03 flops=2.77e+07
 sigma counter=108 i=7 t=2.30e-04 per=1.20e+01 cost=6.81e+03 flops=2.96e+07
 total GEMM cost=7.90e+04 flops=4.11e+07
--- TIMING FOR sigma_tot : t_inter=2.17e-02 t_gemm=2.11e-01 t_reduction=2.11e-02 tot=2.54e-01 ---
 sigma_tot counter=108 i=0 t=2.59e-02 per=1.23e+01 cost=5.88e+05 flops=2.27e+07
 sigma_tot counter=108 i=1 t=2.66e-02 per=1.26e+01 cost=6.00e+05 flops=2.26e+07
 sigma_tot counter=108 i=2 t=2.57e-02 per=1.22e+01 cost=5.95e+05 flops=2.31e+07
 sigma_tot counter=108 i=3 t=2.59e-02 per=1.23e+01 cost=6.01e+05 flops=2.32e+07
 sigma_tot counter=108 i=4 t=2.59e-02 per=1.23e+01 cost=9.68e+05 flops=3.74e+07
 sigma_tot counter=108 i=5 t=2.63e-02 per=1.25e+01 cost=9.66e+05 flops=3.68e+07
 sigma_tot counter=108 i=6 t=2.82e-02 per=1.34e+01 cost=1.17e+06 flops=4.15e+07
 sigma_tot counter=108 i=7 t=2.63e-02 per=1.25e+01 cost=1.16e+06 flops=4.41e+07
 total GEMM cost=6.65e+06 flops=3.15e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.98e-04,1.92e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.11e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.92e-03 t_reduction=1.88e-04 tot=2.31e-03 ---
 sigma counter=109 i=0 t=2.39e-04 per=1.24e+01 cost=7.01e+03 flops=2.93e+07
 sigma counter=109 i=1 t=2.49e-04 per=1.29e+01 cost=6.99e+03 flops=2.81e+07
 sigma counter=109 i=2 t=2.29e-04 per=1.19e+01 cost=6.81e+03 flops=2.98e+07
 sigma counter=109 i=3 t=2.35e-04 per=1.22e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=109 i=4 t=2.47e-04 per=1.28e+01 cost=1.89e+04 flops=7.65e+07
 sigma counter=109 i=5 t=2.49e-04 per=1.29e+01 cost=1.89e+04 flops=7.59e+07
 sigma counter=109 i=6 t=2.44e-04 per=1.27e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=109 i=7 t=2.31e-04 per=1.20e+01 cost=6.81e+03 flops=2.95e+07
 total GEMM cost=7.90e+04 flops=4.11e+07
--- TIMING FOR sigma_tot : t_inter=2.19e-02 t_gemm=2.13e-01 t_reduction=2.12e-02 tot=2.56e-01 ---
 sigma_tot counter=109 i=0 t=2.62e-02 per=1.23e+01 cost=5.95e+05 flops=2.27e+07
 sigma_tot counter=109 i=1 t=2.68e-02 per=1.26e+01 cost=6.07e+05 flops=2.26e+07
 sigma_tot counter=109 i=2 t=2.59e-02 per=1.22e+01 cost=6.01e+05 flops=2.32e+07
 sigma_tot counter=109 i=3 t=2.61e-02 per=1.23e+01 cost=6.08e+05 flops=2.33e+07
 sigma_tot counter=109 i=4 t=2.61e-02 per=1.23e+01 cost=9.87e+05 flops=3.78e+07
 sigma_tot counter=109 i=5 t=2.65e-02 per=1.25e+01 cost=9.85e+05 flops=3.71e+07
 sigma_tot counter=109 i=6 t=2.85e-02 per=1.34e+01 cost=1.18e+06 flops=4.13e+07
 sigma_tot counter=109 i=7 t=2.65e-02 per=1.25e+01 cost=1.17e+06 flops=4.40e+07
 total GEMM cost=6.73e+06 flops=3.16e+07
    6   0 -      -2.654516950785  -1.32e-07   1.57e-04    6    12   2.95e-02  2.46e-03
    6   1 +      -2.436977447170  -3.72e-08   7.42e-05    6    12   2.95e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.99e-04,1.95e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.95e-03 t_reduction=1.88e-04 tot=2.34e-03 ---
 sigma counter=110 i=0 t=2.34e-04 per=1.20e+01 cost=7.01e+03 flops=2.99e+07
 sigma counter=110 i=1 t=2.38e-04 per=1.22e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=110 i=2 t=2.44e-04 per=1.25e+01 cost=6.81e+03 flops=2.79e+07
 sigma counter=110 i=3 t=2.34e-04 per=1.20e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=110 i=4 t=2.56e-04 per=1.31e+01 cost=1.89e+04 flops=7.38e+07
 sigma counter=110 i=5 t=2.57e-04 per=1.32e+01 cost=1.89e+04 flops=7.35e+07
 sigma counter=110 i=6 t=2.46e-04 per=1.26e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=110 i=7 t=2.41e-04 per=1.24e+01 cost=6.81e+03 flops=2.83e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=2.21e-02 t_gemm=2.15e-01 t_reduction=2.14e-02 tot=2.58e-01 ---
 sigma_tot counter=110 i=0 t=2.64e-02 per=1.23e+01 cost=6.02e+05 flops=2.28e+07
 sigma_tot counter=110 i=1 t=2.71e-02 per=1.26e+01 cost=6.14e+05 flops=2.27e+07
 sigma_tot counter=110 i=2 t=2.62e-02 per=1.22e+01 cost=6.08e+05 flops=2.32e+07
 sigma_tot counter=110 i=3 t=2.64e-02 per=1.23e+01 cost=6.15e+05 flops=2.33e+07
 sigma_tot counter=110 i=4 t=2.64e-02 per=1.23e+01 cost=1.01e+06 flops=3.81e+07
 sigma_tot counter=110 i=5 t=2.68e-02 per=1.25e+01 cost=1.00e+06 flops=3.75e+07
 sigma_tot counter=110 i=6 t=2.87e-02 per=1.34e+01 cost=1.18e+06 flops=4.12e+07
 sigma_tot counter=110 i=7 t=2.68e-02 per=1.25e+01 cost=1.17e+06 flops=4.39e+07
 total GEMM cost=6.81e+06 flops=3.17e+07
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   3.20e-02  2.46e-03
    7   1 +      -2.436977447170   4.44e-16   7.42e-05    5    13   3.20e-02  2.46e-03
TIMING for Davidson : 3.20e-02  T(cal/comm/rest)=3.17e-02,8.22e-07,3.19e-04
optimized energies: isweep=2 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=2 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 2.016e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000509 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.13e-05,0.00022,0.000237 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9e-06,0.00108,0.000187 cost=2.78e+04 flops[gemm]=2.59e+07
--- TIMING FOR renorm : t_inter=9e-06 t_gemm=0.00108 t_reduction=0.000187 tot=0.00127 ---
 renorm counter=9 i=0 t=0.000216 per=20.1 cost=2.19e+03 flops=1.02e+07
 renorm counter=9 i=1 t=0.000208 per=19.3 cost=2.85e+03 flops=1.37e+07
 renorm counter=9 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=9 i=3 t=1e-06 per=0.093 cost=0 flops=0
 renorm counter=9 i=4 t=0.000203 per=18.9 cost=2.11e+03 flops=1.04e+07
 renorm counter=9 i=5 t=0.000207 per=19.3 cost=2.94e+03 flops=1.42e+07
 renorm counter=9 i=6 t=0.00024 per=22.3 cost=1.77e+04 flops=7.37e+07
 total GEMM cost=2.78e+04 flops=2.59e+07
--- TIMING FOR renorm_tot : t_inter=0.000809 t_gemm=0.00986 t_reduction=0.00173 tot=0.0124 ---
 renorm_tot counter=9 i=0 t=0.00194 per=19.6 cost=2.68e+04 flops=1.38e+07
 renorm_tot counter=9 i=1 t=0.00196 per=19.9 cost=3.92e+04 flops=2e+07
 renorm_tot counter=9 i=2 t=0.000841 per=8.53 cost=2.45e+04 flops=2.91e+07
 renorm_tot counter=9 i=3 t=0.00086 per=8.72 cost=4.29e+04 flops=4.99e+07
 renorm_tot counter=9 i=4 t=0.00105 per=10.6 cost=2.64e+04 flops=2.52e+07
 renorm_tot counter=9 i=5 t=0.00106 per=10.8 cost=4.54e+04 flops=4.27e+07
 renorm_tot counter=9 i=6 t=0.00215 per=21.8 cost=3.06e+05 flops=1.42e+08
 total GEMM cost=5.11e+05 flops=5.18e+07
check ||H-H.dagger||=0.00e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=8.9e-05,0.0025,8.6e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(1,0) size=1.03e-05GB T[save](info/data/tot)=5.14e-05,3.65e-05,8.79e-05 speed=0.118GB/s disk[used]=9.09e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
##### time_local: 3.96e-02 S #####
 T(fetch) = 7.05e-05 S  per = 0.18  per(accum) = 0.18
 T(hdiag) = 7.08e-05 S  per = 0.18  per(accum) = 0.36
 T(dvdsn) = 3.61e-02 S  per =   91  per(accum) = 92
 T(decim) = 7.78e-05 S  per =  0.2  per(accum) = 92
 T(guess) = 7.90e-05 S  per =  0.2  per(accum) = 92
 T(renrm) = 2.63e-03 S  per =  6.7  per(accum) = 99
 T(save ) = 5.39e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.59e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.00e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 2.32e-04 S  per = 0.65  per(accum) = 0.76
 T(hintermediate init           ) = 2.15e-05 S  per = 0.06  per(accum) = 0.82
 T(hintermediates memcpy cpu2gpu) = 3.59e-06 S  per = 0.01  per(accum) = 0.83
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =  6.3  per(accum) = 7.1
 T(hmmtasks init                ) = 1.39e-03 S  per =  3.9  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 3.17e-02 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 8.22e-07 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.19e-04 S  per = 0.89  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.59e-03 S
 T(qops init                    ) = 8.92e-05 S  per =  3.4  per(accum) = 3.4
 T(qops_dict memcpy cpu2gpu     ) = 2.74e-05 S  per =  1.1  per(accum) = 4.5
 T(symbolic_formulae_renorm     ) = 2.07e-04 S  per =    8  per(accum) = 12
 T(rintermediate init           ) = 9.66e-06 S  per = 0.37  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.81e-06 S  per = 0.19  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.18e-04 S  per =   20  per(accum) = 33
 T(rmmtasks init                ) = 3.45e-04 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 8.57e-06 S  per = 0.33  per(accum) = 47
 T(preprocess_renorm_batchGPU   ) = 1.34e-03 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.76e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.58e-06 S  per = 0.33  per(accum) = 1e+02
##### time_sweep: 3.96e-02 S #####
 T(fetch) = 7.05e-05 S  per = 0.18  per(accum) = 0.18
 T(hdiag) = 7.08e-05 S  per = 0.18  per(accum) = 0.36
 T(dvdsn) = 3.61e-02 S  per =   91  per(accum) = 92
 T(decim) = 7.78e-05 S  per =  0.2  per(accum) = 92
 T(guess) = 7.90e-05 S  per =  0.2  per(accum) = 92
 T(renrm) = 2.63e-03 S  per =  6.7  per(accum) = 99
 T(save ) = 5.39e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.59e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.00e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 2.32e-04 S  per = 0.65  per(accum) = 0.76
 T(hintermediate init           ) = 2.15e-05 S  per = 0.06  per(accum) = 0.82
 T(hintermediates memcpy cpu2gpu) = 3.59e-06 S  per = 0.01  per(accum) = 0.83
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =  6.3  per(accum) = 7.1
 T(hmmtasks init                ) = 1.39e-03 S  per =  3.9  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 3.17e-02 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 8.22e-07 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.19e-04 S  per = 0.89  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.59e-03 S
 T(qops init                    ) = 8.92e-05 S  per =  3.4  per(accum) = 3.4
 T(qops_dict memcpy cpu2gpu     ) = 2.74e-05 S  per =  1.1  per(accum) = 4.5
 T(symbolic_formulae_renorm     ) = 2.07e-04 S  per =    8  per(accum) = 12
 T(rintermediate init           ) = 9.66e-06 S  per = 0.37  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.81e-06 S  per = 0.19  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.18e-04 S  per =   20  per(accum) = 33
 T(rmmtasks init                ) = 3.45e-04 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 8.57e-06 S  per = 0.33  per(accum) = 47
 T(preprocess_renorm_batchGPU   ) = 1.34e-03 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.76e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.58e-06 S  per = 0.33  per(accum) = 1e+02
##### time_global: 3.51e-01 S #####
 T(fetch) = 2.33e-03 S  per = 0.66  per(accum) = 0.66
 T(hdiag) = 7.81e-04 S  per = 0.22  per(accum) = 0.89
 T(dvdsn) = 3.14e-01 S  per =   89  per(accum) = 90
 T(decim) = 2.47e-03 S  per =  0.7  per(accum) = 91
 T(guess) = 8.29e-04 S  per = 0.24  per(accum) = 91
 T(renrm) = 2.59e-02 S  per =  7.4  per(accum) = 98
 T(save ) = 5.32e-03 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.12e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 3.92e-04 S  per = 0.13  per(accum) = 0.13
 T(symbolic_formulae_twodot     ) = 2.52e-03 S  per = 0.81  per(accum) = 0.93
 T(hintermediate init           ) = 2.58e-04 S  per = 0.083  per(accum) = 1
 T(hintermediates memcpy cpu2gpu) = 4.13e-05 S  per = 0.013  per(accum) = 1
 T(preprocess_hformulae_Hxlist2 ) = 2.09e-02 S  per =  6.7  per(accum) = 7.7
 T(hmmtasks init                ) = 1.30e-02 S  per =  4.2  per(accum) = 12
 T(dvdson solver [Hx_batchGPU]  ) = 2.71e-01 S  per =   87  per(accum) = 99
 T(dvdson solver [communication]) = 7.19e-06 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.29e-03 S  per =  1.1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.54e-02 S
 T(qops init                    ) = 1.26e-03 S  per =    5  per(accum) = 5
 T(qops_dict memcpy cpu2gpu     ) = 3.34e-04 S  per =  1.3  per(accum) = 6.3
 T(symbolic_formulae_renorm     ) = 2.04e-03 S  per =    8  per(accum) = 14
 T(rintermediate init           ) = 1.63e-04 S  per = 0.64  per(accum) = 15
 T(rintermediates memcpy cpu2gpu) = 5.06e-05 S  per =  0.2  per(accum) = 15
 T(preprocess_formulae_Rlist2   ) = 4.84e-03 S  per =   19  per(accum) = 34
 T(rmmtasks init                ) = 3.08e-03 S  per =   12  per(accum) = 46
 T(qops memset                  ) = 8.32e-05 S  per = 0.33  per(accum) = 47
 T(preprocess_renorm_batchGPU   ) = 1.32e-02 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.73e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.69e-05 S  per = 0.34  per(accum) = 1e+02

isweep=2 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.222e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x449144a0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.228e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.897e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00223 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.16e-05,0.000958,0.00122 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.5e-05,0.000202,0.00194,0.000193 cost=7.9e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0.000202 t_gemm=0.00194 t_reduction=0.000193 tot=0.00234 ---
 sigma counter=111 i=0 t=0.000245 per=12.6 cost=6.81e+03 flops=2.78e+07
 sigma counter=111 i=1 t=0.000238 per=12.3 cost=6.78e+03 flops=2.85e+07
 sigma counter=111 i=2 t=0.000235 per=12.1 cost=7.01e+03 flops=2.98e+07
 sigma counter=111 i=3 t=0.000236 per=12.2 cost=6.99e+03 flops=2.96e+07
 sigma counter=111 i=4 t=0.000236 per=12.2 cost=6.81e+03 flops=2.89e+07
 sigma counter=111 i=5 t=0.000243 per=12.5 cost=6.78e+03 flops=2.79e+07
 sigma counter=111 i=6 t=0.00026 per=13.4 cost=1.89e+04 flops=7.27e+07
 sigma counter=111 i=7 t=0.000247 per=12.7 cost=1.89e+04 flops=7.65e+07
 total GEMM cost=7.9e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0.0223 t_gemm=0.217 t_reduction=0.0216 tot=0.261 ---
 sigma_tot counter=111 i=0 t=0.0267 per=12.3 cost=6.08e+05 flops=2.28e+07
 sigma_tot counter=111 i=1 t=0.0273 per=12.6 cost=6.21e+05 flops=2.27e+07
 sigma_tot counter=111 i=2 t=0.0264 per=12.2 cost=6.15e+05 flops=2.33e+07
 sigma_tot counter=111 i=3 t=0.0266 per=12.3 cost=6.22e+05 flops=2.34e+07
 sigma_tot counter=111 i=4 t=0.0266 per=12.3 cost=1.01e+06 flops=3.8e+07
 sigma_tot counter=111 i=5 t=0.027 per=12.5 cost=1.01e+06 flops=3.74e+07
 sigma_tot counter=111 i=6 t=0.029 per=13.4 cost=1.2e+06 flops=4.15e+07
 sigma_tot counter=111 i=7 t=0.027 per=12.5 cost=1.19e+06 flops=4.42e+07
 total GEMM cost=6.88e+06 flops=3.18e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.8e-05,0.000199,0.00198,0.000189 cost=7.9e+04 flops[gemm]=3.98e+07
--- TIMING FOR sigma : t_inter=0.000199 t_gemm=0.00198 t_reduction=0.000189 tot=0.00237 ---
 sigma counter=112 i=0 t=0.000233 per=11.8 cost=6.81e+03 flops=2.92e+07
 sigma counter=112 i=1 t=0.000256 per=12.9 cost=6.78e+03 flops=2.65e+07
 sigma counter=112 i=2 t=0.000242 per=12.2 cost=7.01e+03 flops=2.9e+07
 sigma counter=112 i=3 t=0.000244 per=12.3 cost=6.99e+03 flops=2.86e+07
 sigma counter=112 i=4 t=0.000244 per=12.3 cost=6.81e+03 flops=2.79e+07
 sigma counter=112 i=5 t=0.000242 per=12.2 cost=6.78e+03 flops=2.8e+07
 sigma counter=112 i=6 t=0.000275 per=13.9 cost=1.89e+04 flops=6.87e+07
 sigma counter=112 i=7 t=0.000246 per=12.4 cost=1.89e+04 flops=7.68e+07
 total GEMM cost=7.9e+04 flops=3.98e+07
--- TIMING FOR sigma_tot : t_inter=0.0225 t_gemm=0.219 t_reduction=0.0218 tot=0.263 ---
 sigma_tot counter=112 i=0 t=0.0269 per=12.3 cost=6.15e+05 flops=2.29e+07
 sigma_tot counter=112 i=1 t=0.0276 per=12.6 cost=6.27e+05 flops=2.28e+07
 sigma_tot counter=112 i=2 t=0.0267 per=12.2 cost=6.22e+05 flops=2.33e+07
 sigma_tot counter=112 i=3 t=0.0268 per=12.3 cost=6.29e+05 flops=2.34e+07
 sigma_tot counter=112 i=4 t=0.0269 per=12.3 cost=1.02e+06 flops=3.79e+07
 sigma_tot counter=112 i=5 t=0.0273 per=12.5 cost=1.02e+06 flops=3.73e+07
 sigma_tot counter=112 i=6 t=0.0292 per=13.4 cost=1.22e+06 flops=4.18e+07
 sigma_tot counter=112 i=7 t=0.0273 per=12.5 cost=1.21e+06 flops=4.45e+07
 total GEMM cost=6.96e+06 flops=3.19e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   4.95e-03  2.47e-03
    1   1 +      -2.436977447170  -1.00e+03   7.42e-05    2     2   4.95e-03  2.47e-03
TIMING for Davidson : 4.97e-03  T(cal/comm/rest)=4.92e-03,9.90e-08,4.30e-05
optimized energies: isweep=2 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=2 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep2_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.645e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 1.878e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=3.26e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Rlist : 0.000537 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.66e-05,0.000231,0.000259 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000932 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07,0.0009
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000181,0.00107,0.000185 cost=1.55e+05 flops[gemm]=1.45e+08
--- TIMING FOR renorm : t_inter=0.000181 t_gemm=0.00107 t_reduction=0.000185 tot=0.00144 ---
 renorm counter=10 i=0 t=0.000206 per=19.3 cost=8.1e+03 flops=3.93e+07
 renorm counter=10 i=1 t=0.000203 per=19 cost=8.36e+03 flops=4.12e+07
 renorm counter=10 i=2 t=1e-06 per=0.0935 cost=0 flops=0
 renorm counter=10 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=10 i=4 t=0.000208 per=19.5 cost=1.65e+04 flops=7.92e+07
 renorm counter=10 i=5 t=0.000211 per=19.7 cost=2.89e+04 flops=1.37e+08
 renorm counter=10 i=6 t=0.00024 per=22.5 cost=9.32e+04 flops=3.88e+08
 total GEMM cost=1.55e+05 flops=1.45e+08
--- TIMING FOR renorm_tot : t_inter=0.00099 t_gemm=0.0109 t_reduction=0.00192 tot=0.0138 ---
 renorm_tot counter=10 i=0 t=0.00214 per=19.6 cost=3.49e+04 flops=1.63e+07
 renorm_tot counter=10 i=1 t=0.00216 per=19.8 cost=4.75e+04 flops=2.2e+07
 renorm_tot counter=10 i=2 t=0.000842 per=7.7 cost=2.45e+04 flops=2.9e+07
 renorm_tot counter=10 i=3 t=0.00086 per=7.87 cost=4.29e+04 flops=4.99e+07
 renorm_tot counter=10 i=4 t=0.00126 per=11.5 cost=4.29e+04 flops=3.42e+07
 renorm_tot counter=10 i=5 t=0.00128 per=11.7 cost=7.43e+04 flops=5.83e+07
 renorm_tot counter=10 i=6 t=0.00239 per=21.9 cost=3.99e+05 flops=1.67e+08
 total GEMM cost=6.66e+05 flops=6.09e+07
check ||H-H.dagger||=1.03e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0028 S T(init/kernel/comm)=7.2e-05,0.0027,8.5e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(2,0) size=1.94e-05GB T[save](info/data/tot)=4.98e-05,3.98e-05,8.95e-05 speed=0.216GB/s disk[used]=9.23e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
##### time_local: 1.32e-02 S #####
 T(fetch) = 2.96e-04 S  per =  2.2  per(accum) = 2.2
 T(hdiag) = 6.79e-05 S  per = 0.52  per(accum) = 2.8
 T(dvdsn) = 9.07e-03 S  per =   69  per(accum) = 72
 T(decim) = 3.12e-04 S  per =  2.4  per(accum) = 74
 T(guess) = 7.33e-05 S  per = 0.56  per(accum) = 75
 T(renrm) = 2.82e-03 S  per =   21  per(accum) = 96
 T(save ) = 5.44e-04 S  per =  4.1  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.89e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 3.92e-05 S  per = 0.44  per(accum) = 0.44
 T(symbolic_formulae_twodot     ) = 2.28e-04 S  per =  2.6  per(accum) = 3
 T(hintermediate init           ) = 2.19e-05 S  per = 0.25  per(accum) = 3.2
 T(hintermediates memcpy cpu2gpu) = 3.47e-06 S  per = 0.039  per(accum) = 3.3
 T(preprocess_hformulae_Hxlist2 ) = 2.24e-03 S  per =   25  per(accum) = 28
 T(hmmtasks init                ) = 1.39e-03 S  per =   16  per(accum) = 44
 T(dvdson solver [Hx_batchGPU]  ) = 4.92e-03 S  per =   55  per(accum) = 1e+02
 T(dvdson solver [communication]) = 9.90e-08 S  per = 0.0011  per(accum) = 1e+02
 T(dvdson solver [rest part]    ) = 4.30e-05 S  per = 0.48  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.76e-03 S
 T(qops init                    ) = 7.19e-05 S  per =  2.6  per(accum) = 2.6
 T(qops_dict memcpy cpu2gpu     ) = 3.42e-05 S  per =  1.2  per(accum) = 3.8
 T(symbolic_formulae_renorm     ) = 1.69e-04 S  per =  6.1  per(accum) = 10
 T(rintermediate init           ) = 2.17e-05 S  per = 0.79  per(accum) = 11
 T(rintermediates memcpy cpu2gpu) = 4.61e-06 S  per = 0.17  per(accum) = 11
 T(preprocess_formulae_Rlist2   ) = 5.50e-04 S  per =   20  per(accum) = 31
 T(rmmtasks init                ) = 3.61e-04 S  per =   13  per(accum) = 44
 T(qops memset                  ) = 7.97e-06 S  per = 0.29  per(accum) = 44
 T(preprocess_renorm_batchGPU   ) = 1.51e-03 S  per =   55  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.68e-05 S  per = 0.97  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.51e-06 S  per = 0.31  per(accum) = 1e+02
##### time_sweep: 5.28e-02 S #####
 T(fetch) = 3.66e-04 S  per = 0.69  per(accum) = 0.69
 T(hdiag) = 1.39e-04 S  per = 0.26  per(accum) = 0.96
 T(dvdsn) = 4.52e-02 S  per =   86  per(accum) = 87
 T(decim) = 3.89e-04 S  per = 0.74  per(accum) = 87
 T(guess) = 1.52e-04 S  per = 0.29  per(accum) = 88
 T(renrm) = 5.45e-03 S  per =   10  per(accum) = 98
 T(save ) = 1.08e-03 S  per =  2.1  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.48e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 7.92e-05 S  per = 0.18  per(accum) = 0.18
 T(symbolic_formulae_twodot     ) = 4.60e-04 S  per =    1  per(accum) = 1.2
 T(hintermediate init           ) = 4.34e-05 S  per = 0.097  per(accum) = 1.3
 T(hintermediates memcpy cpu2gpu) = 7.07e-06 S  per = 0.016  per(accum) = 1.3
 T(preprocess_hformulae_Hxlist2 ) = 4.49e-03 S  per =   10  per(accum) = 11
 T(hmmtasks init                ) = 2.79e-03 S  per =  6.2  per(accum) = 18
 T(dvdson solver [Hx_batchGPU]  ) = 3.66e-02 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 9.21e-07 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.62e-04 S  per = 0.81  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.35e-03 S
 T(qops init                    ) = 1.61e-04 S  per =    3  per(accum) = 3
 T(qops_dict memcpy cpu2gpu     ) = 6.16e-05 S  per =  1.2  per(accum) = 4.2
 T(symbolic_formulae_renorm     ) = 3.76e-04 S  per =    7  per(accum) = 11
 T(rintermediate init           ) = 3.14e-05 S  per = 0.59  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 9.41e-06 S  per = 0.18  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 1.07e-03 S  per =   20  per(accum) = 32
 T(rmmtasks init                ) = 7.06e-04 S  per =   13  per(accum) = 45
 T(qops memset                  ) = 1.65e-05 S  per = 0.31  per(accum) = 45
 T(preprocess_renorm_batchGPU   ) = 2.85e-03 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.44e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.71e-05 S  per = 0.32  per(accum) = 1e+02
##### time_global: 3.64e-01 S #####
 T(fetch) = 2.63e-03 S  per = 0.72  per(accum) = 0.72
 T(hdiag) = 8.49e-04 S  per = 0.23  per(accum) = 0.95
 T(dvdsn) = 3.23e-01 S  per =   89  per(accum) = 90
 T(decim) = 2.78e-03 S  per = 0.76  per(accum) = 90
 T(guess) = 9.02e-04 S  per = 0.25  per(accum) = 91
 T(renrm) = 2.87e-02 S  per =  7.9  per(accum) = 98
 T(save ) = 5.87e-03 S  per =  1.6  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.20e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 4.31e-04 S  per = 0.13  per(accum) = 0.13
 T(symbolic_formulae_twodot     ) = 2.75e-03 S  per = 0.86  per(accum) = 0.99
 T(hintermediate init           ) = 2.80e-04 S  per = 0.087  per(accum) = 1.1
 T(hintermediates memcpy cpu2gpu) = 4.48e-05 S  per = 0.014  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 2.31e-02 S  per =  7.2  per(accum) = 8.3
 T(hmmtasks init                ) = 1.44e-02 S  per =  4.5  per(accum) = 13
 T(dvdson solver [Hx_batchGPU]  ) = 2.76e-01 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 7.29e-06 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.33e-03 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.82e-02 S
 T(qops init                    ) = 1.33e-03 S  per =  4.7  per(accum) = 4.7
 T(qops_dict memcpy cpu2gpu     ) = 3.69e-04 S  per =  1.3  per(accum) = 6
 T(symbolic_formulae_renorm     ) = 2.21e-03 S  per =  7.9  per(accum) = 14
 T(rintermediate init           ) = 1.84e-04 S  per = 0.65  per(accum) = 15
 T(rintermediates memcpy cpu2gpu) = 5.52e-05 S  per =  0.2  per(accum) = 15
 T(preprocess_formulae_Rlist2   ) = 5.39e-03 S  per =   19  per(accum) = 34
 T(rmmtasks init                ) = 3.45e-03 S  per =   12  per(accum) = 46
 T(qops memset                  ) = 9.12e-05 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 1.47e-02 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.00e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 9.54e-05 S  per = 0.34  per(accum) = 1e+02

isweep=2 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.055e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=357:0.00272MB:2.66e-06GB
===== CPUmem(GB): tot=3.56e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x4491d520
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.256e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.844e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00226 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.3e-05,0.000986,0.00122 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=5.05e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.6e-05,0.000202,0.00194,0.000191 cost=7.9e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0.000202 t_gemm=0.00194 t_reduction=0.000191 tot=0.00233 ---
 sigma counter=113 i=0 t=0.000237 per=12.2 cost=6.81e+03 flops=2.88e+07
 sigma counter=113 i=1 t=0.000238 per=12.3 cost=6.78e+03 flops=2.85e+07
 sigma counter=113 i=2 t=0.000242 per=12.5 cost=7.01e+03 flops=2.9e+07
 sigma counter=113 i=3 t=0.000236 per=12.2 cost=6.99e+03 flops=2.96e+07
 sigma counter=113 i=4 t=0.000233 per=12 cost=6.81e+03 flops=2.92e+07
 sigma counter=113 i=5 t=0.000238 per=12.3 cost=6.78e+03 flops=2.85e+07
 sigma counter=113 i=6 t=0.000267 per=13.8 cost=1.89e+04 flops=7.08e+07
 sigma counter=113 i=7 t=0.00025 per=12.9 cost=1.89e+04 flops=7.56e+07
 total GEMM cost=7.9e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0.0227 t_gemm=0.221 t_reduction=0.022 tot=0.265 ---
 sigma_tot counter=113 i=0 t=0.0271 per=12.3 cost=6.22e+05 flops=2.29e+07
 sigma_tot counter=113 i=1 t=0.0278 per=12.6 cost=6.34e+05 flops=2.28e+07
 sigma_tot counter=113 i=2 t=0.0269 per=12.2 cost=6.29e+05 flops=2.34e+07
 sigma_tot counter=113 i=3 t=0.0271 per=12.3 cost=6.36e+05 flops=2.35e+07
 sigma_tot counter=113 i=4 t=0.0271 per=12.3 cost=1.03e+06 flops=3.79e+07
 sigma_tot counter=113 i=5 t=0.0275 per=12.5 cost=1.02e+06 flops=3.72e+07
 sigma_tot counter=113 i=6 t=0.0295 per=13.4 cost=1.24e+06 flops=4.2e+07
 sigma_tot counter=113 i=7 t=0.0275 per=12.5 cost=1.23e+06 flops=4.47e+07
 total GEMM cost=7.04e+06 flops=3.19e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.8e-05,0.000197,0.00195,0.000186 cost=7.9e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=0.000197 t_gemm=0.00195 t_reduction=0.000186 tot=0.00234 ---
 sigma counter=114 i=0 t=0.000235 per=12 cost=6.81e+03 flops=2.9e+07
 sigma counter=114 i=1 t=0.000253 per=12.9 cost=6.78e+03 flops=2.68e+07
 sigma counter=114 i=2 t=0.00024 per=12.3 cost=7.01e+03 flops=2.92e+07
 sigma counter=114 i=3 t=0.000244 per=12.5 cost=6.99e+03 flops=2.86e+07
 sigma counter=114 i=4 t=0.000234 per=12 cost=6.81e+03 flops=2.91e+07
 sigma counter=114 i=5 t=0.000236 per=12.1 cost=6.78e+03 flops=2.87e+07
 sigma counter=114 i=6 t=0.000259 per=13.3 cost=1.89e+04 flops=7.3e+07
 sigma counter=114 i=7 t=0.000253 per=12.9 cost=1.89e+04 flops=7.47e+07
 total GEMM cost=7.9e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=0.0229 t_gemm=0.222 t_reduction=0.0222 tot=0.268 ---
 sigma_tot counter=114 i=0 t=0.0274 per=12.3 cost=6.29e+05 flops=2.3e+07
 sigma_tot counter=114 i=1 t=0.0281 per=12.6 cost=6.41e+05 flops=2.28e+07
 sigma_tot counter=114 i=2 t=0.0271 per=12.2 cost=6.36e+05 flops=2.34e+07
 sigma_tot counter=114 i=3 t=0.0273 per=12.3 cost=6.43e+05 flops=2.35e+07
 sigma_tot counter=114 i=4 t=0.0273 per=12.3 cost=1.03e+06 flops=3.78e+07
 sigma_tot counter=114 i=5 t=0.0277 per=12.5 cost=1.03e+06 flops=3.72e+07
 sigma_tot counter=114 i=6 t=0.0298 per=13.4 cost=1.26e+06 flops=4.23e+07
 sigma_tot counter=114 i=7 t=0.0278 per=12.5 cost=1.25e+06 flops=4.5e+07
 total GEMM cost=7.12e+06 flops=3.2e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819590  -1.00e+03   7.01e-02    2     2   4.91e-03  2.46e-03
    1   1 -      -2.436094100139  -1.00e+03   4.92e-02    2     2   4.91e-03  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.98e-04,1.94e-03,1.91e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.94e-03 t_reduction=1.90e-04 tot=2.32e-03 ---
 sigma counter=115 i=0 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=115 i=1 t=2.35e-04 per=1.21e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=115 i=2 t=2.42e-04 per=1.25e+01 cost=7.01e+03 flops=2.90e+07
 sigma counter=115 i=3 t=2.36e-04 per=1.22e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=115 i=4 t=2.40e-04 per=1.24e+01 cost=6.81e+03 flops=2.84e+07
 sigma counter=115 i=5 t=2.36e-04 per=1.22e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=115 i=6 t=2.68e-04 per=1.39e+01 cost=1.89e+04 flops=7.05e+07
 sigma counter=115 i=7 t=2.46e-04 per=1.27e+01 cost=1.89e+04 flops=7.68e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=2.31e-02 t_gemm=2.24e-01 t_reduction=2.24e-02 tot=2.70e-01 ---
 sigma_tot counter=115 i=0 t=2.76e-02 per=1.23e+01 cost=6.36e+05 flops=2.30e+07
 sigma_tot counter=115 i=1 t=2.83e-02 per=1.26e+01 cost=6.48e+05 flops=2.29e+07
 sigma_tot counter=115 i=2 t=2.74e-02 per=1.22e+01 cost=6.43e+05 flops=2.35e+07
 sigma_tot counter=115 i=3 t=2.76e-02 per=1.23e+01 cost=6.50e+05 flops=2.36e+07
 sigma_tot counter=115 i=4 t=2.76e-02 per=1.23e+01 cost=1.04e+06 flops=3.77e+07
 sigma_tot counter=115 i=5 t=2.80e-02 per=1.25e+01 cost=1.04e+06 flops=3.71e+07
 sigma_tot counter=115 i=6 t=3.00e-02 per=1.34e+01 cost=1.28e+06 flops=4.25e+07
 sigma_tot counter=115 i=7 t=2.80e-02 per=1.25e+01 cost=1.27e+06 flops=4.53e+07
 total GEMM cost=7.20e+06 flops=3.21e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.98e-04,1.94e-03,1.86e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.94e-03 t_reduction=1.86e-04 tot=2.32e-03 ---
 sigma counter=116 i=0 t=2.33e-04 per=1.20e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=116 i=1 t=2.47e-04 per=1.27e+01 cost=6.78e+03 flops=2.75e+07
 sigma counter=116 i=2 t=2.33e-04 per=1.20e+01 cost=7.01e+03 flops=3.01e+07
 sigma counter=116 i=3 t=2.35e-04 per=1.21e+01 cost=6.99e+03 flops=2.97e+07
 sigma counter=116 i=4 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=116 i=5 t=2.38e-04 per=1.23e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=116 i=6 t=2.69e-04 per=1.39e+01 cost=1.89e+04 flops=7.02e+07
 sigma counter=116 i=7 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=2.33e-02 t_gemm=2.26e-01 t_reduction=2.26e-02 tot=2.72e-01 ---
 sigma_tot counter=116 i=0 t=2.78e-02 per=1.23e+01 cost=6.42e+05 flops=2.31e+07
 sigma_tot counter=116 i=1 t=2.85e-02 per=1.26e+01 cost=6.54e+05 flops=2.29e+07
 sigma_tot counter=116 i=2 t=2.76e-02 per=1.22e+01 cost=6.50e+05 flops=2.35e+07
 sigma_tot counter=116 i=3 t=2.78e-02 per=1.23e+01 cost=6.57e+05 flops=2.36e+07
 sigma_tot counter=116 i=4 t=2.78e-02 per=1.23e+01 cost=1.05e+06 flops=3.76e+07
 sigma_tot counter=116 i=5 t=2.82e-02 per=1.25e+01 cost=1.04e+06 flops=3.70e+07
 sigma_tot counter=116 i=6 t=3.03e-02 per=1.34e+01 cost=1.30e+06 flops=4.28e+07
 sigma_tot counter=116 i=7 t=2.83e-02 per=1.25e+01 cost=1.29e+06 flops=4.56e+07
 total GEMM cost=7.28e+06 flops=3.22e+07
    2   0 -      -2.654426863106  -1.84e-03   1.26e-02    4     4   9.83e-03  2.46e-03
    2   1 -      -2.436959129206  -8.65e-04   5.19e-03    4     4   9.83e-03  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.02e-04,1.96e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.02e+07
--- TIMING FOR sigma : t_inter=2.02e-04 t_gemm=1.96e-03 t_reduction=1.87e-04 tot=2.35e-03 ---
 sigma counter=117 i=0 t=2.43e-04 per=1.24e+01 cost=6.81e+03 flops=2.80e+07
 sigma counter=117 i=1 t=2.44e-04 per=1.24e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=117 i=2 t=2.40e-04 per=1.22e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=117 i=3 t=2.38e-04 per=1.21e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=117 i=4 t=2.38e-04 per=1.21e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=117 i=5 t=2.40e-04 per=1.22e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=117 i=6 t=2.70e-04 per=1.38e+01 cost=1.89e+04 flops=7.00e+07
 sigma counter=117 i=7 t=2.49e-04 per=1.27e+01 cost=1.89e+04 flops=7.59e+07
 total GEMM cost=7.90e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=2.35e-02 t_gemm=2.28e-01 t_reduction=2.27e-02 tot=2.75e-01 ---
 sigma_tot counter=117 i=0 t=2.81e-02 per=1.23e+01 cost=6.49e+05 flops=2.31e+07
 sigma_tot counter=117 i=1 t=2.88e-02 per=1.26e+01 cost=6.61e+05 flops=2.30e+07
 sigma_tot counter=117 i=2 t=2.79e-02 per=1.22e+01 cost=6.57e+05 flops=2.36e+07
 sigma_tot counter=117 i=3 t=2.80e-02 per=1.23e+01 cost=6.64e+05 flops=2.37e+07
 sigma_tot counter=117 i=4 t=2.81e-02 per=1.23e+01 cost=1.05e+06 flops=3.76e+07
 sigma_tot counter=117 i=5 t=2.85e-02 per=1.25e+01 cost=1.05e+06 flops=3.69e+07
 sigma_tot counter=117 i=6 t=3.06e-02 per=1.34e+01 cost=1.32e+06 flops=4.30e+07
 sigma_tot counter=117 i=7 t=2.85e-02 per=1.25e+01 cost=1.31e+06 flops=4.58e+07
 total GEMM cost=7.36e+06 flops=3.22e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.96e-04,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.32e-03 ---
 sigma counter=118 i=0 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=118 i=1 t=2.55e-04 per=1.31e+01 cost=6.78e+03 flops=2.66e+07
 sigma counter=118 i=2 t=2.32e-04 per=1.20e+01 cost=7.01e+03 flops=3.02e+07
 sigma counter=118 i=3 t=2.37e-04 per=1.22e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=118 i=4 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=118 i=5 t=2.38e-04 per=1.23e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=118 i=6 t=2.68e-04 per=1.38e+01 cost=1.89e+04 flops=7.05e+07
 sigma counter=118 i=7 t=2.47e-04 per=1.27e+01 cost=1.89e+04 flops=7.65e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=2.37e-02 t_gemm=2.30e-01 t_reduction=2.29e-02 tot=2.77e-01 ---
 sigma_tot counter=118 i=0 t=2.83e-02 per=1.23e+01 cost=6.56e+05 flops=2.32e+07
 sigma_tot counter=118 i=1 t=2.90e-02 per=1.26e+01 cost=6.68e+05 flops=2.30e+07
 sigma_tot counter=118 i=2 t=2.81e-02 per=1.22e+01 cost=6.64e+05 flops=2.37e+07
 sigma_tot counter=118 i=3 t=2.83e-02 per=1.23e+01 cost=6.71e+05 flops=2.37e+07
 sigma_tot counter=118 i=4 t=2.83e-02 per=1.23e+01 cost=1.06e+06 flops=3.75e+07
 sigma_tot counter=118 i=5 t=2.87e-02 per=1.25e+01 cost=1.06e+06 flops=3.69e+07
 sigma_tot counter=118 i=6 t=3.08e-02 per=1.34e+01 cost=1.33e+06 flops=4.33e+07
 sigma_tot counter=118 i=7 t=2.88e-02 per=1.25e+01 cost=1.33e+06 flops=4.61e+07
 total GEMM cost=7.44e+06 flops=3.23e+07
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   1.48e-02  2.46e-03
    3   1 -      -2.436975259479  -1.61e-05   1.59e-03    6     6   1.48e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,2.03e-04,1.95e-03,1.91e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=2.03e-04 t_gemm=1.95e-03 t_reduction=1.91e-04 tot=2.35e-03 ---
 sigma counter=119 i=0 t=2.35e-04 per=1.20e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=119 i=1 t=2.44e-04 per=1.25e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=119 i=2 t=2.41e-04 per=1.24e+01 cost=7.01e+03 flops=2.91e+07
 sigma counter=119 i=3 t=2.48e-04 per=1.27e+01 cost=6.99e+03 flops=2.82e+07
 sigma counter=119 i=4 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=119 i=5 t=2.35e-04 per=1.20e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=119 i=6 t=2.60e-04 per=1.33e+01 cost=1.89e+04 flops=7.27e+07
 sigma counter=119 i=7 t=2.54e-04 per=1.30e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=2.39e-02 t_gemm=2.32e-01 t_reduction=2.31e-02 tot=2.79e-01 ---
 sigma_tot counter=119 i=0 t=2.85e-02 per=1.23e+01 cost=6.63e+05 flops=2.32e+07
 sigma_tot counter=119 i=1 t=2.93e-02 per=1.26e+01 cost=6.75e+05 flops=2.31e+07
 sigma_tot counter=119 i=2 t=2.83e-02 per=1.22e+01 cost=6.71e+05 flops=2.37e+07
 sigma_tot counter=119 i=3 t=2.85e-02 per=1.23e+01 cost=6.78e+05 flops=2.38e+07
 sigma_tot counter=119 i=4 t=2.85e-02 per=1.23e+01 cost=1.07e+06 flops=3.74e+07
 sigma_tot counter=119 i=5 t=2.89e-02 per=1.25e+01 cost=1.06e+06 flops=3.68e+07
 sigma_tot counter=119 i=6 t=3.11e-02 per=1.34e+01 cost=1.35e+06 flops=4.35e+07
 sigma_tot counter=119 i=7 t=2.90e-02 per=1.25e+01 cost=1.34e+06 flops=4.63e+07
 total GEMM cost=7.52e+06 flops=3.24e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.96e-04,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.32e-03 ---
 sigma counter=120 i=0 t=2.34e-04 per=1.21e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=120 i=1 t=2.47e-04 per=1.28e+01 cost=6.78e+03 flops=2.75e+07
 sigma counter=120 i=2 t=2.37e-04 per=1.22e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=120 i=3 t=2.37e-04 per=1.22e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=120 i=4 t=2.30e-04 per=1.19e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=120 i=5 t=2.36e-04 per=1.22e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=120 i=6 t=2.60e-04 per=1.34e+01 cost=1.89e+04 flops=7.27e+07
 sigma counter=120 i=7 t=2.55e-04 per=1.32e+01 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=2.41e-02 t_gemm=2.34e-01 t_reduction=2.33e-02 tot=2.82e-01 ---
 sigma_tot counter=120 i=0 t=2.88e-02 per=1.23e+01 cost=6.70e+05 flops=2.33e+07
 sigma_tot counter=120 i=1 t=2.95e-02 per=1.26e+01 cost=6.82e+05 flops=2.31e+07
 sigma_tot counter=120 i=2 t=2.86e-02 per=1.22e+01 cost=6.78e+05 flops=2.37e+07
 sigma_tot counter=120 i=3 t=2.88e-02 per=1.23e+01 cost=6.85e+05 flops=2.38e+07
 sigma_tot counter=120 i=4 t=2.88e-02 per=1.23e+01 cost=1.07e+06 flops=3.74e+07
 sigma_tot counter=120 i=5 t=2.92e-02 per=1.25e+01 cost=1.07e+06 flops=3.67e+07
 sigma_tot counter=120 i=6 t=3.14e-02 per=1.34e+01 cost=1.37e+06 flops=4.38e+07
 sigma_tot counter=120 i=7 t=2.93e-02 per=1.25e+01 cost=1.36e+06 flops=4.66e+07
 total GEMM cost=7.60e+06 flops=3.24e+07
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   1.97e-02  2.46e-03
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   1.97e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.99e-04,1.94e-03,1.92e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.93e-03 t_reduction=1.92e-04 tot=2.33e-03 ---
 sigma counter=121 i=0 t=2.36e-04 per=1.22e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=121 i=1 t=2.38e-04 per=1.23e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=121 i=2 t=2.44e-04 per=1.26e+01 cost=7.01e+03 flops=2.87e+07
 sigma counter=121 i=3 t=2.38e-04 per=1.23e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=121 i=4 t=2.30e-04 per=1.19e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=121 i=5 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=121 i=6 t=2.59e-04 per=1.34e+01 cost=1.89e+04 flops=7.30e+07
 sigma counter=121 i=7 t=2.53e-04 per=1.31e+01 cost=1.89e+04 flops=7.47e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=2.43e-02 t_gemm=2.36e-01 t_reduction=2.35e-02 tot=2.84e-01 ---
 sigma_tot counter=121 i=0 t=2.90e-02 per=1.23e+01 cost=6.76e+05 flops=2.33e+07
 sigma_tot counter=121 i=1 t=2.98e-02 per=1.26e+01 cost=6.88e+05 flops=2.31e+07
 sigma_tot counter=121 i=2 t=2.88e-02 per=1.22e+01 cost=6.85e+05 flops=2.38e+07
 sigma_tot counter=121 i=3 t=2.90e-02 per=1.23e+01 cost=6.92e+05 flops=2.39e+07
 sigma_tot counter=121 i=4 t=2.90e-02 per=1.23e+01 cost=1.08e+06 flops=3.73e+07
 sigma_tot counter=121 i=5 t=2.94e-02 per=1.25e+01 cost=1.08e+06 flops=3.67e+07
 sigma_tot counter=121 i=6 t=3.16e-02 per=1.34e+01 cost=1.39e+06 flops=4.40e+07
 sigma_tot counter=121 i=7 t=2.95e-02 per=1.25e+01 cost=1.38e+06 flops=4.68e+07
 total GEMM cost=7.67e+06 flops=3.25e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.96e-04,1.94e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.94e-03 t_reduction=1.89e-04 tot=2.33e-03 ---
 sigma counter=122 i=0 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=122 i=1 t=2.48e-04 per=1.28e+01 cost=6.78e+03 flops=2.74e+07
 sigma counter=122 i=2 t=2.34e-04 per=1.20e+01 cost=7.01e+03 flops=2.99e+07
 sigma counter=122 i=3 t=2.37e-04 per=1.22e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=122 i=4 t=2.33e-04 per=1.20e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=122 i=5 t=2.34e-04 per=1.20e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=122 i=6 t=2.69e-04 per=1.38e+01 cost=1.89e+04 flops=7.02e+07
 sigma counter=122 i=7 t=2.54e-04 per=1.31e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=2.45e-02 t_gemm=2.38e-01 t_reduction=2.37e-02 tot=2.86e-01 ---
 sigma_tot counter=122 i=0 t=2.92e-02 per=1.23e+01 cost=6.83e+05 flops=2.34e+07
 sigma_tot counter=122 i=1 t=3.00e-02 per=1.26e+01 cost=6.95e+05 flops=2.32e+07
 sigma_tot counter=122 i=2 t=2.90e-02 per=1.22e+01 cost=6.92e+05 flops=2.38e+07
 sigma_tot counter=122 i=3 t=2.92e-02 per=1.23e+01 cost=6.99e+05 flops=2.39e+07
 sigma_tot counter=122 i=4 t=2.92e-02 per=1.23e+01 cost=1.09e+06 flops=3.72e+07
 sigma_tot counter=122 i=5 t=2.96e-02 per=1.25e+01 cost=1.09e+06 flops=3.66e+07
 sigma_tot counter=122 i=6 t=3.19e-02 per=1.34e+01 cost=1.41e+06 flops=4.42e+07
 sigma_tot counter=122 i=7 t=2.98e-02 per=1.25e+01 cost=1.40e+06 flops=4.70e+07
 total GEMM cost=7.75e+06 flops=3.26e+07
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   2.46e-02  2.46e-03
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   2.46e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.01e-04,1.94e-03,1.91e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.94e-03 t_reduction=1.89e-04 tot=2.33e-03 ---
 sigma counter=123 i=0 t=2.38e-04 per=1.23e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=123 i=1 t=2.45e-04 per=1.26e+01 cost=6.78e+03 flops=2.77e+07
 sigma counter=123 i=2 t=2.32e-04 per=1.20e+01 cost=7.01e+03 flops=3.02e+07
 sigma counter=123 i=3 t=2.35e-04 per=1.21e+01 cost=6.99e+03 flops=2.97e+07
 sigma counter=123 i=4 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=123 i=5 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=123 i=6 t=2.59e-04 per=1.34e+01 cost=1.89e+04 flops=7.30e+07
 sigma counter=123 i=7 t=2.52e-04 per=1.30e+01 cost=1.89e+04 flops=7.50e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=2.47e-02 t_gemm=2.40e-01 t_reduction=2.39e-02 tot=2.89e-01 ---
 sigma_tot counter=123 i=0 t=2.95e-02 per=1.23e+01 cost=6.90e+05 flops=2.34e+07
 sigma_tot counter=123 i=1 t=3.03e-02 per=1.26e+01 cost=7.02e+05 flops=2.32e+07
 sigma_tot counter=123 i=2 t=2.93e-02 per=1.22e+01 cost=6.99e+05 flops=2.39e+07
 sigma_tot counter=123 i=3 t=2.95e-02 per=1.23e+01 cost=7.06e+05 flops=2.40e+07
 sigma_tot counter=123 i=4 t=2.94e-02 per=1.23e+01 cost=1.09e+06 flops=3.72e+07
 sigma_tot counter=123 i=5 t=2.99e-02 per=1.25e+01 cost=1.09e+06 flops=3.65e+07
 sigma_tot counter=123 i=6 t=3.21e-02 per=1.34e+01 cost=1.43e+06 flops=4.44e+07
 sigma_tot counter=123 i=7 t=3.00e-02 per=1.25e+01 cost=1.42e+06 flops=4.73e+07
 total GEMM cost=7.83e+06 flops=3.26e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.96e-04,1.94e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=1.95e-04 t_gemm=1.94e-03 t_reduction=1.87e-04 tot=2.32e-03 ---
 sigma counter=124 i=0 t=2.36e-04 per=1.22e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=124 i=1 t=2.46e-04 per=1.27e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=124 i=2 t=2.33e-04 per=1.20e+01 cost=7.01e+03 flops=3.01e+07
 sigma counter=124 i=3 t=2.39e-04 per=1.23e+01 cost=6.99e+03 flops=2.92e+07
 sigma counter=124 i=4 t=2.29e-04 per=1.18e+01 cost=6.81e+03 flops=2.98e+07
 sigma counter=124 i=5 t=2.43e-04 per=1.26e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=124 i=6 t=2.61e-04 per=1.35e+01 cost=1.89e+04 flops=7.24e+07
 sigma counter=124 i=7 t=2.49e-04 per=1.29e+01 cost=1.89e+04 flops=7.59e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=2.49e-02 t_gemm=2.42e-01 t_reduction=2.41e-02 tot=2.91e-01 ---
 sigma_tot counter=124 i=0 t=2.97e-02 per=1.23e+01 cost=6.97e+05 flops=2.35e+07
 sigma_tot counter=124 i=1 t=3.05e-02 per=1.26e+01 cost=7.09e+05 flops=2.32e+07
 sigma_tot counter=124 i=2 t=2.95e-02 per=1.22e+01 cost=7.06e+05 flops=2.39e+07
 sigma_tot counter=124 i=3 t=2.97e-02 per=1.23e+01 cost=7.13e+05 flops=2.40e+07
 sigma_tot counter=124 i=4 t=2.97e-02 per=1.23e+01 cost=1.10e+06 flops=3.71e+07
 sigma_tot counter=124 i=5 t=3.01e-02 per=1.25e+01 cost=1.10e+06 flops=3.65e+07
 sigma_tot counter=124 i=6 t=3.24e-02 per=1.34e+01 cost=1.45e+06 flops=4.47e+07
 sigma_tot counter=124 i=7 t=3.03e-02 per=1.25e+01 cost=1.44e+06 flops=4.75e+07
 total GEMM cost=7.91e+06 flops=3.27e+07
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   2.95e-02  2.46e-03
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   2.95e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,2.05e-04,1.95e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=2.05e-04 t_gemm=1.95e-03 t_reduction=1.88e-04 tot=2.34e-03 ---
 sigma counter=125 i=0 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=125 i=1 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=125 i=2 t=2.40e-04 per=1.23e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=125 i=3 t=2.41e-04 per=1.24e+01 cost=6.99e+03 flops=2.90e+07
 sigma counter=125 i=4 t=2.33e-04 per=1.20e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=125 i=5 t=2.41e-04 per=1.24e+01 cost=6.78e+03 flops=2.81e+07
 sigma counter=125 i=6 t=2.65e-04 per=1.36e+01 cost=1.89e+04 flops=7.13e+07
 sigma counter=125 i=7 t=2.54e-04 per=1.31e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=2.51e-02 t_gemm=2.44e-01 t_reduction=2.43e-02 tot=2.93e-01 ---
 sigma_tot counter=125 i=0 t=2.99e-02 per=1.23e+01 cost=7.04e+05 flops=2.35e+07
 sigma_tot counter=125 i=1 t=3.07e-02 per=1.26e+01 cost=7.16e+05 flops=2.33e+07
 sigma_tot counter=125 i=2 t=2.97e-02 per=1.22e+01 cost=7.13e+05 flops=2.40e+07
 sigma_tot counter=125 i=3 t=2.99e-02 per=1.23e+01 cost=7.20e+05 flops=2.40e+07
 sigma_tot counter=125 i=4 t=2.99e-02 per=1.23e+01 cost=1.11e+06 flops=3.71e+07
 sigma_tot counter=125 i=5 t=3.04e-02 per=1.25e+01 cost=1.11e+06 flops=3.64e+07
 sigma_tot counter=125 i=6 t=3.27e-02 per=1.34e+01 cost=1.47e+06 flops=4.49e+07
 sigma_tot counter=125 i=7 t=3.05e-02 per=1.25e+01 cost=1.46e+06 flops=4.77e+07
 total GEMM cost=7.99e+06 flops=3.28e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.95e-04,1.95e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=1.95e-04 t_gemm=1.95e-03 t_reduction=1.88e-04 tot=2.33e-03 ---
 sigma counter=126 i=0 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=126 i=1 t=2.44e-04 per=1.25e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=126 i=2 t=2.38e-04 per=1.22e+01 cost=7.01e+03 flops=2.94e+07
 sigma counter=126 i=3 t=2.43e-04 per=1.25e+01 cost=6.99e+03 flops=2.88e+07
 sigma counter=126 i=4 t=2.31e-04 per=1.18e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=126 i=5 t=2.36e-04 per=1.21e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=126 i=6 t=2.69e-04 per=1.38e+01 cost=1.89e+04 flops=7.02e+07
 sigma counter=126 i=7 t=2.55e-04 per=1.31e+01 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=2.53e-02 t_gemm=2.46e-01 t_reduction=2.44e-02 tot=2.96e-01 ---
 sigma_tot counter=126 i=0 t=3.02e-02 per=1.23e+01 cost=7.11e+05 flops=2.35e+07
 sigma_tot counter=126 i=1 t=3.10e-02 per=1.26e+01 cost=7.22e+05 flops=2.33e+07
 sigma_tot counter=126 i=2 t=3.00e-02 per=1.22e+01 cost=7.20e+05 flops=2.40e+07
 sigma_tot counter=126 i=3 t=3.02e-02 per=1.23e+01 cost=7.27e+05 flops=2.41e+07
 sigma_tot counter=126 i=4 t=3.01e-02 per=1.23e+01 cost=1.12e+06 flops=3.70e+07
 sigma_tot counter=126 i=5 t=3.06e-02 per=1.24e+01 cost=1.11e+06 flops=3.63e+07
 sigma_tot counter=126 i=6 t=3.29e-02 per=1.34e+01 cost=1.49e+06 flops=4.51e+07
 sigma_tot counter=126 i=7 t=3.08e-02 per=1.25e+01 cost=1.48e+06 flops=4.80e+07
 total GEMM cost=8.07e+06 flops=3.28e+07
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   3.44e-02  2.46e-03
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   3.44e-02  2.46e-03
TIMING for Davidson : 3.44e-02  T(cal/comm/rest)=3.41e-02,9.77e-07,3.39e-04
optimized energies: isweep=2 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=2 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.971e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.00056 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.5e-05,0.000241,0.000264 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8e-06,0.00105,0.000182 cost=2.78e+04 flops[gemm]=2.63e+07
--- TIMING FOR renorm : t_inter=8e-06 t_gemm=0.00105 t_reduction=0.000182 tot=0.00125 ---
 renorm counter=11 i=0 t=0.00021 per=19.9 cost=1.82e+03 flops=8.68e+06
 renorm counter=11 i=1 t=0.000208 per=19.7 cost=3.23e+03 flops=1.55e+07
 renorm counter=11 i=2 t=0.000198 per=18.8 cost=1.91e+03 flops=9.63e+06
 renorm counter=11 i=3 t=0.000206 per=19.5 cost=3.14e+03 flops=1.53e+07
 renorm counter=11 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=11 i=5 t=1e-06 per=0.0948 cost=0 flops=0
 renorm counter=11 i=6 t=0.000232 per=22 cost=1.77e+04 flops=7.63e+07
 total GEMM cost=2.78e+04 flops=2.63e+07
--- TIMING FOR renorm_tot : t_inter=0.000998 t_gemm=0.012 t_reduction=0.0021 tot=0.0151 ---
 renorm_tot counter=11 i=0 t=0.00235 per=19.6 cost=3.67e+04 flops=1.56e+07
 renorm_tot counter=11 i=1 t=0.00237 per=19.8 cost=5.08e+04 flops=2.14e+07
 renorm_tot counter=11 i=2 t=0.00104 per=8.68 cost=2.64e+04 flops=2.54e+07
 renorm_tot counter=11 i=3 t=0.00107 per=8.9 cost=4.61e+04 flops=4.32e+07
 renorm_tot counter=11 i=4 t=0.00126 per=10.5 cost=4.29e+04 flops=3.42e+07
 renorm_tot counter=11 i=5 t=0.00128 per=10.6 cost=7.43e+04 flops=5.82e+07
 renorm_tot counter=11 i=6 t=0.00262 per=21.9 cost=4.16e+05 flops=1.59e+08
 total GEMM cost=6.93e+05 flops=5.79e+07
check ||H-H.dagger||=0.00e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=8.8e-05,0.0025,8.4e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(3,0) size=1.03e-05GB T[save](info/data/tot)=5.07e-05,3.18e-05,8.25e-05 speed=0.125GB/s disk[used]=9.23e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
##### time_local: 4.20e-02 S #####
 T(fetch) = 7.39e-05 S  per = 0.18  per(accum) = 0.18
 T(hdiag) = 7.83e-05 S  per = 0.19  per(accum) = 0.36
 T(dvdsn) = 3.85e-02 S  per =   92  per(accum) = 92
 T(decim) = 8.20e-05 S  per =  0.2  per(accum) = 92
 T(guess) = 7.90e-05 S  per = 0.19  per(accum) = 92
 T(renrm) = 2.64e-03 S  per =  6.3  per(accum) = 99
 T(save ) = 5.25e-04 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.84e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 3.98e-05 S  per =  0.1  per(accum) = 0.1
 T(symbolic_formulae_twodot     ) = 2.31e-04 S  per =  0.6  per(accum) = 0.7
 T(hintermediate init           ) = 2.13e-05 S  per = 0.056  per(accum) = 0.76
 T(hintermediates memcpy cpu2gpu) = 3.56e-06 S  per = 0.0093  per(accum) = 0.77
 T(preprocess_hformulae_Hxlist2 ) = 2.27e-03 S  per =  5.9  per(accum) = 6.7
 T(hmmtasks init                ) = 1.39e-03 S  per =  3.6  per(accum) = 10
 T(dvdson solver [Hx_batchGPU]  ) = 3.41e-02 S  per =   89  per(accum) = 99
 T(dvdson solver [communication]) = 9.77e-07 S  per = 0.0025  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.39e-04 S  per = 0.88  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.59e-03 S
 T(qops init                    ) = 8.79e-05 S  per =  3.4  per(accum) = 3.4
 T(qops_dict memcpy cpu2gpu     ) = 2.78e-05 S  per =  1.1  per(accum) = 4.5
 T(symbolic_formulae_renorm     ) = 2.02e-04 S  per =  7.8  per(accum) = 12
 T(rintermediate init           ) = 9.68e-06 S  per = 0.37  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.77e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.70e-04 S  per =   22  per(accum) = 35
 T(rmmtasks init                ) = 3.29e-04 S  per =   13  per(accum) = 47
 T(qops memset                  ) = 8.27e-06 S  per = 0.32  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.32e-03 S  per =   51  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.77e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.42e-06 S  per = 0.32  per(accum) = 1e+02
##### time_sweep: 9.48e-02 S #####
 T(fetch) = 4.40e-04 S  per = 0.46  per(accum) = 0.46
 T(hdiag) = 2.17e-04 S  per = 0.23  per(accum) = 0.69
 T(dvdsn) = 8.37e-02 S  per =   88  per(accum) = 89
 T(decim) = 4.71e-04 S  per =  0.5  per(accum) = 90
 T(guess) = 2.31e-04 S  per = 0.24  per(accum) = 90
 T(renrm) = 8.09e-03 S  per =  8.5  per(accum) = 98
 T(save ) = 1.61e-03 S  per =  1.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.32e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.19e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 6.90e-04 S  per = 0.83  per(accum) = 0.97
 T(hintermediate init           ) = 6.48e-05 S  per = 0.078  per(accum) = 1.1
 T(hintermediates memcpy cpu2gpu) = 1.06e-05 S  per = 0.013  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 6.76e-03 S  per =  8.1  per(accum) = 9.2
 T(hmmtasks init                ) = 4.18e-03 S  per =    5  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 7.07e-02 S  per =   85  per(accum) = 99
 T(dvdson solver [communication]) = 1.90e-06 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.01e-04 S  per = 0.84  per(accum) = 1e+02
Detailed decomposition of T(renrm): 7.95e-03 S
 T(qops init                    ) = 2.49e-04 S  per =  3.1  per(accum) = 3.1
 T(qops_dict memcpy cpu2gpu     ) = 8.94e-05 S  per =  1.1  per(accum) = 4.3
 T(symbolic_formulae_renorm     ) = 5.77e-04 S  per =  7.3  per(accum) = 12
 T(rintermediate init           ) = 4.11e-05 S  per = 0.52  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 1.42e-05 S  per = 0.18  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 1.64e-03 S  per =   21  per(accum) = 33
 T(rmmtasks init                ) = 1.04e-03 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 2.48e-05 S  per = 0.31  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 4.17e-03 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 8.21e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.55e-05 S  per = 0.32  per(accum) = 1e+02
##### time_global: 4.06e-01 S #####
 T(fetch) = 2.70e-03 S  per = 0.67  per(accum) = 0.67
 T(hdiag) = 9.27e-04 S  per = 0.23  per(accum) = 0.89
 T(dvdsn) = 3.61e-01 S  per =   89  per(accum) = 90
 T(decim) = 2.86e-03 S  per =  0.7  per(accum) = 90
 T(guess) = 9.81e-04 S  per = 0.24  per(accum) = 91
 T(renrm) = 3.13e-02 S  per =  7.7  per(accum) = 98
 T(save ) = 6.39e-03 S  per =  1.6  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.59e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 4.71e-04 S  per = 0.13  per(accum) = 0.13
 T(symbolic_formulae_twodot     ) = 2.98e-03 S  per = 0.83  per(accum) = 0.96
 T(hintermediate init           ) = 3.01e-04 S  per = 0.084  per(accum) = 1
 T(hintermediates memcpy cpu2gpu) = 4.84e-05 S  per = 0.013  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 2.54e-02 S  per =  7.1  per(accum) = 8.1
 T(hmmtasks init                ) = 1.58e-02 S  per =  4.4  per(accum) = 13
 T(dvdson solver [Hx_batchGPU]  ) = 3.10e-01 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 8.26e-06 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.67e-03 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 3.08e-02 S
 T(qops init                    ) = 1.42e-03 S  per =  4.6  per(accum) = 4.6
 T(qops_dict memcpy cpu2gpu     ) = 3.96e-04 S  per =  1.3  per(accum) = 5.9
 T(symbolic_formulae_renorm     ) = 2.42e-03 S  per =  7.9  per(accum) = 14
 T(rintermediate init           ) = 1.94e-04 S  per = 0.63  per(accum) = 14
 T(rintermediates memcpy cpu2gpu) = 5.99e-05 S  per = 0.19  per(accum) = 15
 T(preprocess_formulae_Rlist2   ) = 5.96e-03 S  per =   19  per(accum) = 34
 T(rmmtasks init                ) = 3.77e-03 S  per =   12  per(accum) = 46
 T(qops memset                  ) = 9.95e-05 S  per = 0.32  per(accum) = 47
 T(preprocess_renorm_batchGPU   ) = 1.60e-02 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.28e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.04e-04 S  per = 0.34  per(accum) = 1e+02

isweep=2 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.275e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x448f3b70
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.181e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.864e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00222 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.24e-05,0.00095,0.00122 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.6e-05,0.000202,0.00195,0.000188 cost=7.9e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0.000202 t_gemm=0.00195 t_reduction=0.000188 tot=0.00234 ---
 sigma counter=127 i=0 t=0.000242 per=12.4 cost=7.01e+03 flops=2.9e+07
 sigma counter=127 i=1 t=0.00024 per=12.3 cost=6.99e+03 flops=2.91e+07
 sigma counter=127 i=2 t=0.000231 per=11.8 cost=6.81e+03 flops=2.95e+07
 sigma counter=127 i=3 t=0.000243 per=12.4 cost=6.78e+03 flops=2.79e+07
 sigma counter=127 i=4 t=0.000252 per=12.9 cost=1.89e+04 flops=7.5e+07
 sigma counter=127 i=5 t=0.000261 per=13.4 cost=1.89e+04 flops=7.24e+07
 sigma counter=127 i=6 t=0.000252 per=12.9 cost=6.78e+03 flops=2.69e+07
 sigma counter=127 i=7 t=0.000231 per=11.8 cost=6.81e+03 flops=2.95e+07
 total GEMM cost=7.9e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0.0255 t_gemm=0.248 t_reduction=0.0246 tot=0.298 ---
 sigma_tot counter=127 i=0 t=0.0304 per=12.3 cost=7.18e+05 flops=2.36e+07
 sigma_tot counter=127 i=1 t=0.0312 per=12.6 cost=7.29e+05 flops=2.34e+07
 sigma_tot counter=127 i=2 t=0.0302 per=12.2 cost=7.27e+05 flops=2.41e+07
 sigma_tot counter=127 i=3 t=0.0304 per=12.3 cost=7.33e+05 flops=2.41e+07
 sigma_tot counter=127 i=4 t=0.0304 per=12.3 cost=1.13e+06 flops=3.73e+07
 sigma_tot counter=127 i=5 t=0.0309 per=12.5 cost=1.13e+06 flops=3.66e+07
 sigma_tot counter=127 i=6 t=0.0332 per=13.4 cost=1.49e+06 flops=4.5e+07
 sigma_tot counter=127 i=7 t=0.031 per=12.5 cost=1.48e+06 flops=4.78e+07
 total GEMM cost=8.15e+06 flops=3.29e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.6e-05,0.000199,0.00195,0.000189 cost=7.9e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0.000199 t_gemm=0.00195 t_reduction=0.000189 tot=0.00234 ---
 sigma counter=128 i=0 t=0.000234 per=12 cost=7.01e+03 flops=2.99e+07
 sigma counter=128 i=1 t=0.000239 per=12.3 cost=6.99e+03 flops=2.92e+07
 sigma counter=128 i=2 t=0.000243 per=12.5 cost=6.81e+03 flops=2.8e+07
 sigma counter=128 i=3 t=0.000238 per=12.2 cost=6.78e+03 flops=2.85e+07
 sigma counter=128 i=4 t=0.000254 per=13 cost=1.89e+04 flops=7.44e+07
 sigma counter=128 i=5 t=0.000251 per=12.9 cost=1.89e+04 flops=7.53e+07
 sigma counter=128 i=6 t=0.000253 per=13 cost=6.78e+03 flops=2.68e+07
 sigma counter=128 i=7 t=0.000236 per=12.1 cost=6.81e+03 flops=2.89e+07
 total GEMM cost=7.9e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0.0257 t_gemm=0.25 t_reduction=0.0248 tot=0.3 ---
 sigma_tot counter=128 i=0 t=0.0307 per=12.3 cost=7.25e+05 flops=2.36e+07
 sigma_tot counter=128 i=1 t=0.0315 per=12.6 cost=7.36e+05 flops=2.34e+07
 sigma_tot counter=128 i=2 t=0.0305 per=12.2 cost=7.34e+05 flops=2.41e+07
 sigma_tot counter=128 i=3 t=0.0307 per=12.3 cost=7.4e+05 flops=2.41e+07
 sigma_tot counter=128 i=4 t=0.0306 per=12.3 cost=1.15e+06 flops=3.76e+07
 sigma_tot counter=128 i=5 t=0.0311 per=12.5 cost=1.15e+06 flops=3.7e+07
 sigma_tot counter=128 i=6 t=0.0334 per=13.4 cost=1.5e+06 flops=4.48e+07
 sigma_tot counter=128 i=7 t=0.0313 per=12.5 cost=1.49e+06 flops=4.77e+07
 total GEMM cost=8.23e+06 flops=3.29e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   4.92e-03  2.46e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   4.92e-03  2.46e-03
TIMING for Davidson : 4.94e-03  T(cal/comm/rest)=4.90e-03,1.06e-07,4.23e-05
optimized energies: isweep=2 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=2 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep2_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.628e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 2.112e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=3.26e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Rlist : 0.000528 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.57e-05,0.000246,0.000236 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000932 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07,0.0009
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000182,0.00107,0.000187 cost=1.55e+05 flops[gemm]=1.45e+08
--- TIMING FOR renorm : t_inter=0.000181 t_gemm=0.00107 t_reduction=0.000187 tot=0.00143 ---
 renorm counter=12 i=0 t=0.000199 per=18.7 cost=5.64e+03 flops=2.83e+07
 renorm counter=12 i=1 t=0.00021 per=19.7 cost=1.13e+04 flops=5.37e+07
 renorm counter=12 i=2 t=0.000202 per=18.9 cost=1.66e+04 flops=8.2e+07
 renorm counter=12 i=3 t=0.000212 per=19.9 cost=2.89e+04 flops=1.36e+08
 renorm counter=12 i=4 t=1e-06 per=0.0938 cost=0 flops=0
 renorm counter=12 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=12 i=6 t=0.000242 per=22.7 cost=9.22e+04 flops=3.81e+08
 total GEMM cost=1.55e+05 flops=1.45e+08
--- TIMING FOR renorm_tot : t_inter=0.00118 t_gemm=0.013 t_reduction=0.00229 tot=0.0165 ---
 renorm_tot counter=12 i=0 t=0.00255 per=19.5 cost=4.23e+04 flops=1.66e+07
 renorm_tot counter=12 i=1 t=0.00258 per=19.8 cost=6.2e+04 flops=2.4e+07
 renorm_tot counter=12 i=2 t=0.00124 per=9.52 cost=4.29e+04 flops=3.46e+07
 renorm_tot counter=12 i=3 t=0.00128 per=9.79 cost=7.5e+04 flops=5.87e+07
 renorm_tot counter=12 i=4 t=0.00126 per=9.63 cost=4.29e+04 flops=3.41e+07
 renorm_tot counter=12 i=5 t=0.00128 per=9.78 cost=7.43e+04 flops=5.82e+07
 renorm_tot counter=12 i=6 t=0.00287 per=22 cost=5.09e+05 flops=1.78e+08
 total GEMM cost=8.48e+05 flops=6.5e+07
check ||H-H.dagger||=5.62e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0028 S T(init/kernel/comm)=7.7e-05,0.0027,8e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(2,0) size=1.94e-05GB T[save](info/data/tot)=4.8e-05,5.2e-05,0.0001 speed=0.194GB/s disk[used]=9.37e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
##### time_local: 1.32e-02 S #####
 T(fetch) = 2.99e-04 S  per =  2.3  per(accum) = 2.3
 T(hdiag) = 6.91e-05 S  per = 0.53  per(accum) = 2.8
 T(dvdsn) = 9.03e-03 S  per =   69  per(accum) = 71
 T(decim) = 3.22e-04 S  per =  2.5  per(accum) = 74
 T(guess) = 7.75e-05 S  per = 0.59  per(accum) = 74
 T(renrm) = 2.80e-03 S  per =   21  per(accum) = 96
 T(save ) = 5.55e-04 S  per =  4.2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.84e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 3.97e-05 S  per = 0.45  per(accum) = 0.45
 T(symbolic_formulae_twodot     ) = 2.23e-04 S  per =  2.5  per(accum) = 3
 T(hintermediate init           ) = 2.15e-05 S  per = 0.24  per(accum) = 3.2
 T(hintermediates memcpy cpu2gpu) = 3.41e-06 S  per = 0.039  per(accum) = 3.2
 T(preprocess_hformulae_Hxlist2 ) = 2.23e-03 S  per =   25  per(accum) = 28
 T(hmmtasks init                ) = 1.39e-03 S  per =   16  per(accum) = 44
 T(dvdson solver [Hx_batchGPU]  ) = 4.90e-03 S  per =   55  per(accum) = 1e+02
 T(dvdson solver [communication]) = 1.06e-07 S  per = 0.0012  per(accum) = 1e+02
 T(dvdson solver [rest part]    ) = 4.23e-05 S  per = 0.48  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.75e-03 S
 T(qops init                    ) = 7.68e-05 S  per =  2.8  per(accum) = 2.8
 T(qops_dict memcpy cpu2gpu     ) = 3.51e-05 S  per =  1.3  per(accum) = 4.1
 T(symbolic_formulae_renorm     ) = 1.67e-04 S  per =  6.1  per(accum) = 10
 T(rintermediate init           ) = 2.42e-05 S  per = 0.88  per(accum) = 11
 T(rintermediates memcpy cpu2gpu) = 4.61e-06 S  per = 0.17  per(accum) = 11
 T(preprocess_formulae_Rlist2   ) = 5.37e-04 S  per =   20  per(accum) = 31
 T(rmmtasks init                ) = 3.59e-04 S  per =   13  per(accum) = 44
 T(qops memset                  ) = 8.34e-06 S  per =  0.3  per(accum) = 44
 T(preprocess_renorm_batchGPU   ) = 1.50e-03 S  per =   55  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.64e-05 S  per = 0.96  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.01e-06 S  per = 0.29  per(accum) = 1e+02
##### time_sweep: 1.08e-01 S #####
 T(fetch) = 7.39e-04 S  per = 0.69  per(accum) = 0.69
 T(hdiag) = 2.86e-04 S  per = 0.27  per(accum) = 0.95
 T(dvdsn) = 9.27e-02 S  per =   86  per(accum) = 87
 T(decim) = 7.94e-04 S  per = 0.74  per(accum) = 88
 T(guess) = 3.09e-04 S  per = 0.29  per(accum) = 88
 T(renrm) = 1.09e-02 S  per =   10  per(accum) = 98
 T(save ) = 2.16e-03 S  per =    2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 9.20e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.59e-04 S  per = 0.17  per(accum) = 0.17
 T(symbolic_formulae_twodot     ) = 9.13e-04 S  per = 0.99  per(accum) = 1.2
 T(hintermediate init           ) = 8.62e-05 S  per = 0.094  per(accum) = 1.3
 T(hintermediates memcpy cpu2gpu) = 1.40e-05 S  per = 0.015  per(accum) = 1.3
 T(preprocess_hformulae_Hxlist2 ) = 8.99e-03 S  per =  9.8  per(accum) = 11
 T(hmmtasks init                ) = 5.57e-03 S  per =    6  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 7.56e-02 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 2.00e-06 S  per = 0.0022  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.44e-04 S  per = 0.81  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.07e-02 S
 T(qops init                    ) = 3.26e-04 S  per =    3  per(accum) = 3
 T(qops_dict memcpy cpu2gpu     ) = 1.24e-04 S  per =  1.2  per(accum) = 4.2
 T(symbolic_formulae_renorm     ) = 7.45e-04 S  per =    7  per(accum) = 11
 T(rintermediate init           ) = 6.53e-05 S  per = 0.61  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 1.88e-05 S  per = 0.18  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 2.17e-03 S  per =   20  per(accum) = 32
 T(rmmtasks init                ) = 1.39e-03 S  per =   13  per(accum) = 45
 T(qops memset                  ) = 3.31e-05 S  per = 0.31  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 5.67e-03 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.09e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 3.35e-05 S  per = 0.31  per(accum) = 1e+02
##### time_global: 4.20e-01 S #####
 T(fetch) = 3.00e-03 S  per = 0.72  per(accum) = 0.72
 T(hdiag) = 9.97e-04 S  per = 0.24  per(accum) = 0.95
 T(dvdsn) = 3.70e-01 S  per =   88  per(accum) = 89
 T(decim) = 3.18e-03 S  per = 0.76  per(accum) = 90
 T(guess) = 1.06e-03 S  per = 0.25  per(accum) = 90
 T(renrm) = 3.41e-02 S  per =  8.1  per(accum) = 98
 T(save ) = 6.95e-03 S  per =  1.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.68e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 5.11e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 3.20e-03 S  per = 0.87  per(accum) = 1
 T(hintermediate init           ) = 3.22e-04 S  per = 0.088  per(accum) = 1.1
 T(hintermediates memcpy cpu2gpu) = 5.18e-05 S  per = 0.014  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 2.76e-02 S  per =  7.5  per(accum) = 8.6
 T(hmmtasks init                ) = 1.72e-02 S  per =  4.7  per(accum) = 13
 T(dvdson solver [Hx_batchGPU]  ) = 3.15e-01 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 8.37e-06 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.71e-03 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 3.35e-02 S
 T(qops init                    ) = 1.50e-03 S  per =  4.5  per(accum) = 4.5
 T(qops_dict memcpy cpu2gpu     ) = 4.31e-04 S  per =  1.3  per(accum) = 5.8
 T(symbolic_formulae_renorm     ) = 2.58e-03 S  per =  7.7  per(accum) = 13
 T(rintermediate init           ) = 2.18e-04 S  per = 0.65  per(accum) = 14
 T(rintermediates memcpy cpu2gpu) = 6.45e-05 S  per = 0.19  per(accum) = 14
 T(preprocess_formulae_Rlist2   ) = 6.49e-03 S  per =   19  per(accum) = 34
 T(rmmtasks init                ) = 4.13e-03 S  per =   12  per(accum) = 46
 T(qops memset                  ) = 1.08e-04 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 1.75e-02 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.54e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.12e-04 S  per = 0.33  per(accum) = 1e+02

======================================================================
sweep_data::summary isweep=2
----------------------------------------------------------------------
sweep parameters: isweep=2 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.04
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.013
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.042
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.013
 eav_max=-2.54574720706 [ibond=0]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=2]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=1.60478874633e-09
 sweep energies: isweep=2 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[0]=-2.65451696664
 sweep energies: isweep=2 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=2
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.00e-04 1.00e-04 | 52 | 1.69e-01 | 1.69e-01 | 1.10e-02 1.06e-01 1.11e-02 1.28e-01 76.1
            1  2      20 1.00e-04 0.00e+00 | 45 | 1.46e-01 | 3.15e-01 | 2.04e-02 1.98e-01 2.05e-02 2.39e-01 76
            2  2      20 1.00e-04 0.00e+00 | 31 | 1.09e-01 | 4.24e-01 | 2.69e-02 2.63e-01 2.71e-02 3.17e-01 74.8
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.50e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
            1      20 +5.26e-04 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.63e-13)
            2      20 +0.00e+00 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep2.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep2_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
decimation summary: 80->8 dwt=+0.000e+00 SvN=1.326e+00

Convert [C]RRR => [cR]RRR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep2_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00

ctns::rcanon_save fname=./scratch/rcanon_isweep2.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.00e+00
 idx=2 node=(2,0) Drow=20 maxdiff=1.71e-15
 idx=3 node=(1,0) Drow=8 maxdiff=6.31e-16
 idx=4 node=(0,0) Drow=2 maxdiff=4.03e-16
stensor2: wf2 own=1 _data=0x448eef60
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.05e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x448eef60
     -1.0000e+00      -2.6438e-17 
      3.3408e-17      -1.0000e+00 
 rwfuns: nroots=2 maxdiff=9.8580e-18
----- TIMING FOR ctns::rcanon_check : 8.244e-05 S -----
..... end of isweep = 2 .....

======================================================================
sweep parameters: isweep=3 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB

isweep=3 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.010e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB
===== CPUmem(GB): tot=3.61e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x448c6560
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.265e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.843e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00223 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.52e-05,0.000962,0.00122 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=5.1e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.5e-05,0.000202,0.00194,0.000189 cost=7.9e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0.000202 t_gemm=0.00194 t_reduction=0.000188 tot=0.00233 ---
 sigma counter=129 i=0 t=0.000237 per=12.2 cost=7.01e+03 flops=2.96e+07
 sigma counter=129 i=1 t=0.000246 per=12.7 cost=6.99e+03 flops=2.84e+07
 sigma counter=129 i=2 t=0.000232 per=12 cost=6.81e+03 flops=2.94e+07
 sigma counter=129 i=3 t=0.000235 per=12.1 cost=6.78e+03 flops=2.89e+07
 sigma counter=129 i=4 t=0.000254 per=13.1 cost=1.89e+04 flops=7.44e+07
 sigma counter=129 i=5 t=0.000258 per=13.3 cost=1.89e+04 flops=7.32e+07
 sigma counter=129 i=6 t=0.000244 per=12.6 cost=6.78e+03 flops=2.78e+07
 sigma counter=129 i=7 t=0.000235 per=12.1 cost=6.81e+03 flops=2.9e+07
 total GEMM cost=7.9e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0.0259 t_gemm=0.252 t_reduction=0.025 tot=0.303 ---
 sigma_tot counter=129 i=0 t=0.0309 per=12.3 cost=7.32e+05 flops=2.37e+07
 sigma_tot counter=129 i=1 t=0.0317 per=12.6 cost=7.43e+05 flops=2.34e+07
 sigma_tot counter=129 i=2 t=0.0307 per=12.2 cost=7.41e+05 flops=2.41e+07
 sigma_tot counter=129 i=3 t=0.0309 per=12.3 cost=7.47e+05 flops=2.42e+07
 sigma_tot counter=129 i=4 t=0.0309 per=12.3 cost=1.17e+06 flops=3.79e+07
 sigma_tot counter=129 i=5 t=0.0314 per=12.5 cost=1.17e+06 flops=3.73e+07
 sigma_tot counter=129 i=6 t=0.0337 per=13.4 cost=1.51e+06 flops=4.47e+07
 sigma_tot counter=129 i=7 t=0.0315 per=12.5 cost=1.5e+06 flops=4.75e+07
 total GEMM cost=8.31e+06 flops=3.3e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.7e-05,0.000198,0.00194,0.000187 cost=7.9e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0.000198 t_gemm=0.00194 t_reduction=0.000187 tot=0.00232 ---
 sigma counter=130 i=0 t=0.000236 per=12.2 cost=7.01e+03 flops=2.97e+07
 sigma counter=130 i=1 t=0.000244 per=12.6 cost=6.99e+03 flops=2.86e+07
 sigma counter=130 i=2 t=0.000231 per=11.9 cost=6.81e+03 flops=2.95e+07
 sigma counter=130 i=3 t=0.000236 per=12.2 cost=6.78e+03 flops=2.87e+07
 sigma counter=130 i=4 t=0.000254 per=13.1 cost=1.89e+04 flops=7.44e+07
 sigma counter=130 i=5 t=0.000257 per=13.3 cost=1.89e+04 flops=7.35e+07
 sigma counter=130 i=6 t=0.000242 per=12.5 cost=6.78e+03 flops=2.8e+07
 sigma counter=130 i=7 t=0.000237 per=12.2 cost=6.81e+03 flops=2.88e+07
 total GEMM cost=7.9e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=0.0261 t_gemm=0.254 t_reduction=0.0252 tot=0.305 ---
 sigma_tot counter=130 i=0 t=0.0311 per=12.3 cost=7.39e+05 flops=2.37e+07
 sigma_tot counter=130 i=1 t=0.032 per=12.6 cost=7.5e+05 flops=2.35e+07
 sigma_tot counter=130 i=2 t=0.0309 per=12.2 cost=7.48e+05 flops=2.42e+07
 sigma_tot counter=130 i=3 t=0.0311 per=12.3 cost=7.54e+05 flops=2.42e+07
 sigma_tot counter=130 i=4 t=0.0312 per=12.3 cost=1.19e+06 flops=3.82e+07
 sigma_tot counter=130 i=5 t=0.0316 per=12.5 cost=1.19e+06 flops=3.76e+07
 sigma_tot counter=130 i=6 t=0.0339 per=13.4 cost=1.51e+06 flops=4.46e+07
 sigma_tot counter=130 i=7 t=0.0317 per=12.5 cost=1.5e+06 flops=4.74e+07
 total GEMM cost=8.38e+06 flops=3.31e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891  -1.00e+03   6.88e-02    2     2   4.90e-03  2.45e-03
    1   1 -      -2.436233901339  -1.00e+03   4.38e-02    2     2   4.90e-03  2.45e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.70e-05,2.00e-04,1.94e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=2.00e-04 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.33e-03 ---
 sigma counter=131 i=0 t=2.37e-04 per=1.22e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=131 i=1 t=2.41e-04 per=1.24e+01 cost=6.99e+03 flops=2.90e+07
 sigma counter=131 i=2 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=131 i=3 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=131 i=4 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=131 i=5 t=2.61e-04 per=1.34e+01 cost=1.89e+04 flops=7.24e+07
 sigma counter=131 i=6 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=131 i=7 t=2.39e-04 per=1.23e+01 cost=6.81e+03 flops=2.85e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=2.63e-02 t_gemm=2.56e-01 t_reduction=2.54e-02 tot=3.07e-01 ---
 sigma_tot counter=131 i=0 t=3.14e-02 per=1.23e+01 cost=7.46e+05 flops=2.38e+07
 sigma_tot counter=131 i=1 t=3.22e-02 per=1.26e+01 cost=7.57e+05 flops=2.35e+07
 sigma_tot counter=131 i=2 t=3.11e-02 per=1.22e+01 cost=7.54e+05 flops=2.42e+07
 sigma_tot counter=131 i=3 t=3.14e-02 per=1.23e+01 cost=7.61e+05 flops=2.42e+07
 sigma_tot counter=131 i=4 t=3.14e-02 per=1.23e+01 cost=1.21e+06 flops=3.85e+07
 sigma_tot counter=131 i=5 t=3.19e-02 per=1.25e+01 cost=1.21e+06 flops=3.78e+07
 sigma_tot counter=131 i=6 t=3.42e-02 per=1.34e+01 cost=1.52e+06 flops=4.45e+07
 sigma_tot counter=131 i=7 t=3.20e-02 per=1.25e+01 cost=1.51e+06 flops=4.73e+07
 total GEMM cost=8.46e+06 flops=3.31e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,2.00e-04,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=2.00e-04 t_gemm=1.94e-03 t_reduction=1.87e-04 tot=2.33e-03 ---
 sigma counter=132 i=0 t=2.36e-04 per=1.22e+01 cost=7.01e+03 flops=2.97e+07
 sigma counter=132 i=1 t=2.47e-04 per=1.27e+01 cost=6.99e+03 flops=2.83e+07
 sigma counter=132 i=2 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=132 i=3 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=132 i=4 t=2.56e-04 per=1.32e+01 cost=1.89e+04 flops=7.38e+07
 sigma counter=132 i=5 t=2.58e-04 per=1.33e+01 cost=1.89e+04 flops=7.32e+07
 sigma counter=132 i=6 t=2.42e-04 per=1.25e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=132 i=7 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=2.65e-02 t_gemm=2.57e-01 t_reduction=2.56e-02 tot=3.10e-01 ---
 sigma_tot counter=132 i=0 t=3.16e-02 per=1.23e+01 cost=7.53e+05 flops=2.38e+07
 sigma_tot counter=132 i=1 t=3.24e-02 per=1.26e+01 cost=7.64e+05 flops=2.36e+07
 sigma_tot counter=132 i=2 t=3.14e-02 per=1.22e+01 cost=7.61e+05 flops=2.43e+07
 sigma_tot counter=132 i=3 t=3.16e-02 per=1.23e+01 cost=7.67e+05 flops=2.43e+07
 sigma_tot counter=132 i=4 t=3.17e-02 per=1.23e+01 cost=1.23e+06 flops=3.88e+07
 sigma_tot counter=132 i=5 t=3.21e-02 per=1.25e+01 cost=1.23e+06 flops=3.81e+07
 sigma_tot counter=132 i=6 t=3.44e-02 per=1.34e+01 cost=1.53e+06 flops=4.43e+07
 sigma_tot counter=132 i=7 t=3.22e-02 per=1.25e+01 cost=1.52e+06 flops=4.71e+07
 total GEMM cost=8.54e+06 flops=3.32e+07
    2   0 -      -2.654428675110  -1.73e-03   1.26e-02    4     4   9.82e-03  2.45e-03
    2   1 -      -2.436964455587  -7.31e-04   4.22e-03    4     4   9.82e-03  2.45e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.99e-04,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.33e-03 ---
 sigma counter=133 i=0 t=2.37e-04 per=1.22e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=133 i=1 t=2.49e-04 per=1.28e+01 cost=6.99e+03 flops=2.81e+07
 sigma counter=133 i=2 t=2.33e-04 per=1.20e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=133 i=3 t=2.42e-04 per=1.25e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=133 i=4 t=2.45e-04 per=1.26e+01 cost=1.89e+04 flops=7.71e+07
 sigma counter=133 i=5 t=2.50e-04 per=1.29e+01 cost=1.89e+04 flops=7.56e+07
 sigma counter=133 i=6 t=2.52e-04 per=1.30e+01 cost=6.78e+03 flops=2.69e+07
 sigma counter=133 i=7 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=2.67e-02 t_gemm=2.59e-01 t_reduction=2.58e-02 tot=3.12e-01 ---
 sigma_tot counter=133 i=0 t=3.18e-02 per=1.23e+01 cost=7.60e+05 flops=2.39e+07
 sigma_tot counter=133 i=1 t=3.27e-02 per=1.26e+01 cost=7.71e+05 flops=2.36e+07
 sigma_tot counter=133 i=2 t=3.16e-02 per=1.22e+01 cost=7.68e+05 flops=2.43e+07
 sigma_tot counter=133 i=3 t=3.19e-02 per=1.23e+01 cost=7.74e+05 flops=2.43e+07
 sigma_tot counter=133 i=4 t=3.19e-02 per=1.23e+01 cost=1.25e+06 flops=3.91e+07
 sigma_tot counter=133 i=5 t=3.24e-02 per=1.25e+01 cost=1.24e+06 flops=3.84e+07
 sigma_tot counter=133 i=6 t=3.47e-02 per=1.34e+01 cost=1.53e+06 flops=4.42e+07
 sigma_tot counter=133 i=7 t=3.24e-02 per=1.25e+01 cost=1.52e+06 flops=4.70e+07
 total GEMM cost=8.62e+06 flops=3.32e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.97e-04,1.95e-03,1.96e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=1.97e-04 t_gemm=1.95e-03 t_reduction=1.95e-04 tot=2.34e-03 ---
 sigma counter=134 i=0 t=2.37e-04 per=1.21e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=134 i=1 t=2.46e-04 per=1.26e+01 cost=6.99e+03 flops=2.84e+07
 sigma counter=134 i=2 t=2.31e-04 per=1.18e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=134 i=3 t=2.34e-04 per=1.20e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=134 i=4 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=134 i=5 t=2.57e-04 per=1.32e+01 cost=1.89e+04 flops=7.35e+07
 sigma counter=134 i=6 t=2.57e-04 per=1.32e+01 cost=6.78e+03 flops=2.64e+07
 sigma counter=134 i=7 t=2.38e-04 per=1.22e+01 cost=6.81e+03 flops=2.86e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=2.69e-02 t_gemm=2.61e-01 t_reduction=2.60e-02 tot=3.14e-01 ---
 sigma_tot counter=134 i=0 t=3.21e-02 per=1.23e+01 cost=7.67e+05 flops=2.39e+07
 sigma_tot counter=134 i=1 t=3.29e-02 per=1.26e+01 cost=7.78e+05 flops=2.36e+07
 sigma_tot counter=134 i=2 t=3.18e-02 per=1.22e+01 cost=7.75e+05 flops=2.43e+07
 sigma_tot counter=134 i=3 t=3.21e-02 per=1.23e+01 cost=7.81e+05 flops=2.43e+07
 sigma_tot counter=134 i=4 t=3.22e-02 per=1.23e+01 cost=1.27e+06 flops=3.94e+07
 sigma_tot counter=134 i=5 t=3.27e-02 per=1.25e+01 cost=1.26e+06 flops=3.87e+07
 sigma_tot counter=134 i=6 t=3.49e-02 per=1.34e+01 cost=1.54e+06 flops=4.41e+07
 sigma_tot counter=134 i=7 t=3.27e-02 per=1.25e+01 cost=1.53e+06 flops=4.69e+07
 total GEMM cost=8.70e+06 flops=3.33e+07
    3   0 -      -2.654509664652  -8.10e-05   3.66e-03    6     6   1.47e-02  2.46e-03
    3   1 -      -2.436976459250  -1.20e-05   1.11e-03    6     6   1.47e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.99e-04,1.96e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.96e-03 t_reduction=1.87e-04 tot=2.35e-03 ---
 sigma counter=135 i=0 t=2.35e-04 per=1.20e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=135 i=1 t=2.50e-04 per=1.28e+01 cost=6.99e+03 flops=2.80e+07
 sigma counter=135 i=2 t=2.37e-04 per=1.21e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=135 i=3 t=2.43e-04 per=1.24e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=135 i=4 t=2.54e-04 per=1.30e+01 cost=1.89e+04 flops=7.44e+07
 sigma counter=135 i=5 t=2.57e-04 per=1.31e+01 cost=1.89e+04 flops=7.35e+07
 sigma counter=135 i=6 t=2.52e-04 per=1.29e+01 cost=6.78e+03 flops=2.69e+07
 sigma counter=135 i=7 t=2.31e-04 per=1.18e+01 cost=6.81e+03 flops=2.95e+07
 total GEMM cost=7.90e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=2.71e-02 t_gemm=2.63e-01 t_reduction=2.61e-02 tot=3.17e-01 ---
 sigma_tot counter=135 i=0 t=3.23e-02 per=1.23e+01 cost=7.74e+05 flops=2.39e+07
 sigma_tot counter=135 i=1 t=3.32e-02 per=1.26e+01 cost=7.85e+05 flops=2.37e+07
 sigma_tot counter=135 i=2 t=3.21e-02 per=1.22e+01 cost=7.82e+05 flops=2.44e+07
 sigma_tot counter=135 i=3 t=3.23e-02 per=1.23e+01 cost=7.88e+05 flops=2.44e+07
 sigma_tot counter=135 i=4 t=3.24e-02 per=1.23e+01 cost=1.29e+06 flops=3.96e+07
 sigma_tot counter=135 i=5 t=3.29e-02 per=1.25e+01 cost=1.28e+06 flops=3.90e+07
 sigma_tot counter=135 i=6 t=3.52e-02 per=1.34e+01 cost=1.55e+06 flops=4.40e+07
 sigma_tot counter=135 i=7 t=3.29e-02 per=1.25e+01 cost=1.54e+06 flops=4.67e+07
 total GEMM cost=8.78e+06 flops=3.33e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.96e-04,1.96e-03,1.90e-04 cost=7.90e+04 flops[gemm]=4.02e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.96e-03 t_reduction=1.90e-04 tot=2.35e-03 ---
 sigma counter=136 i=0 t=2.48e-04 per=1.26e+01 cost=7.01e+03 flops=2.82e+07
 sigma counter=136 i=1 t=2.45e-04 per=1.25e+01 cost=6.99e+03 flops=2.85e+07
 sigma counter=136 i=2 t=2.31e-04 per=1.18e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=136 i=3 t=2.35e-04 per=1.20e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=136 i=4 t=2.56e-04 per=1.30e+01 cost=1.89e+04 flops=7.38e+07
 sigma counter=136 i=5 t=2.56e-04 per=1.30e+01 cost=1.89e+04 flops=7.38e+07
 sigma counter=136 i=6 t=2.50e-04 per=1.27e+01 cost=6.78e+03 flops=2.71e+07
 sigma counter=136 i=7 t=2.43e-04 per=1.24e+01 cost=6.81e+03 flops=2.80e+07
 total GEMM cost=7.90e+04 flops=4.02e+07
--- TIMING FOR sigma_tot : t_inter=2.73e-02 t_gemm=2.65e-01 t_reduction=2.63e-02 tot=3.19e-01 ---
 sigma_tot counter=136 i=0 t=3.26e-02 per=1.23e+01 cost=7.81e+05 flops=2.40e+07
 sigma_tot counter=136 i=1 t=3.34e-02 per=1.26e+01 cost=7.92e+05 flops=2.37e+07
 sigma_tot counter=136 i=2 t=3.23e-02 per=1.22e+01 cost=7.88e+05 flops=2.44e+07
 sigma_tot counter=136 i=3 t=3.26e-02 per=1.23e+01 cost=7.94e+05 flops=2.44e+07
 sigma_tot counter=136 i=4 t=3.27e-02 per=1.23e+01 cost=1.30e+06 flops=3.99e+07
 sigma_tot counter=136 i=5 t=3.32e-02 per=1.25e+01 cost=1.30e+06 flops=3.92e+07
 sigma_tot counter=136 i=6 t=3.54e-02 per=1.34e+01 cost=1.55e+06 flops=4.38e+07
 sigma_tot counter=136 i=7 t=3.32e-02 per=1.25e+01 cost=1.55e+06 flops=4.66e+07
 total GEMM cost=8.86e+06 flops=3.34e+07
    4   0 -      -2.654516020764  -6.36e-06   1.14e-03    6     8   1.97e-02  2.46e-03
    4   1 -      -2.436977285934  -8.27e-07   4.03e-04    6     8   1.97e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.98e-04,1.94e-03,1.86e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.94e-03 t_reduction=1.86e-04 tot=2.32e-03 ---
 sigma counter=137 i=0 t=2.35e-04 per=1.21e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=137 i=1 t=2.51e-04 per=1.29e+01 cost=6.99e+03 flops=2.78e+07
 sigma counter=137 i=2 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=137 i=3 t=2.35e-04 per=1.21e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=137 i=4 t=2.54e-04 per=1.31e+01 cost=1.89e+04 flops=7.44e+07
 sigma counter=137 i=5 t=2.56e-04 per=1.32e+01 cost=1.89e+04 flops=7.38e+07
 sigma counter=137 i=6 t=2.46e-04 per=1.27e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=137 i=7 t=2.30e-04 per=1.19e+01 cost=6.81e+03 flops=2.96e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=2.75e-02 t_gemm=2.67e-01 t_reduction=2.65e-02 tot=3.21e-01 ---
 sigma_tot counter=137 i=0 t=3.28e-02 per=1.23e+01 cost=7.88e+05 flops=2.40e+07
 sigma_tot counter=137 i=1 t=3.37e-02 per=1.26e+01 cost=7.99e+05 flops=2.37e+07
 sigma_tot counter=137 i=2 t=3.25e-02 per=1.22e+01 cost=7.95e+05 flops=2.44e+07
 sigma_tot counter=137 i=3 t=3.28e-02 per=1.23e+01 cost=8.01e+05 flops=2.44e+07
 sigma_tot counter=137 i=4 t=3.29e-02 per=1.23e+01 cost=1.32e+06 flops=4.02e+07
 sigma_tot counter=137 i=5 t=3.34e-02 per=1.25e+01 cost=1.32e+06 flops=3.95e+07
 sigma_tot counter=137 i=6 t=3.57e-02 per=1.33e+01 cost=1.56e+06 flops=4.37e+07
 sigma_tot counter=137 i=7 t=3.34e-02 per=1.25e+01 cost=1.55e+06 flops=4.65e+07
 total GEMM cost=8.94e+06 flops=3.34e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.96e-04,1.95e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.95e-03 t_reduction=1.89e-04 tot=2.33e-03 ---
 sigma counter=138 i=0 t=2.34e-04 per=1.20e+01 cost=7.01e+03 flops=2.99e+07
 sigma counter=138 i=1 t=2.49e-04 per=1.28e+01 cost=6.99e+03 flops=2.81e+07
 sigma counter=138 i=2 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=138 i=3 t=2.44e-04 per=1.25e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=138 i=4 t=2.52e-04 per=1.29e+01 cost=1.89e+04 flops=7.50e+07
 sigma counter=138 i=5 t=2.50e-04 per=1.28e+01 cost=1.89e+04 flops=7.56e+07
 sigma counter=138 i=6 t=2.53e-04 per=1.30e+01 cost=6.78e+03 flops=2.68e+07
 sigma counter=138 i=7 t=2.33e-04 per=1.20e+01 cost=6.81e+03 flops=2.92e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=2.77e-02 t_gemm=2.69e-01 t_reduction=2.67e-02 tot=3.24e-01 ---
 sigma_tot counter=138 i=0 t=3.30e-02 per=1.23e+01 cost=7.95e+05 flops=2.41e+07
 sigma_tot counter=138 i=1 t=3.39e-02 per=1.26e+01 cost=8.06e+05 flops=2.38e+07
 sigma_tot counter=138 i=2 t=3.28e-02 per=1.22e+01 cost=8.02e+05 flops=2.45e+07
 sigma_tot counter=138 i=3 t=3.30e-02 per=1.23e+01 cost=8.08e+05 flops=2.45e+07
 sigma_tot counter=138 i=4 t=3.32e-02 per=1.23e+01 cost=1.34e+06 flops=4.04e+07
 sigma_tot counter=138 i=5 t=3.37e-02 per=1.25e+01 cost=1.34e+06 flops=3.98e+07
 sigma_tot counter=138 i=6 t=3.59e-02 per=1.33e+01 cost=1.57e+06 flops=4.36e+07
 sigma_tot counter=138 i=7 t=3.36e-02 per=1.25e+01 cost=1.56e+06 flops=4.64e+07
 total GEMM cost=9.02e+06 flops=3.35e+07
    5   0 -      -2.654516818921  -7.98e-07   4.45e-04    6    10   2.46e-02  2.46e-03
    5   1 -      -2.436977409925  -1.24e-07   2.05e-04    6    10   2.46e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.98e-04,1.96e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.96e-03 t_reduction=1.88e-04 tot=2.34e-03 ---
 sigma counter=139 i=0 t=2.33e-04 per=1.19e+01 cost=7.01e+03 flops=3.01e+07
 sigma counter=139 i=1 t=2.38e-04 per=1.22e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=139 i=2 t=2.41e-04 per=1.23e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=139 i=3 t=2.52e-04 per=1.29e+01 cost=6.78e+03 flops=2.69e+07
 sigma counter=139 i=4 t=2.45e-04 per=1.25e+01 cost=1.89e+04 flops=7.71e+07
 sigma counter=139 i=5 t=2.57e-04 per=1.31e+01 cost=1.89e+04 flops=7.35e+07
 sigma counter=139 i=6 t=2.51e-04 per=1.28e+01 cost=6.78e+03 flops=2.70e+07
 sigma counter=139 i=7 t=2.39e-04 per=1.22e+01 cost=6.81e+03 flops=2.85e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=2.79e-02 t_gemm=2.71e-01 t_reduction=2.69e-02 tot=3.26e-01 ---
 sigma_tot counter=139 i=0 t=3.33e-02 per=1.23e+01 cost=8.02e+05 flops=2.41e+07
 sigma_tot counter=139 i=1 t=3.42e-02 per=1.26e+01 cost=8.13e+05 flops=2.38e+07
 sigma_tot counter=139 i=2 t=3.30e-02 per=1.22e+01 cost=8.09e+05 flops=2.45e+07
 sigma_tot counter=139 i=3 t=3.33e-02 per=1.23e+01 cost=8.15e+05 flops=2.45e+07
 sigma_tot counter=139 i=4 t=3.34e-02 per=1.23e+01 cost=1.36e+06 flops=4.07e+07
 sigma_tot counter=139 i=5 t=3.39e-02 per=1.25e+01 cost=1.36e+06 flops=4.00e+07
 sigma_tot counter=139 i=6 t=3.62e-02 per=1.33e+01 cost=1.57e+06 flops=4.35e+07
 sigma_tot counter=139 i=7 t=3.39e-02 per=1.25e+01 cost=1.57e+06 flops=4.62e+07
 total GEMM cost=9.10e+06 flops=3.35e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.97e-04,1.93e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=1.97e-04 t_gemm=1.93e-03 t_reduction=1.88e-04 tot=2.32e-03 ---
 sigma counter=140 i=0 t=2.35e-04 per=1.22e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=140 i=1 t=2.49e-04 per=1.29e+01 cost=6.99e+03 flops=2.81e+07
 sigma counter=140 i=2 t=2.39e-04 per=1.24e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=140 i=3 t=2.34e-04 per=1.21e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=140 i=4 t=2.52e-04 per=1.30e+01 cost=1.89e+04 flops=7.50e+07
 sigma counter=140 i=5 t=2.49e-04 per=1.29e+01 cost=1.89e+04 flops=7.59e+07
 sigma counter=140 i=6 t=2.42e-04 per=1.25e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=140 i=7 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 total GEMM cost=7.90e+04 flops=4.09e+07
--- TIMING FOR sigma_tot : t_inter=2.81e-02 t_gemm=2.73e-01 t_reduction=2.71e-02 tot=3.28e-01 ---
 sigma_tot counter=140 i=0 t=3.35e-02 per=1.23e+01 cost=8.09e+05 flops=2.41e+07
 sigma_tot counter=140 i=1 t=3.44e-02 per=1.26e+01 cost=8.20e+05 flops=2.38e+07
 sigma_tot counter=140 i=2 t=3.33e-02 per=1.22e+01 cost=8.16e+05 flops=2.45e+07
 sigma_tot counter=140 i=3 t=3.35e-02 per=1.23e+01 cost=8.22e+05 flops=2.45e+07
 sigma_tot counter=140 i=4 t=3.37e-02 per=1.23e+01 cost=1.38e+06 flops=4.10e+07
 sigma_tot counter=140 i=5 t=3.42e-02 per=1.25e+01 cost=1.38e+06 flops=4.03e+07
 sigma_tot counter=140 i=6 t=3.64e-02 per=1.33e+01 cost=1.58e+06 flops=4.34e+07
 sigma_tot counter=140 i=7 t=3.41e-02 per=1.25e+01 cost=1.57e+06 flops=4.61e+07
 total GEMM cost=9.17e+06 flops=3.36e+07
    6   0 -      -2.654516950786  -1.32e-07   1.57e-04    6    12   2.95e-02  2.46e-03
    6   1 +      -2.436977447171  -3.72e-08   7.42e-05    6    12   2.95e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.01e-04,1.95e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.95e-03 t_reduction=1.89e-04 tot=2.34e-03 ---
 sigma counter=141 i=0 t=2.36e-04 per=1.21e+01 cost=7.01e+03 flops=2.97e+07
 sigma counter=141 i=1 t=2.48e-04 per=1.27e+01 cost=6.99e+03 flops=2.82e+07
 sigma counter=141 i=2 t=2.30e-04 per=1.18e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=141 i=3 t=2.38e-04 per=1.22e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=141 i=4 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=141 i=5 t=2.59e-04 per=1.33e+01 cost=1.89e+04 flops=7.30e+07
 sigma counter=141 i=6 t=2.44e-04 per=1.25e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=141 i=7 t=2.41e-04 per=1.24e+01 cost=6.81e+03 flops=2.83e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=2.83e-02 t_gemm=2.75e-01 t_reduction=2.73e-02 tot=3.31e-01 ---
 sigma_tot counter=141 i=0 t=3.37e-02 per=1.23e+01 cost=8.16e+05 flops=2.42e+07
 sigma_tot counter=141 i=1 t=3.47e-02 per=1.26e+01 cost=8.27e+05 flops=2.39e+07
 sigma_tot counter=141 i=2 t=3.35e-02 per=1.22e+01 cost=8.22e+05 flops=2.46e+07
 sigma_tot counter=141 i=3 t=3.38e-02 per=1.23e+01 cost=8.28e+05 flops=2.45e+07
 sigma_tot counter=141 i=4 t=3.39e-02 per=1.23e+01 cost=1.40e+06 flops=4.12e+07
 sigma_tot counter=141 i=5 t=3.44e-02 per=1.25e+01 cost=1.40e+06 flops=4.05e+07
 sigma_tot counter=141 i=6 t=3.67e-02 per=1.33e+01 cost=1.59e+06 flops=4.33e+07
 sigma_tot counter=141 i=7 t=3.43e-02 per=1.25e+01 cost=1.58e+06 flops=4.60e+07
 total GEMM cost=9.25e+06 flops=3.37e+07
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   3.20e-02  2.46e-03
    7   1 +      -2.436977447171  -3.11e-15   7.42e-05    5    13   3.20e-02  2.46e-03
TIMING for Davidson : 3.20e-02  T(cal/comm/rest)=3.17e-02,7.25e-07,3.28e-04
optimized energies: isweep=3 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=3 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.972e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000532 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.63e-05,0.000219,0.000256 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8e-06,0.00108,0.000192 cost=2.78e+04 flops[gemm]=2.58e+07
--- TIMING FOR renorm : t_inter=8e-06 t_gemm=0.00108 t_reduction=0.000191 tot=0.00128 ---
 renorm counter=13 i=0 t=0.00022 per=20.4 cost=2.19e+03 flops=9.97e+06
 renorm counter=13 i=1 t=0.000207 per=19.2 cost=2.85e+03 flops=1.38e+07
 renorm counter=13 i=2 t=1e-06 per=0.0928 cost=0 flops=0
 renorm counter=13 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=13 i=4 t=0.000202 per=18.7 cost=2.11e+03 flops=1.04e+07
 renorm counter=13 i=5 t=0.000208 per=19.3 cost=2.94e+03 flops=1.41e+07
 renorm counter=13 i=6 t=0.00024 per=22.3 cost=1.77e+04 flops=7.37e+07
 total GEMM cost=2.78e+04 flops=2.58e+07
--- TIMING FOR renorm_tot : t_inter=0.00119 t_gemm=0.0141 t_reduction=0.00248 tot=0.0178 ---
 renorm_tot counter=13 i=0 t=0.00277 per=19.6 cost=4.45e+04 flops=1.61e+07
 renorm_tot counter=13 i=1 t=0.00279 per=19.7 cost=6.49e+04 flops=2.33e+07
 renorm_tot counter=13 i=2 t=0.00124 per=8.8 cost=4.29e+04 flops=3.45e+07
 renorm_tot counter=13 i=3 t=0.00128 per=9.05 cost=7.5e+04 flops=5.87e+07
 renorm_tot counter=13 i=4 t=0.00146 per=10.3 cost=4.5e+04 flops=3.08e+07
 renorm_tot counter=13 i=5 t=0.00148 per=10.5 cost=7.72e+04 flops=5.21e+07
 renorm_tot counter=13 i=6 t=0.00311 per=22 cost=5.26e+05 flops=1.7e+08
 total GEMM cost=8.76e+05 flops=6.2e+07
check ||H-H.dagger||=0.00e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=8.9e-05,0.0025,8.6e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(1,0) size=1.03e-05GB T[save](info/data/tot)=6.44e-05,4.85e-05,0.000113 speed=0.0916GB/s disk[used]=9.48e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
##### time_local: 3.96e-02 S #####
 T(fetch) = 7.03e-05 S  per = 0.18  per(accum) = 0.18
 T(hdiag) = 7.03e-05 S  per = 0.18  per(accum) = 0.35
 T(dvdsn) = 3.61e-02 S  per =   91  per(accum) = 91
 T(decim) = 7.75e-05 S  per =  0.2  per(accum) = 92
 T(guess) = 8.06e-05 S  per =  0.2  per(accum) = 92
 T(renrm) = 2.64e-03 S  per =  6.7  per(accum) = 99
 T(save ) = 5.67e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.59e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 3.95e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 2.31e-04 S  per = 0.64  per(accum) = 0.75
 T(hintermediate init           ) = 2.13e-05 S  per = 0.059  per(accum) = 0.81
 T(hintermediates memcpy cpu2gpu) = 3.62e-06 S  per = 0.01  per(accum) = 0.82
 T(preprocess_hformulae_Hxlist2 ) = 2.24e-03 S  per =  6.2  per(accum) = 7.1
 T(hmmtasks init                ) = 1.40e-03 S  per =  3.9  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 3.17e-02 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 7.25e-07 S  per = 0.002  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.28e-04 S  per = 0.91  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.60e-03 S
 T(qops init                    ) = 8.90e-05 S  per =  3.4  per(accum) = 3.4
 T(qops_dict memcpy cpu2gpu     ) = 2.74e-05 S  per =  1.1  per(accum) = 4.5
 T(symbolic_formulae_renorm     ) = 2.02e-04 S  per =  7.8  per(accum) = 12
 T(rintermediate init           ) = 9.51e-06 S  per = 0.37  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.72e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.40e-04 S  per =   21  per(accum) = 34
 T(rmmtasks init                ) = 3.31e-04 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 8.68e-06 S  per = 0.33  per(accum) = 47
 T(preprocess_renorm_batchGPU   ) = 1.35e-03 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.80e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.55e-06 S  per = 0.33  per(accum) = 1e+02
##### time_sweep: 3.96e-02 S #####
 T(fetch) = 7.03e-05 S  per = 0.18  per(accum) = 0.18
 T(hdiag) = 7.03e-05 S  per = 0.18  per(accum) = 0.35
 T(dvdsn) = 3.61e-02 S  per =   91  per(accum) = 91
 T(decim) = 7.75e-05 S  per =  0.2  per(accum) = 92
 T(guess) = 8.06e-05 S  per =  0.2  per(accum) = 92
 T(renrm) = 2.64e-03 S  per =  6.7  per(accum) = 99
 T(save ) = 5.67e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.59e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 3.95e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 2.31e-04 S  per = 0.64  per(accum) = 0.75
 T(hintermediate init           ) = 2.13e-05 S  per = 0.059  per(accum) = 0.81
 T(hintermediates memcpy cpu2gpu) = 3.62e-06 S  per = 0.01  per(accum) = 0.82
 T(preprocess_hformulae_Hxlist2 ) = 2.24e-03 S  per =  6.2  per(accum) = 7.1
 T(hmmtasks init                ) = 1.40e-03 S  per =  3.9  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 3.17e-02 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 7.25e-07 S  per = 0.002  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.28e-04 S  per = 0.91  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.60e-03 S
 T(qops init                    ) = 8.90e-05 S  per =  3.4  per(accum) = 3.4
 T(qops_dict memcpy cpu2gpu     ) = 2.74e-05 S  per =  1.1  per(accum) = 4.5
 T(symbolic_formulae_renorm     ) = 2.02e-04 S  per =  7.8  per(accum) = 12
 T(rintermediate init           ) = 9.51e-06 S  per = 0.37  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.72e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.40e-04 S  per =   21  per(accum) = 34
 T(rmmtasks init                ) = 3.31e-04 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 8.68e-06 S  per = 0.33  per(accum) = 47
 T(preprocess_renorm_batchGPU   ) = 1.35e-03 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.80e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.55e-06 S  per = 0.33  per(accum) = 1e+02
##### time_global: 4.59e-01 S #####
 T(fetch) = 3.07e-03 S  per = 0.67  per(accum) = 0.67
 T(hdiag) = 1.07e-03 S  per = 0.23  per(accum) = 0.9
 T(dvdsn) = 4.06e-01 S  per =   89  per(accum) = 89
 T(decim) = 3.26e-03 S  per = 0.71  per(accum) = 90
 T(guess) = 1.14e-03 S  per = 0.25  per(accum) = 90
 T(renrm) = 3.68e-02 S  per =    8  per(accum) = 98
 T(save ) = 7.52e-03 S  per =  1.6  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.04e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 5.50e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 3.43e-03 S  per = 0.85  per(accum) = 0.99
 T(hintermediate init           ) = 3.44e-04 S  per = 0.085  per(accum) = 1.1
 T(hintermediates memcpy cpu2gpu) = 5.54e-05 S  per = 0.014  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 2.98e-02 S  per =  7.4  per(accum) = 8.5
 T(hmmtasks init                ) = 1.86e-02 S  per =  4.6  per(accum) = 13
 T(dvdson solver [Hx_batchGPU]  ) = 3.47e-01 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 9.10e-06 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.04e-03 S  per =    1  per(accum) = 1e+02
Detailed decomposition of T(renrm): 3.61e-02 S
 T(qops init                    ) = 1.59e-03 S  per =  4.4  per(accum) = 4.4
 T(qops_dict memcpy cpu2gpu     ) = 4.59e-04 S  per =  1.3  per(accum) = 5.7
 T(symbolic_formulae_renorm     ) = 2.78e-03 S  per =  7.7  per(accum) = 13
 T(rintermediate init           ) = 2.28e-04 S  per = 0.63  per(accum) = 14
 T(rintermediates memcpy cpu2gpu) = 6.93e-05 S  per = 0.19  per(accum) = 14
 T(preprocess_formulae_Rlist2   ) = 7.03e-03 S  per =   19  per(accum) = 34
 T(rmmtasks init                ) = 4.46e-03 S  per =   12  per(accum) = 46
 T(qops memset                  ) = 1.16e-04 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 1.89e-02 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 3.82e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.20e-04 S  per = 0.33  per(accum) = 1e+02

isweep=3 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.261e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x448c82e0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.178e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.843e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00224 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.06e-05,0.000961,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.5e-05,0.000203,0.00199,0.000189 cost=7.9e+04 flops[gemm]=3.97e+07
--- TIMING FOR sigma : t_inter=0.000203 t_gemm=0.00199 t_reduction=0.000189 tot=0.00238 ---
 sigma counter=142 i=0 t=0.000245 per=12.3 cost=6.81e+03 flops=2.78e+07
 sigma counter=142 i=1 t=0.000237 per=11.9 cost=6.78e+03 flops=2.86e+07
 sigma counter=142 i=2 t=0.000249 per=12.5 cost=7.01e+03 flops=2.81e+07
 sigma counter=142 i=3 t=0.000254 per=12.8 cost=6.99e+03 flops=2.75e+07
 sigma counter=142 i=4 t=0.000241 per=12.1 cost=6.81e+03 flops=2.83e+07
 sigma counter=142 i=5 t=0.00025 per=12.6 cost=6.78e+03 flops=2.71e+07
 sigma counter=142 i=6 t=0.000267 per=13.4 cost=1.89e+04 flops=7.08e+07
 sigma counter=142 i=7 t=0.000244 per=12.3 cost=1.89e+04 flops=7.74e+07
 total GEMM cost=7.9e+04 flops=3.97e+07
--- TIMING FOR sigma_tot : t_inter=0.0285 t_gemm=0.277 t_reduction=0.0275 tot=0.333 ---
 sigma_tot counter=142 i=0 t=0.034 per=12.3 cost=8.22e+05 flops=2.42e+07
 sigma_tot counter=142 i=1 t=0.0349 per=12.6 cost=8.34e+05 flops=2.39e+07
 sigma_tot counter=142 i=2 t=0.0337 per=12.2 cost=8.29e+05 flops=2.46e+07
 sigma_tot counter=142 i=3 t=0.034 per=12.3 cost=8.35e+05 flops=2.46e+07
 sigma_tot counter=142 i=4 t=0.0342 per=12.3 cost=1.41e+06 flops=4.11e+07
 sigma_tot counter=142 i=5 t=0.0347 per=12.5 cost=1.4e+06 flops=4.04e+07
 sigma_tot counter=142 i=6 t=0.0369 per=13.3 cost=1.61e+06 flops=4.35e+07
 sigma_tot counter=142 i=7 t=0.0346 per=12.5 cost=1.6e+06 flops=4.62e+07
 total GEMM cost=9.33e+06 flops=3.37e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.7e-05,0.000199,0.00197,0.00019 cost=7.9e+04 flops[gemm]=4.01e+07
--- TIMING FOR sigma : t_inter=0.000198 t_gemm=0.00197 t_reduction=0.00019 tot=0.00236 ---
 sigma counter=143 i=0 t=0.000234 per=11.9 cost=6.81e+03 flops=2.91e+07
 sigma counter=143 i=1 t=0.000238 per=12.1 cost=6.78e+03 flops=2.85e+07
 sigma counter=143 i=2 t=0.000234 per=11.9 cost=7.01e+03 flops=2.99e+07
 sigma counter=143 i=3 t=0.000243 per=12.3 cost=6.99e+03 flops=2.88e+07
 sigma counter=143 i=4 t=0.000233 per=11.8 cost=6.81e+03 flops=2.92e+07
 sigma counter=143 i=5 t=0.000246 per=12.5 cost=6.78e+03 flops=2.76e+07
 sigma counter=143 i=6 t=0.00027 per=13.7 cost=1.89e+04 flops=7e+07
 sigma counter=143 i=7 t=0.00027 per=13.7 cost=1.89e+04 flops=7e+07
 total GEMM cost=7.9e+04 flops=4.01e+07
--- TIMING FOR sigma_tot : t_inter=0.0287 t_gemm=0.279 t_reduction=0.0277 tot=0.335 ---
 sigma_tot counter=143 i=0 t=0.0342 per=12.3 cost=8.29e+05 flops=2.42e+07
 sigma_tot counter=143 i=1 t=0.0351 per=12.6 cost=8.41e+05 flops=2.39e+07
 sigma_tot counter=143 i=2 t=0.034 per=12.2 cost=8.37e+05 flops=2.46e+07
 sigma_tot counter=143 i=3 t=0.0343 per=12.3 cost=8.42e+05 flops=2.46e+07
 sigma_tot counter=143 i=4 t=0.0344 per=12.3 cost=1.41e+06 flops=4.1e+07
 sigma_tot counter=143 i=5 t=0.0349 per=12.5 cost=1.41e+06 flops=4.03e+07
 sigma_tot counter=143 i=6 t=0.0372 per=13.3 cost=1.62e+06 flops=4.37e+07
 sigma_tot counter=143 i=7 t=0.0348 per=12.5 cost=1.62e+06 flops=4.64e+07
 total GEMM cost=9.41e+06 flops=3.37e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   4.98e-03  2.49e-03
    1   1 +      -2.436977447171  -1.00e+03   7.42e-05    2     2   4.98e-03  2.49e-03
TIMING for Davidson : 5.00e-03  T(cal/comm/rest)=4.96e-03,1.25e-07,4.25e-05
optimized energies: isweep=3 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=3 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep3_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.605e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 1.848e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=3.26e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Rlist : 0.000546 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.57e-05,0.000227,0.000274 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000932 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07,0.0009
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000181,0.00107,0.000186 cost=1.55e+05 flops[gemm]=1.45e+08
--- TIMING FOR renorm : t_inter=0.000181 t_gemm=0.00107 t_reduction=0.000186 tot=0.00143 ---
 renorm counter=14 i=0 t=0.000205 per=19.2 cost=8.1e+03 flops=3.95e+07
 renorm counter=14 i=1 t=0.000206 per=19.3 cost=8.36e+03 flops=4.06e+07
 renorm counter=14 i=2 t=1e-06 per=0.0936 cost=0 flops=0
 renorm counter=14 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=14 i=4 t=0.000201 per=18.8 cost=1.65e+04 flops=8.2e+07
 renorm counter=14 i=5 t=0.000214 per=20 cost=2.89e+04 flops=1.35e+08
 renorm counter=14 i=6 t=0.000241 per=22.6 cost=9.32e+04 flops=3.87e+08
 total GEMM cost=1.55e+05 flops=1.45e+08
--- TIMING FOR renorm_tot : t_inter=0.00137 t_gemm=0.0152 t_reduction=0.00267 tot=0.0192 ---
 renorm_tot counter=14 i=0 t=0.00298 per=19.6 cost=5.26e+04 flops=1.77e+07
 renorm_tot counter=14 i=1 t=0.00299 per=19.7 cost=7.32e+04 flops=2.45e+07
 renorm_tot counter=14 i=2 t=0.00124 per=8.19 cost=4.29e+04 flops=3.45e+07
 renorm_tot counter=14 i=3 t=0.00128 per=8.41 cost=7.5e+04 flops=5.87e+07
 renorm_tot counter=14 i=4 t=0.00166 per=10.9 cost=6.15e+04 flops=3.7e+07
 renorm_tot counter=14 i=5 t=0.0017 per=11.2 cost=1.06e+05 flops=6.25e+07
 renorm_tot counter=14 i=6 t=0.00335 per=22 cost=6.19e+05 flops=1.85e+08
 total GEMM cost=1.03e+06 flops=6.78e+07
check ||H-H.dagger||=1.07e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0028 S T(init/kernel/comm)=7.8e-05,0.0027,8.6e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(2,0) size=1.94e-05GB T[save](info/data/tot)=6.68e-05,5.23e-05,0.000119 speed=0.163GB/s disk[used]=9.62e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
##### time_local: 1.32e-02 S #####
 T(fetch) = 2.98e-04 S  per =  2.3  per(accum) = 2.3
 T(hdiag) = 6.75e-05 S  per = 0.51  per(accum) = 2.8
 T(dvdsn) = 9.09e-03 S  per =   69  per(accum) = 72
 T(decim) = 3.03e-04 S  per =  2.3  per(accum) = 74
 T(guess) = 7.08e-05 S  per = 0.54  per(accum) = 74
 T(renrm) = 2.82e-03 S  per =   21  per(accum) = 96
 T(save ) = 5.67e-04 S  per =  4.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.93e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 3.91e-05 S  per = 0.44  per(accum) = 0.44
 T(symbolic_formulae_twodot     ) = 2.22e-04 S  per =  2.5  per(accum) = 2.9
 T(hintermediate init           ) = 2.13e-05 S  per = 0.24  per(accum) = 3.2
 T(hintermediates memcpy cpu2gpu) = 3.54e-06 S  per = 0.04  per(accum) = 3.2
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =   25  per(accum) = 28
 T(hmmtasks init                ) = 1.39e-03 S  per =   16  per(accum) = 44
 T(dvdson solver [Hx_batchGPU]  ) = 4.96e-03 S  per =   56  per(accum) = 1e+02
 T(dvdson solver [communication]) = 1.25e-07 S  per = 0.0014  per(accum) = 1e+02
 T(dvdson solver [rest part]    ) = 4.25e-05 S  per = 0.48  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.77e-03 S
 T(qops init                    ) = 7.79e-05 S  per =  2.8  per(accum) = 2.8
 T(qops_dict memcpy cpu2gpu     ) = 3.39e-05 S  per =  1.2  per(accum) = 4
 T(symbolic_formulae_renorm     ) = 1.65e-04 S  per =    6  per(accum) = 10
 T(rintermediate init           ) = 2.14e-05 S  per = 0.77  per(accum) = 11
 T(rintermediates memcpy cpu2gpu) = 4.47e-06 S  per = 0.16  per(accum) = 11
 T(preprocess_formulae_Rlist2   ) = 5.54e-04 S  per =   20  per(accum) = 31
 T(rmmtasks init                ) = 3.62e-04 S  per =   13  per(accum) = 44
 T(qops memset                  ) = 8.02e-06 S  per = 0.29  per(accum) = 44
 T(preprocess_renorm_batchGPU   ) = 1.51e-03 S  per =   54  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.73e-05 S  per = 0.99  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.60e-06 S  per = 0.31  per(accum) = 1e+02
##### time_sweep: 5.28e-02 S #####
 T(fetch) = 3.69e-04 S  per =  0.7  per(accum) = 0.7
 T(hdiag) = 1.38e-04 S  per = 0.26  per(accum) = 0.96
 T(dvdsn) = 4.52e-02 S  per =   86  per(accum) = 87
 T(decim) = 3.80e-04 S  per = 0.72  per(accum) = 87
 T(guess) = 1.51e-04 S  per = 0.29  per(accum) = 88
 T(renrm) = 5.46e-03 S  per =   10  per(accum) = 98
 T(save ) = 1.13e-03 S  per =  2.1  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.49e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 7.85e-05 S  per = 0.18  per(accum) = 0.18
 T(symbolic_formulae_twodot     ) = 4.54e-04 S  per =    1  per(accum) = 1.2
 T(hintermediate init           ) = 4.26e-05 S  per = 0.095  per(accum) = 1.3
 T(hintermediates memcpy cpu2gpu) = 7.16e-06 S  per = 0.016  per(accum) = 1.3
 T(preprocess_hformulae_Hxlist2 ) = 4.49e-03 S  per =   10  per(accum) = 11
 T(hmmtasks init                ) = 2.79e-03 S  per =  6.2  per(accum) = 18
 T(dvdson solver [Hx_batchGPU]  ) = 3.66e-02 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 8.50e-07 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.70e-04 S  per = 0.82  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.37e-03 S
 T(qops init                    ) = 1.67e-04 S  per =  3.1  per(accum) = 3.1
 T(qops_dict memcpy cpu2gpu     ) = 6.13e-05 S  per =  1.1  per(accum) = 4.3
 T(symbolic_formulae_renorm     ) = 3.67e-04 S  per =  6.8  per(accum) = 11
 T(rintermediate init           ) = 3.09e-05 S  per = 0.58  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 9.18e-06 S  per = 0.17  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 1.09e-03 S  per =   20  per(accum) = 32
 T(rmmtasks init                ) = 6.93e-04 S  per =   13  per(accum) = 45
 T(qops memset                  ) = 1.67e-05 S  per = 0.31  per(accum) = 45
 T(preprocess_renorm_batchGPU   ) = 2.86e-03 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.53e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.72e-05 S  per = 0.32  per(accum) = 1e+02
##### time_global: 4.72e-01 S #####
 T(fetch) = 3.37e-03 S  per = 0.71  per(accum) = 0.71
 T(hdiag) = 1.13e-03 S  per = 0.24  per(accum) = 0.95
 T(dvdsn) = 4.16e-01 S  per =   88  per(accum) = 89
 T(decim) = 3.56e-03 S  per = 0.75  per(accum) = 90
 T(guess) = 1.21e-03 S  per = 0.26  per(accum) = 90
 T(renrm) = 3.96e-02 S  per =  8.4  per(accum) = 98
 T(save ) = 8.08e-03 S  per =  1.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.13e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 5.89e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 3.65e-03 S  per = 0.89  per(accum) = 1
 T(hintermediate init           ) = 3.65e-04 S  per = 0.088  per(accum) = 1.1
 T(hintermediates memcpy cpu2gpu) = 5.89e-05 S  per = 0.014  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 3.21e-02 S  per =  7.8  per(accum) = 8.9
 T(hmmtasks init                ) = 2.00e-02 S  per =  4.8  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 3.52e-01 S  per =   85  per(accum) = 99
 T(dvdson solver [communication]) = 9.22e-06 S  per = 0.0022  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.08e-03 S  per = 0.99  per(accum) = 1e+02
Detailed decomposition of T(renrm): 3.89e-02 S
 T(qops init                    ) = 1.67e-03 S  per =  4.3  per(accum) = 4.3
 T(qops_dict memcpy cpu2gpu     ) = 4.93e-04 S  per =  1.3  per(accum) = 5.6
 T(symbolic_formulae_renorm     ) = 2.95e-03 S  per =  7.6  per(accum) = 13
 T(rintermediate init           ) = 2.49e-04 S  per = 0.64  per(accum) = 14
 T(rintermediates memcpy cpu2gpu) = 7.37e-05 S  per = 0.19  per(accum) = 14
 T(preprocess_formulae_Rlist2   ) = 7.59e-03 S  per =   20  per(accum) = 33
 T(rmmtasks init                ) = 4.83e-03 S  per =   12  per(accum) = 46
 T(qops memset                  ) = 1.25e-04 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 2.04e-02 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 4.09e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.29e-04 S  per = 0.33  per(accum) = 1e+02

isweep=3 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.095e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=357:0.00272MB:2.66e-06GB
===== CPUmem(GB): tot=3.56e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x448c82e0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.241e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.835e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00224 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.22e-05,0.000961,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=5.05e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.5e-05,0.000206,0.00195,0.000195 cost=7.9e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0.000206 t_gemm=0.00195 t_reduction=0.000195 tot=0.00235 ---
 sigma counter=144 i=0 t=0.000238 per=12.2 cost=6.81e+03 flops=2.86e+07
 sigma counter=144 i=1 t=0.000241 per=12.4 cost=6.78e+03 flops=2.81e+07
 sigma counter=144 i=2 t=0.000235 per=12.1 cost=7.01e+03 flops=2.98e+07
 sigma counter=144 i=3 t=0.000244 per=12.5 cost=6.99e+03 flops=2.86e+07
 sigma counter=144 i=4 t=0.000233 per=12 cost=6.81e+03 flops=2.92e+07
 sigma counter=144 i=5 t=0.000239 per=12.3 cost=6.78e+03 flops=2.84e+07
 sigma counter=144 i=6 t=0.000267 per=13.7 cost=1.89e+04 flops=7.08e+07
 sigma counter=144 i=7 t=0.000251 per=12.9 cost=1.89e+04 flops=7.53e+07
 total GEMM cost=7.9e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0.0289 t_gemm=0.281 t_reduction=0.0278 tot=0.338 ---
 sigma_tot counter=144 i=0 t=0.0345 per=12.3 cost=8.36e+05 flops=2.43e+07
 sigma_tot counter=144 i=1 t=0.0354 per=12.6 cost=8.47e+05 flops=2.4e+07
 sigma_tot counter=144 i=2 t=0.0342 per=12.2 cost=8.44e+05 flops=2.47e+07
 sigma_tot counter=144 i=3 t=0.0345 per=12.3 cost=8.49e+05 flops=2.46e+07
 sigma_tot counter=144 i=4 t=0.0346 per=12.3 cost=1.42e+06 flops=4.1e+07
 sigma_tot counter=144 i=5 t=0.0352 per=12.5 cost=1.42e+06 flops=4.03e+07
 sigma_tot counter=144 i=6 t=0.0375 per=13.3 cost=1.64e+06 flops=4.39e+07
 sigma_tot counter=144 i=7 t=0.0351 per=12.5 cost=1.64e+06 flops=4.66e+07
 total GEMM cost=9.49e+06 flops=3.38e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.6e-05,0.000198,0.00195,0.000188 cost=7.9e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0.000198 t_gemm=0.00195 t_reduction=0.000188 tot=0.00233 ---
 sigma counter=145 i=0 t=0.000234 per=12 cost=6.81e+03 flops=2.91e+07
 sigma counter=145 i=1 t=0.000251 per=12.9 cost=6.78e+03 flops=2.7e+07
 sigma counter=145 i=2 t=0.000235 per=12.1 cost=7.01e+03 flops=2.98e+07
 sigma counter=145 i=3 t=0.000236 per=12.1 cost=6.99e+03 flops=2.96e+07
 sigma counter=145 i=4 t=0.000233 per=12 cost=6.81e+03 flops=2.92e+07
 sigma counter=145 i=5 t=0.000243 per=12.5 cost=6.78e+03 flops=2.79e+07
 sigma counter=145 i=6 t=0.00026 per=13.4 cost=1.89e+04 flops=7.27e+07
 sigma counter=145 i=7 t=0.000255 per=13.1 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.9e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0.0291 t_gemm=0.283 t_reduction=0.028 tot=0.34 ---
 sigma_tot counter=145 i=0 t=0.0347 per=12.3 cost=8.43e+05 flops=2.43e+07
 sigma_tot counter=145 i=1 t=0.0356 per=12.6 cost=8.54e+05 flops=2.4e+07
 sigma_tot counter=145 i=2 t=0.0344 per=12.2 cost=8.51e+05 flops=2.47e+07
 sigma_tot counter=145 i=3 t=0.0347 per=12.3 cost=8.56e+05 flops=2.46e+07
 sigma_tot counter=145 i=4 t=0.0349 per=12.3 cost=1.43e+06 flops=4.09e+07
 sigma_tot counter=145 i=5 t=0.0354 per=12.5 cost=1.42e+06 flops=4.02e+07
 sigma_tot counter=145 i=6 t=0.0377 per=13.3 cost=1.66e+06 flops=4.41e+07
 sigma_tot counter=145 i=7 t=0.0353 per=12.5 cost=1.65e+06 flops=4.68e+07
 total GEMM cost=9.57e+06 flops=3.38e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592  -1.00e+03   7.01e-02    2     2   4.93e-03  2.46e-03
    1   1 -      -2.436094100141  -1.00e+03   4.92e-02    2     2   4.93e-03  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.98e-04,1.93e-03,1.93e-04 cost=7.90e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.93e-03 t_reduction=1.92e-04 tot=2.32e-03 ---
 sigma counter=146 i=0 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=146 i=1 t=2.39e-04 per=1.24e+01 cost=6.78e+03 flops=2.84e+07
 sigma counter=146 i=2 t=2.35e-04 per=1.22e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=146 i=3 t=2.37e-04 per=1.23e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=146 i=4 t=2.36e-04 per=1.22e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=146 i=5 t=2.41e-04 per=1.25e+01 cost=6.78e+03 flops=2.81e+07
 sigma counter=146 i=6 t=2.63e-04 per=1.36e+01 cost=1.89e+04 flops=7.18e+07
 sigma counter=146 i=7 t=2.50e-04 per=1.29e+01 cost=1.89e+04 flops=7.56e+07
 total GEMM cost=7.90e+04 flops=4.09e+07
--- TIMING FOR sigma_tot : t_inter=2.93e-02 t_gemm=2.85e-01 t_reduction=2.82e-02 tot=3.42e-01 ---
 sigma_tot counter=146 i=0 t=3.49e-02 per=1.23e+01 cost=8.50e+05 flops=2.43e+07
 sigma_tot counter=146 i=1 t=3.59e-02 per=1.26e+01 cost=8.61e+05 flops=2.40e+07
 sigma_tot counter=146 i=2 t=3.47e-02 per=1.22e+01 cost=8.58e+05 flops=2.47e+07
 sigma_tot counter=146 i=3 t=3.50e-02 per=1.23e+01 cost=8.63e+05 flops=2.47e+07
 sigma_tot counter=146 i=4 t=3.51e-02 per=1.23e+01 cost=1.43e+06 flops=4.08e+07
 sigma_tot counter=146 i=5 t=3.57e-02 per=1.25e+01 cost=1.43e+06 flops=4.01e+07
 sigma_tot counter=146 i=6 t=3.80e-02 per=1.33e+01 cost=1.68e+06 flops=4.43e+07
 sigma_tot counter=146 i=7 t=3.56e-02 per=1.25e+01 cost=1.67e+06 flops=4.70e+07
 total GEMM cost=9.65e+06 flops=3.39e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.96e-04,1.94e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.32e-03 ---
 sigma counter=147 i=0 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=147 i=1 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=147 i=2 t=2.33e-04 per=1.20e+01 cost=7.01e+03 flops=3.01e+07
 sigma counter=147 i=3 t=2.37e-04 per=1.22e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=147 i=4 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=147 i=5 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=147 i=6 t=2.64e-04 per=1.36e+01 cost=1.89e+04 flops=7.16e+07
 sigma counter=147 i=7 t=2.56e-04 per=1.32e+01 cost=1.89e+04 flops=7.38e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=2.95e-02 t_gemm=2.87e-01 t_reduction=2.84e-02 tot=3.45e-01 ---
 sigma_tot counter=147 i=0 t=3.52e-02 per=1.23e+01 cost=8.57e+05 flops=2.44e+07
 sigma_tot counter=147 i=1 t=3.61e-02 per=1.26e+01 cost=8.68e+05 flops=2.40e+07
 sigma_tot counter=147 i=2 t=3.49e-02 per=1.22e+01 cost=8.65e+05 flops=2.48e+07
 sigma_tot counter=147 i=3 t=3.52e-02 per=1.23e+01 cost=8.70e+05 flops=2.47e+07
 sigma_tot counter=147 i=4 t=3.53e-02 per=1.23e+01 cost=1.44e+06 flops=4.07e+07
 sigma_tot counter=147 i=5 t=3.59e-02 per=1.25e+01 cost=1.44e+06 flops=4.00e+07
 sigma_tot counter=147 i=6 t=3.83e-02 per=1.33e+01 cost=1.70e+06 flops=4.45e+07
 sigma_tot counter=147 i=7 t=3.59e-02 per=1.25e+01 cost=1.69e+06 flops=4.72e+07
 total GEMM cost=9.73e+06 flops=3.39e+07
    2   0 -      -2.654426863105  -1.84e-03   1.26e-02    4     4   9.83e-03  2.46e-03
    2   1 -      -2.436959129202  -8.65e-04   5.19e-03    4     4   9.83e-03  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.97e-04,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=1.97e-04 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.32e-03 ---
 sigma counter=148 i=0 t=2.39e-04 per=1.23e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=148 i=1 t=2.46e-04 per=1.27e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=148 i=2 t=2.32e-04 per=1.20e+01 cost=7.01e+03 flops=3.02e+07
 sigma counter=148 i=3 t=2.45e-04 per=1.26e+01 cost=6.99e+03 flops=2.85e+07
 sigma counter=148 i=4 t=2.34e-04 per=1.21e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=148 i=5 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=148 i=6 t=2.61e-04 per=1.35e+01 cost=1.89e+04 flops=7.24e+07
 sigma counter=148 i=7 t=2.45e-04 per=1.26e+01 cost=1.89e+04 flops=7.71e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=2.97e-02 t_gemm=2.89e-01 t_reduction=2.86e-02 tot=3.47e-01 ---
 sigma_tot counter=148 i=0 t=3.54e-02 per=1.23e+01 cost=8.63e+05 flops=2.44e+07
 sigma_tot counter=148 i=1 t=3.64e-02 per=1.26e+01 cost=8.75e+05 flops=2.41e+07
 sigma_tot counter=148 i=2 t=3.51e-02 per=1.22e+01 cost=8.72e+05 flops=2.48e+07
 sigma_tot counter=148 i=3 t=3.55e-02 per=1.23e+01 cost=8.77e+05 flops=2.47e+07
 sigma_tot counter=148 i=4 t=3.56e-02 per=1.23e+01 cost=1.45e+06 flops=4.07e+07
 sigma_tot counter=148 i=5 t=3.61e-02 per=1.25e+01 cost=1.44e+06 flops=3.99e+07
 sigma_tot counter=148 i=6 t=3.85e-02 per=1.33e+01 cost=1.72e+06 flops=4.46e+07
 sigma_tot counter=148 i=7 t=3.61e-02 per=1.25e+01 cost=1.71e+06 flops=4.74e+07
 total GEMM cost=9.81e+06 flops=3.40e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.97e-04,1.96e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=1.97e-04 t_gemm=1.95e-03 t_reduction=1.87e-04 tot=2.34e-03 ---
 sigma counter=149 i=0 t=2.35e-04 per=1.20e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=149 i=1 t=2.46e-04 per=1.26e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=149 i=2 t=2.37e-04 per=1.21e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=149 i=3 t=2.44e-04 per=1.25e+01 cost=6.99e+03 flops=2.86e+07
 sigma counter=149 i=4 t=2.32e-04 per=1.19e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=149 i=5 t=2.36e-04 per=1.21e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=149 i=6 t=2.70e-04 per=1.38e+01 cost=1.89e+04 flops=7.00e+07
 sigma counter=149 i=7 t=2.54e-04 per=1.30e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=2.99e-02 t_gemm=2.91e-01 t_reduction=2.88e-02 tot=3.49e-01 ---
 sigma_tot counter=149 i=0 t=3.56e-02 per=1.23e+01 cost=8.70e+05 flops=2.44e+07
 sigma_tot counter=149 i=1 t=3.66e-02 per=1.26e+01 cost=8.81e+05 flops=2.41e+07
 sigma_tot counter=149 i=2 t=3.54e-02 per=1.22e+01 cost=8.79e+05 flops=2.48e+07
 sigma_tot counter=149 i=3 t=3.57e-02 per=1.23e+01 cost=8.84e+05 flops=2.48e+07
 sigma_tot counter=149 i=4 t=3.58e-02 per=1.23e+01 cost=1.45e+06 flops=4.06e+07
 sigma_tot counter=149 i=5 t=3.64e-02 per=1.25e+01 cost=1.45e+06 flops=3.99e+07
 sigma_tot counter=149 i=6 t=3.88e-02 per=1.33e+01 cost=1.74e+06 flops=4.48e+07
 sigma_tot counter=149 i=7 t=3.64e-02 per=1.25e+01 cost=1.73e+06 flops=4.76e+07
 total GEMM cost=9.89e+06 flops=3.40e+07
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   1.48e-02  2.46e-03
    3   1 -      -2.436975259478  -1.61e-05   1.59e-03    6     6   1.48e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.98e-04,1.94e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.94e-03 t_reduction=1.89e-04 tot=2.33e-03 ---
 sigma counter=150 i=0 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=150 i=1 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=150 i=2 t=2.42e-04 per=1.25e+01 cost=7.01e+03 flops=2.90e+07
 sigma counter=150 i=3 t=2.37e-04 per=1.22e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=150 i=4 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=150 i=5 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=150 i=6 t=2.66e-04 per=1.37e+01 cost=1.89e+04 flops=7.10e+07
 sigma counter=150 i=7 t=2.45e-04 per=1.26e+01 cost=1.89e+04 flops=7.71e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=3.01e-02 t_gemm=2.93e-01 t_reduction=2.90e-02 tot=3.52e-01 ---
 sigma_tot counter=150 i=0 t=3.59e-02 per=1.23e+01 cost=8.77e+05 flops=2.45e+07
 sigma_tot counter=150 i=1 t=3.68e-02 per=1.26e+01 cost=8.88e+05 flops=2.41e+07
 sigma_tot counter=150 i=2 t=3.56e-02 per=1.22e+01 cost=8.86e+05 flops=2.49e+07
 sigma_tot counter=150 i=3 t=3.59e-02 per=1.23e+01 cost=8.91e+05 flops=2.48e+07
 sigma_tot counter=150 i=4 t=3.60e-02 per=1.23e+01 cost=1.46e+06 flops=4.05e+07
 sigma_tot counter=150 i=5 t=3.66e-02 per=1.25e+01 cost=1.46e+06 flops=3.98e+07
 sigma_tot counter=150 i=6 t=3.90e-02 per=1.33e+01 cost=1.76e+06 flops=4.50e+07
 sigma_tot counter=150 i=7 t=3.66e-02 per=1.25e+01 cost=1.75e+06 flops=4.78e+07
 total GEMM cost=9.96e+06 flops=3.41e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.98e-04,1.93e-03,1.86e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.93e-03 t_reduction=1.86e-04 tot=2.31e-03 ---
 sigma counter=151 i=0 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=151 i=1 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=151 i=2 t=2.31e-04 per=1.20e+01 cost=7.01e+03 flops=3.03e+07
 sigma counter=151 i=3 t=2.41e-04 per=1.25e+01 cost=6.99e+03 flops=2.90e+07
 sigma counter=151 i=4 t=2.38e-04 per=1.23e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=151 i=5 t=2.36e-04 per=1.22e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=151 i=6 t=2.61e-04 per=1.35e+01 cost=1.89e+04 flops=7.24e+07
 sigma counter=151 i=7 t=2.48e-04 per=1.28e+01 cost=1.89e+04 flops=7.62e+07
 total GEMM cost=7.90e+04 flops=4.09e+07
--- TIMING FOR sigma_tot : t_inter=3.03e-02 t_gemm=2.94e-01 t_reduction=2.92e-02 tot=3.54e-01 ---
 sigma_tot counter=151 i=0 t=3.61e-02 per=1.23e+01 cost=8.84e+05 flops=2.45e+07
 sigma_tot counter=151 i=1 t=3.71e-02 per=1.26e+01 cost=8.95e+05 flops=2.41e+07
 sigma_tot counter=151 i=2 t=3.58e-02 per=1.22e+01 cost=8.93e+05 flops=2.49e+07
 sigma_tot counter=151 i=3 t=3.62e-02 per=1.23e+01 cost=8.98e+05 flops=2.48e+07
 sigma_tot counter=151 i=4 t=3.63e-02 per=1.23e+01 cost=1.47e+06 flops=4.04e+07
 sigma_tot counter=151 i=5 t=3.68e-02 per=1.25e+01 cost=1.46e+06 flops=3.97e+07
 sigma_tot counter=151 i=6 t=3.93e-02 per=1.33e+01 cost=1.78e+06 flops=4.52e+07
 sigma_tot counter=151 i=7 t=3.68e-02 per=1.25e+01 cost=1.77e+06 flops=4.80e+07
 total GEMM cost=1.00e+07 flops=3.41e+07
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   1.97e-02  2.46e-03
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   1.97e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.08e-04,1.97e-03,1.97e-04 cost=7.90e+04 flops[gemm]=4.02e+07
--- TIMING FOR sigma : t_inter=2.08e-04 t_gemm=1.97e-03 t_reduction=1.97e-04 tot=2.37e-03 ---
 sigma counter=152 i=0 t=2.36e-04 per=1.20e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=152 i=1 t=2.46e-04 per=1.25e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=152 i=2 t=2.32e-04 per=1.18e+01 cost=7.01e+03 flops=3.02e+07
 sigma counter=152 i=3 t=2.38e-04 per=1.21e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=152 i=4 t=2.35e-04 per=1.20e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=152 i=5 t=2.43e-04 per=1.24e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=152 i=6 t=2.80e-04 per=1.42e+01 cost=1.89e+04 flops=6.75e+07
 sigma counter=152 i=7 t=2.55e-04 per=1.30e+01 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.90e+04 flops=4.02e+07
--- TIMING FOR sigma_tot : t_inter=3.05e-02 t_gemm=2.96e-01 t_reduction=2.94e-02 tot=3.56e-01 ---
 sigma_tot counter=152 i=0 t=3.63e-02 per=1.23e+01 cost=8.91e+05 flops=2.45e+07
 sigma_tot counter=152 i=1 t=3.73e-02 per=1.26e+01 cost=9.02e+05 flops=2.42e+07
 sigma_tot counter=152 i=2 t=3.61e-02 per=1.22e+01 cost=9.00e+05 flops=2.49e+07
 sigma_tot counter=152 i=3 t=3.64e-02 per=1.23e+01 cost=9.05e+05 flops=2.49e+07
 sigma_tot counter=152 i=4 t=3.65e-02 per=1.23e+01 cost=1.47e+06 flops=4.04e+07
 sigma_tot counter=152 i=5 t=3.71e-02 per=1.25e+01 cost=1.47e+06 flops=3.96e+07
 sigma_tot counter=152 i=6 t=3.96e-02 per=1.34e+01 cost=1.79e+06 flops=4.53e+07
 sigma_tot counter=152 i=7 t=3.71e-02 per=1.25e+01 cost=1.79e+06 flops=4.82e+07
 total GEMM cost=1.01e+07 flops=3.41e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,2.01e-04,1.94e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.94e-03 t_reduction=1.89e-04 tot=2.33e-03 ---
 sigma counter=153 i=0 t=2.36e-04 per=1.21e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=153 i=1 t=2.46e-04 per=1.27e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=153 i=2 t=2.33e-04 per=1.20e+01 cost=7.01e+03 flops=3.01e+07
 sigma counter=153 i=3 t=2.40e-04 per=1.24e+01 cost=6.99e+03 flops=2.91e+07
 sigma counter=153 i=4 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=153 i=5 t=2.35e-04 per=1.21e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=153 i=6 t=2.68e-04 per=1.38e+01 cost=1.89e+04 flops=7.05e+07
 sigma counter=153 i=7 t=2.54e-04 per=1.31e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=3.07e-02 t_gemm=2.98e-01 t_reduction=2.96e-02 tot=3.59e-01 ---
 sigma_tot counter=153 i=0 t=3.66e-02 per=1.23e+01 cost=8.97e+05 flops=2.45e+07
 sigma_tot counter=153 i=1 t=3.76e-02 per=1.26e+01 cost=9.09e+05 flops=2.42e+07
 sigma_tot counter=153 i=2 t=3.63e-02 per=1.22e+01 cost=9.07e+05 flops=2.50e+07
 sigma_tot counter=153 i=3 t=3.67e-02 per=1.23e+01 cost=9.12e+05 flops=2.49e+07
 sigma_tot counter=153 i=4 t=3.67e-02 per=1.23e+01 cost=1.48e+06 flops=4.03e+07
 sigma_tot counter=153 i=5 t=3.73e-02 per=1.25e+01 cost=1.48e+06 flops=3.96e+07
 sigma_tot counter=153 i=6 t=3.99e-02 per=1.34e+01 cost=1.81e+06 flops=4.55e+07
 sigma_tot counter=153 i=7 t=3.74e-02 per=1.25e+01 cost=1.81e+06 flops=4.83e+07
 total GEMM cost=1.02e+07 flops=3.42e+07
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   2.46e-02  2.46e-03
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   2.46e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.98e-04,1.96e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.96e-03 t_reduction=1.89e-04 tot=2.35e-03 ---
 sigma counter=154 i=0 t=2.34e-04 per=1.19e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=154 i=1 t=2.42e-04 per=1.23e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=154 i=2 t=2.38e-04 per=1.21e+01 cost=7.01e+03 flops=2.94e+07
 sigma counter=154 i=3 t=2.39e-04 per=1.22e+01 cost=6.99e+03 flops=2.92e+07
 sigma counter=154 i=4 t=2.37e-04 per=1.21e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=154 i=5 t=2.42e-04 per=1.23e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=154 i=6 t=2.65e-04 per=1.35e+01 cost=1.89e+04 flops=7.13e+07
 sigma counter=154 i=7 t=2.64e-04 per=1.35e+01 cost=1.89e+04 flops=7.16e+07
 total GEMM cost=7.90e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=3.09e-02 t_gemm=3.00e-01 t_reduction=2.97e-02 tot=3.61e-01 ---
 sigma_tot counter=154 i=0 t=3.68e-02 per=1.23e+01 cost=9.04e+05 flops=2.46e+07
 sigma_tot counter=154 i=1 t=3.78e-02 per=1.26e+01 cost=9.15e+05 flops=2.42e+07
 sigma_tot counter=154 i=2 t=3.66e-02 per=1.22e+01 cost=9.14e+05 flops=2.50e+07
 sigma_tot counter=154 i=3 t=3.69e-02 per=1.23e+01 cost=9.19e+05 flops=2.49e+07
 sigma_tot counter=154 i=4 t=3.70e-02 per=1.23e+01 cost=1.49e+06 flops=4.02e+07
 sigma_tot counter=154 i=5 t=3.76e-02 per=1.25e+01 cost=1.48e+06 flops=3.95e+07
 sigma_tot counter=154 i=6 t=4.01e-02 per=1.34e+01 cost=1.83e+06 flops=4.57e+07
 sigma_tot counter=154 i=7 t=3.76e-02 per=1.25e+01 cost=1.82e+06 flops=4.85e+07
 total GEMM cost=1.03e+07 flops=3.42e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.00e-04,1.95e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=2.00e-04 t_gemm=1.95e-03 t_reduction=1.87e-04 tot=2.33e-03 ---
 sigma counter=155 i=0 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=155 i=1 t=2.40e-04 per=1.23e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=155 i=2 t=2.34e-04 per=1.20e+01 cost=7.01e+03 flops=2.99e+07
 sigma counter=155 i=3 t=2.40e-04 per=1.23e+01 cost=6.99e+03 flops=2.91e+07
 sigma counter=155 i=4 t=2.33e-04 per=1.20e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=155 i=5 t=2.40e-04 per=1.23e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=155 i=6 t=2.61e-04 per=1.34e+01 cost=1.89e+04 flops=7.24e+07
 sigma counter=155 i=7 t=2.63e-04 per=1.35e+01 cost=1.89e+04 flops=7.18e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=3.11e-02 t_gemm=3.02e-01 t_reduction=2.99e-02 tot=3.63e-01 ---
 sigma_tot counter=155 i=0 t=3.70e-02 per=1.23e+01 cost=9.11e+05 flops=2.46e+07
 sigma_tot counter=155 i=1 t=3.81e-02 per=1.26e+01 cost=9.22e+05 flops=2.42e+07
 sigma_tot counter=155 i=2 t=3.68e-02 per=1.22e+01 cost=9.21e+05 flops=2.50e+07
 sigma_tot counter=155 i=3 t=3.71e-02 per=1.23e+01 cost=9.26e+05 flops=2.49e+07
 sigma_tot counter=155 i=4 t=3.72e-02 per=1.23e+01 cost=1.49e+06 flops=4.01e+07
 sigma_tot counter=155 i=5 t=3.78e-02 per=1.25e+01 cost=1.49e+06 flops=3.94e+07
 sigma_tot counter=155 i=6 t=4.04e-02 per=1.34e+01 cost=1.85e+06 flops=4.58e+07
 sigma_tot counter=155 i=7 t=3.79e-02 per=1.25e+01 cost=1.84e+06 flops=4.87e+07
 total GEMM cost=1.04e+07 flops=3.43e+07
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   2.95e-02  2.46e-03
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   2.95e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.98e-04,1.95e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.95e-03 t_reduction=1.87e-04 tot=2.33e-03 ---
 sigma counter=156 i=0 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=156 i=1 t=2.52e-04 per=1.29e+01 cost=6.78e+03 flops=2.69e+07
 sigma counter=156 i=2 t=2.33e-04 per=1.20e+01 cost=7.01e+03 flops=3.01e+07
 sigma counter=156 i=3 t=2.36e-04 per=1.21e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=156 i=4 t=2.32e-04 per=1.19e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=156 i=5 t=2.46e-04 per=1.26e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=156 i=6 t=2.69e-04 per=1.38e+01 cost=1.89e+04 flops=7.02e+07
 sigma counter=156 i=7 t=2.46e-04 per=1.26e+01 cost=1.89e+04 flops=7.68e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=3.13e-02 t_gemm=3.04e-01 t_reduction=3.01e-02 tot=3.66e-01 ---
 sigma_tot counter=156 i=0 t=3.73e-02 per=1.22e+01 cost=9.18e+05 flops=2.46e+07
 sigma_tot counter=156 i=1 t=3.83e-02 per=1.26e+01 cost=9.29e+05 flops=2.42e+07
 sigma_tot counter=156 i=2 t=3.70e-02 per=1.22e+01 cost=9.28e+05 flops=2.51e+07
 sigma_tot counter=156 i=3 t=3.74e-02 per=1.23e+01 cost=9.33e+05 flops=2.50e+07
 sigma_tot counter=156 i=4 t=3.74e-02 per=1.23e+01 cost=1.50e+06 flops=4.01e+07
 sigma_tot counter=156 i=5 t=3.81e-02 per=1.25e+01 cost=1.50e+06 flops=3.94e+07
 sigma_tot counter=156 i=6 t=4.07e-02 per=1.34e+01 cost=1.87e+06 flops=4.60e+07
 sigma_tot counter=156 i=7 t=3.81e-02 per=1.25e+01 cost=1.86e+06 flops=4.89e+07
 total GEMM cost=1.04e+07 flops=3.43e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,2.00e-04,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.33e-03 ---
 sigma counter=157 i=0 t=2.36e-04 per=1.22e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=157 i=1 t=2.41e-04 per=1.24e+01 cost=6.78e+03 flops=2.81e+07
 sigma counter=157 i=2 t=2.31e-04 per=1.19e+01 cost=7.01e+03 flops=3.03e+07
 sigma counter=157 i=3 t=2.36e-04 per=1.22e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=157 i=4 t=2.39e-04 per=1.23e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=157 i=5 t=2.35e-04 per=1.21e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=157 i=6 t=2.69e-04 per=1.39e+01 cost=1.89e+04 flops=7.02e+07
 sigma counter=157 i=7 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=3.15e-02 t_gemm=3.06e-01 t_reduction=3.03e-02 tot=3.68e-01 ---
 sigma_tot counter=157 i=0 t=3.75e-02 per=1.22e+01 cost=9.25e+05 flops=2.47e+07
 sigma_tot counter=157 i=1 t=3.86e-02 per=1.26e+01 cost=9.36e+05 flops=2.43e+07
 sigma_tot counter=157 i=2 t=3.73e-02 per=1.22e+01 cost=9.35e+05 flops=2.51e+07
 sigma_tot counter=157 i=3 t=3.76e-02 per=1.23e+01 cost=9.40e+05 flops=2.50e+07
 sigma_tot counter=157 i=4 t=3.77e-02 per=1.23e+01 cost=1.51e+06 flops=4.00e+07
 sigma_tot counter=157 i=5 t=3.83e-02 per=1.25e+01 cost=1.50e+06 flops=3.93e+07
 sigma_tot counter=157 i=6 t=4.09e-02 per=1.34e+01 cost=1.89e+06 flops=4.62e+07
 sigma_tot counter=157 i=7 t=3.84e-02 per=1.25e+01 cost=1.88e+06 flops=4.90e+07
 total GEMM cost=1.05e+07 flops=3.43e+07
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   3.44e-02  2.46e-03
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   3.44e-02  2.46e-03
TIMING for Davidson : 3.45e-02  T(cal/comm/rest)=3.41e-02,9.47e-07,3.25e-04
optimized energies: isweep=3 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=3 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.969e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000567 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=4.98e-05,0.000243,0.000275 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8e-06,0.00106,0.000183 cost=2.78e+04 flops[gemm]=2.62e+07
--- TIMING FOR renorm : t_inter=8e-06 t_gemm=0.00106 t_reduction=0.000183 tot=0.00125 ---
 renorm counter=15 i=0 t=0.000213 per=20.1 cost=1.82e+03 flops=8.55e+06
 renorm counter=15 i=1 t=0.000213 per=20.1 cost=3.23e+03 flops=1.51e+07
 renorm counter=15 i=2 t=0.000198 per=18.6 cost=1.91e+03 flops=9.63e+06
 renorm counter=15 i=3 t=0.000206 per=19.4 cost=3.14e+03 flops=1.53e+07
 renorm counter=15 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=15 i=5 t=1e-06 per=0.0942 cost=0 flops=0
 renorm counter=15 i=6 t=0.000231 per=21.8 cost=1.77e+04 flops=7.66e+07
 total GEMM cost=2.78e+04 flops=2.62e+07
--- TIMING FOR renorm_tot : t_inter=0.00138 t_gemm=0.0163 t_reduction=0.00285 tot=0.0205 ---
 renorm_tot counter=15 i=0 t=0.00319 per=19.6 cost=5.44e+04 flops=1.71e+07
 renorm_tot counter=15 i=1 t=0.00321 per=19.7 cost=7.65e+04 flops=2.38e+07
 renorm_tot counter=15 i=2 t=0.00144 per=8.87 cost=4.48e+04 flops=3.11e+07
 renorm_tot counter=15 i=3 t=0.00148 per=9.13 cost=7.81e+04 flops=5.27e+07
 renorm_tot counter=15 i=4 t=0.00166 per=10.2 cost=6.15e+04 flops=3.7e+07
 renorm_tot counter=15 i=5 t=0.0017 per=10.5 cost=1.06e+05 flops=6.25e+07
 renorm_tot counter=15 i=6 t=0.00358 per=22 cost=6.37e+05 flops=1.78e+08
 total GEMM cost=1.06e+06 flops=6.51e+07
check ||H-H.dagger||=0.00e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=8.8e-05,0.0025,8.6e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(3,0) size=1.03e-05GB T[save](info/data/tot)=5.08e-05,3.19e-05,8.27e-05 speed=0.125GB/s disk[used]=9.62e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
##### time_local: 4.21e-02 S #####
 T(fetch) = 7.12e-05 S  per = 0.17  per(accum) = 0.17
 T(hdiag) = 7.63e-05 S  per = 0.18  per(accum) = 0.35
 T(dvdsn) = 3.86e-02 S  per =   92  per(accum) = 92
 T(decim) = 8.24e-05 S  per =  0.2  per(accum) = 92
 T(guess) = 8.06e-05 S  per = 0.19  per(accum) = 92
 T(renrm) = 2.65e-03 S  per =  6.3  per(accum) = 99
 T(save ) = 5.39e-04 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.84e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 3.92e-05 S  per =  0.1  per(accum) = 0.1
 T(symbolic_formulae_twodot     ) = 2.29e-04 S  per =  0.6  per(accum) = 0.7
 T(hintermediate init           ) = 2.12e-05 S  per = 0.055  per(accum) = 0.75
 T(hintermediates memcpy cpu2gpu) = 3.55e-06 S  per = 0.0092  per(accum) = 0.76
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =  5.9  per(accum) = 6.6
 T(hmmtasks init                ) = 1.39e-03 S  per =  3.6  per(accum) = 10
 T(dvdson solver [Hx_batchGPU]  ) = 3.41e-02 S  per =   89  per(accum) = 99
 T(dvdson solver [communication]) = 9.47e-07 S  per = 0.0025  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.25e-04 S  per = 0.85  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.60e-03 S
 T(qops init                    ) = 8.81e-05 S  per =  3.4  per(accum) = 3.4
 T(qops_dict memcpy cpu2gpu     ) = 3.13e-05 S  per =  1.2  per(accum) = 4.6
 T(symbolic_formulae_renorm     ) = 2.02e-04 S  per =  7.7  per(accum) = 12
 T(rintermediate init           ) = 9.50e-06 S  per = 0.36  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.78e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.76e-04 S  per =   22  per(accum) = 35
 T(rmmtasks init                ) = 3.27e-04 S  per =   13  per(accum) = 48
 T(qops memset                  ) = 8.37e-06 S  per = 0.32  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.32e-03 S  per =   51  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.78e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.59e-06 S  per = 0.33  per(accum) = 1e+02
##### time_sweep: 9.49e-02 S #####
 T(fetch) = 4.40e-04 S  per = 0.46  per(accum) = 0.46
 T(hdiag) = 2.14e-04 S  per = 0.23  per(accum) = 0.69
 T(dvdsn) = 8.38e-02 S  per =   88  per(accum) = 89
 T(decim) = 4.62e-04 S  per = 0.49  per(accum) = 89
 T(guess) = 2.32e-04 S  per = 0.24  per(accum) = 90
 T(renrm) = 8.11e-03 S  per =  8.6  per(accum) = 98
 T(save ) = 1.67e-03 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.33e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.18e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 6.83e-04 S  per = 0.82  per(accum) = 0.96
 T(hintermediate init           ) = 6.38e-05 S  per = 0.077  per(accum) = 1
 T(hintermediates memcpy cpu2gpu) = 1.07e-05 S  per = 0.013  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 6.74e-03 S  per =  8.1  per(accum) = 9.1
 T(hmmtasks init                ) = 4.19e-03 S  per =    5  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 7.08e-02 S  per =   85  per(accum) = 99
 T(dvdson solver [communication]) = 1.80e-06 S  per = 0.0022  per(accum) = 99
 T(dvdson solver [rest part]    ) = 6.96e-04 S  per = 0.84  per(accum) = 1e+02
Detailed decomposition of T(renrm): 7.97e-03 S
 T(qops init                    ) = 2.55e-04 S  per =  3.2  per(accum) = 3.2
 T(qops_dict memcpy cpu2gpu     ) = 9.26e-05 S  per =  1.2  per(accum) = 4.4
 T(symbolic_formulae_renorm     ) = 5.69e-04 S  per =  7.1  per(accum) = 11
 T(rintermediate init           ) = 4.04e-05 S  per = 0.51  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 1.40e-05 S  per = 0.18  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 1.67e-03 S  per =   21  per(accum) = 33
 T(rmmtasks init                ) = 1.02e-03 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 2.51e-05 S  per = 0.31  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 4.18e-03 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 8.31e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.57e-05 S  per = 0.32  per(accum) = 1e+02
##### time_global: 5.15e-01 S #####
 T(fetch) = 3.44e-03 S  per = 0.67  per(accum) = 0.67
 T(hdiag) = 1.21e-03 S  per = 0.24  per(accum) = 0.9
 T(dvdsn) = 4.54e-01 S  per =   88  per(accum) = 89
 T(decim) = 3.65e-03 S  per = 0.71  per(accum) = 90
 T(guess) = 1.29e-03 S  per = 0.25  per(accum) = 90
 T(renrm) = 4.22e-02 S  per =  8.2  per(accum) = 98
 T(save ) = 8.62e-03 S  per =  1.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.51e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 6.29e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 3.88e-03 S  per = 0.86  per(accum) = 1
 T(hintermediate init           ) = 3.86e-04 S  per = 0.086  per(accum) = 1.1
 T(hintermediates memcpy cpu2gpu) = 6.25e-05 S  per = 0.014  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 3.43e-02 S  per =  7.6  per(accum) = 8.7
 T(hmmtasks init                ) = 2.14e-02 S  per =  4.7  per(accum) = 13
 T(dvdson solver [Hx_batchGPU]  ) = 3.86e-01 S  per =   86  per(accum) = 99
 T(dvdson solver [communication]) = 1.02e-05 S  per = 0.0023  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.41e-03 S  per = 0.98  per(accum) = 1e+02
Detailed decomposition of T(renrm): 4.15e-02 S
 T(qops init                    ) = 1.75e-03 S  per =  4.2  per(accum) = 4.2
 T(qops_dict memcpy cpu2gpu     ) = 5.24e-04 S  per =  1.3  per(accum) = 5.5
 T(symbolic_formulae_renorm     ) = 3.15e-03 S  per =  7.6  per(accum) = 13
 T(rintermediate init           ) = 2.59e-04 S  per = 0.62  per(accum) = 14
 T(rintermediates memcpy cpu2gpu) = 7.85e-05 S  per = 0.19  per(accum) = 14
 T(preprocess_formulae_Rlist2   ) = 8.16e-03 S  per =   20  per(accum) = 34
 T(rmmtasks init                ) = 5.15e-03 S  per =   12  per(accum) = 46
 T(qops memset                  ) = 1.33e-04 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 2.17e-02 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 4.37e-04 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.38e-04 S  per = 0.33  per(accum) = 1e+02

isweep=3 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.274e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44902970
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.166e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.864e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00223 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.21e-05,0.00095,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.4e-05,0.000202,0.00194,0.000188 cost=7.9e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0.000202 t_gemm=0.00194 t_reduction=0.000188 tot=0.00233 ---
 sigma counter=158 i=0 t=0.000238 per=12.3 cost=7.01e+03 flops=2.94e+07
 sigma counter=158 i=1 t=0.000245 per=12.6 cost=6.99e+03 flops=2.85e+07
 sigma counter=158 i=2 t=0.00023 per=11.8 cost=6.81e+03 flops=2.96e+07
 sigma counter=158 i=3 t=0.000236 per=12.2 cost=6.78e+03 flops=2.87e+07
 sigma counter=158 i=4 t=0.000254 per=13.1 cost=1.89e+04 flops=7.44e+07
 sigma counter=158 i=5 t=0.000255 per=13.1 cost=1.89e+04 flops=7.41e+07
 sigma counter=158 i=6 t=0.000243 per=12.5 cost=6.78e+03 flops=2.79e+07
 sigma counter=158 i=7 t=0.000241 per=12.4 cost=6.81e+03 flops=2.83e+07
 total GEMM cost=7.9e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0.0317 t_gemm=0.308 t_reduction=0.0305 tot=0.37 ---
 sigma_tot counter=158 i=0 t=0.0377 per=12.2 cost=9.32e+05 flops=2.47e+07
 sigma_tot counter=158 i=1 t=0.0388 per=12.6 cost=9.43e+05 flops=2.43e+07
 sigma_tot counter=158 i=2 t=0.0375 per=12.2 cost=9.41e+05 flops=2.51e+07
 sigma_tot counter=158 i=3 t=0.0379 per=12.3 cost=9.47e+05 flops=2.5e+07
 sigma_tot counter=158 i=4 t=0.0379 per=12.3 cost=1.53e+06 flops=4.02e+07
 sigma_tot counter=158 i=5 t=0.0385 per=12.5 cost=1.52e+06 flops=3.95e+07
 sigma_tot counter=158 i=6 t=0.0412 per=13.4 cost=1.9e+06 flops=4.61e+07
 sigma_tot counter=158 i=7 t=0.0386 per=12.5 cost=1.89e+06 flops=4.89e+07
 total GEMM cost=1.06e+07 flops=3.44e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.7e-05,0.000203,0.00193,0.000205 cost=7.9e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=0.000203 t_gemm=0.00193 t_reduction=0.000205 tot=0.00234 ---
 sigma counter=159 i=0 t=0.000236 per=12.2 cost=7.01e+03 flops=2.97e+07
 sigma counter=159 i=1 t=0.000242 per=12.5 cost=6.99e+03 flops=2.89e+07
 sigma counter=159 i=2 t=0.000232 per=12 cost=6.81e+03 flops=2.94e+07
 sigma counter=159 i=3 t=0.000236 per=12.2 cost=6.78e+03 flops=2.87e+07
 sigma counter=159 i=4 t=0.000248 per=12.9 cost=1.89e+04 flops=7.62e+07
 sigma counter=159 i=5 t=0.000254 per=13.2 cost=1.89e+04 flops=7.44e+07
 sigma counter=159 i=6 t=0.000243 per=12.6 cost=6.78e+03 flops=2.79e+07
 sigma counter=159 i=7 t=0.000238 per=12.3 cost=6.81e+03 flops=2.86e+07
 total GEMM cost=7.9e+04 flops=4.09e+07
--- TIMING FOR sigma_tot : t_inter=0.0319 t_gemm=0.31 t_reduction=0.0307 tot=0.373 ---
 sigma_tot counter=159 i=0 t=0.038 per=12.2 cost=9.39e+05 flops=2.47e+07
 sigma_tot counter=159 i=1 t=0.039 per=12.6 cost=9.5e+05 flops=2.43e+07
 sigma_tot counter=159 i=2 t=0.0377 per=12.2 cost=9.48e+05 flops=2.51e+07
 sigma_tot counter=159 i=3 t=0.0381 per=12.3 cost=9.54e+05 flops=2.5e+07
 sigma_tot counter=159 i=4 t=0.0382 per=12.3 cost=1.55e+06 flops=4.05e+07
 sigma_tot counter=159 i=5 t=0.0388 per=12.5 cost=1.54e+06 flops=3.97e+07
 sigma_tot counter=159 i=6 t=0.0414 per=13.4 cost=1.9e+06 flops=4.6e+07
 sigma_tot counter=159 i=7 t=0.0389 per=12.5 cost=1.9e+06 flops=4.88e+07
 total GEMM cost=1.07e+07 flops=3.44e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   4.92e-03  2.46e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   4.92e-03  2.46e-03
TIMING for Davidson : 4.94e-03  T(cal/comm/rest)=4.89e-03,1.44e-07,4.44e-05
optimized energies: isweep=3 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=3 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep3_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.800e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 1.892e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=3.26e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Rlist : 0.000529 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.52e-05,0.000247,0.000237 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000932 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07,0.0009
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000181,0.00106,0.000179 cost=1.55e+05 flops[gemm]=1.46e+08
--- TIMING FOR renorm : t_inter=0.000181 t_gemm=0.00106 t_reduction=0.000179 tot=0.00142 ---
 renorm counter=16 i=0 t=0.000201 per=19 cost=5.64e+03 flops=2.81e+07
 renorm counter=16 i=1 t=0.000208 per=19.7 cost=1.13e+04 flops=5.42e+07
 renorm counter=16 i=2 t=0.0002 per=18.9 cost=1.66e+04 flops=8.28e+07
 renorm counter=16 i=3 t=0.000214 per=20.2 cost=2.89e+04 flops=1.35e+08
 renorm counter=16 i=4 t=1e-06 per=0.0945 cost=0 flops=0
 renorm counter=16 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=16 i=6 t=0.000234 per=22.1 cost=9.22e+04 flops=3.94e+08
 total GEMM cost=1.55e+05 flops=1.46e+08
--- TIMING FOR renorm_tot : t_inter=0.00156 t_gemm=0.0173 t_reduction=0.00303 tot=0.0219 ---
 renorm_tot counter=16 i=0 t=0.00339 per=19.6 cost=6.01e+04 flops=1.77e+07
 renorm_tot counter=16 i=1 t=0.00342 per=19.7 cost=8.77e+04 flops=2.57e+07
 renorm_tot counter=16 i=2 t=0.00164 per=9.48 cost=6.14e+04 flops=3.74e+07
 renorm_tot counter=16 i=3 t=0.0017 per=9.81 cost=1.07e+05 flops=6.3e+07
 renorm_tot counter=16 i=4 t=0.00166 per=9.59 cost=6.15e+04 flops=3.7e+07
 renorm_tot counter=16 i=5 t=0.0017 per=9.81 cost=1.06e+05 flops=6.25e+07
 renorm_tot counter=16 i=6 t=0.00381 per=22 cost=7.29e+05 flops=1.91e+08
 total GEMM cost=1.21e+06 flops=7.01e+07
check ||H-H.dagger||=1.04e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0028 S T(init/kernel/comm)=7.8e-05,0.0027,8.6e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(2,0) size=1.94e-05GB T[save](info/data/tot)=6.08e-05,5.13e-05,0.000112 speed=0.173GB/s disk[used]=9.77e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
##### time_local: 1.32e-02 S #####
 T(fetch) = 3.07e-04 S  per =  2.3  per(accum) = 2.3
 T(hdiag) = 6.88e-05 S  per = 0.52  per(accum) = 2.8
 T(dvdsn) = 9.04e-03 S  per =   68  per(accum) = 71
 T(decim) = 3.50e-04 S  per =  2.6  per(accum) = 74
 T(guess) = 8.16e-05 S  per = 0.62  per(accum) = 74
 T(renrm) = 2.81e-03 S  per =   21  per(accum) = 96
 T(save ) = 5.76e-04 S  per =  4.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.85e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 3.99e-05 S  per = 0.45  per(accum) = 0.45
 T(symbolic_formulae_twodot     ) = 2.21e-04 S  per =  2.5  per(accum) = 2.9
 T(hintermediate init           ) = 2.15e-05 S  per = 0.24  per(accum) = 3.2
 T(hintermediates memcpy cpu2gpu) = 3.51e-06 S  per = 0.04  per(accum) = 3.2
 T(preprocess_hformulae_Hxlist2 ) = 2.24e-03 S  per =   25  per(accum) = 28
 T(hmmtasks init                ) = 1.40e-03 S  per =   16  per(accum) = 44
 T(dvdson solver [Hx_batchGPU]  ) = 4.89e-03 S  per =   55  per(accum) = 99
 T(dvdson solver [communication]) = 1.44e-07 S  per = 0.0016  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.44e-05 S  per =  0.5  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.75e-03 S
 T(qops init                    ) = 7.77e-05 S  per =  2.8  per(accum) = 2.8
 T(qops_dict memcpy cpu2gpu     ) = 3.59e-05 S  per =  1.3  per(accum) = 4.1
 T(symbolic_formulae_renorm     ) = 1.85e-04 S  per =  6.7  per(accum) = 11
 T(rintermediate init           ) = 2.19e-05 S  per = 0.79  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 4.49e-06 S  per = 0.16  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 5.37e-04 S  per =   20  per(accum) = 31
 T(rmmtasks init                ) = 3.58e-04 S  per =   13  per(accum) = 44
 T(qops memset                  ) = 8.14e-06 S  per =  0.3  per(accum) = 45
 T(preprocess_renorm_batchGPU   ) = 1.49e-03 S  per =   54  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.66e-05 S  per = 0.97  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.60e-06 S  per = 0.31  per(accum) = 1e+02
##### time_sweep: 1.08e-01 S #####
 T(fetch) = 7.47e-04 S  per = 0.69  per(accum) = 0.69
 T(hdiag) = 2.83e-04 S  per = 0.26  per(accum) = 0.95
 T(dvdsn) = 9.28e-02 S  per =   86  per(accum) = 87
 T(decim) = 8.13e-04 S  per = 0.75  per(accum) = 88
 T(guess) = 3.14e-04 S  per = 0.29  per(accum) = 88
 T(renrm) = 1.09e-02 S  per =   10  per(accum) = 98
 T(save ) = 2.25e-03 S  per =  2.1  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 9.21e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.58e-04 S  per = 0.17  per(accum) = 0.17
 T(symbolic_formulae_twodot     ) = 9.04e-04 S  per = 0.98  per(accum) = 1.2
 T(hintermediate init           ) = 8.53e-05 S  per = 0.093  per(accum) = 1.2
 T(hintermediates memcpy cpu2gpu) = 1.42e-05 S  per = 0.015  per(accum) = 1.3
 T(preprocess_hformulae_Hxlist2 ) = 8.97e-03 S  per =  9.7  per(accum) = 11
 T(hmmtasks init                ) = 5.58e-03 S  per =  6.1  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 7.57e-02 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 1.94e-06 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.40e-04 S  per =  0.8  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.07e-02 S
 T(qops init                    ) = 3.33e-04 S  per =  3.1  per(accum) = 3.1
 T(qops_dict memcpy cpu2gpu     ) = 1.29e-04 S  per =  1.2  per(accum) = 4.3
 T(symbolic_formulae_renorm     ) = 7.53e-04 S  per =    7  per(accum) = 11
 T(rintermediate init           ) = 6.22e-05 S  per = 0.58  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 1.85e-05 S  per = 0.17  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 2.21e-03 S  per =   21  per(accum) = 33
 T(rmmtasks init                ) = 1.38e-03 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 3.32e-05 S  per = 0.31  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 5.67e-03 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.10e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 3.43e-05 S  per = 0.32  per(accum) = 1e+02
##### time_global: 5.28e-01 S #####
 T(fetch) = 3.75e-03 S  per = 0.71  per(accum) = 0.71
 T(hdiag) = 1.28e-03 S  per = 0.24  per(accum) = 0.95
 T(dvdsn) = 4.63e-01 S  per =   88  per(accum) = 89
 T(decim) = 4.00e-03 S  per = 0.76  per(accum) = 89
 T(guess) = 1.37e-03 S  per = 0.26  per(accum) = 90
 T(renrm) = 4.50e-02 S  per =  8.5  per(accum) = 98
 T(save ) = 9.20e-03 S  per =  1.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.60e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 6.68e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 4.10e-03 S  per = 0.89  per(accum) = 1
 T(hintermediate init           ) = 4.08e-04 S  per = 0.089  per(accum) = 1.1
 T(hintermediates memcpy cpu2gpu) = 6.60e-05 S  per = 0.014  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 3.66e-02 S  per =    8  per(accum) = 9.1
 T(hmmtasks init                ) = 2.28e-02 S  per =    5  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 3.91e-01 S  per =   85  per(accum) = 99
 T(dvdson solver [communication]) = 1.03e-05 S  per = 0.0022  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.45e-03 S  per = 0.97  per(accum) = 1e+02
Detailed decomposition of T(renrm): 4.42e-02 S
 T(qops init                    ) = 1.83e-03 S  per =  4.1  per(accum) = 4.1
 T(qops_dict memcpy cpu2gpu     ) = 5.60e-04 S  per =  1.3  per(accum) = 5.4
 T(symbolic_formulae_renorm     ) = 3.34e-03 S  per =  7.5  per(accum) = 13
 T(rintermediate init           ) = 2.80e-04 S  per = 0.63  per(accum) = 14
 T(rintermediates memcpy cpu2gpu) = 8.30e-05 S  per = 0.19  per(accum) = 14
 T(preprocess_formulae_Rlist2   ) = 8.70e-03 S  per =   20  per(accum) = 33
 T(rmmtasks init                ) = 5.51e-03 S  per =   12  per(accum) = 46
 T(qops memset                  ) = 1.41e-04 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 2.32e-02 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 4.64e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.46e-04 S  per = 0.33  per(accum) = 1e+02

======================================================================
sweep_data::summary isweep=3
----------------------------------------------------------------------
sweep parameters: isweep=3 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.04
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.013
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.042
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.013
 eav_max=-2.54574720706 [ibond=1]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=3]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=1.60474789013e-09
 sweep energies: isweep=3 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[0]=-2.65451696664
 sweep energies: isweep=3 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=3
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.00e-04 1.00e-04 | 52 | 1.69e-01 | 1.69e-01 | 1.10e-02 1.06e-01 1.11e-02 1.28e-01 76.1
            1  2      20 1.00e-04 0.00e+00 | 45 | 1.46e-01 | 3.15e-01 | 2.04e-02 1.98e-01 2.05e-02 2.39e-01 76
            2  2      20 1.00e-04 0.00e+00 | 31 | 1.09e-01 | 4.24e-01 | 2.69e-02 2.63e-01 2.71e-02 3.17e-01 74.8
            3  2      20 1.00e-04 0.00e+00 | 31 | 1.09e-01 | 5.33e-01 | 3.35e-02 3.27e-01 3.37e-02 3.95e-01 74
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.50e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
            1      20 +5.26e-04 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.68e-13)
            2      20 +0.00e+00 e[0]=-2.65451696664 (8.88e-16) e[1]=-2.43697745069 (-5.33e-15)
            3      20 +5.26e-04 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep3.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep3_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
decimation summary: 80->8 dwt=+0.000e+00 SvN=1.326e+00

Convert [C]RRR => [cR]RRR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep3_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
decimation summary: 32->2 dwt=+1.110e-16 SvN=1.000e+00

ctns::rcanon_save fname=./scratch/rcanon_isweep3.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.00e+00
 idx=2 node=(2,0) Drow=20 maxdiff=1.53e-15
 idx=3 node=(1,0) Drow=8 maxdiff=5.40e-16
 idx=4 node=(0,0) Drow=2 maxdiff=3.15e-16
stensor2: wf2 own=1 _data=0x44b483b0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.05e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x44b483b0
     -7.0577e-18      -1.0000e+00 
     -1.0000e+00      -3.0850e-17 
 rwfuns: nroots=2 maxdiff=9.1708e-16
----- TIMING FOR ctns::rcanon_check : 8.021e-05 S -----
..... end of isweep = 3 .....

======================================================================
sweep parameters: isweep=4 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB

isweep=4 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.126e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB
===== CPUmem(GB): tot=3.61e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44970510
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.273e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.867e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00224 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.51e-05,0.000957,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=5.1e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.5e-05,0.000205,0.00195,0.000187 cost=7.9e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0.000205 t_gemm=0.00195 t_reduction=0.000186 tot=0.00234 ---
 sigma counter=160 i=0 t=0.000237 per=12.2 cost=7.01e+03 flops=2.96e+07
 sigma counter=160 i=1 t=0.000245 per=12.6 cost=6.99e+03 flops=2.85e+07
 sigma counter=160 i=2 t=0.000232 per=11.9 cost=6.81e+03 flops=2.94e+07
 sigma counter=160 i=3 t=0.000236 per=12.1 cost=6.78e+03 flops=2.87e+07
 sigma counter=160 i=4 t=0.000254 per=13 cost=1.89e+04 flops=7.44e+07
 sigma counter=160 i=5 t=0.000261 per=13.4 cost=1.89e+04 flops=7.24e+07
 sigma counter=160 i=6 t=0.000242 per=12.4 cost=6.78e+03 flops=2.8e+07
 sigma counter=160 i=7 t=0.000241 per=12.4 cost=6.81e+03 flops=2.83e+07
 total GEMM cost=7.9e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0.0321 t_gemm=0.312 t_reduction=0.0309 tot=0.375 ---
 sigma_tot counter=160 i=0 t=0.0382 per=12.2 cost=9.46e+05 flops=2.47e+07
 sigma_tot counter=160 i=1 t=0.0393 per=12.6 cost=9.57e+05 flops=2.44e+07
 sigma_tot counter=160 i=2 t=0.0379 per=12.2 cost=9.55e+05 flops=2.52e+07
 sigma_tot counter=160 i=3 t=0.0383 per=12.3 cost=9.61e+05 flops=2.51e+07
 sigma_tot counter=160 i=4 t=0.0384 per=12.3 cost=1.56e+06 flops=4.07e+07
 sigma_tot counter=160 i=5 t=0.0391 per=12.5 cost=1.56e+06 flops=4e+07
 sigma_tot counter=160 i=6 t=0.0416 per=13.3 cost=1.91e+06 flops=4.58e+07
 sigma_tot counter=160 i=7 t=0.0391 per=12.5 cost=1.9e+06 flops=4.86e+07
 total GEMM cost=1.08e+07 flops=3.45e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.6e-05,0.000199,0.00195,0.000192 cost=7.9e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0.000199 t_gemm=0.00195 t_reduction=0.000192 tot=0.00234 ---
 sigma counter=161 i=0 t=0.000237 per=12.2 cost=7.01e+03 flops=2.96e+07
 sigma counter=161 i=1 t=0.000248 per=12.7 cost=6.99e+03 flops=2.82e+07
 sigma counter=161 i=2 t=0.00023 per=11.8 cost=6.81e+03 flops=2.96e+07
 sigma counter=161 i=3 t=0.000245 per=12.6 cost=6.78e+03 flops=2.77e+07
 sigma counter=161 i=4 t=0.000254 per=13 cost=1.89e+04 flops=7.44e+07
 sigma counter=161 i=5 t=0.000249 per=12.8 cost=1.89e+04 flops=7.59e+07
 sigma counter=161 i=6 t=0.000244 per=12.5 cost=6.78e+03 flops=2.78e+07
 sigma counter=161 i=7 t=0.000242 per=12.4 cost=6.81e+03 flops=2.82e+07
 total GEMM cost=7.9e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0.0323 t_gemm=0.314 t_reduction=0.0311 tot=0.377 ---
 sigma_tot counter=161 i=0 t=0.0385 per=12.2 cost=9.53e+05 flops=2.48e+07
 sigma_tot counter=161 i=1 t=0.0395 per=12.6 cost=9.64e+05 flops=2.44e+07
 sigma_tot counter=161 i=2 t=0.0382 per=12.2 cost=9.62e+05 flops=2.52e+07
 sigma_tot counter=161 i=3 t=0.0386 per=12.3 cost=9.67e+05 flops=2.51e+07
 sigma_tot counter=161 i=4 t=0.0387 per=12.3 cost=1.58e+06 flops=4.09e+07
 sigma_tot counter=161 i=5 t=0.0393 per=12.5 cost=1.58e+06 flops=4.02e+07
 sigma_tot counter=161 i=6 t=0.0419 per=13.3 cost=1.92e+06 flops=4.57e+07
 sigma_tot counter=161 i=7 t=0.0393 per=12.5 cost=1.91e+06 flops=4.85e+07
 total GEMM cost=1.08e+07 flops=3.45e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891  -1.00e+03   6.88e-02    2     2   4.92e-03  2.46e-03
    1   1 -      -2.436233901339  -1.00e+03   4.38e-02    2     2   4.92e-03  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=3.00e-05,2.02e-04,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.32e-03 ---
 sigma counter=162 i=0 t=2.36e-04 per=1.22e+01 cost=7.01e+03 flops=2.97e+07
 sigma counter=162 i=1 t=2.40e-04 per=1.24e+01 cost=6.99e+03 flops=2.91e+07
 sigma counter=162 i=2 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=162 i=3 t=2.36e-04 per=1.22e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=162 i=4 t=2.48e-04 per=1.28e+01 cost=1.89e+04 flops=7.62e+07
 sigma counter=162 i=5 t=2.55e-04 per=1.32e+01 cost=1.89e+04 flops=7.41e+07
 sigma counter=162 i=6 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=162 i=7 t=2.41e-04 per=1.25e+01 cost=6.81e+03 flops=2.83e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=3.25e-02 t_gemm=3.16e-01 t_reduction=3.13e-02 tot=3.80e-01 ---
 sigma_tot counter=162 i=0 t=3.87e-02 per=1.22e+01 cost=9.60e+05 flops=2.48e+07
 sigma_tot counter=162 i=1 t=3.98e-02 per=1.26e+01 cost=9.71e+05 flops=2.44e+07
 sigma_tot counter=162 i=2 t=3.84e-02 per=1.22e+01 cost=9.69e+05 flops=2.52e+07
 sigma_tot counter=162 i=3 t=3.88e-02 per=1.23e+01 cost=9.74e+05 flops=2.51e+07
 sigma_tot counter=162 i=4 t=3.89e-02 per=1.23e+01 cost=1.60e+06 flops=4.11e+07
 sigma_tot counter=162 i=5 t=3.96e-02 per=1.25e+01 cost=1.60e+06 flops=4.04e+07
 sigma_tot counter=162 i=6 t=4.21e-02 per=1.33e+01 cost=1.92e+06 flops=4.56e+07
 sigma_tot counter=162 i=7 t=3.96e-02 per=1.25e+01 cost=1.92e+06 flops=4.84e+07
 total GEMM cost=1.09e+07 flops=3.45e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.98e-04,1.94e-03,1.90e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=1.97e-04 t_gemm=1.94e-03 t_reduction=1.90e-04 tot=2.33e-03 ---
 sigma counter=163 i=0 t=2.36e-04 per=1.22e+01 cost=7.01e+03 flops=2.97e+07
 sigma counter=163 i=1 t=2.49e-04 per=1.28e+01 cost=6.99e+03 flops=2.81e+07
 sigma counter=163 i=2 t=2.41e-04 per=1.24e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=163 i=3 t=2.33e-04 per=1.20e+01 cost=6.78e+03 flops=2.91e+07
 sigma counter=163 i=4 t=2.48e-04 per=1.28e+01 cost=1.89e+04 flops=7.62e+07
 sigma counter=163 i=5 t=2.57e-04 per=1.32e+01 cost=1.89e+04 flops=7.35e+07
 sigma counter=163 i=6 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=163 i=7 t=2.32e-04 per=1.20e+01 cost=6.81e+03 flops=2.94e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=3.27e-02 t_gemm=3.18e-01 t_reduction=3.15e-02 tot=3.82e-01 ---
 sigma_tot counter=163 i=0 t=3.89e-02 per=1.22e+01 cost=9.67e+05 flops=2.48e+07
 sigma_tot counter=163 i=1 t=4.00e-02 per=1.26e+01 cost=9.78e+05 flops=2.44e+07
 sigma_tot counter=163 i=2 t=3.87e-02 per=1.22e+01 cost=9.75e+05 flops=2.52e+07
 sigma_tot counter=163 i=3 t=3.90e-02 per=1.23e+01 cost=9.81e+05 flops=2.51e+07
 sigma_tot counter=163 i=4 t=3.92e-02 per=1.23e+01 cost=1.62e+06 flops=4.14e+07
 sigma_tot counter=163 i=5 t=3.98e-02 per=1.25e+01 cost=1.62e+06 flops=4.06e+07
 sigma_tot counter=163 i=6 t=4.24e-02 per=1.33e+01 cost=1.93e+06 flops=4.55e+07
 sigma_tot counter=163 i=7 t=3.98e-02 per=1.25e+01 cost=1.92e+06 flops=4.83e+07
 total GEMM cost=1.10e+07 flops=3.46e+07
    2   0 -      -2.654428675110  -1.73e-03   1.26e-02    4     4   9.83e-03  2.46e-03
    2   1 -      -2.436964455587  -7.31e-04   4.22e-03    4     4   9.83e-03  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.00e-04,1.94e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=2.00e-04 t_gemm=1.94e-03 t_reduction=1.89e-04 tot=2.33e-03 ---
 sigma counter=164 i=0 t=2.37e-04 per=1.22e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=164 i=1 t=2.41e-04 per=1.24e+01 cost=6.99e+03 flops=2.90e+07
 sigma counter=164 i=2 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=164 i=3 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=164 i=4 t=2.45e-04 per=1.26e+01 cost=1.89e+04 flops=7.71e+07
 sigma counter=164 i=5 t=2.54e-04 per=1.31e+01 cost=1.89e+04 flops=7.44e+07
 sigma counter=164 i=6 t=2.59e-04 per=1.33e+01 cost=6.78e+03 flops=2.62e+07
 sigma counter=164 i=7 t=2.36e-04 per=1.21e+01 cost=6.81e+03 flops=2.89e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=3.29e-02 t_gemm=3.20e-01 t_reduction=3.16e-02 tot=3.84e-01 ---
 sigma_tot counter=164 i=0 t=3.92e-02 per=1.22e+01 cost=9.74e+05 flops=2.49e+07
 sigma_tot counter=164 i=1 t=4.03e-02 per=1.26e+01 cost=9.85e+05 flops=2.45e+07
 sigma_tot counter=164 i=2 t=3.89e-02 per=1.22e+01 cost=9.82e+05 flops=2.53e+07
 sigma_tot counter=164 i=3 t=3.93e-02 per=1.23e+01 cost=9.88e+05 flops=2.51e+07
 sigma_tot counter=164 i=4 t=3.94e-02 per=1.23e+01 cost=1.64e+06 flops=4.16e+07
 sigma_tot counter=164 i=5 t=4.01e-02 per=1.25e+01 cost=1.64e+06 flops=4.08e+07
 sigma_tot counter=164 i=6 t=4.26e-02 per=1.33e+01 cost=1.94e+06 flops=4.54e+07
 sigma_tot counter=164 i=7 t=4.00e-02 per=1.25e+01 cost=1.93e+06 flops=4.82e+07
 total GEMM cost=1.11e+07 flops=3.46e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.98e-04,1.93e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.93e-03 t_reduction=1.88e-04 tot=2.31e-03 ---
 sigma counter=165 i=0 t=2.39e-04 per=1.24e+01 cost=7.01e+03 flops=2.93e+07
 sigma counter=165 i=1 t=2.48e-04 per=1.29e+01 cost=6.99e+03 flops=2.82e+07
 sigma counter=165 i=2 t=2.30e-04 per=1.19e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=165 i=3 t=2.37e-04 per=1.23e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=165 i=4 t=2.50e-04 per=1.30e+01 cost=1.89e+04 flops=7.56e+07
 sigma counter=165 i=5 t=2.51e-04 per=1.30e+01 cost=1.89e+04 flops=7.53e+07
 sigma counter=165 i=6 t=2.42e-04 per=1.26e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=165 i=7 t=2.31e-04 per=1.20e+01 cost=6.81e+03 flops=2.95e+07
 total GEMM cost=7.90e+04 flops=4.10e+07
--- TIMING FOR sigma_tot : t_inter=3.31e-02 t_gemm=3.22e-01 t_reduction=3.18e-02 tot=3.87e-01 ---
 sigma_tot counter=165 i=0 t=3.94e-02 per=1.22e+01 cost=9.81e+05 flops=2.49e+07
 sigma_tot counter=165 i=1 t=4.05e-02 per=1.26e+01 cost=9.92e+05 flops=2.45e+07
 sigma_tot counter=165 i=2 t=3.91e-02 per=1.22e+01 cost=9.89e+05 flops=2.53e+07
 sigma_tot counter=165 i=3 t=3.95e-02 per=1.23e+01 cost=9.94e+05 flops=2.52e+07
 sigma_tot counter=165 i=4 t=3.97e-02 per=1.23e+01 cost=1.66e+06 flops=4.18e+07
 sigma_tot counter=165 i=5 t=4.03e-02 per=1.25e+01 cost=1.66e+06 flops=4.11e+07
 sigma_tot counter=165 i=6 t=4.29e-02 per=1.33e+01 cost=1.94e+06 flops=4.53e+07
 sigma_tot counter=165 i=7 t=4.03e-02 per=1.25e+01 cost=1.94e+06 flops=4.81e+07
 total GEMM cost=1.11e+07 flops=3.47e+07
    3   0 -      -2.654509664652  -8.10e-05   3.66e-03    6     6   1.47e-02  2.46e-03
    3   1 -      -2.436976459250  -1.20e-05   1.11e-03    6     6   1.47e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.97e-04,1.95e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=1.97e-04 t_gemm=1.95e-03 t_reduction=1.87e-04 tot=2.34e-03 ---
 sigma counter=166 i=0 t=2.34e-04 per=1.20e+01 cost=7.01e+03 flops=2.99e+07
 sigma counter=166 i=1 t=2.38e-04 per=1.22e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=166 i=2 t=2.46e-04 per=1.26e+01 cost=6.81e+03 flops=2.77e+07
 sigma counter=166 i=3 t=2.44e-04 per=1.25e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=166 i=4 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=166 i=5 t=2.48e-04 per=1.27e+01 cost=1.89e+04 flops=7.62e+07
 sigma counter=166 i=6 t=2.57e-04 per=1.32e+01 cost=6.78e+03 flops=2.64e+07
 sigma counter=166 i=7 t=2.32e-04 per=1.19e+01 cost=6.81e+03 flops=2.94e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=3.33e-02 t_gemm=3.24e-01 t_reduction=3.20e-02 tot=3.89e-01 ---
 sigma_tot counter=166 i=0 t=3.96e-02 per=1.22e+01 cost=9.88e+05 flops=2.49e+07
 sigma_tot counter=166 i=1 t=4.07e-02 per=1.26e+01 cost=9.99e+05 flops=2.45e+07
 sigma_tot counter=166 i=2 t=3.94e-02 per=1.22e+01 cost=9.96e+05 flops=2.53e+07
 sigma_tot counter=166 i=3 t=3.98e-02 per=1.23e+01 cost=1.00e+06 flops=2.52e+07
 sigma_tot counter=166 i=4 t=3.99e-02 per=1.23e+01 cost=1.68e+06 flops=4.20e+07
 sigma_tot counter=166 i=5 t=4.06e-02 per=1.25e+01 cost=1.67e+06 flops=4.13e+07
 sigma_tot counter=166 i=6 t=4.31e-02 per=1.33e+01 cost=1.95e+06 flops=4.52e+07
 sigma_tot counter=166 i=7 t=4.05e-02 per=1.25e+01 cost=1.94e+06 flops=4.80e+07
 total GEMM cost=1.12e+07 flops=3.47e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.99e-04,1.96e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.02e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.96e-03 t_reduction=1.89e-04 tot=2.35e-03 ---
 sigma counter=167 i=0 t=2.41e-04 per=1.23e+01 cost=7.01e+03 flops=2.91e+07
 sigma counter=167 i=1 t=2.54e-04 per=1.29e+01 cost=6.99e+03 flops=2.75e+07
 sigma counter=167 i=2 t=2.46e-04 per=1.25e+01 cost=6.81e+03 flops=2.77e+07
 sigma counter=167 i=3 t=2.35e-04 per=1.20e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=167 i=4 t=2.45e-04 per=1.25e+01 cost=1.89e+04 flops=7.71e+07
 sigma counter=167 i=5 t=2.58e-04 per=1.31e+01 cost=1.89e+04 flops=7.32e+07
 sigma counter=167 i=6 t=2.43e-04 per=1.24e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=167 i=7 t=2.41e-04 per=1.23e+01 cost=6.81e+03 flops=2.83e+07
 total GEMM cost=7.90e+04 flops=4.02e+07
--- TIMING FOR sigma_tot : t_inter=3.35e-02 t_gemm=3.26e-01 t_reduction=3.22e-02 tot=3.91e-01 ---
 sigma_tot counter=167 i=0 t=3.99e-02 per=1.22e+01 cost=9.95e+05 flops=2.49e+07
 sigma_tot counter=167 i=1 t=4.10e-02 per=1.26e+01 cost=1.01e+06 flops=2.45e+07
 sigma_tot counter=167 i=2 t=3.96e-02 per=1.22e+01 cost=1.00e+06 flops=2.53e+07
 sigma_tot counter=167 i=3 t=4.00e-02 per=1.23e+01 cost=1.01e+06 flops=2.52e+07
 sigma_tot counter=167 i=4 t=4.02e-02 per=1.23e+01 cost=1.70e+06 flops=4.22e+07
 sigma_tot counter=167 i=5 t=4.08e-02 per=1.25e+01 cost=1.69e+06 flops=4.15e+07
 sigma_tot counter=167 i=6 t=4.34e-02 per=1.33e+01 cost=1.96e+06 flops=4.51e+07
 sigma_tot counter=167 i=7 t=4.08e-02 per=1.25e+01 cost=1.95e+06 flops=4.78e+07
 total GEMM cost=1.13e+07 flops=3.47e+07
    4   0 -      -2.654516020764  -6.36e-06   1.14e-03    6     8   1.97e-02  2.46e-03
    4   1 -      -2.436977285934  -8.27e-07   4.03e-04    6     8   1.97e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.01e-04,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.33e-03 ---
 sigma counter=168 i=0 t=2.36e-04 per=1.22e+01 cost=7.01e+03 flops=2.97e+07
 sigma counter=168 i=1 t=2.47e-04 per=1.27e+01 cost=6.99e+03 flops=2.83e+07
 sigma counter=168 i=2 t=2.32e-04 per=1.19e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=168 i=3 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=168 i=4 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=168 i=5 t=2.58e-04 per=1.33e+01 cost=1.89e+04 flops=7.32e+07
 sigma counter=168 i=6 t=2.46e-04 per=1.27e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=168 i=7 t=2.33e-04 per=1.20e+01 cost=6.81e+03 flops=2.92e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=3.37e-02 t_gemm=3.28e-01 t_reduction=3.24e-02 tot=3.94e-01 ---
 sigma_tot counter=168 i=0 t=4.01e-02 per=1.22e+01 cost=1.00e+06 flops=2.50e+07
 sigma_tot counter=168 i=1 t=4.13e-02 per=1.26e+01 cost=1.01e+06 flops=2.45e+07
 sigma_tot counter=168 i=2 t=3.98e-02 per=1.22e+01 cost=1.01e+06 flops=2.53e+07
 sigma_tot counter=168 i=3 t=4.02e-02 per=1.23e+01 cost=1.01e+06 flops=2.52e+07
 sigma_tot counter=168 i=4 t=4.04e-02 per=1.23e+01 cost=1.72e+06 flops=4.24e+07
 sigma_tot counter=168 i=5 t=4.11e-02 per=1.25e+01 cost=1.71e+06 flops=4.17e+07
 sigma_tot counter=168 i=6 t=4.36e-02 per=1.33e+01 cost=1.96e+06 flops=4.50e+07
 sigma_tot counter=168 i=7 t=4.10e-02 per=1.25e+01 cost=1.96e+06 flops=4.77e+07
 total GEMM cost=1.14e+07 flops=3.48e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.99e-04,1.96e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.96e-03 t_reduction=1.88e-04 tot=2.34e-03 ---
 sigma counter=169 i=0 t=2.44e-04 per=1.25e+01 cost=7.01e+03 flops=2.87e+07
 sigma counter=169 i=1 t=2.53e-04 per=1.29e+01 cost=6.99e+03 flops=2.76e+07
 sigma counter=169 i=2 t=2.30e-04 per=1.18e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=169 i=3 t=2.45e-04 per=1.25e+01 cost=6.78e+03 flops=2.77e+07
 sigma counter=169 i=4 t=2.45e-04 per=1.25e+01 cost=1.89e+04 flops=7.71e+07
 sigma counter=169 i=5 t=2.53e-04 per=1.29e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=169 i=6 t=2.46e-04 per=1.26e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=169 i=7 t=2.39e-04 per=1.22e+01 cost=6.81e+03 flops=2.85e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=3.39e-02 t_gemm=3.30e-01 t_reduction=3.26e-02 tot=3.96e-01 ---
 sigma_tot counter=169 i=0 t=4.04e-02 per=1.22e+01 cost=1.01e+06 flops=2.50e+07
 sigma_tot counter=169 i=1 t=4.15e-02 per=1.26e+01 cost=1.02e+06 flops=2.46e+07
 sigma_tot counter=169 i=2 t=4.01e-02 per=1.22e+01 cost=1.02e+06 flops=2.54e+07
 sigma_tot counter=169 i=3 t=4.05e-02 per=1.23e+01 cost=1.02e+06 flops=2.52e+07
 sigma_tot counter=169 i=4 t=4.07e-02 per=1.23e+01 cost=1.73e+06 flops=4.26e+07
 sigma_tot counter=169 i=5 t=4.13e-02 per=1.25e+01 cost=1.73e+06 flops=4.19e+07
 sigma_tot counter=169 i=6 t=4.39e-02 per=1.33e+01 cost=1.97e+06 flops=4.49e+07
 sigma_tot counter=169 i=7 t=4.12e-02 per=1.25e+01 cost=1.96e+06 flops=4.76e+07
 total GEMM cost=1.15e+07 flops=3.48e+07
    5   0 -      -2.654516818921  -7.98e-07   4.45e-04    6    10   2.46e-02  2.46e-03
    5   1 -      -2.436977409925  -1.24e-07   2.05e-04    6    10   2.46e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.98e-04,1.96e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.96e-03 t_reduction=1.88e-04 tot=2.35e-03 ---
 sigma counter=170 i=0 t=2.38e-04 per=1.21e+01 cost=7.01e+03 flops=2.94e+07
 sigma counter=170 i=1 t=2.50e-04 per=1.27e+01 cost=6.99e+03 flops=2.80e+07
 sigma counter=170 i=2 t=2.37e-04 per=1.21e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=170 i=3 t=2.46e-04 per=1.25e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=170 i=4 t=2.59e-04 per=1.32e+01 cost=1.89e+04 flops=7.30e+07
 sigma counter=170 i=5 t=2.53e-04 per=1.29e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=170 i=6 t=2.44e-04 per=1.24e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=170 i=7 t=2.34e-04 per=1.19e+01 cost=6.81e+03 flops=2.91e+07
 total GEMM cost=7.90e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=3.41e-02 t_gemm=3.31e-01 t_reduction=3.28e-02 tot=3.98e-01 ---
 sigma_tot counter=170 i=0 t=4.06e-02 per=1.22e+01 cost=1.02e+06 flops=2.50e+07
 sigma_tot counter=170 i=1 t=4.18e-02 per=1.26e+01 cost=1.03e+06 flops=2.46e+07
 sigma_tot counter=170 i=2 t=4.03e-02 per=1.22e+01 cost=1.02e+06 flops=2.54e+07
 sigma_tot counter=170 i=3 t=4.07e-02 per=1.23e+01 cost=1.03e+06 flops=2.53e+07
 sigma_tot counter=170 i=4 t=4.09e-02 per=1.23e+01 cost=1.75e+06 flops=4.28e+07
 sigma_tot counter=170 i=5 t=4.16e-02 per=1.25e+01 cost=1.75e+06 flops=4.21e+07
 sigma_tot counter=170 i=6 t=4.41e-02 per=1.33e+01 cost=1.98e+06 flops=4.48e+07
 sigma_tot counter=170 i=7 t=4.15e-02 per=1.25e+01 cost=1.97e+06 flops=4.75e+07
 total GEMM cost=1.15e+07 flops=3.48e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.95e-04,1.96e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=1.95e-04 t_gemm=1.96e-03 t_reduction=1.89e-04 tot=2.34e-03 ---
 sigma counter=171 i=0 t=2.36e-04 per=1.21e+01 cost=7.01e+03 flops=2.97e+07
 sigma counter=171 i=1 t=2.48e-04 per=1.27e+01 cost=6.99e+03 flops=2.82e+07
 sigma counter=171 i=2 t=2.33e-04 per=1.19e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=171 i=3 t=2.43e-04 per=1.24e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=171 i=4 t=2.52e-04 per=1.29e+01 cost=1.89e+04 flops=7.50e+07
 sigma counter=171 i=5 t=2.63e-04 per=1.34e+01 cost=1.89e+04 flops=7.18e+07
 sigma counter=171 i=6 t=2.51e-04 per=1.28e+01 cost=6.78e+03 flops=2.70e+07
 sigma counter=171 i=7 t=2.31e-04 per=1.18e+01 cost=6.81e+03 flops=2.95e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=3.43e-02 t_gemm=3.33e-01 t_reduction=3.30e-02 tot=4.01e-01 ---
 sigma_tot counter=171 i=0 t=4.08e-02 per=1.22e+01 cost=1.02e+06 flops=2.50e+07
 sigma_tot counter=171 i=1 t=4.20e-02 per=1.26e+01 cost=1.03e+06 flops=2.46e+07
 sigma_tot counter=171 i=2 t=4.05e-02 per=1.22e+01 cost=1.03e+06 flops=2.54e+07
 sigma_tot counter=171 i=3 t=4.10e-02 per=1.23e+01 cost=1.04e+06 flops=2.53e+07
 sigma_tot counter=171 i=4 t=4.12e-02 per=1.24e+01 cost=1.77e+06 flops=4.30e+07
 sigma_tot counter=171 i=5 t=4.19e-02 per=1.26e+01 cost=1.77e+06 flops=4.23e+07
 sigma_tot counter=171 i=6 t=4.44e-02 per=1.33e+01 cost=1.98e+06 flops=4.47e+07
 sigma_tot counter=171 i=7 t=4.17e-02 per=1.25e+01 cost=1.98e+06 flops=4.74e+07
 total GEMM cost=1.16e+07 flops=3.49e+07
    6   0 -      -2.654516950786  -1.32e-07   1.57e-04    6    12   2.95e-02  2.46e-03
    6   1 +      -2.436977447171  -3.72e-08   7.42e-05    6    12   2.95e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.02e-04,1.93e-03,1.94e-04 cost=7.90e+04 flops[gemm]=4.10e+07
--- TIMING FOR sigma : t_inter=2.02e-04 t_gemm=1.93e-03 t_reduction=1.94e-04 tot=2.32e-03 ---
 sigma counter=172 i=0 t=2.35e-04 per=1.22e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=172 i=1 t=2.47e-04 per=1.28e+01 cost=6.99e+03 flops=2.83e+07
 sigma counter=172 i=2 t=2.30e-04 per=1.19e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=172 i=3 t=2.35e-04 per=1.22e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=172 i=4 t=2.46e-04 per=1.28e+01 cost=1.89e+04 flops=7.68e+07
 sigma counter=172 i=5 t=2.49e-04 per=1.29e+01 cost=1.89e+04 flops=7.59e+07
 sigma counter=172 i=6 t=2.46e-04 per=1.28e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=172 i=7 t=2.40e-04 per=1.24e+01 cost=6.81e+03 flops=2.84e+07
 total GEMM cost=7.90e+04 flops=4.10e+07
--- TIMING FOR sigma_tot : t_inter=3.45e-02 t_gemm=3.35e-01 t_reduction=3.32e-02 tot=4.03e-01 ---
 sigma_tot counter=172 i=0 t=4.11e-02 per=1.22e+01 cost=1.03e+06 flops=2.51e+07
 sigma_tot counter=172 i=1 t=4.22e-02 per=1.26e+01 cost=1.04e+06 flops=2.46e+07
 sigma_tot counter=172 i=2 t=4.08e-02 per=1.22e+01 cost=1.04e+06 flops=2.54e+07
 sigma_tot counter=172 i=3 t=4.12e-02 per=1.23e+01 cost=1.04e+06 flops=2.53e+07
 sigma_tot counter=172 i=4 t=4.14e-02 per=1.24e+01 cost=1.79e+06 flops=4.32e+07
 sigma_tot counter=172 i=5 t=4.21e-02 per=1.26e+01 cost=1.79e+06 flops=4.25e+07
 sigma_tot counter=172 i=6 t=4.46e-02 per=1.33e+01 cost=1.99e+06 flops=4.46e+07
 sigma_tot counter=172 i=7 t=4.19e-02 per=1.25e+01 cost=1.98e+06 flops=4.73e+07
 total GEMM cost=1.17e+07 flops=3.49e+07
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   3.20e-02  2.46e-03
    7   1 +      -2.436977447171  -4.44e-16   7.42e-05    5    13   3.20e-02  2.46e-03
TIMING for Davidson : 3.20e-02  T(cal/comm/rest)=3.17e-02,6.85e-07,3.26e-04
optimized energies: isweep=4 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=4 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.982e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000526 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.67e-05,0.00022,0.000249 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8e-06,0.00108,0.000189 cost=2.78e+04 flops[gemm]=2.56e+07
--- TIMING FOR renorm : t_inter=8e-06 t_gemm=0.00108 t_reduction=0.000189 tot=0.00128 ---
 renorm counter=17 i=0 t=0.000219 per=20.2 cost=2.19e+03 flops=1e+07
 renorm counter=17 i=1 t=0.000207 per=19.1 cost=2.85e+03 flops=1.38e+07
 renorm counter=17 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=17 i=3 t=1e-06 per=0.0923 cost=0 flops=0
 renorm counter=17 i=4 t=0.000201 per=18.6 cost=2.11e+03 flops=1.05e+07
 renorm counter=17 i=5 t=0.000206 per=19 cost=2.94e+03 flops=1.43e+07
 renorm counter=17 i=6 t=0.000249 per=23 cost=1.77e+04 flops=7.11e+07
 total GEMM cost=2.78e+04 flops=2.57e+07
--- TIMING FOR renorm_tot : t_inter=0.00156 t_gemm=0.0184 t_reduction=0.00322 tot=0.0232 ---
 renorm_tot counter=17 i=0 t=0.00361 per=19.6 cost=6.23e+04 flops=1.73e+07
 renorm_tot counter=17 i=1 t=0.00362 per=19.7 cost=9.06e+04 flops=2.5e+07
 renorm_tot counter=17 i=2 t=0.00164 per=8.92 cost=6.14e+04 flops=3.74e+07
 renorm_tot counter=17 i=3 t=0.0017 per=9.23 cost=1.07e+05 flops=6.3e+07
 renorm_tot counter=17 i=4 t=0.00186 per=10.1 cost=6.36e+04 flops=3.42e+07
 renorm_tot counter=17 i=5 t=0.00191 per=10.4 cost=1.09e+05 flops=5.73e+07
 renorm_tot counter=17 i=6 t=0.00406 per=22.1 cost=7.47e+05 flops=1.84e+08
 total GEMM cost=1.24e+06 flops=6.75e+07
check ||H-H.dagger||=0.00e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=8.9e-05,0.0025,8.5e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(1,0) size=1.03e-05GB T[save](info/data/tot)=6.43e-05,4.71e-05,0.000111 speed=0.0928GB/s disk[used]=9.88e-05GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
##### time_local: 3.96e-02 S #####
 T(fetch) = 7.03e-05 S  per = 0.18  per(accum) = 0.18
 T(hdiag) = 7.01e-05 S  per = 0.18  per(accum) = 0.35
 T(dvdsn) = 3.61e-02 S  per =   91  per(accum) = 92
 T(decim) = 7.78e-05 S  per =  0.2  per(accum) = 92
 T(guess) = 7.96e-05 S  per =  0.2  per(accum) = 92
 T(renrm) = 2.64e-03 S  per =  6.7  per(accum) = 99
 T(save ) = 5.68e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.60e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 3.97e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 2.32e-04 S  per = 0.65  per(accum) = 0.76
 T(hintermediate init           ) = 2.16e-05 S  per = 0.06  per(accum) = 0.82
 T(hintermediates memcpy cpu2gpu) = 3.56e-06 S  per = 0.0099  per(accum) = 0.83
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =  6.3  per(accum) = 7.1
 T(hmmtasks init                ) = 1.40e-03 S  per =  3.9  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 3.17e-02 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 6.85e-07 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.26e-04 S  per = 0.91  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.60e-03 S
 T(qops init                    ) = 8.87e-05 S  per =  3.4  per(accum) = 3.4
 T(qops_dict memcpy cpu2gpu     ) = 2.82e-05 S  per =  1.1  per(accum) = 4.5
 T(symbolic_formulae_renorm     ) = 2.03e-04 S  per =  7.8  per(accum) = 12
 T(rintermediate init           ) = 9.59e-06 S  per = 0.37  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.75e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.38e-04 S  per =   21  per(accum) = 34
 T(rmmtasks init                ) = 3.31e-04 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 8.37e-06 S  per = 0.32  per(accum) = 47
 T(preprocess_renorm_batchGPU   ) = 1.35e-03 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.77e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.48e-06 S  per = 0.33  per(accum) = 1e+02
##### time_sweep: 3.96e-02 S #####
 T(fetch) = 7.03e-05 S  per = 0.18  per(accum) = 0.18
 T(hdiag) = 7.01e-05 S  per = 0.18  per(accum) = 0.35
 T(dvdsn) = 3.61e-02 S  per =   91  per(accum) = 92
 T(decim) = 7.78e-05 S  per =  0.2  per(accum) = 92
 T(guess) = 7.96e-05 S  per =  0.2  per(accum) = 92
 T(renrm) = 2.64e-03 S  per =  6.7  per(accum) = 99
 T(save ) = 5.68e-04 S  per =  1.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.60e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 3.97e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 2.32e-04 S  per = 0.65  per(accum) = 0.76
 T(hintermediate init           ) = 2.16e-05 S  per = 0.06  per(accum) = 0.82
 T(hintermediates memcpy cpu2gpu) = 3.56e-06 S  per = 0.0099  per(accum) = 0.83
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =  6.3  per(accum) = 7.1
 T(hmmtasks init                ) = 1.40e-03 S  per =  3.9  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 3.17e-02 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 6.85e-07 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.26e-04 S  per = 0.91  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.60e-03 S
 T(qops init                    ) = 8.87e-05 S  per =  3.4  per(accum) = 3.4
 T(qops_dict memcpy cpu2gpu     ) = 2.82e-05 S  per =  1.1  per(accum) = 4.5
 T(symbolic_formulae_renorm     ) = 2.03e-04 S  per =  7.8  per(accum) = 12
 T(rintermediate init           ) = 9.59e-06 S  per = 0.37  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.75e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.38e-04 S  per =   21  per(accum) = 34
 T(rmmtasks init                ) = 3.31e-04 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 8.37e-06 S  per = 0.32  per(accum) = 47
 T(preprocess_renorm_batchGPU   ) = 1.35e-03 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.77e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.48e-06 S  per = 0.33  per(accum) = 1e+02
##### time_global: 5.67e-01 S #####
 T(fetch) = 3.82e-03 S  per = 0.67  per(accum) = 0.67
 T(hdiag) = 1.35e-03 S  per = 0.24  per(accum) = 0.91
 T(dvdsn) = 4.99e-01 S  per =   88  per(accum) = 89
 T(decim) = 4.07e-03 S  per = 0.72  per(accum) = 90
 T(guess) = 1.45e-03 S  per = 0.26  per(accum) = 90
 T(renrm) = 4.77e-02 S  per =  8.4  per(accum) = 98
 T(save ) = 9.77e-03 S  per =  1.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.96e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 7.08e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 4.33e-03 S  per = 0.87  per(accum) = 1
 T(hintermediate init           ) = 4.29e-04 S  per = 0.087  per(accum) = 1.1
 T(hintermediates memcpy cpu2gpu) = 6.96e-05 S  per = 0.014  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 3.88e-02 S  per =  7.8  per(accum) = 8.9
 T(hmmtasks init                ) = 2.42e-02 S  per =  4.9  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 4.22e-01 S  per =   85  per(accum) = 99
 T(dvdson solver [communication]) = 1.10e-05 S  per = 0.0022  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.78e-03 S  per = 0.96  per(accum) = 1e+02
Detailed decomposition of T(renrm): 4.68e-02 S
 T(qops init                    ) = 1.92e-03 S  per =  4.1  per(accum) = 4.1
 T(qops_dict memcpy cpu2gpu     ) = 5.88e-04 S  per =  1.3  per(accum) = 5.4
 T(symbolic_formulae_renorm     ) = 3.54e-03 S  per =  7.6  per(accum) = 13
 T(rintermediate init           ) = 2.90e-04 S  per = 0.62  per(accum) = 14
 T(rintermediates memcpy cpu2gpu) = 8.78e-05 S  per = 0.19  per(accum) = 14
 T(preprocess_formulae_Rlist2   ) = 9.24e-03 S  per =   20  per(accum) = 33
 T(rmmtasks init                ) = 5.84e-03 S  per =   12  per(accum) = 46
 T(qops memset                  ) = 1.49e-04 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 2.45e-02 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 4.92e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.55e-04 S  per = 0.33  per(accum) = 1e+02

isweep=4 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.226e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x448c82c0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.189e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.849e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00224 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.18e-05,0.000958,0.00123 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.4e-05,0.000206,0.00193,0.000189 cost=7.9e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=0.000205 t_gemm=0.00193 t_reduction=0.000189 tot=0.00233 ---
 sigma counter=173 i=0 t=0.000239 per=12.4 cost=6.81e+03 flops=2.85e+07
 sigma counter=173 i=1 t=0.00024 per=12.4 cost=6.78e+03 flops=2.83e+07
 sigma counter=173 i=2 t=0.000231 per=12 cost=7.01e+03 flops=3.03e+07
 sigma counter=173 i=3 t=0.000238 per=12.3 cost=6.99e+03 flops=2.94e+07
 sigma counter=173 i=4 t=0.00023 per=11.9 cost=6.81e+03 flops=2.96e+07
 sigma counter=173 i=5 t=0.00024 per=12.4 cost=6.78e+03 flops=2.83e+07
 sigma counter=173 i=6 t=0.000268 per=13.9 cost=1.89e+04 flops=7.05e+07
 sigma counter=173 i=7 t=0.000246 per=12.7 cost=1.89e+04 flops=7.68e+07
 total GEMM cost=7.9e+04 flops=4.09e+07
--- TIMING FOR sigma_tot : t_inter=0.0347 t_gemm=0.337 t_reduction=0.0333 tot=0.405 ---
 sigma_tot counter=173 i=0 t=0.0413 per=12.2 cost=1.04e+06 flops=2.51e+07
 sigma_tot counter=173 i=1 t=0.0425 per=12.6 cost=1.05e+06 flops=2.46e+07
 sigma_tot counter=173 i=2 t=0.041 per=12.2 cost=1.04e+06 flops=2.55e+07
 sigma_tot counter=173 i=3 t=0.0414 per=12.3 cost=1.05e+06 flops=2.53e+07
 sigma_tot counter=173 i=4 t=0.0417 per=12.4 cost=1.8e+06 flops=4.32e+07
 sigma_tot counter=173 i=5 t=0.0423 per=12.6 cost=1.79e+06 flops=4.24e+07
 sigma_tot counter=173 i=6 t=0.0449 per=13.3 cost=2.01e+06 flops=4.48e+07
 sigma_tot counter=173 i=7 t=0.0422 per=12.5 cost=2e+06 flops=4.75e+07
 total GEMM cost=1.18e+07 flops=3.49e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.7e-05,0.000199,0.00195,0.000189 cost=7.9e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0.000199 t_gemm=0.00195 t_reduction=0.000189 tot=0.00233 ---
 sigma counter=174 i=0 t=0.000235 per=12.1 cost=6.81e+03 flops=2.9e+07
 sigma counter=174 i=1 t=0.000242 per=12.4 cost=6.78e+03 flops=2.8e+07
 sigma counter=174 i=2 t=0.000232 per=11.9 cost=7.01e+03 flops=3.02e+07
 sigma counter=174 i=3 t=0.000237 per=12.2 cost=6.99e+03 flops=2.95e+07
 sigma counter=174 i=4 t=0.00024 per=12.3 cost=6.81e+03 flops=2.84e+07
 sigma counter=174 i=5 t=0.000243 per=12.5 cost=6.78e+03 flops=2.79e+07
 sigma counter=174 i=6 t=0.000267 per=13.7 cost=1.89e+04 flops=7.08e+07
 sigma counter=174 i=7 t=0.00025 per=12.8 cost=1.89e+04 flops=7.56e+07
 total GEMM cost=7.9e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0.0349 t_gemm=0.339 t_reduction=0.0335 tot=0.408 ---
 sigma_tot counter=174 i=0 t=0.0415 per=12.2 cost=1.04e+06 flops=2.51e+07
 sigma_tot counter=174 i=1 t=0.0427 per=12.6 cost=1.05e+06 flops=2.47e+07
 sigma_tot counter=174 i=2 t=0.0412 per=12.2 cost=1.05e+06 flops=2.55e+07
 sigma_tot counter=174 i=3 t=0.0417 per=12.3 cost=1.06e+06 flops=2.53e+07
 sigma_tot counter=174 i=4 t=0.0419 per=12.4 cost=1.8e+06 flops=4.31e+07
 sigma_tot counter=174 i=5 t=0.0426 per=12.6 cost=1.8e+06 flops=4.23e+07
 sigma_tot counter=174 i=6 t=0.0451 per=13.3 cost=2.03e+06 flops=4.49e+07
 sigma_tot counter=174 i=7 t=0.0424 per=12.5 cost=2.02e+06 flops=4.76e+07
 total GEMM cost=1.19e+07 flops=3.5e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   4.91e-03  2.45e-03
    1   1 +      -2.436977447171  -1.00e+03   7.42e-05    2     2   4.91e-03  2.45e-03
TIMING for Davidson : 4.92e-03  T(cal/comm/rest)=4.88e-03,1.59e-07,4.22e-05
optimized energies: isweep=4 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=4 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep4_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.717e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 1.776e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=3.26e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Rlist : 0.000512 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.43e-05,0.00022,0.000247 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000932 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07,0.0009
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00018,0.00107,0.000186 cost=1.55e+05 flops[gemm]=1.45e+08
--- TIMING FOR renorm : t_inter=0.00018 t_gemm=0.00107 t_reduction=0.000185 tot=0.00143 ---
 renorm counter=18 i=0 t=0.000205 per=19.2 cost=8.1e+03 flops=3.95e+07
 renorm counter=18 i=1 t=0.000203 per=19.1 cost=8.36e+03 flops=4.12e+07
 renorm counter=18 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=18 i=3 t=1e-06 per=0.0939 cost=0 flops=0
 renorm counter=18 i=4 t=0.000201 per=18.9 cost=1.65e+04 flops=8.2e+07
 renorm counter=18 i=5 t=0.000215 per=20.2 cost=2.89e+04 flops=1.35e+08
 renorm counter=18 i=6 t=0.00024 per=22.5 cost=9.32e+04 flops=3.88e+08
 total GEMM cost=1.55e+05 flops=1.46e+08
--- TIMING FOR renorm_tot : t_inter=0.00174 t_gemm=0.0195 t_reduction=0.0034 tot=0.0246 ---
 renorm_tot counter=18 i=0 t=0.00381 per=19.6 cost=7.04e+04 flops=1.84e+07
 renorm_tot counter=18 i=1 t=0.00383 per=19.7 cost=9.9e+04 flops=2.59e+07
 renorm_tot counter=18 i=2 t=0.00164 per=8.44 cost=6.14e+04 flops=3.74e+07
 renorm_tot counter=18 i=3 t=0.0017 per=8.73 cost=1.07e+05 flops=6.3e+07
 renorm_tot counter=18 i=4 t=0.00206 per=10.6 cost=8.01e+04 flops=3.88e+07
 renorm_tot counter=18 i=5 t=0.00212 per=10.9 cost=1.38e+05 flops=6.51e+07
 renorm_tot counter=18 i=6 t=0.0043 per=22.1 cost=8.4e+05 flops=1.95e+08
 total GEMM cost=1.4e+06 flops=7.17e+07
check ||H-H.dagger||=9.16e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0027 S T(init/kernel/comm)=7.9e-05,0.0027,8.4e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(2,0) size=1.94e-05GB T[save](info/data/tot)=6.11e-05,5.3e-05,0.000114 speed=0.17GB/s disk[used]=0.0001GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
##### time_local: 1.32e-02 S #####
 T(fetch) = 2.94e-04 S  per =  2.2  per(accum) = 2.2
 T(hdiag) = 6.79e-05 S  per = 0.52  per(accum) = 2.8
 T(dvdsn) = 9.03e-03 S  per =   69  per(accum) = 71
 T(decim) = 3.22e-04 S  per =  2.4  per(accum) = 74
 T(guess) = 7.31e-05 S  per = 0.56  per(accum) = 74
 T(renrm) = 2.80e-03 S  per =   21  per(accum) = 96
 T(save ) = 5.81e-04 S  per =  4.4  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.85e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 3.89e-05 S  per = 0.44  per(accum) = 0.44
 T(symbolic_formulae_twodot     ) = 2.23e-04 S  per =  2.5  per(accum) = 3
 T(hintermediate init           ) = 2.13e-05 S  per = 0.24  per(accum) = 3.2
 T(hintermediates memcpy cpu2gpu) = 3.56e-06 S  per = 0.04  per(accum) = 3.2
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =   25  per(accum) = 29
 T(hmmtasks init                ) = 1.39e-03 S  per =   16  per(accum) = 44
 T(dvdson solver [Hx_batchGPU]  ) = 4.88e-03 S  per =   55  per(accum) = 1e+02
 T(dvdson solver [communication]) = 1.59e-07 S  per = 0.0018  per(accum) = 1e+02
 T(dvdson solver [rest part]    ) = 4.22e-05 S  per = 0.48  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.74e-03 S
 T(qops init                    ) = 7.94e-05 S  per =  2.9  per(accum) = 2.9
 T(qops_dict memcpy cpu2gpu     ) = 3.70e-05 S  per =  1.3  per(accum) = 4.2
 T(symbolic_formulae_renorm     ) = 1.76e-04 S  per =  6.4  per(accum) = 11
 T(rintermediate init           ) = 2.06e-05 S  per = 0.75  per(accum) = 11
 T(rintermediates memcpy cpu2gpu) = 4.33e-06 S  per = 0.16  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 5.21e-04 S  per =   19  per(accum) = 31
 T(rmmtasks init                ) = 3.61e-04 S  per =   13  per(accum) = 44
 T(qops memset                  ) = 8.91e-06 S  per = 0.32  per(accum) = 44
 T(preprocess_renorm_batchGPU   ) = 1.50e-03 S  per =   55  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.72e-05 S  per = 0.99  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.41e-06 S  per = 0.31  per(accum) = 1e+02
##### time_sweep: 5.28e-02 S #####
 T(fetch) = 3.65e-04 S  per = 0.69  per(accum) = 0.69
 T(hdiag) = 1.38e-04 S  per = 0.26  per(accum) = 0.95
 T(dvdsn) = 4.52e-02 S  per =   86  per(accum) = 86
 T(decim) = 4.00e-04 S  per = 0.76  per(accum) = 87
 T(guess) = 1.53e-04 S  per = 0.29  per(accum) = 88
 T(renrm) = 5.44e-03 S  per =   10  per(accum) = 98
 T(save ) = 1.15e-03 S  per =  2.2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.48e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 7.87e-05 S  per = 0.18  per(accum) = 0.18
 T(symbolic_formulae_twodot     ) = 4.56e-04 S  per =    1  per(accum) = 1.2
 T(hintermediate init           ) = 4.29e-05 S  per = 0.096  per(accum) = 1.3
 T(hintermediates memcpy cpu2gpu) = 7.12e-06 S  per = 0.016  per(accum) = 1.3
 T(preprocess_hformulae_Hxlist2 ) = 4.50e-03 S  per =   10  per(accum) = 11
 T(hmmtasks init                ) = 2.79e-03 S  per =  6.2  per(accum) = 18
 T(dvdson solver [Hx_batchGPU]  ) = 3.66e-02 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 8.44e-07 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.69e-04 S  per = 0.82  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.34e-03 S
 T(qops init                    ) = 1.68e-04 S  per =  3.1  per(accum) = 3.1
 T(qops_dict memcpy cpu2gpu     ) = 6.52e-05 S  per =  1.2  per(accum) = 4.4
 T(symbolic_formulae_renorm     ) = 3.79e-04 S  per =  7.1  per(accum) = 11
 T(rintermediate init           ) = 3.01e-05 S  per = 0.56  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 9.09e-06 S  per = 0.17  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 1.06e-03 S  per =   20  per(accum) = 32
 T(rmmtasks init                ) = 6.93e-04 S  per =   13  per(accum) = 45
 T(qops memset                  ) = 1.73e-05 S  per = 0.32  per(accum) = 45
 T(preprocess_renorm_batchGPU   ) = 2.85e-03 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.50e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.69e-05 S  per = 0.32  per(accum) = 1e+02
##### time_global: 5.81e-01 S #####
 T(fetch) = 4.12e-03 S  per = 0.71  per(accum) = 0.71
 T(hdiag) = 1.42e-03 S  per = 0.24  per(accum) = 0.95
 T(dvdsn) = 5.08e-01 S  per =   88  per(accum) = 89
 T(decim) = 4.40e-03 S  per = 0.76  per(accum) = 89
 T(guess) = 1.52e-03 S  per = 0.26  per(accum) = 90
 T(renrm) = 5.05e-02 S  per =  8.7  per(accum) = 98
 T(save ) = 1.03e-02 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 5.05e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 7.47e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 4.56e-03 S  per =  0.9  per(accum) = 1.1
 T(hintermediate init           ) = 4.51e-04 S  per = 0.089  per(accum) = 1.1
 T(hintermediates memcpy cpu2gpu) = 7.31e-05 S  per = 0.014  per(accum) = 1.2
 T(preprocess_hformulae_Hxlist2 ) = 4.11e-02 S  per =  8.1  per(accum) = 9.3
 T(hmmtasks init                ) = 2.56e-02 S  per =  5.1  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 4.27e-01 S  per =   85  per(accum) = 99
 T(dvdson solver [communication]) = 1.12e-05 S  per = 0.0022  per(accum) = 99
 T(dvdson solver [rest part]    ) = 4.82e-03 S  per = 0.96  per(accum) = 1e+02
Detailed decomposition of T(renrm): 4.96e-02 S
 T(qops init                    ) = 2.00e-03 S  per =    4  per(accum) = 4
 T(qops_dict memcpy cpu2gpu     ) = 6.25e-04 S  per =  1.3  per(accum) = 5.3
 T(symbolic_formulae_renorm     ) = 3.72e-03 S  per =  7.5  per(accum) = 13
 T(rintermediate init           ) = 3.11e-04 S  per = 0.63  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 9.21e-05 S  per = 0.19  per(accum) = 14
 T(preprocess_formulae_Rlist2   ) = 9.76e-03 S  per =   20  per(accum) = 33
 T(rmmtasks init                ) = 6.20e-03 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 1.58e-04 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 2.60e-02 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.19e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.63e-04 S  per = 0.33  per(accum) = 1e+02

isweep=4 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.042e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=357:0.00272MB:2.66e-06GB
===== CPUmem(GB): tot=3.56e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44952550
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.250e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.842e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00223 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.21e-05,0.00096,0.00122 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=5.05e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.5e-05,0.000205,0.00193,0.000193 cost=7.9e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=0.000205 t_gemm=0.00193 t_reduction=0.000193 tot=0.00233 ---
 sigma counter=175 i=0 t=0.000238 per=12.3 cost=6.81e+03 flops=2.86e+07
 sigma counter=175 i=1 t=0.000239 per=12.4 cost=6.78e+03 flops=2.84e+07
 sigma counter=175 i=2 t=0.000235 per=12.2 cost=7.01e+03 flops=2.98e+07
 sigma counter=175 i=3 t=0.000247 per=12.8 cost=6.99e+03 flops=2.83e+07
 sigma counter=175 i=4 t=0.000234 per=12.1 cost=6.81e+03 flops=2.91e+07
 sigma counter=175 i=5 t=0.000235 per=12.2 cost=6.78e+03 flops=2.89e+07
 sigma counter=175 i=6 t=0.00026 per=13.4 cost=1.89e+04 flops=7.27e+07
 sigma counter=175 i=7 t=0.000246 per=12.7 cost=1.89e+04 flops=7.68e+07
 total GEMM cost=7.9e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=0.0351 t_gemm=0.341 t_reduction=0.0337 tot=0.41 ---
 sigma_tot counter=175 i=0 t=0.0418 per=12.2 cost=1.05e+06 flops=2.51e+07
 sigma_tot counter=175 i=1 t=0.043 per=12.6 cost=1.06e+06 flops=2.47e+07
 sigma_tot counter=175 i=2 t=0.0415 per=12.2 cost=1.06e+06 flops=2.55e+07
 sigma_tot counter=175 i=3 t=0.0419 per=12.3 cost=1.06e+06 flops=2.54e+07
 sigma_tot counter=175 i=4 t=0.0421 per=12.4 cost=1.81e+06 flops=4.3e+07
 sigma_tot counter=175 i=5 t=0.0428 per=12.6 cost=1.81e+06 flops=4.22e+07
 sigma_tot counter=175 i=6 t=0.0454 per=13.3 cost=2.05e+06 flops=4.51e+07
 sigma_tot counter=175 i=7 t=0.0427 per=12.5 cost=2.04e+06 flops=4.78e+07
 total GEMM cost=1.19e+07 flops=3.5e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.6e-05,0.000197,0.00194,0.000189 cost=7.9e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=0.000197 t_gemm=0.00194 t_reduction=0.000189 tot=0.00233 ---
 sigma counter=176 i=0 t=0.000235 per=12.1 cost=6.81e+03 flops=2.9e+07
 sigma counter=176 i=1 t=0.000256 per=13.2 cost=6.78e+03 flops=2.65e+07
 sigma counter=176 i=2 t=0.000234 per=12.1 cost=7.01e+03 flops=2.99e+07
 sigma counter=176 i=3 t=0.000237 per=12.2 cost=6.99e+03 flops=2.95e+07
 sigma counter=176 i=4 t=0.00023 per=11.9 cost=6.81e+03 flops=2.96e+07
 sigma counter=176 i=5 t=0.000236 per=12.2 cost=6.78e+03 flops=2.87e+07
 sigma counter=176 i=6 t=0.000259 per=13.4 cost=1.89e+04 flops=7.3e+07
 sigma counter=176 i=7 t=0.000253 per=13 cost=1.89e+04 flops=7.47e+07
 total GEMM cost=7.9e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=0.0353 t_gemm=0.343 t_reduction=0.0339 tot=0.412 ---
 sigma_tot counter=176 i=0 t=0.042 per=12.2 cost=1.06e+06 flops=2.52e+07
 sigma_tot counter=176 i=1 t=0.0432 per=12.6 cost=1.07e+06 flops=2.47e+07
 sigma_tot counter=176 i=2 t=0.0417 per=12.2 cost=1.06e+06 flops=2.55e+07
 sigma_tot counter=176 i=3 t=0.0422 per=12.3 cost=1.07e+06 flops=2.54e+07
 sigma_tot counter=176 i=4 t=0.0424 per=12.3 cost=1.82e+06 flops=4.29e+07
 sigma_tot counter=176 i=5 t=0.0431 per=12.5 cost=1.81e+06 flops=4.21e+07
 sigma_tot counter=176 i=6 t=0.0457 per=13.3 cost=2.07e+06 flops=4.53e+07
 sigma_tot counter=176 i=7 t=0.0429 per=12.5 cost=2.06e+06 flops=4.8e+07
 total GEMM cost=1.2e+07 flops=3.5e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592  -1.00e+03   7.01e-02    2     2   4.90e-03  2.45e-03
    1   1 -      -2.436094100141  -1.00e+03   4.92e-02    2     2   4.90e-03  2.45e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.80e-05,2.00e-04,1.94e-03,1.93e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=2.00e-04 t_gemm=1.94e-03 t_reduction=1.93e-04 tot=2.33e-03 ---
 sigma counter=177 i=0 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=177 i=1 t=2.42e-04 per=1.25e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=177 i=2 t=2.35e-04 per=1.21e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=177 i=3 t=2.34e-04 per=1.21e+01 cost=6.99e+03 flops=2.99e+07
 sigma counter=177 i=4 t=2.33e-04 per=1.20e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=177 i=5 t=2.34e-04 per=1.21e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=177 i=6 t=2.69e-04 per=1.39e+01 cost=1.89e+04 flops=7.02e+07
 sigma counter=177 i=7 t=2.54e-04 per=1.31e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=3.55e-02 t_gemm=3.45e-01 t_reduction=3.41e-02 tot=4.15e-01 ---
 sigma_tot counter=177 i=0 t=4.22e-02 per=1.22e+01 cost=1.06e+06 flops=2.52e+07
 sigma_tot counter=177 i=1 t=4.35e-02 per=1.26e+01 cost=1.07e+06 flops=2.47e+07
 sigma_tot counter=177 i=2 t=4.19e-02 per=1.22e+01 cost=1.07e+06 flops=2.56e+07
 sigma_tot counter=177 i=3 t=4.24e-02 per=1.23e+01 cost=1.08e+06 flops=2.54e+07
 sigma_tot counter=177 i=4 t=4.26e-02 per=1.23e+01 cost=1.83e+06 flops=4.28e+07
 sigma_tot counter=177 i=5 t=4.33e-02 per=1.25e+01 cost=1.82e+06 flops=4.21e+07
 sigma_tot counter=177 i=6 t=4.59e-02 per=1.33e+01 cost=2.09e+06 flops=4.54e+07
 sigma_tot counter=177 i=7 t=4.32e-02 per=1.25e+01 cost=2.08e+06 flops=4.81e+07
 total GEMM cost=1.21e+07 flops=3.51e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.98e-04,1.93e-03,1.90e-04 cost=7.90e+04 flops[gemm]=4.09e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.93e-03 t_reduction=1.90e-04 tot=2.32e-03 ---
 sigma counter=178 i=0 t=2.33e-04 per=1.21e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=178 i=1 t=2.46e-04 per=1.27e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=178 i=2 t=2.34e-04 per=1.21e+01 cost=7.01e+03 flops=2.99e+07
 sigma counter=178 i=3 t=2.37e-04 per=1.23e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=178 i=4 t=2.30e-04 per=1.19e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=178 i=5 t=2.36e-04 per=1.22e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=178 i=6 t=2.62e-04 per=1.36e+01 cost=1.89e+04 flops=7.21e+07
 sigma counter=178 i=7 t=2.55e-04 per=1.32e+01 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.90e+04 flops=4.09e+07
--- TIMING FOR sigma_tot : t_inter=3.57e-02 t_gemm=3.47e-01 t_reduction=3.43e-02 tot=4.17e-01 ---
 sigma_tot counter=178 i=0 t=4.25e-02 per=1.22e+01 cost=1.07e+06 flops=2.52e+07
 sigma_tot counter=178 i=1 t=4.37e-02 per=1.26e+01 cost=1.08e+06 flops=2.47e+07
 sigma_tot counter=178 i=2 t=4.22e-02 per=1.22e+01 cost=1.08e+06 flops=2.56e+07
 sigma_tot counter=178 i=3 t=4.26e-02 per=1.23e+01 cost=1.08e+06 flops=2.54e+07
 sigma_tot counter=178 i=4 t=4.28e-02 per=1.23e+01 cost=1.83e+06 flops=4.28e+07
 sigma_tot counter=178 i=5 t=4.35e-02 per=1.25e+01 cost=1.83e+06 flops=4.20e+07
 sigma_tot counter=178 i=6 t=4.62e-02 per=1.33e+01 cost=2.10e+06 flops=4.55e+07
 sigma_tot counter=178 i=7 t=4.34e-02 per=1.25e+01 cost=2.10e+06 flops=4.83e+07
 total GEMM cost=1.22e+07 flops=3.51e+07
    2   0 -      -2.654426863105  -1.84e-03   1.26e-02    4     4   9.81e-03  2.45e-03
    2   1 -      -2.436959129202  -8.65e-04   5.19e-03    4     4   9.81e-03  2.45e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.00e-05,2.01e-04,1.95e-03,1.94e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.95e-03 t_reduction=1.94e-04 tot=2.35e-03 ---
 sigma counter=179 i=0 t=2.36e-04 per=1.21e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=179 i=1 t=2.34e-04 per=1.20e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=179 i=2 t=2.41e-04 per=1.23e+01 cost=7.01e+03 flops=2.91e+07
 sigma counter=179 i=3 t=2.36e-04 per=1.21e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=179 i=4 t=2.42e-04 per=1.24e+01 cost=6.81e+03 flops=2.82e+07
 sigma counter=179 i=5 t=2.34e-04 per=1.20e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=179 i=6 t=2.72e-04 per=1.39e+01 cost=1.89e+04 flops=6.95e+07
 sigma counter=179 i=7 t=2.58e-04 per=1.32e+01 cost=1.89e+04 flops=7.32e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=3.59e-02 t_gemm=3.49e-01 t_reduction=3.45e-02 tot=4.19e-01 ---
 sigma_tot counter=179 i=0 t=4.27e-02 per=1.22e+01 cost=1.08e+06 flops=2.52e+07
 sigma_tot counter=179 i=1 t=4.39e-02 per=1.26e+01 cost=1.09e+06 flops=2.48e+07
 sigma_tot counter=179 i=2 t=4.24e-02 per=1.22e+01 cost=1.09e+06 flops=2.56e+07
 sigma_tot counter=179 i=3 t=4.29e-02 per=1.23e+01 cost=1.09e+06 flops=2.54e+07
 sigma_tot counter=179 i=4 t=4.31e-02 per=1.23e+01 cost=1.84e+06 flops=4.27e+07
 sigma_tot counter=179 i=5 t=4.38e-02 per=1.25e+01 cost=1.84e+06 flops=4.19e+07
 sigma_tot counter=179 i=6 t=4.65e-02 per=1.33e+01 cost=2.12e+06 flops=4.57e+07
 sigma_tot counter=179 i=7 t=4.37e-02 per=1.25e+01 cost=2.12e+06 flops=4.84e+07
 total GEMM cost=1.23e+07 flops=3.51e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,2.01e-04,1.96e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.96e-03 t_reduction=1.88e-04 tot=2.35e-03 ---
 sigma counter=180 i=0 t=2.41e-04 per=1.23e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=180 i=1 t=2.53e-04 per=1.29e+01 cost=6.78e+03 flops=2.68e+07
 sigma counter=180 i=2 t=2.42e-04 per=1.24e+01 cost=7.01e+03 flops=2.90e+07
 sigma counter=180 i=3 t=2.35e-04 per=1.20e+01 cost=6.99e+03 flops=2.97e+07
 sigma counter=180 i=4 t=2.37e-04 per=1.21e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=180 i=5 t=2.37e-04 per=1.21e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=180 i=6 t=2.68e-04 per=1.37e+01 cost=1.89e+04 flops=7.05e+07
 sigma counter=180 i=7 t=2.45e-04 per=1.25e+01 cost=1.89e+04 flops=7.71e+07
 total GEMM cost=7.90e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=3.61e-02 t_gemm=3.51e-01 t_reduction=3.47e-02 tot=4.22e-01 ---
 sigma_tot counter=180 i=0 t=4.30e-02 per=1.22e+01 cost=1.08e+06 flops=2.52e+07
 sigma_tot counter=180 i=1 t=4.42e-02 per=1.26e+01 cost=1.09e+06 flops=2.48e+07
 sigma_tot counter=180 i=2 t=4.27e-02 per=1.22e+01 cost=1.09e+06 flops=2.56e+07
 sigma_tot counter=180 i=3 t=4.31e-02 per=1.23e+01 cost=1.10e+06 flops=2.55e+07
 sigma_tot counter=180 i=4 t=4.33e-02 per=1.23e+01 cost=1.85e+06 flops=4.26e+07
 sigma_tot counter=180 i=5 t=4.40e-02 per=1.25e+01 cost=1.84e+06 flops=4.19e+07
 sigma_tot counter=180 i=6 t=4.67e-02 per=1.33e+01 cost=2.14e+06 flops=4.58e+07
 sigma_tot counter=180 i=7 t=4.39e-02 per=1.25e+01 cost=2.13e+06 flops=4.86e+07
 total GEMM cost=1.23e+07 flops=3.52e+07
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   1.48e-02  2.46e-03
    3   1 -      -2.436975259478  -1.61e-05   1.59e-03    6     6   1.48e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.97e-04,1.95e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=1.97e-04 t_gemm=1.95e-03 t_reduction=1.89e-04 tot=2.33e-03 ---
 sigma counter=181 i=0 t=2.33e-04 per=1.20e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=181 i=1 t=2.38e-04 per=1.22e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=181 i=2 t=2.52e-04 per=1.29e+01 cost=7.01e+03 flops=2.78e+07
 sigma counter=181 i=3 t=2.35e-04 per=1.21e+01 cost=6.99e+03 flops=2.97e+07
 sigma counter=181 i=4 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=181 i=5 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=181 i=6 t=2.68e-04 per=1.38e+01 cost=1.89e+04 flops=7.05e+07
 sigma counter=181 i=7 t=2.52e-04 per=1.29e+01 cost=1.89e+04 flops=7.50e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=3.63e-02 t_gemm=3.53e-01 t_reduction=3.49e-02 tot=4.24e-01 ---
 sigma_tot counter=181 i=0 t=4.32e-02 per=1.22e+01 cost=1.09e+06 flops=2.53e+07
 sigma_tot counter=181 i=1 t=4.44e-02 per=1.26e+01 cost=1.10e+06 flops=2.48e+07
 sigma_tot counter=181 i=2 t=4.29e-02 per=1.22e+01 cost=1.10e+06 flops=2.56e+07
 sigma_tot counter=181 i=3 t=4.33e-02 per=1.23e+01 cost=1.10e+06 flops=2.55e+07
 sigma_tot counter=181 i=4 t=4.35e-02 per=1.23e+01 cost=1.85e+06 flops=4.25e+07
 sigma_tot counter=181 i=5 t=4.42e-02 per=1.25e+01 cost=1.85e+06 flops=4.18e+07
 sigma_tot counter=181 i=6 t=4.70e-02 per=1.33e+01 cost=2.16e+06 flops=4.60e+07
 sigma_tot counter=181 i=7 t=4.42e-02 per=1.25e+01 cost=2.15e+06 flops=4.87e+07
 total GEMM cost=1.24e+07 flops=3.52e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.96e-04,1.96e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.96e-03 t_reduction=1.87e-04 tot=2.34e-03 ---
 sigma counter=182 i=0 t=2.35e-04 per=1.20e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=182 i=1 t=2.55e-04 per=1.30e+01 cost=6.78e+03 flops=2.66e+07
 sigma counter=182 i=2 t=2.34e-04 per=1.19e+01 cost=7.01e+03 flops=2.99e+07
 sigma counter=182 i=3 t=2.41e-04 per=1.23e+01 cost=6.99e+03 flops=2.90e+07
 sigma counter=182 i=4 t=2.32e-04 per=1.18e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=182 i=5 t=2.42e-04 per=1.23e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=182 i=6 t=2.69e-04 per=1.37e+01 cost=1.89e+04 flops=7.02e+07
 sigma counter=182 i=7 t=2.53e-04 per=1.29e+01 cost=1.89e+04 flops=7.47e+07
 total GEMM cost=7.90e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=3.65e-02 t_gemm=3.55e-01 t_reduction=3.51e-02 tot=4.26e-01 ---
 sigma_tot counter=182 i=0 t=4.34e-02 per=1.22e+01 cost=1.10e+06 flops=2.53e+07
 sigma_tot counter=182 i=1 t=4.47e-02 per=1.26e+01 cost=1.11e+06 flops=2.48e+07
 sigma_tot counter=182 i=2 t=4.31e-02 per=1.22e+01 cost=1.11e+06 flops=2.57e+07
 sigma_tot counter=182 i=3 t=4.36e-02 per=1.23e+01 cost=1.11e+06 flops=2.55e+07
 sigma_tot counter=182 i=4 t=4.38e-02 per=1.23e+01 cost=1.86e+06 flops=4.25e+07
 sigma_tot counter=182 i=5 t=4.45e-02 per=1.25e+01 cost=1.86e+06 flops=4.17e+07
 sigma_tot counter=182 i=6 t=4.73e-02 per=1.33e+01 cost=2.18e+06 flops=4.61e+07
 sigma_tot counter=182 i=7 t=4.44e-02 per=1.25e+01 cost=2.17e+06 flops=4.89e+07
 total GEMM cost=1.25e+07 flops=3.52e+07
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   1.97e-02  2.46e-03
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   1.97e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.99e-04,1.95e-03,1.93e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.95e-03 t_reduction=1.93e-04 tot=2.34e-03 ---
 sigma counter=183 i=0 t=2.38e-04 per=1.22e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=183 i=1 t=2.47e-04 per=1.27e+01 cost=6.78e+03 flops=2.75e+07
 sigma counter=183 i=2 t=2.42e-04 per=1.24e+01 cost=7.01e+03 flops=2.90e+07
 sigma counter=183 i=3 t=2.36e-04 per=1.21e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=183 i=4 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=183 i=5 t=2.41e-04 per=1.24e+01 cost=6.78e+03 flops=2.81e+07
 sigma counter=183 i=6 t=2.59e-04 per=1.33e+01 cost=1.89e+04 flops=7.30e+07
 sigma counter=183 i=7 t=2.54e-04 per=1.30e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=3.67e-02 t_gemm=3.57e-01 t_reduction=3.52e-02 tot=4.29e-01 ---
 sigma_tot counter=183 i=0 t=4.37e-02 per=1.22e+01 cost=1.10e+06 flops=2.53e+07
 sigma_tot counter=183 i=1 t=4.49e-02 per=1.26e+01 cost=1.12e+06 flops=2.48e+07
 sigma_tot counter=183 i=2 t=4.34e-02 per=1.22e+01 cost=1.11e+06 flops=2.57e+07
 sigma_tot counter=183 i=3 t=4.38e-02 per=1.23e+01 cost=1.12e+06 flops=2.55e+07
 sigma_tot counter=183 i=4 t=4.40e-02 per=1.23e+01 cost=1.87e+06 flops=4.24e+07
 sigma_tot counter=183 i=5 t=4.47e-02 per=1.25e+01 cost=1.86e+06 flops=4.16e+07
 sigma_tot counter=183 i=6 t=4.75e-02 per=1.33e+01 cost=2.20e+06 flops=4.63e+07
 sigma_tot counter=183 i=7 t=4.47e-02 per=1.25e+01 cost=2.19e+06 flops=4.90e+07
 total GEMM cost=1.26e+07 flops=3.52e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.50e-05,2.02e-04,1.92e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.11e+07
--- TIMING FOR sigma : t_inter=2.02e-04 t_gemm=1.92e-03 t_reduction=1.89e-04 tot=2.31e-03 ---
 sigma counter=184 i=0 t=2.32e-04 per=1.21e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=184 i=1 t=2.36e-04 per=1.23e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=184 i=2 t=2.33e-04 per=1.21e+01 cost=7.01e+03 flops=3.01e+07
 sigma counter=184 i=3 t=2.37e-04 per=1.24e+01 cost=6.99e+03 flops=2.95e+07
 sigma counter=184 i=4 t=2.39e-04 per=1.25e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=184 i=5 t=2.34e-04 per=1.22e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=184 i=6 t=2.59e-04 per=1.35e+01 cost=1.89e+04 flops=7.30e+07
 sigma counter=184 i=7 t=2.49e-04 per=1.30e+01 cost=1.89e+04 flops=7.59e+07
 total GEMM cost=7.90e+04 flops=4.12e+07
--- TIMING FOR sigma_tot : t_inter=3.69e-02 t_gemm=3.59e-01 t_reduction=3.54e-02 tot=4.31e-01 ---
 sigma_tot counter=184 i=0 t=4.39e-02 per=1.22e+01 cost=1.11e+06 flops=2.53e+07
 sigma_tot counter=184 i=1 t=4.52e-02 per=1.26e+01 cost=1.12e+06 flops=2.48e+07
 sigma_tot counter=184 i=2 t=4.36e-02 per=1.22e+01 cost=1.12e+06 flops=2.57e+07
 sigma_tot counter=184 i=3 t=4.40e-02 per=1.23e+01 cost=1.13e+06 flops=2.56e+07
 sigma_tot counter=184 i=4 t=4.42e-02 per=1.23e+01 cost=1.87e+06 flops=4.23e+07
 sigma_tot counter=184 i=5 t=4.50e-02 per=1.25e+01 cost=1.87e+06 flops=4.16e+07
 sigma_tot counter=184 i=6 t=4.78e-02 per=1.33e+01 cost=2.22e+06 flops=4.64e+07
 sigma_tot counter=184 i=7 t=4.49e-02 per=1.25e+01 cost=2.21e+06 flops=4.92e+07
 total GEMM cost=1.27e+07 flops=3.53e+07
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   2.56e-02  2.56e-03
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   2.56e-02  2.56e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.00e-04,1.95e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.95e-03 t_reduction=1.88e-04 tot=2.34e-03 ---
 sigma counter=185 i=0 t=2.36e-04 per=1.21e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=185 i=1 t=2.46e-04 per=1.26e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=185 i=2 t=2.34e-04 per=1.20e+01 cost=7.01e+03 flops=2.99e+07
 sigma counter=185 i=3 t=2.47e-04 per=1.27e+01 cost=6.99e+03 flops=2.83e+07
 sigma counter=185 i=4 t=2.39e-04 per=1.23e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=185 i=5 t=2.39e-04 per=1.23e+01 cost=6.78e+03 flops=2.84e+07
 sigma counter=185 i=6 t=2.60e-04 per=1.33e+01 cost=1.89e+04 flops=7.27e+07
 sigma counter=185 i=7 t=2.48e-04 per=1.27e+01 cost=1.89e+04 flops=7.62e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=3.71e-02 t_gemm=3.61e-01 t_reduction=3.56e-02 tot=4.33e-01 ---
 sigma_tot counter=185 i=0 t=4.41e-02 per=1.22e+01 cost=1.12e+06 flops=2.53e+07
 sigma_tot counter=185 i=1 t=4.54e-02 per=1.26e+01 cost=1.13e+06 flops=2.48e+07
 sigma_tot counter=185 i=2 t=4.38e-02 per=1.22e+01 cost=1.13e+06 flops=2.57e+07
 sigma_tot counter=185 i=3 t=4.43e-02 per=1.23e+01 cost=1.13e+06 flops=2.56e+07
 sigma_tot counter=185 i=4 t=4.45e-02 per=1.23e+01 cost=1.88e+06 flops=4.23e+07
 sigma_tot counter=185 i=5 t=4.52e-02 per=1.25e+01 cost=1.88e+06 flops=4.15e+07
 sigma_tot counter=185 i=6 t=4.81e-02 per=1.33e+01 cost=2.24e+06 flops=4.65e+07
 sigma_tot counter=185 i=7 t=4.52e-02 per=1.25e+01 cost=2.23e+06 flops=4.93e+07
 total GEMM cost=1.27e+07 flops=3.53e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.99e-04,1.97e-03,1.90e-04 cost=7.90e+04 flops[gemm]=4.01e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.97e-03 t_reduction=1.90e-04 tot=2.36e-03 ---
 sigma counter=186 i=0 t=2.34e-04 per=1.19e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=186 i=1 t=2.46e-04 per=1.25e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=186 i=2 t=2.40e-04 per=1.22e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=186 i=3 t=2.36e-04 per=1.20e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=186 i=4 t=2.42e-04 per=1.23e+01 cost=6.81e+03 flops=2.82e+07
 sigma counter=186 i=5 t=2.45e-04 per=1.24e+01 cost=6.78e+03 flops=2.77e+07
 sigma counter=186 i=6 t=2.69e-04 per=1.37e+01 cost=1.89e+04 flops=7.02e+07
 sigma counter=186 i=7 t=2.56e-04 per=1.30e+01 cost=1.89e+04 flops=7.38e+07
 total GEMM cost=7.90e+04 flops=4.01e+07
--- TIMING FOR sigma_tot : t_inter=3.73e-02 t_gemm=3.63e-01 t_reduction=3.58e-02 tot=4.36e-01 ---
 sigma_tot counter=186 i=0 t=4.44e-02 per=1.22e+01 cost=1.13e+06 flops=2.54e+07
 sigma_tot counter=186 i=1 t=4.57e-02 per=1.26e+01 cost=1.14e+06 flops=2.49e+07
 sigma_tot counter=186 i=2 t=4.41e-02 per=1.22e+01 cost=1.13e+06 flops=2.57e+07
 sigma_tot counter=186 i=3 t=4.45e-02 per=1.23e+01 cost=1.14e+06 flops=2.56e+07
 sigma_tot counter=186 i=4 t=4.47e-02 per=1.23e+01 cost=1.89e+06 flops=4.22e+07
 sigma_tot counter=186 i=5 t=4.54e-02 per=1.25e+01 cost=1.88e+06 flops=4.14e+07
 sigma_tot counter=186 i=6 t=4.83e-02 per=1.33e+01 cost=2.26e+06 flops=4.67e+07
 sigma_tot counter=186 i=7 t=4.54e-02 per=1.25e+01 cost=2.25e+06 flops=4.95e+07
 total GEMM cost=1.28e+07 flops=3.53e+07
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   3.05e-02  2.54e-03
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   3.05e-02  2.54e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,2.01e-04,1.95e-03,1.97e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.95e-03 t_reduction=1.97e-04 tot=2.35e-03 ---
 sigma counter=187 i=0 t=2.35e-04 per=1.20e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=187 i=1 t=2.30e-04 per=1.18e+01 cost=6.78e+03 flops=2.95e+07
 sigma counter=187 i=2 t=2.41e-04 per=1.23e+01 cost=7.01e+03 flops=2.91e+07
 sigma counter=187 i=3 t=2.36e-04 per=1.21e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=187 i=4 t=2.38e-04 per=1.22e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=187 i=5 t=2.44e-04 per=1.25e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=187 i=6 t=2.70e-04 per=1.38e+01 cost=1.89e+04 flops=7.00e+07
 sigma counter=187 i=7 t=2.58e-04 per=1.32e+01 cost=1.89e+04 flops=7.32e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=3.75e-02 t_gemm=3.65e-01 t_reduction=3.60e-02 tot=4.38e-01 ---
 sigma_tot counter=187 i=0 t=4.46e-02 per=1.22e+01 cost=1.13e+06 flops=2.54e+07
 sigma_tot counter=187 i=1 t=4.59e-02 per=1.26e+01 cost=1.14e+06 flops=2.49e+07
 sigma_tot counter=187 i=2 t=4.43e-02 per=1.22e+01 cost=1.14e+06 flops=2.58e+07
 sigma_tot counter=187 i=3 t=4.48e-02 per=1.23e+01 cost=1.15e+06 flops=2.56e+07
 sigma_tot counter=187 i=4 t=4.50e-02 per=1.23e+01 cost=1.89e+06 flops=4.21e+07
 sigma_tot counter=187 i=5 t=4.57e-02 per=1.25e+01 cost=1.89e+06 flops=4.14e+07
 sigma_tot counter=187 i=6 t=4.86e-02 per=1.33e+01 cost=2.27e+06 flops=4.68e+07
 sigma_tot counter=187 i=7 t=4.57e-02 per=1.25e+01 cost=2.27e+06 flops=4.96e+07
 total GEMM cost=1.29e+07 flops=3.54e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.96e-04,1.94e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.94e-03 t_reduction=1.87e-04 tot=2.32e-03 ---
 sigma counter=188 i=0 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=188 i=1 t=2.48e-04 per=1.28e+01 cost=6.78e+03 flops=2.74e+07
 sigma counter=188 i=2 t=2.33e-04 per=1.20e+01 cost=7.01e+03 flops=3.01e+07
 sigma counter=188 i=3 t=2.34e-04 per=1.21e+01 cost=6.99e+03 flops=2.99e+07
 sigma counter=188 i=4 t=2.36e-04 per=1.22e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=188 i=5 t=2.36e-04 per=1.22e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=188 i=6 t=2.65e-04 per=1.37e+01 cost=1.89e+04 flops=7.13e+07
 sigma counter=188 i=7 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=3.77e-02 t_gemm=3.66e-01 t_reduction=3.62e-02 tot=4.40e-01 ---
 sigma_tot counter=188 i=0 t=4.48e-02 per=1.22e+01 cost=1.14e+06 flops=2.54e+07
 sigma_tot counter=188 i=1 t=4.61e-02 per=1.26e+01 cost=1.15e+06 flops=2.49e+07
 sigma_tot counter=188 i=2 t=4.46e-02 per=1.22e+01 cost=1.15e+06 flops=2.58e+07
 sigma_tot counter=188 i=3 t=4.50e-02 per=1.23e+01 cost=1.15e+06 flops=2.56e+07
 sigma_tot counter=188 i=4 t=4.52e-02 per=1.23e+01 cost=1.90e+06 flops=4.20e+07
 sigma_tot counter=188 i=5 t=4.59e-02 per=1.25e+01 cost=1.90e+06 flops=4.13e+07
 sigma_tot counter=188 i=6 t=4.89e-02 per=1.33e+01 cost=2.29e+06 flops=4.69e+07
 sigma_tot counter=188 i=7 t=4.60e-02 per=1.25e+01 cost=2.29e+06 flops=4.97e+07
 total GEMM cost=1.30e+07 flops=3.54e+07
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   3.54e-02  2.53e-03
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   3.54e-02  2.53e-03
TIMING for Davidson : 3.55e-02  T(cal/comm/rest)=3.51e-02,7.38e-07,3.34e-04
optimized energies: isweep=4 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=4 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.964e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000536 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.03e-05,0.000244,0.000242 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7e-06,0.00107,0.000183 cost=2.78e+04 flops[gemm]=2.6e+07
--- TIMING FOR renorm : t_inter=7e-06 t_gemm=0.00107 t_reduction=0.000183 tot=0.00126 ---
 renorm counter=19 i=0 t=0.000214 per=20 cost=1.82e+03 flops=8.51e+06
 renorm counter=19 i=1 t=0.000215 per=20.1 cost=3.23e+03 flops=1.5e+07
 renorm counter=19 i=2 t=0.000201 per=18.8 cost=1.91e+03 flops=9.48e+06
 renorm counter=19 i=3 t=0.000207 per=19.3 cost=3.14e+03 flops=1.52e+07
 renorm counter=19 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=19 i=5 t=1e-06 per=0.0935 cost=0 flops=0
 renorm counter=19 i=6 t=0.000232 per=21.7 cost=1.77e+04 flops=7.63e+07
 total GEMM cost=2.78e+04 flops=2.6e+07
--- TIMING FOR renorm_tot : t_inter=0.00175 t_gemm=0.0205 t_reduction=0.00359 tot=0.0259 ---
 renorm_tot counter=19 i=0 t=0.00403 per=19.6 cost=7.22e+04 flops=1.79e+07
 renorm_tot counter=19 i=1 t=0.00404 per=19.7 cost=1.02e+05 flops=2.53e+07
 renorm_tot counter=19 i=2 t=0.00184 per=8.98 cost=6.33e+04 flops=3.43e+07
 renorm_tot counter=19 i=3 t=0.00191 per=9.29 cost=1.1e+05 flops=5.78e+07
 renorm_tot counter=19 i=4 t=0.00206 per=10 cost=8.01e+04 flops=3.88e+07
 renorm_tot counter=19 i=5 t=0.00212 per=10.3 cost=1.38e+05 flops=6.51e+07
 renorm_tot counter=19 i=6 t=0.00453 per=22.1 cost=8.58e+05 flops=1.89e+08
 total GEMM cost=1.42e+06 flops=6.93e+07
check ||H-H.dagger||=0.00e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=9.1e-05,0.0025,8.2e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(3,0) size=1.03e-05GB T[save](info/data/tot)=5.08e-05,3.24e-05,8.32e-05 speed=0.124GB/s disk[used]=0.0001GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
##### time_local: 4.31e-02 S #####
 T(fetch) = 7.11e-05 S  per = 0.17  per(accum) = 0.17
 T(hdiag) = 7.67e-05 S  per = 0.18  per(accum) = 0.34
 T(dvdsn) = 3.96e-02 S  per =   92  per(accum) = 92
 T(decim) = 8.93e-05 S  per = 0.21  per(accum) = 92
 T(guess) = 7.96e-05 S  per = 0.18  per(accum) = 93
 T(renrm) = 2.63e-03 S  per =  6.1  per(accum) = 99
 T(save ) = 5.46e-04 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.94e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 3.91e-05 S  per = 0.099  per(accum) = 0.099
 T(symbolic_formulae_twodot     ) = 2.30e-04 S  per = 0.58  per(accum) = 0.68
 T(hintermediate init           ) = 2.13e-05 S  per = 0.054  per(accum) = 0.74
 T(hintermediates memcpy cpu2gpu) = 3.56e-06 S  per = 0.009  per(accum) = 0.75
 T(preprocess_hformulae_Hxlist2 ) = 2.24e-03 S  per =  5.7  per(accum) = 6.4
 T(hmmtasks init                ) = 1.41e-03 S  per =  3.6  per(accum) = 10
 T(dvdson solver [Hx_batchGPU]  ) = 3.51e-02 S  per =   89  per(accum) = 99
 T(dvdson solver [communication]) = 7.38e-07 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.34e-04 S  per = 0.85  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.58e-03 S
 T(qops init                    ) = 9.06e-05 S  per =  3.5  per(accum) = 3.5
 T(qops_dict memcpy cpu2gpu     ) = 2.82e-05 S  per =  1.1  per(accum) = 4.6
 T(symbolic_formulae_renorm     ) = 2.01e-04 S  per =  7.8  per(accum) = 12
 T(rintermediate init           ) = 9.51e-06 S  per = 0.37  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.80e-06 S  per = 0.19  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.45e-04 S  per =   21  per(accum) = 34
 T(rmmtasks init                ) = 3.26e-04 S  per =   13  per(accum) = 47
 T(qops memset                  ) = 8.33e-06 S  per = 0.32  per(accum) = 47
 T(preprocess_renorm_batchGPU   ) = 1.33e-03 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.75e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.21e-06 S  per = 0.32  per(accum) = 1e+02
##### time_sweep: 9.59e-02 S #####
 T(fetch) = 4.36e-04 S  per = 0.45  per(accum) = 0.45
 T(hdiag) = 2.15e-04 S  per = 0.22  per(accum) = 0.68
 T(dvdsn) = 8.47e-02 S  per =   88  per(accum) = 89
 T(decim) = 4.89e-04 S  per = 0.51  per(accum) = 90
 T(guess) = 2.32e-04 S  per = 0.24  per(accum) = 90
 T(renrm) = 8.07e-03 S  per =  8.4  per(accum) = 98
 T(save ) = 1.69e-03 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.42e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.18e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 6.86e-04 S  per = 0.81  per(accum) = 0.95
 T(hintermediate init           ) = 6.42e-05 S  per = 0.076  per(accum) = 1
 T(hintermediates memcpy cpu2gpu) = 1.07e-05 S  per = 0.013  per(accum) = 1
 T(preprocess_hformulae_Hxlist2 ) = 6.74e-03 S  per =    8  per(accum) = 9
 T(hmmtasks init                ) = 4.20e-03 S  per =    5  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 7.17e-02 S  per =   85  per(accum) = 99
 T(dvdson solver [communication]) = 1.58e-06 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.02e-04 S  per = 0.83  per(accum) = 1e+02
Detailed decomposition of T(renrm): 7.92e-03 S
 T(qops init                    ) = 2.59e-04 S  per =  3.3  per(accum) = 3.3
 T(qops_dict memcpy cpu2gpu     ) = 9.35e-05 S  per =  1.2  per(accum) = 4.4
 T(symbolic_formulae_renorm     ) = 5.80e-04 S  per =  7.3  per(accum) = 12
 T(rintermediate init           ) = 3.97e-05 S  per =  0.5  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 1.39e-05 S  per = 0.18  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 1.60e-03 S  per =   20  per(accum) = 33
 T(rmmtasks init                ) = 1.02e-03 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 2.56e-05 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 4.18e-03 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 8.24e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.51e-05 S  per = 0.32  per(accum) = 1e+02
##### time_global: 6.24e-01 S #####
 T(fetch) = 4.19e-03 S  per = 0.67  per(accum) = 0.67
 T(hdiag) = 1.49e-03 S  per = 0.24  per(accum) = 0.91
 T(dvdsn) = 5.48e-01 S  per =   88  per(accum) = 89
 T(decim) = 4.49e-03 S  per = 0.72  per(accum) = 89
 T(guess) = 1.60e-03 S  per = 0.26  per(accum) = 90
 T(renrm) = 5.31e-02 S  per =  8.5  per(accum) = 98
 T(save ) = 1.09e-02 S  per =  1.7  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 5.44e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 7.86e-04 S  per = 0.14  per(accum) = 0.14
 T(symbolic_formulae_twodot     ) = 4.79e-03 S  per = 0.88  per(accum) = 1
 T(hintermediate init           ) = 4.72e-04 S  per = 0.087  per(accum) = 1.1
 T(hintermediates memcpy cpu2gpu) = 7.67e-05 S  per = 0.014  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 4.33e-02 S  per =    8  per(accum) = 9.1
 T(hmmtasks init                ) = 2.70e-02 S  per =    5  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 4.62e-01 S  per =   85  per(accum) = 99
 T(dvdson solver [communication]) = 1.19e-05 S  per = 0.0022  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.15e-03 S  per = 0.95  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.22e-02 S
 T(qops init                    ) = 2.09e-03 S  per =    4  per(accum) = 4
 T(qops_dict memcpy cpu2gpu     ) = 6.53e-04 S  per =  1.3  per(accum) = 5.3
 T(symbolic_formulae_renorm     ) = 3.92e-03 S  per =  7.5  per(accum) = 13
 T(rintermediate init           ) = 3.20e-04 S  per = 0.61  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 9.69e-05 S  per = 0.19  per(accum) = 14
 T(preprocess_formulae_Rlist2   ) = 1.03e-02 S  per =   20  per(accum) = 33
 T(rmmtasks init                ) = 6.53e-03 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 1.67e-04 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 2.74e-02 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.46e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.71e-04 S  per = 0.33  per(accum) = 1e+02

isweep=4 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.325e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44924ba0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.191e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.873e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00222 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.34e-05,0.000947,0.00122 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.5e-05,0.000203,0.00195,0.000187 cost=7.9e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=0.000203 t_gemm=0.00195 t_reduction=0.000187 tot=0.00234 ---
 sigma counter=189 i=0 t=0.000239 per=12.2 cost=7.01e+03 flops=2.93e+07
 sigma counter=189 i=1 t=0.000256 per=13.1 cost=6.99e+03 flops=2.73e+07
 sigma counter=189 i=2 t=0.000233 per=11.9 cost=6.81e+03 flops=2.92e+07
 sigma counter=189 i=3 t=0.000235 per=12 cost=6.78e+03 flops=2.89e+07
 sigma counter=189 i=4 t=0.000254 per=13 cost=1.89e+04 flops=7.44e+07
 sigma counter=189 i=5 t=0.00026 per=13.3 cost=1.89e+04 flops=7.27e+07
 sigma counter=189 i=6 t=0.000243 per=12.4 cost=6.78e+03 flops=2.79e+07
 sigma counter=189 i=7 t=0.000234 per=12 cost=6.81e+03 flops=2.91e+07
 total GEMM cost=7.9e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=0.0379 t_gemm=0.368 t_reduction=0.0364 tot=0.443 ---
 sigma_tot counter=189 i=0 t=0.0451 per=12.2 cost=1.15e+06 flops=2.54e+07
 sigma_tot counter=189 i=1 t=0.0464 per=12.6 cost=1.16e+06 flops=2.49e+07
 sigma_tot counter=189 i=2 t=0.0448 per=12.2 cost=1.16e+06 flops=2.58e+07
 sigma_tot counter=189 i=3 t=0.0452 per=12.3 cost=1.16e+06 flops=2.57e+07
 sigma_tot counter=189 i=4 t=0.0455 per=12.3 cost=1.92e+06 flops=4.22e+07
 sigma_tot counter=189 i=5 t=0.0462 per=12.5 cost=1.92e+06 flops=4.15e+07
 sigma_tot counter=189 i=6 t=0.0491 per=13.3 cost=2.3e+06 flops=4.68e+07
 sigma_tot counter=189 i=7 t=0.0462 per=12.5 cost=2.29e+06 flops=4.96e+07
 total GEMM cost=1.3e+07 flops=3.54e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.7e-05,0.000199,0.00196,0.000188 cost=7.9e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=0.000199 t_gemm=0.00196 t_reduction=0.000188 tot=0.00235 ---
 sigma counter=190 i=0 t=0.000237 per=12.1 cost=7.01e+03 flops=2.96e+07
 sigma counter=190 i=1 t=0.000247 per=12.6 cost=6.99e+03 flops=2.83e+07
 sigma counter=190 i=2 t=0.000232 per=11.8 cost=6.81e+03 flops=2.94e+07
 sigma counter=190 i=3 t=0.000246 per=12.6 cost=6.78e+03 flops=2.76e+07
 sigma counter=190 i=4 t=0.000252 per=12.9 cost=1.89e+04 flops=7.5e+07
 sigma counter=190 i=5 t=0.000258 per=13.2 cost=1.89e+04 flops=7.32e+07
 sigma counter=190 i=6 t=0.000254 per=13 cost=6.78e+03 flops=2.67e+07
 sigma counter=190 i=7 t=0.000233 per=11.9 cost=6.81e+03 flops=2.92e+07
 total GEMM cost=7.9e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=0.0381 t_gemm=0.37 t_reduction=0.0366 tot=0.445 ---
 sigma_tot counter=190 i=0 t=0.0453 per=12.2 cost=1.15e+06 flops=2.54e+07
 sigma_tot counter=190 i=1 t=0.0466 per=12.6 cost=1.16e+06 flops=2.49e+07
 sigma_tot counter=190 i=2 t=0.045 per=12.2 cost=1.16e+06 flops=2.58e+07
 sigma_tot counter=190 i=3 t=0.0455 per=12.3 cost=1.17e+06 flops=2.57e+07
 sigma_tot counter=190 i=4 t=0.0457 per=12.3 cost=1.94e+06 flops=4.24e+07
 sigma_tot counter=190 i=5 t=0.0464 per=12.5 cost=1.93e+06 flops=4.16e+07
 sigma_tot counter=190 i=6 t=0.0494 per=13.3 cost=2.31e+06 flops=4.67e+07
 sigma_tot counter=190 i=7 t=0.0464 per=12.5 cost=2.3e+06 flops=4.95e+07
 total GEMM cost=1.31e+07 flops=3.54e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   4.93e-03  2.47e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   4.93e-03  2.47e-03
TIMING for Davidson : 4.95e-03  T(cal/comm/rest)=4.91e-03,7.80e-08,4.30e-05
optimized energies: isweep=4 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=4 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep4_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.746e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 1.844e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=3.26e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Rlist : 0.000513 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.37e-05,0.000234,0.000235 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000932 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07,0.0009
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000177,0.00106,0.000181 cost=1.55e+05 flops[gemm]=1.46e+08
--- TIMING FOR renorm : t_inter=0.000177 t_gemm=0.00106 t_reduction=0.000181 tot=0.00142 ---
 renorm counter=20 i=0 t=0.0002 per=18.9 cost=5.64e+03 flops=2.82e+07
 renorm counter=20 i=1 t=0.000209 per=19.8 cost=1.13e+04 flops=5.39e+07
 renorm counter=20 i=2 t=0.000199 per=18.8 cost=1.66e+04 flops=8.32e+07
 renorm counter=20 i=3 t=0.000217 per=20.5 cost=2.89e+04 flops=1.33e+08
 renorm counter=20 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=20 i=5 t=1e-06 per=0.0946 cost=0 flops=0
 renorm counter=20 i=6 t=0.000231 per=21.9 cost=9.22e+04 flops=3.99e+08
 total GEMM cost=1.55e+05 flops=1.46e+08
--- TIMING FOR renorm_tot : t_inter=0.00193 t_gemm=0.0216 t_reduction=0.00377 tot=0.0273 ---
 renorm_tot counter=20 i=0 t=0.00423 per=19.6 cost=7.78e+04 flops=1.84e+07
 renorm_tot counter=20 i=1 t=0.00425 per=19.7 cost=1.13e+05 flops=2.67e+07
 renorm_tot counter=20 i=2 t=0.00204 per=9.46 cost=7.99e+04 flops=3.91e+07
 renorm_tot counter=20 i=3 t=0.00212 per=9.84 cost=1.39e+05 flops=6.55e+07
 renorm_tot counter=20 i=4 t=0.00206 per=9.55 cost=8.01e+04 flops=3.88e+07
 renorm_tot counter=20 i=5 t=0.00212 per=9.83 cost=1.38e+05 flops=6.51e+07
 renorm_tot counter=20 i=6 t=0.00476 per=22.1 cost=9.5e+05 flops=1.99e+08
 total GEMM cost=1.58e+06 flops=7.31e+07
check ||H-H.dagger||=1.20e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0027 S T(init/kernel/comm)=7.2e-05,0.0026,8.4e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(2,0) size=1.94e-05GB T[save](info/data/tot)=6.26e-05,5.29e-05,0.000116 speed=0.168GB/s disk[used]=0.000102GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
##### time_local: 1.32e-02 S #####
 T(fetch) = 3.08e-04 S  per =  2.3  per(accum) = 2.3
 T(hdiag) = 6.93e-05 S  per = 0.52  per(accum) = 2.9
 T(dvdsn) = 9.05e-03 S  per =   69  per(accum) = 71
 T(decim) = 3.39e-04 S  per =  2.6  per(accum) = 74
 T(guess) = 7.61e-05 S  per = 0.58  per(accum) = 75
 T(renrm) = 2.77e-03 S  per =   21  per(accum) = 96
 T(save ) = 5.93e-04 S  per =  4.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.86e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 4.01e-05 S  per = 0.45  per(accum) = 0.45
 T(symbolic_formulae_twodot     ) = 2.24e-04 S  per =  2.5  per(accum) = 3
 T(hintermediate init           ) = 2.36e-05 S  per = 0.27  per(accum) = 3.2
 T(hintermediates memcpy cpu2gpu) = 3.60e-06 S  per = 0.041  per(accum) = 3.3
 T(preprocess_hformulae_Hxlist2 ) = 2.23e-03 S  per =   25  per(accum) = 28
 T(hmmtasks init                ) = 1.39e-03 S  per =   16  per(accum) = 44
 T(dvdson solver [Hx_batchGPU]  ) = 4.91e-03 S  per =   55  per(accum) = 1e+02
 T(dvdson solver [communication]) = 7.80e-08 S  per = 0.00088  per(accum) = 1e+02
 T(dvdson solver [rest part]    ) = 4.30e-05 S  per = 0.48  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.72e-03 S
 T(qops init                    ) = 7.21e-05 S  per =  2.7  per(accum) = 2.7
 T(qops_dict memcpy cpu2gpu     ) = 3.47e-05 S  per =  1.3  per(accum) = 3.9
 T(symbolic_formulae_renorm     ) = 1.79e-04 S  per =  6.6  per(accum) = 11
 T(rintermediate init           ) = 2.13e-05 S  per = 0.78  per(accum) = 11
 T(rintermediates memcpy cpu2gpu) = 4.38e-06 S  per = 0.16  per(accum) = 11
 T(preprocess_formulae_Rlist2   ) = 5.22e-04 S  per =   19  per(accum) = 31
 T(rmmtasks init                ) = 3.53e-04 S  per =   13  per(accum) = 44
 T(qops memset                  ) = 7.88e-06 S  per = 0.29  per(accum) = 44
 T(preprocess_renorm_batchGPU   ) = 1.49e-03 S  per =   55  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.70e-05 S  per = 0.99  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.39e-06 S  per = 0.31  per(accum) = 1e+02
##### time_sweep: 1.09e-01 S #####
 T(fetch) = 7.44e-04 S  per = 0.68  per(accum) = 0.68
 T(hdiag) = 2.84e-04 S  per = 0.26  per(accum) = 0.94
 T(dvdsn) = 9.38e-02 S  per =   86  per(accum) = 87
 T(decim) = 8.28e-04 S  per = 0.76  per(accum) = 88
 T(guess) = 3.08e-04 S  per = 0.28  per(accum) = 88
 T(renrm) = 1.08e-02 S  per =  9.9  per(accum) = 98
 T(save ) = 2.29e-03 S  per =  2.1  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 9.31e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.58e-04 S  per = 0.17  per(accum) = 0.17
 T(symbolic_formulae_twodot     ) = 9.09e-04 S  per = 0.98  per(accum) = 1.1
 T(hintermediate init           ) = 8.79e-05 S  per = 0.094  per(accum) = 1.2
 T(hintermediates memcpy cpu2gpu) = 1.43e-05 S  per = 0.015  per(accum) = 1.3
 T(preprocess_hformulae_Hxlist2 ) = 8.96e-03 S  per =  9.6  per(accum) = 11
 T(hmmtasks init                ) = 5.59e-03 S  per =    6  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 7.66e-02 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 1.66e-06 S  per = 0.0018  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.45e-04 S  per =  0.8  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.06e-02 S
 T(qops init                    ) = 3.31e-04 S  per =  3.1  per(accum) = 3.1
 T(qops_dict memcpy cpu2gpu     ) = 1.28e-04 S  per =  1.2  per(accum) = 4.3
 T(symbolic_formulae_renorm     ) = 7.59e-04 S  per =  7.1  per(accum) = 11
 T(rintermediate init           ) = 6.09e-05 S  per = 0.57  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 1.83e-05 S  per = 0.17  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 2.13e-03 S  per =   20  per(accum) = 32
 T(rmmtasks init                ) = 1.37e-03 S  per =   13  per(accum) = 45
 T(qops memset                  ) = 3.35e-05 S  per = 0.31  per(accum) = 45
 T(preprocess_renorm_batchGPU   ) = 5.67e-03 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.09e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 3.35e-05 S  per = 0.31  per(accum) = 1e+02
##### time_global: 6.37e-01 S #####
 T(fetch) = 4.49e-03 S  per = 0.71  per(accum) = 0.71
 T(hdiag) = 1.56e-03 S  per = 0.25  per(accum) = 0.95
 T(dvdsn) = 5.57e-01 S  per =   87  per(accum) = 88
 T(decim) = 4.82e-03 S  per = 0.76  per(accum) = 89
 T(guess) = 1.68e-03 S  per = 0.26  per(accum) = 89
 T(renrm) = 5.59e-02 S  per =  8.8  per(accum) = 98
 T(save ) = 1.15e-02 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 5.53e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 8.26e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 5.01e-03 S  per = 0.91  per(accum) = 1.1
 T(hintermediate init           ) = 4.96e-04 S  per = 0.09  per(accum) = 1.1
 T(hintermediates memcpy cpu2gpu) = 8.03e-05 S  per = 0.015  per(accum) = 1.2
 T(preprocess_hformulae_Hxlist2 ) = 4.55e-02 S  per =  8.2  per(accum) = 9.4
 T(hmmtasks init                ) = 2.84e-02 S  per =  5.1  per(accum) = 15
 T(dvdson solver [Hx_batchGPU]  ) = 4.67e-01 S  per =   85  per(accum) = 99
 T(dvdson solver [communication]) = 1.20e-05 S  per = 0.0022  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.20e-03 S  per = 0.94  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.49e-02 S
 T(qops init                    ) = 2.16e-03 S  per =  3.9  per(accum) = 3.9
 T(qops_dict memcpy cpu2gpu     ) = 6.88e-04 S  per =  1.3  per(accum) = 5.2
 T(symbolic_formulae_renorm     ) = 4.10e-03 S  per =  7.5  per(accum) = 13
 T(rintermediate init           ) = 3.41e-04 S  per = 0.62  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 1.01e-04 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 1.08e-02 S  per =   20  per(accum) = 33
 T(rmmtasks init                ) = 6.88e-03 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 1.74e-04 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 2.89e-02 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.73e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.80e-04 S  per = 0.33  per(accum) = 1e+02

======================================================================
sweep_data::summary isweep=4
----------------------------------------------------------------------
sweep parameters: isweep=4 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.04
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.013
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.043
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.013
 eav_max=-2.54574720706 [ibond=1]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=2]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=1.60474789013e-09
 sweep energies: isweep=4 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[0]=-2.65451696664
 sweep energies: isweep=4 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=4
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.00e-04 1.00e-04 | 52 | 1.69e-01 | 1.69e-01 | 1.10e-02 1.06e-01 1.11e-02 1.28e-01 76.1
            1  2      20 1.00e-04 0.00e+00 | 45 | 1.46e-01 | 3.15e-01 | 2.04e-02 1.98e-01 2.05e-02 2.39e-01 76
            2  2      20 1.00e-04 0.00e+00 | 31 | 1.09e-01 | 4.24e-01 | 2.69e-02 2.63e-01 2.71e-02 3.17e-01 74.8
            3  2      20 1.00e-04 0.00e+00 | 31 | 1.09e-01 | 5.33e-01 | 3.35e-02 3.27e-01 3.37e-02 3.95e-01 74
            4  2      20 1.00e-04 0.00e+00 | 31 | 1.10e-01 | 6.43e-01 | 4.00e-02 3.92e-01 4.03e-02 4.72e-01 73.4
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.50e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
            1      20 +5.26e-04 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.65e-13)
            2      20 +0.00e+00 e[0]=-2.65451696664 (-8.88e-16) e[1]=-2.43697745069 (-2.22e-15)
            3      20 +5.26e-04 e[0]=-2.65451696664 (-1.78e-15) e[1]=-2.43697745069 (3.11e-15)
            4      20 +0.00e+00 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep4.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep4_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
decimation summary: 80->8 dwt=-2.220e-16 SvN=1.326e+00

Convert [C]RRR => [cR]RRR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep4_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00

ctns::rcanon_save fname=./scratch/rcanon_isweep4.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.00e+00
 idx=2 node=(2,0) Drow=20 maxdiff=1.76e-15
 idx=3 node=(1,0) Drow=8 maxdiff=7.11e-16
 idx=4 node=(0,0) Drow=2 maxdiff=2.49e-16
stensor2: wf2 own=1 _data=0x44911ad0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.05e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x44911ad0
      1.2320e-17      -1.0000e+00 
     -1.0000e+00      -2.2806e-17 
 rwfuns: nroots=2 maxdiff=4.4434e-16
----- TIMING FOR ctns::rcanon_check : 8.471e-05 S -----
..... end of isweep = 4 .....

======================================================================
sweep parameters: isweep=5 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB

isweep=5 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.033e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB
===== CPUmem(GB): tot=3.61e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44929740
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.263e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.862e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00224 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.46e-05,0.00096,0.00122 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=5.1e-05 (comb,oper,dvdson,hvec,renorm)=3.11e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.5e-05,0.000202,0.00193,0.000186 cost=7.9e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=0.000202 t_gemm=0.00193 t_reduction=0.000186 tot=0.00232 ---
 sigma counter=191 i=0 t=0.000238 per=12.3 cost=7.01e+03 flops=2.94e+07
 sigma counter=191 i=1 t=0.000242 per=12.5 cost=6.99e+03 flops=2.89e+07
 sigma counter=191 i=2 t=0.000234 per=12.1 cost=6.81e+03 flops=2.91e+07
 sigma counter=191 i=3 t=0.000235 per=12.2 cost=6.78e+03 flops=2.89e+07
 sigma counter=191 i=4 t=0.000253 per=13.1 cost=1.89e+04 flops=7.47e+07
 sigma counter=191 i=5 t=0.000249 per=12.9 cost=1.89e+04 flops=7.59e+07
 sigma counter=191 i=6 t=0.000243 per=12.6 cost=6.78e+03 flops=2.79e+07
 sigma counter=191 i=7 t=0.00024 per=12.4 cost=6.81e+03 flops=2.84e+07
 total GEMM cost=7.9e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=0.0383 t_gemm=0.372 t_reduction=0.0368 tot=0.447 ---
 sigma_tot counter=191 i=0 t=0.0455 per=12.2 cost=1.16e+06 flops=2.55e+07
 sigma_tot counter=191 i=1 t=0.0469 per=12.6 cost=1.17e+06 flops=2.5e+07
 sigma_tot counter=191 i=2 t=0.0453 per=12.2 cost=1.17e+06 flops=2.58e+07
 sigma_tot counter=191 i=3 t=0.0457 per=12.3 cost=1.17e+06 flops=2.57e+07
 sigma_tot counter=191 i=4 t=0.046 per=12.3 cost=1.96e+06 flops=4.26e+07
 sigma_tot counter=191 i=5 t=0.0467 per=12.5 cost=1.95e+06 flops=4.18e+07
 sigma_tot counter=191 i=6 t=0.0496 per=13.3 cost=2.31e+06 flops=4.66e+07
 sigma_tot counter=191 i=7 t=0.0467 per=12.5 cost=2.31e+06 flops=4.94e+07
 total GEMM cost=1.32e+07 flops=3.55e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.7e-05,0.000198,0.00194,0.000193 cost=7.9e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=0.000197 t_gemm=0.00194 t_reduction=0.000193 tot=0.00233 ---
 sigma counter=192 i=0 t=0.000236 per=12.2 cost=7.01e+03 flops=2.97e+07
 sigma counter=192 i=1 t=0.000248 per=12.8 cost=6.99e+03 flops=2.82e+07
 sigma counter=192 i=2 t=0.00023 per=11.9 cost=6.81e+03 flops=2.96e+07
 sigma counter=192 i=3 t=0.000244 per=12.6 cost=6.78e+03 flops=2.78e+07
 sigma counter=192 i=4 t=0.000245 per=12.6 cost=1.89e+04 flops=7.71e+07
 sigma counter=192 i=5 t=0.000257 per=13.3 cost=1.89e+04 flops=7.35e+07
 sigma counter=192 i=6 t=0.000244 per=12.6 cost=6.78e+03 flops=2.78e+07
 sigma counter=192 i=7 t=0.000233 per=12 cost=6.81e+03 flops=2.92e+07
 total GEMM cost=7.9e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=0.0385 t_gemm=0.374 t_reduction=0.037 tot=0.45 ---
 sigma_tot counter=192 i=0 t=0.0458 per=12.2 cost=1.17e+06 flops=2.55e+07
 sigma_tot counter=192 i=1 t=0.0471 per=12.6 cost=1.18e+06 flops=2.5e+07
 sigma_tot counter=192 i=2 t=0.0455 per=12.2 cost=1.18e+06 flops=2.59e+07
 sigma_tot counter=192 i=3 t=0.046 per=12.3 cost=1.18e+06 flops=2.57e+07
 sigma_tot counter=192 i=4 t=0.0462 per=12.3 cost=1.98e+06 flops=4.28e+07
 sigma_tot counter=192 i=5 t=0.0469 per=12.5 cost=1.97e+06 flops=4.2e+07
 sigma_tot counter=192 i=6 t=0.0498 per=13.3 cost=2.32e+06 flops=4.66e+07
 sigma_tot counter=192 i=7 t=0.0469 per=12.5 cost=2.31e+06 flops=4.93e+07
 total GEMM cost=1.33e+07 flops=3.55e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891  -1.00e+03   6.88e-02    2     2   4.89e-03  2.45e-03
    1   1 -      -2.436233901339  -1.00e+03   4.38e-02    2     2   4.89e-03  2.45e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.80e-05,1.98e-04,1.93e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.10e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.93e-03 t_reduction=1.87e-04 tot=2.31e-03 ---
 sigma counter=193 i=0 t=2.35e-04 per=1.22e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=193 i=1 t=2.43e-04 per=1.26e+01 cost=6.99e+03 flops=2.88e+07
 sigma counter=193 i=2 t=2.37e-04 per=1.23e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=193 i=3 t=2.33e-04 per=1.21e+01 cost=6.78e+03 flops=2.91e+07
 sigma counter=193 i=4 t=2.45e-04 per=1.27e+01 cost=1.89e+04 flops=7.71e+07
 sigma counter=193 i=5 t=2.56e-04 per=1.33e+01 cost=1.89e+04 flops=7.38e+07
 sigma counter=193 i=6 t=2.44e-04 per=1.27e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=193 i=7 t=2.33e-04 per=1.21e+01 cost=6.81e+03 flops=2.92e+07
 total GEMM cost=7.90e+04 flops=4.10e+07
--- TIMING FOR sigma_tot : t_inter=3.87e-02 t_gemm=3.76e-01 t_reduction=3.71e-02 tot=4.52e-01 ---
 sigma_tot counter=193 i=0 t=4.60e-02 per=1.22e+01 cost=1.17e+06 flops=2.55e+07
 sigma_tot counter=193 i=1 t=4.74e-02 per=1.26e+01 cost=1.18e+06 flops=2.50e+07
 sigma_tot counter=193 i=2 t=4.57e-02 per=1.22e+01 cost=1.18e+06 flops=2.59e+07
 sigma_tot counter=193 i=3 t=4.62e-02 per=1.23e+01 cost=1.19e+06 flops=2.57e+07
 sigma_tot counter=193 i=4 t=4.64e-02 per=1.23e+01 cost=1.99e+06 flops=4.29e+07
 sigma_tot counter=193 i=5 t=4.72e-02 per=1.25e+01 cost=1.99e+06 flops=4.22e+07
 sigma_tot counter=193 i=6 t=5.01e-02 per=1.33e+01 cost=2.33e+06 flops=4.65e+07
 sigma_tot counter=193 i=7 t=4.71e-02 per=1.25e+01 cost=2.32e+06 flops=4.92e+07
 total GEMM cost=1.34e+07 flops=3.55e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.98e-04,1.94e-03,2.07e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.94e-03 t_reduction=2.07e-04 tot=2.35e-03 ---
 sigma counter=194 i=0 t=2.36e-04 per=1.22e+01 cost=7.01e+03 flops=2.97e+07
 sigma counter=194 i=1 t=2.45e-04 per=1.26e+01 cost=6.99e+03 flops=2.85e+07
 sigma counter=194 i=2 t=2.39e-04 per=1.23e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=194 i=3 t=2.35e-04 per=1.21e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=194 i=4 t=2.55e-04 per=1.31e+01 cost=1.89e+04 flops=7.41e+07
 sigma counter=194 i=5 t=2.58e-04 per=1.33e+01 cost=1.89e+04 flops=7.32e+07
 sigma counter=194 i=6 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=194 i=7 t=2.30e-04 per=1.18e+01 cost=6.81e+03 flops=2.96e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=3.89e-02 t_gemm=3.78e-01 t_reduction=3.73e-02 tot=4.54e-01 ---
 sigma_tot counter=194 i=0 t=4.63e-02 per=1.22e+01 cost=1.18e+06 flops=2.55e+07
 sigma_tot counter=194 i=1 t=4.76e-02 per=1.26e+01 cost=1.19e+06 flops=2.50e+07
 sigma_tot counter=194 i=2 t=4.60e-02 per=1.22e+01 cost=1.19e+06 flops=2.59e+07
 sigma_tot counter=194 i=3 t=4.64e-02 per=1.23e+01 cost=1.19e+06 flops=2.57e+07
 sigma_tot counter=194 i=4 t=4.67e-02 per=1.24e+01 cost=2.01e+06 flops=4.31e+07
 sigma_tot counter=194 i=5 t=4.75e-02 per=1.26e+01 cost=2.01e+06 flops=4.23e+07
 sigma_tot counter=194 i=6 t=5.03e-02 per=1.33e+01 cost=2.33e+06 flops=4.64e+07
 sigma_tot counter=194 i=7 t=4.74e-02 per=1.25e+01 cost=2.33e+06 flops=4.91e+07
 total GEMM cost=1.34e+07 flops=3.55e+07
    2   0 -      -2.654428675110  -1.73e-03   1.26e-02    4     4   9.81e-03  2.45e-03
    2   1 -      -2.436964455587  -7.31e-04   4.22e-03    4     4   9.81e-03  2.45e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.99e-04,1.95e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.95e-03 t_reduction=1.88e-04 tot=2.34e-03 ---
 sigma counter=195 i=0 t=2.36e-04 per=1.21e+01 cost=7.01e+03 flops=2.97e+07
 sigma counter=195 i=1 t=2.50e-04 per=1.28e+01 cost=6.99e+03 flops=2.80e+07
 sigma counter=195 i=2 t=2.37e-04 per=1.22e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=195 i=3 t=2.36e-04 per=1.21e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=195 i=4 t=2.52e-04 per=1.29e+01 cost=1.89e+04 flops=7.50e+07
 sigma counter=195 i=5 t=2.50e-04 per=1.28e+01 cost=1.89e+04 flops=7.56e+07
 sigma counter=195 i=6 t=2.47e-04 per=1.27e+01 cost=6.78e+03 flops=2.75e+07
 sigma counter=195 i=7 t=2.41e-04 per=1.24e+01 cost=6.81e+03 flops=2.83e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=3.91e-02 t_gemm=3.80e-01 t_reduction=3.75e-02 tot=4.57e-01 ---
 sigma_tot counter=195 i=0 t=4.65e-02 per=1.22e+01 cost=1.19e+06 flops=2.55e+07
 sigma_tot counter=195 i=1 t=4.79e-02 per=1.26e+01 cost=1.20e+06 flops=2.50e+07
 sigma_tot counter=195 i=2 t=4.62e-02 per=1.22e+01 cost=1.20e+06 flops=2.59e+07
 sigma_tot counter=195 i=3 t=4.67e-02 per=1.23e+01 cost=1.20e+06 flops=2.57e+07
 sigma_tot counter=195 i=4 t=4.70e-02 per=1.24e+01 cost=2.03e+06 flops=4.33e+07
 sigma_tot counter=195 i=5 t=4.77e-02 per=1.26e+01 cost=2.03e+06 flops=4.25e+07
 sigma_tot counter=195 i=6 t=5.06e-02 per=1.33e+01 cost=2.34e+06 flops=4.63e+07
 sigma_tot counter=195 i=7 t=4.76e-02 per=1.25e+01 cost=2.33e+06 flops=4.90e+07
 total GEMM cost=1.35e+07 flops=3.56e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.98e-04,1.96e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=1.97e-04 t_gemm=1.96e-03 t_reduction=1.89e-04 tot=2.34e-03 ---
 sigma counter=196 i=0 t=2.40e-04 per=1.23e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=196 i=1 t=2.51e-04 per=1.28e+01 cost=6.99e+03 flops=2.78e+07
 sigma counter=196 i=2 t=2.40e-04 per=1.23e+01 cost=6.81e+03 flops=2.84e+07
 sigma counter=196 i=3 t=2.42e-04 per=1.24e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=196 i=4 t=2.53e-04 per=1.29e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=196 i=5 t=2.49e-04 per=1.27e+01 cost=1.89e+04 flops=7.59e+07
 sigma counter=196 i=6 t=2.42e-04 per=1.24e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=196 i=7 t=2.41e-04 per=1.23e+01 cost=6.81e+03 flops=2.83e+07
 total GEMM cost=7.90e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=3.93e-02 t_gemm=3.82e-01 t_reduction=3.77e-02 tot=4.59e-01 ---
 sigma_tot counter=196 i=0 t=4.67e-02 per=1.22e+01 cost=1.19e+06 flops=2.56e+07
 sigma_tot counter=196 i=1 t=4.81e-02 per=1.26e+01 cost=1.20e+06 flops=2.50e+07
 sigma_tot counter=196 i=2 t=4.64e-02 per=1.22e+01 cost=1.20e+06 flops=2.59e+07
 sigma_tot counter=196 i=3 t=4.69e-02 per=1.23e+01 cost=1.21e+06 flops=2.58e+07
 sigma_tot counter=196 i=4 t=4.72e-02 per=1.24e+01 cost=2.05e+06 flops=4.34e+07
 sigma_tot counter=196 i=5 t=4.80e-02 per=1.26e+01 cost=2.05e+06 flops=4.27e+07
 sigma_tot counter=196 i=6 t=5.08e-02 per=1.33e+01 cost=2.35e+06 flops=4.62e+07
 sigma_tot counter=196 i=7 t=4.78e-02 per=1.25e+01 cost=2.34e+06 flops=4.89e+07
 total GEMM cost=1.36e+07 flops=3.56e+07
    3   0 -      -2.654509664652  -8.10e-05   3.66e-03    6     6   1.47e-02  2.46e-03
    3   1 -      -2.436976459250  -1.20e-05   1.11e-03    6     6   1.47e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.04e-04,1.95e-03,1.90e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=2.04e-04 t_gemm=1.95e-03 t_reduction=1.90e-04 tot=2.35e-03 ---
 sigma counter=197 i=0 t=2.35e-04 per=1.20e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=197 i=1 t=2.44e-04 per=1.25e+01 cost=6.99e+03 flops=2.86e+07
 sigma counter=197 i=2 t=2.44e-04 per=1.25e+01 cost=6.81e+03 flops=2.79e+07
 sigma counter=197 i=3 t=2.40e-04 per=1.23e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=197 i=4 t=2.49e-04 per=1.27e+01 cost=1.89e+04 flops=7.59e+07
 sigma counter=197 i=5 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=197 i=6 t=2.57e-04 per=1.32e+01 cost=6.78e+03 flops=2.64e+07
 sigma counter=197 i=7 t=2.31e-04 per=1.18e+01 cost=6.81e+03 flops=2.95e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=3.95e-02 t_gemm=3.84e-01 t_reduction=3.79e-02 tot=4.61e-01 ---
 sigma_tot counter=197 i=0 t=4.70e-02 per=1.22e+01 cost=1.20e+06 flops=2.56e+07
 sigma_tot counter=197 i=1 t=4.84e-02 per=1.26e+01 cost=1.21e+06 flops=2.51e+07
 sigma_tot counter=197 i=2 t=4.67e-02 per=1.22e+01 cost=1.21e+06 flops=2.59e+07
 sigma_tot counter=197 i=3 t=4.71e-02 per=1.23e+01 cost=1.21e+06 flops=2.58e+07
 sigma_tot counter=197 i=4 t=4.75e-02 per=1.24e+01 cost=2.07e+06 flops=4.36e+07
 sigma_tot counter=197 i=5 t=4.82e-02 per=1.26e+01 cost=2.07e+06 flops=4.29e+07
 sigma_tot counter=197 i=6 t=5.11e-02 per=1.33e+01 cost=2.35e+06 flops=4.61e+07
 sigma_tot counter=197 i=7 t=4.81e-02 per=1.25e+01 cost=2.35e+06 flops=4.88e+07
 total GEMM cost=1.37e+07 flops=3.56e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.97e-04,1.95e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=1.97e-04 t_gemm=1.95e-03 t_reduction=1.88e-04 tot=2.33e-03 ---
 sigma counter=198 i=0 t=2.36e-04 per=1.21e+01 cost=7.01e+03 flops=2.97e+07
 sigma counter=198 i=1 t=2.52e-04 per=1.29e+01 cost=6.99e+03 flops=2.77e+07
 sigma counter=198 i=2 t=2.38e-04 per=1.22e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=198 i=3 t=2.36e-04 per=1.21e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=198 i=4 t=2.53e-04 per=1.30e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=198 i=5 t=2.51e-04 per=1.29e+01 cost=1.89e+04 flops=7.53e+07
 sigma counter=198 i=6 t=2.43e-04 per=1.25e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=198 i=7 t=2.41e-04 per=1.24e+01 cost=6.81e+03 flops=2.83e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=3.97e-02 t_gemm=3.86e-01 t_reduction=3.81e-02 tot=4.64e-01 ---
 sigma_tot counter=198 i=0 t=4.72e-02 per=1.22e+01 cost=1.21e+06 flops=2.56e+07
 sigma_tot counter=198 i=1 t=4.86e-02 per=1.26e+01 cost=1.22e+06 flops=2.51e+07
 sigma_tot counter=198 i=2 t=4.69e-02 per=1.22e+01 cost=1.22e+06 flops=2.59e+07
 sigma_tot counter=198 i=3 t=4.74e-02 per=1.23e+01 cost=1.22e+06 flops=2.58e+07
 sigma_tot counter=198 i=4 t=4.77e-02 per=1.24e+01 cost=2.09e+06 flops=4.38e+07
 sigma_tot counter=198 i=5 t=4.85e-02 per=1.26e+01 cost=2.09e+06 flops=4.30e+07
 sigma_tot counter=198 i=6 t=5.13e-02 per=1.33e+01 cost=2.36e+06 flops=4.60e+07
 sigma_tot counter=198 i=7 t=4.83e-02 per=1.25e+01 cost=2.35e+06 flops=4.87e+07
 total GEMM cost=1.38e+07 flops=3.56e+07
    4   0 -      -2.654516020764  -6.36e-06   1.14e-03    6     8   1.97e-02  2.46e-03
    4   1 -      -2.436977285934  -8.27e-07   4.03e-04    6     8   1.97e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.03e-04,1.96e-03,1.94e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=2.03e-04 t_gemm=1.96e-03 t_reduction=1.93e-04 tot=2.35e-03 ---
 sigma counter=199 i=0 t=2.37e-04 per=1.21e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=199 i=1 t=2.44e-04 per=1.25e+01 cost=6.99e+03 flops=2.86e+07
 sigma counter=199 i=2 t=2.33e-04 per=1.19e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=199 i=3 t=2.35e-04 per=1.20e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=199 i=4 t=2.55e-04 per=1.30e+01 cost=1.89e+04 flops=7.41e+07
 sigma counter=199 i=5 t=2.50e-04 per=1.28e+01 cost=1.89e+04 flops=7.56e+07
 sigma counter=199 i=6 t=2.61e-04 per=1.33e+01 cost=6.78e+03 flops=2.60e+07
 sigma counter=199 i=7 t=2.41e-04 per=1.23e+01 cost=6.81e+03 flops=2.83e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=3.99e-02 t_gemm=3.88e-01 t_reduction=3.83e-02 tot=4.66e-01 ---
 sigma_tot counter=199 i=0 t=4.74e-02 per=1.22e+01 cost=1.22e+06 flops=2.56e+07
 sigma_tot counter=199 i=1 t=4.89e-02 per=1.26e+01 cost=1.23e+06 flops=2.51e+07
 sigma_tot counter=199 i=2 t=4.72e-02 per=1.22e+01 cost=1.22e+06 flops=2.60e+07
 sigma_tot counter=199 i=3 t=4.76e-02 per=1.23e+01 cost=1.23e+06 flops=2.58e+07
 sigma_tot counter=199 i=4 t=4.80e-02 per=1.24e+01 cost=2.11e+06 flops=4.39e+07
 sigma_tot counter=199 i=5 t=4.87e-02 per=1.26e+01 cost=2.10e+06 flops=4.32e+07
 sigma_tot counter=199 i=6 t=5.16e-02 per=1.33e+01 cost=2.37e+06 flops=4.59e+07
 sigma_tot counter=199 i=7 t=4.86e-02 per=1.25e+01 cost=2.36e+06 flops=4.86e+07
 total GEMM cost=1.38e+07 flops=3.57e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,2.01e-04,1.96e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=2.01e-04 t_gemm=1.96e-03 t_reduction=1.86e-04 tot=2.34e-03 ---
 sigma counter=200 i=0 t=2.38e-04 per=1.22e+01 cost=7.01e+03 flops=2.94e+07
 sigma counter=200 i=1 t=2.57e-04 per=1.31e+01 cost=6.99e+03 flops=2.72e+07
 sigma counter=200 i=2 t=2.32e-04 per=1.19e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=200 i=3 t=2.34e-04 per=1.20e+01 cost=6.78e+03 flops=2.90e+07
 sigma counter=200 i=4 t=2.53e-04 per=1.29e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=200 i=5 t=2.60e-04 per=1.33e+01 cost=1.89e+04 flops=7.27e+07
 sigma counter=200 i=6 t=2.43e-04 per=1.24e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=200 i=7 t=2.39e-04 per=1.22e+01 cost=6.81e+03 flops=2.85e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=4.01e-02 t_gemm=3.90e-01 t_reduction=3.85e-02 tot=4.68e-01 ---
 sigma_tot counter=200 i=0 t=4.77e-02 per=1.22e+01 cost=1.22e+06 flops=2.56e+07
 sigma_tot counter=200 i=1 t=4.91e-02 per=1.26e+01 cost=1.23e+06 flops=2.51e+07
 sigma_tot counter=200 i=2 t=4.74e-02 per=1.22e+01 cost=1.23e+06 flops=2.60e+07
 sigma_tot counter=200 i=3 t=4.79e-02 per=1.23e+01 cost=1.24e+06 flops=2.58e+07
 sigma_tot counter=200 i=4 t=4.82e-02 per=1.24e+01 cost=2.13e+06 flops=4.41e+07
 sigma_tot counter=200 i=5 t=4.90e-02 per=1.26e+01 cost=2.12e+06 flops=4.34e+07
 sigma_tot counter=200 i=6 t=5.18e-02 per=1.33e+01 cost=2.37e+06 flops=4.58e+07
 sigma_tot counter=200 i=7 t=4.88e-02 per=1.25e+01 cost=2.37e+06 flops=4.85e+07
 total GEMM cost=1.39e+07 flops=3.57e+07
    5   0 -      -2.654516818921  -7.98e-07   4.45e-04    6    10   2.46e-02  2.46e-03
    5   1 -      -2.436977409925  -1.24e-07   2.05e-04    6    10   2.46e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.99e-04,1.94e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.94e-03 t_reduction=1.89e-04 tot=2.33e-03 ---
 sigma counter=201 i=0 t=2.36e-04 per=1.22e+01 cost=7.01e+03 flops=2.97e+07
 sigma counter=201 i=1 t=2.48e-04 per=1.28e+01 cost=6.99e+03 flops=2.82e+07
 sigma counter=201 i=2 t=2.38e-04 per=1.23e+01 cost=6.81e+03 flops=2.86e+07
 sigma counter=201 i=3 t=2.39e-04 per=1.23e+01 cost=6.78e+03 flops=2.84e+07
 sigma counter=201 i=4 t=2.53e-04 per=1.31e+01 cost=1.89e+04 flops=7.47e+07
 sigma counter=201 i=5 t=2.50e-04 per=1.29e+01 cost=1.89e+04 flops=7.56e+07
 sigma counter=201 i=6 t=2.43e-04 per=1.25e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=201 i=7 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 total GEMM cost=7.90e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=4.03e-02 t_gemm=3.92e-01 t_reduction=3.87e-02 tot=4.71e-01 ---
 sigma_tot counter=201 i=0 t=4.79e-02 per=1.22e+01 cost=1.23e+06 flops=2.57e+07
 sigma_tot counter=201 i=1 t=4.94e-02 per=1.26e+01 cost=1.24e+06 flops=2.51e+07
 sigma_tot counter=201 i=2 t=4.76e-02 per=1.22e+01 cost=1.24e+06 flops=2.60e+07
 sigma_tot counter=201 i=3 t=4.81e-02 per=1.23e+01 cost=1.24e+06 flops=2.58e+07
 sigma_tot counter=201 i=4 t=4.85e-02 per=1.24e+01 cost=2.15e+06 flops=4.43e+07
 sigma_tot counter=201 i=5 t=4.92e-02 per=1.26e+01 cost=2.14e+06 flops=4.35e+07
 sigma_tot counter=201 i=6 t=5.21e-02 per=1.33e+01 cost=2.38e+06 flops=4.57e+07
 sigma_tot counter=201 i=7 t=4.90e-02 per=1.25e+01 cost=2.37e+06 flops=4.84e+07
 total GEMM cost=1.40e+07 flops=3.57e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.97e-04,1.94e-03,1.87e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=1.97e-04 t_gemm=1.94e-03 t_reduction=1.87e-04 tot=2.33e-03 ---
 sigma counter=202 i=0 t=2.35e-04 per=1.21e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=202 i=1 t=2.49e-04 per=1.28e+01 cost=6.99e+03 flops=2.81e+07
 sigma counter=202 i=2 t=2.39e-04 per=1.23e+01 cost=6.81e+03 flops=2.85e+07
 sigma counter=202 i=3 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=202 i=4 t=2.43e-04 per=1.25e+01 cost=1.89e+04 flops=7.78e+07
 sigma counter=202 i=5 t=2.50e-04 per=1.29e+01 cost=1.89e+04 flops=7.56e+07
 sigma counter=202 i=6 t=2.44e-04 per=1.26e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=202 i=7 t=2.40e-04 per=1.23e+01 cost=6.81e+03 flops=2.84e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=4.05e-02 t_gemm=3.94e-01 t_reduction=3.89e-02 tot=4.73e-01 ---
 sigma_tot counter=202 i=0 t=4.81e-02 per=1.22e+01 cost=1.24e+06 flops=2.57e+07
 sigma_tot counter=202 i=1 t=4.96e-02 per=1.26e+01 cost=1.25e+06 flops=2.51e+07
 sigma_tot counter=202 i=2 t=4.79e-02 per=1.22e+01 cost=1.24e+06 flops=2.60e+07
 sigma_tot counter=202 i=3 t=4.83e-02 per=1.23e+01 cost=1.25e+06 flops=2.58e+07
 sigma_tot counter=202 i=4 t=4.87e-02 per=1.24e+01 cost=2.16e+06 flops=4.44e+07
 sigma_tot counter=202 i=5 t=4.95e-02 per=1.26e+01 cost=2.16e+06 flops=4.37e+07
 sigma_tot counter=202 i=6 t=5.23e-02 per=1.33e+01 cost=2.39e+06 flops=4.57e+07
 sigma_tot counter=202 i=7 t=4.93e-02 per=1.25e+01 cost=2.38e+06 flops=4.83e+07
 total GEMM cost=1.41e+07 flops=3.57e+07
    6   0 -      -2.654516950786  -1.32e-07   1.57e-04    6    12   2.95e-02  2.46e-03
    6   1 +      -2.436977447171  -3.72e-08   7.42e-05    6    12   2.95e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,2.02e-04,1.97e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.02e+07
--- TIMING FOR sigma : t_inter=2.02e-04 t_gemm=1.97e-03 t_reduction=1.88e-04 tot=2.36e-03 ---
 sigma counter=203 i=0 t=2.37e-04 per=1.21e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=203 i=1 t=2.56e-04 per=1.30e+01 cost=6.99e+03 flops=2.73e+07
 sigma counter=203 i=2 t=2.41e-04 per=1.23e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=203 i=3 t=2.40e-04 per=1.22e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=203 i=4 t=2.46e-04 per=1.25e+01 cost=1.89e+04 flops=7.68e+07
 sigma counter=203 i=5 t=2.60e-04 per=1.32e+01 cost=1.89e+04 flops=7.27e+07
 sigma counter=203 i=6 t=2.49e-04 per=1.27e+01 cost=6.78e+03 flops=2.72e+07
 sigma counter=203 i=7 t=2.37e-04 per=1.21e+01 cost=6.81e+03 flops=2.88e+07
 total GEMM cost=7.90e+04 flops=4.02e+07
--- TIMING FOR sigma_tot : t_inter=4.07e-02 t_gemm=3.96e-01 t_reduction=3.90e-02 tot=4.75e-01 ---
 sigma_tot counter=203 i=0 t=4.84e-02 per=1.22e+01 cost=1.24e+06 flops=2.57e+07
 sigma_tot counter=203 i=1 t=4.99e-02 per=1.26e+01 cost=1.25e+06 flops=2.51e+07
 sigma_tot counter=203 i=2 t=4.81e-02 per=1.22e+01 cost=1.25e+06 flops=2.60e+07
 sigma_tot counter=203 i=3 t=4.86e-02 per=1.23e+01 cost=1.26e+06 flops=2.58e+07
 sigma_tot counter=203 i=4 t=4.90e-02 per=1.24e+01 cost=2.18e+06 flops=4.46e+07
 sigma_tot counter=203 i=5 t=4.97e-02 per=1.26e+01 cost=2.18e+06 flops=4.38e+07
 sigma_tot counter=203 i=6 t=5.26e-02 per=1.33e+01 cost=2.40e+06 flops=4.56e+07
 sigma_tot counter=203 i=7 t=4.95e-02 per=1.25e+01 cost=2.39e+06 flops=4.82e+07
 total GEMM cost=1.42e+07 flops=3.58e+07
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   3.20e-02  2.47e-03
    7   1 +      -2.436977447171  -8.88e-16   7.42e-05    5    13   3.20e-02  2.47e-03
TIMING for Davidson : 3.21e-02  T(cal/comm/rest)=3.17e-02,7.49e-07,3.34e-04
optimized energies: isweep=5 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=5 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.975e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000552 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=5.19e-05,0.00022,0.000281 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8e-06,0.00106,0.000188 cost=2.78e+04 flops[gemm]=2.62e+07
--- TIMING FOR renorm : t_inter=8e-06 t_gemm=0.00106 t_reduction=0.000188 tot=0.00126 ---
 renorm counter=21 i=0 t=0.000208 per=19.6 cost=2.19e+03 flops=1.05e+07
 renorm counter=21 i=1 t=0.000208 per=19.6 cost=2.85e+03 flops=1.37e+07
 renorm counter=21 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=21 i=3 t=1e-06 per=0.0942 cost=0 flops=0
 renorm counter=21 i=4 t=0.000202 per=19 cost=2.11e+03 flops=1.04e+07
 renorm counter=21 i=5 t=0.000206 per=19.4 cost=2.94e+03 flops=1.43e+07
 renorm counter=21 i=6 t=0.000237 per=22.3 cost=1.77e+04 flops=7.47e+07
 total GEMM cost=2.78e+04 flops=2.62e+07
--- TIMING FOR renorm_tot : t_inter=0.00194 t_gemm=0.0227 t_reduction=0.00395 tot=0.0285 ---
 renorm_tot counter=21 i=0 t=0.00444 per=19.6 cost=8e+04 flops=1.8e+07
 renorm_tot counter=21 i=1 t=0.00446 per=19.7 cost=1.16e+05 flops=2.61e+07
 renorm_tot counter=21 i=2 t=0.00204 per=9.01 cost=7.99e+04 flops=3.91e+07
 renorm_tot counter=21 i=3 t=0.00212 per=9.38 cost=1.39e+05 flops=6.55e+07
 renorm_tot counter=21 i=4 t=0.00226 per=10 cost=8.22e+04 flops=3.63e+07
 renorm_tot counter=21 i=5 t=0.00233 per=10.3 cost=1.41e+05 flops=6.06e+07
 renorm_tot counter=21 i=6 t=0.005 per=22.1 cost=9.68e+05 flops=1.94e+08
 total GEMM cost=1.61e+06 flops=7.09e+07
check ||H-H.dagger||=0.00e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=9.2e-05,0.0025,8.7e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=3.1e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(1,0) size=1.03e-05GB T[save](info/data/tot)=6.53e-05,4.87e-05,0.000114 speed=0.0908GB/s disk[used]=0.000103GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond0.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond0.info
##### time_local: 3.97e-02 S #####
 T(fetch) = 7.05e-05 S  per = 0.18  per(accum) = 0.18
 T(hdiag) = 7.31e-05 S  per = 0.18  per(accum) = 0.36
 T(dvdsn) = 3.62e-02 S  per =   91  per(accum) = 91
 T(decim) = 8.10e-05 S  per =  0.2  per(accum) = 92
 T(guess) = 8.02e-05 S  per =  0.2  per(accum) = 92
 T(renrm) = 2.65e-03 S  per =  6.7  per(accum) = 99
 T(save ) = 5.80e-04 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.60e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.04e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 2.31e-04 S  per = 0.64  per(accum) = 0.75
 T(hintermediate init           ) = 2.15e-05 S  per = 0.06  per(accum) = 0.81
 T(hintermediates memcpy cpu2gpu) = 3.54e-06 S  per = 0.0098  per(accum) = 0.82
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =  6.2  per(accum) = 7.1
 T(hmmtasks init                ) = 1.40e-03 S  per =  3.9  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 3.17e-02 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 7.49e-07 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.34e-04 S  per = 0.93  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.60e-03 S
 T(qops init                    ) = 9.19e-05 S  per =  3.5  per(accum) = 3.5
 T(qops_dict memcpy cpu2gpu     ) = 2.83e-05 S  per =  1.1  per(accum) = 4.6
 T(symbolic_formulae_renorm     ) = 2.02e-04 S  per =  7.8  per(accum) = 12
 T(rintermediate init           ) = 9.60e-06 S  per = 0.37  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.77e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.61e-04 S  per =   22  per(accum) = 35
 T(rmmtasks init                ) = 3.31e-04 S  per =   13  per(accum) = 47
 T(qops memset                  ) = 8.31e-06 S  per = 0.32  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.33e-03 S  per =   51  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.77e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.69e-06 S  per = 0.33  per(accum) = 1e+02
##### time_sweep: 3.97e-02 S #####
 T(fetch) = 7.05e-05 S  per = 0.18  per(accum) = 0.18
 T(hdiag) = 7.31e-05 S  per = 0.18  per(accum) = 0.36
 T(dvdsn) = 3.62e-02 S  per =   91  per(accum) = 91
 T(decim) = 8.10e-05 S  per =  0.2  per(accum) = 92
 T(guess) = 8.02e-05 S  per =  0.2  per(accum) = 92
 T(renrm) = 2.65e-03 S  per =  6.7  per(accum) = 99
 T(save ) = 5.80e-04 S  per =  1.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.60e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 4.04e-05 S  per = 0.11  per(accum) = 0.11
 T(symbolic_formulae_twodot     ) = 2.31e-04 S  per = 0.64  per(accum) = 0.75
 T(hintermediate init           ) = 2.15e-05 S  per = 0.06  per(accum) = 0.81
 T(hintermediates memcpy cpu2gpu) = 3.54e-06 S  per = 0.0098  per(accum) = 0.82
 T(preprocess_hformulae_Hxlist2 ) = 2.25e-03 S  per =  6.2  per(accum) = 7.1
 T(hmmtasks init                ) = 1.40e-03 S  per =  3.9  per(accum) = 11
 T(dvdson solver [Hx_batchGPU]  ) = 3.17e-02 S  per =   88  per(accum) = 99
 T(dvdson solver [communication]) = 7.49e-07 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.34e-04 S  per = 0.93  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.60e-03 S
 T(qops init                    ) = 9.19e-05 S  per =  3.5  per(accum) = 3.5
 T(qops_dict memcpy cpu2gpu     ) = 2.83e-05 S  per =  1.1  per(accum) = 4.6
 T(symbolic_formulae_renorm     ) = 2.02e-04 S  per =  7.8  per(accum) = 12
 T(rintermediate init           ) = 9.60e-06 S  per = 0.37  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.77e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.61e-04 S  per =   22  per(accum) = 35
 T(rmmtasks init                ) = 3.31e-04 S  per =   13  per(accum) = 47
 T(qops memset                  ) = 8.31e-06 S  per = 0.32  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.33e-03 S  per =   51  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.77e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.69e-06 S  per = 0.33  per(accum) = 1e+02
##### time_global: 6.76e-01 S #####
 T(fetch) = 4.56e-03 S  per = 0.67  per(accum) = 0.67
 T(hdiag) = 1.64e-03 S  per = 0.24  per(accum) = 0.92
 T(dvdsn) = 5.93e-01 S  per =   88  per(accum) = 89
 T(decim) = 4.91e-03 S  per = 0.73  per(accum) = 89
 T(guess) = 1.76e-03 S  per = 0.26  per(accum) = 90
 T(renrm) = 5.85e-02 S  per =  8.6  per(accum) = 98
 T(save ) = 1.21e-02 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 5.89e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 8.67e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 5.24e-03 S  per = 0.89  per(accum) = 1
 T(hintermediate init           ) = 5.17e-04 S  per = 0.088  per(accum) = 1.1
 T(hintermediates memcpy cpu2gpu) = 8.38e-05 S  per = 0.014  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 4.78e-02 S  per =  8.1  per(accum) = 9.3
 T(hmmtasks init                ) = 2.98e-02 S  per =  5.1  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 4.99e-01 S  per =   85  per(accum) = 99
 T(dvdson solver [communication]) = 1.27e-05 S  per = 0.0022  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.53e-03 S  per = 0.94  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.75e-02 S
 T(qops init                    ) = 2.25e-03 S  per =  3.9  per(accum) = 3.9
 T(qops_dict memcpy cpu2gpu     ) = 7.16e-04 S  per =  1.2  per(accum) = 5.2
 T(symbolic_formulae_renorm     ) = 4.30e-03 S  per =  7.5  per(accum) = 13
 T(rintermediate init           ) = 3.51e-04 S  per = 0.61  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 1.06e-04 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 1.14e-02 S  per =   20  per(accum) = 33
 T(rmmtasks init                ) = 7.21e-03 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 1.83e-04 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 3.02e-02 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 6.01e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.88e-04 S  per = 0.33  per(accum) = 1e+02

isweep=5 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.361e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x4496fe70
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.239e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.879e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00225 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.33e-05,0.00098,0.00122 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.6e-05,0.000201,0.00195,0.000186 cost=7.9e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0.000201 t_gemm=0.00195 t_reduction=0.000186 tot=0.00233 ---
 sigma counter=204 i=0 t=0.000243 per=12.5 cost=6.81e+03 flops=2.8e+07
 sigma counter=204 i=1 t=0.000239 per=12.3 cost=6.78e+03 flops=2.84e+07
 sigma counter=204 i=2 t=0.000243 per=12.5 cost=7.01e+03 flops=2.88e+07
 sigma counter=204 i=3 t=0.000235 per=12.1 cost=6.99e+03 flops=2.97e+07
 sigma counter=204 i=4 t=0.000241 per=12.4 cost=6.81e+03 flops=2.83e+07
 sigma counter=204 i=5 t=0.000234 per=12 cost=6.78e+03 flops=2.9e+07
 sigma counter=204 i=6 t=0.00026 per=13.3 cost=1.89e+04 flops=7.27e+07
 sigma counter=204 i=7 t=0.000253 per=13 cost=1.89e+04 flops=7.47e+07
 total GEMM cost=7.9e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0.0409 t_gemm=0.398 t_reduction=0.0392 tot=0.478 ---
 sigma_tot counter=204 i=0 t=0.0486 per=12.2 cost=1.25e+06 flops=2.57e+07
 sigma_tot counter=204 i=1 t=0.0501 per=12.6 cost=1.26e+06 flops=2.52e+07
 sigma_tot counter=204 i=2 t=0.0484 per=12.2 cost=1.26e+06 flops=2.6e+07
 sigma_tot counter=204 i=3 t=0.0488 per=12.3 cost=1.26e+06 flops=2.59e+07
 sigma_tot counter=204 i=4 t=0.0492 per=12.4 cost=2.19e+06 flops=4.45e+07
 sigma_tot counter=204 i=5 t=0.05 per=12.6 cost=2.19e+06 flops=4.38e+07
 sigma_tot counter=204 i=6 t=0.0528 per=13.3 cost=2.41e+06 flops=4.57e+07
 sigma_tot counter=204 i=7 t=0.0498 per=12.5 cost=2.41e+06 flops=4.84e+07
 total GEMM cost=1.42e+07 flops=3.58e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.8e-05,0.000198,0.00196,0.000188 cost=7.9e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=0.000198 t_gemm=0.00196 t_reduction=0.000188 tot=0.00234 ---
 sigma counter=205 i=0 t=0.000234 per=12 cost=6.81e+03 flops=2.91e+07
 sigma counter=205 i=1 t=0.000247 per=12.6 cost=6.78e+03 flops=2.75e+07
 sigma counter=205 i=2 t=0.000232 per=11.9 cost=7.01e+03 flops=3.02e+07
 sigma counter=205 i=3 t=0.00025 per=12.8 cost=6.99e+03 flops=2.8e+07
 sigma counter=205 i=4 t=0.00023 per=11.8 cost=6.81e+03 flops=2.96e+07
 sigma counter=205 i=5 t=0.000236 per=12.1 cost=6.78e+03 flops=2.87e+07
 sigma counter=205 i=6 t=0.000268 per=13.7 cost=1.89e+04 flops=7.05e+07
 sigma counter=205 i=7 t=0.000259 per=13.2 cost=1.89e+04 flops=7.3e+07
 total GEMM cost=7.9e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=0.0411 t_gemm=0.4 t_reduction=0.0394 tot=0.48 ---
 sigma_tot counter=205 i=0 t=0.0489 per=12.2 cost=1.26e+06 flops=2.57e+07
 sigma_tot counter=205 i=1 t=0.0504 per=12.6 cost=1.27e+06 flops=2.52e+07
 sigma_tot counter=205 i=2 t=0.0486 per=12.2 cost=1.27e+06 flops=2.6e+07
 sigma_tot counter=205 i=3 t=0.0491 per=12.3 cost=1.27e+06 flops=2.59e+07
 sigma_tot counter=205 i=4 t=0.0494 per=12.4 cost=2.2e+06 flops=4.44e+07
 sigma_tot counter=205 i=5 t=0.0502 per=12.6 cost=2.19e+06 flops=4.37e+07
 sigma_tot counter=205 i=6 t=0.0531 per=13.3 cost=2.43e+06 flops=4.58e+07
 sigma_tot counter=205 i=7 t=0.05 per=12.5 cost=2.43e+06 flops=4.85e+07
 total GEMM cost=1.43e+07 flops=3.58e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   4.92e-03  2.46e-03
    1   1 +      -2.436977447171  -1.00e+03   7.42e-05    2     2   4.92e-03  2.46e-03
TIMING for Davidson : 4.94e-03  T(cal/comm/rest)=4.90e-03,8.40e-08,4.22e-05
optimized energies: isweep=5 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=5 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep5_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.720e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 1.798e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=3.26e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Rlist : 0.000509 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.45e-05,0.00022,0.000245 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000932 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07,0.0009
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00018,0.00107,0.000185 cost=1.55e+05 flops[gemm]=1.45e+08
--- TIMING FOR renorm : t_inter=0.00018 t_gemm=0.00107 t_reduction=0.000185 tot=0.00143 ---
 renorm counter=22 i=0 t=0.000206 per=19.3 cost=8.1e+03 flops=3.93e+07
 renorm counter=22 i=1 t=0.000204 per=19.1 cost=8.36e+03 flops=4.1e+07
 renorm counter=22 i=2 t=1e-06 per=0.0938 cost=0 flops=0
 renorm counter=22 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=22 i=4 t=0.000202 per=18.9 cost=1.65e+04 flops=8.16e+07
 renorm counter=22 i=5 t=0.000212 per=19.9 cost=2.89e+04 flops=1.36e+08
 renorm counter=22 i=6 t=0.000241 per=22.6 cost=9.32e+04 flops=3.87e+08
 total GEMM cost=1.55e+05 flops=1.45e+08
--- TIMING FOR renorm_tot : t_inter=0.00212 t_gemm=0.0237 t_reduction=0.00414 tot=0.03 ---
 renorm_tot counter=22 i=0 t=0.00464 per=19.6 cost=8.81e+04 flops=1.9e+07
 renorm_tot counter=22 i=1 t=0.00466 per=19.7 cost=1.25e+05 flops=2.67e+07
 renorm_tot counter=22 i=2 t=0.00204 per=8.61 cost=7.99e+04 flops=3.91e+07
 renorm_tot counter=22 i=3 t=0.00212 per=8.96 cost=1.39e+05 flops=6.55e+07
 renorm_tot counter=22 i=4 t=0.00247 per=10.4 cost=9.87e+04 flops=4e+07
 renorm_tot counter=22 i=5 t=0.00254 per=10.7 cost=1.7e+05 flops=6.69e+07
 renorm_tot counter=22 i=6 t=0.00524 per=22.1 cost=1.06e+06 flops=2.02e+08
 total GEMM cost=1.76e+06 flops=7.43e+07
check ||H-H.dagger||=1.19e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0027 S T(init/kernel/comm)=7.8e-05,0.0027,8.6e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/lop(2,0) size=1.94e-05GB T[save](info/data/tot)=6.27e-05,5.93e-05,0.000122 speed=0.159GB/s disk[used]=0.000104GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond1.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond1.info
##### time_local: 1.32e-02 S #####
 T(fetch) = 3.10e-04 S  per =  2.3  per(accum) = 2.3
 T(hdiag) = 8.02e-05 S  per = 0.61  per(accum) = 2.9
 T(dvdsn) = 9.08e-03 S  per =   69  per(accum) = 71
 T(decim) = 3.20e-04 S  per =  2.4  per(accum) = 74
 T(guess) = 7.32e-05 S  per = 0.55  per(accum) = 74
 T(renrm) = 2.79e-03 S  per =   21  per(accum) = 96
 T(save ) = 5.94e-04 S  per =  4.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.89e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 4.12e-05 S  per = 0.46  per(accum) = 0.46
 T(symbolic_formulae_twodot     ) = 2.29e-04 S  per =  2.6  per(accum) = 3
 T(hintermediate init           ) = 2.18e-05 S  per = 0.24  per(accum) = 3.3
 T(hintermediates memcpy cpu2gpu) = 3.69e-06 S  per = 0.041  per(accum) = 3.3
 T(preprocess_hformulae_Hxlist2 ) = 2.26e-03 S  per =   25  per(accum) = 29
 T(hmmtasks init                ) = 1.39e-03 S  per =   16  per(accum) = 44
 T(dvdson solver [Hx_batchGPU]  ) = 4.90e-03 S  per =   55  per(accum) = 1e+02
 T(dvdson solver [communication]) = 8.40e-08 S  per = 0.00094  per(accum) = 1e+02
 T(dvdson solver [rest part]    ) = 4.22e-05 S  per = 0.47  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.74e-03 S
 T(qops init                    ) = 7.79e-05 S  per =  2.8  per(accum) = 2.8
 T(qops_dict memcpy cpu2gpu     ) = 3.45e-05 S  per =  1.3  per(accum) = 4.1
 T(symbolic_formulae_renorm     ) = 1.76e-04 S  per =  6.4  per(accum) = 11
 T(rintermediate init           ) = 2.07e-05 S  per = 0.76  per(accum) = 11
 T(rintermediates memcpy cpu2gpu) = 4.37e-06 S  per = 0.16  per(accum) = 11
 T(preprocess_formulae_Rlist2   ) = 5.17e-04 S  per =   19  per(accum) = 30
 T(rmmtasks init                ) = 3.63e-04 S  per =   13  per(accum) = 44
 T(qops memset                  ) = 8.08e-06 S  per =  0.3  per(accum) = 44
 T(preprocess_renorm_batchGPU   ) = 1.50e-03 S  per =   55  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.62e-05 S  per = 0.96  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.61e-06 S  per = 0.31  per(accum) = 1e+02
##### time_sweep: 5.29e-02 S #####
 T(fetch) = 3.81e-04 S  per = 0.72  per(accum) = 0.72
 T(hdiag) = 1.53e-04 S  per = 0.29  per(accum) = 1
 T(dvdsn) = 4.52e-02 S  per =   85  per(accum) = 86
 T(decim) = 4.01e-04 S  per = 0.76  per(accum) = 87
 T(guess) = 1.53e-04 S  per = 0.29  per(accum) = 88
 T(renrm) = 5.43e-03 S  per =   10  per(accum) = 98
 T(save ) = 1.17e-03 S  per =  2.2  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 4.49e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 8.17e-05 S  per = 0.18  per(accum) = 0.18
 T(symbolic_formulae_twodot     ) = 4.60e-04 S  per =    1  per(accum) = 1.2
 T(hintermediate init           ) = 4.32e-05 S  per = 0.096  per(accum) = 1.3
 T(hintermediates memcpy cpu2gpu) = 7.23e-06 S  per = 0.016  per(accum) = 1.3
 T(preprocess_hformulae_Hxlist2 ) = 4.51e-03 S  per =   10  per(accum) = 11
 T(hmmtasks init                ) = 2.79e-03 S  per =  6.2  per(accum) = 18
 T(dvdson solver [Hx_batchGPU]  ) = 3.66e-02 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 8.33e-07 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.76e-04 S  per = 0.84  per(accum) = 1e+02
Detailed decomposition of T(renrm): 5.34e-03 S
 T(qops init                    ) = 1.70e-04 S  per =  3.2  per(accum) = 3.2
 T(qops_dict memcpy cpu2gpu     ) = 6.27e-05 S  per =  1.2  per(accum) = 4.4
 T(symbolic_formulae_renorm     ) = 3.79e-04 S  per =  7.1  per(accum) = 11
 T(rintermediate init           ) = 3.03e-05 S  per = 0.57  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 9.13e-06 S  per = 0.17  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 1.08e-03 S  per =   20  per(accum) = 32
 T(rmmtasks init                ) = 6.94e-04 S  per =   13  per(accum) = 45
 T(qops memset                  ) = 1.64e-05 S  per = 0.31  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 2.83e-03 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 5.40e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.73e-05 S  per = 0.32  per(accum) = 1e+02
##### time_global: 6.90e-01 S #####
 T(fetch) = 4.87e-03 S  per = 0.71  per(accum) = 0.71
 T(hdiag) = 1.72e-03 S  per = 0.25  per(accum) = 0.96
 T(dvdsn) = 6.02e-01 S  per =   87  per(accum) = 88
 T(decim) = 5.22e-03 S  per = 0.76  per(accum) = 89
 T(guess) = 1.83e-03 S  per = 0.27  per(accum) = 89
 T(renrm) = 6.13e-02 S  per =  8.9  per(accum) = 98
 T(save ) = 1.27e-02 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 5.98e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 9.08e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 5.47e-03 S  per = 0.92  per(accum) = 1.1
 T(hintermediate init           ) = 5.39e-04 S  per = 0.09  per(accum) = 1.2
 T(hintermediates memcpy cpu2gpu) = 8.75e-05 S  per = 0.015  per(accum) = 1.2
 T(preprocess_hformulae_Hxlist2 ) = 5.00e-02 S  per =  8.4  per(accum) = 9.5
 T(hmmtasks init                ) = 3.12e-02 S  per =  5.2  per(accum) = 15
 T(dvdson solver [Hx_batchGPU]  ) = 5.04e-01 S  per =   84  per(accum) = 99
 T(dvdson solver [communication]) = 1.28e-05 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.57e-03 S  per = 0.93  per(accum) = 1e+02
Detailed decomposition of T(renrm): 6.02e-02 S
 T(qops init                    ) = 2.33e-03 S  per =  3.9  per(accum) = 3.9
 T(qops_dict memcpy cpu2gpu     ) = 7.51e-04 S  per =  1.2  per(accum) = 5.1
 T(symbolic_formulae_renorm     ) = 4.47e-03 S  per =  7.4  per(accum) = 13
 T(rintermediate init           ) = 3.72e-04 S  per = 0.62  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 1.10e-04 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 1.19e-02 S  per =   20  per(accum) = 33
 T(rmmtasks init                ) = 7.58e-03 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 1.91e-04 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 3.17e-02 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 6.27e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 1.97e-04 S  per = 0.33  per(accum) = 1e+02

isweep=5 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 1.129e-06 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=357:0.00272MB:2.66e-06GB
===== CPUmem(GB): tot=3.56e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x449d04e0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.232e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.840e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00223 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.24e-05,0.000962,0.00122 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=5.05e-05 (comb,oper,dvdson,hvec,renorm)=2.66e-06,3.3e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.4e-05,0.000207,0.00194,0.00019 cost=7.9e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=0.000207 t_gemm=0.00195 t_reduction=0.00019 tot=0.00234 ---
 sigma counter=206 i=0 t=0.000238 per=12.2 cost=6.81e+03 flops=2.86e+07
 sigma counter=206 i=1 t=0.00024 per=12.3 cost=6.78e+03 flops=2.83e+07
 sigma counter=206 i=2 t=0.000232 per=11.9 cost=7.01e+03 flops=3.02e+07
 sigma counter=206 i=3 t=0.000238 per=12.2 cost=6.99e+03 flops=2.94e+07
 sigma counter=206 i=4 t=0.000235 per=12.1 cost=6.81e+03 flops=2.9e+07
 sigma counter=206 i=5 t=0.000237 per=12.2 cost=6.78e+03 flops=2.86e+07
 sigma counter=206 i=6 t=0.000265 per=13.6 cost=1.89e+04 flops=7.13e+07
 sigma counter=206 i=7 t=0.00026 per=13.4 cost=1.89e+04 flops=7.27e+07
 total GEMM cost=7.9e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=0.0413 t_gemm=0.402 t_reduction=0.0396 tot=0.482 ---
 sigma_tot counter=206 i=0 t=0.0491 per=12.2 cost=1.26e+06 flops=2.57e+07
 sigma_tot counter=206 i=1 t=0.0506 per=12.6 cost=1.27e+06 flops=2.52e+07
 sigma_tot counter=206 i=2 t=0.0488 per=12.2 cost=1.27e+06 flops=2.61e+07
 sigma_tot counter=206 i=3 t=0.0493 per=12.3 cost=1.28e+06 flops=2.59e+07
 sigma_tot counter=206 i=4 t=0.0497 per=12.4 cost=2.2e+06 flops=4.44e+07
 sigma_tot counter=206 i=5 t=0.0504 per=12.6 cost=2.2e+06 flops=4.36e+07
 sigma_tot counter=206 i=6 t=0.0534 per=13.3 cost=2.45e+06 flops=4.6e+07
 sigma_tot counter=206 i=7 t=0.0503 per=12.5 cost=2.44e+06 flops=4.86e+07
 total GEMM cost=1.44e+07 flops=3.58e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.7e-05,0.000202,0.00196,0.00019 cost=7.9e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=0.000202 t_gemm=0.00196 t_reduction=0.00019 tot=0.00235 ---
 sigma counter=207 i=0 t=0.000236 per=12 cost=6.81e+03 flops=2.89e+07
 sigma counter=207 i=1 t=0.000247 per=12.6 cost=6.78e+03 flops=2.75e+07
 sigma counter=207 i=2 t=0.000234 per=11.9 cost=7.01e+03 flops=2.99e+07
 sigma counter=207 i=3 t=0.000249 per=12.7 cost=6.99e+03 flops=2.81e+07
 sigma counter=207 i=4 t=0.000233 per=11.9 cost=6.81e+03 flops=2.92e+07
 sigma counter=207 i=5 t=0.000238 per=12.1 cost=6.78e+03 flops=2.85e+07
 sigma counter=207 i=6 t=0.000278 per=14.2 cost=1.89e+04 flops=6.8e+07
 sigma counter=207 i=7 t=0.000245 per=12.5 cost=1.89e+04 flops=7.71e+07
 total GEMM cost=7.9e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=0.0415 t_gemm=0.404 t_reduction=0.0398 tot=0.485 ---
 sigma_tot counter=207 i=0 t=0.0493 per=12.2 cost=1.27e+06 flops=2.58e+07
 sigma_tot counter=207 i=1 t=0.0509 per=12.6 cost=1.28e+06 flops=2.52e+07
 sigma_tot counter=207 i=2 t=0.0491 per=12.2 cost=1.28e+06 flops=2.61e+07
 sigma_tot counter=207 i=3 t=0.0495 per=12.3 cost=1.28e+06 flops=2.59e+07
 sigma_tot counter=207 i=4 t=0.0499 per=12.4 cost=2.21e+06 flops=4.43e+07
 sigma_tot counter=207 i=5 t=0.0507 per=12.6 cost=2.21e+06 flops=4.35e+07
 sigma_tot counter=207 i=6 t=0.0536 per=13.3 cost=2.47e+06 flops=4.61e+07
 sigma_tot counter=207 i=7 t=0.0505 per=12.5 cost=2.46e+06 flops=4.88e+07
 total GEMM cost=1.45e+07 flops=3.59e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592  -1.00e+03   7.01e-02    2     2   4.93e-03  2.47e-03
    1   1 -      -2.436094100141  -1.00e+03   4.92e-02    2     2   4.93e-03  2.47e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,2.03e-04,1.94e-03,1.92e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=2.03e-04 t_gemm=1.94e-03 t_reduction=1.91e-04 tot=2.34e-03 ---
 sigma counter=208 i=0 t=2.35e-04 per=1.21e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=208 i=1 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=208 i=2 t=2.35e-04 per=1.21e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=208 i=3 t=2.38e-04 per=1.23e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=208 i=4 t=2.40e-04 per=1.24e+01 cost=6.81e+03 flops=2.84e+07
 sigma counter=208 i=5 t=2.36e-04 per=1.22e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=208 i=6 t=2.62e-04 per=1.35e+01 cost=1.89e+04 flops=7.21e+07
 sigma counter=208 i=7 t=2.58e-04 per=1.33e+01 cost=1.89e+04 flops=7.32e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=4.17e-02 t_gemm=4.05e-01 t_reduction=4.00e-02 tot=4.87e-01 ---
 sigma_tot counter=208 i=0 t=4.96e-02 per=1.22e+01 cost=1.28e+06 flops=2.58e+07
 sigma_tot counter=208 i=1 t=5.11e-02 per=1.26e+01 cost=1.29e+06 flops=2.52e+07
 sigma_tot counter=208 i=2 t=4.93e-02 per=1.22e+01 cost=1.29e+06 flops=2.61e+07
 sigma_tot counter=208 i=3 t=4.98e-02 per=1.23e+01 cost=1.29e+06 flops=2.59e+07
 sigma_tot counter=208 i=4 t=5.01e-02 per=1.24e+01 cost=2.22e+06 flops=4.42e+07
 sigma_tot counter=208 i=5 t=5.09e-02 per=1.26e+01 cost=2.21e+06 flops=4.35e+07
 sigma_tot counter=208 i=6 t=5.39e-02 per=1.33e+01 cost=2.49e+06 flops=4.62e+07
 sigma_tot counter=208 i=7 t=5.08e-02 per=1.25e+01 cost=2.48e+06 flops=4.89e+07
 total GEMM cost=1.45e+07 flops=3.59e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.99e-04,1.96e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.96e-03 t_reduction=1.89e-04 tot=2.34e-03 ---
 sigma counter=209 i=0 t=2.33e-04 per=1.19e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=209 i=1 t=2.47e-04 per=1.26e+01 cost=6.78e+03 flops=2.75e+07
 sigma counter=209 i=2 t=2.31e-04 per=1.18e+01 cost=7.01e+03 flops=3.03e+07
 sigma counter=209 i=3 t=2.36e-04 per=1.21e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=209 i=4 t=2.41e-04 per=1.23e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=209 i=5 t=2.45e-04 per=1.25e+01 cost=6.78e+03 flops=2.77e+07
 sigma counter=209 i=6 t=2.71e-04 per=1.38e+01 cost=1.89e+04 flops=6.97e+07
 sigma counter=209 i=7 t=2.53e-04 per=1.29e+01 cost=1.89e+04 flops=7.47e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=4.19e-02 t_gemm=4.07e-01 t_reduction=4.02e-02 tot=4.89e-01 ---
 sigma_tot counter=209 i=0 t=4.98e-02 per=1.22e+01 cost=1.28e+06 flops=2.58e+07
 sigma_tot counter=209 i=1 t=5.13e-02 per=1.26e+01 cost=1.29e+06 flops=2.52e+07
 sigma_tot counter=209 i=2 t=4.95e-02 per=1.22e+01 cost=1.29e+06 flops=2.61e+07
 sigma_tot counter=209 i=3 t=5.00e-02 per=1.23e+01 cost=1.30e+06 flops=2.59e+07
 sigma_tot counter=209 i=4 t=5.04e-02 per=1.24e+01 cost=2.22e+06 flops=4.41e+07
 sigma_tot counter=209 i=5 t=5.12e-02 per=1.26e+01 cost=2.22e+06 flops=4.34e+07
 sigma_tot counter=209 i=6 t=5.42e-02 per=1.33e+01 cost=2.51e+06 flops=4.63e+07
 sigma_tot counter=209 i=7 t=5.10e-02 per=1.25e+01 cost=2.50e+06 flops=4.90e+07
 total GEMM cost=1.46e+07 flops=3.59e+07
    2   0 -      -2.654426863105  -1.84e-03   1.26e-02    4     4   9.88e-03  2.47e-03
    2   1 -      -2.436959129202  -8.65e-04   5.19e-03    4     4   9.88e-03  2.47e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.90e-05,1.97e-04,1.94e-03,1.92e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.94e-03 t_reduction=1.92e-04 tot=2.33e-03 ---
 sigma counter=210 i=0 t=2.32e-04 per=1.19e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=210 i=1 t=2.40e-04 per=1.24e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=210 i=2 t=2.44e-04 per=1.26e+01 cost=7.01e+03 flops=2.87e+07
 sigma counter=210 i=3 t=2.36e-04 per=1.22e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=210 i=4 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=210 i=5 t=2.38e-04 per=1.23e+01 cost=6.78e+03 flops=2.85e+07
 sigma counter=210 i=6 t=2.67e-04 per=1.37e+01 cost=1.89e+04 flops=7.08e+07
 sigma counter=210 i=7 t=2.54e-04 per=1.31e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=4.21e-02 t_gemm=4.09e-01 t_reduction=4.04e-02 tot=4.92e-01 ---
 sigma_tot counter=210 i=0 t=5.00e-02 per=1.22e+01 cost=1.29e+06 flops=2.58e+07
 sigma_tot counter=210 i=1 t=5.16e-02 per=1.26e+01 cost=1.30e+06 flops=2.52e+07
 sigma_tot counter=210 i=2 t=4.98e-02 per=1.22e+01 cost=1.30e+06 flops=2.61e+07
 sigma_tot counter=210 i=3 t=5.03e-02 per=1.23e+01 cost=1.30e+06 flops=2.60e+07
 sigma_tot counter=210 i=4 t=5.06e-02 per=1.24e+01 cost=2.23e+06 flops=4.41e+07
 sigma_tot counter=210 i=5 t=5.14e-02 per=1.26e+01 cost=2.23e+06 flops=4.33e+07
 sigma_tot counter=210 i=6 t=5.44e-02 per=1.33e+01 cost=2.53e+06 flops=4.64e+07
 sigma_tot counter=210 i=7 t=5.13e-02 per=1.25e+01 cost=2.52e+06 flops=4.91e+07
 total GEMM cost=1.47e+07 flops=3.59e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,1.96e-04,1.95e-03,1.90e-04 cost=7.90e+04 flops[gemm]=4.06e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.95e-03 t_reduction=1.90e-04 tot=2.33e-03 ---
 sigma counter=211 i=0 t=2.36e-04 per=1.21e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=211 i=1 t=2.44e-04 per=1.25e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=211 i=2 t=2.35e-04 per=1.21e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=211 i=3 t=2.33e-04 per=1.20e+01 cost=6.99e+03 flops=3.00e+07
 sigma counter=211 i=4 t=2.40e-04 per=1.23e+01 cost=6.81e+03 flops=2.84e+07
 sigma counter=211 i=5 t=2.44e-04 per=1.25e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=211 i=6 t=2.60e-04 per=1.34e+01 cost=1.89e+04 flops=7.27e+07
 sigma counter=211 i=7 t=2.54e-04 per=1.31e+01 cost=1.89e+04 flops=7.44e+07
 total GEMM cost=7.90e+04 flops=4.06e+07
--- TIMING FOR sigma_tot : t_inter=4.23e-02 t_gemm=4.11e-01 t_reduction=4.06e-02 tot=4.94e-01 ---
 sigma_tot counter=211 i=0 t=5.03e-02 per=1.22e+01 cost=1.30e+06 flops=2.58e+07
 sigma_tot counter=211 i=1 t=5.18e-02 per=1.26e+01 cost=1.31e+06 flops=2.52e+07
 sigma_tot counter=211 i=2 t=5.00e-02 per=1.22e+01 cost=1.31e+06 flops=2.61e+07
 sigma_tot counter=211 i=3 t=5.05e-02 per=1.23e+01 cost=1.31e+06 flops=2.60e+07
 sigma_tot counter=211 i=4 t=5.09e-02 per=1.24e+01 cost=2.24e+06 flops=4.40e+07
 sigma_tot counter=211 i=5 t=5.16e-02 per=1.26e+01 cost=2.23e+06 flops=4.33e+07
 sigma_tot counter=211 i=6 t=5.47e-02 per=1.33e+01 cost=2.55e+06 flops=4.66e+07
 sigma_tot counter=211 i=7 t=5.15e-02 per=1.25e+01 cost=2.54e+06 flops=4.93e+07
 total GEMM cost=1.48e+07 flops=3.59e+07
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   1.48e-02  2.47e-03
    3   1 -      -2.436975259478  -1.61e-05   1.59e-03    6     6   1.48e-02  2.47e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.96e-04,1.93e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.10e+07
--- TIMING FOR sigma : t_inter=1.96e-04 t_gemm=1.92e-03 t_reduction=1.88e-04 tot=2.31e-03 ---
 sigma counter=212 i=0 t=2.37e-04 per=1.23e+01 cost=6.81e+03 flops=2.88e+07
 sigma counter=212 i=1 t=2.37e-04 per=1.23e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=212 i=2 t=2.31e-04 per=1.20e+01 cost=7.01e+03 flops=3.03e+07
 sigma counter=212 i=3 t=2.38e-04 per=1.24e+01 cost=6.99e+03 flops=2.94e+07
 sigma counter=212 i=4 t=2.30e-04 per=1.20e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=212 i=5 t=2.37e-04 per=1.23e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=212 i=6 t=2.62e-04 per=1.36e+01 cost=1.89e+04 flops=7.21e+07
 sigma counter=212 i=7 t=2.52e-04 per=1.31e+01 cost=1.89e+04 flops=7.50e+07
 total GEMM cost=7.90e+04 flops=4.11e+07
--- TIMING FOR sigma_tot : t_inter=4.25e-02 t_gemm=4.13e-01 t_reduction=4.07e-02 tot=4.96e-01 ---
 sigma_tot counter=212 i=0 t=5.05e-02 per=1.22e+01 cost=1.31e+06 flops=2.58e+07
 sigma_tot counter=212 i=1 t=5.21e-02 per=1.26e+01 cost=1.31e+06 flops=2.53e+07
 sigma_tot counter=212 i=2 t=5.02e-02 per=1.22e+01 cost=1.31e+06 flops=2.62e+07
 sigma_tot counter=212 i=3 t=5.07e-02 per=1.23e+01 cost=1.32e+06 flops=2.60e+07
 sigma_tot counter=212 i=4 t=5.11e-02 per=1.24e+01 cost=2.24e+06 flops=4.39e+07
 sigma_tot counter=212 i=5 t=5.19e-02 per=1.26e+01 cost=2.24e+06 flops=4.32e+07
 sigma_tot counter=212 i=6 t=5.50e-02 per=1.33e+01 cost=2.57e+06 flops=4.67e+07
 sigma_tot counter=212 i=7 t=5.18e-02 per=1.25e+01 cost=2.56e+06 flops=4.94e+07
 total GEMM cost=1.49e+07 flops=3.60e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.97e-04,1.96e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=1.97e-04 t_gemm=1.96e-03 t_reduction=1.87e-04 tot=2.34e-03 ---
 sigma counter=213 i=0 t=2.33e-04 per=1.19e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=213 i=1 t=2.46e-04 per=1.26e+01 cost=6.78e+03 flops=2.76e+07
 sigma counter=213 i=2 t=2.40e-04 per=1.22e+01 cost=7.01e+03 flops=2.92e+07
 sigma counter=213 i=3 t=2.45e-04 per=1.25e+01 cost=6.99e+03 flops=2.85e+07
 sigma counter=213 i=4 t=2.31e-04 per=1.18e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=213 i=5 t=2.42e-04 per=1.23e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=213 i=6 t=2.68e-04 per=1.37e+01 cost=1.89e+04 flops=7.05e+07
 sigma counter=213 i=7 t=2.55e-04 per=1.30e+01 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.90e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=4.27e-02 t_gemm=4.15e-01 t_reduction=4.09e-02 tot=4.99e-01 ---
 sigma_tot counter=213 i=0 t=5.07e-02 per=1.22e+01 cost=1.31e+06 flops=2.59e+07
 sigma_tot counter=213 i=1 t=5.23e-02 per=1.26e+01 cost=1.32e+06 flops=2.53e+07
 sigma_tot counter=213 i=2 t=5.05e-02 per=1.22e+01 cost=1.32e+06 flops=2.62e+07
 sigma_tot counter=213 i=3 t=5.10e-02 per=1.23e+01 cost=1.33e+06 flops=2.60e+07
 sigma_tot counter=213 i=4 t=5.13e-02 per=1.24e+01 cost=2.25e+06 flops=4.39e+07
 sigma_tot counter=213 i=5 t=5.21e-02 per=1.26e+01 cost=2.25e+06 flops=4.31e+07
 sigma_tot counter=213 i=6 t=5.52e-02 per=1.33e+01 cost=2.58e+06 flops=4.68e+07
 sigma_tot counter=213 i=7 t=5.20e-02 per=1.25e+01 cost=2.58e+06 flops=4.95e+07
 total GEMM cost=1.49e+07 flops=3.60e+07
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   1.97e-02  2.46e-03
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   1.97e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.99e-04,1.96e-03,1.93e-04 cost=7.90e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.96e-03 t_reduction=1.93e-04 tot=2.35e-03 ---
 sigma counter=214 i=0 t=2.35e-04 per=1.20e+01 cost=6.81e+03 flops=2.90e+07
 sigma counter=214 i=1 t=2.36e-04 per=1.20e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=214 i=2 t=2.50e-04 per=1.27e+01 cost=7.01e+03 flops=2.80e+07
 sigma counter=214 i=3 t=2.42e-04 per=1.23e+01 cost=6.99e+03 flops=2.89e+07
 sigma counter=214 i=4 t=2.34e-04 per=1.19e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=214 i=5 t=2.42e-04 per=1.23e+01 cost=6.78e+03 flops=2.80e+07
 sigma counter=214 i=6 t=2.71e-04 per=1.38e+01 cost=1.89e+04 flops=6.97e+07
 sigma counter=214 i=7 t=2.52e-04 per=1.28e+01 cost=1.89e+04 flops=7.50e+07
 total GEMM cost=7.90e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=4.29e-02 t_gemm=4.17e-01 t_reduction=4.11e-02 tot=5.01e-01 ---
 sigma_tot counter=214 i=0 t=5.10e-02 per=1.22e+01 cost=1.32e+06 flops=2.59e+07
 sigma_tot counter=214 i=1 t=5.25e-02 per=1.26e+01 cost=1.33e+06 flops=2.53e+07
 sigma_tot counter=214 i=2 t=5.07e-02 per=1.22e+01 cost=1.33e+06 flops=2.62e+07
 sigma_tot counter=214 i=3 t=5.12e-02 per=1.23e+01 cost=1.33e+06 flops=2.60e+07
 sigma_tot counter=214 i=4 t=5.15e-02 per=1.24e+01 cost=2.26e+06 flops=4.38e+07
 sigma_tot counter=214 i=5 t=5.24e-02 per=1.26e+01 cost=2.25e+06 flops=4.31e+07
 sigma_tot counter=214 i=6 t=5.55e-02 per=1.33e+01 cost=2.60e+06 flops=4.69e+07
 sigma_tot counter=214 i=7 t=5.23e-02 per=1.25e+01 cost=2.60e+06 flops=4.96e+07
 total GEMM cost=1.50e+07 flops=3.60e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.70e-05,2.00e-04,1.95e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=2.00e-04 t_gemm=1.95e-03 t_reduction=1.89e-04 tot=2.34e-03 ---
 sigma counter=215 i=0 t=2.40e-04 per=1.23e+01 cost=6.81e+03 flops=2.84e+07
 sigma counter=215 i=1 t=2.52e-04 per=1.29e+01 cost=6.78e+03 flops=2.69e+07
 sigma counter=215 i=2 t=2.37e-04 per=1.22e+01 cost=7.01e+03 flops=2.96e+07
 sigma counter=215 i=3 t=2.41e-04 per=1.24e+01 cost=6.99e+03 flops=2.90e+07
 sigma counter=215 i=4 t=2.31e-04 per=1.19e+01 cost=6.81e+03 flops=2.95e+07
 sigma counter=215 i=5 t=2.37e-04 per=1.22e+01 cost=6.78e+03 flops=2.86e+07
 sigma counter=215 i=6 t=2.60e-04 per=1.33e+01 cost=1.89e+04 flops=7.27e+07
 sigma counter=215 i=7 t=2.50e-04 per=1.28e+01 cost=1.89e+04 flops=7.56e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=4.31e-02 t_gemm=4.19e-01 t_reduction=4.13e-02 tot=5.03e-01 ---
 sigma_tot counter=215 i=0 t=5.12e-02 per=1.22e+01 cost=1.33e+06 flops=2.59e+07
 sigma_tot counter=215 i=1 t=5.28e-02 per=1.26e+01 cost=1.34e+06 flops=2.53e+07
 sigma_tot counter=215 i=2 t=5.10e-02 per=1.22e+01 cost=1.34e+06 flops=2.62e+07
 sigma_tot counter=215 i=3 t=5.15e-02 per=1.23e+01 cost=1.34e+06 flops=2.60e+07
 sigma_tot counter=215 i=4 t=5.18e-02 per=1.24e+01 cost=2.27e+06 flops=4.37e+07
 sigma_tot counter=215 i=5 t=5.26e-02 per=1.26e+01 cost=2.26e+06 flops=4.30e+07
 sigma_tot counter=215 i=6 t=5.58e-02 per=1.33e+01 cost=2.62e+06 flops=4.70e+07
 sigma_tot counter=215 i=7 t=5.26e-02 per=1.25e+01 cost=2.62e+06 flops=4.98e+07
 total GEMM cost=1.51e+07 flops=3.60e+07
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   2.46e-02  2.46e-03
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   2.46e-02  2.46e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.98e-04,1.96e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.04e+07
--- TIMING FOR sigma : t_inter=1.98e-04 t_gemm=1.96e-03 t_reduction=1.88e-04 tot=2.34e-03 ---
 sigma counter=216 i=0 t=2.36e-04 per=1.21e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=216 i=1 t=2.35e-04 per=1.20e+01 cost=6.78e+03 flops=2.89e+07
 sigma counter=216 i=2 t=2.52e-04 per=1.29e+01 cost=7.01e+03 flops=2.78e+07
 sigma counter=216 i=3 t=2.36e-04 per=1.21e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=216 i=4 t=2.30e-04 per=1.18e+01 cost=6.81e+03 flops=2.96e+07
 sigma counter=216 i=5 t=2.44e-04 per=1.25e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=216 i=6 t=2.67e-04 per=1.37e+01 cost=1.89e+04 flops=7.08e+07
 sigma counter=216 i=7 t=2.55e-04 per=1.30e+01 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.90e+04 flops=4.04e+07
--- TIMING FOR sigma_tot : t_inter=4.33e-02 t_gemm=4.21e-01 t_reduction=4.15e-02 tot=5.06e-01 ---
 sigma_tot counter=216 i=0 t=5.15e-02 per=1.22e+01 cost=1.33e+06 flops=2.59e+07
 sigma_tot counter=216 i=1 t=5.30e-02 per=1.26e+01 cost=1.34e+06 flops=2.53e+07
 sigma_tot counter=216 i=2 t=5.12e-02 per=1.22e+01 cost=1.34e+06 flops=2.62e+07
 sigma_tot counter=216 i=3 t=5.17e-02 per=1.23e+01 cost=1.35e+06 flops=2.60e+07
 sigma_tot counter=216 i=4 t=5.20e-02 per=1.24e+01 cost=2.27e+06 flops=4.37e+07
 sigma_tot counter=216 i=5 t=5.28e-02 per=1.25e+01 cost=2.27e+06 flops=4.29e+07
 sigma_tot counter=216 i=6 t=5.60e-02 per=1.33e+01 cost=2.64e+06 flops=4.71e+07
 sigma_tot counter=216 i=7 t=5.28e-02 per=1.25e+01 cost=2.63e+06 flops=4.99e+07
 total GEMM cost=1.52e+07 flops=3.60e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,2.02e-04,1.95e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=2.02e-04 t_gemm=1.95e-03 t_reduction=1.89e-04 tot=2.34e-03 ---
 sigma counter=217 i=0 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=217 i=1 t=2.44e-04 per=1.25e+01 cost=6.78e+03 flops=2.78e+07
 sigma counter=217 i=2 t=2.41e-04 per=1.23e+01 cost=7.01e+03 flops=2.91e+07
 sigma counter=217 i=3 t=2.40e-04 per=1.23e+01 cost=6.99e+03 flops=2.91e+07
 sigma counter=217 i=4 t=2.32e-04 per=1.19e+01 cost=6.81e+03 flops=2.94e+07
 sigma counter=217 i=5 t=2.36e-04 per=1.21e+01 cost=6.78e+03 flops=2.87e+07
 sigma counter=217 i=6 t=2.69e-04 per=1.38e+01 cost=1.89e+04 flops=7.02e+07
 sigma counter=217 i=7 t=2.56e-04 per=1.31e+01 cost=1.89e+04 flops=7.38e+07
 total GEMM cost=7.90e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=4.35e-02 t_gemm=4.23e-01 t_reduction=4.17e-02 tot=5.08e-01 ---
 sigma_tot counter=217 i=0 t=5.17e-02 per=1.22e+01 cost=1.34e+06 flops=2.59e+07
 sigma_tot counter=217 i=1 t=5.33e-02 per=1.26e+01 cost=1.35e+06 flops=2.53e+07
 sigma_tot counter=217 i=2 t=5.14e-02 per=1.22e+01 cost=1.35e+06 flops=2.62e+07
 sigma_tot counter=217 i=3 t=5.19e-02 per=1.23e+01 cost=1.35e+06 flops=2.61e+07
 sigma_tot counter=217 i=4 t=5.22e-02 per=1.23e+01 cost=2.28e+06 flops=4.36e+07
 sigma_tot counter=217 i=5 t=5.31e-02 per=1.25e+01 cost=2.27e+06 flops=4.29e+07
 sigma_tot counter=217 i=6 t=5.63e-02 per=1.33e+01 cost=2.66e+06 flops=4.73e+07
 sigma_tot counter=217 i=7 t=5.31e-02 per=1.25e+01 cost=2.65e+06 flops=5.00e+07
 total GEMM cost=1.53e+07 flops=3.61e+07
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   2.96e-02  2.47e-03
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   2.96e-02  2.47e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.80e-05,1.99e-04,1.96e-03,1.89e-04 cost=7.90e+04 flops[gemm]=4.03e+07
--- TIMING FOR sigma : t_inter=1.99e-04 t_gemm=1.96e-03 t_reduction=1.89e-04 tot=2.35e-03 ---
 sigma counter=218 i=0 t=2.34e-04 per=1.20e+01 cost=6.81e+03 flops=2.91e+07
 sigma counter=218 i=1 t=2.50e-04 per=1.28e+01 cost=6.78e+03 flops=2.71e+07
 sigma counter=218 i=2 t=2.33e-04 per=1.19e+01 cost=7.01e+03 flops=3.01e+07
 sigma counter=218 i=3 t=2.45e-04 per=1.25e+01 cost=6.99e+03 flops=2.85e+07
 sigma counter=218 i=4 t=2.41e-04 per=1.23e+01 cost=6.81e+03 flops=2.83e+07
 sigma counter=218 i=5 t=2.40e-04 per=1.23e+01 cost=6.78e+03 flops=2.83e+07
 sigma counter=218 i=6 t=2.60e-04 per=1.33e+01 cost=1.89e+04 flops=7.27e+07
 sigma counter=218 i=7 t=2.55e-04 per=1.30e+01 cost=1.89e+04 flops=7.41e+07
 total GEMM cost=7.90e+04 flops=4.03e+07
--- TIMING FOR sigma_tot : t_inter=4.37e-02 t_gemm=4.25e-01 t_reduction=4.19e-02 tot=5.11e-01 ---
 sigma_tot counter=218 i=0 t=5.19e-02 per=1.22e+01 cost=1.35e+06 flops=2.59e+07
 sigma_tot counter=218 i=1 t=5.35e-02 per=1.26e+01 cost=1.36e+06 flops=2.53e+07
 sigma_tot counter=218 i=2 t=5.17e-02 per=1.22e+01 cost=1.36e+06 flops=2.62e+07
 sigma_tot counter=218 i=3 t=5.22e-02 per=1.23e+01 cost=1.36e+06 flops=2.61e+07
 sigma_tot counter=218 i=4 t=5.25e-02 per=1.23e+01 cost=2.29e+06 flops=4.36e+07
 sigma_tot counter=218 i=5 t=5.33e-02 per=1.25e+01 cost=2.28e+06 flops=4.28e+07
 sigma_tot counter=218 i=6 t=5.65e-02 per=1.33e+01 cost=2.68e+06 flops=4.74e+07
 sigma_tot counter=218 i=7 t=5.33e-02 per=1.25e+01 cost=2.67e+06 flops=5.01e+07
 total GEMM cost=1.53e+07 flops=3.61e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.60e-05,1.97e-04,1.94e-03,1.88e-04 cost=7.90e+04 flops[gemm]=4.07e+07
--- TIMING FOR sigma : t_inter=1.97e-04 t_gemm=1.94e-03 t_reduction=1.88e-04 tot=2.33e-03 ---
 sigma counter=219 i=0 t=2.36e-04 per=1.22e+01 cost=6.81e+03 flops=2.89e+07
 sigma counter=219 i=1 t=2.53e-04 per=1.30e+01 cost=6.78e+03 flops=2.68e+07
 sigma counter=219 i=2 t=2.35e-04 per=1.21e+01 cost=7.01e+03 flops=2.98e+07
 sigma counter=219 i=3 t=2.36e-04 per=1.22e+01 cost=6.99e+03 flops=2.96e+07
 sigma counter=219 i=4 t=2.33e-04 per=1.20e+01 cost=6.81e+03 flops=2.92e+07
 sigma counter=219 i=5 t=2.43e-04 per=1.25e+01 cost=6.78e+03 flops=2.79e+07
 sigma counter=219 i=6 t=2.59e-04 per=1.33e+01 cost=1.89e+04 flops=7.30e+07
 sigma counter=219 i=7 t=2.47e-04 per=1.27e+01 cost=1.89e+04 flops=7.65e+07
 total GEMM cost=7.90e+04 flops=4.07e+07
--- TIMING FOR sigma_tot : t_inter=4.39e-02 t_gemm=4.27e-01 t_reduction=4.21e-02 tot=5.13e-01 ---
 sigma_tot counter=219 i=0 t=5.22e-02 per=1.22e+01 cost=1.35e+06 flops=2.59e+07
 sigma_tot counter=219 i=1 t=5.38e-02 per=1.26e+01 cost=1.36e+06 flops=2.53e+07
 sigma_tot counter=219 i=2 t=5.19e-02 per=1.22e+01 cost=1.36e+06 flops=2.63e+07
 sigma_tot counter=219 i=3 t=5.24e-02 per=1.23e+01 cost=1.37e+06 flops=2.61e+07
 sigma_tot counter=219 i=4 t=5.27e-02 per=1.23e+01 cost=2.29e+06 flops=4.35e+07
 sigma_tot counter=219 i=5 t=5.36e-02 per=1.25e+01 cost=2.29e+06 flops=4.27e+07
 sigma_tot counter=219 i=6 t=5.68e-02 per=1.33e+01 cost=2.70e+06 flops=4.75e+07
 sigma_tot counter=219 i=7 t=5.36e-02 per=1.25e+01 cost=2.69e+06 flops=5.02e+07
 total GEMM cost=1.54e+07 flops=3.61e+07
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   3.45e-02  2.46e-03
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   3.45e-02  2.46e-03
TIMING for Davidson : 3.45e-02  T(cal/comm/rest)=3.42e-02,7.55e-07,3.47e-04
optimized energies: isweep=5 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=5 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1388:1.1e-02MB:1.0e-05GB
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=0.0e+00
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=2.2e-06 (oper)(GB)=2.2e-06
rank=0 GPUmem.size(GB)=3.8e+01 GPUmem.used(GB)=1.3e-05 (oper,qops,site)(GB)=2.2e-06,1.0e-05,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.968e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.28e-05 (oper,qops,site,rinter)(GB)=2.18e-06,1.03e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist : 0.000554 S size(rtasks)=63 size(Rlst)=1436 T(Rmu/Rxlist/sort)=4.98e-05,0.000246,0.000258 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000366 (oper,qops,site,rinter,batch)(GB)=2.18e-06,1.03e-05,2.68e-07,0,0.000353
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7e-06,0.00106,0.000182 cost=2.78e+04 flops[gemm]=2.61e+07
--- TIMING FOR renorm : t_inter=7e-06 t_gemm=0.00106 t_reduction=0.000182 tot=0.00125 ---
 renorm counter=23 i=0 t=0.000219 per=20.6 cost=1.82e+03 flops=8.32e+06
 renorm counter=23 i=1 t=0.000209 per=19.6 cost=3.23e+03 flops=1.54e+07
 renorm counter=23 i=2 t=0.000197 per=18.5 cost=1.91e+03 flops=9.68e+06
 renorm counter=23 i=3 t=0.000207 per=19.4 cost=3.14e+03 flops=1.52e+07
 renorm counter=23 i=4 t=1e-06 per=0.0939 cost=0 flops=0
 renorm counter=23 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=23 i=6 t=0.000232 per=21.8 cost=1.77e+04 flops=7.63e+07
 total GEMM cost=2.78e+04 flops=2.61e+07
--- TIMING FOR renorm_tot : t_inter=0.00212 t_gemm=0.0248 t_reduction=0.00432 tot=0.0312 ---
 renorm_tot counter=23 i=0 t=0.00486 per=19.6 cost=8.99e+04 flops=1.85e+07
 renorm_tot counter=23 i=1 t=0.00487 per=19.6 cost=1.28e+05 flops=2.63e+07
 renorm_tot counter=23 i=2 t=0.00224 per=9.04 cost=8.18e+04 flops=3.65e+07
 renorm_tot counter=23 i=3 t=0.00233 per=9.41 cost=1.42e+05 flops=6.1e+07
 renorm_tot counter=23 i=4 t=0.00247 per=9.96 cost=9.87e+04 flops=4e+07
 renorm_tot counter=23 i=5 t=0.00254 per=10.2 cost=1.7e+05 flops=6.69e+07
 renorm_tot counter=23 i=6 t=0.00547 per=22.1 cost=1.08e+06 flops=1.97e+08
 total GEMM cost=1.79e+06 flops=7.22e+07
check ||H-H.dagger||=0.00e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0026 S T(init/kernel/comm)=8.9e-05,0.0025,8.5e-06 rank=0 -----
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=200:0.0015MB:1.5e-06GB
total mem of comb=461:0.0035MB:3.4e-06GB
===== CPUmem(GB): tot=4.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,4.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(3,0) size=1.03e-05GB T[save](info/data/tot)=5.09e-05,3.32e-05,8.42e-05 speed=0.123GB/s disk[used]=0.000104GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond2.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond2.info
##### time_local: 4.21e-02 S #####
 T(fetch) = 7.06e-05 S  per = 0.17  per(accum) = 0.17
 T(hdiag) = 7.62e-05 S  per = 0.18  per(accum) = 0.35
 T(dvdsn) = 3.86e-02 S  per =   92  per(accum) = 92
 T(decim) = 8.18e-05 S  per = 0.19  per(accum) = 92
 T(guess) = 7.90e-05 S  per = 0.19  per(accum) = 92
 T(renrm) = 2.64e-03 S  per =  6.3  per(accum) = 99
 T(save ) = 5.51e-04 S  per =  1.3  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 3.84e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 3.94e-05 S  per =  0.1  per(accum) = 0.1
 T(symbolic_formulae_twodot     ) = 2.28e-04 S  per = 0.59  per(accum) = 0.7
 T(hintermediate init           ) = 2.12e-05 S  per = 0.055  per(accum) = 0.75
 T(hintermediates memcpy cpu2gpu) = 3.49e-06 S  per = 0.0091  per(accum) = 0.76
 T(preprocess_hformulae_Hxlist2 ) = 2.24e-03 S  per =  5.8  per(accum) = 6.6
 T(hmmtasks init                ) = 1.39e-03 S  per =  3.6  per(accum) = 10
 T(dvdson solver [Hx_batchGPU]  ) = 3.42e-02 S  per =   89  per(accum) = 99
 T(dvdson solver [communication]) = 7.55e-07 S  per = 0.002  per(accum) = 99
 T(dvdson solver [rest part]    ) = 3.47e-04 S  per =  0.9  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.59e-03 S
 T(qops init                    ) = 8.89e-05 S  per =  3.4  per(accum) = 3.4
 T(qops_dict memcpy cpu2gpu     ) = 2.81e-05 S  per =  1.1  per(accum) = 4.5
 T(symbolic_formulae_renorm     ) = 2.01e-04 S  per =  7.8  per(accum) = 12
 T(rintermediate init           ) = 9.69e-06 S  per = 0.37  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 4.69e-06 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 5.63e-04 S  per =   22  per(accum) = 35
 T(rmmtasks init                ) = 3.27e-04 S  per =   13  per(accum) = 47
 T(qops memset                  ) = 8.32e-06 S  per = 0.32  per(accum) = 48
 T(preprocess_renorm_batchGPU   ) = 1.32e-03 S  per =   51  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.72e-05 S  per =  1.1  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.46e-06 S  per = 0.33  per(accum) = 1e+02
##### time_sweep: 9.50e-02 S #####
 T(fetch) = 4.51e-04 S  per = 0.47  per(accum) = 0.47
 T(hdiag) = 2.29e-04 S  per = 0.24  per(accum) = 0.72
 T(dvdsn) = 8.39e-02 S  per =   88  per(accum) = 89
 T(decim) = 4.82e-04 S  per = 0.51  per(accum) = 89
 T(guess) = 2.32e-04 S  per = 0.24  per(accum) = 90
 T(renrm) = 8.07e-03 S  per =  8.5  per(accum) = 98
 T(save ) = 1.73e-03 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.33e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.21e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 6.88e-04 S  per = 0.83  per(accum) = 0.97
 T(hintermediate init           ) = 6.44e-05 S  per = 0.077  per(accum) = 1
 T(hintermediates memcpy cpu2gpu) = 1.07e-05 S  per = 0.013  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 6.75e-03 S  per =  8.1  per(accum) = 9.2
 T(hmmtasks init                ) = 4.18e-03 S  per =    5  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 7.08e-02 S  per =   85  per(accum) = 99
 T(dvdson solver [communication]) = 1.59e-06 S  per = 0.0019  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.23e-04 S  per = 0.87  per(accum) = 1e+02
Detailed decomposition of T(renrm): 7.93e-03 S
 T(qops init                    ) = 2.59e-04 S  per =  3.3  per(accum) = 3.3
 T(qops_dict memcpy cpu2gpu     ) = 9.08e-05 S  per =  1.1  per(accum) = 4.4
 T(symbolic_formulae_renorm     ) = 5.80e-04 S  per =  7.3  per(accum) = 12
 T(rintermediate init           ) = 4.00e-05 S  per =  0.5  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 1.38e-05 S  per = 0.17  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 1.64e-03 S  per =   21  per(accum) = 33
 T(rmmtasks init                ) = 1.02e-03 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 2.47e-05 S  per = 0.31  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 4.15e-03 S  per =   52  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 8.12e-05 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.58e-05 S  per = 0.32  per(accum) = 1e+02
##### time_global: 7.32e-01 S #####
 T(fetch) = 4.95e-03 S  per = 0.68  per(accum) = 0.68
 T(hdiag) = 1.79e-03 S  per = 0.24  per(accum) = 0.92
 T(dvdsn) = 6.41e-01 S  per =   88  per(accum) = 88
 T(decim) = 5.31e-03 S  per = 0.73  per(accum) = 89
 T(guess) = 1.91e-03 S  per = 0.26  per(accum) = 89
 T(renrm) = 6.39e-02 S  per =  8.7  per(accum) = 98
 T(save ) = 1.32e-02 S  per =  1.8  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 6.36e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 9.47e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 5.70e-03 S  per =  0.9  per(accum) = 1
 T(hintermediate init           ) = 5.60e-04 S  per = 0.088  per(accum) = 1.1
 T(hintermediates memcpy cpu2gpu) = 9.10e-05 S  per = 0.014  per(accum) = 1.1
 T(preprocess_hformulae_Hxlist2 ) = 5.23e-02 S  per =  8.2  per(accum) = 9.4
 T(hmmtasks init                ) = 3.26e-02 S  per =  5.1  per(accum) = 14
 T(dvdson solver [Hx_batchGPU]  ) = 5.38e-01 S  per =   85  per(accum) = 99
 T(dvdson solver [communication]) = 1.36e-05 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.92e-03 S  per = 0.93  per(accum) = 1e+02
Detailed decomposition of T(renrm): 6.28e-02 S
 T(qops init                    ) = 2.42e-03 S  per =  3.9  per(accum) = 3.9
 T(qops_dict memcpy cpu2gpu     ) = 7.79e-04 S  per =  1.2  per(accum) = 5.1
 T(symbolic_formulae_renorm     ) = 4.68e-03 S  per =  7.4  per(accum) = 13
 T(rintermediate init           ) = 3.81e-04 S  per = 0.61  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 1.15e-04 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 1.25e-02 S  per =   20  per(accum) = 33
 T(rmmtasks init                ) = 7.90e-03 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 1.99e-04 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 3.30e-02 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 6.55e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.05e-04 S  per = 0.33  per(accum) = 1e+02

isweep=5 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 2.264e-04 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=230:0.00175MB:1.71e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=461:0.00352MB:3.43e-06GB
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44b43370
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.36e-05 (oper)(GB)=1.36e-05
----- TIMING FOR symbolic_formulae_twodot with size=188 : 2.184e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=188
 no. of hintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 1.835e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=1.43e-05 (oper,hinter)(GB)=1.36e-05,6.85e-07
----- TIMING FOR preprocess_formulae_Hxlist : 0.00222 S size(H_formulae)=188 size(Hxlst)=5552 T(Hmu/Hxlist/sort)=5.27e-05,0.000948,0.00122 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000719 (oper,hinter,dvdson,batch)(GB)=1.36e-05,6.85e-07,1.49e-06,0.000703
===== CPUmem(GB): tot=3.19e-05 (comb,oper,dvdson,hvec,renorm)=3.43e-06,1.36e-05,1.49e-05,0,0 =====
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.5e-05,0.000203,0.00194,0.000186 cost=7.9e+04 flops[gemm]=4.08e+07
--- TIMING FOR sigma : t_inter=0.000203 t_gemm=0.00194 t_reduction=0.000186 tot=0.00233 ---
 sigma counter=220 i=0 t=0.000239 per=12.3 cost=7.01e+03 flops=2.93e+07
 sigma counter=220 i=1 t=0.000247 per=12.8 cost=6.99e+03 flops=2.83e+07
 sigma counter=220 i=2 t=0.000232 per=12 cost=6.81e+03 flops=2.94e+07
 sigma counter=220 i=3 t=0.000236 per=12.2 cost=6.78e+03 flops=2.87e+07
 sigma counter=220 i=4 t=0.000246 per=12.7 cost=1.89e+04 flops=7.68e+07
 sigma counter=220 i=5 t=0.000255 per=13.2 cost=1.89e+04 flops=7.41e+07
 sigma counter=220 i=6 t=0.000246 per=12.7 cost=6.78e+03 flops=2.76e+07
 sigma counter=220 i=7 t=0.000236 per=12.2 cost=6.81e+03 flops=2.89e+07
 total GEMM cost=7.9e+04 flops=4.08e+07
--- TIMING FOR sigma_tot : t_inter=0.0441 t_gemm=0.429 t_reduction=0.0423 tot=0.515 ---
 sigma_tot counter=220 i=0 t=0.0524 per=12.2 cost=1.36e+06 flops=2.6e+07
 sigma_tot counter=220 i=1 t=0.054 per=12.6 cost=1.37e+06 flops=2.54e+07
 sigma_tot counter=220 i=2 t=0.0521 per=12.2 cost=1.37e+06 flops=2.63e+07
 sigma_tot counter=220 i=3 t=0.0526 per=12.3 cost=1.37e+06 flops=2.61e+07
 sigma_tot counter=220 i=4 t=0.053 per=12.3 cost=2.31e+06 flops=4.36e+07
 sigma_tot counter=220 i=5 t=0.0538 per=12.5 cost=2.31e+06 flops=4.29e+07
 sigma_tot counter=220 i=6 t=0.0571 per=13.3 cost=2.7e+06 flops=4.74e+07
 sigma_tot counter=220 i=7 t=0.0538 per=12.5 cost=2.7e+06 flops=5.01e+07
 total GEMM cost=1.55e+07 flops=3.61e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=1.7e-05,0.000201,0.00195,0.000189 cost=7.9e+04 flops[gemm]=4.05e+07
--- TIMING FOR sigma : t_inter=0.000201 t_gemm=0.00195 t_reduction=0.000189 tot=0.00234 ---
 sigma counter=221 i=0 t=0.000237 per=12.1 cost=7.01e+03 flops=2.96e+07
 sigma counter=221 i=1 t=0.000245 per=12.6 cost=6.99e+03 flops=2.85e+07
 sigma counter=221 i=2 t=0.000239 per=12.2 cost=6.81e+03 flops=2.85e+07
 sigma counter=221 i=3 t=0.000237 per=12.1 cost=6.78e+03 flops=2.86e+07
 sigma counter=221 i=4 t=0.000254 per=13 cost=1.89e+04 flops=7.44e+07
 sigma counter=221 i=5 t=0.000261 per=13.4 cost=1.89e+04 flops=7.24e+07
 sigma counter=221 i=6 t=0.000247 per=12.7 cost=6.78e+03 flops=2.75e+07
 sigma counter=221 i=7 t=0.000232 per=11.9 cost=6.81e+03 flops=2.94e+07
 total GEMM cost=7.9e+04 flops=4.05e+07
--- TIMING FOR sigma_tot : t_inter=0.0443 t_gemm=0.431 t_reduction=0.0424 tot=0.518 ---
 sigma_tot counter=221 i=0 t=0.0526 per=12.2 cost=1.37e+06 flops=2.6e+07
 sigma_tot counter=221 i=1 t=0.0543 per=12.6 cost=1.38e+06 flops=2.54e+07
 sigma_tot counter=221 i=2 t=0.0524 per=12.2 cost=1.38e+06 flops=2.63e+07
 sigma_tot counter=221 i=3 t=0.0529 per=12.3 cost=1.38e+06 flops=2.61e+07
 sigma_tot counter=221 i=4 t=0.0532 per=12.4 cost=2.33e+06 flops=4.38e+07
 sigma_tot counter=221 i=5 t=0.0541 per=12.6 cost=2.33e+06 flops=4.3e+07
 sigma_tot counter=221 i=6 t=0.0573 per=13.3 cost=2.71e+06 flops=4.73e+07
 sigma_tot counter=221 i=7 t=0.054 per=12.5 cost=2.7e+06 flops=5e+07
 total GEMM cost=1.56e+07 flops=3.61e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   4.91e-03  2.46e-03
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   4.91e-03  2.46e-03
TIMING for Davidson : 4.93e-03  T(cal/comm/rest)=4.89e-03,1.00e-07,4.31e-05
optimized energies: isweep=5 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=5 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep5_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=1.704e-05 (comb,oper,dvdson,hvec,renorm)=3.435e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=2598:1.982e-02MB:1.936e-05GB
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=0.000e+00
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=1.143e-05 (oper)(GB)=1.143e-05
rank=0 GPUmem.size(GB)=3.794e+01 GPUmem.used(GB)=3.190e-05 (oper,qops,site)(GB)=1.143e-05,1.936e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.750e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=63
 no. of rintermediate operators=46
 no. of coefficients=92:0.000702MB:6.85e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 1.851e-05 S -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=3.26e-05 (oper,qops,site,rinter)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07
----- TIMING FOR preprocess_formulae_Rlist : 0.000551 S size(rtasks)=63 size(Rlst)=1491 T(Rmu/Rxlist/sort)=4.41e-05,0.000235,0.000272 -----
rank=0 GPUmem.size(GB)=37.9 GPUmem.used(GB)=0.000932 (oper,qops,site,rinter,batch)(GB)=1.14e-05,1.94e-05,1.12e-06,6.85e-07,0.0009
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000183,0.00107,0.000182 cost=1.55e+05 flops[gemm]=1.45e+08
--- TIMING FOR renorm : t_inter=0.000183 t_gemm=0.00107 t_reduction=0.000182 tot=0.00143 ---
 renorm counter=24 i=0 t=0.000201 per=18.9 cost=5.64e+03 flops=2.81e+07
 renorm counter=24 i=1 t=0.000207 per=19.4 cost=1.13e+04 flops=5.45e+07
 renorm counter=24 i=2 t=0.000199 per=18.7 cost=1.66e+04 flops=8.32e+07
 renorm counter=24 i=3 t=0.000216 per=20.3 cost=2.89e+04 flops=1.34e+08
 renorm counter=24 i=4 t=1e-06 per=0.0938 cost=0 flops=0
 renorm counter=24 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=24 i=6 t=0.000242 per=22.7 cost=9.22e+04 flops=3.81e+08
 total GEMM cost=1.55e+05 flops=1.45e+08
--- TIMING FOR renorm_tot : t_inter=0.00231 t_gemm=0.0259 t_reduction=0.0045 tot=0.0327 ---
 renorm_tot counter=24 i=0 t=0.00506 per=19.6 cost=9.56e+04 flops=1.89e+07
 renorm_tot counter=24 i=1 t=0.00508 per=19.6 cost=1.39e+05 flops=2.74e+07
 renorm_tot counter=24 i=2 t=0.00244 per=9.44 cost=9.83e+04 flops=4.03e+07
 renorm_tot counter=24 i=3 t=0.00255 per=9.86 cost=1.71e+05 flops=6.72e+07
 renorm_tot counter=24 i=4 t=0.00247 per=9.55 cost=9.87e+04 flops=4e+07
 renorm_tot counter=24 i=5 t=0.00254 per=9.83 cost=1.7e+05 flops=6.69e+07
 renorm_tot counter=24 i=6 t=0.00572 per=22.1 cost=1.17e+06 flops=2.05e+08
 total GEMM cost=1.94e+06 flops=7.52e+07
check ||H-H.dagger||=1.04e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0028 S T(init/kernel/comm)=7.4e-05,0.0027,8.5e-06 rank=0 -----
===== CPUmem(GB): tot=1.7e-05 (comb,oper,dvdson,hvec,renorm)=3.4e-06,1.4e-05,0,0,0 =====
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
comb::display_size
 rbases: len=5 mem=27:0.00021MB:2e-07GB
 sites: len=5 mem=230:0.0018MB:1.7e-06GB
 rwfuns: len=2 mem=4:3.1e-05MB:3e-08GB
 cpsi: len=2 mem=96:0.00073MB:7.2e-07GB
total mem of comb=357:0.0027MB:2.7e-06GB
===== CPUmem(GB): tot=3.6e-05 (comb,oper,dvdson,hvec,renorm)=2.7e-06,3.3e-05,0,0,0 =====
fname=./scratch/sweep/rop(2,0) size=1.94e-05GB T[save](info/data/tot)=6.37e-05,5.35e-05,0.000117 speed=0.165GB/s disk[used]=0.000106GB
ctns::rcanon_save fname=./scratch/sweep/result_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/site_ibond3.info
ctns::rcanon_save fname=./scratch/sweep/cpsi_ibond3.info
##### time_local: 1.32e-02 S #####
 T(fetch) = 3.00e-04 S  per =  2.3  per(accum) = 2.3
 T(hdiag) = 6.89e-05 S  per = 0.52  per(accum) = 2.8
 T(dvdsn) = 9.02e-03 S  per =   68  per(accum) = 71
 T(decim) = 3.33e-04 S  per =  2.5  per(accum) = 74
 T(guess) = 7.57e-05 S  per = 0.57  per(accum) = 74
 T(renrm) = 2.83e-03 S  per =   21  per(accum) = 95
 T(save ) = 5.98e-04 S  per =  4.5  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 8.84e-03 S
 T(qops_dict memcpy cpu2gpu     ) = 4.04e-05 S  per = 0.46  per(accum) = 0.46
 T(symbolic_formulae_twodot     ) = 2.23e-04 S  per =  2.5  per(accum) = 3
 T(hintermediate init           ) = 2.11e-05 S  per = 0.24  per(accum) = 3.2
 T(hintermediates memcpy cpu2gpu) = 3.45e-06 S  per = 0.039  per(accum) = 3.3
 T(preprocess_hformulae_Hxlist2 ) = 2.23e-03 S  per =   25  per(accum) = 28
 T(hmmtasks init                ) = 1.39e-03 S  per =   16  per(accum) = 44
 T(dvdson solver [Hx_batchGPU]  ) = 4.89e-03 S  per =   55  per(accum) = 1e+02
 T(dvdson solver [communication]) = 1.00e-07 S  per = 0.0011  per(accum) = 1e+02
 T(dvdson solver [rest part]    ) = 4.31e-05 S  per = 0.49  per(accum) = 1e+02
Detailed decomposition of T(renrm): 2.78e-03 S
 T(qops init                    ) = 7.38e-05 S  per =  2.7  per(accum) = 2.7
 T(qops_dict memcpy cpu2gpu     ) = 3.49e-05 S  per =  1.3  per(accum) = 3.9
 T(symbolic_formulae_renorm     ) = 1.80e-04 S  per =  6.5  per(accum) = 10
 T(rintermediate init           ) = 2.14e-05 S  per = 0.77  per(accum) = 11
 T(rintermediates memcpy cpu2gpu) = 4.35e-06 S  per = 0.16  per(accum) = 11
 T(preprocess_formulae_Rlist2   ) = 5.60e-04 S  per =   20  per(accum) = 31
 T(rmmtasks init                ) = 3.59e-04 S  per =   13  per(accum) = 44
 T(qops memset                  ) = 8.12e-06 S  per = 0.29  per(accum) = 45
 T(preprocess_renorm_batchGPU   ) = 1.50e-03 S  per =   54  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 2.68e-05 S  per = 0.97  per(accum) = 1e+02
 T(communication of opS and opH ) = 8.45e-06 S  per =  0.3  per(accum) = 1e+02
##### time_sweep: 1.08e-01 S #####
 T(fetch) = 7.51e-04 S  per = 0.69  per(accum) = 0.69
 T(hdiag) = 2.98e-04 S  per = 0.28  per(accum) = 0.97
 T(dvdsn) = 9.29e-02 S  per =   86  per(accum) = 87
 T(decim) = 8.16e-04 S  per = 0.75  per(accum) = 88
 T(guess) = 3.08e-04 S  per = 0.28  per(accum) = 88
 T(renrm) = 1.09e-02 S  per =   10  per(accum) = 98
 T(save ) = 2.32e-03 S  per =  2.1  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 9.22e-02 S
 T(qops_dict memcpy cpu2gpu     ) = 1.61e-04 S  per = 0.18  per(accum) = 0.18
 T(symbolic_formulae_twodot     ) = 9.11e-04 S  per = 0.99  per(accum) = 1.2
 T(hintermediate init           ) = 8.56e-05 S  per = 0.093  per(accum) = 1.3
 T(hintermediates memcpy cpu2gpu) = 1.42e-05 S  per = 0.015  per(accum) = 1.3
 T(preprocess_hformulae_Hxlist2 ) = 8.98e-03 S  per =  9.7  per(accum) = 11
 T(hmmtasks init                ) = 5.58e-03 S  per =    6  per(accum) = 17
 T(dvdson solver [Hx_batchGPU]  ) = 7.57e-02 S  per =   82  per(accum) = 99
 T(dvdson solver [communication]) = 1.69e-06 S  per = 0.0018  per(accum) = 99
 T(dvdson solver [rest part]    ) = 7.66e-04 S  per = 0.83  per(accum) = 1e+02
Detailed decomposition of T(renrm): 1.07e-02 S
 T(qops init                    ) = 3.33e-04 S  per =  3.1  per(accum) = 3.1
 T(qops_dict memcpy cpu2gpu     ) = 1.26e-04 S  per =  1.2  per(accum) = 4.3
 T(symbolic_formulae_renorm     ) = 7.60e-04 S  per =  7.1  per(accum) = 11
 T(rintermediate init           ) = 6.14e-05 S  per = 0.57  per(accum) = 12
 T(rintermediates memcpy cpu2gpu) = 1.82e-05 S  per = 0.17  per(accum) = 12
 T(preprocess_formulae_Rlist2   ) = 2.20e-03 S  per =   21  per(accum) = 33
 T(rmmtasks init                ) = 1.38e-03 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 3.28e-05 S  per = 0.31  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 5.65e-03 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 1.08e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 3.42e-05 S  per = 0.32  per(accum) = 1e+02
##### time_global: 7.45e-01 S #####
 T(fetch) = 5.24e-03 S  per =  0.7  per(accum) = 0.7
 T(hdiag) = 1.86e-03 S  per = 0.25  per(accum) = 0.95
 T(dvdsn) = 6.50e-01 S  per =   87  per(accum) = 88
 T(decim) = 5.64e-03 S  per = 0.76  per(accum) = 89
 T(guess) = 1.99e-03 S  per = 0.27  per(accum) = 89
 T(renrm) = 6.68e-02 S  per =    9  per(accum) = 98
 T(save ) = 1.38e-02 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 6.45e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 9.88e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 5.92e-03 S  per = 0.92  per(accum) = 1.1
 T(hintermediate init           ) = 5.81e-04 S  per = 0.09  per(accum) = 1.2
 T(hintermediates memcpy cpu2gpu) = 9.45e-05 S  per = 0.015  per(accum) = 1.2
 T(preprocess_hformulae_Hxlist2 ) = 5.45e-02 S  per =  8.4  per(accum) = 9.6
 T(hmmtasks init                ) = 3.40e-02 S  per =  5.3  per(accum) = 15
 T(dvdson solver [Hx_batchGPU]  ) = 5.43e-01 S  per =   84  per(accum) = 99
 T(dvdson solver [communication]) = 1.37e-05 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.96e-03 S  per = 0.92  per(accum) = 1e+02
Detailed decomposition of T(renrm): 6.56e-02 S
 T(qops init                    ) = 2.49e-03 S  per =  3.8  per(accum) = 3.8
 T(qops_dict memcpy cpu2gpu     ) = 8.14e-04 S  per =  1.2  per(accum) = 5
 T(symbolic_formulae_renorm     ) = 4.85e-03 S  per =  7.4  per(accum) = 12
 T(rintermediate init           ) = 4.03e-04 S  per = 0.61  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 1.19e-04 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 1.30e-02 S  per =   20  per(accum) = 33
 T(rmmtasks init                ) = 8.26e-03 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 2.07e-04 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 3.45e-02 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 6.81e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.14e-04 S  per = 0.33  per(accum) = 1e+02

======================================================================
sweep_data::summary isweep=5
----------------------------------------------------------------------
sweep parameters: isweep=5 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.04
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.013
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.042
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.013
 eav_max=-2.54574720706 [ibond=0]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=3]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=1.60474877831e-09
 sweep energies: isweep=5 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[0]=-2.65451696664
 sweep energies: isweep=5 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=5
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.00e-04 1.00e-04 | 52 | 1.69e-01 | 1.69e-01 | 1.10e-02 1.06e-01 1.11e-02 1.28e-01 76.1
            1  2      20 1.00e-04 0.00e+00 | 45 | 1.46e-01 | 3.15e-01 | 2.04e-02 1.98e-01 2.05e-02 2.39e-01 76
            2  2      20 1.00e-04 0.00e+00 | 31 | 1.09e-01 | 4.24e-01 | 2.69e-02 2.63e-01 2.71e-02 3.17e-01 74.8
            3  2      20 1.00e-04 0.00e+00 | 31 | 1.09e-01 | 5.33e-01 | 3.35e-02 3.27e-01 3.37e-02 3.95e-01 74
            4  2      20 1.00e-04 0.00e+00 | 31 | 1.10e-01 | 6.43e-01 | 4.00e-02 3.92e-01 4.03e-02 4.72e-01 73.4
            5  2      20 1.00e-04 0.00e+00 | 31 | 1.09e-01 | 7.53e-01 | 4.66e-02 4.57e-01 4.69e-02 5.50e-01 73.1
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.50e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
            1      20 +5.26e-04 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.67e-13)
            2      20 +0.00e+00 e[0]=-2.65451696664 (-4.44e-16) e[1]=-2.43697745069 (-4.44e-15)
            3      20 +5.26e-04 e[0]=-2.65451696664 (-1.33e-15) e[1]=-2.43697745069 (8.88e-16)
            4      20 +0.00e+00 e[0]=-2.65451696664 (4.44e-16) e[1]=-2.43697745069 (-2.22e-15)
            5      20 +5.26e-04 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep5.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep5_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
decimation summary: 80->8 dwt=-2.220e-16 SvN=1.326e+00

Convert [C]RRR => [cR]RRR:
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep5_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00

ctns::rcanon_save fname=./scratch/rcanon_isweep5.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.00e+00
 idx=2 node=(2,0) Drow=20 maxdiff=1.49e-15
 idx=3 node=(1,0) Drow=8 maxdiff=8.88e-16
 idx=4 node=(0,0) Drow=2 maxdiff=4.92e-18
stensor2: wf2 own=1 _data=0x448e8c30
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.05e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x448e8c30
      1.0000e+00      -3.0102e-18 
     -5.3512e-17       1.0000e+00 
 rwfuns: nroots=2 maxdiff=4.5123e-16
----- TIMING FOR ctns::rcanon_check : 7.961e-05 S -----
..... end of isweep = 5 .....

----- TIMING FOR ctns::sweep_opt : 7.573e-01 S -----
##### time_global: 7.45e-01 S #####
 T(fetch) = 5.24e-03 S  per =  0.7  per(accum) = 0.7
 T(hdiag) = 1.86e-03 S  per = 0.25  per(accum) = 0.95
 T(dvdsn) = 6.50e-01 S  per =   87  per(accum) = 88
 T(decim) = 5.64e-03 S  per = 0.76  per(accum) = 89
 T(guess) = 1.99e-03 S  per = 0.27  per(accum) = 89
 T(renrm) = 6.68e-02 S  per =    9  per(accum) = 98
 T(save ) = 1.38e-02 S  per =  1.9  per(accum) = 1e+02
Detailed decomposition of T(dvdsn): 6.45e-01 S
 T(qops_dict memcpy cpu2gpu     ) = 9.88e-04 S  per = 0.15  per(accum) = 0.15
 T(symbolic_formulae_twodot     ) = 5.92e-03 S  per = 0.92  per(accum) = 1.1
 T(hintermediate init           ) = 5.81e-04 S  per = 0.09  per(accum) = 1.2
 T(hintermediates memcpy cpu2gpu) = 9.45e-05 S  per = 0.015  per(accum) = 1.2
 T(preprocess_hformulae_Hxlist2 ) = 5.45e-02 S  per =  8.4  per(accum) = 9.6
 T(hmmtasks init                ) = 3.40e-02 S  per =  5.3  per(accum) = 15
 T(dvdson solver [Hx_batchGPU]  ) = 5.43e-01 S  per =   84  per(accum) = 99
 T(dvdson solver [communication]) = 1.37e-05 S  per = 0.0021  per(accum) = 99
 T(dvdson solver [rest part]    ) = 5.96e-03 S  per = 0.92  per(accum) = 1e+02
Detailed decomposition of T(renrm): 6.56e-02 S
 T(qops init                    ) = 2.49e-03 S  per =  3.8  per(accum) = 3.8
 T(qops_dict memcpy cpu2gpu     ) = 8.14e-04 S  per =  1.2  per(accum) = 5
 T(symbolic_formulae_renorm     ) = 4.85e-03 S  per =  7.4  per(accum) = 12
 T(rintermediate init           ) = 4.03e-04 S  per = 0.61  per(accum) = 13
 T(rintermediates memcpy cpu2gpu) = 1.19e-04 S  per = 0.18  per(accum) = 13
 T(preprocess_formulae_Rlist2   ) = 1.30e-02 S  per =   20  per(accum) = 33
 T(rmmtasks init                ) = 8.26e-03 S  per =   13  per(accum) = 46
 T(qops memset                  ) = 2.07e-04 S  per = 0.32  per(accum) = 46
 T(preprocess_renorm_batchGPU   ) = 3.45e-02 S  per =   53  per(accum) = 99
 T(qops memcpy gpu2cpu          ) = 6.81e-04 S  per =    1  per(accum) = 1e+02
 T(communication of opS and opH ) = 2.14e-04 S  per = 0.33  per(accum) = 1e+02

Congrats! CTNS calculation finishes successfully. Fri Apr  7 18:02:45 2023

