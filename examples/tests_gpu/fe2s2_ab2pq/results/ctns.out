
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Sun Nov 24 15:32:58 2024

GIT_HASH = bbedb4b0c297ffc259cf7e3058c558090b7570cb

mpisize = 1 maxthreads = 112

input file = input.dat

schedule::read fname = input.dat
----------------------------------------------------------------------
dtype 0
sorb 40
nelec 30
twom 0
twos 0 
integral_file moleinfo/fmole.info
scratch ./scratch

$ci
dets
0 2 4 6 8 10 12 14 16 18 20 22 24 36 38   1 3 15 17 19 21 23 25 27 29 31 33 35 37 39
end
checkms
nroots 1 
schedule
0 1.e-3
end
maxiter 1
$end

$ctns
verbose 1
qkind rNSz
maxdets 1000 #0 # keep dets as much as possible
topology_file topology/topo4
thresh_proj 1.e-10
thresh_ortho 1.e-8 #1.e-10
nroots 1 
schedule
0  1 100 1.e-4 0.0
end
maxsweep 1
alg_hvec 19
alg_hinter 2
alg_hcoper 2
alg_renorm 19
alg_rinter 2
alg_rcoper 1
task_dmrg
ifab2pq
ifdist1
ifdistc
ifnccl
#save_formulae
batchhvec 4 4 4
batchrenorm 4 4 4
$end

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
sorb  = 40
nelec = 30
twom  = 0
twos  = 0
integral_file = moleinfo/fmole.info
perfcomm = 0

===== params_ci::print =====
nroots = 1
no. of unique seeds = 1
0-th det: 0 1 2 3 4 6 8 10 12 14 15 16 17 18 19 20 21 22 23 24 25 27 29 31 33 35 36 37 38 39 
flip = 0
eps0 = 0.01
miniter = 0
maxiter = 1
schedule: iter eps1
0 0.001
convergence parameters
deltaE = 1e-10
checkms = 1
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 0
jroot = 0
load = 0
ci_file = ci.info
cthrd = 0.1
ifanalysis = 0
rdm = 0
init_aufbau = 0
init_seniority = 0

===== params_ctns::print =====
qkind = rNSz
topology_file = topology/topo4
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
task_oodmrg = 0
task_vmc = 0
task_expand = 0
task_tononsu2 = 0
task_prop = 
task_schmidt = 0
schmidt_file = svalues
restart_sweep = 0
restart_bond = 0
timestamp = 0
ciroots = 
maxdets = 1000
thresh_proj = 1.000000e-10
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
outprec = 12
nroots = 1
guess = 1
dbranch = 0
maxsweep = 1
maxbond = -1
schedule: isweep, dots, dcut, eps, noise
0 1 100 1.000000e-04 0.000000e+00
rcfprefix = 
alg_hvec = 19
alg_hinter = 2
alg_hcoper = 2
alg_renorm = 19
alg_rinter = 2
alg_rcoper = 1
alg_rdm = 1
alg_decim = 1
notrunc = 0
ifab2pq = 1
ifdist1 = 1
ifdistc = 1
save_formulae = 0
sort_formulae = 0
save_mmtask = 0
batchhvec = 4 4 4
batchrenorm = 4 4 4
batchmem = 1.000000e+01
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
precond = 1
rcanon_file = 
rcanon2_file = 
iomode = 0
async_fetch = 0
async_save = 0
async_remove = 0
ifnccl = 1
iroot = 0
jroot = 0
nsample = 5000
nprt = 10
pthrd = -1.000000e-02
thresh_cabs = 1.100000e+00
detbasis = 0
tosu2 = 0
thresh_tosu2 = 1.000000e-08
singlet = 0
diagcheck = 0
savebin = 0
fromnosym = 0
oodmrg parameters:
 iprt=1
 maxiter=10
 dfac=2
 macroiter=5
 microiter=50
 alpha=5.000000e-01
 thrdopt=1.000000e-04
 thrdloc=1.000000e-06
 thrddwt=1.000000e+00
 thrdeps=1.000000e-08
 nptloc=2.000000e+01
 acceptall=0
 unrestricted=0
 urot=
inputconf = 
saveconfs = 
loadconfs = 
debug_rdm = 0
alg_mrpt2 = 0
nv2 = 0
nc2 = 0

io::create_scratch scratch=./scratch

gpu_init
CUDA Runtime version: 11080
CUBLAS version: 111103
rank=0 num_gpus=2 device_id=0 magma_queue=0x29037c0

ctns::topology::read fname=topology/topo4
0
1
2
3
4
16
17
18
19
5
6
7
8
9
10
11
12
13
14
15

ctns::topology::print ifmps=1 ntotal=20 nphysical=20 nbackbone=20
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
 i=5 : 16 
 i=6 : 17 
 i=7 : 18 
 i=8 : 19 
 i=9 : 5 
 i=10 : 6 
 i=11 : 7 
 i=12 : 8 
 i=13 : 9 
 i=14 : 10 
 i=15 : 11 
 i=16 : 12 
 i=17 : 13 
 i=18 : 14 
 i=19 : 15 
rcoord:
 idx=0 coord=(19,0) rindex=0 node: lindex=19 porb=15 type=0 center=(-1,-1) left=(18,0) right=(-2,-2)
 idx=1 coord=(18,0) rindex=1 node: lindex=18 porb=14 type=1 center=(-1,-1) left=(17,0) right=(19,0)
 idx=2 coord=(17,0) rindex=2 node: lindex=17 porb=13 type=1 center=(-1,-1) left=(16,0) right=(18,0)
 idx=3 coord=(16,0) rindex=3 node: lindex=16 porb=12 type=1 center=(-1,-1) left=(15,0) right=(17,0)
 idx=4 coord=(15,0) rindex=4 node: lindex=15 porb=11 type=1 center=(-1,-1) left=(14,0) right=(16,0)
 idx=5 coord=(14,0) rindex=5 node: lindex=14 porb=10 type=1 center=(-1,-1) left=(13,0) right=(15,0)
 idx=6 coord=(13,0) rindex=6 node: lindex=13 porb=9 type=1 center=(-1,-1) left=(12,0) right=(14,0)
 idx=7 coord=(12,0) rindex=7 node: lindex=12 porb=8 type=1 center=(-1,-1) left=(11,0) right=(13,0)
 idx=8 coord=(11,0) rindex=8 node: lindex=11 porb=7 type=1 center=(-1,-1) left=(10,0) right=(12,0)
 idx=9 coord=(10,0) rindex=9 node: lindex=10 porb=6 type=1 center=(-1,-1) left=(9,0) right=(11,0)
 idx=10 coord=(9,0) rindex=10 node: lindex=9 porb=5 type=1 center=(-1,-1) left=(8,0) right=(10,0)
 idx=11 coord=(8,0) rindex=11 node: lindex=8 porb=19 type=1 center=(-1,-1) left=(7,0) right=(9,0)
 idx=12 coord=(7,0) rindex=12 node: lindex=7 porb=18 type=1 center=(-1,-1) left=(6,0) right=(8,0)
 idx=13 coord=(6,0) rindex=13 node: lindex=6 porb=17 type=1 center=(-1,-1) left=(5,0) right=(7,0)
 idx=14 coord=(5,0) rindex=14 node: lindex=5 porb=16 type=1 center=(-1,-1) left=(4,0) right=(6,0)
 idx=15 coord=(4,0) rindex=15 node: lindex=4 porb=4 type=1 center=(-1,-1) left=(3,0) right=(5,0)
 idx=16 coord=(3,0) rindex=16 node: lindex=3 porb=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=17 coord=(2,0) rindex=17 node: lindex=2 porb=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=18 coord=(1,0) rindex=18 node: lindex=1 porb=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=19 coord=(0,0) rindex=19 node: lindex=0 porb=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(19,0) rsupport: 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) rsupport: 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) rsupport: 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) rsupport: 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) rsupport: 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) rsupport: 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) rsupport: 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) rsupport: 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) rsupport: 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) rsupport: 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) rsupport: 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) rsupport: 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) rsupport: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) rsupport: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 
 idx=14 coord=(5,0) rsupport: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 
 idx=15 coord=(4,0) rsupport: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 
 idx=16 coord=(3,0) rsupport: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 
 idx=17 coord=(2,0) rsupport: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 
 idx=18 coord=(1,0) rsupport: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 
 idx=19 coord=(0,0) rsupport: 0 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(19,0) corbs: 15 ; rorbs: ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) corbs: 14 ; rorbs: 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) corbs: 13 ; rorbs: 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) corbs: 12 ; rorbs: 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) corbs: 11 ; rorbs: 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) corbs: 10 ; rorbs: 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) corbs: 9 ; rorbs: 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) corbs: 8 ; rorbs: 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) corbs: 7 ; rorbs: 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) corbs: 6 ; rorbs: 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) corbs: 5 ; rorbs: 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) corbs: 19 ; rorbs: 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) corbs: 18 ; rorbs: 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) corbs: 17 ; rorbs: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 
 idx=14 coord=(5,0) corbs: 16 ; rorbs: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 
 idx=15 coord=(4,0) corbs: 4 ; rorbs: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 
 idx=16 coord=(3,0) corbs: 3 ; rorbs: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 
 idx=17 coord=(2,0) corbs: 2 ; rorbs: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 
 idx=18 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 
 idx=19 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9 32 33 34 35 36 37 38 39 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31

fci::ci_load fname=./scratch/ci.info

ctns::rcanon_init qkind=qNSz

fci::ci_truncate ciconfs=1641 maxdets=1000 ifortho=1
 iroot=0 <CI[trunc]|CI>=9.972497175295e-01

ctns::init_rbases rdm_svd=1.500e+00 thresh_proj=1.000e-10

idx=
idx=
idx=
idx=
idx=
idx=
idx=5 node=4(14,0) type=1
idx=
idx=
idx=
idx=
idx=
idx= node=14 node=
idx=9 node=
idx=180( node=15 rsupport=10 11 12 13 14 15 
12 node=
idx=(
idx=
idx=3 node= node=((1617,,00
idx=))
idx=18,0)(517((715 type=1101612 node=1 type=111 node=1910,, node= rsupport= node=12(0( node= node=13(68( rsupport=19 node=2 node=,(,,6130(  node=13)4 type=, node=,0) type= node=(3,01,( 00)1213 rsupport=(,(007))9 type=),,18,00 node=)0) type=)( type=(1 type= type=111,) rsupport=,0  type=110 rsupport=,19)0 type= type= rsupport=  rsupport=)0 rsupport=110 type=019 0516)0 type= type=) ) type=14 rsupport=18 1917 18 1 rsupport= type=14141 11110  rsupport=2 5  rsupport=150  rsupport= rsupport= 6  11115  7 rsupport=37)  1 
  11912 844 rsupport= type=2 rsupport= 5 6 7 8 9 10 11 12 13 14 15 
8 9    1083  type=15126  4 16 1711  1 rsupport= 13 
18  rsupport=12176 13 14 15   13 
 5 157 7 14 15 13
16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
 19 5 6 7 8 9 10 11 12 13 14 15 2
8 9 10 11 12 13 14 15  
8  4 16 17 18 19 5 6  714 15 
6 7 8 9 10 11 12 13 14 15 
 3 4 16 17 18 19 5 6  16 17 187  198  
95 6 9 10 11 12 13 14 15 
 
 18 19 5 6 7 8 9 10 11 12 13 14 15  8 9 10 11 12 13 14 15 
9 10 11 12 13 14 15 
7 8 9 10 11 12 13 14 15 
 9 10 11 12 13 14 15 

 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=ctns::right_projection<Qm,Tm> thresh_proj=1.000e-101.000e-10

ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=1000,932,4 dimBc=4 1-popBc=2.220e-16 SvN=6.821e-01
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.848e-02 S -----
 dim(space,lspace,rspace)=1000,735,10 dimBc=10 1-popBc=2.22e-16 SvN=1.04
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.747e-02 S -----
 dim(space,lspace,rspace)= dim(space,lspace,rspace)=10001000,,566,54 dimBc=68442 1-popBc=,267.77e-16 dimBc= SvN=241.25 1-popBc=
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.11e-154.395e-02 S -----
 SvN=1.2
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.372e-02 S -----
 dim(space,lspace,rspace)=1000,495,82 dimBc=58 1-popBc=4.44e-16 SvN=1.62
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.813e-02 S -----
 dim(space,lspace,rspace)=1000,1,1000 dimBc=1 1-popBc=2.22e-16 SvN=2.22e-16
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.437e-02 S -----
 dim(space,lspace,rspace)=1000,412,123 dimBc=68 1-popBc=0 SvN=1.93
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.221e-02 S -----
 dim(space,lspace,rspace)=1000,3,1000 dimBc=3 1-popBc=5.55e-16 SvN=0.274
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.865e-02 S -----
 dim(space,lspace,rspace)=1000,43,623 dimBc=38 1-popBc=1.11e-16 SvN=1.52
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.694e-02 S -----
 dim(space,lspace,rspace)=1000,6,893 dimBc=6 1-popBc=3.33e-16 SvN=0.547
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.642e-02 S -----
 dim(space,lspace,rspace)=1000,10,849 dimBc=10 1-popBc=2.22e-16 SvN=0.765
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.733e-02 S -----
 dim(space,lspace,rspace)=1000,17,760 dimBc=17 1-popBc=5.55e-16 SvN=0.952
----- TIMING FOR ctns::right_projection<Qm,Tm> :  dim(space,lspace,rspace)=2.757e-02 S -----
1000,296,171 dimBc=77 1-popBc=2.22e-16 SvN=2.15
 dim(space,lspace,rspace)=----- TIMING FOR 1000,55,ctns::right_projection<Qm,Tm>541 :  dimBc=47 1-popBc=3.751e-02 S -----
2.220e-16 SvN=1.82
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.857e-02 S -----
 dim(space,lspace,rspace)=1000,31,624 dimBc=27 1-popBc=7.77e-16 SvN=1.18
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.816e-02 S -----
 dim(space,lspace,rspace)=1000,90,503 dimBc=57 1-popBc=0 SvN=1.98
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.399e-02 S -----
 dim(space,lspace,rspace)=1000,186,234 dimBc=74 1-popBc=2.22e-16 SvN=2.31
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.793e-02 S -----
 dim(space,lspace,rspace)=1000,161,345 dimBc=73 1-popBc=0 SvN=2.23
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.384e-02 S -----
 dim(space,lspace,rspace)=1000,128,435 dimBc=65 1-popBc=7.77e-16 SvN=2.08
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.593e-02 S -----

generated rbases with thresh_proj=1e-10
 idx=0 node=(19,0) type=0 shape=4,4 1-popBc=0.000e+00
 idx=1 node=(18,0) type=1 shape=4,4 1-popBc=2.220e-16
 idx=2 node=(17,0) type=1 shape=10,10 1-popBc=2.220e-16
 idx=3 node=(16,0) type=1 shape=26,24 1-popBc=1.110e-15
 idx=4 node=(15,0) type=1 shape=54,42 1-popBc=7.772e-16
 idx=5 node=(14,0) type=1 shape=82,58 1-popBc=4.441e-16
 idx=6 node=(13,0) type=1 shape=123,68 1-popBc=0.000e+00
 idx=7 node=(12,0) type=1 shape=171,77 1-popBc=2.220e-16
 idx=8 node=(11,0) type=1 shape=234,74 1-popBc=2.220e-16
 idx=9 node=(10,0) type=1 shape=345,73 1-popBc=0.000e+00
 idx=10 node=(9,0) type=1 shape=435,65 1-popBc=7.772e-16
 idx=11 node=(8,0) type=1 shape=503,57 1-popBc=0.000e+00
 idx=12 node=(7,0) type=1 shape=541,47 1-popBc=2.220e-16
 idx=13 node=(6,0) type=1 shape=623,38 1-popBc=1.110e-16
 idx=14 node=(5,0) type=1 shape=624,27 1-popBc=7.772e-16
 idx=15 node=(4,0) type=1 shape=760,17 1-popBc=5.551e-16
 idx=16 node=(3,0) type=1 shape=849,10 1-popBc=2.220e-16
 idx=17 node=(2,0) type=1 shape=893,6 1-popBc=3.331e-16
 idx=18 node=(1,0) type=1 shape=1000,3 1-popBc=5.551e-16
 idx=19 node=(0,0) type=0 shape=1000,1 1-popBc=2.220e-16
maximum bond dimension = 77
----- TIMING FOR ctns::init_rbases : 8.013e-02 S -----

ctns::init_rsites qkind=qNSz thresh_ortho=1e-08
 idx=0 node=(19,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 deviate=0 TIMING=5.244e-05 S
 idx=1 node=(18,0)[1] shape(l,r,c)=(4,4,4) maxdiff=3.145e-16 deviate=0 TIMING=1.615e-02 S
 idx=2 node=(17,0)[1] shape(l,r,c)=(10,4,4) maxdiff=5.680e-16 deviate=0 TIMING=9.969e-03 S
 idx=3 node=(16,0)[1] shape(l,r,c)=(24,10,4) maxdiff=1.448e-15 deviate=0 TIMING=9.225e-03 S
 idx=4 node=(15,0)[1] shape(l,r,c)=(42,24,4) maxdiff=3.503e-15 deviate=0 TIMING=1.095e-02 S
 idx=5 node=(14,0)[1] shape(l,r,c)=(58,42,4) maxdiff=4.266e-15 deviate=0 TIMING=9.742e-03 S
 idx=6 node=(13,0)[1] shape(l,r,c)=(68,58,4) maxdiff=5.451e-15 deviate=0 TIMING=9.715e-03 S
 idx=7 node=(12,0)[1] shape(l,r,c)=(77,68,4) maxdiff=5.758e-15 deviate=0 TIMING=9.691e-03 S
 idx=8 node=(11,0)[1] shape(l,r,c)=(74,77,4) maxdiff=4.209e-15 deviate=0 TIMING=9.694e-03 S
 idx=9 node=(10,0)[1] shape(l,r,c)=(73,74,4) maxdiff=4.655e-15 deviate=0 TIMING=1.019e-02 S
 idx=10 node=(9,0)[1] shape(l,r,c)=(65,73,4) maxdiff=4.351e-15 deviate=0 TIMING=9.260e-03 S
 idx=11 node=(8,0)[1] shape(l,r,c)=(57,65,4) maxdiff=3.881e-15 deviate=0 TIMING=9.064e-03 S
 idx=12 node=(7,0)[1] shape(l,r,c)=(47,57,4) maxdiff=4.017e-15 deviate=0 TIMING=9.087e-03 S
 idx=13 node=(6,0)[1] shape(l,r,c)=(38,47,4) maxdiff=3.392e-15 deviate=0 TIMING=9.084e-03 S
 idx=14 node=(5,0)[1] shape(l,r,c)=(27,38,4) maxdiff=3.956e-15 deviate=0 TIMING=9.101e-03 S
 idx=15 node=(4,0)[1] shape(l,r,c)=(17,27,4) maxdiff=3.005e-15 deviate=0 TIMING=9.111e-03 S
 idx=16 node=(3,0)[1] shape(l,r,c)=(10,17,4) maxdiff=2.389e-15 deviate=0 TIMING=9.054e-03 S
 idx=17 node=(2,0)[1] shape(l,r,c)=(6,10,4) maxdiff=5.027e-16 deviate=0 TIMING=1.036e-02 S
 idx=18 node=(1,0)[1] shape(l,r,c)=(3,6,4) maxdiff=4.441e-16 deviate=0 TIMING=7.740e-03 S
 idx=19 node=(0,0)[0] shape(l,r,c)=(1,3,4) maxdiff=1.110e-16 deviate=0 TIMING=9.054e-03 S
----- TIMING FOR ctns::init_rsites : 1.876e-01 S -----

ctns::init_rwfuns qkind=qNSz thresh_ortho=1e-08
qtensor2: wf2 own=1 _data=0x52069b20
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.63e-06MB

check state overlaps ...
matrix: ova_rwfuns size=(1,1)
      1.0000e+00 
matrix: ova0_vs size=(1,1)
      1.0000e+00 
diff of ova matrices = 1.11e-16
----- TIMING FOR ctns::init_rwfuns : 8.287e-03 S -----

ctns::init_rcanon thresh_ortho=1e-08

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=1000
matrix: <CI|CTNS[0]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[0]> size=(1,1)
      1.0000e+00 

rcanon::rcanon_canonicalize ifortho=1 ifab=1 nroots=1 dmax=77
----- TIMING FOR ctns::rcanon_canonicalize : 3.680e-01 S -----

matrix: <CTNS[new]|CTNS[new]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=1000
matrix: <CI|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=4 maxdiff=3.143e-16 deviate=0
 idx=2 node=(17,0) Drow=10 maxdiff=6.713e-16 deviate=0
 idx=3 node=(16,0) Drow=24 maxdiff=1.911e-15 deviate=0
 idx=4 node=(15,0) Drow=42 maxdiff=3.086e-15 deviate=0
 idx=5 node=(14,0) Drow=58 maxdiff=2.705e-15 deviate=0
 idx=6 node=(13,0) Drow=68 maxdiff=4.544e-15 deviate=0
 idx=7 node=(12,0) Drow=77 maxdiff=5.164e-15 deviate=0
 idx=8 node=(11,0) Drow=74 maxdiff=4.182e-15 deviate=0
 idx=9 node=(10,0) Drow=73 maxdiff=3.550e-15 deviate=0
 idx=10 node=(9,0) Drow=65 maxdiff=3.268e-15 deviate=0
 idx=11 node=(8,0) Drow=57 maxdiff=2.974e-15 deviate=0
 idx=12 node=(7,0) Drow=47 maxdiff=2.880e-15 deviate=0
 idx=13 node=(6,0) Drow=38 maxdiff=1.920e-15 deviate=0
 idx=14 node=(5,0) Drow=27 maxdiff=2.674e-15 deviate=0
 idx=15 node=(4,0) Drow=17 maxdiff=1.242e-15 deviate=0
 idx=16 node=(3,0) Drow=10 maxdiff=6.884e-16 deviate=0
 idx=17 node=(2,0) Drow=6 maxdiff=5.565e-16 deviate=0
 idx=18 node=(1,0) Drow=3 maxdiff=2.220e-16 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=4.441e-16 deviate=0
qtensor2: wf2 own=1 _data=0x510355c0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x510355c0
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 7.483e-04 S -----
----- TIMING FOR ctns::rcanon_init : 1.337e+00 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=4 maxdiff=3.143e-16 deviate=0
 idx=2 node=(17,0) Drow=10 maxdiff=6.713e-16 deviate=0
 idx=3 node=(16,0) Drow=24 maxdiff=1.911e-15 deviate=0
 idx=4 node=(15,0) Drow=42 maxdiff=3.086e-15 deviate=0
 idx=5 node=(14,0) Drow=58 maxdiff=2.705e-15 deviate=0
 idx=6 node=(13,0) Drow=68 maxdiff=4.544e-15 deviate=0
 idx=7 node=(12,0) Drow=77 maxdiff=5.164e-15 deviate=0
 idx=8 node=(11,0) Drow=74 maxdiff=4.182e-15 deviate=0
 idx=9 node=(10,0) Drow=73 maxdiff=3.550e-15 deviate=0
 idx=10 node=(9,0) Drow=65 maxdiff=3.268e-15 deviate=0
 idx=11 node=(8,0) Drow=57 maxdiff=2.974e-15 deviate=0
 idx=12 node=(7,0) Drow=47 maxdiff=2.880e-15 deviate=0
 idx=13 node=(6,0) Drow=38 maxdiff=1.920e-15 deviate=0
 idx=14 node=(5,0) Drow=27 maxdiff=2.674e-15 deviate=0
 idx=15 node=(4,0) Drow=17 maxdiff=1.242e-15 deviate=0
 idx=16 node=(3,0) Drow=10 maxdiff=6.884e-16 deviate=0
 idx=17 node=(2,0) Drow=6 maxdiff=5.565e-16 deviate=0
 idx=18 node=(1,0) Drow=3 maxdiff=2.220e-16 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=4.441e-16 deviate=0
qtensor2: wf2 own=1 _data=0x50eb4d50
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x50eb4d50
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 7.715e-04 S -----

integral::load fname = moleinfo/fmole.info
 sorb = 40
 size(int1e) = 1600:0.0122MB:1.19e-05GB
 size(int2e) = 305370:2.33MB:0.00228GB
 ecore = 0.000000000000
----- TIMING FOR integral::load : 1.106e-01 S -----

io::remove_scratch scratch=./scratch/sweep
successfully removed ./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=qNSz
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(19,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(19,0) size=1.74e-05GB T[save](info/data/tot)=0.000125,5.96e-05,0.000185 speed=0.094GB/S disk[used]=1.77e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/rop(19,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/rop(19,0) size=1.74e-05GB T[save](info/data/tot)=9.91e-05,6.21e-05,0.000161 speed=0.108GB/S disk[used]=3.54e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(18,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(18,0) size=1.74e-05GB T[save](info/data/tot)=9.99e-05,5.77e-05,0.000158 speed=0.11GB/S disk[used]=5.31e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(17,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(17,0) size=1.74e-05GB T[save](info/data/tot)=0.000104,5.99e-05,0.000164 speed=0.106GB/S disk[used]=7.07e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(16,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(16,0) size=1.74e-05GB T[save](info/data/tot)=9.48e-05,5.39e-05,0.000149 speed=0.117GB/S disk[used]=8.84e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(15,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(15,0) size=1.74e-05GB T[save](info/data/tot)=0.000129,5.44e-05,0.000184 speed=0.0948GB/S disk[used]=0.000106GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(14,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(14,0) size=1.74e-05GB T[save](info/data/tot)=9.94e-05,5.08e-05,0.00015 speed=0.116GB/S disk[used]=0.000124GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(13,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(13,0) size=1.74e-05GB T[save](info/data/tot)=0.000106,5.86e-05,0.000165 speed=0.105GB/S disk[used]=0.000141GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(12,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(12,0) size=1.74e-05GB T[save](info/data/tot)=0.000106,5.38e-05,0.00016 speed=0.109GB/S disk[used]=0.000159GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(11,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(11,0) size=1.74e-05GB T[save](info/data/tot)=9.58e-05,5.28e-05,0.000149 speed=0.117GB/S disk[used]=0.000177GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(10,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(10,0) size=1.74e-05GB T[save](info/data/tot)=9.63e-05,5.43e-05,0.000151 speed=0.116GB/S disk[used]=0.000195GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(9,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(9,0) size=1.74e-05GB T[save](info/data/tot)=0.000102,5.53e-05,0.000157 speed=0.111GB/S disk[used]=0.000212GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(8,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(8,0) size=1.74e-05GB T[save](info/data/tot)=9.87e-05,5.36e-05,0.000152 speed=0.114GB/S disk[used]=0.00023GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(7,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(7,0) size=1.74e-05GB T[save](info/data/tot)=0.000151,9e-05,0.000241 speed=0.0722GB/S disk[used]=0.000248GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(6,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(6,0) size=1.74e-05GB T[save](info/data/tot)=0.000146,9.61e-05,0.000242 speed=0.072GB/S disk[used]=0.000265GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(5,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(5,0) size=1.74e-05GB T[save](info/data/tot)=0.000154,0.000101,0.000255 speed=0.0682GB/S disk[used]=0.000283GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(4,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(4,0) size=1.74e-05GB T[save](info/data/tot)=0.000142,9.45e-05,0.000236 speed=0.0737GB/S disk[used]=0.000301GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(3,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(3,0) size=1.74e-05GB T[save](info/data/tot)=0.000145,9.49e-05,0.00024 speed=0.0726GB/S disk[used]=0.000318GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(2,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(2,0) size=1.74e-05GB T[save](info/data/tot)=0.000144,9.89e-05,0.000243 speed=0.0717GB/S disk[used]=0.000336GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(1,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(1,0) size=1.74e-05GB T[save](info/data/tot)=0.000141,9.68e-05,0.000238 speed=0.0731GB/S disk[used]=0.000354GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(0,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(0,0) size=1.74e-05GB T[save](info/data/tot)=0.000141,9.83e-05,0.000239 speed=0.0728GB/S disk[used]=0.000371GB
----- TIMING FOR ctns::oper_init_dotCR : 2.135e-01 S -----
T[ctns::oper_init_dotCR](comp/save/tot)=0.191,0.00584,0.197

idx=1 coord=(18,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
ctns::oper_renorm coord=(18,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:4 S:36 H:1 A:6 B:10 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=123:0.000938MB:9.16e-07GB
CPUmem: VM:2.003e+01GB RSS:1.884e+00GB  Timing: User:6.633e+01S Sys:1.409e+00S Total:6.774e+01S
----- TIMING FOR symbolic_formulae_renorm with size=57 : 1.565e-03 S -----
rank=0 GPUmem(GB): used=3.57e-05 (oper)=3.57e-05
rank=0 GPUmem(GB): used=3.58e-05 (oper,site)(GB)=3.57e-05,4.47e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=3.58e-05 (oper,site,rinter)=3.57e-05,4.47e-08,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00103 S size(rtasks)=57 size(Rlst2)=9 T(Rmu/Rlist)=0.000649,0.000384 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00106 S size(rtasks)=57 size(Rlst)=196 -----
rank=0 GPUmem(GB): used=3.58e-05 (oper,site,rinter,batch)=3.57e-05,4.47e-08,0,1.31e-05 blksize=4 blksize0=0 batchsize=196
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.18e-05,0.00108,0.000213
--- TIMING FOR renorm : t_inter=7.0e-05 t_gemm=1.1e-03 t_reduction=2.1e-04 tot=1.4e-03 ---
 renorm[inter] counter=1 t=7.0e-05 per=5.2e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=3.3e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=1.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=9.4e-04 per=6.9e+01 cost=1.7e+02 flops=1.9e+05
 renorm[gemm] counter=1 i=3 t=6.4e-05 per=4.7e+00 cost=2.6e+02 flops=4.1e+06
 renorm[gemm] counter=1 i=4 t=1.2e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=5 t=1.1e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=6 t=6.7e-05 per=4.9e+00 cost=8.4e+02 flops=1.3e+07
 renorm[gemm] counter=1 total t=1.1e-03 per=7.9e+01 cost=1.3e+03 flops=1.2e+06
 renorm[red] counter=1 t=2.1e-04 per=1.6e+01 cost=8.4e+02 flops=4.0e+06
--- TIMING FOR renorm_tot : t_inter=7.0e-05 t_gemm=1.1e-03 t_reduction=2.1e-04 tot=1.4e-03 ---
 renorm_tot[inter] counter=1 t=7.0e-05 per=5.2e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=3.3e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=1.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=9.4e-04 per=6.9e+01 cost=1.7e+02 flops=1.9e+05
 renorm_tot[gemm] counter=1 i=3 t=6.4e-05 per=4.7e+00 cost=2.6e+02 flops=4.1e+06
 renorm_tot[gemm] counter=1 i=4 t=1.2e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=5 t=1.1e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=6 t=6.7e-05 per=4.9e+00 cost=8.4e+02 flops=1.3e+07
 renorm_tot[gemm] counter=1 total t=1.1e-03 per=7.9e+01 cost=1.3e+03 flops=1.2e+06
 renorm_tot[red] counter=1 t=2.1e-04 per=1.6e+01 cost=8.4e+02 flops=4.0e+06
qops.to_cpu: size(tot)=123:9.4e-04MB:9.2e-07GB t[to_cpu]=2.0e-05S speed=4.5e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(18,0) rank=0
ctns::oper_ab2pq coord=(18,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00575 S rank=0 -----
##### local oper_env: 2.561e-02 S #####
 T(local oper_env: fetch) = 1.765e-02 S  per = 68.9  per(accum) = 68.9
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 68.9
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 68.9
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 68.9
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 68.9
 T(local oper_env: renrm) = 5.879e-03 S  per =   23  per(accum) = 91.9
 T(local oper_env: save ) = 2.077e-03 S  per = 8.11  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.879e-03 S  T(sum) = 5.879e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.464e-05 S  per = 0.249  per(accum) = 0.249
 T(local oper_env: qops init                    ) = 4.328e-04 S  per = 7.36  per(accum) = 7.61
 T(local oper_env: symbolic_formulae_renorm     ) = 1.574e-03 S  per = 26.8  per(accum) = 34.4
 T(local oper_env: allocate qops on gpu         ) = 5.314e-05 S  per = 0.904  per(accum) = 35.3
 T(local oper_env: site memcpy cpu2gpu          ) = 4.194e-05 S  per = 0.713  per(accum) = 36
 T(local oper_env: rintermediate init           ) = 3.080e-05 S  per = 0.524  per(accum) = 36.5
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.072e-03 S  per = 18.2  per(accum) = 54.7
 T(local oper_env: rmmtasks init                ) = 1.019e-03 S  per = 17.3  per(accum) = 72.1
 T(local oper_env: qops memset on cpu           ) = 3.200e-08 S  per = 0.000544  per(accum) = 72.1
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.456e-03 S  per = 24.8  per(accum) = 96.8
 T(local oper_env: reduction of opS & opH [nccl]) = 1.019e-06 S  per = 0.0173  per(accum) = 96.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.590e-05 S  per = 0.441  per(accum) = 97.3
 T(local oper_env: deallocate cpu and gpu memory) = 1.912e-05 S  per = 0.325  per(accum) = 97.6
 T(local oper_env: reduction of opS & opH [comm]) = 2.126e-05 S  per = 0.362  per(accum) = 98
 T(local oper_env: conversion from opAB to opPQ ) = 3.894e-06 S  per = 0.0662  per(accum) = 98.1
 T(local oper_env: after oper_renorm            ) = 1.140e-04 S  per = 1.94  per(accum) = 100
##### sweep oper_env: 2.561e-02 S #####
 T(sweep oper_env: fetch) = 1.765e-02 S  per = 68.9  per(accum) = 68.9
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 68.9
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 68.9
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 68.9
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 68.9
 T(sweep oper_env: renrm) = 5.879e-03 S  per =   23  per(accum) = 91.9
 T(sweep oper_env: save ) = 2.077e-03 S  per = 8.11  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(sweep oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.879e-03 S  T(sum) = 5.879e-03 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.464e-05 S  per = 0.249  per(accum) = 0.249
 T(sweep oper_env: qops init                    ) = 4.328e-04 S  per = 7.36  per(accum) = 7.61
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.574e-03 S  per = 26.8  per(accum) = 34.4
 T(sweep oper_env: allocate qops on gpu         ) = 5.314e-05 S  per = 0.904  per(accum) = 35.3
 T(sweep oper_env: site memcpy cpu2gpu          ) = 4.194e-05 S  per = 0.713  per(accum) = 36
 T(sweep oper_env: rintermediate init           ) = 3.080e-05 S  per = 0.524  per(accum) = 36.5
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.072e-03 S  per = 18.2  per(accum) = 54.7
 T(sweep oper_env: rmmtasks init                ) = 1.019e-03 S  per = 17.3  per(accum) = 72.1
 T(sweep oper_env: qops memset on cpu           ) = 3.200e-08 S  per = 0.000544  per(accum) = 72.1
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.456e-03 S  per = 24.8  per(accum) = 96.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.019e-06 S  per = 0.0173  per(accum) = 96.9
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.590e-05 S  per = 0.441  per(accum) = 97.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.912e-05 S  per = 0.325  per(accum) = 97.6
 T(sweep oper_env: reduction of opS & opH [comm]) = 2.126e-05 S  per = 0.362  per(accum) = 98
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.894e-06 S  per = 0.0662  per(accum) = 98.1
 T(sweep oper_env: after oper_renorm            ) = 1.140e-04 S  per = 1.94  per(accum) = 100

idx=2 coord=(17,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHAB nops=C:4 S:36 H:1 A:6 B:10 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=123:0.000938MB:9.16e-07GB
ctns::oper_renorm coord=(17,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:6 S:34 H:1 A:15 B:21 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=840:0.00641MB:6.26e-06GB
CPUmem: VM:2.003e+01GB RSS:1.885e+00GB  Timing: User:6.634e+01S Sys:1.412e+00S Total:6.775e+01S
----- TIMING FOR symbolic_formulae_renorm with size=77 : 3.284e-03 S -----
rank=0 GPUmem(GB): used=2.46e-05 (oper)=2.46e-05
rank=0 GPUmem(GB): used=2.48e-05 (oper,site)(GB)=2.46e-05,1.94e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=176
 no. of coefficients=745:0.00568MB:5.55e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.326e-04 S -----
rank=0 GPUmem(GB): used=3.03e-05 (oper,site,rinter)=2.46e-05,1.94e-07,5.55e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00226 S size(rtasks)=77 size(Rlst2)=25 T(Rmu/Rlist)=0.00119,0.00107 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00234 S size(rtasks)=77 size(Rlst)=712 -----
rank=0 GPUmem(GB): used=3.03e-05 (oper,site,rinter,batch)=2.46e-05,1.94e-07,5.55e-06,0.000122 blksize=9 blksize0=4 batchsize=712
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.0001,0.000495,0.00019
--- TIMING FOR renorm : t_inter=1.0e-04 t_gemm=4.9e-04 t_reduction=1.9e-04 tot=7.8e-04 ---
 renorm[inter] counter=2 t=1.0e-04 per=1.3e+01 cost=5.8e+03 flops=5.8e+07
 renorm[gemm] counter=2 i=0 t=1.4e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=1 t=1.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=2 t=1.5e-04 per=1.9e+01 cost=3.3e+03 flops=2.2e+07
 renorm[gemm] counter=2 i=3 t=1.6e-04 per=2.0e+01 cost=3.1e+03 flops=2.0e+07
 renorm[gemm] counter=2 i=4 t=1.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=5 t=1.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=6 t=1.8e-04 per=2.3e+01 cost=1.2e+04 flops=6.4e+07
 renorm[gemm] counter=2 total t=4.9e-04 per=6.3e+01 cost=1.8e+04 flops=3.6e+07
 renorm[red] counter=2 t=1.9e-04 per=2.4e+01 cost=8.0e+03 flops=4.2e+07
--- TIMING FOR renorm_tot : t_inter=1.7e-04 t_gemm=1.6e-03 t_reduction=4.0e-04 tot=2.1e-03 ---
 renorm_tot[inter] counter=2 t=1.7e-04 per=7.9e+00 cost=5.8e+03 flops=3.4e+07
 renorm_tot[gemm] counter=2 i=0 t=4.7e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=1 t=2.3e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=2 t=1.1e-03 per=5.1e+01 cost=3.5e+03 flops=3.2e+06
 renorm_tot[gemm] counter=2 i=3 t=2.2e-04 per=1.0e+01 cost=3.3e+03 flops=1.5e+07
 renorm_tot[gemm] counter=2 i=4 t=2.4e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=5 t=2.3e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=6 t=2.5e-04 per=1.2e+01 cost=1.2e+04 flops=5.0e+07
 renorm_tot[gemm] counter=2 total t=1.6e-03 per=7.3e+01 cost=1.9e+04 flops=1.2e+07
 renorm_tot[red] counter=2 t=4.0e-04 per=1.9e+01 cost=8.8e+03 flops=2.2e+07
qops.to_cpu: size(tot)=840:6.4e-03MB:6.3e-06GB t[to_cpu]=1.4e-05S speed=4.6e-01GB/S
check ||H-H.dagger||=2.706e-15 coord=(17,0) rank=0
ctns::oper_ab2pq coord=(17,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0116 S rank=0 -----
##### local oper_env: 2.176e-02 S #####
 T(local oper_env: fetch) = 8.758e-03 S  per = 40.3  per(accum) = 40.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 40.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 40.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 40.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 40.3
 T(local oper_env: renrm) = 1.181e-02 S  per = 54.3  per(accum) = 94.6
 T(local oper_env: save ) = 1.186e-03 S  per = 5.45  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.181e-02 S  T(sum) = 1.181e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.970e-06 S  per = 0.0675  per(accum) = 0.0675
 T(local oper_env: qops init                    ) = 5.551e-04 S  per =  4.7  per(accum) = 4.77
 T(local oper_env: symbolic_formulae_renorm     ) = 3.292e-03 S  per = 27.9  per(accum) = 32.6
 T(local oper_env: allocate qops on gpu         ) = 2.898e-05 S  per = 0.245  per(accum) = 32.9
 T(local oper_env: site memcpy cpu2gpu          ) = 2.872e-05 S  per = 0.243  per(accum) = 33.1
 T(local oper_env: rintermediate init           ) = 2.412e-04 S  per = 2.04  per(accum) = 35.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.365e-03 S  per =   20  per(accum) = 55.2
 T(local oper_env: rmmtasks init                ) = 4.159e-03 S  per = 35.2  per(accum) = 90.4
 T(local oper_env: qops memset on cpu           ) = 3.700e-08 S  per = 0.000313  per(accum) = 90.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 8.870e-04 S  per = 7.51  per(accum) = 97.9
 T(local oper_env: reduction of opS & opH [nccl]) = 8.290e-07 S  per = 0.00702  per(accum) = 97.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.920e-05 S  per = 0.163  per(accum) = 98.1
 T(local oper_env: deallocate cpu and gpu memory) = 1.537e-05 S  per = 0.13  per(accum) = 98.2
 T(local oper_env: reduction of opS & opH [comm]) = 2.121e-05 S  per = 0.18  per(accum) = 98.4
 T(local oper_env: conversion from opAB to opPQ ) = 3.556e-06 S  per = 0.0301  per(accum) = 98.4
 T(local oper_env: after oper_renorm            ) = 1.881e-04 S  per = 1.59  per(accum) = 100
##### sweep oper_env: 4.736e-02 S #####
 T(sweep oper_env: fetch) = 2.641e-02 S  per = 55.8  per(accum) = 55.8
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 55.8
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 55.8
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 55.8
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 55.8
 T(sweep oper_env: renrm) = 1.769e-02 S  per = 37.4  per(accum) = 93.1
 T(sweep oper_env: save ) = 3.263e-03 S  per = 6.89  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.465e+09 S  per = -3.465e+31
 T(sweep oper_env: preprocess                  ) = -3.465e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.769e-02 S  T(sum) = 1.769e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.261e-05 S  per = 0.128  per(accum) = 0.128
 T(sweep oper_env: qops init                    ) = 9.878e-04 S  per = 5.58  per(accum) = 5.71
 T(sweep oper_env: symbolic_formulae_renorm     ) = 4.866e-03 S  per = 27.5  per(accum) = 33.2
 T(sweep oper_env: allocate qops on gpu         ) = 8.212e-05 S  per = 0.464  per(accum) = 33.7
 T(sweep oper_env: site memcpy cpu2gpu          ) = 7.066e-05 S  per = 0.399  per(accum) = 34.1
 T(sweep oper_env: rintermediate init           ) = 2.720e-04 S  per = 1.54  per(accum) = 35.6
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.437e-03 S  per = 19.4  per(accum) = 55
 T(sweep oper_env: rmmtasks init                ) = 5.177e-03 S  per = 29.3  per(accum) = 84.3
 T(sweep oper_env: qops memset on cpu           ) = 6.900e-08 S  per = 0.00039  per(accum) = 84.3
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.343e-03 S  per = 13.2  per(accum) = 97.5
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.848e-06 S  per = 0.0104  per(accum) = 97.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 4.510e-05 S  per = 0.255  per(accum) = 97.8
 T(sweep oper_env: deallocate cpu and gpu memory) = 3.450e-05 S  per = 0.195  per(accum) = 98
 T(sweep oper_env: reduction of opS & opH [comm]) = 4.246e-05 S  per = 0.24  per(accum) = 98.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 7.450e-06 S  per = 0.0421  per(accum) = 98.3
 T(sweep oper_env: after oper_renorm            ) = 3.022e-04 S  per = 1.71  per(accum) = 100

idx=3 coord=(16,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHAB nops=C:6 S:34 H:1 A:15 B:21 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=840:0.00641MB:6.26e-06GB
ctns::oper_renorm coord=(16,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:8 S:32 H:1 A:28 B:36 
        dim(bra,ket)=24,24 size(op)=104:0.000793MB size(tot)=5708:0.0435MB:4.25e-05GB
CPUmem: VM:2.003e+01GB RSS:1.885e+00GB  Timing: User:6.636e+01S Sys:1.413e+00S Total:6.778e+01S
----- TIMING FOR symbolic_formulae_renorm with size=105 : 4.646e-03 S -----
rank=0 GPUmem(GB): used=6.62e-05 (oper)=6.62e-05
rank=0 GPUmem(GB): used=6.72e-05 (oper,site)(GB)=6.62e-05,9.76e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=327
 no. of coefficients=1890:0.0144MB:1.41e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.228e-04 S -----
rank=0 GPUmem(GB): used=8.12e-05 (oper,site,rinter)=6.62e-05,9.76e-07,1.41e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00371 S size(rtasks)=105 size(Rlst2)=49 T(Rmu/Rlist)=0.00136,0.00235 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00429 S size(rtasks)=105 size(Rlst)=1966 -----
rank=0 GPUmem(GB): used=8.12e-05 (oper,site,rinter,batch)=6.62e-05,9.76e-07,1.41e-05,0.0012 blksize=36 blksize0=9 batchsize=1966
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000185,0.000962,0.000319
--- TIMING FOR renorm : t_inter=1.8e-04 t_gemm=9.6e-04 t_reduction=3.2e-04 tot=1.5e-03 ---
 renorm[inter] counter=3 t=1.8e-04 per=1.3e+01 cost=7.5e+04 flops=4.1e+08
 renorm[gemm] counter=3 i=0 t=1.5e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=1 t=1.2e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=2 t=2.5e-04 per=1.7e+01 cost=3.2e+04 flops=1.3e+08
 renorm[gemm] counter=3 i=3 t=2.9e-04 per=2.0e+01 cost=3.8e+04 flops=1.3e+08
 renorm[gemm] counter=3 i=4 t=1.2e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=5 t=1.2e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=6 t=4.1e-04 per=2.8e+01 cost=1.4e+05 flops=3.4e+08
 renorm[gemm] counter=3 total t=9.6e-04 per=6.6e+01 cost=2.1e+05 flops=2.2e+08
 renorm[red] counter=3 t=3.2e-04 per=2.2e+01 cost=6.6e+04 flops=2.1e+08
--- TIMING FOR renorm_tot : t_inter=3.5e-04 t_gemm=2.5e-03 t_reduction=7.2e-04 tot=3.6e-03 ---
 renorm_tot[inter] counter=3 t=3.5e-04 per=9.8e+00 cost=8.1e+04 flops=2.3e+08
 renorm_tot[gemm] counter=3 i=0 t=6.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=1 t=3.5e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=2 t=1.3e-03 per=3.7e+01 cost=3.6e+04 flops=2.7e+07
 renorm_tot[gemm] counter=3 i=3 t=5.1e-04 per=1.4e+01 cost=4.1e+04 flops=8.0e+07
 renorm_tot[gemm] counter=3 i=4 t=3.6e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=5 t=3.5e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=6 t=6.6e-04 per=1.8e+01 cost=1.5e+05 flops=2.3e+08
 renorm_tot[gemm] counter=3 total t=2.5e-03 per=7.0e+01 cost=2.3e+05 flops=9.1e+07
 renorm_tot[red] counter=3 t=7.2e-04 per=2.0e+01 cost=7.5e+04 flops=1.0e+08
qops.to_cpu: size(tot)=5708:4.4e-02MB:4.3e-05GB t[to_cpu]=2.1e-05S speed=2.0e+00GB/S
check ||H-H.dagger||=1.104e-14 coord=(16,0) rank=0
ctns::oper_ab2pq coord=(16,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0241 S rank=0 -----
##### local oper_env: 3.440e-02 S #####
 T(local oper_env: fetch) = 8.741e-03 S  per = 25.4  per(accum) = 25.4
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 25.4
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 25.4
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 25.4
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 25.4
 T(local oper_env: renrm) = 2.435e-02 S  per = 70.8  per(accum) = 96.2
 T(local oper_env: save ) = 1.318e-03 S  per = 3.83  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.435e-02 S  T(sum) = 2.435e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.036e-06 S  per = 0.033  per(accum) = 0.033
 T(local oper_env: qops init                    ) = 9.091e-04 S  per = 3.73  per(accum) = 3.77
 T(local oper_env: symbolic_formulae_renorm     ) = 4.656e-03 S  per = 19.1  per(accum) = 22.9
 T(local oper_env: allocate qops on gpu         ) = 2.474e-05 S  per = 0.102  per(accum) = 23
 T(local oper_env: site memcpy cpu2gpu          ) = 2.235e-05 S  per = 0.0918  per(accum) = 23.1
 T(local oper_env: rintermediate init           ) = 4.317e-04 S  per = 1.77  per(accum) = 24.9
 T(local oper_env: preprocess_formulae_Rlist2   ) = 4.357e-03 S  per = 17.9  per(accum) = 42.8
 T(local oper_env: rmmtasks init                ) = 1.205e-02 S  per = 49.5  per(accum) = 92.3
 T(local oper_env: qops memset on cpu           ) = 3.200e-08 S  per = 0.000131  per(accum) = 92.3
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.559e-03 S  per = 6.41  per(accum) = 98.7
 T(local oper_env: reduction of opS & opH [nccl]) = 1.086e-06 S  per = 0.00446  per(accum) = 98.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.706e-05 S  per = 0.111  per(accum) = 98.8
 T(local oper_env: deallocate cpu and gpu memory) = 1.954e-05 S  per = 0.0803  per(accum) = 98.9
 T(local oper_env: reduction of opS & opH [comm]) = 2.567e-05 S  per = 0.105  per(accum) = 99
 T(local oper_env: conversion from opAB to opPQ ) = 3.500e-06 S  per = 0.0144  per(accum) = 99
 T(local oper_env: after oper_renorm            ) = 2.504e-04 S  per = 1.03  per(accum) = 100
##### sweep oper_env: 8.177e-02 S #####
 T(sweep oper_env: fetch) = 3.515e-02 S  per =   43  per(accum) = 43
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 43
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 43
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 43
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 43
 T(sweep oper_env: renrm) = 4.204e-02 S  per = 51.4  per(accum) = 94.4
 T(sweep oper_env: save ) = 4.581e-03 S  per =  5.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -5.197e+09 S  per = -5.197e+31
 T(sweep oper_env: preprocess                  ) = -5.197e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.204e-02 S  T(sum) = 4.204e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 3.065e-05 S  per = 0.0729  per(accum) = 0.0729
 T(sweep oper_env: qops init                    ) = 1.897e-03 S  per = 4.51  per(accum) = 4.59
 T(sweep oper_env: symbolic_formulae_renorm     ) = 9.522e-03 S  per = 22.7  per(accum) = 27.2
 T(sweep oper_env: allocate qops on gpu         ) = 1.069e-04 S  per = 0.254  per(accum) = 27.5
 T(sweep oper_env: site memcpy cpu2gpu          ) = 9.301e-05 S  per = 0.221  per(accum) = 27.7
 T(sweep oper_env: rintermediate init           ) = 7.037e-04 S  per = 1.67  per(accum) = 29.4
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 7.794e-03 S  per = 18.5  per(accum) = 47.9
 T(sweep oper_env: rmmtasks init                ) = 1.723e-02 S  per =   41  per(accum) = 88.9
 T(sweep oper_env: qops memset on cpu           ) = 1.010e-07 S  per = 0.00024  per(accum) = 88.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.903e-03 S  per = 9.28  per(accum) = 98.2
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.934e-06 S  per = 0.00698  per(accum) = 98.2
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 7.217e-05 S  per = 0.172  per(accum) = 98.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.404e-05 S  per = 0.129  per(accum) = 98.5
 T(sweep oper_env: reduction of opS & opH [comm]) = 6.813e-05 S  per = 0.162  per(accum) = 98.7
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.095e-05 S  per = 0.026  per(accum) = 98.7
 T(sweep oper_env: after oper_renorm            ) = 5.525e-04 S  per = 1.31  per(accum) = 100

idx=4 coord=(15,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHAB nops=C:8 S:32 H:1 A:28 B:36 
        dim(bra,ket)=24,24 size(op)=104:0.000793MB size(tot)=5708:0.0435MB:4.25e-05GB
ctns::oper_renorm coord=(15,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:10 S:30 H:1 A:45 B:55 
        dim(bra,ket)=42,42 size(op)=270:0.00206MB size(tot)=21070:0.161MB:0.000157GB
CPUmem: VM:2.003e+01GB RSS:1.887e+00GB  Timing: User:6.640e+01S Sys:1.413e+00S Total:6.781e+01S
----- TIMING FOR symbolic_formulae_renorm with size=141 : 5.833e-03 S -----
rank=0 GPUmem(GB): used=0.000217 (oper)=0.000217
rank=0 GPUmem(GB): used=0.00022 (oper,site)(GB)=0.000217,3.46e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=307
 no. of coefficients=2932:0.0224MB:2.18e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.150e-04 S -----
rank=0 GPUmem(GB): used=0.000242 (oper,site,rinter)=0.000217,3.46e-06,2.18e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00489 S size(rtasks)=141 size(Rlst2)=64 T(Rmu/Rlist)=0.00137,0.00351 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00518 S size(rtasks)=141 size(Rlst)=3094 -----
rank=0 GPUmem(GB): used=0.000242 (oper,site,rinter,batch)=0.000217,3.46e-06,2.18e-05,0.0038 blksize=64 blksize0=36 batchsize=3094
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000261,0.00162,0.000364
--- TIMING FOR renorm : t_inter=2.6e-04 t_gemm=1.6e-03 t_reduction=3.6e-04 tot=2.2e-03 ---
 renorm[inter] counter=4 t=2.6e-04 per=1.2e+01 cost=6.3e+05 flops=2.4e+09
 renorm[gemm] counter=4 i=0 t=1.4e-06 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=1 t=1.2e-06 per=5.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=2 t=4.1e-04 per=1.8e+01 cost=2.8e+05 flops=6.8e+08
 renorm[gemm] counter=4 i=3 t=5.9e-04 per=2.6e+01 cost=3.6e+05 flops=6.1e+08
 renorm[gemm] counter=4 i=4 t=1.3e-06 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=5 t=1.2e-06 per=5.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=6 t=6.2e-04 per=2.8e+01 cost=9.6e+05 flops=1.5e+09
 renorm[gemm] counter=4 total t=1.6e-03 per=7.2e+01 cost=1.6e+06 flops=9.8e+08
 renorm[red] counter=4 t=3.6e-04 per=1.6e+01 cost=2.2e+05 flops=6.2e+08
--- TIMING FOR renorm_tot : t_inter=6.2e-04 t_gemm=4.2e-03 t_reduction=1.1e-03 tot=5.9e-03 ---
 renorm_tot[inter] counter=4 t=6.2e-04 per=1.1e+01 cost=7.1e+05 flops=1.1e+09
 renorm_tot[gemm] counter=4 i=0 t=7.6e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=1 t=4.8e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=2 t=1.7e-03 per=3.0e+01 cost=3.2e+05 flops=1.8e+08
 renorm_tot[gemm] counter=4 i=3 t=1.1e-03 per=1.9e+01 cost=4.0e+05 flops=3.6e+08
 renorm_tot[gemm] counter=4 i=4 t=4.9e-06 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=5 t=4.7e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=6 t=1.3e-03 per=2.2e+01 cost=1.1e+06 flops=8.7e+08
 renorm_tot[gemm] counter=4 total t=4.2e-03 per=7.1e+01 cost=1.8e+06 flops=4.4e+08
 renorm_tot[red] counter=4 t=1.1e-03 per=1.9e+01 cost=3.0e+05 flops=2.8e+08
qops.to_cpu: size(tot)=21070:1.6e-01MB:1.6e-04GB t[to_cpu]=4.6e-05S speed=3.4e+00GB/S
check ||H-H.dagger||=2.819e-14 coord=(15,0) rank=0
ctns::oper_ab2pq coord=(15,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0343 S rank=0 -----
##### local oper_env: 4.481e-02 S #####
 T(local oper_env: fetch) = 8.751e-03 S  per = 19.5  per(accum) = 19.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(local oper_env: renrm) = 3.466e-02 S  per = 77.4  per(accum) = 96.9
 T(local oper_env: save ) = 1.395e-03 S  per = 3.11  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.466e-02 S  T(sum) = 3.466e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.942e-06 S  per = 0.0229  per(accum) = 0.0229
 T(local oper_env: qops init                    ) = 1.337e-03 S  per = 3.86  per(accum) = 3.88
 T(local oper_env: symbolic_formulae_renorm     ) = 5.844e-03 S  per = 16.9  per(accum) = 20.7
 T(local oper_env: allocate qops on gpu         ) = 2.462e-05 S  per = 0.071  per(accum) = 20.8
 T(local oper_env: site memcpy cpu2gpu          ) = 2.112e-05 S  per = 0.0609  per(accum) = 20.9
 T(local oper_env: rintermediate init           ) = 4.240e-04 S  per = 1.22  per(accum) = 22.1
 T(local oper_env: preprocess_formulae_Rlist2   ) = 5.274e-03 S  per = 15.2  per(accum) = 37.3
 T(local oper_env: rmmtasks init                ) = 1.886e-02 S  per = 54.4  per(accum) = 91.7
 T(local oper_env: qops memset on cpu           ) = 3.100e-08 S  per = 8.94e-05  per(accum) = 91.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.341e-03 S  per = 6.75  per(accum) = 98.5
 T(local oper_env: reduction of opS & opH [nccl]) = 9.320e-07 S  per = 0.00269  per(accum) = 98.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 5.264e-05 S  per = 0.152  per(accum) = 98.6
 T(local oper_env: deallocate cpu and gpu memory) = 1.205e-04 S  per = 0.348  per(accum) = 99
 T(local oper_env: reduction of opS & opH [comm]) = 3.480e-05 S  per =  0.1  per(accum) = 99.1
 T(local oper_env: conversion from opAB to opPQ ) = 3.633e-06 S  per = 0.0105  per(accum) = 99.1
 T(local oper_env: after oper_renorm            ) = 3.166e-04 S  per = 0.914  per(accum) = 100
##### sweep oper_env: 1.266e-01 S #####
 T(sweep oper_env: fetch) = 4.390e-02 S  per = 34.7  per(accum) = 34.7
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 34.7
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 34.7
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 34.7
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 34.7
 T(sweep oper_env: renrm) = 7.670e-02 S  per = 60.6  per(accum) = 95.3
 T(sweep oper_env: save ) = 5.976e-03 S  per = 4.72  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -6.930e+09 S  per = -6.930e+31
 T(sweep oper_env: preprocess                  ) = -6.930e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.670e-02 S  T(sum) = 7.670e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 3.859e-05 S  per = 0.0503  per(accum) = 0.0503
 T(sweep oper_env: qops init                    ) = 3.234e-03 S  per = 4.22  per(accum) = 4.27
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.537e-02 S  per =   20  per(accum) = 24.3
 T(sweep oper_env: allocate qops on gpu         ) = 1.315e-04 S  per = 0.171  per(accum) = 24.5
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.141e-04 S  per = 0.149  per(accum) = 24.6
 T(sweep oper_env: rintermediate init           ) = 1.128e-03 S  per = 1.47  per(accum) = 26.1
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.307e-02 S  per =   17  per(accum) = 43.1
 T(sweep oper_env: rmmtasks init                ) = 3.608e-02 S  per =   47  per(accum) = 90.2
 T(sweep oper_env: qops memset on cpu           ) = 1.320e-07 S  per = 0.000172  per(accum) = 90.2
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.244e-03 S  per = 8.14  per(accum) = 98.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.866e-06 S  per = 0.00504  per(accum) = 98.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.248e-04 S  per = 0.163  per(accum) = 98.5
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.745e-04 S  per = 0.228  per(accum) = 98.7
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.029e-04 S  per = 0.134  per(accum) = 98.8
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.458e-05 S  per = 0.019  per(accum) = 98.9
 T(sweep oper_env: after oper_renorm            ) = 8.692e-04 S  per = 1.13  per(accum) = 100

idx=5 coord=(14,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHAB nops=C:10 S:30 H:1 A:45 B:55 
        dim(bra,ket)=42,42 size(op)=270:0.00206MB size(tot)=21070:0.161MB:0.000157GB
ctns::oper_renorm coord=(14,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:12 S:28 H:1 A:66 B:78 
        dim(bra,ket)=58,58 size(op)=472:0.0036MB size(tot)=49386:0.377MB:0.000368GB
CPUmem: VM:2.003e+01GB RSS:1.887e+00GB  Timing: User:6.644e+01S Sys:1.413e+00S Total:6.786e+01S
----- TIMING FOR symbolic_formulae_renorm with size=185 : 7.023e-03 S -----
rank=0 GPUmem(GB): used=0.000542 (oper)=0.000542
rank=0 GPUmem(GB): used=0.00055 (oper,site)(GB)=0.000542,7.61e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=287
 no. of coefficients=4090:0.0312MB:3.05e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.066e-04 S -----
rank=0 GPUmem(GB): used=0.00058 (oper,site,rinter)=0.000542,7.61e-06,3.05e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00557 S size(rtasks)=185 size(Rlst2)=81 T(Rmu/Rlist)=0.00139,0.00418 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00631 S size(rtasks)=185 size(Rlst)=3755 -----
rank=0 GPUmem(GB): used=0.00058 (oper,site,rinter,batch)=0.000542,7.61e-06,3.05e-05,0.00859 blksize=121 blksize0=64 batchsize=3755
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000256,0.00179,0.000425
--- TIMING FOR renorm : t_inter=2.6e-04 t_gemm=1.8e-03 t_reduction=4.2e-04 tot=2.5e-03 ---
 renorm[inter] counter=5 t=2.6e-04 per=1.0e+01 cost=2.2e+06 flops=8.8e+09
 renorm[gemm] counter=5 i=0 t=1.5e-06 per=5.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=1 t=1.3e-06 per=5.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=2 t=3.8e-04 per=1.5e+01 cost=9.2e+05 flops=2.4e+09
 renorm[gemm] counter=5 i=3 t=6.1e-04 per=2.5e+01 cost=1.4e+06 flops=2.3e+09
 renorm[gemm] counter=5 i=4 t=1.3e-06 per=5.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=5 t=1.2e-06 per=5.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=6 t=7.9e-04 per=3.2e+01 cost=3.1e+06 flops=3.9e+09
 renorm[gemm] counter=5 total t=1.8e-03 per=7.2e+01 cost=5.4e+06 flops=3.0e+09
 renorm[red] counter=5 t=4.2e-04 per=1.7e+01 cost=4.6e+05 flops=1.1e+09
--- TIMING FOR renorm_tot : t_inter=8.7e-04 t_gemm=5.9e-03 t_reduction=1.5e-03 tot=8.3e-03 ---
 renorm_tot[inter] counter=5 t=8.7e-04 per=1.0e+01 cost=3.0e+06 flops=3.4e+09
 renorm_tot[gemm] counter=5 i=0 t=9.1e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=1 t=6.0e-06 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=2 t=2.1e-03 per=2.6e+01 cost=1.2e+06 flops=5.8e+08
 renorm_tot[gemm] counter=5 i=3 t=1.7e-03 per=2.1e+01 cost=1.8e+06 flops=1.1e+09
 renorm_tot[gemm] counter=5 i=4 t=6.2e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=5 t=5.9e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=6 t=2.1e-03 per=2.5e+01 cost=4.2e+06 flops=2.0e+09
 renorm_tot[gemm] counter=5 total t=5.9e-03 per=7.1e+01 cost=7.2e+06 flops=1.2e+09
 renorm_tot[red] counter=5 t=1.5e-03 per=1.8e+01 cost=7.6e+05 flops=5.0e+08
qops.to_cpu: size(tot)=49386:3.8e-01MB:3.7e-04GB t[to_cpu]=1.0e-04S speed=3.7e+00GB/S
check ||H-H.dagger||=3.332e-14 coord=(14,0) rank=0
ctns::oper_ab2pq coord=(14,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0412 S rank=0 -----
##### local oper_env: 5.179e-02 S #####
 T(local oper_env: fetch) = 8.747e-03 S  per = 16.9  per(accum) = 16.9
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.9
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.9
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.9
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.9
 T(local oper_env: renrm) = 4.160e-02 S  per = 80.3  per(accum) = 97.2
 T(local oper_env: save ) = 1.442e-03 S  per = 2.78  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.160e-02 S  T(sum) = 4.160e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.146e-06 S  per = 0.0196  per(accum) = 0.0196
 T(local oper_env: qops init                    ) = 1.953e-03 S  per =  4.7  per(accum) = 4.71
 T(local oper_env: symbolic_formulae_renorm     ) = 7.035e-03 S  per = 16.9  per(accum) = 21.6
 T(local oper_env: allocate qops on gpu         ) = 2.519e-05 S  per = 0.0606  per(accum) = 21.7
 T(local oper_env: site memcpy cpu2gpu          ) = 1.881e-05 S  per = 0.0452  per(accum) = 21.7
 T(local oper_env: rintermediate init           ) = 4.159e-04 S  per =    1  per(accum) = 22.7
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.430e-03 S  per = 15.5  per(accum) = 38.2
 T(local oper_env: rmmtasks init                ) = 2.254e-02 S  per = 54.2  per(accum) = 92.4
 T(local oper_env: qops memset on cpu           ) = 4.800e-08 S  per = 0.000115  per(accum) = 92.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.564e-03 S  per = 6.16  per(accum) = 98.5
 T(local oper_env: reduction of opS & opH [nccl]) = 9.820e-07 S  per = 0.00236  per(accum) = 98.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.066e-04 S  per = 0.256  per(accum) = 98.8
 T(local oper_env: deallocate cpu and gpu memory) = 1.002e-04 S  per = 0.241  per(accum) = 99
 T(local oper_env: reduction of opS & opH [comm]) = 4.046e-05 S  per = 0.0973  per(accum) = 99.1
 T(local oper_env: conversion from opAB to opPQ ) = 3.791e-06 S  per = 0.00911  per(accum) = 99.1
 T(local oper_env: after oper_renorm            ) = 3.572e-04 S  per = 0.859  per(accum) = 100
##### sweep oper_env: 1.784e-01 S #####
 T(sweep oper_env: fetch) = 5.265e-02 S  per = 29.5  per(accum) = 29.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 29.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 29.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 29.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 29.5
 T(sweep oper_env: renrm) = 1.183e-01 S  per = 66.3  per(accum) = 95.8
 T(sweep oper_env: save ) = 7.418e-03 S  per = 4.16  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -8.662e+09 S  per = -8.662e+31
 T(sweep oper_env: preprocess                  ) = -8.662e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.183e-01 S  T(sum) = 1.183e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 4.673e-05 S  per = 0.0395  per(accum) = 0.0395
 T(sweep oper_env: qops init                    ) = 5.188e-03 S  per = 4.39  per(accum) = 4.42
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.240e-02 S  per = 18.9  per(accum) = 23.4
 T(sweep oper_env: allocate qops on gpu         ) = 1.567e-04 S  per = 0.132  per(accum) = 23.5
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.329e-04 S  per = 0.112  per(accum) = 23.6
 T(sweep oper_env: rintermediate init           ) = 1.544e-03 S  per =  1.3  per(accum) = 24.9
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.950e-02 S  per = 16.5  per(accum) = 41.4
 T(sweep oper_env: rmmtasks init                ) = 5.863e-02 S  per = 49.6  per(accum) = 90.9
 T(sweep oper_env: qops memset on cpu           ) = 1.800e-07 S  per = 0.000152  per(accum) = 90.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 8.808e-03 S  per = 7.45  per(accum) = 98.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.848e-06 S  per = 0.0041  per(accum) = 98.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.314e-04 S  per = 0.196  per(accum) = 98.6
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.747e-04 S  per = 0.232  per(accum) = 98.8
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.434e-04 S  per = 0.121  per(accum) = 98.9
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.837e-05 S  per = 0.0155  per(accum) = 99
 T(sweep oper_env: after oper_renorm            ) = 1.226e-03 S  per = 1.04  per(accum) = 100

idx=6 coord=(13,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHAB nops=C:12 S:28 H:1 A:66 B:78 
        dim(bra,ket)=58,58 size(op)=472:0.0036MB size(tot)=49386:0.377MB:0.000368GB
ctns::oper_renorm coord=(13,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:14 S:26 H:1 A:91 B:105 
        dim(bra,ket)=68,68 size(op)=652:0.00497MB size(tot)=87673:0.669MB:0.000653GB
CPUmem: VM:2.003e+01GB RSS:1.889e+00GB  Timing: User:6.650e+01S Sys:1.414e+00S Total:6.791e+01S
----- TIMING FOR symbolic_formulae_renorm with size=237 : 8.438e-03 S -----
rank=0 GPUmem(GB): used=0.00104 (oper)=0.00104
rank=0 GPUmem(GB): used=0.00105 (oper,site)(GB)=0.00104,1.11e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=267
 no. of coefficients=5310:0.0405MB:3.96e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.996e-04 S -----
rank=0 GPUmem(GB): used=0.00109 (oper,site,rinter)=0.00104,1.11e-05,3.96e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00617 S size(rtasks)=237 size(Rlst2)=81 T(Rmu/Rlist)=0.00145,0.00472 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00657 S size(rtasks)=237 size(Rlst)=4374 -----
rank=0 GPUmem(GB): used=0.00109 (oper,site,rinter,batch)=0.00104,1.11e-05,3.96e-05,0.0168 blksize=196 blksize0=121 batchsize=4374
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000281,0.00316,0.000601
--- TIMING FOR renorm : t_inter=2.8e-04 t_gemm=3.2e-03 t_reduction=6.0e-04 tot=4.0e-03 ---
 renorm[inter] counter=6 t=2.8e-04 per=6.9e+00 cost=4.6e+06 flops=1.6e+10
 renorm[gemm] counter=6 i=0 t=1.5e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=1 t=1.2e-06 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=2 t=6.5e-04 per=1.6e+01 cost=1.6e+06 flops=2.5e+09
 renorm[gemm] counter=6 i=3 t=1.1e-03 per=2.8e+01 cost=3.1e+06 flops=2.7e+09
 renorm[gemm] counter=6 i=4 t=1.3e-06 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=5 t=1.1e-06 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=6 t=1.4e-03 per=3.4e+01 cost=5.7e+06 flops=4.2e+09
 renorm[gemm] counter=6 total t=3.2e-03 per=7.8e+01 cost=1.0e+07 flops=3.3e+09
 renorm[red] counter=6 t=6.0e-04 per=1.5e+01 cost=6.8e+05 flops=1.1e+09
--- TIMING FOR renorm_tot : t_inter=1.2e-03 t_gemm=9.1e-03 t_reduction=2.1e-03 tot=1.2e-02 ---
 renorm_tot[inter] counter=6 t=1.2e-03 per=9.3e+00 cost=7.5e+06 flops=6.5e+09
 renorm_tot[gemm] counter=6 i=0 t=1.1e-05 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=1 t=7.2e-06 per=5.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=2 t=2.8e-03 per=2.2e+01 cost=2.9e+06 flops=1.0e+09
 renorm_tot[gemm] counter=6 i=3 t=2.9e-03 per=2.3e+01 cost=4.9e+06 flops=1.7e+09
 renorm_tot[gemm] counter=6 i=4 t=7.5e-06 per=6.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=5 t=7.1e-06 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=6 t=3.4e-03 per=2.8e+01 cost=9.9e+06 flops=2.9e+09
 renorm_tot[gemm] counter=6 total t=9.1e-03 per=7.4e+01 cost=1.8e+07 flops=1.9e+09
 renorm_tot[red] counter=6 t=2.1e-03 per=1.7e+01 cost=1.4e+06 flops=6.8e+08
qops.to_cpu: size(tot)=87673:6.7e-01MB:6.5e-04GB t[to_cpu]=1.5e-04S speed=4.2e+00GB/S
check ||H-H.dagger||=4.471e-14 coord=(13,0) rank=0
ctns::oper_ab2pq coord=(13,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0467 S rank=0 -----
##### local oper_env: 5.747e-02 S #####
 T(local oper_env: fetch) = 8.755e-03 S  per = 15.2  per(accum) = 15.2
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15.2
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15.2
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15.2
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15.2
 T(local oper_env: renrm) = 4.709e-02 S  per = 81.9  per(accum) = 97.2
 T(local oper_env: save ) = 1.621e-03 S  per = 2.82  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.709e-02 S  T(sum) = 4.709e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.016e-06 S  per = 0.017  per(accum) = 0.017
 T(local oper_env: qops init                    ) = 2.474e-03 S  per = 5.25  per(accum) = 5.27
 T(local oper_env: symbolic_formulae_renorm     ) = 8.452e-03 S  per = 17.9  per(accum) = 23.2
 T(local oper_env: allocate qops on gpu         ) = 2.742e-05 S  per = 0.0582  per(accum) = 23.3
 T(local oper_env: site memcpy cpu2gpu          ) = 1.984e-05 S  per = 0.0421  per(accum) = 23.3
 T(local oper_env: rintermediate init           ) = 4.091e-04 S  per = 0.869  per(accum) = 24.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.706e-03 S  per = 14.2  per(accum) = 38.4
 T(local oper_env: rmmtasks init                ) = 2.412e-02 S  per = 51.2  per(accum) = 89.6
 T(local oper_env: qops memset on cpu           ) = 4.800e-08 S  per = 0.000102  per(accum) = 89.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.140e-03 S  per = 8.79  per(accum) = 98.4
 T(local oper_env: reduction of opS & opH [nccl]) = 1.036e-06 S  per = 0.0022  per(accum) = 98.4
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.614e-04 S  per = 0.343  per(accum) = 98.8
 T(local oper_env: deallocate cpu and gpu memory) = 1.168e-04 S  per = 0.248  per(accum) = 99
 T(local oper_env: reduction of opS & opH [comm]) = 4.521e-05 S  per = 0.096  per(accum) = 99.1
 T(local oper_env: conversion from opAB to opPQ ) = 3.783e-06 S  per = 0.00803  per(accum) = 99.1
 T(local oper_env: after oper_renorm            ) = 4.063e-04 S  per = 0.863  per(accum) = 100
##### sweep oper_env: 2.358e-01 S #####
 T(sweep oper_env: fetch) = 6.140e-02 S  per =   26  per(accum) = 26
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 26
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 26
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 26
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 26
 T(sweep oper_env: renrm) = 1.654e-01 S  per = 70.1  per(accum) = 96.2
 T(sweep oper_env: save ) = 9.039e-03 S  per = 3.83  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.039e+10 S  per = -1.039e+32
 T(sweep oper_env: preprocess                  ) = -1.039e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.654e-01 S  T(sum) = 1.654e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 5.475e-05 S  per = 0.0331  per(accum) = 0.0331
 T(sweep oper_env: qops init                    ) = 7.662e-03 S  per = 4.63  per(accum) = 4.67
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.085e-02 S  per = 18.7  per(accum) = 23.3
 T(sweep oper_env: allocate qops on gpu         ) = 1.841e-04 S  per = 0.111  per(accum) = 23.4
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.528e-04 S  per = 0.0924  per(accum) = 23.5
 T(sweep oper_env: rintermediate init           ) = 1.953e-03 S  per = 1.18  per(accum) = 24.7
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.621e-02 S  per = 15.8  per(accum) = 40.5
 T(sweep oper_env: rmmtasks init                ) = 8.275e-02 S  per =   50  per(accum) = 90.6
 T(sweep oper_env: qops memset on cpu           ) = 2.280e-07 S  per = 0.000138  per(accum) = 90.6
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.295e-02 S  per = 7.83  per(accum) = 98.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.884e-06 S  per = 0.00356  per(accum) = 98.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.929e-04 S  per = 0.238  per(accum) = 98.6
 T(sweep oper_env: deallocate cpu and gpu memory) = 3.916e-04 S  per = 0.237  per(accum) = 98.9
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.886e-04 S  per = 0.114  per(accum) = 99
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.216e-05 S  per = 0.0134  per(accum) = 99
 T(sweep oper_env: after oper_renorm            ) = 1.633e-03 S  per = 0.987  per(accum) = 100

idx=7 coord=(12,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHAB nops=C:14 S:26 H:1 A:91 B:105 
        dim(bra,ket)=68,68 size(op)=652:0.00497MB size(tot)=87673:0.669MB:0.000653GB
ctns::oper_renorm coord=(12,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:16 S:24 H:1 A:120 B:136 
        dim(bra,ket)=77,77 size(op)=845:0.00645MB size(tot)=142381:1.09MB:0.00106GB
CPUmem: VM:2.003e+01GB RSS:1.889e+00GB  Timing: User:6.655e+01S Sys:1.415e+00S Total:6.797e+01S
----- TIMING FOR symbolic_formulae_renorm with size=297 : 9.828e-03 S -----
rank=0 GPUmem(GB): used=0.00173 (oper)=0.00173
rank=0 GPUmem(GB): used=0.00175 (oper,site)(GB)=0.00173,1.45e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=247
 no. of coefficients=6538:0.0499MB:4.87e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.936e-04 S -----
rank=0 GPUmem(GB): used=0.00179 (oper,site,rinter)=0.00173,1.45e-05,4.87e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00698 S size(rtasks)=297 size(Rlst2)=81 T(Rmu/Rlist)=0.00151,0.00547 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00741 S size(rtasks)=297 size(Rlst)=4918 -----
rank=0 GPUmem(GB): used=0.00179 (oper,site,rinter,batch)=0.00173,1.45e-05,4.87e-05,0.0237 blksize=225 blksize0=196 batchsize=4918
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000325,0.00268,0.000451
--- TIMING FOR renorm : t_inter=3.2e-04 t_gemm=2.7e-03 t_reduction=4.5e-04 tot=3.5e-03 ---
 renorm[inter] counter=7 t=3.2e-04 per=9.4e+00 cost=7.6e+06 flops=2.3e+10
 renorm[gemm] counter=7 i=0 t=1.4e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=1 t=1.2e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=2 t=6.7e-04 per=1.9e+01 cost=2.3e+06 flops=3.5e+09
 renorm[gemm] counter=7 i=3 t=1.1e-03 per=3.2e+01 cost=5.7e+06 flops=5.1e+09
 renorm[gemm] counter=7 i=4 t=1.2e-06 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=5 t=1.2e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=6 t=8.9e-04 per=2.6e+01 cost=9.3e+06 flops=1.0e+10
 renorm[gemm] counter=7 total t=2.7e-03 per=7.8e+01 cost=1.7e+07 flops=6.5e+09
 renorm[red] counter=7 t=4.5e-04 per=1.3e+01 cost=9.9e+05 flops=2.2e+09
--- TIMING FOR renorm_tot : t_inter=1.5e-03 t_gemm=1.2e-02 t_reduction=2.6e-03 tot=1.6e-02 ---
 renorm_tot[inter] counter=7 t=1.5e-03 per=9.3e+00 cost=1.5e+07 flops=1.0e+10
 renorm_tot[gemm] counter=7 i=0 t=1.2e-05 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=1 t=8.4e-06 per=5.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=2 t=3.4e-03 per=2.2e+01 cost=5.2e+06 flops=1.5e+09
 renorm_tot[gemm] counter=7 i=3 t=4.0e-03 per=2.5e+01 cost=1.1e+07 flops=2.7e+09
 renorm_tot[gemm] counter=7 i=4 t=8.7e-06 per=5.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=5 t=8.3e-06 per=5.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=6 t=4.3e-03 per=2.7e+01 cost=1.9e+07 flops=4.4e+09
 renorm_tot[gemm] counter=7 total t=1.2e-02 per=7.4e+01 cost=3.5e+07 flops=3.0e+09
 renorm_tot[red] counter=7 t=2.6e-03 per=1.6e+01 cost=2.4e+06 flops=9.5e+08
qops.to_cpu: size(tot)=142381:1.1e+00MB:1.1e-03GB t[to_cpu]=2.4e-04S speed=4.3e+00GB/S
check ||H-H.dagger||=5.542e-14 coord=(12,0) rank=0
ctns::oper_ab2pq coord=(12,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.053 S rank=0 -----
##### local oper_env: 6.401e-02 S #####
 T(local oper_env: fetch) = 8.744e-03 S  per = 13.7  per(accum) = 13.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 13.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 13.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 13.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 13.7
 T(local oper_env: renrm) = 5.353e-02 S  per = 83.6  per(accum) = 97.3
 T(local oper_env: save ) = 1.741e-03 S  per = 2.72  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.353e-02 S  T(sum) = 5.353e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.947e-06 S  per = 0.0148  per(accum) = 0.0148
 T(local oper_env: qops init                    ) = 3.085e-03 S  per = 5.76  per(accum) = 5.78
 T(local oper_env: symbolic_formulae_renorm     ) = 9.842e-03 S  per = 18.4  per(accum) = 24.2
 T(local oper_env: allocate qops on gpu         ) = 1.401e-04 S  per = 0.262  per(accum) = 24.4
 T(local oper_env: site memcpy cpu2gpu          ) = 2.228e-05 S  per = 0.0416  per(accum) = 24.5
 T(local oper_env: rintermediate init           ) = 4.040e-04 S  per = 0.755  per(accum) = 25.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 7.572e-03 S  per = 14.1  per(accum) = 39.4
 T(local oper_env: rmmtasks init                ) = 2.799e-02 S  per = 52.3  per(accum) = 91.7
 T(local oper_env: qops memset on cpu           ) = 2.900e-08 S  per = 5.42e-05  per(accum) = 91.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.554e-03 S  per = 6.64  per(accum) = 98.3
 T(local oper_env: reduction of opS & opH [nccl]) = 9.920e-07 S  per = 0.00185  per(accum) = 98.3
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.528e-04 S  per = 0.472  per(accum) = 98.8
 T(local oper_env: deallocate cpu and gpu memory) = 1.247e-04 S  per = 0.233  per(accum) = 99
 T(local oper_env: reduction of opS & opH [comm]) = 5.734e-05 S  per = 0.107  per(accum) = 99.1
 T(local oper_env: conversion from opAB to opPQ ) = 3.755e-06 S  per = 0.00702  per(accum) = 99.1
 T(local oper_env: after oper_renorm            ) = 4.714e-04 S  per = 0.881  per(accum) = 100
##### sweep oper_env: 2.998e-01 S #####
 T(sweep oper_env: fetch) = 7.014e-02 S  per = 23.4  per(accum) = 23.4
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 23.4
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 23.4
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 23.4
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 23.4
 T(sweep oper_env: renrm) = 2.189e-01 S  per =   73  per(accum) = 96.4
 T(sweep oper_env: save ) = 1.078e-02 S  per =  3.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.213e+10 S  per = -1.213e+32
 T(sweep oper_env: preprocess                  ) = -1.213e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.189e-01 S  T(sum) = 2.189e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 6.270e-05 S  per = 0.0286  per(accum) = 0.0286
 T(sweep oper_env: qops init                    ) = 1.075e-02 S  per = 4.91  per(accum) = 4.94
 T(sweep oper_env: symbolic_formulae_renorm     ) = 4.069e-02 S  per = 18.6  per(accum) = 23.5
 T(sweep oper_env: allocate qops on gpu         ) = 3.242e-04 S  per = 0.148  per(accum) = 23.7
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.751e-04 S  per = 0.08  per(accum) = 23.8
 T(sweep oper_env: rintermediate init           ) = 2.357e-03 S  per = 1.08  per(accum) = 24.8
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.378e-02 S  per = 15.4  per(accum) = 40.3
 T(sweep oper_env: rmmtasks init                ) = 1.107e-01 S  per = 50.6  per(accum) = 90.8
 T(sweep oper_env: qops memset on cpu           ) = 2.570e-07 S  per = 0.000117  per(accum) = 90.8
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.650e-02 S  per = 7.54  per(accum) = 98.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.876e-06 S  per = 0.00314  per(accum) = 98.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 6.457e-04 S  per = 0.295  per(accum) = 98.7
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.162e-04 S  per = 0.236  per(accum) = 98.9
 T(sweep oper_env: reduction of opS & opH [comm]) = 2.459e-04 S  per = 0.112  per(accum) = 99
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.591e-05 S  per = 0.0118  per(accum) = 99
 T(sweep oper_env: after oper_renorm            ) = 2.104e-03 S  per = 0.961  per(accum) = 100

idx=8 coord=(11,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHAB nops=C:16 S:24 H:1 A:120 B:136 
        dim(bra,ket)=77,77 size(op)=845:0.00645MB size(tot)=142381:1.09MB:0.00106GB
ctns::oper_renorm coord=(11,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:18 S:22 H:1 A:153 B:171 
        dim(bra,ket)=74,74 size(op)=818:0.00624MB size(tot)=165874:1.27MB:0.00124GB
CPUmem: VM:2.003e+01GB RSS:1.890e+00GB  Timing: User:6.661e+01S Sys:1.420e+00S Total:6.803e+01S
----- TIMING FOR symbolic_formulae_renorm with size=365 : 1.099e-02 S -----
rank=0 GPUmem(GB): used=0.00231 (oper)=0.00231
rank=0 GPUmem(GB): used=0.00233 (oper,site)(GB)=0.00231,1.59e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=227
 no. of coefficients=7720:0.0589MB:5.75e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.843e-04 S -----
rank=0 GPUmem(GB): used=0.00239 (oper,site,rinter)=0.00231,1.59e-05,5.75e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00734 S size(rtasks)=365 size(Rlst2)=81 T(Rmu/Rlist)=0.00159,0.00574 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00834 S size(rtasks)=365 size(Rlst)=5549 -----
rank=0 GPUmem(GB): used=0.00239 (oper,site,rinter,batch)=0.00231,1.59e-05,5.75e-05,0.0279 blksize=225 blksize0=225 batchsize=5549
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000269,0.00271,0.0006
--- TIMING FOR renorm : t_inter=2.7e-04 t_gemm=2.7e-03 t_reduction=6.0e-04 tot=3.6e-03 ---
 renorm[inter] counter=8 t=2.7e-04 per=7.5e+00 cost=1.1e+07 flops=4.1e+10
 renorm[gemm] counter=8 i=0 t=1.4e-06 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=1 t=1.2e-06 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=2 t=5.4e-04 per=1.5e+01 cost=2.8e+06 flops=5.2e+09
 renorm[gemm] counter=8 i=3 t=9.9e-04 per=2.8e+01 cost=8.5e+06 flops=8.5e+09
 renorm[gemm] counter=8 i=4 t=1.3e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=5 t=1.2e-06 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=6 t=1.2e-03 per=3.3e+01 cost=1.2e+07 flops=9.8e+09
 renorm[gemm] counter=8 total t=2.7e-03 per=7.6e+01 cost=2.3e+07 flops=8.4e+09
 renorm[red] counter=8 t=6.0e-04 per=1.7e+01 cost=1.1e+06 flops=1.8e+09
--- TIMING FOR renorm_tot : t_inter=1.7e-03 t_gemm=1.4e-02 t_reduction=3.2e-03 tot=1.9e-02 ---
 renorm_tot[inter] counter=8 t=1.7e-03 per=9.0e+00 cost=2.6e+07 flops=1.5e+10
 renorm_tot[gemm] counter=8 i=0 t=1.3e-05 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=1 t=9.6e-06 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=2 t=4.0e-03 per=2.1e+01 cost=7.9e+06 flops=2.0e+09
 renorm_tot[gemm] counter=8 i=3 t=5.0e-03 per=2.6e+01 cost=1.9e+07 flops=3.8e+09
 renorm_tot[gemm] counter=8 i=4 t=1.0e-05 per=5.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=5 t=9.5e-06 per=4.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=6 t=5.5e-03 per=2.8e+01 cost=3.1e+07 flops=5.6e+09
 renorm_tot[gemm] counter=8 total t=1.4e-02 per=7.5e+01 cost=5.8e+07 flops=4.0e+09
 renorm_tot[red] counter=8 t=3.2e-03 per=1.6e+01 cost=3.5e+06 flops=1.1e+09
qops.to_cpu: size(tot)=165874:1.3e+00MB:1.2e-03GB t[to_cpu]=8.2e-04S speed=1.5e+00GB/S
check ||H-H.dagger||=7.942e-14 coord=(11,0) rank=0
ctns::oper_ab2pq coord=(11,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0593 S rank=0 -----
##### local oper_env: 7.059e-02 S #####
 T(local oper_env: fetch) = 8.764e-03 S  per = 12.4  per(accum) = 12.4
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 12.4
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 12.4
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 12.4
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 12.4
 T(local oper_env: renrm) = 5.987e-02 S  per = 84.8  per(accum) = 97.2
 T(local oper_env: save ) = 1.954e-03 S  per = 2.77  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.987e-02 S  T(sum) = 5.987e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.893e-06 S  per = 0.0132  per(accum) = 0.0132
 T(local oper_env: qops init                    ) = 3.799e-03 S  per = 6.35  per(accum) = 6.36
 T(local oper_env: symbolic_formulae_renorm     ) = 1.100e-02 S  per = 18.4  per(accum) = 24.7
 T(local oper_env: allocate qops on gpu         ) = 2.556e-05 S  per = 0.0427  per(accum) = 24.8
 T(local oper_env: site memcpy cpu2gpu          ) = 3.080e-05 S  per = 0.0514  per(accum) = 24.8
 T(local oper_env: rintermediate init           ) = 3.946e-04 S  per = 0.659  per(accum) = 25.5
 T(local oper_env: preprocess_formulae_Rlist2   ) = 8.523e-03 S  per = 14.2  per(accum) = 39.7
 T(local oper_env: rmmtasks init                ) = 3.089e-02 S  per = 51.6  per(accum) = 91.3
 T(local oper_env: qops memset on cpu           ) = 4.600e-08 S  per = 7.68e-05  per(accum) = 91.3
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.673e-03 S  per = 6.13  per(accum) = 97.4
 T(local oper_env: reduction of opS & opH [nccl]) = 9.480e-07 S  per = 0.00158  per(accum) = 97.4
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.325e-04 S  per = 1.39  per(accum) = 98.8
 T(local oper_env: deallocate cpu and gpu memory) = 1.305e-04 S  per = 0.218  per(accum) = 99.1
 T(local oper_env: reduction of opS & opH [comm]) = 5.075e-05 S  per = 0.0848  per(accum) = 99.1
 T(local oper_env: conversion from opAB to opPQ ) = 3.859e-06 S  per = 0.00645  per(accum) = 99.1
 T(local oper_env: after oper_renorm            ) = 5.098e-04 S  per = 0.852  per(accum) = 100
##### sweep oper_env: 3.704e-01 S #####
 T(sweep oper_env: fetch) = 7.891e-02 S  per = 21.3  per(accum) = 21.3
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 21.3
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 21.3
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 21.3
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 21.3
 T(sweep oper_env: renrm) = 2.788e-01 S  per = 75.3  per(accum) = 96.6
 T(sweep oper_env: save ) = 1.274e-02 S  per = 3.44  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.386e+10 S  per = -1.386e+32
 T(sweep oper_env: preprocess                  ) = -1.386e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.788e-01 S  T(sum) = 2.788e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 7.059e-05 S  per = 0.0253  per(accum) = 0.0253
 T(sweep oper_env: qops init                    ) = 1.455e-02 S  per = 5.22  per(accum) = 5.24
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.170e-02 S  per = 18.5  per(accum) = 23.8
 T(sweep oper_env: allocate qops on gpu         ) = 3.497e-04 S  per = 0.125  per(accum) = 23.9
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.059e-04 S  per = 0.0738  per(accum) = 24
 T(sweep oper_env: rintermediate init           ) = 2.751e-03 S  per = 0.987  per(accum) = 25
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.230e-02 S  per = 15.2  per(accum) = 40.1
 T(sweep oper_env: rmmtasks init                ) = 1.416e-01 S  per = 50.8  per(accum) = 90.9
 T(sweep oper_env: qops memset on cpu           ) = 3.030e-07 S  per = 0.000109  per(accum) = 90.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.017e-02 S  per = 7.24  per(accum) = 98.2
 T(sweep oper_env: reduction of opS & opH [nccl]) = 7.824e-06 S  per = 0.00281  per(accum) = 98.2
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.478e-03 S  per = 0.53  per(accum) = 98.7
 T(sweep oper_env: deallocate cpu and gpu memory) = 6.467e-04 S  per = 0.232  per(accum) = 98.9
 T(sweep oper_env: reduction of opS & opH [comm]) = 2.967e-04 S  per = 0.106  per(accum) = 99.1
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.977e-05 S  per = 0.0107  per(accum) = 99.1
 T(sweep oper_env: after oper_renorm            ) = 2.614e-03 S  per = 0.938  per(accum) = 100

idx=9 coord=(10,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHAB nops=C:18 S:22 H:1 A:153 B:171 
        dim(bra,ket)=74,74 size(op)=818:0.00624MB size(tot)=165874:1.27MB:0.00124GB
ctns::oper_renorm coord=(10,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:20 S:20 H:1 A:190 B:210 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=164348:1.25MB:0.00122GB
CPUmem: VM:2.003e+01GB RSS:1.893e+00GB  Timing: User:6.668e+01S Sys:1.423e+00S Total:6.811e+01S
----- TIMING FOR symbolic_formulae_renorm with size=441 : 1.412e-02 S -----
rank=0 GPUmem(GB): used=0.00248 (oper)=0.00248
rank=0 GPUmem(GB): used=0.00249 (oper,site)(GB)=0.00248,1.52e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=441
 no. of rintermediate operators=207
 no. of coefficients=8802:0.0672MB:6.56e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.004e-04 S -----
rank=0 GPUmem(GB): used=0.00256 (oper,site,rinter)=0.00248,1.52e-05,6.56e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0101 S size(rtasks)=441 size(Rlst2)=144 T(Rmu/Rlist)=0.00169,0.00841 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0116 S size(rtasks)=441 size(Rlst)=8572 -----
rank=0 GPUmem(GB): used=0.00256 (oper,site,rinter,batch)=0.00248,1.52e-05,6.56e-05,0.0413 blksize=210 blksize0=225 batchsize=8572
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000348,0.00455,0.000829
--- TIMING FOR renorm : t_inter=3.5e-04 t_gemm=4.6e-03 t_reduction=8.3e-04 tot=5.7e-03 ---
 renorm[inter] counter=9 t=3.5e-04 per=6.1e+00 cost=1.8e+07 flops=5.3e+10
 renorm[gemm] counter=9 i=0 t=1.5e-06 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=1 t=1.2e-06 per=2.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=2 t=9.2e-04 per=1.6e+01 cost=2.7e+06 flops=3.0e+09
 renorm[gemm] counter=9 i=3 t=1.7e-03 per=3.0e+01 cost=1.1e+07 flops=6.1e+09
 renorm[gemm] counter=9 i=4 t=1.3e-06 per=2.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=5 t=1.2e-06 per=2.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=6 t=1.9e-03 per=3.3e+01 cost=1.1e+07 flops=5.6e+09
 renorm[gemm] counter=9 total t=4.6e-03 per=7.9e+01 cost=2.4e+07 flops=5.3e+09
 renorm[red] counter=9 t=8.3e-04 per=1.4e+01 cost=9.8e+05 flops=1.2e+09
--- TIMING FOR renorm_tot : t_inter=2.1e-03 t_gemm=1.9e-02 t_reduction=4.0e-03 tot=2.5e-02 ---
 renorm_tot[inter] counter=9 t=2.1e-03 per=8.3e+00 cost=4.5e+07 flops=2.1e+10
 renorm_tot[gemm] counter=9 i=0 t=1.5e-05 per=5.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=1 t=1.1e-05 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=2 t=4.9e-03 per=1.9e+01 cost=1.1e+07 flops=2.2e+09
 renorm_tot[gemm] counter=9 i=3 t=6.7e-03 per=2.7e+01 cost=3.0e+07 flops=4.4e+09
 renorm_tot[gemm] counter=9 i=4 t=1.1e-05 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=5 t=1.1e-05 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=6 t=7.4e-03 per=2.9e+01 cost=4.1e+07 flops=5.6e+09
 renorm_tot[gemm] counter=9 total t=1.9e-02 per=7.6e+01 cost=8.2e+07 flops=4.3e+09
 renorm_tot[red] counter=9 t=4.0e-03 per=1.6e+01 cost=4.5e+06 flops=1.1e+09
qops.to_cpu: size(tot)=164348:1.3e+00MB:1.2e-03GB t[to_cpu]=2.5e-04S speed=4.9e+00GB/S
check ||H-H.dagger||=4.600e-14 coord=(10,0) rank=0
ctns::oper_ab2pq coord=(10,0) superblock=cr ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 3.79 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.00725,3.42e-05,1.82,1.96,0.000955,0.000399 -----
----- TIMING FOR oper_renorm : 0.0869 S rank=0 -----
##### local oper_env: 3.895e+00 S #####
 T(local oper_env: fetch) = 8.771e-03 S  per = 0.225  per(accum) = 0.225
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 0.225
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 0.225
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 0.225
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 0.225
 T(local oper_env: renrm) = 3.882e+00 S  per = 99.7  per(accum) = 99.9
 T(local oper_env: save ) = 3.828e-03 S  per = 0.0983  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.882e+00 S  T(sum) = 3.882e+00 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.003e-06 S  per = 0.000206  per(accum) = 0.000206
 T(local oper_env: qops init                    ) = 6.514e-03 S  per = 0.168  per(accum) = 0.168
 T(local oper_env: symbolic_formulae_renorm     ) = 1.413e-02 S  per = 0.364  per(accum) = 0.532
 T(local oper_env: allocate qops on gpu         ) = 1.895e-04 S  per = 0.00488  per(accum) = 0.537
 T(local oper_env: site memcpy cpu2gpu          ) = 5.258e-05 S  per = 0.00135  per(accum) = 0.538
 T(local oper_env: rintermediate init           ) = 4.125e-04 S  per = 0.0106  per(accum) = 0.549
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.192e-02 S  per = 0.307  per(accum) = 0.856
 T(local oper_env: rmmtasks init                ) = 4.719e-02 S  per = 1.22  per(accum) = 2.07
 T(local oper_env: qops memset on cpu           ) = 6.400e-08 S  per = 1.65e-06  per(accum) = 2.07
 T(local oper_env: preprocess_renorm_batchGPU   ) = 5.831e-03 S  per = 0.15  per(accum) = 2.22
 T(local oper_env: reduction of opS & opH [nccl]) = 1.022e-06 S  per = 2.63e-05  per(accum) = 2.22
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.587e-04 S  per = 0.00666  per(accum) = 2.23
 T(local oper_env: deallocate cpu and gpu memory) = 3.471e-04 S  per = 0.00894  per(accum) = 2.24
 T(local oper_env: reduction of opS & opH [comm]) = 5.217e-05 S  per = 0.00134  per(accum) = 2.24
 T(local oper_env: conversion from opAB to opPQ ) = 3.794e+00 S  per = 97.7  per(accum) = 100
 T(local oper_env: after oper_renorm            ) = 1.324e-03 S  per = 0.0341  per(accum) = 100
##### sweep oper_env: 4.265e+00 S #####
 T(sweep oper_env: fetch) = 8.768e-02 S  per = 2.06  per(accum) = 2.06
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.06
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.06
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.06
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.06
 T(sweep oper_env: renrm) = 4.161e+00 S  per = 97.6  per(accum) = 99.6
 T(sweep oper_env: save ) = 1.656e-02 S  per = 0.388  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.559e+10 S  per = -1.559e+32
 T(sweep oper_env: preprocess                  ) = -1.559e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.161e+00 S  T(sum) = 4.161e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 7.859e-05 S  per = 0.00189  per(accum) = 0.00189
 T(sweep oper_env: qops init                    ) = 2.106e-02 S  per = 0.506  per(accum) = 0.508
 T(sweep oper_env: symbolic_formulae_renorm     ) = 6.583e-02 S  per = 1.58  per(accum) = 2.09
 T(sweep oper_env: allocate qops on gpu         ) = 5.393e-04 S  per = 0.013  per(accum) = 2.1
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.584e-04 S  per = 0.00621  per(accum) = 2.11
 T(sweep oper_env: rintermediate init           ) = 3.164e-03 S  per = 0.076  per(accum) = 2.19
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.422e-02 S  per =  1.3  per(accum) = 3.49
 T(sweep oper_env: rmmtasks init                ) = 1.888e-01 S  per = 4.54  per(accum) = 8.03
 T(sweep oper_env: qops memset on cpu           ) = 3.670e-07 S  per = 8.82e-06  per(accum) = 8.03
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.600e-02 S  per = 0.625  per(accum) = 8.65
 T(sweep oper_env: reduction of opS & opH [nccl]) = 8.846e-06 S  per = 0.000213  per(accum) = 8.65
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.737e-03 S  per = 0.0417  per(accum) = 8.69
 T(sweep oper_env: deallocate cpu and gpu memory) = 9.937e-04 S  per = 0.0239  per(accum) = 8.72
 T(sweep oper_env: reduction of opS & opH [comm]) = 3.489e-04 S  per = 0.00838  per(accum) = 8.72
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.794e+00 S  per = 91.2  per(accum) = 99.9
 T(sweep oper_env: after oper_renorm            ) = 3.938e-03 S  per = 0.0946  per(accum) = 100

idx=10 coord=(9,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHPQ nops=C:20 S:20 H:1 P:190 Q:210 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=164348:1.25MB:0.00122GB
ctns::oper_renorm coord=(9,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:22 S:18 H:1 P:153 Q:171 
        dim(bra,ket)=65,65 size(op)=447:0.00341MB size(tot)=102470:0.782MB:0.000763GB
CPUmem: VM:2.003e+01GB RSS:1.899e+00GB  Timing: User:4.700e+02S Sys:1.893e+00S Total:4.719e+02S
----- TIMING FOR symbolic_formulae_renorm with size=365 : 2.732e-02 S -----
rank=0 GPUmem(GB): used=0.00201 (oper)=0.00201
rank=0 GPUmem(GB): used=0.00202 (oper,site)(GB)=0.00201,1.18e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=828
 no. of coefficients=8280:0.0632MB:6.17e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.251e-03 S -----
rank=0 GPUmem(GB): used=0.00208 (oper,site,rinter)=0.00201,1.18e-05,6.17e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0303 S size(rtasks)=365 size(Rlst2)=169 T(Rmu/Rlist)=0.00482,0.0254 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0333 S size(rtasks)=365 size(Rlst)=22705 -----
rank=0 GPUmem(GB): used=0.00208 (oper,site,rinter,batch)=0.00201,1.18e-05,6.17e-05,0.0807 blksize=168 blksize0=140 batchsize=22705
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000586,0.00676,0.000815
--- TIMING FOR renorm : t_inter=5.9e-04 t_gemm=6.8e-03 t_reduction=8.1e-04 tot=8.2e-03 ---
 renorm[inter] counter=10 t=5.9e-04 per=7.2e+00 cost=1.1e+07 flops=1.9e+10
 renorm[gemm] counter=10 i=0 t=1.8e-06 per=2.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=1 t=1.3e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=2 t=1.4e-03 per=1.7e+01 cost=5.6e+06 flops=4.0e+09
 renorm[gemm] counter=10 i=3 t=2.6e-03 per=3.2e+01 cost=9.6e+06 flops=3.6e+09
 renorm[gemm] counter=10 i=4 t=1.4e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=5 t=1.3e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=6 t=2.7e-03 per=3.3e+01 cost=1.6e+07 flops=5.8e+09
 renorm[gemm] counter=10 total t=6.8e-03 per=8.3e+01 cost=3.1e+07 flops=4.6e+09
 renorm[red] counter=10 t=8.1e-04 per=1.0e+01 cost=1.8e+06 flops=2.2e+09
--- TIMING FOR renorm_tot : t_inter=2.7e-03 t_gemm=2.6e-02 t_reduction=4.8e-03 tot=3.3e-02 ---
 renorm_tot[inter] counter=10 t=2.7e-03 per=8.0e+00 cost=5.6e+07 flops=2.1e+10
 renorm_tot[gemm] counter=10 i=0 t=1.7e-05 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=1 t=1.2e-05 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=2 t=6.3e-03 per=1.9e+01 cost=1.6e+07 flops=2.6e+09
 renorm_tot[gemm] counter=10 i=3 t=9.4e-03 per=2.8e+01 cost=3.9e+07 flops=4.2e+09
 renorm_tot[gemm] counter=10 i=4 t=1.3e-05 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=5 t=1.2e-05 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=6 t=1.0e-02 per=3.0e+01 cost=5.7e+07 flops=5.6e+09
 renorm_tot[gemm] counter=10 total t=2.6e-02 per=7.8e+01 cost=1.1e+08 flops=4.4e+09
 renorm_tot[red] counter=10 t=4.8e-03 per=1.4e+01 cost=6.3e+06 flops=1.3e+09
qops.to_cpu: size(tot)=102470:7.8e-01MB:7.6e-04GB t[to_cpu]=2.3e-04S speed=3.4e+00GB/S
check ||H-H.dagger||=6.446e-14 coord=(9,0) rank=0
ctns::oper_ab2pq coord=(9,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.246 S rank=0 -----
##### local oper_env: 2.598e-01 S #####
 T(local oper_env: fetch) = 9.660e-03 S  per = 3.72  per(accum) = 3.72
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 3.72
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 3.72
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 3.72
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 3.72
 T(local oper_env: renrm) = 2.477e-01 S  per = 95.3  per(accum) = 99
 T(local oper_env: save ) = 2.472e-03 S  per = 0.951  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.477e-01 S  T(sum) = 2.477e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.469e-05 S  per = 0.00593  per(accum) = 0.00593
 T(local oper_env: qops init                    ) = 6.647e-03 S  per = 2.68  per(accum) = 2.69
 T(local oper_env: symbolic_formulae_renorm     ) = 2.734e-02 S  per =   11  per(accum) = 13.7
 T(local oper_env: allocate qops on gpu         ) = 4.897e-05 S  per = 0.0198  per(accum) = 13.7
 T(local oper_env: site memcpy cpu2gpu          ) = 3.079e-05 S  per = 0.0124  per(accum) = 13.8
 T(local oper_env: rintermediate init           ) = 1.266e-03 S  per = 0.511  per(accum) = 14.3
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.407e-02 S  per = 13.8  per(accum) = 28
 T(local oper_env: rmmtasks init                ) = 1.681e-01 S  per = 67.9  per(accum) = 95.9
 T(local oper_env: qops memset on cpu           ) = 6.100e-08 S  per = 2.46e-05  per(accum) = 95.9
 T(local oper_env: preprocess_renorm_batchGPU   ) = 8.268e-03 S  per = 3.34  per(accum) = 99.2
 T(local oper_env: reduction of opS & opH [nccl]) = 1.517e-06 S  per = 0.000612  per(accum) = 99.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.348e-04 S  per = 0.0948  per(accum) = 99.3
 T(local oper_env: deallocate cpu and gpu memory) = 2.031e-04 S  per = 0.082  per(accum) = 99.4
 T(local oper_env: reduction of opS & opH [comm]) = 5.930e-05 S  per = 0.0239  per(accum) = 99.4
 T(local oper_env: conversion from opAB to opPQ ) = 5.144e-06 S  per = 0.00208  per(accum) = 99.4
 T(local oper_env: after oper_renorm            ) = 1.403e-03 S  per = 0.567  per(accum) = 100
##### sweep oper_env: 4.525e+00 S #####
 T(sweep oper_env: fetch) = 9.734e-02 S  per = 2.15  per(accum) = 2.15
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.15
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.15
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.15
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.15
 T(sweep oper_env: renrm) = 4.409e+00 S  per = 97.4  per(accum) = 99.6
 T(sweep oper_env: save ) = 1.903e-02 S  per = 0.421  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+10 S  per = -1.732e+32
 T(sweep oper_env: preprocess                  ) = -1.732e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.409e+00 S  T(sum) = 4.409e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 9.328e-05 S  per = 0.00212  per(accum) = 0.00212
 T(sweep oper_env: qops init                    ) = 2.771e-02 S  per = 0.628  per(accum) = 0.631
 T(sweep oper_env: symbolic_formulae_renorm     ) = 9.317e-02 S  per = 2.11  per(accum) = 2.74
 T(sweep oper_env: allocate qops on gpu         ) = 5.882e-04 S  per = 0.0133  per(accum) = 2.76
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.892e-04 S  per = 0.00656  per(accum) = 2.76
 T(sweep oper_env: rintermediate init           ) = 4.429e-03 S  per =  0.1  per(accum) = 2.86
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 8.829e-02 S  per =    2  per(accum) = 4.87
 T(sweep oper_env: rmmtasks init                ) = 3.569e-01 S  per =  8.1  per(accum) = 13
 T(sweep oper_env: qops memset on cpu           ) = 4.280e-07 S  per = 9.71e-06  per(accum) = 13
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.427e-02 S  per = 0.777  per(accum) = 13.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.036e-05 S  per = 0.000235  per(accum) = 13.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.972e-03 S  per = 0.0447  per(accum) = 13.8
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.197e-03 S  per = 0.0271  per(accum) = 13.8
 T(sweep oper_env: reduction of opS & opH [comm]) = 4.082e-04 S  per = 0.00926  per(accum) = 13.8
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.794e+00 S  per = 86.1  per(accum) = 99.9
 T(sweep oper_env: after oper_renorm            ) = 5.341e-03 S  per = 0.121  per(accum) = 100

idx=11 coord=(8,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHPQ nops=C:22 S:18 H:1 P:153 Q:171 
        dim(bra,ket)=65,65 size(op)=447:0.00341MB size(tot)=102470:0.782MB:0.000763GB
ctns::oper_renorm coord=(8,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:24 S:16 H:1 P:120 Q:136 
        dim(bra,ket)=57,57 size(op)=361:0.00275MB size(tot)=66125:0.504MB:0.000493GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.702e+02S Sys:1.897e+00S Total:4.721e+02S
----- TIMING FOR symbolic_formulae_renorm with size=297 : 2.288e-02 S -----
rank=0 GPUmem(GB): used=0.00127 (oper)=0.00127
rank=0 GPUmem(GB): used=0.00128 (oper,site)(GB)=0.00127,9.18e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=664
 no. of coefficients=7304:0.0557MB:5.44e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 9.678e-04 S -----
rank=0 GPUmem(GB): used=0.00134 (oper,site,rinter)=0.00127,9.18e-06,5.44e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0244 S size(rtasks)=297 size(Rlst2)=144 T(Rmu/Rlist)=0.00381,0.0205 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0261 S size(rtasks)=297 size(Rlst)=18714 -----
rank=0 GPUmem(GB): used=0.00134 (oper,site,rinter,batch)=0.00127,9.18e-06,5.44e-05,0.047 blksize=120 blksize0=96 batchsize=18714
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000368,0.00713,0.000595
--- TIMING FOR renorm : t_inter=3.7e-04 t_gemm=7.1e-03 t_reduction=5.9e-04 tot=8.1e-03 ---
 renorm[inter] counter=11 t=3.7e-04 per=4.5e+00 cost=7.1e+06 flops=1.9e+10
 renorm[gemm] counter=11 i=0 t=1.6e-06 per=2.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=1 t=1.3e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=2 t=1.2e-03 per=1.5e+01 cost=2.9e+06 flops=2.4e+09
 renorm[gemm] counter=11 i=3 t=2.6e-03 per=3.2e+01 cost=5.3e+06 flops=2.0e+09
 renorm[gemm] counter=11 i=4 t=1.4e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=5 t=1.3e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=6 t=3.3e-03 per=4.1e+01 cost=9.8e+06 flops=2.9e+09
 renorm[gemm] counter=11 total t=7.1e-03 per=8.8e+01 cost=1.8e+07 flops=2.5e+09
 renorm[red] counter=11 t=5.9e-04 per=7.4e+00 cost=1.4e+06 flops=2.3e+09
--- TIMING FOR renorm_tot : t_inter=3.0e-03 t_gemm=3.3e-02 t_reduction=5.4e-03 tot=4.1e-02 ---
 renorm_tot[inter] counter=11 t=3.0e-03 per=7.4e+00 cost=6.3e+07 flops=2.1e+10
 renorm_tot[gemm] counter=11 i=0 t=1.8e-05 per=4.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=1 t=1.3e-05 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=2 t=7.5e-03 per=1.8e+01 cost=1.9e+07 flops=2.6e+09
 renorm_tot[gemm] counter=11 i=3 t=1.2e-02 per=2.9e+01 cost=4.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=11 i=4 t=1.4e-05 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=5 t=1.3e-05 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=6 t=1.3e-02 per=3.3e+01 cost=6.7e+07 flops=5.0e+09
 renorm_tot[gemm] counter=11 total t=3.3e-02 per=8.0e+01 cost=1.3e+08 flops=4.0e+09
 renorm_tot[red] counter=11 t=5.4e-03 per=1.3e+01 cost=7.7e+06 flops=1.4e+09
qops.to_cpu: size(tot)=66125:5.0e-01MB:4.9e-04GB t[to_cpu]=1.3e-04S speed=3.8e+00GB/S
check ||H-H.dagger||=3.055e-14 coord=(8,0) rank=0
ctns::oper_ab2pq coord=(8,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.198 S rank=0 -----
##### local oper_env: 2.109e-01 S #####
 T(local oper_env: fetch) = 9.610e-03 S  per = 4.56  per(accum) = 4.56
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 4.56
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 4.56
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 4.56
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 4.56
 T(local oper_env: renrm) = 1.993e-01 S  per = 94.5  per(accum) = 99.1
 T(local oper_env: save ) = 1.922e-03 S  per = 0.912  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.993e-01 S  T(sum) = 1.993e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.318e-06 S  per = 0.00467  per(accum) = 0.00467
 T(local oper_env: qops init                    ) = 4.837e-03 S  per = 2.43  per(accum) = 2.43
 T(local oper_env: symbolic_formulae_renorm     ) = 2.290e-02 S  per = 11.5  per(accum) = 13.9
 T(local oper_env: allocate qops on gpu         ) = 3.776e-05 S  per = 0.0189  per(accum) = 13.9
 T(local oper_env: site memcpy cpu2gpu          ) = 2.483e-05 S  per = 0.0125  per(accum) = 14
 T(local oper_env: rintermediate init           ) = 9.804e-04 S  per = 0.492  per(accum) = 14.4
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.668e-02 S  per = 13.4  per(accum) = 27.8
 T(local oper_env: rmmtasks init                ) = 1.339e-01 S  per = 67.2  per(accum) = 95
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 1.66e-05  per(accum) = 95
 T(local oper_env: preprocess_renorm_batchGPU   ) = 8.197e-03 S  per = 4.11  per(accum) = 99.1
 T(local oper_env: reduction of opS & opH [nccl]) = 1.125e-06 S  per = 0.000564  per(accum) = 99.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.361e-04 S  per = 0.0683  per(accum) = 99.2
 T(local oper_env: deallocate cpu and gpu memory) = 4.167e-04 S  per = 0.209  per(accum) = 99.4
 T(local oper_env: reduction of opS & opH [comm]) = 5.127e-05 S  per = 0.0257  per(accum) = 99.4
 T(local oper_env: conversion from opAB to opPQ ) = 4.829e-06 S  per = 0.00242  per(accum) = 99.4
 T(local oper_env: after oper_renorm            ) = 1.177e-03 S  per = 0.591  per(accum) = 100
##### sweep oper_env: 4.736e+00 S #####
 T(sweep oper_env: fetch) = 1.069e-01 S  per = 2.26  per(accum) = 2.26
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.26
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.26
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.26
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.26
 T(sweep oper_env: renrm) = 4.608e+00 S  per = 97.3  per(accum) = 99.6
 T(sweep oper_env: save ) = 2.096e-02 S  per = 0.442  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.906e+10 S  per = -1.906e+32
 T(sweep oper_env: preprocess                  ) = -1.906e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.608e+00 S  T(sum) = 4.608e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.026e-04 S  per = 0.00223  per(accum) = 0.00223
 T(sweep oper_env: qops init                    ) = 3.254e-02 S  per = 0.706  per(accum) = 0.708
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.161e-01 S  per = 2.52  per(accum) = 3.23
 T(sweep oper_env: allocate qops on gpu         ) = 6.260e-04 S  per = 0.0136  per(accum) = 3.24
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.141e-04 S  per = 0.00682  per(accum) = 3.25
 T(sweep oper_env: rintermediate init           ) = 5.410e-03 S  per = 0.117  per(accum) = 3.37
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.150e-01 S  per = 2.49  per(accum) = 5.86
 T(sweep oper_env: rmmtasks init                ) = 4.908e-01 S  per = 10.7  per(accum) = 16.5
 T(sweep oper_env: qops memset on cpu           ) = 4.610e-07 S  per = 1e-05  per(accum) = 16.5
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.247e-02 S  per = 0.922  per(accum) = 17.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.149e-05 S  per = 0.000249  per(accum) = 17.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.108e-03 S  per = 0.0457  per(accum) = 17.5
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.614e-03 S  per = 0.035  per(accum) = 17.5
 T(sweep oper_env: reduction of opS & opH [comm]) = 4.594e-04 S  per = 0.00997  per(accum) = 17.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.794e+00 S  per = 82.3  per(accum) = 99.9
 T(sweep oper_env: after oper_renorm            ) = 6.519e-03 S  per = 0.141  per(accum) = 100

idx=12 coord=(7,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHPQ nops=C:24 S:16 H:1 P:120 Q:136 
        dim(bra,ket)=57,57 size(op)=361:0.00275MB size(tot)=66125:0.504MB:0.000493GB
ctns::oper_renorm coord=(7,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:26 S:14 H:1 P:91 Q:105 
        dim(bra,ket)=47,47 size(op)=293:0.00224MB size(tot)=39416:0.301MB:0.000294GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.704e+02S Sys:1.898e+00S Total:4.723e+02S
----- TIMING FOR symbolic_formulae_renorm with size=237 : 1.929e-02 S -----
rank=0 GPUmem(GB): used=0.000804 (oper)=0.000804
rank=0 GPUmem(GB): used=0.000811 (oper,site)(GB)=0.000804,7.31e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=518
 no. of coefficients=6216:0.0474MB:4.63e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 7.511e-04 S -----
rank=0 GPUmem(GB): used=0.000857 (oper,site,rinter)=0.000804,7.31e-06,4.63e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0178 S size(rtasks)=237 size(Rlst2)=121 T(Rmu/Rlist)=0.00302,0.0148 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0191 S size(rtasks)=237 size(Rlst)=13568 -----
rank=0 GPUmem(GB): used=0.000857 (oper,site,rinter,batch)=0.000804,7.31e-06,4.63e-05,0.0264 blksize=90 blksize0=80 batchsize=13568
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000328,0.00523,0.000692
--- TIMING FOR renorm : t_inter=3.3e-04 t_gemm=5.2e-03 t_reduction=6.9e-04 tot=6.2e-03 ---
 renorm[inter] counter=12 t=3.3e-04 per=5.2e+00 cost=4.7e+06 flops=1.4e+10
 renorm[gemm] counter=12 i=0 t=1.8e-06 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=1 t=1.4e-06 per=2.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=2 t=9.7e-04 per=1.6e+01 cost=1.6e+06 flops=1.7e+09
 renorm[gemm] counter=12 i=3 t=2.1e-03 per=3.3e+01 cost=3.0e+06 flops=1.5e+09
 renorm[gemm] counter=12 i=4 t=1.5e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=5 t=1.4e-06 per=2.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=6 t=2.2e-03 per=3.5e+01 cost=5.8e+06 flops=2.7e+09
 renorm[gemm] counter=12 total t=5.2e-03 per=8.4e+01 cost=1.1e+07 flops=2.0e+09
 renorm[red] counter=12 t=6.9e-04 per=1.1e+01 cost=8.9e+05 flops=1.3e+09
--- TIMING FOR renorm_tot : t_inter=3.4e-03 t_gemm=3.8e-02 t_reduction=6.1e-03 tot=4.8e-02 ---
 renorm_tot[inter] counter=12 t=3.4e-03 per=7.1e+00 cost=6.8e+07 flops=2.0e+10
 renorm_tot[gemm] counter=12 i=0 t=2.0e-05 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=1 t=1.5e-05 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=2 t=8.5e-03 per=1.8e+01 cost=2.1e+07 flops=2.5e+09
 renorm_tot[gemm] counter=12 i=3 t=1.4e-02 per=2.9e+01 cost=4.8e+07 flops=3.4e+09
 renorm_tot[gemm] counter=12 i=4 t=1.6e-05 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=5 t=1.5e-05 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=6 t=1.6e-02 per=3.3e+01 cost=7.3e+07 flops=4.7e+09
 renorm_tot[gemm] counter=12 total t=3.8e-02 per=8.0e+01 cost=1.4e+08 flops=3.7e+09
 renorm_tot[red] counter=12 t=6.1e-03 per=1.3e+01 cost=8.6e+06 flops=1.4e+09
qops.to_cpu: size(tot)=39416:3.0e-01MB:2.9e-04GB t[to_cpu]=8.8e-05S speed=3.3e+00GB/S
check ||H-H.dagger||=2.505e-14 coord=(7,0) rank=0
ctns::oper_ab2pq coord=(7,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.419 S rank=0 -----
##### local oper_env: 4.316e-01 S #####
 T(local oper_env: fetch) = 9.559e-03 S  per = 2.21  per(accum) = 2.21
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.21
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.21
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.21
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.21
 T(local oper_env: renrm) = 4.201e-01 S  per = 97.3  per(accum) = 99.6
 T(local oper_env: save ) = 1.932e-03 S  per = 0.448  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.201e-01 S  T(sum) = 4.201e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.256e-06 S  per = 0.0022  per(accum) = 0.0022
 T(local oper_env: qops init                    ) = 3.455e-03 S  per = 0.822  per(accum) = 0.825
 T(local oper_env: symbolic_formulae_renorm     ) = 1.931e-02 S  per =  4.6  per(accum) = 5.42
 T(local oper_env: allocate qops on gpu         ) = 2.884e-05 S  per = 0.00686  per(accum) = 5.43
 T(local oper_env: site memcpy cpu2gpu          ) = 3.708e-05 S  per = 0.00883  per(accum) = 5.44
 T(local oper_env: rintermediate init           ) = 7.625e-04 S  per = 0.181  per(accum) = 5.62
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.959e-02 S  per = 4.66  per(accum) = 10.3
 T(local oper_env: rmmtasks init                ) = 3.694e-01 S  per = 87.9  per(accum) = 98.2
 T(local oper_env: qops memset on cpu           ) = 5.900e-08 S  per = 1.4e-05  per(accum) = 98.2
 T(local oper_env: preprocess_renorm_batchGPU   ) = 6.354e-03 S  per = 1.51  per(accum) = 99.7
 T(local oper_env: reduction of opS & opH [nccl]) = 1.336e-06 S  per = 0.000318  per(accum) = 99.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 9.459e-05 S  per = 0.0225  per(accum) = 99.7
 T(local oper_env: deallocate cpu and gpu memory) = 1.554e-04 S  per = 0.037  per(accum) = 99.8
 T(local oper_env: reduction of opS & opH [comm]) = 4.984e-05 S  per = 0.0119  per(accum) = 99.8
 T(local oper_env: conversion from opAB to opPQ ) = 4.995e-06 S  per = 0.00119  per(accum) = 99.8
 T(local oper_env: after oper_renorm            ) = 8.908e-04 S  per = 0.212  per(accum) = 100
##### sweep oper_env: 5.168e+00 S #####
 T(sweep oper_env: fetch) = 1.165e-01 S  per = 2.25  per(accum) = 2.25
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.25
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.25
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.25
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.25
 T(sweep oper_env: renrm) = 5.028e+00 S  per = 97.3  per(accum) = 99.6
 T(sweep oper_env: save ) = 2.289e-02 S  per = 0.443  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.079e+10 S  per = -2.079e+32
 T(sweep oper_env: preprocess                  ) = -2.079e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.028e+00 S  T(sum) = 5.028e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.119e-04 S  per = 0.00222  per(accum) = 0.00222
 T(sweep oper_env: qops init                    ) = 3.600e-02 S  per = 0.716  per(accum) = 0.718
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.354e-01 S  per = 2.69  per(accum) = 3.41
 T(sweep oper_env: allocate qops on gpu         ) = 6.548e-04 S  per = 0.013  per(accum) = 3.42
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.511e-04 S  per = 0.00698  per(accum) = 3.43
 T(sweep oper_env: rintermediate init           ) = 6.172e-03 S  per = 0.123  per(accum) = 3.55
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.346e-01 S  per = 2.68  per(accum) = 6.23
 T(sweep oper_env: rmmtasks init                ) = 8.602e-01 S  per = 17.1  per(accum) = 23.3
 T(sweep oper_env: qops memset on cpu           ) = 5.200e-07 S  per = 1.03e-05  per(accum) = 23.3
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.882e-02 S  per = 0.971  per(accum) = 24.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.282e-05 S  per = 0.000255  per(accum) = 24.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.202e-03 S  per = 0.0438  per(accum) = 24.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.769e-03 S  per = 0.0352  per(accum) = 24.4
 T(sweep oper_env: reduction of opS & opH [comm]) = 5.093e-04 S  per = 0.0101  per(accum) = 24.4
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.794e+00 S  per = 75.5  per(accum) = 99.9
 T(sweep oper_env: after oper_renorm            ) = 7.409e-03 S  per = 0.147  per(accum) = 100

idx=13 coord=(6,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHPQ nops=C:26 S:14 H:1 P:91 Q:105 
        dim(bra,ket)=47,47 size(op)=293:0.00224MB size(tot)=39416:0.301MB:0.000294GB
ctns::oper_renorm coord=(6,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:28 S:12 H:1 P:66 Q:78 
        dim(bra,ket)=38,38 size(op)=208:0.00159MB size(tot)=21107:0.161MB:0.000157GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.706e+02S Sys:1.899e+00S Total:4.725e+02S
----- TIMING FOR symbolic_formulae_renorm with size=185 : 1.547e-02 S -----
rank=0 GPUmem(GB): used=0.000468 (oper)=0.000468
rank=0 GPUmem(GB): used=0.000474 (oper,site)(GB)=0.000468,5.39e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=390
 no. of coefficients=5070:0.0387MB:3.78e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.894e-04 S -----
rank=0 GPUmem(GB): used=0.000511 (oper,site,rinter)=0.000468,5.39e-06,3.78e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0119 S size(rtasks)=185 size(Rlst2)=100 T(Rmu/Rlist)=0.00227,0.00967 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0127 S size(rtasks)=185 size(Rlst)=8837 -----
rank=0 GPUmem(GB): used=0.000511 (oper,site,rinter,batch)=0.000468,5.39e-06,3.78e-05,0.0143 blksize=72 blksize0=72 batchsize=8837
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000227,0.00326,0.000496
--- TIMING FOR renorm : t_inter=2.3e-04 t_gemm=3.3e-03 t_reduction=5.0e-04 tot=4.0e-03 ---
 renorm[inter] counter=13 t=2.3e-04 per=5.7e+00 cost=3.1e+06 flops=1.4e+10
 renorm[gemm] counter=13 i=0 t=1.5e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=1 t=1.3e-06 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=2 t=6.4e-04 per=1.6e+01 cost=8.6e+05 flops=1.3e+09
 renorm[gemm] counter=13 i=3 t=1.2e-03 per=3.1e+01 cost=1.6e+06 flops=1.3e+09
 renorm[gemm] counter=13 i=4 t=1.2e-06 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=5 t=1.2e-06 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=6 t=1.4e-03 per=3.5e+01 cost=2.8e+06 flops=2.0e+09
 renorm[gemm] counter=13 total t=3.3e-03 per=8.2e+01 cost=5.3e+06 flops=1.6e+09
 renorm[red] counter=13 t=5.0e-04 per=1.2e+01 cost=4.3e+05 flops=8.6e+08
--- TIMING FOR renorm_tot : t_inter=3.6e-03 t_gemm=4.1e-02 t_reduction=6.6e-03 tot=5.2e-02 ---
 renorm_tot[inter] counter=13 t=3.6e-03 per=7.0e+00 cost=7.1e+07 flops=2.0e+10
 renorm_tot[gemm] counter=13 i=0 t=2.2e-05 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=1 t=1.6e-05 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=2 t=9.1e-03 per=1.8e+01 cost=2.2e+07 flops=2.4e+09
 renorm_tot[gemm] counter=13 i=3 t=1.5e-02 per=3.0e+01 cost=4.9e+07 flops=3.2e+09
 renorm_tot[gemm] counter=13 i=4 t=1.7e-05 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=5 t=1.6e-05 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=6 t=1.7e-02 per=3.3e+01 cost=7.5e+07 flops=4.4e+09
 renorm_tot[gemm] counter=13 total t=4.1e-02 per=8.0e+01 cost=1.5e+08 flops=3.5e+09
 renorm_tot[red] counter=13 t=6.6e-03 per=1.3e+01 cost=9.0e+06 flops=1.4e+09
qops.to_cpu: size(tot)=21107:1.6e-01MB:1.6e-04GB t[to_cpu]=5.0e-05S speed=3.2e+00GB/S
check ||H-H.dagger||=1.373e-14 coord=(6,0) rank=0
ctns::oper_ab2pq coord=(6,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.092 S rank=0 -----
##### local oper_env: 1.042e-01 S #####
 T(local oper_env: fetch) = 1.011e-02 S  per =  9.7  per(accum) = 9.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 9.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 9.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 9.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 9.7
 T(local oper_env: renrm) = 9.263e-02 S  per = 88.9  per(accum) = 98.6
 T(local oper_env: save ) = 1.455e-03 S  per =  1.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.263e-02 S  T(sum) = 9.263e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.272e-06 S  per = 0.01  per(accum) = 0.01
 T(local oper_env: qops init                    ) = 2.496e-03 S  per = 2.69  per(accum) = 2.7
 T(local oper_env: symbolic_formulae_renorm     ) = 1.549e-02 S  per = 16.7  per(accum) = 19.4
 T(local oper_env: allocate qops on gpu         ) = 2.974e-05 S  per = 0.0321  per(accum) = 19.5
 T(local oper_env: site memcpy cpu2gpu          ) = 2.166e-05 S  per = 0.0234  per(accum) = 19.5
 T(local oper_env: rintermediate init           ) = 6.005e-04 S  per = 0.648  per(accum) = 20.1
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.300e-02 S  per =   14  per(accum) = 34.2
 T(local oper_env: rmmtasks init                ) = 5.614e-02 S  per = 60.6  per(accum) = 94.8
 T(local oper_env: qops memset on cpu           ) = 7.500e-08 S  per = 8.1e-05  per(accum) = 94.8
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.077e-03 S  per =  4.4  per(accum) = 99.2
 T(local oper_env: reduction of opS & opH [nccl]) = 1.103e-06 S  per = 0.00119  per(accum) = 99.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 5.553e-05 S  per = 0.0599  per(accum) = 99.2
 T(local oper_env: deallocate cpu and gpu memory) = 1.011e-04 S  per = 0.109  per(accum) = 99.3
 T(local oper_env: reduction of opS & opH [comm]) = 3.655e-05 S  per = 0.0395  per(accum) = 99.4
 T(local oper_env: conversion from opAB to opPQ ) = 3.709e-06 S  per = 0.004  per(accum) = 99.4
 T(local oper_env: after oper_renorm            ) = 5.832e-04 S  per = 0.63  per(accum) = 100
##### sweep oper_env: 5.272e+00 S #####
 T(sweep oper_env: fetch) = 1.266e-01 S  per =  2.4  per(accum) = 2.4
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.4
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.4
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.4
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.4
 T(sweep oper_env: renrm) = 5.121e+00 S  per = 97.1  per(accum) = 99.5
 T(sweep oper_env: save ) = 2.434e-02 S  per = 0.462  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.252e+10 S  per = -2.252e+32
 T(sweep oper_env: preprocess                  ) = -2.252e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.121e+00 S  T(sum) = 5.121e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.211e-04 S  per = 0.00237  per(accum) = 0.00237
 T(sweep oper_env: qops init                    ) = 3.849e-02 S  per = 0.752  per(accum) = 0.754
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.509e-01 S  per = 2.95  per(accum) = 3.7
 T(sweep oper_env: allocate qops on gpu         ) = 6.846e-04 S  per = 0.0134  per(accum) = 3.71
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.728e-04 S  per = 0.00728  per(accum) = 3.72
 T(sweep oper_env: rintermediate init           ) = 6.773e-03 S  per = 0.132  per(accum) = 3.85
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.476e-01 S  per = 2.88  per(accum) = 6.73
 T(sweep oper_env: rmmtasks init                ) = 9.163e-01 S  per = 17.9  per(accum) = 24.6
 T(sweep oper_env: qops memset on cpu           ) = 5.950e-07 S  per = 1.16e-05  per(accum) = 24.6
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.290e-02 S  per = 1.03  per(accum) = 25.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.393e-05 S  per = 0.000272  per(accum) = 25.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.258e-03 S  per = 0.0441  per(accum) = 25.7
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.870e-03 S  per = 0.0365  per(accum) = 25.7
 T(sweep oper_env: reduction of opS & opH [comm]) = 5.458e-04 S  per = 0.0107  per(accum) = 25.8
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.794e+00 S  per = 74.1  per(accum) = 99.8
 T(sweep oper_env: after oper_renorm            ) = 7.993e-03 S  per = 0.156  per(accum) = 100

idx=14 coord=(5,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHPQ nops=C:28 S:12 H:1 P:66 Q:78 
        dim(bra,ket)=38,38 size(op)=208:0.00159MB size(tot)=21107:0.161MB:0.000157GB
ctns::oper_renorm coord=(5,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:30 S:10 H:1 P:45 Q:55 
        dim(bra,ket)=27,27 size(op)=159:0.00121MB size(tot)=9444:0.0721MB:7.04e-05GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.707e+02S Sys:1.899e+00S Total:4.726e+02S
----- TIMING FOR symbolic_formulae_renorm with size=141 : 1.065e-02 S -----
rank=0 GPUmem(GB): used=0.000245 (oper)=0.000245
rank=0 GPUmem(GB): used=0.000249 (oper,site)(GB)=0.000245,3.56e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=280
 no. of coefficients=3920:0.0299MB:2.92e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.796e-04 S -----
rank=0 GPUmem(GB): used=0.000278 (oper,site,rinter)=0.000245,3.56e-06,2.92e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00666 S size(rtasks)=141 size(Rlst2)=49 T(Rmu/Rlist)=0.00155,0.0051 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00707 S size(rtasks)=141 size(Rlst)=4682 -----
rank=0 GPUmem(GB): used=0.000278 (oper,site,rinter,batch)=0.000245,3.56e-06,2.92e-05,0.00673 blksize=64 blksize0=64 batchsize=4682
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00017,0.00221,0.000324
--- TIMING FOR renorm : t_inter=1.7e-04 t_gemm=2.2e-03 t_reduction=3.2e-04 tot=2.7e-03 ---
 renorm[inter] counter=14 t=1.7e-04 per=6.3e+00 cost=1.3e+06 flops=7.5e+09
 renorm[gemm] counter=14 i=0 t=1.5e-06 per=5.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=1 t=1.3e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=2 t=4.9e-04 per=1.8e+01 cost=3.2e+05 flops=6.6e+08
 renorm[gemm] counter=14 i=3 t=9.2e-04 per=3.4e+01 cost=6.3e+05 flops=6.8e+08
 renorm[gemm] counter=14 i=4 t=1.3e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=5 t=1.2e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=6 t=8.0e-04 per=2.9e+01 cost=1.3e+06 flops=1.6e+09
 renorm[gemm] counter=14 total t=2.2e-03 per=8.2e+01 cost=2.2e+06 flops=1.0e+09
 renorm[red] counter=14 t=3.2e-04 per=1.2e+01 cost=2.4e+05 flops=7.3e+08
--- TIMING FOR renorm_tot : t_inter=3.8e-03 t_gemm=4.4e-02 t_reduction=6.9e-03 tot=5.4e-02 ---
 renorm_tot[inter] counter=14 t=3.8e-03 per=6.9e+00 cost=7.2e+07 flops=1.9e+10
 renorm_tot[gemm] counter=14 i=0 t=2.3e-05 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=1 t=1.7e-05 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=2 t=9.6e-03 per=1.8e+01 cost=2.2e+07 flops=2.3e+09
 renorm_tot[gemm] counter=14 i=3 t=1.6e-02 per=3.0e+01 cost=5.0e+07 flops=3.1e+09
 renorm_tot[gemm] counter=14 i=4 t=1.8e-05 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=5 t=1.7e-05 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=6 t=1.8e-02 per=3.3e+01 cost=7.7e+07 flops=4.3e+09
 renorm_tot[gemm] counter=14 total t=4.4e-02 per=8.0e+01 cost=1.5e+08 flops=3.4e+09
 renorm_tot[red] counter=14 t=6.9e-03 per=1.3e+01 cost=9.2e+06 flops=1.3e+09
qops.to_cpu: size(tot)=9444:7.2e-02MB:7.0e-05GB t[to_cpu]=2.7e-05S speed=2.6e+00GB/S
check ||H-H.dagger||=1.739e-14 coord=(5,0) rank=0
ctns::oper_ab2pq coord=(5,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0517 S rank=0 -----
##### local oper_env: 6.223e-02 S #####
 T(local oper_env: fetch) = 8.794e-03 S  per = 14.1  per(accum) = 14.1
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.1
 T(local oper_env: renrm) = 5.210e-02 S  per = 83.7  per(accum) = 97.8
 T(local oper_env: save ) = 1.339e-03 S  per = 2.15  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.210e-02 S  T(sum) = 5.210e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.169e-06 S  per = 0.0157  per(accum) = 0.0157
 T(local oper_env: qops init                    ) = 1.213e-03 S  per = 2.33  per(accum) = 2.34
 T(local oper_env: symbolic_formulae_renorm     ) = 1.066e-02 S  per = 20.5  per(accum) = 22.8
 T(local oper_env: allocate qops on gpu         ) = 2.548e-05 S  per = 0.0489  per(accum) = 22.9
 T(local oper_env: site memcpy cpu2gpu          ) = 4.293e-05 S  per = 0.0824  per(accum) = 22.9
 T(local oper_env: rintermediate init           ) = 3.894e-04 S  per = 0.747  per(accum) = 23.7
 T(local oper_env: preprocess_formulae_Rlist2   ) = 7.219e-03 S  per = 13.9  per(accum) = 37.5
 T(local oper_env: rmmtasks init                ) = 2.919e-02 S  per =   56  per(accum) = 93.6
 T(local oper_env: qops memset on cpu           ) = 6.000e-08 S  per = 0.000115  per(accum) = 93.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.805e-03 S  per = 5.38  per(accum) = 98.9
 T(local oper_env: reduction of opS & opH [nccl]) = 1.108e-06 S  per = 0.00213  per(accum) = 99
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.291e-05 S  per = 0.0632  per(accum) = 99
 T(local oper_env: deallocate cpu and gpu memory) = 9.295e-05 S  per = 0.178  per(accum) = 99.2
 T(local oper_env: reduction of opS & opH [comm]) = 3.120e-05 S  per = 0.0599  per(accum) = 99.3
 T(local oper_env: conversion from opAB to opPQ ) = 3.547e-06 S  per = 0.00681  per(accum) = 99.3
 T(local oper_env: after oper_renorm            ) = 3.864e-04 S  per = 0.742  per(accum) = 100
##### sweep oper_env: 5.334e+00 S #####
 T(sweep oper_env: fetch) = 1.354e-01 S  per = 2.54  per(accum) = 2.54
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.54
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.54
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.54
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.54
 T(sweep oper_env: renrm) = 5.173e+00 S  per =   97  per(accum) = 99.5
 T(sweep oper_env: save ) = 2.568e-02 S  per = 0.481  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.425e+10 S  per = -2.425e+32
 T(sweep oper_env: preprocess                  ) = -2.425e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.173e+00 S  T(sum) = 5.173e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.293e-04 S  per = 0.0025  per(accum) = 0.0025
 T(sweep oper_env: qops init                    ) = 3.971e-02 S  per = 0.768  per(accum) = 0.77
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.615e-01 S  per = 3.12  per(accum) = 3.89
 T(sweep oper_env: allocate qops on gpu         ) = 7.101e-04 S  per = 0.0137  per(accum) = 3.91
 T(sweep oper_env: site memcpy cpu2gpu          ) = 4.157e-04 S  per = 0.00804  per(accum) = 3.91
 T(sweep oper_env: rintermediate init           ) = 7.162e-03 S  per = 0.138  per(accum) = 4.05
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.548e-01 S  per = 2.99  per(accum) = 7.04
 T(sweep oper_env: rmmtasks init                ) = 9.455e-01 S  per = 18.3  per(accum) = 25.3
 T(sweep oper_env: qops memset on cpu           ) = 6.550e-07 S  per = 1.27e-05  per(accum) = 25.3
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.570e-02 S  per = 1.08  per(accum) = 26.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.503e-05 S  per = 0.000291  per(accum) = 26.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.291e-03 S  per = 0.0443  per(accum) = 26.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.963e-03 S  per = 0.0379  per(accum) = 26.5
 T(sweep oper_env: reduction of opS & opH [comm]) = 5.770e-04 S  per = 0.0112  per(accum) = 26.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.794e+00 S  per = 73.3  per(accum) = 99.8
 T(sweep oper_env: after oper_renorm            ) = 8.379e-03 S  per = 0.162  per(accum) = 100

idx=15 coord=(4,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHPQ nops=C:30 S:10 H:1 P:45 Q:55 
        dim(bra,ket)=27,27 size(op)=159:0.00121MB size(tot)=9444:0.0721MB:7.04e-05GB
ctns::oper_renorm coord=(4,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:32 S:8 H:1 P:28 Q:36 
        dim(bra,ket)=17,17 size(op)=63:0.000481MB size(tot)=2895:0.0221MB:2.16e-05GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.708e+02S Sys:1.899e+00S Total:4.727e+02S
----- TIMING FOR symbolic_formulae_renorm with size=105 : 7.573e-03 S -----
rank=0 GPUmem(GB): used=0.000109 (oper)=0.000109
rank=0 GPUmem(GB): used=0.000111 (oper,site)(GB)=0.000109,1.59e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=188
 no. of coefficients=2820:0.0215MB:2.1e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.575e-04 S -----
rank=0 GPUmem(GB): used=0.000132 (oper,site,rinter)=0.000109,1.59e-06,2.1e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00343 S size(rtasks)=105 size(Rlst2)=36 T(Rmu/Rlist)=0.00108,0.00235 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00361 S size(rtasks)=105 size(Rlst)=2007 -----
rank=0 GPUmem(GB): used=0.000132 (oper,site,rinter,batch)=0.000109,1.59e-06,2.1e-05,0.00217 blksize=40 blksize0=64 batchsize=2007
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00012,0.00132,0.000216
--- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=1.3e-03 t_reduction=2.2e-04 tot=1.7e-03 ---
 renorm[inter] counter=15 t=1.2e-04 per=7.2e+00 cost=3.0e+05 flops=2.5e+09
 renorm[gemm] counter=15 i=0 t=1.4e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=1 t=1.2e-06 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=2 t=3.3e-04 per=2.0e+01 cost=8.2e+04 flops=2.5e+08
 renorm[gemm] counter=15 i=3 t=5.0e-04 per=3.0e+01 cost=1.8e+05 flops=3.6e+08
 renorm[gemm] counter=15 i=4 t=1.2e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=5 t=1.2e-06 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=6 t=4.9e-04 per=3.0e+01 cost=2.7e+05 flops=5.6e+08
 renorm[gemm] counter=15 total t=1.3e-03 per=8.0e+01 cost=5.3e+05 flops=4.0e+08
 renorm[red] counter=15 t=2.2e-04 per=1.3e+01 cost=5.7e+04 flops=2.7e+08
--- TIMING FOR renorm_tot : t_inter=3.9e-03 t_gemm=4.5e-02 t_reduction=7.1e-03 tot=5.6e-02 ---
 renorm_tot[inter] counter=15 t=3.9e-03 per=7.0e+00 cost=7.2e+07 flops=1.9e+10
 renorm_tot[gemm] counter=15 i=0 t=2.4e-05 per=4.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=1 t=1.9e-05 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=2 t=9.9e-03 per=1.8e+01 cost=2.2e+07 flops=2.2e+09
 renorm_tot[gemm] counter=15 i=3 t=1.7e-02 per=3.0e+01 cost=5.0e+07 flops=3.0e+09
 renorm_tot[gemm] counter=15 i=4 t=1.9e-05 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=5 t=1.8e-05 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=6 t=1.8e-02 per=3.3e+01 cost=7.7e+07 flops=4.2e+09
 renorm_tot[gemm] counter=15 total t=4.5e-02 per=8.0e+01 cost=1.5e+08 flops=3.3e+09
 renorm_tot[red] counter=15 t=7.1e-03 per=1.3e+01 cost=9.3e+06 flops=1.3e+09
qops.to_cpu: size(tot)=2895:2.2e-02MB:2.2e-05GB t[to_cpu]=1.6e-05S speed=1.4e+00GB/S
check ||H-H.dagger||=2.028e-14 coord=(4,0) rank=0
ctns::oper_ab2pq coord=(4,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0255 S rank=0 -----
##### local oper_env: 3.586e-02 S #####
 T(local oper_env: fetch) = 8.800e-03 S  per = 24.5  per(accum) = 24.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 24.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 24.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 24.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 24.5
 T(local oper_env: renrm) = 2.578e-02 S  per = 71.9  per(accum) = 96.4
 T(local oper_env: save ) = 1.279e-03 S  per = 3.57  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.578e-02 S  T(sum) = 2.578e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.992e-06 S  per = 0.031  per(accum) = 0.031
 T(local oper_env: qops init                    ) = 8.158e-04 S  per = 3.16  per(accum) = 3.2
 T(local oper_env: symbolic_formulae_renorm     ) = 7.584e-03 S  per = 29.4  per(accum) = 32.6
 T(local oper_env: allocate qops on gpu         ) = 2.522e-05 S  per = 0.0978  per(accum) = 32.7
 T(local oper_env: site memcpy cpu2gpu          ) = 3.085e-05 S  per = 0.12  per(accum) = 32.8
 T(local oper_env: rintermediate init           ) = 2.667e-04 S  per = 1.03  per(accum) = 33.9
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.680e-03 S  per = 14.3  per(accum) = 48.1
 T(local oper_env: rmmtasks init                ) = 1.121e-02 S  per = 43.5  per(accum) = 91.6
 T(local oper_env: qops memset on cpu           ) = 6.400e-08 S  per = 0.000248  per(accum) = 91.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.753e-03 S  per =  6.8  per(accum) = 98.4
 T(local oper_env: reduction of opS & opH [nccl]) = 9.630e-07 S  per = 0.00374  per(accum) = 98.4
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.141e-05 S  per = 0.0831  per(accum) = 98.5
 T(local oper_env: deallocate cpu and gpu memory) = 1.002e-04 S  per = 0.389  per(accum) = 98.9
 T(local oper_env: reduction of opS & opH [comm]) = 2.596e-05 S  per = 0.101  per(accum) = 99
 T(local oper_env: conversion from opAB to opPQ ) = 3.581e-06 S  per = 0.0139  per(accum) = 99
 T(local oper_env: after oper_renorm            ) = 2.501e-04 S  per = 0.97  per(accum) = 100
##### sweep oper_env: 5.370e+00 S #####
 T(sweep oper_env: fetch) = 1.442e-01 S  per = 2.69  per(accum) = 2.69
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.69
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.69
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.69
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.69
 T(sweep oper_env: renrm) = 5.199e+00 S  per = 96.8  per(accum) = 99.5
 T(sweep oper_env: save ) = 2.696e-02 S  per = 0.502  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.599e+10 S  per = -2.599e+32
 T(sweep oper_env: preprocess                  ) = -2.599e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.199e+00 S  T(sum) = 5.199e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.373e-04 S  per = 0.00264  per(accum) = 0.00264
 T(sweep oper_env: qops init                    ) = 4.052e-02 S  per = 0.779  per(accum) = 0.782
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.691e-01 S  per = 3.25  per(accum) = 4.03
 T(sweep oper_env: allocate qops on gpu         ) = 7.353e-04 S  per = 0.0141  per(accum) = 4.05
 T(sweep oper_env: site memcpy cpu2gpu          ) = 4.466e-04 S  per = 0.00859  per(accum) = 4.06
 T(sweep oper_env: rintermediate init           ) = 7.429e-03 S  per = 0.143  per(accum) = 4.2
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.584e-01 S  per = 3.05  per(accum) = 7.25
 T(sweep oper_env: rmmtasks init                ) = 9.567e-01 S  per = 18.4  per(accum) = 25.7
 T(sweep oper_env: qops memset on cpu           ) = 7.190e-07 S  per = 1.38e-05  per(accum) = 25.7
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.746e-02 S  per = 1.11  per(accum) = 26.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.600e-05 S  per = 0.000308  per(accum) = 26.8
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.312e-03 S  per = 0.0445  per(accum) = 26.8
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.063e-03 S  per = 0.0397  per(accum) = 26.8
 T(sweep oper_env: reduction of opS & opH [comm]) = 6.030e-04 S  per = 0.0116  per(accum) = 26.9
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.794e+00 S  per =   73  per(accum) = 99.8
 T(sweep oper_env: after oper_renorm            ) = 8.629e-03 S  per = 0.166  per(accum) = 100

idx=16 coord=(3,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHPQ nops=C:32 S:8 H:1 P:28 Q:36 
        dim(bra,ket)=17,17 size(op)=63:0.000481MB size(tot)=2895:0.0221MB:2.16e-05GB
ctns::oper_renorm coord=(3,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:34 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=822:0.00627MB:6.12e-06GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.708e+02S Sys:1.899e+00S Total:4.727e+02S
----- TIMING FOR symbolic_formulae_renorm with size=77 : 4.890e-03 S -----
rank=0 GPUmem(GB): used=4.51e-05 (oper)=4.51e-05
rank=0 GPUmem(GB): used=4.57e-05 (oper,site)(GB)=4.51e-05,5.96e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=114
 no. of coefficients=1824:0.0139MB:1.36e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.600e-04 S -----
rank=0 GPUmem(GB): used=5.93e-05 (oper,site,rinter)=4.51e-05,5.96e-07,1.36e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00185 S size(rtasks)=77 size(Rlst2)=25 T(Rmu/Rlist)=0.00069,0.00116 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00195 S size(rtasks)=77 size(Rlst)=956 -----
rank=0 GPUmem(GB): used=5.93e-05 (oper,site,rinter,batch)=4.51e-05,5.96e-07,1.36e-05,0.000363 blksize=15 blksize0=20 batchsize=956
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.16e-05,0.000649,0.00016
--- TIMING FOR renorm : t_inter=9.1e-05 t_gemm=6.5e-04 t_reduction=1.6e-04 tot=9.0e-04 ---
 renorm[inter] counter=16 t=9.1e-05 per=1.0e+01 cost=7.4e+04 flops=8.2e+08
 renorm[gemm] counter=16 i=0 t=1.4e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=1 t=1.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=2 t=1.6e-04 per=1.8e+01 cost=1.5e+04 flops=9.4e+07
 renorm[gemm] counter=16 i=3 t=2.6e-04 per=2.9e+01 cost=3.3e+04 flops=1.3e+08
 renorm[gemm] counter=16 i=4 t=1.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=5 t=1.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=6 t=2.2e-04 per=2.5e+01 cost=4.1e+04 flops=1.9e+08
 renorm[gemm] counter=16 total t=6.5e-04 per=7.2e+01 cost=8.9e+04 flops=1.4e+08
 renorm[red] counter=16 t=1.6e-04 per=1.8e+01 cost=1.1e+04 flops=6.9e+07
--- TIMING FOR renorm_tot : t_inter=4.0e-03 t_gemm=4.6e-02 t_reduction=7.3e-03 tot=5.7e-02 ---
 renorm_tot[inter] counter=16 t=4.0e-03 per=7.0e+00 cost=7.2e+07 flops=1.8e+10
 renorm_tot[gemm] counter=16 i=0 t=2.6e-05 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=1 t=2.0e-05 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=2 t=1.0e-02 per=1.8e+01 cost=2.2e+07 flops=2.2e+09
 renorm_tot[gemm] counter=16 i=3 t=1.7e-02 per=3.0e+01 cost=5.0e+07 flops=3.0e+09
 renorm_tot[gemm] counter=16 i=4 t=2.0e-05 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=5 t=1.9e-05 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=6 t=1.9e-02 per=3.3e+01 cost=7.7e+07 flops=4.2e+09
 renorm_tot[gemm] counter=16 total t=4.6e-02 per=8.0e+01 cost=1.5e+08 flops=3.3e+09
 renorm_tot[red] counter=16 t=7.3e-03 per=1.3e+01 cost=9.3e+06 flops=1.3e+09
qops.to_cpu: size(tot)=822:6.3e-03MB:6.1e-06GB t[to_cpu]=1.3e-05S speed=4.7e-01GB/S
check ||H-H.dagger||=6.581e-15 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.014 S rank=0 -----
##### local oper_env: 2.427e-02 S #####
 T(local oper_env: fetch) = 8.806e-03 S  per = 36.3  per(accum) = 36.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 36.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 36.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 36.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 36.3
 T(local oper_env: renrm) = 1.417e-02 S  per = 58.4  per(accum) = 94.7
 T(local oper_env: save ) = 1.291e-03 S  per = 5.32  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.417e-02 S  T(sum) = 1.417e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.078e-06 S  per = 0.057  per(accum) = 0.057
 T(local oper_env: qops init                    ) = 5.569e-04 S  per = 3.93  per(accum) = 3.99
 T(local oper_env: symbolic_formulae_renorm     ) = 4.900e-03 S  per = 34.6  per(accum) = 38.6
 T(local oper_env: allocate qops on gpu         ) = 2.375e-05 S  per = 0.168  per(accum) = 38.7
 T(local oper_env: site memcpy cpu2gpu          ) = 4.445e-05 S  per = 0.314  per(accum) = 39
 T(local oper_env: rintermediate init           ) = 1.689e-04 S  per = 1.19  per(accum) = 40.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.979e-03 S  per =   14  per(accum) = 54.2
 T(local oper_env: rmmtasks init                ) = 5.268e-03 S  per = 37.2  per(accum) = 91.4
 T(local oper_env: qops memset on cpu           ) = 6.500e-08 S  per = 0.000459  per(accum) = 91.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 9.970e-04 S  per = 7.04  per(accum) = 98.4
 T(local oper_env: reduction of opS & opH [nccl]) = 9.430e-07 S  per = 0.00665  per(accum) = 98.4
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.852e-05 S  per = 0.131  per(accum) = 98.5
 T(local oper_env: deallocate cpu and gpu memory) = 2.219e-05 S  per = 0.157  per(accum) = 98.7
 T(local oper_env: reduction of opS & opH [comm]) = 2.156e-05 S  per = 0.152  per(accum) = 98.8
 T(local oper_env: conversion from opAB to opPQ ) = 3.472e-06 S  per = 0.0245  per(accum) = 98.9
 T(local oper_env: after oper_renorm            ) = 1.598e-04 S  per = 1.13  per(accum) = 100
##### sweep oper_env: 5.394e+00 S #####
 T(sweep oper_env: fetch) = 1.530e-01 S  per = 2.84  per(accum) = 2.84
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.84
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.84
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.84
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.84
 T(sweep oper_env: renrm) = 5.213e+00 S  per = 96.6  per(accum) = 99.5
 T(sweep oper_env: save ) = 2.825e-02 S  per = 0.524  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.772e+10 S  per = -2.772e+32
 T(sweep oper_env: preprocess                  ) = -2.772e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.213e+00 S  T(sum) = 5.213e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.454e-04 S  per = 0.00279  per(accum) = 0.00279
 T(sweep oper_env: qops init                    ) = 4.108e-02 S  per = 0.788  per(accum) = 0.791
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.740e-01 S  per = 3.34  per(accum) = 4.13
 T(sweep oper_env: allocate qops on gpu         ) = 7.590e-04 S  per = 0.0146  per(accum) = 4.14
 T(sweep oper_env: site memcpy cpu2gpu          ) = 4.910e-04 S  per = 0.00942  per(accum) = 4.15
 T(sweep oper_env: rintermediate init           ) = 7.598e-03 S  per = 0.146  per(accum) = 4.3
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.604e-01 S  per = 3.08  per(accum) = 7.38
 T(sweep oper_env: rmmtasks init                ) = 9.620e-01 S  per = 18.5  per(accum) = 25.8
 T(sweep oper_env: qops memset on cpu           ) = 7.840e-07 S  per = 1.5e-05  per(accum) = 25.8
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.845e-02 S  per = 1.12  per(accum) = 27
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.694e-05 S  per = 0.000325  per(accum) = 27
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.331e-03 S  per = 0.0447  per(accum) = 27
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.085e-03 S  per = 0.04  per(accum) = 27
 T(sweep oper_env: reduction of opS & opH [comm]) = 6.245e-04 S  per = 0.012  per(accum) = 27
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.794e+00 S  per = 72.8  per(accum) = 99.8
 T(sweep oper_env: after oper_renorm            ) = 8.789e-03 S  per = 0.169  per(accum) = 100

idx=17 coord=(2,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHPQ nops=C:34 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=822:0.00627MB:6.12e-06GB
ctns::oper_renorm coord=(2,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:36 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=6,6 size(op)=10:7.63e-05MB size(tot)=207:0.00158MB:1.54e-06GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.709e+02S Sys:1.899e+00S Total:4.728e+02S
----- TIMING FOR symbolic_formulae_renorm with size=57 : 2.763e-03 S -----
rank=0 GPUmem(GB): used=2.51e-05 (oper)=2.51e-05
rank=0 GPUmem(GB): used=2.53e-05 (oper,site)(GB)=2.51e-05,2.24e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=58
 no. of coefficients=986:0.00752MB:7.35e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 9.179e-05 S -----
rank=0 GPUmem(GB): used=3.26e-05 (oper,site,rinter)=2.51e-05,2.24e-07,7.35e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00113 S size(rtasks)=57 size(Rlst2)=16 T(Rmu/Rlist)=0.00042,0.000709 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00119 S size(rtasks)=57 size(Rlst)=562 -----
rank=0 GPUmem(GB): used=3.26e-05 (oper,site,rinter,batch)=2.51e-05,2.24e-07,7.35e-06,9.21e-05 blksize=6 blksize0=9 batchsize=562
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.81e-05,0.000445,0.000154
--- TIMING FOR renorm : t_inter=8.8e-05 t_gemm=4.4e-04 t_reduction=1.5e-04 tot=6.9e-04 ---
 renorm[inter] counter=17 t=8.8e-05 per=1.3e+01 cost=1.6e+04 flops=1.8e+08
 renorm[gemm] counter=17 i=0 t=1.3e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=1 t=1.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=2 t=1.3e-04 per=1.9e+01 cost=2.8e+03 flops=2.1e+07
 renorm[gemm] counter=17 i=3 t=1.7e-04 per=2.5e+01 cost=5.4e+03 flops=3.2e+07
 renorm[gemm] counter=17 i=4 t=1.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=5 t=1.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=6 t=1.4e-04 per=2.0e+01 cost=6.2e+03 flops=4.5e+07
 renorm[gemm] counter=17 total t=4.4e-04 per=6.5e+01 cost=1.4e+04 flops=3.2e+07
 renorm[red] counter=17 t=1.5e-04 per=2.2e+01 cost=2.5e+03 flops=1.6e+07
--- TIMING FOR renorm_tot : t_inter=4.1e-03 t_gemm=4.6e-02 t_reduction=7.4e-03 tot=5.8e-02 ---
 renorm_tot[inter] counter=17 t=4.1e-03 per=7.1e+00 cost=7.2e+07 flops=1.8e+10
 renorm_tot[gemm] counter=17 i=0 t=2.7e-05 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=1 t=2.1e-05 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=2 t=1.0e-02 per=1.8e+01 cost=2.2e+07 flops=2.2e+09
 renorm_tot[gemm] counter=17 i=3 t=1.7e-02 per=3.0e+01 cost=5.0e+07 flops=2.9e+09
 renorm_tot[gemm] counter=17 i=4 t=2.2e-05 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=5 t=2.1e-05 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=6 t=1.9e-02 per=3.2e+01 cost=7.7e+07 flops=4.1e+09
 renorm_tot[gemm] counter=17 total t=4.6e-02 per=8.0e+01 cost=1.5e+08 flops=3.2e+09
 renorm_tot[red] counter=17 t=7.4e-03 per=1.3e+01 cost=9.3e+06 flops=1.2e+09
qops.to_cpu: size(tot)=207:1.6e-03MB:1.5e-06GB t[to_cpu]=1.3e-05S speed=1.2e-01GB/S
check ||H-H.dagger||=2.237e-15 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00833 S rank=0 -----
##### local oper_env: 1.851e-02 S #####
 T(local oper_env: fetch) = 8.785e-03 S  per = 47.5  per(accum) = 47.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 47.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 47.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 47.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 47.5
 T(local oper_env: renrm) = 8.458e-03 S  per = 45.7  per(accum) = 93.2
 T(local oper_env: save ) = 1.266e-03 S  per = 6.84  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.458e-03 S  T(sum) = 8.458e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.027e-06 S  per = 0.0949  per(accum) = 0.0949
 T(local oper_env: qops init                    ) = 3.898e-04 S  per = 4.61  per(accum) = 4.7
 T(local oper_env: symbolic_formulae_renorm     ) = 2.772e-03 S  per = 32.8  per(accum) = 37.5
 T(local oper_env: allocate qops on gpu         ) = 2.002e-05 S  per = 0.237  per(accum) = 37.7
 T(local oper_env: site memcpy cpu2gpu          ) = 4.181e-05 S  per = 0.494  per(accum) = 38.2
 T(local oper_env: rintermediate init           ) = 1.005e-04 S  per = 1.19  per(accum) = 39.4
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.209e-03 S  per = 14.3  per(accum) = 53.7
 T(local oper_env: rmmtasks init                ) = 2.956e-03 S  per = 34.9  per(accum) = 88.6
 T(local oper_env: qops memset on cpu           ) = 5.500e-08 S  per = 0.00065  per(accum) = 88.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 7.805e-04 S  per = 9.23  per(accum) = 97.9
 T(local oper_env: reduction of opS & opH [nccl]) = 9.680e-07 S  per = 0.0114  per(accum) = 97.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.824e-05 S  per = 0.216  per(accum) = 98.1
 T(local oper_env: deallocate cpu and gpu memory) = 2.351e-05 S  per = 0.278  per(accum) = 98.4
 T(local oper_env: reduction of opS & opH [comm]) = 2.025e-05 S  per = 0.239  per(accum) = 98.6
 T(local oper_env: conversion from opAB to opPQ ) = 3.516e-06 S  per = 0.0416  per(accum) = 98.7
 T(local oper_env: after oper_renorm            ) = 1.135e-04 S  per = 1.34  per(accum) = 100
##### sweep oper_env: 5.413e+00 S #####
 T(sweep oper_env: fetch) = 1.618e-01 S  per = 2.99  per(accum) = 2.99
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.99
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.99
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.99
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.99
 T(sweep oper_env: renrm) = 5.221e+00 S  per = 96.5  per(accum) = 99.5
 T(sweep oper_env: save ) = 2.952e-02 S  per = 0.545  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.945e+10 S  per = -2.945e+32
 T(sweep oper_env: preprocess                  ) = -2.945e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.221e+00 S  T(sum) = 5.221e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.534e-04 S  per = 0.00294  per(accum) = 0.00294
 T(sweep oper_env: qops init                    ) = 4.147e-02 S  per = 0.794  per(accum) = 0.797
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.768e-01 S  per = 3.39  per(accum) = 4.18
 T(sweep oper_env: allocate qops on gpu         ) = 7.790e-04 S  per = 0.0149  per(accum) = 4.2
 T(sweep oper_env: site memcpy cpu2gpu          ) = 5.328e-04 S  per = 0.0102  per(accum) = 4.21
 T(sweep oper_env: rintermediate init           ) = 7.698e-03 S  per = 0.147  per(accum) = 4.36
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.616e-01 S  per =  3.1  per(accum) = 7.45
 T(sweep oper_env: rmmtasks init                ) = 9.649e-01 S  per = 18.5  per(accum) = 25.9
 T(sweep oper_env: qops memset on cpu           ) = 8.390e-07 S  per = 1.61e-05  per(accum) = 25.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.923e-02 S  per = 1.13  per(accum) = 27.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.791e-05 S  per = 0.000343  per(accum) = 27.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.349e-03 S  per = 0.045  per(accum) = 27.1
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.109e-03 S  per = 0.0404  per(accum) = 27.2
 T(sweep oper_env: reduction of opS & opH [comm]) = 6.448e-04 S  per = 0.0123  per(accum) = 27.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.794e+00 S  per = 72.7  per(accum) = 99.8
 T(sweep oper_env: after oper_renorm            ) = 8.902e-03 S  per = 0.17  per(accum) = 100

idx=18 coord=(1,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHPQ nops=C:36 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=6,6 size(op)=10:7.63e-05MB size(tot)=207:0.00158MB:1.54e-06GB
ctns::oper_renorm coord=(1,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:38 S:2 H:1 P:1 Q:3 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=50:0.000381MB:3.73e-07GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.709e+02S Sys:1.900e+00S Total:4.728e+02S
----- TIMING FOR symbolic_formulae_renorm with size=45 : 1.177e-03 S -----
rank=0 GPUmem(GB): used=1.93e-05 (oper)=1.93e-05
rank=0 GPUmem(GB): used=1.94e-05 (oper,site)(GB)=1.93e-05,7.45e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=45
 no. of rintermediate operators=20
 no. of coefficients=360:0.00275MB:2.68e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.740e-05 S -----
rank=0 GPUmem(GB): used=2.21e-05 (oper,site,rinter)=1.93e-05,7.45e-08,2.68e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000584 S size(rtasks)=45 size(Rlst2)=9 T(Rmu/Rlist)=0.000247,0.000336 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000616 S size(rtasks)=45 size(Rlst)=266 -----
rank=0 GPUmem(GB): used=2.21e-05 (oper,site,rinter,batch)=1.93e-05,7.45e-08,2.68e-06,1.39e-05 blksize=2 blksize0=2 batchsize=266
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=6.37e-05,0.000185,0.000108
--- TIMING FOR renorm : t_inter=6.3e-05 t_gemm=1.8e-04 t_reduction=1.1e-04 tot=3.6e-04 ---
 renorm[inter] counter=18 t=6.3e-05 per=1.8e+01 cost=1.2e+03 flops=1.9e+07
 renorm[gemm] counter=18 i=0 t=1.4e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=1 t=1.2e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=2 t=6.8e-05 per=1.9e+01 cost=3.7e+02 flops=5.5e+06
 renorm[gemm] counter=18 i=3 t=6.1e-05 per=1.7e+01 cost=6.9e+02 flops=1.1e+07
 renorm[gemm] counter=18 i=4 t=1.2e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=5 t=1.2e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=6 t=5.1e-05 per=1.4e+01 cost=8.4e+02 flops=1.7e+07
 renorm[gemm] counter=18 total t=1.8e-04 per=5.2e+01 cost=1.9e+03 flops=1.0e+07
 renorm[red] counter=18 t=1.1e-04 per=3.0e+01 cost=5.3e+02 flops=4.9e+06
--- TIMING FOR renorm_tot : t_inter=4.1e-03 t_gemm=4.6e-02 t_reduction=7.5e-03 tot=5.8e-02 ---
 renorm_tot[inter] counter=18 t=4.1e-03 per=7.1e+00 cost=7.2e+07 flops=1.8e+10
 renorm_tot[gemm] counter=18 i=0 t=2.9e-05 per=4.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=1 t=2.2e-05 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=2 t=1.0e-02 per=1.8e+01 cost=2.2e+07 flops=2.1e+09
 renorm_tot[gemm] counter=18 i=3 t=1.7e-02 per=3.0e+01 cost=5.0e+07 flops=2.9e+09
 renorm_tot[gemm] counter=18 i=4 t=2.3e-05 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=5 t=2.2e-05 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=6 t=1.9e-02 per=3.2e+01 cost=7.7e+07 flops=4.1e+09
 renorm_tot[gemm] counter=18 total t=4.6e-02 per=8.0e+01 cost=1.5e+08 flops=3.2e+09
 renorm_tot[red] counter=18 t=7.5e-03 per=1.3e+01 cost=9.3e+06 flops=1.2e+09
qops.to_cpu: size(tot)=50:3.8e-04MB:3.7e-07GB t[to_cpu]=1.2e-05S speed=3.1e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00416 S rank=0 -----
##### local oper_env: 1.430e-02 S #####
 T(local oper_env: fetch) = 8.792e-03 S  per = 61.5  per(accum) = 61.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 61.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 61.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 61.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 61.5
 T(local oper_env: renrm) = 4.259e-03 S  per = 29.8  per(accum) = 91.3
 T(local oper_env: save ) = 1.245e-03 S  per = 8.71  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.259e-03 S  T(sum) = 4.259e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.899e-06 S  per = 0.185  per(accum) = 0.185
 T(local oper_env: qops init                    ) = 2.860e-04 S  per = 6.72  per(accum) = 6.9
 T(local oper_env: symbolic_formulae_renorm     ) = 1.185e-03 S  per = 27.8  per(accum) = 34.7
 T(local oper_env: allocate qops on gpu         ) = 1.822e-05 S  per = 0.428  per(accum) = 35.2
 T(local oper_env: site memcpy cpu2gpu          ) = 2.073e-05 S  per = 0.487  per(accum) = 35.6
 T(local oper_env: rintermediate init           ) = 5.594e-05 S  per = 1.31  per(accum) = 37
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.275e-04 S  per = 14.7  per(accum) = 51.7
 T(local oper_env: rmmtasks init                ) = 1.466e-03 S  per = 34.4  per(accum) = 86.1
 T(local oper_env: qops memset on cpu           ) = 3.000e-08 S  per = 0.000704  per(accum) = 86.1
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.524e-04 S  per = 10.6  per(accum) = 96.7
 T(local oper_env: reduction of opS & opH [nccl]) = 9.660e-07 S  per = 0.0227  per(accum) = 96.8
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.776e-05 S  per = 0.417  per(accum) = 97.2
 T(local oper_env: deallocate cpu and gpu memory) = 1.338e-05 S  per = 0.314  per(accum) = 97.5
 T(local oper_env: reduction of opS & opH [comm]) = 1.805e-05 S  per = 0.424  per(accum) = 97.9
 T(local oper_env: conversion from opAB to opPQ ) = 3.419e-06 S  per = 0.0803  per(accum) = 98
 T(local oper_env: after oper_renorm            ) = 8.488e-05 S  per = 1.99  per(accum) = 100
##### sweep oper_env: 5.427e+00 S #####
 T(sweep oper_env: fetch) = 1.706e-01 S  per = 3.14  per(accum) = 3.14
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 3.14
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 3.14
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 3.14
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 3.14
 T(sweep oper_env: renrm) = 5.226e+00 S  per = 96.3  per(accum) = 99.4
 T(sweep oper_env: save ) = 3.076e-02 S  per = 0.567  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.118e+10 S  per = -3.118e+32
 T(sweep oper_env: preprocess                  ) = -3.118e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.226e+00 S  T(sum) = 5.226e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.613e-04 S  per = 0.00309  per(accum) = 0.00309
 T(sweep oper_env: qops init                    ) = 4.176e-02 S  per = 0.799  per(accum) = 0.802
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.780e-01 S  per = 3.41  per(accum) = 4.21
 T(sweep oper_env: allocate qops on gpu         ) = 7.973e-04 S  per = 0.0153  per(accum) = 4.22
 T(sweep oper_env: site memcpy cpu2gpu          ) = 5.536e-04 S  per = 0.0106  per(accum) = 4.23
 T(sweep oper_env: rintermediate init           ) = 7.754e-03 S  per = 0.148  per(accum) = 4.38
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.623e-01 S  per = 3.11  per(accum) = 7.49
 T(sweep oper_env: rmmtasks init                ) = 9.664e-01 S  per = 18.5  per(accum) = 26
 T(sweep oper_env: qops memset on cpu           ) = 8.690e-07 S  per = 1.66e-05  per(accum) = 26
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.969e-02 S  per = 1.14  per(accum) = 27.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.888e-05 S  per = 0.000361  per(accum) = 27.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.367e-03 S  per = 0.0453  per(accum) = 27.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.122e-03 S  per = 0.0406  per(accum) = 27.2
 T(sweep oper_env: reduction of opS & opH [comm]) = 6.628e-04 S  per = 0.0127  per(accum) = 27.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.794e+00 S  per = 72.6  per(accum) = 99.8
 T(sweep oper_env: after oper_renorm            ) = 8.987e-03 S  per = 0.172  per(accum) = 100

idx=19 coord=(0,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHPQ nops=C:38 S:2 H:1 P:1 Q:3 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=50:0.000381MB:3.73e-07GB
ctns::oper_renorm coord=(0,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:40 S:0 H:1 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.709e+02S Sys:1.900e+00S Total:4.728e+02S
----- TIMING FOR symbolic_formulae_renorm with size=41 : 3.972e-04 S -----
rank=0 GPUmem(GB): used=1.78e-05 (oper)=1.78e-05
rank=0 GPUmem(GB): used=1.78e-05 (oper,site)(GB)=1.78e-05,2.24e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=41
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=1.78e-05 (oper,site,rinter)=1.78e-05,2.24e-08,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0003 S size(rtasks)=41 size(Rlst2)=1 T(Rmu/Rlist)=0.000169,0.000131 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00032 S size(rtasks)=41 size(Rlst)=102 -----
rank=0 GPUmem(GB): used=1.78e-05 (oper,site,rinter,batch)=1.78e-05,2.24e-08,0,2.28e-06 blksize=1 blksize0=0 batchsize=102
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.19e-06,0.000153,5.71e-05
--- TIMING FOR renorm : t_inter=7.0e-06 t_gemm=1.5e-04 t_reduction=5.7e-05 tot=2.2e-04 ---
 renorm[inter] counter=19 t=7.0e-06 per=3.2e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=0 t=1.5e-06 per=6.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=1 t=1.2e-06 per=5.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=2 t=5.8e-05 per=2.7e+01 cost=9.6e+01 flops=1.7e+06
 renorm[gemm] counter=19 i=3 t=4.2e-05 per=1.9e+01 cost=9.6e+01 flops=2.3e+06
 renorm[gemm] counter=19 i=4 t=1.2e-06 per=5.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=5 t=1.2e-06 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=6 t=4.8e-05 per=2.2e+01 cost=2.0e+02 flops=4.3e+06
 renorm[gemm] counter=19 total t=1.5e-04 per=7.0e+01 cost=4.0e+02 flops=2.6e+06
 renorm[red] counter=19 t=5.7e-05 per=2.6e+01 cost=2.0e+02 flops=3.6e+06
--- TIMING FOR renorm_tot : t_inter=4.1e-03 t_gemm=4.6e-02 t_reduction=7.6e-03 tot=5.8e-02 ---
 renorm_tot[inter] counter=19 t=4.1e-03 per=7.1e+00 cost=7.2e+07 flops=1.7e+10
 renorm_tot[gemm] counter=19 i=0 t=3.0e-05 per=5.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=1 t=2.3e-05 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=2 t=1.0e-02 per=1.8e+01 cost=2.2e+07 flops=2.1e+09
 renorm_tot[gemm] counter=19 i=3 t=1.7e-02 per=3.0e+01 cost=5.0e+07 flops=2.9e+09
 renorm_tot[gemm] counter=19 i=4 t=2.4e-05 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=5 t=2.3e-05 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=6 t=1.9e-02 per=3.2e+01 cost=7.7e+07 flops=4.1e+09
 renorm_tot[gemm] counter=19 total t=4.6e-02 per=8.0e+01 cost=1.5e+08 flops=3.2e+09
 renorm_tot[red] counter=19 t=7.6e-03 per=1.3e+01 cost=9.3e+06 flops=1.2e+09
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB t[to_cpu]=1.1e-05S speed=6.7e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
ctns::oper_ab2pq coord=(0,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00193 S rank=0 -----
##### local oper_env: 1.206e-02 S #####
 T(local oper_env: fetch) = 8.790e-03 S  per = 72.9  per(accum) = 72.9
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 72.9
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 72.9
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 72.9
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 72.9
 T(local oper_env: renrm) = 1.993e-03 S  per = 16.5  per(accum) = 89.4
 T(local oper_env: save ) = 1.274e-03 S  per = 10.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.993e-03 S  T(sum) = 1.993e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.026e-06 S  per = 0.403  per(accum) = 0.403
 T(local oper_env: qops init                    ) = 2.205e-04 S  per = 11.1  per(accum) = 11.5
 T(local oper_env: symbolic_formulae_renorm     ) = 4.043e-04 S  per = 20.3  per(accum) = 31.8
 T(local oper_env: allocate qops on gpu         ) = 2.392e-05 S  per =  1.2  per(accum) = 33
 T(local oper_env: site memcpy cpu2gpu          ) = 2.948e-05 S  per = 1.48  per(accum) = 34.4
 T(local oper_env: rintermediate init           ) = 1.660e-05 S  per = 0.833  per(accum) = 35.3
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.270e-04 S  per = 16.4  per(accum) = 51.7
 T(local oper_env: rmmtasks init                ) = 5.579e-04 S  per =   28  per(accum) = 79.7
 T(local oper_env: qops memset on cpu           ) = 4.000e-08 S  per = 0.00201  per(accum) = 79.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.063e-04 S  per = 15.4  per(accum) = 95
 T(local oper_env: reduction of opS & opH [nccl]) = 9.060e-07 S  per = 0.0455  per(accum) = 95.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.666e-05 S  per = 0.836  per(accum) = 95.9
 T(local oper_env: deallocate cpu and gpu memory) = 8.661e-06 S  per = 0.435  per(accum) = 96.3
 T(local oper_env: reduction of opS & opH [comm]) = 1.603e-05 S  per = 0.804  per(accum) = 97.2
 T(local oper_env: conversion from opAB to opPQ ) = 3.353e-06 S  per = 0.168  per(accum) = 97.3
 T(local oper_env: after oper_renorm            ) = 5.338e-05 S  per = 2.68  per(accum) = 100
##### sweep oper_env: 5.439e+00 S #####
 T(sweep oper_env: fetch) = 1.794e-01 S  per =  3.3  per(accum) = 3.3
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 3.3
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 3.3
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 3.3
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 3.3
 T(sweep oper_env: renrm) = 5.228e+00 S  per = 96.1  per(accum) = 99.4
 T(sweep oper_env: save ) = 3.204e-02 S  per = 0.589  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.292e+10 S  per = -3.292e+32
 T(sweep oper_env: preprocess                  ) = -3.292e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.228e+00 S  T(sum) = 5.228e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.693e-04 S  per = 0.00324  per(accum) = 0.00324
 T(sweep oper_env: qops init                    ) = 4.198e-02 S  per = 0.803  per(accum) = 0.806
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.784e-01 S  per = 3.41  per(accum) = 4.22
 T(sweep oper_env: allocate qops on gpu         ) = 8.212e-04 S  per = 0.0157  per(accum) = 4.23
 T(sweep oper_env: site memcpy cpu2gpu          ) = 5.830e-04 S  per = 0.0112  per(accum) = 4.24
 T(sweep oper_env: rintermediate init           ) = 7.771e-03 S  per = 0.149  per(accum) = 4.39
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.626e-01 S  per = 3.11  per(accum) = 7.5
 T(sweep oper_env: rmmtasks init                ) = 9.669e-01 S  per = 18.5  per(accum) = 26
 T(sweep oper_env: qops memset on cpu           ) = 9.090e-07 S  per = 1.74e-05  per(accum) = 26
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.999e-02 S  per = 1.15  per(accum) = 27.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.978e-05 S  per = 0.000378  per(accum) = 27.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.383e-03 S  per = 0.0456  per(accum) = 27.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.131e-03 S  per = 0.0408  per(accum) = 27.2
 T(sweep oper_env: reduction of opS & opH [comm]) = 6.789e-04 S  per = 0.013  per(accum) = 27.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.794e+00 S  per = 72.6  per(accum) = 99.8
 T(sweep oper_env: after oper_renorm            ) = 9.041e-03 S  per = 0.173  per(accum) = 100
----- TIMING FOR ctns::oper_env_right : 5.657e+00 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.213,0.179,5.23,0.032,5.65
ctns::oper_load iomode=0 fname=./scratch/sweep/rop(0,0)
fname=./scratch/sweep/rop(0,0) size=7.45e-09GB T[load](info/setup/data/tot)=3.23e-05,0.00017,8.2e-06,0.00021 speed=3.55e-05GB/S
matrix: Hij size=(1,1)
     -1.164465409846e+02 
matrix: Sij size=(1,1)
      1.000000000000e+00 

ctns::sweep_opt maxsweep=1

ctns::oper_init_dotL isym=2 ifkr=0 singlet=0
ctns::oper_save iomode=0 fname=./scratch/sweep/lop(0,0) size=0.017822265625MB:1.74045562744e-05GB
fname=./scratch/sweep/lop(0,0) size=1.74e-05GB T[save](info/data/tot)=0.000143,9.06e-05,0.000233 speed=0.0746GB/S disk[used]=0.00695GB
----- TIMING FOR ctns::oper_init_dotL : 9.483e-03 S -----

ctns::topology::get_sweeps ifboundary=0
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(3,0)-(4,0) forward=1 cturn=0
 ibond=3 bond=(4,0)-(5,0) forward=1 cturn=0
 ibond=4 bond=(5,0)-(6,0) forward=1 cturn=0
 ibond=5 bond=(6,0)-(7,0) forward=1 cturn=0
 ibond=6 bond=(7,0)-(8,0) forward=1 cturn=0
 ibond=7 bond=(8,0)-(9,0) forward=1 cturn=0
 ibond=8 bond=(9,0)-(10,0) forward=1 cturn=0
 ibond=9 bond=(10,0)-(11,0) forward=1 cturn=0
 ibond=10 bond=(11,0)-(12,0) forward=1 cturn=0
 ibond=11 bond=(12,0)-(13,0) forward=1 cturn=0
 ibond=12 bond=(13,0)-(14,0) forward=1 cturn=0
 ibond=13 bond=(14,0)-(15,0) forward=1 cturn=0
 ibond=14 bond=(15,0)-(16,0) forward=1 cturn=0
 ibond=15 bond=(16,0)-(17,0) forward=1 cturn=0
 ibond=16 bond=(17,0)-(18,0) forward=1 cturn=0
 ibond=17 bond=(17,0)-(18,0) forward=0 cturn=0
 ibond=18 bond=(16,0)-(17,0) forward=0 cturn=0
 ibond=19 bond=(15,0)-(16,0) forward=0 cturn=0
 ibond=20 bond=(14,0)-(15,0) forward=0 cturn=0
 ibond=21 bond=(13,0)-(14,0) forward=0 cturn=0
 ibond=22 bond=(12,0)-(13,0) forward=0 cturn=0
 ibond=23 bond=(11,0)-(12,0) forward=0 cturn=0
 ibond=24 bond=(10,0)-(11,0) forward=0 cturn=0
 ibond=25 bond=(9,0)-(10,0) forward=0 cturn=0
 ibond=26 bond=(8,0)-(9,0) forward=0 cturn=0
 ibond=27 bond=(7,0)-(8,0) forward=0 cturn=0
 ibond=28 bond=(6,0)-(7,0) forward=0 cturn=0
 ibond=29 bond=(5,0)-(6,0) forward=0 cturn=0
 ibond=30 bond=(4,0)-(5,0) forward=0 cturn=0
 ibond=31 bond=(3,0)-(4,0) forward=0 cturn=0
 ibond=32 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=33 bond=(1,0)-(2,0) forward=0 cturn=0
..... end of get_sweeps .....

======================================================================
sweep parameters: isweep=0 dots=1 dcut=100 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=1 sym_state=(30,0) singlet=0
qtensor3: site0new own=1 _data=0x5290ad90
qinfo3: site0new sym=(0,0) dir=1,0,1
 qbond: qrow nsym=1 dimAll=1
 (0,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=4 nblocks=16 size=4:3.05e-05MB
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=14591:0.111MB:0.000109GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=10:7.63e-05MB:7.45e-08GB
total mem of comb=14749:0.113MB:0.00011GB

isweep=0 ibond=0/seqsize=34 dots=1 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.709e+02S Sys:1.901e+00S Total:4.728e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=14591:1.113e-01MB:1.087e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=10:7.629e-05MB:7.451e-08GB
total mem of comb=14749:1.125e-01MB:1.099e-04GB
ctns::topology::check_partition: (sl,sr,sc)=1,18,1
 suppl= 0
 suppr= 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 1
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(2,0)
 fqop[2]=./scratch/sweep/cop(1,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 rqops: oplist=CSHPQ nops=C:36 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=6,6 size(op)=10:7.629e-05MB size(tot)=207:1.579e-03MB:1.542e-06GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=4879:3.722e-02MB:3.635e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
wf3(diml,dimr,dimc)=(4,6,4) nnz=10:7.629e-05MB
qtensor3: wf3 own=1 _data=0x52899390
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=4 dimAll=6
 (27,-1):2 (27,1):2 (26,0):1 (28,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=6 nblocks=64 size=10:7.629e-05MB
### DIAG TIMING: total=2.537e-04 t1=8.422e-06, t2=8.653e-06, t3=8.936e-05, t4=9.240e-05, t5=1.081e-05, t6=4.044e-05, t7=3.587e-06
duration_diagGPU:2.658e-04
duration_diagreduce:5.000e-08
duration_diagtransform:4.230e-07
----- TIMING FOR symbolic_formulae_onedot with size=123 : 1.462e-03 S -----
rank=0 GPUmem(GB): used=3.64e-05 (oper)=3.64e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=123
 no. of hintermediate operators=20
 no. of coefficients=360:0.00275MB:2.68e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.528e-05 S -----
rank=0 GPUmem(GB): used=3.9e-05 (oper,hinter)=3.64e-05,2.68e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.000668 S size(H_formulae)=123 size(Hxlst2)=6 T(Hmu/Hxlist)=0.000243,0.000425 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.000708 S size(H_formulae)=123 size(Hxlst)=386 -----
rank=0 GPUmem(GB): used=5.93e-05 (oper,hinter,dvdson,batch)=3.64e-05,2.68e-06,1.49e-07,2.01e-05 blksize=2 blksize0=2 batchsize=386
ctns::pdvdsonSolver_nkr::solve_iter ndim=10 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.28e-05,6.84e-05,0.00023,0.000174,0.000513
 ndim=10:7.45e-08GB t[comm(intra)]=1.89e-05 speed=0.00788GB/S t[comm(inter)]=1.39e-05 speed=0.0107GB/S
--- TIMING FOR sigma : t_inter=6.8e-05 t_gemm=2.3e-04 t_reduction=1.7e-04 tot=4.7e-04 ---
 sigma[inter] counter=1 t=6.8e-05 per=1.4e+01 cost=2.4e+03 flops=3.6e+07
 sigma[gemm] counter=1 i=0 t=1.4e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=1 t=1.3e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=2 t=6.9e-05 per=1.5e+01 cost=7.4e+02 flops=1.1e+07
 sigma[gemm] counter=1 i=3 t=6.1e-05 per=1.3e+01 cost=7.4e+02 flops=1.2e+07
 sigma[gemm] counter=1 i=4 t=4.8e-05 per=1.0e+01 cost=3.5e+02 flops=7.2e+06
 sigma[gemm] counter=1 i=5 t=4.8e-05 per=1.0e+01 cost=3.7e+02 flops=7.8e+06
 sigma[gemm] counter=1 total t=2.3e-04 per=4.9e+01 cost=2.2e+03 flops=9.6e+06
 sigma[red] counter=1 t=1.7e-04 per=3.7e+01 cost=1.2e+03 flops=7.0e+06
--- TIMING FOR sigma_tot : t_inter=6.8e-05 t_gemm=2.3e-04 t_reduction=1.7e-04 tot=4.7e-04 ---
 sigma_tot[inter] counter=1 t=6.8e-05 per=1.4e+01 cost=2.4e+03 flops=3.6e+07
 sigma_tot[gemm] counter=1 i=0 t=1.4e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=1 t=1.3e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=2 t=6.9e-05 per=1.5e+01 cost=7.4e+02 flops=1.1e+07
 sigma_tot[gemm] counter=1 i=3 t=6.1e-05 per=1.3e+01 cost=7.4e+02 flops=1.2e+07
 sigma_tot[gemm] counter=1 i=4 t=4.8e-05 per=1.0e+01 cost=3.5e+02 flops=7.2e+06
 sigma_tot[gemm] counter=1 i=5 t=4.8e-05 per=1.0e+01 cost=3.7e+02 flops=7.8e+06
 sigma_tot[gemm] counter=1 total t=2.3e-04 per=4.9e+01 cost=2.2e+03 flops=9.6e+06
 sigma_tot[red] counter=1 t=1.7e-04 per=3.7e+01 cost=1.2e+03 flops=7.0e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,1.2e-05,3.4e-06,6.1e-07,1.7e-07
settings: ndim=10 neig=1 maxcycle=30 nbuff=4 memory=1e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.446540984635 -1.116e+03  1.854e-03    1     1  6.738e-04 6.738e-04 6.308e-04
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.691e-05,7.926e-05,2.728e-04,1.391e-04,5.257e-04
 ndim=10:7.451e-08GB t[comm(intra)]=2.148e-05 speed=6.938e-03GB/S t[comm(inter)]=5.429e-06 speed=2.745e-02GB/S
--- TIMING FOR sigma : t_inter=7.9e-05 t_gemm=2.7e-04 t_reduction=1.4e-04 tot=4.9e-04 ---
 sigma[inter] counter=2 t=7.9e-05 per=1.6e+01 cost=2.4e+03 flops=3.1e+07
 sigma[gemm] counter=2 i=0 t=2.0e-06 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=1 t=1.8e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=2 t=8.9e-05 per=1.8e+01 cost=7.4e+02 flops=8.2e+06
 sigma[gemm] counter=2 i=3 t=7.1e-05 per=1.4e+01 cost=7.4e+02 flops=1.0e+07
 sigma[gemm] counter=2 i=4 t=5.4e-05 per=1.1e+01 cost=3.5e+02 flops=6.4e+06
 sigma[gemm] counter=2 i=5 t=5.4e-05 per=1.1e+01 cost=3.7e+02 flops=7.0e+06
 sigma[gemm] counter=2 total t=2.7e-04 per=5.5e+01 cost=2.2e+03 flops=8.1e+06
 sigma[red] counter=2 t=1.4e-04 per=2.8e+01 cost=1.2e+03 flops=8.7e+06
--- TIMING FOR sigma_tot : t_inter=1.5e-04 t_gemm=5.0e-04 t_reduction=3.1e-04 tot=9.6e-04 ---
 sigma_tot[inter] counter=2 t=1.5e-04 per=1.5e+01 cost=4.9e+03 flops=3.3e+07
 sigma_tot[gemm] counter=2 i=0 t=3.4e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=1 t=3.1e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=2 t=1.6e-04 per=1.6e+01 cost=1.5e+03 flops=9.3e+06
 sigma_tot[gemm] counter=2 i=3 t=1.3e-04 per=1.4e+01 cost=1.5e+03 flops=1.1e+07
 sigma_tot[gemm] counter=2 i=4 t=1.0e-04 per=1.1e+01 cost=6.9e+02 flops=6.7e+06
 sigma_tot[gemm] counter=2 i=5 t=1.0e-04 per=1.1e+01 cost=7.5e+02 flops=7.4e+06
 sigma_tot[gemm] counter=2 total t=5.0e-04 per=5.2e+01 cost=4.4e+03 flops=8.8e+06
 sigma_tot[red] counter=2 t=3.1e-04 per=3.3e+01 cost=2.4e+03 flops=7.7e+06
T(sub)=6.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,5.1e-05,3.7e-06,1.9e-06,2.6e-07
    2   0 -    -116.446552892441 -1.191e-05  5.374e-04    2     2  6.390e-03 3.195e-03 6.473e-04
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.471e-05,7.853e-05,2.515e-04,1.353e-04,4.956e-04
 ndim=10:7.451e-08GB t[comm(intra)]=2.084e-05 speed=7.149e-03GB/S t[comm(inter)]=3.864e-06 speed=3.856e-02GB/S
--- TIMING FOR sigma : t_inter=7.8e-05 t_gemm=2.5e-04 t_reduction=1.4e-04 tot=4.6e-04 ---
 sigma[inter] counter=3 t=7.8e-05 per=1.7e+01 cost=2.4e+03 flops=3.1e+07
 sigma[gemm] counter=3 i=0 t=2.0e-06 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=1 t=1.7e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=2 t=7.2e-05 per=1.6e+01 cost=7.4e+02 flops=1.0e+07
 sigma[gemm] counter=3 i=3 t=6.8e-05 per=1.5e+01 cost=7.4e+02 flops=1.1e+07
 sigma[gemm] counter=3 i=4 t=5.3e-05 per=1.1e+01 cost=3.5e+02 flops=6.5e+06
 sigma[gemm] counter=3 i=5 t=5.3e-05 per=1.1e+01 cost=3.7e+02 flops=7.0e+06
 sigma[gemm] counter=3 total t=2.5e-04 per=5.4e+01 cost=2.2e+03 flops=8.8e+06
 sigma[red] counter=3 t=1.4e-04 per=2.9e+01 cost=1.2e+03 flops=9.0e+06
--- TIMING FOR sigma_tot : t_inter=2.3e-04 t_gemm=7.5e-04 t_reduction=4.5e-04 tot=1.4e-03 ---
 sigma_tot[inter] counter=3 t=2.3e-04 per=1.6e+01 cost=7.3e+03 flops=3.3e+07
 sigma_tot[gemm] counter=3 i=0 t=5.4e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=1 t=4.8e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=2 t=2.3e-04 per=1.6e+01 cost=2.2e+03 flops=9.6e+06
 sigma_tot[gemm] counter=3 i=3 t=2.0e-04 per=1.4e+01 cost=2.2e+03 flops=1.1e+07
 sigma_tot[gemm] counter=3 i=4 t=1.6e-04 per=1.1e+01 cost=1.0e+03 flops=6.7e+06
 sigma_tot[gemm] counter=3 i=5 t=1.5e-04 per=1.1e+01 cost=1.1e+03 flops=7.2e+06
 sigma_tot[gemm] counter=3 total t=7.5e-04 per=5.3e+01 cost=6.6e+03 flops=8.8e+06
 sigma_tot[red] counter=3 t=4.5e-04 per=3.1e+01 cost=3.6e+03 flops=8.1e+06
T(sub)=3.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,2.7e-05,3.0e-06,1.3e-06,2.1e-07
    3   0 +    -116.446553669725 -7.773e-07  3.049e-05    3     3  1.542e-02 5.139e-03 6.422e-04
TIMING FOR Davidson : 1.543e-02  T(cal/comm/rest)=1.927e-03,4.120e-07,1.350e-02
decomposed t_rest=1.350e-02
 T(sub)    =1.157e-04 per=8.570e-01
 T(precond)=1.328e-02 per=9.838e+01
 T(ortho)  =1.093e-05 per=8.099e-02
 T(xcopy)  =6.400e-07 per=4.741e-03
 T(xnrm2)  =1.412e-06 per=1.046e-02
 T(other)  =9.057e-05 per=6.709e-01
optimized energies: isweep=0 ibond=0 dots=1 e[0]=-116.446553669725 nmvp=3
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.725e+02S Sys:1.902e+00S Total:4.744e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=9 alg_decim=1 mpisize=1
 qbond: qsuper nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
----- TIMING FOR onedot_decimation: 1.8e-04 S T(wf/decim)=9.3e-05,9.1e-05 -----
ctns::oper_renorm coord=(1,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:4 S:36 H:1 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1352:1.0e-02MB:1.0e-05GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.727e+02S Sys:1.902e+00S Total:4.746e+02S
----- TIMING FOR symbolic_formulae_renorm with size=57 : 1.896e-03 S -----
rank=0 GPUmem(GB): used=4.76e-05 (oper)=4.49e-05
rank=0 GPUmem(GB): used=4.78e-05 (oper,site)(GB)=4.49e-05,2.68e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=4.78e-05 (oper,site,rinter)=4.49e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00276 S size(rtasks)=57 size(Rlst2)=81 T(Rmu/Rlist)=0.000782,0.00198 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00293 S size(rtasks)=57 size(Rlst)=1636 -----
rank=0 GPUmem(GB): used=4.78e-05 (oper,site,rinter,batch)=4.49e-05,2.68e-07,0,0.000402 blksize=16 blksize0=0 batchsize=1636
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.09e-06,0.000298,0.000181
--- TIMING FOR renorm : t_inter=8.7e-06 t_gemm=3.0e-04 t_reduction=1.8e-04 tot=4.9e-04 ---
 renorm[inter] counter=1 t=8.7e-06 per=1.8e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=1.7e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=1.2e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=1.2e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=3 t=1.1e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=4 t=9.6e-05 per=2.0e+01 cost=3.7e+03 flops=3.9e+07
 renorm[gemm] counter=1 i=5 t=6.4e-05 per=1.3e+01 cost=2.4e+03 flops=3.8e+07
 renorm[gemm] counter=1 i=6 t=1.3e-04 per=2.7e+01 cost=1.9e+04 flops=1.4e+08
 renorm[gemm] counter=1 total t=3.0e-04 per=6.1e+01 cost=2.5e+04 flops=8.4e+07
 renorm[red] counter=1 t=1.8e-04 per=3.7e+01 cost=1.9e+04 flops=1.0e+08
--- TIMING FOR renorm_tot : t_inter=8.7e-06 t_gemm=3.0e-04 t_reduction=1.8e-04 tot=4.9e-04 ---
 renorm_tot[inter] counter=1 t=8.7e-06 per=1.8e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=1.7e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=1.2e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=1.2e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=3 t=1.1e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=4 t=9.6e-05 per=2.0e+01 cost=3.7e+03 flops=3.9e+07
 renorm_tot[gemm] counter=1 i=5 t=6.4e-05 per=1.3e+01 cost=2.4e+03 flops=3.8e+07
 renorm_tot[gemm] counter=1 i=6 t=1.3e-04 per=2.7e+01 cost=1.9e+04 flops=1.4e+08
 renorm_tot[gemm] counter=1 total t=3.0e-04 per=6.1e+01 cost=2.5e+04 flops=8.4e+07
 renorm_tot[red] counter=1 t=1.8e-04 per=3.7e+01 cost=1.9e+04 flops=1.0e+08
qops.to_cpu: size(tot)=1352:1.0e-02MB:1.0e-05GB t[to_cpu]=1.4e-05S speed=7.3e-01GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0165 S rank=0 -----
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.733e+02S Sys:1.902e+00S Total:4.752e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=14617:1.115e-01MB:1.089e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=38:2.899e-04MB:2.831e-07GB
total mem of comb=14803:1.129e-01MB:1.103e-04GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.733e+02S Sys:1.902e+00S Total:4.752e+02S
##### local opt: 5.709e-02 S #####
 T(local opt: fetch) = 1.776e-02 S  per = 31.1  per(accum) = 31.1
 T(local opt: hdiag) = 3.035e-04 S  per = 0.532  per(accum) = 31.6
 T(local opt: dvdsn) = 1.969e-02 S  per = 34.5  per(accum) = 66.1
 T(local opt: decim) = 1.966e-04 S  per = 0.344  per(accum) = 66.5
 T(local opt: guess) = 1.111e-04 S  per = 0.195  per(accum) = 66.7
 T(local opt: renrm) = 1.680e-02 S  per = 29.4  per(accum) = 96.1
 T(local opt: save ) = 2.220e-03 S  per = 3.89  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.969e-02 S  T(sum) = 1.940e-02 S  per = 9.853e+01
 T(local opt: preprocess                  ) = 1.339e-04 S  per = 0.69  per(accum) = 0.69
 T(local opt: symbolic_formulae           ) = 1.470e-03 S  per = 7.58  per(accum) = 8.27
 T(local opt: hintermediate init          ) = 6.531e-05 S  per = 0.337  per(accum) = 8.6
 T(local opt: preprocess_hformulae_Hxlist ) = 7.224e-04 S  per = 3.72  per(accum) = 12.3
 T(local opt: hmmtasks init               ) = 1.583e-03 S  per = 8.16  per(accum) = 20.5
 T(local opt: initial guess for dvdson    ) = 2.859e-06 S  per = 0.0147  per(accum) = 20.5
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.842e-03 S  per = 9.49  per(accum) = 30
 T(local opt: dvdson solver [comm(gpu)]   ) = 8.439e-05 S  per = 0.435  per(accum) = 30.4
 T(local opt: dvdson solver [comm(cpu)]   ) = 4.120e-07 S  per = 0.00212  per(accum) = 30.4
 T(local opt: dvdson solver [rest part]   ) = 1.350e-02 S  per = 69.6  per(accum) = 100
Detailed decomposition of T(renrm) = 1.680e-02 S  T(sum) = 1.680e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 9.621e-05 S  per = 0.573  per(accum) = 0.573
 T(local opt: qops init                    ) = 1.053e-03 S  per = 6.27  per(accum) = 6.84
 T(local opt: symbolic_formulae_renorm     ) = 1.905e-03 S  per = 11.3  per(accum) = 18.2
 T(local opt: allocate qops on gpu         ) = 2.608e-05 S  per = 0.155  per(accum) = 18.3
 T(local opt: site memcpy cpu2gpu          ) = 2.097e-05 S  per = 0.125  per(accum) = 18.5
 T(local opt: rintermediate init           ) = 3.077e-05 S  per = 0.183  per(accum) = 18.6
 T(local opt: preprocess_formulae_Rlist2   ) = 2.995e-03 S  per = 17.8  per(accum) = 36.5
 T(local opt: rmmtasks init                ) = 9.793e-03 S  per = 58.3  per(accum) = 94.7
 T(local opt: qops memset on cpu           ) = 6.000e-08 S  per = 0.000357  per(accum) = 94.7
 T(local opt: preprocess_renorm_batchGPU   ) = 5.836e-04 S  per = 3.47  per(accum) = 98.2
 T(local opt: reduction of opS & opH [nccl]) = 1.044e-06 S  per = 0.00621  per(accum) = 98.2
 T(local opt: qops memcpy gpu2cpu          ) = 1.926e-05 S  per = 0.115  per(accum) = 98.3
 T(local opt: deallocate cpu and gpu memory) = 9.765e-06 S  per = 0.0581  per(accum) = 98.4
 T(local opt: reduction of opS & opH [comm]) = 2.637e-05 S  per = 0.157  per(accum) = 98.5
 T(local opt: conversion from opAB to opPQ ) = 3.513e-06 S  per = 0.0209  per(accum) = 98.6
 T(local opt: after oper_renorm            ) = 2.411e-04 S  per = 1.43  per(accum) = 100
##### sweep opt: 5.709e-02 S #####
 T(sweep opt: fetch) = 1.776e-02 S  per = 31.1  per(accum) = 31.1
 T(sweep opt: hdiag) = 3.035e-04 S  per = 0.532  per(accum) = 31.6
 T(sweep opt: dvdsn) = 1.969e-02 S  per = 34.5  per(accum) = 66.1
 T(sweep opt: decim) = 1.966e-04 S  per = 0.344  per(accum) = 66.5
 T(sweep opt: guess) = 1.111e-04 S  per = 0.195  per(accum) = 66.7
 T(sweep opt: renrm) = 1.680e-02 S  per = 29.4  per(accum) = 96.1
 T(sweep opt: save ) = 2.220e-03 S  per = 3.89  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.969e-02 S  T(sum) = 1.940e-02 S  per = 9.853e+01
 T(sweep opt: preprocess                  ) = 1.339e-04 S  per = 0.69  per(accum) = 0.69
 T(sweep opt: symbolic_formulae           ) = 1.470e-03 S  per = 7.58  per(accum) = 8.27
 T(sweep opt: hintermediate init          ) = 6.531e-05 S  per = 0.337  per(accum) = 8.6
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.224e-04 S  per = 3.72  per(accum) = 12.3
 T(sweep opt: hmmtasks init               ) = 1.583e-03 S  per = 8.16  per(accum) = 20.5
 T(sweep opt: initial guess for dvdson    ) = 2.859e-06 S  per = 0.0147  per(accum) = 20.5
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.842e-03 S  per = 9.49  per(accum) = 30
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 8.439e-05 S  per = 0.435  per(accum) = 30.4
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 4.120e-07 S  per = 0.00212  per(accum) = 30.4
 T(sweep opt: dvdson solver [rest part]   ) = 1.350e-02 S  per = 69.6  per(accum) = 100
Detailed decomposition of T(renrm) = 1.680e-02 S  T(sum) = 1.680e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.621e-05 S  per = 0.573  per(accum) = 0.573
 T(sweep opt: qops init                    ) = 1.053e-03 S  per = 6.27  per(accum) = 6.84
 T(sweep opt: symbolic_formulae_renorm     ) = 1.905e-03 S  per = 11.3  per(accum) = 18.2
 T(sweep opt: allocate qops on gpu         ) = 2.608e-05 S  per = 0.155  per(accum) = 18.3
 T(sweep opt: site memcpy cpu2gpu          ) = 2.097e-05 S  per = 0.125  per(accum) = 18.5
 T(sweep opt: rintermediate init           ) = 3.077e-05 S  per = 0.183  per(accum) = 18.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.995e-03 S  per = 17.8  per(accum) = 36.5
 T(sweep opt: rmmtasks init                ) = 9.793e-03 S  per = 58.3  per(accum) = 94.7
 T(sweep opt: qops memset on cpu           ) = 6.000e-08 S  per = 0.000357  per(accum) = 94.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.836e-04 S  per = 3.47  per(accum) = 98.2
 T(sweep opt: reduction of opS & opH [nccl]) = 1.044e-06 S  per = 0.00621  per(accum) = 98.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.926e-05 S  per = 0.115  per(accum) = 98.3
 T(sweep opt: deallocate cpu and gpu memory) = 9.765e-06 S  per = 0.0581  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [comm]) = 2.637e-05 S  per = 0.157  per(accum) = 98.5
 T(sweep opt: conversion from opAB to opPQ ) = 3.513e-06 S  per = 0.0209  per(accum) = 98.6
 T(sweep opt: after oper_renorm            ) = 2.411e-04 S  per = 1.43  per(accum) = 100
##### global opt: 5.709e-02 S #####
 T(global opt: fetch) = 1.776e-02 S  per = 31.1  per(accum) = 31.1
 T(global opt: hdiag) = 3.035e-04 S  per = 0.532  per(accum) = 31.6
 T(global opt: dvdsn) = 1.969e-02 S  per = 34.5  per(accum) = 66.1
 T(global opt: decim) = 1.966e-04 S  per = 0.344  per(accum) = 66.5
 T(global opt: guess) = 1.111e-04 S  per = 0.195  per(accum) = 66.7
 T(global opt: renrm) = 1.680e-02 S  per = 29.4  per(accum) = 96.1
 T(global opt: save ) = 2.220e-03 S  per = 3.89  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.969e-02 S  T(sum) = 1.940e-02 S  per = 9.853e+01
 T(global opt: preprocess                  ) = 1.339e-04 S  per = 0.69  per(accum) = 0.69
 T(global opt: symbolic_formulae           ) = 1.470e-03 S  per = 7.58  per(accum) = 8.27
 T(global opt: hintermediate init          ) = 6.531e-05 S  per = 0.337  per(accum) = 8.6
 T(global opt: preprocess_hformulae_Hxlist ) = 7.224e-04 S  per = 3.72  per(accum) = 12.3
 T(global opt: hmmtasks init               ) = 1.583e-03 S  per = 8.16  per(accum) = 20.5
 T(global opt: initial guess for dvdson    ) = 2.859e-06 S  per = 0.0147  per(accum) = 20.5
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.842e-03 S  per = 9.49  per(accum) = 30
 T(global opt: dvdson solver [comm(gpu)]   ) = 8.439e-05 S  per = 0.435  per(accum) = 30.4
 T(global opt: dvdson solver [comm(cpu)]   ) = 4.120e-07 S  per = 0.00212  per(accum) = 30.4
 T(global opt: dvdson solver [rest part]   ) = 1.350e-02 S  per = 69.6  per(accum) = 100
Detailed decomposition of T(renrm) = 1.680e-02 S  T(sum) = 1.680e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.621e-05 S  per = 0.573  per(accum) = 0.573
 T(global opt: qops init                    ) = 1.053e-03 S  per = 6.27  per(accum) = 6.84
 T(global opt: symbolic_formulae_renorm     ) = 1.905e-03 S  per = 11.3  per(accum) = 18.2
 T(global opt: allocate qops on gpu         ) = 2.608e-05 S  per = 0.155  per(accum) = 18.3
 T(global opt: site memcpy cpu2gpu          ) = 2.097e-05 S  per = 0.125  per(accum) = 18.5
 T(global opt: rintermediate init           ) = 3.077e-05 S  per = 0.183  per(accum) = 18.6
 T(global opt: preprocess_formulae_Rlist2   ) = 2.995e-03 S  per = 17.8  per(accum) = 36.5
 T(global opt: rmmtasks init                ) = 9.793e-03 S  per = 58.3  per(accum) = 94.7
 T(global opt: qops memset on cpu           ) = 6.000e-08 S  per = 0.000357  per(accum) = 94.7
 T(global opt: preprocess_renorm_batchGPU   ) = 5.836e-04 S  per = 3.47  per(accum) = 98.2
 T(global opt: reduction of opS & opH [nccl]) = 1.044e-06 S  per = 0.00621  per(accum) = 98.2
 T(global opt: qops memcpy gpu2cpu          ) = 1.926e-05 S  per = 0.115  per(accum) = 98.3
 T(global opt: deallocate cpu and gpu memory) = 9.765e-06 S  per = 0.0581  per(accum) = 98.4
 T(global opt: reduction of opS & opH [comm]) = 2.637e-05 S  per = 0.157  per(accum) = 98.5
 T(global opt: conversion from opAB to opPQ ) = 3.513e-06 S  per = 0.0209  per(accum) = 98.6
 T(global opt: after oper_renorm            ) = 2.411e-04 S  per = 1.43  per(accum) = 100

isweep=0 ibond=1/seqsize=34 dots=1 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.733e+02S Sys:1.902e+00S Total:4.752e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=14617:1.115e-01MB:1.089e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=38:2.899e-04MB:2.831e-07GB
total mem of comb=14803:1.129e-01MB:1.103e-04GB
ctns::topology::check_partition: (sl,sr,sc)=2,17,1
 suppl= 0 1
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 2
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:4 S:36 H:1 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:2.747e-04MB size(tot)=1352:1.031e-02MB:1.007e-05GB
 rqops: oplist=CSHPQ nops=C:34 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=10,10 size(op)=24:1.831e-04MB size(tot)=822:6.271e-03MB:6.124e-06GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=4510:3.441e-02MB:3.360e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
wf3(diml,dimr,dimc)=(16,10,4) nnz=38:2.899e-04MB
qtensor3: wf3 own=1 _data=0x51350050
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
 qbond: qcol nsym=5 dimAll=10
 (25,-1):3 (26,-2):3 (26,0):2 (27,-3):1 (24,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=10 nblocks=180 size=38:2.899e-04MB
### DIAG TIMING: total=2.847e-04 t1=9.069e-06, t2=2.206e-05, t3=2.031e-05, t4=2.050e-04, t5=1.140e-05, t6=1.332e-05, t7=3.547e-06
duration_diagGPU:2.976e-04
duration_diagreduce:3.100e-08
duration_diagtransform:4.550e-07
----- TIMING FOR symbolic_formulae_onedot with size=193 : 3.182e-03 S -----
rank=0 GPUmem(GB): used=3.36e-05 (oper)=3.36e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=193
 no. of hintermediate operators=58
 no. of coefficients=986:0.00752MB:7.35e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.697e-05 S -----
rank=0 GPUmem(GB): used=4.09e-05 (oper,hinter)=3.36e-05,7.35e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00153 S size(H_formulae)=193 size(Hxlst2)=10 T(Hmu/Hxlist)=0.000393,0.00114 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00162 S size(H_formulae)=193 size(Hxlst)=1038 -----
rank=0 GPUmem(GB): used=0.000304 (oper,hinter,dvdson,batch)=3.36e-05,7.35e-06,5.66e-07,0.000263 blksize=12 blksize0=9 batchsize=1038
ctns::pdvdsonSolver_nkr::solve_iter ndim=38 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.35e-05,8.06e-05,0.00072,0.000183,0.00102
 ndim=38:2.83e-07GB t[comm(intra)]=2.86e-05 speed=0.0198GB/S t[comm(inter)]=4.88e-06 speed=0.116GB/S
--- TIMING FOR sigma : t_inter=8.0e-05 t_gemm=7.2e-04 t_reduction=1.8e-04 tot=9.8e-04 ---
 sigma[inter] counter=4 t=8.0e-05 per=8.2e+00 cost=3.5e+04 flops=4.3e+08
 sigma[gemm] counter=4 i=0 t=1.5e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=1 t=1.3e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=2 t=1.7e-04 per=1.7e+01 cost=8.2e+03 flops=4.9e+07
 sigma[gemm] counter=4 i=3 t=1.9e-04 per=1.9e+01 cost=7.7e+03 flops=4.0e+07
 sigma[gemm] counter=4 i=4 t=1.8e-04 per=1.8e+01 cost=6.1e+03 flops=3.4e+07
 sigma[gemm] counter=4 i=5 t=1.8e-04 per=1.8e+01 cost=6.0e+03 flops=3.3e+07
 sigma[gemm] counter=4 total t=7.2e-04 per=7.3e+01 cost=2.8e+04 flops=3.9e+07
 sigma[red] counter=4 t=1.8e-04 per=1.9e+01 cost=8.3e+03 flops=4.5e+07
--- TIMING FOR sigma_tot : t_inter=3.1e-04 t_gemm=1.5e-03 t_reduction=6.3e-04 tot=2.4e-03 ---
 sigma_tot[inter] counter=4 t=3.1e-04 per=1.3e+01 cost=4.2e+04 flops=1.4e+08
 sigma_tot[gemm] counter=4 i=0 t=6.9e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=1 t=6.1e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=2 t=4.0e-04 per=1.6e+01 cost=1.0e+04 flops=2.6e+07
 sigma_tot[gemm] counter=4 i=3 t=3.9e-04 per=1.6e+01 cost=9.9e+03 flops=2.5e+07
 sigma_tot[gemm] counter=4 i=4 t=3.4e-04 per=1.4e+01 cost=7.2e+03 flops=2.1e+07
 sigma_tot[gemm] counter=4 i=5 t=3.3e-04 per=1.4e+01 cost=7.1e+03 flops=2.1e+07
 sigma_tot[gemm] counter=4 total t=1.5e-03 per=6.1e+01 cost=3.5e+04 flops=2.3e+07
 sigma_tot[red] counter=4 t=6.3e-04 per=2.6e+01 cost=1.2e+04 flops=1.9e+07
T(sub)=9.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,4.2e-06,1.9e-06,6.3e-07,2.1e-07
settings: ndim=38 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.446553669725 -1.116e+03  7.304e-02    1     1  1.144e-03 1.144e-03 1.118e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.563e-05,9.518e-05,7.226e-04,1.821e-04,1.033e-03
 ndim=38:2.831e-07GB t[comm(intra)]=2.060e-05 speed=2.749e-02GB/S t[comm(inter)]=5.032e-06 speed=1.125e-01GB/S
--- TIMING FOR sigma : t_inter=9.5e-05 t_gemm=7.2e-04 t_reduction=1.8e-04 tot=1.0e-03 ---
 sigma[inter] counter=5 t=9.5e-05 per=9.5e+00 cost=3.5e+04 flops=3.7e+08
 sigma[gemm] counter=5 i=0 t=2.0e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=1 t=1.8e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=2 t=1.8e-04 per=1.8e+01 cost=8.2e+03 flops=4.5e+07
 sigma[gemm] counter=5 i=3 t=1.9e-04 per=1.9e+01 cost=7.7e+03 flops=4.0e+07
 sigma[gemm] counter=5 i=4 t=1.7e-04 per=1.7e+01 cost=6.1e+03 flops=3.7e+07
 sigma[gemm] counter=5 i=5 t=1.8e-04 per=1.8e+01 cost=6.0e+03 flops=3.3e+07
 sigma[gemm] counter=5 total t=7.2e-04 per=7.2e+01 cost=2.8e+04 flops=3.9e+07
 sigma[red] counter=5 t=1.8e-04 per=1.8e+01 cost=8.3e+03 flops=4.6e+07
--- TIMING FOR sigma_tot : t_inter=4.0e-04 t_gemm=2.2e-03 t_reduction=8.1e-04 tot=3.4e-03 ---
 sigma_tot[inter] counter=5 t=4.0e-04 per=1.2e+01 cost=7.7e+04 flops=1.9e+08
 sigma_tot[gemm] counter=5 i=0 t=8.9e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=1 t=7.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=2 t=5.8e-04 per=1.7e+01 cost=1.9e+04 flops=3.2e+07
 sigma_tot[gemm] counter=5 i=3 t=5.8e-04 per=1.7e+01 cost=1.8e+04 flops=3.0e+07
 sigma_tot[gemm] counter=5 i=4 t=5.0e-04 per=1.5e+01 cost=1.3e+04 flops=2.6e+07
 sigma_tot[gemm] counter=5 i=5 t=5.1e-04 per=1.5e+01 cost=1.3e+04 flops=2.5e+07
 sigma_tot[gemm] counter=5 total t=2.2e-03 per=6.4e+01 cost=6.2e+04 flops=2.8e+07
 sigma_tot[red] counter=5 t=8.1e-04 per=2.4e+01 cost=2.0e+04 flops=2.5e+07
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.2e-05,3.7e-06,1.2e-06,2.5e-07
    2   0 -    -116.456269522721 -9.716e-03  1.427e-02    2     2  1.188e-02 5.942e-03 1.138e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.271e-05,8.861e-05,7.211e-04,1.788e-04,1.017e-03
 ndim=38:2.831e-07GB t[comm(intra)]=1.871e-05 speed=3.027e-02GB/S t[comm(inter)]=4.008e-06 speed=1.413e-01GB/S
--- TIMING FOR sigma : t_inter=8.8e-05 t_gemm=7.2e-04 t_reduction=1.8e-04 tot=9.9e-04 ---
 sigma[inter] counter=6 t=8.8e-05 per=9.0e+00 cost=3.5e+04 flops=3.9e+08
 sigma[gemm] counter=6 i=0 t=1.9e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=1 t=1.8e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=2 t=1.7e-04 per=1.7e+01 cost=8.2e+03 flops=4.9e+07
 sigma[gemm] counter=6 i=3 t=1.9e-04 per=1.9e+01 cost=7.7e+03 flops=4.1e+07
 sigma[gemm] counter=6 i=4 t=1.7e-04 per=1.7e+01 cost=6.1e+03 flops=3.7e+07
 sigma[gemm] counter=6 i=5 t=1.9e-04 per=1.9e+01 cost=6.0e+03 flops=3.1e+07
 sigma[gemm] counter=6 total t=7.2e-04 per=7.3e+01 cost=2.8e+04 flops=3.9e+07
 sigma[red] counter=6 t=1.8e-04 per=1.8e+01 cost=8.3e+03 flops=4.6e+07
--- TIMING FOR sigma_tot : t_inter=4.9e-04 t_gemm=2.9e-03 t_reduction=9.9e-04 tot=4.4e-03 ---
 sigma_tot[inter] counter=6 t=4.9e-04 per=1.1e+01 cost=1.1e+05 flops=2.3e+08
 sigma_tot[gemm] counter=6 i=0 t=1.1e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=1 t=9.7e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=2 t=7.5e-04 per=1.7e+01 cost=2.7e+04 flops=3.6e+07
 sigma_tot[gemm] counter=6 i=3 t=7.7e-04 per=1.8e+01 cost=2.5e+04 flops=3.3e+07
 sigma_tot[gemm] counter=6 i=4 t=6.7e-04 per=1.5e+01 cost=1.9e+04 flops=2.9e+07
 sigma_tot[gemm] counter=6 i=5 t=7.0e-04 per=1.6e+01 cost=1.9e+04 flops=2.7e+07
 sigma_tot[gemm] counter=6 total t=2.9e-03 per=6.6e+01 cost=9.0e+04 flops=3.1e+07
 sigma_tot[red] counter=6 t=9.9e-04 per=2.3e+01 cost=2.9e+04 flops=2.9e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.5e-05,3.1e-06,1.3e-06,2.6e-07
    3   0 -    -116.456593866436 -3.243e-04  2.612e-03    3     3  2.238e-02 7.461e-03 1.137e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.386e-05,8.731e-05,7.230e-04,1.779e-04,1.018e-03
 ndim=38:2.831e-07GB t[comm(intra)]=1.984e-05 speed=2.853e-02GB/S t[comm(inter)]=4.017e-06 speed=1.410e-01GB/S
--- TIMING FOR sigma : t_inter=8.7e-05 t_gemm=7.2e-04 t_reduction=1.8e-04 tot=9.9e-04 ---
 sigma[inter] counter=7 t=8.7e-05 per=8.8e+00 cost=3.5e+04 flops=4.0e+08
 sigma[gemm] counter=7 i=0 t=2.0e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=1 t=1.8e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=2 t=1.9e-04 per=1.9e+01 cost=8.2e+03 flops=4.4e+07
 sigma[gemm] counter=7 i=3 t=1.9e-04 per=1.9e+01 cost=7.7e+03 flops=4.1e+07
 sigma[gemm] counter=7 i=4 t=1.7e-04 per=1.7e+01 cost=6.1e+03 flops=3.7e+07
 sigma[gemm] counter=7 i=5 t=1.7e-04 per=1.8e+01 cost=6.0e+03 flops=3.4e+07
 sigma[gemm] counter=7 total t=7.2e-04 per=7.3e+01 cost=2.8e+04 flops=3.9e+07
 sigma[red] counter=7 t=1.8e-04 per=1.8e+01 cost=8.3e+03 flops=4.7e+07
--- TIMING FOR sigma_tot : t_inter=5.8e-04 t_gemm=3.6e-03 t_reduction=1.2e-03 tot=5.4e-03 ---
 sigma_tot[inter] counter=7 t=5.8e-04 per=1.1e+01 cost=1.5e+05 flops=2.5e+08
 sigma_tot[gemm] counter=7 i=0 t=1.3e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=1 t=1.1e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=2 t=9.3e-04 per=1.7e+01 cost=3.5e+04 flops=3.7e+07
 sigma_tot[gemm] counter=7 i=3 t=9.6e-04 per=1.8e+01 cost=3.3e+04 flops=3.4e+07
 sigma_tot[gemm] counter=7 i=4 t=8.4e-04 per=1.6e+01 cost=2.6e+04 flops=3.1e+07
 sigma_tot[gemm] counter=7 i=5 t=8.8e-04 per=1.6e+01 cost=2.5e+04 flops=2.8e+07
 sigma_tot[gemm] counter=7 total t=3.6e-03 per=6.8e+01 cost=1.2e+05 flops=3.3e+07
 sigma_tot[red] counter=7 t=1.2e-03 per=2.2e+01 cost=3.7e+04 flops=3.2e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.4e-05,3.0e-06,1.2e-06,2.2e-07
    4   0 -    -116.456606829843 -1.296e-05  9.429e-04    3     4  3.295e-02 8.238e-03 1.145e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.270e-05,9.086e-05,7.126e-04,1.799e-04,1.012e-03
 ndim=38:2.831e-07GB t[comm(intra)]=1.860e-05 speed=3.044e-02GB/S t[comm(inter)]=4.105e-06 speed=1.379e-01GB/S
--- TIMING FOR sigma : t_inter=9.1e-05 t_gemm=7.1e-04 t_reduction=1.8e-04 tot=9.8e-04 ---
 sigma[inter] counter=8 t=9.1e-05 per=9.2e+00 cost=3.5e+04 flops=3.9e+08
 sigma[gemm] counter=8 i=0 t=2.0e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=1 t=1.8e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=2 t=1.7e-04 per=1.7e+01 cost=8.2e+03 flops=4.9e+07
 sigma[gemm] counter=8 i=3 t=1.9e-04 per=1.9e+01 cost=7.7e+03 flops=4.0e+07
 sigma[gemm] counter=8 i=4 t=1.8e-04 per=1.8e+01 cost=6.1e+03 flops=3.5e+07
 sigma[gemm] counter=8 i=5 t=1.8e-04 per=1.8e+01 cost=6.0e+03 flops=3.4e+07
 sigma[gemm] counter=8 total t=7.1e-04 per=7.2e+01 cost=2.8e+04 flops=3.9e+07
 sigma[red] counter=8 t=1.8e-04 per=1.8e+01 cost=8.3e+03 flops=4.6e+07
--- TIMING FOR sigma_tot : t_inter=6.7e-04 t_gemm=4.3e-03 t_reduction=1.3e-03 tot=6.4e-03 ---
 sigma_tot[inter] counter=8 t=6.7e-04 per=1.0e+01 cost=1.8e+05 flops=2.7e+08
 sigma_tot[gemm] counter=8 i=0 t=1.5e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=1 t=1.3e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=2 t=1.1e-03 per=1.7e+01 cost=4.3e+04 flops=3.9e+07
 sigma_tot[gemm] counter=8 i=3 t=1.1e-03 per=1.8e+01 cost=4.1e+04 flops=3.5e+07
 sigma_tot[gemm] counter=8 i=4 t=1.0e-03 per=1.6e+01 cost=3.2e+04 flops=3.1e+07
 sigma_tot[gemm] counter=8 i=5 t=1.1e-03 per=1.7e+01 cost=3.1e+04 flops=2.9e+07
 sigma_tot[gemm] counter=8 total t=4.3e-03 per=6.8e+01 cost=1.5e+05 flops=3.4e+07
 sigma_tot[red] counter=8 t=1.3e-03 per=2.1e+01 cost=4.5e+04 flops=3.3e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.4e-05,2.9e-06,1.1e-06,2.2e-07
    5   0 -    -116.456608621459 -1.792e-06  2.000e-04    3     5  4.345e-02 8.689e-03 1.142e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.326e-05,8.782e-05,7.119e-04,1.793e-04,1.008e-03
 ndim=38:2.831e-07GB t[comm(intra)]=1.929e-05 speed=2.936e-02GB/S t[comm(inter)]=3.969e-06 speed=1.427e-01GB/S
--- TIMING FOR sigma : t_inter=8.8e-05 t_gemm=7.1e-04 t_reduction=1.8e-04 tot=9.8e-04 ---
 sigma[inter] counter=9 t=8.8e-05 per=9.0e+00 cost=3.5e+04 flops=4.0e+08
 sigma[gemm] counter=9 i=0 t=1.3e-05 per=1.3e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=1 t=1.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=2 t=1.7e-04 per=1.7e+01 cost=8.2e+03 flops=4.9e+07
 sigma[gemm] counter=9 i=3 t=1.9e-04 per=1.9e+01 cost=7.7e+03 flops=4.1e+07
 sigma[gemm] counter=9 i=4 t=1.7e-04 per=1.7e+01 cost=6.1e+03 flops=3.6e+07
 sigma[gemm] counter=9 i=5 t=1.7e-04 per=1.8e+01 cost=6.0e+03 flops=3.4e+07
 sigma[gemm] counter=9 total t=7.1e-04 per=7.3e+01 cost=2.8e+04 flops=3.9e+07
 sigma[red] counter=9 t=1.8e-04 per=1.8e+01 cost=8.3e+03 flops=4.6e+07
--- TIMING FOR sigma_tot : t_inter=7.5e-04 t_gemm=5.1e-03 t_reduction=1.5e-03 tot=7.3e-03 ---
 sigma_tot[inter] counter=9 t=7.5e-04 per=1.0e+01 cost=2.2e+05 flops=2.9e+08
 sigma_tot[gemm] counter=9 i=0 t=2.7e-05 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=1 t=1.5e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=2 t=1.3e-03 per=1.7e+01 cost=5.1e+04 flops=4.1e+07
 sigma_tot[gemm] counter=9 i=3 t=1.3e-03 per=1.8e+01 cost=4.8e+04 flops=3.6e+07
 sigma_tot[gemm] counter=9 i=4 t=1.2e-03 per=1.6e+01 cost=3.8e+04 flops=3.2e+07
 sigma_tot[gemm] counter=9 i=5 t=1.2e-03 per=1.7e+01 cost=3.7e+04 flops=3.0e+07
 sigma_tot[gemm] counter=9 total t=5.1e-03 per=6.9e+01 cost=1.7e+05 flops=3.4e+07
 sigma_tot[red] counter=9 t=1.5e-03 per=2.1e+01 cost=5.3e+04 flops=3.5e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.4e-05,3.0e-06,1.1e-06,2.1e-07
    6   0 +    -116.456608738602 -1.171e-07  3.463e-05    3     6  5.393e-02 8.988e-03 1.143e-03
TIMING FOR Davidson : 5.395e-02  T(cal/comm/rest)=6.860e-03,8.580e-07,4.709e-02
decomposed t_rest=4.709e-02
 T(sub)    =1.200e-04 per=2.548e-01
 T(precond)=4.674e-02 per=9.925e+01
 T(ortho)  =1.437e-05 per=3.051e-02
 T(xcopy)  =8.590e-07 per=1.824e-03
 T(xnrm2)  =2.565e-06 per=5.447e-03
 T(other)  =2.146e-04 per=4.557e-01
optimized energies: isweep=0 ibond=1 dots=1 e[0]=-116.456608738602 nmvp=6
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.791e+02S Sys:1.903e+00S Total:4.810e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=16 alg_decim=1 mpisize=1
 qbond: qsuper nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
decimation summary: keep all 64 states
----- TIMING FOR onedot_decimation: 2.3e-04 S T(wf/decim)=1.1e-04,1.2e-04 -----
ctns::oper_renorm coord=(2,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:6 S:34 H:1 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:3.1e-03MB size(tot)=21970:1.7e-01MB:1.6e-04GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.794e+02S Sys:1.903e+00S Total:4.813e+02S
----- TIMING FOR symbolic_formulae_renorm with size=77 : 3.647e-03 S -----
rank=0 GPUmem(GB): used=0.000199 (oper)=0.000191
rank=0 GPUmem(GB): used=0.000201 (oper,site)(GB)=0.000191,2.98e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=176
 no. of coefficients=745:0.00568MB:5.55e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.381e-04 S -----
rank=0 GPUmem(GB): used=0.000207 (oper,site,rinter)=0.000191,2.98e-06,5.55e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00847 S size(rtasks)=77 size(Rlst2)=256 T(Rmu/Rlist)=0.00126,0.00721 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0091 S size(rtasks)=77 size(Rlst)=6692 -----
rank=0 GPUmem(GB): used=0.000207 (oper,site,rinter,batch)=0.000191,2.98e-06,5.55e-06,0.00892 blksize=81 blksize0=16 batchsize=6692
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000158,0.000771,0.000297
--- TIMING FOR renorm : t_inter=1.6e-04 t_gemm=7.7e-04 t_reduction=3.0e-04 tot=1.2e-03 ---
 renorm[inter] counter=2 t=1.6e-04 per=1.3e+01 cost=8.5e+04 flops=5.4e+08
 renorm[gemm] counter=2 i=0 t=1.3e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=1 t=1.2e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=2 t=1.2e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=3 t=1.1e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=4 t=2.4e-04 per=1.9e+01 cost=1.7e+05 flops=7.3e+08
 renorm[gemm] counter=2 i=5 t=2.2e-04 per=1.8e+01 cost=1.5e+05 flops=7.1e+08
 renorm[gemm] counter=2 i=6 t=3.1e-04 per=2.5e+01 cost=1.2e+06 flops=3.8e+09
 renorm[gemm] counter=2 total t=7.7e-04 per=6.3e+01 cost=1.5e+06 flops=2.0e+09
 renorm[red] counter=2 t=3.0e-04 per=2.4e+01 cost=5.3e+05 flops=1.8e+09
--- TIMING FOR renorm_tot : t_inter=1.7e-04 t_gemm=1.1e-03 t_reduction=4.8e-04 tot=1.7e-03 ---
 renorm_tot[inter] counter=2 t=1.7e-04 per=9.7e+00 cost=8.5e+04 flops=5.1e+08
 renorm_tot[gemm] counter=2 i=0 t=3.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=1 t=2.4e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=2 t=2.4e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=3 t=2.3e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=4 t=3.3e-04 per=1.9e+01 cost=1.8e+05 flops=5.3e+08
 renorm_tot[gemm] counter=2 i=5 t=2.8e-04 per=1.6e+01 cost=1.6e+05 flops=5.5e+08
 renorm_tot[gemm] counter=2 i=6 t=4.4e-04 per=2.6e+01 cost=1.2e+06 flops=2.7e+09
 renorm_tot[gemm] counter=2 total t=1.1e-03 per=6.2e+01 cost=1.5e+06 flops=1.4e+09
 renorm_tot[red] counter=2 t=4.8e-04 per=2.8e+01 cost=5.5e+05 flops=1.2e+09
qops.to_cpu: size(tot)=21970:1.7e-01MB:1.6e-04GB t[to_cpu]=4.8e-05S speed=3.4e+00GB/S
check ||H-H.dagger||=1.178e-16 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0655 S rank=0 -----
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.797e+02S Sys:1.903e+00S Total:4.816e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=14987:1.143e-01MB:1.117e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=112:8.545e-04MB:8.345e-07GB
total mem of comb=15247:1.163e-01MB:1.136e-04GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.797e+02S Sys:1.903e+00S Total:4.816e+02S
##### local opt: 1.416e-01 S #####
 T(local opt: fetch) = 9.384e-03 S  per = 6.63  per(accum) = 6.63
 T(local opt: hdiag) = 3.480e-04 S  per = 0.246  per(accum) = 6.87
 T(local opt: dvdsn) = 6.385e-02 S  per = 45.1  per(accum) = 52
 T(local opt: decim) = 2.384e-04 S  per = 0.168  per(accum) = 52.1
 T(local opt: guess) = 2.055e-04 S  per = 0.145  per(accum) = 52.3
 T(local opt: renrm) = 6.612e-02 S  per = 46.7  per(accum) = 99
 T(local opt: save ) = 1.431e-03 S  per = 1.01  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.385e-02 S  T(sum) = 6.361e-02 S  per = 9.964e+01
 T(local opt: preprocess                  ) = 2.647e-04 S  per = 0.416  per(accum) = 0.416
 T(local opt: symbolic_formulae           ) = 3.192e-03 S  per = 5.02  per(accum) = 5.43
 T(local opt: hintermediate init          ) = 9.033e-05 S  per = 0.142  per(accum) = 5.58
 T(local opt: preprocess_hformulae_Hxlist ) = 1.657e-03 S  per =  2.6  per(accum) = 8.18
 T(local opt: hmmtasks init               ) = 4.456e-03 S  per =    7  per(accum) = 15.2
 T(local opt: initial guess for dvdson    ) = 2.869e-06 S  per = 0.00451  per(accum) = 15.2
 T(local opt: dvdson solver [Hx_batchGPU] ) = 6.708e-03 S  per = 10.5  per(accum) = 25.7
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.517e-04 S  per = 0.238  per(accum) = 26
 T(local opt: dvdson solver [comm(cpu)]   ) = 8.580e-07 S  per = 0.00135  per(accum) = 26
 T(local opt: dvdson solver [rest part]   ) = 4.709e-02 S  per =   74  per(accum) = 100
Detailed decomposition of T(renrm) = 6.612e-02 S  T(sum) = 6.612e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.963e-04 S  per = 0.297  per(accum) = 0.297
 T(local opt: qops init                    ) = 2.450e-03 S  per =  3.7  per(accum) = 4
 T(local opt: symbolic_formulae_renorm     ) = 3.657e-03 S  per = 5.53  per(accum) = 9.53
 T(local opt: allocate qops on gpu         ) = 2.529e-05 S  per = 0.0382  per(accum) = 9.57
 T(local opt: site memcpy cpu2gpu          ) = 1.797e-05 S  per = 0.0272  per(accum) = 9.6
 T(local opt: rintermediate init           ) = 2.474e-04 S  per = 0.374  per(accum) = 9.97
 T(local opt: preprocess_formulae_Rlist2   ) = 9.325e-03 S  per = 14.1  per(accum) = 24.1
 T(local opt: rmmtasks init                ) = 4.825e-02 S  per =   73  per(accum) = 97
 T(local opt: qops memset on cpu           ) = 8.400e-08 S  per = 0.000127  per(accum) = 97
 T(local opt: preprocess_renorm_batchGPU   ) = 1.318e-03 S  per = 1.99  per(accum) = 99
 T(local opt: reduction of opS & opH [nccl]) = 1.104e-06 S  per = 0.00167  per(accum) = 99
 T(local opt: qops memcpy gpu2cpu          ) = 5.368e-05 S  per = 0.0812  per(accum) = 99.1
 T(local opt: deallocate cpu and gpu memory) = 9.165e-05 S  per = 0.139  per(accum) = 99.3
 T(local opt: reduction of opS & opH [comm]) = 4.952e-05 S  per = 0.0749  per(accum) = 99.3
 T(local opt: conversion from opAB to opPQ ) = 3.711e-06 S  per = 0.00561  per(accum) = 99.3
 T(local opt: after oper_renorm            ) = 4.370e-04 S  per = 0.661  per(accum) = 100
##### sweep opt: 1.987e-01 S #####
 T(sweep opt: fetch) = 2.715e-02 S  per = 13.7  per(accum) = 13.7
 T(sweep opt: hdiag) = 6.515e-04 S  per = 0.328  per(accum) = 14
 T(sweep opt: dvdsn) = 8.354e-02 S  per =   42  per(accum) = 56
 T(sweep opt: decim) = 4.350e-04 S  per = 0.219  per(accum) = 56.3
 T(sweep opt: guess) = 3.166e-04 S  per = 0.159  per(accum) = 56.4
 T(sweep opt: renrm) = 8.293e-02 S  per = 41.7  per(accum) = 98.2
 T(sweep opt: save ) = 3.651e-03 S  per = 1.84  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.354e-02 S  T(sum) = 8.302e-02 S  per = 9.938e+01
 T(sweep opt: preprocess                  ) = 3.987e-04 S  per = 0.48  per(accum) = 0.48
 T(sweep opt: symbolic_formulae           ) = 4.662e-03 S  per = 5.62  per(accum) = 6.1
 T(sweep opt: hintermediate init          ) = 1.556e-04 S  per = 0.187  per(accum) = 6.28
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.379e-03 S  per = 2.87  per(accum) = 9.15
 T(sweep opt: hmmtasks init               ) = 6.039e-03 S  per = 7.27  per(accum) = 16.4
 T(sweep opt: initial guess for dvdson    ) = 5.728e-06 S  per = 0.0069  per(accum) = 16.4
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 8.550e-03 S  per = 10.3  per(accum) = 26.7
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.360e-04 S  per = 0.284  per(accum) = 27
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.270e-06 S  per = 0.00153  per(accum) = 27
 T(sweep opt: dvdson solver [rest part]   ) = 6.059e-02 S  per =   73  per(accum) = 100
Detailed decomposition of T(renrm) = 8.293e-02 S  T(sum) = 8.293e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.925e-04 S  per = 0.353  per(accum) = 0.353
 T(sweep opt: qops init                    ) = 3.503e-03 S  per = 4.22  per(accum) = 4.58
 T(sweep opt: symbolic_formulae_renorm     ) = 5.562e-03 S  per = 6.71  per(accum) = 11.3
 T(sweep opt: allocate qops on gpu         ) = 5.137e-05 S  per = 0.0619  per(accum) = 11.3
 T(sweep opt: site memcpy cpu2gpu          ) = 3.895e-05 S  per = 0.047  per(accum) = 11.4
 T(sweep opt: rintermediate init           ) = 2.782e-04 S  per = 0.335  per(accum) = 11.7
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.232e-02 S  per = 14.9  per(accum) = 26.6
 T(sweep opt: rmmtasks init                ) = 5.804e-02 S  per =   70  per(accum) = 96.6
 T(sweep opt: qops memset on cpu           ) = 1.440e-07 S  per = 0.000174  per(accum) = 96.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.901e-03 S  per = 2.29  per(accum) = 98.9
 T(sweep opt: reduction of opS & opH [nccl]) = 2.148e-06 S  per = 0.00259  per(accum) = 98.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.294e-05 S  per = 0.088  per(accum) = 99
 T(sweep opt: deallocate cpu and gpu memory) = 1.014e-04 S  per = 0.122  per(accum) = 99.1
 T(sweep opt: reduction of opS & opH [comm]) = 7.589e-05 S  per = 0.0915  per(accum) = 99.2
 T(sweep opt: conversion from opAB to opPQ ) = 7.224e-06 S  per = 0.00871  per(accum) = 99.2
 T(sweep opt: after oper_renorm            ) = 6.781e-04 S  per = 0.818  per(accum) = 100
##### global opt: 1.987e-01 S #####
 T(global opt: fetch) = 2.715e-02 S  per = 13.7  per(accum) = 13.7
 T(global opt: hdiag) = 6.515e-04 S  per = 0.328  per(accum) = 14
 T(global opt: dvdsn) = 8.354e-02 S  per =   42  per(accum) = 56
 T(global opt: decim) = 4.350e-04 S  per = 0.219  per(accum) = 56.3
 T(global opt: guess) = 3.166e-04 S  per = 0.159  per(accum) = 56.4
 T(global opt: renrm) = 8.293e-02 S  per = 41.7  per(accum) = 98.2
 T(global opt: save ) = 3.651e-03 S  per = 1.84  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.354e-02 S  T(sum) = 8.302e-02 S  per = 9.938e+01
 T(global opt: preprocess                  ) = 3.987e-04 S  per = 0.48  per(accum) = 0.48
 T(global opt: symbolic_formulae           ) = 4.662e-03 S  per = 5.62  per(accum) = 6.1
 T(global opt: hintermediate init          ) = 1.556e-04 S  per = 0.187  per(accum) = 6.28
 T(global opt: preprocess_hformulae_Hxlist ) = 2.379e-03 S  per = 2.87  per(accum) = 9.15
 T(global opt: hmmtasks init               ) = 6.039e-03 S  per = 7.27  per(accum) = 16.4
 T(global opt: initial guess for dvdson    ) = 5.728e-06 S  per = 0.0069  per(accum) = 16.4
 T(global opt: dvdson solver [Hx_batchGPU] ) = 8.550e-03 S  per = 10.3  per(accum) = 26.7
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.360e-04 S  per = 0.284  per(accum) = 27
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.270e-06 S  per = 0.00153  per(accum) = 27
 T(global opt: dvdson solver [rest part]   ) = 6.059e-02 S  per =   73  per(accum) = 100
Detailed decomposition of T(renrm) = 8.293e-02 S  T(sum) = 8.293e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.925e-04 S  per = 0.353  per(accum) = 0.353
 T(global opt: qops init                    ) = 3.503e-03 S  per = 4.22  per(accum) = 4.58
 T(global opt: symbolic_formulae_renorm     ) = 5.562e-03 S  per = 6.71  per(accum) = 11.3
 T(global opt: allocate qops on gpu         ) = 5.137e-05 S  per = 0.0619  per(accum) = 11.3
 T(global opt: site memcpy cpu2gpu          ) = 3.895e-05 S  per = 0.047  per(accum) = 11.4
 T(global opt: rintermediate init           ) = 2.782e-04 S  per = 0.335  per(accum) = 11.7
 T(global opt: preprocess_formulae_Rlist2   ) = 1.232e-02 S  per = 14.9  per(accum) = 26.6
 T(global opt: rmmtasks init                ) = 5.804e-02 S  per =   70  per(accum) = 96.6
 T(global opt: qops memset on cpu           ) = 1.440e-07 S  per = 0.000174  per(accum) = 96.6
 T(global opt: preprocess_renorm_batchGPU   ) = 1.901e-03 S  per = 2.29  per(accum) = 98.9
 T(global opt: reduction of opS & opH [nccl]) = 2.148e-06 S  per = 0.00259  per(accum) = 98.9
 T(global opt: qops memcpy gpu2cpu          ) = 7.294e-05 S  per = 0.088  per(accum) = 99
 T(global opt: deallocate cpu and gpu memory) = 1.014e-04 S  per = 0.122  per(accum) = 99.1
 T(global opt: reduction of opS & opH [comm]) = 7.589e-05 S  per = 0.0915  per(accum) = 99.2
 T(global opt: conversion from opAB to opPQ ) = 7.224e-06 S  per = 0.00871  per(accum) = 99.2
 T(global opt: after oper_renorm            ) = 6.781e-04 S  per = 0.818  per(accum) = 100

isweep=0 ibond=2/seqsize=34 dots=1 dbond=(3,0)-(4,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.797e+02S Sys:1.903e+00S Total:4.816e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=14987:1.143e-01MB:1.117e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=112:8.545e-04MB:8.345e-07GB
total mem of comb=15247:1.163e-01MB:1.136e-04GB
ctns::topology::check_partition: (sl,sr,sc)=3,16,1
 suppl= 0 1 2
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 3
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:6 S:34 H:1 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:3.052e-03MB size(tot)=21970:1.676e-01MB:1.637e-04GB
 rqops: oplist=CSHPQ nops=C:32 S:8 H:1 P:28 Q:36 
        dim(bra,ket)=17,17 size(op)=63:4.807e-04MB size(tot)=2895:2.209e-02MB:2.157e-05GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=27201:2.075e-01MB:2.027e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(3,0) fdel=./scratch/sweep/rop(4,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
wf3(diml,dimr,dimc)=(64,17,4) nnz=112:8.545e-04MB
qtensor3: wf3 own=1 _data=0x529c8620
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
 qbond: qcol nsym=6 dimAll=17
 (24,-2):5 (23,-1):4 (25,-3):4 (25,-1):2 (26,-4):1 (22,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=12 nblocks=384 size=112:8.545e-04MB
### DIAG TIMING: total=4.633e-04 t1=8.824e-06, t2=1.566e-05, t3=2.046e-05, t4=3.896e-04, t5=1.251e-05, t6=1.304e-05, t7=3.165e-06
duration_diagGPU:4.726e-04
duration_diagreduce:2.900e-08
duration_diagtransform:6.650e-07
----- TIMING FOR symbolic_formulae_onedot with size=297 : 5.159e-03 S -----
rank=0 GPUmem(GB): used=0.000203 (oper)=0.000203
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=297
 no. of hintermediate operators=114
 no. of coefficients=1824:0.0139MB:1.36e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.084e-04 S -----
rank=0 GPUmem(GB): used=0.000216 (oper,hinter)=0.000203,1.36e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0025 S size(H_formulae)=297 size(Hxlst2)=12 T(Hmu/Hxlist)=0.000606,0.0019 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00265 S size(H_formulae)=297 size(Hxlst)=1870 -----
rank=0 GPUmem(GB): used=0.00176 (oper,hinter,dvdson,batch)=0.000203,1.36e-05,1.67e-06,0.00155 blksize=45 blksize0=20 batchsize=1870
ctns::pdvdsonSolver_nkr::solve_iter ndim=112 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.35e-05,8.69e-05,0.000804,0.000215,0.00115
 ndim=112:8.34e-07GB t[comm(intra)]=2.88e-05 speed=0.058GB/S t[comm(inter)]=4.75e-06 speed=0.352GB/S
--- TIMING FOR sigma : t_inter=8.7e-05 t_gemm=8.0e-04 t_reduction=2.1e-04 tot=1.1e-03 ---
 sigma[inter] counter=10 t=8.7e-05 per=7.9e+00 cost=1.6e+05 flops=1.8e+09
 sigma[gemm] counter=10 i=0 t=1.4e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=1 t=1.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=2 t=2.2e-04 per=2.0e+01 cost=5.3e+04 flops=2.4e+08
 sigma[gemm] counter=10 i=3 t=2.3e-04 per=2.0e+01 cost=5.0e+04 flops=2.2e+08
 sigma[gemm] counter=10 i=4 t=1.9e-04 per=1.7e+01 cost=6.4e+04 flops=3.4e+08
 sigma[gemm] counter=10 i=5 t=1.7e-04 per=1.5e+01 cost=6.5e+04 flops=3.9e+08
 sigma[gemm] counter=10 total t=8.0e-04 per=7.3e+01 cost=2.3e+05 flops=2.9e+08
 sigma[red] counter=10 t=2.1e-04 per=1.9e+01 cost=3.8e+04 flops=1.8e+08
--- TIMING FOR sigma_tot : t_inter=8.4e-04 t_gemm=5.9e-03 t_reduction=1.7e-03 tot=8.4e-03 ---
 sigma_tot[inter] counter=10 t=8.4e-04 per=1.0e+01 cost=3.8e+05 flops=4.5e+08
 sigma_tot[gemm] counter=10 i=0 t=2.9e-05 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=1 t=1.6e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=2 t=1.5e-03 per=1.8e+01 cost=1.0e+05 flops=7.0e+07
 sigma_tot[gemm] counter=10 i=3 t=1.6e-03 per=1.9e+01 cost=9.9e+04 flops=6.3e+07
 sigma_tot[gemm] counter=10 i=4 t=1.4e-03 per=1.6e+01 cost=1.0e+05 flops=7.4e+07
 sigma_tot[gemm] counter=10 i=5 t=1.4e-03 per=1.6e+01 cost=1.0e+05 flops=7.3e+07
 sigma_tot[gemm] counter=10 total t=5.9e-03 per=6.9e+01 cost=4.1e+05 flops=6.9e+07
 sigma_tot[red] counter=10 t=1.7e-03 per=2.1e+01 cost=9.1e+04 flops=5.2e+07
T(sub)=9.6e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,4.2e-06,1.8e-06,7.3e-07,2.0e-07
settings: ndim=112 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.456608738602 -1.116e+03  7.348e-02    1     1  1.261e-03 1.261e-03 1.236e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.654e-05,1.079e-04,8.412e-04,2.288e-04,1.212e-03
 ndim=112:8.345e-07GB t[comm(intra)]=2.157e-05 speed=7.737e-02GB/S t[comm(inter)]=4.966e-06 speed=3.361e-01GB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=8.4e-04 t_reduction=2.3e-04 tot=1.2e-03 ---
 sigma[inter] counter=11 t=1.1e-04 per=9.2e+00 cost=1.6e+05 flops=1.5e+09
 sigma[gemm] counter=11 i=0 t=1.9e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=1 t=1.8e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=2 t=2.3e-04 per=1.9e+01 cost=5.3e+04 flops=2.3e+08
 sigma[gemm] counter=11 i=3 t=2.3e-04 per=1.9e+01 cost=5.0e+04 flops=2.2e+08
 sigma[gemm] counter=11 i=4 t=2.2e-04 per=1.8e+01 cost=6.4e+04 flops=3.0e+08
 sigma[gemm] counter=11 i=5 t=1.7e-04 per=1.4e+01 cost=6.5e+04 flops=3.9e+08
 sigma[gemm] counter=11 total t=8.4e-04 per=7.1e+01 cost=2.3e+05 flops=2.8e+08
 sigma[red] counter=11 t=2.3e-04 per=1.9e+01 cost=3.8e+04 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=9.5e-04 t_gemm=6.7e-03 t_reduction=2.0e-03 tot=9.6e-03 ---
 sigma_tot[inter] counter=11 t=9.5e-04 per=9.9e+00 cost=5.3e+05 flops=5.6e+08
 sigma_tot[gemm] counter=11 i=0 t=3.1e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=1 t=1.8e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=2 t=1.7e-03 per=1.8e+01 cost=1.6e+05 flops=9.2e+07
 sigma_tot[gemm] counter=11 i=3 t=1.8e-03 per=1.9e+01 cost=1.5e+05 flops=8.3e+07
 sigma_tot[gemm] counter=11 i=4 t=1.6e-03 per=1.7e+01 cost=1.7e+05 flops=1.0e+08
 sigma_tot[gemm] counter=11 i=5 t=1.6e-03 per=1.6e+01 cost=1.7e+05 flops=1.1e+08
 sigma_tot[gemm] counter=11 total t=6.7e-03 per=7.0e+01 cost=6.4e+05 flops=9.6e+07
 sigma_tot[red] counter=11 t=2.0e-03 per=2.0e+01 cost=1.3e+05 flops=6.6e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.2e-05,3.8e-06,1.3e-06,2.9e-07
    2   0 -    -116.465996468063 -9.388e-03  1.417e-02    2     2  1.218e-02 6.092e-03 1.287e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.510e-05,9.991e-05,8.166e-04,2.509e-04,1.199e-03
 ndim=112:8.345e-07GB t[comm(intra)]=2.050e-05 speed=8.141e-02GB/S t[comm(inter)]=4.604e-06 speed=3.625e-01GB/S
--- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=8.2e-04 t_reduction=2.5e-04 tot=1.2e-03 ---
 sigma[inter] counter=12 t=1.0e-04 per=8.5e+00 cost=1.6e+05 flops=1.6e+09
 sigma[gemm] counter=12 i=0 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=1 t=1.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=2 t=2.3e-04 per=1.9e+01 cost=5.3e+04 flops=2.3e+08
 sigma[gemm] counter=12 i=3 t=2.2e-04 per=1.9e+01 cost=5.0e+04 flops=2.2e+08
 sigma[gemm] counter=12 i=4 t=1.9e-04 per=1.6e+01 cost=6.4e+04 flops=3.4e+08
 sigma[gemm] counter=12 i=5 t=1.7e-04 per=1.5e+01 cost=6.5e+04 flops=3.8e+08
 sigma[gemm] counter=12 total t=8.2e-04 per=7.0e+01 cost=2.3e+05 flops=2.9e+08
 sigma[red] counter=12 t=2.5e-04 per=2.2e+01 cost=3.8e+04 flops=1.5e+08
--- TIMING FOR sigma_tot : t_inter=1.0e-03 t_gemm=7.5e-03 t_reduction=2.2e-03 tot=1.1e-02 ---
 sigma_tot[inter] counter=12 t=1.0e-03 per=9.7e+00 cost=6.9e+05 flops=6.6e+08
 sigma_tot[gemm] counter=12 i=0 t=3.3e-05 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=1 t=2.0e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=2 t=1.9e-03 per=1.8e+01 cost=2.1e+05 flops=1.1e+08
 sigma_tot[gemm] counter=12 i=3 t=2.0e-03 per=1.9e+01 cost=2.0e+05 flops=9.9e+07
 sigma_tot[gemm] counter=12 i=4 t=1.8e-03 per=1.7e+01 cost=2.3e+05 flops=1.3e+08
 sigma_tot[gemm] counter=12 i=5 t=1.7e-03 per=1.6e+01 cost=2.3e+05 flops=1.3e+08
 sigma_tot[gemm] counter=12 total t=7.5e-03 per=7.0e+01 cost=8.7e+05 flops=1.2e+08
 sigma_tot[red] counter=12 t=2.2e-03 per=2.1e+01 cost=1.7e+05 flops=7.5e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.5e-05,3.2e-06,1.5e-06,2.7e-07
    3   0 -    -116.466337546790 -3.411e-04  3.701e-03    3     3  2.287e-02 7.623e-03 1.298e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.477e-05,1.003e-04,8.423e-04,2.245e-04,1.198e-03
 ndim=112:8.345e-07GB t[comm(intra)]=1.975e-05 speed=8.451e-02GB/S t[comm(inter)]=5.020e-06 speed=3.325e-01GB/S
--- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=8.4e-04 t_reduction=2.2e-04 tot=1.2e-03 ---
 sigma[inter] counter=13 t=1.0e-04 per=8.6e+00 cost=1.6e+05 flops=1.6e+09
 sigma[gemm] counter=13 i=0 t=1.9e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=1 t=1.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=2 t=2.5e-04 per=2.1e+01 cost=5.3e+04 flops=2.1e+08
 sigma[gemm] counter=13 i=3 t=2.3e-04 per=2.0e+01 cost=5.0e+04 flops=2.2e+08
 sigma[gemm] counter=13 i=4 t=1.9e-04 per=1.6e+01 cost=6.4e+04 flops=3.4e+08
 sigma[gemm] counter=13 i=5 t=1.7e-04 per=1.4e+01 cost=6.5e+04 flops=3.9e+08
 sigma[gemm] counter=13 total t=8.4e-04 per=7.2e+01 cost=2.3e+05 flops=2.8e+08
 sigma[red] counter=13 t=2.2e-04 per=1.9e+01 cost=3.8e+04 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=1.1e-03 t_gemm=8.4e-03 t_reduction=2.4e-03 tot=1.2e-02 ---
 sigma_tot[inter] counter=13 t=1.1e-03 per=9.6e+00 cost=8.5e+05 flops=7.4e+08
 sigma_tot[gemm] counter=13 i=0 t=3.5e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=1 t=2.2e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=2 t=2.2e-03 per=1.8e+01 cost=2.6e+05 flops=1.2e+08
 sigma_tot[gemm] counter=13 i=3 t=2.2e-03 per=1.9e+01 cost=2.5e+05 flops=1.1e+08
 sigma_tot[gemm] counter=13 i=4 t=2.0e-03 per=1.6e+01 cost=2.9e+05 flops=1.5e+08
 sigma_tot[gemm] counter=13 i=5 t=1.9e-03 per=1.6e+01 cost=3.0e+05 flops=1.6e+08
 sigma_tot[gemm] counter=13 total t=8.4e-03 per=7.0e+01 cost=1.1e+06 flops=1.3e+08
 sigma_tot[red] counter=13 t=2.4e-03 per=2.0e+01 cost=2.0e+05 flops=8.4e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.5e-05,3.1e-06,1.3e-06,2.3e-07
    4   0 -    -116.466362065220 -2.452e-05  1.052e-03    3     4  3.355e-02 8.387e-03 1.310e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.326e-05,9.936e-05,8.408e-04,2.248e-04,1.194e-03
 ndim=112:8.345e-07GB t[comm(intra)]=1.882e-05 speed=8.868e-02GB/S t[comm(inter)]=4.441e-06 speed=3.758e-01GB/S
--- TIMING FOR sigma : t_inter=9.9e-05 t_gemm=8.4e-04 t_reduction=2.2e-04 tot=1.2e-03 ---
 sigma[inter] counter=14 t=9.9e-05 per=8.5e+00 cost=1.6e+05 flops=1.6e+09
 sigma[gemm] counter=14 i=0 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=1 t=1.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=2 t=2.3e-04 per=2.0e+01 cost=5.3e+04 flops=2.3e+08
 sigma[gemm] counter=14 i=3 t=2.3e-04 per=1.9e+01 cost=5.0e+04 flops=2.2e+08
 sigma[gemm] counter=14 i=4 t=2.1e-04 per=1.8e+01 cost=6.4e+04 flops=3.0e+08
 sigma[gemm] counter=14 i=5 t=1.7e-04 per=1.4e+01 cost=6.5e+04 flops=3.9e+08
 sigma[gemm] counter=14 total t=8.4e-04 per=7.2e+01 cost=2.3e+05 flops=2.8e+08
 sigma[red] counter=14 t=2.2e-04 per=1.9e+01 cost=3.8e+04 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=1.2e-03 t_gemm=9.2e-03 t_reduction=2.7e-03 tot=1.3e-02 ---
 sigma_tot[inter] counter=14 t=1.2e-03 per=9.5e+00 cost=1.0e+06 flops=8.1e+08
 sigma_tot[gemm] counter=14 i=0 t=3.7e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=1 t=2.3e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=2 t=2.4e-03 per=1.8e+01 cost=3.2e+05 flops=1.3e+08
 sigma_tot[gemm] counter=14 i=3 t=2.5e-03 per=1.9e+01 cost=3.0e+05 flops=1.2e+08
 sigma_tot[gemm] counter=14 i=4 t=2.2e-03 per=1.7e+01 cost=3.6e+05 flops=1.6e+08
 sigma_tot[gemm] counter=14 i=5 t=2.1e-03 per=1.6e+01 cost=3.6e+05 flops=1.8e+08
 sigma_tot[gemm] counter=14 total t=9.2e-03 per=7.0e+01 cost=1.3e+06 flops=1.5e+08
 sigma_tot[red] counter=14 t=2.7e-03 per=2.0e+01 cost=2.4e+05 flops=9.1e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,3.2e-06,1.4e-06,2.2e-07
    5   0 -    -116.466364589023 -2.524e-06  2.799e-04    3     5  4.419e-02 8.838e-03 1.311e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.506e-05,8.936e-05,7.084e-04,2.149e-04,1.055e-03
 ndim=112:8.345e-07GB t[comm(intra)]=1.834e-05 speed=9.100e-02GB/S t[comm(inter)]=1.672e-05 speed=9.982e-02GB/S
--- TIMING FOR sigma : t_inter=8.9e-05 t_gemm=7.1e-04 t_reduction=2.1e-04 tot=1.0e-03 ---
 sigma[inter] counter=15 t=8.9e-05 per=8.8e+00 cost=1.6e+05 flops=1.8e+09
 sigma[gemm] counter=15 i=0 t=1.6e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=1 t=1.5e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=2 t=1.9e-04 per=1.9e+01 cost=5.3e+04 flops=2.7e+08
 sigma[gemm] counter=15 i=3 t=1.9e-04 per=1.9e+01 cost=5.0e+04 flops=2.6e+08
 sigma[gemm] counter=15 i=4 t=1.6e-04 per=1.6e+01 cost=6.4e+04 flops=4.1e+08
 sigma[gemm] counter=15 i=5 t=1.6e-04 per=1.5e+01 cost=6.5e+04 flops=4.2e+08
 sigma[gemm] counter=15 total t=7.1e-04 per=7.0e+01 cost=2.3e+05 flops=3.3e+08
 sigma[red] counter=15 t=2.1e-04 per=2.1e+01 cost=3.8e+04 flops=1.8e+08
--- TIMING FOR sigma_tot : t_inter=1.3e-03 t_gemm=9.9e-03 t_reduction=2.9e-03 tot=1.4e-02 ---
 sigma_tot[inter] counter=15 t=1.3e-03 per=9.5e+00 cost=1.2e+06 flops=8.7e+08
 sigma_tot[gemm] counter=15 i=0 t=3.8e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=1 t=2.5e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=2 t=2.6e-03 per=1.8e+01 cost=3.7e+05 flops=1.4e+08
 sigma_tot[gemm] counter=15 i=3 t=2.7e-03 per=1.9e+01 cost=3.5e+05 flops=1.3e+08
 sigma_tot[gemm] counter=15 i=4 t=2.3e-03 per=1.7e+01 cost=4.2e+05 flops=1.8e+08
 sigma_tot[gemm] counter=15 i=5 t=2.2e-03 per=1.6e+01 cost=4.3e+05 flops=1.9e+08
 sigma_tot[gemm] counter=15 total t=9.9e-03 per=7.0e+01 cost=1.6e+06 flops=1.6e+08
 sigma_tot[red] counter=15 t=2.9e-03 per=2.0e+01 cost=2.8e+05 flops=9.7e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.5e-05,3.1e-06,1.2e-06,2.2e-07
    6   0 +    -116.466364795540 -2.065e-07  8.366e-05    3     6  6.265e-02 1.044e-02 1.288e-03
TIMING FOR Davidson : 6.266e-02  T(cal/comm/rest)=7.726e-03,7.490e-07,5.493e-02
decomposed t_rest=5.493e-02
 T(sub)    =1.283e-04 per=2.336e-01
 T(precond)=5.460e-02 per=9.940e+01
 T(ortho)  =1.666e-05 per=3.033e-02
 T(xcopy)  =7.840e-07 per=1.427e-03
 T(xnrm2)  =2.831e-06 per=5.154e-03
 T(other)  =1.813e-04 per=3.301e-01
optimized energies: isweep=0 ibond=2 dots=1 e[0]=-116.466364795540 nmvp=6
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.864e+02S Sys:1.920e+00S Total:4.883e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=25 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=25 dimAll=256
 (0,0):1 (2,0):16 (1,1):4 (1,-1):4 (4,0):36 (3,1):24 (3,-1):24 (2,2):6 (2,-2):6 (6,0):16 (5,1):24 (5,-1):24 (4,2):16 (4,-2):16 (3,3):4 (3,-3):4 (8,0):1 (7,1):4 (7,-1):4 (6,2):6 (6,-2):6 (5,3):4 (5,-3):4 (4,4):1 (4,-4):1
timing for divide=1.5e-05
timing for compute=1.3e-04
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(nkr): 1.5e-04 S T(divide/compute/collect)=1.5e-05,1.3e-04,1.3e-05 -----
decimation summary: 256->17 dwt=+0.000e+00 SvN=8.387e-01
 qbond: qkept nsym=6 dimAll=17
 (6,2):5 (7,1):4 (5,3):4 (5,1):2 (8,0):1 (4,4):1
----- TIMING for decimation_row(nkr): 6.183e-04 S T(decim/select/formRot)=2.772e-04,3.086e-04,3.246e-05 -----
----- TIMING FOR onedot_decimation: 7.889e-04 S T(wf/decim)=1.532e-04,6.357e-04 -----
ctns::oper_renorm coord=(3,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:8 S:32 H:1 A:28 B:36 
        dim(bra,ket)=17,17 size(op)=63:4.807e-04MB size(tot)=2895:2.209e-02MB:2.157e-05GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.864e+02S Sys:1.921e+00S Total:4.883e+02S
----- TIMING FOR symbolic_formulae_renorm with size=105 : 4.860e-03 S -----
rank=0 GPUmem(GB): used=0.000216 (oper)=0.000203
rank=0 GPUmem(GB): used=0.000217 (oper,site)(GB)=0.000203,8.34e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=327
 no. of coefficients=1890:0.0144MB:1.41e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.521e-04 S -----
rank=0 GPUmem(GB): used=0.000231 (oper,site,rinter)=0.000203,8.34e-07,1.41e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00321 S size(rtasks)=105 size(Rlst2)=36 T(Rmu/Rlist)=0.00145,0.00176 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00333 S size(rtasks)=105 size(Rlst)=1180 -----
rank=0 GPUmem(GB): used=0.000231 (oper,site,rinter,batch)=0.000203,8.34e-07,1.41e-05,0.00151 blksize=45 blksize0=81 batchsize=1180
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000152,0.000565,0.000235
--- TIMING FOR renorm : t_inter=1.5e-04 t_gemm=5.6e-04 t_reduction=2.3e-04 tot=9.5e-04 ---
 renorm[inter] counter=3 t=1.5e-04 per=1.6e+01 cost=9.1e+04 flops=6.0e+08
 renorm[gemm] counter=3 i=0 t=1.4e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=1 t=1.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=2 t=1.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=3 t=1.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=4 t=1.6e-04 per=1.7e+01 cost=4.2e+04 flops=2.7e+08
 renorm[gemm] counter=3 i=5 t=1.8e-04 per=1.9e+01 cost=5.2e+04 flops=3.0e+08
 renorm[gemm] counter=3 i=6 t=2.3e-04 per=2.4e+01 cost=9.1e+04 flops=4.0e+08
 renorm[gemm] counter=3 total t=5.6e-04 per=5.9e+01 cost=1.9e+05 flops=3.3e+08
 renorm[red] counter=3 t=2.3e-04 per=2.5e+01 cost=2.8e+04 flops=1.2e+08
--- TIMING FOR renorm_tot : t_inter=3.2e-04 t_gemm=1.6e-03 t_reduction=7.1e-04 tot=2.7e-03 ---
 renorm_tot[inter] counter=3 t=3.2e-04 per=1.2e+01 cost=1.8e+05 flops=5.5e+08
 renorm_tot[gemm] counter=3 i=0 t=4.4e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=1 t=3.5e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=2 t=3.5e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=3 t=3.4e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=4 t=4.9e-04 per=1.8e+01 cost=2.2e+05 flops=4.5e+08
 renorm_tot[gemm] counter=3 i=5 t=4.6e-04 per=1.7e+01 cost=2.1e+05 flops=4.6e+08
 renorm_tot[gemm] counter=3 i=6 t=6.7e-04 per=2.5e+01 cost=1.3e+06 flops=1.9e+09
 renorm_tot[gemm] counter=3 total t=1.6e-03 per=6.1e+01 cost=1.7e+06 flops=1.1e+09
 renorm_tot[red] counter=3 t=7.1e-04 per=2.7e+01 cost=5.8e+05 flops=8.2e+08
qops.to_cpu: size(tot)=2895:2.2e-02MB:2.2e-05GB t[to_cpu]=1.6e-05S speed=1.3e+00GB/S
check ||H-H.dagger||=1.299e-14 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0189 S rank=0 -----
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.864e+02S Sys:1.921e+00S Total:4.883e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=213:1.625e-03MB:1.587e-06GB
total mem of comb=15380:1.173e-01MB:1.146e-04GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.864e+02S Sys:1.921e+00S Total:4.883e+02S
##### local opt: 1.116e-01 S #####
 T(local opt: fetch) = 9.050e-03 S  per = 8.11  per(accum) = 8.11
 T(local opt: hdiag) = 5.458e-04 S  per = 0.489  per(accum) = 8.6
 T(local opt: dvdsn) = 8.021e-02 S  per = 71.9  per(accum) = 80.5
 T(local opt: decim) = 7.973e-04 S  per = 0.714  per(accum) = 81.2
 T(local opt: guess) = 2.000e-04 S  per = 0.179  per(accum) = 81.4
 T(local opt: renrm) = 1.941e-02 S  per = 17.4  per(accum) = 98.8
 T(local opt: save ) = 1.376e-03 S  per = 1.23  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.021e-02 S  T(sum) = 7.970e-02 S  per = 9.937e+01
 T(local opt: preprocess                  ) = 4.544e-04 S  per = 0.57  per(accum) = 0.57
 T(local opt: symbolic_formulae           ) = 5.170e-03 S  per = 6.49  per(accum) = 7.06
 T(local opt: hintermediate init          ) = 1.210e-04 S  per = 0.152  per(accum) = 7.21
 T(local opt: preprocess_hformulae_Hxlist ) = 2.706e-03 S  per =  3.4  per(accum) = 10.6
 T(local opt: hmmtasks init               ) = 8.592e-03 S  per = 10.8  per(accum) = 21.4
 T(local opt: initial guess for dvdson    ) = 3.104e-06 S  per = 0.00389  per(accum) = 21.4
 T(local opt: dvdson solver [Hx_batchGPU] ) = 7.557e-03 S  per = 9.48  per(accum) = 30.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.683e-04 S  per = 0.211  per(accum) = 31.1
 T(local opt: dvdson solver [comm(cpu)]   ) = 7.490e-07 S  per = 0.00094  per(accum) = 31.1
 T(local opt: dvdson solver [rest part]   ) = 5.493e-02 S  per = 68.9  per(accum) = 100
Detailed decomposition of T(renrm) = 1.941e-02 S  T(sum) = 1.941e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.058e-04 S  per = 1.06  per(accum) = 1.06
 T(local opt: qops init                    ) = 8.618e-04 S  per = 4.44  per(accum) = 5.5
 T(local opt: symbolic_formulae_renorm     ) = 4.870e-03 S  per = 25.1  per(accum) = 30.6
 T(local opt: allocate qops on gpu         ) = 2.526e-05 S  per = 0.13  per(accum) = 30.7
 T(local opt: site memcpy cpu2gpu          ) = 1.976e-05 S  per = 0.102  per(accum) = 30.8
 T(local opt: rintermediate init           ) = 4.616e-04 S  per = 2.38  per(accum) = 33.2
 T(local opt: preprocess_formulae_Rlist2   ) = 3.374e-03 S  per = 17.4  per(accum) = 50.6
 T(local opt: rmmtasks init                ) = 7.885e-03 S  per = 40.6  per(accum) = 91.2
 T(local opt: qops memset on cpu           ) = 7.400e-08 S  per = 0.000381  per(accum) = 91.2
 T(local opt: preprocess_renorm_batchGPU   ) = 1.051e-03 S  per = 5.41  per(accum) = 96.6
 T(local opt: reduction of opS & opH [nccl]) = 9.890e-07 S  per = 0.00509  per(accum) = 96.6
 T(local opt: qops memcpy gpu2cpu          ) = 2.174e-05 S  per = 0.112  per(accum) = 96.7
 T(local opt: deallocate cpu and gpu memory) = 2.934e-04 S  per = 1.51  per(accum) = 98.2
 T(local opt: reduction of opS & opH [comm]) = 2.731e-05 S  per = 0.141  per(accum) = 98.4
 T(local opt: conversion from opAB to opPQ ) = 3.795e-06 S  per = 0.0195  per(accum) = 98.4
 T(local opt: after oper_renorm            ) = 3.119e-04 S  per = 1.61  per(accum) = 100
##### sweep opt: 3.103e-01 S #####
 T(sweep opt: fetch) = 3.620e-02 S  per = 11.7  per(accum) = 11.7
 T(sweep opt: hdiag) = 1.197e-03 S  per = 0.386  per(accum) = 12.1
 T(sweep opt: dvdsn) = 1.637e-01 S  per = 52.8  per(accum) = 64.8
 T(sweep opt: decim) = 1.232e-03 S  per = 0.397  per(accum) = 65.2
 T(sweep opt: guess) = 5.165e-04 S  per = 0.166  per(accum) = 65.4
 T(sweep opt: renrm) = 1.023e-01 S  per =   33  per(accum) = 98.4
 T(sweep opt: save ) = 5.027e-03 S  per = 1.62  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.637e-01 S  T(sum) = 1.627e-01 S  per = 9.937e+01
 T(sweep opt: preprocess                  ) = 8.530e-04 S  per = 0.524  per(accum) = 0.524
 T(sweep opt: symbolic_formulae           ) = 9.832e-03 S  per = 6.04  per(accum) = 6.57
 T(sweep opt: hintermediate init          ) = 2.766e-04 S  per = 0.17  per(accum) = 6.74
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.086e-03 S  per = 3.13  per(accum) = 9.86
 T(sweep opt: hmmtasks init               ) = 1.463e-02 S  per = 8.99  per(accum) = 18.9
 T(sweep opt: initial guess for dvdson    ) = 8.832e-06 S  per = 0.00543  per(accum) = 18.9
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.611e-02 S  per =  9.9  per(accum) = 28.8
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.043e-04 S  per = 0.248  per(accum) = 29
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.019e-06 S  per = 0.00124  per(accum) = 29
 T(sweep opt: dvdson solver [rest part]   ) = 1.155e-01 S  per =   71  per(accum) = 100
Detailed decomposition of T(renrm) = 1.023e-01 S  T(sum) = 1.023e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.983e-04 S  per = 0.487  per(accum) = 0.487
 T(sweep opt: qops init                    ) = 4.365e-03 S  per = 4.27  per(accum) = 4.75
 T(sweep opt: symbolic_formulae_renorm     ) = 1.043e-02 S  per = 10.2  per(accum) = 14.9
 T(sweep opt: allocate qops on gpu         ) = 7.663e-05 S  per = 0.0749  per(accum) = 15
 T(sweep opt: site memcpy cpu2gpu          ) = 5.871e-05 S  per = 0.0574  per(accum) = 15.1
 T(sweep opt: rintermediate init           ) = 7.398e-04 S  per = 0.723  per(accum) = 15.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.569e-02 S  per = 15.3  per(accum) = 31.1
 T(sweep opt: rmmtasks init                ) = 6.593e-02 S  per = 64.4  per(accum) = 95.6
 T(sweep opt: qops memset on cpu           ) = 2.180e-07 S  per = 0.000213  per(accum) = 95.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.952e-03 S  per = 2.88  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [nccl]) = 3.137e-06 S  per = 0.00307  per(accum) = 98.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 9.467e-05 S  per = 0.0925  per(accum) = 98.5
 T(sweep opt: deallocate cpu and gpu memory) = 3.948e-04 S  per = 0.386  per(accum) = 98.9
 T(sweep opt: reduction of opS & opH [comm]) = 1.032e-04 S  per = 0.101  per(accum) = 99
 T(sweep opt: conversion from opAB to opPQ ) = 1.102e-05 S  per = 0.0108  per(accum) = 99
 T(sweep opt: after oper_renorm            ) = 9.899e-04 S  per = 0.967  per(accum) = 100
##### global opt: 3.103e-01 S #####
 T(global opt: fetch) = 3.620e-02 S  per = 11.7  per(accum) = 11.7
 T(global opt: hdiag) = 1.197e-03 S  per = 0.386  per(accum) = 12.1
 T(global opt: dvdsn) = 1.637e-01 S  per = 52.8  per(accum) = 64.8
 T(global opt: decim) = 1.232e-03 S  per = 0.397  per(accum) = 65.2
 T(global opt: guess) = 5.165e-04 S  per = 0.166  per(accum) = 65.4
 T(global opt: renrm) = 1.023e-01 S  per =   33  per(accum) = 98.4
 T(global opt: save ) = 5.027e-03 S  per = 1.62  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.637e-01 S  T(sum) = 1.627e-01 S  per = 9.937e+01
 T(global opt: preprocess                  ) = 8.530e-04 S  per = 0.524  per(accum) = 0.524
 T(global opt: symbolic_formulae           ) = 9.832e-03 S  per = 6.04  per(accum) = 6.57
 T(global opt: hintermediate init          ) = 2.766e-04 S  per = 0.17  per(accum) = 6.74
 T(global opt: preprocess_hformulae_Hxlist ) = 5.086e-03 S  per = 3.13  per(accum) = 9.86
 T(global opt: hmmtasks init               ) = 1.463e-02 S  per = 8.99  per(accum) = 18.9
 T(global opt: initial guess for dvdson    ) = 8.832e-06 S  per = 0.00543  per(accum) = 18.9
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.611e-02 S  per =  9.9  per(accum) = 28.8
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.043e-04 S  per = 0.248  per(accum) = 29
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.019e-06 S  per = 0.00124  per(accum) = 29
 T(global opt: dvdson solver [rest part]   ) = 1.155e-01 S  per =   71  per(accum) = 100
Detailed decomposition of T(renrm) = 1.023e-01 S  T(sum) = 1.023e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.983e-04 S  per = 0.487  per(accum) = 0.487
 T(global opt: qops init                    ) = 4.365e-03 S  per = 4.27  per(accum) = 4.75
 T(global opt: symbolic_formulae_renorm     ) = 1.043e-02 S  per = 10.2  per(accum) = 14.9
 T(global opt: allocate qops on gpu         ) = 7.663e-05 S  per = 0.0749  per(accum) = 15
 T(global opt: site memcpy cpu2gpu          ) = 5.871e-05 S  per = 0.0574  per(accum) = 15.1
 T(global opt: rintermediate init           ) = 7.398e-04 S  per = 0.723  per(accum) = 15.8
 T(global opt: preprocess_formulae_Rlist2   ) = 1.569e-02 S  per = 15.3  per(accum) = 31.1
 T(global opt: rmmtasks init                ) = 6.593e-02 S  per = 64.4  per(accum) = 95.6
 T(global opt: qops memset on cpu           ) = 2.180e-07 S  per = 0.000213  per(accum) = 95.6
 T(global opt: preprocess_renorm_batchGPU   ) = 2.952e-03 S  per = 2.88  per(accum) = 98.4
 T(global opt: reduction of opS & opH [nccl]) = 3.137e-06 S  per = 0.00307  per(accum) = 98.4
 T(global opt: qops memcpy gpu2cpu          ) = 9.467e-05 S  per = 0.0925  per(accum) = 98.5
 T(global opt: deallocate cpu and gpu memory) = 3.948e-04 S  per = 0.386  per(accum) = 98.9
 T(global opt: reduction of opS & opH [comm]) = 1.032e-04 S  per = 0.101  per(accum) = 99
 T(global opt: conversion from opAB to opPQ ) = 1.102e-05 S  per = 0.0108  per(accum) = 99
 T(global opt: after oper_renorm            ) = 9.899e-04 S  per = 0.967  per(accum) = 100

isweep=0 ibond=3/seqsize=34 dots=1 dbond=(4,0)-(5,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.864e+02S Sys:1.921e+00S Total:4.883e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=213:1.625e-03MB:1.587e-06GB
total mem of comb=15380:1.173e-01MB:1.146e-04GB
ctns::topology::check_partition: (sl,sr,sc)=4,15,1
 suppl= 0 1 2 3
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 4
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:8 S:32 H:1 A:28 B:36 
        dim(bra,ket)=17,17 size(op)=63:4.807e-04MB size(tot)=2895:2.209e-02MB:2.157e-05GB
 rqops: oplist=CSHPQ nops=C:30 S:10 H:1 P:45 Q:55 
        dim(bra,ket)=27,27 size(op)=159:1.213e-03MB size(tot)=9444:7.205e-02MB:7.036e-05GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=14675:1.120e-01MB:1.093e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(4,0) fdel=./scratch/sweep/rop(5,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
wf3(diml,dimr,dimc)=(17,27,4) nnz=213:1.625e-03MB
qtensor3: wf3 own=1 _data=0x5260ee20
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=6 dimAll=17
 (6,2):5 (7,1):4 (5,3):4 (5,1):2 (8,0):1 (4,4):1
 qbond: qcol nsym=7 dimAll=27
 (22,-2):8 (23,-3):8 (24,-4):4 (21,-1):3 (24,-2):2 (23,-1):1 (25,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=15 nblocks=168 size=213:1.625e-03MB
### DIAG TIMING: total=7.474e-04 t1=9.614e-06, t2=1.063e-05, t3=2.462e-05, t4=6.719e-04, t5=1.359e-05, t6=1.378e-05, t7=3.240e-06
duration_diagGPU:7.577e-04
duration_diagreduce:3.700e-08
duration_diagtransform:1.250e-06
----- TIMING FOR symbolic_formulae_onedot with size=435 : 8.345e-03 S -----
rank=0 GPUmem(GB): used=0.000109 (oper)=0.000109
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=435
 no. of hintermediate operators=188
 no. of coefficients=2820:0.0215MB:2.1e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.682e-04 S -----
rank=0 GPUmem(GB): used=0.00013 (oper,hinter)=0.000109,2.1e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00467 S size(H_formulae)=435 size(Hxlst2)=15 T(Hmu/Hxlist)=0.000999,0.00367 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00497 S size(H_formulae)=435 size(Hxlst)=3624 -----
rank=0 GPUmem(GB): used=0.00405 (oper,hinter,dvdson,batch)=0.000109,2.1e-05,3.17e-06,0.00392 blksize=40 blksize0=64 batchsize=3624
ctns::pdvdsonSolver_nkr::solve_iter ndim=213 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.51e-05,0.000145,0.00163,0.00029,0.0021
 ndim=213:1.59e-06GB t[comm(intra)]=2.04e-05 speed=0.156GB/S t[comm(inter)]=4.71e-06 speed=0.674GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=1.6e-03 t_reduction=2.9e-04 tot=2.1e-03 ---
 sigma[inter] counter=16 t=1.4e-04 per=7.0e+00 cost=6.0e+05 flops=4.2e+09
 sigma[gemm] counter=16 i=0 t=1.5e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=1 t=1.3e-06 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=2 t=4.4e-04 per=2.1e+01 cost=2.3e+05 flops=5.2e+08
 sigma[gemm] counter=16 i=3 t=4.1e-04 per=2.0e+01 cost=2.3e+05 flops=5.6e+08
 sigma[gemm] counter=16 i=4 t=3.8e-04 per=1.9e+01 cost=2.0e+05 flops=5.3e+08
 sigma[gemm] counter=16 i=5 t=3.9e-04 per=1.9e+01 cost=2.1e+05 flops=5.3e+08
 sigma[gemm] counter=16 total t=1.6e-03 per=7.9e+01 cost=8.7e+05 flops=5.3e+08
 sigma[red] counter=16 t=2.9e-04 per=1.4e+01 cost=1.2e+05 flops=4.2e+08
--- TIMING FOR sigma_tot : t_inter=1.5e-03 t_gemm=1.2e-02 t_reduction=3.2e-03 tot=1.6e-02 ---
 sigma_tot[inter] counter=16 t=1.5e-03 per=9.1e+00 cost=1.8e+06 flops=1.2e+09
 sigma_tot[gemm] counter=16 i=0 t=4.0e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=1 t=2.6e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=2 t=3.1e-03 per=1.9e+01 cost=6.0e+05 flops=2.0e+08
 sigma_tot[gemm] counter=16 i=3 t=3.1e-03 per=1.9e+01 cost=5.8e+05 flops=1.9e+08
 sigma_tot[gemm] counter=16 i=4 t=2.7e-03 per=1.7e+01 cost=6.3e+05 flops=2.3e+08
 sigma_tot[gemm] counter=16 i=5 t=2.6e-03 per=1.6e+01 cost=6.4e+05 flops=2.4e+08
 sigma_tot[gemm] counter=16 total t=1.2e-02 per=7.1e+01 cost=2.4e+06 flops=2.1e+08
 sigma_tot[red] counter=16 t=3.2e-03 per=2.0e+01 cost=4.0e+05 flops=1.3e+08
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,4.4e-06,1.8e-06,8.5e-07,2.6e-07
settings: ndim=213 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.466364795540 -1.116e+03  5.586e-02    1     1  2.223e-03 2.223e-03 2.197e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.648e-05,1.666e-04,1.635e-03,2.851e-04,2.121e-03
 ndim=213:1.587e-06GB t[comm(intra)]=2.140e-05 speed=1.483e-01GB/S t[comm(inter)]=5.078e-06 speed=6.250e-01GB/S
--- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=1.6e-03 t_reduction=2.8e-04 tot=2.1e-03 ---
 sigma[inter] counter=17 t=1.7e-04 per=8.0e+00 cost=6.0e+05 flops=3.6e+09
 sigma[gemm] counter=17 i=0 t=2.0e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=1 t=1.8e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=2 t=4.5e-04 per=2.2e+01 cost=2.3e+05 flops=5.1e+08
 sigma[gemm] counter=17 i=3 t=4.5e-04 per=2.2e+01 cost=2.3e+05 flops=5.1e+08
 sigma[gemm] counter=17 i=4 t=3.6e-04 per=1.7e+01 cost=2.0e+05 flops=5.7e+08
 sigma[gemm] counter=17 i=5 t=3.7e-04 per=1.8e+01 cost=2.1e+05 flops=5.6e+08
 sigma[gemm] counter=17 total t=1.6e-03 per=7.8e+01 cost=8.7e+05 flops=5.3e+08
 sigma[red] counter=17 t=2.8e-04 per=1.4e+01 cost=1.2e+05 flops=4.3e+08
--- TIMING FOR sigma_tot : t_inter=1.6e-03 t_gemm=1.3e-02 t_reduction=3.5e-03 tot=1.8e-02 ---
 sigma_tot[inter] counter=17 t=1.6e-03 per=9.0e+00 cost=2.4e+06 flops=1.4e+09
 sigma_tot[gemm] counter=17 i=0 t=4.2e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=1 t=2.8e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=2 t=3.5e-03 per=1.9e+01 cost=8.3e+05 flops=2.4e+08
 sigma_tot[gemm] counter=17 i=3 t=3.5e-03 per=1.9e+01 cost=8.1e+05 flops=2.3e+08
 sigma_tot[gemm] counter=17 i=4 t=3.1e-03 per=1.7e+01 cost=8.3e+05 flops=2.7e+08
 sigma_tot[gemm] counter=17 i=5 t=3.0e-03 per=1.6e+01 cost=8.5e+05 flops=2.8e+08
 sigma_tot[gemm] counter=17 total t=1.3e-02 per=7.2e+01 cost=3.3e+06 flops=2.5e+08
 sigma_tot[red] counter=17 t=3.5e-03 per=1.9e+01 cost=5.2e+05 flops=1.5e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=6.8e-06,1.3e-05,3.7e-06,1.6e-06,2.7e-07
    2   0 -    -116.471321348636 -4.957e-03  1.556e-02    2     2  1.801e-02 9.005e-03 2.221e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.591e-05,1.577e-04,1.625e-03,2.833e-04,2.098e-03
 ndim=213:1.587e-06GB t[comm(intra)]=2.125e-05 speed=1.494e-01GB/S t[comm(inter)]=4.662e-06 speed=6.808e-01GB/S
--- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=1.6e-03 t_reduction=2.8e-04 tot=2.1e-03 ---
 sigma[inter] counter=18 t=1.6e-04 per=7.6e+00 cost=6.0e+05 flops=3.8e+09
 sigma[gemm] counter=18 i=0 t=2.0e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=1 t=1.8e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=2 t=4.6e-04 per=2.2e+01 cost=2.3e+05 flops=5.0e+08
 sigma[gemm] counter=18 i=3 t=4.3e-04 per=2.1e+01 cost=2.3e+05 flops=5.4e+08
 sigma[gemm] counter=18 i=4 t=3.7e-04 per=1.8e+01 cost=2.0e+05 flops=5.5e+08
 sigma[gemm] counter=18 i=5 t=3.6e-04 per=1.7e+01 cost=2.1e+05 flops=5.8e+08
 sigma[gemm] counter=18 total t=1.6e-03 per=7.9e+01 cost=8.7e+05 flops=5.4e+08
 sigma[red] counter=18 t=2.8e-04 per=1.4e+01 cost=1.2e+05 flops=4.3e+08
--- TIMING FOR sigma_tot : t_inter=1.8e-03 t_gemm=1.5e-02 t_reduction=3.7e-03 tot=2.0e-02 ---
 sigma_tot[inter] counter=18 t=1.8e-03 per=8.9e+00 cost=3.0e+06 flops=1.6e+09
 sigma_tot[gemm] counter=18 i=0 t=4.4e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=1 t=3.0e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=2 t=4.0e-03 per=1.9e+01 cost=1.1e+06 flops=2.7e+08
 sigma_tot[gemm] counter=18 i=3 t=4.0e-03 per=1.9e+01 cost=1.0e+06 flops=2.6e+08
 sigma_tot[gemm] counter=18 i=4 t=3.5e-03 per=1.7e+01 cost=1.0e+06 flops=3.0e+08
 sigma_tot[gemm] counter=18 i=5 t=3.3e-03 per=1.6e+01 cost=1.1e+06 flops=3.2e+08
 sigma_tot[gemm] counter=18 total t=1.5e-02 per=7.3e+01 cost=4.2e+06 flops=2.8e+08
 sigma_tot[red] counter=18 t=3.7e-03 per=1.8e+01 cost=6.4e+05 flops=1.7e+08
T(sub)=6.0e-05 T(gemm/eig/ortho/gemm/axpy)=6.1e-06,1.6e-05,3.6e-05,1.9e-06,3.0e-07
    3   0 -    -116.471714220384 -3.929e-04  5.641e-03    3     3  2.955e-02 9.850e-03 2.222e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.655e-05,1.568e-04,1.623e-03,2.866e-04,2.100e-03
 ndim=213:1.587e-06GB t[comm(intra)]=2.193e-05 speed=1.447e-01GB/S t[comm(inter)]=4.614e-06 speed=6.879e-01GB/S
--- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=1.6e-03 t_reduction=2.9e-04 tot=2.1e-03 ---
 sigma[inter] counter=19 t=1.6e-04 per=7.6e+00 cost=6.0e+05 flops=3.8e+09
 sigma[gemm] counter=19 i=0 t=9.0e-06 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=1 t=1.9e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=2 t=4.5e-04 per=2.2e+01 cost=2.3e+05 flops=5.1e+08
 sigma[gemm] counter=19 i=3 t=4.3e-04 per=2.1e+01 cost=2.3e+05 flops=5.4e+08
 sigma[gemm] counter=19 i=4 t=3.8e-04 per=1.8e+01 cost=2.0e+05 flops=5.4e+08
 sigma[gemm] counter=19 i=5 t=3.6e-04 per=1.7e+01 cost=2.1e+05 flops=5.8e+08
 sigma[gemm] counter=19 total t=1.6e-03 per=7.9e+01 cost=8.7e+05 flops=5.4e+08
 sigma[red] counter=19 t=2.9e-04 per=1.4e+01 cost=1.2e+05 flops=4.2e+08
--- TIMING FOR sigma_tot : t_inter=2.0e-03 t_gemm=1.6e-02 t_reduction=4.0e-03 tot=2.2e-02 ---
 sigma_tot[inter] counter=19 t=2.0e-03 per=8.8e+00 cost=3.6e+06 flops=1.8e+09
 sigma_tot[gemm] counter=19 i=0 t=5.3e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=1 t=3.2e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=2 t=4.4e-03 per=2.0e+01 cost=1.3e+06 flops=2.9e+08
 sigma_tot[gemm] counter=19 i=3 t=4.4e-03 per=2.0e+01 cost=1.3e+06 flops=2.9e+08
 sigma_tot[gemm] counter=19 i=4 t=3.8e-03 per=1.7e+01 cost=1.2e+06 flops=3.2e+08
 sigma_tot[gemm] counter=19 i=5 t=3.7e-03 per=1.7e+01 cost=1.3e+06 flops=3.4e+08
 sigma_tot[gemm] counter=19 total t=1.6e-02 per=7.3e+01 cost=5.1e+06 flops=3.1e+08
 sigma_tot[red] counter=19 t=4.0e-03 per=1.8e+01 cost=7.7e+05 flops=1.9e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.8e-06,1.5e-05,3.1e-06,1.9e-06,2.3e-07
    4   0 -    -116.471776920961 -6.270e-05  2.313e-03    3     4  3.662e-02 9.154e-03 2.227e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.618e-05,1.562e-04,1.608e-03,2.940e-04,2.091e-03
 ndim=213:1.587e-06GB t[comm(intra)]=2.153e-05 speed=1.474e-01GB/S t[comm(inter)]=4.644e-06 speed=6.835e-01GB/S
--- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=1.6e-03 t_reduction=2.9e-04 tot=2.1e-03 ---
 sigma[inter] counter=20 t=1.6e-04 per=7.6e+00 cost=6.0e+05 flops=3.9e+09
 sigma[gemm] counter=20 i=0 t=2.0e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=1 t=1.8e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=2 t=4.4e-04 per=2.1e+01 cost=2.3e+05 flops=5.2e+08
 sigma[gemm] counter=20 i=3 t=4.4e-04 per=2.1e+01 cost=2.3e+05 flops=5.3e+08
 sigma[gemm] counter=20 i=4 t=3.5e-04 per=1.7e+01 cost=2.0e+05 flops=5.8e+08
 sigma[gemm] counter=20 i=5 t=3.7e-04 per=1.8e+01 cost=2.1e+05 flops=5.6e+08
 sigma[gemm] counter=20 total t=1.6e-03 per=7.8e+01 cost=8.7e+05 flops=5.4e+08
 sigma[red] counter=20 t=2.9e-04 per=1.4e+01 cost=1.2e+05 flops=4.1e+08
--- TIMING FOR sigma_tot : t_inter=2.1e-03 t_gemm=1.8e-02 t_reduction=4.3e-03 tot=2.4e-02 ---
 sigma_tot[inter] counter=20 t=2.1e-03 per=8.7e+00 cost=4.2e+06 flops=2.0e+09
 sigma_tot[gemm] counter=20 i=0 t=5.5e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=1 t=3.3e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=2 t=4.9e-03 per=2.0e+01 cost=1.5e+06 flops=3.1e+08
 sigma_tot[gemm] counter=20 i=3 t=4.8e-03 per=2.0e+01 cost=1.5e+06 flops=3.1e+08
 sigma_tot[gemm] counter=20 i=4 t=4.2e-03 per=1.7e+01 cost=1.4e+06 flops=3.4e+08
 sigma_tot[gemm] counter=20 i=5 t=4.1e-03 per=1.7e+01 cost=1.5e+06 flops=3.6e+08
 sigma_tot[gemm] counter=20 total t=1.8e-02 per=7.4e+01 cost=5.9e+06 flops=3.3e+08
 sigma_tot[red] counter=20 t=4.3e-03 per=1.8e+01 cost=8.9e+05 flops=2.1e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=6.1e-06,1.5e-05,3.0e-06,1.9e-06,2.7e-07
    5   0 -    -116.471786686258 -9.765e-06  8.436e-04    3     5  4.813e-02 9.627e-03 2.225e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.607e-05,1.568e-04,1.627e-03,2.860e-04,2.103e-03
 ndim=213:1.587e-06GB t[comm(intra)]=2.146e-05 speed=1.479e-01GB/S t[comm(inter)]=4.605e-06 speed=6.892e-01GB/S
--- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=1.6e-03 t_reduction=2.9e-04 tot=2.1e-03 ---
 sigma[inter] counter=21 t=1.6e-04 per=7.6e+00 cost=6.0e+05 flops=3.8e+09
 sigma[gemm] counter=21 i=0 t=2.0e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=1 t=1.8e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=2 t=4.7e-04 per=2.3e+01 cost=2.3e+05 flops=4.9e+08
 sigma[gemm] counter=21 i=3 t=4.3e-04 per=2.1e+01 cost=2.3e+05 flops=5.4e+08
 sigma[gemm] counter=21 i=4 t=3.6e-04 per=1.7e+01 cost=2.0e+05 flops=5.8e+08
 sigma[gemm] counter=21 i=5 t=3.8e-04 per=1.8e+01 cost=2.1e+05 flops=5.5e+08
 sigma[gemm] counter=21 total t=1.6e-03 per=7.9e+01 cost=8.7e+05 flops=5.4e+08
 sigma[red] counter=21 t=2.9e-04 per=1.4e+01 cost=1.2e+05 flops=4.2e+08
--- TIMING FOR sigma_tot : t_inter=2.3e-03 t_gemm=2.0e-02 t_reduction=4.6e-03 tot=2.7e-02 ---
 sigma_tot[inter] counter=21 t=2.3e-03 per=8.6e+00 cost=4.8e+06 flops=2.1e+09
 sigma_tot[gemm] counter=21 i=0 t=5.7e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=1 t=3.5e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=2 t=5.3e-03 per=2.0e+01 cost=1.7e+06 flops=3.3e+08
 sigma_tot[gemm] counter=21 i=3 t=5.2e-03 per=2.0e+01 cost=1.7e+06 flops=3.3e+08
 sigma_tot[gemm] counter=21 i=4 t=4.5e-03 per=1.7e+01 cost=1.6e+06 flops=3.6e+08
 sigma_tot[gemm] counter=21 i=5 t=4.4e-03 per=1.7e+01 cost=1.7e+06 flops=3.8e+08
 sigma_tot[gemm] counter=21 total t=2.0e-02 per=7.4e+01 cost=6.8e+06 flops=3.5e+08
 sigma_tot[red] counter=21 t=4.6e-03 per=1.7e+01 cost=1.0e+06 flops=2.2e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.8e-06,1.5e-05,3.2e-06,1.9e-06,2.9e-07
    6   0 -    -116.471788050986 -1.365e-06  2.527e-04    3     6  6.422e-02 1.070e-02 2.225e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.543e-05,1.550e-04,1.594e-03,3.027e-04,2.083e-03
 ndim=213:1.587e-06GB t[comm(intra)]=2.089e-05 speed=1.519e-01GB/S t[comm(inter)]=4.537e-06 speed=6.996e-01GB/S
--- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=1.6e-03 t_reduction=3.0e-04 tot=2.1e-03 ---
 sigma[inter] counter=22 t=1.5e-04 per=7.5e+00 cost=6.0e+05 flops=3.9e+09
 sigma[gemm] counter=22 i=0 t=2.0e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=1 t=1.8e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=2 t=4.4e-04 per=2.1e+01 cost=2.3e+05 flops=5.2e+08
 sigma[gemm] counter=22 i=3 t=4.4e-04 per=2.2e+01 cost=2.3e+05 flops=5.2e+08
 sigma[gemm] counter=22 i=4 t=3.5e-04 per=1.7e+01 cost=2.0e+05 flops=5.8e+08
 sigma[gemm] counter=22 i=5 t=3.5e-04 per=1.7e+01 cost=2.1e+05 flops=5.9e+08
 sigma[gemm] counter=22 total t=1.6e-03 per=7.8e+01 cost=8.7e+05 flops=5.5e+08
 sigma[red] counter=22 t=3.0e-04 per=1.5e+01 cost=1.2e+05 flops=4.0e+08
--- TIMING FOR sigma_tot : t_inter=2.4e-03 t_gemm=2.1e-02 t_reduction=4.9e-03 tot=2.9e-02 ---
 sigma_tot[inter] counter=22 t=2.4e-03 per=8.5e+00 cost=5.4e+06 flops=2.2e+09
 sigma_tot[gemm] counter=22 i=0 t=5.9e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=1 t=3.7e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=2 t=5.8e-03 per=2.0e+01 cost=2.0e+06 flops=3.4e+08
 sigma_tot[gemm] counter=22 i=3 t=5.7e-03 per=2.0e+01 cost=2.0e+06 flops=3.5e+08
 sigma_tot[gemm] counter=22 i=4 t=4.9e-03 per=1.7e+01 cost=1.9e+06 flops=3.8e+08
 sigma_tot[gemm] counter=22 i=5 t=4.8e-03 per=1.7e+01 cost=1.9e+06 flops=3.9e+08
 sigma_tot[gemm] counter=22 total t=2.1e-02 per=7.4e+01 cost=7.7e+06 flops=3.6e+08
 sigma_tot[red] counter=22 t=4.9e-03 per=1.7e+01 cost=1.1e+06 flops=2.3e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.5e-06,1.5e-05,3.2e-06,1.9e-06,2.4e-07
    7   0 +    -116.471788147632 -9.665e-08  6.699e-05    3     7  7.578e-02 1.083e-02 2.223e-03
TIMING FOR Davidson : 7.580e-02  T(cal/comm/rest)=1.556e-02,9.380e-07,6.024e-02
decomposed t_rest=6.024e-02
 T(sub)    =1.986e-04 per=3.296e-01
 T(precond)=5.980e-02 per=9.926e+01
 T(ortho)  =2.008e-05 per=3.333e-02
 T(xcopy)  =1.145e-06 per=1.901e-03
 T(xnrm2)  =1.565e-05 per=2.598e-02
 T(other)  =2.090e-04 per=3.469e-01
optimized energies: isweep=0 ibond=3 dots=1 e[0]=-116.471788147632 nmvp=7
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.945e+02S Sys:1.923e+00S Total:4.964e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=14 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=14 dimAll=68
 (6,2):11 (8,2):9 (7,3):9 (7,1):11 (9,1):5 (8,0):5 (5,3):5 (6,4):5 (5,1):2 (6,0):2 (10,0):1 (9,-1):1 (4,4):1 (5,5):1
timing for divide=1.3e-05
timing for compute=1.5e-04
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(nkr): 1.8e-04 S T(divide/compute/collect)=1.3e-05,1.5e-04,1.5e-05 -----
decimation summary: 68->27 dwt=-2.220e-16 SvN=1.038e+00
 qbond: qkept nsym=7 dimAll=27
 (8,2):8 (7,3):8 (6,4):4 (9,1):3 (6,2):2 (7,1):1 (5,5):1
----- TIMING for decimation_row(nkr): 7.514e-04 S T(decim/select/formRot)=2.538e-04,4.612e-04,3.643e-05 -----
----- TIMING FOR onedot_decimation: 8.718e-04 S T(wf/decim)=1.018e-04,7.701e-04 -----
ctns::oper_renorm coord=(4,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:10 S:30 H:1 A:45 B:55 
        dim(bra,ket)=27,27 size(op)=159:1.213e-03MB size(tot)=9444:7.205e-02MB:7.036e-05GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.947e+02S Sys:1.923e+00S Total:4.967e+02S
----- TIMING FOR symbolic_formulae_renorm with size=141 : 6.249e-03 S -----
rank=0 GPUmem(GB): used=0.00013 (oper)=0.000109
rank=0 GPUmem(GB): used=0.000132 (oper,site)(GB)=0.000109,1.59e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=307
 no. of coefficients=2932:0.0224MB:2.18e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.580e-04 S -----
rank=0 GPUmem(GB): used=0.000154 (oper,site,rinter)=0.000109,1.59e-06,2.18e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00397 S size(rtasks)=141 size(Rlst2)=49 T(Rmu/Rlist)=0.0015,0.00247 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00416 S size(rtasks)=141 size(Rlst)=1833 -----
rank=0 GPUmem(GB): used=0.000154 (oper,site,rinter,batch)=0.000109,1.59e-06,2.18e-05,0.0021 blksize=64 blksize0=25 batchsize=1833
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000172,0.00116,0.000313
--- TIMING FOR renorm : t_inter=1.7e-04 t_gemm=1.2e-03 t_reduction=3.1e-04 tot=1.6e-03 ---
 renorm[inter] counter=4 t=1.7e-04 per=1.0e+01 cost=3.0e+05 flops=1.7e+09
 renorm[gemm] counter=4 i=0 t=1.5e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=1 t=1.3e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=2 t=1.2e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=3 t=1.2e-06 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=4 t=3.3e-04 per=2.0e+01 cost=9.7e+04 flops=2.9e+08
 renorm[gemm] counter=4 i=5 t=3.8e-04 per=2.3e+01 cost=1.4e+05 flops=3.6e+08
 renorm[gemm] counter=4 i=6 t=4.4e-04 per=2.7e+01 cost=2.9e+05 flops=6.7e+08
 renorm[gemm] counter=4 total t=1.2e-03 per=7.1e+01 cost=5.3e+05 flops=4.6e+08
 renorm[red] counter=4 t=3.1e-04 per=1.9e+01 cost=7.4e+04 flops=2.4e+08
--- TIMING FOR renorm_tot : t_inter=4.9e-04 t_gemm=2.8e-03 t_reduction=1.0e-03 tot=4.3e-03 ---
 renorm_tot[inter] counter=4 t=4.9e-04 per=1.1e+01 cost=4.7e+05 flops=9.7e+08
 renorm_tot[gemm] counter=4 i=0 t=5.9e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=1 t=4.8e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=2 t=4.8e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=3 t=4.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=4 t=8.2e-04 per=1.9e+01 cost=3.2e+05 flops=3.8e+08
 renorm_tot[gemm] counter=4 i=5 t=8.4e-04 per=1.9e+01 cost=3.5e+05 flops=4.1e+08
 renorm_tot[gemm] counter=4 i=6 t=1.1e-03 per=2.6e+01 cost=1.6e+06 flops=1.4e+09
 renorm_tot[gemm] counter=4 total t=2.8e-03 per=6.5e+01 cost=2.2e+06 flops=8.0e+08
 renorm_tot[red] counter=4 t=1.0e-03 per=2.4e+01 cost=6.5e+05 flops=6.4e+08
qops.to_cpu: size(tot)=9444:7.2e-02MB:7.0e-05GB t[to_cpu]=2.9e-05S speed=2.4e+00GB/S
check ||H-H.dagger||=1.729e-14 coord=(4,0) rank=0
ctns::oper_ab2pq coord=(4,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0261 S rank=0 -----
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.948e+02S Sys:1.923e+00S Total:4.967e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=478:3.647e-03MB:3.561e-06GB
total mem of comb=15645:1.194e-01MB:1.166e-04GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.948e+02S Sys:1.923e+00S Total:4.967e+02S
##### local opt: 1.486e-01 S #####
 T(local opt: fetch) = 1.016e-02 S  per = 6.84  per(accum) = 6.84
 T(local opt: hdiag) = 8.081e-04 S  per = 0.544  per(accum) = 7.38
 T(local opt: dvdsn) = 1.085e-01 S  per =   73  per(accum) = 80.4
 T(local opt: decim) = 8.822e-04 S  per = 0.594  per(accum) = 81
 T(local opt: guess) = 1.994e-04 S  per = 0.134  per(accum) = 81.1
 T(local opt: renrm) = 2.663e-02 S  per = 17.9  per(accum) = 99
 T(local opt: save ) = 1.434e-03 S  per = 0.965  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.085e-01 S  T(sum) = 1.081e-01 S  per = 9.969e+01
 T(local opt: preprocess                  ) = 2.514e-04 S  per = 0.233  per(accum) = 0.233
 T(local opt: symbolic_formulae           ) = 8.357e-03 S  per = 7.73  per(accum) = 7.96
 T(local opt: hintermediate init          ) = 1.817e-04 S  per = 0.168  per(accum) = 8.13
 T(local opt: preprocess_hformulae_Hxlist ) = 5.083e-03 S  per =  4.7  per(accum) = 12.8
 T(local opt: hmmtasks init               ) = 1.845e-02 S  per = 17.1  per(accum) = 29.9
 T(local opt: initial guess for dvdson    ) = 3.916e-06 S  per = 0.00362  per(accum) = 29.9
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.538e-02 S  per = 14.2  per(accum) = 44.1
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.817e-04 S  per = 0.168  per(accum) = 44.3
 T(local opt: dvdson solver [comm(cpu)]   ) = 9.380e-07 S  per = 0.000868  per(accum) = 44.3
 T(local opt: dvdson solver [rest part]   ) = 6.024e-02 S  per = 55.7  per(accum) = 100
Detailed decomposition of T(renrm) = 2.663e-02 S  T(sum) = 2.663e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.494e-04 S  per = 0.561  per(accum) = 0.561
 T(local opt: qops init                    ) = 1.651e-03 S  per =  6.2  per(accum) = 6.76
 T(local opt: symbolic_formulae_renorm     ) = 6.261e-03 S  per = 23.5  per(accum) = 30.3
 T(local opt: allocate qops on gpu         ) = 2.733e-05 S  per = 0.103  per(accum) = 30.4
 T(local opt: site memcpy cpu2gpu          ) = 1.905e-05 S  per = 0.0715  per(accum) = 30.4
 T(local opt: rintermediate init           ) = 4.679e-04 S  per = 1.76  per(accum) = 32.2
 T(local opt: preprocess_formulae_Rlist2   ) = 4.228e-03 S  per = 15.9  per(accum) = 48.1
 T(local opt: rmmtasks init                ) = 1.155e-02 S  per = 43.4  per(accum) = 91.5
 T(local opt: qops memset on cpu           ) = 4.000e-08 S  per = 0.00015  per(accum) = 91.5
 T(local opt: preprocess_renorm_batchGPU   ) = 1.753e-03 S  per = 6.58  per(accum) = 98
 T(local opt: reduction of opS & opH [nccl]) = 1.085e-06 S  per = 0.00407  per(accum) = 98
 T(local opt: qops memcpy gpu2cpu          ) = 3.506e-05 S  per = 0.132  per(accum) = 98.2
 T(local opt: deallocate cpu and gpu memory) = 9.271e-05 S  per = 0.348  per(accum) = 98.5
 T(local opt: reduction of opS & opH [comm]) = 3.218e-05 S  per = 0.121  per(accum) = 98.6
 T(local opt: conversion from opAB to opPQ ) = 3.918e-06 S  per = 0.0147  per(accum) = 98.7
 T(local opt: after oper_renorm            ) = 3.581e-04 S  per = 1.34  per(accum) = 100
##### sweep opt: 4.588e-01 S #####
 T(sweep opt: fetch) = 4.636e-02 S  per = 10.1  per(accum) = 10.1
 T(sweep opt: hdiag) = 2.005e-03 S  per = 0.437  per(accum) = 10.5
 T(sweep opt: dvdsn) = 2.722e-01 S  per = 59.3  per(accum) = 69.9
 T(sweep opt: decim) = 2.114e-03 S  per = 0.461  per(accum) = 70.3
 T(sweep opt: guess) = 7.159e-04 S  per = 0.156  per(accum) = 70.5
 T(sweep opt: renrm) = 1.290e-01 S  per = 28.1  per(accum) = 98.6
 T(sweep opt: save ) = 6.461e-03 S  per = 1.41  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.722e-01 S  T(sum) = 2.708e-01 S  per = 9.950e+01
 T(sweep opt: preprocess                  ) = 1.104e-03 S  per = 0.408  per(accum) = 0.408
 T(sweep opt: symbolic_formulae           ) = 1.819e-02 S  per = 6.72  per(accum) = 7.12
 T(sweep opt: hintermediate init          ) = 4.584e-04 S  per = 0.169  per(accum) = 7.29
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.017e-02 S  per = 3.75  per(accum) = 11
 T(sweep opt: hmmtasks init               ) = 3.308e-02 S  per = 12.2  per(accum) = 23.3
 T(sweep opt: initial guess for dvdson    ) = 1.275e-05 S  per = 0.00471  per(accum) = 23.3
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 3.149e-02 S  per = 11.6  per(accum) = 34.9
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 5.860e-04 S  per = 0.216  per(accum) = 35.1
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.957e-06 S  per = 0.00109  per(accum) = 35.1
 T(sweep opt: dvdson solver [rest part]   ) = 1.758e-01 S  per = 64.9  per(accum) = 100
Detailed decomposition of T(renrm) = 1.290e-01 S  T(sum) = 1.290e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.477e-04 S  per = 0.502  per(accum) = 0.502
 T(sweep opt: qops init                    ) = 6.016e-03 S  per = 4.66  per(accum) = 5.17
 T(sweep opt: symbolic_formulae_renorm     ) = 1.669e-02 S  per = 12.9  per(accum) = 18.1
 T(sweep opt: allocate qops on gpu         ) = 1.040e-04 S  per = 0.0806  per(accum) = 18.2
 T(sweep opt: site memcpy cpu2gpu          ) = 7.775e-05 S  per = 0.0603  per(accum) = 18.3
 T(sweep opt: rintermediate init           ) = 1.208e-03 S  per = 0.936  per(accum) = 19.2
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.992e-02 S  per = 15.4  per(accum) = 34.6
 T(sweep opt: rmmtasks init                ) = 7.748e-02 S  per = 60.1  per(accum) = 94.7
 T(sweep opt: qops memset on cpu           ) = 2.580e-07 S  per = 0.0002  per(accum) = 94.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.705e-03 S  per = 3.65  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [nccl]) = 4.222e-06 S  per = 0.00327  per(accum) = 98.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.297e-04 S  per = 0.101  per(accum) = 98.5
 T(sweep opt: deallocate cpu and gpu memory) = 4.876e-04 S  per = 0.378  per(accum) = 98.8
 T(sweep opt: reduction of opS & opH [comm]) = 1.354e-04 S  per = 0.105  per(accum) = 98.9
 T(sweep opt: conversion from opAB to opPQ ) = 1.494e-05 S  per = 0.0116  per(accum) = 99
 T(sweep opt: after oper_renorm            ) = 1.348e-03 S  per = 1.05  per(accum) = 100
##### global opt: 4.588e-01 S #####
 T(global opt: fetch) = 4.636e-02 S  per = 10.1  per(accum) = 10.1
 T(global opt: hdiag) = 2.005e-03 S  per = 0.437  per(accum) = 10.5
 T(global opt: dvdsn) = 2.722e-01 S  per = 59.3  per(accum) = 69.9
 T(global opt: decim) = 2.114e-03 S  per = 0.461  per(accum) = 70.3
 T(global opt: guess) = 7.159e-04 S  per = 0.156  per(accum) = 70.5
 T(global opt: renrm) = 1.290e-01 S  per = 28.1  per(accum) = 98.6
 T(global opt: save ) = 6.461e-03 S  per = 1.41  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.722e-01 S  T(sum) = 2.708e-01 S  per = 9.950e+01
 T(global opt: preprocess                  ) = 1.104e-03 S  per = 0.408  per(accum) = 0.408
 T(global opt: symbolic_formulae           ) = 1.819e-02 S  per = 6.72  per(accum) = 7.12
 T(global opt: hintermediate init          ) = 4.584e-04 S  per = 0.169  per(accum) = 7.29
 T(global opt: preprocess_hformulae_Hxlist ) = 1.017e-02 S  per = 3.75  per(accum) = 11
 T(global opt: hmmtasks init               ) = 3.308e-02 S  per = 12.2  per(accum) = 23.3
 T(global opt: initial guess for dvdson    ) = 1.275e-05 S  per = 0.00471  per(accum) = 23.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 3.149e-02 S  per = 11.6  per(accum) = 34.9
 T(global opt: dvdson solver [comm(gpu)]   ) = 5.860e-04 S  per = 0.216  per(accum) = 35.1
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.957e-06 S  per = 0.00109  per(accum) = 35.1
 T(global opt: dvdson solver [rest part]   ) = 1.758e-01 S  per = 64.9  per(accum) = 100
Detailed decomposition of T(renrm) = 1.290e-01 S  T(sum) = 1.290e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.477e-04 S  per = 0.502  per(accum) = 0.502
 T(global opt: qops init                    ) = 6.016e-03 S  per = 4.66  per(accum) = 5.17
 T(global opt: symbolic_formulae_renorm     ) = 1.669e-02 S  per = 12.9  per(accum) = 18.1
 T(global opt: allocate qops on gpu         ) = 1.040e-04 S  per = 0.0806  per(accum) = 18.2
 T(global opt: site memcpy cpu2gpu          ) = 7.775e-05 S  per = 0.0603  per(accum) = 18.3
 T(global opt: rintermediate init           ) = 1.208e-03 S  per = 0.936  per(accum) = 19.2
 T(global opt: preprocess_formulae_Rlist2   ) = 1.992e-02 S  per = 15.4  per(accum) = 34.6
 T(global opt: rmmtasks init                ) = 7.748e-02 S  per = 60.1  per(accum) = 94.7
 T(global opt: qops memset on cpu           ) = 2.580e-07 S  per = 0.0002  per(accum) = 94.7
 T(global opt: preprocess_renorm_batchGPU   ) = 4.705e-03 S  per = 3.65  per(accum) = 98.4
 T(global opt: reduction of opS & opH [nccl]) = 4.222e-06 S  per = 0.00327  per(accum) = 98.4
 T(global opt: qops memcpy gpu2cpu          ) = 1.297e-04 S  per = 0.101  per(accum) = 98.5
 T(global opt: deallocate cpu and gpu memory) = 4.876e-04 S  per = 0.378  per(accum) = 98.8
 T(global opt: reduction of opS & opH [comm]) = 1.354e-04 S  per = 0.105  per(accum) = 98.9
 T(global opt: conversion from opAB to opPQ ) = 1.494e-05 S  per = 0.0116  per(accum) = 99
 T(global opt: after oper_renorm            ) = 1.348e-03 S  per = 1.05  per(accum) = 100

isweep=0 ibond=4/seqsize=34 dots=1 dbond=(5,0)-(6,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:4.948e+02S Sys:1.923e+00S Total:4.967e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=478:3.647e-03MB:3.561e-06GB
total mem of comb=15645:1.194e-01MB:1.166e-04GB
ctns::topology::check_partition: (sl,sr,sc)=5,14,1
 suppl= 0 1 2 3 4
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 16
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:10 S:30 H:1 A:45 B:55 
        dim(bra,ket)=27,27 size(op)=159:1.213e-03MB size(tot)=9444:7.205e-02MB:7.036e-05GB
 rqops: oplist=CSHPQ nops=C:28 S:12 H:1 P:66 Q:78 
        dim(bra,ket)=38,38 size(op)=208:1.587e-03MB size(tot)=21107:1.610e-01MB:1.573e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=32887:2.509e-01MB:2.450e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(5,0) fdel=./scratch/sweep/rop(6,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
wf3(diml,dimr,dimc)=(27,38,4) nnz=478:3.647e-03MB
qtensor3: wf3 own=1 _data=0x528a5e60
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=7 dimAll=27
 (8,2):8 (7,3):8 (6,4):4 (9,1):3 (6,2):2 (7,1):1 (5,5):1
 qbond: qcol nsym=10 dimAll=38
 (21,-1):8 (22,-2):8 (21,-3):6 (23,-3):4 (20,-2):3 (20,0):3 (23,-1):2 (22,-4):2 (22,0):1 (24,-4):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=22 nblocks=280 size=478:3.647e-03MB
### DIAG TIMING: total=1.284e-03 t1=1.018e-05, t2=1.326e-05, t3=3.406e-05, t4=1.193e-03, t5=1.629e-05, t6=1.382e-05, t7=3.709e-06
duration_diagGPU:1.295e-03
duration_diagreduce:3.700e-08
duration_diagtransform:2.054e-06
----- TIMING FOR symbolic_formulae_onedot with size=607 : 1.178e-02 S -----
rank=0 GPUmem(GB): used=0.000245 (oper)=0.000245
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=607
 no. of hintermediate operators=280
 no. of coefficients=3920:0.0299MB:2.92e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.396e-04 S -----
rank=0 GPUmem(GB): used=0.000274 (oper,hinter)=0.000245,2.92e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00947 S size(H_formulae)=607 size(Hxlst2)=22 T(Hmu/Hxlist)=0.00143,0.00804 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0102 S size(H_formulae)=607 size(Hxlst)=8728 -----
rank=0 GPUmem(GB): used=0.0128 (oper,hinter,dvdson,batch)=0.000245,2.92e-05,7.12e-06,0.0126 blksize=64 blksize0=64 batchsize=8728
ctns::pdvdsonSolver_nkr::solve_iter ndim=478 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.49e-05,0.000211,0.0025,0.000423,0.00318
 ndim=478:3.56e-06GB t[comm(intra)]=2.99e-05 speed=0.238GB/S t[comm(inter)]=4.95e-06 speed=1.44GB/S
--- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=2.5e-03 t_reduction=4.2e-04 tot=3.1e-03 ---
 sigma[inter] counter=23 t=2.1e-04 per=6.7e+00 cost=2.5e+06 flops=1.2e+10
 sigma[gemm] counter=23 i=0 t=1.4e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=1 t=1.2e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=2 t=6.7e-04 per=2.1e+01 cost=9.2e+05 flops=1.4e+09
 sigma[gemm] counter=23 i=3 t=6.6e-04 per=2.1e+01 cost=9.4e+05 flops=1.4e+09
 sigma[gemm] counter=23 i=4 t=5.9e-04 per=1.9e+01 cost=1.0e+06 flops=1.8e+09
 sigma[gemm] counter=23 i=5 t=5.8e-04 per=1.9e+01 cost=1.0e+06 flops=1.8e+09
 sigma[gemm] counter=23 total t=2.5e-03 per=8.0e+01 cost=3.9e+06 flops=1.6e+09
 sigma[red] counter=23 t=4.2e-04 per=1.4e+01 cost=4.2e+05 flops=9.9e+08
--- TIMING FOR sigma_tot : t_inter=2.6e-03 t_gemm=2.4e-02 t_reduction=5.3e-03 tot=3.2e-02 ---
 sigma_tot[inter] counter=23 t=2.6e-03 per=8.3e+00 cost=7.9e+06 flops=3.0e+09
 sigma_tot[gemm] counter=23 i=0 t=6.0e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=1 t=3.8e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=2 t=6.4e-03 per=2.0e+01 cost=2.9e+06 flops=4.5e+08
 sigma_tot[gemm] counter=23 i=3 t=6.3e-03 per=2.0e+01 cost=2.9e+06 flops=4.6e+08
 sigma_tot[gemm] counter=23 i=4 t=5.5e-03 per=1.7e+01 cost=2.9e+06 flops=5.3e+08
 sigma_tot[gemm] counter=23 i=5 t=5.4e-03 per=1.7e+01 cost=2.9e+06 flops=5.5e+08
 sigma_tot[gemm] counter=23 total t=2.4e-02 per=7.5e+01 cost=1.2e+07 flops=4.9e+08
 sigma_tot[red] counter=23 t=5.3e-03 per=1.7e+01 cost=1.5e+06 flops=2.9e+08
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,4.2e-06,1.8e-06,1.0e-06,3.1e-07
settings: ndim=478 neig=1 maxcycle=30 nbuff=4 memory=5e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.471788147632 -1.116e+03  1.672e-02    1     1  3.294e-03 3.294e-03 3.267e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.725e-05,2.760e-04,2.576e-03,4.566e-04,3.343e-03
 ndim=478:3.561e-06GB t[comm(intra)]=2.221e-05 speed=3.208e-01GB/S t[comm(inter)]=5.044e-06 speed=1.412e+00GB/S
--- TIMING FOR sigma : t_inter=2.8e-04 t_gemm=2.6e-03 t_reduction=4.6e-04 tot=3.3e-03 ---
 sigma[inter] counter=24 t=2.8e-04 per=8.3e+00 cost=2.5e+06 flops=9.2e+09
 sigma[gemm] counter=24 i=0 t=2.0e-06 per=6.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=1 t=1.8e-06 per=5.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=2 t=7.1e-04 per=2.1e+01 cost=9.2e+05 flops=1.3e+09
 sigma[gemm] counter=24 i=3 t=7.1e-04 per=2.1e+01 cost=9.4e+05 flops=1.3e+09
 sigma[gemm] counter=24 i=4 t=5.8e-04 per=1.7e+01 cost=1.0e+06 flops=1.8e+09
 sigma[gemm] counter=24 i=5 t=5.8e-04 per=1.7e+01 cost=1.0e+06 flops=1.8e+09
 sigma[gemm] counter=24 total t=2.6e-03 per=7.8e+01 cost=3.9e+06 flops=1.5e+09
 sigma[red] counter=24 t=4.6e-04 per=1.4e+01 cost=4.2e+05 flops=9.2e+08
--- TIMING FOR sigma_tot : t_inter=2.9e-03 t_gemm=2.6e-02 t_reduction=5.8e-03 tot=3.5e-02 ---
 sigma_tot[inter] counter=24 t=2.9e-03 per=8.3e+00 cost=1.0e+07 flops=3.6e+09
 sigma_tot[gemm] counter=24 i=0 t=6.2e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=1 t=4.0e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=2 t=7.1e-03 per=2.0e+01 cost=3.8e+06 flops=5.3e+08
 sigma_tot[gemm] counter=24 i=3 t=7.1e-03 per=2.0e+01 cost=3.8e+06 flops=5.5e+08
 sigma_tot[gemm] counter=24 i=4 t=6.1e-03 per=1.7e+01 cost=3.9e+06 flops=6.5e+08
 sigma_tot[gemm] counter=24 i=5 t=6.0e-03 per=1.7e+01 cost=4.0e+06 flops=6.7e+08
 sigma_tot[gemm] counter=24 total t=2.6e-02 per=7.5e+01 cost=1.6e+07 flops=5.9e+08
 sigma_tot[red] counter=24 t=5.8e-03 per=1.7e+01 cost=2.0e+06 flops=3.4e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=7.3e-06,1.2e-05,3.9e-06,2.2e-06,3.6e-07
    2   0 -    -116.472250342787 -4.622e-04  5.157e-03    2     2  1.635e-02 8.174e-03 3.369e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.606e-05,2.724e-04,2.641e-03,4.625e-04,3.409e-03
 ndim=478:3.561e-06GB t[comm(intra)]=2.137e-05 speed=3.334e-01GB/S t[comm(inter)]=4.696e-06 speed=1.517e+00GB/S
--- TIMING FOR sigma : t_inter=2.7e-04 t_gemm=2.6e-03 t_reduction=4.6e-04 tot=3.4e-03 ---
 sigma[inter] counter=25 t=2.7e-04 per=8.1e+00 cost=2.5e+06 flops=9.4e+09
 sigma[gemm] counter=25 i=0 t=2.0e-06 per=5.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=1 t=1.8e-06 per=5.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=2 t=7.2e-04 per=2.1e+01 cost=9.2e+05 flops=1.3e+09
 sigma[gemm] counter=25 i=3 t=7.0e-04 per=2.1e+01 cost=9.4e+05 flops=1.3e+09
 sigma[gemm] counter=25 i=4 t=6.2e-04 per=1.8e+01 cost=1.0e+06 flops=1.7e+09
 sigma[gemm] counter=25 i=5 t=6.0e-04 per=1.8e+01 cost=1.0e+06 flops=1.7e+09
 sigma[gemm] counter=25 total t=2.6e-03 per=7.8e+01 cost=3.9e+06 flops=1.5e+09
 sigma[red] counter=25 t=4.6e-04 per=1.4e+01 cost=4.2e+05 flops=9.1e+08
--- TIMING FOR sigma_tot : t_inter=3.2e-03 t_gemm=2.9e-02 t_reduction=6.3e-03 tot=3.8e-02 ---
 sigma_tot[inter] counter=25 t=3.2e-03 per=8.3e+00 cost=1.3e+07 flops=4.1e+09
 sigma_tot[gemm] counter=25 i=0 t=6.4e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=1 t=4.2e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=2 t=7.9e-03 per=2.0e+01 cost=4.7e+06 flops=6.0e+08
 sigma_tot[gemm] counter=25 i=3 t=7.7e-03 per=2.0e+01 cost=4.8e+06 flops=6.2e+08
 sigma_tot[gemm] counter=25 i=4 t=6.7e-03 per=1.7e+01 cost=4.9e+06 flops=7.4e+08
 sigma_tot[gemm] counter=25 i=5 t=6.6e-03 per=1.7e+01 cost=5.0e+06 flops=7.7e+08
 sigma_tot[gemm] counter=25 total t=2.9e-02 per=7.5e+01 cost=1.9e+07 flops=6.7e+08
 sigma_tot[red] counter=25 t=6.3e-03 per=1.6e+01 cost=2.4e+06 flops=3.8e+08
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=7.7e-06,1.6e-05,3.3e-06,3.1e-06,3.8e-07
    3   0 -    -116.472292117614 -4.177e-05  2.266e-03    3     3  2.926e-02 9.753e-03 3.423e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.555e-05,2.717e-04,2.626e-03,4.651e-04,3.396e-03
 ndim=478:3.561e-06GB t[comm(intra)]=2.098e-05 speed=3.395e-01GB/S t[comm(inter)]=4.566e-06 speed=1.560e+00GB/S
--- TIMING FOR sigma : t_inter=2.7e-04 t_gemm=2.6e-03 t_reduction=4.6e-04 tot=3.4e-03 ---
 sigma[inter] counter=26 t=2.7e-04 per=8.1e+00 cost=2.5e+06 flops=9.4e+09
 sigma[gemm] counter=26 i=0 t=1.9e-06 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=1 t=1.8e-06 per=5.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=2 t=7.2e-04 per=2.1e+01 cost=9.2e+05 flops=1.3e+09
 sigma[gemm] counter=26 i=3 t=6.9e-04 per=2.1e+01 cost=9.4e+05 flops=1.4e+09
 sigma[gemm] counter=26 i=4 t=6.1e-04 per=1.8e+01 cost=1.0e+06 flops=1.7e+09
 sigma[gemm] counter=26 i=5 t=6.0e-04 per=1.8e+01 cost=1.0e+06 flops=1.8e+09
 sigma[gemm] counter=26 total t=2.6e-03 per=7.8e+01 cost=3.9e+06 flops=1.5e+09
 sigma[red] counter=26 t=4.6e-04 per=1.4e+01 cost=4.2e+05 flops=9.0e+08
--- TIMING FOR sigma_tot : t_inter=3.5e-03 t_gemm=3.2e-02 t_reduction=6.7e-03 tot=4.2e-02 ---
 sigma_tot[inter] counter=26 t=3.5e-03 per=8.3e+00 cost=1.6e+07 flops=4.5e+09
 sigma_tot[gemm] counter=26 i=0 t=6.6e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=1 t=4.3e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=2 t=8.6e-03 per=2.1e+01 cost=5.6e+06 flops=6.6e+08
 sigma_tot[gemm] counter=26 i=3 t=8.4e-03 per=2.0e+01 cost=5.7e+06 flops=6.8e+08
 sigma_tot[gemm] counter=26 i=4 t=7.3e-03 per=1.7e+01 cost=6.0e+06 flops=8.2e+08
 sigma_tot[gemm] counter=26 i=5 t=7.2e-03 per=1.7e+01 cost=6.1e+06 flops=8.5e+08
 sigma_tot[gemm] counter=26 total t=3.2e-02 per=7.6e+01 cost=2.3e+07 flops=7.4e+08
 sigma_tot[red] counter=26 t=6.7e-03 per=1.6e+01 cost=2.8e+06 flops=4.2e+08
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=7.8e-06,1.5e-05,3.3e-06,3.0e-06,3.7e-07
    4   0 -    -116.472301020553 -8.903e-06  8.708e-04    3     4  4.212e-02 1.053e-02 3.448e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.537e-05,2.704e-04,2.618e-03,4.572e-04,3.377e-03
 ndim=478:3.561e-06GB t[comm(intra)]=2.036e-05 speed=3.499e-01GB/S t[comm(inter)]=5.018e-06 speed=1.419e+00GB/S
--- TIMING FOR sigma : t_inter=2.7e-04 t_gemm=2.6e-03 t_reduction=4.6e-04 tot=3.3e-03 ---
 sigma[inter] counter=27 t=2.7e-04 per=8.1e+00 cost=2.5e+06 flops=9.4e+09
 sigma[gemm] counter=27 i=0 t=1.9e-06 per=5.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=1 t=1.7e-06 per=5.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=2 t=7.1e-04 per=2.1e+01 cost=9.2e+05 flops=1.3e+09
 sigma[gemm] counter=27 i=3 t=7.1e-04 per=2.1e+01 cost=9.4e+05 flops=1.3e+09
 sigma[gemm] counter=27 i=4 t=5.9e-04 per=1.8e+01 cost=1.0e+06 flops=1.7e+09
 sigma[gemm] counter=27 i=5 t=6.0e-04 per=1.8e+01 cost=1.0e+06 flops=1.7e+09
 sigma[gemm] counter=27 total t=2.6e-03 per=7.8e+01 cost=3.9e+06 flops=1.5e+09
 sigma[red] counter=27 t=4.6e-04 per=1.4e+01 cost=4.2e+05 flops=9.2e+08
--- TIMING FOR sigma_tot : t_inter=3.7e-03 t_gemm=3.4e-02 t_reduction=7.2e-03 tot=4.5e-02 ---
 sigma_tot[inter] counter=27 t=3.7e-03 per=8.3e+00 cost=1.8e+07 flops=4.9e+09
 sigma_tot[gemm] counter=27 i=0 t=6.8e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=1 t=4.5e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=2 t=9.3e-03 per=2.1e+01 cost=6.5e+06 flops=7.1e+08
 sigma_tot[gemm] counter=27 i=3 t=9.2e-03 per=2.0e+01 cost=6.7e+06 flops=7.3e+08
 sigma_tot[gemm] counter=27 i=4 t=7.9e-03 per=1.7e+01 cost=7.0e+06 flops=8.9e+08
 sigma_tot[gemm] counter=27 i=5 t=7.8e-03 per=1.7e+01 cost=7.1e+06 flops=9.2e+08
 sigma_tot[gemm] counter=27 total t=3.4e-02 per=7.6e+01 cost=2.7e+07 flops=8.0e+08
 sigma_tot[red] counter=27 t=7.2e-03 per=1.6e+01 cost=3.2e+06 flops=4.5e+08
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=7.6e-06,1.6e-05,3.3e-06,3.2e-06,3.8e-07
    5   0 -    -116.472302205819 -1.185e-06  2.513e-04    3     5  5.041e-02 1.008e-02 3.458e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.600e-05,2.781e-04,2.618e-03,4.771e-04,3.406e-03
 ndim=478:3.561e-06GB t[comm(intra)]=2.086e-05 speed=3.414e-01GB/S t[comm(inter)]=5.138e-06 speed=1.386e+00GB/S
--- TIMING FOR sigma : t_inter=2.8e-04 t_gemm=2.6e-03 t_reduction=4.8e-04 tot=3.4e-03 ---
 sigma[inter] counter=28 t=2.8e-04 per=8.2e+00 cost=2.5e+06 flops=9.2e+09
 sigma[gemm] counter=28 i=0 t=1.9e-06 per=5.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=1 t=1.7e-06 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=2 t=7.1e-04 per=2.1e+01 cost=9.2e+05 flops=1.3e+09
 sigma[gemm] counter=28 i=3 t=7.1e-04 per=2.1e+01 cost=9.4e+05 flops=1.3e+09
 sigma[gemm] counter=28 i=4 t=6.1e-04 per=1.8e+01 cost=1.0e+06 flops=1.7e+09
 sigma[gemm] counter=28 i=5 t=5.9e-04 per=1.7e+01 cost=1.0e+06 flops=1.8e+09
 sigma[gemm] counter=28 total t=2.6e-03 per=7.8e+01 cost=3.9e+06 flops=1.5e+09
 sigma[red] counter=28 t=4.8e-04 per=1.4e+01 cost=4.2e+05 flops=8.8e+08
--- TIMING FOR sigma_tot : t_inter=4.0e-03 t_gemm=3.7e-02 t_reduction=7.7e-03 tot=4.8e-02 ---
 sigma_tot[inter] counter=28 t=4.0e-03 per=8.3e+00 cost=2.1e+07 flops=5.2e+09
 sigma_tot[gemm] counter=28 i=0 t=7.0e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=1 t=4.7e-05 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=2 t=1.0e-02 per=2.1e+01 cost=7.5e+06 flops=7.5e+08
 sigma_tot[gemm] counter=28 i=3 t=9.9e-03 per=2.0e+01 cost=7.6e+06 flops=7.7e+08
 sigma_tot[gemm] counter=28 i=4 t=8.5e-03 per=1.8e+01 cost=8.0e+06 flops=9.4e+08
 sigma_tot[gemm] counter=28 i=5 t=8.3e-03 per=1.7e+01 cost=8.2e+06 flops=9.8e+08
 sigma_tot[gemm] counter=28 total t=3.7e-02 per=7.6e+01 cost=3.1e+07 flops=8.5e+08
 sigma_tot[red] counter=28 t=7.7e-03 per=1.6e+01 cost=3.6e+06 flops=4.8e+08
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=8.1e-06,1.5e-05,3.1e-06,3.0e-06,3.8e-07
    6   0 +    -116.472302317891 -1.121e-07  7.497e-05    3     6  6.784e-02 1.131e-02 3.471e-03
TIMING FOR Davidson : 6.785e-02  T(cal/comm/rest)=2.083e-02,8.370e-07,4.702e-02
decomposed t_rest=4.702e-02
 T(sub)    =1.557e-04 per=3.310e-01
 T(precond)=4.663e-02 per=9.917e+01
 T(ortho)  =2.130e-05 per=4.531e-02
 T(xcopy)  =1.412e-06 per=3.003e-03
 T(xnrm2)  =4.181e-06 per=8.892e-03
 T(other)  =2.076e-04 per=4.416e-01
optimized energies: isweep=0 ibond=4 dots=1 e[0]=-116.472302317891 nmvp=6
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:5.019e+02S Sys:1.926e+00S Total:5.038e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=15 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond4.txt
 qbond: qsuper nsym=15 dimAll=108
 (8,2):19 (10,2):11 (9,3):16 (9,1):12 (7,3):14 (8,4):12 (6,4):5 (7,5):5 (11,1):3 (10,0):3 (6,2):2 (7,1):3 (8,0):1 (5,5):1 (6,6):1
timing for divide=1.7e-05
timing for compute=2.5e-04
timing for collect=2.1e-05
----- TMING FOR decimation_genbasis(nkr): 2.9e-04 S T(divide/compute/collect)=1.7e-05,2.5e-04,2.1e-05 -----
decimation summary: 108->38 dwt=+0.000e+00 SvN=1.421e+00
 qbond: qkept nsym=10 dimAll=38
 (8,2):8 (9,1):8 (9,3):6 (7,3):4 (10,2):3 (10,0):3 (8,4):2 (7,1):2 (6,4):1 (8,0):1
----- TIMING for decimation_row(nkr): 9.199e-04 S T(decim/select/formRot)=3.683e-04,5.107e-04,4.098e-05 -----
----- TIMING FOR onedot_decimation: 1.066e-03 S T(wf/decim)=1.271e-04,9.388e-04 -----
ctns::oper_renorm coord=(5,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:12 S:28 H:1 A:66 B:78 
        dim(bra,ket)=38,38 size(op)=208:1.587e-03MB size(tot)=21107:1.610e-01MB:1.573e-04GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:5.020e+02S Sys:1.926e+00S Total:5.039e+02S
----- TIMING FOR symbolic_formulae_renorm with size=185 : 7.413e-03 S -----
rank=0 GPUmem(GB): used=0.000274 (oper)=0.000245
rank=0 GPUmem(GB): used=0.000278 (oper,site)(GB)=0.000245,3.56e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=287
 no. of coefficients=4090:0.0312MB:3.05e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.342e-04 S -----
rank=0 GPUmem(GB): used=0.000308 (oper,site,rinter)=0.000245,3.56e-06,3.05e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00565 S size(rtasks)=185 size(Rlst2)=100 T(Rmu/Rlist)=0.00148,0.00417 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00601 S size(rtasks)=185 size(Rlst)=3632 -----
rank=0 GPUmem(GB): used=0.000308 (oper,site,rinter,batch)=0.000245,3.56e-06,3.05e-05,0.00522 blksize=64 blksize0=64 batchsize=3632
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000242,0.00167,0.000489
--- TIMING FOR renorm : t_inter=2.4e-04 t_gemm=1.7e-03 t_reduction=4.9e-04 tot=2.4e-03 ---
 renorm[inter] counter=5 t=2.4e-04 per=1.0e+01 cost=1.3e+06 flops=5.6e+09
 renorm[gemm] counter=5 i=0 t=1.4e-06 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=1 t=1.1e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=2 t=1.1e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=3 t=1.1e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=4 t=4.5e-04 per=1.9e+01 cost=2.6e+05 flops=5.9e+08
 renorm[gemm] counter=5 i=5 t=5.5e-04 per=2.3e+01 cost=5.3e+05 flops=9.8e+08
 renorm[gemm] counter=5 i=6 t=6.7e-04 per=2.8e+01 cost=9.4e+05 flops=1.4e+09
 renorm[gemm] counter=5 total t=1.7e-03 per=7.0e+01 cost=1.7e+06 flops=1.0e+09
 renorm[red] counter=5 t=4.9e-04 per=2.0e+01 cost=1.9e+05 flops=4.0e+08
--- TIMING FOR renorm_tot : t_inter=7.3e-04 t_gemm=4.5e-03 t_reduction=1.5e-03 tot=6.7e-03 ---
 renorm_tot[inter] counter=5 t=7.3e-04 per=1.1e+01 cost=1.8e+06 flops=2.5e+09
 renorm_tot[gemm] counter=5 i=0 t=7.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=1 t=5.9e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=2 t=5.9e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=3 t=5.8e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=4 t=1.3e-03 per=1.9e+01 cost=5.8e+05 flops=4.6e+08
 renorm_tot[gemm] counter=5 i=5 t=1.4e-03 per=2.1e+01 cost=8.8e+05 flops=6.4e+08
 renorm_tot[gemm] counter=5 i=6 t=1.8e-03 per=2.7e+01 cost=2.5e+06 flops=1.4e+09
 renorm_tot[gemm] counter=5 total t=4.5e-03 per=6.7e+01 cost=4.0e+06 flops=8.9e+08
 renorm_tot[red] counter=5 t=1.5e-03 per=2.3e+01 cost=8.5e+05 flops=5.6e+08
qops.to_cpu: size(tot)=21107:1.6e-01MB:1.6e-04GB t[to_cpu]=4.9e-05S speed=3.2e+00GB/S
check ||H-H.dagger||=1.534e-14 coord=(5,0) rank=0
ctns::oper_ab2pq coord=(5,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0438 S rank=0 -----
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:5.021e+02S Sys:1.926e+00S Total:5.040e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=723:5.516e-03MB:5.387e-06GB
total mem of comb=15890:1.212e-01MB:1.184e-04GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:5.021e+02S Sys:1.927e+00S Total:5.040e+02S
##### local opt: 1.998e-01 S #####
 T(local opt: fetch) = 1.134e-02 S  per = 5.68  per(accum) = 5.68
 T(local opt: hdiag) = 1.361e-03 S  per = 0.681  per(accum) = 6.36
 T(local opt: dvdsn) = 1.399e-01 S  per =   70  per(accum) = 76.4
 T(local opt: decim) = 1.084e-03 S  per = 0.543  per(accum) = 76.9
 T(local opt: guess) = 2.367e-04 S  per = 0.118  per(accum) = 77
 T(local opt: renrm) = 4.436e-02 S  per = 22.2  per(accum) = 99.2
 T(local opt: save ) = 1.557e-03 S  per = 0.779  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.399e-01 S  T(sum) = 1.391e-01 S  per = 9.947e+01
 T(local opt: preprocess                  ) = 3.766e-04 S  per = 0.271  per(accum) = 0.271
 T(local opt: symbolic_formulae           ) = 1.180e-02 S  per = 8.48  per(accum) = 8.75
 T(local opt: hintermediate init          ) = 2.542e-04 S  per = 0.183  per(accum) = 8.93
 T(local opt: preprocess_hformulae_Hxlist ) = 1.042e-02 S  per = 7.49  per(accum) = 16.4
 T(local opt: hmmtasks init               ) = 4.844e-02 S  per = 34.8  per(accum) = 51.2
 T(local opt: initial guess for dvdson    ) = 4.563e-06 S  per = 0.00328  per(accum) = 51.2
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.066e-02 S  per = 14.9  per(accum) = 66.1
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.651e-04 S  per = 0.119  per(accum) = 66.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 8.370e-07 S  per = 0.000602  per(accum) = 66.2
 T(local opt: dvdson solver [rest part]   ) = 4.702e-02 S  per = 33.8  per(accum) = 100
Detailed decomposition of T(renrm) = 4.436e-02 S  T(sum) = 4.436e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.606e-04 S  per = 0.362  per(accum) = 0.362
 T(local opt: qops init                    ) = 2.526e-03 S  per =  5.7  per(accum) = 6.06
 T(local opt: symbolic_formulae_renorm     ) = 7.426e-03 S  per = 16.7  per(accum) = 22.8
 T(local opt: allocate qops on gpu         ) = 2.727e-05 S  per = 0.0615  per(accum) = 22.9
 T(local opt: site memcpy cpu2gpu          ) = 2.043e-05 S  per = 0.0461  per(accum) = 22.9
 T(local opt: rintermediate init           ) = 4.444e-04 S  per =    1  per(accum) = 23.9
 T(local opt: preprocess_formulae_Rlist2   ) = 6.136e-03 S  per = 13.8  per(accum) = 37.7
 T(local opt: rmmtasks init                ) = 2.424e-02 S  per = 54.7  per(accum) = 92.4
 T(local opt: qops memset on cpu           ) = 4.900e-08 S  per = 0.00011  per(accum) = 92.4
 T(local opt: preprocess_renorm_batchGPU   ) = 2.497e-03 S  per = 5.63  per(accum) = 98
 T(local opt: reduction of opS & opH [nccl]) = 1.079e-06 S  per = 0.00243  per(accum) = 98
 T(local opt: qops memcpy gpu2cpu          ) = 6.094e-05 S  per = 0.137  per(accum) = 98.2
 T(local opt: deallocate cpu and gpu memory) = 3.661e-04 S  per = 0.825  per(accum) = 99
 T(local opt: reduction of opS & opH [comm]) = 3.747e-05 S  per = 0.0845  per(accum) = 99.1
 T(local opt: conversion from opAB to opPQ ) = 3.873e-06 S  per = 0.00873  per(accum) = 99.1
 T(local opt: after oper_renorm            ) = 4.052e-04 S  per = 0.914  per(accum) = 100
##### sweep opt: 6.586e-01 S #####
 T(sweep opt: fetch) = 5.770e-02 S  per = 8.76  per(accum) = 8.76
 T(sweep opt: hdiag) = 3.366e-03 S  per = 0.511  per(accum) = 9.27
 T(sweep opt: dvdsn) = 4.121e-01 S  per = 62.6  per(accum) = 71.8
 T(sweep opt: decim) = 3.199e-03 S  per = 0.486  per(accum) = 72.3
 T(sweep opt: guess) = 9.526e-04 S  per = 0.145  per(accum) = 72.5
 T(sweep opt: renrm) = 1.733e-01 S  per = 26.3  per(accum) = 98.8
 T(sweep opt: save ) = 8.018e-03 S  per = 1.22  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.121e-01 S  T(sum) = 4.100e-01 S  per = 9.949e+01
 T(sweep opt: preprocess                  ) = 1.481e-03 S  per = 0.361  per(accum) = 0.361
 T(sweep opt: symbolic_formulae           ) = 2.999e-02 S  per = 7.31  per(accum) = 7.67
 T(sweep opt: hintermediate init          ) = 7.126e-04 S  per = 0.174  per(accum) = 7.85
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.058e-02 S  per = 5.02  per(accum) = 12.9
 T(sweep opt: hmmtasks init               ) = 8.152e-02 S  per = 19.9  per(accum) = 32.8
 T(sweep opt: initial guess for dvdson    ) = 1.731e-05 S  per = 0.00422  per(accum) = 32.8
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 5.215e-02 S  per = 12.7  per(accum) = 45.5
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 7.511e-04 S  per = 0.183  per(accum) = 45.7
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 3.794e-06 S  per = 0.000925  per(accum) = 45.7
 T(sweep opt: dvdson solver [rest part]   ) = 2.228e-01 S  per = 54.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.733e-01 S  T(sum) = 1.733e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.083e-04 S  per = 0.466  per(accum) = 0.466
 T(sweep opt: qops init                    ) = 8.542e-03 S  per = 4.93  per(accum) = 5.39
 T(sweep opt: symbolic_formulae_renorm     ) = 2.412e-02 S  per = 13.9  per(accum) = 19.3
 T(sweep opt: allocate qops on gpu         ) = 1.312e-04 S  per = 0.0757  per(accum) = 19.4
 T(sweep opt: site memcpy cpu2gpu          ) = 9.818e-05 S  per = 0.0566  per(accum) = 19.4
 T(sweep opt: rintermediate init           ) = 1.652e-03 S  per = 0.953  per(accum) = 20.4
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.606e-02 S  per =   15  per(accum) = 35.4
 T(sweep opt: rmmtasks init                ) = 1.017e-01 S  per = 58.7  per(accum) = 94.1
 T(sweep opt: qops memset on cpu           ) = 3.070e-07 S  per = 0.000177  per(accum) = 94.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.201e-03 S  per = 4.15  per(accum) = 98.3
 T(sweep opt: reduction of opS & opH [nccl]) = 5.301e-06 S  per = 0.00306  per(accum) = 98.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.907e-04 S  per = 0.11  per(accum) = 98.4
 T(sweep opt: deallocate cpu and gpu memory) = 8.537e-04 S  per = 0.493  per(accum) = 98.9
 T(sweep opt: reduction of opS & opH [comm]) = 1.728e-04 S  per = 0.0997  per(accum) = 99
 T(sweep opt: conversion from opAB to opPQ ) = 1.881e-05 S  per = 0.0109  per(accum) = 99
 T(sweep opt: after oper_renorm            ) = 1.753e-03 S  per = 1.01  per(accum) = 100
##### global opt: 6.586e-01 S #####
 T(global opt: fetch) = 5.770e-02 S  per = 8.76  per(accum) = 8.76
 T(global opt: hdiag) = 3.366e-03 S  per = 0.511  per(accum) = 9.27
 T(global opt: dvdsn) = 4.121e-01 S  per = 62.6  per(accum) = 71.8
 T(global opt: decim) = 3.199e-03 S  per = 0.486  per(accum) = 72.3
 T(global opt: guess) = 9.526e-04 S  per = 0.145  per(accum) = 72.5
 T(global opt: renrm) = 1.733e-01 S  per = 26.3  per(accum) = 98.8
 T(global opt: save ) = 8.018e-03 S  per = 1.22  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.121e-01 S  T(sum) = 4.100e-01 S  per = 9.949e+01
 T(global opt: preprocess                  ) = 1.481e-03 S  per = 0.361  per(accum) = 0.361
 T(global opt: symbolic_formulae           ) = 2.999e-02 S  per = 7.31  per(accum) = 7.67
 T(global opt: hintermediate init          ) = 7.126e-04 S  per = 0.174  per(accum) = 7.85
 T(global opt: preprocess_hformulae_Hxlist ) = 2.058e-02 S  per = 5.02  per(accum) = 12.9
 T(global opt: hmmtasks init               ) = 8.152e-02 S  per = 19.9  per(accum) = 32.8
 T(global opt: initial guess for dvdson    ) = 1.731e-05 S  per = 0.00422  per(accum) = 32.8
 T(global opt: dvdson solver [Hx_batchGPU] ) = 5.215e-02 S  per = 12.7  per(accum) = 45.5
 T(global opt: dvdson solver [comm(gpu)]   ) = 7.511e-04 S  per = 0.183  per(accum) = 45.7
 T(global opt: dvdson solver [comm(cpu)]   ) = 3.794e-06 S  per = 0.000925  per(accum) = 45.7
 T(global opt: dvdson solver [rest part]   ) = 2.228e-01 S  per = 54.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.733e-01 S  T(sum) = 1.733e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.083e-04 S  per = 0.466  per(accum) = 0.466
 T(global opt: qops init                    ) = 8.542e-03 S  per = 4.93  per(accum) = 5.39
 T(global opt: symbolic_formulae_renorm     ) = 2.412e-02 S  per = 13.9  per(accum) = 19.3
 T(global opt: allocate qops on gpu         ) = 1.312e-04 S  per = 0.0757  per(accum) = 19.4
 T(global opt: site memcpy cpu2gpu          ) = 9.818e-05 S  per = 0.0566  per(accum) = 19.4
 T(global opt: rintermediate init           ) = 1.652e-03 S  per = 0.953  per(accum) = 20.4
 T(global opt: preprocess_formulae_Rlist2   ) = 2.606e-02 S  per =   15  per(accum) = 35.4
 T(global opt: rmmtasks init                ) = 1.017e-01 S  per = 58.7  per(accum) = 94.1
 T(global opt: qops memset on cpu           ) = 3.070e-07 S  per = 0.000177  per(accum) = 94.1
 T(global opt: preprocess_renorm_batchGPU   ) = 7.201e-03 S  per = 4.15  per(accum) = 98.3
 T(global opt: reduction of opS & opH [nccl]) = 5.301e-06 S  per = 0.00306  per(accum) = 98.3
 T(global opt: qops memcpy gpu2cpu          ) = 1.907e-04 S  per = 0.11  per(accum) = 98.4
 T(global opt: deallocate cpu and gpu memory) = 8.537e-04 S  per = 0.493  per(accum) = 98.9
 T(global opt: reduction of opS & opH [comm]) = 1.728e-04 S  per = 0.0997  per(accum) = 99
 T(global opt: conversion from opAB to opPQ ) = 1.881e-05 S  per = 0.0109  per(accum) = 99
 T(global opt: after oper_renorm            ) = 1.753e-03 S  per = 1.01  per(accum) = 100

isweep=0 ibond=5/seqsize=34 dots=1 dbond=(6,0)-(7,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:5.021e+02S Sys:1.927e+00S Total:5.040e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=723:5.516e-03MB:5.387e-06GB
total mem of comb=15890:1.212e-01MB:1.184e-04GB
ctns::topology::check_partition: (sl,sr,sc)=6,13,1
 suppl= 0 1 2 3 4 16
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 17
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:12 S:28 H:1 A:66 B:78 
        dim(bra,ket)=38,38 size(op)=208:1.587e-03MB size(tot)=21107:1.610e-01MB:1.573e-04GB
 rqops: oplist=CSHPQ nops=C:26 S:14 H:1 P:91 Q:105 
        dim(bra,ket)=47,47 size(op)=293:2.235e-03MB size(tot)=39416:3.007e-01MB:2.937e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=62859:4.796e-01MB:4.683e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(6,0) fdel=./scratch/sweep/rop(7,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
wf3(diml,dimr,dimc)=(38,47,4) nnz=723:5.516e-03MB
qtensor3: wf3 own=1 _data=0x5305e600
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=10 dimAll=38
 (8,2):8 (9,1):8 (9,3):6 (7,3):4 (10,2):3 (10,0):3 (8,4):2 (7,1):2 (6,4):1 (8,0):1
 qbond: qcol nsym=11 dimAll=47
 (20,-2):9 (20,0):8 (21,-1):8 (19,-1):6 (21,-3):4 (22,-2):4 (19,1):3 (22,0):2 (19,-3):1 (21,1):1 (23,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=29 nblocks=440 size=723:5.516e-03MB
### DIAG TIMING: total=2.038e-03 t1=1.224e-05, t2=1.221e-05, t3=3.307e-05, t4=1.943e-03, t5=1.983e-05, t6=1.444e-05, t7=3.378e-06
duration_diagGPU:2.048e-03
duration_diagreduce:3.400e-08
duration_diagtransform:3.320e-06
----- TIMING FOR symbolic_formulae_onedot with size=813 : 1.485e-02 S -----
rank=0 GPUmem(GB): used=0.000468 (oper)=0.000468
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=813
 no. of hintermediate operators=390
 no. of coefficients=5070:0.0387MB:3.78e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.143e-04 S -----
rank=0 GPUmem(GB): used=0.000506 (oper,hinter)=0.000468,3.78e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0165 S size(H_formulae)=813 size(Hxlst2)=29 T(Hmu/Hxlist)=0.00187,0.0147 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0179 S size(H_formulae)=813 size(Hxlst)=16936 -----
rank=0 GPUmem(GB): used=0.0279 (oper,hinter,dvdson,batch)=0.000468,3.78e-05,1.08e-05,0.0274 blksize=72 blksize0=72 batchsize=16936
ctns::pdvdsonSolver_nkr::solve_iter ndim=723 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.46e-05,0.00037,0.00467,0.000799,0.00589
 ndim=723:5.39e-06GB t[comm(intra)]=2.78e-05 speed=0.387GB/S t[comm(inter)]=6.78e-06 speed=1.59GB/S
--- TIMING FOR sigma : t_inter=3.7e-04 t_gemm=4.7e-03 t_reduction=8.0e-04 tot=5.8e-03 ---
 sigma[inter] counter=29 t=3.7e-04 per=6.3e+00 cost=6.2e+06 flops=1.7e+10
 sigma[gemm] counter=29 i=0 t=1.9e-06 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=1 t=1.7e-06 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=2 t=1.3e-03 per=2.1e+01 cost=2.4e+06 flops=1.9e+09
 sigma[gemm] counter=29 i=3 t=1.2e-03 per=2.1e+01 cost=2.4e+06 flops=2.0e+09
 sigma[gemm] counter=29 i=4 t=1.1e-03 per=1.9e+01 cost=2.4e+06 flops=2.2e+09
 sigma[gemm] counter=29 i=5 t=1.1e-03 per=1.9e+01 cost=2.5e+06 flops=2.2e+09
 sigma[gemm] counter=29 total t=4.7e-03 per=8.0e+01 cost=9.7e+06 flops=2.1e+09
 sigma[red] counter=29 t=8.0e-04 per=1.4e+01 cost=9.6e+05 flops=1.2e+09
--- TIMING FOR sigma_tot : t_inter=4.4e-03 t_gemm=4.1e-02 t_reduction=8.5e-03 tot=5.4e-02 ---
 sigma_tot[inter] counter=29 t=4.4e-03 per=8.1e+00 cost=2.7e+07 flops=6.1e+09
 sigma_tot[gemm] counter=29 i=0 t=7.2e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=1 t=4.9e-05 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=2 t=1.1e-02 per=2.1e+01 cost=9.9e+06 flops=8.8e+08
 sigma_tot[gemm] counter=29 i=3 t=1.1e-02 per=2.0e+01 cost=1.0e+07 flops=9.1e+08
 sigma_tot[gemm] counter=29 i=4 t=9.6e-03 per=1.8e+01 cost=1.0e+07 flops=1.1e+09
 sigma_tot[gemm] counter=29 i=5 t=9.5e-03 per=1.7e+01 cost=1.1e+07 flops=1.1e+09
 sigma_tot[gemm] counter=29 total t=4.1e-02 per=7.6e+01 cost=4.1e+07 flops=9.9e+08
 sigma_tot[red] counter=29 t=8.5e-03 per=1.6e+01 cost=4.6e+06 flops=5.5e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,6.5e-06,2.7e-06,1.8e-06,6.3e-07
settings: ndim=723 neig=1 maxcycle=30 nbuff=4 memory=8e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.472302317891 -1.116e+03  1.824e-02    1     1  6.054e-03 6.054e-03 6.015e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.020e-05,4.158e-04,4.235e-03,7.853e-04,5.479e-03
 ndim=723:5.387e-06GB t[comm(intra)]=2.470e-05 speed=4.361e-01GB/S t[comm(inter)]=5.500e-06 speed=1.959e+00GB/S
--- TIMING FOR sigma : t_inter=4.2e-04 t_gemm=4.2e-03 t_reduction=7.8e-04 tot=5.4e-03 ---
 sigma[inter] counter=30 t=4.2e-04 per=7.6e+00 cost=6.2e+06 flops=1.5e+10
 sigma[gemm] counter=30 i=0 t=2.1e-06 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=1 t=1.8e-06 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=2 t=1.1e-03 per=2.1e+01 cost=2.4e+06 flops=2.1e+09
 sigma[gemm] counter=30 i=3 t=1.1e-03 per=2.1e+01 cost=2.4e+06 flops=2.2e+09
 sigma[gemm] counter=30 i=4 t=9.8e-04 per=1.8e+01 cost=2.4e+06 flops=2.5e+09
 sigma[gemm] counter=30 i=5 t=1.0e-03 per=1.8e+01 cost=2.5e+06 flops=2.5e+09
 sigma[gemm] counter=30 total t=4.2e-03 per=7.8e+01 cost=9.7e+06 flops=2.3e+09
 sigma[red] counter=30 t=7.8e-04 per=1.4e+01 cost=9.6e+05 flops=1.2e+09
--- TIMING FOR sigma_tot : t_inter=4.8e-03 t_gemm=4.6e-02 t_reduction=9.2e-03 tot=6.0e-02 ---
 sigma_tot[inter] counter=30 t=4.8e-03 per=8.0e+00 cost=3.3e+07 flops=6.9e+09
 sigma_tot[gemm] counter=30 i=0 t=7.4e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=1 t=5.0e-05 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=2 t=1.2e-02 per=2.1e+01 cost=1.2e+07 flops=9.9e+08
 sigma_tot[gemm] counter=30 i=3 t=1.2e-02 per=2.0e+01 cost=1.2e+07 flops=1.0e+09
 sigma_tot[gemm] counter=30 i=4 t=1.1e-02 per=1.8e+01 cost=1.3e+07 flops=1.2e+09
 sigma_tot[gemm] counter=30 i=5 t=1.0e-02 per=1.8e+01 cost=1.3e+07 flops=1.3e+09
 sigma_tot[gemm] counter=30 total t=4.6e-02 per=7.7e+01 cost=5.1e+07 flops=1.1e+09
 sigma_tot[red] counter=30 t=9.2e-03 per=1.5e+01 cost=5.6e+06 flops=6.0e+08
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.6e-05,4.3e-06,3.6e-06,6.2e-07
    2   0 -    -116.472847467251 -5.451e-04  5.309e-03    2     2  1.618e-02 8.092e-03 5.817e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.245e-05,3.438e-04,3.155e-03,5.922e-04,4.150e-03
 ndim=723:5.387e-06GB t[comm(intra)]=3.529e-05 speed=3.053e-01GB/S t[comm(inter)]=7.158e-06 speed=1.505e+00GB/S
--- TIMING FOR sigma : t_inter=3.4e-04 t_gemm=3.2e-03 t_reduction=5.9e-04 tot=4.1e-03 ---
 sigma[inter] counter=31 t=3.4e-04 per=8.4e+00 cost=6.2e+06 flops=1.8e+10
 sigma[gemm] counter=31 i=0 t=1.9e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=1 t=1.6e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=2 t=8.5e-04 per=2.1e+01 cost=2.4e+06 flops=2.8e+09
 sigma[gemm] counter=31 i=3 t=8.3e-04 per=2.0e+01 cost=2.4e+06 flops=2.9e+09
 sigma[gemm] counter=31 i=4 t=7.3e-04 per=1.8e+01 cost=2.4e+06 flops=3.3e+09
 sigma[gemm] counter=31 i=5 t=7.4e-04 per=1.8e+01 cost=2.5e+06 flops=3.3e+09
 sigma[gemm] counter=31 total t=3.2e-03 per=7.7e+01 cost=9.7e+06 flops=3.1e+09
 sigma[red] counter=31 t=5.9e-04 per=1.4e+01 cost=9.6e+05 flops=1.6e+09
--- TIMING FOR sigma_tot : t_inter=5.1e-03 t_gemm=4.9e-02 t_reduction=9.8e-03 tot=6.4e-02 ---
 sigma_tot[inter] counter=31 t=5.1e-03 per=8.0e+00 cost=3.9e+07 flops=7.6e+09
 sigma_tot[gemm] counter=31 i=0 t=7.6e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=1 t=5.2e-05 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=2 t=1.3e-02 per=2.1e+01 cost=1.5e+07 flops=1.1e+09
 sigma_tot[gemm] counter=31 i=3 t=1.3e-02 per=2.0e+01 cost=1.5e+07 flops=1.1e+09
 sigma_tot[gemm] counter=31 i=4 t=1.1e-02 per=1.8e+01 cost=1.5e+07 flops=1.4e+09
 sigma_tot[gemm] counter=31 i=5 t=1.1e-02 per=1.8e+01 cost=1.6e+07 flops=1.4e+09
 sigma_tot[gemm] counter=31 total t=4.9e-02 per=7.7e+01 cost=6.0e+07 flops=1.2e+09
 sigma_tot[red] counter=31 t=9.8e-03 per=1.5e+01 cost=6.5e+06 flops=6.7e+08
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=9.7e-06,1.7e-05,3.2e-06,1.5e-05,6.8e-07
    3   0 -    -116.472895976776 -4.851e-05  2.113e-03    3     3  3.000e-02 9.999e-03 5.298e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.646e-05,4.042e-04,3.799e-03,7.105e-04,4.949e-03
 ndim=723:5.387e-06GB t[comm(intra)]=2.167e-05 speed=4.972e-01GB/S t[comm(inter)]=4.790e-06 speed=2.249e+00GB/S
--- TIMING FOR sigma : t_inter=4.0e-04 t_gemm=3.8e-03 t_reduction=7.1e-04 tot=4.9e-03 ---
 sigma[inter] counter=32 t=4.0e-04 per=8.2e+00 cost=6.2e+06 flops=1.5e+10
 sigma[gemm] counter=32 i=0 t=2.0e-06 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=1 t=1.8e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=2 t=9.8e-04 per=2.0e+01 cost=2.4e+06 flops=2.5e+09
 sigma[gemm] counter=32 i=3 t=9.8e-04 per=2.0e+01 cost=2.4e+06 flops=2.5e+09
 sigma[gemm] counter=32 i=4 t=9.3e-04 per=1.9e+01 cost=2.4e+06 flops=2.6e+09
 sigma[gemm] counter=32 i=5 t=9.0e-04 per=1.8e+01 cost=2.5e+06 flops=2.7e+09
 sigma[gemm] counter=32 total t=3.8e-03 per=7.7e+01 cost=9.7e+06 flops=2.6e+09
 sigma[red] counter=32 t=7.1e-04 per=1.4e+01 cost=9.6e+05 flops=1.4e+09
--- TIMING FOR sigma_tot : t_inter=5.5e-03 t_gemm=5.3e-02 t_reduction=1.1e-02 tot=6.9e-02 ---
 sigma_tot[inter] counter=32 t=5.5e-03 per=8.1e+00 cost=4.5e+07 flops=8.2e+09
 sigma_tot[gemm] counter=32 i=0 t=7.8e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=1 t=5.4e-05 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=2 t=1.4e-02 per=2.1e+01 cost=1.7e+07 flops=1.2e+09
 sigma_tot[gemm] counter=32 i=3 t=1.4e-02 per=2.0e+01 cost=1.7e+07 flops=1.2e+09
 sigma_tot[gemm] counter=32 i=4 t=1.2e-02 per=1.8e+01 cost=1.8e+07 flops=1.4e+09
 sigma_tot[gemm] counter=32 i=5 t=1.2e-02 per=1.8e+01 cost=1.8e+07 flops=1.5e+09
 sigma_tot[gemm] counter=32 total t=5.3e-02 per=7.7e+01 cost=7.0e+07 flops=1.3e+09
 sigma_tot[red] counter=32 t=1.1e-02 per=1.5e+01 cost=7.5e+06 flops=7.1e+08
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=9.0e-06,1.5e-05,3.1e-06,1.4e-05,6.8e-07
    4   0 -    -116.472904145427 -8.169e-06  8.780e-04    3     4  3.982e-02 9.954e-03 5.236e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=5.991e-05,3.924e-04,3.755e-03,6.828e-04,4.899e-03
 ndim=723:5.387e-06GB t[comm(intra)]=2.231e-05 speed=4.830e-01GB/S t[comm(inter)]=3.761e-05 speed=2.865e-01GB/S
--- TIMING FOR sigma : t_inter=3.9e-04 t_gemm=3.8e-03 t_reduction=6.8e-04 tot=4.8e-03 ---
 sigma[inter] counter=33 t=3.9e-04 per=8.1e+00 cost=6.2e+06 flops=1.6e+10
 sigma[gemm] counter=33 i=0 t=2.0e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=1 t=1.8e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=2 t=9.8e-04 per=2.0e+01 cost=2.4e+06 flops=2.4e+09
 sigma[gemm] counter=33 i=3 t=9.8e-04 per=2.0e+01 cost=2.4e+06 flops=2.5e+09
 sigma[gemm] counter=33 i=4 t=8.8e-04 per=1.8e+01 cost=2.4e+06 flops=2.7e+09
 sigma[gemm] counter=33 i=5 t=9.0e-04 per=1.9e+01 cost=2.5e+06 flops=2.7e+09
 sigma[gemm] counter=33 total t=3.8e-03 per=7.8e+01 cost=9.7e+06 flops=2.6e+09
 sigma[red] counter=33 t=6.8e-04 per=1.4e+01 cost=9.6e+05 flops=1.4e+09
--- TIMING FOR sigma_tot : t_inter=5.9e-03 t_gemm=5.6e-02 t_reduction=1.1e-02 tot=7.4e-02 ---
 sigma_tot[inter] counter=33 t=5.9e-03 per=8.1e+00 cost=5.2e+07 flops=8.7e+09
 sigma_tot[gemm] counter=33 i=0 t=8.0e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=1 t=5.5e-05 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=2 t=1.5e-02 per=2.1e+01 cost=1.9e+07 flops=1.3e+09
 sigma_tot[gemm] counter=33 i=3 t=1.5e-02 per=2.0e+01 cost=2.0e+07 flops=1.3e+09
 sigma_tot[gemm] counter=33 i=4 t=1.3e-02 per=1.8e+01 cost=2.0e+07 flops=1.5e+09
 sigma_tot[gemm] counter=33 i=5 t=1.3e-02 per=1.8e+01 cost=2.0e+07 flops=1.6e+09
 sigma_tot[gemm] counter=33 total t=5.6e-02 per=7.7e+01 cost=8.0e+07 flops=1.4e+09
 sigma_tot[red] counter=33 t=1.1e-02 per=1.5e+01 cost=8.5e+06 flops=7.5e+08
T(sub)=5.3e-05 T(gemm/eig/ortho/gemm/axpy)=9.1e-06,1.5e-05,2.9e-06,2.6e-05,4.7e-07
    5   0 -    -116.472905534313 -1.389e-06  3.140e-04    3     5  4.949e-02 9.898e-03 5.189e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.729e-05,4.211e-04,3.726e-03,7.024e-04,4.887e-03
 ndim=723:5.387e-06GB t[comm(intra)]=2.259e-05 speed=4.770e-01GB/S t[comm(inter)]=4.705e-06 speed=2.290e+00GB/S
--- TIMING FOR sigma : t_inter=4.2e-04 t_gemm=3.7e-03 t_reduction=7.0e-04 tot=4.8e-03 ---
 sigma[inter] counter=34 t=4.2e-04 per=8.7e+00 cost=6.2e+06 flops=1.5e+10
 sigma[gemm] counter=34 i=0 t=2.0e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=1 t=1.7e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=2 t=9.8e-04 per=2.0e+01 cost=2.4e+06 flops=2.5e+09
 sigma[gemm] counter=34 i=3 t=9.8e-04 per=2.0e+01 cost=2.4e+06 flops=2.5e+09
 sigma[gemm] counter=34 i=4 t=8.6e-04 per=1.8e+01 cost=2.4e+06 flops=2.8e+09
 sigma[gemm] counter=34 i=5 t=9.0e-04 per=1.9e+01 cost=2.5e+06 flops=2.7e+09
 sigma[gemm] counter=34 total t=3.7e-03 per=7.7e+01 cost=9.7e+06 flops=2.6e+09
 sigma[red] counter=34 t=7.0e-04 per=1.4e+01 cost=9.6e+05 flops=1.4e+09
--- TIMING FOR sigma_tot : t_inter=6.4e-03 t_gemm=6.0e-02 t_reduction=1.2e-02 tot=7.8e-02 ---
 sigma_tot[inter] counter=34 t=6.4e-03 per=8.1e+00 cost=5.8e+07 flops=9.1e+09
 sigma_tot[gemm] counter=34 i=0 t=8.2e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=1 t=5.7e-05 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=2 t=1.6e-02 per=2.1e+01 cost=2.2e+07 flops=1.4e+09
 sigma_tot[gemm] counter=34 i=3 t=1.6e-02 per=2.0e+01 cost=2.2e+07 flops=1.4e+09
 sigma_tot[gemm] counter=34 i=4 t=1.4e-02 per=1.8e+01 cost=2.2e+07 flops=1.6e+09
 sigma_tot[gemm] counter=34 i=5 t=1.4e-02 per=1.8e+01 cost=2.3e+07 flops=1.6e+09
 sigma_tot[gemm] counter=34 total t=6.0e-02 per=7.7e+01 cost=9.0e+07 flops=1.5e+09
 sigma_tot[red] counter=34 t=1.2e-02 per=1.5e+01 cost=9.4e+06 flops=7.9e+08
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=9.2e-06,1.4e-05,3.1e-06,1.4e-05,4.7e-07
    6   0 -    -116.472905718434 -1.841e-07  1.011e-04    3     6  5.913e-02 9.854e-03 5.156e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.799e-05,4.006e-04,3.710e-03,6.924e-04,4.840e-03
 ndim=723:5.387e-06GB t[comm(intra)]=2.327e-05 speed=4.629e-01GB/S t[comm(inter)]=4.720e-06 speed=2.283e+00GB/S
--- TIMING FOR sigma : t_inter=4.0e-04 t_gemm=3.7e-03 t_reduction=6.9e-04 tot=4.8e-03 ---
 sigma[inter] counter=35 t=4.0e-04 per=8.3e+00 cost=6.2e+06 flops=1.5e+10
 sigma[gemm] counter=35 i=0 t=2.0e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=1 t=1.8e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=2 t=9.6e-04 per=2.0e+01 cost=2.4e+06 flops=2.5e+09
 sigma[gemm] counter=35 i=3 t=9.7e-04 per=2.0e+01 cost=2.4e+06 flops=2.5e+09
 sigma[gemm] counter=35 i=4 t=8.8e-04 per=1.8e+01 cost=2.4e+06 flops=2.7e+09
 sigma[gemm] counter=35 i=5 t=8.9e-04 per=1.9e+01 cost=2.5e+06 flops=2.7e+09
 sigma[gemm] counter=35 total t=3.7e-03 per=7.7e+01 cost=9.7e+06 flops=2.6e+09
 sigma[red] counter=35 t=6.9e-04 per=1.4e+01 cost=9.6e+05 flops=1.4e+09
--- TIMING FOR sigma_tot : t_inter=6.8e-03 t_gemm=6.4e-02 t_reduction=1.3e-02 tot=8.3e-02 ---
 sigma_tot[inter] counter=35 t=6.8e-03 per=8.1e+00 cost=6.4e+07 flops=9.5e+09
 sigma_tot[gemm] counter=35 i=0 t=8.4e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=1 t=5.9e-05 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=2 t=1.7e-02 per=2.1e+01 cost=2.4e+07 flops=1.4e+09
 sigma_tot[gemm] counter=35 i=3 t=1.7e-02 per=2.0e+01 cost=2.5e+07 flops=1.5e+09
 sigma_tot[gemm] counter=35 i=4 t=1.5e-02 per=1.8e+01 cost=2.5e+07 flops=1.7e+09
 sigma_tot[gemm] counter=35 i=5 t=1.5e-02 per=1.8e+01 cost=2.5e+07 flops=1.7e+09
 sigma_tot[gemm] counter=35 total t=6.4e-02 per=7.7e+01 cost=9.9e+07 flops=1.6e+09
 sigma_tot[red] counter=35 t=1.3e-02 per=1.5e+01 cost=1.0e+07 flops=8.2e+08
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=9.3e-06,1.4e-05,3.1e-06,4.1e-06,5.2e-07
    7   0 +    -116.472905736041 -1.761e-08  2.892e-05    3     7  6.874e-02 9.821e-03 5.126e-03
TIMING FOR Davidson : 6.876e-02  T(cal/comm/rest)=3.588e-02,8.910e-07,3.287e-02
decomposed t_rest=3.287e-02
 T(sub)    =2.634e-04 per=8.014e-01
 T(precond)=3.236e-02 per=9.845e+01
 T(ortho)  =5.459e-05 per=1.661e-01
 T(xcopy)  =2.057e-06 per=6.258e-03
 T(xnrm2)  =5.060e-06 per=1.539e-02
 T(other)  =1.846e-04 per=5.615e-01
optimized energies: isweep=0 ibond=5 dots=1 e[0]=-116.472905736041 nmvp=7
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:5.092e+02S Sys:1.931e+00S Total:5.111e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=19 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond5.txt
 qbond: qsuper nsym=19 dimAll=152
 (8,2):14 (10,2):25 (9,3):20 (9,1):19 (11,1):14 (10,0):12 (11,3):9 (10,4):8 (7,3):5 (8,4):7 (12,2):3 (12,0):3 (11,-1):3 (9,5):2 (7,1):2 (8,0):3 (6,4):1 (7,5):1 (9,-1):1
timing for divide=1.8e-05
timing for compute=2.8e-04
timing for collect=2.1e-05
----- TMING FOR decimation_genbasis(nkr): 3.2e-04 S T(divide/compute/collect)=1.8e-05,2.8e-04,2.1e-05 -----
decimation summary: 152->47 dwt=-2.220e-16 SvN=1.761e+00
 qbond: qkept nsym=11 dimAll=47
 (10,2):9 (9,1):8 (10,0):8 (11,1):6 (8,2):4 (9,3):4 (11,-1):3 (8,0):2 (11,3):1 (7,3):1 (9,-1):1
----- TIMING for decimation_row(nkr): 9.765e-04 S T(decim/select/formRot)=4.106e-04,5.175e-04,4.837e-05 -----
----- TIMING FOR onedot_decimation: 1.142e-03 S T(wf/decim)=1.434e-04,9.987e-04 -----
ctns::oper_renorm coord=(6,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:14 S:26 H:1 A:91 B:105 
        dim(bra,ket)=47,47 size(op)=293:2.235e-03MB size(tot)=39416:3.007e-01MB:2.937e-04GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:5.097e+02S Sys:1.931e+00S Total:5.116e+02S
----- TIMING FOR symbolic_formulae_renorm with size=237 : 9.151e-03 S -----
rank=0 GPUmem(GB): used=0.000506 (oper)=0.000468
rank=0 GPUmem(GB): used=0.000511 (oper,site)(GB)=0.000468,5.39e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=267
 no. of coefficients=5310:0.0405MB:3.96e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.348e-04 S -----
rank=0 GPUmem(GB): used=0.000551 (oper,site,rinter)=0.000468,5.39e-06,3.96e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00824 S size(rtasks)=237 size(Rlst2)=121 T(Rmu/Rlist)=0.00154,0.00671 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00884 S size(rtasks)=237 size(Rlst)=6097 -----
rank=0 GPUmem(GB): used=0.000551 (oper,site,rinter,batch)=0.000468,5.39e-06,3.96e-05,0.0103 blksize=81 blksize0=64 batchsize=6097
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000333,0.00225,0.000624
--- TIMING FOR renorm : t_inter=3.3e-04 t_gemm=2.3e-03 t_reduction=6.2e-04 tot=3.2e-03 ---
 renorm[inter] counter=6 t=3.3e-04 per=1.0e+01 cost=2.5e+06 flops=7.4e+09
 renorm[gemm] counter=6 i=0 t=1.3e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=1 t=1.1e-06 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=2 t=1.1e-06 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=3 t=1.1e-06 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=4 t=5.9e-04 per=1.8e+01 cost=4.8e+05 flops=8.1e+08
 renorm[gemm] counter=6 i=5 t=7.5e-04 per=2.3e+01 cost=1.2e+06 flops=1.5e+09
 renorm[gemm] counter=6 i=6 t=9.1e-04 per=2.8e+01 cost=2.1e+06 flops=2.3e+09
 renorm[gemm] counter=6 total t=2.3e-03 per=7.0e+01 cost=3.8e+06 flops=1.7e+09
 renorm[red] counter=6 t=6.2e-04 per=1.9e+01 cost=4.2e+05 flops=6.7e+08
--- TIMING FOR renorm_tot : t_inter=1.1e-03 t_gemm=6.7e-03 t_reduction=2.1e-03 tot=9.9e-03 ---
 renorm_tot[inter] counter=6 t=1.1e-03 per=1.1e+01 cost=4.3e+06 flops=4.0e+09
 renorm_tot[gemm] counter=6 i=0 t=8.6e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=1 t=7.0e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=2 t=7.0e-06 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=3 t=6.8e-06 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=4 t=1.9e-03 per=1.9e+01 cost=1.1e+06 flops=5.7e+08
 renorm_tot[gemm] counter=6 i=5 t=2.1e-03 per=2.2e+01 cost=2.0e+06 flops=9.6e+08
 renorm_tot[gemm] counter=6 i=6 t=2.7e-03 per=2.7e+01 cost=4.6e+06 flops=1.7e+09
 renorm_tot[gemm] counter=6 total t=6.7e-03 per=6.8e+01 cost=7.7e+06 flops=1.2e+09
 renorm_tot[red] counter=6 t=2.1e-03 per=2.2e+01 cost=1.3e+06 flops=5.9e+08
qops.to_cpu: size(tot)=39416:3.0e-01MB:2.9e-04GB t[to_cpu]=9.6e-05S speed=3.1e+00GB/S
check ||H-H.dagger||=3.156e-14 coord=(6,0) rank=0
ctns::oper_ab2pq coord=(6,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0629 S rank=0 -----
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:5.098e+02S Sys:1.932e+00S Total:5.117e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=981:7.484e-03MB:7.309e-06GB
total mem of comb=16148:1.232e-01MB:1.203e-04GB
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:5.098e+02S Sys:1.932e+00S Total:5.117e+02S
##### local opt: 7.663e-01 S #####
 T(local opt: fetch) = 1.191e-02 S  per = 1.55  per(accum) = 1.55
 T(local opt: hdiag) = 2.126e-03 S  per = 0.277  per(accum) = 1.83
 T(local opt: dvdsn) = 6.852e-01 S  per = 89.4  per(accum) = 91.3
 T(local opt: decim) = 1.152e-03 S  per = 0.15  per(accum) = 91.4
 T(local opt: guess) = 3.261e-04 S  per = 0.0426  per(accum) = 91.5
 T(local opt: renrm) = 6.363e-02 S  per =  8.3  per(accum) = 99.8
 T(local opt: save ) = 1.881e-03 S  per = 0.246  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.852e-01 S  T(sum) = 6.848e-01 S  per = 9.994e+01
 T(local opt: preprocess                  ) = 5.288e-04 S  per = 0.0772  per(accum) = 0.0772
 T(local opt: symbolic_formulae           ) = 1.486e-02 S  per = 2.17  per(accum) = 2.25
 T(local opt: hintermediate init          ) = 3.292e-04 S  per = 0.0481  per(accum) = 2.3
 T(local opt: preprocess_hformulae_Hxlist ) = 1.836e-02 S  per = 2.68  per(accum) = 4.98
 T(local opt: hmmtasks init               ) = 5.820e-01 S  per =   85  per(accum) = 90
 T(local opt: initial guess for dvdson    ) = 8.606e-06 S  per = 0.00126  per(accum) = 90
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.564e-02 S  per =  5.2  per(accum) = 95.2
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.489e-04 S  per = 0.0363  per(accum) = 95.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 8.910e-07 S  per = 0.00013  per(accum) = 95.2
 T(local opt: dvdson solver [rest part]   ) = 3.287e-02 S  per =  4.8  per(accum) = 100
Detailed decomposition of T(renrm) = 6.363e-02 S  T(sum) = 6.363e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.225e-04 S  per = 0.35  per(accum) = 0.35
 T(local opt: qops init                    ) = 3.596e-03 S  per = 5.65  per(accum) = 6
 T(local opt: symbolic_formulae_renorm     ) = 9.164e-03 S  per = 14.4  per(accum) = 20.4
 T(local opt: allocate qops on gpu         ) = 2.632e-05 S  per = 0.0414  per(accum) = 20.4
 T(local opt: site memcpy cpu2gpu          ) = 2.004e-05 S  per = 0.0315  per(accum) = 20.5
 T(local opt: rintermediate init           ) = 4.451e-04 S  per =  0.7  per(accum) = 21.2
 T(local opt: preprocess_formulae_Rlist2   ) = 9.047e-03 S  per = 14.2  per(accum) = 35.4
 T(local opt: rmmtasks init                ) = 3.706e-02 S  per = 58.2  per(accum) = 93.6
 T(local opt: qops memset on cpu           ) = 5.900e-08 S  per = 9.27e-05  per(accum) = 93.6
 T(local opt: preprocess_renorm_batchGPU   ) = 3.311e-03 S  per =  5.2  per(accum) = 98.8
 T(local opt: reduction of opS & opH [nccl]) = 9.890e-07 S  per = 0.00155  per(accum) = 98.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.014e-04 S  per = 0.159  per(accum) = 99
 T(local opt: deallocate cpu and gpu memory) = 9.759e-05 S  per = 0.153  per(accum) = 99.2
 T(local opt: reduction of opS & opH [comm]) = 4.037e-05 S  per = 0.0634  per(accum) = 99.2
 T(local opt: conversion from opAB to opPQ ) = 3.768e-06 S  per = 0.00592  per(accum) = 99.2
 T(local opt: after oper_renorm            ) = 4.949e-04 S  per = 0.778  per(accum) = 100
##### sweep opt: 1.425e+00 S #####
 T(sweep opt: fetch) = 6.961e-02 S  per = 4.88  per(accum) = 4.88
 T(sweep opt: hdiag) = 5.492e-03 S  per = 0.385  per(accum) = 5.27
 T(sweep opt: dvdsn) = 1.097e+00 S  per =   77  per(accum) = 82.3
 T(sweep opt: decim) = 4.351e-03 S  per = 0.305  per(accum) = 82.6
 T(sweep opt: guess) = 1.279e-03 S  per = 0.0897  per(accum) = 82.7
 T(sweep opt: renrm) = 2.370e-01 S  per = 16.6  per(accum) = 99.3
 T(sweep opt: save ) = 9.900e-03 S  per = 0.695  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.097e+00 S  T(sum) = 1.095e+00 S  per = 9.977e+01
 T(sweep opt: preprocess                  ) = 2.010e-03 S  per = 0.184  per(accum) = 0.184
 T(sweep opt: symbolic_formulae           ) = 4.485e-02 S  per =  4.1  per(accum) = 4.28
 T(sweep opt: hintermediate init          ) = 1.042e-03 S  per = 0.0952  per(accum) = 4.37
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.894e-02 S  per = 3.56  per(accum) = 7.93
 T(sweep opt: hmmtasks init               ) = 6.635e-01 S  per = 60.6  per(accum) = 68.5
 T(sweep opt: initial guess for dvdson    ) = 2.592e-05 S  per = 0.00237  per(accum) = 68.5
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 8.779e-02 S  per = 8.02  per(accum) = 76.6
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 1.000e-03 S  per = 0.0913  per(accum) = 76.6
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 4.685e-06 S  per = 0.000428  per(accum) = 76.6
 T(sweep opt: dvdson solver [rest part]   ) = 2.557e-01 S  per = 23.4  per(accum) = 100
Detailed decomposition of T(renrm) = 2.370e-01 S  T(sum) = 2.370e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.031e-03 S  per = 0.435  per(accum) = 0.435
 T(sweep opt: qops init                    ) = 1.214e-02 S  per = 5.12  per(accum) = 5.56
 T(sweep opt: symbolic_formulae_renorm     ) = 3.328e-02 S  per =   14  per(accum) = 19.6
 T(sweep opt: allocate qops on gpu         ) = 1.575e-04 S  per = 0.0665  per(accum) = 19.7
 T(sweep opt: site memcpy cpu2gpu          ) = 1.182e-04 S  per = 0.0499  per(accum) = 19.7
 T(sweep opt: rintermediate init           ) = 2.097e-03 S  per = 0.885  per(accum) = 20.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.511e-02 S  per = 14.8  per(accum) = 35.4
 T(sweep opt: rmmtasks init                ) = 1.388e-01 S  per = 58.6  per(accum) = 94
 T(sweep opt: qops memset on cpu           ) = 3.660e-07 S  per = 0.000154  per(accum) = 94
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.051e-02 S  per = 4.44  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [nccl]) = 6.290e-06 S  per = 0.00265  per(accum) = 98.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.920e-04 S  per = 0.123  per(accum) = 98.6
 T(sweep opt: deallocate cpu and gpu memory) = 9.512e-04 S  per = 0.401  per(accum) = 99
 T(sweep opt: reduction of opS & opH [comm]) = 2.132e-04 S  per = 0.09  per(accum) = 99
 T(sweep opt: conversion from opAB to opPQ ) = 2.258e-05 S  per = 0.00953  per(accum) = 99.1
 T(sweep opt: after oper_renorm            ) = 2.248e-03 S  per = 0.949  per(accum) = 100
##### global opt: 1.425e+00 S #####
 T(global opt: fetch) = 6.961e-02 S  per = 4.88  per(accum) = 4.88
 T(global opt: hdiag) = 5.492e-03 S  per = 0.385  per(accum) = 5.27
 T(global opt: dvdsn) = 1.097e+00 S  per =   77  per(accum) = 82.3
 T(global opt: decim) = 4.351e-03 S  per = 0.305  per(accum) = 82.6
 T(global opt: guess) = 1.279e-03 S  per = 0.0897  per(accum) = 82.7
 T(global opt: renrm) = 2.370e-01 S  per = 16.6  per(accum) = 99.3
 T(global opt: save ) = 9.900e-03 S  per = 0.695  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.097e+00 S  T(sum) = 1.095e+00 S  per = 9.977e+01
 T(global opt: preprocess                  ) = 2.010e-03 S  per = 0.184  per(accum) = 0.184
 T(global opt: symbolic_formulae           ) = 4.485e-02 S  per =  4.1  per(accum) = 4.28
 T(global opt: hintermediate init          ) = 1.042e-03 S  per = 0.0952  per(accum) = 4.37
 T(global opt: preprocess_hformulae_Hxlist ) = 3.894e-02 S  per = 3.56  per(accum) = 7.93
 T(global opt: hmmtasks init               ) = 6.635e-01 S  per = 60.6  per(accum) = 68.5
 T(global opt: initial guess for dvdson    ) = 2.592e-05 S  per = 0.00237  per(accum) = 68.5
 T(global opt: dvdson solver [Hx_batchGPU] ) = 8.779e-02 S  per = 8.02  per(accum) = 76.6
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.000e-03 S  per = 0.0913  per(accum) = 76.6
 T(global opt: dvdson solver [comm(cpu)]   ) = 4.685e-06 S  per = 0.000428  per(accum) = 76.6
 T(global opt: dvdson solver [rest part]   ) = 2.557e-01 S  per = 23.4  per(accum) = 100
Detailed decomposition of T(renrm) = 2.370e-01 S  T(sum) = 2.370e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.031e-03 S  per = 0.435  per(accum) = 0.435
 T(global opt: qops init                    ) = 1.214e-02 S  per = 5.12  per(accum) = 5.56
 T(global opt: symbolic_formulae_renorm     ) = 3.328e-02 S  per =   14  per(accum) = 19.6
 T(global opt: allocate qops on gpu         ) = 1.575e-04 S  per = 0.0665  per(accum) = 19.7
 T(global opt: site memcpy cpu2gpu          ) = 1.182e-04 S  per = 0.0499  per(accum) = 19.7
 T(global opt: rintermediate init           ) = 2.097e-03 S  per = 0.885  per(accum) = 20.6
 T(global opt: preprocess_formulae_Rlist2   ) = 3.511e-02 S  per = 14.8  per(accum) = 35.4
 T(global opt: rmmtasks init                ) = 1.388e-01 S  per = 58.6  per(accum) = 94
 T(global opt: qops memset on cpu           ) = 3.660e-07 S  per = 0.000154  per(accum) = 94
 T(global opt: preprocess_renorm_batchGPU   ) = 1.051e-02 S  per = 4.44  per(accum) = 98.4
 T(global opt: reduction of opS & opH [nccl]) = 6.290e-06 S  per = 0.00265  per(accum) = 98.4
 T(global opt: qops memcpy gpu2cpu          ) = 2.920e-04 S  per = 0.123  per(accum) = 98.6
 T(global opt: deallocate cpu and gpu memory) = 9.512e-04 S  per = 0.401  per(accum) = 99
 T(global opt: reduction of opS & opH [comm]) = 2.132e-04 S  per = 0.09  per(accum) = 99
 T(global opt: conversion from opAB to opPQ ) = 2.258e-05 S  per = 0.00953  per(accum) = 99.1
 T(global opt: after oper_renorm            ) = 2.248e-03 S  per = 0.949  per(accum) = 100

isweep=0 ibond=6/seqsize=34 dots=1 dbond=(7,0)-(8,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.004e+01GB RSS:1.908e+00GB  Timing: User:5.098e+02S Sys:1.932e+00S Total:5.117e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=981:7.484e-03MB:7.309e-06GB
total mem of comb=16148:1.232e-01MB:1.203e-04GB
ctns::topology::check_partition: (sl,sr,sc)=7,12,1
 suppl= 0 1 2 3 4 16 17
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 18
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:14 S:26 H:1 A:91 B:105 
        dim(bra,ket)=47,47 size(op)=293:2.235e-03MB size(tot)=39416:3.007e-01MB:2.937e-04GB
 rqops: oplist=CSHPQ nops=C:24 S:16 H:1 P:120 Q:136 
        dim(bra,ket)=57,57 size(op)=361:2.754e-03MB size(tot)=66125:5.045e-01MB:4.927e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=107877:8.230e-01MB:8.037e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(7,0) fdel=./scratch/sweep/rop(8,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
wf3(diml,dimr,dimc)=(47,57,4) nnz=981:7.484e-03MB
qtensor3: wf3 own=1 _data=0x528c93c0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=11 dimAll=47
 (10,2):9 (9,1):8 (10,0):8 (11,1):6 (8,2):4 (9,3):4 (11,-1):3 (8,0):2 (11,3):1 (7,3):1 (9,-1):1
 qbond: qcol nsym=12 dimAll=57
 (19,-1):10 (18,0):8 (18,-2):8 (17,-1):6 (20,0):5 (20,-2):5 (19,-3):4 (19,1):4 (17,1):3 (21,-1):2 (17,-3):1 (21,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=33 nblocks=528 size=981:7.484e-03MB
### DIAG TIMING: total=2.764e-03 t1=1.260e-05, t2=1.519e-05, t3=3.524e-05, t4=2.663e-03, t5=1.960e-05, t6=1.444e-05, t7=3.137e-06
duration_diagGPU:2.774e-03
duration_diagreduce:4.500e-08
duration_diagtransform:3.317e-06
----- TIMING FOR symbolic_formulae_onedot with size=1053 : 1.852e-02 S -----
rank=0 GPUmem(GB): used=0.000804 (oper)=0.000804
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1053
 no. of hintermediate operators=518
 no. of coefficients=6216:0.0474MB:4.63e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.992e-04 S -----
rank=0 GPUmem(GB): used=0.00085 (oper,hinter)=0.000804,4.63e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0243 S size(H_formulae)=1053 size(Hxlst2)=33 T(Hmu/Hxlist)=0.00245,0.0218 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0274 S size(H_formulae)=1053 size(Hxlst)=26310 -----
rank=0 GPUmem(GB): used=0.052 (oper,hinter,dvdson,batch)=0.000804,4.63e-05,1.46e-05,0.0512 blksize=90 blksize0=80 batchsize=26310
ctns::pdvdsonSolver_nkr::solve_iter ndim=981 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.66e-05,0.000414,0.00508,0.000785,0.00634
 ndim=981:7.31e-06GB t[comm(intra)]=2.65e-05 speed=0.551GB/S t[comm(inter)]=1.01e-05 speed=1.45GB/S
--- TIMING FOR sigma : t_inter=4.1e-04 t_gemm=5.1e-03 t_reduction=7.8e-04 tot=6.3e-03 ---
 sigma[inter] counter=36 t=4.1e-04 per=6.6e+00 cost=9.3e+06 flops=2.3e+10
 sigma[gemm] counter=36 i=0 t=1.4e-06 per=2.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=1 t=1.1e-06 per=1.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=2 t=1.3e-03 per=2.1e+01 cost=4.5e+06 flops=3.5e+09
 sigma[gemm] counter=36 i=3 t=1.2e-03 per=1.9e+01 cost=4.5e+06 flops=3.8e+09
 sigma[gemm] counter=36 i=4 t=1.3e-03 per=2.0e+01 cost=5.1e+06 flops=4.0e+09
 sigma[gemm] counter=36 i=5 t=1.3e-03 per=2.1e+01 cost=5.4e+06 flops=4.2e+09
 sigma[gemm] counter=36 total t=5.1e-03 per=8.1e+01 cost=2.0e+07 flops=3.9e+09
 sigma[red] counter=36 t=7.8e-04 per=1.2e+01 cost=1.8e+06 flops=2.2e+09
--- TIMING FOR sigma_tot : t_inter=7.2e-03 t_gemm=6.9e-02 t_reduction=1.3e-02 tot=8.9e-02 ---
 sigma_tot[inter] counter=36 t=7.2e-03 per=8.0e+00 cost=7.3e+07 flops=1.0e+10
 sigma_tot[gemm] counter=36 i=0 t=8.5e-05 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=1 t=6.0e-05 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=2 t=1.8e-02 per=2.1e+01 cost=2.9e+07 flops=1.6e+09
 sigma_tot[gemm] counter=36 i=3 t=1.8e-02 per=2.0e+01 cost=2.9e+07 flops=1.6e+09
 sigma_tot[gemm] counter=36 i=4 t=1.6e-02 per=1.8e+01 cost=3.0e+07 flops=1.9e+09
 sigma_tot[gemm] counter=36 i=5 t=1.6e-02 per=1.8e+01 cost=3.1e+07 flops=1.9e+09
 sigma_tot[gemm] counter=36 total t=6.9e-02 per=7.7e+01 cost=1.2e+08 flops=1.7e+09
 sigma_tot[red] counter=36 t=1.3e-02 per=1.5e+01 cost=1.2e+07 flops=9.1e+08
T(sub)=1.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,5.3e-06,1.8e-06,1.7e-06,4.9e-07
settings: ndim=981 neig=1 maxcycle=30 nbuff=4 memory=0.0001GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.472905736041 -1.116e+03  7.257e-02    1     1  6.462e-03 6.462e-03 6.431e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.945e-05,5.430e-04,5.272e-03,8.861e-04,6.752e-03
 ndim=981:7.309e-06GB t[comm(intra)]=3.427e-05 speed=4.266e-01GB/S t[comm(inter)]=5.185e-06 speed=2.819e+00GB/S
--- TIMING FOR sigma : t_inter=5.4e-04 t_gemm=5.3e-03 t_reduction=8.9e-04 tot=6.7e-03 ---
 sigma[inter] counter=37 t=5.4e-04 per=8.1e+00 cost=9.3e+06 flops=1.7e+10
 sigma[gemm] counter=37 i=0 t=2.0e-06 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=1 t=1.7e-06 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=2 t=1.3e-03 per=1.9e+01 cost=4.5e+06 flops=3.5e+09
 sigma[gemm] counter=37 i=3 t=1.3e-03 per=2.0e+01 cost=4.5e+06 flops=3.4e+09
 sigma[gemm] counter=37 i=4 t=1.3e-03 per=1.9e+01 cost=5.1e+06 flops=4.0e+09
 sigma[gemm] counter=37 i=5 t=1.3e-03 per=2.0e+01 cost=5.4e+06 flops=4.0e+09
 sigma[gemm] counter=37 total t=5.3e-03 per=7.9e+01 cost=2.0e+07 flops=3.7e+09
 sigma[red] counter=37 t=8.9e-04 per=1.3e+01 cost=1.8e+06 flops=2.0e+09
--- TIMING FOR sigma_tot : t_inter=7.7e-03 t_gemm=7.4e-02 t_reduction=1.4e-02 tot=9.6e-02 ---
 sigma_tot[inter] counter=37 t=7.7e-03 per=8.0e+00 cost=8.3e+07 flops=1.1e+10
 sigma_tot[gemm] counter=37 i=0 t=8.7e-05 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=1 t=6.2e-05 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=2 t=2.0e-02 per=2.1e+01 cost=3.3e+07 flops=1.7e+09
 sigma_tot[gemm] counter=37 i=3 t=1.9e-02 per=2.0e+01 cost=3.4e+07 flops=1.7e+09
 sigma_tot[gemm] counter=37 i=4 t=1.7e-02 per=1.8e+01 cost=3.5e+07 flops=2.0e+09
 sigma_tot[gemm] counter=37 i=5 t=1.7e-02 per=1.8e+01 cost=3.6e+07 flops=2.1e+09
 sigma_tot[gemm] counter=37 total t=7.4e-02 per=7.7e+01 cost=1.4e+08 flops=1.9e+09
 sigma_tot[red] counter=37 t=1.4e-02 per=1.5e+01 cost=1.4e+07 flops=9.7e+08
T(sub)=4.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.3e-05,1.5e-05,1.4e-05,3.5e-06,6.1e-07
    2   0 -    -116.480768071891 -7.862e-03  1.906e-02    2     2  1.825e-02 9.124e-03 6.665e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.659e-05,5.429e-04,5.100e-03,7.404e-04,6.429e-03
 ndim=981:7.309e-06GB t[comm(intra)]=3.181e-05 speed=4.596e-01GB/S t[comm(inter)]=4.783e-06 speed=3.056e+00GB/S
--- TIMING FOR sigma : t_inter=5.4e-04 t_gemm=5.1e-03 t_reduction=7.4e-04 tot=6.4e-03 ---
 sigma[inter] counter=38 t=5.4e-04 per=8.5e+00 cost=9.3e+06 flops=1.7e+10
 sigma[gemm] counter=38 i=0 t=2.0e-06 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=1 t=1.7e-06 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=2 t=1.3e-03 per=2.0e+01 cost=4.5e+06 flops=3.5e+09
 sigma[gemm] counter=38 i=3 t=1.3e-03 per=2.1e+01 cost=4.5e+06 flops=3.4e+09
 sigma[gemm] counter=38 i=4 t=1.3e-03 per=2.0e+01 cost=5.1e+06 flops=4.0e+09
 sigma[gemm] counter=38 i=5 t=1.2e-03 per=1.9e+01 cost=5.4e+06 flops=4.5e+09
 sigma[gemm] counter=38 total t=5.1e-03 per=8.0e+01 cost=2.0e+07 flops=3.8e+09
 sigma[red] counter=38 t=7.4e-04 per=1.2e+01 cost=1.8e+06 flops=2.4e+09
--- TIMING FOR sigma_tot : t_inter=8.3e-03 t_gemm=7.9e-02 t_reduction=1.5e-02 tot=1.0e-01 ---
 sigma_tot[inter] counter=38 t=8.3e-03 per=8.0e+00 cost=9.2e+07 flops=1.1e+10
 sigma_tot[gemm] counter=38 i=0 t=8.9e-05 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=1 t=6.3e-05 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=2 t=2.1e-02 per=2.0e+01 cost=3.8e+07 flops=1.8e+09
 sigma_tot[gemm] counter=38 i=3 t=2.1e-02 per=2.0e+01 cost=3.8e+07 flops=1.8e+09
 sigma_tot[gemm] counter=38 i=4 t=1.9e-02 per=1.8e+01 cost=4.0e+07 flops=2.2e+09
 sigma_tot[gemm] counter=38 i=5 t=1.9e-02 per=1.8e+01 cost=4.2e+07 flops=2.2e+09
 sigma_tot[gemm] counter=38 total t=7.9e-02 per=7.7e+01 cost=1.6e+08 flops=2.0e+09
 sigma_tot[red] counter=38 t=1.5e-02 per=1.5e+01 cost=1.6e+07 flops=1.0e+09
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.6e-05,3.1e-06,4.9e-06,5.9e-07
    3   0 -    -116.481359404629 -5.913e-04  6.739e-03    3     3  2.964e-02 9.881e-03 6.621e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.669e-05,5.351e-04,5.088e-03,7.560e-04,6.416e-03
 ndim=981:7.309e-06GB t[comm(intra)]=2.227e-05 speed=6.565e-01GB/S t[comm(inter)]=4.422e-06 speed=3.306e+00GB/S
--- TIMING FOR sigma : t_inter=5.3e-04 t_gemm=5.1e-03 t_reduction=7.6e-04 tot=6.4e-03 ---
 sigma[inter] counter=39 t=5.3e-04 per=8.4e+00 cost=9.3e+06 flops=1.7e+10
 sigma[gemm] counter=39 i=0 t=2.1e-06 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=1 t=1.8e-06 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=2 t=1.3e-03 per=2.0e+01 cost=4.5e+06 flops=3.5e+09
 sigma[gemm] counter=39 i=3 t=1.3e-03 per=2.1e+01 cost=4.5e+06 flops=3.4e+09
 sigma[gemm] counter=39 i=4 t=1.3e-03 per=2.0e+01 cost=5.1e+06 flops=4.0e+09
 sigma[gemm] counter=39 i=5 t=1.2e-03 per=1.9e+01 cost=5.4e+06 flops=4.5e+09
 sigma[gemm] counter=39 total t=5.1e-03 per=8.0e+01 cost=2.0e+07 flops=3.8e+09
 sigma[red] counter=39 t=7.6e-04 per=1.2e+01 cost=1.8e+06 flops=2.3e+09
--- TIMING FOR sigma_tot : t_inter=8.8e-03 t_gemm=8.4e-02 t_reduction=1.6e-02 tot=1.1e-01 ---
 sigma_tot[inter] counter=39 t=8.8e-03 per=8.1e+00 cost=1.0e+08 flops=1.2e+10
 sigma_tot[gemm] counter=39 i=0 t=9.1e-05 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=1 t=6.5e-05 per=6.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=2 t=2.2e-02 per=2.0e+01 cost=4.2e+07 flops=1.9e+09
 sigma_tot[gemm] counter=39 i=3 t=2.2e-02 per=2.0e+01 cost=4.3e+07 flops=1.9e+09
 sigma_tot[gemm] counter=39 i=4 t=2.0e-02 per=1.8e+01 cost=4.5e+07 flops=2.3e+09
 sigma_tot[gemm] counter=39 i=5 t=2.0e-02 per=1.8e+01 cost=4.7e+07 flops=2.4e+09
 sigma_tot[gemm] counter=39 total t=8.4e-02 per=7.7e+01 cost=1.8e+08 flops=2.1e+09
 sigma_tot[red] counter=39 t=1.6e-02 per=1.4e+01 cost=1.7e+07 flops=1.1e+09
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.5e-05,3.1e-06,1.5e-05,4.7e-07
    4   0 -    -116.481441657423 -8.225e-05  2.446e-03    3     4  4.084e-02 1.021e-02 6.596e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.790e-05,5.499e-04,5.125e-03,7.275e-04,6.440e-03
 ndim=981:7.309e-06GB t[comm(intra)]=2.341e-05 speed=6.245e-01GB/S t[comm(inter)]=4.489e-06 speed=3.256e+00GB/S
--- TIMING FOR sigma : t_inter=5.4e-04 t_gemm=5.1e-03 t_reduction=7.3e-04 tot=6.4e-03 ---
 sigma[inter] counter=40 t=5.4e-04 per=8.4e+00 cost=9.3e+06 flops=1.7e+10
 sigma[gemm] counter=40 i=0 t=2.0e-06 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=1 t=1.7e-06 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=2 t=1.3e-03 per=2.0e+01 cost=4.5e+06 flops=3.5e+09
 sigma[gemm] counter=40 i=3 t=1.3e-03 per=2.1e+01 cost=4.5e+06 flops=3.4e+09
 sigma[gemm] counter=40 i=4 t=1.3e-03 per=2.0e+01 cost=5.1e+06 flops=4.0e+09
 sigma[gemm] counter=40 i=5 t=1.2e-03 per=1.9e+01 cost=5.4e+06 flops=4.5e+09
 sigma[gemm] counter=40 total t=5.1e-03 per=8.0e+01 cost=2.0e+07 flops=3.8e+09
 sigma[red] counter=40 t=7.3e-04 per=1.1e+01 cost=1.8e+06 flops=2.4e+09
--- TIMING FOR sigma_tot : t_inter=9.3e-03 t_gemm=9.0e-02 t_reduction=1.7e-02 tot=1.2e-01 ---
 sigma_tot[inter] counter=40 t=9.3e-03 per=8.1e+00 cost=1.1e+08 flops=1.2e+10
 sigma_tot[gemm] counter=40 i=0 t=9.3e-05 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=1 t=6.7e-05 per=5.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=2 t=2.4e-02 per=2.0e+01 cost=4.7e+07 flops=2.0e+09
 sigma_tot[gemm] counter=40 i=3 t=2.3e-02 per=2.0e+01 cost=4.7e+07 flops=2.0e+09
 sigma_tot[gemm] counter=40 i=4 t=2.1e-02 per=1.8e+01 cost=5.0e+07 flops=2.4e+09
 sigma_tot[gemm] counter=40 i=5 t=2.1e-02 per=1.8e+01 cost=5.2e+07 flops=2.5e+09
 sigma_tot[gemm] counter=40 total t=9.0e-02 per=7.8e+01 cost=2.0e+08 flops=2.2e+09
 sigma_tot[red] counter=40 t=1.7e-02 per=1.4e+01 cost=1.9e+07 flops=1.2e+09
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.4e-05,3.1e-06,1.6e-05,4.9e-07
    5   0 -    -116.481450771150 -9.114e-06  8.482e-04    3     5  5.205e-02 1.041e-02 6.585e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.854e-05,5.556e-04,5.089e-03,7.390e-04,6.433e-03
 ndim=981:7.309e-06GB t[comm(intra)]=3.299e-05 speed=4.431e-01GB/S t[comm(inter)]=5.556e-06 speed=2.631e+00GB/S
--- TIMING FOR sigma : t_inter=5.6e-04 t_gemm=5.1e-03 t_reduction=7.4e-04 tot=6.4e-03 ---
 sigma[inter] counter=41 t=5.6e-04 per=8.7e+00 cost=9.3e+06 flops=1.7e+10
 sigma[gemm] counter=41 i=0 t=2.0e-06 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=1 t=1.7e-06 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=2 t=1.3e-03 per=2.0e+01 cost=4.5e+06 flops=3.6e+09
 sigma[gemm] counter=41 i=3 t=1.3e-03 per=2.1e+01 cost=4.5e+06 flops=3.4e+09
 sigma[gemm] counter=41 i=4 t=1.3e-03 per=2.0e+01 cost=5.1e+06 flops=4.0e+09
 sigma[gemm] counter=41 i=5 t=1.2e-03 per=1.9e+01 cost=5.4e+06 flops=4.5e+09
 sigma[gemm] counter=41 total t=5.1e-03 per=8.0e+01 cost=2.0e+07 flops=3.8e+09
 sigma[red] counter=41 t=7.4e-04 per=1.2e+01 cost=1.8e+06 flops=2.4e+09
--- TIMING FOR sigma_tot : t_inter=9.9e-03 t_gemm=9.5e-02 t_reduction=1.7e-02 tot=1.2e-01 ---
 sigma_tot[inter] counter=41 t=9.9e-03 per=8.1e+00 cost=1.2e+08 flops=1.2e+10
 sigma_tot[gemm] counter=41 i=0 t=9.5e-05 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=1 t=6.9e-05 per=5.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=2 t=2.5e-02 per=2.0e+01 cost=5.1e+07 flops=2.1e+09
 sigma_tot[gemm] counter=41 i=3 t=2.5e-02 per=2.0e+01 cost=5.2e+07 flops=2.1e+09
 sigma_tot[gemm] counter=41 i=4 t=2.3e-02 per=1.9e+01 cost=5.5e+07 flops=2.5e+09
 sigma_tot[gemm] counter=41 i=5 t=2.2e-02 per=1.8e+01 cost=5.8e+07 flops=2.6e+09
 sigma_tot[gemm] counter=41 total t=9.5e-02 per=7.8e+01 cost=2.2e+08 flops=2.3e+09
 sigma_tot[red] counter=41 t=1.7e-02 per=1.4e+01 cost=2.1e+07 flops=1.2e+09
T(sub)=3.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.4e-05,3.1e-06,4.9e-06,5.8e-07
    6   0 -    -116.481452149214 -1.378e-06  3.905e-04    3     6  6.325e-02 1.054e-02 6.578e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.767e-05,5.582e-04,5.107e-03,7.467e-04,6.459e-03
 ndim=981:7.309e-06GB t[comm(intra)]=3.268e-05 speed=4.473e-01GB/S t[comm(inter)]=4.997e-06 speed=2.925e+00GB/S
--- TIMING FOR sigma : t_inter=5.6e-04 t_gemm=5.1e-03 t_reduction=7.5e-04 tot=6.4e-03 ---
 sigma[inter] counter=42 t=5.6e-04 per=8.7e+00 cost=9.3e+06 flops=1.7e+10
 sigma[gemm] counter=42 i=0 t=2.0e-06 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=1 t=1.7e-06 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=2 t=1.3e-03 per=2.0e+01 cost=4.5e+06 flops=3.6e+09
 sigma[gemm] counter=42 i=3 t=1.3e-03 per=2.1e+01 cost=4.5e+06 flops=3.4e+09
 sigma[gemm] counter=42 i=4 t=1.3e-03 per=2.0e+01 cost=5.1e+06 flops=3.9e+09
 sigma[gemm] counter=42 i=5 t=1.2e-03 per=1.9e+01 cost=5.4e+06 flops=4.5e+09
 sigma[gemm] counter=42 total t=5.1e-03 per=8.0e+01 cost=2.0e+07 flops=3.8e+09
 sigma[red] counter=42 t=7.5e-04 per=1.2e+01 cost=1.8e+06 flops=2.4e+09
--- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=1.0e-01 t_reduction=1.8e-02 tot=1.3e-01 ---
 sigma_tot[inter] counter=42 t=1.0e-02 per=8.1e+00 cost=1.3e+08 flops=1.2e+10
 sigma_tot[gemm] counter=42 i=0 t=9.7e-05 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=1 t=7.0e-05 per=5.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=2 t=2.6e-02 per=2.0e+01 cost=5.6e+07 flops=2.1e+09
 sigma_tot[gemm] counter=42 i=3 t=2.6e-02 per=2.0e+01 cost=5.7e+07 flops=2.2e+09
 sigma_tot[gemm] counter=42 i=4 t=2.4e-02 per=1.9e+01 cost=6.1e+07 flops=2.5e+09
 sigma_tot[gemm] counter=42 i=5 t=2.3e-02 per=1.8e+01 cost=6.3e+07 flops=2.7e+09
 sigma_tot[gemm] counter=42 total t=1.0e-01 per=7.8e+01 cost=2.4e+08 flops=2.4e+09
 sigma_tot[red] counter=42 t=1.8e-02 per=1.4e+01 cost=2.3e+07 flops=1.3e+09
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.4e-05,3.1e-06,5.0e-06,1.1e-05
    7   0 -    -116.481452424417 -2.752e-07  1.285e-04    3     7  7.446e-02 1.064e-02 6.575e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.707e-05,5.400e-04,5.077e-03,7.291e-04,6.393e-03
 ndim=981:7.309e-06GB t[comm(intra)]=2.243e-05 speed=6.517e-01GB/S t[comm(inter)]=1.465e-05 speed=9.981e-01GB/S
--- TIMING FOR sigma : t_inter=5.4e-04 t_gemm=5.1e-03 t_reduction=7.3e-04 tot=6.3e-03 ---
 sigma[inter] counter=43 t=5.4e-04 per=8.5e+00 cost=9.3e+06 flops=1.7e+10
 sigma[gemm] counter=43 i=0 t=1.9e-06 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=1 t=1.7e-06 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=2 t=1.3e-03 per=2.0e+01 cost=4.5e+06 flops=3.6e+09
 sigma[gemm] counter=43 i=3 t=1.3e-03 per=2.1e+01 cost=4.5e+06 flops=3.4e+09
 sigma[gemm] counter=43 i=4 t=1.3e-03 per=2.0e+01 cost=5.1e+06 flops=4.0e+09
 sigma[gemm] counter=43 i=5 t=1.2e-03 per=1.9e+01 cost=5.4e+06 flops=4.5e+09
 sigma[gemm] counter=43 total t=5.1e-03 per=8.0e+01 cost=2.0e+07 flops=3.9e+09
 sigma[red] counter=43 t=7.3e-04 per=1.1e+01 cost=1.8e+06 flops=2.4e+09
--- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=1.0e-01 t_reduction=1.9e-02 tot=1.3e-01 ---
 sigma_tot[inter] counter=43 t=1.1e-02 per=8.2e+00 cost=1.4e+08 flops=1.3e+10
 sigma_tot[gemm] counter=43 i=0 t=9.9e-05 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=1 t=7.2e-05 per=5.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=2 t=2.7e-02 per=2.0e+01 cost=6.0e+07 flops=2.2e+09
 sigma_tot[gemm] counter=43 i=3 t=2.7e-02 per=2.0e+01 cost=6.1e+07 flops=2.2e+09
 sigma_tot[gemm] counter=43 i=4 t=2.5e-02 per=1.9e+01 cost=6.6e+07 flops=2.6e+09
 sigma_tot[gemm] counter=43 i=5 t=2.5e-02 per=1.8e+01 cost=6.9e+07 flops=2.8e+09
 sigma_tot[gemm] counter=43 total t=1.0e-01 per=7.8e+01 cost=2.6e+08 flops=2.4e+09
 sigma_tot[red] counter=43 t=1.9e-02 per=1.4e+01 cost=2.5e+07 flops=1.3e+09
T(sub)=3.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.4e-05,3.1e-06,5.5e-06,6.1e-07
    8   0 +    -116.481452453825 -2.941e-08  4.235e-05    3     8  8.565e-02 1.071e-02 6.566e-03
TIMING FOR Davidson : 8.566e-02  T(cal/comm/rest)=5.253e-02,1.032e-06,3.314e-02
decomposed t_rest=3.314e-02
 T(sub)    =2.949e-04 per=8.898e-01
 T(precond)=3.253e-02 per=9.817e+01
 T(ortho)  =7.801e-05 per=2.354e-01
 T(xcopy)  =6.738e-06 per=2.033e-02
 T(xnrm2)  =6.179e-06 per=1.865e-02
 T(other)  =2.190e-04 per=6.608e-01
optimized energies: isweep=0 ibond=6 dots=1 e[0]=-116.481452453825 nmvp=8
CPUmem: VM:2.005e+01GB RSS:1.913e+00GB  Timing: User:5.187e+02S Sys:1.935e+00S Total:5.207e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=21 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond6.txt
 qbond: qsuper nsym=21 dimAll=188
 (10,2):25 (12,2):16 (11,3):14 (11,1):31 (9,1):14 (10,0):19 (12,0):17 (11,-1):12 (13,1):6 (8,2):5 (9,3):9 (10,4):4 (13,-1):3 (12,-2):3 (8,0):2 (9,-1):3 (13,3):1 (12,4):1 (7,3):1 (8,4):1 (10,-2):1
timing for divide=1.9e-05
timing for compute=3.0e-04
timing for collect=2.1e-05
----- TMING FOR decimation_genbasis(nkr): 3.4e-04 S T(divide/compute/collect)=1.9e-05,3.0e-04,2.1e-05 -----
decimation summary: 188->57 dwt=+0.000e+00 SvN=1.888e+00
 qbond: qkept nsym=12 dimAll=57
 (11,1):10 (12,2):8 (12,0):8 (13,1):6 (10,2):5 (10,0):5 (11,3):4 (11,-1):4 (13,-1):3 (9,1):2 (9,3):1 (13,3):1
----- TIMING for decimation_row(nkr): 1.090e-03 S T(decim/select/formRot)=4.411e-04,5.951e-04,5.363e-05 -----
----- TIMING FOR onedot_decimation: 1.281e-03 S T(wf/decim)=1.618e-04,1.119e-03 -----
ctns::oper_renorm coord=(7,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:16 S:24 H:1 A:120 B:136 
        dim(bra,ket)=57,57 size(op)=361:2.754e-03MB size(tot)=66125:5.045e-01MB:4.927e-04GB
CPUmem: VM:2.005e+01GB RSS:1.913e+00GB  Timing: User:5.190e+02S Sys:1.936e+00S Total:5.209e+02S
----- TIMING FOR symbolic_formulae_renorm with size=297 : 1.033e-02 S -----
rank=0 GPUmem(GB): used=0.00085 (oper)=0.000804
rank=0 GPUmem(GB): used=0.000857 (oper,site)(GB)=0.000804,7.31e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=247
 no. of coefficients=6538:0.0499MB:4.87e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.228e-04 S -----
rank=0 GPUmem(GB): used=0.000906 (oper,site,rinter)=0.000804,7.31e-06,4.87e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0102 S size(rtasks)=297 size(Rlst2)=144 T(Rmu/Rlist)=0.00161,0.00856 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.011 S size(rtasks)=297 size(Rlst)=8316 -----
rank=0 GPUmem(GB): used=0.000906 (oper,site,rinter,batch)=0.000804,7.31e-06,4.87e-05,0.0175 blksize=100 blksize0=81 batchsize=8316
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000381,0.00306,0.00062
--- TIMING FOR renorm : t_inter=3.8e-04 t_gemm=3.1e-03 t_reduction=6.2e-04 tot=4.1e-03 ---
 renorm[inter] counter=7 t=3.8e-04 per=9.4e+00 cost=5.0e+06 flops=1.3e+10
 renorm[gemm] counter=7 i=0 t=1.4e-06 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=1 t=1.1e-06 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=2 t=1.1e-06 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=3 t=1.1e-06 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=4 t=8.2e-04 per=2.0e+01 cost=8.5e+05 flops=1.0e+09
 renorm[gemm] counter=7 i=5 t=1.1e-03 per=2.6e+01 cost=2.3e+06 flops=2.2e+09
 renorm[gemm] counter=7 i=6 t=1.2e-03 per=2.9e+01 cost=3.5e+06 flops=3.0e+09
 renorm[gemm] counter=7 total t=3.1e-03 per=7.5e+01 cost=6.6e+06 flops=2.2e+09
 renorm[red] counter=7 t=6.2e-04 per=1.5e+01 cost=5.6e+05 flops=9.1e+08
--- TIMING FOR renorm_tot : t_inter=1.4e-03 t_gemm=9.8e-03 t_reduction=2.8e-03 tot=1.4e-02 ---
 renorm_tot[inter] counter=7 t=1.4e-03 per=1.0e+01 cost=9.3e+06 flops=6.4e+09
 renorm_tot[gemm] counter=7 i=0 t=1.0e-05 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=1 t=8.2e-06 per=5.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=2 t=8.1e-06 per=5.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=3 t=8.0e-06 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=4 t=2.7e-03 per=1.9e+01 cost=1.9e+06 flops=7.1e+08
 renorm_tot[gemm] counter=7 i=5 t=3.2e-03 per=2.3e+01 cost=4.3e+06 flops=1.4e+09
 renorm_tot[gemm] counter=7 i=6 t=3.9e-03 per=2.8e+01 cost=8.1e+06 flops=2.1e+09
 renorm_tot[gemm] counter=7 total t=9.8e-03 per=7.0e+01 cost=1.4e+07 flops=1.5e+09
 renorm_tot[red] counter=7 t=2.8e-03 per=2.0e+01 cost=1.8e+06 flops=6.6e+08
qops.to_cpu: size(tot)=66125:5.0e-01MB:4.9e-04GB t[to_cpu]=1.3e-04S speed=3.9e+00GB/S
check ||H-H.dagger||=3.244e-14 coord=(7,0) rank=0
ctns::oper_ab2pq coord=(7,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0807 S rank=0 -----
CPUmem: VM:2.005e+01GB RSS:1.913e+00GB  Timing: User:5.191e+02S Sys:1.937e+00S Total:5.210e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1232:9.399e-03MB:9.179e-06GB
total mem of comb=16399:1.251e-01MB:1.222e-04GB
CPUmem: VM:2.005e+01GB RSS:1.913e+00GB  Timing: User:5.191e+02S Sys:1.937e+00S Total:5.210e+02S
##### local opt: 3.966e-01 S #####
 T(local opt: fetch) = 1.261e-02 S  per = 3.18  per(accum) = 3.18
 T(local opt: hdiag) = 2.859e-03 S  per = 0.721  per(accum) = 3.9
 T(local opt: dvdsn) = 2.956e-01 S  per = 74.5  per(accum) = 78.4
 T(local opt: decim) = 1.290e-03 S  per = 0.325  per(accum) = 78.8
 T(local opt: guess) = 3.362e-04 S  per = 0.0848  per(accum) = 78.9
 T(local opt: renrm) = 8.160e-02 S  per = 20.6  per(accum) = 99.4
 T(local opt: save ) = 2.270e-03 S  per = 0.572  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.956e-01 S  T(sum) = 2.952e-01 S  per = 9.985e+01
 T(local opt: preprocess                  ) = 6.072e-04 S  per = 0.206  per(accum) = 0.206
 T(local opt: symbolic_formulae           ) = 1.853e-02 S  per = 6.28  per(accum) = 6.48
 T(local opt: hintermediate init          ) = 4.151e-04 S  per = 0.141  per(accum) = 6.62
 T(local opt: preprocess_hformulae_Hxlist ) = 2.817e-02 S  per = 9.54  per(accum) = 16.2
 T(local opt: hmmtasks init               ) = 1.618e-01 S  per = 54.8  per(accum) = 71
 T(local opt: initial guess for dvdson    ) = 7.977e-06 S  per = 0.0027  per(accum) = 71
 T(local opt: dvdson solver [Hx_batchGPU] ) = 5.225e-02 S  per = 17.7  per(accum) = 88.7
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.805e-04 S  per = 0.095  per(accum) = 88.8
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.032e-06 S  per = 0.00035  per(accum) = 88.8
 T(local opt: dvdson solver [rest part]   ) = 3.314e-02 S  per = 11.2  per(accum) = 100
Detailed decomposition of T(renrm) = 8.160e-02 S  T(sum) = 8.160e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.506e-04 S  per = 0.307  per(accum) = 0.307
 T(local opt: qops init                    ) = 4.880e-03 S  per = 5.98  per(accum) = 6.29
 T(local opt: symbolic_formulae_renorm     ) = 1.034e-02 S  per = 12.7  per(accum) = 19
 T(local opt: allocate qops on gpu         ) = 3.025e-05 S  per = 0.0371  per(accum) = 19
 T(local opt: site memcpy cpu2gpu          ) = 2.014e-05 S  per = 0.0247  per(accum) = 19
 T(local opt: rintermediate init           ) = 4.337e-04 S  per = 0.532  per(accum) = 19.6
 T(local opt: preprocess_formulae_Rlist2   ) = 1.125e-02 S  per = 13.8  per(accum) = 33.3
 T(local opt: rmmtasks init                ) = 4.933e-02 S  per = 60.5  per(accum) = 93.8
 T(local opt: qops memset on cpu           ) = 4.700e-08 S  per = 5.76e-05  per(accum) = 93.8
 T(local opt: preprocess_renorm_batchGPU   ) = 4.152e-03 S  per = 5.09  per(accum) = 98.9
 T(local opt: reduction of opS & opH [nccl]) = 1.006e-06 S  per = 0.00123  per(accum) = 98.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.340e-04 S  per = 0.164  per(accum) = 99.1
 T(local opt: deallocate cpu and gpu memory) = 1.146e-04 S  per = 0.14  per(accum) = 99.2
 T(local opt: reduction of opS & opH [comm]) = 4.250e-05 S  per = 0.0521  per(accum) = 99.3
 T(local opt: conversion from opAB to opPQ ) = 4.256e-06 S  per = 0.00522  per(accum) = 99.3
 T(local opt: after oper_renorm            ) = 6.054e-04 S  per = 0.742  per(accum) = 100
##### sweep opt: 1.821e+00 S #####
 T(sweep opt: fetch) = 8.221e-02 S  per = 4.51  per(accum) = 4.51
 T(sweep opt: hdiag) = 8.351e-03 S  per = 0.458  per(accum) = 4.97
 T(sweep opt: dvdsn) = 1.393e+00 S  per = 76.5  per(accum) = 81.4
 T(sweep opt: decim) = 5.640e-03 S  per = 0.31  per(accum) = 81.8
 T(sweep opt: guess) = 1.615e-03 S  per = 0.0887  per(accum) = 81.8
 T(sweep opt: renrm) = 3.186e-01 S  per = 17.5  per(accum) = 99.3
 T(sweep opt: save ) = 1.217e-02 S  per = 0.668  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.393e+00 S  T(sum) = 1.390e+00 S  per = 9.979e+01
 T(sweep opt: preprocess                  ) = 2.617e-03 S  per = 0.188  per(accum) = 0.188
 T(sweep opt: symbolic_formulae           ) = 6.338e-02 S  per = 4.56  per(accum) = 4.75
 T(sweep opt: hintermediate init          ) = 1.457e-03 S  per = 0.105  per(accum) = 4.85
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.711e-02 S  per = 4.83  per(accum) = 9.68
 T(sweep opt: hmmtasks init               ) = 8.253e-01 S  per = 59.4  per(accum) = 69.1
 T(sweep opt: initial guess for dvdson    ) = 3.389e-05 S  per = 0.00244  per(accum) = 69.1
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.400e-01 S  per = 10.1  per(accum) = 79.1
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 1.281e-03 S  per = 0.0921  per(accum) = 79.2
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 5.717e-06 S  per = 0.000411  per(accum) = 79.2
 T(sweep opt: dvdson solver [rest part]   ) = 2.888e-01 S  per = 20.8  per(accum) = 100
Detailed decomposition of T(renrm) = 3.186e-01 S  T(sum) = 3.186e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.281e-03 S  per = 0.402  per(accum) = 0.402
 T(sweep opt: qops init                    ) = 1.702e-02 S  per = 5.34  per(accum) = 5.74
 T(sweep opt: symbolic_formulae_renorm     ) = 4.363e-02 S  per = 13.7  per(accum) = 19.4
 T(sweep opt: allocate qops on gpu         ) = 1.878e-04 S  per = 0.059  per(accum) = 19.5
 T(sweep opt: site memcpy cpu2gpu          ) = 1.384e-04 S  per = 0.0434  per(accum) = 19.5
 T(sweep opt: rintermediate init           ) = 2.531e-03 S  per = 0.795  per(accum) = 20.3
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.635e-02 S  per = 14.6  per(accum) = 34.9
 T(sweep opt: rmmtasks init                ) = 1.881e-01 S  per = 59.1  per(accum) = 93.9
 T(sweep opt: qops memset on cpu           ) = 4.130e-07 S  per = 0.00013  per(accum) = 93.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.466e-02 S  per =  4.6  per(accum) = 98.5
 T(sweep opt: reduction of opS & opH [nccl]) = 7.296e-06 S  per = 0.00229  per(accum) = 98.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.260e-04 S  per = 0.134  per(accum) = 98.7
 T(sweep opt: deallocate cpu and gpu memory) = 1.066e-03 S  per = 0.335  per(accum) = 99
 T(sweep opt: reduction of opS & opH [comm]) = 2.557e-04 S  per = 0.0803  per(accum) = 99.1
 T(sweep opt: conversion from opAB to opPQ ) = 2.683e-05 S  per = 0.00842  per(accum) = 99.1
 T(sweep opt: after oper_renorm            ) = 2.854e-03 S  per = 0.896  per(accum) = 100
##### global opt: 1.821e+00 S #####
 T(global opt: fetch) = 8.221e-02 S  per = 4.51  per(accum) = 4.51
 T(global opt: hdiag) = 8.351e-03 S  per = 0.458  per(accum) = 4.97
 T(global opt: dvdsn) = 1.393e+00 S  per = 76.5  per(accum) = 81.4
 T(global opt: decim) = 5.640e-03 S  per = 0.31  per(accum) = 81.8
 T(global opt: guess) = 1.615e-03 S  per = 0.0887  per(accum) = 81.8
 T(global opt: renrm) = 3.186e-01 S  per = 17.5  per(accum) = 99.3
 T(global opt: save ) = 1.217e-02 S  per = 0.668  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.393e+00 S  T(sum) = 1.390e+00 S  per = 9.979e+01
 T(global opt: preprocess                  ) = 2.617e-03 S  per = 0.188  per(accum) = 0.188
 T(global opt: symbolic_formulae           ) = 6.338e-02 S  per = 4.56  per(accum) = 4.75
 T(global opt: hintermediate init          ) = 1.457e-03 S  per = 0.105  per(accum) = 4.85
 T(global opt: preprocess_hformulae_Hxlist ) = 6.711e-02 S  per = 4.83  per(accum) = 9.68
 T(global opt: hmmtasks init               ) = 8.253e-01 S  per = 59.4  per(accum) = 69.1
 T(global opt: initial guess for dvdson    ) = 3.389e-05 S  per = 0.00244  per(accum) = 69.1
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.400e-01 S  per = 10.1  per(accum) = 79.1
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.281e-03 S  per = 0.0921  per(accum) = 79.2
 T(global opt: dvdson solver [comm(cpu)]   ) = 5.717e-06 S  per = 0.000411  per(accum) = 79.2
 T(global opt: dvdson solver [rest part]   ) = 2.888e-01 S  per = 20.8  per(accum) = 100
Detailed decomposition of T(renrm) = 3.186e-01 S  T(sum) = 3.186e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.281e-03 S  per = 0.402  per(accum) = 0.402
 T(global opt: qops init                    ) = 1.702e-02 S  per = 5.34  per(accum) = 5.74
 T(global opt: symbolic_formulae_renorm     ) = 4.363e-02 S  per = 13.7  per(accum) = 19.4
 T(global opt: allocate qops on gpu         ) = 1.878e-04 S  per = 0.059  per(accum) = 19.5
 T(global opt: site memcpy cpu2gpu          ) = 1.384e-04 S  per = 0.0434  per(accum) = 19.5
 T(global opt: rintermediate init           ) = 2.531e-03 S  per = 0.795  per(accum) = 20.3
 T(global opt: preprocess_formulae_Rlist2   ) = 4.635e-02 S  per = 14.6  per(accum) = 34.9
 T(global opt: rmmtasks init                ) = 1.881e-01 S  per = 59.1  per(accum) = 93.9
 T(global opt: qops memset on cpu           ) = 4.130e-07 S  per = 0.00013  per(accum) = 93.9
 T(global opt: preprocess_renorm_batchGPU   ) = 1.466e-02 S  per =  4.6  per(accum) = 98.5
 T(global opt: reduction of opS & opH [nccl]) = 7.296e-06 S  per = 0.00229  per(accum) = 98.5
 T(global opt: qops memcpy gpu2cpu          ) = 4.260e-04 S  per = 0.134  per(accum) = 98.7
 T(global opt: deallocate cpu and gpu memory) = 1.066e-03 S  per = 0.335  per(accum) = 99
 T(global opt: reduction of opS & opH [comm]) = 2.557e-04 S  per = 0.0803  per(accum) = 99.1
 T(global opt: conversion from opAB to opPQ ) = 2.683e-05 S  per = 0.00842  per(accum) = 99.1
 T(global opt: after oper_renorm            ) = 2.854e-03 S  per = 0.896  per(accum) = 100

isweep=0 ibond=7/seqsize=34 dots=1 dbond=(8,0)-(9,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.005e+01GB RSS:1.913e+00GB  Timing: User:5.191e+02S Sys:1.938e+00S Total:5.210e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1232:9.399e-03MB:9.179e-06GB
total mem of comb=16399:1.251e-01MB:1.222e-04GB
ctns::topology::check_partition: (sl,sr,sc)=8,11,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc= 19
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:16 S:24 H:1 A:120 B:136 
        dim(bra,ket)=57,57 size(op)=361:2.754e-03MB size(tot)=66125:5.045e-01MB:4.927e-04GB
 rqops: oplist=CSHPQ nops=C:22 S:18 H:1 P:153 Q:171 
        dim(bra,ket)=65,65 size(op)=447:3.410e-03MB size(tot)=102470:7.818e-01MB:7.635e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=170931:1.304e+00MB:1.274e-03GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(8,0) fdel=./scratch/sweep/rop(9,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
wf3(diml,dimr,dimc)=(57,65,4) nnz=1232:9.399e-03MB
qtensor3: wf3 own=1 _data=0x5260f020
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=12 dimAll=57
 (11,1):10 (12,2):8 (12,0):8 (13,1):6 (10,2):5 (10,0):5 (11,3):4 (11,-1):4 (13,-1):3 (9,1):2 (9,3):1 (13,3):1
 qbond: qcol nsym=13 dimAll=65
 (17,-1):12 (16,0):8 (16,-2):7 (17,1):7 (15,-1):6 (18,0):6 (18,-2):5 (17,-3):4 (19,-1):4 (15,1):3 (15,-3):1 (19,-3):1 (19,1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=36 nblocks=624 size=1232:9.399e-03MB
### DIAG TIMING: total=3.791e-03 t1=1.304e-05, t2=1.586e-05, t3=3.689e-05, t4=3.685e-03, t5=2.027e-05, t6=1.614e-05, t7=3.658e-06
duration_diagGPU:3.803e-03
duration_diagreduce:5.800e-08
duration_diagtransform:4.281e-06
----- TIMING FOR symbolic_formulae_onedot with size=1327 : 2.225e-02 S -----
rank=0 GPUmem(GB): used=0.00127 (oper)=0.00127
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1327
 no. of hintermediate operators=664
 no. of coefficients=7304:0.0557MB:5.44e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.238e-04 S -----
rank=0 GPUmem(GB): used=0.00133 (oper,hinter)=0.00127,5.44e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0343 S size(H_formulae)=1327 size(Hxlst2)=36 T(Hmu/Hxlist)=0.00311,0.0312 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0385 S size(H_formulae)=1327 size(Hxlst)=36592 -----
rank=0 GPUmem(GB): used=0.0932 (oper,hinter,dvdson,batch)=0.00127,5.44e-05,1.84e-05,0.0919 blksize=120 blksize0=96 batchsize=36592
ctns::pdvdsonSolver_nkr::solve_iter ndim=1232 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.51e-05,0.000723,0.0098,0.00138,0.012
 ndim=1232:9.18e-06GB t[comm(intra)]=3.41e-05 speed=0.539GB/S t[comm(inter)]=1.1e-05 speed=1.67GB/S
--- TIMING FOR sigma : t_inter=7.2e-04 t_gemm=9.8e-03 t_reduction=1.4e-03 tot=1.2e-02 ---
 sigma[inter] counter=44 t=7.2e-04 per=6.1e+00 cost=1.4e+07 flops=2.0e+10
 sigma[gemm] counter=44 i=0 t=2.2e-06 per=1.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=1 t=1.7e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=2 t=2.4e-03 per=2.0e+01 cost=7.9e+06 flops=3.3e+09
 sigma[gemm] counter=44 i=3 t=2.3e-03 per=1.9e+01 cost=7.8e+06 flops=3.4e+09
 sigma[gemm] counter=44 i=4 t=2.3e-03 per=1.9e+01 cost=8.7e+06 flops=3.8e+09
 sigma[gemm] counter=44 i=5 t=2.9e-03 per=2.4e+01 cost=9.3e+06 flops=3.3e+09
 sigma[gemm] counter=44 total t=9.8e-03 per=8.2e+01 cost=3.4e+07 flops=3.4e+09
 sigma[red] counter=44 t=1.4e-03 per=1.2e+01 cost=2.8e+06 flops=2.1e+09
--- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=1.1e-01 t_reduction=2.0e-02 tot=1.5e-01 ---
 sigma_tot[inter] counter=44 t=1.2e-02 per=8.0e+00 cost=1.5e+08 flops=1.3e+10
 sigma_tot[gemm] counter=44 i=0 t=1.0e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=1 t=7.4e-05 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=2 t=3.0e-02 per=2.0e+01 cost=6.8e+07 flops=2.3e+09
 sigma_tot[gemm] counter=44 i=3 t=3.0e-02 per=2.0e+01 cost=6.9e+07 flops=2.3e+09
 sigma_tot[gemm] counter=44 i=4 t=2.7e-02 per=1.9e+01 cost=7.4e+07 flops=2.7e+09
 sigma_tot[gemm] counter=44 i=5 t=2.8e-02 per=1.9e+01 cost=7.8e+07 flops=2.8e+09
 sigma_tot[gemm] counter=44 total t=1.1e-01 per=7.8e+01 cost=2.9e+08 flops=2.5e+09
 sigma_tot[red] counter=44 t=2.0e-02 per=1.4e+01 cost=2.7e+07 flops=1.4e+09
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=9.1e-06,7.8e-06,2.9e-06,2.4e-06,5.6e-07
settings: ndim=1232 neig=1 maxcycle=30 nbuff=4 memory=0.0001GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.481452453825 -1.116e+03  7.748e-02    1     1  1.223e-02 1.223e-02 1.217e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.710e-05,7.890e-04,7.957e-03,1.271e-03,1.008e-02
 ndim=1232:9.179e-06GB t[comm(intra)]=3.963e-05 speed=4.632e-01GB/S t[comm(inter)]=7.463e-06 speed=2.460e+00GB/S
--- TIMING FOR sigma : t_inter=7.9e-04 t_gemm=8.0e-03 t_reduction=1.3e-03 tot=1.0e-02 ---
 sigma[inter] counter=45 t=7.9e-04 per=7.9e+00 cost=1.4e+07 flops=1.8e+10
 sigma[gemm] counter=45 i=0 t=1.7e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=1 t=1.6e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=2 t=2.0e-03 per=2.0e+01 cost=7.9e+06 flops=4.0e+09
 sigma[gemm] counter=45 i=3 t=2.1e-03 per=2.1e+01 cost=7.8e+06 flops=3.7e+09
 sigma[gemm] counter=45 i=4 t=1.9e-03 per=1.9e+01 cost=8.7e+06 flops=4.6e+09
 sigma[gemm] counter=45 i=5 t=2.0e-03 per=2.0e+01 cost=9.3e+06 flops=4.7e+09
 sigma[gemm] counter=45 total t=8.0e-03 per=7.9e+01 cost=3.4e+07 flops=4.2e+09
 sigma[red] counter=45 t=1.3e-03 per=1.3e+01 cost=2.8e+06 flops=2.2e+09
--- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=1.2e-01 t_reduction=2.1e-02 tot=1.6e-01 ---
 sigma_tot[inter] counter=45 t=1.2e-02 per=8.0e+00 cost=1.7e+08 flops=1.3e+10
 sigma_tot[gemm] counter=45 i=0 t=1.0e-04 per=6.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=1 t=7.5e-05 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=2 t=3.2e-02 per=2.0e+01 cost=7.6e+07 flops=2.4e+09
 sigma_tot[gemm] counter=45 i=3 t=3.2e-02 per=2.0e+01 cost=7.7e+07 flops=2.4e+09
 sigma_tot[gemm] counter=45 i=4 t=2.9e-02 per=1.9e+01 cost=8.3e+07 flops=2.8e+09
 sigma_tot[gemm] counter=45 i=5 t=2.9e-02 per=1.9e+01 cost=8.7e+07 flops=3.0e+09
 sigma_tot[gemm] counter=45 total t=1.2e-01 per=7.8e+01 cost=3.2e+08 flops=2.6e+09
 sigma_tot[red] counter=45 t=2.1e-02 per=1.4e+01 cost=3.0e+07 flops=1.4e+09
T(sub)=6.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,3.4e-05,5.0e-06,4.5e-06,6.9e-07
    2   0 -    -116.490078606450 -8.626e-03  2.069e-02    2     2  2.780e-02 1.390e-02 1.121e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.532e-05,7.878e-04,7.812e-03,1.263e-03,9.921e-03
 ndim=1232:9.179e-06GB t[comm(intra)]=3.819e-05 speed=4.807e-01GB/S t[comm(inter)]=7.127e-06 speed=2.576e+00GB/S
--- TIMING FOR sigma : t_inter=7.9e-04 t_gemm=7.8e-03 t_reduction=1.3e-03 tot=9.9e-03 ---
 sigma[inter] counter=46 t=7.9e-04 per=8.0e+00 cost=1.4e+07 flops=1.8e+10
 sigma[gemm] counter=46 i=0 t=1.8e-06 per=1.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=1 t=1.6e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=2 t=1.9e-03 per=1.9e+01 cost=7.9e+06 flops=4.1e+09
 sigma[gemm] counter=46 i=3 t=2.1e-03 per=2.1e+01 cost=7.8e+06 flops=3.8e+09
 sigma[gemm] counter=46 i=4 t=1.9e-03 per=1.9e+01 cost=8.7e+06 flops=4.7e+09
 sigma[gemm] counter=46 i=5 t=2.0e-03 per=2.0e+01 cost=9.3e+06 flops=4.7e+09
 sigma[gemm] counter=46 total t=7.8e-03 per=7.9e+01 cost=3.4e+07 flops=4.3e+09
 sigma[red] counter=46 t=1.3e-03 per=1.3e+01 cost=2.8e+06 flops=2.3e+09
--- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=1.3e-01 t_reduction=2.3e-02 tot=1.7e-01 ---
 sigma_tot[inter] counter=46 t=1.3e-02 per=8.0e+00 cost=1.8e+08 flops=1.4e+10
 sigma_tot[gemm] counter=46 i=0 t=1.0e-04 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=1 t=7.7e-05 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=2 t=3.4e-02 per=2.0e+01 cost=8.4e+07 flops=2.5e+09
 sigma_tot[gemm] counter=46 i=3 t=3.4e-02 per=2.0e+01 cost=8.5e+07 flops=2.5e+09
 sigma_tot[gemm] counter=46 i=4 t=3.1e-02 per=1.9e+01 cost=9.2e+07 flops=2.9e+09
 sigma_tot[gemm] counter=46 i=5 t=3.1e-02 per=1.9e+01 cost=9.6e+07 flops=3.1e+09
 sigma_tot[gemm] counter=46 total t=1.3e-01 per=7.8e+01 cost=3.6e+08 flops=2.7e+09
 sigma_tot[red] counter=46 t=2.3e-02 per=1.4e+01 cost=3.3e+07 flops=1.5e+09
T(sub)=4.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,2.1e-05,4.0e-06,7.4e-06,8.9e-07
    3   0 -    -116.490750378392 -6.718e-04  7.787e-03    3     3  4.277e-02 1.426e-02 1.085e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.435e-05,7.933e-04,7.832e-03,1.250e-03,9.933e-03
 ndim=1232:9.179e-06GB t[comm(intra)]=3.805e-05 speed=4.824e-01GB/S t[comm(inter)]=6.296e-06 speed=2.916e+00GB/S
--- TIMING FOR sigma : t_inter=7.9e-04 t_gemm=7.8e-03 t_reduction=1.2e-03 tot=9.9e-03 ---
 sigma[inter] counter=47 t=7.9e-04 per=8.0e+00 cost=1.4e+07 flops=1.8e+10
 sigma[gemm] counter=47 i=0 t=2.0e-06 per=2.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=1 t=1.9e-06 per=2.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=2 t=1.9e-03 per=2.0e+01 cost=7.9e+06 flops=4.1e+09
 sigma[gemm] counter=47 i=3 t=2.1e-03 per=2.1e+01 cost=7.8e+06 flops=3.8e+09
 sigma[gemm] counter=47 i=4 t=1.9e-03 per=1.9e+01 cost=8.7e+06 flops=4.6e+09
 sigma[gemm] counter=47 i=5 t=2.0e-03 per=2.0e+01 cost=9.3e+06 flops=4.7e+09
 sigma[gemm] counter=47 total t=7.8e-03 per=7.9e+01 cost=3.4e+07 flops=4.3e+09
 sigma[red] counter=47 t=1.2e-03 per=1.3e+01 cost=2.8e+06 flops=2.3e+09
--- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=1.4e-01 t_reduction=2.4e-02 tot=1.8e-01 ---
 sigma_tot[inter] counter=47 t=1.4e-02 per=8.0e+00 cost=2.0e+08 flops=1.4e+10
 sigma_tot[gemm] counter=47 i=0 t=1.1e-04 per=6.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=1 t=7.9e-05 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=2 t=3.6e-02 per=2.0e+01 cost=9.2e+07 flops=2.6e+09
 sigma_tot[gemm] counter=47 i=3 t=3.6e-02 per=2.0e+01 cost=9.2e+07 flops=2.6e+09
 sigma_tot[gemm] counter=47 i=4 t=3.3e-02 per=1.9e+01 cost=1.0e+08 flops=3.0e+09
 sigma_tot[gemm] counter=47 i=5 t=3.3e-02 per=1.9e+01 cost=1.1e+08 flops=3.2e+09
 sigma_tot[gemm] counter=47 total t=1.4e-01 per=7.8e+01 cost=3.9e+08 flops=2.8e+09
 sigma_tot[red] counter=47 t=2.4e-02 per=1.4e+01 cost=3.6e+07 flops=1.5e+09
T(sub)=4.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,2.2e-05,4.1e-06,7.1e-06,8.3e-07
    4   0 -    -116.490853229432 -1.029e-04  3.317e-03    3     4  5.768e-02 1.442e-02 1.066e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.645e-05,1.089e-03,8.315e-03,1.234e-03,1.070e-02
 ndim=1232:9.179e-06GB t[comm(intra)]=2.915e-05 speed=6.299e-01GB/S t[comm(inter)]=7.307e-06 speed=2.512e+00GB/S
--- TIMING FOR sigma : t_inter=1.1e-03 t_gemm=8.3e-03 t_reduction=1.2e-03 tot=1.1e-02 ---
 sigma[inter] counter=48 t=1.1e-03 per=1.0e+01 cost=1.4e+07 flops=1.3e+10
 sigma[gemm] counter=48 i=0 t=3.5e-06 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=1 t=2.5e-06 per=2.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=2 t=2.3e-03 per=2.2e+01 cost=7.9e+06 flops=3.4e+09
 sigma[gemm] counter=48 i=3 t=2.1e-03 per=2.0e+01 cost=7.8e+06 flops=3.7e+09
 sigma[gemm] counter=48 i=4 t=1.9e-03 per=1.8e+01 cost=8.7e+06 flops=4.6e+09
 sigma[gemm] counter=48 i=5 t=2.0e-03 per=1.9e+01 cost=9.3e+06 flops=4.7e+09
 sigma[gemm] counter=48 total t=8.3e-03 per=7.8e+01 cost=3.4e+07 flops=4.1e+09
 sigma[red] counter=48 t=1.2e-03 per=1.2e+01 cost=2.8e+06 flops=2.3e+09
--- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=1.5e-01 t_reduction=2.5e-02 tot=1.9e-01 ---
 sigma_tot[inter] counter=48 t=1.5e-02 per=8.1e+00 cost=2.1e+08 flops=1.4e+10
 sigma_tot[gemm] counter=48 i=0 t=1.1e-04 per=5.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=1 t=8.1e-05 per=4.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=2 t=3.8e-02 per=2.0e+01 cost=1.0e+08 flops=2.6e+09
 sigma_tot[gemm] counter=48 i=3 t=3.8e-02 per=2.0e+01 cost=1.0e+08 flops=2.6e+09
 sigma_tot[gemm] counter=48 i=4 t=3.5e-02 per=1.9e+01 cost=1.1e+08 flops=3.1e+09
 sigma_tot[gemm] counter=48 i=5 t=3.5e-02 per=1.9e+01 cost=1.1e+08 flops=3.2e+09
 sigma_tot[gemm] counter=48 total t=1.5e-01 per=7.8e+01 cost=4.2e+08 flops=2.9e+09
 sigma_tot[red] counter=48 t=2.5e-02 per=1.3e+01 cost=3.9e+07 flops=1.5e+09
T(sub)=6.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,3.8e-05,4.4e-06,6.3e-06,5.9e-07
    5   0 -    -116.490869026221 -1.580e-05  1.203e-03    3     5  7.342e-02 1.468e-02 1.071e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.350e-05,7.887e-04,7.799e-03,1.215e-03,9.848e-03
 ndim=1232:9.179e-06GB t[comm(intra)]=2.840e-05 speed=6.465e-01GB/S t[comm(inter)]=5.103e-06 speed=3.598e+00GB/S
--- TIMING FOR sigma : t_inter=7.9e-04 t_gemm=7.8e-03 t_reduction=1.2e-03 tot=9.8e-03 ---
 sigma[inter] counter=49 t=7.9e-04 per=8.0e+00 cost=1.4e+07 flops=1.8e+10
 sigma[gemm] counter=49 i=0 t=1.9e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=1 t=1.5e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=2 t=1.9e-03 per=2.0e+01 cost=7.9e+06 flops=4.1e+09
 sigma[gemm] counter=49 i=3 t=2.1e-03 per=2.1e+01 cost=7.8e+06 flops=3.8e+09
 sigma[gemm] counter=49 i=4 t=1.9e-03 per=1.9e+01 cost=8.7e+06 flops=4.7e+09
 sigma[gemm] counter=49 i=5 t=2.0e-03 per=2.0e+01 cost=9.3e+06 flops=4.8e+09
 sigma[gemm] counter=49 total t=7.8e-03 per=8.0e+01 cost=3.4e+07 flops=4.3e+09
 sigma[red] counter=49 t=1.2e-03 per=1.2e+01 cost=2.8e+06 flops=2.3e+09
--- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=1.5e-01 t_reduction=2.6e-02 tot=2.0e-01 ---
 sigma_tot[inter] counter=49 t=1.6e-02 per=8.1e+00 cost=2.2e+08 flops=1.4e+10
 sigma_tot[gemm] counter=49 i=0 t=1.1e-04 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=1 t=8.3e-05 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=2 t=4.0e-02 per=2.0e+01 cost=1.1e+08 flops=2.7e+09
 sigma_tot[gemm] counter=49 i=3 t=4.0e-02 per=2.0e+01 cost=1.1e+08 flops=2.7e+09
 sigma_tot[gemm] counter=49 i=4 t=3.7e-02 per=1.9e+01 cost=1.2e+08 flops=3.2e+09
 sigma_tot[gemm] counter=49 i=5 t=3.7e-02 per=1.9e+01 cost=1.2e+08 flops=3.3e+09
 sigma_tot[gemm] counter=49 total t=1.5e-01 per=7.8e+01 cost=4.6e+08 flops=3.0e+09
 sigma_tot[red] counter=49 t=2.6e-02 per=1.3e+01 cost=4.2e+07 flops=1.6e+09
T(sub)=5.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,2.6e-05,3.8e-06,6.3e-06,6.3e-07
    6   0 -    -116.490871733578 -2.707e-06  4.587e-04    3     6  9.083e-02 1.514e-02 1.060e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.183e-05,7.788e-04,7.785e-03,1.243e-03,9.860e-03
 ndim=1232:9.179e-06GB t[comm(intra)]=3.644e-05 speed=5.038e-01GB/S t[comm(inter)]=5.386e-06 speed=3.409e+00GB/S
--- TIMING FOR sigma : t_inter=7.8e-04 t_gemm=7.8e-03 t_reduction=1.2e-03 tot=9.8e-03 ---
 sigma[inter] counter=50 t=7.8e-04 per=7.9e+00 cost=1.4e+07 flops=1.8e+10
 sigma[gemm] counter=50 i=0 t=1.7e-06 per=1.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=1 t=1.6e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=2 t=1.9e-03 per=2.0e+01 cost=7.9e+06 flops=4.1e+09
 sigma[gemm] counter=50 i=3 t=2.1e-03 per=2.1e+01 cost=7.8e+06 flops=3.8e+09
 sigma[gemm] counter=50 i=4 t=1.9e-03 per=1.9e+01 cost=8.7e+06 flops=4.7e+09
 sigma[gemm] counter=50 i=5 t=1.9e-03 per=2.0e+01 cost=9.3e+06 flops=4.8e+09
 sigma[gemm] counter=50 total t=7.8e-03 per=7.9e+01 cost=3.4e+07 flops=4.3e+09
 sigma[red] counter=50 t=1.2e-03 per=1.3e+01 cost=2.8e+06 flops=2.3e+09
--- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=1.6e-01 t_reduction=2.8e-02 tot=2.1e-01 ---
 sigma_tot[inter] counter=50 t=1.7e-02 per=8.1e+00 cost=2.4e+08 flops=1.4e+10
 sigma_tot[gemm] counter=50 i=0 t=1.1e-04 per=5.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=1 t=8.4e-05 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=2 t=4.2e-02 per=2.0e+01 cost=1.2e+08 flops=2.8e+09
 sigma_tot[gemm] counter=50 i=3 t=4.2e-02 per=2.0e+01 cost=1.2e+08 flops=2.7e+09
 sigma_tot[gemm] counter=50 i=4 t=3.9e-02 per=1.9e+01 cost=1.3e+08 flops=3.3e+09
 sigma_tot[gemm] counter=50 i=5 t=3.9e-02 per=1.9e+01 cost=1.3e+08 flops=3.4e+09
 sigma_tot[gemm] counter=50 total t=1.6e-01 per=7.9e+01 cost=4.9e+08 flops=3.0e+09
 sigma_tot[red] counter=50 t=2.8e-02 per=1.3e+01 cost=4.4e+07 flops=1.6e+09
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.6e-05,3.7e-06,7.3e-06,6.8e-07
    7   0 -    -116.490872106885 -3.733e-07  1.592e-04    3     7  1.058e-01 1.511e-02 1.052e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.324e-05,7.626e-04,7.895e-03,1.224e-03,9.942e-03
 ndim=1232:9.179e-06GB t[comm(intra)]=3.575e-05 speed=5.135e-01GB/S t[comm(inter)]=7.490e-06 speed=2.451e+00GB/S
--- TIMING FOR sigma : t_inter=7.6e-04 t_gemm=7.9e-03 t_reduction=1.2e-03 tot=9.9e-03 ---
 sigma[inter] counter=51 t=7.6e-04 per=7.7e+00 cost=1.4e+07 flops=1.9e+10
 sigma[gemm] counter=51 i=0 t=1.8e-06 per=1.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=1 t=1.6e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=2 t=1.9e-03 per=1.9e+01 cost=7.9e+06 flops=4.1e+09
 sigma[gemm] counter=51 i=3 t=2.1e-03 per=2.1e+01 cost=7.8e+06 flops=3.8e+09
 sigma[gemm] counter=51 i=4 t=1.9e-03 per=2.0e+01 cost=8.7e+06 flops=4.5e+09
 sigma[gemm] counter=51 i=5 t=1.9e-03 per=2.0e+01 cost=9.3e+06 flops=4.8e+09
 sigma[gemm] counter=51 total t=7.9e-03 per=8.0e+01 cost=3.4e+07 flops=4.3e+09
 sigma[red] counter=51 t=1.2e-03 per=1.2e+01 cost=2.8e+06 flops=2.3e+09
--- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=1.7e-01 t_reduction=2.9e-02 tot=2.2e-01 ---
 sigma_tot[inter] counter=51 t=1.7e-02 per=8.1e+00 cost=2.5e+08 flops=1.4e+10
 sigma_tot[gemm] counter=51 i=0 t=1.2e-04 per=5.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=1 t=8.6e-05 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=2 t=4.4e-02 per=2.0e+01 cost=1.2e+08 flops=2.8e+09
 sigma_tot[gemm] counter=51 i=3 t=4.4e-02 per=2.1e+01 cost=1.2e+08 flops=2.8e+09
 sigma_tot[gemm] counter=51 i=4 t=4.0e-02 per=1.9e+01 cost=1.3e+08 flops=3.3e+09
 sigma_tot[gemm] counter=51 i=5 t=4.1e-02 per=1.9e+01 cost=1.4e+08 flops=3.5e+09
 sigma_tot[gemm] counter=51 total t=1.7e-01 per=7.9e+01 cost=5.3e+08 flops=3.1e+09
 sigma_tot[red] counter=51 t=2.9e-02 per=1.3e+01 cost=4.7e+07 flops=1.6e+09
T(sub)=5.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,2.7e-05,3.3e-06,5.8e-06,5.3e-07
    8   0 +    -116.490872151426 -4.454e-08  5.148e-05    3     8  1.208e-01 1.510e-02 1.047e-02
TIMING FOR Davidson : 1.208e-01  T(cal/comm/rest)=8.378e-02,1.064e-06,3.704e-02
decomposed t_rest=3.704e-02
 T(sub)    =3.921e-04 per=1.059e+00
 T(precond)=3.624e-02 per=9.785e+01
 T(ortho)  =6.459e-05 per=1.744e-01
 T(xcopy)  =4.211e-06 per=1.137e-02
 T(xnrm2)  =8.474e-06 per=2.288e-02
 T(other)  =3.272e-04 per=8.833e-01
optimized energies: isweep=0 ibond=7 dots=1 e[0]=-116.490872151426 nmvp=8
CPUmem: VM:2.005e+01GB RSS:1.919e+00GB  Timing: User:5.302e+02S Sys:1.954e+00S Total:5.322e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=22 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond7.txt
 qbond: qsuper nsym=22 dimAll=228
 (11,1):22 (13,1):32 (12,2):27 (12,0):27 (14,2):15 (13,3):13 (14,0):17 (13,-1):15 (15,1):6 (10,2):8 (11,3):10 (10,0):7 (11,-1):9 (12,4):4 (12,-2):4 (15,-1):3 (14,-2):3 (9,1):2 (9,3):1 (10,4):1 (15,3):1 (14,4):1
timing for divide=6.1e-05
timing for compute=9.0e-04
timing for collect=5.8e-05
----- TMING FOR decimation_genbasis(nkr): 1.0e-03 S T(divide/compute/collect)=6.1e-05,9.0e-04,5.8e-05 -----
decimation summary: 228->65 dwt=+1.110e-16 SvN=1.967e+00
 qbond: qkept nsym=13 dimAll=65
 (13,1):12 (14,0):8 (14,2):7 (13,-1):7 (12,0):6 (15,1):6 (12,2):5 (11,1):4 (13,3):4 (15,-1):3 (11,3):1 (11,-1):1 (15,3):1
----- TIMING for decimation_row(nkr): 3.081e-03 S T(decim/select/formRot)=1.352e-03,1.584e-03,1.452e-04 -----
----- TIMING FOR onedot_decimation: 3.654e-03 S T(wf/decim)=5.019e-04,3.152e-03 -----
ctns::oper_renorm coord=(8,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:18 S:22 H:1 A:153 B:171 
        dim(bra,ket)=65,65 size(op)=447:3.410e-03MB size(tot)=102470:7.818e-01MB:7.635e-04GB
CPUmem: VM:2.005e+01GB RSS:1.919e+00GB  Timing: User:5.302e+02S Sys:1.954e+00S Total:5.322e+02S
----- TIMING FOR symbolic_formulae_renorm with size=365 : 2.202e-02 S -----
rank=0 GPUmem(GB): used=0.00133 (oper)=0.00127
rank=0 GPUmem(GB): used=0.00134 (oper,site)(GB)=0.00127,9.18e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=227
 no. of coefficients=7720:0.0589MB:5.75e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 7.383e-04 S -----
rank=0 GPUmem(GB): used=0.00139 (oper,site,rinter)=0.00127,9.18e-06,5.75e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.021 S size(rtasks)=365 size(Rlst2)=169 T(Rmu/Rlist)=0.003,0.018 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0238 S size(rtasks)=365 size(Rlst)=10531 -----
rank=0 GPUmem(GB): used=0.00139 (oper,site,rinter,batch)=0.00127,9.18e-06,5.75e-05,0.0305 blksize=144 blksize0=100 batchsize=10531
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000475,0.00487,0.00115
--- TIMING FOR renorm : t_inter=4.7e-04 t_gemm=4.9e-03 t_reduction=1.2e-03 tot=6.5e-03 ---
 renorm[inter] counter=8 t=4.7e-04 per=7.3e+00 cost=7.5e+06 flops=1.6e+10
 renorm[gemm] counter=8 i=0 t=1.8e-06 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=1 t=1.5e-06 per=2.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=2 t=1.5e-06 per=2.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=3 t=1.4e-06 per=2.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=4 t=1.3e-03 per=2.0e+01 cost=1.1e+06 flops=8.7e+08
 renorm[gemm] counter=8 i=5 t=1.7e-03 per=2.6e+01 cost=3.7e+06 flops=2.2e+09
 renorm[gemm] counter=8 i=6 t=1.9e-03 per=2.9e+01 cost=5.4e+06 flops=2.8e+09
 renorm[gemm] counter=8 total t=4.9e-03 per=7.5e+01 cost=1.0e+07 flops=2.1e+09
 renorm[red] counter=8 t=1.2e-03 per=1.8e+01 cost=8.2e+05 flops=7.1e+08
--- TIMING FOR renorm_tot : t_inter=1.9e-03 t_gemm=1.5e-02 t_reduction=3.9e-03 tot=2.0e-02 ---
 renorm_tot[inter] counter=8 t=1.9e-03 per=9.4e+00 cost=1.7e+07 flops=8.7e+09
 renorm_tot[gemm] counter=8 i=0 t=1.2e-05 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=1 t=9.6e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=2 t=9.6e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=3 t=9.4e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=4 t=4.0e-03 per=1.9e+01 cost=3.0e+06 flops=7.6e+08
 renorm_tot[gemm] counter=8 i=5 t=4.9e-03 per=2.4e+01 cost=8.0e+06 flops=1.6e+09
 renorm_tot[gemm] counter=8 i=6 t=5.8e-03 per=2.8e+01 cost=1.3e+07 flops=2.3e+09
 renorm_tot[gemm] counter=8 total t=1.5e-02 per=7.2e+01 cost=2.5e+07 flops=1.7e+09
 renorm_tot[red] counter=8 t=3.9e-03 per=1.9e+01 cost=2.7e+06 flops=6.8e+08
qops.to_cpu: size(tot)=102470:7.8e-01MB:7.6e-04GB t[to_cpu]=2.2e-04S speed=3.4e+00GB/S
check ||H-H.dagger||=5.159e-14 coord=(8,0) rank=0
ctns::oper_ab2pq coord=(8,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.156 S rank=0 -----
CPUmem: VM:2.006e+01GB RSS:1.922e+00GB  Timing: User:5.304e+02S Sys:1.955e+00S Total:5.323e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1583:1.208e-02MB:1.179e-05GB
total mem of comb=16750:1.278e-01MB:1.248e-04GB
CPUmem: VM:2.006e+01GB RSS:1.922e+00GB  Timing: User:5.304e+02S Sys:1.956e+00S Total:5.323e+02S
##### local opt: 8.744e-01 S #####
 T(local opt: fetch) = 1.450e-02 S  per = 1.66  per(accum) = 1.66
 T(local opt: hdiag) = 3.895e-03 S  per = 0.445  per(accum) = 2.1
 T(local opt: dvdsn) = 6.877e-01 S  per = 78.7  per(accum) = 80.8
 T(local opt: decim) = 3.679e-03 S  per = 0.421  per(accum) = 81.2
 T(local opt: guess) = 9.871e-04 S  per = 0.113  per(accum) = 81.3
 T(local opt: renrm) = 1.601e-01 S  per = 18.3  per(accum) = 99.6
 T(local opt: save ) = 3.512e-03 S  per = 0.402  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.877e-01 S  T(sum) = 4.138e-01 S  per = 6.017e+01
 T(local opt: preprocess                  ) = 7.118e-04 S  per = 0.172  per(accum) = 0.172
 T(local opt: symbolic_formulae           ) = 2.227e-02 S  per = 5.38  per(accum) = 5.55
 T(local opt: hintermediate init          ) = 5.411e-04 S  per = 0.131  per(accum) = 5.68
 T(local opt: preprocess_hformulae_Hxlist ) = 3.949e-02 S  per = 9.54  per(accum) = 15.2
 T(local opt: hmmtasks init               ) = 2.299e-01 S  per = 55.6  per(accum) = 70.8
 T(local opt: initial guess for dvdson    ) = 1.286e-05 S  per = 0.00311  per(accum) = 70.8
 T(local opt: dvdson solver [Hx_batchGPU] ) = 8.345e-02 S  per = 20.2  per(accum) = 91
 T(local opt: dvdson solver [comm(gpu)]   ) = 3.369e-04 S  per = 0.0814  per(accum) = 91
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.064e-06 S  per = 0.000257  per(accum) = 91
 T(local opt: dvdson solver [rest part]   ) = 3.704e-02 S  per = 8.95  per(accum) = 100
Detailed decomposition of T(renrm) = 1.601e-01 S  T(sum) = 1.601e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.934e-03 S  per = 1.83  per(accum) = 1.83
 T(local opt: qops init                    ) = 1.508e-02 S  per = 9.42  per(accum) = 11.3
 T(local opt: symbolic_formulae_renorm     ) = 2.204e-02 S  per = 13.8  per(accum) = 25
 T(local opt: allocate qops on gpu         ) = 2.053e-04 S  per = 0.128  per(accum) = 25.2
 T(local opt: site memcpy cpu2gpu          ) = 3.448e-05 S  per = 0.0215  per(accum) = 25.2
 T(local opt: rintermediate init           ) = 7.583e-04 S  per = 0.474  per(accum) = 25.6
 T(local opt: preprocess_formulae_Rlist2   ) = 2.432e-02 S  per = 15.2  per(accum) = 40.8
 T(local opt: rmmtasks init                ) = 8.675e-02 S  per = 54.2  per(accum) = 95
 T(local opt: qops memset on cpu           ) = 4.600e-08 S  per = 2.87e-05  per(accum) = 95
 T(local opt: preprocess_renorm_batchGPU   ) = 6.613e-03 S  per = 4.13  per(accum) = 99.2
 T(local opt: reduction of opS & opH [nccl]) = 1.286e-06 S  per = 0.000803  per(accum) = 99.2
 T(local opt: qops memcpy gpu2cpu          ) = 2.333e-04 S  per = 0.146  per(accum) = 99.3
 T(local opt: deallocate cpu and gpu memory) = 1.568e-04 S  per = 0.098  per(accum) = 99.4
 T(local opt: reduction of opS & opH [comm]) = 6.088e-05 S  per = 0.038  per(accum) = 99.5
 T(local opt: conversion from opAB to opPQ ) = 4.899e-06 S  per = 0.00306  per(accum) = 99.5
 T(local opt: after oper_renorm            ) = 8.663e-04 S  per = 0.541  per(accum) = 100
##### sweep opt: 2.696e+00 S #####
 T(sweep opt: fetch) = 9.671e-02 S  per = 3.59  per(accum) = 3.59
 T(sweep opt: hdiag) = 1.225e-02 S  per = 0.454  per(accum) = 4.04
 T(sweep opt: dvdsn) = 2.081e+00 S  per = 77.2  per(accum) = 81.2
 T(sweep opt: decim) = 9.319e-03 S  per = 0.346  per(accum) = 81.6
 T(sweep opt: guess) = 2.602e-03 S  per = 0.0965  per(accum) = 81.7
 T(sweep opt: renrm) = 4.786e-01 S  per = 17.8  per(accum) = 99.4
 T(sweep opt: save ) = 1.568e-02 S  per = 0.582  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.081e+00 S  T(sum) = 1.804e+00 S  per = 8.669e+01
 T(sweep opt: preprocess                  ) = 3.329e-03 S  per = 0.185  per(accum) = 0.185
 T(sweep opt: symbolic_formulae           ) = 8.564e-02 S  per = 4.75  per(accum) = 4.93
 T(sweep opt: hintermediate init          ) = 1.998e-03 S  per = 0.111  per(accum) = 5.04
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.066e-01 S  per = 5.91  per(accum) = 11
 T(sweep opt: hmmtasks init               ) = 1.055e+00 S  per = 58.5  per(accum) = 69.5
 T(sweep opt: initial guess for dvdson    ) = 4.675e-05 S  per = 0.00259  per(accum) = 69.5
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 2.235e-01 S  per = 12.4  per(accum) = 81.8
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 1.617e-03 S  per = 0.0897  per(accum) = 81.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 6.781e-06 S  per = 0.000376  per(accum) = 81.9
 T(sweep opt: dvdson solver [rest part]   ) = 3.258e-01 S  per = 18.1  per(accum) = 100
Detailed decomposition of T(renrm) = 4.786e-01 S  T(sum) = 4.786e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.215e-03 S  per = 0.881  per(accum) = 0.881
 T(sweep opt: qops init                    ) = 3.210e-02 S  per = 6.71  per(accum) = 7.59
 T(sweep opt: symbolic_formulae_renorm     ) = 6.567e-02 S  per = 13.7  per(accum) = 21.3
 T(sweep opt: allocate qops on gpu         ) = 3.931e-04 S  per = 0.0821  per(accum) = 21.4
 T(sweep opt: site memcpy cpu2gpu          ) = 1.728e-04 S  per = 0.0361  per(accum) = 21.4
 T(sweep opt: rintermediate init           ) = 3.289e-03 S  per = 0.687  per(accum) = 22.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 7.067e-02 S  per = 14.8  per(accum) = 36.9
 T(sweep opt: rmmtasks init                ) = 2.749e-01 S  per = 57.4  per(accum) = 94.3
 T(sweep opt: qops memset on cpu           ) = 4.590e-07 S  per = 9.59e-05  per(accum) = 94.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.128e-02 S  per = 4.45  per(accum) = 98.8
 T(sweep opt: reduction of opS & opH [nccl]) = 8.582e-06 S  per = 0.00179  per(accum) = 98.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.593e-04 S  per = 0.138  per(accum) = 98.9
 T(sweep opt: deallocate cpu and gpu memory) = 1.223e-03 S  per = 0.255  per(accum) = 99.1
 T(sweep opt: reduction of opS & opH [comm]) = 3.166e-04 S  per = 0.0661  per(accum) = 99.2
 T(sweep opt: conversion from opAB to opPQ ) = 3.173e-05 S  per = 0.00663  per(accum) = 99.2
 T(sweep opt: after oper_renorm            ) = 3.720e-03 S  per = 0.777  per(accum) = 100
##### global opt: 2.696e+00 S #####
 T(global opt: fetch) = 9.671e-02 S  per = 3.59  per(accum) = 3.59
 T(global opt: hdiag) = 1.225e-02 S  per = 0.454  per(accum) = 4.04
 T(global opt: dvdsn) = 2.081e+00 S  per = 77.2  per(accum) = 81.2
 T(global opt: decim) = 9.319e-03 S  per = 0.346  per(accum) = 81.6
 T(global opt: guess) = 2.602e-03 S  per = 0.0965  per(accum) = 81.7
 T(global opt: renrm) = 4.786e-01 S  per = 17.8  per(accum) = 99.4
 T(global opt: save ) = 1.568e-02 S  per = 0.582  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.081e+00 S  T(sum) = 1.804e+00 S  per = 8.669e+01
 T(global opt: preprocess                  ) = 3.329e-03 S  per = 0.185  per(accum) = 0.185
 T(global opt: symbolic_formulae           ) = 8.564e-02 S  per = 4.75  per(accum) = 4.93
 T(global opt: hintermediate init          ) = 1.998e-03 S  per = 0.111  per(accum) = 5.04
 T(global opt: preprocess_hformulae_Hxlist ) = 1.066e-01 S  per = 5.91  per(accum) = 11
 T(global opt: hmmtasks init               ) = 1.055e+00 S  per = 58.5  per(accum) = 69.5
 T(global opt: initial guess for dvdson    ) = 4.675e-05 S  per = 0.00259  per(accum) = 69.5
 T(global opt: dvdson solver [Hx_batchGPU] ) = 2.235e-01 S  per = 12.4  per(accum) = 81.8
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.617e-03 S  per = 0.0897  per(accum) = 81.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 6.781e-06 S  per = 0.000376  per(accum) = 81.9
 T(global opt: dvdson solver [rest part]   ) = 3.258e-01 S  per = 18.1  per(accum) = 100
Detailed decomposition of T(renrm) = 4.786e-01 S  T(sum) = 4.786e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.215e-03 S  per = 0.881  per(accum) = 0.881
 T(global opt: qops init                    ) = 3.210e-02 S  per = 6.71  per(accum) = 7.59
 T(global opt: symbolic_formulae_renorm     ) = 6.567e-02 S  per = 13.7  per(accum) = 21.3
 T(global opt: allocate qops on gpu         ) = 3.931e-04 S  per = 0.0821  per(accum) = 21.4
 T(global opt: site memcpy cpu2gpu          ) = 1.728e-04 S  per = 0.0361  per(accum) = 21.4
 T(global opt: rintermediate init           ) = 3.289e-03 S  per = 0.687  per(accum) = 22.1
 T(global opt: preprocess_formulae_Rlist2   ) = 7.067e-02 S  per = 14.8  per(accum) = 36.9
 T(global opt: rmmtasks init                ) = 2.749e-01 S  per = 57.4  per(accum) = 94.3
 T(global opt: qops memset on cpu           ) = 4.590e-07 S  per = 9.59e-05  per(accum) = 94.3
 T(global opt: preprocess_renorm_batchGPU   ) = 2.128e-02 S  per = 4.45  per(accum) = 98.8
 T(global opt: reduction of opS & opH [nccl]) = 8.582e-06 S  per = 0.00179  per(accum) = 98.8
 T(global opt: qops memcpy gpu2cpu          ) = 6.593e-04 S  per = 0.138  per(accum) = 98.9
 T(global opt: deallocate cpu and gpu memory) = 1.223e-03 S  per = 0.255  per(accum) = 99.1
 T(global opt: reduction of opS & opH [comm]) = 3.166e-04 S  per = 0.0661  per(accum) = 99.2
 T(global opt: conversion from opAB to opPQ ) = 3.173e-05 S  per = 0.00663  per(accum) = 99.2
 T(global opt: after oper_renorm            ) = 3.720e-03 S  per = 0.777  per(accum) = 100

isweep=0 ibond=8/seqsize=34 dots=1 dbond=(9,0)-(10,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.006e+01GB RSS:1.922e+00GB  Timing: User:5.304e+02S Sys:1.956e+00S Total:5.323e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1583:1.208e-02MB:1.179e-05GB
total mem of comb=16750:1.278e-01MB:1.248e-04GB
ctns::topology::check_partition: (sl,sr,sc)=9,10,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc= 5
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:18 S:22 H:1 A:153 B:171 
        dim(bra,ket)=65,65 size(op)=447:3.410e-03MB size(tot)=102470:7.818e-01MB:7.635e-04GB
 rqops: oplist=CSHPQ nops=C:20 S:20 H:1 P:190 Q:210 
        dim(bra,ket)=73,73 size(op)=613:4.677e-03MB size(tot)=164348:1.254e+00MB:1.224e-03GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=269154:2.053e+00MB:2.005e-03GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(9,0) fdel=./scratch/sweep/rop(10,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
wf3(diml,dimr,dimc)=(65,73,4) nnz=1583:1.208e-02MB
qtensor3: wf3 own=1 _data=0x528b80f0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=13 dimAll=65
 (13,1):12 (14,0):8 (14,2):7 (13,-1):7 (12,0):6 (15,1):6 (12,2):5 (11,1):4 (13,3):4 (15,-1):3 (11,3):1 (11,-1):1 (15,3):1
 qbond: qcol nsym=12 dimAll=73
 (16,-2):14 (15,-1):10 (16,0):10 (14,-2):8 (15,-3):7 (14,0):6 (17,-1):5 (17,-3):4 (16,-4):4 (18,-2):3 (14,-4):1 (18,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=36 nblocks=624 size=1583:1.208e-02MB
### DIAG TIMING: total=5.673e-03 t1=1.562e-05, t2=2.763e-05, t3=4.728e-05, t4=5.541e-03, t5=1.964e-05, t6=1.764e-05, t7=4.101e-06
duration_diagGPU:5.689e-03
duration_diagreduce:4.800e-08
duration_diagtransform:6.373e-06
----- TIMING FOR symbolic_formulae_onedot with size=1635 : 3.026e-02 S -----
rank=0 GPUmem(GB): used=0.00201 (oper)=0.00201
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1635
 no. of hintermediate operators=828
 no. of coefficients=8280:0.0632MB:6.17e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.294e-04 S -----
rank=0 GPUmem(GB): used=0.00207 (oper,hinter)=0.00201,6.17e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0443 S size(H_formulae)=1635 size(Hxlst2)=36 T(Hmu/Hxlist)=0.00424,0.04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0498 S size(H_formulae)=1635 size(Hxlst)=44662 -----
rank=0 GPUmem(GB): used=0.161 (oper,hinter,dvdson,batch)=0.00201,6.17e-05,2.36e-05,0.159 blksize=168 blksize0=140 batchsize=44662
ctns::pdvdsonSolver_nkr::solve_iter ndim=1583 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.34e-05,0.000723,0.0445,0.00351,0.0488
 ndim=1583:1.18e-05GB t[comm(intra)]=3.13e-05 speed=0.755GB/S t[comm(inter)]=1.22e-05 speed=1.94GB/S
--- TIMING FOR sigma : t_inter=7.2e-04 t_gemm=4.5e-02 t_reduction=3.5e-03 tot=4.9e-02 ---
 sigma[inter] counter=52 t=7.2e-04 per=1.5e+00 cost=2.2e+07 flops=3.1e+10
 sigma[gemm] counter=52 i=0 t=1.4e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=2 t=1.1e-02 per=2.2e+01 cost=1.5e+07 flops=1.4e+09
 sigma[gemm] counter=52 i=3 t=9.4e-03 per=1.9e+01 cost=1.5e+07 flops=1.6e+09
 sigma[gemm] counter=52 i=4 t=1.3e-02 per=2.6e+01 cost=1.5e+07 flops=1.2e+09
 sigma[gemm] counter=52 i=5 t=1.2e-02 per=2.4e+01 cost=1.5e+07 flops=1.3e+09
 sigma[gemm] counter=52 total t=4.5e-02 per=9.1e+01 cost=5.9e+07 flops=1.3e+09
 sigma[red] counter=52 t=3.5e-03 per=7.2e+00 cost=4.4e+06 flops=1.3e+09
--- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=2.1e-01 t_reduction=3.2e-02 tot=2.6e-01 ---
 sigma_tot[inter] counter=52 t=1.8e-02 per=6.9e+00 cost=2.7e+08 flops=1.5e+10
 sigma_tot[gemm] counter=52 i=0 t=1.2e-04 per=4.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=1 t=8.7e-05 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=2 t=5.4e-02 per=2.1e+01 cost=1.4e+08 flops=2.5e+09
 sigma_tot[gemm] counter=52 i=3 t=5.4e-02 per=2.0e+01 cost=1.4e+08 flops=2.6e+09
 sigma_tot[gemm] counter=52 i=4 t=5.3e-02 per=2.0e+01 cost=1.5e+08 flops=2.8e+09
 sigma_tot[gemm] counter=52 i=5 t=5.3e-02 per=2.0e+01 cost=1.6e+08 flops=3.0e+09
 sigma_tot[gemm] counter=52 total t=2.1e-01 per=8.1e+01 cost=5.8e+08 flops=2.7e+09
 sigma_tot[red] counter=52 t=3.2e-02 per=1.2e+01 cost=5.2e+07 flops=1.6e+09
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=8.6e-06,8.3e-06,2.0e-06,2.9e-06,7.1e-07
settings: ndim=1583 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.490872151426 -1.116e+03  5.160e-02    1     1  4.897e-02 4.897e-02 4.893e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.476e-05,9.713e-04,7.028e-03,1.059e-03,9.116e-03
 ndim=1583:1.179e-05GB t[comm(intra)]=3.824e-05 speed=6.168e-01GB/S t[comm(inter)]=6.518e-06 speed=3.619e+00GB/S
--- TIMING FOR sigma : t_inter=9.7e-04 t_gemm=7.0e-03 t_reduction=1.1e-03 tot=9.1e-03 ---
 sigma[inter] counter=53 t=9.7e-04 per=1.1e+01 cost=2.2e+07 flops=2.3e+10
 sigma[gemm] counter=53 i=0 t=1.7e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=1 t=1.5e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=2 t=1.9e-03 per=2.1e+01 cost=1.5e+07 flops=7.9e+09
 sigma[gemm] counter=53 i=3 t=1.9e-03 per=2.1e+01 cost=1.5e+07 flops=7.7e+09
 sigma[gemm] counter=53 i=4 t=1.7e-03 per=1.9e+01 cost=1.5e+07 flops=8.6e+09
 sigma[gemm] counter=53 i=5 t=1.6e-03 per=1.7e+01 cost=1.5e+07 flops=9.7e+09
 sigma[gemm] counter=53 total t=7.0e-03 per=7.8e+01 cost=5.9e+07 flops=8.4e+09
 sigma[red] counter=53 t=1.1e-03 per=1.2e+01 cost=4.4e+06 flops=4.2e+09
--- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=2.2e-01 t_reduction=3.3e-02 tot=2.7e-01 ---
 sigma_tot[inter] counter=53 t=1.9e-02 per=7.0e+00 cost=3.0e+08 flops=1.5e+10
 sigma_tot[gemm] counter=53 i=0 t=1.2e-04 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=1 t=8.9e-05 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=2 t=5.6e-02 per=2.1e+01 cost=1.5e+08 flops=2.7e+09
 sigma_tot[gemm] counter=53 i=3 t=5.6e-02 per=2.0e+01 cost=1.5e+08 flops=2.8e+09
 sigma_tot[gemm] counter=53 i=4 t=5.5e-02 per=2.0e+01 cost=1.6e+08 flops=3.0e+09
 sigma_tot[gemm] counter=53 i=5 t=5.5e-02 per=2.0e+01 cost=1.7e+08 flops=3.2e+09
 sigma_tot[gemm] counter=53 total t=2.2e-01 per=8.1e+01 cost=6.4e+08 flops=2.9e+09
 sigma_tot[red] counter=53 t=3.3e-02 per=1.2e+01 cost=5.6e+07 flops=1.7e+09
T(sub)=6.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,3.6e-05,4.3e-06,5.6e-06,7.4e-07
    2   0 -    -116.494545876311 -3.674e-03  1.335e-02    2     2  6.340e-02 3.170e-02 2.908e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.145e-05,9.548e-04,6.958e-03,1.049e-03,9.015e-03
 ndim=1583:1.179e-05GB t[comm(intra)]=3.604e-05 speed=6.546e-01GB/S t[comm(inter)]=5.412e-06 speed=4.359e+00GB/S
--- TIMING FOR sigma : t_inter=9.5e-04 t_gemm=7.0e-03 t_reduction=1.0e-03 tot=9.0e-03 ---
 sigma[inter] counter=54 t=9.5e-04 per=1.1e+01 cost=2.2e+07 flops=2.4e+10
 sigma[gemm] counter=54 i=0 t=1.7e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=1 t=1.5e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=2 t=1.8e-03 per=2.1e+01 cost=1.5e+07 flops=7.9e+09
 sigma[gemm] counter=54 i=3 t=1.9e-03 per=2.1e+01 cost=1.5e+07 flops=7.7e+09
 sigma[gemm] counter=54 i=4 t=1.7e-03 per=1.9e+01 cost=1.5e+07 flops=8.7e+09
 sigma[gemm] counter=54 i=5 t=1.5e-03 per=1.7e+01 cost=1.5e+07 flops=9.9e+09
 sigma[gemm] counter=54 total t=7.0e-03 per=7.8e+01 cost=5.9e+07 flops=8.5e+09
 sigma[red] counter=54 t=1.0e-03 per=1.2e+01 cost=4.4e+06 flops=4.2e+09
--- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=2.3e-01 t_reduction=3.4e-02 tot=2.8e-01 ---
 sigma_tot[inter] counter=54 t=2.0e-02 per=7.1e+00 cost=3.2e+08 flops=1.6e+10
 sigma_tot[gemm] counter=54 i=0 t=1.2e-04 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=1 t=9.0e-05 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=2 t=5.8e-02 per=2.1e+01 cost=1.7e+08 flops=2.9e+09
 sigma_tot[gemm] counter=54 i=3 t=5.8e-02 per=2.0e+01 cost=1.7e+08 flops=2.9e+09
 sigma_tot[gemm] counter=54 i=4 t=5.6e-02 per=2.0e+01 cost=1.8e+08 flops=3.2e+09
 sigma_tot[gemm] counter=54 i=5 t=5.6e-02 per=2.0e+01 cost=1.9e+08 flops=3.4e+09
 sigma_tot[gemm] counter=54 total t=2.3e-01 per=8.1e+01 cost=7.0e+08 flops=3.1e+09
 sigma_tot[red] counter=54 t=3.4e-02 per=1.2e+01 cost=6.0e+07 flops=1.8e+09
T(sub)=5.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,2.9e-05,3.4e-06,8.1e-06,6.9e-07
    3   0 -    -116.494898262827 -3.524e-04  6.125e-03    3     3  7.770e-02 2.590e-02 2.243e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.975e-05,8.078e-04,6.243e-03,1.041e-03,8.143e-03
 ndim=1583:1.179e-05GB t[comm(intra)]=3.493e-05 speed=6.754e-01GB/S t[comm(inter)]=4.823e-06 speed=4.891e+00GB/S
--- TIMING FOR sigma : t_inter=8.1e-04 t_gemm=6.2e-03 t_reduction=1.0e-03 tot=8.1e-03 ---
 sigma[inter] counter=55 t=8.1e-04 per=1.0e+01 cost=2.2e+07 flops=2.8e+10
 sigma[gemm] counter=55 i=0 t=1.5e-06 per=1.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=1 t=1.3e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=2 t=1.5e-03 per=1.9e+01 cost=1.5e+07 flops=9.5e+09
 sigma[gemm] counter=55 i=3 t=1.6e-03 per=1.9e+01 cost=1.5e+07 flops=9.4e+09
 sigma[gemm] counter=55 i=4 t=1.6e-03 per=2.0e+01 cost=1.5e+07 flops=9.1e+09
 sigma[gemm] counter=55 i=5 t=1.5e-03 per=1.9e+01 cost=1.5e+07 flops=9.8e+09
 sigma[gemm] counter=55 total t=6.2e-03 per=7.7e+01 cost=5.9e+07 flops=9.5e+09
 sigma[red] counter=55 t=1.0e-03 per=1.3e+01 cost=4.4e+06 flops=4.2e+09
--- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=2.3e-01 t_reduction=3.5e-02 tot=2.9e-01 ---
 sigma_tot[inter] counter=55 t=2.1e-02 per=7.2e+00 cost=3.4e+08 flops=1.6e+10
 sigma_tot[gemm] counter=55 i=0 t=1.2e-04 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=1 t=9.1e-05 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=2 t=6.0e-02 per=2.1e+01 cost=1.8e+08 flops=3.0e+09
 sigma_tot[gemm] counter=55 i=3 t=5.9e-02 per=2.0e+01 cost=1.8e+08 flops=3.1e+09
 sigma_tot[gemm] counter=55 i=4 t=5.8e-02 per=2.0e+01 cost=1.9e+08 flops=3.3e+09
 sigma_tot[gemm] counter=55 i=5 t=5.8e-02 per=2.0e+01 cost=2.0e+08 flops=3.5e+09
 sigma_tot[gemm] counter=55 total t=2.3e-01 per=8.1e+01 cost=7.6e+08 flops=3.2e+09
 sigma_tot[red] counter=55 t=3.5e-02 per=1.2e+01 cost=6.5e+07 flops=1.8e+09
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,2.5e-05,3.5e-06,7.9e-06,6.6e-07
    4   0 -    -116.494961229754 -6.297e-05  2.624e-03    3     4  9.554e-02 2.388e-02 1.889e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=5.240e-05,9.373e-04,7.497e-03,1.273e-03,9.772e-03
 ndim=1583:1.179e-05GB t[comm(intra)]=4.701e-05 speed=5.018e-01GB/S t[comm(inter)]=5.392e-06 speed=4.375e+00GB/S
--- TIMING FOR sigma : t_inter=9.4e-04 t_gemm=7.5e-03 t_reduction=1.3e-03 tot=9.7e-03 ---
 sigma[inter] counter=56 t=9.4e-04 per=9.7e+00 cost=2.2e+07 flops=2.4e+10
 sigma[gemm] counter=56 i=0 t=1.7e-06 per=1.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=1 t=1.5e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=2 t=1.8e-03 per=1.9e+01 cost=1.5e+07 flops=8.1e+09
 sigma[gemm] counter=56 i=3 t=1.9e-03 per=2.0e+01 cost=1.5e+07 flops=7.8e+09
 sigma[gemm] counter=56 i=4 t=1.9e-03 per=2.0e+01 cost=1.5e+07 flops=7.6e+09
 sigma[gemm] counter=56 i=5 t=1.9e-03 per=1.9e+01 cost=1.5e+07 flops=8.1e+09
 sigma[gemm] counter=56 total t=7.5e-03 per=7.7e+01 cost=5.9e+07 flops=7.9e+09
 sigma[red] counter=56 t=1.3e-03 per=1.3e+01 cost=4.4e+06 flops=3.5e+09
--- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=2.4e-01 t_reduction=3.7e-02 tot=3.0e-01 ---
 sigma_tot[inter] counter=56 t=2.2e-02 per=7.3e+00 cost=3.6e+08 flops=1.7e+10
 sigma_tot[gemm] counter=56 i=0 t=1.2e-04 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=1 t=9.3e-05 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=2 t=6.2e-02 per=2.0e+01 cost=2.0e+08 flops=3.2e+09
 sigma_tot[gemm] counter=56 i=3 t=6.1e-02 per=2.0e+01 cost=2.0e+08 flops=3.2e+09
 sigma_tot[gemm] counter=56 i=4 t=6.0e-02 per=2.0e+01 cost=2.1e+08 flops=3.5e+09
 sigma_tot[gemm] counter=56 i=5 t=6.0e-02 per=2.0e+01 cost=2.2e+08 flops=3.7e+09
 sigma_tot[gemm] counter=56 total t=2.4e-01 per=8.1e+01 cost=8.2e+08 flops=3.4e+09
 sigma_tot[red] counter=56 t=3.7e-02 per=1.2e+01 cost=6.9e+07 flops=1.9e+09
T(sub)=5.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.5e-05,1.3e-05,7.8e-06,6.5e-07
    5   0 -    -116.494972770475 -1.154e-05  1.071e-03    3     5  1.105e-01 2.209e-02 1.708e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.925e-05,9.534e-04,6.917e-03,1.051e-03,8.972e-03
 ndim=1583:1.179e-05GB t[comm(intra)]=3.425e-05 speed=6.886e-01GB/S t[comm(inter)]=4.996e-06 speed=4.721e+00GB/S
--- TIMING FOR sigma : t_inter=9.5e-04 t_gemm=6.9e-03 t_reduction=1.1e-03 tot=8.9e-03 ---
 sigma[inter] counter=57 t=9.5e-04 per=1.1e+01 cost=2.2e+07 flops=2.4e+10
 sigma[gemm] counter=57 i=0 t=1.6e-06 per=1.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=1 t=1.5e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=2 t=1.8e-03 per=2.0e+01 cost=1.5e+07 flops=8.1e+09
 sigma[gemm] counter=57 i=3 t=1.9e-03 per=2.1e+01 cost=1.5e+07 flops=7.8e+09
 sigma[gemm] counter=57 i=4 t=1.7e-03 per=1.9e+01 cost=1.5e+07 flops=8.7e+09
 sigma[gemm] counter=57 i=5 t=1.5e-03 per=1.7e+01 cost=1.5e+07 flops=9.8e+09
 sigma[gemm] counter=57 total t=6.9e-03 per=7.8e+01 cost=5.9e+07 flops=8.5e+09
 sigma[red] counter=57 t=1.1e-03 per=1.2e+01 cost=4.4e+06 flops=4.2e+09
--- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=2.5e-01 t_reduction=3.8e-02 tot=3.1e-01 ---
 sigma_tot[inter] counter=57 t=2.3e-02 per=7.4e+00 cost=3.9e+08 flops=1.7e+10
 sigma_tot[gemm] counter=57 i=0 t=1.3e-04 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=1 t=9.4e-05 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=2 t=6.3e-02 per=2.0e+01 cost=2.1e+08 flops=3.3e+09
 sigma_tot[gemm] counter=57 i=3 t=6.3e-02 per=2.0e+01 cost=2.1e+08 flops=3.4e+09
 sigma_tot[gemm] counter=57 i=4 t=6.2e-02 per=2.0e+01 cost=2.2e+08 flops=3.6e+09
 sigma_tot[gemm] counter=57 i=5 t=6.1e-02 per=2.0e+01 cost=2.3e+08 flops=3.8e+09
 sigma_tot[gemm] counter=57 total t=2.5e-01 per=8.0e+01 cost=8.8e+08 flops=3.5e+09
 sigma_tot[red] counter=57 t=3.8e-02 per=1.2e+01 cost=7.4e+07 flops=2.0e+09
T(sub)=5.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.4e-05,3.1e-06,2.0e-05,1.0e-06
    6   0 -    -116.494974648739 -1.878e-06  4.831e-04    3     6  1.243e-01 2.071e-02 1.575e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.919e-05,9.532e-04,6.886e-03,1.036e-03,8.925e-03
 ndim=1583:1.179e-05GB t[comm(intra)]=3.435e-05 speed=6.868e-01GB/S t[comm(inter)]=4.848e-06 speed=4.866e+00GB/S
--- TIMING FOR sigma : t_inter=9.5e-04 t_gemm=6.9e-03 t_reduction=1.0e-03 tot=8.9e-03 ---
 sigma[inter] counter=58 t=9.5e-04 per=1.1e+01 cost=2.2e+07 flops=2.4e+10
 sigma[gemm] counter=58 i=0 t=1.7e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=1 t=1.5e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=2 t=1.8e-03 per=2.0e+01 cost=1.5e+07 flops=8.1e+09
 sigma[gemm] counter=58 i=3 t=1.9e-03 per=2.1e+01 cost=1.5e+07 flops=7.8e+09
 sigma[gemm] counter=58 i=4 t=1.6e-03 per=1.8e+01 cost=1.5e+07 flops=8.9e+09
 sigma[gemm] counter=58 i=5 t=1.5e-03 per=1.7e+01 cost=1.5e+07 flops=9.8e+09
 sigma[gemm] counter=58 total t=6.9e-03 per=7.8e+01 cost=5.9e+07 flops=8.6e+09
 sigma[red] counter=58 t=1.0e-03 per=1.2e+01 cost=4.4e+06 flops=4.2e+09
--- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=2.6e-01 t_reduction=3.9e-02 tot=3.2e-01 ---
 sigma_tot[inter] counter=58 t=2.4e-02 per=7.5e+00 cost=4.1e+08 flops=1.7e+10
 sigma_tot[gemm] counter=58 i=0 t=1.3e-04 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=1 t=9.6e-05 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=2 t=6.5e-02 per=2.0e+01 cost=2.3e+08 flops=3.5e+09
 sigma_tot[gemm] counter=58 i=3 t=6.5e-02 per=2.0e+01 cost=2.3e+08 flops=3.5e+09
 sigma_tot[gemm] counter=58 i=4 t=6.3e-02 per=2.0e+01 cost=2.4e+08 flops=3.7e+09
 sigma_tot[gemm] counter=58 i=5 t=6.3e-02 per=2.0e+01 cost=2.5e+08 flops=4.0e+09
 sigma_tot[gemm] counter=58 total t=2.6e-01 per=8.0e+01 cost=9.4e+08 flops=3.7e+09
 sigma_tot[red] counter=58 t=3.9e-02 per=1.2e+01 cost=7.8e+07 flops=2.0e+09
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.4e-05,3.1e-06,7.8e-06,8.7e-07
    7   0 -    -116.494975034656 -3.859e-07  1.944e-04    3     7  1.380e-01 1.971e-02 1.479e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.000e-05,9.332e-04,6.874e-03,1.041e-03,8.898e-03
 ndim=1583:1.179e-05GB t[comm(intra)]=2.505e-05 speed=9.418e-01GB/S t[comm(inter)]=1.495e-05 speed=1.578e+00GB/S
--- TIMING FOR sigma : t_inter=9.3e-04 t_gemm=6.9e-03 t_reduction=1.0e-03 tot=8.8e-03 ---
 sigma[inter] counter=59 t=9.3e-04 per=1.1e+01 cost=2.2e+07 flops=2.4e+10
 sigma[gemm] counter=59 i=0 t=1.7e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=1 t=1.5e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=2 t=1.8e-03 per=2.0e+01 cost=1.5e+07 flops=8.1e+09
 sigma[gemm] counter=59 i=3 t=1.9e-03 per=2.1e+01 cost=1.5e+07 flops=7.8e+09
 sigma[gemm] counter=59 i=4 t=1.7e-03 per=1.9e+01 cost=1.5e+07 flops=8.8e+09
 sigma[gemm] counter=59 i=5 t=1.5e-03 per=1.7e+01 cost=1.5e+07 flops=9.9e+09
 sigma[gemm] counter=59 total t=6.9e-03 per=7.8e+01 cost=5.9e+07 flops=8.6e+09
 sigma[red] counter=59 t=1.0e-03 per=1.2e+01 cost=4.4e+06 flops=4.2e+09
--- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=2.6e-01 t_reduction=4.0e-02 tot=3.3e-01 ---
 sigma_tot[inter] counter=59 t=2.5e-02 per=7.5e+00 cost=4.3e+08 flops=1.7e+10
 sigma_tot[gemm] counter=59 i=0 t=1.3e-04 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=1 t=9.7e-05 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=2 t=6.7e-02 per=2.0e+01 cost=2.4e+08 flops=3.6e+09
 sigma_tot[gemm] counter=59 i=3 t=6.7e-02 per=2.0e+01 cost=2.4e+08 flops=3.6e+09
 sigma_tot[gemm] counter=59 i=4 t=6.5e-02 per=2.0e+01 cost=2.5e+08 flops=3.9e+09
 sigma_tot[gemm] counter=59 i=5 t=6.4e-02 per=2.0e+01 cost=2.6e+08 flops=4.1e+09
 sigma_tot[gemm] counter=59 total t=2.6e-01 per=8.0e+01 cost=1.0e+09 flops=3.8e+09
 sigma_tot[red] counter=59 t=4.0e-02 per=1.2e+01 cost=8.2e+07 flops=2.1e+09
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.4e-05,3.1e-06,2.0e-05,1.0e-06
    8   0 +    -116.494975102556 -6.790e-08  7.678e-05    3     8  1.517e-01 1.897e-02 1.407e-02
TIMING FOR Davidson : 1.517e-01  T(cal/comm/rest)=1.125e-01,9.170e-07,3.920e-02
decomposed t_rest=3.920e-02
 T(sub)    =3.952e-04 per=1.008e+00
 T(precond)=3.852e-02 per=9.826e+01
 T(ortho)  =6.652e-05 per=1.697e-01
 T(xcopy)  =5.404e-06 per=1.379e-02
 T(xnrm2)  =7.442e-06 per=1.899e-02
 T(other)  =2.067e-04 per=5.272e-01
optimized energies: isweep=0 ibond=8 dots=1 e[0]=-116.494975102556 nmvp=8
CPUmem: VM:2.007e+01GB RSS:1.931e+00GB  Timing: User:5.417e+02S Sys:1.963e+00S Total:5.436e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=24 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond8.txt
 qbond: qsuper nsym=24 dimAll=260
 (13,1):27 (15,1):33 (14,2):28 (14,0):33 (16,0):17 (15,-1):18 (16,2):14 (15,3):12 (13,-1):14 (14,-2):7 (12,0):11 (17,1):6 (12,2):10 (13,3):10 (11,1):4 (14,4):4 (17,-1):3 (16,-2):3 (11,3):1 (12,4):1 (11,-1):1 (12,-2):1 (17,3):1 (16,4):1
timing for divide=2.8e-05
timing for compute=4.0e-04
timing for collect=1.9e-05
----- TMING FOR decimation_genbasis(nkr): 4.5e-04 S T(divide/compute/collect)=2.8e-05,4.0e-04,1.9e-05 -----
decimation summary: 260->73 dwt=+0.000e+00 SvN=2.129e+00
 qbond: qkept nsym=12 dimAll=73
 (14,2):14 (15,1):10 (14,0):10 (16,2):8 (15,3):7 (16,0):6 (13,1):5 (13,3):4 (14,4):4 (12,2):3 (12,0):1 (16,4):1
----- TIMING for decimation_row(nkr): 1.212e-03 S T(decim/select/formRot)=5.456e-04,6.216e-04,4.438e-05 -----
----- TIMING FOR onedot_decimation: 1.467e-03 S T(wf/decim)=2.329e-04,1.234e-03 -----
ctns::oper_renorm coord=(9,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:20 S:20 H:1 A:190 B:210 
        dim(bra,ket)=73,73 size(op)=613:4.677e-03MB size(tot)=164348:1.254e+00MB:1.224e-03GB
CPUmem: VM:2.007e+01GB RSS:1.931e+00GB  Timing: User:5.417e+02S Sys:1.964e+00S Total:5.437e+02S
----- TIMING FOR symbolic_formulae_renorm with size=441 : 1.345e-02 S -----
rank=0 GPUmem(GB): used=0.00207 (oper)=0.00201
rank=0 GPUmem(GB): used=0.00208 (oper,site)(GB)=0.00201,1.18e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=441
 no. of rintermediate operators=207
 no. of coefficients=8802:0.0672MB:6.56e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.301e-04 S -----
rank=0 GPUmem(GB): used=0.00214 (oper,site,rinter)=0.00201,1.18e-05,6.56e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0135 S size(rtasks)=441 size(Rlst2)=144 T(Rmu/Rlist)=0.00182,0.0117 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0146 S size(rtasks)=441 size(Rlst)=11791 -----
rank=0 GPUmem(GB): used=0.00214 (oper,site,rinter,batch)=0.00201,1.18e-05,6.56e-05,0.0472 blksize=196 blksize0=144 batchsize=11791
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00344,0.033,0.00772
--- TIMING FOR renorm : t_inter=3.4e-03 t_gemm=3.3e-02 t_reduction=7.7e-03 tot=4.4e-02 ---
 renorm[inter] counter=9 t=3.4e-03 per=7.8e+00 cost=8.9e+06 flops=2.6e+09
 renorm[gemm] counter=9 i=0 t=1.3e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=1 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=2 t=1.0e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=3 t=1.0e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=4 t=9.1e-03 per=2.1e+01 cost=1.4e+06 flops=1.6e+08
 renorm[gemm] counter=9 i=5 t=1.2e-02 per=2.6e+01 cost=5.8e+06 flops=5.0e+08
 renorm[gemm] counter=9 i=6 t=1.2e-02 per=2.8e+01 cost=9.4e+06 flops=7.6e+08
 renorm[gemm] counter=9 total t=3.3e-02 per=7.5e+01 cost=1.7e+07 flops=5.0e+08
 renorm[red] counter=9 t=7.7e-03 per=1.8e+01 cost=1.4e+06 flops=1.8e+08
--- TIMING FOR renorm_tot : t_inter=5.4e-03 t_gemm=4.8e-02 t_reduction=1.2e-02 tot=6.5e-02 ---
 renorm_tot[inter] counter=9 t=5.4e-03 per=8.3e+00 cost=2.6e+07 flops=4.8e+09
 renorm_tot[gemm] counter=9 i=0 t=1.3e-05 per=2.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=1 t=1.1e-05 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=2 t=1.1e-05 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=3 t=1.0e-05 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=4 t=1.3e-02 per=2.0e+01 cost=4.4e+06 flops=3.4e+08
 renorm_tot[gemm] counter=9 i=5 t=1.6e-02 per=2.5e+01 cost=1.4e+07 flops=8.4e+08
 renorm_tot[gemm] counter=9 i=6 t=1.8e-02 per=2.8e+01 cost=2.3e+07 flops=1.3e+09
 renorm_tot[gemm] counter=9 total t=4.8e-02 per=7.4e+01 cost=4.1e+07 flops=8.6e+08
 renorm_tot[red] counter=9 t=1.2e-02 per=1.8e+01 cost=4.0e+06 flops=3.5e+08
qops.to_cpu: size(tot)=164348:1.3e+00MB:1.2e-03GB t[to_cpu]=3.5e-04S speed=3.5e+00GB/S
check ||H-H.dagger||=6.076e-14 coord=(9,0) rank=0
ctns::oper_ab2pq coord=(9,0) superblock=lc ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 3.82 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.00615,4.13e-05,1.77,2.05,0.000712,0.00061 -----
----- TIMING FOR oper_renorm : 0.144 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.392e+02S Sys:2.673e+00S Total:9.418e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=2034:1.552e-02MB:1.515e-05GB
total mem of comb=17201:1.312e-01MB:1.282e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.393e+02S Sys:2.676e+00S Total:9.420e+02S
##### local opt: 4.518e+00 S #####
 T(local opt: fetch) = 1.867e-02 S  per = 0.413  per(accum) = 0.413
 T(local opt: hdiag) = 5.802e-03 S  per = 0.128  per(accum) = 0.542
 T(local opt: dvdsn) = 5.207e-01 S  per = 11.5  per(accum) = 12.1
 T(local opt: decim) = 1.476e-03 S  per = 0.0327  per(accum) = 12.1
 T(local opt: guess) = 3.057e-04 S  per = 0.00677  per(accum) = 12.1
 T(local opt: renrm) = 3.965e+00 S  per = 87.8  per(accum) = 99.9
 T(local opt: save ) = 5.988e-03 S  per = 0.133  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.207e-01 S  T(sum) = 5.202e-01 S  per = 9.990e+01
 T(local opt: preprocess                  ) = 8.620e-04 S  per = 0.166  per(accum) = 0.166
 T(local opt: symbolic_formulae           ) = 3.028e-02 S  per = 5.82  per(accum) = 5.99
 T(local opt: hintermediate init          ) = 7.492e-04 S  per = 0.144  per(accum) = 6.13
 T(local opt: preprocess_hformulae_Hxlist ) = 5.107e-02 S  per = 9.82  per(accum) = 15.9
 T(local opt: hmmtasks init               ) = 2.855e-01 S  per = 54.9  per(accum) = 70.8
 T(local opt: initial guess for dvdson    ) = 1.437e-05 S  per = 0.00276  per(accum) = 70.8
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.122e-01 S  per = 21.6  per(accum) = 92.4
 T(local opt: dvdson solver [comm(gpu)]   ) = 3.402e-04 S  per = 0.0654  per(accum) = 92.5
 T(local opt: dvdson solver [comm(cpu)]   ) = 9.170e-07 S  per = 0.000176  per(accum) = 92.5
 T(local opt: dvdson solver [rest part]   ) = 3.920e-02 S  per = 7.54  per(accum) = 100
Detailed decomposition of T(renrm) = 3.965e+00 S  T(sum) = 3.965e+00 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.293e-04 S  per = 0.00578  per(accum) = 0.00578
 T(local opt: qops init                    ) = 7.055e-03 S  per = 0.178  per(accum) = 0.184
 T(local opt: symbolic_formulae_renorm     ) = 1.347e-02 S  per = 0.34  per(accum) = 0.523
 T(local opt: allocate qops on gpu         ) = 2.996e-05 S  per = 0.000756  per(accum) = 0.524
 T(local opt: site memcpy cpu2gpu          ) = 2.392e-05 S  per = 0.000603  per(accum) = 0.525
 T(local opt: rintermediate init           ) = 4.429e-04 S  per = 0.0112  per(accum) = 0.536
 T(local opt: preprocess_formulae_Rlist2   ) = 1.494e-02 S  per = 0.377  per(accum) = 0.913
 T(local opt: rmmtasks init                ) = 6.275e-02 S  per = 1.58  per(accum) = 2.5
 T(local opt: qops memset on cpu           ) = 5.400e-08 S  per = 1.36e-06  per(accum) = 2.5
 T(local opt: preprocess_renorm_batchGPU   ) = 4.422e-02 S  per = 1.12  per(accum) = 3.61
 T(local opt: reduction of opS & opH [nccl]) = 1.050e-06 S  per = 2.65e-05  per(accum) = 3.61
 T(local opt: qops memcpy gpu2cpu          ) = 3.567e-04 S  per = 0.009  per(accum) = 3.62
 T(local opt: deallocate cpu and gpu memory) = 1.629e-04 S  per = 0.00411  per(accum) = 3.62
 T(local opt: reduction of opS & opH [comm]) = 6.195e-05 S  per = 0.00156  per(accum) = 3.63
 T(local opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 96.3  per(accum) = 100
 T(local opt: after oper_renorm            ) = 1.773e-03 S  per = 0.0447  per(accum) = 100
##### sweep opt: 7.213e+00 S #####
 T(sweep opt: fetch) = 1.154e-01 S  per =  1.6  per(accum) = 1.6
 T(sweep opt: hdiag) = 1.805e-02 S  per = 0.25  per(accum) = 1.85
 T(sweep opt: dvdsn) = 2.601e+00 S  per = 36.1  per(accum) = 37.9
 T(sweep opt: decim) = 1.080e-02 S  per = 0.15  per(accum) = 38.1
 T(sweep opt: guess) = 2.908e-03 S  per = 0.0403  per(accum) = 38.1
 T(sweep opt: renrm) = 4.443e+00 S  per = 61.6  per(accum) = 99.7
 T(sweep opt: save ) = 2.167e-02 S  per =  0.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.601e+00 S  T(sum) = 2.324e+00 S  per = 8.934e+01
 T(sweep opt: preprocess                  ) = 4.191e-03 S  per = 0.18  per(accum) = 0.18
 T(sweep opt: symbolic_formulae           ) = 1.159e-01 S  per = 4.99  per(accum) = 5.17
 T(sweep opt: hintermediate init          ) = 2.747e-03 S  per = 0.118  per(accum) = 5.29
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.577e-01 S  per = 6.78  per(accum) = 12.1
 T(sweep opt: hmmtasks init               ) = 1.341e+00 S  per = 57.7  per(accum) = 69.8
 T(sweep opt: initial guess for dvdson    ) = 6.112e-05 S  per = 0.00263  per(accum) = 69.8
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 3.357e-01 S  per = 14.4  per(accum) = 84.2
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 1.958e-03 S  per = 0.0842  per(accum) = 84.3
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 7.698e-06 S  per = 0.000331  per(accum) = 84.3
 T(sweep opt: dvdson solver [rest part]   ) = 3.650e-01 S  per = 15.7  per(accum) = 100
Detailed decomposition of T(renrm) = 4.443e+00 S  T(sum) = 4.443e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.444e-03 S  per =  0.1  per(accum) = 0.1
 T(sweep opt: qops init                    ) = 3.916e-02 S  per = 0.881  per(accum) = 0.981
 T(sweep opt: symbolic_formulae_renorm     ) = 7.914e-02 S  per = 1.78  per(accum) = 2.76
 T(sweep opt: allocate qops on gpu         ) = 4.230e-04 S  per = 0.00952  per(accum) = 2.77
 T(sweep opt: site memcpy cpu2gpu          ) = 1.968e-04 S  per = 0.00443  per(accum) = 2.78
 T(sweep opt: rintermediate init           ) = 3.732e-03 S  per = 0.084  per(accum) = 2.86
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.561e-02 S  per = 1.93  per(accum) = 4.79
 T(sweep opt: rmmtasks init                ) = 3.376e-01 S  per =  7.6  per(accum) = 12.4
 T(sweep opt: qops memset on cpu           ) = 5.130e-07 S  per = 1.15e-05  per(accum) = 12.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.549e-02 S  per = 1.47  per(accum) = 13.9
 T(sweep opt: reduction of opS & opH [nccl]) = 9.632e-06 S  per = 0.000217  per(accum) = 13.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.016e-03 S  per = 0.0229  per(accum) = 13.9
 T(sweep opt: deallocate cpu and gpu memory) = 1.386e-03 S  per = 0.0312  per(accum) = 13.9
 T(sweep opt: reduction of opS & opH [comm]) = 3.785e-04 S  per = 0.00852  per(accum) = 13.9
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per =   86  per(accum) = 99.9
 T(sweep opt: after oper_renorm            ) = 5.492e-03 S  per = 0.124  per(accum) = 100
##### global opt: 7.213e+00 S #####
 T(global opt: fetch) = 1.154e-01 S  per =  1.6  per(accum) = 1.6
 T(global opt: hdiag) = 1.805e-02 S  per = 0.25  per(accum) = 1.85
 T(global opt: dvdsn) = 2.601e+00 S  per = 36.1  per(accum) = 37.9
 T(global opt: decim) = 1.080e-02 S  per = 0.15  per(accum) = 38.1
 T(global opt: guess) = 2.908e-03 S  per = 0.0403  per(accum) = 38.1
 T(global opt: renrm) = 4.443e+00 S  per = 61.6  per(accum) = 99.7
 T(global opt: save ) = 2.167e-02 S  per =  0.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.601e+00 S  T(sum) = 2.324e+00 S  per = 8.934e+01
 T(global opt: preprocess                  ) = 4.191e-03 S  per = 0.18  per(accum) = 0.18
 T(global opt: symbolic_formulae           ) = 1.159e-01 S  per = 4.99  per(accum) = 5.17
 T(global opt: hintermediate init          ) = 2.747e-03 S  per = 0.118  per(accum) = 5.29
 T(global opt: preprocess_hformulae_Hxlist ) = 1.577e-01 S  per = 6.78  per(accum) = 12.1
 T(global opt: hmmtasks init               ) = 1.341e+00 S  per = 57.7  per(accum) = 69.8
 T(global opt: initial guess for dvdson    ) = 6.112e-05 S  per = 0.00263  per(accum) = 69.8
 T(global opt: dvdson solver [Hx_batchGPU] ) = 3.357e-01 S  per = 14.4  per(accum) = 84.2
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.958e-03 S  per = 0.0842  per(accum) = 84.3
 T(global opt: dvdson solver [comm(cpu)]   ) = 7.698e-06 S  per = 0.000331  per(accum) = 84.3
 T(global opt: dvdson solver [rest part]   ) = 3.650e-01 S  per = 15.7  per(accum) = 100
Detailed decomposition of T(renrm) = 4.443e+00 S  T(sum) = 4.443e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.444e-03 S  per =  0.1  per(accum) = 0.1
 T(global opt: qops init                    ) = 3.916e-02 S  per = 0.881  per(accum) = 0.981
 T(global opt: symbolic_formulae_renorm     ) = 7.914e-02 S  per = 1.78  per(accum) = 2.76
 T(global opt: allocate qops on gpu         ) = 4.230e-04 S  per = 0.00952  per(accum) = 2.77
 T(global opt: site memcpy cpu2gpu          ) = 1.968e-04 S  per = 0.00443  per(accum) = 2.78
 T(global opt: rintermediate init           ) = 3.732e-03 S  per = 0.084  per(accum) = 2.86
 T(global opt: preprocess_formulae_Rlist2   ) = 8.561e-02 S  per = 1.93  per(accum) = 4.79
 T(global opt: rmmtasks init                ) = 3.376e-01 S  per =  7.6  per(accum) = 12.4
 T(global opt: qops memset on cpu           ) = 5.130e-07 S  per = 1.15e-05  per(accum) = 12.4
 T(global opt: preprocess_renorm_batchGPU   ) = 6.549e-02 S  per = 1.47  per(accum) = 13.9
 T(global opt: reduction of opS & opH [nccl]) = 9.632e-06 S  per = 0.000217  per(accum) = 13.9
 T(global opt: qops memcpy gpu2cpu          ) = 1.016e-03 S  per = 0.0229  per(accum) = 13.9
 T(global opt: deallocate cpu and gpu memory) = 1.386e-03 S  per = 0.0312  per(accum) = 13.9
 T(global opt: reduction of opS & opH [comm]) = 3.785e-04 S  per = 0.00852  per(accum) = 13.9
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per =   86  per(accum) = 99.9
 T(global opt: after oper_renorm            ) = 5.492e-03 S  per = 0.124  per(accum) = 100

isweep=0 ibond=9/seqsize=34 dots=1 dbond=(10,0)-(11,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.393e+02S Sys:2.676e+00S Total:9.420e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=2034:1.552e-02MB:1.515e-05GB
total mem of comb=17201:1.312e-01MB:1.282e-04GB
ctns::topology::check_partition: (sl,sr,sc)=10,9,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc= 6
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:20 S:20 H:1 P:190 Q:210 
        dim(bra,ket)=73,73 size(op)=613:4.677e-03MB size(tot)=164348:1.254e+00MB:1.224e-03GB
 rqops: oplist=CSHAB nops=C:18 S:22 H:1 A:153 B:171 
        dim(bra,ket)=74,74 size(op)=818:6.241e-03MB size(tot)=165874:1.266e+00MB:1.236e-03GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=332558:2.537e+00MB:2.478e-03GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(10,0) fdel=./scratch/sweep/rop(11,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
wf3(diml,dimr,dimc)=(73,74,4) nnz=2034:1.552e-02MB
qtensor3: wf3 own=1 _data=0x52997380
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=12 dimAll=73
 (14,2):14 (15,1):10 (14,0):10 (16,2):8 (15,3):7 (16,0):6 (13,1):5 (13,3):4 (14,4):4 (12,2):3 (12,0):1 (16,4):1
 qbond: qcol nsym=9 dimAll=74
 (15,-3):15 (15,-1):14 (14,-2):11 (13,-1):10 (13,-3):10 (14,-4):7 (16,-2):5 (17,-1):1 (13,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=29 nblocks=432 size=2034:1.552e-02MB
### DIAG TIMING: total=4.882e-03 t1=2.958e-05, t2=5.319e-05, t3=6.082e-05, t4=4.674e-03, t5=8.277e-06, t6=5.208e-05, t7=4.079e-06
duration_diagGPU:4.897e-03
duration_diagreduce:8.100e-08
duration_diagtransform:7.730e-06
----- TIMING FOR symbolic_formulae_onedot with size=1635 : 2.997e-02 S -----
rank=0 GPUmem(GB): used=0.00248 (oper)=0.00248
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1635
 no. of hintermediate operators=828
 no. of coefficients=8280:0.0632MB:6.17e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.100e-04 S -----
rank=0 GPUmem(GB): used=0.00254 (oper,hinter)=0.00248,6.17e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.038 S size(H_formulae)=1635 size(Hxlst2)=29 T(Hmu/Hxlist)=0.00437,0.0336 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0414 S size(H_formulae)=1635 size(Hxlst)=33526 -----
rank=0 GPUmem(GB): used=0.143 (oper,hinter,dvdson,batch)=0.00248,6.17e-05,3.03e-05,0.14 blksize=210 blksize0=140 batchsize=33526
ctns::pdvdsonSolver_nkr::solve_iter ndim=2034 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.72e-05,0.00272,0.039,0.00291,0.0447
 ndim=2034:1.52e-05GB t[comm(intra)]=3.16e-05 speed=0.959GB/S t[comm(inter)]=1.56e-05 speed=1.95GB/S
--- TIMING FOR sigma : t_inter=2.7e-03 t_gemm=3.9e-02 t_reduction=2.9e-03 tot=4.5e-02 ---
 sigma[inter] counter=60 t=2.7e-03 per=6.1e+00 cost=1.7e+07 flops=6.3e+09
 sigma[gemm] counter=60 i=0 t=1.7e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=1 t=1.2e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=2 t=9.6e-03 per=2.2e+01 cost=2.9e+07 flops=3.0e+09
 sigma[gemm] counter=60 i=3 t=7.7e-03 per=1.7e+01 cost=2.8e+07 flops=3.6e+09
 sigma[gemm] counter=60 i=4 t=1.1e-02 per=2.5e+01 cost=1.7e+07 flops=1.6e+09
 sigma[gemm] counter=60 i=5 t=1.1e-02 per=2.4e+01 cost=1.8e+07 flops=1.7e+09
 sigma[gemm] counter=60 total t=3.9e-02 per=8.7e+01 cost=9.2e+07 flops=2.3e+09
 sigma[red] counter=60 t=2.9e-03 per=6.5e+00 cost=5.3e+06 flops=1.8e+09
--- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=3.0e-01 t_reduction=4.3e-02 tot=3.7e-01 ---
 sigma_tot[inter] counter=60 t=2.7e-02 per=7.4e+00 cost=4.5e+08 flops=1.6e+10
 sigma_tot[gemm] counter=60 i=0 t=1.3e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=1 t=9.8e-05 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=2 t=7.7e-02 per=2.1e+01 cost=2.7e+08 flops=3.5e+09
 sigma_tot[gemm] counter=60 i=3 t=7.4e-02 per=2.0e+01 cost=2.7e+08 flops=3.6e+09
 sigma_tot[gemm] counter=60 i=4 t=7.6e-02 per=2.0e+01 cost=2.7e+08 flops=3.5e+09
 sigma_tot[gemm] counter=60 i=5 t=7.5e-02 per=2.0e+01 cost=2.8e+08 flops=3.8e+09
 sigma_tot[gemm] counter=60 total t=3.0e-01 per=8.1e+01 cost=1.1e+09 flops=3.6e+09
 sigma_tot[red] counter=60 t=4.3e-02 per=1.1e+01 cost=8.8e+07 flops=2.1e+09
T(sub)=6.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-05,1.1e-05,2.3e-06,5.1e-06,8.2e-07
settings: ndim=2034 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.494975102556 -1.116e+03  7.506e-02    1     1  4.495e-02 4.495e-02 4.485e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.362e-05,7.408e-04,5.949e-03,9.993e-04,7.746e-03
 ndim=2034:1.515e-05GB t[comm(intra)]=3.742e-05 speed=8.101e-01GB/S t[comm(inter)]=6.202e-06 speed=4.887e+00GB/S
--- TIMING FOR sigma : t_inter=7.4e-04 t_gemm=5.9e-03 t_reduction=1.0e-03 tot=7.7e-03 ---
 sigma[inter] counter=61 t=7.4e-04 per=9.6e+00 cost=1.7e+07 flops=2.3e+10
 sigma[gemm] counter=61 i=0 t=1.7e-06 per=2.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=1 t=1.5e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=2 t=1.5e-03 per=1.9e+01 cost=2.9e+07 flops=2.0e+10
 sigma[gemm] counter=61 i=3 t=1.5e-03 per=2.0e+01 cost=2.8e+07 flops=1.8e+10
 sigma[gemm] counter=61 i=4 t=1.5e-03 per=1.9e+01 cost=1.7e+07 flops=1.2e+10
 sigma[gemm] counter=61 i=5 t=1.5e-03 per=1.9e+01 cost=1.8e+07 flops=1.2e+10
 sigma[gemm] counter=61 total t=5.9e-03 per=7.7e+01 cost=9.2e+07 flops=1.5e+10
 sigma[red] counter=61 t=1.0e-03 per=1.3e+01 cost=5.3e+06 flops=5.3e+09
--- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=3.1e-01 t_reduction=4.4e-02 tot=3.8e-01 ---
 sigma_tot[inter] counter=61 t=2.8e-02 per=7.4e+00 cost=4.7e+08 flops=1.7e+10
 sigma_tot[gemm] counter=61 i=0 t=1.3e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=1 t=1.0e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=2 t=7.8e-02 per=2.1e+01 cost=3.0e+08 flops=3.8e+09
 sigma_tot[gemm] counter=61 i=3 t=7.6e-02 per=2.0e+01 cost=3.0e+08 flops=3.9e+09
 sigma_tot[gemm] counter=61 i=4 t=7.7e-02 per=2.0e+01 cost=2.9e+08 flops=3.7e+09
 sigma_tot[gemm] counter=61 i=5 t=7.6e-02 per=2.0e+01 cost=3.0e+08 flops=3.9e+09
 sigma_tot[gemm] counter=61 total t=3.1e-01 per=8.1e+01 cost=1.2e+09 flops=3.8e+09
 sigma_tot[red] counter=61 t=4.4e-02 per=1.2e+01 cost=9.3e+07 flops=2.1e+09
T(sub)=4.2e-04 T(gemm/eig/ortho/gemm/axpy)=1.4e-04,2.7e-04,4.7e-06,7.4e-06,1.1e-06
    2   0 -    -116.501698136720 -6.723e-03  2.069e-02    2     2  6.245e-02 3.123e-02 2.637e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.265e-05,7.472e-04,5.526e-03,7.624e-04,7.090e-03
 ndim=2034:1.515e-05GB t[comm(intra)]=3.730e-05 speed=8.126e-01GB/S t[comm(inter)]=5.349e-06 speed=5.666e+00GB/S
--- TIMING FOR sigma : t_inter=7.5e-04 t_gemm=5.5e-03 t_reduction=7.6e-04 tot=7.0e-03 ---
 sigma[inter] counter=62 t=7.5e-04 per=1.1e+01 cost=1.7e+07 flops=2.3e+10
 sigma[gemm] counter=62 i=0 t=1.7e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=1 t=1.5e-06 per=2.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=2 t=1.5e-03 per=2.1e+01 cost=2.9e+07 flops=2.0e+10
 sigma[gemm] counter=62 i=3 t=1.5e-03 per=2.1e+01 cost=2.8e+07 flops=1.9e+10
 sigma[gemm] counter=62 i=4 t=1.4e-03 per=2.0e+01 cost=1.7e+07 flops=1.2e+10
 sigma[gemm] counter=62 i=5 t=1.1e-03 per=1.6e+01 cost=1.8e+07 flops=1.5e+10
 sigma[gemm] counter=62 total t=5.5e-03 per=7.9e+01 cost=9.2e+07 flops=1.7e+10
 sigma[red] counter=62 t=7.6e-04 per=1.1e+01 cost=5.3e+06 flops=7.0e+09
--- TIMING FOR sigma_tot : t_inter=2.9e-02 t_gemm=3.1e-01 t_reduction=4.5e-02 tot=3.9e-01 ---
 sigma_tot[inter] counter=62 t=2.9e-02 per=7.5e+00 cost=4.8e+08 flops=1.7e+10
 sigma_tot[gemm] counter=62 i=0 t=1.3e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=1 t=1.0e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=2 t=8.0e-02 per=2.1e+01 cost=3.3e+08 flops=4.1e+09
 sigma_tot[gemm] counter=62 i=3 t=7.7e-02 per=2.0e+01 cost=3.3e+08 flops=4.2e+09
 sigma_tot[gemm] counter=62 i=4 t=7.9e-02 per=2.0e+01 cost=3.0e+08 flops=3.8e+09
 sigma_tot[gemm] counter=62 i=5 t=7.7e-02 per=2.0e+01 cost=3.2e+08 flops=4.1e+09
 sigma_tot[gemm] counter=62 total t=3.1e-01 per=8.1e+01 cost=1.3e+09 flops=4.1e+09
 sigma_tot[red] counter=62 t=4.5e-02 per=1.2e+01 cost=9.8e+07 flops=2.2e+09
T(sub)=6.8e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,3.8e-05,2.9e-06,8.1e-06,8.4e-07
    3   0 -    -116.502414485529 -7.163e-04  8.700e-03    3     3  8.062e-02 2.687e-02 1.997e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.007e-05,7.511e-04,5.511e-03,7.836e-04,7.098e-03
 ndim=2034:1.515e-05GB t[comm(intra)]=3.456e-05 speed=8.771e-01GB/S t[comm(inter)]=5.516e-06 speed=5.495e+00GB/S
--- TIMING FOR sigma : t_inter=7.5e-04 t_gemm=5.5e-03 t_reduction=7.8e-04 tot=7.0e-03 ---
 sigma[inter] counter=63 t=7.5e-04 per=1.1e+01 cost=1.7e+07 flops=2.3e+10
 sigma[gemm] counter=63 i=0 t=1.7e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=1 t=1.5e-06 per=2.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=2 t=1.4e-03 per=2.0e+01 cost=2.9e+07 flops=2.0e+10
 sigma[gemm] counter=63 i=3 t=1.5e-03 per=2.1e+01 cost=2.8e+07 flops=1.8e+10
 sigma[gemm] counter=63 i=4 t=1.4e-03 per=2.0e+01 cost=1.7e+07 flops=1.2e+10
 sigma[gemm] counter=63 i=5 t=1.2e-03 per=1.7e+01 cost=1.8e+07 flops=1.5e+10
 sigma[gemm] counter=63 total t=5.5e-03 per=7.8e+01 cost=9.2e+07 flops=1.7e+10
 sigma[red] counter=63 t=7.8e-04 per=1.1e+01 cost=5.3e+06 flops=6.8e+09
--- TIMING FOR sigma_tot : t_inter=3.0e-02 t_gemm=3.2e-01 t_reduction=4.5e-02 tot=3.9e-01 ---
 sigma_tot[inter] counter=63 t=3.0e-02 per=7.5e+00 cost=5.0e+08 flops=1.7e+10
 sigma_tot[gemm] counter=63 i=0 t=1.4e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=1 t=1.0e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=2 t=8.1e-02 per=2.1e+01 cost=3.6e+08 flops=4.4e+09
 sigma_tot[gemm] counter=63 i=3 t=7.9e-02 per=2.0e+01 cost=3.5e+08 flops=4.5e+09
 sigma_tot[gemm] counter=63 i=4 t=8.0e-02 per=2.0e+01 cost=3.2e+08 flops=4.0e+09
 sigma_tot[gemm] counter=63 i=5 t=7.8e-02 per=2.0e+01 cost=3.3e+08 flops=4.3e+09
 sigma_tot[gemm] counter=63 total t=3.2e-01 per=8.1e+01 cost=1.4e+09 flops=4.3e+09
 sigma_tot[red] counter=63 t=4.5e-02 per=1.2e+01 cost=1.0e+08 flops=2.3e+09
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-05,1.5e-05,2.9e-06,8.1e-06,7.8e-07
    4   0 -    -116.502547877959 -1.334e-04  3.898e-03    3     4  9.832e-02 2.458e-02 1.678e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.983e-05,7.285e-04,5.510e-03,7.772e-04,7.067e-03
 ndim=2034:1.515e-05GB t[comm(intra)]=3.438e-05 speed=8.817e-01GB/S t[comm(inter)]=5.453e-06 speed=5.558e+00GB/S
--- TIMING FOR sigma : t_inter=7.3e-04 t_gemm=5.5e-03 t_reduction=7.8e-04 tot=7.0e-03 ---
 sigma[inter] counter=64 t=7.3e-04 per=1.0e+01 cost=1.7e+07 flops=2.4e+10
 sigma[gemm] counter=64 i=0 t=1.7e-06 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=1 t=1.4e-06 per=2.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=2 t=1.4e-03 per=2.1e+01 cost=2.9e+07 flops=2.0e+10
 sigma[gemm] counter=64 i=3 t=1.5e-03 per=2.1e+01 cost=2.8e+07 flops=1.9e+10
 sigma[gemm] counter=64 i=4 t=1.4e-03 per=2.0e+01 cost=1.7e+07 flops=1.3e+10
 sigma[gemm] counter=64 i=5 t=1.2e-03 per=1.7e+01 cost=1.8e+07 flops=1.5e+10
 sigma[gemm] counter=64 total t=5.5e-03 per=7.9e+01 cost=9.2e+07 flops=1.7e+10
 sigma[red] counter=64 t=7.8e-04 per=1.1e+01 cost=5.3e+06 flops=6.8e+09
--- TIMING FOR sigma_tot : t_inter=3.0e-02 t_gemm=3.2e-01 t_reduction=4.6e-02 tot=4.0e-01 ---
 sigma_tot[inter] counter=64 t=3.0e-02 per=7.6e+00 cost=5.2e+08 flops=1.7e+10
 sigma_tot[gemm] counter=64 i=0 t=1.4e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=1 t=1.0e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=2 t=8.2e-02 per=2.1e+01 cost=3.8e+08 flops=4.7e+09
 sigma_tot[gemm] counter=64 i=3 t=8.0e-02 per=2.0e+01 cost=3.8e+08 flops=4.7e+09
 sigma_tot[gemm] counter=64 i=4 t=8.2e-02 per=2.0e+01 cost=3.4e+08 flops=4.1e+09
 sigma_tot[gemm] counter=64 i=5 t=8.0e-02 per=2.0e+01 cost=3.5e+08 flops=4.4e+09
 sigma_tot[gemm] counter=64 total t=3.2e-01 per=8.1e+01 cost=1.5e+09 flops=4.5e+09
 sigma_tot[red] counter=64 t=4.6e-02 per=1.1e+01 cost=1.1e+08 flops=2.4e+09
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.4e-05,2.8e-06,8.2e-06,7.9e-07
    5   0 -    -116.502572230261 -2.435e-05  1.750e-03    3     5  1.159e-01 2.317e-02 1.486e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.108e-05,7.181e-04,5.477e-03,8.156e-04,7.065e-03
 ndim=2034:1.515e-05GB t[comm(intra)]=3.568e-05 speed=8.495e-01GB/S t[comm(inter)]=5.403e-06 speed=5.610e+00GB/S
--- TIMING FOR sigma : t_inter=7.2e-04 t_gemm=5.5e-03 t_reduction=8.2e-04 tot=7.0e-03 ---
 sigma[inter] counter=65 t=7.2e-04 per=1.0e+01 cost=1.7e+07 flops=2.4e+10
 sigma[gemm] counter=65 i=0 t=1.7e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=1 t=1.5e-06 per=2.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=2 t=1.4e-03 per=2.0e+01 cost=2.9e+07 flops=2.0e+10
 sigma[gemm] counter=65 i=3 t=1.5e-03 per=2.1e+01 cost=2.8e+07 flops=1.9e+10
 sigma[gemm] counter=65 i=4 t=1.4e-03 per=2.0e+01 cost=1.7e+07 flops=1.3e+10
 sigma[gemm] counter=65 i=5 t=1.2e-03 per=1.7e+01 cost=1.8e+07 flops=1.5e+10
 sigma[gemm] counter=65 total t=5.5e-03 per=7.8e+01 cost=9.2e+07 flops=1.7e+10
 sigma[red] counter=65 t=8.2e-04 per=1.2e+01 cost=5.3e+06 flops=6.5e+09
--- TIMING FOR sigma_tot : t_inter=3.1e-02 t_gemm=3.3e-01 t_reduction=4.7e-02 tot=4.1e-01 ---
 sigma_tot[inter] counter=65 t=3.1e-02 per=7.6e+00 cost=5.4e+08 flops=1.7e+10
 sigma_tot[gemm] counter=65 i=0 t=1.4e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=1 t=1.1e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=2 t=8.4e-02 per=2.1e+01 cost=4.1e+08 flops=4.9e+09
 sigma_tot[gemm] counter=65 i=3 t=8.2e-02 per=2.0e+01 cost=4.1e+08 flops=5.0e+09
 sigma_tot[gemm] counter=65 i=4 t=8.3e-02 per=2.0e+01 cost=3.6e+08 flops=4.3e+09
 sigma_tot[gemm] counter=65 i=5 t=8.1e-02 per=2.0e+01 cost=3.7e+08 flops=4.6e+09
 sigma_tot[gemm] counter=65 total t=3.3e-01 per=8.1e+01 cost=1.5e+09 flops=4.7e+09
 sigma_tot[red] counter=65 t=4.7e-02 per=1.1e+01 cost=1.1e+08 flops=2.4e+09
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.4e-05,2.7e-06,8.2e-06,7.8e-07
    6   0 -    -116.502577160404 -4.930e-06  8.021e-04    3     6  1.330e-01 2.217e-02 1.358e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.039e-05,7.217e-04,5.490e-03,7.799e-04,7.043e-03
 ndim=2034:1.515e-05GB t[comm(intra)]=3.504e-05 speed=8.651e-01GB/S t[comm(inter)]=5.348e-06 speed=5.667e+00GB/S
--- TIMING FOR sigma : t_inter=7.2e-04 t_gemm=5.5e-03 t_reduction=7.8e-04 tot=7.0e-03 ---
 sigma[inter] counter=66 t=7.2e-04 per=1.0e+01 cost=1.7e+07 flops=2.4e+10
 sigma[gemm] counter=66 i=0 t=1.7e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=1 t=1.5e-06 per=2.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=2 t=1.4e-03 per=2.1e+01 cost=2.9e+07 flops=2.0e+10
 sigma[gemm] counter=66 i=3 t=1.5e-03 per=2.1e+01 cost=2.8e+07 flops=1.9e+10
 sigma[gemm] counter=66 i=4 t=1.4e-03 per=2.0e+01 cost=1.7e+07 flops=1.3e+10
 sigma[gemm] counter=66 i=5 t=1.2e-03 per=1.7e+01 cost=1.8e+07 flops=1.5e+10
 sigma[gemm] counter=66 total t=5.5e-03 per=7.9e+01 cost=9.2e+07 flops=1.7e+10
 sigma[red] counter=66 t=7.8e-04 per=1.1e+01 cost=5.3e+06 flops=6.8e+09
--- TIMING FOR sigma_tot : t_inter=3.2e-02 t_gemm=3.4e-01 t_reduction=4.8e-02 tot=4.1e-01 ---
 sigma_tot[inter] counter=66 t=3.2e-02 per=7.7e+00 cost=5.5e+08 flops=1.7e+10
 sigma_tot[gemm] counter=66 i=0 t=1.4e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=1 t=1.1e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=2 t=8.5e-02 per=2.1e+01 cost=4.4e+08 flops=5.2e+09
 sigma_tot[gemm] counter=66 i=3 t=8.3e-02 per=2.0e+01 cost=4.4e+08 flops=5.2e+09
 sigma_tot[gemm] counter=66 i=4 t=8.4e-02 per=2.0e+01 cost=3.7e+08 flops=4.4e+09
 sigma_tot[gemm] counter=66 i=5 t=8.2e-02 per=2.0e+01 cost=3.9e+08 flops=4.7e+09
 sigma_tot[gemm] counter=66 total t=3.4e-01 per=8.1e+01 cost=1.6e+09 flops=4.9e+09
 sigma_tot[red] counter=66 t=4.8e-02 per=1.1e+01 cost=1.2e+08 flops=2.5e+09
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-05,1.4e-05,3.0e-06,8.1e-06,7.9e-07
    7   0 -    -116.502578102955 -9.426e-07  3.212e-04    3     7  1.499e-01 2.141e-02 1.266e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.983e-05,7.222e-04,5.500e-03,7.888e-04,7.061e-03
 ndim=2034:1.515e-05GB t[comm(intra)]=3.448e-05 speed=8.789e-01GB/S t[comm(inter)]=5.342e-06 speed=5.674e+00GB/S
--- TIMING FOR sigma : t_inter=7.2e-04 t_gemm=5.5e-03 t_reduction=7.9e-04 tot=7.0e-03 ---
 sigma[inter] counter=67 t=7.2e-04 per=1.0e+01 cost=1.7e+07 flops=2.4e+10
 sigma[gemm] counter=67 i=0 t=1.7e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=1 t=1.5e-06 per=2.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=2 t=1.4e-03 per=2.1e+01 cost=2.9e+07 flops=2.0e+10
 sigma[gemm] counter=67 i=3 t=1.5e-03 per=2.1e+01 cost=2.8e+07 flops=1.9e+10
 sigma[gemm] counter=67 i=4 t=1.4e-03 per=2.0e+01 cost=1.7e+07 flops=1.3e+10
 sigma[gemm] counter=67 i=5 t=1.2e-03 per=1.7e+01 cost=1.8e+07 flops=1.5e+10
 sigma[gemm] counter=67 total t=5.5e-03 per=7.8e+01 cost=9.2e+07 flops=1.7e+10
 sigma[red] counter=67 t=7.9e-04 per=1.1e+01 cost=5.3e+06 flops=6.7e+09
--- TIMING FOR sigma_tot : t_inter=3.3e-02 t_gemm=3.4e-01 t_reduction=4.8e-02 tot=4.2e-01 ---
 sigma_tot[inter] counter=67 t=3.3e-02 per=7.7e+00 cost=5.7e+08 flops=1.7e+10
 sigma_tot[gemm] counter=67 i=0 t=1.4e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=1 t=1.1e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=2 t=8.7e-02 per=2.1e+01 cost=4.7e+08 flops=5.4e+09
 sigma_tot[gemm] counter=67 i=3 t=8.5e-02 per=2.0e+01 cost=4.7e+08 flops=5.5e+09
 sigma_tot[gemm] counter=67 i=4 t=8.6e-02 per=2.0e+01 cost=3.9e+08 flops=4.5e+09
 sigma_tot[gemm] counter=67 i=5 t=8.3e-02 per=2.0e+01 cost=4.0e+08 flops=4.9e+09
 sigma_tot[gemm] counter=67 total t=3.4e-01 per=8.1e+01 cost=1.7e+09 flops=5.1e+09
 sigma_tot[red] counter=67 t=4.8e-02 per=1.1e+01 cost=1.3e+08 flops=2.6e+09
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.4e-05,2.8e-06,8.1e-06,8.0e-07
    8   0 -    -116.502578238721 -1.358e-07  1.127e-04    3     8  1.667e-01 2.084e-02 1.197e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.050e-05,7.475e-04,5.876e-03,9.764e-04,7.642e-03
 ndim=2034:1.515e-05GB t[comm(intra)]=2.488e-05 speed=1.218e+00GB/S t[comm(inter)]=5.615e-06 speed=5.398e+00GB/S
--- TIMING FOR sigma : t_inter=7.5e-04 t_gemm=5.9e-03 t_reduction=9.8e-04 tot=7.6e-03 ---
 sigma[inter] counter=68 t=7.5e-04 per=9.8e+00 cost=1.7e+07 flops=2.3e+10
 sigma[gemm] counter=68 i=0 t=1.7e-06 per=2.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=1 t=1.4e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=2 t=1.4e-03 per=1.9e+01 cost=2.9e+07 flops=2.0e+10
 sigma[gemm] counter=68 i=3 t=1.5e-03 per=2.0e+01 cost=2.8e+07 flops=1.9e+10
 sigma[gemm] counter=68 i=4 t=1.5e-03 per=2.0e+01 cost=1.7e+07 flops=1.2e+10
 sigma[gemm] counter=68 i=5 t=1.4e-03 per=1.9e+01 cost=1.8e+07 flops=1.2e+10
 sigma[gemm] counter=68 total t=5.9e-03 per=7.7e+01 cost=9.2e+07 flops=1.6e+10
 sigma[red] counter=68 t=9.8e-04 per=1.3e+01 cost=5.3e+06 flops=5.4e+09
--- TIMING FOR sigma_tot : t_inter=3.3e-02 t_gemm=3.5e-01 t_reduction=4.9e-02 tot=4.3e-01 ---
 sigma_tot[inter] counter=68 t=3.3e-02 per=7.8e+00 cost=5.9e+08 flops=1.8e+10
 sigma_tot[gemm] counter=68 i=0 t=1.4e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=1 t=1.1e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=2 t=8.8e-02 per=2.1e+01 cost=5.0e+08 flops=5.7e+09
 sigma_tot[gemm] counter=68 i=3 t=8.6e-02 per=2.0e+01 cost=4.9e+08 flops=5.7e+09
 sigma_tot[gemm] counter=68 i=4 t=8.7e-02 per=2.0e+01 cost=4.1e+08 flops=4.7e+09
 sigma_tot[gemm] counter=68 i=5 t=8.5e-02 per=2.0e+01 cost=4.2e+08 flops=5.0e+09
 sigma_tot[gemm] counter=68 total t=3.5e-01 per=8.1e+01 cost=1.8e+09 flops=5.3e+09
 sigma_tot[red] counter=68 t=4.9e-02 per=1.2e+01 cost=1.3e+08 flops=2.6e+09
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,1.6e-05,3.1e-06,8.5e-06,8.1e-07
    9   0 +    -116.502578257621 -1.890e-08  4.041e-05    3     9  1.813e-01 2.015e-02 1.150e-02
TIMING FOR Davidson : 1.813e-01  T(cal/comm/rest)=1.035e-01,1.069e-06,7.780e-02
decomposed t_rest=7.780e-02
 T(sub)    =8.138e-04 per=1.046e+00
 T(precond)=7.668e-02 per=9.856e+01
 T(ortho)  =9.428e-05 per=1.212e-01
 T(xcopy)  =1.553e-05 per=1.996e-02
 T(xnrm2)  =9.490e-06 per=1.220e-02
 T(other)  =1.901e-04 per=2.443e-01
optimized energies: isweep=0 ibond=9 dots=1 e[0]=-116.502578257621 nmvp=9
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.508e+02S Sys:2.690e+00S Total:9.535e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=22 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond9.txt
 qbond: qsuper nsym=22 dimAll=292
 (14,2):26 (16,2):39 (15,3):29 (15,1):39 (17,1):24 (16,0):26 (14,0):16 (15,-1):10 (18,2):8 (17,3):16 (16,4):12 (18,0):6 (17,-1):6 (13,1):9 (13,3):7 (14,4):8 (15,5):4 (12,2):3 (12,0):1 (13,-1):1 (18,4):1 (17,5):1
timing for divide=1.8e-05
timing for compute=4.9e-04
timing for collect=1.9e-05
----- TMING FOR decimation_genbasis(nkr): 5.2e-04 S T(divide/compute/collect)=1.8e-05,4.9e-04,1.9e-05 -----
decimation summary: 292->74 dwt=-2.220e-16 SvN=2.222e+00
 qbond: qkept nsym=9 dimAll=74
 (15,3):15 (15,1):14 (16,2):11 (17,1):10 (17,3):10 (16,4):7 (14,2):5 (13,1):1 (17,5):1
----- TIMING for decimation_row(nkr): 1.254e-03 S T(decim/select/formRot)=6.266e-04,5.931e-04,3.463e-05 -----
----- TIMING FOR onedot_decimation: 1.500e-03 S T(wf/decim)=2.278e-04,1.273e-03 -----
ctns::oper_renorm coord=(10,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:22 S:18 H:1 P:153 Q:171 
        dim(bra,ket)=74,74 size(op)=818:6.241e-03MB size(tot)=165874:1.266e+00MB:1.236e-03GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.509e+02S Sys:2.690e+00S Total:9.535e+02S
----- TIMING FOR symbolic_formulae_renorm with size=365 : 2.674e-02 S -----
rank=0 GPUmem(GB): used=0.00254 (oper)=0.00248
rank=0 GPUmem(GB): used=0.00255 (oper,site)(GB)=0.00248,1.52e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=828
 no. of coefficients=8280:0.0632MB:6.17e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.193e-03 S -----
rank=0 GPUmem(GB): used=0.00262 (oper,site,rinter)=0.00248,1.52e-05,6.17e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0217 S size(rtasks)=365 size(Rlst2)=81 T(Rmu/Rlist)=0.00472,0.017 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0233 S size(rtasks)=365 size(Rlst)=17092 -----
rank=0 GPUmem(GB): used=0.00262 (oper,site,rinter,batch)=0.00248,1.52e-05,6.17e-05,0.0753 blksize=225 blksize0=140 batchsize=17092
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00138,0.0248,0.00415
--- TIMING FOR renorm : t_inter=1.4e-03 t_gemm=2.5e-02 t_reduction=4.1e-03 tot=3.0e-02 ---
 renorm[inter] counter=10 t=1.4e-03 per=4.5e+00 cost=8.6e+06 flops=6.3e+09
 renorm[gemm] counter=10 i=0 t=1.3e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=1 t=1.1e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=2 t=1.1e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=3 t=1.1e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=4 t=6.4e-03 per=2.1e+01 cost=7.1e+06 flops=1.1e+09
 renorm[gemm] counter=10 i=5 t=9.3e-03 per=3.1e+01 cost=1.1e+07 flops=1.2e+09
 renorm[gemm] counter=10 i=6 t=9.1e-03 per=3.0e+01 cost=3.0e+07 flops=3.3e+09
 renorm[gemm] counter=10 total t=2.5e-02 per=8.2e+01 cost=4.8e+07 flops=1.9e+09
 renorm[red] counter=10 t=4.1e-03 per=1.4e+01 cost=3.6e+06 flops=8.7e+08
--- TIMING FOR renorm_tot : t_inter=6.7e-03 t_gemm=7.2e-02 t_reduction=1.6e-02 tot=9.5e-02 ---
 renorm_tot[inter] counter=10 t=6.7e-03 per=7.1e+00 cost=3.4e+07 flops=5.1e+09
 renorm_tot[gemm] counter=10 i=0 t=1.4e-05 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=1 t=1.2e-05 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=2 t=1.2e-05 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=3 t=1.2e-05 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=4 t=1.9e-02 per=2.0e+01 cost=1.1e+07 flops=5.9e+08
 renorm_tot[gemm] counter=10 i=5 t=2.6e-02 per=2.7e+01 cost=2.5e+07 flops=9.7e+08
 renorm_tot[gemm] counter=10 i=6 t=2.7e-02 per=2.9e+01 cost=5.3e+07 flops=1.9e+09
 renorm_tot[gemm] counter=10 total t=7.2e-02 per=7.6e+01 cost=8.9e+07 flops=1.2e+09
 renorm_tot[red] counter=10 t=1.6e-02 per=1.7e+01 cost=7.6e+06 flops=4.8e+08
qops.to_cpu: size(tot)=165874:1.3e+00MB:1.2e-03GB t[to_cpu]=6.1e-04S speed=2.0e+00GB/S
check ||H-H.dagger||=4.494e-14 coord=(10,0) rank=0
ctns::oper_ab2pq coord=(10,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.39 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.510e+02S Sys:2.692e+00S Total:9.537e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=2137:1.630e-02MB:1.592e-05GB
total mem of comb=17304:1.320e-01MB:1.289e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.510e+02S Sys:2.694e+00S Total:9.537e+02S
##### local opt: 8.997e-01 S #####
 T(local opt: fetch) = 1.537e-02 S  per = 1.71  per(accum) = 1.71
 T(local opt: hdiag) = 4.989e-03 S  per = 0.555  per(accum) = 2.26
 T(local opt: dvdsn) = 4.810e-01 S  per = 53.5  per(accum) = 55.7
 T(local opt: decim) = 1.511e-03 S  per = 0.168  per(accum) = 55.9
 T(local opt: guess) = 2.865e-04 S  per = 0.0318  per(accum) = 55.9
 T(local opt: renrm) = 3.916e-01 S  per = 43.5  per(accum) = 99.5
 T(local opt: save ) = 4.904e-03 S  per = 0.545  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.810e-01 S  T(sum) = 4.803e-01 S  per = 9.986e+01
 T(local opt: preprocess                  ) = 5.896e-04 S  per = 0.123  per(accum) = 0.123
 T(local opt: symbolic_formulae           ) = 2.998e-02 S  per = 6.24  per(accum) = 6.36
 T(local opt: hintermediate init          ) = 7.323e-04 S  per = 0.152  per(accum) = 6.52
 T(local opt: preprocess_hformulae_Hxlist ) = 4.242e-02 S  per = 8.83  per(accum) = 15.3
 T(local opt: hmmtasks init               ) = 2.253e-01 S  per = 46.9  per(accum) = 62.2
 T(local opt: initial guess for dvdson    ) = 2.778e-05 S  per = 0.00578  per(accum) = 62.2
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.032e-01 S  per = 21.5  per(accum) = 83.7
 T(local opt: dvdson solver [comm(gpu)]   ) = 3.651e-04 S  per = 0.076  per(accum) = 83.8
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.069e-06 S  per = 0.000223  per(accum) = 83.8
 T(local opt: dvdson solver [rest part]   ) = 7.780e-02 S  per = 16.2  per(accum) = 100
Detailed decomposition of T(renrm) = 3.916e-01 S  T(sum) = 3.916e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.442e-04 S  per = 0.113  per(accum) = 0.113
 T(local opt: qops init                    ) = 4.121e-03 S  per = 1.05  per(accum) = 1.17
 T(local opt: symbolic_formulae_renorm     ) = 2.676e-02 S  per = 6.83  per(accum) = 8
 T(local opt: allocate qops on gpu         ) = 5.000e-04 S  per = 0.128  per(accum) = 8.13
 T(local opt: site memcpy cpu2gpu          ) = 2.286e-05 S  per = 0.00584  per(accum) = 8.13
 T(local opt: rintermediate init           ) = 1.206e-03 S  per = 0.308  per(accum) = 8.44
 T(local opt: preprocess_formulae_Rlist2   ) = 2.380e-02 S  per = 6.08  per(accum) = 14.5
 T(local opt: rmmtasks init                ) = 1.076e-01 S  per = 27.5  per(accum) = 42
 T(local opt: qops memset on cpu           ) = 7.400e-08 S  per = 1.89e-05  per(accum) = 42
 T(local opt: preprocess_renorm_batchGPU   ) = 3.042e-02 S  per = 7.77  per(accum) = 49.8
 T(local opt: reduction of opS & opH [nccl]) = 1.161e-06 S  per = 0.000296  per(accum) = 49.8
 T(local opt: qops memcpy gpu2cpu          ) = 6.216e-04 S  per = 0.159  per(accum) = 49.9
 T(local opt: deallocate cpu and gpu memory) = 1.945e-01 S  per = 49.7  per(accum) = 99.6
 T(local opt: reduction of opS & opH [comm]) = 6.152e-05 S  per = 0.0157  per(accum) = 99.6
 T(local opt: conversion from opAB to opPQ ) = 1.756e-05 S  per = 0.00448  per(accum) = 99.6
 T(local opt: after oper_renorm            ) = 1.554e-03 S  per = 0.397  per(accum) = 100
##### sweep opt: 8.113e+00 S #####
 T(sweep opt: fetch) = 1.308e-01 S  per = 1.61  per(accum) = 1.61
 T(sweep opt: hdiag) = 2.304e-02 S  per = 0.284  per(accum) = 1.9
 T(sweep opt: dvdsn) = 3.082e+00 S  per =   38  per(accum) = 39.9
 T(sweep opt: decim) = 1.231e-02 S  per = 0.152  per(accum) = 40
 T(sweep opt: guess) = 3.194e-03 S  per = 0.0394  per(accum) = 40.1
 T(sweep opt: renrm) = 4.835e+00 S  per = 59.6  per(accum) = 99.7
 T(sweep opt: save ) = 2.657e-02 S  per = 0.328  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.082e+00 S  T(sum) = 2.804e+00 S  per = 9.098e+01
 T(sweep opt: preprocess                  ) = 4.781e-03 S  per = 0.17  per(accum) = 0.17
 T(sweep opt: symbolic_formulae           ) = 1.459e-01 S  per =  5.2  per(accum) = 5.37
 T(sweep opt: hintermediate init          ) = 3.479e-03 S  per = 0.124  per(accum) = 5.5
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.001e-01 S  per = 7.14  per(accum) = 12.6
 T(sweep opt: hmmtasks init               ) = 1.566e+00 S  per = 55.8  per(accum) = 68.5
 T(sweep opt: initial guess for dvdson    ) = 8.889e-05 S  per = 0.00317  per(accum) = 68.5
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 4.388e-01 S  per = 15.6  per(accum) = 84.1
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.323e-03 S  per = 0.0828  per(accum) = 84.2
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 8.767e-06 S  per = 0.000313  per(accum) = 84.2
 T(sweep opt: dvdson solver [rest part]   ) = 4.428e-01 S  per = 15.8  per(accum) = 100
Detailed decomposition of T(renrm) = 4.835e+00 S  T(sum) = 4.835e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.888e-03 S  per = 0.101  per(accum) = 0.101
 T(sweep opt: qops init                    ) = 4.328e-02 S  per = 0.895  per(accum) = 0.996
 T(sweep opt: symbolic_formulae_renorm     ) = 1.059e-01 S  per = 2.19  per(accum) = 3.19
 T(sweep opt: allocate qops on gpu         ) = 9.230e-04 S  per = 0.0191  per(accum) = 3.21
 T(sweep opt: site memcpy cpu2gpu          ) = 2.196e-04 S  per = 0.00454  per(accum) = 3.21
 T(sweep opt: rintermediate init           ) = 4.939e-03 S  per = 0.102  per(accum) = 3.31
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.094e-01 S  per = 2.26  per(accum) = 5.58
 T(sweep opt: rmmtasks init                ) = 4.453e-01 S  per = 9.21  per(accum) = 14.8
 T(sweep opt: qops memset on cpu           ) = 5.870e-07 S  per = 1.21e-05  per(accum) = 14.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 9.591e-02 S  per = 1.98  per(accum) = 16.8
 T(sweep opt: reduction of opS & opH [nccl]) = 1.079e-05 S  per = 0.000223  per(accum) = 16.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.638e-03 S  per = 0.0339  per(accum) = 16.8
 T(sweep opt: deallocate cpu and gpu memory) = 1.958e-01 S  per = 4.05  per(accum) = 20.9
 T(sweep opt: reduction of opS & opH [comm]) = 4.401e-04 S  per = 0.0091  per(accum) = 20.9
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per =   79  per(accum) = 99.9
 T(sweep opt: after oper_renorm            ) = 7.046e-03 S  per = 0.146  per(accum) = 100
##### global opt: 8.113e+00 S #####
 T(global opt: fetch) = 1.308e-01 S  per = 1.61  per(accum) = 1.61
 T(global opt: hdiag) = 2.304e-02 S  per = 0.284  per(accum) = 1.9
 T(global opt: dvdsn) = 3.082e+00 S  per =   38  per(accum) = 39.9
 T(global opt: decim) = 1.231e-02 S  per = 0.152  per(accum) = 40
 T(global opt: guess) = 3.194e-03 S  per = 0.0394  per(accum) = 40.1
 T(global opt: renrm) = 4.835e+00 S  per = 59.6  per(accum) = 99.7
 T(global opt: save ) = 2.657e-02 S  per = 0.328  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.082e+00 S  T(sum) = 2.804e+00 S  per = 9.098e+01
 T(global opt: preprocess                  ) = 4.781e-03 S  per = 0.17  per(accum) = 0.17
 T(global opt: symbolic_formulae           ) = 1.459e-01 S  per =  5.2  per(accum) = 5.37
 T(global opt: hintermediate init          ) = 3.479e-03 S  per = 0.124  per(accum) = 5.5
 T(global opt: preprocess_hformulae_Hxlist ) = 2.001e-01 S  per = 7.14  per(accum) = 12.6
 T(global opt: hmmtasks init               ) = 1.566e+00 S  per = 55.8  per(accum) = 68.5
 T(global opt: initial guess for dvdson    ) = 8.889e-05 S  per = 0.00317  per(accum) = 68.5
 T(global opt: dvdson solver [Hx_batchGPU] ) = 4.388e-01 S  per = 15.6  per(accum) = 84.1
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.323e-03 S  per = 0.0828  per(accum) = 84.2
 T(global opt: dvdson solver [comm(cpu)]   ) = 8.767e-06 S  per = 0.000313  per(accum) = 84.2
 T(global opt: dvdson solver [rest part]   ) = 4.428e-01 S  per = 15.8  per(accum) = 100
Detailed decomposition of T(renrm) = 4.835e+00 S  T(sum) = 4.835e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.888e-03 S  per = 0.101  per(accum) = 0.101
 T(global opt: qops init                    ) = 4.328e-02 S  per = 0.895  per(accum) = 0.996
 T(global opt: symbolic_formulae_renorm     ) = 1.059e-01 S  per = 2.19  per(accum) = 3.19
 T(global opt: allocate qops on gpu         ) = 9.230e-04 S  per = 0.0191  per(accum) = 3.21
 T(global opt: site memcpy cpu2gpu          ) = 2.196e-04 S  per = 0.00454  per(accum) = 3.21
 T(global opt: rintermediate init           ) = 4.939e-03 S  per = 0.102  per(accum) = 3.31
 T(global opt: preprocess_formulae_Rlist2   ) = 1.094e-01 S  per = 2.26  per(accum) = 5.58
 T(global opt: rmmtasks init                ) = 4.453e-01 S  per = 9.21  per(accum) = 14.8
 T(global opt: qops memset on cpu           ) = 5.870e-07 S  per = 1.21e-05  per(accum) = 14.8
 T(global opt: preprocess_renorm_batchGPU   ) = 9.591e-02 S  per = 1.98  per(accum) = 16.8
 T(global opt: reduction of opS & opH [nccl]) = 1.079e-05 S  per = 0.000223  per(accum) = 16.8
 T(global opt: qops memcpy gpu2cpu          ) = 1.638e-03 S  per = 0.0339  per(accum) = 16.8
 T(global opt: deallocate cpu and gpu memory) = 1.958e-01 S  per = 4.05  per(accum) = 20.9
 T(global opt: reduction of opS & opH [comm]) = 4.401e-04 S  per = 0.0091  per(accum) = 20.9
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per =   79  per(accum) = 99.9
 T(global opt: after oper_renorm            ) = 7.046e-03 S  per = 0.146  per(accum) = 100

isweep=0 ibond=10/seqsize=34 dots=1 dbond=(11,0)-(12,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.510e+02S Sys:2.695e+00S Total:9.537e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=2137:1.630e-02MB:1.592e-05GB
total mem of comb=17304:1.320e-01MB:1.289e-04GB
ctns::topology::check_partition: (sl,sr,sc)=11,8,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc= 7
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:22 S:18 H:1 P:153 Q:171 
        dim(bra,ket)=74,74 size(op)=818:6.241e-03MB size(tot)=165874:1.266e+00MB:1.236e-03GB
 rqops: oplist=CSHAB nops=C:16 S:24 H:1 A:120 B:136 
        dim(bra,ket)=77,77 size(op)=845:6.447e-03MB size(tot)=142381:1.086e+00MB:1.061e-03GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=310591:2.370e+00MB:2.314e-03GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(11,0) fdel=./scratch/sweep/rop(12,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
wf3(diml,dimr,dimc)=(74,77,4) nnz=2137:1.630e-02MB
qtensor3: wf3 own=1 _data=0x53036350
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=74
 (15,3):15 (15,1):14 (16,2):11 (17,1):10 (17,3):10 (16,4):7 (14,2):5 (13,1):1 (17,5):1
 qbond: qcol nsym=9 dimAll=77
 (13,-1):15 (13,-3):15 (11,-3):10 (11,-1):10 (12,-2):10 (12,-4):7 (14,-2):6 (15,-1):3 (11,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=23 nblocks=324 size=2137:1.630e-02MB
### DIAG TIMING: total=4.802e-03 t1=2.076e-05, t2=2.892e-05, t3=6.271e-05, t4=4.655e-03, t5=9.328e-06, t6=1.995e-05, t7=5.149e-06
duration_diagGPU:4.820e-03
duration_diagreduce:9.000e-08
duration_diagtransform:1.085e-05
----- TIMING FOR symbolic_formulae_onedot with size=1327 : 3.701e-02 S -----
rank=0 GPUmem(GB): used=0.00231 (oper)=0.00231
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1327
 no. of hintermediate operators=664
 no. of coefficients=7304:0.0557MB:5.44e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.820e-04 S -----
rank=0 GPUmem(GB): used=0.00237 (oper,hinter)=0.00231,5.44e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0296 S size(H_formulae)=1327 size(Hxlst2)=23 T(Hmu/Hxlist)=0.00464,0.0249 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0316 S size(H_formulae)=1327 size(Hxlst)=19374 -----
rank=0 GPUmem(GB): used=0.0913 (oper,hinter,dvdson,batch)=0.00231,5.44e-05,3.18e-05,0.0889 blksize=225 blksize0=165 batchsize=19374
ctns::pdvdsonSolver_nkr::solve_iter ndim=2137 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.68e-05,0.000989,0.0239,0.00209,0.027
 ndim=2137:1.59e-05GB t[comm(intra)]=3.04e-05 speed=1.05GB/S t[comm(inter)]=6.41e-06 speed=4.97GB/S
--- TIMING FOR sigma : t_inter=9.9e-04 t_gemm=2.4e-02 t_reduction=2.1e-03 tot=2.7e-02 ---
 sigma[inter] counter=69 t=9.9e-04 per=3.7e+00 cost=1.7e+07 flops=1.7e+10
 sigma[gemm] counter=69 i=0 t=1.4e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=1 t=1.1e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=2 t=5.4e-03 per=2.0e+01 cost=2.1e+07 flops=3.9e+09
 sigma[gemm] counter=69 i=3 t=5.5e-03 per=2.0e+01 cost=2.1e+07 flops=3.8e+09
 sigma[gemm] counter=69 i=4 t=6.8e-03 per=2.5e+01 cost=1.6e+07 flops=2.4e+09
 sigma[gemm] counter=69 i=5 t=6.3e-03 per=2.3e+01 cost=1.7e+07 flops=2.6e+09
 sigma[gemm] counter=69 total t=2.4e-02 per=8.9e+01 cost=7.5e+07 flops=3.1e+09
 sigma[red] counter=69 t=2.1e-03 per=7.7e+00 cost=3.9e+06 flops=1.9e+09
--- TIMING FOR sigma_tot : t_inter=3.4e-02 t_gemm=3.7e-01 t_reduction=5.2e-02 tot=4.6e-01 ---
 sigma_tot[inter] counter=69 t=3.4e-02 per=7.5e+00 cost=6.0e+08 flops=1.8e+10
 sigma_tot[gemm] counter=69 i=0 t=1.5e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=1 t=1.1e-04 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=2 t=9.4e-02 per=2.0e+01 cost=5.2e+08 flops=5.6e+09
 sigma_tot[gemm] counter=69 i=3 t=9.2e-02 per=2.0e+01 cost=5.1e+08 flops=5.6e+09
 sigma_tot[gemm] counter=69 i=4 t=9.4e-02 per=2.1e+01 cost=4.2e+08 flops=4.5e+09
 sigma_tot[gemm] counter=69 i=5 t=9.1e-02 per=2.0e+01 cost=4.4e+08 flops=4.8e+09
 sigma_tot[gemm] counter=69 total t=3.7e-01 per=8.1e+01 cost=1.9e+09 flops=5.1e+09
 sigma_tot[red] counter=69 t=5.2e-02 per=1.1e+01 cost=1.3e+08 flops=2.6e+09
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.0e-05,5.7e-06,2.1e-06,3.5e-06,8.6e-07
settings: ndim=2137 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.502578257621 -1.117e+03  9.975e-02    1     1  2.717e-02 2.717e-02 2.713e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=9.076e-05,5.089e-04,3.541e-03,6.690e-04,4.882e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=8.275e-05 speed=3.848e-01GB/S t[comm(inter)]=8.005e-06 speed=3.978e+00GB/S
--- TIMING FOR sigma : t_inter=5.1e-04 t_gemm=3.5e-03 t_reduction=6.7e-04 tot=4.7e-03 ---
 sigma[inter] counter=70 t=5.1e-04 per=1.1e+01 cost=1.7e+07 flops=3.4e+10
 sigma[gemm] counter=70 i=0 t=2.1e-06 per=4.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=1 t=1.7e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=2 t=8.9e-04 per=1.9e+01 cost=2.1e+07 flops=2.4e+10
 sigma[gemm] counter=70 i=3 t=8.4e-04 per=1.8e+01 cost=2.1e+07 flops=2.5e+10
 sigma[gemm] counter=70 i=4 t=9.3e-04 per=2.0e+01 cost=1.6e+07 flops=1.7e+10
 sigma[gemm] counter=70 i=5 t=8.8e-04 per=1.9e+01 cost=1.7e+07 flops=1.9e+10
 sigma[gemm] counter=70 total t=3.5e-03 per=7.5e+01 cost=7.5e+07 flops=2.1e+10
 sigma[red] counter=70 t=6.7e-04 per=1.4e+01 cost=3.9e+06 flops=5.9e+09
--- TIMING FOR sigma_tot : t_inter=3.5e-02 t_gemm=3.7e-01 t_reduction=5.2e-02 tot=4.6e-01 ---
 sigma_tot[inter] counter=70 t=3.5e-02 per=7.5e+00 cost=6.2e+08 flops=1.8e+10
 sigma_tot[gemm] counter=70 i=0 t=1.5e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=1 t=1.1e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=2 t=9.4e-02 per=2.0e+01 cost=5.4e+08 flops=5.7e+09
 sigma_tot[gemm] counter=70 i=3 t=9.3e-02 per=2.0e+01 cost=5.3e+08 flops=5.8e+09
 sigma_tot[gemm] counter=70 i=4 t=9.5e-02 per=2.1e+01 cost=4.4e+08 flops=4.6e+09
 sigma_tot[gemm] counter=70 i=5 t=9.2e-02 per=2.0e+01 cost=4.5e+08 flops=5.0e+09
 sigma_tot[gemm] counter=70 total t=3.7e-01 per=8.1e+01 cost=2.0e+09 flops=5.3e+09
 sigma_tot[red] counter=70 t=5.2e-02 per=1.1e+01 cost=1.4e+08 flops=2.6e+09
T(sub)=6.2e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-05,2.9e-05,4.2e-06,6.9e-06,1.1e-06
    2   0 -    -116.514048981085 -1.147e-02  3.546e-02    2     2  4.334e-02 2.167e-02 1.607e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.349e-05,4.750e-04,3.506e-03,6.841e-04,4.721e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=3.777e-05 speed=8.431e-01GB/S t[comm(inter)]=5.721e-06 speed=5.566e+00GB/S
--- TIMING FOR sigma : t_inter=4.7e-04 t_gemm=3.5e-03 t_reduction=6.8e-04 tot=4.7e-03 ---
 sigma[inter] counter=71 t=4.7e-04 per=1.0e+01 cost=1.7e+07 flops=3.6e+10
 sigma[gemm] counter=71 i=0 t=1.9e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=1 t=1.7e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=2 t=8.7e-04 per=1.9e+01 cost=2.1e+07 flops=2.4e+10
 sigma[gemm] counter=71 i=3 t=8.2e-04 per=1.8e+01 cost=2.1e+07 flops=2.5e+10
 sigma[gemm] counter=71 i=4 t=9.2e-04 per=2.0e+01 cost=1.6e+07 flops=1.8e+10
 sigma[gemm] counter=71 i=5 t=8.8e-04 per=1.9e+01 cost=1.7e+07 flops=1.9e+10
 sigma[gemm] counter=71 total t=3.5e-03 per=7.5e+01 cost=7.5e+07 flops=2.1e+10
 sigma[red] counter=71 t=6.8e-04 per=1.5e+01 cost=3.9e+06 flops=5.7e+09
--- TIMING FOR sigma_tot : t_inter=3.5e-02 t_gemm=3.8e-01 t_reduction=5.3e-02 tot=4.7e-01 ---
 sigma_tot[inter] counter=71 t=3.5e-02 per=7.6e+00 cost=6.4e+08 flops=1.8e+10
 sigma_tot[gemm] counter=71 i=0 t=1.5e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=1 t=1.1e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=2 t=9.5e-02 per=2.0e+01 cost=5.6e+08 flops=5.9e+09
 sigma_tot[gemm] counter=71 i=3 t=9.4e-02 per=2.0e+01 cost=5.6e+08 flops=5.9e+09
 sigma_tot[gemm] counter=71 i=4 t=9.6e-02 per=2.1e+01 cost=4.6e+08 flops=4.8e+09
 sigma_tot[gemm] counter=71 i=5 t=9.3e-02 per=2.0e+01 cost=4.7e+08 flops=5.1e+09
 sigma_tot[gemm] counter=71 total t=3.8e-01 per=8.1e+01 cost=2.0e+09 flops=5.4e+09
 sigma_tot[red] counter=71 t=5.3e-02 per=1.1e+01 cost=1.4e+08 flops=2.7e+09
T(sub)=6.7e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-05,3.1e-05,3.3e-06,1.0e-05,1.1e-06
    3   0 -    -116.516202199009 -2.153e-03  1.829e-02    3     3  5.882e-02 1.961e-02 1.233e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.107e-05,4.595e-04,3.487e-03,6.493e-04,4.648e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=3.563e-05 speed=8.936e-01GB/S t[comm(inter)]=5.440e-06 speed=5.854e+00GB/S
--- TIMING FOR sigma : t_inter=4.6e-04 t_gemm=3.5e-03 t_reduction=6.5e-04 tot=4.6e-03 ---
 sigma[inter] counter=72 t=4.6e-04 per=1.0e+01 cost=1.7e+07 flops=3.7e+10
 sigma[gemm] counter=72 i=0 t=2.0e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=1 t=1.7e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=2 t=8.7e-04 per=1.9e+01 cost=2.1e+07 flops=2.4e+10
 sigma[gemm] counter=72 i=3 t=8.4e-04 per=1.8e+01 cost=2.1e+07 flops=2.5e+10
 sigma[gemm] counter=72 i=4 t=9.0e-04 per=2.0e+01 cost=1.6e+07 flops=1.8e+10
 sigma[gemm] counter=72 i=5 t=8.7e-04 per=1.9e+01 cost=1.7e+07 flops=1.9e+10
 sigma[gemm] counter=72 total t=3.5e-03 per=7.6e+01 cost=7.5e+07 flops=2.1e+10
 sigma[red] counter=72 t=6.5e-04 per=1.4e+01 cost=3.9e+06 flops=6.1e+09
--- TIMING FOR sigma_tot : t_inter=3.6e-02 t_gemm=3.8e-01 t_reduction=5.4e-02 tot=4.7e-01 ---
 sigma_tot[inter] counter=72 t=3.6e-02 per=7.6e+00 cost=6.6e+08 flops=1.8e+10
 sigma_tot[gemm] counter=72 i=0 t=1.5e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=1 t=1.2e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=2 t=9.6e-02 per=2.0e+01 cost=5.8e+08 flops=6.1e+09
 sigma_tot[gemm] counter=72 i=3 t=9.4e-02 per=2.0e+01 cost=5.8e+08 flops=6.1e+09
 sigma_tot[gemm] counter=72 i=4 t=9.7e-02 per=2.1e+01 cost=4.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=72 i=5 t=9.3e-02 per=2.0e+01 cost=4.9e+08 flops=5.2e+09
 sigma_tot[gemm] counter=72 total t=3.8e-01 per=8.1e+01 cost=2.1e+09 flops=5.6e+09
 sigma_tot[red] counter=72 t=5.4e-02 per=1.1e+01 cost=1.5e+08 flops=2.7e+09
T(sub)=6.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,2.6e-05,3.5e-06,1.0e-05,1.1e-06
    4   0 -    -116.516820532729 -6.183e-04  9.616e-03    3     4  7.310e-02 1.827e-02 1.044e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.151e-05,4.550e-04,3.514e-03,6.497e-04,4.671e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=3.635e-05 speed=8.760e-01GB/S t[comm(inter)]=5.160e-06 speed=6.171e+00GB/S
--- TIMING FOR sigma : t_inter=4.5e-04 t_gemm=3.5e-03 t_reduction=6.5e-04 tot=4.6e-03 ---
 sigma[inter] counter=73 t=4.5e-04 per=9.8e+00 cost=1.7e+07 flops=3.7e+10
 sigma[gemm] counter=73 i=0 t=2.0e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=1 t=1.7e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=2 t=8.8e-04 per=1.9e+01 cost=2.1e+07 flops=2.4e+10
 sigma[gemm] counter=73 i=3 t=8.4e-04 per=1.8e+01 cost=2.1e+07 flops=2.5e+10
 sigma[gemm] counter=73 i=4 t=9.2e-04 per=2.0e+01 cost=1.6e+07 flops=1.8e+10
 sigma[gemm] counter=73 i=5 t=8.6e-04 per=1.9e+01 cost=1.7e+07 flops=1.9e+10
 sigma[gemm] counter=73 total t=3.5e-03 per=7.6e+01 cost=7.5e+07 flops=2.1e+10
 sigma[red] counter=73 t=6.5e-04 per=1.4e+01 cost=3.9e+06 flops=6.0e+09
--- TIMING FOR sigma_tot : t_inter=3.6e-02 t_gemm=3.8e-01 t_reduction=5.4e-02 tot=4.8e-01 ---
 sigma_tot[inter] counter=73 t=3.6e-02 per=7.6e+00 cost=6.7e+08 flops=1.9e+10
 sigma_tot[gemm] counter=73 i=0 t=1.5e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=1 t=1.2e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=2 t=9.7e-02 per=2.0e+01 cost=6.0e+08 flops=6.2e+09
 sigma_tot[gemm] counter=73 i=3 t=9.5e-02 per=2.0e+01 cost=6.0e+08 flops=6.3e+09
 sigma_tot[gemm] counter=73 i=4 t=9.8e-02 per=2.1e+01 cost=4.9e+08 flops=5.0e+09
 sigma_tot[gemm] counter=73 i=5 t=9.4e-02 per=2.0e+01 cost=5.0e+08 flops=5.3e+09
 sigma_tot[gemm] counter=73 total t=3.8e-01 per=8.1e+01 cost=2.2e+09 flops=5.7e+09
 sigma_tot[red] counter=73 t=5.4e-02 per=1.1e+01 cost=1.5e+08 flops=2.8e+09
T(sub)=6.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,2.5e-05,3.5e-06,1.0e-05,1.1e-06
    5   0 -    -116.516973806603 -1.533e-04  4.306e-03    3     5  8.740e-02 1.748e-02 9.314e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.171e-05,4.500e-04,3.513e-03,6.607e-04,4.676e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=3.627e-05 speed=8.780e-01GB/S t[comm(inter)]=5.435e-06 speed=5.859e+00GB/S
--- TIMING FOR sigma : t_inter=4.5e-04 t_gemm=3.5e-03 t_reduction=6.6e-04 tot=4.6e-03 ---
 sigma[inter] counter=74 t=4.5e-04 per=9.7e+00 cost=1.7e+07 flops=3.8e+10
 sigma[gemm] counter=74 i=0 t=2.0e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=1 t=1.7e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=2 t=9.2e-04 per=2.0e+01 cost=2.1e+07 flops=2.3e+10
 sigma[gemm] counter=74 i=3 t=8.3e-04 per=1.8e+01 cost=2.1e+07 flops=2.5e+10
 sigma[gemm] counter=74 i=4 t=9.0e-04 per=2.0e+01 cost=1.6e+07 flops=1.8e+10
 sigma[gemm] counter=74 i=5 t=8.5e-04 per=1.8e+01 cost=1.7e+07 flops=1.9e+10
 sigma[gemm] counter=74 total t=3.5e-03 per=7.6e+01 cost=7.5e+07 flops=2.1e+10
 sigma[red] counter=74 t=6.6e-04 per=1.4e+01 cost=3.9e+06 flops=5.9e+09
--- TIMING FOR sigma_tot : t_inter=3.7e-02 t_gemm=3.9e-01 t_reduction=5.5e-02 tot=4.8e-01 ---
 sigma_tot[inter] counter=74 t=3.7e-02 per=7.6e+00 cost=6.9e+08 flops=1.9e+10
 sigma_tot[gemm] counter=74 i=0 t=1.6e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=1 t=1.2e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=2 t=9.8e-02 per=2.0e+01 cost=6.3e+08 flops=6.4e+09
 sigma_tot[gemm] counter=74 i=3 t=9.6e-02 per=2.0e+01 cost=6.2e+08 flops=6.4e+09
 sigma_tot[gemm] counter=74 i=4 t=9.9e-02 per=2.1e+01 cost=5.1e+08 flops=5.1e+09
 sigma_tot[gemm] counter=74 i=5 t=9.5e-02 per=2.0e+01 cost=5.2e+08 flops=5.5e+09
 sigma_tot[gemm] counter=74 total t=3.9e-01 per=8.1e+01 cost=2.3e+09 flops=5.8e+09
 sigma_tot[red] counter=74 t=5.5e-02 per=1.1e+01 cost=1.5e+08 flops=2.8e+09
T(sub)=6.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-05,2.5e-05,3.6e-06,1.0e-05,1.1e-06
    6   0 -    -116.516999924279 -2.612e-05  1.557e-03    3     6  1.017e-01 1.695e-02 8.562e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.209e-05,4.397e-04,3.502e-03,6.677e-04,4.661e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=3.665e-05 speed=8.689e-01GB/S t[comm(inter)]=5.435e-06 speed=5.859e+00GB/S
--- TIMING FOR sigma : t_inter=4.4e-04 t_gemm=3.5e-03 t_reduction=6.7e-04 tot=4.6e-03 ---
 sigma[inter] counter=75 t=4.4e-04 per=9.5e+00 cost=1.7e+07 flops=3.9e+10
 sigma[gemm] counter=75 i=0 t=2.0e-06 per=4.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=1 t=1.7e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=2 t=9.2e-04 per=2.0e+01 cost=2.1e+07 flops=2.3e+10
 sigma[gemm] counter=75 i=3 t=8.4e-04 per=1.8e+01 cost=2.1e+07 flops=2.5e+10
 sigma[gemm] counter=75 i=4 t=8.9e-04 per=1.9e+01 cost=1.6e+07 flops=1.8e+10
 sigma[gemm] counter=75 i=5 t=8.5e-04 per=1.8e+01 cost=1.7e+07 flops=1.9e+10
 sigma[gemm] counter=75 total t=3.5e-03 per=7.6e+01 cost=7.5e+07 flops=2.1e+10
 sigma[red] counter=75 t=6.7e-04 per=1.4e+01 cost=3.9e+06 flops=5.9e+09
--- TIMING FOR sigma_tot : t_inter=3.7e-02 t_gemm=3.9e-01 t_reduction=5.6e-02 tot=4.8e-01 ---
 sigma_tot[inter] counter=75 t=3.7e-02 per=7.7e+00 cost=7.1e+08 flops=1.9e+10
 sigma_tot[gemm] counter=75 i=0 t=1.6e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=1 t=1.2e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=2 t=9.9e-02 per=2.0e+01 cost=6.5e+08 flops=6.5e+09
 sigma_tot[gemm] counter=75 i=3 t=9.7e-02 per=2.0e+01 cost=6.4e+08 flops=6.6e+09
 sigma_tot[gemm] counter=75 i=4 t=1.0e-01 per=2.1e+01 cost=5.2e+08 flops=5.2e+09
 sigma_tot[gemm] counter=75 i=5 t=9.6e-02 per=2.0e+01 cost=5.4e+08 flops=5.6e+09
 sigma_tot[gemm] counter=75 total t=3.9e-01 per=8.1e+01 cost=2.3e+09 flops=6.0e+09
 sigma_tot[red] counter=75 t=5.6e-02 per=1.1e+01 cost=1.6e+08 flops=2.8e+09
T(sub)=6.2e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-05,2.5e-05,3.6e-06,1.1e-05,1.1e-06
    7   0 -    -116.517003493527 -3.569e-06  6.832e-04    3     7  1.159e-01 1.656e-02 8.022e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.205e-05,4.310e-04,3.453e-03,6.572e-04,4.594e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=3.634e-05 speed=8.763e-01GB/S t[comm(inter)]=5.713e-06 speed=5.574e+00GB/S
--- TIMING FOR sigma : t_inter=4.3e-04 t_gemm=3.5e-03 t_reduction=6.6e-04 tot=4.5e-03 ---
 sigma[inter] counter=76 t=4.3e-04 per=9.5e+00 cost=1.7e+07 flops=4.0e+10
 sigma[gemm] counter=76 i=0 t=2.0e-06 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=1 t=1.7e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=2 t=8.7e-04 per=1.9e+01 cost=2.1e+07 flops=2.4e+10
 sigma[gemm] counter=76 i=3 t=8.3e-04 per=1.8e+01 cost=2.1e+07 flops=2.5e+10
 sigma[gemm] counter=76 i=4 t=8.9e-04 per=2.0e+01 cost=1.6e+07 flops=1.8e+10
 sigma[gemm] counter=76 i=5 t=8.5e-04 per=1.9e+01 cost=1.7e+07 flops=1.9e+10
 sigma[gemm] counter=76 total t=3.5e-03 per=7.6e+01 cost=7.5e+07 flops=2.2e+10
 sigma[red] counter=76 t=6.6e-04 per=1.4e+01 cost=3.9e+06 flops=6.0e+09
--- TIMING FOR sigma_tot : t_inter=3.8e-02 t_gemm=4.0e-01 t_reduction=5.6e-02 tot=4.9e-01 ---
 sigma_tot[inter] counter=76 t=3.8e-02 per=7.7e+00 cost=7.2e+08 flops=1.9e+10
 sigma_tot[gemm] counter=76 i=0 t=1.6e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=1 t=1.2e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=2 t=1.0e-01 per=2.0e+01 cost=6.7e+08 flops=6.7e+09
 sigma_tot[gemm] counter=76 i=3 t=9.8e-02 per=2.0e+01 cost=6.6e+08 flops=6.8e+09
 sigma_tot[gemm] counter=76 i=4 t=1.0e-01 per=2.1e+01 cost=5.4e+08 flops=5.4e+09
 sigma_tot[gemm] counter=76 i=5 t=9.7e-02 per=2.0e+01 cost=5.5e+08 flops=5.7e+09
 sigma_tot[gemm] counter=76 total t=4.0e-01 per=8.1e+01 cost=2.4e+09 flops=6.1e+09
 sigma_tot[red] counter=76 t=5.6e-02 per=1.1e+01 cost=1.6e+08 flops=2.9e+09
T(sub)=6.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-05,2.5e-05,3.6e-06,1.0e-05,1.1e-06
    8   0 -    -116.517004212978 -7.195e-07  3.438e-04    3     8  1.309e-01 1.636e-02 7.610e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.113e-05,4.626e-04,3.444e-03,6.476e-04,4.605e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=3.549e-05 speed=8.972e-01GB/S t[comm(inter)]=5.642e-06 speed=5.644e+00GB/S
--- TIMING FOR sigma : t_inter=4.6e-04 t_gemm=3.4e-03 t_reduction=6.5e-04 tot=4.6e-03 ---
 sigma[inter] counter=77 t=4.6e-04 per=1.0e+01 cost=1.7e+07 flops=3.7e+10
 sigma[gemm] counter=77 i=0 t=2.1e-06 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=1 t=1.7e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=2 t=8.6e-04 per=1.9e+01 cost=2.1e+07 flops=2.5e+10
 sigma[gemm] counter=77 i=3 t=8.3e-04 per=1.8e+01 cost=2.1e+07 flops=2.5e+10
 sigma[gemm] counter=77 i=4 t=9.0e-04 per=2.0e+01 cost=1.6e+07 flops=1.8e+10
 sigma[gemm] counter=77 i=5 t=8.4e-04 per=1.9e+01 cost=1.7e+07 flops=2.0e+10
 sigma[gemm] counter=77 total t=3.4e-03 per=7.6e+01 cost=7.5e+07 flops=2.2e+10
 sigma[red] counter=77 t=6.5e-04 per=1.4e+01 cost=3.9e+06 flops=6.1e+09
--- TIMING FOR sigma_tot : t_inter=3.8e-02 t_gemm=4.0e-01 t_reduction=5.7e-02 tot=4.9e-01 ---
 sigma_tot[inter] counter=77 t=3.8e-02 per=7.7e+00 cost=7.4e+08 flops=1.9e+10
 sigma_tot[gemm] counter=77 i=0 t=1.6e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=1 t=1.3e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=2 t=1.0e-01 per=2.0e+01 cost=6.9e+08 flops=6.9e+09
 sigma_tot[gemm] counter=77 i=3 t=9.9e-02 per=2.0e+01 cost=6.8e+08 flops=6.9e+09
 sigma_tot[gemm] counter=77 i=4 t=1.0e-01 per=2.1e+01 cost=5.5e+08 flops=5.5e+09
 sigma_tot[gemm] counter=77 i=5 t=9.8e-02 per=2.0e+01 cost=5.7e+08 flops=5.8e+09
 sigma_tot[gemm] counter=77 total t=4.0e-01 per=8.1e+01 cost=2.5e+09 flops=6.3e+09
 sigma_tot[red] counter=77 t=5.7e-02 per=1.2e+01 cost=1.7e+08 flops=2.9e+09
T(sub)=6.5e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,2.6e-05,3.2e-06,1.5e-05,9.5e-07
    9   0 -    -116.517004407076 -1.941e-07  1.563e-04    3     9  1.452e-01 1.614e-02 7.290e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.105e-05,4.638e-04,3.435e-03,6.656e-04,4.616e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=3.598e-05 speed=8.852e-01GB/S t[comm(inter)]=5.080e-06 speed=6.268e+00GB/S
--- TIMING FOR sigma : t_inter=4.6e-04 t_gemm=3.4e-03 t_reduction=6.7e-04 tot=4.6e-03 ---
 sigma[inter] counter=78 t=4.6e-04 per=1.0e+01 cost=1.7e+07 flops=3.7e+10
 sigma[gemm] counter=78 i=0 t=2.0e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=1 t=1.7e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=2 t=8.6e-04 per=1.9e+01 cost=2.1e+07 flops=2.5e+10
 sigma[gemm] counter=78 i=3 t=8.3e-04 per=1.8e+01 cost=2.1e+07 flops=2.5e+10
 sigma[gemm] counter=78 i=4 t=8.8e-04 per=1.9e+01 cost=1.6e+07 flops=1.8e+10
 sigma[gemm] counter=78 i=5 t=8.5e-04 per=1.9e+01 cost=1.7e+07 flops=1.9e+10
 sigma[gemm] counter=78 total t=3.4e-03 per=7.5e+01 cost=7.5e+07 flops=2.2e+10
 sigma[red] counter=78 t=6.7e-04 per=1.5e+01 cost=3.9e+06 flops=5.9e+09
--- TIMING FOR sigma_tot : t_inter=3.8e-02 t_gemm=4.0e-01 t_reduction=5.7e-02 tot=5.0e-01 ---
 sigma_tot[inter] counter=78 t=3.8e-02 per=7.7e+00 cost=7.6e+08 flops=2.0e+10
 sigma_tot[gemm] counter=78 i=0 t=1.6e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=1 t=1.3e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=2 t=1.0e-01 per=2.0e+01 cost=7.1e+08 flops=7.0e+09
 sigma_tot[gemm] counter=78 i=3 t=9.9e-02 per=2.0e+01 cost=7.0e+08 flops=7.1e+09
 sigma_tot[gemm] counter=78 i=4 t=1.0e-01 per=2.1e+01 cost=5.7e+08 flops=5.6e+09
 sigma_tot[gemm] counter=78 i=5 t=9.9e-02 per=2.0e+01 cost=5.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=78 total t=4.0e-01 per=8.1e+01 cost=2.6e+09 flops=6.4e+09
 sigma_tot[red] counter=78 t=5.7e-02 per=1.2e+01 cost=1.7e+08 flops=3.0e+09
T(sub)=6.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,2.5e-05,3.5e-06,1.0e-05,1.1e-06
   10   0 +    -116.517004448238 -4.116e-08  6.686e-05    3    10  1.548e-01 1.548e-02 7.035e-03
TIMING FOR Davidson : 1.549e-01  T(cal/comm/rest)=7.035e-02,1.357e-06,8.452e-02
decomposed t_rest=8.452e-02
 T(sub)    =5.820e-04 per=6.886e-01
 T(precond)=8.352e-02 per=9.882e+01
 T(ortho)  =9.077e-05 per=1.074e-01
 T(xcopy)  =6.846e-06 per=8.100e-03
 T(xnrm2)  =1.368e-05 per=1.618e-02
 T(other)  =3.065e-04 per=3.626e-01
optimized energies: isweep=0 ibond=10 dots=1 e[0]=-116.517004448238 nmvp=10
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.643e+02S Sys:2.710e+00S Total:9.670e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond10.txt
 qbond: qsuper nsym=18 dimAll=296
 (15,3):20 (17,3):43 (16,4):22 (16,2):45 (15,1):20 (17,1):35 (16,0):14 (18,2):31 (19,1):10 (18,0):10 (19,3):10 (18,4):18 (17,5):8 (14,2):6 (13,1):1 (14,0):1 (19,5):1 (18,6):1
timing for divide=1.4e-05
timing for compute=4.8e-04
timing for collect=2.1e-05
----- TMING FOR decimation_genbasis(nkr): 5.1e-04 S T(divide/compute/collect)=1.4e-05,4.8e-04,2.1e-05 -----
decimation summary: 296->77 dwt=-6.661e-16 SvN=2.016e+00
 qbond: qkept nsym=9 dimAll=77
 (17,3):15 (17,1):15 (18,2):10 (19,1):10 (19,3):10 (18,4):7 (16,2):6 (15,1):3 (19,5):1
----- TIMING for decimation_row(nkr): 1.338e-03 S T(decim/select/formRot)=5.927e-04,7.126e-04,3.277e-05 -----
----- TIMING FOR onedot_decimation: 1.551e-03 S T(wf/decim)=1.844e-04,1.366e-03 -----
ctns::oper_renorm coord=(11,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:24 S:16 H:1 P:120 Q:136 
        dim(bra,ket)=77,77 size(op)=845:6.447e-03MB size(tot)=142381:1.086e+00MB:1.061e-03GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.645e+02S Sys:2.710e+00S Total:9.672e+02S
----- TIMING FOR symbolic_formulae_renorm with size=297 : 2.361e-02 S -----
rank=0 GPUmem(GB): used=0.00237 (oper)=0.00231
rank=0 GPUmem(GB): used=0.00238 (oper,site)(GB)=0.00231,1.59e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=664
 no. of coefficients=7304:0.0557MB:5.44e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 9.737e-04 S -----
rank=0 GPUmem(GB): used=0.00244 (oper,site,rinter)=0.00231,1.59e-05,5.44e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0146 S size(rtasks)=297 size(Rlst2)=81 T(Rmu/Rlist)=0.00377,0.0109 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0156 S size(rtasks)=297 size(Rlst)=9934 -----
rank=0 GPUmem(GB): used=0.00244 (oper,site,rinter,batch)=0.00231,1.59e-05,5.44e-05,0.0456 blksize=225 blksize0=165 batchsize=9934
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000817,0.0149,0.00331
--- TIMING FOR renorm : t_inter=8.2e-04 t_gemm=1.5e-02 t_reduction=3.3e-03 tot=1.9e-02 ---
 renorm[inter] counter=11 t=8.2e-04 per=4.3e+00 cost=8.5e+06 flops=1.0e+10
 renorm[gemm] counter=11 i=0 t=1.3e-06 per=7.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=1 t=1.1e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=2 t=1.1e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=3 t=1.1e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=4 t=4.4e-03 per=2.3e+01 cost=6.5e+06 flops=1.5e+09
 renorm[gemm] counter=11 i=5 t=5.2e-03 per=2.7e+01 cost=1.1e+07 flops=2.1e+09
 renorm[gemm] counter=11 i=6 t=5.3e-03 per=2.8e+01 cost=2.2e+07 flops=4.2e+09
 renorm[gemm] counter=11 total t=1.5e-02 per=7.8e+01 cost=4.0e+07 flops=2.7e+09
 renorm[red] counter=11 t=3.3e-03 per=1.7e+01 cost=2.1e+06 flops=6.3e+08
--- TIMING FOR renorm_tot : t_inter=7.6e-03 t_gemm=8.7e-02 t_reduction=1.9e-02 tot=1.1e-01 ---
 renorm_tot[inter] counter=11 t=7.6e-03 per=6.6e+00 cost=4.3e+07 flops=5.7e+09
 renorm_tot[gemm] counter=11 i=0 t=1.6e-05 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=1 t=1.3e-05 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=2 t=1.3e-05 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=3 t=1.3e-05 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=4 t=2.4e-02 per=2.1e+01 cost=1.8e+07 flops=7.6e+08
 renorm_tot[gemm] counter=11 i=5 t=3.1e-02 per=2.7e+01 cost=3.6e+07 flops=1.2e+09
 renorm_tot[gemm] counter=11 i=6 t=3.3e-02 per=2.9e+01 cost=7.5e+07 flops=2.3e+09
 renorm_tot[gemm] counter=11 total t=8.7e-02 per=7.7e+01 cost=1.3e+08 flops=1.5e+09
 renorm_tot[red] counter=11 t=1.9e-02 per=1.7e+01 cost=9.7e+06 flops=5.1e+08
qops.to_cpu: size(tot)=142381:1.1e+00MB:1.1e-03GB t[to_cpu]=2.9e-04S speed=3.7e+00GB/S
check ||H-H.dagger||=1.131e-13 coord=(11,0) rank=0
ctns::oper_ab2pq coord=(11,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.124 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.646e+02S Sys:2.710e+00S Total:9.673e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1941:1.481e-02MB:1.446e-05GB
total mem of comb=17108:1.305e-01MB:1.275e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.646e+02S Sys:2.712e+00S Total:9.673e+02S
##### local opt: 5.124e-01 S #####
 T(local opt: fetch) = 2.183e-02 S  per = 4.26  per(accum) = 4.26
 T(local opt: hdiag) = 4.942e-03 S  per = 0.965  per(accum) = 5.23
 T(local opt: dvdsn) = 3.554e-01 S  per = 69.4  per(accum) = 74.6
 T(local opt: decim) = 1.560e-03 S  per = 0.304  per(accum) = 74.9
 T(local opt: guess) = 3.269e-04 S  per = 0.0638  per(accum) = 75
 T(local opt: renrm) = 1.254e-01 S  per = 24.5  per(accum) = 99.4
 T(local opt: save ) = 2.928e-03 S  per = 0.571  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.554e-01 S  T(sum) = 3.549e-01 S  per = 9.984e+01
 T(local opt: preprocess                  ) = 6.889e-04 S  per = 0.194  per(accum) = 0.194
 T(local opt: symbolic_formulae           ) = 3.702e-02 S  per = 10.4  per(accum) = 10.6
 T(local opt: hintermediate init          ) = 8.056e-04 S  per = 0.227  per(accum) = 10.9
 T(local opt: preprocess_hformulae_Hxlist ) = 3.233e-02 S  per = 9.11  per(accum) = 20
 T(local opt: hmmtasks init               ) = 1.291e-01 S  per = 36.4  per(accum) = 56.4
 T(local opt: initial guess for dvdson    ) = 1.375e-05 S  per = 0.00387  per(accum) = 56.4
 T(local opt: dvdson solver [Hx_batchGPU] ) = 6.989e-02 S  per = 19.7  per(accum) = 76.1
 T(local opt: dvdson solver [comm(gpu)]   ) = 4.616e-04 S  per = 0.13  per(accum) = 76.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.357e-06 S  per = 0.000382  per(accum) = 76.2
 T(local opt: dvdson solver [rest part]   ) = 8.452e-02 S  per = 23.8  per(accum) = 100
Detailed decomposition of T(renrm) = 1.254e-01 S  T(sum) = 1.254e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.413e-04 S  per = 0.192  per(accum) = 0.192
 T(local opt: qops init                    ) = 3.534e-03 S  per = 2.82  per(accum) = 3.01
 T(local opt: symbolic_formulae_renorm     ) = 2.362e-02 S  per = 18.8  per(accum) = 21.9
 T(local opt: allocate qops on gpu         ) = 2.987e-05 S  per = 0.0238  per(accum) = 21.9
 T(local opt: site memcpy cpu2gpu          ) = 2.113e-05 S  per = 0.0169  per(accum) = 21.9
 T(local opt: rintermediate init           ) = 9.860e-04 S  per = 0.787  per(accum) = 22.7
 T(local opt: preprocess_formulae_Rlist2   ) = 1.588e-02 S  per = 12.7  per(accum) = 35.4
 T(local opt: rmmtasks init                ) = 6.053e-02 S  per = 48.3  per(accum) = 83.6
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 3.43e-05  per(accum) = 83.6
 T(local opt: preprocess_renorm_batchGPU   ) = 1.916e-02 S  per = 15.3  per(accum) = 98.9
 T(local opt: reduction of opS & opH [nccl]) = 8.810e-07 S  per = 0.000703  per(accum) = 98.9
 T(local opt: qops memcpy gpu2cpu          ) = 3.000e-04 S  per = 0.239  per(accum) = 99.2
 T(local opt: deallocate cpu and gpu memory) = 1.425e-04 S  per = 0.114  per(accum) = 99.3
 T(local opt: reduction of opS & opH [comm]) = 4.936e-05 S  per = 0.0394  per(accum) = 99.3
 T(local opt: conversion from opAB to opPQ ) = 3.828e-06 S  per = 0.00305  per(accum) = 99.3
 T(local opt: after oper_renorm            ) = 8.500e-04 S  per = 0.678  per(accum) = 100
##### sweep opt: 8.625e+00 S #####
 T(sweep opt: fetch) = 1.526e-01 S  per = 1.77  per(accum) = 1.77
 T(sweep opt: hdiag) = 2.798e-02 S  per = 0.324  per(accum) = 2.09
 T(sweep opt: dvdsn) = 3.438e+00 S  per = 39.9  per(accum) = 41.9
 T(sweep opt: decim) = 1.387e-02 S  per = 0.161  per(accum) = 42.1
 T(sweep opt: guess) = 3.521e-03 S  per = 0.0408  per(accum) = 42.2
 T(sweep opt: renrm) = 4.960e+00 S  per = 57.5  per(accum) = 99.7
 T(sweep opt: save ) = 2.950e-02 S  per = 0.342  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.438e+00 S  T(sum) = 3.159e+00 S  per = 9.190e+01
 T(sweep opt: preprocess                  ) = 5.469e-03 S  per = 0.173  per(accum) = 0.173
 T(sweep opt: symbolic_formulae           ) = 1.829e-01 S  per = 5.79  per(accum) = 5.96
 T(sweep opt: hintermediate init          ) = 4.285e-03 S  per = 0.136  per(accum) = 6.1
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.324e-01 S  per = 7.36  per(accum) = 13.5
 T(sweep opt: hmmtasks init               ) = 1.695e+00 S  per = 53.7  per(accum) = 67.1
 T(sweep opt: initial guess for dvdson    ) = 1.026e-04 S  per = 0.00325  per(accum) = 67.1
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 5.087e-01 S  per = 16.1  per(accum) = 83.2
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.784e-03 S  per = 0.0881  per(accum) = 83.3
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.012e-05 S  per = 0.00032  per(accum) = 83.3
 T(sweep opt: dvdson solver [rest part]   ) = 5.273e-01 S  per = 16.7  per(accum) = 100
Detailed decomposition of T(renrm) = 4.960e+00 S  T(sum) = 4.960e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.130e-03 S  per = 0.103  per(accum) = 0.103
 T(sweep opt: qops init                    ) = 4.681e-02 S  per = 0.944  per(accum) = 1.05
 T(sweep opt: symbolic_formulae_renorm     ) = 1.295e-01 S  per = 2.61  per(accum) = 3.66
 T(sweep opt: allocate qops on gpu         ) = 9.529e-04 S  per = 0.0192  per(accum) = 3.68
 T(sweep opt: site memcpy cpu2gpu          ) = 2.408e-04 S  per = 0.00485  per(accum) = 3.68
 T(sweep opt: rintermediate init           ) = 5.925e-03 S  per = 0.119  per(accum) = 3.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.253e-01 S  per = 2.53  per(accum) = 6.33
 T(sweep opt: rmmtasks init                ) = 5.058e-01 S  per = 10.2  per(accum) = 16.5
 T(sweep opt: qops memset on cpu           ) = 6.300e-07 S  per = 1.27e-05  per(accum) = 16.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.151e-01 S  per = 2.32  per(accum) = 18.8
 T(sweep opt: reduction of opS & opH [nccl]) = 1.167e-05 S  per = 0.000235  per(accum) = 18.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.938e-03 S  per = 0.0391  per(accum) = 18.9
 T(sweep opt: deallocate cpu and gpu memory) = 1.960e-01 S  per = 3.95  per(accum) = 22.8
 T(sweep opt: reduction of opS & opH [comm]) = 4.894e-04 S  per = 0.00987  per(accum) = 22.8
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per =   77  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 7.896e-03 S  per = 0.159  per(accum) = 100
##### global opt: 8.625e+00 S #####
 T(global opt: fetch) = 1.526e-01 S  per = 1.77  per(accum) = 1.77
 T(global opt: hdiag) = 2.798e-02 S  per = 0.324  per(accum) = 2.09
 T(global opt: dvdsn) = 3.438e+00 S  per = 39.9  per(accum) = 41.9
 T(global opt: decim) = 1.387e-02 S  per = 0.161  per(accum) = 42.1
 T(global opt: guess) = 3.521e-03 S  per = 0.0408  per(accum) = 42.2
 T(global opt: renrm) = 4.960e+00 S  per = 57.5  per(accum) = 99.7
 T(global opt: save ) = 2.950e-02 S  per = 0.342  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.438e+00 S  T(sum) = 3.159e+00 S  per = 9.190e+01
 T(global opt: preprocess                  ) = 5.469e-03 S  per = 0.173  per(accum) = 0.173
 T(global opt: symbolic_formulae           ) = 1.829e-01 S  per = 5.79  per(accum) = 5.96
 T(global opt: hintermediate init          ) = 4.285e-03 S  per = 0.136  per(accum) = 6.1
 T(global opt: preprocess_hformulae_Hxlist ) = 2.324e-01 S  per = 7.36  per(accum) = 13.5
 T(global opt: hmmtasks init               ) = 1.695e+00 S  per = 53.7  per(accum) = 67.1
 T(global opt: initial guess for dvdson    ) = 1.026e-04 S  per = 0.00325  per(accum) = 67.1
 T(global opt: dvdson solver [Hx_batchGPU] ) = 5.087e-01 S  per = 16.1  per(accum) = 83.2
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.784e-03 S  per = 0.0881  per(accum) = 83.3
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.012e-05 S  per = 0.00032  per(accum) = 83.3
 T(global opt: dvdson solver [rest part]   ) = 5.273e-01 S  per = 16.7  per(accum) = 100
Detailed decomposition of T(renrm) = 4.960e+00 S  T(sum) = 4.960e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.130e-03 S  per = 0.103  per(accum) = 0.103
 T(global opt: qops init                    ) = 4.681e-02 S  per = 0.944  per(accum) = 1.05
 T(global opt: symbolic_formulae_renorm     ) = 1.295e-01 S  per = 2.61  per(accum) = 3.66
 T(global opt: allocate qops on gpu         ) = 9.529e-04 S  per = 0.0192  per(accum) = 3.68
 T(global opt: site memcpy cpu2gpu          ) = 2.408e-04 S  per = 0.00485  per(accum) = 3.68
 T(global opt: rintermediate init           ) = 5.925e-03 S  per = 0.119  per(accum) = 3.8
 T(global opt: preprocess_formulae_Rlist2   ) = 1.253e-01 S  per = 2.53  per(accum) = 6.33
 T(global opt: rmmtasks init                ) = 5.058e-01 S  per = 10.2  per(accum) = 16.5
 T(global opt: qops memset on cpu           ) = 6.300e-07 S  per = 1.27e-05  per(accum) = 16.5
 T(global opt: preprocess_renorm_batchGPU   ) = 1.151e-01 S  per = 2.32  per(accum) = 18.8
 T(global opt: reduction of opS & opH [nccl]) = 1.167e-05 S  per = 0.000235  per(accum) = 18.8
 T(global opt: qops memcpy gpu2cpu          ) = 1.938e-03 S  per = 0.0391  per(accum) = 18.9
 T(global opt: deallocate cpu and gpu memory) = 1.960e-01 S  per = 3.95  per(accum) = 22.8
 T(global opt: reduction of opS & opH [comm]) = 4.894e-04 S  per = 0.00987  per(accum) = 22.8
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per =   77  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 7.896e-03 S  per = 0.159  per(accum) = 100

isweep=0 ibond=11/seqsize=34 dots=1 dbond=(12,0)-(13,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.646e+02S Sys:2.712e+00S Total:9.673e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1941:1.481e-02MB:1.446e-05GB
total mem of comb=17108:1.305e-01MB:1.275e-04GB
ctns::topology::check_partition: (sl,sr,sc)=12,7,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc= 8
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:24 S:16 H:1 P:120 Q:136 
        dim(bra,ket)=77,77 size(op)=845:6.447e-03MB size(tot)=142381:1.086e+00MB:1.061e-03GB
 rqops: oplist=CSHAB nops=C:14 S:26 H:1 A:91 B:105 
        dim(bra,ket)=68,68 size(op)=652:4.974e-03MB size(tot)=87673:6.689e-01MB:6.532e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=232390:1.773e+00MB:1.731e-03GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(12,0) fdel=./scratch/sweep/rop(13,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
wf3(diml,dimr,dimc)=(77,68,4) nnz=1941:1.481e-02MB
qtensor3: wf3 own=1 _data=0x525eed00
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=77
 (17,3):15 (17,1):15 (18,2):10 (19,1):10 (19,3):10 (18,4):7 (16,2):6 (15,1):3 (19,5):1
 qbond: qcol nsym=9 dimAll=68
 (11,-3):14 (11,-1):12 (9,-3):10 (10,-2):9 (12,-2):7 (9,-1):6 (10,-4):6 (13,-1):3 (9,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=23 nblocks=324 size=1941:1.481e-02MB
### DIAG TIMING: total=2.326e-03 t1=1.226e-05, t2=1.623e-05, t3=3.527e-05, t4=2.237e-03, t5=6.274e-06, t6=1.581e-05, t7=2.850e-06
duration_diagGPU:2.337e-03
duration_diagreduce:3.200e-08
duration_diagtransform:6.887e-06
----- TIMING FOR symbolic_formulae_onedot with size=1053 : 1.910e-02 S -----
rank=0 GPUmem(GB): used=0.00173 (oper)=0.00173
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1053
 no. of hintermediate operators=518
 no. of coefficients=6216:0.0474MB:4.63e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.112e-04 S -----
rank=0 GPUmem(GB): used=0.00178 (oper,hinter)=0.00173,4.63e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0162 S size(H_formulae)=1053 size(Hxlst2)=23 T(Hmu/Hxlist)=0.00245,0.0137 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0174 S size(H_formulae)=1053 size(Hxlst)=15500 -----
rank=0 GPUmem(GB): used=0.0677 (oper,hinter,dvdson,batch)=0.00173,4.63e-05,2.89e-05,0.0659 blksize=210 blksize0=150 batchsize=15500
ctns::pdvdsonSolver_nkr::solve_iter ndim=1941 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.42e-05,0.00088,0.0226,0.00207,0.0256
 ndim=1941:1.45e-05GB t[comm(intra)]=2.86e-05 speed=1.01GB/S t[comm(inter)]=5.68e-06 speed=5.09GB/S
--- TIMING FOR sigma : t_inter=8.8e-04 t_gemm=2.3e-02 t_reduction=2.1e-03 tot=2.6e-02 ---
 sigma[inter] counter=79 t=8.8e-04 per=3.4e+00 cost=1.4e+07 flops=1.6e+10
 sigma[gemm] counter=79 i=0 t=1.4e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=1 t=1.2e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=2 t=6.7e-03 per=2.6e+01 cost=1.3e+07 flops=2.0e+09
 sigma[gemm] counter=79 i=3 t=6.4e-03 per=2.5e+01 cost=1.3e+07 flops=2.1e+09
 sigma[gemm] counter=79 i=4 t=5.2e-03 per=2.0e+01 cost=1.2e+07 flops=2.3e+09
 sigma[gemm] counter=79 i=5 t=4.4e-03 per=1.7e+01 cost=1.2e+07 flops=2.7e+09
 sigma[gemm] counter=79 total t=2.3e-02 per=8.8e+01 cost=5.0e+07 flops=2.2e+09
 sigma[red] counter=79 t=2.1e-03 per=8.1e+00 cost=2.8e+06 flops=1.4e+09
--- TIMING FOR sigma_tot : t_inter=3.9e-02 t_gemm=4.2e-01 t_reduction=6.0e-02 tot=5.2e-01 ---
 sigma_tot[inter] counter=79 t=3.9e-02 per=7.5e+00 cost=7.7e+08 flops=2.0e+10
 sigma_tot[gemm] counter=79 i=0 t=1.6e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=1 t=1.3e-04 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=2 t=1.1e-01 per=2.1e+01 cost=7.2e+08 flops=6.7e+09
 sigma_tot[gemm] counter=79 i=3 t=1.1e-01 per=2.0e+01 cost=7.1e+08 flops=6.8e+09
 sigma_tot[gemm] counter=79 i=4 t=1.1e-01 per=2.1e+01 cost=5.8e+08 flops=5.4e+09
 sigma_tot[gemm] counter=79 i=5 t=1.0e-01 per=2.0e+01 cost=6.0e+08 flops=5.8e+09
 sigma_tot[gemm] counter=79 total t=4.2e-01 per=8.1e+01 cost=2.6e+09 flops=6.2e+09
 sigma_tot[red] counter=79 t=6.0e-02 per=1.1e+01 cost=1.7e+08 flops=2.9e+09
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.5e-06,5.5e-06,1.9e-06,3.2e-06,7.2e-07
settings: ndim=1941 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.517004448238 -1.117e+03  8.831e-02    1     1  2.577e-02 2.577e-02 2.573e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.103e-05,3.747e-04,3.155e-03,5.843e-04,4.166e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=3.551e-05 speed=8.146e-01GB/S t[comm(inter)]=5.524e-06 speed=5.236e+00GB/S
--- TIMING FOR sigma : t_inter=3.7e-04 t_gemm=3.2e-03 t_reduction=5.8e-04 tot=4.1e-03 ---
 sigma[inter] counter=80 t=3.7e-04 per=9.1e+00 cost=1.4e+07 flops=3.8e+10
 sigma[gemm] counter=80 i=0 t=2.0e-06 per=4.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=1 t=1.8e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=2 t=9.4e-04 per=2.3e+01 cost=1.3e+07 flops=1.4e+10
 sigma[gemm] counter=80 i=3 t=8.4e-04 per=2.0e+01 cost=1.3e+07 flops=1.6e+10
 sigma[gemm] counter=80 i=4 t=7.2e-04 per=1.8e+01 cost=1.2e+07 flops=1.6e+10
 sigma[gemm] counter=80 i=5 t=6.5e-04 per=1.6e+01 cost=1.2e+07 flops=1.8e+10
 sigma[gemm] counter=80 total t=3.2e-03 per=7.7e+01 cost=5.0e+07 flops=1.6e+10
 sigma[red] counter=80 t=5.8e-04 per=1.4e+01 cost=2.8e+06 flops=4.9e+09
--- TIMING FOR sigma_tot : t_inter=4.0e-02 t_gemm=4.3e-01 t_reduction=6.0e-02 tot=5.3e-01 ---
 sigma_tot[inter] counter=80 t=4.0e-02 per=7.5e+00 cost=7.9e+08 flops=2.0e+10
 sigma_tot[gemm] counter=80 i=0 t=1.7e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=1 t=1.3e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=2 t=1.1e-01 per=2.1e+01 cost=7.4e+08 flops=6.8e+09
 sigma_tot[gemm] counter=80 i=3 t=1.1e-01 per=2.0e+01 cost=7.3e+08 flops=6.8e+09
 sigma_tot[gemm] counter=80 i=4 t=1.1e-01 per=2.0e+01 cost=5.9e+08 flops=5.5e+09
 sigma_tot[gemm] counter=80 i=5 t=1.0e-01 per=2.0e+01 cost=6.1e+08 flops=5.9e+09
 sigma_tot[gemm] counter=80 total t=4.3e-01 per=8.1e+01 cost=2.7e+09 flops=6.2e+09
 sigma_tot[red] counter=80 t=6.0e-02 per=1.1e+01 cost=1.8e+08 flops=2.9e+09
T(sub)=5.7e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,2.5e-05,4.2e-06,6.5e-06,1.0e-06
    2   0 -    -116.525903713730 -8.899e-03  2.943e-02    2     2  3.959e-02 1.979e-02 1.502e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.124e-05,3.448e-04,3.287e-03,5.842e-04,4.267e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=3.617e-05 speed=7.995e-01GB/S t[comm(inter)]=5.065e-06 speed=5.710e+00GB/S
--- TIMING FOR sigma : t_inter=3.4e-04 t_gemm=3.3e-03 t_reduction=5.8e-04 tot=4.2e-03 ---
 sigma[inter] counter=81 t=3.4e-04 per=8.2e+00 cost=1.4e+07 flops=4.1e+10
 sigma[gemm] counter=81 i=0 t=2.0e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=1 t=1.7e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=2 t=9.9e-04 per=2.3e+01 cost=1.3e+07 flops=1.4e+10
 sigma[gemm] counter=81 i=3 t=9.1e-04 per=2.2e+01 cost=1.3e+07 flops=1.5e+10
 sigma[gemm] counter=81 i=4 t=7.3e-04 per=1.7e+01 cost=1.2e+07 flops=1.6e+10
 sigma[gemm] counter=81 i=5 t=6.6e-04 per=1.6e+01 cost=1.2e+07 flops=1.8e+10
 sigma[gemm] counter=81 total t=3.3e-03 per=7.8e+01 cost=5.0e+07 flops=1.5e+10
 sigma[red] counter=81 t=5.8e-04 per=1.4e+01 cost=2.8e+06 flops=4.9e+09
--- TIMING FOR sigma_tot : t_inter=4.0e-02 t_gemm=4.3e-01 t_reduction=6.1e-02 tot=5.3e-01 ---
 sigma_tot[inter] counter=81 t=4.0e-02 per=7.5e+00 cost=8.0e+08 flops=2.0e+10
 sigma_tot[gemm] counter=81 i=0 t=1.7e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=1 t=1.3e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=2 t=1.1e-01 per=2.1e+01 cost=7.5e+08 flops=6.8e+09
 sigma_tot[gemm] counter=81 i=3 t=1.1e-01 per=2.0e+01 cost=7.4e+08 flops=6.9e+09
 sigma_tot[gemm] counter=81 i=4 t=1.1e-01 per=2.0e+01 cost=6.1e+08 flops=5.6e+09
 sigma_tot[gemm] counter=81 i=5 t=1.0e-01 per=2.0e+01 cost=6.2e+08 flops=6.0e+09
 sigma_tot[gemm] counter=81 total t=4.3e-01 per=8.1e+01 cost=2.7e+09 flops=6.3e+09
 sigma_tot[red] counter=81 t=6.1e-02 per=1.1e+01 cost=1.8e+08 flops=2.9e+09
T(sub)=6.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,2.7e-05,3.6e-06,9.5e-06,9.5e-07
    3   0 -    -116.527313178930 -1.409e-03  1.561e-02    3     3  5.763e-02 1.921e-02 1.149e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.945e-05,3.062e-04,3.066e-03,5.960e-04,4.008e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=2.482e-05 speed=1.165e+00GB/S t[comm(inter)]=4.630e-06 speed=6.247e+00GB/S
--- TIMING FOR sigma : t_inter=3.1e-04 t_gemm=3.1e-03 t_reduction=6.0e-04 tot=4.0e-03 ---
 sigma[inter] counter=82 t=3.1e-04 per=7.7e+00 cost=1.4e+07 flops=4.6e+10
 sigma[gemm] counter=82 i=0 t=1.7e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=1 t=1.5e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=2 t=8.8e-04 per=2.2e+01 cost=1.3e+07 flops=1.5e+10
 sigma[gemm] counter=82 i=3 t=8.5e-04 per=2.1e+01 cost=1.3e+07 flops=1.6e+10
 sigma[gemm] counter=82 i=4 t=7.1e-04 per=1.8e+01 cost=1.2e+07 flops=1.7e+10
 sigma[gemm] counter=82 i=5 t=6.3e-04 per=1.6e+01 cost=1.2e+07 flops=1.9e+10
 sigma[gemm] counter=82 total t=3.1e-03 per=7.7e+01 cost=5.0e+07 flops=1.6e+10
 sigma[red] counter=82 t=6.0e-04 per=1.5e+01 cost=2.8e+06 flops=4.8e+09
--- TIMING FOR sigma_tot : t_inter=4.0e-02 t_gemm=4.3e-01 t_reduction=6.1e-02 tot=5.4e-01 ---
 sigma_tot[inter] counter=82 t=4.0e-02 per=7.5e+00 cost=8.1e+08 flops=2.0e+10
 sigma_tot[gemm] counter=82 i=0 t=1.7e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=1 t=1.3e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=2 t=1.1e-01 per=2.1e+01 cost=7.6e+08 flops=6.9e+09
 sigma_tot[gemm] counter=82 i=3 t=1.1e-01 per=2.0e+01 cost=7.5e+08 flops=7.0e+09
 sigma_tot[gemm] counter=82 i=4 t=1.1e-01 per=2.0e+01 cost=6.2e+08 flops=5.6e+09
 sigma_tot[gemm] counter=82 i=5 t=1.0e-01 per=2.0e+01 cost=6.3e+08 flops=6.0e+09
 sigma_tot[gemm] counter=82 total t=4.3e-01 per=8.1e+01 cost=2.8e+09 flops=6.4e+09
 sigma_tot[red] counter=82 t=6.1e-02 per=1.1e+01 cost=1.8e+08 flops=3.0e+09
T(sub)=5.8e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,2.5e-05,3.6e-06,9.5e-06,9.1e-07
    4   0 -    -116.527714130611 -4.010e-04  7.993e-03    3     4  7.811e-02 1.953e-02 1.081e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.322e-05,3.688e-04,3.146e-03,6.017e-04,4.176e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=3.763e-05 speed=7.687e-01GB/S t[comm(inter)]=5.596e-06 speed=5.169e+00GB/S
--- TIMING FOR sigma : t_inter=3.7e-04 t_gemm=3.1e-03 t_reduction=6.0e-04 tot=4.1e-03 ---
 sigma[inter] counter=83 t=3.7e-04 per=9.0e+00 cost=1.4e+07 flops=3.9e+10
 sigma[gemm] counter=83 i=0 t=2.0e-06 per=4.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=1 t=1.7e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=2 t=9.4e-04 per=2.3e+01 cost=1.3e+07 flops=1.4e+10
 sigma[gemm] counter=83 i=3 t=8.6e-04 per=2.1e+01 cost=1.3e+07 flops=1.5e+10
 sigma[gemm] counter=83 i=4 t=7.0e-04 per=1.7e+01 cost=1.2e+07 flops=1.7e+10
 sigma[gemm] counter=83 i=5 t=6.4e-04 per=1.6e+01 cost=1.2e+07 flops=1.8e+10
 sigma[gemm] counter=83 total t=3.1e-03 per=7.6e+01 cost=5.0e+07 flops=1.6e+10
 sigma[red] counter=83 t=6.0e-04 per=1.5e+01 cost=2.8e+06 flops=4.7e+09
--- TIMING FOR sigma_tot : t_inter=4.1e-02 t_gemm=4.4e-01 t_reduction=6.2e-02 tot=5.4e-01 ---
 sigma_tot[inter] counter=83 t=4.1e-02 per=7.5e+00 cost=8.3e+08 flops=2.0e+10
 sigma_tot[gemm] counter=83 i=0 t=1.7e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=1 t=1.3e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=2 t=1.1e-01 per=2.1e+01 cost=7.8e+08 flops=7.0e+09
 sigma_tot[gemm] counter=83 i=3 t=1.1e-01 per=2.0e+01 cost=7.7e+08 flops=7.0e+09
 sigma_tot[gemm] counter=83 i=4 t=1.1e-01 per=2.0e+01 cost=6.3e+08 flops=5.7e+09
 sigma_tot[gemm] counter=83 i=5 t=1.1e-01 per=2.0e+01 cost=6.5e+08 flops=6.1e+09
 sigma_tot[gemm] counter=83 total t=4.4e-01 per=8.1e+01 cost=2.8e+09 flops=6.5e+09
 sigma_tot[red] counter=83 t=6.2e-02 per=1.1e+01 cost=1.8e+08 flops=3.0e+09
T(sub)=5.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.5e-05,1.3e-05,9.4e-06,9.7e-07
    5   0 -    -116.527816810989 -1.027e-04  3.718e-03    3     5  8.975e-02 1.795e-02 9.510e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.957e-05,3.416e-04,3.108e-03,5.946e-04,4.093e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=3.457e-05 speed=8.367e-01GB/S t[comm(inter)]=4.996e-06 speed=5.789e+00GB/S
--- TIMING FOR sigma : t_inter=3.4e-04 t_gemm=3.1e-03 t_reduction=5.9e-04 tot=4.0e-03 ---
 sigma[inter] counter=84 t=3.4e-04 per=8.4e+00 cost=1.4e+07 flops=4.2e+10
 sigma[gemm] counter=84 i=0 t=1.9e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=1 t=1.7e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=2 t=9.2e-04 per=2.3e+01 cost=1.3e+07 flops=1.5e+10
 sigma[gemm] counter=84 i=3 t=8.4e-04 per=2.1e+01 cost=1.3e+07 flops=1.6e+10
 sigma[gemm] counter=84 i=4 t=7.1e-04 per=1.8e+01 cost=1.2e+07 flops=1.7e+10
 sigma[gemm] counter=84 i=5 t=6.3e-04 per=1.6e+01 cost=1.2e+07 flops=1.9e+10
 sigma[gemm] counter=84 total t=3.1e-03 per=7.7e+01 cost=5.0e+07 flops=1.6e+10
 sigma[red] counter=84 t=5.9e-04 per=1.5e+01 cost=2.8e+06 flops=4.8e+09
--- TIMING FOR sigma_tot : t_inter=4.1e-02 t_gemm=4.4e-01 t_reduction=6.3e-02 tot=5.4e-01 ---
 sigma_tot[inter] counter=84 t=4.1e-02 per=7.5e+00 cost=8.4e+08 flops=2.1e+10
 sigma_tot[gemm] counter=84 i=0 t=1.7e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=1 t=1.4e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=2 t=1.1e-01 per=2.1e+01 cost=7.9e+08 flops=7.0e+09
 sigma_tot[gemm] counter=84 i=3 t=1.1e-01 per=2.0e+01 cost=7.8e+08 flops=7.1e+09
 sigma_tot[gemm] counter=84 i=4 t=1.1e-01 per=2.0e+01 cost=6.4e+08 flops=5.8e+09
 sigma_tot[gemm] counter=84 i=5 t=1.1e-01 per=2.0e+01 cost=6.6e+08 flops=6.2e+09
 sigma_tot[gemm] counter=84 total t=4.4e-01 per=8.1e+01 cost=2.9e+09 flops=6.5e+09
 sigma_tot[red] counter=84 t=6.3e-02 per=1.1e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=5.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,2.5e-05,3.5e-06,9.4e-06,9.5e-07
    6   0 -    -116.527836080091 -1.927e-05  1.449e-03    3     6  1.081e-01 1.801e-02 8.628e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.059e-05,3.446e-04,3.100e-03,5.823e-04,4.077e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=3.505e-05 speed=8.251e-01GB/S t[comm(inter)]=5.536e-06 speed=5.225e+00GB/S
--- TIMING FOR sigma : t_inter=3.4e-04 t_gemm=3.1e-03 t_reduction=5.8e-04 tot=4.0e-03 ---
 sigma[inter] counter=85 t=3.4e-04 per=8.6e+00 cost=1.4e+07 flops=4.1e+10
 sigma[gemm] counter=85 i=0 t=1.9e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=1 t=1.8e-06 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=2 t=9.0e-04 per=2.2e+01 cost=1.3e+07 flops=1.5e+10
 sigma[gemm] counter=85 i=3 t=8.5e-04 per=2.1e+01 cost=1.3e+07 flops=1.6e+10
 sigma[gemm] counter=85 i=4 t=7.1e-04 per=1.8e+01 cost=1.2e+07 flops=1.7e+10
 sigma[gemm] counter=85 i=5 t=6.4e-04 per=1.6e+01 cost=1.2e+07 flops=1.9e+10
 sigma[gemm] counter=85 total t=3.1e-03 per=7.7e+01 cost=5.0e+07 flops=1.6e+10
 sigma[red] counter=85 t=5.8e-04 per=1.4e+01 cost=2.8e+06 flops=4.9e+09
--- TIMING FOR sigma_tot : t_inter=4.1e-02 t_gemm=4.4e-01 t_reduction=6.3e-02 tot=5.5e-01 ---
 sigma_tot[inter] counter=85 t=4.1e-02 per=7.6e+00 cost=8.6e+08 flops=2.1e+10
 sigma_tot[gemm] counter=85 i=0 t=1.8e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=1 t=1.4e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=2 t=1.1e-01 per=2.1e+01 cost=8.1e+08 flops=7.1e+09
 sigma_tot[gemm] counter=85 i=3 t=1.1e-01 per=2.0e+01 cost=7.9e+08 flops=7.2e+09
 sigma_tot[gemm] counter=85 i=4 t=1.1e-01 per=2.0e+01 cost=6.5e+08 flops=5.8e+09
 sigma_tot[gemm] counter=85 i=5 t=1.1e-01 per=1.9e+01 cost=6.7e+08 flops=6.3e+09
 sigma_tot[gemm] counter=85 total t=4.4e-01 per=8.1e+01 cost=2.9e+09 flops=6.6e+09
 sigma_tot[red] counter=85 t=6.3e-02 per=1.2e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=5.8e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,2.5e-05,3.5e-06,9.4e-06,9.3e-07
    7   0 -    -116.527839159455 -3.079e-06  6.323e-04    3     7  1.234e-01 1.763e-02 7.996e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.968e-05,3.472e-04,3.115e-03,5.939e-04,4.106e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=2.513e-05 speed=1.151e+00GB/S t[comm(inter)]=1.455e-05 speed=1.988e+00GB/S
--- TIMING FOR sigma : t_inter=3.5e-04 t_gemm=3.1e-03 t_reduction=5.9e-04 tot=4.1e-03 ---
 sigma[inter] counter=86 t=3.5e-04 per=8.6e+00 cost=1.4e+07 flops=4.1e+10
 sigma[gemm] counter=86 i=0 t=2.0e-06 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=1 t=1.8e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=2 t=9.1e-04 per=2.2e+01 cost=1.3e+07 flops=1.5e+10
 sigma[gemm] counter=86 i=3 t=8.4e-04 per=2.1e+01 cost=1.3e+07 flops=1.6e+10
 sigma[gemm] counter=86 i=4 t=7.1e-04 per=1.7e+01 cost=1.2e+07 flops=1.7e+10
 sigma[gemm] counter=86 i=5 t=6.5e-04 per=1.6e+01 cost=1.2e+07 flops=1.8e+10
 sigma[gemm] counter=86 total t=3.1e-03 per=7.7e+01 cost=5.0e+07 flops=1.6e+10
 sigma[red] counter=86 t=5.9e-04 per=1.5e+01 cost=2.8e+06 flops=4.8e+09
--- TIMING FOR sigma_tot : t_inter=4.2e-02 t_gemm=4.5e-01 t_reduction=6.4e-02 tot=5.5e-01 ---
 sigma_tot[inter] counter=86 t=4.2e-02 per=7.6e+00 cost=8.7e+08 flops=2.1e+10
 sigma_tot[gemm] counter=86 i=0 t=1.8e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=1 t=1.4e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=2 t=1.1e-01 per=2.1e+01 cost=8.2e+08 flops=7.1e+09
 sigma_tot[gemm] counter=86 i=3 t=1.1e-01 per=2.0e+01 cost=8.1e+08 flops=7.2e+09
 sigma_tot[gemm] counter=86 i=4 t=1.1e-01 per=2.0e+01 cost=6.6e+08 flops=5.9e+09
 sigma_tot[gemm] counter=86 i=5 t=1.1e-01 per=1.9e+01 cost=6.8e+08 flops=6.3e+09
 sigma_tot[gemm] counter=86 total t=4.5e-01 per=8.1e+01 cost=3.0e+09 flops=6.7e+09
 sigma_tot[red] counter=86 t=6.4e-02 per=1.2e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=5.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,2.4e-05,3.2e-06,9.3e-06,8.9e-07
    8   0 -    -116.527839729231 -5.698e-07  2.804e-04    3     8  1.384e-01 1.730e-02 7.525e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.043e-05,3.482e-04,3.086e-03,5.868e-04,4.072e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=3.453e-05 speed=8.377e-01GB/S t[comm(inter)]=5.901e-06 speed=4.901e+00GB/S
--- TIMING FOR sigma : t_inter=3.5e-04 t_gemm=3.1e-03 t_reduction=5.9e-04 tot=4.0e-03 ---
 sigma[inter] counter=87 t=3.5e-04 per=8.7e+00 cost=1.4e+07 flops=4.1e+10
 sigma[gemm] counter=87 i=0 t=2.0e-06 per=4.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=1 t=1.7e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=2 t=9.1e-04 per=2.3e+01 cost=1.3e+07 flops=1.5e+10
 sigma[gemm] counter=87 i=3 t=8.4e-04 per=2.1e+01 cost=1.3e+07 flops=1.6e+10
 sigma[gemm] counter=87 i=4 t=7.0e-04 per=1.7e+01 cost=1.2e+07 flops=1.7e+10
 sigma[gemm] counter=87 i=5 t=6.3e-04 per=1.6e+01 cost=1.2e+07 flops=1.9e+10
 sigma[gemm] counter=87 total t=3.1e-03 per=7.7e+01 cost=5.0e+07 flops=1.6e+10
 sigma[red] counter=87 t=5.9e-04 per=1.5e+01 cost=2.8e+06 flops=4.8e+09
--- TIMING FOR sigma_tot : t_inter=4.2e-02 t_gemm=4.5e-01 t_reduction=6.4e-02 tot=5.6e-01 ---
 sigma_tot[inter] counter=87 t=4.2e-02 per=7.6e+00 cost=8.9e+08 flops=2.1e+10
 sigma_tot[gemm] counter=87 i=0 t=1.8e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=1 t=1.4e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=2 t=1.2e-01 per=2.1e+01 cost=8.3e+08 flops=7.2e+09
 sigma_tot[gemm] counter=87 i=3 t=1.1e-01 per=2.0e+01 cost=8.2e+08 flops=7.3e+09
 sigma_tot[gemm] counter=87 i=4 t=1.1e-01 per=2.0e+01 cost=6.8e+08 flops=6.0e+09
 sigma_tot[gemm] counter=87 i=5 t=1.1e-01 per=1.9e+01 cost=6.9e+08 flops=6.4e+09
 sigma_tot[gemm] counter=87 total t=4.5e-01 per=8.1e+01 cost=3.0e+09 flops=6.7e+09
 sigma_tot[red] counter=87 t=6.4e-02 per=1.2e+01 cost=2.0e+08 flops=3.0e+09
T(sub)=4.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.5e-05,3.2e-06,8.1e-06,7.9e-07
    9   0 -    -116.527839847502 -1.183e-07  1.225e-04    3     9  1.531e-01 1.701e-02 7.155e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.162e-05,3.612e-04,3.091e-03,5.687e-04,4.074e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=3.610e-05 speed=8.013e-01GB/S t[comm(inter)]=5.524e-06 speed=5.236e+00GB/S
--- TIMING FOR sigma : t_inter=3.6e-04 t_gemm=3.1e-03 t_reduction=5.7e-04 tot=4.0e-03 ---
 sigma[inter] counter=88 t=3.6e-04 per=9.0e+00 cost=1.4e+07 flops=3.9e+10
 sigma[gemm] counter=88 i=0 t=2.0e-06 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=1 t=1.7e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=2 t=9.2e-04 per=2.3e+01 cost=1.3e+07 flops=1.5e+10
 sigma[gemm] counter=88 i=3 t=8.2e-04 per=2.1e+01 cost=1.3e+07 flops=1.6e+10
 sigma[gemm] counter=88 i=4 t=7.1e-04 per=1.8e+01 cost=1.2e+07 flops=1.7e+10
 sigma[gemm] counter=88 i=5 t=6.4e-04 per=1.6e+01 cost=1.2e+07 flops=1.9e+10
 sigma[gemm] counter=88 total t=3.1e-03 per=7.7e+01 cost=5.0e+07 flops=1.6e+10
 sigma[red] counter=88 t=5.7e-04 per=1.4e+01 cost=2.8e+06 flops=5.0e+09
--- TIMING FOR sigma_tot : t_inter=4.2e-02 t_gemm=4.5e-01 t_reduction=6.5e-02 tot=5.6e-01 ---
 sigma_tot[inter] counter=88 t=4.2e-02 per=7.6e+00 cost=9.0e+08 flops=2.1e+10
 sigma_tot[gemm] counter=88 i=0 t=1.8e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=1 t=1.4e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=2 t=1.2e-01 per=2.1e+01 cost=8.5e+08 flops=7.3e+09
 sigma_tot[gemm] counter=88 i=3 t=1.1e-01 per=2.0e+01 cost=8.3e+08 flops=7.3e+09
 sigma_tot[gemm] counter=88 i=4 t=1.1e-01 per=2.0e+01 cost=6.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=88 i=5 t=1.1e-01 per=1.9e+01 cost=7.1e+08 flops=6.5e+09
 sigma_tot[gemm] counter=88 total t=4.5e-01 per=8.1e+01 cost=3.1e+09 flops=6.8e+09
 sigma_tot[red] counter=88 t=6.5e-02 per=1.2e+01 cost=2.0e+08 flops=3.1e+09
T(sub)=4.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.5e-05,3.1e-06,9.1e-06,7.8e-07
   10   0 +    -116.527839869804 -2.230e-08  5.451e-05    3    10  1.675e-01 1.675e-02 6.860e-03
TIMING FOR Davidson : 1.676e-01  T(cal/comm/rest)=6.860e-02,1.333e-06,9.896e-02
decomposed t_rest=9.896e-02
 T(sub)    =5.106e-04 per=5.160e-01
 T(precond)=9.802e-02 per=9.906e+01
 T(ortho)  =8.873e-05 per=8.967e-02
 T(xcopy)  =5.515e-06 per=5.573e-03
 T(xnrm2)  =1.327e-05 per=1.341e-02
 T(other)  =3.152e-04 per=3.185e-01
optimized energies: isweep=0 ibond=11 dots=1 e[0]=-116.527839869804 nmvp=10
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.790e+02S Sys:2.723e+00S Total:9.817e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond11.txt
 qbond: qsuper nsym=18 dimAll=308
 (17,3):21 (19,3):42 (18,4):22 (18,2):46 (17,1):24 (19,1):35 (18,0):15 (20,2):30 (21,1):10 (20,0):10 (21,3):10 (20,4):18 (19,5):8 (16,2):9 (15,1):3 (16,0):3 (21,5):1 (20,6):1
timing for divide=1.5e-05
timing for compute=3.2e-04
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(nkr): 3.5e-04 S T(divide/compute/collect)=1.5e-05,3.2e-04,1.5e-05 -----
decimation summary: 308->68 dwt=-2.220e-16 SvN=1.873e+00
 qbond: qkept nsym=9 dimAll=68
 (19,3):14 (19,1):12 (21,3):10 (20,2):9 (18,2):7 (21,1):6 (20,4):6 (17,1):3 (21,5):1
----- TIMING for decimation_row(nkr): 9.392e-04 S T(decim/select/formRot)=4.273e-04,4.804e-04,3.150e-05 -----
----- TIMING FOR onedot_decimation: 1.106e-03 S T(wf/decim)=1.496e-04,9.560e-04 -----
ctns::oper_renorm coord=(12,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:26 S:14 H:1 P:91 Q:105 
        dim(bra,ket)=68,68 size(op)=652:4.974e-03MB size(tot)=87673:6.689e-01MB:6.532e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.790e+02S Sys:2.723e+00S Total:9.817e+02S
----- TIMING FOR symbolic_formulae_renorm with size=237 : 1.874e-02 S -----
rank=0 GPUmem(GB): used=0.00178 (oper)=0.00173
rank=0 GPUmem(GB): used=0.00179 (oper,site)(GB)=0.00173,1.45e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=518
 no. of coefficients=6216:0.0474MB:4.63e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 7.268e-04 S -----
rank=0 GPUmem(GB): used=0.00184 (oper,site,rinter)=0.00173,1.45e-05,4.63e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0112 S size(rtasks)=237 size(Rlst2)=81 T(Rmu/Rlist)=0.00278,0.00839 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0119 S size(rtasks)=237 size(Rlst)=8013 -----
rank=0 GPUmem(GB): used=0.00184 (oper,site,rinter,batch)=0.00173,1.45e-05,4.63e-05,0.0341 blksize=210 blksize0=150 batchsize=8013
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000739,0.0145,0.0037
--- TIMING FOR renorm : t_inter=7.4e-04 t_gemm=1.4e-02 t_reduction=3.7e-03 tot=1.9e-02 ---
 renorm[inter] counter=12 t=7.4e-04 per=3.9e+00 cost=7.1e+06 flops=9.6e+09
 renorm[gemm] counter=12 i=0 t=1.4e-06 per=7.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=1 t=1.1e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=2 t=1.1e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=3 t=1.1e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=4 t=3.5e-03 per=1.9e+01 cost=4.6e+06 flops=1.3e+09
 renorm[gemm] counter=12 i=5 t=4.4e-03 per=2.4e+01 cost=8.0e+06 flops=1.8e+09
 renorm[gemm] counter=12 i=6 t=6.5e-03 per=3.4e+01 cost=1.5e+07 flops=2.2e+09
 renorm[gemm] counter=12 total t=1.4e-02 per=7.7e+01 cost=2.7e+07 flops=1.9e+09
 renorm[red] counter=12 t=3.7e-03 per=2.0e+01 cost=1.4e+06 flops=3.7e+08
--- TIMING FOR renorm_tot : t_inter=8.3e-03 t_gemm=1.0e-01 t_reduction=2.3e-02 tot=1.3e-01 ---
 renorm_tot[inter] counter=12 t=8.3e-03 per=6.2e+00 cost=5.0e+07 flops=6.0e+09
 renorm_tot[gemm] counter=12 i=0 t=1.7e-05 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=1 t=1.4e-05 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=2 t=1.4e-05 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=3 t=1.4e-05 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=4 t=2.7e-02 per=2.1e+01 cost=2.3e+07 flops=8.3e+08
 renorm_tot[gemm] counter=12 i=5 t=3.5e-02 per=2.7e+01 cost=4.4e+07 flops=1.2e+09
 renorm_tot[gemm] counter=12 i=6 t=3.9e-02 per=2.9e+01 cost=9.0e+07 flops=2.3e+09
 renorm_tot[gemm] counter=12 total t=1.0e-01 per=7.7e+01 cost=1.6e+08 flops=1.5e+09
 renorm_tot[red] counter=12 t=2.3e-02 per=1.7e+01 cost=1.1e+07 flops=4.9e+08
qops.to_cpu: size(tot)=87673:6.7e-01MB:6.5e-04GB t[to_cpu]=1.7e-04S speed=4.0e+00GB/S
check ||H-H.dagger||=9.673e-14 coord=(12,0) rank=0
ctns::oper_ab2pq coord=(12,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.101 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.791e+02S Sys:2.723e+00S Total:9.818e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1493:1.139e-02MB:1.112e-05GB
total mem of comb=16660:1.271e-01MB:1.241e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.791e+02S Sys:2.723e+00S Total:9.818e+02S
##### local opt: 4.169e-01 S #####
 T(local opt: fetch) = 1.132e-02 S  per = 2.72  per(accum) = 2.72
 T(local opt: hdiag) = 2.407e-03 S  per = 0.577  per(accum) = 3.29
 T(local opt: dvdsn) = 2.977e-01 S  per = 71.4  per(accum) = 74.7
 T(local opt: decim) = 1.113e-03 S  per = 0.267  per(accum) = 75
 T(local opt: guess) = 2.428e-04 S  per = 0.0582  per(accum) = 75
 T(local opt: renrm) = 1.018e-01 S  per = 24.4  per(accum) = 99.5
 T(local opt: save ) = 2.260e-03 S  per = 0.542  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.977e-01 S  T(sum) = 2.974e-01 S  per = 9.989e+01
 T(local opt: preprocess                  ) = 3.995e-04 S  per = 0.134  per(accum) = 0.134
 T(local opt: symbolic_formulae           ) = 1.911e-02 S  per = 6.43  per(accum) = 6.56
 T(local opt: hintermediate init          ) = 4.278e-04 S  per = 0.144  per(accum) = 6.71
 T(local opt: preprocess_hformulae_Hxlist ) = 1.781e-02 S  per = 5.99  per(accum) = 12.7
 T(local opt: hmmtasks init               ) = 9.207e-02 S  per =   31  per(accum) = 43.7
 T(local opt: initial guess for dvdson    ) = 1.221e-05 S  per = 0.00411  per(accum) = 43.7
 T(local opt: dvdson solver [Hx_batchGPU] ) = 6.821e-02 S  per = 22.9  per(accum) = 66.6
 T(local opt: dvdson solver [comm(gpu)]   ) = 3.911e-04 S  per = 0.131  per(accum) = 66.7
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.333e-06 S  per = 0.000448  per(accum) = 66.7
 T(local opt: dvdson solver [rest part]   ) = 9.896e-02 S  per = 33.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.018e-01 S  T(sum) = 1.018e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.440e-04 S  per = 0.24  per(accum) = 0.24
 T(local opt: qops init                    ) = 2.656e-03 S  per = 2.61  per(accum) = 2.85
 T(local opt: symbolic_formulae_renorm     ) = 1.876e-02 S  per = 18.4  per(accum) = 21.3
 T(local opt: allocate qops on gpu         ) = 1.775e-04 S  per = 0.174  per(accum) = 21.4
 T(local opt: site memcpy cpu2gpu          ) = 2.247e-05 S  per = 0.0221  per(accum) = 21.5
 T(local opt: rintermediate init           ) = 7.382e-04 S  per = 0.725  per(accum) = 22.2
 T(local opt: preprocess_formulae_Rlist2   ) = 1.212e-02 S  per = 11.9  per(accum) = 34.1
 T(local opt: rmmtasks init                ) = 4.701e-02 S  per = 46.2  per(accum) = 80.3
 T(local opt: qops memset on cpu           ) = 2.900e-08 S  per = 2.85e-05  per(accum) = 80.3
 T(local opt: preprocess_renorm_batchGPU   ) = 1.901e-02 S  per = 18.7  per(accum) = 98.9
 T(local opt: reduction of opS & opH [nccl]) = 9.170e-07 S  per = 0.000901  per(accum) = 98.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.713e-04 S  per = 0.168  per(accum) = 99.1
 T(local opt: deallocate cpu and gpu memory) = 1.268e-04 S  per = 0.125  per(accum) = 99.2
 T(local opt: reduction of opS & opH [comm]) = 4.477e-05 S  per = 0.044  per(accum) = 99.3
 T(local opt: conversion from opAB to opPQ ) = 3.880e-06 S  per = 0.00381  per(accum) = 99.3
 T(local opt: after oper_renorm            ) = 7.327e-04 S  per = 0.72  per(accum) = 100
##### sweep opt: 9.042e+00 S #####
 T(sweep opt: fetch) = 1.639e-01 S  per = 1.81  per(accum) = 1.81
 T(sweep opt: hdiag) = 3.039e-02 S  per = 0.336  per(accum) = 2.15
 T(sweep opt: dvdsn) = 3.736e+00 S  per = 41.3  per(accum) = 43.5
 T(sweep opt: decim) = 1.498e-02 S  per = 0.166  per(accum) = 43.6
 T(sweep opt: guess) = 3.764e-03 S  per = 0.0416  per(accum) = 43.7
 T(sweep opt: renrm) = 5.062e+00 S  per =   56  per(accum) = 99.6
 T(sweep opt: save ) = 3.176e-02 S  per = 0.351  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.736e+00 S  T(sum) = 3.457e+00 S  per = 9.253e+01
 T(sweep opt: preprocess                  ) = 5.869e-03 S  per = 0.17  per(accum) = 0.17
 T(sweep opt: symbolic_formulae           ) = 2.020e-01 S  per = 5.85  per(accum) = 6.01
 T(sweep opt: hintermediate init          ) = 4.713e-03 S  per = 0.136  per(accum) = 6.15
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.502e-01 S  per = 7.24  per(accum) = 13.4
 T(sweep opt: hmmtasks init               ) = 1.787e+00 S  per = 51.7  per(accum) = 65.1
 T(sweep opt: initial guess for dvdson    ) = 1.148e-04 S  per = 0.00332  per(accum) = 65.1
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 5.769e-01 S  per = 16.7  per(accum) = 81.8
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 3.175e-03 S  per = 0.0919  per(accum) = 81.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.146e-05 S  per = 0.000331  per(accum) = 81.9
 T(sweep opt: dvdson solver [rest part]   ) = 6.263e-01 S  per = 18.1  per(accum) = 100
Detailed decomposition of T(renrm) = 5.062e+00 S  T(sum) = 5.062e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.374e-03 S  per = 0.106  per(accum) = 0.106
 T(sweep opt: qops init                    ) = 4.947e-02 S  per = 0.977  per(accum) = 1.08
 T(sweep opt: symbolic_formulae_renorm     ) = 1.483e-01 S  per = 2.93  per(accum) = 4.01
 T(sweep opt: allocate qops on gpu         ) = 1.130e-03 S  per = 0.0223  per(accum) = 4.03
 T(sweep opt: site memcpy cpu2gpu          ) = 2.632e-04 S  per = 0.0052  per(accum) = 4.04
 T(sweep opt: rintermediate init           ) = 6.663e-03 S  per = 0.132  per(accum) = 4.17
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.374e-01 S  per = 2.71  per(accum) = 6.89
 T(sweep opt: rmmtasks init                ) = 5.528e-01 S  per = 10.9  per(accum) = 17.8
 T(sweep opt: qops memset on cpu           ) = 6.590e-07 S  per = 1.3e-05  per(accum) = 17.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.341e-01 S  per = 2.65  per(accum) = 20.5
 T(sweep opt: reduction of opS & opH [nccl]) = 1.259e-05 S  per = 0.000249  per(accum) = 20.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.109e-03 S  per = 0.0417  per(accum) = 20.5
 T(sweep opt: deallocate cpu and gpu memory) = 1.961e-01 S  per = 3.87  per(accum) = 24.4
 T(sweep opt: reduction of opS & opH [comm]) = 5.342e-04 S  per = 0.0106  per(accum) = 24.4
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 75.4  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 8.629e-03 S  per = 0.17  per(accum) = 100
##### global opt: 9.042e+00 S #####
 T(global opt: fetch) = 1.639e-01 S  per = 1.81  per(accum) = 1.81
 T(global opt: hdiag) = 3.039e-02 S  per = 0.336  per(accum) = 2.15
 T(global opt: dvdsn) = 3.736e+00 S  per = 41.3  per(accum) = 43.5
 T(global opt: decim) = 1.498e-02 S  per = 0.166  per(accum) = 43.6
 T(global opt: guess) = 3.764e-03 S  per = 0.0416  per(accum) = 43.7
 T(global opt: renrm) = 5.062e+00 S  per =   56  per(accum) = 99.6
 T(global opt: save ) = 3.176e-02 S  per = 0.351  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.736e+00 S  T(sum) = 3.457e+00 S  per = 9.253e+01
 T(global opt: preprocess                  ) = 5.869e-03 S  per = 0.17  per(accum) = 0.17
 T(global opt: symbolic_formulae           ) = 2.020e-01 S  per = 5.85  per(accum) = 6.01
 T(global opt: hintermediate init          ) = 4.713e-03 S  per = 0.136  per(accum) = 6.15
 T(global opt: preprocess_hformulae_Hxlist ) = 2.502e-01 S  per = 7.24  per(accum) = 13.4
 T(global opt: hmmtasks init               ) = 1.787e+00 S  per = 51.7  per(accum) = 65.1
 T(global opt: initial guess for dvdson    ) = 1.148e-04 S  per = 0.00332  per(accum) = 65.1
 T(global opt: dvdson solver [Hx_batchGPU] ) = 5.769e-01 S  per = 16.7  per(accum) = 81.8
 T(global opt: dvdson solver [comm(gpu)]   ) = 3.175e-03 S  per = 0.0919  per(accum) = 81.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.146e-05 S  per = 0.000331  per(accum) = 81.9
 T(global opt: dvdson solver [rest part]   ) = 6.263e-01 S  per = 18.1  per(accum) = 100
Detailed decomposition of T(renrm) = 5.062e+00 S  T(sum) = 5.062e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.374e-03 S  per = 0.106  per(accum) = 0.106
 T(global opt: qops init                    ) = 4.947e-02 S  per = 0.977  per(accum) = 1.08
 T(global opt: symbolic_formulae_renorm     ) = 1.483e-01 S  per = 2.93  per(accum) = 4.01
 T(global opt: allocate qops on gpu         ) = 1.130e-03 S  per = 0.0223  per(accum) = 4.03
 T(global opt: site memcpy cpu2gpu          ) = 2.632e-04 S  per = 0.0052  per(accum) = 4.04
 T(global opt: rintermediate init           ) = 6.663e-03 S  per = 0.132  per(accum) = 4.17
 T(global opt: preprocess_formulae_Rlist2   ) = 1.374e-01 S  per = 2.71  per(accum) = 6.89
 T(global opt: rmmtasks init                ) = 5.528e-01 S  per = 10.9  per(accum) = 17.8
 T(global opt: qops memset on cpu           ) = 6.590e-07 S  per = 1.3e-05  per(accum) = 17.8
 T(global opt: preprocess_renorm_batchGPU   ) = 1.341e-01 S  per = 2.65  per(accum) = 20.5
 T(global opt: reduction of opS & opH [nccl]) = 1.259e-05 S  per = 0.000249  per(accum) = 20.5
 T(global opt: qops memcpy gpu2cpu          ) = 2.109e-03 S  per = 0.0417  per(accum) = 20.5
 T(global opt: deallocate cpu and gpu memory) = 1.961e-01 S  per = 3.87  per(accum) = 24.4
 T(global opt: reduction of opS & opH [comm]) = 5.342e-04 S  per = 0.0106  per(accum) = 24.4
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 75.4  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 8.629e-03 S  per = 0.17  per(accum) = 100

isweep=0 ibond=12/seqsize=34 dots=1 dbond=(13,0)-(14,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.791e+02S Sys:2.723e+00S Total:9.818e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1493:1.139e-02MB:1.112e-05GB
total mem of comb=16660:1.271e-01MB:1.241e-04GB
ctns::topology::check_partition: (sl,sr,sc)=13,6,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc= 9
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:26 S:14 H:1 P:91 Q:105 
        dim(bra,ket)=68,68 size(op)=652:4.974e-03MB size(tot)=87673:6.689e-01MB:6.532e-04GB
 rqops: oplist=CSHAB nops=C:12 S:28 H:1 A:66 B:78 
        dim(bra,ket)=58,58 size(op)=472:3.601e-03MB size(tot)=49386:3.768e-01MB:3.680e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=139395:1.063e+00MB:1.039e-03GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(13,0) fdel=./scratch/sweep/rop(14,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
wf3(diml,dimr,dimc)=(68,58,4) nnz=1493:1.139e-02MB
qtensor3: wf3 own=1 _data=0x5308fa60
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=68
 (19,3):14 (19,1):12 (21,3):10 (20,2):9 (18,2):7 (21,1):6 (20,4):6 (17,1):3 (21,5):1
 qbond: qcol nsym=9 dimAll=58
 (9,-3):11 (8,-2):9 (7,-3):9 (9,-1):9 (10,-2):8 (8,-4):5 (7,-1):3 (11,-1):3 (7,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=23 nblocks=324 size=1493:1.139e-02MB
### DIAG TIMING: total=1.669e-03 t1=1.188e-05, t2=1.327e-05, t3=2.903e-05, t4=1.591e-03, t5=5.911e-06, t6=1.496e-05, t7=2.869e-06
duration_diagGPU:1.679e-03
duration_diagreduce:3.800e-08
duration_diagtransform:5.462e-06
----- TIMING FOR symbolic_formulae_onedot with size=813 : 1.487e-02 S -----
rank=0 GPUmem(GB): used=0.00104 (oper)=0.00104
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=813
 no. of hintermediate operators=390
 no. of coefficients=5070:0.0387MB:3.78e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.117e-04 S -----
rank=0 GPUmem(GB): used=0.00108 (oper,hinter)=0.00104,3.78e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0128 S size(H_formulae)=813 size(Hxlst2)=23 T(Hmu/Hxlist)=0.00185,0.011 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0138 S size(H_formulae)=813 size(Hxlst)=12102 -----
rank=0 GPUmem(GB): used=0.0403 (oper,hinter,dvdson,batch)=0.00104,3.78e-05,2.22e-05,0.0392 blksize=154 blksize0=126 batchsize=12102
ctns::pdvdsonSolver_nkr::solve_iter ndim=1493 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.24e-05,0.000926,0.0296,0.00203,0.0326
 ndim=1493:1.11e-05GB t[comm(intra)]=2.71e-05 speed=0.822GB/S t[comm(inter)]=5.29e-06 speed=4.21GB/S
--- TIMING FOR sigma : t_inter=9.3e-04 t_gemm=3.0e-02 t_reduction=2.0e-03 tot=3.3e-02 ---
 sigma[inter] counter=89 t=9.3e-04 per=2.8e+00 cost=9.3e+06 flops=1.0e+10
 sigma[gemm] counter=89 i=0 t=1.3e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=1 t=1.1e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=2 t=6.4e-03 per=2.0e+01 cost=6.9e+06 flops=1.1e+09
 sigma[gemm] counter=89 i=3 t=8.8e-03 per=2.7e+01 cost=6.7e+06 flops=7.6e+08
 sigma[gemm] counter=89 i=4 t=7.5e-03 per=2.3e+01 cost=6.3e+06 flops=8.4e+08
 sigma[gemm] counter=89 i=5 t=6.8e-03 per=2.1e+01 cost=6.4e+06 flops=9.4e+08
 sigma[gemm] counter=89 total t=3.0e-02 per=9.1e+01 cost=2.6e+07 flops=8.9e+08
 sigma[red] counter=89 t=2.0e-03 per=6.2e+00 cost=1.7e+06 flops=8.5e+08
--- TIMING FOR sigma_tot : t_inter=4.3e-02 t_gemm=4.8e-01 t_reduction=6.7e-02 tot=5.9e-01 ---
 sigma_tot[inter] counter=89 t=4.3e-02 per=7.3e+00 cost=9.1e+08 flops=2.1e+10
 sigma_tot[gemm] counter=89 i=0 t=1.8e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=1 t=1.4e-04 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=2 t=1.2e-01 per=2.1e+01 cost=8.5e+08 flops=6.9e+09
 sigma_tot[gemm] counter=89 i=3 t=1.2e-01 per=2.1e+01 cost=8.4e+08 flops=6.9e+09
 sigma_tot[gemm] counter=89 i=4 t=1.2e-01 per=2.0e+01 cost=6.9e+08 flops=5.7e+09
 sigma_tot[gemm] counter=89 i=5 t=1.2e-01 per=2.0e+01 cost=7.1e+08 flops=6.2e+09
 sigma_tot[gemm] counter=89 total t=4.8e-01 per=8.1e+01 cost=3.1e+09 flops=6.4e+09
 sigma_tot[red] counter=89 t=6.7e-02 per=1.1e+01 cost=2.0e+08 flops=3.0e+09
T(sub)=1.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,4.5e-06,1.8e-06,2.2e-06,7.0e-07
settings: ndim=1493 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.527839869804 -1.117e+03  6.284e-02    1     1  3.271e-02 3.271e-02 3.268e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.955e-05,2.881e-04,3.401e-03,5.496e-04,4.289e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=3.408e-05 speed=6.528e-01GB/S t[comm(inter)]=5.465e-06 speed=4.071e+00GB/S
--- TIMING FOR sigma : t_inter=2.9e-04 t_gemm=3.4e-03 t_reduction=5.5e-04 tot=4.2e-03 ---
 sigma[inter] counter=90 t=2.9e-04 per=6.8e+00 cost=9.3e+06 flops=3.2e+10
 sigma[gemm] counter=90 i=0 t=1.9e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=1 t=1.7e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=2 t=8.7e-04 per=2.1e+01 cost=6.9e+06 flops=7.9e+09
 sigma[gemm] counter=90 i=3 t=8.2e-04 per=1.9e+01 cost=6.7e+06 flops=8.2e+09
 sigma[gemm] counter=90 i=4 t=8.9e-04 per=2.1e+01 cost=6.3e+06 flops=7.1e+09
 sigma[gemm] counter=90 i=5 t=8.1e-04 per=1.9e+01 cost=6.4e+06 flops=7.9e+09
 sigma[gemm] counter=90 total t=3.4e-03 per=8.0e+01 cost=2.6e+07 flops=7.7e+09
 sigma[red] counter=90 t=5.5e-04 per=1.3e+01 cost=1.7e+06 flops=3.1e+09
--- TIMING FOR sigma_tot : t_inter=4.4e-02 t_gemm=4.9e-01 t_reduction=6.7e-02 tot=6.0e-01 ---
 sigma_tot[inter] counter=90 t=4.4e-02 per=7.3e+00 cost=9.2e+08 flops=2.1e+10
 sigma_tot[gemm] counter=90 i=0 t=1.9e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=1 t=1.5e-04 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=2 t=1.2e-01 per=2.1e+01 cost=8.6e+08 flops=6.9e+09
 sigma_tot[gemm] counter=90 i=3 t=1.2e-01 per=2.1e+01 cost=8.5e+08 flops=6.9e+09
 sigma_tot[gemm] counter=90 i=4 t=1.2e-01 per=2.0e+01 cost=7.0e+08 flops=5.7e+09
 sigma_tot[gemm] counter=90 i=5 t=1.2e-01 per=1.9e+01 cost=7.2e+08 flops=6.2e+09
 sigma_tot[gemm] counter=90 total t=4.9e-01 per=8.1e+01 cost=3.1e+09 flops=6.4e+09
 sigma_tot[red] counter=90 t=6.7e-02 per=1.1e+01 cost=2.0e+08 flops=3.0e+09
T(sub)=4.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.4e-05,1.4e-05,5.0e-06,8.2e-07
    2   0 -    -116.531980292075 -4.140e-03  2.206e-02    2     2  5.171e-02 2.586e-02 1.855e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.973e-05,2.922e-04,3.463e-03,5.392e-04,4.344e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=3.456e-05 speed=6.438e-01GB/S t[comm(inter)]=5.173e-06 speed=4.301e+00GB/S
--- TIMING FOR sigma : t_inter=2.9e-04 t_gemm=3.5e-03 t_reduction=5.4e-04 tot=4.3e-03 ---
 sigma[inter] counter=91 t=2.9e-04 per=6.8e+00 cost=9.3e+06 flops=3.2e+10
 sigma[gemm] counter=91 i=0 t=2.0e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=1 t=1.7e-06 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=2 t=8.8e-04 per=2.1e+01 cost=6.9e+06 flops=7.8e+09
 sigma[gemm] counter=91 i=3 t=8.3e-04 per=1.9e+01 cost=6.7e+06 flops=8.1e+09
 sigma[gemm] counter=91 i=4 t=9.1e-04 per=2.1e+01 cost=6.3e+06 flops=7.0e+09
 sigma[gemm] counter=91 i=5 t=8.4e-04 per=2.0e+01 cost=6.4e+06 flops=7.6e+09
 sigma[gemm] counter=91 total t=3.5e-03 per=8.1e+01 cost=2.6e+07 flops=7.6e+09
 sigma[red] counter=91 t=5.4e-04 per=1.3e+01 cost=1.7e+06 flops=3.2e+09
--- TIMING FOR sigma_tot : t_inter=4.4e-02 t_gemm=4.9e-01 t_reduction=6.8e-02 tot=6.0e-01 ---
 sigma_tot[inter] counter=91 t=4.4e-02 per=7.3e+00 cost=9.3e+08 flops=2.1e+10
 sigma_tot[gemm] counter=91 i=0 t=1.9e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=1 t=1.5e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=2 t=1.2e-01 per=2.1e+01 cost=8.7e+08 flops=7.0e+09
 sigma_tot[gemm] counter=91 i=3 t=1.2e-01 per=2.1e+01 cost=8.5e+08 flops=6.9e+09
 sigma_tot[gemm] counter=91 i=4 t=1.2e-01 per=2.0e+01 cost=7.1e+08 flops=5.7e+09
 sigma_tot[gemm] counter=91 i=5 t=1.2e-01 per=1.9e+01 cost=7.2e+08 flops=6.2e+09
 sigma_tot[gemm] counter=91 total t=4.9e-01 per=8.1e+01 cost=3.2e+09 flops=6.4e+09
 sigma_tot[red] counter=91 t=6.8e-02 per=1.1e+01 cost=2.0e+08 flops=3.0e+09
T(sub)=5.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.6e-05,1.6e-05,1.3e-05,7.8e-06,7.1e-07
    3   0 -    -116.532689562333 -7.093e-04  9.976e-03    3     3  7.056e-02 2.352e-02 1.386e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.854e-05,2.878e-04,3.429e-03,5.175e-04,4.282e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=2.272e-05 speed=9.792e-01GB/S t[comm(inter)]=1.582e-05 speed=1.406e+00GB/S
--- TIMING FOR sigma : t_inter=2.9e-04 t_gemm=3.4e-03 t_reduction=5.2e-04 tot=4.2e-03 ---
 sigma[inter] counter=92 t=2.9e-04 per=6.8e+00 cost=9.3e+06 flops=3.2e+10
 sigma[gemm] counter=92 i=0 t=2.0e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=1 t=1.8e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=2 t=8.8e-04 per=2.1e+01 cost=6.9e+06 flops=7.8e+09
 sigma[gemm] counter=92 i=3 t=8.2e-04 per=1.9e+01 cost=6.7e+06 flops=8.2e+09
 sigma[gemm] counter=92 i=4 t=9.1e-04 per=2.1e+01 cost=6.3e+06 flops=7.0e+09
 sigma[gemm] counter=92 i=5 t=8.2e-04 per=1.9e+01 cost=6.4e+06 flops=7.8e+09
 sigma[gemm] counter=92 total t=3.4e-03 per=8.1e+01 cost=2.6e+07 flops=7.7e+09
 sigma[red] counter=92 t=5.2e-04 per=1.2e+01 cost=1.7e+06 flops=3.3e+09
--- TIMING FOR sigma_tot : t_inter=4.4e-02 t_gemm=4.9e-01 t_reduction=6.8e-02 tot=6.1e-01 ---
 sigma_tot[inter] counter=92 t=4.4e-02 per=7.3e+00 cost=9.4e+08 flops=2.1e+10
 sigma_tot[gemm] counter=92 i=0 t=1.9e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=1 t=1.5e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=2 t=1.3e-01 per=2.1e+01 cost=8.7e+08 flops=7.0e+09
 sigma_tot[gemm] counter=92 i=3 t=1.2e-01 per=2.1e+01 cost=8.6e+08 flops=6.9e+09
 sigma_tot[gemm] counter=92 i=4 t=1.2e-01 per=2.0e+01 cost=7.1e+08 flops=5.8e+09
 sigma_tot[gemm] counter=92 i=5 t=1.2e-01 per=1.9e+01 cost=7.3e+08 flops=6.2e+09
 sigma_tot[gemm] counter=92 total t=4.9e-01 per=8.1e+01 cost=3.2e+09 flops=6.5e+09
 sigma_tot[red] counter=92 t=6.8e-02 per=1.1e+01 cost=2.0e+08 flops=3.0e+09
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.5e-05,1.3e-05,7.6e-06,7.2e-07
    4   0 -    -116.532886571404 -1.970e-04  5.657e-03    3     4  8.920e-02 2.230e-02 1.150e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.656e-05,2.803e-04,3.402e-03,5.248e-04,4.253e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=3.150e-05 speed=7.062e-01GB/S t[comm(inter)]=5.056e-06 speed=4.400e+00GB/S
--- TIMING FOR sigma : t_inter=2.8e-04 t_gemm=3.4e-03 t_reduction=5.2e-04 tot=4.2e-03 ---
 sigma[inter] counter=93 t=2.8e-04 per=6.7e+00 cost=9.3e+06 flops=3.3e+10
 sigma[gemm] counter=93 i=0 t=1.9e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=1 t=1.7e-06 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=2 t=8.7e-04 per=2.1e+01 cost=6.9e+06 flops=7.9e+09
 sigma[gemm] counter=93 i=3 t=8.2e-04 per=1.9e+01 cost=6.7e+06 flops=8.2e+09
 sigma[gemm] counter=93 i=4 t=8.8e-04 per=2.1e+01 cost=6.3e+06 flops=7.2e+09
 sigma[gemm] counter=93 i=5 t=8.2e-04 per=2.0e+01 cost=6.4e+06 flops=7.8e+09
 sigma[gemm] counter=93 total t=3.4e-03 per=8.1e+01 cost=2.6e+07 flops=7.7e+09
 sigma[red] counter=93 t=5.2e-04 per=1.2e+01 cost=1.7e+06 flops=3.3e+09
--- TIMING FOR sigma_tot : t_inter=4.5e-02 t_gemm=5.0e-01 t_reduction=6.9e-02 tot=6.1e-01 ---
 sigma_tot[inter] counter=93 t=4.5e-02 per=7.3e+00 cost=9.5e+08 flops=2.1e+10
 sigma_tot[gemm] counter=93 i=0 t=1.9e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=1 t=1.5e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=2 t=1.3e-01 per=2.1e+01 cost=8.8e+08 flops=7.0e+09
 sigma_tot[gemm] counter=93 i=3 t=1.3e-01 per=2.1e+01 cost=8.7e+08 flops=6.9e+09
 sigma_tot[gemm] counter=93 i=4 t=1.2e-01 per=2.0e+01 cost=7.2e+08 flops=5.8e+09
 sigma_tot[gemm] counter=93 i=5 t=1.2e-01 per=1.9e+01 cost=7.4e+08 flops=6.2e+09
 sigma_tot[gemm] counter=93 total t=5.0e-01 per=8.1e+01 cost=3.2e+09 flops=6.5e+09
 sigma_tot[red] counter=93 t=6.9e-02 per=1.1e+01 cost=2.1e+08 flops=3.0e+09
T(sub)=5.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.5e-05,3.3e-06,1.7e-05,7.1e-07
    5   0 -    -116.532935598249 -4.903e-05  2.564e-03    3     5  1.079e-01 2.158e-02 1.007e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.639e-05,2.808e-04,3.394e-03,5.287e-04,4.250e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=2.177e-05 speed=1.022e+00GB/S t[comm(inter)]=1.461e-05 speed=1.522e+00GB/S
--- TIMING FOR sigma : t_inter=2.8e-04 t_gemm=3.4e-03 t_reduction=5.3e-04 tot=4.2e-03 ---
 sigma[inter] counter=94 t=2.8e-04 per=6.7e+00 cost=9.3e+06 flops=3.3e+10
 sigma[gemm] counter=94 i=0 t=2.0e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=1 t=1.8e-06 per=4.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=2 t=8.6e-04 per=2.0e+01 cost=6.9e+06 flops=8.0e+09
 sigma[gemm] counter=94 i=3 t=8.3e-04 per=2.0e+01 cost=6.7e+06 flops=8.1e+09
 sigma[gemm] counter=94 i=4 t=9.0e-04 per=2.1e+01 cost=6.3e+06 flops=7.1e+09
 sigma[gemm] counter=94 i=5 t=8.0e-04 per=1.9e+01 cost=6.4e+06 flops=8.0e+09
 sigma[gemm] counter=94 total t=3.4e-03 per=8.1e+01 cost=2.6e+07 flops=7.8e+09
 sigma[red] counter=94 t=5.3e-04 per=1.3e+01 cost=1.7e+06 flops=3.3e+09
--- TIMING FOR sigma_tot : t_inter=4.5e-02 t_gemm=5.0e-01 t_reduction=7.0e-02 tot=6.1e-01 ---
 sigma_tot[inter] counter=94 t=4.5e-02 per=7.3e+00 cost=9.6e+08 flops=2.1e+10
 sigma_tot[gemm] counter=94 i=0 t=1.9e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=1 t=1.5e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=2 t=1.3e-01 per=2.1e+01 cost=8.9e+08 flops=7.0e+09
 sigma_tot[gemm] counter=94 i=3 t=1.3e-01 per=2.1e+01 cost=8.7e+08 flops=6.9e+09
 sigma_tot[gemm] counter=94 i=4 t=1.3e-01 per=2.1e+01 cost=7.3e+08 flops=5.8e+09
 sigma_tot[gemm] counter=94 i=5 t=1.2e-01 per=1.9e+01 cost=7.4e+08 flops=6.2e+09
 sigma_tot[gemm] counter=94 total t=5.0e-01 per=8.1e+01 cost=3.2e+09 flops=6.5e+09
 sigma_tot[red] counter=94 t=7.0e-02 per=1.1e+01 cost=2.1e+08 flops=3.0e+09
T(sub)=5.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.6e-05,2.5e-05,3.5e-06,7.6e-06,7.5e-07
    6   0 -    -116.532944609616 -9.011e-06  1.015e-03    3     6  1.267e-01 2.112e-02 9.124e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.710e-05,2.980e-04,3.381e-03,5.238e-04,4.250e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=2.183e-05 speed=1.019e+00GB/S t[comm(inter)]=1.526e-05 speed=1.458e+00GB/S
--- TIMING FOR sigma : t_inter=3.0e-04 t_gemm=3.4e-03 t_reduction=5.2e-04 tot=4.2e-03 ---
 sigma[inter] counter=95 t=3.0e-04 per=7.1e+00 cost=9.3e+06 flops=3.1e+10
 sigma[gemm] counter=95 i=0 t=2.0e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=1 t=1.8e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=2 t=8.4e-04 per=2.0e+01 cost=6.9e+06 flops=8.2e+09
 sigma[gemm] counter=95 i=3 t=8.4e-04 per=2.0e+01 cost=6.7e+06 flops=8.0e+09
 sigma[gemm] counter=95 i=4 t=8.9e-04 per=2.1e+01 cost=6.3e+06 flops=7.1e+09
 sigma[gemm] counter=95 i=5 t=8.1e-04 per=1.9e+01 cost=6.4e+06 flops=7.9e+09
 sigma[gemm] counter=95 total t=3.4e-03 per=8.0e+01 cost=2.6e+07 flops=7.8e+09
 sigma[red] counter=95 t=5.2e-04 per=1.2e+01 cost=1.7e+06 flops=3.3e+09
--- TIMING FOR sigma_tot : t_inter=4.5e-02 t_gemm=5.0e-01 t_reduction=7.0e-02 tot=6.2e-01 ---
 sigma_tot[inter] counter=95 t=4.5e-02 per=7.3e+00 cost=9.6e+08 flops=2.1e+10
 sigma_tot[gemm] counter=95 i=0 t=2.0e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=1 t=1.5e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=2 t=1.3e-01 per=2.1e+01 cost=8.9e+08 flops=7.0e+09
 sigma_tot[gemm] counter=95 i=3 t=1.3e-01 per=2.1e+01 cost=8.8e+08 flops=6.9e+09
 sigma_tot[gemm] counter=95 i=4 t=1.3e-01 per=2.1e+01 cost=7.3e+08 flops=5.8e+09
 sigma_tot[gemm] counter=95 i=5 t=1.2e-01 per=1.9e+01 cost=7.5e+08 flops=6.2e+09
 sigma_tot[gemm] counter=95 total t=5.0e-01 per=8.1e+01 cost=3.3e+09 flops=6.5e+09
 sigma_tot[red] counter=95 t=7.0e-02 per=1.1e+01 cost=2.1e+08 flops=3.0e+09
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,2.5e-05,3.6e-06,7.5e-06,7.4e-07
    7   0 -    -116.532946093325 -1.484e-06  4.720e-04    3     7  1.443e-01 2.062e-02 8.446e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.765e-05,2.848e-04,3.405e-03,5.265e-04,4.264e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=3.213e-05 speed=6.925e-01GB/S t[comm(inter)]=5.521e-06 speed=4.030e+00GB/S
--- TIMING FOR sigma : t_inter=2.8e-04 t_gemm=3.4e-03 t_reduction=5.3e-04 tot=4.2e-03 ---
 sigma[inter] counter=96 t=2.8e-04 per=6.8e+00 cost=9.3e+06 flops=3.3e+10
 sigma[gemm] counter=96 i=0 t=2.0e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=1 t=1.8e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=2 t=8.7e-04 per=2.1e+01 cost=6.9e+06 flops=7.9e+09
 sigma[gemm] counter=96 i=3 t=8.2e-04 per=1.9e+01 cost=6.7e+06 flops=8.2e+09
 sigma[gemm] counter=96 i=4 t=8.8e-04 per=2.1e+01 cost=6.3e+06 flops=7.2e+09
 sigma[gemm] counter=96 i=5 t=8.2e-04 per=1.9e+01 cost=6.4e+06 flops=7.8e+09
 sigma[gemm] counter=96 total t=3.4e-03 per=8.1e+01 cost=2.6e+07 flops=7.7e+09
 sigma[red] counter=96 t=5.3e-04 per=1.2e+01 cost=1.7e+06 flops=3.3e+09
--- TIMING FOR sigma_tot : t_inter=4.5e-02 t_gemm=5.1e-01 t_reduction=7.1e-02 tot=6.2e-01 ---
 sigma_tot[inter] counter=96 t=4.5e-02 per=7.3e+00 cost=9.7e+08 flops=2.1e+10
 sigma_tot[gemm] counter=96 i=0 t=2.0e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=1 t=1.6e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=2 t=1.3e-01 per=2.1e+01 cost=9.0e+08 flops=7.0e+09
 sigma_tot[gemm] counter=96 i=3 t=1.3e-01 per=2.1e+01 cost=8.9e+08 flops=6.9e+09
 sigma_tot[gemm] counter=96 i=4 t=1.3e-01 per=2.1e+01 cost=7.4e+08 flops=5.8e+09
 sigma_tot[gemm] counter=96 i=5 t=1.2e-01 per=1.9e+01 cost=7.6e+08 flops=6.2e+09
 sigma_tot[gemm] counter=96 total t=5.1e-01 per=8.1e+01 cost=3.3e+09 flops=6.5e+09
 sigma_tot[red] counter=96 t=7.1e-02 per=1.1e+01 cost=2.1e+08 flops=3.0e+09
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,1.5e-05,3.0e-06,6.5e-06,5.8e-07
    8   0 -    -116.532946450627 -3.573e-07  2.425e-04    3     8  1.612e-01 2.014e-02 7.938e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.193e-05,4.024e-04,4.827e-03,7.537e-04,6.057e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=3.291e-05 speed=6.761e-01GB/S t[comm(inter)]=9.020e-06 speed=2.466e+00GB/S
--- TIMING FOR sigma : t_inter=4.0e-04 t_gemm=4.8e-03 t_reduction=7.5e-04 tot=6.0e-03 ---
 sigma[inter] counter=97 t=4.0e-04 per=6.7e+00 cost=9.3e+06 flops=2.3e+10
 sigma[gemm] counter=97 i=0 t=2.6e-06 per=4.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=1 t=2.3e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=2 t=1.2e-03 per=2.0e+01 cost=6.9e+06 flops=5.8e+09
 sigma[gemm] counter=97 i=3 t=1.2e-03 per=2.0e+01 cost=6.7e+06 flops=5.7e+09
 sigma[gemm] counter=97 i=4 t=1.3e-03 per=2.1e+01 cost=6.3e+06 flops=5.0e+09
 sigma[gemm] counter=97 i=5 t=1.2e-03 per=2.0e+01 cost=6.4e+06 flops=5.4e+09
 sigma[gemm] counter=97 total t=4.8e-03 per=8.1e+01 cost=2.6e+07 flops=5.5e+09
 sigma[red] counter=97 t=7.5e-04 per=1.3e+01 cost=1.7e+06 flops=2.3e+09
--- TIMING FOR sigma_tot : t_inter=4.6e-02 t_gemm=5.1e-01 t_reduction=7.1e-02 tot=6.3e-01 ---
 sigma_tot[inter] counter=97 t=4.6e-02 per=7.3e+00 cost=9.8e+08 flops=2.1e+10
 sigma_tot[gemm] counter=97 i=0 t=2.0e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=1 t=1.6e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=2 t=1.3e-01 per=2.1e+01 cost=9.1e+08 flops=7.0e+09
 sigma_tot[gemm] counter=97 i=3 t=1.3e-01 per=2.1e+01 cost=8.9e+08 flops=6.9e+09
 sigma_tot[gemm] counter=97 i=4 t=1.3e-01 per=2.1e+01 cost=7.5e+08 flops=5.8e+09
 sigma_tot[gemm] counter=97 i=5 t=1.2e-01 per=1.9e+01 cost=7.6e+08 flops=6.2e+09
 sigma_tot[gemm] counter=97 total t=5.1e-01 per=8.1e+01 cost=3.3e+09 flops=6.5e+09
 sigma_tot[red] counter=97 t=7.1e-02 per=1.1e+01 cost=2.1e+08 flops=3.0e+09
T(sub)=9.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-05,2.8e-05,4.7e-06,1.3e-05,1.0e-06
    9   0 -    -116.532946540732 -9.011e-08  1.022e-04    3     9  1.752e-01 1.947e-02 7.751e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.095e-05,3.494e-04,4.647e-03,7.221e-04,5.761e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=2.471e-05 speed=9.003e-01GB/S t[comm(inter)]=6.242e-06 speed=3.564e+00GB/S
--- TIMING FOR sigma : t_inter=3.5e-04 t_gemm=4.6e-03 t_reduction=7.2e-04 tot=5.7e-03 ---
 sigma[inter] counter=98 t=3.5e-04 per=6.1e+00 cost=9.3e+06 flops=2.7e+10
 sigma[gemm] counter=98 i=0 t=2.4e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=1 t=2.2e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=2 t=1.1e-03 per=2.0e+01 cost=6.9e+06 flops=6.1e+09
 sigma[gemm] counter=98 i=3 t=1.1e-03 per=2.0e+01 cost=6.7e+06 flops=5.9e+09
 sigma[gemm] counter=98 i=4 t=1.2e-03 per=2.1e+01 cost=6.3e+06 flops=5.2e+09
 sigma[gemm] counter=98 i=5 t=1.2e-03 per=2.0e+01 cost=6.4e+06 flops=5.5e+09
 sigma[gemm] counter=98 total t=4.6e-03 per=8.1e+01 cost=2.6e+07 flops=5.7e+09
 sigma[red] counter=98 t=7.2e-04 per=1.3e+01 cost=1.7e+06 flops=2.4e+09
--- TIMING FOR sigma_tot : t_inter=4.6e-02 t_gemm=5.2e-01 t_reduction=7.2e-02 tot=6.3e-01 ---
 sigma_tot[inter] counter=98 t=4.6e-02 per=7.3e+00 cost=9.9e+08 flops=2.2e+10
 sigma_tot[gemm] counter=98 i=0 t=2.0e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=1 t=1.6e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=2 t=1.3e-01 per=2.1e+01 cost=9.1e+08 flops=7.0e+09
 sigma_tot[gemm] counter=98 i=3 t=1.3e-01 per=2.1e+01 cost=9.0e+08 flops=6.9e+09
 sigma_tot[gemm] counter=98 i=4 t=1.3e-01 per=2.1e+01 cost=7.5e+08 flops=5.8e+09
 sigma_tot[gemm] counter=98 i=5 t=1.2e-01 per=2.0e+01 cost=7.7e+08 flops=6.2e+09
 sigma_tot[gemm] counter=98 total t=5.2e-01 per=8.1e+01 cost=3.3e+09 flops=6.5e+09
 sigma_tot[red] counter=98 t=7.2e-02 per=1.1e+01 cost=2.2e+08 flops=3.0e+09
T(sub)=6.5e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,3.1e-05,4.4e-06,8.7e-06,8.7e-07
   10   0 +    -116.532946558375 -1.764e-08  4.350e-05    3    10  1.886e-01 1.886e-02 7.570e-03
TIMING FOR Davidson : 1.886e-01  T(cal/comm/rest)=7.570e-02,1.401e-06,1.129e-01
decomposed t_rest=1.129e-01
 T(sub)    =5.299e-04 per=4.694e-01
 T(precond)=1.120e-01 per=9.919e+01
 T(ortho)  =8.592e-05 per=7.611e-02
 T(xcopy)  =5.024e-06 per=4.450e-03
 T(xnrm2)  =1.224e-05 per=1.084e-02
 T(other)  =2.797e-04 per=2.477e-01
optimized energies: isweep=0 ibond=12 dots=1 e[0]=-116.532946558375 nmvp=10
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.949e+02S Sys:2.728e+00S Total:9.976e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond12.txt
 qbond: qsuper nsym=18 dimAll=272
 (19,3):21 (21,3):39 (20,4):20 (20,2):42 (19,1):22 (21,1):27 (20,0):12 (23,3):10 (22,4):17 (22,2):25 (18,2):10 (23,1):6 (22,0):6 (21,5):7 (17,1):3 (18,0):3 (23,5):1 (22,6):1
timing for divide=1.9e-05
timing for compute=7.8e-04
timing for collect=4.7e-05
----- TMING FOR decimation_genbasis(nkr): 8.4e-04 S T(divide/compute/collect)=1.9e-05,7.8e-04,4.7e-05 -----
decimation summary: 272->58 dwt=-2.220e-16 SvN=1.632e+00
 qbond: qkept nsym=9 dimAll=58
 (21,3):11 (21,1):9 (23,3):9 (22,2):9 (20,2):8 (22,4):5 (19,1):3 (23,1):3 (23,5):1
----- TIMING for decimation_row(nkr): 2.436e-03 S T(decim/select/formRot)=9.645e-04,1.365e-03,1.061e-04 -----
----- TIMING FOR onedot_decimation: 2.679e-03 S T(wf/decim)=1.916e-04,2.487e-03 -----
ctns::oper_renorm coord=(13,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:28 S:12 H:1 P:66 Q:78 
        dim(bra,ket)=58,58 size(op)=472:3.601e-03MB size(tot)=49386:3.768e-01MB:3.680e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.949e+02S Sys:2.730e+00S Total:9.976e+02S
----- TIMING FOR symbolic_formulae_renorm with size=185 : 4.161e-02 S -----
rank=0 GPUmem(GB): used=0.00108 (oper)=0.00104
rank=0 GPUmem(GB): used=0.00109 (oper,site)(GB)=0.00104,1.11e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=390
 no. of coefficients=5070:0.0387MB:3.78e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.348e-03 S -----
rank=0 GPUmem(GB): used=0.00113 (oper,site,rinter)=0.00104,1.11e-05,3.78e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0208 S size(rtasks)=185 size(Rlst2)=81 T(Rmu/Rlist)=0.00515,0.0156 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0221 S size(rtasks)=185 size(Rlst)=6330 -----
rank=0 GPUmem(GB): used=0.00113 (oper,site,rinter,batch)=0.00104,1.11e-05,3.78e-05,0.0205 blksize=154 blksize0=126 batchsize=6330
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00123,0.025,0.00514
--- TIMING FOR renorm : t_inter=1.2e-03 t_gemm=2.5e-02 t_reduction=5.1e-03 tot=3.1e-02 ---
 renorm[inter] counter=13 t=1.2e-03 per=3.9e+00 cost=4.7e+06 flops=3.8e+09
 renorm[gemm] counter=13 i=0 t=2.3e-06 per=7.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=1 t=1.9e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=2 t=1.9e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=3 t=1.9e-06 per=6.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=4 t=7.4e-03 per=2.4e+01 cost=2.6e+06 flops=3.5e+08
 renorm[gemm] counter=13 i=5 t=8.6e-03 per=2.7e+01 cost=4.3e+06 flops=5.0e+08
 renorm[gemm] counter=13 i=6 t=8.9e-03 per=2.9e+01 cost=7.6e+06 flops=8.5e+08
 renorm[gemm] counter=13 total t=2.5e-02 per=8.0e+01 cost=1.4e+07 flops=5.8e+08
 renorm[red] counter=13 t=5.1e-03 per=1.6e+01 cost=8.1e+05 flops=1.6e+08
--- TIMING FOR renorm_tot : t_inter=9.5e-03 t_gemm=1.3e-01 t_reduction=2.8e-02 tot=1.6e-01 ---
 renorm_tot[inter] counter=13 t=9.5e-03 per=5.8e+00 cost=5.5e+07 flops=5.7e+09
 renorm_tot[gemm] counter=13 i=0 t=1.9e-05 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=1 t=1.6e-05 per=9.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=2 t=1.6e-05 per=9.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=3 t=1.6e-05 per=9.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=4 t=3.5e-02 per=2.1e+01 cost=2.5e+07 flops=7.3e+08
 renorm_tot[gemm] counter=13 i=5 t=4.4e-02 per=2.7e+01 cost=4.8e+07 flops=1.1e+09
 renorm_tot[gemm] counter=13 i=6 t=4.8e-02 per=2.9e+01 cost=9.7e+07 flops=2.0e+09
 renorm_tot[gemm] counter=13 total t=1.3e-01 per=7.7e+01 cost=1.7e+08 flops=1.3e+09
 renorm_tot[red] counter=13 t=2.8e-02 per=1.7e+01 cost=1.2e+07 flops=4.3e+08
qops.to_cpu: size(tot)=49386:3.8e-01MB:3.7e-04GB t[to_cpu]=1.1e-04S speed=3.3e+00GB/S
check ||H-H.dagger||=6.742e-14 coord=(13,0) rank=0
ctns::oper_ab2pq coord=(13,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.175 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.951e+02S Sys:2.730e+00S Total:9.978e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1021:7.790e-03MB:7.607e-06GB
total mem of comb=16188:1.235e-01MB:1.206e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.951e+02S Sys:2.731e+00S Total:9.978e+02S
##### local opt: 6.529e-01 S #####
 T(local opt: fetch) = 1.046e-02 S  per =  1.6  per(accum) = 1.6
 T(local opt: hdiag) = 1.747e-03 S  per = 0.268  per(accum) = 1.87
 T(local opt: dvdsn) = 4.587e-01 S  per = 70.3  per(accum) = 72.1
 T(local opt: decim) = 2.699e-03 S  per = 0.413  per(accum) = 72.5
 T(local opt: guess) = 7.508e-04 S  per = 0.115  per(accum) = 72.7
 T(local opt: renrm) = 1.761e-01 S  per =   27  per(accum) = 99.6
 T(local opt: save ) = 2.482e-03 S  per = 0.38  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.587e-01 S  T(sum) = 2.841e-01 S  per = 6.194e+01
 T(local opt: preprocess                  ) = 3.954e-04 S  per = 0.139  per(accum) = 0.139
 T(local opt: symbolic_formulae           ) = 1.489e-02 S  per = 5.24  per(accum) = 5.38
 T(local opt: hintermediate init          ) = 3.268e-04 S  per = 0.115  per(accum) = 5.49
 T(local opt: preprocess_hformulae_Hxlist ) = 1.415e-02 S  per = 4.98  per(accum) = 10.5
 T(local opt: hmmtasks init               ) = 6.574e-02 S  per = 23.1  per(accum) = 33.6
 T(local opt: initial guess for dvdson    ) = 9.262e-06 S  per = 0.00326  per(accum) = 33.6
 T(local opt: dvdson solver [Hx_batchGPU] ) = 7.533e-02 S  per = 26.5  per(accum) = 60.1
 T(local opt: dvdson solver [comm(gpu)]   ) = 3.707e-04 S  per = 0.13  per(accum) = 60.3
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.401e-06 S  per = 0.000493  per(accum) = 60.3
 T(local opt: dvdson solver [rest part]   ) = 1.129e-01 S  per = 39.7  per(accum) = 100
Detailed decomposition of T(renrm) = 1.761e-01 S  T(sum) = 1.761e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.381e-04 S  per = 0.306  per(accum) = 0.306
 T(local opt: qops init                    ) = 7.249e-03 S  per = 4.12  per(accum) = 4.42
 T(local opt: symbolic_formulae_renorm     ) = 4.164e-02 S  per = 23.6  per(accum) = 28.1
 T(local opt: allocate qops on gpu         ) = 6.030e-05 S  per = 0.0342  per(accum) = 28.1
 T(local opt: site memcpy cpu2gpu          ) = 5.214e-05 S  per = 0.0296  per(accum) = 28.1
 T(local opt: rintermediate init           ) = 1.373e-03 S  per = 0.78  per(accum) = 28.9
 T(local opt: preprocess_formulae_Rlist2   ) = 2.250e-02 S  per = 12.8  per(accum) = 41.7
 T(local opt: rmmtasks init                ) = 7.007e-02 S  per = 39.8  per(accum) = 81.5
 T(local opt: qops memset on cpu           ) = 7.500e-08 S  per = 4.26e-05  per(accum) = 81.5
 T(local opt: preprocess_renorm_batchGPU   ) = 3.146e-02 S  per = 17.9  per(accum) = 99.4
 T(local opt: reduction of opS & opH [nccl]) = 1.473e-06 S  per = 0.000837  per(accum) = 99.4
 T(local opt: qops memcpy gpu2cpu          ) = 1.190e-04 S  per = 0.0676  per(accum) = 99.4
 T(local opt: deallocate cpu and gpu memory) = 1.458e-04 S  per = 0.0828  per(accum) = 99.5
 T(local opt: reduction of opS & opH [comm]) = 5.714e-05 S  per = 0.0325  per(accum) = 99.5
 T(local opt: conversion from opAB to opPQ ) = 5.167e-06 S  per = 0.00293  per(accum) = 99.5
 T(local opt: after oper_renorm            ) = 8.060e-04 S  per = 0.458  per(accum) = 100
##### sweep opt: 9.695e+00 S #####
 T(sweep opt: fetch) = 1.744e-01 S  per =  1.8  per(accum) = 1.8
 T(sweep opt: hdiag) = 3.213e-02 S  per = 0.331  per(accum) = 2.13
 T(sweep opt: dvdsn) = 4.194e+00 S  per = 43.3  per(accum) = 45.4
 T(sweep opt: decim) = 1.768e-02 S  per = 0.182  per(accum) = 45.6
 T(sweep opt: guess) = 4.515e-03 S  per = 0.0466  per(accum) = 45.6
 T(sweep opt: renrm) = 5.238e+00 S  per =   54  per(accum) = 99.6
 T(sweep opt: save ) = 3.424e-02 S  per = 0.353  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.194e+00 S  T(sum) = 3.741e+00 S  per = 8.919e+01
 T(sweep opt: preprocess                  ) = 6.264e-03 S  per = 0.167  per(accum) = 0.167
 T(sweep opt: symbolic_formulae           ) = 2.169e-01 S  per =  5.8  per(accum) = 5.97
 T(sweep opt: hintermediate init          ) = 5.040e-03 S  per = 0.135  per(accum) = 6.1
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.644e-01 S  per = 7.07  per(accum) = 13.2
 T(sweep opt: hmmtasks init               ) = 1.853e+00 S  per = 49.5  per(accum) = 62.7
 T(sweep opt: initial guess for dvdson    ) = 1.241e-04 S  per = 0.00332  per(accum) = 62.7
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 6.523e-01 S  per = 17.4  per(accum) = 80.1
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 3.546e-03 S  per = 0.0948  per(accum) = 80.2
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.286e-05 S  per = 0.000344  per(accum) = 80.2
 T(sweep opt: dvdson solver [rest part]   ) = 7.392e-01 S  per = 19.8  per(accum) = 100
Detailed decomposition of T(renrm) = 5.238e+00 S  T(sum) = 5.238e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.912e-03 S  per = 0.113  per(accum) = 0.113
 T(sweep opt: qops init                    ) = 5.672e-02 S  per = 1.08  per(accum) = 1.2
 T(sweep opt: symbolic_formulae_renorm     ) = 1.899e-01 S  per = 3.63  per(accum) = 4.82
 T(sweep opt: allocate qops on gpu         ) = 1.191e-03 S  per = 0.0227  per(accum) = 4.84
 T(sweep opt: site memcpy cpu2gpu          ) = 3.154e-04 S  per = 0.00602  per(accum) = 4.85
 T(sweep opt: rintermediate init           ) = 8.036e-03 S  per = 0.153  per(accum) = 5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.599e-01 S  per = 3.05  per(accum) = 8.06
 T(sweep opt: rmmtasks init                ) = 6.229e-01 S  per = 11.9  per(accum) = 19.9
 T(sweep opt: qops memset on cpu           ) = 7.340e-07 S  per = 1.4e-05  per(accum) = 19.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.655e-01 S  per = 3.16  per(accum) = 23.1
 T(sweep opt: reduction of opS & opH [nccl]) = 1.406e-05 S  per = 0.000268  per(accum) = 23.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.228e-03 S  per = 0.0425  per(accum) = 23.2
 T(sweep opt: deallocate cpu and gpu memory) = 1.963e-01 S  per = 3.75  per(accum) = 26.9
 T(sweep opt: reduction of opS & opH [comm]) = 5.913e-04 S  per = 0.0113  per(accum) = 26.9
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 72.9  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 9.435e-03 S  per = 0.18  per(accum) = 100
##### global opt: 9.695e+00 S #####
 T(global opt: fetch) = 1.744e-01 S  per =  1.8  per(accum) = 1.8
 T(global opt: hdiag) = 3.213e-02 S  per = 0.331  per(accum) = 2.13
 T(global opt: dvdsn) = 4.194e+00 S  per = 43.3  per(accum) = 45.4
 T(global opt: decim) = 1.768e-02 S  per = 0.182  per(accum) = 45.6
 T(global opt: guess) = 4.515e-03 S  per = 0.0466  per(accum) = 45.6
 T(global opt: renrm) = 5.238e+00 S  per =   54  per(accum) = 99.6
 T(global opt: save ) = 3.424e-02 S  per = 0.353  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.194e+00 S  T(sum) = 3.741e+00 S  per = 8.919e+01
 T(global opt: preprocess                  ) = 6.264e-03 S  per = 0.167  per(accum) = 0.167
 T(global opt: symbolic_formulae           ) = 2.169e-01 S  per =  5.8  per(accum) = 5.97
 T(global opt: hintermediate init          ) = 5.040e-03 S  per = 0.135  per(accum) = 6.1
 T(global opt: preprocess_hformulae_Hxlist ) = 2.644e-01 S  per = 7.07  per(accum) = 13.2
 T(global opt: hmmtasks init               ) = 1.853e+00 S  per = 49.5  per(accum) = 62.7
 T(global opt: initial guess for dvdson    ) = 1.241e-04 S  per = 0.00332  per(accum) = 62.7
 T(global opt: dvdson solver [Hx_batchGPU] ) = 6.523e-01 S  per = 17.4  per(accum) = 80.1
 T(global opt: dvdson solver [comm(gpu)]   ) = 3.546e-03 S  per = 0.0948  per(accum) = 80.2
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.286e-05 S  per = 0.000344  per(accum) = 80.2
 T(global opt: dvdson solver [rest part]   ) = 7.392e-01 S  per = 19.8  per(accum) = 100
Detailed decomposition of T(renrm) = 5.238e+00 S  T(sum) = 5.238e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.912e-03 S  per = 0.113  per(accum) = 0.113
 T(global opt: qops init                    ) = 5.672e-02 S  per = 1.08  per(accum) = 1.2
 T(global opt: symbolic_formulae_renorm     ) = 1.899e-01 S  per = 3.63  per(accum) = 4.82
 T(global opt: allocate qops on gpu         ) = 1.191e-03 S  per = 0.0227  per(accum) = 4.84
 T(global opt: site memcpy cpu2gpu          ) = 3.154e-04 S  per = 0.00602  per(accum) = 4.85
 T(global opt: rintermediate init           ) = 8.036e-03 S  per = 0.153  per(accum) = 5
 T(global opt: preprocess_formulae_Rlist2   ) = 1.599e-01 S  per = 3.05  per(accum) = 8.06
 T(global opt: rmmtasks init                ) = 6.229e-01 S  per = 11.9  per(accum) = 19.9
 T(global opt: qops memset on cpu           ) = 7.340e-07 S  per = 1.4e-05  per(accum) = 19.9
 T(global opt: preprocess_renorm_batchGPU   ) = 1.655e-01 S  per = 3.16  per(accum) = 23.1
 T(global opt: reduction of opS & opH [nccl]) = 1.406e-05 S  per = 0.000268  per(accum) = 23.1
 T(global opt: qops memcpy gpu2cpu          ) = 2.228e-03 S  per = 0.0425  per(accum) = 23.2
 T(global opt: deallocate cpu and gpu memory) = 1.963e-01 S  per = 3.75  per(accum) = 26.9
 T(global opt: reduction of opS & opH [comm]) = 5.913e-04 S  per = 0.0113  per(accum) = 26.9
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 72.9  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 9.435e-03 S  per = 0.18  per(accum) = 100

isweep=0 ibond=13/seqsize=34 dots=1 dbond=(14,0)-(15,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:9.951e+02S Sys:2.731e+00S Total:9.978e+02S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1021:7.790e-03MB:7.607e-06GB
total mem of comb=16188:1.235e-01MB:1.206e-04GB
ctns::topology::check_partition: (sl,sr,sc)=14,5,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 11 12 13 14 15
 suppc= 10
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:28 S:12 H:1 P:66 Q:78 
        dim(bra,ket)=58,58 size(op)=472:3.601e-03MB size(tot)=49386:3.768e-01MB:3.680e-04GB
 rqops: oplist=CSHAB nops=C:10 S:30 H:1 A:45 B:55 
        dim(bra,ket)=42,42 size(op)=270:2.060e-03MB size(tot)=21070:1.608e-01MB:1.570e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=72792:5.554e-01MB:5.423e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(14,0) fdel=./scratch/sweep/rop(15,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
wf3(diml,dimr,dimc)=(58,42,4) nnz=1021:7.790e-03MB
qtensor3: wf3 own=1 _data=0x530ab8e0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=58
 (21,3):11 (21,1):9 (23,3):9 (22,2):9 (20,2):8 (22,4):5 (19,1):3 (23,1):3 (23,5):1
 qbond: qcol nsym=8 dimAll=42
 (6,-2):8 (8,-2):8 (7,-3):8 (7,-1):6 (5,-3):4 (6,-4):4 (9,-1):3 (5,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=22 nblocks=288 size=1021:7.790e-03MB
### DIAG TIMING: total=1.648e-03 t1=1.545e-05, t2=4.207e-05, t3=3.633e-05, t4=1.525e-03, t5=7.863e-06, t6=1.675e-05, t7=4.482e-06
duration_diagGPU:1.662e-03
duration_diagreduce:7.800e-08
duration_diagtransform:4.521e-06
----- TIMING FOR symbolic_formulae_onedot with size=607 : 1.580e-02 S -----
rank=0 GPUmem(GB): used=0.000542 (oper)=0.000542
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=607
 no. of hintermediate operators=280
 no. of coefficients=3920:0.0299MB:2.92e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.101e-04 S -----
rank=0 GPUmem(GB): used=0.000572 (oper,hinter)=0.000542,2.92e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0124 S size(H_formulae)=607 size(Hxlst2)=22 T(Hmu/Hxlist)=0.00184,0.0106 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0133 S size(H_formulae)=607 size(Hxlst)=8870 -----
rank=0 GPUmem(GB): used=0.0188 (oper,hinter,dvdson,batch)=0.000542,2.92e-05,1.52e-05,0.0182 blksize=88 blksize0=99 batchsize=8870
ctns::pdvdsonSolver_nkr::solve_iter ndim=1021 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.04e-05,0.000957,0.0168,0.00207,0.0198
 ndim=1021:7.61e-06GB t[comm(intra)]=2.47e-05 speed=0.616GB/S t[comm(inter)]=5.7e-06 speed=2.67GB/S
--- TIMING FOR sigma : t_inter=9.6e-04 t_gemm=1.7e-02 t_reduction=2.1e-03 tot=2.0e-02 ---
 sigma[inter] counter=99 t=9.6e-04 per=4.8e+00 cost=5.6e+06 flops=5.9e+09
 sigma[gemm] counter=99 i=0 t=1.6e-06 per=7.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=1 t=1.3e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=2 t=3.9e-03 per=2.0e+01 cost=2.8e+06 flops=7.2e+08
 sigma[gemm] counter=99 i=3 t=3.9e-03 per=2.0e+01 cost=2.8e+06 flops=7.0e+08
 sigma[gemm] counter=99 i=4 t=4.6e-03 per=2.3e+01 cost=3.0e+06 flops=6.5e+08
 sigma[gemm] counter=99 i=5 t=4.4e-03 per=2.2e+01 cost=2.9e+06 flops=6.8e+08
 sigma[gemm] counter=99 total t=1.7e-02 per=8.5e+01 cost=1.2e+07 flops=6.9e+08
 sigma[red] counter=99 t=2.1e-03 per=1.0e+01 cost=9.0e+05 flops=4.3e+08
--- TIMING FOR sigma_tot : t_inter=4.7e-02 t_gemm=5.3e-01 t_reduction=7.4e-02 tot=6.5e-01 ---
 sigma_tot[inter] counter=99 t=4.7e-02 per=7.2e+00 cost=1.0e+09 flops=2.1e+10
 sigma_tot[gemm] counter=99 i=0 t=2.0e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=1 t=1.6e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=2 t=1.4e-01 per=2.1e+01 cost=9.2e+08 flops=6.8e+09
 sigma_tot[gemm] counter=99 i=3 t=1.3e-01 per=2.1e+01 cost=9.0e+08 flops=6.7e+09
 sigma_tot[gemm] counter=99 i=4 t=1.3e-01 per=2.1e+01 cost=7.5e+08 flops=5.6e+09
 sigma_tot[gemm] counter=99 i=5 t=1.3e-01 per=2.0e+01 cost=7.7e+08 flops=6.0e+09
 sigma_tot[gemm] counter=99 total t=5.3e-01 per=8.1e+01 cost=3.3e+09 flops=6.3e+09
 sigma_tot[red] counter=99 t=7.4e-02 per=1.1e+01 cost=2.2e+08 flops=2.9e+09
T(sub)=1.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,4.7e-06,1.9e-06,1.7e-06,5.2e-07
settings: ndim=1021 neig=1 maxcycle=30 nbuff=4 memory=0.0001GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.532946558375 -1.117e+03  5.477e-02    1     1  1.996e-02 1.996e-02 1.993e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.767e-05,2.498e-04,2.092e-03,4.678e-04,2.863e-03
 ndim=1021:7.607e-06GB t[comm(intra)]=2.242e-05 speed=6.785e-01GB/S t[comm(inter)]=1.525e-05 speed=9.979e-01GB/S
--- TIMING FOR sigma : t_inter=2.5e-04 t_gemm=2.1e-03 t_reduction=4.7e-04 tot=2.8e-03 ---
 sigma[inter] counter=100 t=2.5e-04 per=8.9e+00 cost=5.6e+06 flops=2.3e+10
 sigma[gemm] counter=100 i=0 t=2.1e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=1 t=1.8e-06 per=6.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=2 t=5.7e-04 per=2.0e+01 cost=2.8e+06 flops=5.0e+09
 sigma[gemm] counter=100 i=3 t=4.7e-04 per=1.7e+01 cost=2.8e+06 flops=5.9e+09
 sigma[gemm] counter=100 i=4 t=5.5e-04 per=2.0e+01 cost=3.0e+06 flops=5.4e+09
 sigma[gemm] counter=100 i=5 t=5.0e-04 per=1.8e+01 cost=2.9e+06 flops=5.9e+09
 sigma[gemm] counter=100 total t=2.1e-03 per=7.4e+01 cost=1.2e+07 flops=5.5e+09
 sigma[red] counter=100 t=4.7e-04 per=1.7e+01 cost=9.0e+05 flops=1.9e+09
--- TIMING FOR sigma_tot : t_inter=4.7e-02 t_gemm=5.3e-01 t_reduction=7.5e-02 tot=6.6e-01 ---
 sigma_tot[inter] counter=100 t=4.7e-02 per=7.2e+00 cost=1.0e+09 flops=2.1e+10
 sigma_tot[gemm] counter=100 i=0 t=2.1e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=1 t=1.6e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=2 t=1.4e-01 per=2.1e+01 cost=9.2e+08 flops=6.8e+09
 sigma_tot[gemm] counter=100 i=3 t=1.3e-01 per=2.1e+01 cost=9.1e+08 flops=6.7e+09
 sigma_tot[gemm] counter=100 i=4 t=1.4e-01 per=2.1e+01 cost=7.6e+08 flops=5.6e+09
 sigma_tot[gemm] counter=100 i=5 t=1.3e-01 per=2.0e+01 cost=7.7e+08 flops=6.0e+09
 sigma_tot[gemm] counter=100 total t=5.3e-01 per=8.1e+01 cost=3.4e+09 flops=6.3e+09
 sigma_tot[red] counter=100 t=7.5e-02 per=1.1e+01 cost=2.2e+08 flops=2.9e+09
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.2e-05,3.8e-06,3.9e-06,6.6e-07
    2   0 -    -116.536216808262 -3.270e-03  1.579e-02    2     2  3.708e-02 1.854e-02 1.146e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.584e-05,2.321e-04,2.078e-03,4.681e-04,2.823e-03
 ndim=1021:7.607e-06GB t[comm(intra)]=2.105e-05 speed=7.227e-01GB/S t[comm(inter)]=1.479e-05 speed=1.029e+00GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=2.1e-03 t_reduction=4.7e-04 tot=2.8e-03 ---
 sigma[inter] counter=101 t=2.3e-04 per=8.3e+00 cost=5.6e+06 flops=2.4e+10
 sigma[gemm] counter=101 i=0 t=2.0e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=1 t=1.7e-06 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=2 t=5.4e-04 per=2.0e+01 cost=2.8e+06 flops=5.2e+09
 sigma[gemm] counter=101 i=3 t=4.9e-04 per=1.8e+01 cost=2.8e+06 flops=5.6e+09
 sigma[gemm] counter=101 i=4 t=5.4e-04 per=2.0e+01 cost=3.0e+06 flops=5.5e+09
 sigma[gemm] counter=101 i=5 t=4.9e-04 per=1.8e+01 cost=2.9e+06 flops=6.0e+09
 sigma[gemm] counter=101 total t=2.1e-03 per=7.5e+01 cost=1.2e+07 flops=5.5e+09
 sigma[red] counter=101 t=4.7e-04 per=1.7e+01 cost=9.0e+05 flops=1.9e+09
--- TIMING FOR sigma_tot : t_inter=4.8e-02 t_gemm=5.4e-01 t_reduction=7.5e-02 tot=6.6e-01 ---
 sigma_tot[inter] counter=101 t=4.8e-02 per=7.2e+00 cost=1.0e+09 flops=2.1e+10
 sigma_tot[gemm] counter=101 i=0 t=2.1e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=1 t=1.7e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=2 t=1.4e-01 per=2.1e+01 cost=9.2e+08 flops=6.8e+09
 sigma_tot[gemm] counter=101 i=3 t=1.4e-01 per=2.1e+01 cost=9.1e+08 flops=6.7e+09
 sigma_tot[gemm] counter=101 i=4 t=1.4e-01 per=2.1e+01 cost=7.6e+08 flops=5.6e+09
 sigma_tot[gemm] counter=101 i=5 t=1.3e-01 per=2.0e+01 cost=7.8e+08 flops=6.0e+09
 sigma_tot[gemm] counter=101 total t=5.4e-01 per=8.1e+01 cost=3.4e+09 flops=6.3e+09
 sigma_tot[red] counter=101 t=7.5e-02 per=1.1e+01 cost=2.2e+08 flops=2.9e+09
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.6e-05,3.3e-06,1.6e-05,6.7e-07
    3   0 -    -116.536743874006 -5.271e-04  8.289e-03    3     3  4.824e-02 1.608e-02 8.623e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.532e-05,2.078e-04,2.070e-03,4.634e-04,7.449e-03
 ndim=1021:7.607e-06GB t[comm(intra)]=2.072e-05 speed=7.344e-01GB/S t[comm(inter)]=4.602e-06 speed=3.306e+00GB/S
--- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=2.1e-03 t_reduction=4.6e-04 tot=2.7e-03 ---
 sigma[inter] counter=102 t=2.1e-04 per=7.6e+00 cost=5.6e+06 flops=2.7e+10
 sigma[gemm] counter=102 i=0 t=1.7e-06 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=1 t=1.5e-06 per=5.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=2 t=5.5e-04 per=2.0e+01 cost=2.8e+06 flops=5.1e+09
 sigma[gemm] counter=102 i=3 t=4.9e-04 per=1.8e+01 cost=2.8e+06 flops=5.6e+09
 sigma[gemm] counter=102 i=4 t=5.3e-04 per=1.9e+01 cost=3.0e+06 flops=5.6e+09
 sigma[gemm] counter=102 i=5 t=5.0e-04 per=1.8e+01 cost=2.9e+06 flops=5.9e+09
 sigma[gemm] counter=102 total t=2.1e-03 per=7.6e+01 cost=1.2e+07 flops=5.6e+09
 sigma[red] counter=102 t=4.6e-04 per=1.7e+01 cost=9.0e+05 flops=1.9e+09
--- TIMING FOR sigma_tot : t_inter=4.8e-02 t_gemm=5.4e-01 t_reduction=7.6e-02 tot=6.6e-01 ---
 sigma_tot[inter] counter=102 t=4.8e-02 per=7.2e+00 cost=1.0e+09 flops=2.1e+10
 sigma_tot[gemm] counter=102 i=0 t=2.1e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=1 t=1.7e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=2 t=1.4e-01 per=2.1e+01 cost=9.3e+08 flops=6.8e+09
 sigma_tot[gemm] counter=102 i=3 t=1.4e-01 per=2.1e+01 cost=9.1e+08 flops=6.7e+09
 sigma_tot[gemm] counter=102 i=4 t=1.4e-01 per=2.1e+01 cost=7.6e+08 flops=5.6e+09
 sigma_tot[gemm] counter=102 i=5 t=1.3e-01 per=2.0e+01 cost=7.8e+08 flops=6.0e+09
 sigma_tot[gemm] counter=102 total t=5.4e-01 per=8.1e+01 cost=3.4e+09 flops=6.3e+09
 sigma_tot[red] counter=102 t=7.6e-02 per=1.1e+01 cost=2.2e+08 flops=2.9e+09
T(sub)=3.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.6e-05,3.2e-06,5.5e-06,6.0e-07
    4   0 -    -116.536890979459 -1.471e-04  4.640e-03    3     4  6.684e-02 1.671e-02 8.360e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.630e-05,2.330e-04,2.047e-03,4.534e-04,2.779e-03
 ndim=1021:7.607e-06GB t[comm(intra)]=2.155e-05 speed=7.058e-01GB/S t[comm(inter)]=1.475e-05 speed=1.032e+00GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=2.0e-03 t_reduction=4.5e-04 tot=2.7e-03 ---
 sigma[inter] counter=103 t=2.3e-04 per=8.5e+00 cost=5.6e+06 flops=2.4e+10
 sigma[gemm] counter=103 i=0 t=2.0e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=1 t=1.8e-06 per=6.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=2 t=5.5e-04 per=2.0e+01 cost=2.8e+06 flops=5.2e+09
 sigma[gemm] counter=103 i=3 t=4.6e-04 per=1.7e+01 cost=2.8e+06 flops=6.0e+09
 sigma[gemm] counter=103 i=4 t=5.3e-04 per=2.0e+01 cost=3.0e+06 flops=5.6e+09
 sigma[gemm] counter=103 i=5 t=5.0e-04 per=1.8e+01 cost=2.9e+06 flops=5.9e+09
 sigma[gemm] counter=103 total t=2.0e-03 per=7.5e+01 cost=1.2e+07 flops=5.6e+09
 sigma[red] counter=103 t=4.5e-04 per=1.7e+01 cost=9.0e+05 flops=2.0e+09
--- TIMING FOR sigma_tot : t_inter=4.8e-02 t_gemm=5.4e-01 t_reduction=7.6e-02 tot=6.6e-01 ---
 sigma_tot[inter] counter=103 t=4.8e-02 per=7.2e+00 cost=1.0e+09 flops=2.1e+10
 sigma_tot[gemm] counter=103 i=0 t=2.1e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=1 t=1.7e-04 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=2 t=1.4e-01 per=2.1e+01 cost=9.3e+08 flops=6.8e+09
 sigma_tot[gemm] counter=103 i=3 t=1.4e-01 per=2.0e+01 cost=9.1e+08 flops=6.7e+09
 sigma_tot[gemm] counter=103 i=4 t=1.4e-01 per=2.1e+01 cost=7.7e+08 flops=5.6e+09
 sigma_tot[gemm] counter=103 i=5 t=1.3e-01 per=2.0e+01 cost=7.8e+08 flops=6.0e+09
 sigma_tot[gemm] counter=103 total t=5.4e-01 per=8.1e+01 cost=3.4e+09 flops=6.3e+09
 sigma_tot[red] counter=103 t=7.6e-02 per=1.1e+01 cost=2.2e+08 flops=2.9e+09
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.5e-05,3.2e-06,1.5e-05,5.1e-07
    5   0 -    -116.536926688963 -3.571e-05  1.988e-03    3     5  7.583e-02 1.517e-02 7.271e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.603e-05,2.447e-04,2.033e-03,4.586e-04,2.772e-03
 ndim=1021:7.607e-06GB t[comm(intra)]=2.151e-05 speed=7.075e-01GB/S t[comm(inter)]=4.524e-06 speed=3.363e+00GB/S
--- TIMING FOR sigma : t_inter=2.4e-04 t_gemm=2.0e-03 t_reduction=4.6e-04 tot=2.7e-03 ---
 sigma[inter] counter=104 t=2.4e-04 per=8.9e+00 cost=5.6e+06 flops=2.3e+10
 sigma[gemm] counter=104 i=0 t=2.0e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=1 t=1.8e-06 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=2 t=5.4e-04 per=2.0e+01 cost=2.8e+06 flops=5.2e+09
 sigma[gemm] counter=104 i=3 t=4.6e-04 per=1.7e+01 cost=2.8e+06 flops=6.0e+09
 sigma[gemm] counter=104 i=4 t=5.3e-04 per=1.9e+01 cost=3.0e+06 flops=5.6e+09
 sigma[gemm] counter=104 i=5 t=5.0e-04 per=1.8e+01 cost=2.9e+06 flops=5.9e+09
 sigma[gemm] counter=104 total t=2.0e-03 per=7.4e+01 cost=1.2e+07 flops=5.7e+09
 sigma[red] counter=104 t=4.6e-04 per=1.7e+01 cost=9.0e+05 flops=2.0e+09
--- TIMING FOR sigma_tot : t_inter=4.8e-02 t_gemm=5.4e-01 t_reduction=7.6e-02 tot=6.7e-01 ---
 sigma_tot[inter] counter=104 t=4.8e-02 per=7.2e+00 cost=1.0e+09 flops=2.1e+10
 sigma_tot[gemm] counter=104 i=0 t=2.1e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=1 t=1.7e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=2 t=1.4e-01 per=2.1e+01 cost=9.3e+08 flops=6.8e+09
 sigma_tot[gemm] counter=104 i=3 t=1.4e-01 per=2.0e+01 cost=9.2e+08 flops=6.7e+09
 sigma_tot[gemm] counter=104 i=4 t=1.4e-01 per=2.1e+01 cost=7.7e+08 flops=5.6e+09
 sigma_tot[gemm] counter=104 i=5 t=1.3e-01 per=2.0e+01 cost=7.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=104 total t=5.4e-01 per=8.1e+01 cost=3.4e+09 flops=6.3e+09
 sigma_tot[red] counter=104 t=7.6e-02 per=1.1e+01 cost=2.2e+08 flops=2.9e+09
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.5e-05,3.2e-06,1.6e-05,6.0e-07
    6   0 -    -116.536934366683 -7.678e-06  9.642e-04    3     6  9.409e-02 1.568e-02 6.542e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.562e-05,2.335e-04,2.047e-03,4.472e-04,2.773e-03
 ndim=1021:7.607e-06GB t[comm(intra)]=3.067e-05 speed=4.961e-01GB/S t[comm(inter)]=4.956e-06 speed=3.070e+00GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=2.0e-03 t_reduction=4.5e-04 tot=2.7e-03 ---
 sigma[inter] counter=105 t=2.3e-04 per=8.6e+00 cost=5.6e+06 flops=2.4e+10
 sigma[gemm] counter=105 i=0 t=1.9e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=1 t=1.8e-06 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=2 t=5.3e-04 per=1.9e+01 cost=2.8e+06 flops=5.3e+09
 sigma[gemm] counter=105 i=3 t=4.8e-04 per=1.8e+01 cost=2.8e+06 flops=5.8e+09
 sigma[gemm] counter=105 i=4 t=5.1e-04 per=1.9e+01 cost=3.0e+06 flops=5.8e+09
 sigma[gemm] counter=105 i=5 t=5.2e-04 per=1.9e+01 cost=2.9e+06 flops=5.7e+09
 sigma[gemm] counter=105 total t=2.0e-03 per=7.5e+01 cost=1.2e+07 flops=5.6e+09
 sigma[red] counter=105 t=4.5e-04 per=1.6e+01 cost=9.0e+05 flops=2.0e+09
--- TIMING FOR sigma_tot : t_inter=4.9e-02 t_gemm=5.4e-01 t_reduction=7.7e-02 tot=6.7e-01 ---
 sigma_tot[inter] counter=105 t=4.9e-02 per=7.2e+00 cost=1.0e+09 flops=2.1e+10
 sigma_tot[gemm] counter=105 i=0 t=2.2e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=1 t=1.7e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=2 t=1.4e-01 per=2.1e+01 cost=9.3e+08 flops=6.7e+09
 sigma_tot[gemm] counter=105 i=3 t=1.4e-01 per=2.0e+01 cost=9.2e+08 flops=6.7e+09
 sigma_tot[gemm] counter=105 i=4 t=1.4e-01 per=2.1e+01 cost=7.7e+08 flops=5.6e+09
 sigma_tot[gemm] counter=105 i=5 t=1.3e-01 per=2.0e+01 cost=7.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=105 total t=5.4e-01 per=8.1e+01 cost=3.4e+09 flops=6.3e+09
 sigma_tot[red] counter=105 t=7.7e-02 per=1.1e+01 cost=2.2e+08 flops=2.9e+09
T(sub)=4.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.5e-05,1.3e-05,5.5e-06,5.2e-07
    7   0 -    -116.536936279705 -1.913e-06  4.824e-04    3     7  1.086e-01 1.551e-02 6.022e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.588e-05,2.494e-04,2.035e-03,4.432e-04,2.772e-03
 ndim=1021:7.607e-06GB t[comm(intra)]=2.097e-05 speed=7.256e-01GB/S t[comm(inter)]=1.492e-05 speed=1.020e+00GB/S
--- TIMING FOR sigma : t_inter=2.5e-04 t_gemm=2.0e-03 t_reduction=4.4e-04 tot=2.7e-03 ---
 sigma[inter] counter=106 t=2.5e-04 per=9.1e+00 cost=5.6e+06 flops=2.3e+10
 sigma[gemm] counter=106 i=0 t=2.0e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=1 t=1.8e-06 per=6.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=2 t=5.3e-04 per=1.9e+01 cost=2.8e+06 flops=5.3e+09
 sigma[gemm] counter=106 i=3 t=4.7e-04 per=1.7e+01 cost=2.8e+06 flops=5.9e+09
 sigma[gemm] counter=106 i=4 t=5.1e-04 per=1.9e+01 cost=3.0e+06 flops=5.8e+09
 sigma[gemm] counter=106 i=5 t=5.1e-04 per=1.9e+01 cost=2.9e+06 flops=5.7e+09
 sigma[gemm] counter=106 total t=2.0e-03 per=7.5e+01 cost=1.2e+07 flops=5.7e+09
 sigma[red] counter=106 t=4.4e-04 per=1.6e+01 cost=9.0e+05 flops=2.0e+09
--- TIMING FOR sigma_tot : t_inter=4.9e-02 t_gemm=5.5e-01 t_reduction=7.7e-02 tot=6.7e-01 ---
 sigma_tot[inter] counter=106 t=4.9e-02 per=7.2e+00 cost=1.0e+09 flops=2.1e+10
 sigma_tot[gemm] counter=106 i=0 t=2.2e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=1 t=1.7e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=2 t=1.4e-01 per=2.1e+01 cost=9.4e+08 flops=6.7e+09
 sigma_tot[gemm] counter=106 i=3 t=1.4e-01 per=2.0e+01 cost=9.2e+08 flops=6.7e+09
 sigma_tot[gemm] counter=106 i=4 t=1.4e-01 per=2.1e+01 cost=7.8e+08 flops=5.6e+09
 sigma_tot[gemm] counter=106 i=5 t=1.3e-01 per=2.0e+01 cost=7.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=106 total t=5.5e-01 per=8.1e+01 cost=3.4e+09 flops=6.3e+09
 sigma_tot[red] counter=106 t=7.7e-02 per=1.1e+01 cost=2.2e+08 flops=2.9e+09
T(sub)=4.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.5e-05,3.3e-06,1.5e-05,5.5e-07
    8   0 -    -116.536936722776 -4.431e-07  2.129e-04    3     8  1.213e-01 1.516e-02 5.631e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.552e-05,2.416e-04,2.041e-03,4.590e-04,2.775e-03
 ndim=1021:7.607e-06GB t[comm(intra)]=2.108e-05 speed=7.217e-01GB/S t[comm(inter)]=4.435e-06 speed=3.430e+00GB/S
--- TIMING FOR sigma : t_inter=2.4e-04 t_gemm=2.0e-03 t_reduction=4.6e-04 tot=2.7e-03 ---
 sigma[inter] counter=107 t=2.4e-04 per=8.8e+00 cost=5.6e+06 flops=2.3e+10
 sigma[gemm] counter=107 i=0 t=1.9e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=1 t=1.8e-06 per=6.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=2 t=5.5e-04 per=2.0e+01 cost=2.8e+06 flops=5.2e+09
 sigma[gemm] counter=107 i=3 t=4.6e-04 per=1.7e+01 cost=2.8e+06 flops=6.0e+09
 sigma[gemm] counter=107 i=4 t=5.3e-04 per=1.9e+01 cost=3.0e+06 flops=5.6e+09
 sigma[gemm] counter=107 i=5 t=5.0e-04 per=1.8e+01 cost=2.9e+06 flops=5.9e+09
 sigma[gemm] counter=107 total t=2.0e-03 per=7.4e+01 cost=1.2e+07 flops=5.6e+09
 sigma[red] counter=107 t=4.6e-04 per=1.7e+01 cost=9.0e+05 flops=2.0e+09
--- TIMING FOR sigma_tot : t_inter=4.9e-02 t_gemm=5.5e-01 t_reduction=7.8e-02 tot=6.8e-01 ---
 sigma_tot[inter] counter=107 t=4.9e-02 per=7.3e+00 cost=1.0e+09 flops=2.1e+10
 sigma_tot[gemm] counter=107 i=0 t=2.2e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=1 t=1.8e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=2 t=1.4e-01 per=2.1e+01 cost=9.4e+08 flops=6.7e+09
 sigma_tot[gemm] counter=107 i=3 t=1.4e-01 per=2.0e+01 cost=9.3e+08 flops=6.7e+09
 sigma_tot[gemm] counter=107 i=4 t=1.4e-01 per=2.1e+01 cost=7.8e+08 flops=5.6e+09
 sigma_tot[gemm] counter=107 i=5 t=1.3e-01 per=2.0e+01 cost=8.0e+08 flops=6.0e+09
 sigma_tot[gemm] counter=107 total t=5.5e-01 per=8.1e+01 cost=3.4e+09 flops=6.3e+09
 sigma_tot[red] counter=107 t=7.8e-02 per=1.2e+01 cost=2.2e+08 flops=2.9e+09
T(sub)=4.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.5e-05,3.2e-06,1.5e-05,5.2e-07
    9   0 +    -116.536936803243 -8.047e-08  9.281e-05    3     9  1.351e-01 1.502e-02 5.328e-03
TIMING FOR Davidson : 1.352e-01  T(cal/comm/rest)=4.795e-02,1.156e-06,8.721e-02
decomposed t_rest=8.721e-02
 T(sub)    =3.594e-04 per=4.121e-01
 T(precond)=8.194e-02 per=9.395e+01
 T(ortho)  =4.690e-03 per=5.378e+00
 T(xcopy)  =3.136e-06 per=3.596e-03
 T(xnrm2)  =8.556e-06 per=9.811e-03
 T(other)  =2.120e-04 per=2.431e-01
optimized energies: isweep=0 ibond=13 dots=1 e[0]=-116.536936803243 nmvp=9
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.007e+03S Sys:2.737e+00S Total:1.010e+03S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond13.txt
 qbond: qsuper nsym=18 dimAll=232
 (21,3):19 (23,3):34 (22,4):16 (22,2):37 (21,1):20 (23,1):21 (22,0):9 (25,3):9 (24,4):15 (24,2):21 (20,2):11 (23,5):6 (19,1):3 (20,0):3 (25,1):3 (24,0):3 (25,5):1 (24,6):1
timing for divide=1.4e-05
timing for compute=3.5e-04
timing for collect=1.8e-05
----- TMING FOR decimation_genbasis(nkr): 3.8e-04 S T(divide/compute/collect)=1.4e-05,3.5e-04,1.8e-05 -----
decimation summary: 232->42 dwt=-2.220e-16 SvN=1.332e+00
 qbond: qkept nsym=8 dimAll=42
 (23,3):8 (22,2):8 (24,2):8 (23,1):6 (25,3):4 (24,4):4 (21,1):3 (25,1):1
----- TIMING for decimation_row(nkr): 1.108e-03 S T(decim/select/formRot)=5.020e-04,5.741e-04,3.165e-05 -----
----- TIMING FOR onedot_decimation: 1.309e-03 S T(wf/decim)=1.845e-04,1.124e-03 -----
ctns::oper_renorm coord=(14,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:30 S:10 H:1 P:45 Q:55 
        dim(bra,ket)=42,42 size(op)=270:2.060e-03MB size(tot)=21070:1.608e-01MB:1.570e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.007e+03S Sys:2.749e+00S Total:1.010e+03S
----- TIMING FOR symbolic_formulae_renorm with size=141 : 1.179e-02 S -----
rank=0 GPUmem(GB): used=0.000572 (oper)=0.000542
rank=0 GPUmem(GB): used=0.000579 (oper,site)(GB)=0.000542,7.61e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=280
 no. of coefficients=3920:0.0299MB:2.92e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.047e-04 S -----
rank=0 GPUmem(GB): used=0.000608 (oper,site,rinter)=0.000542,7.61e-06,2.92e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00687 S size(rtasks)=141 size(Rlst2)=64 T(Rmu/Rlist)=0.00163,0.00523 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00731 S size(rtasks)=141 size(Rlst)=4727 -----
rank=0 GPUmem(GB): used=0.000608 (oper,site,rinter,batch)=0.000542,7.61e-06,2.92e-05,0.00972 blksize=88 blksize0=99 batchsize=4727
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000899,0.0108,0.0034
--- TIMING FOR renorm : t_inter=9.0e-04 t_gemm=1.1e-02 t_reduction=3.4e-03 tot=1.5e-02 ---
 renorm[inter] counter=14 t=9.0e-04 per=5.9e+00 cost=2.8e+06 flops=3.1e+09
 renorm[gemm] counter=14 i=0 t=1.4e-06 per=9.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=1 t=1.2e-06 per=7.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=2 t=1.2e-06 per=7.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=3 t=1.2e-06 per=7.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=4 t=3.2e-03 per=2.1e+01 cost=1.2e+06 flops=3.8e+08
 renorm[gemm] counter=14 i=5 t=3.9e-03 per=2.6e+01 cost=2.0e+06 flops=5.1e+08
 renorm[gemm] counter=14 i=6 t=3.7e-03 per=2.5e+01 cost=3.3e+06 flops=8.9e+08
 renorm[gemm] counter=14 total t=1.1e-02 per=7.2e+01 cost=6.5e+06 flops=6.0e+08
 renorm[red] counter=14 t=3.4e-03 per=2.3e+01 cost=4.0e+05 flops=1.2e+08
--- TIMING FOR renorm_tot : t_inter=1.0e-02 t_gemm=1.4e-01 t_reduction=3.1e-02 tot=1.8e-01 ---
 renorm_tot[inter] counter=14 t=1.0e-02 per=5.8e+00 cost=5.7e+07 flops=5.5e+09
 renorm_tot[gemm] counter=14 i=0 t=2.1e-05 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=1 t=1.7e-05 per=9.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=2 t=1.7e-05 per=9.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=3 t=1.7e-05 per=9.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=4 t=3.8e-02 per=2.1e+01 cost=2.6e+07 flops=7.0e+08
 renorm_tot[gemm] counter=14 i=5 t=4.8e-02 per=2.7e+01 cost=5.0e+07 flops=1.0e+09
 renorm_tot[gemm] counter=14 i=6 t=5.2e-02 per=2.9e+01 cost=1.0e+08 flops=1.9e+09
 renorm_tot[gemm] counter=14 total t=1.4e-01 per=7.7e+01 cost=1.8e+08 flops=1.3e+09
 renorm_tot[red] counter=14 t=3.1e-02 per=1.7e+01 cost=1.2e+07 flops=3.9e+08
qops.to_cpu: size(tot)=21070:1.6e-01MB:1.6e-04GB t[to_cpu]=4.8e-05S speed=3.2e+00GB/S
check ||H-H.dagger||=4.381e-14 coord=(14,0) rank=0
ctns::oper_ab2pq coord=(14,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0662 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.007e+03S Sys:2.749e+00S Total:1.010e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=464:3.540e-03MB:3.457e-06GB
total mem of comb=15631:1.193e-01MB:1.165e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.007e+03S Sys:2.749e+00S Total:1.010e+03S
##### local opt: 3.112e-01 S #####
 T(local opt: fetch) = 1.419e-02 S  per = 4.56  per(accum) = 4.56
 T(local opt: hdiag) = 1.761e-03 S  per = 0.566  per(accum) = 5.12
 T(local opt: dvdsn) = 2.253e-01 S  per = 72.4  per(accum) = 77.5
 T(local opt: decim) = 1.318e-03 S  per = 0.423  per(accum) = 77.9
 T(local opt: guess) = 2.113e-04 S  per = 0.0679  per(accum) = 78
 T(local opt: renrm) = 6.685e-02 S  per = 21.5  per(accum) = 99.5
 T(local opt: save ) = 1.636e-03 S  per = 0.526  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.253e-01 S  T(sum) = 2.249e-01 S  per = 9.982e+01
 T(local opt: preprocess                  ) = 5.151e-04 S  per = 0.229  per(accum) = 0.229
 T(local opt: symbolic_formulae           ) = 1.582e-02 S  per = 7.04  per(accum) = 7.26
 T(local opt: hintermediate init          ) = 3.287e-04 S  per = 0.146  per(accum) = 7.41
 T(local opt: preprocess_hformulae_Hxlist ) = 1.360e-02 S  per = 6.05  per(accum) = 13.5
 T(local opt: hmmtasks init               ) = 5.942e-02 S  per = 26.4  per(accum) = 39.9
 T(local opt: initial guess for dvdson    ) = 7.650e-06 S  per = 0.0034  per(accum) = 39.9
 T(local opt: dvdson solver [Hx_batchGPU] ) = 4.766e-02 S  per = 21.2  per(accum) = 61.1
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.886e-04 S  per = 0.128  per(accum) = 61.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.156e-06 S  per = 0.000514  per(accum) = 61.2
 T(local opt: dvdson solver [rest part]   ) = 8.721e-02 S  per = 38.8  per(accum) = 100
Detailed decomposition of T(renrm) = 6.685e-02 S  T(sum) = 6.685e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.519e-04 S  per = 0.227  per(accum) = 0.227
 T(local opt: qops init                    ) = 1.469e-03 S  per =  2.2  per(accum) = 2.42
 T(local opt: symbolic_formulae_renorm     ) = 1.180e-02 S  per = 17.7  per(accum) = 20.1
 T(local opt: allocate qops on gpu         ) = 2.438e-05 S  per = 0.0365  per(accum) = 20.1
 T(local opt: site memcpy cpu2gpu          ) = 1.944e-05 S  per = 0.0291  per(accum) = 20.1
 T(local opt: rintermediate init           ) = 4.148e-04 S  per = 0.62  per(accum) = 20.8
 T(local opt: preprocess_formulae_Rlist2   ) = 7.465e-03 S  per = 11.2  per(accum) = 31.9
 T(local opt: rmmtasks init                ) = 2.966e-02 S  per = 44.4  per(accum) = 76.3
 T(local opt: qops memset on cpu           ) = 5.600e-08 S  per = 8.38e-05  per(accum) = 76.3
 T(local opt: preprocess_renorm_batchGPU   ) = 1.521e-02 S  per = 22.8  per(accum) = 99
 T(local opt: reduction of opS & opH [nccl]) = 1.026e-06 S  per = 0.00153  per(accum) = 99
 T(local opt: qops memcpy gpu2cpu          ) = 5.408e-05 S  per = 0.0809  per(accum) = 99.1
 T(local opt: deallocate cpu and gpu memory) = 9.035e-05 S  per = 0.135  per(accum) = 99.3
 T(local opt: reduction of opS & opH [comm]) = 3.268e-05 S  per = 0.0489  per(accum) = 99.3
 T(local opt: conversion from opAB to opPQ ) = 3.594e-06 S  per = 0.00538  per(accum) = 99.3
 T(local opt: after oper_renorm            ) = 4.547e-04 S  per = 0.68  per(accum) = 100
##### sweep opt: 1.001e+01 S #####
 T(sweep opt: fetch) = 1.886e-01 S  per = 1.88  per(accum) = 1.88
 T(sweep opt: hdiag) = 3.389e-02 S  per = 0.339  per(accum) = 2.22
 T(sweep opt: dvdsn) = 4.419e+00 S  per = 44.2  per(accum) = 46.4
 T(sweep opt: decim) = 1.900e-02 S  per = 0.19  per(accum) = 46.6
 T(sweep opt: guess) = 4.726e-03 S  per = 0.0472  per(accum) = 46.6
 T(sweep opt: renrm) = 5.305e+00 S  per =   53  per(accum) = 99.6
 T(sweep opt: save ) = 3.588e-02 S  per = 0.359  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.419e+00 S  T(sum) = 3.966e+00 S  per = 8.973e+01
 T(sweep opt: preprocess                  ) = 6.779e-03 S  per = 0.171  per(accum) = 0.171
 T(sweep opt: symbolic_formulae           ) = 2.327e-01 S  per = 5.87  per(accum) = 6.04
 T(sweep opt: hintermediate init          ) = 5.368e-03 S  per = 0.135  per(accum) = 6.18
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.780e-01 S  per = 7.01  per(accum) = 13.2
 T(sweep opt: hmmtasks init               ) = 1.912e+00 S  per = 48.2  per(accum) = 61.4
 T(sweep opt: initial guess for dvdson    ) = 1.318e-04 S  per = 0.00332  per(accum) = 61.4
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 6.999e-01 S  per = 17.7  per(accum) = 79.1
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 3.835e-03 S  per = 0.0967  per(accum) = 79.2
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.401e-05 S  per = 0.000353  per(accum) = 79.2
 T(sweep opt: dvdson solver [rest part]   ) = 8.264e-01 S  per = 20.8  per(accum) = 100
Detailed decomposition of T(renrm) = 5.305e+00 S  T(sum) = 5.305e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.064e-03 S  per = 0.114  per(accum) = 0.114
 T(sweep opt: qops init                    ) = 5.818e-02 S  per =  1.1  per(accum) = 1.21
 T(sweep opt: symbolic_formulae_renorm     ) = 2.017e-01 S  per =  3.8  per(accum) = 5.01
 T(sweep opt: allocate qops on gpu         ) = 1.215e-03 S  per = 0.0229  per(accum) = 5.04
 T(sweep opt: site memcpy cpu2gpu          ) = 3.348e-04 S  per = 0.00631  per(accum) = 5.04
 T(sweep opt: rintermediate init           ) = 8.451e-03 S  per = 0.159  per(accum) = 5.2
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.674e-01 S  per = 3.16  per(accum) = 8.36
 T(sweep opt: rmmtasks init                ) = 6.525e-01 S  per = 12.3  per(accum) = 20.7
 T(sweep opt: qops memset on cpu           ) = 7.900e-07 S  per = 1.49e-05  per(accum) = 20.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.808e-01 S  per = 3.41  per(accum) = 24.1
 T(sweep opt: reduction of opS & opH [nccl]) = 1.509e-05 S  per = 0.000284  per(accum) = 24.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.282e-03 S  per = 0.043  per(accum) = 24.1
 T(sweep opt: deallocate cpu and gpu memory) = 1.963e-01 S  per =  3.7  per(accum) = 27.8
 T(sweep opt: reduction of opS & opH [comm]) = 6.240e-04 S  per = 0.0118  per(accum) = 27.8
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per =   72  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 9.890e-03 S  per = 0.186  per(accum) = 100
##### global opt: 1.001e+01 S #####
 T(global opt: fetch) = 1.886e-01 S  per = 1.88  per(accum) = 1.88
 T(global opt: hdiag) = 3.389e-02 S  per = 0.339  per(accum) = 2.22
 T(global opt: dvdsn) = 4.419e+00 S  per = 44.2  per(accum) = 46.4
 T(global opt: decim) = 1.900e-02 S  per = 0.19  per(accum) = 46.6
 T(global opt: guess) = 4.726e-03 S  per = 0.0472  per(accum) = 46.6
 T(global opt: renrm) = 5.305e+00 S  per =   53  per(accum) = 99.6
 T(global opt: save ) = 3.588e-02 S  per = 0.359  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.419e+00 S  T(sum) = 3.966e+00 S  per = 8.973e+01
 T(global opt: preprocess                  ) = 6.779e-03 S  per = 0.171  per(accum) = 0.171
 T(global opt: symbolic_formulae           ) = 2.327e-01 S  per = 5.87  per(accum) = 6.04
 T(global opt: hintermediate init          ) = 5.368e-03 S  per = 0.135  per(accum) = 6.18
 T(global opt: preprocess_hformulae_Hxlist ) = 2.780e-01 S  per = 7.01  per(accum) = 13.2
 T(global opt: hmmtasks init               ) = 1.912e+00 S  per = 48.2  per(accum) = 61.4
 T(global opt: initial guess for dvdson    ) = 1.318e-04 S  per = 0.00332  per(accum) = 61.4
 T(global opt: dvdson solver [Hx_batchGPU] ) = 6.999e-01 S  per = 17.7  per(accum) = 79.1
 T(global opt: dvdson solver [comm(gpu)]   ) = 3.835e-03 S  per = 0.0967  per(accum) = 79.2
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.401e-05 S  per = 0.000353  per(accum) = 79.2
 T(global opt: dvdson solver [rest part]   ) = 8.264e-01 S  per = 20.8  per(accum) = 100
Detailed decomposition of T(renrm) = 5.305e+00 S  T(sum) = 5.305e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.064e-03 S  per = 0.114  per(accum) = 0.114
 T(global opt: qops init                    ) = 5.818e-02 S  per =  1.1  per(accum) = 1.21
 T(global opt: symbolic_formulae_renorm     ) = 2.017e-01 S  per =  3.8  per(accum) = 5.01
 T(global opt: allocate qops on gpu         ) = 1.215e-03 S  per = 0.0229  per(accum) = 5.04
 T(global opt: site memcpy cpu2gpu          ) = 3.348e-04 S  per = 0.00631  per(accum) = 5.04
 T(global opt: rintermediate init           ) = 8.451e-03 S  per = 0.159  per(accum) = 5.2
 T(global opt: preprocess_formulae_Rlist2   ) = 1.674e-01 S  per = 3.16  per(accum) = 8.36
 T(global opt: rmmtasks init                ) = 6.525e-01 S  per = 12.3  per(accum) = 20.7
 T(global opt: qops memset on cpu           ) = 7.900e-07 S  per = 1.49e-05  per(accum) = 20.7
 T(global opt: preprocess_renorm_batchGPU   ) = 1.808e-01 S  per = 3.41  per(accum) = 24.1
 T(global opt: reduction of opS & opH [nccl]) = 1.509e-05 S  per = 0.000284  per(accum) = 24.1
 T(global opt: qops memcpy gpu2cpu          ) = 2.282e-03 S  per = 0.043  per(accum) = 24.1
 T(global opt: deallocate cpu and gpu memory) = 1.963e-01 S  per =  3.7  per(accum) = 27.8
 T(global opt: reduction of opS & opH [comm]) = 6.240e-04 S  per = 0.0118  per(accum) = 27.8
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per =   72  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 9.890e-03 S  per = 0.186  per(accum) = 100

isweep=0 ibond=14/seqsize=34 dots=1 dbond=(15,0)-(16,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.007e+03S Sys:2.750e+00S Total:1.010e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=464:3.540e-03MB:3.457e-06GB
total mem of comb=15631:1.193e-01MB:1.165e-04GB
ctns::topology::check_partition: (sl,sr,sc)=15,4,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 12 13 14 15
 suppc= 11
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:30 S:10 H:1 P:45 Q:55 
        dim(bra,ket)=42,42 size(op)=270:2.060e-03MB size(tot)=21070:1.608e-01MB:1.570e-04GB
 rqops: oplist=CSHAB nops=C:8 S:32 H:1 A:28 B:36 
        dim(bra,ket)=24,24 size(op)=104:7.935e-04MB size(tot)=5708:4.355e-02MB:4.253e-05GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=29114:2.221e-01MB:2.169e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(15,0) fdel=./scratch/sweep/rop(16,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
wf3(diml,dimr,dimc)=(42,24,4) nnz=464:3.540e-03MB
qtensor3: wf3 own=1 _data=0x528a7810
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=8 dimAll=42
 (23,3):8 (22,2):8 (24,2):8 (23,1):6 (25,3):4 (24,4):4 (21,1):3 (25,1):1
 qbond: qcol nsym=7 dimAll=24
 (6,-2):6 (4,-2):5 (5,-1):4 (5,-3):4 (7,-1):3 (3,-3):1 (4,-4):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=20 nblocks=224 size=464:3.540e-03MB
### DIAG TIMING: total=7.772e-04 t1=1.401e-05, t2=1.326e-05, t3=2.657e-05, t4=7.013e-04, t5=6.462e-06, t6=1.255e-05, t7=3.032e-06
duration_diagGPU:7.868e-04
duration_diagreduce:2.900e-08
duration_diagtransform:1.833e-06
----- TIMING FOR symbolic_formulae_onedot with size=435 : 7.952e-03 S -----
rank=0 GPUmem(GB): used=0.000217 (oper)=0.000217
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=435
 no. of hintermediate operators=188
 no. of coefficients=2820:0.0215MB:2.1e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.617e-04 S -----
rank=0 GPUmem(GB): used=0.000238 (oper,hinter)=0.000217,2.1e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00611 S size(H_formulae)=435 size(Hxlst2)=20 T(Hmu/Hxlist)=0.000921,0.00519 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00656 S size(H_formulae)=435 size(Hxlst)=5870 -----
rank=0 GPUmem(GB): used=0.00729 (oper,hinter,dvdson,batch)=0.000217,2.1e-05,6.91e-06,0.00704 blksize=48 blksize0=64 batchsize=5870
ctns::pdvdsonSolver_nkr::solve_iter ndim=464 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.44e-05,0.000793,0.0143,0.00178,0.017
 ndim=464:3.46e-06GB t[comm(intra)]=2.57e-05 speed=0.269GB/S t[comm(inter)]=8.69e-06 speed=0.795GB/S
--- TIMING FOR sigma : t_inter=7.9e-04 t_gemm=1.4e-02 t_reduction=1.8e-03 tot=1.7e-02 ---
 sigma[inter] counter=108 t=7.9e-04 per=4.7e+00 cost=2.2e+06 flops=2.8e+09
 sigma[gemm] counter=108 i=0 t=1.5e-06 per=8.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=1 t=1.1e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=2 t=3.6e-03 per=2.1e+01 cost=6.0e+05 flops=1.6e+08
 sigma[gemm] counter=108 i=3 t=3.7e-03 per=2.2e+01 cost=5.8e+05 flops=1.5e+08
 sigma[gemm] counter=108 i=4 t=3.5e-03 per=2.0e+01 cost=7.8e+05 flops=2.2e+08
 sigma[gemm] counter=108 i=5 t=3.5e-03 per=2.1e+01 cost=7.6e+05 flops=2.2e+08
 sigma[gemm] counter=108 total t=1.4e-02 per=8.5e+01 cost=2.7e+06 flops=1.9e+08
 sigma[red] counter=108 t=1.8e-03 per=1.1e+01 cost=3.0e+05 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=5.0e-02 t_gemm=5.6e-01 t_reduction=8.0e-02 tot=6.9e-01 ---
 sigma_tot[inter] counter=108 t=5.0e-02 per=7.2e+00 cost=1.0e+09 flops=2.1e+10
 sigma_tot[gemm] counter=108 i=0 t=2.2e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=1 t=1.8e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=2 t=1.4e-01 per=2.1e+01 cost=9.4e+08 flops=6.6e+09
 sigma_tot[gemm] counter=108 i=3 t=1.4e-01 per=2.0e+01 cost=9.3e+08 flops=6.5e+09
 sigma_tot[gemm] counter=108 i=4 t=1.4e-01 per=2.1e+01 cost=7.8e+08 flops=5.5e+09
 sigma_tot[gemm] counter=108 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=108 total t=5.6e-01 per=8.1e+01 cost=3.4e+09 flops=6.1e+09
 sigma_tot[red] counter=108 t=8.0e-02 per=1.1e+01 cost=2.2e+08 flops=2.8e+09
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.1e-06,4.2e-06,1.8e-06,1.2e-06,3.0e-07
settings: ndim=464 neig=1 maxcycle=30 nbuff=4 memory=5e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.536936803243 -1.117e+03  4.290e-02    1     1  1.709e-02 1.709e-02 1.707e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.551e-05,1.829e-04,1.779e-03,3.613e-04,2.356e-03
 ndim=464:3.457e-06GB t[comm(intra)]=2.086e-05 speed=3.314e-01GB/S t[comm(inter)]=4.649e-06 speed=1.487e+00GB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.8e-03 t_reduction=3.6e-04 tot=2.3e-03 ---
 sigma[inter] counter=109 t=1.8e-04 per=7.9e+00 cost=2.2e+06 flops=1.2e+10
 sigma[gemm] counter=109 i=0 t=2.0e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=1 t=1.7e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=2 t=4.9e-04 per=2.1e+01 cost=6.0e+05 flops=1.2e+09
 sigma[gemm] counter=109 i=3 t=4.3e-04 per=1.8e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=109 i=4 t=4.4e-04 per=1.9e+01 cost=7.8e+05 flops=1.8e+09
 sigma[gemm] counter=109 i=5 t=4.1e-04 per=1.8e+01 cost=7.6e+05 flops=1.8e+09
 sigma[gemm] counter=109 total t=1.8e-03 per=7.7e+01 cost=2.7e+06 flops=1.5e+09
 sigma[red] counter=109 t=3.6e-04 per=1.6e+01 cost=3.0e+05 flops=8.3e+08
--- TIMING FOR sigma_tot : t_inter=5.0e-02 t_gemm=5.6e-01 t_reduction=8.0e-02 tot=6.9e-01 ---
 sigma_tot[inter] counter=109 t=5.0e-02 per=7.2e+00 cost=1.0e+09 flops=2.1e+10
 sigma_tot[gemm] counter=109 i=0 t=2.2e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=1 t=1.8e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=2 t=1.4e-01 per=2.1e+01 cost=9.4e+08 flops=6.6e+09
 sigma_tot[gemm] counter=109 i=3 t=1.4e-01 per=2.0e+01 cost=9.3e+08 flops=6.5e+09
 sigma_tot[gemm] counter=109 i=4 t=1.4e-01 per=2.1e+01 cost=7.8e+08 flops=5.5e+09
 sigma_tot[gemm] counter=109 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=109 total t=5.6e-01 per=8.1e+01 cost=3.4e+09 flops=6.1e+09
 sigma_tot[red] counter=109 t=8.0e-02 per=1.2e+01 cost=2.2e+08 flops=2.8e+09
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=7.4e-06,1.2e-05,3.8e-06,2.3e-06,3.9e-07
    2   0 -    -116.539032428493 -2.096e-03  1.232e-02    2     2  3.276e-02 1.638e-02 9.781e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.915e-05,1.761e-04,1.786e-03,3.607e-04,2.359e-03
 ndim=464:3.457e-06GB t[comm(intra)]=2.459e-05 speed=2.812e-01GB/S t[comm(inter)]=4.565e-06 speed=1.515e+00GB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.8e-03 t_reduction=3.6e-04 tot=2.3e-03 ---
 sigma[inter] counter=110 t=1.8e-04 per=7.6e+00 cost=2.2e+06 flops=1.3e+10
 sigma[gemm] counter=110 i=0 t=1.9e-06 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=1 t=1.7e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=2 t=5.1e-04 per=2.2e+01 cost=6.0e+05 flops=1.2e+09
 sigma[gemm] counter=110 i=3 t=4.3e-04 per=1.8e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=110 i=4 t=4.4e-04 per=1.9e+01 cost=7.8e+05 flops=1.8e+09
 sigma[gemm] counter=110 i=5 t=4.1e-04 per=1.8e+01 cost=7.6e+05 flops=1.9e+09
 sigma[gemm] counter=110 total t=1.8e-03 per=7.7e+01 cost=2.7e+06 flops=1.5e+09
 sigma[red] counter=110 t=3.6e-04 per=1.6e+01 cost=3.0e+05 flops=8.3e+08
--- TIMING FOR sigma_tot : t_inter=5.0e-02 t_gemm=5.7e-01 t_reduction=8.0e-02 tot=7.0e-01 ---
 sigma_tot[inter] counter=110 t=5.0e-02 per=7.2e+00 cost=1.1e+09 flops=2.1e+10
 sigma_tot[gemm] counter=110 i=0 t=2.2e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=1 t=1.8e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=2 t=1.4e-01 per=2.1e+01 cost=9.4e+08 flops=6.5e+09
 sigma_tot[gemm] counter=110 i=3 t=1.4e-01 per=2.0e+01 cost=9.3e+08 flops=6.5e+09
 sigma_tot[gemm] counter=110 i=4 t=1.4e-01 per=2.1e+01 cost=7.8e+08 flops=5.5e+09
 sigma_tot[gemm] counter=110 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=110 total t=5.7e-01 per=8.1e+01 cost=3.4e+09 flops=6.1e+09
 sigma_tot[red] counter=110 t=8.0e-02 per=1.2e+01 cost=2.2e+08 flops=2.8e+09
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=7.6e-06,1.6e-05,3.3e-06,2.9e-06,3.7e-07
    3   0 -    -116.539285680072 -2.533e-04  5.039e-03    3     3  4.374e-02 1.458e-02 7.354e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.494e-05,1.767e-04,1.767e-03,3.604e-04,2.336e-03
 ndim=464:3.457e-06GB t[comm(intra)]=2.055e-05 speed=3.365e-01GB/S t[comm(inter)]=4.391e-06 speed=1.575e+00GB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.8e-03 t_reduction=3.6e-04 tot=2.3e-03 ---
 sigma[inter] counter=111 t=1.8e-04 per=7.7e+00 cost=2.2e+06 flops=1.3e+10
 sigma[gemm] counter=111 i=0 t=1.9e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=1 t=1.7e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=2 t=4.9e-04 per=2.1e+01 cost=6.0e+05 flops=1.2e+09
 sigma[gemm] counter=111 i=3 t=4.3e-04 per=1.9e+01 cost=5.8e+05 flops=1.3e+09
 sigma[gemm] counter=111 i=4 t=4.2e-04 per=1.8e+01 cost=7.8e+05 flops=1.9e+09
 sigma[gemm] counter=111 i=5 t=4.2e-04 per=1.8e+01 cost=7.6e+05 flops=1.8e+09
 sigma[gemm] counter=111 total t=1.8e-03 per=7.7e+01 cost=2.7e+06 flops=1.5e+09
 sigma[red] counter=111 t=3.6e-04 per=1.6e+01 cost=3.0e+05 flops=8.3e+08
--- TIMING FOR sigma_tot : t_inter=5.0e-02 t_gemm=5.7e-01 t_reduction=8.1e-02 tot=7.0e-01 ---
 sigma_tot[inter] counter=111 t=5.0e-02 per=7.2e+00 cost=1.1e+09 flops=2.1e+10
 sigma_tot[gemm] counter=111 i=0 t=2.3e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=1 t=1.8e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=2 t=1.4e-01 per=2.1e+01 cost=9.4e+08 flops=6.5e+09
 sigma_tot[gemm] counter=111 i=3 t=1.4e-01 per=2.0e+01 cost=9.3e+08 flops=6.5e+09
 sigma_tot[gemm] counter=111 i=4 t=1.4e-01 per=2.1e+01 cost=7.8e+08 flops=5.4e+09
 sigma_tot[gemm] counter=111 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.8e+09
 sigma_tot[gemm] counter=111 total t=5.7e-01 per=8.1e+01 cost=3.5e+09 flops=6.1e+09
 sigma_tot[red] counter=111 t=8.1e-02 per=1.2e+01 cost=2.2e+08 flops=2.8e+09
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=7.5e-06,1.5e-05,3.2e-06,2.9e-06,3.4e-07
    4   0 -    -116.539333934466 -4.825e-05  2.161e-03    3     4  5.556e-02 1.389e-02 6.131e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.465e-05,1.751e-04,1.761e-03,3.603e-04,2.328e-03
 ndim=464:3.457e-06GB t[comm(intra)]=1.990e-05 speed=3.474e-01GB/S t[comm(inter)]=4.750e-06 speed=1.456e+00GB/S
--- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=1.8e-03 t_reduction=3.6e-04 tot=2.3e-03 ---
 sigma[inter] counter=112 t=1.7e-04 per=7.6e+00 cost=2.2e+06 flops=1.3e+10
 sigma[gemm] counter=112 i=0 t=1.9e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=1 t=1.7e-06 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=2 t=4.8e-04 per=2.1e+01 cost=6.0e+05 flops=1.2e+09
 sigma[gemm] counter=112 i=3 t=4.4e-04 per=1.9e+01 cost=5.8e+05 flops=1.3e+09
 sigma[gemm] counter=112 i=4 t=4.3e-04 per=1.9e+01 cost=7.8e+05 flops=1.8e+09
 sigma[gemm] counter=112 i=5 t=4.1e-04 per=1.8e+01 cost=7.6e+05 flops=1.9e+09
 sigma[gemm] counter=112 total t=1.8e-03 per=7.7e+01 cost=2.7e+06 flops=1.5e+09
 sigma[red] counter=112 t=3.6e-04 per=1.6e+01 cost=3.0e+05 flops=8.3e+08
--- TIMING FOR sigma_tot : t_inter=5.0e-02 t_gemm=5.7e-01 t_reduction=8.1e-02 tot=7.0e-01 ---
 sigma_tot[inter] counter=112 t=5.0e-02 per=7.2e+00 cost=1.1e+09 flops=2.1e+10
 sigma_tot[gemm] counter=112 i=0 t=2.3e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=1 t=1.8e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.5e+09
 sigma_tot[gemm] counter=112 i=3 t=1.4e-01 per=2.0e+01 cost=9.3e+08 flops=6.5e+09
 sigma_tot[gemm] counter=112 i=4 t=1.4e-01 per=2.1e+01 cost=7.8e+08 flops=5.4e+09
 sigma_tot[gemm] counter=112 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.8e+09
 sigma_tot[gemm] counter=112 total t=5.7e-01 per=8.1e+01 cost=3.5e+09 flops=6.1e+09
 sigma_tot[red] counter=112 t=8.1e-02 per=1.2e+01 cost=2.2e+08 flops=2.8e+09
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=7.5e-06,1.5e-05,3.4e-06,2.9e-06,3.6e-07
    5   0 -    -116.539343390333 -9.456e-06  8.305e-04    3     5  7.177e-02 1.435e-02 5.399e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.471e-05,1.779e-04,1.769e-03,3.582e-04,2.337e-03
 ndim=464:3.457e-06GB t[comm(intra)]=2.014e-05 speed=3.433e-01GB/S t[comm(inter)]=4.571e-06 speed=1.513e+00GB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.8e-03 t_reduction=3.6e-04 tot=2.3e-03 ---
 sigma[inter] counter=113 t=1.8e-04 per=7.7e+00 cost=2.2e+06 flops=1.2e+10
 sigma[gemm] counter=113 i=0 t=2.0e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=1 t=1.7e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=2 t=4.9e-04 per=2.1e+01 cost=6.0e+05 flops=1.2e+09
 sigma[gemm] counter=113 i=3 t=4.3e-04 per=1.9e+01 cost=5.8e+05 flops=1.3e+09
 sigma[gemm] counter=113 i=4 t=4.2e-04 per=1.8e+01 cost=7.8e+05 flops=1.9e+09
 sigma[gemm] counter=113 i=5 t=4.3e-04 per=1.9e+01 cost=7.6e+05 flops=1.8e+09
 sigma[gemm] counter=113 total t=1.8e-03 per=7.7e+01 cost=2.7e+06 flops=1.5e+09
 sigma[red] counter=113 t=3.6e-04 per=1.6e+01 cost=3.0e+05 flops=8.4e+08
--- TIMING FOR sigma_tot : t_inter=5.1e-02 t_gemm=5.7e-01 t_reduction=8.1e-02 tot=7.0e-01 ---
 sigma_tot[inter] counter=113 t=5.1e-02 per=7.2e+00 cost=1.1e+09 flops=2.1e+10
 sigma_tot[gemm] counter=113 i=0 t=2.3e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=1 t=1.9e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.5e+09
 sigma_tot[gemm] counter=113 i=3 t=1.4e-01 per=2.0e+01 cost=9.3e+08 flops=6.5e+09
 sigma_tot[gemm] counter=113 i=4 t=1.4e-01 per=2.1e+01 cost=7.8e+08 flops=5.4e+09
 sigma_tot[gemm] counter=113 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.8e+09
 sigma_tot[gemm] counter=113 total t=5.7e-01 per=8.1e+01 cost=3.5e+09 flops=6.0e+09
 sigma_tot[red] counter=113 t=8.1e-02 per=1.2e+01 cost=2.3e+08 flops=2.8e+09
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=7.6e-06,1.5e-05,3.2e-06,2.8e-06,3.5e-07
    6   0 -    -116.539344612303 -1.222e-06  3.005e-04    3     6  8.358e-02 1.393e-02 4.910e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.556e-05,1.767e-04,1.760e-03,3.613e-04,2.331e-03
 ndim=464:3.457e-06GB t[comm(intra)]=2.103e-05 speed=3.288e-01GB/S t[comm(inter)]=4.528e-06 speed=1.527e+00GB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.8e-03 t_reduction=3.6e-04 tot=2.3e-03 ---
 sigma[inter] counter=114 t=1.8e-04 per=7.7e+00 cost=2.2e+06 flops=1.3e+10
 sigma[gemm] counter=114 i=0 t=1.9e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=1 t=1.7e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=2 t=4.7e-04 per=2.0e+01 cost=6.0e+05 flops=1.3e+09
 sigma[gemm] counter=114 i=3 t=4.4e-04 per=1.9e+01 cost=5.8e+05 flops=1.3e+09
 sigma[gemm] counter=114 i=4 t=4.2e-04 per=1.8e+01 cost=7.8e+05 flops=1.9e+09
 sigma[gemm] counter=114 i=5 t=4.3e-04 per=1.9e+01 cost=7.6e+05 flops=1.8e+09
 sigma[gemm] counter=114 total t=1.8e-03 per=7.7e+01 cost=2.7e+06 flops=1.5e+09
 sigma[red] counter=114 t=3.6e-04 per=1.6e+01 cost=3.0e+05 flops=8.3e+08
--- TIMING FOR sigma_tot : t_inter=5.1e-02 t_gemm=5.7e-01 t_reduction=8.2e-02 tot=7.1e-01 ---
 sigma_tot[inter] counter=114 t=5.1e-02 per=7.2e+00 cost=1.1e+09 flops=2.1e+10
 sigma_tot[gemm] counter=114 i=0 t=2.3e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=1 t=1.9e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.5e+09
 sigma_tot[gemm] counter=114 i=3 t=1.4e-01 per=2.0e+01 cost=9.3e+08 flops=6.4e+09
 sigma_tot[gemm] counter=114 i=4 t=1.4e-01 per=2.1e+01 cost=7.8e+08 flops=5.4e+09
 sigma_tot[gemm] counter=114 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.8e+09
 sigma_tot[gemm] counter=114 total t=5.7e-01 per=8.1e+01 cost=3.5e+09 flops=6.0e+09
 sigma_tot[red] counter=114 t=8.2e-02 per=1.2e+01 cost=2.3e+08 flops=2.8e+09
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=7.5e-06,1.5e-05,3.1e-06,2.9e-06,3.5e-07
    7   0 -    -116.539344781104 -1.688e-07  1.341e-04    3     7  9.537e-02 1.362e-02 4.559e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.483e-05,1.773e-04,1.767e-03,3.745e-04,2.351e-03
 ndim=464:3.457e-06GB t[comm(intra)]=2.030e-05 speed=3.406e-01GB/S t[comm(inter)]=4.535e-06 speed=1.525e+00GB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.8e-03 t_reduction=3.7e-04 tot=2.3e-03 ---
 sigma[inter] counter=115 t=1.8e-04 per=7.6e+00 cost=2.2e+06 flops=1.2e+10
 sigma[gemm] counter=115 i=0 t=1.9e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=1 t=1.7e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=2 t=4.8e-04 per=2.1e+01 cost=6.0e+05 flops=1.3e+09
 sigma[gemm] counter=115 i=3 t=4.6e-04 per=2.0e+01 cost=5.8e+05 flops=1.3e+09
 sigma[gemm] counter=115 i=4 t=4.2e-04 per=1.8e+01 cost=7.8e+05 flops=1.8e+09
 sigma[gemm] counter=115 i=5 t=4.1e-04 per=1.8e+01 cost=7.6e+05 flops=1.9e+09
 sigma[gemm] counter=115 total t=1.8e-03 per=7.6e+01 cost=2.7e+06 flops=1.5e+09
 sigma[red] counter=115 t=3.7e-04 per=1.6e+01 cost=3.0e+05 flops=8.0e+08
--- TIMING FOR sigma_tot : t_inter=5.1e-02 t_gemm=5.8e-01 t_reduction=8.2e-02 tot=7.1e-01 ---
 sigma_tot[inter] counter=115 t=5.1e-02 per=7.2e+00 cost=1.1e+09 flops=2.1e+10
 sigma_tot[gemm] counter=115 i=0 t=2.3e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=1 t=1.9e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.4e+09
 sigma_tot[gemm] counter=115 i=3 t=1.4e-01 per=2.0e+01 cost=9.3e+08 flops=6.4e+09
 sigma_tot[gemm] counter=115 i=4 t=1.5e-01 per=2.1e+01 cost=7.8e+08 flops=5.4e+09
 sigma_tot[gemm] counter=115 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.8e+09
 sigma_tot[gemm] counter=115 total t=5.8e-01 per=8.1e+01 cost=3.5e+09 flops=6.0e+09
 sigma_tot[red] counter=115 t=8.2e-02 per=1.2e+01 cost=2.3e+08 flops=2.8e+09
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=7.3e-06,1.5e-05,3.2e-06,2.9e-06,3.6e-07
    8   0 +    -116.539344816793 -3.569e-08  6.451e-05    3     8  1.072e-01 1.340e-02 4.299e-03
TIMING FOR Davidson : 1.072e-01  T(cal/comm/rest)=3.439e-02,1.032e-06,7.281e-02
decomposed t_rest=7.281e-02
 T(sub)    =2.110e-04 per=2.897e-01
 T(precond)=7.231e-02 per=9.931e+01
 T(ortho)  =3.199e-05 per=4.393e-02
 T(xcopy)  =1.701e-06 per=2.336e-03
 T(xnrm2)  =5.375e-06 per=7.382e-03
 T(other)  =2.532e-04 per=3.478e-01
optimized energies: isweep=0 ibond=14 dots=1 e[0]=-116.539344816793 nmvp=8
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.017e+03S Sys:2.756e+00S Total:1.020e+03S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=16 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond14.txt
 qbond: qsuper nsym=16 dimAll=168
 (23,3):16 (25,3):24 (24,4):12 (24,2):30 (22,2):11 (23,1):17 (26,2):13 (25,1):15 (24,0):6 (27,3):4 (26,4):8 (25,5):4 (21,1):3 (22,0):3 (27,1):1 (26,0):1
timing for divide=1.4e-05
timing for compute=1.7e-04
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(nkr): 2.1e-04 S T(divide/compute/collect)=1.4e-05,1.7e-04,1.6e-05 -----
decimation summary: 168->24 dwt=-2.220e-16 SvN=1.397e+00
 qbond: qkept nsym=7 dimAll=24
 (24,2):6 (26,2):5 (25,3):4 (25,1):4 (23,1):3 (27,3):1 (26,4):1
----- TIMING for decimation_row(nkr): 7.584e-04 S T(decim/select/formRot)=2.948e-04,4.252e-04,3.839e-05 -----
----- TIMING FOR onedot_decimation: 9.239e-04 S T(wf/decim)=1.467e-04,7.772e-04 -----
ctns::oper_renorm coord=(15,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:32 S:8 H:1 P:28 Q:36 
        dim(bra,ket)=24,24 size(op)=104:7.935e-04MB size(tot)=5708:4.355e-02MB:4.253e-05GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.017e+03S Sys:2.756e+00S Total:1.020e+03S
----- TIMING FOR symbolic_formulae_renorm with size=105 : 8.070e-03 S -----
rank=0 GPUmem(GB): used=0.000238 (oper)=0.000217
rank=0 GPUmem(GB): used=0.000241 (oper,site)(GB)=0.000217,3.46e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=188
 no. of coefficients=2820:0.0215MB:2.1e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.689e-04 S -----
rank=0 GPUmem(GB): used=0.000262 (oper,site,rinter)=0.000217,3.46e-06,2.1e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00487 S size(rtasks)=105 size(Rlst2)=49 T(Rmu/Rlist)=0.00123,0.00364 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00519 S size(rtasks)=105 size(Rlst)=3221 -----
rank=0 GPUmem(GB): used=0.000262 (oper,site,rinter,batch)=0.000217,3.46e-06,2.1e-05,0.00386 blksize=48 blksize0=64 batchsize=3221
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000673,0.00933,0.00313
--- TIMING FOR renorm : t_inter=6.7e-04 t_gemm=9.3e-03 t_reduction=3.1e-03 tot=1.3e-02 ---
 renorm[inter] counter=15 t=6.7e-04 per=5.1e+00 cost=1.1e+06 flops=1.6e+09
 renorm[gemm] counter=15 i=0 t=1.4e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=1 t=1.2e-06 per=8.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=2 t=1.2e-06 per=8.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=3 t=1.2e-06 per=8.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=4 t=2.6e-03 per=2.0e+01 cost=3.2e+05 flops=1.2e+08
 renorm[gemm] counter=15 i=5 t=3.2e-03 per=2.4e+01 cost=5.3e+05 flops=1.7e+08
 renorm[gemm] counter=15 i=6 t=3.6e-03 per=2.7e+01 cost=7.5e+05 flops=2.1e+08
 renorm[gemm] counter=15 total t=9.3e-03 per=7.1e+01 cost=1.6e+06 flops=1.7e+08
 renorm[red] counter=15 t=3.1e-03 per=2.4e+01 cost=1.2e+05 flops=3.7e+07
--- TIMING FOR renorm_tot : t_inter=1.1e-02 t_gemm=1.5e-01 t_reduction=3.4e-02 tot=1.9e-01 ---
 renorm_tot[inter] counter=15 t=1.1e-02 per=5.8e+00 cost=5.8e+07 flops=5.3e+09
 renorm_tot[gemm] counter=15 i=0 t=2.2e-05 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=1 t=1.8e-05 per=9.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=2 t=1.8e-05 per=9.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=3 t=1.8e-05 per=9.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=4 t=4.1e-02 per=2.1e+01 cost=2.7e+07 flops=6.6e+08
 renorm_tot[gemm] counter=15 i=5 t=5.1e-02 per=2.6e+01 cost=5.0e+07 flops=9.9e+08
 renorm_tot[gemm] counter=15 i=6 t=5.5e-02 per=2.9e+01 cost=1.0e+08 flops=1.8e+09
 renorm_tot[gemm] counter=15 total t=1.5e-01 per=7.6e+01 cost=1.8e+08 flops=1.2e+09
 renorm_tot[red] counter=15 t=3.4e-02 per=1.8e+01 cost=1.2e+07 flops=3.6e+08
qops.to_cpu: size(tot)=5708:4.4e-02MB:4.3e-05GB t[to_cpu]=2.4e-05S speed=1.8e+00GB/S
check ||H-H.dagger||=3.217e-14 coord=(15,0) rank=0
ctns::oper_ab2pq coord=(15,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0484 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.017e+03S Sys:2.757e+00S Total:1.020e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=131:9.995e-04MB:9.760e-07GB
total mem of comb=15298:1.167e-01MB:1.140e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.017e+03S Sys:2.759e+00S Total:1.020e+03S
##### local opt: 2.182e-01 S #####
 T(local opt: fetch) = 9.139e-03 S  per = 4.19  per(accum) = 4.19
 T(local opt: hdiag) = 8.398e-04 S  per = 0.385  per(accum) = 4.57
 T(local opt: dvdsn) = 1.560e-01 S  per = 71.5  per(accum) = 76.1
 T(local opt: decim) = 9.345e-04 S  per = 0.428  per(accum) = 76.5
 T(local opt: guess) = 2.160e-04 S  per = 0.099  per(accum) = 76.6
 T(local opt: renrm) = 4.887e-02 S  per = 22.4  per(accum) = 99
 T(local opt: save ) = 2.167e-03 S  per = 0.993  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.560e-01 S  T(sum) = 1.556e-01 S  per = 9.977e+01
 T(local opt: preprocess                  ) = 2.958e-04 S  per = 0.19  per(accum) = 0.19
 T(local opt: symbolic_formulae           ) = 7.964e-03 S  per = 5.12  per(accum) = 5.31
 T(local opt: hintermediate init          ) = 1.753e-04 S  per = 0.113  per(accum) = 5.42
 T(local opt: preprocess_hformulae_Hxlist ) = 6.724e-03 S  per = 4.32  per(accum) = 9.74
 T(local opt: hmmtasks init               ) = 3.327e-02 S  per = 21.4  per(accum) = 31.1
 T(local opt: initial guess for dvdson    ) = 5.267e-06 S  per = 0.00338  per(accum) = 31.1
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.418e-02 S  per =   22  per(accum) = 53.1
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.137e-04 S  per = 0.137  per(accum) = 53.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.032e-06 S  per = 0.000663  per(accum) = 53.2
 T(local opt: dvdson solver [rest part]   ) = 7.281e-02 S  per = 46.8  per(accum) = 100
Detailed decomposition of T(renrm) = 4.887e-02 S  T(sum) = 4.887e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.546e-04 S  per = 0.316  per(accum) = 0.316
 T(local opt: qops init                    ) = 1.215e-03 S  per = 2.49  per(accum) = 2.8
 T(local opt: symbolic_formulae_renorm     ) = 8.082e-03 S  per = 16.5  per(accum) = 19.3
 T(local opt: allocate qops on gpu         ) = 2.661e-05 S  per = 0.0544  per(accum) = 19.4
 T(local opt: site memcpy cpu2gpu          ) = 1.876e-05 S  per = 0.0384  per(accum) = 19.4
 T(local opt: rintermediate init           ) = 2.788e-04 S  per = 0.57  per(accum) = 20
 T(local opt: preprocess_formulae_Rlist2   ) = 5.306e-03 S  per = 10.9  per(accum) = 30.9
 T(local opt: rmmtasks init                ) = 2.007e-02 S  per = 41.1  per(accum) = 71.9
 T(local opt: qops memset on cpu           ) = 3.800e-08 S  per = 7.78e-05  per(accum) = 71.9
 T(local opt: preprocess_renorm_batchGPU   ) = 1.323e-02 S  per = 27.1  per(accum) = 99
 T(local opt: reduction of opS & opH [nccl]) = 1.049e-06 S  per = 0.00215  per(accum) = 99
 T(local opt: qops memcpy gpu2cpu          ) = 2.945e-05 S  per = 0.0603  per(accum) = 99.1
 T(local opt: deallocate cpu and gpu memory) = 9.504e-05 S  per = 0.194  per(accum) = 99.2
 T(local opt: reduction of opS & opH [comm]) = 2.741e-05 S  per = 0.0561  per(accum) = 99.3
 T(local opt: conversion from opAB to opPQ ) = 3.676e-06 S  per = 0.00752  per(accum) = 99.3
 T(local opt: after oper_renorm            ) = 3.368e-04 S  per = 0.689  per(accum) = 100
##### sweep opt: 1.022e+01 S #####
 T(sweep opt: fetch) = 1.977e-01 S  per = 1.93  per(accum) = 1.93
 T(sweep opt: hdiag) = 3.473e-02 S  per = 0.34  per(accum) = 2.27
 T(sweep opt: dvdsn) = 4.575e+00 S  per = 44.7  per(accum) = 47
 T(sweep opt: decim) = 1.993e-02 S  per = 0.195  per(accum) = 47.2
 T(sweep opt: guess) = 4.942e-03 S  per = 0.0483  per(accum) = 47.3
 T(sweep opt: renrm) = 5.354e+00 S  per = 52.4  per(accum) = 99.6
 T(sweep opt: save ) = 3.805e-02 S  per = 0.372  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.575e+00 S  T(sum) = 4.121e+00 S  per = 9.007e+01
 T(sweep opt: preprocess                  ) = 7.075e-03 S  per = 0.172  per(accum) = 0.172
 T(sweep opt: symbolic_formulae           ) = 2.407e-01 S  per = 5.84  per(accum) = 6.01
 T(sweep opt: hintermediate init          ) = 5.544e-03 S  per = 0.135  per(accum) = 6.15
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.847e-01 S  per = 6.91  per(accum) = 13.1
 T(sweep opt: hmmtasks init               ) = 1.946e+00 S  per = 47.2  per(accum) = 60.3
 T(sweep opt: initial guess for dvdson    ) = 1.370e-04 S  per = 0.00332  per(accum) = 60.3
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 7.341e-01 S  per = 17.8  per(accum) = 78.1
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.049e-03 S  per = 0.0982  per(accum) = 78.2
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.505e-05 S  per = 0.000365  per(accum) = 78.2
 T(sweep opt: dvdson solver [rest part]   ) = 8.992e-01 S  per = 21.8  per(accum) = 100
Detailed decomposition of T(renrm) = 5.354e+00 S  T(sum) = 5.354e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.218e-03 S  per = 0.116  per(accum) = 0.116
 T(sweep opt: qops init                    ) = 5.940e-02 S  per = 1.11  per(accum) = 1.23
 T(sweep opt: symbolic_formulae_renorm     ) = 2.098e-01 S  per = 3.92  per(accum) = 5.14
 T(sweep opt: allocate qops on gpu         ) = 1.242e-03 S  per = 0.0232  per(accum) = 5.17
 T(sweep opt: site memcpy cpu2gpu          ) = 3.536e-04 S  per = 0.0066  per(accum) = 5.17
 T(sweep opt: rintermediate init           ) = 8.729e-03 S  per = 0.163  per(accum) = 5.34
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.727e-01 S  per = 3.23  per(accum) = 8.56
 T(sweep opt: rmmtasks init                ) = 6.726e-01 S  per = 12.6  per(accum) = 21.1
 T(sweep opt: qops memset on cpu           ) = 8.280e-07 S  per = 1.55e-05  per(accum) = 21.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.940e-01 S  per = 3.62  per(accum) = 24.7
 T(sweep opt: reduction of opS & opH [nccl]) = 1.614e-05 S  per = 0.000301  per(accum) = 24.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.311e-03 S  per = 0.0432  per(accum) = 24.8
 T(sweep opt: deallocate cpu and gpu memory) = 1.964e-01 S  per = 3.67  per(accum) = 28.5
 T(sweep opt: reduction of opS & opH [comm]) = 6.514e-04 S  per = 0.0122  per(accum) = 28.5
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 71.3  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 1.023e-02 S  per = 0.191  per(accum) = 100
##### global opt: 1.022e+01 S #####
 T(global opt: fetch) = 1.977e-01 S  per = 1.93  per(accum) = 1.93
 T(global opt: hdiag) = 3.473e-02 S  per = 0.34  per(accum) = 2.27
 T(global opt: dvdsn) = 4.575e+00 S  per = 44.7  per(accum) = 47
 T(global opt: decim) = 1.993e-02 S  per = 0.195  per(accum) = 47.2
 T(global opt: guess) = 4.942e-03 S  per = 0.0483  per(accum) = 47.3
 T(global opt: renrm) = 5.354e+00 S  per = 52.4  per(accum) = 99.6
 T(global opt: save ) = 3.805e-02 S  per = 0.372  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.575e+00 S  T(sum) = 4.121e+00 S  per = 9.007e+01
 T(global opt: preprocess                  ) = 7.075e-03 S  per = 0.172  per(accum) = 0.172
 T(global opt: symbolic_formulae           ) = 2.407e-01 S  per = 5.84  per(accum) = 6.01
 T(global opt: hintermediate init          ) = 5.544e-03 S  per = 0.135  per(accum) = 6.15
 T(global opt: preprocess_hformulae_Hxlist ) = 2.847e-01 S  per = 6.91  per(accum) = 13.1
 T(global opt: hmmtasks init               ) = 1.946e+00 S  per = 47.2  per(accum) = 60.3
 T(global opt: initial guess for dvdson    ) = 1.370e-04 S  per = 0.00332  per(accum) = 60.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 7.341e-01 S  per = 17.8  per(accum) = 78.1
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.049e-03 S  per = 0.0982  per(accum) = 78.2
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.505e-05 S  per = 0.000365  per(accum) = 78.2
 T(global opt: dvdson solver [rest part]   ) = 8.992e-01 S  per = 21.8  per(accum) = 100
Detailed decomposition of T(renrm) = 5.354e+00 S  T(sum) = 5.354e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.218e-03 S  per = 0.116  per(accum) = 0.116
 T(global opt: qops init                    ) = 5.940e-02 S  per = 1.11  per(accum) = 1.23
 T(global opt: symbolic_formulae_renorm     ) = 2.098e-01 S  per = 3.92  per(accum) = 5.14
 T(global opt: allocate qops on gpu         ) = 1.242e-03 S  per = 0.0232  per(accum) = 5.17
 T(global opt: site memcpy cpu2gpu          ) = 3.536e-04 S  per = 0.0066  per(accum) = 5.17
 T(global opt: rintermediate init           ) = 8.729e-03 S  per = 0.163  per(accum) = 5.34
 T(global opt: preprocess_formulae_Rlist2   ) = 1.727e-01 S  per = 3.23  per(accum) = 8.56
 T(global opt: rmmtasks init                ) = 6.726e-01 S  per = 12.6  per(accum) = 21.1
 T(global opt: qops memset on cpu           ) = 8.280e-07 S  per = 1.55e-05  per(accum) = 21.1
 T(global opt: preprocess_renorm_batchGPU   ) = 1.940e-01 S  per = 3.62  per(accum) = 24.7
 T(global opt: reduction of opS & opH [nccl]) = 1.614e-05 S  per = 0.000301  per(accum) = 24.7
 T(global opt: qops memcpy gpu2cpu          ) = 2.311e-03 S  per = 0.0432  per(accum) = 24.8
 T(global opt: deallocate cpu and gpu memory) = 1.964e-01 S  per = 3.67  per(accum) = 28.5
 T(global opt: reduction of opS & opH [comm]) = 6.514e-04 S  per = 0.0122  per(accum) = 28.5
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 71.3  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 1.023e-02 S  per = 0.191  per(accum) = 100

isweep=0 ibond=15/seqsize=34 dots=1 dbond=(16,0)-(17,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.017e+03S Sys:2.759e+00S Total:1.020e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=131:9.995e-04MB:9.760e-07GB
total mem of comb=15298:1.167e-01MB:1.140e-04GB
ctns::topology::check_partition: (sl,sr,sc)=16,3,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 13 14 15
 suppc= 12
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:32 S:8 H:1 P:28 Q:36 
        dim(bra,ket)=24,24 size(op)=104:7.935e-04MB size(tot)=5708:4.355e-02MB:4.253e-05GB
 rqops: oplist=CSHAB nops=C:6 S:34 H:1 A:15 B:21 
        dim(bra,ket)=10,10 size(op)=24:1.831e-04MB size(tot)=840:6.409e-03MB:6.258e-06GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=8884:6.778e-02MB:6.619e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(16,0) fdel=./scratch/sweep/rop(17,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
wf3(diml,dimr,dimc)=(24,10,4) nnz=131:9.995e-04MB
qtensor3: wf3 own=1 _data=0x52a93d50
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=7 dimAll=24
 (24,2):6 (26,2):5 (25,3):4 (25,1):4 (23,1):3 (27,3):1 (26,4):1
 qbond: qcol nsym=5 dimAll=10
 (5,-1):3 (4,-2):3 (3,-1):2 (2,-2):1 (3,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=15 nblocks=140 size=131:9.995e-04MB
### DIAG TIMING: total=4.625e-04 t1=1.365e-05, t2=1.830e-05, t3=2.333e-05, t4=3.840e-04, t5=7.927e-06, t6=1.211e-05, t7=3.218e-06
duration_diagGPU:4.721e-04
duration_diagreduce:3.000e-08
duration_diagtransform:8.770e-07
----- TIMING FOR symbolic_formulae_onedot with size=297 : 5.358e-03 S -----
rank=0 GPUmem(GB): used=6.62e-05 (oper)=6.62e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=297
 no. of hintermediate operators=114
 no. of coefficients=1824:0.0139MB:1.36e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.142e-04 S -----
rank=0 GPUmem(GB): used=7.98e-05 (oper,hinter)=6.62e-05,1.36e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00334 S size(H_formulae)=297 size(Hxlst2)=15 T(Hmu/Hxlist)=0.000631,0.00271 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00357 S size(H_formulae)=297 size(Hxlst)=2950 -----
rank=0 GPUmem(GB): used=0.00142 (oper,hinter,dvdson,batch)=6.62e-05,1.36e-05,1.95e-06,0.00134 blksize=18 blksize0=24 batchsize=2950
ctns::pdvdsonSolver_nkr::solve_iter ndim=131 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.51e-05,0.000677,0.00915,0.00126,0.0111
 ndim=131:9.76e-07GB t[comm(intra)]=3.04e-05 speed=0.0642GB/S t[comm(inter)]=4.73e-06 speed=0.412GB/S
--- TIMING FOR sigma : t_inter=6.8e-04 t_gemm=9.1e-03 t_reduction=1.3e-03 tot=1.1e-02 ---
 sigma[inter] counter=116 t=6.8e-04 per=6.1e+00 cost=4.5e+05 flops=6.7e+08
 sigma[gemm] counter=116 i=0 t=1.3e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=1 t=1.1e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=2 t=2.2e-03 per=1.9e+01 cost=5.1e+04 flops=2.4e+07
 sigma[gemm] counter=116 i=3 t=1.9e-03 per=1.8e+01 cost=5.0e+04 flops=2.6e+07
 sigma[gemm] counter=116 i=4 t=2.6e-03 per=2.4e+01 cost=9.7e+04 flops=3.7e+07
 sigma[gemm] counter=116 i=5 t=2.4e-03 per=2.2e+01 cost=9.0e+04 flops=3.7e+07
 sigma[gemm] counter=116 total t=9.1e-03 per=8.3e+01 cost=2.9e+05 flops=3.1e+07
 sigma[red] counter=116 t=1.3e-03 per=1.1e+01 cost=5.3e+04 flops=4.2e+07
--- TIMING FOR sigma_tot : t_inter=5.2e-02 t_gemm=5.8e-01 t_reduction=8.3e-02 tot=7.2e-01 ---
 sigma_tot[inter] counter=116 t=5.2e-02 per=7.2e+00 cost=1.1e+09 flops=2.1e+10
 sigma_tot[gemm] counter=116 i=0 t=2.4e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=1 t=1.9e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.4e+09
 sigma_tot[gemm] counter=116 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.3e+09
 sigma_tot[gemm] counter=116 i=4 t=1.5e-01 per=2.1e+01 cost=7.8e+08 flops=5.3e+09
 sigma_tot[gemm] counter=116 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.7e+09
 sigma_tot[gemm] counter=116 total t=5.8e-01 per=8.1e+01 cost=3.5e+09 flops=5.9e+09
 sigma_tot[red] counter=116 t=8.3e-02 per=1.2e+01 cost=2.3e+08 flops=2.7e+09
T(sub)=9.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,4.2e-06,1.8e-06,7.3e-07,1.9e-07
settings: ndim=131 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.539344816793 -1.117e+03  2.869e-02    1     1  1.124e-02 1.124e-02 1.122e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.378e-05,1.405e-04,1.154e-03,2.612e-04,1.587e-03
 ndim=131:9.760e-07GB t[comm(intra)]=1.911e-05 speed=1.021e-01GB/S t[comm(inter)]=4.666e-06 speed=4.184e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=1.2e-03 t_reduction=2.6e-04 tot=1.6e-03 ---
 sigma[inter] counter=117 t=1.4e-04 per=9.0e+00 cost=4.5e+05 flops=3.2e+09
 sigma[gemm] counter=117 i=0 t=2.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=1 t=1.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=2 t=2.8e-04 per=1.8e+01 cost=5.1e+04 flops=1.8e+08
 sigma[gemm] counter=117 i=3 t=2.7e-04 per=1.8e+01 cost=5.0e+04 flops=1.8e+08
 sigma[gemm] counter=117 i=4 t=3.2e-04 per=2.1e+01 cost=9.7e+04 flops=3.0e+08
 sigma[gemm] counter=117 i=5 t=2.8e-04 per=1.8e+01 cost=9.0e+04 flops=3.3e+08
 sigma[gemm] counter=117 total t=1.2e-03 per=7.4e+01 cost=2.9e+05 flops=2.5e+08
 sigma[red] counter=117 t=2.6e-04 per=1.7e+01 cost=5.3e+04 flops=2.0e+08
--- TIMING FOR sigma_tot : t_inter=5.2e-02 t_gemm=5.9e-01 t_reduction=8.4e-02 tot=7.2e-01 ---
 sigma_tot[inter] counter=117 t=5.2e-02 per=7.2e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=117 i=0 t=2.4e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=1 t=1.9e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.3e+09
 sigma_tot[gemm] counter=117 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.3e+09
 sigma_tot[gemm] counter=117 i=4 t=1.5e-01 per=2.1e+01 cost=7.9e+08 flops=5.3e+09
 sigma_tot[gemm] counter=117 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.7e+09
 sigma_tot[gemm] counter=117 total t=5.9e-01 per=8.1e+01 cost=3.5e+09 flops=5.9e+09
 sigma_tot[red] counter=117 t=8.4e-02 per=1.2e+01 cost=2.3e+08 flops=2.7e+09
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.2e-05,3.9e-06,1.3e-06,2.9e-07
    2   0 -    -116.540333365021 -9.885e-04  6.062e-03    2     2  2.623e-02 1.312e-02 6.465e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.215e-05,1.296e-04,1.132e-03,2.596e-04,1.549e-03
 ndim=131:9.760e-07GB t[comm(intra)]=1.788e-05 speed=1.092e-01GB/S t[comm(inter)]=4.270e-06 speed=4.572e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=1.1e-03 t_reduction=2.6e-04 tot=1.5e-03 ---
 sigma[inter] counter=118 t=1.3e-04 per=8.5e+00 cost=4.5e+05 flops=3.5e+09
 sigma[gemm] counter=118 i=0 t=2.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=1 t=1.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=2 t=2.8e-04 per=1.8e+01 cost=5.1e+04 flops=1.8e+08
 sigma[gemm] counter=118 i=3 t=2.9e-04 per=1.9e+01 cost=5.0e+04 flops=1.7e+08
 sigma[gemm] counter=118 i=4 t=2.9e-04 per=1.9e+01 cost=9.7e+04 flops=3.3e+08
 sigma[gemm] counter=118 i=5 t=2.7e-04 per=1.8e+01 cost=9.0e+04 flops=3.3e+08
 sigma[gemm] counter=118 total t=1.1e-03 per=7.4e+01 cost=2.9e+05 flops=2.5e+08
 sigma[red] counter=118 t=2.6e-04 per=1.7e+01 cost=5.3e+04 flops=2.0e+08
--- TIMING FOR sigma_tot : t_inter=5.2e-02 t_gemm=5.9e-01 t_reduction=8.4e-02 tot=7.2e-01 ---
 sigma_tot[inter] counter=118 t=5.2e-02 per=7.2e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=118 i=0 t=2.4e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=1 t=1.9e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.3e+09
 sigma_tot[gemm] counter=118 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.3e+09
 sigma_tot[gemm] counter=118 i=4 t=1.5e-01 per=2.1e+01 cost=7.9e+08 flops=5.3e+09
 sigma_tot[gemm] counter=118 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.7e+09
 sigma_tot[gemm] counter=118 total t=5.9e-01 per=8.1e+01 cost=3.5e+09 flops=5.9e+09
 sigma_tot[red] counter=118 t=8.4e-02 per=1.2e+01 cost=2.3e+08 flops=2.7e+09
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.5e-05,3.3e-06,1.6e-06,2.5e-07
    3   0 -    -116.540397077556 -6.371e-05  1.725e-03    3     3  3.856e-02 1.285e-02 4.873e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.313e-05,1.309e-04,1.143e-03,2.612e-04,1.564e-03
 ndim=131:9.760e-07GB t[comm(intra)]=1.879e-05 speed=1.039e-01GB/S t[comm(inter)]=4.341e-06 speed=4.497e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=1.1e-03 t_reduction=2.6e-04 tot=1.5e-03 ---
 sigma[inter] counter=119 t=1.3e-04 per=8.5e+00 cost=4.5e+05 flops=3.5e+09
 sigma[gemm] counter=119 i=0 t=2.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=1 t=1.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=2 t=2.8e-04 per=1.8e+01 cost=5.1e+04 flops=1.8e+08
 sigma[gemm] counter=119 i=3 t=2.8e-04 per=1.8e+01 cost=5.0e+04 flops=1.8e+08
 sigma[gemm] counter=119 i=4 t=3.1e-04 per=2.0e+01 cost=9.7e+04 flops=3.1e+08
 sigma[gemm] counter=119 i=5 t=2.7e-04 per=1.8e+01 cost=9.0e+04 flops=3.3e+08
 sigma[gemm] counter=119 total t=1.1e-03 per=7.4e+01 cost=2.9e+05 flops=2.5e+08
 sigma[red] counter=119 t=2.6e-04 per=1.7e+01 cost=5.3e+04 flops=2.0e+08
--- TIMING FOR sigma_tot : t_inter=5.2e-02 t_gemm=5.9e-01 t_reduction=8.4e-02 tot=7.2e-01 ---
 sigma_tot[inter] counter=119 t=5.2e-02 per=7.2e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=119 i=0 t=2.4e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=1 t=2.0e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.3e+09
 sigma_tot[gemm] counter=119 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.3e+09
 sigma_tot[gemm] counter=119 i=4 t=1.5e-01 per=2.1e+01 cost=7.9e+08 flops=5.3e+09
 sigma_tot[gemm] counter=119 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.7e+09
 sigma_tot[gemm] counter=119 total t=5.9e-01 per=8.1e+01 cost=3.5e+09 flops=5.9e+09
 sigma_tot[red] counter=119 t=8.4e-02 per=1.2e+01 cost=2.3e+08 flops=2.7e+09
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.5e-05,3.0e-06,1.6e-06,2.5e-07
    4   0 -    -116.540402953551 -5.876e-06  6.454e-04    3     4  5.039e-02 1.260e-02 4.077e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.336e-05,1.398e-04,1.133e-03,2.624e-04,1.564e-03
 ndim=131:9.760e-07GB t[comm(intra)]=1.907e-05 speed=1.024e-01GB/S t[comm(inter)]=4.293e-06 speed=4.547e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=1.1e-03 t_reduction=2.6e-04 tot=1.5e-03 ---
 sigma[inter] counter=120 t=1.4e-04 per=9.1e+00 cost=4.5e+05 flops=3.2e+09
 sigma[gemm] counter=120 i=0 t=2.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=1 t=1.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=2 t=2.8e-04 per=1.8e+01 cost=5.1e+04 flops=1.8e+08
 sigma[gemm] counter=120 i=3 t=2.7e-04 per=1.8e+01 cost=5.0e+04 flops=1.8e+08
 sigma[gemm] counter=120 i=4 t=2.9e-04 per=1.9e+01 cost=9.7e+04 flops=3.3e+08
 sigma[gemm] counter=120 i=5 t=2.9e-04 per=1.9e+01 cost=9.0e+04 flops=3.1e+08
 sigma[gemm] counter=120 total t=1.1e-03 per=7.4e+01 cost=2.9e+05 flops=2.5e+08
 sigma[red] counter=120 t=2.6e-04 per=1.7e+01 cost=5.3e+04 flops=2.0e+08
--- TIMING FOR sigma_tot : t_inter=5.2e-02 t_gemm=5.9e-01 t_reduction=8.4e-02 tot=7.3e-01 ---
 sigma_tot[inter] counter=120 t=5.2e-02 per=7.2e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=120 i=0 t=2.4e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=1 t=2.0e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.3e+09
 sigma_tot[gemm] counter=120 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.3e+09
 sigma_tot[gemm] counter=120 i=4 t=1.5e-01 per=2.1e+01 cost=7.9e+08 flops=5.3e+09
 sigma_tot[gemm] counter=120 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.6e+09
 sigma_tot[gemm] counter=120 total t=5.9e-01 per=8.1e+01 cost=3.5e+09 flops=5.9e+09
 sigma_tot[red] counter=120 t=8.4e-02 per=1.2e+01 cost=2.3e+08 flops=2.7e+09
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.5e-05,3.1e-06,1.6e-06,2.5e-07
    5   0 -    -116.540403809546 -8.560e-07  2.549e-04    3     5  6.200e-02 1.240e-02 3.600e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.239e-05,1.328e-04,1.137e-03,2.590e-04,1.557e-03
 ndim=131:9.760e-07GB t[comm(intra)]=1.816e-05 speed=1.075e-01GB/S t[comm(inter)]=4.227e-06 speed=4.618e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=1.1e-03 t_reduction=2.6e-04 tot=1.5e-03 ---
 sigma[inter] counter=121 t=1.3e-04 per=8.7e+00 cost=4.5e+05 flops=3.4e+09
 sigma[gemm] counter=121 i=0 t=2.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=1 t=1.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=2 t=2.8e-04 per=1.8e+01 cost=5.1e+04 flops=1.8e+08
 sigma[gemm] counter=121 i=3 t=2.9e-04 per=1.9e+01 cost=5.0e+04 flops=1.7e+08
 sigma[gemm] counter=121 i=4 t=2.9e-04 per=1.9e+01 cost=9.7e+04 flops=3.3e+08
 sigma[gemm] counter=121 i=5 t=2.7e-04 per=1.8e+01 cost=9.0e+04 flops=3.3e+08
 sigma[gemm] counter=121 total t=1.1e-03 per=7.4e+01 cost=2.9e+05 flops=2.5e+08
 sigma[red] counter=121 t=2.6e-04 per=1.7e+01 cost=5.3e+04 flops=2.0e+08
--- TIMING FOR sigma_tot : t_inter=5.2e-02 t_gemm=5.9e-01 t_reduction=8.5e-02 tot=7.3e-01 ---
 sigma_tot[inter] counter=121 t=5.2e-02 per=7.2e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=121 i=0 t=2.5e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=1 t=2.0e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.3e+09
 sigma_tot[gemm] counter=121 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.3e+09
 sigma_tot[gemm] counter=121 i=4 t=1.5e-01 per=2.1e+01 cost=7.9e+08 flops=5.3e+09
 sigma_tot[gemm] counter=121 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.6e+09
 sigma_tot[gemm] counter=121 total t=5.9e-01 per=8.1e+01 cost=3.5e+09 flops=5.9e+09
 sigma_tot[red] counter=121 t=8.5e-02 per=1.2e+01 cost=2.3e+08 flops=2.7e+09
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.5e-05,3.2e-06,1.6e-06,2.3e-07
    6   0 +    -116.540403924337 -1.148e-07  8.093e-05    3     6  7.350e-02 1.225e-02 3.282e-03
TIMING FOR Davidson : 7.351e-02  T(cal/comm/rest)=1.969e-02,7.120e-07,5.382e-02
decomposed t_rest=5.382e-02
 T(sub)    =1.314e-04 per=2.441e-01
 T(precond)=5.348e-02 per=9.937e+01
 T(ortho)  =1.572e-05 per=2.921e-02
 T(xcopy)  =8.770e-07 per=1.630e-03
 T(xnrm2)  =2.258e-05 per=4.195e-02
 T(other)  =1.696e-04 per=3.151e-01
optimized energies: isweep=0 ibond=15 dots=1 e[0]=-116.540403924337 nmvp=6
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.024e+03S Sys:2.762e+00S Total:1.026e+03S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=14 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond15.txt
 qbond: qsuper nsym=14 dimAll=96
 (24,2):9 (26,2):19 (25,3):10 (25,1):13 (28,2):6 (27,3):11 (27,1):9 (26,4):5 (26,0):4 (23,1):3 (24,0):3 (29,3):1 (28,4):2 (27,5):1
timing for divide=1.2e-05
timing for compute=8.1e-05
timing for collect=1.1e-05
----- TMING FOR decimation_genbasis(nkr): 1.0e-04 S T(divide/compute/collect)=1.2e-05,8.1e-05,1.1e-05 -----
decimation summary: 96->10 dwt=+0.000e+00 SvN=1.359e+00
 qbond: qkept nsym=5 dimAll=10
 (26,2):3 (25,1):3 (27,1):2 (28,2):1 (27,3):1
----- TIMING for decimation_row(nkr): 4.867e-04 S T(decim/select/formRot)=1.825e-04,2.771e-04,2.710e-05 -----
----- TIMING FOR onedot_decimation: 6.025e-04 S T(wf/decim)=1.012e-04,5.013e-04 -----
ctns::oper_renorm coord=(16,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:34 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=10,10 size(op)=24:1.831e-04MB size(tot)=840:6.409e-03MB:6.258e-06GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.024e+03S Sys:2.762e+00S Total:1.026e+03S
----- TIMING FOR symbolic_formulae_renorm with size=77 : 5.521e-03 S -----
rank=0 GPUmem(GB): used=7.98e-05 (oper)=6.62e-05
rank=0 GPUmem(GB): used=8.08e-05 (oper,site)(GB)=6.62e-05,9.76e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=114
 no. of coefficients=1824:0.0139MB:1.36e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.669e-04 S -----
rank=0 GPUmem(GB): used=9.43e-05 (oper,site,rinter)=6.62e-05,9.76e-07,1.36e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00268 S size(rtasks)=77 size(Rlst2)=25 T(Rmu/Rlist)=0.000737,0.00194 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00286 S size(rtasks)=77 size(Rlst)=1713 -----
rank=0 GPUmem(GB): used=9.43e-05 (oper,site,rinter,batch)=6.62e-05,9.76e-07,1.36e-05,0.000779 blksize=18 blksize0=24 batchsize=1713
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000676,0.00661,0.00224
--- TIMING FOR renorm : t_inter=6.8e-04 t_gemm=6.6e-03 t_reduction=2.2e-03 tot=9.5e-03 ---
 renorm[inter] counter=16 t=6.8e-04 per=7.1e+00 cost=2.3e+05 flops=3.3e+08
 renorm[gemm] counter=16 i=0 t=1.4e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=1 t=1.2e-06 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=2 t=1.1e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=3 t=1.2e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=4 t=1.9e-03 per=2.0e+01 cost=3.9e+04 flops=2.1e+07
 renorm[gemm] counter=16 i=5 t=2.4e-03 per=2.5e+01 cost=7.0e+04 flops=2.9e+07
 renorm[gemm] counter=16 i=6 t=2.3e-03 per=2.4e+01 cost=7.4e+04 flops=3.3e+07
 renorm[gemm] counter=16 total t=6.6e-03 per=6.9e+01 cost=1.8e+05 flops=2.8e+07
 renorm[red] counter=16 t=2.2e-03 per=2.4e+01 cost=1.6e+04 flops=7.3e+06
--- TIMING FOR renorm_tot : t_inter=1.2e-02 t_gemm=1.5e-01 t_reduction=3.7e-02 tot=2.0e-01 ---
 renorm_tot[inter] counter=16 t=1.2e-02 per=5.8e+00 cost=5.9e+07 flops=5.0e+09
 renorm_tot[gemm] counter=16 i=0 t=2.4e-05 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=1 t=2.0e-05 per=9.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=2 t=1.9e-05 per=9.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=3 t=1.9e-05 per=9.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=4 t=4.2e-02 per=2.1e+01 cost=2.7e+07 flops=6.3e+08
 renorm_tot[gemm] counter=16 i=5 t=5.3e-02 per=2.6e+01 cost=5.1e+07 flops=9.5e+08
 renorm_tot[gemm] counter=16 i=6 t=5.8e-02 per=2.9e+01 cost=1.0e+08 flops=1.8e+09
 renorm_tot[gemm] counter=16 total t=1.5e-01 per=7.6e+01 cost=1.8e+08 flops=1.2e+09
 renorm_tot[red] counter=16 t=3.7e-02 per=1.8e+01 cost=1.2e+07 flops=3.4e+08
qops.to_cpu: size(tot)=840:6.4e-03MB:6.3e-06GB t[to_cpu]=1.4e-05S speed=4.5e-01GB/S
check ||H-H.dagger||=1.317e-14 coord=(16,0) rank=0
ctns::oper_ab2pq coord=(16,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0295 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.024e+03S Sys:2.762e+00S Total:1.027e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=26:1.984e-04MB:1.937e-07GB
total mem of comb=15193:1.159e-01MB:1.132e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.024e+03S Sys:2.762e+00S Total:1.027e+03S
##### local opt: 1.394e-01 S #####
 T(local opt: fetch) = 9.167e-03 S  per = 6.58  per(accum) = 6.58
 T(local opt: hdiag) = 5.169e-04 S  per = 0.371  per(accum) = 6.95
 T(local opt: dvdsn) = 9.767e-02 S  per = 70.1  per(accum) = 77
 T(local opt: decim) = 6.116e-04 S  per = 0.439  per(accum) = 77.4
 T(local opt: guess) = 1.448e-04 S  per = 0.104  per(accum) = 77.5
 T(local opt: renrm) = 2.987e-02 S  per = 21.4  per(accum) = 99
 T(local opt: save ) = 1.440e-03 S  per = 1.03  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.767e-02 S  T(sum) = 9.744e-02 S  per = 9.976e+01
 T(local opt: preprocess                  ) = 2.106e-04 S  per = 0.216  per(accum) = 0.216
 T(local opt: symbolic_formulae           ) = 5.369e-03 S  per = 5.51  per(accum) = 5.73
 T(local opt: hintermediate init          ) = 1.278e-04 S  per = 0.131  per(accum) = 5.86
 T(local opt: preprocess_hformulae_Hxlist ) = 3.658e-03 S  per = 3.75  per(accum) = 9.61
 T(local opt: hmmtasks init               ) = 1.456e-02 S  per = 14.9  per(accum) = 24.6
 T(local opt: initial guess for dvdson    ) = 3.352e-06 S  per = 0.00344  per(accum) = 24.6
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.954e-02 S  per = 20.1  per(accum) = 44.6
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.499e-04 S  per = 0.154  per(accum) = 44.8
 T(local opt: dvdson solver [comm(cpu)]   ) = 7.120e-07 S  per = 0.000731  per(accum) = 44.8
 T(local opt: dvdson solver [rest part]   ) = 5.382e-02 S  per = 55.2  per(accum) = 100
Detailed decomposition of T(renrm) = 2.987e-02 S  T(sum) = 2.987e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.206e-04 S  per = 0.404  per(accum) = 0.404
 T(local opt: qops init                    ) = 9.626e-04 S  per = 3.22  per(accum) = 3.63
 T(local opt: symbolic_formulae_renorm     ) = 5.533e-03 S  per = 18.5  per(accum) = 22.1
 T(local opt: allocate qops on gpu         ) = 2.579e-05 S  per = 0.0863  per(accum) = 22.2
 T(local opt: site memcpy cpu2gpu          ) = 1.957e-05 S  per = 0.0655  per(accum) = 22.3
 T(local opt: rintermediate init           ) = 1.761e-04 S  per = 0.59  per(accum) = 22.9
 T(local opt: preprocess_formulae_Rlist2   ) = 2.918e-03 S  per = 9.77  per(accum) = 32.7
 T(local opt: rmmtasks init                ) = 1.013e-02 S  per = 33.9  per(accum) = 66.6
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 0.00011  per(accum) = 66.6
 T(local opt: preprocess_renorm_batchGPU   ) = 9.629e-03 S  per = 32.2  per(accum) = 98.8
 T(local opt: reduction of opS & opH [nccl]) = 1.017e-06 S  per = 0.0034  per(accum) = 98.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.973e-05 S  per = 0.066  per(accum) = 98.9
 T(local opt: deallocate cpu and gpu memory) = 2.891e-05 S  per = 0.0968  per(accum) = 99
 T(local opt: reduction of opS & opH [comm]) = 2.162e-05 S  per = 0.0724  per(accum) = 99
 T(local opt: conversion from opAB to opPQ ) = 3.580e-06 S  per = 0.012  per(accum) = 99.1
 T(local opt: after oper_renorm            ) = 2.823e-04 S  per = 0.945  per(accum) = 100
##### sweep opt: 1.036e+01 S #####
 T(sweep opt: fetch) = 2.069e-01 S  per =    2  per(accum) = 2
 T(sweep opt: hdiag) = 3.525e-02 S  per = 0.34  per(accum) = 2.34
 T(sweep opt: dvdsn) = 4.673e+00 S  per = 45.1  per(accum) = 47.4
 T(sweep opt: decim) = 2.054e-02 S  per = 0.198  per(accum) = 47.6
 T(sweep opt: guess) = 5.087e-03 S  per = 0.0491  per(accum) = 47.7
 T(sweep opt: renrm) = 5.384e+00 S  per = 51.9  per(accum) = 99.6
 T(sweep opt: save ) = 3.949e-02 S  per = 0.381  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.673e+00 S  T(sum) = 4.219e+00 S  per = 9.027e+01
 T(sweep opt: preprocess                  ) = 7.286e-03 S  per = 0.173  per(accum) = 0.173
 T(sweep opt: symbolic_formulae           ) = 2.461e-01 S  per = 5.83  per(accum) = 6.01
 T(sweep opt: hintermediate init          ) = 5.672e-03 S  per = 0.134  per(accum) = 6.14
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.884e-01 S  per = 6.84  per(accum) = 13
 T(sweep opt: hmmtasks init               ) = 1.960e+00 S  per = 46.5  per(accum) = 59.4
 T(sweep opt: initial guess for dvdson    ) = 1.404e-04 S  per = 0.00333  per(accum) = 59.4
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 7.536e-01 S  per = 17.9  per(accum) = 77.3
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.198e-03 S  per = 0.0995  per(accum) = 77.4
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.576e-05 S  per = 0.000374  per(accum) = 77.4
 T(sweep opt: dvdson solver [rest part]   ) = 9.530e-01 S  per = 22.6  per(accum) = 100
Detailed decomposition of T(renrm) = 5.384e+00 S  T(sum) = 5.384e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.339e-03 S  per = 0.118  per(accum) = 0.118
 T(sweep opt: qops init                    ) = 6.036e-02 S  per = 1.12  per(accum) = 1.24
 T(sweep opt: symbolic_formulae_renorm     ) = 2.153e-01 S  per =    4  per(accum) = 5.24
 T(sweep opt: allocate qops on gpu         ) = 1.267e-03 S  per = 0.0235  per(accum) = 5.26
 T(sweep opt: site memcpy cpu2gpu          ) = 3.731e-04 S  per = 0.00693  per(accum) = 5.27
 T(sweep opt: rintermediate init           ) = 8.906e-03 S  per = 0.165  per(accum) = 5.43
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.756e-01 S  per = 3.26  per(accum) = 8.7
 T(sweep opt: rmmtasks init                ) = 6.827e-01 S  per = 12.7  per(accum) = 21.4
 T(sweep opt: qops memset on cpu           ) = 8.610e-07 S  per = 1.6e-05  per(accum) = 21.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.036e-01 S  per = 3.78  per(accum) = 25.2
 T(sweep opt: reduction of opS & opH [nccl]) = 1.716e-05 S  per = 0.000319  per(accum) = 25.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.331e-03 S  per = 0.0433  per(accum) = 25.2
 T(sweep opt: deallocate cpu and gpu memory) = 1.965e-01 S  per = 3.65  per(accum) = 28.9
 T(sweep opt: reduction of opS & opH [comm]) = 6.730e-04 S  per = 0.0125  per(accum) = 28.9
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 70.9  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 1.051e-02 S  per = 0.195  per(accum) = 100
##### global opt: 1.036e+01 S #####
 T(global opt: fetch) = 2.069e-01 S  per =    2  per(accum) = 2
 T(global opt: hdiag) = 3.525e-02 S  per = 0.34  per(accum) = 2.34
 T(global opt: dvdsn) = 4.673e+00 S  per = 45.1  per(accum) = 47.4
 T(global opt: decim) = 2.054e-02 S  per = 0.198  per(accum) = 47.6
 T(global opt: guess) = 5.087e-03 S  per = 0.0491  per(accum) = 47.7
 T(global opt: renrm) = 5.384e+00 S  per = 51.9  per(accum) = 99.6
 T(global opt: save ) = 3.949e-02 S  per = 0.381  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.673e+00 S  T(sum) = 4.219e+00 S  per = 9.027e+01
 T(global opt: preprocess                  ) = 7.286e-03 S  per = 0.173  per(accum) = 0.173
 T(global opt: symbolic_formulae           ) = 2.461e-01 S  per = 5.83  per(accum) = 6.01
 T(global opt: hintermediate init          ) = 5.672e-03 S  per = 0.134  per(accum) = 6.14
 T(global opt: preprocess_hformulae_Hxlist ) = 2.884e-01 S  per = 6.84  per(accum) = 13
 T(global opt: hmmtasks init               ) = 1.960e+00 S  per = 46.5  per(accum) = 59.4
 T(global opt: initial guess for dvdson    ) = 1.404e-04 S  per = 0.00333  per(accum) = 59.4
 T(global opt: dvdson solver [Hx_batchGPU] ) = 7.536e-01 S  per = 17.9  per(accum) = 77.3
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.198e-03 S  per = 0.0995  per(accum) = 77.4
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.576e-05 S  per = 0.000374  per(accum) = 77.4
 T(global opt: dvdson solver [rest part]   ) = 9.530e-01 S  per = 22.6  per(accum) = 100
Detailed decomposition of T(renrm) = 5.384e+00 S  T(sum) = 5.384e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.339e-03 S  per = 0.118  per(accum) = 0.118
 T(global opt: qops init                    ) = 6.036e-02 S  per = 1.12  per(accum) = 1.24
 T(global opt: symbolic_formulae_renorm     ) = 2.153e-01 S  per =    4  per(accum) = 5.24
 T(global opt: allocate qops on gpu         ) = 1.267e-03 S  per = 0.0235  per(accum) = 5.26
 T(global opt: site memcpy cpu2gpu          ) = 3.731e-04 S  per = 0.00693  per(accum) = 5.27
 T(global opt: rintermediate init           ) = 8.906e-03 S  per = 0.165  per(accum) = 5.43
 T(global opt: preprocess_formulae_Rlist2   ) = 1.756e-01 S  per = 3.26  per(accum) = 8.7
 T(global opt: rmmtasks init                ) = 6.827e-01 S  per = 12.7  per(accum) = 21.4
 T(global opt: qops memset on cpu           ) = 8.610e-07 S  per = 1.6e-05  per(accum) = 21.4
 T(global opt: preprocess_renorm_batchGPU   ) = 2.036e-01 S  per = 3.78  per(accum) = 25.2
 T(global opt: reduction of opS & opH [nccl]) = 1.716e-05 S  per = 0.000319  per(accum) = 25.2
 T(global opt: qops memcpy gpu2cpu          ) = 2.331e-03 S  per = 0.0433  per(accum) = 25.2
 T(global opt: deallocate cpu and gpu memory) = 1.965e-01 S  per = 3.65  per(accum) = 28.9
 T(global opt: reduction of opS & opH [comm]) = 6.730e-04 S  per = 0.0125  per(accum) = 28.9
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 70.9  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 1.051e-02 S  per = 0.195  per(accum) = 100

isweep=0 ibond=16/seqsize=34 dots=1 dbond=(17,0)-(18,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.024e+03S Sys:2.763e+00S Total:1.027e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=26:1.984e-04MB:1.937e-07GB
total mem of comb=15193:1.159e-01MB:1.132e-04GB
ctns::topology::check_partition: (sl,sr,sc)=17,2,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 14 15
 suppc= 13
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:34 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=10,10 size(op)=24:1.831e-04MB size(tot)=840:6.409e-03MB:6.258e-06GB
 rqops: oplist=CSHAB nops=C:4 S:36 H:1 A:6 B:10 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=123:9.384e-04MB:9.164e-07GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=3299:2.517e-02MB:2.458e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(17,0) fdel=./scratch/sweep/rop(18,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(17,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(18,0)
wf3(diml,dimr,dimc)=(10,4,4) nnz=26:1.984e-04MB
qtensor3: wf3 own=1 _data=0x4de747c0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=5 dimAll=10
 (26,2):3 (25,1):3 (27,1):2 (28,2):1 (27,3):1
 qbond: qcol nsym=3 dimAll=4
 (3,-1):2 (4,0):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=8 nblocks=60 size=26:1.984e-04MB
### DIAG TIMING: total=2.566e-04 t1=2.502e-05, t2=9.049e-06, t3=1.785e-05, t4=1.805e-04, t5=8.488e-06, t6=1.203e-05, t7=3.665e-06
duration_diagGPU:2.666e-04
duration_diagreduce:2.900e-08
duration_diagtransform:3.200e-07
----- TIMING FOR symbolic_formulae_onedot with size=193 : 3.212e-03 S -----
rank=0 GPUmem(GB): used=2.46e-05 (oper)=2.46e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=193
 no. of hintermediate operators=58
 no. of coefficients=986:0.00752MB:7.35e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.669e-05 S -----
rank=0 GPUmem(GB): used=3.19e-05 (oper,hinter)=2.46e-05,7.35e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00127 S size(H_formulae)=193 size(Hxlst2)=8 T(Hmu/Hxlist)=0.000394,0.000878 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00135 S size(H_formulae)=193 size(Hxlst)=824 -----
rank=0 GPUmem(GB): used=0.000167 (oper,hinter,dvdson,batch)=2.46e-05,7.35e-06,3.87e-07,0.000135 blksize=6 blksize0=9 batchsize=824
ctns::pdvdsonSolver_nkr::solve_iter ndim=26 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.38e-05,0.000573,0.004,0.000777,0.00539
 ndim=26:1.94e-07GB t[comm(intra)]=2.91e-05 speed=0.0133GB/S t[comm(inter)]=4.71e-06 speed=0.0823GB/S
--- TIMING FOR sigma : t_inter=5.7e-04 t_gemm=4.0e-03 t_reduction=7.8e-04 tot=5.3e-03 ---
 sigma[inter] counter=122 t=5.7e-04 per=1.1e+01 cost=2.8e+04 flops=5.0e+07
 sigma[gemm] counter=122 i=0 t=1.5e-06 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=1 t=1.2e-06 per=2.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=2 t=8.4e-04 per=1.6e+01 cost=2.7e+03 flops=3.3e+06
 sigma[gemm] counter=122 i=3 t=9.0e-04 per=1.7e+01 cost=2.8e+03 flops=3.2e+06
 sigma[gemm] counter=122 i=4 t=1.1e-03 per=2.1e+01 cost=5.6e+03 flops=5.0e+06
 sigma[gemm] counter=122 i=5 t=1.1e-03 per=2.1e+01 cost=5.4e+03 flops=4.8e+06
 sigma[gemm] counter=122 total t=4.0e-03 per=7.5e+01 cost=1.7e+04 flops=4.2e+06
 sigma[red] counter=122 t=7.8e-04 per=1.5e+01 cost=5.5e+03 flops=7.0e+06
--- TIMING FOR sigma_tot : t_inter=5.3e-02 t_gemm=5.9e-01 t_reduction=8.5e-02 tot=7.3e-01 ---
 sigma_tot[inter] counter=122 t=5.3e-02 per=7.2e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=122 i=0 t=2.5e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=1 t=2.0e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.3e+09
 sigma_tot[gemm] counter=122 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.2e+09
 sigma_tot[gemm] counter=122 i=4 t=1.5e-01 per=2.1e+01 cost=7.9e+08 flops=5.2e+09
 sigma_tot[gemm] counter=122 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.6e+09
 sigma_tot[gemm] counter=122 total t=5.9e-01 per=8.1e+01 cost=3.5e+09 flops=5.8e+09
 sigma_tot[red] counter=122 t=8.5e-02 per=1.2e+01 cost=2.3e+08 flops=2.6e+09
T(sub)=9.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,4.2e-06,1.9e-06,7.7e-07,2.1e-07
settings: ndim=26 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.540403924337 -1.117e+03  9.465e-03    1     1  5.511e-03 5.511e-03 5.486e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.245e-05,1.048e-04,5.498e-04,1.558e-04,8.404e-04
 ndim=26:1.937e-07GB t[comm(intra)]=1.814e-05 speed=2.135e-02GB/S t[comm(inter)]=4.311e-06 speed=8.987e-02GB/S
--- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=5.5e-04 t_reduction=1.6e-04 tot=8.1e-04 ---
 sigma[inter] counter=123 t=1.0e-04 per=1.3e+01 cost=2.8e+04 flops=2.7e+08
 sigma[gemm] counter=123 i=0 t=2.0e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=1 t=1.7e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=2 t=1.2e-04 per=1.5e+01 cost=2.7e+03 flops=2.3e+07
 sigma[gemm] counter=123 i=3 t=1.2e-04 per=1.4e+01 cost=2.8e+03 flops=2.4e+07
 sigma[gemm] counter=123 i=4 t=1.6e-04 per=1.9e+01 cost=5.6e+03 flops=3.6e+07
 sigma[gemm] counter=123 i=5 t=1.5e-04 per=1.9e+01 cost=5.4e+03 flops=3.5e+07
 sigma[gemm] counter=123 total t=5.5e-04 per=6.8e+01 cost=1.7e+04 flops=3.0e+07
 sigma[red] counter=123 t=1.6e-04 per=1.9e+01 cost=5.5e+03 flops=3.5e+07
--- TIMING FOR sigma_tot : t_inter=5.3e-02 t_gemm=5.9e-01 t_reduction=8.6e-02 tot=7.3e-01 ---
 sigma_tot[inter] counter=123 t=5.3e-02 per=7.2e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=123 i=0 t=2.5e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=1 t=2.0e-04 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.3e+09
 sigma_tot[gemm] counter=123 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.2e+09
 sigma_tot[gemm] counter=123 i=4 t=1.5e-01 per=2.1e+01 cost=7.9e+08 flops=5.2e+09
 sigma_tot[gemm] counter=123 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.6e+09
 sigma_tot[gemm] counter=123 total t=5.9e-01 per=8.1e+01 cost=3.5e+09 flops=5.8e+09
 sigma_tot[red] counter=123 t=8.6e-02 per=1.2e+01 cost=2.3e+08 flops=2.6e+09
T(sub)=5.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,4.1e-05,3.9e-06,1.2e-06,2.3e-07
    2   0 -    -116.540555881003 -1.520e-04  7.658e-04    2     2  1.698e-02 8.492e-03 3.224e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.079e-05,9.194e-05,5.534e-04,1.585e-04,8.304e-04
 ndim=26:1.937e-07GB t[comm(intra)]=1.703e-05 speed=2.275e-02GB/S t[comm(inter)]=3.757e-06 speed=1.031e-01GB/S
--- TIMING FOR sigma : t_inter=9.2e-05 t_gemm=5.5e-04 t_reduction=1.6e-04 tot=8.0e-04 ---
 sigma[inter] counter=124 t=9.2e-05 per=1.1e+01 cost=2.8e+04 flops=3.1e+08
 sigma[gemm] counter=124 i=0 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=1 t=1.7e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=2 t=1.3e-04 per=1.6e+01 cost=2.7e+03 flops=2.1e+07
 sigma[gemm] counter=124 i=3 t=1.2e-04 per=1.4e+01 cost=2.8e+03 flops=2.5e+07
 sigma[gemm] counter=124 i=4 t=1.6e-04 per=1.9e+01 cost=5.6e+03 flops=3.6e+07
 sigma[gemm] counter=124 i=5 t=1.5e-04 per=1.9e+01 cost=5.4e+03 flops=3.6e+07
 sigma[gemm] counter=124 total t=5.5e-04 per=6.9e+01 cost=1.7e+04 flops=3.0e+07
 sigma[red] counter=124 t=1.6e-04 per=2.0e+01 cost=5.5e+03 flops=3.5e+07
--- TIMING FOR sigma_tot : t_inter=5.3e-02 t_gemm=6.0e-01 t_reduction=8.6e-02 tot=7.3e-01 ---
 sigma_tot[inter] counter=124 t=5.3e-02 per=7.2e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=124 i=0 t=2.5e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=1 t=2.0e-04 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.3e+09
 sigma_tot[gemm] counter=124 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.2e+09
 sigma_tot[gemm] counter=124 i=4 t=1.5e-01 per=2.1e+01 cost=7.9e+08 flops=5.2e+09
 sigma_tot[gemm] counter=124 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.6e+09
 sigma_tot[gemm] counter=124 total t=6.0e-01 per=8.1e+01 cost=3.5e+09 flops=5.8e+09
 sigma_tot[red] counter=124 t=8.6e-02 per=1.2e+01 cost=2.3e+08 flops=2.6e+09
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.0e-06,1.4e-05,3.0e-06,1.2e-06,2.6e-07
    3   0 -    -116.540557770063 -1.889e-06  3.249e-04    3     3  3.077e-02 1.026e-02 2.467e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.113e-05,9.143e-05,5.478e-04,1.554e-04,8.211e-04
 ndim=26:1.937e-07GB t[comm(intra)]=1.749e-05 speed=2.215e-02GB/S t[comm(inter)]=3.638e-06 speed=1.065e-01GB/S
--- TIMING FOR sigma : t_inter=9.1e-05 t_gemm=5.5e-04 t_reduction=1.6e-04 tot=7.9e-04 ---
 sigma[inter] counter=125 t=9.1e-05 per=1.1e+01 cost=2.8e+04 flops=3.1e+08
 sigma[gemm] counter=125 i=0 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=1 t=1.8e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=2 t=1.1e-04 per=1.4e+01 cost=2.7e+03 flops=2.4e+07
 sigma[gemm] counter=125 i=3 t=1.2e-04 per=1.5e+01 cost=2.8e+03 flops=2.5e+07
 sigma[gemm] counter=125 i=4 t=1.5e-04 per=1.9e+01 cost=5.6e+03 flops=3.7e+07
 sigma[gemm] counter=125 i=5 t=1.6e-04 per=2.0e+01 cost=5.4e+03 flops=3.4e+07
 sigma[gemm] counter=125 total t=5.5e-04 per=6.9e+01 cost=1.7e+04 flops=3.0e+07
 sigma[red] counter=125 t=1.6e-04 per=2.0e+01 cost=5.5e+03 flops=3.5e+07
--- TIMING FOR sigma_tot : t_inter=5.3e-02 t_gemm=6.0e-01 t_reduction=8.6e-02 tot=7.4e-01 ---
 sigma_tot[inter] counter=125 t=5.3e-02 per=7.2e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=125 i=0 t=2.5e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=1 t=2.1e-04 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.2e+09
 sigma_tot[gemm] counter=125 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.2e+09
 sigma_tot[gemm] counter=125 i=4 t=1.5e-01 per=2.1e+01 cost=7.9e+08 flops=5.2e+09
 sigma_tot[gemm] counter=125 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.6e+09
 sigma_tot[gemm] counter=125 total t=6.0e-01 per=8.1e+01 cost=3.5e+09 flops=5.8e+09
 sigma_tot[red] counter=125 t=8.6e-02 per=1.2e+01 cost=2.3e+08 flops=2.6e+09
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,1.3e-05,2.8e-06,1.1e-06,2.2e-07
    4   0 -    -116.540557981695 -2.116e-07  1.258e-04    3     4  4.535e-02 1.134e-02 2.085e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.089e-05,8.966e-05,5.368e-04,1.656e-04,8.181e-04
 ndim=26:1.937e-07GB t[comm(intra)]=1.737e-05 speed=2.231e-02GB/S t[comm(inter)]=3.522e-06 speed=1.100e-01GB/S
--- TIMING FOR sigma : t_inter=8.9e-05 t_gemm=5.4e-04 t_reduction=1.7e-04 tot=7.9e-04 ---
 sigma[inter] counter=126 t=8.9e-05 per=1.1e+01 cost=2.8e+04 flops=3.2e+08
 sigma[gemm] counter=126 i=0 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=1 t=1.7e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=2 t=1.1e-04 per=1.4e+01 cost=2.7e+03 flops=2.4e+07
 sigma[gemm] counter=126 i=3 t=1.1e-04 per=1.4e+01 cost=2.8e+03 flops=2.5e+07
 sigma[gemm] counter=126 i=4 t=1.5e-04 per=1.9e+01 cost=5.6e+03 flops=3.7e+07
 sigma[gemm] counter=126 i=5 t=1.5e-04 per=1.9e+01 cost=5.4e+03 flops=3.5e+07
 sigma[gemm] counter=126 total t=5.4e-04 per=6.8e+01 cost=1.7e+04 flops=3.1e+07
 sigma[red] counter=126 t=1.7e-04 per=2.1e+01 cost=5.5e+03 flops=3.3e+07
--- TIMING FOR sigma_tot : t_inter=5.3e-02 t_gemm=6.0e-01 t_reduction=8.6e-02 tot=7.4e-01 ---
 sigma_tot[inter] counter=126 t=5.3e-02 per=7.2e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=126 i=0 t=2.5e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=1 t=2.1e-04 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.2e+09
 sigma_tot[gemm] counter=126 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.2e+09
 sigma_tot[gemm] counter=126 i=4 t=1.5e-01 per=2.1e+01 cost=7.9e+08 flops=5.2e+09
 sigma_tot[gemm] counter=126 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.6e+09
 sigma_tot[gemm] counter=126 total t=6.0e-01 per=8.1e+01 cost=3.5e+09 flops=5.8e+09
 sigma_tot[red] counter=126 t=8.6e-02 per=1.2e+01 cost=2.3e+08 flops=2.6e+09
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,1.3e-05,2.8e-06,1.1e-06,2.0e-07
    5   0 +    -116.540558010161 -2.847e-08  2.835e-05    3     5  5.909e-02 1.182e-02 1.860e-03
TIMING FOR Davidson : 5.911e-02  T(cal/comm/rest)=9.300e-03,6.530e-07,4.981e-02
decomposed t_rest=4.981e-02
 T(sub)    =1.240e-04 per=2.489e-01
 T(precond)=4.952e-02 per=9.941e+01
 T(ortho)  =1.323e-05 per=2.656e-02
 T(xcopy)  =7.820e-07 per=1.570e-03
 T(xnrm2)  =2.375e-06 per=4.768e-03
 T(other)  =1.510e-04 per=3.032e-01
optimized energies: isweep=0 ibond=16 dots=1 e[0]=-116.540558010161 nmvp=5
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.030e+03S Sys:2.765e+00S Total:1.032e+03S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond16.txt
 qbond: qsuper nsym=11 dimAll=40
 (26,2):6 (28,2):7 (27,3):4 (27,1):8 (25,1):3 (26,0):3 (29,1):3 (28,0):2 (30,2):1 (29,3):2 (28,4):1
timing for divide=8.4e-06
timing for compute=4.5e-05
timing for collect=8.7e-06
----- TMING FOR decimation_genbasis(nkr): 6.2e-05 S T(divide/compute/collect)=8.4e-06,4.5e-05,8.7e-06 -----
decimation summary: 40->4 dwt=+0.000e+00 SvN=8.987e-01
 qbond: qkept nsym=3 dimAll=4
 (27,1):2 (28,2):1 (26,0):1
----- TIMING for decimation_row(nkr): 3.775e-04 S T(decim/select/formRot)=1.270e-04,2.297e-04,2.087e-05 -----
----- TIMING FOR onedot_decimation: 4.690e-04 S T(wf/decim)=7.823e-05,3.907e-04 -----
ctns::oper_renorm coord=(17,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:36 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=123:9.384e-04MB:9.164e-07GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.030e+03S Sys:2.765e+00S Total:1.032e+03S
----- TIMING FOR symbolic_formulae_renorm with size=57 : 3.442e-03 S -----
rank=0 GPUmem(GB): used=3.19e-05 (oper)=2.46e-05
rank=0 GPUmem(GB): used=3.21e-05 (oper,site)(GB)=2.46e-05,1.94e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=58
 no. of coefficients=986:0.00752MB:7.35e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.085e-04 S -----
rank=0 GPUmem(GB): used=3.95e-05 (oper,site,rinter)=2.46e-05,1.94e-07,7.35e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00133 S size(rtasks)=57 size(Rlst2)=9 T(Rmu/Rlist)=0.000501,0.000827 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0014 S size(rtasks)=57 size(Rlst)=537 -----
rank=0 GPUmem(GB): used=3.95e-05 (oper,site,rinter,batch)=2.46e-05,1.94e-07,7.35e-06,8.8e-05 blksize=6 blksize0=9 batchsize=537
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000585,0.00311,0.00101
--- TIMING FOR renorm : t_inter=5.8e-04 t_gemm=3.1e-03 t_reduction=1.0e-03 tot=4.7e-03 ---
 renorm[inter] counter=17 t=5.8e-04 per=1.2e+01 cost=1.4e+04 flops=2.4e+07
 renorm[gemm] counter=17 i=0 t=1.5e-06 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=1 t=1.3e-06 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=2 t=1.2e-06 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=3 t=1.2e-06 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=4 t=1.2e-03 per=2.5e+01 cost=2.7e+03 flops=2.3e+06
 renorm[gemm] counter=17 i=5 t=1.1e-03 per=2.3e+01 cost=4.7e+03 flops=4.3e+06
 renorm[gemm] counter=17 i=6 t=8.5e-04 per=1.8e+01 cost=5.3e+03 flops=6.2e+06
 renorm[gemm] counter=17 total t=3.1e-03 per=6.6e+01 cost=1.3e+04 flops=4.1e+06
 renorm[red] counter=17 t=1.0e-03 per=2.1e+01 cost=2.2e+03 flops=2.2e+06
--- TIMING FOR renorm_tot : t_inter=1.2e-02 t_gemm=1.6e-01 t_reduction=3.8e-02 tot=2.1e-01 ---
 renorm_tot[inter] counter=17 t=1.2e-02 per=6.0e+00 cost=5.9e+07 flops=4.8e+09
 renorm_tot[gemm] counter=17 i=0 t=2.5e-05 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=1 t=2.1e-05 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=2 t=2.1e-05 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=3 t=2.0e-05 per=9.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=4 t=4.4e-02 per=2.1e+01 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=17 i=5 t=5.4e-02 per=2.6e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=17 i=6 t=5.8e-02 per=2.8e+01 cost=1.0e+08 flops=1.7e+09
 renorm_tot[gemm] counter=17 total t=1.6e-01 per=7.6e+01 cost=1.8e+08 flops=1.1e+09
 renorm_tot[red] counter=17 t=3.8e-02 per=1.8e+01 cost=1.2e+07 flops=3.3e+08
qops.to_cpu: size(tot)=123:9.4e-04MB:9.2e-07GB t[to_cpu]=1.3e-05S speed=6.9e-02GB/S
check ||H-H.dagger||=1.963e-16 coord=(17,0) rank=0
ctns::oper_ab2pq coord=(17,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0138 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.030e+03S Sys:2.765e+00S Total:1.033e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=6:4.578e-05MB:4.470e-08GB
total mem of comb=15173:1.158e-01MB:1.130e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.030e+03S Sys:2.765e+00S Total:1.033e+03S
##### local opt: 9.334e-02 S #####
 T(local opt: fetch) = 9.189e-03 S  per = 9.84  per(accum) = 9.84
 T(local opt: hdiag) = 3.040e-04 S  per = 0.326  per(accum) = 10.2
 T(local opt: dvdsn) = 6.781e-02 S  per = 72.6  per(accum) = 82.8
 T(local opt: decim) = 4.779e-04 S  per = 0.512  per(accum) = 83.3
 T(local opt: guess) = 8.760e-05 S  per = 0.0938  per(accum) = 83.4
 T(local opt: renrm) = 1.412e-02 S  per = 15.1  per(accum) = 98.6
 T(local opt: save ) = 1.352e-03 S  per = 1.45  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.781e-02 S  T(sum) = 6.757e-02 S  per = 9.965e+01
 T(local opt: preprocess                  ) = 1.287e-04 S  per = 0.19  per(accum) = 0.19
 T(local opt: symbolic_formulae           ) = 3.222e-03 S  per = 4.77  per(accum) = 4.96
 T(local opt: hintermediate init          ) = 9.052e-05 S  per = 0.134  per(accum) = 5.09
 T(local opt: preprocess_hformulae_Hxlist ) = 1.375e-03 S  per = 2.03  per(accum) = 7.13
 T(local opt: hmmtasks init               ) = 3.642e-03 S  per = 5.39  per(accum) = 12.5
 T(local opt: initial guess for dvdson    ) = 2.797e-06 S  per = 0.00414  per(accum) = 12.5
 T(local opt: dvdson solver [Hx_batchGPU] ) = 9.181e-03 S  per = 13.6  per(accum) = 26.1
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.190e-04 S  per = 0.176  per(accum) = 26.3
 T(local opt: dvdson solver [comm(cpu)]   ) = 6.530e-07 S  per = 0.000966  per(accum) = 26.3
 T(local opt: dvdson solver [rest part]   ) = 4.981e-02 S  per = 73.7  per(accum) = 100
Detailed decomposition of T(renrm) = 1.412e-02 S  T(sum) = 1.412e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.223e-04 S  per = 0.866  per(accum) = 0.866
 T(local opt: qops init                    ) = 6.397e-04 S  per = 4.53  per(accum) = 5.4
 T(local opt: symbolic_formulae_renorm     ) = 3.452e-03 S  per = 24.4  per(accum) = 29.8
 T(local opt: allocate qops on gpu         ) = 2.538e-05 S  per = 0.18  per(accum) = 30
 T(local opt: site memcpy cpu2gpu          ) = 2.295e-05 S  per = 0.163  per(accum) = 30.2
 T(local opt: rintermediate init           ) = 1.192e-04 S  per = 0.844  per(accum) = 31
 T(local opt: preprocess_formulae_Rlist2   ) = 1.420e-03 S  per = 10.1  per(accum) = 41.1
 T(local opt: rmmtasks init                ) = 3.261e-03 S  per = 23.1  per(accum) = 64.2
 T(local opt: qops memset on cpu           ) = 5.400e-08 S  per = 0.000382  per(accum) = 64.2
 T(local opt: preprocess_renorm_batchGPU   ) = 4.802e-03 S  per =   34  per(accum) = 98.2
 T(local opt: reduction of opS & opH [nccl]) = 9.830e-07 S  per = 0.00696  per(accum) = 98.2
 T(local opt: qops memcpy gpu2cpu          ) = 1.924e-05 S  per = 0.136  per(accum) = 98.3
 T(local opt: deallocate cpu and gpu memory) = 1.764e-05 S  per = 0.125  per(accum) = 98.5
 T(local opt: reduction of opS & opH [comm]) = 1.991e-05 S  per = 0.141  per(accum) = 98.6
 T(local opt: conversion from opAB to opPQ ) = 3.794e-06 S  per = 0.0269  per(accum) = 98.6
 T(local opt: after oper_renorm            ) = 1.945e-04 S  per = 1.38  per(accum) = 100
##### sweep opt: 1.046e+01 S #####
 T(sweep opt: fetch) = 2.160e-01 S  per = 2.07  per(accum) = 2.07
 T(sweep opt: hdiag) = 3.556e-02 S  per = 0.34  per(accum) = 2.41
 T(sweep opt: dvdsn) = 4.741e+00 S  per = 45.3  per(accum) = 47.7
 T(sweep opt: decim) = 2.102e-02 S  per = 0.201  per(accum) = 47.9
 T(sweep opt: guess) = 5.175e-03 S  per = 0.0495  per(accum) = 48
 T(sweep opt: renrm) = 5.398e+00 S  per = 51.6  per(accum) = 99.6
 T(sweep opt: save ) = 4.084e-02 S  per = 0.391  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.741e+00 S  T(sum) = 4.286e+00 S  per = 9.041e+01
 T(sweep opt: preprocess                  ) = 7.414e-03 S  per = 0.173  per(accum) = 0.173
 T(sweep opt: symbolic_formulae           ) = 2.493e-01 S  per = 5.82  per(accum) = 5.99
 T(sweep opt: hintermediate init          ) = 5.762e-03 S  per = 0.134  per(accum) = 6.12
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.897e-01 S  per = 6.76  per(accum) = 12.9
 T(sweep opt: hmmtasks init               ) = 1.964e+00 S  per = 45.8  per(accum) = 58.7
 T(sweep opt: initial guess for dvdson    ) = 1.432e-04 S  per = 0.00334  per(accum) = 58.7
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 7.628e-01 S  per = 17.8  per(accum) = 76.5
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.317e-03 S  per = 0.101  per(accum) = 76.6
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.641e-05 S  per = 0.000383  per(accum) = 76.6
 T(sweep opt: dvdson solver [rest part]   ) = 1.003e+00 S  per = 23.4  per(accum) = 100
Detailed decomposition of T(renrm) = 5.398e+00 S  T(sum) = 5.398e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.461e-03 S  per = 0.12  per(accum) = 0.12
 T(sweep opt: qops init                    ) = 6.100e-02 S  per = 1.13  per(accum) = 1.25
 T(sweep opt: symbolic_formulae_renorm     ) = 2.188e-01 S  per = 4.05  per(accum) = 5.3
 T(sweep opt: allocate qops on gpu         ) = 1.293e-03 S  per = 0.024  per(accum) = 5.33
 T(sweep opt: site memcpy cpu2gpu          ) = 3.961e-04 S  per = 0.00734  per(accum) = 5.33
 T(sweep opt: rintermediate init           ) = 9.025e-03 S  per = 0.167  per(accum) = 5.5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.770e-01 S  per = 3.28  per(accum) = 8.78
 T(sweep opt: rmmtasks init                ) = 6.860e-01 S  per = 12.7  per(accum) = 21.5
 T(sweep opt: qops memset on cpu           ) = 9.150e-07 S  per = 1.7e-05  per(accum) = 21.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.084e-01 S  per = 3.86  per(accum) = 25.4
 T(sweep opt: reduction of opS & opH [nccl]) = 1.814e-05 S  per = 0.000336  per(accum) = 25.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.350e-03 S  per = 0.0435  per(accum) = 25.4
 T(sweep opt: deallocate cpu and gpu memory) = 1.965e-01 S  per = 3.64  per(accum) = 29
 T(sweep opt: reduction of opS & opH [comm]) = 6.929e-04 S  per = 0.0128  per(accum) = 29
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 70.8  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 1.070e-02 S  per = 0.198  per(accum) = 100
##### global opt: 1.046e+01 S #####
 T(global opt: fetch) = 2.160e-01 S  per = 2.07  per(accum) = 2.07
 T(global opt: hdiag) = 3.556e-02 S  per = 0.34  per(accum) = 2.41
 T(global opt: dvdsn) = 4.741e+00 S  per = 45.3  per(accum) = 47.7
 T(global opt: decim) = 2.102e-02 S  per = 0.201  per(accum) = 47.9
 T(global opt: guess) = 5.175e-03 S  per = 0.0495  per(accum) = 48
 T(global opt: renrm) = 5.398e+00 S  per = 51.6  per(accum) = 99.6
 T(global opt: save ) = 4.084e-02 S  per = 0.391  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.741e+00 S  T(sum) = 4.286e+00 S  per = 9.041e+01
 T(global opt: preprocess                  ) = 7.414e-03 S  per = 0.173  per(accum) = 0.173
 T(global opt: symbolic_formulae           ) = 2.493e-01 S  per = 5.82  per(accum) = 5.99
 T(global opt: hintermediate init          ) = 5.762e-03 S  per = 0.134  per(accum) = 6.12
 T(global opt: preprocess_hformulae_Hxlist ) = 2.897e-01 S  per = 6.76  per(accum) = 12.9
 T(global opt: hmmtasks init               ) = 1.964e+00 S  per = 45.8  per(accum) = 58.7
 T(global opt: initial guess for dvdson    ) = 1.432e-04 S  per = 0.00334  per(accum) = 58.7
 T(global opt: dvdson solver [Hx_batchGPU] ) = 7.628e-01 S  per = 17.8  per(accum) = 76.5
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.317e-03 S  per = 0.101  per(accum) = 76.6
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.641e-05 S  per = 0.000383  per(accum) = 76.6
 T(global opt: dvdson solver [rest part]   ) = 1.003e+00 S  per = 23.4  per(accum) = 100
Detailed decomposition of T(renrm) = 5.398e+00 S  T(sum) = 5.398e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.461e-03 S  per = 0.12  per(accum) = 0.12
 T(global opt: qops init                    ) = 6.100e-02 S  per = 1.13  per(accum) = 1.25
 T(global opt: symbolic_formulae_renorm     ) = 2.188e-01 S  per = 4.05  per(accum) = 5.3
 T(global opt: allocate qops on gpu         ) = 1.293e-03 S  per = 0.024  per(accum) = 5.33
 T(global opt: site memcpy cpu2gpu          ) = 3.961e-04 S  per = 0.00734  per(accum) = 5.33
 T(global opt: rintermediate init           ) = 9.025e-03 S  per = 0.167  per(accum) = 5.5
 T(global opt: preprocess_formulae_Rlist2   ) = 1.770e-01 S  per = 3.28  per(accum) = 8.78
 T(global opt: rmmtasks init                ) = 6.860e-01 S  per = 12.7  per(accum) = 21.5
 T(global opt: qops memset on cpu           ) = 9.150e-07 S  per = 1.7e-05  per(accum) = 21.5
 T(global opt: preprocess_renorm_batchGPU   ) = 2.084e-01 S  per = 3.86  per(accum) = 25.4
 T(global opt: reduction of opS & opH [nccl]) = 1.814e-05 S  per = 0.000336  per(accum) = 25.4
 T(global opt: qops memcpy gpu2cpu          ) = 2.350e-03 S  per = 0.0435  per(accum) = 25.4
 T(global opt: deallocate cpu and gpu memory) = 1.965e-01 S  per = 3.64  per(accum) = 29
 T(global opt: reduction of opS & opH [comm]) = 6.929e-04 S  per = 0.0128  per(accum) = 29
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 70.8  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 1.070e-02 S  per = 0.198  per(accum) = 100

isweep=0 ibond=17/seqsize=34 dots=1 dbond=(17,0)-(18,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.030e+03S Sys:2.765e+00S Total:1.033e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15019:1.146e-01MB:1.119e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=6:4.578e-05MB:4.470e-08GB
total mem of comb=15173:1.158e-01MB:1.130e-04GB
ctns::topology::check_partition: (sl,sr,sc)=18,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19
 suppr= 15
 suppc= 14
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(17,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(18,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:36 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=123:9.384e-04MB:9.164e-07GB
 rqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=4795:3.658e-02MB:3.573e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(18,0) fdel=./scratch/sweep/lop(17,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
wf3(diml,dimr,dimc)=(4,4,4) nnz=6:4.578e-05MB
qtensor3: wf3 own=1 _data=0x51f1f9b0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=4
 (27,1):2 (28,2):1 (26,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=4 nblocks=48 size=6:4.578e-05MB
### DIAG TIMING: total=1.699e-04 t1=2.073e-05, t2=2.994e-05, t3=1.601e-05, t4=7.819e-05, t5=8.860e-06, t6=1.246e-05, t7=3.718e-06
duration_diagGPU:1.800e-04
duration_diagreduce:3.100e-08
duration_diagtransform:2.400e-07
----- TIMING FOR symbolic_formulae_onedot with size=123 : 1.485e-03 S -----
rank=0 GPUmem(GB): used=3.57e-05 (oper)=3.57e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=123
 no. of hintermediate operators=20
 no. of coefficients=360:0.00275MB:2.68e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.886e-05 S -----
rank=0 GPUmem(GB): used=3.84e-05 (oper,hinter)=3.57e-05,2.68e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.000528 S size(H_formulae)=123 size(Hxlst2)=4 T(Hmu/Hxlist)=0.000242,0.000286 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.000556 S size(H_formulae)=123 size(Hxlst)=250 -----
rank=0 GPUmem(GB): used=5.15e-05 (oper,hinter,dvdson,batch)=3.57e-05,2.68e-06,8.94e-08,1.3e-05 blksize=2 blksize0=2 batchsize=250
ctns::pdvdsonSolver_nkr::solve_iter ndim=6 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.32e-05,0.00025,0.0011,0.000435,0.00182
 ndim=6:4.47e-08GB t[comm(intra)]=1.87e-05 speed=0.00478GB/S t[comm(inter)]=4.49e-06 speed=0.0199GB/S
--- TIMING FOR sigma : t_inter=2.5e-04 t_gemm=1.1e-03 t_reduction=4.3e-04 tot=1.8e-03 ---
 sigma[inter] counter=127 t=2.5e-04 per=1.4e+01 cost=1.6e+03 flops=6.4e+06
 sigma[gemm] counter=127 i=0 t=1.5e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=1 t=1.3e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=2 t=2.9e-04 per=1.6e+01 cost=2.2e+02 flops=7.7e+05
 sigma[gemm] counter=127 i=3 t=2.4e-04 per=1.4e+01 cost=2.2e+02 flops=9.1e+05
 sigma[gemm] counter=127 i=4 t=2.4e-04 per=1.4e+01 cost=4.5e+02 flops=1.8e+06
 sigma[gemm] counter=127 i=5 t=3.2e-04 per=1.8e+01 cost=4.5e+02 flops=1.4e+06
 sigma[gemm] counter=127 total t=1.1e-03 per=6.2e+01 cost=1.3e+03 flops=1.2e+06
 sigma[red] counter=127 t=4.3e-04 per=2.4e+01 cost=7.5e+02 flops=1.7e+06
--- TIMING FOR sigma_tot : t_inter=5.4e-02 t_gemm=6.0e-01 t_reduction=8.6e-02 tot=7.4e-01 ---
 sigma_tot[inter] counter=127 t=5.4e-02 per=7.3e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=127 i=0 t=2.6e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=1 t=2.1e-04 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.2e+09
 sigma_tot[gemm] counter=127 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.2e+09
 sigma_tot[gemm] counter=127 i=4 t=1.5e-01 per=2.1e+01 cost=7.9e+08 flops=5.2e+09
 sigma_tot[gemm] counter=127 i=5 t=1.4e-01 per=2.0e+01 cost=8.0e+08 flops=5.6e+09
 sigma_tot[gemm] counter=127 total t=6.0e-01 per=8.1e+01 cost=3.5e+09 flops=5.8e+09
 sigma_tot[red] counter=127 t=8.6e-02 per=1.2e+01 cost=2.3e+08 flops=2.6e+09
T(sub)=9.6e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,4.1e-06,1.9e-06,7.0e-07,2.0e-07
settings: ndim=6 neig=1 maxcycle=30 nbuff=4 memory=7e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.540558010161 -1.117e+03  8.182e-06    1     1  1.937e-03 1.937e-03 1.915e-03
TIMING FOR Davidson : 1.964e-03  T(cal/comm/rest)=1.915e-03,1.330e-07,4.871e-05
decomposed t_rest=4.871e-05
 T(sub)    =9.637e-06 per=1.979e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =3.810e-07 per=7.823e-01
 T(xnrm2)  =3.470e-07 per=7.125e-01
 T(other)  =3.834e-05 per=7.872e+01
optimized energies: isweep=0 ibond=17 dots=1 e[0]=-116.540558010161 nmvp=1
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.030e+03S Sys:2.765e+00S Total:1.033e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=9 alg_decim=1 mpisize=1
 qbond: qsuper nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
----- TIMING FOR onedot_decimation: 1.2e-04 S T(wf/decim)=5.9e-05,6.3e-05 -----
ctns::oper_renorm coord=(18,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:4 S:36 H:1 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1352:1.0e-02MB:1.0e-05GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.030e+03S Sys:2.765e+00S Total:1.033e+03S
----- TIMING FOR symbolic_formulae_renorm with size=57 : 1.507e-03 S -----
rank=0 GPUmem(GB): used=4.85e-05 (oper)=4.49e-05
rank=0 GPUmem(GB): used=4.87e-05 (oper,site)(GB)=4.49e-05,2.68e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=4.87e-05 (oper,site,rinter)=4.49e-05,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0025 S size(rtasks)=57 size(Rlst2)=81 T(Rmu/Rlist)=0.000642,0.00186 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00266 S size(rtasks)=57 size(Rlst)=1620 -----
rank=0 GPUmem(GB): used=4.87e-05 (oper,site,rinter,batch)=4.49e-05,2.68e-07,0,0.000398 blksize=16 blksize0=0 batchsize=1620
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.97e-06,0.00162,0.00143
--- TIMING FOR renorm : t_inter=8.6e-06 t_gemm=1.6e-03 t_reduction=1.4e-03 tot=3.1e-03 ---
 renorm[inter] counter=18 t=8.6e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=0 t=1.6e-06 per=5.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=1 t=1.2e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=2 t=4.1e-04 per=1.4e+01 cost=2.5e+03 flops=5.9e+06
 renorm[gemm] counter=18 i=3 t=3.6e-04 per=1.2e+01 cost=3.6e+03 flops=1.0e+07
 renorm[gemm] counter=18 i=4 t=1.3e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=5 t=1.2e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=6 t=8.4e-04 per=2.8e+01 cost=1.9e+04 flops=2.2e+07
 renorm[gemm] counter=18 total t=1.6e-03 per=5.3e+01 cost=2.5e+04 flops=1.5e+07
 renorm[red] counter=18 t=1.4e-03 per=4.7e+01 cost=1.9e+04 flops=1.3e+07
--- TIMING FOR renorm_tot : t_inter=1.2e-02 t_gemm=1.6e-01 t_reduction=3.9e-02 tot=2.1e-01 ---
 renorm_tot[inter] counter=18 t=1.2e-02 per=5.9e+00 cost=5.9e+07 flops=4.8e+09
 renorm_tot[gemm] counter=18 i=0 t=2.7e-05 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=1 t=2.2e-05 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=2 t=4.3e-04 per=2.1e-01 cost=2.5e+03 flops=5.6e+06
 renorm_tot[gemm] counter=18 i=3 t=3.8e-04 per=1.8e-01 cost=3.6e+03 flops=9.6e+06
 renorm_tot[gemm] counter=18 i=4 t=4.4e-02 per=2.1e+01 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=18 i=5 t=5.4e-02 per=2.6e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=18 i=6 t=5.9e-02 per=2.8e+01 cost=1.0e+08 flops=1.7e+09
 renorm_tot[gemm] counter=18 total t=1.6e-01 per=7.5e+01 cost=1.8e+08 flops=1.1e+09
 renorm_tot[red] counter=18 t=3.9e-02 per=1.9e+01 cost=1.2e+07 flops=3.2e+08
qops.to_cpu: size(tot)=1352:1.0e-02MB:1.0e-05GB t[to_cpu]=1.5e-05S speed=6.7e-01GB/S
check ||H-H.dagger||=0.000e+00 coord=(18,0) rank=0
ctns::oper_ab2pq coord=(18,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0178 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.030e+03S Sys:2.765e+00S Total:1.033e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15049:1.148e-01MB:1.121e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=40:3.052e-04MB:2.980e-07GB
total mem of comb=15237:1.162e-01MB:1.135e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.030e+03S Sys:2.766e+00S Total:1.033e+03S
##### local opt: 4.416e-02 S #####
 T(local opt: fetch) = 1.815e-02 S  per = 41.1  per(accum) = 41.1
 T(local opt: hdiag) = 2.163e-04 S  per = 0.49  per(accum) = 41.6
 T(local opt: dvdsn) = 5.288e-03 S  per =   12  per(accum) = 53.6
 T(local opt: decim) = 1.296e-04 S  per = 0.293  per(accum) = 53.9
 T(local opt: guess) = 8.558e-05 S  per = 0.194  per(accum) = 54.1
 T(local opt: renrm) = 1.806e-02 S  per = 40.9  per(accum) = 95
 T(local opt: save ) = 2.229e-03 S  per = 5.05  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.288e-03 S  T(sum) = 5.201e-03 S  per = 9.836e+01
 T(local opt: preprocess                  ) = 1.165e-04 S  per = 2.24  per(accum) = 2.24
 T(local opt: symbolic_formulae           ) = 1.494e-03 S  per = 28.7  per(accum) = 31
 T(local opt: hintermediate init          ) = 6.234e-05 S  per =  1.2  per(accum) = 32.2
 T(local opt: preprocess_hformulae_Hxlist ) = 5.666e-04 S  per = 10.9  per(accum) = 43.1
 T(local opt: hmmtasks init               ) = 9.956e-04 S  per = 19.1  per(accum) = 62.2
 T(local opt: initial guess for dvdson    ) = 2.593e-06 S  per = 0.0499  per(accum) = 62.2
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.892e-03 S  per = 36.4  per(accum) = 98.6
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.320e-05 S  per = 0.446  per(accum) = 99.1
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.330e-07 S  per = 0.00256  per(accum) = 99.1
 T(local opt: dvdson solver [rest part]   ) = 4.871e-05 S  per = 0.936  per(accum) = 100
Detailed decomposition of T(renrm) = 1.806e-02 S  T(sum) = 1.806e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.988e-05 S  per = 0.387  per(accum) = 0.387
 T(local opt: qops init                    ) = 6.910e-04 S  per = 3.83  per(accum) = 4.21
 T(local opt: symbolic_formulae_renorm     ) = 1.515e-03 S  per = 8.39  per(accum) = 12.6
 T(local opt: allocate qops on gpu         ) = 2.305e-05 S  per = 0.128  per(accum) = 12.7
 T(local opt: site memcpy cpu2gpu          ) = 1.700e-05 S  per = 0.0941  per(accum) = 12.8
 T(local opt: rintermediate init           ) = 2.427e-05 S  per = 0.134  per(accum) = 13
 T(local opt: preprocess_formulae_Rlist2   ) = 2.721e-03 S  per = 15.1  per(accum) = 28
 T(local opt: rmmtasks init                ) = 9.547e-03 S  per = 52.9  per(accum) = 80.9
 T(local opt: qops memset on cpu           ) = 3.000e-08 S  per = 0.000166  per(accum) = 80.9
 T(local opt: preprocess_renorm_batchGPU   ) = 3.161e-03 S  per = 17.5  per(accum) = 98.4
 T(local opt: reduction of opS & opH [nccl]) = 1.033e-06 S  per = 0.00572  per(accum) = 98.4
 T(local opt: qops memcpy gpu2cpu          ) = 2.088e-05 S  per = 0.116  per(accum) = 98.5
 T(local opt: deallocate cpu and gpu memory) = 1.052e-05 S  per = 0.0583  per(accum) = 98.6
 T(local opt: reduction of opS & opH [comm]) = 2.634e-05 S  per = 0.146  per(accum) = 98.7
 T(local opt: conversion from opAB to opPQ ) = 3.499e-06 S  per = 0.0194  per(accum) = 98.7
 T(local opt: after oper_renorm            ) = 2.266e-04 S  per = 1.25  per(accum) = 100
##### sweep opt: 1.050e+01 S #####
 T(sweep opt: fetch) = 2.342e-01 S  per = 2.23  per(accum) = 2.23
 T(sweep opt: hdiag) = 3.577e-02 S  per = 0.341  per(accum) = 2.57
 T(sweep opt: dvdsn) = 4.746e+00 S  per = 45.2  per(accum) = 47.8
 T(sweep opt: decim) = 2.115e-02 S  per = 0.201  per(accum) = 48
 T(sweep opt: guess) = 5.260e-03 S  per = 0.0501  per(accum) = 48
 T(sweep opt: renrm) = 5.416e+00 S  per = 51.6  per(accum) = 99.6
 T(sweep opt: save ) = 4.307e-02 S  per = 0.41  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.746e+00 S  T(sum) = 4.291e+00 S  per = 9.042e+01
 T(sweep opt: preprocess                  ) = 7.531e-03 S  per = 0.175  per(accum) = 0.175
 T(sweep opt: symbolic_formulae           ) = 2.508e-01 S  per = 5.84  per(accum) = 6.02
 T(sweep opt: hintermediate init          ) = 5.824e-03 S  per = 0.136  per(accum) = 6.16
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.903e-01 S  per = 6.76  per(accum) = 12.9
 T(sweep opt: hmmtasks init               ) = 1.965e+00 S  per = 45.8  per(accum) = 58.7
 T(sweep opt: initial guess for dvdson    ) = 1.458e-04 S  per = 0.0034  per(accum) = 58.7
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 7.647e-01 S  per = 17.8  per(accum) = 76.5
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.341e-03 S  per = 0.101  per(accum) = 76.6
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.654e-05 S  per = 0.000386  per(accum) = 76.6
 T(sweep opt: dvdson solver [rest part]   ) = 1.003e+00 S  per = 23.4  per(accum) = 100
Detailed decomposition of T(renrm) = 5.416e+00 S  T(sum) = 5.416e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.531e-03 S  per = 0.121  per(accum) = 0.121
 T(sweep opt: qops init                    ) = 6.169e-02 S  per = 1.14  per(accum) = 1.26
 T(sweep opt: symbolic_formulae_renorm     ) = 2.203e-01 S  per = 4.07  per(accum) = 5.33
 T(sweep opt: allocate qops on gpu         ) = 1.316e-03 S  per = 0.0243  per(accum) = 5.35
 T(sweep opt: site memcpy cpu2gpu          ) = 4.131e-04 S  per = 0.00763  per(accum) = 5.36
 T(sweep opt: rintermediate init           ) = 9.049e-03 S  per = 0.167  per(accum) = 5.53
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.797e-01 S  per = 3.32  per(accum) = 8.85
 T(sweep opt: rmmtasks init                ) = 6.955e-01 S  per = 12.8  per(accum) = 21.7
 T(sweep opt: qops memset on cpu           ) = 9.450e-07 S  per = 1.74e-05  per(accum) = 21.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.116e-01 S  per = 3.91  per(accum) = 25.6
 T(sweep opt: reduction of opS & opH [nccl]) = 1.917e-05 S  per = 0.000354  per(accum) = 25.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.371e-03 S  per = 0.0438  per(accum) = 25.6
 T(sweep opt: deallocate cpu and gpu memory) = 1.965e-01 S  per = 3.63  per(accum) = 29.3
 T(sweep opt: reduction of opS & opH [comm]) = 7.193e-04 S  per = 0.0133  per(accum) = 29.3
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 70.5  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 1.093e-02 S  per = 0.202  per(accum) = 100
##### global opt: 1.050e+01 S #####
 T(global opt: fetch) = 2.342e-01 S  per = 2.23  per(accum) = 2.23
 T(global opt: hdiag) = 3.577e-02 S  per = 0.341  per(accum) = 2.57
 T(global opt: dvdsn) = 4.746e+00 S  per = 45.2  per(accum) = 47.8
 T(global opt: decim) = 2.115e-02 S  per = 0.201  per(accum) = 48
 T(global opt: guess) = 5.260e-03 S  per = 0.0501  per(accum) = 48
 T(global opt: renrm) = 5.416e+00 S  per = 51.6  per(accum) = 99.6
 T(global opt: save ) = 4.307e-02 S  per = 0.41  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.746e+00 S  T(sum) = 4.291e+00 S  per = 9.042e+01
 T(global opt: preprocess                  ) = 7.531e-03 S  per = 0.175  per(accum) = 0.175
 T(global opt: symbolic_formulae           ) = 2.508e-01 S  per = 5.84  per(accum) = 6.02
 T(global opt: hintermediate init          ) = 5.824e-03 S  per = 0.136  per(accum) = 6.16
 T(global opt: preprocess_hformulae_Hxlist ) = 2.903e-01 S  per = 6.76  per(accum) = 12.9
 T(global opt: hmmtasks init               ) = 1.965e+00 S  per = 45.8  per(accum) = 58.7
 T(global opt: initial guess for dvdson    ) = 1.458e-04 S  per = 0.0034  per(accum) = 58.7
 T(global opt: dvdson solver [Hx_batchGPU] ) = 7.647e-01 S  per = 17.8  per(accum) = 76.5
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.341e-03 S  per = 0.101  per(accum) = 76.6
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.654e-05 S  per = 0.000386  per(accum) = 76.6
 T(global opt: dvdson solver [rest part]   ) = 1.003e+00 S  per = 23.4  per(accum) = 100
Detailed decomposition of T(renrm) = 5.416e+00 S  T(sum) = 5.416e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.531e-03 S  per = 0.121  per(accum) = 0.121
 T(global opt: qops init                    ) = 6.169e-02 S  per = 1.14  per(accum) = 1.26
 T(global opt: symbolic_formulae_renorm     ) = 2.203e-01 S  per = 4.07  per(accum) = 5.33
 T(global opt: allocate qops on gpu         ) = 1.316e-03 S  per = 0.0243  per(accum) = 5.35
 T(global opt: site memcpy cpu2gpu          ) = 4.131e-04 S  per = 0.00763  per(accum) = 5.36
 T(global opt: rintermediate init           ) = 9.049e-03 S  per = 0.167  per(accum) = 5.53
 T(global opt: preprocess_formulae_Rlist2   ) = 1.797e-01 S  per = 3.32  per(accum) = 8.85
 T(global opt: rmmtasks init                ) = 6.955e-01 S  per = 12.8  per(accum) = 21.7
 T(global opt: qops memset on cpu           ) = 9.450e-07 S  per = 1.74e-05  per(accum) = 21.7
 T(global opt: preprocess_renorm_batchGPU   ) = 2.116e-01 S  per = 3.91  per(accum) = 25.6
 T(global opt: reduction of opS & opH [nccl]) = 1.917e-05 S  per = 0.000354  per(accum) = 25.6
 T(global opt: qops memcpy gpu2cpu          ) = 2.371e-03 S  per = 0.0438  per(accum) = 25.6
 T(global opt: deallocate cpu and gpu memory) = 1.965e-01 S  per = 3.63  per(accum) = 29.3
 T(global opt: reduction of opS & opH [comm]) = 7.193e-04 S  per = 0.0133  per(accum) = 29.3
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 70.5  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 1.093e-02 S  per = 0.202  per(accum) = 100

isweep=0 ibond=18/seqsize=34 dots=1 dbond=(16,0)-(17,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.030e+03S Sys:2.766e+00S Total:1.033e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15049:1.148e-01MB:1.121e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=40:3.052e-04MB:2.980e-07GB
total mem of comb=15237:1.162e-01MB:1.135e-04GB
ctns::topology::check_partition: (sl,sr,sc)=17,2,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 14 15
 suppc= 13
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:34 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=10,10 size(op)=24:1.831e-04MB size(tot)=840:6.409e-03MB:6.258e-06GB
 rqops: oplist=CSHAB nops=C:4 S:36 H:1 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:2.747e-04MB size(tot)=1352:1.031e-02MB:1.007e-05GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=4528:3.455e-02MB:3.374e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(17,0) fdel=./scratch/sweep/lop(16,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
wf3(diml,dimr,dimc)=(10,16,4) nnz=40:3.052e-04MB
qtensor3: wf3 own=1 _data=0x52c43440
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=5 dimAll=10
 (26,2):3 (25,1):3 (27,1):2 (28,2):1 (27,3):1
 qbond: qcol nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=11 nblocks=180 size=40:3.052e-04MB
### DIAG TIMING: total=2.580e-04 t1=8.304e-06, t2=1.547e-05, t3=1.960e-05, t4=1.913e-04, t5=8.066e-06, t6=1.188e-05, t7=3.370e-06
duration_diagGPU:2.706e-04
duration_diagreduce:3.900e-08
duration_diagtransform:3.820e-07
----- TIMING FOR symbolic_formulae_onedot with size=193 : 3.035e-03 S -----
rank=0 GPUmem(GB): used=3.37e-05 (oper)=3.37e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=193
 no. of hintermediate operators=58
 no. of coefficients=986:0.00752MB:7.35e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.964e-05 S -----
rank=0 GPUmem(GB): used=4.11e-05 (oper,hinter)=3.37e-05,7.35e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00163 S size(H_formulae)=193 size(Hxlst2)=11 T(Hmu/Hxlist)=0.000379,0.00125 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00174 S size(H_formulae)=193 size(Hxlst)=1294 -----
rank=0 GPUmem(GB): used=0.000369 (oper,hinter,dvdson,batch)=3.37e-05,7.35e-06,5.96e-07,0.000328 blksize=12 blksize0=9 batchsize=1294
ctns::pdvdsonSolver_nkr::solve_iter ndim=40 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.27e-05,0.000418,0.00519,0.00097,0.00662
 ndim=40:2.98e-07GB t[comm(intra)]=2.79e-05 speed=0.0214GB/S t[comm(inter)]=4.84e-06 speed=0.123GB/S
--- TIMING FOR sigma : t_inter=4.2e-04 t_gemm=5.2e-03 t_reduction=9.7e-04 tot=6.6e-03 ---
 sigma[inter] counter=128 t=4.2e-04 per=6.4e+00 cost=3.8e+04 flops=9.0e+07
 sigma[gemm] counter=128 i=0 t=1.3e-06 per=2.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=1 t=1.1e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=2 t=1.4e-03 per=2.1e+01 cost=6.7e+03 flops=4.8e+06
 sigma[gemm] counter=128 i=3 t=1.4e-03 per=2.2e+01 cost=7.1e+03 flops=5.0e+06
 sigma[gemm] counter=128 i=4 t=1.2e-03 per=1.8e+01 cost=8.4e+03 flops=7.2e+06
 sigma[gemm] counter=128 i=5 t=1.2e-03 per=1.9e+01 cost=8.7e+03 flops=7.1e+06
 sigma[gemm] counter=128 total t=5.2e-03 per=7.9e+01 cost=3.1e+04 flops=5.9e+06
 sigma[red] counter=128 t=9.7e-04 per=1.5e+01 cost=9.4e+03 flops=9.7e+06
--- TIMING FOR sigma_tot : t_inter=5.4e-02 t_gemm=6.0e-01 t_reduction=8.7e-02 tot=7.4e-01 ---
 sigma_tot[inter] counter=128 t=5.4e-02 per=7.3e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=128 i=0 t=2.6e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=1 t=2.1e-04 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.2e+09
 sigma_tot[gemm] counter=128 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.2e+09
 sigma_tot[gemm] counter=128 i=4 t=1.5e-01 per=2.0e+01 cost=7.9e+08 flops=5.1e+09
 sigma_tot[gemm] counter=128 i=5 t=1.5e-01 per=2.0e+01 cost=8.0e+08 flops=5.5e+09
 sigma_tot[gemm] counter=128 total t=6.0e-01 per=8.1e+01 cost=3.5e+09 flops=5.7e+09
 sigma_tot[red] counter=128 t=8.7e-02 per=1.2e+01 cost=2.3e+08 flops=2.6e+09
T(sub)=9.4e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,4.1e-06,1.8e-06,6.7e-07,1.8e-07
settings: ndim=40 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.540558010161 -1.117e+03  6.796e-03    1     1  6.736e-03 6.736e-03 6.711e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.720e-05,1.113e-04,8.395e-04,1.927e-04,1.191e-03
 ndim=40:2.980e-07GB t[comm(intra)]=2.155e-05 speed=2.766e-02GB/S t[comm(inter)]=1.565e-05 speed=3.808e-02GB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=8.4e-04 t_reduction=1.9e-04 tot=1.1e-03 ---
 sigma[inter] counter=129 t=1.1e-04 per=9.7e+00 cost=3.8e+04 flops=3.4e+08
 sigma[gemm] counter=129 i=0 t=2.0e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=1 t=1.8e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=2 t=2.2e-04 per=1.9e+01 cost=6.7e+03 flops=3.1e+07
 sigma[gemm] counter=129 i=3 t=2.1e-04 per=1.8e+01 cost=7.1e+03 flops=3.4e+07
 sigma[gemm] counter=129 i=4 t=2.0e-04 per=1.8e+01 cost=8.4e+03 flops=4.1e+07
 sigma[gemm] counter=129 i=5 t=2.0e-04 per=1.8e+01 cost=8.7e+03 flops=4.3e+07
 sigma[gemm] counter=129 total t=8.4e-04 per=7.3e+01 cost=3.1e+04 flops=3.7e+07
 sigma[red] counter=129 t=1.9e-04 per=1.7e+01 cost=9.4e+03 flops=4.9e+07
--- TIMING FOR sigma_tot : t_inter=5.4e-02 t_gemm=6.0e-01 t_reduction=8.8e-02 tot=7.5e-01 ---
 sigma_tot[inter] counter=129 t=5.4e-02 per=7.3e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=129 i=0 t=2.6e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=1 t=2.1e-04 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.2e+09
 sigma_tot[gemm] counter=129 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.1e+09
 sigma_tot[gemm] counter=129 i=4 t=1.5e-01 per=2.0e+01 cost=7.9e+08 flops=5.1e+09
 sigma_tot[gemm] counter=129 i=5 t=1.5e-01 per=2.0e+01 cost=8.0e+08 flops=5.5e+09
 sigma_tot[gemm] counter=129 total t=6.0e-01 per=8.1e+01 cost=3.5e+09 flops=5.7e+09
 sigma_tot[red] counter=129 t=8.8e-02 per=1.2e+01 cost=2.3e+08 flops=2.6e+09
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.2e-05,3.9e-06,1.1e-06,2.8e-07
    2   0 -    -116.540653953323 -9.594e-05  9.327e-04    2     2  2.060e-02 1.030e-02 4.017e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.123e-05,1.685e-04,1.045e-03,2.678e-04,1.562e-03
 ndim=40:2.980e-07GB t[comm(intra)]=2.340e-05 speed=2.547e-02GB/S t[comm(inter)]=1.783e-05 speed=3.344e-02GB/S
--- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=1.0e-03 t_reduction=2.7e-04 tot=1.5e-03 ---
 sigma[inter] counter=130 t=1.7e-04 per=1.1e+01 cost=3.8e+04 flops=2.2e+08
 sigma[gemm] counter=130 i=0 t=2.1e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=1 t=1.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=2 t=2.8e-04 per=1.9e+01 cost=6.7e+03 flops=2.4e+07
 sigma[gemm] counter=130 i=3 t=3.2e-04 per=2.2e+01 cost=7.1e+03 flops=2.2e+07
 sigma[gemm] counter=130 i=4 t=2.3e-04 per=1.6e+01 cost=8.4e+03 flops=3.6e+07
 sigma[gemm] counter=130 i=5 t=2.1e-04 per=1.4e+01 cost=8.7e+03 flops=4.1e+07
 sigma[gemm] counter=130 total t=1.0e-03 per=7.1e+01 cost=3.1e+04 flops=3.0e+07
 sigma[red] counter=130 t=2.7e-04 per=1.8e+01 cost=9.4e+03 flops=3.5e+07
--- TIMING FOR sigma_tot : t_inter=5.4e-02 t_gemm=6.0e-01 t_reduction=8.8e-02 tot=7.5e-01 ---
 sigma_tot[inter] counter=130 t=5.4e-02 per=7.3e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=130 i=0 t=2.6e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=1 t=2.1e-04 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.2e+09
 sigma_tot[gemm] counter=130 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.1e+09
 sigma_tot[gemm] counter=130 i=4 t=1.5e-01 per=2.0e+01 cost=7.9e+08 flops=5.1e+09
 sigma_tot[gemm] counter=130 i=5 t=1.5e-01 per=2.0e+01 cost=8.0e+08 flops=5.5e+09
 sigma_tot[gemm] counter=130 total t=6.0e-01 per=8.1e+01 cost=3.5e+09 flops=5.7e+09
 sigma_tot[red] counter=130 t=8.8e-02 per=1.2e+01 cost=2.3e+08 flops=2.6e+09
T(sub)=7.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,5.7e-05,4.0e-06,1.5e-06,2.9e-07
    3   0 -    -116.540655274198 -1.321e-06  1.023e-04    3     3  4.692e-02 1.564e-02 3.255e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.203e-05,1.021e-04,8.127e-04,1.879e-04,1.131e-03
 ndim=40:2.980e-07GB t[comm(intra)]=1.772e-05 speed=3.363e-02GB/S t[comm(inter)]=4.309e-06 speed=1.383e-01GB/S
--- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=8.1e-04 t_reduction=1.9e-04 tot=1.1e-03 ---
 sigma[inter] counter=131 t=1.0e-04 per=9.3e+00 cost=3.8e+04 flops=3.7e+08
 sigma[gemm] counter=131 i=0 t=2.0e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=1 t=1.8e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=2 t=2.1e-04 per=1.9e+01 cost=6.7e+03 flops=3.2e+07
 sigma[gemm] counter=131 i=3 t=2.1e-04 per=1.9e+01 cost=7.1e+03 flops=3.4e+07
 sigma[gemm] counter=131 i=4 t=2.2e-04 per=2.0e+01 cost=8.4e+03 flops=3.8e+07
 sigma[gemm] counter=131 i=5 t=1.7e-04 per=1.6e+01 cost=8.7e+03 flops=5.0e+07
 sigma[gemm] counter=131 total t=8.1e-04 per=7.4e+01 cost=3.1e+04 flops=3.8e+07
 sigma[red] counter=131 t=1.9e-04 per=1.7e+01 cost=9.4e+03 flops=5.0e+07
--- TIMING FOR sigma_tot : t_inter=5.4e-02 t_gemm=6.1e-01 t_reduction=8.8e-02 tot=7.5e-01 ---
 sigma_tot[inter] counter=131 t=5.4e-02 per=7.3e+00 cost=1.1e+09 flops=2.0e+10
 sigma_tot[gemm] counter=131 i=0 t=2.6e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=1 t=2.2e-04 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=2 t=1.5e-01 per=2.1e+01 cost=9.4e+08 flops=6.1e+09
 sigma_tot[gemm] counter=131 i=3 t=1.5e-01 per=2.0e+01 cost=9.3e+08 flops=6.1e+09
 sigma_tot[gemm] counter=131 i=4 t=1.5e-01 per=2.0e+01 cost=7.9e+08 flops=5.1e+09
 sigma_tot[gemm] counter=131 i=5 t=1.5e-01 per=2.0e+01 cost=8.0e+08 flops=5.5e+09
 sigma_tot[gemm] counter=131 total t=6.1e-01 per=8.1e+01 cost=3.5e+09 flops=5.7e+09
 sigma_tot[red] counter=131 t=8.8e-02 per=1.2e+01 cost=2.3e+08 flops=2.6e+09
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.9e-06,1.5e-05,3.2e-06,1.2e-06,2.4e-07
    4   0 +    -116.540655294172 -1.997e-08  3.257e-05    3     4  5.573e-02 1.393e-02 2.756e-03
TIMING FOR Davidson : 5.574e-02  T(cal/comm/rest)=1.102e-02,5.900e-07,4.472e-02
decomposed t_rest=4.472e-02
 T(sub)    =1.302e-04 per=2.912e-01
 T(precond)=4.438e-02 per=9.925e+01
 T(ortho)  =8.218e-05 per=1.838e-01
 T(xcopy)  =6.620e-07 per=1.480e-03
 T(xnrm2)  =3.590e-06 per=8.028e-03
 T(other)  =1.208e-04 per=2.701e-01
optimized energies: isweep=0 ibond=18 dots=1 e[0]=-116.540655294172 nmvp=4
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.035e+03S Sys:2.773e+00S Total:1.038e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=16 alg_decim=1 mpisize=1
 qbond: qsuper nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
decimation summary: keep all 64 states
----- TIMING FOR onedot_decimation: 3.1e-04 S T(wf/decim)=1.2e-04,1.9e-04 -----
ctns::oper_renorm coord=(17,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:6 S:34 H:1 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:3.1e-03MB size(tot)=21970:1.7e-01MB:1.6e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.036e+03S Sys:2.773e+00S Total:1.039e+03S
----- TIMING FOR symbolic_formulae_renorm with size=77 : 4.316e-03 S -----
rank=0 GPUmem(GB): used=0.000199 (oper)=0.000191
rank=0 GPUmem(GB): used=0.000201 (oper,site)(GB)=0.000191,2.98e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=176
 no. of coefficients=745:0.00568MB:5.55e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.520e-04 S -----
rank=0 GPUmem(GB): used=0.000207 (oper,site,rinter)=0.000191,2.98e-06,5.55e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00924 S size(rtasks)=77 size(Rlst2)=256 T(Rmu/Rlist)=0.00136,0.00789 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0101 S size(rtasks)=77 size(Rlst)=6692 -----
rank=0 GPUmem(GB): used=0.000207 (oper,site,rinter,batch)=0.000191,2.98e-06,5.55e-06,0.00892 blksize=81 blksize0=16 batchsize=6692
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00108,0.00481,0.00182
--- TIMING FOR renorm : t_inter=1.1e-03 t_gemm=4.8e-03 t_reduction=1.8e-03 tot=7.7e-03 ---
 renorm[inter] counter=19 t=1.1e-03 per=1.4e+01 cost=8.5e+04 flops=7.8e+07
 renorm[gemm] counter=19 i=0 t=1.4e-06 per=1.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=1 t=1.1e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=2 t=1.5e-03 per=2.0e+01 cost=1.8e+05 flops=1.2e+08
 renorm[gemm] counter=19 i=3 t=1.6e-03 per=2.0e+01 cost=1.5e+05 flops=9.5e+07
 renorm[gemm] counter=19 i=4 t=1.1e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=5 t=1.1e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=6 t=1.7e-03 per=2.2e+01 cost=1.2e+06 flops=6.9e+08
 renorm[gemm] counter=19 total t=4.8e-03 per=6.2e+01 cost=1.5e+06 flops=3.1e+08
 renorm[red] counter=19 t=1.8e-03 per=2.4e+01 cost=5.3e+05 flops=2.9e+08
--- TIMING FOR renorm_tot : t_inter=1.3e-02 t_gemm=1.6e-01 t_reduction=4.1e-02 tot=2.2e-01 ---
 renorm_tot[inter] counter=19 t=1.3e-02 per=6.2e+00 cost=5.9e+07 flops=4.4e+09
 renorm_tot[gemm] counter=19 i=0 t=2.8e-05 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=1 t=2.3e-05 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=2 t=2.0e-03 per=9.0e-01 cost=1.8e+05 flops=9.2e+07
 renorm_tot[gemm] counter=19 i=3 t=1.9e-03 per=8.9e-01 cost=1.5e+05 flops=7.9e+07
 renorm_tot[gemm] counter=19 i=4 t=4.4e-02 per=2.0e+01 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=19 i=5 t=5.4e-02 per=2.5e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=19 i=6 t=6.1e-02 per=2.8e+01 cost=1.0e+08 flops=1.7e+09
 renorm_tot[gemm] counter=19 total t=1.6e-01 per=7.5e+01 cost=1.8e+08 flops=1.1e+09
 renorm_tot[red] counter=19 t=4.1e-02 per=1.9e+01 cost=1.3e+07 flops=3.2e+08
qops.to_cpu: size(tot)=21970:1.7e-01MB:1.6e-04GB t[to_cpu]=5.0e-05S speed=3.3e+00GB/S
check ||H-H.dagger||=1.127e-16 coord=(17,0) rank=0
ctns::oper_ab2pq coord=(17,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.334 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.037e+03S Sys:2.774e+00S Total:1.039e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15423:1.177e-01MB:1.149e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=245:1.869e-03MB:1.825e-06GB
total mem of comb=15816:1.207e-01MB:1.178e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.037e+03S Sys:2.776e+00S Total:1.039e+03S
##### local opt: 4.168e-01 S #####
 T(local opt: fetch) = 9.161e-03 S  per =  2.2  per(accum) = 2.2
 T(local opt: hdiag) = 3.196e-04 S  per = 0.0767  per(accum) = 2.27
 T(local opt: dvdsn) = 6.660e-02 S  per =   16  per(accum) = 18.3
 T(local opt: decim) = 3.220e-04 S  per = 0.0773  per(accum) = 18.3
 T(local opt: guess) = 2.335e-04 S  per = 0.056  per(accum) = 18.4
 T(local opt: renrm) = 3.359e-01 S  per = 80.6  per(accum) = 99
 T(local opt: save ) = 4.274e-03 S  per = 1.03  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.660e-02 S  T(sum) = 6.636e-02 S  per = 9.963e+01
 T(local opt: preprocess                  ) = 2.589e-04 S  per = 0.39  per(accum) = 0.39
 T(local opt: symbolic_formulae           ) = 3.044e-03 S  per = 4.59  per(accum) = 4.98
 T(local opt: hintermediate init          ) = 8.231e-05 S  per = 0.124  per(accum) = 5.1
 T(local opt: preprocess_hformulae_Hxlist ) = 1.781e-03 S  per = 2.68  per(accum) = 7.79
 T(local opt: hmmtasks init               ) = 5.449e-03 S  per = 8.21  per(accum) = 16
 T(local opt: initial guess for dvdson    ) = 3.013e-06 S  per = 0.00454  per(accum) = 16
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.089e-02 S  per = 16.4  per(accum) = 32.4
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.332e-04 S  per = 0.201  per(accum) = 32.6
 T(local opt: dvdson solver [comm(cpu)]   ) = 5.900e-07 S  per = 0.000889  per(accum) = 32.6
 T(local opt: dvdson solver [rest part]   ) = 4.472e-02 S  per = 67.4  per(accum) = 100
Detailed decomposition of T(renrm) = 3.359e-01 S  T(sum) = 3.359e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.035e-04 S  per = 0.0606  per(accum) = 0.0606
 T(local opt: qops init                    ) = 2.539e-03 S  per = 0.756  per(accum) = 0.816
 T(local opt: symbolic_formulae_renorm     ) = 4.328e-03 S  per = 1.29  per(accum) = 2.1
 T(local opt: allocate qops on gpu         ) = 2.746e-05 S  per = 0.00818  per(accum) = 2.11
 T(local opt: site memcpy cpu2gpu          ) = 1.939e-05 S  per = 0.00577  per(accum) = 2.12
 T(local opt: rintermediate init           ) = 2.617e-04 S  per = 0.0779  per(accum) = 2.2
 T(local opt: preprocess_formulae_Rlist2   ) = 1.031e-02 S  per = 3.07  per(accum) = 5.27
 T(local opt: rmmtasks init                ) = 4.919e-02 S  per = 14.6  per(accum) = 19.9
 T(local opt: qops memset on cpu           ) = 6.100e-08 S  per = 1.82e-05  per(accum) = 19.9
 T(local opt: preprocess_renorm_batchGPU   ) = 7.812e-03 S  per = 2.33  per(accum) = 22.2
 T(local opt: reduction of opS & opH [nccl]) = 9.300e-07 S  per = 0.000277  per(accum) = 22.2
 T(local opt: qops memcpy gpu2cpu          ) = 5.561e-05 S  per = 0.0166  per(accum) = 22.3
 T(local opt: deallocate cpu and gpu memory) = 2.594e-01 S  per = 77.2  per(accum) = 99.5
 T(local opt: reduction of opS & opH [comm]) = 1.977e-04 S  per = 0.0588  per(accum) = 99.5
 T(local opt: conversion from opAB to opPQ ) = 1.373e-05 S  per = 0.00409  per(accum) = 99.5
 T(local opt: after oper_renorm            ) = 1.568e-03 S  per = 0.467  per(accum) = 100
##### sweep opt: 1.092e+01 S #####
 T(sweep opt: fetch) = 2.434e-01 S  per = 2.23  per(accum) = 2.23
 T(sweep opt: hdiag) = 3.609e-02 S  per = 0.331  per(accum) = 2.56
 T(sweep opt: dvdsn) = 4.813e+00 S  per = 44.1  per(accum) = 46.6
 T(sweep opt: decim) = 2.147e-02 S  per = 0.197  per(accum) = 46.8
 T(sweep opt: guess) = 5.494e-03 S  per = 0.0503  per(accum) = 46.9
 T(sweep opt: renrm) = 5.752e+00 S  per = 52.7  per(accum) = 99.6
 T(sweep opt: save ) = 4.734e-02 S  per = 0.434  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.813e+00 S  T(sum) = 4.358e+00 S  per = 9.054e+01
 T(sweep opt: preprocess                  ) = 7.790e-03 S  per = 0.179  per(accum) = 0.179
 T(sweep opt: symbolic_formulae           ) = 2.538e-01 S  per = 5.83  per(accum) = 6
 T(sweep opt: hintermediate init          ) = 5.907e-03 S  per = 0.136  per(accum) = 6.14
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.921e-01 S  per =  6.7  per(accum) = 12.8
 T(sweep opt: hmmtasks init               ) = 1.970e+00 S  per = 45.2  per(accum) = 58.1
 T(sweep opt: initial guess for dvdson    ) = 1.488e-04 S  per = 0.00341  per(accum) = 58.1
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 7.756e-01 S  per = 17.8  per(accum) = 75.9
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.474e-03 S  per = 0.103  per(accum) = 76
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.713e-05 S  per = 0.000393  per(accum) = 76
 T(sweep opt: dvdson solver [rest part]   ) = 1.048e+00 S  per =   24  per(accum) = 100
Detailed decomposition of T(renrm) = 5.752e+00 S  T(sum) = 5.752e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.735e-03 S  per = 0.117  per(accum) = 0.117
 T(sweep opt: qops init                    ) = 6.423e-02 S  per = 1.12  per(accum) = 1.23
 T(sweep opt: symbolic_formulae_renorm     ) = 2.246e-01 S  per = 3.91  per(accum) = 5.14
 T(sweep opt: allocate qops on gpu         ) = 1.343e-03 S  per = 0.0234  per(accum) = 5.16
 T(sweep opt: site memcpy cpu2gpu          ) = 4.325e-04 S  per = 0.00752  per(accum) = 5.17
 T(sweep opt: rintermediate init           ) = 9.311e-03 S  per = 0.162  per(accum) = 5.33
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.901e-01 S  per =  3.3  per(accum) = 8.64
 T(sweep opt: rmmtasks init                ) = 7.447e-01 S  per = 12.9  per(accum) = 21.6
 T(sweep opt: qops memset on cpu           ) = 1.006e-06 S  per = 1.75e-05  per(accum) = 21.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.194e-01 S  per = 3.81  per(accum) = 25.4
 T(sweep opt: reduction of opS & opH [nccl]) = 2.010e-05 S  per = 0.000349  per(accum) = 25.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.427e-03 S  per = 0.0422  per(accum) = 25.4
 T(sweep opt: deallocate cpu and gpu memory) = 4.559e-01 S  per = 7.93  per(accum) = 33.4
 T(sweep opt: reduction of opS & opH [comm]) = 9.170e-04 S  per = 0.0159  per(accum) = 33.4
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 66.4  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 1.250e-02 S  per = 0.217  per(accum) = 100
##### global opt: 1.092e+01 S #####
 T(global opt: fetch) = 2.434e-01 S  per = 2.23  per(accum) = 2.23
 T(global opt: hdiag) = 3.609e-02 S  per = 0.331  per(accum) = 2.56
 T(global opt: dvdsn) = 4.813e+00 S  per = 44.1  per(accum) = 46.6
 T(global opt: decim) = 2.147e-02 S  per = 0.197  per(accum) = 46.8
 T(global opt: guess) = 5.494e-03 S  per = 0.0503  per(accum) = 46.9
 T(global opt: renrm) = 5.752e+00 S  per = 52.7  per(accum) = 99.6
 T(global opt: save ) = 4.734e-02 S  per = 0.434  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.813e+00 S  T(sum) = 4.358e+00 S  per = 9.054e+01
 T(global opt: preprocess                  ) = 7.790e-03 S  per = 0.179  per(accum) = 0.179
 T(global opt: symbolic_formulae           ) = 2.538e-01 S  per = 5.83  per(accum) = 6
 T(global opt: hintermediate init          ) = 5.907e-03 S  per = 0.136  per(accum) = 6.14
 T(global opt: preprocess_hformulae_Hxlist ) = 2.921e-01 S  per =  6.7  per(accum) = 12.8
 T(global opt: hmmtasks init               ) = 1.970e+00 S  per = 45.2  per(accum) = 58.1
 T(global opt: initial guess for dvdson    ) = 1.488e-04 S  per = 0.00341  per(accum) = 58.1
 T(global opt: dvdson solver [Hx_batchGPU] ) = 7.756e-01 S  per = 17.8  per(accum) = 75.9
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.474e-03 S  per = 0.103  per(accum) = 76
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.713e-05 S  per = 0.000393  per(accum) = 76
 T(global opt: dvdson solver [rest part]   ) = 1.048e+00 S  per =   24  per(accum) = 100
Detailed decomposition of T(renrm) = 5.752e+00 S  T(sum) = 5.752e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.735e-03 S  per = 0.117  per(accum) = 0.117
 T(global opt: qops init                    ) = 6.423e-02 S  per = 1.12  per(accum) = 1.23
 T(global opt: symbolic_formulae_renorm     ) = 2.246e-01 S  per = 3.91  per(accum) = 5.14
 T(global opt: allocate qops on gpu         ) = 1.343e-03 S  per = 0.0234  per(accum) = 5.16
 T(global opt: site memcpy cpu2gpu          ) = 4.325e-04 S  per = 0.00752  per(accum) = 5.17
 T(global opt: rintermediate init           ) = 9.311e-03 S  per = 0.162  per(accum) = 5.33
 T(global opt: preprocess_formulae_Rlist2   ) = 1.901e-01 S  per =  3.3  per(accum) = 8.64
 T(global opt: rmmtasks init                ) = 7.447e-01 S  per = 12.9  per(accum) = 21.6
 T(global opt: qops memset on cpu           ) = 1.006e-06 S  per = 1.75e-05  per(accum) = 21.6
 T(global opt: preprocess_renorm_batchGPU   ) = 2.194e-01 S  per = 3.81  per(accum) = 25.4
 T(global opt: reduction of opS & opH [nccl]) = 2.010e-05 S  per = 0.000349  per(accum) = 25.4
 T(global opt: qops memcpy gpu2cpu          ) = 2.427e-03 S  per = 0.0422  per(accum) = 25.4
 T(global opt: deallocate cpu and gpu memory) = 4.559e-01 S  per = 7.93  per(accum) = 33.4
 T(global opt: reduction of opS & opH [comm]) = 9.170e-04 S  per = 0.0159  per(accum) = 33.4
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 66.4  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 1.250e-02 S  per = 0.217  per(accum) = 100

isweep=0 ibond=19/seqsize=34 dots=1 dbond=(15,0)-(16,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.037e+03S Sys:2.776e+00S Total:1.039e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15423:1.177e-01MB:1.149e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=245:1.869e-03MB:1.825e-06GB
total mem of comb=15816:1.207e-01MB:1.178e-04GB
ctns::topology::check_partition: (sl,sr,sc)=16,3,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 13 14 15
 suppc= 12
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:32 S:8 H:1 P:28 Q:36 
        dim(bra,ket)=24,24 size(op)=104:7.935e-04MB size(tot)=5708:4.355e-02MB:4.253e-05GB
 rqops: oplist=CSHAB nops=C:6 S:34 H:1 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:3.052e-03MB size(tot)=21970:1.676e-01MB:1.637e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=30014:2.290e-01MB:2.236e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(16,0) fdel=./scratch/sweep/lop(15,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
wf3(diml,dimr,dimc)=(24,64,4) nnz=245:1.869e-03MB
qtensor3: wf3 own=1 _data=0x52c52a30
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=7 dimAll=24
 (24,2):6 (26,2):5 (25,3):4 (25,1):4 (23,1):3 (27,3):1 (26,4):1
 qbond: qcol nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=17 nblocks=448 size=245:1.869e-03MB
### DIAG TIMING: total=1.299e-03 t1=2.244e-05, t2=3.912e-05, t3=7.549e-05, t4=1.114e-03, t5=1.394e-05, t6=2.503e-05, t7=9.108e-06
duration_diagGPU:1.327e-03
duration_diagreduce:1.560e-07
duration_diagtransform:2.731e-06
----- TIMING FOR symbolic_formulae_onedot with size=297 : 1.497e-02 S -----
rank=0 GPUmem(GB): used=0.000224 (oper)=0.000224
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=297
 no. of hintermediate operators=114
 no. of coefficients=1824:0.0139MB:1.36e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.828e-04 S -----
rank=0 GPUmem(GB): used=0.000237 (oper,hinter)=0.000224,1.36e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00943 S size(H_formulae)=297 size(Hxlst2)=17 T(Hmu/Hxlist)=0.00159,0.00784 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0104 S size(H_formulae)=297 size(Hxlst)=3362 -----
rank=0 GPUmem(GB): used=0.00357 (oper,hinter,dvdson,batch)=0.000224,1.36e-05,3.65e-06,0.00333 blksize=54 blksize0=24 batchsize=3362
ctns::pdvdsonSolver_nkr::solve_iter ndim=245 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.63e-05,0.000671,0.0145,0.00232,0.0176
 ndim=245:1.83e-06GB t[comm(intra)]=2.81e-05 speed=0.13GB/S t[comm(inter)]=8.14e-06 speed=0.449GB/S
--- TIMING FOR sigma : t_inter=6.7e-04 t_gemm=1.5e-02 t_reduction=2.3e-03 tot=1.8e-02 ---
 sigma[inter] counter=132 t=6.7e-04 per=3.8e+00 cost=5.0e+05 flops=7.4e+08
 sigma[gemm] counter=132 i=0 t=2.8e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=1 t=2.4e-06 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=2 t=4.1e-03 per=2.3e+01 cost=2.0e+05 flops=5.0e+07
 sigma[gemm] counter=132 i=3 t=3.7e-03 per=2.1e+01 cost=2.0e+05 flops=5.5e+07
 sigma[gemm] counter=132 i=4 t=3.7e-03 per=2.1e+01 cost=1.7e+05 flops=4.7e+07
 sigma[gemm] counter=132 i=5 t=3.1e-03 per=1.8e+01 cost=1.8e+05 flops=5.8e+07
 sigma[gemm] counter=132 total t=1.5e-02 per=8.3e+01 cost=7.5e+05 flops=5.2e+07
 sigma[red] counter=132 t=2.3e-03 per=1.3e+01 cost=1.0e+05 flops=4.4e+07
--- TIMING FOR sigma_tot : t_inter=5.5e-02 t_gemm=6.2e-01 t_reduction=9.0e-02 tot=7.7e-01 ---
 sigma_tot[inter] counter=132 t=5.5e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=132 i=0 t=2.7e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=1 t=2.2e-04 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=2 t=1.6e-01 per=2.1e+01 cost=9.5e+08 flops=6.0e+09
 sigma_tot[gemm] counter=132 i=3 t=1.6e-01 per=2.0e+01 cost=9.3e+08 flops=6.0e+09
 sigma_tot[gemm] counter=132 i=4 t=1.6e-01 per=2.0e+01 cost=7.9e+08 flops=5.0e+09
 sigma_tot[gemm] counter=132 i=5 t=1.5e-01 per=1.9e+01 cost=8.0e+08 flops=5.4e+09
 sigma_tot[gemm] counter=132 total t=6.2e-01 per=8.1e+01 cost=3.5e+09 flops=5.6e+09
 sigma_tot[red] counter=132 t=9.0e-02 per=1.2e+01 cost=2.3e+08 flops=2.5e+09
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,7.3e-06,3.2e-06,1.5e-06,4.4e-07
settings: ndim=245 neig=1 maxcycle=30 nbuff=4 memory=3e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.540655294172 -1.117e+03  3.376e-02    1     1  1.777e-02 1.777e-02 1.772e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.267e-05,1.690e-04,1.868e-03,4.210e-04,2.510e-03
 ndim=245:1.825e-06GB t[comm(intra)]=3.581e-05 speed=1.020e-01GB/S t[comm(inter)]=6.858e-06 speed=5.323e-01GB/S
--- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=1.9e-03 t_reduction=4.2e-04 tot=2.5e-03 ---
 sigma[inter] counter=133 t=1.7e-04 per=6.9e+00 cost=5.0e+05 flops=2.9e+09
 sigma[gemm] counter=133 i=0 t=2.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=1 t=2.4e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=2 t=4.3e-04 per=1.8e+01 cost=2.0e+05 flops=4.7e+08
 sigma[gemm] counter=133 i=3 t=4.5e-04 per=1.8e+01 cost=2.0e+05 flops=4.4e+08
 sigma[gemm] counter=133 i=4 t=4.9e-04 per=2.0e+01 cost=1.7e+05 flops=3.5e+08
 sigma[gemm] counter=133 i=5 t=4.8e-04 per=2.0e+01 cost=1.8e+05 flops=3.7e+08
 sigma[gemm] counter=133 total t=1.9e-03 per=7.6e+01 cost=7.5e+05 flops=4.0e+08
 sigma[red] counter=133 t=4.2e-04 per=1.7e+01 cost=1.0e+05 flops=2.4e+08
--- TIMING FOR sigma_tot : t_inter=5.5e-02 t_gemm=6.2e-01 t_reduction=9.1e-02 tot=7.7e-01 ---
 sigma_tot[inter] counter=133 t=5.5e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=133 i=0 t=2.7e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=1 t=2.2e-04 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=2 t=1.6e-01 per=2.1e+01 cost=9.5e+08 flops=6.0e+09
 sigma_tot[gemm] counter=133 i=3 t=1.6e-01 per=2.0e+01 cost=9.3e+08 flops=6.0e+09
 sigma_tot[gemm] counter=133 i=4 t=1.6e-01 per=2.0e+01 cost=7.9e+08 flops=5.0e+09
 sigma_tot[gemm] counter=133 i=5 t=1.5e-01 per=1.9e+01 cost=8.0e+08 flops=5.4e+09
 sigma_tot[gemm] counter=133 total t=6.2e-01 per=8.1e+01 cost=3.5e+09 flops=5.6e+09
 sigma_tot[red] counter=133 t=9.1e-02 per=1.2e+01 cost=2.3e+08 flops=2.5e+09
T(sub)=4.6e-05 T(gemm/eig/ortho/gemm/axpy)=8.7e-06,1.7e-05,5.3e-06,1.4e-05,4.0e-07
    2   0 -    -116.541822713816 -1.167e-03  6.847e-03    2     2  2.721e-02 1.360e-02 1.022e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.404e-05,1.372e-04,1.329e-03,3.265e-04,1.824e-03
 ndim=245:1.825e-06GB t[comm(intra)]=1.927e-05 speed=1.895e-01GB/S t[comm(inter)]=4.768e-06 speed=7.657e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=1.3e-03 t_reduction=3.3e-04 tot=1.8e-03 ---
 sigma[inter] counter=134 t=1.4e-04 per=7.6e+00 cost=5.0e+05 flops=3.6e+09
 sigma[gemm] counter=134 i=0 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=1 t=1.8e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=2 t=3.3e-04 per=1.8e+01 cost=2.0e+05 flops=6.1e+08
 sigma[gemm] counter=134 i=3 t=3.4e-04 per=1.9e+01 cost=2.0e+05 flops=5.9e+08
 sigma[gemm] counter=134 i=4 t=3.4e-04 per=1.9e+01 cost=1.7e+05 flops=5.1e+08
 sigma[gemm] counter=134 i=5 t=3.2e-04 per=1.8e+01 cost=1.8e+05 flops=5.6e+08
 sigma[gemm] counter=134 total t=1.3e-03 per=7.4e+01 cost=7.5e+05 flops=5.7e+08
 sigma[red] counter=134 t=3.3e-04 per=1.8e+01 cost=1.0e+05 flops=3.1e+08
--- TIMING FOR sigma_tot : t_inter=5.5e-02 t_gemm=6.2e-01 t_reduction=9.1e-02 tot=7.7e-01 ---
 sigma_tot[inter] counter=134 t=5.5e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=134 i=0 t=2.7e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=1 t=2.2e-04 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=2 t=1.6e-01 per=2.1e+01 cost=9.5e+08 flops=6.0e+09
 sigma_tot[gemm] counter=134 i=3 t=1.6e-01 per=2.0e+01 cost=9.3e+08 flops=6.0e+09
 sigma_tot[gemm] counter=134 i=4 t=1.6e-01 per=2.0e+01 cost=7.9e+08 flops=5.0e+09
 sigma_tot[gemm] counter=134 i=5 t=1.5e-01 per=1.9e+01 cost=8.0e+08 flops=5.3e+09
 sigma_tot[gemm] counter=134 total t=6.2e-01 per=8.1e+01 cost=3.5e+09 flops=5.6e+09
 sigma_tot[red] counter=134 t=9.1e-02 per=1.2e+01 cost=2.3e+08 flops=2.5e+09
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=6.5e-06,1.7e-05,3.5e-06,2.2e-06,2.9e-07
    3   0 -    -116.541897155055 -7.444e-05  2.125e-03    3     3  3.648e-02 1.216e-02 7.462e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.430e-05,1.355e-04,1.319e-03,3.178e-04,1.804e-03
 ndim=245:1.825e-06GB t[comm(intra)]=1.972e-05 speed=1.852e-01GB/S t[comm(inter)]=4.590e-06 speed=7.954e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=1.3e-03 t_reduction=3.2e-04 tot=1.8e-03 ---
 sigma[inter] counter=135 t=1.4e-04 per=7.6e+00 cost=5.0e+05 flops=3.7e+09
 sigma[gemm] counter=135 i=0 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=1 t=1.7e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=2 t=3.3e-04 per=1.8e+01 cost=2.0e+05 flops=6.2e+08
 sigma[gemm] counter=135 i=3 t=3.4e-04 per=1.9e+01 cost=2.0e+05 flops=6.0e+08
 sigma[gemm] counter=135 i=4 t=3.4e-04 per=1.9e+01 cost=1.7e+05 flops=5.1e+08
 sigma[gemm] counter=135 i=5 t=3.1e-04 per=1.8e+01 cost=1.8e+05 flops=5.7e+08
 sigma[gemm] counter=135 total t=1.3e-03 per=7.4e+01 cost=7.5e+05 flops=5.7e+08
 sigma[red] counter=135 t=3.2e-04 per=1.8e+01 cost=1.0e+05 flops=3.2e+08
--- TIMING FOR sigma_tot : t_inter=5.5e-02 t_gemm=6.2e-01 t_reduction=9.1e-02 tot=7.7e-01 ---
 sigma_tot[inter] counter=135 t=5.5e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=135 i=0 t=2.7e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=1 t=2.2e-04 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=2 t=1.6e-01 per=2.1e+01 cost=9.5e+08 flops=6.0e+09
 sigma_tot[gemm] counter=135 i=3 t=1.6e-01 per=2.0e+01 cost=9.3e+08 flops=5.9e+09
 sigma_tot[gemm] counter=135 i=4 t=1.6e-01 per=2.0e+01 cost=7.9e+08 flops=5.0e+09
 sigma_tot[gemm] counter=135 i=5 t=1.5e-01 per=1.9e+01 cost=8.0e+08 flops=5.3e+09
 sigma_tot[gemm] counter=135 total t=6.2e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=135 t=9.1e-02 per=1.2e+01 cost=2.3e+08 flops=2.5e+09
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=6.2e-06,1.5e-05,3.4e-06,2.2e-06,2.7e-07
    4   0 -    -116.541904408816 -7.254e-06  8.321e-04    3     4  4.632e-02 1.158e-02 6.080e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.342e-05,1.357e-04,1.331e-03,3.012e-04,1.799e-03
 ndim=245:1.825e-06GB t[comm(intra)]=1.879e-05 speed=1.943e-01GB/S t[comm(inter)]=4.628e-06 speed=7.888e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=1.3e-03 t_reduction=3.0e-04 tot=1.8e-03 ---
 sigma[inter] counter=136 t=1.4e-04 per=7.7e+00 cost=5.0e+05 flops=3.7e+09
 sigma[gemm] counter=136 i=0 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=1 t=1.7e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=2 t=3.5e-04 per=2.0e+01 cost=2.0e+05 flops=5.9e+08
 sigma[gemm] counter=136 i=3 t=3.1e-04 per=1.8e+01 cost=2.0e+05 flops=6.4e+08
 sigma[gemm] counter=136 i=4 t=3.4e-04 per=1.9e+01 cost=1.7e+05 flops=5.1e+08
 sigma[gemm] counter=136 i=5 t=3.3e-04 per=1.9e+01 cost=1.8e+05 flops=5.4e+08
 sigma[gemm] counter=136 total t=1.3e-03 per=7.5e+01 cost=7.5e+05 flops=5.7e+08
 sigma[red] counter=136 t=3.0e-04 per=1.7e+01 cost=1.0e+05 flops=3.4e+08
--- TIMING FOR sigma_tot : t_inter=5.6e-02 t_gemm=6.3e-01 t_reduction=9.2e-02 tot=7.7e-01 ---
 sigma_tot[inter] counter=136 t=5.6e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=136 i=0 t=2.7e-04 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=1 t=2.3e-04 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=2 t=1.6e-01 per=2.1e+01 cost=9.5e+08 flops=5.9e+09
 sigma_tot[gemm] counter=136 i=3 t=1.6e-01 per=2.0e+01 cost=9.3e+08 flops=5.9e+09
 sigma_tot[gemm] counter=136 i=4 t=1.6e-01 per=2.0e+01 cost=7.9e+08 flops=5.0e+09
 sigma_tot[gemm] counter=136 i=5 t=1.5e-01 per=1.9e+01 cost=8.0e+08 flops=5.3e+09
 sigma_tot[gemm] counter=136 total t=6.3e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=136 t=9.2e-02 per=1.2e+01 cost=2.3e+08 flops=2.5e+09
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=6.1e-06,1.5e-05,3.2e-06,2.1e-06,2.7e-07
    5   0 -    -116.541905750320 -1.342e-06  3.444e-04    3     5  5.592e-02 1.118e-02 5.250e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.342e-05,1.304e-04,1.323e-03,2.995e-04,1.783e-03
 ndim=245:1.825e-06GB t[comm(intra)]=1.908e-05 speed=1.913e-01GB/S t[comm(inter)]=4.335e-06 speed=8.422e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=1.3e-03 t_reduction=3.0e-04 tot=1.8e-03 ---
 sigma[inter] counter=137 t=1.3e-04 per=7.4e+00 cost=5.0e+05 flops=3.8e+09
 sigma[gemm] counter=137 i=0 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=1 t=1.7e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=2 t=3.2e-04 per=1.9e+01 cost=2.0e+05 flops=6.2e+08
 sigma[gemm] counter=137 i=3 t=3.2e-04 per=1.8e+01 cost=2.0e+05 flops=6.4e+08
 sigma[gemm] counter=137 i=4 t=3.7e-04 per=2.1e+01 cost=1.7e+05 flops=4.7e+08
 sigma[gemm] counter=137 i=5 t=3.1e-04 per=1.8e+01 cost=1.8e+05 flops=5.7e+08
 sigma[gemm] counter=137 total t=1.3e-03 per=7.5e+01 cost=7.5e+05 flops=5.7e+08
 sigma[red] counter=137 t=3.0e-04 per=1.7e+01 cost=1.0e+05 flops=3.4e+08
--- TIMING FOR sigma_tot : t_inter=5.6e-02 t_gemm=6.3e-01 t_reduction=9.2e-02 tot=7.8e-01 ---
 sigma_tot[inter] counter=137 t=5.6e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=137 i=0 t=2.8e-04 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=1 t=2.3e-04 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=2 t=1.6e-01 per=2.1e+01 cost=9.5e+08 flops=5.9e+09
 sigma_tot[gemm] counter=137 i=3 t=1.6e-01 per=2.0e+01 cost=9.3e+08 flops=5.9e+09
 sigma_tot[gemm] counter=137 i=4 t=1.6e-01 per=2.0e+01 cost=7.9e+08 flops=5.0e+09
 sigma_tot[gemm] counter=137 i=5 t=1.5e-01 per=1.9e+01 cost=8.0e+08 flops=5.3e+09
 sigma_tot[gemm] counter=137 total t=6.3e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=137 t=9.2e-02 per=1.2e+01 cost=2.3e+08 flops=2.5e+09
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.9e-06,1.5e-05,3.2e-06,2.1e-06,2.8e-07
    6   0 -    -116.541906000151 -2.498e-07  1.486e-04    3     6  6.530e-02 1.088e-02 4.697e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.283e-05,1.326e-04,1.333e-03,3.118e-04,1.806e-03
 ndim=245:1.825e-06GB t[comm(intra)]=1.839e-05 speed=1.985e-01GB/S t[comm(inter)]=4.437e-06 speed=8.228e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=1.3e-03 t_reduction=3.1e-04 tot=1.8e-03 ---
 sigma[inter] counter=138 t=1.3e-04 per=7.5e+00 cost=5.0e+05 flops=3.7e+09
 sigma[gemm] counter=138 i=0 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=1 t=1.8e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=2 t=3.3e-04 per=1.8e+01 cost=2.0e+05 flops=6.2e+08
 sigma[gemm] counter=138 i=3 t=3.4e-04 per=1.9e+01 cost=2.0e+05 flops=6.0e+08
 sigma[gemm] counter=138 i=4 t=3.5e-04 per=2.0e+01 cost=1.7e+05 flops=4.9e+08
 sigma[gemm] counter=138 i=5 t=3.2e-04 per=1.8e+01 cost=1.8e+05 flops=5.6e+08
 sigma[gemm] counter=138 total t=1.3e-03 per=7.5e+01 cost=7.5e+05 flops=5.7e+08
 sigma[red] counter=138 t=3.1e-04 per=1.8e+01 cost=1.0e+05 flops=3.3e+08
--- TIMING FOR sigma_tot : t_inter=5.6e-02 t_gemm=6.3e-01 t_reduction=9.2e-02 tot=7.8e-01 ---
 sigma_tot[inter] counter=138 t=5.6e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=138 i=0 t=2.8e-04 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=1 t=2.3e-04 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=2 t=1.6e-01 per=2.1e+01 cost=9.5e+08 flops=5.9e+09
 sigma_tot[gemm] counter=138 i=3 t=1.6e-01 per=2.0e+01 cost=9.3e+08 flops=5.9e+09
 sigma_tot[gemm] counter=138 i=4 t=1.6e-01 per=2.0e+01 cost=7.9e+08 flops=4.9e+09
 sigma_tot[gemm] counter=138 i=5 t=1.5e-01 per=1.9e+01 cost=8.0e+08 flops=5.3e+09
 sigma_tot[gemm] counter=138 total t=6.3e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=138 t=9.2e-02 per=1.2e+01 cost=2.3e+08 flops=2.5e+09
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=6.1e-06,1.4e-05,3.3e-06,2.0e-06,2.6e-07
    7   0 +    -116.541906050312 -5.016e-08  6.885e-05    3     7  7.438e-02 1.063e-02 4.302e-03
TIMING FOR Davidson : 7.439e-02  T(cal/comm/rest)=3.011e-02,9.430e-07,4.428e-02
decomposed t_rest=4.428e-02
 T(sub)    =1.989e-04 per=4.493e-01
 T(precond)=4.379e-02 per=9.890e+01
 T(ortho)  =3.262e-05 per=7.366e-02
 T(xcopy)  =1.345e-06 per=3.038e-03
 T(xnrm2)  =4.511e-06 per=1.019e-02
 T(other)  =2.484e-04 per=5.610e-01
optimized energies: isweep=0 ibond=19 dots=1 e[0]=-116.541906050312 nmvp=7
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.043e+03S Sys:2.789e+00S Total:1.046e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=25 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond19.txt
 qbond: qsuper nsym=25 dimAll=256
 (0,0):1 (2,0):16 (1,1):4 (1,-1):4 (4,0):36 (3,1):24 (3,-1):24 (2,2):6 (2,-2):6 (6,0):16 (5,1):24 (5,-1):24 (4,2):16 (4,-2):16 (3,3):4 (3,-3):4 (8,0):1 (7,1):4 (7,-1):4 (6,2):6 (6,-2):6 (5,3):4 (5,-3):4 (4,4):1 (4,-4):1
timing for divide=1.7e-05
timing for compute=1.8e-04
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(nkr): 2.1e-04 S T(divide/compute/collect)=1.7e-05,1.8e-04,1.5e-05 -----
decimation summary: 256->24 dwt=+0.000e+00 SvN=1.431e+00
 qbond: qkept nsym=7 dimAll=24
 (6,-2):6 (4,-2):5 (5,-1):4 (5,-3):4 (7,-1):3 (3,-3):1 (4,-4):1
----- TIMING for decimation_row(nkr): 7.699e-04 S T(decim/select/formRot)=3.483e-04,3.820e-04,3.958e-05 -----
----- TIMING FOR onedot_decimation: 1.020e-03 S T(wf/decim)=1.993e-04,8.207e-04 -----
ctns::oper_renorm coord=(16,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:8 S:32 H:1 A:28 B:36 
        dim(bra,ket)=24,24 size(op)=104:7.935e-04MB size(tot)=5708:4.355e-02MB:4.253e-05GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.043e+03S Sys:2.789e+00S Total:1.046e+03S
----- TIMING FOR symbolic_formulae_renorm with size=105 : 5.244e-03 S -----
rank=0 GPUmem(GB): used=0.000237 (oper)=0.000224
rank=0 GPUmem(GB): used=0.000239 (oper,site)(GB)=0.000224,1.83e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=327
 no. of coefficients=1890:0.0144MB:1.41e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.831e-04 S -----
rank=0 GPUmem(GB): used=0.000253 (oper,site,rinter)=0.000224,1.83e-06,1.41e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00462 S size(rtasks)=105 size(Rlst2)=49 T(Rmu/Rlist)=0.00153,0.0031 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00487 S size(rtasks)=105 size(Rlst)=2276 -----
rank=0 GPUmem(GB): used=0.000253 (oper,site,rinter,batch)=0.000224,1.83e-06,1.41e-05,0.00322 blksize=54 blksize0=81 batchsize=2276
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00141,0.0082,0.00333
--- TIMING FOR renorm : t_inter=1.4e-03 t_gemm=8.2e-03 t_reduction=3.3e-03 tot=1.3e-02 ---
 renorm[inter] counter=20 t=1.4e-03 per=1.1e+01 cost=2.5e+05 flops=1.7e+08
 renorm[gemm] counter=20 i=0 t=1.5e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=1 t=1.2e-06 per=9.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=2 t=2.4e-03 per=1.8e+01 cost=1.3e+05 flops=5.4e+07
 renorm[gemm] counter=20 i=3 t=2.5e-03 per=1.9e+01 cost=1.5e+05 flops=5.9e+07
 renorm[gemm] counter=20 i=4 t=1.3e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=5 t=1.2e-06 per=9.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=6 t=3.3e-03 per=2.5e+01 cost=3.1e+05 flops=9.4e+07
 renorm[gemm] counter=20 total t=8.2e-03 per=6.3e+01 cost=5.9e+05 flops=7.2e+07
 renorm[red] counter=20 t=3.3e-03 per=2.6e+01 cost=7.7e+04 flops=2.3e+07
--- TIMING FOR renorm_tot : t_inter=1.5e-02 t_gemm=1.7e-01 t_reduction=4.4e-02 tot=2.3e-01 ---
 renorm_tot[inter] counter=20 t=1.5e-02 per=6.4e+00 cost=5.9e+07 flops=4.0e+09
 renorm_tot[gemm] counter=20 i=0 t=2.9e-05 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=1 t=2.4e-05 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=2 t=4.3e-03 per=1.9e+00 cost=3.1e+05 flops=7.1e+07
 renorm_tot[gemm] counter=20 i=3 t=4.5e-03 per=1.9e+00 cost=3.0e+05 flops=6.7e+07
 renorm_tot[gemm] counter=20 i=4 t=4.4e-02 per=1.9e+01 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=20 i=5 t=5.4e-02 per=2.4e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=20 i=6 t=6.4e-02 per=2.8e+01 cost=1.0e+08 flops=1.6e+09
 renorm_tot[gemm] counter=20 total t=1.7e-01 per=7.4e+01 cost=1.8e+08 flops=1.1e+09
 renorm_tot[red] counter=20 t=4.4e-02 per=1.9e+01 cost=1.3e+07 flops=2.9e+08
qops.to_cpu: size(tot)=5708:4.4e-02MB:4.3e-05GB t[to_cpu]=2.4e-05S speed=1.8e+00GB/S
check ||H-H.dagger||=1.216e-14 coord=(16,0) rank=0
ctns::oper_ab2pq coord=(16,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0415 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.044e+03S Sys:2.789e+00S Total:1.047e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=464:3.540e-03MB:3.457e-06GB
total mem of comb=16149:1.232e-01MB:1.203e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.044e+03S Sys:2.789e+00S Total:1.047e+03S
##### local opt: 2.164e-01 S #####
 T(local opt: fetch) = 3.069e-02 S  per = 14.2  per(accum) = 14.2
 T(local opt: hdiag) = 1.542e-03 S  per = 0.713  per(accum) = 14.9
 T(local opt: dvdsn) = 1.394e-01 S  per = 64.4  per(accum) = 79.3
 T(local opt: decim) = 1.030e-03 S  per = 0.476  per(accum) = 79.8
 T(local opt: guess) = 2.558e-04 S  per = 0.118  per(accum) = 79.9
 T(local opt: renrm) = 4.209e-02 S  per = 19.4  per(accum) = 99.3
 T(local opt: save ) = 1.425e-03 S  per = 0.658  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.394e-01 S  T(sum) = 1.390e-01 S  per = 9.974e+01
 T(local opt: preprocess                  ) = 1.597e-03 S  per = 1.15  per(accum) = 1.15
 T(local opt: symbolic_formulae           ) = 1.500e-02 S  per = 10.8  per(accum) = 11.9
 T(local opt: hintermediate init          ) = 3.164e-04 S  per = 0.228  per(accum) = 12.2
 T(local opt: preprocess_hformulae_Hxlist ) = 1.059e-02 S  per = 7.62  per(accum) = 19.8
 T(local opt: hmmtasks init               ) = 3.711e-02 S  per = 26.7  per(accum) = 46.5
 T(local opt: initial guess for dvdson    ) = 6.669e-06 S  per = 0.0048  per(accum) = 46.5
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.991e-02 S  per = 21.5  per(accum) = 68
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.969e-04 S  per = 0.142  per(accum) = 68.1
 T(local opt: dvdson solver [comm(cpu)]   ) = 9.430e-07 S  per = 0.000678  per(accum) = 68.1
 T(local opt: dvdson solver [rest part]   ) = 4.428e-02 S  per = 31.9  per(accum) = 100
Detailed decomposition of T(renrm) = 4.209e-02 S  T(sum) = 4.209e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.367e-04 S  per = 0.562  per(accum) = 0.562
 T(local opt: qops init                    ) = 1.387e-03 S  per =  3.3  per(accum) = 3.86
 T(local opt: symbolic_formulae_renorm     ) = 5.256e-03 S  per = 12.5  per(accum) = 16.3
 T(local opt: allocate qops on gpu         ) = 2.727e-05 S  per = 0.0648  per(accum) = 16.4
 T(local opt: site memcpy cpu2gpu          ) = 1.944e-05 S  per = 0.0462  per(accum) = 16.5
 T(local opt: rintermediate init           ) = 4.934e-04 S  per = 1.17  per(accum) = 17.6
 T(local opt: preprocess_formulae_Rlist2   ) = 4.953e-03 S  per = 11.8  per(accum) = 29.4
 T(local opt: rmmtasks init                ) = 1.619e-02 S  per = 38.5  per(accum) = 67.9
 T(local opt: qops memset on cpu           ) = 3.100e-08 S  per = 7.37e-05  per(accum) = 67.9
 T(local opt: preprocess_renorm_batchGPU   ) = 1.304e-02 S  per =   31  per(accum) = 98.8
 T(local opt: reduction of opS & opH [nccl]) = 1.186e-06 S  per = 0.00282  per(accum) = 98.8
 T(local opt: qops memcpy gpu2cpu          ) = 2.945e-05 S  per = 0.07  per(accum) = 98.9
 T(local opt: deallocate cpu and gpu memory) = 8.781e-05 S  per = 0.209  per(accum) = 99.1
 T(local opt: reduction of opS & opH [comm]) = 2.883e-05 S  per = 0.0685  per(accum) = 99.2
 T(local opt: conversion from opAB to opPQ ) = 3.800e-06 S  per = 0.00903  per(accum) = 99.2
 T(local opt: after oper_renorm            ) = 3.354e-04 S  per = 0.797  per(accum) = 100
##### sweep opt: 1.113e+01 S #####
 T(sweep opt: fetch) = 2.741e-01 S  per = 2.46  per(accum) = 2.46
 T(sweep opt: hdiag) = 3.763e-02 S  per = 0.338  per(accum) = 2.8
 T(sweep opt: dvdsn) = 4.952e+00 S  per = 44.5  per(accum) = 47.3
 T(sweep opt: decim) = 2.250e-02 S  per = 0.202  per(accum) = 47.5
 T(sweep opt: guess) = 5.749e-03 S  per = 0.0516  per(accum) = 47.5
 T(sweep opt: renrm) = 5.794e+00 S  per =   52  per(accum) = 99.6
 T(sweep opt: save ) = 4.877e-02 S  per = 0.438  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.952e+00 S  T(sum) = 4.497e+00 S  per = 9.080e+01
 T(sweep opt: preprocess                  ) = 9.387e-03 S  per = 0.209  per(accum) = 0.209
 T(sweep opt: symbolic_formulae           ) = 2.688e-01 S  per = 5.98  per(accum) = 6.19
 T(sweep opt: hintermediate init          ) = 6.223e-03 S  per = 0.138  per(accum) = 6.33
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.027e-01 S  per = 6.73  per(accum) = 13.1
 T(sweep opt: hmmtasks init               ) = 2.007e+00 S  per = 44.6  per(accum) = 57.7
 T(sweep opt: initial guess for dvdson    ) = 1.554e-04 S  per = 0.00346  per(accum) = 57.7
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 8.055e-01 S  per = 17.9  per(accum) = 75.6
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.671e-03 S  per = 0.104  per(accum) = 75.7
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.808e-05 S  per = 0.000402  per(accum) = 75.7
 T(sweep opt: dvdson solver [rest part]   ) = 1.092e+00 S  per = 24.3  per(accum) = 100
Detailed decomposition of T(renrm) = 5.794e+00 S  T(sum) = 5.794e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.971e-03 S  per = 0.12  per(accum) = 0.12
 T(sweep opt: qops init                    ) = 6.562e-02 S  per = 1.13  per(accum) = 1.25
 T(sweep opt: symbolic_formulae_renorm     ) = 2.299e-01 S  per = 3.97  per(accum) = 5.22
 T(sweep opt: allocate qops on gpu         ) = 1.371e-03 S  per = 0.0237  per(accum) = 5.24
 T(sweep opt: site memcpy cpu2gpu          ) = 4.519e-04 S  per = 0.0078  per(accum) = 5.25
 T(sweep opt: rintermediate init           ) = 9.804e-03 S  per = 0.169  per(accum) = 5.42
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.950e-01 S  per = 3.37  per(accum) = 8.79
 T(sweep opt: rmmtasks init                ) = 7.609e-01 S  per = 13.1  per(accum) = 21.9
 T(sweep opt: qops memset on cpu           ) = 1.037e-06 S  per = 1.79e-05  per(accum) = 21.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.324e-01 S  per = 4.01  per(accum) = 25.9
 T(sweep opt: reduction of opS & opH [nccl]) = 2.129e-05 S  per = 0.000367  per(accum) = 25.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.456e-03 S  per = 0.0424  per(accum) = 26
 T(sweep opt: deallocate cpu and gpu memory) = 4.560e-01 S  per = 7.87  per(accum) = 33.8
 T(sweep opt: reduction of opS & opH [comm]) = 9.458e-04 S  per = 0.0163  per(accum) = 33.9
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 65.9  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 1.283e-02 S  per = 0.222  per(accum) = 100
##### global opt: 1.113e+01 S #####
 T(global opt: fetch) = 2.741e-01 S  per = 2.46  per(accum) = 2.46
 T(global opt: hdiag) = 3.763e-02 S  per = 0.338  per(accum) = 2.8
 T(global opt: dvdsn) = 4.952e+00 S  per = 44.5  per(accum) = 47.3
 T(global opt: decim) = 2.250e-02 S  per = 0.202  per(accum) = 47.5
 T(global opt: guess) = 5.749e-03 S  per = 0.0516  per(accum) = 47.5
 T(global opt: renrm) = 5.794e+00 S  per =   52  per(accum) = 99.6
 T(global opt: save ) = 4.877e-02 S  per = 0.438  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.952e+00 S  T(sum) = 4.497e+00 S  per = 9.080e+01
 T(global opt: preprocess                  ) = 9.387e-03 S  per = 0.209  per(accum) = 0.209
 T(global opt: symbolic_formulae           ) = 2.688e-01 S  per = 5.98  per(accum) = 6.19
 T(global opt: hintermediate init          ) = 6.223e-03 S  per = 0.138  per(accum) = 6.33
 T(global opt: preprocess_hformulae_Hxlist ) = 3.027e-01 S  per = 6.73  per(accum) = 13.1
 T(global opt: hmmtasks init               ) = 2.007e+00 S  per = 44.6  per(accum) = 57.7
 T(global opt: initial guess for dvdson    ) = 1.554e-04 S  per = 0.00346  per(accum) = 57.7
 T(global opt: dvdson solver [Hx_batchGPU] ) = 8.055e-01 S  per = 17.9  per(accum) = 75.6
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.671e-03 S  per = 0.104  per(accum) = 75.7
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.808e-05 S  per = 0.000402  per(accum) = 75.7
 T(global opt: dvdson solver [rest part]   ) = 1.092e+00 S  per = 24.3  per(accum) = 100
Detailed decomposition of T(renrm) = 5.794e+00 S  T(sum) = 5.794e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.971e-03 S  per = 0.12  per(accum) = 0.12
 T(global opt: qops init                    ) = 6.562e-02 S  per = 1.13  per(accum) = 1.25
 T(global opt: symbolic_formulae_renorm     ) = 2.299e-01 S  per = 3.97  per(accum) = 5.22
 T(global opt: allocate qops on gpu         ) = 1.371e-03 S  per = 0.0237  per(accum) = 5.24
 T(global opt: site memcpy cpu2gpu          ) = 4.519e-04 S  per = 0.0078  per(accum) = 5.25
 T(global opt: rintermediate init           ) = 9.804e-03 S  per = 0.169  per(accum) = 5.42
 T(global opt: preprocess_formulae_Rlist2   ) = 1.950e-01 S  per = 3.37  per(accum) = 8.79
 T(global opt: rmmtasks init                ) = 7.609e-01 S  per = 13.1  per(accum) = 21.9
 T(global opt: qops memset on cpu           ) = 1.037e-06 S  per = 1.79e-05  per(accum) = 21.9
 T(global opt: preprocess_renorm_batchGPU   ) = 2.324e-01 S  per = 4.01  per(accum) = 25.9
 T(global opt: reduction of opS & opH [nccl]) = 2.129e-05 S  per = 0.000367  per(accum) = 25.9
 T(global opt: qops memcpy gpu2cpu          ) = 2.456e-03 S  per = 0.0424  per(accum) = 26
 T(global opt: deallocate cpu and gpu memory) = 4.560e-01 S  per = 7.87  per(accum) = 33.8
 T(global opt: reduction of opS & opH [comm]) = 9.458e-04 S  per = 0.0163  per(accum) = 33.9
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 65.9  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 1.283e-02 S  per = 0.222  per(accum) = 100

isweep=0 ibond=20/seqsize=34 dots=1 dbond=(14,0)-(15,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.044e+03S Sys:2.789e+00S Total:1.047e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=464:3.540e-03MB:3.457e-06GB
total mem of comb=16149:1.232e-01MB:1.203e-04GB
ctns::topology::check_partition: (sl,sr,sc)=15,4,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 12 13 14 15
 suppc= 11
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:30 S:10 H:1 P:45 Q:55 
        dim(bra,ket)=42,42 size(op)=270:2.060e-03MB size(tot)=21070:1.608e-01MB:1.570e-04GB
 rqops: oplist=CSHAB nops=C:8 S:32 H:1 A:28 B:36 
        dim(bra,ket)=24,24 size(op)=104:7.935e-04MB size(tot)=5708:4.355e-02MB:4.253e-05GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=29114:2.221e-01MB:2.169e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(15,0) fdel=./scratch/sweep/lop(14,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
wf3(diml,dimr,dimc)=(42,24,4) nnz=464:3.540e-03MB
qtensor3: wf3 own=1 _data=0x52b64c80
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=8 dimAll=42
 (23,3):8 (22,2):8 (24,2):8 (23,1):6 (25,3):4 (24,4):4 (21,1):3 (25,1):1
 qbond: qcol nsym=7 dimAll=24
 (6,-2):6 (4,-2):5 (5,-1):4 (5,-3):4 (7,-1):3 (3,-3):1 (4,-4):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=20 nblocks=224 size=464:3.540e-03MB
### DIAG TIMING: total=8.294e-04 t1=9.396e-06, t2=1.087e-05, t3=2.724e-05, t4=7.597e-04, t5=6.029e-06, t6=1.269e-05, t7=3.405e-06
duration_diagGPU:8.398e-04
duration_diagreduce:3.600e-08
duration_diagtransform:1.863e-06
----- TIMING FOR symbolic_formulae_onedot with size=435 : 8.492e-03 S -----
rank=0 GPUmem(GB): used=0.000217 (oper)=0.000217
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=435
 no. of hintermediate operators=188
 no. of coefficients=2820:0.0215MB:2.1e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.717e-04 S -----
rank=0 GPUmem(GB): used=0.000238 (oper,hinter)=0.000217,2.1e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00648 S size(H_formulae)=435 size(Hxlst2)=20 T(Hmu/Hxlist)=0.000978,0.0055 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00696 S size(H_formulae)=435 size(Hxlst)=5870 -----
rank=0 GPUmem(GB): used=0.00729 (oper,hinter,dvdson,batch)=0.000217,2.1e-05,6.91e-06,0.00704 blksize=48 blksize0=64 batchsize=5870
ctns::pdvdsonSolver_nkr::solve_iter ndim=464 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.39e-05,0.000128,0.00131,0.000272,0.00175
 ndim=464:3.46e-06GB t[comm(intra)]=2.91e-05 speed=0.238GB/S t[comm(inter)]=4.82e-06 speed=1.44GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=1.3e-03 t_reduction=2.7e-04 tot=1.7e-03 ---
 sigma[inter] counter=139 t=1.3e-04 per=7.5e+00 cost=2.2e+06 flops=1.7e+10
 sigma[gemm] counter=139 i=0 t=1.4e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=1 t=1.2e-06 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=2 t=3.3e-04 per=1.9e+01 cost=6.0e+05 flops=1.8e+09
 sigma[gemm] counter=139 i=3 t=3.4e-04 per=2.0e+01 cost=5.8e+05 flops=1.7e+09
 sigma[gemm] counter=139 i=4 t=3.2e-04 per=1.9e+01 cost=7.8e+05 flops=2.4e+09
 sigma[gemm] counter=139 i=5 t=3.2e-04 per=1.9e+01 cost=7.6e+05 flops=2.4e+09
 sigma[gemm] counter=139 total t=1.3e-03 per=7.7e+01 cost=2.7e+06 flops=2.1e+09
 sigma[red] counter=139 t=2.7e-04 per=1.6e+01 cost=3.0e+05 flops=1.1e+09
--- TIMING FOR sigma_tot : t_inter=5.6e-02 t_gemm=6.3e-01 t_reduction=9.3e-02 tot=7.8e-01 ---
 sigma_tot[inter] counter=139 t=5.6e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=139 i=0 t=2.8e-04 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=1 t=2.3e-04 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=2 t=1.6e-01 per=2.1e+01 cost=9.5e+08 flops=5.9e+09
 sigma_tot[gemm] counter=139 i=3 t=1.6e-01 per=2.0e+01 cost=9.3e+08 flops=5.9e+09
 sigma_tot[gemm] counter=139 i=4 t=1.6e-01 per=2.0e+01 cost=7.9e+08 flops=4.9e+09
 sigma_tot[gemm] counter=139 i=5 t=1.5e-01 per=1.9e+01 cost=8.0e+08 flops=5.3e+09
 sigma_tot[gemm] counter=139 total t=6.3e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=139 t=9.3e-02 per=1.2e+01 cost=2.3e+08 flops=2.5e+09
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,4.0e-06,1.8e-06,1.1e-06,3.3e-07
settings: ndim=464 neig=1 maxcycle=30 nbuff=4 memory=5e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.541906050312 -1.117e+03  7.549e-03    1     1  1.870e-03 1.870e-03 1.843e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.622e-05,1.802e-04,1.787e-03,3.645e-04,2.366e-03
 ndim=464:3.457e-06GB t[comm(intra)]=2.147e-05 speed=3.221e-01GB/S t[comm(inter)]=4.757e-06 speed=1.453e+00GB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.8e-03 t_reduction=3.6e-04 tot=2.3e-03 ---
 sigma[inter] counter=140 t=1.8e-04 per=7.7e+00 cost=2.2e+06 flops=1.2e+10
 sigma[gemm] counter=140 i=0 t=2.0e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=1 t=1.8e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=2 t=4.8e-04 per=2.0e+01 cost=6.0e+05 flops=1.3e+09
 sigma[gemm] counter=140 i=3 t=4.5e-04 per=1.9e+01 cost=5.8e+05 flops=1.3e+09
 sigma[gemm] counter=140 i=4 t=4.2e-04 per=1.8e+01 cost=7.8e+05 flops=1.8e+09
 sigma[gemm] counter=140 i=5 t=4.3e-04 per=1.9e+01 cost=7.6e+05 flops=1.8e+09
 sigma[gemm] counter=140 total t=1.8e-03 per=7.7e+01 cost=2.7e+06 flops=1.5e+09
 sigma[red] counter=140 t=3.6e-04 per=1.6e+01 cost=3.0e+05 flops=8.2e+08
--- TIMING FOR sigma_tot : t_inter=5.6e-02 t_gemm=6.3e-01 t_reduction=9.3e-02 tot=7.8e-01 ---
 sigma_tot[inter] counter=140 t=5.6e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=140 i=0 t=2.8e-04 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=1 t=2.3e-04 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=2 t=1.6e-01 per=2.1e+01 cost=9.5e+08 flops=5.9e+09
 sigma_tot[gemm] counter=140 i=3 t=1.6e-01 per=2.0e+01 cost=9.3e+08 flops=5.9e+09
 sigma_tot[gemm] counter=140 i=4 t=1.6e-01 per=2.0e+01 cost=7.9e+08 flops=4.9e+09
 sigma_tot[gemm] counter=140 i=5 t=1.5e-01 per=1.9e+01 cost=8.0e+08 flops=5.3e+09
 sigma_tot[gemm] counter=140 total t=6.3e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=140 t=9.3e-02 per=1.2e+01 cost=2.3e+08 flops=2.4e+09
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=7.5e-06,1.2e-05,3.8e-06,2.1e-06,3.8e-07
    2   0 -    -116.541995527315 -8.948e-05  2.204e-03    2     2  1.189e-02 5.947e-03 2.169e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.653e-05,1.776e-04,1.786e-03,3.867e-04,2.384e-03
 ndim=464:3.457e-06GB t[comm(intra)]=2.123e-05 speed=3.257e-01GB/S t[comm(inter)]=5.304e-06 speed=1.304e+00GB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.8e-03 t_reduction=3.9e-04 tot=2.3e-03 ---
 sigma[inter] counter=141 t=1.8e-04 per=7.5e+00 cost=2.2e+06 flops=1.2e+10
 sigma[gemm] counter=141 i=0 t=2.0e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=1 t=1.7e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=2 t=5.0e-04 per=2.1e+01 cost=6.0e+05 flops=1.2e+09
 sigma[gemm] counter=141 i=3 t=4.3e-04 per=1.8e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=141 i=4 t=4.4e-04 per=1.9e+01 cost=7.8e+05 flops=1.8e+09
 sigma[gemm] counter=141 i=5 t=4.1e-04 per=1.7e+01 cost=7.6e+05 flops=1.9e+09
 sigma[gemm] counter=141 total t=1.8e-03 per=7.6e+01 cost=2.7e+06 flops=1.5e+09
 sigma[red] counter=141 t=3.9e-04 per=1.6e+01 cost=3.0e+05 flops=7.8e+08
--- TIMING FOR sigma_tot : t_inter=5.6e-02 t_gemm=6.3e-01 t_reduction=9.3e-02 tot=7.8e-01 ---
 sigma_tot[inter] counter=141 t=5.6e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=141 i=0 t=2.8e-04 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=1 t=2.3e-04 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=2 t=1.6e-01 per=2.1e+01 cost=9.5e+08 flops=5.9e+09
 sigma_tot[gemm] counter=141 i=3 t=1.6e-01 per=2.0e+01 cost=9.3e+08 flops=5.9e+09
 sigma_tot[gemm] counter=141 i=4 t=1.6e-01 per=2.0e+01 cost=7.9e+08 flops=4.9e+09
 sigma_tot[gemm] counter=141 i=5 t=1.5e-01 per=1.9e+01 cost=8.1e+08 flops=5.3e+09
 sigma_tot[gemm] counter=141 total t=6.3e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=141 t=9.3e-02 per=1.2e+01 cost=2.3e+08 flops=2.4e+09
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=7.9e-06,1.6e-05,3.3e-06,2.9e-06,3.9e-07
    3   0 -    -116.542003443519 -7.916e-06  9.050e-04    3     3  2.247e-02 7.490e-03 2.282e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.414e-05,1.774e-04,1.770e-03,3.825e-04,2.362e-03
 ndim=464:3.457e-06GB t[comm(intra)]=1.942e-05 speed=3.561e-01GB/S t[comm(inter)]=4.723e-06 speed=1.464e+00GB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.8e-03 t_reduction=3.8e-04 tot=2.3e-03 ---
 sigma[inter] counter=142 t=1.8e-04 per=7.6e+00 cost=2.2e+06 flops=1.2e+10
 sigma[gemm] counter=142 i=0 t=6.6e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=1 t=3.4e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=2 t=4.8e-04 per=2.1e+01 cost=6.0e+05 flops=1.2e+09
 sigma[gemm] counter=142 i=3 t=4.3e-04 per=1.9e+01 cost=5.8e+05 flops=1.3e+09
 sigma[gemm] counter=142 i=4 t=4.4e-04 per=1.9e+01 cost=7.8e+05 flops=1.8e+09
 sigma[gemm] counter=142 i=5 t=4.1e-04 per=1.8e+01 cost=7.6e+05 flops=1.9e+09
 sigma[gemm] counter=142 total t=1.8e-03 per=7.6e+01 cost=2.7e+06 flops=1.5e+09
 sigma[red] counter=142 t=3.8e-04 per=1.6e+01 cost=3.0e+05 flops=7.8e+08
--- TIMING FOR sigma_tot : t_inter=5.7e-02 t_gemm=6.4e-01 t_reduction=9.4e-02 tot=7.9e-01 ---
 sigma_tot[inter] counter=142 t=5.7e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=142 i=0 t=2.9e-04 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=1 t=2.4e-04 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=2 t=1.6e-01 per=2.1e+01 cost=9.5e+08 flops=5.9e+09
 sigma_tot[gemm] counter=142 i=3 t=1.6e-01 per=2.0e+01 cost=9.3e+08 flops=5.9e+09
 sigma_tot[gemm] counter=142 i=4 t=1.6e-01 per=2.0e+01 cost=7.9e+08 flops=4.9e+09
 sigma_tot[gemm] counter=142 i=5 t=1.5e-01 per=1.9e+01 cost=8.1e+08 flops=5.3e+09
 sigma_tot[gemm] counter=142 total t=6.4e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=142 t=9.4e-02 per=1.2e+01 cost=2.3e+08 flops=2.4e+09
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=8.1e-06,1.5e-05,3.2e-06,2.8e-06,3.6e-07
    4   0 -    -116.542004802693 -1.359e-06  3.722e-04    3     4  3.157e-02 7.893e-03 2.333e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.429e-05,1.822e-04,1.757e-03,3.878e-04,2.359e-03
 ndim=464:3.457e-06GB t[comm(intra)]=1.968e-05 speed=3.513e-01GB/S t[comm(inter)]=4.613e-06 speed=1.499e+00GB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.8e-03 t_reduction=3.9e-04 tot=2.3e-03 ---
 sigma[inter] counter=143 t=1.8e-04 per=7.8e+00 cost=2.2e+06 flops=1.2e+10
 sigma[gemm] counter=143 i=0 t=1.9e-06 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=1 t=1.8e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=2 t=4.7e-04 per=2.0e+01 cost=6.0e+05 flops=1.3e+09
 sigma[gemm] counter=143 i=3 t=4.4e-04 per=1.9e+01 cost=5.8e+05 flops=1.3e+09
 sigma[gemm] counter=143 i=4 t=4.2e-04 per=1.8e+01 cost=7.8e+05 flops=1.8e+09
 sigma[gemm] counter=143 i=5 t=4.1e-04 per=1.8e+01 cost=7.6e+05 flops=1.8e+09
 sigma[gemm] counter=143 total t=1.8e-03 per=7.6e+01 cost=2.7e+06 flops=1.5e+09
 sigma[red] counter=143 t=3.9e-04 per=1.7e+01 cost=3.0e+05 flops=7.7e+08
--- TIMING FOR sigma_tot : t_inter=5.7e-02 t_gemm=6.4e-01 t_reduction=9.4e-02 tot=7.9e-01 ---
 sigma_tot[inter] counter=143 t=5.7e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=143 i=0 t=2.9e-04 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=1 t=2.4e-04 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=2 t=1.6e-01 per=2.1e+01 cost=9.5e+08 flops=5.9e+09
 sigma_tot[gemm] counter=143 i=3 t=1.6e-01 per=2.0e+01 cost=9.3e+08 flops=5.8e+09
 sigma_tot[gemm] counter=143 i=4 t=1.6e-01 per=2.0e+01 cost=7.9e+08 flops=4.9e+09
 sigma_tot[gemm] counter=143 i=5 t=1.5e-01 per=1.9e+01 cost=8.1e+08 flops=5.3e+09
 sigma_tot[gemm] counter=143 total t=6.4e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=143 t=9.4e-02 per=1.2e+01 cost=2.3e+08 flops=2.4e+09
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=7.7e-06,1.5e-05,3.2e-06,2.9e-06,3.6e-07
    5   0 -    -116.542005023049 -2.204e-07  1.389e-04    3     5  4.069e-02 8.138e-03 2.363e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.481e-05,1.756e-04,1.769e-03,3.593e-04,2.336e-03
 ndim=464:3.457e-06GB t[comm(intra)]=1.991e-05 speed=3.473e-01GB/S t[comm(inter)]=4.904e-06 speed=1.410e+00GB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.8e-03 t_reduction=3.6e-04 tot=2.3e-03 ---
 sigma[inter] counter=144 t=1.8e-04 per=7.6e+00 cost=2.2e+06 flops=1.3e+10
 sigma[gemm] counter=144 i=0 t=2.0e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=1 t=1.7e-06 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=2 t=4.7e-04 per=2.0e+01 cost=6.0e+05 flops=1.3e+09
 sigma[gemm] counter=144 i=3 t=4.5e-04 per=2.0e+01 cost=5.8e+05 flops=1.3e+09
 sigma[gemm] counter=144 i=4 t=4.2e-04 per=1.8e+01 cost=7.8e+05 flops=1.9e+09
 sigma[gemm] counter=144 i=5 t=4.2e-04 per=1.8e+01 cost=7.6e+05 flops=1.8e+09
 sigma[gemm] counter=144 total t=1.8e-03 per=7.7e+01 cost=2.7e+06 flops=1.5e+09
 sigma[red] counter=144 t=3.6e-04 per=1.6e+01 cost=3.0e+05 flops=8.3e+08
--- TIMING FOR sigma_tot : t_inter=5.7e-02 t_gemm=6.4e-01 t_reduction=9.5e-02 tot=7.9e-01 ---
 sigma_tot[inter] counter=144 t=5.7e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=144 i=0 t=2.9e-04 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=1 t=2.4e-04 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=2 t=1.6e-01 per=2.1e+01 cost=9.5e+08 flops=5.8e+09
 sigma_tot[gemm] counter=144 i=3 t=1.6e-01 per=2.0e+01 cost=9.4e+08 flops=5.8e+09
 sigma_tot[gemm] counter=144 i=4 t=1.6e-01 per=2.0e+01 cost=7.9e+08 flops=4.9e+09
 sigma_tot[gemm] counter=144 i=5 t=1.5e-01 per=1.9e+01 cost=8.1e+08 flops=5.3e+09
 sigma_tot[gemm] counter=144 total t=6.4e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=144 t=9.5e-02 per=1.2e+01 cost=2.3e+08 flops=2.4e+09
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=7.6e-06,1.5e-05,3.2e-06,3.0e-06,3.5e-07
    6   0 +    -116.542005052969 -2.992e-08  5.258e-05    3     6  4.981e-02 8.301e-03 2.380e-03
TIMING FOR Davidson : 4.982e-02  T(cal/comm/rest)=1.428e-02,7.150e-07,3.554e-02
decomposed t_rest=3.554e-02
 T(sub)    =1.532e-04 per=4.310e-01
 T(precond)=3.516e-02 per=9.893e+01
 T(ortho)  =2.835e-05 per=7.977e-02
 T(xcopy)  =1.400e-06 per=3.939e-03
 T(xnrm2)  =3.796e-06 per=1.068e-02
 T(other)  =1.942e-04 per=5.465e-01
optimized energies: isweep=0 ibond=20 dots=1 e[0]=-116.542005052969 nmvp=6
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.049e+03S Sys:2.789e+00S Total:1.052e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=14 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond20.txt
 qbond: qsuper nsym=14 dimAll=96
 (6,-2):19 (4,-2):6 (5,-1):9 (5,-3):11 (7,-1):13 (3,-3):1 (4,-4):2 (8,-2):9 (7,-3):10 (9,-1):3 (6,-4):5 (6,0):4 (8,0):3 (5,-5):1
timing for divide=1.4e-05
timing for compute=2.1e-04
timing for collect=1.8e-05
----- TMING FOR decimation_genbasis(nkr): 2.5e-04 S T(divide/compute/collect)=1.4e-05,2.1e-04,1.8e-05 -----
decimation summary: 96->42 dwt=+1.110e-16 SvN=1.399e+00
 qbond: qkept nsym=8 dimAll=42
 (6,-2):8 (8,-2):8 (7,-3):8 (7,-1):6 (5,-3):4 (6,-4):4 (9,-1):3 (5,-1):1
----- TIMING for decimation_row(nkr): 9.366e-04 S T(decim/select/formRot)=3.291e-04,5.434e-04,6.407e-05 -----
----- TIMING FOR onedot_decimation: 1.157e-03 S T(wf/decim)=1.654e-04,9.917e-04 -----
ctns::oper_renorm coord=(15,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:10 S:30 H:1 A:45 B:55 
        dim(bra,ket)=42,42 size(op)=270:2.060e-03MB size(tot)=21070:1.608e-01MB:1.570e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.049e+03S Sys:2.789e+00S Total:1.052e+03S
----- TIMING FOR symbolic_formulae_renorm with size=141 : 6.397e-03 S -----
rank=0 GPUmem(GB): used=0.000238 (oper)=0.000217
rank=0 GPUmem(GB): used=0.000241 (oper,site)(GB)=0.000217,3.46e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=307
 no. of coefficients=2932:0.0224MB:2.18e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.463e-04 S -----
rank=0 GPUmem(GB): used=0.000263 (oper,site,rinter)=0.000217,3.46e-06,2.18e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00523 S size(rtasks)=141 size(Rlst2)=64 T(Rmu/Rlist)=0.00145,0.00378 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00553 S size(rtasks)=141 size(Rlst)=3094 -----
rank=0 GPUmem(GB): used=0.000263 (oper,site,rinter,batch)=0.000217,3.46e-06,2.18e-05,0.0038 blksize=64 blksize0=36 batchsize=3094
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00187,0.0101,0.00344
--- TIMING FOR renorm : t_inter=1.9e-03 t_gemm=1.0e-02 t_reduction=3.4e-03 tot=1.5e-02 ---
 renorm[inter] counter=21 t=1.9e-03 per=1.2e+01 cost=6.3e+05 flops=3.3e+08
 renorm[gemm] counter=21 i=0 t=1.5e-06 per=9.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=1 t=1.2e-06 per=7.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=2 t=3.1e-03 per=2.0e+01 cost=2.8e+05 flops=9.0e+07
 renorm[gemm] counter=21 i=3 t=2.9e-03 per=1.9e+01 cost=3.6e+05 flops=1.2e+08
 renorm[gemm] counter=21 i=4 t=1.2e-06 per=8.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=5 t=1.1e-06 per=7.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=6 t=4.1e-03 per=2.6e+01 cost=9.6e+05 flops=2.4e+08
 renorm[gemm] counter=21 total t=1.0e-02 per=6.5e+01 cost=1.6e+06 flops=1.6e+08
 renorm[red] counter=21 t=3.4e-03 per=2.2e+01 cost=2.2e+05 flops=6.5e+07
--- TIMING FOR renorm_tot : t_inter=1.7e-02 t_gemm=1.8e-01 t_reduction=4.8e-02 tot=2.5e-01 ---
 renorm_tot[inter] counter=21 t=1.7e-02 per=6.8e+00 cost=6.0e+07 flops=3.6e+09
 renorm_tot[gemm] counter=21 i=0 t=3.1e-05 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=21 i=1 t=2.6e-05 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=21 i=2 t=7.4e-03 per=3.0e+00 cost=5.9e+05 flops=7.9e+07
 renorm_tot[gemm] counter=21 i=3 t=7.3e-03 per=3.0e+00 cost=6.6e+05 flops=8.9e+07
 renorm_tot[gemm] counter=21 i=4 t=4.4e-02 per=1.8e+01 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=21 i=5 t=5.4e-02 per=2.2e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=21 i=6 t=6.8e-02 per=2.8e+01 cost=1.0e+08 flops=1.5e+09
 renorm_tot[gemm] counter=21 total t=1.8e-01 per=7.4e+01 cost=1.8e+08 flops=1.0e+09
 renorm_tot[red] counter=21 t=4.8e-02 per=1.9e+01 cost=1.3e+07 flops=2.8e+08
qops.to_cpu: size(tot)=21070:1.6e-01MB:1.6e-04GB t[to_cpu]=4.7e-05S speed=3.3e+00GB/S
check ||H-H.dagger||=2.595e-14 coord=(15,0) rank=0
ctns::oper_ab2pq coord=(15,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0498 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.050e+03S Sys:2.790e+00S Total:1.053e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1021:7.790e-03MB:7.607e-06GB
total mem of comb=16706:1.275e-01MB:1.245e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.050e+03S Sys:2.791e+00S Total:1.053e+03S
##### local opt: 1.619e-01 S #####
 T(local opt: fetch) = 1.041e-02 S  per = 6.43  per(accum) = 6.43
 T(local opt: hdiag) = 8.969e-04 S  per = 0.554  per(accum) = 6.98
 T(local opt: dvdsn) = 9.743e-02 S  per = 60.2  per(accum) = 67.2
 T(local opt: decim) = 1.166e-03 S  per = 0.72  per(accum) = 67.9
 T(local opt: guess) = 2.475e-04 S  per = 0.153  per(accum) = 68
 T(local opt: renrm) = 5.029e-02 S  per = 31.1  per(accum) = 99.1
 T(local opt: save ) = 1.455e-03 S  per = 0.898  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.743e-02 S  T(sum) = 9.708e-02 S  per = 9.964e+01
 T(local opt: preprocess                  ) = 3.143e-04 S  per = 0.324  per(accum) = 0.324
 T(local opt: symbolic_formulae           ) = 8.507e-03 S  per = 8.76  per(accum) = 9.09
 T(local opt: hintermediate init          ) = 1.862e-04 S  per = 0.192  per(accum) = 9.28
 T(local opt: preprocess_hformulae_Hxlist ) = 7.136e-03 S  per = 7.35  per(accum) = 16.6
 T(local opt: hmmtasks init               ) = 3.112e-02 S  per =   32  per(accum) = 48.7
 T(local opt: initial guess for dvdson    ) = 4.630e-06 S  per = 0.00477  per(accum) = 48.7
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.412e-02 S  per = 14.5  per(accum) = 63.2
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.599e-04 S  per = 0.165  per(accum) = 63.4
 T(local opt: dvdson solver [comm(cpu)]   ) = 7.150e-07 S  per = 0.000736  per(accum) = 63.4
 T(local opt: dvdson solver [rest part]   ) = 3.554e-02 S  per = 36.6  per(accum) = 100
Detailed decomposition of T(renrm) = 5.029e-02 S  T(sum) = 5.029e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.615e-04 S  per = 0.321  per(accum) = 0.321
 T(local opt: qops init                    ) = 1.874e-03 S  per = 3.73  per(accum) = 4.05
 T(local opt: symbolic_formulae_renorm     ) = 6.410e-03 S  per = 12.7  per(accum) = 16.8
 T(local opt: allocate qops on gpu         ) = 2.769e-05 S  per = 0.0551  per(accum) = 16.8
 T(local opt: site memcpy cpu2gpu          ) = 1.828e-05 S  per = 0.0363  per(accum) = 16.9
 T(local opt: rintermediate init           ) = 4.559e-04 S  per = 0.907  per(accum) = 17.8
 T(local opt: preprocess_formulae_Rlist2   ) = 5.633e-03 S  per = 11.2  per(accum) = 29
 T(local opt: rmmtasks init                ) = 1.969e-02 S  per = 39.1  per(accum) = 68.1
 T(local opt: qops memset on cpu           ) = 5.700e-08 S  per = 0.000113  per(accum) = 68.1
 T(local opt: preprocess_renorm_batchGPU   ) = 1.548e-02 S  per = 30.8  per(accum) = 98.9
 T(local opt: reduction of opS & opH [nccl]) = 9.590e-07 S  per = 0.00191  per(accum) = 98.9
 T(local opt: qops memcpy gpu2cpu          ) = 5.302e-05 S  per = 0.105  per(accum) = 99
 T(local opt: deallocate cpu and gpu memory) = 8.550e-05 S  per = 0.17  per(accum) = 99.2
 T(local opt: reduction of opS & opH [comm]) = 3.432e-05 S  per = 0.0682  per(accum) = 99.3
 T(local opt: conversion from opAB to opPQ ) = 3.736e-06 S  per = 0.00743  per(accum) = 99.3
 T(local opt: after oper_renorm            ) = 3.672e-04 S  per = 0.73  per(accum) = 100
##### sweep opt: 1.130e+01 S #####
 T(sweep opt: fetch) = 2.845e-01 S  per = 2.52  per(accum) = 2.52
 T(sweep opt: hdiag) = 3.853e-02 S  per = 0.341  per(accum) = 2.86
 T(sweep opt: dvdsn) = 5.050e+00 S  per = 44.7  per(accum) = 47.6
 T(sweep opt: decim) = 2.367e-02 S  per = 0.21  per(accum) = 47.8
 T(sweep opt: guess) = 5.997e-03 S  per = 0.0531  per(accum) = 47.8
 T(sweep opt: renrm) = 5.844e+00 S  per = 51.7  per(accum) = 99.6
 T(sweep opt: save ) = 5.022e-02 S  per = 0.445  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.050e+00 S  T(sum) = 4.594e+00 S  per = 9.097e+01
 T(sweep opt: preprocess                  ) = 9.701e-03 S  per = 0.211  per(accum) = 0.211
 T(sweep opt: symbolic_formulae           ) = 2.773e-01 S  per = 6.04  per(accum) = 6.25
 T(sweep opt: hintermediate init          ) = 6.409e-03 S  per = 0.14  per(accum) = 6.39
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.098e-01 S  per = 6.74  per(accum) = 13.1
 T(sweep opt: hmmtasks init               ) = 2.038e+00 S  per = 44.4  per(accum) = 57.5
 T(sweep opt: initial guess for dvdson    ) = 1.601e-04 S  per = 0.00348  per(accum) = 57.5
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 8.196e-01 S  per = 17.8  per(accum) = 75.4
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.831e-03 S  per = 0.105  per(accum) = 75.5
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.879e-05 S  per = 0.000409  per(accum) = 75.5
 T(sweep opt: dvdson solver [rest part]   ) = 1.127e+00 S  per = 24.5  per(accum) = 100
Detailed decomposition of T(renrm) = 5.844e+00 S  T(sum) = 5.844e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.133e-03 S  per = 0.122  per(accum) = 0.122
 T(sweep opt: qops init                    ) = 6.749e-02 S  per = 1.15  per(accum) = 1.28
 T(sweep opt: symbolic_formulae_renorm     ) = 2.363e-01 S  per = 4.04  per(accum) = 5.32
 T(sweep opt: allocate qops on gpu         ) = 1.398e-03 S  per = 0.0239  per(accum) = 5.34
 T(sweep opt: site memcpy cpu2gpu          ) = 4.702e-04 S  per = 0.00805  per(accum) = 5.35
 T(sweep opt: rintermediate init           ) = 1.026e-02 S  per = 0.176  per(accum) = 5.53
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.006e-01 S  per = 3.43  per(accum) = 8.96
 T(sweep opt: rmmtasks init                ) = 7.806e-01 S  per = 13.4  per(accum) = 22.3
 T(sweep opt: qops memset on cpu           ) = 1.094e-06 S  per = 1.87e-05  per(accum) = 22.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.479e-01 S  per = 4.24  per(accum) = 26.6
 T(sweep opt: reduction of opS & opH [nccl]) = 2.225e-05 S  per = 0.000381  per(accum) = 26.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.509e-03 S  per = 0.0429  per(accum) = 26.6
 T(sweep opt: deallocate cpu and gpu memory) = 4.561e-01 S  per =  7.8  per(accum) = 34.4
 T(sweep opt: reduction of opS & opH [comm]) = 9.801e-04 S  per = 0.0168  per(accum) = 34.4
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 65.4  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 1.320e-02 S  per = 0.226  per(accum) = 100
##### global opt: 1.130e+01 S #####
 T(global opt: fetch) = 2.845e-01 S  per = 2.52  per(accum) = 2.52
 T(global opt: hdiag) = 3.853e-02 S  per = 0.341  per(accum) = 2.86
 T(global opt: dvdsn) = 5.050e+00 S  per = 44.7  per(accum) = 47.6
 T(global opt: decim) = 2.367e-02 S  per = 0.21  per(accum) = 47.8
 T(global opt: guess) = 5.997e-03 S  per = 0.0531  per(accum) = 47.8
 T(global opt: renrm) = 5.844e+00 S  per = 51.7  per(accum) = 99.6
 T(global opt: save ) = 5.022e-02 S  per = 0.445  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.050e+00 S  T(sum) = 4.594e+00 S  per = 9.097e+01
 T(global opt: preprocess                  ) = 9.701e-03 S  per = 0.211  per(accum) = 0.211
 T(global opt: symbolic_formulae           ) = 2.773e-01 S  per = 6.04  per(accum) = 6.25
 T(global opt: hintermediate init          ) = 6.409e-03 S  per = 0.14  per(accum) = 6.39
 T(global opt: preprocess_hformulae_Hxlist ) = 3.098e-01 S  per = 6.74  per(accum) = 13.1
 T(global opt: hmmtasks init               ) = 2.038e+00 S  per = 44.4  per(accum) = 57.5
 T(global opt: initial guess for dvdson    ) = 1.601e-04 S  per = 0.00348  per(accum) = 57.5
 T(global opt: dvdson solver [Hx_batchGPU] ) = 8.196e-01 S  per = 17.8  per(accum) = 75.4
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.831e-03 S  per = 0.105  per(accum) = 75.5
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.879e-05 S  per = 0.000409  per(accum) = 75.5
 T(global opt: dvdson solver [rest part]   ) = 1.127e+00 S  per = 24.5  per(accum) = 100
Detailed decomposition of T(renrm) = 5.844e+00 S  T(sum) = 5.844e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.133e-03 S  per = 0.122  per(accum) = 0.122
 T(global opt: qops init                    ) = 6.749e-02 S  per = 1.15  per(accum) = 1.28
 T(global opt: symbolic_formulae_renorm     ) = 2.363e-01 S  per = 4.04  per(accum) = 5.32
 T(global opt: allocate qops on gpu         ) = 1.398e-03 S  per = 0.0239  per(accum) = 5.34
 T(global opt: site memcpy cpu2gpu          ) = 4.702e-04 S  per = 0.00805  per(accum) = 5.35
 T(global opt: rintermediate init           ) = 1.026e-02 S  per = 0.176  per(accum) = 5.53
 T(global opt: preprocess_formulae_Rlist2   ) = 2.006e-01 S  per = 3.43  per(accum) = 8.96
 T(global opt: rmmtasks init                ) = 7.806e-01 S  per = 13.4  per(accum) = 22.3
 T(global opt: qops memset on cpu           ) = 1.094e-06 S  per = 1.87e-05  per(accum) = 22.3
 T(global opt: preprocess_renorm_batchGPU   ) = 2.479e-01 S  per = 4.24  per(accum) = 26.6
 T(global opt: reduction of opS & opH [nccl]) = 2.225e-05 S  per = 0.000381  per(accum) = 26.6
 T(global opt: qops memcpy gpu2cpu          ) = 2.509e-03 S  per = 0.0429  per(accum) = 26.6
 T(global opt: deallocate cpu and gpu memory) = 4.561e-01 S  per =  7.8  per(accum) = 34.4
 T(global opt: reduction of opS & opH [comm]) = 9.801e-04 S  per = 0.0168  per(accum) = 34.4
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 65.4  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 1.320e-02 S  per = 0.226  per(accum) = 100

isweep=0 ibond=21/seqsize=34 dots=1 dbond=(13,0)-(14,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.050e+03S Sys:2.791e+00S Total:1.053e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1021:7.790e-03MB:7.607e-06GB
total mem of comb=16706:1.275e-01MB:1.245e-04GB
ctns::topology::check_partition: (sl,sr,sc)=14,5,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 11 12 13 14 15
 suppc= 10
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:28 S:12 H:1 P:66 Q:78 
        dim(bra,ket)=58,58 size(op)=472:3.601e-03MB size(tot)=49386:3.768e-01MB:3.680e-04GB
 rqops: oplist=CSHAB nops=C:10 S:30 H:1 A:45 B:55 
        dim(bra,ket)=42,42 size(op)=270:2.060e-03MB size(tot)=21070:1.608e-01MB:1.570e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=72792:5.554e-01MB:5.423e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(14,0) fdel=./scratch/sweep/lop(13,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
wf3(diml,dimr,dimc)=(58,42,4) nnz=1021:7.790e-03MB
qtensor3: wf3 own=1 _data=0x52c43a10
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=58
 (21,3):11 (21,1):9 (23,3):9 (22,2):9 (20,2):8 (22,4):5 (19,1):3 (23,1):3 (23,5):1
 qbond: qcol nsym=8 dimAll=42
 (6,-2):8 (8,-2):8 (7,-3):8 (7,-1):6 (5,-3):4 (6,-4):4 (9,-1):3 (5,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=22 nblocks=288 size=1021:7.790e-03MB
### DIAG TIMING: total=1.191e-03 t1=1.182e-05, t2=1.318e-05, t3=2.611e-05, t4=1.117e-03, t5=6.032e-06, t6=1.378e-05, t7=3.451e-06
duration_diagGPU:1.202e-03
duration_diagreduce:3.100e-08
duration_diagtransform:3.742e-06
----- TIMING FOR symbolic_formulae_onedot with size=607 : 1.152e-02 S -----
rank=0 GPUmem(GB): used=0.000542 (oper)=0.000542
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=607
 no. of hintermediate operators=280
 no. of coefficients=3920:0.0299MB:2.92e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.355e-04 S -----
rank=0 GPUmem(GB): used=0.000572 (oper,hinter)=0.000542,2.92e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00938 S size(H_formulae)=607 size(Hxlst2)=22 T(Hmu/Hxlist)=0.00134,0.00804 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0101 S size(H_formulae)=607 size(Hxlst)=8870 -----
rank=0 GPUmem(GB): used=0.0188 (oper,hinter,dvdson,batch)=0.000542,2.92e-05,1.52e-05,0.0182 blksize=88 blksize0=99 batchsize=8870
ctns::pdvdsonSolver_nkr::solve_iter ndim=1021 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.85e-05,0.00017,0.00153,0.000332,0.00208
 ndim=1021:7.61e-06GB t[comm(intra)]=2.35e-05 speed=0.647GB/S t[comm(inter)]=4.96e-06 speed=3.07GB/S
--- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=1.5e-03 t_reduction=3.3e-04 tot=2.0e-03 ---
 sigma[inter] counter=145 t=1.7e-04 per=8.4e+00 cost=5.6e+06 flops=3.3e+10
 sigma[gemm] counter=145 i=0 t=1.3e-06 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=1 t=1.2e-06 per=5.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=2 t=3.8e-04 per=1.9e+01 cost=2.8e+06 flops=7.5e+09
 sigma[gemm] counter=145 i=3 t=3.6e-04 per=1.8e+01 cost=2.8e+06 flops=7.6e+09
 sigma[gemm] counter=145 i=4 t=4.0e-04 per=2.0e+01 cost=3.0e+06 flops=7.4e+09
 sigma[gemm] counter=145 i=5 t=3.8e-04 per=1.9e+01 cost=2.9e+06 flops=7.7e+09
 sigma[gemm] counter=145 total t=1.5e-03 per=7.5e+01 cost=1.2e+07 flops=7.5e+09
 sigma[red] counter=145 t=3.3e-04 per=1.6e+01 cost=9.0e+05 flops=2.7e+09
--- TIMING FOR sigma_tot : t_inter=5.7e-02 t_gemm=6.4e-01 t_reduction=9.5e-02 tot=7.9e-01 ---
 sigma_tot[inter] counter=145 t=5.7e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=145 i=0 t=3.0e-04 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=1 t=2.4e-04 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=2 t=1.6e-01 per=2.1e+01 cost=9.5e+08 flops=5.8e+09
 sigma_tot[gemm] counter=145 i=3 t=1.6e-01 per=2.0e+01 cost=9.4e+08 flops=5.8e+09
 sigma_tot[gemm] counter=145 i=4 t=1.6e-01 per=2.0e+01 cost=7.9e+08 flops=4.9e+09
 sigma_tot[gemm] counter=145 i=5 t=1.5e-01 per=1.9e+01 cost=8.1e+08 flops=5.3e+09
 sigma_tot[gemm] counter=145 total t=6.4e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=145 t=9.5e-02 per=1.2e+01 cost=2.3e+08 flops=2.4e+09
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,4.2e-06,1.7e-06,1.8e-06,4.7e-07
settings: ndim=1021 neig=1 maxcycle=30 nbuff=4 memory=0.0001GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.542005052969 -1.117e+03  4.985e-03    1     1  2.195e-03 2.195e-03 2.167e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=5.164e-05,1.975e-04,1.747e-03,3.714e-04,2.379e-03
 ndim=1021:7.607e-06GB t[comm(intra)]=2.141e-05 speed=7.107e-01GB/S t[comm(inter)]=3.024e-05 speed=5.032e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=1.7e-03 t_reduction=3.7e-04 tot=2.3e-03 ---
 sigma[inter] counter=146 t=2.0e-04 per=8.5e+00 cost=5.6e+06 flops=2.9e+10
 sigma[gemm] counter=146 i=0 t=1.7e-06 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=1 t=1.5e-06 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=2 t=4.7e-04 per=2.0e+01 cost=2.8e+06 flops=6.0e+09
 sigma[gemm] counter=146 i=3 t=3.9e-04 per=1.7e+01 cost=2.8e+06 flops=7.1e+09
 sigma[gemm] counter=146 i=4 t=4.6e-04 per=2.0e+01 cost=3.0e+06 flops=6.5e+09
 sigma[gemm] counter=146 i=5 t=4.2e-04 per=1.8e+01 cost=2.9e+06 flops=7.0e+09
 sigma[gemm] counter=146 total t=1.7e-03 per=7.5e+01 cost=1.2e+07 flops=6.6e+09
 sigma[red] counter=146 t=3.7e-04 per=1.6e+01 cost=9.0e+05 flops=2.4e+09
--- TIMING FOR sigma_tot : t_inter=5.7e-02 t_gemm=6.4e-01 t_reduction=9.5e-02 tot=7.9e-01 ---
 sigma_tot[inter] counter=146 t=5.7e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=146 i=0 t=3.0e-04 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=1 t=2.4e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=2 t=1.6e-01 per=2.1e+01 cost=9.6e+08 flops=5.8e+09
 sigma_tot[gemm] counter=146 i=3 t=1.6e-01 per=2.0e+01 cost=9.4e+08 flops=5.8e+09
 sigma_tot[gemm] counter=146 i=4 t=1.6e-01 per=2.0e+01 cost=8.0e+08 flops=4.9e+09
 sigma_tot[gemm] counter=146 i=5 t=1.5e-01 per=1.9e+01 cost=8.1e+08 flops=5.3e+09
 sigma_tot[gemm] counter=146 total t=6.4e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=146 t=9.5e-02 per=1.2e+01 cost=2.3e+08 flops=2.4e+09
T(sub)=4.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.0e-05,1.2e-05,3.6e-06,1.4e-05,7.3e-07
    2   0 -    -116.542037098073 -3.205e-05  1.699e-03    2     2  1.065e-02 5.323e-03 2.324e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.681e-05,2.365e-04,2.061e-03,4.448e-04,2.780e-03
 ndim=1021:7.607e-06GB t[comm(intra)]=2.169e-05 speed=7.014e-01GB/S t[comm(inter)]=5.115e-06 speed=2.974e+00GB/S
--- TIMING FOR sigma : t_inter=2.4e-04 t_gemm=2.1e-03 t_reduction=4.4e-04 tot=2.7e-03 ---
 sigma[inter] counter=147 t=2.4e-04 per=8.6e+00 cost=5.6e+06 flops=2.4e+10
 sigma[gemm] counter=147 i=0 t=1.9e-06 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=1 t=1.7e-06 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=2 t=5.3e-04 per=1.9e+01 cost=2.8e+06 flops=5.3e+09
 sigma[gemm] counter=147 i=3 t=4.8e-04 per=1.8e+01 cost=2.8e+06 flops=5.7e+09
 sigma[gemm] counter=147 i=4 t=5.2e-04 per=1.9e+01 cost=3.0e+06 flops=5.7e+09
 sigma[gemm] counter=147 i=5 t=5.3e-04 per=1.9e+01 cost=2.9e+06 flops=5.6e+09
 sigma[gemm] counter=147 total t=2.1e-03 per=7.5e+01 cost=1.2e+07 flops=5.6e+09
 sigma[red] counter=147 t=4.4e-04 per=1.6e+01 cost=9.0e+05 flops=2.0e+09
--- TIMING FOR sigma_tot : t_inter=5.8e-02 t_gemm=6.4e-01 t_reduction=9.6e-02 tot=8.0e-01 ---
 sigma_tot[inter] counter=147 t=5.8e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=147 i=0 t=3.0e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=1 t=2.4e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=2 t=1.6e-01 per=2.1e+01 cost=9.6e+08 flops=5.8e+09
 sigma_tot[gemm] counter=147 i=3 t=1.6e-01 per=2.0e+01 cost=9.4e+08 flops=5.8e+09
 sigma_tot[gemm] counter=147 i=4 t=1.6e-01 per=2.0e+01 cost=8.0e+08 flops=4.9e+09
 sigma_tot[gemm] counter=147 i=5 t=1.6e-01 per=1.9e+01 cost=8.2e+08 flops=5.3e+09
 sigma_tot[gemm] counter=147 total t=6.4e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=147 t=9.6e-02 per=1.2e+01 cost=2.3e+08 flops=2.4e+09
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.6e-05,3.2e-06,1.5e-05,5.5e-07
    3   0 -    -116.542041303054 -4.205e-06  7.189e-04    3     3  1.846e-02 6.154e-03 2.521e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.823e-05,1.995e-04,1.748e-03,3.710e-04,2.369e-03
 ndim=1021:7.607e-06GB t[comm(intra)]=3.229e-05 speed=4.712e-01GB/S t[comm(inter)]=5.943e-06 speed=2.560e+00GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=1.7e-03 t_reduction=3.7e-04 tot=2.3e-03 ---
 sigma[inter] counter=148 t=2.0e-04 per=8.6e+00 cost=5.6e+06 flops=2.8e+10
 sigma[gemm] counter=148 i=0 t=1.8e-06 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=1 t=1.5e-06 per=6.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=2 t=4.7e-04 per=2.0e+01 cost=2.8e+06 flops=6.0e+09
 sigma[gemm] counter=148 i=3 t=4.0e-04 per=1.7e+01 cost=2.8e+06 flops=7.0e+09
 sigma[gemm] counter=148 i=4 t=4.6e-04 per=2.0e+01 cost=3.0e+06 flops=6.4e+09
 sigma[gemm] counter=148 i=5 t=4.2e-04 per=1.8e+01 cost=2.9e+06 flops=7.0e+09
 sigma[gemm] counter=148 total t=1.7e-03 per=7.5e+01 cost=1.2e+07 flops=6.6e+09
 sigma[red] counter=148 t=3.7e-04 per=1.6e+01 cost=9.0e+05 flops=2.4e+09
--- TIMING FOR sigma_tot : t_inter=5.8e-02 t_gemm=6.5e-01 t_reduction=9.6e-02 tot=8.0e-01 ---
 sigma_tot[inter] counter=148 t=5.8e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=148 i=0 t=3.0e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=1 t=2.5e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=2 t=1.6e-01 per=2.1e+01 cost=9.6e+08 flops=5.8e+09
 sigma_tot[gemm] counter=148 i=3 t=1.6e-01 per=2.0e+01 cost=9.5e+08 flops=5.8e+09
 sigma_tot[gemm] counter=148 i=4 t=1.6e-01 per=2.0e+01 cost=8.0e+08 flops=4.9e+09
 sigma_tot[gemm] counter=148 i=5 t=1.6e-01 per=1.9e+01 cost=8.2e+08 flops=5.3e+09
 sigma_tot[gemm] counter=148 total t=6.5e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=148 t=9.6e-02 per=1.2e+01 cost=2.3e+08 flops=2.4e+09
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.5e-05,3.1e-06,1.5e-05,6.1e-07
    4   0 -    -116.542042095995 -7.929e-07  3.248e-04    3     4  3.055e-02 7.638e-03 2.516e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.561e-05,2.662e-04,2.061e-03,4.437e-04,2.806e-03
 ndim=1021:7.607e-06GB t[comm(intra)]=2.098e-05 speed=7.251e-01GB/S t[comm(inter)]=4.627e-06 speed=3.288e+00GB/S
--- TIMING FOR sigma : t_inter=2.7e-04 t_gemm=2.1e-03 t_reduction=4.4e-04 tot=2.8e-03 ---
 sigma[inter] counter=149 t=2.7e-04 per=9.6e+00 cost=5.6e+06 flops=2.1e+10
 sigma[gemm] counter=149 i=0 t=2.0e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=1 t=1.7e-06 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=2 t=5.3e-04 per=1.9e+01 cost=2.8e+06 flops=5.3e+09
 sigma[gemm] counter=149 i=3 t=4.8e-04 per=1.7e+01 cost=2.8e+06 flops=5.7e+09
 sigma[gemm] counter=149 i=4 t=5.2e-04 per=1.9e+01 cost=3.0e+06 flops=5.7e+09
 sigma[gemm] counter=149 i=5 t=5.2e-04 per=1.9e+01 cost=2.9e+06 flops=5.6e+09
 sigma[gemm] counter=149 total t=2.1e-03 per=7.4e+01 cost=1.2e+07 flops=5.6e+09
 sigma[red] counter=149 t=4.4e-04 per=1.6e+01 cost=9.0e+05 flops=2.0e+09
--- TIMING FOR sigma_tot : t_inter=5.8e-02 t_gemm=6.5e-01 t_reduction=9.7e-02 tot=8.0e-01 ---
 sigma_tot[inter] counter=149 t=5.8e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=149 i=0 t=3.0e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=1 t=2.5e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=2 t=1.7e-01 per=2.1e+01 cost=9.6e+08 flops=5.8e+09
 sigma_tot[gemm] counter=149 i=3 t=1.6e-01 per=2.0e+01 cost=9.5e+08 flops=5.8e+09
 sigma_tot[gemm] counter=149 i=4 t=1.6e-01 per=2.0e+01 cost=8.1e+08 flops=4.9e+09
 sigma_tot[gemm] counter=149 i=5 t=1.6e-01 per=1.9e+01 cost=8.2e+08 flops=5.3e+09
 sigma_tot[gemm] counter=149 total t=6.5e-01 per=8.1e+01 cost=3.5e+09 flops=5.5e+09
 sigma_tot[red] counter=149 t=9.7e-02 per=1.2e+01 cost=2.3e+08 flops=2.4e+09
T(sub)=4.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.5e-05,3.2e-06,1.5e-05,5.4e-07
    5   0 -    -116.542042261507 -1.655e-07  1.376e-04    3     5  3.826e-02 7.652e-03 2.599e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=5.666e-05,1.963e-04,1.716e-03,3.854e-04,2.364e-03
 ndim=1021:7.607e-06GB t[comm(intra)]=2.084e-05 speed=7.300e-01GB/S t[comm(inter)]=3.581e-05 speed=4.248e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=1.7e-03 t_reduction=3.9e-04 tot=2.3e-03 ---
 sigma[inter] counter=150 t=2.0e-04 per=8.5e+00 cost=5.6e+06 flops=2.9e+10
 sigma[gemm] counter=150 i=0 t=1.7e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=1 t=1.5e-06 per=6.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=2 t=4.5e-04 per=1.9e+01 cost=2.8e+06 flops=6.3e+09
 sigma[gemm] counter=150 i=3 t=4.1e-04 per=1.8e+01 cost=2.8e+06 flops=6.8e+09
 sigma[gemm] counter=150 i=4 t=4.4e-04 per=1.9e+01 cost=3.0e+06 flops=6.8e+09
 sigma[gemm] counter=150 i=5 t=4.2e-04 per=1.8e+01 cost=2.9e+06 flops=7.1e+09
 sigma[gemm] counter=150 total t=1.7e-03 per=7.5e+01 cost=1.2e+07 flops=6.7e+09
 sigma[red] counter=150 t=3.9e-04 per=1.7e+01 cost=9.0e+05 flops=2.3e+09
--- TIMING FOR sigma_tot : t_inter=5.8e-02 t_gemm=6.5e-01 t_reduction=9.7e-02 tot=8.0e-01 ---
 sigma_tot[inter] counter=150 t=5.8e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=150 i=0 t=3.1e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=1 t=2.5e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=2 t=1.7e-01 per=2.1e+01 cost=9.7e+08 flops=5.8e+09
 sigma_tot[gemm] counter=150 i=3 t=1.6e-01 per=2.0e+01 cost=9.5e+08 flops=5.8e+09
 sigma_tot[gemm] counter=150 i=4 t=1.6e-01 per=2.0e+01 cost=8.1e+08 flops=4.9e+09
 sigma_tot[gemm] counter=150 i=5 t=1.6e-01 per=1.9e+01 cost=8.3e+08 flops=5.3e+09
 sigma_tot[gemm] counter=150 total t=6.5e-01 per=8.1e+01 cost=3.6e+09 flops=5.5e+09
 sigma_tot[red] counter=150 t=9.7e-02 per=1.2e+01 cost=2.3e+08 flops=2.4e+09
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.4e-05,2.9e-06,1.5e-05,4.9e-07
    6   0 +    -116.542042290831 -2.932e-08  5.935e-05    3     6  5.197e-02 8.661e-03 2.577e-03
TIMING FOR Davidson : 5.198e-02  T(cal/comm/rest)=1.546e-02,8.160e-07,3.651e-02
decomposed t_rest=3.651e-02
 T(sub)    =2.342e-04 per=6.415e-01
 T(precond)=3.604e-02 per=9.869e+01
 T(ortho)  =4.651e-05 per=1.274e-01
 T(xcopy)  =6.113e-06 per=1.674e-02
 T(xnrm2)  =4.894e-06 per=1.340e-02
 T(other)  =1.849e-04 per=5.065e-01
optimized energies: isweep=0 ibond=21 dots=1 e[0]=-116.542042290831 nmvp=6
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.056e+03S Sys:2.794e+00S Total:1.058e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=16 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond21.txt
 qbond: qsuper nsym=16 dimAll=168
 (6,-2):13 (8,-2):30 (7,-3):24 (7,-1):15 (5,-3):4 (6,-4):8 (9,-1):17 (5,-1):1 (10,-2):11 (9,-3):16 (8,-4):12 (11,-1):3 (8,0):6 (10,0):3 (6,0):1 (7,-5):4
timing for divide=2.6e-05
timing for compute=3.0e-04
timing for collect=1.8e-05
----- TMING FOR decimation_genbasis(nkr): 3.4e-04 S T(divide/compute/collect)=2.6e-05,3.0e-04,1.8e-05 -----
decimation summary: 168->58 dwt=-2.220e-16 SvN=1.742e+00
 qbond: qkept nsym=9 dimAll=58
 (9,-3):11 (8,-2):9 (7,-3):9 (9,-1):9 (10,-2):8 (8,-4):5 (7,-1):3 (11,-1):3 (7,-5):1
----- TIMING for decimation_row(nkr): 1.063e-03 S T(decim/select/formRot)=4.373e-04,5.739e-04,5.216e-05 -----
----- TIMING FOR onedot_decimation: 1.329e-03 S T(wf/decim)=2.137e-04,1.115e-03 -----
ctns::oper_renorm coord=(14,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:12 S:28 H:1 A:66 B:78 
        dim(bra,ket)=58,58 size(op)=472:3.601e-03MB size(tot)=49386:3.768e-01MB:3.680e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.056e+03S Sys:2.795e+00S Total:1.059e+03S
----- TIMING FOR symbolic_formulae_renorm with size=185 : 7.534e-03 S -----
rank=0 GPUmem(GB): used=0.000572 (oper)=0.000542
rank=0 GPUmem(GB): used=0.000579 (oper,site)(GB)=0.000542,7.61e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=287
 no. of coefficients=4090:0.0312MB:3.05e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.424e-04 S -----
rank=0 GPUmem(GB): used=0.00061 (oper,site,rinter)=0.000542,7.61e-06,3.05e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00599 S size(rtasks)=185 size(Rlst2)=81 T(Rmu/Rlist)=0.00147,0.00452 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00649 S size(rtasks)=185 size(Rlst)=3755 -----
rank=0 GPUmem(GB): used=0.00061 (oper,site,rinter,batch)=0.000542,7.61e-06,3.05e-05,0.00859 blksize=121 blksize0=64 batchsize=3755
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00194,0.0107,0.00411
--- TIMING FOR renorm : t_inter=1.9e-03 t_gemm=1.1e-02 t_reduction=4.1e-03 tot=1.7e-02 ---
 renorm[inter] counter=22 t=1.9e-03 per=1.2e+01 cost=2.2e+06 flops=1.2e+09
 renorm[gemm] counter=22 i=0 t=1.4e-06 per=8.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=1 t=1.1e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=2 t=3.0e-03 per=1.8e+01 cost=9.2e+05 flops=3.1e+08
 renorm[gemm] counter=22 i=3 t=2.9e-03 per=1.7e+01 cost=1.4e+06 flops=4.9e+08
 renorm[gemm] counter=22 i=4 t=1.2e-06 per=6.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=5 t=1.1e-06 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=6 t=4.8e-03 per=2.9e+01 cost=3.1e+06 flops=6.4e+08
 renorm[gemm] counter=22 total t=1.1e-02 per=6.4e+01 cost=5.4e+06 flops=5.1e+08
 renorm[red] counter=22 t=4.1e-03 per=2.5e+01 cost=4.6e+05 flops=1.1e+08
--- TIMING FOR renorm_tot : t_inter=1.9e-02 t_gemm=1.9e-01 t_reduction=5.2e-02 tot=2.6e-01 ---
 renorm_tot[inter] counter=22 t=1.9e-02 per=7.1e+00 cost=6.2e+07 flops=3.3e+09
 renorm_tot[gemm] counter=22 i=0 t=3.2e-05 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=22 i=1 t=2.7e-05 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=22 i=2 t=1.0e-02 per=4.0e+00 cost=1.5e+06 flops=1.4e+08
 renorm_tot[gemm] counter=22 i=3 t=1.0e-02 per=3.9e+00 cost=2.1e+06 flops=2.0e+08
 renorm_tot[gemm] counter=22 i=4 t=4.4e-02 per=1.7e+01 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=22 i=5 t=5.4e-02 per=2.1e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=22 i=6 t=7.3e-02 per=2.8e+01 cost=1.1e+08 flops=1.5e+09
 renorm_tot[gemm] counter=22 total t=1.9e-01 per=7.3e+01 cost=1.9e+08 flops=9.8e+08
 renorm_tot[red] counter=22 t=5.2e-02 per=2.0e+01 cost=1.4e+07 flops=2.6e+08
qops.to_cpu: size(tot)=49386:3.8e-01MB:3.7e-04GB t[to_cpu]=9.2e-05S speed=4.0e+00GB/S
check ||H-H.dagger||=2.377e-14 coord=(14,0) rank=0
ctns::oper_ab2pq coord=(14,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0574 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.056e+03S Sys:2.796e+00S Total:1.059e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1493:1.139e-02MB:1.112e-05GB
total mem of comb=17178:1.311e-01MB:1.280e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.056e+03S Sys:2.797e+00S Total:1.059e+03S
##### local opt: 1.973e-01 S #####
 T(local opt: fetch) = 1.062e-02 S  per = 5.38  per(accum) = 5.38
 T(local opt: hdiag) = 1.265e-03 S  per = 0.641  per(accum) = 6.02
 T(local opt: dvdsn) = 1.241e-01 S  per = 62.9  per(accum) = 68.9
 T(local opt: decim) = 1.337e-03 S  per = 0.678  per(accum) = 69.6
 T(local opt: guess) = 2.756e-04 S  per = 0.14  per(accum) = 69.7
 T(local opt: renrm) = 5.801e-02 S  per = 29.4  per(accum) = 99.1
 T(local opt: save ) = 1.682e-03 S  per = 0.853  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.241e-01 S  T(sum) = 1.237e-01 S  per = 9.969e+01
 T(local opt: preprocess                  ) = 3.711e-04 S  per =  0.3  per(accum) = 0.3
 T(local opt: symbolic_formulae           ) = 1.154e-02 S  per = 9.33  per(accum) = 9.63
 T(local opt: hintermediate init          ) = 2.496e-04 S  per = 0.202  per(accum) = 9.83
 T(local opt: preprocess_hformulae_Hxlist ) = 1.035e-02 S  per = 8.36  per(accum) = 18.2
 T(local opt: hmmtasks init               ) = 4.920e-02 S  per = 39.8  per(accum) = 58
 T(local opt: initial guess for dvdson    ) = 7.058e-06 S  per = 0.00571  per(accum) = 58
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.524e-02 S  per = 12.3  per(accum) = 70.3
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.274e-04 S  per = 0.184  per(accum) = 70.5
 T(local opt: dvdson solver [comm(cpu)]   ) = 8.160e-07 S  per = 0.00066  per(accum) = 70.5
 T(local opt: dvdson solver [rest part]   ) = 3.651e-02 S  per = 29.5  per(accum) = 100
Detailed decomposition of T(renrm) = 5.801e-02 S  T(sum) = 5.801e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.833e-04 S  per = 0.316  per(accum) = 0.316
 T(local opt: qops init                    ) = 2.306e-03 S  per = 3.97  per(accum) = 4.29
 T(local opt: symbolic_formulae_renorm     ) = 7.547e-03 S  per =   13  per(accum) = 17.3
 T(local opt: allocate qops on gpu         ) = 2.863e-05 S  per = 0.0493  per(accum) = 17.3
 T(local opt: site memcpy cpu2gpu          ) = 2.021e-05 S  per = 0.0348  per(accum) = 17.4
 T(local opt: rintermediate init           ) = 4.539e-04 S  per = 0.782  per(accum) = 18.2
 T(local opt: preprocess_formulae_Rlist2   ) = 6.619e-03 S  per = 11.4  per(accum) = 29.6
 T(local opt: rmmtasks init                ) = 2.339e-02 S  per = 40.3  per(accum) = 69.9
 T(local opt: qops memset on cpu           ) = 5.800e-08 S  per = 0.0001  per(accum) = 69.9
 T(local opt: preprocess_renorm_batchGPU   ) = 1.682e-02 S  per =   29  per(accum) = 98.9
 T(local opt: reduction of opS & opH [nccl]) = 1.045e-06 S  per = 0.0018  per(accum) = 98.9
 T(local opt: qops memcpy gpu2cpu          ) = 9.824e-05 S  per = 0.169  per(accum) = 99.1
 T(local opt: deallocate cpu and gpu memory) = 9.676e-05 S  per = 0.167  per(accum) = 99.2
 T(local opt: reduction of opS & opH [comm]) = 4.114e-05 S  per = 0.0709  per(accum) = 99.3
 T(local opt: conversion from opAB to opPQ ) = 4.162e-06 S  per = 0.00717  per(accum) = 99.3
 T(local opt: after oper_renorm            ) = 4.085e-04 S  per = 0.704  per(accum) = 100
##### sweep opt: 1.149e+01 S #####
 T(sweep opt: fetch) = 2.951e-01 S  per = 2.57  per(accum) = 2.57
 T(sweep opt: hdiag) = 3.980e-02 S  per = 0.346  per(accum) = 2.91
 T(sweep opt: dvdsn) = 5.174e+00 S  per =   45  per(accum) = 47.9
 T(sweep opt: decim) = 2.501e-02 S  per = 0.218  per(accum) = 48.1
 T(sweep opt: guess) = 6.273e-03 S  per = 0.0546  per(accum) = 48.2
 T(sweep opt: renrm) = 5.902e+00 S  per = 51.4  per(accum) = 99.5
 T(sweep opt: save ) = 5.190e-02 S  per = 0.452  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.174e+00 S  T(sum) = 4.718e+00 S  per = 9.118e+01
 T(sweep opt: preprocess                  ) = 1.007e-02 S  per = 0.214  per(accum) = 0.214
 T(sweep opt: symbolic_formulae           ) = 2.889e-01 S  per = 6.12  per(accum) = 6.34
 T(sweep opt: hintermediate init          ) = 6.659e-03 S  per = 0.141  per(accum) = 6.48
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.202e-01 S  per = 6.79  per(accum) = 13.3
 T(sweep opt: hmmtasks init               ) = 2.088e+00 S  per = 44.3  per(accum) = 57.5
 T(sweep opt: initial guess for dvdson    ) = 1.671e-04 S  per = 0.00354  per(accum) = 57.5
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 8.349e-01 S  per = 17.7  per(accum) = 75.2
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 5.058e-03 S  per = 0.107  per(accum) = 75.3
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.961e-05 S  per = 0.000416  per(accum) = 75.3
 T(sweep opt: dvdson solver [rest part]   ) = 1.164e+00 S  per = 24.7  per(accum) = 100
Detailed decomposition of T(renrm) = 5.902e+00 S  T(sum) = 5.902e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.316e-03 S  per = 0.124  per(accum) = 0.124
 T(sweep opt: qops init                    ) = 6.980e-02 S  per = 1.18  per(accum) = 1.31
 T(sweep opt: symbolic_formulae_renorm     ) = 2.438e-01 S  per = 4.13  per(accum) = 5.44
 T(sweep opt: allocate qops on gpu         ) = 1.427e-03 S  per = 0.0242  per(accum) = 5.46
 T(sweep opt: site memcpy cpu2gpu          ) = 4.904e-04 S  per = 0.00831  per(accum) = 5.47
 T(sweep opt: rintermediate init           ) = 1.071e-02 S  per = 0.182  per(accum) = 5.65
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.073e-01 S  per = 3.51  per(accum) = 9.16
 T(sweep opt: rmmtasks init                ) = 8.040e-01 S  per = 13.6  per(accum) = 22.8
 T(sweep opt: qops memset on cpu           ) = 1.152e-06 S  per = 1.95e-05  per(accum) = 22.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.647e-01 S  per = 4.49  per(accum) = 27.3
 T(sweep opt: reduction of opS & opH [nccl]) = 2.329e-05 S  per = 0.000395  per(accum) = 27.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.608e-03 S  per = 0.0442  per(accum) = 27.3
 T(sweep opt: deallocate cpu and gpu memory) = 4.562e-01 S  per = 7.73  per(accum) = 35
 T(sweep opt: reduction of opS & opH [comm]) = 1.021e-03 S  per = 0.0173  per(accum) = 35.1
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 64.7  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 1.361e-02 S  per = 0.231  per(accum) = 100
##### global opt: 1.149e+01 S #####
 T(global opt: fetch) = 2.951e-01 S  per = 2.57  per(accum) = 2.57
 T(global opt: hdiag) = 3.980e-02 S  per = 0.346  per(accum) = 2.91
 T(global opt: dvdsn) = 5.174e+00 S  per =   45  per(accum) = 47.9
 T(global opt: decim) = 2.501e-02 S  per = 0.218  per(accum) = 48.1
 T(global opt: guess) = 6.273e-03 S  per = 0.0546  per(accum) = 48.2
 T(global opt: renrm) = 5.902e+00 S  per = 51.4  per(accum) = 99.5
 T(global opt: save ) = 5.190e-02 S  per = 0.452  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.174e+00 S  T(sum) = 4.718e+00 S  per = 9.118e+01
 T(global opt: preprocess                  ) = 1.007e-02 S  per = 0.214  per(accum) = 0.214
 T(global opt: symbolic_formulae           ) = 2.889e-01 S  per = 6.12  per(accum) = 6.34
 T(global opt: hintermediate init          ) = 6.659e-03 S  per = 0.141  per(accum) = 6.48
 T(global opt: preprocess_hformulae_Hxlist ) = 3.202e-01 S  per = 6.79  per(accum) = 13.3
 T(global opt: hmmtasks init               ) = 2.088e+00 S  per = 44.3  per(accum) = 57.5
 T(global opt: initial guess for dvdson    ) = 1.671e-04 S  per = 0.00354  per(accum) = 57.5
 T(global opt: dvdson solver [Hx_batchGPU] ) = 8.349e-01 S  per = 17.7  per(accum) = 75.2
 T(global opt: dvdson solver [comm(gpu)]   ) = 5.058e-03 S  per = 0.107  per(accum) = 75.3
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.961e-05 S  per = 0.000416  per(accum) = 75.3
 T(global opt: dvdson solver [rest part]   ) = 1.164e+00 S  per = 24.7  per(accum) = 100
Detailed decomposition of T(renrm) = 5.902e+00 S  T(sum) = 5.902e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.316e-03 S  per = 0.124  per(accum) = 0.124
 T(global opt: qops init                    ) = 6.980e-02 S  per = 1.18  per(accum) = 1.31
 T(global opt: symbolic_formulae_renorm     ) = 2.438e-01 S  per = 4.13  per(accum) = 5.44
 T(global opt: allocate qops on gpu         ) = 1.427e-03 S  per = 0.0242  per(accum) = 5.46
 T(global opt: site memcpy cpu2gpu          ) = 4.904e-04 S  per = 0.00831  per(accum) = 5.47
 T(global opt: rintermediate init           ) = 1.071e-02 S  per = 0.182  per(accum) = 5.65
 T(global opt: preprocess_formulae_Rlist2   ) = 2.073e-01 S  per = 3.51  per(accum) = 9.16
 T(global opt: rmmtasks init                ) = 8.040e-01 S  per = 13.6  per(accum) = 22.8
 T(global opt: qops memset on cpu           ) = 1.152e-06 S  per = 1.95e-05  per(accum) = 22.8
 T(global opt: preprocess_renorm_batchGPU   ) = 2.647e-01 S  per = 4.49  per(accum) = 27.3
 T(global opt: reduction of opS & opH [nccl]) = 2.329e-05 S  per = 0.000395  per(accum) = 27.3
 T(global opt: qops memcpy gpu2cpu          ) = 2.608e-03 S  per = 0.0442  per(accum) = 27.3
 T(global opt: deallocate cpu and gpu memory) = 4.562e-01 S  per = 7.73  per(accum) = 35
 T(global opt: reduction of opS & opH [comm]) = 1.021e-03 S  per = 0.0173  per(accum) = 35.1
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 64.7  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 1.361e-02 S  per = 0.231  per(accum) = 100

isweep=0 ibond=22/seqsize=34 dots=1 dbond=(12,0)-(13,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.056e+03S Sys:2.797e+00S Total:1.059e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1493:1.139e-02MB:1.112e-05GB
total mem of comb=17178:1.311e-01MB:1.280e-04GB
ctns::topology::check_partition: (sl,sr,sc)=13,6,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc= 9
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:26 S:14 H:1 P:91 Q:105 
        dim(bra,ket)=68,68 size(op)=652:4.974e-03MB size(tot)=87673:6.689e-01MB:6.532e-04GB
 rqops: oplist=CSHAB nops=C:12 S:28 H:1 A:66 B:78 
        dim(bra,ket)=58,58 size(op)=472:3.601e-03MB size(tot)=49386:3.768e-01MB:3.680e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=139395:1.063e+00MB:1.039e-03GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(13,0) fdel=./scratch/sweep/lop(12,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
wf3(diml,dimr,dimc)=(68,58,4) nnz=1493:1.139e-02MB
qtensor3: wf3 own=1 _data=0x52921610
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=68
 (19,3):14 (19,1):12 (21,3):10 (20,2):9 (18,2):7 (21,1):6 (20,4):6 (17,1):3 (21,5):1
 qbond: qcol nsym=9 dimAll=58
 (9,-3):11 (8,-2):9 (7,-3):9 (9,-1):9 (10,-2):8 (8,-4):5 (7,-1):3 (11,-1):3 (7,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=23 nblocks=324 size=1493:1.139e-02MB
### DIAG TIMING: total=1.654e-03 t1=1.258e-05, t2=1.253e-05, t3=2.705e-05, t4=1.578e-03, t5=5.825e-06, t6=1.449e-05, t7=3.307e-06
duration_diagGPU:1.664e-03
duration_diagreduce:3.300e-08
duration_diagtransform:5.318e-06
----- TIMING FOR symbolic_formulae_onedot with size=813 : 1.487e-02 S -----
rank=0 GPUmem(GB): used=0.00104 (oper)=0.00104
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=813
 no. of hintermediate operators=390
 no. of coefficients=5070:0.0387MB:3.78e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.091e-04 S -----
rank=0 GPUmem(GB): used=0.00108 (oper,hinter)=0.00104,3.78e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0127 S size(H_formulae)=813 size(Hxlst2)=23 T(Hmu/Hxlist)=0.00183,0.0108 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0141 S size(H_formulae)=813 size(Hxlst)=12102 -----
rank=0 GPUmem(GB): used=0.0403 (oper,hinter,dvdson,batch)=0.00104,3.78e-05,2.22e-05,0.0392 blksize=154 blksize0=126 batchsize=12102
ctns::pdvdsonSolver_nkr::solve_iter ndim=1493 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.93e-05,0.000218,0.00258,0.000388,0.00324
 ndim=1493:1.11e-05GB t[comm(intra)]=2.41e-05 speed=0.924GB/S t[comm(inter)]=5.19e-06 speed=4.28GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=2.6e-03 t_reduction=3.9e-04 tot=3.2e-03 ---
 sigma[inter] counter=151 t=2.2e-04 per=6.8e+00 cost=9.3e+06 flops=4.3e+10
 sigma[gemm] counter=151 i=0 t=1.5e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=1 t=1.2e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=2 t=6.6e-04 per=2.1e+01 cost=6.9e+06 flops=1.0e+10
 sigma[gemm] counter=151 i=3 t=6.2e-04 per=2.0e+01 cost=6.7e+06 flops=1.1e+10
 sigma[gemm] counter=151 i=4 t=6.7e-04 per=2.1e+01 cost=6.3e+06 flops=9.5e+09
 sigma[gemm] counter=151 i=5 t=6.2e-04 per=2.0e+01 cost=6.4e+06 flops=1.0e+10
 sigma[gemm] counter=151 total t=2.6e-03 per=8.1e+01 cost=2.6e+07 flops=1.0e+10
 sigma[red] counter=151 t=3.9e-04 per=1.2e+01 cost=1.7e+06 flops=4.4e+09
--- TIMING FOR sigma_tot : t_inter=5.8e-02 t_gemm=6.5e-01 t_reduction=9.7e-02 tot=8.1e-01 ---
 sigma_tot[inter] counter=151 t=5.8e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=151 i=0 t=3.1e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=1 t=2.5e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=2 t=1.7e-01 per=2.1e+01 cost=9.7e+08 flops=5.9e+09
 sigma_tot[gemm] counter=151 i=3 t=1.6e-01 per=2.0e+01 cost=9.6e+08 flops=5.9e+09
 sigma_tot[gemm] counter=151 i=4 t=1.7e-01 per=2.0e+01 cost=8.2e+08 flops=4.9e+09
 sigma_tot[gemm] counter=151 i=5 t=1.6e-01 per=1.9e+01 cost=8.3e+08 flops=5.3e+09
 sigma_tot[gemm] counter=151 total t=6.5e-01 per=8.1e+01 cost=3.6e+09 flops=5.5e+09
 sigma_tot[red] counter=151 t=9.7e-02 per=1.2e+01 cost=2.4e+08 flops=2.4e+09
T(sub)=1.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,4.3e-06,1.7e-06,2.1e-06,7.0e-07
settings: ndim=1493 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.542042290831 -1.117e+03  8.691e-03    1     1  3.364e-03 3.364e-03 3.333e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.937e-05,3.033e-04,3.400e-03,5.442e-04,4.297e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=3.368e-05 speed=6.605e-01GB/S t[comm(inter)]=5.687e-06 speed=3.912e+00GB/S
--- TIMING FOR sigma : t_inter=3.0e-04 t_gemm=3.4e-03 t_reduction=5.4e-04 tot=4.2e-03 ---
 sigma[inter] counter=152 t=3.0e-04 per=7.1e+00 cost=9.3e+06 flops=3.1e+10
 sigma[gemm] counter=152 i=0 t=1.9e-06 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=1 t=1.7e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=2 t=8.8e-04 per=2.1e+01 cost=6.9e+06 flops=7.9e+09
 sigma[gemm] counter=152 i=3 t=8.0e-04 per=1.9e+01 cost=6.7e+06 flops=8.4e+09
 sigma[gemm] counter=152 i=4 t=9.0e-04 per=2.1e+01 cost=6.3e+06 flops=7.1e+09
 sigma[gemm] counter=152 i=5 t=8.2e-04 per=1.9e+01 cost=6.4e+06 flops=7.8e+09
 sigma[gemm] counter=152 total t=3.4e-03 per=8.0e+01 cost=2.6e+07 flops=7.8e+09
 sigma[red] counter=152 t=5.4e-04 per=1.3e+01 cost=1.7e+06 flops=3.2e+09
--- TIMING FOR sigma_tot : t_inter=5.9e-02 t_gemm=6.6e-01 t_reduction=9.8e-02 tot=8.1e-01 ---
 sigma_tot[inter] counter=152 t=5.9e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=152 i=0 t=3.1e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=1 t=2.5e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=2 t=1.7e-01 per=2.1e+01 cost=9.8e+08 flops=5.9e+09
 sigma_tot[gemm] counter=152 i=3 t=1.6e-01 per=2.0e+01 cost=9.7e+08 flops=5.9e+09
 sigma_tot[gemm] counter=152 i=4 t=1.7e-01 per=2.0e+01 cost=8.2e+08 flops=5.0e+09
 sigma_tot[gemm] counter=152 i=5 t=1.6e-01 per=1.9e+01 cost=8.4e+08 flops=5.3e+09
 sigma_tot[gemm] counter=152 total t=6.6e-01 per=8.1e+01 cost=3.6e+09 flops=5.5e+09
 sigma_tot[red] counter=152 t=9.8e-02 per=1.2e+01 cost=2.4e+08 flops=2.4e+09
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.3e-05,1.4e-05,5.1e-06,8.2e-07
    2   0 -    -116.542133862596 -9.157e-05  2.551e-03    2     2  1.264e-02 6.322e-03 3.877e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.800e-05,2.798e-04,3.389e-03,5.158e-04,4.231e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=3.320e-05 speed=6.701e-01GB/S t[comm(inter)]=4.796e-06 speed=4.639e+00GB/S
--- TIMING FOR sigma : t_inter=2.8e-04 t_gemm=3.4e-03 t_reduction=5.2e-04 tot=4.2e-03 ---
 sigma[inter] counter=153 t=2.8e-04 per=6.7e+00 cost=9.3e+06 flops=3.3e+10
 sigma[gemm] counter=153 i=0 t=1.9e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=1 t=1.7e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=2 t=8.7e-04 per=2.1e+01 cost=6.9e+06 flops=7.9e+09
 sigma[gemm] counter=153 i=3 t=8.1e-04 per=1.9e+01 cost=6.7e+06 flops=8.3e+09
 sigma[gemm] counter=153 i=4 t=8.8e-04 per=2.1e+01 cost=6.3e+06 flops=7.2e+09
 sigma[gemm] counter=153 i=5 t=8.2e-04 per=2.0e+01 cost=6.4e+06 flops=7.8e+09
 sigma[gemm] counter=153 total t=3.4e-03 per=8.1e+01 cost=2.6e+07 flops=7.8e+09
 sigma[red] counter=153 t=5.2e-04 per=1.2e+01 cost=1.7e+06 flops=3.3e+09
--- TIMING FOR sigma_tot : t_inter=5.9e-02 t_gemm=6.6e-01 t_reduction=9.8e-02 tot=8.2e-01 ---
 sigma_tot[inter] counter=153 t=5.9e-02 per=7.2e+00 cost=1.1e+09 flops=1.9e+10
 sigma_tot[gemm] counter=153 i=0 t=3.1e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=1 t=2.5e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=2 t=1.7e-01 per=2.1e+01 cost=9.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=153 i=3 t=1.7e-01 per=2.0e+01 cost=9.7e+08 flops=5.9e+09
 sigma_tot[gemm] counter=153 i=4 t=1.7e-01 per=2.0e+01 cost=8.3e+08 flops=5.0e+09
 sigma_tot[gemm] counter=153 i=5 t=1.6e-01 per=1.9e+01 cost=8.4e+08 flops=5.3e+09
 sigma_tot[gemm] counter=153 total t=6.6e-01 per=8.1e+01 cost=3.6e+09 flops=5.5e+09
 sigma_tot[red] counter=153 t=9.8e-02 per=1.2e+01 cost=2.4e+08 flops=2.4e+09
T(sub)=5.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,2.6e-05,3.6e-06,7.6e-06,7.2e-07
    3   0 -    -116.542144321140 -1.046e-05  1.255e-03    3     3  2.222e-02 7.407e-03 4.038e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.787e-05,2.810e-04,3.358e-03,5.533e-04,4.239e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=2.290e-05 speed=9.715e-01GB/S t[comm(inter)]=1.497e-05 speed=1.486e+00GB/S
--- TIMING FOR sigma : t_inter=2.8e-04 t_gemm=3.4e-03 t_reduction=5.5e-04 tot=4.2e-03 ---
 sigma[inter] counter=154 t=2.8e-04 per=6.7e+00 cost=9.3e+06 flops=3.3e+10
 sigma[gemm] counter=154 i=0 t=1.9e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=1 t=1.8e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=2 t=8.6e-04 per=2.1e+01 cost=6.9e+06 flops=8.0e+09
 sigma[gemm] counter=154 i=3 t=8.1e-04 per=1.9e+01 cost=6.7e+06 flops=8.3e+09
 sigma[gemm] counter=154 i=4 t=8.7e-04 per=2.1e+01 cost=6.3e+06 flops=7.3e+09
 sigma[gemm] counter=154 i=5 t=8.0e-04 per=1.9e+01 cost=6.4e+06 flops=8.0e+09
 sigma[gemm] counter=154 total t=3.4e-03 per=8.0e+01 cost=2.6e+07 flops=7.8e+09
 sigma[red] counter=154 t=5.5e-04 per=1.3e+01 cost=1.7e+06 flops=3.1e+09
--- TIMING FOR sigma_tot : t_inter=5.9e-02 t_gemm=6.6e-01 t_reduction=9.9e-02 tot=8.2e-01 ---
 sigma_tot[inter] counter=154 t=5.9e-02 per=7.2e+00 cost=1.2e+09 flops=1.9e+10
 sigma_tot[gemm] counter=154 i=0 t=3.1e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=1 t=2.6e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=2 t=1.7e-01 per=2.1e+01 cost=9.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=154 i=3 t=1.7e-01 per=2.0e+01 cost=9.8e+08 flops=5.9e+09
 sigma_tot[gemm] counter=154 i=4 t=1.7e-01 per=2.0e+01 cost=8.3e+08 flops=5.0e+09
 sigma_tot[gemm] counter=154 i=5 t=1.6e-01 per=1.9e+01 cost=8.5e+08 flops=5.3e+09
 sigma_tot[gemm] counter=154 total t=6.6e-01 per=8.1e+01 cost=3.7e+09 flops=5.5e+09
 sigma_tot[red] counter=154 t=9.9e-02 per=1.2e+01 cost=2.4e+08 flops=2.4e+09
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.5e-05,1.3e-05,7.5e-06,7.1e-07
    4   0 -    -116.542147146467 -2.825e-06  6.295e-04    3     4  3.186e-02 7.966e-03 4.119e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.863e-05,2.926e-04,3.381e-03,5.777e-04,4.300e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=3.362e-05 speed=6.618e-01GB/S t[comm(inter)]=5.011e-06 speed=4.440e+00GB/S
--- TIMING FOR sigma : t_inter=2.9e-04 t_gemm=3.4e-03 t_reduction=5.8e-04 tot=4.2e-03 ---
 sigma[inter] counter=155 t=2.9e-04 per=6.9e+00 cost=9.3e+06 flops=3.2e+10
 sigma[gemm] counter=155 i=0 t=1.9e-06 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=1 t=1.7e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=2 t=8.7e-04 per=2.1e+01 cost=6.9e+06 flops=7.9e+09
 sigma[gemm] counter=155 i=3 t=8.0e-04 per=1.9e+01 cost=6.7e+06 flops=8.4e+09
 sigma[gemm] counter=155 i=4 t=8.8e-04 per=2.1e+01 cost=6.3e+06 flops=7.2e+09
 sigma[gemm] counter=155 i=5 t=8.2e-04 per=1.9e+01 cost=6.4e+06 flops=7.8e+09
 sigma[gemm] counter=155 total t=3.4e-03 per=8.0e+01 cost=2.6e+07 flops=7.8e+09
 sigma[red] counter=155 t=5.8e-04 per=1.4e+01 cost=1.7e+06 flops=3.0e+09
--- TIMING FOR sigma_tot : t_inter=6.0e-02 t_gemm=6.7e-01 t_reduction=9.9e-02 tot=8.2e-01 ---
 sigma_tot[inter] counter=155 t=6.0e-02 per=7.2e+00 cost=1.2e+09 flops=2.0e+10
 sigma_tot[gemm] counter=155 i=0 t=3.1e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=1 t=2.6e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=2 t=1.7e-01 per=2.1e+01 cost=1.0e+09 flops=5.9e+09
 sigma_tot[gemm] counter=155 i=3 t=1.7e-01 per=2.0e+01 cost=9.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=155 i=4 t=1.7e-01 per=2.0e+01 cost=8.4e+08 flops=5.0e+09
 sigma_tot[gemm] counter=155 i=5 t=1.6e-01 per=1.9e+01 cost=8.6e+08 flops=5.3e+09
 sigma_tot[gemm] counter=155 total t=6.7e-01 per=8.1e+01 cost=3.7e+09 flops=5.5e+09
 sigma_tot[red] counter=155 t=9.9e-02 per=1.2e+01 cost=2.4e+08 flops=2.4e+09
T(sub)=5.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.6e-05,1.6e-05,1.3e-05,7.4e-06,7.5e-07
    5   0 -    -116.542147836330 -6.899e-07  3.031e-04    3     5  4.161e-02 8.323e-03 4.181e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.891e-05,2.848e-04,3.369e-03,5.213e-04,4.225e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=3.344e-05 speed=6.654e-01GB/S t[comm(inter)]=5.471e-06 speed=4.066e+00GB/S
--- TIMING FOR sigma : t_inter=2.8e-04 t_gemm=3.4e-03 t_reduction=5.2e-04 tot=4.2e-03 ---
 sigma[inter] counter=156 t=2.8e-04 per=6.8e+00 cost=9.3e+06 flops=3.3e+10
 sigma[gemm] counter=156 i=0 t=2.0e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=1 t=1.8e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=2 t=8.6e-04 per=2.1e+01 cost=6.9e+06 flops=8.0e+09
 sigma[gemm] counter=156 i=3 t=8.1e-04 per=1.9e+01 cost=6.7e+06 flops=8.3e+09
 sigma[gemm] counter=156 i=4 t=8.7e-04 per=2.1e+01 cost=6.3e+06 flops=7.3e+09
 sigma[gemm] counter=156 i=5 t=8.2e-04 per=2.0e+01 cost=6.4e+06 flops=7.8e+09
 sigma[gemm] counter=156 total t=3.4e-03 per=8.1e+01 cost=2.6e+07 flops=7.8e+09
 sigma[red] counter=156 t=5.2e-04 per=1.2e+01 cost=1.7e+06 flops=3.3e+09
--- TIMING FOR sigma_tot : t_inter=6.0e-02 t_gemm=6.7e-01 t_reduction=1.0e-01 tot=8.3e-01 ---
 sigma_tot[inter] counter=156 t=6.0e-02 per=7.2e+00 cost=1.2e+09 flops=2.0e+10
 sigma_tot[gemm] counter=156 i=0 t=3.2e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=1 t=2.6e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=2 t=1.7e-01 per=2.1e+01 cost=1.0e+09 flops=5.9e+09
 sigma_tot[gemm] counter=156 i=3 t=1.7e-01 per=2.0e+01 cost=9.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=156 i=4 t=1.7e-01 per=2.0e+01 cost=8.5e+08 flops=5.0e+09
 sigma_tot[gemm] counter=156 i=5 t=1.6e-01 per=1.9e+01 cost=8.6e+08 flops=5.4e+09
 sigma_tot[gemm] counter=156 total t=6.7e-01 per=8.1e+01 cost=3.7e+09 flops=5.5e+09
 sigma_tot[red] counter=156 t=1.0e-01 per=1.2e+01 cost=2.4e+08 flops=2.4e+09
T(sub)=5.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.6e-05,2.6e-05,3.8e-06,7.5e-06,7.2e-07
    6   0 -    -116.542147994685 -1.584e-07  1.436e-04    3     6  5.120e-02 8.533e-03 4.209e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.815e-05,2.808e-04,3.366e-03,5.429e-04,4.237e-03
 ndim=1493:1.112e-05GB t[comm(intra)]=3.336e-05 speed=6.669e-01GB/S t[comm(inter)]=4.796e-06 speed=4.639e+00GB/S
--- TIMING FOR sigma : t_inter=2.8e-04 t_gemm=3.4e-03 t_reduction=5.4e-04 tot=4.2e-03 ---
 sigma[inter] counter=157 t=2.8e-04 per=6.7e+00 cost=9.3e+06 flops=3.3e+10
 sigma[gemm] counter=157 i=0 t=1.9e-06 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=1 t=1.7e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=2 t=8.7e-04 per=2.1e+01 cost=6.9e+06 flops=7.9e+09
 sigma[gemm] counter=157 i=3 t=8.2e-04 per=2.0e+01 cost=6.7e+06 flops=8.2e+09
 sigma[gemm] counter=157 i=4 t=8.8e-04 per=2.1e+01 cost=6.3e+06 flops=7.2e+09
 sigma[gemm] counter=157 i=5 t=7.9e-04 per=1.9e+01 cost=6.4e+06 flops=8.0e+09
 sigma[gemm] counter=157 total t=3.4e-03 per=8.0e+01 cost=2.6e+07 flops=7.8e+09
 sigma[red] counter=157 t=5.4e-04 per=1.3e+01 cost=1.7e+06 flops=3.2e+09
--- TIMING FOR sigma_tot : t_inter=6.0e-02 t_gemm=6.7e-01 t_reduction=1.0e-01 tot=8.3e-01 ---
 sigma_tot[inter] counter=157 t=6.0e-02 per=7.2e+00 cost=1.2e+09 flops=2.0e+10
 sigma_tot[gemm] counter=157 i=0 t=3.2e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=1 t=2.6e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=2 t=1.7e-01 per=2.1e+01 cost=1.0e+09 flops=5.9e+09
 sigma_tot[gemm] counter=157 i=3 t=1.7e-01 per=2.0e+01 cost=1.0e+09 flops=5.9e+09
 sigma_tot[gemm] counter=157 i=4 t=1.7e-01 per=2.0e+01 cost=8.5e+08 flops=5.0e+09
 sigma_tot[gemm] counter=157 i=5 t=1.6e-01 per=1.9e+01 cost=8.7e+08 flops=5.4e+09
 sigma_tot[gemm] counter=157 total t=6.7e-01 per=8.1e+01 cost=3.7e+09 flops=5.6e+09
 sigma_tot[red] counter=157 t=1.0e-01 per=1.2e+01 cost=2.5e+08 flops=2.4e+09
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.5e-05,1.3e-05,7.5e-06,7.2e-07
    7   0 +    -116.542148034411 -3.973e-08  8.297e-05    3     7  6.082e-02 8.689e-03 4.231e-03
TIMING FOR Davidson : 6.085e-02  T(cal/comm/rest)=2.962e-02,8.010e-07,3.123e-02
decomposed t_rest=3.123e-02
 T(sub)    =3.233e-04 per=1.035e+00
 T(precond)=3.060e-02 per=9.798e+01
 T(ortho)  =7.246e-05 per=2.320e-01
 T(xcopy)  =1.757e-05 per=5.627e-02
 T(xnrm2)  =8.133e-06 per=2.604e-02
 T(other)  =2.083e-04 per=6.670e-01
optimized energies: isweep=0 ibond=22 dots=1 e[0]=-116.542148034411 nmvp=7
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.063e+03S Sys:2.797e+00S Total:1.065e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond22.txt
 qbond: qsuper nsym=18 dimAll=232
 (9,-3):34 (8,-2):21 (7,-3):9 (9,-1):21 (10,-2):37 (8,-4):15 (7,-1):3 (11,-1):20 (7,-5):1 (11,-3):19 (12,-2):11 (10,-4):16 (13,-1):3 (9,-5):6 (10,0):9 (8,0):3 (12,0):3 (8,-6):1
timing for divide=1.5e-05
timing for compute=5.4e-04
timing for collect=4.2e-05
----- TMING FOR decimation_genbasis(nkr): 5.9e-04 S T(divide/compute/collect)=1.5e-05,5.4e-04,4.2e-05 -----
decimation summary: 232->68 dwt=-4.441e-16 SvN=2.038e+00
 qbond: qkept nsym=9 dimAll=68
 (11,-3):14 (11,-1):12 (9,-3):10 (10,-2):9 (12,-2):7 (9,-1):6 (10,-4):6 (13,-1):3 (9,-5):1
----- TIMING for decimation_row(nkr): 1.413e-03 S T(decim/select/formRot)=6.825e-04,6.945e-04,3.583e-05 -----
----- TIMING FOR onedot_decimation: 1.726e-03 S T(wf/decim)=2.249e-04,1.501e-03 -----
ctns::oper_renorm coord=(13,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:14 S:26 H:1 A:91 B:105 
        dim(bra,ket)=68,68 size(op)=652:4.974e-03MB size(tot)=87673:6.689e-01MB:6.532e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.063e+03S Sys:2.798e+00S Total:1.066e+03S
----- TIMING FOR symbolic_formulae_renorm with size=237 : 9.216e-03 S -----
rank=0 GPUmem(GB): used=0.00108 (oper)=0.00104
rank=0 GPUmem(GB): used=0.00109 (oper,site)(GB)=0.00104,1.11e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=267
 no. of coefficients=5310:0.0405MB:3.96e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.369e-04 S -----
rank=0 GPUmem(GB): used=0.00113 (oper,site,rinter)=0.00104,1.11e-05,3.96e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00675 S size(rtasks)=237 size(Rlst2)=81 T(Rmu/Rlist)=0.00158,0.00517 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00718 S size(rtasks)=237 size(Rlst)=4374 -----
rank=0 GPUmem(GB): used=0.00113 (oper,site,rinter,batch)=0.00104,1.11e-05,3.96e-05,0.0168 blksize=196 blksize0=121 batchsize=4374
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00239,0.019,0.00539
--- TIMING FOR renorm : t_inter=2.4e-03 t_gemm=1.9e-02 t_reduction=5.4e-03 tot=2.7e-02 ---
 renorm[inter] counter=23 t=2.4e-03 per=8.9e+00 cost=4.6e+06 flops=1.9e+09
 renorm[gemm] counter=23 i=0 t=1.5e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=1 t=1.2e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=2 t=5.5e-03 per=2.0e+01 cost=1.6e+06 flops=3.0e+08
 renorm[gemm] counter=23 i=3 t=5.2e-03 per=1.9e+01 cost=3.1e+06 flops=6.1e+08
 renorm[gemm] counter=23 i=4 t=1.3e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=5 t=1.1e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=6 t=8.4e-03 per=3.1e+01 cost=5.7e+06 flops=6.8e+08
 renorm[gemm] counter=23 total t=1.9e-02 per=7.1e+01 cost=1.0e+07 flops=5.5e+08
 renorm[red] counter=23 t=5.4e-03 per=2.0e+01 cost=6.8e+05 flops=1.3e+08
--- TIMING FOR renorm_tot : t_inter=2.1e-02 t_gemm=2.1e-01 t_reduction=5.7e-02 tot=2.9e-01 ---
 renorm_tot[inter] counter=23 t=2.1e-02 per=7.3e+00 cost=6.7e+07 flops=3.2e+09
 renorm_tot[gemm] counter=23 i=0 t=3.4e-05 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=23 i=1 t=2.8e-05 per=9.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=23 i=2 t=1.6e-02 per=5.5e+00 cost=3.1e+06 flops=2.0e+08
 renorm_tot[gemm] counter=23 i=3 t=1.5e-02 per=5.3e+00 cost=5.2e+06 flops=3.4e+08
 renorm_tot[gemm] counter=23 i=4 t=4.4e-02 per=1.5e+01 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=23 i=5 t=5.4e-02 per=1.9e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=23 i=6 t=8.2e-02 per=2.8e+01 cost=1.1e+08 flops=1.4e+09
 renorm_tot[gemm] counter=23 total t=2.1e-01 per=7.3e+01 cost=2.0e+08 flops=9.4e+08
 renorm_tot[red] counter=23 t=5.7e-02 per=2.0e+01 cost=1.4e+07 flops=2.5e+08
qops.to_cpu: size(tot)=87673:6.7e-01MB:6.5e-04GB t[to_cpu]=1.6e-04S speed=4.0e+00GB/S
check ||H-H.dagger||=4.480e-14 coord=(13,0) rank=0
ctns::oper_ab2pq coord=(13,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0728 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.063e+03S Sys:2.799e+00S Total:1.066e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1941:1.481e-02MB:1.446e-05GB
total mem of comb=17626:1.345e-01MB:1.313e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.063e+03S Sys:2.799e+00S Total:1.066e+03S
##### local opt: 2.476e-01 S #####
 T(local opt: fetch) = 1.107e-02 S  per = 4.47  per(accum) = 4.47
 T(local opt: hdiag) = 1.741e-03 S  per = 0.703  per(accum) = 5.17
 T(local opt: dvdsn) = 1.571e-01 S  per = 63.5  per(accum) = 68.6
 T(local opt: decim) = 1.737e-03 S  per = 0.702  per(accum) = 69.3
 T(local opt: guess) = 3.731e-04 S  per = 0.151  per(accum) = 69.5
 T(local opt: renrm) = 7.352e-02 S  per = 29.7  per(accum) = 99.2
 T(local opt: save ) = 2.025e-03 S  per = 0.818  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.571e-01 S  T(sum) = 1.566e-01 S  per = 9.965e+01
 T(local opt: preprocess                  ) = 3.978e-04 S  per = 0.254  per(accum) = 0.254
 T(local opt: symbolic_formulae           ) = 1.488e-02 S  per =  9.5  per(accum) = 9.76
 T(local opt: hintermediate init          ) = 3.242e-04 S  per = 0.207  per(accum) = 9.97
 T(local opt: preprocess_hformulae_Hxlist ) = 1.444e-02 S  per = 9.22  per(accum) = 19.2
 T(local opt: hmmtasks init               ) = 6.569e-02 S  per = 41.9  per(accum) = 61.1
 T(local opt: initial guess for dvdson    ) = 8.999e-06 S  per = 0.00575  per(accum) = 61.1
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.936e-02 S  per = 18.7  per(accum) = 79.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.602e-04 S  per = 0.166  per(accum) = 80.1
 T(local opt: dvdson solver [comm(cpu)]   ) = 8.010e-07 S  per = 0.000511  per(accum) = 80.1
 T(local opt: dvdson solver [rest part]   ) = 3.123e-02 S  per = 19.9  per(accum) = 100
Detailed decomposition of T(renrm) = 7.352e-02 S  T(sum) = 7.352e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.297e-04 S  per = 0.312  per(accum) = 0.312
 T(local opt: qops init                    ) = 3.371e-03 S  per = 4.59  per(accum) = 4.9
 T(local opt: symbolic_formulae_renorm     ) = 9.233e-03 S  per = 12.6  per(accum) = 17.5
 T(local opt: allocate qops on gpu         ) = 2.980e-05 S  per = 0.0405  per(accum) = 17.5
 T(local opt: site memcpy cpu2gpu          ) = 2.128e-05 S  per = 0.0289  per(accum) = 17.5
 T(local opt: rintermediate init           ) = 4.478e-04 S  per = 0.609  per(accum) = 18.1
 T(local opt: preprocess_formulae_Rlist2   ) = 7.328e-03 S  per = 9.97  per(accum) = 28.1
 T(local opt: rmmtasks init                ) = 2.520e-02 S  per = 34.3  per(accum) = 62.4
 T(local opt: qops memset on cpu           ) = 4.700e-08 S  per = 6.39e-05  per(accum) = 62.4
 T(local opt: preprocess_renorm_batchGPU   ) = 2.687e-02 S  per = 36.5  per(accum) = 98.9
 T(local opt: reduction of opS & opH [nccl]) = 1.196e-06 S  per = 0.00163  per(accum) = 98.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.698e-04 S  per = 0.231  per(accum) = 99.1
 T(local opt: deallocate cpu and gpu memory) = 1.104e-04 S  per = 0.15  per(accum) = 99.3
 T(local opt: reduction of opS & opH [comm]) = 4.581e-05 S  per = 0.0623  per(accum) = 99.4
 T(local opt: conversion from opAB to opPQ ) = 4.002e-06 S  per = 0.00544  per(accum) = 99.4
 T(local opt: after oper_renorm            ) = 4.651e-04 S  per = 0.633  per(accum) = 100
##### sweep opt: 1.174e+01 S #####
 T(sweep opt: fetch) = 3.061e-01 S  per = 2.61  per(accum) = 2.61
 T(sweep opt: hdiag) = 4.154e-02 S  per = 0.354  per(accum) = 2.96
 T(sweep opt: dvdsn) = 5.331e+00 S  per = 45.4  per(accum) = 48.4
 T(sweep opt: decim) = 2.674e-02 S  per = 0.228  per(accum) = 48.6
 T(sweep opt: guess) = 6.646e-03 S  per = 0.0566  per(accum) = 48.6
 T(sweep opt: renrm) = 5.976e+00 S  per = 50.9  per(accum) = 99.5
 T(sweep opt: save ) = 5.393e-02 S  per = 0.459  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.331e+00 S  T(sum) = 4.874e+00 S  per = 9.143e+01
 T(sweep opt: preprocess                  ) = 1.047e-02 S  per = 0.215  per(accum) = 0.215
 T(sweep opt: symbolic_formulae           ) = 3.038e-01 S  per = 6.23  per(accum) = 6.45
 T(sweep opt: hintermediate init          ) = 6.983e-03 S  per = 0.143  per(accum) = 6.59
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.346e-01 S  per = 6.86  per(accum) = 13.5
 T(sweep opt: hmmtasks init               ) = 2.153e+00 S  per = 44.2  per(accum) = 57.6
 T(sweep opt: initial guess for dvdson    ) = 1.761e-04 S  per = 0.00361  per(accum) = 57.6
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 8.642e-01 S  per = 17.7  per(accum) = 75.4
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 5.318e-03 S  per = 0.109  per(accum) = 75.5
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.041e-05 S  per = 0.000419  per(accum) = 75.5
 T(sweep opt: dvdson solver [rest part]   ) = 1.195e+00 S  per = 24.5  per(accum) = 100
Detailed decomposition of T(renrm) = 5.976e+00 S  T(sum) = 5.976e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.546e-03 S  per = 0.126  per(accum) = 0.126
 T(sweep opt: qops init                    ) = 7.317e-02 S  per = 1.22  per(accum) = 1.35
 T(sweep opt: symbolic_formulae_renorm     ) = 2.531e-01 S  per = 4.24  per(accum) = 5.59
 T(sweep opt: allocate qops on gpu         ) = 1.457e-03 S  per = 0.0244  per(accum) = 5.61
 T(sweep opt: site memcpy cpu2gpu          ) = 5.117e-04 S  per = 0.00856  per(accum) = 5.62
 T(sweep opt: rintermediate init           ) = 1.116e-02 S  per = 0.187  per(accum) = 5.81
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.146e-01 S  per = 3.59  per(accum) = 9.4
 T(sweep opt: rmmtasks init                ) = 8.292e-01 S  per = 13.9  per(accum) = 23.3
 T(sweep opt: qops memset on cpu           ) = 1.199e-06 S  per = 2.01e-05  per(accum) = 23.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.916e-01 S  per = 4.88  per(accum) = 28.2
 T(sweep opt: reduction of opS & opH [nccl]) = 2.449e-05 S  per = 0.00041  per(accum) = 28.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.777e-03 S  per = 0.0465  per(accum) = 28.2
 T(sweep opt: deallocate cpu and gpu memory) = 4.563e-01 S  per = 7.64  per(accum) = 35.8
 T(sweep opt: reduction of opS & opH [comm]) = 1.067e-03 S  per = 0.0179  per(accum) = 35.9
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 63.9  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 1.407e-02 S  per = 0.236  per(accum) = 100
##### global opt: 1.174e+01 S #####
 T(global opt: fetch) = 3.061e-01 S  per = 2.61  per(accum) = 2.61
 T(global opt: hdiag) = 4.154e-02 S  per = 0.354  per(accum) = 2.96
 T(global opt: dvdsn) = 5.331e+00 S  per = 45.4  per(accum) = 48.4
 T(global opt: decim) = 2.674e-02 S  per = 0.228  per(accum) = 48.6
 T(global opt: guess) = 6.646e-03 S  per = 0.0566  per(accum) = 48.6
 T(global opt: renrm) = 5.976e+00 S  per = 50.9  per(accum) = 99.5
 T(global opt: save ) = 5.393e-02 S  per = 0.459  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.331e+00 S  T(sum) = 4.874e+00 S  per = 9.143e+01
 T(global opt: preprocess                  ) = 1.047e-02 S  per = 0.215  per(accum) = 0.215
 T(global opt: symbolic_formulae           ) = 3.038e-01 S  per = 6.23  per(accum) = 6.45
 T(global opt: hintermediate init          ) = 6.983e-03 S  per = 0.143  per(accum) = 6.59
 T(global opt: preprocess_hformulae_Hxlist ) = 3.346e-01 S  per = 6.86  per(accum) = 13.5
 T(global opt: hmmtasks init               ) = 2.153e+00 S  per = 44.2  per(accum) = 57.6
 T(global opt: initial guess for dvdson    ) = 1.761e-04 S  per = 0.00361  per(accum) = 57.6
 T(global opt: dvdson solver [Hx_batchGPU] ) = 8.642e-01 S  per = 17.7  per(accum) = 75.4
 T(global opt: dvdson solver [comm(gpu)]   ) = 5.318e-03 S  per = 0.109  per(accum) = 75.5
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.041e-05 S  per = 0.000419  per(accum) = 75.5
 T(global opt: dvdson solver [rest part]   ) = 1.195e+00 S  per = 24.5  per(accum) = 100
Detailed decomposition of T(renrm) = 5.976e+00 S  T(sum) = 5.976e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.546e-03 S  per = 0.126  per(accum) = 0.126
 T(global opt: qops init                    ) = 7.317e-02 S  per = 1.22  per(accum) = 1.35
 T(global opt: symbolic_formulae_renorm     ) = 2.531e-01 S  per = 4.24  per(accum) = 5.59
 T(global opt: allocate qops on gpu         ) = 1.457e-03 S  per = 0.0244  per(accum) = 5.61
 T(global opt: site memcpy cpu2gpu          ) = 5.117e-04 S  per = 0.00856  per(accum) = 5.62
 T(global opt: rintermediate init           ) = 1.116e-02 S  per = 0.187  per(accum) = 5.81
 T(global opt: preprocess_formulae_Rlist2   ) = 2.146e-01 S  per = 3.59  per(accum) = 9.4
 T(global opt: rmmtasks init                ) = 8.292e-01 S  per = 13.9  per(accum) = 23.3
 T(global opt: qops memset on cpu           ) = 1.199e-06 S  per = 2.01e-05  per(accum) = 23.3
 T(global opt: preprocess_renorm_batchGPU   ) = 2.916e-01 S  per = 4.88  per(accum) = 28.2
 T(global opt: reduction of opS & opH [nccl]) = 2.449e-05 S  per = 0.00041  per(accum) = 28.2
 T(global opt: qops memcpy gpu2cpu          ) = 2.777e-03 S  per = 0.0465  per(accum) = 28.2
 T(global opt: deallocate cpu and gpu memory) = 4.563e-01 S  per = 7.64  per(accum) = 35.8
 T(global opt: reduction of opS & opH [comm]) = 1.067e-03 S  per = 0.0179  per(accum) = 35.9
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 63.9  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 1.407e-02 S  per = 0.236  per(accum) = 100

isweep=0 ibond=23/seqsize=34 dots=1 dbond=(11,0)-(12,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.063e+03S Sys:2.799e+00S Total:1.066e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1941:1.481e-02MB:1.446e-05GB
total mem of comb=17626:1.345e-01MB:1.313e-04GB
ctns::topology::check_partition: (sl,sr,sc)=12,7,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc= 8
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:24 S:16 H:1 P:120 Q:136 
        dim(bra,ket)=77,77 size(op)=845:6.447e-03MB size(tot)=142381:1.086e+00MB:1.061e-03GB
 rqops: oplist=CSHAB nops=C:14 S:26 H:1 A:91 B:105 
        dim(bra,ket)=68,68 size(op)=652:4.974e-03MB size(tot)=87673:6.689e-01MB:6.532e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=232390:1.773e+00MB:1.731e-03GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(12,0) fdel=./scratch/sweep/lop(11,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
wf3(diml,dimr,dimc)=(77,68,4) nnz=1941:1.481e-02MB
qtensor3: wf3 own=1 _data=0x52dbd980
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=77
 (17,3):15 (17,1):15 (18,2):10 (19,1):10 (19,3):10 (18,4):7 (16,2):6 (15,1):3 (19,5):1
 qbond: qcol nsym=9 dimAll=68
 (11,-3):14 (11,-1):12 (9,-3):10 (10,-2):9 (12,-2):7 (9,-1):6 (10,-4):6 (13,-1):3 (9,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=23 nblocks=324 size=1941:1.481e-02MB
### DIAG TIMING: total=2.205e-03 t1=1.243e-05, t2=1.153e-05, t3=2.731e-05, t4=2.129e-03, t5=5.966e-06, t6=1.531e-05, t7=2.928e-06
duration_diagGPU:2.216e-03
duration_diagreduce:3.800e-08
duration_diagtransform:6.858e-06
----- TIMING FOR symbolic_formulae_onedot with size=1053 : 1.877e-02 S -----
rank=0 GPUmem(GB): used=0.00173 (oper)=0.00173
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1053
 no. of hintermediate operators=518
 no. of coefficients=6216:0.0474MB:4.63e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.996e-04 S -----
rank=0 GPUmem(GB): used=0.00178 (oper,hinter)=0.00173,4.63e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.016 S size(H_formulae)=1053 size(Hxlst2)=23 T(Hmu/Hxlist)=0.00244,0.0136 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0174 S size(H_formulae)=1053 size(Hxlst)=15500 -----
rank=0 GPUmem(GB): used=0.0677 (oper,hinter,dvdson,batch)=0.00173,4.63e-05,2.89e-05,0.0659 blksize=210 blksize0=150 batchsize=15500
ctns::pdvdsonSolver_nkr::solve_iter ndim=1941 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.31e-05,0.00025,0.00235,0.000445,0.0031
 ndim=1941:1.45e-05GB t[comm(intra)]=2.77e-05 speed=1.04GB/S t[comm(inter)]=5.38e-06 speed=5.37GB/S
--- TIMING FOR sigma : t_inter=2.5e-04 t_gemm=2.4e-03 t_reduction=4.4e-04 tot=3.0e-03 ---
 sigma[inter] counter=158 t=2.5e-04 per=8.2e+00 cost=1.4e+07 flops=5.7e+10
 sigma[gemm] counter=158 i=0 t=1.4e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=1 t=1.2e-06 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=2 t=7.0e-04 per=2.3e+01 cost=1.3e+07 flops=1.9e+10
 sigma[gemm] counter=158 i=3 t=6.3e-04 per=2.1e+01 cost=1.3e+07 flops=2.1e+10
 sigma[gemm] counter=158 i=4 t=5.4e-04 per=1.8e+01 cost=1.2e+07 flops=2.2e+10
 sigma[gemm] counter=158 i=5 t=4.8e-04 per=1.6e+01 cost=1.2e+07 flops=2.5e+10
 sigma[gemm] counter=158 total t=2.4e-03 per=7.7e+01 cost=5.0e+07 flops=2.1e+10
 sigma[red] counter=158 t=4.4e-04 per=1.5e+01 cost=2.8e+06 flops=6.4e+09
--- TIMING FOR sigma_tot : t_inter=6.0e-02 t_gemm=6.7e-01 t_reduction=1.0e-01 tot=8.4e-01 ---
 sigma_tot[inter] counter=158 t=6.0e-02 per=7.2e+00 cost=1.2e+09 flops=2.0e+10
 sigma_tot[gemm] counter=158 i=0 t=3.2e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=1 t=2.6e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=2 t=1.7e-01 per=2.1e+01 cost=1.0e+09 flops=6.0e+09
 sigma_tot[gemm] counter=158 i=3 t=1.7e-01 per=2.0e+01 cost=1.0e+09 flops=6.0e+09
 sigma_tot[gemm] counter=158 i=4 t=1.7e-01 per=2.0e+01 cost=8.7e+08 flops=5.1e+09
 sigma_tot[gemm] counter=158 i=5 t=1.6e-01 per=1.9e+01 cost=8.8e+08 flops=5.4e+09
 sigma_tot[gemm] counter=158 total t=6.7e-01 per=8.1e+01 cost=3.8e+09 flops=5.6e+09
 sigma_tot[red] counter=158 t=1.0e-01 per=1.2e+01 cost=2.5e+08 flops=2.5e+09
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.9e-06,4.5e-06,1.7e-06,2.9e-06,7.0e-07
settings: ndim=1941 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.542148034411 -1.117e+03  1.381e-02    1     1  3.230e-03 3.230e-03 3.196e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.205e-05,3.581e-04,3.165e-03,6.051e-04,4.182e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=3.621e-05 speed=7.988e-01GB/S t[comm(inter)]=5.842e-06 speed=4.951e+00GB/S
--- TIMING FOR sigma : t_inter=3.6e-04 t_gemm=3.2e-03 t_reduction=6.0e-04 tot=4.1e-03 ---
 sigma[inter] counter=159 t=3.6e-04 per=8.7e+00 cost=1.4e+07 flops=4.0e+10
 sigma[gemm] counter=159 i=0 t=2.0e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=1 t=1.8e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=2 t=9.4e-04 per=2.3e+01 cost=1.3e+07 flops=1.4e+10
 sigma[gemm] counter=159 i=3 t=8.7e-04 per=2.1e+01 cost=1.3e+07 flops=1.5e+10
 sigma[gemm] counter=159 i=4 t=7.2e-04 per=1.7e+01 cost=1.2e+07 flops=1.6e+10
 sigma[gemm] counter=159 i=5 t=6.3e-04 per=1.5e+01 cost=1.2e+07 flops=1.9e+10
 sigma[gemm] counter=159 total t=3.2e-03 per=7.7e+01 cost=5.0e+07 flops=1.6e+10
 sigma[red] counter=159 t=6.0e-04 per=1.5e+01 cost=2.8e+06 flops=4.7e+09
--- TIMING FOR sigma_tot : t_inter=6.1e-02 t_gemm=6.8e-01 t_reduction=1.0e-01 tot=8.4e-01 ---
 sigma_tot[inter] counter=159 t=6.1e-02 per=7.2e+00 cost=1.2e+09 flops=2.0e+10
 sigma_tot[gemm] counter=159 i=0 t=3.2e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=1 t=2.6e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=2 t=1.7e-01 per=2.1e+01 cost=1.0e+09 flops=6.0e+09
 sigma_tot[gemm] counter=159 i=3 t=1.7e-01 per=2.0e+01 cost=1.0e+09 flops=6.0e+09
 sigma_tot[gemm] counter=159 i=4 t=1.7e-01 per=2.0e+01 cost=8.8e+08 flops=5.1e+09
 sigma_tot[gemm] counter=159 i=5 t=1.6e-01 per=1.9e+01 cost=8.9e+08 flops=5.5e+09
 sigma_tot[gemm] counter=159 total t=6.8e-01 per=8.1e+01 cost=3.8e+09 flops=5.7e+09
 sigma_tot[red] counter=159 t=1.0e-01 per=1.2e+01 cost=2.5e+08 flops=2.5e+09
T(sub)=5.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,2.3e-05,4.2e-06,6.3e-06,9.2e-07
    2   0 -    -116.542371742070 -2.237e-04  4.109e-03    2     2  1.237e-02 6.186e-03 3.751e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.065e-05,3.721e-04,3.140e-03,5.810e-04,4.143e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=3.590e-05 speed=8.056e-01GB/S t[comm(inter)]=4.752e-06 speed=6.087e+00GB/S
--- TIMING FOR sigma : t_inter=3.7e-04 t_gemm=3.1e-03 t_reduction=5.8e-04 tot=4.1e-03 ---
 sigma[inter] counter=160 t=3.7e-04 per=9.1e+00 cost=1.4e+07 flops=3.8e+10
 sigma[gemm] counter=160 i=0 t=1.9e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=1 t=1.8e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=2 t=9.3e-04 per=2.3e+01 cost=1.3e+07 flops=1.5e+10
 sigma[gemm] counter=160 i=3 t=8.6e-04 per=2.1e+01 cost=1.3e+07 flops=1.5e+10
 sigma[gemm] counter=160 i=4 t=6.9e-04 per=1.7e+01 cost=1.2e+07 flops=1.7e+10
 sigma[gemm] counter=160 i=5 t=6.6e-04 per=1.6e+01 cost=1.2e+07 flops=1.8e+10
 sigma[gemm] counter=160 total t=3.1e-03 per=7.7e+01 cost=5.0e+07 flops=1.6e+10
 sigma[red] counter=160 t=5.8e-04 per=1.4e+01 cost=2.8e+06 flops=4.9e+09
--- TIMING FOR sigma_tot : t_inter=6.1e-02 t_gemm=6.8e-01 t_reduction=1.0e-01 tot=8.4e-01 ---
 sigma_tot[inter] counter=160 t=6.1e-02 per=7.2e+00 cost=1.2e+09 flops=2.0e+10
 sigma_tot[gemm] counter=160 i=0 t=3.2e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=1 t=2.7e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=2 t=1.7e-01 per=2.1e+01 cost=1.1e+09 flops=6.1e+09
 sigma_tot[gemm] counter=160 i=3 t=1.7e-01 per=2.0e+01 cost=1.0e+09 flops=6.1e+09
 sigma_tot[gemm] counter=160 i=4 t=1.7e-01 per=2.0e+01 cost=8.9e+08 flops=5.2e+09
 sigma_tot[gemm] counter=160 i=5 t=1.6e-01 per=1.9e+01 cost=9.1e+08 flops=5.5e+09
 sigma_tot[gemm] counter=160 total t=6.8e-01 per=8.1e+01 cost=3.9e+09 flops=5.7e+09
 sigma_tot[red] counter=160 t=1.0e-01 per=1.2e+01 cost=2.5e+08 flops=2.5e+09
T(sub)=5.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,2.6e-05,3.5e-06,9.1e-06,9.7e-07
    3   0 -    -116.542400006522 -2.826e-05  2.082e-03    3     3  2.203e-02 7.345e-03 3.933e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.975e-05,3.548e-04,3.323e-03,5.906e-04,4.318e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=3.488e-05 speed=8.291e-01GB/S t[comm(inter)]=4.866e-06 speed=5.944e+00GB/S
--- TIMING FOR sigma : t_inter=3.5e-04 t_gemm=3.3e-03 t_reduction=5.9e-04 tot=4.3e-03 ---
 sigma[inter] counter=161 t=3.5e-04 per=8.3e+00 cost=1.4e+07 flops=4.0e+10
 sigma[gemm] counter=161 i=0 t=1.9e-06 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=1 t=1.7e-06 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=2 t=9.7e-04 per=2.3e+01 cost=1.3e+07 flops=1.4e+10
 sigma[gemm] counter=161 i=3 t=8.9e-04 per=2.1e+01 cost=1.3e+07 flops=1.5e+10
 sigma[gemm] counter=161 i=4 t=7.5e-04 per=1.8e+01 cost=1.2e+07 flops=1.6e+10
 sigma[gemm] counter=161 i=5 t=7.0e-04 per=1.6e+01 cost=1.2e+07 flops=1.7e+10
 sigma[gemm] counter=161 total t=3.3e-03 per=7.8e+01 cost=5.0e+07 flops=1.5e+10
 sigma[red] counter=161 t=5.9e-04 per=1.4e+01 cost=2.8e+06 flops=4.8e+09
--- TIMING FOR sigma_tot : t_inter=6.1e-02 t_gemm=6.8e-01 t_reduction=1.0e-01 tot=8.5e-01 ---
 sigma_tot[inter] counter=161 t=6.1e-02 per=7.2e+00 cost=1.2e+09 flops=2.0e+10
 sigma_tot[gemm] counter=161 i=0 t=3.3e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=1 t=2.7e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=2 t=1.7e-01 per=2.1e+01 cost=1.1e+09 flops=6.1e+09
 sigma_tot[gemm] counter=161 i=3 t=1.7e-01 per=2.0e+01 cost=1.1e+09 flops=6.1e+09
 sigma_tot[gemm] counter=161 i=4 t=1.7e-01 per=2.0e+01 cost=9.0e+08 flops=5.2e+09
 sigma_tot[gemm] counter=161 i=5 t=1.6e-01 per=1.9e+01 cost=9.2e+08 flops=5.6e+09
 sigma_tot[gemm] counter=161 total t=6.8e-01 per=8.1e+01 cost=3.9e+09 flops=5.8e+09
 sigma_tot[red] counter=161 t=1.0e-01 per=1.2e+01 cost=2.6e+08 flops=2.5e+09
T(sub)=1.1e-04 T(gemm/eig/ortho/gemm/axpy)=6.3e-05,1.7e-05,3.6e-06,2.2e-05,1.1e-06
    4   0 -    -116.542407937503 -7.931e-06  1.079e-03    3     4  3.194e-02 7.986e-03 4.060e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.002e-05,3.536e-04,3.191e-03,6.110e-04,4.205e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=3.465e-05 speed=8.348e-01GB/S t[comm(inter)]=5.375e-06 speed=5.381e+00GB/S
--- TIMING FOR sigma : t_inter=3.5e-04 t_gemm=3.2e-03 t_reduction=6.1e-04 tot=4.2e-03 ---
 sigma[inter] counter=162 t=3.5e-04 per=8.5e+00 cost=1.4e+07 flops=4.0e+10
 sigma[gemm] counter=162 i=0 t=1.9e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=1 t=1.7e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=2 t=9.4e-04 per=2.3e+01 cost=1.3e+07 flops=1.4e+10
 sigma[gemm] counter=162 i=3 t=8.8e-04 per=2.1e+01 cost=1.3e+07 flops=1.5e+10
 sigma[gemm] counter=162 i=4 t=7.2e-04 per=1.7e+01 cost=1.2e+07 flops=1.6e+10
 sigma[gemm] counter=162 i=5 t=6.4e-04 per=1.5e+01 cost=1.2e+07 flops=1.9e+10
 sigma[gemm] counter=162 total t=3.2e-03 per=7.7e+01 cost=5.0e+07 flops=1.6e+10
 sigma[red] counter=162 t=6.1e-04 per=1.5e+01 cost=2.8e+06 flops=4.7e+09
--- TIMING FOR sigma_tot : t_inter=6.2e-02 t_gemm=6.9e-01 t_reduction=1.0e-01 tot=8.5e-01 ---
 sigma_tot[inter] counter=162 t=6.2e-02 per=7.2e+00 cost=1.3e+09 flops=2.0e+10
 sigma_tot[gemm] counter=162 i=0 t=3.3e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=1 t=2.7e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=2 t=1.8e-01 per=2.1e+01 cost=1.1e+09 flops=6.2e+09
 sigma_tot[gemm] counter=162 i=3 t=1.7e-01 per=2.0e+01 cost=1.1e+09 flops=6.2e+09
 sigma_tot[gemm] counter=162 i=4 t=1.7e-01 per=2.0e+01 cost=9.1e+08 flops=5.3e+09
 sigma_tot[gemm] counter=162 i=5 t=1.7e-01 per=1.9e+01 cost=9.3e+08 flops=5.6e+09
 sigma_tot[gemm] counter=162 total t=6.9e-01 per=8.1e+01 cost=4.0e+09 flops=5.8e+09
 sigma_tot[red] counter=162 t=1.0e-01 per=1.2e+01 cost=2.6e+08 flops=2.5e+09
T(sub)=5.8e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,2.5e-05,3.5e-06,9.1e-06,9.0e-07
    5   0 -    -116.542409908908 -1.971e-06  4.414e-04    3     5  4.156e-02 8.311e-03 4.115e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.014e-05,3.520e-04,3.173e-03,6.050e-04,4.180e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=3.492e-05 speed=8.283e-01GB/S t[comm(inter)]=5.219e-06 speed=5.542e+00GB/S
--- TIMING FOR sigma : t_inter=3.5e-04 t_gemm=3.2e-03 t_reduction=6.0e-04 tot=4.1e-03 ---
 sigma[inter] counter=163 t=3.5e-04 per=8.5e+00 cost=1.4e+07 flops=4.0e+10
 sigma[gemm] counter=163 i=0 t=1.9e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=1 t=1.7e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=2 t=9.5e-04 per=2.3e+01 cost=1.3e+07 flops=1.4e+10
 sigma[gemm] counter=163 i=3 t=8.7e-04 per=2.1e+01 cost=1.3e+07 flops=1.5e+10
 sigma[gemm] counter=163 i=4 t=6.9e-04 per=1.7e+01 cost=1.2e+07 flops=1.7e+10
 sigma[gemm] counter=163 i=5 t=6.6e-04 per=1.6e+01 cost=1.2e+07 flops=1.8e+10
 sigma[gemm] counter=163 total t=3.2e-03 per=7.7e+01 cost=5.0e+07 flops=1.6e+10
 sigma[red] counter=163 t=6.0e-04 per=1.5e+01 cost=2.8e+06 flops=4.7e+09
--- TIMING FOR sigma_tot : t_inter=6.2e-02 t_gemm=6.9e-01 t_reduction=1.0e-01 tot=8.6e-01 ---
 sigma_tot[inter] counter=163 t=6.2e-02 per=7.3e+00 cost=1.3e+09 flops=2.0e+10
 sigma_tot[gemm] counter=163 i=0 t=3.3e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=1 t=2.7e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=2 t=1.8e-01 per=2.1e+01 cost=1.1e+09 flops=6.2e+09
 sigma_tot[gemm] counter=163 i=3 t=1.7e-01 per=2.0e+01 cost=1.1e+09 flops=6.2e+09
 sigma_tot[gemm] counter=163 i=4 t=1.7e-01 per=2.0e+01 cost=9.2e+08 flops=5.3e+09
 sigma_tot[gemm] counter=163 i=5 t=1.7e-01 per=1.9e+01 cost=9.4e+08 flops=5.7e+09
 sigma_tot[gemm] counter=163 total t=6.9e-01 per=8.1e+01 cost=4.0e+09 flops=5.8e+09
 sigma_tot[red] counter=163 t=1.0e-01 per=1.2e+01 cost=2.6e+08 flops=2.5e+09
T(sub)=5.8e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,2.5e-05,3.6e-06,9.2e-06,8.9e-07
    6   0 -    -116.542410194992 -2.861e-07  1.597e-04    3     6  5.128e-02 8.546e-03 4.146e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.931e-05,2.969e-04,2.711e-03,4.819e-04,3.541e-03
 ndim=1941:1.446e-05GB t[comm(intra)]=3.434e-05 speed=8.421e-01GB/S t[comm(inter)]=4.964e-06 speed=5.827e+00GB/S
--- TIMING FOR sigma : t_inter=3.0e-04 t_gemm=2.7e-03 t_reduction=4.8e-04 tot=3.5e-03 ---
 sigma[inter] counter=164 t=3.0e-04 per=8.5e+00 cost=1.4e+07 flops=4.8e+10
 sigma[gemm] counter=164 i=0 t=1.7e-06 per=4.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=1 t=1.5e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=2 t=8.1e-04 per=2.3e+01 cost=1.3e+07 flops=1.7e+10
 sigma[gemm] counter=164 i=3 t=7.3e-04 per=2.1e+01 cost=1.3e+07 flops=1.8e+10
 sigma[gemm] counter=164 i=4 t=5.9e-04 per=1.7e+01 cost=1.2e+07 flops=2.0e+10
 sigma[gemm] counter=164 i=5 t=5.7e-04 per=1.6e+01 cost=1.2e+07 flops=2.1e+10
 sigma[gemm] counter=164 total t=2.7e-03 per=7.8e+01 cost=5.0e+07 flops=1.9e+10
 sigma[red] counter=164 t=4.8e-04 per=1.4e+01 cost=2.8e+06 flops=5.9e+09
--- TIMING FOR sigma_tot : t_inter=6.2e-02 t_gemm=6.9e-01 t_reduction=1.0e-01 tot=8.6e-01 ---
 sigma_tot[inter] counter=164 t=6.2e-02 per=7.3e+00 cost=1.3e+09 flops=2.0e+10
 sigma_tot[gemm] counter=164 i=0 t=3.3e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=1 t=2.7e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=2 t=1.8e-01 per=2.1e+01 cost=1.1e+09 flops=6.2e+09
 sigma_tot[gemm] counter=164 i=3 t=1.7e-01 per=2.0e+01 cost=1.1e+09 flops=6.3e+09
 sigma_tot[gemm] counter=164 i=4 t=1.8e-01 per=2.0e+01 cost=9.4e+08 flops=5.3e+09
 sigma_tot[gemm] counter=164 i=5 t=1.7e-01 per=1.9e+01 cost=9.5e+08 flops=5.7e+09
 sigma_tot[gemm] counter=164 total t=6.9e-01 per=8.1e+01 cost=4.1e+09 flops=5.9e+09
 sigma_tot[red] counter=164 t=1.0e-01 per=1.2e+01 cost=2.7e+08 flops=2.5e+09
T(sub)=5.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-05,2.5e-05,3.2e-06,8.9e-06,9.5e-07
    7   0 +    -116.542410234795 -3.980e-08  6.298e-05    3     7  6.479e-02 9.256e-03 4.075e-03
TIMING FOR Davidson : 6.482e-02  T(cal/comm/rest)=2.853e-02,8.350e-07,3.629e-02
decomposed t_rest=3.629e-02
 T(sub)    =4.062e-04 per=1.119e+00
 T(precond)=3.556e-02 per=9.799e+01
 T(ortho)  =8.400e-05 per=2.315e-01
 T(xcopy)  =1.738e-05 per=4.790e-02
 T(xnrm2)  =9.716e-06 per=2.677e-02
 T(other)  =2.106e-04 per=5.804e-01
optimized energies: isweep=0 ibond=23 dots=1 e[0]=-116.542410234795 nmvp=7
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.070e+03S Sys:2.801e+00S Total:1.073e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond23.txt
 qbond: qsuper nsym=18 dimAll=272
 (11,-3):39 (11,-1):27 (9,-3):10 (10,-2):25 (12,-2):42 (9,-1):6 (10,-4):17 (13,-1):22 (9,-5):1 (13,-3):21 (14,-2):10 (12,-4):20 (15,-1):3 (11,-5):7 (12,0):12 (10,0):6 (14,0):3 (10,-6):1
timing for divide=1.4e-05
timing for compute=5.1e-04
timing for collect=2.2e-05
----- TMING FOR decimation_genbasis(nkr): 5.4e-04 S T(divide/compute/collect)=1.4e-05,5.1e-04,2.2e-05 -----
decimation summary: 272->77 dwt=+0.000e+00 SvN=2.207e+00
 qbond: qkept nsym=9 dimAll=77
 (13,-1):15 (13,-3):15 (11,-3):10 (11,-1):10 (12,-2):10 (12,-4):7 (14,-2):6 (15,-1):3 (11,-5):1
----- TIMING for decimation_row(nkr): 1.371e-03 S T(decim/select/formRot)=6.230e-04,7.150e-04,3.257e-05 -----
----- TIMING FOR onedot_decimation: 1.653e-03 S T(wf/decim)=1.934e-04,1.459e-03 -----
ctns::oper_renorm coord=(12,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:16 S:24 H:1 A:120 B:136 
        dim(bra,ket)=77,77 size(op)=845:6.447e-03MB size(tot)=142381:1.086e+00MB:1.061e-03GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.070e+03S Sys:2.803e+00S Total:1.073e+03S
----- TIMING FOR symbolic_formulae_renorm with size=297 : 1.032e-02 S -----
rank=0 GPUmem(GB): used=0.00178 (oper)=0.00173
rank=0 GPUmem(GB): used=0.00179 (oper,site)(GB)=0.00173,1.45e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=247
 no. of coefficients=6538:0.0499MB:4.87e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.312e-04 S -----
rank=0 GPUmem(GB): used=0.00184 (oper,site,rinter)=0.00173,1.45e-05,4.87e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00717 S size(rtasks)=297 size(Rlst2)=81 T(Rmu/Rlist)=0.00161,0.00556 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00789 S size(rtasks)=297 size(Rlst)=4918 -----
rank=0 GPUmem(GB): used=0.00184 (oper,site,rinter,batch)=0.00173,1.45e-05,4.87e-05,0.0237 blksize=225 blksize0=196 batchsize=4918
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00257,0.0155,0.00415
--- TIMING FOR renorm : t_inter=2.6e-03 t_gemm=1.5e-02 t_reduction=4.2e-03 tot=2.2e-02 ---
 renorm[inter] counter=24 t=2.6e-03 per=1.2e+01 cost=7.6e+06 flops=3.0e+09
 renorm[gemm] counter=24 i=0 t=1.4e-06 per=6.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=1 t=1.2e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=2 t=5.6e-03 per=2.5e+01 cost=2.3e+06 flops=4.1e+08
 renorm[gemm] counter=24 i=3 t=4.8e-03 per=2.2e+01 cost=5.7e+06 flops=1.2e+09
 renorm[gemm] counter=24 i=4 t=1.2e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=5 t=1.1e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=6 t=5.0e-03 per=2.3e+01 cost=9.3e+06 flops=1.9e+09
 renorm[gemm] counter=24 total t=1.5e-02 per=7.0e+01 cost=1.7e+07 flops=1.1e+09
 renorm[red] counter=24 t=4.2e-03 per=1.9e+01 cost=9.9e+05 flops=2.4e+08
--- TIMING FOR renorm_tot : t_inter=2.4e-02 t_gemm=2.3e-01 t_reduction=6.1e-02 tot=3.1e-01 ---
 renorm_tot[inter] counter=24 t=2.4e-02 per=7.6e+00 cost=7.4e+07 flops=3.1e+09
 renorm_tot[gemm] counter=24 i=0 t=3.5e-05 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=24 i=1 t=2.9e-05 per=9.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=24 i=2 t=2.2e-02 per=6.9e+00 cost=5.5e+06 flops=2.5e+08
 renorm_tot[gemm] counter=24 i=3 t=2.0e-02 per=6.5e+00 cost=1.1e+07 flops=5.4e+08
 renorm_tot[gemm] counter=24 i=4 t=4.4e-02 per=1.4e+01 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=24 i=5 t=5.4e-02 per=1.7e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=24 i=6 t=8.7e-02 per=2.8e+01 cost=1.2e+08 flops=1.4e+09
 renorm_tot[gemm] counter=24 total t=2.3e-01 per=7.3e+01 cost=2.2e+08 flops=9.5e+08
 renorm_tot[red] counter=24 t=6.1e-02 per=2.0e+01 cost=1.5e+07 flops=2.5e+08
qops.to_cpu: size(tot)=142381:1.1e+00MB:1.1e-03GB t[to_cpu]=2.7e-04S speed=4.0e+00GB/S
check ||H-H.dagger||=5.509e-14 coord=(12,0) rank=0
ctns::oper_ab2pq coord=(12,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.358 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.070e+03S Sys:2.803e+00S Total:1.073e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=2137:1.630e-02MB:1.592e-05GB
total mem of comb=17822:1.360e-01MB:1.328e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.070e+03S Sys:2.805e+00S Total:1.073e+03S
##### local opt: 5.737e-01 S #####
 T(local opt: fetch) = 1.172e-02 S  per = 2.04  per(accum) = 2.04
 T(local opt: hdiag) = 2.285e-03 S  per = 0.398  per(accum) = 2.44
 T(local opt: dvdsn) = 1.917e-01 S  per = 33.4  per(accum) = 35.9
 T(local opt: decim) = 1.663e-03 S  per = 0.29  per(accum) = 36.1
 T(local opt: guess) = 3.329e-04 S  per = 0.058  per(accum) = 36.2
 T(local opt: renrm) = 3.597e-01 S  per = 62.7  per(accum) = 98.9
 T(local opt: save ) = 6.324e-03 S  per =  1.1  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.917e-01 S  T(sum) = 1.910e-01 S  per = 9.965e+01
 T(local opt: preprocess                  ) = 4.046e-04 S  per = 0.212  per(accum) = 0.212
 T(local opt: symbolic_formulae           ) = 1.878e-02 S  per = 9.83  per(accum) = 10
 T(local opt: hintermediate init          ) = 4.155e-04 S  per = 0.218  per(accum) = 10.3
 T(local opt: preprocess_hformulae_Hxlist ) = 1.781e-02 S  per = 9.32  per(accum) = 19.6
 T(local opt: hmmtasks init               ) = 8.875e-02 S  per = 46.5  per(accum) = 66.1
 T(local opt: initial guess for dvdson    ) = 1.074e-05 S  per = 0.00563  per(accum) = 66.1
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.825e-02 S  per = 14.8  per(accum) = 80.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.750e-04 S  per = 0.144  per(accum) = 81
 T(local opt: dvdson solver [comm(cpu)]   ) = 8.350e-07 S  per = 0.000437  per(accum) = 81
 T(local opt: dvdson solver [rest part]   ) = 3.629e-02 S  per =   19  per(accum) = 100
Detailed decomposition of T(renrm) = 3.597e-01 S  T(sum) = 3.597e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.904e-04 S  per = 0.164  per(accum) = 0.164
 T(local opt: qops init                    ) = 3.353e-03 S  per = 0.932  per(accum) = 1.1
 T(local opt: symbolic_formulae_renorm     ) = 1.033e-02 S  per = 2.87  per(accum) = 3.97
 T(local opt: allocate qops on gpu         ) = 1.114e-03 S  per = 0.31  per(accum) = 4.28
 T(local opt: site memcpy cpu2gpu          ) = 2.448e-05 S  per = 0.00681  per(accum) = 4.29
 T(local opt: rintermediate init           ) = 4.430e-04 S  per = 0.123  per(accum) = 4.41
 T(local opt: preprocess_formulae_Rlist2   ) = 8.061e-03 S  per = 2.24  per(accum) = 6.65
 T(local opt: rmmtasks init                ) = 2.817e-02 S  per = 7.83  per(accum) = 14.5
 T(local opt: qops memset on cpu           ) = 7.900e-08 S  per = 2.2e-05  per(accum) = 14.5
 T(local opt: preprocess_renorm_batchGPU   ) = 2.233e-02 S  per = 6.21  per(accum) = 20.7
 T(local opt: reduction of opS & opH [nccl]) = 9.990e-07 S  per = 0.000278  per(accum) = 20.7
 T(local opt: qops memcpy gpu2cpu          ) = 2.749e-04 S  per = 0.0764  per(accum) = 20.8
 T(local opt: deallocate cpu and gpu memory) = 2.840e-01 S  per =   79  per(accum) = 99.7
 T(local opt: reduction of opS & opH [comm]) = 1.013e-04 S  per = 0.0282  per(accum) = 99.8
 T(local opt: conversion from opAB to opPQ ) = 6.553e-06 S  per = 0.00182  per(accum) = 99.8
 T(local opt: after oper_renorm            ) = 8.646e-04 S  per = 0.24  per(accum) = 100
##### sweep opt: 1.232e+01 S #####
 T(sweep opt: fetch) = 3.179e-01 S  per = 2.58  per(accum) = 2.58
 T(sweep opt: hdiag) = 4.382e-02 S  per = 0.356  per(accum) = 2.94
 T(sweep opt: dvdsn) = 5.523e+00 S  per = 44.8  per(accum) = 47.8
 T(sweep opt: decim) = 2.841e-02 S  per = 0.231  per(accum) = 48
 T(sweep opt: guess) = 6.978e-03 S  per = 0.0567  per(accum) = 48.1
 T(sweep opt: renrm) = 6.335e+00 S  per = 51.4  per(accum) = 99.5
 T(sweep opt: save ) = 6.025e-02 S  per = 0.489  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.523e+00 S  T(sum) = 5.065e+00 S  per = 9.172e+01
 T(sweep opt: preprocess                  ) = 1.087e-02 S  per = 0.215  per(accum) = 0.215
 T(sweep opt: symbolic_formulae           ) = 3.225e-01 S  per = 6.37  per(accum) = 6.58
 T(sweep opt: hintermediate init          ) = 7.399e-03 S  per = 0.146  per(accum) = 6.73
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.524e-01 S  per = 6.96  per(accum) = 13.7
 T(sweep opt: hmmtasks init               ) = 2.242e+00 S  per = 44.3  per(accum) = 58
 T(sweep opt: initial guess for dvdson    ) = 1.869e-04 S  per = 0.00369  per(accum) = 58
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 8.925e-01 S  per = 17.6  per(accum) = 75.6
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 5.593e-03 S  per = 0.11  per(accum) = 75.7
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.124e-05 S  per = 0.000419  per(accum) = 75.7
 T(sweep opt: dvdson solver [rest part]   ) = 1.231e+00 S  per = 24.3  per(accum) = 100
Detailed decomposition of T(renrm) = 6.335e+00 S  T(sum) = 6.335e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.136e-03 S  per = 0.128  per(accum) = 0.128
 T(sweep opt: qops init                    ) = 7.652e-02 S  per = 1.21  per(accum) = 1.34
 T(sweep opt: symbolic_formulae_renorm     ) = 2.634e-01 S  per = 4.16  per(accum) = 5.49
 T(sweep opt: allocate qops on gpu         ) = 2.570e-03 S  per = 0.0406  per(accum) = 5.53
 T(sweep opt: site memcpy cpu2gpu          ) = 5.362e-04 S  per = 0.00846  per(accum) = 5.54
 T(sweep opt: rintermediate init           ) = 1.160e-02 S  per = 0.183  per(accum) = 5.73
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.226e-01 S  per = 3.51  per(accum) = 9.24
 T(sweep opt: rmmtasks init                ) = 8.574e-01 S  per = 13.5  per(accum) = 22.8
 T(sweep opt: qops memset on cpu           ) = 1.278e-06 S  per = 2.02e-05  per(accum) = 22.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.139e-01 S  per = 4.95  per(accum) = 27.7
 T(sweep opt: reduction of opS & opH [nccl]) = 2.549e-05 S  per = 0.000402  per(accum) = 27.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.052e-03 S  per = 0.0482  per(accum) = 27.8
 T(sweep opt: deallocate cpu and gpu memory) = 7.403e-01 S  per = 11.7  per(accum) = 39.5
 T(sweep opt: reduction of opS & opH [comm]) = 1.168e-03 S  per = 0.0184  per(accum) = 39.5
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 60.3  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 1.494e-02 S  per = 0.236  per(accum) = 100
##### global opt: 1.232e+01 S #####
 T(global opt: fetch) = 3.179e-01 S  per = 2.58  per(accum) = 2.58
 T(global opt: hdiag) = 4.382e-02 S  per = 0.356  per(accum) = 2.94
 T(global opt: dvdsn) = 5.523e+00 S  per = 44.8  per(accum) = 47.8
 T(global opt: decim) = 2.841e-02 S  per = 0.231  per(accum) = 48
 T(global opt: guess) = 6.978e-03 S  per = 0.0567  per(accum) = 48.1
 T(global opt: renrm) = 6.335e+00 S  per = 51.4  per(accum) = 99.5
 T(global opt: save ) = 6.025e-02 S  per = 0.489  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.523e+00 S  T(sum) = 5.065e+00 S  per = 9.172e+01
 T(global opt: preprocess                  ) = 1.087e-02 S  per = 0.215  per(accum) = 0.215
 T(global opt: symbolic_formulae           ) = 3.225e-01 S  per = 6.37  per(accum) = 6.58
 T(global opt: hintermediate init          ) = 7.399e-03 S  per = 0.146  per(accum) = 6.73
 T(global opt: preprocess_hformulae_Hxlist ) = 3.524e-01 S  per = 6.96  per(accum) = 13.7
 T(global opt: hmmtasks init               ) = 2.242e+00 S  per = 44.3  per(accum) = 58
 T(global opt: initial guess for dvdson    ) = 1.869e-04 S  per = 0.00369  per(accum) = 58
 T(global opt: dvdson solver [Hx_batchGPU] ) = 8.925e-01 S  per = 17.6  per(accum) = 75.6
 T(global opt: dvdson solver [comm(gpu)]   ) = 5.593e-03 S  per = 0.11  per(accum) = 75.7
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.124e-05 S  per = 0.000419  per(accum) = 75.7
 T(global opt: dvdson solver [rest part]   ) = 1.231e+00 S  per = 24.3  per(accum) = 100
Detailed decomposition of T(renrm) = 6.335e+00 S  T(sum) = 6.335e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.136e-03 S  per = 0.128  per(accum) = 0.128
 T(global opt: qops init                    ) = 7.652e-02 S  per = 1.21  per(accum) = 1.34
 T(global opt: symbolic_formulae_renorm     ) = 2.634e-01 S  per = 4.16  per(accum) = 5.49
 T(global opt: allocate qops on gpu         ) = 2.570e-03 S  per = 0.0406  per(accum) = 5.53
 T(global opt: site memcpy cpu2gpu          ) = 5.362e-04 S  per = 0.00846  per(accum) = 5.54
 T(global opt: rintermediate init           ) = 1.160e-02 S  per = 0.183  per(accum) = 5.73
 T(global opt: preprocess_formulae_Rlist2   ) = 2.226e-01 S  per = 3.51  per(accum) = 9.24
 T(global opt: rmmtasks init                ) = 8.574e-01 S  per = 13.5  per(accum) = 22.8
 T(global opt: qops memset on cpu           ) = 1.278e-06 S  per = 2.02e-05  per(accum) = 22.8
 T(global opt: preprocess_renorm_batchGPU   ) = 3.139e-01 S  per = 4.95  per(accum) = 27.7
 T(global opt: reduction of opS & opH [nccl]) = 2.549e-05 S  per = 0.000402  per(accum) = 27.7
 T(global opt: qops memcpy gpu2cpu          ) = 3.052e-03 S  per = 0.0482  per(accum) = 27.8
 T(global opt: deallocate cpu and gpu memory) = 7.403e-01 S  per = 11.7  per(accum) = 39.5
 T(global opt: reduction of opS & opH [comm]) = 1.168e-03 S  per = 0.0184  per(accum) = 39.5
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 60.3  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 1.494e-02 S  per = 0.236  per(accum) = 100

isweep=0 ibond=24/seqsize=34 dots=1 dbond=(10,0)-(11,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.070e+03S Sys:2.807e+00S Total:1.073e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=2137:1.630e-02MB:1.592e-05GB
total mem of comb=17822:1.360e-01MB:1.328e-04GB
ctns::topology::check_partition: (sl,sr,sc)=11,8,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc= 7
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:22 S:18 H:1 P:153 Q:171 
        dim(bra,ket)=74,74 size(op)=818:6.241e-03MB size(tot)=165874:1.266e+00MB:1.236e-03GB
 rqops: oplist=CSHAB nops=C:16 S:24 H:1 A:120 B:136 
        dim(bra,ket)=77,77 size(op)=845:6.447e-03MB size(tot)=142381:1.086e+00MB:1.061e-03GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=310591:2.370e+00MB:2.314e-03GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(11,0) fdel=./scratch/sweep/lop(10,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
wf3(diml,dimr,dimc)=(74,77,4) nnz=2137:1.630e-02MB
qtensor3: wf3 own=1 _data=0x540855a0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=74
 (15,3):15 (15,1):14 (16,2):11 (17,1):10 (17,3):10 (16,4):7 (14,2):5 (13,1):1 (17,5):1
 qbond: qcol nsym=9 dimAll=77
 (13,-1):15 (13,-3):15 (11,-3):10 (11,-1):10 (12,-2):10 (12,-4):7 (14,-2):6 (15,-1):3 (11,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=23 nblocks=324 size=2137:1.630e-02MB
### DIAG TIMING: total=6.989e-03 t1=2.862e-05, t2=2.537e-05, t3=6.652e-05, t4=6.821e-03, t5=1.358e-05, t6=2.607e-05, t7=7.609e-06
duration_diagGPU:7.016e-03
duration_diagreduce:1.370e-07
duration_diagtransform:1.681e-05
----- TIMING FOR symbolic_formulae_onedot with size=1327 : 5.043e-02 S -----
rank=0 GPUmem(GB): used=0.00231 (oper)=0.00231
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1327
 no. of hintermediate operators=664
 no. of coefficients=7304:0.0557MB:5.44e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 9.779e-04 S -----
rank=0 GPUmem(GB): used=0.00237 (oper,hinter)=0.00231,5.44e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0369 S size(H_formulae)=1327 size(Hxlst2)=23 T(Hmu/Hxlist)=0.00596,0.0309 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0394 S size(H_formulae)=1327 size(Hxlst)=19374 -----
rank=0 GPUmem(GB): used=0.0913 (oper,hinter,dvdson,batch)=0.00231,5.44e-05,3.18e-05,0.0889 blksize=225 blksize0=165 batchsize=19374
ctns::pdvdsonSolver_nkr::solve_iter ndim=2137 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.51e-05,0.000333,0.00279,0.000506,0.00367
 ndim=2137:1.59e-05GB t[comm(intra)]=2.91e-05 speed=1.1GB/S t[comm(inter)]=6e-06 speed=5.31GB/S
--- TIMING FOR sigma : t_inter=3.3e-04 t_gemm=2.8e-03 t_reduction=5.1e-04 tot=3.6e-03 ---
 sigma[inter] counter=165 t=3.3e-04 per=9.2e+00 cost=1.7e+07 flops=5.1e+10
 sigma[gemm] counter=165 i=0 t=1.5e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=1 t=1.3e-06 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=2 t=6.8e-04 per=1.9e+01 cost=2.1e+07 flops=3.1e+10
 sigma[gemm] counter=165 i=3 t=6.7e-04 per=1.9e+01 cost=2.1e+07 flops=3.1e+10
 sigma[gemm] counter=165 i=4 t=7.5e-04 per=2.1e+01 cost=1.6e+07 flops=2.2e+10
 sigma[gemm] counter=165 i=5 t=6.8e-04 per=1.9e+01 cost=1.7e+07 flops=2.4e+10
 sigma[gemm] counter=165 total t=2.8e-03 per=7.7e+01 cost=7.5e+07 flops=2.7e+10
 sigma[red] counter=165 t=5.1e-04 per=1.4e+01 cost=3.9e+06 flops=7.8e+09
--- TIMING FOR sigma_tot : t_inter=6.3e-02 t_gemm=7.0e-01 t_reduction=1.0e-01 tot=8.6e-01 ---
 sigma_tot[inter] counter=165 t=6.3e-02 per=7.3e+00 cost=1.3e+09 flops=2.1e+10
 sigma_tot[gemm] counter=165 i=0 t=3.3e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=1 t=2.7e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=2 t=1.8e-01 per=2.1e+01 cost=1.1e+09 flops=6.3e+09
 sigma_tot[gemm] counter=165 i=3 t=1.7e-01 per=2.0e+01 cost=1.1e+09 flops=6.4e+09
 sigma_tot[gemm] counter=165 i=4 t=1.8e-01 per=2.0e+01 cost=9.5e+08 flops=5.4e+09
 sigma_tot[gemm] counter=165 i=5 t=1.7e-01 per=1.9e+01 cost=9.7e+08 flops=5.8e+09
 sigma_tot[gemm] counter=165 total t=7.0e-01 per=8.1e+01 cost=4.2e+09 flops=6.0e+09
 sigma_tot[red] counter=165 t=1.0e-01 per=1.2e+01 cost=2.7e+08 flops=2.6e+09
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=7.1e-06,5.9e-06,2.0e-06,3.3e-06,9.4e-07
settings: ndim=2137 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.542410234795 -1.117e+03  1.801e-02    1     1  3.808e-03 3.808e-03 3.769e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.616e-05,4.696e-04,3.575e-03,6.693e-04,4.771e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=3.974e-05 speed=8.014e-01GB/S t[comm(inter)]=6.424e-06 speed=4.957e+00GB/S
--- TIMING FOR sigma : t_inter=4.7e-04 t_gemm=3.6e-03 t_reduction=6.7e-04 tot=4.7e-03 ---
 sigma[inter] counter=166 t=4.7e-04 per=1.0e+01 cost=1.7e+07 flops=3.6e+10
 sigma[gemm] counter=166 i=0 t=2.4e-06 per=5.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=1 t=2.1e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=2 t=9.0e-04 per=1.9e+01 cost=2.1e+07 flops=2.4e+10
 sigma[gemm] counter=166 i=3 t=8.6e-04 per=1.8e+01 cost=2.1e+07 flops=2.4e+10
 sigma[gemm] counter=166 i=4 t=9.2e-04 per=2.0e+01 cost=1.6e+07 flops=1.8e+10
 sigma[gemm] counter=166 i=5 t=8.8e-04 per=1.9e+01 cost=1.7e+07 flops=1.9e+10
 sigma[gemm] counter=166 total t=3.6e-03 per=7.6e+01 cost=7.5e+07 flops=2.1e+10
 sigma[red] counter=166 t=6.7e-04 per=1.4e+01 cost=3.9e+06 flops=5.9e+09
--- TIMING FOR sigma_tot : t_inter=6.3e-02 t_gemm=7.0e-01 t_reduction=1.1e-01 tot=8.7e-01 ---
 sigma_tot[inter] counter=166 t=6.3e-02 per=7.3e+00 cost=1.3e+09 flops=2.1e+10
 sigma_tot[gemm] counter=166 i=0 t=3.3e-04 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=1 t=2.8e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=2 t=1.8e-01 per=2.1e+01 cost=1.2e+09 flops=6.4e+09
 sigma_tot[gemm] counter=166 i=3 t=1.8e-01 per=2.0e+01 cost=1.1e+09 flops=6.5e+09
 sigma_tot[gemm] counter=166 i=4 t=1.8e-01 per=2.0e+01 cost=9.7e+08 flops=5.5e+09
 sigma_tot[gemm] counter=166 i=5 t=1.7e-01 per=1.9e+01 cost=9.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=166 total t=7.0e-01 per=8.1e+01 cost=4.2e+09 flops=6.1e+09
 sigma_tot[red] counter=166 t=1.1e-01 per=1.2e+01 cost=2.7e+08 flops=2.6e+09
T(sub)=6.2e-05 T(gemm/eig/ortho/gemm/axpy)=2.2e-05,2.8e-05,4.1e-06,6.9e-06,1.1e-06
    2   0 -    -116.542816069715 -4.058e-04  5.518e-03    2     2  9.252e-03 4.626e-03 4.335e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=5.176e-05,4.301e-04,3.504e-03,6.786e-04,4.678e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=4.626e-05 speed=6.884e-01GB/S t[comm(inter)]=5.498e-06 speed=5.792e+00GB/S
--- TIMING FOR sigma : t_inter=4.3e-04 t_gemm=3.5e-03 t_reduction=6.8e-04 tot=4.6e-03 ---
 sigma[inter] counter=167 t=4.3e-04 per=9.3e+00 cost=1.7e+07 flops=4.0e+10
 sigma[gemm] counter=167 i=0 t=2.0e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=1 t=1.7e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=2 t=8.8e-04 per=1.9e+01 cost=2.1e+07 flops=2.4e+10
 sigma[gemm] counter=167 i=3 t=8.7e-04 per=1.9e+01 cost=2.1e+07 flops=2.4e+10
 sigma[gemm] counter=167 i=4 t=9.2e-04 per=2.0e+01 cost=1.6e+07 flops=1.8e+10
 sigma[gemm] counter=167 i=5 t=8.4e-04 per=1.8e+01 cost=1.7e+07 flops=2.0e+10
 sigma[gemm] counter=167 total t=3.5e-03 per=7.6e+01 cost=7.5e+07 flops=2.1e+10
 sigma[red] counter=167 t=6.8e-04 per=1.5e+01 cost=3.9e+06 flops=5.8e+09
--- TIMING FOR sigma_tot : t_inter=6.4e-02 t_gemm=7.0e-01 t_reduction=1.1e-01 tot=8.7e-01 ---
 sigma_tot[inter] counter=167 t=6.4e-02 per=7.3e+00 cost=1.3e+09 flops=2.1e+10
 sigma_tot[gemm] counter=167 i=0 t=3.4e-04 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=1 t=2.8e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=2 t=1.8e-01 per=2.1e+01 cost=1.2e+09 flops=6.5e+09
 sigma_tot[gemm] counter=167 i=3 t=1.8e-01 per=2.0e+01 cost=1.2e+09 flops=6.5e+09
 sigma_tot[gemm] counter=167 i=4 t=1.8e-01 per=2.0e+01 cost=9.8e+08 flops=5.5e+09
 sigma_tot[gemm] counter=167 i=5 t=1.7e-01 per=1.9e+01 cost=1.0e+09 flops=5.9e+09
 sigma_tot[gemm] counter=167 total t=7.0e-01 per=8.1e+01 cost=4.3e+09 flops=6.1e+09
 sigma_tot[red] counter=167 t=1.1e-01 per=1.2e+01 cost=2.8e+08 flops=2.6e+09
T(sub)=6.4e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-05,2.8e-05,3.8e-06,1.0e-05,1.1e-06
    3   0 -    -116.542869819458 -5.375e-05  2.995e-03    3     3  1.977e-02 6.590e-03 4.491e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.238e-05,4.614e-04,3.485e-03,6.781e-04,4.679e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=3.655e-05 speed=8.711e-01GB/S t[comm(inter)]=5.827e-06 speed=5.465e+00GB/S
--- TIMING FOR sigma : t_inter=4.6e-04 t_gemm=3.5e-03 t_reduction=6.8e-04 tot=4.6e-03 ---
 sigma[inter] counter=168 t=4.6e-04 per=1.0e+01 cost=1.7e+07 flops=3.7e+10
 sigma[gemm] counter=168 i=0 t=2.0e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=1 t=1.7e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=2 t=8.8e-04 per=1.9e+01 cost=2.1e+07 flops=2.4e+10
 sigma[gemm] counter=168 i=3 t=8.5e-04 per=1.8e+01 cost=2.1e+07 flops=2.5e+10
 sigma[gemm] counter=168 i=4 t=9.0e-04 per=1.9e+01 cost=1.6e+07 flops=1.8e+10
 sigma[gemm] counter=168 i=5 t=8.6e-04 per=1.9e+01 cost=1.7e+07 flops=1.9e+10
 sigma[gemm] counter=168 total t=3.5e-03 per=7.5e+01 cost=7.5e+07 flops=2.1e+10
 sigma[red] counter=168 t=6.8e-04 per=1.5e+01 cost=3.9e+06 flops=5.8e+09
--- TIMING FOR sigma_tot : t_inter=6.4e-02 t_gemm=7.1e-01 t_reduction=1.1e-01 tot=8.8e-01 ---
 sigma_tot[inter] counter=168 t=6.4e-02 per=7.3e+00 cost=1.3e+09 flops=2.1e+10
 sigma_tot[gemm] counter=168 i=0 t=3.4e-04 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=1 t=2.8e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=2 t=1.8e-01 per=2.1e+01 cost=1.2e+09 flops=6.6e+09
 sigma_tot[gemm] counter=168 i=3 t=1.8e-01 per=2.0e+01 cost=1.2e+09 flops=6.6e+09
 sigma_tot[gemm] counter=168 i=4 t=1.8e-01 per=2.0e+01 cost=1.0e+09 flops=5.6e+09
 sigma_tot[gemm] counter=168 i=5 t=1.7e-01 per=1.9e+01 cost=1.0e+09 flops=6.0e+09
 sigma_tot[gemm] counter=168 total t=7.1e-01 per=8.1e+01 cost=4.4e+09 flops=6.2e+09
 sigma_tot[red] counter=168 t=1.1e-01 per=1.2e+01 cost=2.8e+08 flops=2.6e+09
T(sub)=6.2e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-05,2.6e-05,3.6e-06,1.0e-05,1.1e-06
    4   0 -    -116.542888700432 -1.888e-05  1.674e-03    3     4  2.959e-02 7.398e-03 4.570e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.262e-05,4.581e-04,3.496e-03,6.805e-04,4.689e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=3.704e-05 speed=8.598e-01GB/S t[comm(inter)]=5.585e-06 speed=5.702e+00GB/S
--- TIMING FOR sigma : t_inter=4.6e-04 t_gemm=3.5e-03 t_reduction=6.8e-04 tot=4.6e-03 ---
 sigma[inter] counter=169 t=4.6e-04 per=9.9e+00 cost=1.7e+07 flops=3.7e+10
 sigma[gemm] counter=169 i=0 t=2.0e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=1 t=1.8e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=2 t=8.8e-04 per=1.9e+01 cost=2.1e+07 flops=2.4e+10
 sigma[gemm] counter=169 i=3 t=8.4e-04 per=1.8e+01 cost=2.1e+07 flops=2.5e+10
 sigma[gemm] counter=169 i=4 t=9.2e-04 per=2.0e+01 cost=1.6e+07 flops=1.8e+10
 sigma[gemm] counter=169 i=5 t=8.5e-04 per=1.8e+01 cost=1.7e+07 flops=1.9e+10
 sigma[gemm] counter=169 total t=3.5e-03 per=7.5e+01 cost=7.5e+07 flops=2.1e+10
 sigma[red] counter=169 t=6.8e-04 per=1.5e+01 cost=3.9e+06 flops=5.8e+09
--- TIMING FOR sigma_tot : t_inter=6.5e-02 t_gemm=7.1e-01 t_reduction=1.1e-01 tot=8.8e-01 ---
 sigma_tot[inter] counter=169 t=6.5e-02 per=7.3e+00 cost=1.4e+09 flops=2.1e+10
 sigma_tot[gemm] counter=169 i=0 t=3.4e-04 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=1 t=2.8e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=2 t=1.8e-01 per=2.1e+01 cost=1.2e+09 flops=6.7e+09
 sigma_tot[gemm] counter=169 i=3 t=1.8e-01 per=2.0e+01 cost=1.2e+09 flops=6.7e+09
 sigma_tot[gemm] counter=169 i=4 t=1.8e-01 per=2.0e+01 cost=1.0e+09 flops=5.7e+09
 sigma_tot[gemm] counter=169 i=5 t=1.7e-01 per=1.9e+01 cost=1.0e+09 flops=6.1e+09
 sigma_tot[gemm] counter=169 total t=7.1e-01 per=8.0e+01 cost=4.5e+09 flops=6.3e+09
 sigma_tot[red] counter=169 t=1.1e-01 per=1.2e+01 cost=2.9e+08 flops=2.7e+09
T(sub)=6.2e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-05,2.6e-05,3.5e-06,1.0e-05,1.1e-06
    5   0 -    -116.542893499286 -4.799e-06  6.533e-04    3     5  3.947e-02 7.894e-03 4.619e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.405e-05,4.496e-04,3.573e-03,6.664e-04,4.744e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=3.846e-05 speed=8.280e-01GB/S t[comm(inter)]=5.592e-06 speed=5.695e+00GB/S
--- TIMING FOR sigma : t_inter=4.5e-04 t_gemm=3.6e-03 t_reduction=6.7e-04 tot=4.7e-03 ---
 sigma[inter] counter=170 t=4.5e-04 per=9.6e+00 cost=1.7e+07 flops=3.8e+10
 sigma[gemm] counter=170 i=0 t=2.0e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=1 t=1.8e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=2 t=9.0e-04 per=1.9e+01 cost=2.1e+07 flops=2.3e+10
 sigma[gemm] counter=170 i=3 t=8.8e-04 per=1.9e+01 cost=2.1e+07 flops=2.3e+10
 sigma[gemm] counter=170 i=4 t=9.2e-04 per=2.0e+01 cost=1.6e+07 flops=1.8e+10
 sigma[gemm] counter=170 i=5 t=8.6e-04 per=1.8e+01 cost=1.7e+07 flops=1.9e+10
 sigma[gemm] counter=170 total t=3.6e-03 per=7.6e+01 cost=7.5e+07 flops=2.1e+10
 sigma[red] counter=170 t=6.7e-04 per=1.4e+01 cost=3.9e+06 flops=5.9e+09
--- TIMING FOR sigma_tot : t_inter=6.5e-02 t_gemm=7.1e-01 t_reduction=1.1e-01 tot=8.9e-01 ---
 sigma_tot[inter] counter=170 t=6.5e-02 per=7.3e+00 cost=1.4e+09 flops=2.1e+10
 sigma_tot[gemm] counter=170 i=0 t=3.4e-04 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=1 t=2.8e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=2 t=1.8e-01 per=2.1e+01 cost=1.2e+09 flops=6.8e+09
 sigma_tot[gemm] counter=170 i=3 t=1.8e-01 per=2.0e+01 cost=1.2e+09 flops=6.8e+09
 sigma_tot[gemm] counter=170 i=4 t=1.8e-01 per=2.0e+01 cost=1.0e+09 flops=5.7e+09
 sigma_tot[gemm] counter=170 i=5 t=1.7e-01 per=1.9e+01 cost=1.1e+09 flops=6.1e+09
 sigma_tot[gemm] counter=170 total t=7.1e-01 per=8.0e+01 cost=4.5e+09 flops=6.4e+09
 sigma_tot[red] counter=170 t=1.1e-01 per=1.2e+01 cost=2.9e+08 flops=2.7e+09
T(sub)=6.3e-05 T(gemm/eig/ortho/gemm/axpy)=2.2e-05,2.6e-05,3.4e-06,1.0e-05,1.1e-06
    6   0 -    -116.542894094603 -5.953e-07  2.244e-04    3     6  4.941e-02 8.235e-03 4.661e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.195e-05,4.316e-04,3.512e-03,6.741e-04,4.670e-03
 ndim=2137:1.592e-05GB t[comm(intra)]=3.629e-05 speed=8.774e-01GB/S t[comm(inter)]=5.657e-06 speed=5.629e+00GB/S
--- TIMING FOR sigma : t_inter=4.3e-04 t_gemm=3.5e-03 t_reduction=6.7e-04 tot=4.6e-03 ---
 sigma[inter] counter=171 t=4.3e-04 per=9.3e+00 cost=1.7e+07 flops=4.0e+10
 sigma[gemm] counter=171 i=0 t=1.9e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=1 t=1.8e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=2 t=8.7e-04 per=1.9e+01 cost=2.1e+07 flops=2.4e+10
 sigma[gemm] counter=171 i=3 t=8.6e-04 per=1.9e+01 cost=2.1e+07 flops=2.4e+10
 sigma[gemm] counter=171 i=4 t=9.1e-04 per=2.0e+01 cost=1.6e+07 flops=1.8e+10
 sigma[gemm] counter=171 i=5 t=8.6e-04 per=1.9e+01 cost=1.7e+07 flops=1.9e+10
 sigma[gemm] counter=171 total t=3.5e-03 per=7.6e+01 cost=7.5e+07 flops=2.1e+10
 sigma[red] counter=171 t=6.7e-04 per=1.5e+01 cost=3.9e+06 flops=5.8e+09
--- TIMING FOR sigma_tot : t_inter=6.5e-02 t_gemm=7.2e-01 t_reduction=1.1e-01 tot=8.9e-01 ---
 sigma_tot[inter] counter=171 t=6.5e-02 per=7.3e+00 cost=1.4e+09 flops=2.1e+10
 sigma_tot[gemm] counter=171 i=0 t=3.4e-04 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=1 t=2.8e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=2 t=1.8e-01 per=2.1e+01 cost=1.3e+09 flops=6.9e+09
 sigma_tot[gemm] counter=171 i=3 t=1.8e-01 per=2.0e+01 cost=1.2e+09 flops=6.9e+09
 sigma_tot[gemm] counter=171 i=4 t=1.8e-01 per=2.0e+01 cost=1.0e+09 flops=5.8e+09
 sigma_tot[gemm] counter=171 i=5 t=1.7e-01 per=1.9e+01 cost=1.1e+09 flops=6.2e+09
 sigma_tot[gemm] counter=171 total t=7.2e-01 per=8.0e+01 cost=4.6e+09 flops=6.4e+09
 sigma_tot[red] counter=171 t=1.1e-01 per=1.2e+01 cost=2.9e+08 flops=2.7e+09
T(sub)=6.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,1.5e-05,1.3e-05,1.0e-05,1.1e-06
    7   0 +    -116.542894169549 -7.495e-08  8.940e-05    3     7  5.929e-02 8.469e-03 4.681e-03
TIMING FOR Davidson : 5.931e-02  T(cal/comm/rest)=3.276e-02,8.720e-07,2.655e-02
decomposed t_rest=2.655e-02
 T(sub)    =3.915e-04 per=1.475e+00
 T(precond)=2.584e-02 per=9.732e+01
 T(ortho)  =6.147e-05 per=2.315e-01
 T(xcopy)  =8.481e-06 per=3.194e-02
 T(xnrm2)  =1.006e-05 per=3.790e-02
 T(other)  =2.402e-04 per=9.048e-01
optimized energies: isweep=0 ibond=24 dots=1 e[0]=-116.542894169549 nmvp=7
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.077e+03S Sys:2.811e+00S Total:1.080e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond24.txt
 qbond: qsuper nsym=18 dimAll=308
 (13,-1):35 (13,-3):42 (11,-3):10 (11,-1):10 (12,-2):30 (12,-4):18 (14,-2):46 (15,-1):24 (11,-5):1 (15,-3):21 (14,-4):22 (16,-2):9 (17,-1):3 (13,-5):8 (14,0):15 (12,0):10 (16,0):3 (12,-6):1
timing for divide=1.4e-05
timing for compute=5.0e-04
timing for collect=2.1e-05
----- TMING FOR decimation_genbasis(nkr): 5.4e-04 S T(divide/compute/collect)=1.4e-05,5.0e-04,2.1e-05 -----
decimation summary: 308->74 dwt=+2.220e-16 SvN=2.398e+00
 qbond: qkept nsym=9 dimAll=74
 (15,-3):15 (15,-1):14 (14,-2):11 (13,-1):10 (13,-3):10 (14,-4):7 (16,-2):5 (17,-1):1 (13,-5):1
----- TIMING for decimation_row(nkr): 1.321e-03 S T(decim/select/formRot)=6.210e-04,6.672e-04,3.305e-05 -----
----- TIMING FOR onedot_decimation: 1.680e-03 S T(wf/decim)=2.688e-04,1.411e-03 -----
ctns::oper_renorm coord=(11,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:18 S:22 H:1 A:153 B:171 
        dim(bra,ket)=74,74 size(op)=818:6.241e-03MB size(tot)=165874:1.266e+00MB:1.236e-03GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.077e+03S Sys:2.812e+00S Total:1.080e+03S
----- TIMING FOR symbolic_formulae_renorm with size=365 : 1.211e-02 S -----
rank=0 GPUmem(GB): used=0.00237 (oper)=0.00231
rank=0 GPUmem(GB): used=0.00238 (oper,site)(GB)=0.00231,1.59e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=227
 no. of coefficients=7720:0.0589MB:5.75e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.378e-04 S -----
rank=0 GPUmem(GB): used=0.00244 (oper,site,rinter)=0.00231,1.59e-05,5.75e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00818 S size(rtasks)=365 size(Rlst2)=81 T(Rmu/Rlist)=0.00175,0.00643 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00874 S size(rtasks)=365 size(Rlst)=5549 -----
rank=0 GPUmem(GB): used=0.00244 (oper,site,rinter,batch)=0.00231,1.59e-05,5.75e-05,0.0279 blksize=225 blksize0=225 batchsize=5549
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00229,0.0158,0.00511
--- TIMING FOR renorm : t_inter=2.3e-03 t_gemm=1.6e-02 t_reduction=5.1e-03 tot=2.3e-02 ---
 renorm[inter] counter=25 t=2.3e-03 per=9.9e+00 cost=1.1e+07 flops=4.8e+09
 renorm[gemm] counter=25 i=0 t=1.4e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=1 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=2 t=4.5e-03 per=1.9e+01 cost=2.8e+06 flops=6.1e+08
 renorm[gemm] counter=25 i=3 t=4.3e-03 per=1.8e+01 cost=8.5e+06 flops=2.0e+09
 renorm[gemm] counter=25 i=4 t=1.2e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=5 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=6 t=7.0e-03 per=3.0e+01 cost=1.2e+07 flops=1.6e+09
 renorm[gemm] counter=25 total t=1.6e-02 per=6.8e+01 cost=2.3e+07 flops=1.4e+09
 renorm[red] counter=25 t=5.1e-03 per=2.2e+01 cost=1.1e+06 flops=2.2e+08
--- TIMING FOR renorm_tot : t_inter=2.6e-02 t_gemm=2.4e-01 t_reduction=6.6e-02 tot=3.3e-01 ---
 renorm_tot[inter] counter=25 t=2.6e-02 per=7.7e+00 cost=8.5e+07 flops=3.3e+09
 renorm_tot[gemm] counter=25 i=0 t=3.7e-05 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=25 i=1 t=3.0e-05 per=9.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=25 i=2 t=2.6e-02 per=7.8e+00 cost=8.2e+06 flops=3.2e+08
 renorm_tot[gemm] counter=25 i=3 t=2.4e-02 per=7.3e+00 cost=1.9e+07 flops=7.9e+08
 renorm_tot[gemm] counter=25 i=4 t=4.4e-02 per=1.3e+01 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=25 i=5 t=5.4e-02 per=1.6e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=25 i=6 t=9.4e-02 per=2.8e+01 cost=1.3e+08 flops=1.4e+09
 renorm_tot[gemm] counter=25 total t=2.4e-01 per=7.2e+01 cost=2.4e+08 flops=9.8e+08
 renorm_tot[red] counter=25 t=6.6e-02 per=2.0e+01 cost=1.7e+07 flops=2.5e+08
qops.to_cpu: size(tot)=165874:1.3e+00MB:1.2e-03GB t[to_cpu]=3.1e-04S speed=4.0e+00GB/S
check ||H-H.dagger||=8.088e-14 coord=(11,0) rank=0
ctns::oper_ab2pq coord=(11,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0816 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.078e+03S Sys:2.812e+00S Total:1.080e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=2034:1.552e-02MB:1.515e-05GB
total mem of comb=17719:1.352e-01MB:1.320e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.078e+03S Sys:2.813e+00S Total:1.080e+03S
##### local opt: 4.306e-01 S #####
 T(local opt: fetch) = 3.619e-02 S  per =  8.4  per(accum) = 8.4
 T(local opt: hdiag) = 7.198e-03 S  per = 1.67  per(accum) = 10.1
 T(local opt: dvdsn) = 3.000e-01 S  per = 69.7  per(accum) = 79.7
 T(local opt: decim) = 1.691e-03 S  per = 0.393  per(accum) = 80.1
 T(local opt: guess) = 3.514e-04 S  per = 0.0816  per(accum) = 80.2
 T(local opt: renrm) = 8.242e-02 S  per = 19.1  per(accum) = 99.4
 T(local opt: save ) = 2.772e-03 S  per = 0.644  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.000e-01 S  T(sum) = 2.995e-01 S  per = 9.983e+01
 T(local opt: preprocess                  ) = 1.041e-03 S  per = 0.348  per(accum) = 0.348
 T(local opt: symbolic_formulae           ) = 5.046e-02 S  per = 16.8  per(accum) = 17.2
 T(local opt: hintermediate init          ) = 1.008e-03 S  per = 0.336  per(accum) = 17.5
 T(local opt: preprocess_hformulae_Hxlist ) = 4.025e-02 S  per = 13.4  per(accum) = 31
 T(local opt: hmmtasks init               ) = 1.475e-01 S  per = 49.2  per(accum) = 80.2
 T(local opt: initial guess for dvdson    ) = 1.364e-05 S  per = 0.00455  per(accum) = 80.2
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.246e-02 S  per = 10.8  per(accum) = 91
 T(local opt: dvdson solver [comm(gpu)]   ) = 3.040e-04 S  per = 0.101  per(accum) = 91.1
 T(local opt: dvdson solver [comm(cpu)]   ) = 8.720e-07 S  per = 0.000291  per(accum) = 91.1
 T(local opt: dvdson solver [rest part]   ) = 2.655e-02 S  per = 8.86  per(accum) = 100
Detailed decomposition of T(renrm) = 8.242e-02 S  T(sum) = 8.242e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.394e-04 S  per = 0.291  per(accum) = 0.291
 T(local opt: qops init                    ) = 4.292e-03 S  per = 5.21  per(accum) = 5.5
 T(local opt: symbolic_formulae_renorm     ) = 1.212e-02 S  per = 14.7  per(accum) = 20.2
 T(local opt: allocate qops on gpu         ) = 3.020e-05 S  per = 0.0366  per(accum) = 20.2
 T(local opt: site memcpy cpu2gpu          ) = 2.178e-05 S  per = 0.0264  per(accum) = 20.3
 T(local opt: rintermediate init           ) = 4.498e-04 S  per = 0.546  per(accum) = 20.8
 T(local opt: preprocess_formulae_Rlist2   ) = 8.945e-03 S  per = 10.9  per(accum) = 31.7
 T(local opt: rmmtasks init                ) = 3.194e-02 S  per = 38.8  per(accum) = 70.4
 T(local opt: qops memset on cpu           ) = 3.200e-08 S  per = 3.88e-05  per(accum) = 70.4
 T(local opt: preprocess_renorm_batchGPU   ) = 2.331e-02 S  per = 28.3  per(accum) = 98.7
 T(local opt: reduction of opS & opH [nccl]) = 1.107e-06 S  per = 0.00134  per(accum) = 98.7
 T(local opt: qops memcpy gpu2cpu          ) = 3.256e-04 S  per = 0.395  per(accum) = 99.1
 T(local opt: deallocate cpu and gpu memory) = 1.225e-04 S  per = 0.149  per(accum) = 99.3
 T(local opt: reduction of opS & opH [comm]) = 4.914e-05 S  per = 0.0596  per(accum) = 99.3
 T(local opt: conversion from opAB to opPQ ) = 3.851e-06 S  per = 0.00467  per(accum) = 99.3
 T(local opt: after oper_renorm            ) = 5.650e-04 S  per = 0.686  per(accum) = 100
##### sweep opt: 1.275e+01 S #####
 T(sweep opt: fetch) = 3.541e-01 S  per = 2.78  per(accum) = 2.78
 T(sweep opt: hdiag) = 5.102e-02 S  per =  0.4  per(accum) = 3.18
 T(sweep opt: dvdsn) = 5.823e+00 S  per = 45.7  per(accum) = 48.9
 T(sweep opt: decim) = 3.010e-02 S  per = 0.236  per(accum) = 49.1
 T(sweep opt: guess) = 7.330e-03 S  per = 0.0575  per(accum) = 49.2
 T(sweep opt: renrm) = 6.418e+00 S  per = 50.4  per(accum) = 99.5
 T(sweep opt: save ) = 6.302e-02 S  per = 0.494  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.823e+00 S  T(sum) = 5.365e+00 S  per = 9.214e+01
 T(sweep opt: preprocess                  ) = 1.192e-02 S  per = 0.222  per(accum) = 0.222
 T(sweep opt: symbolic_formulae           ) = 3.730e-01 S  per = 6.95  per(accum) = 7.18
 T(sweep opt: hintermediate init          ) = 8.406e-03 S  per = 0.157  per(accum) = 7.33
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.927e-01 S  per = 7.32  per(accum) = 14.7
 T(sweep opt: hmmtasks init               ) = 2.390e+00 S  per = 44.5  per(accum) = 59.2
 T(sweep opt: initial guess for dvdson    ) = 2.005e-04 S  per = 0.00374  per(accum) = 59.2
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 9.249e-01 S  per = 17.2  per(accum) = 76.4
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 5.897e-03 S  per = 0.11  per(accum) = 76.5
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.212e-05 S  per = 0.000412  per(accum) = 76.5
 T(sweep opt: dvdson solver [rest part]   ) = 1.258e+00 S  per = 23.5  per(accum) = 100
Detailed decomposition of T(renrm) = 6.418e+00 S  T(sum) = 6.418e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.376e-03 S  per = 0.131  per(accum) = 0.131
 T(sweep opt: qops init                    ) = 8.082e-02 S  per = 1.26  per(accum) = 1.39
 T(sweep opt: symbolic_formulae_renorm     ) = 2.755e-01 S  per = 4.29  per(accum) = 5.68
 T(sweep opt: allocate qops on gpu         ) = 2.600e-03 S  per = 0.0405  per(accum) = 5.72
 T(sweep opt: site memcpy cpu2gpu          ) = 5.579e-04 S  per = 0.00869  per(accum) = 5.73
 T(sweep opt: rintermediate init           ) = 1.205e-02 S  per = 0.188  per(accum) = 5.92
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.316e-01 S  per = 3.61  per(accum) = 9.53
 T(sweep opt: rmmtasks init                ) = 8.893e-01 S  per = 13.9  per(accum) = 23.4
 T(sweep opt: qops memset on cpu           ) = 1.310e-06 S  per = 2.04e-05  per(accum) = 23.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.372e-01 S  per = 5.25  per(accum) = 28.6
 T(sweep opt: reduction of opS & opH [nccl]) = 2.659e-05 S  per = 0.000414  per(accum) = 28.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.378e-03 S  per = 0.0526  per(accum) = 28.7
 T(sweep opt: deallocate cpu and gpu memory) = 7.404e-01 S  per = 11.5  per(accum) = 40.2
 T(sweep opt: reduction of opS & opH [comm]) = 1.218e-03 S  per = 0.019  per(accum) = 40.2
 T(sweep opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 59.5  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 1.550e-02 S  per = 0.242  per(accum) = 100
##### global opt: 1.275e+01 S #####
 T(global opt: fetch) = 3.541e-01 S  per = 2.78  per(accum) = 2.78
 T(global opt: hdiag) = 5.102e-02 S  per =  0.4  per(accum) = 3.18
 T(global opt: dvdsn) = 5.823e+00 S  per = 45.7  per(accum) = 48.9
 T(global opt: decim) = 3.010e-02 S  per = 0.236  per(accum) = 49.1
 T(global opt: guess) = 7.330e-03 S  per = 0.0575  per(accum) = 49.2
 T(global opt: renrm) = 6.418e+00 S  per = 50.4  per(accum) = 99.5
 T(global opt: save ) = 6.302e-02 S  per = 0.494  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.823e+00 S  T(sum) = 5.365e+00 S  per = 9.214e+01
 T(global opt: preprocess                  ) = 1.192e-02 S  per = 0.222  per(accum) = 0.222
 T(global opt: symbolic_formulae           ) = 3.730e-01 S  per = 6.95  per(accum) = 7.18
 T(global opt: hintermediate init          ) = 8.406e-03 S  per = 0.157  per(accum) = 7.33
 T(global opt: preprocess_hformulae_Hxlist ) = 3.927e-01 S  per = 7.32  per(accum) = 14.7
 T(global opt: hmmtasks init               ) = 2.390e+00 S  per = 44.5  per(accum) = 59.2
 T(global opt: initial guess for dvdson    ) = 2.005e-04 S  per = 0.00374  per(accum) = 59.2
 T(global opt: dvdson solver [Hx_batchGPU] ) = 9.249e-01 S  per = 17.2  per(accum) = 76.4
 T(global opt: dvdson solver [comm(gpu)]   ) = 5.897e-03 S  per = 0.11  per(accum) = 76.5
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.212e-05 S  per = 0.000412  per(accum) = 76.5
 T(global opt: dvdson solver [rest part]   ) = 1.258e+00 S  per = 23.5  per(accum) = 100
Detailed decomposition of T(renrm) = 6.418e+00 S  T(sum) = 6.418e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.376e-03 S  per = 0.131  per(accum) = 0.131
 T(global opt: qops init                    ) = 8.082e-02 S  per = 1.26  per(accum) = 1.39
 T(global opt: symbolic_formulae_renorm     ) = 2.755e-01 S  per = 4.29  per(accum) = 5.68
 T(global opt: allocate qops on gpu         ) = 2.600e-03 S  per = 0.0405  per(accum) = 5.72
 T(global opt: site memcpy cpu2gpu          ) = 5.579e-04 S  per = 0.00869  per(accum) = 5.73
 T(global opt: rintermediate init           ) = 1.205e-02 S  per = 0.188  per(accum) = 5.92
 T(global opt: preprocess_formulae_Rlist2   ) = 2.316e-01 S  per = 3.61  per(accum) = 9.53
 T(global opt: rmmtasks init                ) = 8.893e-01 S  per = 13.9  per(accum) = 23.4
 T(global opt: qops memset on cpu           ) = 1.310e-06 S  per = 2.04e-05  per(accum) = 23.4
 T(global opt: preprocess_renorm_batchGPU   ) = 3.372e-01 S  per = 5.25  per(accum) = 28.6
 T(global opt: reduction of opS & opH [nccl]) = 2.659e-05 S  per = 0.000414  per(accum) = 28.6
 T(global opt: qops memcpy gpu2cpu          ) = 3.378e-03 S  per = 0.0526  per(accum) = 28.7
 T(global opt: deallocate cpu and gpu memory) = 7.404e-01 S  per = 11.5  per(accum) = 40.2
 T(global opt: reduction of opS & opH [comm]) = 1.218e-03 S  per = 0.019  per(accum) = 40.2
 T(global opt: conversion from opAB to opPQ ) = 3.819e+00 S  per = 59.5  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 1.550e-02 S  per = 0.242  per(accum) = 100

isweep=0 ibond=25/seqsize=34 dots=1 dbond=(9,0)-(10,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.078e+03S Sys:2.813e+00S Total:1.080e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=2034:1.552e-02MB:1.515e-05GB
total mem of comb=17719:1.352e-01MB:1.320e-04GB
ctns::topology::check_partition: (sl,sr,sc)=10,9,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc= 6
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:20 S:20 H:1 P:190 Q:210 
        dim(bra,ket)=73,73 size(op)=613:4.677e-03MB size(tot)=164348:1.254e+00MB:1.224e-03GB
 rqops: oplist=CSHAB nops=C:18 S:22 H:1 A:153 B:171 
        dim(bra,ket)=74,74 size(op)=818:6.241e-03MB size(tot)=165874:1.266e+00MB:1.236e-03GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=332558:2.537e+00MB:2.478e-03GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(10,0) fdel=./scratch/sweep/lop(9,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
wf3(diml,dimr,dimc)=(73,74,4) nnz=2034:1.552e-02MB
qtensor3: wf3 own=1 _data=0x5260da10
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=12 dimAll=73
 (14,2):14 (15,1):10 (14,0):10 (16,2):8 (15,3):7 (16,0):6 (13,1):5 (13,3):4 (14,4):4 (12,2):3 (12,0):1 (16,4):1
 qbond: qcol nsym=9 dimAll=74
 (15,-3):15 (15,-1):14 (14,-2):11 (13,-1):10 (13,-3):10 (14,-4):7 (16,-2):5 (17,-1):1 (13,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=29 nblocks=432 size=2034:1.552e-02MB
### DIAG TIMING: total=4.109e-03 t1=1.294e-05, t2=1.308e-05, t3=3.206e-05, t4=4.021e-03, t5=7.011e-06, t6=2.002e-05, t7=3.412e-06
duration_diagGPU:4.122e-03
duration_diagreduce:4.700e-08
duration_diagtransform:6.664e-06
----- TIMING FOR symbolic_formulae_onedot with size=1635 : 2.670e-02 S -----
rank=0 GPUmem(GB): used=0.00248 (oper)=0.00248
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1635
 no. of hintermediate operators=828
 no. of coefficients=8280:0.0632MB:6.17e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.464e-04 S -----
rank=0 GPUmem(GB): used=0.00254 (oper,hinter)=0.00248,6.17e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0328 S size(H_formulae)=1635 size(Hxlst2)=29 T(Hmu/Hxlist)=0.00386,0.0289 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0362 S size(H_formulae)=1635 size(Hxlst)=33526 -----
rank=0 GPUmem(GB): used=0.143 (oper,hinter,dvdson,batch)=0.00248,6.17e-05,3.03e-05,0.14 blksize=210 blksize0=140 batchsize=33526
ctns::pdvdsonSolver_nkr::solve_iter ndim=2034 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.81e-05,0.000527,0.00461,0.000733,0.00594
 ndim=2034:1.52e-05GB t[comm(intra)]=3.02e-05 speed=1GB/S t[comm(inter)]=7.84e-06 speed=3.87GB/S
--- TIMING FOR sigma : t_inter=5.3e-04 t_gemm=4.6e-03 t_reduction=7.3e-04 tot=5.9e-03 ---
 sigma[inter] counter=172 t=5.3e-04 per=9.0e+00 cost=1.7e+07 flops=3.3e+10
 sigma[gemm] counter=172 i=0 t=1.4e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=1 t=1.1e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=2 t=1.1e-03 per=2.0e+01 cost=2.9e+07 flops=2.5e+10
 sigma[gemm] counter=172 i=3 t=1.2e-03 per=2.0e+01 cost=2.8e+07 flops=2.3e+10
 sigma[gemm] counter=172 i=4 t=1.2e-03 per=2.0e+01 cost=1.7e+07 flops=1.5e+10
 sigma[gemm] counter=172 i=5 t=1.1e-03 per=1.9e+01 cost=1.8e+07 flops=1.6e+10
 sigma[gemm] counter=172 total t=4.6e-03 per=7.9e+01 cost=9.2e+07 flops=2.0e+10
 sigma[red] counter=172 t=7.3e-04 per=1.2e+01 cost=5.3e+06 flops=7.3e+09
--- TIMING FOR sigma_tot : t_inter=6.6e-02 t_gemm=7.2e-01 t_reduction=1.1e-01 tot=9.0e-01 ---
 sigma_tot[inter] counter=172 t=6.6e-02 per=7.4e+00 cost=1.4e+09 flops=2.1e+10
 sigma_tot[gemm] counter=172 i=0 t=3.5e-04 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=1 t=2.9e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=2 t=1.8e-01 per=2.1e+01 cost=1.3e+09 flops=7.0e+09
 sigma_tot[gemm] counter=172 i=3 t=1.8e-01 per=2.0e+01 cost=1.3e+09 flops=7.0e+09
 sigma_tot[gemm] counter=172 i=4 t=1.8e-01 per=2.0e+01 cost=1.1e+09 flops=5.9e+09
 sigma_tot[gemm] counter=172 i=5 t=1.7e-01 per=1.9e+01 cost=1.1e+09 flops=6.3e+09
 sigma_tot[gemm] counter=172 total t=7.2e-01 per=8.0e+01 cost=4.7e+09 flops=6.5e+09
 sigma_tot[red] counter=172 t=1.1e-01 per=1.2e+01 cost=3.0e+08 flops=2.7e+09
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=8.0e-06,6.9e-06,1.9e-06,3.2e-06,1.2e-06
settings: ndim=2034 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.542894169549 -1.117e+03  2.433e-02    1     1  6.077e-03 6.077e-03 6.033e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.304e-05,7.388e-04,5.737e-03,8.048e-04,7.335e-03
 ndim=2034:1.515e-05GB t[comm(intra)]=3.701e-05 speed=8.190e-01GB/S t[comm(inter)]=6.034e-06 speed=5.023e+00GB/S
--- TIMING FOR sigma : t_inter=7.4e-04 t_gemm=5.7e-03 t_reduction=8.0e-04 tot=7.3e-03 ---
 sigma[inter] counter=173 t=7.4e-04 per=1.0e+01 cost=1.7e+07 flops=2.3e+10
 sigma[gemm] counter=173 i=0 t=1.7e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=1 t=1.5e-06 per=2.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=2 t=1.4e-03 per=2.0e+01 cost=2.9e+07 flops=2.0e+10
 sigma[gemm] counter=173 i=3 t=1.6e-03 per=2.2e+01 cost=2.8e+07 flops=1.8e+10
 sigma[gemm] counter=173 i=4 t=1.4e-03 per=2.0e+01 cost=1.7e+07 flops=1.2e+10
 sigma[gemm] counter=173 i=5 t=1.3e-03 per=1.7e+01 cost=1.8e+07 flops=1.4e+10
 sigma[gemm] counter=173 total t=5.7e-03 per=7.9e+01 cost=9.2e+07 flops=1.6e+10
 sigma[red] counter=173 t=8.0e-04 per=1.1e+01 cost=5.3e+06 flops=6.6e+09
--- TIMING FOR sigma_tot : t_inter=6.7e-02 t_gemm=7.3e-01 t_reduction=1.1e-01 tot=9.1e-01 ---
 sigma_tot[inter] counter=173 t=6.7e-02 per=7.4e+00 cost=1.4e+09 flops=2.1e+10
 sigma_tot[gemm] counter=173 i=0 t=3.5e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=1 t=2.9e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=2 t=1.9e-01 per=2.1e+01 cost=1.3e+09 flops=7.1e+09
 sigma_tot[gemm] counter=173 i=3 t=1.8e-01 per=2.0e+01 cost=1.3e+09 flops=7.1e+09
 sigma_tot[gemm] counter=173 i=4 t=1.8e-01 per=2.0e+01 cost=1.1e+09 flops=5.9e+09
 sigma_tot[gemm] counter=173 i=5 t=1.7e-01 per=1.9e+01 cost=1.1e+09 flops=6.3e+09
 sigma_tot[gemm] counter=173 total t=7.3e-01 per=8.0e+01 cost=4.8e+09 flops=6.6e+09
 sigma_tot[red] counter=173 t=1.1e-01 per=1.2e+01 cost=3.0e+08 flops=2.8e+09
T(sub)=6.3e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-05,3.0e-05,4.2e-06,6.8e-06,9.4e-07
    2   0 -    -116.543523215824 -6.290e-04  5.373e-03    2     2  1.865e-02 9.327e-03 6.749e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.197e-05,7.238e-04,5.657e-03,8.223e-04,7.255e-03
 ndim=2034:1.515e-05GB t[comm(intra)]=3.694e-05 speed=8.204e-01GB/S t[comm(inter)]=5.033e-06 speed=6.022e+00GB/S
--- TIMING FOR sigma : t_inter=7.2e-04 t_gemm=5.7e-03 t_reduction=8.2e-04 tot=7.2e-03 ---
 sigma[inter] counter=174 t=7.2e-04 per=1.0e+01 cost=1.7e+07 flops=2.4e+10
 sigma[gemm] counter=174 i=0 t=1.7e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=1 t=1.5e-06 per=2.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=2 t=1.4e-03 per=2.0e+01 cost=2.9e+07 flops=2.0e+10
 sigma[gemm] counter=174 i=3 t=1.6e-03 per=2.2e+01 cost=2.8e+07 flops=1.8e+10
 sigma[gemm] counter=174 i=4 t=1.5e-03 per=2.0e+01 cost=1.7e+07 flops=1.2e+10
 sigma[gemm] counter=174 i=5 t=1.2e-03 per=1.7e+01 cost=1.8e+07 flops=1.5e+10
 sigma[gemm] counter=174 total t=5.7e-03 per=7.9e+01 cost=9.2e+07 flops=1.6e+10
 sigma[red] counter=174 t=8.2e-04 per=1.1e+01 cost=5.3e+06 flops=6.5e+09
--- TIMING FOR sigma_tot : t_inter=6.7e-02 t_gemm=7.3e-01 t_reduction=1.1e-01 tot=9.1e-01 ---
 sigma_tot[inter] counter=174 t=6.7e-02 per=7.4e+00 cost=1.5e+09 flops=2.2e+10
 sigma_tot[gemm] counter=174 i=0 t=3.5e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=1 t=2.9e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=2 t=1.9e-01 per=2.1e+01 cost=1.3e+09 flops=7.2e+09
 sigma_tot[gemm] counter=174 i=3 t=1.8e-01 per=2.0e+01 cost=1.3e+09 flops=7.2e+09
 sigma_tot[gemm] counter=174 i=4 t=1.9e-01 per=2.0e+01 cost=1.1e+09 flops=5.9e+09
 sigma_tot[gemm] counter=174 i=5 t=1.8e-01 per=1.9e+01 cost=1.1e+09 flops=6.4e+09
 sigma_tot[gemm] counter=174 total t=7.3e-01 per=8.0e+01 cost=4.9e+09 flops=6.7e+09
 sigma_tot[red] counter=174 t=1.1e-01 per=1.2e+01 cost=3.1e+08 flops=2.8e+09
T(sub)=5.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.8e-05,3.2e-06,1.0e-05,1.4e-06
    3   0 -    -116.543573392552 -5.018e-05  2.348e-03    3     3  3.075e-02 1.025e-02 6.952e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.047e-05,7.229e-04,5.617e-03,8.127e-04,7.203e-03
 ndim=2034:1.515e-05GB t[comm(intra)]=3.523e-05 speed=8.602e-01GB/S t[comm(inter)]=5.240e-06 speed=5.784e+00GB/S
--- TIMING FOR sigma : t_inter=7.2e-04 t_gemm=5.6e-03 t_reduction=8.1e-04 tot=7.1e-03 ---
 sigma[inter] counter=175 t=7.2e-04 per=1.0e+01 cost=1.7e+07 flops=2.4e+10
 sigma[gemm] counter=175 i=0 t=1.7e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=1 t=1.5e-06 per=2.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=2 t=1.4e-03 per=2.0e+01 cost=2.9e+07 flops=2.0e+10
 sigma[gemm] counter=175 i=3 t=1.5e-03 per=2.1e+01 cost=2.8e+07 flops=1.8e+10
 sigma[gemm] counter=175 i=4 t=1.4e-03 per=2.0e+01 cost=1.7e+07 flops=1.2e+10
 sigma[gemm] counter=175 i=5 t=1.2e-03 per=1.7e+01 cost=1.8e+07 flops=1.4e+10
 sigma[gemm] counter=175 total t=5.6e-03 per=7.9e+01 cost=9.2e+07 flops=1.6e+10
 sigma[red] counter=175 t=8.1e-04 per=1.1e+01 cost=5.3e+06 flops=6.5e+09
--- TIMING FOR sigma_tot : t_inter=6.8e-02 t_gemm=7.4e-01 t_reduction=1.1e-01 tot=9.2e-01 ---
 sigma_tot[inter] counter=175 t=6.8e-02 per=7.4e+00 cost=1.5e+09 flops=2.2e+10
 sigma_tot[gemm] counter=175 i=0 t=3.5e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=1 t=2.9e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=2 t=1.9e-01 per=2.1e+01 cost=1.4e+09 flops=7.3e+09
 sigma_tot[gemm] counter=175 i=3 t=1.9e-01 per=2.0e+01 cost=1.3e+09 flops=7.3e+09
 sigma_tot[gemm] counter=175 i=4 t=1.9e-01 per=2.0e+01 cost=1.1e+09 flops=6.0e+09
 sigma_tot[gemm] counter=175 i=5 t=1.8e-01 per=1.9e+01 cost=1.1e+09 flops=6.4e+09
 sigma_tot[gemm] counter=175 total t=7.4e-01 per=8.0e+01 cost=5.0e+09 flops=6.7e+09
 sigma_tot[red] counter=175 t=1.1e-01 per=1.2e+01 cost=3.1e+08 flops=2.8e+09
T(sub)=5.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,2.6e-05,3.3e-06,9.1e-06,1.0e-06
    4   0 -    -116.543582532992 -9.140e-06  1.027e-03    3     4  4.274e-02 1.069e-02 7.043e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.908e-05,7.238e-04,5.582e-03,7.934e-04,7.148e-03
 ndim=2034:1.515e-05GB t[comm(intra)]=3.411e-05 speed=8.886e-01GB/S t[comm(inter)]=4.973e-06 speed=6.095e+00GB/S
--- TIMING FOR sigma : t_inter=7.2e-04 t_gemm=5.6e-03 t_reduction=7.9e-04 tot=7.1e-03 ---
 sigma[inter] counter=176 t=7.2e-04 per=1.0e+01 cost=1.7e+07 flops=2.4e+10
 sigma[gemm] counter=176 i=0 t=1.7e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=1 t=1.5e-06 per=2.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=2 t=1.4e-03 per=2.0e+01 cost=2.9e+07 flops=2.0e+10
 sigma[gemm] counter=176 i=3 t=1.5e-03 per=2.1e+01 cost=2.8e+07 flops=1.8e+10
 sigma[gemm] counter=176 i=4 t=1.4e-03 per=2.0e+01 cost=1.7e+07 flops=1.2e+10
 sigma[gemm] counter=176 i=5 t=1.2e-03 per=1.7e+01 cost=1.8e+07 flops=1.4e+10
 sigma[gemm] counter=176 total t=5.6e-03 per=7.9e+01 cost=9.2e+07 flops=1.6e+10
 sigma[red] counter=176 t=7.9e-04 per=1.1e+01 cost=5.3e+06 flops=6.7e+09
--- TIMING FOR sigma_tot : t_inter=6.9e-02 t_gemm=7.4e-01 t_reduction=1.1e-01 tot=9.3e-01 ---
 sigma_tot[inter] counter=176 t=6.9e-02 per=7.4e+00 cost=1.5e+09 flops=2.2e+10
 sigma_tot[gemm] counter=176 i=0 t=3.5e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=1 t=2.9e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=2 t=1.9e-01 per=2.1e+01 cost=1.4e+09 flops=7.4e+09
 sigma_tot[gemm] counter=176 i=3 t=1.9e-01 per=2.0e+01 cost=1.4e+09 flops=7.4e+09
 sigma_tot[gemm] counter=176 i=4 t=1.9e-01 per=2.0e+01 cost=1.1e+09 flops=6.0e+09
 sigma_tot[gemm] counter=176 i=5 t=1.8e-01 per=1.9e+01 cost=1.2e+09 flops=6.5e+09
 sigma_tot[gemm] counter=176 total t=7.4e-01 per=8.0e+01 cost=5.1e+09 flops=6.8e+09
 sigma_tot[red] counter=176 t=1.1e-01 per=1.2e+01 cost=3.2e+08 flops=2.8e+09
T(sub)=5.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.5e-05,1.4e-05,9.5e-06,9.9e-07
    5   0 -    -116.543584315609 -1.783e-06  4.122e-04    3     5  5.467e-02 1.093e-02 7.089e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.961e-05,7.320e-04,5.598e-03,7.962e-04,7.176e-03
 ndim=2034:1.515e-05GB t[comm(intra)]=3.448e-05 speed=8.790e-01GB/S t[comm(inter)]=5.129e-06 speed=5.909e+00GB/S
--- TIMING FOR sigma : t_inter=7.3e-04 t_gemm=5.6e-03 t_reduction=8.0e-04 tot=7.1e-03 ---
 sigma[inter] counter=177 t=7.3e-04 per=1.0e+01 cost=1.7e+07 flops=2.4e+10
 sigma[gemm] counter=177 i=0 t=1.7e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=1 t=1.5e-06 per=2.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=2 t=1.4e-03 per=2.0e+01 cost=2.9e+07 flops=2.1e+10
 sigma[gemm] counter=177 i=3 t=1.5e-03 per=2.2e+01 cost=2.8e+07 flops=1.8e+10
 sigma[gemm] counter=177 i=4 t=1.4e-03 per=2.0e+01 cost=1.7e+07 flops=1.2e+10
 sigma[gemm] counter=177 i=5 t=1.2e-03 per=1.7e+01 cost=1.8e+07 flops=1.4e+10
 sigma[gemm] counter=177 total t=5.6e-03 per=7.9e+01 cost=9.2e+07 flops=1.6e+10
 sigma[red] counter=177 t=8.0e-04 per=1.1e+01 cost=5.3e+06 flops=6.7e+09
--- TIMING FOR sigma_tot : t_inter=7.0e-02 t_gemm=7.5e-01 t_reduction=1.1e-01 tot=9.3e-01 ---
 sigma_tot[inter] counter=177 t=7.0e-02 per=7.5e+00 cost=1.5e+09 flops=2.2e+10
 sigma_tot[gemm] counter=177 i=0 t=3.5e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=1 t=2.9e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=2 t=1.9e-01 per=2.1e+01 cost=1.4e+09 flops=7.5e+09
 sigma_tot[gemm] counter=177 i=3 t=1.9e-01 per=2.0e+01 cost=1.4e+09 flops=7.4e+09
 sigma_tot[gemm] counter=177 i=4 t=1.9e-01 per=2.0e+01 cost=1.2e+09 flops=6.1e+09
 sigma_tot[gemm] counter=177 i=5 t=1.8e-01 per=1.9e+01 cost=1.2e+09 flops=6.5e+09
 sigma_tot[gemm] counter=177 total t=7.5e-01 per=8.0e+01 cost=5.2e+09 flops=6.9e+09
 sigma_tot[red] counter=177 t=1.1e-01 per=1.2e+01 cost=3.3e+08 flops=2.9e+09
T(sub)=5.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,2.5e-05,3.1e-06,9.3e-06,1.0e-06
    6   0 -    -116.543584591525 -2.759e-07  1.711e-04    3     6  6.667e-02 1.111e-02 7.124e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.108e-05,7.399e-04,5.613e-03,7.964e-04,7.201e-03
 ndim=2034:1.515e-05GB t[comm(intra)]=3.555e-05 speed=8.525e-01GB/S t[comm(inter)]=5.532e-06 speed=5.479e+00GB/S
--- TIMING FOR sigma : t_inter=7.4e-04 t_gemm=5.6e-03 t_reduction=8.0e-04 tot=7.1e-03 ---
 sigma[inter] counter=178 t=7.4e-04 per=1.0e+01 cost=1.7e+07 flops=2.3e+10
 sigma[gemm] counter=178 i=0 t=1.7e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=1 t=1.5e-06 per=2.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=2 t=1.4e-03 per=2.0e+01 cost=2.9e+07 flops=2.0e+10
 sigma[gemm] counter=178 i=3 t=1.5e-03 per=2.2e+01 cost=2.8e+07 flops=1.8e+10
 sigma[gemm] counter=178 i=4 t=1.4e-03 per=2.0e+01 cost=1.7e+07 flops=1.2e+10
 sigma[gemm] counter=178 i=5 t=1.2e-03 per=1.7e+01 cost=1.8e+07 flops=1.4e+10
 sigma[gemm] counter=178 total t=5.6e-03 per=7.9e+01 cost=9.2e+07 flops=1.6e+10
 sigma[red] counter=178 t=8.0e-04 per=1.1e+01 cost=5.3e+06 flops=6.7e+09
--- TIMING FOR sigma_tot : t_inter=7.0e-02 t_gemm=7.6e-01 t_reduction=1.1e-01 tot=9.4e-01 ---
 sigma_tot[inter] counter=178 t=7.0e-02 per=7.5e+00 cost=1.5e+09 flops=2.2e+10
 sigma_tot[gemm] counter=178 i=0 t=3.6e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=1 t=2.9e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=2 t=1.9e-01 per=2.1e+01 cost=1.5e+09 flops=7.5e+09
 sigma_tot[gemm] counter=178 i=3 t=1.9e-01 per=2.0e+01 cost=1.4e+09 flops=7.5e+09
 sigma_tot[gemm] counter=178 i=4 t=1.9e-01 per=2.0e+01 cost=1.2e+09 flops=6.1e+09
 sigma_tot[gemm] counter=178 i=5 t=1.8e-01 per=1.9e+01 cost=1.2e+09 flops=6.6e+09
 sigma_tot[gemm] counter=178 total t=7.6e-01 per=8.0e+01 cost=5.3e+09 flops=7.0e+09
 sigma_tot[red] counter=178 t=1.1e-01 per=1.2e+01 cost=3.3e+08 flops=2.9e+09
T(sub)=5.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.5e-05,1.3e-05,9.2e-06,1.0e-06
    7   0 +    -116.543584635644 -4.412e-08  7.485e-05    3     7  7.866e-02 1.124e-02 7.152e-03
TIMING FOR Davidson : 7.869e-02  T(cal/comm/rest)=5.006e-02,8.140e-07,2.862e-02
decomposed t_rest=2.862e-02
 T(sub)    =3.618e-04 per=1.264e+00
 T(precond)=2.799e-02 per=9.779e+01
 T(ortho)  =6.794e-05 per=2.374e-01
 T(xcopy)  =1.966e-05 per=6.868e-02
 T(xnrm2)  =1.788e-05 per=6.248e-02
 T(other)  =1.647e-04 per=5.753e-01
optimized energies: isweep=0 ibond=25 dots=1 e[0]=-116.543584635644 nmvp=7
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.086e+03S Sys:2.819e+00S Total:1.089e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond25.txt
 qbond: qsuper nsym=18 dimAll=296
 (15,-3):43 (15,-1):35 (14,-2):31 (13,-1):10 (13,-3):10 (14,-4):18 (16,-2):45 (17,-1):20 (13,-5):1 (17,-3):20 (16,-4):22 (18,-2):6 (19,-1):1 (15,-5):8 (16,0):14 (14,0):10 (18,0):1 (14,-6):1
timing for divide=1.6e-05
timing for compute=5.1e-04
timing for collect=2.3e-05
----- TMING FOR decimation_genbasis(nkr): 5.5e-04 S T(divide/compute/collect)=1.6e-05,5.1e-04,2.3e-05 -----
decimation summary: 296->73 dwt=+2.220e-16 SvN=2.275e+00
 qbond: qkept nsym=12 dimAll=73
 (16,-2):14 (15,-1):10 (16,0):10 (14,-2):8 (15,-3):7 (14,0):6 (17,-1):5 (17,-3):4 (16,-4):4 (18,-2):3 (14,-4):1 (18,0):1
----- TIMING for decimation_row(nkr): 1.406e-03 S T(decim/select/formRot)=6.495e-04,7.150e-04,4.172e-05 -----
----- TIMING FOR onedot_decimation: 1.732e-03 S T(wf/decim)=2.295e-04,1.502e-03 -----
ctns::oper_renorm coord=(10,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:20 S:20 H:1 A:190 B:210 
        dim(bra,ket)=73,73 size(op)=613:4.677e-03MB size(tot)=164348:1.254e+00MB:1.224e-03GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.086e+03S Sys:2.819e+00S Total:1.089e+03S
----- TIMING FOR symbolic_formulae_renorm with size=441 : 1.370e-02 S -----
rank=0 GPUmem(GB): used=0.00254 (oper)=0.00248
rank=0 GPUmem(GB): used=0.00255 (oper,site)(GB)=0.00248,1.52e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=441
 no. of rintermediate operators=207
 no. of coefficients=8802:0.0672MB:6.56e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.400e-04 S -----
rank=0 GPUmem(GB): used=0.00262 (oper,site,rinter)=0.00248,1.52e-05,6.56e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.011 S size(rtasks)=441 size(Rlst2)=144 T(Rmu/Rlist)=0.00185,0.00913 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.012 S size(rtasks)=441 size(Rlst)=8572 -----
rank=0 GPUmem(GB): used=0.00262 (oper,site,rinter,batch)=0.00248,1.52e-05,6.56e-05,0.0413 blksize=210 blksize0=225 batchsize=8572
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00283,0.0264,0.00711
--- TIMING FOR renorm : t_inter=2.8e-03 t_gemm=2.6e-02 t_reduction=7.1e-03 tot=3.6e-02 ---
 renorm[inter] counter=26 t=2.8e-03 per=7.8e+00 cost=1.8e+07 flops=6.5e+09
 renorm[gemm] counter=26 i=0 t=1.3e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=1 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=2 t=7.3e-03 per=2.0e+01 cost=2.7e+06 flops=3.7e+08
 renorm[gemm] counter=26 i=3 t=7.5e-03 per=2.1e+01 cost=1.1e+07 flops=1.4e+09
 renorm[gemm] counter=26 i=4 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=6 t=1.2e-02 per=3.2e+01 cost=1.1e+07 flops=9.2e+08
 renorm[gemm] counter=26 total t=2.6e-02 per=7.3e+01 cost=2.4e+07 flops=9.1e+08
 renorm[red] counter=26 t=7.1e-03 per=2.0e+01 cost=9.8e+05 flops=1.4e+08
--- TIMING FOR renorm_tot : t_inter=2.9e-02 t_gemm=2.7e-01 t_reduction=7.4e-02 tot=3.7e-01 ---
 renorm_tot[inter] counter=26 t=2.9e-02 per=7.8e+00 cost=1.0e+08 flops=3.6e+09
 renorm_tot[gemm] counter=26 i=0 t=3.8e-05 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=26 i=1 t=3.1e-05 per=8.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=26 i=2 t=3.3e-02 per=9.0e+00 cost=1.1e+07 flops=3.3e+08
 renorm_tot[gemm] counter=26 i=3 t=3.2e-02 per=8.6e+00 cost=3.0e+07 flops=9.3e+08
 renorm_tot[gemm] counter=26 i=4 t=4.4e-02 per=1.2e+01 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=26 i=5 t=5.4e-02 per=1.5e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=26 i=6 t=1.1e-01 per=2.8e+01 cost=1.4e+08 flops=1.4e+09
 renorm_tot[gemm] counter=26 total t=2.7e-01 per=7.2e+01 cost=2.6e+08 flops=9.8e+08
 renorm_tot[red] counter=26 t=7.4e-02 per=2.0e+01 cost=1.7e+07 flops=2.4e+08
qops.to_cpu: size(tot)=164348:1.3e+00MB:1.2e-03GB t[to_cpu]=3.2e-04S speed=3.8e+00GB/S
check ||H-H.dagger||=4.176e-14 coord=(10,0) rank=0
ctns::oper_ab2pq coord=(10,0) superblock=cr ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 3.7 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.00614,3.84e-05,1.76,1.93,0.00077,0.000415 -----
----- TIMING FOR oper_renorm : 0.116 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.481e+03S Sys:3.092e+00S Total:1.485e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1583:1.208e-02MB:1.179e-05GB
total mem of comb=17268:1.317e-01MB:1.287e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.482e+03S Sys:3.093e+00S Total:1.485e+03S
##### local opt: 4.192e+00 S #####
 T(local opt: fetch) = 1.516e-02 S  per = 0.362  per(accum) = 0.362
 T(local opt: hdiag) = 4.201e-03 S  per =  0.1  per(accum) = 0.462
 T(local opt: dvdsn) = 3.517e-01 S  per = 8.39  per(accum) = 8.85
 T(local opt: decim) = 1.743e-03 S  per = 0.0416  per(accum) = 8.89
 T(local opt: guess) = 3.972e-04 S  per = 0.00948  per(accum) = 8.9
 T(local opt: renrm) = 3.815e+00 S  per =   91  per(accum) = 99.9
 T(local opt: save ) = 4.088e-03 S  per = 0.0975  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.517e-01 S  T(sum) = 3.511e-01 S  per = 9.983e+01
 T(local opt: preprocess                  ) = 5.088e-04 S  per = 0.145  per(accum) = 0.145
 T(local opt: symbolic_formulae           ) = 2.672e-02 S  per = 7.61  per(accum) = 7.75
 T(local opt: hintermediate init          ) = 6.651e-04 S  per = 0.189  per(accum) = 7.94
 T(local opt: preprocess_hformulae_Hxlist ) = 3.717e-02 S  per = 10.6  per(accum) = 18.5
 T(local opt: hmmtasks init               ) = 2.074e-01 S  per = 59.1  per(accum) = 77.6
 T(local opt: initial guess for dvdson    ) = 1.373e-05 S  per = 0.00391  per(accum) = 77.6
 T(local opt: dvdson solver [Hx_batchGPU] ) = 4.978e-02 S  per = 14.2  per(accum) = 91.8
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.833e-04 S  per = 0.0807  per(accum) = 91.8
 T(local opt: dvdson solver [comm(cpu)]   ) = 8.140e-07 S  per = 0.000232  per(accum) = 91.8
 T(local opt: dvdson solver [rest part]   ) = 2.862e-02 S  per = 8.15  per(accum) = 100
Detailed decomposition of T(renrm) = 3.815e+00 S  T(sum) = 3.815e+00 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.517e-04 S  per = 0.00922  per(accum) = 0.00922
 T(local opt: qops init                    ) = 7.162e-03 S  per = 0.188  per(accum) = 0.197
 T(local opt: symbolic_formulae_renorm     ) = 1.371e-02 S  per = 0.359  per(accum) = 0.556
 T(local opt: allocate qops on gpu         ) = 2.583e-04 S  per = 0.00677  per(accum) = 0.563
 T(local opt: site memcpy cpu2gpu          ) = 2.422e-05 S  per = 0.000635  per(accum) = 0.564
 T(local opt: rintermediate init           ) = 4.528e-04 S  per = 0.0119  per(accum) = 0.576
 T(local opt: preprocess_formulae_Rlist2   ) = 1.225e-02 S  per = 0.321  per(accum) = 0.897
 T(local opt: rmmtasks init                ) = 4.567e-02 S  per =  1.2  per(accum) = 2.09
 T(local opt: qops memset on cpu           ) = 5.700e-08 S  per = 1.49e-06  per(accum) = 2.09
 T(local opt: preprocess_renorm_batchGPU   ) = 3.643e-02 S  per = 0.955  per(accum) = 3.05
 T(local opt: reduction of opS & opH [nccl]) = 1.092e-06 S  per = 2.86e-05  per(accum) = 3.05
 T(local opt: qops memcpy gpu2cpu          ) = 3.326e-04 S  per = 0.00872  per(accum) = 3.06
 T(local opt: deallocate cpu and gpu memory) = 1.400e-04 S  per = 0.00367  per(accum) = 3.06
 T(local opt: reduction of opS & opH [comm]) = 5.105e-05 S  per = 0.00134  per(accum) = 3.06
 T(local opt: conversion from opAB to opPQ ) = 3.697e+00 S  per = 96.9  per(accum) = 100
 T(local opt: after oper_renorm            ) = 1.111e-03 S  per = 0.0291  per(accum) = 100
##### sweep opt: 1.694e+01 S #####
 T(sweep opt: fetch) = 3.692e-01 S  per = 2.18  per(accum) = 2.18
 T(sweep opt: hdiag) = 5.522e-02 S  per = 0.326  per(accum) = 2.51
 T(sweep opt: dvdsn) = 6.174e+00 S  per = 36.5  per(accum) = 39
 T(sweep opt: decim) = 3.184e-02 S  per = 0.188  per(accum) = 39.1
 T(sweep opt: guess) = 7.727e-03 S  per = 0.0456  per(accum) = 39.2
 T(sweep opt: renrm) = 1.023e+01 S  per = 60.4  per(accum) = 99.6
 T(sweep opt: save ) = 6.711e-02 S  per = 0.396  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.174e+00 S  T(sum) = 5.716e+00 S  per = 9.257e+01
 T(sweep opt: preprocess                  ) = 1.242e-02 S  per = 0.217  per(accum) = 0.217
 T(sweep opt: symbolic_formulae           ) = 3.997e-01 S  per = 6.99  per(accum) = 7.21
 T(sweep opt: hintermediate init          ) = 9.071e-03 S  per = 0.159  per(accum) = 7.37
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.298e-01 S  per = 7.52  per(accum) = 14.9
 T(sweep opt: hmmtasks init               ) = 2.597e+00 S  per = 45.4  per(accum) = 60.3
 T(sweep opt: initial guess for dvdson    ) = 2.142e-04 S  per = 0.00375  per(accum) = 60.3
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 9.747e-01 S  per = 17.1  per(accum) = 77.4
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 6.181e-03 S  per = 0.108  per(accum) = 77.5
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.293e-05 S  per = 0.000401  per(accum) = 77.5
 T(sweep opt: dvdson solver [rest part]   ) = 1.287e+00 S  per = 22.5  per(accum) = 100
Detailed decomposition of T(renrm) = 1.023e+01 S  T(sum) = 1.023e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.727e-03 S  per = 0.0853  per(accum) = 0.0853
 T(sweep opt: qops init                    ) = 8.798e-02 S  per = 0.86  per(accum) = 0.945
 T(sweep opt: symbolic_formulae_renorm     ) = 2.892e-01 S  per = 2.83  per(accum) = 3.77
 T(sweep opt: allocate qops on gpu         ) = 2.859e-03 S  per = 0.0279  per(accum) = 3.8
 T(sweep opt: site memcpy cpu2gpu          ) = 5.822e-04 S  per = 0.00569  per(accum) = 3.81
 T(sweep opt: rintermediate init           ) = 1.251e-02 S  per = 0.122  per(accum) = 3.93
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.438e-01 S  per = 2.38  per(accum) = 6.31
 T(sweep opt: rmmtasks init                ) = 9.350e-01 S  per = 9.14  per(accum) = 15.4
 T(sweep opt: qops memset on cpu           ) = 1.367e-06 S  per = 1.34e-05  per(accum) = 15.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.737e-01 S  per = 3.65  per(accum) = 19.1
 T(sweep opt: reduction of opS & opH [nccl]) = 2.769e-05 S  per = 0.000271  per(accum) = 19.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.710e-03 S  per = 0.0363  per(accum) = 19.1
 T(sweep opt: deallocate cpu and gpu memory) = 7.406e-01 S  per = 7.24  per(accum) = 26.4
 T(sweep opt: reduction of opS & opH [comm]) = 1.269e-03 S  per = 0.0124  per(accum) = 26.4
 T(sweep opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 73.5  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 1.661e-02 S  per = 0.162  per(accum) = 100
##### global opt: 1.694e+01 S #####
 T(global opt: fetch) = 3.692e-01 S  per = 2.18  per(accum) = 2.18
 T(global opt: hdiag) = 5.522e-02 S  per = 0.326  per(accum) = 2.51
 T(global opt: dvdsn) = 6.174e+00 S  per = 36.5  per(accum) = 39
 T(global opt: decim) = 3.184e-02 S  per = 0.188  per(accum) = 39.1
 T(global opt: guess) = 7.727e-03 S  per = 0.0456  per(accum) = 39.2
 T(global opt: renrm) = 1.023e+01 S  per = 60.4  per(accum) = 99.6
 T(global opt: save ) = 6.711e-02 S  per = 0.396  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.174e+00 S  T(sum) = 5.716e+00 S  per = 9.257e+01
 T(global opt: preprocess                  ) = 1.242e-02 S  per = 0.217  per(accum) = 0.217
 T(global opt: symbolic_formulae           ) = 3.997e-01 S  per = 6.99  per(accum) = 7.21
 T(global opt: hintermediate init          ) = 9.071e-03 S  per = 0.159  per(accum) = 7.37
 T(global opt: preprocess_hformulae_Hxlist ) = 4.298e-01 S  per = 7.52  per(accum) = 14.9
 T(global opt: hmmtasks init               ) = 2.597e+00 S  per = 45.4  per(accum) = 60.3
 T(global opt: initial guess for dvdson    ) = 2.142e-04 S  per = 0.00375  per(accum) = 60.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 9.747e-01 S  per = 17.1  per(accum) = 77.4
 T(global opt: dvdson solver [comm(gpu)]   ) = 6.181e-03 S  per = 0.108  per(accum) = 77.5
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.293e-05 S  per = 0.000401  per(accum) = 77.5
 T(global opt: dvdson solver [rest part]   ) = 1.287e+00 S  per = 22.5  per(accum) = 100
Detailed decomposition of T(renrm) = 1.023e+01 S  T(sum) = 1.023e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.727e-03 S  per = 0.0853  per(accum) = 0.0853
 T(global opt: qops init                    ) = 8.798e-02 S  per = 0.86  per(accum) = 0.945
 T(global opt: symbolic_formulae_renorm     ) = 2.892e-01 S  per = 2.83  per(accum) = 3.77
 T(global opt: allocate qops on gpu         ) = 2.859e-03 S  per = 0.0279  per(accum) = 3.8
 T(global opt: site memcpy cpu2gpu          ) = 5.822e-04 S  per = 0.00569  per(accum) = 3.81
 T(global opt: rintermediate init           ) = 1.251e-02 S  per = 0.122  per(accum) = 3.93
 T(global opt: preprocess_formulae_Rlist2   ) = 2.438e-01 S  per = 2.38  per(accum) = 6.31
 T(global opt: rmmtasks init                ) = 9.350e-01 S  per = 9.14  per(accum) = 15.4
 T(global opt: qops memset on cpu           ) = 1.367e-06 S  per = 1.34e-05  per(accum) = 15.4
 T(global opt: preprocess_renorm_batchGPU   ) = 3.737e-01 S  per = 3.65  per(accum) = 19.1
 T(global opt: reduction of opS & opH [nccl]) = 2.769e-05 S  per = 0.000271  per(accum) = 19.1
 T(global opt: qops memcpy gpu2cpu          ) = 3.710e-03 S  per = 0.0363  per(accum) = 19.1
 T(global opt: deallocate cpu and gpu memory) = 7.406e-01 S  per = 7.24  per(accum) = 26.4
 T(global opt: reduction of opS & opH [comm]) = 1.269e-03 S  per = 0.0124  per(accum) = 26.4
 T(global opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 73.5  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 1.661e-02 S  per = 0.162  per(accum) = 100

isweep=0 ibond=26/seqsize=34 dots=1 dbond=(8,0)-(9,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.482e+03S Sys:3.093e+00S Total:1.485e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1583:1.208e-02MB:1.179e-05GB
total mem of comb=17268:1.317e-01MB:1.287e-04GB
ctns::topology::check_partition: (sl,sr,sc)=9,10,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc= 5
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:18 S:22 H:1 A:153 B:171 
        dim(bra,ket)=65,65 size(op)=447:3.410e-03MB size(tot)=102470:7.818e-01MB:7.635e-04GB
 rqops: oplist=CSHPQ nops=C:20 S:20 H:1 P:190 Q:210 
        dim(bra,ket)=73,73 size(op)=613:4.677e-03MB size(tot)=164348:1.254e+00MB:1.224e-03GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=269154:2.053e+00MB:2.005e-03GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(9,0) fdel=./scratch/sweep/lop(8,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
wf3(diml,dimr,dimc)=(65,73,4) nnz=1583:1.208e-02MB
qtensor3: wf3 own=1 _data=0x52dbd980
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=13 dimAll=65
 (13,1):12 (14,0):8 (14,2):7 (13,-1):7 (12,0):6 (15,1):6 (12,2):5 (11,1):4 (13,3):4 (15,-1):3 (11,3):1 (11,-1):1 (15,3):1
 qbond: qcol nsym=12 dimAll=73
 (16,-2):14 (15,-1):10 (16,0):10 (14,-2):8 (15,-3):7 (14,0):6 (17,-1):5 (17,-3):4 (16,-4):4 (18,-2):3 (14,-4):1 (18,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=36 nblocks=624 size=1583:1.208e-02MB
### DIAG TIMING: total=5.590e-03 t1=2.723e-05, t2=3.121e-05, t3=7.127e-05, t4=5.416e-03, t5=1.735e-05, t6=2.244e-05, t7=4.036e-06
duration_diagGPU:5.604e-03
duration_diagreduce:5.500e-08
duration_diagtransform:6.732e-06
----- TIMING FOR symbolic_formulae_onedot with size=1635 : 3.100e-02 S -----
rank=0 GPUmem(GB): used=0.00201 (oper)=0.00201
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1635
 no. of hintermediate operators=828
 no. of coefficients=8280:0.0632MB:6.17e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.657e-04 S -----
rank=0 GPUmem(GB): used=0.00207 (oper,hinter)=0.00201,6.17e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0504 S size(H_formulae)=1635 size(Hxlst2)=36 T(Hmu/Hxlist)=0.00454,0.0459 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0548 S size(H_formulae)=1635 size(Hxlst)=44662 -----
rank=0 GPUmem(GB): used=0.161 (oper,hinter,dvdson,batch)=0.00201,6.17e-05,2.36e-05,0.159 blksize=168 blksize0=140 batchsize=44662
ctns::pdvdsonSolver_nkr::solve_iter ndim=1583 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.36e-05,0.000825,0.0069,0.00109,0.00889
 ndim=1583:1.18e-05GB t[comm(intra)]=3.35e-05 speed=0.704GB/S t[comm(inter)]=1.01e-05 speed=2.34GB/S
--- TIMING FOR sigma : t_inter=8.2e-04 t_gemm=6.9e-03 t_reduction=1.1e-03 tot=8.8e-03 ---
 sigma[inter] counter=179 t=8.2e-04 per=9.4e+00 cost=2.2e+07 flops=2.7e+10
 sigma[gemm] counter=179 i=0 t=1.7e-06 per=2.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=1 t=1.3e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=2 t=1.8e-03 per=2.0e+01 cost=1.5e+07 flops=8.2e+09
 sigma[gemm] counter=179 i=3 t=1.8e-03 per=2.0e+01 cost=1.5e+07 flops=8.4e+09
 sigma[gemm] counter=179 i=4 t=1.7e-03 per=2.0e+01 cost=1.5e+07 flops=8.4e+09
 sigma[gemm] counter=179 i=5 t=1.6e-03 per=1.9e+01 cost=1.5e+07 flops=9.2e+09
 sigma[gemm] counter=179 total t=6.9e-03 per=7.8e+01 cost=5.9e+07 flops=8.6e+09
 sigma[red] counter=179 t=1.1e-03 per=1.2e+01 cost=4.4e+06 flops=4.0e+09
--- TIMING FOR sigma_tot : t_inter=7.1e-02 t_gemm=7.6e-01 t_reduction=1.2e-01 tot=9.5e-01 ---
 sigma_tot[inter] counter=179 t=7.1e-02 per=7.5e+00 cost=1.5e+09 flops=2.2e+10
 sigma_tot[gemm] counter=179 i=0 t=3.6e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=1 t=3.0e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=2 t=2.0e-01 per=2.1e+01 cost=1.5e+09 flops=7.6e+09
 sigma_tot[gemm] counter=179 i=3 t=1.9e-01 per=2.0e+01 cost=1.4e+09 flops=7.5e+09
 sigma_tot[gemm] counter=179 i=4 t=1.9e-01 per=2.0e+01 cost=1.2e+09 flops=6.2e+09
 sigma_tot[gemm] counter=179 i=5 t=1.8e-01 per=1.9e+01 cost=1.2e+09 flops=6.6e+09
 sigma_tot[gemm] counter=179 total t=7.6e-01 per=8.0e+01 cost=5.3e+09 flops=7.0e+09
 sigma_tot[red] counter=179 t=1.2e-01 per=1.2e+01 cost=3.4e+08 flops=2.9e+09
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.0e-05,7.9e-06,2.3e-06,3.3e-06,8.2e-07
settings: ndim=1583 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.543584635644 -1.117e+03  2.706e-02    1     1  9.065e-03 9.065e-03 9.014e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.361e-05,9.337e-04,7.219e-03,1.058e-03,9.266e-03
 ndim=1583:1.179e-05GB t[comm(intra)]=3.500e-05 speed=6.739e-01GB/S t[comm(inter)]=8.606e-06 speed=2.741e+00GB/S
--- TIMING FOR sigma : t_inter=9.3e-04 t_gemm=7.2e-03 t_reduction=1.1e-03 tot=9.2e-03 ---
 sigma[inter] counter=180 t=9.3e-04 per=1.0e+01 cost=2.2e+07 flops=2.4e+10
 sigma[gemm] counter=180 i=0 t=1.7e-06 per=1.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=1 t=1.5e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=2 t=2.0e-03 per=2.2e+01 cost=1.5e+07 flops=7.4e+09
 sigma[gemm] counter=180 i=3 t=2.0e-03 per=2.2e+01 cost=1.5e+07 flops=7.3e+09
 sigma[gemm] counter=180 i=4 t=1.6e-03 per=1.8e+01 cost=1.5e+07 flops=8.8e+09
 sigma[gemm] counter=180 i=5 t=1.6e-03 per=1.7e+01 cost=1.5e+07 flops=9.7e+09
 sigma[gemm] counter=180 total t=7.2e-03 per=7.8e+01 cost=5.9e+07 flops=8.2e+09
 sigma[red] counter=180 t=1.1e-03 per=1.1e+01 cost=4.4e+06 flops=4.2e+09
--- TIMING FOR sigma_tot : t_inter=7.2e-02 t_gemm=7.7e-01 t_reduction=1.2e-01 tot=9.6e-01 ---
 sigma_tot[inter] counter=180 t=7.2e-02 per=7.5e+00 cost=1.6e+09 flops=2.2e+10
 sigma_tot[gemm] counter=180 i=0 t=3.6e-04 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=1 t=3.0e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=2 t=2.0e-01 per=2.1e+01 cost=1.5e+09 flops=7.6e+09
 sigma_tot[gemm] counter=180 i=3 t=1.9e-01 per=2.0e+01 cost=1.5e+09 flops=7.5e+09
 sigma_tot[gemm] counter=180 i=4 t=1.9e-01 per=2.0e+01 cost=1.2e+09 flops=6.2e+09
 sigma_tot[gemm] counter=180 i=5 t=1.8e-01 per=1.9e+01 cost=1.2e+09 flops=6.6e+09
 sigma_tot[gemm] counter=180 total t=7.7e-01 per=8.0e+01 cost=5.4e+09 flops=7.0e+09
 sigma_tot[red] counter=180 t=1.2e-01 per=1.2e+01 cost=3.4e+08 flops=2.9e+09
T(sub)=7.6e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-05,4.4e-05,4.0e-06,6.1e-06,7.6e-07
    2   0 -    -116.544382358972 -7.977e-04  5.789e-03    2     2  2.325e-02 1.163e-02 9.196e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.901e-05,9.146e-04,6.934e-03,9.721e-04,8.870e-03
 ndim=1583:1.179e-05GB t[comm(intra)]=3.372e-05 speed=6.996e-01GB/S t[comm(inter)]=5.291e-06 speed=4.458e+00GB/S
--- TIMING FOR sigma : t_inter=9.1e-04 t_gemm=6.9e-03 t_reduction=9.7e-04 tot=8.8e-03 ---
 sigma[inter] counter=181 t=9.1e-04 per=1.0e+01 cost=2.2e+07 flops=2.5e+10
 sigma[gemm] counter=181 i=0 t=1.7e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=1 t=1.5e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=2 t=1.8e-03 per=2.1e+01 cost=1.5e+07 flops=8.0e+09
 sigma[gemm] counter=181 i=3 t=1.9e-03 per=2.2e+01 cost=1.5e+07 flops=7.7e+09
 sigma[gemm] counter=181 i=4 t=1.7e-03 per=1.9e+01 cost=1.5e+07 flops=8.7e+09
 sigma[gemm] counter=181 i=5 t=1.5e-03 per=1.7e+01 cost=1.5e+07 flops=9.9e+09
 sigma[gemm] counter=181 total t=6.9e-03 per=7.9e+01 cost=5.9e+07 flops=8.5e+09
 sigma[red] counter=181 t=9.7e-04 per=1.1e+01 cost=4.4e+06 flops=4.5e+09
--- TIMING FOR sigma_tot : t_inter=7.3e-02 t_gemm=7.8e-01 t_reduction=1.2e-01 tot=9.7e-01 ---
 sigma_tot[inter] counter=181 t=7.3e-02 per=7.5e+00 cost=1.6e+09 flops=2.2e+10
 sigma_tot[gemm] counter=181 i=0 t=3.6e-04 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=1 t=3.0e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=2 t=2.0e-01 per=2.1e+01 cost=1.5e+09 flops=7.6e+09
 sigma_tot[gemm] counter=181 i=3 t=2.0e-01 per=2.0e+01 cost=1.5e+09 flops=7.5e+09
 sigma_tot[gemm] counter=181 i=4 t=2.0e-01 per=2.0e+01 cost=1.2e+09 flops=6.2e+09
 sigma_tot[gemm] counter=181 i=5 t=1.9e-01 per=1.9e+01 cost=1.2e+09 flops=6.7e+09
 sigma_tot[gemm] counter=181 total t=7.8e-01 per=8.0e+01 cost=5.4e+09 flops=7.0e+09
 sigma_tot[red] counter=181 t=1.2e-01 per=1.2e+01 cost=3.4e+08 flops=2.9e+09
T(sub)=5.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,2.9e-05,3.0e-06,7.5e-06,6.0e-07
    3   0 -    -116.544433265713 -5.091e-05  2.136e-03    3     3  3.696e-02 1.232e-02 9.119e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.871e-05,9.058e-04,6.898e-03,9.817e-04,8.835e-03
 ndim=1583:1.179e-05GB t[comm(intra)]=3.331e-05 speed=7.082e-01GB/S t[comm(inter)]=5.397e-06 speed=4.371e+00GB/S
--- TIMING FOR sigma : t_inter=9.1e-04 t_gemm=6.9e-03 t_reduction=9.8e-04 tot=8.8e-03 ---
 sigma[inter] counter=182 t=9.1e-04 per=1.0e+01 cost=2.2e+07 flops=2.5e+10
 sigma[gemm] counter=182 i=0 t=1.7e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=1 t=1.5e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=2 t=1.8e-03 per=2.1e+01 cost=1.5e+07 flops=8.1e+09
 sigma[gemm] counter=182 i=3 t=1.9e-03 per=2.2e+01 cost=1.5e+07 flops=7.7e+09
 sigma[gemm] counter=182 i=4 t=1.6e-03 per=1.9e+01 cost=1.5e+07 flops=8.8e+09
 sigma[gemm] counter=182 i=5 t=1.5e-03 per=1.7e+01 cost=1.5e+07 flops=9.9e+09
 sigma[gemm] counter=182 total t=6.9e-03 per=7.9e+01 cost=5.9e+07 flops=8.6e+09
 sigma[red] counter=182 t=9.8e-04 per=1.1e+01 cost=4.4e+06 flops=4.5e+09
--- TIMING FOR sigma_tot : t_inter=7.4e-02 t_gemm=7.8e-01 t_reduction=1.2e-01 tot=9.8e-01 ---
 sigma_tot[inter] counter=182 t=7.4e-02 per=7.6e+00 cost=1.6e+09 flops=2.2e+10
 sigma_tot[gemm] counter=182 i=0 t=3.6e-04 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=1 t=3.0e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=2 t=2.0e-01 per=2.1e+01 cost=1.5e+09 flops=7.6e+09
 sigma_tot[gemm] counter=182 i=3 t=2.0e-01 per=2.0e+01 cost=1.5e+09 flops=7.5e+09
 sigma_tot[gemm] counter=182 i=4 t=2.0e-01 per=2.0e+01 cost=1.2e+09 flops=6.2e+09
 sigma_tot[gemm] counter=182 i=5 t=1.9e-01 per=1.9e+01 cost=1.3e+09 flops=6.7e+09
 sigma_tot[gemm] counter=182 total t=7.8e-01 per=8.0e+01 cost=5.5e+09 flops=7.0e+09
 sigma_tot[red] counter=182 t=1.2e-01 per=1.2e+01 cost=3.5e+08 flops=2.9e+09
T(sub)=5.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.4e-05,1.3e-05,8.1e-06,8.7e-07
    4   0 -    -116.544441010307 -7.745e-06  9.325e-04    3     4  5.065e-02 1.266e-02 9.074e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.861e-05,8.988e-04,6.913e-03,1.023e-03,8.884e-03
 ndim=1583:1.179e-05GB t[comm(intra)]=2.337e-05 speed=1.009e+00GB/S t[comm(inter)]=1.524e-05 speed=1.548e+00GB/S
--- TIMING FOR sigma : t_inter=9.0e-04 t_gemm=6.9e-03 t_reduction=1.0e-03 tot=8.8e-03 ---
 sigma[inter] counter=183 t=9.0e-04 per=1.0e+01 cost=2.2e+07 flops=2.5e+10
 sigma[gemm] counter=183 i=0 t=1.7e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=1 t=1.5e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=2 t=1.8e-03 per=2.0e+01 cost=1.5e+07 flops=8.1e+09
 sigma[gemm] counter=183 i=3 t=1.9e-03 per=2.1e+01 cost=1.5e+07 flops=7.8e+09
 sigma[gemm] counter=183 i=4 t=1.7e-03 per=1.9e+01 cost=1.5e+07 flops=8.6e+09
 sigma[gemm] counter=183 i=5 t=1.5e-03 per=1.7e+01 cost=1.5e+07 flops=9.9e+09
 sigma[gemm] counter=183 total t=6.9e-03 per=7.8e+01 cost=5.9e+07 flops=8.5e+09
 sigma[red] counter=183 t=1.0e-03 per=1.2e+01 cost=4.4e+06 flops=4.3e+09
--- TIMING FOR sigma_tot : t_inter=7.5e-02 t_gemm=7.9e-01 t_reduction=1.2e-01 tot=9.9e-01 ---
 sigma_tot[inter] counter=183 t=7.5e-02 per=7.6e+00 cost=1.6e+09 flops=2.2e+10
 sigma_tot[gemm] counter=183 i=0 t=3.6e-04 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=1 t=3.0e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=2 t=2.0e-01 per=2.1e+01 cost=1.5e+09 flops=7.6e+09
 sigma_tot[gemm] counter=183 i=3 t=2.0e-01 per=2.0e+01 cost=1.5e+09 flops=7.5e+09
 sigma_tot[gemm] counter=183 i=4 t=2.0e-01 per=2.0e+01 cost=1.2e+09 flops=6.2e+09
 sigma_tot[gemm] counter=183 i=5 t=1.9e-01 per=1.9e+01 cost=1.3e+09 flops=6.7e+09
 sigma_tot[gemm] counter=183 total t=7.9e-01 per=8.0e+01 cost=5.5e+09 flops=7.0e+09
 sigma_tot[red] counter=183 t=1.2e-01 per=1.2e+01 cost=3.5e+08 flops=2.9e+09
T(sub)=3.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.4e-05,3.1e-06,6.7e-06,5.8e-07
    5   0 -    -116.544442264683 -1.254e-06  3.694e-04    3     5  6.436e-02 1.287e-02 9.057e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.890e-05,9.081e-04,6.899e-03,1.013e-03,8.869e-03
 ndim=1583:1.179e-05GB t[comm(intra)]=3.345e-05 speed=7.052e-01GB/S t[comm(inter)]=5.449e-06 speed=4.329e+00GB/S
--- TIMING FOR sigma : t_inter=9.1e-04 t_gemm=6.9e-03 t_reduction=1.0e-03 tot=8.8e-03 ---
 sigma[inter] counter=184 t=9.1e-04 per=1.0e+01 cost=2.2e+07 flops=2.5e+10
 sigma[gemm] counter=184 i=0 t=1.7e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=1 t=1.5e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=2 t=1.8e-03 per=2.1e+01 cost=1.5e+07 flops=8.1e+09
 sigma[gemm] counter=184 i=3 t=1.9e-03 per=2.2e+01 cost=1.5e+07 flops=7.7e+09
 sigma[gemm] counter=184 i=4 t=1.7e-03 per=1.9e+01 cost=1.5e+07 flops=8.7e+09
 sigma[gemm] counter=184 i=5 t=1.5e-03 per=1.7e+01 cost=1.5e+07 flops=1.0e+10
 sigma[gemm] counter=184 total t=6.9e-03 per=7.8e+01 cost=5.9e+07 flops=8.6e+09
 sigma[red] counter=184 t=1.0e-03 per=1.1e+01 cost=4.4e+06 flops=4.3e+09
--- TIMING FOR sigma_tot : t_inter=7.6e-02 t_gemm=8.0e-01 t_reduction=1.2e-01 tot=9.9e-01 ---
 sigma_tot[inter] counter=184 t=7.6e-02 per=7.6e+00 cost=1.7e+09 flops=2.2e+10
 sigma_tot[gemm] counter=184 i=0 t=3.7e-04 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=1 t=3.0e-04 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=2 t=2.0e-01 per=2.1e+01 cost=1.5e+09 flops=7.6e+09
 sigma_tot[gemm] counter=184 i=3 t=2.0e-01 per=2.0e+01 cost=1.5e+09 flops=7.5e+09
 sigma_tot[gemm] counter=184 i=4 t=2.0e-01 per=2.0e+01 cost=1.3e+09 flops=6.3e+09
 sigma_tot[gemm] counter=184 i=5 t=1.9e-01 per=1.9e+01 cost=1.3e+09 flops=6.8e+09
 sigma_tot[gemm] counter=184 total t=8.0e-01 per=8.0e+01 cost=5.6e+09 flops=7.0e+09
 sigma_tot[red] counter=184 t=1.2e-01 per=1.2e+01 cost=3.6e+08 flops=3.0e+09
T(sub)=3.8e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.4e-05,2.9e-06,6.8e-06,5.6e-07
    6   0 -    -116.544442466094 -2.014e-07  1.477e-04    3     6  7.805e-02 1.301e-02 9.043e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.814e-05,9.287e-04,6.866e-03,1.005e-03,8.849e-03
 ndim=1583:1.179e-05GB t[comm(intra)]=2.285e-05 speed=1.032e+00GB/S t[comm(inter)]=1.529e-05 speed=1.543e+00GB/S
--- TIMING FOR sigma : t_inter=9.3e-04 t_gemm=6.9e-03 t_reduction=1.0e-03 tot=8.8e-03 ---
 sigma[inter] counter=185 t=9.3e-04 per=1.1e+01 cost=2.2e+07 flops=2.4e+10
 sigma[gemm] counter=185 i=0 t=1.7e-06 per=2.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=1 t=1.5e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=2 t=1.8e-03 per=2.1e+01 cost=1.5e+07 flops=8.0e+09
 sigma[gemm] counter=185 i=3 t=1.9e-03 per=2.1e+01 cost=1.5e+07 flops=7.8e+09
 sigma[gemm] counter=185 i=4 t=1.6e-03 per=1.9e+01 cost=1.5e+07 flops=8.9e+09
 sigma[gemm] counter=185 i=5 t=1.5e-03 per=1.7e+01 cost=1.5e+07 flops=1.0e+10
 sigma[gemm] counter=185 total t=6.9e-03 per=7.8e+01 cost=5.9e+07 flops=8.6e+09
 sigma[red] counter=185 t=1.0e-03 per=1.1e+01 cost=4.4e+06 flops=4.4e+09
--- TIMING FOR sigma_tot : t_inter=7.7e-02 t_gemm=8.0e-01 t_reduction=1.2e-01 tot=1.0e+00 ---
 sigma_tot[inter] counter=185 t=7.7e-02 per=7.6e+00 cost=1.7e+09 flops=2.2e+10
 sigma_tot[gemm] counter=185 i=0 t=3.7e-04 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=1 t=3.0e-04 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=2 t=2.1e-01 per=2.1e+01 cost=1.6e+09 flops=7.6e+09
 sigma_tot[gemm] counter=185 i=3 t=2.0e-01 per=2.0e+01 cost=1.5e+09 flops=7.5e+09
 sigma_tot[gemm] counter=185 i=4 t=2.0e-01 per=2.0e+01 cost=1.3e+09 flops=6.3e+09
 sigma_tot[gemm] counter=185 i=5 t=1.9e-01 per=1.9e+01 cost=1.3e+09 flops=6.8e+09
 sigma_tot[gemm] counter=185 total t=8.0e-01 per=8.0e+01 cost=5.7e+09 flops=7.0e+09
 sigma_tot[red] counter=185 t=1.2e-01 per=1.2e+01 cost=3.6e+08 flops=3.0e+09
T(sub)=3.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.4e-05,2.8e-06,6.9e-06,5.6e-07
    7   0 +    -116.544442499872 -3.378e-08  5.693e-05    3     7  9.171e-02 1.310e-02 9.029e-03
TIMING FOR Davidson : 9.172e-02  T(cal/comm/rest)=6.321e-02,7.180e-07,2.852e-02
decomposed t_rest=2.852e-02
 T(sub)    =3.221e-04 per=1.130e+00
 T(precond)=2.796e-02 per=9.804e+01
 T(ortho)  =5.537e-05 per=1.942e-01
 T(xcopy)  =5.275e-06 per=1.850e-02
 T(xnrm2)  =6.246e-06 per=2.190e-02
 T(other)  =1.706e-04 per=5.981e-01
optimized energies: isweep=0 ibond=26 dots=1 e[0]=-116.544442499872 nmvp=7
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.490e+03S Sys:3.128e+00S Total:1.493e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=22 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond26.txt
 qbond: qsuper nsym=22 dimAll=292
 (16,-2):39 (15,-1):24 (16,0):26 (14,-2):8 (15,-3):16 (14,0):6 (17,-1):39 (17,-3):29 (16,-4):12 (18,-2):26 (14,-4):1 (18,0):16 (19,-1):9 (19,-3):7 (18,-4):8 (20,-2):3 (20,0):1 (17,1):10 (15,1):6 (19,1):1 (17,-5):4 (15,-5):1
timing for divide=2.1e-05
timing for compute=3.2e-04
timing for collect=2.0e-05
----- TMING FOR decimation_genbasis(nkr): 3.6e-04 S T(divide/compute/collect)=2.1e-05,3.2e-04,2.0e-05 -----
decimation summary: 292->65 dwt=-2.220e-16 SvN=2.107e+00
 qbond: qkept nsym=13 dimAll=65
 (17,-1):12 (16,0):8 (16,-2):7 (17,1):7 (15,-1):6 (18,0):6 (18,-2):5 (17,-3):4 (19,-1):4 (15,1):3 (15,-3):1 (19,-3):1 (19,1):1
----- TIMING for decimation_row(nkr): 1.031e-03 S T(decim/select/formRot)=4.548e-04,5.336e-04,4.255e-05 -----
----- TIMING FOR onedot_decimation: 1.345e-03 S T(wf/decim)=2.335e-04,1.111e-03 -----
ctns::oper_renorm coord=(9,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:22 S:18 H:1 P:153 Q:171 
        dim(bra,ket)=65,65 size(op)=447:3.410e-03MB size(tot)=102470:7.818e-01MB:7.635e-04GB
CPUmem: VM:2.007e+01GB RSS:1.937e+00GB  Timing: User:1.490e+03S Sys:3.129e+00S Total:1.493e+03S
----- TIMING FOR symbolic_formulae_renorm with size=365 : 2.555e-02 S -----
rank=0 GPUmem(GB): used=0.00207 (oper)=0.00201
rank=0 GPUmem(GB): used=0.00208 (oper,site)(GB)=0.00201,1.18e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=828
 no. of coefficients=8280:0.0632MB:6.17e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.181e-03 S -----
rank=0 GPUmem(GB): used=0.00214 (oper,site,rinter)=0.00201,1.18e-05,6.17e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0266 S size(rtasks)=365 size(Rlst2)=169 T(Rmu/Rlist)=0.00461,0.022 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0296 S size(rtasks)=365 size(Rlst)=22705 -----
rank=0 GPUmem(GB): used=0.00214 (oper,site,rinter,batch)=0.00201,1.18e-05,6.17e-05,0.0807 blksize=168 blksize0=140 batchsize=22705
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00189,0.0298,0.0065
--- TIMING FOR renorm : t_inter=1.9e-03 t_gemm=3.0e-02 t_reduction=6.5e-03 tot=3.8e-02 ---
 renorm[inter] counter=27 t=1.9e-03 per=4.9e+00 cost=1.1e+07 flops=6.0e+09
 renorm[gemm] counter=27 i=0 t=1.6e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=2 t=8.4e-03 per=2.2e+01 cost=5.6e+06 flops=6.6e+08
 renorm[gemm] counter=27 i=3 t=7.7e-03 per=2.0e+01 cost=9.6e+06 flops=1.3e+09
 renorm[gemm] counter=27 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=5 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=6 t=1.4e-02 per=3.6e+01 cost=1.6e+07 flops=1.1e+09
 renorm[gemm] counter=27 total t=3.0e-02 per=7.8e+01 cost=3.1e+07 flops=1.0e+09
 renorm[red] counter=27 t=6.5e-03 per=1.7e+01 cost=1.8e+06 flops=2.7e+08
--- TIMING FOR renorm_tot : t_inter=3.1e-02 t_gemm=3.0e-01 t_reduction=8.0e-02 tot=4.1e-01 ---
 renorm_tot[inter] counter=27 t=3.1e-02 per=7.5e+00 cost=1.1e+08 flops=3.7e+09
 renorm_tot[gemm] counter=27 i=0 t=3.9e-05 per=9.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=27 i=1 t=3.3e-05 per=8.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=27 i=2 t=4.2e-02 per=1.0e+01 cost=1.7e+07 flops=4.0e+08
 renorm_tot[gemm] counter=27 i=3 t=4.0e-02 per=9.7e+00 cost=3.9e+07 flops=1.0e+09
 renorm_tot[gemm] counter=27 i=4 t=4.4e-02 per=1.1e+01 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=27 i=5 t=5.4e-02 per=1.3e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=27 i=6 t=1.2e-01 per=2.9e+01 cost=1.6e+08 flops=1.3e+09
 renorm_tot[gemm] counter=27 total t=3.0e-01 per=7.3e+01 cost=2.9e+08 flops=9.8e+08
 renorm_tot[red] counter=27 t=8.0e-02 per=2.0e+01 cost=1.9e+07 flops=2.4e+08
qops.to_cpu: size(tot)=102470:7.8e-01MB:7.6e-04GB t[to_cpu]=2.4e-04S speed=3.1e+00GB/S
check ||H-H.dagger||=6.781e-14 coord=(9,0) rank=0
ctns::oper_ab2pq coord=(9,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.457 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.490e+03S Sys:3.130e+00S Total:1.493e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1232:9.399e-03MB:9.179e-06GB
total mem of comb=16917:1.291e-01MB:1.260e-04GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.490e+03S Sys:3.133e+00S Total:1.493e+03S
##### local opt: 1.011e+00 S #####
 T(local opt: fetch) = 1.697e-02 S  per = 1.68  per(accum) = 1.68
 T(local opt: hdiag) = 5.715e-03 S  per = 0.565  per(accum) = 2.24
 T(local opt: dvdsn) = 5.167e-01 S  per = 51.1  per(accum) = 53.4
 T(local opt: decim) = 1.354e-03 S  per = 0.134  per(accum) = 53.5
 T(local opt: guess) = 3.348e-04 S  per = 0.0331  per(accum) = 53.5
 T(local opt: renrm) = 4.606e-01 S  per = 45.6  per(accum) = 99.1
 T(local opt: save ) = 9.025e-03 S  per = 0.893  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.167e-01 S  T(sum) = 5.162e-01 S  per = 9.991e+01
 T(local opt: preprocess                  ) = 8.349e-04 S  per = 0.162  per(accum) = 0.162
 T(local opt: symbolic_formulae           ) = 3.102e-02 S  per = 6.01  per(accum) = 6.17
 T(local opt: hintermediate init          ) = 7.868e-04 S  per = 0.152  per(accum) = 6.32
 T(local opt: preprocess_hformulae_Hxlist ) = 5.641e-02 S  per = 10.9  per(accum) = 17.2
 T(local opt: hmmtasks init               ) = 3.355e-01 S  per =   65  per(accum) = 82.2
 T(local opt: initial guess for dvdson    ) = 1.513e-05 S  per = 0.00293  per(accum) = 82.2
 T(local opt: dvdson solver [Hx_batchGPU] ) = 6.293e-02 S  per = 12.2  per(accum) = 94.4
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.806e-04 S  per = 0.0544  per(accum) = 94.5
 T(local opt: dvdson solver [comm(cpu)]   ) = 7.180e-07 S  per = 0.000139  per(accum) = 94.5
 T(local opt: dvdson solver [rest part]   ) = 2.852e-02 S  per = 5.52  per(accum) = 100
Detailed decomposition of T(renrm) = 4.606e-01 S  T(sum) = 4.606e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.412e-04 S  per = 0.0524  per(accum) = 0.0524
 T(local opt: qops init                    ) = 6.528e-03 S  per = 1.42  per(accum) = 1.47
 T(local opt: symbolic_formulae_renorm     ) = 2.556e-02 S  per = 5.55  per(accum) = 7.02
 T(local opt: allocate qops on gpu         ) = 3.403e-05 S  per = 0.00739  per(accum) = 7.03
 T(local opt: site memcpy cpu2gpu          ) = 2.711e-05 S  per = 0.00589  per(accum) = 7.03
 T(local opt: rintermediate init           ) = 1.194e-03 S  per = 0.259  per(accum) = 7.29
 T(local opt: preprocess_formulae_Rlist2   ) = 3.030e-02 S  per = 6.58  per(accum) = 13.9
 T(local opt: rmmtasks init                ) = 1.426e-01 S  per =   31  per(accum) = 44.8
 T(local opt: qops memset on cpu           ) = 5.600e-08 S  per = 1.22e-05  per(accum) = 44.8
 T(local opt: preprocess_renorm_batchGPU   ) = 3.831e-02 S  per = 8.32  per(accum) = 53.1
 T(local opt: reduction of opS & opH [nccl]) = 1.376e-06 S  per = 0.000299  per(accum) = 53.1
 T(local opt: qops memcpy gpu2cpu          ) = 2.497e-04 S  per = 0.0542  per(accum) = 53.2
 T(local opt: deallocate cpu and gpu memory) = 2.119e-01 S  per =   46  per(accum) = 99.2
 T(local opt: reduction of opS & opH [comm]) = 6.467e-05 S  per = 0.014  per(accum) = 99.2
 T(local opt: conversion from opAB to opPQ ) = 5.535e-06 S  per = 0.0012  per(accum) = 99.2
 T(local opt: after oper_renorm            ) = 3.560e-03 S  per = 0.773  per(accum) = 100
##### sweep opt: 1.795e+01 S #####
 T(sweep opt: fetch) = 3.862e-01 S  per = 2.15  per(accum) = 2.15
 T(sweep opt: hdiag) = 6.094e-02 S  per = 0.34  per(accum) = 2.49
 T(sweep opt: dvdsn) = 6.691e+00 S  per = 37.3  per(accum) = 39.8
 T(sweep opt: decim) = 3.319e-02 S  per = 0.185  per(accum) = 40
 T(sweep opt: guess) = 8.062e-03 S  per = 0.0449  per(accum) = 40
 T(sweep opt: renrm) = 1.069e+01 S  per = 59.6  per(accum) = 99.6
 T(sweep opt: save ) = 7.614e-02 S  per = 0.424  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.691e+00 S  T(sum) = 6.232e+00 S  per = 9.314e+01
 T(sweep opt: preprocess                  ) = 1.326e-02 S  per = 0.213  per(accum) = 0.213
 T(sweep opt: symbolic_formulae           ) = 4.307e-01 S  per = 6.91  per(accum) = 7.12
 T(sweep opt: hintermediate init          ) = 9.858e-03 S  per = 0.158  per(accum) = 7.28
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.862e-01 S  per =  7.8  per(accum) = 15.1
 T(sweep opt: hmmtasks init               ) = 2.932e+00 S  per = 47.1  per(accum) = 62.1
 T(sweep opt: initial guess for dvdson    ) = 2.294e-04 S  per = 0.00368  per(accum) = 62.1
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.038e+00 S  per = 16.7  per(accum) = 78.8
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 6.461e-03 S  per = 0.104  per(accum) = 78.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.365e-05 S  per = 0.000379  per(accum) = 78.9
 T(sweep opt: dvdson solver [rest part]   ) = 1.315e+00 S  per = 21.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.069e+01 S  T(sum) = 1.069e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.969e-03 S  per = 0.0839  per(accum) = 0.0839
 T(sweep opt: qops init                    ) = 9.451e-02 S  per = 0.884  per(accum) = 0.968
 T(sweep opt: symbolic_formulae_renorm     ) = 3.148e-01 S  per = 2.94  per(accum) = 3.91
 T(sweep opt: allocate qops on gpu         ) = 2.893e-03 S  per = 0.0271  per(accum) = 3.94
 T(sweep opt: site memcpy cpu2gpu          ) = 6.093e-04 S  per = 0.0057  per(accum) = 3.94
 T(sweep opt: rintermediate init           ) = 1.370e-02 S  per = 0.128  per(accum) = 4.07
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.741e-01 S  per = 2.56  per(accum) = 6.64
 T(sweep opt: rmmtasks init                ) = 1.078e+00 S  per = 10.1  per(accum) = 16.7
 T(sweep opt: qops memset on cpu           ) = 1.423e-06 S  per = 1.33e-05  per(accum) = 16.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.120e-01 S  per = 3.85  per(accum) = 20.6
 T(sweep opt: reduction of opS & opH [nccl]) = 2.906e-05 S  per = 0.000272  per(accum) = 20.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.960e-03 S  per = 0.037  per(accum) = 20.6
 T(sweep opt: deallocate cpu and gpu memory) = 9.525e-01 S  per = 8.91  per(accum) = 29.5
 T(sweep opt: reduction of opS & opH [comm]) = 1.333e-03 S  per = 0.0125  per(accum) = 29.5
 T(sweep opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 70.3  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 2.017e-02 S  per = 0.189  per(accum) = 100
##### global opt: 1.795e+01 S #####
 T(global opt: fetch) = 3.862e-01 S  per = 2.15  per(accum) = 2.15
 T(global opt: hdiag) = 6.094e-02 S  per = 0.34  per(accum) = 2.49
 T(global opt: dvdsn) = 6.691e+00 S  per = 37.3  per(accum) = 39.8
 T(global opt: decim) = 3.319e-02 S  per = 0.185  per(accum) = 40
 T(global opt: guess) = 8.062e-03 S  per = 0.0449  per(accum) = 40
 T(global opt: renrm) = 1.069e+01 S  per = 59.6  per(accum) = 99.6
 T(global opt: save ) = 7.614e-02 S  per = 0.424  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.691e+00 S  T(sum) = 6.232e+00 S  per = 9.314e+01
 T(global opt: preprocess                  ) = 1.326e-02 S  per = 0.213  per(accum) = 0.213
 T(global opt: symbolic_formulae           ) = 4.307e-01 S  per = 6.91  per(accum) = 7.12
 T(global opt: hintermediate init          ) = 9.858e-03 S  per = 0.158  per(accum) = 7.28
 T(global opt: preprocess_hformulae_Hxlist ) = 4.862e-01 S  per =  7.8  per(accum) = 15.1
 T(global opt: hmmtasks init               ) = 2.932e+00 S  per = 47.1  per(accum) = 62.1
 T(global opt: initial guess for dvdson    ) = 2.294e-04 S  per = 0.00368  per(accum) = 62.1
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.038e+00 S  per = 16.7  per(accum) = 78.8
 T(global opt: dvdson solver [comm(gpu)]   ) = 6.461e-03 S  per = 0.104  per(accum) = 78.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.365e-05 S  per = 0.000379  per(accum) = 78.9
 T(global opt: dvdson solver [rest part]   ) = 1.315e+00 S  per = 21.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.069e+01 S  T(sum) = 1.069e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.969e-03 S  per = 0.0839  per(accum) = 0.0839
 T(global opt: qops init                    ) = 9.451e-02 S  per = 0.884  per(accum) = 0.968
 T(global opt: symbolic_formulae_renorm     ) = 3.148e-01 S  per = 2.94  per(accum) = 3.91
 T(global opt: allocate qops on gpu         ) = 2.893e-03 S  per = 0.0271  per(accum) = 3.94
 T(global opt: site memcpy cpu2gpu          ) = 6.093e-04 S  per = 0.0057  per(accum) = 3.94
 T(global opt: rintermediate init           ) = 1.370e-02 S  per = 0.128  per(accum) = 4.07
 T(global opt: preprocess_formulae_Rlist2   ) = 2.741e-01 S  per = 2.56  per(accum) = 6.64
 T(global opt: rmmtasks init                ) = 1.078e+00 S  per = 10.1  per(accum) = 16.7
 T(global opt: qops memset on cpu           ) = 1.423e-06 S  per = 1.33e-05  per(accum) = 16.7
 T(global opt: preprocess_renorm_batchGPU   ) = 4.120e-01 S  per = 3.85  per(accum) = 20.6
 T(global opt: reduction of opS & opH [nccl]) = 2.906e-05 S  per = 0.000272  per(accum) = 20.6
 T(global opt: qops memcpy gpu2cpu          ) = 3.960e-03 S  per = 0.037  per(accum) = 20.6
 T(global opt: deallocate cpu and gpu memory) = 9.525e-01 S  per = 8.91  per(accum) = 29.5
 T(global opt: reduction of opS & opH [comm]) = 1.333e-03 S  per = 0.0125  per(accum) = 29.5
 T(global opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 70.3  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 2.017e-02 S  per = 0.189  per(accum) = 100

isweep=0 ibond=27/seqsize=34 dots=1 dbond=(7,0)-(8,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.490e+03S Sys:3.133e+00S Total:1.493e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1232:9.399e-03MB:9.179e-06GB
total mem of comb=16917:1.291e-01MB:1.260e-04GB
ctns::topology::check_partition: (sl,sr,sc)=8,11,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc= 19
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:16 S:24 H:1 A:120 B:136 
        dim(bra,ket)=57,57 size(op)=361:2.754e-03MB size(tot)=66125:5.045e-01MB:4.927e-04GB
 rqops: oplist=CSHPQ nops=C:22 S:18 H:1 P:153 Q:171 
        dim(bra,ket)=65,65 size(op)=447:3.410e-03MB size(tot)=102470:7.818e-01MB:7.635e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=170931:1.304e+00MB:1.274e-03GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(8,0) fdel=./scratch/sweep/lop(7,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
wf3(diml,dimr,dimc)=(57,65,4) nnz=1232:9.399e-03MB
qtensor3: wf3 own=1 _data=0x52e6eef0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=12 dimAll=57
 (11,1):10 (12,2):8 (12,0):8 (13,1):6 (10,2):5 (10,0):5 (11,3):4 (11,-1):4 (13,-1):3 (9,1):2 (9,3):1 (13,3):1
 qbond: qcol nsym=13 dimAll=65
 (17,-1):12 (16,0):8 (16,-2):7 (17,1):7 (15,-1):6 (18,0):6 (18,-2):5 (17,-3):4 (19,-1):4 (15,1):3 (15,-3):1 (19,-3):1 (19,1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=36 nblocks=624 size=1232:9.399e-03MB
### DIAG TIMING: total=9.011e-03 t1=3.654e-05, t2=3.492e-05, t3=8.567e-05, t4=8.800e-03, t5=1.955e-05, t6=2.649e-05, t7=7.957e-06
duration_diagGPU:9.036e-03
duration_diagreduce:1.610e-07
duration_diagtransform:8.883e-06
----- TIMING FOR symbolic_formulae_onedot with size=1327 : 4.720e-02 S -----
rank=0 GPUmem(GB): used=0.00127 (oper)=0.00127
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1327
 no. of hintermediate operators=664
 no. of coefficients=7304:0.0557MB:5.44e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 9.753e-04 S -----
rank=0 GPUmem(GB): used=0.00133 (oper,hinter)=0.00127,5.44e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0585 S size(H_formulae)=1327 size(Hxlst2)=36 T(Hmu/Hxlist)=0.00584,0.0527 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0628 S size(H_formulae)=1327 size(Hxlst)=36592 -----
rank=0 GPUmem(GB): used=0.0932 (oper,hinter,dvdson,batch)=0.00127,5.44e-05,1.84e-05,0.0919 blksize=120 blksize0=96 batchsize=36592
ctns::pdvdsonSolver_nkr::solve_iter ndim=1232 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.78e-05,0.00205,0.0533,0.00355,0.0589
 ndim=1232:9.18e-06GB t[comm(intra)]=2.86e-05 speed=0.642GB/S t[comm(inter)]=9.21e-06 speed=1.99GB/S
--- TIMING FOR sigma : t_inter=2.0e-03 t_gemm=5.3e-02 t_reduction=3.5e-03 tot=5.9e-02 ---
 sigma[inter] counter=186 t=2.0e-03 per=3.5e+00 cost=1.4e+07 flops=6.9e+09
 sigma[gemm] counter=186 i=0 t=1.4e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=1 t=1.1e-06 per=1.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=2 t=1.3e-02 per=2.3e+01 cost=7.9e+06 flops=5.9e+08
 sigma[gemm] counter=186 i=3 t=1.5e-02 per=2.5e+01 cost=7.8e+06 flops=5.3e+08
 sigma[gemm] counter=186 i=4 t=1.2e-02 per=2.1e+01 cost=8.7e+06 flops=7.1e+08
 sigma[gemm] counter=186 i=5 t=1.3e-02 per=2.2e+01 cost=9.3e+06 flops=7.3e+08
 sigma[gemm] counter=186 total t=5.3e-02 per=9.0e+01 cost=3.4e+07 flops=6.3e+08
 sigma[red] counter=186 t=3.5e-03 per=6.0e+00 cost=2.8e+06 flops=8.0e+08
--- TIMING FOR sigma_tot : t_inter=7.9e-02 t_gemm=8.6e-01 t_reduction=1.3e-01 tot=1.1e+00 ---
 sigma_tot[inter] counter=186 t=7.9e-02 per=7.4e+00 cost=1.7e+09 flops=2.1e+10
 sigma_tot[gemm] counter=186 i=0 t=3.7e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=1 t=3.1e-04 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=2 t=2.2e-01 per=2.1e+01 cost=1.6e+09 flops=7.1e+09
 sigma_tot[gemm] counter=186 i=3 t=2.2e-01 per=2.1e+01 cost=1.5e+09 flops=7.1e+09
 sigma_tot[gemm] counter=186 i=4 t=2.1e-01 per=2.0e+01 cost=1.3e+09 flops=6.0e+09
 sigma_tot[gemm] counter=186 i=5 t=2.0e-01 per=1.9e+01 cost=1.3e+09 flops=6.4e+09
 sigma_tot[gemm] counter=186 total t=8.6e-01 per=8.1e+01 cost=5.7e+09 flops=6.6e+09
 sigma_tot[red] counter=186 t=1.3e-01 per=1.2e+01 cost=3.6e+08 flops=2.9e+09
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=9.1e-06,7.5e-06,2.1e-06,3.3e-06,5.5e-07
settings: ndim=1232 neig=1 maxcycle=30 nbuff=4 memory=0.0001GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.544442499872 -1.117e+03  1.758e-02    1     1  5.907e-02 5.907e-02 5.902e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.629e-05,1.331e-03,8.774e-03,1.138e-03,1.133e-02
 ndim=1232:9.179e-06GB t[comm(intra)]=2.958e-05 speed=6.206e-01GB/S t[comm(inter)]=1.671e-05 speed=1.099e+00GB/S
--- TIMING FOR sigma : t_inter=1.3e-03 t_gemm=8.8e-03 t_reduction=1.1e-03 tot=1.1e-02 ---
 sigma[inter] counter=187 t=1.3e-03 per=1.2e+01 cost=1.4e+07 flops=1.1e+10
 sigma[gemm] counter=187 i=0 t=1.8e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=1 t=1.5e-06 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=2 t=2.3e-03 per=2.0e+01 cost=7.9e+06 flops=3.5e+09
 sigma[gemm] counter=187 i=3 t=2.4e-03 per=2.2e+01 cost=7.8e+06 flops=3.2e+09
 sigma[gemm] counter=187 i=4 t=1.9e-03 per=1.7e+01 cost=8.7e+06 flops=4.5e+09
 sigma[gemm] counter=187 i=5 t=2.1e-03 per=1.9e+01 cost=9.3e+06 flops=4.3e+09
 sigma[gemm] counter=187 total t=8.8e-03 per=7.8e+01 cost=3.4e+07 flops=3.8e+09
 sigma[red] counter=187 t=1.1e-03 per=1.0e+01 cost=2.8e+06 flops=2.5e+09
--- TIMING FOR sigma_tot : t_inter=8.0e-02 t_gemm=8.7e-01 t_reduction=1.3e-01 tot=1.1e+00 ---
 sigma_tot[inter] counter=187 t=8.0e-02 per=7.5e+00 cost=1.7e+09 flops=2.1e+10
 sigma_tot[gemm] counter=187 i=0 t=3.7e-04 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=1 t=3.1e-04 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=2 t=2.2e-01 per=2.1e+01 cost=1.6e+09 flops=7.1e+09
 sigma_tot[gemm] counter=187 i=3 t=2.2e-01 per=2.1e+01 cost=1.6e+09 flops=7.0e+09
 sigma_tot[gemm] counter=187 i=4 t=2.2e-01 per=2.0e+01 cost=1.3e+09 flops=6.0e+09
 sigma_tot[gemm] counter=187 i=5 t=2.1e-01 per=1.9e+01 cost=1.3e+09 flops=6.4e+09
 sigma_tot[gemm] counter=187 total t=8.7e-01 per=8.1e+01 cost=5.7e+09 flops=6.6e+09
 sigma_tot[red] counter=187 t=1.3e-01 per=1.2e+01 cost=3.7e+08 flops=2.9e+09
T(sub)=9.4e-05 T(gemm/eig/ortho/gemm/axpy)=2.5e-05,5.4e-05,5.7e-06,8.9e-06,5.9e-07
    2   0 -    -116.544797620159 -3.551e-04  3.223e-03    2     2  7.555e-02 3.778e-02 3.523e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=6.580e-05,9.348e-04,7.655e-03,1.146e-03,9.813e-03
 ndim=1232:9.179e-06GB t[comm(intra)]=6.031e-05 speed=3.044e-01GB/S t[comm(inter)]=5.486e-06 speed=3.346e+00GB/S
--- TIMING FOR sigma : t_inter=9.3e-04 t_gemm=7.7e-03 t_reduction=1.1e-03 tot=9.7e-03 ---
 sigma[inter] counter=188 t=9.3e-04 per=9.6e+00 cost=1.4e+07 flops=1.5e+10
 sigma[gemm] counter=188 i=0 t=1.7e-06 per=1.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=1 t=1.5e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=2 t=1.9e-03 per=2.0e+01 cost=7.9e+06 flops=4.1e+09
 sigma[gemm] counter=188 i=3 t=2.0e-03 per=2.0e+01 cost=7.8e+06 flops=3.9e+09
 sigma[gemm] counter=188 i=4 t=1.8e-03 per=1.9e+01 cost=8.7e+06 flops=4.7e+09
 sigma[gemm] counter=188 i=5 t=1.9e-03 per=2.0e+01 cost=9.3e+06 flops=4.8e+09
 sigma[gemm] counter=188 total t=7.7e-03 per=7.9e+01 cost=3.4e+07 flops=4.4e+09
 sigma[red] counter=188 t=1.1e-03 per=1.2e+01 cost=2.8e+06 flops=2.5e+09
--- TIMING FOR sigma_tot : t_inter=8.1e-02 t_gemm=8.7e-01 t_reduction=1.3e-01 tot=1.1e+00 ---
 sigma_tot[inter] counter=188 t=8.1e-02 per=7.5e+00 cost=1.7e+09 flops=2.1e+10
 sigma_tot[gemm] counter=188 i=0 t=3.7e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=1 t=3.1e-04 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=2 t=2.2e-01 per=2.1e+01 cost=1.6e+09 flops=7.1e+09
 sigma_tot[gemm] counter=188 i=3 t=2.2e-01 per=2.1e+01 cost=1.6e+09 flops=7.0e+09
 sigma_tot[gemm] counter=188 i=4 t=2.2e-01 per=2.0e+01 cost=1.3e+09 flops=5.9e+09
 sigma_tot[gemm] counter=188 i=5 t=2.1e-01 per=1.9e+01 cost=1.3e+09 flops=6.4e+09
 sigma_tot[gemm] counter=188 total t=8.7e-01 per=8.1e+01 cost=5.8e+09 flops=6.6e+09
 sigma_tot[red] counter=188 t=1.3e-01 per=1.2e+01 cost=3.7e+08 flops=2.9e+09
T(sub)=6.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,3.7e-05,3.3e-06,9.2e-06,5.3e-07
    3   0 -    -116.544814585472 -1.697e-05  1.210e-03    3     3  9.043e-02 3.014e-02 2.680e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.806e-05,9.561e-04,7.648e-03,1.120e-03,9.772e-03
 ndim=1232:9.179e-06GB t[comm(intra)]=3.259e-05 speed=5.634e-01GB/S t[comm(inter)]=5.476e-06 speed=3.352e+00GB/S
--- TIMING FOR sigma : t_inter=9.6e-04 t_gemm=7.6e-03 t_reduction=1.1e-03 tot=9.7e-03 ---
 sigma[inter] counter=189 t=9.6e-04 per=9.8e+00 cost=1.4e+07 flops=1.5e+10
 sigma[gemm] counter=189 i=0 t=1.8e-06 per=1.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=1 t=1.5e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=2 t=1.9e-03 per=2.0e+01 cost=7.9e+06 flops=4.1e+09
 sigma[gemm] counter=189 i=3 t=2.0e-03 per=2.1e+01 cost=7.8e+06 flops=3.9e+09
 sigma[gemm] counter=189 i=4 t=1.8e-03 per=1.9e+01 cost=8.7e+06 flops=4.7e+09
 sigma[gemm] counter=189 i=5 t=1.9e-03 per=2.0e+01 cost=9.3e+06 flops=4.9e+09
 sigma[gemm] counter=189 total t=7.6e-03 per=7.9e+01 cost=3.4e+07 flops=4.4e+09
 sigma[red] counter=189 t=1.1e-03 per=1.2e+01 cost=2.8e+06 flops=2.5e+09
--- TIMING FOR sigma_tot : t_inter=8.2e-02 t_gemm=8.8e-01 t_reduction=1.3e-01 tot=1.1e+00 ---
 sigma_tot[inter] counter=189 t=8.2e-02 per=7.5e+00 cost=1.7e+09 flops=2.1e+10
 sigma_tot[gemm] counter=189 i=0 t=3.7e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=1 t=3.1e-04 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=2 t=2.3e-01 per=2.1e+01 cost=1.6e+09 flops=7.1e+09
 sigma_tot[gemm] counter=189 i=3 t=2.2e-01 per=2.1e+01 cost=1.6e+09 flops=7.0e+09
 sigma_tot[gemm] counter=189 i=4 t=2.2e-01 per=2.0e+01 cost=1.3e+09 flops=5.9e+09
 sigma_tot[gemm] counter=189 i=5 t=2.1e-01 per=1.9e+01 cost=1.3e+09 flops=6.4e+09
 sigma_tot[gemm] counter=189 total t=8.8e-01 per=8.1e+01 cost=5.8e+09 flops=6.6e+09
 sigma_tot[red] counter=189 t=1.3e-01 per=1.2e+01 cost=3.7e+08 flops=2.9e+09
T(sub)=5.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,2.6e-05,3.3e-06,6.0e-06,5.1e-07
    4   0 -    -116.544817078405 -2.493e-06  4.934e-04    3     4  1.052e-01 2.630e-02 2.257e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.989e-05,8.078e-04,6.353e-03,9.033e-04,8.116e-03
 ndim=1232:9.179e-06GB t[comm(intra)]=3.429e-05 speed=5.354e-01GB/S t[comm(inter)]=5.598e-06 speed=3.279e+00GB/S
--- TIMING FOR sigma : t_inter=8.1e-04 t_gemm=6.4e-03 t_reduction=9.0e-04 tot=8.1e-03 ---
 sigma[inter] counter=190 t=8.1e-04 per=1.0e+01 cost=1.4e+07 flops=1.8e+10
 sigma[gemm] counter=190 i=0 t=1.6e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=1 t=1.3e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=2 t=1.6e-03 per=2.0e+01 cost=7.9e+06 flops=5.0e+09
 sigma[gemm] counter=190 i=3 t=1.7e-03 per=2.1e+01 cost=7.8e+06 flops=4.7e+09
 sigma[gemm] counter=190 i=4 t=1.5e-03 per=1.9e+01 cost=8.7e+06 flops=5.6e+09
 sigma[gemm] counter=190 i=5 t=1.6e-03 per=1.9e+01 cost=9.3e+06 flops=6.0e+09
 sigma[gemm] counter=190 total t=6.4e-03 per=7.9e+01 cost=3.4e+07 flops=5.3e+09
 sigma[red] counter=190 t=9.0e-04 per=1.1e+01 cost=2.8e+06 flops=3.2e+09
--- TIMING FOR sigma_tot : t_inter=8.3e-02 t_gemm=8.9e-01 t_reduction=1.3e-01 tot=1.1e+00 ---
 sigma_tot[inter] counter=190 t=8.3e-02 per=7.5e+00 cost=1.7e+09 flops=2.1e+10
 sigma_tot[gemm] counter=190 i=0 t=3.8e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=1 t=3.1e-04 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=2 t=2.3e-01 per=2.1e+01 cost=1.6e+09 flops=7.0e+09
 sigma_tot[gemm] counter=190 i=3 t=2.3e-01 per=2.1e+01 cost=1.6e+09 flops=7.0e+09
 sigma_tot[gemm] counter=190 i=4 t=2.2e-01 per=2.0e+01 cost=1.3e+09 flops=5.9e+09
 sigma_tot[gemm] counter=190 i=5 t=2.1e-01 per=1.9e+01 cost=1.3e+09 flops=6.3e+09
 sigma_tot[gemm] counter=190 total t=8.9e-01 per=8.1e+01 cost=5.8e+09 flops=6.6e+09
 sigma_tot[red] counter=190 t=1.3e-01 per=1.2e+01 cost=3.8e+08 flops=2.9e+09
T(sub)=3.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.3e-05,1.5e-05,2.9e-06,5.2e-06,4.5e-07
    5   0 -    -116.544817448707 -3.703e-07  1.609e-04    3     5  1.229e-01 2.457e-02 1.970e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.924e-05,9.390e-04,7.624e-03,1.121e-03,9.735e-03
 ndim=1232:9.179e-06GB t[comm(intra)]=2.370e-05 speed=7.745e-01GB/S t[comm(inter)]=1.554e-05 speed=1.182e+00GB/S
--- TIMING FOR sigma : t_inter=9.4e-04 t_gemm=7.6e-03 t_reduction=1.1e-03 tot=9.7e-03 ---
 sigma[inter] counter=191 t=9.4e-04 per=9.7e+00 cost=1.4e+07 flops=1.5e+10
 sigma[gemm] counter=191 i=0 t=1.7e-06 per=1.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=1 t=1.4e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=2 t=1.9e-03 per=2.0e+01 cost=7.9e+06 flops=4.1e+09
 sigma[gemm] counter=191 i=3 t=2.0e-03 per=2.0e+01 cost=7.8e+06 flops=4.0e+09
 sigma[gemm] counter=191 i=4 t=1.8e-03 per=1.9e+01 cost=8.7e+06 flops=4.7e+09
 sigma[gemm] counter=191 i=5 t=1.9e-03 per=2.0e+01 cost=9.3e+06 flops=4.9e+09
 sigma[gemm] counter=191 total t=7.6e-03 per=7.9e+01 cost=3.4e+07 flops=4.4e+09
 sigma[red] counter=191 t=1.1e-03 per=1.2e+01 cost=2.8e+06 flops=2.5e+09
--- TIMING FOR sigma_tot : t_inter=8.4e-02 t_gemm=9.0e-01 t_reduction=1.3e-01 tot=1.1e+00 ---
 sigma_tot[inter] counter=191 t=8.4e-02 per=7.5e+00 cost=1.8e+09 flops=2.1e+10
 sigma_tot[gemm] counter=191 i=0 t=3.8e-04 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=1 t=3.1e-04 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=2 t=2.3e-01 per=2.1e+01 cost=1.6e+09 flops=7.0e+09
 sigma_tot[gemm] counter=191 i=3 t=2.3e-01 per=2.1e+01 cost=1.6e+09 flops=6.9e+09
 sigma_tot[gemm] counter=191 i=4 t=2.2e-01 per=2.0e+01 cost=1.3e+09 flops=5.9e+09
 sigma_tot[gemm] counter=191 i=5 t=2.1e-01 per=1.9e+01 cost=1.4e+09 flops=6.3e+09
 sigma_tot[gemm] counter=191 total t=9.0e-01 per=8.1e+01 cost=5.9e+09 flops=6.6e+09
 sigma_tot[red] counter=191 t=1.3e-01 per=1.2e+01 cost=3.8e+08 flops=2.9e+09
T(sub)=4.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.5e-05,1.4e-05,5.9e-06,5.2e-07
    6   0 +    -116.544817486309 -3.760e-08  6.278e-05    3     6  1.376e-01 2.293e-02 1.806e-02
TIMING FOR Davidson : 1.376e-01  T(cal/comm/rest)=1.084e-01,7.820e-07,2.926e-02
decomposed t_rest=2.926e-02
 T(sub)    =3.169e-04 per=1.083e+00
 T(precond)=2.867e-02 per=9.797e+01
 T(ortho)  =8.259e-05 per=2.822e-01
 T(xcopy)  =1.342e-05 per=4.584e-02
 T(xnrm2)  =4.972e-06 per=1.699e-02
 T(other)  =1.752e-04 per=5.986e-01
optimized energies: isweep=0 ibond=27 dots=1 e[0]=-116.544817486309 nmvp=6
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.499e+03S Sys:3.148e+00S Total:1.502e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=24 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond27.txt
 qbond: qsuper nsym=24 dimAll=260
 (17,-1):33 (16,0):17 (16,-2):14 (17,1):18 (15,-1):6 (18,0):33 (18,-2):28 (17,-3):12 (19,-1):27 (15,1):3 (15,-3):1 (19,-3):10 (19,1):14 (20,0):11 (20,-2):10 (21,-1):4 (21,-3):1 (21,1):1 (18,2):7 (16,2):3 (20,2):1 (18,-4):4 (16,-4):1 (20,-4):1
timing for divide=2.0e-05
timing for compute=3.2e-04
timing for collect=1.9e-05
----- TMING FOR decimation_genbasis(nkr): 3.6e-04 S T(divide/compute/collect)=2.0e-05,3.2e-04,1.9e-05 -----
decimation summary: 260->57 dwt=-4.441e-16 SvN=2.062e+00
 qbond: qkept nsym=12 dimAll=57
 (19,-1):10 (18,0):8 (18,-2):8 (17,-1):6 (20,0):5 (20,-2):5 (19,-3):4 (19,1):4 (17,1):3 (21,-1):2 (17,-3):1 (21,-3):1
----- TIMING for decimation_row(nkr): 9.845e-04 S T(decim/select/formRot)=4.633e-04,4.787e-04,4.248e-05 -----
----- TIMING FOR onedot_decimation: 1.322e-03 S T(wf/decim)=2.694e-04,1.053e-03 -----
ctns::oper_renorm coord=(8,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:24 S:16 H:1 P:120 Q:136 
        dim(bra,ket)=57,57 size(op)=361:2.754e-03MB size(tot)=66125:5.045e-01MB:4.927e-04GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.499e+03S Sys:3.148e+00S Total:1.502e+03S
----- TIMING FOR symbolic_formulae_renorm with size=297 : 3.796e-02 S -----
rank=0 GPUmem(GB): used=0.00133 (oper)=0.00127
rank=0 GPUmem(GB): used=0.00134 (oper,site)(GB)=0.00127,9.18e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=664
 no. of coefficients=7304:0.0557MB:5.44e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.660e-03 S -----
rank=0 GPUmem(GB): used=0.00139 (oper,site,rinter)=0.00127,9.18e-06,5.44e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0373 S size(rtasks)=297 size(Rlst2)=144 T(Rmu/Rlist)=0.00628,0.031 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.04 S size(rtasks)=297 size(Rlst)=18714 -----
rank=0 GPUmem(GB): used=0.00139 (oper,site,rinter,batch)=0.00127,9.18e-06,5.44e-05,0.047 blksize=120 blksize0=96 batchsize=18714
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00222,0.0291,0.00479
--- TIMING FOR renorm : t_inter=2.2e-03 t_gemm=2.9e-02 t_reduction=4.8e-03 tot=3.6e-02 ---
 renorm[inter] counter=28 t=2.2e-03 per=6.2e+00 cost=7.1e+06 flops=3.2e+09
 renorm[gemm] counter=28 i=0 t=1.8e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=1 t=1.2e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=2 t=9.2e-03 per=2.6e+01 cost=2.9e+06 flops=3.2e+08
 renorm[gemm] counter=28 i=3 t=5.4e-03 per=1.5e+01 cost=5.3e+06 flops=9.7e+08
 renorm[gemm] counter=28 i=4 t=1.3e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=5 t=1.1e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=6 t=1.4e-02 per=4.0e+01 cost=9.8e+06 flops=6.8e+08
 renorm[gemm] counter=28 total t=2.9e-02 per=8.1e+01 cost=1.8e+07 flops=6.2e+08
 renorm[red] counter=28 t=4.8e-03 per=1.3e+01 cost=1.4e+06 flops=2.9e+08
--- TIMING FOR renorm_tot : t_inter=3.3e-02 t_gemm=3.3e-01 t_reduction=8.5e-02 tot=4.5e-01 ---
 renorm_tot[inter] counter=28 t=3.3e-02 per=7.4e+00 cost=1.2e+08 flops=3.7e+09
 renorm_tot[gemm] counter=28 i=0 t=4.1e-05 per=9.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=28 i=1 t=3.4e-05 per=7.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=28 i=2 t=5.1e-02 per=1.1e+01 cost=1.9e+07 flops=3.8e+08
 renorm_tot[gemm] counter=28 i=3 t=4.5e-02 per=1.0e+01 cost=4.5e+07 flops=9.9e+08
 renorm_tot[gemm] counter=28 i=4 t=4.4e-02 per=9.8e+00 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=28 i=5 t=5.4e-02 per=1.2e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=28 i=6 t=1.3e-01 per=3.0e+01 cost=1.7e+08 flops=1.3e+09
 renorm_tot[gemm] counter=28 total t=3.3e-01 per=7.4e+01 cost=3.1e+08 flops=9.5e+08
 renorm_tot[red] counter=28 t=8.5e-02 per=1.9e+01 cost=2.1e+07 flops=2.4e+08
qops.to_cpu: size(tot)=66125:5.0e-01MB:4.9e-04GB t[to_cpu]=1.4e-04S speed=3.5e+00GB/S
check ||H-H.dagger||=4.670e-14 coord=(8,0) rank=0
ctns::oper_ab2pq coord=(8,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.267 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.499e+03S Sys:3.152e+00S Total:1.502e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=981:7.484e-03MB:7.309e-06GB
total mem of comb=16666:1.272e-01MB:1.242e-04GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.499e+03S Sys:3.152e+00S Total:1.502e+03S
##### local opt: 8.216e-01 S #####
 T(local opt: fetch) = 3.561e-02 S  per = 4.33  per(accum) = 4.33
 T(local opt: hdiag) = 9.274e-03 S  per = 1.13  per(accum) = 5.46
 T(local opt: dvdsn) = 5.016e-01 S  per = 61.1  per(accum) = 66.5
 T(local opt: decim) = 1.332e-03 S  per = 0.162  per(accum) = 66.7
 T(local opt: guess) = 3.088e-04 S  per = 0.0376  per(accum) = 66.7
 T(local opt: renrm) = 2.689e-01 S  per = 32.7  per(accum) = 99.4
 T(local opt: save ) = 4.541e-03 S  per = 0.553  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.016e-01 S  T(sum) = 5.012e-01 S  per = 9.991e+01
 T(local opt: preprocess                  ) = 1.735e-03 S  per = 0.346  per(accum) = 0.346
 T(local opt: symbolic_formulae           ) = 4.722e-02 S  per = 9.42  per(accum) = 9.77
 T(local opt: hintermediate init          ) = 1.005e-03 S  per =  0.2  per(accum) = 9.97
 T(local opt: preprocess_hformulae_Hxlist ) = 6.431e-02 S  per = 12.8  per(accum) = 22.8
 T(local opt: hmmtasks init               ) = 2.493e-01 S  per = 49.7  per(accum) = 72.5
 T(local opt: initial guess for dvdson    ) = 1.202e-05 S  per = 0.0024  per(accum) = 72.5
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.081e-01 S  per = 21.6  per(accum) = 94.1
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.671e-04 S  per = 0.0533  per(accum) = 94.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 7.820e-07 S  per = 0.000156  per(accum) = 94.2
 T(local opt: dvdson solver [rest part]   ) = 2.926e-02 S  per = 5.84  per(accum) = 100
Detailed decomposition of T(renrm) = 2.689e-01 S  T(sum) = 2.689e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.089e-04 S  per = 0.0777  per(accum) = 0.0777
 T(local opt: qops init                    ) = 4.847e-03 S  per =  1.8  per(accum) = 1.88
 T(local opt: symbolic_formulae_renorm     ) = 3.801e-02 S  per = 14.1  per(accum) = 16
 T(local opt: allocate qops on gpu         ) = 8.380e-05 S  per = 0.0312  per(accum) = 16
 T(local opt: site memcpy cpu2gpu          ) = 4.203e-05 S  per = 0.0156  per(accum) = 16.1
 T(local opt: rintermediate init           ) = 1.681e-03 S  per = 0.625  per(accum) = 16.7
 T(local opt: preprocess_formulae_Rlist2   ) = 4.125e-02 S  per = 15.3  per(accum) = 32
 T(local opt: rmmtasks init                ) = 1.441e-01 S  per = 53.6  per(accum) = 85.6
 T(local opt: qops memset on cpu           ) = 2.900e-08 S  per = 1.08e-05  per(accum) = 85.6
 T(local opt: preprocess_renorm_batchGPU   ) = 3.622e-02 S  per = 13.5  per(accum) = 99.1
 T(local opt: reduction of opS & opH [nccl]) = 2.681e-06 S  per = 0.000997  per(accum) = 99.1
 T(local opt: qops memcpy gpu2cpu          ) = 1.496e-04 S  per = 0.0556  per(accum) = 99.1
 T(local opt: deallocate cpu and gpu memory) = 1.901e-04 S  per = 0.0707  per(accum) = 99.2
 T(local opt: reduction of opS & opH [comm]) = 6.343e-05 S  per = 0.0236  per(accum) = 99.2
 T(local opt: conversion from opAB to opPQ ) = 6.879e-06 S  per = 0.00256  per(accum) = 99.2
 T(local opt: after oper_renorm            ) = 2.034e-03 S  per = 0.757  per(accum) = 100
##### sweep opt: 1.877e+01 S #####
 T(sweep opt: fetch) = 4.218e-01 S  per = 2.25  per(accum) = 2.25
 T(sweep opt: hdiag) = 7.021e-02 S  per = 0.374  per(accum) = 2.62
 T(sweep opt: dvdsn) = 7.193e+00 S  per = 38.3  per(accum) = 40.9
 T(sweep opt: decim) = 3.452e-02 S  per = 0.184  per(accum) = 41.1
 T(sweep opt: guess) = 8.371e-03 S  per = 0.0446  per(accum) = 41.2
 T(sweep opt: renrm) = 1.096e+01 S  per = 58.4  per(accum) = 99.6
 T(sweep opt: save ) = 8.068e-02 S  per = 0.43  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.193e+00 S  T(sum) = 6.733e+00 S  per = 9.361e+01
 T(sweep opt: preprocess                  ) = 1.499e-02 S  per = 0.223  per(accum) = 0.223
 T(sweep opt: symbolic_formulae           ) = 4.780e-01 S  per =  7.1  per(accum) = 7.32
 T(sweep opt: hintermediate init          ) = 1.086e-02 S  per = 0.161  per(accum) = 7.48
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.506e-01 S  per = 8.18  per(accum) = 15.7
 T(sweep opt: hmmtasks init               ) = 3.182e+00 S  per = 47.3  per(accum) = 62.9
 T(sweep opt: initial guess for dvdson    ) = 2.414e-04 S  per = 0.00359  per(accum) = 62.9
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.146e+00 S  per =   17  per(accum) = 79.9
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 6.728e-03 S  per = 0.0999  per(accum) = 80
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.443e-05 S  per = 0.000363  per(accum) = 80
 T(sweep opt: dvdson solver [rest part]   ) = 1.344e+00 S  per =   20  per(accum) = 100
Detailed decomposition of T(renrm) = 1.096e+01 S  T(sum) = 1.096e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.177e-03 S  per = 0.0837  per(accum) = 0.0837
 T(sweep opt: qops init                    ) = 9.935e-02 S  per = 0.906  per(accum) = 0.99
 T(sweep opt: symbolic_formulae_renorm     ) = 3.528e-01 S  per = 3.22  per(accum) = 4.21
 T(sweep opt: allocate qops on gpu         ) = 2.977e-03 S  per = 0.0272  per(accum) = 4.24
 T(sweep opt: site memcpy cpu2gpu          ) = 6.513e-04 S  per = 0.00594  per(accum) = 4.24
 T(sweep opt: rintermediate init           ) = 1.538e-02 S  per = 0.14  per(accum) = 4.38
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.154e-01 S  per = 2.88  per(accum) = 7.26
 T(sweep opt: rmmtasks init                ) = 1.222e+00 S  per = 11.1  per(accum) = 18.4
 T(sweep opt: qops memset on cpu           ) = 1.452e-06 S  per = 1.32e-05  per(accum) = 18.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.482e-01 S  per = 4.09  per(accum) = 22.5
 T(sweep opt: reduction of opS & opH [nccl]) = 3.174e-05 S  per = 0.00029  per(accum) = 22.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.110e-03 S  per = 0.0375  per(accum) = 22.5
 T(sweep opt: deallocate cpu and gpu memory) = 9.527e-01 S  per = 8.69  per(accum) = 31.2
 T(sweep opt: reduction of opS & opH [comm]) = 1.397e-03 S  per = 0.0127  per(accum) = 31.2
 T(sweep opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 68.6  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 2.221e-02 S  per = 0.203  per(accum) = 100
##### global opt: 1.877e+01 S #####
 T(global opt: fetch) = 4.218e-01 S  per = 2.25  per(accum) = 2.25
 T(global opt: hdiag) = 7.021e-02 S  per = 0.374  per(accum) = 2.62
 T(global opt: dvdsn) = 7.193e+00 S  per = 38.3  per(accum) = 40.9
 T(global opt: decim) = 3.452e-02 S  per = 0.184  per(accum) = 41.1
 T(global opt: guess) = 8.371e-03 S  per = 0.0446  per(accum) = 41.2
 T(global opt: renrm) = 1.096e+01 S  per = 58.4  per(accum) = 99.6
 T(global opt: save ) = 8.068e-02 S  per = 0.43  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.193e+00 S  T(sum) = 6.733e+00 S  per = 9.361e+01
 T(global opt: preprocess                  ) = 1.499e-02 S  per = 0.223  per(accum) = 0.223
 T(global opt: symbolic_formulae           ) = 4.780e-01 S  per =  7.1  per(accum) = 7.32
 T(global opt: hintermediate init          ) = 1.086e-02 S  per = 0.161  per(accum) = 7.48
 T(global opt: preprocess_hformulae_Hxlist ) = 5.506e-01 S  per = 8.18  per(accum) = 15.7
 T(global opt: hmmtasks init               ) = 3.182e+00 S  per = 47.3  per(accum) = 62.9
 T(global opt: initial guess for dvdson    ) = 2.414e-04 S  per = 0.00359  per(accum) = 62.9
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.146e+00 S  per =   17  per(accum) = 79.9
 T(global opt: dvdson solver [comm(gpu)]   ) = 6.728e-03 S  per = 0.0999  per(accum) = 80
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.443e-05 S  per = 0.000363  per(accum) = 80
 T(global opt: dvdson solver [rest part]   ) = 1.344e+00 S  per =   20  per(accum) = 100
Detailed decomposition of T(renrm) = 1.096e+01 S  T(sum) = 1.096e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.177e-03 S  per = 0.0837  per(accum) = 0.0837
 T(global opt: qops init                    ) = 9.935e-02 S  per = 0.906  per(accum) = 0.99
 T(global opt: symbolic_formulae_renorm     ) = 3.528e-01 S  per = 3.22  per(accum) = 4.21
 T(global opt: allocate qops on gpu         ) = 2.977e-03 S  per = 0.0272  per(accum) = 4.24
 T(global opt: site memcpy cpu2gpu          ) = 6.513e-04 S  per = 0.00594  per(accum) = 4.24
 T(global opt: rintermediate init           ) = 1.538e-02 S  per = 0.14  per(accum) = 4.38
 T(global opt: preprocess_formulae_Rlist2   ) = 3.154e-01 S  per = 2.88  per(accum) = 7.26
 T(global opt: rmmtasks init                ) = 1.222e+00 S  per = 11.1  per(accum) = 18.4
 T(global opt: qops memset on cpu           ) = 1.452e-06 S  per = 1.32e-05  per(accum) = 18.4
 T(global opt: preprocess_renorm_batchGPU   ) = 4.482e-01 S  per = 4.09  per(accum) = 22.5
 T(global opt: reduction of opS & opH [nccl]) = 3.174e-05 S  per = 0.00029  per(accum) = 22.5
 T(global opt: qops memcpy gpu2cpu          ) = 4.110e-03 S  per = 0.0375  per(accum) = 22.5
 T(global opt: deallocate cpu and gpu memory) = 9.527e-01 S  per = 8.69  per(accum) = 31.2
 T(global opt: reduction of opS & opH [comm]) = 1.397e-03 S  per = 0.0127  per(accum) = 31.2
 T(global opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 68.6  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 2.221e-02 S  per = 0.203  per(accum) = 100

isweep=0 ibond=28/seqsize=34 dots=1 dbond=(6,0)-(7,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.499e+03S Sys:3.152e+00S Total:1.502e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=981:7.484e-03MB:7.309e-06GB
total mem of comb=16666:1.272e-01MB:1.242e-04GB
ctns::topology::check_partition: (sl,sr,sc)=7,12,1
 suppl= 0 1 2 3 4 16 17
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 18
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:14 S:26 H:1 A:91 B:105 
        dim(bra,ket)=47,47 size(op)=293:2.235e-03MB size(tot)=39416:3.007e-01MB:2.937e-04GB
 rqops: oplist=CSHPQ nops=C:24 S:16 H:1 P:120 Q:136 
        dim(bra,ket)=57,57 size(op)=361:2.754e-03MB size(tot)=66125:5.045e-01MB:4.927e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=107877:8.230e-01MB:8.037e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(7,0) fdel=./scratch/sweep/lop(6,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
wf3(diml,dimr,dimc)=(47,57,4) nnz=981:7.484e-03MB
qtensor3: wf3 own=1 _data=0x52e613d0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=11 dimAll=47
 (10,2):9 (9,1):8 (10,0):8 (11,1):6 (8,2):4 (9,3):4 (11,-1):3 (8,0):2 (11,3):1 (7,3):1 (9,-1):1
 qbond: qcol nsym=12 dimAll=57
 (19,-1):10 (18,0):8 (18,-2):8 (17,-1):6 (20,0):5 (20,-2):5 (19,-3):4 (19,1):4 (17,1):3 (21,-1):2 (17,-3):1 (21,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=33 nblocks=528 size=981:7.484e-03MB
### DIAG TIMING: total=3.219e-03 t1=1.979e-05, t2=1.676e-05, t3=4.988e-05, t4=3.087e-03, t5=1.893e-05, t6=2.285e-05, t7=3.785e-06
duration_diagGPU:3.232e-03
duration_diagreduce:4.600e-08
duration_diagtransform:4.633e-06
----- TIMING FOR symbolic_formulae_onedot with size=1053 : 2.015e-02 S -----
rank=0 GPUmem(GB): used=0.000804 (oper)=0.000804
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1053
 no. of hintermediate operators=518
 no. of coefficients=6216:0.0474MB:4.63e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.443e-04 S -----
rank=0 GPUmem(GB): used=0.00085 (oper,hinter)=0.000804,4.63e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0288 S size(H_formulae)=1053 size(Hxlst2)=33 T(Hmu/Hxlist)=0.00283,0.026 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0313 S size(H_formulae)=1053 size(Hxlst)=26310 -----
rank=0 GPUmem(GB): used=0.052 (oper,hinter,dvdson,batch)=0.000804,4.63e-05,1.46e-05,0.0512 blksize=90 blksize0=80 batchsize=26310
ctns::pdvdsonSolver_nkr::solve_iter ndim=981 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=5.07e-05,0.00186,0.0428,0.0032,0.0479
 ndim=981:7.31e-06GB t[comm(intra)]=3.84e-05 speed=0.38GB/S t[comm(inter)]=1.23e-05 speed=1.19GB/S
--- TIMING FOR sigma : t_inter=1.9e-03 t_gemm=4.3e-02 t_reduction=3.2e-03 tot=4.8e-02 ---
 sigma[inter] counter=192 t=1.9e-03 per=3.9e+00 cost=9.3e+06 flops=5.0e+09
 sigma[gemm] counter=192 i=0 t=1.7e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=1 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=2 t=1.1e-02 per=2.2e+01 cost=4.5e+06 flops=4.3e+08
 sigma[gemm] counter=192 i=3 t=1.1e-02 per=2.4e+01 cost=4.5e+06 flops=4.0e+08
 sigma[gemm] counter=192 i=4 t=1.0e-02 per=2.1e+01 cost=5.1e+06 flops=5.0e+08
 sigma[gemm] counter=192 i=5 t=1.1e-02 per=2.2e+01 cost=5.4e+06 flops=5.1e+08
 sigma[gemm] counter=192 total t=4.3e-02 per=8.9e+01 cost=2.0e+07 flops=4.6e+08
 sigma[red] counter=192 t=3.2e-03 per=6.7e+00 cost=1.8e+06 flops=5.5e+08
--- TIMING FOR sigma_tot : t_inter=8.6e-02 t_gemm=9.4e-01 t_reduction=1.3e-01 tot=1.2e+00 ---
 sigma_tot[inter] counter=192 t=8.6e-02 per=7.4e+00 cost=1.8e+09 flops=2.1e+10
 sigma_tot[gemm] counter=192 i=0 t=3.8e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=1 t=3.1e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=2 t=2.4e-01 per=2.1e+01 cost=1.6e+09 flops=6.7e+09
 sigma_tot[gemm] counter=192 i=3 t=2.4e-01 per=2.1e+01 cost=1.6e+09 flops=6.6e+09
 sigma_tot[gemm] counter=192 i=4 t=2.3e-01 per=2.0e+01 cost=1.3e+09 flops=5.7e+09
 sigma_tot[gemm] counter=192 i=5 t=2.2e-01 per=1.9e+01 cost=1.4e+09 flops=6.1e+09
 sigma_tot[gemm] counter=192 total t=9.4e-01 per=8.1e+01 cost=5.9e+09 flops=6.3e+09
 sigma_tot[red] counter=192 t=1.3e-01 per=1.2e+01 cost=3.8e+08 flops=2.8e+09
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=9.9e-06,1.0e-05,2.9e-06,3.0e-06,5.6e-07
settings: ndim=981 neig=1 maxcycle=30 nbuff=4 memory=0.0001GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.544817486309 -1.117e+03  1.987e-02    1     1  4.811e-02 4.811e-02 4.803e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.289e-05,5.915e-04,5.804e-03,7.877e-04,7.246e-03
 ndim=981:7.309e-06GB t[comm(intra)]=2.604e-05 speed=5.615e-01GB/S t[comm(inter)]=6.853e-06 speed=2.133e+00GB/S
--- TIMING FOR sigma : t_inter=5.9e-04 t_gemm=5.8e-03 t_reduction=7.9e-04 tot=7.2e-03 ---
 sigma[inter] counter=193 t=5.9e-04 per=8.2e+00 cost=9.3e+06 flops=1.6e+10
 sigma[gemm] counter=193 i=0 t=2.4e-06 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=1 t=1.9e-06 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=2 t=1.5e-03 per=2.1e+01 cost=4.5e+06 flops=3.0e+09
 sigma[gemm] counter=193 i=3 t=1.6e-03 per=2.2e+01 cost=4.5e+06 flops=2.9e+09
 sigma[gemm] counter=193 i=4 t=1.4e-03 per=2.0e+01 cost=5.1e+06 flops=3.6e+09
 sigma[gemm] counter=193 i=5 t=1.3e-03 per=1.8e+01 cost=5.4e+06 flops=4.2e+09
 sigma[gemm] counter=193 total t=5.8e-03 per=8.1e+01 cost=2.0e+07 flops=3.4e+09
 sigma[red] counter=193 t=7.9e-04 per=1.1e+01 cost=1.8e+06 flops=2.2e+09
--- TIMING FOR sigma_tot : t_inter=8.6e-02 t_gemm=9.4e-01 t_reduction=1.3e-01 tot=1.2e+00 ---
 sigma_tot[inter] counter=193 t=8.6e-02 per=7.4e+00 cost=1.8e+09 flops=2.1e+10
 sigma_tot[gemm] counter=193 i=0 t=3.8e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=1 t=3.2e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=2 t=2.4e-01 per=2.1e+01 cost=1.6e+09 flops=6.7e+09
 sigma_tot[gemm] counter=193 i=3 t=2.4e-01 per=2.1e+01 cost=1.6e+09 flops=6.6e+09
 sigma_tot[gemm] counter=193 i=4 t=2.4e-01 per=2.0e+01 cost=1.3e+09 flops=5.7e+09
 sigma_tot[gemm] counter=193 i=5 t=2.3e-01 per=1.9e+01 cost=1.4e+09 flops=6.0e+09
 sigma_tot[gemm] counter=193 total t=9.4e-01 per=8.1e+01 cost=5.9e+09 flops=6.3e+09
 sigma_tot[red] counter=193 t=1.3e-01 per=1.2e+01 cost=3.8e+08 flops=2.8e+09
T(sub)=7.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,3.7e-05,5.4e-06,6.1e-06,5.5e-07
    2   0 -    -116.545249450334 -4.320e-04  3.401e-03    2     2  6.854e-02 3.427e-02 2.771e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.738e-05,5.849e-04,5.749e-03,7.939e-04,7.189e-03
 ndim=981:7.309e-06GB t[comm(intra)]=4.076e-05 speed=3.586e-01GB/S t[comm(inter)]=6.621e-06 speed=2.208e+00GB/S
--- TIMING FOR sigma : t_inter=5.8e-04 t_gemm=5.7e-03 t_reduction=7.9e-04 tot=7.1e-03 ---
 sigma[inter] counter=194 t=5.8e-04 per=8.2e+00 cost=9.3e+06 flops=1.6e+10
 sigma[gemm] counter=194 i=0 t=2.1e-06 per=2.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=1 t=1.9e-06 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=2 t=1.6e-03 per=2.2e+01 cost=4.5e+06 flops=2.9e+09
 sigma[gemm] counter=194 i=3 t=1.5e-03 per=2.1e+01 cost=4.5e+06 flops=3.0e+09
 sigma[gemm] counter=194 i=4 t=1.4e-03 per=2.0e+01 cost=5.1e+06 flops=3.5e+09
 sigma[gemm] counter=194 i=5 t=1.2e-03 per=1.7e+01 cost=5.4e+06 flops=4.4e+09
 sigma[gemm] counter=194 total t=5.7e-03 per=8.1e+01 cost=2.0e+07 flops=3.4e+09
 sigma[red] counter=194 t=7.9e-04 per=1.1e+01 cost=1.8e+06 flops=2.2e+09
--- TIMING FOR sigma_tot : t_inter=8.7e-02 t_gemm=9.5e-01 t_reduction=1.4e-01 tot=1.2e+00 ---
 sigma_tot[inter] counter=194 t=8.7e-02 per=7.4e+00 cost=1.8e+09 flops=2.1e+10
 sigma_tot[gemm] counter=194 i=0 t=3.8e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=1 t=3.2e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=2 t=2.4e-01 per=2.1e+01 cost=1.6e+09 flops=6.7e+09
 sigma_tot[gemm] counter=194 i=3 t=2.4e-01 per=2.1e+01 cost=1.6e+09 flops=6.6e+09
 sigma_tot[gemm] counter=194 i=4 t=2.4e-01 per=2.0e+01 cost=1.3e+09 flops=5.7e+09
 sigma_tot[gemm] counter=194 i=5 t=2.3e-01 per=1.9e+01 cost=1.4e+09 flops=6.0e+09
 sigma_tot[gemm] counter=194 total t=9.5e-01 per=8.1e+01 cost=5.9e+09 flops=6.2e+09
 sigma_tot[red] counter=194 t=1.4e-01 per=1.2e+01 cost=3.8e+08 flops=2.8e+09
T(sub)=7.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,3.9e-05,4.1e-06,7.8e-06,4.8e-07
    3   0 -    -116.545266959384 -1.751e-05  1.309e-03    3     3  8.561e-02 2.854e-02 2.091e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.908e-05,5.473e-04,5.645e-03,8.037e-04,7.051e-03
 ndim=981:7.309e-06GB t[comm(intra)]=3.309e-05 speed=4.417e-01GB/S t[comm(inter)]=5.989e-06 speed=2.441e+00GB/S
--- TIMING FOR sigma : t_inter=5.5e-04 t_gemm=5.6e-03 t_reduction=8.0e-04 tot=7.0e-03 ---
 sigma[inter] counter=195 t=5.5e-04 per=7.8e+00 cost=9.3e+06 flops=1.7e+10
 sigma[gemm] counter=195 i=0 t=2.2e-06 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=1 t=1.9e-06 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=2 t=1.4e-03 per=2.1e+01 cost=4.5e+06 flops=3.1e+09
 sigma[gemm] counter=195 i=3 t=1.5e-03 per=2.2e+01 cost=4.5e+06 flops=3.0e+09
 sigma[gemm] counter=195 i=4 t=1.4e-03 per=2.0e+01 cost=5.1e+06 flops=3.6e+09
 sigma[gemm] counter=195 i=5 t=1.3e-03 per=1.8e+01 cost=5.4e+06 flops=4.2e+09
 sigma[gemm] counter=195 total t=5.6e-03 per=8.1e+01 cost=2.0e+07 flops=3.5e+09
 sigma[red] counter=195 t=8.0e-04 per=1.1e+01 cost=1.8e+06 flops=2.2e+09
--- TIMING FOR sigma_tot : t_inter=8.7e-02 t_gemm=9.6e-01 t_reduction=1.4e-01 tot=1.2e+00 ---
 sigma_tot[inter] counter=195 t=8.7e-02 per=7.4e+00 cost=1.8e+09 flops=2.1e+10
 sigma_tot[gemm] counter=195 i=0 t=3.9e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=1 t=3.2e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=2 t=2.4e-01 per=2.1e+01 cost=1.6e+09 flops=6.7e+09
 sigma_tot[gemm] counter=195 i=3 t=2.4e-01 per=2.1e+01 cost=1.6e+09 flops=6.6e+09
 sigma_tot[gemm] counter=195 i=4 t=2.4e-01 per=2.0e+01 cost=1.3e+09 flops=5.6e+09
 sigma_tot[gemm] counter=195 i=5 t=2.3e-01 per=1.9e+01 cost=1.4e+09 flops=6.0e+09
 sigma_tot[gemm] counter=195 total t=9.6e-01 per=8.1e+01 cost=5.9e+09 flops=6.2e+09
 sigma_tot[red] counter=195 t=1.4e-01 per=1.2e+01 cost=3.9e+08 flops=2.8e+09
T(sub)=6.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.6e-05,4.2e-05,3.8e-06,5.6e-06,5.3e-07
    4   0 -    -116.545269733663 -2.774e-06  5.059e-04    3     4  1.024e-01 2.560e-02 1.748e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.010e-05,5.523e-04,5.563e-03,8.122e-04,6.983e-03
 ndim=981:7.309e-06GB t[comm(intra)]=3.427e-05 speed=4.266e-01GB/S t[comm(inter)]=5.826e-06 speed=2.509e+00GB/S
--- TIMING FOR sigma : t_inter=5.5e-04 t_gemm=5.6e-03 t_reduction=8.1e-04 tot=6.9e-03 ---
 sigma[inter] counter=196 t=5.5e-04 per=8.0e+00 cost=9.3e+06 flops=1.7e+10
 sigma[gemm] counter=196 i=0 t=2.1e-06 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=1 t=1.9e-06 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=2 t=1.4e-03 per=2.1e+01 cost=4.5e+06 flops=3.2e+09
 sigma[gemm] counter=196 i=3 t=1.5e-03 per=2.1e+01 cost=4.5e+06 flops=3.1e+09
 sigma[gemm] counter=196 i=4 t=1.4e-03 per=2.0e+01 cost=5.1e+06 flops=3.6e+09
 sigma[gemm] counter=196 i=5 t=1.2e-03 per=1.8e+01 cost=5.4e+06 flops=4.4e+09
 sigma[gemm] counter=196 total t=5.6e-03 per=8.0e+01 cost=2.0e+07 flops=3.5e+09
 sigma[red] counter=196 t=8.1e-04 per=1.2e+01 cost=1.8e+06 flops=2.2e+09
--- TIMING FOR sigma_tot : t_inter=8.8e-02 t_gemm=9.6e-01 t_reduction=1.4e-01 tot=1.2e+00 ---
 sigma_tot[inter] counter=196 t=8.8e-02 per=7.4e+00 cost=1.8e+09 flops=2.1e+10
 sigma_tot[gemm] counter=196 i=0 t=3.9e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=1 t=3.2e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=2 t=2.5e-01 per=2.1e+01 cost=1.6e+09 flops=6.6e+09
 sigma_tot[gemm] counter=196 i=3 t=2.5e-01 per=2.1e+01 cost=1.6e+09 flops=6.5e+09
 sigma_tot[gemm] counter=196 i=4 t=2.4e-01 per=2.0e+01 cost=1.4e+09 flops=5.6e+09
 sigma_tot[gemm] counter=196 i=5 t=2.3e-01 per=1.9e+01 cost=1.4e+09 flops=6.0e+09
 sigma_tot[gemm] counter=196 total t=9.6e-01 per=8.1e+01 cost=6.0e+09 flops=6.2e+09
 sigma_tot[red] counter=196 t=1.4e-01 per=1.2e+01 cost=3.9e+08 flops=2.8e+09
T(sub)=6.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-05,3.5e-05,3.6e-06,5.7e-06,4.0e-07
    5   0 -    -116.545270110519 -3.769e-07  1.617e-04    3     5  1.191e-01 2.383e-02 1.540e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.846e-05,5.317e-04,5.624e-03,7.882e-04,6.998e-03
 ndim=981:7.309e-06GB t[comm(intra)]=3.267e-05 speed=4.474e-01GB/S t[comm(inter)]=5.790e-06 speed=2.525e+00GB/S
--- TIMING FOR sigma : t_inter=5.3e-04 t_gemm=5.6e-03 t_reduction=7.9e-04 tot=6.9e-03 ---
 sigma[inter] counter=197 t=5.3e-04 per=7.7e+00 cost=9.3e+06 flops=1.8e+10
 sigma[gemm] counter=197 i=0 t=2.1e-06 per=3.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=1 t=1.9e-06 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=2 t=1.5e-03 per=2.1e+01 cost=4.5e+06 flops=3.1e+09
 sigma[gemm] counter=197 i=3 t=1.5e-03 per=2.1e+01 cost=4.5e+06 flops=3.1e+09
 sigma[gemm] counter=197 i=4 t=1.4e-03 per=2.1e+01 cost=5.1e+06 flops=3.6e+09
 sigma[gemm] counter=197 i=5 t=1.2e-03 per=1.8e+01 cost=5.4e+06 flops=4.4e+09
 sigma[gemm] counter=197 total t=5.6e-03 per=8.1e+01 cost=2.0e+07 flops=3.5e+09
 sigma[red] counter=197 t=7.9e-04 per=1.1e+01 cost=1.8e+06 flops=2.2e+09
--- TIMING FOR sigma_tot : t_inter=8.8e-02 t_gemm=9.7e-01 t_reduction=1.4e-01 tot=1.2e+00 ---
 sigma_tot[inter] counter=197 t=8.8e-02 per=7.4e+00 cost=1.8e+09 flops=2.1e+10
 sigma_tot[gemm] counter=197 i=0 t=3.9e-04 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=1 t=3.2e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=2 t=2.5e-01 per=2.1e+01 cost=1.6e+09 flops=6.6e+09
 sigma_tot[gemm] counter=197 i=3 t=2.5e-01 per=2.1e+01 cost=1.6e+09 flops=6.5e+09
 sigma_tot[gemm] counter=197 i=4 t=2.4e-01 per=2.0e+01 cost=1.4e+09 flops=5.6e+09
 sigma_tot[gemm] counter=197 i=5 t=2.3e-01 per=1.9e+01 cost=1.4e+09 flops=6.0e+09
 sigma_tot[gemm] counter=197 total t=9.7e-01 per=8.1e+01 cost=6.0e+09 flops=6.2e+09
 sigma_tot[red] counter=197 t=1.4e-01 per=1.2e+01 cost=3.9e+08 flops=2.8e+09
T(sub)=6.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-05,3.4e-05,3.3e-06,5.1e-06,3.7e-07
    6   0 +    -116.545270147744 -3.723e-08  5.186e-05    3     6  1.359e-01 2.264e-02 1.402e-02
TIMING FOR Davidson : 1.359e-01  T(cal/comm/rest)=8.412e-02,7.810e-07,5.175e-02
decomposed t_rest=5.175e-02
 T(sub)    =3.558e-04 per=6.876e-01
 T(precond)=5.117e-02 per=9.889e+01
 T(ortho)  =3.435e-05 per=6.638e-02
 T(xcopy)  =4.386e-06 per=8.476e-03
 T(xnrm2)  =5.629e-06 per=1.088e-02
 T(other)  =1.754e-04 per=3.390e-01
optimized energies: isweep=0 ibond=28 dots=1 e[0]=-116.545270147744 nmvp=6
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.508e+03S Sys:3.167e+00S Total:1.512e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=22 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond28.txt
 qbond: qsuper nsym=22 dimAll=228
 (19,-1):32 (18,0):17 (18,-2):15 (17,-1):6 (20,0):27 (20,-2):27 (19,-3):13 (19,1):15 (17,1):3 (21,-1):22 (17,-3):1 (21,-3):10 (22,0):7 (22,-2):8 (21,1):9 (23,-1):2 (23,-3):1 (20,2):4 (18,2):3 (20,-4):4 (18,-4):1 (22,-4):1
timing for divide=3.7e-05
timing for compute=4.7e-04
timing for collect=3.3e-05
----- TMING FOR decimation_genbasis(nkr): 5.4e-04 S T(divide/compute/collect)=3.7e-05,4.7e-04,3.3e-05 -----
decimation summary: 228->47 dwt=-2.220e-16 SvN=1.967e+00
 qbond: qkept nsym=11 dimAll=47
 (20,-2):9 (20,0):8 (21,-1):8 (19,-1):6 (21,-3):4 (22,-2):4 (19,1):3 (22,0):2 (19,-3):1 (21,1):1 (23,-3):1
----- TIMING for decimation_row(nkr): 1.529e-03 S T(decim/select/formRot)=7.045e-04,7.460e-04,7.872e-05 -----
----- TIMING FOR onedot_decimation: 1.858e-03 S T(wf/decim)=2.088e-04,1.650e-03 -----
ctns::oper_renorm coord=(7,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:26 S:14 H:1 P:91 Q:105 
        dim(bra,ket)=47,47 size(op)=293:2.235e-03MB size(tot)=39416:3.007e-01MB:2.937e-04GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.508e+03S Sys:3.167e+00S Total:1.512e+03S
----- TIMING FOR symbolic_formulae_renorm with size=237 : 3.397e-02 S -----
rank=0 GPUmem(GB): used=0.00085 (oper)=0.000804
rank=0 GPUmem(GB): used=0.000857 (oper,site)(GB)=0.000804,7.31e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=518
 no. of coefficients=6216:0.0474MB:4.63e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.313e-03 S -----
rank=0 GPUmem(GB): used=0.000904 (oper,site,rinter)=0.000804,7.31e-06,4.63e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0286 S size(rtasks)=237 size(Rlst2)=121 T(Rmu/Rlist)=0.00509,0.0235 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0306 S size(rtasks)=237 size(Rlst)=13568 -----
rank=0 GPUmem(GB): used=0.000904 (oper,site,rinter,batch)=0.000804,7.31e-06,4.63e-05,0.0264 blksize=90 blksize0=80 batchsize=13568
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00189,0.0221,0.00556
--- TIMING FOR renorm : t_inter=1.9e-03 t_gemm=2.2e-02 t_reduction=5.6e-03 tot=3.0e-02 ---
 renorm[inter] counter=29 t=1.9e-03 per=6.4e+00 cost=4.7e+06 flops=2.5e+09
 renorm[gemm] counter=29 i=0 t=1.8e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=1 t=1.3e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=2 t=6.5e-03 per=2.2e+01 cost=1.6e+06 flops=2.5e+08
 renorm[gemm] counter=29 i=3 t=4.0e-03 per=1.4e+01 cost=3.0e+06 flops=7.6e+08
 renorm[gemm] counter=29 i=4 t=1.4e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=5 t=1.3e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=6 t=1.2e-02 per=3.9e+01 cost=5.8e+06 flops=5.0e+08
 renorm[gemm] counter=29 total t=2.2e-02 per=7.5e+01 cost=1.1e+07 flops=4.8e+08
 renorm[red] counter=29 t=5.6e-03 per=1.9e+01 cost=8.9e+05 flops=1.6e+08
--- TIMING FOR renorm_tot : t_inter=3.5e-02 t_gemm=3.5e-01 t_reduction=9.0e-02 tot=4.7e-01 ---
 renorm_tot[inter] counter=29 t=3.5e-02 per=7.3e+00 cost=1.3e+08 flops=3.6e+09
 renorm_tot[gemm] counter=29 i=0 t=4.3e-05 per=9.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=29 i=1 t=3.5e-05 per=7.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=29 i=2 t=5.8e-02 per=1.2e+01 cost=2.1e+07 flops=3.7e+08
 renorm_tot[gemm] counter=29 i=3 t=4.9e-02 per=1.0e+01 cost=4.8e+07 flops=9.7e+08
 renorm_tot[gemm] counter=29 i=4 t=4.4e-02 per=9.2e+00 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=29 i=5 t=5.4e-02 per=1.1e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=29 i=6 t=1.4e-01 per=3.1e+01 cost=1.8e+08 flops=1.2e+09
 renorm_tot[gemm] counter=29 total t=3.5e-01 per=7.4e+01 cost=3.2e+08 flops=9.2e+08
 renorm_tot[red] counter=29 t=9.0e-02 per=1.9e+01 cost=2.2e+07 flops=2.4e+08
qops.to_cpu: size(tot)=39416:3.0e-01MB:2.9e-04GB t[to_cpu]=9.1e-05S speed=3.2e+00GB/S
check ||H-H.dagger||=2.910e-14 coord=(7,0) rank=0
ctns::oper_ab2pq coord=(7,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.22 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.509e+03S Sys:3.168e+00S Total:1.512e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=723:5.516e-03MB:5.387e-06GB
total mem of comb=16408:1.252e-01MB:1.222e-04GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.509e+03S Sys:3.168e+00S Total:1.512e+03S
##### local opt: 8.131e-01 S #####
 T(local opt: fetch) = 1.314e-02 S  per = 1.62  per(accum) = 1.62
 T(local opt: hdiag) = 3.325e-03 S  per = 0.409  per(accum) = 2.03
 T(local opt: dvdsn) = 5.674e-01 S  per = 69.8  per(accum) = 71.8
 T(local opt: decim) = 1.875e-03 S  per = 0.231  per(accum) = 72
 T(local opt: guess) = 5.414e-04 S  per = 0.0666  per(accum) = 72.1
 T(local opt: renrm) = 2.225e-01 S  per = 27.4  per(accum) = 99.5
 T(local opt: save ) = 4.331e-03 S  per = 0.533  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.674e-01 S  T(sum) = 3.634e-01 S  per = 6.405e+01
 T(local opt: preprocess                  ) = 6.556e-04 S  per = 0.18  per(accum) = 0.18
 T(local opt: symbolic_formulae           ) = 2.018e-02 S  per = 5.55  per(accum) = 5.73
 T(local opt: hintermediate init          ) = 5.647e-04 S  per = 0.155  per(accum) = 5.89
 T(local opt: preprocess_hformulae_Hxlist ) = 3.270e-02 S  per =    9  per(accum) = 14.9
 T(local opt: hmmtasks init               ) = 1.734e-01 S  per = 47.7  per(accum) = 62.6
 T(local opt: initial guess for dvdson    ) = 1.432e-05 S  per = 0.00394  per(accum) = 62.6
 T(local opt: dvdson solver [Hx_batchGPU] ) = 8.387e-02 S  per = 23.1  per(accum) = 85.7
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.486e-04 S  per = 0.0684  per(accum) = 85.8
 T(local opt: dvdson solver [comm(cpu)]   ) = 7.810e-07 S  per = 0.000215  per(accum) = 85.8
 T(local opt: dvdson solver [rest part]   ) = 5.175e-02 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 2.225e-01 S  T(sum) = 2.225e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.072e-04 S  per = 0.183  per(accum) = 0.183
 T(local opt: qops init                    ) = 6.996e-03 S  per = 3.14  per(accum) = 3.33
 T(local opt: symbolic_formulae_renorm     ) = 3.400e-02 S  per = 15.3  per(accum) = 18.6
 T(local opt: allocate qops on gpu         ) = 6.434e-05 S  per = 0.0289  per(accum) = 18.6
 T(local opt: site memcpy cpu2gpu          ) = 3.615e-05 S  per = 0.0163  per(accum) = 18.7
 T(local opt: rintermediate init           ) = 1.332e-03 S  per = 0.599  per(accum) = 19.3
 T(local opt: preprocess_formulae_Rlist2   ) = 3.148e-02 S  per = 14.1  per(accum) = 33.4
 T(local opt: rmmtasks init                ) = 1.165e-01 S  per = 52.4  per(accum) = 85.8
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 1.53e-05  per(accum) = 85.8
 T(local opt: preprocess_renorm_batchGPU   ) = 2.963e-02 S  per = 13.3  per(accum) = 99.1
 T(local opt: reduction of opS & opH [nccl]) = 2.629e-06 S  per = 0.00118  per(accum) = 99.1
 T(local opt: qops memcpy gpu2cpu          ) = 9.870e-05 S  per = 0.0444  per(accum) = 99.1
 T(local opt: deallocate cpu and gpu memory) = 2.278e-04 S  per = 0.102  per(accum) = 99.2
 T(local opt: reduction of opS & opH [comm]) = 6.091e-05 S  per = 0.0274  per(accum) = 99.3
 T(local opt: conversion from opAB to opPQ ) = 6.257e-06 S  per = 0.00281  per(accum) = 99.3
 T(local opt: after oper_renorm            ) = 1.609e-03 S  per = 0.723  per(accum) = 100
##### sweep opt: 1.958e+01 S #####
 T(sweep opt: fetch) = 4.349e-01 S  per = 2.22  per(accum) = 2.22
 T(sweep opt: hdiag) = 7.354e-02 S  per = 0.376  per(accum) = 2.6
 T(sweep opt: dvdsn) = 7.760e+00 S  per = 39.6  per(accum) = 42.2
 T(sweep opt: decim) = 3.640e-02 S  per = 0.186  per(accum) = 42.4
 T(sweep opt: guess) = 8.912e-03 S  per = 0.0455  per(accum) = 42.5
 T(sweep opt: renrm) = 1.118e+01 S  per = 57.1  per(accum) = 99.6
 T(sweep opt: save ) = 8.501e-02 S  per = 0.434  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.760e+00 S  T(sum) = 7.097e+00 S  per = 9.145e+01
 T(sweep opt: preprocess                  ) = 1.565e-02 S  per = 0.221  per(accum) = 0.221
 T(sweep opt: symbolic_formulae           ) = 4.981e-01 S  per = 7.02  per(accum) = 7.24
 T(sweep opt: hintermediate init          ) = 1.143e-02 S  per = 0.161  per(accum) = 7.4
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.833e-01 S  per = 8.22  per(accum) = 15.6
 T(sweep opt: hmmtasks init               ) = 3.355e+00 S  per = 47.3  per(accum) = 62.9
 T(sweep opt: initial guess for dvdson    ) = 2.557e-04 S  per = 0.0036  per(accum) = 62.9
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.230e+00 S  per = 17.3  per(accum) = 80.2
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 6.977e-03 S  per = 0.0983  per(accum) = 80.3
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.521e-05 S  per = 0.000355  per(accum) = 80.3
 T(sweep opt: dvdson solver [rest part]   ) = 1.396e+00 S  per = 19.7  per(accum) = 100
Detailed decomposition of T(renrm) = 1.118e+01 S  T(sum) = 1.118e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.585e-03 S  per = 0.0857  per(accum) = 0.0857
 T(sweep opt: qops init                    ) = 1.063e-01 S  per = 0.951  per(accum) = 1.04
 T(sweep opt: symbolic_formulae_renorm     ) = 3.868e-01 S  per = 3.46  per(accum) = 4.5
 T(sweep opt: allocate qops on gpu         ) = 3.041e-03 S  per = 0.0272  per(accum) = 4.52
 T(sweep opt: site memcpy cpu2gpu          ) = 6.875e-04 S  per = 0.00615  per(accum) = 4.53
 T(sweep opt: rintermediate init           ) = 1.671e-02 S  per = 0.149  per(accum) = 4.68
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.469e-01 S  per =  3.1  per(accum) = 7.78
 T(sweep opt: rmmtasks init                ) = 1.338e+00 S  per =   12  per(accum) = 19.7
 T(sweep opt: qops memset on cpu           ) = 1.486e-06 S  per = 1.33e-05  per(accum) = 19.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.778e-01 S  per = 4.27  per(accum) = 24
 T(sweep opt: reduction of opS & opH [nccl]) = 3.437e-05 S  per = 0.000307  per(accum) = 24
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.208e-03 S  per = 0.0376  per(accum) = 24.1
 T(sweep opt: deallocate cpu and gpu memory) = 9.529e-01 S  per = 8.52  per(accum) = 32.6
 T(sweep opt: reduction of opS & opH [comm]) = 1.458e-03 S  per = 0.013  per(accum) = 32.6
 T(sweep opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 67.2  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 2.382e-02 S  per = 0.213  per(accum) = 100
##### global opt: 1.958e+01 S #####
 T(global opt: fetch) = 4.349e-01 S  per = 2.22  per(accum) = 2.22
 T(global opt: hdiag) = 7.354e-02 S  per = 0.376  per(accum) = 2.6
 T(global opt: dvdsn) = 7.760e+00 S  per = 39.6  per(accum) = 42.2
 T(global opt: decim) = 3.640e-02 S  per = 0.186  per(accum) = 42.4
 T(global opt: guess) = 8.912e-03 S  per = 0.0455  per(accum) = 42.5
 T(global opt: renrm) = 1.118e+01 S  per = 57.1  per(accum) = 99.6
 T(global opt: save ) = 8.501e-02 S  per = 0.434  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.760e+00 S  T(sum) = 7.097e+00 S  per = 9.145e+01
 T(global opt: preprocess                  ) = 1.565e-02 S  per = 0.221  per(accum) = 0.221
 T(global opt: symbolic_formulae           ) = 4.981e-01 S  per = 7.02  per(accum) = 7.24
 T(global opt: hintermediate init          ) = 1.143e-02 S  per = 0.161  per(accum) = 7.4
 T(global opt: preprocess_hformulae_Hxlist ) = 5.833e-01 S  per = 8.22  per(accum) = 15.6
 T(global opt: hmmtasks init               ) = 3.355e+00 S  per = 47.3  per(accum) = 62.9
 T(global opt: initial guess for dvdson    ) = 2.557e-04 S  per = 0.0036  per(accum) = 62.9
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.230e+00 S  per = 17.3  per(accum) = 80.2
 T(global opt: dvdson solver [comm(gpu)]   ) = 6.977e-03 S  per = 0.0983  per(accum) = 80.3
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.521e-05 S  per = 0.000355  per(accum) = 80.3
 T(global opt: dvdson solver [rest part]   ) = 1.396e+00 S  per = 19.7  per(accum) = 100
Detailed decomposition of T(renrm) = 1.118e+01 S  T(sum) = 1.118e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.585e-03 S  per = 0.0857  per(accum) = 0.0857
 T(global opt: qops init                    ) = 1.063e-01 S  per = 0.951  per(accum) = 1.04
 T(global opt: symbolic_formulae_renorm     ) = 3.868e-01 S  per = 3.46  per(accum) = 4.5
 T(global opt: allocate qops on gpu         ) = 3.041e-03 S  per = 0.0272  per(accum) = 4.52
 T(global opt: site memcpy cpu2gpu          ) = 6.875e-04 S  per = 0.00615  per(accum) = 4.53
 T(global opt: rintermediate init           ) = 1.671e-02 S  per = 0.149  per(accum) = 4.68
 T(global opt: preprocess_formulae_Rlist2   ) = 3.469e-01 S  per =  3.1  per(accum) = 7.78
 T(global opt: rmmtasks init                ) = 1.338e+00 S  per =   12  per(accum) = 19.7
 T(global opt: qops memset on cpu           ) = 1.486e-06 S  per = 1.33e-05  per(accum) = 19.7
 T(global opt: preprocess_renorm_batchGPU   ) = 4.778e-01 S  per = 4.27  per(accum) = 24
 T(global opt: reduction of opS & opH [nccl]) = 3.437e-05 S  per = 0.000307  per(accum) = 24
 T(global opt: qops memcpy gpu2cpu          ) = 4.208e-03 S  per = 0.0376  per(accum) = 24.1
 T(global opt: deallocate cpu and gpu memory) = 9.529e-01 S  per = 8.52  per(accum) = 32.6
 T(global opt: reduction of opS & opH [comm]) = 1.458e-03 S  per = 0.013  per(accum) = 32.6
 T(global opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 67.2  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 2.382e-02 S  per = 0.213  per(accum) = 100

isweep=0 ibond=29/seqsize=34 dots=1 dbond=(5,0)-(6,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.509e+03S Sys:3.168e+00S Total:1.512e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=723:5.516e-03MB:5.387e-06GB
total mem of comb=16408:1.252e-01MB:1.222e-04GB
ctns::topology::check_partition: (sl,sr,sc)=6,13,1
 suppl= 0 1 2 3 4 16
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 17
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:12 S:28 H:1 A:66 B:78 
        dim(bra,ket)=38,38 size(op)=208:1.587e-03MB size(tot)=21107:1.610e-01MB:1.573e-04GB
 rqops: oplist=CSHPQ nops=C:26 S:14 H:1 P:91 Q:105 
        dim(bra,ket)=47,47 size(op)=293:2.235e-03MB size(tot)=39416:3.007e-01MB:2.937e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=62859:4.796e-01MB:4.683e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(6,0) fdel=./scratch/sweep/lop(5,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
wf3(diml,dimr,dimc)=(38,47,4) nnz=723:5.516e-03MB
qtensor3: wf3 own=1 _data=0x5302b7f0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=10 dimAll=38
 (8,2):8 (9,1):8 (9,3):6 (7,3):4 (10,2):3 (10,0):3 (8,4):2 (7,1):2 (6,4):1 (8,0):1
 qbond: qcol nsym=11 dimAll=47
 (20,-2):9 (20,0):8 (21,-1):8 (19,-1):6 (21,-3):4 (22,-2):4 (19,1):3 (22,0):2 (19,-3):1 (21,1):1 (23,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=29 nblocks=440 size=723:5.516e-03MB
### DIAG TIMING: total=2.256e-03 t1=1.889e-05, t2=3.351e-05, t3=4.366e-05, t4=2.120e-03, t5=1.522e-05, t6=2.045e-05, t7=3.674e-06
duration_diagGPU:2.268e-03
duration_diagreduce:4.400e-08
duration_diagtransform:3.485e-06
----- TIMING FOR symbolic_formulae_onedot with size=813 : 1.583e-02 S -----
rank=0 GPUmem(GB): used=0.000468 (oper)=0.000468
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=813
 no. of hintermediate operators=390
 no. of coefficients=5070:0.0387MB:3.78e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.991e-04 S -----
rank=0 GPUmem(GB): used=0.000506 (oper,hinter)=0.000468,3.78e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0189 S size(H_formulae)=813 size(Hxlst2)=29 T(Hmu/Hxlist)=0.00214,0.0168 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0205 S size(H_formulae)=813 size(Hxlst)=16936 -----
rank=0 GPUmem(GB): used=0.0279 (oper,hinter,dvdson,batch)=0.000468,3.78e-05,1.08e-05,0.0274 blksize=72 blksize0=72 batchsize=16936
ctns::pdvdsonSolver_nkr::solve_iter ndim=723 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.66e-05,0.00202,0.0301,0.00289,0.0351
 ndim=723:5.39e-06GB t[comm(intra)]=3.58e-05 speed=0.301GB/S t[comm(inter)]=1.08e-05 speed=0.995GB/S
--- TIMING FOR sigma : t_inter=2.0e-03 t_gemm=3.0e-02 t_reduction=2.9e-03 tot=3.5e-02 ---
 sigma[inter] counter=198 t=2.0e-03 per=5.8e+00 cost=6.2e+06 flops=3.1e+09
 sigma[gemm] counter=198 i=0 t=1.7e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=1 t=1.4e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=2 t=7.9e-03 per=2.3e+01 cost=2.4e+06 flops=3.0e+08
 sigma[gemm] counter=198 i=3 t=8.4e-03 per=2.4e+01 cost=2.4e+06 flops=2.9e+08
 sigma[gemm] counter=198 i=4 t=6.8e-03 per=1.9e+01 cost=2.4e+06 flops=3.6e+08
 sigma[gemm] counter=198 i=5 t=7.0e-03 per=2.0e+01 cost=2.5e+06 flops=3.5e+08
 sigma[gemm] counter=198 total t=3.0e-02 per=8.6e+01 cost=9.7e+06 flops=3.2e+08
 sigma[red] counter=198 t=2.9e-03 per=8.2e+00 cost=9.6e+05 flops=3.3e+08
--- TIMING FOR sigma_tot : t_inter=9.0e-02 t_gemm=1.0e+00 t_reduction=1.4e-01 tot=1.2e+00 ---
 sigma_tot[inter] counter=198 t=9.0e-02 per=7.4e+00 cost=1.8e+09 flops=2.0e+10
 sigma_tot[gemm] counter=198 i=0 t=3.9e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=1 t=3.3e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=2 t=2.6e-01 per=2.1e+01 cost=1.6e+09 flops=6.4e+09
 sigma_tot[gemm] counter=198 i=3 t=2.6e-01 per=2.1e+01 cost=1.6e+09 flops=6.3e+09
 sigma_tot[gemm] counter=198 i=4 t=2.5e-01 per=2.0e+01 cost=1.4e+09 flops=5.5e+09
 sigma_tot[gemm] counter=198 i=5 t=2.4e-01 per=1.9e+01 cost=1.4e+09 flops=5.8e+09
 sigma_tot[gemm] counter=198 total t=1.0e+00 per=8.1e+01 cost=6.0e+09 flops=6.0e+09
 sigma_tot[red] counter=198 t=1.4e-01 per=1.1e+01 cost=3.9e+08 flops=2.8e+09
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=9.4e-06,9.3e-06,2.8e-06,2.5e-06,4.3e-07
settings: ndim=723 neig=1 maxcycle=30 nbuff=4 memory=8e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.545270147744 -1.117e+03  1.703e-02    1     1  3.531e-02 3.531e-02 3.524e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=8.099e-04,6.757e-04,4.213e-03,7.007e-04,6.832e-03
 ndim=723:5.387e-06GB t[comm(intra)]=8.000e-04 speed=1.347e-02GB/S t[comm(inter)]=9.916e-06 speed=1.086e+00GB/S
--- TIMING FOR sigma : t_inter=6.8e-04 t_gemm=4.2e-03 t_reduction=7.0e-04 tot=5.6e-03 ---
 sigma[inter] counter=199 t=6.8e-04 per=1.2e+01 cost=6.2e+06 flops=9.2e+09
 sigma[gemm] counter=199 i=0 t=2.4e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=1 t=1.9e-06 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=2 t=1.2e-03 per=2.1e+01 cost=2.4e+06 flops=2.0e+09
 sigma[gemm] counter=199 i=3 t=1.1e-03 per=2.0e+01 cost=2.4e+06 flops=2.2e+09
 sigma[gemm] counter=199 i=4 t=9.8e-04 per=1.8e+01 cost=2.4e+06 flops=2.5e+09
 sigma[gemm] counter=199 i=5 t=9.2e-04 per=1.6e+01 cost=2.5e+06 flops=2.7e+09
 sigma[gemm] counter=199 total t=4.2e-03 per=7.5e+01 cost=9.7e+06 flops=2.3e+09
 sigma[red] counter=199 t=7.0e-04 per=1.3e+01 cost=9.6e+05 flops=1.4e+09
--- TIMING FOR sigma_tot : t_inter=9.1e-02 t_gemm=1.0e+00 t_reduction=1.4e-01 tot=1.2e+00 ---
 sigma_tot[inter] counter=199 t=9.1e-02 per=7.4e+00 cost=1.8e+09 flops=2.0e+10
 sigma_tot[gemm] counter=199 i=0 t=3.9e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=1 t=3.3e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=2 t=2.6e-01 per=2.1e+01 cost=1.6e+09 flops=6.4e+09
 sigma_tot[gemm] counter=199 i=3 t=2.6e-01 per=2.1e+01 cost=1.6e+09 flops=6.3e+09
 sigma_tot[gemm] counter=199 i=4 t=2.5e-01 per=2.0e+01 cost=1.4e+09 flops=5.5e+09
 sigma_tot[gemm] counter=199 i=5 t=2.4e-01 per=1.9e+01 cost=1.4e+09 flops=5.8e+09
 sigma_tot[gemm] counter=199 total t=1.0e+00 per=8.1e+01 cost=6.0e+09 flops=6.0e+09
 sigma_tot[red] counter=199 t=1.4e-01 per=1.1e+01 cost=3.9e+08 flops=2.8e+09
T(sub)=6.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,3.6e-05,4.7e-06,4.2e-06,4.0e-07
    2   0 -    -116.545595627270 -3.255e-04  3.204e-03    2     2  5.185e-02 2.592e-02 2.110e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.893e-05,4.356e-04,4.175e-03,6.699e-04,5.336e-03
 ndim=723:5.387e-06GB t[comm(intra)]=2.321e-05 speed=4.642e-01GB/S t[comm(inter)]=5.720e-06 speed=1.883e+00GB/S
--- TIMING FOR sigma : t_inter=4.4e-04 t_gemm=4.2e-03 t_reduction=6.7e-04 tot=5.3e-03 ---
 sigma[inter] counter=200 t=4.4e-04 per=8.2e+00 cost=6.2e+06 flops=1.4e+10
 sigma[gemm] counter=200 i=0 t=2.0e-06 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=1 t=1.8e-06 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=2 t=1.1e-03 per=2.1e+01 cost=2.4e+06 flops=2.2e+09
 sigma[gemm] counter=200 i=3 t=1.1e-03 per=2.1e+01 cost=2.4e+06 flops=2.3e+09
 sigma[gemm] counter=200 i=4 t=9.8e-04 per=1.9e+01 cost=2.4e+06 flops=2.5e+09
 sigma[gemm] counter=200 i=5 t=1.0e-03 per=1.9e+01 cost=2.5e+06 flops=2.5e+09
 sigma[gemm] counter=200 total t=4.2e-03 per=7.9e+01 cost=9.7e+06 flops=2.3e+09
 sigma[red] counter=200 t=6.7e-04 per=1.3e+01 cost=9.6e+05 flops=1.4e+09
--- TIMING FOR sigma_tot : t_inter=9.1e-02 t_gemm=1.0e+00 t_reduction=1.4e-01 tot=1.2e+00 ---
 sigma_tot[inter] counter=200 t=9.1e-02 per=7.4e+00 cost=1.8e+09 flops=2.0e+10
 sigma_tot[gemm] counter=200 i=0 t=4.0e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=1 t=3.3e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=2 t=2.6e-01 per=2.1e+01 cost=1.6e+09 flops=6.4e+09
 sigma_tot[gemm] counter=200 i=3 t=2.6e-01 per=2.1e+01 cost=1.6e+09 flops=6.3e+09
 sigma_tot[gemm] counter=200 i=4 t=2.5e-01 per=2.0e+01 cost=1.4e+09 flops=5.5e+09
 sigma_tot[gemm] counter=200 i=5 t=2.4e-01 per=1.9e+01 cost=1.4e+09 flops=5.8e+09
 sigma_tot[gemm] counter=200 total t=1.0e+00 per=8.1e+01 cost=6.0e+09 flops=6.0e+09
 sigma_tot[red] counter=200 t=1.4e-01 per=1.1e+01 cost=3.9e+08 flops=2.8e+09
T(sub)=6.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,3.7e-05,3.7e-06,6.2e-06,4.1e-07
    3   0 -    -116.545611110588 -1.548e-05  1.106e-03    3     3  6.672e-02 2.224e-02 1.589e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.821e-05,4.094e-04,4.143e-03,6.642e-04,5.268e-03
 ndim=723:5.387e-06GB t[comm(intra)]=3.240e-05 speed=3.325e-01GB/S t[comm(inter)]=5.813e-06 speed=1.853e+00GB/S
--- TIMING FOR sigma : t_inter=4.1e-04 t_gemm=4.1e-03 t_reduction=6.6e-04 tot=5.2e-03 ---
 sigma[inter] counter=201 t=4.1e-04 per=7.8e+00 cost=6.2e+06 flops=1.5e+10
 sigma[gemm] counter=201 i=0 t=2.0e-06 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=1 t=1.7e-06 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=2 t=1.1e-03 per=2.1e+01 cost=2.4e+06 flops=2.2e+09
 sigma[gemm] counter=201 i=3 t=1.1e-03 per=2.1e+01 cost=2.4e+06 flops=2.3e+09
 sigma[gemm] counter=201 i=4 t=9.7e-04 per=1.9e+01 cost=2.4e+06 flops=2.5e+09
 sigma[gemm] counter=201 i=5 t=9.8e-04 per=1.9e+01 cost=2.5e+06 flops=2.5e+09
 sigma[gemm] counter=201 total t=4.1e-03 per=7.9e+01 cost=9.7e+06 flops=2.3e+09
 sigma[red] counter=201 t=6.6e-04 per=1.3e+01 cost=9.6e+05 flops=1.5e+09
--- TIMING FOR sigma_tot : t_inter=9.2e-02 t_gemm=1.0e+00 t_reduction=1.4e-01 tot=1.2e+00 ---
 sigma_tot[inter] counter=201 t=9.2e-02 per=7.4e+00 cost=1.8e+09 flops=2.0e+10
 sigma_tot[gemm] counter=201 i=0 t=4.0e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=1 t=3.3e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=2 t=2.6e-01 per=2.1e+01 cost=1.6e+09 flops=6.4e+09
 sigma_tot[gemm] counter=201 i=3 t=2.6e-01 per=2.1e+01 cost=1.6e+09 flops=6.3e+09
 sigma_tot[gemm] counter=201 i=4 t=2.5e-01 per=2.0e+01 cost=1.4e+09 flops=5.4e+09
 sigma_tot[gemm] counter=201 i=5 t=2.4e-01 per=1.9e+01 cost=1.4e+09 flops=5.8e+09
 sigma_tot[gemm] counter=201 total t=1.0e+00 per=8.1e+01 cost=6.0e+09 flops=6.0e+09
 sigma_tot[red] counter=201 t=1.4e-01 per=1.1e+01 cost=3.9e+08 flops=2.8e+09
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.3e-05,3.1e-05,3.6e-06,4.0e-06,4.3e-07
    4   0 -    -116.545613218798 -2.108e-06  4.795e-04    3     4  8.148e-02 2.037e-02 1.326e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.642e-05,4.030e-04,4.148e-03,6.778e-04,5.278e-03
 ndim=723:5.387e-06GB t[comm(intra)]=2.138e-05 speed=5.039e-01GB/S t[comm(inter)]=1.504e-05 speed=7.163e-01GB/S
--- TIMING FOR sigma : t_inter=4.0e-04 t_gemm=4.1e-03 t_reduction=6.8e-04 tot=5.2e-03 ---
 sigma[inter] counter=202 t=4.0e-04 per=7.7e+00 cost=6.2e+06 flops=1.5e+10
 sigma[gemm] counter=202 i=0 t=2.0e-06 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=1 t=1.7e-06 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=2 t=1.1e-03 per=2.1e+01 cost=2.4e+06 flops=2.2e+09
 sigma[gemm] counter=202 i=3 t=1.1e-03 per=2.1e+01 cost=2.4e+06 flops=2.3e+09
 sigma[gemm] counter=202 i=4 t=9.8e-04 per=1.9e+01 cost=2.4e+06 flops=2.5e+09
 sigma[gemm] counter=202 i=5 t=1.0e-03 per=1.9e+01 cost=2.5e+06 flops=2.5e+09
 sigma[gemm] counter=202 total t=4.1e-03 per=7.9e+01 cost=9.7e+06 flops=2.3e+09
 sigma[red] counter=202 t=6.8e-04 per=1.3e+01 cost=9.6e+05 flops=1.4e+09
--- TIMING FOR sigma_tot : t_inter=9.2e-02 t_gemm=1.0e+00 t_reduction=1.4e-01 tot=1.2e+00 ---
 sigma_tot[inter] counter=202 t=9.2e-02 per=7.4e+00 cost=1.8e+09 flops=2.0e+10
 sigma_tot[gemm] counter=202 i=0 t=4.0e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=1 t=3.3e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=2 t=2.6e-01 per=2.1e+01 cost=1.6e+09 flops=6.3e+09
 sigma_tot[gemm] counter=202 i=3 t=2.6e-01 per=2.1e+01 cost=1.6e+09 flops=6.2e+09
 sigma_tot[gemm] counter=202 i=4 t=2.5e-01 per=2.0e+01 cost=1.4e+09 flops=5.4e+09
 sigma_tot[gemm] counter=202 i=5 t=2.4e-01 per=1.9e+01 cost=1.4e+09 flops=5.8e+09
 sigma_tot[gemm] counter=202 total t=1.0e+00 per=8.1e+01 cost=6.0e+09 flops=6.0e+09
 sigma_tot[red] counter=202 t=1.4e-01 per=1.1e+01 cost=3.9e+08 flops=2.7e+09
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.3e-05,3.1e-05,3.6e-06,3.9e-06,3.9e-07
    5   0 -    -116.545613599543 -3.807e-07  2.103e-04    3     5  9.629e-02 1.926e-02 1.168e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.947e-05,3.587e-04,3.494e-03,6.052e-04,4.513e-03
 ndim=723:5.387e-06GB t[comm(intra)]=3.278e-05 speed=3.287e-01GB/S t[comm(inter)]=6.694e-06 speed=1.609e+00GB/S
--- TIMING FOR sigma : t_inter=3.6e-04 t_gemm=3.5e-03 t_reduction=6.0e-04 tot=4.5e-03 ---
 sigma[inter] counter=203 t=3.6e-04 per=8.0e+00 cost=6.2e+06 flops=1.7e+10
 sigma[gemm] counter=203 i=0 t=1.9e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=1 t=1.6e-06 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=2 t=9.3e-04 per=2.1e+01 cost=2.4e+06 flops=2.6e+09
 sigma[gemm] counter=203 i=3 t=9.3e-04 per=2.1e+01 cost=2.4e+06 flops=2.6e+09
 sigma[gemm] counter=203 i=4 t=8.1e-04 per=1.8e+01 cost=2.4e+06 flops=3.0e+09
 sigma[gemm] counter=203 i=5 t=8.2e-04 per=1.8e+01 cost=2.5e+06 flops=3.0e+09
 sigma[gemm] counter=203 total t=3.5e-03 per=7.8e+01 cost=9.7e+06 flops=2.8e+09
 sigma[red] counter=203 t=6.0e-04 per=1.4e+01 cost=9.6e+05 flops=1.6e+09
--- TIMING FOR sigma_tot : t_inter=9.3e-02 t_gemm=1.0e+00 t_reduction=1.4e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=203 t=9.3e-02 per=7.4e+00 cost=1.9e+09 flops=2.0e+10
 sigma_tot[gemm] counter=203 i=0 t=4.0e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=1 t=3.3e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=2 t=2.6e-01 per=2.1e+01 cost=1.6e+09 flops=6.3e+09
 sigma_tot[gemm] counter=203 i=3 t=2.6e-01 per=2.1e+01 cost=1.6e+09 flops=6.2e+09
 sigma_tot[gemm] counter=203 i=4 t=2.5e-01 per=2.0e+01 cost=1.4e+09 flops=5.4e+09
 sigma_tot[gemm] counter=203 i=5 t=2.4e-01 per=1.9e+01 cost=1.4e+09 flops=5.8e+09
 sigma_tot[gemm] counter=203 total t=1.0e+00 per=8.1e+01 cost=6.0e+09 flops=5.9e+09
 sigma_tot[red] counter=203 t=1.4e-01 per=1.1e+01 cost=3.9e+08 flops=2.7e+09
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.3e-05,2.1e-05,3.1e-06,3.5e-06,3.7e-07
    6   0 +    -116.545613677065 -7.752e-08  8.469e-05    3     6  1.149e-01 1.915e-02 1.051e-02
TIMING FOR Davidson : 1.149e-01  T(cal/comm/rest)=6.304e-02,8.660e-07,5.185e-02
decomposed t_rest=5.185e-02
 T(sub)    =2.918e-04 per=5.627e-01
 T(precond)=5.132e-02 per=9.898e+01
 T(ortho)  =2.855e-05 per=5.505e-02
 T(xcopy)  =3.700e-06 per=7.136e-03
 T(xnrm2)  =4.810e-06 per=9.276e-03
 T(other)  =2.025e-04 per=3.905e-01
optimized energies: isweep=0 ibond=29 dots=1 e[0]=-116.545613677065 nmvp=6
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.517e+03S Sys:3.181e+00S Total:1.520e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=21 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond29.txt
 qbond: qsuper nsym=21 dimAll=188
 (20,-2):16 (20,0):17 (21,-1):31 (19,-1):6 (21,-3):14 (22,-2):25 (19,1):3 (22,0):19 (19,-3):1 (21,1):12 (23,-3):9 (23,-1):14 (24,-2):5 (24,0):2 (23,1):3 (25,-3):1 (20,2):3 (22,2):1 (22,-4):4 (20,-4):1 (24,-4):1
timing for divide=1.9e-05
timing for compute=1.9e-04
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 2.3e-04 S T(divide/compute/collect)=1.9e-05,1.9e-04,1.4e-05 -----
decimation summary: 188->38 dwt=+0.000e+00 SvN=1.657e+00
 qbond: qkept nsym=10 dimAll=38
 (21,-1):8 (22,-2):8 (21,-3):6 (23,-3):4 (20,-2):3 (20,0):3 (23,-1):2 (22,-4):2 (22,0):1 (24,-4):1
----- TIMING for decimation_row(nkr): 7.280e-04 S T(decim/select/formRot)=3.234e-04,3.691e-04,3.553e-05 -----
----- TIMING FOR onedot_decimation: 9.650e-04 S T(wf/decim)=1.842e-04,7.809e-04 -----
ctns::oper_renorm coord=(6,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:28 S:12 H:1 P:66 Q:78 
        dim(bra,ket)=38,38 size(op)=208:1.587e-03MB size(tot)=21107:1.610e-01MB:1.573e-04GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.517e+03S Sys:3.181e+00S Total:1.520e+03S
----- TIMING FOR symbolic_formulae_renorm with size=185 : 1.475e-02 S -----
rank=0 GPUmem(GB): used=0.000506 (oper)=0.000468
rank=0 GPUmem(GB): used=0.000511 (oper,site)(GB)=0.000468,5.39e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=390
 no. of coefficients=5070:0.0387MB:3.78e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 6.315e-04 S -----
rank=0 GPUmem(GB): used=0.000549 (oper,site,rinter)=0.000468,5.39e-06,3.78e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0119 S size(rtasks)=185 size(Rlst2)=100 T(Rmu/Rlist)=0.00232,0.00961 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0128 S size(rtasks)=185 size(Rlst)=8837 -----
rank=0 GPUmem(GB): used=0.000549 (oper,site,rinter,batch)=0.000468,5.39e-06,3.78e-05,0.0143 blksize=72 blksize0=72 batchsize=8837
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00187,0.0166,0.00478
--- TIMING FOR renorm : t_inter=1.9e-03 t_gemm=1.7e-02 t_reduction=4.8e-03 tot=2.3e-02 ---
 renorm[inter] counter=30 t=1.9e-03 per=8.1e+00 cost=3.1e+06 flops=1.7e+09
 renorm[gemm] counter=30 i=0 t=1.7e-06 per=7.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=1 t=1.3e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=2 t=5.2e-03 per=2.3e+01 cost=8.6e+05 flops=1.6e+08
 renorm[gemm] counter=30 i=3 t=3.7e-03 per=1.6e+01 cost=1.6e+06 flops=4.4e+08
 renorm[gemm] counter=30 i=4 t=1.2e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=5 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=6 t=7.6e-03 per=3.3e+01 cost=2.8e+06 flops=3.6e+08
 renorm[gemm] counter=30 total t=1.7e-02 per=7.1e+01 cost=5.3e+06 flops=3.2e+08
 renorm[red] counter=30 t=4.8e-03 per=2.1e+01 cost=4.3e+05 flops=8.9e+07
--- TIMING FOR renorm_tot : t_inter=3.7e-02 t_gemm=3.7e-01 t_reduction=9.5e-02 tot=5.0e-01 ---
 renorm_tot[inter] counter=30 t=3.7e-02 per=7.4e+00 cost=1.3e+08 flops=3.5e+09
 renorm_tot[gemm] counter=30 i=0 t=4.5e-05 per=9.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=30 i=1 t=3.6e-05 per=7.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=30 i=2 t=6.3e-02 per=1.3e+01 cost=2.2e+07 flops=3.5e+08
 renorm_tot[gemm] counter=30 i=3 t=5.3e-02 per=1.1e+01 cost=4.9e+07 flops=9.4e+08
 renorm_tot[gemm] counter=30 i=4 t=4.4e-02 per=8.8e+00 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=30 i=5 t=5.4e-02 per=1.1e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=30 i=6 t=1.5e-01 per=3.1e+01 cost=1.8e+08 flops=1.2e+09
 renorm_tot[gemm] counter=30 total t=3.7e-01 per=7.4e+01 cost=3.3e+08 flops=8.9e+08
 renorm_tot[red] counter=30 t=9.5e-02 per=1.9e+01 cost=2.2e+07 flops=2.3e+08
qops.to_cpu: size(tot)=21107:1.6e-01MB:1.6e-04GB t[to_cpu]=5.8e-05S speed=2.7e+00GB/S
check ||H-H.dagger||=2.730e-14 coord=(6,0) rank=0
ctns::oper_ab2pq coord=(6,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.11 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.517e+03S Sys:3.181e+00S Total:1.520e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=478:3.647e-03MB:3.561e-06GB
total mem of comb=16163:1.233e-01MB:1.204e-04GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.517e+03S Sys:3.182e+00S Total:1.520e+03S
##### local opt: 3.905e-01 S #####
 T(local opt: fetch) = 1.195e-02 S  per = 3.06  per(accum) = 3.06
 T(local opt: hdiag) = 2.352e-03 S  per = 0.602  per(accum) = 3.66
 T(local opt: dvdsn) = 2.596e-01 S  per = 66.5  per(accum) = 70.1
 T(local opt: decim) = 9.750e-04 S  per = 0.25  per(accum) = 70.4
 T(local opt: guess) = 2.281e-04 S  per = 0.0584  per(accum) = 70.5
 T(local opt: renrm) = 1.114e-01 S  per = 28.5  per(accum) = 99
 T(local opt: save ) = 3.992e-03 S  per = 1.02  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.596e-01 S  T(sum) = 2.592e-01 S  per = 9.983e+01
 T(local opt: preprocess                  ) = 5.590e-04 S  per = 0.216  per(accum) = 0.216
 T(local opt: symbolic_formulae           ) = 1.585e-02 S  per = 6.12  per(accum) = 6.33
 T(local opt: hintermediate init          ) = 4.179e-04 S  per = 0.161  per(accum) = 6.49
 T(local opt: preprocess_hformulae_Hxlist ) = 2.130e-02 S  per = 8.22  per(accum) = 14.7
 T(local opt: hmmtasks init               ) = 1.062e-01 S  per =   41  per(accum) = 55.7
 T(local opt: initial guess for dvdson    ) = 1.243e-05 S  per = 0.0048  per(accum) = 55.7
 T(local opt: dvdson solver [Hx_batchGPU] ) = 6.204e-02 S  per = 23.9  per(accum) = 79.6
 T(local opt: dvdson solver [comm(gpu)]   ) = 9.996e-04 S  per = 0.386  per(accum) = 80
 T(local opt: dvdson solver [comm(cpu)]   ) = 8.660e-07 S  per = 0.000334  per(accum) = 80
 T(local opt: dvdson solver [rest part]   ) = 5.185e-02 S  per =   20  per(accum) = 100
Detailed decomposition of T(renrm) = 1.114e-01 S  T(sum) = 1.114e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.823e-04 S  per = 0.164  per(accum) = 0.164
 T(local opt: qops init                    ) = 2.452e-03 S  per =  2.2  per(accum) = 2.36
 T(local opt: symbolic_formulae_renorm     ) = 1.477e-02 S  per = 13.3  per(accum) = 15.6
 T(local opt: allocate qops on gpu         ) = 3.750e-05 S  per = 0.0337  per(accum) = 15.7
 T(local opt: site memcpy cpu2gpu          ) = 2.324e-05 S  per = 0.0209  per(accum) = 15.7
 T(local opt: rintermediate init           ) = 6.432e-04 S  per = 0.577  per(accum) = 16.3
 T(local opt: preprocess_formulae_Rlist2   ) = 1.321e-02 S  per = 11.9  per(accum) = 28.1
 T(local opt: rmmtasks init                ) = 5.532e-02 S  per = 49.7  per(accum) = 77.8
 T(local opt: qops memset on cpu           ) = 7.100e-08 S  per = 6.37e-05  per(accum) = 77.8
 T(local opt: preprocess_renorm_batchGPU   ) = 2.333e-02 S  per = 20.9  per(accum) = 98.7
 T(local opt: reduction of opS & opH [nccl]) = 2.947e-06 S  per = 0.00265  per(accum) = 98.7
 T(local opt: qops memcpy gpu2cpu          ) = 6.467e-05 S  per = 0.058  per(accum) = 98.8
 T(local opt: deallocate cpu and gpu memory) = 1.938e-04 S  per = 0.174  per(accum) = 98.9
 T(local opt: reduction of opS & opH [comm]) = 4.896e-05 S  per = 0.0439  per(accum) = 99
 T(local opt: conversion from opAB to opPQ ) = 5.398e-06 S  per = 0.00485  per(accum) = 99
 T(local opt: after oper_renorm            ) = 1.122e-03 S  per = 1.01  per(accum) = 100
##### sweep opt: 1.997e+01 S #####
 T(sweep opt: fetch) = 4.469e-01 S  per = 2.24  per(accum) = 2.24
 T(sweep opt: hdiag) = 7.589e-02 S  per = 0.38  per(accum) = 2.62
 T(sweep opt: dvdsn) = 8.020e+00 S  per = 40.2  per(accum) = 42.8
 T(sweep opt: decim) = 3.737e-02 S  per = 0.187  per(accum) = 43
 T(sweep opt: guess) = 9.140e-03 S  per = 0.0458  per(accum) = 43
 T(sweep opt: renrm) = 1.130e+01 S  per = 56.6  per(accum) = 99.6
 T(sweep opt: save ) = 8.900e-02 S  per = 0.446  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.020e+00 S  T(sum) = 7.356e+00 S  per = 9.172e+01
 T(sweep opt: preprocess                  ) = 1.621e-02 S  per = 0.22  per(accum) = 0.22
 T(sweep opt: symbolic_formulae           ) = 5.140e-01 S  per = 6.99  per(accum) = 7.21
 T(sweep opt: hintermediate init          ) = 1.185e-02 S  per = 0.161  per(accum) = 7.37
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.045e-01 S  per = 8.22  per(accum) = 15.6
 T(sweep opt: hmmtasks init               ) = 3.461e+00 S  per = 47.1  per(accum) = 62.6
 T(sweep opt: initial guess for dvdson    ) = 2.681e-04 S  per = 0.00365  per(accum) = 62.6
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.292e+00 S  per = 17.6  per(accum) = 80.2
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 7.976e-03 S  per = 0.108  per(accum) = 80.3
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.608e-05 S  per = 0.000355  per(accum) = 80.3
 T(sweep opt: dvdson solver [rest part]   ) = 1.448e+00 S  per = 19.7  per(accum) = 100
Detailed decomposition of T(renrm) = 1.130e+01 S  T(sum) = 1.130e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.767e-03 S  per = 0.0865  per(accum) = 0.0865
 T(sweep opt: qops init                    ) = 1.088e-01 S  per = 0.963  per(accum) = 1.05
 T(sweep opt: symbolic_formulae_renorm     ) = 4.016e-01 S  per = 3.56  per(accum) = 4.6
 T(sweep opt: allocate qops on gpu         ) = 3.078e-03 S  per = 0.0273  per(accum) = 4.63
 T(sweep opt: site memcpy cpu2gpu          ) = 7.107e-04 S  per = 0.00629  per(accum) = 4.64
 T(sweep opt: rintermediate init           ) = 1.736e-02 S  per = 0.154  per(accum) = 4.79
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.601e-01 S  per = 3.19  per(accum) = 7.98
 T(sweep opt: rmmtasks init                ) = 1.393e+00 S  per = 12.3  per(accum) = 20.3
 T(sweep opt: qops memset on cpu           ) = 1.557e-06 S  per = 1.38e-05  per(accum) = 20.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.012e-01 S  per = 4.44  per(accum) = 24.8
 T(sweep opt: reduction of opS & opH [nccl]) = 3.732e-05 S  per = 0.00033  per(accum) = 24.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.273e-03 S  per = 0.0378  per(accum) = 24.8
 T(sweep opt: deallocate cpu and gpu memory) = 9.531e-01 S  per = 8.44  per(accum) = 33.2
 T(sweep opt: reduction of opS & opH [comm]) = 1.507e-03 S  per = 0.0133  per(accum) = 33.2
 T(sweep opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 66.5  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 2.494e-02 S  per = 0.221  per(accum) = 100
##### global opt: 1.997e+01 S #####
 T(global opt: fetch) = 4.469e-01 S  per = 2.24  per(accum) = 2.24
 T(global opt: hdiag) = 7.589e-02 S  per = 0.38  per(accum) = 2.62
 T(global opt: dvdsn) = 8.020e+00 S  per = 40.2  per(accum) = 42.8
 T(global opt: decim) = 3.737e-02 S  per = 0.187  per(accum) = 43
 T(global opt: guess) = 9.140e-03 S  per = 0.0458  per(accum) = 43
 T(global opt: renrm) = 1.130e+01 S  per = 56.6  per(accum) = 99.6
 T(global opt: save ) = 8.900e-02 S  per = 0.446  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.020e+00 S  T(sum) = 7.356e+00 S  per = 9.172e+01
 T(global opt: preprocess                  ) = 1.621e-02 S  per = 0.22  per(accum) = 0.22
 T(global opt: symbolic_formulae           ) = 5.140e-01 S  per = 6.99  per(accum) = 7.21
 T(global opt: hintermediate init          ) = 1.185e-02 S  per = 0.161  per(accum) = 7.37
 T(global opt: preprocess_hformulae_Hxlist ) = 6.045e-01 S  per = 8.22  per(accum) = 15.6
 T(global opt: hmmtasks init               ) = 3.461e+00 S  per = 47.1  per(accum) = 62.6
 T(global opt: initial guess for dvdson    ) = 2.681e-04 S  per = 0.00365  per(accum) = 62.6
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.292e+00 S  per = 17.6  per(accum) = 80.2
 T(global opt: dvdson solver [comm(gpu)]   ) = 7.976e-03 S  per = 0.108  per(accum) = 80.3
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.608e-05 S  per = 0.000355  per(accum) = 80.3
 T(global opt: dvdson solver [rest part]   ) = 1.448e+00 S  per = 19.7  per(accum) = 100
Detailed decomposition of T(renrm) = 1.130e+01 S  T(sum) = 1.130e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.767e-03 S  per = 0.0865  per(accum) = 0.0865
 T(global opt: qops init                    ) = 1.088e-01 S  per = 0.963  per(accum) = 1.05
 T(global opt: symbolic_formulae_renorm     ) = 4.016e-01 S  per = 3.56  per(accum) = 4.6
 T(global opt: allocate qops on gpu         ) = 3.078e-03 S  per = 0.0273  per(accum) = 4.63
 T(global opt: site memcpy cpu2gpu          ) = 7.107e-04 S  per = 0.00629  per(accum) = 4.64
 T(global opt: rintermediate init           ) = 1.736e-02 S  per = 0.154  per(accum) = 4.79
 T(global opt: preprocess_formulae_Rlist2   ) = 3.601e-01 S  per = 3.19  per(accum) = 7.98
 T(global opt: rmmtasks init                ) = 1.393e+00 S  per = 12.3  per(accum) = 20.3
 T(global opt: qops memset on cpu           ) = 1.557e-06 S  per = 1.38e-05  per(accum) = 20.3
 T(global opt: preprocess_renorm_batchGPU   ) = 5.012e-01 S  per = 4.44  per(accum) = 24.8
 T(global opt: reduction of opS & opH [nccl]) = 3.732e-05 S  per = 0.00033  per(accum) = 24.8
 T(global opt: qops memcpy gpu2cpu          ) = 4.273e-03 S  per = 0.0378  per(accum) = 24.8
 T(global opt: deallocate cpu and gpu memory) = 9.531e-01 S  per = 8.44  per(accum) = 33.2
 T(global opt: reduction of opS & opH [comm]) = 1.507e-03 S  per = 0.0133  per(accum) = 33.2
 T(global opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 66.5  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 2.494e-02 S  per = 0.221  per(accum) = 100

isweep=0 ibond=30/seqsize=34 dots=1 dbond=(4,0)-(5,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.517e+03S Sys:3.182e+00S Total:1.520e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=478:3.647e-03MB:3.561e-06GB
total mem of comb=16163:1.233e-01MB:1.204e-04GB
ctns::topology::check_partition: (sl,sr,sc)=5,14,1
 suppl= 0 1 2 3 4
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 16
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:10 S:30 H:1 A:45 B:55 
        dim(bra,ket)=27,27 size(op)=159:1.213e-03MB size(tot)=9444:7.205e-02MB:7.036e-05GB
 rqops: oplist=CSHPQ nops=C:28 S:12 H:1 P:66 Q:78 
        dim(bra,ket)=38,38 size(op)=208:1.587e-03MB size(tot)=21107:1.610e-01MB:1.573e-04GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=32887:2.509e-01MB:2.450e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(5,0) fdel=./scratch/sweep/lop(4,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
wf3(diml,dimr,dimc)=(27,38,4) nnz=478:3.647e-03MB
qtensor3: wf3 own=1 _data=0x52e26bb0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=7 dimAll=27
 (8,2):8 (7,3):8 (6,4):4 (9,1):3 (6,2):2 (7,1):1 (5,5):1
 qbond: qcol nsym=10 dimAll=38
 (21,-1):8 (22,-2):8 (21,-3):6 (23,-3):4 (20,-2):3 (20,0):3 (23,-1):2 (22,-4):2 (22,0):1 (24,-4):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=22 nblocks=280 size=478:3.647e-03MB
### DIAG TIMING: total=1.404e-03 t1=1.348e-05, t2=2.727e-05, t3=4.543e-05, t4=1.281e-03, t5=1.443e-05, t6=1.896e-05, t7=3.521e-06
duration_diagGPU:1.415e-03
duration_diagreduce:3.500e-08
duration_diagtransform:2.323e-06
----- TIMING FOR symbolic_formulae_onedot with size=607 : 1.199e-02 S -----
rank=0 GPUmem(GB): used=0.000245 (oper)=0.000245
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=607
 no. of hintermediate operators=280
 no. of coefficients=3920:0.0299MB:2.92e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.998e-04 S -----
rank=0 GPUmem(GB): used=0.000274 (oper,hinter)=0.000245,2.92e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0106 S size(H_formulae)=607 size(Hxlst2)=22 T(Hmu/Hxlist)=0.00156,0.00904 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0114 S size(H_formulae)=607 size(Hxlst)=8728 -----
rank=0 GPUmem(GB): used=0.0128 (oper,hinter,dvdson,batch)=0.000245,2.92e-05,7.12e-06,0.0126 blksize=64 blksize0=64 batchsize=8728
ctns::pdvdsonSolver_nkr::solve_iter ndim=478 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.41e-05,0.00173,0.022,0.00216,0.026
 ndim=478:3.56e-06GB t[comm(intra)]=3.3e-05 speed=0.216GB/S t[comm(inter)]=1.11e-05 speed=0.643GB/S
--- TIMING FOR sigma : t_inter=1.7e-03 t_gemm=2.2e-02 t_reduction=2.2e-03 tot=2.6e-02 ---
 sigma[inter] counter=204 t=1.7e-03 per=6.7e+00 cost=2.5e+06 flops=1.5e+09
 sigma[gemm] counter=204 i=0 t=1.8e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=1 t=1.3e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=2 t=5.7e-03 per=2.2e+01 cost=9.2e+05 flops=1.6e+08
 sigma[gemm] counter=204 i=3 t=6.4e-03 per=2.5e+01 cost=9.4e+05 flops=1.5e+08
 sigma[gemm] counter=204 i=4 t=4.9e-03 per=1.9e+01 cost=1.0e+06 flops=2.1e+08
 sigma[gemm] counter=204 i=5 t=5.0e-03 per=1.9e+01 cost=1.0e+06 flops=2.1e+08
 sigma[gemm] counter=204 total t=2.2e-02 per=8.5e+01 cost=3.9e+06 flops=1.8e+08
 sigma[red] counter=204 t=2.2e-03 per=8.3e+00 cost=4.2e+05 flops=1.9e+08
--- TIMING FOR sigma_tot : t_inter=9.4e-02 t_gemm=1.0e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=204 t=9.4e-02 per=7.4e+00 cost=1.9e+09 flops=2.0e+10
 sigma_tot[gemm] counter=204 i=0 t=4.0e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=1 t=3.4e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=2 t=2.7e-01 per=2.1e+01 cost=1.7e+09 flops=6.2e+09
 sigma_tot[gemm] counter=204 i=3 t=2.7e-01 per=2.1e+01 cost=1.6e+09 flops=6.1e+09
 sigma_tot[gemm] counter=204 i=4 t=2.6e-01 per=2.0e+01 cost=1.4e+09 flops=5.3e+09
 sigma_tot[gemm] counter=204 i=5 t=2.5e-01 per=1.9e+01 cost=1.4e+09 flops=5.7e+09
 sigma_tot[gemm] counter=204 total t=1.0e+00 per=8.1e+01 cost=6.0e+09 flops=5.8e+09
 sigma_tot[red] counter=204 t=1.5e-01 per=1.1e+01 cost=4.0e+08 flops=2.7e+09
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=7.9e-06,9.0e-06,2.4e-06,1.8e-06,3.3e-07
settings: ndim=478 neig=1 maxcycle=30 nbuff=4 memory=5e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.545613677065 -1.117e+03  1.587e-02    1     1  2.615e-02 2.615e-02 2.609e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.073e-05,2.823e-04,2.937e-03,5.048e-04,3.778e-03
 ndim=478:3.561e-06GB t[comm(intra)]=3.426e-05 speed=2.079e-01GB/S t[comm(inter)]=6.470e-06 speed=1.101e+00GB/S
--- TIMING FOR sigma : t_inter=2.8e-04 t_gemm=2.9e-03 t_reduction=5.0e-04 tot=3.7e-03 ---
 sigma[inter] counter=205 t=2.8e-04 per=7.6e+00 cost=2.5e+06 flops=9.0e+09
 sigma[gemm] counter=205 i=0 t=2.0e-06 per=5.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=205 i=1 t=1.9e-06 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=205 i=2 t=7.9e-04 per=2.1e+01 cost=9.2e+05 flops=1.2e+09
 sigma[gemm] counter=205 i=3 t=7.8e-04 per=2.1e+01 cost=9.4e+05 flops=1.2e+09
 sigma[gemm] counter=205 i=4 t=6.9e-04 per=1.9e+01 cost=1.0e+06 flops=1.5e+09
 sigma[gemm] counter=205 i=5 t=6.8e-04 per=1.8e+01 cost=1.0e+06 flops=1.6e+09
 sigma[gemm] counter=205 total t=2.9e-03 per=7.9e+01 cost=3.9e+06 flops=1.3e+09
 sigma[red] counter=205 t=5.0e-04 per=1.4e+01 cost=4.2e+05 flops=8.3e+08
--- TIMING FOR sigma_tot : t_inter=9.5e-02 t_gemm=1.0e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=205 t=9.5e-02 per=7.4e+00 cost=1.9e+09 flops=2.0e+10
 sigma_tot[gemm] counter=205 i=0 t=4.1e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=205 i=1 t=3.4e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=205 i=2 t=2.7e-01 per=2.1e+01 cost=1.7e+09 flops=6.2e+09
 sigma_tot[gemm] counter=205 i=3 t=2.7e-01 per=2.1e+01 cost=1.6e+09 flops=6.1e+09
 sigma_tot[gemm] counter=205 i=4 t=2.6e-01 per=2.0e+01 cost=1.4e+09 flops=5.3e+09
 sigma_tot[gemm] counter=205 i=5 t=2.5e-01 per=1.9e+01 cost=1.4e+09 flops=5.7e+09
 sigma_tot[gemm] counter=205 total t=1.0e+00 per=8.1e+01 cost=6.1e+09 flops=5.8e+09
 sigma_tot[red] counter=205 t=1.5e-01 per=1.1e+01 cost=4.0e+08 flops=2.7e+09
T(sub)=8.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,6.2e-05,4.9e-06,3.5e-06,3.5e-07
    2   0 -    -116.545913927706 -3.003e-04  3.777e-03    2     2  3.978e-02 1.989e-02 1.500e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.818e-05,2.737e-04,2.837e-03,5.236e-04,3.671e-03
 ndim=478:3.561e-06GB t[comm(intra)]=2.317e-05 speed=3.074e-01GB/S t[comm(inter)]=5.009e-06 speed=1.422e+00GB/S
--- TIMING FOR sigma : t_inter=2.7e-04 t_gemm=2.8e-03 t_reduction=5.2e-04 tot=3.6e-03 ---
 sigma[inter] counter=206 t=2.7e-04 per=7.5e+00 cost=2.5e+06 flops=9.3e+09
 sigma[gemm] counter=206 i=0 t=1.9e-06 per=5.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=206 i=1 t=1.7e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=206 i=2 t=7.7e-04 per=2.1e+01 cost=9.2e+05 flops=1.2e+09
 sigma[gemm] counter=206 i=3 t=7.6e-04 per=2.1e+01 cost=9.4e+05 flops=1.2e+09
 sigma[gemm] counter=206 i=4 t=6.3e-04 per=1.7e+01 cost=1.0e+06 flops=1.6e+09
 sigma[gemm] counter=206 i=5 t=6.6e-04 per=1.8e+01 cost=1.0e+06 flops=1.6e+09
 sigma[gemm] counter=206 total t=2.8e-03 per=7.8e+01 cost=3.9e+06 flops=1.4e+09
 sigma[red] counter=206 t=5.2e-04 per=1.4e+01 cost=4.2e+05 flops=8.0e+08
--- TIMING FOR sigma_tot : t_inter=9.5e-02 t_gemm=1.0e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=206 t=9.5e-02 per=7.4e+00 cost=1.9e+09 flops=2.0e+10
 sigma_tot[gemm] counter=206 i=0 t=4.1e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=206 i=1 t=3.4e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=206 i=2 t=2.7e-01 per=2.1e+01 cost=1.7e+09 flops=6.2e+09
 sigma_tot[gemm] counter=206 i=3 t=2.7e-01 per=2.1e+01 cost=1.6e+09 flops=6.1e+09
 sigma_tot[gemm] counter=206 i=4 t=2.6e-01 per=2.0e+01 cost=1.4e+09 flops=5.3e+09
 sigma_tot[gemm] counter=206 i=5 t=2.5e-01 per=1.9e+01 cost=1.4e+09 flops=5.6e+09
 sigma_tot[gemm] counter=206 total t=1.0e+00 per=8.1e+01 cost=6.1e+09 flops=5.8e+09
 sigma_tot[red] counter=206 t=1.5e-01 per=1.1e+01 cost=4.0e+08 flops=2.7e+09
T(sub)=5.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,3.4e-05,3.8e-06,3.6e-06,3.4e-07
    3   0 -    -116.545935485174 -2.156e-05  1.407e-03    3     3  5.311e-02 1.770e-02 1.127e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.782e-05,2.687e-04,2.831e-03,5.117e-04,3.647e-03
 ndim=478:3.561e-06GB t[comm(intra)]=2.300e-05 speed=3.097e-01GB/S t[comm(inter)]=4.828e-06 speed=1.475e+00GB/S
--- TIMING FOR sigma : t_inter=2.7e-04 t_gemm=2.8e-03 t_reduction=5.1e-04 tot=3.6e-03 ---
 sigma[inter] counter=207 t=2.7e-04 per=7.4e+00 cost=2.5e+06 flops=9.5e+09
 sigma[gemm] counter=207 i=0 t=2.0e-06 per=5.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=207 i=1 t=1.7e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=207 i=2 t=7.7e-04 per=2.1e+01 cost=9.2e+05 flops=1.2e+09
 sigma[gemm] counter=207 i=3 t=7.6e-04 per=2.1e+01 cost=9.4e+05 flops=1.2e+09
 sigma[gemm] counter=207 i=4 t=6.6e-04 per=1.8e+01 cost=1.0e+06 flops=1.6e+09
 sigma[gemm] counter=207 i=5 t=6.4e-04 per=1.8e+01 cost=1.0e+06 flops=1.7e+09
 sigma[gemm] counter=207 total t=2.8e-03 per=7.8e+01 cost=3.9e+06 flops=1.4e+09
 sigma[red] counter=207 t=5.1e-04 per=1.4e+01 cost=4.2e+05 flops=8.2e+08
--- TIMING FOR sigma_tot : t_inter=9.5e-02 t_gemm=1.0e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=207 t=9.5e-02 per=7.4e+00 cost=1.9e+09 flops=2.0e+10
 sigma_tot[gemm] counter=207 i=0 t=4.1e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=207 i=1 t=3.4e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=207 i=2 t=2.7e-01 per=2.1e+01 cost=1.7e+09 flops=6.2e+09
 sigma_tot[gemm] counter=207 i=3 t=2.7e-01 per=2.1e+01 cost=1.6e+09 flops=6.0e+09
 sigma_tot[gemm] counter=207 i=4 t=2.6e-01 per=2.0e+01 cost=1.4e+09 flops=5.3e+09
 sigma_tot[gemm] counter=207 i=5 t=2.5e-01 per=1.9e+01 cost=1.4e+09 flops=5.6e+09
 sigma_tot[gemm] counter=207 total t=1.0e+00 per=8.1e+01 cost=6.1e+09 flops=5.8e+09
 sigma_tot[red] counter=207 t=1.5e-01 per=1.1e+01 cost=4.0e+08 flops=2.7e+09
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,3.0e-05,3.7e-06,3.6e-06,3.3e-07
    4   0 -    -116.545938769422 -3.284e-06  4.798e-04    3     4  6.818e-02 1.704e-02 9.395e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.728e-05,2.559e-04,2.797e-03,4.922e-04,3.590e-03
 ndim=478:3.561e-06GB t[comm(intra)]=2.270e-05 speed=3.138e-01GB/S t[comm(inter)]=1.458e-05 speed=4.885e-01GB/S
--- TIMING FOR sigma : t_inter=2.6e-04 t_gemm=2.8e-03 t_reduction=4.9e-04 tot=3.5e-03 ---
 sigma[inter] counter=208 t=2.6e-04 per=7.2e+00 cost=2.5e+06 flops=1.0e+10
 sigma[gemm] counter=208 i=0 t=2.0e-06 per=5.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=208 i=1 t=1.7e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=208 i=2 t=7.5e-04 per=2.1e+01 cost=9.2e+05 flops=1.2e+09
 sigma[gemm] counter=208 i=3 t=7.5e-04 per=2.1e+01 cost=9.4e+05 flops=1.2e+09
 sigma[gemm] counter=208 i=4 t=6.2e-04 per=1.8e+01 cost=1.0e+06 flops=1.6e+09
 sigma[gemm] counter=208 i=5 t=6.6e-04 per=1.9e+01 cost=1.0e+06 flops=1.6e+09
 sigma[gemm] counter=208 total t=2.8e-03 per=7.9e+01 cost=3.9e+06 flops=1.4e+09
 sigma[red] counter=208 t=4.9e-04 per=1.4e+01 cost=4.2e+05 flops=8.5e+08
--- TIMING FOR sigma_tot : t_inter=9.5e-02 t_gemm=1.1e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=208 t=9.5e-02 per=7.4e+00 cost=1.9e+09 flops=2.0e+10
 sigma_tot[gemm] counter=208 i=0 t=4.1e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=208 i=1 t=3.4e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=208 i=2 t=2.7e-01 per=2.1e+01 cost=1.7e+09 flops=6.1e+09
 sigma_tot[gemm] counter=208 i=3 t=2.7e-01 per=2.1e+01 cost=1.6e+09 flops=6.0e+09
 sigma_tot[gemm] counter=208 i=4 t=2.6e-01 per=2.0e+01 cost=1.4e+09 flops=5.3e+09
 sigma_tot[gemm] counter=208 i=5 t=2.5e-01 per=1.9e+01 cost=1.4e+09 flops=5.6e+09
 sigma_tot[gemm] counter=208 total t=1.1e+00 per=8.1e+01 cost=6.1e+09 flops=5.8e+09
 sigma_tot[red] counter=208 t=1.5e-01 per=1.1e+01 cost=4.0e+08 flops=2.7e+09
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.0e-05,1.8e-05,3.4e-06,3.5e-06,3.5e-07
    5   0 -    -116.545939094960 -3.255e-07  1.652e-04    3     5  7.689e-02 1.538e-02 8.266e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.634e-05,2.326e-04,2.800e-03,4.910e-04,3.558e-03
 ndim=478:3.561e-06GB t[comm(intra)]=2.149e-05 speed=3.315e-01GB/S t[comm(inter)]=4.854e-06 speed=1.467e+00GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=2.8e-03 t_reduction=4.9e-04 tot=3.5e-03 ---
 sigma[inter] counter=209 t=2.3e-04 per=6.6e+00 cost=2.5e+06 flops=1.1e+10
 sigma[gemm] counter=209 i=0 t=1.6e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=209 i=1 t=1.5e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=209 i=2 t=7.1e-04 per=2.0e+01 cost=9.2e+05 flops=1.3e+09
 sigma[gemm] counter=209 i=3 t=7.7e-04 per=2.2e+01 cost=9.4e+05 flops=1.2e+09
 sigma[gemm] counter=209 i=4 t=6.4e-04 per=1.8e+01 cost=1.0e+06 flops=1.6e+09
 sigma[gemm] counter=209 i=5 t=6.7e-04 per=1.9e+01 cost=1.0e+06 flops=1.6e+09
 sigma[gemm] counter=209 total t=2.8e-03 per=7.9e+01 cost=3.9e+06 flops=1.4e+09
 sigma[red] counter=209 t=4.9e-04 per=1.4e+01 cost=4.2e+05 flops=8.5e+08
--- TIMING FOR sigma_tot : t_inter=9.6e-02 t_gemm=1.1e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=209 t=9.6e-02 per=7.4e+00 cost=1.9e+09 flops=2.0e+10
 sigma_tot[gemm] counter=209 i=0 t=4.1e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=209 i=1 t=3.4e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=209 i=2 t=2.7e-01 per=2.1e+01 cost=1.7e+09 flops=6.1e+09
 sigma_tot[gemm] counter=209 i=3 t=2.7e-01 per=2.1e+01 cost=1.6e+09 flops=6.0e+09
 sigma_tot[gemm] counter=209 i=4 t=2.6e-01 per=2.0e+01 cost=1.4e+09 flops=5.3e+09
 sigma_tot[gemm] counter=209 i=5 t=2.5e-01 per=1.9e+01 cost=1.4e+09 flops=5.6e+09
 sigma_tot[gemm] counter=209 total t=1.1e+00 per=8.1e+01 cost=6.1e+09 flops=5.8e+09
 sigma_tot[red] counter=209 t=1.5e-01 per=1.1e+01 cost=4.0e+08 flops=2.7e+09
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.0e-05,1.7e-05,3.4e-06,1.4e-05,4.4e-07
    6   0 +    -116.545939137556 -4.260e-08  7.970e-05    3     6  9.487e-02 1.581e-02 8.286e-03
TIMING FOR Davidson : 9.489e-02  T(cal/comm/rest)=4.972e-02,7.750e-07,4.517e-02
decomposed t_rest=4.517e-02
 T(sub)    =2.882e-04 per=6.381e-01
 T(precond)=4.466e-02 per=9.886e+01
 T(ortho)  =2.385e-05 per=5.280e-02
 T(xcopy)  =2.628e-06 per=5.818e-03
 T(xnrm2)  =4.652e-06 per=1.030e-02
 T(other)  =1.952e-04 per=4.322e-01
optimized energies: isweep=0 ibond=30 dots=1 e[0]=-116.545939137556 nmvp=6
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.525e+03S Sys:3.184e+00S Total:1.528e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=19 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond30.txt
 qbond: qsuper nsym=19 dimAll=152
 (21,-1):14 (22,-2):25 (21,-3):9 (23,-3):20 (20,-2):3 (20,0):3 (23,-1):19 (22,-4):8 (22,0):12 (24,-4):7 (24,-2):14 (25,-3):5 (25,-1):2 (24,0):3 (26,-4):1 (21,1):3 (23,1):1 (23,-5):2 (25,-5):1
timing for divide=2.0e-05
timing for compute=2.5e-04
timing for collect=1.9e-05
----- TMING FOR decimation_genbasis(nkr): 2.9e-04 S T(divide/compute/collect)=2.0e-05,2.5e-04,1.9e-05 -----
decimation summary: 152->27 dwt=+0.000e+00 SvN=1.302e+00
 qbond: qkept nsym=7 dimAll=27
 (22,-2):8 (23,-3):8 (24,-4):4 (21,-1):3 (24,-2):2 (23,-1):1 (25,-5):1
----- TIMING for decimation_row(nkr): 8.397e-04 S T(decim/select/formRot)=4.019e-04,3.989e-04,3.891e-05 -----
----- TIMING FOR onedot_decimation: 1.094e-03 S T(wf/decim)=1.983e-04,8.955e-04 -----
ctns::oper_renorm coord=(5,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:30 S:10 H:1 P:45 Q:55 
        dim(bra,ket)=27,27 size(op)=159:1.213e-03MB size(tot)=9444:7.205e-02MB:7.036e-05GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.525e+03S Sys:3.184e+00S Total:1.528e+03S
----- TIMING FOR symbolic_formulae_renorm with size=141 : 1.141e-02 S -----
rank=0 GPUmem(GB): used=0.000274 (oper)=0.000245
rank=0 GPUmem(GB): used=0.000278 (oper,site)(GB)=0.000245,3.56e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=280
 no. of coefficients=3920:0.0299MB:2.92e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.535e-04 S -----
rank=0 GPUmem(GB): used=0.000307 (oper,site,rinter)=0.000245,3.56e-06,2.92e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00754 S size(rtasks)=141 size(Rlst2)=49 T(Rmu/Rlist)=0.00177,0.00577 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00802 S size(rtasks)=141 size(Rlst)=4682 -----
rank=0 GPUmem(GB): used=0.000307 (oper,site,rinter,batch)=0.000245,3.56e-06,2.92e-05,0.00673 blksize=64 blksize0=64 batchsize=4682
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00164,0.0115,0.00305
--- TIMING FOR renorm : t_inter=1.6e-03 t_gemm=1.2e-02 t_reduction=3.0e-03 tot=1.6e-02 ---
 renorm[inter] counter=31 t=1.6e-03 per=1.0e+01 cost=1.3e+06 flops=7.8e+08
 renorm[gemm] counter=31 i=0 t=1.6e-06 per=9.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=1 t=1.2e-06 per=7.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=2 t=3.6e-03 per=2.2e+01 cost=3.2e+05 flops=8.8e+07
 renorm[gemm] counter=31 i=3 t=2.7e-03 per=1.7e+01 cost=6.3e+05 flops=2.3e+08
 renorm[gemm] counter=31 i=4 t=1.3e-06 per=7.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=5 t=1.2e-06 per=7.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=6 t=5.2e-03 per=3.2e+01 cost=1.3e+06 flops=2.4e+08
 renorm[gemm] counter=31 total t=1.2e-02 per=7.1e+01 cost=2.2e+06 flops=1.9e+08
 renorm[red] counter=31 t=3.0e-03 per=1.9e+01 cost=2.4e+05 flops=7.7e+07
--- TIMING FOR renorm_tot : t_inter=3.8e-02 t_gemm=3.8e-01 t_reduction=9.8e-02 tot=5.1e-01 ---
 renorm_tot[inter] counter=31 t=3.8e-02 per=7.4e+00 cost=1.3e+08 flops=3.4e+09
 renorm_tot[gemm] counter=31 i=0 t=4.6e-05 per=9.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=31 i=1 t=3.7e-05 per=7.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=31 i=2 t=6.6e-02 per=1.3e+01 cost=2.2e+07 flops=3.4e+08
 renorm_tot[gemm] counter=31 i=3 t=5.5e-02 per=1.1e+01 cost=5.0e+07 flops=9.0e+08
 renorm_tot[gemm] counter=31 i=4 t=4.4e-02 per=8.5e+00 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=31 i=5 t=5.4e-02 per=1.1e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=31 i=6 t=1.6e-01 per=3.1e+01 cost=1.8e+08 flops=1.1e+09
 renorm_tot[gemm] counter=31 total t=3.8e-01 per=7.3e+01 cost=3.3e+08 flops=8.7e+08
 renorm_tot[red] counter=31 t=9.8e-02 per=1.9e+01 cost=2.2e+07 flops=2.3e+08
qops.to_cpu: size(tot)=9444:7.2e-02MB:7.0e-05GB t[to_cpu]=3.6e-05S speed=2.0e+00GB/S
check ||H-H.dagger||=3.148e-14 coord=(5,0) rank=0
ctns::oper_ab2pq coord=(5,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0679 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.525e+03S Sys:3.186e+00S Total:1.528e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=213:1.625e-03MB:1.587e-06GB
total mem of comb=15898:1.213e-01MB:1.184e-04GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.525e+03S Sys:3.186e+00S Total:1.528e+03S
##### local opt: 2.577e-01 S #####
 T(local opt: fetch) = 1.076e-02 S  per = 4.18  per(accum) = 4.18
 T(local opt: hdiag) = 1.481e-03 S  per = 0.575  per(accum) = 4.75
 T(local opt: dvdsn) = 1.718e-01 S  per = 66.7  per(accum) = 71.4
 T(local opt: decim) = 1.105e-03 S  per = 0.429  per(accum) = 71.8
 T(local opt: guess) = 2.344e-04 S  per = 0.0909  per(accum) = 71.9
 T(local opt: renrm) = 6.884e-02 S  per = 26.7  per(accum) = 98.6
 T(local opt: save ) = 3.523e-03 S  per = 1.37  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.718e-01 S  T(sum) = 1.713e-01 S  per = 9.969e+01
 T(local opt: preprocess                  ) = 3.913e-04 S  per = 0.228  per(accum) = 0.228
 T(local opt: symbolic_formulae           ) = 1.200e-02 S  per = 7.01  per(accum) = 7.24
 T(local opt: hintermediate init          ) = 3.172e-04 S  per = 0.185  per(accum) = 7.42
 T(local opt: preprocess_hformulae_Hxlist ) = 1.175e-02 S  per = 6.86  per(accum) = 14.3
 T(local opt: hmmtasks init               ) = 5.191e-02 S  per = 30.3  per(accum) = 44.6
 T(local opt: initial guess for dvdson    ) = 9.686e-06 S  per = 0.00566  per(accum) = 44.6
 T(local opt: dvdson solver [Hx_batchGPU] ) = 4.951e-02 S  per = 28.9  per(accum) = 73.5
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.044e-04 S  per = 0.119  per(accum) = 73.6
 T(local opt: dvdson solver [comm(cpu)]   ) = 7.750e-07 S  per = 0.000452  per(accum) = 73.6
 T(local opt: dvdson solver [rest part]   ) = 4.517e-02 S  per = 26.4  per(accum) = 100
Detailed decomposition of T(renrm) = 6.884e-02 S  T(sum) = 6.884e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.185e-04 S  per = 0.317  per(accum) = 0.317
 T(local opt: qops init                    ) = 1.499e-03 S  per = 2.18  per(accum) = 2.5
 T(local opt: symbolic_formulae_renorm     ) = 1.142e-02 S  per = 16.6  per(accum) = 19.1
 T(local opt: allocate qops on gpu         ) = 4.285e-05 S  per = 0.0622  per(accum) = 19.2
 T(local opt: site memcpy cpu2gpu          ) = 2.459e-05 S  per = 0.0357  per(accum) = 19.2
 T(local opt: rintermediate init           ) = 4.644e-04 S  per = 0.675  per(accum) = 19.9
 T(local opt: preprocess_formulae_Rlist2   ) = 8.220e-03 S  per = 11.9  per(accum) = 31.8
 T(local opt: rmmtasks init                ) = 2.965e-02 S  per = 43.1  per(accum) = 74.9
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 6.25e-05  per(accum) = 74.9
 T(local opt: preprocess_renorm_batchGPU   ) = 1.633e-02 S  per = 23.7  per(accum) = 98.6
 T(local opt: reduction of opS & opH [nccl]) = 2.228e-06 S  per = 0.00324  per(accum) = 98.6
 T(local opt: qops memcpy gpu2cpu          ) = 4.232e-05 S  per = 0.0615  per(accum) = 98.7
 T(local opt: deallocate cpu and gpu memory) = 1.674e-04 S  per = 0.243  per(accum) = 98.9
 T(local opt: reduction of opS & opH [comm]) = 4.444e-05 S  per = 0.0646  per(accum) = 99
 T(local opt: conversion from opAB to opPQ ) = 5.012e-06 S  per = 0.00728  per(accum) = 99
 T(local opt: after oper_renorm            ) = 7.106e-04 S  per = 1.03  per(accum) = 100
##### sweep opt: 2.023e+01 S #####
 T(sweep opt: fetch) = 4.577e-01 S  per = 2.26  per(accum) = 2.26
 T(sweep opt: hdiag) = 7.737e-02 S  per = 0.382  per(accum) = 2.64
 T(sweep opt: dvdsn) = 8.191e+00 S  per = 40.5  per(accum) = 43.1
 T(sweep opt: decim) = 3.848e-02 S  per = 0.19  per(accum) = 43.3
 T(sweep opt: guess) = 9.374e-03 S  per = 0.0463  per(accum) = 43.4
 T(sweep opt: renrm) = 1.136e+01 S  per = 56.2  per(accum) = 99.5
 T(sweep opt: save ) = 9.252e-02 S  per = 0.457  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.191e+00 S  T(sum) = 7.527e+00 S  per = 9.189e+01
 T(sweep opt: preprocess                  ) = 1.660e-02 S  per = 0.221  per(accum) = 0.221
 T(sweep opt: symbolic_formulae           ) = 5.260e-01 S  per = 6.99  per(accum) = 7.21
 T(sweep opt: hintermediate init          ) = 1.216e-02 S  per = 0.162  per(accum) = 7.37
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.163e-01 S  per = 8.19  per(accum) = 15.6
 T(sweep opt: hmmtasks init               ) = 3.513e+00 S  per = 46.7  per(accum) = 62.2
 T(sweep opt: initial guess for dvdson    ) = 2.778e-04 S  per = 0.00369  per(accum) = 62.2
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.341e+00 S  per = 17.8  per(accum) = 80.1
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 8.181e-03 S  per = 0.109  per(accum) = 80.2
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.685e-05 S  per = 0.000357  per(accum) = 80.2
 T(sweep opt: dvdson solver [rest part]   ) = 1.493e+00 S  per = 19.8  per(accum) = 100
Detailed decomposition of T(renrm) = 1.136e+01 S  T(sum) = 1.136e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.985e-03 S  per = 0.0879  per(accum) = 0.0879
 T(sweep opt: qops init                    ) = 1.103e-01 S  per = 0.971  per(accum) = 1.06
 T(sweep opt: symbolic_formulae_renorm     ) = 4.130e-01 S  per = 3.63  per(accum) = 4.69
 T(sweep opt: allocate qops on gpu         ) = 3.121e-03 S  per = 0.0275  per(accum) = 4.72
 T(sweep opt: site memcpy cpu2gpu          ) = 7.353e-04 S  per = 0.00647  per(accum) = 4.73
 T(sweep opt: rintermediate init           ) = 1.782e-02 S  per = 0.157  per(accum) = 4.88
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.683e-01 S  per = 3.24  per(accum) = 8.12
 T(sweep opt: rmmtasks init                ) = 1.423e+00 S  per = 12.5  per(accum) = 20.6
 T(sweep opt: qops memset on cpu           ) = 1.600e-06 S  per = 1.41e-05  per(accum) = 20.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.175e-01 S  per = 4.55  per(accum) = 25.2
 T(sweep opt: reduction of opS & opH [nccl]) = 3.955e-05 S  per = 0.000348  per(accum) = 25.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.315e-03 S  per = 0.038  per(accum) = 25.2
 T(sweep opt: deallocate cpu and gpu memory) = 9.532e-01 S  per = 8.39  per(accum) = 33.6
 T(sweep opt: reduction of opS & opH [comm]) = 1.551e-03 S  per = 0.0136  per(accum) = 33.6
 T(sweep opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 66.1  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 2.565e-02 S  per = 0.226  per(accum) = 100
##### global opt: 2.023e+01 S #####
 T(global opt: fetch) = 4.577e-01 S  per = 2.26  per(accum) = 2.26
 T(global opt: hdiag) = 7.737e-02 S  per = 0.382  per(accum) = 2.64
 T(global opt: dvdsn) = 8.191e+00 S  per = 40.5  per(accum) = 43.1
 T(global opt: decim) = 3.848e-02 S  per = 0.19  per(accum) = 43.3
 T(global opt: guess) = 9.374e-03 S  per = 0.0463  per(accum) = 43.4
 T(global opt: renrm) = 1.136e+01 S  per = 56.2  per(accum) = 99.5
 T(global opt: save ) = 9.252e-02 S  per = 0.457  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.191e+00 S  T(sum) = 7.527e+00 S  per = 9.189e+01
 T(global opt: preprocess                  ) = 1.660e-02 S  per = 0.221  per(accum) = 0.221
 T(global opt: symbolic_formulae           ) = 5.260e-01 S  per = 6.99  per(accum) = 7.21
 T(global opt: hintermediate init          ) = 1.216e-02 S  per = 0.162  per(accum) = 7.37
 T(global opt: preprocess_hformulae_Hxlist ) = 6.163e-01 S  per = 8.19  per(accum) = 15.6
 T(global opt: hmmtasks init               ) = 3.513e+00 S  per = 46.7  per(accum) = 62.2
 T(global opt: initial guess for dvdson    ) = 2.778e-04 S  per = 0.00369  per(accum) = 62.2
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.341e+00 S  per = 17.8  per(accum) = 80.1
 T(global opt: dvdson solver [comm(gpu)]   ) = 8.181e-03 S  per = 0.109  per(accum) = 80.2
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.685e-05 S  per = 0.000357  per(accum) = 80.2
 T(global opt: dvdson solver [rest part]   ) = 1.493e+00 S  per = 19.8  per(accum) = 100
Detailed decomposition of T(renrm) = 1.136e+01 S  T(sum) = 1.136e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.985e-03 S  per = 0.0879  per(accum) = 0.0879
 T(global opt: qops init                    ) = 1.103e-01 S  per = 0.971  per(accum) = 1.06
 T(global opt: symbolic_formulae_renorm     ) = 4.130e-01 S  per = 3.63  per(accum) = 4.69
 T(global opt: allocate qops on gpu         ) = 3.121e-03 S  per = 0.0275  per(accum) = 4.72
 T(global opt: site memcpy cpu2gpu          ) = 7.353e-04 S  per = 0.00647  per(accum) = 4.73
 T(global opt: rintermediate init           ) = 1.782e-02 S  per = 0.157  per(accum) = 4.88
 T(global opt: preprocess_formulae_Rlist2   ) = 3.683e-01 S  per = 3.24  per(accum) = 8.12
 T(global opt: rmmtasks init                ) = 1.423e+00 S  per = 12.5  per(accum) = 20.6
 T(global opt: qops memset on cpu           ) = 1.600e-06 S  per = 1.41e-05  per(accum) = 20.6
 T(global opt: preprocess_renorm_batchGPU   ) = 5.175e-01 S  per = 4.55  per(accum) = 25.2
 T(global opt: reduction of opS & opH [nccl]) = 3.955e-05 S  per = 0.000348  per(accum) = 25.2
 T(global opt: qops memcpy gpu2cpu          ) = 4.315e-03 S  per = 0.038  per(accum) = 25.2
 T(global opt: deallocate cpu and gpu memory) = 9.532e-01 S  per = 8.39  per(accum) = 33.6
 T(global opt: reduction of opS & opH [comm]) = 1.551e-03 S  per = 0.0136  per(accum) = 33.6
 T(global opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 66.1  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 2.565e-02 S  per = 0.226  per(accum) = 100

isweep=0 ibond=31/seqsize=34 dots=1 dbond=(3,0)-(4,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.525e+03S Sys:3.186e+00S Total:1.528e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=213:1.625e-03MB:1.587e-06GB
total mem of comb=15898:1.213e-01MB:1.184e-04GB
ctns::topology::check_partition: (sl,sr,sc)=4,15,1
 suppl= 0 1 2 3
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 4
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:8 S:32 H:1 A:28 B:36 
        dim(bra,ket)=17,17 size(op)=63:4.807e-04MB size(tot)=2895:2.209e-02MB:2.157e-05GB
 rqops: oplist=CSHPQ nops=C:30 S:10 H:1 P:45 Q:55 
        dim(bra,ket)=27,27 size(op)=159:1.213e-03MB size(tot)=9444:7.205e-02MB:7.036e-05GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=14675:1.120e-01MB:1.093e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(4,0) fdel=./scratch/sweep/lop(3,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
wf3(diml,dimr,dimc)=(17,27,4) nnz=213:1.625e-03MB
qtensor3: wf3 own=1 _data=0x525bad60
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=6 dimAll=17
 (6,2):5 (7,1):4 (5,3):4 (5,1):2 (8,0):1 (4,4):1
 qbond: qcol nsym=7 dimAll=27
 (22,-2):8 (23,-3):8 (24,-4):4 (21,-1):3 (24,-2):2 (23,-1):1 (25,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=15 nblocks=168 size=213:1.625e-03MB
### DIAG TIMING: total=8.280e-04 t1=3.609e-05, t2=1.823e-05, t3=3.338e-05, t4=7.072e-04, t5=1.137e-05, t6=1.830e-05, t7=3.411e-06
duration_diagGPU:8.385e-04
duration_diagreduce:2.900e-08
duration_diagtransform:1.340e-06
----- TIMING FOR symbolic_formulae_onedot with size=435 : 8.558e-03 S -----
rank=0 GPUmem(GB): used=0.000109 (oper)=0.000109
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=435
 no. of hintermediate operators=188
 no. of coefficients=2820:0.0215MB:2.1e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.883e-04 S -----
rank=0 GPUmem(GB): used=0.00013 (oper,hinter)=0.000109,2.1e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00504 S size(H_formulae)=435 size(Hxlst2)=15 T(Hmu/Hxlist)=0.00103,0.00401 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00541 S size(H_formulae)=435 size(Hxlst)=3624 -----
rank=0 GPUmem(GB): used=0.00405 (oper,hinter,dvdson,batch)=0.000109,2.1e-05,3.17e-06,0.00392 blksize=40 blksize0=64 batchsize=3624
ctns::pdvdsonSolver_nkr::solve_iter ndim=213 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.64e-05,0.00133,0.0142,0.00145,0.0171
 ndim=213:1.59e-06GB t[comm(intra)]=2.74e-05 speed=0.116GB/S t[comm(inter)]=8.98e-06 speed=0.353GB/S
--- TIMING FOR sigma : t_inter=1.3e-03 t_gemm=1.4e-02 t_reduction=1.4e-03 tot=1.7e-02 ---
 sigma[inter] counter=210 t=1.3e-03 per=7.8e+00 cost=6.0e+05 flops=4.5e+08
 sigma[gemm] counter=210 i=0 t=1.5e-06 per=8.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=210 i=1 t=1.2e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=210 i=2 t=3.9e-03 per=2.3e+01 cost=2.3e+05 flops=5.9e+07
 sigma[gemm] counter=210 i=3 t=3.8e-03 per=2.2e+01 cost=2.3e+05 flops=6.0e+07
 sigma[gemm] counter=210 i=4 t=3.3e-03 per=1.9e+01 cost=2.0e+05 flops=6.2e+07
 sigma[gemm] counter=210 i=5 t=3.2e-03 per=1.9e+01 cost=2.1e+05 flops=6.4e+07
 sigma[gemm] counter=210 total t=1.4e-02 per=8.4e+01 cost=8.7e+05 flops=6.1e+07
 sigma[red] counter=210 t=1.4e-03 per=8.5e+00 cost=1.2e+05 flops=8.4e+07
--- TIMING FOR sigma_tot : t_inter=9.7e-02 t_gemm=1.1e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=210 t=9.7e-02 per=7.4e+00 cost=1.9e+09 flops=1.9e+10
 sigma_tot[gemm] counter=210 i=0 t=4.2e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=210 i=1 t=3.4e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=210 i=2 t=2.7e-01 per=2.1e+01 cost=1.7e+09 flops=6.0e+09
 sigma_tot[gemm] counter=210 i=3 t=2.8e-01 per=2.1e+01 cost=1.6e+09 flops=5.9e+09
 sigma_tot[gemm] counter=210 i=4 t=2.6e-01 per=2.0e+01 cost=1.4e+09 flops=5.2e+09
 sigma_tot[gemm] counter=210 i=5 t=2.5e-01 per=1.9e+01 cost=1.4e+09 flops=5.5e+09
 sigma_tot[gemm] counter=210 total t=1.1e+00 per=8.1e+01 cost=6.1e+09 flops=5.7e+09
 sigma_tot[red] counter=210 t=1.5e-01 per=1.1e+01 cost=4.0e+08 flops=2.6e+09
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=7.3e-06,8.4e-06,2.3e-06,1.4e-06,2.4e-07
settings: ndim=213 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.545939137556 -1.117e+03  7.496e-03    1     1  1.724e-02 1.724e-02 1.720e-02
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.049e-05,1.703e-04,1.833e-03,3.157e-04,2.363e-03
 ndim=213:1.587e-06GB t[comm(intra)]=2.418e-05 speed=1.312e-01GB/S t[comm(inter)]=6.300e-06 speed=5.038e-01GB/S
--- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=1.8e-03 t_reduction=3.2e-04 tot=2.3e-03 ---
 sigma[inter] counter=211 t=1.7e-04 per=7.3e+00 cost=6.0e+05 flops=3.5e+09
 sigma[gemm] counter=211 i=0 t=2.0e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=211 i=1 t=1.7e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=211 i=2 t=5.3e-04 per=2.3e+01 cost=2.3e+05 flops=4.3e+08
 sigma[gemm] counter=211 i=3 t=4.8e-04 per=2.1e+01 cost=2.3e+05 flops=4.8e+08
 sigma[gemm] counter=211 i=4 t=3.9e-04 per=1.7e+01 cost=2.0e+05 flops=5.2e+08
 sigma[gemm] counter=211 i=5 t=4.3e-04 per=1.9e+01 cost=2.1e+05 flops=4.9e+08
 sigma[gemm] counter=211 total t=1.8e-03 per=7.9e+01 cost=8.7e+05 flops=4.8e+08
 sigma[red] counter=211 t=3.2e-04 per=1.4e+01 cost=1.2e+05 flops=3.8e+08
--- TIMING FOR sigma_tot : t_inter=9.7e-02 t_gemm=1.1e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=211 t=9.7e-02 per=7.4e+00 cost=1.9e+09 flops=1.9e+10
 sigma_tot[gemm] counter=211 i=0 t=4.2e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=211 i=1 t=3.5e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=211 i=2 t=2.7e-01 per=2.1e+01 cost=1.7e+09 flops=6.0e+09
 sigma_tot[gemm] counter=211 i=3 t=2.8e-01 per=2.1e+01 cost=1.6e+09 flops=5.9e+09
 sigma_tot[gemm] counter=211 i=4 t=2.6e-01 per=2.0e+01 cost=1.4e+09 flops=5.2e+09
 sigma_tot[gemm] counter=211 i=5 t=2.5e-01 per=1.9e+01 cost=1.4e+09 flops=5.5e+09
 sigma_tot[gemm] counter=211 total t=1.1e+00 per=8.1e+01 cost=6.1e+09 flops=5.7e+09
 sigma_tot[red] counter=211 t=1.5e-01 per=1.1e+01 cost=4.0e+08 flops=2.6e+09
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,3.3e-05,4.4e-06,2.3e-06,2.9e-07
    2   0 -    -116.546003788251 -6.465e-05  1.400e-03    2     2  2.939e-02 1.470e-02 9.863e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.624e-05,1.604e-04,1.788e-03,3.087e-04,2.292e-03
 ndim=213:1.587e-06GB t[comm(intra)]=2.155e-05 speed=1.473e-01GB/S t[comm(inter)]=4.683e-06 speed=6.778e-01GB/S
--- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=1.8e-03 t_reduction=3.1e-04 tot=2.3e-03 ---
 sigma[inter] counter=212 t=1.6e-04 per=7.1e+00 cost=6.0e+05 flops=3.8e+09
 sigma[gemm] counter=212 i=0 t=1.9e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=212 i=1 t=1.7e-06 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=212 i=2 t=5.2e-04 per=2.3e+01 cost=2.3e+05 flops=4.4e+08
 sigma[gemm] counter=212 i=3 t=4.6e-04 per=2.1e+01 cost=2.3e+05 flops=5.0e+08
 sigma[gemm] counter=212 i=4 t=3.8e-04 per=1.7e+01 cost=2.0e+05 flops=5.3e+08
 sigma[gemm] counter=212 i=5 t=4.1e-04 per=1.8e+01 cost=2.1e+05 flops=5.1e+08
 sigma[gemm] counter=212 total t=1.8e-03 per=7.9e+01 cost=8.7e+05 flops=4.9e+08
 sigma[red] counter=212 t=3.1e-04 per=1.4e+01 cost=1.2e+05 flops=3.9e+08
--- TIMING FOR sigma_tot : t_inter=9.7e-02 t_gemm=1.1e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=212 t=9.7e-02 per=7.4e+00 cost=1.9e+09 flops=1.9e+10
 sigma_tot[gemm] counter=212 i=0 t=4.2e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=212 i=1 t=3.5e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=212 i=2 t=2.7e-01 per=2.1e+01 cost=1.7e+09 flops=6.0e+09
 sigma_tot[gemm] counter=212 i=3 t=2.8e-01 per=2.1e+01 cost=1.6e+09 flops=5.9e+09
 sigma_tot[gemm] counter=212 i=4 t=2.6e-01 per=2.0e+01 cost=1.4e+09 flops=5.2e+09
 sigma_tot[gemm] counter=212 i=5 t=2.5e-01 per=1.9e+01 cost=1.4e+09 flops=5.5e+09
 sigma_tot[gemm] counter=212 total t=1.1e+00 per=8.1e+01 cost=6.1e+09 flops=5.7e+09
 sigma_tot[red] counter=212 t=1.5e-01 per=1.1e+01 cost=4.0e+08 flops=2.6e+09
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=8.4e-06,2.4e-05,3.4e-06,1.2e-05,2.8e-07
    3   0 -    -116.546006189166 -2.401e-06  3.197e-04    3     3  4.138e-02 1.379e-02 7.381e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.709e-05,1.595e-04,1.767e-03,3.067e-04,2.268e-03
 ndim=213:1.587e-06GB t[comm(intra)]=2.244e-05 speed=1.415e-01GB/S t[comm(inter)]=4.656e-06 speed=6.817e-01GB/S
--- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=1.8e-03 t_reduction=3.1e-04 tot=2.2e-03 ---
 sigma[inter] counter=213 t=1.6e-04 per=7.1e+00 cost=6.0e+05 flops=3.8e+09
 sigma[gemm] counter=213 i=0 t=2.0e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=213 i=1 t=1.7e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=213 i=2 t=4.8e-04 per=2.2e+01 cost=2.3e+05 flops=4.7e+08
 sigma[gemm] counter=213 i=3 t=4.8e-04 per=2.1e+01 cost=2.3e+05 flops=4.9e+08
 sigma[gemm] counter=213 i=4 t=3.8e-04 per=1.7e+01 cost=2.0e+05 flops=5.4e+08
 sigma[gemm] counter=213 i=5 t=4.2e-04 per=1.9e+01 cost=2.1e+05 flops=4.9e+08
 sigma[gemm] counter=213 total t=1.8e-03 per=7.9e+01 cost=8.7e+05 flops=4.9e+08
 sigma[red] counter=213 t=3.1e-04 per=1.4e+01 cost=1.2e+05 flops=4.0e+08
--- TIMING FOR sigma_tot : t_inter=9.8e-02 t_gemm=1.1e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=213 t=9.8e-02 per=7.4e+00 cost=1.9e+09 flops=1.9e+10
 sigma_tot[gemm] counter=213 i=0 t=4.2e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=213 i=1 t=3.5e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=213 i=2 t=2.8e-01 per=2.1e+01 cost=1.7e+09 flops=6.0e+09
 sigma_tot[gemm] counter=213 i=3 t=2.8e-01 per=2.1e+01 cost=1.6e+09 flops=5.9e+09
 sigma_tot[gemm] counter=213 i=4 t=2.7e-01 per=2.0e+01 cost=1.4e+09 flops=5.2e+09
 sigma_tot[gemm] counter=213 i=5 t=2.6e-01 per=1.9e+01 cost=1.4e+09 flops=5.5e+09
 sigma_tot[gemm] counter=213 total t=1.1e+00 per=8.1e+01 cost=6.1e+09 flops=5.7e+09
 sigma_tot[red] counter=213 t=1.5e-01 per=1.1e+01 cost=4.0e+08 flops=2.6e+09
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=8.1e-06,1.8e-05,3.2e-06,2.2e-06,2.5e-07
    4   0 -    -116.546006378586 -1.894e-07  1.335e-04    3     4  5.337e-02 1.334e-02 6.135e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.589e-05,1.581e-04,1.715e-03,3.274e-04,2.234e-03
 ndim=213:1.587e-06GB t[comm(intra)]=2.130e-05 speed=1.490e-01GB/S t[comm(inter)]=4.594e-06 speed=6.909e-01GB/S
--- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=1.7e-03 t_reduction=3.3e-04 tot=2.2e-03 ---
 sigma[inter] counter=214 t=1.6e-04 per=7.2e+00 cost=6.0e+05 flops=3.8e+09
 sigma[gemm] counter=214 i=0 t=1.9e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=214 i=1 t=1.7e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=214 i=2 t=4.8e-04 per=2.2e+01 cost=2.3e+05 flops=4.8e+08
 sigma[gemm] counter=214 i=3 t=4.7e-04 per=2.2e+01 cost=2.3e+05 flops=4.9e+08
 sigma[gemm] counter=214 i=4 t=3.8e-04 per=1.7e+01 cost=2.0e+05 flops=5.4e+08
 sigma[gemm] counter=214 i=5 t=3.8e-04 per=1.7e+01 cost=2.1e+05 flops=5.4e+08
 sigma[gemm] counter=214 total t=1.7e-03 per=7.8e+01 cost=8.7e+05 flops=5.1e+08
 sigma[red] counter=214 t=3.3e-04 per=1.5e+01 cost=1.2e+05 flops=3.7e+08
--- TIMING FOR sigma_tot : t_inter=9.8e-02 t_gemm=1.1e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=214 t=9.8e-02 per=7.4e+00 cost=1.9e+09 flops=1.9e+10
 sigma_tot[gemm] counter=214 i=0 t=4.2e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=214 i=1 t=3.5e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=214 i=2 t=2.8e-01 per=2.1e+01 cost=1.7e+09 flops=6.0e+09
 sigma_tot[gemm] counter=214 i=3 t=2.8e-01 per=2.1e+01 cost=1.6e+09 flops=5.9e+09
 sigma_tot[gemm] counter=214 i=4 t=2.7e-01 per=2.0e+01 cost=1.4e+09 flops=5.2e+09
 sigma_tot[gemm] counter=214 i=5 t=2.6e-01 per=1.9e+01 cost=1.4e+09 flops=5.5e+09
 sigma_tot[gemm] counter=214 total t=1.1e+00 per=8.1e+01 cost=6.1e+09 flops=5.7e+09
 sigma_tot[red] counter=214 t=1.5e-01 per=1.1e+01 cost=4.0e+08 flops=2.6e+09
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=7.2e-06,1.7e-05,3.2e-06,2.3e-06,2.5e-07
    5   0 +    -116.546006420381 -4.180e-08  7.248e-05    3     5  6.527e-02 1.305e-02 5.380e-03
TIMING FOR Davidson : 6.528e-02  T(cal/comm/rest)=2.690e-02,7.680e-07,3.838e-02
decomposed t_rest=3.838e-02
 T(sub)    =1.816e-04 per=4.732e-01
 T(precond)=3.802e-02 per=9.907e+01
 T(ortho)  =1.459e-05 per=3.802e-02
 T(xcopy)  =9.790e-07 per=2.551e-03
 T(xnrm2)  =3.063e-06 per=7.981e-03
 T(other)  =1.566e-04 per=4.080e-01
optimized energies: isweep=0 ibond=31 dots=1 e[0]=-116.546006420381 nmvp=5
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.530e+03S Sys:3.187e+00S Total:1.533e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=15 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond31.txt
 qbond: qsuper nsym=15 dimAll=108
 (22,-2):11 (23,-3):16 (24,-4):12 (21,-1):3 (24,-2):19 (23,-1):12 (25,-5):5 (25,-3):14 (26,-4):5 (26,-2):2 (25,-1):3 (27,-5):1 (22,0):3 (24,0):1 (26,-6):1
timing for divide=1.8e-05
timing for compute=1.5e-04
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 1.8e-04 S T(divide/compute/collect)=1.8e-05,1.5e-04,1.4e-05 -----
decimation summary: 108->17 dwt=-2.220e-16 SvN=1.099e+00
 qbond: qkept nsym=6 dimAll=17
 (24,-2):5 (23,-1):4 (25,-3):4 (25,-1):2 (26,-4):1 (22,0):1
----- TIMING for decimation_row(nkr): 6.354e-04 S T(decim/select/formRot)=2.666e-04,3.388e-04,3.003e-05 -----
----- TIMING FOR onedot_decimation: 8.518e-04 S T(wf/decim)=1.756e-04,6.761e-04 -----
ctns::oper_renorm coord=(4,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:32 S:8 H:1 P:28 Q:36 
        dim(bra,ket)=17,17 size(op)=63:4.807e-04MB size(tot)=2895:2.209e-02MB:2.157e-05GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.531e+03S Sys:3.187e+00S Total:1.534e+03S
----- TIMING FOR symbolic_formulae_renorm with size=105 : 8.279e-03 S -----
rank=0 GPUmem(GB): used=0.00013 (oper)=0.000109
rank=0 GPUmem(GB): used=0.000132 (oper,site)(GB)=0.000109,1.59e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=188
 no. of coefficients=2820:0.0215MB:2.1e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.109e-04 S -----
rank=0 GPUmem(GB): used=0.000153 (oper,site,rinter)=0.000109,1.59e-06,2.1e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0039 S size(rtasks)=105 size(Rlst2)=36 T(Rmu/Rlist)=0.00121,0.00268 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00414 S size(rtasks)=105 size(Rlst)=2007 -----
rank=0 GPUmem(GB): used=0.000153 (oper,site,rinter,batch)=0.000109,1.59e-06,2.1e-05,0.00217 blksize=40 blksize0=64 batchsize=2007
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00127,0.00791,0.00207
--- TIMING FOR renorm : t_inter=1.3e-03 t_gemm=7.9e-03 t_reduction=2.1e-03 tot=1.1e-02 ---
 renorm[inter] counter=32 t=1.3e-03 per=1.1e+01 cost=3.0e+05 flops=2.4e+08
 renorm[gemm] counter=32 i=0 t=1.6e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=1 t=1.2e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=2 t=2.9e-03 per=2.5e+01 cost=8.2e+04 flops=2.9e+07
 renorm[gemm] counter=32 i=3 t=1.6e-03 per=1.4e+01 cost=1.8e+05 flops=1.1e+08
 renorm[gemm] counter=32 i=4 t=1.2e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=5 t=1.1e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=6 t=3.4e-03 per=3.0e+01 cost=2.7e+05 flops=8.0e+07
 renorm[gemm] counter=32 total t=7.9e-03 per=7.0e+01 cost=5.3e+05 flops=6.7e+07
 renorm[red] counter=32 t=2.1e-03 per=1.8e+01 cost=5.7e+04 flops=2.8e+07
--- TIMING FOR renorm_tot : t_inter=4.0e-02 t_gemm=3.9e-01 t_reduction=1.0e-01 tot=5.3e-01 ---
 renorm_tot[inter] counter=32 t=4.0e-02 per=7.5e+00 cost=1.3e+08 flops=3.3e+09
 renorm_tot[gemm] counter=32 i=0 t=4.8e-05 per=9.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=32 i=1 t=3.9e-05 per=7.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=32 i=2 t=6.9e-02 per=1.3e+01 cost=2.2e+07 flops=3.2e+08
 renorm_tot[gemm] counter=32 i=3 t=5.7e-02 per=1.1e+01 cost=5.0e+07 flops=8.8e+08
 renorm_tot[gemm] counter=32 i=4 t=4.4e-02 per=8.3e+00 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=32 i=5 t=5.4e-02 per=1.0e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=32 i=6 t=1.6e-01 per=3.1e+01 cost=1.8e+08 flops=1.1e+09
 renorm_tot[gemm] counter=32 total t=3.9e-01 per=7.3e+01 cost=3.3e+08 flops=8.6e+08
 renorm_tot[red] counter=32 t=1.0e-01 per=1.9e+01 cost=2.2e+07 flops=2.2e+08
qops.to_cpu: size(tot)=2895:2.2e-02MB:2.2e-05GB t[to_cpu]=2.1e-05S speed=1.0e+00GB/S
check ||H-H.dagger||=1.736e-14 coord=(4,0) rank=0
ctns::oper_ab2pq coord=(4,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0383 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.531e+03S Sys:3.189e+00S Total:1.534e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=112:8.545e-04MB:8.345e-07GB
total mem of comb=15797:1.205e-01MB:1.177e-04GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.531e+03S Sys:3.189e+00S Total:1.534e+03S
##### local opt: 1.532e-01 S #####
 T(local opt: fetch) = 1.014e-02 S  per = 6.62  per(accum) = 6.62
 T(local opt: hdiag) = 8.914e-04 S  per = 0.582  per(accum) = 7.2
 T(local opt: dvdsn) = 9.902e-02 S  per = 64.6  per(accum) = 71.8
 T(local opt: decim) = 8.631e-04 S  per = 0.563  per(accum) = 72.4
 T(local opt: guess) = 2.444e-04 S  per = 0.16  per(accum) = 72.5
 T(local opt: renrm) = 3.893e-02 S  per = 25.4  per(accum) = 98
 T(local opt: save ) = 3.139e-03 S  per = 2.05  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.902e-02 S  T(sum) = 9.853e-02 S  per = 9.950e+01
 T(local opt: preprocess                  ) = 2.556e-04 S  per = 0.259  per(accum) = 0.259
 T(local opt: symbolic_formulae           ) = 8.572e-03 S  per =  8.7  per(accum) = 8.96
 T(local opt: hintermediate init          ) = 2.041e-04 S  per = 0.207  per(accum) = 9.17
 T(local opt: preprocess_hformulae_Hxlist ) = 5.551e-03 S  per = 5.63  per(accum) = 14.8
 T(local opt: hmmtasks init               ) = 1.866e-02 S  per = 18.9  per(accum) = 33.7
 T(local opt: initial guess for dvdson    ) = 7.901e-06 S  per = 0.00802  per(accum) = 33.7
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.675e-02 S  per = 27.2  per(accum) = 60.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.461e-04 S  per = 0.148  per(accum) = 61
 T(local opt: dvdson solver [comm(cpu)]   ) = 7.680e-07 S  per = 0.000779  per(accum) = 61
 T(local opt: dvdson solver [rest part]   ) = 3.838e-02 S  per =   39  per(accum) = 100
Detailed decomposition of T(renrm) = 3.893e-02 S  T(sum) = 3.893e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.566e-04 S  per = 0.402  per(accum) = 0.402
 T(local opt: qops init                    ) = 1.334e-03 S  per = 3.43  per(accum) = 3.83
 T(local opt: symbolic_formulae_renorm     ) = 8.294e-03 S  per = 21.3  per(accum) = 25.1
 T(local opt: allocate qops on gpu         ) = 3.215e-05 S  per = 0.0826  per(accum) = 25.2
 T(local opt: site memcpy cpu2gpu          ) = 2.445e-05 S  per = 0.0628  per(accum) = 25.3
 T(local opt: rintermediate init           ) = 3.213e-04 S  per = 0.825  per(accum) = 26.1
 T(local opt: preprocess_formulae_Rlist2   ) = 4.213e-03 S  per = 10.8  per(accum) = 36.9
 T(local opt: rmmtasks init                ) = 1.235e-02 S  per = 31.7  per(accum) = 68.7
 T(local opt: qops memset on cpu           ) = 3.700e-08 S  per = 9.5e-05  per(accum) = 68.7
 T(local opt: preprocess_renorm_batchGPU   ) = 1.136e-02 S  per = 29.2  per(accum) = 97.8
 T(local opt: reduction of opS & opH [nccl]) = 2.648e-06 S  per = 0.0068  per(accum) = 97.8
 T(local opt: qops memcpy gpu2cpu          ) = 2.774e-05 S  per = 0.0713  per(accum) = 97.9
 T(local opt: deallocate cpu and gpu memory) = 3.095e-04 S  per = 0.795  per(accum) = 98.7
 T(local opt: reduction of opS & opH [comm]) = 3.632e-05 S  per = 0.0933  per(accum) = 98.8
 T(local opt: conversion from opAB to opPQ ) = 4.906e-06 S  per = 0.0126  per(accum) = 98.8
 T(local opt: after oper_renorm            ) = 4.643e-04 S  per = 1.19  per(accum) = 100
##### sweep opt: 2.038e+01 S #####
 T(sweep opt: fetch) = 4.678e-01 S  per = 2.29  per(accum) = 2.29
 T(sweep opt: hdiag) = 7.826e-02 S  per = 0.384  per(accum) = 2.68
 T(sweep opt: dvdsn) = 8.290e+00 S  per = 40.7  per(accum) = 43.3
 T(sweep opt: decim) = 3.934e-02 S  per = 0.193  per(accum) = 43.5
 T(sweep opt: guess) = 9.619e-03 S  per = 0.0472  per(accum) = 43.6
 T(sweep opt: renrm) = 1.140e+01 S  per = 55.9  per(accum) = 99.5
 T(sweep opt: save ) = 9.566e-02 S  per = 0.469  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.290e+00 S  T(sum) = 7.626e+00 S  per = 9.198e+01
 T(sweep opt: preprocess                  ) = 1.686e-02 S  per = 0.221  per(accum) = 0.221
 T(sweep opt: symbolic_formulae           ) = 5.346e-01 S  per = 7.01  per(accum) = 7.23
 T(sweep opt: hintermediate init          ) = 1.237e-02 S  per = 0.162  per(accum) = 7.39
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.219e-01 S  per = 8.15  per(accum) = 15.5
 T(sweep opt: hmmtasks init               ) = 3.532e+00 S  per = 46.3  per(accum) = 61.9
 T(sweep opt: initial guess for dvdson    ) = 2.857e-04 S  per = 0.00375  per(accum) = 61.9
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.368e+00 S  per = 17.9  per(accum) = 79.8
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 8.327e-03 S  per = 0.109  per(accum) = 79.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.762e-05 S  per = 0.000362  per(accum) = 79.9
 T(sweep opt: dvdson solver [rest part]   ) = 1.532e+00 S  per = 20.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.140e+01 S  T(sum) = 1.140e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.014e-02 S  per = 0.0889  per(accum) = 0.0889
 T(sweep opt: qops init                    ) = 1.116e-01 S  per = 0.979  per(accum) = 1.07
 T(sweep opt: symbolic_formulae_renorm     ) = 4.213e-01 S  per = 3.69  per(accum) = 4.76
 T(sweep opt: allocate qops on gpu         ) = 3.153e-03 S  per = 0.0277  per(accum) = 4.79
 T(sweep opt: site memcpy cpu2gpu          ) = 7.598e-04 S  per = 0.00666  per(accum) = 4.8
 T(sweep opt: rintermediate init           ) = 1.814e-02 S  per = 0.159  per(accum) = 4.96
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.725e-01 S  per = 3.27  per(accum) = 8.22
 T(sweep opt: rmmtasks init                ) = 1.436e+00 S  per = 12.6  per(accum) = 20.8
 T(sweep opt: qops memset on cpu           ) = 1.637e-06 S  per = 1.44e-05  per(accum) = 20.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.288e-01 S  per = 4.64  per(accum) = 25.4
 T(sweep opt: reduction of opS & opH [nccl]) = 4.219e-05 S  per = 0.00037  per(accum) = 25.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.343e-03 S  per = 0.0381  per(accum) = 25.5
 T(sweep opt: deallocate cpu and gpu memory) = 9.535e-01 S  per = 8.36  per(accum) = 33.8
 T(sweep opt: reduction of opS & opH [comm]) = 1.587e-03 S  per = 0.0139  per(accum) = 33.9
 T(sweep opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 65.9  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 2.612e-02 S  per = 0.229  per(accum) = 100
##### global opt: 2.038e+01 S #####
 T(global opt: fetch) = 4.678e-01 S  per = 2.29  per(accum) = 2.29
 T(global opt: hdiag) = 7.826e-02 S  per = 0.384  per(accum) = 2.68
 T(global opt: dvdsn) = 8.290e+00 S  per = 40.7  per(accum) = 43.3
 T(global opt: decim) = 3.934e-02 S  per = 0.193  per(accum) = 43.5
 T(global opt: guess) = 9.619e-03 S  per = 0.0472  per(accum) = 43.6
 T(global opt: renrm) = 1.140e+01 S  per = 55.9  per(accum) = 99.5
 T(global opt: save ) = 9.566e-02 S  per = 0.469  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.290e+00 S  T(sum) = 7.626e+00 S  per = 9.198e+01
 T(global opt: preprocess                  ) = 1.686e-02 S  per = 0.221  per(accum) = 0.221
 T(global opt: symbolic_formulae           ) = 5.346e-01 S  per = 7.01  per(accum) = 7.23
 T(global opt: hintermediate init          ) = 1.237e-02 S  per = 0.162  per(accum) = 7.39
 T(global opt: preprocess_hformulae_Hxlist ) = 6.219e-01 S  per = 8.15  per(accum) = 15.5
 T(global opt: hmmtasks init               ) = 3.532e+00 S  per = 46.3  per(accum) = 61.9
 T(global opt: initial guess for dvdson    ) = 2.857e-04 S  per = 0.00375  per(accum) = 61.9
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.368e+00 S  per = 17.9  per(accum) = 79.8
 T(global opt: dvdson solver [comm(gpu)]   ) = 8.327e-03 S  per = 0.109  per(accum) = 79.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.762e-05 S  per = 0.000362  per(accum) = 79.9
 T(global opt: dvdson solver [rest part]   ) = 1.532e+00 S  per = 20.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.140e+01 S  T(sum) = 1.140e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.014e-02 S  per = 0.0889  per(accum) = 0.0889
 T(global opt: qops init                    ) = 1.116e-01 S  per = 0.979  per(accum) = 1.07
 T(global opt: symbolic_formulae_renorm     ) = 4.213e-01 S  per = 3.69  per(accum) = 4.76
 T(global opt: allocate qops on gpu         ) = 3.153e-03 S  per = 0.0277  per(accum) = 4.79
 T(global opt: site memcpy cpu2gpu          ) = 7.598e-04 S  per = 0.00666  per(accum) = 4.8
 T(global opt: rintermediate init           ) = 1.814e-02 S  per = 0.159  per(accum) = 4.96
 T(global opt: preprocess_formulae_Rlist2   ) = 3.725e-01 S  per = 3.27  per(accum) = 8.22
 T(global opt: rmmtasks init                ) = 1.436e+00 S  per = 12.6  per(accum) = 20.8
 T(global opt: qops memset on cpu           ) = 1.637e-06 S  per = 1.44e-05  per(accum) = 20.8
 T(global opt: preprocess_renorm_batchGPU   ) = 5.288e-01 S  per = 4.64  per(accum) = 25.4
 T(global opt: reduction of opS & opH [nccl]) = 4.219e-05 S  per = 0.00037  per(accum) = 25.4
 T(global opt: qops memcpy gpu2cpu          ) = 4.343e-03 S  per = 0.0381  per(accum) = 25.5
 T(global opt: deallocate cpu and gpu memory) = 9.535e-01 S  per = 8.36  per(accum) = 33.8
 T(global opt: reduction of opS & opH [comm]) = 1.587e-03 S  per = 0.0139  per(accum) = 33.9
 T(global opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 65.9  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 2.612e-02 S  per = 0.229  per(accum) = 100

isweep=0 ibond=32/seqsize=34 dots=1 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.531e+03S Sys:3.189e+00S Total:1.534e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15537:1.185e-01MB:1.158e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=112:8.545e-04MB:8.345e-07GB
total mem of comb=15797:1.205e-01MB:1.177e-04GB
ctns::topology::check_partition: (sl,sr,sc)=3,16,1
 suppl= 0 1 2
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 3
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:6 S:34 H:1 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:3.052e-03MB size(tot)=21970:1.676e-01MB:1.637e-04GB
 rqops: oplist=CSHPQ nops=C:32 S:8 H:1 P:28 Q:36 
        dim(bra,ket)=17,17 size(op)=63:4.807e-04MB size(tot)=2895:2.209e-02MB:2.157e-05GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=27201:2.075e-01MB:2.027e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
wf3(diml,dimr,dimc)=(64,17,4) nnz=112:8.545e-04MB
qtensor3: wf3 own=1 _data=0x525e0e20
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
 qbond: qcol nsym=6 dimAll=17
 (24,-2):5 (23,-1):4 (25,-3):4 (25,-1):2 (26,-4):1 (22,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=12 nblocks=384 size=112:8.545e-04MB
### DIAG TIMING: total=5.241e-04 t1=1.500e-05, t2=3.600e-05, t3=3.027e-05, t4=4.120e-04, t5=1.107e-05, t6=1.620e-05, t7=3.619e-06
duration_diagGPU:5.347e-04
duration_diagreduce:3.300e-08
duration_diagtransform:1.305e-06
----- TIMING FOR symbolic_formulae_onedot with size=297 : 5.570e-03 S -----
rank=0 GPUmem(GB): used=0.000203 (oper)=0.000203
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=297
 no. of hintermediate operators=114
 no. of coefficients=1824:0.0139MB:1.36e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.208e-04 S -----
rank=0 GPUmem(GB): used=0.000216 (oper,hinter)=0.000203,1.36e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00287 S size(H_formulae)=297 size(Hxlst2)=12 T(Hmu/Hxlist)=0.000681,0.00219 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00306 S size(H_formulae)=297 size(Hxlst)=1870 -----
rank=0 GPUmem(GB): used=0.00176 (oper,hinter,dvdson,batch)=0.000203,1.36e-05,1.67e-06,0.00155 blksize=45 blksize0=20 batchsize=1870
ctns::pdvdsonSolver_nkr::solve_iter ndim=112 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.32e-05,0.000917,0.00652,0.00116,0.00865
 ndim=112:8.34e-07GB t[comm(intra)]=2.48e-05 speed=0.0674GB/S t[comm(inter)]=8.46e-06 speed=0.197GB/S
--- TIMING FOR sigma : t_inter=9.2e-04 t_gemm=6.5e-03 t_reduction=1.2e-03 tot=8.6e-03 ---
 sigma[inter] counter=215 t=9.2e-04 per=1.1e+01 cost=1.6e+05 flops=1.7e+08
 sigma[gemm] counter=215 i=0 t=1.5e-06 per=1.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=215 i=1 t=1.1e-06 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=215 i=2 t=1.8e-03 per=2.1e+01 cost=5.3e+04 flops=2.9e+07
 sigma[gemm] counter=215 i=3 t=1.9e-03 per=2.2e+01 cost=5.0e+04 flops=2.7e+07
 sigma[gemm] counter=215 i=4 t=1.5e-03 per=1.7e+01 cost=6.4e+04 flops=4.4e+07
 sigma[gemm] counter=215 i=5 t=1.3e-03 per=1.5e+01 cost=6.5e+04 flops=4.9e+07
 sigma[gemm] counter=215 total t=6.5e-03 per=7.6e+01 cost=2.3e+05 flops=3.6e+07
 sigma[red] counter=215 t=1.2e-03 per=1.3e+01 cost=3.8e+04 flops=3.3e+07
--- TIMING FOR sigma_tot : t_inter=9.9e-02 t_gemm=1.1e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=215 t=9.9e-02 per=7.4e+00 cost=1.9e+09 flops=1.9e+10
 sigma_tot[gemm] counter=215 i=0 t=4.3e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=215 i=1 t=3.5e-04 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=215 i=2 t=2.8e-01 per=2.1e+01 cost=1.7e+09 flops=6.0e+09
 sigma_tot[gemm] counter=215 i=3 t=2.8e-01 per=2.1e+01 cost=1.6e+09 flops=5.9e+09
 sigma_tot[gemm] counter=215 i=4 t=2.7e-01 per=2.0e+01 cost=1.4e+09 flops=5.2e+09
 sigma_tot[gemm] counter=215 i=5 t=2.6e-01 per=1.9e+01 cost=1.4e+09 flops=5.5e+09
 sigma_tot[gemm] counter=215 total t=1.1e+00 per=8.1e+01 cost=6.1e+09 flops=5.6e+09
 sigma_tot[red] counter=215 t=1.5e-01 per=1.1e+01 cost=4.0e+08 flops=2.6e+09
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=6.3e-06,7.5e-06,2.0e-06,1.2e-06,2.2e-07
settings: ndim=112 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.546006420381 -1.117e+03  5.512e-03    1     1  8.792e-03 8.792e-03 8.754e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.262e-05,1.286e-04,9.194e-04,2.674e-04,1.374e-03
 ndim=112:8.345e-07GB t[comm(intra)]=3.592e-05 speed=4.646e-02GB/S t[comm(inter)]=6.699e-06 speed=2.491e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=9.2e-04 t_reduction=2.7e-04 tot=1.3e-03 ---
 sigma[inter] counter=216 t=1.3e-04 per=9.8e+00 cost=1.6e+05 flops=1.2e+09
 sigma[gemm] counter=216 i=0 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=216 i=1 t=1.9e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=216 i=2 t=2.9e-04 per=2.2e+01 cost=5.3e+04 flops=1.8e+08
 sigma[gemm] counter=216 i=3 t=2.6e-04 per=2.0e+01 cost=5.0e+04 flops=1.9e+08
 sigma[gemm] counter=216 i=4 t=1.8e-04 per=1.4e+01 cost=6.4e+04 flops=3.5e+08
 sigma[gemm] counter=216 i=5 t=1.8e-04 per=1.4e+01 cost=6.5e+04 flops=3.6e+08
 sigma[gemm] counter=216 total t=9.2e-04 per=7.0e+01 cost=2.3e+05 flops=2.5e+08
 sigma[red] counter=216 t=2.7e-04 per=2.0e+01 cost=3.8e+04 flops=1.4e+08
--- TIMING FOR sigma_tot : t_inter=9.9e-02 t_gemm=1.1e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=216 t=9.9e-02 per=7.4e+00 cost=1.9e+09 flops=1.9e+10
 sigma_tot[gemm] counter=216 i=0 t=4.3e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=216 i=1 t=3.5e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=216 i=2 t=2.8e-01 per=2.1e+01 cost=1.7e+09 flops=6.0e+09
 sigma_tot[gemm] counter=216 i=3 t=2.8e-01 per=2.1e+01 cost=1.6e+09 flops=5.8e+09
 sigma_tot[gemm] counter=216 i=4 t=2.7e-01 per=2.0e+01 cost=1.4e+09 flops=5.2e+09
 sigma_tot[gemm] counter=216 i=5 t=2.6e-01 per=1.9e+01 cost=1.4e+09 flops=5.5e+09
 sigma_tot[gemm] counter=216 total t=1.1e+00 per=8.1e+01 cost=6.1e+09 flops=5.6e+09
 sigma_tot[red] counter=216 t=1.5e-01 per=1.1e+01 cost=4.0e+08 flops=2.6e+09
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=8.3e-06,2.3e-05,1.4e-05,2.0e-06,2.7e-07
    2   0 -    -116.546037752458 -3.133e-05  5.340e-04    2     2  2.358e-02 1.179e-02 5.142e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.228e-05,9.871e-05,9.395e-04,2.491e-04,1.338e-03
 ndim=112:8.345e-07GB t[comm(intra)]=2.744e-05 speed=6.081e-02GB/S t[comm(inter)]=1.483e-05 speed=1.125e-01GB/S
--- TIMING FOR sigma : t_inter=9.8e-05 t_gemm=9.4e-04 t_reduction=2.5e-04 tot=1.3e-03 ---
 sigma[inter] counter=217 t=9.8e-05 per=7.7e+00 cost=1.6e+05 flops=1.6e+09
 sigma[gemm] counter=217 i=0 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=217 i=1 t=1.8e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=217 i=2 t=2.7e-04 per=2.1e+01 cost=5.3e+04 flops=1.9e+08
 sigma[gemm] counter=217 i=3 t=2.8e-04 per=2.2e+01 cost=5.0e+04 flops=1.8e+08
 sigma[gemm] counter=217 i=4 t=1.9e-04 per=1.5e+01 cost=6.4e+04 flops=3.3e+08
 sigma[gemm] counter=217 i=5 t=1.8e-04 per=1.4e+01 cost=6.5e+04 flops=3.6e+08
 sigma[gemm] counter=217 total t=9.4e-04 per=7.3e+01 cost=2.3e+05 flops=2.5e+08
 sigma[red] counter=217 t=2.5e-04 per=1.9e+01 cost=3.8e+04 flops=1.5e+08
--- TIMING FOR sigma_tot : t_inter=9.9e-02 t_gemm=1.1e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=217 t=9.9e-02 per=7.4e+00 cost=1.9e+09 flops=1.9e+10
 sigma_tot[gemm] counter=217 i=0 t=4.3e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=217 i=1 t=3.6e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=217 i=2 t=2.8e-01 per=2.1e+01 cost=1.7e+09 flops=6.0e+09
 sigma_tot[gemm] counter=217 i=3 t=2.8e-01 per=2.1e+01 cost=1.6e+09 flops=5.8e+09
 sigma_tot[gemm] counter=217 i=4 t=2.7e-01 per=2.0e+01 cost=1.4e+09 flops=5.2e+09
 sigma_tot[gemm] counter=217 i=5 t=2.6e-01 per=1.9e+01 cost=1.4e+09 flops=5.5e+09
 sigma_tot[gemm] counter=217 total t=1.1e+00 per=8.1e+01 cost=6.1e+09 flops=5.6e+09
 sigma_tot[red] counter=217 t=1.5e-01 per=1.1e+01 cost=4.0e+08 flops=2.6e+09
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=6.3e-06,2.3e-05,3.6e-06,1.8e-06,9.9e-06
    3   0 +    -116.546038094874 -3.424e-07  7.788e-05    3     3  3.562e-02 1.187e-02 3.924e-03
TIMING FOR Davidson : 3.563e-02  T(cal/comm/rest)=1.177e-02,4.150e-07,2.386e-02
decomposed t_rest=2.386e-02
 T(sub)    =1.091e-04 per=4.571e-01
 T(precond)=2.364e-02 per=9.911e+01
 T(ortho)  =8.083e-06 per=3.388e-02
 T(xcopy)  =1.064e-06 per=4.460e-03
 T(xnrm2)  =1.779e-06 per=7.457e-03
 T(other)  =9.177e-05 per=3.847e-01
optimized energies: isweep=0 ibond=32 dots=1 e[0]=-116.546038094874 nmvp=3
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.534e+03S Sys:3.196e+00S Total:1.538e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=14 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond32.txt
 qbond: qsuper nsym=14 dimAll=68
 (24,-2):9 (23,-1):5 (25,-3):9 (25,-1):11 (26,-4):5 (22,0):1 (26,-2):11 (27,-3):5 (27,-1):2 (28,-4):1 (24,0):5 (26,0):2 (23,1):1 (27,-5):1
timing for divide=4.7e-05
timing for compute=2.6e-04
timing for collect=3.4e-05
----- TMING FOR decimation_genbasis(nkr): 3.4e-04 S T(divide/compute/collect)=4.7e-05,2.6e-04,3.4e-05 -----
decimation summary: 68->12 dwt=+1.110e-16 SvN=9.607e-01
 qbond: qkept nsym=6 dimAll=12
 (25,-1):3 (26,-2):3 (27,-1):2 (26,0):2 (27,-3):1 (24,0):1
----- TIMING for decimation_row(nkr): 1.244e-03 S T(decim/select/formRot)=5.415e-04,6.269e-04,7.609e-05 -----
----- TIMING FOR onedot_decimation: 1.749e-03 S T(wf/decim)=4.185e-04,1.331e-03 -----
ctns::oper_renorm coord=(3,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:34 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=12,12 size(op)=28:2.136e-04MB size(tot)=1146:8.743e-03MB:8.538e-06GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.534e+03S Sys:3.197e+00S Total:1.538e+03S
----- TIMING FOR symbolic_formulae_renorm with size=77 : 1.699e-02 S -----
rank=0 GPUmem(GB): used=6.11e-05 (oper)=4.75e-05
rank=0 GPUmem(GB): used=6.17e-05 (oper,site)(GB)=4.75e-05,6.26e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=114
 no. of coefficients=1824:0.0139MB:1.36e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.142e-04 S -----
rank=0 GPUmem(GB): used=7.53e-05 (oper,site,rinter)=4.75e-05,6.26e-07,1.36e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00633 S size(rtasks)=77 size(Rlst2)=36 T(Rmu/Rlist)=0.00218,0.00414 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00666 S size(rtasks)=77 size(Rlst)=1066 -----
rank=0 GPUmem(GB): used=7.53e-05 (oper,site,rinter,batch)=4.75e-05,6.26e-07,1.36e-05,0.000405 blksize=15 blksize0=20 batchsize=1066
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00145,0.00763,0.00397
--- TIMING FOR renorm : t_inter=1.4e-03 t_gemm=7.6e-03 t_reduction=4.0e-03 tot=1.3e-02 ---
 renorm[inter] counter=33 t=1.4e-03 per=1.1e+01 cost=7.9e+04 flops=5.5e+07
 renorm[gemm] counter=33 i=0 t=3.9e-06 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=1 t=3.1e-06 per=2.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=2 t=2.5e-03 per=1.9e+01 cost=1.6e+04 flops=6.3e+06
 renorm[gemm] counter=33 i=3 t=2.0e-03 per=1.6e+01 cost=3.5e+04 flops=1.7e+07
 renorm[gemm] counter=33 i=4 t=3.2e-06 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=5 t=3.2e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=6 t=3.0e-03 per=2.3e+01 cost=4.4e+04 flops=1.4e+07
 renorm[gemm] counter=33 total t=7.6e-03 per=5.8e+01 cost=9.5e+04 flops=1.2e+07
 renorm[red] counter=33 t=4.0e-03 per=3.0e+01 cost=1.2e+04 flops=3.0e+06
--- TIMING FOR renorm_tot : t_inter=4.1e-02 t_gemm=3.9e-01 t_reduction=1.0e-01 tot=5.4e-01 ---
 renorm_tot[inter] counter=33 t=4.1e-02 per=7.6e+00 cost=1.3e+08 flops=3.2e+09
 renorm_tot[gemm] counter=33 i=0 t=5.2e-05 per=9.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=33 i=1 t=4.2e-05 per=7.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=33 i=2 t=7.2e-02 per=1.3e+01 cost=2.2e+07 flops=3.1e+08
 renorm_tot[gemm] counter=33 i=3 t=5.9e-02 per=1.1e+01 cost=5.0e+07 flops=8.5e+08
 renorm_tot[gemm] counter=33 i=4 t=4.4e-02 per=8.1e+00 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=33 i=5 t=5.4e-02 per=1.0e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=33 i=6 t=1.6e-01 per=3.0e+01 cost=1.8e+08 flops=1.1e+09
 renorm_tot[gemm] counter=33 total t=3.9e-01 per=7.3e+01 cost=3.3e+08 flops=8.4e+08
 renorm_tot[red] counter=33 t=1.0e-01 per=1.9e+01 cost=2.2e+07 flops=2.1e+08
qops.to_cpu: size(tot)=1146:8.7e-03MB:8.5e-06GB t[to_cpu]=2.7e-05S speed=3.1e-01GB/S
check ||H-H.dagger||=3.390e-15 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.057 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.534e+03S Sys:3.197e+00S Total:1.538e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15509:1.183e-01MB:1.156e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=56:4.272e-04MB:4.172e-07GB
total mem of comb=15713:1.199e-01MB:1.171e-04GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.534e+03S Sys:3.197e+00S Total:1.538e+03S
##### local opt: 3.967e-01 S #####
 T(local opt: fetch) = 1.132e-02 S  per = 2.85  per(accum) = 2.85
 T(local opt: hdiag) = 6.070e-04 S  per = 0.153  per(accum) = 3.01
 T(local opt: dvdsn) = 3.195e-01 S  per = 80.5  per(accum) = 83.6
 T(local opt: decim) = 1.775e-03 S  per = 0.447  per(accum) = 84
 T(local opt: guess) = 4.845e-04 S  per = 0.122  per(accum) = 84.1
 T(local opt: renrm) = 5.800e-02 S  per = 14.6  per(accum) = 98.7
 T(local opt: save ) = 4.994e-03 S  per = 1.26  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.195e-01 S  T(sum) = 5.405e-02 S  per = 1.692e+01
 T(local opt: preprocess                  ) = 4.896e-04 S  per = 0.906  per(accum) = 0.906
 T(local opt: symbolic_formulae           ) = 5.581e-03 S  per = 10.3  per(accum) = 11.2
 T(local opt: hintermediate init          ) = 1.359e-04 S  per = 0.251  per(accum) = 11.5
 T(local opt: preprocess_hformulae_Hxlist ) = 3.119e-03 S  per = 5.77  per(accum) = 17.3
 T(local opt: hmmtasks init               ) = 9.093e-03 S  per = 16.8  per(accum) = 34.1
 T(local opt: initial guess for dvdson    ) = 6.356e-06 S  per = 0.0118  per(accum) = 34.1
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.165e-02 S  per = 21.6  per(accum) = 55.6
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.181e-04 S  per = 0.219  per(accum) = 55.9
 T(local opt: dvdson solver [comm(cpu)]   ) = 4.150e-07 S  per = 0.000768  per(accum) = 55.9
 T(local opt: dvdson solver [rest part]   ) = 2.386e-02 S  per = 44.1  per(accum) = 100
Detailed decomposition of T(renrm) = 5.800e-02 S  T(sum) = 5.800e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.383e-04 S  per = 0.583  per(accum) = 0.583
 T(local opt: qops init                    ) = 2.293e-03 S  per = 3.95  per(accum) = 4.54
 T(local opt: symbolic_formulae_renorm     ) = 1.702e-02 S  per = 29.4  per(accum) = 33.9
 T(local opt: allocate qops on gpu         ) = 8.870e-05 S  per = 0.153  per(accum) = 34
 T(local opt: site memcpy cpu2gpu          ) = 1.374e-04 S  per = 0.237  per(accum) = 34.3
 T(local opt: rintermediate init           ) = 5.414e-04 S  per = 0.934  per(accum) = 35.2
 T(local opt: preprocess_formulae_Rlist2   ) = 6.788e-03 S  per = 11.7  per(accum) = 46.9
 T(local opt: rmmtasks init                ) = 1.666e-02 S  per = 28.7  per(accum) = 75.6
 T(local opt: qops memset on cpu           ) = 1.350e-07 S  per = 0.000233  per(accum) = 75.6
 T(local opt: preprocess_renorm_batchGPU   ) = 1.330e-02 S  per = 22.9  per(accum) = 98.6
 T(local opt: reduction of opS & opH [nccl]) = 3.408e-06 S  per = 0.00588  per(accum) = 98.6
 T(local opt: qops memcpy gpu2cpu          ) = 4.127e-05 S  per = 0.0712  per(accum) = 98.6
 T(local opt: deallocate cpu and gpu memory) = 5.410e-05 S  per = 0.0933  per(accum) = 98.7
 T(local opt: reduction of opS & opH [comm]) = 6.275e-05 S  per = 0.108  per(accum) = 98.8
 T(local opt: conversion from opAB to opPQ ) = 2.226e-05 S  per = 0.0384  per(accum) = 98.9
 T(local opt: after oper_renorm            ) = 6.481e-04 S  per = 1.12  per(accum) = 100
##### sweep opt: 2.078e+01 S #####
 T(sweep opt: fetch) = 4.791e-01 S  per = 2.31  per(accum) = 2.31
 T(sweep opt: hdiag) = 7.887e-02 S  per = 0.38  per(accum) = 2.69
 T(sweep opt: dvdsn) = 8.610e+00 S  per = 41.4  per(accum) = 44.1
 T(sweep opt: decim) = 4.112e-02 S  per = 0.198  per(accum) = 44.3
 T(sweep opt: guess) = 1.010e-02 S  per = 0.0486  per(accum) = 44.4
 T(sweep opt: renrm) = 1.146e+01 S  per = 55.2  per(accum) = 99.5
 T(sweep opt: save ) = 1.007e-01 S  per = 0.484  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.610e+00 S  T(sum) = 7.680e+00 S  per = 8.919e+01
 T(sweep opt: preprocess                  ) = 1.735e-02 S  per = 0.226  per(accum) = 0.226
 T(sweep opt: symbolic_formulae           ) = 5.401e-01 S  per = 7.03  per(accum) = 7.26
 T(sweep opt: hintermediate init          ) = 1.250e-02 S  per = 0.163  per(accum) = 7.42
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.250e-01 S  per = 8.14  per(accum) = 15.6
 T(sweep opt: hmmtasks init               ) = 3.541e+00 S  per = 46.1  per(accum) = 61.7
 T(sweep opt: initial guess for dvdson    ) = 2.921e-04 S  per = 0.0038  per(accum) = 61.7
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.380e+00 S  per =   18  per(accum) = 79.6
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 8.445e-03 S  per = 0.11  per(accum) = 79.7
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.804e-05 S  per = 0.000365  per(accum) = 79.7
 T(sweep opt: dvdson solver [rest part]   ) = 1.555e+00 S  per = 20.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.146e+01 S  T(sum) = 1.146e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.048e-02 S  per = 0.0914  per(accum) = 0.0914
 T(sweep opt: qops init                    ) = 1.139e-01 S  per = 0.994  per(accum) = 1.09
 T(sweep opt: symbolic_formulae_renorm     ) = 4.383e-01 S  per = 3.82  per(accum) = 4.91
 T(sweep opt: allocate qops on gpu         ) = 3.242e-03 S  per = 0.0283  per(accum) = 4.94
 T(sweep opt: site memcpy cpu2gpu          ) = 8.971e-04 S  per = 0.00783  per(accum) = 4.95
 T(sweep opt: rintermediate init           ) = 1.868e-02 S  per = 0.163  per(accum) = 5.11
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.793e-01 S  per = 3.31  per(accum) = 8.42
 T(sweep opt: rmmtasks init                ) = 1.452e+00 S  per = 12.7  per(accum) = 21.1
 T(sweep opt: qops memset on cpu           ) = 1.772e-06 S  per = 1.55e-05  per(accum) = 21.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.421e-01 S  per = 4.73  per(accum) = 25.8
 T(sweep opt: reduction of opS & opH [nccl]) = 4.560e-05 S  per = 0.000398  per(accum) = 25.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.384e-03 S  per = 0.0383  per(accum) = 25.9
 T(sweep opt: deallocate cpu and gpu memory) = 9.536e-01 S  per = 8.32  per(accum) = 34.2
 T(sweep opt: reduction of opS & opH [comm]) = 1.650e-03 S  per = 0.0144  per(accum) = 34.2
 T(sweep opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 65.6  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 2.676e-02 S  per = 0.234  per(accum) = 100
##### global opt: 2.078e+01 S #####
 T(global opt: fetch) = 4.791e-01 S  per = 2.31  per(accum) = 2.31
 T(global opt: hdiag) = 7.887e-02 S  per = 0.38  per(accum) = 2.69
 T(global opt: dvdsn) = 8.610e+00 S  per = 41.4  per(accum) = 44.1
 T(global opt: decim) = 4.112e-02 S  per = 0.198  per(accum) = 44.3
 T(global opt: guess) = 1.010e-02 S  per = 0.0486  per(accum) = 44.4
 T(global opt: renrm) = 1.146e+01 S  per = 55.2  per(accum) = 99.5
 T(global opt: save ) = 1.007e-01 S  per = 0.484  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.610e+00 S  T(sum) = 7.680e+00 S  per = 8.919e+01
 T(global opt: preprocess                  ) = 1.735e-02 S  per = 0.226  per(accum) = 0.226
 T(global opt: symbolic_formulae           ) = 5.401e-01 S  per = 7.03  per(accum) = 7.26
 T(global opt: hintermediate init          ) = 1.250e-02 S  per = 0.163  per(accum) = 7.42
 T(global opt: preprocess_hformulae_Hxlist ) = 6.250e-01 S  per = 8.14  per(accum) = 15.6
 T(global opt: hmmtasks init               ) = 3.541e+00 S  per = 46.1  per(accum) = 61.7
 T(global opt: initial guess for dvdson    ) = 2.921e-04 S  per = 0.0038  per(accum) = 61.7
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.380e+00 S  per =   18  per(accum) = 79.6
 T(global opt: dvdson solver [comm(gpu)]   ) = 8.445e-03 S  per = 0.11  per(accum) = 79.7
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.804e-05 S  per = 0.000365  per(accum) = 79.7
 T(global opt: dvdson solver [rest part]   ) = 1.555e+00 S  per = 20.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.146e+01 S  T(sum) = 1.146e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.048e-02 S  per = 0.0914  per(accum) = 0.0914
 T(global opt: qops init                    ) = 1.139e-01 S  per = 0.994  per(accum) = 1.09
 T(global opt: symbolic_formulae_renorm     ) = 4.383e-01 S  per = 3.82  per(accum) = 4.91
 T(global opt: allocate qops on gpu         ) = 3.242e-03 S  per = 0.0283  per(accum) = 4.94
 T(global opt: site memcpy cpu2gpu          ) = 8.971e-04 S  per = 0.00783  per(accum) = 4.95
 T(global opt: rintermediate init           ) = 1.868e-02 S  per = 0.163  per(accum) = 5.11
 T(global opt: preprocess_formulae_Rlist2   ) = 3.793e-01 S  per = 3.31  per(accum) = 8.42
 T(global opt: rmmtasks init                ) = 1.452e+00 S  per = 12.7  per(accum) = 21.1
 T(global opt: qops memset on cpu           ) = 1.772e-06 S  per = 1.55e-05  per(accum) = 21.1
 T(global opt: preprocess_renorm_batchGPU   ) = 5.421e-01 S  per = 4.73  per(accum) = 25.8
 T(global opt: reduction of opS & opH [nccl]) = 4.560e-05 S  per = 0.000398  per(accum) = 25.8
 T(global opt: qops memcpy gpu2cpu          ) = 4.384e-03 S  per = 0.0383  per(accum) = 25.9
 T(global opt: deallocate cpu and gpu memory) = 9.536e-01 S  per = 8.32  per(accum) = 34.2
 T(global opt: reduction of opS & opH [comm]) = 1.650e-03 S  per = 0.0144  per(accum) = 34.2
 T(global opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 65.6  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 2.676e-02 S  per = 0.234  per(accum) = 100

isweep=0 ibond=33/seqsize=34 dots=1 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.534e+03S Sys:3.198e+00S Total:1.538e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15509:1.183e-01MB:1.156e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=56:4.272e-04MB:4.172e-07GB
total mem of comb=15713:1.199e-01MB:1.171e-04GB
ctns::topology::check_partition: (sl,sr,sc)=2,17,1
 suppl= 0 1
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 2
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:4 S:36 H:1 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:2.747e-04MB size(tot)=1352:1.031e-02MB:1.007e-05GB
 rqops: oplist=CSHPQ nops=C:34 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=12,12 size(op)=28:2.136e-04MB size(tot)=1146:8.743e-03MB:8.538e-06GB
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
 qops(tot)=4834:3.688e-02MB:3.602e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
wf3(diml,dimr,dimc)=(16,12,4) nnz=56:4.272e-04MB
qtensor3: wf3 own=1 _data=0x529d2df0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
 qbond: qcol nsym=6 dimAll=12
 (25,-1):3 (26,-2):3 (27,-1):2 (26,0):2 (27,-3):1 (24,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=14 nblocks=216 size=56:4.272e-04MB
### DIAG TIMING: total=6.155e-04 t1=1.700e-05, t2=7.448e-05, t3=5.143e-05, t4=4.271e-04, t5=1.523e-05, t6=2.332e-05, t7=7.001e-06
duration_diagGPU:6.434e-04
duration_diagreduce:9.600e-08
duration_diagtransform:1.305e-06
----- TIMING FOR symbolic_formulae_onedot with size=193 : 6.673e-03 S -----
rank=0 GPUmem(GB): used=3.6e-05 (oper)=3.6e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=193
 no. of hintermediate operators=58
 no. of coefficients=986:0.00752MB:7.35e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.503e-04 S -----
rank=0 GPUmem(GB): used=4.34e-05 (oper,hinter)=3.6e-05,7.35e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00451 S size(H_formulae)=193 size(Hxlst2)=14 T(Hmu/Hxlist)=0.000839,0.00367 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00484 S size(H_formulae)=193 size(Hxlst)=1820 -----
rank=0 GPUmem(GB): used=0.000505 (oper,hinter,dvdson,batch)=3.6e-05,7.35e-06,8.34e-07,0.000461 blksize=12 blksize0=9 batchsize=1820
ctns::pdvdsonSolver_nkr::solve_iter ndim=56 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.18e-05,0.00121,0.00831,0.00186,0.0114
 ndim=56:4.17e-07GB t[comm(intra)]=3.13e-05 speed=0.0267GB/S t[comm(inter)]=1.06e-05 speed=0.0788GB/S
--- TIMING FOR sigma : t_inter=1.2e-03 t_gemm=8.3e-03 t_reduction=1.9e-03 tot=1.1e-02 ---
 sigma[inter] counter=218 t=1.2e-03 per=1.1e+01 cost=6.7e+04 flops=5.5e+07
 sigma[gemm] counter=218 i=0 t=2.5e-06 per=2.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=218 i=1 t=2.2e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=218 i=2 t=2.0e-03 per=1.7e+01 cost=1.6e+04 flops=7.9e+06
 sigma[gemm] counter=218 i=3 t=2.1e-03 per=1.9e+01 cost=1.5e+04 flops=6.9e+06
 sigma[gemm] counter=218 i=4 t=2.2e-03 per=2.0e+01 cost=1.3e+04 flops=5.8e+06
 sigma[gemm] counter=218 i=5 t=2.0e-03 per=1.8e+01 cost=1.3e+04 flops=6.3e+06
 sigma[gemm] counter=218 total t=8.3e-03 per=7.3e+01 cost=5.6e+04 flops=6.7e+06
 sigma[red] counter=218 t=1.9e-03 per=1.6e+01 cost=1.6e+04 flops=8.5e+06
--- TIMING FOR sigma_tot : t_inter=1.0e-01 t_gemm=1.1e+00 t_reduction=1.5e-01 tot=1.3e+00 ---
 sigma_tot[inter] counter=218 t=1.0e-01 per=7.4e+00 cost=1.9e+09 flops=1.9e+10
 sigma_tot[gemm] counter=218 i=0 t=4.3e-04 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=218 i=1 t=3.6e-04 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=218 i=2 t=2.8e-01 per=2.1e+01 cost=1.7e+09 flops=5.9e+09
 sigma_tot[gemm] counter=218 i=3 t=2.8e-01 per=2.1e+01 cost=1.6e+09 flops=5.8e+09
 sigma_tot[gemm] counter=218 i=4 t=2.7e-01 per=2.0e+01 cost=1.4e+09 flops=5.1e+09
 sigma_tot[gemm] counter=218 i=5 t=2.6e-01 per=1.9e+01 cost=1.4e+09 flops=5.4e+09
 sigma_tot[gemm] counter=218 total t=1.1e+00 per=8.1e+01 cost=6.1e+09 flops=5.6e+09
 sigma_tot[red] counter=218 t=1.5e-01 per=1.2e+01 cost=4.0e+08 flops=2.6e+09
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=6.5e-06,9.3e-06,3.1e-06,1.5e-06,3.6e-07
settings: ndim=56 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.546038094874 -1.117e+03  4.869e-05    1     1  1.167e-02 1.167e-02 1.161e-02
TIMING FOR Davidson : 1.170e-02  T(cal/comm/rest)=1.161e-02,1.960e-07,9.244e-05
decomposed t_rest=9.244e-05
 T(sub)    =2.076e-05 per=2.246e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =6.330e-07 per=6.847e-01
 T(xnrm2)  =1.301e-05 per=1.407e+01
 T(other)  =5.804e-05 per=6.279e+01
optimized energies: isweep=0 ibond=33 dots=1 e[0]=-116.546038094874 nmvp=1
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.534e+03S Sys:3.199e+00S Total:1.538e+03S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=13 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond33.txt
 qbond: qsuper nsym=13 dimAll=48
 (25,-1):4 (26,-2):6 (27,-1):10 (26,0):6 (27,-3):4 (24,0):1 (28,-2):6 (29,-1):2 (28,0):4 (29,-3):1 (27,1):2 (25,1):1 (28,-4):1
timing for divide=2.0e-05
timing for compute=1.2e-04
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(nkr): 1.6e-04 S T(divide/compute/collect)=2.0e-05,1.2e-04,1.6e-05 -----
decimation summary: 48->12 dwt=-2.220e-16 SvN=7.814e-01
 qbond: qkept nsym=6 dimAll=12
 (28,0):4 (27,-1):2 (29,-1):2 (27,1):2 (26,0):1 (28,-2):1
----- TIMING for decimation_row(nkr): 5.828e-04 S T(decim/select/formRot)=2.480e-04,2.997e-04,3.507e-05 -----
----- TIMING FOR onedot_decimation: 7.833e-04 S T(wf/decim)=1.623e-04,6.210e-04 -----
ctns::oper_renorm coord=(2,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:36 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=12,12 size(op)=30:2.289e-04MB size(tot)=919:7.011e-03MB:6.847e-06GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.534e+03S Sys:3.199e+00S Total:1.538e+03S
----- TIMING FOR symbolic_formulae_renorm with size=57 : 4.706e-03 S -----
rank=0 GPUmem(GB): used=4.01e-05 (oper)=3.28e-05
rank=0 GPUmem(GB): used=4.06e-05 (oper,site)(GB)=3.28e-05,4.17e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=58
 no. of coefficients=986:0.00752MB:7.35e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.606e-04 S -----
rank=0 GPUmem(GB): used=4.79e-05 (oper,site,rinter)=3.28e-05,4.17e-07,7.35e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00299 S size(rtasks)=57 size(Rlst2)=36 T(Rmu/Rlist)=0.000734,0.00225 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00319 S size(rtasks)=57 size(Rlst)=1105 -----
rank=0 GPUmem(GB): used=4.79e-05 (oper,site,rinter,batch)=3.28e-05,4.17e-07,7.35e-06,0.000346 blksize=16 blksize0=9 batchsize=1105
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000959,0.00497,0.0029
--- TIMING FOR renorm : t_inter=9.6e-04 t_gemm=5.0e-03 t_reduction=2.9e-03 tot=8.8e-03 ---
 renorm[inter] counter=34 t=9.6e-04 per=1.1e+01 cost=3.3e+04 flops=3.5e+07
 renorm[gemm] counter=34 i=0 t=2.4e-06 per=2.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=1 t=1.8e-06 per=2.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=2 t=1.7e-03 per=1.9e+01 cost=6.4e+03 flops=3.8e+06
 renorm[gemm] counter=34 i=3 t=1.4e-03 per=1.5e+01 cost=1.2e+04 flops=9.1e+06
 renorm[gemm] counter=34 i=4 t=1.9e-06 per=2.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=5 t=1.9e-06 per=2.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=6 t=1.9e-03 per=2.2e+01 cost=2.0e+04 flops=1.0e+07
 renorm[gemm] counter=34 total t=5.0e-03 per=5.6e+01 cost=3.9e+04 flops=7.8e+06
 renorm[red] counter=34 t=2.9e-03 per=3.3e+01 cost=9.1e+03 flops=3.1e+06
--- TIMING FOR renorm_tot : t_inter=4.2e-02 t_gemm=4.0e-01 t_reduction=1.1e-01 tot=5.5e-01 ---
 renorm_tot[inter] counter=34 t=4.2e-02 per=7.7e+00 cost=1.3e+08 flops=3.1e+09
 renorm_tot[gemm] counter=34 i=0 t=5.4e-05 per=9.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=34 i=1 t=4.4e-05 per=8.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=34 i=2 t=7.3e-02 per=1.3e+01 cost=2.2e+07 flops=3.0e+08
 renorm_tot[gemm] counter=34 i=3 t=6.0e-02 per=1.1e+01 cost=5.0e+07 flops=8.3e+08
 renorm_tot[gemm] counter=34 i=4 t=4.4e-02 per=8.0e+00 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=34 i=5 t=5.4e-02 per=1.0e+01 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=34 i=6 t=1.7e-01 per=3.0e+01 cost=1.8e+08 flops=1.1e+09
 renorm_tot[gemm] counter=34 total t=4.0e-01 per=7.3e+01 cost=3.3e+08 flops=8.3e+08
 renorm_tot[red] counter=34 t=1.1e-01 per=2.0e+01 cost=2.2e+07 flops=2.1e+08
qops.to_cpu: size(tot)=919:7.0e-03MB:6.8e-06GB t[to_cpu]=2.0e-05S speed=3.5e-01GB/S
check ||H-H.dagger||=1.261e-14 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0279 S rank=0 -----
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.535e+03S Sys:3.199e+00S Total:1.538e+03S
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.122e-03MB:1.095e-06GB
 sites: len=20 mem=15165:1.157e-01MB:1.130e-04GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=30:2.289e-04MB:2.235e-07GB
total mem of comb=15343:1.171e-01MB:1.143e-04GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.535e+03S Sys:3.199e+00S Total:1.538e+03S
##### local opt: 9.592e-02 S #####
 T(local opt: fetch) = 2.161e-02 S  per = 22.5  per(accum) = 22.5
 T(local opt: hdiag) = 7.570e-04 S  per = 0.789  per(accum) = 23.3
 T(local opt: dvdsn) = 4.088e-02 S  per = 42.6  per(accum) = 65.9
 T(local opt: decim) = 7.958e-04 S  per = 0.83  per(accum) = 66.8
 T(local opt: guess) = 1.759e-04 S  per = 0.183  per(accum) = 67
 T(local opt: renrm) = 2.840e-02 S  per = 29.6  per(accum) = 96.6
 T(local opt: save ) = 3.299e-03 S  per = 3.44  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.088e-02 S  T(sum) = 4.070e-02 S  per = 9.956e+01
 T(local opt: preprocess                  ) = 6.364e-04 S  per = 1.56  per(accum) = 1.56
 T(local opt: symbolic_formulae           ) = 6.691e-03 S  per = 16.4  per(accum) = 18
 T(local opt: hintermediate init          ) = 1.784e-04 S  per = 0.438  per(accum) = 18.4
 T(local opt: preprocess_hformulae_Hxlist ) = 4.954e-03 S  per = 12.2  per(accum) = 30.6
 T(local opt: hmmtasks init               ) = 1.653e-02 S  per = 40.6  per(accum) = 71.2
 T(local opt: initial guess for dvdson    ) = 7.065e-06 S  per = 0.0174  per(accum) = 71.2
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.157e-02 S  per = 28.4  per(accum) = 99.7
 T(local opt: dvdson solver [comm(gpu)]   ) = 4.184e-05 S  per = 0.103  per(accum) = 99.8
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.960e-07 S  per = 0.000482  per(accum) = 99.8
 T(local opt: dvdson solver [rest part]   ) = 9.244e-05 S  per = 0.227  per(accum) = 100
Detailed decomposition of T(renrm) = 2.840e-02 S  T(sum) = 2.840e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.482e-04 S  per = 0.522  per(accum) = 0.522
 T(local opt: qops init                    ) = 8.349e-04 S  per = 2.94  per(accum) = 3.46
 T(local opt: symbolic_formulae_renorm     ) = 4.721e-03 S  per = 16.6  per(accum) = 20.1
 T(local opt: allocate qops on gpu         ) = 3.871e-05 S  per = 0.136  per(accum) = 20.2
 T(local opt: site memcpy cpu2gpu          ) = 2.884e-05 S  per = 0.102  per(accum) = 20.3
 T(local opt: rintermediate init           ) = 1.755e-04 S  per = 0.618  per(accum) = 20.9
 T(local opt: preprocess_formulae_Rlist2   ) = 3.265e-03 S  per = 11.5  per(accum) = 32.4
 T(local opt: rmmtasks init                ) = 9.715e-03 S  per = 34.2  per(accum) = 66.7
 T(local opt: qops memset on cpu           ) = 1.500e-07 S  per = 0.000528  per(accum) = 66.7
 T(local opt: preprocess_renorm_batchGPU   ) = 8.993e-03 S  per = 31.7  per(accum) = 98.3
 T(local opt: reduction of opS & opH [nccl]) = 2.351e-06 S  per = 0.00828  per(accum) = 98.3
 T(local opt: qops memcpy gpu2cpu          ) = 2.848e-05 S  per =  0.1  per(accum) = 98.4
 T(local opt: deallocate cpu and gpu memory) = 1.545e-05 S  per = 0.0544  per(accum) = 98.5
 T(local opt: reduction of opS & opH [comm]) = 3.936e-05 S  per = 0.139  per(accum) = 98.6
 T(local opt: conversion from opAB to opPQ ) = 6.299e-06 S  per = 0.0222  per(accum) = 98.6
 T(local opt: after oper_renorm            ) = 3.849e-04 S  per = 1.36  per(accum) = 100
##### sweep opt: 2.088e+01 S #####
 T(sweep opt: fetch) = 5.007e-01 S  per =  2.4  per(accum) = 2.4
 T(sweep opt: hdiag) = 7.962e-02 S  per = 0.381  per(accum) = 2.78
 T(sweep opt: dvdsn) = 8.651e+00 S  per = 41.4  per(accum) = 44.2
 T(sweep opt: decim) = 4.191e-02 S  per = 0.201  per(accum) = 44.4
 T(sweep opt: guess) = 1.028e-02 S  per = 0.0492  per(accum) = 44.5
 T(sweep opt: renrm) = 1.149e+01 S  per =   55  per(accum) = 99.5
 T(sweep opt: save ) = 1.040e-01 S  per = 0.498  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.651e+00 S  T(sum) = 7.720e+00 S  per = 8.924e+01
 T(sweep opt: preprocess                  ) = 1.798e-02 S  per = 0.233  per(accum) = 0.233
 T(sweep opt: symbolic_formulae           ) = 5.468e-01 S  per = 7.08  per(accum) = 7.32
 T(sweep opt: hintermediate init          ) = 1.268e-02 S  per = 0.164  per(accum) = 7.48
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.299e-01 S  per = 8.16  per(accum) = 15.6
 T(sweep opt: hmmtasks init               ) = 3.557e+00 S  per = 46.1  per(accum) = 61.7
 T(sweep opt: initial guess for dvdson    ) = 2.992e-04 S  per = 0.00387  per(accum) = 61.7
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.391e+00 S  per =   18  per(accum) = 79.7
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 8.487e-03 S  per = 0.11  per(accum) = 79.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.823e-05 S  per = 0.000366  per(accum) = 79.9
 T(sweep opt: dvdson solver [rest part]   ) = 1.556e+00 S  per = 20.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.149e+01 S  T(sum) = 1.149e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.063e-02 S  per = 0.0925  per(accum) = 0.0925
 T(sweep opt: qops init                    ) = 1.148e-01 S  per = 0.999  per(accum) = 1.09
 T(sweep opt: symbolic_formulae_renorm     ) = 4.430e-01 S  per = 3.86  per(accum) = 4.95
 T(sweep opt: allocate qops on gpu         ) = 3.281e-03 S  per = 0.0286  per(accum) = 4.98
 T(sweep opt: site memcpy cpu2gpu          ) = 9.260e-04 S  per = 0.00806  per(accum) = 4.98
 T(sweep opt: rintermediate init           ) = 1.886e-02 S  per = 0.164  per(accum) = 5.15
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.826e-01 S  per = 3.33  per(accum) = 8.48
 T(sweep opt: rmmtasks init                ) = 1.462e+00 S  per = 12.7  per(accum) = 21.2
 T(sweep opt: qops memset on cpu           ) = 1.922e-06 S  per = 1.67e-05  per(accum) = 21.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.511e-01 S  per =  4.8  per(accum) = 26
 T(sweep opt: reduction of opS & opH [nccl]) = 4.795e-05 S  per = 0.000417  per(accum) = 26
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.413e-03 S  per = 0.0384  per(accum) = 26
 T(sweep opt: deallocate cpu and gpu memory) = 9.536e-01 S  per =  8.3  per(accum) = 34.3
 T(sweep opt: reduction of opS & opH [comm]) = 1.689e-03 S  per = 0.0147  per(accum) = 34.4
 T(sweep opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 65.4  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 2.715e-02 S  per = 0.236  per(accum) = 100
##### global opt: 2.088e+01 S #####
 T(global opt: fetch) = 5.007e-01 S  per =  2.4  per(accum) = 2.4
 T(global opt: hdiag) = 7.962e-02 S  per = 0.381  per(accum) = 2.78
 T(global opt: dvdsn) = 8.651e+00 S  per = 41.4  per(accum) = 44.2
 T(global opt: decim) = 4.191e-02 S  per = 0.201  per(accum) = 44.4
 T(global opt: guess) = 1.028e-02 S  per = 0.0492  per(accum) = 44.5
 T(global opt: renrm) = 1.149e+01 S  per =   55  per(accum) = 99.5
 T(global opt: save ) = 1.040e-01 S  per = 0.498  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.651e+00 S  T(sum) = 7.720e+00 S  per = 8.924e+01
 T(global opt: preprocess                  ) = 1.798e-02 S  per = 0.233  per(accum) = 0.233
 T(global opt: symbolic_formulae           ) = 5.468e-01 S  per = 7.08  per(accum) = 7.32
 T(global opt: hintermediate init          ) = 1.268e-02 S  per = 0.164  per(accum) = 7.48
 T(global opt: preprocess_hformulae_Hxlist ) = 6.299e-01 S  per = 8.16  per(accum) = 15.6
 T(global opt: hmmtasks init               ) = 3.557e+00 S  per = 46.1  per(accum) = 61.7
 T(global opt: initial guess for dvdson    ) = 2.992e-04 S  per = 0.00387  per(accum) = 61.7
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.391e+00 S  per =   18  per(accum) = 79.7
 T(global opt: dvdson solver [comm(gpu)]   ) = 8.487e-03 S  per = 0.11  per(accum) = 79.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.823e-05 S  per = 0.000366  per(accum) = 79.9
 T(global opt: dvdson solver [rest part]   ) = 1.556e+00 S  per = 20.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.149e+01 S  T(sum) = 1.149e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.063e-02 S  per = 0.0925  per(accum) = 0.0925
 T(global opt: qops init                    ) = 1.148e-01 S  per = 0.999  per(accum) = 1.09
 T(global opt: symbolic_formulae_renorm     ) = 4.430e-01 S  per = 3.86  per(accum) = 4.95
 T(global opt: allocate qops on gpu         ) = 3.281e-03 S  per = 0.0286  per(accum) = 4.98
 T(global opt: site memcpy cpu2gpu          ) = 9.260e-04 S  per = 0.00806  per(accum) = 4.98
 T(global opt: rintermediate init           ) = 1.886e-02 S  per = 0.164  per(accum) = 5.15
 T(global opt: preprocess_formulae_Rlist2   ) = 3.826e-01 S  per = 3.33  per(accum) = 8.48
 T(global opt: rmmtasks init                ) = 1.462e+00 S  per = 12.7  per(accum) = 21.2
 T(global opt: qops memset on cpu           ) = 1.922e-06 S  per = 1.67e-05  per(accum) = 21.2
 T(global opt: preprocess_renorm_batchGPU   ) = 5.511e-01 S  per =  4.8  per(accum) = 26
 T(global opt: reduction of opS & opH [nccl]) = 4.795e-05 S  per = 0.000417  per(accum) = 26
 T(global opt: qops memcpy gpu2cpu          ) = 4.413e-03 S  per = 0.0384  per(accum) = 26
 T(global opt: deallocate cpu and gpu memory) = 9.536e-01 S  per =  8.3  per(accum) = 34.3
 T(global opt: reduction of opS & opH [comm]) = 1.689e-03 S  per = 0.0147  per(accum) = 34.4
 T(global opt: conversion from opAB to opPQ ) = 7.516e+00 S  per = 65.4  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 2.715e-02 S  per = 0.236  per(accum) = 100

======================================================================
sweep_data::summary isweep=0 mpisize=1 maxthreads=112
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=1 dcut=100 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=3 e[0]=-116.446553669725 t=0.057
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=64 dwt=+0.000e+00 nmvp=6 e[0]=-116.456608738602 t=0.142
 ibond=2 bond=(3,0)-(4,0) forward=1 deff=17 dwt=+0.000e+00 nmvp=6 e[0]=-116.466364795540 t=0.112
 ibond=3 bond=(4,0)-(5,0) forward=1 deff=27 dwt=-2.220e-16 nmvp=7 e[0]=-116.471788147632 t=0.149
 ibond=4 bond=(5,0)-(6,0) forward=1 deff=38 dwt=+0.000e+00 nmvp=6 e[0]=-116.472302317891 t=0.200
 ibond=5 bond=(6,0)-(7,0) forward=1 deff=47 dwt=-2.220e-16 nmvp=7 e[0]=-116.472905736041 t=0.766
 ibond=6 bond=(7,0)-(8,0) forward=1 deff=57 dwt=+0.000e+00 nmvp=8 e[0]=-116.481452453825 t=0.397
 ibond=7 bond=(8,0)-(9,0) forward=1 deff=65 dwt=+1.110e-16 nmvp=8 e[0]=-116.490872151426 t=0.874
 ibond=8 bond=(9,0)-(10,0) forward=1 deff=73 dwt=+0.000e+00 nmvp=8 e[0]=-116.494975102556 t=4.518
 ibond=9 bond=(10,0)-(11,0) forward=1 deff=74 dwt=-2.220e-16 nmvp=9 e[0]=-116.502578257621 t=0.900
 ibond=10 bond=(11,0)-(12,0) forward=1 deff=77 dwt=-6.661e-16 nmvp=10 e[0]=-116.517004448238 t=0.512
 ibond=11 bond=(12,0)-(13,0) forward=1 deff=68 dwt=-2.220e-16 nmvp=10 e[0]=-116.527839869804 t=0.417
 ibond=12 bond=(13,0)-(14,0) forward=1 deff=58 dwt=-2.220e-16 nmvp=10 e[0]=-116.532946558375 t=0.653
 ibond=13 bond=(14,0)-(15,0) forward=1 deff=42 dwt=-2.220e-16 nmvp=9 e[0]=-116.536936803243 t=0.311
 ibond=14 bond=(15,0)-(16,0) forward=1 deff=24 dwt=-2.220e-16 nmvp=8 e[0]=-116.539344816793 t=0.218
 ibond=15 bond=(16,0)-(17,0) forward=1 deff=10 dwt=+0.000e+00 nmvp=6 e[0]=-116.540403924337 t=0.139
 ibond=16 bond=(17,0)-(18,0) forward=1 deff=4 dwt=+0.000e+00 nmvp=5 e[0]=-116.540558010161 t=0.093
 ibond=17 bond=(17,0)-(18,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=1 e[0]=-116.540558010161 t=0.044
 ibond=18 bond=(16,0)-(17,0) forward=0 deff=64 dwt=+0.000e+00 nmvp=4 e[0]=-116.540655294172 t=0.417
 ibond=19 bond=(15,0)-(16,0) forward=0 deff=24 dwt=+0.000e+00 nmvp=7 e[0]=-116.541906050312 t=0.216
 ibond=20 bond=(14,0)-(15,0) forward=0 deff=42 dwt=+1.110e-16 nmvp=6 e[0]=-116.542005052969 t=0.162
 ibond=21 bond=(13,0)-(14,0) forward=0 deff=58 dwt=-2.220e-16 nmvp=6 e[0]=-116.542042290831 t=0.197
 ibond=22 bond=(12,0)-(13,0) forward=0 deff=68 dwt=-4.441e-16 nmvp=7 e[0]=-116.542148034411 t=0.248
 ibond=23 bond=(11,0)-(12,0) forward=0 deff=77 dwt=+0.000e+00 nmvp=7 e[0]=-116.542410234795 t=0.574
 ibond=24 bond=(10,0)-(11,0) forward=0 deff=74 dwt=+2.220e-16 nmvp=7 e[0]=-116.542894169549 t=0.431
 ibond=25 bond=(9,0)-(10,0) forward=0 deff=73 dwt=+2.220e-16 nmvp=7 e[0]=-116.543584635644 t=4.192
 ibond=26 bond=(8,0)-(9,0) forward=0 deff=65 dwt=-2.220e-16 nmvp=7 e[0]=-116.544442499872 t=1.011
 ibond=27 bond=(7,0)-(8,0) forward=0 deff=57 dwt=-4.441e-16 nmvp=6 e[0]=-116.544817486309 t=0.822
 ibond=28 bond=(6,0)-(7,0) forward=0 deff=47 dwt=-2.220e-16 nmvp=6 e[0]=-116.545270147744 t=0.813
 ibond=29 bond=(5,0)-(6,0) forward=0 deff=38 dwt=+0.000e+00 nmvp=6 e[0]=-116.545613677065 t=0.391
 ibond=30 bond=(4,0)-(5,0) forward=0 deff=27 dwt=+0.000e+00 nmvp=6 e[0]=-116.545939137556 t=0.258
 ibond=31 bond=(3,0)-(4,0) forward=0 deff=17 dwt=-2.220e-16 nmvp=5 e[0]=-116.546006420381 t=0.153
 ibond=32 bond=(2,0)-(3,0) forward=0 deff=12 dwt=+1.110e-16 nmvp=3 e[0]=-116.546038094874 t=0.397
 ibond=33 bond=(1,0)-(2,0) forward=0 deff=12 dwt=-2.220e-16 nmvp=1 e[0]=-116.546038094874 t=0.096
 eav_max=-116.446553669725 [ibond=0]  dwt_min=-6.661e-16 [ibond=10]
 eav_min=-116.546038094874 [ibond=33]  dwt_max=2.220e-16 [ibond=25]
 eav_diff=0.099484425150
 sweep energies: isweep=0 dots=1 dcut=100 deff=12 dwt=-2.220e-16 e[0]=-116.546038094874
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0 mpisize=1 maxthreads=112
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  1     100 1.000e-04 0.000e+00 | 218 | 2.094e+01 | 2.094e+01 | 1.420e-01 1.490e+00 2.622e-01 1.894e+00 9.04
results: isweep, dcut, dwt, energies (delta_e)
            0     100 -2.220e-16 e[0]=-116.546038094874 (0.000e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep0
----------------------------------------------------------------------

ctns::sweep_final_LCR2CRR: convert [LC]R => [CR]R
ctns::decimation_row ifab=1 iftrunc=1 dcut=4 nqr=12 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_C0R1.txt
 qbond: qsuper nsym=12 dimAll=48
 (28,0):9 (27,-1):3 (29,-1):9 (27,1):3 (26,0):1 (28,-2):3 (30,0):6 (31,-1):2 (29,1):6 (30,-2):3 (28,2):2 (29,-3):1
timing for divide=1.223e-05
timing for compute=1.592e-02
timing for collect=1.956e-05
----- TMING FOR decimation_genbasis(nkr): 1.595e-02 S T(divide/compute/collect)=1.223e-05,1.592e-02,1.956e-05 -----
decimation summary: 48->4 dwt=+0.000e+00 SvN=4.018e-01
 qbond: qkept nsym=4 dimAll=4
 (28,0):1 (29,-1):1 (30,0):1 (29,1):1
----- TIMING for decimation_row(nkr): 1.636e-02 S T(decim/select/formRot)=1.603e-02,3.041e-04,2.468e-05 -----

ctns::sweep_final_CR2cRR: convert [C]R => [cR]R
ctns::decimation_row ifab=1 iftrunc=1 dcut=1 nqr=9 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_cR0.txt
 qbond: qsuper nsym=9 dimAll=16
 (28,0):1 (29,-1):2 (30,0):4 (29,1):2 (31,-1):2 (32,0):1 (31,1):2 (30,2):1 (30,-2):1
timing for divide=6.447e-06
timing for compute=1.323e-02
timing for collect=1.333e-05
----- TMING FOR decimation_genbasis(nkr): 1.325e-02 S T(divide/compute/collect)=6.447e-06,1.323e-02,1.333e-05 -----
decimation summary: 16->1 dwt=+0.000e+00 SvN=0.000e+00
 qbond: qkept nsym=1 dimAll=1
 (30,0):1
----- TIMING for decimation_row(nkr): 1.355e-02 S T(decim/select/formRot)=1.331e-02,2.258e-04,1.698e-05 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep0

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=16 maxdiff=0.000e+00 deviate=0
 idx=2 node=(17,0) Drow=64 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=24 maxdiff=1.799e-15 deviate=0
 idx=4 node=(15,0) Drow=42 maxdiff=2.866e-15 deviate=0
 idx=5 node=(14,0) Drow=58 maxdiff=2.855e-15 deviate=0
 idx=6 node=(13,0) Drow=68 maxdiff=3.127e-15 deviate=0
 idx=7 node=(12,0) Drow=77 maxdiff=3.528e-15 deviate=0
 idx=8 node=(11,0) Drow=74 maxdiff=4.566e-15 deviate=0
 idx=9 node=(10,0) Drow=73 maxdiff=3.513e-15 deviate=0
 idx=10 node=(9,0) Drow=65 maxdiff=3.324e-15 deviate=0
 idx=11 node=(8,0) Drow=57 maxdiff=2.919e-15 deviate=0
 idx=12 node=(7,0) Drow=47 maxdiff=3.507e-15 deviate=0
 idx=13 node=(6,0) Drow=38 maxdiff=2.641e-15 deviate=0
 idx=14 node=(5,0) Drow=27 maxdiff=1.848e-15 deviate=0
 idx=15 node=(4,0) Drow=17 maxdiff=1.212e-15 deviate=0
 idx=16 node=(3,0) Drow=12 maxdiff=1.165e-15 deviate=0
 idx=17 node=(2,0) Drow=12 maxdiff=8.355e-16 deviate=0
 idx=18 node=(1,0) Drow=4 maxdiff=2.220e-16 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=4.441e-16 deviate=0
qtensor2: wf2 own=1 _data=0x4de8ede0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x4de8ede0
      1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=4.4409e-16 deviate=0
----- TIMING FOR ctns::rcanon_check : 1.226e-03 S -----

ctns::oper_final - build Hmat for RCF at isweep=0

coord=(1,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHPQ nops=C:36 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=12,12 size(op)=30:0.000229MB size(tot)=919:0.00701MB:6.85e-06GB
ctns::oper_renorm coord=(1,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:38 S:2 H:1 P:1 Q:3 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=94:0.000717MB:7e-07GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.539e+03S Sys:3.204e+00S Total:1.542e+03S
----- TIMING FOR symbolic_formulae_renorm with size=45 : 1.523e-03 S -----
rank=0 GPUmem(GB): used=2.5e-05 (oper)=2.5e-05
rank=0 GPUmem(GB): used=2.52e-05 (oper,site)(GB)=2.5e-05,2.24e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=45
 no. of rintermediate operators=20
 no. of coefficients=360:0.00275MB:2.68e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 7.498e-05 S -----
rank=0 GPUmem(GB): used=2.79e-05 (oper,site,rinter)=2.5e-05,2.24e-07,2.68e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00143 S size(rtasks)=45 size(Rlst2)=16 T(Rmu/Rlist)=0.000328,0.0011 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00155 S size(rtasks)=45 size(Rlst)=797 -----
rank=0 GPUmem(GB): used=2.79e-05 (oper,site,rinter,batch)=2.5e-05,2.24e-07,2.68e-06,0.000101 blksize=4 blksize0=8 batchsize=797
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000876,0.00199,0.00107
--- TIMING FOR renorm : t_inter=8.8e-04 t_gemm=2.0e-03 t_reduction=1.1e-03 tot=3.9e-03 ---
 renorm[inter] counter=35 t=8.8e-04 per=2.2e+01 cost=1.4e+04 flops=1.6e+07
 renorm[gemm] counter=35 i=0 t=1.9e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=1 t=1.4e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=2 t=7.2e-04 per=1.8e+01 cost=3.0e+03 flops=4.1e+06
 renorm[gemm] counter=35 i=3 t=8.6e-04 per=2.2e+01 cost=5.6e+03 flops=6.5e+06
 renorm[gemm] counter=35 i=4 t=1.7e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=5 t=1.5e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=6 t=4.0e-04 per=1.0e+01 cost=3.9e+03 flops=9.9e+06
 renorm[gemm] counter=35 total t=2.0e-03 per=5.1e+01 cost=1.3e+04 flops=6.3e+06
 renorm[red] counter=35 t=1.1e-03 per=2.7e+01 cost=1.6e+03 flops=1.5e+06
--- TIMING FOR renorm_tot : t_inter=4.3e-02 t_gemm=4.0e-01 t_reduction=1.1e-01 tot=5.5e-01 ---
 renorm_tot[inter] counter=35 t=4.3e-02 per=7.8e+00 cost=1.3e+08 flops=3.1e+09
 renorm_tot[gemm] counter=35 i=0 t=5.6e-05 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=35 i=1 t=4.5e-05 per=8.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=35 i=2 t=7.4e-02 per=1.3e+01 cost=2.2e+07 flops=3.0e+08
 renorm_tot[gemm] counter=35 i=3 t=6.1e-02 per=1.1e+01 cost=5.0e+07 flops=8.2e+08
 renorm_tot[gemm] counter=35 i=4 t=4.4e-02 per=7.9e+00 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=35 i=5 t=5.4e-02 per=9.9e+00 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=35 i=6 t=1.7e-01 per=3.0e+01 cost=1.8e+08 flops=1.1e+09
 renorm_tot[gemm] counter=35 total t=4.0e-01 per=7.3e+01 cost=3.3e+08 flops=8.2e+08
 renorm_tot[red] counter=35 t=1.1e-01 per=2.0e+01 cost=2.2e+07 flops=2.1e+08
qops.to_cpu: size(tot)=94:7.2e-04MB:7.0e-07GB t[to_cpu]=1.7e-05S speed=4.2e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0138 S rank=0 -----

coord=(0,0)
 cqops: oplist=CABPQSH nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
 rqops: oplist=CSHPQ nops=C:38 S:2 H:1 P:1 Q:3 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=94:0.000717MB:7e-07GB
ctns::oper_renorm coord=(0,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:40 S:0 H:1 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
CPUmem: VM:2.007e+01GB RSS:1.942e+00GB  Timing: User:1.539e+03S Sys:3.205e+00S Total:1.542e+03S
----- TIMING FOR symbolic_formulae_renorm with size=41 : 4.840e-04 S -----
rank=0 GPUmem(GB): used=1.81e-05 (oper)=1.81e-05
rank=0 GPUmem(GB): used=1.81e-05 (oper,site)(GB)=1.81e-05,2.98e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=41
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=1.81e-05 (oper,site,rinter)=1.81e-05,2.98e-08,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000473 S size(rtasks)=41 size(Rlst2)=1 T(Rmu/Rlist)=0.000202,0.000271 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000506 S size(rtasks)=41 size(Rlst)=186 -----
rank=0 GPUmem(GB): used=1.81e-05 (oper,site,rinter,batch)=1.81e-05,2.98e-08,0,4.16e-06 blksize=1 blksize0=0 batchsize=186
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=1.21e-05,0.000865,0.000205
--- TIMING FOR renorm : t_inter=1.2e-05 t_gemm=8.6e-04 t_reduction=2.0e-04 tot=1.1e-03 ---
 renorm[inter] counter=36 t=1.2e-05 per=1.1e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=0 t=2.0e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=1 t=1.4e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=2 t=4.6e-04 per=4.2e+01 cost=1.8e+02 flops=3.9e+05
 renorm[gemm] counter=36 i=3 t=2.3e-04 per=2.1e+01 cost=1.8e+02 flops=7.9e+05
 renorm[gemm] counter=36 i=4 t=1.5e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=5 t=1.5e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=6 t=1.7e-04 per=1.6e+01 cost=3.7e+02 flops=2.2e+06
 renorm[gemm] counter=36 total t=8.6e-04 per=8.0e+01 cost=7.3e+02 flops=8.5e+05
 renorm[red] counter=36 t=2.0e-04 per=1.9e+01 cost=3.7e+02 flops=1.8e+06
--- TIMING FOR renorm_tot : t_inter=4.3e-02 t_gemm=4.0e-01 t_reduction=1.1e-01 tot=5.5e-01 ---
 renorm_tot[inter] counter=36 t=4.3e-02 per=7.8e+00 cost=1.3e+08 flops=3.1e+09
 renorm_tot[gemm] counter=36 i=0 t=5.8e-05 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=1 t=4.6e-05 per=8.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=2 t=7.5e-02 per=1.4e+01 cost=2.2e+07 flops=3.0e+08
 renorm_tot[gemm] counter=36 i=3 t=6.2e-02 per=1.1e+01 cost=5.0e+07 flops=8.2e+08
 renorm_tot[gemm] counter=36 i=4 t=4.4e-02 per=7.9e+00 cost=2.7e+07 flops=6.1e+08
 renorm_tot[gemm] counter=36 i=5 t=5.4e-02 per=9.9e+00 cost=5.1e+07 flops=9.3e+08
 renorm_tot[gemm] counter=36 i=6 t=1.7e-01 per=3.0e+01 cost=1.8e+08 flops=1.1e+09
 renorm_tot[gemm] counter=36 total t=4.0e-01 per=7.3e+01 cost=3.3e+08 flops=8.2e+08
 renorm_tot[red] counter=36 t=1.1e-01 per=2.0e+01 cost=2.2e+07 flops=2.1e+08
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB t[to_cpu]=1.5e-05S speed=4.9e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
ctns::oper_ab2pq coord=(0,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0039 S rank=0 -----

matrix: Hmat_isweep0 size=(1,1)
     -1.165460380949e+02 

----- TIMING FOR ctns::sweep_opt : 2.103e+01 S -----

Congrats! CTNS calculation finishes successfully. Sun Nov 24 15:33:28 2024

