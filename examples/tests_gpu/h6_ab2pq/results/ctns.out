
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Wed Nov 20 16:30:59 2024

GIT_HASH = 2d213c3eca380cf1e2bfebbb49b79fc890ee1cea

mpisize = 1 maxthreads = 112

input file = input.dat

schedule::read fname = input.dat
----------------------------------------------------------------------
dtype 0
sorb 12
nelec 6
twom 0
twos 0
integral_file moleinfo/fmole.info
scratch ./scratch
#perfcomm 27

$ci
dets 
0 1 2 3 4 5 
end
nroots 2
schedule
0 1.e-5
end
maxiter 3
rdm 1 1
$end

$ctns
verbose 1
qkind rNSz
nroots 1
maxdets 100000
thresh_proj 1.e-15
thresh_ortho 1.e-8
topology_file topology/topo1
schedule
0 2 10 1.e-4 0.0
1 1 10 1.e-4 0.0
end
maxsweep 2
task_ham
task_dmrg
alg_renorm 19
alg_rinter 2
alg_hvec 19
alg_hinter 2
ifab2pq
ifdist1
ifdistc
ioasync
batchhvec 4 4 4
batchrenorm 4 4 4
$end

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
sorb  = 12
nelec = 6
twom  = 0
twos  = 0
integral_file = moleinfo/fmole.info
perfcomm = 0

===== params_ci::print =====
nroots = 2
no. of unique seeds = 1
0-th det: 0 1 2 3 4 5 
flip = 0
eps0 = 0.01
miniter = 0
maxiter = 3
schedule: iter eps1
0 1e-05
1 1e-05
2 1e-05
convergence parameters
deltaE = 1e-10
checkms = 0
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 1
jroot = 1
load = 0
ci_file = ci.info
cthrd = 0.1
ifanalysis = 0
rdm = 1
init_aufbau = 0
init_seniority = 0

===== params_ctns::print =====
qkind = rNSz
topology_file = topology/topo1
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
task_oodmrg = 0
task_vmc = 0
task_expand = 0
task_tononsu2 = 0
task_prop = 
task_schmidt = 0
schmidt_file = svalues
restart_sweep = 0
restart_bond = 0
timestamp = 0
ciroots = 
maxdets = 100000
thresh_proj = 1.000000e-15
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
outprec = 12
nroots = 1
guess = 1
dbranch = 0
maxsweep = 2
maxbond = -1
schedule: isweep, dots, dcut, eps, noise
0 2 10 1.000000e-04 0.000000e+00
1 1 10 1.000000e-04 0.000000e+00
rcfprefix = 
alg_hvec = 19
alg_hinter = 2
alg_hcoper = 0
alg_renorm = 19
alg_rinter = 2
alg_rcoper = 0
alg_rdm = 1
alg_decim = 1
notrunc = 0
ifab2pq = 1
ifdist1 = 1
ifdistc = 1
save_formulae = 0
sort_formulae = 0
save_mmtask = 0
batchhvec = 4 4 4
batchrenorm = 4 4 4
batchmem = 1.000000e+01
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
precond = 1
rcanon_file = 
rcanon2_file = 
iomode = 0
async_fetch = 1
async_save = 1
async_remove = 1
ifnccl = 0
iroot = 0
jroot = 0
nsample = 5000
nprt = 10
pthrd = -1.000000e-02
thresh_cabs = 1.100000e+00
detbasis = 0
tosu2 = 0
thresh_tosu2 = 1.000000e-08
singlet = 0
diagcheck = 0
savebin = 0
fromnosym = 0
oodmrg parameters:
 iprt=1
 maxiter=10
 dfac=2
 macroiter=5
 microiter=50
 alpha=5.000000e-01
 thrdopt=1.000000e-04
 thrdloc=1.000000e-06
 thrddwt=1.000000e+00
 thrdeps=1.000000e-08
 nptloc=2.000000e+01
 acceptall=0
 unrestricted=0
 urot=
inputconf = 
saveconfs = 
loadconfs = 
debug_rdm = 0
alg_mrpt2 = 0
nv2 = 0
nc2 = 0

io::create_scratch scratch=./scratch

gpu_init
CUDA Runtime version: 11080
CUBLAS version: 111103
rank=0 num_gpus=2 device_id=0 magma_queue=0x240ae80

ctns::topology::read fname=topology/topo1
0
1
2
3
4
5

ctns::topology::print ifmps=1 ntotal=6 nphysical=6 nbackbone=6
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
 i=5 : 5 
rcoord:
 idx=0 coord=(5,0) rindex=0 node: lindex=5 porb=5 type=0 center=(-1,-1) left=(4,0) right=(-2,-2)
 idx=1 coord=(4,0) rindex=1 node: lindex=4 porb=4 type=1 center=(-1,-1) left=(3,0) right=(5,0)
 idx=2 coord=(3,0) rindex=2 node: lindex=3 porb=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=3 coord=(2,0) rindex=3 node: lindex=2 porb=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=4 coord=(1,0) rindex=4 node: lindex=1 porb=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=5 coord=(0,0) rindex=5 node: lindex=0 porb=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(5,0) rsupport: 5 ; lsupport: 0 1 2 3 4 
 idx=1 coord=(4,0) rsupport: 4 5 ; lsupport: 0 1 2 3 
 idx=2 coord=(3,0) rsupport: 3 4 5 ; lsupport: 0 1 2 
 idx=3 coord=(2,0) rsupport: 2 3 4 5 ; lsupport: 0 1 
 idx=4 coord=(1,0) rsupport: 1 2 3 4 5 ; lsupport: 0 
 idx=5 coord=(0,0) rsupport: 0 1 2 3 4 5 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(5,0) corbs: 5 ; rorbs: ; lorbs: 0 1 2 3 4 
 idx=1 coord=(4,0) corbs: 4 ; rorbs: 5 ; lorbs: 0 1 2 3 
 idx=2 coord=(3,0) corbs: 3 ; rorbs: 4 5 ; lorbs: 0 1 2 
 idx=3 coord=(2,0) corbs: 2 ; rorbs: 3 4 5 ; lorbs: 0 1 
 idx=4 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 5 ; lorbs: 0 
 idx=5 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 5 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9 10 11

fci::ci_load fname=./scratch/ci.info

ctns::rcanon_init qkind=qNSz

fci::ci_truncate ciconfs=399 maxdets=100000 ifortho=1
 iroot=0 <CI[trunc]|CI>=1.000000000000e+00
 iroot=1 <CI[trunc]|CI>=1.000000000000e+00

ctns::init_rbases rdm_svd=1.500e+00 thresh_proj=1.000e-15

idx=
idx=0 node=
idx=
idx=
idx=1 node=(4,0) type=1
idx=25 node=(04,0) type=3( node=5,0) type=0 node=(( node=(21,,03,0) rsupport=00) type=) type= rsupport=11 type= rsupport=11  rsupport=23 4 5  3 4 5 
 rsupport=2 3 4 5 
0
 1 2 3 4 5 
 rsupport=5 
4 5 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-15
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-15
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-15
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-15
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-15
 dim(space,lspace,rspace)=399,195,16 dimBc=16 1-popBc=-4.441e-16 SvN=1.347e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.457e-02 S -----
 dim(space,lspace,rspace)=399,63,63 dimBc=63 1-popBc=-2.22e-16 SvN=1.51
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.573e-02 S -----
 dim(space,lspace,rspace)=399,1,399 dimBc=2 1-popBc=0 SvN=0.693
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.480e-02 S -----
 dim(space,lspace,rspace)=399,4,399 dimBc=8 1-popBc=0 SvN=1.76
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.522e-02 S -----
 dim(space,lspace,rspace)=399,16,195 dimBc=32 1-popBc=7.77e-16 SvN=1.61
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.564e-02 S -----

generated rbases with thresh_proj=1e-15
 idx=0 node=(5,0) type=0 shape=4,4 1-popBc=0.000e+00
 idx=1 node=(4,0) type=1 shape=16,16 1-popBc=-4.441e-16
 idx=2 node=(3,0) type=1 shape=63,63 1-popBc=-2.220e-16
 idx=3 node=(2,0) type=1 shape=195,32 1-popBc=7.772e-16
 idx=4 node=(1,0) type=1 shape=399,8 1-popBc=0.000e+00
 idx=5 node=(0,0) type=0 shape=399,2 1-popBc=0.000e+00
maximum bond dimension = 63
----- TIMING FOR ctns::init_rbases : 4.215e-02 S -----

ctns::init_rsites qkind=qNSz thresh_ortho=1e-08
 idx=0 node=(5,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 deviate=0 TIMING=6.346e-05 S
 idx=1 node=(4,0)[1] shape(l,r,c)=(16,4,4) maxdiff=9.891e-16 deviate=0 TIMING=1.435e-02 S
 idx=2 node=(3,0)[1] shape(l,r,c)=(63,16,4) maxdiff=2.348e-15 deviate=0 TIMING=1.366e-02 S
 idx=3 node=(2,0)[1] shape(l,r,c)=(32,63,4) maxdiff=2.154e-15 deviate=0 TIMING=9.668e-03 S
 idx=4 node=(1,0)[1] shape(l,r,c)=(8,32,4) maxdiff=1.334e-15 deviate=0 TIMING=9.659e-03 S
 idx=5 node=(0,0)[0] shape(l,r,c)=(2,8,4) maxdiff=2.291e-16 deviate=0 TIMING=9.744e-03 S
----- TIMING FOR ctns::init_rsites : 5.791e-02 S -----

ctns::init_rwfuns qkind=qNSz thresh_ortho=1e-08
qtensor2: wf2 own=1 _data=0x4f194940
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (6,0):2
 qbond: qcol nsym=1 dimAll=2
 (6,0):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.05e-05MB

check state overlaps ...
matrix: ova_rwfuns size=(2,2)
      1.0000e+00       1.5407e-33 
      1.5407e-33       1.0000e+00 
matrix: ova0_vs size=(2,2)
      1.0000e+00      -2.7756e-17 
     -2.7756e-17       1.0000e+00 
diff of ova matrices = 3.165e-16
----- TIMING FOR ctns::init_rwfuns : 2.619e-03 S -----

ctns::init_rcanon thresh_ortho=1e-08

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=2 ciconfs=399
matrix: <CI|CTNS[0]> size=(2,2)
      1.0000e+00      -9.0745e-17 
     -7.5091e-17       1.0000e+00 

matrix: <CTNS[0]|CTNS[0]> size=(2,2)
      1.0000e+00      -1.6038e-16 
     -3.2691e-16       1.0000e+00 

rcanon::rcanon_canonicalize ifortho=1 ifab=1 nroots=2 dmax=63
----- TIMING FOR ctns::rcanon_canonicalize : 9.994e-02 S -----

matrix: <CTNS[new]|CTNS[new]> size=(2,2)
      1.0000e+00      -4.1260e-16 
     -4.1430e-16       1.0000e+00 

matrix: <CTNS[0]|CTNS[new]> size=(2,2)
      1.0000e+00      -1.0212e-15 
      4.9867e-16       1.0000e+00 

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=2 ciconfs=399
matrix: <CI|CTNS[new]> size=(2,2)
      1.0000e+00      -9.4104e-16 
      5.8106e-16       1.0000e+00 

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(5,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(4,0) Drow=16 maxdiff=6.001e-16 deviate=0
 idx=2 node=(3,0) Drow=63 maxdiff=2.911e-15 deviate=0
 idx=3 node=(2,0) Drow=32 maxdiff=2.021e-15 deviate=0
 idx=4 node=(1,0) Drow=8 maxdiff=7.022e-16 deviate=0
 idx=5 node=(0,0) Drow=2 maxdiff=5.097e-16 deviate=0
qtensor2: wf2 own=1 _data=0x4e70b780
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (6,0):2
 qbond: qcol nsym=1 dimAll=2
 (6,0):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.052e-05MB
i=0 idx=0 block[0:(6,0),0:(6,0)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x4e70b780
      1.0000e+00      -1.3878e-15 
     -1.3878e-15      -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=2 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 2.104e-04 S -----
----- TIMING FOR ctns::rcanon_init : 3.196e-01 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(5,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(4,0) Drow=16 maxdiff=6.001e-16 deviate=0
 idx=2 node=(3,0) Drow=63 maxdiff=2.911e-15 deviate=0
 idx=3 node=(2,0) Drow=32 maxdiff=2.021e-15 deviate=0
 idx=4 node=(1,0) Drow=8 maxdiff=7.022e-16 deviate=0
 idx=5 node=(0,0) Drow=2 maxdiff=5.097e-16 deviate=0
qtensor2: wf2 own=1 _data=0x4e501f50
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (6,0):2
 qbond: qcol nsym=1 dimAll=2
 (6,0):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.052e-05MB
i=0 idx=0 block[0:(6,0),0:(6,0)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x4e501f50
      1.0000e+00      -1.3878e-15 
     -1.3878e-15      -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=2 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 2.509e-04 S -----

integral::load fname = moleinfo/fmole.info
 sorb = 12
 size(int1e) = 144:0.0011MB:1.07e-06GB
 size(int2e) = 2277:0.0174MB:1.7e-05GB
 ecore = 4.603841735000
----- TIMING FOR integral::load : 1.053e-03 S -----

io::remove_scratch scratch=./scratch/sweep
successfully removed ./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=qNSz
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(5,0) size=0.00159MB:1.55e-06GB
fname=./scratch/sweep/cop(5,0) size=1.55e-06GB T[save](info/data/tot)=0.000126,5.22e-05,0.000178 speed=0.00872GB/S disk[used]=1.78e-06GB
ctns::oper_save iomode=0 fname=./scratch/sweep/rop(5,0) size=0.00159MB:1.55e-06GB
fname=./scratch/sweep/rop(5,0) size=1.55e-06GB T[save](info/data/tot)=8.45e-05,8.81e-05,0.000173 speed=0.00898GB/S disk[used]=3.56e-06GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(4,0) size=0.00159MB:1.55e-06GB
fname=./scratch/sweep/cop(4,0) size=1.55e-06GB T[save](info/data/tot)=0.00011,7.73e-05,0.000188 speed=0.00826GB/S disk[used]=5.34e-06GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(3,0) size=0.00159MB:1.55e-06GB
fname=./scratch/sweep/cop(3,0) size=1.55e-06GB T[save](info/data/tot)=0.00011,7.38e-05,0.000184 speed=0.00842GB/S disk[used]=7.12e-06GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(2,0) size=0.00159MB:1.55e-06GB
fname=./scratch/sweep/cop(2,0) size=1.55e-06GB T[save](info/data/tot)=0.000109,7.9e-05,0.000188 speed=0.00826GB/S disk[used]=8.9e-06GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(1,0) size=0.00159MB:1.55e-06GB
fname=./scratch/sweep/cop(1,0) size=1.55e-06GB T[save](info/data/tot)=0.000108,0.000108,0.000215 speed=0.00719GB/S disk[used]=1.07e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(0,0) size=0.00159MB:1.55e-06GB
fname=./scratch/sweep/cop(0,0) size=1.55e-06GB T[save](info/data/tot)=0.000112,7.47e-05,0.000187 speed=0.00828GB/S disk[used]=1.25e-05GB
----- TIMING FOR ctns::oper_init_dotCR : 7.648e-03 S -----
T[ctns::oper_init_dotCR](comp/save/tot)=0.00552,0.00167,0.00718

idx=1 coord=(4,0)
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=208:0.00159MB:1.55e-06GB
 rqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=208:0.00159MB:1.55e-06GB
ctns::oper_renorm coord=(4,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:4 S:8 H:1 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=680:0.00519MB:5.07e-06GB
CPUmem: VM:1.909e+01GB RSS:1.827e+00GB  Timing: User:2.255e+01S Sys:1.252e+00S Total:2.380e+01S
----- TIMING FOR symbolic_formulae_renorm with size=29 : 6.434e-04 S -----
rank=0 GPUmem(GB): used=8.17e-06 (oper)=8.17e-06
rank=0 GPUmem(GB): used=8.43e-06 (oper,site)(GB)=8.17e-06,2.68e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=29
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=8.43e-06 (oper,site,rinter)=8.17e-06,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00109 S size(rtasks)=29 size(Rlst2)=81 T(Rmu/Rlist)=0.00022,0.000867 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00117 S size(rtasks)=29 size(Rlst)=692 -----
rank=0 GPUmem(GB): used=8.43e-06 (oper,site,rinter,batch)=8.17e-06,2.68e-07,0,0.00017 blksize=16 blksize0=0 batchsize=692
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=2.6e-05,0.000747,0.000194
--- TIMING FOR renorm : t_inter=2.6e-05 t_gemm=7.5e-04 t_reduction=1.9e-04 tot=9.6e-04 ---
 renorm[inter] counter=1 t=2.6e-05 per=2.7e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=3.9e-04 per=4.0e+01 cost=8.6e+02 flops=2.2e+06
 renorm[gemm] counter=1 i=1 t=8.2e-05 per=8.5e+00 cost=1.7e+03 flops=2.1e+07
 renorm[gemm] counter=1 i=2 t=7.5e-05 per=7.7e+00 cost=1.2e+03 flops=1.6e+07
 renorm[gemm] counter=1 i=3 t=6.9e-05 per=7.2e+00 cost=1.4e+03 flops=2.0e+07
 renorm[gemm] counter=1 i=4 t=1.1e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=5 t=1.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=6 t=1.3e-04 per=1.3e+01 cost=8.2e+03 flops=6.3e+07
 renorm[gemm] counter=1 total t=7.5e-04 per=7.7e+01 cost=1.3e+04 flops=1.8e+07
 renorm[red] counter=1 t=1.9e-04 per=2.0e+01 cost=8.2e+03 flops=4.2e+07
--- TIMING FOR renorm_tot : t_inter=2.6e-05 t_gemm=7.5e-04 t_reduction=1.9e-04 tot=9.6e-04 ---
 renorm_tot[inter] counter=1 t=2.6e-05 per=2.7e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=3.9e-04 per=4.0e+01 cost=8.6e+02 flops=2.2e+06
 renorm_tot[gemm] counter=1 i=1 t=8.2e-05 per=8.5e+00 cost=1.7e+03 flops=2.1e+07
 renorm_tot[gemm] counter=1 i=2 t=7.5e-05 per=7.7e+00 cost=1.2e+03 flops=1.6e+07
 renorm_tot[gemm] counter=1 i=3 t=6.9e-05 per=7.2e+00 cost=1.4e+03 flops=2.0e+07
 renorm_tot[gemm] counter=1 i=4 t=1.1e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=5 t=1.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=6 t=1.3e-04 per=1.3e+01 cost=8.2e+03 flops=6.3e+07
 renorm_tot[gemm] counter=1 total t=7.5e-04 per=7.7e+01 cost=1.3e+04 flops=1.8e+07
 renorm_tot[red] counter=1 t=1.9e-04 per=2.0e+01 cost=8.2e+03 flops=4.2e+07
qops.to_cpu: size(tot)=680:5.2e-03MB:5.1e-06GB t[to_cpu]=2.5e-05S speed=2.1e-01GB/S
check ||H-H.dagger||=3.797e-16 coord=(4,0) rank=0
ctns::oper_ab2pq coord=(4,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00792 S rank=0 -----
##### local oper_env: 1.016e-02 S #####
 T(local oper_env: fetch) = 1.796e-03 S  per = 17.7  per(accum) = 17.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17.7
 T(local oper_env: renrm) = 8.042e-03 S  per = 79.2  per(accum) = 96.9
 T(local oper_env: save ) = 3.174e-04 S  per = 3.12  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.042e-03 S  T(sum) = 8.042e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.262e-05 S  per = 0.157  per(accum) = 0.157
 T(local oper_env: qops init                    ) = 4.928e-04 S  per = 6.13  per(accum) = 6.28
 T(local oper_env: symbolic_formulae_renorm     ) = 6.535e-04 S  per = 8.13  per(accum) = 14.4
 T(local oper_env: allocate qops on gpu         ) = 5.400e-05 S  per = 0.671  per(accum) = 15.1
 T(local oper_env: site memcpy cpu2gpu          ) = 3.846e-05 S  per = 0.478  per(accum) = 15.6
 T(local oper_env: rintermediate init           ) = 3.477e-05 S  per = 0.432  per(accum) = 16
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.207e-03 S  per =   15  per(accum) = 31
 T(local oper_env: rmmtasks init                ) = 4.283e-03 S  per = 53.3  per(accum) = 84.3
 T(local oper_env: qops memset on cpu           ) = 1.010e-07 S  per = 0.00126  per(accum) = 84.3
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.073e-03 S  per = 13.3  per(accum) = 97.6
 T(local oper_env: reduction of opS & opH [nccl]) = 1.678e-06 S  per = 0.0209  per(accum) = 97.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.067e-05 S  per = 0.381  per(accum) = 98
 T(local oper_env: deallocate cpu and gpu memory) = 2.115e-05 S  per = 0.263  per(accum) = 98.3
 T(local oper_env: reduction of opS & opH [comm]) = 3.319e-05 S  per = 0.413  per(accum) = 98.7
 T(local oper_env: conversion from opAB to opPQ ) = 5.515e-06 S  per = 0.0686  per(accum) = 98.7
 T(local oper_env: after oper_renorm            ) = 1.007e-04 S  per = 1.25  per(accum) = 100
##### sweep oper_env: 1.016e-02 S #####
 T(sweep oper_env: fetch) = 1.796e-03 S  per = 17.7  per(accum) = 17.7
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17.7
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17.7
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17.7
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17.7
 T(sweep oper_env: renrm) = 8.042e-03 S  per = 79.2  per(accum) = 96.9
 T(sweep oper_env: save ) = 3.174e-04 S  per = 3.12  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(sweep oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.042e-03 S  T(sum) = 8.042e-03 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.262e-05 S  per = 0.157  per(accum) = 0.157
 T(sweep oper_env: qops init                    ) = 4.928e-04 S  per = 6.13  per(accum) = 6.28
 T(sweep oper_env: symbolic_formulae_renorm     ) = 6.535e-04 S  per = 8.13  per(accum) = 14.4
 T(sweep oper_env: allocate qops on gpu         ) = 5.400e-05 S  per = 0.671  per(accum) = 15.1
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.846e-05 S  per = 0.478  per(accum) = 15.6
 T(sweep oper_env: rintermediate init           ) = 3.477e-05 S  per = 0.432  per(accum) = 16
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.207e-03 S  per =   15  per(accum) = 31
 T(sweep oper_env: rmmtasks init                ) = 4.283e-03 S  per = 53.3  per(accum) = 84.3
 T(sweep oper_env: qops memset on cpu           ) = 1.010e-07 S  per = 0.00126  per(accum) = 84.3
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.073e-03 S  per = 13.3  per(accum) = 97.6
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.678e-06 S  per = 0.0209  per(accum) = 97.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.067e-05 S  per = 0.381  per(accum) = 98
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.115e-05 S  per = 0.263  per(accum) = 98.3
 T(sweep oper_env: reduction of opS & opH [comm]) = 3.319e-05 S  per = 0.413  per(accum) = 98.7
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.515e-06 S  per = 0.0686  per(accum) = 98.7
 T(sweep oper_env: after oper_renorm            ) = 1.007e-04 S  per = 1.25  per(accum) = 100

idx=2 coord=(3,0)
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=208:0.00159MB:1.55e-06GB
 rqops: oplist=CSHAB nops=C:4 S:8 H:1 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=680:0.00519MB:5.07e-06GB
ctns::oper_renorm coord=(3,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:6 S:6 H:1 A:15 B:21 
        dim(bra,ket)=63,63 size(op)=399:0.00304MB size(tot)=13422:0.102MB:0.0001GB
CPUmem: VM:1.915e+01GB RSS:1.828e+00GB  Timing: User:2.256e+01S Sys:1.253e+00S Total:2.381e+01S
----- TIMING FOR symbolic_formulae_renorm with size=49 : 1.213e-03 S -----
rank=0 GPUmem(GB): used=0.000107 (oper)=0.000107
rank=0 GPUmem(GB): used=0.00011 (oper,site)(GB)=0.000107,2.97e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=49
 no. of rintermediate operators=24
 no. of coefficients=48:0.000366MB:3.58e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 6.426e-05 S -----
rank=0 GPUmem(GB): used=0.00011 (oper,site,rinter)=0.000107,2.97e-06,3.58e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00398 S size(rtasks)=49 size(Rlst2)=225 T(Rmu/Rlist)=0.00043,0.00355 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00433 S size(rtasks)=49 size(Rlst)=3345 -----
rank=0 GPUmem(GB): used=0.00011 (oper,site,rinter,batch)=0.000107,2.97e-06,3.58e-07,0.00426 blksize=81 blksize0=8 batchsize=3345
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000106,0.00107,0.00017
--- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=1.1e-03 t_reduction=1.7e-04 tot=1.3e-03 ---
 renorm[inter] counter=2 t=1.1e-04 per=7.9e+00 cost=5.7e+03 flops=5.3e+07
 renorm[gemm] counter=2 i=0 t=1.2e-04 per=9.0e+00 cost=3.7e+04 flops=3.0e+08
 renorm[gemm] counter=2 i=1 t=1.2e-04 per=8.8e+00 cost=3.5e+04 flops=3.0e+08
 renorm[gemm] counter=2 i=2 t=2.3e-04 per=1.7e+01 cost=7.5e+04 flops=3.2e+08
 renorm[gemm] counter=2 i=3 t=3.0e-04 per=2.3e+01 cost=1.0e+05 flops=3.4e+08
 renorm[gemm] counter=2 i=4 t=1.0e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=5 t=1.0e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=6 t=2.9e-04 per=2.2e+01 cost=6.2e+05 flops=2.1e+09
 renorm[gemm] counter=2 total t=1.1e-03 per=8.0e+01 cost=8.7e+05 flops=8.1e+08
 renorm[red] counter=2 t=1.7e-04 per=1.3e+01 cost=2.8e+05 flops=1.6e+09
--- TIMING FOR renorm_tot : t_inter=1.3e-04 t_gemm=1.8e-03 t_reduction=3.6e-04 tot=2.3e-03 ---
 renorm_tot[inter] counter=2 t=1.3e-04 per=5.7e+00 cost=5.7e+03 flops=4.3e+07
 renorm_tot[gemm] counter=2 i=0 t=5.1e-04 per=2.2e+01 cost=3.8e+04 flops=7.4e+07
 renorm_tot[gemm] counter=2 i=1 t=2.0e-04 per=8.6e+00 cost=3.7e+04 flops=1.8e+08
 renorm_tot[gemm] counter=2 i=2 t=3.1e-04 per=1.3e+01 cost=7.6e+04 flops=2.5e+08
 renorm_tot[gemm] counter=2 i=3 t=3.7e-04 per=1.6e+01 cost=1.0e+05 flops=2.8e+08
 renorm_tot[gemm] counter=2 i=4 t=2.1e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=5 t=2.1e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=6 t=4.2e-04 per=1.8e+01 cost=6.3e+05 flops=1.5e+09
 renorm_tot[gemm] counter=2 total t=1.8e-03 per=7.9e+01 cost=8.8e+05 flops=4.8e+08
 renorm_tot[red] counter=2 t=3.6e-04 per=1.6e+01 cost=2.8e+05 flops=7.8e+08
qops.to_cpu: size(tot)=13422:1.0e-01MB:1.0e-04GB t[to_cpu]=4.0e-05S speed=2.5e+00GB/S
check ||H-H.dagger||=2.644e-15 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=cr ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 0.325 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.000981,9.42e-06,0.134,0.19,0.000196,0.000247 -----
----- TIMING FOR oper_renorm : 0.0312 S rank=0 -----
##### local oper_env: 3.591e-01 S #####
 T(local oper_env: fetch) = 8.961e-04 S  per = 0.25  per(accum) = 0.25
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 0.25
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 0.25
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 0.25
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 0.25
 T(local oper_env: renrm) = 3.572e-01 S  per = 99.5  per(accum) = 99.7
 T(local oper_env: save ) = 9.491e-04 S  per = 0.264  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.572e-01 S  T(sum) = 3.572e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.714e-06 S  per = 0.00216  per(accum) = 0.00216
 T(local oper_env: qops init                    ) = 1.137e-03 S  per = 0.318  per(accum) = 0.321
 T(local oper_env: symbolic_formulae_renorm     ) = 1.222e-03 S  per = 0.342  per(accum) = 0.663
 T(local oper_env: allocate qops on gpu         ) = 2.807e-05 S  per = 0.00786  per(accum) = 0.67
 T(local oper_env: site memcpy cpu2gpu          ) = 2.489e-05 S  per = 0.00697  per(accum) = 0.677
 T(local oper_env: rintermediate init           ) = 7.347e-05 S  per = 0.0206  per(accum) = 0.698
 T(local oper_env: preprocess_formulae_Rlist2   ) = 4.476e-03 S  per = 1.25  per(accum) = 1.95
 T(local oper_env: rmmtasks init                ) = 2.254e-02 S  per = 6.31  per(accum) = 8.26
 T(local oper_env: qops memset on cpu           ) = 2.900e-08 S  per = 8.12e-06  per(accum) = 8.26
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.441e-03 S  per = 0.403  per(accum) = 8.66
 T(local oper_env: reduction of opS & opH [nccl]) = 9.840e-07 S  per = 0.000275  per(accum) = 8.66
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.554e-05 S  per = 0.0127  per(accum) = 8.68
 T(local oper_env: deallocate cpu and gpu memory) = 1.179e-04 S  per = 0.033  per(accum) = 8.71
 T(local oper_env: reduction of opS & opH [comm]) = 4.998e-05 S  per = 0.014  per(accum) = 8.72
 T(local oper_env: conversion from opAB to opPQ ) = 3.255e-01 S  per = 91.1  per(accum) = 99.8
 T(local oper_env: after oper_renorm            ) = 5.792e-04 S  per = 0.162  per(accum) = 100
##### sweep oper_env: 3.692e-01 S #####
 T(sweep oper_env: fetch) = 2.692e-03 S  per = 0.729  per(accum) = 0.729
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 0.729
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 0.729
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 0.729
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 0.729
 T(sweep oper_env: renrm) = 3.653e-01 S  per = 98.9  per(accum) = 99.7
 T(sweep oper_env: save ) = 1.266e-03 S  per = 0.343  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.464e+09 S  per = -3.464e+31
 T(sweep oper_env: preprocess                  ) = -3.464e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.653e-01 S  T(sum) = 3.653e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.033e-05 S  per = 0.00557  per(accum) = 0.00557
 T(sweep oper_env: qops init                    ) = 1.630e-03 S  per = 0.446  per(accum) = 0.452
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.875e-03 S  per = 0.513  per(accum) = 0.965
 T(sweep oper_env: allocate qops on gpu         ) = 8.208e-05 S  per = 0.0225  per(accum) = 0.988
 T(sweep oper_env: site memcpy cpu2gpu          ) = 6.335e-05 S  per = 0.0173  per(accum) = 1.01
 T(sweep oper_env: rintermediate init           ) = 1.082e-04 S  per = 0.0296  per(accum) = 1.03
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.683e-03 S  per = 1.56  per(accum) = 2.59
 T(sweep oper_env: rmmtasks init                ) = 2.682e-02 S  per = 7.34  per(accum) = 9.93
 T(sweep oper_env: qops memset on cpu           ) = 1.300e-07 S  per = 3.56e-05  per(accum) = 9.93
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.514e-03 S  per = 0.688  per(accum) = 10.6
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.662e-06 S  per = 0.000729  per(accum) = 10.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 7.622e-05 S  per = 0.0209  per(accum) = 10.6
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.391e-04 S  per = 0.0381  per(accum) = 10.7
 T(sweep oper_env: reduction of opS & opH [comm]) = 8.317e-05 S  per = 0.0228  per(accum) = 10.7
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.255e-01 S  per = 89.1  per(accum) = 99.8
 T(sweep oper_env: after oper_renorm            ) = 6.799e-04 S  per = 0.186  per(accum) = 100

idx=3 coord=(2,0)
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=208:0.00159MB:1.55e-06GB
 rqops: oplist=CSHPQ nops=C:6 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=63,63 size(op)=399:0.00304MB size(tot)=13422:0.102MB:0.0001GB
ctns::oper_renorm coord=(2,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:8 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=32,32 size(op)=144:0.0011MB size(tot)=2720:0.0208MB:2.03e-05GB
CPUmem: VM:1.915e+01GB RSS:1.828e+00GB  Timing: User:5.886e+01S Sys:1.265e+00S Total:6.013e+01S
----- TIMING FOR symbolic_formulae_renorm with size=29 : 1.196e-03 S -----
rank=0 GPUmem(GB): used=0.000122 (oper)=0.000122
rank=0 GPUmem(GB): used=0.000128 (oper,site)(GB)=0.000122,5.95e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=29
 no. of rintermediate operators=58
 no. of coefficients=174:0.00133MB:1.3e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.003e-04 S -----
rank=0 GPUmem(GB): used=0.000129 (oper,site,rinter)=0.000122,5.95e-06,1.3e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00302 S size(rtasks)=29 size(Rlst2)=81 T(Rmu/Rlist)=0.00035,0.00267 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00328 S size(rtasks)=29 size(Rlst)=2450 -----
rank=0 GPUmem(GB): used=0.000129 (oper,site,rinter,batch)=0.000122,5.95e-06,1.3e-06,0.00413 blksize=72 blksize0=81 batchsize=2450
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.0002,0.00105,0.000219
--- TIMING FOR renorm : t_inter=2.0e-04 t_gemm=1.1e-03 t_reduction=2.2e-04 tot=1.5e-03 ---
 renorm[inter] counter=3 t=2.0e-04 per=1.4e+01 cost=1.8e+05 flops=9.2e+08
 renorm[gemm] counter=3 i=0 t=1.1e-04 per=7.2e+00 cost=3.6e+04 flops=3.4e+08
 renorm[gemm] counter=3 i=1 t=1.1e-04 per=7.3e+00 cost=5.6e+04 flops=5.2e+08
 renorm[gemm] counter=3 i=2 t=2.1e-04 per=1.5e+01 cost=2.7e+05 flops=1.3e+09
 renorm[gemm] counter=3 i=3 t=2.8e-04 per=1.9e+01 cost=4.3e+05 flops=1.6e+09
 renorm[gemm] counter=3 i=4 t=1.1e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=5 t=1.0e-06 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=6 t=3.5e-04 per=2.4e+01 cost=5.7e+05 flops=1.6e+09
 renorm[gemm] counter=3 total t=1.1e-03 per=7.2e+01 cost=1.4e+06 flops=1.3e+09
 renorm[red] counter=3 t=2.2e-04 per=1.5e+01 cost=8.0e+04 flops=3.7e+08
--- TIMING FOR renorm_tot : t_inter=3.3e-04 t_gemm=2.9e-03 t_reduction=5.8e-04 tot=3.8e-03 ---
 renorm_tot[inter] counter=3 t=3.3e-04 per=8.8e+00 cost=1.9e+05 flops=5.7e+08
 renorm_tot[gemm] counter=3 i=0 t=6.1e-04 per=1.6e+01 cost=7.4e+04 flops=1.2e+08
 renorm_tot[gemm] counter=3 i=1 t=3.1e-04 per=8.1e+00 cost=9.3e+04 flops=3.0e+08
 renorm_tot[gemm] counter=3 i=2 t=5.2e-04 per=1.4e+01 cost=3.5e+05 flops=6.8e+08
 renorm_tot[gemm] counter=3 i=3 t=6.5e-04 per=1.7e+01 cost=5.4e+05 flops=8.3e+08
 renorm_tot[gemm] counter=3 i=4 t=3.2e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=5 t=3.1e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=6 t=7.7e-04 per=2.0e+01 cost=1.2e+06 flops=1.5e+09
 renorm_tot[gemm] counter=3 total t=2.9e-03 per=7.6e+01 cost=2.2e+06 flops=7.8e+08
 renorm_tot[red] counter=3 t=5.8e-04 per=1.5e+01 cost=3.6e+05 flops=6.2e+08
qops.to_cpu: size(tot)=2720:2.1e-02MB:2.0e-05GB t[to_cpu]=2.0e-05S speed=1.0e+00GB/S
check ||H-H.dagger||=4.011e-15 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0237 S rank=0 -----
##### local oper_env: 2.537e-02 S #####
 T(local oper_env: fetch) = 1.192e-03 S  per =  4.7  per(accum) = 4.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 4.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 4.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 4.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 4.7
 T(local oper_env: renrm) = 2.399e-02 S  per = 94.6  per(accum) = 99.2
 T(local oper_env: save ) = 1.909e-04 S  per = 0.752  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.399e-02 S  T(sum) = 2.399e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.031e-04 S  per = 0.43  per(accum) = 0.43
 T(local oper_env: qops init                    ) = 7.486e-04 S  per = 3.12  per(accum) = 3.55
 T(local oper_env: symbolic_formulae_renorm     ) = 1.206e-03 S  per = 5.03  per(accum) = 8.57
 T(local oper_env: allocate qops on gpu         ) = 2.572e-05 S  per = 0.107  per(accum) = 8.68
 T(local oper_env: site memcpy cpu2gpu          ) = 4.264e-05 S  per = 0.178  per(accum) = 8.86
 T(local oper_env: rintermediate init           ) = 1.097e-04 S  per = 0.457  per(accum) = 9.32
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.370e-03 S  per =   14  per(accum) = 23.4
 T(local oper_env: rmmtasks init                ) = 1.647e-02 S  per = 68.7  per(accum) = 92
 T(local oper_env: qops memset on cpu           ) = 4.200e-08 S  per = 0.000175  per(accum) = 92
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.571e-03 S  per = 6.55  per(accum) = 98.6
 T(local oper_env: reduction of opS & opH [nccl]) = 1.055e-06 S  per = 0.0044  per(accum) = 98.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.591e-05 S  per = 0.108  per(accum) = 98.7
 T(local oper_env: deallocate cpu and gpu memory) = 9.974e-05 S  per = 0.416  per(accum) = 99.1
 T(local oper_env: reduction of opS & opH [comm]) = 4.851e-05 S  per = 0.202  per(accum) = 99.3
 T(local oper_env: conversion from opAB to opPQ ) = 1.364e-05 S  per = 0.0569  per(accum) = 99.4
 T(local oper_env: after oper_renorm            ) = 1.527e-04 S  per = 0.637  per(accum) = 100
##### sweep oper_env: 3.946e-01 S #####
 T(sweep oper_env: fetch) = 3.884e-03 S  per = 0.984  per(accum) = 0.984
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 0.984
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 0.984
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 0.984
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 0.984
 T(sweep oper_env: renrm) = 3.892e-01 S  per = 98.6  per(accum) = 99.6
 T(sweep oper_env: save ) = 1.457e-03 S  per = 0.369  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -5.196e+09 S  per = -5.196e+31
 T(sweep oper_env: preprocess                  ) = -5.196e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.892e-01 S  T(sum) = 3.892e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.234e-04 S  per = 0.0317  per(accum) = 0.0317
 T(sweep oper_env: qops init                    ) = 2.379e-03 S  per = 0.611  per(accum) = 0.643
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.081e-03 S  per = 0.792  per(accum) = 1.43
 T(sweep oper_env: allocate qops on gpu         ) = 1.078e-04 S  per = 0.0277  per(accum) = 1.46
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.060e-04 S  per = 0.0272  per(accum) = 1.49
 T(sweep oper_env: rintermediate init           ) = 2.179e-04 S  per = 0.056  per(accum) = 1.55
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 9.053e-03 S  per = 2.33  per(accum) = 3.87
 T(sweep oper_env: rmmtasks init                ) = 4.330e-02 S  per = 11.1  per(accum) = 15
 T(sweep oper_env: qops memset on cpu           ) = 1.720e-07 S  per = 4.42e-05  per(accum) = 15
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.085e-03 S  per = 1.05  per(accum) = 16
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.717e-06 S  per = 0.000955  per(accum) = 16
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.021e-04 S  per = 0.0262  per(accum) = 16.1
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.388e-04 S  per = 0.0614  per(accum) = 16.1
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.317e-04 S  per = 0.0338  per(accum) = 16.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.255e-01 S  per = 83.6  per(accum) = 99.8
 T(sweep oper_env: after oper_renorm            ) = 8.326e-04 S  per = 0.214  per(accum) = 100

idx=4 coord=(1,0)
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=208:0.00159MB:1.55e-06GB
 rqops: oplist=CSHPQ nops=C:8 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=32,32 size(op)=144:0.0011MB size(tot)=2720:0.0208MB:2.03e-05GB
ctns::oper_renorm coord=(1,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:10 S:2 H:1 P:1 Q:3 
        dim(bra,ket)=8,8 size(op)=16:0.000122MB size(tot)=152:0.00116MB:1.13e-06GB
CPUmem: VM:1.915e+01GB RSS:1.828e+00GB  Timing: User:5.891e+01S Sys:1.267e+00S Total:6.018e+01S
----- TIMING FOR symbolic_formulae_renorm with size=17 : 4.968e-04 S -----
rank=0 GPUmem(GB): used=2.29e-05 (oper)=2.29e-05
rank=0 GPUmem(GB): used=2.4e-05 (oper,site)(GB)=2.29e-05,1.07e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=17
 no. of rintermediate operators=20
 no. of coefficients=80:0.00061MB:5.96e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.557e-05 S -----
rank=0 GPUmem(GB): used=2.46e-05 (oper,site,rinter)=2.29e-05,1.07e-06,5.96e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000772 S size(rtasks)=17 size(Rlst2)=16 T(Rmu/Rlist)=0.000145,0.000627 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000835 S size(rtasks)=17 size(Rlst)=618 -----
rank=0 GPUmem(GB): used=2.46e-05 (oper,site,rinter,batch)=2.29e-05,1.07e-06,5.96e-07,0.000299 blksize=16 blksize0=32 batchsize=618
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.09e-05,0.000554,8.65e-05
--- TIMING FOR renorm : t_inter=8.0e-05 t_gemm=5.5e-04 t_reduction=8.6e-05 tot=7.2e-04 ---
 renorm[inter] counter=4 t=8.0e-05 per=1.1e+01 cost=1.9e+04 flops=2.4e+08
 renorm[gemm] counter=4 i=0 t=6.8e-05 per=9.5e+00 cost=3.6e+03 flops=5.3e+07
 renorm[gemm] counter=4 i=1 t=6.6e-05 per=9.2e+00 cost=5.0e+03 flops=7.5e+07
 renorm[gemm] counter=4 i=2 t=1.2e-04 per=1.6e+01 cost=1.8e+04 flops=1.6e+08
 renorm[gemm] counter=4 i=3 t=1.8e-04 per=2.5e+01 cost=2.8e+04 flops=1.6e+08
 renorm[gemm] counter=4 i=4 t=1.1e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=5 t=1.0e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=6 t=1.2e-04 per=1.7e+01 cost=2.3e+04 flops=1.9e+08
 renorm[gemm] counter=4 total t=5.5e-04 per=7.7e+01 cost=7.7e+04 flops=1.4e+08
 renorm[red] counter=4 t=8.6e-05 per=1.2e+01 cost=4.9e+03 flops=5.7e+07
--- TIMING FOR renorm_tot : t_inter=4.1e-04 t_gemm=3.4e-03 t_reduction=6.7e-04 tot=4.5e-03 ---
 renorm_tot[inter] counter=4 t=4.1e-04 per=9.1e+00 cost=2.1e+05 flops=5.1e+08
 renorm_tot[gemm] counter=4 i=0 t=6.8e-04 per=1.5e+01 cost=7.8e+04 flops=1.1e+08
 renorm_tot[gemm] counter=4 i=1 t=3.7e-04 per=8.3e+00 cost=9.8e+04 flops=2.6e+08
 renorm_tot[gemm] counter=4 i=2 t=6.4e-04 per=1.4e+01 cost=3.7e+05 flops=5.8e+08
 renorm_tot[gemm] counter=4 i=3 t=8.3e-04 per=1.8e+01 cost=5.7e+05 flops=6.8e+08
 renorm_tot[gemm] counter=4 i=4 t=4.3e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=5 t=4.1e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=6 t=8.9e-04 per=2.0e+01 cost=1.2e+06 flops=1.4e+09
 renorm_tot[gemm] counter=4 total t=3.4e-03 per=7.6e+01 cost=2.3e+06 flops=6.8e+08
 renorm_tot[red] counter=4 t=6.7e-04 per=1.5e+01 cost=3.7e+05 flops=5.5e+08
qops.to_cpu: size(tot)=152:1.2e-03MB:1.1e-06GB t[to_cpu]=1.4e-05S speed=8.3e-02GB/S
check ||H-H.dagger||=9.782e-16 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00617 S rank=0 -----
##### local oper_env: 7.304e-03 S #####
 T(local oper_env: fetch) = 9.008e-04 S  per = 12.3  per(accum) = 12.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 12.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 12.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 12.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 12.3
 T(local oper_env: renrm) = 6.259e-03 S  per = 85.7  per(accum) = 98
 T(local oper_env: save ) = 1.448e-04 S  per = 1.98  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.259e-03 S  T(sum) = 6.259e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.658e-06 S  per = 0.122  per(accum) = 0.122
 T(local oper_env: qops init                    ) = 1.859e-04 S  per = 2.97  per(accum) = 3.09
 T(local oper_env: symbolic_formulae_renorm     ) = 5.045e-04 S  per = 8.06  per(accum) = 11.2
 T(local oper_env: allocate qops on gpu         ) = 2.277e-05 S  per = 0.364  per(accum) = 11.5
 T(local oper_env: site memcpy cpu2gpu          ) = 2.494e-05 S  per = 0.399  per(accum) = 11.9
 T(local oper_env: rintermediate init           ) = 5.434e-05 S  per = 0.868  per(accum) = 12.8
 T(local oper_env: preprocess_formulae_Rlist2   ) = 8.579e-04 S  per = 13.7  per(accum) = 26.5
 T(local oper_env: rmmtasks init                ) = 3.638e-03 S  per = 58.1  per(accum) = 84.6
 T(local oper_env: qops memset on cpu           ) = 8.300e-08 S  per = 0.00133  per(accum) = 84.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 8.201e-04 S  per = 13.1  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [nccl]) = 1.027e-06 S  per = 0.0164  per(accum) = 97.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.931e-05 S  per = 0.308  per(accum) = 98
 T(local oper_env: deallocate cpu and gpu memory) = 1.739e-05 S  per = 0.278  per(accum) = 98.3
 T(local oper_env: reduction of opS & opH [comm]) = 1.983e-05 S  per = 0.317  per(accum) = 98.6
 T(local oper_env: conversion from opAB to opPQ ) = 3.515e-06 S  per = 0.0562  per(accum) = 98.7
 T(local oper_env: after oper_renorm            ) = 8.169e-05 S  per = 1.31  per(accum) = 100
##### sweep oper_env: 4.019e-01 S #####
 T(sweep oper_env: fetch) = 4.785e-03 S  per = 1.19  per(accum) = 1.19
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 1.19
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 1.19
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 1.19
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 1.19
 T(sweep oper_env: renrm) = 3.955e-01 S  per = 98.4  per(accum) = 99.6
 T(sweep oper_env: save ) = 1.602e-03 S  per = 0.399  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -6.928e+09 S  per = -6.928e+31
 T(sweep oper_env: preprocess                  ) = -6.928e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.955e-01 S  T(sum) = 3.955e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.311e-04 S  per = 0.0331  per(accum) = 0.0331
 T(sweep oper_env: qops init                    ) = 2.564e-03 S  per = 0.648  per(accum) = 0.682
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.586e-03 S  per = 0.907  per(accum) = 1.59
 T(sweep oper_env: allocate qops on gpu         ) = 1.306e-04 S  per = 0.033  per(accum) = 1.62
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.309e-04 S  per = 0.0331  per(accum) = 1.65
 T(sweep oper_env: rintermediate init           ) = 2.723e-04 S  per = 0.0688  per(accum) = 1.72
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 9.911e-03 S  per = 2.51  per(accum) = 4.23
 T(sweep oper_env: rmmtasks init                ) = 4.693e-02 S  per = 11.9  per(accum) = 16.1
 T(sweep oper_env: qops memset on cpu           ) = 2.550e-07 S  per = 6.45e-05  per(accum) = 16.1
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.905e-03 S  per = 1.24  per(accum) = 17.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.744e-06 S  per = 0.0012  per(accum) = 17.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.214e-04 S  per = 0.0307  per(accum) = 17.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.562e-04 S  per = 0.0648  per(accum) = 17.4
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.515e-04 S  per = 0.0383  per(accum) = 17.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.255e-01 S  per = 82.3  per(accum) = 99.8
 T(sweep oper_env: after oper_renorm            ) = 9.143e-04 S  per = 0.231  per(accum) = 100

idx=5 coord=(0,0)
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=208:0.00159MB:1.55e-06GB
 rqops: oplist=CSHPQ nops=C:10 S:2 H:1 P:1 Q:3 
        dim(bra,ket)=8,8 size(op)=16:0.000122MB size(tot)=152:0.00116MB:1.13e-06GB
ctns::oper_renorm coord=(0,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:12 S:0 H:1 P:0 Q:0 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=4:3.05e-05MB:2.98e-08GB
CPUmem: VM:1.915e+01GB RSS:1.828e+00GB  Timing: User:5.892e+01S Sys:1.268e+00S Total:6.019e+01S
----- TIMING FOR symbolic_formulae_renorm with size=13 : 1.723e-04 S -----
rank=0 GPUmem(GB): used=2.71e-06 (oper)=2.71e-06
rank=0 GPUmem(GB): used=2.83e-06 (oper,site)(GB)=2.71e-06,1.19e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=13
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=2.83e-06 (oper,site,rinter)=2.71e-06,1.19e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000154 S size(rtasks)=13 size(Rlst2)=1 T(Rmu/Rlist)=5.85e-05,9.54e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00017 S size(rtasks)=13 size(Rlst)=84 -----
rank=0 GPUmem(GB): used=2.83e-06 (oper,site,rinter,batch)=2.71e-06,1.19e-07,0,5.63e-06 blksize=4 blksize0=0 batchsize=84
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=6.75e-06,0.000293,5.18e-05
--- TIMING FOR renorm : t_inter=6.6e-06 t_gemm=2.9e-04 t_reduction=5.2e-05 tot=3.5e-04 ---
 renorm[inter] counter=5 t=6.6e-06 per=1.9e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=0 t=6.7e-05 per=1.9e+01 cost=3.0e+02 flops=4.6e+06
 renorm[gemm] counter=5 i=1 t=5.3e-05 per=1.5e+01 cost=3.0e+02 flops=5.7e+06
 renorm[gemm] counter=5 i=2 t=4.8e-05 per=1.4e+01 cost=6.1e+02 flops=1.3e+07
 renorm[gemm] counter=5 i=3 t=6.1e-05 per=1.7e+01 cost=6.1e+02 flops=9.9e+06
 renorm[gemm] counter=5 i=4 t=1.0e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=5 t=1.0e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=6 t=6.1e-05 per=1.7e+01 cost=1.3e+03 flops=2.2e+07
 renorm[gemm] counter=5 total t=2.9e-04 per=8.3e+01 cost=3.2e+03 flops=1.1e+07
 renorm[red] counter=5 t=5.2e-05 per=1.5e+01 cost=6.7e+02 flops=1.3e+07
--- TIMING FOR renorm_tot : t_inter=4.2e-04 t_gemm=3.7e-03 t_reduction=7.2e-04 tot=4.9e-03 ---
 renorm_tot[inter] counter=5 t=4.2e-04 per=8.6e+00 cost=2.1e+05 flops=5.0e+08
 renorm_tot[gemm] counter=5 i=0 t=7.5e-04 per=1.5e+01 cost=7.8e+04 flops=1.0e+08
 renorm_tot[gemm] counter=5 i=1 t=4.3e-04 per=8.8e+00 cost=9.8e+04 flops=2.3e+08
 renorm_tot[gemm] counter=5 i=2 t=6.8e-04 per=1.4e+01 cost=3.7e+05 flops=5.4e+08
 renorm_tot[gemm] counter=5 i=3 t=8.9e-04 per=1.8e+01 cost=5.7e+05 flops=6.4e+08
 renorm_tot[gemm] counter=5 i=4 t=5.3e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=5 t=5.1e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=6 t=9.5e-04 per=2.0e+01 cost=1.2e+06 flops=1.3e+09
 renorm_tot[gemm] counter=5 total t=3.7e-03 per=7.7e+01 cost=2.3e+06 flops=6.3e+08
 renorm_tot[red] counter=5 t=7.2e-04 per=1.5e+01 cost=3.7e+05 flops=5.1e+08
qops.to_cpu: size(tot)=4:3.1e-05MB:3.0e-08GB t[to_cpu]=1.3e-05S speed=2.4e-03GB/S
check ||H-H.dagger||=5.495e-16 coord=(0,0) rank=0
ctns::oper_ab2pq coord=(0,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00158 S rank=0 -----
##### local oper_env: 2.649e-03 S #####
 T(local oper_env: fetch) = 8.894e-04 S  per = 33.6  per(accum) = 33.6
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 33.6
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 33.6
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 33.6
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 33.6
 T(local oper_env: renrm) = 1.631e-03 S  per = 61.6  per(accum) = 95.1
 T(local oper_env: save ) = 1.287e-04 S  per = 4.86  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.631e-03 S  T(sum) = 1.631e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.744e-06 S  per = 0.475  per(accum) = 0.475
 T(local oper_env: qops init                    ) = 1.336e-04 S  per =  8.2  per(accum) = 8.67
 T(local oper_env: symbolic_formulae_renorm     ) = 1.795e-04 S  per =   11  per(accum) = 19.7
 T(local oper_env: allocate qops on gpu         ) = 2.275e-05 S  per =  1.4  per(accum) = 21.1
 T(local oper_env: site memcpy cpu2gpu          ) = 1.641e-05 S  per = 1.01  per(accum) = 22.1
 T(local oper_env: rintermediate init           ) = 1.456e-05 S  per = 0.893  per(accum) = 23
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.764e-04 S  per = 10.8  per(accum) = 33.8
 T(local oper_env: rmmtasks init                ) = 5.449e-04 S  per = 33.4  per(accum) = 67.2
 T(local oper_env: qops memset on cpu           ) = 4.300e-08 S  per = 0.00264  per(accum) = 67.2
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.426e-04 S  per = 27.1  per(accum) = 94.4
 T(local oper_env: reduction of opS & opH [nccl]) = 9.020e-07 S  per = 0.0553  per(accum) = 94.4
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.799e-05 S  per =  1.1  per(accum) = 95.5
 T(local oper_env: deallocate cpu and gpu memory) = 1.060e-05 S  per = 0.65  per(accum) = 96.2
 T(local oper_env: reduction of opS & opH [comm]) = 1.637e-05 S  per =    1  per(accum) = 97.2
 T(local oper_env: conversion from opAB to opPQ ) = 3.433e-06 S  per = 0.211  per(accum) = 97.4
 T(local oper_env: after oper_renorm            ) = 4.264e-05 S  per = 2.62  per(accum) = 100
##### sweep oper_env: 4.045e-01 S #####
 T(sweep oper_env: fetch) = 5.674e-03 S  per =  1.4  per(accum) = 1.4
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 1.4
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 1.4
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 1.4
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 1.4
 T(sweep oper_env: renrm) = 3.971e-01 S  per = 98.2  per(accum) = 99.6
 T(sweep oper_env: save ) = 1.731e-03 S  per = 0.428  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -8.660e+09 S  per = -8.660e+31
 T(sweep oper_env: preprocess                  ) = -8.660e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.971e-01 S  T(sum) = 3.971e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.388e-04 S  per = 0.035  per(accum) = 0.035
 T(sweep oper_env: qops init                    ) = 2.698e-03 S  per = 0.679  per(accum) = 0.714
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.765e-03 S  per = 0.948  per(accum) = 1.66
 T(sweep oper_env: allocate qops on gpu         ) = 1.533e-04 S  per = 0.0386  per(accum) = 1.7
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.473e-04 S  per = 0.0371  per(accum) = 1.74
 T(sweep oper_env: rintermediate init           ) = 2.868e-04 S  per = 0.0722  per(accum) = 1.81
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.009e-02 S  per = 2.54  per(accum) = 4.35
 T(sweep oper_env: rmmtasks init                ) = 4.748e-02 S  per =   12  per(accum) = 16.3
 T(sweep oper_env: qops memset on cpu           ) = 2.980e-07 S  per = 7.5e-05  per(accum) = 16.3
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.347e-03 S  per = 1.35  per(accum) = 17.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.646e-06 S  per = 0.00142  per(accum) = 17.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.394e-04 S  per = 0.0351  per(accum) = 17.7
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.668e-04 S  per = 0.0672  per(accum) = 17.8
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.679e-04 S  per = 0.0423  per(accum) = 17.8
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.255e-01 S  per =   82  per(accum) = 99.8
 T(sweep oper_env: after oper_renorm            ) = 9.569e-04 S  per = 0.241  per(accum) = 100
----- TIMING FOR ctns::oper_env_right : 4.137e-01 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.00766,0.00567,0.397,0.00173,0.412
ctns::oper_load iomode=0 fname=./scratch/sweep/rop(0,0)
fname=./scratch/sweep/rop(0,0) size=2.98e-08GB T[load](info/setup/data/tot)=7.49e-05,7.25e-05,1.06e-05,0.000158 speed=0.000189GB/S
matrix: Hij size=(2,2)
     -3.236066267492e+00       6.849339926534e-16 
      2.963559340346e-16      -3.062519311638e+00 
matrix: Sij size=(2,2)
      1.000000000000e+00      -4.125974168792e-16 
     -4.142991085583e-16       1.000000000000e+00 

ctns::sweep_opt maxsweep=2

ctns::oper_init_dotL isym=2 ifkr=0 singlet=0
ctns::oper_save iomode=0 fname=./scratch/sweep/lop(0,0) size=0.0015869140625MB:1.54972076416e-06GB
fname=./scratch/sweep/lop(0,0) size=1.55e-06GB T[save](info/data/tot)=0.000146,7.51e-05,0.000221 speed=0.00701GB/S disk[used]=0.000142GB
----- TIMING FOR ctns::oper_init_dotL : 1.163e-03 S -----

ctns::topology::get_sweeps ifboundary=0
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(3,0)-(4,0) forward=1 cturn=0
 ibond=3 bond=(3,0)-(4,0) forward=0 cturn=0
 ibond=4 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=5 bond=(1,0)-(2,0) forward=0 cturn=0
..... end of get_sweeps .....

======================================================================
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=1 sym_state=(6,0) singlet=0
qtensor3: site0new own=1 _data=0x4c2435b0
qinfo3: site0new sym=(0,0) dir=1,0,1
 qbond: qrow nsym=1 dimAll=1
 (0,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=4 nblocks=16 size=4:3.05e-05MB
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:0.00032MB:3.13e-07GB
 sites: len=6 mem=1385:0.0106MB:1.03e-05GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=1 mem=72:0.000549MB:5.36e-07GB
total mem of comb=1503:0.0115MB:1.12e-05GB

isweep=0 ibond=0/seqsize=6 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.915e+01GB RSS:1.828e+00GB  Timing: User:5.893e+01S Sys:1.268e+00S Total:6.019e+01S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=1385:1.057e-02MB:1.032e-05GB
 rwfuns: len=2 mem=4:3.052e-05MB:2.980e-08GB
 cpsi: len=1 mem=72:5.493e-04MB:5.364e-07GB
total mem of comb=1503:1.147e-02MB:1.120e-05GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,3,1,1
 suppl= 0
 suppr= 3 4 5
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 rqops: oplist=CSHPQ nops=C:6 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=63,63 size(op)=399:3.044e-03MB size(tot)=13422:1.024e-01MB:1.000e-04GB
 c1qops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 c2qops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 qops(tot)=14046:1.072e-01MB:1.047e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
wf4(diml,dimr,dimc1,dimc2)=(4,63,4,4) nnz=399:3.044e-03MB
qtensor4: wf4 own=1 _data=0x4f556ab0
qinfo4: wf4 sym=(6,0)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=15 dimAll=63
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (3,3):1 (3,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=63 nblocks=960 size=399:3.044e-03MB
### DIAG TIMING: total=6.442e-04 t1=9.887e-06, t2=1.518e-05, t3=1.084e-04, t4=4.569e-04, t5=3.729e-05, t6=1.301e-05, t7=3.488e-06
duration_diagGPU:6.611e-04
duration_diagreduce:4.300e-08
duration_diagtransform:2.778e-06
----- TIMING FOR symbolic_formulae_twodot with size=210 : 1.844e-03 S -----
rank=0 GPUmem(GB): used=0.000105 (oper)=0.000105
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=210
 no. of hintermediate operators=58
 no. of coefficients=174:0.00133MB:1.3e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.083e-05 S -----
rank=0 GPUmem(GB): used=0.000106 (oper,hinter)=0.000105,1.3e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0105 S size(H_formulae)=210 size(Hxlst2)=63 T(Hmu/Hxlist)=0.000463,0.01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0116 S size(H_formulae)=210 size(Hxlst)=8750 -----
rank=0 GPUmem(GB): used=0.00663 (oper,hinter,dvdson,batch)=0.000105,1.3e-06,5.95e-06,0.00652 blksize=9 blksize0=81 batchsize=8750
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=399 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.29e-05,0.000146,0.00112,0.000195,0.0015
 ndim=399:2.97e-06GB t[comm(intra)]=2.29e-05 speed=0.259GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=1.1e-03 t_reduction=2.0e-04 tot=1.5e-03 ---
 sigma[inter] counter=1 t=1.5e-04 per=1.0e+01 cost=5.7e+05 flops=3.9e+09
 sigma[gemm] counter=1 i=0 t=1.2e-04 per=8.5e+00 cost=3.1e+04 flops=2.5e+08
 sigma[gemm] counter=1 i=1 t=1.2e-04 per=8.2e+00 cost=3.1e+04 flops=2.6e+08
 sigma[gemm] counter=1 i=2 t=1.3e-04 per=8.7e+00 cost=3.5e+04 flops=2.8e+08
 sigma[gemm] counter=1 i=3 t=1.5e-04 per=1.0e+01 cost=3.5e+04 flops=2.4e+08
 sigma[gemm] counter=1 i=4 t=1.8e-04 per=1.3e+01 cost=3.1e+05 flops=1.7e+09
 sigma[gemm] counter=1 i=5 t=1.8e-04 per=1.2e+01 cost=3.1e+05 flops=1.8e+09
 sigma[gemm] counter=1 i=6 t=1.2e-04 per=8.3e+00 cost=3.5e+04 flops=2.9e+08
 sigma[gemm] counter=1 i=7 t=1.2e-04 per=8.2e+00 cost=3.5e+04 flops=2.9e+08
 sigma[gemm] counter=1 total t=1.1e-03 per=7.7e+01 cost=8.2e+05 flops=7.3e+08
 sigma[red] counter=1 t=2.0e-04 per=1.3e+01 cost=1.2e+05 flops=5.9e+08
--- TIMING FOR sigma_tot : t_inter=1.5e-04 t_gemm=1.1e-03 t_reduction=2.0e-04 tot=1.5e-03 ---
 sigma_tot[inter] counter=1 t=1.5e-04 per=1.0e+01 cost=5.7e+05 flops=3.9e+09
 sigma_tot[gemm] counter=1 i=0 t=1.2e-04 per=8.5e+00 cost=3.1e+04 flops=2.5e+08
 sigma_tot[gemm] counter=1 i=1 t=1.2e-04 per=8.2e+00 cost=3.1e+04 flops=2.6e+08
 sigma_tot[gemm] counter=1 i=2 t=1.3e-04 per=8.7e+00 cost=3.5e+04 flops=2.8e+08
 sigma_tot[gemm] counter=1 i=3 t=1.5e-04 per=1.0e+01 cost=3.5e+04 flops=2.4e+08
 sigma_tot[gemm] counter=1 i=4 t=1.8e-04 per=1.3e+01 cost=3.1e+05 flops=1.7e+09
 sigma_tot[gemm] counter=1 i=5 t=1.8e-04 per=1.2e+01 cost=3.1e+05 flops=1.8e+09
 sigma_tot[gemm] counter=1 i=6 t=1.2e-04 per=8.3e+00 cost=3.5e+04 flops=2.9e+08
 sigma_tot[gemm] counter=1 i=7 t=1.2e-04 per=8.2e+00 cost=3.5e+04 flops=2.9e+08
 sigma_tot[gemm] counter=1 total t=1.1e-03 per=7.7e+01 cost=8.2e+05 flops=7.3e+08
 sigma_tot[red] counter=1 t=2.0e-04 per=1.3e+01 cost=1.2e+05 flops=5.9e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=2.3e-06,1.5e-05,3.8e-06,9.6e-07,2.6e-07
settings: ndim=399 neig=1 maxcycle=30 nbuff=4 memory=4e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +      -3.236066267492 -1.003e+03  9.781e-05    1     1  1.679e-03 1.679e-03 1.634e-03
TIMING FOR Davidson : 1.712e-03  T(cal/comm/rest)=1.634e-03,1.100e-07,7.812e-05
decomposed t_rest=7.812e-05
 T(sub)    =2.275e-05 per=2.912e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =3.690e-07 per=4.723e-01
 T(xnrm2)  =5.380e-07 per=6.887e-01
 T(other)  =5.446e-05 per=6.971e+01
optimized energies: isweep=0 ibond=0 dots=2 e[0]=-3.236066267492 nmvp=1
CPUmem: VM:1.915e+01GB RSS:1.833e+00GB  Timing: User:5.901e+01S Sys:1.270e+00S Total:6.028e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=10 nqr=9 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond0.txt
 qbond: qsuper nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
timing for divide=1.4e-05
timing for compute=1.8e-04
timing for collect=1.2e-05
----- TMING FOR decimation_genbasis(nkr): 2.1e-04 S T(divide/compute/collect)=1.4e-05,1.8e-04,1.2e-05 -----
decimation summary: 16->10 dwt=+1.029e-03 SvN=8.313e-01
 qbond: qkept nsym=8 dimAll=10
 (2,0):3 (1,1):1 (1,-1):1 (4,0):1 (3,1):1 (3,-1):1 (2,2):1 (2,-2):1
----- TIMING for decimation_row(nkr): 5.093e-04 S T(decim/select/formRot)=2.514e-04,2.347e-04,2.328e-05 -----
----- TIMING FOR twodot_decimation: 7.732e-04 S T(wf/decim)=2.525e-04,5.207e-04 -----
ctns::oper_renorm coord=(1,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:4 S:8 H:1 A:6 B:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
CPUmem: VM:1.915e+01GB RSS:1.833e+00GB  Timing: User:5.901e+01S Sys:1.271e+00S Total:6.028e+01S
----- TIMING FOR symbolic_formulae_renorm with size=29 : 5.480e-04 S -----
rank=0 GPUmem(GB): used=8e-06 (oper)=5.16e-06
rank=0 GPUmem(GB): used=8.17e-06 (oper,site)(GB)=5.16e-06,1.71e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=29
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=8.17e-06 (oper,site,rinter)=5.16e-06,1.71e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000855 S size(rtasks)=29 size(Rlst2)=64 T(Rmu/Rlist)=0.000182,0.000674 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000922 S size(rtasks)=29 size(Rlst)=630 -----
rank=0 GPUmem(GB): used=8.17e-06 (oper,site,rinter,batch)=5.16e-06,1.71e-07,0,8.92e-05 blksize=9 blksize0=0 batchsize=630
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.89e-06,0.000335,0.000126
--- TIMING FOR renorm : t_inter=7.6e-06 t_gemm=3.3e-04 t_reduction=1.3e-04 tot=4.7e-04 ---
 renorm[inter] counter=1 t=7.6e-06 per=1.6e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=7.7e-05 per=1.6e+01 cost=6.1e+02 flops=7.9e+06
 renorm[gemm] counter=1 i=1 t=6.1e-05 per=1.3e+01 cost=1.0e+03 flops=1.7e+07
 renorm[gemm] counter=1 i=2 t=1.1e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=3 t=9.6e-07 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=4 t=5.9e-05 per=1.3e+01 cost=9.3e+02 flops=1.6e+07
 renorm[gemm] counter=1 i=5 t=5.5e-05 per=1.2e+01 cost=7.0e+02 flops=1.3e+07
 renorm[gemm] counter=1 i=6 t=8.1e-05 per=1.7e+01 cost=3.4e+03 flops=4.2e+07
 renorm[gemm] counter=1 total t=3.3e-04 per=7.1e+01 cost=6.7e+03 flops=2.0e+07
 renorm[red] counter=1 t=1.3e-04 per=2.7e+01 cost=3.4e+03 flops=2.7e+07
--- TIMING FOR renorm_tot : t_inter=7.6e-06 t_gemm=3.3e-04 t_reduction=1.3e-04 tot=4.7e-04 ---
 renorm_tot[inter] counter=1 t=7.6e-06 per=1.6e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=7.7e-05 per=1.6e+01 cost=6.1e+02 flops=7.9e+06
 renorm_tot[gemm] counter=1 i=1 t=6.1e-05 per=1.3e+01 cost=1.0e+03 flops=1.7e+07
 renorm_tot[gemm] counter=1 i=2 t=1.1e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=3 t=9.6e-07 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=4 t=5.9e-05 per=1.3e+01 cost=9.3e+02 flops=1.6e+07
 renorm_tot[gemm] counter=1 i=5 t=5.5e-05 per=1.2e+01 cost=7.0e+02 flops=1.3e+07
 renorm_tot[gemm] counter=1 i=6 t=8.1e-05 per=1.7e+01 cost=3.4e+03 flops=4.2e+07
 renorm_tot[gemm] counter=1 total t=3.3e-04 per=7.1e+01 cost=6.7e+03 flops=2.0e+07
 renorm_tot[red] counter=1 t=1.3e-04 per=2.7e+01 cost=3.4e+03 flops=2.7e+07
qops.to_cpu: size(tot)=276:2.1e-03MB:2.1e-06GB t[to_cpu]=1.4e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=2.858e-16 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=lc ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 0.144 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.000763,7.45e-06,0.0464,0.0964,3.76e-05,3.88e-05 -----
----- TIMING FOR oper_renorm : 0.00617 S rank=0 -----
CPUmem: VM:1.915e+01GB RSS:1.833e+00GB  Timing: User:7.484e+01S Sys:1.272e+00S Total:7.611e+01S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=1264:9.644e-03MB:9.418e-06GB
 rwfuns: len=2 mem=4:3.052e-05MB:2.980e-08GB
 cpsi: len=1 mem=252:1.923e-03MB:1.878e-06GB
total mem of comb=1562:1.192e-02MB:1.164e-05GB
CPUmem: VM:1.922e+01GB RSS:1.833e+00GB  Timing: User:7.487e+01S Sys:1.274e+00S Total:7.614e+01S
##### local opt: 2.348e-01 S #####
 T(local opt: fetch) = 3.452e-03 S  per = 1.47  per(accum) = 1.47
 T(local opt: hdiag) = 7.855e-04 S  per = 0.334  per(accum) = 1.8
 T(local opt: dvdsn) = 7.893e-02 S  per = 33.6  per(accum) = 35.4
 T(local opt: decim) = 7.823e-04 S  per = 0.333  per(accum) = 35.7
 T(local opt: guess) = 4.097e-04 S  per = 0.174  per(accum) = 35.9
 T(local opt: renrm) = 1.502e-01 S  per =   64  per(accum) = 99.9
 T(local opt: save ) = 2.934e-04 S  per = 0.125  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.893e-02 S  T(sum) = 7.872e-02 S  per = 9.974e+01
 T(local opt: preprocess                  ) = 1.048e-03 S  per = 1.33  per(accum) = 1.33
 T(local opt: symbolic_formulae           ) = 1.857e-03 S  per = 2.36  per(accum) = 3.69
 T(local opt: hintermediate init          ) = 9.024e-05 S  per = 0.115  per(accum) = 3.8
 T(local opt: preprocess_hformulae_Hxlist ) = 1.190e-02 S  per = 15.1  per(accum) = 18.9
 T(local opt: hmmtasks init               ) = 6.182e-02 S  per = 78.5  per(accum) = 97.5
 T(local opt: initial guess for dvdson    ) = 2.876e-04 S  per = 0.365  per(accum) = 97.8
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.611e-03 S  per = 2.05  per(accum) = 99.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.292e-05 S  per = 0.0291  per(accum) = 99.9
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.100e-07 S  per = 0.00014  per(accum) = 99.9
 T(local opt: dvdson solver [rest part]   ) = 7.812e-05 S  per = 0.0992  per(accum) = 100
Detailed decomposition of T(renrm) = 1.502e-01 S  T(sum) = 1.502e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.617e-05 S  per = 0.0507  per(accum) = 0.0507
 T(local opt: qops init                    ) = 3.567e-04 S  per = 0.237  per(accum) = 0.288
 T(local opt: symbolic_formulae_renorm     ) = 5.556e-04 S  per = 0.37  per(accum) = 0.658
 T(local opt: allocate qops on gpu         ) = 1.960e-05 S  per = 0.013  per(accum) = 0.671
 T(local opt: site memcpy cpu2gpu          ) = 2.947e-05 S  per = 0.0196  per(accum) = 0.691
 T(local opt: rintermediate init           ) = 1.760e-05 S  per = 0.0117  per(accum) = 0.703
 T(local opt: preprocess_formulae_Rlist2   ) = 9.479e-04 S  per = 0.631  per(accum) = 1.33
 T(local opt: rmmtasks init                ) = 3.619e-03 S  per = 2.41  per(accum) = 3.74
 T(local opt: qops memset on cpu           ) = 8.900e-08 S  per = 5.93e-05  per(accum) = 3.74
 T(local opt: preprocess_renorm_batchGPU   ) = 5.693e-04 S  per = 0.379  per(accum) = 4.12
 T(local opt: reduction of opS & opH [nccl]) = 1.048e-06 S  per = 0.000698  per(accum) = 4.12
 T(local opt: qops memcpy gpu2cpu          ) = 2.075e-05 S  per = 0.0138  per(accum) = 4.14
 T(local opt: deallocate cpu and gpu memory) = 1.115e-05 S  per = 0.00742  per(accum) = 4.14
 T(local opt: reduction of opS & opH [comm]) = 2.444e-05 S  per = 0.0163  per(accum) = 4.16
 T(local opt: conversion from opAB to opPQ ) = 1.437e-01 S  per = 95.7  per(accum) = 99.8
 T(local opt: after oper_renorm            ) = 2.583e-04 S  per = 0.172  per(accum) = 100
##### sweep opt: 2.348e-01 S #####
 T(sweep opt: fetch) = 3.452e-03 S  per = 1.47  per(accum) = 1.47
 T(sweep opt: hdiag) = 7.855e-04 S  per = 0.334  per(accum) = 1.8
 T(sweep opt: dvdsn) = 7.893e-02 S  per = 33.6  per(accum) = 35.4
 T(sweep opt: decim) = 7.823e-04 S  per = 0.333  per(accum) = 35.7
 T(sweep opt: guess) = 4.097e-04 S  per = 0.174  per(accum) = 35.9
 T(sweep opt: renrm) = 1.502e-01 S  per =   64  per(accum) = 99.9
 T(sweep opt: save ) = 2.934e-04 S  per = 0.125  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.893e-02 S  T(sum) = 7.872e-02 S  per = 9.974e+01
 T(sweep opt: preprocess                  ) = 1.048e-03 S  per = 1.33  per(accum) = 1.33
 T(sweep opt: symbolic_formulae           ) = 1.857e-03 S  per = 2.36  per(accum) = 3.69
 T(sweep opt: hintermediate init          ) = 9.024e-05 S  per = 0.115  per(accum) = 3.8
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.190e-02 S  per = 15.1  per(accum) = 18.9
 T(sweep opt: hmmtasks init               ) = 6.182e-02 S  per = 78.5  per(accum) = 97.5
 T(sweep opt: initial guess for dvdson    ) = 2.876e-04 S  per = 0.365  per(accum) = 97.8
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.611e-03 S  per = 2.05  per(accum) = 99.9
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.292e-05 S  per = 0.0291  per(accum) = 99.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.100e-07 S  per = 0.00014  per(accum) = 99.9
 T(sweep opt: dvdson solver [rest part]   ) = 7.812e-05 S  per = 0.0992  per(accum) = 100
Detailed decomposition of T(renrm) = 1.502e-01 S  T(sum) = 1.502e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.617e-05 S  per = 0.0507  per(accum) = 0.0507
 T(sweep opt: qops init                    ) = 3.567e-04 S  per = 0.237  per(accum) = 0.288
 T(sweep opt: symbolic_formulae_renorm     ) = 5.556e-04 S  per = 0.37  per(accum) = 0.658
 T(sweep opt: allocate qops on gpu         ) = 1.960e-05 S  per = 0.013  per(accum) = 0.671
 T(sweep opt: site memcpy cpu2gpu          ) = 2.947e-05 S  per = 0.0196  per(accum) = 0.691
 T(sweep opt: rintermediate init           ) = 1.760e-05 S  per = 0.0117  per(accum) = 0.703
 T(sweep opt: preprocess_formulae_Rlist2   ) = 9.479e-04 S  per = 0.631  per(accum) = 1.33
 T(sweep opt: rmmtasks init                ) = 3.619e-03 S  per = 2.41  per(accum) = 3.74
 T(sweep opt: qops memset on cpu           ) = 8.900e-08 S  per = 5.93e-05  per(accum) = 3.74
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.693e-04 S  per = 0.379  per(accum) = 4.12
 T(sweep opt: reduction of opS & opH [nccl]) = 1.048e-06 S  per = 0.000698  per(accum) = 4.12
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.075e-05 S  per = 0.0138  per(accum) = 4.14
 T(sweep opt: deallocate cpu and gpu memory) = 1.115e-05 S  per = 0.00742  per(accum) = 4.14
 T(sweep opt: reduction of opS & opH [comm]) = 2.444e-05 S  per = 0.0163  per(accum) = 4.16
 T(sweep opt: conversion from opAB to opPQ ) = 1.437e-01 S  per = 95.7  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 2.583e-04 S  per = 0.172  per(accum) = 100
##### global opt: 2.348e-01 S #####
 T(global opt: fetch) = 3.452e-03 S  per = 1.47  per(accum) = 1.47
 T(global opt: hdiag) = 7.855e-04 S  per = 0.334  per(accum) = 1.8
 T(global opt: dvdsn) = 7.893e-02 S  per = 33.6  per(accum) = 35.4
 T(global opt: decim) = 7.823e-04 S  per = 0.333  per(accum) = 35.7
 T(global opt: guess) = 4.097e-04 S  per = 0.174  per(accum) = 35.9
 T(global opt: renrm) = 1.502e-01 S  per =   64  per(accum) = 99.9
 T(global opt: save ) = 2.934e-04 S  per = 0.125  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.893e-02 S  T(sum) = 7.872e-02 S  per = 9.974e+01
 T(global opt: preprocess                  ) = 1.048e-03 S  per = 1.33  per(accum) = 1.33
 T(global opt: symbolic_formulae           ) = 1.857e-03 S  per = 2.36  per(accum) = 3.69
 T(global opt: hintermediate init          ) = 9.024e-05 S  per = 0.115  per(accum) = 3.8
 T(global opt: preprocess_hformulae_Hxlist ) = 1.190e-02 S  per = 15.1  per(accum) = 18.9
 T(global opt: hmmtasks init               ) = 6.182e-02 S  per = 78.5  per(accum) = 97.5
 T(global opt: initial guess for dvdson    ) = 2.876e-04 S  per = 0.365  per(accum) = 97.8
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.611e-03 S  per = 2.05  per(accum) = 99.9
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.292e-05 S  per = 0.0291  per(accum) = 99.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.100e-07 S  per = 0.00014  per(accum) = 99.9
 T(global opt: dvdson solver [rest part]   ) = 7.812e-05 S  per = 0.0992  per(accum) = 100
Detailed decomposition of T(renrm) = 1.502e-01 S  T(sum) = 1.502e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.617e-05 S  per = 0.0507  per(accum) = 0.0507
 T(global opt: qops init                    ) = 3.567e-04 S  per = 0.237  per(accum) = 0.288
 T(global opt: symbolic_formulae_renorm     ) = 5.556e-04 S  per = 0.37  per(accum) = 0.658
 T(global opt: allocate qops on gpu         ) = 1.960e-05 S  per = 0.013  per(accum) = 0.671
 T(global opt: site memcpy cpu2gpu          ) = 2.947e-05 S  per = 0.0196  per(accum) = 0.691
 T(global opt: rintermediate init           ) = 1.760e-05 S  per = 0.0117  per(accum) = 0.703
 T(global opt: preprocess_formulae_Rlist2   ) = 9.479e-04 S  per = 0.631  per(accum) = 1.33
 T(global opt: rmmtasks init                ) = 3.619e-03 S  per = 2.41  per(accum) = 3.74
 T(global opt: qops memset on cpu           ) = 8.900e-08 S  per = 5.93e-05  per(accum) = 3.74
 T(global opt: preprocess_renorm_batchGPU   ) = 5.693e-04 S  per = 0.379  per(accum) = 4.12
 T(global opt: reduction of opS & opH [nccl]) = 1.048e-06 S  per = 0.000698  per(accum) = 4.12
 T(global opt: qops memcpy gpu2cpu          ) = 2.075e-05 S  per = 0.0138  per(accum) = 4.14
 T(global opt: deallocate cpu and gpu memory) = 1.115e-05 S  per = 0.00742  per(accum) = 4.14
 T(global opt: reduction of opS & opH [comm]) = 2.444e-05 S  per = 0.0163  per(accum) = 4.16
 T(global opt: conversion from opAB to opPQ ) = 1.437e-01 S  per = 95.7  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 2.583e-04 S  per = 0.172  per(accum) = 100

isweep=0 ibond=1/seqsize=6 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.922e+01GB RSS:1.833e+00GB  Timing: User:7.487e+01S Sys:1.274e+00S Total:7.615e+01S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=1264:9.644e-03MB:9.418e-06GB
 rwfuns: len=2 mem=4:3.052e-05MB:2.980e-08GB
 cpsi: len=1 mem=252:1.923e-03MB:1.878e-06GB
total mem of comb=1562:1.192e-02MB:1.164e-05GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,2,1,1
 suppl= 0 1
 suppr= 4 5
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:4 S:8 H:1 P:28 Q:36 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=676:5.157e-03MB:5.037e-06GB
 rqops: oplist=CSHAB nops=C:4 S:8 H:1 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:2.747e-04MB size(tot)=680:5.188e-03MB:5.066e-06GB
 c1qops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 c2qops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 qops(tot)=1772:1.352e-02MB:1.320e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
wf4(diml,dimr,dimc1,dimc2)=(10,16,4,4) nnz=252:1.923e-03MB
qtensor4: wf4 own=1 _data=0x4b5ff820
qinfo4: wf4 sym=(6,0)
 qbond: qrow nsym=8 dimAll=10
 (2,0):3 (1,1):1 (1,-1):1 (4,0):1 (3,1):1 (3,-1):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=91 nblocks=1152 size=252:1.923e-03MB
### DIAG TIMING: total=1.411e-03 t1=1.255e-05, t2=2.081e-05, t3=9.327e-05, t4=1.218e-03, t5=4.865e-05, t6=1.337e-05, t7=4.143e-06
duration_diagGPU:1.424e-03
duration_diagreduce:4.700e-08
duration_diagtransform:1.388e-06
----- TIMING FOR symbolic_formulae_twodot with size=396 : 3.411e-03 S -----
rank=0 GPUmem(GB): used=1.32e-05 (oper)=1.32e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=396
 no. of hintermediate operators=138
 no. of coefficients=276:0.00211MB:2.06e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.303e-04 S -----
rank=0 GPUmem(GB): used=1.53e-05 (oper,hinter)=1.32e-05,2.06e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0267 S size(H_formulae)=396 size(Hxlst2)=91 T(Hmu/Hxlist)=0.000976,0.0257 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0299 S size(H_formulae)=396 size(Hxlst)=23172 -----
rank=0 GPUmem(GB): used=0.00572 (oper,hinter,dvdson,batch)=1.32e-05,2.06e-06,3.76e-06,0.0057 blksize=12 blksize0=8 batchsize=23172
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=252 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.43e-05,0.000279,0.00345,0.000389,0.00415
 ndim=252:1.88e-06GB t[comm(intra)]=2.43e-05 speed=0.154GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=2.8e-04 t_gemm=3.4e-03 t_reduction=3.9e-04 tot=4.1e-03 ---
 sigma[inter] counter=2 t=2.8e-04 per=6.8e+00 cost=6.9e+04 flops=2.5e+08
 sigma[gemm] counter=2 i=0 t=2.7e-04 per=6.5e+00 cost=4.2e+04 flops=1.6e+08
 sigma[gemm] counter=2 i=1 t=2.3e-04 per=5.6e+00 cost=4.2e+04 flops=1.8e+08
 sigma[gemm] counter=2 i=2 t=2.2e-04 per=5.3e+00 cost=3.8e+04 flops=1.7e+08
 sigma[gemm] counter=2 i=3 t=2.2e-04 per=5.3e+00 cost=3.8e+04 flops=1.7e+08
 sigma[gemm] counter=2 i=4 t=1.4e-03 per=3.4e+01 cost=1.4e+05 flops=9.7e+07
 sigma[gemm] counter=2 i=5 t=4.2e-04 per=1.0e+01 cost=1.4e+05 flops=3.2e+08
 sigma[gemm] counter=2 i=6 t=3.3e-04 per=8.1e+00 cost=7.3e+04 flops=2.2e+08
 sigma[gemm] counter=2 i=7 t=3.6e-04 per=8.7e+00 cost=7.2e+04 flops=2.0e+08
 sigma[gemm] counter=2 total t=3.4e-03 per=8.4e+01 cost=5.8e+05 flops=1.7e+08
 sigma[red] counter=2 t=3.9e-04 per=9.5e+00 cost=1.5e+05 flops=3.7e+08
--- TIMING FOR sigma_tot : t_inter=4.2e-04 t_gemm=4.6e-03 t_reduction=5.8e-04 tot=5.6e-03 ---
 sigma_tot[inter] counter=2 t=4.2e-04 per=7.6e+00 cost=6.4e+05 flops=1.5e+09
 sigma_tot[gemm] counter=2 i=0 t=3.9e-04 per=7.0e+00 cost=7.3e+04 flops=1.9e+08
 sigma_tot[gemm] counter=2 i=1 t=3.5e-04 per=6.3e+00 cost=7.3e+04 flops=2.1e+08
 sigma_tot[gemm] counter=2 i=2 t=3.5e-04 per=6.2e+00 cost=7.3e+04 flops=2.1e+08
 sigma_tot[gemm] counter=2 i=3 t=3.6e-04 per=6.5e+00 cost=7.3e+04 flops=2.0e+08
 sigma_tot[gemm] counter=2 i=4 t=1.6e-03 per=2.8e+01 cost=4.5e+05 flops=2.8e+08
 sigma_tot[gemm] counter=2 i=5 t=5.9e-04 per=1.1e+01 cost=4.4e+05 flops=7.5e+08
 sigma_tot[gemm] counter=2 i=6 t=4.5e-04 per=8.2e+00 cost=1.1e+05 flops=2.4e+08
 sigma_tot[gemm] counter=2 i=7 t=4.8e-04 per=8.5e+00 cost=1.1e+05 flops=2.3e+08
 sigma_tot[gemm] counter=2 total t=4.6e-03 per=8.2e+01 cost=1.4e+06 flops=3.1e+08
 sigma_tot[red] counter=2 t=5.8e-04 per=1.0e+01 cost=2.6e+05 flops=4.5e+08
T(sub)=9.9e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,4.6e-06,1.9e-06,7.5e-07,2.1e-07
settings: ndim=252 neig=1 maxcycle=30 nbuff=4 memory=3e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.234203750538 -1.003e+03  1.155e-02    1     1  4.297e-03 4.297e-03 4.273e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.421e-05,3.993e-04,3.045e-03,3.383e-04,3.816e-03
 ndim=252:1.878e-06GB t[comm(intra)]=2.421e-05 speed=1.551e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=4.0e-04 t_gemm=3.0e-03 t_reduction=3.4e-04 tot=3.8e-03 ---
 sigma[inter] counter=3 t=4.0e-04 per=1.1e+01 cost=6.9e+04 flops=1.7e+08
 sigma[gemm] counter=3 i=0 t=3.4e-04 per=9.1e+00 cost=4.2e+04 flops=1.2e+08
 sigma[gemm] counter=3 i=1 t=3.0e-04 per=7.9e+00 cost=4.2e+04 flops=1.4e+08
 sigma[gemm] counter=3 i=2 t=2.8e-04 per=7.3e+00 cost=3.8e+04 flops=1.4e+08
 sigma[gemm] counter=3 i=3 t=3.0e-04 per=8.0e+00 cost=3.8e+04 flops=1.3e+08
 sigma[gemm] counter=3 i=4 t=4.7e-04 per=1.3e+01 cost=1.4e+05 flops=2.9e+08
 sigma[gemm] counter=3 i=5 t=5.1e-04 per=1.3e+01 cost=1.4e+05 flops=2.7e+08
 sigma[gemm] counter=3 i=6 t=4.1e-04 per=1.1e+01 cost=7.3e+04 flops=1.8e+08
 sigma[gemm] counter=3 i=7 t=4.3e-04 per=1.1e+01 cost=7.2e+04 flops=1.7e+08
 sigma[gemm] counter=3 total t=3.0e-03 per=8.0e+01 cost=5.8e+05 flops=1.9e+08
 sigma[red] counter=3 t=3.4e-04 per=8.9e+00 cost=1.5e+05 flops=4.3e+08
--- TIMING FOR sigma_tot : t_inter=8.2e-04 t_gemm=7.6e-03 t_reduction=9.2e-04 tot=9.4e-03 ---
 sigma_tot[inter] counter=3 t=8.2e-04 per=8.8e+00 cost=7.1e+05 flops=8.6e+08
 sigma_tot[gemm] counter=3 i=0 t=7.3e-04 per=7.9e+00 cost=1.2e+05 flops=1.6e+08
 sigma_tot[gemm] counter=3 i=1 t=6.5e-04 per=7.0e+00 cost=1.2e+05 flops=1.8e+08
 sigma_tot[gemm] counter=3 i=2 t=6.2e-04 per=6.7e+00 cost=1.1e+05 flops=1.8e+08
 sigma_tot[gemm] counter=3 i=3 t=6.6e-04 per=7.1e+00 cost=1.1e+05 flops=1.7e+08
 sigma_tot[gemm] counter=3 i=4 t=2.1e-03 per=2.2e+01 cost=5.8e+05 flops=2.8e+08
 sigma_tot[gemm] counter=3 i=5 t=1.1e-03 per=1.2e+01 cost=5.8e+05 flops=5.3e+08
 sigma_tot[gemm] counter=3 i=6 t=8.6e-04 per=9.2e+00 cost=1.8e+05 flops=2.1e+08
 sigma_tot[gemm] counter=3 i=7 t=9.1e-04 per=9.7e+00 cost=1.8e+05 flops=2.0e+08
 sigma_tot[gemm] counter=3 total t=7.6e-03 per=8.1e+01 cost=2.0e+06 flops=2.6e+08
 sigma_tot[red] counter=3 t=9.2e-04 per=9.9e+00 cost=4.1e+05 flops=4.4e+08
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=7.0e-06,1.5e-05,4.1e-06,1.6e-06,3.1e-07
    2   0 -      -3.234289885988 -8.614e-05  4.480e-03    2     2  1.316e-02 6.578e-03 4.129e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.428e-05,3.711e-04,3.026e-03,3.487e-04,3.777e-03
 ndim=252:1.878e-06GB t[comm(intra)]=2.428e-05 speed=1.546e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=3.7e-04 t_gemm=3.0e-03 t_reduction=3.5e-04 tot=3.7e-03 ---
 sigma[inter] counter=4 t=3.7e-04 per=9.9e+00 cost=6.9e+04 flops=1.9e+08
 sigma[gemm] counter=4 i=0 t=3.6e-04 per=9.7e+00 cost=4.2e+04 flops=1.2e+08
 sigma[gemm] counter=4 i=1 t=3.0e-04 per=7.9e+00 cost=4.2e+04 flops=1.4e+08
 sigma[gemm] counter=4 i=2 t=2.8e-04 per=7.4e+00 cost=3.8e+04 flops=1.4e+08
 sigma[gemm] counter=4 i=3 t=2.7e-04 per=7.3e+00 cost=3.8e+04 flops=1.4e+08
 sigma[gemm] counter=4 i=4 t=4.9e-04 per=1.3e+01 cost=1.4e+05 flops=2.8e+08
 sigma[gemm] counter=4 i=5 t=4.8e-04 per=1.3e+01 cost=1.4e+05 flops=2.8e+08
 sigma[gemm] counter=4 i=6 t=4.3e-04 per=1.2e+01 cost=7.3e+04 flops=1.7e+08
 sigma[gemm] counter=4 i=7 t=4.1e-04 per=1.1e+01 cost=7.2e+04 flops=1.8e+08
 sigma[gemm] counter=4 total t=3.0e-03 per=8.1e+01 cost=5.8e+05 flops=1.9e+08
 sigma[red] counter=4 t=3.5e-04 per=9.3e+00 cost=1.5e+05 flops=4.2e+08
--- TIMING FOR sigma_tot : t_inter=1.2e-03 t_gemm=1.1e-02 t_reduction=1.3e-03 tot=1.3e-02 ---
 sigma_tot[inter] counter=4 t=1.2e-03 per=9.1e+00 cost=7.8e+05 flops=6.5e+08
 sigma_tot[gemm] counter=4 i=0 t=1.1e-03 per=8.4e+00 cost=1.6e+05 flops=1.4e+08
 sigma_tot[gemm] counter=4 i=1 t=9.5e-04 per=7.2e+00 cost=1.6e+05 flops=1.7e+08
 sigma_tot[gemm] counter=4 i=2 t=9.0e-04 per=6.9e+00 cost=1.5e+05 flops=1.7e+08
 sigma_tot[gemm] counter=4 i=3 t=9.4e-04 per=7.2e+00 cost=1.5e+05 flops=1.6e+08
 sigma_tot[gemm] counter=4 i=4 t=2.6e-03 per=2.0e+01 cost=7.2e+05 flops=2.8e+08
 sigma_tot[gemm] counter=4 i=5 t=1.6e-03 per=1.2e+01 cost=7.1e+05 flops=4.5e+08
 sigma_tot[gemm] counter=4 i=6 t=1.3e-03 per=9.9e+00 cost=2.5e+05 flops=1.9e+08
 sigma_tot[gemm] counter=4 i=7 t=1.3e-03 per=1.0e+01 cost=2.5e+05 flops=1.9e+08
 sigma_tot[gemm] counter=4 total t=1.1e-02 per=8.1e+01 cost=2.6e+06 flops=2.4e+08
 sigma_tot[red] counter=4 t=1.3e-03 per=9.7e+00 cost=5.5e+05 flops=4.3e+08
T(sub)=4.6e-05 T(gemm/eig/ortho/gemm/axpy)=9.8e-06,1.9e-05,3.6e-06,1.4e-05,3.3e-07
    3   0 -      -3.234302904869 -1.302e-05  2.184e-03    3     3  2.283e-02 7.610e-03 4.069e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.380e-05,3.673e-04,3.006e-03,3.266e-04,3.730e-03
 ndim=252:1.878e-06GB t[comm(intra)]=2.380e-05 speed=1.577e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=3.7e-04 t_gemm=3.0e-03 t_reduction=3.3e-04 tot=3.7e-03 ---
 sigma[inter] counter=5 t=3.7e-04 per=9.9e+00 cost=6.9e+04 flops=1.9e+08
 sigma[gemm] counter=5 i=0 t=3.4e-04 per=9.3e+00 cost=4.2e+04 flops=1.2e+08
 sigma[gemm] counter=5 i=1 t=3.1e-04 per=8.5e+00 cost=4.2e+04 flops=1.4e+08
 sigma[gemm] counter=5 i=2 t=2.8e-04 per=7.5e+00 cost=3.8e+04 flops=1.4e+08
 sigma[gemm] counter=5 i=3 t=2.7e-04 per=7.4e+00 cost=3.8e+04 flops=1.4e+08
 sigma[gemm] counter=5 i=4 t=4.9e-04 per=1.3e+01 cost=1.4e+05 flops=2.8e+08
 sigma[gemm] counter=5 i=5 t=4.7e-04 per=1.3e+01 cost=1.4e+05 flops=2.8e+08
 sigma[gemm] counter=5 i=6 t=4.3e-04 per=1.2e+01 cost=7.3e+04 flops=1.7e+08
 sigma[gemm] counter=5 i=7 t=4.0e-04 per=1.1e+01 cost=7.2e+04 flops=1.8e+08
 sigma[gemm] counter=5 total t=3.0e-03 per=8.1e+01 cost=5.8e+05 flops=1.9e+08
 sigma[red] counter=5 t=3.3e-04 per=8.8e+00 cost=1.5e+05 flops=4.4e+08
--- TIMING FOR sigma_tot : t_inter=1.6e-03 t_gemm=1.4e-02 t_reduction=1.6e-03 tot=1.7e-02 ---
 sigma_tot[inter] counter=5 t=1.6e-03 per=9.3e+00 cost=8.4e+05 flops=5.4e+08
 sigma_tot[gemm] counter=5 i=0 t=1.4e-03 per=8.6e+00 cost=2.0e+05 flops=1.4e+08
 sigma_tot[gemm] counter=5 i=1 t=1.3e-03 per=7.5e+00 cost=2.0e+05 flops=1.6e+08
 sigma_tot[gemm] counter=5 i=2 t=1.2e-03 per=7.0e+00 cost=1.9e+05 flops=1.6e+08
 sigma_tot[gemm] counter=5 i=3 t=1.2e-03 per=7.2e+00 cost=1.9e+05 flops=1.5e+08
 sigma_tot[gemm] counter=5 i=4 t=3.0e-03 per=1.8e+01 cost=8.5e+05 flops=2.8e+08
 sigma_tot[gemm] counter=5 i=5 t=2.1e-03 per=1.2e+01 cost=8.5e+05 flops=4.1e+08
 sigma_tot[gemm] counter=5 i=6 t=1.7e-03 per=1.0e+01 cost=3.3e+05 flops=1.9e+08
 sigma_tot[gemm] counter=5 i=7 t=1.7e-03 per=1.0e+01 cost=3.2e+05 flops=1.9e+08
 sigma_tot[gemm] counter=5 total t=1.4e-02 per=8.1e+01 cost=3.1e+06 flops=2.3e+08
 sigma_tot[red] counter=5 t=1.6e-03 per=9.5e+00 cost=7.0e+05 flops=4.4e+08
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=6.1e-06,1.7e-05,3.5e-06,1.9e-06,2.5e-07
    4   0 -      -3.234305939021 -3.034e-06  9.803e-04    3     4  3.251e-02 8.128e-03 4.027e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.297e-05,3.824e-04,3.011e-03,3.285e-04,3.751e-03
 ndim=252:1.878e-06GB t[comm(intra)]=2.297e-05 speed=1.635e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=3.7e-04 t_gemm=3.0e-03 t_reduction=3.3e-04 tot=3.7e-03 ---
 sigma[inter] counter=6 t=3.7e-04 per=1.0e+01 cost=6.9e+04 flops=1.9e+08
 sigma[gemm] counter=6 i=0 t=3.4e-04 per=9.2e+00 cost=4.2e+04 flops=1.2e+08
 sigma[gemm] counter=6 i=1 t=3.0e-04 per=8.0e+00 cost=4.2e+04 flops=1.4e+08
 sigma[gemm] counter=6 i=2 t=3.0e-04 per=8.0e+00 cost=3.8e+04 flops=1.3e+08
 sigma[gemm] counter=6 i=3 t=2.8e-04 per=7.4e+00 cost=3.8e+04 flops=1.4e+08
 sigma[gemm] counter=6 i=4 t=4.7e-04 per=1.3e+01 cost=1.4e+05 flops=2.9e+08
 sigma[gemm] counter=6 i=5 t=5.0e-04 per=1.3e+01 cost=1.4e+05 flops=2.7e+08
 sigma[gemm] counter=6 i=6 t=4.0e-04 per=1.1e+01 cost=7.3e+04 flops=1.8e+08
 sigma[gemm] counter=6 i=7 t=4.2e-04 per=1.1e+01 cost=7.2e+04 flops=1.7e+08
 sigma[gemm] counter=6 total t=3.0e-03 per=8.1e+01 cost=5.8e+05 flops=1.9e+08
 sigma[red] counter=6 t=3.3e-04 per=8.8e+00 cost=1.5e+05 flops=4.4e+08
--- TIMING FOR sigma_tot : t_inter=1.9e-03 t_gemm=1.7e-02 t_reduction=1.9e-03 tot=2.1e-02 ---
 sigma_tot[inter] counter=6 t=1.9e-03 per=9.4e+00 cost=9.1e+05 flops=4.7e+08
 sigma_tot[gemm] counter=6 i=0 t=1.8e-03 per=8.7e+00 cost=2.4e+05 flops=1.4e+08
 sigma_tot[gemm] counter=6 i=1 t=1.6e-03 per=7.6e+00 cost=2.4e+05 flops=1.6e+08
 sigma_tot[gemm] counter=6 i=2 t=1.5e-03 per=7.2e+00 cost=2.2e+05 flops=1.5e+08
 sigma_tot[gemm] counter=6 i=3 t=1.5e-03 per=7.3e+00 cost=2.2e+05 flops=1.5e+08
 sigma_tot[gemm] counter=6 i=4 t=3.5e-03 per=1.7e+01 cost=9.9e+05 flops=2.8e+08
 sigma_tot[gemm] counter=6 i=5 t=2.6e-03 per=1.2e+01 cost=9.8e+05 flops=3.9e+08
 sigma_tot[gemm] counter=6 i=6 t=2.1e-03 per=1.0e+01 cost=4.0e+05 flops=1.9e+08
 sigma_tot[gemm] counter=6 i=7 t=2.1e-03 per=1.0e+01 cost=4.0e+05 flops=1.9e+08
 sigma_tot[gemm] counter=6 total t=1.7e-02 per=8.1e+01 cost=3.7e+06 flops=2.2e+08
 sigma_tot[red] counter=6 t=1.9e-03 per=9.4e+00 cost=8.4e+05 flops=4.4e+08
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.9e-06,1.7e-05,3.5e-06,1.8e-06,2.4e-07
    5   0 -      -3.234306500919 -5.619e-07  4.906e-04    3     5  4.222e-02 8.444e-03 4.006e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.360e-05,3.680e-04,2.990e-03,3.420e-04,3.730e-03
 ndim=252:1.878e-06GB t[comm(intra)]=2.360e-05 speed=1.591e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=3.7e-04 t_gemm=3.0e-03 t_reduction=3.4e-04 tot=3.7e-03 ---
 sigma[inter] counter=7 t=3.7e-04 per=9.9e+00 cost=6.9e+04 flops=1.9e+08
 sigma[gemm] counter=7 i=0 t=3.6e-04 per=9.9e+00 cost=4.2e+04 flops=1.2e+08
 sigma[gemm] counter=7 i=1 t=3.0e-04 per=8.0e+00 cost=4.2e+04 flops=1.4e+08
 sigma[gemm] counter=7 i=2 t=2.8e-04 per=7.5e+00 cost=3.8e+04 flops=1.4e+08
 sigma[gemm] counter=7 i=3 t=2.7e-04 per=7.4e+00 cost=3.8e+04 flops=1.4e+08
 sigma[gemm] counter=7 i=4 t=4.7e-04 per=1.3e+01 cost=1.4e+05 flops=2.9e+08
 sigma[gemm] counter=7 i=5 t=4.8e-04 per=1.3e+01 cost=1.4e+05 flops=2.8e+08
 sigma[gemm] counter=7 i=6 t=4.3e-04 per=1.2e+01 cost=7.3e+04 flops=1.7e+08
 sigma[gemm] counter=7 i=7 t=4.0e-04 per=1.1e+01 cost=7.2e+04 flops=1.8e+08
 sigma[gemm] counter=7 total t=3.0e-03 per=8.1e+01 cost=5.8e+05 flops=1.9e+08
 sigma[red] counter=7 t=3.4e-04 per=9.2e+00 cost=1.5e+05 flops=4.2e+08
--- TIMING FOR sigma_tot : t_inter=2.3e-03 t_gemm=2.0e-02 t_reduction=2.3e-03 tot=2.4e-02 ---
 sigma_tot[inter] counter=7 t=2.3e-03 per=9.5e+00 cost=9.8e+05 flops=4.3e+08
 sigma_tot[gemm] counter=7 i=0 t=2.1e-03 per=8.9e+00 cost=2.8e+05 flops=1.3e+08
 sigma_tot[gemm] counter=7 i=1 t=1.9e-03 per=7.7e+00 cost=2.9e+05 flops=1.5e+08
 sigma_tot[gemm] counter=7 i=2 t=1.7e-03 per=7.2e+00 cost=2.6e+05 flops=1.5e+08
 sigma_tot[gemm] counter=7 i=3 t=1.8e-03 per=7.3e+00 cost=2.6e+05 flops=1.5e+08
 sigma_tot[gemm] counter=7 i=4 t=4.0e-03 per=1.6e+01 cost=1.1e+06 flops=2.8e+08
 sigma_tot[gemm] counter=7 i=5 t=3.0e-03 per=1.3e+01 cost=1.1e+06 flops=3.7e+08
 sigma_tot[gemm] counter=7 i=6 t=2.6e-03 per=1.1e+01 cost=4.7e+05 flops=1.8e+08
 sigma_tot[gemm] counter=7 i=7 t=2.5e-03 per=1.1e+01 cost=4.7e+05 flops=1.8e+08
 sigma_tot[gemm] counter=7 total t=2.0e-02 per=8.1e+01 cost=4.3e+06 flops=2.2e+08
 sigma_tot[red] counter=7 t=2.3e-03 per=9.4e+00 cost=9.9e+05 flops=4.4e+08
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,1.8e-05,3.5e-06,1.8e-06,2.8e-07
    6   0 -      -3.234306636119 -1.352e-07  2.679e-04    3     6  5.189e-02 8.648e-03 3.988e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.367e-05,3.719e-04,3.023e-03,3.224e-04,3.748e-03
 ndim=252:1.878e-06GB t[comm(intra)]=2.367e-05 speed=1.587e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=3.7e-04 t_gemm=3.0e-03 t_reduction=3.2e-04 tot=3.7e-03 ---
 sigma[inter] counter=8 t=3.7e-04 per=1.0e+01 cost=6.9e+04 flops=1.9e+08
 sigma[gemm] counter=8 i=0 t=3.5e-04 per=9.4e+00 cost=4.2e+04 flops=1.2e+08
 sigma[gemm] counter=8 i=1 t=3.3e-04 per=8.8e+00 cost=4.2e+04 flops=1.3e+08
 sigma[gemm] counter=8 i=2 t=2.7e-04 per=7.3e+00 cost=3.8e+04 flops=1.4e+08
 sigma[gemm] counter=8 i=3 t=2.7e-04 per=7.4e+00 cost=3.8e+04 flops=1.4e+08
 sigma[gemm] counter=8 i=4 t=4.9e-04 per=1.3e+01 cost=1.4e+05 flops=2.8e+08
 sigma[gemm] counter=8 i=5 t=4.7e-04 per=1.3e+01 cost=1.4e+05 flops=2.8e+08
 sigma[gemm] counter=8 i=6 t=4.2e-04 per=1.1e+01 cost=7.3e+04 flops=1.7e+08
 sigma[gemm] counter=8 i=7 t=4.0e-04 per=1.1e+01 cost=7.2e+04 flops=1.8e+08
 sigma[gemm] counter=8 total t=3.0e-03 per=8.1e+01 cost=5.8e+05 flops=1.9e+08
 sigma[red] counter=8 t=3.2e-04 per=8.7e+00 cost=1.5e+05 flops=4.5e+08
--- TIMING FOR sigma_tot : t_inter=2.7e-03 t_gemm=2.3e-02 t_reduction=2.6e-03 tot=2.8e-02 ---
 sigma_tot[inter] counter=8 t=2.7e-03 per=9.6e+00 cost=1.1e+06 flops=3.9e+08
 sigma_tot[gemm] counter=8 i=0 t=2.5e-03 per=9.0e+00 cost=3.3e+05 flops=1.3e+08
 sigma_tot[gemm] counter=8 i=1 t=2.2e-03 per=7.8e+00 cost=3.3e+05 flops=1.5e+08
 sigma_tot[gemm] counter=8 i=2 t=2.0e-03 per=7.2e+00 cost=3.0e+05 flops=1.5e+08
 sigma_tot[gemm] counter=8 i=3 t=2.0e-03 per=7.3e+00 cost=3.0e+05 flops=1.5e+08
 sigma_tot[gemm] counter=8 i=4 t=4.5e-03 per=1.6e+01 cost=1.3e+06 flops=2.8e+08
 sigma_tot[gemm] counter=8 i=5 t=3.5e-03 per=1.3e+01 cost=1.3e+06 flops=3.6e+08
 sigma_tot[gemm] counter=8 i=6 t=3.0e-03 per=1.1e+01 cost=5.4e+05 flops=1.8e+08
 sigma_tot[gemm] counter=8 i=7 t=2.9e-03 per=1.1e+01 cost=5.4e+05 flops=1.8e+08
 sigma_tot[gemm] counter=8 total t=2.3e-02 per=8.1e+01 cost=4.9e+06 flops=2.1e+08
 sigma_tot[red] counter=8 t=2.6e-03 per=9.3e+00 cost=1.1e+06 flops=4.4e+08
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,1.8e-05,3.7e-06,1.8e-06,2.9e-07
    7   0 -      -3.234306683167 -4.705e-08  1.497e-04    3     7  6.169e-02 8.812e-03 3.980e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.376e-05,3.084e-04,2.463e-03,2.891e-04,3.092e-03
 ndim=252:1.878e-06GB t[comm(intra)]=2.376e-05 speed=1.580e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=3.1e-04 t_gemm=2.5e-03 t_reduction=2.9e-04 tot=3.1e-03 ---
 sigma[inter] counter=9 t=3.1e-04 per=1.0e+01 cost=6.9e+04 flops=2.2e+08
 sigma[gemm] counter=9 i=0 t=2.9e-04 per=9.6e+00 cost=4.2e+04 flops=1.4e+08
 sigma[gemm] counter=9 i=1 t=2.7e-04 per=8.8e+00 cost=4.2e+04 flops=1.6e+08
 sigma[gemm] counter=9 i=2 t=2.3e-04 per=7.4e+00 cost=3.8e+04 flops=1.7e+08
 sigma[gemm] counter=9 i=3 t=2.2e-04 per=7.3e+00 cost=3.8e+04 flops=1.7e+08
 sigma[gemm] counter=9 i=4 t=3.9e-04 per=1.3e+01 cost=1.4e+05 flops=3.5e+08
 sigma[gemm] counter=9 i=5 t=4.0e-04 per=1.3e+01 cost=1.4e+05 flops=3.4e+08
 sigma[gemm] counter=9 i=6 t=3.2e-04 per=1.1e+01 cost=7.3e+04 flops=2.3e+08
 sigma[gemm] counter=9 i=7 t=3.3e-04 per=1.1e+01 cost=7.2e+04 flops=2.2e+08
 sigma[gemm] counter=9 total t=2.5e-03 per=8.0e+01 cost=5.8e+05 flops=2.3e+08
 sigma[red] counter=9 t=2.9e-04 per=9.4e+00 cost=1.5e+05 flops=5.0e+08
--- TIMING FOR sigma_tot : t_inter=3.0e-03 t_gemm=2.5e-02 t_reduction=2.9e-03 tot=3.1e-02 ---
 sigma_tot[inter] counter=9 t=3.0e-03 per=9.6e+00 cost=1.1e+06 flops=3.8e+08
 sigma_tot[gemm] counter=9 i=0 t=2.8e-03 per=9.0e+00 cost=3.7e+05 flops=1.3e+08
 sigma_tot[gemm] counter=9 i=1 t=2.4e-03 per=7.9e+00 cost=3.7e+05 flops=1.5e+08
 sigma_tot[gemm] counter=9 i=2 t=2.2e-03 per=7.3e+00 cost=3.4e+05 flops=1.5e+08
 sigma_tot[gemm] counter=9 i=3 t=2.3e-03 per=7.3e+00 cost=3.4e+05 flops=1.5e+08
 sigma_tot[gemm] counter=9 i=4 t=4.9e-03 per=1.6e+01 cost=1.4e+06 flops=2.9e+08
 sigma_tot[gemm] counter=9 i=5 t=3.9e-03 per=1.3e+01 cost=1.4e+06 flops=3.6e+08
 sigma_tot[gemm] counter=9 i=6 t=3.3e-03 per=1.1e+01 cost=6.2e+05 flops=1.9e+08
 sigma_tot[gemm] counter=9 i=7 t=3.3e-03 per=1.1e+01 cost=6.1e+05 flops=1.9e+08
 sigma_tot[gemm] counter=9 total t=2.5e-02 per=8.1e+01 cost=5.4e+06 flops=2.2e+08
 sigma_tot[red] counter=9 t=2.9e-03 per=9.3e+00 cost=1.3e+06 flops=4.4e+08
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.6e-05,3.2e-06,1.5e-06,2.4e-07
    8   0 +      -3.234306696169 -1.300e-08  7.211e-05    3     8  7.523e-02 9.404e-03 3.887e-03
TIMING FOR Davidson : 7.524e-02  T(cal/comm/rest)=3.110e-02,9.210e-07,4.414e-02
decomposed t_rest=4.414e-02
 T(sub)    =2.270e-04 per=5.142e-01
 T(precond)=4.359e-02 per=9.874e+01
 T(ortho)  =5.762e-05 per=1.305e-01
 T(xcopy)  =1.265e-06 per=2.866e-03
 T(xnrm2)  =4.847e-06 per=1.098e-02
 T(other)  =2.655e-04 per=6.014e-01
optimized energies: isweep=0 ibond=1 dots=2 e[0]=-3.234306696169 nmvp=8
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:8.287e+01S Sys:1.284e+00S Total:8.416e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=10 nqr=15 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond1.txt
 qbond: qsuper nsym=15 dimAll=40
 (2,0):5 (4,0):6 (3,1):6 (3,-1):6 (1,1):1 (2,2):2 (1,-1):1 (2,-2):2 (6,0):1 (5,1):2 (5,-1):2 (4,2):2 (4,-2):2 (3,3):1 (3,-3):1
timing for divide=1.7e-05
timing for compute=1.4e-04
timing for collect=2.0e-05
----- TMING FOR decimation_genbasis(nkr): 1.8e-04 S T(divide/compute/collect)=1.7e-05,1.4e-04,2.0e-05 -----
decimation summary: 40->10 dwt=+2.110e-03 SvN=1.341e+00
 qbond: qkept nsym=5 dimAll=10
 (3,1):3 (3,-1):3 (4,0):2 (2,0):1 (4,-2):1
----- TIMING for decimation_row(nkr): 5.679e-04 S T(decim/select/formRot)=2.625e-04,2.804e-04,2.504e-05 -----
----- TIMING FOR twodot_decimation: 8.701e-04 S T(wf/decim)=2.847e-04,5.855e-04 -----
ctns::oper_renorm coord=(2,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:6 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=10,10 size(op)=24:1.831e-04MB size(tot)=558:4.257e-03MB:4.157e-06GB
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:8.289e+01S Sys:1.284e+00S Total:8.418e+01S
----- TIMING FOR symbolic_formulae_renorm with size=49 : 1.648e-03 S -----
rank=0 GPUmem(GB): used=1.43e-05 (oper)=1.07e-05
rank=0 GPUmem(GB): used=1.48e-05 (oper,site)(GB)=1.07e-05,4.1e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=49
 no. of rintermediate operators=114
 no. of coefficients=228:0.00174MB:1.7e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.560e-04 S -----
rank=0 GPUmem(GB): used=1.65e-05 (oper,site,rinter)=1.07e-05,4.1e-07,1.7e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00234 S size(rtasks)=49 size(Rlst2)=25 T(Rmu/Rlist)=0.000604,0.00173 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0025 S size(rtasks)=49 size(Rlst)=1566 -----
rank=0 GPUmem(GB): used=1.65e-05 (oper,site,rinter,batch)=1.07e-05,4.1e-07,1.7e-06,0.000257 blksize=9 blksize0=3 batchsize=1566
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000102,0.000684,0.000217
--- TIMING FOR renorm : t_inter=1.0e-04 t_gemm=6.8e-04 t_reduction=2.2e-04 tot=1.0e-03 ---
 renorm[inter] counter=2 t=1.0e-04 per=1.0e+01 cost=5.2e+03 flops=5.1e+07
 renorm[gemm] counter=2 i=0 t=8.7e-05 per=8.7e+00 cost=3.2e+03 flops=3.7e+07
 renorm[gemm] counter=2 i=1 t=9.0e-05 per=8.9e+00 cost=5.1e+03 flops=5.6e+07
 renorm[gemm] counter=2 i=2 t=1.1e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=3 t=1.1e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=4 t=1.5e-04 per=1.5e+01 cost=5.7e+03 flops=3.8e+07
 renorm[gemm] counter=2 i=5 t=1.5e-04 per=1.5e+01 cost=7.8e+03 flops=5.3e+07
 renorm[gemm] counter=2 i=6 t=2.1e-04 per=2.1e+01 cost=2.6e+04 flops=1.2e+08
 renorm[gemm] counter=2 total t=6.8e-04 per=6.8e+01 cost=4.8e+04 flops=7.0e+07
 renorm[red] counter=2 t=2.2e-04 per=2.2e+01 cost=1.7e+04 flops=7.6e+07
--- TIMING FOR renorm_tot : t_inter=1.1e-04 t_gemm=1.0e-03 t_reduction=3.4e-04 tot=1.5e-03 ---
 renorm_tot[inter] counter=2 t=1.1e-04 per=7.4e+00 cost=5.2e+03 flops=4.8e+07
 renorm_tot[gemm] counter=2 i=0 t=1.6e-04 per=1.1e+01 cost=3.8e+03 flops=2.3e+07
 renorm_tot[gemm] counter=2 i=1 t=1.5e-04 per=1.0e+01 cost=6.1e+03 flops=4.0e+07
 renorm_tot[gemm] counter=2 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=3 t=2.0e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=4 t=2.1e-04 per=1.4e+01 cost=6.6e+03 flops=3.2e+07
 renorm_tot[gemm] counter=2 i=5 t=2.0e-04 per=1.4e+01 cost=8.5e+03 flops=4.2e+07
 renorm_tot[gemm] counter=2 i=6 t=2.9e-04 per=2.0e+01 cost=2.9e+04 flops=1.0e+08
 renorm_tot[gemm] counter=2 total t=1.0e-03 per=6.9e+01 cost=5.4e+04 flops=5.3e+07
 renorm_tot[red] counter=2 t=3.4e-04 per=2.3e+01 cost=2.0e+04 flops=5.8e+07
qops.to_cpu: size(tot)=558:4.3e-03MB:4.2e-06GB t[to_cpu]=1.4e-05S speed=2.9e-01GB/S
check ||H-H.dagger||=1.649e-15 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0163 S rank=0 -----
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:8.291e+01S Sys:1.284e+00S Total:8.419e+01S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=521:3.975e-03MB:3.882e-06GB
 rwfuns: len=2 mem=4:3.052e-05MB:2.980e-08GB
 cpsi: len=1 mem=84:6.409e-04MB:6.258e-07GB
total mem of comb=651:4.967e-03MB:4.850e-06GB
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:8.291e+01S Sys:1.284e+00S Total:8.419e+01S
##### local opt: 3.003e-01 S #####
 T(local opt: fetch) = 2.498e-04 S  per = 0.0832  per(accum) = 0.0832
 T(local opt: hdiag) = 1.574e-03 S  per = 0.524  per(accum) = 0.607
 T(local opt: dvdsn) = 2.803e-01 S  per = 93.3  per(accum) = 93.9
 T(local opt: decim) = 8.795e-04 S  per = 0.293  per(accum) = 94.2
 T(local opt: guess) = 3.920e-04 S  per = 0.131  per(accum) = 94.3
 T(local opt: renrm) = 1.672e-02 S  per = 5.57  per(accum) = 99.9
 T(local opt: save ) = 2.650e-04 S  per = 0.0882  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.803e-01 S  T(sum) = 2.799e-01 S  per = 9.986e+01
 T(local opt: preprocess                  ) = 1.272e-03 S  per = 0.454  per(accum) = 0.454
 T(local opt: symbolic_formulae           ) = 3.424e-03 S  per = 1.22  per(accum) = 1.68
 T(local opt: hintermediate init          ) = 1.455e-04 S  per = 0.052  per(accum) = 1.73
 T(local opt: preprocess_hformulae_Hxlist ) = 3.056e-02 S  per = 10.9  per(accum) = 12.7
 T(local opt: hmmtasks init               ) = 1.689e-01 S  per = 60.3  per(accum) = 73
 T(local opt: initial guess for dvdson    ) = 3.409e-04 S  per = 0.122  per(accum) = 73.1
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.091e-02 S  per =   11  per(accum) = 84.2
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.906e-04 S  per = 0.0681  per(accum) = 84.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 9.210e-07 S  per = 0.000329  per(accum) = 84.2
 T(local opt: dvdson solver [rest part]   ) = 4.414e-02 S  per = 15.8  per(accum) = 100
Detailed decomposition of T(renrm) = 1.672e-02 S  T(sum) = 1.672e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.153e-04 S  per = 0.689  per(accum) = 0.689
 T(local opt: qops init                    ) = 4.205e-04 S  per = 2.51  per(accum) = 3.2
 T(local opt: symbolic_formulae_renorm     ) = 1.657e-03 S  per = 9.91  per(accum) = 13.1
 T(local opt: allocate qops on gpu         ) = 2.630e-05 S  per = 0.157  per(accum) = 13.3
 T(local opt: site memcpy cpu2gpu          ) = 2.388e-05 S  per = 0.143  per(accum) = 13.4
 T(local opt: rintermediate init           ) = 1.659e-04 S  per = 0.992  per(accum) = 14.4
 T(local opt: preprocess_formulae_Rlist2   ) = 2.555e-03 S  per = 15.3  per(accum) = 29.7
 T(local opt: rmmtasks init                ) = 1.033e-02 S  per = 61.8  per(accum) = 91.4
 T(local opt: qops memset on cpu           ) = 3.200e-08 S  per = 0.000191  per(accum) = 91.4
 T(local opt: preprocess_renorm_batchGPU   ) = 1.109e-03 S  per = 6.63  per(accum) = 98.1
 T(local opt: reduction of opS & opH [nccl]) = 1.148e-06 S  per = 0.00686  per(accum) = 98.1
 T(local opt: qops memcpy gpu2cpu          ) = 2.026e-05 S  per = 0.121  per(accum) = 98.2
 T(local opt: deallocate cpu and gpu memory) = 1.116e-05 S  per = 0.0667  per(accum) = 98.3
 T(local opt: reduction of opS & opH [comm]) = 2.296e-05 S  per = 0.137  per(accum) = 98.4
 T(local opt: conversion from opAB to opPQ ) = 3.819e-06 S  per = 0.0228  per(accum) = 98.4
 T(local opt: after oper_renorm            ) = 2.622e-04 S  per = 1.57  per(accum) = 100
##### sweep opt: 5.352e-01 S #####
 T(sweep opt: fetch) = 3.702e-03 S  per = 0.692  per(accum) = 0.692
 T(sweep opt: hdiag) = 2.359e-03 S  per = 0.441  per(accum) = 1.13
 T(sweep opt: dvdsn) = 3.592e-01 S  per = 67.1  per(accum) = 68.2
 T(sweep opt: decim) = 1.662e-03 S  per = 0.311  per(accum) = 68.6
 T(sweep opt: guess) = 8.017e-04 S  per = 0.15  per(accum) = 68.7
 T(sweep opt: renrm) = 1.669e-01 S  per = 31.2  per(accum) = 99.9
 T(sweep opt: save ) = 5.585e-04 S  per = 0.104  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.592e-01 S  T(sum) = 3.586e-01 S  per = 9.983e+01
 T(sweep opt: preprocess                  ) = 2.320e-03 S  per = 0.647  per(accum) = 0.647
 T(sweep opt: symbolic_formulae           ) = 5.281e-03 S  per = 1.47  per(accum) = 2.12
 T(sweep opt: hintermediate init          ) = 2.358e-04 S  per = 0.0657  per(accum) = 2.19
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.246e-02 S  per = 11.8  per(accum) = 14
 T(sweep opt: hmmtasks init               ) = 2.307e-01 S  per = 64.3  per(accum) = 78.4
 T(sweep opt: initial guess for dvdson    ) = 6.285e-04 S  per = 0.175  per(accum) = 78.5
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 3.252e-02 S  per = 9.07  per(accum) = 87.6
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.136e-04 S  per = 0.0596  per(accum) = 87.7
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.031e-06 S  per = 0.000288  per(accum) = 87.7
 T(sweep opt: dvdson solver [rest part]   ) = 4.422e-02 S  per = 12.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.669e-01 S  T(sum) = 1.669e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.914e-04 S  per = 0.115  per(accum) = 0.115
 T(sweep opt: qops init                    ) = 7.772e-04 S  per = 0.466  per(accum) = 0.58
 T(sweep opt: symbolic_formulae_renorm     ) = 2.212e-03 S  per = 1.33  per(accum) = 1.91
 T(sweep opt: allocate qops on gpu         ) = 4.590e-05 S  per = 0.0275  per(accum) = 1.93
 T(sweep opt: site memcpy cpu2gpu          ) = 5.336e-05 S  per = 0.032  per(accum) = 1.97
 T(sweep opt: rintermediate init           ) = 1.835e-04 S  per = 0.11  per(accum) = 2.07
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.503e-03 S  per =  2.1  per(accum) = 4.17
 T(sweep opt: rmmtasks init                ) = 1.395e-02 S  per = 8.36  per(accum) = 12.5
 T(sweep opt: qops memset on cpu           ) = 1.210e-07 S  per = 7.25e-05  per(accum) = 12.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.679e-03 S  per = 1.01  per(accum) = 13.5
 T(sweep opt: reduction of opS & opH [nccl]) = 2.196e-06 S  per = 0.00132  per(accum) = 13.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.101e-05 S  per = 0.0246  per(accum) = 13.6
 T(sweep opt: deallocate cpu and gpu memory) = 2.231e-05 S  per = 0.0134  per(accum) = 13.6
 T(sweep opt: reduction of opS & opH [comm]) = 4.739e-05 S  per = 0.0284  per(accum) = 13.6
 T(sweep opt: conversion from opAB to opPQ ) = 1.437e-01 S  per = 86.1  per(accum) = 99.7
 T(sweep opt: after oper_renorm            ) = 5.205e-04 S  per = 0.312  per(accum) = 100
##### global opt: 5.352e-01 S #####
 T(global opt: fetch) = 3.702e-03 S  per = 0.692  per(accum) = 0.692
 T(global opt: hdiag) = 2.359e-03 S  per = 0.441  per(accum) = 1.13
 T(global opt: dvdsn) = 3.592e-01 S  per = 67.1  per(accum) = 68.2
 T(global opt: decim) = 1.662e-03 S  per = 0.311  per(accum) = 68.6
 T(global opt: guess) = 8.017e-04 S  per = 0.15  per(accum) = 68.7
 T(global opt: renrm) = 1.669e-01 S  per = 31.2  per(accum) = 99.9
 T(global opt: save ) = 5.585e-04 S  per = 0.104  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.592e-01 S  T(sum) = 3.586e-01 S  per = 9.983e+01
 T(global opt: preprocess                  ) = 2.320e-03 S  per = 0.647  per(accum) = 0.647
 T(global opt: symbolic_formulae           ) = 5.281e-03 S  per = 1.47  per(accum) = 2.12
 T(global opt: hintermediate init          ) = 2.358e-04 S  per = 0.0657  per(accum) = 2.19
 T(global opt: preprocess_hformulae_Hxlist ) = 4.246e-02 S  per = 11.8  per(accum) = 14
 T(global opt: hmmtasks init               ) = 2.307e-01 S  per = 64.3  per(accum) = 78.4
 T(global opt: initial guess for dvdson    ) = 6.285e-04 S  per = 0.175  per(accum) = 78.5
 T(global opt: dvdson solver [Hx_batchGPU] ) = 3.252e-02 S  per = 9.07  per(accum) = 87.6
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.136e-04 S  per = 0.0596  per(accum) = 87.7
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.031e-06 S  per = 0.000288  per(accum) = 87.7
 T(global opt: dvdson solver [rest part]   ) = 4.422e-02 S  per = 12.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.669e-01 S  T(sum) = 1.669e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.914e-04 S  per = 0.115  per(accum) = 0.115
 T(global opt: qops init                    ) = 7.772e-04 S  per = 0.466  per(accum) = 0.58
 T(global opt: symbolic_formulae_renorm     ) = 2.212e-03 S  per = 1.33  per(accum) = 1.91
 T(global opt: allocate qops on gpu         ) = 4.590e-05 S  per = 0.0275  per(accum) = 1.93
 T(global opt: site memcpy cpu2gpu          ) = 5.336e-05 S  per = 0.032  per(accum) = 1.97
 T(global opt: rintermediate init           ) = 1.835e-04 S  per = 0.11  per(accum) = 2.07
 T(global opt: preprocess_formulae_Rlist2   ) = 3.503e-03 S  per =  2.1  per(accum) = 4.17
 T(global opt: rmmtasks init                ) = 1.395e-02 S  per = 8.36  per(accum) = 12.5
 T(global opt: qops memset on cpu           ) = 1.210e-07 S  per = 7.25e-05  per(accum) = 12.5
 T(global opt: preprocess_renorm_batchGPU   ) = 1.679e-03 S  per = 1.01  per(accum) = 13.5
 T(global opt: reduction of opS & opH [nccl]) = 2.196e-06 S  per = 0.00132  per(accum) = 13.5
 T(global opt: qops memcpy gpu2cpu          ) = 4.101e-05 S  per = 0.0246  per(accum) = 13.6
 T(global opt: deallocate cpu and gpu memory) = 2.231e-05 S  per = 0.0134  per(accum) = 13.6
 T(global opt: reduction of opS & opH [comm]) = 4.739e-05 S  per = 0.0284  per(accum) = 13.6
 T(global opt: conversion from opAB to opPQ ) = 1.437e-01 S  per = 86.1  per(accum) = 99.7
 T(global opt: after oper_renorm            ) = 5.205e-04 S  per = 0.312  per(accum) = 100

isweep=0 ibond=2/seqsize=6 dots=2 dbond=(3,0)-(4,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:8.291e+01S Sys:1.284e+00S Total:8.420e+01S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=521:3.975e-03MB:3.882e-06GB
 rwfuns: len=2 mem=4:3.052e-05MB:2.980e-08GB
 cpsi: len=1 mem=84:6.409e-04MB:6.258e-07GB
total mem of comb=651:4.967e-03MB:4.850e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=3,1,1,1
 suppl= 0 1 2
 suppr= 5
 suppc1= 3
 suppc2= 4
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:6 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=10,10 size(op)=24:1.831e-04MB size(tot)=558:4.257e-03MB:4.157e-06GB
 rqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 c1qops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 c2qops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 qops(tot)=1182:9.018e-03MB:8.807e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(3,0) fdel=./scratch/sweep/rop(4,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
wf4(diml,dimr,dimc1,dimc2)=(10,4,4,4) nnz=84:6.409e-04MB
qtensor4: wf4 own=1 _data=0x4f1c38c0
qinfo4: wf4 sym=(6,0)
 qbond: qrow nsym=5 dimAll=10
 (3,1):3 (3,-1):3 (4,0):2 (2,0):1 (4,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=39 nblocks=320 size=84:6.409e-04MB
### DIAG TIMING: total=4.631e-04 t1=1.242e-05, t2=1.805e-05, t3=5.107e-05, t4=3.392e-04, t5=2.626e-05, t6=1.208e-05, t7=4.111e-06
duration_diagGPU:4.742e-04
duration_diagreduce:3.300e-08
duration_diagtransform:6.540e-07
----- TIMING FOR symbolic_formulae_twodot with size=210 : 1.930e-03 S -----
rank=0 GPUmem(GB): used=8.81e-06 (oper)=8.81e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=210
 no. of hintermediate operators=58
 no. of coefficients=174:0.00133MB:1.3e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.274e-05 S -----
rank=0 GPUmem(GB): used=1.01e-05 (oper,hinter)=8.81e-06,1.3e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00589 S size(H_formulae)=210 size(Hxlst2)=39 T(Hmu/Hxlist)=0.000505,0.00539 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00629 S size(H_formulae)=210 size(Hxlst)=4562 -----
rank=0 GPUmem(GB): used=0.000453 (oper,hinter,dvdson,batch)=8.81e-06,1.3e-06,1.25e-06,0.000442 blksize=3 blksize0=6 batchsize=4562
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=84 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.16e-05,9.79e-05,0.000804,0.000225,0.00116
 ndim=84:6.26e-07GB t[comm(intra)]=2.16e-05 speed=0.058GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.8e-05 t_gemm=8.0e-04 t_reduction=2.3e-04 tot=1.1e-03 ---
 sigma[inter] counter=10 t=9.8e-05 per=8.7e+00 cost=2.5e+04 flops=2.6e+08
 sigma[gemm] counter=10 i=0 t=9.5e-05 per=8.4e+00 cost=6.1e+03 flops=6.4e+07
 sigma[gemm] counter=10 i=1 t=9.0e-05 per=8.0e+00 cost=6.1e+03 flops=6.8e+07
 sigma[gemm] counter=10 i=2 t=8.8e-05 per=7.9e+00 cost=5.3e+03 flops=6.0e+07
 sigma[gemm] counter=10 i=3 t=8.5e-05 per=7.5e+00 cost=5.5e+03 flops=6.5e+07
 sigma[gemm] counter=10 i=4 t=8.9e-05 per=7.9e+00 cost=6.1e+03 flops=6.8e+07
 sigma[gemm] counter=10 i=5 t=8.8e-05 per=7.8e+00 cost=6.2e+03 flops=7.0e+07
 sigma[gemm] counter=10 i=6 t=1.3e-04 per=1.2e+01 cost=1.5e+04 flops=1.1e+08
 sigma[gemm] counter=10 i=7 t=1.4e-04 per=1.2e+01 cost=1.5e+04 flops=1.1e+08
 sigma[gemm] counter=10 total t=8.0e-04 per=7.1e+01 cost=6.5e+04 flops=8.1e+07
 sigma[red] counter=10 t=2.3e-04 per=2.0e+01 cost=2.0e+04 flops=8.9e+07
--- TIMING FOR sigma_tot : t_inter=3.1e-03 t_gemm=2.6e-02 t_reduction=3.1e-03 tot=3.2e-02 ---
 sigma_tot[inter] counter=10 t=3.1e-03 per=9.6e+00 cost=1.1e+06 flops=3.7e+08
 sigma_tot[gemm] counter=10 i=0 t=2.9e-03 per=9.0e+00 cost=3.7e+05 flops=1.3e+08
 sigma_tot[gemm] counter=10 i=1 t=2.5e-03 per=7.9e+00 cost=3.8e+05 flops=1.5e+08
 sigma_tot[gemm] counter=10 i=2 t=2.3e-03 per=7.3e+00 cost=3.4e+05 flops=1.5e+08
 sigma_tot[gemm] counter=10 i=3 t=2.3e-03 per=7.3e+00 cost=3.4e+05 flops=1.5e+08
 sigma_tot[gemm] counter=10 i=4 t=5.0e-03 per=1.5e+01 cost=1.4e+06 flops=2.8e+08
 sigma_tot[gemm] counter=10 i=5 t=4.0e-03 per=1.2e+01 cost=1.4e+06 flops=3.5e+08
 sigma_tot[gemm] counter=10 i=6 t=3.4e-03 per=1.1e+01 cost=6.3e+05 flops=1.8e+08
 sigma_tot[gemm] counter=10 i=7 t=3.4e-03 per=1.1e+01 cost=6.3e+05 flops=1.8e+08
 sigma_tot[gemm] counter=10 total t=2.6e-02 per=8.1e+01 cost=5.5e+06 flops=2.1e+08
 sigma_tot[red] counter=10 t=3.1e-03 per=9.7e+00 cost=1.3e+06 flops=4.2e+08
T(sub)=8.7e-06 T(gemm/eig/ortho/gemm/axpy)=2.0e-06,4.0e-06,1.8e-06,6.7e-07,1.8e-07
settings: ndim=84 neig=1 maxcycle=30 nbuff=4 memory=9e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.231358639827 -1.003e+03  1.745e-02    1     1  1.286e-03 1.286e-03 1.263e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.269e-05,1.216e-04,9.798e-04,2.254e-04,1.357e-03
 ndim=84:6.258e-07GB t[comm(intra)]=2.269e-05 speed=5.516e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=9.8e-04 t_reduction=2.3e-04 tot=1.3e-03 ---
 sigma[inter] counter=11 t=1.2e-04 per=9.2e+00 cost=2.5e+04 flops=2.1e+08
 sigma[gemm] counter=11 i=0 t=1.2e-04 per=8.9e+00 cost=6.1e+03 flops=5.1e+07
 sigma[gemm] counter=11 i=1 t=1.2e-04 per=8.9e+00 cost=6.1e+03 flops=5.2e+07
 sigma[gemm] counter=11 i=2 t=1.1e-04 per=8.1e+00 cost=5.3e+03 flops=5.0e+07
 sigma[gemm] counter=11 i=3 t=1.0e-04 per=7.9e+00 cost=5.5e+03 flops=5.3e+07
 sigma[gemm] counter=11 i=4 t=1.2e-04 per=9.1e+00 cost=6.1e+03 flops=5.0e+07
 sigma[gemm] counter=11 i=5 t=1.2e-04 per=9.0e+00 cost=6.2e+03 flops=5.2e+07
 sigma[gemm] counter=11 i=6 t=1.5e-04 per=1.1e+01 cost=1.5e+04 flops=1.0e+08
 sigma[gemm] counter=11 i=7 t=1.4e-04 per=1.1e+01 cost=1.5e+04 flops=1.0e+08
 sigma[gemm] counter=11 total t=9.8e-04 per=7.4e+01 cost=6.5e+04 flops=6.6e+07
 sigma[red] counter=11 t=2.3e-04 per=1.7e+01 cost=2.0e+04 flops=8.9e+07
--- TIMING FOR sigma_tot : t_inter=3.2e-03 t_gemm=2.7e-02 t_reduction=3.3e-03 tot=3.3e-02 ---
 sigma_tot[inter] counter=11 t=3.2e-03 per=9.6e+00 cost=1.2e+06 flops=3.7e+08
 sigma_tot[gemm] counter=11 i=0 t=3.0e-03 per=9.0e+00 cost=3.8e+05 flops=1.3e+08
 sigma_tot[gemm] counter=11 i=1 t=2.7e-03 per=8.0e+00 cost=3.8e+05 flops=1.4e+08
 sigma_tot[gemm] counter=11 i=2 t=2.4e-03 per=7.3e+00 cost=3.5e+05 flops=1.4e+08
 sigma_tot[gemm] counter=11 i=3 t=2.5e-03 per=7.3e+00 cost=3.5e+05 flops=1.4e+08
 sigma_tot[gemm] counter=11 i=4 t=5.1e-03 per=1.5e+01 cost=1.4e+06 flops=2.8e+08
 sigma_tot[gemm] counter=11 i=5 t=4.1e-03 per=1.2e+01 cost=1.4e+06 flops=3.4e+08
 sigma_tot[gemm] counter=11 i=6 t=3.6e-03 per=1.1e+01 cost=6.4e+05 flops=1.8e+08
 sigma_tot[gemm] counter=11 i=7 t=3.6e-03 per=1.1e+01 cost=6.4e+05 flops=1.8e+08
 sigma_tot[gemm] counter=11 total t=2.7e-02 per=8.0e+01 cost=5.6e+06 flops=2.1e+08
 sigma_tot[red] counter=11 t=3.3e-03 per=1.0e+01 cost=1.3e+06 flops=4.0e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.3e-05,4.0e-06,1.3e-06,2.5e-07
    2   0 -      -3.231606503609 -2.479e-04  6.765e-03    2     2  7.699e-03 3.849e-03 1.396e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.282e-05,1.179e-04,9.835e-04,2.228e-04,1.353e-03
 ndim=84:6.258e-07GB t[comm(intra)]=2.282e-05 speed=5.486e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=9.8e-04 t_reduction=2.2e-04 tot=1.3e-03 ---
 sigma[inter] counter=12 t=1.2e-04 per=8.9e+00 cost=2.5e+04 flops=2.2e+08
 sigma[gemm] counter=12 i=0 t=1.2e-04 per=8.8e+00 cost=6.1e+03 flops=5.2e+07
 sigma[gemm] counter=12 i=1 t=1.2e-04 per=8.7e+00 cost=6.1e+03 flops=5.3e+07
 sigma[gemm] counter=12 i=2 t=1.1e-04 per=8.1e+00 cost=5.3e+03 flops=4.9e+07
 sigma[gemm] counter=12 i=3 t=1.1e-04 per=8.0e+00 cost=5.5e+03 flops=5.2e+07
 sigma[gemm] counter=12 i=4 t=1.4e-04 per=1.1e+01 cost=6.1e+03 flops=4.2e+07
 sigma[gemm] counter=12 i=5 t=1.0e-04 per=7.7e+00 cost=6.2e+03 flops=6.0e+07
 sigma[gemm] counter=12 i=6 t=1.5e-04 per=1.1e+01 cost=1.5e+04 flops=1.0e+08
 sigma[gemm] counter=12 i=7 t=1.4e-04 per=1.1e+01 cost=1.5e+04 flops=1.0e+08
 sigma[gemm] counter=12 total t=9.8e-04 per=7.4e+01 cost=6.5e+04 flops=6.6e+07
 sigma[red] counter=12 t=2.2e-04 per=1.7e+01 cost=2.0e+04 flops=9.0e+07
--- TIMING FOR sigma_tot : t_inter=3.3e-03 t_gemm=2.8e-02 t_reduction=3.6e-03 tot=3.5e-02 ---
 sigma_tot[inter] counter=12 t=3.3e-03 per=9.5e+00 cost=1.2e+06 flops=3.6e+08
 sigma_tot[gemm] counter=12 i=0 t=3.1e-03 per=9.0e+00 cost=3.9e+05 flops=1.2e+08
 sigma_tot[gemm] counter=12 i=1 t=2.8e-03 per=8.0e+00 cost=3.9e+05 flops=1.4e+08
 sigma_tot[gemm] counter=12 i=2 t=2.6e-03 per=7.3e+00 cost=3.5e+05 flops=1.4e+08
 sigma_tot[gemm] counter=12 i=3 t=2.6e-03 per=7.4e+00 cost=3.5e+05 flops=1.4e+08
 sigma_tot[gemm] counter=12 i=4 t=5.2e-03 per=1.5e+01 cost=1.4e+06 flops=2.7e+08
 sigma_tot[gemm] counter=12 i=5 t=4.2e-03 per=1.2e+01 cost=1.4e+06 flops=3.3e+08
 sigma_tot[gemm] counter=12 i=6 t=3.7e-03 per=1.1e+01 cost=6.6e+05 flops=1.8e+08
 sigma_tot[gemm] counter=12 i=7 t=3.7e-03 per=1.1e+01 cost=6.6e+05 flops=1.8e+08
 sigma_tot[gemm] counter=12 total t=2.8e-02 per=8.0e+01 cost=5.6e+06 flops=2.0e+08
 sigma_tot[red] counter=12 t=3.6e-03 per=1.0e+01 cost=1.3e+06 flops=3.8e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.7e-05,3.5e-06,1.4e-06,2.4e-07
    3   0 -      -3.231640290907 -3.379e-05  3.594e-03    3     3  1.681e-02 5.602e-03 1.439e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.087e-05,1.058e-04,8.287e-04,2.125e-04,1.174e-03
 ndim=84:6.258e-07GB t[comm(intra)]=2.087e-05 speed=5.998e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=8.3e-04 t_reduction=2.1e-04 tot=1.1e-03 ---
 sigma[inter] counter=13 t=1.1e-04 per=9.2e+00 cost=2.5e+04 flops=2.4e+08
 sigma[gemm] counter=13 i=0 t=1.0e-04 per=8.9e+00 cost=6.1e+03 flops=6.0e+07
 sigma[gemm] counter=13 i=1 t=9.7e-05 per=8.5e+00 cost=6.1e+03 flops=6.3e+07
 sigma[gemm] counter=13 i=2 t=9.2e-05 per=8.0e+00 cost=5.3e+03 flops=5.8e+07
 sigma[gemm] counter=13 i=3 t=9.1e-05 per=8.0e+00 cost=5.5e+03 flops=6.1e+07
 sigma[gemm] counter=13 i=4 t=9.7e-05 per=8.5e+00 cost=6.1e+03 flops=6.2e+07
 sigma[gemm] counter=13 i=5 t=1.0e-04 per=9.1e+00 cost=6.2e+03 flops=5.9e+07
 sigma[gemm] counter=13 i=6 t=1.2e-04 per=1.1e+01 cost=1.5e+04 flops=1.2e+08
 sigma[gemm] counter=13 i=7 t=1.2e-04 per=1.0e+01 cost=1.5e+04 flops=1.2e+08
 sigma[gemm] counter=13 total t=8.3e-04 per=7.2e+01 cost=6.5e+04 flops=7.8e+07
 sigma[red] counter=13 t=2.1e-04 per=1.9e+01 cost=2.0e+04 flops=9.4e+07
--- TIMING FOR sigma_tot : t_inter=3.4e-03 t_gemm=2.9e-02 t_reduction=3.8e-03 tot=3.6e-02 ---
 sigma_tot[inter] counter=13 t=3.4e-03 per=9.5e+00 cost=1.2e+06 flops=3.6e+08
 sigma_tot[gemm] counter=13 i=0 t=3.2e-03 per=9.0e+00 cost=3.9e+05 flops=1.2e+08
 sigma_tot[gemm] counter=13 i=1 t=2.9e-03 per=8.0e+00 cost=3.9e+05 flops=1.4e+08
 sigma_tot[gemm] counter=13 i=2 t=2.6e-03 per=7.4e+00 cost=3.6e+05 flops=1.4e+08
 sigma_tot[gemm] counter=13 i=3 t=2.7e-03 per=7.4e+00 cost=3.6e+05 flops=1.4e+08
 sigma_tot[gemm] counter=13 i=4 t=5.3e-03 per=1.5e+01 cost=1.4e+06 flops=2.7e+08
 sigma_tot[gemm] counter=13 i=5 t=4.3e-03 per=1.2e+01 cost=1.4e+06 flops=3.3e+08
 sigma_tot[gemm] counter=13 i=6 t=3.8e-03 per=1.1e+01 cost=6.7e+05 flops=1.8e+08
 sigma_tot[gemm] counter=13 i=7 t=3.8e-03 per=1.1e+01 cost=6.7e+05 flops=1.8e+08
 sigma_tot[gemm] counter=13 total t=2.9e-02 per=8.0e+01 cost=5.7e+06 flops=2.0e+08
 sigma_tot[red] counter=13 t=3.8e-03 per=1.0e+01 cost=1.4e+06 flops=3.6e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.5e-05,3.2e-06,1.1e-06,2.1e-07
    4   0 -      -3.231649843975 -9.553e-06  1.986e-03    3     4  3.025e-02 7.562e-03 1.408e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.415e-05,1.181e-04,1.025e-03,2.492e-04,1.422e-03
 ndim=84:6.258e-07GB t[comm(intra)]=2.415e-05 speed=5.182e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=1.0e-03 t_reduction=2.5e-04 tot=1.4e-03 ---
 sigma[inter] counter=14 t=1.2e-04 per=8.5e+00 cost=2.5e+04 flops=2.2e+08
 sigma[gemm] counter=14 i=0 t=1.2e-04 per=8.6e+00 cost=6.1e+03 flops=5.1e+07
 sigma[gemm] counter=14 i=1 t=1.1e-04 per=8.2e+00 cost=6.1e+03 flops=5.4e+07
 sigma[gemm] counter=14 i=2 t=1.1e-04 per=8.0e+00 cost=5.3e+03 flops=4.8e+07
 sigma[gemm] counter=14 i=3 t=1.1e-04 per=7.8e+00 cost=5.5e+03 flops=5.1e+07
 sigma[gemm] counter=14 i=4 t=1.1e-04 per=8.2e+00 cost=6.1e+03 flops=5.3e+07
 sigma[gemm] counter=14 i=5 t=1.1e-04 per=8.1e+00 cost=6.2e+03 flops=5.5e+07
 sigma[gemm] counter=14 i=6 t=1.8e-04 per=1.3e+01 cost=1.5e+04 flops=8.1e+07
 sigma[gemm] counter=14 i=7 t=1.6e-04 per=1.2e+01 cost=1.5e+04 flops=9.1e+07
 sigma[gemm] counter=14 total t=1.0e-03 per=7.4e+01 cost=6.5e+04 flops=6.3e+07
 sigma[red] counter=14 t=2.5e-04 per=1.8e+01 cost=2.0e+04 flops=8.0e+07
--- TIMING FOR sigma_tot : t_inter=3.5e-03 t_gemm=3.0e-02 t_reduction=4.0e-03 tot=3.7e-02 ---
 sigma_tot[inter] counter=14 t=3.5e-03 per=9.5e+00 cost=1.2e+06 flops=3.5e+08
 sigma_tot[gemm] counter=14 i=0 t=3.3e-03 per=9.0e+00 cost=4.0e+05 flops=1.2e+08
 sigma_tot[gemm] counter=14 i=1 t=3.0e-03 per=8.0e+00 cost=4.0e+05 flops=1.3e+08
 sigma_tot[gemm] counter=14 i=2 t=2.8e-03 per=7.4e+00 cost=3.7e+05 flops=1.3e+08
 sigma_tot[gemm] counter=14 i=3 t=2.8e-03 per=7.4e+00 cost=3.7e+05 flops=1.3e+08
 sigma_tot[gemm] counter=14 i=4 t=5.4e-03 per=1.5e+01 cost=1.4e+06 flops=2.6e+08
 sigma_tot[gemm] counter=14 i=5 t=4.4e-03 per=1.2e+01 cost=1.4e+06 flops=3.2e+08
 sigma_tot[gemm] counter=14 i=6 t=4.0e-03 per=1.1e+01 cost=6.9e+05 flops=1.7e+08
 sigma_tot[gemm] counter=14 i=7 t=4.0e-03 per=1.1e+01 cost=6.9e+05 flops=1.7e+08
 sigma_tot[gemm] counter=14 total t=3.0e-02 per=8.0e+01 cost=5.8e+06 flops=1.9e+08
 sigma_tot[red] counter=14 t=4.0e-03 per=1.1e+01 cost=1.4e+06 flops=3.4e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.6e-05,3.4e-06,1.3e-06,2.0e-07
    5   0 -      -3.231652121531 -2.278e-06  8.446e-04    3     5  3.656e-02 7.311e-03 1.444e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.152e-05,1.141e-04,9.763e-04,2.220e-04,1.339e-03
 ndim=84:6.258e-07GB t[comm(intra)]=2.152e-05 speed=5.815e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=9.7e-04 t_reduction=2.2e-04 tot=1.3e-03 ---
 sigma[inter] counter=15 t=1.1e-04 per=8.7e+00 cost=2.5e+04 flops=2.2e+08
 sigma[gemm] counter=15 i=0 t=1.2e-04 per=9.0e+00 cost=6.1e+03 flops=5.1e+07
 sigma[gemm] counter=15 i=1 t=1.1e-04 per=8.7e+00 cost=6.1e+03 flops=5.4e+07
 sigma[gemm] counter=15 i=2 t=1.2e-04 per=9.3e+00 cost=5.3e+03 flops=4.4e+07
 sigma[gemm] counter=15 i=3 t=1.1e-04 per=8.2e+00 cost=5.5e+03 flops=5.1e+07
 sigma[gemm] counter=15 i=4 t=1.2e-04 per=9.3e+00 cost=6.1e+03 flops=5.0e+07
 sigma[gemm] counter=15 i=5 t=1.0e-04 per=7.8e+00 cost=6.2e+03 flops=6.0e+07
 sigma[gemm] counter=15 i=6 t=1.5e-04 per=1.1e+01 cost=1.5e+04 flops=1.0e+08
 sigma[gemm] counter=15 i=7 t=1.4e-04 per=1.1e+01 cost=1.5e+04 flops=1.0e+08
 sigma[gemm] counter=15 total t=9.7e-04 per=7.4e+01 cost=6.5e+04 flops=6.6e+07
 sigma[red] counter=15 t=2.2e-04 per=1.7e+01 cost=2.0e+04 flops=9.0e+07
--- TIMING FOR sigma_tot : t_inter=3.7e-03 t_gemm=3.1e-02 t_reduction=4.2e-03 tot=3.9e-02 ---
 sigma_tot[inter] counter=15 t=3.7e-03 per=9.5e+00 cost=1.3e+06 flops=3.5e+08
 sigma_tot[gemm] counter=15 i=0 t=3.5e-03 per=9.0e+00 cost=4.0e+05 flops=1.2e+08
 sigma_tot[gemm] counter=15 i=1 t=3.1e-03 per=8.0e+00 cost=4.1e+05 flops=1.3e+08
 sigma_tot[gemm] counter=15 i=2 t=2.9e-03 per=7.5e+00 cost=3.7e+05 flops=1.3e+08
 sigma_tot[gemm] counter=15 i=3 t=2.9e-03 per=7.4e+00 cost=3.7e+05 flops=1.3e+08
 sigma_tot[gemm] counter=15 i=4 t=5.6e-03 per=1.4e+01 cost=1.4e+06 flops=2.6e+08
 sigma_tot[gemm] counter=15 i=5 t=4.5e-03 per=1.2e+01 cost=1.4e+06 flops=3.1e+08
 sigma_tot[gemm] counter=15 i=6 t=4.2e-03 per=1.1e+01 cost=7.0e+05 flops=1.7e+08
 sigma_tot[gemm] counter=15 i=7 t=4.1e-03 per=1.1e+01 cost=7.0e+05 flops=1.7e+08
 sigma_tot[gemm] counter=15 total t=3.1e-02 per=8.0e+01 cost=5.8e+06 flops=1.9e+08
 sigma_tot[red] counter=15 t=4.2e-03 per=1.1e+01 cost=1.4e+06 flops=3.3e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.5e-05,3.3e-06,1.3e-06,2.5e-07
    6   0 -      -3.231652621236 -4.997e-07  4.359e-04    3     6  4.300e-02 7.167e-03 1.457e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.217e-05,1.148e-04,9.742e-04,2.480e-04,1.365e-03
 ndim=84:6.258e-07GB t[comm(intra)]=2.217e-05 speed=5.646e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=9.7e-04 t_reduction=2.5e-04 tot=1.3e-03 ---
 sigma[inter] counter=16 t=1.1e-04 per=8.6e+00 cost=2.5e+04 flops=2.2e+08
 sigma[gemm] counter=16 i=0 t=1.2e-04 per=8.9e+00 cost=6.1e+03 flops=5.1e+07
 sigma[gemm] counter=16 i=1 t=1.3e-04 per=9.6e+00 cost=6.1e+03 flops=4.8e+07
 sigma[gemm] counter=16 i=2 t=1.1e-04 per=8.0e+00 cost=5.3e+03 flops=5.0e+07
 sigma[gemm] counter=16 i=3 t=1.1e-04 per=8.0e+00 cost=5.5e+03 flops=5.2e+07
 sigma[gemm] counter=16 i=4 t=1.2e-04 per=8.7e+00 cost=6.1e+03 flops=5.2e+07
 sigma[gemm] counter=16 i=5 t=1.0e-04 per=7.7e+00 cost=6.2e+03 flops=6.0e+07
 sigma[gemm] counter=16 i=6 t=1.5e-04 per=1.1e+01 cost=1.5e+04 flops=9.9e+07
 sigma[gemm] counter=16 i=7 t=1.5e-04 per=1.1e+01 cost=1.5e+04 flops=1.0e+08
 sigma[gemm] counter=16 total t=9.7e-04 per=7.3e+01 cost=6.5e+04 flops=6.7e+07
 sigma[red] counter=16 t=2.5e-04 per=1.9e+01 cost=2.0e+04 flops=8.1e+07
--- TIMING FOR sigma_tot : t_inter=3.8e-03 t_gemm=3.2e-02 t_reduction=4.5e-03 tot=4.0e-02 ---
 sigma_tot[inter] counter=16 t=3.8e-03 per=9.4e+00 cost=1.3e+06 flops=3.4e+08
 sigma_tot[gemm] counter=16 i=0 t=3.6e-03 per=9.0e+00 cost=4.1e+05 flops=1.1e+08
 sigma_tot[gemm] counter=16 i=1 t=3.2e-03 per=8.1e+00 cost=4.1e+05 flops=1.3e+08
 sigma_tot[gemm] counter=16 i=2 t=3.0e-03 per=7.5e+00 cost=3.8e+05 flops=1.3e+08
 sigma_tot[gemm] counter=16 i=3 t=3.0e-03 per=7.4e+00 cost=3.8e+05 flops=1.3e+08
 sigma_tot[gemm] counter=16 i=4 t=5.7e-03 per=1.4e+01 cost=1.4e+06 flops=2.5e+08
 sigma_tot[gemm] counter=16 i=5 t=4.6e-03 per=1.2e+01 cost=1.4e+06 flops=3.1e+08
 sigma_tot[gemm] counter=16 i=6 t=4.3e-03 per=1.1e+01 cost=7.2e+05 flops=1.7e+08
 sigma_tot[gemm] counter=16 i=7 t=4.3e-03 per=1.1e+01 cost=7.2e+05 flops=1.7e+08
 sigma_tot[gemm] counter=16 total t=3.2e-02 per=7.9e+01 cost=5.9e+06 flops=1.9e+08
 sigma_tot[red] counter=16 t=4.5e-03 per=1.1e+01 cost=1.4e+06 flops=3.2e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.6e-05,3.3e-06,1.2e-06,2.2e-07
    7   0 -      -3.231652811321 -1.901e-07  2.805e-04    3     7  5.216e-02 7.452e-03 1.469e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.143e-05,1.041e-04,8.458e-04,1.959e-04,1.173e-03
 ndim=84:6.258e-07GB t[comm(intra)]=2.143e-05 speed=5.842e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=8.4e-04 t_reduction=2.0e-04 tot=1.1e-03 ---
 sigma[inter] counter=17 t=1.0e-04 per=9.1e+00 cost=2.5e+04 flops=2.4e+08
 sigma[gemm] counter=17 i=0 t=1.0e-04 per=8.8e+00 cost=6.1e+03 flops=6.0e+07
 sigma[gemm] counter=17 i=1 t=9.9e-05 per=8.7e+00 cost=6.1e+03 flops=6.2e+07
 sigma[gemm] counter=17 i=2 t=9.2e-05 per=8.0e+00 cost=5.3e+03 flops=5.8e+07
 sigma[gemm] counter=17 i=3 t=9.1e-05 per=7.9e+00 cost=5.5e+03 flops=6.1e+07
 sigma[gemm] counter=17 i=4 t=9.7e-05 per=8.5e+00 cost=6.1e+03 flops=6.2e+07
 sigma[gemm] counter=17 i=5 t=1.2e-04 per=1.1e+01 cost=6.2e+03 flops=5.1e+07
 sigma[gemm] counter=17 i=6 t=1.2e-04 per=1.1e+01 cost=1.5e+04 flops=1.2e+08
 sigma[gemm] counter=17 i=7 t=1.2e-04 per=1.1e+01 cost=1.5e+04 flops=1.2e+08
 sigma[gemm] counter=17 total t=8.4e-04 per=7.4e+01 cost=6.5e+04 flops=7.7e+07
 sigma[red] counter=17 t=2.0e-04 per=1.7e+01 cost=2.0e+04 flops=1.0e+08
--- TIMING FOR sigma_tot : t_inter=3.9e-03 t_gemm=3.3e-02 t_reduction=4.7e-03 tot=4.1e-02 ---
 sigma_tot[inter] counter=17 t=3.9e-03 per=9.4e+00 cost=1.3e+06 flops=3.4e+08
 sigma_tot[gemm] counter=17 i=0 t=3.7e-03 per=9.0e+00 cost=4.2e+05 flops=1.1e+08
 sigma_tot[gemm] counter=17 i=1 t=3.3e-03 per=8.1e+00 cost=4.2e+05 flops=1.3e+08
 sigma_tot[gemm] counter=17 i=2 t=3.1e-03 per=7.5e+00 cost=3.8e+05 flops=1.2e+08
 sigma_tot[gemm] counter=17 i=3 t=3.1e-03 per=7.5e+00 cost=3.8e+05 flops=1.2e+08
 sigma_tot[gemm] counter=17 i=4 t=5.8e-03 per=1.4e+01 cost=1.4e+06 flops=2.5e+08
 sigma_tot[gemm] counter=17 i=5 t=4.8e-03 per=1.2e+01 cost=1.4e+06 flops=3.0e+08
 sigma_tot[gemm] counter=17 i=6 t=4.4e-03 per=1.1e+01 cost=7.3e+05 flops=1.6e+08
 sigma_tot[gemm] counter=17 i=7 t=4.4e-03 per=1.1e+01 cost=7.3e+05 flops=1.7e+08
 sigma_tot[gemm] counter=17 total t=3.3e-02 per=7.9e+01 cost=6.0e+06 flops=1.8e+08
 sigma_tot[red] counter=17 t=4.7e-03 per=1.1e+01 cost=1.4e+06 flops=3.1e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.5e-05,3.1e-06,1.1e-06,1.7e-07
    8   0 -      -3.231652893932 -8.261e-08  2.178e-04    3     8  6.554e-02 8.192e-03 1.450e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.204e-05,1.169e-04,9.775e-04,2.257e-04,1.348e-03
 ndim=84:6.258e-07GB t[comm(intra)]=2.204e-05 speed=5.678e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=9.8e-04 t_reduction=2.3e-04 tot=1.3e-03 ---
 sigma[inter] counter=18 t=1.2e-04 per=8.9e+00 cost=2.5e+04 flops=2.2e+08
 sigma[gemm] counter=18 i=0 t=1.2e-04 per=9.0e+00 cost=6.1e+03 flops=5.1e+07
 sigma[gemm] counter=18 i=1 t=1.2e-04 per=8.7e+00 cost=6.1e+03 flops=5.3e+07
 sigma[gemm] counter=18 i=2 t=1.1e-04 per=8.1e+00 cost=5.3e+03 flops=5.0e+07
 sigma[gemm] counter=18 i=3 t=1.1e-04 per=8.2e+00 cost=5.5e+03 flops=5.1e+07
 sigma[gemm] counter=18 i=4 t=1.4e-04 per=1.1e+01 cost=6.1e+03 flops=4.4e+07
 sigma[gemm] counter=18 i=5 t=1.0e-04 per=7.7e+00 cost=6.2e+03 flops=6.1e+07
 sigma[gemm] counter=18 i=6 t=1.4e-04 per=1.1e+01 cost=1.5e+04 flops=1.0e+08
 sigma[gemm] counter=18 i=7 t=1.4e-04 per=1.1e+01 cost=1.5e+04 flops=1.0e+08
 sigma[gemm] counter=18 total t=9.8e-04 per=7.4e+01 cost=6.5e+04 flops=6.6e+07
 sigma[red] counter=18 t=2.3e-04 per=1.7e+01 cost=2.0e+04 flops=8.9e+07
--- TIMING FOR sigma_tot : t_inter=4.0e-03 t_gemm=3.3e-02 t_reduction=4.9e-03 tot=4.2e-02 ---
 sigma_tot[inter] counter=18 t=4.0e-03 per=9.4e+00 cost=1.3e+06 flops=3.4e+08
 sigma_tot[gemm] counter=18 i=0 t=3.8e-03 per=9.0e+00 cost=4.2e+05 flops=1.1e+08
 sigma_tot[gemm] counter=18 i=1 t=3.4e-03 per=8.1e+00 cost=4.3e+05 flops=1.2e+08
 sigma_tot[gemm] counter=18 i=2 t=3.2e-03 per=7.5e+00 cost=3.9e+05 flops=1.2e+08
 sigma_tot[gemm] counter=18 i=3 t=3.2e-03 per=7.5e+00 cost=3.9e+05 flops=1.2e+08
 sigma_tot[gemm] counter=18 i=4 t=5.9e-03 per=1.4e+01 cost=1.5e+06 flops=2.5e+08
 sigma_tot[gemm] counter=18 i=5 t=4.9e-03 per=1.1e+01 cost=1.4e+06 flops=3.0e+08
 sigma_tot[gemm] counter=18 i=6 t=4.6e-03 per=1.1e+01 cost=7.5e+05 flops=1.6e+08
 sigma_tot[gemm] counter=18 i=7 t=4.5e-03 per=1.1e+01 cost=7.5e+05 flops=1.6e+08
 sigma_tot[gemm] counter=18 total t=3.3e-02 per=7.9e+01 cost=6.0e+06 flops=1.8e+08
 sigma_tot[red] counter=18 t=4.9e-03 per=1.2e+01 cost=1.5e+06 flops=3.0e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.6e-05,3.4e-06,1.3e-06,2.4e-07
    9   0 -      -3.231652933009 -3.908e-08  1.039e-04    3     9  7.181e-02 7.978e-03 1.457e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.320e-05,1.060e-04,8.655e-04,2.159e-04,1.218e-03
 ndim=84:6.258e-07GB t[comm(intra)]=2.320e-05 speed=5.396e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=8.6e-04 t_reduction=2.2e-04 tot=1.2e-03 ---
 sigma[inter] counter=19 t=1.1e-04 per=8.9e+00 cost=2.5e+04 flops=2.4e+08
 sigma[gemm] counter=19 i=0 t=1.0e-04 per=8.5e+00 cost=6.1e+03 flops=6.0e+07
 sigma[gemm] counter=19 i=1 t=9.8e-05 per=8.2e+00 cost=6.1e+03 flops=6.3e+07
 sigma[gemm] counter=19 i=2 t=9.4e-05 per=7.9e+00 cost=5.3e+03 flops=5.7e+07
 sigma[gemm] counter=19 i=3 t=9.3e-05 per=7.8e+00 cost=5.5e+03 flops=5.9e+07
 sigma[gemm] counter=19 i=4 t=9.6e-05 per=8.1e+00 cost=6.1e+03 flops=6.3e+07
 sigma[gemm] counter=19 i=5 t=9.7e-05 per=8.1e+00 cost=6.2e+03 flops=6.4e+07
 sigma[gemm] counter=19 i=6 t=1.4e-04 per=1.2e+01 cost=1.5e+04 flops=1.1e+08
 sigma[gemm] counter=19 i=7 t=1.5e-04 per=1.3e+01 cost=1.5e+04 flops=9.9e+07
 sigma[gemm] counter=19 total t=8.6e-04 per=7.3e+01 cost=6.5e+04 flops=7.5e+07
 sigma[red] counter=19 t=2.2e-04 per=1.8e+01 cost=2.0e+04 flops=9.3e+07
--- TIMING FOR sigma_tot : t_inter=4.1e-03 t_gemm=3.4e-02 t_reduction=5.1e-03 tot=4.4e-02 ---
 sigma_tot[inter] counter=19 t=4.1e-03 per=9.4e+00 cost=1.4e+06 flops=3.4e+08
 sigma_tot[gemm] counter=19 i=0 t=3.9e-03 per=8.9e+00 cost=4.3e+05 flops=1.1e+08
 sigma_tot[gemm] counter=19 i=1 t=3.5e-03 per=8.1e+00 cost=4.3e+05 flops=1.2e+08
 sigma_tot[gemm] counter=19 i=2 t=3.3e-03 per=7.5e+00 cost=3.9e+05 flops=1.2e+08
 sigma_tot[gemm] counter=19 i=3 t=3.3e-03 per=7.5e+00 cost=3.9e+05 flops=1.2e+08
 sigma_tot[gemm] counter=19 i=4 t=6.0e-03 per=1.4e+01 cost=1.5e+06 flops=2.4e+08
 sigma_tot[gemm] counter=19 i=5 t=5.0e-03 per=1.1e+01 cost=1.5e+06 flops=2.9e+08
 sigma_tot[gemm] counter=19 i=6 t=4.7e-03 per=1.1e+01 cost=7.6e+05 flops=1.6e+08
 sigma_tot[gemm] counter=19 i=7 t=4.7e-03 per=1.1e+01 cost=7.6e+05 flops=1.6e+08
 sigma_tot[gemm] counter=19 total t=3.4e-02 per=7.9e+01 cost=6.1e+06 flops=1.8e+08
 sigma_tot[red] counter=19 t=5.1e-03 per=1.2e+01 cost=1.5e+06 flops=2.9e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.6e-05,3.2e-06,1.1e-06,2.0e-07
   10   0 +      -3.231652941021 -8.012e-09  4.959e-05    3    10  8.531e-02 8.531e-03 1.447e-03
TIMING FOR Davidson : 8.532e-02  T(cal/comm/rest)=1.447e-02,1.143e-06,7.085e-02
decomposed t_rest=7.085e-02
 T(sub)    =2.267e-04 per=3.200e-01
 T(precond)=7.024e-02 per=9.915e+01
 T(ortho)  =6.185e-05 per=8.730e-02
 T(xcopy)  =1.315e-06 per=1.856e-03
 T(xnrm2)  =4.922e-06 per=6.948e-03
 T(other)  =3.068e-04 per=4.331e-01
optimized energies: isweep=0 ibond=2 dots=2 e[0]=-3.231652941021 nmvp=10
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:9.222e+01S Sys:1.286e+00S Total:9.351e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=11 dimAll=40
 (3,1):4 (5,1):5 (4,2):3 (4,0):9 (3,-1):4 (5,-1):6 (4,-2):4 (6,0):2 (2,0):1 (6,-2):1 (5,-3):1
timing for divide=1.4e-05
timing for compute=3.8e-04
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(nkr): 4.1e-04 S T(divide/compute/collect)=1.4e-05,3.8e-04,1.6e-05 -----
decimation summary: 40->10 dwt=+7.947e-04 SvN=7.943e-01
 qbond: qkept nsym=8 dimAll=10
 (4,0):3 (3,1):1 (5,1):1 (4,2):1 (3,-1):1 (5,-1):1 (4,-2):1 (2,0):1
----- TIMING for decimation_row(nkr): 7.620e-04 S T(decim/select/formRot)=4.786e-04,2.554e-04,2.796e-05 -----
----- TIMING FOR twodot_decimation: 9.466e-04 S T(wf/decim)=1.706e-04,7.760e-04 -----
ctns::oper_renorm coord=(3,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:8 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:9.241e+01S Sys:1.287e+00S Total:9.370e+01S
----- TIMING FOR symbolic_formulae_renorm with size=29 : 1.042e-03 S -----
rank=0 GPUmem(GB): used=1.22e-05 (oper)=7.76e-06
rank=0 GPUmem(GB): used=1.26e-05 (oper,site)(GB)=7.76e-06,4.02e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=29
 no. of rintermediate operators=58
 no. of coefficients=174:0.00133MB:1.3e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 9.544e-05 S -----
rank=0 GPUmem(GB): used=1.39e-05 (oper,site,rinter)=7.76e-06,4.02e-07,1.3e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0014 S size(rtasks)=29 size(Rlst2)=64 T(Rmu/Rlist)=0.000332,0.00107 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00151 S size(rtasks)=29 size(Rlst)=945 -----
rank=0 GPUmem(GB): used=1.39e-05 (oper,site,rinter,batch)=7.76e-06,4.02e-07,1.3e-06,0.000176 blksize=9 blksize0=6 batchsize=945
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.03e-05,0.000677,0.000204
--- TIMING FOR renorm : t_inter=9.0e-05 t_gemm=6.8e-04 t_reduction=2.0e-04 tot=9.7e-04 ---
 renorm[inter] counter=3 t=9.0e-05 per=9.3e+00 cost=6.8e+03 flops=7.6e+07
 renorm[gemm] counter=3 i=0 t=8.3e-05 per=8.6e+00 cost=1.9e+03 flops=2.3e+07
 renorm[gemm] counter=3 i=1 t=8.2e-05 per=8.4e+00 cost=3.0e+03 flops=3.7e+07
 renorm[gemm] counter=3 i=2 t=1.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=3 t=1.1e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=4 t=1.8e-04 per=1.9e+01 cost=4.8e+03 flops=2.7e+07
 renorm[gemm] counter=3 i=5 t=1.7e-04 per=1.8e+01 cost=6.2e+03 flops=3.6e+07
 renorm[gemm] counter=3 i=6 t=1.5e-04 per=1.6e+01 cost=1.2e+04 flops=7.6e+07
 renorm[gemm] counter=3 total t=6.8e-04 per=7.0e+01 cost=2.8e+04 flops=4.1e+07
 renorm[red] counter=3 t=2.0e-04 per=2.1e+01 cost=5.4e+03 flops=2.6e+07
--- TIMING FOR renorm_tot : t_inter=2.0e-04 t_gemm=1.7e-03 t_reduction=5.5e-04 tot=2.4e-03 ---
 renorm_tot[inter] counter=3 t=2.0e-04 per=8.2e+00 cost=1.2e+04 flops=6.0e+07
 renorm_tot[gemm] counter=3 i=0 t=2.5e-04 per=1.0e+01 cost=5.8e+03 flops=2.3e+07
 renorm_tot[gemm] counter=3 i=1 t=2.3e-04 per=9.5e+00 cost=9.1e+03 flops=3.9e+07
 renorm_tot[gemm] counter=3 i=2 t=3.4e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=3 t=3.1e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=4 t=3.9e-04 per=1.6e+01 cost=1.1e+04 flops=2.9e+07
 renorm_tot[gemm] counter=3 i=5 t=3.7e-04 per=1.5e+01 cost=1.5e+04 flops=3.9e+07
 renorm_tot[gemm] counter=3 i=6 t=4.4e-04 per=1.8e+01 cost=4.1e+04 flops=9.2e+07
 renorm_tot[gemm] counter=3 total t=1.7e-03 per=6.9e+01 cost=8.2e+04 flops=4.8e+07
 renorm_tot[red] counter=3 t=5.5e-04 per=2.2e+01 cost=2.5e+04 flops=4.6e+07
qops.to_cpu: size(tot)=276:2.1e-03MB:2.1e-06GB t[to_cpu]=1.4e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=6.736e-16 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0105 S rank=0 -----
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:9.254e+01S Sys:1.287e+00S Total:9.383e+01S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=176:1.343e-03MB:1.311e-06GB
 rwfuns: len=2 mem=4:3.052e-05MB:2.980e-08GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=245:1.869e-03MB:1.825e-06GB
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:9.254e+01S Sys:1.287e+00S Total:9.383e+01S
##### local opt: 1.367e-01 S #####
 T(local opt: fetch) = 2.189e-04 S  per = 0.16  per(accum) = 0.16
 T(local opt: hdiag) = 5.470e-04 S  per =  0.4  per(accum) = 0.56
 T(local opt: dvdsn) = 1.240e-01 S  per = 90.7  per(accum) = 91.3
 T(local opt: decim) = 9.553e-04 S  per = 0.699  per(accum) = 92
 T(local opt: guess) = 2.087e-04 S  per = 0.153  per(accum) = 92.1
 T(local opt: renrm) = 1.075e-02 S  per = 7.86  per(accum) = 100
 T(local opt: save ) = 4.709e-05 S  per = 0.0344  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.240e-01 S  T(sum) = 1.237e-01 S  per = 9.981e+01
 T(local opt: preprocess                  ) = 4.108e-04 S  per = 0.332  per(accum) = 0.332
 T(local opt: symbolic_formulae           ) = 1.941e-03 S  per = 1.57  per(accum) = 1.9
 T(local opt: hintermediate init          ) = 8.747e-05 S  per = 0.0707  per(accum) = 1.97
 T(local opt: preprocess_hformulae_Hxlist ) = 6.442e-03 S  per = 5.21  per(accum) = 7.18
 T(local opt: hmmtasks init               ) = 2.937e-02 S  per = 23.7  per(accum) = 30.9
 T(local opt: initial guess for dvdson    ) = 1.611e-04 S  per = 0.13  per(accum) = 31
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.425e-02 S  per = 11.5  per(accum) = 42.6
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.225e-04 S  per = 0.18  per(accum) = 42.7
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.143e-06 S  per = 0.000924  per(accum) = 42.7
 T(local opt: dvdson solver [rest part]   ) = 7.085e-02 S  per = 57.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.075e-02 S  T(sum) = 1.075e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 8.351e-05 S  per = 0.777  per(accum) = 0.777
 T(local opt: qops init                    ) = 5.686e-04 S  per = 5.29  per(accum) = 6.07
 T(local opt: symbolic_formulae_renorm     ) = 1.051e-03 S  per = 9.78  per(accum) = 15.8
 T(local opt: allocate qops on gpu         ) = 2.213e-05 S  per = 0.206  per(accum) = 16.1
 T(local opt: site memcpy cpu2gpu          ) = 1.833e-05 S  per = 0.171  per(accum) = 16.2
 T(local opt: rintermediate init           ) = 1.050e-04 S  per = 0.977  per(accum) = 17.2
 T(local opt: preprocess_formulae_Rlist2   ) = 1.544e-03 S  per = 14.4  per(accum) = 31.6
 T(local opt: rmmtasks init                ) = 6.014e-03 S  per =   56  per(accum) = 87.5
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 0.000307  per(accum) = 87.5
 T(local opt: preprocess_renorm_batchGPU   ) = 1.078e-03 S  per =   10  per(accum) = 97.6
 T(local opt: reduction of opS & opH [nccl]) = 1.125e-06 S  per = 0.0105  per(accum) = 97.6
 T(local opt: qops memcpy gpu2cpu          ) = 1.973e-05 S  per = 0.184  per(accum) = 97.8
 T(local opt: deallocate cpu and gpu memory) = 1.121e-05 S  per = 0.104  per(accum) = 97.9
 T(local opt: reduction of opS & opH [comm]) = 2.609e-05 S  per = 0.243  per(accum) = 98.1
 T(local opt: conversion from opAB to opPQ ) = 3.801e-06 S  per = 0.0354  per(accum) = 98.1
 T(local opt: after oper_renorm            ) = 2.007e-04 S  per = 1.87  per(accum) = 100
##### sweep opt: 6.719e-01 S #####
 T(sweep opt: fetch) = 3.921e-03 S  per = 0.584  per(accum) = 0.584
 T(sweep opt: hdiag) = 2.906e-03 S  per = 0.433  per(accum) = 1.02
 T(sweep opt: dvdsn) = 4.831e-01 S  per = 71.9  per(accum) = 72.9
 T(sweep opt: decim) = 2.617e-03 S  per = 0.39  per(accum) = 73.3
 T(sweep opt: guess) = 1.010e-03 S  per = 0.15  per(accum) = 73.5
 T(sweep opt: renrm) = 1.777e-01 S  per = 26.4  per(accum) = 99.9
 T(sweep opt: save ) = 6.056e-04 S  per = 0.0901  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.831e-01 S  T(sum) = 4.823e-01 S  per = 9.983e+01
 T(sweep opt: preprocess                  ) = 2.731e-03 S  per = 0.566  per(accum) = 0.566
 T(sweep opt: symbolic_formulae           ) = 7.221e-03 S  per =  1.5  per(accum) = 2.06
 T(sweep opt: hintermediate init          ) = 3.232e-04 S  per = 0.067  per(accum) = 2.13
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.890e-02 S  per = 10.1  per(accum) = 12.3
 T(sweep opt: hmmtasks init               ) = 2.601e-01 S  per = 53.9  per(accum) = 66.2
 T(sweep opt: initial guess for dvdson    ) = 7.896e-04 S  per = 0.164  per(accum) = 66.4
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 4.677e-02 S  per =  9.7  per(accum) = 76.1
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.360e-04 S  per = 0.0904  per(accum) = 76.1
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.174e-06 S  per = 0.000451  per(accum) = 76.1
 T(sweep opt: dvdson solver [rest part]   ) = 1.151e-01 S  per = 23.9  per(accum) = 100
Detailed decomposition of T(renrm) = 1.777e-01 S  T(sum) = 1.777e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.749e-04 S  per = 0.155  per(accum) = 0.155
 T(sweep opt: qops init                    ) = 1.346e-03 S  per = 0.757  per(accum) = 0.912
 T(sweep opt: symbolic_formulae_renorm     ) = 3.263e-03 S  per = 1.84  per(accum) = 2.75
 T(sweep opt: allocate qops on gpu         ) = 6.803e-05 S  per = 0.0383  per(accum) = 2.79
 T(sweep opt: site memcpy cpu2gpu          ) = 7.169e-05 S  per = 0.0403  per(accum) = 2.83
 T(sweep opt: rintermediate init           ) = 2.885e-04 S  per = 0.162  per(accum) = 2.99
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.047e-03 S  per = 2.84  per(accum) = 5.83
 T(sweep opt: rmmtasks init                ) = 1.996e-02 S  per = 11.2  per(accum) = 17.1
 T(sweep opt: qops memset on cpu           ) = 1.540e-07 S  per = 8.67e-05  per(accum) = 17.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.756e-03 S  per = 1.55  per(accum) = 18.6
 T(sweep opt: reduction of opS & opH [nccl]) = 3.321e-06 S  per = 0.00187  per(accum) = 18.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.074e-05 S  per = 0.0342  per(accum) = 18.7
 T(sweep opt: deallocate cpu and gpu memory) = 3.353e-05 S  per = 0.0189  per(accum) = 18.7
 T(sweep opt: reduction of opS & opH [comm]) = 7.348e-05 S  per = 0.0414  per(accum) = 18.7
 T(sweep opt: conversion from opAB to opPQ ) = 1.437e-01 S  per = 80.9  per(accum) = 99.6
 T(sweep opt: after oper_renorm            ) = 7.212e-04 S  per = 0.406  per(accum) = 100
##### global opt: 6.719e-01 S #####
 T(global opt: fetch) = 3.921e-03 S  per = 0.584  per(accum) = 0.584
 T(global opt: hdiag) = 2.906e-03 S  per = 0.433  per(accum) = 1.02
 T(global opt: dvdsn) = 4.831e-01 S  per = 71.9  per(accum) = 72.9
 T(global opt: decim) = 2.617e-03 S  per = 0.39  per(accum) = 73.3
 T(global opt: guess) = 1.010e-03 S  per = 0.15  per(accum) = 73.5
 T(global opt: renrm) = 1.777e-01 S  per = 26.4  per(accum) = 99.9
 T(global opt: save ) = 6.056e-04 S  per = 0.0901  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.831e-01 S  T(sum) = 4.823e-01 S  per = 9.983e+01
 T(global opt: preprocess                  ) = 2.731e-03 S  per = 0.566  per(accum) = 0.566
 T(global opt: symbolic_formulae           ) = 7.221e-03 S  per =  1.5  per(accum) = 2.06
 T(global opt: hintermediate init          ) = 3.232e-04 S  per = 0.067  per(accum) = 2.13
 T(global opt: preprocess_hformulae_Hxlist ) = 4.890e-02 S  per = 10.1  per(accum) = 12.3
 T(global opt: hmmtasks init               ) = 2.601e-01 S  per = 53.9  per(accum) = 66.2
 T(global opt: initial guess for dvdson    ) = 7.896e-04 S  per = 0.164  per(accum) = 66.4
 T(global opt: dvdson solver [Hx_batchGPU] ) = 4.677e-02 S  per =  9.7  per(accum) = 76.1
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.360e-04 S  per = 0.0904  per(accum) = 76.1
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.174e-06 S  per = 0.000451  per(accum) = 76.1
 T(global opt: dvdson solver [rest part]   ) = 1.151e-01 S  per = 23.9  per(accum) = 100
Detailed decomposition of T(renrm) = 1.777e-01 S  T(sum) = 1.777e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.749e-04 S  per = 0.155  per(accum) = 0.155
 T(global opt: qops init                    ) = 1.346e-03 S  per = 0.757  per(accum) = 0.912
 T(global opt: symbolic_formulae_renorm     ) = 3.263e-03 S  per = 1.84  per(accum) = 2.75
 T(global opt: allocate qops on gpu         ) = 6.803e-05 S  per = 0.0383  per(accum) = 2.79
 T(global opt: site memcpy cpu2gpu          ) = 7.169e-05 S  per = 0.0403  per(accum) = 2.83
 T(global opt: rintermediate init           ) = 2.885e-04 S  per = 0.162  per(accum) = 2.99
 T(global opt: preprocess_formulae_Rlist2   ) = 5.047e-03 S  per = 2.84  per(accum) = 5.83
 T(global opt: rmmtasks init                ) = 1.996e-02 S  per = 11.2  per(accum) = 17.1
 T(global opt: qops memset on cpu           ) = 1.540e-07 S  per = 8.67e-05  per(accum) = 17.1
 T(global opt: preprocess_renorm_batchGPU   ) = 2.756e-03 S  per = 1.55  per(accum) = 18.6
 T(global opt: reduction of opS & opH [nccl]) = 3.321e-06 S  per = 0.00187  per(accum) = 18.6
 T(global opt: qops memcpy gpu2cpu          ) = 6.074e-05 S  per = 0.0342  per(accum) = 18.7
 T(global opt: deallocate cpu and gpu memory) = 3.353e-05 S  per = 0.0189  per(accum) = 18.7
 T(global opt: reduction of opS & opH [comm]) = 7.348e-05 S  per = 0.0414  per(accum) = 18.7
 T(global opt: conversion from opAB to opPQ ) = 1.437e-01 S  per = 80.9  per(accum) = 99.6
 T(global opt: after oper_renorm            ) = 7.212e-04 S  per = 0.406  per(accum) = 100

isweep=0 ibond=3/seqsize=6 dots=2 dbond=(3,0)-(4,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:9.254e+01S Sys:1.288e+00S Total:9.383e+01S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=176:1.343e-03MB:1.311e-06GB
 rwfuns: len=2 mem=4:3.052e-05MB:2.980e-08GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=245:1.869e-03MB:1.825e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=3,1,1,1
 suppl= 0 1 2
 suppr= 5
 suppc1= 3
 suppc2= 4
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:6 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=10,10 size(op)=24:1.831e-04MB size(tot)=558:4.257e-03MB:4.157e-06GB
 rqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 c1qops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 c2qops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 qops(tot)=1182:9.018e-03MB:8.807e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(4,0) fdel=./scratch/sweep/lop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
wf4(diml,dimr,dimc1,dimc2)=(10,4,4,4) nnz=84:6.409e-04MB
qtensor4: wf4 own=1 _data=0x4e501870
qinfo4: wf4 sym=(6,0)
 qbond: qrow nsym=5 dimAll=10
 (3,1):3 (3,-1):3 (4,0):2 (2,0):1 (4,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=39 nblocks=320 size=84:6.409e-04MB
### DIAG TIMING: total=4.797e-04 t1=1.689e-05, t2=1.768e-05, t3=4.992e-05, t4=3.502e-04, t5=2.804e-05, t6=1.220e-05, t7=4.819e-06
duration_diagGPU:4.914e-04
duration_diagreduce:3.400e-08
duration_diagtransform:6.060e-07
----- TIMING FOR symbolic_formulae_twodot with size=210 : 2.249e-03 S -----
rank=0 GPUmem(GB): used=1.09e-05 (oper)=8.81e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=210
 no. of hintermediate operators=58
 no. of coefficients=174:0.00133MB:1.3e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 8.070e-05 S -----
rank=0 GPUmem(GB): used=1.22e-05 (oper,hinter)=8.81e-06,1.3e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00586 S size(H_formulae)=210 size(Hxlst2)=39 T(Hmu/Hxlist)=0.000499,0.00536 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00626 S size(H_formulae)=210 size(Hxlst)=4562 -----
rank=0 GPUmem(GB): used=0.000455 (oper,hinter,dvdson,batch)=8.81e-06,1.3e-06,1.25e-06,0.000442 blksize=3 blksize0=6 batchsize=4562
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=84 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.21e-05,9.19e-05,0.000733,0.00019,0.00104
 ndim=84:6.26e-07GB t[comm(intra)]=2.21e-05 speed=0.0566GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.2e-05 t_gemm=7.3e-04 t_reduction=1.9e-04 tot=1.0e-03 ---
 sigma[inter] counter=20 t=9.2e-05 per=9.0e+00 cost=2.5e+04 flops=2.8e+08
 sigma[gemm] counter=20 i=0 t=8.9e-05 per=8.8e+00 cost=6.1e+03 flops=6.8e+07
 sigma[gemm] counter=20 i=1 t=8.5e-05 per=8.4e+00 cost=6.1e+03 flops=7.2e+07
 sigma[gemm] counter=20 i=2 t=7.9e-05 per=7.8e+00 cost=5.3e+03 flops=6.7e+07
 sigma[gemm] counter=20 i=3 t=8.0e-05 per=7.9e+00 cost=5.5e+03 flops=6.9e+07
 sigma[gemm] counter=20 i=4 t=8.4e-05 per=8.3e+00 cost=6.1e+03 flops=7.2e+07
 sigma[gemm] counter=20 i=5 t=8.3e-05 per=8.2e+00 cost=6.2e+03 flops=7.4e+07
 sigma[gemm] counter=20 i=6 t=1.2e-04 per=1.1e+01 cost=1.5e+04 flops=1.3e+08
 sigma[gemm] counter=20 i=7 t=1.1e-04 per=1.1e+01 cost=1.5e+04 flops=1.3e+08
 sigma[gemm] counter=20 total t=7.3e-04 per=7.2e+01 cost=6.5e+04 flops=8.9e+07
 sigma[red] counter=20 t=1.9e-04 per=1.9e+01 cost=2.0e+04 flops=1.1e+08
--- TIMING FOR sigma_tot : t_inter=4.2e-03 t_gemm=3.5e-02 t_reduction=5.3e-03 tot=4.5e-02 ---
 sigma_tot[inter] counter=20 t=4.2e-03 per=9.4e+00 cost=1.4e+06 flops=3.3e+08
 sigma_tot[gemm] counter=20 i=0 t=4.0e-03 per=8.9e+00 cost=4.4e+05 flops=1.1e+08
 sigma_tot[gemm] counter=20 i=1 t=3.6e-03 per=8.1e+00 cost=4.4e+05 flops=1.2e+08
 sigma_tot[gemm] counter=20 i=2 t=3.4e-03 per=7.5e+00 cost=4.0e+05 flops=1.2e+08
 sigma_tot[gemm] counter=20 i=3 t=3.3e-03 per=7.5e+00 cost=4.0e+05 flops=1.2e+08
 sigma_tot[gemm] counter=20 i=4 t=6.1e-03 per=1.4e+01 cost=1.5e+06 flops=2.4e+08
 sigma_tot[gemm] counter=20 i=5 t=5.0e-03 per=1.1e+01 cost=1.5e+06 flops=2.9e+08
 sigma_tot[gemm] counter=20 i=6 t=4.8e-03 per=1.1e+01 cost=7.8e+05 flops=1.6e+08
 sigma_tot[gemm] counter=20 i=7 t=4.8e-03 per=1.1e+01 cost=7.8e+05 flops=1.6e+08
 sigma_tot[gemm] counter=20 total t=3.5e-02 per=7.9e+01 cost=6.1e+06 flops=1.8e+08
 sigma_tot[red] counter=20 t=5.3e-03 per=1.2e+01 cost=1.5e+06 flops=2.8e+08
T(sub)=8.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.0e-06,4.0e-06,1.7e-06,6.3e-07,1.8e-07
settings: ndim=84 neig=1 maxcycle=30 nbuff=4 memory=9e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.230101446747 -1.003e+03  5.674e-02    1     1  1.172e-03 1.172e-03 1.150e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.242e-05,1.191e-04,9.716e-04,2.277e-04,1.348e-03
 ndim=84:6.258e-07GB t[comm(intra)]=2.242e-05 speed=5.583e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=9.7e-04 t_reduction=2.3e-04 tot=1.3e-03 ---
 sigma[inter] counter=21 t=1.2e-04 per=9.0e+00 cost=2.5e+04 flops=2.1e+08
 sigma[gemm] counter=21 i=0 t=1.2e-04 per=9.0e+00 cost=6.1e+03 flops=5.1e+07
 sigma[gemm] counter=21 i=1 t=1.1e-04 per=8.7e+00 cost=6.1e+03 flops=5.4e+07
 sigma[gemm] counter=21 i=2 t=1.1e-04 per=8.2e+00 cost=5.3e+03 flops=4.9e+07
 sigma[gemm] counter=21 i=3 t=1.1e-04 per=8.2e+00 cost=5.5e+03 flops=5.1e+07
 sigma[gemm] counter=21 i=4 t=1.2e-04 per=8.9e+00 cost=6.1e+03 flops=5.2e+07
 sigma[gemm] counter=21 i=5 t=1.0e-04 per=7.8e+00 cost=6.2e+03 flops=6.0e+07
 sigma[gemm] counter=21 i=6 t=1.6e-04 per=1.2e+01 cost=1.5e+04 flops=9.3e+07
 sigma[gemm] counter=21 i=7 t=1.4e-04 per=1.1e+01 cost=1.5e+04 flops=1.0e+08
 sigma[gemm] counter=21 total t=9.7e-04 per=7.4e+01 cost=6.5e+04 flops=6.7e+07
 sigma[red] counter=21 t=2.3e-04 per=1.7e+01 cost=2.0e+04 flops=8.8e+07
--- TIMING FOR sigma_tot : t_inter=4.3e-03 t_gemm=3.6e-02 t_reduction=5.5e-03 tot=4.6e-02 ---
 sigma_tot[inter] counter=21 t=4.3e-03 per=9.4e+00 cost=1.4e+06 flops=3.3e+08
 sigma_tot[gemm] counter=21 i=0 t=4.1e-03 per=8.9e+00 cost=4.4e+05 flops=1.1e+08
 sigma_tot[gemm] counter=21 i=1 t=3.7e-03 per=8.1e+00 cost=4.4e+05 flops=1.2e+08
 sigma_tot[gemm] counter=21 i=2 t=3.5e-03 per=7.5e+00 cost=4.0e+05 flops=1.2e+08
 sigma_tot[gemm] counter=21 i=3 t=3.5e-03 per=7.5e+00 cost=4.0e+05 flops=1.2e+08
 sigma_tot[gemm] counter=21 i=4 t=6.2e-03 per=1.4e+01 cost=1.5e+06 flops=2.4e+08
 sigma_tot[gemm] counter=21 i=5 t=5.1e-03 per=1.1e+01 cost=1.5e+06 flops=2.8e+08
 sigma_tot[gemm] counter=21 i=6 t=5.0e-03 per=1.1e+01 cost=7.9e+05 flops=1.6e+08
 sigma_tot[gemm] counter=21 i=7 t=4.9e-03 per=1.1e+01 cost=7.9e+05 flops=1.6e+08
 sigma_tot[gemm] counter=21 total t=3.6e-02 per=7.9e+01 cost=6.2e+06 flops=1.7e+08
 sigma_tot[red] counter=21 t=5.5e-03 per=1.2e+01 cost=1.5e+06 flops=2.7e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.2e-05,4.1e-06,1.3e-06,2.0e-07
    2   0 -      -3.231531996756 -1.431e-03  1.555e-02    2     2  7.484e-03 3.742e-03 1.334e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.148e-05,1.063e-04,8.263e-04,2.168e-04,1.177e-03
 ndim=84:6.258e-07GB t[comm(intra)]=2.148e-05 speed=5.828e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=8.2e-04 t_reduction=2.2e-04 tot=1.1e-03 ---
 sigma[inter] counter=22 t=1.1e-04 per=9.2e+00 cost=2.5e+04 flops=2.4e+08
 sigma[gemm] counter=22 i=0 t=1.0e-04 per=8.8e+00 cost=6.1e+03 flops=6.0e+07
 sigma[gemm] counter=22 i=1 t=9.8e-05 per=8.5e+00 cost=6.1e+03 flops=6.3e+07
 sigma[gemm] counter=22 i=2 t=9.2e-05 per=8.0e+00 cost=5.3e+03 flops=5.8e+07
 sigma[gemm] counter=22 i=3 t=9.0e-05 per=7.9e+00 cost=5.5e+03 flops=6.1e+07
 sigma[gemm] counter=22 i=4 t=9.6e-05 per=8.4e+00 cost=6.1e+03 flops=6.3e+07
 sigma[gemm] counter=22 i=5 t=1.0e-04 per=8.9e+00 cost=6.2e+03 flops=6.1e+07
 sigma[gemm] counter=22 i=6 t=1.2e-04 per=1.1e+01 cost=1.5e+04 flops=1.2e+08
 sigma[gemm] counter=22 i=7 t=1.2e-04 per=1.1e+01 cost=1.5e+04 flops=1.2e+08
 sigma[gemm] counter=22 total t=8.2e-04 per=7.2e+01 cost=6.5e+04 flops=7.9e+07
 sigma[red] counter=22 t=2.2e-04 per=1.9e+01 cost=2.0e+04 flops=9.2e+07
--- TIMING FOR sigma_tot : t_inter=4.4e-03 t_gemm=3.7e-02 t_reduction=5.8e-03 tot=4.7e-02 ---
 sigma_tot[inter] counter=22 t=4.4e-03 per=9.4e+00 cost=1.5e+06 flops=3.3e+08
 sigma_tot[gemm] counter=22 i=0 t=4.2e-03 per=8.9e+00 cost=4.5e+05 flops=1.1e+08
 sigma_tot[gemm] counter=22 i=1 t=3.8e-03 per=8.1e+00 cost=4.5e+05 flops=1.2e+08
 sigma_tot[gemm] counter=22 i=2 t=3.6e-03 per=7.6e+00 cost=4.1e+05 flops=1.1e+08
 sigma_tot[gemm] counter=22 i=3 t=3.5e-03 per=7.5e+00 cost=4.1e+05 flops=1.2e+08
 sigma_tot[gemm] counter=22 i=4 t=6.3e-03 per=1.3e+01 cost=1.5e+06 flops=2.3e+08
 sigma_tot[gemm] counter=22 i=5 t=5.2e-03 per=1.1e+01 cost=1.5e+06 flops=2.8e+08
 sigma_tot[gemm] counter=22 i=6 t=5.1e-03 per=1.1e+01 cost=8.1e+05 flops=1.6e+08
 sigma_tot[gemm] counter=22 i=7 t=5.1e-03 per=1.1e+01 cost=8.1e+05 flops=1.6e+08
 sigma_tot[gemm] counter=22 total t=3.7e-02 per=7.8e+01 cost=6.3e+06 flops=1.7e+08
 sigma_tot[red] counter=22 t=5.8e-03 per=1.2e+01 cost=1.5e+06 flops=2.7e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.5e-05,3.2e-06,1.2e-06,2.1e-07
    3   0 -      -3.231635357860 -1.034e-04  5.143e-03    3     3  2.125e-02 7.083e-03 1.329e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.496e-05,1.091e-04,9.804e-04,2.227e-04,1.363e-03
 ndim=84:6.258e-07GB t[comm(intra)]=4.496e-05 speed=2.784e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=9.8e-04 t_reduction=2.2e-04 tot=1.3e-03 ---
 sigma[inter] counter=23 t=1.1e-04 per=8.3e+00 cost=2.5e+04 flops=2.3e+08
 sigma[gemm] counter=23 i=0 t=1.2e-04 per=8.9e+00 cost=6.1e+03 flops=5.2e+07
 sigma[gemm] counter=23 i=1 t=1.2e-04 per=8.8e+00 cost=6.1e+03 flops=5.3e+07
 sigma[gemm] counter=23 i=2 t=1.1e-04 per=8.1e+00 cost=5.3e+03 flops=5.0e+07
 sigma[gemm] counter=23 i=3 t=1.1e-04 per=8.1e+00 cost=5.5e+03 flops=5.2e+07
 sigma[gemm] counter=23 i=4 t=1.2e-04 per=9.4e+00 cost=6.1e+03 flops=4.9e+07
 sigma[gemm] counter=23 i=5 t=1.0e-04 per=7.8e+00 cost=6.2e+03 flops=6.1e+07
 sigma[gemm] counter=23 i=6 t=1.5e-04 per=1.1e+01 cost=1.5e+04 flops=1.0e+08
 sigma[gemm] counter=23 i=7 t=1.6e-04 per=1.2e+01 cost=1.5e+04 flops=9.0e+07
 sigma[gemm] counter=23 total t=9.8e-04 per=7.5e+01 cost=6.5e+04 flops=6.6e+07
 sigma[red] counter=23 t=2.2e-04 per=1.7e+01 cost=2.0e+04 flops=9.0e+07
--- TIMING FOR sigma_tot : t_inter=4.5e-03 t_gemm=3.8e-02 t_reduction=6.0e-03 tot=4.8e-02 ---
 sigma_tot[inter] counter=23 t=4.5e-03 per=9.3e+00 cost=1.5e+06 flops=3.3e+08
 sigma_tot[gemm] counter=23 i=0 t=4.3e-03 per=8.9e+00 cost=4.5e+05 flops=1.0e+08
 sigma_tot[gemm] counter=23 i=1 t=4.0e-03 per=8.2e+00 cost=4.6e+05 flops=1.2e+08
 sigma_tot[gemm] counter=23 i=2 t=3.7e-03 per=7.6e+00 cost=4.1e+05 flops=1.1e+08
 sigma_tot[gemm] counter=23 i=3 t=3.6e-03 per=7.5e+00 cost=4.2e+05 flops=1.1e+08
 sigma_tot[gemm] counter=23 i=4 t=6.4e-03 per=1.3e+01 cost=1.5e+06 flops=2.3e+08
 sigma_tot[gemm] counter=23 i=5 t=5.3e-03 per=1.1e+01 cost=1.5e+06 flops=2.8e+08
 sigma_tot[gemm] counter=23 i=6 t=5.3e-03 per=1.1e+01 cost=8.2e+05 flops=1.6e+08
 sigma_tot[gemm] counter=23 i=7 t=5.2e-03 per=1.1e+01 cost=8.2e+05 flops=1.6e+08
 sigma_tot[gemm] counter=23 total t=3.8e-02 per=7.8e+01 cost=6.3e+06 flops=1.7e+08
 sigma_tot[red] counter=23 t=6.0e-03 per=1.2e+01 cost=1.6e+06 flops=2.6e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.6e-05,3.6e-06,1.3e-06,2.4e-07
    4   0 -      -3.231650161496 -1.480e-05  2.001e-03    3     4  2.742e-02 6.854e-03 1.379e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.438e-05,1.196e-04,8.708e-04,2.011e-04,1.237e-03
 ndim=84:6.258e-07GB t[comm(intra)]=3.438e-05 speed=3.641e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=8.7e-04 t_reduction=2.0e-04 tot=1.2e-03 ---
 sigma[inter] counter=24 t=1.2e-04 per=1.0e+01 cost=2.5e+04 flops=2.1e+08
 sigma[gemm] counter=24 i=0 t=1.1e-04 per=8.9e+00 cost=6.1e+03 flops=5.7e+07
 sigma[gemm] counter=24 i=1 t=1.1e-04 per=9.3e+00 cost=6.1e+03 flops=5.6e+07
 sigma[gemm] counter=24 i=2 t=1.1e-04 per=9.1e+00 cost=5.3e+03 flops=4.9e+07
 sigma[gemm] counter=24 i=3 t=9.1e-05 per=7.7e+00 cost=5.5e+03 flops=6.1e+07
 sigma[gemm] counter=24 i=4 t=9.7e-05 per=8.2e+00 cost=6.1e+03 flops=6.2e+07
 sigma[gemm] counter=24 i=5 t=1.0e-04 per=8.5e+00 cost=6.2e+03 flops=6.1e+07
 sigma[gemm] counter=24 i=6 t=1.3e-04 per=1.1e+01 cost=1.5e+04 flops=1.1e+08
 sigma[gemm] counter=24 i=7 t=1.2e-04 per=1.0e+01 cost=1.5e+04 flops=1.2e+08
 sigma[gemm] counter=24 total t=8.7e-04 per=7.3e+01 cost=6.5e+04 flops=7.4e+07
 sigma[red] counter=24 t=2.0e-04 per=1.7e+01 cost=2.0e+04 flops=1.0e+08
--- TIMING FOR sigma_tot : t_inter=4.6e-03 t_gemm=3.9e-02 t_reduction=6.2e-03 tot=5.0e-02 ---
 sigma_tot[inter] counter=24 t=4.6e-03 per=9.4e+00 cost=1.5e+06 flops=3.2e+08
 sigma_tot[gemm] counter=24 i=0 t=4.4e-03 per=8.9e+00 cost=4.6e+05 flops=1.0e+08
 sigma_tot[gemm] counter=24 i=1 t=4.1e-03 per=8.2e+00 cost=4.6e+05 flops=1.1e+08
 sigma_tot[gemm] counter=24 i=2 t=3.8e-03 per=7.6e+00 cost=4.2e+05 flops=1.1e+08
 sigma_tot[gemm] counter=24 i=3 t=3.7e-03 per=7.5e+00 cost=4.2e+05 flops=1.1e+08
 sigma_tot[gemm] counter=24 i=4 t=6.5e-03 per=1.3e+01 cost=1.5e+06 flops=2.3e+08
 sigma_tot[gemm] counter=24 i=5 t=5.4e-03 per=1.1e+01 cost=1.5e+06 flops=2.7e+08
 sigma_tot[gemm] counter=24 i=6 t=5.4e-03 per=1.1e+01 cost=8.4e+05 flops=1.5e+08
 sigma_tot[gemm] counter=24 i=7 t=5.4e-03 per=1.1e+01 cost=8.4e+05 flops=1.6e+08
 sigma_tot[gemm] counter=24 total t=3.9e-02 per=7.8e+01 cost=6.4e+06 flops=1.7e+08
 sigma_tot[red] counter=24 t=6.2e-03 per=1.2e+01 cost=1.6e+06 flops=2.6e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.7e-05,3.5e-06,1.2e-06,2.1e-07
    5   0 -      -3.231652595338 -2.434e-06  6.768e-04    3     5  4.096e-02 8.192e-03 1.385e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.282e-05,1.209e-04,9.737e-04,2.416e-04,1.365e-03
 ndim=84:6.258e-07GB t[comm(intra)]=2.282e-05 speed=5.484e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=9.7e-04 t_reduction=2.4e-04 tot=1.3e-03 ---
 sigma[inter] counter=25 t=1.2e-04 per=9.0e+00 cost=2.5e+04 flops=2.1e+08
 sigma[gemm] counter=25 i=0 t=1.3e-04 per=9.7e+00 cost=6.1e+03 flops=4.7e+07
 sigma[gemm] counter=25 i=1 t=1.1e-04 per=8.5e+00 cost=6.1e+03 flops=5.4e+07
 sigma[gemm] counter=25 i=2 t=1.1e-04 per=8.0e+00 cost=5.3e+03 flops=5.0e+07
 sigma[gemm] counter=25 i=3 t=1.1e-04 per=8.0e+00 cost=5.5e+03 flops=5.2e+07
 sigma[gemm] counter=25 i=4 t=1.2e-04 per=9.1e+00 cost=6.1e+03 flops=5.0e+07
 sigma[gemm] counter=25 i=5 t=1.0e-04 per=7.6e+00 cost=6.2e+03 flops=6.1e+07
 sigma[gemm] counter=25 i=6 t=1.5e-04 per=1.1e+01 cost=1.5e+04 flops=1.0e+08
 sigma[gemm] counter=25 i=7 t=1.5e-04 per=1.1e+01 cost=1.5e+04 flops=1.0e+08
 sigma[gemm] counter=25 total t=9.7e-04 per=7.3e+01 cost=6.5e+04 flops=6.7e+07
 sigma[red] counter=25 t=2.4e-04 per=1.8e+01 cost=2.0e+04 flops=8.3e+07
--- TIMING FOR sigma_tot : t_inter=4.8e-03 t_gemm=4.0e-02 t_reduction=6.4e-03 tot=5.1e-02 ---
 sigma_tot[inter] counter=25 t=4.8e-03 per=9.4e+00 cost=1.5e+06 flops=3.2e+08
 sigma_tot[gemm] counter=25 i=0 t=4.6e-03 per=9.0e+00 cost=4.7e+05 flops=1.0e+08
 sigma_tot[gemm] counter=25 i=1 t=4.2e-03 per=8.2e+00 cost=4.7e+05 flops=1.1e+08
 sigma_tot[gemm] counter=25 i=2 t=3.9e-03 per=7.6e+00 cost=4.2e+05 flops=1.1e+08
 sigma_tot[gemm] counter=25 i=3 t=3.8e-03 per=7.6e+00 cost=4.3e+05 flops=1.1e+08
 sigma_tot[gemm] counter=25 i=4 t=6.7e-03 per=1.3e+01 cost=1.5e+06 flops=2.3e+08
 sigma_tot[gemm] counter=25 i=5 t=5.5e-03 per=1.1e+01 cost=1.5e+06 flops=2.7e+08
 sigma_tot[gemm] counter=25 i=6 t=5.6e-03 per=1.1e+01 cost=8.5e+05 flops=1.5e+08
 sigma_tot[gemm] counter=25 i=7 t=5.5e-03 per=1.1e+01 cost=8.5e+05 flops=1.5e+08
 sigma_tot[gemm] counter=25 total t=4.0e-02 per=7.8e+01 cost=6.5e+06 flops=1.6e+08
 sigma_tot[red] counter=25 t=6.4e-03 per=1.3e+01 cost=1.6e+06 flops=2.5e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.6e-05,3.5e-06,1.3e-06,2.6e-07
    6   0 -      -3.231652893186 -2.978e-07  2.524e-04    3     6  4.725e-02 7.874e-03 1.410e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.304e-05,1.147e-04,9.737e-04,2.274e-04,1.344e-03
 ndim=84:6.258e-07GB t[comm(intra)]=2.304e-05 speed=5.432e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=9.7e-04 t_reduction=2.3e-04 tot=1.3e-03 ---
 sigma[inter] counter=26 t=1.1e-04 per=8.7e+00 cost=2.5e+04 flops=2.2e+08
 sigma[gemm] counter=26 i=0 t=1.2e-04 per=9.0e+00 cost=6.1e+03 flops=5.2e+07
 sigma[gemm] counter=26 i=1 t=1.1e-04 per=8.7e+00 cost=6.1e+03 flops=5.4e+07
 sigma[gemm] counter=26 i=2 t=1.1e-04 per=8.1e+00 cost=5.3e+03 flops=5.0e+07
 sigma[gemm] counter=26 i=3 t=1.2e-04 per=9.0e+00 cost=5.5e+03 flops=4.7e+07
 sigma[gemm] counter=26 i=4 t=1.2e-04 per=9.1e+00 cost=6.1e+03 flops=5.0e+07
 sigma[gemm] counter=26 i=5 t=1.0e-04 per=7.7e+00 cost=6.2e+03 flops=6.1e+07
 sigma[gemm] counter=26 i=6 t=1.5e-04 per=1.2e+01 cost=1.5e+04 flops=9.7e+07
 sigma[gemm] counter=26 i=7 t=1.4e-04 per=1.1e+01 cost=1.5e+04 flops=1.0e+08
 sigma[gemm] counter=26 total t=9.7e-04 per=7.4e+01 cost=6.5e+04 flops=6.7e+07
 sigma[red] counter=26 t=2.3e-04 per=1.7e+01 cost=2.0e+04 flops=8.8e+07
--- TIMING FOR sigma_tot : t_inter=4.9e-03 t_gemm=4.1e-02 t_reduction=6.6e-03 tot=5.2e-02 ---
 sigma_tot[inter] counter=26 t=4.9e-03 per=9.3e+00 cost=1.6e+06 flops=3.2e+08
 sigma_tot[gemm] counter=26 i=0 t=4.7e-03 per=9.0e+00 cost=4.7e+05 flops=1.0e+08
 sigma_tot[gemm] counter=26 i=1 t=4.3e-03 per=8.2e+00 cost=4.7e+05 flops=1.1e+08
 sigma_tot[gemm] counter=26 i=2 t=4.0e-03 per=7.6e+00 cost=4.3e+05 flops=1.1e+08
 sigma_tot[gemm] counter=26 i=3 t=4.0e-03 per=7.6e+00 cost=4.3e+05 flops=1.1e+08
 sigma_tot[gemm] counter=26 i=4 t=6.8e-03 per=1.3e+01 cost=1.5e+06 flops=2.2e+08
 sigma_tot[gemm] counter=26 i=5 t=5.6e-03 per=1.1e+01 cost=1.5e+06 flops=2.6e+08
 sigma_tot[gemm] counter=26 i=6 t=5.7e-03 per=1.1e+01 cost=8.7e+05 flops=1.5e+08
 sigma_tot[gemm] counter=26 i=7 t=5.6e-03 per=1.1e+01 cost=8.7e+05 flops=1.5e+08
 sigma_tot[gemm] counter=26 total t=4.1e-02 per=7.8e+01 cost=6.5e+06 flops=1.6e+08
 sigma_tot[red] counter=26 t=6.6e-03 per=1.3e+01 cost=1.6e+06 flops=2.4e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,3.3e-06,1.3e-06,2.4e-07
    7   0 +      -3.231652935087 -4.190e-08  9.006e-05    3     7  5.584e-02 7.977e-03 1.425e-03
TIMING FOR Davidson : 5.588e-02  T(cal/comm/rest)=9.972e-03,8.410e-07,4.590e-02
decomposed t_rest=4.590e-02
 T(sub)    =1.555e-04 per=3.388e-01
 T(precond)=4.544e-02 per=9.900e+01
 T(ortho)  =4.704e-05 per=1.025e-01
 T(xcopy)  =1.042e-06 per=2.270e-03
 T(xnrm2)  =3.622e-06 per=7.891e-03
 T(other)  =2.504e-04 per=5.455e-01
optimized energies: isweep=0 ibond=3 dots=2 e[0]=-3.231652935087 nmvp=7
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:9.863e+01S Sys:1.289e+00S Total:9.992e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=10 nqr=9 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
timing for divide=1.5e-05
timing for compute=9.3e-05
timing for collect=1.7e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-04 S T(divide/compute/collect)=1.5e-05,9.3e-05,1.7e-05 -----
decimation summary: 16->10 dwt=+7.947e-04 SvN=7.943e-01
 qbond: qkept nsym=8 dimAll=10
 (2,0):3 (1,1):1 (1,-1):1 (4,0):1 (3,1):1 (3,-1):1 (2,2):1 (2,-2):1
----- TIMING for decimation_row(nkr): 5.405e-04 S T(decim/select/formRot)=1.997e-04,3.000e-04,4.080e-05 -----
----- TIMING FOR twodot_decimation: 7.758e-04 S T(wf/decim)=2.046e-04,5.712e-04 -----
ctns::oper_renorm coord=(4,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:4 S:8 H:1 A:6 B:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:9.882e+01S Sys:1.290e+00S Total:1.001e+02S
----- TIMING FOR symbolic_formulae_renorm with size=29 : 6.564e-04 S -----
rank=0 GPUmem(GB): used=1.01e-05 (oper)=5.16e-06
rank=0 GPUmem(GB): used=1.02e-05 (oper,site)(GB)=5.16e-06,1.71e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=29
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=1.02e-05 (oper,site,rinter)=5.16e-06,1.71e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0011 S size(rtasks)=29 size(Rlst2)=64 T(Rmu/Rlist)=0.000211,0.000884 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00117 S size(rtasks)=29 size(Rlst)=630 -----
rank=0 GPUmem(GB): used=1.02e-05 (oper,site,rinter,batch)=5.16e-06,1.71e-07,0,8.92e-05 blksize=9 blksize0=0 batchsize=630
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.88e-06,0.000356,0.000105
--- TIMING FOR renorm : t_inter=7.6e-06 t_gemm=3.5e-04 t_reduction=1.0e-04 tot=4.7e-04 ---
 renorm[inter] counter=4 t=7.6e-06 per=1.6e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=0 t=9.2e-05 per=2.0e+01 cost=5.5e+02 flops=6.0e+06
 renorm[gemm] counter=4 i=1 t=6.5e-05 per=1.4e+01 cost=1.1e+03 flops=1.7e+07
 renorm[gemm] counter=4 i=2 t=5.7e-05 per=1.2e+01 cost=7.5e+02 flops=1.3e+07
 renorm[gemm] counter=4 i=3 t=5.8e-05 per=1.2e+01 cost=8.8e+02 flops=1.5e+07
 renorm[gemm] counter=4 i=4 t=1.1e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=5 t=1.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=6 t=8.0e-05 per=1.7e+01 cost=3.4e+03 flops=4.3e+07
 renorm[gemm] counter=4 total t=3.5e-04 per=7.6e+01 cost=6.7e+03 flops=1.9e+07
 renorm[red] counter=4 t=1.0e-04 per=2.2e+01 cost=3.4e+03 flops=3.3e+07
--- TIMING FOR renorm_tot : t_inter=2.1e-04 t_gemm=2.0e-03 t_reduction=6.5e-04 tot=2.9e-03 ---
 renorm_tot[inter] counter=4 t=2.1e-04 per=7.1e+00 cost=1.2e+04 flops=5.8e+07
 renorm_tot[gemm] counter=4 i=0 t=3.4e-04 per=1.2e+01 cost=6.3e+03 flops=1.9e+07
 renorm_tot[gemm] counter=4 i=1 t=3.0e-04 per=1.0e+01 cost=1.0e+04 flops=3.4e+07
 renorm_tot[gemm] counter=4 i=2 t=6.1e-05 per=2.1e+00 cost=7.5e+02 flops=1.2e+07
 renorm_tot[gemm] counter=4 i=3 t=6.1e-05 per=2.1e+00 cost=8.8e+02 flops=1.5e+07
 renorm_tot[gemm] counter=4 i=4 t=3.9e-04 per=1.3e+01 cost=1.1e+04 flops=2.9e+07
 renorm_tot[gemm] counter=4 i=5 t=3.8e-04 per=1.3e+01 cost=1.5e+04 flops=3.9e+07
 renorm_tot[gemm] counter=4 i=6 t=5.2e-04 per=1.8e+01 cost=4.4e+04 flops=8.5e+07
 renorm_tot[gemm] counter=4 total t=2.0e-03 per=7.0e+01 cost=8.9e+04 flops=4.3e+07
 renorm_tot[red] counter=4 t=6.5e-04 per=2.2e+01 cost=2.9e+04 flops=4.4e+07
qops.to_cpu: size(tot)=276:2.1e-03MB:2.1e-06GB t[to_cpu]=1.4e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=3.511e-16 coord=(4,0) rank=0
ctns::oper_ab2pq coord=(4,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00716 S rank=0 -----
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:9.953e+01S Sys:1.292e+00S Total:1.008e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=163:1.244e-03MB:1.214e-06GB
 rwfuns: len=2 mem=4:3.052e-05MB:2.980e-08GB
 cpsi: len=1 mem=54:4.120e-04MB:4.023e-07GB
total mem of comb=263:2.007e-03MB:1.960e-06GB
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:9.954e+01S Sys:1.307e+00S Total:1.008e+02S
##### local opt: 1.047e-01 S #####
 T(local opt: fetch) = 1.753e-04 S  per = 0.167  per(accum) = 0.167
 T(local opt: hdiag) = 5.670e-04 S  per = 0.541  per(accum) = 0.709
 T(local opt: dvdsn) = 9.506e-02 S  per = 90.8  per(accum) = 91.5
 T(local opt: decim) = 7.859e-04 S  per = 0.751  per(accum) = 92.2
 T(local opt: guess) = 2.381e-04 S  per = 0.227  per(accum) = 92.5
 T(local opt: renrm) = 7.534e-03 S  per =  7.2  per(accum) = 99.7
 T(local opt: save ) = 3.522e-04 S  per = 0.336  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.506e-02 S  T(sum) = 9.480e-02 S  per = 9.973e+01
 T(local opt: preprocess                  ) = 4.303e-04 S  per = 0.454  per(accum) = 0.454
 T(local opt: symbolic_formulae           ) = 2.260e-03 S  per = 2.38  per(accum) = 2.84
 T(local opt: hintermediate init          ) = 9.629e-05 S  per = 0.102  per(accum) = 2.94
 T(local opt: preprocess_hformulae_Hxlist ) = 6.412e-03 S  per = 6.76  per(accum) = 9.7
 T(local opt: hmmtasks init               ) = 2.957e-02 S  per = 31.2  per(accum) = 40.9
 T(local opt: initial guess for dvdson    ) = 1.612e-04 S  per = 0.17  per(accum) = 41.1
 T(local opt: dvdson solver [Hx_batchGPU] ) = 9.781e-03 S  per = 10.3  per(accum) = 51.4
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.912e-04 S  per = 0.202  per(accum) = 51.6
 T(local opt: dvdson solver [comm(cpu)]   ) = 8.410e-07 S  per = 0.000887  per(accum) = 51.6
 T(local opt: dvdson solver [rest part]   ) = 4.590e-02 S  per = 48.4  per(accum) = 100
Detailed decomposition of T(renrm) = 7.534e-03 S  T(sum) = 7.534e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 9.368e-05 S  per = 1.24  per(accum) = 1.24
 T(local opt: qops init                    ) = 6.566e-04 S  per = 8.71  per(accum) = 9.96
 T(local opt: symbolic_formulae_renorm     ) = 6.654e-04 S  per = 8.83  per(accum) = 18.8
 T(local opt: allocate qops on gpu         ) = 2.232e-05 S  per = 0.296  per(accum) = 19.1
 T(local opt: site memcpy cpu2gpu          ) = 2.226e-05 S  per = 0.295  per(accum) = 19.4
 T(local opt: rintermediate init           ) = 2.242e-05 S  per = 0.298  per(accum) = 19.7
 T(local opt: preprocess_formulae_Rlist2   ) = 1.197e-03 S  per = 15.9  per(accum) = 35.6
 T(local opt: rmmtasks init                ) = 3.948e-03 S  per = 52.4  per(accum) = 88
 T(local opt: qops memset on cpu           ) = 5.000e-08 S  per = 0.000664  per(accum) = 88
 T(local opt: preprocess_renorm_batchGPU   ) = 5.689e-04 S  per = 7.55  per(accum) = 95.5
 T(local opt: reduction of opS & opH [nccl]) = 9.910e-07 S  per = 0.0132  per(accum) = 95.5
 T(local opt: qops memcpy gpu2cpu          ) = 1.966e-05 S  per = 0.261  per(accum) = 95.8
 T(local opt: deallocate cpu and gpu memory) = 1.037e-05 S  per = 0.138  per(accum) = 95.9
 T(local opt: reduction of opS & opH [comm]) = 2.599e-05 S  per = 0.345  per(accum) = 96.3
 T(local opt: conversion from opAB to opPQ ) = 3.706e-06 S  per = 0.0492  per(accum) = 96.3
 T(local opt: after oper_renorm            ) = 2.771e-04 S  per = 3.68  per(accum) = 100
##### sweep opt: 7.766e-01 S #####
 T(sweep opt: fetch) = 4.096e-03 S  per = 0.527  per(accum) = 0.527
 T(sweep opt: hdiag) = 3.473e-03 S  per = 0.447  per(accum) = 0.975
 T(sweep opt: dvdsn) = 5.782e-01 S  per = 74.5  per(accum) = 75.4
 T(sweep opt: decim) = 3.403e-03 S  per = 0.438  per(accum) = 75.9
 T(sweep opt: guess) = 1.249e-03 S  per = 0.161  per(accum) = 76
 T(sweep opt: renrm) = 1.852e-01 S  per = 23.8  per(accum) = 99.9
 T(sweep opt: save ) = 9.577e-04 S  per = 0.123  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.782e-01 S  T(sum) = 5.771e-01 S  per = 9.981e+01
 T(sweep opt: preprocess                  ) = 3.161e-03 S  per = 0.548  per(accum) = 0.548
 T(sweep opt: symbolic_formulae           ) = 9.482e-03 S  per = 1.64  per(accum) = 2.19
 T(sweep opt: hintermediate init          ) = 4.195e-04 S  per = 0.0727  per(accum) = 2.26
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.532e-02 S  per = 9.59  per(accum) = 11.8
 T(sweep opt: hmmtasks init               ) = 2.896e-01 S  per = 50.2  per(accum) = 62
 T(sweep opt: initial guess for dvdson    ) = 9.507e-04 S  per = 0.165  per(accum) = 62.2
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 5.655e-02 S  per =  9.8  per(accum) = 72
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 6.273e-04 S  per = 0.109  per(accum) = 72.1
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 3.015e-06 S  per = 0.000522  per(accum) = 72.1
 T(sweep opt: dvdson solver [rest part]   ) = 1.610e-01 S  per = 27.9  per(accum) = 100
Detailed decomposition of T(renrm) = 1.852e-01 S  T(sum) = 1.852e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.686e-04 S  per = 0.199  per(accum) = 0.199
 T(sweep opt: qops init                    ) = 2.002e-03 S  per = 1.08  per(accum) = 1.28
 T(sweep opt: symbolic_formulae_renorm     ) = 3.929e-03 S  per = 2.12  per(accum) = 3.4
 T(sweep opt: allocate qops on gpu         ) = 9.035e-05 S  per = 0.0488  per(accum) = 3.45
 T(sweep opt: site memcpy cpu2gpu          ) = 9.395e-05 S  per = 0.0507  per(accum) = 3.5
 T(sweep opt: rintermediate init           ) = 3.110e-04 S  per = 0.168  per(accum) = 3.67
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.243e-03 S  per = 3.37  per(accum) = 7.04
 T(sweep opt: rmmtasks init                ) = 2.391e-02 S  per = 12.9  per(accum) = 20
 T(sweep opt: qops memset on cpu           ) = 2.040e-07 S  per = 0.00011  per(accum) = 20
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.325e-03 S  per =  1.8  per(accum) = 21.7
 T(sweep opt: reduction of opS & opH [nccl]) = 4.312e-06 S  per = 0.00233  per(accum) = 21.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 8.040e-05 S  per = 0.0434  per(accum) = 21.8
 T(sweep opt: deallocate cpu and gpu memory) = 4.390e-05 S  per = 0.0237  per(accum) = 21.8
 T(sweep opt: reduction of opS & opH [comm]) = 9.948e-05 S  per = 0.0537  per(accum) = 21.9
 T(sweep opt: conversion from opAB to opPQ ) = 1.437e-01 S  per = 77.6  per(accum) = 99.5
 T(sweep opt: after oper_renorm            ) = 9.983e-04 S  per = 0.539  per(accum) = 100
##### global opt: 7.766e-01 S #####
 T(global opt: fetch) = 4.096e-03 S  per = 0.527  per(accum) = 0.527
 T(global opt: hdiag) = 3.473e-03 S  per = 0.447  per(accum) = 0.975
 T(global opt: dvdsn) = 5.782e-01 S  per = 74.5  per(accum) = 75.4
 T(global opt: decim) = 3.403e-03 S  per = 0.438  per(accum) = 75.9
 T(global opt: guess) = 1.249e-03 S  per = 0.161  per(accum) = 76
 T(global opt: renrm) = 1.852e-01 S  per = 23.8  per(accum) = 99.9
 T(global opt: save ) = 9.577e-04 S  per = 0.123  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.782e-01 S  T(sum) = 5.771e-01 S  per = 9.981e+01
 T(global opt: preprocess                  ) = 3.161e-03 S  per = 0.548  per(accum) = 0.548
 T(global opt: symbolic_formulae           ) = 9.482e-03 S  per = 1.64  per(accum) = 2.19
 T(global opt: hintermediate init          ) = 4.195e-04 S  per = 0.0727  per(accum) = 2.26
 T(global opt: preprocess_hformulae_Hxlist ) = 5.532e-02 S  per = 9.59  per(accum) = 11.8
 T(global opt: hmmtasks init               ) = 2.896e-01 S  per = 50.2  per(accum) = 62
 T(global opt: initial guess for dvdson    ) = 9.507e-04 S  per = 0.165  per(accum) = 62.2
 T(global opt: dvdson solver [Hx_batchGPU] ) = 5.655e-02 S  per =  9.8  per(accum) = 72
 T(global opt: dvdson solver [comm(gpu)]   ) = 6.273e-04 S  per = 0.109  per(accum) = 72.1
 T(global opt: dvdson solver [comm(cpu)]   ) = 3.015e-06 S  per = 0.000522  per(accum) = 72.1
 T(global opt: dvdson solver [rest part]   ) = 1.610e-01 S  per = 27.9  per(accum) = 100
Detailed decomposition of T(renrm) = 1.852e-01 S  T(sum) = 1.852e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.686e-04 S  per = 0.199  per(accum) = 0.199
 T(global opt: qops init                    ) = 2.002e-03 S  per = 1.08  per(accum) = 1.28
 T(global opt: symbolic_formulae_renorm     ) = 3.929e-03 S  per = 2.12  per(accum) = 3.4
 T(global opt: allocate qops on gpu         ) = 9.035e-05 S  per = 0.0488  per(accum) = 3.45
 T(global opt: site memcpy cpu2gpu          ) = 9.395e-05 S  per = 0.0507  per(accum) = 3.5
 T(global opt: rintermediate init           ) = 3.110e-04 S  per = 0.168  per(accum) = 3.67
 T(global opt: preprocess_formulae_Rlist2   ) = 6.243e-03 S  per = 3.37  per(accum) = 7.04
 T(global opt: rmmtasks init                ) = 2.391e-02 S  per = 12.9  per(accum) = 20
 T(global opt: qops memset on cpu           ) = 2.040e-07 S  per = 0.00011  per(accum) = 20
 T(global opt: preprocess_renorm_batchGPU   ) = 3.325e-03 S  per =  1.8  per(accum) = 21.7
 T(global opt: reduction of opS & opH [nccl]) = 4.312e-06 S  per = 0.00233  per(accum) = 21.7
 T(global opt: qops memcpy gpu2cpu          ) = 8.040e-05 S  per = 0.0434  per(accum) = 21.8
 T(global opt: deallocate cpu and gpu memory) = 4.390e-05 S  per = 0.0237  per(accum) = 21.8
 T(global opt: reduction of opS & opH [comm]) = 9.948e-05 S  per = 0.0537  per(accum) = 21.9
 T(global opt: conversion from opAB to opPQ ) = 1.437e-01 S  per = 77.6  per(accum) = 99.5
 T(global opt: after oper_renorm            ) = 9.983e-04 S  per = 0.539  per(accum) = 100

isweep=0 ibond=4/seqsize=6 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:9.954e+01S Sys:1.308e+00S Total:1.008e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=163:1.244e-03MB:1.214e-06GB
 rwfuns: len=2 mem=4:3.052e-05MB:2.980e-08GB
 cpsi: len=1 mem=54:4.120e-04MB:4.023e-07GB
total mem of comb=263:2.007e-03MB:1.960e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,2,1,1
 suppl= 0 1
 suppr= 4 5
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:4 S:8 H:1 P:28 Q:36 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=676:5.157e-03MB:5.037e-06GB
 rqops: oplist=CSHAB nops=C:4 S:8 H:1 A:6 B:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
 c1qops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 c2qops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 qops(tot)=1368:1.044e-02MB:1.019e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
wf4(diml,dimr,dimc1,dimc2)=(10,10,4,4) nnz=158:1.205e-03MB
qtensor4: wf4 own=1 _data=0x4df4c380
qinfo4: wf4 sym=(6,0)
 qbond: qrow nsym=8 dimAll=10
 (2,0):3 (1,1):1 (1,-1):1 (4,0):1 (3,1):1 (3,-1):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=8 dimAll=10
 (2,0):3 (1,1):1 (1,-1):1 (4,0):1 (3,1):1 (3,-1):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=82 nblocks=1024 size=158:1.205e-03MB
### DIAG TIMING: total=1.308e-03 t1=9.551e-06, t2=1.933e-05, t3=8.665e-05, t4=1.130e-03, t5=4.428e-05, t6=1.337e-05, t7=4.176e-06
duration_diagGPU:1.319e-03
duration_diagreduce:4.600e-08
duration_diagtransform:1.490e-06
----- TIMING FOR symbolic_formulae_twodot with size=396 : 3.584e-03 S -----
rank=0 GPUmem(GB): used=1.02e-05 (oper)=1.02e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=396
 no. of hintermediate operators=138
 no. of coefficients=276:0.00211MB:2.06e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.344e-04 S -----
rank=0 GPUmem(GB): used=1.22e-05 (oper,hinter)=1.02e-05,2.06e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0242 S size(H_formulae)=396 size(Hxlst2)=82 T(Hmu/Hxlist)=0.00101,0.0232 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0259 S size(H_formulae)=396 size(Hxlst)=20224 -----
rank=0 GPUmem(GB): used=0.00333 (oper,hinter,dvdson,batch)=1.02e-05,2.06e-06,2.35e-06,0.00331 blksize=9 blksize0=3 batchsize=20224
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=158 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.31e-05,0.000233,0.00191,0.000306,0.00249
 ndim=158:1.18e-06GB t[comm(intra)]=2.31e-05 speed=0.102GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=1.9e-03 t_reduction=3.1e-04 tot=2.4e-03 ---
 sigma[inter] counter=27 t=2.3e-04 per=9.5e+00 cost=4.8e+04 flops=2.1e+08
 sigma[gemm] counter=27 i=0 t=2.1e-04 per=8.7e+00 cost=2.6e+04 flops=1.2e+08
 sigma[gemm] counter=27 i=1 t=2.0e-04 per=8.3e+00 cost=2.5e+04 flops=1.2e+08
 sigma[gemm] counter=27 i=2 t=1.9e-04 per=7.9e+00 cost=2.3e+04 flops=1.2e+08
 sigma[gemm] counter=27 i=3 t=1.8e-04 per=7.5e+00 cost=2.3e+04 flops=1.3e+08
 sigma[gemm] counter=27 i=4 t=3.0e-04 per=1.2e+01 cost=5.7e+04 flops=1.9e+08
 sigma[gemm] counter=27 i=5 t=3.0e-04 per=1.2e+01 cost=5.7e+04 flops=1.9e+08
 sigma[gemm] counter=27 i=6 t=2.6e-04 per=1.1e+01 cost=4.4e+04 flops=1.7e+08
 sigma[gemm] counter=27 i=7 t=2.6e-04 per=1.1e+01 cost=4.4e+04 flops=1.7e+08
 sigma[gemm] counter=27 total t=1.9e-03 per=7.8e+01 cost=3.0e+05 flops=1.6e+08
 sigma[red] counter=27 t=3.1e-04 per=1.3e+01 cost=8.8e+04 flops=2.9e+08
--- TIMING FOR sigma_tot : t_inter=5.1e-03 t_gemm=4.3e-02 t_reduction=7.0e-03 tot=5.5e-02 ---
 sigma_tot[inter] counter=27 t=5.1e-03 per=9.3e+00 cost=1.6e+06 flops=3.1e+08
 sigma_tot[gemm] counter=27 i=0 t=4.9e-03 per=8.9e+00 cost=5.0e+05 flops=1.0e+08
 sigma_tot[gemm] counter=27 i=1 t=4.5e-03 per=8.2e+00 cost=5.0e+05 flops=1.1e+08
 sigma_tot[gemm] counter=27 i=2 t=4.2e-03 per=7.6e+00 cost=4.5e+05 flops=1.1e+08
 sigma_tot[gemm] counter=27 i=3 t=4.1e-03 per=7.6e+00 cost=4.6e+05 flops=1.1e+08
 sigma_tot[gemm] counter=27 i=4 t=7.1e-03 per=1.3e+01 cost=1.6e+06 flops=2.2e+08
 sigma_tot[gemm] counter=27 i=5 t=5.9e-03 per=1.1e+01 cost=1.6e+06 flops=2.6e+08
 sigma_tot[gemm] counter=27 i=6 t=6.0e-03 per=1.1e+01 cost=9.1e+05 flops=1.5e+08
 sigma_tot[gemm] counter=27 i=7 t=5.9e-03 per=1.1e+01 cost=9.1e+05 flops=1.5e+08
 sigma_tot[gemm] counter=27 total t=4.3e-02 per=7.8e+01 cost=6.8e+06 flops=1.6e+08
 sigma_tot[red] counter=27 t=7.0e-03 per=1.3e+01 cost=1.7e+06 flops=2.5e+08
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,4.1e-06,1.9e-06,8.1e-07,1.7e-07
settings: ndim=158 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.230101261188 -1.003e+03  6.021e-02    1     1  2.633e-03 2.633e-03 2.608e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.278e-05,3.098e-04,2.526e-03,3.040e-04,3.170e-03
 ndim=158:1.177e-06GB t[comm(intra)]=2.278e-05 speed=1.034e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=3.1e-04 t_gemm=2.5e-03 t_reduction=3.0e-04 tot=3.1e-03 ---
 sigma[inter] counter=28 t=3.1e-04 per=9.9e+00 cost=4.8e+04 flops=1.6e+08
 sigma[gemm] counter=28 i=0 t=3.0e-04 per=9.5e+00 cost=2.6e+04 flops=8.7e+07
 sigma[gemm] counter=28 i=1 t=3.0e-04 per=9.7e+00 cost=2.5e+04 flops=8.3e+07
 sigma[gemm] counter=28 i=2 t=2.4e-04 per=7.6e+00 cost=2.3e+04 flops=9.7e+07
 sigma[gemm] counter=28 i=3 t=2.4e-04 per=7.5e+00 cost=2.3e+04 flops=9.7e+07
 sigma[gemm] counter=28 i=4 t=3.9e-04 per=1.3e+01 cost=5.7e+04 flops=1.4e+08
 sigma[gemm] counter=28 i=5 t=3.7e-04 per=1.2e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=28 i=6 t=3.3e-04 per=1.0e+01 cost=4.4e+04 flops=1.3e+08
 sigma[gemm] counter=28 i=7 t=3.6e-04 per=1.1e+01 cost=4.4e+04 flops=1.2e+08
 sigma[gemm] counter=28 total t=2.5e-03 per=8.0e+01 cost=3.0e+05 flops=1.2e+08
 sigma[red] counter=28 t=3.0e-04 per=9.7e+00 cost=8.8e+04 flops=2.9e+08
--- TIMING FOR sigma_tot : t_inter=5.4e-03 t_gemm=4.5e-02 t_reduction=7.3e-03 tot=5.8e-02 ---
 sigma_tot[inter] counter=28 t=5.4e-03 per=9.4e+00 cost=1.6e+06 flops=3.0e+08
 sigma_tot[gemm] counter=28 i=0 t=5.2e-03 per=9.0e+00 cost=5.2e+05 flops=1.0e+08
 sigma_tot[gemm] counter=28 i=1 t=4.8e-03 per=8.3e+00 cost=5.2e+05 flops=1.1e+08
 sigma_tot[gemm] counter=28 i=2 t=4.4e-03 per=7.6e+00 cost=4.8e+05 flops=1.1e+08
 sigma_tot[gemm] counter=28 i=3 t=4.4e-03 per=7.6e+00 cost=4.8e+05 flops=1.1e+08
 sigma_tot[gemm] counter=28 i=4 t=7.5e-03 per=1.3e+01 cost=1.6e+06 flops=2.2e+08
 sigma_tot[gemm] counter=28 i=5 t=6.3e-03 per=1.1e+01 cost=1.6e+06 flops=2.5e+08
 sigma_tot[gemm] counter=28 i=6 t=6.3e-03 per=1.1e+01 cost=9.5e+05 flops=1.5e+08
 sigma_tot[gemm] counter=28 i=7 t=6.3e-03 per=1.1e+01 cost=9.5e+05 flops=1.5e+08
 sigma_tot[gemm] counter=28 total t=4.5e-02 per=7.8e+01 cost=7.1e+06 flops=1.6e+08
 sigma_tot[red] counter=28 t=7.3e-03 per=1.3e+01 cost=1.8e+06 flops=2.5e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.3e-05,4.1e-06,1.7e-06,2.3e-07
    2   0 -      -3.232198162198 -2.097e-03  2.471e-02    2     2  1.085e-02 5.423e-03 2.973e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.204e-05,3.232e-04,2.462e-03,3.311e-04,3.144e-03
 ndim=158:1.177e-06GB t[comm(intra)]=2.204e-05 speed=1.068e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=3.2e-04 t_gemm=2.5e-03 t_reduction=3.3e-04 tot=3.1e-03 ---
 sigma[inter] counter=29 t=3.2e-04 per=1.0e+01 cost=4.8e+04 flops=1.5e+08
 sigma[gemm] counter=29 i=0 t=2.9e-04 per=9.4e+00 cost=2.6e+04 flops=8.9e+07
 sigma[gemm] counter=29 i=1 t=2.7e-04 per=8.8e+00 cost=2.5e+04 flops=9.3e+07
 sigma[gemm] counter=29 i=2 t=2.6e-04 per=8.4e+00 cost=2.3e+04 flops=8.9e+07
 sigma[gemm] counter=29 i=3 t=2.4e-04 per=7.6e+00 cost=2.3e+04 flops=9.7e+07
 sigma[gemm] counter=29 i=4 t=3.7e-04 per=1.2e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=29 i=5 t=3.8e-04 per=1.2e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=29 i=6 t=3.2e-04 per=1.0e+01 cost=4.4e+04 flops=1.3e+08
 sigma[gemm] counter=29 i=7 t=3.3e-04 per=1.1e+01 cost=4.4e+04 flops=1.4e+08
 sigma[gemm] counter=29 total t=2.5e-03 per=7.9e+01 cost=3.0e+05 flops=1.2e+08
 sigma[red] counter=29 t=3.3e-04 per=1.1e+01 cost=8.8e+04 flops=2.6e+08
--- TIMING FOR sigma_tot : t_inter=5.7e-03 t_gemm=4.8e-02 t_reduction=7.6e-03 tot=6.1e-02 ---
 sigma_tot[inter] counter=29 t=5.7e-03 per=9.4e+00 cost=1.7e+06 flops=3.0e+08
 sigma_tot[gemm] counter=29 i=0 t=5.5e-03 per=9.0e+00 cost=5.5e+05 flops=1.0e+08
 sigma_tot[gemm] counter=29 i=1 t=5.1e-03 per=8.3e+00 cost=5.5e+05 flops=1.1e+08
 sigma_tot[gemm] counter=29 i=2 t=4.7e-03 per=7.7e+00 cost=5.0e+05 flops=1.1e+08
 sigma_tot[gemm] counter=29 i=3 t=4.6e-03 per=7.6e+00 cost=5.0e+05 flops=1.1e+08
 sigma_tot[gemm] counter=29 i=4 t=7.8e-03 per=1.3e+01 cost=1.7e+06 flops=2.1e+08
 sigma_tot[gemm] counter=29 i=5 t=6.7e-03 per=1.1e+01 cost=1.7e+06 flops=2.5e+08
 sigma_tot[gemm] counter=29 i=6 t=6.6e-03 per=1.1e+01 cost=1.0e+06 flops=1.5e+08
 sigma_tot[gemm] counter=29 i=7 t=6.6e-03 per=1.1e+01 cost=1.0e+06 flops=1.5e+08
 sigma_tot[gemm] counter=29 total t=4.8e-02 per=7.8e+01 cost=7.4e+06 flops=1.6e+08
 sigma_tot[red] counter=29 t=7.6e-03 per=1.2e+01 cost=1.9e+06 flops=2.5e+08
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.8e-05,3.6e-06,1.9e-06,2.7e-07
    3   0 -      -3.232507655890 -3.095e-04  1.151e-02    3     3  2.055e-02 6.851e-03 3.089e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.221e-05,3.041e-04,2.471e-03,3.002e-04,3.104e-03
 ndim=158:1.177e-06GB t[comm(intra)]=2.221e-05 speed=1.060e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=3.0e-04 t_gemm=2.5e-03 t_reduction=3.0e-04 tot=3.1e-03 ---
 sigma[inter] counter=30 t=3.0e-04 per=9.9e+00 cost=4.8e+04 flops=1.6e+08
 sigma[gemm] counter=30 i=0 t=3.1e-04 per=1.0e+01 cost=2.6e+04 flops=8.4e+07
 sigma[gemm] counter=30 i=1 t=2.8e-04 per=9.0e+00 cost=2.5e+04 flops=9.2e+07
 sigma[gemm] counter=30 i=2 t=2.4e-04 per=7.7e+00 cost=2.3e+04 flops=9.7e+07
 sigma[gemm] counter=30 i=3 t=2.5e-04 per=8.0e+00 cost=2.3e+04 flops=9.4e+07
 sigma[gemm] counter=30 i=4 t=3.7e-04 per=1.2e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=30 i=5 t=3.7e-04 per=1.2e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=30 i=6 t=3.4e-04 per=1.1e+01 cost=4.4e+04 flops=1.3e+08
 sigma[gemm] counter=30 i=7 t=3.3e-04 per=1.1e+01 cost=4.4e+04 flops=1.4e+08
 sigma[gemm] counter=30 total t=2.5e-03 per=8.0e+01 cost=3.0e+05 flops=1.2e+08
 sigma[red] counter=30 t=3.0e-04 per=9.8e+00 cost=8.8e+04 flops=2.9e+08
--- TIMING FOR sigma_tot : t_inter=6.0e-03 t_gemm=5.0e-02 t_reduction=7.9e-03 tot=6.4e-02 ---
 sigma_tot[inter] counter=30 t=6.0e-03 per=9.4e+00 cost=1.7e+06 flops=2.9e+08
 sigma_tot[gemm] counter=30 i=0 t=5.8e-03 per=9.0e+00 cost=5.7e+05 flops=9.9e+07
 sigma_tot[gemm] counter=30 i=1 t=5.3e-03 per=8.4e+00 cost=5.8e+05 flops=1.1e+08
 sigma_tot[gemm] counter=30 i=2 t=4.9e-03 per=7.7e+00 cost=5.2e+05 flops=1.1e+08
 sigma_tot[gemm] counter=30 i=3 t=4.9e-03 per=7.6e+00 cost=5.2e+05 flops=1.1e+08
 sigma_tot[gemm] counter=30 i=4 t=8.2e-03 per=1.3e+01 cost=1.7e+06 flops=2.1e+08
 sigma_tot[gemm] counter=30 i=5 t=7.1e-03 per=1.1e+01 cost=1.7e+06 flops=2.4e+08
 sigma_tot[gemm] counter=30 i=6 t=7.0e-03 per=1.1e+01 cost=1.0e+06 flops=1.5e+08
 sigma_tot[gemm] counter=30 i=7 t=6.9e-03 per=1.1e+01 cost=1.0e+06 flops=1.5e+08
 sigma_tot[gemm] counter=30 total t=5.0e-02 per=7.8e+01 cost=7.7e+06 flops=1.5e+08
 sigma_tot[red] counter=30 t=7.9e-03 per=1.2e+01 cost=2.0e+06 flops=2.5e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.6e-05,3.4e-06,1.6e-06,2.3e-07
    4   0 -      -3.232608129009 -1.005e-04  6.228e-03    3     4  3.018e-02 7.544e-03 3.135e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.267e-05,2.850e-04,2.043e-03,2.674e-04,2.626e-03
 ndim=158:1.177e-06GB t[comm(intra)]=2.267e-05 speed=1.039e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=2.8e-04 t_gemm=2.0e-03 t_reduction=2.7e-04 tot=2.6e-03 ---
 sigma[inter] counter=31 t=2.8e-04 per=1.1e+01 cost=4.8e+04 flops=1.7e+08
 sigma[gemm] counter=31 i=0 t=2.4e-04 per=9.2e+00 cost=2.6e+04 flops=1.1e+08
 sigma[gemm] counter=31 i=1 t=2.3e-04 per=9.0e+00 cost=2.5e+04 flops=1.1e+08
 sigma[gemm] counter=31 i=2 t=2.0e-04 per=7.5e+00 cost=2.3e+04 flops=1.2e+08
 sigma[gemm] counter=31 i=3 t=2.1e-04 per=8.1e+00 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=31 i=4 t=3.0e-04 per=1.2e+01 cost=5.7e+04 flops=1.9e+08
 sigma[gemm] counter=31 i=5 t=3.0e-04 per=1.2e+01 cost=5.7e+04 flops=1.9e+08
 sigma[gemm] counter=31 i=6 t=2.7e-04 per=1.0e+01 cost=4.4e+04 flops=1.6e+08
 sigma[gemm] counter=31 i=7 t=2.9e-04 per=1.1e+01 cost=4.4e+04 flops=1.5e+08
 sigma[gemm] counter=31 total t=2.0e-03 per=7.9e+01 cost=3.0e+05 flops=1.5e+08
 sigma[red] counter=31 t=2.7e-04 per=1.0e+01 cost=8.8e+04 flops=3.3e+08
--- TIMING FOR sigma_tot : t_inter=6.3e-03 t_gemm=5.2e-02 t_reduction=8.2e-03 tot=6.7e-02 ---
 sigma_tot[inter] counter=31 t=6.3e-03 per=9.5e+00 cost=1.8e+06 flops=2.8e+08
 sigma_tot[gemm] counter=31 i=0 t=6.0e-03 per=9.1e+00 cost=6.0e+05 flops=1.0e+08
 sigma_tot[gemm] counter=31 i=1 t=5.6e-03 per=8.4e+00 cost=6.0e+05 flops=1.1e+08
 sigma_tot[gemm] counter=31 i=2 t=5.1e-03 per=7.7e+00 cost=5.5e+05 flops=1.1e+08
 sigma_tot[gemm] counter=31 i=3 t=5.1e-03 per=7.6e+00 cost=5.5e+05 flops=1.1e+08
 sigma_tot[gemm] counter=31 i=4 t=8.5e-03 per=1.3e+01 cost=1.8e+06 flops=2.1e+08
 sigma_tot[gemm] counter=31 i=5 t=7.4e-03 per=1.1e+01 cost=1.8e+06 flops=2.4e+08
 sigma_tot[gemm] counter=31 i=6 t=7.2e-03 per=1.1e+01 cost=1.1e+06 flops=1.5e+08
 sigma_tot[gemm] counter=31 i=7 t=7.2e-03 per=1.1e+01 cost=1.1e+06 flops=1.5e+08
 sigma_tot[gemm] counter=31 total t=5.2e-02 per=7.8e+01 cost=8.0e+06 flops=1.5e+08
 sigma_tot[red] counter=31 t=8.2e-03 per=1.2e+01 cost=2.1e+06 flops=2.5e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.5e-05,3.2e-06,1.5e-06,2.2e-07
    5   0 -      -3.232639166515 -3.104e-05  3.304e-03    3     5  4.392e-02 8.784e-03 3.062e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.193e-05,3.051e-04,2.476e-03,3.200e-04,3.130e-03
 ndim=158:1.177e-06GB t[comm(intra)]=2.193e-05 speed=1.074e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=3.0e-04 t_gemm=2.5e-03 t_reduction=3.2e-04 tot=3.1e-03 ---
 sigma[inter] counter=32 t=3.0e-04 per=9.8e+00 cost=4.8e+04 flops=1.6e+08
 sigma[gemm] counter=32 i=0 t=3.0e-04 per=9.7e+00 cost=2.6e+04 flops=8.6e+07
 sigma[gemm] counter=32 i=1 t=2.8e-04 per=9.1e+00 cost=2.5e+04 flops=9.0e+07
 sigma[gemm] counter=32 i=2 t=2.6e-04 per=8.3e+00 cost=2.3e+04 flops=9.0e+07
 sigma[gemm] counter=32 i=3 t=2.3e-04 per=7.5e+00 cost=2.3e+04 flops=9.8e+07
 sigma[gemm] counter=32 i=4 t=3.7e-04 per=1.2e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=32 i=5 t=3.8e-04 per=1.2e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=32 i=6 t=3.2e-04 per=1.0e+01 cost=4.4e+04 flops=1.4e+08
 sigma[gemm] counter=32 i=7 t=3.3e-04 per=1.1e+01 cost=4.4e+04 flops=1.4e+08
 sigma[gemm] counter=32 total t=2.5e-03 per=8.0e+01 cost=3.0e+05 flops=1.2e+08
 sigma[red] counter=32 t=3.2e-04 per=1.0e+01 cost=8.8e+04 flops=2.7e+08
--- TIMING FOR sigma_tot : t_inter=6.6e-03 t_gemm=5.5e-02 t_reduction=8.5e-03 tot=7.0e-02 ---
 sigma_tot[inter] counter=32 t=6.6e-03 per=9.5e+00 cost=1.8e+06 flops=2.8e+08
 sigma_tot[gemm] counter=32 i=0 t=6.3e-03 per=9.1e+00 cost=6.3e+05 flops=9.9e+07
 sigma_tot[gemm] counter=32 i=1 t=5.9e-03 per=8.4e+00 cost=6.3e+05 flops=1.1e+08
 sigma_tot[gemm] counter=32 i=2 t=5.4e-03 per=7.7e+00 cost=5.7e+05 flops=1.1e+08
 sigma_tot[gemm] counter=32 i=3 t=5.3e-03 per=7.6e+00 cost=5.7e+05 flops=1.1e+08
 sigma_tot[gemm] counter=32 i=4 t=8.9e-03 per=1.3e+01 cost=1.8e+06 flops=2.1e+08
 sigma_tot[gemm] counter=32 i=5 t=7.7e-03 per=1.1e+01 cost=1.8e+06 flops=2.4e+08
 sigma_tot[gemm] counter=32 i=6 t=7.5e-03 per=1.1e+01 cost=1.1e+06 flops=1.5e+08
 sigma_tot[gemm] counter=32 i=7 t=7.5e-03 per=1.1e+01 cost=1.1e+06 flops=1.5e+08
 sigma_tot[gemm] counter=32 total t=5.5e-02 per=7.8e+01 cost=8.3e+06 flops=1.5e+08
 sigma_tot[red] counter=32 t=8.5e-03 per=1.2e+01 cost=2.1e+06 flops=2.5e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.6e-05,3.5e-06,1.5e-06,2.4e-07
    6   0 -      -3.232646288802 -7.122e-06  1.458e-03    3     6  5.660e-02 9.433e-03 3.102e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.292e-05,3.084e-04,2.458e-03,3.117e-04,3.108e-03
 ndim=158:1.177e-06GB t[comm(intra)]=2.292e-05 speed=1.027e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=3.1e-04 t_gemm=2.5e-03 t_reduction=3.1e-04 tot=3.1e-03 ---
 sigma[inter] counter=33 t=3.1e-04 per=1.0e+01 cost=4.8e+04 flops=1.6e+08
 sigma[gemm] counter=33 i=0 t=2.9e-04 per=9.5e+00 cost=2.6e+04 flops=8.8e+07
 sigma[gemm] counter=33 i=1 t=2.8e-04 per=9.1e+00 cost=2.5e+04 flops=9.0e+07
 sigma[gemm] counter=33 i=2 t=2.4e-04 per=7.7e+00 cost=2.3e+04 flops=9.8e+07
 sigma[gemm] counter=33 i=3 t=2.4e-04 per=7.7e+00 cost=2.3e+04 flops=9.7e+07
 sigma[gemm] counter=33 i=4 t=3.7e-04 per=1.2e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=33 i=5 t=3.9e-04 per=1.3e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=33 i=6 t=3.2e-04 per=1.1e+01 cost=4.4e+04 flops=1.3e+08
 sigma[gemm] counter=33 i=7 t=3.3e-04 per=1.1e+01 cost=4.4e+04 flops=1.4e+08
 sigma[gemm] counter=33 total t=2.5e-03 per=8.0e+01 cost=3.0e+05 flops=1.2e+08
 sigma[red] counter=33 t=3.1e-04 per=1.0e+01 cost=8.8e+04 flops=2.8e+08
--- TIMING FOR sigma_tot : t_inter=6.9e-03 t_gemm=5.7e-02 t_reduction=8.8e-03 tot=7.3e-02 ---
 sigma_tot[inter] counter=33 t=6.9e-03 per=9.5e+00 cost=1.9e+06 flops=2.7e+08
 sigma_tot[gemm] counter=33 i=0 t=6.6e-03 per=9.1e+00 cost=6.5e+05 flops=9.9e+07
 sigma_tot[gemm] counter=33 i=1 t=6.1e-03 per=8.4e+00 cost=6.5e+05 flops=1.1e+08
 sigma_tot[gemm] counter=33 i=2 t=5.6e-03 per=7.7e+00 cost=5.9e+05 flops=1.1e+08
 sigma_tot[gemm] counter=33 i=3 t=5.5e-03 per=7.6e+00 cost=5.9e+05 flops=1.1e+08
 sigma_tot[gemm] counter=33 i=4 t=9.2e-03 per=1.3e+01 cost=1.9e+06 flops=2.1e+08
 sigma_tot[gemm] counter=33 i=5 t=8.1e-03 per=1.1e+01 cost=1.9e+06 flops=2.3e+08
 sigma_tot[gemm] counter=33 i=6 t=7.9e-03 per=1.1e+01 cost=1.2e+06 flops=1.5e+08
 sigma_tot[gemm] counter=33 i=7 t=7.9e-03 per=1.1e+01 cost=1.2e+06 flops=1.5e+08
 sigma_tot[gemm] counter=33 total t=5.7e-02 per=7.8e+01 cost=8.6e+06 flops=1.5e+08
 sigma_tot[red] counter=33 t=8.8e-03 per=1.2e+01 cost=2.2e+06 flops=2.5e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.6e-05,3.5e-06,1.6e-06,2.3e-07
    7   0 -      -3.232647690907 -1.402e-06  6.701e-04    3     7  6.471e-02 9.244e-03 3.126e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.132e-05,2.547e-04,2.058e-03,2.794e-04,2.621e-03
 ndim=158:1.177e-06GB t[comm(intra)]=2.132e-05 speed=1.104e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=2.5e-04 t_gemm=2.1e-03 t_reduction=2.8e-04 tot=2.6e-03 ---
 sigma[inter] counter=34 t=2.5e-04 per=9.8e+00 cost=4.8e+04 flops=1.9e+08
 sigma[gemm] counter=34 i=0 t=2.4e-04 per=9.2e+00 cost=2.6e+04 flops=1.1e+08
 sigma[gemm] counter=34 i=1 t=2.7e-04 per=1.0e+01 cost=2.5e+04 flops=9.5e+07
 sigma[gemm] counter=34 i=2 t=2.0e-04 per=7.6e+00 cost=2.3e+04 flops=1.2e+08
 sigma[gemm] counter=34 i=3 t=1.9e-04 per=7.5e+00 cost=2.3e+04 flops=1.2e+08
 sigma[gemm] counter=34 i=4 t=3.1e-04 per=1.2e+01 cost=5.7e+04 flops=1.9e+08
 sigma[gemm] counter=34 i=5 t=3.2e-04 per=1.2e+01 cost=5.7e+04 flops=1.8e+08
 sigma[gemm] counter=34 i=6 t=2.6e-04 per=1.0e+01 cost=4.4e+04 flops=1.6e+08
 sigma[gemm] counter=34 i=7 t=2.7e-04 per=1.0e+01 cost=4.4e+04 flops=1.6e+08
 sigma[gemm] counter=34 total t=2.1e-03 per=7.9e+01 cost=3.0e+05 flops=1.5e+08
 sigma[red] counter=34 t=2.8e-04 per=1.1e+01 cost=8.8e+04 flops=3.1e+08
--- TIMING FOR sigma_tot : t_inter=7.2e-03 t_gemm=5.9e-02 t_reduction=9.1e-03 tot=7.5e-02 ---
 sigma_tot[inter] counter=34 t=7.2e-03 per=9.6e+00 cost=1.9e+06 flops=2.7e+08
 sigma_tot[gemm] counter=34 i=0 t=6.9e-03 per=9.1e+00 cost=6.8e+05 flops=9.9e+07
 sigma_tot[gemm] counter=34 i=1 t=6.4e-03 per=8.5e+00 cost=6.8e+05 flops=1.1e+08
 sigma_tot[gemm] counter=34 i=2 t=5.8e-03 per=7.7e+00 cost=6.1e+05 flops=1.1e+08
 sigma_tot[gemm] counter=34 i=3 t=5.7e-03 per=7.6e+00 cost=6.2e+05 flops=1.1e+08
 sigma_tot[gemm] counter=34 i=4 t=9.6e-03 per=1.3e+01 cost=2.0e+06 flops=2.0e+08
 sigma_tot[gemm] counter=34 i=5 t=8.5e-03 per=1.1e+01 cost=1.9e+06 flops=2.3e+08
 sigma_tot[gemm] counter=34 i=6 t=8.1e-03 per=1.1e+01 cost=1.2e+06 flops=1.5e+08
 sigma_tot[gemm] counter=34 i=7 t=8.1e-03 per=1.1e+01 cost=1.2e+06 flops=1.5e+08
 sigma_tot[gemm] counter=34 total t=5.9e-02 per=7.8e+01 cost=8.9e+06 flops=1.5e+08
 sigma_tot[red] counter=34 t=9.1e-03 per=1.2e+01 cost=2.3e+06 flops=2.6e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.5e-05,3.2e-06,1.3e-06,2.2e-07
    8   0 -      -3.232647997784 -3.069e-07  4.156e-04    3     8  7.845e-02 9.806e-03 3.081e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.248e-05,3.072e-04,2.471e-03,3.176e-04,3.125e-03
 ndim=158:1.177e-06GB t[comm(intra)]=2.248e-05 speed=1.047e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=3.1e-04 t_gemm=2.5e-03 t_reduction=3.2e-04 tot=3.1e-03 ---
 sigma[inter] counter=35 t=3.1e-04 per=9.9e+00 cost=4.8e+04 flops=1.6e+08
 sigma[gemm] counter=35 i=0 t=2.9e-04 per=9.5e+00 cost=2.6e+04 flops=8.8e+07
 sigma[gemm] counter=35 i=1 t=2.8e-04 per=8.9e+00 cost=2.5e+04 flops=9.2e+07
 sigma[gemm] counter=35 i=2 t=2.6e-04 per=8.3e+00 cost=2.3e+04 flops=9.0e+07
 sigma[gemm] counter=35 i=3 t=2.3e-04 per=7.6e+00 cost=2.3e+04 flops=9.8e+07
 sigma[gemm] counter=35 i=4 t=3.7e-04 per=1.2e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=35 i=5 t=3.9e-04 per=1.3e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=35 i=6 t=3.2e-04 per=1.0e+01 cost=4.4e+04 flops=1.4e+08
 sigma[gemm] counter=35 i=7 t=3.3e-04 per=1.1e+01 cost=4.4e+04 flops=1.4e+08
 sigma[gemm] counter=35 total t=2.5e-03 per=8.0e+01 cost=3.0e+05 flops=1.2e+08
 sigma[red] counter=35 t=3.2e-04 per=1.0e+01 cost=8.8e+04 flops=2.8e+08
--- TIMING FOR sigma_tot : t_inter=7.5e-03 t_gemm=6.2e-02 t_reduction=9.4e-03 tot=7.8e-02 ---
 sigma_tot[inter] counter=35 t=7.5e-03 per=9.6e+00 cost=2.0e+06 flops=2.6e+08
 sigma_tot[gemm] counter=35 i=0 t=7.1e-03 per=9.1e+00 cost=7.0e+05 flops=9.8e+07
 sigma_tot[gemm] counter=35 i=1 t=6.7e-03 per=8.5e+00 cost=7.0e+05 flops=1.1e+08
 sigma_tot[gemm] counter=35 i=2 t=6.1e-03 per=7.7e+00 cost=6.4e+05 flops=1.1e+08
 sigma_tot[gemm] counter=35 i=3 t=6.0e-03 per=7.6e+00 cost=6.4e+05 flops=1.1e+08
 sigma_tot[gemm] counter=35 i=4 t=9.9e-03 per=1.3e+01 cost=2.0e+06 flops=2.0e+08
 sigma_tot[gemm] counter=35 i=5 t=8.8e-03 per=1.1e+01 cost=2.0e+06 flops=2.3e+08
 sigma_tot[gemm] counter=35 i=6 t=8.5e-03 per=1.1e+01 cost=1.3e+06 flops=1.5e+08
 sigma_tot[gemm] counter=35 i=7 t=8.5e-03 per=1.1e+01 cost=1.3e+06 flops=1.5e+08
 sigma_tot[gemm] counter=35 total t=6.2e-02 per=7.8e+01 cost=9.2e+06 flops=1.5e+08
 sigma_tot[red] counter=35 t=9.4e-03 per=1.2e+01 cost=2.4e+06 flops=2.6e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.6e-05,3.5e-06,1.6e-06,2.4e-07
    9   0 -      -3.232648142243 -1.445e-07  3.181e-04    3     9  8.661e-02 9.623e-03 3.105e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.287e-05,3.057e-04,2.477e-03,2.992e-04,3.111e-03
 ndim=158:1.177e-06GB t[comm(intra)]=2.287e-05 speed=1.030e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=3.1e-04 t_gemm=2.5e-03 t_reduction=3.0e-04 tot=3.1e-03 ---
 sigma[inter] counter=36 t=3.1e-04 per=9.9e+00 cost=4.8e+04 flops=1.6e+08
 sigma[gemm] counter=36 i=0 t=3.1e-04 per=1.0e+01 cost=2.6e+04 flops=8.3e+07
 sigma[gemm] counter=36 i=1 t=2.8e-04 per=9.0e+00 cost=2.5e+04 flops=9.1e+07
 sigma[gemm] counter=36 i=2 t=2.4e-04 per=7.7e+00 cost=2.3e+04 flops=9.7e+07
 sigma[gemm] counter=36 i=3 t=2.5e-04 per=8.2e+00 cost=2.3e+04 flops=9.1e+07
 sigma[gemm] counter=36 i=4 t=3.7e-04 per=1.2e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=36 i=5 t=3.7e-04 per=1.2e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=36 i=6 t=3.3e-04 per=1.1e+01 cost=4.4e+04 flops=1.3e+08
 sigma[gemm] counter=36 i=7 t=3.3e-04 per=1.1e+01 cost=4.4e+04 flops=1.4e+08
 sigma[gemm] counter=36 total t=2.5e-03 per=8.0e+01 cost=3.0e+05 flops=1.2e+08
 sigma[red] counter=36 t=3.0e-04 per=9.7e+00 cost=8.8e+04 flops=2.9e+08
--- TIMING FOR sigma_tot : t_inter=7.8e-03 t_gemm=6.4e-02 t_reduction=9.7e-03 tot=8.2e-02 ---
 sigma_tot[inter] counter=36 t=7.8e-03 per=9.6e+00 cost=2.0e+06 flops=2.6e+08
 sigma_tot[gemm] counter=36 i=0 t=7.5e-03 per=9.1e+00 cost=7.3e+05 flops=9.8e+07
 sigma_tot[gemm] counter=36 i=1 t=7.0e-03 per=8.5e+00 cost=7.3e+05 flops=1.0e+08
 sigma_tot[gemm] counter=36 i=2 t=6.3e-03 per=7.7e+00 cost=6.6e+05 flops=1.1e+08
 sigma_tot[gemm] counter=36 i=3 t=6.2e-03 per=7.6e+00 cost=6.6e+05 flops=1.1e+08
 sigma_tot[gemm] counter=36 i=4 t=1.0e-02 per=1.3e+01 cost=2.1e+06 flops=2.0e+08
 sigma_tot[gemm] counter=36 i=5 t=9.2e-03 per=1.1e+01 cost=2.1e+06 flops=2.2e+08
 sigma_tot[gemm] counter=36 i=6 t=8.8e-03 per=1.1e+01 cost=1.3e+06 flops=1.5e+08
 sigma_tot[gemm] counter=36 i=7 t=8.8e-03 per=1.1e+01 cost=1.3e+06 flops=1.5e+08
 sigma_tot[gemm] counter=36 total t=6.4e-02 per=7.9e+01 cost=9.5e+06 flops=1.5e+08
 sigma_tot[red] counter=36 t=9.7e-03 per=1.2e+01 cost=2.5e+06 flops=2.6e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.6e-05,3.6e-06,1.5e-06,2.7e-07
   10   0 -      -3.232648227601 -8.536e-08  2.405e-04    3    10  9.617e-02 9.617e-03 3.122e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.203e-05,3.063e-04,2.458e-03,3.176e-04,3.110e-03
 ndim=158:1.177e-06GB t[comm(intra)]=2.203e-05 speed=1.069e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=3.1e-04 t_gemm=2.5e-03 t_reduction=3.2e-04 tot=3.1e-03 ---
 sigma[inter] counter=37 t=3.1e-04 per=9.9e+00 cost=4.8e+04 flops=1.6e+08
 sigma[gemm] counter=37 i=0 t=2.9e-04 per=9.4e+00 cost=2.6e+04 flops=8.9e+07
 sigma[gemm] counter=37 i=1 t=2.7e-04 per=8.9e+00 cost=2.5e+04 flops=9.2e+07
 sigma[gemm] counter=37 i=2 t=2.6e-04 per=8.3e+00 cost=2.3e+04 flops=9.0e+07
 sigma[gemm] counter=37 i=3 t=2.4e-04 per=7.7e+00 cost=2.3e+04 flops=9.7e+07
 sigma[gemm] counter=37 i=4 t=3.7e-04 per=1.2e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=37 i=5 t=3.8e-04 per=1.2e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=37 i=6 t=3.2e-04 per=1.1e+01 cost=4.4e+04 flops=1.3e+08
 sigma[gemm] counter=37 i=7 t=3.3e-04 per=1.1e+01 cost=4.4e+04 flops=1.4e+08
 sigma[gemm] counter=37 total t=2.5e-03 per=8.0e+01 cost=3.0e+05 flops=1.2e+08
 sigma[red] counter=37 t=3.2e-04 per=1.0e+01 cost=8.8e+04 flops=2.8e+08
--- TIMING FOR sigma_tot : t_inter=8.1e-03 t_gemm=6.6e-02 t_reduction=1.0e-02 tot=8.5e-02 ---
 sigma_tot[inter] counter=37 t=8.1e-03 per=9.6e+00 cost=2.1e+06 flops=2.6e+08
 sigma_tot[gemm] counter=37 i=0 t=7.7e-03 per=9.2e+00 cost=7.5e+05 flops=9.7e+07
 sigma_tot[gemm] counter=37 i=1 t=7.2e-03 per=8.6e+00 cost=7.5e+05 flops=1.0e+08
 sigma_tot[gemm] counter=37 i=2 t=6.5e-03 per=7.7e+00 cost=6.8e+05 flops=1.0e+08
 sigma_tot[gemm] counter=37 i=3 t=6.5e-03 per=7.6e+00 cost=6.8e+05 flops=1.1e+08
 sigma_tot[gemm] counter=37 i=4 t=1.1e-02 per=1.3e+01 cost=2.1e+06 flops=2.0e+08
 sigma_tot[gemm] counter=37 i=5 t=9.6e-03 per=1.1e+01 cost=2.1e+06 flops=2.2e+08
 sigma_tot[gemm] counter=37 i=6 t=9.1e-03 per=1.1e+01 cost=1.3e+06 flops=1.5e+08
 sigma_tot[gemm] counter=37 i=7 t=9.1e-03 per=1.1e+01 cost=1.4e+06 flops=1.5e+08
 sigma_tot[gemm] counter=37 total t=6.6e-02 per=7.9e+01 cost=9.8e+06 flops=1.5e+08
 sigma_tot[red] counter=37 t=1.0e-02 per=1.2e+01 cost=2.6e+06 flops=2.6e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.6e-05,3.2e-06,1.5e-06,2.3e-07
   11   0 -      -3.232648270473 -4.287e-08  1.418e-04    3    11  1.036e-01 9.415e-03 3.136e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.238e-05,2.657e-04,2.050e-03,2.663e-04,2.612e-03
 ndim=158:1.177e-06GB t[comm(intra)]=2.238e-05 speed=1.052e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=2.7e-04 t_gemm=2.0e-03 t_reduction=2.7e-04 tot=2.6e-03 ---
 sigma[inter] counter=38 t=2.7e-04 per=1.0e+01 cost=4.8e+04 flops=1.8e+08
 sigma[gemm] counter=38 i=0 t=2.4e-04 per=9.3e+00 cost=2.6e+04 flops=1.1e+08
 sigma[gemm] counter=38 i=1 t=2.4e-04 per=9.4e+00 cost=2.5e+04 flops=1.0e+08
 sigma[gemm] counter=38 i=2 t=2.0e-04 per=7.6e+00 cost=2.3e+04 flops=1.2e+08
 sigma[gemm] counter=38 i=3 t=2.1e-04 per=8.2e+00 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=38 i=4 t=3.0e-04 per=1.2e+01 cost=5.7e+04 flops=1.9e+08
 sigma[gemm] counter=38 i=5 t=3.0e-04 per=1.2e+01 cost=5.7e+04 flops=1.9e+08
 sigma[gemm] counter=38 i=6 t=2.7e-04 per=1.0e+01 cost=4.4e+04 flops=1.6e+08
 sigma[gemm] counter=38 i=7 t=2.8e-04 per=1.1e+01 cost=4.4e+04 flops=1.6e+08
 sigma[gemm] counter=38 total t=2.0e-03 per=7.9e+01 cost=3.0e+05 flops=1.5e+08
 sigma[red] counter=38 t=2.7e-04 per=1.0e+01 cost=8.8e+04 flops=3.3e+08
--- TIMING FOR sigma_tot : t_inter=8.4e-03 t_gemm=6.9e-02 t_reduction=1.0e-02 tot=8.7e-02 ---
 sigma_tot[inter] counter=38 t=8.4e-03 per=9.6e+00 cost=2.1e+06 flops=2.5e+08
 sigma_tot[gemm] counter=38 i=0 t=8.0e-03 per=9.2e+00 cost=7.8e+05 flops=9.8e+07
 sigma_tot[gemm] counter=38 i=1 t=7.5e-03 per=8.6e+00 cost=7.8e+05 flops=1.0e+08
 sigma_tot[gemm] counter=38 i=2 t=6.7e-03 per=7.7e+00 cost=7.1e+05 flops=1.0e+08
 sigma_tot[gemm] counter=38 i=3 t=6.7e-03 per=7.7e+00 cost=7.1e+05 flops=1.1e+08
 sigma_tot[gemm] counter=38 i=4 t=1.1e-02 per=1.3e+01 cost=2.2e+06 flops=2.0e+08
 sigma_tot[gemm] counter=38 i=5 t=9.9e-03 per=1.1e+01 cost=2.2e+06 flops=2.2e+08
 sigma_tot[gemm] counter=38 i=6 t=9.4e-03 per=1.1e+01 cost=1.4e+06 flops=1.5e+08
 sigma_tot[gemm] counter=38 i=7 t=9.4e-03 per=1.1e+01 cost=1.4e+06 flops=1.5e+08
 sigma_tot[gemm] counter=38 total t=6.9e-02 per=7.9e+01 cost=1.0e+07 flops=1.5e+08
 sigma_tot[red] counter=38 t=1.0e-02 per=1.2e+01 cost=2.7e+06 flops=2.6e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.6e-05,3.2e-06,1.3e-06,2.2e-07
   12   0 +      -3.232648284263 -1.379e-08  6.485e-05    3    12  1.170e-01 9.746e-03 3.105e-03
TIMING FOR Davidson : 1.170e-01  T(cal/comm/rest)=3.726e-02,1.494e-06,7.971e-02
decomposed t_rest=7.971e-02
 T(sub)    =2.904e-04 per=3.643e-01
 T(precond)=7.896e-02 per=9.905e+01
 T(ortho)  =7.000e-05 per=8.782e-02
 T(xcopy)  =1.628e-06 per=2.042e-03
 T(xnrm2)  =6.957e-06 per=8.727e-03
 T(other)  =3.901e-04 per=4.893e-01
optimized energies: isweep=0 ibond=4 dots=2 e[0]=-3.232648284263 nmvp=12
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.123e+02S Sys:1.311e+00S Total:1.136e+02S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=10 nqr=15 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond4.txt
 qbond: qsuper nsym=15 dimAll=40
 (2,0):5 (1,1):1 (1,-1):1 (4,0):6 (3,1):6 (3,-1):6 (2,2):2 (2,-2):2 (6,0):1 (5,1):2 (5,-1):2 (4,2):2 (4,-2):2 (3,3):1 (3,-3):1
timing for divide=1.6e-05
timing for compute=1.4e-04
timing for collect=1.8e-05
----- TMING FOR decimation_genbasis(nkr): 1.8e-04 S T(divide/compute/collect)=1.6e-05,1.4e-04,1.8e-05 -----
decimation summary: 40->10 dwt=+1.938e-03 SvN=1.338e+00
 qbond: qkept nsym=6 dimAll=10
 (3,1):3 (3,-1):3 (2,0):1 (4,0):1 (2,2):1 (4,2):1
----- TIMING for decimation_row(nkr): 5.600e-04 S T(decim/select/formRot)=2.440e-04,2.794e-04,3.660e-05 -----
----- TIMING FOR twodot_decimation: 9.154e-04 S T(wf/decim)=3.221e-04,5.934e-04 -----
ctns::oper_renorm coord=(3,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:6 S:6 H:1 A:15 B:21 
        dim(bra,ket)=10,10 size(op)=22:1.678e-04MB size(tot)=517:3.944e-03MB:3.852e-06GB
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.123e+02S Sys:1.312e+00S Total:1.137e+02S
----- TIMING FOR symbolic_formulae_renorm with size=49 : 1.161e-03 S -----
rank=0 GPUmem(GB): used=1.11e-05 (oper)=7.46e-06
rank=0 GPUmem(GB): used=1.14e-05 (oper,site)(GB)=7.46e-06,3.8e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=49
 no. of rintermediate operators=24
 no. of coefficients=48:0.000366MB:3.58e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 7.159e-05 S -----
rank=0 GPUmem(GB): used=1.18e-05 (oper,site,rinter)=7.46e-06,3.8e-07,3.58e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00227 S size(rtasks)=49 size(Rlst2)=36 T(Rmu/Rlist)=0.000503,0.00176 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00243 S size(rtasks)=49 size(Rlst)=1538 -----
rank=0 GPUmem(GB): used=1.18e-05 (oper,site,rinter,batch)=7.46e-06,3.8e-07,3.58e-07,0.000252 blksize=9 blksize0=3 batchsize=1538
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.81e-05,0.000541,0.000178
--- TIMING FOR renorm : t_inter=9.8e-05 t_gemm=5.4e-04 t_reduction=1.8e-04 tot=8.2e-04 ---
 renorm[inter] counter=5 t=9.8e-05 per=1.2e+01 cost=1.2e+03 flops=1.3e+07
 renorm[gemm] counter=5 i=0 t=8.1e-05 per=9.9e+00 cost=4.0e+03 flops=4.9e+07
 renorm[gemm] counter=5 i=1 t=7.4e-05 per=9.1e+00 cost=3.3e+03 flops=4.4e+07
 renorm[gemm] counter=5 i=2 t=1.2e-04 per=1.4e+01 cost=5.5e+03 flops=4.8e+07
 renorm[gemm] counter=5 i=3 t=1.2e-04 per=1.5e+01 cost=8.2e+03 flops=6.7e+07
 renorm[gemm] counter=5 i=4 t=1.1e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=5 t=1.1e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=6 t=1.4e-04 per=1.8e+01 cost=1.7e+04 flops=1.2e+08
 renorm[gemm] counter=5 total t=5.4e-04 per=6.6e+01 cost=3.8e+04 flops=7.1e+07
 renorm[red] counter=5 t=1.8e-04 per=2.2e+01 cost=1.1e+04 flops=6.3e+07
--- TIMING FOR renorm_tot : t_inter=3.0e-04 t_gemm=2.6e-03 t_reduction=8.3e-04 tot=3.7e-03 ---
 renorm_tot[inter] counter=5 t=3.0e-04 per=8.2e+00 cost=1.3e+04 flops=4.4e+07
 renorm_tot[gemm] counter=5 i=0 t=4.2e-04 per=1.1e+01 cost=1.0e+04 flops=2.5e+07
 renorm_tot[gemm] counter=5 i=1 t=3.7e-04 per=1.0e+01 cost=1.3e+04 flops=3.6e+07
 renorm_tot[gemm] counter=5 i=2 t=1.8e-04 per=4.8e+00 cost=6.3e+03 flops=3.6e+07
 renorm_tot[gemm] counter=5 i=3 t=1.8e-04 per=4.9e+00 cost=9.1e+03 flops=5.0e+07
 renorm_tot[gemm] counter=5 i=4 t=3.9e-04 per=1.0e+01 cost=1.1e+04 flops=2.9e+07
 renorm_tot[gemm] counter=5 i=5 t=3.8e-04 per=1.0e+01 cost=1.5e+04 flops=3.9e+07
 renorm_tot[gemm] counter=5 i=6 t=6.7e-04 per=1.8e+01 cost=6.2e+04 flops=9.3e+07
 renorm_tot[gemm] counter=5 total t=2.6e-03 per=7.0e+01 cost=1.3e+05 flops=4.9e+07
 renorm_tot[red] counter=5 t=8.3e-04 per=2.2e+01 cost=4.0e+04 flops=4.8e+07
qops.to_cpu: size(tot)=517:3.9e-03MB:3.9e-06GB t[to_cpu]=1.4e-05S speed=2.7e-01GB/S
check ||H-H.dagger||=5.894e-16 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=cr ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 0.321 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.000378,7.36e-06,0.13,0.19,3.7e-05,5.17e-05 -----
----- TIMING FOR oper_renorm : 0.0158 S rank=0 -----
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.478e+02S Sys:1.329e+00S Total:1.492e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=2 mem=4:3.052e-05MB:2.980e-08GB
 cpsi: len=1 mem=51:3.891e-04MB:3.800e-07GB
total mem of comb=257:1.961e-03MB:1.915e-06GB
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.480e+02S Sys:1.330e+00S Total:1.493e+02S
##### local opt: 6.398e-01 S #####
 T(local opt: fetch) = 2.052e-04 S  per = 0.0321  per(accum) = 0.0321
 T(local opt: hdiag) = 1.458e-03 S  per = 0.228  per(accum) = 0.26
 T(local opt: dvdsn) = 2.984e-01 S  per = 46.6  per(accum) = 46.9
 T(local opt: decim) = 9.249e-04 S  per = 0.145  per(accum) = 47
 T(local opt: guess) = 3.442e-04 S  per = 0.0538  per(accum) = 47.1
 T(local opt: renrm) = 3.374e-01 S  per = 52.7  per(accum) = 99.8
 T(local opt: save ) = 1.068e-03 S  per = 0.167  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.984e-01 S  T(sum) = 2.980e-01 S  per = 9.986e+01
 T(local opt: preprocess                  ) = 1.185e-03 S  per = 0.398  per(accum) = 0.398
 T(local opt: symbolic_formulae           ) = 3.597e-03 S  per = 1.21  per(accum) = 1.61
 T(local opt: hintermediate init          ) = 1.496e-04 S  per = 0.0502  per(accum) = 1.66
 T(local opt: preprocess_hformulae_Hxlist ) = 2.653e-02 S  per =  8.9  per(accum) = 10.6
 T(local opt: hmmtasks init               ) = 1.492e-01 S  per = 50.1  per(accum) = 60.6
 T(local opt: initial guess for dvdson    ) = 3.034e-04 S  per = 0.102  per(accum) = 60.7
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.699e-02 S  per = 12.4  per(accum) = 73.2
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.687e-04 S  per = 0.0902  per(accum) = 73.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.494e-06 S  per = 0.000501  per(accum) = 73.2
 T(local opt: dvdson solver [rest part]   ) = 7.971e-02 S  per = 26.8  per(accum) = 100
Detailed decomposition of T(renrm) = 3.374e-01 S  T(sum) = 3.374e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.335e-04 S  per = 0.0396  per(accum) = 0.0396
 T(local opt: qops init                    ) = 4.754e-04 S  per = 0.141  per(accum) = 0.18
 T(local opt: symbolic_formulae_renorm     ) = 1.170e-03 S  per = 0.347  per(accum) = 0.527
 T(local opt: allocate qops on gpu         ) = 2.437e-05 S  per = 0.00722  per(accum) = 0.534
 T(local opt: site memcpy cpu2gpu          ) = 1.958e-05 S  per = 0.0058  per(accum) = 0.54
 T(local opt: rintermediate init           ) = 8.141e-05 S  per = 0.0241  per(accum) = 0.564
 T(local opt: preprocess_formulae_Rlist2   ) = 2.484e-03 S  per = 0.736  per(accum) = 1.3
 T(local opt: rmmtasks init                ) = 1.061e-02 S  per = 3.15  per(accum) = 4.45
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 9.78e-06  per(accum) = 4.45
 T(local opt: preprocess_renorm_batchGPU   ) = 9.205e-04 S  per = 0.273  per(accum) = 4.72
 T(local opt: reduction of opS & opH [nccl]) = 1.161e-06 S  per = 0.000344  per(accum) = 4.72
 T(local opt: qops memcpy gpu2cpu          ) = 1.985e-05 S  per = 0.00588  per(accum) = 4.73
 T(local opt: deallocate cpu and gpu memory) = 1.142e-05 S  per = 0.00338  per(accum) = 4.73
 T(local opt: reduction of opS & opH [comm]) = 2.359e-05 S  per = 0.00699  per(accum) = 4.74
 T(local opt: conversion from opAB to opPQ ) = 3.210e-01 S  per = 95.1  per(accum) = 99.9
 T(local opt: after oper_renorm            ) = 3.871e-04 S  per = 0.115  per(accum) = 100
##### sweep opt: 1.416e+00 S #####
 T(sweep opt: fetch) = 4.302e-03 S  per = 0.304  per(accum) = 0.304
 T(sweep opt: hdiag) = 4.931e-03 S  per = 0.348  per(accum) = 0.652
 T(sweep opt: dvdsn) = 8.766e-01 S  per = 61.9  per(accum) = 62.5
 T(sweep opt: decim) = 4.328e-03 S  per = 0.306  per(accum) = 62.8
 T(sweep opt: guess) = 1.593e-03 S  per = 0.112  per(accum) = 63
 T(sweep opt: renrm) = 5.226e-01 S  per = 36.9  per(accum) = 99.9
 T(sweep opt: save ) = 2.026e-03 S  per = 0.143  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.766e-01 S  T(sum) = 8.751e-01 S  per = 9.983e+01
 T(sweep opt: preprocess                  ) = 4.347e-03 S  per = 0.497  per(accum) = 0.497
 T(sweep opt: symbolic_formulae           ) = 1.308e-02 S  per = 1.49  per(accum) = 1.99
 T(sweep opt: hintermediate init          ) = 5.691e-04 S  per = 0.065  per(accum) = 2.06
 T(sweep opt: preprocess_hformulae_Hxlist ) = 8.185e-02 S  per = 9.35  per(accum) = 11.4
 T(sweep opt: hmmtasks init               ) = 4.389e-01 S  per = 50.2  per(accum) = 61.6
 T(sweep opt: initial guess for dvdson    ) = 1.254e-03 S  per = 0.143  per(accum) = 61.7
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 9.354e-02 S  per = 10.7  per(accum) = 72.4
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 8.960e-04 S  per = 0.102  per(accum) = 72.5
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 4.509e-06 S  per = 0.000515  per(accum) = 72.5
 T(sweep opt: dvdson solver [rest part]   ) = 2.407e-01 S  per = 27.5  per(accum) = 100
Detailed decomposition of T(renrm) = 5.226e-01 S  T(sum) = 5.226e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.021e-04 S  per = 0.0961  per(accum) = 0.0961
 T(sweep opt: qops init                    ) = 2.478e-03 S  per = 0.474  per(accum) = 0.57
 T(sweep opt: symbolic_formulae_renorm     ) = 5.098e-03 S  per = 0.976  per(accum) = 1.55
 T(sweep opt: allocate qops on gpu         ) = 1.147e-04 S  per = 0.022  per(accum) = 1.57
 T(sweep opt: site memcpy cpu2gpu          ) = 1.135e-04 S  per = 0.0217  per(accum) = 1.59
 T(sweep opt: rintermediate init           ) = 3.924e-04 S  per = 0.0751  per(accum) = 1.66
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.727e-03 S  per = 1.67  per(accum) = 3.33
 T(sweep opt: rmmtasks init                ) = 3.453e-02 S  per = 6.61  per(accum) = 9.94
 T(sweep opt: qops memset on cpu           ) = 2.370e-07 S  per = 4.54e-05  per(accum) = 9.94
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.246e-03 S  per = 0.812  per(accum) = 10.8
 T(sweep opt: reduction of opS & opH [nccl]) = 5.473e-06 S  per = 0.00105  per(accum) = 10.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.003e-04 S  per = 0.0192  per(accum) = 10.8
 T(sweep opt: deallocate cpu and gpu memory) = 5.532e-05 S  per = 0.0106  per(accum) = 10.8
 T(sweep opt: reduction of opS & opH [comm]) = 1.231e-04 S  per = 0.0235  per(accum) = 10.8
 T(sweep opt: conversion from opAB to opPQ ) = 4.647e-01 S  per = 88.9  per(accum) = 99.7
 T(sweep opt: after oper_renorm            ) = 1.385e-03 S  per = 0.265  per(accum) = 100
##### global opt: 1.416e+00 S #####
 T(global opt: fetch) = 4.302e-03 S  per = 0.304  per(accum) = 0.304
 T(global opt: hdiag) = 4.931e-03 S  per = 0.348  per(accum) = 0.652
 T(global opt: dvdsn) = 8.766e-01 S  per = 61.9  per(accum) = 62.5
 T(global opt: decim) = 4.328e-03 S  per = 0.306  per(accum) = 62.8
 T(global opt: guess) = 1.593e-03 S  per = 0.112  per(accum) = 63
 T(global opt: renrm) = 5.226e-01 S  per = 36.9  per(accum) = 99.9
 T(global opt: save ) = 2.026e-03 S  per = 0.143  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.766e-01 S  T(sum) = 8.751e-01 S  per = 9.983e+01
 T(global opt: preprocess                  ) = 4.347e-03 S  per = 0.497  per(accum) = 0.497
 T(global opt: symbolic_formulae           ) = 1.308e-02 S  per = 1.49  per(accum) = 1.99
 T(global opt: hintermediate init          ) = 5.691e-04 S  per = 0.065  per(accum) = 2.06
 T(global opt: preprocess_hformulae_Hxlist ) = 8.185e-02 S  per = 9.35  per(accum) = 11.4
 T(global opt: hmmtasks init               ) = 4.389e-01 S  per = 50.2  per(accum) = 61.6
 T(global opt: initial guess for dvdson    ) = 1.254e-03 S  per = 0.143  per(accum) = 61.7
 T(global opt: dvdson solver [Hx_batchGPU] ) = 9.354e-02 S  per = 10.7  per(accum) = 72.4
 T(global opt: dvdson solver [comm(gpu)]   ) = 8.960e-04 S  per = 0.102  per(accum) = 72.5
 T(global opt: dvdson solver [comm(cpu)]   ) = 4.509e-06 S  per = 0.000515  per(accum) = 72.5
 T(global opt: dvdson solver [rest part]   ) = 2.407e-01 S  per = 27.5  per(accum) = 100
Detailed decomposition of T(renrm) = 5.226e-01 S  T(sum) = 5.226e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.021e-04 S  per = 0.0961  per(accum) = 0.0961
 T(global opt: qops init                    ) = 2.478e-03 S  per = 0.474  per(accum) = 0.57
 T(global opt: symbolic_formulae_renorm     ) = 5.098e-03 S  per = 0.976  per(accum) = 1.55
 T(global opt: allocate qops on gpu         ) = 1.147e-04 S  per = 0.022  per(accum) = 1.57
 T(global opt: site memcpy cpu2gpu          ) = 1.135e-04 S  per = 0.0217  per(accum) = 1.59
 T(global opt: rintermediate init           ) = 3.924e-04 S  per = 0.0751  per(accum) = 1.66
 T(global opt: preprocess_formulae_Rlist2   ) = 8.727e-03 S  per = 1.67  per(accum) = 3.33
 T(global opt: rmmtasks init                ) = 3.453e-02 S  per = 6.61  per(accum) = 9.94
 T(global opt: qops memset on cpu           ) = 2.370e-07 S  per = 4.54e-05  per(accum) = 9.94
 T(global opt: preprocess_renorm_batchGPU   ) = 4.246e-03 S  per = 0.812  per(accum) = 10.8
 T(global opt: reduction of opS & opH [nccl]) = 5.473e-06 S  per = 0.00105  per(accum) = 10.8
 T(global opt: qops memcpy gpu2cpu          ) = 1.003e-04 S  per = 0.0192  per(accum) = 10.8
 T(global opt: deallocate cpu and gpu memory) = 5.532e-05 S  per = 0.0106  per(accum) = 10.8
 T(global opt: reduction of opS & opH [comm]) = 1.231e-04 S  per = 0.0235  per(accum) = 10.8
 T(global opt: conversion from opAB to opPQ ) = 4.647e-01 S  per = 88.9  per(accum) = 99.7
 T(global opt: after oper_renorm            ) = 1.385e-03 S  per = 0.265  per(accum) = 100

isweep=0 ibond=5/seqsize=6 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.482e+02S Sys:1.331e+00S Total:1.495e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=2 mem=4:3.052e-05MB:2.980e-08GB
 cpsi: len=1 mem=51:3.891e-04MB:3.800e-07GB
total mem of comb=257:1.961e-03MB:1.915e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,3,1,1
 suppl= 0
 suppr= 3 4 5
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 rqops: oplist=CSHPQ nops=C:6 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=10,10 size(op)=22:1.678e-04MB size(tot)=517:3.944e-03MB:3.852e-06GB
 c1qops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 c2qops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 qops(tot)=1141:8.705e-03MB:8.501e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
wf4(diml,dimr,dimc1,dimc2)=(4,10,4,4) nnz=78:5.951e-04MB
qtensor4: wf4 own=1 _data=0x4b9bf560
qinfo4: wf4 sym=(6,0)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=6 dimAll=10
 (3,1):3 (3,-1):3 (2,0):1 (4,0):1 (2,2):1 (4,2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=42 nblocks=384 size=78:5.951e-04MB
### DIAG TIMING: total=8.238e-04 t1=1.354e-05, t2=1.821e-05, t3=2.817e-04, t4=4.654e-04, t5=2.758e-05, t6=1.273e-05, t7=4.690e-06
duration_diagGPU:8.370e-04
duration_diagreduce:4.900e-08
duration_diagtransform:6.570e-07
----- TIMING FOR symbolic_formulae_twodot with size=210 : 1.950e-03 S -----
rank=0 GPUmem(GB): used=8.5e-06 (oper)=8.5e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=210
 no. of hintermediate operators=58
 no. of coefficients=174:0.00133MB:1.3e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.474e-05 S -----
rank=0 GPUmem(GB): used=9.8e-06 (oper,hinter)=8.5e-06,1.3e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00651 S size(H_formulae)=210 size(Hxlst2)=42 T(Hmu/Hxlist)=0.000594,0.00591 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00695 S size(H_formulae)=210 size(Hxlst)=5006 -----
rank=0 GPUmem(GB): used=0.000384 (oper,hinter,dvdson,batch)=8.5e-06,1.3e-06,1.16e-06,0.000373 blksize=3 blksize0=3 batchsize=5006
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=78 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.19e-05,0.000107,0.000774,0.000215,0.00113
 ndim=78:5.81e-07GB t[comm(intra)]=2.19e-05 speed=0.053GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=7.7e-04 t_reduction=2.1e-04 tot=1.1e-03 ---
 sigma[inter] counter=39 t=1.1e-04 per=9.7e+00 cost=1.9e+04 flops=1.8e+08
 sigma[gemm] counter=39 i=0 t=9.5e-05 per=8.7e+00 cost=5.2e+03 flops=5.5e+07
 sigma[gemm] counter=39 i=1 t=8.8e-05 per=8.1e+00 cost=5.2e+03 flops=5.9e+07
 sigma[gemm] counter=39 i=2 t=9.0e-05 per=8.3e+00 cost=5.9e+03 flops=6.5e+07
 sigma[gemm] counter=39 i=3 t=9.1e-05 per=8.3e+00 cost=5.9e+03 flops=6.5e+07
 sigma[gemm] counter=39 i=4 t=1.2e-04 per=1.1e+01 cost=1.2e+04 flops=1.0e+08
 sigma[gemm] counter=39 i=5 t=1.1e-04 per=1.0e+01 cost=1.2e+04 flops=1.1e+08
 sigma[gemm] counter=39 i=6 t=9.1e-05 per=8.3e+00 cost=5.9e+03 flops=6.4e+07
 sigma[gemm] counter=39 i=7 t=8.9e-05 per=8.2e+00 cost=5.9e+03 flops=6.6e+07
 sigma[gemm] counter=39 total t=7.7e-04 per=7.1e+01 cost=5.8e+04 flops=7.5e+07
 sigma[red] counter=39 t=2.1e-04 per=2.0e+01 cost=1.9e+04 flops=9.0e+07
--- TIMING FOR sigma_tot : t_inter=8.5e-03 t_gemm=6.9e-02 t_reduction=1.0e-02 tot=8.8e-02 ---
 sigma_tot[inter] counter=39 t=8.5e-03 per=9.6e+00 cost=2.1e+06 flops=2.5e+08
 sigma_tot[gemm] counter=39 i=0 t=8.1e-03 per=9.2e+00 cost=7.9e+05 flops=9.7e+07
 sigma_tot[gemm] counter=39 i=1 t=7.6e-03 per=8.6e+00 cost=7.8e+05 flops=1.0e+08
 sigma_tot[gemm] counter=39 i=2 t=6.8e-03 per=7.7e+00 cost=7.1e+05 flops=1.0e+08
 sigma_tot[gemm] counter=39 i=3 t=6.8e-03 per=7.7e+00 cost=7.1e+05 flops=1.1e+08
 sigma_tot[gemm] counter=39 i=4 t=1.1e-02 per=1.3e+01 cost=2.2e+06 flops=2.0e+08
 sigma_tot[gemm] counter=39 i=5 t=1.0e-02 per=1.1e+01 cost=2.2e+06 flops=2.2e+08
 sigma_tot[gemm] counter=39 i=6 t=9.5e-03 per=1.1e+01 cost=1.4e+06 flops=1.5e+08
 sigma_tot[gemm] counter=39 i=7 t=9.5e-03 per=1.1e+01 cost=1.4e+06 flops=1.5e+08
 sigma_tot[gemm] counter=39 total t=6.9e-02 per=7.9e+01 cost=1.0e+07 flops=1.5e+08
 sigma_tot[red] counter=39 t=1.0e-02 per=1.2e+01 cost=2.7e+06 flops=2.6e+08
T(sub)=9.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.5e-06,2.0e-06,6.6e-07,1.9e-07
settings: ndim=78 neig=1 maxcycle=30 nbuff=4 memory=9e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.229929054672 -1.003e+03  5.784e-02    1     1  1.268e-03 1.268e-03 1.244e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.198e-05,1.096e-04,8.187e-04,1.462e-04,1.104e-03
 ndim=78:5.811e-07GB t[comm(intra)]=2.198e-05 speed=5.289e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=8.2e-04 t_reduction=1.5e-04 tot=1.1e-03 ---
 sigma[inter] counter=40 t=1.1e-04 per=1.0e+01 cost=1.9e+04 flops=1.8e+08
 sigma[gemm] counter=40 i=0 t=9.5e-05 per=8.8e+00 cost=5.2e+03 flops=5.5e+07
 sigma[gemm] counter=40 i=1 t=9.2e-05 per=8.6e+00 cost=5.2e+03 flops=5.7e+07
 sigma[gemm] counter=40 i=2 t=1.1e-04 per=1.1e+01 cost=5.9e+03 flops=5.2e+07
 sigma[gemm] counter=40 i=3 t=1.0e-04 per=9.3e+00 cost=5.9e+03 flops=5.9e+07
 sigma[gemm] counter=40 i=4 t=1.2e-04 per=1.1e+01 cost=1.2e+04 flops=9.8e+07
 sigma[gemm] counter=40 i=5 t=1.2e-04 per=1.1e+01 cost=1.2e+04 flops=9.8e+07
 sigma[gemm] counter=40 i=6 t=8.7e-05 per=8.2e+00 cost=5.9e+03 flops=6.7e+07
 sigma[gemm] counter=40 i=7 t=8.7e-05 per=8.2e+00 cost=5.9e+03 flops=6.7e+07
 sigma[gemm] counter=40 total t=8.2e-04 per=7.6e+01 cost=5.8e+04 flops=7.1e+07
 sigma[red] counter=40 t=1.5e-04 per=1.4e+01 cost=1.9e+04 flops=1.3e+08
--- TIMING FOR sigma_tot : t_inter=8.6e-03 t_gemm=7.0e-02 t_reduction=1.1e-02 tot=8.9e-02 ---
 sigma_tot[inter] counter=40 t=8.6e-03 per=9.6e+00 cost=2.2e+06 flops=2.5e+08
 sigma_tot[gemm] counter=40 i=0 t=8.2e-03 per=9.2e+00 cost=7.9e+05 flops=9.7e+07
 sigma_tot[gemm] counter=40 i=1 t=7.7e-03 per=8.6e+00 cost=7.9e+05 flops=1.0e+08
 sigma_tot[gemm] counter=40 i=2 t=6.9e-03 per=7.8e+00 cost=7.2e+05 flops=1.0e+08
 sigma_tot[gemm] counter=40 i=3 t=6.9e-03 per=7.7e+00 cost=7.2e+05 flops=1.0e+08
 sigma_tot[gemm] counter=40 i=4 t=1.1e-02 per=1.3e+01 cost=2.2e+06 flops=2.0e+08
 sigma_tot[gemm] counter=40 i=5 t=1.0e-02 per=1.1e+01 cost=2.2e+06 flops=2.2e+08
 sigma_tot[gemm] counter=40 i=6 t=9.6e-03 per=1.1e+01 cost=1.4e+06 flops=1.5e+08
 sigma_tot[gemm] counter=40 i=7 t=9.6e-03 per=1.1e+01 cost=1.4e+06 flops=1.5e+08
 sigma_tot[gemm] counter=40 total t=7.0e-02 per=7.8e+01 cost=1.0e+07 flops=1.5e+08
 sigma_tot[red] counter=40 t=1.1e-02 per=1.2e+01 cost=2.7e+06 flops=2.5e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.2e-05,4.0e-06,1.1e-06,2.2e-07
    2   0 -      -3.231518654208 -1.590e-03  1.716e-02    2     2  1.200e-02 6.000e-03 1.246e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.206e-05,1.100e-04,8.095e-04,1.456e-04,1.095e-03
 ndim=78:5.811e-07GB t[comm(intra)]=2.206e-05 speed=5.269e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=8.1e-04 t_reduction=1.5e-04 tot=1.1e-03 ---
 sigma[inter] counter=41 t=1.1e-04 per=1.0e+01 cost=1.9e+04 flops=1.8e+08
 sigma[gemm] counter=41 i=0 t=9.5e-05 per=8.9e+00 cost=5.2e+03 flops=5.5e+07
 sigma[gemm] counter=41 i=1 t=9.1e-05 per=8.5e+00 cost=5.2e+03 flops=5.7e+07
 sigma[gemm] counter=41 i=2 t=9.7e-05 per=9.1e+00 cost=5.9e+03 flops=6.1e+07
 sigma[gemm] counter=41 i=3 t=9.5e-05 per=9.0e+00 cost=5.9e+03 flops=6.2e+07
 sigma[gemm] counter=41 i=4 t=1.2e-04 per=1.1e+01 cost=1.2e+04 flops=9.9e+07
 sigma[gemm] counter=41 i=5 t=1.2e-04 per=1.1e+01 cost=1.2e+04 flops=1.0e+08
 sigma[gemm] counter=41 i=6 t=1.0e-04 per=9.8e+00 cost=5.9e+03 flops=5.7e+07
 sigma[gemm] counter=41 i=7 t=8.7e-05 per=8.2e+00 cost=5.9e+03 flops=6.8e+07
 sigma[gemm] counter=41 total t=8.1e-04 per=7.6e+01 cost=5.8e+04 flops=7.1e+07
 sigma[red] counter=41 t=1.5e-04 per=1.4e+01 cost=1.9e+04 flops=1.3e+08
--- TIMING FOR sigma_tot : t_inter=8.7e-03 t_gemm=7.1e-02 t_reduction=1.1e-02 tot=9.0e-02 ---
 sigma_tot[inter] counter=41 t=8.7e-03 per=9.6e+00 cost=2.2e+06 flops=2.5e+08
 sigma_tot[gemm] counter=41 i=0 t=8.3e-03 per=9.2e+00 cost=8.0e+05 flops=9.6e+07
 sigma_tot[gemm] counter=41 i=1 t=7.7e-03 per=8.6e+00 cost=7.9e+05 flops=1.0e+08
 sigma_tot[gemm] counter=41 i=2 t=7.0e-03 per=7.8e+00 cost=7.2e+05 flops=1.0e+08
 sigma_tot[gemm] counter=41 i=3 t=7.0e-03 per=7.7e+00 cost=7.2e+05 flops=1.0e+08
 sigma_tot[gemm] counter=41 i=4 t=1.1e-02 per=1.3e+01 cost=2.2e+06 flops=2.0e+08
 sigma_tot[gemm] counter=41 i=5 t=1.0e-02 per=1.1e+01 cost=2.2e+06 flops=2.2e+08
 sigma_tot[gemm] counter=41 i=6 t=9.7e-03 per=1.1e+01 cost=1.4e+06 flops=1.5e+08
 sigma_tot[gemm] counter=41 i=7 t=9.7e-03 per=1.1e+01 cost=1.4e+06 flops=1.5e+08
 sigma_tot[gemm] counter=41 total t=7.1e-02 per=7.8e+01 cost=1.0e+07 flops=1.5e+08
 sigma_tot[red] counter=41 t=1.1e-02 per=1.2e+01 cost=2.7e+06 flops=2.5e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.6e-05,3.4e-06,1.3e-06,1.8e-07
    3   0 -      -3.231654755872 -1.361e-04  6.541e-03    3     3  2.256e-02 7.520e-03 1.245e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.138e-05,1.118e-04,8.067e-04,1.462e-04,1.093e-03
 ndim=78:5.811e-07GB t[comm(intra)]=2.138e-05 speed=5.437e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=8.1e-04 t_reduction=1.5e-04 tot=1.1e-03 ---
 sigma[inter] counter=42 t=1.1e-04 per=1.0e+01 cost=1.9e+04 flops=1.7e+08
 sigma[gemm] counter=42 i=0 t=9.5e-05 per=9.0e+00 cost=5.2e+03 flops=5.5e+07
 sigma[gemm] counter=42 i=1 t=9.1e-05 per=8.5e+00 cost=5.2e+03 flops=5.7e+07
 sigma[gemm] counter=42 i=2 t=1.1e-04 per=1.0e+01 cost=5.9e+03 flops=5.4e+07
 sigma[gemm] counter=42 i=3 t=9.6e-05 per=9.0e+00 cost=5.9e+03 flops=6.1e+07
 sigma[gemm] counter=42 i=4 t=1.2e-04 per=1.1e+01 cost=1.2e+04 flops=9.8e+07
 sigma[gemm] counter=42 i=5 t=1.2e-04 per=1.1e+01 cost=1.2e+04 flops=1.0e+08
 sigma[gemm] counter=42 i=6 t=8.8e-05 per=8.3e+00 cost=5.9e+03 flops=6.7e+07
 sigma[gemm] counter=42 i=7 t=8.7e-05 per=8.2e+00 cost=5.9e+03 flops=6.8e+07
 sigma[gemm] counter=42 total t=8.1e-04 per=7.6e+01 cost=5.8e+04 flops=7.2e+07
 sigma[red] counter=42 t=1.5e-04 per=1.4e+01 cost=1.9e+04 flops=1.3e+08
--- TIMING FOR sigma_tot : t_inter=8.8e-03 t_gemm=7.2e-02 t_reduction=1.1e-02 tot=9.1e-02 ---
 sigma_tot[inter] counter=42 t=8.8e-03 per=9.6e+00 cost=2.2e+06 flops=2.5e+08
 sigma_tot[gemm] counter=42 i=0 t=8.4e-03 per=9.1e+00 cost=8.0e+05 flops=9.6e+07
 sigma_tot[gemm] counter=42 i=1 t=7.8e-03 per=8.6e+00 cost=8.0e+05 flops=1.0e+08
 sigma_tot[gemm] counter=42 i=2 t=7.2e-03 per=7.8e+00 cost=7.3e+05 flops=1.0e+08
 sigma_tot[gemm] counter=42 i=3 t=7.1e-03 per=7.7e+00 cost=7.3e+05 flops=1.0e+08
 sigma_tot[gemm] counter=42 i=4 t=1.1e-02 per=1.3e+01 cost=2.2e+06 flops=2.0e+08
 sigma_tot[gemm] counter=42 i=5 t=1.0e-02 per=1.1e+01 cost=2.2e+06 flops=2.1e+08
 sigma_tot[gemm] counter=42 i=6 t=9.7e-03 per=1.1e+01 cost=1.4e+06 flops=1.4e+08
 sigma_tot[gemm] counter=42 i=7 t=9.8e-03 per=1.1e+01 cost=1.4e+06 flops=1.5e+08
 sigma_tot[gemm] counter=42 total t=7.2e-02 per=7.8e+01 cost=1.0e+07 flops=1.4e+08
 sigma_tot[red] counter=42 t=1.1e-02 per=1.2e+01 cost=2.7e+06 flops=2.5e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,3.0e-06,1.1e-06,1.6e-07
    4   0 -      -3.231683562311 -2.881e-05  3.434e-03    3     4  3.307e-02 8.267e-03 1.243e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.232e-05,1.186e-04,9.366e-04,1.630e-04,1.247e-03
 ndim=78:5.811e-07GB t[comm(intra)]=2.232e-05 speed=5.207e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=9.4e-04 t_reduction=1.6e-04 tot=1.2e-03 ---
 sigma[inter] counter=43 t=1.2e-04 per=9.7e+00 cost=1.9e+04 flops=1.6e+08
 sigma[gemm] counter=43 i=0 t=1.1e-04 per=9.2e+00 cost=5.2e+03 flops=4.7e+07
 sigma[gemm] counter=43 i=1 t=1.3e-04 per=1.0e+01 cost=5.2e+03 flops=4.1e+07
 sigma[gemm] counter=43 i=2 t=1.1e-04 per=9.2e+00 cost=5.9e+03 flops=5.3e+07
 sigma[gemm] counter=43 i=3 t=1.1e-04 per=9.2e+00 cost=5.9e+03 flops=5.2e+07
 sigma[gemm] counter=43 i=4 t=1.5e-04 per=1.2e+01 cost=1.2e+04 flops=8.0e+07
 sigma[gemm] counter=43 i=5 t=1.2e-04 per=1.0e+01 cost=1.2e+04 flops=9.7e+07
 sigma[gemm] counter=43 i=6 t=1.0e-04 per=8.3e+00 cost=5.9e+03 flops=5.8e+07
 sigma[gemm] counter=43 i=7 t=1.0e-04 per=8.2e+00 cost=5.9e+03 flops=5.9e+07
 sigma[gemm] counter=43 total t=9.4e-04 per=7.7e+01 cost=5.8e+04 flops=6.2e+07
 sigma[red] counter=43 t=1.6e-04 per=1.3e+01 cost=1.9e+04 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=8.9e-03 t_gemm=7.3e-02 t_reduction=1.1e-02 tot=9.3e-02 ---
 sigma_tot[inter] counter=43 t=8.9e-03 per=9.6e+00 cost=2.2e+06 flops=2.5e+08
 sigma_tot[gemm] counter=43 i=0 t=8.5e-03 per=9.1e+00 cost=8.1e+05 flops=9.5e+07
 sigma_tot[gemm] counter=43 i=1 t=8.0e-03 per=8.6e+00 cost=8.0e+05 flops=1.0e+08
 sigma_tot[gemm] counter=43 i=2 t=7.3e-03 per=7.8e+00 cost=7.4e+05 flops=1.0e+08
 sigma_tot[gemm] counter=43 i=3 t=7.2e-03 per=7.7e+00 cost=7.4e+05 flops=1.0e+08
 sigma_tot[gemm] counter=43 i=4 t=1.2e-02 per=1.3e+01 cost=2.2e+06 flops=1.9e+08
 sigma_tot[gemm] counter=43 i=5 t=1.0e-02 per=1.1e+01 cost=2.2e+06 flops=2.1e+08
 sigma_tot[gemm] counter=43 i=6 t=9.8e-03 per=1.1e+01 cost=1.4e+06 flops=1.4e+08
 sigma_tot[gemm] counter=43 i=7 t=9.9e-03 per=1.1e+01 cost=1.4e+06 flops=1.4e+08
 sigma_tot[gemm] counter=43 total t=7.3e-02 per=7.8e+01 cost=1.0e+07 flops=1.4e+08
 sigma_tot[red] counter=43 t=1.1e-02 per=1.2e+01 cost=2.8e+06 flops=2.5e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.6e-05,3.4e-06,1.3e-06,2.0e-07
    5   0 -      -3.231692915919 -9.354e-06  1.753e-03    3     5  3.933e-02 7.867e-03 1.280e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.203e-05,1.059e-04,8.155e-04,1.432e-04,1.093e-03
 ndim=78:5.811e-07GB t[comm(intra)]=2.203e-05 speed=5.277e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=8.1e-04 t_reduction=1.4e-04 tot=1.1e-03 ---
 sigma[inter] counter=44 t=1.1e-04 per=9.9e+00 cost=1.9e+04 flops=1.8e+08
 sigma[gemm] counter=44 i=0 t=1.2e-04 per=1.1e+01 cost=5.2e+03 flops=4.5e+07
 sigma[gemm] counter=44 i=1 t=9.2e-05 per=8.6e+00 cost=5.2e+03 flops=5.7e+07
 sigma[gemm] counter=44 i=2 t=9.5e-05 per=8.9e+00 cost=5.9e+03 flops=6.2e+07
 sigma[gemm] counter=44 i=3 t=9.5e-05 per=9.0e+00 cost=5.9e+03 flops=6.2e+07
 sigma[gemm] counter=44 i=4 t=1.2e-04 per=1.1e+01 cost=1.2e+04 flops=9.9e+07
 sigma[gemm] counter=44 i=5 t=1.2e-04 per=1.1e+01 cost=1.2e+04 flops=9.9e+07
 sigma[gemm] counter=44 i=6 t=8.8e-05 per=8.3e+00 cost=5.9e+03 flops=6.6e+07
 sigma[gemm] counter=44 i=7 t=8.8e-05 per=8.3e+00 cost=5.9e+03 flops=6.7e+07
 sigma[gemm] counter=44 total t=8.1e-04 per=7.7e+01 cost=5.8e+04 flops=7.1e+07
 sigma[red] counter=44 t=1.4e-04 per=1.3e+01 cost=1.9e+04 flops=1.3e+08
--- TIMING FOR sigma_tot : t_inter=9.0e-03 t_gemm=7.3e-02 t_reduction=1.1e-02 tot=9.4e-02 ---
 sigma_tot[inter] counter=44 t=9.0e-03 per=9.6e+00 cost=2.2e+06 flops=2.5e+08
 sigma_tot[gemm] counter=44 i=0 t=8.6e-03 per=9.2e+00 cost=8.1e+05 flops=9.4e+07
 sigma_tot[gemm] counter=44 i=1 t=8.1e-03 per=8.6e+00 cost=8.1e+05 flops=1.0e+08
 sigma_tot[gemm] counter=44 i=2 t=7.4e-03 per=7.9e+00 cost=7.4e+05 flops=1.0e+08
 sigma_tot[gemm] counter=44 i=3 t=7.3e-03 per=7.8e+00 cost=7.4e+05 flops=1.0e+08
 sigma_tot[gemm] counter=44 i=4 t=1.2e-02 per=1.3e+01 cost=2.3e+06 flops=1.9e+08
 sigma_tot[gemm] counter=44 i=5 t=1.1e-02 per=1.1e+01 cost=2.2e+06 flops=2.1e+08
 sigma_tot[gemm] counter=44 i=6 t=9.9e-03 per=1.1e+01 cost=1.4e+06 flops=1.4e+08
 sigma_tot[gemm] counter=44 i=7 t=9.9e-03 per=1.1e+01 cost=1.4e+06 flops=1.4e+08
 sigma_tot[gemm] counter=44 total t=7.3e-02 per=7.8e+01 cost=1.0e+07 flops=1.4e+08
 sigma_tot[red] counter=44 t=1.1e-02 per=1.2e+01 cost=2.8e+06 flops=2.5e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.5e-05,3.1e-06,1.0e-06,2.0e-07
    6   0 -      -3.231695316754 -2.401e-06  8.270e-04    3     6  5.328e-02 8.880e-03 1.276e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.229e-05,1.268e-04,9.293e-04,1.633e-04,1.248e-03
 ndim=78:5.811e-07GB t[comm(intra)]=2.229e-05 speed=5.215e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=9.3e-04 t_reduction=1.6e-04 tot=1.2e-03 ---
 sigma[inter] counter=45 t=1.3e-04 per=1.0e+01 cost=1.9e+04 flops=1.5e+08
 sigma[gemm] counter=45 i=0 t=1.1e-04 per=9.2e+00 cost=5.2e+03 flops=4.7e+07
 sigma[gemm] counter=45 i=1 t=1.1e-04 per=8.8e+00 cost=5.2e+03 flops=4.9e+07
 sigma[gemm] counter=45 i=2 t=1.1e-04 per=9.2e+00 cost=5.9e+03 flops=5.2e+07
 sigma[gemm] counter=45 i=3 t=1.1e-04 per=9.1e+00 cost=5.9e+03 flops=5.3e+07
 sigma[gemm] counter=45 i=4 t=1.5e-04 per=1.2e+01 cost=1.2e+04 flops=7.9e+07
 sigma[gemm] counter=45 i=5 t=1.2e-04 per=1.0e+01 cost=1.2e+04 flops=9.8e+07
 sigma[gemm] counter=45 i=6 t=1.0e-04 per=8.4e+00 cost=5.9e+03 flops=5.8e+07
 sigma[gemm] counter=45 i=7 t=1.1e-04 per=9.2e+00 cost=5.9e+03 flops=5.2e+07
 sigma[gemm] counter=45 total t=9.3e-04 per=7.6e+01 cost=5.8e+04 flops=6.2e+07
 sigma[red] counter=45 t=1.6e-04 per=1.3e+01 cost=1.9e+04 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=9.2e-03 t_gemm=7.4e-02 t_reduction=1.1e-02 tot=9.5e-02 ---
 sigma_tot[inter] counter=45 t=9.2e-03 per=9.7e+00 cost=2.3e+06 flops=2.5e+08
 sigma_tot[gemm] counter=45 i=0 t=8.7e-03 per=9.2e+00 cost=8.2e+05 flops=9.4e+07
 sigma_tot[gemm] counter=45 i=1 t=8.2e-03 per=8.6e+00 cost=8.1e+05 flops=1.0e+08
 sigma_tot[gemm] counter=45 i=2 t=7.5e-03 per=7.9e+00 cost=7.5e+05 flops=1.0e+08
 sigma_tot[gemm] counter=45 i=3 t=7.4e-03 per=7.8e+00 cost=7.5e+05 flops=1.0e+08
 sigma_tot[gemm] counter=45 i=4 t=1.2e-02 per=1.2e+01 cost=2.3e+06 flops=1.9e+08
 sigma_tot[gemm] counter=45 i=5 t=1.1e-02 per=1.1e+01 cost=2.3e+06 flops=2.1e+08
 sigma_tot[gemm] counter=45 i=6 t=1.0e-02 per=1.1e+01 cost=1.4e+06 flops=1.4e+08
 sigma_tot[gemm] counter=45 i=7 t=1.0e-02 per=1.1e+01 cost=1.4e+06 flops=1.4e+08
 sigma_tot[gemm] counter=45 total t=7.4e-02 per=7.8e+01 cost=1.1e+07 flops=1.4e+08
 sigma_tot[red] counter=45 t=1.1e-02 per=1.2e+01 cost=2.8e+06 flops=2.5e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.6e-05,3.3e-06,1.3e-06,2.4e-07
    7   0 -      -3.231695980831 -6.641e-07  5.181e-04    3     7  5.952e-02 8.503e-03 1.295e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.249e-05,1.179e-04,9.357e-04,1.656e-04,1.248e-03
 ndim=78:5.811e-07GB t[comm(intra)]=2.249e-05 speed=5.169e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=9.3e-04 t_reduction=1.7e-04 tot=1.2e-03 ---
 sigma[inter] counter=46 t=1.2e-04 per=9.7e+00 cost=1.9e+04 flops=1.6e+08
 sigma[gemm] counter=46 i=0 t=1.1e-04 per=9.1e+00 cost=5.2e+03 flops=4.7e+07
 sigma[gemm] counter=46 i=1 t=1.1e-04 per=8.8e+00 cost=5.2e+03 flops=4.9e+07
 sigma[gemm] counter=46 i=2 t=1.2e-04 per=9.5e+00 cost=5.9e+03 flops=5.1e+07
 sigma[gemm] counter=46 i=3 t=1.3e-04 per=1.1e+01 cost=5.9e+03 flops=4.6e+07
 sigma[gemm] counter=46 i=4 t=1.5e-04 per=1.2e+01 cost=1.2e+04 flops=8.1e+07
 sigma[gemm] counter=46 i=5 t=1.2e-04 per=9.9e+00 cost=1.2e+04 flops=9.8e+07
 sigma[gemm] counter=46 i=6 t=1.0e-04 per=8.3e+00 cost=5.9e+03 flops=5.8e+07
 sigma[gemm] counter=46 i=7 t=1.0e-04 per=8.3e+00 cost=5.9e+03 flops=5.8e+07
 sigma[gemm] counter=46 total t=9.3e-04 per=7.7e+01 cost=5.8e+04 flops=6.2e+07
 sigma[red] counter=46 t=1.7e-04 per=1.4e+01 cost=1.9e+04 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=9.3e-03 t_gemm=7.5e-02 t_reduction=1.2e-02 tot=9.6e-02 ---
 sigma_tot[inter] counter=46 t=9.3e-03 per=9.7e+00 cost=2.3e+06 flops=2.5e+08
 sigma_tot[gemm] counter=46 i=0 t=8.8e-03 per=9.2e+00 cost=8.2e+05 flops=9.3e+07
 sigma_tot[gemm] counter=46 i=1 t=8.3e-03 per=8.6e+00 cost=8.2e+05 flops=9.9e+07
 sigma_tot[gemm] counter=46 i=2 t=7.6e-03 per=7.9e+00 cost=7.5e+05 flops=9.9e+07
 sigma_tot[gemm] counter=46 i=3 t=7.5e-03 per=7.8e+00 cost=7.5e+05 flops=1.0e+08
 sigma_tot[gemm] counter=46 i=4 t=1.2e-02 per=1.2e+01 cost=2.3e+06 flops=1.9e+08
 sigma_tot[gemm] counter=46 i=5 t=1.1e-02 per=1.1e+01 cost=2.3e+06 flops=2.1e+08
 sigma_tot[gemm] counter=46 i=6 t=1.0e-02 per=1.1e+01 cost=1.4e+06 flops=1.4e+08
 sigma_tot[gemm] counter=46 i=7 t=1.0e-02 per=1.1e+01 cost=1.4e+06 flops=1.4e+08
 sigma_tot[gemm] counter=46 total t=7.5e-02 per=7.8e+01 cost=1.1e+07 flops=1.4e+08
 sigma_tot[red] counter=46 t=1.2e-02 per=1.2e+01 cost=2.8e+06 flops=2.4e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.6e-05,3.3e-06,1.3e-06,2.2e-07
    8   0 -      -3.231696266349 -2.855e-07  3.139e-04    3     8  6.905e-02 8.632e-03 1.311e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.171e-05,1.180e-04,9.309e-04,1.634e-04,1.241e-03
 ndim=78:5.811e-07GB t[comm(intra)]=2.171e-05 speed=5.355e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=9.3e-04 t_reduction=1.6e-04 tot=1.2e-03 ---
 sigma[inter] counter=47 t=1.2e-04 per=9.7e+00 cost=1.9e+04 flops=1.6e+08
 sigma[gemm] counter=47 i=0 t=1.1e-04 per=9.1e+00 cost=5.2e+03 flops=4.7e+07
 sigma[gemm] counter=47 i=1 t=1.1e-04 per=8.9e+00 cost=5.2e+03 flops=4.8e+07
 sigma[gemm] counter=47 i=2 t=1.1e-04 per=9.2e+00 cost=5.9e+03 flops=5.3e+07
 sigma[gemm] counter=47 i=3 t=1.1e-04 per=9.3e+00 cost=5.9e+03 flops=5.2e+07
 sigma[gemm] counter=47 i=4 t=1.5e-04 per=1.2e+01 cost=1.2e+04 flops=7.9e+07
 sigma[gemm] counter=47 i=5 t=1.2e-04 per=9.9e+00 cost=1.2e+04 flops=1.0e+08
 sigma[gemm] counter=47 i=6 t=1.0e-04 per=8.4e+00 cost=5.9e+03 flops=5.8e+07
 sigma[gemm] counter=47 i=7 t=1.2e-04 per=9.6e+00 cost=5.9e+03 flops=5.1e+07
 sigma[gemm] counter=47 total t=9.3e-04 per=7.7e+01 cost=5.8e+04 flops=6.2e+07
 sigma[red] counter=47 t=1.6e-04 per=1.3e+01 cost=1.9e+04 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=9.4e-03 t_gemm=7.6e-02 t_reduction=1.2e-02 tot=9.7e-02 ---
 sigma_tot[inter] counter=47 t=9.4e-03 per=9.7e+00 cost=2.3e+06 flops=2.5e+08
 sigma_tot[gemm] counter=47 i=0 t=8.9e-03 per=9.2e+00 cost=8.3e+05 flops=9.3e+07
 sigma_tot[gemm] counter=47 i=1 t=8.4e-03 per=8.6e+00 cost=8.2e+05 flops=9.8e+07
 sigma_tot[gemm] counter=47 i=2 t=7.7e-03 per=7.9e+00 cost=7.6e+05 flops=9.9e+07
 sigma_tot[gemm] counter=47 i=3 t=7.6e-03 per=7.8e+00 cost=7.6e+05 flops=1.0e+08
 sigma_tot[gemm] counter=47 i=4 t=1.2e-02 per=1.2e+01 cost=2.3e+06 flops=1.9e+08
 sigma_tot[gemm] counter=47 i=5 t=1.1e-02 per=1.1e+01 cost=2.3e+06 flops=2.1e+08
 sigma_tot[gemm] counter=47 i=6 t=1.0e-02 per=1.1e+01 cost=1.4e+06 flops=1.4e+08
 sigma_tot[gemm] counter=47 i=7 t=1.0e-02 per=1.1e+01 cost=1.5e+06 flops=1.4e+08
 sigma_tot[gemm] counter=47 total t=7.6e-02 per=7.8e+01 cost=1.1e+07 flops=1.4e+08
 sigma_tot[red] counter=47 t=1.2e-02 per=1.2e+01 cost=2.8e+06 flops=2.4e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.6e-05,3.4e-06,1.4e-06,2.2e-07
    9   0 -      -3.231696355389 -8.904e-08  1.718e-04    3     9  7.858e-02 8.731e-03 1.322e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.223e-05,1.193e-04,9.364e-04,1.668e-04,1.252e-03
 ndim=78:5.811e-07GB t[comm(intra)]=2.223e-05 speed=5.230e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=9.3e-04 t_reduction=1.7e-04 tot=1.2e-03 ---
 sigma[inter] counter=48 t=1.2e-04 per=9.8e+00 cost=1.9e+04 flops=1.6e+08
 sigma[gemm] counter=48 i=0 t=1.1e-04 per=9.1e+00 cost=5.2e+03 flops=4.7e+07
 sigma[gemm] counter=48 i=1 t=1.1e-04 per=9.0e+00 cost=5.2e+03 flops=4.7e+07
 sigma[gemm] counter=48 i=2 t=1.2e-04 per=1.0e+01 cost=5.9e+03 flops=4.8e+07
 sigma[gemm] counter=48 i=3 t=1.1e-04 per=9.3e+00 cost=5.9e+03 flops=5.2e+07
 sigma[gemm] counter=48 i=4 t=1.5e-04 per=1.2e+01 cost=1.2e+04 flops=7.9e+07
 sigma[gemm] counter=48 i=5 t=1.2e-04 per=1.0e+01 cost=1.2e+04 flops=9.8e+07
 sigma[gemm] counter=48 i=6 t=1.0e-04 per=8.4e+00 cost=5.9e+03 flops=5.8e+07
 sigma[gemm] counter=48 i=7 t=1.0e-04 per=8.4e+00 cost=5.9e+03 flops=5.8e+07
 sigma[gemm] counter=48 total t=9.3e-04 per=7.7e+01 cost=5.8e+04 flops=6.2e+07
 sigma[red] counter=48 t=1.7e-04 per=1.4e+01 cost=1.9e+04 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=9.5e-03 t_gemm=7.7e-02 t_reduction=1.2e-02 tot=9.9e-02 ---
 sigma_tot[inter] counter=48 t=9.5e-03 per=9.7e+00 cost=2.3e+06 flops=2.4e+08
 sigma_tot[gemm] counter=48 i=0 t=9.0e-03 per=9.2e+00 cost=8.3e+05 flops=9.2e+07
 sigma_tot[gemm] counter=48 i=1 t=8.5e-03 per=8.6e+00 cost=8.3e+05 flops=9.8e+07
 sigma_tot[gemm] counter=48 i=2 t=7.8e-03 per=7.9e+00 cost=7.7e+05 flops=9.8e+07
 sigma_tot[gemm] counter=48 i=3 t=7.7e-03 per=7.8e+00 cost=7.7e+05 flops=9.9e+07
 sigma_tot[gemm] counter=48 i=4 t=1.2e-02 per=1.2e+01 cost=2.3e+06 flops=1.9e+08
 sigma_tot[gemm] counter=48 i=5 t=1.1e-02 per=1.1e+01 cost=2.3e+06 flops=2.1e+08
 sigma_tot[gemm] counter=48 i=6 t=1.0e-02 per=1.0e+01 cost=1.4e+06 flops=1.4e+08
 sigma_tot[gemm] counter=48 i=7 t=1.0e-02 per=1.1e+01 cost=1.5e+06 flops=1.4e+08
 sigma_tot[gemm] counter=48 total t=7.7e-02 per=7.8e+01 cost=1.1e+07 flops=1.4e+08
 sigma_tot[red] counter=48 t=1.2e-02 per=1.2e+01 cost=2.9e+06 flops=2.4e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.6e-05,3.5e-06,1.3e-06,2.3e-07
   10   0 +      -3.231696372843 -1.745e-08  8.600e-05    3    10  8.815e-02 8.815e-03 1.332e-03
TIMING FOR Davidson : 8.816e-02  T(cal/comm/rest)=1.332e-02,1.136e-06,7.483e-02
decomposed t_rest=7.483e-02
 T(sub)    =2.286e-04 per=3.055e-01
 T(precond)=7.425e-02 per=9.923e+01
 T(ortho)  =3.122e-05 per=4.172e-02
 T(xcopy)  =1.636e-06 per=2.186e-03
 T(xnrm2)  =5.176e-06 per=6.917e-03
 T(other)  =3.125e-04 per=4.176e-01
optimized energies: isweep=0 ibond=5 dots=2 e[0]=-3.231696372843 nmvp=10
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.579e+02S Sys:1.338e+00S Total:1.593e+02S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=10 nqr=13 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond5.txt
 qbond: qsuper nsym=13 dimAll=40
 (3,1):5 (3,-1):4 (2,0):1 (4,0):8 (2,2):1 (4,2):5 (5,1):5 (5,-1):4 (6,0):1 (6,2):1 (3,3):1 (5,3):1 (4,-2):3
timing for divide=1.6e-05
timing for compute=1.3e-04
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(nkr): 1.7e-04 S T(divide/compute/collect)=1.6e-05,1.3e-04,1.5e-05 -----
decimation summary: 40->10 dwt=+7.883e-04 SvN=7.903e-01
 qbond: qkept nsym=8 dimAll=10
 (4,0):3 (3,1):1 (3,-1):1 (2,0):1 (4,2):1 (5,1):1 (5,-1):1 (4,-2):1
----- TIMING for decimation_row(nkr): 5.865e-04 S T(decim/select/formRot)=2.484e-04,3.055e-04,3.260e-05 -----
----- TIMING FOR twodot_decimation: 8.466e-04 S T(wf/decim)=2.250e-04,6.217e-04 -----
ctns::oper_renorm coord=(2,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:8 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.581e+02S Sys:1.339e+00S Total:1.595e+02S
----- TIMING FOR symbolic_formulae_renorm with size=29 : 1.181e-03 S -----
rank=0 GPUmem(GB): used=1.19e-05 (oper)=7.46e-06
rank=0 GPUmem(GB): used=1.22e-05 (oper,site)(GB)=7.46e-06,3.8e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=29
 no. of rintermediate operators=58
 no. of coefficients=174:0.00133MB:1.3e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.009e-04 S -----
rank=0 GPUmem(GB): used=1.35e-05 (oper,site,rinter)=7.46e-06,3.8e-07,1.3e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00161 S size(rtasks)=29 size(Rlst2)=64 T(Rmu/Rlist)=0.000352,0.00126 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00173 S size(rtasks)=29 size(Rlst)=1091 -----
rank=0 GPUmem(GB): used=1.35e-05 (oper,site,rinter,batch)=7.46e-06,3.8e-07,1.3e-06,0.000179 blksize=9 blksize0=3 batchsize=1091
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.33e-05,0.000491,0.00018
--- TIMING FOR renorm : t_inter=8.3e-05 t_gemm=4.9e-04 t_reduction=1.8e-04 tot=7.5e-04 ---
 renorm[inter] counter=6 t=8.3e-05 per=1.1e+01 cost=5.7e+03 flops=6.9e+07
 renorm[gemm] counter=6 i=0 t=7.1e-05 per=9.4e+00 cost=1.9e+03 flops=2.7e+07
 renorm[gemm] counter=6 i=1 t=7.7e-05 per=1.0e+01 cost=2.9e+03 flops=3.8e+07
 renorm[gemm] counter=6 i=2 t=1.0e-04 per=1.3e+01 cost=3.3e+03 flops=3.3e+07
 renorm[gemm] counter=6 i=3 t=1.1e-04 per=1.5e+01 cost=6.0e+03 flops=5.3e+07
 renorm[gemm] counter=6 i=4 t=1.1e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=5 t=1.1e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=6 t=1.3e-04 per=1.7e+01 cost=1.1e+04 flops=9.0e+07
 renorm[gemm] counter=6 total t=4.9e-04 per=6.5e+01 cost=2.5e+04 flops=5.2e+07
 renorm[red] counter=6 t=1.8e-04 per=2.4e+01 cost=5.7e+03 flops=3.2e+07
--- TIMING FOR renorm_tot : t_inter=3.9e-04 t_gemm=3.1e-03 t_reduction=1.0e-03 tot=4.5e-03 ---
 renorm_tot[inter] counter=6 t=3.9e-04 per=8.7e+00 cost=1.9e+04 flops=4.9e+07
 renorm_tot[gemm] counter=6 i=0 t=4.9e-04 per=1.1e+01 cost=1.2e+04 flops=2.5e+07
 renorm_tot[gemm] counter=6 i=1 t=4.5e-04 per=1.0e+01 cost=1.6e+04 flops=3.6e+07
 renorm_tot[gemm] counter=6 i=2 t=2.8e-04 per=6.2e+00 cost=9.6e+03 flops=3.5e+07
 renorm_tot[gemm] counter=6 i=3 t=3.0e-04 per=6.7e+00 cost=1.5e+04 flops=5.1e+07
 renorm_tot[gemm] counter=6 i=4 t=3.9e-04 per=8.7e+00 cost=1.1e+04 flops=2.9e+07
 renorm_tot[gemm] counter=6 i=5 t=3.8e-04 per=8.4e+00 cost=1.5e+04 flops=3.9e+07
 renorm_tot[gemm] counter=6 i=6 t=7.9e-04 per=1.8e+01 cost=7.3e+04 flops=9.2e+07
 renorm_tot[gemm] counter=6 total t=3.1e-03 per=6.9e+01 cost=1.5e+05 flops=5.0e+07
 renorm_tot[red] counter=6 t=1.0e-03 per=2.3e+01 cost=4.6e+04 flops=4.5e+07
qops.to_cpu: size(tot)=276:2.1e-03MB:2.1e-06GB t[to_cpu]=1.4e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=7.946e-16 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0122 S rank=0 -----
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.584e+02S Sys:1.340e+00S Total:1.597e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=156:1.190e-03MB:1.162e-06GB
 rwfuns: len=2 mem=4:3.052e-05MB:2.980e-08GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=225:1.717e-03MB:1.676e-06GB
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.584e+02S Sys:1.340e+00S Total:1.597e+02S
##### local opt: 1.473e-01 S #####
 T(local opt: fetch) = 6.025e-04 S  per = 0.409  per(accum) = 0.409
 T(local opt: hdiag) = 9.269e-04 S  per = 0.629  per(accum) = 1.04
 T(local opt: dvdsn) = 1.319e-01 S  per = 89.6  per(accum) = 90.6
 T(local opt: decim) = 8.568e-04 S  per = 0.582  per(accum) = 91.2
 T(local opt: guess) = 2.474e-04 S  per = 0.168  per(accum) = 91.4
 T(local opt: renrm) = 1.252e-02 S  per =  8.5  per(accum) = 99.9
 T(local opt: save ) = 2.096e-04 S  per = 0.142  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.319e-01 S  T(sum) = 1.317e-01 S  per = 9.981e+01
 T(local opt: preprocess                  ) = 4.892e-04 S  per = 0.372  per(accum) = 0.372
 T(local opt: symbolic_formulae           ) = 1.961e-03 S  per = 1.49  per(accum) = 1.86
 T(local opt: hintermediate init          ) = 8.945e-05 S  per = 0.0679  per(accum) = 1.93
 T(local opt: preprocess_hformulae_Hxlist ) = 7.111e-03 S  per =  5.4  per(accum) = 7.33
 T(local opt: hmmtasks init               ) = 3.366e-02 S  per = 25.6  per(accum) = 32.9
 T(local opt: initial guess for dvdson    ) = 2.085e-04 S  per = 0.158  per(accum) = 33
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.310e-02 S  per = 9.95  per(accum) = 43
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.204e-04 S  per = 0.167  per(accum) = 43.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.136e-06 S  per = 0.000863  per(accum) = 43.2
 T(local opt: dvdson solver [rest part]   ) = 7.483e-02 S  per = 56.8  per(accum) = 100
Detailed decomposition of T(renrm) = 1.252e-02 S  T(sum) = 1.252e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.017e-04 S  per = 0.812  per(accum) = 0.812
 T(local opt: qops init                    ) = 6.884e-04 S  per =  5.5  per(accum) = 6.31
 T(local opt: symbolic_formulae_renorm     ) = 1.191e-03 S  per = 9.51  per(accum) = 15.8
 T(local opt: allocate qops on gpu         ) = 2.440e-05 S  per = 0.195  per(accum) = 16
 T(local opt: site memcpy cpu2gpu          ) = 1.912e-05 S  per = 0.153  per(accum) = 16.2
 T(local opt: rintermediate init           ) = 1.117e-04 S  per = 0.892  per(accum) = 17.1
 T(local opt: preprocess_formulae_Rlist2   ) = 1.770e-03 S  per = 14.1  per(accum) = 31.2
 T(local opt: rmmtasks init                ) = 7.492e-03 S  per = 59.8  per(accum) = 91
 T(local opt: qops memset on cpu           ) = 3.600e-08 S  per = 0.000287  per(accum) = 91
 T(local opt: preprocess_renorm_batchGPU   ) = 8.562e-04 S  per = 6.84  per(accum) = 97.9
 T(local opt: reduction of opS & opH [nccl]) = 1.069e-06 S  per = 0.00854  per(accum) = 97.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.972e-05 S  per = 0.157  per(accum) = 98
 T(local opt: deallocate cpu and gpu memory) = 1.086e-05 S  per = 0.0868  per(accum) = 98.1
 T(local opt: reduction of opS & opH [comm]) = 2.625e-05 S  per = 0.21  per(accum) = 98.3
 T(local opt: conversion from opAB to opPQ ) = 3.862e-06 S  per = 0.0308  per(accum) = 98.4
 T(local opt: after oper_renorm            ) = 2.060e-04 S  per = 1.65  per(accum) = 100
##### sweep opt: 1.564e+00 S #####
 T(sweep opt: fetch) = 4.904e-03 S  per = 0.314  per(accum) = 0.314
 T(sweep opt: hdiag) = 5.858e-03 S  per = 0.375  per(accum) = 0.688
 T(sweep opt: dvdsn) = 1.009e+00 S  per = 64.5  per(accum) = 65.2
 T(sweep opt: decim) = 5.185e-03 S  per = 0.332  per(accum) = 65.5
 T(sweep opt: guess) = 1.840e-03 S  per = 0.118  per(accum) = 65.6
 T(sweep opt: renrm) = 5.351e-01 S  per = 34.2  per(accum) = 99.9
 T(sweep opt: save ) = 2.235e-03 S  per = 0.143  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.009e+00 S  T(sum) = 1.007e+00 S  per = 9.983e+01
 T(sweep opt: preprocess                  ) = 4.836e-03 S  per = 0.48  per(accum) = 0.48
 T(sweep opt: symbolic_formulae           ) = 1.504e-02 S  per = 1.49  per(accum) = 1.97
 T(sweep opt: hintermediate init          ) = 6.586e-04 S  per = 0.0654  per(accum) = 2.04
 T(sweep opt: preprocess_hformulae_Hxlist ) = 8.896e-02 S  per = 8.84  per(accum) = 10.9
 T(sweep opt: hmmtasks init               ) = 4.725e-01 S  per = 46.9  per(accum) = 57.8
 T(sweep opt: initial guess for dvdson    ) = 1.463e-03 S  per = 0.145  per(accum) = 58
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.066e-01 S  per = 10.6  per(accum) = 68.5
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 1.116e-03 S  per = 0.111  per(accum) = 68.7
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 5.645e-06 S  per = 0.000561  per(accum) = 68.7
 T(sweep opt: dvdson solver [rest part]   ) = 3.155e-01 S  per = 31.3  per(accum) = 100
Detailed decomposition of T(renrm) = 5.351e-01 S  T(sum) = 5.351e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.038e-04 S  per = 0.113  per(accum) = 0.113
 T(sweep opt: qops init                    ) = 3.166e-03 S  per = 0.592  per(accum) = 0.705
 T(sweep opt: symbolic_formulae_renorm     ) = 6.289e-03 S  per = 1.18  per(accum) = 1.88
 T(sweep opt: allocate qops on gpu         ) = 1.391e-04 S  per = 0.026  per(accum) = 1.91
 T(sweep opt: site memcpy cpu2gpu          ) = 1.326e-04 S  per = 0.0248  per(accum) = 1.93
 T(sweep opt: rintermediate init           ) = 5.041e-04 S  per = 0.0942  per(accum) = 2.02
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.050e-02 S  per = 1.96  per(accum) = 3.99
 T(sweep opt: rmmtasks init                ) = 4.202e-02 S  per = 7.85  per(accum) = 11.8
 T(sweep opt: qops memset on cpu           ) = 2.730e-07 S  per = 5.1e-05  per(accum) = 11.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.102e-03 S  per = 0.953  per(accum) = 12.8
 T(sweep opt: reduction of opS & opH [nccl]) = 6.542e-06 S  per = 0.00122  per(accum) = 12.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.200e-04 S  per = 0.0224  per(accum) = 12.8
 T(sweep opt: deallocate cpu and gpu memory) = 6.618e-05 S  per = 0.0124  per(accum) = 12.8
 T(sweep opt: reduction of opS & opH [comm]) = 1.493e-04 S  per = 0.0279  per(accum) = 12.9
 T(sweep opt: conversion from opAB to opPQ ) = 4.647e-01 S  per = 86.8  per(accum) = 99.7
 T(sweep opt: after oper_renorm            ) = 1.591e-03 S  per = 0.297  per(accum) = 100
##### global opt: 1.564e+00 S #####
 T(global opt: fetch) = 4.904e-03 S  per = 0.314  per(accum) = 0.314
 T(global opt: hdiag) = 5.858e-03 S  per = 0.375  per(accum) = 0.688
 T(global opt: dvdsn) = 1.009e+00 S  per = 64.5  per(accum) = 65.2
 T(global opt: decim) = 5.185e-03 S  per = 0.332  per(accum) = 65.5
 T(global opt: guess) = 1.840e-03 S  per = 0.118  per(accum) = 65.6
 T(global opt: renrm) = 5.351e-01 S  per = 34.2  per(accum) = 99.9
 T(global opt: save ) = 2.235e-03 S  per = 0.143  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.009e+00 S  T(sum) = 1.007e+00 S  per = 9.983e+01
 T(global opt: preprocess                  ) = 4.836e-03 S  per = 0.48  per(accum) = 0.48
 T(global opt: symbolic_formulae           ) = 1.504e-02 S  per = 1.49  per(accum) = 1.97
 T(global opt: hintermediate init          ) = 6.586e-04 S  per = 0.0654  per(accum) = 2.04
 T(global opt: preprocess_hformulae_Hxlist ) = 8.896e-02 S  per = 8.84  per(accum) = 10.9
 T(global opt: hmmtasks init               ) = 4.725e-01 S  per = 46.9  per(accum) = 57.8
 T(global opt: initial guess for dvdson    ) = 1.463e-03 S  per = 0.145  per(accum) = 58
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.066e-01 S  per = 10.6  per(accum) = 68.5
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.116e-03 S  per = 0.111  per(accum) = 68.7
 T(global opt: dvdson solver [comm(cpu)]   ) = 5.645e-06 S  per = 0.000561  per(accum) = 68.7
 T(global opt: dvdson solver [rest part]   ) = 3.155e-01 S  per = 31.3  per(accum) = 100
Detailed decomposition of T(renrm) = 5.351e-01 S  T(sum) = 5.351e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.038e-04 S  per = 0.113  per(accum) = 0.113
 T(global opt: qops init                    ) = 3.166e-03 S  per = 0.592  per(accum) = 0.705
 T(global opt: symbolic_formulae_renorm     ) = 6.289e-03 S  per = 1.18  per(accum) = 1.88
 T(global opt: allocate qops on gpu         ) = 1.391e-04 S  per = 0.026  per(accum) = 1.91
 T(global opt: site memcpy cpu2gpu          ) = 1.326e-04 S  per = 0.0248  per(accum) = 1.93
 T(global opt: rintermediate init           ) = 5.041e-04 S  per = 0.0942  per(accum) = 2.02
 T(global opt: preprocess_formulae_Rlist2   ) = 1.050e-02 S  per = 1.96  per(accum) = 3.99
 T(global opt: rmmtasks init                ) = 4.202e-02 S  per = 7.85  per(accum) = 11.8
 T(global opt: qops memset on cpu           ) = 2.730e-07 S  per = 5.1e-05  per(accum) = 11.8
 T(global opt: preprocess_renorm_batchGPU   ) = 5.102e-03 S  per = 0.953  per(accum) = 12.8
 T(global opt: reduction of opS & opH [nccl]) = 6.542e-06 S  per = 0.00122  per(accum) = 12.8
 T(global opt: qops memcpy gpu2cpu          ) = 1.200e-04 S  per = 0.0224  per(accum) = 12.8
 T(global opt: deallocate cpu and gpu memory) = 6.618e-05 S  per = 0.0124  per(accum) = 12.8
 T(global opt: reduction of opS & opH [comm]) = 1.493e-04 S  per = 0.0279  per(accum) = 12.9
 T(global opt: conversion from opAB to opPQ ) = 4.647e-01 S  per = 86.8  per(accum) = 99.7
 T(global opt: after oper_renorm            ) = 1.591e-03 S  per = 0.297  per(accum) = 100

======================================================================
sweep_data::summary isweep=0 mpisize=1 maxthreads=112
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=10 dwt=+1.029e-03 nmvp=1 e[0]=-3.236066267492 t=0.235
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=10 dwt=+2.110e-03 nmvp=8 e[0]=-3.234306696169 t=0.300
 ibond=2 bond=(3,0)-(4,0) forward=1 deff=10 dwt=+7.947e-04 nmvp=10 e[0]=-3.231652941021 t=0.137
 ibond=3 bond=(3,0)-(4,0) forward=0 deff=10 dwt=+7.947e-04 nmvp=7 e[0]=-3.231652935087 t=0.105
 ibond=4 bond=(2,0)-(3,0) forward=0 deff=10 dwt=+1.938e-03 nmvp=12 e[0]=-3.232648284263 t=0.640
 ibond=5 bond=(1,0)-(2,0) forward=0 deff=10 dwt=+7.883e-04 nmvp=10 e[0]=-3.231696372843 t=0.147
 eav_max=-3.231652935087 [ibond=3]  dwt_min=7.883e-04 [ibond=5]
 eav_min=-3.236066267492 [ibond=0]  dwt_max=2.110e-03 [ibond=1]
 eav_diff=0.004413332406
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+1.029e-03 e[0]=-3.236066267492
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0 mpisize=1 maxthreads=112
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.000e-04 0.000e+00 | 48 | 1.571e+00 | 1.571e+00 | 9.909e-03 8.027e-02 1.289e-02 1.031e-01 6.56
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +1.029e-03 e[0]=-3.236066267492 (0.000e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep0
----------------------------------------------------------------------

ctns::sweep_final_LCR2CRR: convert [LC]R => [CR]R
ctns::decimation_row ifab=1 iftrunc=1 dcut=4 nqr=15 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_C0R1.txt
 qbond: qsuper nsym=15 dimAll=40
 (4,0):6 (3,1):2 (3,-1):2 (2,0):1 (4,2):2 (5,1):6 (5,-1):6 (4,-2):2 (6,0):5 (6,2):2 (7,1):1 (7,-1):1 (6,-2):2 (5,3):1 (5,-3):1
timing for divide=8.000e-06
timing for compute=4.789e-03
timing for collect=1.546e-05
----- TMING FOR decimation_genbasis(nkr): 4.812e-03 S T(divide/compute/collect)=8.000e-06,4.789e-03,1.546e-05 -----
decimation summary: 40->4 dwt=+0.000e+00 SvN=1.323e+00
 qbond: qkept nsym=4 dimAll=4
 (4,0):1 (5,1):1 (5,-1):1 (6,0):1
----- TIMING for decimation_row(nkr): 5.182e-03 S T(decim/select/formRot)=4.879e-03,2.782e-04,2.493e-05 -----

ctns::sweep_final_CR2cRR: convert [C]R => [cR]R
ctns::decimation_row ifab=1 iftrunc=1 dcut=1 nqr=9 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_cR0.txt
 qbond: qsuper nsym=9 dimAll=16
 (4,0):1 (5,1):2 (5,-1):2 (6,0):4 (7,1):2 (7,-1):2 (8,0):1 (6,2):1 (6,-2):1
timing for divide=5.692e-06
timing for compute=4.489e-03
timing for collect=9.722e-06
----- TMING FOR decimation_genbasis(nkr): 4.504e-03 S T(divide/compute/collect)=5.692e-06,4.489e-03,9.722e-06 -----
decimation summary: 16->1 dwt=+0.000e+00 SvN=0.000e+00
 qbond: qkept nsym=1 dimAll=1
 (6,0):1
----- TIMING for decimation_row(nkr): 4.761e-03 S T(decim/select/formRot)=4.559e-03,1.871e-04,1.492e-05 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep0

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(5,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(4,0) Drow=10 maxdiff=4.919e-16 deviate=0
 idx=2 node=(3,0) Drow=10 maxdiff=1.634e-15 deviate=0
 idx=3 node=(2,0) Drow=10 maxdiff=1.050e-15 deviate=0
 idx=4 node=(1,0) Drow=4 maxdiff=2.220e-16 deviate=0
 idx=5 node=(0,0) Drow=1 maxdiff=4.441e-16 deviate=0
qtensor2: wf2 own=1 _data=0x4f3a2c40
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (6,0):1
 qbond: qcol nsym=1 dimAll=1
 (6,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(6,0),0:(6,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x4f3a2c40
      1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=4.4409e-16 deviate=0
----- TIMING FOR ctns::rcanon_check : 2.482e-04 S -----

ctns::oper_final - build Hmat for RCF at isweep=0

coord=(1,0)
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=208:0.00159MB:1.55e-06GB
 rqops: oplist=CSHPQ nops=C:8 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=10,10 size(op)=16:0.000122MB size(tot)=276:0.00211MB:2.06e-06GB
ctns::oper_renorm coord=(1,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:10 S:2 H:1 P:1 Q:3 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=38:0.00029MB:2.83e-07GB
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.596e+02S Sys:1.342e+00S Total:1.610e+02S
----- TIMING FOR symbolic_formulae_renorm with size=17 : 6.155e-04 S -----
rank=0 GPUmem(GB): used=5.44e-06 (oper)=3.89e-06
rank=0 GPUmem(GB): used=5.61e-06 (oper,site)(GB)=3.89e-06,1.71e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=17
 no. of rintermediate operators=20
 no. of coefficients=80:0.00061MB:5.96e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.916e-05 S -----
rank=0 GPUmem(GB): used=6.21e-06 (oper,site,rinter)=3.89e-06,1.71e-07,5.96e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00091 S size(rtasks)=17 size(Rlst2)=16 T(Rmu/Rlist)=0.000164,0.000746 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000977 S size(rtasks)=17 size(Rlst)=557 -----
rank=0 GPUmem(GB): used=6.21e-06 (oper,site,rinter,batch)=3.89e-06,1.71e-07,5.96e-07,4.15e-05 blksize=3 blksize0=3 batchsize=557
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.34e-05,0.000338,0.000143
--- TIMING FOR renorm : t_inter=8.3e-05 t_gemm=3.4e-04 t_reduction=1.4e-04 tot=5.6e-04 ---
 renorm[inter] counter=7 t=8.3e-05 per=1.5e+01 cost=1.8e+03 flops=2.2e+07
 renorm[gemm] counter=7 i=0 t=6.6e-05 per=1.2e+01 cost=5.7e+02 flops=8.6e+06
 renorm[gemm] counter=7 i=1 t=6.0e-05 per=1.1e+01 cost=7.7e+02 flops=1.3e+07
 renorm[gemm] counter=7 i=2 t=7.2e-05 per=1.3e+01 cost=9.1e+02 flops=1.3e+07
 renorm[gemm] counter=7 i=3 t=7.2e-05 per=1.3e+01 cost=1.4e+03 flops=2.0e+07
 renorm[gemm] counter=7 i=4 t=1.1e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=5 t=1.0e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=6 t=6.6e-05 per=1.2e+01 cost=1.8e+03 flops=2.7e+07
 renorm[gemm] counter=7 total t=3.4e-04 per=6.0e+01 cost=5.4e+03 flops=1.6e+07
 renorm[red] counter=7 t=1.4e-04 per=2.5e+01 cost=1.1e+03 flops=7.8e+06
--- TIMING FOR renorm_tot : t_inter=4.7e-04 t_gemm=3.4e-03 t_reduction=1.2e-03 tot=5.0e-03 ---
 renorm_tot[inter] counter=7 t=4.7e-04 per=9.3e+00 cost=2.1e+04 flops=4.4e+07
 renorm_tot[gemm] counter=7 i=0 t=5.6e-04 per=1.1e+01 cost=1.3e+04 flops=2.3e+07
 renorm_tot[gemm] counter=7 i=1 t=5.1e-04 per=1.0e+01 cost=1.7e+04 flops=3.4e+07
 renorm_tot[gemm] counter=7 i=2 t=3.5e-04 per=6.9e+00 cost=1.0e+04 flops=3.0e+07
 renorm_tot[gemm] counter=7 i=3 t=3.7e-04 per=7.3e+00 cost=1.7e+04 flops=4.5e+07
 renorm_tot[gemm] counter=7 i=4 t=3.9e-04 per=7.8e+00 cost=1.1e+04 flops=2.9e+07
 renorm_tot[gemm] counter=7 i=5 t=3.8e-04 per=7.5e+00 cost=1.5e+04 flops=3.9e+07
 renorm_tot[gemm] counter=7 i=6 t=8.6e-04 per=1.7e+01 cost=7.5e+04 flops=8.7e+07
 renorm_tot[gemm] counter=7 total t=3.4e-03 per=6.8e+01 cost=1.6e+05 flops=4.6e+07
 renorm_tot[red] counter=7 t=1.2e-03 per=2.3e+01 cost=4.7e+04 flops=4.1e+07
qops.to_cpu: size(tot)=38:2.9e-04MB:2.8e-07GB t[to_cpu]=1.4e-05S speed=2.1e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00654 S rank=0 -----

coord=(0,0)
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=208:0.00159MB:1.55e-06GB
 rqops: oplist=CSHPQ nops=C:10 S:2 H:1 P:1 Q:3 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=38:0.00029MB:2.83e-07GB
ctns::oper_renorm coord=(0,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:12 S:0 H:1 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.601e+02S Sys:1.342e+00S Total:1.614e+02S
----- TIMING FOR symbolic_formulae_renorm with size=13 : 1.769e-04 S -----
rank=0 GPUmem(GB): used=3.39e-06 (oper)=1.84e-06
rank=0 GPUmem(GB): used=3.42e-06 (oper,site)(GB)=1.84e-06,2.98e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=13
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=3.42e-06 (oper,site,rinter)=1.84e-06,2.98e-08,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000165 S size(rtasks)=13 size(Rlst2)=1 T(Rmu/Rlist)=6.27e-05,0.000103 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000181 S size(rtasks)=13 size(Rlst)=84 -----
rank=0 GPUmem(GB): used=3.42e-06 (oper,site,rinter,batch)=1.84e-06,2.98e-08,0,1.88e-06 blksize=1 blksize0=0 batchsize=84
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.07e-06,0.000268,5.96e-05
--- TIMING FOR renorm : t_inter=6.9e-06 t_gemm=2.7e-04 t_reduction=5.9e-05 tot=3.3e-04 ---
 renorm[inter] counter=8 t=6.9e-06 per=2.1e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=0 t=6.6e-05 per=2.0e+01 cost=7.6e+01 flops=1.2e+06
 renorm[gemm] counter=8 i=1 t=4.9e-05 per=1.5e+01 cost=7.6e+01 flops=1.6e+06
 renorm[gemm] counter=8 i=2 t=5.1e-05 per=1.5e+01 cost=7.6e+01 flops=1.5e+06
 renorm[gemm] counter=8 i=3 t=5.0e-05 per=1.5e+01 cost=7.6e+01 flops=1.5e+06
 renorm[gemm] counter=8 i=4 t=1.2e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=5 t=1.1e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=6 t=4.9e-05 per=1.5e+01 cost=1.7e+02 flops=3.4e+06
 renorm[gemm] counter=8 total t=2.7e-04 per=8.0e+01 cost=4.7e+02 flops=1.8e+06
 renorm[red] counter=8 t=5.9e-05 per=1.8e+01 cost=1.7e+02 flops=2.8e+06
--- TIMING FOR renorm_tot : t_inter=4.8e-04 t_gemm=3.7e-03 t_reduction=1.2e-03 tot=5.4e-03 ---
 renorm_tot[inter] counter=8 t=4.8e-04 per=8.9e+00 cost=2.1e+04 flops=4.4e+07
 renorm_tot[gemm] counter=8 i=0 t=6.2e-04 per=1.2e+01 cost=1.3e+04 flops=2.1e+07
 renorm_tot[gemm] counter=8 i=1 t=5.6e-04 per=1.0e+01 cost=1.7e+04 flops=3.1e+07
 renorm_tot[gemm] counter=8 i=2 t=4.0e-04 per=7.4e+00 cost=1.1e+04 flops=2.6e+07
 renorm_tot[gemm] counter=8 i=3 t=4.2e-04 per=7.8e+00 cost=1.7e+04 flops=4.0e+07
 renorm_tot[gemm] counter=8 i=4 t=3.9e-04 per=7.3e+00 cost=1.1e+04 flops=2.9e+07
 renorm_tot[gemm] counter=8 i=5 t=3.8e-04 per=7.1e+00 cost=1.5e+04 flops=3.9e+07
 renorm_tot[gemm] counter=8 i=6 t=9.1e-04 per=1.7e+01 cost=7.5e+04 flops=8.3e+07
 renorm_tot[gemm] counter=8 total t=3.7e-03 per=6.9e+01 cost=1.6e+05 flops=4.3e+07
 renorm_tot[red] counter=8 t=1.2e-03 per=2.3e+01 cost=4.7e+04 flops=3.9e+07
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB t[to_cpu]=1.3e-05S speed=5.9e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
ctns::oper_ab2pq coord=(0,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00158 S rank=0 -----

matrix: Hmat_isweep0 size=(1,1)
     -3.230157252645e+00 

======================================================================
sweep parameters: isweep=1 dots=1 dcut=10 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=1 sym_state=(6,0) singlet=0
qtensor3: site0new own=1 _data=0x4b87a960
qinfo3: site0new sym=(0,0) dir=1,0,1
 qbond: qrow nsym=1 dimAll=1
 (0,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=4 nblocks=16 size=4:3.0517578125e-05MB
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:0.000320434570312MB:3.12924385071e-07GB
 sites: len=6 mem=156:0.00119018554688MB:1.16229057312e-06GB
 rwfuns: len=1 mem=1:7.62939453125e-06MB:7.45058059692e-09GB
 cpsi: len=1 mem=23:0.000175476074219MB:1.71363353729e-07GB
total mem of comb=222:0.00169372558594MB:1.65402889252e-06GB

isweep=1 ibond=0/seqsize=6 dots=1 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.601e+02S Sys:1.342e+00S Total:1.614e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=156:1.190e-03MB:1.162e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=222:1.694e-03MB:1.654e-06GB
ctns::topology::check_partition: (sl,sr,sc)=1,4,1
 suppl= 0
 suppr= 2 3 4 5
 suppc= 1
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(2,0)
 fqop[2]=./scratch/sweep/cop(1,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 rqops: oplist=CSHPQ nops=C:8 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 qops(tot)=692:5.280e-03MB:5.156e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
wf3(diml,dimr,dimc)=(4,10,4) nnz=23:1.755e-04MB
qtensor3: wf3 own=1 _data=0x4b5fb980
qinfo3: wf3 sym=(6,0) dir=1,1,1
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=8 dimAll=10
 (4,0):3 (3,1):1 (3,-1):1 (2,0):1 (4,2):1 (5,1):1 (5,-1):1 (4,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=15 nblocks=128 size=23:1.755e-04MB
### DIAG TIMING: total=2.091e-04 t1=1.126e-05, t2=1.183e-05, t3=3.180e-05, t4=1.195e-04, t5=1.764e-05, t6=1.315e-05, t7=3.946e-06
duration_diagGPU:2.218e-04
duration_diagreduce:4.600e-08
duration_diagtransform:4.700e-07
----- TIMING FOR symbolic_formulae_onedot with size=67 : 8.413e-04 S -----
rank=0 GPUmem(GB): used=5.16e-06 (oper)=5.16e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=67
 no. of hintermediate operators=20
 no. of coefficients=80:0.00061MB:5.96e-07GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.925e-05 S -----
rank=0 GPUmem(GB): used=5.76e-06 (oper,hinter)=5.16e-06,5.96e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.000969 S size(H_formulae)=67 size(Hxlst2)=15 T(Hmu/Hxlist)=0.000141,0.000828 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00106 S size(H_formulae)=67 size(Hxlst)=870 -----
rank=0 GPUmem(GB): used=7.09e-05 (oper,hinter,dvdson,batch)=5.16e-06,5.96e-07,3.43e-07,6.48e-05 blksize=3 blksize0=3 batchsize=870
ctns::pdvdsonSolver_nkr::solve_iter ndim=23 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.17e-05,8.03e-05,0.000379,9.24e-05,0.000581
 ndim=23:1.71e-07GB t[comm(intra)]=2.17e-05 speed=0.0158GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=8.0e-05 t_gemm=3.8e-04 t_reduction=9.2e-05 tot=5.5e-04 ---
 sigma[inter] counter=1 t=8.0e-05 per=1.5e+01 cost=3.6e+03 flops=4.6e+07
 sigma[gemm] counter=1 i=0 t=6.2e-05 per=1.1e+01 cost=9.5e+02 flops=1.5e+07
 sigma[gemm] counter=1 i=1 t=5.9e-05 per=1.1e+01 cost=9.6e+02 flops=1.6e+07
 sigma[gemm] counter=1 i=2 t=7.4e-05 per=1.3e+01 cost=1.7e+03 flops=2.3e+07
 sigma[gemm] counter=1 i=3 t=7.1e-05 per=1.3e+01 cost=1.7e+03 flops=2.4e+07
 sigma[gemm] counter=1 i=4 t=5.8e-05 per=1.1e+01 cost=9.6e+02 flops=1.7e+07
 sigma[gemm] counter=1 i=5 t=5.5e-05 per=1.0e+01 cost=9.5e+02 flops=1.7e+07
 sigma[gemm] counter=1 total t=3.8e-04 per=6.9e+01 cost=7.3e+03 flops=1.9e+07
 sigma[red] counter=1 t=9.2e-05 per=1.7e+01 cost=2.8e+03 flops=3.0e+07
--- TIMING FOR sigma_tot : t_inter=8.0e-05 t_gemm=3.8e-04 t_reduction=9.2e-05 tot=5.5e-04 ---
 sigma_tot[inter] counter=1 t=8.0e-05 per=1.5e+01 cost=3.6e+03 flops=4.6e+07
 sigma_tot[gemm] counter=1 i=0 t=6.2e-05 per=1.1e+01 cost=9.5e+02 flops=1.5e+07
 sigma_tot[gemm] counter=1 i=1 t=5.9e-05 per=1.1e+01 cost=9.6e+02 flops=1.6e+07
 sigma_tot[gemm] counter=1 i=2 t=7.4e-05 per=1.3e+01 cost=1.7e+03 flops=2.3e+07
 sigma_tot[gemm] counter=1 i=3 t=7.1e-05 per=1.3e+01 cost=1.7e+03 flops=2.4e+07
 sigma_tot[gemm] counter=1 i=4 t=5.8e-05 per=1.1e+01 cost=9.6e+02 flops=1.7e+07
 sigma_tot[gemm] counter=1 i=5 t=5.5e-05 per=1.0e+01 cost=9.5e+02 flops=1.7e+07
 sigma_tot[gemm] counter=1 total t=3.8e-04 per=6.9e+01 cost=7.3e+03 flops=1.9e+07
 sigma_tot[red] counter=1 t=9.2e-05 per=1.7e+01 cost=2.8e+03 flops=3.0e+07
T(sub)=9.1e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.2e-06,1.8e-06,6.4e-07,1.6e-07
settings: ndim=23 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.230157252645 -1.003e+03  1.086e-02    1     1  7.071e-04 7.071e-04 6.827e-04
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.246e-05,8.745e-05,4.440e-04,9.725e-05,6.583e-04
 ndim=23:1.714e-07GB t[comm(intra)]=2.246e-05 speed=1.526e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=8.7e-05 t_gemm=4.4e-04 t_reduction=9.7e-05 tot=6.3e-04 ---
 sigma[inter] counter=2 t=8.7e-05 per=1.4e+01 cost=3.6e+03 flops=4.2e+07
 sigma[gemm] counter=2 i=0 t=6.9e-05 per=1.1e+01 cost=9.5e+02 flops=1.4e+07
 sigma[gemm] counter=2 i=1 t=6.6e-05 per=1.1e+01 cost=9.6e+02 flops=1.5e+07
 sigma[gemm] counter=2 i=2 t=8.1e-05 per=1.3e+01 cost=1.7e+03 flops=2.1e+07
 sigma[gemm] counter=2 i=3 t=8.0e-05 per=1.3e+01 cost=1.7e+03 flops=2.2e+07
 sigma[gemm] counter=2 i=4 t=8.2e-05 per=1.3e+01 cost=9.6e+02 flops=1.2e+07
 sigma[gemm] counter=2 i=5 t=6.5e-05 per=1.0e+01 cost=9.5e+02 flops=1.5e+07
 sigma[gemm] counter=2 total t=4.4e-04 per=7.1e+01 cost=7.3e+03 flops=1.6e+07
 sigma[red] counter=2 t=9.7e-05 per=1.5e+01 cost=2.8e+03 flops=2.8e+07
--- TIMING FOR sigma_tot : t_inter=1.7e-04 t_gemm=8.2e-04 t_reduction=1.9e-04 tot=1.2e-03 ---
 sigma_tot[inter] counter=2 t=1.7e-04 per=1.4e+01 cost=7.3e+03 flops=4.4e+07
 sigma_tot[gemm] counter=2 i=0 t=1.3e-04 per=1.1e+01 cost=1.9e+03 flops=1.5e+07
 sigma_tot[gemm] counter=2 i=1 t=1.2e-04 per=1.1e+01 cost=1.9e+03 flops=1.5e+07
 sigma_tot[gemm] counter=2 i=2 t=1.5e-04 per=1.3e+01 cost=3.4e+03 flops=2.2e+07
 sigma_tot[gemm] counter=2 i=3 t=1.5e-04 per=1.3e+01 cost=3.4e+03 flops=2.3e+07
 sigma_tot[gemm] counter=2 i=4 t=1.4e-04 per=1.2e+01 cost=1.9e+03 flops=1.4e+07
 sigma_tot[gemm] counter=2 i=5 t=1.2e-04 per=1.0e+01 cost=1.9e+03 flops=1.6e+07
 sigma_tot[gemm] counter=2 total t=8.2e-04 per=7.0e+01 cost=1.5e+04 flops=1.8e+07
 sigma_tot[red] counter=2 t=1.9e-04 per=1.6e+01 cost=5.5e+03 flops=2.9e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.5e-05,3.5e-06,1.2e-06,2.8e-07
    2   0 -      -3.230235292065 -7.804e-05  2.775e-03    2     2  6.259e-03 3.130e-03 7.386e-04
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.249e-05,7.933e-05,4.432e-04,9.635e-05,6.462e-04
 ndim=23:1.714e-07GB t[comm(intra)]=2.249e-05 speed=1.524e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=7.9e-05 t_gemm=4.4e-04 t_reduction=9.6e-05 tot=6.2e-04 ---
 sigma[inter] counter=3 t=7.9e-05 per=1.3e+01 cost=3.6e+03 flops=4.6e+07
 sigma[gemm] counter=3 i=0 t=6.6e-05 per=1.1e+01 cost=9.5e+02 flops=1.4e+07
 sigma[gemm] counter=3 i=1 t=6.8e-05 per=1.1e+01 cost=9.6e+02 flops=1.4e+07
 sigma[gemm] counter=3 i=2 t=8.1e-05 per=1.3e+01 cost=1.7e+03 flops=2.1e+07
 sigma[gemm] counter=3 i=3 t=9.4e-05 per=1.5e+01 cost=1.7e+03 flops=1.8e+07
 sigma[gemm] counter=3 i=4 t=6.8e-05 per=1.1e+01 cost=9.6e+02 flops=1.4e+07
 sigma[gemm] counter=3 i=5 t=6.5e-05 per=1.1e+01 cost=9.5e+02 flops=1.5e+07
 sigma[gemm] counter=3 total t=4.4e-04 per=7.2e+01 cost=7.3e+03 flops=1.6e+07
 sigma[red] counter=3 t=9.6e-05 per=1.6e+01 cost=2.8e+03 flops=2.9e+07
--- TIMING FOR sigma_tot : t_inter=2.5e-04 t_gemm=1.3e-03 t_reduction=2.9e-04 tot=1.8e-03 ---
 sigma_tot[inter] counter=3 t=2.5e-04 per=1.4e+01 cost=1.1e+04 flops=4.4e+07
 sigma_tot[gemm] counter=3 i=0 t=2.0e-04 per=1.1e+01 cost=2.9e+03 flops=1.4e+07
 sigma_tot[gemm] counter=3 i=1 t=1.9e-04 per=1.1e+01 cost=2.9e+03 flops=1.5e+07
 sigma_tot[gemm] counter=3 i=2 t=2.4e-04 per=1.3e+01 cost=5.2e+03 flops=2.2e+07
 sigma_tot[gemm] counter=3 i=3 t=2.4e-04 per=1.4e+01 cost=5.2e+03 flops=2.1e+07
 sigma_tot[gemm] counter=3 i=4 t=2.1e-04 per=1.2e+01 cost=2.9e+03 flops=1.4e+07
 sigma_tot[gemm] counter=3 i=5 t=1.9e-04 per=1.0e+01 cost=2.9e+03 flops=1.5e+07
 sigma_tot[gemm] counter=3 total t=1.3e-03 per=7.0e+01 cost=2.2e+04 flops=1.7e+07
 sigma_tot[red] counter=3 t=2.9e-04 per=1.6e+01 cost=8.3e+03 flops=2.9e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,1.6e-05,3.0e-06,1.1e-06,2.1e-07
    3   0 -      -3.230241492957 -6.201e-06  1.179e-03    3     3  1.533e-02 5.109e-03 7.532e-04
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.312e-05,8.489e-05,4.314e-04,9.706e-05,6.427e-04
 ndim=23:1.714e-07GB t[comm(intra)]=2.312e-05 speed=1.483e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=8.5e-05 t_gemm=4.3e-04 t_reduction=9.7e-05 tot=6.1e-04 ---
 sigma[inter] counter=4 t=8.5e-05 per=1.4e+01 cost=3.6e+03 flops=4.3e+07
 sigma[gemm] counter=4 i=0 t=6.6e-05 per=1.1e+01 cost=9.5e+02 flops=1.4e+07
 sigma[gemm] counter=4 i=1 t=7.4e-05 per=1.2e+01 cost=9.6e+02 flops=1.3e+07
 sigma[gemm] counter=4 i=2 t=8.1e-05 per=1.3e+01 cost=1.7e+03 flops=2.1e+07
 sigma[gemm] counter=4 i=3 t=8.0e-05 per=1.3e+01 cost=1.7e+03 flops=2.1e+07
 sigma[gemm] counter=4 i=4 t=6.5e-05 per=1.1e+01 cost=9.6e+02 flops=1.5e+07
 sigma[gemm] counter=4 i=5 t=6.5e-05 per=1.1e+01 cost=9.5e+02 flops=1.5e+07
 sigma[gemm] counter=4 total t=4.3e-04 per=7.0e+01 cost=7.3e+03 flops=1.7e+07
 sigma[red] counter=4 t=9.7e-05 per=1.6e+01 cost=2.8e+03 flops=2.9e+07
--- TIMING FOR sigma_tot : t_inter=3.3e-04 t_gemm=1.7e-03 t_reduction=3.8e-04 tot=2.4e-03 ---
 sigma_tot[inter] counter=4 t=3.3e-04 per=1.4e+01 cost=1.5e+04 flops=4.4e+07
 sigma_tot[gemm] counter=4 i=0 t=2.6e-04 per=1.1e+01 cost=3.8e+03 flops=1.4e+07
 sigma_tot[gemm] counter=4 i=1 t=2.7e-04 per=1.1e+01 cost=3.9e+03 flops=1.5e+07
 sigma_tot[gemm] counter=4 i=2 t=3.2e-04 per=1.3e+01 cost=6.9e+03 flops=2.2e+07
 sigma_tot[gemm] counter=4 i=3 t=3.3e-04 per=1.4e+01 cost=6.9e+03 flops=2.1e+07
 sigma_tot[gemm] counter=4 i=4 t=2.7e-04 per=1.1e+01 cost=3.9e+03 flops=1.4e+07
 sigma_tot[gemm] counter=4 i=5 t=2.5e-04 per=1.0e+01 cost=3.8e+03 flops=1.5e+07
 sigma_tot[gemm] counter=4 total t=1.7e-03 per=7.0e+01 cost=2.9e+04 flops=1.7e+07
 sigma_tot[red] counter=4 t=3.8e-04 per=1.6e+01 cost=1.1e+04 flops=2.9e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,1.5e-05,3.0e-06,1.0e-06,2.3e-07
    4   0 -      -3.230242705585 -1.213e-06  4.286e-04    3     4  2.447e-02 6.116e-03 7.593e-04
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.217e-05,8.889e-05,4.274e-04,9.430e-05,6.383e-04
 ndim=23:1.714e-07GB t[comm(intra)]=2.217e-05 speed=1.546e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=8.9e-05 t_gemm=4.3e-04 t_reduction=9.4e-05 tot=6.1e-04 ---
 sigma[inter] counter=5 t=8.9e-05 per=1.5e+01 cost=3.6e+03 flops=4.1e+07
 sigma[gemm] counter=5 i=0 t=6.8e-05 per=1.1e+01 cost=9.5e+02 flops=1.4e+07
 sigma[gemm] counter=5 i=1 t=6.6e-05 per=1.1e+01 cost=9.6e+02 flops=1.5e+07
 sigma[gemm] counter=5 i=2 t=8.1e-05 per=1.3e+01 cost=1.7e+03 flops=2.1e+07
 sigma[gemm] counter=5 i=3 t=8.0e-05 per=1.3e+01 cost=1.7e+03 flops=2.2e+07
 sigma[gemm] counter=5 i=4 t=6.6e-05 per=1.1e+01 cost=9.6e+02 flops=1.5e+07
 sigma[gemm] counter=5 i=5 t=6.6e-05 per=1.1e+01 cost=9.5e+02 flops=1.5e+07
 sigma[gemm] counter=5 total t=4.3e-04 per=7.0e+01 cost=7.3e+03 flops=1.7e+07
 sigma[red] counter=5 t=9.4e-05 per=1.5e+01 cost=2.8e+03 flops=2.9e+07
--- TIMING FOR sigma_tot : t_inter=4.2e-04 t_gemm=2.1e-03 t_reduction=4.8e-04 tot=3.0e-03 ---
 sigma_tot[inter] counter=5 t=4.2e-04 per=1.4e+01 cost=1.8e+04 flops=4.3e+07
 sigma_tot[gemm] counter=5 i=0 t=3.3e-04 per=1.1e+01 cost=4.8e+03 flops=1.4e+07
 sigma_tot[gemm] counter=5 i=1 t=3.3e-04 per=1.1e+01 cost=4.8e+03 flops=1.5e+07
 sigma_tot[gemm] counter=5 i=2 t=4.0e-04 per=1.3e+01 cost=8.6e+03 flops=2.2e+07
 sigma_tot[gemm] counter=5 i=3 t=4.0e-04 per=1.3e+01 cost=8.6e+03 flops=2.1e+07
 sigma_tot[gemm] counter=5 i=4 t=3.4e-04 per=1.1e+01 cost=4.8e+03 flops=1.4e+07
 sigma_tot[gemm] counter=5 i=5 t=3.2e-04 per=1.0e+01 cost=4.8e+03 flops=1.5e+07
 sigma_tot[gemm] counter=5 total t=2.1e-03 per=7.0e+01 cost=3.6e+04 flops=1.7e+07
 sigma_tot[red] counter=5 t=4.8e-04 per=1.6e+01 cost=1.4e+04 flops=2.9e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,1.4e-05,3.0e-06,1.0e-06,2.0e-07
    5   0 +      -3.230242893797 -1.882e-07  8.801e-05    3     5  3.366e-02 6.732e-03 7.627e-04
TIMING FOR Davidson : 3.367e-02  T(cal/comm/rest)=3.814e-03,6.060e-07,2.986e-02
decomposed t_rest=2.986e-02
 T(sub)    =9.955e-05 per=3.334e-01
 T(precond)=2.962e-02 per=9.922e+01
 T(ortho)  =1.484e-05 per=4.969e-02
 T(xcopy)  =7.860e-07 per=2.633e-03
 T(xnrm2)  =2.271e-06 per=7.607e-03
 T(other)  =1.158e-04 per=3.880e-01
optimized energies: isweep=1 ibond=0 dots=1 e[0]=-3.230242893797 nmvp=5
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.637e+02S Sys:1.349e+00S Total:1.651e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=10 nqr=9 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep1_ibond0.txt
 qbond: qsuper nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
timing for divide=1.1e-05
timing for compute=7.6e-05
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 1.0e-04 S T(divide/compute/collect)=1.1e-05,7.6e-05,1.4e-05 -----
decimation summary: 16->10 dwt=+0.000e+00 SvN=7.734e-01
 qbond: qkept nsym=8 dimAll=10
 (2,0):3 (1,1):1 (1,-1):1 (4,0):1 (3,1):1 (3,-1):1 (2,2):1 (2,-2):1
----- TIMING for decimation_row(nkr): 4.697e-04 S T(decim/select/formRot)=1.596e-04,2.808e-04,2.920e-05 -----
----- TIMING FOR onedot_decimation: 5.629e-04 S T(wf/decim)=7.961e-05,4.833e-04 -----
ctns::oper_renorm coord=(1,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:4 S:8 H:1 A:6 B:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.639e+02S Sys:1.350e+00S Total:1.652e+02S
----- TIMING FOR symbolic_formulae_renorm with size=29 : 6.833e-04 S -----
rank=0 GPUmem(GB): used=5.76e-06 (oper)=5.16e-06
rank=0 GPUmem(GB): used=5.93e-06 (oper,site)(GB)=5.16e-06,1.71e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=29
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=5.93e-06 (oper,site,rinter)=5.16e-06,1.71e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00109 S size(rtasks)=29 size(Rlst2)=64 T(Rmu/Rlist)=0.000213,0.000876 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00117 S size(rtasks)=29 size(Rlst)=630 -----
rank=0 GPUmem(GB): used=5.93e-06 (oper,site,rinter,batch)=5.16e-06,1.71e-07,0,8.92e-05 blksize=9 blksize0=0 batchsize=630
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.08e-06,0.000316,0.00011
--- TIMING FOR renorm : t_inter=8.8e-06 t_gemm=3.1e-04 t_reduction=1.1e-04 tot=4.3e-04 ---
 renorm[inter] counter=1 t=8.8e-06 per=2.0e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=7.2e-05 per=1.7e+01 cost=6.1e+02 flops=8.4e+06
 renorm[gemm] counter=1 i=1 t=5.8e-05 per=1.3e+01 cost=1.0e+03 flops=1.8e+07
 renorm[gemm] counter=1 i=2 t=1.1e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=3 t=1.1e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=4 t=5.5e-05 per=1.3e+01 cost=9.3e+02 flops=1.7e+07
 renorm[gemm] counter=1 i=5 t=5.3e-05 per=1.2e+01 cost=7.0e+02 flops=1.3e+07
 renorm[gemm] counter=1 i=6 t=7.4e-05 per=1.7e+01 cost=3.4e+03 flops=4.6e+07
 renorm[gemm] counter=1 total t=3.1e-04 per=7.3e+01 cost=6.7e+03 flops=2.1e+07
 renorm[red] counter=1 t=1.1e-04 per=2.5e+01 cost=3.4e+03 flops=3.1e+07
--- TIMING FOR renorm_tot : t_inter=8.8e-06 t_gemm=3.1e-04 t_reduction=1.1e-04 tot=4.3e-04 ---
 renorm_tot[inter] counter=1 t=8.8e-06 per=2.0e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=7.2e-05 per=1.7e+01 cost=6.1e+02 flops=8.4e+06
 renorm_tot[gemm] counter=1 i=1 t=5.8e-05 per=1.3e+01 cost=1.0e+03 flops=1.8e+07
 renorm_tot[gemm] counter=1 i=2 t=1.1e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=3 t=1.1e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=4 t=5.5e-05 per=1.3e+01 cost=9.3e+02 flops=1.7e+07
 renorm_tot[gemm] counter=1 i=5 t=5.3e-05 per=1.2e+01 cost=7.0e+02 flops=1.3e+07
 renorm_tot[gemm] counter=1 i=6 t=7.4e-05 per=1.7e+01 cost=3.4e+03 flops=4.6e+07
 renorm_tot[gemm] counter=1 total t=3.1e-04 per=7.3e+01 cost=6.7e+03 flops=2.1e+07
 renorm_tot[red] counter=1 t=1.1e-04 per=2.5e+01 cost=3.4e+03 flops=3.1e+07
qops.to_cpu: size(tot)=276:2.1e-03MB:2.1e-06GB t[to_cpu]=1.4e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=4.969e-16 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00718 S rank=0 -----
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.642e+02S Sys:1.350e+00S Total:1.655e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=156:1.190e-03MB:1.162e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=51:3.891e-04MB:3.800e-07GB
total mem of comb=250:1.907e-03MB:1.863e-06GB
CPUmem: VM:1.923e+01GB RSS:1.844e+00GB  Timing: User:1.642e+02S Sys:1.350e+00S Total:1.655e+02S
##### local opt: 5.069e-02 S #####
 T(local opt: fetch) = 1.245e-03 S  per = 2.46  per(accum) = 2.46
 T(local opt: hdiag) = 2.805e-04 S  per = 0.553  per(accum) = 3.01
 T(local opt: dvdsn) = 4.074e-02 S  per = 80.4  per(accum) = 83.4
 T(local opt: decim) = 5.880e-04 S  per = 1.16  per(accum) = 84.5
 T(local opt: guess) = 1.271e-04 S  per = 0.251  per(accum) = 84.8
 T(local opt: renrm) = 7.450e-03 S  per = 14.7  per(accum) = 99.5
 T(local opt: save ) = 2.581e-04 S  per = 0.509  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.074e-02 S  T(sum) = 4.052e-02 S  per = 9.946e+01
 T(local opt: preprocess                  ) = 2.341e-04 S  per = 0.578  per(accum) = 0.578
 T(local opt: symbolic_formulae           ) = 8.521e-04 S  per =  2.1  per(accum) = 2.68
 T(local opt: hintermediate init          ) = 5.597e-05 S  per = 0.138  per(accum) = 2.82
 T(local opt: preprocess_hformulae_Hxlist ) = 1.087e-03 S  per = 2.68  per(accum) = 5.5
 T(local opt: hmmtasks init               ) = 4.620e-03 S  per = 11.4  per(accum) = 16.9
 T(local opt: initial guess for dvdson    ) = 2.730e-06 S  per = 0.00674  per(accum) = 16.9
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.702e-03 S  per = 9.14  per(accum) = 26
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.119e-04 S  per = 0.276  per(accum) = 26.3
 T(local opt: dvdson solver [comm(cpu)]   ) = 6.060e-07 S  per = 0.0015  per(accum) = 26.3
 T(local opt: dvdson solver [rest part]   ) = 2.986e-02 S  per = 73.7  per(accum) = 100
Detailed decomposition of T(renrm) = 7.450e-03 S  T(sum) = 7.450e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 9.594e-05 S  per = 1.29  per(accum) = 1.29
 T(local opt: qops init                    ) = 6.333e-04 S  per =  8.5  per(accum) = 9.79
 T(local opt: symbolic_formulae_renorm     ) = 6.923e-04 S  per = 9.29  per(accum) = 19.1
 T(local opt: allocate qops on gpu         ) = 2.209e-05 S  per = 0.297  per(accum) = 19.4
 T(local opt: site memcpy cpu2gpu          ) = 1.963e-05 S  per = 0.263  per(accum) = 19.6
 T(local opt: rintermediate init           ) = 2.260e-05 S  per = 0.303  per(accum) = 19.9
 T(local opt: preprocess_formulae_Rlist2   ) = 1.201e-03 S  per = 16.1  per(accum) = 36.1
 T(local opt: rmmtasks init                ) = 3.996e-03 S  per = 53.6  per(accum) = 89.7
 T(local opt: qops memset on cpu           ) = 4.700e-08 S  per = 0.000631  per(accum) = 89.7
 T(local opt: preprocess_renorm_batchGPU   ) = 5.385e-04 S  per = 7.23  per(accum) = 96.9
 T(local opt: reduction of opS & opH [nccl]) = 9.780e-07 S  per = 0.0131  per(accum) = 96.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.948e-05 S  per = 0.261  per(accum) = 97.2
 T(local opt: deallocate cpu and gpu memory) = 1.052e-05 S  per = 0.141  per(accum) = 97.3
 T(local opt: reduction of opS & opH [comm]) = 2.594e-05 S  per = 0.348  per(accum) = 97.7
 T(local opt: conversion from opAB to opPQ ) = 3.742e-06 S  per = 0.0502  per(accum) = 97.7
 T(local opt: after oper_renorm            ) = 1.685e-04 S  per = 2.26  per(accum) = 100
##### sweep opt: 5.069e-02 S #####
 T(sweep opt: fetch) = 1.245e-03 S  per = 2.46  per(accum) = 2.46
 T(sweep opt: hdiag) = 2.805e-04 S  per = 0.553  per(accum) = 3.01
 T(sweep opt: dvdsn) = 4.074e-02 S  per = 80.4  per(accum) = 83.4
 T(sweep opt: decim) = 5.880e-04 S  per = 1.16  per(accum) = 84.5
 T(sweep opt: guess) = 1.271e-04 S  per = 0.251  per(accum) = 84.8
 T(sweep opt: renrm) = 7.450e-03 S  per = 14.7  per(accum) = 99.5
 T(sweep opt: save ) = 2.581e-04 S  per = 0.509  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.074e-02 S  T(sum) = 4.052e-02 S  per = 9.946e+01
 T(sweep opt: preprocess                  ) = 2.341e-04 S  per = 0.578  per(accum) = 0.578
 T(sweep opt: symbolic_formulae           ) = 8.521e-04 S  per =  2.1  per(accum) = 2.68
 T(sweep opt: hintermediate init          ) = 5.597e-05 S  per = 0.138  per(accum) = 2.82
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.087e-03 S  per = 2.68  per(accum) = 5.5
 T(sweep opt: hmmtasks init               ) = 4.620e-03 S  per = 11.4  per(accum) = 16.9
 T(sweep opt: initial guess for dvdson    ) = 2.730e-06 S  per = 0.00674  per(accum) = 16.9
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 3.702e-03 S  per = 9.14  per(accum) = 26
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 1.119e-04 S  per = 0.276  per(accum) = 26.3
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 6.060e-07 S  per = 0.0015  per(accum) = 26.3
 T(sweep opt: dvdson solver [rest part]   ) = 2.986e-02 S  per = 73.7  per(accum) = 100
Detailed decomposition of T(renrm) = 7.450e-03 S  T(sum) = 7.450e-03 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.594e-05 S  per = 1.29  per(accum) = 1.29
 T(sweep opt: qops init                    ) = 6.333e-04 S  per =  8.5  per(accum) = 9.79
 T(sweep opt: symbolic_formulae_renorm     ) = 6.923e-04 S  per = 9.29  per(accum) = 19.1
 T(sweep opt: allocate qops on gpu         ) = 2.209e-05 S  per = 0.297  per(accum) = 19.4
 T(sweep opt: site memcpy cpu2gpu          ) = 1.963e-05 S  per = 0.263  per(accum) = 19.6
 T(sweep opt: rintermediate init           ) = 2.260e-05 S  per = 0.303  per(accum) = 19.9
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.201e-03 S  per = 16.1  per(accum) = 36.1
 T(sweep opt: rmmtasks init                ) = 3.996e-03 S  per = 53.6  per(accum) = 89.7
 T(sweep opt: qops memset on cpu           ) = 4.700e-08 S  per = 0.000631  per(accum) = 89.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.385e-04 S  per = 7.23  per(accum) = 96.9
 T(sweep opt: reduction of opS & opH [nccl]) = 9.780e-07 S  per = 0.0131  per(accum) = 96.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.948e-05 S  per = 0.261  per(accum) = 97.2
 T(sweep opt: deallocate cpu and gpu memory) = 1.052e-05 S  per = 0.141  per(accum) = 97.3
 T(sweep opt: reduction of opS & opH [comm]) = 2.594e-05 S  per = 0.348  per(accum) = 97.7
 T(sweep opt: conversion from opAB to opPQ ) = 3.742e-06 S  per = 0.0502  per(accum) = 97.7
 T(sweep opt: after oper_renorm            ) = 1.685e-04 S  per = 2.26  per(accum) = 100
##### global opt: 1.614e+00 S #####
 T(global opt: fetch) = 6.149e-03 S  per = 0.381  per(accum) = 0.381
 T(global opt: hdiag) = 6.139e-03 S  per = 0.38  per(accum) = 0.761
 T(global opt: dvdsn) = 1.049e+00 S  per =   65  per(accum) = 65.8
 T(global opt: decim) = 5.773e-03 S  per = 0.358  per(accum) = 66.1
 T(global opt: guess) = 1.967e-03 S  per = 0.122  per(accum) = 66.2
 T(global opt: renrm) = 5.426e-01 S  per = 33.6  per(accum) = 99.8
 T(global opt: save ) = 2.493e-03 S  per = 0.154  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.049e+00 S  T(sum) = 1.047e+00 S  per = 9.981e+01
 T(global opt: preprocess                  ) = 5.070e-03 S  per = 0.484  per(accum) = 0.484
 T(global opt: symbolic_formulae           ) = 1.589e-02 S  per = 1.52  per(accum) = 2
 T(global opt: hintermediate init          ) = 7.146e-04 S  per = 0.0682  per(accum) = 2.07
 T(global opt: preprocess_hformulae_Hxlist ) = 9.005e-02 S  per =  8.6  per(accum) = 10.7
 T(global opt: hmmtasks init               ) = 4.771e-01 S  per = 45.6  per(accum) = 56.2
 T(global opt: initial guess for dvdson    ) = 1.465e-03 S  per = 0.14  per(accum) = 56.4
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.103e-01 S  per = 10.5  per(accum) = 66.9
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.228e-03 S  per = 0.117  per(accum) = 67
 T(global opt: dvdson solver [comm(cpu)]   ) = 6.251e-06 S  per = 0.000597  per(accum) = 67
 T(global opt: dvdson solver [rest part]   ) = 3.454e-01 S  per =   33  per(accum) = 100
Detailed decomposition of T(renrm) = 5.426e-01 S  T(sum) = 5.426e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.997e-04 S  per = 0.129  per(accum) = 0.129
 T(global opt: qops init                    ) = 3.800e-03 S  per =  0.7  per(accum) = 0.829
 T(global opt: symbolic_formulae_renorm     ) = 6.981e-03 S  per = 1.29  per(accum) = 2.12
 T(global opt: allocate qops on gpu         ) = 1.612e-04 S  per = 0.0297  per(accum) = 2.15
 T(global opt: site memcpy cpu2gpu          ) = 1.523e-04 S  per = 0.0281  per(accum) = 2.17
 T(global opt: rintermediate init           ) = 5.267e-04 S  per = 0.0971  per(accum) = 2.27
 T(global opt: preprocess_formulae_Rlist2   ) = 1.170e-02 S  per = 2.16  per(accum) = 4.43
 T(global opt: rmmtasks init                ) = 4.601e-02 S  per = 8.48  per(accum) = 12.9
 T(global opt: qops memset on cpu           ) = 3.200e-07 S  per = 5.9e-05  per(accum) = 12.9
 T(global opt: preprocess_renorm_batchGPU   ) = 5.640e-03 S  per = 1.04  per(accum) = 13.9
 T(global opt: reduction of opS & opH [nccl]) = 7.520e-06 S  per = 0.00139  per(accum) = 13.9
 T(global opt: qops memcpy gpu2cpu          ) = 1.395e-04 S  per = 0.0257  per(accum) = 14
 T(global opt: deallocate cpu and gpu memory) = 7.670e-05 S  per = 0.0141  per(accum) = 14
 T(global opt: reduction of opS & opH [comm]) = 1.753e-04 S  per = 0.0323  per(accum) = 14
 T(global opt: conversion from opAB to opPQ ) = 4.647e-01 S  per = 85.7  per(accum) = 99.7
 T(global opt: after oper_renorm            ) = 1.760e-03 S  per = 0.324  per(accum) = 100

isweep=1 ibond=1/seqsize=6 dots=1 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.929e+01GB RSS:1.844e+00GB  Timing: User:1.642e+02S Sys:1.351e+00S Total:1.655e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=156:1.190e-03MB:1.162e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=51:3.891e-04MB:3.800e-07GB
total mem of comb=250:1.907e-03MB:1.863e-06GB
ctns::topology::check_partition: (sl,sr,sc)=2,3,1
 suppl= 0 1
 suppr= 3 4 5
 suppc= 2
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:4 S:8 H:1 A:6 B:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
 rqops: oplist=CSHPQ nops=C:6 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=10,10 size(op)=22:1.678e-04MB size(tot)=517:3.944e-03MB:3.852e-06GB
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 qops(tot)=1001:7.637e-03MB:7.458e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
wf3(diml,dimr,dimc)=(10,10,4) nnz=51:3.891e-04MB
qtensor3: wf3 own=1 _data=0x4eaaea80
qinfo3: wf3 sym=(6,0) dir=1,1,1
 qbond: qrow nsym=8 dimAll=10
 (2,0):3 (1,1):1 (1,-1):1 (4,0):1 (3,1):1 (3,-1):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=6 dimAll=10
 (3,1):3 (3,-1):3 (2,0):1 (4,0):1 (2,2):1 (4,2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=19 nblocks=192 size=51:3.891e-04MB
### DIAG TIMING: total=3.688e-04 t1=8.924e-06, t2=1.335e-05, t3=2.853e-05, t4=2.826e-04, t5=1.883e-05, t6=1.246e-05, t7=4.178e-06
duration_diagGPU:3.821e-04
duration_diagreduce:4.800e-08
duration_diagtransform:6.250e-07
----- TIMING FOR symbolic_formulae_onedot with size=137 : 1.461e-03 S -----
rank=0 GPUmem(GB): used=7.46e-06 (oper)=7.46e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=137
 no. of hintermediate operators=58
 no. of coefficients=174:0.00133MB:1.3e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.776e-05 S -----
rank=0 GPUmem(GB): used=8.75e-06 (oper,hinter)=7.46e-06,1.3e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00237 S size(H_formulae)=137 size(Hxlst2)=19 T(Hmu/Hxlist)=0.000323,0.00205 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00256 S size(H_formulae)=137 size(Hxlst)=1962 -----
rank=0 GPUmem(GB): used=0.000331 (oper,hinter,dvdson,batch)=7.46e-06,1.3e-06,7.6e-07,0.000322 blksize=9 blksize0=3 batchsize=1962
ctns::pdvdsonSolver_nkr::solve_iter ndim=51 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.2e-05,8.53e-05,0.000598,0.000181,0.000895
 ndim=51:3.8e-07GB t[comm(intra)]=2.2e-05 speed=0.0345GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=8.5e-05 t_gemm=6.0e-04 t_reduction=1.8e-04 tot=8.6e-04 ---
 sigma[inter] counter=6 t=8.5e-05 per=9.9e+00 cost=1.1e+04 flops=1.3e+08
 sigma[gemm] counter=6 i=0 t=8.1e-05 per=9.4e+00 cost=4.2e+03 flops=5.2e+07
 sigma[gemm] counter=6 i=1 t=7.5e-05 per=8.7e+00 cost=4.1e+03 flops=5.4e+07
 sigma[gemm] counter=6 i=2 t=1.1e-04 per=1.3e+01 cost=8.0e+03 flops=7.2e+07
 sigma[gemm] counter=6 i=3 t=1.0e-04 per=1.2e+01 cost=8.0e+03 flops=7.8e+07
 sigma[gemm] counter=6 i=4 t=1.1e-04 per=1.3e+01 cost=8.3e+03 flops=7.6e+07
 sigma[gemm] counter=6 i=5 t=1.2e-04 per=1.4e+01 cost=8.3e+03 flops=7.0e+07
 sigma[gemm] counter=6 total t=6.0e-04 per=6.9e+01 cost=4.1e+04 flops=6.8e+07
 sigma[red] counter=6 t=1.8e-04 per=2.1e+01 cost=1.2e+04 flops=6.4e+07
--- TIMING FOR sigma_tot : t_inter=5.0e-04 t_gemm=2.7e-03 t_reduction=6.6e-04 tot=3.9e-03 ---
 sigma_tot[inter] counter=6 t=5.0e-04 per=1.3e+01 cost=3.0e+04 flops=5.9e+07
 sigma_tot[gemm] counter=6 i=0 t=4.1e-04 per=1.1e+01 cost=8.9e+03 flops=2.2e+07
 sigma_tot[gemm] counter=6 i=1 t=4.1e-04 per=1.0e+01 cost=8.9e+03 flops=2.2e+07
 sigma_tot[gemm] counter=6 i=2 t=5.1e-04 per=1.3e+01 cost=1.7e+04 flops=3.3e+07
 sigma_tot[gemm] counter=6 i=3 t=5.1e-04 per=1.3e+01 cost=1.7e+04 flops=3.3e+07
 sigma_tot[gemm] counter=6 i=4 t=4.5e-04 per=1.2e+01 cost=1.3e+04 flops=2.9e+07
 sigma_tot[gemm] counter=6 i=5 t=4.3e-04 per=1.1e+01 cost=1.3e+04 flops=3.0e+07
 sigma_tot[gemm] counter=6 total t=2.7e-03 per=7.0e+01 cost=7.7e+04 flops=2.8e+07
 sigma_tot[red] counter=6 t=6.6e-04 per=1.7e+01 cost=2.5e+04 flops=3.9e+07
T(sub)=9.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,4.2e-06,2.0e-06,6.3e-07,1.7e-07
settings: ndim=51 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.230242893797 -1.003e+03  5.282e-03    1     1  1.021e-03 1.021e-03 9.950e-04
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.257e-05,1.007e-04,6.750e-04,1.872e-04,9.924e-04
 ndim=51:3.800e-07GB t[comm(intra)]=2.257e-05 speed=3.367e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=6.7e-04 t_reduction=1.9e-04 tot=9.6e-04 ---
 sigma[inter] counter=7 t=1.0e-04 per=1.0e+01 cost=1.1e+04 flops=1.1e+08
 sigma[gemm] counter=7 i=0 t=9.1e-05 per=9.5e+00 cost=4.2e+03 flops=4.6e+07
 sigma[gemm] counter=7 i=1 t=8.8e-05 per=9.1e+00 cost=4.1e+03 flops=4.7e+07
 sigma[gemm] counter=7 i=2 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.5e+07
 sigma[gemm] counter=7 i=3 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.5e+07
 sigma[gemm] counter=7 i=4 t=1.2e-04 per=1.3e+01 cost=8.3e+03 flops=6.7e+07
 sigma[gemm] counter=7 i=5 t=1.3e-04 per=1.3e+01 cost=8.3e+03 flops=6.6e+07
 sigma[gemm] counter=7 total t=6.7e-04 per=7.0e+01 cost=4.1e+04 flops=6.1e+07
 sigma[red] counter=7 t=1.9e-04 per=1.9e+01 cost=1.2e+04 flops=6.2e+07
--- TIMING FOR sigma_tot : t_inter=6.1e-04 t_gemm=3.4e-03 t_reduction=8.4e-04 tot=4.8e-03 ---
 sigma_tot[inter] counter=7 t=6.1e-04 per=1.3e+01 cost=4.1e+04 flops=6.8e+07
 sigma_tot[gemm] counter=7 i=0 t=5.0e-04 per=1.0e+01 cost=1.3e+04 flops=2.6e+07
 sigma_tot[gemm] counter=7 i=1 t=4.9e-04 per=1.0e+01 cost=1.3e+04 flops=2.6e+07
 sigma_tot[gemm] counter=7 i=2 t=6.3e-04 per=1.3e+01 cost=2.5e+04 flops=3.9e+07
 sigma_tot[gemm] counter=7 i=3 t=6.3e-04 per=1.3e+01 cost=2.5e+04 flops=3.9e+07
 sigma_tot[gemm] counter=7 i=4 t=5.7e-04 per=1.2e+01 cost=2.1e+04 flops=3.8e+07
 sigma_tot[gemm] counter=7 i=5 t=5.6e-04 per=1.2e+01 cost=2.1e+04 flops=3.8e+07
 sigma_tot[gemm] counter=7 total t=3.4e-03 per=7.0e+01 cost=1.2e+05 flops=3.5e+07
 sigma_tot[red] counter=7 t=8.4e-04 per=1.7e+01 cost=3.7e+04 flops=4.4e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.3e-05,4.2e-06,1.2e-06,2.3e-07
    2   0 -      -3.230259459941 -1.657e-05  1.440e-03    2     2  6.962e-03 3.481e-03 1.068e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.316e-05,9.870e-05,6.983e-04,1.754e-04,1.003e-03
 ndim=51:3.800e-07GB t[comm(intra)]=2.316e-05 speed=3.281e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.8e-05 t_gemm=7.0e-04 t_reduction=1.8e-04 tot=9.7e-04 ---
 sigma[inter] counter=8 t=9.8e-05 per=1.0e+01 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=8 i=0 t=9.2e-05 per=9.5e+00 cost=4.2e+03 flops=4.6e+07
 sigma[gemm] counter=8 i=1 t=9.0e-05 per=9.2e+00 cost=4.1e+03 flops=4.6e+07
 sigma[gemm] counter=8 i=2 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.4e+07
 sigma[gemm] counter=8 i=3 t=1.3e-04 per=1.3e+01 cost=8.0e+03 flops=6.3e+07
 sigma[gemm] counter=8 i=4 t=1.3e-04 per=1.3e+01 cost=8.3e+03 flops=6.7e+07
 sigma[gemm] counter=8 i=5 t=1.4e-04 per=1.4e+01 cost=8.3e+03 flops=5.9e+07
 sigma[gemm] counter=8 total t=7.0e-04 per=7.2e+01 cost=4.1e+04 flops=5.9e+07
 sigma[red] counter=8 t=1.8e-04 per=1.8e+01 cost=1.2e+04 flops=6.6e+07
--- TIMING FOR sigma_tot : t_inter=7.0e-04 t_gemm=4.1e-03 t_reduction=1.0e-03 tot=5.8e-03 ---
 sigma_tot[inter] counter=8 t=7.0e-04 per=1.2e+01 cost=5.3e+04 flops=7.5e+07
 sigma_tot[gemm] counter=8 i=0 t=6.0e-04 per=1.0e+01 cost=1.7e+04 flops=2.9e+07
 sigma_tot[gemm] counter=8 i=1 t=5.8e-04 per=1.0e+01 cost=1.7e+04 flops=2.9e+07
 sigma_tot[gemm] counter=8 i=2 t=7.6e-04 per=1.3e+01 cost=3.3e+04 flops=4.3e+07
 sigma_tot[gemm] counter=8 i=3 t=7.6e-04 per=1.3e+01 cost=3.2e+04 flops=4.3e+07
 sigma_tot[gemm] counter=8 i=4 t=7.0e-04 per=1.2e+01 cost=3.0e+04 flops=4.3e+07
 sigma_tot[gemm] counter=8 i=5 t=7.0e-04 per=1.2e+01 cost=3.0e+04 flops=4.2e+07
 sigma_tot[gemm] counter=8 total t=4.1e-03 per=7.0e+01 cost=1.6e+05 flops=3.9e+07
 sigma_tot[red] counter=8 t=1.0e-03 per=1.8e+01 cost=4.8e+04 flops=4.8e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.7e-05,3.3e-06,1.3e-06,2.0e-07
    3   0 -      -3.230260845307 -1.385e-06  5.175e-04    3     3  1.612e-02 5.373e-03 1.095e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.208e-05,9.464e-05,6.878e-04,1.769e-04,9.869e-04
 ndim=51:3.800e-07GB t[comm(intra)]=2.208e-05 speed=3.442e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.4e-05 t_gemm=6.9e-04 t_reduction=1.8e-04 tot=9.6e-04 ---
 sigma[inter] counter=9 t=9.4e-05 per=9.9e+00 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=9 i=0 t=8.9e-05 per=9.3e+00 cost=4.2e+03 flops=4.7e+07
 sigma[gemm] counter=9 i=1 t=8.8e-05 per=9.2e+00 cost=4.1e+03 flops=4.6e+07
 sigma[gemm] counter=9 i=2 t=1.3e-04 per=1.3e+01 cost=8.0e+03 flops=6.3e+07
 sigma[gemm] counter=9 i=3 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.5e+07
 sigma[gemm] counter=9 i=4 t=1.4e-04 per=1.4e+01 cost=8.3e+03 flops=6.0e+07
 sigma[gemm] counter=9 i=5 t=1.2e-04 per=1.3e+01 cost=8.3e+03 flops=6.8e+07
 sigma[gemm] counter=9 total t=6.9e-04 per=7.2e+01 cost=4.1e+04 flops=6.0e+07
 sigma[red] counter=9 t=1.8e-04 per=1.8e+01 cost=1.2e+04 flops=6.5e+07
--- TIMING FOR sigma_tot : t_inter=8.0e-04 t_gemm=4.8e-03 t_reduction=1.2e-03 tot=6.8e-03 ---
 sigma_tot[inter] counter=9 t=8.0e-04 per=1.2e+01 cost=6.4e+04 flops=8.0e+07
 sigma_tot[gemm] counter=9 i=0 t=6.8e-04 per=1.0e+01 cost=2.2e+04 flops=3.1e+07
 sigma_tot[gemm] counter=9 i=1 t=6.7e-04 per=9.9e+00 cost=2.1e+04 flops=3.1e+07
 sigma_tot[gemm] counter=9 i=2 t=8.8e-04 per=1.3e+01 cost=4.1e+04 flops=4.6e+07
 sigma_tot[gemm] counter=9 i=3 t=8.8e-04 per=1.3e+01 cost=4.0e+04 flops=4.6e+07
 sigma_tot[gemm] counter=9 i=4 t=8.3e-04 per=1.2e+01 cost=3.8e+04 flops=4.6e+07
 sigma_tot[gemm] counter=9 i=5 t=8.2e-04 per=1.2e+01 cost=3.8e+04 flops=4.6e+07
 sigma_tot[gemm] counter=9 total t=4.8e-03 per=7.1e+01 cost=2.0e+05 flops=4.2e+07
 sigma_tot[red] counter=9 t=1.2e-03 per=1.8e+01 cost=6.0e+04 flops=5.0e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.5e-05,3.4e-06,1.2e-06,2.0e-07
    4   0 -      -3.230261017453 -1.721e-07  1.871e-04    3     4  2.518e-02 6.296e-03 1.104e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.188e-05,9.260e-05,6.848e-04,1.754e-04,9.801e-04
 ndim=51:3.800e-07GB t[comm(intra)]=2.188e-05 speed=3.474e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.2e-05 t_gemm=6.8e-04 t_reduction=1.8e-04 tot=9.5e-04 ---
 sigma[inter] counter=10 t=9.2e-05 per=9.7e+00 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=10 i=0 t=9.0e-05 per=9.4e+00 cost=4.2e+03 flops=4.7e+07
 sigma[gemm] counter=10 i=1 t=8.7e-05 per=9.1e+00 cost=4.1e+03 flops=4.7e+07
 sigma[gemm] counter=10 i=2 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.5e+07
 sigma[gemm] counter=10 i=3 t=1.4e-04 per=1.4e+01 cost=8.0e+03 flops=5.8e+07
 sigma[gemm] counter=10 i=4 t=1.2e-04 per=1.3e+01 cost=8.3e+03 flops=6.7e+07
 sigma[gemm] counter=10 i=5 t=1.2e-04 per=1.3e+01 cost=8.3e+03 flops=6.8e+07
 sigma[gemm] counter=10 total t=6.8e-04 per=7.2e+01 cost=4.1e+04 flops=6.0e+07
 sigma[red] counter=10 t=1.8e-04 per=1.8e+01 cost=1.2e+04 flops=6.6e+07
--- TIMING FOR sigma_tot : t_inter=8.9e-04 t_gemm=5.5e-03 t_reduction=1.4e-03 tot=7.7e-03 ---
 sigma_tot[inter] counter=10 t=8.9e-04 per=1.2e+01 cost=7.5e+04 flops=8.5e+07
 sigma_tot[gemm] counter=10 i=0 t=7.7e-04 per=1.0e+01 cost=2.6e+04 flops=3.3e+07
 sigma_tot[gemm] counter=10 i=1 t=7.6e-04 per=9.8e+00 cost=2.5e+04 flops=3.3e+07
 sigma_tot[gemm] counter=10 i=2 t=1.0e-03 per=1.3e+01 cost=4.9e+04 flops=4.8e+07
 sigma_tot[gemm] counter=10 i=3 t=1.0e-03 per=1.3e+01 cost=4.8e+04 flops=4.8e+07
 sigma_tot[gemm] counter=10 i=4 t=9.6e-04 per=1.2e+01 cost=4.6e+04 flops=4.8e+07
 sigma_tot[gemm] counter=10 i=5 t=9.4e-04 per=1.2e+01 cost=4.6e+04 flops=4.9e+07
 sigma_tot[gemm] counter=10 total t=5.5e-03 per=7.1e+01 cost=2.4e+05 flops=4.4e+07
 sigma_tot[red] counter=10 t=1.4e-03 per=1.8e+01 cost=7.2e+04 flops=5.2e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.6e-05,3.3e-06,1.2e-06,2.3e-07
    5   0 +      -3.230261043851 -2.640e-08  9.459e-05    3     5  3.427e-02 6.853e-03 1.108e-03
TIMING FOR Davidson : 3.428e-02  T(cal/comm/rest)=5.540e-03,6.150e-07,2.874e-02
decomposed t_rest=2.874e-02
 T(sub)    =1.054e-04 per=3.668e-01
 T(precond)=2.850e-02 per=9.918e+01
 T(ortho)  =1.194e-05 per=4.154e-02
 T(xcopy)  =9.920e-07 per=3.452e-03
 T(xnrm2)  =2.343e-06 per=8.153e-03
 T(other)  =1.147e-04 per=3.990e-01
optimized energies: isweep=1 ibond=1 dots=1 e[0]=-3.230261043851 nmvp=5
CPUmem: VM:1.929e+01GB RSS:1.844e+00GB  Timing: User:1.679e+02S Sys:1.351e+00S Total:1.692e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=10 nqr=15 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep1_ibond1.txt
 qbond: qsuper nsym=15 dimAll=40
 (2,0):5 (4,0):6 (3,1):6 (3,-1):6 (1,1):1 (2,2):2 (1,-1):1 (2,-2):2 (6,0):1 (5,1):2 (5,-1):2 (4,2):2 (4,-2):2 (3,3):1 (3,-3):1
timing for divide=1.2e-05
timing for compute=7.7e-05
timing for collect=1.2e-05
----- TMING FOR decimation_genbasis(nkr): 1.0e-04 S T(divide/compute/collect)=1.2e-05,7.7e-05,1.2e-05 -----
decimation summary: 40->10 dwt=-2.220e-16 SvN=1.333e+00
 qbond: qkept nsym=6 dimAll=10
 (3,1):3 (3,-1):3 (2,0):1 (4,0):1 (2,-2):1 (4,-2):1
----- TIMING for decimation_row(nkr): 5.153e-04 S T(decim/select/formRot)=2.079e-04,2.776e-04,2.974e-05 -----
----- TIMING FOR onedot_decimation: 6.377e-04 S T(wf/decim)=1.069e-04,5.308e-04 -----
ctns::oper_renorm coord=(2,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:6 S:6 H:1 A:15 B:21 
        dim(bra,ket)=10,10 size(op)=22:1.678e-04MB size(tot)=517:3.944e-03MB:3.852e-06GB
CPUmem: VM:1.929e+01GB RSS:1.844e+00GB  Timing: User:1.680e+02S Sys:1.351e+00S Total:1.694e+02S
----- TIMING FOR symbolic_formulae_renorm with size=49 : 1.323e-03 S -----
rank=0 GPUmem(GB): used=8.75e-06 (oper)=7.46e-06
rank=0 GPUmem(GB): used=9.13e-06 (oper,site)(GB)=7.46e-06,3.8e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=49
 no. of rintermediate operators=24
 no. of coefficients=48:0.000366MB:3.58e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.959e-05 S -----
rank=0 GPUmem(GB): used=9.49e-06 (oper,site,rinter)=7.46e-06,3.8e-07,3.58e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00224 S size(rtasks)=49 size(Rlst2)=36 T(Rmu/Rlist)=0.00047,0.00177 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0024 S size(rtasks)=49 size(Rlst)=1538 -----
rank=0 GPUmem(GB): used=9.49e-06 (oper,site,rinter,batch)=7.46e-06,3.8e-07,3.58e-07,0.000252 blksize=9 blksize0=3 batchsize=1538
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.99e-05,0.000505,0.000167
--- TIMING FOR renorm : t_inter=7.9e-05 t_gemm=5.0e-04 t_reduction=1.7e-04 tot=7.5e-04 ---
 renorm[inter] counter=2 t=7.9e-05 per=1.1e+01 cost=1.2e+03 flops=1.6e+07
 renorm[gemm] counter=2 i=0 t=8.2e-05 per=1.1e+01 cost=4.3e+03 flops=5.2e+07
 renorm[gemm] counter=2 i=1 t=7.0e-05 per=9.4e+00 cost=2.9e+03 flops=4.2e+07
 renorm[gemm] counter=2 i=2 t=1.1e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=3 t=1.1e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=4 t=1.1e-04 per=1.5e+01 cost=5.2e+03 flops=4.7e+07
 renorm[gemm] counter=2 i=5 t=1.1e-04 per=1.5e+01 cost=8.6e+03 flops=7.8e+07
 renorm[gemm] counter=2 i=6 t=1.3e-04 per=1.7e+01 cost=1.7e+04 flops=1.3e+08
 renorm[gemm] counter=2 total t=5.0e-04 per=6.7e+01 cost=3.8e+04 flops=7.6e+07
 renorm[red] counter=2 t=1.7e-04 per=2.2e+01 cost=1.1e+04 flops=6.8e+07
--- TIMING FOR renorm_tot : t_inter=8.8e-05 t_gemm=8.2e-04 t_reduction=2.8e-04 tot=1.2e-03 ---
 renorm_tot[inter] counter=2 t=8.8e-05 per=7.5e+00 cost=1.2e+03 flops=1.4e+07
 renorm_tot[gemm] counter=2 i=0 t=1.5e-04 per=1.3e+01 cost=4.9e+03 flops=3.2e+07
 renorm_tot[gemm] counter=2 i=1 t=1.3e-04 per=1.1e+01 cost=4.0e+03 flops=3.1e+07
 renorm_tot[gemm] counter=2 i=2 t=2.3e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=3 t=2.1e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=4 t=1.6e-04 per=1.4e+01 cost=6.1e+03 flops=3.7e+07
 renorm_tot[gemm] counter=2 i=5 t=1.6e-04 per=1.4e+01 cost=9.3e+03 flops=5.7e+07
 renorm_tot[gemm] counter=2 i=6 t=2.0e-04 per=1.7e+01 cost=2.1e+04 flops=1.0e+08
 renorm_tot[gemm] counter=2 total t=8.2e-04 per=6.9e+01 cost=4.5e+04 flops=5.5e+07
 renorm_tot[red] counter=2 t=2.8e-04 per=2.3e+01 cost=1.5e+04 flops=5.3e+07
qops.to_cpu: size(tot)=517:3.9e-03MB:3.9e-06GB t[to_cpu]=1.4e-05S speed=2.8e-01GB/S
check ||H-H.dagger||=5.527e-16 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=lc ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 0.314 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.000374,7.55e-06,0.132,0.182,0.00012,3.49e-05 -----
----- TIMING FOR oper_renorm : 0.0162 S rank=0 -----
CPUmem: VM:1.929e+01GB RSS:1.844e+00GB  Timing: User:2.029e+02S Sys:1.372e+00S Total:2.043e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=156:1.190e-03MB:1.162e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=51:3.891e-04MB:3.800e-07GB
total mem of comb=250:1.907e-03MB:1.863e-06GB
CPUmem: VM:1.929e+01GB RSS:1.844e+00GB  Timing: User:2.029e+02S Sys:1.373e+00S Total:2.043e+02S
##### local opt: 3.838e-01 S #####
 T(local opt: fetch) = 1.658e-04 S  per = 0.0432  per(accum) = 0.0432
 T(local opt: hdiag) = 4.479e-04 S  per = 0.117  per(accum) = 0.16
 T(local opt: dvdsn) = 5.116e-02 S  per = 13.3  per(accum) = 13.5
 T(local opt: decim) = 6.471e-04 S  per = 0.169  per(accum) = 13.7
 T(local opt: guess) = 1.536e-04 S  per = 0.04  per(accum) = 13.7
 T(local opt: renrm) = 3.310e-01 S  per = 86.2  per(accum) = 99.9
 T(local opt: save ) = 2.346e-04 S  per = 0.0611  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.116e-02 S  T(sum) = 5.094e-02 S  per = 9.956e+01
 T(local opt: preprocess                  ) = 3.351e-04 S  per = 0.658  per(accum) = 0.658
 T(local opt: symbolic_formulae           ) = 1.472e-03 S  per = 2.89  per(accum) = 3.55
 T(local opt: hintermediate init          ) = 8.231e-05 S  per = 0.162  per(accum) = 3.71
 T(local opt: preprocess_hformulae_Hxlist ) = 2.626e-03 S  per = 5.16  per(accum) = 8.86
 T(local opt: hmmtasks init               ) = 1.214e-02 S  per = 23.8  per(accum) = 32.7
 T(local opt: initial guess for dvdson    ) = 3.080e-06 S  per = 0.00605  per(accum) = 32.7
 T(local opt: dvdson solver [Hx_batchGPU] ) = 5.429e-03 S  per = 10.7  per(accum) = 43.4
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.117e-04 S  per = 0.219  per(accum) = 43.6
 T(local opt: dvdson solver [comm(cpu)]   ) = 6.150e-07 S  per = 0.00121  per(accum) = 43.6
 T(local opt: dvdson solver [rest part]   ) = 2.874e-02 S  per = 56.4  per(accum) = 100
Detailed decomposition of T(renrm) = 3.310e-01 S  T(sum) = 3.310e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.263e-04 S  per = 0.0382  per(accum) = 0.0382
 T(local opt: qops init                    ) = 7.406e-04 S  per = 0.224  per(accum) = 0.262
 T(local opt: symbolic_formulae_renorm     ) = 1.332e-03 S  per = 0.403  per(accum) = 0.665
 T(local opt: allocate qops on gpu         ) = 2.573e-05 S  per = 0.00777  per(accum) = 0.672
 T(local opt: site memcpy cpu2gpu          ) = 2.018e-05 S  per = 0.0061  per(accum) = 0.678
 T(local opt: rintermediate init           ) = 7.019e-05 S  per = 0.0212  per(accum) = 0.7
 T(local opt: preprocess_formulae_Rlist2   ) = 2.454e-03 S  per = 0.741  per(accum) = 1.44
 T(local opt: rmmtasks init                ) = 1.064e-02 S  per = 3.21  per(accum) = 4.66
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 9.97e-06  per(accum) = 4.66
 T(local opt: preprocess_renorm_batchGPU   ) = 8.512e-04 S  per = 0.257  per(accum) = 4.91
 T(local opt: reduction of opS & opH [nccl]) = 1.031e-06 S  per = 0.000312  per(accum) = 4.91
 T(local opt: qops memcpy gpu2cpu          ) = 1.970e-05 S  per = 0.00595  per(accum) = 4.92
 T(local opt: deallocate cpu and gpu memory) = 1.018e-05 S  per = 0.00307  per(accum) = 4.92
 T(local opt: reduction of opS & opH [comm]) = 2.309e-05 S  per = 0.00698  per(accum) = 4.93
 T(local opt: conversion from opAB to opPQ ) = 3.142e-01 S  per =   95  per(accum) = 99.9
 T(local opt: after oper_renorm            ) = 3.977e-04 S  per = 0.12  per(accum) = 100
##### sweep opt: 4.345e-01 S #####
 T(sweep opt: fetch) = 1.410e-03 S  per = 0.325  per(accum) = 0.325
 T(sweep opt: hdiag) = 7.284e-04 S  per = 0.168  per(accum) = 0.492
 T(sweep opt: dvdsn) = 9.190e-02 S  per = 21.2  per(accum) = 21.6
 T(sweep opt: decim) = 1.235e-03 S  per = 0.284  per(accum) = 21.9
 T(sweep opt: guess) = 2.807e-04 S  per = 0.0646  per(accum) = 22
 T(sweep opt: renrm) = 3.384e-01 S  per = 77.9  per(accum) = 99.9
 T(sweep opt: save ) = 4.927e-04 S  per = 0.113  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.190e-02 S  T(sum) = 9.146e-02 S  per = 9.952e+01
 T(sweep opt: preprocess                  ) = 5.692e-04 S  per = 0.622  per(accum) = 0.622
 T(sweep opt: symbolic_formulae           ) = 2.324e-03 S  per = 2.54  per(accum) = 3.16
 T(sweep opt: hintermediate init          ) = 1.383e-04 S  per = 0.151  per(accum) = 3.31
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.713e-03 S  per = 4.06  per(accum) = 7.37
 T(sweep opt: hmmtasks init               ) = 1.676e-02 S  per = 18.3  per(accum) = 25.7
 T(sweep opt: initial guess for dvdson    ) = 5.810e-06 S  per = 0.00635  per(accum) = 25.7
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 9.130e-03 S  per = 9.98  per(accum) = 35.7
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.236e-04 S  per = 0.244  per(accum) = 35.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.221e-06 S  per = 0.00134  per(accum) = 35.9
 T(sweep opt: dvdson solver [rest part]   ) = 5.859e-02 S  per = 64.1  per(accum) = 100
Detailed decomposition of T(renrm) = 3.384e-01 S  T(sum) = 3.384e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.222e-04 S  per = 0.0657  per(accum) = 0.0657
 T(sweep opt: qops init                    ) = 1.374e-03 S  per = 0.406  per(accum) = 0.472
 T(sweep opt: symbolic_formulae_renorm     ) = 2.025e-03 S  per = 0.598  per(accum) = 1.07
 T(sweep opt: allocate qops on gpu         ) = 4.782e-05 S  per = 0.0141  per(accum) = 1.08
 T(sweep opt: site memcpy cpu2gpu          ) = 3.980e-05 S  per = 0.0118  per(accum) = 1.1
 T(sweep opt: rintermediate init           ) = 9.278e-05 S  per = 0.0274  per(accum) = 1.12
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.655e-03 S  per = 1.08  per(accum) = 2.2
 T(sweep opt: rmmtasks init                ) = 1.463e-02 S  per = 4.32  per(accum) = 6.53
 T(sweep opt: qops memset on cpu           ) = 8.000e-08 S  per = 2.36e-05  per(accum) = 6.53
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.390e-03 S  per = 0.411  per(accum) = 6.94
 T(sweep opt: reduction of opS & opH [nccl]) = 2.009e-06 S  per = 0.000594  per(accum) = 6.94
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.917e-05 S  per = 0.0116  per(accum) = 6.95
 T(sweep opt: deallocate cpu and gpu memory) = 2.070e-05 S  per = 0.00612  per(accum) = 6.96
 T(sweep opt: reduction of opS & opH [comm]) = 4.904e-05 S  per = 0.0145  per(accum) = 6.97
 T(sweep opt: conversion from opAB to opPQ ) = 3.143e-01 S  per = 92.9  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 5.662e-04 S  per = 0.167  per(accum) = 100
##### global opt: 1.998e+00 S #####
 T(global opt: fetch) = 6.315e-03 S  per = 0.316  per(accum) = 0.316
 T(global opt: hdiag) = 6.586e-03 S  per = 0.33  per(accum) = 0.646
 T(global opt: dvdsn) = 1.100e+00 S  per = 55.1  per(accum) = 55.7
 T(global opt: decim) = 6.420e-03 S  per = 0.321  per(accum) = 56
 T(global opt: guess) = 2.121e-03 S  per = 0.106  per(accum) = 56.1
 T(global opt: renrm) = 8.735e-01 S  per = 43.7  per(accum) = 99.9
 T(global opt: save ) = 2.728e-03 S  per = 0.137  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.100e+00 S  T(sum) = 1.098e+00 S  per = 9.980e+01
 T(global opt: preprocess                  ) = 5.405e-03 S  per = 0.492  per(accum) = 0.492
 T(global opt: symbolic_formulae           ) = 1.736e-02 S  per = 1.58  per(accum) = 2.07
 T(global opt: hintermediate init          ) = 7.969e-04 S  per = 0.0726  per(accum) = 2.15
 T(global opt: preprocess_hformulae_Hxlist ) = 9.267e-02 S  per = 8.44  per(accum) = 10.6
 T(global opt: hmmtasks init               ) = 4.893e-01 S  per = 44.6  per(accum) = 55.1
 T(global opt: initial guess for dvdson    ) = 1.468e-03 S  per = 0.134  per(accum) = 55.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.158e-01 S  per = 10.5  per(accum) = 65.8
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.340e-03 S  per = 0.122  per(accum) = 65.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 6.866e-06 S  per = 0.000625  per(accum) = 65.9
 T(global opt: dvdson solver [rest part]   ) = 3.741e-01 S  per = 34.1  per(accum) = 100
Detailed decomposition of T(renrm) = 8.735e-01 S  T(sum) = 8.735e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.260e-04 S  per = 0.0946  per(accum) = 0.0946
 T(global opt: qops init                    ) = 4.540e-03 S  per = 0.52  per(accum) = 0.614
 T(global opt: symbolic_formulae_renorm     ) = 8.313e-03 S  per = 0.952  per(accum) = 1.57
 T(global opt: allocate qops on gpu         ) = 1.869e-04 S  per = 0.0214  per(accum) = 1.59
 T(global opt: site memcpy cpu2gpu          ) = 1.724e-04 S  per = 0.0197  per(accum) = 1.61
 T(global opt: rintermediate init           ) = 5.968e-04 S  per = 0.0683  per(accum) = 1.68
 T(global opt: preprocess_formulae_Rlist2   ) = 1.415e-02 S  per = 1.62  per(accum) = 3.3
 T(global opt: rmmtasks init                ) = 5.665e-02 S  per = 6.49  per(accum) = 9.78
 T(global opt: qops memset on cpu           ) = 3.530e-07 S  per = 4.04e-05  per(accum) = 9.78
 T(global opt: preprocess_renorm_batchGPU   ) = 6.492e-03 S  per = 0.743  per(accum) = 10.5
 T(global opt: reduction of opS & opH [nccl]) = 8.551e-06 S  per = 0.000979  per(accum) = 10.5
 T(global opt: qops memcpy gpu2cpu          ) = 1.591e-04 S  per = 0.0182  per(accum) = 10.5
 T(global opt: deallocate cpu and gpu memory) = 8.688e-05 S  per = 0.00995  per(accum) = 10.6
 T(global opt: reduction of opS & opH [comm]) = 1.984e-04 S  per = 0.0227  per(accum) = 10.6
 T(global opt: conversion from opAB to opPQ ) = 7.790e-01 S  per = 89.2  per(accum) = 99.8
 T(global opt: after oper_renorm            ) = 2.158e-03 S  per = 0.247  per(accum) = 100

isweep=1 ibond=2/seqsize=6 dots=1 dbond=(3,0)-(4,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.929e+01GB RSS:1.844e+00GB  Timing: User:2.030e+02S Sys:1.373e+00S Total:2.044e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=156:1.190e-03MB:1.162e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=51:3.891e-04MB:3.800e-07GB
total mem of comb=250:1.907e-03MB:1.863e-06GB
ctns::topology::check_partition: (sl,sr,sc)=3,2,1
 suppl= 0 1 2
 suppr= 4 5
 suppc= 3
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:6 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=10,10 size(op)=22:1.678e-04MB size(tot)=517:3.944e-03MB:3.852e-06GB
 rqops: oplist=CSHAB nops=C:4 S:8 H:1 A:6 B:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 qops(tot)=1001:7.637e-03MB:7.458e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(3,0) fdel=./scratch/sweep/rop(4,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
wf3(diml,dimr,dimc)=(10,10,4) nnz=51:3.891e-04MB
qtensor3: wf3 own=1 _data=0x4f131c10
qinfo3: wf3 sym=(6,0) dir=1,1,1
 qbond: qrow nsym=6 dimAll=10
 (3,1):3 (3,-1):3 (2,0):1 (4,0):1 (2,-2):1 (4,-2):1
 qbond: qcol nsym=8 dimAll=10
 (2,0):3 (1,1):1 (1,-1):1 (4,0):1 (3,1):1 (3,-1):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=19 nblocks=192 size=51:3.891e-04MB
### DIAG TIMING: total=4.227e-04 t1=1.066e-05, t2=2.741e-05, t3=4.456e-05, t4=2.984e-04, t5=1.885e-05, t6=1.906e-05, t7=3.771e-06
duration_diagGPU:4.343e-04
duration_diagreduce:5.100e-08
duration_diagtransform:5.460e-07
----- TIMING FOR symbolic_formulae_onedot with size=137 : 1.528e-03 S -----
rank=0 GPUmem(GB): used=7.46e-06 (oper)=7.46e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=137
 no. of hintermediate operators=58
 no. of coefficients=174:0.00133MB:1.3e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.703e-05 S -----
rank=0 GPUmem(GB): used=8.75e-06 (oper,hinter)=7.46e-06,1.3e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00268 S size(H_formulae)=137 size(Hxlst2)=19 T(Hmu/Hxlist)=0.000354,0.00233 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00287 S size(H_formulae)=137 size(Hxlst)=1962 -----
rank=0 GPUmem(GB): used=0.000331 (oper,hinter,dvdson,batch)=7.46e-06,1.3e-06,7.6e-07,0.000322 blksize=9 blksize0=3 batchsize=1962
ctns::pdvdsonSolver_nkr::solve_iter ndim=51 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.35e-05,0.000102,0.000651,0.000182,0.000967
 ndim=51:3.8e-07GB t[comm(intra)]=2.35e-05 speed=0.0323GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=6.5e-04 t_reduction=1.8e-04 tot=9.3e-04 ---
 sigma[inter] counter=11 t=1.0e-04 per=1.1e+01 cost=1.1e+04 flops=1.1e+08
 sigma[gemm] counter=11 i=0 t=9.0e-05 per=9.7e+00 cost=4.2e+03 flops=4.6e+07
 sigma[gemm] counter=11 i=1 t=8.4e-05 per=9.0e+00 cost=4.1e+03 flops=4.9e+07
 sigma[gemm] counter=11 i=2 t=1.3e-04 per=1.4e+01 cost=8.2e+03 flops=6.1e+07
 sigma[gemm] counter=11 i=3 t=1.3e-04 per=1.3e+01 cost=8.4e+03 flops=6.7e+07
 sigma[gemm] counter=11 i=4 t=1.1e-04 per=1.2e+01 cost=8.0e+03 flops=7.1e+07
 sigma[gemm] counter=11 i=5 t=1.0e-04 per=1.1e+01 cost=8.0e+03 flops=7.7e+07
 sigma[gemm] counter=11 total t=6.5e-04 per=7.0e+01 cost=4.1e+04 flops=6.3e+07
 sigma[red] counter=11 t=1.8e-04 per=1.9e+01 cost=1.2e+04 flops=6.3e+07
--- TIMING FOR sigma_tot : t_inter=9.9e-04 t_gemm=6.1e-03 t_reduction=1.6e-03 tot=8.7e-03 ---
 sigma_tot[inter] counter=11 t=9.9e-04 per=1.1e+01 cost=8.7e+04 flops=8.8e+07
 sigma_tot[gemm] counter=11 i=0 t=8.6e-04 per=1.0e+01 cost=3.0e+04 flops=3.5e+07
 sigma_tot[gemm] counter=11 i=1 t=8.4e-04 per=9.7e+00 cost=2.9e+04 flops=3.5e+07
 sigma_tot[gemm] counter=11 i=2 t=1.1e-03 per=1.3e+01 cost=5.7e+04 flops=5.0e+07
 sigma_tot[gemm] counter=11 i=3 t=1.1e-03 per=1.3e+01 cost=5.7e+04 flops=5.0e+07
 sigma_tot[gemm] counter=11 i=4 t=1.1e-03 per=1.2e+01 cost=5.4e+04 flops=5.1e+07
 sigma_tot[gemm] counter=11 i=5 t=1.0e-03 per=1.2e+01 cost=5.4e+04 flops=5.2e+07
 sigma_tot[gemm] counter=11 total t=6.1e-03 per=7.1e+01 cost=2.8e+05 flops=4.6e+07
 sigma_tot[red] counter=11 t=1.6e-03 per=1.8e+01 cost=8.3e+04 flops=5.3e+07
T(sub)=9.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.2e-06,1.9e-06,6.9e-07,1.8e-07
settings: ndim=51 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.230261043851 -1.003e+03  8.201e-03    1     1  1.098e-03 1.098e-03 1.071e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.264e-05,1.076e-04,6.732e-04,1.765e-04,9.868e-04
 ndim=51:3.800e-07GB t[comm(intra)]=2.264e-05 speed=3.357e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=6.7e-04 t_reduction=1.8e-04 tot=9.6e-04 ---
 sigma[inter] counter=12 t=1.1e-04 per=1.1e+01 cost=1.1e+04 flops=1.1e+08
 sigma[gemm] counter=12 i=0 t=9.1e-05 per=9.5e+00 cost=4.2e+03 flops=4.6e+07
 sigma[gemm] counter=12 i=1 t=8.8e-05 per=9.2e+00 cost=4.1e+03 flops=4.7e+07
 sigma[gemm] counter=12 i=2 t=1.3e-04 per=1.3e+01 cost=8.2e+03 flops=6.5e+07
 sigma[gemm] counter=12 i=3 t=1.3e-04 per=1.3e+01 cost=8.4e+03 flops=6.7e+07
 sigma[gemm] counter=12 i=4 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.5e+07
 sigma[gemm] counter=12 i=5 t=1.2e-04 per=1.2e+01 cost=8.0e+03 flops=6.8e+07
 sigma[gemm] counter=12 total t=6.7e-04 per=7.0e+01 cost=4.1e+04 flops=6.1e+07
 sigma[red] counter=12 t=1.8e-04 per=1.8e+01 cost=1.2e+04 flops=6.5e+07
--- TIMING FOR sigma_tot : t_inter=1.1e-03 t_gemm=6.8e-03 t_reduction=1.7e-03 tot=9.6e-03 ---
 sigma_tot[inter] counter=12 t=1.1e-03 per=1.1e+01 cost=9.8e+04 flops=8.9e+07
 sigma_tot[gemm] counter=12 i=0 t=9.6e-04 per=9.9e+00 cost=3.4e+04 flops=3.6e+07
 sigma_tot[gemm] counter=12 i=1 t=9.3e-04 per=9.7e+00 cost=3.3e+04 flops=3.6e+07
 sigma_tot[gemm] counter=12 i=2 t=1.3e-03 per=1.3e+01 cost=6.5e+04 flops=5.1e+07
 sigma_tot[gemm] counter=12 i=3 t=1.3e-03 per=1.3e+01 cost=6.5e+04 flops=5.1e+07
 sigma_tot[gemm] counter=12 i=4 t=1.2e-03 per=1.2e+01 cost=6.2e+04 flops=5.2e+07
 sigma_tot[gemm] counter=12 i=5 t=1.2e-03 per=1.2e+01 cost=6.2e+04 flops=5.3e+07
 sigma_tot[gemm] counter=12 total t=6.8e-03 per=7.1e+01 cost=3.2e+05 flops=4.8e+07
 sigma_tot[red] counter=12 t=1.7e-03 per=1.8e+01 cost=9.5e+04 flops=5.5e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.2e-05,4.2e-06,1.1e-06,2.7e-07
    2   0 -      -3.230303245175 -4.220e-05  2.979e-03    2     2  6.953e-03 3.477e-03 1.111e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.169e-05,9.775e-05,6.716e-04,1.868e-04,9.829e-04
 ndim=51:3.800e-07GB t[comm(intra)]=2.169e-05 speed=3.503e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.8e-05 t_gemm=6.7e-04 t_reduction=1.9e-04 tot=9.5e-04 ---
 sigma[inter] counter=13 t=9.8e-05 per=1.0e+01 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=13 i=0 t=9.2e-05 per=9.6e+00 cost=4.2e+03 flops=4.6e+07
 sigma[gemm] counter=13 i=1 t=8.7e-05 per=9.1e+00 cost=4.1e+03 flops=4.7e+07
 sigma[gemm] counter=13 i=2 t=1.3e-04 per=1.3e+01 cost=8.2e+03 flops=6.5e+07
 sigma[gemm] counter=13 i=3 t=1.3e-04 per=1.3e+01 cost=8.4e+03 flops=6.6e+07
 sigma[gemm] counter=13 i=4 t=1.2e-04 per=1.2e+01 cost=8.0e+03 flops=6.7e+07
 sigma[gemm] counter=13 i=5 t=1.2e-04 per=1.2e+01 cost=8.0e+03 flops=6.8e+07
 sigma[gemm] counter=13 total t=6.7e-04 per=7.0e+01 cost=4.1e+04 flops=6.1e+07
 sigma[red] counter=13 t=1.9e-04 per=2.0e+01 cost=1.2e+04 flops=6.2e+07
--- TIMING FOR sigma_tot : t_inter=1.2e-03 t_gemm=7.4e-03 t_reduction=1.9e-03 tot=1.1e-02 ---
 sigma_tot[inter] counter=13 t=1.2e-03 per=1.1e+01 cost=1.1e+05 flops=9.2e+07
 sigma_tot[gemm] counter=13 i=0 t=1.0e-03 per=9.9e+00 cost=3.8e+04 flops=3.6e+07
 sigma_tot[gemm] counter=13 i=1 t=1.0e-03 per=9.6e+00 cost=3.8e+04 flops=3.7e+07
 sigma_tot[gemm] counter=13 i=2 t=1.4e-03 per=1.3e+01 cost=7.3e+04 flops=5.3e+07
 sigma_tot[gemm] counter=13 i=3 t=1.4e-03 per=1.3e+01 cost=7.4e+04 flops=5.3e+07
 sigma_tot[gemm] counter=13 i=4 t=1.3e-03 per=1.2e+01 cost=7.0e+04 flops=5.4e+07
 sigma_tot[gemm] counter=13 i=5 t=1.3e-03 per=1.2e+01 cost=7.0e+04 flops=5.5e+07
 sigma_tot[gemm] counter=13 total t=7.4e-03 per=7.1e+01 cost=3.6e+05 flops=4.9e+07
 sigma_tot[red] counter=13 t=1.9e-03 per=1.8e+01 cost=1.1e+05 flops=5.5e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.6e-05,3.4e-06,1.2e-06,2.0e-07
    3   0 -      -3.230309331302 -6.086e-06  8.889e-04    3     3  1.602e-02 5.339e-03 1.116e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.247e-05,9.352e-05,6.729e-04,1.850e-04,9.791e-04
 ndim=51:3.800e-07GB t[comm(intra)]=2.247e-05 speed=3.383e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.3e-05 t_gemm=6.7e-04 t_reduction=1.8e-04 tot=9.5e-04 ---
 sigma[inter] counter=14 t=9.3e-05 per=9.8e+00 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=14 i=0 t=9.1e-05 per=9.5e+00 cost=4.2e+03 flops=4.6e+07
 sigma[gemm] counter=14 i=1 t=8.7e-05 per=9.2e+00 cost=4.1e+03 flops=4.7e+07
 sigma[gemm] counter=14 i=2 t=1.3e-04 per=1.3e+01 cost=8.2e+03 flops=6.5e+07
 sigma[gemm] counter=14 i=3 t=1.3e-04 per=1.3e+01 cost=8.4e+03 flops=6.6e+07
 sigma[gemm] counter=14 i=4 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.6e+07
 sigma[gemm] counter=14 i=5 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.7e+07
 sigma[gemm] counter=14 total t=6.7e-04 per=7.1e+01 cost=4.1e+04 flops=6.1e+07
 sigma[red] counter=14 t=1.8e-04 per=1.9e+01 cost=1.2e+04 flops=6.2e+07
--- TIMING FOR sigma_tot : t_inter=1.3e-03 t_gemm=8.1e-03 t_reduction=2.1e-03 tot=1.2e-02 ---
 sigma_tot[inter] counter=14 t=1.3e-03 per=1.1e+01 cost=1.2e+05 flops=9.4e+07
 sigma_tot[gemm] counter=14 i=0 t=1.1e-03 per=9.9e+00 cost=4.2e+04 flops=3.7e+07
 sigma_tot[gemm] counter=14 i=1 t=1.1e-03 per=9.6e+00 cost=4.2e+04 flops=3.8e+07
 sigma_tot[gemm] counter=14 i=2 t=1.5e-03 per=1.3e+01 cost=8.2e+04 flops=5.4e+07
 sigma_tot[gemm] counter=14 i=3 t=1.5e-03 per=1.3e+01 cost=8.2e+04 flops=5.4e+07
 sigma_tot[gemm] counter=14 i=4 t=1.4e-03 per=1.2e+01 cost=7.8e+04 flops=5.5e+07
 sigma_tot[gemm] counter=14 i=5 t=1.4e-03 per=1.2e+01 cost=7.8e+04 flops=5.6e+07
 sigma_tot[gemm] counter=14 total t=8.1e-03 per=7.1e+01 cost=4.0e+05 flops=5.0e+07
 sigma_tot[red] counter=14 t=2.1e-03 per=1.8e+01 cost=1.2e+05 flops=5.6e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.5e-05,3.4e-06,1.2e-06,2.2e-07
    4   0 -      -3.230309937158 -6.059e-07  3.792e-04    3     4  2.507e-02 6.268e-03 1.118e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.133e-05,9.214e-05,6.791e-04,1.878e-04,9.855e-04
 ndim=51:3.800e-07GB t[comm(intra)]=2.133e-05 speed=3.563e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.2e-05 t_gemm=6.8e-04 t_reduction=1.9e-04 tot=9.6e-04 ---
 sigma[inter] counter=15 t=9.2e-05 per=9.6e+00 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=15 i=0 t=8.9e-05 per=9.3e+00 cost=4.2e+03 flops=4.7e+07
 sigma[gemm] counter=15 i=1 t=8.8e-05 per=9.2e+00 cost=4.1e+03 flops=4.7e+07
 sigma[gemm] counter=15 i=2 t=1.3e-04 per=1.3e+01 cost=8.2e+03 flops=6.4e+07
 sigma[gemm] counter=15 i=3 t=1.3e-04 per=1.3e+01 cost=8.4e+03 flops=6.6e+07
 sigma[gemm] counter=15 i=4 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.6e+07
 sigma[gemm] counter=15 i=5 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.5e+07
 sigma[gemm] counter=15 total t=6.8e-04 per=7.1e+01 cost=4.1e+04 flops=6.0e+07
 sigma[red] counter=15 t=1.9e-04 per=2.0e+01 cost=1.2e+04 flops=6.2e+07
--- TIMING FOR sigma_tot : t_inter=1.4e-03 t_gemm=8.8e-03 t_reduction=2.3e-03 tot=1.2e-02 ---
 sigma_tot[inter] counter=15 t=1.4e-03 per=1.1e+01 cost=1.3e+05 flops=9.6e+07
 sigma_tot[gemm] counter=15 i=0 t=1.2e-03 per=9.8e+00 cost=4.7e+04 flops=3.8e+07
 sigma_tot[gemm] counter=15 i=1 t=1.2e-03 per=9.6e+00 cost=4.6e+04 flops=3.8e+07
 sigma_tot[gemm] counter=15 i=2 t=1.7e-03 per=1.3e+01 cost=9.0e+04 flops=5.4e+07
 sigma_tot[gemm] counter=15 i=3 t=1.6e-03 per=1.3e+01 cost=9.0e+04 flops=5.5e+07
 sigma_tot[gemm] counter=15 i=4 t=1.6e-03 per=1.2e+01 cost=8.6e+04 flops=5.6e+07
 sigma_tot[gemm] counter=15 i=5 t=1.5e-03 per=1.2e+01 cost=8.6e+04 flops=5.6e+07
 sigma_tot[gemm] counter=15 total t=8.8e-03 per=7.1e+01 cost=4.4e+05 flops=5.1e+07
 sigma_tot[red] counter=15 t=2.3e-03 per=1.8e+01 cost=1.3e+05 flops=5.6e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.5e-05,3.3e-06,1.2e-06,2.3e-07
    5   0 -      -3.230310099611 -1.625e-07  2.237e-04    3     5  3.414e-02 6.829e-03 1.120e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.519e-05,1.210e-04,7.081e-04,1.823e-04,1.048e-03
 ndim=51:3.800e-07GB t[comm(intra)]=2.519e-05 speed=3.017e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=7.1e-04 t_reduction=1.8e-04 tot=1.0e-03 ---
 sigma[inter] counter=16 t=1.2e-04 per=1.2e+01 cost=1.1e+04 flops=9.5e+07
 sigma[gemm] counter=16 i=0 t=9.6e-05 per=9.5e+00 cost=4.2e+03 flops=4.3e+07
 sigma[gemm] counter=16 i=1 t=9.2e-05 per=9.1e+00 cost=4.1e+03 flops=4.5e+07
 sigma[gemm] counter=16 i=2 t=1.4e-04 per=1.4e+01 cost=8.2e+03 flops=6.0e+07
 sigma[gemm] counter=16 i=3 t=1.3e-04 per=1.3e+01 cost=8.4e+03 flops=6.5e+07
 sigma[gemm] counter=16 i=4 t=1.3e-04 per=1.3e+01 cost=8.0e+03 flops=6.2e+07
 sigma[gemm] counter=16 i=5 t=1.2e-04 per=1.2e+01 cost=8.0e+03 flops=6.5e+07
 sigma[gemm] counter=16 total t=7.1e-04 per=7.0e+01 cost=4.1e+04 flops=5.8e+07
 sigma[red] counter=16 t=1.8e-04 per=1.8e+01 cost=1.2e+04 flops=6.3e+07
--- TIMING FOR sigma_tot : t_inter=1.5e-03 t_gemm=9.5e-03 t_reduction=2.5e-03 tot=1.3e-02 ---
 sigma_tot[inter] counter=16 t=1.5e-03 per=1.1e+01 cost=1.4e+05 flops=9.6e+07
 sigma_tot[gemm] counter=16 i=0 t=1.3e-03 per=9.8e+00 cost=5.1e+04 flops=3.8e+07
 sigma_tot[gemm] counter=16 i=1 t=1.3e-03 per=9.5e+00 cost=5.0e+04 flops=3.9e+07
 sigma_tot[gemm] counter=16 i=2 t=1.8e-03 per=1.3e+01 cost=9.8e+04 flops=5.5e+07
 sigma_tot[gemm] counter=16 i=3 t=1.8e-03 per=1.3e+01 cost=9.9e+04 flops=5.6e+07
 sigma_tot[gemm] counter=16 i=4 t=1.7e-03 per=1.2e+01 cost=9.4e+04 flops=5.6e+07
 sigma_tot[gemm] counter=16 i=5 t=1.6e-03 per=1.2e+01 cost=9.4e+04 flops=5.7e+07
 sigma_tot[gemm] counter=16 total t=9.5e-03 per=7.1e+01 cost=4.9e+05 flops=5.1e+07
 sigma_tot[red] counter=16 t=2.5e-03 per=1.8e+01 cost=1.4e+05 flops=5.7e+07
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.9e-05,3.7e-06,1.3e-06,2.7e-07
    6   0 -      -3.230310162686 -6.307e-08  1.310e-04    3     6  4.329e-02 7.215e-03 1.134e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.152e-05,1.119e-04,6.934e-04,1.818e-04,1.015e-03
 ndim=51:3.800e-07GB t[comm(intra)]=2.152e-05 speed=3.531e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=6.9e-04 t_reduction=1.8e-04 tot=9.9e-04 ---
 sigma[inter] counter=17 t=1.1e-04 per=1.1e+01 cost=1.1e+04 flops=1.0e+08
 sigma[gemm] counter=17 i=0 t=9.1e-05 per=9.3e+00 cost=4.2e+03 flops=4.6e+07
 sigma[gemm] counter=17 i=1 t=8.9e-05 per=9.0e+00 cost=4.1e+03 flops=4.6e+07
 sigma[gemm] counter=17 i=2 t=1.3e-04 per=1.3e+01 cost=8.2e+03 flops=6.2e+07
 sigma[gemm] counter=17 i=3 t=1.3e-04 per=1.3e+01 cost=8.4e+03 flops=6.5e+07
 sigma[gemm] counter=17 i=4 t=1.3e-04 per=1.3e+01 cost=8.0e+03 flops=6.1e+07
 sigma[gemm] counter=17 i=5 t=1.2e-04 per=1.2e+01 cost=8.0e+03 flops=6.7e+07
 sigma[gemm] counter=17 total t=6.9e-04 per=7.0e+01 cost=4.1e+04 flops=5.9e+07
 sigma[red] counter=17 t=1.8e-04 per=1.8e+01 cost=1.2e+04 flops=6.4e+07
--- TIMING FOR sigma_tot : t_inter=1.6e-03 t_gemm=1.0e-02 t_reduction=2.7e-03 tot=1.4e-02 ---
 sigma_tot[inter] counter=17 t=1.6e-03 per=1.1e+01 cost=1.6e+05 flops=9.6e+07
 sigma_tot[gemm] counter=17 i=0 t=1.4e-03 per=9.8e+00 cost=5.5e+04 flops=3.9e+07
 sigma_tot[gemm] counter=17 i=1 t=1.4e-03 per=9.5e+00 cost=5.4e+04 flops=3.9e+07
 sigma_tot[gemm] counter=17 i=2 t=1.9e-03 per=1.3e+01 cost=1.1e+05 flops=5.5e+07
 sigma_tot[gemm] counter=17 i=3 t=1.9e-03 per=1.3e+01 cost=1.1e+05 flops=5.6e+07
 sigma_tot[gemm] counter=17 i=4 t=1.8e-03 per=1.3e+01 cost=1.0e+05 flops=5.6e+07
 sigma_tot[gemm] counter=17 i=5 t=1.8e-03 per=1.2e+01 cost=1.0e+05 flops=5.8e+07
 sigma_tot[gemm] counter=17 total t=1.0e-02 per=7.1e+01 cost=5.3e+05 flops=5.2e+07
 sigma_tot[red] counter=17 t=2.7e-03 per=1.8e+01 cost=1.5e+05 flops=5.7e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.6e-05,3.3e-06,1.2e-06,2.7e-07
    7   0 +      -3.230310178514 -1.583e-08  5.731e-05    3     7  5.220e-02 7.457e-03 1.137e-03
TIMING FOR Davidson : 5.221e-02  T(cal/comm/rest)=7.961e-03,8.600e-07,4.425e-02
decomposed t_rest=4.425e-02
 T(sub)    =1.566e-04 per=3.540e-01
 T(precond)=4.388e-02 per=9.916e+01
 T(ortho)  =2.918e-05 per=6.594e-02
 T(xcopy)  =8.750e-07 per=1.977e-03
 T(xnrm2)  =3.536e-06 per=7.991e-03
 T(other)  =1.796e-04 per=4.058e-01
optimized energies: isweep=1 ibond=2 dots=1 e[0]=-3.230310178514 nmvp=7
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.090e+02S Sys:1.375e+00S Total:2.104e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=10 nqr=13 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep1_ibond2.txt
 qbond: qsuper nsym=13 dimAll=40
 (3,1):4 (5,1):4 (4,2):3 (4,0):8 (3,-1):5 (5,-1):5 (4,-2):5 (2,0):1 (6,0):1 (2,-2):1 (3,-3):1 (6,-2):1 (5,-3):1
timing for divide=1.3e-05
timing for compute=8.3e-05
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 1.1e-04 S T(divide/compute/collect)=1.3e-05,8.3e-05,1.4e-05 -----
decimation summary: 40->10 dwt=+0.000e+00 SvN=7.727e-01
 qbond: qkept nsym=8 dimAll=10
 (4,0):3 (3,1):1 (5,1):1 (4,2):1 (3,-1):1 (5,-1):1 (4,-2):1 (2,0):1
----- TIMING for decimation_row(nkr): 5.284e-04 S T(decim/select/formRot)=1.832e-04,3.128e-04,3.237e-05 -----
----- TIMING FOR onedot_decimation: 6.400e-04 S T(wf/decim)=9.656e-05,5.435e-04 -----
ctns::oper_renorm coord=(3,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:8 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.092e+02S Sys:1.377e+00S Total:2.106e+02S
----- TIMING FOR symbolic_formulae_renorm with size=29 : 1.167e-03 S -----
rank=0 GPUmem(GB): used=8.75e-06 (oper)=7.46e-06
rank=0 GPUmem(GB): used=9.13e-06 (oper,site)(GB)=7.46e-06,3.8e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=29
 no. of rintermediate operators=58
 no. of coefficients=174:0.00133MB:1.3e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.023e-04 S -----
rank=0 GPUmem(GB): used=1.04e-05 (oper,site,rinter)=7.46e-06,3.8e-07,1.3e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00167 S size(rtasks)=29 size(Rlst2)=64 T(Rmu/Rlist)=0.000356,0.00132 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0018 S size(rtasks)=29 size(Rlst)=1091 -----
rank=0 GPUmem(GB): used=1.04e-05 (oper,site,rinter,batch)=7.46e-06,3.8e-07,1.3e-06,0.000179 blksize=9 blksize0=3 batchsize=1091
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.97e-05,0.000461,0.000172
--- TIMING FOR renorm : t_inter=7.9e-05 t_gemm=4.6e-04 t_reduction=1.7e-04 tot=7.1e-04 ---
 renorm[inter] counter=3 t=7.9e-05 per=1.1e+01 cost=5.7e+03 flops=7.2e+07
 renorm[gemm] counter=3 i=0 t=6.9e-05 per=9.7e+00 cost=2.0e+03 flops=2.8e+07
 renorm[gemm] counter=3 i=1 t=7.1e-05 per=1.0e+01 cost=3.0e+03 flops=4.2e+07
 renorm[gemm] counter=3 i=2 t=1.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=3 t=1.1e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=4 t=1.0e-04 per=1.4e+01 cost=4.1e+03 flops=4.1e+07
 renorm[gemm] counter=3 i=5 t=1.0e-04 per=1.4e+01 cost=5.2e+03 flops=5.2e+07
 renorm[gemm] counter=3 i=6 t=1.2e-04 per=1.6e+01 cost=1.1e+04 flops=9.7e+07
 renorm[gemm] counter=3 total t=4.6e-04 per=6.5e+01 cost=2.5e+04 flops=5.5e+07
 renorm[red] counter=3 t=1.7e-04 per=2.4e+01 cost=5.7e+03 flops=3.3e+07
--- TIMING FOR renorm_tot : t_inter=1.7e-04 t_gemm=1.3e-03 t_reduction=4.5e-04 tot=1.9e-03 ---
 renorm_tot[inter] counter=3 t=1.7e-04 per=8.8e+00 cost=7.0e+03 flops=4.2e+07
 renorm_tot[gemm] counter=3 i=0 t=2.2e-04 per=1.2e+01 cost=6.9e+03 flops=3.1e+07
 renorm_tot[gemm] counter=3 i=1 t=2.0e-04 per=1.1e+01 cost=6.9e+03 flops=3.5e+07
 renorm_tot[gemm] counter=3 i=2 t=3.4e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=3 t=3.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=4 t=2.7e-04 per=1.4e+01 cost=1.0e+04 flops=3.9e+07
 renorm_tot[gemm] counter=3 i=5 t=2.6e-04 per=1.4e+01 cost=1.5e+04 flops=5.5e+07
 renorm_tot[gemm] counter=3 i=6 t=3.2e-04 per=1.7e+01 cost=3.2e+04 flops=1.0e+08
 renorm_tot[gemm] counter=3 total t=1.3e-03 per=6.7e+01 cost=7.1e+04 flops=5.5e+07
 renorm_tot[red] counter=3 t=4.5e-04 per=2.4e+01 cost=2.0e+04 flops=4.6e+07
qops.to_cpu: size(tot)=276:2.1e-03MB:2.1e-06GB t[to_cpu]=1.4e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=7.386e-16 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0122 S rank=0 -----
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.094e+02S Sys:1.378e+00S Total:2.108e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=156:1.190e-03MB:1.162e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=222:1.694e-03MB:1.654e-06GB
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.094e+02S Sys:1.378e+00S Total:2.108e+02S
##### local opt: 8.340e-02 S #####
 T(local opt: fetch) = 1.865e-04 S  per = 0.224  per(accum) = 0.224
 T(local opt: hdiag) = 5.110e-04 S  per = 0.613  per(accum) = 0.836
 T(local opt: dvdsn) = 6.914e-02 S  per = 82.9  per(accum) = 83.7
 T(local opt: decim) = 6.496e-04 S  per = 0.779  per(accum) = 84.5
 T(local opt: guess) = 1.398e-04 S  per = 0.168  per(accum) = 84.7
 T(local opt: renrm) = 1.253e-02 S  per =   15  per(accum) = 99.7
 T(local opt: save ) = 2.425e-04 S  per = 0.291  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.914e-02 S  T(sum) = 6.890e-02 S  per = 9.966e+01
 T(local opt: preprocess                  ) = 3.373e-04 S  per = 0.489  per(accum) = 0.489
 T(local opt: symbolic_formulae           ) = 1.538e-03 S  per = 2.23  per(accum) = 2.72
 T(local opt: hintermediate init          ) = 9.302e-05 S  per = 0.135  per(accum) = 2.86
 T(local opt: preprocess_hformulae_Hxlist ) = 2.938e-03 S  per = 4.26  per(accum) = 7.12
 T(local opt: hmmtasks init               ) = 1.178e-02 S  per = 17.1  per(accum) = 24.2
 T(local opt: initial guess for dvdson    ) = 2.971e-06 S  per = 0.00431  per(accum) = 24.2
 T(local opt: dvdson solver [Hx_batchGPU] ) = 7.802e-03 S  per = 11.3  per(accum) = 35.5
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.584e-04 S  per = 0.23  per(accum) = 35.8
 T(local opt: dvdson solver [comm(cpu)]   ) = 8.600e-07 S  per = 0.00125  per(accum) = 35.8
 T(local opt: dvdson solver [rest part]   ) = 4.425e-02 S  per = 64.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.253e-02 S  T(sum) = 1.253e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.218e-04 S  per = 0.972  per(accum) = 0.972
 T(local opt: qops init                    ) = 6.472e-04 S  per = 5.16  per(accum) = 6.14
 T(local opt: symbolic_formulae_renorm     ) = 1.177e-03 S  per = 9.39  per(accum) = 15.5
 T(local opt: allocate qops on gpu         ) = 2.305e-05 S  per = 0.184  per(accum) = 15.7
 T(local opt: site memcpy cpu2gpu          ) = 1.979e-05 S  per = 0.158  per(accum) = 15.9
 T(local opt: rintermediate init           ) = 1.129e-04 S  per = 0.901  per(accum) = 16.8
 T(local opt: preprocess_formulae_Rlist2   ) = 1.842e-03 S  per = 14.7  per(accum) = 31.5
 T(local opt: rmmtasks init                ) = 7.509e-03 S  per = 59.9  per(accum) = 91.4
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 0.000279  per(accum) = 91.4
 T(local opt: preprocess_renorm_batchGPU   ) = 8.138e-04 S  per = 6.49  per(accum) = 97.9
 T(local opt: reduction of opS & opH [nccl]) = 1.198e-06 S  per = 0.00956  per(accum) = 97.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.950e-05 S  per = 0.156  per(accum) = 98
 T(local opt: deallocate cpu and gpu memory) = 1.111e-05 S  per = 0.0886  per(accum) = 98.1
 T(local opt: reduction of opS & opH [comm]) = 2.637e-05 S  per = 0.21  per(accum) = 98.3
 T(local opt: conversion from opAB to opPQ ) = 3.779e-06 S  per = 0.0302  per(accum) = 98.4
 T(local opt: after oper_renorm            ) = 2.048e-04 S  per = 1.63  per(accum) = 100
##### sweep opt: 5.179e-01 S #####
 T(sweep opt: fetch) = 1.597e-03 S  per = 0.308  per(accum) = 0.308
 T(sweep opt: hdiag) = 1.239e-03 S  per = 0.239  per(accum) = 0.548
 T(sweep opt: dvdsn) = 1.610e-01 S  per = 31.1  per(accum) = 31.6
 T(sweep opt: decim) = 1.885e-03 S  per = 0.364  per(accum) = 32
 T(sweep opt: guess) = 4.205e-04 S  per = 0.0812  per(accum) = 32.1
 T(sweep opt: renrm) = 3.509e-01 S  per = 67.8  per(accum) = 99.9
 T(sweep opt: save ) = 7.352e-04 S  per = 0.142  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.610e-01 S  T(sum) = 1.604e-01 S  per = 9.958e+01
 T(sweep opt: preprocess                  ) = 9.065e-04 S  per = 0.565  per(accum) = 0.565
 T(sweep opt: symbolic_formulae           ) = 3.862e-03 S  per = 2.41  per(accum) = 2.97
 T(sweep opt: hintermediate init          ) = 2.313e-04 S  per = 0.144  per(accum) = 3.12
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.651e-03 S  per = 4.15  per(accum) = 7.27
 T(sweep opt: hmmtasks init               ) = 2.854e-02 S  per = 17.8  per(accum) = 25.1
 T(sweep opt: initial guess for dvdson    ) = 8.781e-06 S  per = 0.00548  per(accum) = 25.1
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.693e-02 S  per = 10.6  per(accum) = 35.6
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 3.820e-04 S  per = 0.238  per(accum) = 35.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.081e-06 S  per = 0.0013  per(accum) = 35.9
 T(sweep opt: dvdson solver [rest part]   ) = 1.028e-01 S  per = 64.1  per(accum) = 100
Detailed decomposition of T(renrm) = 3.509e-01 S  T(sum) = 3.509e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.440e-04 S  per = 0.098  per(accum) = 0.098
 T(sweep opt: qops init                    ) = 2.021e-03 S  per = 0.576  per(accum) = 0.674
 T(sweep opt: symbolic_formulae_renorm     ) = 3.201e-03 S  per = 0.912  per(accum) = 1.59
 T(sweep opt: allocate qops on gpu         ) = 7.087e-05 S  per = 0.0202  per(accum) = 1.61
 T(sweep opt: site memcpy cpu2gpu          ) = 5.959e-05 S  per = 0.017  per(accum) = 1.62
 T(sweep opt: rintermediate init           ) = 2.057e-04 S  per = 0.0586  per(accum) = 1.68
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.497e-03 S  per = 1.57  per(accum) = 3.25
 T(sweep opt: rmmtasks init                ) = 2.214e-02 S  per = 6.31  per(accum) = 9.56
 T(sweep opt: qops memset on cpu           ) = 1.150e-07 S  per = 3.28e-05  per(accum) = 9.56
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.203e-03 S  per = 0.628  per(accum) = 10.2
 T(sweep opt: reduction of opS & opH [nccl]) = 3.207e-06 S  per = 0.000914  per(accum) = 10.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.867e-05 S  per = 0.0167  per(accum) = 10.2
 T(sweep opt: deallocate cpu and gpu memory) = 3.180e-05 S  per = 0.00906  per(accum) = 10.2
 T(sweep opt: reduction of opS & opH [comm]) = 7.540e-05 S  per = 0.0215  per(accum) = 10.2
 T(sweep opt: conversion from opAB to opPQ ) = 3.143e-01 S  per = 89.5  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 7.710e-04 S  per = 0.22  per(accum) = 100
##### global opt: 2.082e+00 S #####
 T(global opt: fetch) = 6.501e-03 S  per = 0.312  per(accum) = 0.312
 T(global opt: hdiag) = 7.097e-03 S  per = 0.341  per(accum) = 0.653
 T(global opt: dvdsn) = 1.170e+00 S  per = 56.2  per(accum) = 56.8
 T(global opt: decim) = 7.069e-03 S  per = 0.34  per(accum) = 57.2
 T(global opt: guess) = 2.261e-03 S  per = 0.109  per(accum) = 57.3
 T(global opt: renrm) = 8.861e-01 S  per = 42.6  per(accum) = 99.9
 T(global opt: save ) = 2.970e-03 S  per = 0.143  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.170e+00 S  T(sum) = 1.167e+00 S  per = 9.979e+01
 T(global opt: preprocess                  ) = 5.742e-03 S  per = 0.492  per(accum) = 0.492
 T(global opt: symbolic_formulae           ) = 1.890e-02 S  per = 1.62  per(accum) = 2.11
 T(global opt: hintermediate init          ) = 8.899e-04 S  per = 0.0762  per(accum) = 2.19
 T(global opt: preprocess_hformulae_Hxlist ) = 9.561e-02 S  per = 8.19  per(accum) = 10.4
 T(global opt: hmmtasks init               ) = 5.011e-01 S  per = 42.9  per(accum) = 53.3
 T(global opt: initial guess for dvdson    ) = 1.471e-03 S  per = 0.126  per(accum) = 53.4
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.236e-01 S  per = 10.6  per(accum) = 64
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.498e-03 S  per = 0.128  per(accum) = 64.2
 T(global opt: dvdson solver [comm(cpu)]   ) = 7.726e-06 S  per = 0.000662  per(accum) = 64.2
 T(global opt: dvdson solver [rest part]   ) = 4.184e-01 S  per = 35.8  per(accum) = 100
Detailed decomposition of T(renrm) = 8.861e-01 S  T(sum) = 8.861e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.478e-04 S  per = 0.107  per(accum) = 0.107
 T(global opt: qops init                    ) = 5.187e-03 S  per = 0.585  per(accum) = 0.692
 T(global opt: symbolic_formulae_renorm     ) = 9.490e-03 S  per = 1.07  per(accum) = 1.76
 T(global opt: allocate qops on gpu         ) = 2.100e-04 S  per = 0.0237  per(accum) = 1.79
 T(global opt: site memcpy cpu2gpu          ) = 1.922e-04 S  per = 0.0217  per(accum) = 1.81
 T(global opt: rintermediate init           ) = 7.098e-04 S  per = 0.0801  per(accum) = 1.89
 T(global opt: preprocess_formulae_Rlist2   ) = 1.599e-02 S  per = 1.81  per(accum) = 3.69
 T(global opt: rmmtasks init                ) = 6.416e-02 S  per = 7.24  per(accum) = 10.9
 T(global opt: qops memset on cpu           ) = 3.880e-07 S  per = 4.38e-05  per(accum) = 10.9
 T(global opt: preprocess_renorm_batchGPU   ) = 7.305e-03 S  per = 0.824  per(accum) = 11.8
 T(global opt: reduction of opS & opH [nccl]) = 9.749e-06 S  per = 0.0011  per(accum) = 11.8
 T(global opt: qops memcpy gpu2cpu          ) = 1.786e-04 S  per = 0.0202  per(accum) = 11.8
 T(global opt: deallocate cpu and gpu memory) = 9.799e-05 S  per = 0.0111  per(accum) = 11.8
 T(global opt: reduction of opS & opH [comm]) = 2.247e-04 S  per = 0.0254  per(accum) = 11.8
 T(global opt: conversion from opAB to opPQ ) = 7.790e-01 S  per = 87.9  per(accum) = 99.7
 T(global opt: after oper_renorm            ) = 2.363e-03 S  per = 0.267  per(accum) = 100

isweep=1 ibond=3/seqsize=6 dots=1 dbond=(3,0)-(4,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.094e+02S Sys:1.378e+00S Total:2.108e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=156:1.190e-03MB:1.162e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=222:1.694e-03MB:1.654e-06GB
ctns::topology::check_partition: (sl,sr,sc)=4,1,1
 suppl= 0 1 2 3
 suppr= 5
 suppc= 4
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:8 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
 rqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 qops(tot)=692:5.280e-03MB:5.156e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(4,0) fdel=./scratch/sweep/lop(3,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
wf3(diml,dimr,dimc)=(10,4,4) nnz=23:1.755e-04MB
qtensor3: wf3 own=1 _data=0x4e9afaf0
qinfo3: wf3 sym=(6,0) dir=1,1,1
 qbond: qrow nsym=8 dimAll=10
 (4,0):3 (3,1):1 (5,1):1 (4,2):1 (3,-1):1 (5,-1):1 (4,-2):1 (2,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=15 nblocks=128 size=23:1.755e-04MB
### DIAG TIMING: total=2.203e-04 t1=2.057e-05, t2=2.454e-05, t3=2.560e-05, t4=1.150e-04, t5=1.776e-05, t6=1.233e-05, t7=4.461e-06
duration_diagGPU:2.311e-04
duration_diagreduce:4.800e-08
duration_diagtransform:4.210e-07
----- TIMING FOR symbolic_formulae_onedot with size=67 : 8.113e-04 S -----
rank=0 GPUmem(GB): used=5.16e-06 (oper)=5.16e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=67
 no. of hintermediate operators=20
 no. of coefficients=80:0.00061MB:5.96e-07GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.777e-05 S -----
rank=0 GPUmem(GB): used=5.75e-06 (oper,hinter)=5.16e-06,5.96e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00098 S size(H_formulae)=67 size(Hxlst2)=15 T(Hmu/Hxlist)=0.000148,0.000831 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00106 S size(H_formulae)=67 size(Hxlst)=870 -----
rank=0 GPUmem(GB): used=7.09e-05 (oper,hinter,dvdson,batch)=5.16e-06,5.96e-07,3.43e-07,6.48e-05 blksize=3 blksize0=3 batchsize=870
ctns::pdvdsonSolver_nkr::solve_iter ndim=23 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.13e-05,7.56e-05,0.000379,9.51e-05,0.000578
 ndim=23:1.71e-07GB t[comm(intra)]=2.13e-05 speed=0.0161GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=7.5e-05 t_gemm=3.8e-04 t_reduction=9.5e-05 tot=5.5e-04 ---
 sigma[inter] counter=18 t=7.5e-05 per=1.4e+01 cost=3.6e+03 flops=4.8e+07
 sigma[gemm] counter=18 i=0 t=6.4e-05 per=1.2e+01 cost=9.5e+02 flops=1.5e+07
 sigma[gemm] counter=18 i=1 t=5.7e-05 per=1.0e+01 cost=9.6e+02 flops=1.7e+07
 sigma[gemm] counter=18 i=2 t=5.4e-05 per=9.8e+00 cost=9.5e+02 flops=1.8e+07
 sigma[gemm] counter=18 i=3 t=5.7e-05 per=1.0e+01 cost=9.6e+02 flops=1.7e+07
 sigma[gemm] counter=18 i=4 t=7.8e-05 per=1.4e+01 cost=1.7e+03 flops=2.2e+07
 sigma[gemm] counter=18 i=5 t=6.9e-05 per=1.3e+01 cost=1.7e+03 flops=2.5e+07
 sigma[gemm] counter=18 total t=3.8e-04 per=6.9e+01 cost=7.3e+03 flops=1.9e+07
 sigma[red] counter=18 t=9.5e-05 per=1.7e+01 cost=2.8e+03 flops=2.9e+07
--- TIMING FOR sigma_tot : t_inter=1.7e-03 t_gemm=1.1e-02 t_reduction=2.7e-03 tot=1.5e-02 ---
 sigma_tot[inter] counter=18 t=1.7e-03 per=1.1e+01 cost=1.6e+05 flops=9.4e+07
 sigma_tot[gemm] counter=18 i=0 t=1.5e-03 per=9.8e+00 cost=5.6e+04 flops=3.8e+07
 sigma_tot[gemm] counter=18 i=1 t=1.4e-03 per=9.5e+00 cost=5.5e+04 flops=3.8e+07
 sigma_tot[gemm] counter=18 i=2 t=2.0e-03 per=1.3e+01 cost=1.1e+05 flops=5.4e+07
 sigma_tot[gemm] counter=18 i=3 t=2.0e-03 per=1.3e+01 cost=1.1e+05 flops=5.5e+07
 sigma_tot[gemm] counter=18 i=4 t=1.9e-03 per=1.3e+01 cost=1.0e+05 flops=5.5e+07
 sigma_tot[gemm] counter=18 i=5 t=1.8e-03 per=1.2e+01 cost=1.0e+05 flops=5.7e+07
 sigma_tot[gemm] counter=18 total t=1.1e-02 per=7.0e+01 cost=5.3e+05 flops=5.0e+07
 sigma_tot[red] counter=18 t=2.7e-03 per=1.8e+01 cost=1.6e+05 flops=5.6e+07
T(sub)=8.9e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,3.9e-06,1.8e-06,6.4e-07,1.6e-07
settings: ndim=23 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.230310178514 -1.003e+03  6.424e-03    1     1  7.043e-04 7.043e-04 6.800e-04
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.277e-05,8.795e-05,4.525e-04,1.009e-04,6.709e-04
 ndim=23:1.714e-07GB t[comm(intra)]=2.277e-05 speed=1.505e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=8.8e-05 t_gemm=4.5e-04 t_reduction=1.0e-04 tot=6.4e-04 ---
 sigma[inter] counter=19 t=8.8e-05 per=1.4e+01 cost=3.6e+03 flops=4.2e+07
 sigma[gemm] counter=19 i=0 t=6.8e-05 per=1.1e+01 cost=9.5e+02 flops=1.4e+07
 sigma[gemm] counter=19 i=1 t=6.9e-05 per=1.1e+01 cost=9.6e+02 flops=1.4e+07
 sigma[gemm] counter=19 i=2 t=6.6e-05 per=1.0e+01 cost=9.5e+02 flops=1.4e+07
 sigma[gemm] counter=19 i=3 t=6.7e-05 per=1.0e+01 cost=9.6e+02 flops=1.4e+07
 sigma[gemm] counter=19 i=4 t=9.9e-05 per=1.5e+01 cost=1.7e+03 flops=1.7e+07
 sigma[gemm] counter=19 i=5 t=8.2e-05 per=1.3e+01 cost=1.7e+03 flops=2.1e+07
 sigma[gemm] counter=19 total t=4.5e-04 per=7.1e+01 cost=7.3e+03 flops=1.6e+07
 sigma[red] counter=19 t=1.0e-04 per=1.6e+01 cost=2.8e+03 flops=2.7e+07
--- TIMING FOR sigma_tot : t_inter=1.8e-03 t_gemm=1.1e-02 t_reduction=2.8e-03 tot=1.6e-02 ---
 sigma_tot[inter] counter=19 t=1.8e-03 per=1.1e+01 cost=1.6e+05 flops=9.2e+07
 sigma_tot[gemm] counter=19 i=0 t=1.5e-03 per=9.9e+00 cost=5.7e+04 flops=3.7e+07
 sigma_tot[gemm] counter=19 i=1 t=1.5e-03 per=9.6e+00 cost=5.6e+04 flops=3.7e+07
 sigma_tot[gemm] counter=19 i=2 t=2.0e-03 per=1.3e+01 cost=1.1e+05 flops=5.3e+07
 sigma_tot[gemm] counter=19 i=3 t=2.0e-03 per=1.3e+01 cost=1.1e+05 flops=5.4e+07
 sigma_tot[gemm] counter=19 i=4 t=2.0e-03 per=1.3e+01 cost=1.1e+05 flops=5.3e+07
 sigma_tot[gemm] counter=19 i=5 t=1.9e-03 per=1.2e+01 cost=1.1e+05 flops=5.5e+07
 sigma_tot[gemm] counter=19 total t=1.1e-02 per=7.0e+01 cost=5.4e+05 flops=4.9e+07
 sigma_tot[red] counter=19 t=2.8e-03 per=1.8e+01 cost=1.6e+05 flops=5.5e+07
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.1e-05,3.2e-06,1.0e-06,2.2e-07
    2   0 -      -3.230338190765 -2.801e-05  1.693e-03    2     2  6.213e-03 3.106e-03 7.401e-04
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.404e-05,1.131e-04,4.626e-04,1.232e-04,7.343e-04
 ndim=23:1.714e-07GB t[comm(intra)]=2.404e-05 speed=1.426e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=4.6e-04 t_reduction=1.2e-04 tot=7.0e-04 ---
 sigma[inter] counter=20 t=1.1e-04 per=1.6e+01 cost=3.6e+03 flops=3.2e+07
 sigma[gemm] counter=20 i=0 t=7.5e-05 per=1.1e+01 cost=9.5e+02 flops=1.3e+07
 sigma[gemm] counter=20 i=1 t=7.2e-05 per=1.0e+01 cost=9.6e+02 flops=1.3e+07
 sigma[gemm] counter=20 i=2 t=6.7e-05 per=9.6e+00 cost=9.5e+02 flops=1.4e+07
 sigma[gemm] counter=20 i=3 t=8.1e-05 per=1.2e+01 cost=9.6e+02 flops=1.2e+07
 sigma[gemm] counter=20 i=4 t=8.4e-05 per=1.2e+01 cost=1.7e+03 flops=2.0e+07
 sigma[gemm] counter=20 i=5 t=8.3e-05 per=1.2e+01 cost=1.7e+03 flops=2.1e+07
 sigma[gemm] counter=20 total t=4.6e-04 per=6.6e+01 cost=7.3e+03 flops=1.6e+07
 sigma[red] counter=20 t=1.2e-04 per=1.8e+01 cost=2.8e+03 flops=2.2e+07
--- TIMING FOR sigma_tot : t_inter=1.9e-03 t_gemm=1.1e-02 t_reduction=3.0e-03 tot=1.6e-02 ---
 sigma_tot[inter] counter=20 t=1.9e-03 per=1.2e+01 cost=1.7e+05 flops=8.8e+07
 sigma_tot[gemm] counter=20 i=0 t=1.6e-03 per=9.9e+00 cost=5.8e+04 flops=3.6e+07
 sigma_tot[gemm] counter=20 i=1 t=1.6e-03 per=9.6e+00 cost=5.7e+04 flops=3.6e+07
 sigma_tot[gemm] counter=20 i=2 t=2.1e-03 per=1.3e+01 cost=1.1e+05 flops=5.2e+07
 sigma_tot[gemm] counter=20 i=3 t=2.1e-03 per=1.3e+01 cost=1.1e+05 flops=5.2e+07
 sigma_tot[gemm] counter=20 i=4 t=2.1e-03 per=1.3e+01 cost=1.1e+05 flops=5.2e+07
 sigma_tot[gemm] counter=20 i=5 t=2.0e-03 per=1.2e+01 cost=1.1e+05 flops=5.4e+07
 sigma_tot[gemm] counter=20 total t=1.1e-02 per=7.0e+01 cost=5.5e+05 flops=4.8e+07
 sigma_tot[red] counter=20 t=3.0e-03 per=1.8e+01 cost=1.6e+05 flops=5.4e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.7e-05,3.6e-06,1.2e-06,2.6e-07
    3   0 -      -3.230340281099 -2.090e-06  6.014e-04    3     3  1.537e-02 5.124e-03 7.907e-04
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.320e-05,8.091e-05,4.336e-04,1.004e-04,6.432e-04
 ndim=23:1.714e-07GB t[comm(intra)]=2.320e-05 speed=1.477e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=8.1e-05 t_gemm=4.3e-04 t_reduction=1.0e-04 tot=6.1e-04 ---
 sigma[inter] counter=21 t=8.1e-05 per=1.3e+01 cost=3.6e+03 flops=4.5e+07
 sigma[gemm] counter=21 i=0 t=6.7e-05 per=1.1e+01 cost=9.5e+02 flops=1.4e+07
 sigma[gemm] counter=21 i=1 t=6.8e-05 per=1.1e+01 cost=9.6e+02 flops=1.4e+07
 sigma[gemm] counter=21 i=2 t=6.5e-05 per=1.1e+01 cost=9.5e+02 flops=1.5e+07
 sigma[gemm] counter=21 i=3 t=6.9e-05 per=1.1e+01 cost=9.6e+02 flops=1.4e+07
 sigma[gemm] counter=21 i=4 t=8.2e-05 per=1.3e+01 cost=1.7e+03 flops=2.1e+07
 sigma[gemm] counter=21 i=5 t=8.1e-05 per=1.3e+01 cost=1.7e+03 flops=2.1e+07
 sigma[gemm] counter=21 total t=4.3e-04 per=7.1e+01 cost=7.3e+03 flops=1.7e+07
 sigma[red] counter=21 t=1.0e-04 per=1.6e+01 cost=2.8e+03 flops=2.8e+07
--- TIMING FOR sigma_tot : t_inter=2.0e-03 t_gemm=1.2e-02 t_reduction=3.1e-03 tot=1.7e-02 ---
 sigma_tot[inter] counter=21 t=2.0e-03 per=1.2e+01 cost=1.7e+05 flops=8.6e+07
 sigma_tot[gemm] counter=21 i=0 t=1.7e-03 per=1.0e+01 cost=5.9e+04 flops=3.5e+07
 sigma_tot[gemm] counter=21 i=1 t=1.6e-03 per=9.7e+00 cost=5.8e+04 flops=3.5e+07
 sigma_tot[gemm] counter=21 i=2 t=2.2e-03 per=1.3e+01 cost=1.1e+05 flops=5.1e+07
 sigma_tot[gemm] counter=21 i=3 t=2.2e-03 per=1.3e+01 cost=1.1e+05 flops=5.1e+07
 sigma_tot[gemm] counter=21 i=4 t=2.2e-03 per=1.3e+01 cost=1.1e+05 flops=5.1e+07
 sigma_tot[gemm] counter=21 i=5 t=2.1e-03 per=1.2e+01 cost=1.1e+05 flops=5.2e+07
 sigma_tot[gemm] counter=21 total t=1.2e-02 per=7.0e+01 cost=5.6e+05 flops=4.7e+07
 sigma_tot[red] counter=21 t=3.1e-03 per=1.8e+01 cost=1.6e+05 flops=5.3e+07
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,1.4e-05,2.9e-06,1.0e-06,2.3e-07
    4   0 -      -3.230340644176 -3.631e-07  1.826e-04    3     4  2.429e-02 6.074e-03 7.874e-04
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.342e-05,7.861e-05,4.316e-04,9.910e-05,6.377e-04
 ndim=23:1.714e-07GB t[comm(intra)]=2.342e-05 speed=1.463e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=7.8e-05 t_gemm=4.3e-04 t_reduction=9.9e-05 tot=6.1e-04 ---
 sigma[inter] counter=22 t=7.8e-05 per=1.3e+01 cost=3.6e+03 flops=4.7e+07
 sigma[gemm] counter=22 i=0 t=6.8e-05 per=1.1e+01 cost=9.5e+02 flops=1.4e+07
 sigma[gemm] counter=22 i=1 t=6.5e-05 per=1.1e+01 cost=9.6e+02 flops=1.5e+07
 sigma[gemm] counter=22 i=2 t=7.2e-05 per=1.2e+01 cost=9.5e+02 flops=1.3e+07
 sigma[gemm] counter=22 i=3 t=6.5e-05 per=1.1e+01 cost=9.6e+02 flops=1.5e+07
 sigma[gemm] counter=22 i=4 t=8.1e-05 per=1.3e+01 cost=1.7e+03 flops=2.1e+07
 sigma[gemm] counter=22 i=5 t=8.0e-05 per=1.3e+01 cost=1.7e+03 flops=2.2e+07
 sigma[gemm] counter=22 total t=4.3e-04 per=7.1e+01 cost=7.3e+03 flops=1.7e+07
 sigma[red] counter=22 t=9.9e-05 per=1.6e+01 cost=2.8e+03 flops=2.8e+07
--- TIMING FOR sigma_tot : t_inter=2.0e-03 t_gemm=1.2e-02 t_reduction=3.2e-03 tot=1.8e-02 ---
 sigma_tot[inter] counter=22 t=2.0e-03 per=1.2e+01 cost=1.7e+05 flops=8.5e+07
 sigma_tot[gemm] counter=22 i=0 t=1.8e-03 per=1.0e+01 cost=6.0e+04 flops=3.4e+07
 sigma_tot[gemm] counter=22 i=1 t=1.7e-03 per=9.7e+00 cost=5.9e+04 flops=3.4e+07
 sigma_tot[gemm] counter=22 i=2 t=2.2e-03 per=1.3e+01 cost=1.1e+05 flops=4.9e+07
 sigma_tot[gemm] counter=22 i=3 t=2.2e-03 per=1.3e+01 cost=1.1e+05 flops=5.0e+07
 sigma_tot[gemm] counter=22 i=4 t=2.2e-03 per=1.3e+01 cost=1.1e+05 flops=5.0e+07
 sigma_tot[gemm] counter=22 i=5 t=2.2e-03 per=1.2e+01 cost=1.1e+05 flops=5.1e+07
 sigma_tot[gemm] counter=22 total t=1.2e-02 per=7.0e+01 cost=5.6e+05 flops=4.6e+07
 sigma_tot[red] counter=22 t=3.2e-03 per=1.8e+01 cost=1.7e+05 flops=5.2e+07
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,1.3e-05,3.0e-06,1.0e-06,2.2e-07
    5   0 +      -3.230340682359 -3.818e-08  7.437e-05    3     5  3.336e-02 6.672e-03 7.847e-04
TIMING FOR Davidson : 3.337e-02  T(cal/comm/rest)=3.924e-03,5.900e-07,2.945e-02
decomposed t_rest=2.945e-02
 T(sub)    =9.487e-05 per=3.222e-01
 T(precond)=2.921e-02 per=9.919e+01
 T(ortho)  =2.103e-05 per=7.140e-02
 T(xcopy)  =7.160e-07 per=2.431e-03
 T(xnrm2)  =2.470e-06 per=8.388e-03
 T(other)  =1.205e-04 per=4.091e-01
optimized energies: isweep=1 ibond=3 dots=1 e[0]=-3.230340682359 nmvp=5
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.130e+02S Sys:1.379e+00S Total:2.144e+02S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=10 nqr=9 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep1_ibond3.txt
 qbond: qsuper nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
timing for divide=1.1e-05
timing for compute=7.2e-05
timing for collect=3.2e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-04 S T(divide/compute/collect)=1.1e-05,7.2e-05,3.2e-05 -----
decimation summary: 16->10 dwt=+0.000e+00 SvN=7.737e-01
 qbond: qkept nsym=8 dimAll=10
 (2,0):3 (1,1):1 (1,-1):1 (4,0):1 (3,1):1 (3,-1):1 (2,2):1 (2,-2):1
----- TIMING for decimation_row(nkr): 4.963e-04 S T(decim/select/formRot)=1.743e-04,2.936e-04,2.850e-05 -----
----- TIMING FOR onedot_decimation: 6.165e-04 S T(wf/decim)=9.093e-05,5.255e-04 -----
ctns::oper_renorm coord=(4,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:4 S:8 H:1 A:6 B:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.132e+02S Sys:1.379e+00S Total:2.146e+02S
----- TIMING FOR symbolic_formulae_renorm with size=29 : 6.483e-04 S -----
rank=0 GPUmem(GB): used=7.81e-06 (oper)=5.16e-06
rank=0 GPUmem(GB): used=7.98e-06 (oper,site)(GB)=5.16e-06,1.71e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=29
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=7.98e-06 (oper,site,rinter)=5.16e-06,1.71e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00114 S size(rtasks)=29 size(Rlst2)=64 T(Rmu/Rlist)=0.000239,0.000897 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00122 S size(rtasks)=29 size(Rlst)=630 -----
rank=0 GPUmem(GB): used=7.98e-06 (oper,site,rinter,batch)=5.16e-06,1.71e-07,0,8.92e-05 blksize=9 blksize0=0 batchsize=630
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.06e-06,0.000321,0.000105
--- TIMING FOR renorm : t_inter=7.8e-06 t_gemm=3.2e-04 t_reduction=1.0e-04 tot=4.3e-04 ---
 renorm[inter] counter=4 t=7.8e-06 per=1.8e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=0 t=7.1e-05 per=1.6e+01 cost=5.5e+02 flops=7.7e+06
 renorm[gemm] counter=4 i=1 t=6.0e-05 per=1.4e+01 cost=1.1e+03 flops=1.8e+07
 renorm[gemm] counter=4 i=2 t=5.4e-05 per=1.2e+01 cost=7.5e+02 flops=1.4e+07
 renorm[gemm] counter=4 i=3 t=5.4e-05 per=1.3e+01 cost=8.8e+02 flops=1.6e+07
 renorm[gemm] counter=4 i=4 t=1.2e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=5 t=1.1e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=6 t=7.8e-05 per=1.8e+01 cost=3.4e+03 flops=4.4e+07
 renorm[gemm] counter=4 total t=3.2e-04 per=7.4e+01 cost=6.7e+03 flops=2.1e+07
 renorm[red] counter=4 t=1.0e-04 per=2.4e+01 cost=3.4e+03 flops=3.3e+07
--- TIMING FOR renorm_tot : t_inter=1.8e-04 t_gemm=1.6e-03 t_reduction=5.5e-04 tot=2.3e-03 ---
 renorm_tot[inter] counter=4 t=1.8e-04 per=7.5e+00 cost=7.0e+03 flops=4.0e+07
 renorm_tot[gemm] counter=4 i=0 t=3.0e-04 per=1.3e+01 cost=7.4e+03 flops=2.5e+07
 renorm_tot[gemm] counter=4 i=1 t=2.6e-04 per=1.1e+01 cost=8.0e+03 flops=3.1e+07
 renorm_tot[gemm] counter=4 i=2 t=5.7e-05 per=2.5e+00 cost=7.5e+02 flops=1.3e+07
 renorm_tot[gemm] counter=4 i=3 t=5.8e-05 per=2.5e+00 cost=8.8e+02 flops=1.5e+07
 renorm_tot[gemm] counter=4 i=4 t=2.7e-04 per=1.1e+01 cost=1.0e+04 flops=3.8e+07
 renorm_tot[gemm] counter=4 i=5 t=2.7e-04 per=1.1e+01 cost=1.5e+04 flops=5.5e+07
 renorm_tot[gemm] counter=4 i=6 t=4.0e-04 per=1.7e+01 cost=3.5e+04 flops=8.9e+07
 renorm_tot[gemm] counter=4 total t=1.6e-03 per=6.9e+01 cost=7.7e+04 flops=4.8e+07
 renorm_tot[red] counter=4 t=5.5e-04 per=2.4e+01 cost=2.4e+04 flops=4.3e+07
qops.to_cpu: size(tot)=276:2.1e-03MB:2.1e-06GB t[to_cpu]=1.4e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=2.297e-16 coord=(4,0) rank=0
ctns::oper_ab2pq coord=(4,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00718 S rank=0 -----
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.134e+02S Sys:1.379e+00S Total:2.148e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=156:1.190e-03MB:1.162e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=51:3.891e-04MB:3.800e-07GB
total mem of comb=250:1.907e-03MB:1.863e-06GB
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.134e+02S Sys:1.379e+00S Total:2.148e+02S
##### local opt: 4.935e-02 S #####
 T(local opt: fetch) = 1.805e-04 S  per = 0.366  per(accum) = 0.366
 T(local opt: hdiag) = 2.867e-04 S  per = 0.581  per(accum) = 0.947
 T(local opt: dvdsn) = 4.040e-02 S  per = 81.9  per(accum) = 82.8
 T(local opt: decim) = 6.262e-04 S  per = 1.27  per(accum) = 84.1
 T(local opt: guess) = 1.403e-04 S  per = 0.284  per(accum) = 84.4
 T(local opt: renrm) = 7.419e-03 S  per =   15  per(accum) = 99.4
 T(local opt: save ) = 2.935e-04 S  per = 0.595  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.040e-02 S  T(sum) = 4.018e-02 S  per = 9.945e+01
 T(local opt: preprocess                  ) = 2.570e-04 S  per = 0.64  per(accum) = 0.64
 T(local opt: symbolic_formulae           ) = 8.219e-04 S  per = 2.05  per(accum) = 2.69
 T(local opt: hintermediate init          ) = 5.138e-05 S  per = 0.128  per(accum) = 2.81
 T(local opt: preprocess_hformulae_Hxlist ) = 1.094e-03 S  per = 2.72  per(accum) = 5.54
 T(local opt: hmmtasks init               ) = 4.581e-03 S  per = 11.4  per(accum) = 16.9
 T(local opt: initial guess for dvdson    ) = 2.652e-06 S  per = 0.0066  per(accum) = 16.9
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.809e-03 S  per = 9.48  per(accum) = 26.4
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.147e-04 S  per = 0.285  per(accum) = 26.7
 T(local opt: dvdson solver [comm(cpu)]   ) = 5.900e-07 S  per = 0.00147  per(accum) = 26.7
 T(local opt: dvdson solver [rest part]   ) = 2.945e-02 S  per = 73.3  per(accum) = 100
Detailed decomposition of T(renrm) = 7.419e-03 S  T(sum) = 7.419e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.815e-05 S  per = 1.05  per(accum) = 1.05
 T(local opt: qops init                    ) = 6.314e-04 S  per = 8.51  per(accum) = 9.56
 T(local opt: symbolic_formulae_renorm     ) = 6.573e-04 S  per = 8.86  per(accum) = 18.4
 T(local opt: allocate qops on gpu         ) = 2.405e-05 S  per = 0.324  per(accum) = 18.7
 T(local opt: site memcpy cpu2gpu          ) = 2.178e-05 S  per = 0.294  per(accum) = 19
 T(local opt: rintermediate init           ) = 2.236e-05 S  per = 0.301  per(accum) = 19.3
 T(local opt: preprocess_formulae_Rlist2   ) = 1.248e-03 S  per = 16.8  per(accum) = 36.2
 T(local opt: rmmtasks init                ) = 3.975e-03 S  per = 53.6  per(accum) = 89.7
 T(local opt: qops memset on cpu           ) = 6.700e-08 S  per = 0.000903  per(accum) = 89.7
 T(local opt: preprocess_renorm_batchGPU   ) = 5.386e-04 S  per = 7.26  per(accum) = 97
 T(local opt: reduction of opS & opH [nccl]) = 1.130e-06 S  per = 0.0152  per(accum) = 97
 T(local opt: qops memcpy gpu2cpu          ) = 1.966e-05 S  per = 0.265  per(accum) = 97.3
 T(local opt: deallocate cpu and gpu memory) = 1.021e-05 S  per = 0.138  per(accum) = 97.4
 T(local opt: reduction of opS & opH [comm]) = 2.604e-05 S  per = 0.351  per(accum) = 97.8
 T(local opt: conversion from opAB to opPQ ) = 3.783e-06 S  per = 0.051  per(accum) = 97.8
 T(local opt: after oper_renorm            ) = 1.617e-04 S  per = 2.18  per(accum) = 100
##### sweep opt: 5.672e-01 S #####
 T(sweep opt: fetch) = 1.777e-03 S  per = 0.313  per(accum) = 0.313
 T(sweep opt: hdiag) = 1.526e-03 S  per = 0.269  per(accum) = 0.582
 T(sweep opt: dvdsn) = 2.014e-01 S  per = 35.5  per(accum) = 36.1
 T(sweep opt: decim) = 2.511e-03 S  per = 0.443  per(accum) = 36.5
 T(sweep opt: guess) = 5.608e-04 S  per = 0.0989  per(accum) = 36.6
 T(sweep opt: renrm) = 3.584e-01 S  per = 63.2  per(accum) = 99.8
 T(sweep opt: save ) = 1.029e-03 S  per = 0.181  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.014e-01 S  T(sum) = 2.005e-01 S  per = 9.955e+01
 T(sweep opt: preprocess                  ) = 1.163e-03 S  per = 0.58  per(accum) = 0.58
 T(sweep opt: symbolic_formulae           ) = 4.684e-03 S  per = 2.34  per(accum) = 2.92
 T(sweep opt: hintermediate init          ) = 2.827e-04 S  per = 0.141  per(accum) = 3.06
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.745e-03 S  per = 3.86  per(accum) = 6.92
 T(sweep opt: hmmtasks init               ) = 3.312e-02 S  per = 16.5  per(accum) = 23.4
 T(sweep opt: initial guess for dvdson    ) = 1.143e-05 S  per = 0.0057  per(accum) = 23.4
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 2.074e-02 S  per = 10.3  per(accum) = 33.8
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.967e-04 S  per = 0.248  per(accum) = 34
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.671e-06 S  per = 0.00133  per(accum) = 34
 T(sweep opt: dvdson solver [rest part]   ) = 1.323e-01 S  per =   66  per(accum) = 100
Detailed decomposition of T(renrm) = 3.584e-01 S  T(sum) = 3.584e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.222e-04 S  per = 0.118  per(accum) = 0.118
 T(sweep opt: qops init                    ) = 2.653e-03 S  per = 0.74  per(accum) = 0.858
 T(sweep opt: symbolic_formulae_renorm     ) = 3.859e-03 S  per = 1.08  per(accum) = 1.93
 T(sweep opt: allocate qops on gpu         ) = 9.491e-05 S  per = 0.0265  per(accum) = 1.96
 T(sweep opt: site memcpy cpu2gpu          ) = 8.137e-05 S  per = 0.0227  per(accum) = 1.98
 T(sweep opt: rintermediate init           ) = 2.281e-04 S  per = 0.0636  per(accum) = 2.05
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.745e-03 S  per = 1.88  per(accum) = 3.93
 T(sweep opt: rmmtasks init                ) = 2.612e-02 S  per = 7.29  per(accum) = 11.2
 T(sweep opt: qops memset on cpu           ) = 1.820e-07 S  per = 5.08e-05  per(accum) = 11.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.742e-03 S  per = 0.765  per(accum) = 12
 T(sweep opt: reduction of opS & opH [nccl]) = 4.337e-06 S  per = 0.00121  per(accum) = 12
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.834e-05 S  per = 0.0219  per(accum) = 12
 T(sweep opt: deallocate cpu and gpu memory) = 4.202e-05 S  per = 0.0117  per(accum) = 12
 T(sweep opt: reduction of opS & opH [comm]) = 1.014e-04 S  per = 0.0283  per(accum) = 12
 T(sweep opt: conversion from opAB to opPQ ) = 3.143e-01 S  per = 87.7  per(accum) = 99.7
 T(sweep opt: after oper_renorm            ) = 9.328e-04 S  per = 0.26  per(accum) = 100
##### global opt: 2.131e+00 S #####
 T(global opt: fetch) = 6.681e-03 S  per = 0.314  per(accum) = 0.314
 T(global opt: hdiag) = 7.384e-03 S  per = 0.347  per(accum) = 0.66
 T(global opt: dvdsn) = 1.210e+00 S  per = 56.8  per(accum) = 57.4
 T(global opt: decim) = 7.696e-03 S  per = 0.361  per(accum) = 57.8
 T(global opt: guess) = 2.401e-03 S  per = 0.113  per(accum) = 57.9
 T(global opt: renrm) = 8.935e-01 S  per = 41.9  per(accum) = 99.8
 T(global opt: save ) = 3.264e-03 S  per = 0.153  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.210e+00 S  T(sum) = 1.207e+00 S  per = 9.978e+01
 T(global opt: preprocess                  ) = 5.999e-03 S  per = 0.497  per(accum) = 0.497
 T(global opt: symbolic_formulae           ) = 1.972e-02 S  per = 1.63  per(accum) = 2.13
 T(global opt: hintermediate init          ) = 9.413e-04 S  per = 0.078  per(accum) = 2.21
 T(global opt: preprocess_hformulae_Hxlist ) = 9.671e-02 S  per = 8.01  per(accum) = 10.2
 T(global opt: hmmtasks init               ) = 5.056e-01 S  per = 41.9  per(accum) = 52.1
 T(global opt: initial guess for dvdson    ) = 1.474e-03 S  per = 0.122  per(accum) = 52.2
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.274e-01 S  per = 10.6  per(accum) = 62.8
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.613e-03 S  per = 0.134  per(accum) = 62.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 8.316e-06 S  per = 0.000689  per(accum) = 62.9
 T(global opt: dvdson solver [rest part]   ) = 4.478e-01 S  per = 37.1  per(accum) = 100
Detailed decomposition of T(renrm) = 8.935e-01 S  T(sum) = 8.935e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.026e-03 S  per = 0.115  per(accum) = 0.115
 T(global opt: qops init                    ) = 5.819e-03 S  per = 0.651  per(accum) = 0.766
 T(global opt: symbolic_formulae_renorm     ) = 1.015e-02 S  per = 1.14  per(accum) = 1.9
 T(global opt: allocate qops on gpu         ) = 2.340e-04 S  per = 0.0262  per(accum) = 1.93
 T(global opt: site memcpy cpu2gpu          ) = 2.140e-04 S  per = 0.024  per(accum) = 1.95
 T(global opt: rintermediate init           ) = 7.321e-04 S  per = 0.0819  per(accum) = 2.03
 T(global opt: preprocess_formulae_Rlist2   ) = 1.724e-02 S  per = 1.93  per(accum) = 3.96
 T(global opt: rmmtasks init                ) = 6.813e-02 S  per = 7.63  per(accum) = 11.6
 T(global opt: qops memset on cpu           ) = 4.550e-07 S  per = 5.09e-05  per(accum) = 11.6
 T(global opt: preprocess_renorm_batchGPU   ) = 7.844e-03 S  per = 0.878  per(accum) = 12.5
 T(global opt: reduction of opS & opH [nccl]) = 1.088e-05 S  per = 0.00122  per(accum) = 12.5
 T(global opt: qops memcpy gpu2cpu          ) = 1.983e-04 S  per = 0.0222  per(accum) = 12.5
 T(global opt: deallocate cpu and gpu memory) = 1.082e-04 S  per = 0.0121  per(accum) = 12.5
 T(global opt: reduction of opS & opH [comm]) = 2.508e-04 S  per = 0.0281  per(accum) = 12.5
 T(global opt: conversion from opAB to opPQ ) = 7.790e-01 S  per = 87.2  per(accum) = 99.7
 T(global opt: after oper_renorm            ) = 2.524e-03 S  per = 0.283  per(accum) = 100

isweep=1 ibond=4/seqsize=6 dots=1 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.134e+02S Sys:1.379e+00S Total:2.148e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=156:1.190e-03MB:1.162e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=51:3.891e-04MB:3.800e-07GB
total mem of comb=250:1.907e-03MB:1.863e-06GB
ctns::topology::check_partition: (sl,sr,sc)=3,2,1
 suppl= 0 1 2
 suppr= 4 5
 suppc= 3
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:6 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=10,10 size(op)=22:1.678e-04MB size(tot)=517:3.944e-03MB:3.852e-06GB
 rqops: oplist=CSHAB nops=C:4 S:8 H:1 A:6 B:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 qops(tot)=1001:7.637e-03MB:7.458e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
wf3(diml,dimr,dimc)=(10,10,4) nnz=51:3.891e-04MB
qtensor3: wf3 own=1 _data=0x4da30a00
qinfo3: wf3 sym=(6,0) dir=1,1,1
 qbond: qrow nsym=6 dimAll=10
 (3,1):3 (3,-1):3 (2,0):1 (4,0):1 (2,-2):1 (4,-2):1
 qbond: qcol nsym=8 dimAll=10
 (2,0):3 (1,1):1 (1,-1):1 (4,0):1 (3,1):1 (3,-1):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=19 nblocks=192 size=51:3.891e-04MB
### DIAG TIMING: total=3.771e-04 t1=1.388e-05, t2=1.425e-05, t3=2.799e-05, t4=2.839e-04, t5=1.957e-05, t6=1.250e-05, t7=5.009e-06
duration_diagGPU:3.898e-04
duration_diagreduce:4.900e-08
duration_diagtransform:4.870e-07
----- TIMING FOR symbolic_formulae_onedot with size=137 : 1.408e-03 S -----
rank=0 GPUmem(GB): used=7.46e-06 (oper)=7.46e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=137
 no. of hintermediate operators=58
 no. of coefficients=174:0.00133MB:1.3e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.825e-05 S -----
rank=0 GPUmem(GB): used=8.75e-06 (oper,hinter)=7.46e-06,1.3e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00236 S size(H_formulae)=137 size(Hxlst2)=19 T(Hmu/Hxlist)=0.000324,0.00203 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00254 S size(H_formulae)=137 size(Hxlst)=1962 -----
rank=0 GPUmem(GB): used=0.000331 (oper,hinter,dvdson,batch)=7.46e-06,1.3e-06,7.6e-07,0.000322 blksize=9 blksize0=3 batchsize=1962
ctns::pdvdsonSolver_nkr::solve_iter ndim=51 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.13e-05,8.75e-05,0.00053,0.000154,0.0008
 ndim=51:3.8e-07GB t[comm(intra)]=2.13e-05 speed=0.0357GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=8.7e-05 t_gemm=5.3e-04 t_reduction=1.5e-04 tot=7.7e-04 ---
 sigma[inter] counter=23 t=8.7e-05 per=1.1e+01 cost=1.1e+04 flops=1.3e+08
 sigma[gemm] counter=23 i=0 t=7.4e-05 per=9.6e+00 cost=4.2e+03 flops=5.6e+07
 sigma[gemm] counter=23 i=1 t=6.9e-05 per=8.9e+00 cost=4.1e+03 flops=6.0e+07
 sigma[gemm] counter=23 i=2 t=1.0e-04 per=1.3e+01 cost=8.2e+03 flops=8.1e+07
 sigma[gemm] counter=23 i=3 t=9.8e-05 per=1.3e+01 cost=8.4e+03 flops=8.5e+07
 sigma[gemm] counter=23 i=4 t=9.3e-05 per=1.2e+01 cost=8.0e+03 flops=8.6e+07
 sigma[gemm] counter=23 i=5 t=9.3e-05 per=1.2e+01 cost=8.0e+03 flops=8.6e+07
 sigma[gemm] counter=23 total t=5.3e-04 per=6.9e+01 cost=4.1e+04 flops=7.7e+07
 sigma[red] counter=23 t=1.5e-04 per=2.0e+01 cost=1.2e+04 flops=7.5e+07
--- TIMING FOR sigma_tot : t_inter=2.1e-03 t_gemm=1.3e-02 t_reduction=3.3e-03 tot=1.8e-02 ---
 sigma_tot[inter] counter=23 t=2.1e-03 per=1.2e+01 cost=1.9e+05 flops=8.7e+07
 sigma_tot[gemm] counter=23 i=0 t=1.8e-03 per=1.0e+01 cost=6.4e+04 flops=3.5e+07
 sigma_tot[gemm] counter=23 i=1 t=1.8e-03 per=9.7e+00 cost=6.3e+04 flops=3.5e+07
 sigma_tot[gemm] counter=23 i=2 t=2.3e-03 per=1.3e+01 cost=1.2e+05 flops=5.1e+07
 sigma_tot[gemm] counter=23 i=3 t=2.3e-03 per=1.3e+01 cost=1.2e+05 flops=5.1e+07
 sigma_tot[gemm] counter=23 i=4 t=2.3e-03 per=1.3e+01 cost=1.2e+05 flops=5.1e+07
 sigma_tot[gemm] counter=23 i=5 t=2.3e-03 per=1.2e+01 cost=1.2e+05 flops=5.3e+07
 sigma_tot[gemm] counter=23 total t=1.3e-02 per=7.0e+01 cost=6.0e+05 flops=4.7e+07
 sigma_tot[red] counter=23 t=3.3e-03 per=1.8e+01 cost=1.8e+05 flops=5.3e+07
T(sub)=9.2e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,4.1e-06,1.8e-06,6.6e-07,2.1e-07
settings: ndim=51 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.230340682359 -1.003e+03  8.734e-04    1     1  9.275e-04 9.275e-04 9.010e-04
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.282e-05,9.917e-05,6.883e-04,1.738e-04,9.908e-04
 ndim=51:3.800e-07GB t[comm(intra)]=2.282e-05 speed=3.331e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.9e-05 t_gemm=6.9e-04 t_reduction=1.7e-04 tot=9.6e-04 ---
 sigma[inter] counter=24 t=9.9e-05 per=1.0e+01 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=24 i=0 t=9.1e-05 per=9.5e+00 cost=4.2e+03 flops=4.6e+07
 sigma[gemm] counter=24 i=1 t=8.8e-05 per=9.2e+00 cost=4.1e+03 flops=4.6e+07
 sigma[gemm] counter=24 i=2 t=1.4e-04 per=1.5e+01 cost=8.2e+03 flops=5.8e+07
 sigma[gemm] counter=24 i=3 t=1.3e-04 per=1.3e+01 cost=8.4e+03 flops=6.5e+07
 sigma[gemm] counter=24 i=4 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.6e+07
 sigma[gemm] counter=24 i=5 t=1.2e-04 per=1.2e+01 cost=8.0e+03 flops=6.8e+07
 sigma[gemm] counter=24 total t=6.9e-04 per=7.2e+01 cost=4.1e+04 flops=5.9e+07
 sigma[red] counter=24 t=1.7e-04 per=1.8e+01 cost=1.2e+04 flops=6.6e+07
--- TIMING FOR sigma_tot : t_inter=2.2e-03 t_gemm=1.4e-02 t_reduction=3.5e-03 tot=1.9e-02 ---
 sigma_tot[inter] counter=24 t=2.2e-03 per=1.2e+01 cost=2.0e+05 flops=8.8e+07
 sigma_tot[gemm] counter=24 i=0 t=1.9e-03 per=1.0e+01 cost=6.8e+04 flops=3.5e+07
 sigma_tot[gemm] counter=24 i=1 t=1.9e-03 per=9.6e+00 cost=6.7e+04 flops=3.6e+07
 sigma_tot[gemm] counter=24 i=2 t=2.5e-03 per=1.3e+01 cost=1.3e+05 flops=5.1e+07
 sigma_tot[gemm] counter=24 i=3 t=2.5e-03 per=1.3e+01 cost=1.3e+05 flops=5.2e+07
 sigma_tot[gemm] counter=24 i=4 t=2.5e-03 per=1.3e+01 cost=1.3e+05 flops=5.2e+07
 sigma_tot[gemm] counter=24 i=5 t=2.4e-03 per=1.2e+01 cost=1.3e+05 flops=5.3e+07
 sigma_tot[gemm] counter=24 total t=1.4e-02 per=7.0e+01 cost=6.4e+05 flops=4.8e+07
 sigma_tot[red] counter=24 t=3.5e-03 per=1.8e+01 cost=1.9e+05 flops=5.4e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.2e-05,4.1e-06,1.2e-06,2.6e-07
    2   0 -      -3.230341176377 -4.940e-07  2.679e-04    2     2  6.804e-03 3.402e-03 1.020e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.164e-05,9.283e-05,6.838e-04,1.721e-04,9.758e-04
 ndim=51:3.800e-07GB t[comm(intra)]=2.164e-05 speed=3.511e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.3e-05 t_gemm=6.8e-04 t_reduction=1.7e-04 tot=9.5e-04 ---
 sigma[inter] counter=25 t=9.3e-05 per=9.8e+00 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=25 i=0 t=8.8e-05 per=9.3e+00 cost=4.2e+03 flops=4.7e+07
 sigma[gemm] counter=25 i=1 t=8.8e-05 per=9.3e+00 cost=4.1e+03 flops=4.6e+07
 sigma[gemm] counter=25 i=2 t=1.4e-04 per=1.5e+01 cost=8.2e+03 flops=5.9e+07
 sigma[gemm] counter=25 i=3 t=1.3e-04 per=1.3e+01 cost=8.4e+03 flops=6.7e+07
 sigma[gemm] counter=25 i=4 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.7e+07
 sigma[gemm] counter=25 i=5 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.6e+07
 sigma[gemm] counter=25 total t=6.8e-04 per=7.2e+01 cost=4.1e+04 flops=6.0e+07
 sigma[red] counter=25 t=1.7e-04 per=1.8e+01 cost=1.2e+04 flops=6.7e+07
--- TIMING FOR sigma_tot : t_inter=2.3e-03 t_gemm=1.4e-02 t_reduction=3.7e-03 tot=2.0e-02 ---
 sigma_tot[inter] counter=25 t=2.3e-03 per=1.1e+01 cost=2.1e+05 flops=8.9e+07
 sigma_tot[gemm] counter=25 i=0 t=2.0e-03 per=9.9e+00 cost=7.2e+04 flops=3.6e+07
 sigma_tot[gemm] counter=25 i=1 t=1.9e-03 per=9.6e+00 cost=7.1e+04 flops=3.6e+07
 sigma_tot[gemm] counter=25 i=2 t=2.6e-03 per=1.3e+01 cost=1.4e+05 flops=5.2e+07
 sigma_tot[gemm] counter=25 i=3 t=2.6e-03 per=1.3e+01 cost=1.4e+05 flops=5.3e+07
 sigma_tot[gemm] counter=25 i=4 t=2.6e-03 per=1.3e+01 cost=1.3e+05 flops=5.2e+07
 sigma_tot[gemm] counter=25 i=5 t=2.5e-03 per=1.2e+01 cost=1.3e+05 flops=5.4e+07
 sigma_tot[gemm] counter=25 total t=1.4e-02 per=7.0e+01 cost=6.9e+05 flops=4.8e+07
 sigma_tot[red] counter=25 t=3.7e-03 per=1.8e+01 cost=2.0e+05 flops=5.5e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.6e-05,3.2e-06,1.3e-06,2.0e-07
    3   0 -      -3.230341235424 -5.905e-08  1.276e-04    3     3  1.586e-02 5.285e-03 1.053e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.130e-05,9.243e-05,6.791e-04,1.748e-04,9.731e-04
 ndim=51:3.800e-07GB t[comm(intra)]=2.130e-05 speed=3.568e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.2e-05 t_gemm=6.8e-04 t_reduction=1.7e-04 tot=9.4e-04 ---
 sigma[inter] counter=26 t=9.2e-05 per=9.8e+00 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=26 i=0 t=9.2e-05 per=9.8e+00 cost=4.2e+03 flops=4.5e+07
 sigma[gemm] counter=26 i=1 t=9.3e-05 per=9.8e+00 cost=4.1e+03 flops=4.4e+07
 sigma[gemm] counter=26 i=2 t=1.3e-04 per=1.4e+01 cost=8.2e+03 flops=6.4e+07
 sigma[gemm] counter=26 i=3 t=1.3e-04 per=1.3e+01 cost=8.4e+03 flops=6.7e+07
 sigma[gemm] counter=26 i=4 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.7e+07
 sigma[gemm] counter=26 i=5 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.8e+07
 sigma[gemm] counter=26 total t=6.8e-04 per=7.2e+01 cost=4.1e+04 flops=6.0e+07
 sigma[red] counter=26 t=1.7e-04 per=1.8e+01 cost=1.2e+04 flops=6.6e+07
--- TIMING FOR sigma_tot : t_inter=2.4e-03 t_gemm=1.5e-02 t_reduction=3.8e-03 tot=2.1e-02 ---
 sigma_tot[inter] counter=26 t=2.4e-03 per=1.1e+01 cost=2.2e+05 flops=9.1e+07
 sigma_tot[gemm] counter=26 i=0 t=2.1e-03 per=9.9e+00 cost=7.6e+04 flops=3.6e+07
 sigma_tot[gemm] counter=26 i=1 t=2.0e-03 per=9.6e+00 cost=7.5e+04 flops=3.7e+07
 sigma_tot[gemm] counter=26 i=2 t=2.8e-03 per=1.3e+01 cost=1.4e+05 flops=5.2e+07
 sigma_tot[gemm] counter=26 i=3 t=2.7e-03 per=1.3e+01 cost=1.5e+05 flops=5.3e+07
 sigma_tot[gemm] counter=26 i=4 t=2.7e-03 per=1.3e+01 cost=1.4e+05 flops=5.3e+07
 sigma_tot[gemm] counter=26 i=5 t=2.6e-03 per=1.2e+01 cost=1.4e+05 flops=5.5e+07
 sigma_tot[gemm] counter=26 total t=1.5e-02 per=7.0e+01 cost=7.3e+05 flops=4.9e+07
 sigma_tot[red] counter=26 t=3.8e-03 per=1.8e+01 cost=2.1e+05 flops=5.5e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.5e-05,3.4e-06,1.2e-06,1.9e-07
    4   0 +      -3.230341250402 -1.498e-08  6.754e-05    3     4  2.493e-02 6.233e-03 1.070e-03
TIMING FOR Davidson : 2.496e-02  T(cal/comm/rest)=4.279e-03,4.790e-07,2.068e-02
decomposed t_rest=2.068e-02
 T(sub)    =7.829e-05 per=3.786e-01
 T(precond)=2.048e-02 per=9.903e+01
 T(ortho)  =1.076e-05 per=5.204e-02
 T(xcopy)  =7.530e-07 per=3.642e-03
 T(xnrm2)  =1.780e-06 per=8.609e-03
 T(other)  =1.093e-04 per=5.286e-01
optimized energies: isweep=1 ibond=4 dots=1 e[0]=-3.230341250402 nmvp=4
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.161e+02S Sys:1.384e+00S Total:2.175e+02S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=10 nqr=15 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep1_ibond4.txt
 qbond: qsuper nsym=15 dimAll=40
 (2,0):5 (1,1):1 (1,-1):1 (4,0):6 (3,1):6 (3,-1):6 (2,2):2 (2,-2):2 (6,0):1 (5,1):2 (5,-1):2 (4,2):2 (4,-2):2 (3,3):1 (3,-3):1
timing for divide=1.4e-05
timing for compute=8.5e-05
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 1.1e-04 S T(divide/compute/collect)=1.4e-05,8.5e-05,1.4e-05 -----
decimation summary: 40->10 dwt=+1.110e-16 SvN=1.332e+00
 qbond: qkept nsym=6 dimAll=10
 (3,1):3 (3,-1):3 (2,0):1 (4,0):1 (2,2):1 (4,2):1
----- TIMING for decimation_row(nkr): 5.511e-04 S T(decim/select/formRot)=2.111e-04,3.111e-04,2.888e-05 -----
----- TIMING FOR onedot_decimation: 7.222e-04 S T(wf/decim)=1.387e-04,5.835e-04 -----
ctns::oper_renorm coord=(3,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:6 S:6 H:1 A:15 B:21 
        dim(bra,ket)=10,10 size(op)=22:1.678e-04MB size(tot)=517:3.944e-03MB:3.852e-06GB
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.163e+02S Sys:1.384e+00S Total:2.177e+02S
----- TIMING FOR symbolic_formulae_renorm with size=49 : 1.335e-03 S -----
rank=0 GPUmem(GB): used=8.75e-06 (oper)=7.46e-06
rank=0 GPUmem(GB): used=9.13e-06 (oper,site)(GB)=7.46e-06,3.8e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=49
 no. of rintermediate operators=24
 no. of coefficients=48:0.000366MB:3.58e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.992e-05 S -----
rank=0 GPUmem(GB): used=9.49e-06 (oper,site,rinter)=7.46e-06,3.8e-07,3.58e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00225 S size(rtasks)=49 size(Rlst2)=36 T(Rmu/Rlist)=0.00046,0.00179 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00241 S size(rtasks)=49 size(Rlst)=1538 -----
rank=0 GPUmem(GB): used=9.49e-06 (oper,site,rinter,batch)=7.46e-06,3.8e-07,3.58e-07,0.000252 blksize=9 blksize0=3 batchsize=1538
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.21e-05,0.000454,0.000152
--- TIMING FOR renorm : t_inter=8.2e-05 t_gemm=4.5e-04 t_reduction=1.5e-04 tot=6.9e-04 ---
 renorm[inter] counter=5 t=8.2e-05 per=1.2e+01 cost=1.2e+03 flops=1.5e+07
 renorm[gemm] counter=5 i=0 t=7.3e-05 per=1.1e+01 cost=4.0e+03 flops=5.4e+07
 renorm[gemm] counter=5 i=1 t=6.9e-05 per=1.0e+01 cost=3.3e+03 flops=4.7e+07
 renorm[gemm] counter=5 i=2 t=9.4e-05 per=1.4e+01 cost=5.5e+03 flops=5.9e+07
 renorm[gemm] counter=5 i=3 t=1.0e-04 per=1.5e+01 cost=8.2e+03 flops=8.3e+07
 renorm[gemm] counter=5 i=4 t=1.1e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=5 t=1.1e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=6 t=1.2e-04 per=1.7e+01 cost=1.7e+04 flops=1.5e+08
 renorm[gemm] counter=5 total t=4.5e-04 per=6.6e+01 cost=3.8e+04 flops=8.5e+07
 renorm[red] counter=5 t=1.5e-04 per=2.2e+01 cost=1.1e+04 flops=7.5e+07
--- TIMING FOR renorm_tot : t_inter=2.6e-04 t_gemm=2.1e-03 t_reduction=7.0e-04 tot=3.0e-03 ---
 renorm_tot[inter] counter=5 t=2.6e-04 per=8.5e+00 cost=8.2e+03 flops=3.2e+07
 renorm_tot[gemm] counter=5 i=0 t=3.7e-04 per=1.2e+01 cost=1.1e+04 flops=3.1e+07
 renorm_tot[gemm] counter=5 i=1 t=3.3e-04 per=1.1e+01 cost=1.1e+04 flops=3.4e+07
 renorm_tot[gemm] counter=5 i=2 t=1.5e-04 per=5.0e+00 cost=6.3e+03 flops=4.2e+07
 renorm_tot[gemm] counter=5 i=3 t=1.6e-04 per=5.2e+00 cost=9.1e+03 flops=5.8e+07
 renorm_tot[gemm] counter=5 i=4 t=2.7e-04 per=8.9e+00 cost=1.0e+04 flops=3.8e+07
 renorm_tot[gemm] counter=5 i=5 t=2.7e-04 per=8.8e+00 cost=1.5e+04 flops=5.5e+07
 renorm_tot[gemm] counter=5 i=6 t=5.1e-04 per=1.7e+01 cost=5.3e+04 flops=1.0e+08
 renorm_tot[gemm] counter=5 total t=2.1e-03 per=6.8e+01 cost=1.2e+05 flops=5.6e+07
 renorm_tot[red] counter=5 t=7.0e-04 per=2.3e+01 cost=3.5e+04 flops=5.0e+07
qops.to_cpu: size(tot)=517:3.9e-03MB:3.9e-06GB t[to_cpu]=1.4e-05S speed=2.8e-01GB/S
check ||H-H.dagger||=2.212e-16 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=cr ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 0.315 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.000373,7.52e-06,0.132,0.182,0.000137,0.000166 -----
----- TIMING FOR oper_renorm : 0.016 S rank=0 -----
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.512e+02S Sys:1.397e+00S Total:2.526e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=156:1.190e-03MB:1.162e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=51:3.891e-04MB:3.800e-07GB
total mem of comb=250:1.907e-03MB:1.863e-06GB
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.513e+02S Sys:1.397e+00S Total:2.527e+02S
##### local opt: 3.757e-01 S #####
 T(local opt: fetch) = 1.768e-04 S  per = 0.0471  per(accum) = 0.0471
 T(local opt: hdiag) = 4.508e-04 S  per = 0.12  per(accum) = 0.167
 T(local opt: dvdsn) = 4.165e-02 S  per = 11.1  per(accum) = 11.3
 T(local opt: decim) = 7.321e-04 S  per = 0.195  per(accum) = 11.4
 T(local opt: guess) = 1.842e-04 S  per = 0.049  per(accum) = 11.5
 T(local opt: renrm) = 3.321e-01 S  per = 88.4  per(accum) = 99.9
 T(local opt: save ) = 3.462e-04 S  per = 0.0921  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.165e-02 S  T(sum) = 4.137e-02 S  per = 9.934e+01
 T(local opt: preprocess                  ) = 3.339e-04 S  per = 0.807  per(accum) = 0.807
 T(local opt: symbolic_formulae           ) = 1.418e-03 S  per = 3.43  per(accum) = 4.24
 T(local opt: hintermediate init          ) = 8.278e-05 S  per =  0.2  per(accum) = 4.44
 T(local opt: preprocess_hformulae_Hxlist ) = 2.607e-03 S  per =  6.3  per(accum) = 10.7
 T(local opt: hmmtasks init               ) = 1.197e-02 S  per = 28.9  per(accum) = 39.7
 T(local opt: initial guess for dvdson    ) = 2.916e-06 S  per = 0.00705  per(accum) = 39.7
 T(local opt: dvdson solver [Hx_batchGPU] ) = 4.192e-03 S  per = 10.1  per(accum) = 49.8
 T(local opt: dvdson solver [comm(gpu)]   ) = 8.703e-05 S  per = 0.21  per(accum) = 50
 T(local opt: dvdson solver [comm(cpu)]   ) = 4.790e-07 S  per = 0.00116  per(accum) = 50
 T(local opt: dvdson solver [rest part]   ) = 2.068e-02 S  per =   50  per(accum) = 100
Detailed decomposition of T(renrm) = 3.321e-01 S  T(sum) = 3.321e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.278e-04 S  per = 0.0385  per(accum) = 0.0385
 T(local opt: qops init                    ) = 7.193e-04 S  per = 0.217  per(accum) = 0.255
 T(local opt: symbolic_formulae_renorm     ) = 1.344e-03 S  per = 0.405  per(accum) = 0.66
 T(local opt: allocate qops on gpu         ) = 2.949e-05 S  per = 0.00888  per(accum) = 0.669
 T(local opt: site memcpy cpu2gpu          ) = 1.963e-05 S  per = 0.00591  per(accum) = 0.675
 T(local opt: rintermediate init           ) = 7.053e-05 S  per = 0.0212  per(accum) = 0.696
 T(local opt: preprocess_formulae_Rlist2   ) = 2.471e-03 S  per = 0.744  per(accum) = 1.44
 T(local opt: rmmtasks init                ) = 1.055e-02 S  per = 3.18  per(accum) = 4.62
 T(local opt: qops memset on cpu           ) = 3.900e-08 S  per = 1.17e-05  per(accum) = 4.62
 T(local opt: preprocess_renorm_batchGPU   ) = 7.867e-04 S  per = 0.237  per(accum) = 4.85
 T(local opt: reduction of opS & opH [nccl]) = 1.046e-06 S  per = 0.000315  per(accum) = 4.85
 T(local opt: qops memcpy gpu2cpu          ) = 1.958e-05 S  per = 0.0059  per(accum) = 4.86
 T(local opt: deallocate cpu and gpu memory) = 1.033e-05 S  per = 0.00311  per(accum) = 4.86
 T(local opt: reduction of opS & opH [comm]) = 2.346e-05 S  per = 0.00706  per(accum) = 4.87
 T(local opt: conversion from opAB to opPQ ) = 3.149e-01 S  per = 94.8  per(accum) = 99.7
 T(local opt: after oper_renorm            ) = 9.968e-04 S  per =  0.3  per(accum) = 100
##### sweep opt: 9.429e-01 S #####
 T(sweep opt: fetch) = 1.954e-03 S  per = 0.207  per(accum) = 0.207
 T(sweep opt: hdiag) = 1.977e-03 S  per = 0.21  per(accum) = 0.417
 T(sweep opt: dvdsn) = 2.431e-01 S  per = 25.8  per(accum) = 26.2
 T(sweep opt: decim) = 3.243e-03 S  per = 0.344  per(accum) = 26.5
 T(sweep opt: guess) = 7.450e-04 S  per = 0.079  per(accum) = 26.6
 T(sweep opt: renrm) = 6.905e-01 S  per = 73.2  per(accum) = 99.9
 T(sweep opt: save ) = 1.375e-03 S  per = 0.146  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.431e-01 S  T(sum) = 2.419e-01 S  per = 9.952e+01
 T(sweep opt: preprocess                  ) = 1.497e-03 S  per = 0.619  per(accum) = 0.619
 T(sweep opt: symbolic_formulae           ) = 6.102e-03 S  per = 2.52  per(accum) = 3.14
 T(sweep opt: hintermediate init          ) = 3.655e-04 S  per = 0.151  per(accum) = 3.29
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.035e-02 S  per = 4.28  per(accum) = 7.57
 T(sweep opt: hmmtasks init               ) = 4.509e-02 S  per = 18.6  per(accum) = 26.2
 T(sweep opt: initial guess for dvdson    ) = 1.435e-05 S  per = 0.00593  per(accum) = 26.2
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 2.493e-02 S  per = 10.3  per(accum) = 36.5
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 5.837e-04 S  per = 0.241  per(accum) = 36.8
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 3.150e-06 S  per = 0.0013  per(accum) = 36.8
 T(sweep opt: dvdson solver [rest part]   ) = 1.530e-01 S  per = 63.2  per(accum) = 100
Detailed decomposition of T(renrm) = 6.905e-01 S  T(sum) = 6.905e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.499e-04 S  per = 0.0796  per(accum) = 0.0796
 T(sweep opt: qops init                    ) = 3.372e-03 S  per = 0.488  per(accum) = 0.568
 T(sweep opt: symbolic_formulae_renorm     ) = 5.203e-03 S  per = 0.754  per(accum) = 1.32
 T(sweep opt: allocate qops on gpu         ) = 1.244e-04 S  per = 0.018  per(accum) = 1.34
 T(sweep opt: site memcpy cpu2gpu          ) = 1.010e-04 S  per = 0.0146  per(accum) = 1.35
 T(sweep opt: rintermediate init           ) = 2.986e-04 S  per = 0.0432  per(accum) = 1.4
 T(sweep opt: preprocess_formulae_Rlist2   ) = 9.215e-03 S  per = 1.33  per(accum) = 2.73
 T(sweep opt: rmmtasks init                ) = 3.667e-02 S  per = 5.31  per(accum) = 8.04
 T(sweep opt: qops memset on cpu           ) = 2.210e-07 S  per = 3.2e-05  per(accum) = 8.04
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.529e-03 S  per = 0.511  per(accum) = 8.55
 T(sweep opt: reduction of opS & opH [nccl]) = 5.383e-06 S  per = 0.00078  per(accum) = 8.55
 T(sweep opt: qops memcpy gpu2cpu          ) = 9.791e-05 S  per = 0.0142  per(accum) = 8.57
 T(sweep opt: deallocate cpu and gpu memory) = 5.235e-05 S  per = 0.00758  per(accum) = 8.58
 T(sweep opt: reduction of opS & opH [comm]) = 1.249e-04 S  per = 0.0181  per(accum) = 8.59
 T(sweep opt: conversion from opAB to opPQ ) = 6.292e-01 S  per = 91.1  per(accum) = 99.7
 T(sweep opt: after oper_renorm            ) = 1.930e-03 S  per = 0.279  per(accum) = 100
##### global opt: 2.507e+00 S #####
 T(global opt: fetch) = 6.858e-03 S  per = 0.274  per(accum) = 0.274
 T(global opt: hdiag) = 7.835e-03 S  per = 0.313  per(accum) = 0.586
 T(global opt: dvdsn) = 1.252e+00 S  per = 49.9  per(accum) = 50.5
 T(global opt: decim) = 8.428e-03 S  per = 0.336  per(accum) = 50.9
 T(global opt: guess) = 2.585e-03 S  per = 0.103  per(accum) = 51
 T(global opt: renrm) = 1.226e+00 S  per = 48.9  per(accum) = 99.9
 T(global opt: save ) = 3.610e-03 S  per = 0.144  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.252e+00 S  T(sum) = 1.249e+00 S  per = 9.977e+01
 T(global opt: preprocess                  ) = 6.333e-03 S  per = 0.507  per(accum) = 0.507
 T(global opt: symbolic_formulae           ) = 2.114e-02 S  per = 1.69  per(accum) = 2.2
 T(global opt: hintermediate init          ) = 1.024e-03 S  per = 0.082  per(accum) = 2.28
 T(global opt: preprocess_hformulae_Hxlist ) = 9.931e-02 S  per = 7.95  per(accum) = 10.2
 T(global opt: hmmtasks init               ) = 5.176e-01 S  per = 41.5  per(accum) = 51.7
 T(global opt: initial guess for dvdson    ) = 1.477e-03 S  per = 0.118  per(accum) = 51.8
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.316e-01 S  per = 10.5  per(accum) = 62.3
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.700e-03 S  per = 0.136  per(accum) = 62.5
 T(global opt: dvdson solver [comm(cpu)]   ) = 8.795e-06 S  per = 0.000704  per(accum) = 62.5
 T(global opt: dvdson solver [rest part]   ) = 4.685e-01 S  per = 37.5  per(accum) = 100
Detailed decomposition of T(renrm) = 1.226e+00 S  T(sum) = 1.226e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.154e-03 S  per = 0.0941  per(accum) = 0.0941
 T(global opt: qops init                    ) = 6.538e-03 S  per = 0.533  per(accum) = 0.628
 T(global opt: symbolic_formulae_renorm     ) = 1.149e-02 S  per = 0.938  per(accum) = 1.57
 T(global opt: allocate qops on gpu         ) = 2.635e-04 S  per = 0.0215  per(accum) = 1.59
 T(global opt: site memcpy cpu2gpu          ) = 2.336e-04 S  per = 0.0191  per(accum) = 1.61
 T(global opt: rintermediate init           ) = 8.027e-04 S  per = 0.0655  per(accum) = 1.67
 T(global opt: preprocess_formulae_Rlist2   ) = 1.971e-02 S  per = 1.61  per(accum) = 3.28
 T(global opt: rmmtasks init                ) = 7.869e-02 S  per = 6.42  per(accum) = 9.7
 T(global opt: qops memset on cpu           ) = 4.940e-07 S  per = 4.03e-05  per(accum) = 9.7
 T(global opt: preprocess_renorm_batchGPU   ) = 8.631e-03 S  per = 0.704  per(accum) = 10.4
 T(global opt: reduction of opS & opH [nccl]) = 1.192e-05 S  per = 0.000973  per(accum) = 10.4
 T(global opt: qops memcpy gpu2cpu          ) = 2.179e-04 S  per = 0.0178  per(accum) = 10.4
 T(global opt: deallocate cpu and gpu memory) = 1.185e-04 S  per = 0.00967  per(accum) = 10.4
 T(global opt: reduction of opS & opH [comm]) = 2.742e-04 S  per = 0.0224  per(accum) = 10.5
 T(global opt: conversion from opAB to opPQ ) = 1.094e+00 S  per = 89.3  per(accum) = 99.7
 T(global opt: after oper_renorm            ) = 3.521e-03 S  per = 0.287  per(accum) = 100

isweep=1 ibond=5/seqsize=6 dots=1 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.514e+02S Sys:1.397e+00S Total:2.528e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=156:1.190e-03MB:1.162e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=51:3.891e-04MB:3.800e-07GB
total mem of comb=250:1.907e-03MB:1.863e-06GB
ctns::topology::check_partition: (sl,sr,sc)=2,3,1
 suppl= 0 1
 suppr= 3 4 5
 suppc= 2
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:4 S:8 H:1 A:6 B:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
 rqops: oplist=CSHPQ nops=C:6 S:6 H:1 P:15 Q:21 
        dim(bra,ket)=10,10 size(op)=22:1.678e-04MB size(tot)=517:3.944e-03MB:3.852e-06GB
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=208:1.587e-03MB:1.550e-06GB
 qops(tot)=1001:7.637e-03MB:7.458e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
wf3(diml,dimr,dimc)=(10,10,4) nnz=51:3.891e-04MB
qtensor3: wf3 own=1 _data=0x4f1dfa60
qinfo3: wf3 sym=(6,0) dir=1,1,1
 qbond: qrow nsym=8 dimAll=10
 (2,0):3 (1,1):1 (1,-1):1 (4,0):1 (3,1):1 (3,-1):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=6 dimAll=10
 (3,1):3 (3,-1):3 (2,0):1 (4,0):1 (2,2):1 (4,2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=19 nblocks=192 size=51:3.891e-04MB
### DIAG TIMING: total=4.033e-04 t1=1.065e-05, t2=2.691e-05, t3=3.376e-05, t4=2.956e-04, t5=1.888e-05, t6=1.372e-05, t7=3.851e-06
duration_diagGPU:4.148e-04
duration_diagreduce:5.000e-08
duration_diagtransform:5.300e-07
----- TIMING FOR symbolic_formulae_onedot with size=137 : 1.515e-03 S -----
rank=0 GPUmem(GB): used=7.46e-06 (oper)=7.46e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=137
 no. of hintermediate operators=58
 no. of coefficients=174:0.00133MB:1.3e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.175e-05 S -----
rank=0 GPUmem(GB): used=8.75e-06 (oper,hinter)=7.46e-06,1.3e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00241 S size(H_formulae)=137 size(Hxlst2)=19 T(Hmu/Hxlist)=0.000328,0.00208 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00259 S size(H_formulae)=137 size(Hxlst)=1962 -----
rank=0 GPUmem(GB): used=0.000331 (oper,hinter,dvdson,batch)=7.46e-06,1.3e-06,7.6e-07,0.000322 blksize=9 blksize0=3 batchsize=1962
ctns::pdvdsonSolver_nkr::solve_iter ndim=51 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.94e-05,0.000118,0.000553,0.000161,0.000871
 ndim=51:3.8e-07GB t[comm(intra)]=2.94e-05 speed=0.0258GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=5.5e-04 t_reduction=1.6e-04 tot=8.3e-04 ---
 sigma[inter] counter=27 t=1.2e-04 per=1.4e+01 cost=1.1e+04 flops=9.7e+07
 sigma[gemm] counter=27 i=0 t=7.6e-05 per=9.1e+00 cost=4.2e+03 flops=5.5e+07
 sigma[gemm] counter=27 i=1 t=7.0e-05 per=8.4e+00 cost=4.1e+03 flops=5.8e+07
 sigma[gemm] counter=27 i=2 t=1.0e-04 per=1.3e+01 cost=8.0e+03 flops=7.7e+07
 sigma[gemm] counter=27 i=3 t=1.0e-04 per=1.2e+01 cost=8.0e+03 flops=7.9e+07
 sigma[gemm] counter=27 i=4 t=9.8e-05 per=1.2e+01 cost=8.3e+03 flops=8.5e+07
 sigma[gemm] counter=27 i=5 t=1.0e-04 per=1.2e+01 cost=8.3e+03 flops=8.0e+07
 sigma[gemm] counter=27 total t=5.5e-04 per=6.6e+01 cost=4.1e+04 flops=7.4e+07
 sigma[red] counter=27 t=1.6e-04 per=1.9e+01 cost=1.2e+04 flops=7.2e+07
--- TIMING FOR sigma_tot : t_inter=2.5e-03 t_gemm=1.5e-02 t_reduction=4.0e-03 tot=2.2e-02 ---
 sigma_tot[inter] counter=27 t=2.5e-03 per=1.2e+01 cost=2.3e+05 flops=9.1e+07
 sigma_tot[gemm] counter=27 i=0 t=2.2e-03 per=9.9e+00 cost=8.1e+04 flops=3.7e+07
 sigma_tot[gemm] counter=27 i=1 t=2.1e-03 per=9.6e+00 cost=7.9e+04 flops=3.8e+07
 sigma_tot[gemm] counter=27 i=2 t=2.9e-03 per=1.3e+01 cost=1.5e+05 flops=5.3e+07
 sigma_tot[gemm] counter=27 i=3 t=2.8e-03 per=1.3e+01 cost=1.5e+05 flops=5.4e+07
 sigma_tot[gemm] counter=27 i=4 t=2.8e-03 per=1.3e+01 cost=1.5e+05 flops=5.4e+07
 sigma_tot[gemm] counter=27 i=5 t=2.7e-03 per=1.2e+01 cost=1.5e+05 flops=5.6e+07
 sigma_tot[gemm] counter=27 total t=1.5e-02 per=7.0e+01 cost=7.7e+05 flops=5.0e+07
 sigma_tot[red] counter=27 t=4.0e-03 per=1.8e+01 cost=2.2e+05 flops=5.6e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.3e-05,6.2e-06,2.1e-06,6.8e-07,2.0e-07
settings: ndim=51 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.230341250402 -1.003e+03  8.377e-04    1     1  1.028e-03 1.028e-03 9.889e-04
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.175e-05,1.005e-04,6.893e-04,1.785e-04,9.976e-04
 ndim=51:3.800e-07GB t[comm(intra)]=2.175e-05 speed=3.494e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=6.9e-04 t_reduction=1.8e-04 tot=9.7e-04 ---
 sigma[inter] counter=28 t=1.0e-04 per=1.0e+01 cost=1.1e+04 flops=1.1e+08
 sigma[gemm] counter=28 i=0 t=1.0e-04 per=1.0e+01 cost=4.2e+03 flops=4.2e+07
 sigma[gemm] counter=28 i=1 t=8.7e-05 per=9.0e+00 cost=4.1e+03 flops=4.7e+07
 sigma[gemm] counter=28 i=2 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.5e+07
 sigma[gemm] counter=28 i=3 t=1.3e-04 per=1.3e+01 cost=8.0e+03 flops=6.2e+07
 sigma[gemm] counter=28 i=4 t=1.3e-04 per=1.3e+01 cost=8.3e+03 flops=6.6e+07
 sigma[gemm] counter=28 i=5 t=1.2e-04 per=1.3e+01 cost=8.3e+03 flops=6.8e+07
 sigma[gemm] counter=28 total t=6.9e-04 per=7.1e+01 cost=4.1e+04 flops=5.9e+07
 sigma[red] counter=28 t=1.8e-04 per=1.8e+01 cost=1.2e+04 flops=6.5e+07
--- TIMING FOR sigma_tot : t_inter=2.6e-03 t_gemm=1.6e-02 t_reduction=4.2e-03 tot=2.3e-02 ---
 sigma_tot[inter] counter=28 t=2.6e-03 per=1.1e+01 cost=2.4e+05 flops=9.2e+07
 sigma_tot[gemm] counter=28 i=0 t=2.3e-03 per=9.9e+00 cost=8.5e+04 flops=3.7e+07
 sigma_tot[gemm] counter=28 i=1 t=2.2e-03 per=9.6e+00 cost=8.3e+04 flops=3.8e+07
 sigma_tot[gemm] counter=28 i=2 t=3.0e-03 per=1.3e+01 cost=1.6e+05 flops=5.4e+07
 sigma_tot[gemm] counter=28 i=3 t=2.9e-03 per=1.3e+01 cost=1.6e+05 flops=5.5e+07
 sigma_tot[gemm] counter=28 i=4 t=2.9e-03 per=1.3e+01 cost=1.6e+05 flops=5.5e+07
 sigma_tot[gemm] counter=28 i=5 t=2.8e-03 per=1.2e+01 cost=1.6e+05 flops=5.6e+07
 sigma_tot[gemm] counter=28 total t=1.6e-02 per=7.0e+01 cost=8.1e+05 flops=5.0e+07
 sigma_tot[red] counter=28 t=4.2e-03 per=1.8e+01 cost=2.4e+05 flops=5.6e+07
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=9.9e-06,3.1e-05,4.0e-06,1.3e-06,2.4e-07
    2   0 -      -3.230341704259 -4.539e-07  3.240e-04    2     2  6.919e-03 3.460e-03 1.066e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.126e-05,1.072e-04,6.790e-04,1.747e-04,9.884e-04
 ndim=51:3.800e-07GB t[comm(intra)]=2.126e-05 speed=3.574e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=6.8e-04 t_reduction=1.7e-04 tot=9.6e-04 ---
 sigma[inter] counter=29 t=1.1e-04 per=1.1e+01 cost=1.1e+04 flops=1.1e+08
 sigma[gemm] counter=29 i=0 t=9.1e-05 per=9.5e+00 cost=4.2e+03 flops=4.6e+07
 sigma[gemm] counter=29 i=1 t=8.9e-05 per=9.3e+00 cost=4.1e+03 flops=4.6e+07
 sigma[gemm] counter=29 i=2 t=1.3e-04 per=1.3e+01 cost=8.0e+03 flops=6.3e+07
 sigma[gemm] counter=29 i=3 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.4e+07
 sigma[gemm] counter=29 i=4 t=1.2e-04 per=1.3e+01 cost=8.3e+03 flops=6.7e+07
 sigma[gemm] counter=29 i=5 t=1.2e-04 per=1.3e+01 cost=8.3e+03 flops=6.8e+07
 sigma[gemm] counter=29 total t=6.8e-04 per=7.1e+01 cost=4.1e+04 flops=6.0e+07
 sigma[red] counter=29 t=1.7e-04 per=1.8e+01 cost=1.2e+04 flops=6.6e+07
--- TIMING FOR sigma_tot : t_inter=2.7e-03 t_gemm=1.7e-02 t_reduction=4.4e-03 tot=2.4e-02 ---
 sigma_tot[inter] counter=29 t=2.7e-03 per=1.1e+01 cost=2.5e+05 flops=9.3e+07
 sigma_tot[gemm] counter=29 i=0 t=2.4e-03 per=9.9e+00 cost=8.9e+04 flops=3.8e+07
 sigma_tot[gemm] counter=29 i=1 t=2.3e-03 per=9.6e+00 cost=8.7e+04 flops=3.8e+07
 sigma_tot[gemm] counter=29 i=2 t=3.1e-03 per=1.3e+01 cost=1.7e+05 flops=5.4e+07
 sigma_tot[gemm] counter=29 i=3 t=3.1e-03 per=1.3e+01 cost=1.7e+05 flops=5.5e+07
 sigma_tot[gemm] counter=29 i=4 t=3.0e-03 per=1.3e+01 cost=1.7e+05 flops=5.5e+07
 sigma_tot[gemm] counter=29 i=5 t=3.0e-03 per=1.2e+01 cost=1.7e+05 flops=5.7e+07
 sigma_tot[gemm] counter=29 total t=1.7e-02 per=7.0e+01 cost=8.5e+05 flops=5.0e+07
 sigma_tot[red] counter=29 t=4.4e-03 per=1.8e+01 cost=2.5e+05 flops=5.7e+07
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,2.3e-05,3.6e-06,1.3e-06,2.3e-07
    3   0 -      -3.230341774645 -7.039e-08  1.293e-04    3     3  1.603e-02 5.342e-03 1.094e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.223e-05,1.018e-04,6.794e-04,1.742e-04,9.831e-04
 ndim=51:3.800e-07GB t[comm(intra)]=2.223e-05 speed=3.418e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=6.8e-04 t_reduction=1.7e-04 tot=9.5e-04 ---
 sigma[inter] counter=30 t=1.0e-04 per=1.1e+01 cost=1.1e+04 flops=1.1e+08
 sigma[gemm] counter=30 i=0 t=9.2e-05 per=9.6e+00 cost=4.2e+03 flops=4.6e+07
 sigma[gemm] counter=30 i=1 t=8.8e-05 per=9.2e+00 cost=4.1e+03 flops=4.7e+07
 sigma[gemm] counter=30 i=2 t=1.3e-04 per=1.3e+01 cost=8.0e+03 flops=6.3e+07
 sigma[gemm] counter=30 i=3 t=1.2e-04 per=1.3e+01 cost=8.0e+03 flops=6.5e+07
 sigma[gemm] counter=30 i=4 t=1.3e-04 per=1.3e+01 cost=8.3e+03 flops=6.6e+07
 sigma[gemm] counter=30 i=5 t=1.2e-04 per=1.3e+01 cost=8.3e+03 flops=6.7e+07
 sigma[gemm] counter=30 total t=6.8e-04 per=7.1e+01 cost=4.1e+04 flops=6.0e+07
 sigma[red] counter=30 t=1.7e-04 per=1.8e+01 cost=1.2e+04 flops=6.6e+07
--- TIMING FOR sigma_tot : t_inter=2.8e-03 t_gemm=1.8e-02 t_reduction=4.5e-03 tot=2.5e-02 ---
 sigma_tot[inter] counter=30 t=2.8e-03 per=1.1e+01 cost=2.7e+05 flops=9.3e+07
 sigma_tot[gemm] counter=30 i=0 t=2.5e-03 per=9.9e+00 cost=9.3e+04 flops=3.8e+07
 sigma_tot[gemm] counter=30 i=1 t=2.4e-03 per=9.5e+00 cost=9.1e+04 flops=3.9e+07
 sigma_tot[gemm] counter=30 i=2 t=3.2e-03 per=1.3e+01 cost=1.8e+05 flops=5.4e+07
 sigma_tot[gemm] counter=30 i=3 t=3.2e-03 per=1.3e+01 cost=1.8e+05 flops=5.5e+07
 sigma_tot[gemm] counter=30 i=4 t=3.2e-03 per=1.3e+01 cost=1.8e+05 flops=5.6e+07
 sigma_tot[gemm] counter=30 i=5 t=3.1e-03 per=1.2e+01 cost=1.8e+05 flops=5.7e+07
 sigma_tot[gemm] counter=30 total t=1.8e-02 per=7.0e+01 cost=8.9e+05 flops=5.1e+07
 sigma_tot[red] counter=30 t=4.5e-03 per=1.8e+01 cost=2.6e+05 flops=5.7e+07
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.5e-05,3.3e-06,1.1e-06,2.2e-07
    4   0 +      -3.230341791799 -1.715e-08  7.404e-05    3     4  2.505e-02 6.262e-03 1.105e-03
TIMING FOR Davidson : 2.506e-02  T(cal/comm/rest)=4.422e-03,4.620e-07,2.064e-02
decomposed t_rest=2.064e-02
 T(sub)    =1.240e-04 per=6.011e-01
 T(precond)=2.039e-02 per=9.880e+01
 T(ortho)  =1.062e-05 per=5.145e-02
 T(xcopy)  =6.870e-07 per=3.329e-03
 T(xnrm2)  =2.039e-06 per=9.880e-03
 T(other)  =1.109e-04 per=5.372e-01
optimized energies: isweep=1 ibond=5 dots=1 e[0]=-3.230341791799 nmvp=4
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.543e+02S Sys:1.398e+00S Total:2.557e+02S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=10 nqr=13 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep1_ibond5.txt
 qbond: qsuper nsym=13 dimAll=40
 (3,1):5 (3,-1):4 (2,0):1 (4,0):8 (2,2):1 (4,2):5 (5,1):5 (5,-1):4 (6,0):1 (6,2):1 (3,3):1 (5,3):1 (4,-2):3
timing for divide=1.4e-05
timing for compute=9.3e-05
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-04 S T(divide/compute/collect)=1.4e-05,9.3e-05,1.4e-05 -----
decimation summary: 40->10 dwt=+0.000e+00 SvN=7.737e-01
 qbond: qkept nsym=8 dimAll=10
 (4,0):3 (3,1):1 (3,-1):1 (2,0):1 (4,2):1 (5,1):1 (5,-1):1 (4,-2):1
----- TIMING for decimation_row(nkr): 5.400e-04 S T(decim/select/formRot)=1.950e-04,2.951e-04,4.989e-05 -----
----- TIMING FOR onedot_decimation: 6.881e-04 S T(wf/decim)=1.133e-04,5.749e-04 -----
ctns::oper_renorm coord=(2,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:8 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=10,10 size(op)=16:1.221e-04MB size(tot)=276:2.106e-03MB:2.056e-06GB
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.545e+02S Sys:1.398e+00S Total:2.558e+02S
----- TIMING FOR symbolic_formulae_renorm with size=29 : 1.220e-03 S -----
rank=0 GPUmem(GB): used=8.75e-06 (oper)=7.46e-06
rank=0 GPUmem(GB): used=9.13e-06 (oper,site)(GB)=7.46e-06,3.8e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=29
 no. of rintermediate operators=58
 no. of coefficients=174:0.00133MB:1.3e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 9.738e-05 S -----
rank=0 GPUmem(GB): used=1.04e-05 (oper,site,rinter)=7.46e-06,3.8e-07,1.3e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0017 S size(rtasks)=29 size(Rlst2)=64 T(Rmu/Rlist)=0.000357,0.00134 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00183 S size(rtasks)=29 size(Rlst)=1091 -----
rank=0 GPUmem(GB): used=1.04e-05 (oper,site,rinter,batch)=7.46e-06,3.8e-07,1.3e-06,0.000179 blksize=9 blksize0=3 batchsize=1091
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.16e-05,0.000429,0.000163
--- TIMING FOR renorm : t_inter=8.1e-05 t_gemm=4.3e-04 t_reduction=1.6e-04 tot=6.7e-04 ---
 renorm[inter] counter=6 t=8.1e-05 per=1.2e+01 cost=5.7e+03 flops=7.0e+07
 renorm[gemm] counter=6 i=0 t=6.7e-05 per=1.0e+01 cost=1.9e+03 flops=2.9e+07
 renorm[gemm] counter=6 i=1 t=6.8e-05 per=1.0e+01 cost=2.9e+03 flops=4.3e+07
 renorm[gemm] counter=6 i=2 t=9.3e-05 per=1.4e+01 cost=3.3e+03 flops=3.5e+07
 renorm[gemm] counter=6 i=3 t=9.2e-05 per=1.4e+01 cost=6.0e+03 flops=6.5e+07
 renorm[gemm] counter=6 i=4 t=1.1e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=5 t=1.1e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=6 t=1.1e-04 per=1.6e+01 cost=1.1e+04 flops=1.1e+08
 renorm[gemm] counter=6 total t=4.3e-04 per=6.4e+01 cost=2.5e+04 flops=5.9e+07
 renorm[red] counter=6 t=1.6e-04 per=2.4e+01 cost=5.7e+03 flops=3.5e+07
--- TIMING FOR renorm_tot : t_inter=3.4e-04 t_gemm=2.5e-03 t_reduction=8.7e-04 tot=3.7e-03 ---
 renorm_tot[inter] counter=6 t=3.4e-04 per=9.2e+00 cost=1.4e+04 flops=4.1e+07
 renorm_tot[gemm] counter=6 i=0 t=4.4e-04 per=1.2e+01 cost=1.3e+04 flops=3.1e+07
 renorm_tot[gemm] counter=6 i=1 t=4.0e-04 per=1.1e+01 cost=1.4e+04 flops=3.6e+07
 renorm_tot[gemm] counter=6 i=2 t=2.4e-04 per=6.6e+00 cost=9.6e+03 flops=3.9e+07
 renorm_tot[gemm] counter=6 i=3 t=2.5e-04 per=6.8e+00 cost=1.5e+04 flops=6.1e+07
 renorm_tot[gemm] counter=6 i=4 t=2.7e-04 per=7.3e+00 cost=1.0e+04 flops=3.8e+07
 renorm_tot[gemm] counter=6 i=5 t=2.7e-04 per=7.3e+00 cost=1.5e+04 flops=5.4e+07
 renorm_tot[gemm] counter=6 i=6 t=6.2e-04 per=1.7e+01 cost=6.4e+04 flops=1.0e+08
 renorm_tot[gemm] counter=6 total t=2.5e-03 per=6.7e+01 cost=1.4e+05 flops=5.7e+07
 renorm_tot[red] counter=6 t=8.7e-04 per=2.4e+01 cost=4.1e+04 flops=4.7e+07
qops.to_cpu: size(tot)=276:2.1e-03MB:2.1e-06GB t[to_cpu]=1.4e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=2.286e-16 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0122 S rank=0 -----
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.546e+02S Sys:1.398e+00S Total:2.560e+02S
comb::display_size qkind=qNSz
 rbases: len=6 mem=42:3.204e-04MB:3.129e-07GB
 sites: len=6 mem=156:1.190e-03MB:1.162e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=222:1.694e-03MB:1.654e-06GB
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.546e+02S Sys:1.398e+00S Total:2.560e+02S
##### local opt: 5.614e-02 S #####
 T(local opt: fetch) = 2.064e-04 S  per = 0.368  per(accum) = 0.368
 T(local opt: hdiag) = 4.804e-04 S  per = 0.856  per(accum) = 1.22
 T(local opt: dvdsn) = 4.178e-02 S  per = 74.4  per(accum) = 75.6
 T(local opt: decim) = 6.980e-04 S  per = 1.24  per(accum) = 76.9
 T(local opt: guess) = 1.593e-04 S  per = 0.284  per(accum) = 77.2
 T(local opt: renrm) = 1.258e-02 S  per = 22.4  per(accum) = 99.6
 T(local opt: save ) = 2.375e-04 S  per = 0.423  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.178e-02 S  T(sum) = 4.155e-02 S  per = 9.943e+01
 T(local opt: preprocess                  ) = 3.481e-04 S  per = 0.838  per(accum) = 0.838
 T(local opt: symbolic_formulae           ) = 1.525e-03 S  per = 3.67  per(accum) = 4.51
 T(local opt: hintermediate init          ) = 8.653e-05 S  per = 0.208  per(accum) = 4.72
 T(local opt: preprocess_hformulae_Hxlist ) = 2.658e-03 S  per =  6.4  per(accum) = 11.1
 T(local opt: hmmtasks init               ) = 1.186e-02 S  per = 28.5  per(accum) = 39.7
 T(local opt: initial guess for dvdson    ) = 7.105e-06 S  per = 0.0171  per(accum) = 39.7
 T(local opt: dvdson solver [Hx_batchGPU] ) = 4.327e-03 S  per = 10.4  per(accum) = 50.1
 T(local opt: dvdson solver [comm(gpu)]   ) = 9.469e-05 S  per = 0.228  per(accum) = 50.3
 T(local opt: dvdson solver [comm(cpu)]   ) = 4.620e-07 S  per = 0.00111  per(accum) = 50.3
 T(local opt: dvdson solver [rest part]   ) = 2.064e-02 S  per = 49.7  per(accum) = 100
Detailed decomposition of T(renrm) = 1.258e-02 S  T(sum) = 1.258e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.168e-04 S  per = 0.928  per(accum) = 0.928
 T(local opt: qops init                    ) = 6.491e-04 S  per = 5.16  per(accum) = 6.09
 T(local opt: symbolic_formulae_renorm     ) = 1.230e-03 S  per = 9.78  per(accum) = 15.9
 T(local opt: allocate qops on gpu         ) = 2.324e-05 S  per = 0.185  per(accum) = 16.1
 T(local opt: site memcpy cpu2gpu          ) = 1.970e-05 S  per = 0.157  per(accum) = 16.2
 T(local opt: rintermediate init           ) = 1.079e-04 S  per = 0.858  per(accum) = 17.1
 T(local opt: preprocess_formulae_Rlist2   ) = 1.876e-03 S  per = 14.9  per(accum) = 32
 T(local opt: rmmtasks init                ) = 7.498e-03 S  per = 59.6  per(accum) = 91.6
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 0.00027  per(accum) = 91.6
 T(local opt: preprocess_renorm_batchGPU   ) = 7.765e-04 S  per = 6.17  per(accum) = 97.8
 T(local opt: reduction of opS & opH [nccl]) = 1.088e-06 S  per = 0.00865  per(accum) = 97.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.962e-05 S  per = 0.156  per(accum) = 97.9
 T(local opt: deallocate cpu and gpu memory) = 1.811e-05 S  per = 0.144  per(accum) = 98.1
 T(local opt: reduction of opS & opH [comm]) = 2.774e-05 S  per = 0.221  per(accum) = 98.3
 T(local opt: conversion from opAB to opPQ ) = 3.911e-06 S  per = 0.0311  per(accum) = 98.3
 T(local opt: after oper_renorm            ) = 2.095e-04 S  per = 1.67  per(accum) = 100
##### sweep opt: 9.990e-01 S #####
 T(sweep opt: fetch) = 2.161e-03 S  per = 0.216  per(accum) = 0.216
 T(sweep opt: hdiag) = 2.457e-03 S  per = 0.246  per(accum) = 0.462
 T(sweep opt: dvdsn) = 2.849e-01 S  per = 28.5  per(accum) = 29
 T(sweep opt: decim) = 3.941e-03 S  per = 0.394  per(accum) = 29.4
 T(sweep opt: guess) = 9.043e-04 S  per = 0.0905  per(accum) = 29.5
 T(sweep opt: renrm) = 7.031e-01 S  per = 70.4  per(accum) = 99.8
 T(sweep opt: save ) = 1.612e-03 S  per = 0.161  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.849e-01 S  T(sum) = 2.835e-01 S  per = 9.950e+01
 T(sweep opt: preprocess                  ) = 1.845e-03 S  per = 0.651  per(accum) = 0.651
 T(sweep opt: symbolic_formulae           ) = 7.628e-03 S  per = 2.69  per(accum) = 3.34
 T(sweep opt: hintermediate init          ) = 4.520e-04 S  per = 0.159  per(accum) = 3.5
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.301e-02 S  per = 4.59  per(accum) = 8.09
 T(sweep opt: hmmtasks init               ) = 5.695e-02 S  per = 20.1  per(accum) = 28.2
 T(sweep opt: initial guess for dvdson    ) = 2.145e-05 S  per = 0.00757  per(accum) = 28.2
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 2.926e-02 S  per = 10.3  per(accum) = 38.5
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 6.784e-04 S  per = 0.239  per(accum) = 38.8
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 3.612e-06 S  per = 0.00127  per(accum) = 38.8
 T(sweep opt: dvdson solver [rest part]   ) = 1.736e-01 S  per = 61.2  per(accum) = 100
Detailed decomposition of T(renrm) = 7.031e-01 S  T(sum) = 7.031e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.667e-04 S  per = 0.0948  per(accum) = 0.0948
 T(sweep opt: qops init                    ) = 4.021e-03 S  per = 0.572  per(accum) = 0.667
 T(sweep opt: symbolic_formulae_renorm     ) = 6.433e-03 S  per = 0.915  per(accum) = 1.58
 T(sweep opt: allocate qops on gpu         ) = 1.476e-04 S  per = 0.021  per(accum) = 1.6
 T(sweep opt: site memcpy cpu2gpu          ) = 1.207e-04 S  per = 0.0172  per(accum) = 1.62
 T(sweep opt: rintermediate init           ) = 4.065e-04 S  per = 0.0578  per(accum) = 1.68
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.109e-02 S  per = 1.58  per(accum) = 3.26
 T(sweep opt: rmmtasks init                ) = 4.417e-02 S  per = 6.28  per(accum) = 9.54
 T(sweep opt: qops memset on cpu           ) = 2.550e-07 S  per = 3.63e-05  per(accum) = 9.54
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.305e-03 S  per = 0.612  per(accum) = 10.1
 T(sweep opt: reduction of opS & opH [nccl]) = 6.471e-06 S  per = 0.00092  per(accum) = 10.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.175e-04 S  per = 0.0167  per(accum) = 10.2
 T(sweep opt: deallocate cpu and gpu memory) = 7.045e-05 S  per = 0.01  per(accum) = 10.2
 T(sweep opt: reduction of opS & opH [comm]) = 1.526e-04 S  per = 0.0217  per(accum) = 10.2
 T(sweep opt: conversion from opAB to opPQ ) = 6.292e-01 S  per = 89.5  per(accum) = 99.7
 T(sweep opt: after oper_renorm            ) = 2.139e-03 S  per = 0.304  per(accum) = 100
##### global opt: 2.563e+00 S #####
 T(global opt: fetch) = 7.065e-03 S  per = 0.276  per(accum) = 0.276
 T(global opt: hdiag) = 8.315e-03 S  per = 0.324  per(accum) = 0.6
 T(global opt: dvdsn) = 1.293e+00 S  per = 50.5  per(accum) = 51.1
 T(global opt: decim) = 9.126e-03 S  per = 0.356  per(accum) = 51.4
 T(global opt: guess) = 2.744e-03 S  per = 0.107  per(accum) = 51.5
 T(global opt: renrm) = 1.238e+00 S  per = 48.3  per(accum) = 99.8
 T(global opt: save ) = 3.847e-03 S  per = 0.15  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.293e+00 S  T(sum) = 1.290e+00 S  per = 9.976e+01
 T(global opt: preprocess                  ) = 6.681e-03 S  per = 0.518  per(accum) = 0.518
 T(global opt: symbolic_formulae           ) = 2.267e-02 S  per = 1.76  per(accum) = 2.27
 T(global opt: hintermediate init          ) = 1.111e-03 S  per = 0.0861  per(accum) = 2.36
 T(global opt: preprocess_hformulae_Hxlist ) = 1.020e-01 S  per =  7.9  per(accum) = 10.3
 T(global opt: hmmtasks init               ) = 5.295e-01 S  per =   41  per(accum) = 51.3
 T(global opt: initial guess for dvdson    ) = 1.484e-03 S  per = 0.115  per(accum) = 51.4
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.359e-01 S  per = 10.5  per(accum) = 62
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.795e-03 S  per = 0.139  per(accum) = 62.1
 T(global opt: dvdson solver [comm(cpu)]   ) = 9.257e-06 S  per = 0.000717  per(accum) = 62.1
 T(global opt: dvdson solver [rest part]   ) = 4.891e-01 S  per = 37.9  per(accum) = 100
Detailed decomposition of T(renrm) = 1.238e+00 S  T(sum) = 1.238e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.270e-03 S  per = 0.103  per(accum) = 0.103
 T(global opt: qops init                    ) = 7.187e-03 S  per = 0.58  per(accum) = 0.683
 T(global opt: symbolic_formulae_renorm     ) = 1.272e-02 S  per = 1.03  per(accum) = 1.71
 T(global opt: allocate qops on gpu         ) = 2.868e-04 S  per = 0.0232  per(accum) = 1.73
 T(global opt: site memcpy cpu2gpu          ) = 2.533e-04 S  per = 0.0205  per(accum) = 1.75
 T(global opt: rintermediate init           ) = 9.105e-04 S  per = 0.0735  per(accum) = 1.83
 T(global opt: preprocess_formulae_Rlist2   ) = 2.159e-02 S  per = 1.74  per(accum) = 3.57
 T(global opt: rmmtasks init                ) = 8.618e-02 S  per = 6.96  per(accum) = 10.5
 T(global opt: qops memset on cpu           ) = 5.280e-07 S  per = 4.26e-05  per(accum) = 10.5
 T(global opt: preprocess_renorm_batchGPU   ) = 9.407e-03 S  per = 0.76  per(accum) = 11.3
 T(global opt: reduction of opS & opH [nccl]) = 1.301e-05 S  per = 0.00105  per(accum) = 11.3
 T(global opt: qops memcpy gpu2cpu          ) = 2.375e-04 S  per = 0.0192  per(accum) = 11.3
 T(global opt: deallocate cpu and gpu memory) = 1.366e-04 S  per = 0.011  per(accum) = 11.3
 T(global opt: reduction of opS & opH [comm]) = 3.019e-04 S  per = 0.0244  per(accum) = 11.3
 T(global opt: conversion from opAB to opPQ ) = 1.094e+00 S  per = 88.4  per(accum) = 99.7
 T(global opt: after oper_renorm            ) = 3.731e-03 S  per = 0.301  per(accum) = 100

======================================================================
sweep_data::summary isweep=1 mpisize=1 maxthreads=112
----------------------------------------------------------------------
sweep parameters: isweep=1 dots=1 dcut=10 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=10 dwt=+0.000e+00 nmvp=5 e[0]=-3.230242893797 t=0.051
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=10 dwt=-2.220e-16 nmvp=5 e[0]=-3.230261043851 t=0.384
 ibond=2 bond=(3,0)-(4,0) forward=1 deff=10 dwt=+0.000e+00 nmvp=7 e[0]=-3.230310178514 t=0.083
 ibond=3 bond=(3,0)-(4,0) forward=0 deff=10 dwt=+0.000e+00 nmvp=5 e[0]=-3.230340682359 t=0.049
 ibond=4 bond=(2,0)-(3,0) forward=0 deff=10 dwt=+1.110e-16 nmvp=4 e[0]=-3.230341250402 t=0.376
 ibond=5 bond=(1,0)-(2,0) forward=0 deff=10 dwt=+0.000e+00 nmvp=4 e[0]=-3.230341791799 t=0.056
 eav_max=-3.230242893797 [ibond=0]  dwt_min=-2.220e-16 [ibond=1]
 eav_min=-3.230341791799 [ibond=5]  dwt_max=1.110e-16 [ibond=4]
 eav_diff=0.000098898002
 sweep energies: isweep=1 dots=1 dcut=10 deff=10 dwt=+0.000e+00 e[0]=-3.230341791799
----------------------------------------------------------------------
summary of sweep optimization up to isweep=1 mpisize=1 maxthreads=112
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.000e-04 0.000e+00 | 48 | 1.571e+00 | 1.571e+00 | 9.909e-03 8.027e-02 1.289e-02 1.031e-01 6.56
            1  1      10 1.000e-04 0.000e+00 | 30 | 1.004e+00 | 2.575e+00 | 3.185e-03 2.000e-02 5.399e-03 2.859e-02 2.85
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +1.029e-03 e[0]=-3.236066267492 (-5.724e-03)
            1      10 +0.000e+00 e[0]=-3.230341791799 (0.000e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep1
----------------------------------------------------------------------

ctns::sweep_final_LCR2CRR: convert [LC]R => [CR]R
ctns::decimation_row ifab=1 iftrunc=1 dcut=4 nqr=15 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep1_C0R1.txt
 qbond: qsuper nsym=15 dimAll=40
 (4,0):6 (3,1):2 (3,-1):2 (2,0):1 (4,2):2 (5,1):6 (5,-1):6 (4,-2):2 (6,0):5 (6,2):2 (7,1):1 (7,-1):1 (6,-2):2 (5,3):1 (5,-3):1
timing for divide=7.525e-06
timing for compute=4.786e-03
timing for collect=1.329e-05
----- TMING FOR decimation_genbasis(nkr): 4.807e-03 S T(divide/compute/collect)=7.525e-06,4.786e-03,1.329e-05 -----
decimation summary: 40->4 dwt=+0.000e+00 SvN=1.321e+00
 qbond: qkept nsym=4 dimAll=4
 (4,0):1 (5,1):1 (5,-1):1 (6,0):1
----- TIMING for decimation_row(nkr): 5.162e-03 S T(decim/select/formRot)=4.873e-03,2.636e-04,2.506e-05 -----

ctns::sweep_final_CR2cRR: convert [C]R => [cR]R
ctns::decimation_row ifab=1 iftrunc=1 dcut=1 nqr=9 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep1_cR0.txt
 qbond: qsuper nsym=9 dimAll=16
 (4,0):1 (5,1):2 (5,-1):2 (6,0):4 (7,1):2 (7,-1):2 (8,0):1 (6,2):1 (6,-2):1
timing for divide=5.467e-06
timing for compute=8.489e-03
timing for collect=8.262e-06
----- TMING FOR decimation_genbasis(nkr): 8.503e-03 S T(divide/compute/collect)=5.467e-06,8.489e-03,8.262e-06 -----
decimation summary: 16->1 dwt=+0.000e+00 SvN=0.000e+00
 qbond: qkept nsym=1 dimAll=1
 (6,0):1
----- TIMING for decimation_row(nkr): 8.764e-03 S T(decim/select/formRot)=8.557e-03,1.786e-04,2.835e-05 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep1

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(5,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(4,0) Drow=10 maxdiff=4.877e-16 deviate=0
 idx=2 node=(3,0) Drow=10 maxdiff=1.303e-15 deviate=0
 idx=3 node=(2,0) Drow=10 maxdiff=9.412e-16 deviate=0
 idx=4 node=(1,0) Drow=4 maxdiff=2.220e-16 deviate=0
 idx=5 node=(0,0) Drow=1 maxdiff=3.331e-16 deviate=0
qtensor2: wf2 own=1 _data=0x4e3c3310
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (6,0):1
 qbond: qcol nsym=1 dimAll=1
 (6,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(6,0),0:(6,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x4e3c3310
      1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=4.4409e-16 deviate=0
----- TIMING FOR ctns::rcanon_check : 2.536e-04 S -----

ctns::oper_final - build Hmat for RCF at isweep=1

coord=(1,0)
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=208:0.00159MB:1.55e-06GB
 rqops: oplist=CSHPQ nops=C:8 S:4 H:1 P:6 Q:10 
        dim(bra,ket)=10,10 size(op)=16:0.000122MB size(tot)=276:0.00211MB:2.06e-06GB
ctns::oper_renorm coord=(1,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:10 S:2 H:1 P:1 Q:3 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=38:0.00029MB:2.83e-07GB
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.564e+02S Sys:1.401e+00S Total:2.578e+02S
----- TIMING FOR symbolic_formulae_renorm with size=17 : 5.619e-04 S -----
rank=0 GPUmem(GB): used=3.89e-06 (oper)=3.89e-06
rank=0 GPUmem(GB): used=4.06e-06 (oper,site)(GB)=3.89e-06,1.71e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=17
 no. of rintermediate operators=20
 no. of coefficients=80:0.00061MB:5.96e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.198e-05 S -----
rank=0 GPUmem(GB): used=4.66e-06 (oper,site,rinter)=3.89e-06,1.71e-07,5.96e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000905 S size(rtasks)=17 size(Rlst2)=16 T(Rmu/Rlist)=0.000182,0.000723 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000971 S size(rtasks)=17 size(Rlst)=557 -----
rank=0 GPUmem(GB): used=4.66e-06 (oper,site,rinter,batch)=3.89e-06,1.71e-07,5.96e-07,4.15e-05 blksize=3 blksize0=3 batchsize=557
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.67e-05,0.000306,0.000121
--- TIMING FOR renorm : t_inter=7.6e-05 t_gemm=3.0e-04 t_reduction=1.2e-04 tot=5.0e-04 ---
 renorm[inter] counter=7 t=7.6e-05 per=1.5e+01 cost=1.8e+03 flops=2.4e+07
 renorm[gemm] counter=7 i=0 t=5.7e-05 per=1.1e+01 cost=5.7e+02 flops=1.0e+07
 renorm[gemm] counter=7 i=1 t=5.3e-05 per=1.1e+01 cost=7.7e+02 flops=1.4e+07
 renorm[gemm] counter=7 i=2 t=6.4e-05 per=1.3e+01 cost=9.1e+02 flops=1.4e+07
 renorm[gemm] counter=7 i=3 t=6.8e-05 per=1.3e+01 cost=1.4e+03 flops=2.1e+07
 renorm[gemm] counter=7 i=4 t=1.1e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=5 t=1.1e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=6 t=6.1e-05 per=1.2e+01 cost=1.8e+03 flops=2.9e+07
 renorm[gemm] counter=7 total t=3.0e-04 per=6.1e+01 cost=5.4e+03 flops=1.8e+07
 renorm[red] counter=7 t=1.2e-04 per=2.4e+01 cost=1.1e+03 flops=9.3e+06
--- TIMING FOR renorm_tot : t_inter=4.1e-04 t_gemm=2.8e-03 t_reduction=9.9e-04 tot=4.2e-03 ---
 renorm_tot[inter] counter=7 t=4.1e-04 per=9.9e+00 cost=1.6e+04 flops=3.8e+07
 renorm_tot[gemm] counter=7 i=0 t=4.9e-04 per=1.2e+01 cost=1.4e+04 flops=2.8e+07
 renorm_tot[gemm] counter=7 i=1 t=4.5e-04 per=1.1e+01 cost=1.5e+04 flops=3.3e+07
 renorm_tot[gemm] counter=7 i=2 t=3.1e-04 per=7.4e+00 cost=1.0e+04 flops=3.4e+07
 renorm_tot[gemm] counter=7 i=3 t=3.2e-04 per=7.6e+00 cost=1.7e+04 flops=5.2e+07
 renorm_tot[gemm] counter=7 i=4 t=2.7e-04 per=6.4e+00 cost=1.0e+04 flops=3.8e+07
 renorm_tot[gemm] counter=7 i=5 t=2.7e-04 per=6.4e+00 cost=1.5e+04 flops=5.4e+07
 renorm_tot[gemm] counter=7 i=6 t=6.8e-04 per=1.6e+01 cost=6.6e+04 flops=9.7e+07
 renorm_tot[gemm] counter=7 total t=2.8e-03 per=6.6e+01 cost=1.5e+05 flops=5.3e+07
 renorm_tot[red] counter=7 t=9.9e-04 per=2.4e+01 cost=4.2e+04 flops=4.3e+07
qops.to_cpu: size(tot)=38:2.9e-04MB:2.8e-07GB t[to_cpu]=1.3e-05S speed=2.1e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00637 S rank=0 -----

coord=(0,0)
 cqops: oplist=CABPQSH nops=C:2 S:10 H:1 A:1 B:3 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=208:0.00159MB:1.55e-06GB
 rqops: oplist=CSHPQ nops=C:10 S:2 H:1 P:1 Q:3 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=38:0.00029MB:2.83e-07GB
ctns::oper_renorm coord=(0,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:12 S:0 H:1 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
CPUmem: VM:1.935e+01GB RSS:1.845e+00GB  Timing: User:2.567e+02S Sys:1.401e+00S Total:2.581e+02S
----- TIMING FOR symbolic_formulae_renorm with size=13 : 1.673e-04 S -----
rank=0 GPUmem(GB): used=1.84e-06 (oper)=1.84e-06
rank=0 GPUmem(GB): used=1.87e-06 (oper,site)(GB)=1.84e-06,2.98e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=13
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=1.87e-06 (oper,site,rinter)=1.84e-06,2.98e-08,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000156 S size(rtasks)=13 size(Rlst2)=1 T(Rmu/Rlist)=5.79e-05,9.85e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000172 S size(rtasks)=13 size(Rlst)=84 -----
rank=0 GPUmem(GB): used=1.87e-06 (oper,site,rinter,batch)=1.84e-06,2.98e-08,0,1.88e-06 blksize=1 blksize0=0 batchsize=84
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.25e-06,0.000239,5.59e-05
--- TIMING FOR renorm : t_inter=7.0e-06 t_gemm=2.4e-04 t_reduction=5.6e-05 tot=3.0e-04 ---
 renorm[inter] counter=8 t=7.0e-06 per=2.3e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=0 t=6.1e-05 per=2.0e+01 cost=7.6e+01 flops=1.2e+06
 renorm[gemm] counter=8 i=1 t=4.5e-05 per=1.5e+01 cost=7.6e+01 flops=1.7e+06
 renorm[gemm] counter=8 i=2 t=4.4e-05 per=1.5e+01 cost=7.6e+01 flops=1.7e+06
 renorm[gemm] counter=8 i=3 t=4.2e-05 per=1.4e+01 cost=7.6e+01 flops=1.8e+06
 renorm[gemm] counter=8 i=4 t=1.1e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=5 t=1.0e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=6 t=4.3e-05 per=1.4e+01 cost=1.7e+02 flops=3.9e+06
 renorm[gemm] counter=8 total t=2.4e-04 per=7.9e+01 cost=4.7e+02 flops=2.0e+06
 renorm[red] counter=8 t=5.6e-05 per=1.9e+01 cost=1.7e+02 flops=3.0e+06
--- TIMING FOR renorm_tot : t_inter=4.2e-04 t_gemm=3.0e-03 t_reduction=1.0e-03 tot=4.5e-03 ---
 renorm_tot[inter] counter=8 t=4.2e-04 per=9.4e+00 cost=1.6e+04 flops=3.7e+07
 renorm_tot[gemm] counter=8 i=0 t=5.5e-04 per=1.2e+01 cost=1.4e+04 flops=2.5e+07
 renorm_tot[gemm] counter=8 i=1 t=4.9e-04 per=1.1e+01 cost=1.5e+04 flops=3.0e+07
 renorm_tot[gemm] counter=8 i=2 t=3.5e-04 per=7.8e+00 cost=1.1e+04 flops=3.0e+07
 renorm_tot[gemm] counter=8 i=3 t=3.6e-04 per=8.0e+00 cost=1.7e+04 flops=4.6e+07
 renorm_tot[gemm] counter=8 i=4 t=2.7e-04 per=6.0e+00 cost=1.0e+04 flops=3.8e+07
 renorm_tot[gemm] counter=8 i=5 t=2.7e-04 per=6.0e+00 cost=1.5e+04 flops=5.4e+07
 renorm_tot[gemm] counter=8 i=6 t=7.2e-04 per=1.6e+01 cost=6.6e+04 flops=9.1e+07
 renorm_tot[gemm] counter=8 total t=3.0e-03 per=6.7e+01 cost=1.5e+05 flops=4.9e+07
 renorm_tot[red] counter=8 t=1.0e-03 per=2.3e+01 cost=4.2e+04 flops=4.0e+07
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB t[to_cpu]=1.3e-05S speed=5.9e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
ctns::oper_ab2pq coord=(0,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00153 S rank=0 -----

matrix: Hmat_isweep1 size=(1,1)
     -3.230341791799e+00 

----- TIMING FOR ctns::sweep_opt : 2.623e+00 S -----

Congrats! CTNS calculation finishes successfully. Wed Nov 20 16:31:05 2024

