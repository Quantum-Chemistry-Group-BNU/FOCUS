
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Wed Apr 26 23:21:47 2023

GIT_HASH = ffb8ce9cc88c06d94110d7531314c607c3b4544c

mpisize = 2 maxthreads = 2

input file = results/input.dat

schedule::read fname = results/input.dat
----------------------------------------------------------------------
dtype 0
nelec 5
twoms 1
integral_file moleinfo/fmole.info 
scratch ./scratch

$sci
dets 
0 1 2 3 4 
end
nroots 4
eps0 1.e-6
schedule
0 1.e-2
end
maxiter 6
$end

$ctns
verbose 1
qkind rNSz
nroots 2
maxdets 500 #000
topology_file topology/topo0
thresh_ortho 1.e-8
thresh_proj 1.e-14
schedule
# (n-th, dot, Dcut, dvdson, noise)
0 2 10 1.e-4 1.e-4
1 2 20 1.e-4 0.0
2 2 20 1.e-4 0.0
end
maxsweep 6
task_dmrg
alg_hvec 19
alg_hinter 2
alg_renorm 19
alg_rinter 2
ifdist1
$end

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
nelec = 5
twoms = 1
integral_file = moleinfo/fmole.info

===== params_sci::print =====
nroots = 4
no. of unique seeds = 1
0-th det: 0 1 2 3 4 
flip = 0
eps0 = 1e-06
miniter = 0
maxiter = 6
schedule: iter eps1
0 0.01
1 0.01
2 0.01
3 0.01
4 0.01
5 0.01
convergence parameters
deltaE = 1e-10
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 0
load = 0
ci_file = ci.info
cthrd = 0.01

===== params_ctns::print =====
qkind = rNSz
topology_file = topology/topo0
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
task_rdm = 0
restart_sweep = 0
restart_bond = 0
timestamp = 0
maxdets = 500
thresh_proj = 1.000000e-14
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
nroots = 2
guess = 1
dbranch = 0
maxsweep = 6
maxbond = -1
schedule: isweep, dots, dcut, eps, noise
0 2 10 1.000000e-04 1.000000e-04
1 2 20 1.000000e-04 0.000000e+00
2 2 20 1.000000e-04 0.000000e+00
3 2 20 1.000000e-04 0.000000e+00
4 2 20 1.000000e-04 0.000000e+00
5 2 20 1.000000e-04 0.000000e+00
alg_hvec = 19
alg_hinter = 2
alg_renorm = 19
alg_rinter = 2
alg_decim = 1
alg_comm = 0
ifdist1 = 1
save_formulae = 0
sort_formulae = 0
save_mmtask = 0
mmorder = 0
batchmem = 1.000000e+01
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
precond = 1
rcanon_load = 0
rcanon_file = rcanon_ci.info
iomode = 0
async_fetch = 0
async_save = 0
async_remove = 0
async_tocpu = 0
ifnccl = 0
iroot = 0
nsample = 100000
ndetprt = 10

io::create_scratch scratch=./scratch
gpu_init
rank=1 num_gpus=2 device_id=1 magma_queue=0x2459940
rank=0 num_gpus=2 device_id=0 magma_queue=0x16e7980

ctns::topology::read fname=topology/topo0
0
1
2
3
4

ctns::topology::print ntotal=5 nphysical=5 nbackbone=5
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
rcoord:
 idx=0 coord=(4,0) node: pindex=4 type=0 center=(-1,-1) left=(3,0) right=(-2,-2)
 idx=1 coord=(3,0) node: pindex=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=2 coord=(2,0) node: pindex=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=3 coord=(1,0) node: pindex=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=4 coord=(0,0) node: pindex=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(4,0) rsupport: 4 ; lsupport: 0 1 2 3 
 idx=1 coord=(3,0) rsupport: 3 4 ; lsupport: 0 1 2 
 idx=2 coord=(2,0) rsupport: 2 3 4 ; lsupport: 0 1 
 idx=3 coord=(1,0) rsupport: 1 2 3 4 ; lsupport: 0 
 idx=4 coord=(0,0) rsupport: 0 1 2 3 4 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(4,0) corbs: 4 ; rorbs: ; lorbs: 0 1 2 3 
 idx=1 coord=(3,0) corbs: 3 ; rorbs: 4 ; lorbs: 0 1 2 
 idx=2 coord=(2,0) corbs: 2 ; rorbs: 3 4 ; lorbs: 0 1 
 idx=3 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 ; lorbs: 0 
 idx=4 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9

fci::ci_load fname=./scratch/ci.info

fci::ci_truncate maxdets=500 ifortho=1
 reduction from 52 to 52 dets
 iroot=0 ova=1.000000000000e+00
 iroot=1 ova=1.000000000000e+00
 iroot=2 ova=1.000000000000e+00
 iroot=3 ova=1.000000000000e+00

ctns::rcanon_init qkind=rNSz

ctns::init_rbases rdm_svd=1.500e+00 thresh_proj=1.000e-14

idx=0 node=(4,0) type=0
idx=1 node=(3,0) type=1 rsupport= rsupport=3 4 
4 

idx=2 node=(2,0) type=1 rsupport=2 3 4 
ctns::right_projection<Km> thresh_proj=1.000e-14
ctns::right_projection<Km> thresh_proj=1.000e-14
 qr=(0,0) dimB,dimBi=1,1 popBi=4.359e-01 popBc=4.359e-01 1-popBc=5.641e-01
 qr=(1,-1) dimB,dimBi=2,2 popBi=2.124e-01 popBc=6.483e-01 1-popBc=3.517e-01
 qr=(1,1) dimB,dimBi=2,2 popBi=2.744e-01 popBc=2.744e-01 1-popBc=7.256e-01
 qr=(1,1) dimB,dimBi=2,2 popBi=3.093e-01 popBc=9.576e-01 1-popBc=4.237e-02
 qr=(2,-2) dimB,dimBi=1,1 popBi=8.297e-04 popBc=9.585e-01 1-popBc=4.154e-02
 qr=(2,0) dimB,dimBi=9,8 popBi=5.637e-01 popBc=8.381e-01 1-popBc=1.619e-01
 qr=(2,0) dimB,dimBi=4,4 popBi=3.414e-02 popBc=9.926e-01 1-popBc=7.395e-03
 qr=(2,2) dimB,dimBi=3,3 popBi=1.142e-01 popBc=9.522e-01 1-popBc=4.778e-02
 qr=(2,2) dimB,dimBi=1,1 popBi=4.543e-03 popBc=9.971e-01 1-popBc=2.851e-03
 qr=(3,-1) dimB,dimBi=2,2 popBi=8.276e-04 popBc= qr=9.980e-01 1-popBc=(3,-1) dimB,dimBi=52.024e-03,
4 popBi=9.623e-03 popBc=9.618e-01 1-popBc=3.815e-02
 qr=(3,1) dimB,dimBi=2,2 popBi=1.918e-03 popBc=9.999e-01 1-popBc=1.059e-04
 qr=(4,0) dimB,dimBi=1,1 popBi=1.059e-04 popBc=1.000e+00 1-popBc=0.000e+00
dim(space,lspace,rspace)=52,43,16 dimBc=16 popBc=1.000e+00 SvN=2.045e+00
----- TIMING FOR ctns::right_projection<Km> : 1.132e-03 S -----
 qr=(3,1) dimB,dimBi=9,9 popBi=0.0321 popBc=0.994 1-popBc=0.00605

idx=3 node=(1,0) type= qr=1 rsupport=(3,3) dimB,dimBi=11, 12 popBi= 3 4 
0.000357 popBc=0.994 1-popBc=0.00569
 qr=(4,0) dimB,dimBi=9,8 popBi=0.005 popBc=0.999 1-popBc=0.000688
ctns::right_projection<Km> thresh_proj=1.000e-14
 qr=(4,2) dimB,dimBi=3,3 popBi=5.808e-04 popBc=9.999e-01 1-popBc=1.070e-04
 qr=(5,1) dimB,dimBi=2,2 popBi=1.070e-04 popBc=1.000e+00 1-popBc=0.000e+00
dim(space,lspace,rspace)=52,16,43 dimBc=40 popBc=1.000e+00 SvN=2.857e+00
----- TIMING FOR ctns::right_projection<Km> : 1.347e-03 S -----

idx=4 node=(0,0) type=0 rsupport=0 1 2 3 4 
ctns::right_projection<Km> thresh_proj=1.000e-14
 qr=(3,1) dimB,dimBi=12,4 popBi=7.389e-01 popBc=7.389e-01 1-popBc=2.611e-01
 qr=(4,0) dimB,dimBi=20,4 popBi=2.428e-01 popBc=9.818e-01 1-popBc=1.825e-02
 qr=(5,1) dimB,dimBi=52,4 popBi=1.000e+00 popBc=1.000e+00 1-popBc=1.110e-16
 qr=(4,2) dimB,dimBi=8,4 popBi=1.349e-02 popBc=9.952e-01 1-popBc=4.755e-03
dim(space,lspace,rspace)=52,1,52 dimBc=4 popBc=1.000e+00 SvN=2.000e+00
----- TIMING FOR ctns::right_projection<Km> : 3.625e-04 S -----
 qr=(5,1) dimB,dimBi=12,4 popBi=0.00475 popBc=1 1-popBc=4.44e-16
dim(space,lspace,rspace)=52,4,52 dimBc=16 popBc=1 SvN=2.46
----- TIMING FOR ctns::right_projection<Km> : 6.371e-04 S -----

final rbases with thresh_proj=1e-14
 idx=0 node=(4,0) type=0 shape=4,4
 idx=1 node=(3,0) type=1 shape=16,16
 idx=2 node=(2,0) type=1 shape=43,40
 idx=3 node=(1,0) type=1 shape=52,16
 idx=4 node=(0,0) type=0 shape=52,4
maximum bond dimension = 40
----- TIMING FOR ctns::init_rbases : 2.306e-03 S -----

ctns::init_rsites qkind=rNSz thresh_ortho=1e-08
 idx=0 node=(4,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 TIMING=2.511e-05 S
 idx=1 node=(3,0)[1] shape(l,r,c)=(16,4,4) maxdiff=2.225e-16 TIMING=8.642e-05 S
 idx=2 node=(2,0)[1] shape(l,r,c)=(40,16,4) maxdiff=2.149e-15 TIMING=5.484e-04 S
 idx=3 node=(1,0)[1] shape(l,r,c)=(16,40,4) maxdiff=2.068e-15 TIMING=1.506e-04 S
 idx=4 node=(0,0)[0] shape(l,r,c)=(4,16,4) maxdiff=9.544e-16 TIMING=1.106e-04 S
----- TIMING FOR ctns::init_rsites : 1.126e-03 S -----

ctns::init_rwfuns qkind=rNSz thresh_ortho=1e-08
stensor2: wf2 own=1 _data=0x44c0fb50
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=4
 (5,1):4
 qbond: qcol nsym=1 dimAll=4
 (5,1):4
total no. of nonzero blocks=1 nblocks=1 size=16:0.000122MB

check state overlaps ...
matrix: ova_rwfuns size=(4,4)
      1.0000e+00       4.3975e-17      -1.4861e-17      -2.9534e-17 
      4.3975e-17       1.0000e+00      -7.6138e-17      -1.9686e-16 
     -1.4861e-17      -7.6138e-17       1.0000e+00      -1.0999e-17 
     -2.9534e-17      -1.9686e-16      -1.0999e-17       1.0000e+00 
matrix: ova0_vs size=(4,4)
      1.0000e+00       1.3878e-17      -1.3878e-17       0.0000e+00 
      1.3878e-17       1.0000e+00      -2.7756e-17       0.0000e+00 
     -1.3878e-17      -2.7756e-17       1.0000e+00       8.3267e-17 
      0.0000e+00       0.0000e+00       8.3267e-17       1.0000e+00 
diff of ova matrices = 6.511e-16
----- TIMING FOR ctns::init_rwfuns : 3.450e-04 S -----
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=795:0.00607MB:5.92e-06GB
----- TIMING FOR ctns::rcanon_init : 3.870e-03 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci.info

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.000e+00
 idx=1 node=(3,0) Drow=16 maxdiff=2.225e-16
 idx=2 node=(2,0) Drow=40 maxdiff=2.149e-15
 idx=3 node=(1,0) Drow=16 maxdiff=2.068e-15
 idx=4 node=(0,0) Drow=4 maxdiff=9.544e-16
stensor2: wf2 own=1 _data=0x44c807b0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=4
 (5,1):4
 qbond: qcol nsym=1 dimAll=4
 (5,1):4
total no. of nonzero blocks=1 nblocks=1 size=16:1.221e-04MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(4,4) size=16
 dtensor2: blk_0 size=(4,4) _data=0x44c807b0
      0.0000e+00       1.3878e-17       1.0000e+00      -1.2143e-17 
     -3.9142e-01       4.8389e-01       2.7756e-17      -7.8271e-01 
      4.8368e-01      -6.1542e-01      -1.3878e-17      -6.2235e-01 
     -7.8284e-01      -6.2218e-01      -2.0817e-17       6.8428e-03 
 rwfuns: nroots=4 maxdiff=4.4046e-16
----- TIMING FOR ctns::rcanon_check : 2.903e-04 S -----

integral::load fname = moleinfo/fmole.info
 sorb = 10
 size(int1e) = 100:0.000763MB:7.45e-07GB
 size(int2e) = 1080:0.00824MB:8.05e-06GB
 ecore = 3.4
----- TIMING FOR integral::load_integral : 3.889e-04 S -----

io::remove_scratch scratch=./scratch/sweep
successfully removed ./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=rNSz
fname=./scratch/sweep/cop(4,0) size=1.09e-06GB T[save](info/data/tot)=9.74e-05,4.33e-05,0.000141 speed=0.00774GB/s disk[used]=1.31e-06GB
fname=./scratch/sweep/rop(4,0) size=1.09e-06GB T[save](info/data/tot)=7.15e-05,5.32e-05,0.000125 speed=0.00873GB/s disk[used]=2.62e-06GB
fname=./scratch/sweep/cop(3,0) size=1.09e-06GB T[save](info/data/tot)=7.88e-05,4.81e-05,0.000127 speed=0.00857GB/s disk[used]=3.93e-06GB
fname=./scratch/sweep/cop(2,0) size=1.09e-06GB T[save](info/data/tot)=8.05e-05,4.87e-05,0.000129 speed=0.00842GB/s disk[used]=5.24e-06GB
fname=./scratch/sweep/cop(1,0) size=1.09e-06GB T[save](info/data/tot)=7.96e-05,4.86e-05,0.000128 speed=0.00849GB/s disk[used]=6.55e-06GB
fname=./scratch/sweep/cop(0,0) size=1.09e-06GB T[save](info/data/tot)=7.72e-05,8.01e-05,0.000157 speed=0.00692GB/s disk[used]=7.86e-06GB
fname=./scratch/sweep/lop(0,0) size=1.09e-06GB T[save](info/data/tot)=9.35e-05,5.2e-05,0.000145 speed=0.00748GB/s disk[used]=9.17e-06GB
----- TIMING FOR ctns::oper_init : 4.851e-03 S -----
T[ctns::oper_init](comp/save/tot)=0.00335,0.00128,0.00463

idx=1 coord=(3,0)
 cqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
ctns::oper_renorm coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=872:0.00665MB:6.5e-06GB
rank=0 GPUmem(GB): used=8.67e-06 (oper)=8.67e-06
rank=0 GPUmem(GB): used=8.94e-06 (oper,site)(GB)=8.67e-06,2.68e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 6.521e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=8.94e-06 (oper,site,rinter)=8.67e-06,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00104 S size(rtasks)=37 size(Rlst2)=9 T(Rmu/Rlist)=0.000214,0.000828 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00112 S size(rtasks)=37 size(Rlst)=788 -----
rank=0 GPUmem(GB): used=0.000203 (oper,site,rinter,batch)=8.67e-06,2.68e-07,0,0.000194 blksize=16 blksize0=0 batchsize=788
timing: allocate=6.42e-05 rmmtasks init=0.000994 total=0.00106
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=1.6e-05,0.00132,0.000239 cost=1.56e+04 flops[gemm]=1.18e+07
--- TIMING FOR renorm : t_inter=1.5e-05 t_gemm=0.00132 t_reduction=0.000239 tot=0.00157 ---
 renorm counter=1 i=0 t=0.000371 per=28.1 cost=874 flops=2.36e+06
 renorm counter=1 i=1 t=0.000241 per=18.3 cost=1.76e+03 flops=7.31e+06
 renorm counter=1 i=2 t=0.000229 per=17.3 cost=994 flops=4.34e+06
 renorm counter=1 i=3 t=0.000231 per=17.5 cost=1.75e+03 flops=7.58e+06
 renorm counter=1 i=4 t=1e-06 per=0.0758 cost=0 flops=0
 renorm counter=1 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=1 i=6 t=0.000247 per=18.7 cost=1.02e+04 flops=4.12e+07
 total GEMM cost=1.56e+04 flops=1.18e+07
--- TIMING FOR renorm_tot : t_inter=1.5e-05 t_gemm=0.00132 t_reduction=0.000239 tot=0.00157 ---
 renorm_tot counter=1 i=0 t=0.000371 per=28.1 cost=874 flops=2.36e+06
 renorm_tot counter=1 i=1 t=0.000241 per=18.3 cost=1.76e+03 flops=7.31e+06
 renorm_tot counter=1 i=2 t=0.000229 per=17.3 cost=994 flops=4.34e+06
 renorm_tot counter=1 i=3 t=0.000231 per=17.5 cost=1.75e+03 flops=7.58e+06
 renorm_tot counter=1 i=4 t=1e-06 per=0.0758 cost=0 flops=0
 renorm_tot counter=1 i=5 t=0 per=0 cost=0 flops=-nan
 renorm_tot counter=1 i=6 t=0.000247 per=18.7 cost=1.02e+04 flops=4.12e+07
 total GEMM cost=1.56e+04 flops=1.18e+07
timing: gpu2cpu=1.53e-05 deallocate(site/work)=7.76e-06,1.09e-05 total=2.62e-05
check ||H-H.dagger||=3.511e-16 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0142 S T(init/kernel/comm)=0.000448,0.00478,0.00902 rank=0 -----
##### local: 1.570e-02 S #####
 T(local: fetch) = 1.079e-03 S  per = 6.88  per(accum) = 6.88
 T(local: hdiag) = 0.000e+00 S  per =    0  per(accum) = 6.88
 T(local: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 6.88
 T(local: decim) = 0.000e+00 S  per =    0  per(accum) = 6.88
 T(local: guess) = 0.000e+00 S  per =    0  per(accum) = 6.88
 T(local: renrm) = 1.432e-02 S  per = 91.2  per(accum) = 98.1
 T(local: save ) = 3.002e-04 S  per = 1.91  per(accum) = 100
Detailed decomposition of T(dvdsn): 0.000e+00 S
 T(local: qops_dict memcpy cpu2gpu     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: symbolic_formulae_twodot     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: hintermediate init           ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: hintermediates memcpy cpu2gpu) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: preprocess_hformulae_Hxlist2 ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: hmmtasks init                ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: dvdson solver [Hx_batchGPU]  ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: dvdson solver [communication]) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: dvdson solver [rest part]    ) = 0.000e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 1.425e-02 S
 T(local: qops init                    ) = 4.482e-04 S  per = 3.15  per(accum) = 3.15
 T(local: qops_dict memcpy cpu2gpu     ) = 6.779e-05 S  per = 0.476  per(accum) = 3.62
 T(local: symbolic_formulae_renorm     ) = 6.644e-04 S  per = 4.66  per(accum) = 8.28
 T(local: rintermediate init           ) = 3.974e-05 S  per = 0.279  per(accum) = 8.56
 T(local: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000197  per(accum) = 8.56
 T(local: preprocess_formulae_Rlist2   ) = 1.149e-03 S  per = 8.06  per(accum) = 16.6
 T(local: rmmtasks init                ) = 1.068e-03 S  per = 7.49  per(accum) = 24.1
 T(local: qops memset                  ) = 3.000e-08 S  per = 0.000211  per(accum) = 24.1
 T(local: preprocess_renorm_batchGPU   ) = 1.726e-03 S  per = 12.1  per(accum) = 36.2
 T(local: qops memcpy gpu2cpu          ) = 1.532e-05 S  per = 0.108  per(accum) = 36.3
 T(local: deallocate gpu memory        ) = 4.848e-05 S  per = 0.34  per(accum) = 36.7
 T(local: communication of opS and opH ) = 9.024e-03 S  per = 63.3  per(accum) = 100
##### sweep: 1.570e-02 S #####
 T(sweep: fetch) = 1.079e-03 S  per = 6.88  per(accum) = 6.88
 T(sweep: hdiag) = 0.000e+00 S  per =    0  per(accum) = 6.88
 T(sweep: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 6.88
 T(sweep: decim) = 0.000e+00 S  per =    0  per(accum) = 6.88
 T(sweep: guess) = 0.000e+00 S  per =    0  per(accum) = 6.88
 T(sweep: renrm) = 1.432e-02 S  per = 91.2  per(accum) = 98.1
 T(sweep: save ) = 3.002e-04 S  per = 1.91  per(accum) = 100
Detailed decomposition of T(dvdsn): 0.000e+00 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: symbolic_formulae_twodot     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: hintermediate init           ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: hintermediates memcpy cpu2gpu) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: preprocess_hformulae_Hxlist2 ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: hmmtasks init                ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: dvdson solver [communication]) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: dvdson solver [rest part]    ) = 0.000e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 1.425e-02 S
 T(sweep: qops init                    ) = 4.482e-04 S  per = 3.15  per(accum) = 3.15
 T(sweep: qops_dict memcpy cpu2gpu     ) = 6.779e-05 S  per = 0.476  per(accum) = 3.62
 T(sweep: symbolic_formulae_renorm     ) = 6.644e-04 S  per = 4.66  per(accum) = 8.28
 T(sweep: rintermediate init           ) = 3.974e-05 S  per = 0.279  per(accum) = 8.56
 T(sweep: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000197  per(accum) = 8.56
 T(sweep: preprocess_formulae_Rlist2   ) = 1.149e-03 S  per = 8.06  per(accum) = 16.6
 T(sweep: rmmtasks init                ) = 1.068e-03 S  per = 7.49  per(accum) = 24.1
 T(sweep: qops memset                  ) = 3.000e-08 S  per = 0.000211  per(accum) = 24.1
 T(sweep: preprocess_renorm_batchGPU   ) = 1.726e-03 S  per = 12.1  per(accum) = 36.2
 T(sweep: qops memcpy gpu2cpu          ) = 1.532e-05 S  per = 0.108  per(accum) = 36.3
 T(sweep: deallocate gpu memory        ) = 4.848e-05 S  per = 0.34  per(accum) = 36.7
 T(sweep: communication of opS and opH ) = 9.024e-03 S  per = 63.3  per(accum) = 100

idx=2 coord=(2,0)
 cqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=872:0.00665MB:6.5e-06GB
ctns::oper_renorm coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:6 A:7 B:11 P:3 Q:5 S:4 H:1 
        dim(bra,ket)=40,40 size(op)=252:0.00192MB size(tot)=5680:0.0433MB:4.23e-05GB
rank=0 GPUmem(GB): used=4.99e-05 (oper)=4.99e-05
rank=0 GPUmem(GB): used=5.21e-05 (oper,site)(GB)=4.99e-05,2.18e-06
----- TIMING FOR symbolic_formulae_renorm with size=37 : 4.512e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 5.028e-05 S -----
rank=0 GPUmem(GB): used=5.24e-05 (oper,site,rinter)=4.99e-05,2.18e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00118 S size(rtasks)=37 size(Rlst2)=9 T(Rmu/Rlist)=0.000158,0.00103 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00129 S size(rtasks)=37 size(Rlst)=1088 -----
rank=0 GPUmem(GB): used=0.00144 (oper,site,rinter,batch)=4.99e-05,2.18e-06,2.98e-07,0.00139 blksize=81 blksize0=8 batchsize=1088
timing: allocate=3.77e-05 rmmtasks init=0.00133 total=0.00137
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000226,0.00119,0.000205 cost=2.49e+05 flops[gemm]=2.09e+08
--- TIMING FOR renorm : t_inter=0.000226 t_gemm=0.00119 t_reduction=0.000205 tot=0.00162 ---
 renorm counter=2 i=0 t=0.000232 per=19.5 cost=6.23e+03 flops=2.68e+07
 renorm counter=2 i=1 t=0.000241 per=20.3 cost=1.2e+04 flops=4.99e+07
 renorm counter=2 i=2 t=0.000224 per=18.8 cost=1.87e+04 flops=8.34e+07
 renorm counter=2 i=3 t=0.000233 per=19.6 cost=3.25e+04 flops=1.39e+08
 renorm counter=2 i=4 t=1e-06 per=0.084 cost=0 flops=0
 renorm counter=2 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=2 i=6 t=0.000259 per=21.8 cost=1.79e+05 flops=6.92e+08
 total GEMM cost=2.49e+05 flops=2.09e+08
--- TIMING FOR renorm_tot : t_inter=0.000241 t_gemm=0.00251 t_reduction=0.000444 tot=0.00319 ---
 renorm_tot counter=2 i=0 t=0.000603 per=24 cost=7.1e+03 flops=1.18e+07
 renorm_tot counter=2 i=1 t=0.000482 per=19.2 cost=1.38e+04 flops=2.86e+07
 renorm_tot counter=2 i=2 t=0.000453 per=18 cost=1.97e+04 flops=4.34e+07
 renorm_tot counter=2 i=3 t=0.000464 per=18.5 cost=3.42e+04 flops=7.38e+07
 renorm_tot counter=2 i=4 t=2e-06 per=0.0797 cost=0 flops=0
 renorm_tot counter=2 i=5 t=0 per=0 cost=0 flops=-nan
 renorm_tot counter=2 i=6 t=0.000506 per=20.2 cost=1.89e+05 flops=3.74e+08
 total GEMM cost=2.64e+05 flops=1.05e+08
timing: gpu2cpu=2.46e-05 deallocate(site/work)=3.99e-06,7.17e-06 total=3.18e-05
check ||H-H.dagger||=1.111e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00561 S T(init/kernel/comm)=0.000407,0.00512,8.71e-05 rank=0 -----
##### local: 6.526e-03 S #####
 T(local: fetch) = 5.451e-04 S  per = 8.35  per(accum) = 8.35
 T(local: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.35
 T(local: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.35
 T(local: decim) = 0.000e+00 S  per =    0  per(accum) = 8.35
 T(local: guess) = 0.000e+00 S  per =    0  per(accum) = 8.35
 T(local: renrm) = 5.694e-03 S  per = 87.3  per(accum) = 95.6
 T(local: save ) = 2.865e-04 S  per = 4.39  per(accum) = 100
Detailed decomposition of T(dvdsn): 0.000e+00 S
 T(local: qops_dict memcpy cpu2gpu     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: symbolic_formulae_twodot     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: hintermediate init           ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: hintermediates memcpy cpu2gpu) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: preprocess_hformulae_Hxlist2 ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: hmmtasks init                ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: dvdson solver [Hx_batchGPU]  ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: dvdson solver [communication]) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: dvdson solver [rest part]    ) = 0.000e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 5.609e-03 S
 T(local: qops init                    ) = 4.066e-04 S  per = 7.25  per(accum) = 7.25
 T(local: qops_dict memcpy cpu2gpu     ) = 4.617e-05 S  per = 0.823  per(accum) = 8.07
 T(local: symbolic_formulae_renorm     ) = 4.605e-04 S  per = 8.21  per(accum) = 16.3
 T(local: rintermediate init           ) = 6.337e-05 S  per = 1.13  per(accum) = 17.4
 T(local: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000499  per(accum) = 17.4
 T(local: preprocess_formulae_Rlist2   ) = 1.327e-03 S  per = 23.7  per(accum) = 41.1
 T(local: rmmtasks init                ) = 1.379e-03 S  per = 24.6  per(accum) = 65.6
 T(local: qops memset                  ) = 2.100e-08 S  per = 0.000374  per(accum) = 65.6
 T(local: preprocess_renorm_batchGPU   ) = 1.781e-03 S  per = 31.7  per(accum) = 97.4
 T(local: qops memcpy gpu2cpu          ) = 2.468e-05 S  per = 0.44  per(accum) = 97.8
 T(local: deallocate gpu memory        ) = 3.459e-05 S  per = 0.617  per(accum) = 98.4
 T(local: communication of opS and opH ) = 8.707e-05 S  per = 1.55  per(accum) = 100
##### sweep: 2.222e-02 S #####
 T(sweep: fetch) = 1.624e-03 S  per = 7.31  per(accum) = 7.31
 T(sweep: hdiag) = 0.000e+00 S  per =    0  per(accum) = 7.31
 T(sweep: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 7.31
 T(sweep: decim) = 0.000e+00 S  per =    0  per(accum) = 7.31
 T(sweep: guess) = 0.000e+00 S  per =    0  per(accum) = 7.31
 T(sweep: renrm) = 2.001e-02 S  per = 90.1  per(accum) = 97.4
 T(sweep: save ) = 5.867e-04 S  per = 2.64  per(accum) = 100
Detailed decomposition of T(dvdsn): 0.000e+00 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: symbolic_formulae_twodot     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: hintermediate init           ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: hintermediates memcpy cpu2gpu) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: preprocess_hformulae_Hxlist2 ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: hmmtasks init                ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: dvdson solver [communication]) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: dvdson solver [rest part]    ) = 0.000e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 1.986e-02 S
 T(sweep: qops init                    ) = 8.548e-04 S  per =  4.3  per(accum) = 4.3
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.140e-04 S  per = 0.574  per(accum) = 4.88
 T(sweep: symbolic_formulae_renorm     ) = 1.125e-03 S  per = 5.66  per(accum) = 10.5
 T(sweep: rintermediate init           ) = 1.031e-04 S  per = 0.519  per(accum) = 11.1
 T(sweep: rintermediates memcpy cpu2gpu) = 5.600e-08 S  per = 0.000282  per(accum) = 11.1
 T(sweep: preprocess_formulae_Rlist2   ) = 2.475e-03 S  per = 12.5  per(accum) = 23.5
 T(sweep: rmmtasks init                ) = 2.446e-03 S  per = 12.3  per(accum) = 35.8
 T(sweep: qops memset                  ) = 5.100e-08 S  per = 0.000257  per(accum) = 35.8
 T(sweep: preprocess_renorm_batchGPU   ) = 3.506e-03 S  per = 17.7  per(accum) = 53.5
 T(sweep: qops memcpy gpu2cpu          ) = 4.001e-05 S  per = 0.201  per(accum) = 53.7
 T(sweep: deallocate gpu memory        ) = 8.306e-05 S  per = 0.418  per(accum) = 54.1
 T(sweep: communication of opS and opH ) = 9.111e-03 S  per = 45.9  per(accum) = 100

idx=3 coord=(1,0)
 cqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:6 A:7 B:11 P:3 Q:5 S:4 H:1 
        dim(bra,ket)=40,40 size(op)=252:0.00192MB size(tot)=5680:0.0433MB:4.23e-05GB
ctns::oper_renorm coord=(1,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:8 A:14 B:18 P:0 Q:2 S:2 H:1 
        dim(bra,ket)=16,16 size(op)=64:0.000488MB size(tot)=1472:0.0112MB:1.1e-05GB
rank=0 GPUmem(GB): used=5.44e-05 (oper)=5.44e-05
rank=0 GPUmem(GB): used=5.7e-05 (oper,site)(GB)=5.44e-05,2.65e-06
----- TIMING FOR symbolic_formulae_renorm with size=45 : 3.591e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=45
 no. of rintermediate operators=12
 no. of coefficients=36:0.000275MB:2.68e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 3.979e-05 S -----
rank=0 GPUmem(GB): used=5.73e-05 (oper,site,rinter)=5.44e-05,2.65e-06,2.68e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000668 S size(rtasks)=45 size(Rlst2)=4 T(Rmu/Rlist)=0.000125,0.000542 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000724 S size(rtasks)=45 size(Rlst)=558 -----
rank=0 GPUmem(GB): used=0.00066 (oper,site,rinter,batch)=5.44e-05,2.65e-06,2.68e-07,0.000603 blksize=36 blksize0=72 batchsize=558
timing: allocate=3.35e-05 rmmtasks init=0.000675 total=0.000708
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000218,0.00114,0.000194 cost=2.48e+05 flops[gemm]=2.17e+08
--- TIMING FOR renorm : t_inter=0.000218 t_gemm=0.00114 t_reduction=0.000194 tot=0.00156 ---
 renorm counter=3 i=0 t=0.000226 per=19.8 cost=4.59e+03 flops=2.03e+07
 renorm counter=3 i=1 t=0.00023 per=20.1 cost=8.57e+03 flops=3.73e+07
 renorm counter=3 i=2 t=0.000221 per=19.3 cost=3.44e+04 flops=1.56e+08
 renorm counter=3 i=3 t=0.000229 per=20 cost=9.99e+04 flops=4.36e+08
 renorm counter=3 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=3 i=5 t=1e-06 per=0.0875 cost=0 flops=0
 renorm counter=3 i=6 t=0.000236 per=20.6 cost=1.01e+05 flops=4.28e+08
 total GEMM cost=2.48e+05 flops=2.17e+08
--- TIMING FOR renorm_tot : t_inter=0.000459 t_gemm=0.00365 t_reduction=0.000638 tot=0.00475 ---
 renorm_tot counter=3 i=0 t=0.000829 per=22.7 cost=1.17e+04 flops=1.41e+07
 renorm_tot counter=3 i=1 t=0.000712 per=19.5 cost=2.24e+04 flops=3.14e+07
 renorm_tot counter=3 i=2 t=0.000674 per=18.5 cost=5.41e+04 flops=8.02e+07
 renorm_tot counter=3 i=3 t=0.000693 per=19 cost=1.34e+05 flops=1.94e+08
 renorm_tot counter=3 i=4 t=2e-06 per=0.0547 cost=0 flops=0
 renorm_tot counter=3 i=5 t=1e-06 per=0.0274 cost=0 flops=0
 renorm_tot counter=3 i=6 t=0.000742 per=20.3 cost=2.9e+05 flops=3.91e+08
 total GEMM cost=5.13e+05 flops=1.4e+08
timing: gpu2cpu=1.63e-05 deallocate(site/work)=3.68e-06,5.79e-06 total=2.21e-05
check ||H-H.dagger||=1.241e-15 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.00397 S T(init/kernel/comm)=0.000274,0.00364,5.48e-05 rank=0 -----
##### local: 4.786e-03 S #####
 T(local: fetch) = 5.293e-04 S  per = 11.1  per(accum) = 11.1
 T(local: hdiag) = 0.000e+00 S  per =    0  per(accum) = 11.1
 T(local: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 11.1
 T(local: decim) = 0.000e+00 S  per =    0  per(accum) = 11.1
 T(local: guess) = 0.000e+00 S  per =    0  per(accum) = 11.1
 T(local: renrm) = 4.032e-03 S  per = 84.3  per(accum) = 95.3
 T(local: save ) = 2.244e-04 S  per = 4.69  per(accum) = 100
Detailed decomposition of T(dvdsn): 0.000e+00 S
 T(local: qops_dict memcpy cpu2gpu     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: symbolic_formulae_twodot     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: hintermediate init           ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: hintermediates memcpy cpu2gpu) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: preprocess_hformulae_Hxlist2 ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: hmmtasks init                ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: dvdson solver [Hx_batchGPU]  ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: dvdson solver [communication]) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: dvdson solver [rest part]    ) = 0.000e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 3.972e-03 S
 T(local: qops init                    ) = 2.738e-04 S  per = 6.89  per(accum) = 6.89
 T(local: qops_dict memcpy cpu2gpu     ) = 3.808e-05 S  per = 0.959  per(accum) = 7.85
 T(local: symbolic_formulae_renorm     ) = 3.682e-04 S  per = 9.27  per(accum) = 17.1
 T(local: rintermediate init           ) = 5.830e-05 S  per = 1.47  per(accum) = 18.6
 T(local: rintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 0.00073  per(accum) = 18.6
 T(local: preprocess_formulae_Rlist2   ) = 7.459e-04 S  per = 18.8  per(accum) = 37.4
 T(local: rmmtasks init                ) = 7.163e-04 S  per =   18  per(accum) = 55.4
 T(local: qops memset                  ) = 2.900e-08 S  per = 0.00073  per(accum) = 55.4
 T(local: preprocess_renorm_batchGPU   ) = 1.670e-03 S  per =   42  per(accum) = 97.4
 T(local: qops memcpy gpu2cpu          ) = 1.635e-05 S  per = 0.412  per(accum) = 97.9
 T(local: deallocate gpu memory        ) = 3.047e-05 S  per = 0.767  per(accum) = 98.6
 T(local: communication of opS and opH ) = 5.479e-05 S  per = 1.38  per(accum) = 100
##### sweep: 2.701e-02 S #####
 T(sweep: fetch) = 2.154e-03 S  per = 7.97  per(accum) = 7.97
 T(sweep: hdiag) = 0.000e+00 S  per =    0  per(accum) = 7.97
 T(sweep: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 7.97
 T(sweep: decim) = 0.000e+00 S  per =    0  per(accum) = 7.97
 T(sweep: guess) = 0.000e+00 S  per =    0  per(accum) = 7.97
 T(sweep: renrm) = 2.404e-02 S  per =   89  per(accum) = 97
 T(sweep: save ) = 8.111e-04 S  per =    3  per(accum) = 100
Detailed decomposition of T(dvdsn): 0.000e+00 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: symbolic_formulae_twodot     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: hintermediate init           ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: hintermediates memcpy cpu2gpu) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: preprocess_hformulae_Hxlist2 ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: hmmtasks init                ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: dvdson solver [communication]) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: dvdson solver [rest part]    ) = 0.000e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 2.383e-02 S
 T(sweep: qops init                    ) = 1.129e-03 S  per = 4.74  per(accum) = 4.74
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.520e-04 S  per = 0.638  per(accum) = 5.37
 T(sweep: symbolic_formulae_renorm     ) = 1.493e-03 S  per = 6.27  per(accum) = 11.6
 T(sweep: rintermediate init           ) = 1.614e-04 S  per = 0.677  per(accum) = 12.3
 T(sweep: rintermediates memcpy cpu2gpu) = 8.500e-08 S  per = 0.000357  per(accum) = 12.3
 T(sweep: preprocess_formulae_Rlist2   ) = 3.221e-03 S  per = 13.5  per(accum) = 25.8
 T(sweep: rmmtasks init                ) = 3.163e-03 S  per = 13.3  per(accum) = 39.1
 T(sweep: qops memset                  ) = 8.000e-08 S  per = 0.000336  per(accum) = 39.1
 T(sweep: preprocess_renorm_batchGPU   ) = 5.176e-03 S  per = 21.7  per(accum) = 60.8
 T(sweep: qops memcpy gpu2cpu          ) = 5.636e-05 S  per = 0.237  per(accum) = 61.1
 T(sweep: deallocate gpu memory        ) = 1.135e-04 S  per = 0.476  per(accum) = 61.5
 T(sweep: communication of opS and opH ) = 9.165e-03 S  per = 38.5  per(accum) = 100

idx=4 coord=(0,0)
 cqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:8 A:14 B:18 P:0 Q:2 S:2 H:1 
        dim(bra,ket)=16,16 size(op)=64:0.000488MB size(tot)=1472:0.0112MB:1.1e-05GB
ctns::oper_renorm coord=(0,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:10 A:22 B:28 P:0 Q:0 S:0 H:1 
        dim(bra,ket)=4,4 size(op)=16:0.000122MB size(tot)=304:0.00232MB:2.26e-06GB
rank=0 GPUmem(GB): used=1.43e-05 (oper)=1.43e-05
rank=0 GPUmem(GB): used=1.48e-05 (oper,site)(GB)=1.43e-05,4.77e-07
----- TIMING FOR symbolic_formulae_renorm with size=61 : 2.731e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=61
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=1.48e-05 (oper,site,rinter)=1.43e-05,4.77e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000242 S size(rtasks)=61 size(Rlst2)=1 T(Rmu/Rlist)=0.000118,0.000124 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000263 S size(rtasks)=61 size(Rlst)=116 -----
rank=0 GPUmem(GB): used=4.33e-05 (oper,site,rinter,batch)=1.43e-05,4.77e-07,0,2.85e-05 blksize=16 blksize0=0 batchsize=116
timing: allocate=3.08e-05 rmmtasks init=0.00017 total=0.000201
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=4e-06,0.00111,0.000191 cost=2.96e+04 flops[gemm]=2.66e+07
--- TIMING FOR renorm : t_inter=4e-06 t_gemm=0.00111 t_reduction=0.000191 tot=0.00131 ---
 renorm counter=4 i=0 t=0.000231 per=20.8 cost=704 flops=3.05e+06
 renorm counter=4 i=1 t=0.000222 per=19.9 cost=1.22e+03 flops=5.48e+06
 renorm counter=4 i=2 t=0.000225 per=20.2 cost=3.84e+03 flops=1.71e+07
 renorm counter=4 i=3 t=0.000216 per=19.4 cost=8.96e+03 flops=4.15e+07
 renorm counter=4 i=4 t=1e-06 per=0.0898 cost=0 flops=0
 renorm counter=4 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=4 i=6 t=0.000218 per=19.6 cost=1.48e+04 flops=6.81e+07
 total GEMM cost=2.96e+04 flops=2.66e+07
--- TIMING FOR renorm_tot : t_inter=0.000463 t_gemm=0.00477 t_reduction=0.000829 tot=0.00606 ---
 renorm_tot counter=4 i=0 t=0.00106 per=22.2 cost=1.24e+04 flops=1.17e+07
 renorm_tot counter=4 i=1 t=0.000934 per=19.6 cost=2.36e+04 flops=2.52e+07
 renorm_tot counter=4 i=2 t=0.000899 per=18.9 cost=5.79e+04 flops=6.44e+07
 renorm_tot counter=4 i=3 t=0.000909 per=19.1 cost=1.43e+05 flops=1.57e+08
 renorm_tot counter=4 i=4 t=3e-06 per=0.0629 cost=0 flops=0
 renorm_tot counter=4 i=5 t=1e-06 per=0.021 cost=0 flops=0
 renorm_tot counter=4 i=6 t=0.00096 per=20.1 cost=3.05e+05 flops=3.18e+08
 total GEMM cost=5.42e+05 flops=1.14e+08
timing: gpu2cpu=1.35e-05 deallocate(site/work)=3.59e-06,6.46e-06 total=1.99e-05
check ||H-H.dagger||=1.294e-15 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.00258 S T(init/kernel/comm)=0.000267,0.00228,3.31e-05 rank=0 -----
##### local: 3.373e-03 S #####
 T(local: fetch) = 5.318e-04 S  per = 15.8  per(accum) = 15.8
 T(local: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15.8
 T(local: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15.8
 T(local: decim) = 0.000e+00 S  per =    0  per(accum) = 15.8
 T(local: guess) = 0.000e+00 S  per =    0  per(accum) = 15.8
 T(local: renrm) = 2.622e-03 S  per = 77.7  per(accum) = 93.5
 T(local: save ) = 2.195e-04 S  per = 6.51  per(accum) = 100
Detailed decomposition of T(dvdsn): 0.000e+00 S
 T(local: qops_dict memcpy cpu2gpu     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: symbolic_formulae_twodot     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: hintermediate init           ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: hintermediates memcpy cpu2gpu) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: preprocess_hformulae_Hxlist2 ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: hmmtasks init                ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: dvdson solver [Hx_batchGPU]  ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: dvdson solver [communication]) = 0.000e+00 S  per =    0  per(accum) = 0
 T(local: dvdson solver [rest part]    ) = 0.000e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 2.580e-03 S
 T(local: qops init                    ) = 2.666e-04 S  per = 10.3  per(accum) = 10.3
 T(local: qops_dict memcpy cpu2gpu     ) = 3.228e-05 S  per = 1.25  per(accum) = 11.6
 T(local: symbolic_formulae_renorm     ) = 2.820e-04 S  per = 10.9  per(accum) = 22.5
 T(local: rintermediate init           ) = 2.462e-05 S  per = 0.954  per(accum) = 23.5
 T(local: rintermediates memcpy cpu2gpu) = 3.500e-08 S  per = 0.00136  per(accum) = 23.5
 T(local: preprocess_formulae_Rlist2   ) = 2.713e-04 S  per = 10.5  per(accum) = 34
 T(local: rmmtasks init                ) = 2.078e-04 S  per = 8.06  per(accum) = 42
 T(local: qops memset                  ) = 2.900e-08 S  per = 0.00112  per(accum) = 42
 T(local: preprocess_renorm_batchGPU   ) = 1.416e-03 S  per = 54.9  per(accum) = 97
 T(local: qops memcpy gpu2cpu          ) = 1.353e-05 S  per = 0.524  per(accum) = 97.5
 T(local: deallocate gpu memory        ) = 3.201e-05 S  per = 1.24  per(accum) = 98.7
 T(local: communication of opS and opH ) = 3.307e-05 S  per = 1.28  per(accum) = 100
##### sweep: 3.038e-02 S #####
 T(sweep: fetch) = 2.685e-03 S  per = 8.84  per(accum) = 8.84
 T(sweep: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.84
 T(sweep: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.84
 T(sweep: decim) = 0.000e+00 S  per =    0  per(accum) = 8.84
 T(sweep: guess) = 0.000e+00 S  per =    0  per(accum) = 8.84
 T(sweep: renrm) = 2.667e-02 S  per = 87.8  per(accum) = 96.6
 T(sweep: save ) = 1.031e-03 S  per = 3.39  per(accum) = 100
Detailed decomposition of T(dvdsn): 0.000e+00 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: symbolic_formulae_twodot     ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: hintermediate init           ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: hintermediates memcpy cpu2gpu) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: preprocess_hformulae_Hxlist2 ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: hmmtasks init                ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: dvdson solver [communication]) = 0.000e+00 S  per =    0  per(accum) = 0
 T(sweep: dvdson solver [rest part]    ) = 0.000e+00 S  per =    0  per(accum) = 0
Detailed decomposition of T(renrm): 2.641e-02 S
 T(sweep: qops init                    ) = 1.395e-03 S  per = 5.28  per(accum) = 5.28
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.843e-04 S  per = 0.698  per(accum) = 5.98
 T(sweep: symbolic_formulae_renorm     ) = 1.775e-03 S  per = 6.72  per(accum) = 12.7
 T(sweep: rintermediate init           ) = 1.860e-04 S  per = 0.704  per(accum) = 13.4
 T(sweep: rintermediates memcpy cpu2gpu) = 1.200e-07 S  per = 0.000454  per(accum) = 13.4
 T(sweep: preprocess_formulae_Rlist2   ) = 3.493e-03 S  per = 13.2  per(accum) = 26.6
 T(sweep: rmmtasks init                ) = 3.371e-03 S  per = 12.8  per(accum) = 39.4
 T(sweep: qops memset                  ) = 1.090e-07 S  per = 0.000413  per(accum) = 39.4
 T(sweep: preprocess_renorm_batchGPU   ) = 6.592e-03 S  per =   25  per(accum) = 64.4
 T(sweep: qops memcpy gpu2cpu          ) = 6.989e-05 S  per = 0.265  per(accum) = 64.6
 T(sweep: deallocate gpu memory        ) = 1.455e-04 S  per = 0.551  per(accum) = 65.2
 T(sweep: communication of opS and opH ) = 9.199e-03 S  per = 34.8  per(accum) = 100
----- TIMING FOR ctns::oper_env_right : 3.674e-02 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.00493,0.00268,0.0267,0.00103,0.0353
matrix: Hij size=(4,4)
     -2.65451697e+00      -1.60902199e-15       2.83441381e-16       6.05384936e-16 
     -1.64357742e-15      -2.27865403e+00       2.96486167e-15      -2.99426040e-16 
      2.98522709e-16       2.71118617e-15      -2.24308285e+00       1.56174551e-15 
      6.86270643e-16      -8.54667572e-16       7.76841993e-16      -1.91229192e+00 
matrix: Sij size=(4,4)
      1.0000e+00       2.8439e-16       2.6873e-17       9.5627e-17 
      2.8927e-16       1.0000e+00      -2.7713e-16      -3.3827e-16 
      3.8128e-17      -2.5541e-16       1.0000e+00      -5.8870e-16 
      7.5244e-17      -2.8363e-16      -5.8513e-16       1.0000e+00 

ctns::sweep_opt maxsweep=6

ctns::topology::get_sweeps
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=3 bond=(1,0)-(2,0) forward=0 cturn=0
..... end of get_sweeps .....

======================================================================
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0.0001
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.012e-07GB
 sites: len=5 mem=692:0.00528MB:5.156e-06GB
 rwfuns: len=4 mem=16:0.0001221MB:1.192e-07GB
 cpsi: len=2 mem=178:0.001358MB:1.326e-06GB
total mem of comb=913:0.006966MB:6.802e-06GB

isweep=0 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=146:0.001114MB:1.088e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.0002747MB size(tot)=872:0.006653MB:6.497e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=146:0.001114MB:1.088e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=146:0.001114MB:1.088e-06GB
 qops(tot)=1310:0.009995MB:9.76e-06GB
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.0007629MB
stensor4: wf own=1 _data=0x44a10750
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (0,0):1 (1,-1):2 (1,1):2 (2,-2):1 (2,0):4 (2,2):1 (3,-1):2 (3,1):2 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.0007629MB
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
### DIAG TIMING: total=0.0004101 t1=8.262e-06, t2=1.372e-05, t3=6.05e-05, t4=0.0002134, t5=6.753e-05, t6=3.077e-05, t7=1.302e-05, t8=2.95e-06
duration_diagGPU:0.0004264
duration_diagreduce:0.000584
duration_diagtransform:3.423e-06
rank=0 GPUmem(GB): used=9.76e-06 (oper)=9.76e-06
----- TIMING FOR symbolic_formulae_twodot with size=93 : 6.228e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=93
 no. of hintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.384e-05 S -----
rank=0 GPUmem(GB): used=1.01e-05 (oper,hinter)=9.76e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00345 S size(H_formulae)=93 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000186,0.00326 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00372 S size(H_formulae)=93 size(Hxlst)=3134 -----
rank=0 GPUmem(GB): used=0.000409 (oper,hinter,dvdson,batch)=9.76e-06,2.98e-07,1.49e-06,0.000397 blksize=4 blksize0=8 batchsize=3134
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.3e-05,0.000229,0.00206,0.000204 cost=4.22e+04 flops[gemm]=2.05e+07
--- TIMING FOR sigma : t_inter=0.000229 t_gemm=0.00206 t_reduction=0.000204 tot=0.00249 ---
 sigma counter=1 i=0 t=0.000263 per=12.8 cost=3.72e+03 flops=1.41e+07
 sigma counter=1 i=1 t=0.000256 per=12.4 cost=3.74e+03 flops=1.46e+07
 sigma counter=1 i=2 t=0.000247 per=12 cost=3.04e+03 flops=1.23e+07
 sigma counter=1 i=3 t=0.000242 per=11.8 cost=3.03e+03 flops=1.25e+07
 sigma counter=1 i=4 t=0.000259 per=12.6 cost=1e+04 flops=3.86e+07
 sigma counter=1 i=5 t=0.000261 per=12.7 cost=1e+04 flops=3.83e+07
 sigma counter=1 i=6 t=0.000274 per=13.3 cost=4.34e+03 flops=1.58e+07
 sigma counter=1 i=7 t=0.000257 per=12.5 cost=4.32e+03 flops=1.68e+07
 total GEMM cost=4.22e+04 flops=2.05e+07
--- TIMING FOR sigma_tot : t_inter=0.000229 t_gemm=0.00206 t_reduction=0.000204 tot=0.00249 ---
 sigma_tot counter=1 i=0 t=0.000263 per=12.8 cost=3.72e+03 flops=1.41e+07
 sigma_tot counter=1 i=1 t=0.000256 per=12.4 cost=3.74e+03 flops=1.46e+07
 sigma_tot counter=1 i=2 t=0.000247 per=12 cost=3.04e+03 flops=1.23e+07
 sigma_tot counter=1 i=3 t=0.000242 per=11.8 cost=3.03e+03 flops=1.25e+07
 sigma_tot counter=1 i=4 t=0.000259 per=12.6 cost=1e+04 flops=3.86e+07
 sigma_tot counter=1 i=5 t=0.000261 per=12.7 cost=1e+04 flops=3.83e+07
 sigma_tot counter=1 i=6 t=0.000274 per=13.3 cost=4.34e+03 flops=1.58e+07
 sigma_tot counter=1 i=7 t=0.000257 per=12.5 cost=4.32e+03 flops=1.68e+07
 total GEMM cost=4.22e+04 flops=2.05e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.1e-05,0.000224,0.00203,0.000196 cost=4.22e+04 flops[gemm]=2.08e+07
--- TIMING FOR sigma : t_inter=0.000224 t_gemm=0.00203 t_reduction=0.000196 tot=0.00245 ---
 sigma counter=2 i=0 t=0.000255 per=12.6 cost=3.72e+03 flops=1.46e+07
 sigma counter=2 i=1 t=0.000265 per=13.1 cost=3.74e+03 flops=1.41e+07
 sigma counter=2 i=2 t=0.000245 per=12.1 cost=3.04e+03 flops=1.24e+07
 sigma counter=2 i=3 t=0.000241 per=11.9 cost=3.03e+03 flops=1.26e+07
 sigma counter=2 i=4 t=0.000258 per=12.7 cost=1e+04 flops=3.88e+07
 sigma counter=2 i=5 t=0.000257 per=12.7 cost=1e+04 flops=3.89e+07
 sigma counter=2 i=6 t=0.00026 per=12.8 cost=4.34e+03 flops=1.67e+07
 sigma counter=2 i=7 t=0.000249 per=12.3 cost=4.32e+03 flops=1.73e+07
 total GEMM cost=4.22e+04 flops=2.08e+07
--- TIMING FOR sigma_tot : t_inter=0.000453 t_gemm=0.00409 t_reduction=0.0004 tot=0.00494 ---
 sigma_tot counter=2 i=0 t=0.000518 per=12.7 cost=7.43e+03 flops=1.43e+07
 sigma_tot counter=2 i=1 t=0.000521 per=12.7 cost=7.47e+03 flops=1.43e+07
 sigma_tot counter=2 i=2 t=0.000492 per=12 cost=6.07e+03 flops=1.23e+07
 sigma_tot counter=2 i=3 t=0.000483 per=11.8 cost=6.05e+03 flops=1.25e+07
 sigma_tot counter=2 i=4 t=0.000517 per=12.6 cost=2e+04 flops=3.87e+07
 sigma_tot counter=2 i=5 t=0.000518 per=12.7 cost=2e+04 flops=3.86e+07
 sigma_tot counter=2 i=6 t=0.000534 per=13.1 cost=8.67e+03 flops=1.62e+07
 sigma_tot counter=2 i=7 t=0.000506 per=12.4 cost=8.63e+03 flops=1.71e+07
 total GEMM cost=8.43e+04 flops=2.06e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966941 -1.003e+03  4.479e-05    2     2  5.424e-03 2.712e-03
    1   1 +      -2.278654025976 -1.002e+03  6.714e-05    2     2  5.424e-03 2.712e-03
TIMING FOR Davidson : 5.513e-03  T(cal/comm/rest)=5.343e-03,7.757e-06,1.628e-04
optimized energies: isweep=0 dots=2 ibond=0 e[0]=-2.65451696694 nmvp=2
optimized energies: isweep=0 dots=2 ibond=0 e[1]=-2.27865402598 nmvp=2
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row_nkr dcut=10 nqr=9 alg_decim=1 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep0_ibond0.txt
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
----- TMING FOR decimation_genbasis: 5.1e-04 S T(scatter/comp/gather)=6.8e-05,3.5e-05,4.0e-04 -----
decimation summary: 16->10 dwt=+2.889e-03 SvN=1.645e+00
 qbond: qkept nsym=6 dimAll=10
 (2,0):4 (3,1):2 (1,1):1 (3,-1):1 (4,0):1 (2,2):1
----- TIMING for decimation_row: 7.802e-04 S T(decim/formRot)=5.699e-04,2.103e-04 -----
TIMING FOR decimation: 1.123e-03 S T(wf/decim)=3.304e-04,7.929e-04
ctns::oper_renorm coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:1.831e-04MB size(tot)=450:3.433e-03MB:3.353e-06GB
rank=0 GPUmem(GB): used=6.914e-06 (oper)=5.528e-06
rank=0 GPUmem(GB): used=7.108e-06 (oper,site)(GB)=5.528e-06,1.937e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 5.896e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=7.11e-06 (oper,site,rinter)=5.53e-06,1.94e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000792 S size(rtasks)=37 size(Rlst2)=6 T(Rmu/Rlist)=0.000198,0.000594 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000853 S size(rtasks)=37 size(Rlst)=605 -----
rank=0 GPUmem(GB): used=0.000156 (oper,site,rinter,batch)=5.53e-06,1.94e-07,0,0.000149 blksize=16 blksize0=0 batchsize=605
timing: allocate=3.61e-05 rmmtasks init=0.000754 total=0.00079
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=5e-06,0.00116,0.000201 cost=1.17e+04 flops[gemm]=1.01e+07
--- TIMING FOR renorm : t_inter=5e-06 t_gemm=0.00116 t_reduction=0.000201 tot=0.00137 ---
 renorm counter=1 i=0 t=0.000241 per=20.7 cost=824 flops=3.42e+06
 renorm counter=1 i=1 t=0.000227 per=19.5 cost=1.12e+03 flops=4.92e+06
 renorm counter=1 i=2 t=1e-06 per=0.0859 cost=0 flops=0
 renorm counter=1 i=3 t=1e-06 per=0.0859 cost=0 flops=0
 renorm counter=1 i=4 t=0.00022 per=18.9 cost=766 flops=3.48e+06
 renorm counter=1 i=5 t=0.000224 per=19.2 cost=1.26e+03 flops=5.62e+06
 renorm counter=1 i=6 t=0.00025 per=21.5 cost=7.77e+03 flops=3.11e+07
 total GEMM cost=1.17e+04 flops=1.01e+07
--- TIMING FOR renorm_tot : t_inter=5e-06 t_gemm=0.00116 t_reduction=0.000201 tot=0.00137 ---
 renorm_tot counter=1 i=0 t=0.000241 per=20.7 cost=824 flops=3.42e+06
 renorm_tot counter=1 i=1 t=0.000227 per=19.5 cost=1.12e+03 flops=4.92e+06
 renorm_tot counter=1 i=2 t=1e-06 per=0.0859 cost=0 flops=0
 renorm_tot counter=1 i=3 t=1e-06 per=0.0859 cost=0 flops=0
 renorm_tot counter=1 i=4 t=0.00022 per=18.9 cost=766 flops=3.48e+06
 renorm_tot counter=1 i=5 t=0.000224 per=19.2 cost=1.26e+03 flops=5.62e+06
 renorm_tot counter=1 i=6 t=0.00025 per=21.5 cost=7.77e+03 flops=3.11e+07
 total GEMM cost=1.17e+04 flops=1.01e+07
timing: gpu2cpu=1.47e-05 deallocate(site/work)=4.72e-06,7.44e-06 total=2.22e-05
check ||H-H.dagger||=4.441e-16 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.00427 S T(init/kernel/comm)=0.000319,0.00389,6.23e-05 rank=0 -----
TIMING FOR cleanup: 0.000304 T(erase/save/remove)=8.61e-05,0.000158,6.03e-05
##### local: 2.460e-02 S #####
 T(local: fetch) = 1.940e-03 S  per = 7.89  per(accum) = 7.89
 T(local: hdiag) = 1.151e-03 S  per = 4.68  per(accum) = 12.6
 T(local: dvdsn) = 1.509e-02 S  per = 61.4  per(accum) = 73.9
 T(local: decim) = 1.200e-03 S  per = 4.88  per(accum) = 78.8
 T(local: guess) = 4.894e-04 S  per = 1.99  per(accum) = 80.8
 T(local: renrm) = 4.409e-03 S  per = 17.9  per(accum) = 98.7
 T(local: save ) = 3.178e-04 S  per = 1.29  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.396e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 2.087e-05 S  per = 0.149  per(accum) = 0.149
 T(local: symbolic_formulae_twodot     ) = 6.357e-04 S  per = 4.55  per(accum) = 4.7
 T(local: hintermediate init           ) = 5.857e-05 S  per = 0.419  per(accum) = 5.12
 T(local: hintermediates memcpy cpu2gpu) = 3.100e-08 S  per = 0.000222  per(accum) = 5.12
 T(local: preprocess_hformulae_Hxlist2 ) = 3.827e-03 S  per = 27.4  per(accum) = 32.5
 T(local: hmmtasks init                ) = 3.909e-03 S  per =   28  per(accum) = 60.5
 T(local: dvdson solver [Hx_batchGPU]  ) = 5.343e-03 S  per = 38.3  per(accum) = 98.8
 T(local: dvdson solver [communication]) = 7.757e-06 S  per = 0.0555  per(accum) = 98.8
 T(local: dvdson solver [rest part]    ) = 1.628e-04 S  per = 1.17  per(accum) = 100
Detailed decomposition of T(renrm): 4.272e-03 S
 T(local: qops init                    ) = 3.190e-04 S  per = 7.47  per(accum) = 7.47
 T(local: qops_dict memcpy cpu2gpu     ) = 3.709e-05 S  per = 0.868  per(accum) = 8.33
 T(local: symbolic_formulae_renorm     ) = 5.995e-04 S  per =   14  per(accum) = 22.4
 T(local: rintermediate init           ) = 2.547e-05 S  per = 0.596  per(accum) = 23
 T(local: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000655  per(accum) = 23
 T(local: preprocess_formulae_Rlist2   ) = 8.760e-04 S  per = 20.5  per(accum) = 43.5
 T(local: rmmtasks init                ) = 7.983e-04 S  per = 18.7  per(accum) = 62.1
 T(local: qops memset                  ) = 2.800e-08 S  per = 0.000655  per(accum) = 62.2
 T(local: preprocess_renorm_batchGPU   ) = 1.499e-03 S  per = 35.1  per(accum) = 97.2
 T(local: qops memcpy gpu2cpu          ) = 1.478e-05 S  per = 0.346  per(accum) = 97.6
 T(local: deallocate gpu memory        ) = 4.111e-05 S  per = 0.962  per(accum) = 98.5
 T(local: communication of opS and opH ) = 6.230e-05 S  per = 1.46  per(accum) = 100
##### sweep: 2.460e-02 S #####
 T(sweep: fetch) = 1.940e-03 S  per = 7.89  per(accum) = 7.89
 T(sweep: hdiag) = 1.151e-03 S  per = 4.68  per(accum) = 12.6
 T(sweep: dvdsn) = 1.509e-02 S  per = 61.4  per(accum) = 73.9
 T(sweep: decim) = 1.200e-03 S  per = 4.88  per(accum) = 78.8
 T(sweep: guess) = 4.894e-04 S  per = 1.99  per(accum) = 80.8
 T(sweep: renrm) = 4.409e-03 S  per = 17.9  per(accum) = 98.7
 T(sweep: save ) = 3.178e-04 S  per = 1.29  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.396e-02 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 2.087e-05 S  per = 0.149  per(accum) = 0.149
 T(sweep: symbolic_formulae_twodot     ) = 6.357e-04 S  per = 4.55  per(accum) = 4.7
 T(sweep: hintermediate init           ) = 5.857e-05 S  per = 0.419  per(accum) = 5.12
 T(sweep: hintermediates memcpy cpu2gpu) = 3.100e-08 S  per = 0.000222  per(accum) = 5.12
 T(sweep: preprocess_hformulae_Hxlist2 ) = 3.827e-03 S  per = 27.4  per(accum) = 32.5
 T(sweep: hmmtasks init                ) = 3.909e-03 S  per =   28  per(accum) = 60.5
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 5.343e-03 S  per = 38.3  per(accum) = 98.8
 T(sweep: dvdson solver [communication]) = 7.757e-06 S  per = 0.0555  per(accum) = 98.8
 T(sweep: dvdson solver [rest part]    ) = 1.628e-04 S  per = 1.17  per(accum) = 100
Detailed decomposition of T(renrm): 4.272e-03 S
 T(sweep: qops init                    ) = 3.190e-04 S  per = 7.47  per(accum) = 7.47
 T(sweep: qops_dict memcpy cpu2gpu     ) = 3.709e-05 S  per = 0.868  per(accum) = 8.33
 T(sweep: symbolic_formulae_renorm     ) = 5.995e-04 S  per =   14  per(accum) = 22.4
 T(sweep: rintermediate init           ) = 2.547e-05 S  per = 0.596  per(accum) = 23
 T(sweep: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000655  per(accum) = 23
 T(sweep: preprocess_formulae_Rlist2   ) = 8.760e-04 S  per = 20.5  per(accum) = 43.5
 T(sweep: rmmtasks init                ) = 7.983e-04 S  per = 18.7  per(accum) = 62.1
 T(sweep: qops memset                  ) = 2.800e-08 S  per = 0.000655  per(accum) = 62.2
 T(sweep: preprocess_renorm_batchGPU   ) = 1.499e-03 S  per = 35.1  per(accum) = 97.2
 T(sweep: qops memcpy gpu2cpu          ) = 1.478e-05 S  per = 0.346  per(accum) = 97.6
 T(sweep: deallocate gpu memory        ) = 4.111e-05 S  per = 0.962  per(accum) = 98.5
 T(sweep: communication of opS and opH ) = 6.230e-05 S  per = 1.46  per(accum) = 100
##### global: 2.460e-02 S #####
 T(global: fetch) = 1.940e-03 S  per = 7.89  per(accum) = 7.89
 T(global: hdiag) = 1.151e-03 S  per = 4.68  per(accum) = 12.6
 T(global: dvdsn) = 1.509e-02 S  per = 61.4  per(accum) = 73.9
 T(global: decim) = 1.200e-03 S  per = 4.88  per(accum) = 78.8
 T(global: guess) = 4.894e-04 S  per = 1.99  per(accum) = 80.8
 T(global: renrm) = 4.409e-03 S  per = 17.9  per(accum) = 98.7
 T(global: save ) = 3.178e-04 S  per = 1.29  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.396e-02 S
 T(global: qops_dict memcpy cpu2gpu     ) = 2.087e-05 S  per = 0.149  per(accum) = 0.149
 T(global: symbolic_formulae_twodot     ) = 6.357e-04 S  per = 4.55  per(accum) = 4.7
 T(global: hintermediate init           ) = 5.857e-05 S  per = 0.419  per(accum) = 5.12
 T(global: hintermediates memcpy cpu2gpu) = 3.100e-08 S  per = 0.000222  per(accum) = 5.12
 T(global: preprocess_hformulae_Hxlist2 ) = 3.827e-03 S  per = 27.4  per(accum) = 32.5
 T(global: hmmtasks init                ) = 3.909e-03 S  per =   28  per(accum) = 60.5
 T(global: dvdson solver [Hx_batchGPU]  ) = 5.343e-03 S  per = 38.3  per(accum) = 98.8
 T(global: dvdson solver [communication]) = 7.757e-06 S  per = 0.0555  per(accum) = 98.8
 T(global: dvdson solver [rest part]    ) = 1.628e-04 S  per = 1.17  per(accum) = 100
Detailed decomposition of T(renrm): 4.272e-03 S
 T(global: qops init                    ) = 3.190e-04 S  per = 7.47  per(accum) = 7.47
 T(global: qops_dict memcpy cpu2gpu     ) = 3.709e-05 S  per = 0.868  per(accum) = 8.33
 T(global: symbolic_formulae_renorm     ) = 5.995e-04 S  per =   14  per(accum) = 22.4
 T(global: rintermediate init           ) = 2.547e-05 S  per = 0.596  per(accum) = 23
 T(global: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000655  per(accum) = 23
 T(global: preprocess_formulae_Rlist2   ) = 8.760e-04 S  per = 20.5  per(accum) = 43.5
 T(global: rmmtasks init                ) = 7.983e-04 S  per = 18.7  per(accum) = 62.1
 T(global: qops memset                  ) = 2.800e-08 S  per = 0.000655  per(accum) = 62.2
 T(global: preprocess_renorm_batchGPU   ) = 1.499e-03 S  per = 35.1  per(accum) = 97.2
 T(global: qops memcpy gpu2cpu          ) = 1.478e-05 S  per = 0.346  per(accum) = 97.6
 T(global: deallocate gpu memory        ) = 4.111e-05 S  per = 0.962  per(accum) = 98.5
 T(global: communication of opS and opH ) = 6.230e-05 S  per = 1.46  per(accum) = 100

isweep=0 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=450:0.00343MB:3.35e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=888:0.00677MB:6.62e-06GB
wf4(diml,dimr,dimc1,dimc2)=(10,4,4,4) nnz=78:0.000595MB
stensor4: wf own=1 _data=0x449cfb20
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=6 dimAll=10
 (2,0):4 (3,1):2 (1,1):1 (3,-1):1 (4,0):1 (2,2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=42 nblocks=384 size=78:0.000595MB
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
### DIAG TIMING: total=0.000359 t1=8.39e-06, t2=1.34e-05, t3=4.36e-05, t4=0.000125, t5=0.000127, t6=2.55e-05, t7=1.25e-05, t8=3.34e-06
duration_diagGPU:0.000374
duration_diagreduce:4.22e-06
duration_diagtransform:1.5e-06
rank=0 GPUmem(GB): used=6.62e-06 (oper)=6.62e-06
----- TIMING FOR symbolic_formulae_twodot with size=95 : 6.535e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=95
 no. of hintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.508e-05 S -----
rank=0 GPUmem(GB): used=6.94e-06 (oper,hinter)=6.62e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00271 S size(H_formulae)=95 size(Hxlst2)=42 T(Hmu/Hxlist)=0.000188,0.00252 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00292 S size(H_formulae)=95 size(Hxlst)=2418 -----
rank=0 GPUmem(GB): used=0.000314 (oper,hinter,dvdson,batch)=6.62e-06,3.28e-07,1.16e-06,0.000306 blksize=4 blksize0=8 batchsize=2418
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=78 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000226,0.00197,0.000205 cost=2.86e+04 flops[gemm]=1.46e+07
--- TIMING FOR sigma : t_inter=0.000226 t_gemm=0.00196 t_reduction=0.000205 tot=0.0024 ---
 sigma counter=3 i=0 t=0.000245 per=12.5 cost=1.91e+03 flops=7.79e+06
 sigma counter=3 i=1 t=0.000246 per=12.5 cost=1.9e+03 flops=7.71e+06
 sigma counter=3 i=2 t=0.000242 per=12.3 cost=2.77e+03 flops=1.14e+07
 sigma counter=3 i=3 t=0.000244 per=12.4 cost=2.8e+03 flops=1.15e+07
 sigma counter=3 i=4 t=0.000248 per=12.6 cost=3.03e+03 flops=1.22e+07
 sigma counter=3 i=5 t=0.000245 per=12.5 cost=3.06e+03 flops=1.25e+07
 sigma counter=3 i=6 t=0.000251 per=12.8 cost=6.58e+03 flops=2.62e+07
 sigma counter=3 i=7 t=0.000244 per=12.4 cost=6.58e+03 flops=2.7e+07
 total GEMM cost=2.86e+04 flops=1.46e+07
--- TIMING FOR sigma_tot : t_inter=0.000679 t_gemm=0.00605 t_reduction=0.000605 tot=0.00734 ---
 sigma_tot counter=3 i=0 t=0.000763 per=12.6 cost=9.34e+03 flops=1.22e+07
 sigma_tot counter=3 i=1 t=0.000767 per=12.7 cost=9.37e+03 flops=1.22e+07
 sigma_tot counter=3 i=2 t=0.000734 per=12.1 cost=8.84e+03 flops=1.2e+07
 sigma_tot counter=3 i=3 t=0.000727 per=12 cost=8.85e+03 flops=1.22e+07
 sigma_tot counter=3 i=4 t=0.000765 per=12.6 cost=2.3e+04 flops=3.01e+07
 sigma_tot counter=3 i=5 t=0.000763 per=12.6 cost=2.31e+04 flops=3.02e+07
 sigma_tot counter=3 i=6 t=0.000785 per=13 cost=1.53e+04 flops=1.94e+07
 sigma_tot counter=3 i=7 t=0.00075 per=12.4 cost=1.52e+04 flops=2.03e+07
 total GEMM cost=1.13e+05 flops=1.87e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.00021,0.00194,0.000205 cost=2.86e+04 flops[gemm]=1.47e+07
--- TIMING FOR sigma : t_inter=0.00021 t_gemm=0.00195 t_reduction=0.000204 tot=0.00236 ---
 sigma counter=4 i=0 t=0.000236 per=12.1 cost=1.91e+03 flops=8.08e+06
 sigma counter=4 i=1 t=0.000241 per=12.4 cost=1.9e+03 flops=7.87e+06
 sigma counter=4 i=2 t=0.000243 per=12.5 cost=2.77e+03 flops=1.14e+07
 sigma counter=4 i=3 t=0.000242 per=12.4 cost=2.8e+03 flops=1.16e+07
 sigma counter=4 i=4 t=0.000244 per=12.5 cost=3.03e+03 flops=1.24e+07
 sigma counter=4 i=5 t=0.000242 per=12.4 cost=3.06e+03 flops=1.27e+07
 sigma counter=4 i=6 t=0.000252 per=13 cost=6.58e+03 flops=2.61e+07
 sigma counter=4 i=7 t=0.000245 per=12.6 cost=6.58e+03 flops=2.69e+07
 total GEMM cost=2.86e+04 flops=1.47e+07
--- TIMING FOR sigma_tot : t_inter=0.000889 t_gemm=0.008 t_reduction=0.000809 tot=0.0097 ---
 sigma_tot counter=4 i=0 t=0.000999 per=12.5 cost=1.12e+04 flops=1.13e+07
 sigma_tot counter=4 i=1 t=0.00101 per=12.6 cost=1.13e+04 flops=1.12e+07
 sigma_tot counter=4 i=2 t=0.000977 per=12.2 cost=1.16e+04 flops=1.19e+07
 sigma_tot counter=4 i=3 t=0.000969 per=12.1 cost=1.16e+04 flops=1.2e+07
 sigma_tot counter=4 i=4 t=0.00101 per=12.6 cost=2.61e+04 flops=2.58e+07
 sigma_tot counter=4 i=5 t=0.00101 per=12.6 cost=2.61e+04 flops=2.6e+07
 sigma_tot counter=4 i=6 t=0.00104 per=13 cost=2.18e+04 flops=2.11e+07
 sigma_tot counter=4 i=7 t=0.000995 per=12.4 cost=2.18e+04 flops=2.19e+07
 total GEMM cost=1.42e+05 flops=1.77e+07
settings: ndim=78 neig=2 maxcycle=30 nbuff=4 memory=1.05e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.650929829175 -1.003e+03  1.399e-02    2     2  5.304e-03 2.652e-03
    1   1 -      -2.272369775297 -1.002e+03  1.987e-02    2     2  5.304e-03 2.652e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=3.400e-05,2.150e-04,1.996e-03,1.990e-04 cost=2.862e+04 flops[gemm]=1.434e+07
--- TIMING FOR sigma : t_inter=2.150e-04 t_gemm=1.995e-03 t_reduction=1.990e-04 tot=2.409e-03 ---
 sigma counter=5 i=0 t=2.470e-04 per=1.238e+01 cost=1.908e+03 flops=7.725e+06
 sigma counter=5 i=1 t=2.410e-04 per=1.208e+01 cost=1.896e+03 flops=7.867e+06
 sigma counter=5 i=2 t=2.500e-04 per=1.253e+01 cost=2.768e+03 flops=1.107e+07
 sigma counter=5 i=3 t=2.470e-04 per=1.238e+01 cost=2.796e+03 flops=1.132e+07
 sigma counter=5 i=4 t=2.480e-04 per=1.243e+01 cost=3.028e+03 flops=1.221e+07
 sigma counter=5 i=5 t=2.490e-04 per=1.248e+01 cost=3.064e+03 flops=1.231e+07
 sigma counter=5 i=6 t=2.570e-04 per=1.288e+01 cost=6.580e+03 flops=2.560e+07
 sigma counter=5 i=7 t=2.560e-04 per=1.283e+01 cost=6.580e+03 flops=2.570e+07
 total GEMM cost=2.862e+04 flops=1.435e+07
--- TIMING FOR sigma_tot : t_inter=1.104e-03 t_gemm=9.994e-03 t_reduction=1.008e-03 tot=1.211e-02 ---
 sigma_tot counter=5 i=0 t=1.246e-03 per=1.247e+01 cost=1.316e+04 flops=1.056e+07
 sigma_tot counter=5 i=1 t=1.249e-03 per=1.250e+01 cost=1.316e+04 flops=1.054e+07
 sigma_tot counter=5 i=2 t=1.227e-03 per=1.228e+01 cost=1.438e+04 flops=1.172e+07
 sigma_tot counter=5 i=3 t=1.216e-03 per=1.217e+01 cost=1.444e+04 flops=1.188e+07
 sigma_tot counter=5 i=4 t=1.257e-03 per=1.258e+01 cost=2.908e+04 flops=2.314e+07
 sigma_tot counter=5 i=5 t=1.254e-03 per=1.255e+01 cost=2.919e+04 flops=2.328e+07
 sigma_tot counter=5 i=6 t=1.294e-03 per=1.295e+01 cost=2.841e+04 flops=2.196e+07
 sigma_tot counter=5 i=7 t=1.251e-03 per=1.252e+01 cost=2.837e+04 flops=2.268e+07
 total GEMM cost=1.702e+05 flops=1.703e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.080e-04,1.942e-03,1.970e-04 cost=2.862e+04 flops[gemm]=1.474e+07
--- TIMING FOR sigma : t_inter=2.080e-04 t_gemm=1.940e-03 t_reduction=1.970e-04 tot=2.345e-03 ---
 sigma counter=6 i=0 t=2.380e-04 per=1.227e+01 cost=1.908e+03 flops=8.017e+06
 sigma counter=6 i=1 t=2.380e-04 per=1.227e+01 cost=1.896e+03 flops=7.966e+06
 sigma counter=6 i=2 t=2.410e-04 per=1.242e+01 cost=2.768e+03 flops=1.149e+07
 sigma counter=6 i=3 t=2.410e-04 per=1.242e+01 cost=2.796e+03 flops=1.160e+07
 sigma counter=6 i=4 t=2.420e-04 per=1.247e+01 cost=3.028e+03 flops=1.251e+07
 sigma counter=6 i=5 t=2.430e-04 per=1.253e+01 cost=3.064e+03 flops=1.261e+07
 sigma counter=6 i=6 t=2.520e-04 per=1.299e+01 cost=6.580e+03 flops=2.611e+07
 sigma counter=6 i=7 t=2.450e-04 per=1.263e+01 cost=6.580e+03 flops=2.686e+07
 total GEMM cost=2.862e+04 flops=1.475e+07
--- TIMING FOR sigma_tot : t_inter=1.312e-03 t_gemm=1.193e-02 t_reduction=1.205e-03 tot=1.445e-02 ---
 sigma_tot counter=6 i=0 t=1.484e-03 per=1.244e+01 cost=1.506e+04 flops=1.015e+07
 sigma_tot counter=6 i=1 t=1.487e-03 per=1.246e+01 cost=1.506e+04 flops=1.013e+07
 sigma_tot counter=6 i=2 t=1.468e-03 per=1.230e+01 cost=1.714e+04 flops=1.168e+07
 sigma_tot counter=6 i=3 t=1.457e-03 per=1.221e+01 cost=1.724e+04 flops=1.183e+07
 sigma_tot counter=6 i=4 t=1.499e-03 per=1.256e+01 cost=3.211e+04 flops=2.142e+07
 sigma_tot counter=6 i=5 t=1.497e-03 per=1.254e+01 cost=3.226e+04 flops=2.155e+07
 sigma_tot counter=6 i=6 t=1.546e-03 per=1.295e+01 cost=3.499e+04 flops=2.263e+07
 sigma_tot counter=6 i=7 t=1.496e-03 per=1.254e+01 cost=3.495e+04 flops=2.336e+07
 total GEMM cost=1.988e+05 flops=1.666e+07
    2   0 -      -2.651065955750 -1.361e-04  5.042e-03    4     4  1.056e-02 2.640e-03
    2   1 -      -2.272592289492 -2.225e-04  5.208e-03    4     4  1.056e-02 2.640e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.000e-05,2.190e-04,1.955e-03,1.980e-04 cost=2.862e+04 flops[gemm]=1.464e+07
--- TIMING FOR sigma : t_inter=2.190e-04 t_gemm=1.955e-03 t_reduction=1.980e-04 tot=2.372e-03 ---
 sigma counter=7 i=0 t=2.400e-04 per=1.228e+01 cost=1.908e+03 flops=7.950e+06
 sigma counter=7 i=1 t=2.470e-04 per=1.263e+01 cost=1.896e+03 flops=7.676e+06
 sigma counter=7 i=2 t=2.410e-04 per=1.233e+01 cost=2.768e+03 flops=1.149e+07
 sigma counter=7 i=3 t=2.390e-04 per=1.223e+01 cost=2.796e+03 flops=1.170e+07
 sigma counter=7 i=4 t=2.440e-04 per=1.248e+01 cost=3.028e+03 flops=1.241e+07
 sigma counter=7 i=5 t=2.470e-04 per=1.263e+01 cost=3.064e+03 flops=1.240e+07
 sigma counter=7 i=6 t=2.510e-04 per=1.284e+01 cost=6.580e+03 flops=2.622e+07
 sigma counter=7 i=7 t=2.460e-04 per=1.258e+01 cost=6.580e+03 flops=2.675e+07
 total GEMM cost=2.862e+04 flops=1.464e+07
--- TIMING FOR sigma_tot : t_inter=1.531e-03 t_gemm=1.389e-02 t_reduction=1.403e-03 tot=1.682e-02 ---
 sigma_tot counter=7 i=0 t=1.724e-03 per=1.241e+01 cost=1.697e+04 flops=9.845e+06
 sigma_tot counter=7 i=1 t=1.734e-03 per=1.248e+01 cost=1.695e+04 flops=9.776e+06
 sigma_tot counter=7 i=2 t=1.709e-03 per=1.230e+01 cost=1.991e+04 flops=1.165e+07
 sigma_tot counter=7 i=3 t=1.696e-03 per=1.221e+01 cost=2.003e+04 flops=1.181e+07
 sigma_tot counter=7 i=4 t=1.743e-03 per=1.255e+01 cost=3.514e+04 flops=2.016e+07
 sigma_tot counter=7 i=5 t=1.744e-03 per=1.256e+01 cost=3.532e+04 flops=2.025e+07
 sigma_tot counter=7 i=6 t=1.797e-03 per=1.294e+01 cost=4.157e+04 flops=2.313e+07
 sigma_tot counter=7 i=7 t=1.742e-03 per=1.254e+01 cost=4.153e+04 flops=2.384e+07
 total GEMM cost=2.274e+05 flops=1.637e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.060e-04,1.942e-03,1.960e-04 cost=2.862e+04 flops[gemm]=1.474e+07
--- TIMING FOR sigma : t_inter=2.060e-04 t_gemm=1.942e-03 t_reduction=1.960e-04 tot=2.344e-03 ---
 sigma counter=8 i=0 t=2.350e-04 per=1.210e+01 cost=1.908e+03 flops=8.119e+06
 sigma counter=8 i=1 t=2.410e-04 per=1.241e+01 cost=1.896e+03 flops=7.867e+06
 sigma counter=8 i=2 t=2.410e-04 per=1.241e+01 cost=2.768e+03 flops=1.149e+07
 sigma counter=8 i=3 t=2.440e-04 per=1.256e+01 cost=2.796e+03 flops=1.146e+07
 sigma counter=8 i=4 t=2.420e-04 per=1.246e+01 cost=3.028e+03 flops=1.251e+07
 sigma counter=8 i=5 t=2.430e-04 per=1.251e+01 cost=3.064e+03 flops=1.261e+07
 sigma counter=8 i=6 t=2.530e-04 per=1.303e+01 cost=6.580e+03 flops=2.601e+07
 sigma counter=8 i=7 t=2.430e-04 per=1.251e+01 cost=6.580e+03 flops=2.708e+07
 total GEMM cost=2.862e+04 flops=1.474e+07
--- TIMING FOR sigma_tot : t_inter=1.737e-03 t_gemm=1.583e-02 t_reduction=1.599e-03 tot=1.917e-02 ---
 sigma_tot counter=8 i=0 t=1.959e-03 per=1.237e+01 cost=1.888e+04 flops=9.638e+06
 sigma_tot counter=8 i=1 t=1.975e-03 per=1.248e+01 cost=1.885e+04 flops=9.543e+06
 sigma_tot counter=8 i=2 t=1.950e-03 per=1.232e+01 cost=2.268e+04 flops=1.163e+07
 sigma_tot counter=8 i=3 t=1.940e-03 per=1.225e+01 cost=2.283e+04 flops=1.177e+07
 sigma_tot counter=8 i=4 t=1.985e-03 per=1.254e+01 cost=3.817e+04 flops=1.923e+07
 sigma_tot counter=8 i=5 t=1.987e-03 per=1.255e+01 cost=3.838e+04 flops=1.932e+07
 sigma_tot counter=8 i=6 t=2.050e-03 per=1.295e+01 cost=4.815e+04 flops=2.349e+07
 sigma_tot counter=8 i=7 t=1.985e-03 per=1.254e+01 cost=4.811e+04 flops=2.424e+07
 total GEMM cost=2.561e+05 flops=1.617e+07
    3   0 -      -2.651089358505 -2.340e-05  2.260e-03    6     6  1.572e-02 2.621e-03
    3   1 -      -2.272613351642 -2.106e-05  2.043e-03    6     6  1.572e-02 2.621e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.000e-05,2.150e-04,1.945e-03,1.960e-04 cost=2.862e+04 flops[gemm]=1.471e+07
--- TIMING FOR sigma : t_inter=2.150e-04 t_gemm=1.945e-03 t_reduction=1.960e-04 tot=2.356e-03 ---
 sigma counter=9 i=0 t=2.360e-04 per=1.213e+01 cost=1.908e+03 flops=8.085e+06
 sigma counter=9 i=1 t=2.450e-04 per=1.260e+01 cost=1.896e+03 flops=7.739e+06
 sigma counter=9 i=2 t=2.400e-04 per=1.234e+01 cost=2.768e+03 flops=1.153e+07
 sigma counter=9 i=3 t=2.430e-04 per=1.249e+01 cost=2.796e+03 flops=1.151e+07
 sigma counter=9 i=4 t=2.420e-04 per=1.244e+01 cost=3.028e+03 flops=1.251e+07
 sigma counter=9 i=5 t=2.470e-04 per=1.270e+01 cost=3.064e+03 flops=1.240e+07
 sigma counter=9 i=6 t=2.490e-04 per=1.280e+01 cost=6.580e+03 flops=2.643e+07
 sigma counter=9 i=7 t=2.430e-04 per=1.249e+01 cost=6.580e+03 flops=2.708e+07
 total GEMM cost=2.862e+04 flops=1.471e+07
--- TIMING FOR sigma_tot : t_inter=1.952e-03 t_gemm=1.778e-02 t_reduction=1.795e-03 tot=2.152e-02 ---
 sigma_tot counter=9 i=0 t=2.195e-03 per=1.235e+01 cost=2.079e+04 flops=9.471e+06
 sigma_tot counter=9 i=1 t=2.220e-03 per=1.249e+01 cost=2.074e+04 flops=9.344e+06
 sigma_tot counter=9 i=2 t=2.190e-03 per=1.232e+01 cost=2.545e+04 flops=1.162e+07
 sigma_tot counter=9 i=3 t=2.183e-03 per=1.228e+01 cost=2.562e+04 flops=1.174e+07
 sigma_tot counter=9 i=4 t=2.227e-03 per=1.253e+01 cost=4.120e+04 flops=1.850e+07
 sigma_tot counter=9 i=5 t=2.234e-03 per=1.257e+01 cost=4.145e+04 flops=1.855e+07
 sigma_tot counter=9 i=6 t=2.299e-03 per=1.293e+01 cost=5.473e+04 flops=2.381e+07
 sigma_tot counter=9 i=7 t=2.228e-03 per=1.253e+01 cost=5.469e+04 flops=2.455e+07
 total GEMM cost=2.847e+05 flops=1.601e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.100e-04,1.938e-03,1.960e-04 cost=2.862e+04 flops[gemm]=1.477e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=1.938e-03 t_reduction=1.960e-04 tot=2.344e-03 ---
 sigma counter=10 i=0 t=2.340e-04 per=1.207e+01 cost=1.908e+03 flops=8.154e+06
 sigma counter=10 i=1 t=2.350e-04 per=1.213e+01 cost=1.896e+03 flops=8.068e+06
 sigma counter=10 i=2 t=2.530e-04 per=1.305e+01 cost=2.768e+03 flops=1.094e+07
 sigma counter=10 i=3 t=2.430e-04 per=1.254e+01 cost=2.796e+03 flops=1.151e+07
 sigma counter=10 i=4 t=2.410e-04 per=1.244e+01 cost=3.028e+03 flops=1.256e+07
 sigma counter=10 i=5 t=2.430e-04 per=1.254e+01 cost=3.064e+03 flops=1.261e+07
 sigma counter=10 i=6 t=2.460e-04 per=1.269e+01 cost=6.580e+03 flops=2.675e+07
 sigma counter=10 i=7 t=2.430e-04 per=1.254e+01 cost=6.580e+03 flops=2.708e+07
 total GEMM cost=2.862e+04 flops=1.477e+07
--- TIMING FOR sigma_tot : t_inter=2.162e-03 t_gemm=1.971e-02 t_reduction=1.991e-03 tot=2.387e-02 ---
 sigma_tot counter=10 i=0 t=2.429e-03 per=1.232e+01 cost=2.270e+04 flops=9.344e+06
 sigma_tot counter=10 i=1 t=2.455e-03 per=1.245e+01 cost=2.264e+04 flops=9.222e+06
 sigma_tot counter=10 i=2 t=2.443e-03 per=1.239e+01 cost=2.822e+04 flops=1.155e+07
 sigma_tot counter=10 i=3 t=2.426e-03 per=1.231e+01 cost=2.842e+04 flops=1.171e+07
 sigma_tot counter=10 i=4 t=2.468e-03 per=1.252e+01 cost=4.422e+04 flops=1.792e+07
 sigma_tot counter=10 i=5 t=2.477e-03 per=1.256e+01 cost=4.451e+04 flops=1.797e+07
 sigma_tot counter=10 i=6 t=2.545e-03 per=1.291e+01 cost=6.131e+04 flops=2.409e+07
 sigma_tot counter=10 i=7 t=2.471e-03 per=1.253e+01 cost=6.127e+04 flops=2.480e+07
 total GEMM cost=3.133e+05 flops=1.589e+07
    4   0 -      -2.651092509204 -3.151e-06  6.329e-04    6     8  2.087e-02 2.608e-03
    4   1 -      -2.285619598781 -1.301e-02  2.754e-01    6     8  2.087e-02 2.608e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.150e-04,1.935e-03,1.930e-04 cost=2.862e+04 flops[gemm]=1.479e+07
--- TIMING FOR sigma : t_inter=2.150e-04 t_gemm=1.934e-03 t_reduction=1.930e-04 tot=2.342e-03 ---
 sigma counter=11 i=0 t=2.400e-04 per=1.241e+01 cost=1.908e+03 flops=7.950e+06
 sigma counter=11 i=1 t=2.410e-04 per=1.246e+01 cost=1.896e+03 flops=7.867e+06
 sigma counter=11 i=2 t=2.380e-04 per=1.231e+01 cost=2.768e+03 flops=1.163e+07
 sigma counter=11 i=3 t=2.410e-04 per=1.246e+01 cost=2.796e+03 flops=1.160e+07
 sigma counter=11 i=4 t=2.430e-04 per=1.256e+01 cost=3.028e+03 flops=1.246e+07
 sigma counter=11 i=5 t=2.430e-04 per=1.256e+01 cost=3.064e+03 flops=1.261e+07
 sigma counter=11 i=6 t=2.480e-04 per=1.282e+01 cost=6.580e+03 flops=2.653e+07
 sigma counter=11 i=7 t=2.400e-04 per=1.241e+01 cost=6.580e+03 flops=2.742e+07
 total GEMM cost=2.862e+04 flops=1.480e+07
--- TIMING FOR sigma_tot : t_inter=2.377e-03 t_gemm=2.165e-02 t_reduction=2.184e-03 tot=2.621e-02 ---
 sigma_tot counter=11 i=0 t=2.669e-03 per=1.233e+01 cost=2.460e+04 flops=9.218e+06
 sigma_tot counter=11 i=1 t=2.696e-03 per=1.245e+01 cost=2.454e+04 flops=9.101e+06
 sigma_tot counter=11 i=2 t=2.681e-03 per=1.238e+01 cost=3.098e+04 flops=1.156e+07
 sigma_tot counter=11 i=3 t=2.667e-03 per=1.232e+01 cost=3.122e+04 flops=1.170e+07
 sigma_tot counter=11 i=4 t=2.711e-03 per=1.252e+01 cost=4.725e+04 flops=1.743e+07
 sigma_tot counter=11 i=5 t=2.720e-03 per=1.256e+01 cost=4.758e+04 flops=1.749e+07
 sigma_tot counter=11 i=6 t=2.793e-03 per=1.290e+01 cost=6.789e+04 flops=2.431e+07
 sigma_tot counter=11 i=7 t=2.711e-03 per=1.252e+01 cost=6.785e+04 flops=2.503e+07
 total GEMM cost=3.419e+05 flops=1.579e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.070e-04,1.957e-03,2.010e-04 cost=2.862e+04 flops[gemm]=1.462e+07
--- TIMING FOR sigma : t_inter=2.060e-04 t_gemm=1.955e-03 t_reduction=2.010e-04 tot=2.362e-03 ---
 sigma counter=12 i=0 t=2.340e-04 per=1.197e+01 cost=1.908e+03 flops=8.154e+06
 sigma counter=12 i=1 t=2.410e-04 per=1.233e+01 cost=1.896e+03 flops=7.867e+06
 sigma counter=12 i=2 t=2.400e-04 per=1.228e+01 cost=2.768e+03 flops=1.153e+07
 sigma counter=12 i=3 t=2.450e-04 per=1.253e+01 cost=2.796e+03 flops=1.141e+07
 sigma counter=12 i=4 t=2.500e-04 per=1.279e+01 cost=3.028e+03 flops=1.211e+07
 sigma counter=12 i=5 t=2.450e-04 per=1.253e+01 cost=3.064e+03 flops=1.251e+07
 sigma counter=12 i=6 t=2.540e-04 per=1.299e+01 cost=6.580e+03 flops=2.591e+07
 sigma counter=12 i=7 t=2.460e-04 per=1.258e+01 cost=6.580e+03 flops=2.675e+07
 total GEMM cost=2.862e+04 flops=1.464e+07
--- TIMING FOR sigma_tot : t_inter=2.583e-03 t_gemm=2.360e-02 t_reduction=2.385e-03 tot=2.857e-02 ---
 sigma_tot counter=12 i=0 t=2.903e-03 per=1.230e+01 cost=2.651e+04 flops=9.133e+06
 sigma_tot counter=12 i=1 t=2.937e-03 per=1.244e+01 cost=2.643e+04 flops=9.000e+06
 sigma_tot counter=12 i=2 t=2.921e-03 per=1.238e+01 cost=3.375e+04 flops=1.155e+07
 sigma_tot counter=12 i=3 t=2.912e-03 per=1.234e+01 cost=3.401e+04 flops=1.168e+07
 sigma_tot counter=12 i=4 t=2.961e-03 per=1.255e+01 cost=5.028e+04 flops=1.698e+07
 sigma_tot counter=12 i=5 t=2.965e-03 per=1.256e+01 cost=5.064e+04 flops=1.708e+07
 sigma_tot counter=12 i=6 t=3.047e-03 per=1.291e+01 cost=7.447e+04 flops=2.444e+07
 sigma_tot counter=12 i=7 t=2.957e-03 per=1.253e+01 cost=7.443e+04 flops=2.517e+07
 total GEMM cost=3.705e+05 flops=1.570e+07
    5   0 -      -2.651092802765 -2.936e-07  2.044e-04    6    10  2.602e-02 2.602e-03
    5   1 -      -2.394011494529 -1.084e-01  1.987e-01    6    10  2.602e-02 2.602e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.130e-04,1.942e-03,1.990e-04 cost=2.862e+04 flops[gemm]=1.474e+07
--- TIMING FOR sigma : t_inter=2.130e-04 t_gemm=1.942e-03 t_reduction=1.990e-04 tot=2.354e-03 ---
 sigma counter=13 i=0 t=2.390e-04 per=1.231e+01 cost=1.908e+03 flops=7.983e+06
 sigma counter=13 i=1 t=2.440e-04 per=1.256e+01 cost=1.896e+03 flops=7.770e+06
 sigma counter=13 i=2 t=2.400e-04 per=1.236e+01 cost=2.768e+03 flops=1.153e+07
 sigma counter=13 i=3 t=2.400e-04 per=1.236e+01 cost=2.796e+03 flops=1.165e+07
 sigma counter=13 i=4 t=2.440e-04 per=1.256e+01 cost=3.028e+03 flops=1.241e+07
 sigma counter=13 i=5 t=2.410e-04 per=1.241e+01 cost=3.064e+03 flops=1.271e+07
 sigma counter=13 i=6 t=2.520e-04 per=1.298e+01 cost=6.580e+03 flops=2.611e+07
 sigma counter=13 i=7 t=2.420e-04 per=1.246e+01 cost=6.580e+03 flops=2.719e+07
 total GEMM cost=2.862e+04 flops=1.474e+07
--- TIMING FOR sigma_tot : t_inter=2.796e-03 t_gemm=2.554e-02 t_reduction=2.584e-03 tot=3.092e-02 ---
 sigma_tot counter=13 i=0 t=3.142e-03 per=1.230e+01 cost=2.842e+04 flops=9.045e+06
 sigma_tot counter=13 i=1 t=3.181e-03 per=1.245e+01 cost=2.833e+04 flops=8.905e+06
 sigma_tot counter=13 i=2 t=3.161e-03 per=1.237e+01 cost=3.652e+04 flops=1.155e+07
 sigma_tot counter=13 i=3 t=3.152e-03 per=1.234e+01 cost=3.681e+04 flops=1.168e+07
 sigma_tot counter=13 i=4 t=3.205e-03 per=1.255e+01 cost=5.331e+04 flops=1.663e+07
 sigma_tot counter=13 i=5 t=3.206e-03 per=1.255e+01 cost=5.370e+04 flops=1.675e+07
 sigma_tot counter=13 i=6 t=3.299e-03 per=1.291e+01 cost=8.105e+04 flops=2.457e+07
 sigma_tot counter=13 i=7 t=3.199e-03 per=1.252e+01 cost=8.101e+04 flops=2.532e+07
 total GEMM cost=3.992e+05 flops=1.563e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.080e-04,1.936e-03,1.950e-04 cost=2.862e+04 flops[gemm]=1.478e+07
--- TIMING FOR sigma : t_inter=2.080e-04 t_gemm=1.936e-03 t_reduction=1.940e-04 tot=2.338e-03 ---
 sigma counter=14 i=0 t=2.320e-04 per=1.198e+01 cost=1.908e+03 flops=8.224e+06
 sigma counter=14 i=1 t=2.460e-04 per=1.271e+01 cost=1.896e+03 flops=7.707e+06
 sigma counter=14 i=2 t=2.400e-04 per=1.240e+01 cost=2.768e+03 flops=1.153e+07
 sigma counter=14 i=3 t=2.380e-04 per=1.229e+01 cost=2.796e+03 flops=1.175e+07
 sigma counter=14 i=4 t=2.420e-04 per=1.250e+01 cost=3.028e+03 flops=1.251e+07
 sigma counter=14 i=5 t=2.430e-04 per=1.255e+01 cost=3.064e+03 flops=1.261e+07
 sigma counter=14 i=6 t=2.530e-04 per=1.307e+01 cost=6.580e+03 flops=2.601e+07
 sigma counter=14 i=7 t=2.420e-04 per=1.250e+01 cost=6.580e+03 flops=2.719e+07
 total GEMM cost=2.862e+04 flops=1.478e+07
--- TIMING FOR sigma_tot : t_inter=3.004e-03 t_gemm=2.748e-02 t_reduction=2.778e-03 tot=3.326e-02 ---
 sigma_tot counter=14 i=0 t=3.374e-03 per=1.228e+01 cost=3.033e+04 flops=8.989e+06
 sigma_tot counter=14 i=1 t=3.427e-03 per=1.247e+01 cost=3.022e+04 flops=8.819e+06
 sigma_tot counter=14 i=2 t=3.401e-03 per=1.238e+01 cost=3.929e+04 flops=1.155e+07
 sigma_tot counter=14 i=3 t=3.390e-03 per=1.234e+01 cost=3.960e+04 flops=1.168e+07
 sigma_tot counter=14 i=4 t=3.447e-03 per=1.254e+01 cost=5.634e+04 flops=1.634e+07
 sigma_tot counter=14 i=5 t=3.449e-03 per=1.255e+01 cost=5.677e+04 flops=1.646e+07
 sigma_tot counter=14 i=6 t=3.552e-03 per=1.293e+01 cost=8.763e+04 flops=2.467e+07
 sigma_tot counter=14 i=7 t=3.441e-03 per=1.252e+01 cost=8.759e+04 flops=2.546e+07
 total GEMM cost=4.278e+05 flops=1.557e+07
    6   0 +      -2.651092830507 -2.774e-08  5.870e-05    6    12  3.117e-02 2.597e-03
    6   1 -      -2.424301296184 -3.029e-02  6.671e-02    6    12  3.117e-02 2.597e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.170e-04,1.929e-03,1.970e-04 cost=2.862e+04 flops[gemm]=1.484e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=1.929e-03 t_reduction=1.970e-04 tot=2.342e-03 ---
 sigma counter=15 i=0 t=2.360e-04 per=1.223e+01 cost=1.908e+03 flops=8.085e+06
 sigma counter=15 i=1 t=2.410e-04 per=1.249e+01 cost=1.896e+03 flops=7.867e+06
 sigma counter=15 i=2 t=2.390e-04 per=1.239e+01 cost=2.768e+03 flops=1.158e+07
 sigma counter=15 i=3 t=2.410e-04 per=1.249e+01 cost=2.796e+03 flops=1.160e+07
 sigma counter=15 i=4 t=2.430e-04 per=1.260e+01 cost=3.028e+03 flops=1.246e+07
 sigma counter=15 i=5 t=2.420e-04 per=1.255e+01 cost=3.064e+03 flops=1.266e+07
 sigma counter=15 i=6 t=2.450e-04 per=1.270e+01 cost=6.580e+03 flops=2.686e+07
 sigma counter=15 i=7 t=2.420e-04 per=1.255e+01 cost=6.580e+03 flops=2.719e+07
 total GEMM cost=2.862e+04 flops=1.484e+07
--- TIMING FOR sigma_tot : t_inter=3.220e-03 t_gemm=2.941e-02 t_reduction=2.975e-03 tot=3.560e-02 ---
 sigma_tot counter=15 i=0 t=3.610e-03 per=1.227e+01 cost=3.224e+04 flops=8.930e+06
 sigma_tot counter=15 i=1 t=3.668e-03 per=1.247e+01 cost=3.212e+04 flops=8.757e+06
 sigma_tot counter=15 i=2 t=3.640e-03 per=1.238e+01 cost=4.206e+04 flops=1.155e+07
 sigma_tot counter=15 i=3 t=3.631e-03 per=1.235e+01 cost=4.240e+04 flops=1.168e+07
 sigma_tot counter=15 i=4 t=3.690e-03 per=1.255e+01 cost=5.936e+04 flops=1.609e+07
 sigma_tot counter=15 i=5 t=3.691e-03 per=1.255e+01 cost=5.983e+04 flops=1.621e+07
 sigma_tot counter=15 i=6 t=3.797e-03 per=1.291e+01 cost=9.421e+04 flops=2.481e+07
 sigma_tot counter=15 i=7 t=3.683e-03 per=1.252e+01 cost=9.417e+04 flops=2.557e+07
 total GEMM cost=4.564e+05 flops=1.552e+07
    7   0 +      -2.651092830510 -2.859e-12  5.868e-05    5    13  3.374e-02 2.595e-03
    7   1 -      -2.427312786614 -3.011e-03  1.846e-02    5    13  3.374e-02 2.595e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.110e-04,1.932e-03,1.970e-04 cost=2.862e+04 flops[gemm]=1.481e+07
--- TIMING FOR sigma : t_inter=2.110e-04 t_gemm=1.932e-03 t_reduction=1.970e-04 tot=2.340e-03 ---
 sigma counter=16 i=0 t=2.350e-04 per=1.216e+01 cost=1.908e+03 flops=8.119e+06
 sigma counter=16 i=1 t=2.430e-04 per=1.258e+01 cost=1.896e+03 flops=7.802e+06
 sigma counter=16 i=2 t=2.390e-04 per=1.237e+01 cost=2.768e+03 flops=1.158e+07
 sigma counter=16 i=3 t=2.390e-04 per=1.237e+01 cost=2.796e+03 flops=1.170e+07
 sigma counter=16 i=4 t=2.400e-04 per=1.242e+01 cost=3.028e+03 flops=1.262e+07
 sigma counter=16 i=5 t=2.430e-04 per=1.258e+01 cost=3.064e+03 flops=1.261e+07
 sigma counter=16 i=6 t=2.500e-04 per=1.294e+01 cost=6.580e+03 flops=2.632e+07
 sigma counter=16 i=7 t=2.430e-04 per=1.258e+01 cost=6.580e+03 flops=2.708e+07
 total GEMM cost=2.862e+04 flops=1.481e+07
--- TIMING FOR sigma_tot : t_inter=3.431e-03 t_gemm=3.134e-02 t_reduction=3.172e-03 tot=3.794e-02 ---
 sigma_tot counter=16 i=0 t=3.845e-03 per=1.227e+01 cost=3.414e+04 flops=8.880e+06
 sigma_tot counter=16 i=1 t=3.911e-03 per=1.248e+01 cost=3.402e+04 flops=8.698e+06
 sigma_tot counter=16 i=2 t=3.879e-03 per=1.238e+01 cost=4.482e+04 flops=1.156e+07
 sigma_tot counter=16 i=3 t=3.870e-03 per=1.235e+01 cost=4.520e+04 flops=1.168e+07
 sigma_tot counter=16 i=4 t=3.930e-03 per=1.254e+01 cost=6.239e+04 flops=1.588e+07
 sigma_tot counter=16 i=5 t=3.934e-03 per=1.255e+01 cost=6.290e+04 flops=1.599e+07
 sigma_tot counter=16 i=6 t=4.047e-03 per=1.291e+01 cost=1.008e+05 flops=2.491e+07
 sigma_tot counter=16 i=7 t=3.926e-03 per=1.253e+01 cost=1.008e+05 flops=2.566e+07
 total GEMM cost=4.850e+05 flops=1.547e+07
    8   0 +      -2.651092830512 -1.415e-12  5.866e-05    4    14  3.631e-02 2.594e-03
    8   1 -      -2.427590274451 -2.775e-04  8.148e-03    4    14  3.631e-02 2.594e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.160e-04,1.924e-03,1.960e-04 cost=2.862e+04 flops[gemm]=1.488e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=1.923e-03 t_reduction=1.960e-04 tot=2.335e-03 ---
 sigma counter=17 i=0 t=2.350e-04 per=1.222e+01 cost=1.908e+03 flops=8.119e+06
 sigma counter=17 i=1 t=2.360e-04 per=1.227e+01 cost=1.896e+03 flops=8.034e+06
 sigma counter=17 i=2 t=2.400e-04 per=1.248e+01 cost=2.768e+03 flops=1.153e+07
 sigma counter=17 i=3 t=2.390e-04 per=1.243e+01 cost=2.796e+03 flops=1.170e+07
 sigma counter=17 i=4 t=2.400e-04 per=1.248e+01 cost=3.028e+03 flops=1.262e+07
 sigma counter=17 i=5 t=2.390e-04 per=1.243e+01 cost=3.064e+03 flops=1.282e+07
 sigma counter=17 i=6 t=2.490e-04 per=1.295e+01 cost=6.580e+03 flops=2.643e+07
 sigma counter=17 i=7 t=2.450e-04 per=1.274e+01 cost=6.580e+03 flops=2.686e+07
 total GEMM cost=2.862e+04 flops=1.488e+07
--- TIMING FOR sigma_tot : t_inter=3.647e-03 t_gemm=3.327e-02 t_reduction=3.368e-03 tot=4.028e-02 ---
 sigma_tot counter=17 i=0 t=4.080e-03 per=1.227e+01 cost=3.605e+04 flops=8.836e+06
 sigma_tot counter=17 i=1 t=4.147e-03 per=1.247e+01 cost=3.591e+04 flops=8.660e+06
 sigma_tot counter=17 i=2 t=4.119e-03 per=1.238e+01 cost=4.759e+04 flops=1.155e+07
 sigma_tot counter=17 i=3 t=4.109e-03 per=1.235e+01 cost=4.799e+04 flops=1.168e+07
 sigma_tot counter=17 i=4 t=4.170e-03 per=1.254e+01 cost=6.542e+04 flops=1.569e+07
 sigma_tot counter=17 i=5 t=4.173e-03 per=1.254e+01 cost=6.596e+04 flops=1.581e+07
 sigma_tot counter=17 i=6 t=4.296e-03 per=1.291e+01 cost=1.074e+05 flops=2.499e+07
 sigma_tot counter=17 i=7 t=4.171e-03 per=1.254e+01 cost=1.073e+05 flops=2.573e+07
 total GEMM cost=5.136e+05 flops=1.544e+07
    9   0 +      -2.651092830512 -1.692e-13  5.863e-05    4    15  3.888e-02 2.592e-03
    9   1 -      -2.427635280452 -4.501e-05  2.955e-03    4    15  3.888e-02 2.592e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.300e-05,2.150e-04,1.933e-03,1.940e-04 cost=2.862e+04 flops[gemm]=1.481e+07
--- TIMING FOR sigma : t_inter=2.150e-04 t_gemm=1.933e-03 t_reduction=1.940e-04 tot=2.342e-03 ---
 sigma counter=18 i=0 t=2.410e-04 per=1.247e+01 cost=1.908e+03 flops=7.917e+06
 sigma counter=18 i=1 t=2.340e-04 per=1.211e+01 cost=1.896e+03 flops=8.103e+06
 sigma counter=18 i=2 t=2.410e-04 per=1.247e+01 cost=2.768e+03 flops=1.149e+07
 sigma counter=18 i=3 t=2.410e-04 per=1.247e+01 cost=2.796e+03 flops=1.160e+07
 sigma counter=18 i=4 t=2.450e-04 per=1.267e+01 cost=3.028e+03 flops=1.236e+07
 sigma counter=18 i=5 t=2.430e-04 per=1.257e+01 cost=3.064e+03 flops=1.261e+07
 sigma counter=18 i=6 t=2.480e-04 per=1.283e+01 cost=6.580e+03 flops=2.653e+07
 sigma counter=18 i=7 t=2.400e-04 per=1.242e+01 cost=6.580e+03 flops=2.742e+07
 total GEMM cost=2.862e+04 flops=1.481e+07
--- TIMING FOR sigma_tot : t_inter=3.862e-03 t_gemm=3.520e-02 t_reduction=3.562e-03 tot=4.262e-02 ---
 sigma_tot counter=18 i=0 t=4.321e-03 per=1.228e+01 cost=3.796e+04 flops=8.785e+06
 sigma_tot counter=18 i=1 t=4.381e-03 per=1.245e+01 cost=3.781e+04 flops=8.630e+06
 sigma_tot counter=18 i=2 t=4.360e-03 per=1.239e+01 cost=5.036e+04 flops=1.155e+07
 sigma_tot counter=18 i=3 t=4.350e-03 per=1.236e+01 cost=5.079e+04 flops=1.168e+07
 sigma_tot counter=18 i=4 t=4.415e-03 per=1.254e+01 cost=6.845e+04 flops=1.550e+07
 sigma_tot counter=18 i=5 t=4.416e-03 per=1.255e+01 cost=6.902e+04 flops=1.563e+07
 sigma_tot counter=18 i=6 t=4.544e-03 per=1.291e+01 cost=1.140e+05 flops=2.508e+07
 sigma_tot counter=18 i=7 t=4.411e-03 per=1.253e+01 cost=1.139e+05 flops=2.582e+07
 total GEMM cost=5.423e+05 flops=1.541e+07
   10   0 +      -2.651092830516 -4.496e-12  5.865e-05    4    16  4.146e-02 2.591e-03
   10   1 -      -2.427641745524 -6.465e-06  1.265e-03    4    16  4.146e-02 2.591e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.140e-04,1.926e-03,1.950e-04 cost=2.862e+04 flops[gemm]=1.486e+07
--- TIMING FOR sigma : t_inter=2.140e-04 t_gemm=1.925e-03 t_reduction=1.950e-04 tot=2.334e-03 ---
 sigma counter=19 i=0 t=2.390e-04 per=1.242e+01 cost=1.908e+03 flops=7.983e+06
 sigma counter=19 i=1 t=2.320e-04 per=1.205e+01 cost=1.896e+03 flops=8.172e+06
 sigma counter=19 i=2 t=2.420e-04 per=1.257e+01 cost=2.768e+03 flops=1.144e+07
 sigma counter=19 i=3 t=2.400e-04 per=1.247e+01 cost=2.796e+03 flops=1.165e+07
 sigma counter=19 i=4 t=2.410e-04 per=1.252e+01 cost=3.028e+03 flops=1.256e+07
 sigma counter=19 i=5 t=2.400e-04 per=1.247e+01 cost=3.064e+03 flops=1.277e+07
 sigma counter=19 i=6 t=2.490e-04 per=1.294e+01 cost=6.580e+03 flops=2.643e+07
 sigma counter=19 i=7 t=2.420e-04 per=1.257e+01 cost=6.580e+03 flops=2.719e+07
 total GEMM cost=2.862e+04 flops=1.487e+07
--- TIMING FOR sigma_tot : t_inter=4.076e-03 t_gemm=3.712e-02 t_reduction=3.757e-03 tot=4.496e-02 ---
 sigma_tot counter=19 i=0 t=4.560e-03 per=1.228e+01 cost=3.987e+04 flops=8.743e+06
 sigma_tot counter=19 i=1 t=4.613e-03 per=1.243e+01 cost=3.970e+04 flops=8.607e+06
 sigma_tot counter=19 i=2 t=4.602e-03 per=1.240e+01 cost=5.313e+04 flops=1.154e+07
 sigma_tot counter=19 i=3 t=4.590e-03 per=1.236e+01 cost=5.358e+04 flops=1.167e+07
 sigma_tot counter=19 i=4 t=4.656e-03 per=1.254e+01 cost=7.148e+04 flops=1.535e+07
 sigma_tot counter=19 i=5 t=4.656e-03 per=1.254e+01 cost=7.209e+04 flops=1.548e+07
 sigma_tot counter=19 i=6 t=4.793e-03 per=1.291e+01 cost=1.205e+05 flops=2.515e+07
 sigma_tot counter=19 i=7 t=4.653e-03 per=1.253e+01 cost=1.205e+05 flops=2.590e+07
 total GEMM cost=5.709e+05 flops=1.538e+07
   11   0 +      -2.651092830564 -4.772e-11  5.845e-05    4    17  4.402e-02 2.590e-03
   11   1 -      -2.427642951229 -1.206e-06  4.336e-04    4    17  4.402e-02 2.590e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.160e-04,1.996e-03,1.990e-04 cost=2.862e+04 flops[gemm]=1.434e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=1.996e-03 t_reduction=1.990e-04 tot=2.411e-03 ---
 sigma counter=20 i=0 t=2.380e-04 per=1.192e+01 cost=1.908e+03 flops=8.017e+06
 sigma counter=20 i=1 t=2.390e-04 per=1.197e+01 cost=1.896e+03 flops=7.933e+06
 sigma counter=20 i=2 t=2.510e-04 per=1.258e+01 cost=2.768e+03 flops=1.103e+07
 sigma counter=20 i=3 t=2.490e-04 per=1.247e+01 cost=2.796e+03 flops=1.123e+07
 sigma counter=20 i=4 t=2.550e-04 per=1.278e+01 cost=3.028e+03 flops=1.187e+07
 sigma counter=20 i=5 t=2.540e-04 per=1.273e+01 cost=3.064e+03 flops=1.206e+07
 sigma counter=20 i=6 t=2.560e-04 per=1.283e+01 cost=6.580e+03 flops=2.570e+07
 sigma counter=20 i=7 t=2.540e-04 per=1.273e+01 cost=6.580e+03 flops=2.591e+07
 total GEMM cost=2.862e+04 flops=1.434e+07
--- TIMING FOR sigma_tot : t_inter=4.292e-03 t_gemm=3.912e-02 t_reduction=3.956e-03 tot=4.737e-02 ---
 sigma_tot counter=20 i=0 t=4.798e-03 per=1.227e+01 cost=4.178e+04 flops=8.707e+06
 sigma_tot counter=20 i=1 t=4.852e-03 per=1.240e+01 cost=4.160e+04 flops=8.574e+06
 sigma_tot counter=20 i=2 t=4.853e-03 per=1.241e+01 cost=5.590e+04 flops=1.152e+07
 sigma_tot counter=20 i=3 t=4.839e-03 per=1.237e+01 cost=5.638e+04 flops=1.165e+07
 sigma_tot counter=20 i=4 t=4.911e-03 per=1.255e+01 cost=7.450e+04 flops=1.517e+07
 sigma_tot counter=20 i=5 t=4.910e-03 per=1.255e+01 cost=7.515e+04 flops=1.531e+07
 sigma_tot counter=20 i=6 t=5.049e-03 per=1.291e+01 cost=1.271e+05 flops=2.518e+07
 sigma_tot counter=20 i=7 t=4.907e-03 per=1.254e+01 cost=1.271e+05 flops=2.590e+07
 total GEMM cost=5.995e+05 flops=1.532e+07
   12   0 +      -2.651092830603 -3.876e-11  5.834e-05    4    18  4.667e-02 2.593e-03
   12   1 -      -2.427643145770 -1.945e-07  1.635e-04    4    18  4.667e-02 2.593e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.160e-04,1.942e-03,1.940e-04 cost=2.862e+04 flops[gemm]=1.474e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=1.941e-03 t_reduction=1.940e-04 tot=2.351e-03 ---
 sigma counter=21 i=0 t=2.390e-04 per=1.231e+01 cost=1.908e+03 flops=7.983e+06
 sigma counter=21 i=1 t=2.460e-04 per=1.267e+01 cost=1.896e+03 flops=7.707e+06
 sigma counter=21 i=2 t=2.400e-04 per=1.236e+01 cost=2.768e+03 flops=1.153e+07
 sigma counter=21 i=3 t=2.400e-04 per=1.236e+01 cost=2.796e+03 flops=1.165e+07
 sigma counter=21 i=4 t=2.410e-04 per=1.242e+01 cost=3.028e+03 flops=1.256e+07
 sigma counter=21 i=5 t=2.450e-04 per=1.262e+01 cost=3.064e+03 flops=1.251e+07
 sigma counter=21 i=6 t=2.510e-04 per=1.293e+01 cost=6.580e+03 flops=2.622e+07
 sigma counter=21 i=7 t=2.390e-04 per=1.231e+01 cost=6.580e+03 flops=2.753e+07
 total GEMM cost=2.862e+04 flops=1.474e+07
--- TIMING FOR sigma_tot : t_inter=4.508e-03 t_gemm=4.106e-02 t_reduction=4.150e-03 tot=4.972e-02 ---
 sigma_tot counter=21 i=0 t=5.037e-03 per=1.227e+01 cost=4.368e+04 flops=8.673e+06
 sigma_tot counter=21 i=1 t=5.098e-03 per=1.242e+01 cost=4.350e+04 flops=8.532e+06
 sigma_tot counter=21 i=2 t=5.093e-03 per=1.240e+01 cost=5.866e+04 flops=1.152e+07
 sigma_tot counter=21 i=3 t=5.079e-03 per=1.237e+01 cost=5.918e+04 flops=1.165e+07
 sigma_tot counter=21 i=4 t=5.152e-03 per=1.255e+01 cost=7.753e+04 flops=1.505e+07
 sigma_tot counter=21 i=5 t=5.155e-03 per=1.255e+01 cost=7.822e+04 flops=1.517e+07
 sigma_tot counter=21 i=6 t=5.300e-03 per=1.291e+01 cost=1.337e+05 flops=2.522e+07
 sigma_tot counter=21 i=7 t=5.146e-03 per=1.253e+01 cost=1.337e+05 flops=2.597e+07
 total GEMM cost=6.281e+05 flops=1.530e+07
   13   0 +      -2.651092830695 -9.208e-11  5.690e-05    4    19  4.925e-02 2.592e-03
   13   1 +      -2.427643176878 -3.111e-08  9.775e-05    4    19  4.925e-02 2.592e-03
TIMING FOR Davidson : 4.928e-02  T(cal/comm/rest)=4.832e-02,7.624e-05,8.832e-04
optimized energies: isweep=0 dots=2 ibond=1 e[0]=-2.65109283069 nmvp=19
optimized energies: isweep=0 dots=2 ibond=1 e[1]=-2.42764317688 nmvp=19
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row_nkr dcut=10 nqr=12 alg_decim=1 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep0_ibond1.txt
 qbond: qsuper nsym=12 dimAll=40
 (4,0):8 (3,1):8 (2,0):5 (3,-1):5 (5,1):3 (4,2):3 (2,2):2 (5,-1):2 (1,1):1 (4,-2):1 (6,0):1 (3,3):1
----- TMING FOR decimation_genbasis: 5.4e-04 S T(scatter/comp/gather)=3.6e-05,4.2e-05,4.6e-04 -----
decimation summary: 40->10 dwt=+9.646e-03 SvN=1.843e+00
 qbond: qkept nsym=4 dimAll=10
 (4,0):3 (3,1):3 (5,1):2 (4,2):2
----- TIMING for decimation_row: 7.969e-04 S T(decim/formRot)=6.061e-04,1.908e-04 -----
TIMING FOR decimation: 1.061e-03 S T(wf/decim)=2.509e-04,8.106e-04
ctns::oper_renorm coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:6 A:7 B:11 P:3 Q:5 S:4 H:1 
        dim(bra,ket)=10,10 size(op)=26:1.984e-04MB size(tot)=511:3.899e-03MB:3.807e-06GB
rank=0 GPUmem(GB): used=1.075e-05 (oper)=8.248e-06
rank=0 GPUmem(GB): used=1.120e-05 (oper,site)(GB)=8.248e-06,4.470e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 4.864e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 5.619e-05 S -----
rank=0 GPUmem(GB): used=1.15e-05 (oper,site,rinter)=8.25e-06,4.47e-07,3.28e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000642 S size(rtasks)=37 size(Rlst2)=4 T(Rmu/Rlist)=0.000164,0.000478 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000691 S size(rtasks)=37 size(Rlst)=475 -----
rank=0 GPUmem(GB): used=0.000128 (oper,site,rinter,batch)=8.25e-06,4.47e-07,3.28e-07,0.000117 blksize=12 blksize0=8 batchsize=475
timing: allocate=3.41e-05 rmmtasks init=0.000613 total=0.000647
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000213,0.00111,0.000195 cost=2.49e+04 flops[gemm]=2.24e+07
--- TIMING FOR renorm : t_inter=0.000213 t_gemm=0.00111 t_reduction=0.000195 tot=0.00152 ---
 renorm counter=2 i=0 t=0.000221 per=19.9 cost=1.57e+03 flops=7.1e+06
 renorm counter=2 i=1 t=0.000219 per=19.7 cost=1.82e+03 flops=8.3e+06
 renorm counter=2 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=2 i=3 t=1e-06 per=0.0902 cost=0 flops=0
 renorm counter=2 i=4 t=0.000216 per=19.5 cost=2.78e+03 flops=1.29e+07
 renorm counter=2 i=5 t=0.000218 per=19.7 cost=5.12e+03 flops=2.35e+07
 renorm counter=2 i=6 t=0.000234 per=21.1 cost=1.36e+04 flops=5.8e+07
 total GEMM cost=2.49e+04 flops=2.24e+07
--- TIMING FOR renorm_tot : t_inter=0.000218 t_gemm=0.00227 t_reduction=0.000396 tot=0.00289 ---
 renorm_tot counter=2 i=0 t=0.000462 per=20.3 cost=2.39e+03 flops=5.18e+06
 renorm_tot counter=2 i=1 t=0.000446 per=19.6 cost=2.93e+03 flops=6.58e+06
 renorm_tot counter=2 i=2 t=1e-06 per=0.044 cost=0 flops=0
 renorm_tot counter=2 i=3 t=2e-06 per=0.088 cost=0 flops=0
 renorm_tot counter=2 i=4 t=0.000436 per=19.2 cost=3.55e+03 flops=8.14e+06
 renorm_tot counter=2 i=5 t=0.000442 per=19.4 cost=6.37e+03 flops=1.44e+07
 renorm_tot counter=2 i=6 t=0.000484 per=21.3 cost=2.13e+04 flops=4.41e+07
 total GEMM cost=3.66e+04 flops=1.61e+07
timing: gpu2cpu=1.43e-05 deallocate(site/work)=5.44e-06,8.13e-06 total=2.24e-05
check ||H-H.dagger||=6.390e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00398 S T(init/kernel/comm)=0.000257,0.00366,5.9e-05 rank=0 -----
TIMING FOR cleanup: 0.000186 T(erase/save/remove)=4.22e-06,0.000145,3.7e-05
##### local: 6.412e-02 S #####
 T(local: fetch) = 1.023e-03 S  per =  1.6  per(accum) = 1.6
 T(local: hdiag) = 4.934e-04 S  per = 0.77  per(accum) = 2.36
 T(local: dvdsn) = 5.682e-02 S  per = 88.6  per(accum) = 91
 T(local: decim) = 1.175e-03 S  per = 1.83  per(accum) = 92.8
 T(local: guess) = 3.193e-04 S  per = 0.498  per(accum) = 93.3
 T(local: renrm) = 4.090e-03 S  per = 6.38  per(accum) = 99.7
 T(local: save ) = 1.980e-04 S  per = 0.309  per(accum) = 100
Detailed decomposition of T(dvdsn): 5.597e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 8.489e-06 S  per = 0.0152  per(accum) = 0.0152
 T(local: symbolic_formulae_twodot     ) = 6.633e-04 S  per = 1.19  per(accum) = 1.2
 T(local: hintermediate init           ) = 5.823e-05 S  per = 0.104  per(accum) = 1.3
 T(local: hintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 5e-05  per(accum) = 1.3
 T(local: preprocess_hformulae_Hxlist2 ) = 2.995e-03 S  per = 5.35  per(accum) = 6.66
 T(local: hmmtasks init                ) = 2.972e-03 S  per = 5.31  per(accum) = 12
 T(local: dvdson solver [Hx_batchGPU]  ) = 4.832e-02 S  per = 86.3  per(accum) = 98.3
 T(local: dvdson solver [communication]) = 7.624e-05 S  per = 0.136  per(accum) = 98.4
 T(local: dvdson solver [rest part]    ) = 8.832e-04 S  per = 1.58  per(accum) = 100
Detailed decomposition of T(renrm): 3.976e-03 S
 T(local: qops init                    ) = 2.566e-04 S  per = 6.45  per(accum) = 6.45
 T(local: qops_dict memcpy cpu2gpu     ) = 4.500e-05 S  per = 1.13  per(accum) = 7.59
 T(local: symbolic_formulae_renorm     ) = 4.980e-04 S  per = 12.5  per(accum) = 20.1
 T(local: rintermediate init           ) = 6.790e-05 S  per = 1.71  per(accum) = 21.8
 T(local: rintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 0.000729  per(accum) = 21.8
 T(local: preprocess_formulae_Rlist2   ) = 7.114e-04 S  per = 17.9  per(accum) = 39.7
 T(local: rmmtasks init                ) = 6.545e-04 S  per = 16.5  per(accum) = 56.2
 T(local: qops memset                  ) = 3.000e-08 S  per = 0.000755  per(accum) = 56.2
 T(local: preprocess_renorm_batchGPU   ) = 1.633e-03 S  per = 41.1  per(accum) = 97.2
 T(local: qops memcpy gpu2cpu          ) = 1.436e-05 S  per = 0.361  per(accum) = 97.6
 T(local: deallocate gpu memory        ) = 3.614e-05 S  per = 0.909  per(accum) = 98.5
 T(local: communication of opS and opH ) = 5.904e-05 S  per = 1.48  per(accum) = 100
##### sweep: 8.872e-02 S #####
 T(sweep: fetch) = 2.963e-03 S  per = 3.34  per(accum) = 3.34
 T(sweep: hdiag) = 1.644e-03 S  per = 1.85  per(accum) = 5.19
 T(sweep: dvdsn) = 7.191e-02 S  per = 81.1  per(accum) = 86.3
 T(sweep: decim) = 2.375e-03 S  per = 2.68  per(accum) = 88.9
 T(sweep: guess) = 8.087e-04 S  per = 0.912  per(accum) = 89.8
 T(sweep: renrm) = 8.499e-03 S  per = 9.58  per(accum) = 99.4
 T(sweep: save ) = 5.158e-04 S  per = 0.581  per(accum) = 100
Detailed decomposition of T(dvdsn): 6.994e-02 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 2.935e-05 S  per = 0.042  per(accum) = 0.042
 T(sweep: symbolic_formulae_twodot     ) = 1.299e-03 S  per = 1.86  per(accum) = 1.9
 T(sweep: hintermediate init           ) = 1.168e-04 S  per = 0.167  per(accum) = 2.07
 T(sweep: hintermediates memcpy cpu2gpu) = 5.900e-08 S  per = 8.44e-05  per(accum) = 2.07
 T(sweep: preprocess_hformulae_Hxlist2 ) = 6.822e-03 S  per = 9.75  per(accum) = 11.8
 T(sweep: hmmtasks init                ) = 6.881e-03 S  per = 9.84  per(accum) = 21.7
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 5.366e-02 S  per = 76.7  per(accum) = 98.4
 T(sweep: dvdson solver [communication]) = 8.400e-05 S  per = 0.12  per(accum) = 98.5
 T(sweep: dvdson solver [rest part]    ) = 1.046e-03 S  per =  1.5  per(accum) = 100
Detailed decomposition of T(renrm): 8.248e-03 S
 T(sweep: qops init                    ) = 5.757e-04 S  per = 6.98  per(accum) = 6.98
 T(sweep: qops_dict memcpy cpu2gpu     ) = 8.209e-05 S  per = 0.995  per(accum) = 7.97
 T(sweep: symbolic_formulae_renorm     ) = 1.097e-03 S  per = 13.3  per(accum) = 21.3
 T(sweep: rintermediate init           ) = 9.337e-05 S  per = 1.13  per(accum) = 22.4
 T(sweep: rintermediates memcpy cpu2gpu) = 5.700e-08 S  per = 0.000691  per(accum) = 22.4
 T(sweep: preprocess_formulae_Rlist2   ) = 1.587e-03 S  per = 19.2  per(accum) = 41.7
 T(sweep: rmmtasks init                ) = 1.453e-03 S  per = 17.6  per(accum) = 59.3
 T(sweep: qops memset                  ) = 5.800e-08 S  per = 0.000703  per(accum) = 59.3
 T(sweep: preprocess_renorm_batchGPU   ) = 3.132e-03 S  per =   38  per(accum) = 97.2
 T(sweep: qops memcpy gpu2cpu          ) = 2.914e-05 S  per = 0.353  per(accum) = 97.6
 T(sweep: deallocate gpu memory        ) = 7.725e-05 S  per = 0.937  per(accum) = 98.5
 T(sweep: communication of opS and opH ) = 1.213e-04 S  per = 1.47  per(accum) = 100
##### global: 8.872e-02 S #####
 T(global: fetch) = 2.963e-03 S  per = 3.34  per(accum) = 3.34
 T(global: hdiag) = 1.644e-03 S  per = 1.85  per(accum) = 5.19
 T(global: dvdsn) = 7.191e-02 S  per = 81.1  per(accum) = 86.3
 T(global: decim) = 2.375e-03 S  per = 2.68  per(accum) = 88.9
 T(global: guess) = 8.087e-04 S  per = 0.912  per(accum) = 89.8
 T(global: renrm) = 8.499e-03 S  per = 9.58  per(accum) = 99.4
 T(global: save ) = 5.158e-04 S  per = 0.581  per(accum) = 100
Detailed decomposition of T(dvdsn): 6.994e-02 S
 T(global: qops_dict memcpy cpu2gpu     ) = 2.935e-05 S  per = 0.042  per(accum) = 0.042
 T(global: symbolic_formulae_twodot     ) = 1.299e-03 S  per = 1.86  per(accum) = 1.9
 T(global: hintermediate init           ) = 1.168e-04 S  per = 0.167  per(accum) = 2.07
 T(global: hintermediates memcpy cpu2gpu) = 5.900e-08 S  per = 8.44e-05  per(accum) = 2.07
 T(global: preprocess_hformulae_Hxlist2 ) = 6.822e-03 S  per = 9.75  per(accum) = 11.8
 T(global: hmmtasks init                ) = 6.881e-03 S  per = 9.84  per(accum) = 21.7
 T(global: dvdson solver [Hx_batchGPU]  ) = 5.366e-02 S  per = 76.7  per(accum) = 98.4
 T(global: dvdson solver [communication]) = 8.400e-05 S  per = 0.12  per(accum) = 98.5
 T(global: dvdson solver [rest part]    ) = 1.046e-03 S  per =  1.5  per(accum) = 100
Detailed decomposition of T(renrm): 8.248e-03 S
 T(global: qops init                    ) = 5.757e-04 S  per = 6.98  per(accum) = 6.98
 T(global: qops_dict memcpy cpu2gpu     ) = 8.209e-05 S  per = 0.995  per(accum) = 7.97
 T(global: symbolic_formulae_renorm     ) = 1.097e-03 S  per = 13.3  per(accum) = 21.3
 T(global: rintermediate init           ) = 9.337e-05 S  per = 1.13  per(accum) = 22.4
 T(global: rintermediates memcpy cpu2gpu) = 5.700e-08 S  per = 0.000691  per(accum) = 22.4
 T(global: preprocess_formulae_Rlist2   ) = 1.587e-03 S  per = 19.2  per(accum) = 41.7
 T(global: rmmtasks init                ) = 1.453e-03 S  per = 17.6  per(accum) = 59.3
 T(global: qops memset                  ) = 5.800e-08 S  per = 0.000703  per(accum) = 59.3
 T(global: preprocess_renorm_batchGPU   ) = 3.132e-03 S  per =   38  per(accum) = 97.2
 T(global: qops memcpy gpu2cpu          ) = 2.914e-05 S  per = 0.353  per(accum) = 97.6
 T(global: deallocate gpu memory        ) = 7.725e-05 S  per = 0.937  per(accum) = 98.5
 T(global: communication of opS and opH ) = 1.213e-04 S  per = 1.47  per(accum) = 100

isweep=0 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=450:0.00343MB:3.35e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=888:0.00677MB:6.62e-06GB
wf4(diml,dimr,dimc1,dimc2)=(10,4,4,4) nnz=78:0.000595MB
stensor4: wf own=1 _data=0x42f4ef60
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=6 dimAll=10
 (2,0):4 (3,1):2 (1,1):1 (3,-1):1 (4,0):1 (2,2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=42 nblocks=384 size=78:0.000595MB
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
### DIAG TIMING: total=0.000344 t1=1.14e-05, t2=1.64e-05, t3=4.41e-05, t4=0.000116, t5=0.000115, t6=2.49e-05, t7=1.26e-05, t8=3e-06
duration_diagGPU:0.000357
duration_diagreduce:4.06e-06
duration_diagtransform:1.48e-06
rank=0 GPUmem(GB): used=1.04e-05 (oper)=6.62e-06
----- TIMING FOR symbolic_formulae_twodot with size=95 : 6.566e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=95
 no. of hintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.340e-05 S -----
rank=0 GPUmem(GB): used=1.08e-05 (oper,hinter)=6.62e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0027 S size(H_formulae)=95 size(Hxlst2)=42 T(Hmu/Hxlist)=0.000187,0.00251 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00291 S size(H_formulae)=95 size(Hxlst)=2418 -----
rank=0 GPUmem(GB): used=0.000318 (oper,hinter,dvdson,batch)=6.62e-06,3.28e-07,1.16e-06,0.000306 blksize=4 blksize0=8 batchsize=2418
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=78 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000215,0.00197,0.00021 cost=2.86e+04 flops[gemm]=1.46e+07
--- TIMING FOR sigma : t_inter=0.000215 t_gemm=0.00197 t_reduction=0.00021 tot=0.00239 ---
 sigma counter=22 i=0 t=0.000239 per=12.2 cost=1.91e+03 flops=7.98e+06
 sigma counter=22 i=1 t=0.000247 per=12.6 cost=1.9e+03 flops=7.68e+06
 sigma counter=22 i=2 t=0.000242 per=12.3 cost=2.77e+03 flops=1.14e+07
 sigma counter=22 i=3 t=0.000242 per=12.3 cost=2.8e+03 flops=1.16e+07
 sigma counter=22 i=4 t=0.000246 per=12.5 cost=3.03e+03 flops=1.23e+07
 sigma counter=22 i=5 t=0.000253 per=12.9 cost=3.06e+03 flops=1.21e+07
 sigma counter=22 i=6 t=0.000252 per=12.8 cost=6.58e+03 flops=2.61e+07
 sigma counter=22 i=7 t=0.000245 per=12.5 cost=6.58e+03 flops=2.69e+07
 total GEMM cost=2.86e+04 flops=1.46e+07
--- TIMING FOR sigma_tot : t_inter=0.00472 t_gemm=0.043 t_reduction=0.00436 tot=0.0521 ---
 sigma_tot counter=22 i=0 t=0.00528 per=12.3 cost=4.56e+04 flops=8.64e+06
 sigma_tot counter=22 i=1 t=0.00534 per=12.4 cost=4.54e+04 flops=8.49e+06
 sigma_tot counter=22 i=2 t=0.00534 per=12.4 cost=6.14e+04 flops=1.15e+07
 sigma_tot counter=22 i=3 t=0.00532 per=12.4 cost=6.2e+04 flops=1.16e+07
 sigma_tot counter=22 i=4 t=0.0054 per=12.5 cost=8.06e+04 flops=1.49e+07
 sigma_tot counter=22 i=5 t=0.00541 per=12.6 cost=8.13e+04 flops=1.5e+07
 sigma_tot counter=22 i=6 t=0.00555 per=12.9 cost=1.4e+05 flops=2.53e+07
 sigma_tot counter=22 i=7 t=0.00539 per=12.5 cost=1.4e+05 flops=2.6e+07
 total GEMM cost=6.57e+05 flops=1.53e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.1e-05,0.000204,0.00193,0.000196 cost=2.86e+04 flops[gemm]=1.48e+07
--- TIMING FOR sigma : t_inter=0.000204 t_gemm=0.00193 t_reduction=0.000196 tot=0.00233 ---
 sigma counter=23 i=0 t=0.000236 per=12.2 cost=1.91e+03 flops=8.08e+06
 sigma counter=23 i=1 t=0.000242 per=12.5 cost=1.9e+03 flops=7.83e+06
 sigma counter=23 i=2 t=0.000242 per=12.5 cost=2.77e+03 flops=1.14e+07
 sigma counter=23 i=3 t=0.000238 per=12.3 cost=2.8e+03 flops=1.17e+07
 sigma counter=23 i=4 t=0.000241 per=12.5 cost=3.03e+03 flops=1.26e+07
 sigma counter=23 i=5 t=0.000242 per=12.5 cost=3.06e+03 flops=1.27e+07
 sigma counter=23 i=6 t=0.000251 per=13 cost=6.58e+03 flops=2.62e+07
 sigma counter=23 i=7 t=0.000241 per=12.5 cost=6.58e+03 flops=2.73e+07
 total GEMM cost=2.86e+04 flops=1.48e+07
--- TIMING FOR sigma_tot : t_inter=0.00493 t_gemm=0.045 t_reduction=0.00456 tot=0.0544 ---
 sigma_tot counter=23 i=0 t=0.00551 per=12.3 cost=4.75e+04 flops=8.62e+06
 sigma_tot counter=23 i=1 t=0.00559 per=12.4 cost=4.73e+04 flops=8.46e+06
 sigma_tot counter=23 i=2 t=0.00558 per=12.4 cost=6.42e+04 flops=1.15e+07
 sigma_tot counter=23 i=3 t=0.00556 per=12.4 cost=6.48e+04 flops=1.17e+07
 sigma_tot counter=23 i=4 t=0.00564 per=12.5 cost=8.36e+04 flops=1.48e+07
 sigma_tot counter=23 i=5 t=0.00565 per=12.6 cost=8.43e+04 flops=1.49e+07
 sigma_tot counter=23 i=6 t=0.0058 per=12.9 cost=1.47e+05 flops=2.53e+07
 sigma_tot counter=23 i=7 t=0.00563 per=12.5 cost=1.47e+05 flops=2.61e+07
 total GEMM cost=6.85e+05 flops=1.52e+07
settings: ndim=78 neig=2 maxcycle=30 nbuff=4 memory=1.05e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.640904511296 -1.003e+03  1.430e-01    2     2  5.224e-03 2.612e-03
    1   1 -      -2.405194923912 -1.002e+03  1.989e-01    2     2  5.224e-03 2.612e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.160e-04,1.929e-03,1.960e-04 cost=2.862e+04 flops[gemm]=1.484e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=1.928e-03 t_reduction=1.960e-04 tot=2.340e-03 ---
 sigma counter=24 i=0 t=2.370e-04 per=1.229e+01 cost=1.908e+03 flops=8.051e+06
 sigma counter=24 i=1 t=2.430e-04 per=1.260e+01 cost=1.896e+03 flops=7.802e+06
 sigma counter=24 i=2 t=2.370e-04 per=1.229e+01 cost=2.768e+03 flops=1.168e+07
 sigma counter=24 i=3 t=2.380e-04 per=1.234e+01 cost=2.796e+03 flops=1.175e+07
 sigma counter=24 i=4 t=2.440e-04 per=1.266e+01 cost=3.028e+03 flops=1.241e+07
 sigma counter=24 i=5 t=2.410e-04 per=1.250e+01 cost=3.064e+03 flops=1.271e+07
 sigma counter=24 i=6 t=2.470e-04 per=1.281e+01 cost=6.580e+03 flops=2.664e+07
 sigma counter=24 i=7 t=2.410e-04 per=1.250e+01 cost=6.580e+03 flops=2.730e+07
 total GEMM cost=2.862e+04 flops=1.484e+07
--- TIMING FOR sigma_tot : t_inter=5.143e-03 t_gemm=4.689e-02 t_reduction=4.752e-03 tot=5.678e-02 ---
 sigma_tot counter=24 i=0 t=5.749e-03 per=1.226e+01 cost=4.941e+04 flops=8.594e+06
 sigma_tot counter=24 i=1 t=5.830e-03 per=1.243e+01 cost=4.918e+04 flops=8.436e+06
 sigma_tot counter=24 i=2 t=5.814e-03 per=1.240e+01 cost=6.697e+04 flops=1.152e+07
 sigma_tot counter=24 i=3 t=5.797e-03 per=1.236e+01 cost=6.756e+04 flops=1.165e+07
 sigma_tot counter=24 i=4 t=5.883e-03 per=1.255e+01 cost=8.662e+04 flops=1.472e+07
 sigma_tot counter=24 i=5 t=5.891e-03 per=1.256e+01 cost=8.741e+04 flops=1.484e+07
 sigma_tot counter=24 i=6 t=6.050e-03 per=1.290e+01 cost=1.534e+05 flops=2.536e+07
 sigma_tot counter=24 i=7 t=5.873e-03 per=1.253e+01 cost=1.534e+05 flops=2.612e+07
 total GEMM cost=7.140e+05 flops=1.523e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.000e-05,2.050e-04,1.928e-03,1.950e-04 cost=2.862e+04 flops[gemm]=1.484e+07
--- TIMING FOR sigma : t_inter=2.050e-04 t_gemm=1.928e-03 t_reduction=1.950e-04 tot=2.328e-03 ---
 sigma counter=25 i=0 t=2.360e-04 per=1.224e+01 cost=1.908e+03 flops=8.085e+06
 sigma counter=25 i=1 t=2.430e-04 per=1.260e+01 cost=1.896e+03 flops=7.802e+06
 sigma counter=25 i=2 t=2.380e-04 per=1.234e+01 cost=2.768e+03 flops=1.163e+07
 sigma counter=25 i=3 t=2.370e-04 per=1.229e+01 cost=2.796e+03 flops=1.180e+07
 sigma counter=25 i=4 t=2.400e-04 per=1.245e+01 cost=3.028e+03 flops=1.262e+07
 sigma counter=25 i=5 t=2.430e-04 per=1.260e+01 cost=3.064e+03 flops=1.261e+07
 sigma counter=25 i=6 t=2.510e-04 per=1.302e+01 cost=6.580e+03 flops=2.622e+07
 sigma counter=25 i=7 t=2.400e-04 per=1.245e+01 cost=6.580e+03 flops=2.742e+07
 total GEMM cost=2.862e+04 flops=1.484e+07
--- TIMING FOR sigma_tot : t_inter=5.348e-03 t_gemm=4.881e-02 t_reduction=4.947e-03 tot=5.911e-02 ---
 sigma_tot counter=25 i=0 t=5.985e-03 per=1.226e+01 cost=5.132e+04 flops=8.574e+06
 sigma_tot counter=25 i=1 t=6.073e-03 per=1.244e+01 cost=5.108e+04 flops=8.411e+06
 sigma_tot counter=25 i=2 t=6.052e-03 per=1.240e+01 cost=6.974e+04 flops=1.152e+07
 sigma_tot counter=25 i=3 t=6.034e-03 per=1.236e+01 cost=7.036e+04 flops=1.166e+07
 sigma_tot counter=25 i=4 t=6.123e-03 per=1.254e+01 cost=8.964e+04 flops=1.464e+07
 sigma_tot counter=25 i=5 t=6.134e-03 per=1.257e+01 cost=9.047e+04 flops=1.475e+07
 sigma_tot counter=25 i=6 t=6.301e-03 per=1.291e+01 cost=1.600e+05 flops=2.539e+07
 sigma_tot counter=25 i=7 t=6.113e-03 per=1.252e+01 cost=1.600e+05 flops=2.617e+07
 total GEMM cost=7.426e+05 flops=1.521e+07
    2   0 -      -2.650498198785 -9.594e-03  3.194e-02    4     4  1.035e-02 2.589e-03
    2   1 -      -2.425167532592 -1.997e-02  5.856e-02    4     4  1.035e-02 2.589e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.130e-04,1.961e-03,1.960e-04 cost=2.862e+04 flops[gemm]=1.459e+07
--- TIMING FOR sigma : t_inter=2.130e-04 t_gemm=1.961e-03 t_reduction=1.950e-04 tot=2.369e-03 ---
 sigma counter=26 i=0 t=2.370e-04 per=1.209e+01 cost=1.908e+03 flops=8.051e+06
 sigma counter=26 i=1 t=2.330e-04 per=1.188e+01 cost=1.896e+03 flops=8.137e+06
 sigma counter=26 i=2 t=2.440e-04 per=1.244e+01 cost=2.768e+03 flops=1.134e+07
 sigma counter=26 i=3 t=2.470e-04 per=1.260e+01 cost=2.796e+03 flops=1.132e+07
 sigma counter=26 i=4 t=2.480e-04 per=1.265e+01 cost=3.028e+03 flops=1.221e+07
 sigma counter=26 i=5 t=2.460e-04 per=1.254e+01 cost=3.064e+03 flops=1.246e+07
 sigma counter=26 i=6 t=2.530e-04 per=1.290e+01 cost=6.580e+03 flops=2.601e+07
 sigma counter=26 i=7 t=2.530e-04 per=1.290e+01 cost=6.580e+03 flops=2.601e+07
 total GEMM cost=2.862e+04 flops=1.459e+07
--- TIMING FOR sigma_tot : t_inter=5.561e-03 t_gemm=5.078e-02 t_reduction=5.142e-03 tot=6.148e-02 ---
 sigma_tot counter=26 i=0 t=6.222e-03 per=1.225e+01 cost=5.322e+04 flops=8.554e+06
 sigma_tot counter=26 i=1 t=6.306e-03 per=1.242e+01 cost=5.298e+04 flops=8.401e+06
 sigma_tot counter=26 i=2 t=6.296e-03 per=1.240e+01 cost=7.250e+04 flops=1.152e+07
 sigma_tot counter=26 i=3 t=6.281e-03 per=1.237e+01 cost=7.316e+04 flops=1.165e+07
 sigma_tot counter=26 i=4 t=6.371e-03 per=1.255e+01 cost=9.267e+04 flops=1.455e+07
 sigma_tot counter=26 i=5 t=6.380e-03 per=1.256e+01 cost=9.354e+04 flops=1.466e+07
 sigma_tot counter=26 i=6 t=6.554e-03 per=1.291e+01 cost=1.666e+05 flops=2.542e+07
 sigma_tot counter=26 i=7 t=6.366e-03 per=1.254e+01 cost=1.666e+05 flops=2.616e+07
 total GEMM cost=7.712e+05 flops=1.519e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.070e-04,1.931e-03,1.960e-04 cost=2.862e+04 flops[gemm]=1.482e+07
--- TIMING FOR sigma : t_inter=2.070e-04 t_gemm=1.931e-03 t_reduction=1.960e-04 tot=2.334e-03 ---
 sigma counter=27 i=0 t=2.320e-04 per=1.201e+01 cost=1.908e+03 flops=8.224e+06
 sigma counter=27 i=1 t=2.430e-04 per=1.258e+01 cost=1.896e+03 flops=7.802e+06
 sigma counter=27 i=2 t=2.400e-04 per=1.243e+01 cost=2.768e+03 flops=1.153e+07
 sigma counter=27 i=3 t=2.400e-04 per=1.243e+01 cost=2.796e+03 flops=1.165e+07
 sigma counter=27 i=4 t=2.420e-04 per=1.253e+01 cost=3.028e+03 flops=1.251e+07
 sigma counter=27 i=5 t=2.430e-04 per=1.258e+01 cost=3.064e+03 flops=1.261e+07
 sigma counter=27 i=6 t=2.480e-04 per=1.284e+01 cost=6.580e+03 flops=2.653e+07
 sigma counter=27 i=7 t=2.430e-04 per=1.258e+01 cost=6.580e+03 flops=2.708e+07
 total GEMM cost=2.862e+04 flops=1.482e+07
--- TIMING FOR sigma_tot : t_inter=5.768e-03 t_gemm=5.271e-02 t_reduction=5.338e-03 tot=6.381e-02 ---
 sigma_tot counter=27 i=0 t=6.454e-03 per=1.225e+01 cost=5.513e+04 flops=8.542e+06
 sigma_tot counter=27 i=1 t=6.549e-03 per=1.243e+01 cost=5.487e+04 flops=8.379e+06
 sigma_tot counter=27 i=2 t=6.536e-03 per=1.240e+01 cost=7.527e+04 flops=1.152e+07
 sigma_tot counter=27 i=3 t=6.521e-03 per=1.237e+01 cost=7.595e+04 flops=1.165e+07
 sigma_tot counter=27 i=4 t=6.613e-03 per=1.255e+01 cost=9.570e+04 flops=1.447e+07
 sigma_tot counter=27 i=5 t=6.623e-03 per=1.257e+01 cost=9.660e+04 flops=1.459e+07
 sigma_tot counter=27 i=6 t=6.802e-03 per=1.291e+01 cost=1.732e+05 flops=2.546e+07
 sigma_tot counter=27 i=7 t=6.609e-03 per=1.254e+01 cost=1.731e+05 flops=2.620e+07
 total GEMM cost=7.998e+05 flops=1.518e+07
    3   0 -      -2.651051650627 -5.535e-04  6.685e-03    6     6  1.549e-02 2.582e-03
    3   1 -      -2.427537870228 -2.370e-03  1.156e-02    6     6  1.549e-02 2.582e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.150e-04,1.976e-03,2.020e-04 cost=2.862e+04 flops[gemm]=1.448e+07
--- TIMING FOR sigma : t_inter=2.150e-04 t_gemm=1.973e-03 t_reduction=2.020e-04 tot=2.390e-03 ---
 sigma counter=28 i=0 t=2.370e-04 per=1.201e+01 cost=1.908e+03 flops=8.051e+06
 sigma counter=28 i=1 t=2.350e-04 per=1.191e+01 cost=1.896e+03 flops=8.068e+06
 sigma counter=28 i=2 t=2.460e-04 per=1.247e+01 cost=2.768e+03 flops=1.125e+07
 sigma counter=28 i=3 t=2.510e-04 per=1.272e+01 cost=2.796e+03 flops=1.114e+07
 sigma counter=28 i=4 t=2.490e-04 per=1.262e+01 cost=3.028e+03 flops=1.216e+07
 sigma counter=28 i=5 t=2.470e-04 per=1.252e+01 cost=3.064e+03 flops=1.240e+07
 sigma counter=28 i=6 t=2.530e-04 per=1.282e+01 cost=6.580e+03 flops=2.601e+07
 sigma counter=28 i=7 t=2.550e-04 per=1.292e+01 cost=6.580e+03 flops=2.580e+07
 total GEMM cost=2.862e+04 flops=1.451e+07
--- TIMING FOR sigma_tot : t_inter=5.983e-03 t_gemm=5.468e-02 t_reduction=5.540e-03 tot=6.620e-02 ---
 sigma_tot counter=28 i=0 t=6.691e-03 per=1.224e+01 cost=5.704e+04 flops=8.525e+06
 sigma_tot counter=28 i=1 t=6.784e-03 per=1.241e+01 cost=5.677e+04 flops=8.368e+06
 sigma_tot counter=28 i=2 t=6.782e-03 per=1.240e+01 cost=7.804e+04 flops=1.151e+07
 sigma_tot counter=28 i=3 t=6.772e-03 per=1.238e+01 cost=7.875e+04 flops=1.163e+07
 sigma_tot counter=28 i=4 t=6.862e-03 per=1.255e+01 cost=9.873e+04 flops=1.439e+07
 sigma_tot counter=28 i=5 t=6.870e-03 per=1.256e+01 cost=9.966e+04 flops=1.451e+07
 sigma_tot counter=28 i=6 t=7.055e-03 per=1.290e+01 cost=1.798e+05 flops=2.548e+07
 sigma_tot counter=28 i=7 t=6.864e-03 per=1.255e+01 cost=1.797e+05 flops=2.618e+07
 total GEMM cost=8.285e+05 flops=1.515e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.120e-04,1.951e-03,1.940e-04 cost=2.862e+04 flops[gemm]=1.467e+07
--- TIMING FOR sigma : t_inter=2.120e-04 t_gemm=1.951e-03 t_reduction=1.940e-04 tot=2.357e-03 ---
 sigma counter=29 i=0 t=2.450e-04 per=1.256e+01 cost=1.908e+03 flops=7.788e+06
 sigma counter=29 i=1 t=2.440e-04 per=1.251e+01 cost=1.896e+03 flops=7.770e+06
 sigma counter=29 i=2 t=2.440e-04 per=1.251e+01 cost=2.768e+03 flops=1.134e+07
 sigma counter=29 i=3 t=2.400e-04 per=1.230e+01 cost=2.796e+03 flops=1.165e+07
 sigma counter=29 i=4 t=2.430e-04 per=1.246e+01 cost=3.028e+03 flops=1.246e+07
 sigma counter=29 i=5 t=2.430e-04 per=1.246e+01 cost=3.064e+03 flops=1.261e+07
 sigma counter=29 i=6 t=2.490e-04 per=1.276e+01 cost=6.580e+03 flops=2.643e+07
 sigma counter=29 i=7 t=2.430e-04 per=1.246e+01 cost=6.580e+03 flops=2.708e+07
 total GEMM cost=2.862e+04 flops=1.467e+07
--- TIMING FOR sigma_tot : t_inter=6.195e-03 t_gemm=5.663e-02 t_reduction=5.734e-03 tot=6.856e-02 ---
 sigma_tot counter=29 i=0 t=6.936e-03 per=1.225e+01 cost=5.895e+04 flops=8.499e+06
 sigma_tot counter=29 i=1 t=7.028e-03 per=1.241e+01 cost=5.866e+04 flops=8.347e+06
 sigma_tot counter=29 i=2 t=7.026e-03 per=1.241e+01 cost=8.081e+04 flops=1.150e+07
 sigma_tot counter=29 i=3 t=7.012e-03 per=1.238e+01 cost=8.154e+04 flops=1.163e+07
 sigma_tot counter=29 i=4 t=7.105e-03 per=1.255e+01 cost=1.018e+05 flops=1.432e+07
 sigma_tot counter=29 i=5 t=7.113e-03 per=1.256e+01 cost=1.027e+05 flops=1.444e+07
 sigma_tot counter=29 i=6 t=7.304e-03 per=1.290e+01 cost=1.863e+05 flops=2.551e+07
 sigma_tot counter=29 i=7 t=7.107e-03 per=1.255e+01 cost=1.863e+05 flops=2.621e+07
 total GEMM cost=8.571e+05 flops=1.513e+07
    4   0 -      -2.651086684396 -3.503e-05  2.385e-03    6     8  2.069e-02 2.586e-03
    4   1 -      -2.427625830759 -8.796e-05  4.428e-03    6     8  2.069e-02 2.586e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.120e-04,1.977e-03,1.960e-04 cost=2.862e+04 flops[gemm]=1.448e+07
--- TIMING FOR sigma : t_inter=2.120e-04 t_gemm=1.977e-03 t_reduction=1.960e-04 tot=2.385e-03 ---
 sigma counter=30 i=0 t=2.360e-04 per=1.194e+01 cost=1.908e+03 flops=8.085e+06
 sigma counter=30 i=1 t=2.350e-04 per=1.189e+01 cost=1.896e+03 flops=8.068e+06
 sigma counter=30 i=2 t=2.440e-04 per=1.234e+01 cost=2.768e+03 flops=1.134e+07
 sigma counter=30 i=3 t=2.480e-04 per=1.254e+01 cost=2.796e+03 flops=1.127e+07
 sigma counter=30 i=4 t=2.520e-04 per=1.275e+01 cost=3.028e+03 flops=1.202e+07
 sigma counter=30 i=5 t=2.480e-04 per=1.254e+01 cost=3.064e+03 flops=1.235e+07
 sigma counter=30 i=6 t=2.610e-04 per=1.320e+01 cost=6.580e+03 flops=2.521e+07
 sigma counter=30 i=7 t=2.530e-04 per=1.280e+01 cost=6.580e+03 flops=2.601e+07
 total GEMM cost=2.862e+04 flops=1.448e+07
--- TIMING FOR sigma_tot : t_inter=6.407e-03 t_gemm=5.861e-02 t_reduction=5.930e-03 tot=7.095e-02 ---
 sigma_tot counter=30 i=0 t=7.172e-03 per=1.224e+01 cost=6.086e+04 flops=8.485e+06
 sigma_tot counter=30 i=1 t=7.263e-03 per=1.239e+01 cost=6.056e+04 flops=8.338e+06
 sigma_tot counter=30 i=2 t=7.270e-03 per=1.240e+01 cost=8.358e+04 flops=1.150e+07
 sigma_tot counter=30 i=3 t=7.260e-03 per=1.239e+01 cost=8.434e+04 flops=1.162e+07
 sigma_tot counter=30 i=4 t=7.357e-03 per=1.255e+01 cost=1.048e+05 flops=1.424e+07
 sigma_tot counter=30 i=5 t=7.361e-03 per=1.256e+01 cost=1.058e+05 flops=1.437e+07
 sigma_tot counter=30 i=6 t=7.565e-03 per=1.291e+01 cost=1.929e+05 flops=2.550e+07
 sigma_tot counter=30 i=7 t=7.360e-03 per=1.256e+01 cost=1.929e+05 flops=2.621e+07
 total GEMM cost=8.857e+05 flops=1.511e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.110e-04,1.956e-03,2.000e-04 cost=2.862e+04 flops[gemm]=1.463e+07
--- TIMING FOR sigma : t_inter=2.110e-04 t_gemm=1.954e-03 t_reduction=2.000e-04 tot=2.365e-03 ---
 sigma counter=31 i=0 t=2.400e-04 per=1.228e+01 cost=1.908e+03 flops=7.950e+06
 sigma counter=31 i=1 t=2.470e-04 per=1.264e+01 cost=1.896e+03 flops=7.676e+06
 sigma counter=31 i=2 t=2.460e-04 per=1.259e+01 cost=2.768e+03 flops=1.125e+07
 sigma counter=31 i=3 t=2.430e-04 per=1.244e+01 cost=2.796e+03 flops=1.151e+07
 sigma counter=31 i=4 t=2.460e-04 per=1.259e+01 cost=3.028e+03 flops=1.231e+07
 sigma counter=31 i=5 t=2.440e-04 per=1.249e+01 cost=3.064e+03 flops=1.256e+07
 sigma counter=31 i=6 t=2.480e-04 per=1.269e+01 cost=6.580e+03 flops=2.653e+07
 sigma counter=31 i=7 t=2.400e-04 per=1.228e+01 cost=6.580e+03 flops=2.742e+07
 total GEMM cost=2.862e+04 flops=1.465e+07
--- TIMING FOR sigma_tot : t_inter=6.618e-03 t_gemm=6.056e-02 t_reduction=6.130e-03 tot=7.331e-02 ---
 sigma_tot counter=31 i=0 t=7.412e-03 per=1.224e+01 cost=6.276e+04 flops=8.468e+06
 sigma_tot counter=31 i=1 t=7.510e-03 per=1.240e+01 cost=6.246e+04 flops=8.316e+06
 sigma_tot counter=31 i=2 t=7.516e-03 per=1.241e+01 cost=8.634e+04 flops=1.149e+07
 sigma_tot counter=31 i=3 t=7.503e-03 per=1.239e+01 cost=8.714e+04 flops=1.161e+07
 sigma_tot counter=31 i=4 t=7.603e-03 per=1.255e+01 cost=1.078e+05 flops=1.418e+07
 sigma_tot counter=31 i=5 t=7.605e-03 per=1.256e+01 cost=1.089e+05 flops=1.431e+07
 sigma_tot counter=31 i=6 t=7.813e-03 per=1.290e+01 cost=1.995e+05 flops=2.553e+07
 sigma_tot counter=31 i=7 t=7.600e-03 per=1.255e+01 cost=1.995e+05 flops=2.624e+07
 total GEMM cost=9.143e+05 flops=1.510e+07
    5   0 -      -2.651091758814 -5.074e-06  1.209e-03    6    10  2.587e-02 2.587e-03
    5   1 -      -2.427640478677 -1.465e-05  1.746e-03    6    10  2.587e-02 2.587e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.130e-04,1.934e-03,1.940e-04 cost=2.862e+04 flops[gemm]=1.480e+07
--- TIMING FOR sigma : t_inter=2.130e-04 t_gemm=1.933e-03 t_reduction=1.940e-04 tot=2.340e-03 ---
 sigma counter=32 i=0 t=2.350e-04 per=1.216e+01 cost=1.908e+03 flops=8.119e+06
 sigma counter=32 i=1 t=2.440e-04 per=1.262e+01 cost=1.896e+03 flops=7.770e+06
 sigma counter=32 i=2 t=2.410e-04 per=1.247e+01 cost=2.768e+03 flops=1.149e+07
 sigma counter=32 i=3 t=2.400e-04 per=1.242e+01 cost=2.796e+03 flops=1.165e+07
 sigma counter=32 i=4 t=2.400e-04 per=1.242e+01 cost=3.028e+03 flops=1.262e+07
 sigma counter=32 i=5 t=2.420e-04 per=1.252e+01 cost=3.064e+03 flops=1.266e+07
 sigma counter=32 i=6 t=2.480e-04 per=1.283e+01 cost=6.580e+03 flops=2.653e+07
 sigma counter=32 i=7 t=2.430e-04 per=1.257e+01 cost=6.580e+03 flops=2.708e+07
 total GEMM cost=2.862e+04 flops=1.481e+07
--- TIMING FOR sigma_tot : t_inter=6.831e-03 t_gemm=6.249e-02 t_reduction=6.324e-03 tot=7.565e-02 ---
 sigma_tot counter=32 i=0 t=7.647e-03 per=1.224e+01 cost=6.467e+04 flops=8.457e+06
 sigma_tot counter=32 i=1 t=7.754e-03 per=1.241e+01 cost=6.435e+04 flops=8.299e+06
 sigma_tot counter=32 i=2 t=7.757e-03 per=1.241e+01 cost=8.911e+04 flops=1.149e+07
 sigma_tot counter=32 i=3 t=7.743e-03 per=1.239e+01 cost=8.993e+04 flops=1.161e+07
 sigma_tot counter=32 i=4 t=7.843e-03 per=1.255e+01 cost=1.108e+05 flops=1.413e+07
 sigma_tot counter=32 i=5 t=7.847e-03 per=1.256e+01 cost=1.119e+05 flops=1.426e+07
 sigma_tot counter=32 i=6 t=8.061e-03 per=1.290e+01 cost=2.061e+05 flops=2.556e+07
 sigma_tot counter=32 i=7 t=7.843e-03 per=1.255e+01 cost=2.060e+05 flops=2.627e+07
 total GEMM cost=9.429e+05 flops=1.509e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.080e-04,1.931e-03,1.950e-04 cost=2.862e+04 flops[gemm]=1.482e+07
--- TIMING FOR sigma : t_inter=2.080e-04 t_gemm=1.930e-03 t_reduction=1.940e-04 tot=2.332e-03 ---
 sigma counter=33 i=0 t=2.310e-04 per=1.197e+01 cost=1.908e+03 flops=8.260e+06
 sigma counter=33 i=1 t=2.420e-04 per=1.254e+01 cost=1.896e+03 flops=7.835e+06
 sigma counter=33 i=2 t=2.410e-04 per=1.249e+01 cost=2.768e+03 flops=1.149e+07
 sigma counter=33 i=3 t=2.400e-04 per=1.244e+01 cost=2.796e+03 flops=1.165e+07
 sigma counter=33 i=4 t=2.420e-04 per=1.254e+01 cost=3.028e+03 flops=1.251e+07
 sigma counter=33 i=5 t=2.420e-04 per=1.254e+01 cost=3.064e+03 flops=1.266e+07
 sigma counter=33 i=6 t=2.460e-04 per=1.275e+01 cost=6.580e+03 flops=2.675e+07
 sigma counter=33 i=7 t=2.460e-04 per=1.275e+01 cost=6.580e+03 flops=2.675e+07
 total GEMM cost=2.862e+04 flops=1.483e+07
--- TIMING FOR sigma_tot : t_inter=7.039e-03 t_gemm=6.442e-02 t_reduction=6.518e-03 tot=7.798e-02 ---
 sigma_tot counter=33 i=0 t=7.878e-03 per=1.223e+01 cost=6.658e+04 flops=8.451e+06
 sigma_tot counter=33 i=1 t=7.996e-03 per=1.241e+01 cost=6.625e+04 flops=8.285e+06
 sigma_tot counter=33 i=2 t=7.998e-03 per=1.241e+01 cost=9.188e+04 flops=1.149e+07
 sigma_tot counter=33 i=3 t=7.983e-03 per=1.239e+01 cost=9.273e+04 flops=1.162e+07
 sigma_tot counter=33 i=4 t=8.085e-03 per=1.255e+01 cost=1.139e+05 flops=1.408e+07
 sigma_tot counter=33 i=5 t=8.089e-03 per=1.256e+01 cost=1.150e+05 flops=1.421e+07
 sigma_tot counter=33 i=6 t=8.307e-03 per=1.289e+01 cost=2.127e+05 flops=2.560e+07
 sigma_tot counter=33 i=7 t=8.089e-03 per=1.256e+01 cost=2.126e+05 flops=2.628e+07
 total GEMM cost=9.716e+05 flops=1.508e+07
    6   0 -      -2.651092751738 -9.929e-07  3.542e-04    6    12  3.096e-02 2.580e-03
    6   1 -      -2.427643024061 -2.545e-06  4.450e-04    6    12  3.096e-02 2.580e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.130e-04,1.966e-03,1.960e-04 cost=2.862e+04 flops[gemm]=1.456e+07
--- TIMING FOR sigma : t_inter=2.130e-04 t_gemm=1.966e-03 t_reduction=1.960e-04 tot=2.375e-03 ---
 sigma counter=34 i=0 t=2.370e-04 per=1.205e+01 cost=1.908e+03 flops=8.051e+06
 sigma counter=34 i=1 t=2.380e-04 per=1.211e+01 cost=1.896e+03 flops=7.966e+06
 sigma counter=34 i=2 t=2.450e-04 per=1.246e+01 cost=2.768e+03 flops=1.130e+07
 sigma counter=34 i=3 t=2.450e-04 per=1.246e+01 cost=2.796e+03 flops=1.141e+07
 sigma counter=34 i=4 t=2.460e-04 per=1.251e+01 cost=3.028e+03 flops=1.231e+07
 sigma counter=34 i=5 t=2.490e-04 per=1.267e+01 cost=3.064e+03 flops=1.231e+07
 sigma counter=34 i=6 t=2.570e-04 per=1.307e+01 cost=6.580e+03 flops=2.560e+07
 sigma counter=34 i=7 t=2.490e-04 per=1.267e+01 cost=6.580e+03 flops=2.643e+07
 total GEMM cost=2.862e+04 flops=1.456e+07
--- TIMING FOR sigma_tot : t_inter=7.252e-03 t_gemm=6.639e-02 t_reduction=6.714e-03 tot=8.036e-02 ---
 sigma_tot counter=34 i=0 t=8.115e-03 per=1.222e+01 cost=6.849e+04 flops=8.440e+06
 sigma_tot counter=34 i=1 t=8.234e-03 per=1.240e+01 cost=6.814e+04 flops=8.276e+06
 sigma_tot counter=34 i=2 t=8.243e-03 per=1.242e+01 cost=9.465e+04 flops=1.148e+07
 sigma_tot counter=34 i=3 t=8.228e-03 per=1.239e+01 cost=9.552e+04 flops=1.161e+07
 sigma_tot counter=34 i=4 t=8.331e-03 per=1.255e+01 cost=1.169e+05 flops=1.403e+07
 sigma_tot counter=34 i=5 t=8.338e-03 per=1.256e+01 cost=1.180e+05 flops=1.416e+07
 sigma_tot counter=34 i=6 t=8.564e-03 per=1.290e+01 cost=2.192e+05 flops=2.560e+07
 sigma_tot counter=34 i=7 t=8.338e-03 per=1.256e+01 cost=2.192e+05 flops=2.629e+07
 total GEMM cost=1.000e+06 flops=1.506e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.070e-04,1.924e-03,1.950e-04 cost=2.862e+04 flops[gemm]=1.488e+07
--- TIMING FOR sigma : t_inter=2.070e-04 t_gemm=1.924e-03 t_reduction=1.950e-04 tot=2.326e-03 ---
 sigma counter=35 i=0 t=2.340e-04 per=1.216e+01 cost=1.908e+03 flops=8.154e+06
 sigma counter=35 i=1 t=2.410e-04 per=1.253e+01 cost=1.896e+03 flops=7.867e+06
 sigma counter=35 i=2 t=2.370e-04 per=1.232e+01 cost=2.768e+03 flops=1.168e+07
 sigma counter=35 i=3 t=2.430e-04 per=1.263e+01 cost=2.796e+03 flops=1.151e+07
 sigma counter=35 i=4 t=2.390e-04 per=1.242e+01 cost=3.028e+03 flops=1.267e+07
 sigma counter=35 i=5 t=2.400e-04 per=1.247e+01 cost=3.064e+03 flops=1.277e+07
 sigma counter=35 i=6 t=2.480e-04 per=1.289e+01 cost=6.580e+03 flops=2.653e+07
 sigma counter=35 i=7 t=2.420e-04 per=1.258e+01 cost=6.580e+03 flops=2.719e+07
 total GEMM cost=2.862e+04 flops=1.488e+07
--- TIMING FOR sigma_tot : t_inter=7.459e-03 t_gemm=6.831e-02 t_reduction=6.909e-03 tot=8.268e-02 ---
 sigma_tot counter=35 i=0 t=8.349e-03 per=1.222e+01 cost=7.040e+04 flops=8.432e+06
 sigma_tot counter=35 i=1 t=8.475e-03 per=1.241e+01 cost=7.004e+04 flops=8.264e+06
 sigma_tot counter=35 i=2 t=8.480e-03 per=1.241e+01 cost=9.742e+04 flops=1.149e+07
 sigma_tot counter=35 i=3 t=8.471e-03 per=1.240e+01 cost=9.832e+04 flops=1.161e+07
 sigma_tot counter=35 i=4 t=8.570e-03 per=1.254e+01 cost=1.199e+05 flops=1.399e+07
 sigma_tot counter=35 i=5 t=8.578e-03 per=1.256e+01 cost=1.211e+05 flops=1.412e+07
 sigma_tot counter=35 i=6 t=8.812e-03 per=1.290e+01 cost=2.258e+05 flops=2.563e+07
 sigma_tot counter=35 i=7 t=8.580e-03 per=1.256e+01 cost=2.258e+05 flops=2.631e+07
 total GEMM cost=1.029e+06 flops=1.506e+07
    7   0 +      -2.651092827717 -7.598e-08  9.152e-05    6    14  3.608e-02 2.577e-03
    7   1 -      -2.427643166641 -1.426e-07  1.327e-04    6    14  3.608e-02 2.577e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.110e-04,1.932e-03,1.970e-04 cost=2.862e+04 flops[gemm]=1.481e+07
--- TIMING FOR sigma : t_inter=2.110e-04 t_gemm=1.932e-03 t_reduction=1.960e-04 tot=2.339e-03 ---
 sigma counter=36 i=0 t=2.410e-04 per=1.247e+01 cost=1.908e+03 flops=7.917e+06
 sigma counter=36 i=1 t=2.420e-04 per=1.253e+01 cost=1.896e+03 flops=7.835e+06
 sigma counter=36 i=2 t=2.390e-04 per=1.237e+01 cost=2.768e+03 flops=1.158e+07
 sigma counter=36 i=3 t=2.370e-04 per=1.227e+01 cost=2.796e+03 flops=1.180e+07
 sigma counter=36 i=4 t=2.440e-04 per=1.263e+01 cost=3.028e+03 flops=1.241e+07
 sigma counter=36 i=5 t=2.410e-04 per=1.247e+01 cost=3.064e+03 flops=1.271e+07
 sigma counter=36 i=6 t=2.480e-04 per=1.284e+01 cost=6.580e+03 flops=2.653e+07
 sigma counter=36 i=7 t=2.400e-04 per=1.242e+01 cost=6.580e+03 flops=2.742e+07
 total GEMM cost=2.862e+04 flops=1.481e+07
--- TIMING FOR sigma_tot : t_inter=7.670e-03 t_gemm=7.025e-02 t_reduction=7.105e-03 tot=8.502e-02 ---
 sigma_tot counter=36 i=0 t=8.590e-03 per=1.223e+01 cost=7.230e+04 flops=8.417e+06
 sigma_tot counter=36 i=1 t=8.717e-03 per=1.241e+01 cost=7.194e+04 flops=8.252e+06
 sigma_tot counter=36 i=2 t=8.719e-03 per=1.241e+01 cost=1.002e+05 flops=1.149e+07
 sigma_tot counter=36 i=3 t=8.708e-03 per=1.240e+01 cost=1.011e+05 flops=1.161e+07
 sigma_tot counter=36 i=4 t=8.814e-03 per=1.255e+01 cost=1.230e+05 flops=1.395e+07
 sigma_tot counter=36 i=5 t=8.819e-03 per=1.255e+01 cost=1.242e+05 flops=1.408e+07
 sigma_tot counter=36 i=6 t=9.060e-03 per=1.290e+01 cost=2.324e+05 flops=2.565e+07
 sigma_tot counter=36 i=7 t=8.820e-03 per=1.256e+01 cost=2.324e+05 flops=2.634e+07
 total GEMM cost=1.057e+06 flops=1.505e+07
    8   0 +      -2.651092827717 -5.551e-14  9.152e-05    5    15  3.865e-02 2.577e-03
    8   1 +      -2.427643182213 -1.557e-08  5.454e-05    5    15  3.865e-02 2.577e-03
TIMING FOR Davidson : 3.869e-02  T(cal/comm/rest)=3.803e-02,4.969e-05,6.083e-04
optimized energies: isweep=0 dots=2 ibond=2 e[0]=-2.65109282772 nmvp=15
optimized energies: isweep=0 dots=2 ibond=2 e[1]=-2.42764318221 nmvp=15
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row_nkr dcut=10 nqr=9 alg_decim=1 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
----- TMING FOR decimation_genbasis: 2.4e-04 S T(scatter/comp/gather)=3.5e-05,2.5e-05,1.8e-04 -----
decimation summary: 16->10 dwt=+1.379e-03 SvN=1.072e+00
 qbond: qkept nsym=5 dimAll=10
 (2,0):4 (1,1):2 (1,-1):2 (0,0):1 (2,2):1
----- TIMING for decimation_row: 4.767e-04 S T(decim/formRot)=2.938e-04,1.828e-04 -----
TIMING FOR decimation: 7.886e-04 S T(wf/decim)=2.759e-04,5.127e-04
ctns::oper_renorm coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:1.984e-04MB size(tot)=499:3.807e-03MB:3.718e-06GB
rank=0 GPUmem(GB): used=1.112e-05 (oper)=5.893e-06
rank=0 GPUmem(GB): used=1.131e-05 (oper,site)(GB)=5.893e-06,1.937e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 5.894e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=1.13e-05 (oper,site,rinter)=5.89e-06,1.94e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000671 S size(rtasks)=37 size(Rlst2)=5 T(Rmu/Rlist)=0.000196,0.000474 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000717 S size(rtasks)=37 size(Rlst)=451 -----
rank=0 GPUmem(GB): used=0.000122 (oper,site,rinter,batch)=5.89e-06,1.94e-07,0,0.000111 blksize=16 blksize0=0 batchsize=451
timing: allocate=3.48e-05 rmmtasks init=0.000542 total=0.000577
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=5e-06,0.00113,0.00019 cost=1.13e+04 flops[gemm]=1e+07
--- TIMING FOR renorm : t_inter=5e-06 t_gemm=0.00113 t_reduction=0.00019 tot=0.00132 ---
 renorm counter=3 i=0 t=0.000236 per=20.9 cost=600 flops=2.54e+06
 renorm counter=3 i=1 t=0.000227 per=20.1 cost=1.19e+03 flops=5.23e+06
 renorm counter=3 i=2 t=0.00022 per=19.5 cost=670 flops=3.05e+06
 renorm counter=3 i=3 t=0.000217 per=19.3 cost=1.21e+03 flops=5.57e+06
 renorm counter=3 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=3 i=5 t=1e-06 per=0.0887 cost=0 flops=0
 renorm counter=3 i=6 t=0.000226 per=20.1 cost=7.6e+03 flops=3.36e+07
 total GEMM cost=1.13e+04 flops=1e+07
--- TIMING FOR renorm_tot : t_inter=0.000223 t_gemm=0.0034 t_reduction=0.000586 tot=0.00421 ---
 renorm_tot counter=3 i=0 t=0.000698 per=20.5 cost=2.99e+03 flops=4.29e+06
 renorm_tot counter=3 i=1 t=0.000673 per=19.8 cost=4.12e+03 flops=6.12e+06
 renorm_tot counter=3 i=2 t=0.000221 per=6.5 cost=670 flops=3.03e+06
 renorm_tot counter=3 i=3 t=0.000219 per=6.44 cost=1.21e+03 flops=5.52e+06
 renorm_tot counter=3 i=4 t=0.000436 per=12.8 cost=3.55e+03 flops=8.14e+06
 renorm_tot counter=3 i=5 t=0.000443 per=13 cost=6.37e+03 flops=1.44e+07
 renorm_tot counter=3 i=6 t=0.00071 per=20.9 cost=2.89e+04 flops=4.08e+07
 total GEMM cost=4.79e+04 flops=1.41e+07
timing: gpu2cpu=1.44e-05 deallocate(site/work)=4.56e-06,7.37e-06 total=2.18e-05
check ||H-H.dagger||=8.779e-17 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.00382 S T(init/kernel/comm)=0.000284,0.00348,5.84e-05 rank=0 -----
TIMING FOR cleanup: 0.000337 T(erase/save/remove)=9.02e-05,0.000209,3.78e-05
##### local: 5.232e-02 S #####
 T(local: fetch) = 1.254e-04 S  per = 0.24  per(accum) = 0.24
 T(local: hdiag) = 4.850e-04 S  per = 0.927  per(accum) = 1.17
 T(local: dvdsn) = 4.618e-02 S  per = 88.3  per(accum) = 89.4
 T(local: decim) = 8.629e-04 S  per = 1.65  per(accum) = 91.1
 T(local: guess) = 3.576e-04 S  per = 0.684  per(accum) = 91.8
 T(local: renrm) = 3.956e-03 S  per = 7.56  per(accum) = 99.3
 T(local: save ) = 3.502e-04 S  per = 0.669  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.536e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 8.836e-06 S  per = 0.0195  per(accum) = 0.0195
 T(local: symbolic_formulae_twodot     ) = 6.657e-04 S  per = 1.47  per(accum) = 1.49
 T(local: hintermediate init           ) = 5.471e-05 S  per = 0.121  per(accum) = 1.61
 T(local: hintermediates memcpy cpu2gpu) = 2.700e-08 S  per = 5.95e-05  per(accum) = 1.61
 T(local: preprocess_hformulae_Hxlist2 ) = 2.987e-03 S  per = 6.58  per(accum) = 8.19
 T(local: hmmtasks init                ) = 2.962e-03 S  per = 6.53  per(accum) = 14.7
 T(local: dvdson solver [Hx_batchGPU]  ) = 3.803e-02 S  per = 83.8  per(accum) = 98.5
 T(local: dvdson solver [communication]) = 4.969e-05 S  per = 0.11  per(accum) = 98.7
 T(local: dvdson solver [rest part]    ) = 6.083e-04 S  per = 1.34  per(accum) = 100
Detailed decomposition of T(renrm): 3.824e-03 S
 T(local: qops init                    ) = 2.836e-04 S  per = 7.42  per(accum) = 7.42
 T(local: qops_dict memcpy cpu2gpu     ) = 3.937e-05 S  per = 1.03  per(accum) = 8.45
 T(local: symbolic_formulae_renorm     ) = 6.001e-04 S  per = 15.7  per(accum) = 24.1
 T(local: rintermediate init           ) = 2.869e-05 S  per = 0.75  per(accum) = 24.9
 T(local: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000732  per(accum) = 24.9
 T(local: preprocess_formulae_Rlist2   ) = 7.357e-04 S  per = 19.2  per(accum) = 44.1
 T(local: rmmtasks init                ) = 5.838e-04 S  per = 15.3  per(accum) = 59.4
 T(local: qops memset                  ) = 2.800e-08 S  per = 0.000732  per(accum) = 59.4
 T(local: preprocess_renorm_batchGPU   ) = 1.439e-03 S  per = 37.6  per(accum) = 97
 T(local: qops memcpy gpu2cpu          ) = 1.445e-05 S  per = 0.378  per(accum) = 97.4
 T(local: deallocate gpu memory        ) = 4.081e-05 S  per = 1.07  per(accum) = 98.5
 T(local: communication of opS and opH ) = 5.841e-05 S  per = 1.53  per(accum) = 100
##### sweep: 1.410e-01 S #####
 T(sweep: fetch) = 3.088e-03 S  per = 2.19  per(accum) = 2.19
 T(sweep: hdiag) = 2.129e-03 S  per = 1.51  per(accum) = 3.7
 T(sweep: dvdsn) = 1.181e-01 S  per = 83.7  per(accum) = 87.4
 T(sweep: decim) = 3.238e-03 S  per =  2.3  per(accum) = 89.7
 T(sweep: guess) = 1.166e-03 S  per = 0.827  per(accum) = 90.6
 T(sweep: renrm) = 1.245e-02 S  per = 8.83  per(accum) = 99.4
 T(sweep: save ) = 8.660e-04 S  per = 0.614  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.153e-01 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 3.819e-05 S  per = 0.0331  per(accum) = 0.0331
 T(sweep: symbolic_formulae_twodot     ) = 1.965e-03 S  per =  1.7  per(accum) = 1.74
 T(sweep: hintermediate init           ) = 1.715e-04 S  per = 0.149  per(accum) = 1.89
 T(sweep: hintermediates memcpy cpu2gpu) = 8.600e-08 S  per = 7.46e-05  per(accum) = 1.89
 T(sweep: preprocess_hformulae_Hxlist2 ) = 9.809e-03 S  per = 8.51  per(accum) = 10.4
 T(sweep: hmmtasks init                ) = 9.843e-03 S  per = 8.54  per(accum) = 18.9
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 9.169e-02 S  per = 79.5  per(accum) = 98.4
 T(sweep: dvdson solver [communication]) = 1.337e-04 S  per = 0.116  per(accum) = 98.6
 T(sweep: dvdson solver [rest part]    ) = 1.654e-03 S  per = 1.43  per(accum) = 100
Detailed decomposition of T(renrm): 1.207e-02 S
 T(sweep: qops init                    ) = 8.593e-04 S  per = 7.12  per(accum) = 7.12
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.215e-04 S  per = 1.01  per(accum) = 8.12
 T(sweep: symbolic_formulae_renorm     ) = 1.698e-03 S  per = 14.1  per(accum) = 22.2
 T(sweep: rintermediate init           ) = 1.221e-04 S  per = 1.01  per(accum) = 23.2
 T(sweep: rintermediates memcpy cpu2gpu) = 8.500e-08 S  per = 0.000704  per(accum) = 23.2
 T(sweep: preprocess_formulae_Rlist2   ) = 2.323e-03 S  per = 19.2  per(accum) = 42.4
 T(sweep: rmmtasks init                ) = 2.037e-03 S  per = 16.9  per(accum) = 59.3
 T(sweep: qops memset                  ) = 8.600e-08 S  per = 0.000712  per(accum) = 59.3
 T(sweep: preprocess_renorm_batchGPU   ) = 4.571e-03 S  per = 37.9  per(accum) = 97.2
 T(sweep: qops memcpy gpu2cpu          ) = 4.359e-05 S  per = 0.361  per(accum) = 97.5
 T(sweep: deallocate gpu memory        ) = 1.181e-04 S  per = 0.978  per(accum) = 98.5
 T(sweep: communication of opS and opH ) = 1.798e-04 S  per = 1.49  per(accum) = 100
##### global: 1.410e-01 S #####
 T(global: fetch) = 3.088e-03 S  per = 2.19  per(accum) = 2.19
 T(global: hdiag) = 2.129e-03 S  per = 1.51  per(accum) = 3.7
 T(global: dvdsn) = 1.181e-01 S  per = 83.7  per(accum) = 87.4
 T(global: decim) = 3.238e-03 S  per =  2.3  per(accum) = 89.7
 T(global: guess) = 1.166e-03 S  per = 0.827  per(accum) = 90.6
 T(global: renrm) = 1.245e-02 S  per = 8.83  per(accum) = 99.4
 T(global: save ) = 8.660e-04 S  per = 0.614  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.153e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 3.819e-05 S  per = 0.0331  per(accum) = 0.0331
 T(global: symbolic_formulae_twodot     ) = 1.965e-03 S  per =  1.7  per(accum) = 1.74
 T(global: hintermediate init           ) = 1.715e-04 S  per = 0.149  per(accum) = 1.89
 T(global: hintermediates memcpy cpu2gpu) = 8.600e-08 S  per = 7.46e-05  per(accum) = 1.89
 T(global: preprocess_hformulae_Hxlist2 ) = 9.809e-03 S  per = 8.51  per(accum) = 10.4
 T(global: hmmtasks init                ) = 9.843e-03 S  per = 8.54  per(accum) = 18.9
 T(global: dvdson solver [Hx_batchGPU]  ) = 9.169e-02 S  per = 79.5  per(accum) = 98.4
 T(global: dvdson solver [communication]) = 1.337e-04 S  per = 0.116  per(accum) = 98.6
 T(global: dvdson solver [rest part]    ) = 1.654e-03 S  per = 1.43  per(accum) = 100
Detailed decomposition of T(renrm): 1.207e-02 S
 T(global: qops init                    ) = 8.593e-04 S  per = 7.12  per(accum) = 7.12
 T(global: qops_dict memcpy cpu2gpu     ) = 1.215e-04 S  per = 1.01  per(accum) = 8.12
 T(global: symbolic_formulae_renorm     ) = 1.698e-03 S  per = 14.1  per(accum) = 22.2
 T(global: rintermediate init           ) = 1.221e-04 S  per = 1.01  per(accum) = 23.2
 T(global: rintermediates memcpy cpu2gpu) = 8.500e-08 S  per = 0.000704  per(accum) = 23.2
 T(global: preprocess_formulae_Rlist2   ) = 2.323e-03 S  per = 19.2  per(accum) = 42.4
 T(global: rmmtasks init                ) = 2.037e-03 S  per = 16.9  per(accum) = 59.3
 T(global: qops memset                  ) = 8.600e-08 S  per = 0.000712  per(accum) = 59.3
 T(global: preprocess_renorm_batchGPU   ) = 4.571e-03 S  per = 37.9  per(accum) = 97.2
 T(global: qops memcpy gpu2cpu          ) = 4.359e-05 S  per = 0.361  per(accum) = 97.5
 T(global: deallocate gpu memory        ) = 1.181e-04 S  per = 0.978  per(accum) = 98.5
 T(global: communication of opS and opH ) = 1.798e-04 S  per = 1.49  per(accum) = 100

isweep=0 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=499:0.00381MB:3.72e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=937:0.00715MB:6.98e-06GB
wf4(diml,dimr,dimc1,dimc2)=(4,10,4,4) nnz=72:0.000549MB
stensor4: wf own=1 _data=0x4468dd20
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=5 dimAll=10
 (2,0):4 (1,1):2 (1,-1):2 (0,0):1 (2,2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=33 nblocks=320 size=72:0.000549MB
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
### DIAG TIMING: total=0.000308 t1=8.1e-06, t2=1.3e-05, t3=3.68e-05, t4=0.000159, t5=5.14e-05, t6=2.42e-05, t7=1.21e-05, t8=3.38e-06
duration_diagGPU:0.000322
duration_diagreduce:4.02e-06
duration_diagtransform:1.46e-06
rank=0 GPUmem(GB): used=6.98e-06 (oper)=6.98e-06
----- TIMING FOR symbolic_formulae_twodot with size=93 : 6.432e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=93
 no. of hintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.220e-05 S -----
rank=0 GPUmem(GB): used=7.28e-06 (oper,hinter)=6.98e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00216 S size(H_formulae)=93 size(Hxlst2)=33 T(Hmu/Hxlist)=0.00018,0.00198 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00232 S size(H_formulae)=93 size(Hxlst)=1848 -----
rank=0 GPUmem(GB): used=0.000242 (oper,hinter,dvdson,batch)=6.98e-06,2.98e-07,1.07e-06,0.000234 blksize=4 blksize0=8 batchsize=1848
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=72 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.4e-05,0.000216,0.00187,0.0002 cost=2.48e+04 flops[gemm]=1.33e+07
--- TIMING FOR sigma : t_inter=0.000216 t_gemm=0.00187 t_reduction=0.0002 tot=0.00228 ---
 sigma counter=37 i=0 t=0.000238 per=12.7 cost=2.14e+03 flops=8.97e+06
 sigma counter=37 i=1 t=0.000244 per=13.1 cost=2.35e+03 flops=9.65e+06
 sigma counter=37 i=2 t=0.000226 per=12.1 cost=1.7e+03 flops=7.54e+06
 sigma counter=37 i=3 t=0.000228 per=12.2 cost=1.89e+03 flops=8.27e+06
 sigma counter=37 i=4 t=0.000229 per=12.3 cost=5.75e+03 flops=2.51e+07
 sigma counter=37 i=5 t=0.000228 per=12.2 cost=5.75e+03 flops=2.52e+07
 sigma counter=37 i=6 t=0.00024 per=12.9 cost=2.67e+03 flops=1.11e+07
 sigma counter=37 i=7 t=0.000234 per=12.5 cost=2.52e+03 flops=1.08e+07
 total GEMM cost=2.48e+04 flops=1.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00789 t_gemm=0.0721 t_reduction=0.0073 tot=0.0873 ---
 sigma_tot counter=37 i=0 t=0.00883 per=12.2 cost=7.44e+04 flops=8.43e+06
 sigma_tot counter=37 i=1 t=0.00896 per=12.4 cost=7.43e+04 flops=8.29e+06
 sigma_tot counter=37 i=2 t=0.00895 per=12.4 cost=1.02e+05 flops=1.14e+07
 sigma_tot counter=37 i=3 t=0.00894 per=12.4 cost=1.03e+05 flops=1.15e+07
 sigma_tot counter=37 i=4 t=0.00904 per=12.5 cost=1.29e+05 flops=1.42e+07
 sigma_tot counter=37 i=5 t=0.00905 per=12.5 cost=1.3e+05 flops=1.44e+07
 sigma_tot counter=37 i=6 t=0.0093 per=12.9 cost=2.35e+05 flops=2.53e+07
 sigma_tot counter=37 i=7 t=0.00905 per=12.6 cost=2.35e+05 flops=2.59e+07
 total GEMM cost=1.08e+06 flops=1.5e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.3e-05,0.000203,0.00186,0.000193 cost=2.48e+04 flops[gemm]=1.33e+07
--- TIMING FOR sigma : t_inter=0.000203 t_gemm=0.00186 t_reduction=0.000193 tot=0.00226 ---
 sigma counter=38 i=0 t=0.000237 per=12.7 cost=2.14e+03 flops=9.01e+06
 sigma counter=38 i=1 t=0.000243 per=13.1 cost=2.35e+03 flops=9.69e+06
 sigma counter=38 i=2 t=0.000226 per=12.1 cost=1.7e+03 flops=7.54e+06
 sigma counter=38 i=3 t=0.000224 per=12 cost=1.89e+03 flops=8.42e+06
 sigma counter=38 i=4 t=0.000231 per=12.4 cost=5.75e+03 flops=2.49e+07
 sigma counter=38 i=5 t=0.000233 per=12.5 cost=5.75e+03 flops=2.47e+07
 sigma counter=38 i=6 t=0.000235 per=12.6 cost=2.67e+03 flops=1.14e+07
 sigma counter=38 i=7 t=0.000232 per=12.5 cost=2.52e+03 flops=1.09e+07
 total GEMM cost=2.48e+04 flops=1.33e+07
--- TIMING FOR sigma_tot : t_inter=0.00809 t_gemm=0.074 t_reduction=0.0075 tot=0.0896 ---
 sigma_tot counter=38 i=0 t=0.00906 per=12.3 cost=7.66e+04 flops=8.45e+06
 sigma_tot counter=38 i=1 t=0.0092 per=12.4 cost=7.66e+04 flops=8.33e+06
 sigma_tot counter=38 i=2 t=0.00917 per=12.4 cost=1.04e+05 flops=1.13e+07
 sigma_tot counter=38 i=3 t=0.00916 per=12.4 cost=1.05e+05 flops=1.15e+07
 sigma_tot counter=38 i=4 t=0.00927 per=12.5 cost=1.34e+05 flops=1.45e+07
 sigma_tot counter=38 i=5 t=0.00928 per=12.5 cost=1.36e+05 flops=1.46e+07
 sigma_tot counter=38 i=6 t=0.00954 per=12.9 cost=2.38e+05 flops=2.49e+07
 sigma_tot counter=38 i=7 t=0.00929 per=12.6 cost=2.37e+05 flops=2.56e+07
 total GEMM cost=1.11e+06 flops=1.5e+07
settings: ndim=72 neig=2 maxcycle=30 nbuff=4 memory=9.66e-06GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.649584713560 -1.003e+03  5.611e-02    2     2  5.010e-03 2.505e-03
    1   1 -      -2.422873623313 -1.002e+03  1.131e-01    2     2  5.010e-03 2.505e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=3.100e-05,2.010e-04,1.872e-03,1.960e-04 cost=2.477e+04 flops[gemm]=1.323e+07
--- TIMING FOR sigma : t_inter=2.010e-04 t_gemm=1.871e-03 t_reduction=1.950e-04 tot=2.267e-03 ---
 sigma counter=39 i=0 t=2.390e-04 per=1.277e+01 cost=2.136e+03 flops=8.937e+06
 sigma counter=39 i=1 t=2.440e-04 per=1.304e+01 cost=2.354e+03 flops=9.648e+06
 sigma counter=39 i=2 t=2.250e-04 per=1.203e+01 cost=1.704e+03 flops=7.573e+06
 sigma counter=39 i=3 t=2.260e-04 per=1.208e+01 cost=1.886e+03 flops=8.345e+06
 sigma counter=39 i=4 t=2.310e-04 per=1.235e+01 cost=5.748e+03 flops=2.488e+07
 sigma counter=39 i=5 t=2.310e-04 per=1.235e+01 cost=5.748e+03 flops=2.488e+07
 sigma counter=39 i=6 t=2.390e-04 per=1.277e+01 cost=2.674e+03 flops=1.119e+07
 sigma counter=39 i=7 t=2.360e-04 per=1.261e+01 cost=2.524e+03 flops=1.069e+07
 total GEMM cost=2.477e+04 flops=1.324e+07
--- TIMING FOR sigma_tot : t_inter=8.290e-03 t_gemm=7.585e-02 t_reduction=7.693e-03 tot=9.183e-02 ---
 sigma_tot counter=39 i=0 t=9.304e-03 per=1.227e+01 cost=7.871e+04 flops=8.460e+06
 sigma_tot counter=39 i=1 t=9.448e-03 per=1.246e+01 cost=7.900e+04 flops=8.361e+06
 sigma_tot counter=39 i=2 t=9.396e-03 per=1.239e+01 cost=1.053e+05 flops=1.121e+07
 sigma_tot counter=39 i=3 t=9.386e-03 per=1.238e+01 cost=1.068e+05 flops=1.138e+07
 sigma_tot counter=39 i=4 t=9.505e-03 per=1.253e+01 cost=1.402e+05 flops=1.475e+07
 sigma_tot counter=39 i=5 t=9.511e-03 per=1.254e+01 cost=1.414e+05 flops=1.487e+07
 sigma_tot counter=39 i=6 t=9.774e-03 per=1.289e+01 cost=2.404e+05 flops=2.460e+07
 sigma_tot counter=39 i=7 t=9.522e-03 per=1.255e+01 cost=2.399e+05 flops=2.520e+07
 total GEMM cost=1.132e+06 flops=1.492e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.000e-04,1.882e-03,1.980e-04 cost=2.477e+04 flops[gemm]=1.316e+07
--- TIMING FOR sigma : t_inter=2.000e-04 t_gemm=1.882e-03 t_reduction=1.980e-04 tot=2.280e-03 ---
 sigma counter=40 i=0 t=2.360e-04 per=1.254e+01 cost=2.136e+03 flops=9.051e+06
 sigma counter=40 i=1 t=2.480e-04 per=1.318e+01 cost=2.354e+03 flops=9.492e+06
 sigma counter=40 i=2 t=2.250e-04 per=1.196e+01 cost=1.704e+03 flops=7.573e+06
 sigma counter=40 i=3 t=2.240e-04 per=1.190e+01 cost=1.886e+03 flops=8.420e+06
 sigma counter=40 i=4 t=2.300e-04 per=1.222e+01 cost=5.748e+03 flops=2.499e+07
 sigma counter=40 i=5 t=2.390e-04 per=1.270e+01 cost=5.748e+03 flops=2.405e+07
 sigma counter=40 i=6 t=2.460e-04 per=1.307e+01 cost=2.674e+03 flops=1.087e+07
 sigma counter=40 i=7 t=2.340e-04 per=1.243e+01 cost=2.524e+03 flops=1.079e+07
 total GEMM cost=2.477e+04 flops=1.316e+07
--- TIMING FOR sigma_tot : t_inter=8.490e-03 t_gemm=7.773e-02 t_reduction=7.891e-03 tot=9.411e-02 ---
 sigma_tot counter=40 i=0 t=9.540e-03 per=1.227e+01 cost=8.085e+04 flops=8.475e+06
 sigma_tot counter=40 i=1 t=9.696e-03 per=1.247e+01 cost=8.135e+04 flops=8.390e+06
 sigma_tot counter=40 i=2 t=9.621e-03 per=1.238e+01 cost=1.070e+05 flops=1.112e+07
 sigma_tot counter=40 i=3 t=9.610e-03 per=1.236e+01 cost=1.087e+05 flops=1.131e+07
 sigma_tot counter=40 i=4 t=9.735e-03 per=1.252e+01 cost=1.459e+05 flops=1.499e+07
 sigma_tot counter=40 i=5 t=9.750e-03 per=1.254e+01 cost=1.472e+05 flops=1.509e+07
 sigma_tot counter=40 i=6 t=1.002e-02 per=1.289e+01 cost=2.431e+05 flops=2.426e+07
 sigma_tot counter=40 i=7 t=9.756e-03 per=1.255e+01 cost=2.424e+05 flops=2.485e+07
 total GEMM cost=1.157e+06 flops=1.488e+07
    2   0 -      -2.651942776669 -2.358e-03  1.267e-02    4     4  1.001e-02 2.502e-03
    2   1 -      -2.430205341019 -7.332e-03  2.577e-02    4     4  1.001e-02 2.502e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.600e-05,2.020e-04,1.878e-03,1.940e-04 cost=2.477e+04 flops[gemm]=1.319e+07
--- TIMING FOR sigma : t_inter=2.020e-04 t_gemm=1.877e-03 t_reduction=1.940e-04 tot=2.273e-03 ---
 sigma counter=41 i=0 t=2.470e-04 per=1.316e+01 cost=2.136e+03 flops=8.648e+06
 sigma counter=41 i=1 t=2.430e-04 per=1.295e+01 cost=2.354e+03 flops=9.687e+06
 sigma counter=41 i=2 t=2.250e-04 per=1.199e+01 cost=1.704e+03 flops=7.573e+06
 sigma counter=41 i=3 t=2.240e-04 per=1.193e+01 cost=1.886e+03 flops=8.420e+06
 sigma counter=41 i=4 t=2.310e-04 per=1.231e+01 cost=5.748e+03 flops=2.488e+07
 sigma counter=41 i=5 t=2.330e-04 per=1.241e+01 cost=5.748e+03 flops=2.467e+07
 sigma counter=41 i=6 t=2.390e-04 per=1.273e+01 cost=2.674e+03 flops=1.119e+07
 sigma counter=41 i=7 t=2.350e-04 per=1.252e+01 cost=2.524e+03 flops=1.074e+07
 total GEMM cost=2.477e+04 flops=1.320e+07
--- TIMING FOR sigma_tot : t_inter=8.692e-03 t_gemm=7.960e-02 t_reduction=8.085e-03 tot=9.638e-02 ---
 sigma_tot counter=41 i=0 t=9.787e-03 per=1.229e+01 cost=8.298e+04 flops=8.479e+06
 sigma_tot counter=41 i=1 t=9.939e-03 per=1.249e+01 cost=8.371e+04 flops=8.422e+06
 sigma_tot counter=41 i=2 t=9.846e-03 per=1.237e+01 cost=1.087e+05 flops=1.104e+07
 sigma_tot counter=41 i=3 t=9.834e-03 per=1.235e+01 cost=1.105e+05 flops=1.124e+07
 sigma_tot counter=41 i=4 t=9.966e-03 per=1.252e+01 cost=1.517e+05 flops=1.522e+07
 sigma_tot counter=41 i=5 t=9.983e-03 per=1.254e+01 cost=1.529e+05 flops=1.532e+07
 sigma_tot counter=41 i=6 t=1.026e-02 per=1.289e+01 cost=2.458e+05 flops=2.396e+07
 sigma_tot counter=41 i=7 t=9.991e-03 per=1.255e+01 cost=2.450e+05 flops=2.452e+07
 total GEMM cost=1.181e+06 flops=1.484e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.020e-04,1.863e-03,1.970e-04 cost=2.477e+04 flops[gemm]=1.330e+07
--- TIMING FOR sigma : t_inter=2.020e-04 t_gemm=1.863e-03 t_reduction=1.970e-04 tot=2.262e-03 ---
 sigma counter=42 i=0 t=2.350e-04 per=1.261e+01 cost=2.136e+03 flops=9.089e+06
 sigma counter=42 i=1 t=2.430e-04 per=1.304e+01 cost=2.354e+03 flops=9.687e+06
 sigma counter=42 i=2 t=2.260e-04 per=1.213e+01 cost=1.704e+03 flops=7.540e+06
 sigma counter=42 i=3 t=2.230e-04 per=1.197e+01 cost=1.886e+03 flops=8.457e+06
 sigma counter=42 i=4 t=2.290e-04 per=1.229e+01 cost=5.748e+03 flops=2.510e+07
 sigma counter=42 i=5 t=2.340e-04 per=1.256e+01 cost=5.748e+03 flops=2.456e+07
 sigma counter=42 i=6 t=2.400e-04 per=1.288e+01 cost=2.674e+03 flops=1.114e+07
 sigma counter=42 i=7 t=2.330e-04 per=1.251e+01 cost=2.524e+03 flops=1.083e+07
 total GEMM cost=2.477e+04 flops=1.330e+07
--- TIMING FOR sigma_tot : t_inter=8.894e-03 t_gemm=8.147e-02 t_reduction=8.282e-03 tot=9.864e-02 ---
 sigma_tot counter=42 i=0 t=1.002e-02 per=1.230e+01 cost=8.512e+04 flops=8.493e+06
 sigma_tot counter=42 i=1 t=1.018e-02 per=1.250e+01 cost=8.606e+04 flops=8.452e+06
 sigma_tot counter=42 i=2 t=1.007e-02 per=1.236e+01 cost=1.104e+05 flops=1.096e+07
 sigma_tot counter=42 i=3 t=1.006e-02 per=1.234e+01 cost=1.124e+05 flops=1.118e+07
 sigma_tot counter=42 i=4 t=1.019e-02 per=1.251e+01 cost=1.574e+05 flops=1.544e+07
 sigma_tot counter=42 i=5 t=1.022e-02 per=1.254e+01 cost=1.587e+05 flops=1.553e+07
 sigma_tot counter=42 i=6 t=1.050e-02 per=1.289e+01 cost=2.484e+05 flops=2.366e+07
 sigma_tot counter=42 i=7 t=1.022e-02 per=1.255e+01 cost=2.475e+05 flops=2.421e+07
 total GEMM cost=1.206e+06 flops=1.480e+07
    3   0 -      -2.652054181801 -1.114e-04  5.056e-03    6     6  1.496e-02 2.493e-03
    3   1 -      -2.430611174647 -4.058e-04  9.324e-03    6     6  1.496e-02 2.493e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.300e-05,2.090e-04,1.872e-03,1.970e-04 cost=2.477e+04 flops[gemm]=1.323e+07
--- TIMING FOR sigma : t_inter=2.090e-04 t_gemm=1.872e-03 t_reduction=1.970e-04 tot=2.278e-03 ---
 sigma counter=43 i=0 t=2.400e-04 per=1.282e+01 cost=2.136e+03 flops=8.900e+06
 sigma counter=43 i=1 t=2.420e-04 per=1.293e+01 cost=2.354e+03 flops=9.727e+06
 sigma counter=43 i=2 t=2.260e-04 per=1.207e+01 cost=1.704e+03 flops=7.540e+06
 sigma counter=43 i=3 t=2.250e-04 per=1.202e+01 cost=1.886e+03 flops=8.382e+06
 sigma counter=43 i=4 t=2.320e-04 per=1.239e+01 cost=5.748e+03 flops=2.478e+07
 sigma counter=43 i=5 t=2.310e-04 per=1.234e+01 cost=5.748e+03 flops=2.488e+07
 sigma counter=43 i=6 t=2.410e-04 per=1.287e+01 cost=2.674e+03 flops=1.110e+07
 sigma counter=43 i=7 t=2.350e-04 per=1.255e+01 cost=2.524e+03 flops=1.074e+07
 total GEMM cost=2.477e+04 flops=1.323e+07
--- TIMING FOR sigma_tot : t_inter=9.103e-03 t_gemm=8.334e-02 t_reduction=8.479e-03 tot=1.009e-01 ---
 sigma_tot counter=43 i=0 t=1.026e-02 per=1.231e+01 cost=8.726e+04 flops=8.503e+06
 sigma_tot counter=43 i=1 t=1.042e-02 per=1.251e+01 cost=8.841e+04 flops=8.482e+06
 sigma_tot counter=43 i=2 t=1.030e-02 per=1.236e+01 cost=1.121e+05 flops=1.089e+07
 sigma_tot counter=43 i=3 t=1.028e-02 per=1.234e+01 cost=1.143e+05 flops=1.112e+07
 sigma_tot counter=43 i=4 t=1.043e-02 per=1.251e+01 cost=1.632e+05 flops=1.565e+07
 sigma_tot counter=43 i=5 t=1.045e-02 per=1.254e+01 cost=1.644e+05 flops=1.574e+07
 sigma_tot counter=43 i=6 t=1.074e-02 per=1.289e+01 cost=2.511e+05 flops=2.338e+07
 sigma_tot counter=43 i=7 t=1.046e-02 per=1.255e+01 cost=2.500e+05 flops=2.390e+07
 total GEMM cost=1.231e+06 flops=1.477e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.000e-04,1.868e-03,1.940e-04 cost=2.477e+04 flops[gemm]=1.326e+07
--- TIMING FOR sigma : t_inter=2.000e-04 t_gemm=1.867e-03 t_reduction=1.940e-04 tot=2.261e-03 ---
 sigma counter=44 i=0 t=2.340e-04 per=1.253e+01 cost=2.136e+03 flops=9.128e+06
 sigma counter=44 i=1 t=2.470e-04 per=1.323e+01 cost=2.354e+03 flops=9.530e+06
 sigma counter=44 i=2 t=2.250e-04 per=1.205e+01 cost=1.704e+03 flops=7.573e+06
 sigma counter=44 i=3 t=2.240e-04 per=1.200e+01 cost=1.886e+03 flops=8.420e+06
 sigma counter=44 i=4 t=2.310e-04 per=1.237e+01 cost=5.748e+03 flops=2.488e+07
 sigma counter=44 i=5 t=2.330e-04 per=1.248e+01 cost=5.748e+03 flops=2.467e+07
 sigma counter=44 i=6 t=2.420e-04 per=1.296e+01 cost=2.674e+03 flops=1.105e+07
 sigma counter=44 i=7 t=2.310e-04 per=1.237e+01 cost=2.524e+03 flops=1.093e+07
 total GEMM cost=2.477e+04 flops=1.327e+07
--- TIMING FOR sigma_tot : t_inter=9.303e-03 t_gemm=8.521e-02 t_reduction=8.673e-03 tot=1.032e-01 ---
 sigma_tot counter=44 i=0 t=1.050e-02 per=1.232e+01 cost=8.939e+04 flops=8.517e+06
 sigma_tot counter=44 i=1 t=1.067e-02 per=1.252e+01 cost=9.077e+04 flops=8.506e+06
 sigma_tot counter=44 i=2 t=1.052e-02 per=1.235e+01 cost=1.138e+05 flops=1.082e+07
 sigma_tot counter=44 i=3 t=1.051e-02 per=1.233e+01 cost=1.162e+05 flops=1.106e+07
 sigma_tot counter=44 i=4 t=1.066e-02 per=1.251e+01 cost=1.689e+05 flops=1.585e+07
 sigma_tot counter=44 i=5 t=1.068e-02 per=1.254e+01 cost=1.702e+05 flops=1.593e+07
 sigma_tot counter=44 i=6 t=1.098e-02 per=1.289e+01 cost=2.538e+05 flops=2.311e+07
 sigma_tot counter=44 i=7 t=1.069e-02 per=1.255e+01 cost=2.525e+05 flops=2.362e+07
 total GEMM cost=1.256e+06 flops=1.474e+07
    4   0 -      -2.652078566391 -2.438e-05  1.909e-03    6     8  1.991e-02 2.489e-03
    4   1 -      -2.430673358674 -6.218e-05  4.158e-03    6     8  1.991e-02 2.489e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.080e-04,1.849e-03,2.000e-04 cost=2.477e+04 flops[gemm]=1.340e+07
--- TIMING FOR sigma : t_inter=2.080e-04 t_gemm=1.849e-03 t_reduction=1.990e-04 tot=2.256e-03 ---
 sigma counter=45 i=0 t=2.380e-04 per=1.287e+01 cost=2.136e+03 flops=8.975e+06
 sigma counter=45 i=1 t=2.350e-04 per=1.271e+01 cost=2.354e+03 flops=1.002e+07
 sigma counter=45 i=2 t=2.240e-04 per=1.211e+01 cost=1.704e+03 flops=7.607e+06
 sigma counter=45 i=3 t=2.260e-04 per=1.222e+01 cost=1.886e+03 flops=8.345e+06
 sigma counter=45 i=4 t=2.290e-04 per=1.239e+01 cost=5.748e+03 flops=2.510e+07
 sigma counter=45 i=5 t=2.310e-04 per=1.249e+01 cost=5.748e+03 flops=2.488e+07
 sigma counter=45 i=6 t=2.360e-04 per=1.276e+01 cost=2.674e+03 flops=1.133e+07
 sigma counter=45 i=7 t=2.300e-04 per=1.244e+01 cost=2.524e+03 flops=1.097e+07
 total GEMM cost=2.477e+04 flops=1.340e+07
--- TIMING FOR sigma_tot : t_inter=9.511e-03 t_gemm=8.706e-02 t_reduction=8.872e-03 tot=1.054e-01 ---
 sigma_tot counter=45 i=0 t=1.073e-02 per=1.233e+01 cost=9.153e+04 flops=8.527e+06
 sigma_tot counter=45 i=1 t=1.091e-02 per=1.253e+01 cost=9.312e+04 flops=8.539e+06
 sigma_tot counter=45 i=2 t=1.075e-02 per=1.234e+01 cost=1.155e+05 flops=1.075e+07
 sigma_tot counter=45 i=3 t=1.073e-02 per=1.233e+01 cost=1.181e+05 flops=1.100e+07
 sigma_tot counter=45 i=4 t=1.089e-02 per=1.251e+01 cost=1.747e+05 flops=1.605e+07
 sigma_tot counter=45 i=5 t=1.091e-02 per=1.253e+01 cost=1.759e+05 flops=1.612e+07
 sigma_tot counter=45 i=6 t=1.122e-02 per=1.289e+01 cost=2.565e+05 flops=2.286e+07
 sigma_tot counter=45 i=7 t=1.092e-02 per=1.254e+01 cost=2.551e+05 flops=2.336e+07
 total GEMM cost=1.280e+06 flops=1.471e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,1.990e-04,1.860e-03,1.950e-04 cost=2.477e+04 flops[gemm]=1.332e+07
--- TIMING FOR sigma : t_inter=1.990e-04 t_gemm=1.860e-03 t_reduction=1.950e-04 tot=2.254e-03 ---
 sigma counter=46 i=0 t=2.330e-04 per=1.253e+01 cost=2.136e+03 flops=9.167e+06
 sigma counter=46 i=1 t=2.330e-04 per=1.253e+01 cost=2.354e+03 flops=1.010e+07
 sigma counter=46 i=2 t=2.370e-04 per=1.274e+01 cost=1.704e+03 flops=7.190e+06
 sigma counter=46 i=3 t=2.250e-04 per=1.210e+01 cost=1.886e+03 flops=8.382e+06
 sigma counter=46 i=4 t=2.300e-04 per=1.237e+01 cost=5.748e+03 flops=2.499e+07
 sigma counter=46 i=5 t=2.300e-04 per=1.237e+01 cost=5.748e+03 flops=2.499e+07
 sigma counter=46 i=6 t=2.410e-04 per=1.296e+01 cost=2.674e+03 flops=1.110e+07
 sigma counter=46 i=7 t=2.310e-04 per=1.242e+01 cost=2.524e+03 flops=1.093e+07
 total GEMM cost=2.477e+04 flops=1.332e+07
--- TIMING FOR sigma_tot : t_inter=9.710e-03 t_gemm=8.892e-02 t_reduction=9.067e-03 tot=1.077e-01 ---
 sigma_tot counter=46 i=0 t=1.097e-02 per=1.233e+01 cost=9.366e+04 flops=8.541e+06
 sigma_tot counter=46 i=1 t=1.114e-02 per=1.253e+01 cost=9.548e+04 flops=8.571e+06
 sigma_tot counter=46 i=2 t=1.098e-02 per=1.235e+01 cost=1.172e+05 flops=1.067e+07
 sigma_tot counter=46 i=3 t=1.096e-02 per=1.232e+01 cost=1.200e+05 flops=1.095e+07
 sigma_tot counter=46 i=4 t=1.112e-02 per=1.250e+01 cost=1.804e+05 flops=1.623e+07
 sigma_tot counter=46 i=5 t=1.114e-02 per=1.253e+01 cost=1.817e+05 flops=1.630e+07
 sigma_tot counter=46 i=6 t=1.146e-02 per=1.289e+01 cost=2.591e+05 flops=2.261e+07
 sigma_tot counter=46 i=7 t=1.115e-02 per=1.254e+01 cost=2.576e+05 flops=2.310e+07
 total GEMM cost=1.305e+06 flops=1.468e+07
    5   0 -      -2.652080842742 -2.276e-06  5.129e-04    6    10  2.486e-02 2.486e-03
    5   1 -      -2.430687478251 -1.412e-05  1.798e-03    6    10  2.486e-02 2.486e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.080e-04,1.848e-03,1.970e-04 cost=2.477e+04 flops[gemm]=1.341e+07
--- TIMING FOR sigma : t_inter=2.080e-04 t_gemm=1.846e-03 t_reduction=1.960e-04 tot=2.250e-03 ---
 sigma counter=47 i=0 t=2.360e-04 per=1.278e+01 cost=2.136e+03 flops=9.051e+06
 sigma counter=47 i=1 t=2.350e-04 per=1.273e+01 cost=2.354e+03 flops=1.002e+07
 sigma counter=47 i=2 t=2.240e-04 per=1.213e+01 cost=1.704e+03 flops=7.607e+06
 sigma counter=47 i=3 t=2.230e-04 per=1.208e+01 cost=1.886e+03 flops=8.457e+06
 sigma counter=47 i=4 t=2.290e-04 per=1.241e+01 cost=5.748e+03 flops=2.510e+07
 sigma counter=47 i=5 t=2.290e-04 per=1.241e+01 cost=5.748e+03 flops=2.510e+07
 sigma counter=47 i=6 t=2.390e-04 per=1.295e+01 cost=2.674e+03 flops=1.119e+07
 sigma counter=47 i=7 t=2.310e-04 per=1.251e+01 cost=2.524e+03 flops=1.093e+07
 total GEMM cost=2.477e+04 flops=1.342e+07
--- TIMING FOR sigma_tot : t_inter=9.918e-03 t_gemm=9.076e-02 t_reduction=9.263e-03 tot=1.099e-01 ---
 sigma_tot counter=47 i=0 t=1.120e-02 per=1.234e+01 cost=9.580e+04 flops=8.551e+06
 sigma_tot counter=47 i=1 t=1.137e-02 per=1.253e+01 cost=9.783e+04 flops=8.601e+06
 sigma_tot counter=47 i=2 t=1.121e-02 per=1.235e+01 cost=1.189e+05 flops=1.061e+07
 sigma_tot counter=47 i=3 t=1.118e-02 per=1.232e+01 cost=1.219e+05 flops=1.090e+07
 sigma_tot counter=47 i=4 t=1.135e-02 per=1.250e+01 cost=1.862e+05 flops=1.641e+07
 sigma_tot counter=47 i=5 t=1.137e-02 per=1.253e+01 cost=1.874e+05 flops=1.648e+07
 sigma_tot counter=47 i=6 t=1.170e-02 per=1.289e+01 cost=2.618e+05 flops=2.238e+07
 sigma_tot counter=47 i=7 t=1.138e-02 per=1.254e+01 cost=2.601e+05 flops=2.285e+07
 total GEMM cost=1.330e+06 flops=1.465e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.000e-04,1.892e-03,1.960e-04 cost=2.477e+04 flops[gemm]=1.309e+07
--- TIMING FOR sigma : t_inter=2.000e-04 t_gemm=1.892e-03 t_reduction=1.960e-04 tot=2.288e-03 ---
 sigma counter=48 i=0 t=2.360e-04 per=1.247e+01 cost=2.136e+03 flops=9.051e+06
 sigma counter=48 i=1 t=2.350e-04 per=1.242e+01 cost=2.354e+03 flops=1.002e+07
 sigma counter=48 i=2 t=2.320e-04 per=1.226e+01 cost=1.704e+03 flops=7.345e+06
 sigma counter=48 i=3 t=2.270e-04 per=1.200e+01 cost=1.886e+03 flops=8.308e+06
 sigma counter=48 i=4 t=2.330e-04 per=1.232e+01 cost=5.748e+03 flops=2.467e+07
 sigma counter=48 i=5 t=2.330e-04 per=1.232e+01 cost=5.748e+03 flops=2.467e+07
 sigma counter=48 i=6 t=2.450e-04 per=1.295e+01 cost=2.674e+03 flops=1.091e+07
 sigma counter=48 i=7 t=2.510e-04 per=1.327e+01 cost=2.524e+03 flops=1.006e+07
 total GEMM cost=2.477e+04 flops=1.309e+07
--- TIMING FOR sigma_tot : t_inter=1.012e-02 t_gemm=9.265e-02 t_reduction=9.459e-03 tot=1.122e-01 ---
 sigma_tot counter=48 i=0 t=1.144e-02 per=1.235e+01 cost=9.794e+04 flops=8.562e+06
 sigma_tot counter=48 i=1 t=1.161e-02 per=1.253e+01 cost=1.002e+05 flops=8.630e+06
 sigma_tot counter=48 i=2 t=1.144e-02 per=1.235e+01 cost=1.206e+05 flops=1.054e+07
 sigma_tot counter=48 i=3 t=1.141e-02 per=1.231e+01 cost=1.237e+05 flops=1.085e+07
 sigma_tot counter=48 i=4 t=1.158e-02 per=1.250e+01 cost=1.919e+05 flops=1.658e+07
 sigma_tot counter=48 i=5 t=1.160e-02 per=1.252e+01 cost=1.932e+05 flops=1.665e+07
 sigma_tot counter=48 i=6 t=1.194e-02 per=1.289e+01 cost=2.645e+05 flops=2.215e+07
 sigma_tot counter=48 i=7 t=1.163e-02 per=1.256e+01 cost=2.626e+05 flops=2.258e+07
 total GEMM cost=1.355e+06 flops=1.462e+07
    6   0 -      -2.652081069574 -2.268e-07  1.761e-04    6    12  2.982e-02 2.485e-03
    6   1 -      -2.430689675152 -2.197e-06  5.573e-04    6    12  2.982e-02 2.485e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.000e-05,2.160e-04,1.881e-03,1.980e-04 cost=2.477e+04 flops[gemm]=1.317e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=1.880e-03 t_reduction=1.980e-04 tot=2.294e-03 ---
 sigma counter=49 i=0 t=2.440e-04 per=1.298e+01 cost=2.136e+03 flops=8.754e+06
 sigma counter=49 i=1 t=2.530e-04 per=1.346e+01 cost=2.354e+03 flops=9.304e+06
 sigma counter=49 i=2 t=2.290e-04 per=1.218e+01 cost=1.704e+03 flops=7.441e+06
 sigma counter=49 i=3 t=2.240e-04 per=1.191e+01 cost=1.886e+03 flops=8.420e+06
 sigma counter=49 i=4 t=2.320e-04 per=1.234e+01 cost=5.748e+03 flops=2.478e+07
 sigma counter=49 i=5 t=2.310e-04 per=1.229e+01 cost=5.748e+03 flops=2.488e+07
 sigma counter=49 i=6 t=2.370e-04 per=1.261e+01 cost=2.674e+03 flops=1.128e+07
 sigma counter=49 i=7 t=2.300e-04 per=1.223e+01 cost=2.524e+03 flops=1.097e+07
 total GEMM cost=2.477e+04 flops=1.318e+07
--- TIMING FOR sigma_tot : t_inter=1.033e-02 t_gemm=9.453e-02 t_reduction=9.657e-03 tot=1.145e-01 ---
 sigma_tot counter=49 i=0 t=1.168e-02 per=1.236e+01 cost=1.001e+05 flops=8.566e+06
 sigma_tot counter=49 i=1 t=1.186e-02 per=1.255e+01 cost=1.025e+05 flops=8.644e+06
 sigma_tot counter=49 i=2 t=1.167e-02 per=1.234e+01 cost=1.223e+05 flops=1.048e+07
 sigma_tot counter=49 i=3 t=1.163e-02 per=1.230e+01 cost=1.256e+05 flops=1.080e+07
 sigma_tot counter=49 i=4 t=1.181e-02 per=1.249e+01 cost=1.977e+05 flops=1.674e+07
 sigma_tot counter=49 i=5 t=1.184e-02 per=1.252e+01 cost=1.989e+05 flops=1.681e+07
 sigma_tot counter=49 i=6 t=1.218e-02 per=1.288e+01 cost=2.672e+05 flops=2.193e+07
 sigma_tot counter=49 i=7 t=1.186e-02 per=1.255e+01 cost=2.652e+05 flops=2.235e+07
 total GEMM cost=1.379e+06 flops=1.459e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,1.990e-04,1.859e-03,1.950e-04 cost=2.477e+04 flops[gemm]=1.333e+07
--- TIMING FOR sigma : t_inter=1.990e-04 t_gemm=1.858e-03 t_reduction=1.950e-04 tot=2.252e-03 ---
 sigma counter=50 i=0 t=2.350e-04 per=1.265e+01 cost=2.136e+03 flops=9.089e+06
 sigma counter=50 i=1 t=2.340e-04 per=1.259e+01 cost=2.354e+03 flops=1.006e+07
 sigma counter=50 i=2 t=2.380e-04 per=1.281e+01 cost=1.704e+03 flops=7.160e+06
 sigma counter=50 i=3 t=2.230e-04 per=1.200e+01 cost=1.886e+03 flops=8.457e+06
 sigma counter=50 i=4 t=2.280e-04 per=1.227e+01 cost=5.748e+03 flops=2.521e+07
 sigma counter=50 i=5 t=2.290e-04 per=1.233e+01 cost=5.748e+03 flops=2.510e+07
 sigma counter=50 i=6 t=2.390e-04 per=1.286e+01 cost=2.674e+03 flops=1.119e+07
 sigma counter=50 i=7 t=2.320e-04 per=1.249e+01 cost=2.524e+03 flops=1.088e+07
 total GEMM cost=2.477e+04 flops=1.333e+07
--- TIMING FOR sigma_tot : t_inter=1.053e-02 t_gemm=9.639e-02 t_reduction=9.852e-03 tot=1.168e-01 ---
 sigma_tot counter=50 i=0 t=1.192e-02 per=1.236e+01 cost=1.022e+05 flops=8.576e+06
 sigma_tot counter=50 i=1 t=1.210e-02 per=1.255e+01 cost=1.049e+05 flops=8.672e+06
 sigma_tot counter=50 i=2 t=1.191e-02 per=1.235e+01 cost=1.240e+05 flops=1.042e+07
 sigma_tot counter=50 i=3 t=1.185e-02 per=1.230e+01 cost=1.275e+05 flops=1.076e+07
 sigma_tot counter=50 i=4 t=1.204e-02 per=1.249e+01 cost=2.034e+05 flops=1.690e+07
 sigma_tot counter=50 i=5 t=1.206e-02 per=1.252e+01 cost=2.046e+05 flops=1.696e+07
 sigma_tot counter=50 i=6 t=1.242e-02 per=1.288e+01 cost=2.698e+05 flops=2.173e+07
 sigma_tot counter=50 i=7 t=1.209e-02 per=1.255e+01 cost=2.677e+05 flops=2.213e+07
 total GEMM cost=1.404e+06 flops=1.457e+07
    7   0 +      -2.652081089524 -1.995e-08  6.381e-05    6    14  3.480e-02 2.486e-03
    7   1 -      -2.430689869830 -1.947e-07  1.128e-04    6    14  3.480e-02 2.486e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.060e-04,1.940e-03,1.960e-04 cost=2.477e+04 flops[gemm]=1.277e+07
--- TIMING FOR sigma : t_inter=2.060e-04 t_gemm=1.940e-03 t_reduction=1.960e-04 tot=2.342e-03 ---
 sigma counter=51 i=0 t=2.430e-04 per=1.253e+01 cost=2.136e+03 flops=8.790e+06
 sigma counter=51 i=1 t=2.440e-04 per=1.258e+01 cost=2.354e+03 flops=9.648e+06
 sigma counter=51 i=2 t=2.450e-04 per=1.263e+01 cost=1.704e+03 flops=6.955e+06
 sigma counter=51 i=3 t=2.270e-04 per=1.170e+01 cost=1.886e+03 flops=8.308e+06
 sigma counter=51 i=4 t=2.310e-04 per=1.191e+01 cost=5.748e+03 flops=2.488e+07
 sigma counter=51 i=5 t=2.550e-04 per=1.314e+01 cost=5.748e+03 flops=2.254e+07
 sigma counter=51 i=6 t=2.620e-04 per=1.351e+01 cost=2.674e+03 flops=1.021e+07
 sigma counter=51 i=7 t=2.330e-04 per=1.201e+01 cost=2.524e+03 flops=1.083e+07
 total GEMM cost=2.477e+04 flops=1.277e+07
--- TIMING FOR sigma_tot : t_inter=1.074e-02 t_gemm=9.833e-02 t_reduction=1.005e-02 tot=1.191e-01 ---
 sigma_tot counter=51 i=0 t=1.216e-02 per=1.237e+01 cost=1.043e+05 flops=8.580e+06
 sigma_tot counter=51 i=1 t=1.234e-02 per=1.255e+01 cost=1.072e+05 flops=8.691e+06
 sigma_tot counter=51 i=2 t=1.215e-02 per=1.236e+01 cost=1.257e+05 flops=1.035e+07
 sigma_tot counter=51 i=3 t=1.208e-02 per=1.229e+01 cost=1.294e+05 flops=1.071e+07
 sigma_tot counter=51 i=4 t=1.227e-02 per=1.248e+01 cost=2.092e+05 flops=1.705e+07
 sigma_tot counter=51 i=5 t=1.232e-02 per=1.253e+01 cost=2.104e+05 flops=1.708e+07
 sigma_tot counter=51 i=6 t=1.268e-02 per=1.290e+01 cost=2.725e+05 flops=2.149e+07
 sigma_tot counter=51 i=7 t=1.233e-02 per=1.254e+01 cost=2.702e+05 flops=2.192e+07
 total GEMM cost=1.429e+06 flops=1.453e+07
    8   0 +      -2.652081089524 -1.261e-13  6.381e-05    5    15  3.737e-02 2.492e-03
    8   1 +      -2.430689878738 -8.908e-09  3.441e-05    5    15  3.737e-02 2.492e-03
TIMING FOR Davidson : 3.741e-02  T(cal/comm/rest)=3.677e-02,4.895e-05,5.894e-04
optimized energies: isweep=0 dots=2 ibond=3 e[0]=-2.65208108952 nmvp=15
optimized energies: isweep=0 dots=2 ibond=3 e[1]=-2.43068987874 nmvp=15
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row_nkr dcut=10 nqr=11 alg_decim=1 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=11 dimAll=40
 (2,0):9 (3,1):7 (3,-1):6 (4,0):4 (1,1):3 (1,-1):3 (2,2):3 (2,-2):2 (0,0):1 (4,2):1 (3,3):1
----- TMING FOR decimation_genbasis: 3.6e-04 S T(scatter/comp/gather)=3.5e-05,3.8e-05,2.9e-04 -----
decimation summary: 40->10 dwt=+9.505e-03 SvN=1.828e+00
 qbond: qkept nsym=4 dimAll=10
 (2,0):3 (3,1):3 (1,1):2 (2,2):2
----- TIMING for decimation_row: 6.230e-04 S T(decim/formRot)=4.211e-04,2.019e-04 -----
TIMING FOR decimation: 9.066e-04 S T(wf/decim)=2.615e-04,6.451e-04
ctns::oper_renorm coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:6 A:7 B:11 P:3 Q:5 S:4 H:1 
        dim(bra,ket)=10,10 size(op)=26:1.984e-04MB size(tot)=483:3.685e-03MB:3.599e-06GB
rank=0 GPUmem(GB): used=1.088e-05 (oper)=8.404e-06
rank=0 GPUmem(GB): used=1.132e-05 (oper,site)(GB)=8.404e-06,4.470e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 4.697e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 4.960e-05 S -----
rank=0 GPUmem(GB): used=1.16e-05 (oper,site,rinter)=8.4e-06,4.47e-07,2.98e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000572 S size(rtasks)=37 size(Rlst2)=4 T(Rmu/Rlist)=0.000155,0.000417 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000615 S size(rtasks)=37 size(Rlst)=389 -----
rank=0 GPUmem(GB): used=0.000107 (oper,site,rinter,batch)=8.4e-06,4.47e-07,2.98e-07,9.56e-05 blksize=12 blksize0=8 batchsize=389
timing: allocate=3.38e-05 rmmtasks init=0.000494 total=0.000528
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000203,0.0011,0.000194 cost=2.17e+04 flops[gemm]=1.97e+07
--- TIMING FOR renorm : t_inter=0.000202 t_gemm=0.0011 t_reduction=0.000194 tot=0.0015 ---
 renorm counter=4 i=0 t=0.000225 per=20.4 cost=974 flops=4.33e+06
 renorm counter=4 i=1 t=0.000219 per=19.8 cost=1.98e+03 flops=9.02e+06
 renorm counter=4 i=2 t=0.000215 per=19.5 cost=2.7e+03 flops=1.25e+07
 renorm counter=4 i=3 t=0.000217 per=19.7 cost=4.79e+03 flops=2.21e+07
 renorm counter=4 i=4 t=1e-06 per=0.0906 cost=0 flops=0
 renorm counter=4 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=4 i=6 t=0.000227 per=20.6 cost=1.13e+04 flops=4.96e+07
 total GEMM cost=2.17e+04 flops=1.97e+07
--- TIMING FOR renorm_tot : t_inter=0.000425 t_gemm=0.0045 t_reduction=0.00078 tot=0.00571 ---
 renorm_tot counter=4 i=0 t=0.000923 per=20.5 cost=3.97e+03 flops=4.3e+06
 renorm_tot counter=4 i=1 t=0.000892 per=19.8 cost=6.1e+03 flops=6.84e+06
 renorm_tot counter=4 i=2 t=0.000436 per=9.68 cost=3.37e+03 flops=7.72e+06
 renorm_tot counter=4 i=3 t=0.000436 per=9.68 cost=6e+03 flops=1.38e+07
 renorm_tot counter=4 i=4 t=0.000437 per=9.7 cost=3.55e+03 flops=8.12e+06
 renorm_tot counter=4 i=5 t=0.000443 per=9.84 cost=6.37e+03 flops=1.44e+07
 renorm_tot counter=4 i=6 t=0.000937 per=20.8 cost=4.02e+04 flops=4.29e+07
 total GEMM cost=6.96e+04 flops=1.54e+07
timing: gpu2cpu=1.41e-05 deallocate(site/work)=4.7e-06,7.74e-06 total=2.19e-05
check ||H-H.dagger||=1.416e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00374 S T(init/kernel/comm)=0.000261,0.00342,6.02e-05 rank=0 -----
TIMING FOR cleanup: 0.000207 T(erase/save/remove)=4.02e-06,0.000168,3.55e-05
##### local: 5.035e-02 S #####
 T(local: fetch) = 1.041e-03 S  per = 2.07  per(accum) = 2.07
 T(local: hdiag) = 4.198e-04 S  per = 0.834  per(accum) = 2.9
 T(local: dvdsn) = 4.350e-02 S  per = 86.4  per(accum) = 89.3
 T(local: decim) = 1.016e-03 S  per = 2.02  per(accum) = 91.3
 T(local: guess) = 3.091e-04 S  per = 0.614  per(accum) = 91.9
 T(local: renrm) = 3.846e-03 S  per = 7.64  per(accum) = 99.6
 T(local: save ) = 2.191e-04 S  per = 0.435  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.275e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 8.420e-06 S  per = 0.0197  per(accum) = 0.0197
 T(local: symbolic_formulae_twodot     ) = 6.522e-04 S  per = 1.53  per(accum) = 1.55
 T(local: hintermediate init           ) = 5.618e-05 S  per = 0.131  per(accum) = 1.68
 T(local: hintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 6.55e-05  per(accum) = 1.68
 T(local: preprocess_hformulae_Hxlist2 ) = 2.381e-03 S  per = 5.57  per(accum) = 7.25
 T(local: hmmtasks init                ) = 2.242e-03 S  per = 5.24  per(accum) = 12.5
 T(local: dvdson solver [Hx_batchGPU]  ) = 3.677e-02 S  per =   86  per(accum) = 98.5
 T(local: dvdson solver [communication]) = 4.895e-05 S  per = 0.115  per(accum) = 98.6
 T(local: dvdson solver [rest part]    ) = 5.894e-04 S  per = 1.38  per(accum) = 100
Detailed decomposition of T(renrm): 3.738e-03 S
 T(local: qops init                    ) = 2.611e-04 S  per = 6.99  per(accum) = 6.99
 T(local: qops_dict memcpy cpu2gpu     ) = 4.431e-05 S  per = 1.19  per(accum) = 8.17
 T(local: symbolic_formulae_renorm     ) = 4.794e-04 S  per = 12.8  per(accum) = 21
 T(local: rintermediate init           ) = 6.279e-05 S  per = 1.68  per(accum) = 22.7
 T(local: rintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 0.000776  per(accum) = 22.7
 T(local: preprocess_formulae_Rlist2   ) = 6.320e-04 S  per = 16.9  per(accum) = 39.6
 T(local: rmmtasks init                ) = 5.346e-04 S  per = 14.3  per(accum) = 53.9
 T(local: qops memset                  ) = 2.400e-08 S  per = 0.000642  per(accum) = 53.9
 T(local: preprocess_renorm_batchGPU   ) = 1.614e-03 S  per = 43.2  per(accum) = 97.1
 T(local: qops memcpy gpu2cpu          ) = 1.418e-05 S  per = 0.379  per(accum) = 97.5
 T(local: deallocate gpu memory        ) = 3.459e-05 S  per = 0.925  per(accum) = 98.4
 T(local: communication of opS and opH ) = 6.023e-05 S  per = 1.61  per(accum) = 100
##### sweep: 1.914e-01 S #####
 T(sweep: fetch) = 4.129e-03 S  per = 2.16  per(accum) = 2.16
 T(sweep: hdiag) = 2.549e-03 S  per = 1.33  per(accum) = 3.49
 T(sweep: dvdsn) = 1.616e-01 S  per = 84.4  per(accum) = 87.9
 T(sweep: decim) = 4.254e-03 S  per = 2.22  per(accum) = 90.1
 T(sweep: guess) = 1.475e-03 S  per = 0.771  per(accum) = 90.9
 T(sweep: renrm) = 1.630e-02 S  per = 8.52  per(accum) = 99.4
 T(sweep: save ) = 1.085e-03 S  per = 0.567  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.580e-01 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 4.661e-05 S  per = 0.0295  per(accum) = 0.0295
 T(sweep: symbolic_formulae_twodot     ) = 2.617e-03 S  per = 1.66  per(accum) = 1.69
 T(sweep: hintermediate init           ) = 2.277e-04 S  per = 0.144  per(accum) = 1.83
 T(sweep: hintermediates memcpy cpu2gpu) = 1.140e-07 S  per = 7.21e-05  per(accum) = 1.83
 T(sweep: preprocess_hformulae_Hxlist2 ) = 1.219e-02 S  per = 7.71  per(accum) = 9.54
 T(sweep: hmmtasks init                ) = 1.208e-02 S  per = 7.65  per(accum) = 17.2
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 1.285e-01 S  per = 81.3  per(accum) = 98.5
 T(sweep: dvdson solver [communication]) = 1.826e-04 S  per = 0.116  per(accum) = 98.6
 T(sweep: dvdson solver [rest part]    ) = 2.244e-03 S  per = 1.42  per(accum) = 100
Detailed decomposition of T(renrm): 1.581e-02 S
 T(sweep: qops init                    ) = 1.120e-03 S  per = 7.09  per(accum) = 7.09
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.658e-04 S  per = 1.05  per(accum) = 8.14
 T(sweep: symbolic_formulae_renorm     ) = 2.177e-03 S  per = 13.8  per(accum) = 21.9
 T(sweep: rintermediate init           ) = 1.849e-04 S  per = 1.17  per(accum) = 23.1
 T(sweep: rintermediates memcpy cpu2gpu) = 1.140e-07 S  per = 0.000721  per(accum) = 23.1
 T(sweep: preprocess_formulae_Rlist2   ) = 2.955e-03 S  per = 18.7  per(accum) = 41.8
 T(sweep: rmmtasks init                ) = 2.571e-03 S  per = 16.3  per(accum) = 58
 T(sweep: qops memset                  ) = 1.100e-07 S  per = 0.000696  per(accum) = 58
 T(sweep: preprocess_renorm_batchGPU   ) = 6.185e-03 S  per = 39.1  per(accum) = 97.2
 T(sweep: qops memcpy gpu2cpu          ) = 5.777e-05 S  per = 0.365  per(accum) = 97.5
 T(sweep: deallocate gpu memory        ) = 1.527e-04 S  per = 0.966  per(accum) = 98.5
 T(sweep: communication of opS and opH ) = 2.400e-04 S  per = 1.52  per(accum) = 100
##### global: 1.914e-01 S #####
 T(global: fetch) = 4.129e-03 S  per = 2.16  per(accum) = 2.16
 T(global: hdiag) = 2.549e-03 S  per = 1.33  per(accum) = 3.49
 T(global: dvdsn) = 1.616e-01 S  per = 84.4  per(accum) = 87.9
 T(global: decim) = 4.254e-03 S  per = 2.22  per(accum) = 90.1
 T(global: guess) = 1.475e-03 S  per = 0.771  per(accum) = 90.9
 T(global: renrm) = 1.630e-02 S  per = 8.52  per(accum) = 99.4
 T(global: save ) = 1.085e-03 S  per = 0.567  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.580e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 4.661e-05 S  per = 0.0295  per(accum) = 0.0295
 T(global: symbolic_formulae_twodot     ) = 2.617e-03 S  per = 1.66  per(accum) = 1.69
 T(global: hintermediate init           ) = 2.277e-04 S  per = 0.144  per(accum) = 1.83
 T(global: hintermediates memcpy cpu2gpu) = 1.140e-07 S  per = 7.21e-05  per(accum) = 1.83
 T(global: preprocess_hformulae_Hxlist2 ) = 1.219e-02 S  per = 7.71  per(accum) = 9.54
 T(global: hmmtasks init                ) = 1.208e-02 S  per = 7.65  per(accum) = 17.2
 T(global: dvdson solver [Hx_batchGPU]  ) = 1.285e-01 S  per = 81.3  per(accum) = 98.5
 T(global: dvdson solver [communication]) = 1.826e-04 S  per = 0.116  per(accum) = 98.6
 T(global: dvdson solver [rest part]    ) = 2.244e-03 S  per = 1.42  per(accum) = 100
Detailed decomposition of T(renrm): 1.581e-02 S
 T(global: qops init                    ) = 1.120e-03 S  per = 7.09  per(accum) = 7.09
 T(global: qops_dict memcpy cpu2gpu     ) = 1.658e-04 S  per = 1.05  per(accum) = 8.14
 T(global: symbolic_formulae_renorm     ) = 2.177e-03 S  per = 13.8  per(accum) = 21.9
 T(global: rintermediate init           ) = 1.849e-04 S  per = 1.17  per(accum) = 23.1
 T(global: rintermediates memcpy cpu2gpu) = 1.140e-07 S  per = 0.000721  per(accum) = 23.1
 T(global: preprocess_formulae_Rlist2   ) = 2.955e-03 S  per = 18.7  per(accum) = 41.8
 T(global: rmmtasks init                ) = 2.571e-03 S  per = 16.3  per(accum) = 58
 T(global: qops memset                  ) = 1.100e-07 S  per = 0.000696  per(accum) = 58
 T(global: preprocess_renorm_batchGPU   ) = 6.185e-03 S  per = 39.1  per(accum) = 97.2
 T(global: qops memcpy gpu2cpu          ) = 5.777e-05 S  per = 0.365  per(accum) = 97.5
 T(global: deallocate gpu memory        ) = 1.527e-04 S  per = 0.966  per(accum) = 98.5
 T(global: communication of opS and opH ) = 2.400e-04 S  per = 1.52  per(accum) = 100

======================================================================
sweep_data::summary isweep=0
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0.0001
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=10 dwt=+2.889e-03 nmvp=2 e[0]=-2.65451696694 e[1]=-2.27865402598 t=0.0246
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=10 dwt=+9.646e-03 nmvp=19 e[0]=-2.65109283069 e[1]=-2.42764317688 t=0.0641
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=10 dwt=+1.379e-03 nmvp=15 e[0]=-2.65109282772 e[1]=-2.42764318221 t=0.0523
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=10 dwt=+9.505e-03 nmvp=15 e[0]=-2.65208108952 e[1]=-2.43068987874 t=0.0504
 eav_max=-2.46658549646 [ibond=0]  dwt_min=1.379e-03 [ibond=2]
 eav_min=-2.54138548413 [ibond=3]  dwt_max=9.646e-03 [ibond=1]
 eav_diff=0.0747999876727
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+9.505e-03 e[0]=-2.65208108952
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+9.505e-03 e[1]=-2.43068987874
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.000e-04 1.000e-04 | 51 | 1.940e-01 | 1.940e-01 | 1.116e-02 1.028e-01 1.083e-02 1.248e-01 64.4
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.505e-03 e[0]=-2.65208108952 (0.000e+00) e[1]=-2.43068987874 (0.000e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep0.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row_nkr dcut=8 nqr=9 alg_decim=0 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep0_C0R1.txt
 qbond: qsuper nsym=9 dimAll=40
 (3,1):10 (4,0):6 (2,0):5 (4,2):5 (2,2):4 (5,1):3 (3,-1):3 (1,1):2 (3,3):2
----- TMING FOR decimation_genbasis: 5.498e-05 S T(scatter/comp/gather)=5.737e-06,4.531e-05,3.935e-06 -----
decimation summary: 40->8 dwt=+0.000e+00 SvN=1.265e+00
 qbond: qkept nsym=4 dimAll=8
 (3,1):2 (4,0):2 (4,2):2 (5,1):2
----- TIMING for decimation_row: 3.121e-04 S T(decim/formRot)=1.084e-04,2.038e-04 -----

Convert [C]RRR => [cR]RRR:
ctns::decimation_row_nkr dcut=2 nqr=9 alg_decim=0 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep0_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
----- TMING FOR decimation_genbasis: 2.830e-05 S T(scatter/comp/gather)=4.339e-06,2.187e-05,2.096e-06 -----
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00
 qbond: qkept nsym=1 dimAll=2
 (5,1):2
----- TIMING for decimation_row: 2.236e-04 S T(decim/formRot)=8.500e-05,1.386e-04 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep0.info

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.000e+00
 idx=1 node=(3,0) Drow=10 maxdiff=1.009e-15
 idx=2 node=(2,0) Drow=10 maxdiff=1.577e-15
 idx=3 node=(1,0) Drow=8 maxdiff=9.433e-16
 idx=4 node=(0,0) Drow=2 maxdiff=4.441e-16
stensor2: wf2 own=1 _data=0x44c84350
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.052e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x44c84350
      1.0893e-18       1.0000e+00 
      1.0000e+00      -3.2337e-17 
 rwfuns: nroots=2 maxdiff=9.1658e-16
----- TIMING FOR ctns::rcanon_check : 1.876e-04 S -----
..... end of isweep = 0 .....

======================================================================
sweep parameters: isweep=1 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=142:0.00108MB:1.06e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=221:0.00169MB:1.65e-06GB

isweep=1 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=499:0.00381MB:3.72e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=937:0.00715MB:6.98e-06GB
wf4(diml,dimr,dimc1,dimc2)=(4,10,4,4) nnz=72:0.000549MB
stensor4: wf own=1 _data=0x42e98fb0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=5 dimAll=10
 (2,0):4 (1,1):2 (1,-1):2 (0,0):1 (2,2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=33 nblocks=320 size=72:0.000549MB
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
### DIAG TIMING: total=0.000333 t1=1.76e-05, t2=1.98e-05, t3=4.2e-05, t4=0.000157, t5=5.46e-05, t6=2.4e-05, t7=1.41e-05, t8=3.89e-06
duration_diagGPU:0.000357
duration_diagreduce:4.33e-06
duration_diagtransform:1.46e-06
rank=0 GPUmem(GB): used=1.06e-05 (oper)=6.98e-06
----- TIMING FOR symbolic_formulae_twodot with size=93 : 7.114e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=93
 no. of hintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.898e-05 S -----
rank=0 GPUmem(GB): used=1.09e-05 (oper,hinter)=6.98e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00239 S size(H_formulae)=93 size(Hxlst2)=33 T(Hmu/Hxlist)=0.000199,0.00219 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00255 S size(H_formulae)=93 size(Hxlst)=1848 -----
rank=0 GPUmem(GB): used=0.000246 (oper,hinter,dvdson,batch)=6.98e-06,2.98e-07,1.07e-06,0.000234 blksize=4 blksize0=8 batchsize=1848
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=72 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000208,0.00189,0.000203 cost=2.48e+04 flops[gemm]=1.31e+07
--- TIMING FOR sigma : t_inter=0.000208 t_gemm=0.00189 t_reduction=0.000203 tot=0.0023 ---
 sigma counter=52 i=0 t=0.00024 per=12.7 cost=2.14e+03 flops=8.9e+06
 sigma counter=52 i=1 t=0.000237 per=12.6 cost=2.35e+03 flops=9.93e+06
 sigma counter=52 i=2 t=0.000235 per=12.4 cost=1.7e+03 flops=7.25e+06
 sigma counter=52 i=3 t=0.000229 per=12.1 cost=1.89e+03 flops=8.24e+06
 sigma counter=52 i=4 t=0.000232 per=12.3 cost=5.75e+03 flops=2.48e+07
 sigma counter=52 i=5 t=0.000235 per=12.4 cost=5.75e+03 flops=2.45e+07
 sigma counter=52 i=6 t=0.000247 per=13.1 cost=2.67e+03 flops=1.08e+07
 sigma counter=52 i=7 t=0.000233 per=12.3 cost=2.52e+03 flops=1.08e+07
 total GEMM cost=2.48e+04 flops=1.31e+07
--- TIMING FOR sigma_tot : t_inter=0.0109 t_gemm=0.1 t_reduction=0.0103 tot=0.121 ---
 sigma_tot counter=52 i=0 t=0.0124 per=12.4 cost=1.06e+05 flops=8.59e+06
 sigma_tot counter=52 i=1 t=0.0126 per=12.5 cost=1.1e+05 flops=8.71e+06
 sigma_tot counter=52 i=2 t=0.0124 per=12.4 cost=1.27e+05 flops=1.03e+07
 sigma_tot counter=52 i=3 t=0.0123 per=12.3 cost=1.31e+05 flops=1.07e+07
 sigma_tot counter=52 i=4 t=0.0125 per=12.5 cost=2.15e+05 flops=1.72e+07
 sigma_tot counter=52 i=5 t=0.0126 per=12.5 cost=2.16e+05 flops=1.72e+07
 sigma_tot counter=52 i=6 t=0.0129 per=12.9 cost=2.75e+05 flops=2.13e+07
 sigma_tot counter=52 i=7 t=0.0126 per=12.5 cost=2.73e+05 flops=2.17e+07
 total GEMM cost=1.45e+06 flops=1.45e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000202,0.00189,0.000197 cost=2.48e+04 flops[gemm]=1.31e+07
--- TIMING FOR sigma : t_inter=0.000202 t_gemm=0.00189 t_reduction=0.000197 tot=0.00229 ---
 sigma counter=53 i=0 t=0.000249 per=13.2 cost=2.14e+03 flops=8.58e+06
 sigma counter=53 i=1 t=0.000246 per=13 cost=2.35e+03 flops=9.57e+06
 sigma counter=53 i=2 t=0.000225 per=11.9 cost=1.7e+03 flops=7.57e+06
 sigma counter=53 i=3 t=0.000226 per=12 cost=1.89e+03 flops=8.35e+06
 sigma counter=53 i=4 t=0.000236 per=12.5 cost=5.75e+03 flops=2.44e+07
 sigma counter=53 i=5 t=0.000231 per=12.2 cost=5.75e+03 flops=2.49e+07
 sigma counter=53 i=6 t=0.000238 per=12.6 cost=2.67e+03 flops=1.12e+07
 sigma counter=53 i=7 t=0.000237 per=12.6 cost=2.52e+03 flops=1.06e+07
 total GEMM cost=2.48e+04 flops=1.31e+07
--- TIMING FOR sigma_tot : t_inter=0.0111 t_gemm=0.102 t_reduction=0.0104 tot=0.124 ---
 sigma_tot counter=53 i=0 t=0.0127 per=12.4 cost=1.09e+05 flops=8.59e+06
 sigma_tot counter=53 i=1 t=0.0128 per=12.6 cost=1.12e+05 flops=8.73e+06
 sigma_tot counter=53 i=2 t=0.0126 per=12.4 cost=1.29e+05 flops=1.02e+07
 sigma_tot counter=53 i=3 t=0.0125 per=12.3 cost=1.33e+05 flops=1.06e+07
 sigma_tot counter=53 i=4 t=0.0127 per=12.5 cost=2.21e+05 flops=1.73e+07
 sigma_tot counter=53 i=5 t=0.0128 per=12.5 cost=2.22e+05 flops=1.74e+07
 sigma_tot counter=53 i=6 t=0.0132 per=12.9 cost=2.78e+05 flops=2.11e+07
 sigma_tot counter=53 i=7 t=0.0128 per=12.5 cost=2.75e+05 flops=2.15e+07
 total GEMM cost=1.48e+06 flops=1.45e+07
settings: ndim=72 neig=2 maxcycle=30 nbuff=4 memory=9.66e-06GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.641998458516 -1.003e+03  1.429e-01    2     2  5.016e-03 2.508e-03
    1   1 -      -2.409549170696 -1.002e+03  1.871e-01    2     2  5.016e-03 2.508e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,1.990e-04,1.878e-03,1.960e-04 cost=2.477e+04 flops[gemm]=1.319e+07
--- TIMING FOR sigma : t_inter=1.990e-04 t_gemm=1.878e-03 t_reduction=1.960e-04 tot=2.273e-03 ---
 sigma counter=54 i=0 t=2.410e-04 per=1.283e+01 cost=2.136e+03 flops=8.863e+06
 sigma counter=54 i=1 t=2.460e-04 per=1.310e+01 cost=2.354e+03 flops=9.569e+06
 sigma counter=54 i=2 t=2.310e-04 per=1.230e+01 cost=1.704e+03 flops=7.377e+06
 sigma counter=54 i=3 t=2.260e-04 per=1.203e+01 cost=1.886e+03 flops=8.345e+06
 sigma counter=54 i=4 t=2.300e-04 per=1.225e+01 cost=5.748e+03 flops=2.499e+07
 sigma counter=54 i=5 t=2.300e-04 per=1.225e+01 cost=5.748e+03 flops=2.499e+07
 sigma counter=54 i=6 t=2.400e-04 per=1.278e+01 cost=2.674e+03 flops=1.114e+07
 sigma counter=54 i=7 t=2.340e-04 per=1.246e+01 cost=2.524e+03 flops=1.079e+07
 total GEMM cost=2.477e+04 flops=1.319e+07
--- TIMING FOR sigma_tot : t_inter=1.135e-02 t_gemm=1.040e-01 t_reduction=1.064e-02 tot=1.260e-01 ---
 sigma_tot counter=54 i=0 t=1.289e-02 per=1.240e+01 cost=1.108e+05 flops=8.591e+06
 sigma_tot counter=54 i=1 t=1.307e-02 per=1.257e+01 cost=1.143e+05 flops=8.746e+06
 sigma_tot counter=54 i=2 t=1.284e-02 per=1.235e+01 cost=1.309e+05 flops=1.019e+07
 sigma_tot counter=54 i=3 t=1.276e-02 per=1.227e+01 cost=1.351e+05 flops=1.058e+07
 sigma_tot counter=54 i=4 t=1.297e-02 per=1.247e+01 cost=2.264e+05 flops=1.746e+07
 sigma_tot counter=54 i=5 t=1.302e-02 per=1.252e+01 cost=2.276e+05 flops=1.749e+07
 sigma_tot counter=54 i=6 t=1.341e-02 per=1.289e+01 cost=2.805e+05 flops=2.093e+07
 sigma_tot counter=54 i=7 t=1.303e-02 per=1.253e+01 cost=2.778e+05 flops=2.132e+07
 total GEMM cost=1.503e+06 flops=1.446e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.000e-04,1.873e-03,1.950e-04 cost=2.477e+04 flops[gemm]=1.323e+07
--- TIMING FOR sigma : t_inter=2.000e-04 t_gemm=1.873e-03 t_reduction=1.950e-04 tot=2.268e-03 ---
 sigma counter=55 i=0 t=2.400e-04 per=1.281e+01 cost=2.136e+03 flops=8.900e+06
 sigma counter=55 i=1 t=2.440e-04 per=1.303e+01 cost=2.354e+03 flops=9.648e+06
 sigma counter=55 i=2 t=2.250e-04 per=1.201e+01 cost=1.704e+03 flops=7.573e+06
 sigma counter=55 i=3 t=2.250e-04 per=1.201e+01 cost=1.886e+03 flops=8.382e+06
 sigma counter=55 i=4 t=2.330e-04 per=1.244e+01 cost=5.748e+03 flops=2.467e+07
 sigma counter=55 i=5 t=2.310e-04 per=1.233e+01 cost=5.748e+03 flops=2.488e+07
 sigma counter=55 i=6 t=2.420e-04 per=1.292e+01 cost=2.674e+03 flops=1.105e+07
 sigma counter=55 i=7 t=2.330e-04 per=1.244e+01 cost=2.524e+03 flops=1.083e+07
 total GEMM cost=2.477e+04 flops=1.323e+07
--- TIMING FOR sigma_tot : t_inter=1.155e-02 t_gemm=1.059e-01 t_reduction=1.084e-02 tot=1.282e-01 ---
 sigma_tot counter=55 i=0 t=1.313e-02 per=1.240e+01 cost=1.129e+05 flops=8.597e+06
 sigma_tot counter=55 i=1 t=1.331e-02 per=1.258e+01 cost=1.167e+05 flops=8.763e+06
 sigma_tot counter=55 i=2 t=1.307e-02 per=1.234e+01 cost=1.326e+05 flops=1.014e+07
 sigma_tot counter=55 i=3 t=1.299e-02 per=1.227e+01 cost=1.370e+05 flops=1.055e+07
 sigma_tot counter=55 i=4 t=1.320e-02 per=1.247e+01 cost=2.322e+05 flops=1.759e+07
 sigma_tot counter=55 i=5 t=1.325e-02 per=1.251e+01 cost=2.334e+05 flops=1.762e+07
 sigma_tot counter=55 i=6 t=1.365e-02 per=1.289e+01 cost=2.832e+05 flops=2.075e+07
 sigma_tot counter=55 i=7 t=1.326e-02 per=1.253e+01 cost=2.803e+05 flops=2.113e+07
 total GEMM cost=1.528e+06 flops=1.444e+07
    2   0 -      -2.651381055791 -9.383e-03  3.403e-02    4     4  9.993e-03 2.498e-03
    2   1 -      -2.428926260602 -1.938e-02  5.143e-02    4     4  9.993e-03 2.498e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.000e-05,2.080e-04,1.867e-03,1.960e-04 cost=2.477e+04 flops[gemm]=1.327e+07
--- TIMING FOR sigma : t_inter=2.080e-04 t_gemm=1.867e-03 t_reduction=1.960e-04 tot=2.271e-03 ---
 sigma counter=56 i=0 t=2.380e-04 per=1.275e+01 cost=2.136e+03 flops=8.975e+06
 sigma counter=56 i=1 t=2.350e-04 per=1.259e+01 cost=2.354e+03 flops=1.002e+07
 sigma counter=56 i=2 t=2.310e-04 per=1.237e+01 cost=1.704e+03 flops=7.377e+06
 sigma counter=56 i=3 t=2.260e-04 per=1.210e+01 cost=1.886e+03 flops=8.345e+06
 sigma counter=56 i=4 t=2.310e-04 per=1.237e+01 cost=5.748e+03 flops=2.488e+07
 sigma counter=56 i=5 t=2.320e-04 per=1.243e+01 cost=5.748e+03 flops=2.478e+07
 sigma counter=56 i=6 t=2.420e-04 per=1.296e+01 cost=2.674e+03 flops=1.105e+07
 sigma counter=56 i=7 t=2.320e-04 per=1.243e+01 cost=2.524e+03 flops=1.088e+07
 total GEMM cost=2.477e+04 flops=1.327e+07
--- TIMING FOR sigma_tot : t_inter=1.176e-02 t_gemm=1.077e-01 t_reduction=1.103e-02 tot=1.305e-01 ---
 sigma_tot counter=56 i=0 t=1.337e-02 per=1.241e+01 cost=1.150e+05 flops=8.604e+06
 sigma_tot counter=56 i=1 t=1.355e-02 per=1.258e+01 cost=1.190e+05 flops=8.785e+06
 sigma_tot counter=56 i=2 t=1.330e-02 per=1.235e+01 cost=1.343e+05 flops=1.010e+07
 sigma_tot counter=56 i=3 t=1.321e-02 per=1.227e+01 cost=1.388e+05 flops=1.051e+07
 sigma_tot counter=56 i=4 t=1.343e-02 per=1.247e+01 cost=2.379e+05 flops=1.771e+07
 sigma_tot counter=56 i=5 t=1.348e-02 per=1.251e+01 cost=2.391e+05 flops=1.774e+07
 sigma_tot counter=56 i=6 t=1.389e-02 per=1.289e+01 cost=2.859e+05 flops=2.058e+07
 sigma_tot counter=56 i=7 t=1.350e-02 per=1.253e+01 cost=2.828e+05 flops=2.096e+07
 total GEMM cost=1.553e+06 flops=1.442e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.010e-04,1.900e-03,2.010e-04 cost=2.477e+04 flops[gemm]=1.304e+07
--- TIMING FOR sigma : t_inter=2.000e-04 t_gemm=1.898e-03 t_reduction=2.010e-04 tot=2.299e-03 ---
 sigma counter=57 i=0 t=2.370e-04 per=1.249e+01 cost=2.136e+03 flops=9.013e+06
 sigma counter=57 i=1 t=2.430e-04 per=1.280e+01 cost=2.354e+03 flops=9.687e+06
 sigma counter=57 i=2 t=2.240e-04 per=1.180e+01 cost=1.704e+03 flops=7.607e+06
 sigma counter=57 i=3 t=2.270e-04 per=1.196e+01 cost=1.886e+03 flops=8.308e+06
 sigma counter=57 i=4 t=2.430e-04 per=1.280e+01 cost=5.748e+03 flops=2.365e+07
 sigma counter=57 i=5 t=2.390e-04 per=1.259e+01 cost=5.748e+03 flops=2.405e+07
 sigma counter=57 i=6 t=2.450e-04 per=1.291e+01 cost=2.674e+03 flops=1.091e+07
 sigma counter=57 i=7 t=2.400e-04 per=1.264e+01 cost=2.524e+03 flops=1.052e+07
 total GEMM cost=2.477e+04 flops=1.305e+07
--- TIMING FOR sigma_tot : t_inter=1.196e-02 t_gemm=1.096e-01 t_reduction=1.124e-02 tot=1.328e-01 ---
 sigma_tot counter=57 i=0 t=1.361e-02 per=1.241e+01 cost=1.172e+05 flops=8.611e+06
 sigma_tot counter=57 i=1 t=1.379e-02 per=1.258e+01 cost=1.214e+05 flops=8.801e+06
 sigma_tot counter=57 i=2 t=1.352e-02 per=1.234e+01 cost=1.360e+05 flops=1.005e+07
 sigma_tot counter=57 i=3 t=1.344e-02 per=1.226e+01 cost=1.407e+05 flops=1.047e+07
 sigma_tot counter=57 i=4 t=1.367e-02 per=1.247e+01 cost=2.437e+05 flops=1.782e+07
 sigma_tot counter=57 i=5 t=1.372e-02 per=1.251e+01 cost=2.449e+05 flops=1.785e+07
 sigma_tot counter=57 i=6 t=1.413e-02 per=1.289e+01 cost=2.885e+05 flops=2.041e+07
 sigma_tot counter=57 i=7 t=1.374e-02 per=1.253e+01 cost=2.854e+05 flops=2.077e+07
 total GEMM cost=1.578e+06 flops=1.439e+07
    3   0 -      -2.652042676029 -6.616e-04  6.550e-03    6     6  1.500e-02 2.499e-03
    3   1 -      -2.430569433552 -1.643e-03  1.221e-02    6     6  1.500e-02 2.499e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.060e-04,1.857e-03,1.980e-04 cost=2.477e+04 flops[gemm]=1.334e+07
--- TIMING FOR sigma : t_inter=2.060e-04 t_gemm=1.857e-03 t_reduction=1.980e-04 tot=2.261e-03 ---
 sigma counter=58 i=0 t=2.370e-04 per=1.276e+01 cost=2.136e+03 flops=9.013e+06
 sigma counter=58 i=1 t=2.370e-04 per=1.276e+01 cost=2.354e+03 flops=9.932e+06
 sigma counter=58 i=2 t=2.240e-04 per=1.206e+01 cost=1.704e+03 flops=7.607e+06
 sigma counter=58 i=3 t=2.270e-04 per=1.222e+01 cost=1.886e+03 flops=8.308e+06
 sigma counter=58 i=4 t=2.320e-04 per=1.249e+01 cost=5.748e+03 flops=2.478e+07
 sigma counter=58 i=5 t=2.280e-04 per=1.228e+01 cost=5.748e+03 flops=2.521e+07
 sigma counter=58 i=6 t=2.400e-04 per=1.292e+01 cost=2.674e+03 flops=1.114e+07
 sigma counter=58 i=7 t=2.320e-04 per=1.249e+01 cost=2.524e+03 flops=1.088e+07
 total GEMM cost=2.477e+04 flops=1.334e+07
--- TIMING FOR sigma_tot : t_inter=1.216e-02 t_gemm=1.115e-01 t_reduction=1.143e-02 tot=1.351e-01 ---
 sigma_tot counter=58 i=0 t=1.384e-02 per=1.242e+01 cost=1.193e+05 flops=8.618e+06
 sigma_tot counter=58 i=1 t=1.403e-02 per=1.258e+01 cost=1.237e+05 flops=8.820e+06
 sigma_tot counter=58 i=2 t=1.375e-02 per=1.233e+01 cost=1.377e+05 flops=1.001e+07
 sigma_tot counter=58 i=3 t=1.367e-02 per=1.226e+01 cost=1.426e+05 flops=1.043e+07
 sigma_tot counter=58 i=4 t=1.391e-02 per=1.247e+01 cost=2.494e+05 flops=1.793e+07
 sigma_tot counter=58 i=5 t=1.395e-02 per=1.251e+01 cost=2.506e+05 flops=1.797e+07
 sigma_tot counter=58 i=6 t=1.438e-02 per=1.289e+01 cost=2.912e+05 flops=2.026e+07
 sigma_tot counter=58 i=7 t=1.397e-02 per=1.253e+01 cost=2.879e+05 flops=2.061e+07
 total GEMM cost=1.602e+06 flops=1.437e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.050e-04,1.898e-03,1.950e-04 cost=2.477e+04 flops[gemm]=1.305e+07
--- TIMING FOR sigma : t_inter=2.050e-04 t_gemm=1.898e-03 t_reduction=1.950e-04 tot=2.298e-03 ---
 sigma counter=59 i=0 t=2.470e-04 per=1.301e+01 cost=2.136e+03 flops=8.648e+06
 sigma counter=59 i=1 t=2.530e-04 per=1.333e+01 cost=2.354e+03 flops=9.304e+06
 sigma counter=59 i=2 t=2.290e-04 per=1.207e+01 cost=1.704e+03 flops=7.441e+06
 sigma counter=59 i=3 t=2.320e-04 per=1.222e+01 cost=1.886e+03 flops=8.129e+06
 sigma counter=59 i=4 t=2.380e-04 per=1.254e+01 cost=5.748e+03 flops=2.415e+07
 sigma counter=59 i=5 t=2.290e-04 per=1.207e+01 cost=5.748e+03 flops=2.510e+07
 sigma counter=59 i=6 t=2.380e-04 per=1.254e+01 cost=2.674e+03 flops=1.124e+07
 sigma counter=59 i=7 t=2.320e-04 per=1.222e+01 cost=2.524e+03 flops=1.088e+07
 total GEMM cost=2.477e+04 flops=1.305e+07
--- TIMING FOR sigma_tot : t_inter=1.237e-02 t_gemm=1.134e-01 t_reduction=1.163e-02 tot=1.374e-01 ---
 sigma_tot counter=59 i=0 t=1.409e-02 per=1.243e+01 cost=1.214e+05 flops=8.618e+06
 sigma_tot counter=59 i=1 t=1.428e-02 per=1.260e+01 cost=1.261e+05 flops=8.828e+06
 sigma_tot counter=59 i=2 t=1.398e-02 per=1.233e+01 cost=1.394e+05 flops=9.973e+06
 sigma_tot counter=59 i=3 t=1.390e-02 per=1.226e+01 cost=1.445e+05 flops=1.040e+07
 sigma_tot counter=59 i=4 t=1.414e-02 per=1.248e+01 cost=2.552e+05 flops=1.804e+07
 sigma_tot counter=59 i=5 t=1.417e-02 per=1.250e+01 cost=2.564e+05 flops=1.809e+07
 sigma_tot counter=59 i=6 t=1.461e-02 per=1.289e+01 cost=2.939e+05 flops=2.011e+07
 sigma_tot counter=59 i=7 t=1.420e-02 per=1.253e+01 cost=2.904e+05 flops=2.045e+07
 total GEMM cost=1.627e+06 flops=1.435e+07
    4   0 -      -2.652077167028 -3.449e-05  1.945e-03    6     8  1.997e-02 2.496e-03
    4   1 -      -2.430677272748 -1.078e-04  3.531e-03    6     8  1.997e-02 2.496e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.070e-04,1.887e-03,1.960e-04 cost=2.477e+04 flops[gemm]=1.313e+07
--- TIMING FOR sigma : t_inter=2.070e-04 t_gemm=1.885e-03 t_reduction=1.950e-04 tot=2.287e-03 ---
 sigma counter=60 i=0 t=2.380e-04 per=1.263e+01 cost=2.136e+03 flops=8.975e+06
 sigma counter=60 i=1 t=2.330e-04 per=1.236e+01 cost=2.354e+03 flops=1.010e+07
 sigma counter=60 i=2 t=2.320e-04 per=1.231e+01 cost=1.704e+03 flops=7.345e+06
 sigma counter=60 i=3 t=2.300e-04 per=1.220e+01 cost=1.886e+03 flops=8.200e+06
 sigma counter=60 i=4 t=2.370e-04 per=1.257e+01 cost=5.748e+03 flops=2.425e+07
 sigma counter=60 i=5 t=2.350e-04 per=1.247e+01 cost=5.748e+03 flops=2.446e+07
 sigma counter=60 i=6 t=2.420e-04 per=1.284e+01 cost=2.674e+03 flops=1.105e+07
 sigma counter=60 i=7 t=2.380e-04 per=1.263e+01 cost=2.524e+03 flops=1.061e+07
 total GEMM cost=2.477e+04 flops=1.314e+07
--- TIMING FOR sigma_tot : t_inter=1.257e-02 t_gemm=1.153e-01 t_reduction=1.182e-02 tot=1.397e-01 ---
 sigma_tot counter=60 i=0 t=1.433e-02 per=1.243e+01 cost=1.236e+05 flops=8.624e+06
 sigma_tot counter=60 i=1 t=1.451e-02 per=1.259e+01 cost=1.284e+05 flops=8.849e+06
 sigma_tot counter=60 i=2 t=1.421e-02 per=1.233e+01 cost=1.411e+05 flops=9.930e+06
 sigma_tot counter=60 i=3 t=1.413e-02 per=1.226e+01 cost=1.464e+05 flops=1.036e+07
 sigma_tot counter=60 i=4 t=1.438e-02 per=1.248e+01 cost=2.609e+05 flops=1.814e+07
 sigma_tot counter=60 i=5 t=1.441e-02 per=1.250e+01 cost=2.621e+05 flops=1.819e+07
 sigma_tot counter=60 i=6 t=1.486e-02 per=1.289e+01 cost=2.966e+05 flops=1.996e+07
 sigma_tot counter=60 i=7 t=1.444e-02 per=1.253e+01 cost=2.929e+05 flops=2.029e+07
 total GEMM cost=1.652e+06 flops=1.433e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.010e-04,1.854e-03,1.950e-04 cost=2.477e+04 flops[gemm]=1.336e+07
--- TIMING FOR sigma : t_inter=2.010e-04 t_gemm=1.853e-03 t_reduction=1.950e-04 tot=2.249e-03 ---
 sigma counter=61 i=0 t=2.360e-04 per=1.274e+01 cost=2.136e+03 flops=9.051e+06
 sigma counter=61 i=1 t=2.360e-04 per=1.274e+01 cost=2.354e+03 flops=9.975e+06
 sigma counter=61 i=2 t=2.330e-04 per=1.257e+01 cost=1.704e+03 flops=7.313e+06
 sigma counter=61 i=3 t=2.230e-04 per=1.203e+01 cost=1.886e+03 flops=8.457e+06
 sigma counter=61 i=4 t=2.280e-04 per=1.230e+01 cost=5.748e+03 flops=2.521e+07
 sigma counter=61 i=5 t=2.290e-04 per=1.236e+01 cost=5.748e+03 flops=2.510e+07
 sigma counter=61 i=6 t=2.370e-04 per=1.279e+01 cost=2.674e+03 flops=1.128e+07
 sigma counter=61 i=7 t=2.310e-04 per=1.247e+01 cost=2.524e+03 flops=1.093e+07
 total GEMM cost=2.477e+04 flops=1.337e+07
--- TIMING FOR sigma_tot : t_inter=1.278e-02 t_gemm=1.171e-01 t_reduction=1.202e-02 tot=1.419e-01 ---
 sigma_tot counter=61 i=0 t=1.456e-02 per=1.244e+01 cost=1.257e+05 flops=8.631e+06
 sigma_tot counter=61 i=1 t=1.475e-02 per=1.259e+01 cost=1.308e+05 flops=8.867e+06
 sigma_tot counter=61 i=2 t=1.444e-02 per=1.233e+01 cost=1.428e+05 flops=9.887e+06
 sigma_tot counter=61 i=3 t=1.435e-02 per=1.225e+01 cost=1.483e+05 flops=1.033e+07
 sigma_tot counter=61 i=4 t=1.461e-02 per=1.247e+01 cost=2.667e+05 flops=1.825e+07
 sigma_tot counter=61 i=5 t=1.464e-02 per=1.250e+01 cost=2.679e+05 flops=1.830e+07
 sigma_tot counter=61 i=6 t=1.509e-02 per=1.289e+01 cost=2.992e+05 flops=1.983e+07
 sigma_tot counter=61 i=7 t=1.467e-02 per=1.253e+01 cost=2.955e+05 flops=2.014e+07
 total GEMM cost=1.677e+06 flops=1.432e+07
    5   0 -      -2.652080298591 -3.132e-06  9.850e-04    6    10  2.493e-02 2.493e-03
    5   1 -      -2.430686752246 -9.479e-06  1.832e-03    6    10  2.493e-02 2.493e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.070e-04,1.903e-03,2.000e-04 cost=2.477e+04 flops[gemm]=1.302e+07
--- TIMING FOR sigma : t_inter=2.070e-04 t_gemm=1.903e-03 t_reduction=2.000e-04 tot=2.310e-03 ---
 sigma counter=62 i=0 t=2.420e-04 per=1.272e+01 cost=2.136e+03 flops=8.826e+06
 sigma counter=62 i=1 t=2.370e-04 per=1.245e+01 cost=2.354e+03 flops=9.932e+06
 sigma counter=62 i=2 t=2.370e-04 per=1.245e+01 cost=1.704e+03 flops=7.190e+06
 sigma counter=62 i=3 t=2.310e-04 per=1.214e+01 cost=1.886e+03 flops=8.165e+06
 sigma counter=62 i=4 t=2.340e-04 per=1.230e+01 cost=5.748e+03 flops=2.456e+07
 sigma counter=62 i=5 t=2.370e-04 per=1.245e+01 cost=5.748e+03 flops=2.425e+07
 sigma counter=62 i=6 t=2.470e-04 per=1.298e+01 cost=2.674e+03 flops=1.083e+07
 sigma counter=62 i=7 t=2.380e-04 per=1.251e+01 cost=2.524e+03 flops=1.061e+07
 total GEMM cost=2.477e+04 flops=1.302e+07
--- TIMING FOR sigma_tot : t_inter=1.298e-02 t_gemm=1.190e-01 t_reduction=1.222e-02 tot=1.442e-01 ---
 sigma_tot counter=62 i=0 t=1.481e-02 per=1.244e+01 cost=1.278e+05 flops=8.634e+06
 sigma_tot counter=62 i=1 t=1.499e-02 per=1.259e+01 cost=1.331e+05 flops=8.884e+06
 sigma_tot counter=62 i=2 t=1.468e-02 per=1.233e+01 cost=1.445e+05 flops=9.844e+06
 sigma_tot counter=62 i=3 t=1.458e-02 per=1.225e+01 cost=1.502e+05 flops=1.030e+07
 sigma_tot counter=62 i=4 t=1.484e-02 per=1.247e+01 cost=2.724e+05 flops=1.835e+07
 sigma_tot counter=62 i=5 t=1.488e-02 per=1.250e+01 cost=2.736e+05 flops=1.839e+07
 sigma_tot counter=62 i=6 t=1.534e-02 per=1.289e+01 cost=3.019e+05 flops=1.968e+07
 sigma_tot counter=62 i=7 t=1.491e-02 per=1.253e+01 cost=2.980e+05 flops=1.999e+07
 total GEMM cost=1.702e+06 flops=1.430e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.010e-04,1.868e-03,1.950e-04 cost=2.477e+04 flops[gemm]=1.326e+07
--- TIMING FOR sigma : t_inter=2.010e-04 t_gemm=1.866e-03 t_reduction=1.950e-04 tot=2.262e-03 ---
 sigma counter=63 i=0 t=2.360e-04 per=1.265e+01 cost=2.136e+03 flops=9.051e+06
 sigma counter=63 i=1 t=2.360e-04 per=1.265e+01 cost=2.354e+03 flops=9.975e+06
 sigma counter=63 i=2 t=2.380e-04 per=1.275e+01 cost=1.704e+03 flops=7.160e+06
 sigma counter=63 i=3 t=2.240e-04 per=1.200e+01 cost=1.886e+03 flops=8.420e+06
 sigma counter=63 i=4 t=2.350e-04 per=1.259e+01 cost=5.748e+03 flops=2.446e+07
 sigma counter=63 i=5 t=2.280e-04 per=1.222e+01 cost=5.748e+03 flops=2.521e+07
 sigma counter=63 i=6 t=2.370e-04 per=1.270e+01 cost=2.674e+03 flops=1.128e+07
 sigma counter=63 i=7 t=2.320e-04 per=1.243e+01 cost=2.524e+03 flops=1.088e+07
 total GEMM cost=2.477e+04 flops=1.328e+07
--- TIMING FOR sigma_tot : t_inter=1.318e-02 t_gemm=1.209e-01 t_reduction=1.241e-02 tot=1.465e-01 ---
 sigma_tot counter=63 i=0 t=1.504e-02 per=1.244e+01 cost=1.300e+05 flops=8.641e+06
 sigma_tot counter=63 i=1 t=1.522e-02 per=1.259e+01 cost=1.355e+05 flops=8.901e+06
 sigma_tot counter=63 i=2 t=1.492e-02 per=1.234e+01 cost=1.462e+05 flops=9.801e+06
 sigma_tot counter=63 i=3 t=1.481e-02 per=1.225e+01 cost=1.520e+05 flops=1.027e+07
 sigma_tot counter=63 i=4 t=1.508e-02 per=1.247e+01 cost=2.781e+05 flops=1.845e+07
 sigma_tot counter=63 i=5 t=1.510e-02 per=1.249e+01 cost=2.794e+05 flops=1.850e+07
 sigma_tot counter=63 i=6 t=1.558e-02 per=1.288e+01 cost=3.046e+05 flops=1.956e+07
 sigma_tot counter=63 i=7 t=1.514e-02 per=1.252e+01 cost=3.005e+05 flops=1.985e+07
 total GEMM cost=1.726e+06 flops=1.428e+07
    6   0 -      -2.652081027011 -7.284e-07  3.123e-04    6    12  2.992e-02 2.494e-03
    6   1 -      -2.430689426190 -2.674e-06  7.424e-04    6    12  2.992e-02 2.494e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.080e-04,1.856e-03,1.980e-04 cost=2.477e+04 flops[gemm]=1.335e+07
--- TIMING FOR sigma : t_inter=2.080e-04 t_gemm=1.856e-03 t_reduction=1.980e-04 tot=2.262e-03 ---
 sigma counter=64 i=0 t=2.370e-04 per=1.277e+01 cost=2.136e+03 flops=9.013e+06
 sigma counter=64 i=1 t=2.360e-04 per=1.272e+01 cost=2.354e+03 flops=9.975e+06
 sigma counter=64 i=2 t=2.250e-04 per=1.212e+01 cost=1.704e+03 flops=7.573e+06
 sigma counter=64 i=3 t=2.270e-04 per=1.223e+01 cost=1.886e+03 flops=8.308e+06
 sigma counter=64 i=4 t=2.300e-04 per=1.239e+01 cost=5.748e+03 flops=2.499e+07
 sigma counter=64 i=5 t=2.320e-04 per=1.250e+01 cost=5.748e+03 flops=2.478e+07
 sigma counter=64 i=6 t=2.360e-04 per=1.272e+01 cost=2.674e+03 flops=1.133e+07
 sigma counter=64 i=7 t=2.330e-04 per=1.255e+01 cost=2.524e+03 flops=1.083e+07
 total GEMM cost=2.477e+04 flops=1.335e+07
--- TIMING FOR sigma_tot : t_inter=1.339e-02 t_gemm=1.227e-01 t_reduction=1.261e-02 tot=1.487e-01 ---
 sigma_tot counter=64 i=0 t=1.528e-02 per=1.245e+01 cost=1.321e+05 flops=8.647e+06
 sigma_tot counter=64 i=1 t=1.546e-02 per=1.259e+01 cost=1.378e+05 flops=8.917e+06
 sigma_tot counter=64 i=2 t=1.514e-02 per=1.234e+01 cost=1.479e+05 flops=9.768e+06
 sigma_tot counter=64 i=3 t=1.503e-02 per=1.225e+01 cost=1.539e+05 flops=1.024e+07
 sigma_tot counter=64 i=4 t=1.531e-02 per=1.247e+01 cost=2.839e+05 flops=1.854e+07
 sigma_tot counter=64 i=5 t=1.534e-02 per=1.249e+01 cost=2.851e+05 flops=1.859e+07
 sigma_tot counter=64 i=6 t=1.581e-02 per=1.288e+01 cost=3.073e+05 flops=1.943e+07
 sigma_tot counter=64 i=7 t=1.537e-02 per=1.252e+01 cost=3.030e+05 flops=1.971e+07
 total GEMM cost=1.751e+06 flops=1.427e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.000e-04,1.865e-03,1.950e-04 cost=2.477e+04 flops[gemm]=1.328e+07
--- TIMING FOR sigma : t_inter=1.990e-04 t_gemm=1.865e-03 t_reduction=1.950e-04 tot=2.259e-03 ---
 sigma counter=65 i=0 t=2.360e-04 per=1.265e+01 cost=2.136e+03 flops=9.051e+06
 sigma counter=65 i=1 t=2.450e-04 per=1.314e+01 cost=2.354e+03 flops=9.608e+06
 sigma counter=65 i=2 t=2.250e-04 per=1.206e+01 cost=1.704e+03 flops=7.573e+06
 sigma counter=65 i=3 t=2.270e-04 per=1.217e+01 cost=1.886e+03 flops=8.308e+06
 sigma counter=65 i=4 t=2.290e-04 per=1.228e+01 cost=5.748e+03 flops=2.510e+07
 sigma counter=65 i=5 t=2.350e-04 per=1.260e+01 cost=5.748e+03 flops=2.446e+07
 sigma counter=65 i=6 t=2.370e-04 per=1.271e+01 cost=2.674e+03 flops=1.128e+07
 sigma counter=65 i=7 t=2.310e-04 per=1.239e+01 cost=2.524e+03 flops=1.093e+07
 total GEMM cost=2.477e+04 flops=1.328e+07
--- TIMING FOR sigma_tot : t_inter=1.359e-02 t_gemm=1.246e-01 t_reduction=1.281e-02 tot=1.510e-01 ---
 sigma_tot counter=65 i=0 t=1.552e-02 per=1.245e+01 cost=1.342e+05 flops=8.653e+06
 sigma_tot counter=65 i=1 t=1.570e-02 per=1.260e+01 cost=1.402e+05 flops=8.928e+06
 sigma_tot counter=65 i=2 t=1.537e-02 per=1.233e+01 cost=1.496e+05 flops=9.736e+06
 sigma_tot counter=65 i=3 t=1.526e-02 per=1.225e+01 cost=1.558e+05 flops=1.021e+07
 sigma_tot counter=65 i=4 t=1.554e-02 per=1.247e+01 cost=2.896e+05 flops=1.864e+07
 sigma_tot counter=65 i=5 t=1.557e-02 per=1.250e+01 cost=2.909e+05 flops=1.868e+07
 sigma_tot counter=65 i=6 t=1.605e-02 per=1.288e+01 cost=3.099e+05 flops=1.931e+07
 sigma_tot counter=65 i=7 t=1.560e-02 per=1.252e+01 cost=3.055e+05 flops=1.958e+07
 total GEMM cost=1.776e+06 flops=1.425e+07
    7   0 +      -2.652081087251 -6.024e-08  8.248e-05    6    14  3.486e-02 2.490e-03
    7   1 -      -2.430689830982 -4.048e-07  2.504e-04    6    14  3.486e-02 2.490e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.080e-04,1.875e-03,1.960e-04 cost=2.477e+04 flops[gemm]=1.321e+07
--- TIMING FOR sigma : t_inter=2.080e-04 t_gemm=1.875e-03 t_reduction=1.960e-04 tot=2.279e-03 ---
 sigma counter=66 i=0 t=2.400e-04 per=1.280e+01 cost=2.136e+03 flops=8.900e+06
 sigma counter=66 i=1 t=2.450e-04 per=1.307e+01 cost=2.354e+03 flops=9.608e+06
 sigma counter=66 i=2 t=2.240e-04 per=1.195e+01 cost=1.704e+03 flops=7.607e+06
 sigma counter=66 i=3 t=2.300e-04 per=1.227e+01 cost=1.886e+03 flops=8.200e+06
 sigma counter=66 i=4 t=2.310e-04 per=1.232e+01 cost=5.748e+03 flops=2.488e+07
 sigma counter=66 i=5 t=2.310e-04 per=1.232e+01 cost=5.748e+03 flops=2.488e+07
 sigma counter=66 i=6 t=2.390e-04 per=1.275e+01 cost=2.674e+03 flops=1.119e+07
 sigma counter=66 i=7 t=2.350e-04 per=1.253e+01 cost=2.524e+03 flops=1.074e+07
 total GEMM cost=2.477e+04 flops=1.321e+07
--- TIMING FOR sigma_tot : t_inter=1.380e-02 t_gemm=1.265e-01 t_reduction=1.300e-02 tot=1.533e-01 ---
 sigma_tot counter=66 i=0 t=1.576e-02 per=1.246e+01 cost=1.364e+05 flops=8.657e+06
 sigma_tot counter=66 i=1 t=1.595e-02 per=1.261e+01 cost=1.426e+05 flops=8.938e+06
 sigma_tot counter=66 i=2 t=1.559e-02 per=1.233e+01 cost=1.513e+05 flops=9.705e+06
 sigma_tot counter=66 i=3 t=1.549e-02 per=1.225e+01 cost=1.577e+05 flops=1.018e+07
 sigma_tot counter=66 i=4 t=1.577e-02 per=1.247e+01 cost=2.954e+05 flops=1.873e+07
 sigma_tot counter=66 i=5 t=1.580e-02 per=1.249e+01 cost=2.966e+05 flops=1.877e+07
 sigma_tot counter=66 i=6 t=1.629e-02 per=1.288e+01 cost=3.126e+05 flops=1.919e+07
 sigma_tot counter=66 i=7 t=1.584e-02 per=1.252e+01 cost=3.081e+05 flops=1.945e+07
 total GEMM cost=1.801e+06 flops=1.424e+07
    8   0 +      -2.652081087251  1.776e-15  8.248e-05    5    15  3.737e-02 2.491e-03
    8   1 +      -2.430689876389 -4.541e-08  6.799e-05    5    15  3.737e-02 2.491e-03
TIMING FOR Davidson : 3.740e-02  T(cal/comm/rest)=3.675e-02,4.795e-05,5.996e-04
optimized energies: isweep=1 dots=2 ibond=0 e[0]=-2.65208108725 nmvp=15
optimized energies: isweep=1 dots=2 ibond=0 e[1]=-2.43068987639 nmvp=15
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=9 alg_decim=1 mpisize=2 maxthreads=2
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
TIMING FOR decimation: 2.9e-04 S T(wf/decim)=2.3e-04,6.3e-05
ctns::oper_renorm coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=852:6.5e-03MB:6.3e-06GB
rank=0 GPUmem(GB): used=1.4e-05 (oper)=8.5e-06
rank=0 GPUmem(GB): used=1.4e-05 (oper,site)(GB)=8.5e-06,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 5.827e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=1.38e-05 (oper,site,rinter)=8.52e-06,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00101 S size(rtasks)=37 size(Rlst2)=9 T(Rmu/Rlist)=0.0002,0.000806 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00109 S size(rtasks)=37 size(Rlst)=860 -----
rank=0 GPUmem(GB): used=0.000225 (oper,site,rinter,batch)=8.52e-06,2.68e-07,0,0.000211 blksize=16 blksize0=0 batchsize=860
timing: allocate=3.6e-05 rmmtasks init=0.00104 total=0.00108
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=6e-06,0.00118,0.000211 cost=1.69e+04 flops[gemm]=1.43e+07
--- TIMING FOR renorm : t_inter=5e-06 t_gemm=0.00118 t_reduction=0.000211 tot=0.00139 ---
 renorm counter=5 i=0 t=0.000247 per=21 cost=1.3e+03 flops=5.27e+06
 renorm counter=5 i=1 t=0.000228 per=19.4 cost=1.64e+03 flops=7.18e+06
 renorm counter=5 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=5 i=3 t=1e-06 per=0.085 cost=0 flops=0
 renorm counter=5 i=4 t=0.000224 per=19 cost=1.19e+03 flops=5.33e+06
 renorm counter=5 i=5 t=0.000226 per=19.2 cost=1.85e+03 flops=8.2e+06
 renorm counter=5 i=6 t=0.00025 per=21.3 cost=1.09e+04 flops=4.35e+07
 total GEMM cost=1.69e+04 flops=1.43e+07
--- TIMING FOR renorm_tot : t_inter=0.00043 t_gemm=0.00568 t_reduction=0.000991 tot=0.0071 ---
 renorm_tot counter=5 i=0 t=0.00117 per=20.6 cost=5.27e+03 flops=4.5e+06
 renorm_tot counter=5 i=1 t=0.00112 per=19.7 cost=7.74e+03 flops=6.91e+06
 renorm_tot counter=5 i=2 t=0.000436 per=7.68 cost=3.37e+03 flops=7.72e+06
 renorm_tot counter=5 i=3 t=0.000437 per=7.69 cost=6e+03 flops=1.37e+07
 renorm_tot counter=5 i=4 t=0.000661 per=11.6 cost=4.74e+03 flops=7.18e+06
 renorm_tot counter=5 i=5 t=0.000669 per=11.8 cost=8.23e+03 flops=1.23e+07
 renorm_tot counter=5 i=6 t=0.00119 per=20.9 cost=5.11e+04 flops=4.3e+07
 total GEMM cost=8.64e+04 flops=1.52e+07
timing: gpu2cpu=1.54e-05 deallocate(site/work)=4.6e-06,7.22e-06 total=2.26e-05
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.00494 S T(init/kernel/comm)=0.000438,0.00443,6.43e-05 rank=0 -----
TIMING FOR cleanup: 0.000351 T(erase/save/remove)=9.18e-05,0.000224,3.49e-05
##### local: 5.068e-02 S #####
 T(local: fetch) = 1.495e-04 S  per = 0.295  per(accum) = 0.295
 T(local: hdiag) = 4.936e-04 S  per = 0.974  per(accum) = 1.27
 T(local: dvdsn) = 4.382e-02 S  per = 86.5  per(accum) = 87.7
 T(local: decim) = 3.862e-04 S  per = 0.762  per(accum) = 88.5
 T(local: guess) = 3.801e-04 S  per = 0.75  per(accum) = 89.2
 T(local: renrm) = 5.084e-03 S  per =   10  per(accum) = 99.3
 T(local: save ) = 3.648e-04 S  per = 0.72  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.305e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 9.679e-06 S  per = 0.0225  per(accum) = 0.0225
 T(local: symbolic_formulae_twodot     ) = 7.211e-04 S  per = 1.68  per(accum) = 1.7
 T(local: hintermediate init           ) = 6.336e-05 S  per = 0.147  per(accum) = 1.84
 T(local: hintermediates memcpy cpu2gpu) = 3.100e-08 S  per = 7.2e-05  per(accum) = 1.84
 T(local: preprocess_hformulae_Hxlist2 ) = 2.610e-03 S  per = 6.06  per(accum) = 7.91
 T(local: hmmtasks init                ) = 2.242e-03 S  per = 5.21  per(accum) = 13.1
 T(local: dvdson solver [Hx_batchGPU]  ) = 3.675e-02 S  per = 85.4  per(accum) = 98.5
 T(local: dvdson solver [communication]) = 4.795e-05 S  per = 0.111  per(accum) = 98.6
 T(local: dvdson solver [rest part]    ) = 5.996e-04 S  per = 1.39  per(accum) = 100
Detailed decomposition of T(renrm): 4.935e-03 S
 T(local: qops init                    ) = 4.375e-04 S  per = 8.87  per(accum) = 8.87
 T(local: qops_dict memcpy cpu2gpu     ) = 4.122e-05 S  per = 0.835  per(accum) = 9.7
 T(local: symbolic_formulae_renorm     ) = 5.917e-04 S  per =   12  per(accum) = 21.7
 T(local: rintermediate init           ) = 2.827e-05 S  per = 0.573  per(accum) = 22.3
 T(local: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000567  per(accum) = 22.3
 T(local: preprocess_formulae_Rlist2   ) = 1.115e-03 S  per = 22.6  per(accum) = 44.9
 T(local: rmmtasks init                ) = 1.090e-03 S  per = 22.1  per(accum) = 66.9
 T(local: qops memset                  ) = 2.800e-08 S  per = 0.000567  per(accum) = 66.9
 T(local: preprocess_renorm_batchGPU   ) = 1.510e-03 S  per = 30.6  per(accum) = 97.5
 T(local: qops memcpy gpu2cpu          ) = 1.542e-05 S  per = 0.313  per(accum) = 97.8
 T(local: deallocate gpu memory        ) = 4.226e-05 S  per = 0.856  per(accum) = 98.7
 T(local: communication of opS and opH ) = 6.432e-05 S  per =  1.3  per(accum) = 100
##### sweep: 5.068e-02 S #####
 T(sweep: fetch) = 1.495e-04 S  per = 0.295  per(accum) = 0.295
 T(sweep: hdiag) = 4.936e-04 S  per = 0.974  per(accum) = 1.27
 T(sweep: dvdsn) = 4.382e-02 S  per = 86.5  per(accum) = 87.7
 T(sweep: decim) = 3.862e-04 S  per = 0.762  per(accum) = 88.5
 T(sweep: guess) = 3.801e-04 S  per = 0.75  per(accum) = 89.2
 T(sweep: renrm) = 5.084e-03 S  per =   10  per(accum) = 99.3
 T(sweep: save ) = 3.648e-04 S  per = 0.72  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.305e-02 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 9.679e-06 S  per = 0.0225  per(accum) = 0.0225
 T(sweep: symbolic_formulae_twodot     ) = 7.211e-04 S  per = 1.68  per(accum) = 1.7
 T(sweep: hintermediate init           ) = 6.336e-05 S  per = 0.147  per(accum) = 1.84
 T(sweep: hintermediates memcpy cpu2gpu) = 3.100e-08 S  per = 7.2e-05  per(accum) = 1.84
 T(sweep: preprocess_hformulae_Hxlist2 ) = 2.610e-03 S  per = 6.06  per(accum) = 7.91
 T(sweep: hmmtasks init                ) = 2.242e-03 S  per = 5.21  per(accum) = 13.1
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 3.675e-02 S  per = 85.4  per(accum) = 98.5
 T(sweep: dvdson solver [communication]) = 4.795e-05 S  per = 0.111  per(accum) = 98.6
 T(sweep: dvdson solver [rest part]    ) = 5.996e-04 S  per = 1.39  per(accum) = 100
Detailed decomposition of T(renrm): 4.935e-03 S
 T(sweep: qops init                    ) = 4.375e-04 S  per = 8.87  per(accum) = 8.87
 T(sweep: qops_dict memcpy cpu2gpu     ) = 4.122e-05 S  per = 0.835  per(accum) = 9.7
 T(sweep: symbolic_formulae_renorm     ) = 5.917e-04 S  per =   12  per(accum) = 21.7
 T(sweep: rintermediate init           ) = 2.827e-05 S  per = 0.573  per(accum) = 22.3
 T(sweep: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000567  per(accum) = 22.3
 T(sweep: preprocess_formulae_Rlist2   ) = 1.115e-03 S  per = 22.6  per(accum) = 44.9
 T(sweep: rmmtasks init                ) = 1.090e-03 S  per = 22.1  per(accum) = 66.9
 T(sweep: qops memset                  ) = 2.800e-08 S  per = 0.000567  per(accum) = 66.9
 T(sweep: preprocess_renorm_batchGPU   ) = 1.510e-03 S  per = 30.6  per(accum) = 97.5
 T(sweep: qops memcpy gpu2cpu          ) = 1.542e-05 S  per = 0.313  per(accum) = 97.8
 T(sweep: deallocate gpu memory        ) = 4.226e-05 S  per = 0.856  per(accum) = 98.7
 T(sweep: communication of opS and opH ) = 6.432e-05 S  per =  1.3  per(accum) = 100
##### global: 2.421e-01 S #####
 T(global: fetch) = 4.279e-03 S  per = 1.77  per(accum) = 1.77
 T(global: hdiag) = 3.043e-03 S  per = 1.26  per(accum) = 3.02
 T(global: dvdsn) = 2.054e-01 S  per = 84.9  per(accum) = 87.9
 T(global: decim) = 4.640e-03 S  per = 1.92  per(accum) = 89.8
 T(global: guess) = 1.856e-03 S  per = 0.767  per(accum) = 90.6
 T(global: renrm) = 2.138e-02 S  per = 8.83  per(accum) = 99.4
 T(global: save ) = 1.450e-03 S  per = 0.599  per(accum) = 100
Detailed decomposition of T(dvdsn): 2.011e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 5.629e-05 S  per = 0.028  per(accum) = 0.028
 T(global: symbolic_formulae_twodot     ) = 3.338e-03 S  per = 1.66  per(accum) = 1.69
 T(global: hintermediate init           ) = 2.910e-04 S  per = 0.145  per(accum) = 1.83
 T(global: hintermediates memcpy cpu2gpu) = 1.450e-07 S  per = 7.21e-05  per(accum) = 1.83
 T(global: preprocess_hformulae_Hxlist2 ) = 1.480e-02 S  per = 7.36  per(accum) = 9.19
 T(global: hmmtasks init                ) = 1.433e-02 S  per = 7.12  per(accum) = 16.3
 T(global: dvdson solver [Hx_batchGPU]  ) = 1.652e-01 S  per = 82.2  per(accum) = 98.5
 T(global: dvdson solver [communication]) = 2.306e-04 S  per = 0.115  per(accum) = 98.6
 T(global: dvdson solver [rest part]    ) = 2.843e-03 S  per = 1.41  per(accum) = 100
Detailed decomposition of T(renrm): 2.075e-02 S
 T(global: qops init                    ) = 1.558e-03 S  per = 7.51  per(accum) = 7.51
 T(global: qops_dict memcpy cpu2gpu     ) = 2.070e-04 S  per = 0.998  per(accum) = 8.51
 T(global: symbolic_formulae_renorm     ) = 2.769e-03 S  per = 13.3  per(accum) = 21.9
 T(global: rintermediate init           ) = 2.131e-04 S  per = 1.03  per(accum) = 22.9
 T(global: rintermediates memcpy cpu2gpu) = 1.420e-07 S  per = 0.000684  per(accum) = 22.9
 T(global: preprocess_formulae_Rlist2   ) = 4.070e-03 S  per = 19.6  per(accum) = 42.5
 T(global: rmmtasks init                ) = 3.661e-03 S  per = 17.6  per(accum) = 60.1
 T(global: qops memset                  ) = 1.380e-07 S  per = 0.000665  per(accum) = 60.1
 T(global: preprocess_renorm_batchGPU   ) = 7.695e-03 S  per = 37.1  per(accum) = 97.2
 T(global: qops memcpy gpu2cpu          ) = 7.320e-05 S  per = 0.353  per(accum) = 97.6
 T(global: deallocate gpu memory        ) = 1.949e-04 S  per = 0.94  per(accum) = 98.5
 T(global: communication of opS and opH ) = 3.043e-04 S  per = 1.47  per(accum) = 100

isweep=1 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=852:0.0065MB:6.35e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1290:0.00984MB:9.61e-06GB
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44e23e10
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
### DIAG TIMING: total=0.000364 t1=9.59e-06, t2=1.26e-05, t3=4.81e-05, t4=0.000125, t5=0.000127, t6=2.69e-05, t7=1.24e-05, t8=3.58e-06
duration_diagGPU:0.000378
duration_diagreduce:4.26e-06
duration_diagtransform:1.8e-06
rank=0 GPUmem(GB): used=9.61e-06 (oper)=9.61e-06
----- TIMING FOR symbolic_formulae_twodot with size=95 : 6.461e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=95
 no. of hintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.448e-05 S -----
rank=0 GPUmem(GB): used=9.94e-06 (oper,hinter)=9.61e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00331 S size(H_formulae)=95 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000187,0.00312 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00356 S size(H_formulae)=95 size(Hxlst)=2974 -----
rank=0 GPUmem(GB): used=0.000388 (oper,hinter,dvdson,batch)=9.61e-06,3.28e-07,1.49e-06,0.000377 blksize=4 blksize0=8 batchsize=2974
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.3e-05,0.000222,0.002,0.000198 cost=4.12e+04 flops[gemm]=2.06e+07
--- TIMING FOR sigma : t_inter=0.000222 t_gemm=0.002 t_reduction=0.000198 tot=0.00242 ---
 sigma counter=67 i=0 t=0.000244 per=12.2 cost=2.58e+03 flops=1.06e+07
 sigma counter=67 i=1 t=0.000241 per=12 cost=2.57e+03 flops=1.07e+07
 sigma counter=67 i=2 t=0.000248 per=12.4 cost=3.75e+03 flops=1.51e+07
 sigma counter=67 i=3 t=0.000246 per=12.3 cost=3.77e+03 flops=1.53e+07
 sigma counter=67 i=4 t=0.00025 per=12.5 cost=4.11e+03 flops=1.64e+07
 sigma counter=67 i=5 t=0.000251 per=12.5 cost=4.13e+03 flops=1.65e+07
 sigma counter=67 i=6 t=0.000266 per=13.3 cost=1.01e+04 flops=3.81e+07
 sigma counter=67 i=7 t=0.000256 per=12.8 cost=1.01e+04 flops=3.96e+07
 total GEMM cost=4.12e+04 flops=2.06e+07
--- TIMING FOR sigma_tot : t_inter=0.014 t_gemm=0.128 t_reduction=0.0132 tot=0.156 ---
 sigma_tot counter=67 i=0 t=0.016 per=12.5 cost=1.39e+05 flops=8.69e+06
 sigma_tot counter=67 i=1 t=0.0162 per=12.6 cost=1.45e+05 flops=8.96e+06
 sigma_tot counter=67 i=2 t=0.0158 per=12.3 cost=1.55e+05 flops=9.79e+06
 sigma_tot counter=67 i=3 t=0.0157 per=12.2 cost=1.61e+05 flops=1.03e+07
 sigma_tot counter=67 i=4 t=0.016 per=12.5 cost=3e+05 flops=1.87e+07
 sigma_tot counter=67 i=5 t=0.0161 per=12.5 cost=3.01e+05 flops=1.87e+07
 sigma_tot counter=67 i=6 t=0.0166 per=12.9 cost=3.23e+05 flops=1.95e+07
 sigma_tot counter=67 i=7 t=0.0161 per=12.5 cost=3.18e+05 flops=1.98e+07
 total GEMM cost=1.84e+06 flops=1.43e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.1e-05,0.000218,0.002,0.000197 cost=4.12e+04 flops[gemm]=2.06e+07
--- TIMING FOR sigma : t_inter=0.000218 t_gemm=0.002 t_reduction=0.000197 tot=0.00242 ---
 sigma counter=68 i=0 t=0.000243 per=12.2 cost=2.58e+03 flops=1.06e+07
 sigma counter=68 i=1 t=0.00025 per=12.5 cost=2.57e+03 flops=1.03e+07
 sigma counter=68 i=2 t=0.000247 per=12.3 cost=3.75e+03 flops=1.52e+07
 sigma counter=68 i=3 t=0.000246 per=12.3 cost=3.77e+03 flops=1.53e+07
 sigma counter=68 i=4 t=0.000247 per=12.3 cost=4.11e+03 flops=1.66e+07
 sigma counter=68 i=5 t=0.000251 per=12.5 cost=4.13e+03 flops=1.65e+07
 sigma counter=68 i=6 t=0.000262 per=13.1 cost=1.01e+04 flops=3.87e+07
 sigma counter=68 i=7 t=0.000254 per=12.7 cost=1.01e+04 flops=3.99e+07
 total GEMM cost=4.12e+04 flops=2.06e+07
--- TIMING FOR sigma_tot : t_inter=0.0142 t_gemm=0.13 t_reduction=0.0134 tot=0.158 ---
 sigma_tot counter=68 i=0 t=0.0162 per=12.4 cost=1.42e+05 flops=8.71e+06
 sigma_tot counter=68 i=1 t=0.0164 per=12.6 cost=1.48e+05 flops=8.98e+06
 sigma_tot counter=68 i=2 t=0.0161 per=12.3 cost=1.59e+05 flops=9.87e+06
 sigma_tot counter=68 i=3 t=0.016 per=12.2 cost=1.65e+05 flops=1.03e+07
 sigma_tot counter=68 i=4 t=0.0163 per=12.5 cost=3.04e+05 flops=1.87e+07
 sigma_tot counter=68 i=5 t=0.0163 per=12.5 cost=3.05e+05 flops=1.87e+07
 sigma_tot counter=68 i=6 t=0.0168 per=12.9 cost=3.33e+05 flops=1.98e+07
 sigma_tot counter=68 i=7 t=0.0163 per=12.5 cost=3.28e+05 flops=2.01e+07
 total GEMM cost=1.88e+06 flops=1.44e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652081087251 -1.003e+03  7.605e-02    2     2  5.322e-03 2.661e-03
    1   1 -      -2.430689876389 -1.002e+03  1.158e-01    2     2  5.322e-03 2.661e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.160e-04,2.000e-03,1.970e-04 cost=4.121e+04 flops[gemm]=2.061e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=2.000e-03 t_reduction=1.970e-04 tot=2.413e-03 ---
 sigma counter=69 i=0 t=2.390e-04 per=1.195e+01 cost=2.582e+03 flops=1.080e+07
 sigma counter=69 i=1 t=2.560e-04 per=1.280e+01 cost=2.572e+03 flops=1.005e+07
 sigma counter=69 i=2 t=2.460e-04 per=1.230e+01 cost=3.754e+03 flops=1.526e+07
 sigma counter=69 i=3 t=2.440e-04 per=1.220e+01 cost=3.774e+03 flops=1.547e+07
 sigma counter=69 i=4 t=2.500e-04 per=1.250e+01 cost=4.112e+03 flops=1.645e+07
 sigma counter=69 i=5 t=2.510e-04 per=1.255e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=69 i=6 t=2.610e-04 per=1.305e+01 cost=1.014e+04 flops=3.887e+07
 sigma counter=69 i=7 t=2.530e-04 per=1.265e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.061e+07
--- TIMING FOR sigma_tot : t_inter=1.445e-02 t_gemm=1.325e-01 t_reduction=1.359e-02 tot=1.605e-01 ---
 sigma_tot counter=69 i=0 t=1.648e-02 per=1.244e+01 cost=1.441e+05 flops=8.745e+06
 sigma_tot counter=69 i=1 t=1.670e-02 per=1.260e+01 cost=1.503e+05 flops=9.000e+06
 sigma_tot counter=69 i=2 t=1.633e-02 per=1.233e+01 cost=1.626e+05 flops=9.954e+06
 sigma_tot counter=69 i=3 t=1.623e-02 per=1.225e+01 cost=1.690e+05 flops=1.042e+07
 sigma_tot counter=69 i=4 t=1.652e-02 per=1.247e+01 cost=3.077e+05 flops=1.863e+07
 sigma_tot counter=69 i=5 t=1.655e-02 per=1.250e+01 cost=3.090e+05 flops=1.867e+07
 sigma_tot counter=69 i=6 t=1.708e-02 per=1.289e+01 cost=3.430e+05 flops=2.009e+07
 sigma_tot counter=69 i=7 t=1.660e-02 per=1.253e+01 cost=3.385e+05 flops=2.039e+07
 total GEMM cost=1.924e+06 flops=1.452e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.140e-04,1.991e-03,1.950e-04 cost=4.121e+04 flops[gemm]=2.070e+07
--- TIMING FOR sigma : t_inter=2.140e-04 t_gemm=1.989e-03 t_reduction=1.950e-04 tot=2.398e-03 ---
 sigma counter=70 i=0 t=2.400e-04 per=1.207e+01 cost=2.582e+03 flops=1.076e+07
 sigma counter=70 i=1 t=2.440e-04 per=1.227e+01 cost=2.572e+03 flops=1.054e+07
 sigma counter=70 i=2 t=2.440e-04 per=1.227e+01 cost=3.754e+03 flops=1.539e+07
 sigma counter=70 i=3 t=2.460e-04 per=1.237e+01 cost=3.774e+03 flops=1.534e+07
 sigma counter=70 i=4 t=2.480e-04 per=1.247e+01 cost=4.112e+03 flops=1.658e+07
 sigma counter=70 i=5 t=2.510e-04 per=1.262e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=70 i=6 t=2.620e-04 per=1.317e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=70 i=7 t=2.540e-04 per=1.277e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.072e+07
--- TIMING FOR sigma_tot : t_inter=1.467e-02 t_gemm=1.345e-01 t_reduction=1.379e-02 tot=1.629e-01 ---
 sigma_tot counter=70 i=0 t=1.672e-02 per=1.243e+01 cost=1.467e+05 flops=8.774e+06
 sigma_tot counter=70 i=1 t=1.694e-02 per=1.260e+01 cost=1.528e+05 flops=9.023e+06
 sigma_tot counter=70 i=2 t=1.658e-02 per=1.233e+01 cost=1.663e+05 flops=1.003e+07
 sigma_tot counter=70 i=3 t=1.647e-02 per=1.225e+01 cost=1.728e+05 flops=1.049e+07
 sigma_tot counter=70 i=4 t=1.676e-02 per=1.247e+01 cost=3.118e+05 flops=1.860e+07
 sigma_tot counter=70 i=5 t=1.681e-02 per=1.250e+01 cost=3.131e+05 flops=1.863e+07
 sigma_tot counter=70 i=6 t=1.734e-02 per=1.289e+01 cost=3.532e+05 flops=2.037e+07
 sigma_tot counter=70 i=7 t=1.686e-02 per=1.253e+01 cost=3.486e+05 flops=2.068e+07
 total GEMM cost=1.965e+06 flops=1.462e+07
    2   0 -      -2.654436755680 -2.356e-03  1.096e-02    4     4  1.059e-02 2.647e-03
    2   1 -      -2.436722360481 -6.032e-03  1.828e-02    4     4  1.059e-02 2.647e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.170e-04,1.990e-03,1.990e-04 cost=4.121e+04 flops[gemm]=2.071e+07
--- TIMING FOR sigma : t_inter=2.170e-04 t_gemm=1.990e-03 t_reduction=1.980e-04 tot=2.405e-03 ---
 sigma counter=71 i=0 t=2.420e-04 per=1.216e+01 cost=2.582e+03 flops=1.067e+07
 sigma counter=71 i=1 t=2.450e-04 per=1.231e+01 cost=2.572e+03 flops=1.050e+07
 sigma counter=71 i=2 t=2.440e-04 per=1.226e+01 cost=3.754e+03 flops=1.539e+07
 sigma counter=71 i=3 t=2.440e-04 per=1.226e+01 cost=3.774e+03 flops=1.547e+07
 sigma counter=71 i=4 t=2.490e-04 per=1.251e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=71 i=5 t=2.520e-04 per=1.266e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=71 i=6 t=2.610e-04 per=1.312e+01 cost=1.014e+04 flops=3.887e+07
 sigma counter=71 i=7 t=2.530e-04 per=1.271e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.071e+07
--- TIMING FOR sigma_tot : t_inter=1.489e-02 t_gemm=1.365e-01 t_reduction=1.399e-02 tot=1.653e-01 ---
 sigma_tot counter=71 i=0 t=1.696e-02 per=1.243e+01 cost=1.493e+05 flops=8.801e+06
 sigma_tot counter=71 i=1 t=1.718e-02 per=1.259e+01 cost=1.554e+05 flops=9.044e+06
 sigma_tot counter=71 i=2 t=1.682e-02 per=1.232e+01 cost=1.701e+05 flops=1.011e+07
 sigma_tot counter=71 i=3 t=1.672e-02 per=1.225e+01 cost=1.766e+05 flops=1.056e+07
 sigma_tot counter=71 i=4 t=1.701e-02 per=1.247e+01 cost=3.160e+05 flops=1.857e+07
 sigma_tot counter=71 i=5 t=1.706e-02 per=1.250e+01 cost=3.173e+05 flops=1.860e+07
 sigma_tot counter=71 i=6 t=1.760e-02 per=1.290e+01 cost=3.633e+05 flops=2.064e+07
 sigma_tot counter=71 i=7 t=1.711e-02 per=1.254e+01 cost=3.588e+05 flops=2.097e+07
 total GEMM cost=2.007e+06 flops=1.471e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.090e-04,1.996e-03,1.950e-04 cost=4.121e+04 flops[gemm]=2.065e+07
--- TIMING FOR sigma : t_inter=2.090e-04 t_gemm=1.996e-03 t_reduction=1.950e-04 tot=2.400e-03 ---
 sigma counter=72 i=0 t=2.390e-04 per=1.197e+01 cost=2.582e+03 flops=1.080e+07
 sigma counter=72 i=1 t=2.480e-04 per=1.242e+01 cost=2.572e+03 flops=1.037e+07
 sigma counter=72 i=2 t=2.460e-04 per=1.232e+01 cost=3.754e+03 flops=1.526e+07
 sigma counter=72 i=3 t=2.450e-04 per=1.227e+01 cost=3.774e+03 flops=1.540e+07
 sigma counter=72 i=4 t=2.510e-04 per=1.258e+01 cost=4.112e+03 flops=1.638e+07
 sigma counter=72 i=5 t=2.510e-04 per=1.258e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=72 i=6 t=2.610e-04 per=1.308e+01 cost=1.014e+04 flops=3.887e+07
 sigma counter=72 i=7 t=2.550e-04 per=1.278e+01 cost=1.014e+04 flops=3.978e+07
 total GEMM cost=4.121e+04 flops=2.065e+07
--- TIMING FOR sigma_tot : t_inter=1.509e-02 t_gemm=1.385e-01 t_reduction=1.418e-02 tot=1.677e-01 ---
 sigma_tot counter=72 i=0 t=1.720e-02 per=1.242e+01 cost=1.519e+05 flops=8.829e+06
 sigma_tot counter=72 i=1 t=1.743e-02 per=1.259e+01 cost=1.580e+05 flops=9.063e+06
 sigma_tot counter=72 i=2 t=1.707e-02 per=1.232e+01 cost=1.738e+05 flops=1.019e+07
 sigma_tot counter=72 i=3 t=1.696e-02 per=1.225e+01 cost=1.803e+05 flops=1.063e+07
 sigma_tot counter=72 i=4 t=1.726e-02 per=1.247e+01 cost=3.201e+05 flops=1.854e+07
 sigma_tot counter=72 i=5 t=1.731e-02 per=1.250e+01 cost=3.214e+05 flops=1.857e+07
 sigma_tot counter=72 i=6 t=1.786e-02 per=1.290e+01 cost=3.735e+05 flops=2.091e+07
 sigma_tot counter=72 i=7 t=1.736e-02 per=1.254e+01 cost=3.689e+05 flops=2.125e+07
 total GEMM cost=2.048e+06 flops=1.479e+07
    3   0 -      -2.654509457874 -7.270e-05  3.581e-03    6     6  1.581e-02 2.636e-03
    3   1 -      -2.436951014557 -2.287e-04  5.898e-03    6     6  1.581e-02 2.636e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.200e-04,2.004e-03,1.980e-04 cost=4.121e+04 flops[gemm]=2.057e+07
--- TIMING FOR sigma : t_inter=2.200e-04 t_gemm=2.004e-03 t_reduction=1.980e-04 tot=2.422e-03 ---
 sigma counter=73 i=0 t=2.410e-04 per=1.203e+01 cost=2.582e+03 flops=1.071e+07
 sigma counter=73 i=1 t=2.420e-04 per=1.208e+01 cost=2.572e+03 flops=1.063e+07
 sigma counter=73 i=2 t=2.480e-04 per=1.238e+01 cost=3.754e+03 flops=1.514e+07
 sigma counter=73 i=3 t=2.510e-04 per=1.252e+01 cost=3.774e+03 flops=1.504e+07
 sigma counter=73 i=4 t=2.510e-04 per=1.252e+01 cost=4.112e+03 flops=1.638e+07
 sigma counter=73 i=5 t=2.530e-04 per=1.262e+01 cost=4.132e+03 flops=1.633e+07
 sigma counter=73 i=6 t=2.620e-04 per=1.307e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=73 i=7 t=2.560e-04 per=1.277e+01 cost=1.014e+04 flops=3.962e+07
 total GEMM cost=4.121e+04 flops=2.057e+07
--- TIMING FOR sigma_tot : t_inter=1.531e-02 t_gemm=1.405e-01 t_reduction=1.438e-02 tot=1.702e-01 ---
 sigma_tot counter=73 i=0 t=1.744e-02 per=1.242e+01 cost=1.545e+05 flops=8.855e+06
 sigma_tot counter=73 i=1 t=1.767e-02 per=1.258e+01 cost=1.606e+05 flops=9.084e+06
 sigma_tot counter=73 i=2 t=1.731e-02 per=1.233e+01 cost=1.776e+05 flops=1.026e+07
 sigma_tot counter=73 i=3 t=1.721e-02 per=1.225e+01 cost=1.841e+05 flops=1.070e+07
 sigma_tot counter=73 i=4 t=1.752e-02 per=1.247e+01 cost=3.242e+05 flops=1.851e+07
 sigma_tot counter=73 i=5 t=1.756e-02 per=1.250e+01 cost=3.255e+05 flops=1.854e+07
 sigma_tot counter=73 i=6 t=1.812e-02 per=1.290e+01 cost=3.836e+05 flops=2.117e+07
 sigma_tot counter=73 i=7 t=1.762e-02 per=1.254e+01 cost=3.791e+05 flops=2.151e+07
 total GEMM cost=2.089e+06 flops=1.487e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.000e-05,2.090e-04,2.027e-03,1.950e-04 cost=4.121e+04 flops[gemm]=2.033e+07
--- TIMING FOR sigma : t_inter=2.090e-04 t_gemm=2.026e-03 t_reduction=1.950e-04 tot=2.430e-03 ---
 sigma counter=74 i=0 t=2.420e-04 per=1.194e+01 cost=2.582e+03 flops=1.067e+07
 sigma counter=74 i=1 t=2.400e-04 per=1.185e+01 cost=2.572e+03 flops=1.072e+07
 sigma counter=74 i=2 t=2.500e-04 per=1.234e+01 cost=3.754e+03 flops=1.502e+07
 sigma counter=74 i=3 t=2.490e-04 per=1.229e+01 cost=3.774e+03 flops=1.516e+07
 sigma counter=74 i=4 t=2.570e-04 per=1.269e+01 cost=4.112e+03 flops=1.600e+07
 sigma counter=74 i=5 t=2.580e-04 per=1.273e+01 cost=4.132e+03 flops=1.602e+07
 sigma counter=74 i=6 t=2.660e-04 per=1.313e+01 cost=1.014e+04 flops=3.814e+07
 sigma counter=74 i=7 t=2.640e-04 per=1.303e+01 cost=1.014e+04 flops=3.842e+07
 total GEMM cost=4.121e+04 flops=2.034e+07
--- TIMING FOR sigma_tot : t_inter=1.552e-02 t_gemm=1.425e-01 t_reduction=1.458e-02 tot=1.726e-01 ---
 sigma_tot counter=74 i=0 t=1.769e-02 per=1.241e+01 cost=1.570e+05 flops=8.880e+06
 sigma_tot counter=74 i=1 t=1.791e-02 per=1.257e+01 cost=1.631e+05 flops=9.106e+06
 sigma_tot counter=74 i=2 t=1.756e-02 per=1.233e+01 cost=1.813e+05 flops=1.032e+07
 sigma_tot counter=74 i=3 t=1.746e-02 per=1.225e+01 cost=1.879e+05 flops=1.076e+07
 sigma_tot counter=74 i=4 t=1.777e-02 per=1.247e+01 cost=3.283e+05 flops=1.847e+07
 sigma_tot counter=74 i=5 t=1.782e-02 per=1.251e+01 cost=3.297e+05 flops=1.850e+07
 sigma_tot counter=74 i=6 t=1.839e-02 per=1.291e+01 cost=3.938e+05 flops=2.141e+07
 sigma_tot counter=74 i=7 t=1.788e-02 per=1.255e+01 cost=3.892e+05 flops=2.176e+07
 total GEMM cost=2.130e+06 flops=1.495e+07
    4   0 -      -2.654516214560 -6.757e-06  1.005e-03    6     8  2.109e-02 2.637e-03
    4   1 -      -2.436975310129 -2.430e-05  1.784e-03    6     8  2.109e-02 2.637e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.300e-05,2.210e-04,2.008e-03,1.970e-04 cost=4.121e+04 flops[gemm]=2.052e+07
--- TIMING FOR sigma : t_inter=2.210e-04 t_gemm=2.007e-03 t_reduction=1.970e-04 tot=2.425e-03 ---
 sigma counter=75 i=0 t=2.420e-04 per=1.206e+01 cost=2.582e+03 flops=1.067e+07
 sigma counter=75 i=1 t=2.480e-04 per=1.236e+01 cost=2.572e+03 flops=1.037e+07
 sigma counter=75 i=2 t=2.500e-04 per=1.246e+01 cost=3.754e+03 flops=1.502e+07
 sigma counter=75 i=3 t=2.470e-04 per=1.231e+01 cost=3.774e+03 flops=1.528e+07
 sigma counter=75 i=4 t=2.480e-04 per=1.236e+01 cost=4.112e+03 flops=1.658e+07
 sigma counter=75 i=5 t=2.510e-04 per=1.251e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=75 i=6 t=2.660e-04 per=1.325e+01 cost=1.014e+04 flops=3.814e+07
 sigma counter=75 i=7 t=2.550e-04 per=1.271e+01 cost=1.014e+04 flops=3.978e+07
 total GEMM cost=4.121e+04 flops=2.054e+07
--- TIMING FOR sigma_tot : t_inter=1.574e-02 t_gemm=1.445e-01 t_reduction=1.477e-02 tot=1.750e-01 ---
 sigma_tot counter=75 i=0 t=1.793e-02 per=1.241e+01 cost=1.596e+05 flops=8.904e+06
 sigma_tot counter=75 i=1 t=1.816e-02 per=1.257e+01 cost=1.657e+05 flops=9.123e+06
 sigma_tot counter=75 i=2 t=1.781e-02 per=1.233e+01 cost=1.851e+05 flops=1.039e+07
 sigma_tot counter=75 i=3 t=1.771e-02 per=1.226e+01 cost=1.917e+05 flops=1.082e+07
 sigma_tot counter=75 i=4 t=1.802e-02 per=1.247e+01 cost=3.324e+05 flops=1.845e+07
 sigma_tot counter=75 i=5 t=1.807e-02 per=1.251e+01 cost=3.338e+05 flops=1.847e+07
 sigma_tot counter=75 i=6 t=1.865e-02 per=1.291e+01 cost=4.039e+05 flops=2.165e+07
 sigma_tot counter=75 i=7 t=1.814e-02 per=1.255e+01 cost=3.994e+05 flops=2.202e+07
 total GEMM cost=2.172e+06 flops=1.503e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.220e-04,1.998e-03,1.980e-04 cost=4.121e+04 flops[gemm]=2.063e+07
--- TIMING FOR sigma : t_inter=2.220e-04 t_gemm=1.997e-03 t_reduction=1.980e-04 tot=2.417e-03 ---
 sigma counter=76 i=0 t=2.450e-04 per=1.227e+01 cost=2.582e+03 flops=1.054e+07
 sigma counter=76 i=1 t=2.430e-04 per=1.217e+01 cost=2.572e+03 flops=1.058e+07
 sigma counter=76 i=2 t=2.450e-04 per=1.227e+01 cost=3.754e+03 flops=1.532e+07
 sigma counter=76 i=3 t=2.490e-04 per=1.247e+01 cost=3.774e+03 flops=1.516e+07
 sigma counter=76 i=4 t=2.530e-04 per=1.267e+01 cost=4.112e+03 flops=1.625e+07
 sigma counter=76 i=5 t=2.500e-04 per=1.252e+01 cost=4.132e+03 flops=1.653e+07
 sigma counter=76 i=6 t=2.600e-04 per=1.302e+01 cost=1.014e+04 flops=3.902e+07
 sigma counter=76 i=7 t=2.520e-04 per=1.262e+01 cost=1.014e+04 flops=4.025e+07
 total GEMM cost=4.121e+04 flops=2.064e+07
--- TIMING FOR sigma_tot : t_inter=1.597e-02 t_gemm=1.465e-01 t_reduction=1.497e-02 tot=1.774e-01 ---
 sigma_tot counter=76 i=0 t=1.817e-02 per=1.240e+01 cost=1.622e+05 flops=8.926e+06
 sigma_tot counter=76 i=1 t=1.841e-02 per=1.256e+01 cost=1.683e+05 flops=9.142e+06
 sigma_tot counter=76 i=2 t=1.806e-02 per=1.233e+01 cost=1.888e+05 flops=1.046e+07
 sigma_tot counter=76 i=3 t=1.796e-02 per=1.226e+01 cost=1.954e+05 flops=1.088e+07
 sigma_tot counter=76 i=4 t=1.827e-02 per=1.247e+01 cost=3.365e+05 flops=1.842e+07
 sigma_tot counter=76 i=5 t=1.832e-02 per=1.251e+01 cost=3.379e+05 flops=1.845e+07
 sigma_tot counter=76 i=6 t=1.891e-02 per=1.291e+01 cost=4.141e+05 flops=2.189e+07
 sigma_tot counter=76 i=7 t=1.839e-02 per=1.255e+01 cost=4.095e+05 flops=2.227e+07
 total GEMM cost=2.213e+06 flops=1.510e+07
    5   0 -      -2.654516839742 -6.252e-07  4.207e-04    6    10  2.636e-02 2.636e-03
    5   1 -      -2.436977310239 -2.000e-06  4.243e-04    6    10  2.636e-02 2.636e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.000e-05,2.180e-04,2.002e-03,2.000e-04 cost=4.121e+04 flops[gemm]=2.059e+07
--- TIMING FOR sigma : t_inter=2.180e-04 t_gemm=2.002e-03 t_reduction=2.000e-04 tot=2.420e-03 ---
 sigma counter=77 i=0 t=2.400e-04 per=1.199e+01 cost=2.582e+03 flops=1.076e+07
 sigma counter=77 i=1 t=2.490e-04 per=1.244e+01 cost=2.572e+03 flops=1.033e+07
 sigma counter=77 i=2 t=2.470e-04 per=1.234e+01 cost=3.754e+03 flops=1.520e+07
 sigma counter=77 i=3 t=2.460e-04 per=1.229e+01 cost=3.774e+03 flops=1.534e+07
 sigma counter=77 i=4 t=2.490e-04 per=1.244e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=77 i=5 t=2.520e-04 per=1.259e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=77 i=6 t=2.630e-04 per=1.314e+01 cost=1.014e+04 flops=3.857e+07
 sigma counter=77 i=7 t=2.560e-04 per=1.279e+01 cost=1.014e+04 flops=3.962e+07
 total GEMM cost=4.121e+04 flops=2.059e+07
--- TIMING FOR sigma_tot : t_inter=1.618e-02 t_gemm=1.485e-01 t_reduction=1.517e-02 tot=1.798e-01 ---
 sigma_tot counter=77 i=0 t=1.841e-02 per=1.240e+01 cost=1.648e+05 flops=8.950e+06
 sigma_tot counter=77 i=1 t=1.865e-02 per=1.256e+01 cost=1.708e+05 flops=9.158e+06
 sigma_tot counter=77 i=2 t=1.831e-02 per=1.233e+01 cost=1.926e+05 flops=1.052e+07
 sigma_tot counter=77 i=3 t=1.820e-02 per=1.226e+01 cost=1.992e+05 flops=1.094e+07
 sigma_tot counter=77 i=4 t=1.852e-02 per=1.247e+01 cost=3.406e+05 flops=1.839e+07
 sigma_tot counter=77 i=5 t=1.857e-02 per=1.251e+01 cost=3.421e+05 flops=1.842e+07
 sigma_tot counter=77 i=6 t=1.918e-02 per=1.291e+01 cost=4.242e+05 flops=2.212e+07
 sigma_tot counter=77 i=7 t=1.865e-02 per=1.256e+01 cost=4.197e+05 flops=2.251e+07
 total GEMM cost=2.254e+06 flops=1.518e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.110e-04,1.987e-03,1.990e-04 cost=4.121e+04 flops[gemm]=2.074e+07
--- TIMING FOR sigma : t_inter=2.110e-04 t_gemm=1.987e-03 t_reduction=1.990e-04 tot=2.397e-03 ---
 sigma counter=78 i=0 t=2.360e-04 per=1.188e+01 cost=2.582e+03 flops=1.094e+07
 sigma counter=78 i=1 t=2.380e-04 per=1.198e+01 cost=2.572e+03 flops=1.081e+07
 sigma counter=78 i=2 t=2.480e-04 per=1.248e+01 cost=3.754e+03 flops=1.514e+07
 sigma counter=78 i=3 t=2.470e-04 per=1.243e+01 cost=3.774e+03 flops=1.528e+07
 sigma counter=78 i=4 t=2.510e-04 per=1.263e+01 cost=4.112e+03 flops=1.638e+07
 sigma counter=78 i=5 t=2.510e-04 per=1.263e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=78 i=6 t=2.630e-04 per=1.324e+01 cost=1.014e+04 flops=3.857e+07
 sigma counter=78 i=7 t=2.530e-04 per=1.273e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.074e+07
--- TIMING FOR sigma_tot : t_inter=1.639e-02 t_gemm=1.505e-01 t_reduction=1.537e-02 tot=1.822e-01 ---
 sigma_tot counter=78 i=0 t=1.865e-02 per=1.239e+01 cost=1.674e+05 flops=8.975e+06
 sigma_tot counter=78 i=1 t=1.889e-02 per=1.255e+01 cost=1.734e+05 flops=9.179e+06
 sigma_tot counter=78 i=2 t=1.855e-02 per=1.233e+01 cost=1.964e+05 flops=1.058e+07
 sigma_tot counter=78 i=3 t=1.845e-02 per=1.226e+01 cost=2.030e+05 flops=1.100e+07
 sigma_tot counter=78 i=4 t=1.877e-02 per=1.248e+01 cost=3.447e+05 flops=1.836e+07
 sigma_tot counter=78 i=5 t=1.882e-02 per=1.251e+01 cost=3.462e+05 flops=1.839e+07
 sigma_tot counter=78 i=6 t=1.944e-02 per=1.292e+01 cost=4.343e+05 flops=2.234e+07
 sigma_tot counter=78 i=7 t=1.890e-02 per=1.256e+01 cost=4.298e+05 flops=2.274e+07
 total GEMM cost=2.295e+06 flops=1.525e+07
    6   0 -      -2.654516957904 -1.182e-07  1.259e-04    6    12  3.161e-02 2.634e-03
    6   1 -      -2.436977427914 -1.177e-07  1.805e-04    6    12  3.161e-02 2.634e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.170e-04,1.996e-03,1.950e-04 cost=4.121e+04 flops[gemm]=2.065e+07
--- TIMING FOR sigma : t_inter=2.170e-04 t_gemm=1.995e-03 t_reduction=1.950e-04 tot=2.407e-03 ---
 sigma counter=79 i=0 t=2.430e-04 per=1.218e+01 cost=2.582e+03 flops=1.063e+07
 sigma counter=79 i=1 t=2.450e-04 per=1.228e+01 cost=2.572e+03 flops=1.050e+07
 sigma counter=79 i=2 t=2.440e-04 per=1.223e+01 cost=3.754e+03 flops=1.539e+07
 sigma counter=79 i=3 t=2.450e-04 per=1.228e+01 cost=3.774e+03 flops=1.540e+07
 sigma counter=79 i=4 t=2.530e-04 per=1.268e+01 cost=4.112e+03 flops=1.625e+07
 sigma counter=79 i=5 t=2.510e-04 per=1.258e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=79 i=6 t=2.610e-04 per=1.308e+01 cost=1.014e+04 flops=3.887e+07
 sigma counter=79 i=7 t=2.530e-04 per=1.268e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.066e+07
--- TIMING FOR sigma_tot : t_inter=1.661e-02 t_gemm=1.525e-01 t_reduction=1.557e-02 tot=1.847e-01 ---
 sigma_tot counter=79 i=0 t=1.889e-02 per=1.239e+01 cost=1.700e+05 flops=8.996e+06
 sigma_tot counter=79 i=1 t=1.914e-02 per=1.255e+01 cost=1.760e+05 flops=9.196e+06
 sigma_tot counter=79 i=2 t=1.880e-02 per=1.233e+01 cost=2.001e+05 flops=1.065e+07
 sigma_tot counter=79 i=3 t=1.870e-02 per=1.226e+01 cost=2.068e+05 flops=1.106e+07
 sigma_tot counter=79 i=4 t=1.903e-02 per=1.248e+01 cost=3.488e+05 flops=1.834e+07
 sigma_tot counter=79 i=5 t=1.907e-02 per=1.251e+01 cost=3.503e+05 flops=1.837e+07
 sigma_tot counter=79 i=6 t=1.970e-02 per=1.292e+01 cost=4.445e+05 flops=2.256e+07
 sigma_tot counter=79 i=7 t=1.915e-02 per=1.256e+01 cost=4.399e+05 flops=2.297e+07
 total GEMM cost=2.336e+06 flops=1.532e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.100e-04,1.983e-03,1.930e-04 cost=4.121e+04 flops[gemm]=2.078e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=1.983e-03 t_reduction=1.930e-04 tot=2.386e-03 ---
 sigma counter=80 i=0 t=2.350e-04 per=1.185e+01 cost=2.582e+03 flops=1.099e+07
 sigma counter=80 i=1 t=2.400e-04 per=1.210e+01 cost=2.572e+03 flops=1.072e+07
 sigma counter=80 i=2 t=2.460e-04 per=1.241e+01 cost=3.754e+03 flops=1.526e+07
 sigma counter=80 i=3 t=2.420e-04 per=1.220e+01 cost=3.774e+03 flops=1.560e+07
 sigma counter=80 i=4 t=2.490e-04 per=1.256e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=80 i=5 t=2.560e-04 per=1.291e+01 cost=4.132e+03 flops=1.614e+07
 sigma counter=80 i=6 t=2.610e-04 per=1.316e+01 cost=1.014e+04 flops=3.887e+07
 sigma counter=80 i=7 t=2.540e-04 per=1.281e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.078e+07
--- TIMING FOR sigma_tot : t_inter=1.682e-02 t_gemm=1.545e-01 t_reduction=1.576e-02 tot=1.870e-01 ---
 sigma_tot counter=80 i=0 t=1.913e-02 per=1.238e+01 cost=1.725e+05 flops=9.021e+06
 sigma_tot counter=80 i=1 t=1.938e-02 per=1.255e+01 cost=1.786e+05 flops=9.215e+06
 sigma_tot counter=80 i=2 t=1.904e-02 per=1.233e+01 cost=2.039e+05 flops=1.071e+07
 sigma_tot counter=80 i=3 t=1.894e-02 per=1.226e+01 cost=2.105e+05 flops=1.112e+07
 sigma_tot counter=80 i=4 t=1.928e-02 per=1.248e+01 cost=3.530e+05 flops=1.831e+07
 sigma_tot counter=80 i=5 t=1.933e-02 per=1.251e+01 cost=3.545e+05 flops=1.834e+07
 sigma_tot counter=80 i=6 t=1.996e-02 per=1.292e+01 cost=4.546e+05 flops=2.277e+07
 sigma_tot counter=80 i=7 t=1.941e-02 per=1.256e+01 cost=4.501e+05 flops=2.319e+07
 total GEMM cost=2.378e+06 flops=1.539e+07
    7   0 +      -2.654516967213 -9.309e-09  3.918e-05    6    14  3.684e-02 2.632e-03
    7   1 +      -2.436977447783 -1.987e-08  6.162e-05    6    14  3.684e-02 2.632e-03
TIMING FOR Davidson : 3.687e-02  T(cal/comm/rest)=3.628e-02,4.964e-05,5.416e-04
optimized energies: isweep=1 dots=2 ibond=1 e[0]=-2.65451696721 nmvp=14
optimized energies: isweep=1 dots=2 ibond=1 e[1]=-2.43697744778 nmvp=14
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=16 alg_decim=1 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep1_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
----- TMING FOR decimation_genbasis: 3.9e-04 S T(scatter/comp/gather)=3.7e-05,3.8e-05,3.1e-04 -----
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
 qbond: qkept nsym=6 dimAll=20
 (3,1):6 (4,0):4 (2,0):3 (4,2):3 (3,-1):2 (5,1):2
----- TIMING for decimation_row: 7.169e-04 S T(decim/formRot)=4.679e-04,2.490e-04 -----
TIMING FOR decimation: 1.033e-03 S T(wf/decim)=3.022e-04,7.309e-04
ctns::oper_renorm coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:6 A:7 B:11 P:3 Q:5 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=1685:1.286e-02MB:1.255e-05GB
rank=0 GPUmem(GB): used=2.249e-05 (oper)=1.999e-05
rank=0 GPUmem(GB): used=2.361e-05 (oper,site)(GB)=1.999e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=37 : 4.751e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 5.687e-05 S -----
rank=0 GPUmem(GB): used=2.39e-05 (oper,site,rinter)=2e-05,1.12e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00099 S size(rtasks)=37 size(Rlst2)=6 T(Rmu/Rlist)=0.000163,0.000827 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00107 S size(rtasks)=37 size(Rlst)=905 -----
rank=0 GPUmem(GB): used=0.00057 (oper,site,rinter,batch)=2e-05,1.12e-06,3.28e-07,0.000546 blksize=36 blksize0=8 batchsize=905
timing: allocate=3.48e-05 rmmtasks init=0.00112 total=0.00116
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000214,0.00118,0.00022 cost=9.26e+04 flops[gemm]=7.87e+07
--- TIMING FOR renorm : t_inter=0.000214 t_gemm=0.00118 t_reduction=0.00022 tot=0.00161 ---
 renorm counter=6 i=0 t=0.000229 per=19.5 cost=4.54e+03 flops=1.98e+07
 renorm counter=6 i=1 t=0.000225 per=19.1 cost=5.34e+03 flops=2.38e+07
 renorm counter=6 i=2 t=1e-06 per=0.0851 cost=0 flops=0
 renorm counter=6 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=6 i=4 t=0.000223 per=19 cost=9.49e+03 flops=4.26e+07
 renorm counter=6 i=5 t=0.000236 per=20.1 cost=1.68e+04 flops=7.11e+07
 renorm counter=6 i=6 t=0.000261 per=22.2 cost=5.64e+04 flops=2.16e+08
 total GEMM cost=9.26e+04 flops=7.88e+07
--- TIMING FOR renorm_tot : t_inter=0.000644 t_gemm=0.00685 t_reduction=0.00121 tot=0.00871 ---
 renorm_tot counter=6 i=0 t=0.0014 per=20.4 cost=9.81e+03 flops=7.01e+06
 renorm_tot counter=6 i=1 t=0.00134 per=19.6 cost=1.31e+04 flops=9.72e+06
 renorm_tot counter=6 i=2 t=0.000437 per=6.37 cost=3.37e+03 flops=7.7e+06
 renorm_tot counter=6 i=3 t=0.000437 per=6.37 cost=6e+03 flops=1.37e+07
 renorm_tot counter=6 i=4 t=0.000884 per=12.9 cost=1.42e+04 flops=1.61e+07
 renorm_tot counter=6 i=5 t=0.000905 per=13.2 cost=2.5e+04 flops=2.76e+07
 renorm_tot counter=6 i=6 t=0.00145 per=21.1 cost=1.07e+05 flops=7.42e+07
 total GEMM cost=1.79e+05 flops=2.61e+07
timing: gpu2cpu=1.72e-05 deallocate(site/work)=3.26e-06,5.95e-06 total=2.32e-05
check ||H-H.dagger||=9.362e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00504 S T(init/kernel/comm)=0.000315,0.00466,7.12e-05 rank=0 -----
TIMING FOR cleanup: 0.000213 T(erase/save/remove)=4.31e-06,0.000175,3.43e-05
##### local: 5.456e-02 S #####
 T(local: fetch) = 1.047e-03 S  per = 1.92  per(accum) = 1.92
 T(local: hdiag) = 5.102e-04 S  per = 0.935  per(accum) = 2.85
 T(local: dvdsn) = 4.601e-02 S  per = 84.3  per(accum) = 87.2
 T(local: decim) = 1.173e-03 S  per = 2.15  per(accum) = 89.3
 T(local: guess) = 3.941e-04 S  per = 0.722  per(accum) = 90
 T(local: renrm) = 5.205e-03 S  per = 9.54  per(accum) = 99.6
 T(local: save ) = 2.255e-04 S  per = 0.413  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.487e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 9.135e-06 S  per = 0.0204  per(accum) = 0.0204
 T(local: symbolic_formulae_twodot     ) = 6.568e-04 S  per = 1.46  per(accum) = 1.48
 T(local: hintermediate init           ) = 5.694e-05 S  per = 0.127  per(accum) = 1.61
 T(local: hintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 6.46e-05  per(accum) = 1.61
 T(local: preprocess_hformulae_Hxlist2 ) = 3.656e-03 S  per = 8.15  per(accum) = 9.76
 T(local: hmmtasks init                ) = 3.626e-03 S  per = 8.08  per(accum) = 17.8
 T(local: dvdson solver [Hx_batchGPU]  ) = 3.628e-02 S  per = 80.8  per(accum) = 98.7
 T(local: dvdson solver [communication]) = 4.964e-05 S  per = 0.111  per(accum) = 98.8
 T(local: dvdson solver [rest part]    ) = 5.416e-04 S  per = 1.21  per(accum) = 100
Detailed decomposition of T(renrm): 5.042e-03 S
 T(local: qops init                    ) = 3.150e-04 S  per = 6.25  per(accum) = 6.25
 T(local: qops_dict memcpy cpu2gpu     ) = 4.964e-05 S  per = 0.984  per(accum) = 7.23
 T(local: symbolic_formulae_renorm     ) = 4.852e-04 S  per = 9.62  per(accum) = 16.9
 T(local: rintermediate init           ) = 6.932e-05 S  per = 1.37  per(accum) = 18.2
 T(local: rintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 0.000575  per(accum) = 18.2
 T(local: preprocess_formulae_Rlist2   ) = 1.104e-03 S  per = 21.9  per(accum) = 40.1
 T(local: rmmtasks init                ) = 1.166e-03 S  per = 23.1  per(accum) = 63.2
 T(local: qops memset                  ) = 2.900e-08 S  per = 0.000575  per(accum) = 63.2
 T(local: preprocess_renorm_batchGPU   ) = 1.731e-03 S  per = 34.3  per(accum) = 97.6
 T(local: qops memcpy gpu2cpu          ) = 1.727e-05 S  per = 0.343  per(accum) = 97.9
 T(local: deallocate gpu memory        ) = 3.376e-05 S  per = 0.67  per(accum) = 98.6
 T(local: communication of opS and opH ) = 7.116e-05 S  per = 1.41  per(accum) = 100
##### sweep: 1.052e-01 S #####
 T(sweep: fetch) = 1.196e-03 S  per = 1.14  per(accum) = 1.14
 T(sweep: hdiag) = 1.004e-03 S  per = 0.954  per(accum) = 2.09
 T(sweep: dvdsn) = 8.982e-02 S  per = 85.4  per(accum) = 87.4
 T(sweep: decim) = 1.560e-03 S  per = 1.48  per(accum) = 88.9
 T(sweep: guess) = 7.742e-04 S  per = 0.736  per(accum) = 89.7
 T(sweep: renrm) = 1.029e-02 S  per = 9.78  per(accum) = 99.4
 T(sweep: save ) = 5.903e-04 S  per = 0.561  per(accum) = 100
Detailed decomposition of T(dvdsn): 8.792e-02 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.881e-05 S  per = 0.0214  per(accum) = 0.0214
 T(sweep: symbolic_formulae_twodot     ) = 1.378e-03 S  per = 1.57  per(accum) = 1.59
 T(sweep: hintermediate init           ) = 1.203e-04 S  per = 0.137  per(accum) = 1.73
 T(sweep: hintermediates memcpy cpu2gpu) = 6.000e-08 S  per = 6.82e-05  per(accum) = 1.73
 T(sweep: preprocess_hformulae_Hxlist2 ) = 6.266e-03 S  per = 7.13  per(accum) = 8.85
 T(sweep: hmmtasks init                ) = 5.868e-03 S  per = 6.67  per(accum) = 15.5
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 7.303e-02 S  per = 83.1  per(accum) = 98.6
 T(sweep: dvdson solver [communication]) = 9.760e-05 S  per = 0.111  per(accum) = 98.7
 T(sweep: dvdson solver [rest part]    ) = 1.141e-03 S  per =  1.3  per(accum) = 100
Detailed decomposition of T(renrm): 9.978e-03 S
 T(sweep: qops init                    ) = 7.525e-04 S  per = 7.54  per(accum) = 7.54
 T(sweep: qops_dict memcpy cpu2gpu     ) = 9.086e-05 S  per = 0.911  per(accum) = 8.45
 T(sweep: symbolic_formulae_renorm     ) = 1.077e-03 S  per = 10.8  per(accum) = 19.2
 T(sweep: rintermediate init           ) = 9.759e-05 S  per = 0.978  per(accum) = 20.2
 T(sweep: rintermediates memcpy cpu2gpu) = 5.700e-08 S  per = 0.000571  per(accum) = 20.2
 T(sweep: preprocess_formulae_Rlist2   ) = 2.219e-03 S  per = 22.2  per(accum) = 42.5
 T(sweep: rmmtasks init                ) = 2.255e-03 S  per = 22.6  per(accum) = 65.1
 T(sweep: qops memset                  ) = 5.700e-08 S  per = 0.000571  per(accum) = 65.1
 T(sweep: preprocess_renorm_batchGPU   ) = 3.241e-03 S  per = 32.5  per(accum) = 97.6
 T(sweep: qops memcpy gpu2cpu          ) = 3.270e-05 S  per = 0.328  per(accum) = 97.9
 T(sweep: deallocate gpu memory        ) = 7.602e-05 S  per = 0.762  per(accum) = 98.6
 T(sweep: communication of opS and opH ) = 1.355e-04 S  per = 1.36  per(accum) = 100
##### global: 2.966e-01 S #####
 T(global: fetch) = 5.325e-03 S  per =  1.8  per(accum) = 1.8
 T(global: hdiag) = 3.553e-03 S  per =  1.2  per(accum) = 2.99
 T(global: dvdsn) = 2.514e-01 S  per = 84.8  per(accum) = 87.8
 T(global: decim) = 5.813e-03 S  per = 1.96  per(accum) = 89.7
 T(global: guess) = 2.250e-03 S  per = 0.758  per(accum) = 90.5
 T(global: renrm) = 2.659e-02 S  per = 8.96  per(accum) = 99.4
 T(global: save ) = 1.675e-03 S  per = 0.565  per(accum) = 100
Detailed decomposition of T(dvdsn): 2.460e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 6.543e-05 S  per = 0.0266  per(accum) = 0.0266
 T(global: symbolic_formulae_twodot     ) = 3.995e-03 S  per = 1.62  per(accum) = 1.65
 T(global: hintermediate init           ) = 3.480e-04 S  per = 0.141  per(accum) = 1.79
 T(global: hintermediates memcpy cpu2gpu) = 1.740e-07 S  per = 7.07e-05  per(accum) = 1.79
 T(global: preprocess_hformulae_Hxlist2 ) = 1.846e-02 S  per =  7.5  per(accum) = 9.3
 T(global: hmmtasks init                ) = 1.795e-02 S  per =  7.3  per(accum) = 16.6
 T(global: dvdson solver [Hx_batchGPU]  ) = 2.015e-01 S  per = 81.9  per(accum) = 98.5
 T(global: dvdson solver [communication]) = 2.802e-04 S  per = 0.114  per(accum) = 98.6
 T(global: dvdson solver [rest part]    ) = 3.385e-03 S  per = 1.38  per(accum) = 100
Detailed decomposition of T(renrm): 2.579e-02 S
 T(global: qops init                    ) = 1.873e-03 S  per = 7.26  per(accum) = 7.26
 T(global: qops_dict memcpy cpu2gpu     ) = 2.566e-04 S  per = 0.995  per(accum) = 8.26
 T(global: symbolic_formulae_renorm     ) = 3.254e-03 S  per = 12.6  per(accum) = 20.9
 T(global: rintermediate init           ) = 2.825e-04 S  per =  1.1  per(accum) = 22
 T(global: rintermediates memcpy cpu2gpu) = 1.710e-07 S  per = 0.000663  per(accum) = 22
 T(global: preprocess_formulae_Rlist2   ) = 5.174e-03 S  per = 20.1  per(accum) = 42
 T(global: rmmtasks init                ) = 4.826e-03 S  per = 18.7  per(accum) = 60.8
 T(global: qops memset                  ) = 1.670e-07 S  per = 0.000648  per(accum) = 60.8
 T(global: preprocess_renorm_batchGPU   ) = 9.426e-03 S  per = 36.6  per(accum) = 97.3
 T(global: qops memcpy gpu2cpu          ) = 9.047e-05 S  per = 0.351  per(accum) = 97.7
 T(global: deallocate gpu memory        ) = 2.287e-04 S  per = 0.887  per(accum) = 98.5
 T(global: communication of opS and opH ) = 3.755e-04 S  per = 1.46  per(accum) = 100

isweep=1 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=852:0.0065MB:6.35e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1290:0.00984MB:9.61e-06GB
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44699d90
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
### DIAG TIMING: total=0.000373 t1=1.23e-05, t2=1.55e-05, t3=5.27e-05, t4=0.000125, t5=0.000125, t6=2.64e-05, t7=1.26e-05, t8=3.48e-06
duration_diagGPU:0.000388
duration_diagreduce:4.14e-06
duration_diagtransform:1.74e-06
rank=0 GPUmem(GB): used=2.22e-05 (oper)=9.61e-06
----- TIMING FOR symbolic_formulae_twodot with size=95 : 6.353e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=95
 no. of hintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.521e-05 S -----
rank=0 GPUmem(GB): used=2.25e-05 (oper,hinter)=9.61e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00333 S size(H_formulae)=95 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000187,0.00314 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00357 S size(H_formulae)=95 size(Hxlst)=2974 -----
rank=0 GPUmem(GB): used=0.000401 (oper,hinter,dvdson,batch)=9.61e-06,3.28e-07,1.49e-06,0.000377 blksize=4 blksize0=8 batchsize=2974
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.3e-05,0.000218,0.002,0.000197 cost=4.12e+04 flops[gemm]=2.06e+07
--- TIMING FOR sigma : t_inter=0.000217 t_gemm=0.00201 t_reduction=0.000197 tot=0.00242 ---
 sigma counter=81 i=0 t=0.000244 per=12.2 cost=2.58e+03 flops=1.06e+07
 sigma counter=81 i=1 t=0.000246 per=12.3 cost=2.57e+03 flops=1.05e+07
 sigma counter=81 i=2 t=0.000247 per=12.3 cost=3.75e+03 flops=1.52e+07
 sigma counter=81 i=3 t=0.000245 per=12.2 cost=3.77e+03 flops=1.54e+07
 sigma counter=81 i=4 t=0.00025 per=12.5 cost=4.11e+03 flops=1.64e+07
 sigma counter=81 i=5 t=0.000257 per=12.8 cost=4.13e+03 flops=1.61e+07
 sigma counter=81 i=6 t=0.000264 per=13.2 cost=1.01e+04 flops=3.84e+07
 sigma counter=81 i=7 t=0.000252 per=12.6 cost=1.01e+04 flops=4.03e+07
 total GEMM cost=4.12e+04 flops=2.06e+07
--- TIMING FOR sigma_tot : t_inter=0.017 t_gemm=0.156 t_reduction=0.016 tot=0.189 ---
 sigma_tot counter=81 i=0 t=0.0194 per=12.4 cost=1.75e+05 flops=9.04e+06
 sigma_tot counter=81 i=1 t=0.0196 per=12.5 cost=1.81e+05 flops=9.23e+06
 sigma_tot counter=81 i=2 t=0.0193 per=12.3 cost=2.08e+05 flops=1.08e+07
 sigma_tot counter=81 i=3 t=0.0192 per=12.3 cost=2.14e+05 flops=1.12e+07
 sigma_tot counter=81 i=4 t=0.0195 per=12.5 cost=3.57e+05 flops=1.83e+07
 sigma_tot counter=81 i=5 t=0.0196 per=12.5 cost=3.59e+05 flops=1.83e+07
 sigma_tot counter=81 i=6 t=0.0202 per=12.9 cost=4.65e+05 flops=2.3e+07
 sigma_tot counter=81 i=7 t=0.0197 per=12.6 cost=4.6e+05 flops=2.34e+07
 total GEMM cost=2.42e+06 flops=1.55e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.1e-05,0.000211,0.002,0.0002 cost=4.12e+04 flops[gemm]=2.06e+07
--- TIMING FOR sigma : t_inter=0.00021 t_gemm=0.002 t_reduction=0.000199 tot=0.00241 ---
 sigma counter=82 i=0 t=0.000238 per=11.9 cost=2.58e+03 flops=1.08e+07
 sigma counter=82 i=1 t=0.000247 per=12.4 cost=2.57e+03 flops=1.04e+07
 sigma counter=82 i=2 t=0.000248 per=12.4 cost=3.75e+03 flops=1.51e+07
 sigma counter=82 i=3 t=0.000247 per=12.4 cost=3.77e+03 flops=1.53e+07
 sigma counter=82 i=4 t=0.000248 per=12.4 cost=4.11e+03 flops=1.66e+07
 sigma counter=82 i=5 t=0.00025 per=12.5 cost=4.13e+03 flops=1.65e+07
 sigma counter=82 i=6 t=0.000265 per=13.3 cost=1.01e+04 flops=3.83e+07
 sigma counter=82 i=7 t=0.000255 per=12.8 cost=1.01e+04 flops=3.98e+07
 total GEMM cost=4.12e+04 flops=2.06e+07
--- TIMING FOR sigma_tot : t_inter=0.0172 t_gemm=0.158 t_reduction=0.0162 tot=0.192 ---
 sigma_tot counter=82 i=0 t=0.0196 per=12.4 cost=1.78e+05 flops=9.06e+06
 sigma_tot counter=82 i=1 t=0.0199 per=12.5 cost=1.84e+05 flops=9.25e+06
 sigma_tot counter=82 i=2 t=0.0195 per=12.3 cost=2.11e+05 flops=1.08e+07
 sigma_tot counter=82 i=3 t=0.0194 per=12.3 cost=2.18e+05 flops=1.12e+07
 sigma_tot counter=82 i=4 t=0.0198 per=12.5 cost=3.61e+05 flops=1.83e+07
 sigma_tot counter=82 i=5 t=0.0198 per=12.5 cost=3.63e+05 flops=1.83e+07
 sigma_tot counter=82 i=6 t=0.0205 per=12.9 cost=4.75e+05 flops=2.32e+07
 sigma_tot counter=82 i=7 t=0.0199 per=12.6 cost=4.7e+05 flops=2.36e+07
 total GEMM cost=2.46e+06 flops=1.55e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588771076 -1.003e+03  7.009e-02    2     2  5.301e-03 2.650e-03
    1   1 -      -2.436093960617 -1.002e+03  4.918e-02    2     2  5.301e-03 2.650e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.210e-04,2.010e-03,1.970e-04 cost=4.121e+04 flops[gemm]=2.050e+07
--- TIMING FOR sigma : t_inter=2.210e-04 t_gemm=2.010e-03 t_reduction=1.970e-04 tot=2.428e-03 ---
 sigma counter=83 i=0 t=2.460e-04 per=1.224e+01 cost=2.582e+03 flops=1.050e+07
 sigma counter=83 i=1 t=2.470e-04 per=1.229e+01 cost=2.572e+03 flops=1.041e+07
 sigma counter=83 i=2 t=2.520e-04 per=1.254e+01 cost=3.754e+03 flops=1.490e+07
 sigma counter=83 i=3 t=2.440e-04 per=1.214e+01 cost=3.774e+03 flops=1.547e+07
 sigma counter=83 i=4 t=2.520e-04 per=1.254e+01 cost=4.112e+03 flops=1.632e+07
 sigma counter=83 i=5 t=2.530e-04 per=1.259e+01 cost=4.132e+03 flops=1.633e+07
 sigma counter=83 i=6 t=2.620e-04 per=1.303e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=83 i=7 t=2.540e-04 per=1.264e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.050e+07
--- TIMING FOR sigma_tot : t_inter=1.747e-02 t_gemm=1.605e-01 t_reduction=1.635e-02 tot=1.943e-01 ---
 sigma_tot counter=83 i=0 t=1.985e-02 per=1.237e+01 cost=1.803e+05 flops=9.080e+06
 sigma_tot counter=83 i=1 t=2.012e-02 per=1.254e+01 cost=1.863e+05 flops=9.259e+06
 sigma_tot counter=83 i=2 t=1.979e-02 per=1.233e+01 cost=2.151e+05 flops=1.087e+07
 sigma_tot counter=83 i=3 t=1.967e-02 per=1.226e+01 cost=2.219e+05 flops=1.128e+07
 sigma_tot counter=83 i=4 t=2.003e-02 per=1.248e+01 cost=3.653e+05 flops=1.824e+07
 sigma_tot counter=83 i=5 t=2.009e-02 per=1.252e+01 cost=3.669e+05 flops=1.826e+07
 sigma_tot counter=83 i=6 t=2.075e-02 per=1.293e+01 cost=4.851e+05 flops=2.337e+07
 sigma_tot counter=83 i=7 t=2.017e-02 per=1.257e+01 cost=4.805e+05 flops=2.383e+07
 total GEMM cost=2.501e+06 flops=1.559e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.100e-04,2.003e-03,1.950e-04 cost=4.121e+04 flops[gemm]=2.058e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=2.003e-03 t_reduction=1.950e-04 tot=2.408e-03 ---
 sigma counter=84 i=0 t=2.370e-04 per=1.183e+01 cost=2.582e+03 flops=1.089e+07
 sigma counter=84 i=1 t=2.490e-04 per=1.243e+01 cost=2.572e+03 flops=1.033e+07
 sigma counter=84 i=2 t=2.450e-04 per=1.223e+01 cost=3.754e+03 flops=1.532e+07
 sigma counter=84 i=3 t=2.450e-04 per=1.223e+01 cost=3.774e+03 flops=1.540e+07
 sigma counter=84 i=4 t=2.540e-04 per=1.268e+01 cost=4.112e+03 flops=1.619e+07
 sigma counter=84 i=5 t=2.570e-04 per=1.283e+01 cost=4.132e+03 flops=1.608e+07
 sigma counter=84 i=6 t=2.630e-04 per=1.313e+01 cost=1.014e+04 flops=3.857e+07
 sigma counter=84 i=7 t=2.530e-04 per=1.263e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.058e+07
--- TIMING FOR sigma_tot : t_inter=1.768e-02 t_gemm=1.625e-01 t_reduction=1.655e-02 tot=1.967e-01 ---
 sigma_tot counter=84 i=0 t=2.009e-02 per=1.237e+01 cost=1.829e+05 flops=9.102e+06
 sigma_tot counter=84 i=1 t=2.037e-02 per=1.254e+01 cost=1.889e+05 flops=9.272e+06
 sigma_tot counter=84 i=2 t=2.004e-02 per=1.233e+01 cost=2.189e+05 flops=1.092e+07
 sigma_tot counter=84 i=3 t=1.992e-02 per=1.226e+01 cost=2.256e+05 flops=1.133e+07
 sigma_tot counter=84 i=4 t=2.028e-02 per=1.248e+01 cost=3.694e+05 flops=1.822e+07
 sigma_tot counter=84 i=5 t=2.035e-02 per=1.252e+01 cost=3.710e+05 flops=1.823e+07
 sigma_tot counter=84 i=6 t=2.102e-02 per=1.294e+01 cost=4.952e+05 flops=2.356e+07
 sigma_tot counter=84 i=7 t=2.042e-02 per=1.257e+01 cost=4.907e+05 flops=2.403e+07
 total GEMM cost=2.542e+06 flops=1.565e+07
    2   0 -      -2.654426819280 -1.838e-03  1.257e-02    4     4  1.058e-02 2.644e-03
    2   1 -      -2.436959163109 -8.652e-04  5.190e-03    4     4  1.058e-02 2.644e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.300e-05,2.180e-04,2.050e-03,1.970e-04 cost=4.121e+04 flops[gemm]=2.010e+07
--- TIMING FOR sigma : t_inter=2.180e-04 t_gemm=2.050e-03 t_reduction=1.970e-04 tot=2.465e-03 ---
 sigma counter=85 i=0 t=2.480e-04 per=1.210e+01 cost=2.582e+03 flops=1.041e+07
 sigma counter=85 i=1 t=2.420e-04 per=1.180e+01 cost=2.572e+03 flops=1.063e+07
 sigma counter=85 i=2 t=2.540e-04 per=1.239e+01 cost=3.754e+03 flops=1.478e+07
 sigma counter=85 i=3 t=2.560e-04 per=1.249e+01 cost=3.774e+03 flops=1.474e+07
 sigma counter=85 i=4 t=2.590e-04 per=1.263e+01 cost=4.112e+03 flops=1.588e+07
 sigma counter=85 i=5 t=2.590e-04 per=1.263e+01 cost=4.132e+03 flops=1.595e+07
 sigma counter=85 i=6 t=2.770e-04 per=1.351e+01 cost=1.014e+04 flops=3.662e+07
 sigma counter=85 i=7 t=2.550e-04 per=1.244e+01 cost=1.014e+04 flops=3.978e+07
 total GEMM cost=4.121e+04 flops=2.010e+07
--- TIMING FOR sigma_tot : t_inter=1.790e-02 t_gemm=1.645e-01 t_reduction=1.674e-02 tot=1.992e-01 ---
 sigma_tot counter=85 i=0 t=2.034e-02 per=1.236e+01 cost=1.854e+05 flops=9.118e+06
 sigma_tot counter=85 i=1 t=2.061e-02 per=1.253e+01 cost=1.914e+05 flops=9.288e+06
 sigma_tot counter=85 i=2 t=2.029e-02 per=1.233e+01 cost=2.226e+05 flops=1.097e+07
 sigma_tot counter=85 i=3 t=2.017e-02 per=1.226e+01 cost=2.294e+05 flops=1.137e+07
 sigma_tot counter=85 i=4 t=2.054e-02 per=1.248e+01 cost=3.735e+05 flops=1.819e+07
 sigma_tot counter=85 i=5 t=2.061e-02 per=1.252e+01 cost=3.751e+05 flops=1.820e+07
 sigma_tot counter=85 i=6 t=2.129e-02 per=1.294e+01 cost=5.053e+05 flops=2.373e+07
 sigma_tot counter=85 i=7 t=2.068e-02 per=1.257e+01 cost=5.008e+05 flops=2.422e+07
 total GEMM cost=2.584e+06 flops=1.570e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.000e-05,2.100e-04,2.023e-03,2.000e-04 cost=4.121e+04 flops[gemm]=2.037e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=2.021e-03 t_reduction=2.000e-04 tot=2.431e-03 ---
 sigma counter=86 i=0 t=2.410e-04 per=1.192e+01 cost=2.582e+03 flops=1.071e+07
 sigma counter=86 i=1 t=2.380e-04 per=1.178e+01 cost=2.572e+03 flops=1.081e+07
 sigma counter=86 i=2 t=2.470e-04 per=1.222e+01 cost=3.754e+03 flops=1.520e+07
 sigma counter=86 i=3 t=2.510e-04 per=1.242e+01 cost=3.774e+03 flops=1.504e+07
 sigma counter=86 i=4 t=2.580e-04 per=1.277e+01 cost=4.112e+03 flops=1.594e+07
 sigma counter=86 i=5 t=2.590e-04 per=1.282e+01 cost=4.132e+03 flops=1.595e+07
 sigma counter=86 i=6 t=2.650e-04 per=1.311e+01 cost=1.014e+04 flops=3.828e+07
 sigma counter=86 i=7 t=2.620e-04 per=1.296e+01 cost=1.014e+04 flops=3.872e+07
 total GEMM cost=4.121e+04 flops=2.039e+07
--- TIMING FOR sigma_tot : t_inter=1.811e-02 t_gemm=1.665e-01 t_reduction=1.694e-02 tot=2.016e-01 ---
 sigma_tot counter=86 i=0 t=2.058e-02 per=1.236e+01 cost=1.880e+05 flops=9.136e+06
 sigma_tot counter=86 i=1 t=2.085e-02 per=1.252e+01 cost=1.940e+05 flops=9.306e+06
 sigma_tot counter=86 i=2 t=2.054e-02 per=1.233e+01 cost=2.264e+05 flops=1.102e+07
 sigma_tot counter=86 i=3 t=2.043e-02 per=1.226e+01 cost=2.332e+05 flops=1.142e+07
 sigma_tot counter=86 i=4 t=2.080e-02 per=1.249e+01 cost=3.776e+05 flops=1.816e+07
 sigma_tot counter=86 i=5 t=2.087e-02 per=1.253e+01 cost=3.793e+05 flops=1.818e+07
 sigma_tot counter=86 i=6 t=2.156e-02 per=1.294e+01 cost=5.155e+05 flops=2.391e+07
 sigma_tot counter=86 i=7 t=2.094e-02 per=1.257e+01 cost=5.110e+05 flops=2.440e+07
 total GEMM cost=2.625e+06 flops=1.576e+07
    3   0 -      -2.654508896837 -8.208e-05  3.560e-03    6     6  1.594e-02 2.656e-03
    3   1 -      -2.436975274429 -1.611e-05  1.593e-03    6     6  1.594e-02 2.656e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.190e-04,2.006e-03,1.970e-04 cost=4.121e+04 flops[gemm]=2.055e+07
--- TIMING FOR sigma : t_inter=2.180e-04 t_gemm=2.005e-03 t_reduction=1.970e-04 tot=2.420e-03 ---
 sigma counter=87 i=0 t=2.420e-04 per=1.207e+01 cost=2.582e+03 flops=1.067e+07
 sigma counter=87 i=1 t=2.500e-04 per=1.247e+01 cost=2.572e+03 flops=1.029e+07
 sigma counter=87 i=2 t=2.480e-04 per=1.237e+01 cost=3.754e+03 flops=1.514e+07
 sigma counter=87 i=3 t=2.460e-04 per=1.227e+01 cost=3.774e+03 flops=1.534e+07
 sigma counter=87 i=4 t=2.500e-04 per=1.247e+01 cost=4.112e+03 flops=1.645e+07
 sigma counter=87 i=5 t=2.560e-04 per=1.277e+01 cost=4.132e+03 flops=1.614e+07
 sigma counter=87 i=6 t=2.610e-04 per=1.302e+01 cost=1.014e+04 flops=3.887e+07
 sigma counter=87 i=7 t=2.520e-04 per=1.257e+01 cost=1.014e+04 flops=4.025e+07
 total GEMM cost=4.121e+04 flops=2.056e+07
--- TIMING FOR sigma_tot : t_inter=1.833e-02 t_gemm=1.686e-01 t_reduction=1.714e-02 tot=2.040e-01 ---
 sigma_tot counter=87 i=0 t=2.082e-02 per=1.235e+01 cost=1.906e+05 flops=9.154e+06
 sigma_tot counter=87 i=1 t=2.110e-02 per=1.252e+01 cost=1.966e+05 flops=9.317e+06
 sigma_tot counter=87 i=2 t=2.078e-02 per=1.233e+01 cost=2.301e+05 flops=1.107e+07
 sigma_tot counter=87 i=3 t=2.067e-02 per=1.226e+01 cost=2.370e+05 flops=1.146e+07
 sigma_tot counter=87 i=4 t=2.105e-02 per=1.249e+01 cost=3.817e+05 flops=1.814e+07
 sigma_tot counter=87 i=5 t=2.112e-02 per=1.253e+01 cost=3.834e+05 flops=1.815e+07
 sigma_tot counter=87 i=6 t=2.182e-02 per=1.295e+01 cost=5.256e+05 flops=2.409e+07
 sigma_tot counter=87 i=7 t=2.119e-02 per=1.257e+01 cost=5.211e+05 flops=2.459e+07
 total GEMM cost=2.666e+06 flops=1.582e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.130e-04,1.995e-03,1.970e-04 cost=4.121e+04 flops[gemm]=2.066e+07
--- TIMING FOR sigma : t_inter=2.130e-04 t_gemm=1.994e-03 t_reduction=1.970e-04 tot=2.404e-03 ---
 sigma counter=88 i=0 t=2.360e-04 per=1.184e+01 cost=2.582e+03 flops=1.094e+07
 sigma counter=88 i=1 t=2.380e-04 per=1.194e+01 cost=2.572e+03 flops=1.081e+07
 sigma counter=88 i=2 t=2.550e-04 per=1.279e+01 cost=3.754e+03 flops=1.472e+07
 sigma counter=88 i=3 t=2.500e-04 per=1.254e+01 cost=3.774e+03 flops=1.510e+07
 sigma counter=88 i=4 t=2.510e-04 per=1.259e+01 cost=4.112e+03 flops=1.638e+07
 sigma counter=88 i=5 t=2.510e-04 per=1.259e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=88 i=6 t=2.610e-04 per=1.309e+01 cost=1.014e+04 flops=3.887e+07
 sigma counter=88 i=7 t=2.520e-04 per=1.264e+01 cost=1.014e+04 flops=4.025e+07
 total GEMM cost=4.121e+04 flops=2.067e+07
--- TIMING FOR sigma_tot : t_inter=1.854e-02 t_gemm=1.705e-01 t_reduction=1.734e-02 tot=2.064e-01 ---
 sigma_tot counter=88 i=0 t=2.106e-02 per=1.235e+01 cost=1.932e+05 flops=9.174e+06
 sigma_tot counter=88 i=1 t=2.133e-02 per=1.251e+01 cost=1.991e+05 flops=9.334e+06
 sigma_tot counter=88 i=2 t=2.104e-02 per=1.234e+01 cost=2.339e+05 flops=1.112e+07
 sigma_tot counter=88 i=3 t=2.092e-02 per=1.227e+01 cost=2.407e+05 flops=1.151e+07
 sigma_tot counter=88 i=4 t=2.130e-02 per=1.249e+01 cost=3.859e+05 flops=1.812e+07
 sigma_tot counter=88 i=5 t=2.137e-02 per=1.253e+01 cost=3.875e+05 flops=1.813e+07
 sigma_tot counter=88 i=6 t=2.208e-02 per=1.295e+01 cost=5.358e+05 flops=2.426e+07
 sigma_tot counter=88 i=7 t=2.144e-02 per=1.257e+01 cost=5.312e+05 flops=2.478e+07
 total GEMM cost=2.707e+06 flops=1.587e+07
    4   0 -      -2.654515664927 -6.768e-06  1.295e-03    6     8  2.119e-02 2.649e-03
    4   1 -      -2.436977078524 -1.804e-06  5.942e-04    6     8  2.119e-02 2.649e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.180e-04,2.002e-03,1.970e-04 cost=4.121e+04 flops[gemm]=2.059e+07
--- TIMING FOR sigma : t_inter=2.180e-04 t_gemm=2.002e-03 t_reduction=1.970e-04 tot=2.417e-03 ---
 sigma counter=89 i=0 t=2.470e-04 per=1.234e+01 cost=2.582e+03 flops=1.045e+07
 sigma counter=89 i=1 t=2.480e-04 per=1.239e+01 cost=2.572e+03 flops=1.037e+07
 sigma counter=89 i=2 t=2.450e-04 per=1.224e+01 cost=3.754e+03 flops=1.532e+07
 sigma counter=89 i=3 t=2.460e-04 per=1.229e+01 cost=3.774e+03 flops=1.534e+07
 sigma counter=89 i=4 t=2.490e-04 per=1.244e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=89 i=5 t=2.520e-04 per=1.259e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=89 i=6 t=2.620e-04 per=1.309e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=89 i=7 t=2.530e-04 per=1.264e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.059e+07
--- TIMING FOR sigma_tot : t_inter=1.876e-02 t_gemm=1.725e-01 t_reduction=1.753e-02 tot=2.088e-01 ---
 sigma_tot counter=89 i=0 t=2.131e-02 per=1.235e+01 cost=1.958e+05 flops=9.189e+06
 sigma_tot counter=89 i=1 t=2.158e-02 per=1.251e+01 cost=2.017e+05 flops=9.346e+06
 sigma_tot counter=89 i=2 t=2.128e-02 per=1.234e+01 cost=2.376e+05 flops=1.117e+07
 sigma_tot counter=89 i=3 t=2.117e-02 per=1.227e+01 cost=2.445e+05 flops=1.155e+07
 sigma_tot counter=89 i=4 t=2.155e-02 per=1.249e+01 cost=3.900e+05 flops=1.810e+07
 sigma_tot counter=89 i=5 t=2.162e-02 per=1.253e+01 cost=3.917e+05 flops=1.811e+07
 sigma_tot counter=89 i=6 t=2.234e-02 per=1.295e+01 cost=5.459e+05 flops=2.443e+07
 sigma_tot counter=89 i=7 t=2.169e-02 per=1.257e+01 cost=5.414e+05 flops=2.495e+07
 total GEMM cost=2.749e+06 flops=1.593e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.110e-04,1.997e-03,1.950e-04 cost=4.121e+04 flops[gemm]=2.064e+07
--- TIMING FOR sigma : t_inter=2.110e-04 t_gemm=1.996e-03 t_reduction=1.950e-04 tot=2.402e-03 ---
 sigma counter=90 i=0 t=2.420e-04 per=1.212e+01 cost=2.582e+03 flops=1.067e+07
 sigma counter=90 i=1 t=2.470e-04 per=1.237e+01 cost=2.572e+03 flops=1.041e+07
 sigma counter=90 i=2 t=2.450e-04 per=1.227e+01 cost=3.754e+03 flops=1.532e+07
 sigma counter=90 i=3 t=2.480e-04 per=1.242e+01 cost=3.774e+03 flops=1.522e+07
 sigma counter=90 i=4 t=2.490e-04 per=1.247e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=90 i=5 t=2.520e-04 per=1.263e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=90 i=6 t=2.600e-04 per=1.303e+01 cost=1.014e+04 flops=3.902e+07
 sigma counter=90 i=7 t=2.530e-04 per=1.268e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.065e+07
--- TIMING FOR sigma_tot : t_inter=1.897e-02 t_gemm=1.745e-01 t_reduction=1.773e-02 tot=2.112e-01 ---
 sigma_tot counter=90 i=0 t=2.155e-02 per=1.234e+01 cost=1.984e+05 flops=9.206e+06
 sigma_tot counter=90 i=1 t=2.183e-02 per=1.251e+01 cost=2.043e+05 flops=9.358e+06
 sigma_tot counter=90 i=2 t=2.153e-02 per=1.233e+01 cost=2.414e+05 flops=1.121e+07
 sigma_tot counter=90 i=3 t=2.142e-02 per=1.227e+01 cost=2.483e+05 flops=1.159e+07
 sigma_tot counter=90 i=4 t=2.180e-02 per=1.249e+01 cost=3.941e+05 flops=1.808e+07
 sigma_tot counter=90 i=5 t=2.188e-02 per=1.253e+01 cost=3.958e+05 flops=1.809e+07
 sigma_tot counter=90 i=6 t=2.260e-02 per=1.295e+01 cost=5.561e+05 flops=2.460e+07
 sigma_tot counter=90 i=7 t=2.195e-02 per=1.257e+01 cost=5.515e+05 flops=2.513e+07
 total GEMM cost=2.790e+06 flops=1.598e+07
    5   0 -      -2.654516771391 -1.106e-06  5.132e-04    6    10  2.644e-02 2.644e-03
    5   1 -      -2.436977369938 -2.914e-07  2.870e-04    6    10  2.644e-02 2.644e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.130e-04,2.035e-03,1.980e-04 cost=4.121e+04 flops[gemm]=2.025e+07
--- TIMING FOR sigma : t_inter=2.130e-04 t_gemm=2.035e-03 t_reduction=1.980e-04 tot=2.446e-03 ---
 sigma counter=91 i=0 t=2.410e-04 per=1.184e+01 cost=2.582e+03 flops=1.071e+07
 sigma counter=91 i=1 t=2.380e-04 per=1.170e+01 cost=2.572e+03 flops=1.081e+07
 sigma counter=91 i=2 t=2.500e-04 per=1.229e+01 cost=3.754e+03 flops=1.502e+07
 sigma counter=91 i=3 t=2.560e-04 per=1.258e+01 cost=3.774e+03 flops=1.474e+07
 sigma counter=91 i=4 t=2.570e-04 per=1.263e+01 cost=4.112e+03 flops=1.600e+07
 sigma counter=91 i=5 t=2.570e-04 per=1.263e+01 cost=4.132e+03 flops=1.608e+07
 sigma counter=91 i=6 t=2.780e-04 per=1.366e+01 cost=1.014e+04 flops=3.649e+07
 sigma counter=91 i=7 t=2.580e-04 per=1.268e+01 cost=1.014e+04 flops=3.932e+07
 total GEMM cost=4.121e+04 flops=2.025e+07
--- TIMING FOR sigma_tot : t_inter=1.918e-02 t_gemm=1.766e-01 t_reduction=1.793e-02 tot=2.137e-01 ---
 sigma_tot counter=91 i=0 t=2.179e-02 per=1.234e+01 cost=2.009e+05 flops=9.222e+06
 sigma_tot counter=91 i=1 t=2.207e-02 per=1.250e+01 cost=2.069e+05 flops=9.374e+06
 sigma_tot counter=91 i=2 t=2.178e-02 per=1.233e+01 cost=2.452e+05 flops=1.126e+07
 sigma_tot counter=91 i=3 t=2.167e-02 per=1.227e+01 cost=2.520e+05 flops=1.163e+07
 sigma_tot counter=91 i=4 t=2.205e-02 per=1.249e+01 cost=3.982e+05 flops=1.806e+07
 sigma_tot counter=91 i=5 t=2.213e-02 per=1.253e+01 cost=3.999e+05 flops=1.807e+07
 sigma_tot counter=91 i=6 t=2.288e-02 per=1.296e+01 cost=5.662e+05 flops=2.475e+07
 sigma_tot counter=91 i=7 t=2.221e-02 per=1.258e+01 cost=5.617e+05 flops=2.529e+07
 total GEMM cost=2.831e+06 flops=1.603e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.160e-04,2.007e-03,2.030e-04 cost=4.121e+04 flops[gemm]=2.054e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=2.007e-03 t_reduction=2.030e-04 tot=2.426e-03 ---
 sigma counter=92 i=0 t=2.410e-04 per=1.201e+01 cost=2.582e+03 flops=1.071e+07
 sigma counter=92 i=1 t=2.530e-04 per=1.261e+01 cost=2.572e+03 flops=1.017e+07
 sigma counter=92 i=2 t=2.490e-04 per=1.241e+01 cost=3.754e+03 flops=1.508e+07
 sigma counter=92 i=3 t=2.470e-04 per=1.231e+01 cost=3.774e+03 flops=1.528e+07
 sigma counter=92 i=4 t=2.510e-04 per=1.251e+01 cost=4.112e+03 flops=1.638e+07
 sigma counter=92 i=5 t=2.540e-04 per=1.266e+01 cost=4.132e+03 flops=1.627e+07
 sigma counter=92 i=6 t=2.600e-04 per=1.295e+01 cost=1.014e+04 flops=3.902e+07
 sigma counter=92 i=7 t=2.520e-04 per=1.256e+01 cost=1.014e+04 flops=4.025e+07
 total GEMM cost=4.121e+04 flops=2.054e+07
--- TIMING FOR sigma_tot : t_inter=1.940e-02 t_gemm=1.786e-01 t_reduction=1.813e-02 tot=2.161e-01 ---
 sigma_tot counter=92 i=0 t=2.203e-02 per=1.234e+01 cost=2.035e+05 flops=9.239e+06
 sigma_tot counter=92 i=1 t=2.232e-02 per=1.250e+01 cost=2.094e+05 flops=9.383e+06
 sigma_tot counter=92 i=2 t=2.203e-02 per=1.233e+01 cost=2.489e+05 flops=1.130e+07
 sigma_tot counter=92 i=3 t=2.192e-02 per=1.227e+01 cost=2.558e+05 flops=1.167e+07
 sigma_tot counter=92 i=4 t=2.230e-02 per=1.249e+01 cost=4.023e+05 flops=1.804e+07
 sigma_tot counter=92 i=5 t=2.239e-02 per=1.254e+01 cost=4.040e+05 flops=1.805e+07
 sigma_tot counter=92 i=6 t=2.314e-02 per=1.296e+01 cost=5.764e+05 flops=2.491e+07
 sigma_tot counter=92 i=7 t=2.246e-02 per=1.258e+01 cost=5.718e+05 flops=2.546e+07
 total GEMM cost=2.872e+06 flops=1.608e+07
    6   0 -      -2.654516945145 -1.738e-07  1.834e-04    6    12  3.173e-02 2.644e-03
    6   1 -      -2.436977443895 -7.396e-08  1.157e-04    6    12  3.173e-02 2.644e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.160e-04,2.005e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.056e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=2.005e-03 t_reduction=1.960e-04 tot=2.417e-03 ---
 sigma counter=93 i=0 t=2.400e-04 per=1.197e+01 cost=2.582e+03 flops=1.076e+07
 sigma counter=93 i=1 t=2.470e-04 per=1.232e+01 cost=2.572e+03 flops=1.041e+07
 sigma counter=93 i=2 t=2.510e-04 per=1.252e+01 cost=3.754e+03 flops=1.496e+07
 sigma counter=93 i=3 t=2.460e-04 per=1.227e+01 cost=3.774e+03 flops=1.534e+07
 sigma counter=93 i=4 t=2.490e-04 per=1.242e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=93 i=5 t=2.500e-04 per=1.247e+01 cost=4.132e+03 flops=1.653e+07
 sigma counter=93 i=6 t=2.660e-04 per=1.327e+01 cost=1.014e+04 flops=3.814e+07
 sigma counter=93 i=7 t=2.560e-04 per=1.277e+01 cost=1.014e+04 flops=3.962e+07
 total GEMM cost=4.121e+04 flops=2.056e+07
--- TIMING FOR sigma_tot : t_inter=1.961e-02 t_gemm=1.806e-01 t_reduction=1.833e-02 tot=2.185e-01 ---
 sigma_tot counter=93 i=0 t=2.227e-02 per=1.233e+01 cost=2.061e+05 flops=9.255e+06
 sigma_tot counter=93 i=1 t=2.257e-02 per=1.250e+01 cost=2.120e+05 flops=9.394e+06
 sigma_tot counter=93 i=2 t=2.228e-02 per=1.234e+01 cost=2.527e+05 flops=1.134e+07
 sigma_tot counter=93 i=3 t=2.216e-02 per=1.227e+01 cost=2.596e+05 flops=1.171e+07
 sigma_tot counter=93 i=4 t=2.255e-02 per=1.249e+01 cost=4.064e+05 flops=1.802e+07
 sigma_tot counter=93 i=5 t=2.264e-02 per=1.253e+01 cost=4.082e+05 flops=1.803e+07
 sigma_tot counter=93 i=6 t=2.341e-02 per=1.296e+01 cost=5.865e+05 flops=2.506e+07
 sigma_tot counter=93 i=7 t=2.271e-02 per=1.258e+01 cost=5.820e+05 flops=2.562e+07
 total GEMM cost=2.913e+06 flops=1.613e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.000e-05,2.080e-04,2.021e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.039e+07
--- TIMING FOR sigma : t_inter=2.080e-04 t_gemm=2.021e-03 t_reduction=1.960e-04 tot=2.425e-03 ---
 sigma counter=94 i=0 t=2.430e-04 per=1.202e+01 cost=2.582e+03 flops=1.063e+07
 sigma counter=94 i=1 t=2.350e-04 per=1.163e+01 cost=2.572e+03 flops=1.094e+07
 sigma counter=94 i=2 t=2.530e-04 per=1.252e+01 cost=3.754e+03 flops=1.484e+07
 sigma counter=94 i=3 t=2.510e-04 per=1.242e+01 cost=3.774e+03 flops=1.504e+07
 sigma counter=94 i=4 t=2.500e-04 per=1.237e+01 cost=4.112e+03 flops=1.645e+07
 sigma counter=94 i=5 t=2.590e-04 per=1.282e+01 cost=4.132e+03 flops=1.595e+07
 sigma counter=94 i=6 t=2.660e-04 per=1.316e+01 cost=1.014e+04 flops=3.814e+07
 sigma counter=94 i=7 t=2.640e-04 per=1.306e+01 cost=1.014e+04 flops=3.842e+07
 total GEMM cost=4.121e+04 flops=2.039e+07
--- TIMING FOR sigma_tot : t_inter=1.982e-02 t_gemm=1.826e-01 t_reduction=1.852e-02 tot=2.210e-01 ---
 sigma_tot counter=94 i=0 t=2.251e-02 per=1.233e+01 cost=2.087e+05 flops=9.270e+06
 sigma_tot counter=94 i=1 t=2.280e-02 per=1.249e+01 cost=2.146e+05 flops=9.410e+06
 sigma_tot counter=94 i=2 t=2.253e-02 per=1.234e+01 cost=2.564e+05 flops=1.138e+07
 sigma_tot counter=94 i=3 t=2.242e-02 per=1.228e+01 cost=2.634e+05 flops=1.175e+07
 sigma_tot counter=94 i=4 t=2.280e-02 per=1.249e+01 cost=4.105e+05 flops=1.800e+07
 sigma_tot counter=94 i=5 t=2.290e-02 per=1.254e+01 cost=4.123e+05 flops=1.801e+07
 sigma_tot counter=94 i=6 t=2.367e-02 per=1.296e+01 cost=5.966e+05 flops=2.520e+07
 sigma_tot counter=94 i=7 t=2.298e-02 per=1.258e+01 cost=5.921e+05 flops=2.577e+07
 total GEMM cost=2.955e+06 flops=1.618e+07
    7   0 +      -2.654516966639 -2.149e-08  4.644e-05    6    14  3.700e-02 2.643e-03
    7   1 +      -2.436977450693 -6.798e-09  2.690e-05    6    14  3.700e-02 2.643e-03
TIMING FOR Davidson : 3.702e-02  T(cal/comm/rest)=3.642e-02,4.926e-05,5.532e-04
optimized energies: isweep=1 dots=2 ibond=2 e[0]=-2.65451696664 nmvp=14
optimized energies: isweep=1 dots=2 ibond=2 e[1]=-2.43697745069 nmvp=14
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=9 alg_decim=1 mpisize=2 maxthreads=2
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
TIMING FOR decimation: 4.0e-04 S T(wf/decim)=3.2e-04,7.2e-05
ctns::oper_renorm coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=872:6.7e-03MB:6.5e-06GB
rank=0 GPUmem(GB): used=2.3e-05 (oper)=8.7e-06
rank=0 GPUmem(GB): used=2.3e-05 (oper,site)(GB)=8.7e-06,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 5.774e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=2.29e-05 (oper,site,rinter)=8.67e-06,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000977 S size(rtasks)=37 size(Rlst2)=9 T(Rmu/Rlist)=0.000198,0.000779 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00105 S size(rtasks)=37 size(Rlst)=788 -----
rank=0 GPUmem(GB): used=0.000217 (oper,site,rinter,batch)=8.67e-06,2.68e-07,0,0.000194 blksize=16 blksize0=0 batchsize=788
timing: allocate=3.64e-05 rmmtasks init=0.000919 total=0.000956
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=5e-06,0.00115,0.000197 cost=1.56e+04 flops[gemm]=1.36e+07
--- TIMING FOR renorm : t_inter=5e-06 t_gemm=0.00115 t_reduction=0.000197 tot=0.00135 ---
 renorm counter=7 i=0 t=0.000231 per=20.1 cost=874 flops=3.78e+06
 renorm counter=7 i=1 t=0.000229 per=20 cost=1.76e+03 flops=7.69e+06
 renorm counter=7 i=2 t=0.000218 per=19 cost=994 flops=4.56e+06
 renorm counter=7 i=3 t=0.000224 per=19.5 cost=1.75e+03 flops=7.81e+06
 renorm counter=7 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=7 i=5 t=1e-06 per=0.0872 cost=0 flops=0
 renorm counter=7 i=6 t=0.000244 per=21.3 cost=1.02e+04 flops=4.17e+07
 total GEMM cost=1.56e+04 flops=1.36e+07
--- TIMING FOR renorm_tot : t_inter=0.000649 t_gemm=0.008 t_reduction=0.00141 tot=0.0101 ---
 renorm_tot counter=7 i=0 t=0.00163 per=20.4 cost=1.07e+04 flops=6.55e+06
 renorm_tot counter=7 i=1 t=0.00157 per=19.7 cost=1.48e+04 flops=9.43e+06
 renorm_tot counter=7 i=2 t=0.000655 per=8.19 cost=4.36e+03 flops=6.66e+06
 renorm_tot counter=7 i=3 t=0.000661 per=8.26 cost=7.75e+03 flops=1.17e+07
 renorm_tot counter=7 i=4 t=0.000884 per=11 cost=1.42e+04 flops=1.61e+07
 renorm_tot counter=7 i=5 t=0.000906 per=11.3 cost=2.5e+04 flops=2.76e+07
 renorm_tot counter=7 i=6 t=0.00169 per=21.1 cost=1.18e+05 flops=6.95e+07
 total GEMM cost=1.95e+05 flops=2.43e+07
timing: gpu2cpu=1.49e-05 deallocate(site/work)=4.58e-06,7.35e-06 total=2.22e-05
check ||H-H.dagger||=0.000e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.00472 S T(init/kernel/comm)=0.000431,0.00422,6.74e-05 rank=0 -----
TIMING FOR cleanup: 0.000353 T(erase/save/remove)=9.14e-05,0.000224,3.74e-05
##### local: 5.303e-02 S #####
 T(local: fetch) = 1.403e-04 S  per = 0.265  per(accum) = 0.265
 T(local: hdiag) = 5.279e-04 S  per = 0.995  per(accum) = 1.26
 T(local: dvdsn) = 4.612e-02 S  per =   87  per(accum) = 88.2
 T(local: decim) = 4.892e-04 S  per = 0.922  per(accum) = 89.1
 T(local: guess) = 5.185e-04 S  per = 0.978  per(accum) = 90.1
 T(local: renrm) = 4.870e-03 S  per = 9.18  per(accum) = 99.3
 T(local: save ) = 3.666e-04 S  per = 0.691  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.504e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 1.995e-05 S  per = 0.0443  per(accum) = 0.0443
 T(local: symbolic_formulae_twodot     ) = 6.449e-04 S  per = 1.43  per(accum) = 1.48
 T(local: hintermediate init           ) = 5.767e-05 S  per = 0.128  per(accum) = 1.6
 T(local: hintermediates memcpy cpu2gpu) = 2.700e-08 S  per = 5.99e-05  per(accum) = 1.6
 T(local: preprocess_hformulae_Hxlist2 ) = 3.670e-03 S  per = 8.15  per(accum) = 9.75
 T(local: hmmtasks init                ) = 3.629e-03 S  per = 8.06  per(accum) = 17.8
 T(local: dvdson solver [Hx_batchGPU]  ) = 3.642e-02 S  per = 80.9  per(accum) = 98.7
 T(local: dvdson solver [communication]) = 4.926e-05 S  per = 0.109  per(accum) = 98.8
 T(local: dvdson solver [rest part]    ) = 5.532e-04 S  per = 1.23  per(accum) = 100
Detailed decomposition of T(renrm): 4.722e-03 S
 T(local: qops init                    ) = 4.310e-04 S  per = 9.13  per(accum) = 9.13
 T(local: qops_dict memcpy cpu2gpu     ) = 4.501e-05 S  per = 0.953  per(accum) = 10.1
 T(local: symbolic_formulae_renorm     ) = 5.869e-04 S  per = 12.4  per(accum) = 22.5
 T(local: rintermediate init           ) = 2.755e-05 S  per = 0.583  per(accum) = 23.1
 T(local: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000593  per(accum) = 23.1
 T(local: preprocess_formulae_Rlist2   ) = 1.077e-03 S  per = 22.8  per(accum) = 45.9
 T(local: rmmtasks init                ) = 9.646e-04 S  per = 20.4  per(accum) = 66.3
 T(local: qops memset                  ) = 2.900e-08 S  per = 0.000614  per(accum) = 66.3
 T(local: preprocess_renorm_batchGPU   ) = 1.466e-03 S  per = 31.1  per(accum) = 97.4
 T(local: qops memcpy gpu2cpu          ) = 1.492e-05 S  per = 0.316  per(accum) = 97.7
 T(local: deallocate gpu memory        ) = 4.178e-05 S  per = 0.885  per(accum) = 98.6
 T(local: communication of opS and opH ) = 6.739e-05 S  per = 1.43  per(accum) = 100
##### sweep: 1.583e-01 S #####
 T(sweep: fetch) = 1.337e-03 S  per = 0.845  per(accum) = 0.845
 T(sweep: hdiag) = 1.532e-03 S  per = 0.968  per(accum) = 1.81
 T(sweep: dvdsn) = 1.359e-01 S  per = 85.9  per(accum) = 87.7
 T(sweep: decim) = 2.049e-03 S  per = 1.29  per(accum) = 89
 T(sweep: guess) = 1.293e-03 S  per = 0.817  per(accum) = 89.8
 T(sweep: renrm) = 1.516e-02 S  per = 9.58  per(accum) = 99.4
 T(sweep: save ) = 9.569e-04 S  per = 0.605  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.330e-01 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 3.877e-05 S  per = 0.0292  per(accum) = 0.0292
 T(sweep: symbolic_formulae_twodot     ) = 2.023e-03 S  per = 1.52  per(accum) = 1.55
 T(sweep: hintermediate init           ) = 1.780e-04 S  per = 0.134  per(accum) = 1.68
 T(sweep: hintermediates memcpy cpu2gpu) = 8.700e-08 S  per = 6.54e-05  per(accum) = 1.68
 T(sweep: preprocess_hformulae_Hxlist2 ) = 9.936e-03 S  per = 7.47  per(accum) = 9.16
 T(sweep: hmmtasks init                ) = 9.496e-03 S  per = 7.14  per(accum) = 16.3
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 1.094e-01 S  per = 82.3  per(accum) = 98.6
 T(sweep: dvdson solver [communication]) = 1.469e-04 S  per = 0.11  per(accum) = 98.7
 T(sweep: dvdson solver [rest part]    ) = 1.694e-03 S  per = 1.27  per(accum) = 100
Detailed decomposition of T(renrm): 1.470e-02 S
 T(sweep: qops init                    ) = 1.184e-03 S  per = 8.05  per(accum) = 8.05
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.359e-04 S  per = 0.924  per(accum) = 8.98
 T(sweep: symbolic_formulae_renorm     ) = 1.664e-03 S  per = 11.3  per(accum) = 20.3
 T(sweep: rintermediate init           ) = 1.251e-04 S  per = 0.851  per(accum) = 21.1
 T(sweep: rintermediates memcpy cpu2gpu) = 8.500e-08 S  per = 0.000578  per(accum) = 21.1
 T(sweep: preprocess_formulae_Rlist2   ) = 3.296e-03 S  per = 22.4  per(accum) = 43.6
 T(sweep: rmmtasks init                ) = 3.220e-03 S  per = 21.9  per(accum) = 65.5
 T(sweep: qops memset                  ) = 8.600e-08 S  per = 0.000585  per(accum) = 65.5
 T(sweep: preprocess_renorm_batchGPU   ) = 4.707e-03 S  per =   32  per(accum) = 97.5
 T(sweep: qops memcpy gpu2cpu          ) = 4.762e-05 S  per = 0.324  per(accum) = 97.8
 T(sweep: deallocate gpu memory        ) = 1.178e-04 S  per = 0.801  per(accum) = 98.6
 T(sweep: communication of opS and opH ) = 2.029e-04 S  per = 1.38  per(accum) = 100
##### global: 3.497e-01 S #####
 T(global: fetch) = 5.466e-03 S  per = 1.56  per(accum) = 1.56
 T(global: hdiag) = 4.081e-03 S  per = 1.17  per(accum) = 2.73
 T(global: dvdsn) = 2.975e-01 S  per = 85.1  per(accum) = 87.8
 T(global: decim) = 6.302e-03 S  per =  1.8  per(accum) = 89.6
 T(global: guess) = 2.768e-03 S  per = 0.792  per(accum) = 90.4
 T(global: renrm) = 3.146e-02 S  per =    9  per(accum) = 99.4
 T(global: save ) = 2.042e-03 S  per = 0.584  per(accum) = 100
Detailed decomposition of T(dvdsn): 2.910e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 8.538e-05 S  per = 0.0293  per(accum) = 0.0293
 T(global: symbolic_formulae_twodot     ) = 4.640e-03 S  per = 1.59  per(accum) = 1.62
 T(global: hintermediate init           ) = 4.057e-04 S  per = 0.139  per(accum) = 1.76
 T(global: hintermediates memcpy cpu2gpu) = 2.010e-07 S  per = 6.91e-05  per(accum) = 1.76
 T(global: preprocess_hformulae_Hxlist2 ) = 2.213e-02 S  per =  7.6  per(accum) = 9.37
 T(global: hmmtasks init                ) = 2.158e-02 S  per = 7.42  per(accum) = 16.8
 T(global: dvdson solver [Hx_batchGPU]  ) = 2.379e-01 S  per = 81.8  per(accum) = 98.5
 T(global: dvdson solver [communication]) = 3.295e-04 S  per = 0.113  per(accum) = 98.6
 T(global: dvdson solver [rest part]    ) = 3.938e-03 S  per = 1.35  per(accum) = 100
Detailed decomposition of T(renrm): 3.051e-02 S
 T(global: qops init                    ) = 2.304e-03 S  per = 7.55  per(accum) = 7.55
 T(global: qops_dict memcpy cpu2gpu     ) = 3.016e-04 S  per = 0.989  per(accum) = 8.54
 T(global: symbolic_formulae_renorm     ) = 3.841e-03 S  per = 12.6  per(accum) = 21.1
 T(global: rintermediate init           ) = 3.100e-04 S  per = 1.02  per(accum) = 22.1
 T(global: rintermediates memcpy cpu2gpu) = 1.990e-07 S  per = 0.000652  per(accum) = 22.1
 T(global: preprocess_formulae_Rlist2   ) = 6.251e-03 S  per = 20.5  per(accum) = 42.6
 T(global: rmmtasks init                ) = 5.791e-03 S  per =   19  per(accum) = 61.6
 T(global: qops memset                  ) = 1.960e-07 S  per = 0.000642  per(accum) = 61.6
 T(global: preprocess_renorm_batchGPU   ) = 1.089e-02 S  per = 35.7  per(accum) = 97.3
 T(global: qops memcpy gpu2cpu          ) = 1.054e-04 S  per = 0.345  per(accum) = 97.7
 T(global: deallocate gpu memory        ) = 2.705e-04 S  per = 0.886  per(accum) = 98.5
 T(global: communication of opS and opH ) = 4.429e-04 S  per = 1.45  per(accum) = 100

isweep=1 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=872:0.00665MB:6.5e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1310:0.00999MB:9.76e-06GB
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x451457d0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
### DIAG TIMING: total=0.00036 t1=7.6e-06, t2=1.44e-05, t3=4.81e-05, t4=0.000185, t5=6.09e-05, t6=2.92e-05, t7=1.26e-05, t8=2.55e-06
duration_diagGPU:0.000374
duration_diagreduce:3.99e-06
duration_diagtransform:1.8e-06
rank=0 GPUmem(GB): used=9.76e-06 (oper)=9.76e-06
----- TIMING FOR symbolic_formulae_twodot with size=93 : 6.267e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=93
 no. of hintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.592e-05 S -----
rank=0 GPUmem(GB): used=1.01e-05 (oper,hinter)=9.76e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00343 S size(H_formulae)=93 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000182,0.00325 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00369 S size(H_formulae)=93 size(Hxlst)=3134 -----
rank=0 GPUmem(GB): used=0.000409 (oper,hinter,dvdson,batch)=9.76e-06,2.98e-07,1.49e-06,0.000397 blksize=4 blksize0=8 batchsize=3134
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.3e-05,0.00022,0.00205,0.000199 cost=4.22e+04 flops[gemm]=2.05e+07
--- TIMING FOR sigma : t_inter=0.00022 t_gemm=0.00205 t_reduction=0.000199 tot=0.00247 ---
 sigma counter=95 i=0 t=0.000259 per=12.6 cost=3.72e+03 flops=1.43e+07
 sigma counter=95 i=1 t=0.000258 per=12.6 cost=3.74e+03 flops=1.45e+07
 sigma counter=95 i=2 t=0.000243 per=11.8 cost=3.04e+03 flops=1.25e+07
 sigma counter=95 i=3 t=0.000242 per=11.8 cost=3.03e+03 flops=1.25e+07
 sigma counter=95 i=4 t=0.000257 per=12.5 cost=1e+04 flops=3.89e+07
 sigma counter=95 i=5 t=0.000266 per=13 cost=1e+04 flops=3.76e+07
 sigma counter=95 i=6 t=0.000274 per=13.4 cost=4.34e+03 flops=1.58e+07
 sigma counter=95 i=7 t=0.000253 per=12.3 cost=4.32e+03 flops=1.71e+07
 total GEMM cost=4.22e+04 flops=2.05e+07
--- TIMING FOR sigma_tot : t_inter=0.02 t_gemm=0.185 t_reduction=0.0187 tot=0.223 ---
 sigma_tot counter=95 i=0 t=0.0228 per=12.3 cost=2.12e+05 flops=9.33e+06
 sigma_tot counter=95 i=1 t=0.0231 per=12.5 cost=2.18e+05 flops=9.47e+06
 sigma_tot counter=95 i=2 t=0.0228 per=12.3 cost=2.59e+05 flops=1.14e+07
 sigma_tot counter=95 i=3 t=0.0227 per=12.3 cost=2.66e+05 flops=1.18e+07
 sigma_tot counter=95 i=4 t=0.0231 per=12.5 cost=4.21e+05 flops=1.82e+07
 sigma_tot counter=95 i=5 t=0.0232 per=12.5 cost=4.22e+05 flops=1.82e+07
 sigma_tot counter=95 i=6 t=0.0239 per=13 cost=6.01e+05 flops=2.51e+07
 sigma_tot counter=95 i=7 t=0.0232 per=12.6 cost=5.96e+05 flops=2.57e+07
 total GEMM cost=3e+06 flops=1.62e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000213,0.00203,0.000198 cost=4.22e+04 flops[gemm]=2.08e+07
--- TIMING FOR sigma : t_inter=0.000213 t_gemm=0.00203 t_reduction=0.000198 tot=0.00244 ---
 sigma counter=96 i=0 t=0.000253 per=12.5 cost=3.72e+03 flops=1.47e+07
 sigma counter=96 i=1 t=0.000252 per=12.4 cost=3.74e+03 flops=1.48e+07
 sigma counter=96 i=2 t=0.000247 per=12.2 cost=3.04e+03 flops=1.23e+07
 sigma counter=96 i=3 t=0.000252 per=12.4 cost=3.03e+03 flops=1.2e+07
 sigma counter=96 i=4 t=0.000253 per=12.5 cost=1e+04 flops=3.95e+07
 sigma counter=96 i=5 t=0.000257 per=12.7 cost=1e+04 flops=3.89e+07
 sigma counter=96 i=6 t=0.000262 per=12.9 cost=4.34e+03 flops=1.65e+07
 sigma counter=96 i=7 t=0.000252 per=12.4 cost=4.32e+03 flops=1.71e+07
 total GEMM cost=4.22e+04 flops=2.08e+07
--- TIMING FOR sigma_tot : t_inter=0.0203 t_gemm=0.187 t_reduction=0.0189 tot=0.226 ---
 sigma_tot counter=96 i=0 t=0.023 per=12.3 cost=2.16e+05 flops=9.39e+06
 sigma_tot counter=96 i=1 t=0.0233 per=12.5 cost=2.22e+05 flops=9.52e+06
 sigma_tot counter=96 i=2 t=0.023 per=12.3 cost=2.62e+05 flops=1.14e+07
 sigma_tot counter=96 i=3 t=0.0229 per=12.3 cost=2.69e+05 flops=1.18e+07
 sigma_tot counter=96 i=4 t=0.0233 per=12.5 cost=4.31e+05 flops=1.85e+07
 sigma_tot counter=96 i=5 t=0.0234 per=12.5 cost=4.32e+05 flops=1.85e+07
 sigma_tot counter=96 i=6 t=0.0242 per=13 cost=6.05e+05 flops=2.5e+07
 sigma_tot counter=96 i=7 t=0.0235 per=12.6 cost=6.01e+05 flops=2.56e+07
 total GEMM cost=3.04e+06 flops=1.63e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966639 -1.003e+03  4.644e-05    2     2  5.334e-03 2.667e-03
    1   1 +      -2.436977450693 -1.002e+03  2.690e-05    2     2  5.334e-03 2.667e-03
TIMING FOR Davidson : 5.380e-03  T(cal/comm/rest)=5.280e-03,7.414e-06,9.253e-05
optimized energies: isweep=1 dots=2 ibond=3 e[0]=-2.65451696664 nmvp=2
optimized energies: isweep=1 dots=2 ibond=3 e[1]=-2.43697745069 nmvp=2
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=16 alg_decim=1 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep1_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
----- TMING FOR decimation_genbasis: 3.8e-04 S T(scatter/comp/gather)=3.6e-05,3.8e-05,3.0e-04 -----
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
 qbond: qkept nsym=6 dimAll=20
 (3,1):6 (2,0):4 (4,0):3 (2,2):3 (3,-1):2 (1,1):2
----- TIMING for decimation_row: 6.991e-04 S T(decim/formRot)=4.573e-04,2.417e-04 -----
TIMING FOR decimation: 1.072e-03 S T(wf/decim)=3.424e-04,7.292e-04
ctns::oper_renorm coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:6 A:7 B:11 P:3 Q:5 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=1612:1.230e-02MB:1.201e-05GB
rank=0 GPUmem(GB): used=2.207e-05 (oper)=1.960e-05
rank=0 GPUmem(GB): used=2.319e-05 (oper,site)(GB)=1.960e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=37 : 4.695e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 5.092e-05 S -----
rank=0 GPUmem(GB): used=2.35e-05 (oper,site,rinter)=1.96e-05,1.12e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000956 S size(rtasks)=37 size(Rlst2)=6 T(Rmu/Rlist)=0.000157,0.000799 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00103 S size(rtasks)=37 size(Rlst)=821 -----
rank=0 GPUmem(GB): used=0.000519 (oper,site,rinter,batch)=1.96e-05,1.12e-06,2.98e-07,0.000495 blksize=36 blksize0=8 batchsize=821
timing: allocate=3.42e-05 rmmtasks init=0.000987 total=0.00102
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000208,0.00115,0.000195 cost=8.44e+04 flops[gemm]=7.36e+07
--- TIMING FOR renorm : t_inter=0.000208 t_gemm=0.00115 t_reduction=0.000195 tot=0.00155 ---
 renorm counter=8 i=0 t=0.000227 per=19.8 cost=3.06e+03 flops=1.35e+07
 renorm counter=8 i=1 t=0.000229 per=20 cost=5.92e+03 flops=2.58e+07
 renorm counter=8 i=2 t=0.000221 per=19.3 cost=9.23e+03 flops=4.18e+07
 renorm counter=8 i=3 t=0.000227 per=19.8 cost=1.58e+04 flops=6.98e+07
 renorm counter=8 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=8 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=8 i=6 t=0.000242 per=21.1 cost=5.03e+04 flops=2.08e+08
 total GEMM cost=8.44e+04 flops=7.36e+07
--- TIMING FOR renorm_tot : t_inter=0.000857 t_gemm=0.00915 t_reduction=0.0016 tot=0.0116 ---
 renorm_tot counter=8 i=0 t=0.00186 per=20.3 cost=1.37e+04 flops=7.4e+06
 renorm_tot counter=8 i=1 t=0.0018 per=19.7 cost=2.08e+04 flops=1.15e+07
 renorm_tot counter=8 i=2 t=0.000876 per=9.58 cost=1.36e+04 flops=1.55e+07
 renorm_tot counter=8 i=3 t=0.000888 per=9.71 cost=2.36e+04 flops=2.66e+07
 renorm_tot counter=8 i=4 t=0.000884 per=9.66 cost=1.42e+04 flops=1.61e+07
 renorm_tot counter=8 i=5 t=0.000906 per=9.9 cost=2.5e+04 flops=2.76e+07
 renorm_tot counter=8 i=6 t=0.00193 per=21.1 cost=1.68e+05 flops=8.69e+07
 total GEMM cost=2.79e+05 flops=3.05e+07
timing: gpu2cpu=1.66e-05 deallocate(site/work)=3.46e-06,6.25e-06 total=2.28e-05
check ||H-H.dagger||=1.073e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00477 S T(init/kernel/comm)=0.000314,0.00439,6.26e-05 rank=0 -----
TIMING FOR cleanup: 0.000213 T(erase/save/remove)=3.88e-06,0.000173,3.55e-05
##### local: 2.330e-02 S #####
 T(local: fetch) = 1.046e-03 S  per = 4.49  per(accum) = 4.49
 T(local: hdiag) = 4.958e-04 S  per = 2.13  per(accum) = 6.62
 T(local: dvdsn) = 1.497e-02 S  per = 64.2  per(accum) = 70.9
 T(local: decim) = 1.220e-03 S  per = 5.24  per(accum) = 76.1
 T(local: guess) = 4.180e-04 S  per = 1.79  per(accum) = 77.9
 T(local: renrm) = 4.925e-03 S  per = 21.1  per(accum) = 99
 T(local: save ) = 2.251e-04 S  per = 0.966  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.376e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 1.730e-05 S  per = 0.126  per(accum) = 0.126
 T(local: symbolic_formulae_twodot     ) = 6.372e-04 S  per = 4.63  per(accum) = 4.76
 T(local: hintermediate init           ) = 5.845e-05 S  per = 0.425  per(accum) = 5.18
 T(local: hintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000203  per(accum) = 5.18
 T(local: preprocess_hformulae_Hxlist2 ) = 3.797e-03 S  per = 27.6  per(accum) = 32.8
 T(local: hmmtasks init                ) = 3.874e-03 S  per = 28.1  per(accum) = 60.9
 T(local: dvdson solver [Hx_batchGPU]  ) = 5.280e-03 S  per = 38.4  per(accum) = 99.3
 T(local: dvdson solver [communication]) = 7.414e-06 S  per = 0.0539  per(accum) = 99.3
 T(local: dvdson solver [rest part]    ) = 9.253e-05 S  per = 0.672  per(accum) = 100
Detailed decomposition of T(renrm): 4.767e-03 S
 T(local: qops init                    ) = 3.140e-04 S  per = 6.59  per(accum) = 6.59
 T(local: qops_dict memcpy cpu2gpu     ) = 4.483e-05 S  per = 0.94  per(accum) = 7.53
 T(local: symbolic_formulae_renorm     ) = 4.796e-04 S  per = 10.1  per(accum) = 17.6
 T(local: rintermediate init           ) = 6.312e-05 S  per = 1.32  per(accum) = 18.9
 T(local: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000587  per(accum) = 18.9
 T(local: preprocess_formulae_Rlist2   ) = 1.059e-03 S  per = 22.2  per(accum) = 41.1
 T(local: rmmtasks init                ) = 1.030e-03 S  per = 21.6  per(accum) = 62.7
 T(local: qops memset                  ) = 2.800e-08 S  per = 0.000587  per(accum) = 62.7
 T(local: preprocess_renorm_batchGPU   ) = 1.663e-03 S  per = 34.9  per(accum) = 97.6
 T(local: qops memcpy gpu2cpu          ) = 1.663e-05 S  per = 0.349  per(accum) = 98
 T(local: deallocate gpu memory        ) = 3.349e-05 S  per = 0.703  per(accum) = 98.7
 T(local: communication of opS and opH ) = 6.264e-05 S  per = 1.31  per(accum) = 100
##### sweep: 1.816e-01 S #####
 T(sweep: fetch) = 2.382e-03 S  per = 1.31  per(accum) = 1.31
 T(sweep: hdiag) = 2.027e-03 S  per = 1.12  per(accum) = 2.43
 T(sweep: dvdsn) = 1.509e-01 S  per = 83.1  per(accum) = 85.5
 T(sweep: decim) = 3.269e-03 S  per =  1.8  per(accum) = 87.3
 T(sweep: guess) = 1.711e-03 S  per = 0.942  per(accum) = 88.3
 T(sweep: renrm) = 2.008e-02 S  per = 11.1  per(accum) = 99.3
 T(sweep: save ) = 1.182e-03 S  per = 0.651  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.467e-01 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 5.607e-05 S  per = 0.0382  per(accum) = 0.0382
 T(sweep: symbolic_formulae_twodot     ) = 2.660e-03 S  per = 1.81  per(accum) = 1.85
 T(sweep: hintermediate init           ) = 2.364e-04 S  per = 0.161  per(accum) = 2.01
 T(sweep: hintermediates memcpy cpu2gpu) = 1.150e-07 S  per = 7.84e-05  per(accum) = 2.01
 T(sweep: preprocess_hformulae_Hxlist2 ) = 1.373e-02 S  per = 9.36  per(accum) = 11.4
 T(sweep: hmmtasks init                ) = 1.337e-02 S  per = 9.11  per(accum) = 20.5
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 1.147e-01 S  per = 78.2  per(accum) = 98.7
 T(sweep: dvdson solver [communication]) = 1.543e-04 S  per = 0.105  per(accum) = 98.8
 T(sweep: dvdson solver [rest part]    ) = 1.787e-03 S  per = 1.22  per(accum) = 100
Detailed decomposition of T(renrm): 1.947e-02 S
 T(sweep: qops init                    ) = 1.497e-03 S  per = 7.69  per(accum) = 7.69
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.807e-04 S  per = 0.928  per(accum) = 8.62
 T(sweep: symbolic_formulae_renorm     ) = 2.143e-03 S  per =   11  per(accum) = 19.6
 T(sweep: rintermediate init           ) = 1.883e-04 S  per = 0.967  per(accum) = 20.6
 T(sweep: rintermediates memcpy cpu2gpu) = 1.130e-07 S  per = 0.00058  per(accum) = 20.6
 T(sweep: preprocess_formulae_Rlist2   ) = 4.355e-03 S  per = 22.4  per(accum) = 43
 T(sweep: rmmtasks init                ) = 4.250e-03 S  per = 21.8  per(accum) = 64.8
 T(sweep: qops memset                  ) = 1.140e-07 S  per = 0.000586  per(accum) = 64.8
 T(sweep: preprocess_renorm_batchGPU   ) = 6.370e-03 S  per = 32.7  per(accum) = 97.5
 T(sweep: qops memcpy gpu2cpu          ) = 6.425e-05 S  per = 0.33  per(accum) = 97.9
 T(sweep: deallocate gpu memory        ) = 1.513e-04 S  per = 0.777  per(accum) = 98.6
 T(sweep: communication of opS and opH ) = 2.655e-04 S  per = 1.36  per(accum) = 100
##### global: 3.730e-01 S #####
 T(global: fetch) = 6.512e-03 S  per = 1.75  per(accum) = 1.75
 T(global: hdiag) = 4.577e-03 S  per = 1.23  per(accum) = 2.97
 T(global: dvdsn) = 3.125e-01 S  per = 83.8  per(accum) = 86.8
 T(global: decim) = 7.522e-03 S  per = 2.02  per(accum) = 88.8
 T(global: guess) = 3.186e-03 S  per = 0.854  per(accum) = 89.6
 T(global: renrm) = 3.638e-02 S  per = 9.76  per(accum) = 99.4
 T(global: save ) = 2.267e-03 S  per = 0.608  per(accum) = 100
Detailed decomposition of T(dvdsn): 3.048e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 1.027e-04 S  per = 0.0337  per(accum) = 0.0337
 T(global: symbolic_formulae_twodot     ) = 5.277e-03 S  per = 1.73  per(accum) = 1.77
 T(global: hintermediate init           ) = 4.641e-04 S  per = 0.152  per(accum) = 1.92
 T(global: hintermediates memcpy cpu2gpu) = 2.290e-07 S  per = 7.51e-05  per(accum) = 1.92
 T(global: preprocess_hformulae_Hxlist2 ) = 2.592e-02 S  per = 8.51  per(accum) = 10.4
 T(global: hmmtasks init                ) = 2.546e-02 S  per = 8.35  per(accum) = 18.8
 T(global: dvdson solver [Hx_batchGPU]  ) = 2.432e-01 S  per = 79.8  per(accum) = 98.6
 T(global: dvdson solver [communication]) = 3.369e-04 S  per = 0.111  per(accum) = 98.7
 T(global: dvdson solver [rest part]    ) = 4.031e-03 S  per = 1.32  per(accum) = 100
Detailed decomposition of T(renrm): 3.528e-02 S
 T(global: qops init                    ) = 2.618e-03 S  per = 7.42  per(accum) = 7.42
 T(global: qops_dict memcpy cpu2gpu     ) = 3.465e-04 S  per = 0.982  per(accum) = 8.4
 T(global: symbolic_formulae_renorm     ) = 4.320e-03 S  per = 12.2  per(accum) = 20.7
 T(global: rintermediate init           ) = 3.731e-04 S  per = 1.06  per(accum) = 21.7
 T(global: rintermediates memcpy cpu2gpu) = 2.270e-07 S  per = 0.000643  per(accum) = 21.7
 T(global: preprocess_formulae_Rlist2   ) = 7.310e-03 S  per = 20.7  per(accum) = 42.4
 T(global: rmmtasks init                ) = 6.821e-03 S  per = 19.3  per(accum) = 61.8
 T(global: qops memset                  ) = 2.240e-07 S  per = 0.000635  per(accum) = 61.8
 T(global: preprocess_renorm_batchGPU   ) = 1.256e-02 S  per = 35.6  per(accum) = 97.4
 T(global: qops memcpy gpu2cpu          ) = 1.220e-04 S  per = 0.346  per(accum) = 97.7
 T(global: deallocate gpu memory        ) = 3.039e-04 S  per = 0.862  per(accum) = 98.6
 T(global: communication of opS and opH ) = 5.055e-04 S  per = 1.43  per(accum) = 100

======================================================================
sweep_data::summary isweep=1
----------------------------------------------------------------------
sweep parameters: isweep=1 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=15 e[0]=-2.65208108725 e[1]=-2.43068987639 t=0.0507
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=14 e[0]=-2.65451696721 e[1]=-2.43697744778 t=0.0546
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.053
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.0233
 eav_max=-2.54138548182 [ibond=0]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=2]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=0.00436172684617
 sweep energies: isweep=1 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[0]=-2.65451696664
 sweep energies: isweep=1 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=1
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.000e-04 1.000e-04 | 51 | 1.940e-01 | 1.940e-01 | 1.116e-02 1.028e-01 1.083e-02 1.248e-01 64.4
            1  2      20 1.000e-04 0.000e+00 | 45 | 1.842e-01 | 3.782e-01 | 2.111e-02 1.958e-01 2.052e-02 2.375e-01 62.8
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.505e-03 e[0]=-2.65208108952 (2.436e-03) e[1]=-2.43068987874 (6.288e-03)
            1      20 +0.000e+00 e[0]=-2.65451696664 (0.000e+00) e[1]=-2.43697745069 (0.000e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep1.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row_nkr dcut=8 nqr=12 alg_decim=0 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep1_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
----- TMING FOR decimation_genbasis: 5.336e-05 S T(scatter/comp/gather)=6.108e-06,4.302e-05,4.238e-06 -----
decimation summary: 80->8 dwt=-2.220e-16 SvN=1.326e+00
 qbond: qkept nsym=4 dimAll=8
 (3,1):2 (4,0):2 (5,1):2 (4,2):2
----- TIMING for decimation_row: 3.220e-04 S T(decim/formRot)=1.168e-04,2.052e-04 -----

Convert [C]RRR => [cR]RRR:
ctns::decimation_row_nkr dcut=2 nqr=9 alg_decim=0 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep1_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
----- TMING FOR decimation_genbasis: 2.848e-05 S T(scatter/comp/gather)=4.325e-06,2.206e-05,2.087e-06 -----
decimation summary: 32->2 dwt=+1.110e-16 SvN=1.000e+00
 qbond: qkept nsym=1 dimAll=2
 (5,1):2
----- TIMING for decimation_row: 2.259e-04 S T(decim/formRot)=8.283e-05,1.430e-04 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep1.info

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.000e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.000e+00
 idx=2 node=(2,0) Drow=20 maxdiff=1.563e-15
 idx=3 node=(1,0) Drow=8 maxdiff=5.023e-16
 idx=4 node=(0,0) Drow=2 maxdiff=4.466e-16
stensor2: wf2 own=1 _data=0x44a41f20
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.052e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x44a41f20
     -1.0000e+00       3.6949e-17 
     -4.6335e-17       1.0000e+00 
 rwfuns: nroots=2 maxdiff=9.9997e-16
----- TIMING FOR ctns::rcanon_check : 2.146e-04 S -----
..... end of isweep = 1 .....

======================================================================
sweep parameters: isweep=2 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB

isweep=2 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=872:0.00665MB:6.5e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1310:0.00999MB:9.76e-06GB
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44e239c0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
### DIAG TIMING: total=0.000404 t1=1.68e-05, t2=2.11e-05, t3=5.52e-05, t4=0.000192, t5=7.42e-05, t6=2.91e-05, t7=1.35e-05, t8=2.86e-06
duration_diagGPU:0.00042
duration_diagreduce:4.4e-06
duration_diagtransform:1.85e-06
rank=0 GPUmem(GB): used=2.18e-05 (oper)=9.76e-06
----- TIMING FOR symbolic_formulae_twodot with size=93 : 6.967e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=93
 no. of hintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.758e-05 S -----
rank=0 GPUmem(GB): used=2.21e-05 (oper,hinter)=9.76e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00359 S size(H_formulae)=93 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000199,0.00339 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00385 S size(H_formulae)=93 size(Hxlst)=3134 -----
rank=0 GPUmem(GB): used=0.000421 (oper,hinter,dvdson,batch)=9.76e-06,2.98e-07,1.49e-06,0.000397 blksize=4 blksize0=8 batchsize=3134
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.3e-05,0.00022,0.00203,0.000197 cost=4.22e+04 flops[gemm]=2.08e+07
--- TIMING FOR sigma : t_inter=0.00022 t_gemm=0.00203 t_reduction=0.000197 tot=0.00245 ---
 sigma counter=97 i=0 t=0.000262 per=12.9 cost=3.72e+03 flops=1.42e+07
 sigma counter=97 i=1 t=0.000258 per=12.7 cost=3.74e+03 flops=1.45e+07
 sigma counter=97 i=2 t=0.000241 per=11.9 cost=3.04e+03 flops=1.26e+07
 sigma counter=97 i=3 t=0.00024 per=11.8 cost=3.03e+03 flops=1.26e+07
 sigma counter=97 i=4 t=0.000258 per=12.7 cost=1e+04 flops=3.88e+07
 sigma counter=97 i=5 t=0.00026 per=12.8 cost=1e+04 flops=3.85e+07
 sigma counter=97 i=6 t=0.00026 per=12.8 cost=4.34e+03 flops=1.67e+07
 sigma counter=97 i=7 t=0.000251 per=12.4 cost=4.32e+03 flops=1.72e+07
 total GEMM cost=4.22e+04 flops=2.08e+07
--- TIMING FOR sigma_tot : t_inter=0.0205 t_gemm=0.189 t_reduction=0.0191 tot=0.228 ---
 sigma_tot counter=97 i=0 t=0.0233 per=12.3 cost=2.2e+05 flops=9.44e+06
 sigma_tot counter=97 i=1 t=0.0236 per=12.5 cost=2.26e+05 flops=9.58e+06
 sigma_tot counter=97 i=2 t=0.0233 per=12.3 cost=2.66e+05 flops=1.14e+07
 sigma_tot counter=97 i=3 t=0.0231 per=12.3 cost=2.72e+05 flops=1.18e+07
 sigma_tot counter=97 i=4 t=0.0236 per=12.5 cost=4.41e+05 flops=1.87e+07
 sigma_tot counter=97 i=5 t=0.0237 per=12.5 cost=4.42e+05 flops=1.87e+07
 sigma_tot counter=97 i=6 t=0.0245 per=13 cost=6.1e+05 flops=2.49e+07
 sigma_tot counter=97 i=7 t=0.0237 per=12.6 cost=6.05e+05 flops=2.55e+07
 total GEMM cost=3.08e+06 flops=1.63e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.1e-05,0.000213,0.00201,0.000197 cost=4.22e+04 flops[gemm]=2.09e+07
--- TIMING FOR sigma : t_inter=0.000213 t_gemm=0.00201 t_reduction=0.000195 tot=0.00242 ---
 sigma counter=98 i=0 t=0.000255 per=12.7 cost=3.72e+03 flops=1.46e+07
 sigma counter=98 i=1 t=0.000254 per=12.6 cost=3.74e+03 flops=1.47e+07
 sigma counter=98 i=2 t=0.00024 per=11.9 cost=3.04e+03 flops=1.26e+07
 sigma counter=98 i=3 t=0.000239 per=11.9 cost=3.03e+03 flops=1.27e+07
 sigma counter=98 i=4 t=0.000251 per=12.5 cost=1e+04 flops=3.98e+07
 sigma counter=98 i=5 t=0.00026 per=12.9 cost=1e+04 flops=3.85e+07
 sigma counter=98 i=6 t=0.000261 per=13 cost=4.34e+03 flops=1.66e+07
 sigma counter=98 i=7 t=0.000253 per=12.6 cost=4.32e+03 flops=1.71e+07
 total GEMM cost=4.22e+04 flops=2.09e+07
--- TIMING FOR sigma_tot : t_inter=0.0207 t_gemm=0.191 t_reduction=0.0193 tot=0.231 ---
 sigma_tot counter=98 i=0 t=0.0235 per=12.3 cost=2.24e+05 flops=9.5e+06
 sigma_tot counter=98 i=1 t=0.0238 per=12.5 cost=2.3e+05 flops=9.63e+06
 sigma_tot counter=98 i=2 t=0.0235 per=12.3 cost=2.69e+05 flops=1.14e+07
 sigma_tot counter=98 i=3 t=0.0234 per=12.3 cost=2.75e+05 flops=1.18e+07
 sigma_tot counter=98 i=4 t=0.0238 per=12.5 cost=4.51e+05 flops=1.89e+07
 sigma_tot counter=98 i=5 t=0.0239 per=12.6 cost=4.52e+05 flops=1.89e+07
 sigma_tot counter=98 i=6 t=0.0247 per=13 cost=6.14e+05 flops=2.48e+07
 sigma_tot counter=98 i=7 t=0.024 per=12.6 cost=6.09e+05 flops=2.54e+07
 total GEMM cost=3.12e+06 flops=1.64e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701465761 -1.003e+03  6.876e-02    2     2  5.331e-03 2.666e-03
    1   1 -      -2.436233901586 -1.002e+03  4.380e-02    2     2  5.331e-03 2.666e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.180e-04,2.023e-03,1.960e-04 cost=4.217e+04 flops[gemm]=2.084e+07
--- TIMING FOR sigma : t_inter=2.180e-04 t_gemm=2.023e-03 t_reduction=1.960e-04 tot=2.437e-03 ---
 sigma counter=99 i=0 t=2.560e-04 per=1.265e+01 cost=3.716e+03 flops=1.452e+07
 sigma counter=99 i=1 t=2.590e-04 per=1.280e+01 cost=3.736e+03 flops=1.442e+07
 sigma counter=99 i=2 t=2.400e-04 per=1.186e+01 cost=3.036e+03 flops=1.265e+07
 sigma counter=99 i=3 t=2.380e-04 per=1.176e+01 cost=3.026e+03 flops=1.271e+07
 sigma counter=99 i=4 t=2.550e-04 per=1.261e+01 cost=1.000e+04 flops=3.922e+07
 sigma counter=99 i=5 t=2.580e-04 per=1.275e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=99 i=6 t=2.650e-04 per=1.310e+01 cost=4.336e+03 flops=1.636e+07
 sigma counter=99 i=7 t=2.520e-04 per=1.246e+01 cost=4.316e+03 flops=1.713e+07
 total GEMM cost=4.217e+04 flops=2.084e+07
--- TIMING FOR sigma_tot : t_inter=2.090e-02 t_gemm=1.928e-01 t_reduction=1.951e-02 tot=2.332e-01 ---
 sigma_tot counter=99 i=0 t=2.380e-02 per=1.235e+01 cost=2.273e+05 flops=9.550e+06
 sigma_tot counter=99 i=1 t=2.408e-02 per=1.249e+01 cost=2.333e+05 flops=9.685e+06
 sigma_tot counter=99 i=2 t=2.374e-02 per=1.232e+01 cost=2.716e+05 flops=1.144e+07
 sigma_tot counter=99 i=3 t=2.363e-02 per=1.226e+01 cost=2.785e+05 flops=1.179e+07
 sigma_tot counter=99 i=4 t=2.408e-02 per=1.249e+01 cost=4.605e+05 flops=1.913e+07
 sigma_tot counter=99 i=5 t=2.420e-02 per=1.255e+01 cost=4.623e+05 flops=1.911e+07
 sigma_tot counter=99 i=6 t=2.499e-02 per=1.297e+01 cost=6.183e+05 flops=2.474e+07
 sigma_tot counter=99 i=7 t=2.424e-02 per=1.257e+01 cost=6.137e+05 flops=2.532e+07
 total GEMM cost=3.165e+06 flops=1.642e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.090e-04,2.047e-03,2.010e-04 cost=4.217e+04 flops[gemm]=2.060e+07
--- TIMING FOR sigma : t_inter=2.090e-04 t_gemm=2.047e-03 t_reduction=2.010e-04 tot=2.457e-03 ---
 sigma counter=100 i=0 t=2.540e-04 per=1.241e+01 cost=3.716e+03 flops=1.463e+07
 sigma counter=100 i=1 t=2.570e-04 per=1.255e+01 cost=3.736e+03 flops=1.454e+07
 sigma counter=100 i=2 t=2.460e-04 per=1.202e+01 cost=3.036e+03 flops=1.234e+07
 sigma counter=100 i=3 t=2.430e-04 per=1.187e+01 cost=3.026e+03 flops=1.245e+07
 sigma counter=100 i=4 t=2.580e-04 per=1.260e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=100 i=5 t=2.650e-04 per=1.295e+01 cost=1.000e+04 flops=3.774e+07
 sigma counter=100 i=6 t=2.680e-04 per=1.309e+01 cost=4.336e+03 flops=1.618e+07
 sigma counter=100 i=7 t=2.560e-04 per=1.251e+01 cost=4.316e+03 flops=1.686e+07
 total GEMM cost=4.217e+04 flops=2.060e+07
--- TIMING FOR sigma_tot : t_inter=2.111e-02 t_gemm=1.948e-01 t_reduction=1.971e-02 tot=2.356e-01 ---
 sigma_tot counter=100 i=0 t=2.405e-02 per=1.235e+01 cost=2.310e+05 flops=9.604e+06
 sigma_tot counter=100 i=1 t=2.434e-02 per=1.250e+01 cost=2.370e+05 flops=9.736e+06
 sigma_tot counter=100 i=2 t=2.399e-02 per=1.231e+01 cost=2.746e+05 flops=1.145e+07
 sigma_tot counter=100 i=3 t=2.387e-02 per=1.225e+01 cost=2.815e+05 flops=1.179e+07
 sigma_tot counter=100 i=4 t=2.433e-02 per=1.249e+01 cost=4.705e+05 flops=1.934e+07
 sigma_tot counter=100 i=5 t=2.446e-02 per=1.256e+01 cost=4.723e+05 flops=1.931e+07
 sigma_tot counter=100 i=6 t=2.526e-02 per=1.297e+01 cost=6.227e+05 flops=2.465e+07
 sigma_tot counter=100 i=7 t=2.449e-02 per=1.257e+01 cost=6.180e+05 flops=2.523e+07
 total GEMM cost=3.208e+06 flops=1.647e+07
    2   0 -      -2.654428675224 -1.727e-03  1.261e-02    4     4  1.072e-02 2.681e-03
    2   1 -      -2.436964455562 -7.306e-04  4.223e-03    4     4  1.072e-02 2.681e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.160e-04,2.018e-03,1.980e-04 cost=4.217e+04 flops[gemm]=2.089e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=2.018e-03 t_reduction=1.980e-04 tot=2.432e-03 ---
 sigma counter=101 i=0 t=2.550e-04 per=1.264e+01 cost=3.716e+03 flops=1.457e+07
 sigma counter=101 i=1 t=2.630e-04 per=1.303e+01 cost=3.736e+03 flops=1.421e+07
 sigma counter=101 i=2 t=2.400e-04 per=1.189e+01 cost=3.036e+03 flops=1.265e+07
 sigma counter=101 i=3 t=2.370e-04 per=1.174e+01 cost=3.026e+03 flops=1.277e+07
 sigma counter=101 i=4 t=2.530e-04 per=1.254e+01 cost=1.000e+04 flops=3.953e+07
 sigma counter=101 i=5 t=2.610e-04 per=1.293e+01 cost=1.000e+04 flops=3.831e+07
 sigma counter=101 i=6 t=2.600e-04 per=1.288e+01 cost=4.336e+03 flops=1.668e+07
 sigma counter=101 i=7 t=2.490e-04 per=1.234e+01 cost=4.316e+03 flops=1.733e+07
 total GEMM cost=4.217e+04 flops=2.089e+07
--- TIMING FOR sigma_tot : t_inter=2.133e-02 t_gemm=1.968e-01 t_reduction=1.991e-02 tot=2.381e-01 ---
 sigma_tot counter=101 i=0 t=2.431e-02 per=1.235e+01 cost=2.347e+05 flops=9.656e+06
 sigma_tot counter=101 i=1 t=2.460e-02 per=1.250e+01 cost=2.407e+05 flops=9.784e+06
 sigma_tot counter=101 i=2 t=2.423e-02 per=1.231e+01 cost=2.777e+05 flops=1.146e+07
 sigma_tot counter=101 i=3 t=2.411e-02 per=1.225e+01 cost=2.846e+05 flops=1.180e+07
 sigma_tot counter=101 i=4 t=2.459e-02 per=1.249e+01 cost=4.805e+05 flops=1.954e+07
 sigma_tot counter=101 i=5 t=2.472e-02 per=1.256e+01 cost=4.823e+05 flops=1.951e+07
 sigma_tot counter=101 i=6 t=2.552e-02 per=1.297e+01 cost=6.270e+05 flops=2.457e+07
 sigma_tot counter=101 i=7 t=2.474e-02 per=1.257e+01 cost=6.223e+05 flops=2.515e+07
 total GEMM cost=3.250e+06 flops=1.651e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.100e-04,2.010e-03,1.940e-04 cost=4.217e+04 flops[gemm]=2.098e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=2.009e-03 t_reduction=1.940e-04 tot=2.413e-03 ---
 sigma counter=102 i=0 t=2.520e-04 per=1.254e+01 cost=3.716e+03 flops=1.475e+07
 sigma counter=102 i=1 t=2.590e-04 per=1.289e+01 cost=3.736e+03 flops=1.442e+07
 sigma counter=102 i=2 t=2.380e-04 per=1.185e+01 cost=3.036e+03 flops=1.276e+07
 sigma counter=102 i=3 t=2.400e-04 per=1.195e+01 cost=3.026e+03 flops=1.261e+07
 sigma counter=102 i=4 t=2.530e-04 per=1.259e+01 cost=1.000e+04 flops=3.953e+07
 sigma counter=102 i=5 t=2.550e-04 per=1.269e+01 cost=1.000e+04 flops=3.922e+07
 sigma counter=102 i=6 t=2.600e-04 per=1.294e+01 cost=4.336e+03 flops=1.668e+07
 sigma counter=102 i=7 t=2.520e-04 per=1.254e+01 cost=4.316e+03 flops=1.713e+07
 total GEMM cost=4.217e+04 flops=2.099e+07
--- TIMING FOR sigma_tot : t_inter=2.154e-02 t_gemm=1.988e-01 t_reduction=2.010e-02 tot=2.405e-01 ---
 sigma_tot counter=102 i=0 t=2.456e-02 per=1.235e+01 cost=2.384e+05 flops=9.708e+06
 sigma_tot counter=102 i=1 t=2.486e-02 per=1.250e+01 cost=2.445e+05 flops=9.832e+06
 sigma_tot counter=102 i=2 t=2.447e-02 per=1.231e+01 cost=2.807e+05 flops=1.147e+07
 sigma_tot counter=102 i=3 t=2.435e-02 per=1.225e+01 cost=2.876e+05 flops=1.181e+07
 sigma_tot counter=102 i=4 t=2.484e-02 per=1.249e+01 cost=4.905e+05 flops=1.975e+07
 sigma_tot counter=102 i=5 t=2.498e-02 per=1.256e+01 cost=4.923e+05 flops=1.971e+07
 sigma_tot counter=102 i=6 t=2.578e-02 per=1.297e+01 cost=6.313e+05 flops=2.449e+07
 sigma_tot counter=102 i=7 t=2.500e-02 per=1.257e+01 cost=6.266e+05 flops=2.507e+07
 total GEMM cost=3.292e+06 flops=1.656e+07
    3   0 -      -2.654509664616 -8.099e-05  3.660e-03    6     6  1.603e-02 2.672e-03
    3   1 -      -2.436976459235 -1.200e-05  1.113e-03    6     6  1.603e-02 2.672e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.170e-04,2.036e-03,1.960e-04 cost=4.217e+04 flops[gemm]=2.071e+07
--- TIMING FOR sigma : t_inter=2.170e-04 t_gemm=2.035e-03 t_reduction=1.960e-04 tot=2.448e-03 ---
 sigma counter=103 i=0 t=2.600e-04 per=1.278e+01 cost=3.716e+03 flops=1.429e+07
 sigma counter=103 i=1 t=2.590e-04 per=1.273e+01 cost=3.736e+03 flops=1.442e+07
 sigma counter=103 i=2 t=2.390e-04 per=1.174e+01 cost=3.036e+03 flops=1.270e+07
 sigma counter=103 i=3 t=2.370e-04 per=1.165e+01 cost=3.026e+03 flops=1.277e+07
 sigma counter=103 i=4 t=2.540e-04 per=1.248e+01 cost=1.000e+04 flops=3.937e+07
 sigma counter=103 i=5 t=2.580e-04 per=1.268e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=103 i=6 t=2.600e-04 per=1.278e+01 cost=4.336e+03 flops=1.668e+07
 sigma counter=103 i=7 t=2.680e-04 per=1.317e+01 cost=4.316e+03 flops=1.610e+07
 total GEMM cost=4.217e+04 flops=2.072e+07
--- TIMING FOR sigma_tot : t_inter=2.176e-02 t_gemm=2.009e-01 t_reduction=2.030e-02 tot=2.429e-01 ---
 sigma_tot counter=103 i=0 t=2.482e-02 per=1.236e+01 cost=2.421e+05 flops=9.756e+06
 sigma_tot counter=103 i=1 t=2.512e-02 per=1.251e+01 cost=2.482e+05 flops=9.880e+06
 sigma_tot counter=103 i=2 t=2.471e-02 per=1.230e+01 cost=2.837e+05 flops=1.148e+07
 sigma_tot counter=103 i=3 t=2.458e-02 per=1.224e+01 cost=2.906e+05 flops=1.182e+07
 sigma_tot counter=103 i=4 t=2.509e-02 per=1.249e+01 cost=5.005e+05 flops=1.995e+07
 sigma_tot counter=103 i=5 t=2.524e-02 per=1.256e+01 cost=5.023e+05 flops=1.990e+07
 sigma_tot counter=103 i=6 t=2.604e-02 per=1.297e+01 cost=6.357e+05 flops=2.441e+07
 sigma_tot counter=103 i=7 t=2.526e-02 per=1.258e+01 cost=6.309e+05 flops=2.497e+07
 total GEMM cost=3.334e+06 flops=1.660e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.090e-04,1.996e-03,1.940e-04 cost=4.217e+04 flops[gemm]=2.113e+07
--- TIMING FOR sigma : t_inter=2.090e-04 t_gemm=1.995e-03 t_reduction=1.940e-04 tot=2.398e-03 ---
 sigma counter=104 i=0 t=2.510e-04 per=1.258e+01 cost=3.716e+03 flops=1.480e+07
 sigma counter=104 i=1 t=2.540e-04 per=1.273e+01 cost=3.736e+03 flops=1.471e+07
 sigma counter=104 i=2 t=2.370e-04 per=1.188e+01 cost=3.036e+03 flops=1.281e+07
 sigma counter=104 i=3 t=2.360e-04 per=1.183e+01 cost=3.026e+03 flops=1.282e+07
 sigma counter=104 i=4 t=2.510e-04 per=1.258e+01 cost=1.000e+04 flops=3.984e+07
 sigma counter=104 i=5 t=2.580e-04 per=1.293e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=104 i=6 t=2.600e-04 per=1.303e+01 cost=4.336e+03 flops=1.668e+07
 sigma counter=104 i=7 t=2.480e-04 per=1.243e+01 cost=4.316e+03 flops=1.740e+07
 total GEMM cost=4.217e+04 flops=2.114e+07
--- TIMING FOR sigma_tot : t_inter=2.197e-02 t_gemm=2.029e-01 t_reduction=2.049e-02 tot=2.453e-01 ---
 sigma_tot counter=104 i=0 t=2.507e-02 per=1.236e+01 cost=2.458e+05 flops=9.807e+06
 sigma_tot counter=104 i=1 t=2.538e-02 per=1.251e+01 cost=2.519e+05 flops=9.928e+06
 sigma_tot counter=104 i=2 t=2.494e-02 per=1.230e+01 cost=2.868e+05 flops=1.150e+07
 sigma_tot counter=104 i=3 t=2.482e-02 per=1.223e+01 cost=2.936e+05 flops=1.183e+07
 sigma_tot counter=104 i=4 t=2.535e-02 per=1.249e+01 cost=5.105e+05 flops=2.014e+07
 sigma_tot counter=104 i=5 t=2.549e-02 per=1.257e+01 cost=5.123e+05 flops=2.010e+07
 sigma_tot counter=104 i=6 t=2.630e-02 per=1.297e+01 cost=6.400e+05 flops=2.433e+07
 sigma_tot counter=104 i=7 t=2.551e-02 per=1.258e+01 cost=6.353e+05 flops=2.490e+07
 total GEMM cost=3.376e+06 flops=1.664e+07
    4   0 -      -2.654516020750 -6.356e-06  1.139e-03    6     8  2.130e-02 2.663e-03
    4   1 -      -2.436977285929 -8.267e-07  4.032e-04    6     8  2.130e-02 2.663e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.170e-04,2.045e-03,1.950e-04 cost=4.217e+04 flops[gemm]=2.062e+07
--- TIMING FOR sigma : t_inter=2.170e-04 t_gemm=2.045e-03 t_reduction=1.950e-04 tot=2.457e-03 ---
 sigma counter=105 i=0 t=2.550e-04 per=1.247e+01 cost=3.716e+03 flops=1.457e+07
 sigma counter=105 i=1 t=2.520e-04 per=1.232e+01 cost=3.736e+03 flops=1.483e+07
 sigma counter=105 i=2 t=2.470e-04 per=1.208e+01 cost=3.036e+03 flops=1.229e+07
 sigma counter=105 i=3 t=2.440e-04 per=1.193e+01 cost=3.026e+03 flops=1.240e+07
 sigma counter=105 i=4 t=2.590e-04 per=1.267e+01 cost=1.000e+04 flops=3.861e+07
 sigma counter=105 i=5 t=2.620e-04 per=1.281e+01 cost=1.000e+04 flops=3.817e+07
 sigma counter=105 i=6 t=2.760e-04 per=1.350e+01 cost=4.336e+03 flops=1.571e+07
 sigma counter=105 i=7 t=2.500e-04 per=1.222e+01 cost=4.316e+03 flops=1.726e+07
 total GEMM cost=4.217e+04 flops=2.062e+07
--- TIMING FOR sigma_tot : t_inter=2.218e-02 t_gemm=2.049e-01 t_reduction=2.068e-02 tot=2.478e-01 ---
 sigma_tot counter=105 i=0 t=2.532e-02 per=1.236e+01 cost=2.496e+05 flops=9.855e+06
 sigma_tot counter=105 i=1 t=2.563e-02 per=1.251e+01 cost=2.557e+05 flops=9.976e+06
 sigma_tot counter=105 i=2 t=2.519e-02 per=1.229e+01 cost=2.898e+05 flops=1.151e+07
 sigma_tot counter=105 i=3 t=2.506e-02 per=1.223e+01 cost=2.967e+05 flops=1.184e+07
 sigma_tot counter=105 i=4 t=2.560e-02 per=1.250e+01 cost=5.205e+05 flops=2.033e+07
 sigma_tot counter=105 i=5 t=2.576e-02 per=1.257e+01 cost=5.223e+05 flops=2.028e+07
 sigma_tot counter=105 i=6 t=2.658e-02 per=1.297e+01 cost=6.443e+05 flops=2.424e+07
 sigma_tot counter=105 i=7 t=2.576e-02 per=1.257e+01 cost=6.396e+05 flops=2.483e+07
 total GEMM cost=3.418e+06 flops=1.668e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.300e-05,2.080e-04,2.025e-03,2.040e-04 cost=4.217e+04 flops[gemm]=2.082e+07
--- TIMING FOR sigma : t_inter=2.080e-04 t_gemm=2.024e-03 t_reduction=2.040e-04 tot=2.436e-03 ---
 sigma counter=106 i=0 t=2.550e-04 per=1.260e+01 cost=3.716e+03 flops=1.457e+07
 sigma counter=106 i=1 t=2.590e-04 per=1.280e+01 cost=3.736e+03 flops=1.442e+07
 sigma counter=106 i=2 t=2.360e-04 per=1.166e+01 cost=3.036e+03 flops=1.286e+07
 sigma counter=106 i=3 t=2.370e-04 per=1.171e+01 cost=3.026e+03 flops=1.277e+07
 sigma counter=106 i=4 t=2.570e-04 per=1.270e+01 cost=1.000e+04 flops=3.891e+07
 sigma counter=106 i=5 t=2.650e-04 per=1.309e+01 cost=1.000e+04 flops=3.774e+07
 sigma counter=106 i=6 t=2.600e-04 per=1.285e+01 cost=4.336e+03 flops=1.668e+07
 sigma counter=106 i=7 t=2.550e-04 per=1.260e+01 cost=4.316e+03 flops=1.693e+07
 total GEMM cost=4.217e+04 flops=2.083e+07
--- TIMING FOR sigma_tot : t_inter=2.239e-02 t_gemm=2.069e-01 t_reduction=2.089e-02 tot=2.502e-01 ---
 sigma_tot counter=106 i=0 t=2.558e-02 per=1.236e+01 cost=2.533e+05 flops=9.902e+06
 sigma_tot counter=106 i=1 t=2.589e-02 per=1.251e+01 cost=2.594e+05 flops=1.002e+07
 sigma_tot counter=106 i=2 t=2.543e-02 per=1.229e+01 cost=2.928e+05 flops=1.152e+07
 sigma_tot counter=106 i=3 t=2.530e-02 per=1.223e+01 cost=2.997e+05 flops=1.184e+07
 sigma_tot counter=106 i=4 t=2.586e-02 per=1.250e+01 cost=5.305e+05 flops=2.051e+07
 sigma_tot counter=106 i=5 t=2.602e-02 per=1.257e+01 cost=5.323e+05 flops=2.046e+07
 sigma_tot counter=106 i=6 t=2.684e-02 per=1.297e+01 cost=6.487e+05 flops=2.417e+07
 sigma_tot counter=106 i=7 t=2.602e-02 per=1.257e+01 cost=6.439e+05 flops=2.475e+07
 total GEMM cost=3.461e+06 flops=1.672e+07
    5   0 -      -2.654516818919 -7.982e-07  4.446e-04    6    10  2.663e-02 2.663e-03
    5   1 -      -2.436977409924 -1.240e-07  2.046e-04    6    10  2.663e-02 2.663e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.300e-05,2.230e-04,2.016e-03,1.970e-04 cost=4.217e+04 flops[gemm]=2.092e+07
--- TIMING FOR sigma : t_inter=2.230e-04 t_gemm=2.016e-03 t_reduction=1.970e-04 tot=2.436e-03 ---
 sigma counter=107 i=0 t=2.550e-04 per=1.265e+01 cost=3.716e+03 flops=1.457e+07
 sigma counter=107 i=1 t=2.600e-04 per=1.290e+01 cost=3.736e+03 flops=1.437e+07
 sigma counter=107 i=2 t=2.400e-04 per=1.190e+01 cost=3.036e+03 flops=1.265e+07
 sigma counter=107 i=3 t=2.370e-04 per=1.176e+01 cost=3.026e+03 flops=1.277e+07
 sigma counter=107 i=4 t=2.520e-04 per=1.250e+01 cost=1.000e+04 flops=3.968e+07
 sigma counter=107 i=5 t=2.590e-04 per=1.285e+01 cost=1.000e+04 flops=3.861e+07
 sigma counter=107 i=6 t=2.620e-04 per=1.300e+01 cost=4.336e+03 flops=1.655e+07
 sigma counter=107 i=7 t=2.510e-04 per=1.245e+01 cost=4.316e+03 flops=1.720e+07
 total GEMM cost=4.217e+04 flops=2.092e+07
--- TIMING FOR sigma_tot : t_inter=2.261e-02 t_gemm=2.089e-01 t_reduction=2.109e-02 tot=2.526e-01 ---
 sigma_tot counter=107 i=0 t=2.583e-02 per=1.236e+01 cost=2.570e+05 flops=9.948e+06
 sigma_tot counter=107 i=1 t=2.615e-02 per=1.251e+01 cost=2.631e+05 flops=1.006e+07
 sigma_tot counter=107 i=2 t=2.567e-02 per=1.228e+01 cost=2.959e+05 flops=1.153e+07
 sigma_tot counter=107 i=3 t=2.554e-02 per=1.222e+01 cost=3.027e+05 flops=1.185e+07
 sigma_tot counter=107 i=4 t=2.611e-02 per=1.250e+01 cost=5.405e+05 flops=2.070e+07
 sigma_tot counter=107 i=5 t=2.628e-02 per=1.258e+01 cost=5.423e+05 flops=2.064e+07
 sigma_tot counter=107 i=6 t=2.710e-02 per=1.297e+01 cost=6.530e+05 flops=2.410e+07
 sigma_tot counter=107 i=7 t=2.627e-02 per=1.257e+01 cost=6.482e+05 flops=2.468e+07
 total GEMM cost=3.503e+06 flops=1.676e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.300e-05,2.130e-04,2.018e-03,1.960e-04 cost=4.217e+04 flops[gemm]=2.089e+07
--- TIMING FOR sigma : t_inter=2.130e-04 t_gemm=2.018e-03 t_reduction=1.960e-04 tot=2.427e-03 ---
 sigma counter=108 i=0 t=2.540e-04 per=1.259e+01 cost=3.716e+03 flops=1.463e+07
 sigma counter=108 i=1 t=2.520e-04 per=1.249e+01 cost=3.736e+03 flops=1.483e+07
 sigma counter=108 i=2 t=2.430e-04 per=1.204e+01 cost=3.036e+03 flops=1.249e+07
 sigma counter=108 i=3 t=2.450e-04 per=1.214e+01 cost=3.026e+03 flops=1.235e+07
 sigma counter=108 i=4 t=2.580e-04 per=1.278e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=108 i=5 t=2.550e-04 per=1.264e+01 cost=1.000e+04 flops=3.922e+07
 sigma counter=108 i=6 t=2.590e-04 per=1.283e+01 cost=4.336e+03 flops=1.674e+07
 sigma counter=108 i=7 t=2.520e-04 per=1.249e+01 cost=4.316e+03 flops=1.713e+07
 total GEMM cost=4.217e+04 flops=2.089e+07
--- TIMING FOR sigma_tot : t_inter=2.283e-02 t_gemm=2.110e-01 t_reduction=2.128e-02 tot=2.551e-01 ---
 sigma_tot counter=108 i=0 t=2.609e-02 per=1.237e+01 cost=2.607e+05 flops=9.993e+06
 sigma_tot counter=108 i=1 t=2.640e-02 per=1.251e+01 cost=2.669e+05 flops=1.011e+07
 sigma_tot counter=108 i=2 t=2.591e-02 per=1.228e+01 cost=2.989e+05 flops=1.154e+07
 sigma_tot counter=108 i=3 t=2.578e-02 per=1.222e+01 cost=3.057e+05 flops=1.186e+07
 sigma_tot counter=108 i=4 t=2.637e-02 per=1.250e+01 cost=5.505e+05 flops=2.088e+07
 sigma_tot counter=108 i=5 t=2.654e-02 per=1.258e+01 cost=5.523e+05 flops=2.081e+07
 sigma_tot counter=108 i=6 t=2.736e-02 per=1.297e+01 cost=6.573e+05 flops=2.403e+07
 sigma_tot counter=108 i=7 t=2.652e-02 per=1.257e+01 cost=6.525e+05 flops=2.461e+07
 total GEMM cost=3.545e+06 flops=1.680e+07
    6   0 -      -2.654516950785 -1.319e-07  1.570e-04    6    12  3.192e-02 2.660e-03
    6   1 +      -2.436977447170 -3.725e-08  7.419e-05    6    12  3.192e-02 2.660e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.160e-04,2.023e-03,2.000e-04 cost=4.217e+04 flops[gemm]=2.084e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=2.023e-03 t_reduction=2.000e-04 tot=2.439e-03 ---
 sigma counter=109 i=0 t=2.570e-04 per=1.270e+01 cost=3.716e+03 flops=1.446e+07
 sigma counter=109 i=1 t=2.620e-04 per=1.295e+01 cost=3.736e+03 flops=1.426e+07
 sigma counter=109 i=2 t=2.380e-04 per=1.176e+01 cost=3.036e+03 flops=1.276e+07
 sigma counter=109 i=3 t=2.380e-04 per=1.176e+01 cost=3.026e+03 flops=1.271e+07
 sigma counter=109 i=4 t=2.580e-04 per=1.275e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=109 i=5 t=2.560e-04 per=1.265e+01 cost=1.000e+04 flops=3.906e+07
 sigma counter=109 i=6 t=2.620e-04 per=1.295e+01 cost=4.336e+03 flops=1.655e+07
 sigma counter=109 i=7 t=2.520e-04 per=1.246e+01 cost=4.316e+03 flops=1.713e+07
 total GEMM cost=4.217e+04 flops=2.084e+07
--- TIMING FOR sigma_tot : t_inter=2.304e-02 t_gemm=2.130e-01 t_reduction=2.148e-02 tot=2.575e-01 ---
 sigma_tot counter=109 i=0 t=2.635e-02 per=1.237e+01 cost=2.644e+05 flops=1.004e+07
 sigma_tot counter=109 i=1 t=2.666e-02 per=1.252e+01 cost=2.706e+05 flops=1.015e+07
 sigma_tot counter=109 i=2 t=2.615e-02 per=1.228e+01 cost=3.020e+05 flops=1.155e+07
 sigma_tot counter=109 i=3 t=2.602e-02 per=1.222e+01 cost=3.088e+05 flops=1.187e+07
 sigma_tot counter=109 i=4 t=2.663e-02 per=1.250e+01 cost=5.605e+05 flops=2.105e+07
 sigma_tot counter=109 i=5 t=2.679e-02 per=1.258e+01 cost=5.623e+05 flops=2.099e+07
 sigma_tot counter=109 i=6 t=2.762e-02 per=1.297e+01 cost=6.617e+05 flops=2.395e+07
 sigma_tot counter=109 i=7 t=2.677e-02 per=1.257e+01 cost=6.568e+05 flops=2.453e+07
 total GEMM cost=3.587e+06 flops=1.684e+07
    7   0 +      -2.654516966956 -1.617e-08  3.991e-05    5    13  3.460e-02 2.661e-03
    7   1 +      -2.436977447170  4.441e-16  7.419e-05    5    13  3.460e-02 2.661e-03
TIMING FOR Davidson : 3.463e-02  T(cal/comm/rest)=3.402e-02,4.530e-05,5.661e-04
optimized energies: isweep=2 dots=2 ibond=0 e[0]=-2.65451696696 nmvp=13
optimized energies: isweep=2 dots=2 ibond=0 e[1]=-2.43697744717 nmvp=13
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=9 alg_decim=1 mpisize=2 maxthreads=2
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
TIMING FOR decimation: 3.7e-04 S T(wf/decim)=3.1e-04,5.9e-05
ctns::oper_renorm coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=852:6.5e-03MB:6.3e-06GB
rank=0 GPUmem(GB): used=2.2e-05 (oper)=8.5e-06
rank=0 GPUmem(GB): used=2.2e-05 (oper,site)(GB)=8.5e-06,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 5.825e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=2.22e-05 (oper,site,rinter)=8.52e-06,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00102 S size(rtasks)=37 size(Rlst2)=9 T(Rmu/Rlist)=0.000202,0.000814 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00109 S size(rtasks)=37 size(Rlst)=860 -----
rank=0 GPUmem(GB): used=0.000234 (oper,site,rinter,batch)=8.52e-06,2.68e-07,0,0.000211 blksize=16 blksize0=0 batchsize=860
timing: allocate=3.6e-05 rmmtasks init=0.00105 total=0.00108
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=6e-06,0.00117,0.000209 cost=1.69e+04 flops[gemm]=1.44e+07
--- TIMING FOR renorm : t_inter=6e-06 t_gemm=0.00117 t_reduction=0.000209 tot=0.00139 ---
 renorm counter=9 i=0 t=0.00024 per=20.4 cost=1.3e+03 flops=5.42e+06
 renorm counter=9 i=1 t=0.00023 per=19.6 cost=1.64e+03 flops=7.12e+06
 renorm counter=9 i=2 t=1e-06 per=0.0852 cost=0 flops=0
 renorm counter=9 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=9 i=4 t=0.000224 per=19.1 cost=1.19e+03 flops=5.33e+06
 renorm counter=9 i=5 t=0.000226 per=19.3 cost=1.85e+03 flops=8.2e+06
 renorm counter=9 i=6 t=0.000253 per=21.6 cost=1.09e+04 flops=4.3e+07
 total GEMM cost=1.69e+04 flops=1.44e+07
--- TIMING FOR renorm_tot : t_inter=0.000863 t_gemm=0.0103 t_reduction=0.00181 tot=0.013 ---
 renorm_tot counter=9 i=0 t=0.0021 per=20.3 cost=1.5e+04 flops=7.18e+06
 renorm_tot counter=9 i=1 t=0.00203 per=19.7 cost=2.24e+04 flops=1.1e+07
 renorm_tot counter=9 i=2 t=0.000877 per=8.5 cost=1.36e+04 flops=1.55e+07
 renorm_tot counter=9 i=3 t=0.000888 per=8.6 cost=2.36e+04 flops=2.66e+07
 renorm_tot counter=9 i=4 t=0.00111 per=10.7 cost=1.54e+04 flops=1.39e+07
 renorm_tot counter=9 i=5 t=0.00113 per=11 cost=2.69e+04 flops=2.37e+07
 renorm_tot counter=9 i=6 t=0.00219 per=21.2 cost=1.79e+05 flops=8.18e+07
 total GEMM cost=2.96e+05 flops=2.87e+07
timing: gpu2cpu=1.45e-05 deallocate(site/work)=2.58e-06,5.11e-06 total=1.96e-05
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.00493 S T(init/kernel/comm)=0.000428,0.00443,6.41e-05 rank=0 -----
TIMING FOR cleanup: 0.000354 T(erase/save/remove)=9.41e-05,0.000222,3.75e-05
##### local: 5.154e-02 S #####
 T(local: fetch) = 1.555e-04 S  per = 0.302  per(accum) = 0.302
 T(local: hdiag) = 5.836e-04 S  per = 1.13  per(accum) = 1.43
 T(local: dvdsn) = 4.436e-02 S  per = 86.1  per(accum) = 87.5
 T(local: decim) = 4.667e-04 S  per = 0.905  per(accum) = 88.4
 T(local: guess) = 5.314e-04 S  per = 1.03  per(accum) = 89.4
 T(local: renrm) = 5.074e-03 S  per = 9.85  per(accum) = 99.3
 T(local: save ) = 3.680e-04 S  per = 0.714  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.321e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 9.922e-06 S  per = 0.023  per(accum) = 0.023
 T(local: symbolic_formulae_twodot     ) = 7.067e-04 S  per = 1.64  per(accum) = 1.66
 T(local: hintermediate init           ) = 6.050e-05 S  per = 0.14  per(accum) = 1.8
 T(local: hintermediates memcpy cpu2gpu) = 3.000e-08 S  per = 6.94e-05  per(accum) = 1.8
 T(local: preprocess_hformulae_Hxlist2 ) = 3.953e-03 S  per = 9.15  per(accum) = 10.9
 T(local: hmmtasks init                ) = 3.846e-03 S  per =  8.9  per(accum) = 19.8
 T(local: dvdson solver [Hx_batchGPU]  ) = 3.402e-02 S  per = 78.7  per(accum) = 98.6
 T(local: dvdson solver [communication]) = 4.530e-05 S  per = 0.105  per(accum) = 98.7
 T(local: dvdson solver [rest part]    ) = 5.661e-04 S  per = 1.31  per(accum) = 100
Detailed decomposition of T(renrm): 4.926e-03 S
 T(local: qops init                    ) = 4.281e-04 S  per = 8.69  per(accum) = 8.69
 T(local: qops_dict memcpy cpu2gpu     ) = 3.745e-05 S  per = 0.76  per(accum) = 9.45
 T(local: symbolic_formulae_renorm     ) = 5.922e-04 S  per =   12  per(accum) = 21.5
 T(local: rintermediate init           ) = 2.582e-05 S  per = 0.524  per(accum) = 22
 T(local: rintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 0.000589  per(accum) = 22
 T(local: preprocess_formulae_Rlist2   ) = 1.123e-03 S  per = 22.8  per(accum) = 44.8
 T(local: rmmtasks init                ) = 1.091e-03 S  per = 22.2  per(accum) = 66.9
 T(local: qops memset                  ) = 2.800e-08 S  per = 0.000568  per(accum) = 66.9
 T(local: preprocess_renorm_batchGPU   ) = 1.511e-03 S  per = 30.7  per(accum) = 97.6
 T(local: qops memcpy gpu2cpu          ) = 1.456e-05 S  per = 0.296  per(accum) = 97.9
 T(local: deallocate gpu memory        ) = 3.842e-05 S  per = 0.78  per(accum) = 98.7
 T(local: communication of opS and opH ) = 6.413e-05 S  per =  1.3  per(accum) = 100
##### sweep: 5.154e-02 S #####
 T(sweep: fetch) = 1.555e-04 S  per = 0.302  per(accum) = 0.302
 T(sweep: hdiag) = 5.836e-04 S  per = 1.13  per(accum) = 1.43
 T(sweep: dvdsn) = 4.436e-02 S  per = 86.1  per(accum) = 87.5
 T(sweep: decim) = 4.667e-04 S  per = 0.905  per(accum) = 88.4
 T(sweep: guess) = 5.314e-04 S  per = 1.03  per(accum) = 89.4
 T(sweep: renrm) = 5.074e-03 S  per = 9.85  per(accum) = 99.3
 T(sweep: save ) = 3.680e-04 S  per = 0.714  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.321e-02 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 9.922e-06 S  per = 0.023  per(accum) = 0.023
 T(sweep: symbolic_formulae_twodot     ) = 7.067e-04 S  per = 1.64  per(accum) = 1.66
 T(sweep: hintermediate init           ) = 6.050e-05 S  per = 0.14  per(accum) = 1.8
 T(sweep: hintermediates memcpy cpu2gpu) = 3.000e-08 S  per = 6.94e-05  per(accum) = 1.8
 T(sweep: preprocess_hformulae_Hxlist2 ) = 3.953e-03 S  per = 9.15  per(accum) = 10.9
 T(sweep: hmmtasks init                ) = 3.846e-03 S  per =  8.9  per(accum) = 19.8
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 3.402e-02 S  per = 78.7  per(accum) = 98.6
 T(sweep: dvdson solver [communication]) = 4.530e-05 S  per = 0.105  per(accum) = 98.7
 T(sweep: dvdson solver [rest part]    ) = 5.661e-04 S  per = 1.31  per(accum) = 100
Detailed decomposition of T(renrm): 4.926e-03 S
 T(sweep: qops init                    ) = 4.281e-04 S  per = 8.69  per(accum) = 8.69
 T(sweep: qops_dict memcpy cpu2gpu     ) = 3.745e-05 S  per = 0.76  per(accum) = 9.45
 T(sweep: symbolic_formulae_renorm     ) = 5.922e-04 S  per =   12  per(accum) = 21.5
 T(sweep: rintermediate init           ) = 2.582e-05 S  per = 0.524  per(accum) = 22
 T(sweep: rintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 0.000589  per(accum) = 22
 T(sweep: preprocess_formulae_Rlist2   ) = 1.123e-03 S  per = 22.8  per(accum) = 44.8
 T(sweep: rmmtasks init                ) = 1.091e-03 S  per = 22.2  per(accum) = 66.9
 T(sweep: qops memset                  ) = 2.800e-08 S  per = 0.000568  per(accum) = 66.9
 T(sweep: preprocess_renorm_batchGPU   ) = 1.511e-03 S  per = 30.7  per(accum) = 97.6
 T(sweep: qops memcpy gpu2cpu          ) = 1.456e-05 S  per = 0.296  per(accum) = 97.9
 T(sweep: deallocate gpu memory        ) = 3.842e-05 S  per = 0.78  per(accum) = 98.7
 T(sweep: communication of opS and opH ) = 6.413e-05 S  per =  1.3  per(accum) = 100
##### global: 4.245e-01 S #####
 T(global: fetch) = 6.667e-03 S  per = 1.57  per(accum) = 1.57
 T(global: hdiag) = 5.160e-03 S  per = 1.22  per(accum) = 2.79
 T(global: dvdsn) = 3.569e-01 S  per = 84.1  per(accum) = 86.9
 T(global: decim) = 7.989e-03 S  per = 1.88  per(accum) = 88.7
 T(global: guess) = 3.718e-03 S  per = 0.876  per(accum) = 89.6
 T(global: renrm) = 4.146e-02 S  per = 9.77  per(accum) = 99.4
 T(global: save ) = 2.635e-03 S  per = 0.621  per(accum) = 100
Detailed decomposition of T(dvdsn): 3.480e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 1.126e-04 S  per = 0.0324  per(accum) = 0.0324
 T(global: symbolic_formulae_twodot     ) = 5.984e-03 S  per = 1.72  per(accum) = 1.75
 T(global: hintermediate init           ) = 5.246e-04 S  per = 0.151  per(accum) = 1.9
 T(global: hintermediates memcpy cpu2gpu) = 2.590e-07 S  per = 7.44e-05  per(accum) = 1.9
 T(global: preprocess_hformulae_Hxlist2 ) = 2.988e-02 S  per = 8.59  per(accum) = 10.5
 T(global: hmmtasks init                ) = 2.930e-02 S  per = 8.42  per(accum) = 18.9
 T(global: dvdson solver [Hx_batchGPU]  ) = 2.772e-01 S  per = 79.7  per(accum) = 98.6
 T(global: dvdson solver [communication]) = 3.822e-04 S  per = 0.11  per(accum) = 98.7
 T(global: dvdson solver [rest part]    ) = 4.597e-03 S  per = 1.32  per(accum) = 100
Detailed decomposition of T(renrm): 4.020e-02 S
 T(global: qops init                    ) = 3.046e-03 S  per = 7.58  per(accum) = 7.58
 T(global: qops_dict memcpy cpu2gpu     ) = 3.839e-04 S  per = 0.955  per(accum) = 8.53
 T(global: symbolic_formulae_renorm     ) = 4.913e-03 S  per = 12.2  per(accum) = 20.8
 T(global: rintermediate init           ) = 3.989e-04 S  per = 0.992  per(accum) = 21.7
 T(global: rintermediates memcpy cpu2gpu) = 2.560e-07 S  per = 0.000637  per(accum) = 21.7
 T(global: preprocess_formulae_Rlist2   ) = 8.433e-03 S  per =   21  per(accum) = 42.7
 T(global: rmmtasks init                ) = 7.912e-03 S  per = 19.7  per(accum) = 62.4
 T(global: qops memset                  ) = 2.520e-07 S  per = 0.000627  per(accum) = 62.4
 T(global: preprocess_renorm_batchGPU   ) = 1.407e-02 S  per =   35  per(accum) = 97.4
 T(global: qops memcpy gpu2cpu          ) = 1.366e-04 S  per = 0.34  per(accum) = 97.7
 T(global: deallocate gpu memory        ) = 3.424e-04 S  per = 0.852  per(accum) = 98.6
 T(global: communication of opS and opH ) = 5.696e-04 S  per = 1.42  per(accum) = 100

isweep=2 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=852:0.0065MB:6.35e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1290:0.00984MB:9.61e-06GB
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x4498b8a0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
### DIAG TIMING: total=0.000358 t1=7.36e-06, t2=1.35e-05, t3=4.8e-05, t4=0.000123, t5=0.000124, t6=2.75e-05, t7=1.27e-05, t8=2.51e-06
duration_diagGPU:0.000372
duration_diagreduce:4.07e-06
duration_diagtransform:1.76e-06
rank=0 GPUmem(GB): used=9.61e-06 (oper)=9.61e-06
----- TIMING FOR symbolic_formulae_twodot with size=95 : 6.466e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=95
 no. of hintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.690e-05 S -----
rank=0 GPUmem(GB): used=9.94e-06 (oper,hinter)=9.61e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00329 S size(H_formulae)=95 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000188,0.00311 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00354 S size(H_formulae)=95 size(Hxlst)=2974 -----
rank=0 GPUmem(GB): used=0.000388 (oper,hinter,dvdson,batch)=9.61e-06,3.28e-07,1.49e-06,0.000377 blksize=4 blksize0=8 batchsize=2974
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.00022,0.00199,0.000197 cost=4.12e+04 flops[gemm]=2.07e+07
--- TIMING FOR sigma : t_inter=0.00022 t_gemm=0.00199 t_reduction=0.000197 tot=0.00241 ---
 sigma counter=110 i=0 t=0.000244 per=12.3 cost=2.58e+03 flops=1.06e+07
 sigma counter=110 i=1 t=0.000244 per=12.3 cost=2.57e+03 flops=1.05e+07
 sigma counter=110 i=2 t=0.000244 per=12.3 cost=3.75e+03 flops=1.54e+07
 sigma counter=110 i=3 t=0.000247 per=12.4 cost=3.77e+03 flops=1.53e+07
 sigma counter=110 i=4 t=0.000248 per=12.5 cost=4.11e+03 flops=1.66e+07
 sigma counter=110 i=5 t=0.000249 per=12.5 cost=4.13e+03 flops=1.66e+07
 sigma counter=110 i=6 t=0.00026 per=13.1 cost=1.01e+04 flops=3.9e+07
 sigma counter=110 i=7 t=0.000255 per=12.8 cost=1.01e+04 flops=3.98e+07
 total GEMM cost=4.12e+04 flops=2.07e+07
--- TIMING FOR sigma_tot : t_inter=0.0233 t_gemm=0.215 t_reduction=0.0217 tot=0.26 ---
 sigma_tot counter=110 i=0 t=0.0266 per=12.4 cost=2.67e+05 flops=1e+07
 sigma_tot counter=110 i=1 t=0.0269 per=12.5 cost=2.73e+05 flops=1.02e+07
 sigma_tot counter=110 i=2 t=0.0264 per=12.3 cost=3.06e+05 flops=1.16e+07
 sigma_tot counter=110 i=3 t=0.0263 per=12.2 cost=3.13e+05 flops=1.19e+07
 sigma_tot counter=110 i=4 t=0.0269 per=12.5 cost=5.65e+05 flops=2.1e+07
 sigma_tot counter=110 i=5 t=0.027 per=12.6 cost=5.66e+05 flops=2.09e+07
 sigma_tot counter=110 i=6 t=0.0279 per=13 cost=6.72e+05 flops=2.41e+07
 sigma_tot counter=110 i=7 t=0.027 per=12.6 cost=6.67e+05 flops=2.47e+07
 total GEMM cost=3.63e+06 flops=1.69e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000212,0.002,0.000202 cost=4.12e+04 flops[gemm]=2.06e+07
--- TIMING FOR sigma : t_inter=0.000212 t_gemm=0.002 t_reduction=0.000202 tot=0.00241 ---
 sigma counter=111 i=0 t=0.000243 per=12.2 cost=2.58e+03 flops=1.06e+07
 sigma counter=111 i=1 t=0.000239 per=12 cost=2.57e+03 flops=1.08e+07
 sigma counter=111 i=2 t=0.000254 per=12.7 cost=3.75e+03 flops=1.48e+07
 sigma counter=111 i=3 t=0.000245 per=12.3 cost=3.77e+03 flops=1.54e+07
 sigma counter=111 i=4 t=0.000251 per=12.6 cost=4.11e+03 flops=1.64e+07
 sigma counter=111 i=5 t=0.000254 per=12.7 cost=4.13e+03 flops=1.63e+07
 sigma counter=111 i=6 t=0.000261 per=13.1 cost=1.01e+04 flops=3.89e+07
 sigma counter=111 i=7 t=0.000252 per=12.6 cost=1.01e+04 flops=4.03e+07
 total GEMM cost=4.12e+04 flops=2.06e+07
--- TIMING FOR sigma_tot : t_inter=0.0235 t_gemm=0.217 t_reduction=0.0219 tot=0.262 ---
 sigma_tot counter=111 i=0 t=0.0268 per=12.4 cost=2.7e+05 flops=1e+07
 sigma_tot counter=111 i=1 t=0.0271 per=12.5 cost=2.76e+05 flops=1.02e+07
 sigma_tot counter=111 i=2 t=0.0266 per=12.3 cost=3.09e+05 flops=1.16e+07
 sigma_tot counter=111 i=3 t=0.0265 per=12.2 cost=3.16e+05 flops=1.19e+07
 sigma_tot counter=111 i=4 t=0.0271 per=12.5 cost=5.69e+05 flops=2.1e+07
 sigma_tot counter=111 i=5 t=0.0273 per=12.6 cost=5.71e+05 flops=2.09e+07
 sigma_tot counter=111 i=6 t=0.0281 per=13 cost=6.82e+05 flops=2.42e+07
 sigma_tot counter=111 i=7 t=0.0273 per=12.6 cost=6.77e+05 flops=2.48e+07
 total GEMM cost=3.67e+06 flops=1.69e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956 -1.003e+03  3.991e-05    2     2  5.269e-03 2.634e-03
    1   1 +      -2.436977447170 -1.002e+03  7.419e-05    2     2  5.269e-03 2.634e-03
TIMING FOR Davidson : 5.316e-03  T(cal/comm/rest)=5.214e-03,7.269e-06,9.433e-05
optimized energies: isweep=2 dots=2 ibond=1 e[0]=-2.65451696696 nmvp=2
optimized energies: isweep=2 dots=2 ibond=1 e[1]=-2.43697744717 nmvp=2
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=16 alg_decim=1 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep2_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
----- TMING FOR decimation_genbasis: 3.9e-04 S T(scatter/comp/gather)=3.7e-05,4.0e-05,3.2e-04 -----
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
 qbond: qkept nsym=6 dimAll=20
 (3,1):6 (4,0):4 (2,0):3 (4,2):3 (3,-1):2 (5,1):2
----- TIMING for decimation_row: 7.201e-04 S T(decim/formRot)=4.797e-04,2.404e-04 -----
TIMING FOR decimation: 1.028e-03 S T(wf/decim)=2.940e-04,7.339e-04
ctns::oper_renorm coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:6 A:7 B:11 P:3 Q:5 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=1685:1.286e-02MB:1.255e-05GB
rank=0 GPUmem(GB): used=2.249e-05 (oper)=1.999e-05
rank=0 GPUmem(GB): used=2.361e-05 (oper,site)(GB)=1.999e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=37 : 4.741e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 5.147e-05 S -----
rank=0 GPUmem(GB): used=2.39e-05 (oper,site,rinter)=2e-05,1.12e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000996 S size(rtasks)=37 size(Rlst2)=6 T(Rmu/Rlist)=0.000169,0.000827 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00108 S size(rtasks)=37 size(Rlst)=905 -----
rank=0 GPUmem(GB): used=0.00057 (oper,site,rinter,batch)=2e-05,1.12e-06,3.28e-07,0.000546 blksize=36 blksize0=8 batchsize=905
timing: allocate=3.54e-05 rmmtasks init=0.00112 total=0.00115
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00021,0.00117,0.000204 cost=9.26e+04 flops[gemm]=7.92e+07
--- TIMING FOR renorm : t_inter=0.00021 t_gemm=0.00117 t_reduction=0.000204 tot=0.00158 ---
 renorm counter=10 i=0 t=0.000229 per=19.6 cost=4.54e+03 flops=1.98e+07
 renorm counter=10 i=1 t=0.000228 per=19.5 cost=5.34e+03 flops=2.34e+07
 renorm counter=10 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=10 i=3 t=1e-06 per=0.0855 cost=0 flops=0
 renorm counter=10 i=4 t=0.000228 per=19.5 cost=9.49e+03 flops=4.16e+07
 renorm counter=10 i=5 t=0.000228 per=19.5 cost=1.68e+04 flops=7.36e+07
 renorm counter=10 i=6 t=0.000255 per=21.8 cost=5.64e+04 flops=2.21e+08
 total GEMM cost=9.26e+04 flops=7.92e+07
--- TIMING FOR renorm_tot : t_inter=0.00107 t_gemm=0.0115 t_reduction=0.00202 tot=0.0146 ---
 renorm_tot counter=10 i=0 t=0.00233 per=20.2 cost=1.96e+04 flops=8.42e+06
 renorm_tot counter=10 i=1 t=0.00226 per=19.7 cost=2.77e+04 flops=1.23e+07
 renorm_tot counter=10 i=2 t=0.000877 per=7.63 cost=1.36e+04 flops=1.55e+07
 renorm_tot counter=10 i=3 t=0.000889 per=7.74 cost=2.36e+04 flops=2.65e+07
 renorm_tot counter=10 i=4 t=0.00134 per=11.6 cost=2.49e+04 flops=1.87e+07
 renorm_tot counter=10 i=5 t=0.00136 per=11.8 cost=4.37e+04 flops=3.21e+07
 renorm_tot counter=10 i=6 t=0.00244 per=21.3 cost=2.35e+05 flops=9.64e+07
 total GEMM cost=3.88e+05 flops=3.38e+07
timing: gpu2cpu=1.64e-05 deallocate(site/work)=3.18e-06,6.2e-06 total=2.26e-05
check ||H-H.dagger||=1.054e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00499 S T(init/kernel/comm)=0.000316,0.00462,5.75e-05 rank=0 -----
TIMING FOR cleanup: 0.000213 T(erase/save/remove)=4.2e-06,0.000173,3.57e-05
##### local: 2.291e-02 S #####
 T(local: fetch) = 1.047e-03 S  per = 4.57  per(accum) = 4.57
 T(local: hdiag) = 5.070e-04 S  per = 2.21  per(accum) = 6.78
 T(local: dvdsn) = 1.440e-02 S  per = 62.8  per(accum) = 69.6
 T(local: decim) = 1.168e-03 S  per =  5.1  per(accum) = 74.7
 T(local: guess) = 3.945e-04 S  per = 1.72  per(accum) = 76.5
 T(local: renrm) = 5.169e-03 S  per = 22.6  per(accum) = 99
 T(local: save ) = 2.256e-04 S  per = 0.985  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.324e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 7.735e-06 S  per = 0.0584  per(accum) = 0.0584
 T(local: symbolic_formulae_twodot     ) = 6.569e-04 S  per = 4.96  per(accum) = 5.02
 T(local: hintermediate init           ) = 5.934e-05 S  per = 0.448  per(accum) = 5.47
 T(local: hintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000212  per(accum) = 5.47
 T(local: preprocess_hformulae_Hxlist2 ) = 3.641e-03 S  per = 27.5  per(accum) = 33
 T(local: hmmtasks init                ) = 3.554e-03 S  per = 26.9  per(accum) = 59.8
 T(local: dvdson solver [Hx_batchGPU]  ) = 5.214e-03 S  per = 39.4  per(accum) = 99.2
 T(local: dvdson solver [communication]) = 7.269e-06 S  per = 0.0549  per(accum) = 99.3
 T(local: dvdson solver [rest part]    ) = 9.433e-05 S  per = 0.713  per(accum) = 100
Detailed decomposition of T(renrm): 4.994e-03 S
 T(local: qops init                    ) = 3.157e-04 S  per = 6.32  per(accum) = 6.32
 T(local: qops_dict memcpy cpu2gpu     ) = 4.334e-05 S  per = 0.868  per(accum) = 7.19
 T(local: symbolic_formulae_renorm     ) = 4.828e-04 S  per = 9.67  per(accum) = 16.9
 T(local: rintermediate init           ) = 6.385e-05 S  per = 1.28  per(accum) = 18.1
 T(local: rintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 0.000581  per(accum) = 18.1
 T(local: preprocess_formulae_Rlist2   ) = 1.113e-03 S  per = 22.3  per(accum) = 40.4
 T(local: rmmtasks init                ) = 1.165e-03 S  per = 23.3  per(accum) = 63.7
 T(local: qops memset                  ) = 2.300e-08 S  per = 0.000461  per(accum) = 63.7
 T(local: preprocess_renorm_batchGPU   ) = 1.703e-03 S  per = 34.1  per(accum) = 97.8
 T(local: qops memcpy gpu2cpu          ) = 1.648e-05 S  per = 0.33  per(accum) = 98.2
 T(local: deallocate gpu memory        ) = 3.390e-05 S  per = 0.679  per(accum) = 98.8
 T(local: communication of opS and opH ) = 5.754e-05 S  per = 1.15  per(accum) = 100
##### sweep: 7.445e-02 S #####
 T(sweep: fetch) = 1.202e-03 S  per = 1.61  per(accum) = 1.61
 T(sweep: hdiag) = 1.091e-03 S  per = 1.46  per(accum) = 3.08
 T(sweep: dvdsn) = 5.876e-02 S  per = 78.9  per(accum) = 82
 T(sweep: decim) = 1.635e-03 S  per =  2.2  per(accum) = 84.2
 T(sweep: guess) = 9.259e-04 S  per = 1.24  per(accum) = 85.4
 T(sweep: renrm) = 1.024e-02 S  per = 13.8  per(accum) = 99.2
 T(sweep: save ) = 5.936e-04 S  per = 0.797  per(accum) = 100
Detailed decomposition of T(dvdsn): 5.644e-02 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.766e-05 S  per = 0.0313  per(accum) = 0.0313
 T(sweep: symbolic_formulae_twodot     ) = 1.364e-03 S  per = 2.42  per(accum) = 2.45
 T(sweep: hintermediate init           ) = 1.198e-04 S  per = 0.212  per(accum) = 2.66
 T(sweep: hintermediates memcpy cpu2gpu) = 5.800e-08 S  per = 0.000103  per(accum) = 2.66
 T(sweep: preprocess_hformulae_Hxlist2 ) = 7.594e-03 S  per = 13.5  per(accum) = 16.1
 T(sweep: hmmtasks init                ) = 7.400e-03 S  per = 13.1  per(accum) = 29.2
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 3.923e-02 S  per = 69.5  per(accum) = 98.7
 T(sweep: dvdson solver [communication]) = 5.257e-05 S  per = 0.0931  per(accum) = 98.8
 T(sweep: dvdson solver [rest part]    ) = 6.604e-04 S  per = 1.17  per(accum) = 100
Detailed decomposition of T(renrm): 9.920e-03 S
 T(sweep: qops init                    ) = 7.438e-04 S  per =  7.5  per(accum) = 7.5
 T(sweep: qops_dict memcpy cpu2gpu     ) = 8.079e-05 S  per = 0.814  per(accum) = 8.31
 T(sweep: symbolic_formulae_renorm     ) = 1.075e-03 S  per = 10.8  per(accum) = 19.1
 T(sweep: rintermediate init           ) = 8.967e-05 S  per = 0.904  per(accum) = 20.1
 T(sweep: rintermediates memcpy cpu2gpu) = 5.800e-08 S  per = 0.000585  per(accum) = 20.1
 T(sweep: preprocess_formulae_Rlist2   ) = 2.236e-03 S  per = 22.5  per(accum) = 42.6
 T(sweep: rmmtasks init                ) = 2.256e-03 S  per = 22.7  per(accum) = 65.3
 T(sweep: qops memset                  ) = 5.100e-08 S  per = 0.000514  per(accum) = 65.3
 T(sweep: preprocess_renorm_batchGPU   ) = 3.214e-03 S  per = 32.4  per(accum) = 97.7
 T(sweep: qops memcpy gpu2cpu          ) = 3.103e-05 S  per = 0.313  per(accum) = 98
 T(sweep: deallocate gpu memory        ) = 7.232e-05 S  per = 0.729  per(accum) = 98.8
 T(sweep: communication of opS and opH ) = 1.217e-04 S  per = 1.23  per(accum) = 100
##### global: 4.474e-01 S #####
 T(global: fetch) = 7.714e-03 S  per = 1.72  per(accum) = 1.72
 T(global: hdiag) = 5.667e-03 S  per = 1.27  per(accum) = 2.99
 T(global: dvdsn) = 3.713e-01 S  per =   83  per(accum) = 86
 T(global: decim) = 9.157e-03 S  per = 2.05  per(accum) = 88
 T(global: guess) = 4.112e-03 S  per = 0.919  per(accum) = 88.9
 T(global: renrm) = 4.663e-02 S  per = 10.4  per(accum) = 99.4
 T(global: save ) = 2.861e-03 S  per = 0.639  per(accum) = 100
Detailed decomposition of T(dvdsn): 3.612e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 1.203e-04 S  per = 0.0333  per(accum) = 0.0333
 T(global: symbolic_formulae_twodot     ) = 6.640e-03 S  per = 1.84  per(accum) = 1.87
 T(global: hintermediate init           ) = 5.839e-04 S  per = 0.162  per(accum) = 2.03
 T(global: hintermediates memcpy cpu2gpu) = 2.870e-07 S  per = 7.95e-05  per(accum) = 2.03
 T(global: preprocess_hformulae_Hxlist2 ) = 3.352e-02 S  per = 9.28  per(accum) = 11.3
 T(global: hmmtasks init                ) = 3.286e-02 S  per =  9.1  per(accum) = 20.4
 T(global: dvdson solver [Hx_batchGPU]  ) = 2.824e-01 S  per = 78.2  per(accum) = 98.6
 T(global: dvdson solver [communication]) = 3.895e-04 S  per = 0.108  per(accum) = 98.7
 T(global: dvdson solver [rest part]    ) = 4.691e-03 S  per =  1.3  per(accum) = 100
Detailed decomposition of T(renrm): 4.520e-02 S
 T(global: qops init                    ) = 3.362e-03 S  per = 7.44  per(accum) = 7.44
 T(global: qops_dict memcpy cpu2gpu     ) = 4.272e-04 S  per = 0.945  per(accum) = 8.38
 T(global: symbolic_formulae_renorm     ) = 5.395e-03 S  per = 11.9  per(accum) = 20.3
 T(global: rintermediate init           ) = 4.628e-04 S  per = 1.02  per(accum) = 21.3
 T(global: rintermediates memcpy cpu2gpu) = 2.850e-07 S  per = 0.000631  per(accum) = 21.3
 T(global: preprocess_formulae_Rlist2   ) = 9.546e-03 S  per = 21.1  per(accum) = 42.5
 T(global: rmmtasks init                ) = 9.077e-03 S  per = 20.1  per(accum) = 62.5
 T(global: qops memset                  ) = 2.750e-07 S  per = 0.000608  per(accum) = 62.5
 T(global: preprocess_renorm_batchGPU   ) = 1.577e-02 S  per = 34.9  per(accum) = 97.4
 T(global: qops memcpy gpu2cpu          ) = 1.531e-04 S  per = 0.339  per(accum) = 97.8
 T(global: deallocate gpu memory        ) = 3.763e-04 S  per = 0.833  per(accum) = 98.6
 T(global: communication of opS and opH ) = 6.272e-04 S  per = 1.39  per(accum) = 100

isweep=2 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=852:0.0065MB:6.35e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1290:0.00984MB:9.61e-06GB
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44a054d0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
### DIAG TIMING: total=0.000369 t1=1.13e-05, t2=1.72e-05, t3=5.1e-05, t4=0.000124, t5=0.000123, t6=2.7e-05, t7=1.31e-05, t8=2.55e-06
duration_diagGPU:0.000383
duration_diagreduce:4.16e-06
duration_diagtransform:1.86e-06
rank=0 GPUmem(GB): used=2.22e-05 (oper)=9.61e-06
----- TIMING FOR symbolic_formulae_twodot with size=95 : 6.457e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=95
 no. of hintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.645e-05 S -----
rank=0 GPUmem(GB): used=2.25e-05 (oper,hinter)=9.61e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00334 S size(H_formulae)=95 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000187,0.00315 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00359 S size(H_formulae)=95 size(Hxlst)=2974 -----
rank=0 GPUmem(GB): used=0.000401 (oper,hinter,dvdson,batch)=9.61e-06,3.28e-07,1.49e-06,0.000377 blksize=4 blksize0=8 batchsize=2974
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.3e-05,0.000218,0.00199,0.000198 cost=4.12e+04 flops[gemm]=2.07e+07
--- TIMING FOR sigma : t_inter=0.000218 t_gemm=0.00199 t_reduction=0.000198 tot=0.00241 ---
 sigma counter=112 i=0 t=0.000245 per=12.3 cost=2.58e+03 flops=1.05e+07
 sigma counter=112 i=1 t=0.000244 per=12.2 cost=2.57e+03 flops=1.05e+07
 sigma counter=112 i=2 t=0.000245 per=12.3 cost=3.75e+03 flops=1.53e+07
 sigma counter=112 i=3 t=0.000243 per=12.2 cost=3.77e+03 flops=1.55e+07
 sigma counter=112 i=4 t=0.000252 per=12.6 cost=4.11e+03 flops=1.63e+07
 sigma counter=112 i=5 t=0.00025 per=12.5 cost=4.13e+03 flops=1.65e+07
 sigma counter=112 i=6 t=0.000261 per=13.1 cost=1.01e+04 flops=3.89e+07
 sigma counter=112 i=7 t=0.000254 per=12.7 cost=1.01e+04 flops=3.99e+07
 total GEMM cost=4.12e+04 flops=2.07e+07
--- TIMING FOR sigma_tot : t_inter=0.0237 t_gemm=0.219 t_reduction=0.0221 tot=0.265 ---
 sigma_tot counter=112 i=0 t=0.0271 per=12.4 cost=2.72e+05 flops=1.01e+07
 sigma_tot counter=112 i=1 t=0.0274 per=12.5 cost=2.78e+05 flops=1.02e+07
 sigma_tot counter=112 i=2 t=0.0269 per=12.3 cost=3.13e+05 flops=1.16e+07
 sigma_tot counter=112 i=3 t=0.0268 per=12.2 cost=3.2e+05 flops=1.2e+07
 sigma_tot counter=112 i=4 t=0.0274 per=12.5 cost=5.73e+05 flops=2.09e+07
 sigma_tot counter=112 i=5 t=0.0275 per=12.6 cost=5.75e+05 flops=2.09e+07
 sigma_tot counter=112 i=6 t=0.0284 per=13 cost=6.92e+05 flops=2.44e+07
 sigma_tot counter=112 i=7 t=0.0275 per=12.6 cost=6.87e+05 flops=2.5e+07
 total GEMM cost=3.71e+06 flops=1.69e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000211,0.00199,0.000195 cost=4.12e+04 flops[gemm]=2.07e+07
--- TIMING FOR sigma : t_inter=0.000211 t_gemm=0.00199 t_reduction=0.000195 tot=0.0024 ---
 sigma counter=113 i=0 t=0.000241 per=12.1 cost=2.58e+03 flops=1.07e+07
 sigma counter=113 i=1 t=0.000237 per=11.9 cost=2.57e+03 flops=1.09e+07
 sigma counter=113 i=2 t=0.000253 per=12.7 cost=3.75e+03 flops=1.48e+07
 sigma counter=113 i=3 t=0.000246 per=12.4 cost=3.77e+03 flops=1.53e+07
 sigma counter=113 i=4 t=0.000248 per=12.5 cost=4.11e+03 flops=1.66e+07
 sigma counter=113 i=5 t=0.000251 per=12.6 cost=4.13e+03 flops=1.65e+07
 sigma counter=113 i=6 t=0.000262 per=13.2 cost=1.01e+04 flops=3.87e+07
 sigma counter=113 i=7 t=0.000252 per=12.7 cost=1.01e+04 flops=4.03e+07
 total GEMM cost=4.12e+04 flops=2.07e+07
--- TIMING FOR sigma_tot : t_inter=0.0239 t_gemm=0.221 t_reduction=0.0223 tot=0.267 ---
 sigma_tot counter=113 i=0 t=0.0273 per=12.4 cost=2.75e+05 flops=1.01e+07
 sigma_tot counter=113 i=1 t=0.0276 per=12.5 cost=2.81e+05 flops=1.02e+07
 sigma_tot counter=113 i=2 t=0.0271 per=12.3 cost=3.17e+05 flops=1.17e+07
 sigma_tot counter=113 i=3 t=0.027 per=12.2 cost=3.24e+05 flops=1.2e+07
 sigma_tot counter=113 i=4 t=0.0276 per=12.5 cost=5.77e+05 flops=2.09e+07
 sigma_tot counter=113 i=5 t=0.0278 per=12.6 cost=5.79e+05 flops=2.08e+07
 sigma_tot counter=113 i=6 t=0.0287 per=13 cost=7.02e+05 flops=2.45e+07
 sigma_tot counter=113 i=7 t=0.0278 per=12.6 cost=6.97e+05 flops=2.51e+07
 total GEMM cost=3.75e+06 flops=1.7e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819590 -1.003e+03  7.009e-02    2     2  5.255e-03 2.628e-03
    1   1 -      -2.436094100139 -1.002e+03  4.918e-02    2     2  5.255e-03 2.628e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.260e-04,2.003e-03,1.950e-04 cost=4.121e+04 flops[gemm]=2.058e+07
--- TIMING FOR sigma : t_inter=2.260e-04 t_gemm=2.003e-03 t_reduction=1.950e-04 tot=2.424e-03 ---
 sigma counter=114 i=0 t=2.380e-04 per=1.188e+01 cost=2.582e+03 flops=1.085e+07
 sigma counter=114 i=1 t=2.490e-04 per=1.243e+01 cost=2.572e+03 flops=1.033e+07
 sigma counter=114 i=2 t=2.510e-04 per=1.253e+01 cost=3.754e+03 flops=1.496e+07
 sigma counter=114 i=3 t=2.470e-04 per=1.233e+01 cost=3.774e+03 flops=1.528e+07
 sigma counter=114 i=4 t=2.490e-04 per=1.243e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=114 i=5 t=2.510e-04 per=1.253e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=114 i=6 t=2.630e-04 per=1.313e+01 cost=1.014e+04 flops=3.857e+07
 sigma counter=114 i=7 t=2.550e-04 per=1.273e+01 cost=1.014e+04 flops=3.978e+07
 total GEMM cost=4.121e+04 flops=2.058e+07
--- TIMING FOR sigma_tot : t_inter=2.413e-02 t_gemm=2.230e-01 t_reduction=2.247e-02 tot=2.696e-01 ---
 sigma_tot counter=114 i=0 t=2.756e-02 per=1.236e+01 cost=2.773e+05 flops=1.006e+07
 sigma_tot counter=114 i=1 t=2.787e-02 per=1.250e+01 cost=2.835e+05 flops=1.017e+07
 sigma_tot counter=114 i=2 t=2.739e-02 per=1.229e+01 cost=3.207e+05 flops=1.171e+07
 sigma_tot counter=114 i=3 t=2.725e-02 per=1.222e+01 cost=3.276e+05 flops=1.202e+07
 sigma_tot counter=114 i=4 t=2.788e-02 per=1.250e+01 cost=5.811e+05 flops=2.084e+07
 sigma_tot counter=114 i=5 t=2.805e-02 per=1.258e+01 cost=5.830e+05 flops=2.079e+07
 sigma_tot counter=114 i=6 t=2.893e-02 per=1.297e+01 cost=7.124e+05 flops=2.463e+07
 sigma_tot counter=114 i=7 t=2.804e-02 per=1.258e+01 cost=7.076e+05 flops=2.523e+07
 total GEMM cost=3.793e+06 flops=1.701e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.090e-04,1.981e-03,1.980e-04 cost=4.121e+04 flops[gemm]=2.080e+07
--- TIMING FOR sigma : t_inter=2.090e-04 t_gemm=1.981e-03 t_reduction=1.980e-04 tot=2.388e-03 ---
 sigma counter=115 i=0 t=2.370e-04 per=1.196e+01 cost=2.582e+03 flops=1.089e+07
 sigma counter=115 i=1 t=2.380e-04 per=1.201e+01 cost=2.572e+03 flops=1.081e+07
 sigma counter=115 i=2 t=2.450e-04 per=1.237e+01 cost=3.754e+03 flops=1.532e+07
 sigma counter=115 i=3 t=2.460e-04 per=1.242e+01 cost=3.774e+03 flops=1.534e+07
 sigma counter=115 i=4 t=2.520e-04 per=1.272e+01 cost=4.112e+03 flops=1.632e+07
 sigma counter=115 i=5 t=2.520e-04 per=1.272e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=115 i=6 t=2.590e-04 per=1.307e+01 cost=1.014e+04 flops=3.917e+07
 sigma counter=115 i=7 t=2.520e-04 per=1.272e+01 cost=1.014e+04 flops=4.025e+07
 total GEMM cost=4.121e+04 flops=2.080e+07
--- TIMING FOR sigma_tot : t_inter=2.434e-02 t_gemm=2.249e-01 t_reduction=2.267e-02 tot=2.720e-01 ---
 sigma_tot counter=115 i=0 t=2.779e-02 per=1.236e+01 cost=2.799e+05 flops=1.007e+07
 sigma_tot counter=115 i=1 t=2.811e-02 per=1.250e+01 cost=2.860e+05 flops=1.018e+07
 sigma_tot counter=115 i=2 t=2.764e-02 per=1.229e+01 cost=3.245e+05 flops=1.174e+07
 sigma_tot counter=115 i=3 t=2.749e-02 per=1.222e+01 cost=3.314e+05 flops=1.205e+07
 sigma_tot counter=115 i=4 t=2.813e-02 per=1.250e+01 cost=5.852e+05 flops=2.080e+07
 sigma_tot counter=115 i=5 t=2.830e-02 per=1.258e+01 cost=5.871e+05 flops=2.075e+07
 sigma_tot counter=115 i=6 t=2.919e-02 per=1.298e+01 cost=7.225e+05 flops=2.475e+07
 sigma_tot counter=115 i=7 t=2.829e-02 per=1.258e+01 cost=7.177e+05 flops=2.537e+07
 total GEMM cost=3.834e+06 flops=1.705e+07
    2   0 -      -2.654426863106 -1.838e-03  1.257e-02    4     4  1.051e-02 2.627e-03
    2   1 -      -2.436959129206 -8.650e-04  5.189e-03    4     4  1.051e-02 2.627e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.190e-04,1.996e-03,1.950e-04 cost=4.121e+04 flops[gemm]=2.065e+07
--- TIMING FOR sigma : t_inter=2.180e-04 t_gemm=1.996e-03 t_reduction=1.950e-04 tot=2.409e-03 ---
 sigma counter=116 i=0 t=2.410e-04 per=1.207e+01 cost=2.582e+03 flops=1.071e+07
 sigma counter=116 i=1 t=2.500e-04 per=1.253e+01 cost=2.572e+03 flops=1.029e+07
 sigma counter=116 i=2 t=2.460e-04 per=1.232e+01 cost=3.754e+03 flops=1.526e+07
 sigma counter=116 i=3 t=2.440e-04 per=1.222e+01 cost=3.774e+03 flops=1.547e+07
 sigma counter=116 i=4 t=2.490e-04 per=1.247e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=116 i=5 t=2.520e-04 per=1.263e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=116 i=6 t=2.620e-04 per=1.313e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=116 i=7 t=2.520e-04 per=1.263e+01 cost=1.014e+04 flops=4.025e+07
 total GEMM cost=4.121e+04 flops=2.065e+07
--- TIMING FOR sigma_tot : t_inter=2.456e-02 t_gemm=2.269e-01 t_reduction=2.286e-02 tot=2.744e-01 ---
 sigma_tot counter=116 i=0 t=2.803e-02 per=1.235e+01 cost=2.825e+05 flops=1.008e+07
 sigma_tot counter=116 i=1 t=2.836e-02 per=1.250e+01 cost=2.886e+05 flops=1.018e+07
 sigma_tot counter=116 i=2 t=2.789e-02 per=1.229e+01 cost=3.282e+05 flops=1.177e+07
 sigma_tot counter=116 i=3 t=2.774e-02 per=1.222e+01 cost=3.352e+05 flops=1.208e+07
 sigma_tot counter=116 i=4 t=2.838e-02 per=1.250e+01 cost=5.893e+05 flops=2.077e+07
 sigma_tot counter=116 i=5 t=2.855e-02 per=1.258e+01 cost=5.912e+05 flops=2.071e+07
 sigma_tot counter=116 i=6 t=2.945e-02 per=1.298e+01 cost=7.327e+05 flops=2.488e+07
 sigma_tot counter=116 i=7 t=2.854e-02 per=1.258e+01 cost=7.279e+05 flops=2.550e+07
 total GEMM cost=3.876e+06 flops=1.708e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.100e-04,2.022e-03,2.040e-04 cost=4.121e+04 flops[gemm]=2.038e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=2.021e-03 t_reduction=2.040e-04 tot=2.435e-03 ---
 sigma counter=117 i=0 t=2.390e-04 per=1.183e+01 cost=2.582e+03 flops=1.080e+07
 sigma counter=117 i=1 t=2.470e-04 per=1.222e+01 cost=2.572e+03 flops=1.041e+07
 sigma counter=117 i=2 t=2.440e-04 per=1.207e+01 cost=3.754e+03 flops=1.539e+07
 sigma counter=117 i=3 t=2.520e-04 per=1.247e+01 cost=3.774e+03 flops=1.498e+07
 sigma counter=117 i=4 t=2.570e-04 per=1.272e+01 cost=4.112e+03 flops=1.600e+07
 sigma counter=117 i=5 t=2.580e-04 per=1.277e+01 cost=4.132e+03 flops=1.602e+07
 sigma counter=117 i=6 t=2.680e-04 per=1.326e+01 cost=1.014e+04 flops=3.785e+07
 sigma counter=117 i=7 t=2.560e-04 per=1.267e+01 cost=1.014e+04 flops=3.962e+07
 total GEMM cost=4.121e+04 flops=2.039e+07
--- TIMING FOR sigma_tot : t_inter=2.477e-02 t_gemm=2.290e-01 t_reduction=2.307e-02 tot=2.768e-01 ---
 sigma_tot counter=117 i=0 t=2.827e-02 per=1.235e+01 cost=2.851e+05 flops=1.008e+07
 sigma_tot counter=117 i=1 t=2.861e-02 per=1.250e+01 cost=2.912e+05 flops=1.018e+07
 sigma_tot counter=117 i=2 t=2.813e-02 per=1.229e+01 cost=3.320e+05 flops=1.180e+07
 sigma_tot counter=117 i=3 t=2.799e-02 per=1.223e+01 cost=3.390e+05 flops=1.211e+07
 sigma_tot counter=117 i=4 t=2.864e-02 per=1.251e+01 cost=5.934e+05 flops=2.072e+07
 sigma_tot counter=117 i=5 t=2.881e-02 per=1.258e+01 cost=5.954e+05 flops=2.067e+07
 sigma_tot counter=117 i=6 t=2.972e-02 per=1.298e+01 cost=7.428e+05 flops=2.500e+07
 sigma_tot counter=117 i=7 t=2.880e-02 per=1.258e+01 cost=7.380e+05 flops=2.562e+07
 total GEMM cost=3.917e+06 flops=1.711e+07
    3   0 -      -2.654508902835 -8.204e-05  3.559e-03    6     6  1.578e-02 2.630e-03
    3   1 -      -2.436975259479 -1.613e-05  1.592e-03    6     6  1.578e-02 2.630e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.180e-04,2.005e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.056e+07
--- TIMING FOR sigma : t_inter=2.170e-04 t_gemm=2.005e-03 t_reduction=1.960e-04 tot=2.418e-03 ---
 sigma counter=118 i=0 t=2.430e-04 per=1.212e+01 cost=2.582e+03 flops=1.063e+07
 sigma counter=118 i=1 t=2.510e-04 per=1.252e+01 cost=2.572e+03 flops=1.025e+07
 sigma counter=118 i=2 t=2.450e-04 per=1.222e+01 cost=3.754e+03 flops=1.532e+07
 sigma counter=118 i=3 t=2.470e-04 per=1.232e+01 cost=3.774e+03 flops=1.528e+07
 sigma counter=118 i=4 t=2.540e-04 per=1.267e+01 cost=4.112e+03 flops=1.619e+07
 sigma counter=118 i=5 t=2.500e-04 per=1.247e+01 cost=4.132e+03 flops=1.653e+07
 sigma counter=118 i=6 t=2.620e-04 per=1.307e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=118 i=7 t=2.530e-04 per=1.262e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.056e+07
--- TIMING FOR sigma_tot : t_inter=2.498e-02 t_gemm=2.310e-01 t_reduction=2.326e-02 tot=2.792e-01 ---
 sigma_tot counter=118 i=0 t=2.852e-02 per=1.235e+01 cost=2.877e+05 flops=1.009e+07
 sigma_tot counter=118 i=1 t=2.886e-02 per=1.250e+01 cost=2.938e+05 flops=1.018e+07
 sigma_tot counter=118 i=2 t=2.837e-02 per=1.228e+01 cost=3.357e+05 flops=1.183e+07
 sigma_tot counter=118 i=3 t=2.824e-02 per=1.223e+01 cost=3.427e+05 flops=1.214e+07
 sigma_tot counter=118 i=4 t=2.889e-02 per=1.251e+01 cost=5.975e+05 flops=2.068e+07
 sigma_tot counter=118 i=5 t=2.906e-02 per=1.258e+01 cost=5.995e+05 flops=2.063e+07
 sigma_tot counter=118 i=6 t=2.998e-02 per=1.298e+01 cost=7.530e+05 flops=2.512e+07
 sigma_tot counter=118 i=7 t=2.905e-02 per=1.258e+01 cost=7.481e+05 flops=2.575e+07
 total GEMM cost=3.958e+06 flops=1.714e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.100e-04,1.990e-03,1.970e-04 cost=4.121e+04 flops[gemm]=2.071e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=1.990e-03 t_reduction=1.970e-04 tot=2.397e-03 ---
 sigma counter=119 i=0 t=2.370e-04 per=1.191e+01 cost=2.582e+03 flops=1.089e+07
 sigma counter=119 i=1 t=2.370e-04 per=1.191e+01 cost=2.572e+03 flops=1.085e+07
 sigma counter=119 i=2 t=2.470e-04 per=1.241e+01 cost=3.754e+03 flops=1.520e+07
 sigma counter=119 i=3 t=2.450e-04 per=1.231e+01 cost=3.774e+03 flops=1.540e+07
 sigma counter=119 i=4 t=2.520e-04 per=1.266e+01 cost=4.112e+03 flops=1.632e+07
 sigma counter=119 i=5 t=2.520e-04 per=1.266e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=119 i=6 t=2.660e-04 per=1.337e+01 cost=1.014e+04 flops=3.814e+07
 sigma counter=119 i=7 t=2.540e-04 per=1.276e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.071e+07
--- TIMING FOR sigma_tot : t_inter=2.519e-02 t_gemm=2.330e-01 t_reduction=2.346e-02 tot=2.816e-01 ---
 sigma_tot counter=119 i=0 t=2.875e-02 per=1.234e+01 cost=2.902e+05 flops=1.009e+07
 sigma_tot counter=119 i=1 t=2.910e-02 per=1.249e+01 cost=2.963e+05 flops=1.018e+07
 sigma_tot counter=119 i=2 t=2.862e-02 per=1.229e+01 cost=3.395e+05 flops=1.186e+07
 sigma_tot counter=119 i=3 t=2.848e-02 per=1.223e+01 cost=3.465e+05 flops=1.217e+07
 sigma_tot counter=119 i=4 t=2.914e-02 per=1.251e+01 cost=6.016e+05 flops=2.065e+07
 sigma_tot counter=119 i=5 t=2.931e-02 per=1.258e+01 cost=6.036e+05 flops=2.059e+07
 sigma_tot counter=119 i=6 t=3.025e-02 per=1.298e+01 cost=7.631e+05 flops=2.523e+07
 sigma_tot counter=119 i=7 t=2.931e-02 per=1.258e+01 cost=7.583e+05 flops=2.587e+07
 total GEMM cost=3.999e+06 flops=1.717e+07
    4   0 -      -2.654515665767 -6.763e-06  1.294e-03    6     8  2.102e-02 2.628e-03
    4   1 -      -2.436977069548 -1.810e-06  5.993e-04    6     8  2.102e-02 2.628e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.180e-04,1.993e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.068e+07
--- TIMING FOR sigma : t_inter=2.180e-04 t_gemm=1.992e-03 t_reduction=1.960e-04 tot=2.406e-03 ---
 sigma counter=120 i=0 t=2.410e-04 per=1.210e+01 cost=2.582e+03 flops=1.071e+07
 sigma counter=120 i=1 t=2.420e-04 per=1.215e+01 cost=2.572e+03 flops=1.063e+07
 sigma counter=120 i=2 t=2.440e-04 per=1.225e+01 cost=3.754e+03 flops=1.539e+07
 sigma counter=120 i=3 t=2.440e-04 per=1.225e+01 cost=3.774e+03 flops=1.547e+07
 sigma counter=120 i=4 t=2.510e-04 per=1.260e+01 cost=4.112e+03 flops=1.638e+07
 sigma counter=120 i=5 t=2.520e-04 per=1.265e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=120 i=6 t=2.600e-04 per=1.305e+01 cost=1.014e+04 flops=3.902e+07
 sigma counter=120 i=7 t=2.580e-04 per=1.295e+01 cost=1.014e+04 flops=3.932e+07
 total GEMM cost=4.121e+04 flops=2.069e+07
--- TIMING FOR sigma_tot : t_inter=2.541e-02 t_gemm=2.349e-01 t_reduction=2.365e-02 tot=2.840e-01 ---
 sigma_tot counter=120 i=0 t=2.899e-02 per=1.234e+01 cost=2.928e+05 flops=1.010e+07
 sigma_tot counter=120 i=1 t=2.934e-02 per=1.249e+01 cost=2.989e+05 flops=1.019e+07
 sigma_tot counter=120 i=2 t=2.887e-02 per=1.229e+01 cost=3.432e+05 flops=1.189e+07
 sigma_tot counter=120 i=3 t=2.873e-02 per=1.223e+01 cost=3.503e+05 flops=1.219e+07
 sigma_tot counter=120 i=4 t=2.939e-02 per=1.251e+01 cost=6.058e+05 flops=2.061e+07
 sigma_tot counter=120 i=5 t=2.956e-02 per=1.258e+01 cost=6.078e+05 flops=2.056e+07
 sigma_tot counter=120 i=6 t=3.051e-02 per=1.298e+01 cost=7.733e+05 flops=2.535e+07
 sigma_tot counter=120 i=7 t=2.956e-02 per=1.258e+01 cost=7.684e+05 flops=2.599e+07
 total GEMM cost=4.040e+06 flops=1.720e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.090e-04,1.997e-03,1.950e-04 cost=4.121e+04 flops[gemm]=2.064e+07
--- TIMING FOR sigma : t_inter=2.090e-04 t_gemm=1.997e-03 t_reduction=1.950e-04 tot=2.401e-03 ---
 sigma counter=121 i=0 t=2.380e-04 per=1.192e+01 cost=2.582e+03 flops=1.085e+07
 sigma counter=121 i=1 t=2.420e-04 per=1.212e+01 cost=2.572e+03 flops=1.063e+07
 sigma counter=121 i=2 t=2.560e-04 per=1.282e+01 cost=3.754e+03 flops=1.466e+07
 sigma counter=121 i=3 t=2.450e-04 per=1.227e+01 cost=3.774e+03 flops=1.540e+07
 sigma counter=121 i=4 t=2.480e-04 per=1.242e+01 cost=4.112e+03 flops=1.658e+07
 sigma counter=121 i=5 t=2.540e-04 per=1.272e+01 cost=4.132e+03 flops=1.627e+07
 sigma counter=121 i=6 t=2.610e-04 per=1.307e+01 cost=1.014e+04 flops=3.887e+07
 sigma counter=121 i=7 t=2.530e-04 per=1.267e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.064e+07
--- TIMING FOR sigma_tot : t_inter=2.562e-02 t_gemm=2.369e-01 t_reduction=2.385e-02 tot=2.864e-01 ---
 sigma_tot counter=121 i=0 t=2.923e-02 per=1.234e+01 cost=2.954e+05 flops=1.011e+07
 sigma_tot counter=121 i=1 t=2.958e-02 per=1.248e+01 cost=3.015e+05 flops=1.019e+07
 sigma_tot counter=121 i=2 t=2.912e-02 per=1.229e+01 cost=3.470e+05 flops=1.192e+07
 sigma_tot counter=121 i=3 t=2.897e-02 per=1.223e+01 cost=3.540e+05 flops=1.222e+07
 sigma_tot counter=121 i=4 t=2.964e-02 per=1.251e+01 cost=6.099e+05 flops=2.058e+07
 sigma_tot counter=121 i=5 t=2.982e-02 per=1.258e+01 cost=6.119e+05 flops=2.052e+07
 sigma_tot counter=121 i=6 t=3.077e-02 per=1.298e+01 cost=7.834e+05 flops=2.546e+07
 sigma_tot counter=121 i=7 t=2.982e-02 per=1.258e+01 cost=7.786e+05 flops=2.611e+07
 total GEMM cost=4.082e+06 flops=1.723e+07
    5   0 -      -2.654516771324 -1.106e-06  5.133e-04    6    10  2.626e-02 2.626e-03
    5   1 -      -2.436977368102 -2.986e-07  2.915e-04    6    10  2.626e-02 2.626e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.210e-04,2.036e-03,2.000e-04 cost=4.121e+04 flops[gemm]=2.024e+07
--- TIMING FOR sigma : t_inter=2.200e-04 t_gemm=2.036e-03 t_reduction=2.000e-04 tot=2.456e-03 ---
 sigma counter=122 i=0 t=2.450e-04 per=1.203e+01 cost=2.582e+03 flops=1.054e+07
 sigma counter=122 i=1 t=2.400e-04 per=1.179e+01 cost=2.572e+03 flops=1.072e+07
 sigma counter=122 i=2 t=2.560e-04 per=1.257e+01 cost=3.754e+03 flops=1.466e+07
 sigma counter=122 i=3 t=2.530e-04 per=1.243e+01 cost=3.774e+03 flops=1.492e+07
 sigma counter=122 i=4 t=2.540e-04 per=1.248e+01 cost=4.112e+03 flops=1.619e+07
 sigma counter=122 i=5 t=2.570e-04 per=1.262e+01 cost=4.132e+03 flops=1.608e+07
 sigma counter=122 i=6 t=2.690e-04 per=1.321e+01 cost=1.014e+04 flops=3.771e+07
 sigma counter=122 i=7 t=2.620e-04 per=1.287e+01 cost=1.014e+04 flops=3.872e+07
 total GEMM cost=4.121e+04 flops=2.024e+07
--- TIMING FOR sigma_tot : t_inter=2.584e-02 t_gemm=2.390e-01 t_reduction=2.405e-02 tot=2.889e-01 ---
 sigma_tot counter=122 i=0 t=2.948e-02 per=1.233e+01 cost=2.980e+05 flops=1.011e+07
 sigma_tot counter=122 i=1 t=2.982e-02 per=1.248e+01 cost=3.040e+05 flops=1.020e+07
 sigma_tot counter=122 i=2 t=2.938e-02 per=1.229e+01 cost=3.508e+05 flops=1.194e+07
 sigma_tot counter=122 i=3 t=2.922e-02 per=1.223e+01 cost=3.578e+05 flops=1.224e+07
 sigma_tot counter=122 i=4 t=2.989e-02 per=1.251e+01 cost=6.140e+05 flops=2.054e+07
 sigma_tot counter=122 i=5 t=3.007e-02 per=1.258e+01 cost=6.160e+05 flops=2.048e+07
 sigma_tot counter=122 i=6 t=3.104e-02 per=1.299e+01 cost=7.936e+05 flops=2.557e+07
 sigma_tot counter=122 i=7 t=3.008e-02 per=1.259e+01 cost=7.887e+05 flops=2.622e+07
 total GEMM cost=4.123e+06 flops=1.725e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.120e-04,1.997e-03,1.980e-04 cost=4.121e+04 flops[gemm]=2.064e+07
--- TIMING FOR sigma : t_inter=2.120e-04 t_gemm=1.997e-03 t_reduction=1.980e-04 tot=2.407e-03 ---
 sigma counter=123 i=0 t=2.490e-04 per=1.247e+01 cost=2.582e+03 flops=1.037e+07
 sigma counter=123 i=1 t=2.430e-04 per=1.217e+01 cost=2.572e+03 flops=1.058e+07
 sigma counter=123 i=2 t=2.450e-04 per=1.227e+01 cost=3.754e+03 flops=1.532e+07
 sigma counter=123 i=3 t=2.430e-04 per=1.217e+01 cost=3.774e+03 flops=1.553e+07
 sigma counter=123 i=4 t=2.520e-04 per=1.262e+01 cost=4.112e+03 flops=1.632e+07
 sigma counter=123 i=5 t=2.520e-04 per=1.262e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=123 i=6 t=2.600e-04 per=1.302e+01 cost=1.014e+04 flops=3.902e+07
 sigma counter=123 i=7 t=2.530e-04 per=1.267e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.064e+07
--- TIMING FOR sigma_tot : t_inter=2.605e-02 t_gemm=2.410e-01 t_reduction=2.425e-02 tot=2.913e-01 ---
 sigma_tot counter=123 i=0 t=2.973e-02 per=1.234e+01 cost=3.006e+05 flops=1.011e+07
 sigma_tot counter=123 i=1 t=3.006e-02 per=1.248e+01 cost=3.066e+05 flops=1.020e+07
 sigma_tot counter=123 i=2 t=2.962e-02 per=1.229e+01 cost=3.545e+05 flops=1.197e+07
 sigma_tot counter=123 i=3 t=2.947e-02 per=1.223e+01 cost=3.616e+05 flops=1.227e+07
 sigma_tot counter=123 i=4 t=3.015e-02 per=1.251e+01 cost=6.181e+05 flops=2.050e+07
 sigma_tot counter=123 i=5 t=3.033e-02 per=1.258e+01 cost=6.202e+05 flops=2.045e+07
 sigma_tot counter=123 i=6 t=3.130e-02 per=1.299e+01 cost=8.037e+05 flops=2.568e+07
 sigma_tot counter=123 i=7 t=3.033e-02 per=1.259e+01 cost=7.989e+05 flops=2.634e+07
 total GEMM cost=4.164e+06 flops=1.728e+07
    6   0 -      -2.654516945140 -1.738e-07  1.835e-04    6    12  3.155e-02 2.629e-03
    6   1 -      -2.436977443846 -7.574e-08  1.163e-04    6    12  3.155e-02 2.629e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.160e-04,1.996e-03,2.060e-04 cost=4.121e+04 flops[gemm]=2.065e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=1.996e-03 t_reduction=2.060e-04 tot=2.418e-03 ---
 sigma counter=124 i=0 t=2.410e-04 per=1.207e+01 cost=2.582e+03 flops=1.071e+07
 sigma counter=124 i=1 t=2.470e-04 per=1.237e+01 cost=2.572e+03 flops=1.041e+07
 sigma counter=124 i=2 t=2.460e-04 per=1.232e+01 cost=3.754e+03 flops=1.526e+07
 sigma counter=124 i=3 t=2.460e-04 per=1.232e+01 cost=3.774e+03 flops=1.534e+07
 sigma counter=124 i=4 t=2.510e-04 per=1.258e+01 cost=4.112e+03 flops=1.638e+07
 sigma counter=124 i=5 t=2.480e-04 per=1.242e+01 cost=4.132e+03 flops=1.666e+07
 sigma counter=124 i=6 t=2.630e-04 per=1.318e+01 cost=1.014e+04 flops=3.857e+07
 sigma counter=124 i=7 t=2.540e-04 per=1.273e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.065e+07
--- TIMING FOR sigma_tot : t_inter=2.627e-02 t_gemm=2.430e-01 t_reduction=2.445e-02 tot=2.937e-01 ---
 sigma_tot counter=124 i=0 t=2.997e-02 per=1.233e+01 cost=3.032e+05 flops=1.012e+07
 sigma_tot counter=124 i=1 t=3.031e-02 per=1.247e+01 cost=3.092e+05 flops=1.020e+07
 sigma_tot counter=124 i=2 t=2.987e-02 per=1.229e+01 cost=3.583e+05 flops=1.199e+07
 sigma_tot counter=124 i=3 t=2.971e-02 per=1.223e+01 cost=3.654e+05 flops=1.230e+07
 sigma_tot counter=124 i=4 t=3.040e-02 per=1.251e+01 cost=6.222e+05 flops=2.047e+07
 sigma_tot counter=124 i=5 t=3.057e-02 per=1.258e+01 cost=6.243e+05 flops=2.042e+07
 sigma_tot counter=124 i=6 t=3.156e-02 per=1.299e+01 cost=8.138e+05 flops=2.579e+07
 sigma_tot counter=124 i=7 t=3.059e-02 per=1.259e+01 cost=8.090e+05 flops=2.645e+07
 total GEMM cost=4.205e+06 flops=1.731e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.200e-04,2.010e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.050e+07
--- TIMING FOR sigma : t_inter=2.200e-04 t_gemm=2.010e-03 t_reduction=1.950e-04 tot=2.425e-03 ---
 sigma counter=125 i=0 t=2.450e-04 per=1.219e+01 cost=2.582e+03 flops=1.054e+07
 sigma counter=125 i=1 t=2.530e-04 per=1.259e+01 cost=2.572e+03 flops=1.017e+07
 sigma counter=125 i=2 t=2.470e-04 per=1.229e+01 cost=3.754e+03 flops=1.520e+07
 sigma counter=125 i=3 t=2.490e-04 per=1.239e+01 cost=3.774e+03 flops=1.516e+07
 sigma counter=125 i=4 t=2.530e-04 per=1.259e+01 cost=4.112e+03 flops=1.625e+07
 sigma counter=125 i=5 t=2.510e-04 per=1.249e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=125 i=6 t=2.580e-04 per=1.284e+01 cost=1.014e+04 flops=3.932e+07
 sigma counter=125 i=7 t=2.540e-04 per=1.264e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.050e+07
--- TIMING FOR sigma_tot : t_inter=2.649e-02 t_gemm=2.450e-01 t_reduction=2.465e-02 tot=2.961e-01 ---
 sigma_tot counter=125 i=0 t=3.021e-02 per=1.233e+01 cost=3.057e+05 flops=1.012e+07
 sigma_tot counter=125 i=1 t=3.056e-02 per=1.248e+01 cost=3.118e+05 flops=1.020e+07
 sigma_tot counter=125 i=2 t=3.012e-02 per=1.229e+01 cost=3.620e+05 flops=1.202e+07
 sigma_tot counter=125 i=3 t=2.996e-02 per=1.223e+01 cost=3.691e+05 flops=1.232e+07
 sigma_tot counter=125 i=4 t=3.065e-02 per=1.251e+01 cost=6.263e+05 flops=2.043e+07
 sigma_tot counter=125 i=5 t=3.082e-02 per=1.258e+01 cost=6.284e+05 flops=2.039e+07
 sigma_tot counter=125 i=6 t=3.182e-02 per=1.299e+01 cost=8.240e+05 flops=2.590e+07
 sigma_tot counter=125 i=7 t=3.084e-02 per=1.259e+01 cost=8.191e+05 flops=2.656e+07
 total GEMM cost=4.247e+06 flops=1.733e+07
    7   0 +      -2.654516966643 -2.150e-08  4.639e-05    6    14  3.683e-02 2.631e-03
    7   1 +      -2.436977450693 -6.847e-09  2.690e-05    6    14  3.683e-02 2.631e-03
TIMING FOR Davidson : 3.685e-02  T(cal/comm/rest)=3.626e-02,5.067e-05,5.398e-04
optimized energies: isweep=2 dots=2 ibond=2 e[0]=-2.65451696664 nmvp=14
optimized energies: isweep=2 dots=2 ibond=2 e[1]=-2.43697745069 nmvp=14
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=9 alg_decim=1 mpisize=2 maxthreads=2
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
TIMING FOR decimation: 4.0e-04 S T(wf/decim)=3.2e-04,7.7e-05
ctns::oper_renorm coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=872:6.7e-03MB:6.5e-06GB
rank=0 GPUmem(GB): used=2.3e-05 (oper)=8.7e-06
rank=0 GPUmem(GB): used=2.3e-05 (oper,site)(GB)=8.7e-06,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 5.778e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=2.29e-05 (oper,site,rinter)=8.67e-06,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00098 S size(rtasks)=37 size(Rlst2)=9 T(Rmu/Rlist)=0.000199,0.00078 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00105 S size(rtasks)=37 size(Rlst)=788 -----
rank=0 GPUmem(GB): used=0.000217 (oper,site,rinter,batch)=8.67e-06,2.68e-07,0,0.000194 blksize=16 blksize0=0 batchsize=788
timing: allocate=3.59e-05 rmmtasks init=0.000919 total=0.000955
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=5e-06,0.00116,0.000196 cost=1.56e+04 flops[gemm]=1.34e+07
--- TIMING FOR renorm : t_inter=5e-06 t_gemm=0.00116 t_reduction=0.000196 tot=0.00136 ---
 renorm counter=11 i=0 t=0.000237 per=20.5 cost=874 flops=3.69e+06
 renorm counter=11 i=1 t=0.000231 per=19.9 cost=1.76e+03 flops=7.63e+06
 renorm counter=11 i=2 t=0.000222 per=19.2 cost=994 flops=4.48e+06
 renorm counter=11 i=3 t=0.000225 per=19.4 cost=1.75e+03 flops=7.78e+06
 renorm counter=11 i=4 t=1e-06 per=0.0864 cost=0 flops=0
 renorm counter=11 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=11 i=6 t=0.000242 per=20.9 cost=1.02e+04 flops=4.21e+07
 total GEMM cost=1.56e+04 flops=1.34e+07
--- TIMING FOR renorm_tot : t_inter=0.00108 t_gemm=0.0126 t_reduction=0.00221 tot=0.0159 ---
 renorm_tot counter=11 i=0 t=0.00256 per=20.3 cost=2.05e+04 flops=7.98e+06
 renorm_tot counter=11 i=1 t=0.00249 per=19.7 cost=2.95e+04 flops=1.18e+07
 renorm_tot counter=11 i=2 t=0.0011 per=8.69 cost=1.46e+04 flops=1.33e+07
 renorm_tot counter=11 i=3 t=0.00111 per=8.81 cost=2.53e+04 flops=2.27e+07
 renorm_tot counter=11 i=4 t=0.00134 per=10.6 cost=2.49e+04 flops=1.86e+07
 renorm_tot counter=11 i=5 t=0.00136 per=10.8 cost=4.37e+04 flops=3.21e+07
 renorm_tot counter=11 i=6 t=0.00268 per=21.2 cost=2.45e+05 flops=9.15e+07
 total GEMM cost=4.04e+05 flops=3.19e+07
timing: gpu2cpu=1.51e-05 deallocate(site/work)=2.75e-06,5.38e-06 total=2.05e-05
check ||H-H.dagger||=0.000e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.00473 S T(init/kernel/comm)=0.000432,0.00424,6.57e-05 rank=0 -----
TIMING FOR cleanup: 0.000354 T(erase/save/remove)=9.41e-05,0.000223,3.67e-05
##### local: 5.285e-02 S #####
 T(local: fetch) = 1.528e-04 S  per = 0.289  per(accum) = 0.289
 T(local: hdiag) = 5.300e-04 S  per =    1  per(accum) = 1.29
 T(local: dvdsn) = 4.592e-02 S  per = 86.9  per(accum) = 88.2
 T(local: decim) = 4.942e-04 S  per = 0.935  per(accum) = 89.1
 T(local: guess) = 5.044e-04 S  per = 0.954  per(accum) = 90.1
 T(local: renrm) = 4.880e-03 S  per = 9.23  per(accum) = 99.3
 T(local: save ) = 3.679e-04 S  per = 0.696  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.484e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 8.728e-06 S  per = 0.0195  per(accum) = 0.0195
 T(local: symbolic_formulae_twodot     ) = 6.548e-04 S  per = 1.46  per(accum) = 1.48
 T(local: hintermediate init           ) = 5.841e-05 S  per = 0.13  per(accum) = 1.61
 T(local: hintermediates memcpy cpu2gpu) = 3.000e-08 S  per = 6.69e-05  per(accum) = 1.61
 T(local: preprocess_hformulae_Hxlist2 ) = 3.683e-03 S  per = 8.21  per(accum) = 9.82
 T(local: hmmtasks init                ) = 3.582e-03 S  per = 7.99  per(accum) = 17.8
 T(local: dvdson solver [Hx_batchGPU]  ) = 3.626e-02 S  per = 80.9  per(accum) = 98.7
 T(local: dvdson solver [communication]) = 5.067e-05 S  per = 0.113  per(accum) = 98.8
 T(local: dvdson solver [rest part]    ) = 5.398e-04 S  per =  1.2  per(accum) = 100
Detailed decomposition of T(renrm): 4.733e-03 S
 T(local: qops init                    ) = 4.319e-04 S  per = 9.12  per(accum) = 9.12
 T(local: qops_dict memcpy cpu2gpu     ) = 3.804e-05 S  per = 0.804  per(accum) = 9.93
 T(local: symbolic_formulae_renorm     ) = 5.866e-04 S  per = 12.4  per(accum) = 22.3
 T(local: rintermediate init           ) = 2.996e-05 S  per = 0.633  per(accum) = 23
 T(local: rintermediates memcpy cpu2gpu) = 2.700e-08 S  per = 0.00057  per(accum) = 23
 T(local: preprocess_formulae_Rlist2   ) = 1.081e-03 S  per = 22.8  per(accum) = 45.8
 T(local: rmmtasks init                ) = 9.622e-04 S  per = 20.3  per(accum) = 66.1
 T(local: qops memset                  ) = 2.700e-08 S  per = 0.00057  per(accum) = 66.1
 T(local: preprocess_renorm_batchGPU   ) = 1.483e-03 S  per = 31.3  per(accum) = 97.5
 T(local: qops memcpy gpu2cpu          ) = 1.519e-05 S  per = 0.321  per(accum) = 97.8
 T(local: deallocate gpu memory        ) = 3.898e-05 S  per = 0.824  per(accum) = 98.6
 T(local: communication of opS and opH ) = 6.570e-05 S  per = 1.39  per(accum) = 100
##### sweep: 1.273e-01 S #####
 T(sweep: fetch) = 1.355e-03 S  per = 1.06  per(accum) = 1.06
 T(sweep: hdiag) = 1.621e-03 S  per = 1.27  per(accum) = 2.34
 T(sweep: dvdsn) = 1.047e-01 S  per = 82.2  per(accum) = 84.6
 T(sweep: decim) = 2.129e-03 S  per = 1.67  per(accum) = 86.2
 T(sweep: guess) = 1.430e-03 S  per = 1.12  per(accum) = 87.4
 T(sweep: renrm) = 1.512e-02 S  per = 11.9  per(accum) = 99.2
 T(sweep: save ) = 9.615e-04 S  per = 0.755  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.013e-01 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 2.639e-05 S  per = 0.0261  per(accum) = 0.0261
 T(sweep: symbolic_formulae_twodot     ) = 2.018e-03 S  per = 1.99  per(accum) = 2.02
 T(sweep: hintermediate init           ) = 1.782e-04 S  per = 0.176  per(accum) = 2.19
 T(sweep: hintermediates memcpy cpu2gpu) = 8.800e-08 S  per = 8.69e-05  per(accum) = 2.2
 T(sweep: preprocess_hformulae_Hxlist2 ) = 1.128e-02 S  per = 11.1  per(accum) = 13.3
 T(sweep: hmmtasks init                ) = 1.098e-02 S  per = 10.8  per(accum) = 24.2
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 7.549e-02 S  per = 74.5  per(accum) = 98.7
 T(sweep: dvdson solver [communication]) = 1.032e-04 S  per = 0.102  per(accum) = 98.8
 T(sweep: dvdson solver [rest part]    ) = 1.200e-03 S  per = 1.19  per(accum) = 100
Detailed decomposition of T(renrm): 1.465e-02 S
 T(sweep: qops init                    ) = 1.176e-03 S  per = 8.02  per(accum) = 8.02
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.188e-04 S  per = 0.811  per(accum) = 8.83
 T(sweep: symbolic_formulae_renorm     ) = 1.662e-03 S  per = 11.3  per(accum) = 20.2
 T(sweep: rintermediate init           ) = 1.196e-04 S  per = 0.816  per(accum) = 21
 T(sweep: rintermediates memcpy cpu2gpu) = 8.500e-08 S  per = 0.00058  per(accum) = 21
 T(sweep: preprocess_formulae_Rlist2   ) = 3.316e-03 S  per = 22.6  per(accum) = 43.6
 T(sweep: rmmtasks init                ) = 3.218e-03 S  per =   22  per(accum) = 65.6
 T(sweep: qops memset                  ) = 7.800e-08 S  per = 0.000532  per(accum) = 65.6
 T(sweep: preprocess_renorm_batchGPU   ) = 4.698e-03 S  per = 32.1  per(accum) = 97.6
 T(sweep: qops memcpy gpu2cpu          ) = 4.622e-05 S  per = 0.315  per(accum) = 98
 T(sweep: deallocate gpu memory        ) = 1.113e-04 S  per = 0.76  per(accum) = 98.7
 T(sweep: communication of opS and opH ) = 1.874e-04 S  per = 1.28  per(accum) = 100
##### global: 5.003e-01 S #####
 T(global: fetch) = 7.867e-03 S  per = 1.57  per(accum) = 1.57
 T(global: hdiag) = 6.197e-03 S  per = 1.24  per(accum) = 2.81
 T(global: dvdsn) = 4.172e-01 S  per = 83.4  per(accum) = 86.2
 T(global: decim) = 9.651e-03 S  per = 1.93  per(accum) = 88.1
 T(global: guess) = 4.616e-03 S  per = 0.923  per(accum) = 89.1
 T(global: renrm) = 5.151e-02 S  per = 10.3  per(accum) = 99.4
 T(global: save ) = 3.229e-03 S  per = 0.645  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.060e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 1.291e-04 S  per = 0.0318  per(accum) = 0.0318
 T(global: symbolic_formulae_twodot     ) = 7.295e-03 S  per =  1.8  per(accum) = 1.83
 T(global: hintermediate init           ) = 6.423e-04 S  per = 0.158  per(accum) = 1.99
 T(global: hintermediates memcpy cpu2gpu) = 3.170e-07 S  per = 7.81e-05  per(accum) = 1.99
 T(global: preprocess_hformulae_Hxlist2 ) = 3.720e-02 S  per = 9.16  per(accum) = 11.1
 T(global: hmmtasks init                ) = 3.644e-02 S  per = 8.97  per(accum) = 20.1
 T(global: dvdson solver [Hx_batchGPU]  ) = 3.187e-01 S  per = 78.5  per(accum) = 98.6
 T(global: dvdson solver [communication]) = 4.401e-04 S  per = 0.108  per(accum) = 98.7
 T(global: dvdson solver [rest part]    ) = 5.231e-03 S  per = 1.29  per(accum) = 100
Detailed decomposition of T(renrm): 4.993e-02 S
 T(global: qops init                    ) = 3.794e-03 S  per =  7.6  per(accum) = 7.6
 T(global: qops_dict memcpy cpu2gpu     ) = 4.653e-04 S  per = 0.932  per(accum) = 8.53
 T(global: symbolic_formulae_renorm     ) = 5.982e-03 S  per =   12  per(accum) = 20.5
 T(global: rintermediate init           ) = 4.928e-04 S  per = 0.987  per(accum) = 21.5
 T(global: rintermediates memcpy cpu2gpu) = 3.120e-07 S  per = 0.000625  per(accum) = 21.5
 T(global: preprocess_formulae_Rlist2   ) = 1.063e-02 S  per = 21.3  per(accum) = 42.8
 T(global: rmmtasks init                ) = 1.004e-02 S  per = 20.1  per(accum) = 62.9
 T(global: qops memset                  ) = 3.020e-07 S  per = 0.000605  per(accum) = 62.9
 T(global: preprocess_renorm_batchGPU   ) = 1.725e-02 S  per = 34.6  per(accum) = 97.4
 T(global: qops memcpy gpu2cpu          ) = 1.682e-04 S  per = 0.337  per(accum) = 97.8
 T(global: deallocate gpu memory        ) = 4.152e-04 S  per = 0.832  per(accum) = 98.6
 T(global: communication of opS and opH ) = 6.929e-04 S  per = 1.39  per(accum) = 100

isweep=2 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=872:0.00665MB:6.5e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1310:0.00999MB:9.76e-06GB
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44c12140
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
### DIAG TIMING: total=0.000365 t1=7.57e-06, t2=1.43e-05, t3=4.82e-05, t4=0.000185, t5=6.58e-05, t6=2.88e-05, t7=1.25e-05, t8=2.52e-06
duration_diagGPU:0.000379
duration_diagreduce:4.02e-06
duration_diagtransform:1.79e-06
rank=0 GPUmem(GB): used=9.76e-06 (oper)=9.76e-06
----- TIMING FOR symbolic_formulae_twodot with size=93 : 6.353e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=93
 no. of hintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.491e-05 S -----
rank=0 GPUmem(GB): used=1.01e-05 (oper,hinter)=9.76e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00342 S size(H_formulae)=93 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000181,0.00324 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00368 S size(H_formulae)=93 size(Hxlst)=3134 -----
rank=0 GPUmem(GB): used=0.000409 (oper,hinter,dvdson,batch)=9.76e-06,2.98e-07,1.49e-06,0.000397 blksize=4 blksize0=8 batchsize=3134
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000225,0.00204,0.000196 cost=4.22e+04 flops[gemm]=2.07e+07
--- TIMING FOR sigma : t_inter=0.000225 t_gemm=0.00204 t_reduction=0.000195 tot=0.00246 ---
 sigma counter=126 i=0 t=0.000261 per=12.8 cost=3.72e+03 flops=1.42e+07
 sigma counter=126 i=1 t=0.000267 per=13.1 cost=3.74e+03 flops=1.4e+07
 sigma counter=126 i=2 t=0.000245 per=12 cost=3.04e+03 flops=1.24e+07
 sigma counter=126 i=3 t=0.000243 per=11.9 cost=3.03e+03 flops=1.25e+07
 sigma counter=126 i=4 t=0.000255 per=12.5 cost=1e+04 flops=3.92e+07
 sigma counter=126 i=5 t=0.000254 per=12.5 cost=1e+04 flops=3.94e+07
 sigma counter=126 i=6 t=0.000263 per=12.9 cost=4.34e+03 flops=1.65e+07
 sigma counter=126 i=7 t=0.000251 per=12.3 cost=4.32e+03 flops=1.72e+07
 total GEMM cost=4.22e+04 flops=2.07e+07
--- TIMING FOR sigma_tot : t_inter=0.0267 t_gemm=0.247 t_reduction=0.0248 tot=0.299 ---
 sigma_tot counter=126 i=0 t=0.0305 per=12.3 cost=3.09e+05 flops=1.02e+07
 sigma_tot counter=126 i=1 t=0.0308 per=12.5 cost=3.16e+05 flops=1.02e+07
 sigma_tot counter=126 i=2 t=0.0304 per=12.3 cost=3.65e+05 flops=1.2e+07
 sigma_tot counter=126 i=3 t=0.0302 per=12.2 cost=3.72e+05 flops=1.23e+07
 sigma_tot counter=126 i=4 t=0.0309 per=12.5 cost=6.36e+05 flops=2.06e+07
 sigma_tot counter=126 i=5 t=0.0311 per=12.6 cost=6.38e+05 flops=2.05e+07
 sigma_tot counter=126 i=6 t=0.0321 per=13 cost=8.28e+05 flops=2.58e+07
 sigma_tot counter=126 i=7 t=0.0311 per=12.6 cost=8.23e+05 flops=2.65e+07
 total GEMM cost=4.29e+06 flops=1.74e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000209,0.00202,0.000197 cost=4.22e+04 flops[gemm]=2.09e+07
--- TIMING FOR sigma : t_inter=0.000209 t_gemm=0.00202 t_reduction=0.000197 tot=0.00242 ---
 sigma counter=127 i=0 t=0.000255 per=12.6 cost=3.72e+03 flops=1.46e+07
 sigma counter=127 i=1 t=0.00026 per=12.9 cost=3.74e+03 flops=1.44e+07
 sigma counter=127 i=2 t=0.000239 per=11.9 cost=3.04e+03 flops=1.27e+07
 sigma counter=127 i=3 t=0.000237 per=11.8 cost=3.03e+03 flops=1.28e+07
 sigma counter=127 i=4 t=0.000253 per=12.5 cost=1e+04 flops=3.95e+07
 sigma counter=127 i=5 t=0.000257 per=12.7 cost=1e+04 flops=3.89e+07
 sigma counter=127 i=6 t=0.000262 per=13 cost=4.34e+03 flops=1.65e+07
 sigma counter=127 i=7 t=0.000253 per=12.5 cost=4.32e+03 flops=1.71e+07
 total GEMM cost=4.22e+04 flops=2.09e+07
--- TIMING FOR sigma_tot : t_inter=0.0269 t_gemm=0.249 t_reduction=0.025 tot=0.301 ---
 sigma_tot counter=127 i=0 t=0.0307 per=12.3 cost=3.13e+05 flops=1.02e+07
 sigma_tot counter=127 i=1 t=0.0311 per=12.5 cost=3.19e+05 flops=1.03e+07
 sigma_tot counter=127 i=2 t=0.0306 per=12.3 cost=3.68e+05 flops=1.2e+07
 sigma_tot counter=127 i=3 t=0.0304 per=12.2 cost=3.75e+05 flops=1.23e+07
 sigma_tot counter=127 i=4 t=0.0312 per=12.5 cost=6.46e+05 flops=2.07e+07
 sigma_tot counter=127 i=5 t=0.0313 per=12.6 cost=6.48e+05 flops=2.07e+07
 sigma_tot counter=127 i=6 t=0.0323 per=13 cost=8.33e+05 flops=2.57e+07
 sigma_tot counter=127 i=7 t=0.0313 per=12.6 cost=8.28e+05 flops=2.64e+07
 total GEMM cost=4.33e+06 flops=1.74e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643 -1.003e+03  4.639e-05    2     2  5.286e-03 2.643e-03
    1   1 +      -2.436977450693 -1.002e+03  2.690e-05    2     2  5.286e-03 2.643e-03
TIMING FOR Davidson : 5.346e-03  T(cal/comm/rest)=5.231e-03,7.934e-06,1.071e-04
optimized energies: isweep=2 dots=2 ibond=3 e[0]=-2.65451696664 nmvp=2
optimized energies: isweep=2 dots=2 ibond=3 e[1]=-2.43697745069 nmvp=2
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=16 alg_decim=1 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep2_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
----- TMING FOR decimation_genbasis: 4.0e-04 S T(scatter/comp/gather)=3.8e-05,4.0e-05,3.3e-04 -----
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
 qbond: qkept nsym=6 dimAll=20
 (3,1):6 (2,0):4 (4,0):3 (2,2):3 (3,-1):2 (1,1):2
----- TIMING for decimation_row: 7.318e-04 S T(decim/formRot)=4.860e-04,2.459e-04 -----
TIMING FOR decimation: 1.107e-03 S T(wf/decim)=3.443e-04,7.622e-04
ctns::oper_renorm coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:6 A:7 B:11 P:3 Q:5 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=1612:1.230e-02MB:1.201e-05GB
rank=0 GPUmem(GB): used=2.207e-05 (oper)=1.960e-05
rank=0 GPUmem(GB): used=2.319e-05 (oper,site)(GB)=1.960e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=37 : 4.644e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 5.005e-05 S -----
rank=0 GPUmem(GB): used=2.35e-05 (oper,site,rinter)=1.96e-05,1.12e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000954 S size(rtasks)=37 size(Rlst2)=6 T(Rmu/Rlist)=0.000155,0.000799 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00103 S size(rtasks)=37 size(Rlst)=821 -----
rank=0 GPUmem(GB): used=0.000519 (oper,site,rinter,batch)=1.96e-05,1.12e-06,2.98e-07,0.000495 blksize=36 blksize0=8 batchsize=821
timing: allocate=3.48e-05 rmmtasks init=0.000988 total=0.00102
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000208,0.00115,0.000192 cost=8.44e+04 flops[gemm]=7.32e+07
--- TIMING FOR renorm : t_inter=0.000208 t_gemm=0.00115 t_reduction=0.000192 tot=0.00155 ---
 renorm counter=12 i=0 t=0.000229 per=19.9 cost=3.06e+03 flops=1.34e+07
 renorm counter=12 i=1 t=0.000228 per=19.8 cost=5.92e+03 flops=2.59e+07
 renorm counter=12 i=2 t=0.000223 per=19.3 cost=9.23e+03 flops=4.14e+07
 renorm counter=12 i=3 t=0.000226 per=19.6 cost=1.58e+04 flops=7.01e+07
 renorm counter=12 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=12 i=5 t=1e-06 per=0.0867 cost=0 flops=0
 renorm counter=12 i=6 t=0.000246 per=21.3 cost=5.03e+04 flops=2.05e+08
 total GEMM cost=8.44e+04 flops=7.32e+07
--- TIMING FOR renorm_tot : t_inter=0.00129 t_gemm=0.0138 t_reduction=0.0024 tot=0.0175 ---
 renorm_tot counter=12 i=0 t=0.00279 per=20.2 cost=2.35e+04 flops=8.43e+06
 renorm_tot counter=12 i=1 t=0.00272 per=19.7 cost=3.54e+04 flops=1.3e+07
 renorm_tot counter=12 i=2 t=0.00132 per=9.58 cost=2.38e+04 flops=1.8e+07
 renorm_tot counter=12 i=3 t=0.00134 per=9.71 cost=4.12e+04 flops=3.07e+07
 renorm_tot counter=12 i=4 t=0.00134 per=9.69 cost=2.49e+04 flops=1.86e+07
 renorm_tot counter=12 i=5 t=0.00136 per=9.86 cost=4.37e+04 flops=3.21e+07
 renorm_tot counter=12 i=6 t=0.00293 per=21.2 cost=2.96e+05 flops=1.01e+08
 total GEMM cost=4.88e+05 flops=3.54e+07
timing: gpu2cpu=1.65e-05 deallocate(site/work)=3.58e-06,6.36e-06 total=2.29e-05
check ||H-H.dagger||=5.196e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00478 S T(init/kernel/comm)=0.000323,0.00439,6.3e-05 rank=0 -----
TIMING FOR cleanup: 0.000213 T(erase/save/remove)=4.13e-06,0.000174,3.46e-05
##### local: 2.329e-02 S #####
 T(local: fetch) = 1.050e-03 S  per = 4.51  per(accum) = 4.51
 T(local: hdiag) = 5.000e-04 S  per = 2.15  per(accum) = 6.66
 T(local: dvdsn) = 1.491e-02 S  per =   64  per(accum) = 70.7
 T(local: decim) = 1.255e-03 S  per = 5.39  per(accum) = 76.1
 T(local: guess) = 4.149e-04 S  per = 1.78  per(accum) = 77.8
 T(local: renrm) = 4.936e-03 S  per = 21.2  per(accum) = 99
 T(local: save ) = 2.247e-04 S  per = 0.965  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.373e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 7.832e-06 S  per = 0.0571  per(accum) = 0.0571
 T(local: symbolic_formulae_twodot     ) = 6.446e-04 S  per =  4.7  per(accum) = 4.75
 T(local: hintermediate init           ) = 5.701e-05 S  per = 0.415  per(accum) = 5.17
 T(local: hintermediates memcpy cpu2gpu) = 3.200e-08 S  per = 0.000233  per(accum) = 5.17
 T(local: preprocess_hformulae_Hxlist2 ) = 3.785e-03 S  per = 27.6  per(accum) = 32.7
 T(local: hmmtasks init                ) = 3.886e-03 S  per = 28.3  per(accum) = 61.1
 T(local: dvdson solver [Hx_batchGPU]  ) = 5.231e-03 S  per = 38.1  per(accum) = 99.2
 T(local: dvdson solver [communication]) = 7.934e-06 S  per = 0.0578  per(accum) = 99.2
 T(local: dvdson solver [rest part]    ) = 1.071e-04 S  per = 0.78  per(accum) = 100
Detailed decomposition of T(renrm): 4.779e-03 S
 T(local: qops init                    ) = 3.231e-04 S  per = 6.76  per(accum) = 6.76
 T(local: qops_dict memcpy cpu2gpu     ) = 4.546e-05 S  per = 0.951  per(accum) = 7.71
 T(local: symbolic_formulae_renorm     ) = 4.744e-04 S  per = 9.93  per(accum) = 17.6
 T(local: rintermediate init           ) = 6.372e-05 S  per = 1.33  per(accum) = 19
 T(local: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000586  per(accum) = 19
 T(local: preprocess_formulae_Rlist2   ) = 1.059e-03 S  per = 22.2  per(accum) = 41.1
 T(local: rmmtasks init                ) = 1.031e-03 S  per = 21.6  per(accum) = 62.7
 T(local: qops memset                  ) = 2.900e-08 S  per = 0.000607  per(accum) = 62.7
 T(local: preprocess_renorm_batchGPU   ) = 1.669e-03 S  per = 34.9  per(accum) = 97.6
 T(local: qops memcpy gpu2cpu          ) = 1.658e-05 S  per = 0.347  per(accum) = 98
 T(local: deallocate gpu memory        ) = 3.386e-05 S  per = 0.709  per(accum) = 98.7
 T(local: communication of opS and opH ) = 6.302e-05 S  per = 1.32  per(accum) = 100
##### sweep: 1.506e-01 S #####
 T(sweep: fetch) = 2.405e-03 S  per =  1.6  per(accum) = 1.6
 T(sweep: hdiag) = 2.121e-03 S  per = 1.41  per(accum) = 3.01
 T(sweep: dvdsn) = 1.196e-01 S  per = 79.4  per(accum) = 82.4
 T(sweep: decim) = 3.384e-03 S  per = 2.25  per(accum) = 84.7
 T(sweep: guess) = 1.845e-03 S  per = 1.23  per(accum) = 85.9
 T(sweep: renrm) = 2.006e-02 S  per = 13.3  per(accum) = 99.2
 T(sweep: save ) = 1.186e-03 S  per = 0.788  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.150e-01 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 3.422e-05 S  per = 0.0298  per(accum) = 0.0298
 T(sweep: symbolic_formulae_twodot     ) = 2.663e-03 S  per = 2.32  per(accum) = 2.35
 T(sweep: hintermediate init           ) = 2.353e-04 S  per = 0.205  per(accum) = 2.55
 T(sweep: hintermediates memcpy cpu2gpu) = 1.200e-07 S  per = 0.000104  per(accum) = 2.55
 T(sweep: preprocess_hformulae_Hxlist2 ) = 1.506e-02 S  per = 13.1  per(accum) = 15.6
 T(sweep: hmmtasks init                ) = 1.487e-02 S  per = 12.9  per(accum) = 28.6
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 8.072e-02 S  per = 70.2  per(accum) = 98.8
 T(sweep: dvdson solver [communication]) = 1.112e-04 S  per = 0.0967  per(accum) = 98.9
 T(sweep: dvdson solver [rest part]    ) = 1.307e-03 S  per = 1.14  per(accum) = 100
Detailed decomposition of T(renrm): 1.943e-02 S
 T(sweep: qops init                    ) = 1.499e-03 S  per = 7.71  per(accum) = 7.71
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.643e-04 S  per = 0.845  per(accum) = 8.56
 T(sweep: symbolic_formulae_renorm     ) = 2.136e-03 S  per =   11  per(accum) = 19.6
 T(sweep: rintermediate init           ) = 1.834e-04 S  per = 0.944  per(accum) = 20.5
 T(sweep: rintermediates memcpy cpu2gpu) = 1.130e-07 S  per = 0.000582  per(accum) = 20.5
 T(sweep: preprocess_formulae_Rlist2   ) = 4.376e-03 S  per = 22.5  per(accum) = 43
 T(sweep: rmmtasks init                ) = 4.249e-03 S  per = 21.9  per(accum) = 64.9
 T(sweep: qops memset                  ) = 1.070e-07 S  per = 0.000551  per(accum) = 64.9
 T(sweep: preprocess_renorm_batchGPU   ) = 6.366e-03 S  per = 32.8  per(accum) = 97.6
 T(sweep: qops memcpy gpu2cpu          ) = 6.281e-05 S  per = 0.323  per(accum) = 98
 T(sweep: deallocate gpu memory        ) = 1.452e-04 S  per = 0.747  per(accum) = 98.7
 T(sweep: communication of opS and opH ) = 2.504e-04 S  per = 1.29  per(accum) = 100
##### global: 5.235e-01 S #####
 T(global: fetch) = 8.917e-03 S  per =  1.7  per(accum) = 1.7
 T(global: hdiag) = 6.697e-03 S  per = 1.28  per(accum) = 2.98
 T(global: dvdsn) = 4.321e-01 S  per = 82.5  per(accum) = 85.5
 T(global: decim) = 1.091e-02 S  per = 2.08  per(accum) = 87.6
 T(global: guess) = 5.031e-03 S  per = 0.961  per(accum) = 88.6
 T(global: renrm) = 5.644e-02 S  per = 10.8  per(accum) = 99.3
 T(global: save ) = 3.453e-03 S  per = 0.66  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.198e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 1.369e-04 S  per = 0.0326  per(accum) = 0.0326
 T(global: symbolic_formulae_twodot     ) = 7.940e-03 S  per = 1.89  per(accum) = 1.92
 T(global: hintermediate init           ) = 6.994e-04 S  per = 0.167  per(accum) = 2.09
 T(global: hintermediates memcpy cpu2gpu) = 3.490e-07 S  per = 8.31e-05  per(accum) = 2.09
 T(global: preprocess_hformulae_Hxlist2 ) = 4.098e-02 S  per = 9.76  per(accum) = 11.9
 T(global: hmmtasks init                ) = 4.032e-02 S  per = 9.61  per(accum) = 21.5
 T(global: dvdson solver [Hx_batchGPU]  ) = 3.239e-01 S  per = 77.2  per(accum) = 98.6
 T(global: dvdson solver [communication]) = 4.481e-04 S  per = 0.107  per(accum) = 98.7
 T(global: dvdson solver [rest part]    ) = 5.338e-03 S  per = 1.27  per(accum) = 100
Detailed decomposition of T(renrm): 5.471e-02 S
 T(global: qops init                    ) = 4.117e-03 S  per = 7.52  per(accum) = 7.52
 T(global: qops_dict memcpy cpu2gpu     ) = 5.108e-04 S  per = 0.934  per(accum) = 8.46
 T(global: symbolic_formulae_renorm     ) = 6.456e-03 S  per = 11.8  per(accum) = 20.3
 T(global: rintermediate init           ) = 5.565e-04 S  per = 1.02  per(accum) = 21.3
 T(global: rintermediates memcpy cpu2gpu) = 3.400e-07 S  per = 0.000621  per(accum) = 21.3
 T(global: preprocess_formulae_Rlist2   ) = 1.169e-02 S  per = 21.4  per(accum) = 42.6
 T(global: rmmtasks init                ) = 1.107e-02 S  per = 20.2  per(accum) = 62.9
 T(global: qops memset                  ) = 3.310e-07 S  per = 0.000605  per(accum) = 62.9
 T(global: preprocess_renorm_batchGPU   ) = 1.892e-02 S  per = 34.6  per(accum) = 97.5
 T(global: qops memcpy gpu2cpu          ) = 1.848e-04 S  per = 0.338  per(accum) = 97.8
 T(global: deallocate gpu memory        ) = 4.491e-04 S  per = 0.821  per(accum) = 98.6
 T(global: communication of opS and opH ) = 7.559e-04 S  per = 1.38  per(accum) = 100

======================================================================
sweep_data::summary isweep=2
----------------------------------------------------------------------
sweep parameters: isweep=2 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.0515
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.0229
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.0529
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.0233
 eav_max=-2.54574720706 [ibond=1]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=3]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=1.60478563771e-09
 sweep energies: isweep=2 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[0]=-2.65451696664
 sweep energies: isweep=2 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=2
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.000e-04 1.000e-04 | 51 | 1.940e-01 | 1.940e-01 | 1.116e-02 1.028e-01 1.083e-02 1.248e-01 64.4
            1  2      20 1.000e-04 0.000e+00 | 45 | 1.842e-01 | 3.782e-01 | 2.111e-02 1.958e-01 2.052e-02 2.375e-01 62.8
            2  2      20 1.000e-04 0.000e+00 | 31 | 1.533e-01 | 5.315e-01 | 2.821e-02 2.628e-01 2.744e-02 3.185e-01 59.9
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.505e-03 e[0]=-2.65208108952 (2.436e-03) e[1]=-2.43068987874 (6.288e-03)
            1      20 +0.000e+00 e[0]=-2.65451696664 (4.011e-12) e[1]=-2.43697745069 (-2.673e-13)
            2      20 +5.258e-04 e[0]=-2.65451696664 (0.000e+00) e[1]=-2.43697745069 (0.000e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep2.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row_nkr dcut=8 nqr=12 alg_decim=0 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep2_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
----- TMING FOR decimation_genbasis: 5.477e-05 S T(scatter/comp/gather)=6.394e-06,4.439e-05,3.983e-06 -----
decimation summary: 80->8 dwt=-2.220e-16 SvN=1.326e+00
 qbond: qkept nsym=4 dimAll=8
 (3,1):2 (4,0):2 (5,1):2 (4,2):2
----- TIMING for decimation_row: 3.282e-04 S T(decim/formRot)=1.178e-04,2.104e-04 -----

Convert [C]RRR => [cR]RRR:
ctns::decimation_row_nkr dcut=2 nqr=9 alg_decim=0 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep2_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
----- TMING FOR decimation_genbasis: 2.797e-05 S T(scatter/comp/gather)=4.324e-06,2.151e-05,2.131e-06 -----
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00
 qbond: qkept nsym=1 dimAll=2
 (5,1):2
----- TIMING for decimation_row: 2.156e-04 S T(decim/formRot)=8.241e-05,1.332e-04 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep2.info

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.000e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.000e+00
 idx=2 node=(2,0) Drow=20 maxdiff=1.590e-15
 idx=3 node=(1,0) Drow=8 maxdiff=3.408e-16
 idx=4 node=(0,0) Drow=2 maxdiff=3.511e-16
stensor2: wf2 own=1 _data=0x449c7ee0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.052e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x449c7ee0
     -8.8297e-18      -1.0000e+00 
      1.0000e+00      -3.4582e-18 
 rwfuns: nroots=2 maxdiff=7.5964e-18
----- TIMING FOR ctns::rcanon_check : 2.347e-04 S -----
..... end of isweep = 2 .....

======================================================================
sweep parameters: isweep=3 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB

isweep=3 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=872:0.00665MB:6.5e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1310:0.00999MB:9.76e-06GB
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x45145e40
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
### DIAG TIMING: total=0.000406 t1=1.68e-05, t2=2.1e-05, t3=5.52e-05, t4=0.000191, t5=7.57e-05, t6=2.97e-05, t7=1.35e-05, t8=3.01e-06
duration_diagGPU:0.000421
duration_diagreduce:4.48e-06
duration_diagtransform:1.87e-06
rank=0 GPUmem(GB): used=2.18e-05 (oper)=9.76e-06
----- TIMING FOR symbolic_formulae_twodot with size=93 : 6.969e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=93
 no. of hintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.828e-05 S -----
rank=0 GPUmem(GB): used=2.21e-05 (oper,hinter)=9.76e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00357 S size(H_formulae)=93 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000197,0.00337 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00383 S size(H_formulae)=93 size(Hxlst)=3134 -----
rank=0 GPUmem(GB): used=0.000421 (oper,hinter,dvdson,batch)=9.76e-06,2.98e-07,1.49e-06,0.000397 blksize=4 blksize0=8 batchsize=3134
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.3e-05,0.000219,0.00203,0.0002 cost=4.22e+04 flops[gemm]=2.08e+07
--- TIMING FOR sigma : t_inter=0.000219 t_gemm=0.00203 t_reduction=0.0002 tot=0.00245 ---
 sigma counter=128 i=0 t=0.000256 per=12.6 cost=3.72e+03 flops=1.45e+07
 sigma counter=128 i=1 t=0.000263 per=13 cost=3.74e+03 flops=1.42e+07
 sigma counter=128 i=2 t=0.000241 per=11.9 cost=3.04e+03 flops=1.26e+07
 sigma counter=128 i=3 t=0.000243 per=12 cost=3.03e+03 flops=1.25e+07
 sigma counter=128 i=4 t=0.000257 per=12.7 cost=1e+04 flops=3.89e+07
 sigma counter=128 i=5 t=0.000255 per=12.6 cost=1e+04 flops=3.92e+07
 sigma counter=128 i=6 t=0.000262 per=12.9 cost=4.34e+03 flops=1.65e+07
 sigma counter=128 i=7 t=0.00025 per=12.3 cost=4.32e+03 flops=1.73e+07
 total GEMM cost=4.22e+04 flops=2.08e+07
--- TIMING FOR sigma_tot : t_inter=0.0271 t_gemm=0.251 t_reduction=0.0252 tot=0.303 ---
 sigma_tot counter=128 i=0 t=0.031 per=12.3 cost=3.17e+05 flops=1.02e+07
 sigma_tot counter=128 i=1 t=0.0314 per=12.5 cost=3.23e+05 flops=1.03e+07
 sigma_tot counter=128 i=2 t=0.0308 per=12.3 cost=3.71e+05 flops=1.2e+07
 sigma_tot counter=128 i=3 t=0.0307 per=12.2 cost=3.78e+05 flops=1.23e+07
 sigma_tot counter=128 i=4 t=0.0314 per=12.5 cost=6.56e+05 flops=2.09e+07
 sigma_tot counter=128 i=5 t=0.0316 per=12.6 cost=6.58e+05 flops=2.08e+07
 sigma_tot counter=128 i=6 t=0.0326 per=13 cost=8.37e+05 flops=2.57e+07
 sigma_tot counter=128 i=7 t=0.0316 per=12.6 cost=8.32e+05 flops=2.63e+07
 total GEMM cost=4.37e+06 flops=1.74e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.00021,0.00202,0.000196 cost=4.22e+04 flops[gemm]=2.09e+07
--- TIMING FOR sigma : t_inter=0.00021 t_gemm=0.00201 t_reduction=0.000195 tot=0.00242 ---
 sigma counter=129 i=0 t=0.000252 per=12.5 cost=3.72e+03 flops=1.47e+07
 sigma counter=129 i=1 t=0.000259 per=12.9 cost=3.74e+03 flops=1.44e+07
 sigma counter=129 i=2 t=0.000239 per=11.9 cost=3.04e+03 flops=1.27e+07
 sigma counter=129 i=3 t=0.000238 per=11.8 cost=3.03e+03 flops=1.27e+07
 sigma counter=129 i=4 t=0.000255 per=12.7 cost=1e+04 flops=3.92e+07
 sigma counter=129 i=5 t=0.000259 per=12.9 cost=1e+04 flops=3.86e+07
 sigma counter=129 i=6 t=0.00026 per=12.9 cost=4.34e+03 flops=1.67e+07
 sigma counter=129 i=7 t=0.000253 per=12.6 cost=4.32e+03 flops=1.71e+07
 total GEMM cost=4.22e+04 flops=2.09e+07
--- TIMING FOR sigma_tot : t_inter=0.0274 t_gemm=0.253 t_reduction=0.0254 tot=0.306 ---
 sigma_tot counter=129 i=0 t=0.0312 per=12.3 cost=3.21e+05 flops=1.03e+07
 sigma_tot counter=129 i=1 t=0.0316 per=12.5 cost=3.27e+05 flops=1.03e+07
 sigma_tot counter=129 i=2 t=0.0311 per=12.3 cost=3.74e+05 flops=1.2e+07
 sigma_tot counter=129 i=3 t=0.0309 per=12.2 cost=3.81e+05 flops=1.23e+07
 sigma_tot counter=129 i=4 t=0.0317 per=12.5 cost=6.66e+05 flops=2.1e+07
 sigma_tot counter=129 i=5 t=0.0318 per=12.6 cost=6.68e+05 flops=2.1e+07
 sigma_tot counter=129 i=6 t=0.0329 per=13 cost=8.41e+05 flops=2.56e+07
 sigma_tot counter=129 i=7 t=0.0318 per=12.6 cost=8.36e+05 flops=2.63e+07
 total GEMM cost=4.42e+06 flops=1.74e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891 -1.003e+03  6.876e-02    2     2  5.333e-03 2.666e-03
    1   1 -      -2.436233901339 -1.002e+03  4.380e-02    2     2  5.333e-03 2.666e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.180e-04,2.024e-03,1.950e-04 cost=4.217e+04 flops[gemm]=2.083e+07
--- TIMING FOR sigma : t_inter=2.180e-04 t_gemm=2.024e-03 t_reduction=1.950e-04 tot=2.437e-03 ---
 sigma counter=130 i=0 t=2.580e-04 per=1.275e+01 cost=3.716e+03 flops=1.440e+07
 sigma counter=130 i=1 t=2.600e-04 per=1.285e+01 cost=3.736e+03 flops=1.437e+07
 sigma counter=130 i=2 t=2.410e-04 per=1.191e+01 cost=3.036e+03 flops=1.260e+07
 sigma counter=130 i=3 t=2.370e-04 per=1.171e+01 cost=3.026e+03 flops=1.277e+07
 sigma counter=130 i=4 t=2.550e-04 per=1.260e+01 cost=1.000e+04 flops=3.922e+07
 sigma counter=130 i=5 t=2.580e-04 per=1.275e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=130 i=6 t=2.630e-04 per=1.299e+01 cost=4.336e+03 flops=1.649e+07
 sigma counter=130 i=7 t=2.520e-04 per=1.245e+01 cost=4.316e+03 flops=1.713e+07
 total GEMM cost=4.217e+04 flops=2.083e+07
--- TIMING FOR sigma_tot : t_inter=2.757e-02 t_gemm=2.551e-01 t_reduction=2.563e-02 tot=3.083e-01 ---
 sigma_tot counter=130 i=0 t=3.149e-02 per=1.235e+01 cost=3.243e+05 flops=1.030e+07
 sigma_tot counter=130 i=1 t=3.187e-02 per=1.249e+01 cost=3.304e+05 flops=1.037e+07
 sigma_tot counter=130 i=2 t=3.132e-02 per=1.228e+01 cost=3.772e+05 flops=1.204e+07
 sigma_tot counter=130 i=3 t=3.116e-02 per=1.221e+01 cost=3.843e+05 flops=1.233e+07
 sigma_tot counter=130 i=4 t=3.193e-02 per=1.251e+01 cost=6.763e+05 flops=2.118e+07
 sigma_tot counter=130 i=5 t=3.211e-02 per=1.259e+01 cost=6.784e+05 flops=2.113e+07
 sigma_tot counter=130 i=6 t=3.313e-02 per=1.299e+01 cost=8.457e+05 flops=2.553e+07
 sigma_tot counter=130 i=7 t=3.210e-02 per=1.258e+01 cost=8.407e+05 flops=2.619e+07
 total GEMM cost=4.457e+06 flops=1.747e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.130e-04,2.026e-03,1.970e-04 cost=4.217e+04 flops[gemm]=2.081e+07
--- TIMING FOR sigma : t_inter=2.120e-04 t_gemm=2.026e-03 t_reduction=1.970e-04 tot=2.435e-03 ---
 sigma counter=131 i=0 t=2.540e-04 per=1.254e+01 cost=3.716e+03 flops=1.463e+07
 sigma counter=131 i=1 t=2.510e-04 per=1.239e+01 cost=3.736e+03 flops=1.488e+07
 sigma counter=131 i=2 t=2.410e-04 per=1.190e+01 cost=3.036e+03 flops=1.260e+07
 sigma counter=131 i=3 t=2.440e-04 per=1.204e+01 cost=3.026e+03 flops=1.240e+07
 sigma counter=131 i=4 t=2.640e-04 per=1.303e+01 cost=1.000e+04 flops=3.788e+07
 sigma counter=131 i=5 t=2.560e-04 per=1.264e+01 cost=1.000e+04 flops=3.906e+07
 sigma counter=131 i=6 t=2.590e-04 per=1.278e+01 cost=4.336e+03 flops=1.674e+07
 sigma counter=131 i=7 t=2.570e-04 per=1.269e+01 cost=4.316e+03 flops=1.679e+07
 total GEMM cost=4.217e+04 flops=2.081e+07
--- TIMING FOR sigma_tot : t_inter=2.778e-02 t_gemm=2.571e-01 t_reduction=2.583e-02 tot=3.107e-01 ---
 sigma_tot counter=131 i=0 t=3.175e-02 per=1.235e+01 cost=3.280e+05 flops=1.033e+07
 sigma_tot counter=131 i=1 t=3.212e-02 per=1.249e+01 cost=3.342e+05 flops=1.040e+07
 sigma_tot counter=131 i=2 t=3.156e-02 per=1.227e+01 cost=3.802e+05 flops=1.205e+07
 sigma_tot counter=131 i=3 t=3.140e-02 per=1.221e+01 cost=3.873e+05 flops=1.233e+07
 sigma_tot counter=131 i=4 t=3.219e-02 per=1.252e+01 cost=6.863e+05 flops=2.132e+07
 sigma_tot counter=131 i=5 t=3.236e-02 per=1.259e+01 cost=6.884e+05 flops=2.127e+07
 sigma_tot counter=131 i=6 t=3.339e-02 per=1.298e+01 cost=8.500e+05 flops=2.546e+07
 sigma_tot counter=131 i=7 t=3.236e-02 per=1.258e+01 cost=8.450e+05 flops=2.612e+07
 total GEMM cost=4.500e+06 flops=1.750e+07
    2   0 -      -2.654428675110 -1.727e-03  1.261e-02    4     4  1.074e-02 2.685e-03
    2   1 -      -2.436964455587 -7.306e-04  4.223e-03    4     4  1.074e-02 2.685e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.170e-04,2.023e-03,1.990e-04 cost=4.217e+04 flops[gemm]=2.084e+07
--- TIMING FOR sigma : t_inter=2.170e-04 t_gemm=2.023e-03 t_reduction=1.990e-04 tot=2.439e-03 ---
 sigma counter=132 i=0 t=2.620e-04 per=1.295e+01 cost=3.716e+03 flops=1.418e+07
 sigma counter=132 i=1 t=2.620e-04 per=1.295e+01 cost=3.736e+03 flops=1.426e+07
 sigma counter=132 i=2 t=2.360e-04 per=1.167e+01 cost=3.036e+03 flops=1.286e+07
 sigma counter=132 i=3 t=2.380e-04 per=1.176e+01 cost=3.026e+03 flops=1.271e+07
 sigma counter=132 i=4 t=2.540e-04 per=1.256e+01 cost=1.000e+04 flops=3.937e+07
 sigma counter=132 i=5 t=2.570e-04 per=1.270e+01 cost=1.000e+04 flops=3.891e+07
 sigma counter=132 i=6 t=2.620e-04 per=1.295e+01 cost=4.336e+03 flops=1.655e+07
 sigma counter=132 i=7 t=2.520e-04 per=1.246e+01 cost=4.316e+03 flops=1.713e+07
 total GEMM cost=4.217e+04 flops=2.084e+07
--- TIMING FOR sigma_tot : t_inter=2.800e-02 t_gemm=2.592e-01 t_reduction=2.603e-02 tot=3.132e-01 ---
 sigma_tot counter=132 i=0 t=3.201e-02 per=1.235e+01 cost=3.317e+05 flops=1.036e+07
 sigma_tot counter=132 i=1 t=3.239e-02 per=1.250e+01 cost=3.379e+05 flops=1.043e+07
 sigma_tot counter=132 i=2 t=3.180e-02 per=1.227e+01 cost=3.833e+05 flops=1.205e+07
 sigma_tot counter=132 i=3 t=3.164e-02 per=1.221e+01 cost=3.903e+05 flops=1.234e+07
 sigma_tot counter=132 i=4 t=3.244e-02 per=1.252e+01 cost=6.963e+05 flops=2.146e+07
 sigma_tot counter=132 i=5 t=3.262e-02 per=1.259e+01 cost=6.984e+05 flops=2.141e+07
 sigma_tot counter=132 i=6 t=3.365e-02 per=1.298e+01 cost=8.543e+05 flops=2.539e+07
 sigma_tot counter=132 i=7 t=3.261e-02 per=1.258e+01 cost=8.494e+05 flops=2.605e+07
 total GEMM cost=4.542e+06 flops=1.752e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.090e-04,2.020e-03,2.000e-04 cost=4.217e+04 flops[gemm]=2.087e+07
--- TIMING FOR sigma : t_inter=2.090e-04 t_gemm=2.020e-03 t_reduction=2.000e-04 tot=2.429e-03 ---
 sigma counter=133 i=0 t=2.500e-04 per=1.238e+01 cost=3.716e+03 flops=1.486e+07
 sigma counter=133 i=1 t=2.600e-04 per=1.287e+01 cost=3.736e+03 flops=1.437e+07
 sigma counter=133 i=2 t=2.440e-04 per=1.208e+01 cost=3.036e+03 flops=1.244e+07
 sigma counter=133 i=3 t=2.370e-04 per=1.173e+01 cost=3.026e+03 flops=1.277e+07
 sigma counter=133 i=4 t=2.520e-04 per=1.248e+01 cost=1.000e+04 flops=3.968e+07
 sigma counter=133 i=5 t=2.560e-04 per=1.267e+01 cost=1.000e+04 flops=3.906e+07
 sigma counter=133 i=6 t=2.650e-04 per=1.312e+01 cost=4.336e+03 flops=1.636e+07
 sigma counter=133 i=7 t=2.560e-04 per=1.267e+01 cost=4.316e+03 flops=1.686e+07
 total GEMM cost=4.217e+04 flops=2.087e+07
--- TIMING FOR sigma_tot : t_inter=2.821e-02 t_gemm=2.612e-01 t_reduction=2.623e-02 tot=3.156e-01 ---
 sigma_tot counter=133 i=0 t=3.226e-02 per=1.235e+01 cost=3.355e+05 flops=1.040e+07
 sigma_tot counter=133 i=1 t=3.265e-02 per=1.250e+01 cost=3.417e+05 flops=1.047e+07
 sigma_tot counter=133 i=2 t=3.204e-02 per=1.227e+01 cost=3.863e+05 flops=1.206e+07
 sigma_tot counter=133 i=3 t=3.188e-02 per=1.221e+01 cost=3.934e+05 flops=1.234e+07
 sigma_tot counter=133 i=4 t=3.270e-02 per=1.252e+01 cost=7.063e+05 flops=2.160e+07
 sigma_tot counter=133 i=5 t=3.288e-02 per=1.259e+01 cost=7.084e+05 flops=2.155e+07
 sigma_tot counter=133 i=6 t=3.391e-02 per=1.298e+01 cost=8.587e+05 flops=2.532e+07
 sigma_tot counter=133 i=7 t=3.286e-02 per=1.258e+01 cost=8.537e+05 flops=2.598e+07
 total GEMM cost=4.584e+06 flops=1.755e+07
    3   0 -      -2.654509664652 -8.099e-05  3.660e-03    6     6  1.608e-02 2.680e-03
    3   1 -      -2.436976459250 -1.200e-05  1.113e-03    6     6  1.608e-02 2.680e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.300e-05,2.220e-04,2.014e-03,1.950e-04 cost=4.217e+04 flops[gemm]=2.094e+07
--- TIMING FOR sigma : t_inter=2.220e-04 t_gemm=2.013e-03 t_reduction=1.950e-04 tot=2.430e-03 ---
 sigma counter=134 i=0 t=2.540e-04 per=1.262e+01 cost=3.716e+03 flops=1.463e+07
 sigma counter=134 i=1 t=2.610e-04 per=1.297e+01 cost=3.736e+03 flops=1.431e+07
 sigma counter=134 i=2 t=2.380e-04 per=1.182e+01 cost=3.036e+03 flops=1.276e+07
 sigma counter=134 i=3 t=2.390e-04 per=1.187e+01 cost=3.026e+03 flops=1.266e+07
 sigma counter=134 i=4 t=2.550e-04 per=1.267e+01 cost=1.000e+04 flops=3.922e+07
 sigma counter=134 i=5 t=2.560e-04 per=1.272e+01 cost=1.000e+04 flops=3.906e+07
 sigma counter=134 i=6 t=2.600e-04 per=1.292e+01 cost=4.336e+03 flops=1.668e+07
 sigma counter=134 i=7 t=2.500e-04 per=1.242e+01 cost=4.316e+03 flops=1.726e+07
 total GEMM cost=4.217e+04 flops=2.095e+07
--- TIMING FOR sigma_tot : t_inter=2.843e-02 t_gemm=2.632e-01 t_reduction=2.642e-02 tot=3.180e-01 ---
 sigma_tot counter=134 i=0 t=3.251e-02 per=1.235e+01 cost=3.392e+05 flops=1.043e+07
 sigma_tot counter=134 i=1 t=3.291e-02 per=1.250e+01 cost=3.454e+05 flops=1.050e+07
 sigma_tot counter=134 i=2 t=3.228e-02 per=1.226e+01 cost=3.893e+05 flops=1.206e+07
 sigma_tot counter=134 i=3 t=3.212e-02 per=1.220e+01 cost=3.964e+05 flops=1.234e+07
 sigma_tot counter=134 i=4 t=3.295e-02 per=1.252e+01 cost=7.163e+05 flops=2.174e+07
 sigma_tot counter=134 i=5 t=3.313e-02 per=1.259e+01 cost=7.184e+05 flops=2.168e+07
 sigma_tot counter=134 i=6 t=3.417e-02 per=1.298e+01 cost=8.630e+05 flops=2.525e+07
 sigma_tot counter=134 i=7 t=3.311e-02 per=1.258e+01 cost=8.580e+05 flops=2.591e+07
 total GEMM cost=4.626e+06 flops=1.758e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.100e-04,2.010e-03,1.950e-04 cost=4.217e+04 flops[gemm]=2.098e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=2.010e-03 t_reduction=1.950e-04 tot=2.415e-03 ---
 sigma counter=135 i=0 t=2.540e-04 per=1.264e+01 cost=3.716e+03 flops=1.463e+07
 sigma counter=135 i=1 t=2.530e-04 per=1.259e+01 cost=3.736e+03 flops=1.477e+07
 sigma counter=135 i=2 t=2.360e-04 per=1.174e+01 cost=3.036e+03 flops=1.286e+07
 sigma counter=135 i=3 t=2.390e-04 per=1.189e+01 cost=3.026e+03 flops=1.266e+07
 sigma counter=135 i=4 t=2.540e-04 per=1.264e+01 cost=1.000e+04 flops=3.937e+07
 sigma counter=135 i=5 t=2.620e-04 per=1.303e+01 cost=1.000e+04 flops=3.817e+07
 sigma counter=135 i=6 t=2.600e-04 per=1.294e+01 cost=4.336e+03 flops=1.668e+07
 sigma counter=135 i=7 t=2.520e-04 per=1.254e+01 cost=4.316e+03 flops=1.713e+07
 total GEMM cost=4.217e+04 flops=2.098e+07
--- TIMING FOR sigma_tot : t_inter=2.864e-02 t_gemm=2.652e-01 t_reduction=2.662e-02 tot=3.205e-01 ---
 sigma_tot counter=135 i=0 t=3.277e-02 per=1.236e+01 cost=3.429e+05 flops=1.046e+07
 sigma_tot counter=135 i=1 t=3.316e-02 per=1.250e+01 cost=3.491e+05 flops=1.053e+07
 sigma_tot counter=135 i=2 t=3.252e-02 per=1.226e+01 cost=3.924e+05 flops=1.207e+07
 sigma_tot counter=135 i=3 t=3.236e-02 per=1.220e+01 cost=3.994e+05 flops=1.234e+07
 sigma_tot counter=135 i=4 t=3.320e-02 per=1.252e+01 cost=7.263e+05 flops=2.187e+07
 sigma_tot counter=135 i=5 t=3.339e-02 per=1.259e+01 cost=7.284e+05 flops=2.181e+07
 sigma_tot counter=135 i=6 t=3.443e-02 per=1.298e+01 cost=8.673e+05 flops=2.519e+07
 sigma_tot counter=135 i=7 t=3.337e-02 per=1.258e+01 cost=8.623e+05 flops=2.584e+07
 total GEMM cost=4.668e+06 flops=1.760e+07
    4   0 -      -2.654516020764 -6.356e-06  1.139e-03    6     8  2.132e-02 2.665e-03
    4   1 -      -2.436977285934 -8.267e-07  4.032e-04    6     8  2.132e-02 2.665e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.180e-04,2.012e-03,1.960e-04 cost=4.217e+04 flops[gemm]=2.096e+07
--- TIMING FOR sigma : t_inter=2.180e-04 t_gemm=2.011e-03 t_reduction=1.960e-04 tot=2.425e-03 ---
 sigma counter=136 i=0 t=2.530e-04 per=1.258e+01 cost=3.716e+03 flops=1.469e+07
 sigma counter=136 i=1 t=2.620e-04 per=1.303e+01 cost=3.736e+03 flops=1.426e+07
 sigma counter=136 i=2 t=2.380e-04 per=1.183e+01 cost=3.036e+03 flops=1.276e+07
 sigma counter=136 i=3 t=2.380e-04 per=1.183e+01 cost=3.026e+03 flops=1.271e+07
 sigma counter=136 i=4 t=2.510e-04 per=1.248e+01 cost=1.000e+04 flops=3.984e+07
 sigma counter=136 i=5 t=2.580e-04 per=1.283e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=136 i=6 t=2.620e-04 per=1.303e+01 cost=4.336e+03 flops=1.655e+07
 sigma counter=136 i=7 t=2.490e-04 per=1.238e+01 cost=4.316e+03 flops=1.733e+07
 total GEMM cost=4.217e+04 flops=2.097e+07
--- TIMING FOR sigma_tot : t_inter=2.886e-02 t_gemm=2.672e-01 t_reduction=2.681e-02 tot=3.229e-01 ---
 sigma_tot counter=136 i=0 t=3.302e-02 per=1.236e+01 cost=3.466e+05 flops=1.050e+07
 sigma_tot counter=136 i=1 t=3.342e-02 per=1.251e+01 cost=3.529e+05 flops=1.056e+07
 sigma_tot counter=136 i=2 t=3.275e-02 per=1.226e+01 cost=3.954e+05 flops=1.207e+07
 sigma_tot counter=136 i=3 t=3.260e-02 per=1.220e+01 cost=4.024e+05 flops=1.235e+07
 sigma_tot counter=136 i=4 t=3.346e-02 per=1.252e+01 cost=7.363e+05 flops=2.201e+07
 sigma_tot counter=136 i=5 t=3.365e-02 per=1.259e+01 cost=7.384e+05 flops=2.194e+07
 sigma_tot counter=136 i=6 t=3.469e-02 per=1.298e+01 cost=8.717e+05 flops=2.512e+07
 sigma_tot counter=136 i=7 t=3.362e-02 per=1.258e+01 cost=8.666e+05 flops=2.578e+07
 total GEMM cost=4.710e+06 flops=1.763e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.140e-04,2.003e-03,1.940e-04 cost=4.217e+04 flops[gemm]=2.105e+07
--- TIMING FOR sigma : t_inter=2.140e-04 t_gemm=2.003e-03 t_reduction=1.940e-04 tot=2.411e-03 ---
 sigma counter=137 i=0 t=2.530e-04 per=1.263e+01 cost=3.716e+03 flops=1.469e+07
 sigma counter=137 i=1 t=2.550e-04 per=1.273e+01 cost=3.736e+03 flops=1.465e+07
 sigma counter=137 i=2 t=2.380e-04 per=1.188e+01 cost=3.036e+03 flops=1.276e+07
 sigma counter=137 i=3 t=2.380e-04 per=1.188e+01 cost=3.026e+03 flops=1.271e+07
 sigma counter=137 i=4 t=2.520e-04 per=1.258e+01 cost=1.000e+04 flops=3.968e+07
 sigma counter=137 i=5 t=2.580e-04 per=1.288e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=137 i=6 t=2.580e-04 per=1.288e+01 cost=4.336e+03 flops=1.681e+07
 sigma counter=137 i=7 t=2.510e-04 per=1.253e+01 cost=4.316e+03 flops=1.720e+07
 total GEMM cost=4.217e+04 flops=2.105e+07
--- TIMING FOR sigma_tot : t_inter=2.907e-02 t_gemm=2.692e-01 t_reduction=2.701e-02 tot=3.253e-01 ---
 sigma_tot counter=137 i=0 t=3.327e-02 per=1.236e+01 cost=3.503e+05 flops=1.053e+07
 sigma_tot counter=137 i=1 t=3.368e-02 per=1.251e+01 cost=3.566e+05 flops=1.059e+07
 sigma_tot counter=137 i=2 t=3.299e-02 per=1.225e+01 cost=3.985e+05 flops=1.208e+07
 sigma_tot counter=137 i=3 t=3.283e-02 per=1.220e+01 cost=4.055e+05 flops=1.235e+07
 sigma_tot counter=137 i=4 t=3.371e-02 per=1.252e+01 cost=7.463e+05 flops=2.214e+07
 sigma_tot counter=137 i=5 t=3.391e-02 per=1.260e+01 cost=7.484e+05 flops=2.207e+07
 sigma_tot counter=137 i=6 t=3.495e-02 per=1.298e+01 cost=8.760e+05 flops=2.506e+07
 sigma_tot counter=137 i=7 t=3.387e-02 per=1.258e+01 cost=8.709e+05 flops=2.572e+07
 total GEMM cost=4.753e+06 flops=1.765e+07
    5   0 -      -2.654516818921 -7.982e-07  4.446e-04    6    10  2.665e-02 2.665e-03
    5   1 -      -2.436977409925 -1.240e-07  2.046e-04    6    10  2.665e-02 2.665e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.300e-05,2.150e-04,2.019e-03,1.940e-04 cost=4.217e+04 flops[gemm]=2.088e+07
--- TIMING FOR sigma : t_inter=2.150e-04 t_gemm=2.018e-03 t_reduction=1.940e-04 tot=2.427e-03 ---
 sigma counter=138 i=0 t=2.600e-04 per=1.288e+01 cost=3.716e+03 flops=1.429e+07
 sigma counter=138 i=1 t=2.600e-04 per=1.288e+01 cost=3.736e+03 flops=1.437e+07
 sigma counter=138 i=2 t=2.380e-04 per=1.179e+01 cost=3.036e+03 flops=1.276e+07
 sigma counter=138 i=3 t=2.370e-04 per=1.174e+01 cost=3.026e+03 flops=1.277e+07
 sigma counter=138 i=4 t=2.540e-04 per=1.259e+01 cost=1.000e+04 flops=3.937e+07
 sigma counter=138 i=5 t=2.550e-04 per=1.264e+01 cost=1.000e+04 flops=3.922e+07
 sigma counter=138 i=6 t=2.610e-04 per=1.293e+01 cost=4.336e+03 flops=1.661e+07
 sigma counter=138 i=7 t=2.530e-04 per=1.254e+01 cost=4.316e+03 flops=1.706e+07
 total GEMM cost=4.217e+04 flops=2.089e+07
--- TIMING FOR sigma_tot : t_inter=2.929e-02 t_gemm=2.712e-01 t_reduction=2.720e-02 tot=3.277e-01 ---
 sigma_tot counter=138 i=0 t=3.353e-02 per=1.236e+01 cost=3.540e+05 flops=1.056e+07
 sigma_tot counter=138 i=1 t=3.394e-02 per=1.251e+01 cost=3.603e+05 flops=1.062e+07
 sigma_tot counter=138 i=2 t=3.323e-02 per=1.225e+01 cost=4.015e+05 flops=1.208e+07
 sigma_tot counter=138 i=3 t=3.307e-02 per=1.219e+01 cost=4.085e+05 flops=1.235e+07
 sigma_tot counter=138 i=4 t=3.396e-02 per=1.252e+01 cost=7.563e+05 flops=2.227e+07
 sigma_tot counter=138 i=5 t=3.417e-02 per=1.260e+01 cost=7.584e+05 flops=2.220e+07
 sigma_tot counter=138 i=6 t=3.521e-02 per=1.298e+01 cost=8.804e+05 flops=2.500e+07
 sigma_tot counter=138 i=7 t=3.412e-02 per=1.258e+01 cost=8.753e+05 flops=2.565e+07
 total GEMM cost=4.795e+06 flops=1.768e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.080e-04,2.003e-03,1.940e-04 cost=4.217e+04 flops[gemm]=2.105e+07
--- TIMING FOR sigma : t_inter=2.080e-04 t_gemm=2.003e-03 t_reduction=1.930e-04 tot=2.404e-03 ---
 sigma counter=139 i=0 t=2.530e-04 per=1.263e+01 cost=3.716e+03 flops=1.469e+07
 sigma counter=139 i=1 t=2.530e-04 per=1.263e+01 cost=3.736e+03 flops=1.477e+07
 sigma counter=139 i=2 t=2.420e-04 per=1.208e+01 cost=3.036e+03 flops=1.255e+07
 sigma counter=139 i=3 t=2.370e-04 per=1.183e+01 cost=3.026e+03 flops=1.277e+07
 sigma counter=139 i=4 t=2.510e-04 per=1.253e+01 cost=1.000e+04 flops=3.984e+07
 sigma counter=139 i=5 t=2.560e-04 per=1.278e+01 cost=1.000e+04 flops=3.906e+07
 sigma counter=139 i=6 t=2.610e-04 per=1.303e+01 cost=4.336e+03 flops=1.661e+07
 sigma counter=139 i=7 t=2.500e-04 per=1.248e+01 cost=4.316e+03 flops=1.726e+07
 total GEMM cost=4.217e+04 flops=2.105e+07
--- TIMING FOR sigma_tot : t_inter=2.949e-02 t_gemm=2.732e-01 t_reduction=2.739e-02 tot=3.301e-01 ---
 sigma_tot counter=139 i=0 t=3.379e-02 per=1.237e+01 cost=3.578e+05 flops=1.059e+07
 sigma_tot counter=139 i=1 t=3.419e-02 per=1.251e+01 cost=3.641e+05 flops=1.065e+07
 sigma_tot counter=139 i=2 t=3.347e-02 per=1.225e+01 cost=4.045e+05 flops=1.209e+07
 sigma_tot counter=139 i=3 t=3.331e-02 per=1.219e+01 cost=4.115e+05 flops=1.235e+07
 sigma_tot counter=139 i=4 t=3.421e-02 per=1.252e+01 cost=7.663e+05 flops=2.240e+07
 sigma_tot counter=139 i=5 t=3.442e-02 per=1.260e+01 cost=7.684e+05 flops=2.232e+07
 sigma_tot counter=139 i=6 t=3.547e-02 per=1.298e+01 cost=8.847e+05 flops=2.494e+07
 sigma_tot counter=139 i=7 t=3.437e-02 per=1.258e+01 cost=8.796e+05 flops=2.559e+07
 total GEMM cost=4.837e+06 flops=1.770e+07
    6   0 -      -2.654516950786 -1.319e-07  1.570e-04    6    12  3.207e-02 2.673e-03
    6   1 +      -2.436977447171 -3.725e-08  7.419e-05    6    12  3.207e-02 2.673e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.160e-04,2.018e-03,1.970e-04 cost=4.217e+04 flops[gemm]=2.089e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=2.018e-03 t_reduction=1.970e-04 tot=2.431e-03 ---
 sigma counter=140 i=0 t=2.550e-04 per=1.264e+01 cost=3.716e+03 flops=1.457e+07
 sigma counter=140 i=1 t=2.640e-04 per=1.308e+01 cost=3.736e+03 flops=1.415e+07
 sigma counter=140 i=2 t=2.380e-04 per=1.179e+01 cost=3.036e+03 flops=1.276e+07
 sigma counter=140 i=3 t=2.370e-04 per=1.174e+01 cost=3.026e+03 flops=1.277e+07
 sigma counter=140 i=4 t=2.530e-04 per=1.254e+01 cost=1.000e+04 flops=3.953e+07
 sigma counter=140 i=5 t=2.580e-04 per=1.278e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=140 i=6 t=2.600e-04 per=1.288e+01 cost=4.336e+03 flops=1.668e+07
 sigma counter=140 i=7 t=2.530e-04 per=1.254e+01 cost=4.316e+03 flops=1.706e+07
 total GEMM cost=4.217e+04 flops=2.089e+07
--- TIMING FOR sigma_tot : t_inter=2.971e-02 t_gemm=2.753e-01 t_reduction=2.759e-02 tot=3.326e-01 ---
 sigma_tot counter=140 i=0 t=3.404e-02 per=1.237e+01 cost=3.615e+05 flops=1.062e+07
 sigma_tot counter=140 i=1 t=3.445e-02 per=1.252e+01 cost=3.678e+05 flops=1.068e+07
 sigma_tot counter=140 i=2 t=3.371e-02 per=1.225e+01 cost=4.076e+05 flops=1.209e+07
 sigma_tot counter=140 i=3 t=3.355e-02 per=1.219e+01 cost=4.145e+05 flops=1.236e+07
 sigma_tot counter=140 i=4 t=3.447e-02 per=1.252e+01 cost=7.763e+05 flops=2.252e+07
 sigma_tot counter=140 i=5 t=3.468e-02 per=1.260e+01 cost=7.784e+05 flops=2.245e+07
 sigma_tot counter=140 i=6 t=3.573e-02 per=1.298e+01 cost=8.890e+05 flops=2.488e+07
 sigma_tot counter=140 i=7 t=3.462e-02 per=1.258e+01 cost=8.839e+05 flops=2.553e+07
 total GEMM cost=4.879e+06 flops=1.773e+07
    7   0 +      -2.654516966956 -1.617e-08  3.991e-05    5    13  3.473e-02 2.672e-03
    7   1 +      -2.436977447171 -3.109e-15  7.419e-05    5    13  3.473e-02 2.672e-03
TIMING FOR Davidson : 3.476e-02  T(cal/comm/rest)=3.409e-02,4.835e-05,6.265e-04
optimized energies: isweep=3 dots=2 ibond=0 e[0]=-2.65451696696 nmvp=13
optimized energies: isweep=3 dots=2 ibond=0 e[1]=-2.43697744717 nmvp=13
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=9 alg_decim=1 mpisize=2 maxthreads=2
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
TIMING FOR decimation: 4.0e-04 S T(wf/decim)=3.1e-04,8.2e-05
ctns::oper_renorm coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=852:6.5e-03MB:6.3e-06GB
rank=0 GPUmem(GB): used=2.2e-05 (oper)=8.5e-06
rank=0 GPUmem(GB): used=2.2e-05 (oper,site)(GB)=8.5e-06,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 5.772e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=2.22e-05 (oper,site,rinter)=8.52e-06,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.001 S size(rtasks)=37 size(Rlst2)=9 T(Rmu/Rlist)=0.000203,0.000802 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00108 S size(rtasks)=37 size(Rlst)=860 -----
rank=0 GPUmem(GB): used=0.000234 (oper,site,rinter,batch)=8.52e-06,2.68e-07,0,0.000211 blksize=16 blksize0=0 batchsize=860
timing: allocate=3.61e-05 rmmtasks init=0.00104 total=0.00108
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=6e-06,0.00118,0.000209 cost=1.69e+04 flops[gemm]=1.42e+07
--- TIMING FOR renorm : t_inter=6e-06 t_gemm=0.00118 t_reduction=0.000209 tot=0.0014 ---
 renorm counter=13 i=0 t=0.000239 per=20.2 cost=1.3e+03 flops=5.45e+06
 renorm counter=13 i=1 t=0.000231 per=19.5 cost=1.64e+03 flops=7.09e+06
 renorm counter=13 i=2 t=1e-06 per=0.0845 cost=0 flops=0
 renorm counter=13 i=3 t=0 per=0 cost=0 flops=-nan
 renorm counter=13 i=4 t=0.000226 per=19.1 cost=1.19e+03 flops=5.28e+06
 renorm counter=13 i=5 t=0.000228 per=19.3 cost=1.85e+03 flops=8.13e+06
 renorm counter=13 i=6 t=0.000259 per=21.9 cost=1.09e+04 flops=4.2e+07
 total GEMM cost=1.69e+04 flops=1.42e+07
--- TIMING FOR renorm_tot : t_inter=0.00129 t_gemm=0.015 t_reduction=0.00261 tot=0.0189 ---
 renorm_tot counter=13 i=0 t=0.00303 per=20.2 cost=2.48e+04 flops=8.19e+06
 renorm_tot counter=13 i=1 t=0.00295 per=19.7 cost=3.71e+04 flops=1.26e+07
 renorm_tot counter=13 i=2 t=0.00132 per=8.83 cost=2.38e+04 flops=1.8e+07
 renorm_tot counter=13 i=3 t=0.00134 per=8.94 cost=4.12e+04 flops=3.07e+07
 renorm_tot counter=13 i=4 t=0.00156 per=10.4 cost=2.61e+04 flops=1.67e+07
 renorm_tot counter=13 i=5 t=0.00159 per=10.6 cost=4.55e+04 flops=2.86e+07
 renorm_tot counter=13 i=6 t=0.00319 per=21.3 cost=3.07e+05 flops=9.62e+07
 total GEMM cost=5.05e+05 flops=3.37e+07
timing: gpu2cpu=1.42e-05 deallocate(site/work)=2.61e-06,5.17e-06 total=1.93e-05
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.00495 S T(init/kernel/comm)=0.000434,0.00445,6.51e-05 rank=0 -----
TIMING FOR cleanup: 0.000363 T(erase/save/remove)=9.47e-05,0.000231,3.79e-05
##### local: 5.167e-02 S #####
 T(local: fetch) = 1.541e-04 S  per = 0.298  per(accum) = 0.298
 T(local: hdiag) = 5.881e-04 S  per = 1.14  per(accum) = 1.44
 T(local: dvdsn) = 4.444e-02 S  per =   86  per(accum) = 87.4
 T(local: decim) = 4.883e-04 S  per = 0.945  per(accum) = 88.4
 T(local: guess) = 5.267e-04 S  per = 1.02  per(accum) = 89.4
 T(local: renrm) = 5.099e-03 S  per = 9.87  per(accum) = 99.3
 T(local: save ) = 3.768e-04 S  per = 0.729  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.330e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 8.213e-06 S  per = 0.019  per(accum) = 0.019
 T(local: symbolic_formulae_twodot     ) = 7.080e-04 S  per = 1.64  per(accum) = 1.65
 T(local: hintermediate init           ) = 6.135e-05 S  per = 0.142  per(accum) = 1.8
 T(local: hintermediates memcpy cpu2gpu) = 3.300e-08 S  per = 7.62e-05  per(accum) = 1.8
 T(local: preprocess_hformulae_Hxlist2 ) = 3.931e-03 S  per = 9.08  per(accum) = 10.9
 T(local: hmmtasks init                ) = 3.825e-03 S  per = 8.83  per(accum) = 19.7
 T(local: dvdson solver [Hx_batchGPU]  ) = 3.409e-02 S  per = 78.7  per(accum) = 98.4
 T(local: dvdson solver [communication]) = 4.835e-05 S  per = 0.112  per(accum) = 98.6
 T(local: dvdson solver [rest part]    ) = 6.265e-04 S  per = 1.45  per(accum) = 100
Detailed decomposition of T(renrm): 4.951e-03 S
 T(local: qops init                    ) = 4.343e-04 S  per = 8.77  per(accum) = 8.77
 T(local: qops_dict memcpy cpu2gpu     ) = 3.782e-05 S  per = 0.764  per(accum) = 9.54
 T(local: symbolic_formulae_renorm     ) = 5.865e-04 S  per = 11.8  per(accum) = 21.4
 T(local: rintermediate init           ) = 4.146e-05 S  per = 0.838  per(accum) = 22.2
 T(local: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000566  per(accum) = 22.2
 T(local: preprocess_formulae_Rlist2   ) = 1.113e-03 S  per = 22.5  per(accum) = 44.7
 T(local: rmmtasks init                ) = 1.090e-03 S  per =   22  per(accum) = 66.7
 T(local: qops memset                  ) = 2.800e-08 S  per = 0.000566  per(accum) = 66.7
 T(local: preprocess_renorm_batchGPU   ) = 1.530e-03 S  per = 30.9  per(accum) = 97.6
 T(local: qops memcpy gpu2cpu          ) = 1.424e-05 S  per = 0.288  per(accum) = 97.9
 T(local: deallocate gpu memory        ) = 3.802e-05 S  per = 0.768  per(accum) = 98.7
 T(local: communication of opS and opH ) = 6.507e-05 S  per = 1.31  per(accum) = 100
##### sweep: 5.167e-02 S #####
 T(sweep: fetch) = 1.541e-04 S  per = 0.298  per(accum) = 0.298
 T(sweep: hdiag) = 5.881e-04 S  per = 1.14  per(accum) = 1.44
 T(sweep: dvdsn) = 4.444e-02 S  per =   86  per(accum) = 87.4
 T(sweep: decim) = 4.883e-04 S  per = 0.945  per(accum) = 88.4
 T(sweep: guess) = 5.267e-04 S  per = 1.02  per(accum) = 89.4
 T(sweep: renrm) = 5.099e-03 S  per = 9.87  per(accum) = 99.3
 T(sweep: save ) = 3.768e-04 S  per = 0.729  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.330e-02 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 8.213e-06 S  per = 0.019  per(accum) = 0.019
 T(sweep: symbolic_formulae_twodot     ) = 7.080e-04 S  per = 1.64  per(accum) = 1.65
 T(sweep: hintermediate init           ) = 6.135e-05 S  per = 0.142  per(accum) = 1.8
 T(sweep: hintermediates memcpy cpu2gpu) = 3.300e-08 S  per = 7.62e-05  per(accum) = 1.8
 T(sweep: preprocess_hformulae_Hxlist2 ) = 3.931e-03 S  per = 9.08  per(accum) = 10.9
 T(sweep: hmmtasks init                ) = 3.825e-03 S  per = 8.83  per(accum) = 19.7
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 3.409e-02 S  per = 78.7  per(accum) = 98.4
 T(sweep: dvdson solver [communication]) = 4.835e-05 S  per = 0.112  per(accum) = 98.6
 T(sweep: dvdson solver [rest part]    ) = 6.265e-04 S  per = 1.45  per(accum) = 100
Detailed decomposition of T(renrm): 4.951e-03 S
 T(sweep: qops init                    ) = 4.343e-04 S  per = 8.77  per(accum) = 8.77
 T(sweep: qops_dict memcpy cpu2gpu     ) = 3.782e-05 S  per = 0.764  per(accum) = 9.54
 T(sweep: symbolic_formulae_renorm     ) = 5.865e-04 S  per = 11.8  per(accum) = 21.4
 T(sweep: rintermediate init           ) = 4.146e-05 S  per = 0.838  per(accum) = 22.2
 T(sweep: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000566  per(accum) = 22.2
 T(sweep: preprocess_formulae_Rlist2   ) = 1.113e-03 S  per = 22.5  per(accum) = 44.7
 T(sweep: rmmtasks init                ) = 1.090e-03 S  per =   22  per(accum) = 66.7
 T(sweep: qops memset                  ) = 2.800e-08 S  per = 0.000566  per(accum) = 66.7
 T(sweep: preprocess_renorm_batchGPU   ) = 1.530e-03 S  per = 30.9  per(accum) = 97.6
 T(sweep: qops memcpy gpu2cpu          ) = 1.424e-05 S  per = 0.288  per(accum) = 97.9
 T(sweep: deallocate gpu memory        ) = 3.802e-05 S  per = 0.768  per(accum) = 98.7
 T(sweep: communication of opS and opH ) = 6.507e-05 S  per = 1.31  per(accum) = 100
##### global: 5.752e-01 S #####
 T(global: fetch) = 9.071e-03 S  per = 1.58  per(accum) = 1.58
 T(global: hdiag) = 7.285e-03 S  per = 1.27  per(accum) = 2.84
 T(global: dvdsn) = 4.765e-01 S  per = 82.8  per(accum) = 85.7
 T(global: decim) = 1.139e-02 S  per = 1.98  per(accum) = 87.7
 T(global: guess) = 5.558e-03 S  per = 0.966  per(accum) = 88.6
 T(global: renrm) = 6.154e-02 S  per = 10.7  per(accum) = 99.3
 T(global: save ) = 3.830e-03 S  per = 0.666  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.631e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 1.451e-04 S  per = 0.0313  per(accum) = 0.0313
 T(global: symbolic_formulae_twodot     ) = 8.648e-03 S  per = 1.87  per(accum) = 1.9
 T(global: hintermediate init           ) = 7.607e-04 S  per = 0.164  per(accum) = 2.06
 T(global: hintermediates memcpy cpu2gpu) = 3.820e-07 S  per = 8.25e-05  per(accum) = 2.06
 T(global: preprocess_hformulae_Hxlist2 ) = 4.492e-02 S  per =  9.7  per(accum) = 11.8
 T(global: hmmtasks init                ) = 4.415e-02 S  per = 9.53  per(accum) = 21.3
 T(global: dvdson solver [Hx_batchGPU]  ) = 3.580e-01 S  per = 77.3  per(accum) = 98.6
 T(global: dvdson solver [communication]) = 4.964e-04 S  per = 0.107  per(accum) = 98.7
 T(global: dvdson solver [rest part]    ) = 5.964e-03 S  per = 1.29  per(accum) = 100
Detailed decomposition of T(renrm): 5.966e-02 S
 T(global: qops init                    ) = 4.551e-03 S  per = 7.63  per(accum) = 7.63
 T(global: qops_dict memcpy cpu2gpu     ) = 5.486e-04 S  per = 0.92  per(accum) = 8.55
 T(global: symbolic_formulae_renorm     ) = 7.043e-03 S  per = 11.8  per(accum) = 20.4
 T(global: rintermediate init           ) = 5.979e-04 S  per =    1  per(accum) = 21.4
 T(global: rintermediates memcpy cpu2gpu) = 3.680e-07 S  per = 0.000617  per(accum) = 21.4
 T(global: preprocess_formulae_Rlist2   ) = 1.280e-02 S  per = 21.5  per(accum) = 42.8
 T(global: rmmtasks init                ) = 1.216e-02 S  per = 20.4  per(accum) = 63.2
 T(global: qops memset                  ) = 3.590e-07 S  per = 0.000602  per(accum) = 63.2
 T(global: preprocess_renorm_batchGPU   ) = 2.045e-02 S  per = 34.3  per(accum) = 97.5
 T(global: qops memcpy gpu2cpu          ) = 1.991e-04 S  per = 0.334  per(accum) = 97.8
 T(global: deallocate gpu memory        ) = 4.871e-04 S  per = 0.817  per(accum) = 98.6
 T(global: communication of opS and opH ) = 8.210e-04 S  per = 1.38  per(accum) = 100

isweep=3 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=852:0.0065MB:6.35e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1290:0.00984MB:9.61e-06GB
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44c12f80
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
### DIAG TIMING: total=0.000364 t1=7.45e-06, t2=1.42e-05, t3=4.83e-05, t4=0.000128, t5=0.000123, t6=2.72e-05, t7=1.27e-05, t8=2.37e-06
duration_diagGPU:0.000379
duration_diagreduce:4.11e-06
duration_diagtransform:1.91e-06
rank=0 GPUmem(GB): used=9.61e-06 (oper)=9.61e-06
----- TIMING FOR symbolic_formulae_twodot with size=95 : 6.461e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=95
 no. of hintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.690e-05 S -----
rank=0 GPUmem(GB): used=9.94e-06 (oper,hinter)=9.61e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00331 S size(H_formulae)=95 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000187,0.00312 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00356 S size(H_formulae)=95 size(Hxlst)=2974 -----
rank=0 GPUmem(GB): used=0.000388 (oper,hinter,dvdson,batch)=9.61e-06,3.28e-07,1.49e-06,0.000377 blksize=4 blksize0=8 batchsize=2974
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000219,0.00201,0.000202 cost=4.12e+04 flops[gemm]=2.05e+07
--- TIMING FOR sigma : t_inter=0.000219 t_gemm=0.00201 t_reduction=0.000202 tot=0.00243 ---
 sigma counter=141 i=0 t=0.000245 per=12.2 cost=2.58e+03 flops=1.05e+07
 sigma counter=141 i=1 t=0.000244 per=12.1 cost=2.57e+03 flops=1.05e+07
 sigma counter=141 i=2 t=0.000246 per=12.2 cost=3.75e+03 flops=1.53e+07
 sigma counter=141 i=3 t=0.000248 per=12.3 cost=3.77e+03 flops=1.52e+07
 sigma counter=141 i=4 t=0.000253 per=12.6 cost=4.11e+03 flops=1.63e+07
 sigma counter=141 i=5 t=0.000255 per=12.7 cost=4.13e+03 flops=1.62e+07
 sigma counter=141 i=6 t=0.000262 per=13 cost=1.01e+04 flops=3.87e+07
 sigma counter=141 i=7 t=0.000259 per=12.9 cost=1.01e+04 flops=3.92e+07
 total GEMM cost=4.12e+04 flops=2.05e+07
--- TIMING FOR sigma_tot : t_inter=0.0299 t_gemm=0.277 t_reduction=0.0278 tot=0.335 ---
 sigma_tot counter=141 i=0 t=0.0343 per=12.4 cost=3.64e+05 flops=1.06e+07
 sigma_tot counter=141 i=1 t=0.0347 per=12.5 cost=3.7e+05 flops=1.07e+07
 sigma_tot counter=141 i=2 t=0.034 per=12.2 cost=4.11e+05 flops=1.21e+07
 sigma_tot counter=141 i=3 t=0.0338 per=12.2 cost=4.18e+05 flops=1.24e+07
 sigma_tot counter=141 i=4 t=0.0347 per=12.5 cost=7.8e+05 flops=2.25e+07
 sigma_tot counter=141 i=5 t=0.0349 per=12.6 cost=7.83e+05 flops=2.24e+07
 sigma_tot counter=141 i=6 t=0.036 per=13 cost=8.99e+05 flops=2.5e+07
 sigma_tot counter=141 i=7 t=0.0349 per=12.6 cost=8.94e+05 flops=2.56e+07
 total GEMM cost=4.92e+06 flops=1.77e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2e-05,0.000216,0.00201,0.000196 cost=4.12e+04 flops[gemm]=2.05e+07
--- TIMING FOR sigma : t_inter=0.000216 t_gemm=0.00201 t_reduction=0.000196 tot=0.00242 ---
 sigma counter=142 i=0 t=0.000245 per=12.2 cost=2.58e+03 flops=1.05e+07
 sigma counter=142 i=1 t=0.000251 per=12.5 cost=2.57e+03 flops=1.02e+07
 sigma counter=142 i=2 t=0.000247 per=12.3 cost=3.75e+03 flops=1.52e+07
 sigma counter=142 i=3 t=0.000247 per=12.3 cost=3.77e+03 flops=1.53e+07
 sigma counter=142 i=4 t=0.000249 per=12.4 cost=4.11e+03 flops=1.65e+07
 sigma counter=142 i=5 t=0.000251 per=12.5 cost=4.13e+03 flops=1.65e+07
 sigma counter=142 i=6 t=0.000265 per=13.2 cost=1.01e+04 flops=3.83e+07
 sigma counter=142 i=7 t=0.000255 per=12.7 cost=1.01e+04 flops=3.98e+07
 total GEMM cost=4.12e+04 flops=2.05e+07
--- TIMING FOR sigma_tot : t_inter=0.0301 t_gemm=0.279 t_reduction=0.028 tot=0.337 ---
 sigma_tot counter=142 i=0 t=0.0345 per=12.4 cost=3.67e+05 flops=1.06e+07
 sigma_tot counter=142 i=1 t=0.0349 per=12.5 cost=3.73e+05 flops=1.07e+07
 sigma_tot counter=142 i=2 t=0.0342 per=12.2 cost=4.15e+05 flops=1.21e+07
 sigma_tot counter=142 i=3 t=0.034 per=12.2 cost=4.22e+05 flops=1.24e+07
 sigma_tot counter=142 i=4 t=0.035 per=12.5 cost=7.85e+05 flops=2.24e+07
 sigma_tot counter=142 i=5 t=0.0352 per=12.6 cost=7.87e+05 flops=2.24e+07
 sigma_tot counter=142 i=6 t=0.0363 per=13 cost=9.09e+05 flops=2.51e+07
 sigma_tot counter=142 i=7 t=0.0351 per=12.6 cost=9.04e+05 flops=2.57e+07
 total GEMM cost=4.96e+06 flops=1.78e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956 -1.003e+03  3.991e-05    2     2  5.340e-03 2.670e-03
    1   1 +      -2.436977447171 -1.002e+03  7.419e-05    2     2  5.340e-03 2.670e-03
TIMING FOR Davidson : 5.402e-03  T(cal/comm/rest)=5.286e-03,7.674e-06,1.082e-04
optimized energies: isweep=3 dots=2 ibond=1 e[0]=-2.65451696696 nmvp=2
optimized energies: isweep=3 dots=2 ibond=1 e[1]=-2.43697744717 nmvp=2
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=16 alg_decim=1 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep3_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
----- TMING FOR decimation_genbasis: 3.9e-04 S T(scatter/comp/gather)=3.7e-05,4.0e-05,3.1e-04 -----
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
 qbond: qkept nsym=6 dimAll=20
 (3,1):6 (4,0):4 (2,0):3 (4,2):3 (3,-1):2 (5,1):2
----- TIMING for decimation_row: 6.928e-04 S T(decim/formRot)=4.664e-04,2.264e-04 -----
TIMING FOR decimation: 1.005e-03 S T(wf/decim)=2.986e-04,7.068e-04
ctns::oper_renorm coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:6 A:7 B:11 P:3 Q:5 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=1685:1.286e-02MB:1.255e-05GB
rank=0 GPUmem(GB): used=2.249e-05 (oper)=1.999e-05
rank=0 GPUmem(GB): used=2.361e-05 (oper,site)(GB)=1.999e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=37 : 4.796e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 5.333e-05 S -----
rank=0 GPUmem(GB): used=2.39e-05 (oper,site,rinter)=2e-05,1.12e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000995 S size(rtasks)=37 size(Rlst2)=6 T(Rmu/Rlist)=0.000163,0.000832 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00108 S size(rtasks)=37 size(Rlst)=905 -----
rank=0 GPUmem(GB): used=0.00057 (oper,site,rinter,batch)=2e-05,1.12e-06,3.28e-07,0.000546 blksize=36 blksize0=8 batchsize=905
timing: allocate=3.53e-05 rmmtasks init=0.00112 total=0.00115
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00021,0.00117,0.000208 cost=9.26e+04 flops[gemm]=7.93e+07
--- TIMING FOR renorm : t_inter=0.00021 t_gemm=0.00117 t_reduction=0.000207 tot=0.00158 ---
 renorm counter=14 i=0 t=0.000231 per=19.8 cost=4.54e+03 flops=1.96e+07
 renorm counter=14 i=1 t=0.000228 per=19.5 cost=5.34e+03 flops=2.34e+07
 renorm counter=14 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=14 i=3 t=1e-06 per=0.0857 cost=0 flops=0
 renorm counter=14 i=4 t=0.000223 per=19.1 cost=9.49e+03 flops=4.26e+07
 renorm counter=14 i=5 t=0.00023 per=19.7 cost=1.68e+04 flops=7.3e+07
 renorm counter=14 i=6 t=0.000254 per=21.8 cost=5.64e+04 flops=2.22e+08
 total GEMM cost=9.26e+04 flops=7.93e+07
--- TIMING FOR renorm_tot : t_inter=0.0015 t_gemm=0.0162 t_reduction=0.00282 tot=0.0205 ---
 renorm_tot counter=14 i=0 t=0.00326 per=20.2 cost=2.94e+04 flops=9e+06
 renorm_tot counter=14 i=1 t=0.00318 per=19.7 cost=4.24e+04 flops=1.33e+07
 renorm_tot counter=14 i=2 t=0.00132 per=8.19 cost=2.38e+04 flops=1.8e+07
 renorm_tot counter=14 i=3 t=0.00134 per=8.3 cost=4.12e+04 flops=3.07e+07
 renorm_tot counter=14 i=4 t=0.00179 per=11.1 cost=3.56e+04 flops=1.99e+07
 renorm_tot counter=14 i=5 t=0.00182 per=11.3 cost=6.23e+04 flops=3.42e+07
 renorm_tot counter=14 i=6 t=0.00344 per=21.3 cost=3.63e+05 flops=1.05e+08
 total GEMM cost=5.98e+05 flops=3.7e+07
timing: gpu2cpu=1.71e-05 deallocate(site/work)=3.37e-06,6.44e-06 total=2.35e-05
check ||H-H.dagger||=1.054e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.005 S T(init/kernel/comm)=0.000315,0.00462,6.3e-05 rank=0 -----
TIMING FOR cleanup: 0.000197 T(erase/save/remove)=3.96e-06,0.000158,3.48e-05
##### local: 2.301e-02 S #####
 T(local: fetch) = 1.041e-03 S  per = 4.53  per(accum) = 4.53
 T(local: hdiag) = 5.111e-04 S  per = 2.22  per(accum) = 6.75
 T(local: dvdsn) = 1.455e-02 S  per = 63.2  per(accum) = 70
 T(local: decim) = 1.147e-03 S  per = 4.98  per(accum) = 74.9
 T(local: guess) = 3.973e-04 S  per = 1.73  per(accum) = 76.7
 T(local: renrm) = 5.159e-03 S  per = 22.4  per(accum) = 99.1
 T(local: save ) = 2.097e-04 S  per = 0.911  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.340e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 8.391e-06 S  per = 0.0626  per(accum) = 0.0626
 T(local: symbolic_formulae_twodot     ) = 6.555e-04 S  per = 4.89  per(accum) = 4.95
 T(local: hintermediate init           ) = 6.032e-05 S  per = 0.45  per(accum) = 5.4
 T(local: hintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000209  per(accum) = 5.4
 T(local: preprocess_hformulae_Hxlist2 ) = 3.653e-03 S  per = 27.3  per(accum) = 32.7
 T(local: hmmtasks init                ) = 3.621e-03 S  per =   27  per(accum) = 59.7
 T(local: dvdson solver [Hx_batchGPU]  ) = 5.286e-03 S  per = 39.4  per(accum) = 99.1
 T(local: dvdson solver [communication]) = 7.674e-06 S  per = 0.0573  per(accum) = 99.2
 T(local: dvdson solver [rest part]    ) = 1.082e-04 S  per = 0.808  per(accum) = 100
Detailed decomposition of T(renrm): 5.000e-03 S
 T(local: qops init                    ) = 3.154e-04 S  per = 6.31  per(accum) = 6.31
 T(local: qops_dict memcpy cpu2gpu     ) = 4.382e-05 S  per = 0.876  per(accum) = 7.18
 T(local: symbolic_formulae_renorm     ) = 4.885e-04 S  per = 9.77  per(accum) = 17
 T(local: rintermediate init           ) = 6.535e-05 S  per = 1.31  per(accum) = 18.3
 T(local: rintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 0.00058  per(accum) = 18.3
 T(local: preprocess_formulae_Rlist2   ) = 1.109e-03 S  per = 22.2  per(accum) = 40.4
 T(local: rmmtasks init                ) = 1.163e-03 S  per = 23.3  per(accum) = 63.7
 T(local: qops memset                  ) = 3.200e-08 S  per = 0.00064  per(accum) = 63.7
 T(local: preprocess_renorm_batchGPU   ) = 1.701e-03 S  per =   34  per(accum) = 97.7
 T(local: qops memcpy gpu2cpu          ) = 1.715e-05 S  per = 0.343  per(accum) = 98
 T(local: deallocate gpu memory        ) = 3.456e-05 S  per = 0.691  per(accum) = 98.7
 T(local: communication of opS and opH ) = 6.299e-05 S  per = 1.26  per(accum) = 100
##### sweep: 7.468e-02 S #####
 T(sweep: fetch) = 1.196e-03 S  per =  1.6  per(accum) = 1.6
 T(sweep: hdiag) = 1.099e-03 S  per = 1.47  per(accum) = 3.07
 T(sweep: dvdsn) = 5.899e-02 S  per =   79  per(accum) = 82.1
 T(sweep: decim) = 1.635e-03 S  per = 2.19  per(accum) = 84.2
 T(sweep: guess) = 9.240e-04 S  per = 1.24  per(accum) = 85.5
 T(sweep: renrm) = 1.026e-02 S  per = 13.7  per(accum) = 99.2
 T(sweep: save ) = 5.865e-04 S  per = 0.785  per(accum) = 100
Detailed decomposition of T(dvdsn): 5.670e-02 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.660e-05 S  per = 0.0293  per(accum) = 0.0293
 T(sweep: symbolic_formulae_twodot     ) = 1.363e-03 S  per =  2.4  per(accum) = 2.43
 T(sweep: hintermediate init           ) = 1.217e-04 S  per = 0.215  per(accum) = 2.65
 T(sweep: hintermediates memcpy cpu2gpu) = 6.100e-08 S  per = 0.000108  per(accum) = 2.65
 T(sweep: preprocess_hformulae_Hxlist2 ) = 7.584e-03 S  per = 13.4  per(accum) = 16
 T(sweep: hmmtasks init                ) = 7.446e-03 S  per = 13.1  per(accum) = 29.2
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 3.937e-02 S  per = 69.4  per(accum) = 98.6
 T(sweep: dvdson solver [communication]) = 5.602e-05 S  per = 0.0988  per(accum) = 98.7
 T(sweep: dvdson solver [rest part]    ) = 7.347e-04 S  per =  1.3  per(accum) = 100
Detailed decomposition of T(renrm): 9.951e-03 S
 T(sweep: qops init                    ) = 7.497e-04 S  per = 7.53  per(accum) = 7.53
 T(sweep: qops_dict memcpy cpu2gpu     ) = 8.164e-05 S  per = 0.82  per(accum) = 8.35
 T(sweep: symbolic_formulae_renorm     ) = 1.075e-03 S  per = 10.8  per(accum) = 19.2
 T(sweep: rintermediate init           ) = 1.068e-04 S  per = 1.07  per(accum) = 20.2
 T(sweep: rintermediates memcpy cpu2gpu) = 5.700e-08 S  per = 0.000573  per(accum) = 20.2
 T(sweep: preprocess_formulae_Rlist2   ) = 2.222e-03 S  per = 22.3  per(accum) = 42.6
 T(sweep: rmmtasks init                ) = 2.253e-03 S  per = 22.6  per(accum) = 65.2
 T(sweep: qops memset                  ) = 6.000e-08 S  per = 0.000603  per(accum) = 65.2
 T(sweep: preprocess_renorm_batchGPU   ) = 3.231e-03 S  per = 32.5  per(accum) = 97.7
 T(sweep: qops memcpy gpu2cpu          ) = 3.139e-05 S  per = 0.315  per(accum) = 98
 T(sweep: deallocate gpu memory        ) = 7.258e-05 S  per = 0.729  per(accum) = 98.7
 T(sweep: communication of opS and opH ) = 1.281e-04 S  per = 1.29  per(accum) = 100
##### global: 5.982e-01 S #####
 T(global: fetch) = 1.011e-02 S  per = 1.69  per(accum) = 1.69
 T(global: hdiag) = 7.797e-03 S  per =  1.3  per(accum) = 2.99
 T(global: dvdsn) = 4.911e-01 S  per = 82.1  per(accum) = 85.1
 T(global: decim) = 1.254e-02 S  per =  2.1  per(accum) = 87.2
 T(global: guess) = 5.955e-03 S  per = 0.996  per(accum) = 88.2
 T(global: renrm) = 6.670e-02 S  per = 11.1  per(accum) = 99.3
 T(global: save ) = 4.040e-03 S  per = 0.675  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.765e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 1.535e-04 S  per = 0.0322  per(accum) = 0.0322
 T(global: symbolic_formulae_twodot     ) = 9.303e-03 S  per = 1.95  per(accum) = 1.98
 T(global: hintermediate init           ) = 8.210e-04 S  per = 0.172  per(accum) = 2.16
 T(global: hintermediates memcpy cpu2gpu) = 4.100e-07 S  per = 8.6e-05  per(accum) = 2.16
 T(global: preprocess_hformulae_Hxlist2 ) = 4.857e-02 S  per = 10.2  per(accum) = 12.4
 T(global: hmmtasks init                ) = 4.777e-02 S  per =   10  per(accum) = 22.4
 T(global: dvdson solver [Hx_batchGPU]  ) = 3.633e-01 S  per = 76.2  per(accum) = 98.6
 T(global: dvdson solver [communication]) = 5.041e-04 S  per = 0.106  per(accum) = 98.7
 T(global: dvdson solver [rest part]    ) = 6.073e-03 S  per = 1.27  per(accum) = 100
Detailed decomposition of T(renrm): 6.466e-02 S
 T(global: qops init                    ) = 4.866e-03 S  per = 7.53  per(accum) = 7.53
 T(global: qops_dict memcpy cpu2gpu     ) = 5.924e-04 S  per = 0.916  per(accum) = 8.44
 T(global: symbolic_formulae_renorm     ) = 7.531e-03 S  per = 11.6  per(accum) = 20.1
 T(global: rintermediate init           ) = 6.633e-04 S  per = 1.03  per(accum) = 21.1
 T(global: rintermediates memcpy cpu2gpu) = 3.970e-07 S  per = 0.000614  per(accum) = 21.1
 T(global: preprocess_formulae_Rlist2   ) = 1.391e-02 S  per = 21.5  per(accum) = 42.6
 T(global: rmmtasks init                ) = 1.332e-02 S  per = 20.6  per(accum) = 63.2
 T(global: qops memset                  ) = 3.910e-07 S  per = 0.000605  per(accum) = 63.2
 T(global: preprocess_renorm_batchGPU   ) = 2.215e-02 S  per = 34.3  per(accum) = 97.5
 T(global: qops memcpy gpu2cpu          ) = 2.162e-04 S  per = 0.334  per(accum) = 97.8
 T(global: deallocate gpu memory        ) = 5.217e-04 S  per = 0.807  per(accum) = 98.6
 T(global: communication of opS and opH ) = 8.839e-04 S  per = 1.37  per(accum) = 100

isweep=3 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=852:0.0065MB:6.35e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1290:0.00984MB:9.61e-06GB
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44c100e0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
### DIAG TIMING: total=0.000368 t1=1.02e-05, t2=1.67e-05, t3=4.88e-05, t4=0.000122, t5=0.000124, t6=3.1e-05, t7=1.27e-05, t8=2.52e-06
duration_diagGPU:0.000382
duration_diagreduce:3.86e-06
duration_diagtransform:1.81e-06
rank=0 GPUmem(GB): used=2.22e-05 (oper)=9.61e-06
----- TIMING FOR symbolic_formulae_twodot with size=95 : 6.483e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=95
 no. of hintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.627e-05 S -----
rank=0 GPUmem(GB): used=2.25e-05 (oper,hinter)=9.61e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00335 S size(H_formulae)=95 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000186,0.00316 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0036 S size(H_formulae)=95 size(Hxlst)=2974 -----
rank=0 GPUmem(GB): used=0.000401 (oper,hinter,dvdson,batch)=9.61e-06,3.28e-07,1.49e-06,0.000377 blksize=4 blksize0=8 batchsize=2974
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.4e-05,0.000225,0.00204,0.000199 cost=4.12e+04 flops[gemm]=2.02e+07
--- TIMING FOR sigma : t_inter=0.000225 t_gemm=0.00204 t_reduction=0.000199 tot=0.00247 ---
 sigma counter=143 i=0 t=0.000251 per=12.3 cost=2.58e+03 flops=1.03e+07
 sigma counter=143 i=1 t=0.000256 per=12.5 cost=2.57e+03 flops=1e+07
 sigma counter=143 i=2 t=0.000256 per=12.5 cost=3.75e+03 flops=1.47e+07
 sigma counter=143 i=3 t=0.000246 per=12 cost=3.77e+03 flops=1.53e+07
 sigma counter=143 i=4 t=0.000248 per=12.1 cost=4.11e+03 flops=1.66e+07
 sigma counter=143 i=5 t=0.000253 per=12.4 cost=4.13e+03 flops=1.63e+07
 sigma counter=143 i=6 t=0.000278 per=13.6 cost=1.01e+04 flops=3.65e+07
 sigma counter=143 i=7 t=0.000256 per=12.5 cost=1.01e+04 flops=3.96e+07
 total GEMM cost=4.12e+04 flops=2.02e+07
--- TIMING FOR sigma_tot : t_inter=0.0304 t_gemm=0.281 t_reduction=0.0282 tot=0.34 ---
 sigma_tot counter=143 i=0 t=0.0348 per=12.4 cost=3.69e+05 flops=1.06e+07
 sigma_tot counter=143 i=1 t=0.0352 per=12.5 cost=3.76e+05 flops=1.07e+07
 sigma_tot counter=143 i=2 t=0.0345 per=12.2 cost=4.19e+05 flops=1.22e+07
 sigma_tot counter=143 i=3 t=0.0343 per=12.2 cost=4.26e+05 flops=1.24e+07
 sigma_tot counter=143 i=4 t=0.0352 per=12.5 cost=7.89e+05 flops=2.24e+07
 sigma_tot counter=143 i=5 t=0.0354 per=12.6 cost=7.91e+05 flops=2.23e+07
 sigma_tot counter=143 i=6 t=0.0365 per=13 cost=9.19e+05 flops=2.52e+07
 sigma_tot counter=143 i=7 t=0.0354 per=12.6 cost=9.14e+05 flops=2.58e+07
 total GEMM cost=5e+06 flops=1.78e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.1e-05,0.000215,0.00202,0.000197 cost=4.12e+04 flops[gemm]=2.04e+07
--- TIMING FOR sigma : t_inter=0.000215 t_gemm=0.00202 t_reduction=0.000197 tot=0.00243 ---
 sigma counter=144 i=0 t=0.000248 per=12.3 cost=2.58e+03 flops=1.04e+07
 sigma counter=144 i=1 t=0.000251 per=12.4 cost=2.57e+03 flops=1.02e+07
 sigma counter=144 i=2 t=0.000249 per=12.3 cost=3.75e+03 flops=1.51e+07
 sigma counter=144 i=3 t=0.000253 per=12.5 cost=3.77e+03 flops=1.49e+07
 sigma counter=144 i=4 t=0.00025 per=12.4 cost=4.11e+03 flops=1.64e+07
 sigma counter=144 i=5 t=0.000253 per=12.5 cost=4.13e+03 flops=1.63e+07
 sigma counter=144 i=6 t=0.000261 per=12.9 cost=1.01e+04 flops=3.89e+07
 sigma counter=144 i=7 t=0.000255 per=12.6 cost=1.01e+04 flops=3.98e+07
 total GEMM cost=4.12e+04 flops=2.04e+07
--- TIMING FOR sigma_tot : t_inter=0.0306 t_gemm=0.283 t_reduction=0.0284 tot=0.342 ---
 sigma_tot counter=144 i=0 t=0.035 per=12.4 cost=3.72e+05 flops=1.06e+07
 sigma_tot counter=144 i=1 t=0.0355 per=12.5 cost=3.78e+05 flops=1.07e+07
 sigma_tot counter=144 i=2 t=0.0347 per=12.2 cost=4.23e+05 flops=1.22e+07
 sigma_tot counter=144 i=3 t=0.0345 per=12.2 cost=4.3e+05 flops=1.24e+07
 sigma_tot counter=144 i=4 t=0.0355 per=12.5 cost=7.93e+05 flops=2.24e+07
 sigma_tot counter=144 i=5 t=0.0357 per=12.6 cost=7.95e+05 flops=2.23e+07
 sigma_tot counter=144 i=6 t=0.0368 per=13 cost=9.3e+05 flops=2.53e+07
 sigma_tot counter=144 i=7 t=0.0356 per=12.6 cost=9.24e+05 flops=2.59e+07
 total GEMM cost=5.04e+06 flops=1.78e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592 -1.003e+03  7.009e-02    2     2  5.422e-03 2.711e-03
    1   1 -      -2.436094100141 -1.002e+03  4.918e-02    2     2  5.422e-03 2.711e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.270e-04,2.000e-03,1.990e-04 cost=4.121e+04 flops[gemm]=2.061e+07
--- TIMING FOR sigma : t_inter=2.270e-04 t_gemm=2.000e-03 t_reduction=1.980e-04 tot=2.425e-03 ---
 sigma counter=145 i=0 t=2.460e-04 per=1.230e+01 cost=2.582e+03 flops=1.050e+07
 sigma counter=145 i=1 t=2.430e-04 per=1.215e+01 cost=2.572e+03 flops=1.058e+07
 sigma counter=145 i=2 t=2.440e-04 per=1.220e+01 cost=3.754e+03 flops=1.539e+07
 sigma counter=145 i=3 t=2.460e-04 per=1.230e+01 cost=3.774e+03 flops=1.534e+07
 sigma counter=145 i=4 t=2.540e-04 per=1.270e+01 cost=4.112e+03 flops=1.619e+07
 sigma counter=145 i=5 t=2.520e-04 per=1.260e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=145 i=6 t=2.620e-04 per=1.310e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=145 i=7 t=2.530e-04 per=1.265e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.061e+07
--- TIMING FOR sigma_tot : t_inter=3.081e-02 t_gemm=2.853e-01 t_reduction=2.858e-02 tot=3.447e-01 ---
 sigma_tot counter=145 i=0 t=3.528e-02 per=1.236e+01 cost=3.744e+05 flops=1.061e+07
 sigma_tot counter=145 i=1 t=3.570e-02 per=1.251e+01 cost=3.807e+05 flops=1.066e+07
 sigma_tot counter=145 i=2 t=3.495e-02 per=1.225e+01 cost=4.263e+05 flops=1.220e+07
 sigma_tot counter=145 i=3 t=3.479e-02 per=1.219e+01 cost=4.334e+05 flops=1.246e+07
 sigma_tot counter=145 i=4 t=3.572e-02 per=1.252e+01 cost=7.969e+05 flops=2.231e+07
 sigma_tot counter=145 i=5 t=3.594e-02 per=1.260e+01 cost=7.991e+05 flops=2.223e+07
 sigma_tot counter=145 i=6 t=3.706e-02 per=1.299e+01 cost=9.397e+05 flops=2.536e+07
 sigma_tot counter=145 i=7 t=3.590e-02 per=1.258e+01 cost=9.346e+05 flops=2.603e+07
 total GEMM cost=5.085e+06 flops=1.782e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.100e-04,1.999e-03,1.980e-04 cost=4.121e+04 flops[gemm]=2.062e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=1.999e-03 t_reduction=1.980e-04 tot=2.407e-03 ---
 sigma counter=146 i=0 t=2.380e-04 per=1.191e+01 cost=2.582e+03 flops=1.085e+07
 sigma counter=146 i=1 t=2.490e-04 per=1.246e+01 cost=2.572e+03 flops=1.033e+07
 sigma counter=146 i=2 t=2.470e-04 per=1.236e+01 cost=3.754e+03 flops=1.520e+07
 sigma counter=146 i=3 t=2.470e-04 per=1.236e+01 cost=3.774e+03 flops=1.528e+07
 sigma counter=146 i=4 t=2.510e-04 per=1.256e+01 cost=4.112e+03 flops=1.638e+07
 sigma counter=146 i=5 t=2.500e-04 per=1.251e+01 cost=4.132e+03 flops=1.653e+07
 sigma counter=146 i=6 t=2.650e-04 per=1.326e+01 cost=1.014e+04 flops=3.828e+07
 sigma counter=146 i=7 t=2.520e-04 per=1.261e+01 cost=1.014e+04 flops=4.025e+07
 total GEMM cost=4.121e+04 flops=2.062e+07
--- TIMING FOR sigma_tot : t_inter=3.102e-02 t_gemm=2.873e-01 t_reduction=2.878e-02 tot=3.471e-01 ---
 sigma_tot counter=146 i=0 t=3.552e-02 per=1.236e+01 cost=3.770e+05 flops=1.061e+07
 sigma_tot counter=146 i=1 t=3.595e-02 per=1.251e+01 cost=3.832e+05 flops=1.066e+07
 sigma_tot counter=146 i=2 t=3.520e-02 per=1.225e+01 cost=4.301e+05 flops=1.222e+07
 sigma_tot counter=146 i=3 t=3.503e-02 per=1.219e+01 cost=4.372e+05 flops=1.248e+07
 sigma_tot counter=146 i=4 t=3.597e-02 per=1.252e+01 cost=8.010e+05 flops=2.227e+07
 sigma_tot counter=146 i=5 t=3.619e-02 per=1.260e+01 cost=8.032e+05 flops=2.219e+07
 sigma_tot counter=146 i=6 t=3.733e-02 per=1.299e+01 cost=9.499e+05 flops=2.545e+07
 sigma_tot counter=146 i=7 t=3.615e-02 per=1.258e+01 cost=9.448e+05 flops=2.613e+07
 total GEMM cost=5.126e+06 flops=1.784e+07
    2   0 -      -2.654426863105 -1.838e-03  1.257e-02    4     4  1.069e-02 2.672e-03
    2   1 -      -2.436959129202 -8.650e-04  5.189e-03    4     4  1.069e-02 2.672e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.210e-04,2.001e-03,1.970e-04 cost=4.121e+04 flops[gemm]=2.060e+07
--- TIMING FOR sigma : t_inter=2.210e-04 t_gemm=2.000e-03 t_reduction=1.970e-04 tot=2.418e-03 ---
 sigma counter=147 i=0 t=2.410e-04 per=1.205e+01 cost=2.582e+03 flops=1.071e+07
 sigma counter=147 i=1 t=2.490e-04 per=1.245e+01 cost=2.572e+03 flops=1.033e+07
 sigma counter=147 i=2 t=2.460e-04 per=1.230e+01 cost=3.754e+03 flops=1.526e+07
 sigma counter=147 i=3 t=2.480e-04 per=1.240e+01 cost=3.774e+03 flops=1.522e+07
 sigma counter=147 i=4 t=2.490e-04 per=1.245e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=147 i=5 t=2.500e-04 per=1.250e+01 cost=4.132e+03 flops=1.653e+07
 sigma counter=147 i=6 t=2.630e-04 per=1.315e+01 cost=1.014e+04 flops=3.857e+07
 sigma counter=147 i=7 t=2.540e-04 per=1.270e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.061e+07
--- TIMING FOR sigma_tot : t_inter=3.124e-02 t_gemm=2.893e-01 t_reduction=2.898e-02 tot=3.496e-01 ---
 sigma_tot counter=147 i=0 t=3.576e-02 per=1.236e+01 cost=3.795e+05 flops=1.061e+07
 sigma_tot counter=147 i=1 t=3.620e-02 per=1.251e+01 cost=3.858e+05 flops=1.066e+07
 sigma_tot counter=147 i=2 t=3.544e-02 per=1.225e+01 cost=4.338e+05 flops=1.224e+07
 sigma_tot counter=147 i=3 t=3.528e-02 per=1.219e+01 cost=4.410e+05 flops=1.250e+07
 sigma_tot counter=147 i=4 t=3.622e-02 per=1.252e+01 cost=8.051e+05 flops=2.223e+07
 sigma_tot counter=147 i=5 t=3.644e-02 per=1.260e+01 cost=8.073e+05 flops=2.215e+07
 sigma_tot counter=147 i=6 t=3.759e-02 per=1.299e+01 cost=9.600e+05 flops=2.554e+07
 sigma_tot counter=147 i=7 t=3.641e-02 per=1.258e+01 cost=9.549e+05 flops=2.623e+07
 total GEMM cost=5.168e+06 flops=1.786e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.100e-04,1.986e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.075e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=1.985e-03 t_reduction=1.960e-04 tot=2.391e-03 ---
 sigma counter=148 i=0 t=2.380e-04 per=1.199e+01 cost=2.582e+03 flops=1.085e+07
 sigma counter=148 i=1 t=2.380e-04 per=1.199e+01 cost=2.572e+03 flops=1.081e+07
 sigma counter=148 i=2 t=2.440e-04 per=1.229e+01 cost=3.754e+03 flops=1.539e+07
 sigma counter=148 i=3 t=2.460e-04 per=1.239e+01 cost=3.774e+03 flops=1.534e+07
 sigma counter=148 i=4 t=2.510e-04 per=1.264e+01 cost=4.112e+03 flops=1.638e+07
 sigma counter=148 i=5 t=2.530e-04 per=1.275e+01 cost=4.132e+03 flops=1.633e+07
 sigma counter=148 i=6 t=2.610e-04 per=1.315e+01 cost=1.014e+04 flops=3.887e+07
 sigma counter=148 i=7 t=2.540e-04 per=1.280e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.076e+07
--- TIMING FOR sigma_tot : t_inter=3.145e-02 t_gemm=2.913e-01 t_reduction=2.917e-02 tot=3.519e-01 ---
 sigma_tot counter=148 i=0 t=3.599e-02 per=1.236e+01 cost=3.821e+05 flops=1.062e+07
 sigma_tot counter=148 i=1 t=3.644e-02 per=1.251e+01 cost=3.884e+05 flops=1.066e+07
 sigma_tot counter=148 i=2 t=3.569e-02 per=1.225e+01 cost=4.376e+05 flops=1.226e+07
 sigma_tot counter=148 i=3 t=3.553e-02 per=1.219e+01 cost=4.447e+05 flops=1.252e+07
 sigma_tot counter=148 i=4 t=3.647e-02 per=1.252e+01 cost=8.092e+05 flops=2.219e+07
 sigma_tot counter=148 i=5 t=3.670e-02 per=1.260e+01 cost=8.115e+05 flops=2.211e+07
 sigma_tot counter=148 i=6 t=3.785e-02 per=1.299e+01 cost=9.702e+05 flops=2.563e+07
 sigma_tot counter=148 i=7 t=3.666e-02 per=1.258e+01 cost=9.650e+05 flops=2.632e+07
 total GEMM cost=5.209e+06 flops=1.788e+07
    3   0 -      -2.654508902835 -8.204e-05  3.559e-03    6     6  1.594e-02 2.656e-03
    3   1 -      -2.436975259478 -1.613e-05  1.592e-03    6     6  1.594e-02 2.656e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.170e-04,2.004e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.057e+07
--- TIMING FOR sigma : t_inter=2.170e-04 t_gemm=2.004e-03 t_reduction=1.960e-04 tot=2.417e-03 ---
 sigma counter=149 i=0 t=2.420e-04 per=1.208e+01 cost=2.582e+03 flops=1.067e+07
 sigma counter=149 i=1 t=2.450e-04 per=1.223e+01 cost=2.572e+03 flops=1.050e+07
 sigma counter=149 i=2 t=2.500e-04 per=1.248e+01 cost=3.754e+03 flops=1.502e+07
 sigma counter=149 i=3 t=2.460e-04 per=1.228e+01 cost=3.774e+03 flops=1.534e+07
 sigma counter=149 i=4 t=2.500e-04 per=1.248e+01 cost=4.112e+03 flops=1.645e+07
 sigma counter=149 i=5 t=2.510e-04 per=1.252e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=149 i=6 t=2.640e-04 per=1.317e+01 cost=1.014e+04 flops=3.842e+07
 sigma counter=149 i=7 t=2.560e-04 per=1.277e+01 cost=1.014e+04 flops=3.962e+07
 total GEMM cost=4.121e+04 flops=2.057e+07
--- TIMING FOR sigma_tot : t_inter=3.167e-02 t_gemm=2.933e-01 t_reduction=2.937e-02 tot=3.544e-01 ---
 sigma_tot counter=149 i=0 t=3.624e-02 per=1.235e+01 cost=3.847e+05 flops=1.062e+07
 sigma_tot counter=149 i=1 t=3.668e-02 per=1.250e+01 cost=3.910e+05 flops=1.066e+07
 sigma_tot counter=149 i=2 t=3.594e-02 per=1.225e+01 cost=4.413e+05 flops=1.228e+07
 sigma_tot counter=149 i=3 t=3.577e-02 per=1.220e+01 cost=4.485e+05 flops=1.254e+07
 sigma_tot counter=149 i=4 t=3.672e-02 per=1.252e+01 cost=8.133e+05 flops=2.215e+07
 sigma_tot counter=149 i=5 t=3.695e-02 per=1.260e+01 cost=8.156e+05 flops=2.208e+07
 sigma_tot counter=149 i=6 t=3.812e-02 per=1.299e+01 cost=9.803e+05 flops=2.572e+07
 sigma_tot counter=149 i=7 t=3.692e-02 per=1.259e+01 cost=9.752e+05 flops=2.642e+07
 total GEMM cost=5.250e+06 flops=1.790e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.080e-04,2.002e-03,1.980e-04 cost=4.121e+04 flops[gemm]=2.059e+07
--- TIMING FOR sigma : t_inter=2.080e-04 t_gemm=2.002e-03 t_reduction=1.980e-04 tot=2.408e-03 ---
 sigma counter=150 i=0 t=2.410e-04 per=1.204e+01 cost=2.582e+03 flops=1.071e+07
 sigma counter=150 i=1 t=2.360e-04 per=1.179e+01 cost=2.572e+03 flops=1.090e+07
 sigma counter=150 i=2 t=2.440e-04 per=1.219e+01 cost=3.754e+03 flops=1.539e+07
 sigma counter=150 i=3 t=2.550e-04 per=1.274e+01 cost=3.774e+03 flops=1.480e+07
 sigma counter=150 i=4 t=2.590e-04 per=1.294e+01 cost=4.112e+03 flops=1.588e+07
 sigma counter=150 i=5 t=2.530e-04 per=1.264e+01 cost=4.132e+03 flops=1.633e+07
 sigma counter=150 i=6 t=2.620e-04 per=1.309e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=150 i=7 t=2.520e-04 per=1.259e+01 cost=1.014e+04 flops=4.025e+07
 total GEMM cost=4.121e+04 flops=2.059e+07
--- TIMING FOR sigma_tot : t_inter=3.188e-02 t_gemm=2.953e-01 t_reduction=2.957e-02 tot=3.568e-01 ---
 sigma_tot counter=150 i=0 t=3.648e-02 per=1.235e+01 cost=3.873e+05 flops=1.062e+07
 sigma_tot counter=150 i=1 t=3.692e-02 per=1.250e+01 cost=3.935e+05 flops=1.066e+07
 sigma_tot counter=150 i=2 t=3.618e-02 per=1.225e+01 cost=4.451e+05 flops=1.230e+07
 sigma_tot counter=150 i=3 t=3.603e-02 per=1.220e+01 cost=4.523e+05 flops=1.255e+07
 sigma_tot counter=150 i=4 t=3.698e-02 per=1.252e+01 cost=8.174e+05 flops=2.211e+07
 sigma_tot counter=150 i=5 t=3.720e-02 per=1.260e+01 cost=8.197e+05 flops=2.204e+07
 sigma_tot counter=150 i=6 t=3.838e-02 per=1.300e+01 cost=9.905e+05 flops=2.581e+07
 sigma_tot counter=150 i=7 t=3.717e-02 per=1.259e+01 cost=9.853e+05 flops=2.651e+07
 total GEMM cost=5.291e+06 flops=1.792e+07
    4   0 -      -2.654515665767 -6.763e-06  1.294e-03    6     8  2.118e-02 2.647e-03
    4   1 -      -2.436977069548 -1.810e-06  5.993e-04    6     8  2.118e-02 2.647e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.170e-04,1.996e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.065e+07
--- TIMING FOR sigma : t_inter=2.170e-04 t_gemm=1.996e-03 t_reduction=1.960e-04 tot=2.409e-03 ---
 sigma counter=151 i=0 t=2.410e-04 per=1.207e+01 cost=2.582e+03 flops=1.071e+07
 sigma counter=151 i=1 t=2.440e-04 per=1.222e+01 cost=2.572e+03 flops=1.054e+07
 sigma counter=151 i=2 t=2.460e-04 per=1.232e+01 cost=3.754e+03 flops=1.526e+07
 sigma counter=151 i=3 t=2.470e-04 per=1.237e+01 cost=3.774e+03 flops=1.528e+07
 sigma counter=151 i=4 t=2.490e-04 per=1.247e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=151 i=5 t=2.520e-04 per=1.263e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=151 i=6 t=2.630e-04 per=1.318e+01 cost=1.014e+04 flops=3.857e+07
 sigma counter=151 i=7 t=2.540e-04 per=1.273e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.065e+07
--- TIMING FOR sigma_tot : t_inter=3.210e-02 t_gemm=2.973e-01 t_reduction=2.976e-02 tot=3.592e-01 ---
 sigma_tot counter=151 i=0 t=3.672e-02 per=1.235e+01 cost=3.899e+05 flops=1.062e+07
 sigma_tot counter=151 i=1 t=3.716e-02 per=1.250e+01 cost=3.961e+05 flops=1.066e+07
 sigma_tot counter=151 i=2 t=3.643e-02 per=1.225e+01 cost=4.489e+05 flops=1.232e+07
 sigma_tot counter=151 i=3 t=3.627e-02 per=1.220e+01 cost=4.560e+05 flops=1.257e+07
 sigma_tot counter=151 i=4 t=3.723e-02 per=1.252e+01 cost=8.216e+05 flops=2.207e+07
 sigma_tot counter=151 i=5 t=3.745e-02 per=1.260e+01 cost=8.239e+05 flops=2.200e+07
 sigma_tot counter=151 i=6 t=3.864e-02 per=1.300e+01 cost=1.001e+06 flops=2.590e+07
 sigma_tot counter=151 i=7 t=3.742e-02 per=1.259e+01 cost=9.955e+05 flops=2.660e+07
 total GEMM cost=5.332e+06 flops=1.793e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.100e-04,2.020e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.040e+07
--- TIMING FOR sigma : t_inter=2.090e-04 t_gemm=2.020e-03 t_reduction=1.960e-04 tot=2.425e-03 ---
 sigma counter=152 i=0 t=2.390e-04 per=1.183e+01 cost=2.582e+03 flops=1.080e+07
 sigma counter=152 i=1 t=2.380e-04 per=1.178e+01 cost=2.572e+03 flops=1.081e+07
 sigma counter=152 i=2 t=2.510e-04 per=1.243e+01 cost=3.754e+03 flops=1.496e+07
 sigma counter=152 i=3 t=2.500e-04 per=1.238e+01 cost=3.774e+03 flops=1.510e+07
 sigma counter=152 i=4 t=2.560e-04 per=1.267e+01 cost=4.112e+03 flops=1.606e+07
 sigma counter=152 i=5 t=2.570e-04 per=1.272e+01 cost=4.132e+03 flops=1.608e+07
 sigma counter=152 i=6 t=2.660e-04 per=1.317e+01 cost=1.014e+04 flops=3.814e+07
 sigma counter=152 i=7 t=2.630e-04 per=1.302e+01 cost=1.014e+04 flops=3.857e+07
 total GEMM cost=4.121e+04 flops=2.040e+07
--- TIMING FOR sigma_tot : t_inter=3.231e-02 t_gemm=2.993e-01 t_reduction=2.996e-02 tot=3.616e-01 ---
 sigma_tot counter=152 i=0 t=3.696e-02 per=1.235e+01 cost=3.925e+05 flops=1.062e+07
 sigma_tot counter=152 i=1 t=3.740e-02 per=1.249e+01 cost=3.987e+05 flops=1.066e+07
 sigma_tot counter=152 i=2 t=3.668e-02 per=1.225e+01 cost=4.526e+05 flops=1.234e+07
 sigma_tot counter=152 i=3 t=3.652e-02 per=1.220e+01 cost=4.598e+05 flops=1.259e+07
 sigma_tot counter=152 i=4 t=3.748e-02 per=1.252e+01 cost=8.257e+05 flops=2.203e+07
 sigma_tot counter=152 i=5 t=3.771e-02 per=1.260e+01 cost=8.280e+05 flops=2.196e+07
 sigma_tot counter=152 i=6 t=3.891e-02 per=1.300e+01 cost=1.011e+06 flops=2.598e+07
 sigma_tot counter=152 i=7 t=3.769e-02 per=1.259e+01 cost=1.006e+06 flops=2.668e+07
 total GEMM cost=5.374e+06 flops=1.795e+07
    5   0 -      -2.654516771324 -1.106e-06  5.133e-04    6    10  2.645e-02 2.645e-03
    5   1 -      -2.436977368102 -2.986e-07  2.915e-04    6    10  2.645e-02 2.645e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.160e-04,2.030e-03,2.010e-04 cost=4.121e+04 flops[gemm]=2.030e+07
--- TIMING FOR sigma : t_inter=2.150e-04 t_gemm=2.030e-03 t_reduction=2.010e-04 tot=2.446e-03 ---
 sigma counter=153 i=0 t=2.480e-04 per=1.222e+01 cost=2.582e+03 flops=1.041e+07
 sigma counter=153 i=1 t=2.400e-04 per=1.182e+01 cost=2.572e+03 flops=1.072e+07
 sigma counter=153 i=2 t=2.520e-04 per=1.241e+01 cost=3.754e+03 flops=1.490e+07
 sigma counter=153 i=3 t=2.510e-04 per=1.236e+01 cost=3.774e+03 flops=1.504e+07
 sigma counter=153 i=4 t=2.580e-04 per=1.271e+01 cost=4.112e+03 flops=1.594e+07
 sigma counter=153 i=5 t=2.590e-04 per=1.276e+01 cost=4.132e+03 flops=1.595e+07
 sigma counter=153 i=6 t=2.690e-04 per=1.325e+01 cost=1.014e+04 flops=3.771e+07
 sigma counter=153 i=7 t=2.530e-04 per=1.246e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.030e+07
--- TIMING FOR sigma_tot : t_inter=3.252e-02 t_gemm=3.014e-01 t_reduction=3.016e-02 tot=3.641e-01 ---
 sigma_tot counter=153 i=0 t=3.721e-02 per=1.235e+01 cost=3.950e+05 flops=1.062e+07
 sigma_tot counter=153 i=1 t=3.764e-02 per=1.249e+01 cost=4.012e+05 flops=1.066e+07
 sigma_tot counter=153 i=2 t=3.693e-02 per=1.225e+01 cost=4.564e+05 flops=1.236e+07
 sigma_tot counter=153 i=3 t=3.678e-02 per=1.220e+01 cost=4.636e+05 flops=1.261e+07
 sigma_tot counter=153 i=4 t=3.774e-02 per=1.252e+01 cost=8.298e+05 flops=2.199e+07
 sigma_tot counter=153 i=5 t=3.797e-02 per=1.260e+01 cost=8.321e+05 flops=2.192e+07
 sigma_tot counter=153 i=6 t=3.918e-02 per=1.300e+01 cost=1.021e+06 flops=2.606e+07
 sigma_tot counter=153 i=7 t=3.794e-02 per=1.259e+01 cost=1.016e+06 flops=2.677e+07
 total GEMM cost=5.415e+06 flops=1.797e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.100e-04,2.002e-03,1.950e-04 cost=4.121e+04 flops[gemm]=2.059e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=2.002e-03 t_reduction=1.950e-04 tot=2.407e-03 ---
 sigma counter=154 i=0 t=2.400e-04 per=1.199e+01 cost=2.582e+03 flops=1.076e+07
 sigma counter=154 i=1 t=2.510e-04 per=1.254e+01 cost=2.572e+03 flops=1.025e+07
 sigma counter=154 i=2 t=2.450e-04 per=1.224e+01 cost=3.754e+03 flops=1.532e+07
 sigma counter=154 i=3 t=2.460e-04 per=1.229e+01 cost=3.774e+03 flops=1.534e+07
 sigma counter=154 i=4 t=2.500e-04 per=1.249e+01 cost=4.112e+03 flops=1.645e+07
 sigma counter=154 i=5 t=2.530e-04 per=1.264e+01 cost=4.132e+03 flops=1.633e+07
 sigma counter=154 i=6 t=2.620e-04 per=1.309e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=154 i=7 t=2.550e-04 per=1.274e+01 cost=1.014e+04 flops=3.978e+07
 total GEMM cost=4.121e+04 flops=2.059e+07
--- TIMING FOR sigma_tot : t_inter=3.273e-02 t_gemm=3.034e-01 t_reduction=3.036e-02 tot=3.665e-01 ---
 sigma_tot counter=154 i=0 t=3.745e-02 per=1.234e+01 cost=3.976e+05 flops=1.062e+07
 sigma_tot counter=154 i=1 t=3.789e-02 per=1.249e+01 cost=4.038e+05 flops=1.066e+07
 sigma_tot counter=154 i=2 t=3.718e-02 per=1.225e+01 cost=4.601e+05 flops=1.238e+07
 sigma_tot counter=154 i=3 t=3.702e-02 per=1.220e+01 cost=4.674e+05 flops=1.262e+07
 sigma_tot counter=154 i=4 t=3.799e-02 per=1.252e+01 cost=8.339e+05 flops=2.195e+07
 sigma_tot counter=154 i=5 t=3.822e-02 per=1.260e+01 cost=8.363e+05 flops=2.188e+07
 sigma_tot counter=154 i=6 t=3.944e-02 per=1.300e+01 cost=1.031e+06 flops=2.614e+07
 sigma_tot counter=154 i=7 t=3.819e-02 per=1.259e+01 cost=1.026e+06 flops=2.686e+07
 total GEMM cost=5.456e+06 flops=1.798e+07
    6   0 -      -2.654516945140 -1.738e-07  1.835e-04    6    12  3.174e-02 2.645e-03
    6   1 -      -2.436977443846 -7.574e-08  1.163e-04    6    12  3.174e-02 2.645e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.000e-05,2.250e-04,2.002e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.059e+07
--- TIMING FOR sigma : t_inter=2.250e-04 t_gemm=2.002e-03 t_reduction=1.960e-04 tot=2.423e-03 ---
 sigma counter=155 i=0 t=2.430e-04 per=1.214e+01 cost=2.582e+03 flops=1.063e+07
 sigma counter=155 i=1 t=2.440e-04 per=1.219e+01 cost=2.572e+03 flops=1.054e+07
 sigma counter=155 i=2 t=2.460e-04 per=1.229e+01 cost=3.754e+03 flops=1.526e+07
 sigma counter=155 i=3 t=2.510e-04 per=1.254e+01 cost=3.774e+03 flops=1.504e+07
 sigma counter=155 i=4 t=2.500e-04 per=1.249e+01 cost=4.112e+03 flops=1.645e+07
 sigma counter=155 i=5 t=2.530e-04 per=1.264e+01 cost=4.132e+03 flops=1.633e+07
 sigma counter=155 i=6 t=2.610e-04 per=1.304e+01 cost=1.014e+04 flops=3.887e+07
 sigma counter=155 i=7 t=2.540e-04 per=1.269e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.059e+07
--- TIMING FOR sigma_tot : t_inter=3.296e-02 t_gemm=3.054e-01 t_reduction=3.055e-02 tot=3.689e-01 ---
 sigma_tot counter=155 i=0 t=3.769e-02 per=1.234e+01 cost=4.002e+05 flops=1.062e+07
 sigma_tot counter=155 i=1 t=3.813e-02 per=1.249e+01 cost=4.064e+05 flops=1.066e+07
 sigma_tot counter=155 i=2 t=3.742e-02 per=1.225e+01 cost=4.639e+05 flops=1.240e+07
 sigma_tot counter=155 i=3 t=3.727e-02 per=1.221e+01 cost=4.711e+05 flops=1.264e+07
 sigma_tot counter=155 i=4 t=3.824e-02 per=1.252e+01 cost=8.380e+05 flops=2.191e+07
 sigma_tot counter=155 i=5 t=3.847e-02 per=1.260e+01 cost=8.404e+05 flops=2.184e+07
 sigma_tot counter=155 i=6 t=3.970e-02 per=1.300e+01 cost=1.041e+06 flops=2.623e+07
 sigma_tot counter=155 i=7 t=3.845e-02 per=1.259e+01 cost=1.036e+06 flops=2.695e+07
 total GEMM cost=5.497e+06 flops=1.800e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.090e-04,2.005e-03,1.980e-04 cost=4.121e+04 flops[gemm]=2.056e+07
--- TIMING FOR sigma : t_inter=2.090e-04 t_gemm=2.005e-03 t_reduction=1.980e-04 tot=2.412e-03 ---
 sigma counter=156 i=0 t=2.380e-04 per=1.187e+01 cost=2.582e+03 flops=1.085e+07
 sigma counter=156 i=1 t=2.510e-04 per=1.252e+01 cost=2.572e+03 flops=1.025e+07
 sigma counter=156 i=2 t=2.450e-04 per=1.222e+01 cost=3.754e+03 flops=1.532e+07
 sigma counter=156 i=3 t=2.470e-04 per=1.232e+01 cost=3.774e+03 flops=1.528e+07
 sigma counter=156 i=4 t=2.540e-04 per=1.267e+01 cost=4.112e+03 flops=1.619e+07
 sigma counter=156 i=5 t=2.530e-04 per=1.262e+01 cost=4.132e+03 flops=1.633e+07
 sigma counter=156 i=6 t=2.630e-04 per=1.312e+01 cost=1.014e+04 flops=3.857e+07
 sigma counter=156 i=7 t=2.540e-04 per=1.267e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.056e+07
--- TIMING FOR sigma_tot : t_inter=3.316e-02 t_gemm=3.074e-01 t_reduction=3.075e-02 tot=3.713e-01 ---
 sigma_tot counter=156 i=0 t=3.793e-02 per=1.234e+01 cost=4.028e+05 flops=1.062e+07
 sigma_tot counter=156 i=1 t=3.838e-02 per=1.249e+01 cost=4.090e+05 flops=1.065e+07
 sigma_tot counter=156 i=2 t=3.767e-02 per=1.225e+01 cost=4.676e+05 flops=1.241e+07
 sigma_tot counter=156 i=3 t=3.752e-02 per=1.221e+01 cost=4.749e+05 flops=1.266e+07
 sigma_tot counter=156 i=4 t=3.850e-02 per=1.252e+01 cost=8.421e+05 flops=2.188e+07
 sigma_tot counter=156 i=5 t=3.873e-02 per=1.260e+01 cost=8.445e+05 flops=2.181e+07
 sigma_tot counter=156 i=6 t=3.996e-02 per=1.300e+01 cost=1.051e+06 flops=2.631e+07
 sigma_tot counter=156 i=7 t=3.870e-02 per=1.259e+01 cost=1.046e+06 flops=2.703e+07
 total GEMM cost=5.538e+06 flops=1.802e+07
    7   0 +      -2.654516966643 -2.150e-08  4.639e-05    6    14  3.699e-02 2.642e-03
    7   1 +      -2.436977450693 -6.847e-09  2.690e-05    6    14  3.699e-02 2.642e-03
TIMING FOR Davidson : 3.702e-02  T(cal/comm/rest)=3.643e-02,4.869e-05,5.333e-04
optimized energies: isweep=3 dots=2 ibond=2 e[0]=-2.65451696664 nmvp=14
optimized energies: isweep=3 dots=2 ibond=2 e[1]=-2.43697745069 nmvp=14
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=9 alg_decim=1 mpisize=2 maxthreads=2
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
TIMING FOR decimation: 4.0e-04 S T(wf/decim)=3.2e-04,7.4e-05
ctns::oper_renorm coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=872:6.7e-03MB:6.5e-06GB
rank=0 GPUmem(GB): used=2.3e-05 (oper)=8.7e-06
rank=0 GPUmem(GB): used=2.3e-05 (oper,site)(GB)=8.7e-06,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 5.794e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=2.29e-05 (oper,site,rinter)=8.67e-06,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000978 S size(rtasks)=37 size(Rlst2)=9 T(Rmu/Rlist)=0.000197,0.000781 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00105 S size(rtasks)=37 size(Rlst)=788 -----
rank=0 GPUmem(GB): used=0.000217 (oper,site,rinter,batch)=8.67e-06,2.68e-07,0,0.000194 blksize=16 blksize0=0 batchsize=788
timing: allocate=3.58e-05 rmmtasks init=0.000915 total=0.000951
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=6e-06,0.00116,0.000197 cost=1.56e+04 flops[gemm]=1.34e+07
--- TIMING FOR renorm : t_inter=6e-06 t_gemm=0.00116 t_reduction=0.000196 tot=0.00136 ---
 renorm counter=15 i=0 t=0.000235 per=20.3 cost=874 flops=3.72e+06
 renorm counter=15 i=1 t=0.000229 per=19.8 cost=1.76e+03 flops=7.69e+06
 renorm counter=15 i=2 t=0.000224 per=19.4 cost=994 flops=4.44e+06
 renorm counter=15 i=3 t=0.000224 per=19.4 cost=1.75e+03 flops=7.81e+06
 renorm counter=15 i=4 t=1e-06 per=0.0864 cost=0 flops=0
 renorm counter=15 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=15 i=6 t=0.000244 per=21.1 cost=1.02e+04 flops=4.17e+07
 total GEMM cost=1.56e+04 flops=1.35e+07
--- TIMING FOR renorm_tot : t_inter=0.00151 t_gemm=0.0173 t_reduction=0.00302 tot=0.0218 ---
 renorm_tot counter=15 i=0 t=0.0035 per=20.2 cost=3.02e+04 flops=8.65e+06
 renorm_tot counter=15 i=1 t=0.00341 per=19.7 cost=4.42e+04 flops=1.3e+07
 renorm_tot counter=15 i=2 t=0.00155 per=8.94 cost=2.48e+04 flops=1.6e+07
 renorm_tot counter=15 i=3 t=0.00156 per=9.04 cost=4.29e+04 flops=2.74e+07
 renorm_tot counter=15 i=4 t=0.00179 per=10.3 cost=3.56e+04 flops=1.99e+07
 renorm_tot counter=15 i=5 t=0.00182 per=10.5 cost=6.23e+04 flops=3.42e+07
 renorm_tot counter=15 i=6 t=0.00369 per=21.3 cost=3.73e+05 flops=1.01e+08
 total GEMM cost=6.13e+05 flops=3.54e+07
timing: gpu2cpu=1.47e-05 deallocate(site/work)=2.61e-06,5.18e-06 total=1.98e-05
check ||H-H.dagger||=0.000e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.00472 S T(init/kernel/comm)=0.000428,0.00422,6.97e-05 rank=0 -----
TIMING FOR cleanup: 0.000355 T(erase/save/remove)=9.56e-05,0.000221,3.85e-05
##### local: 5.307e-02 S #####
 T(local: fetch) = 1.265e-04 S  per = 0.238  per(accum) = 0.238
 T(local: hdiag) = 5.195e-04 S  per = 0.979  per(accum) = 1.22
 T(local: dvdsn) = 4.619e-02 S  per =   87  per(accum) = 88.3
 T(local: decim) = 4.901e-04 S  per = 0.923  per(accum) = 89.2
 T(local: guess) = 5.102e-04 S  per = 0.961  per(accum) = 90.1
 T(local: renrm) = 4.864e-03 S  per = 9.16  per(accum) = 99.3
 T(local: save ) = 3.689e-04 S  per = 0.695  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.512e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 8.280e-06 S  per = 0.0184  per(accum) = 0.0184
 T(local: symbolic_formulae_twodot     ) = 6.585e-04 S  per = 1.46  per(accum) = 1.48
 T(local: hintermediate init           ) = 5.755e-05 S  per = 0.128  per(accum) = 1.61
 T(local: hintermediates memcpy cpu2gpu) = 3.300e-08 S  per = 7.31e-05  per(accum) = 1.61
 T(local: preprocess_hformulae_Hxlist2 ) = 3.697e-03 S  per =  8.2  per(accum) = 9.8
 T(local: hmmtasks init                ) = 3.678e-03 S  per = 8.15  per(accum) = 18
 T(local: dvdson solver [Hx_batchGPU]  ) = 3.643e-02 S  per = 80.8  per(accum) = 98.7
 T(local: dvdson solver [communication]) = 4.869e-05 S  per = 0.108  per(accum) = 98.8
 T(local: dvdson solver [rest part]    ) = 5.333e-04 S  per = 1.18  per(accum) = 100
Detailed decomposition of T(renrm): 4.717e-03 S
 T(local: qops init                    ) = 4.278e-04 S  per = 9.07  per(accum) = 9.07
 T(local: qops_dict memcpy cpu2gpu     ) = 3.739e-05 S  per = 0.793  per(accum) = 9.86
 T(local: symbolic_formulae_renorm     ) = 5.885e-04 S  per = 12.5  per(accum) = 22.3
 T(local: rintermediate init           ) = 2.442e-05 S  per = 0.518  per(accum) = 22.9
 T(local: rintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 0.000615  per(accum) = 22.9
 T(local: preprocess_formulae_Rlist2   ) = 1.079e-03 S  per = 22.9  per(accum) = 45.7
 T(local: rmmtasks init                ) = 9.587e-04 S  per = 20.3  per(accum) = 66.1
 T(local: qops memset                  ) = 2.800e-08 S  per = 0.000594  per(accum) = 66.1
 T(local: preprocess_renorm_batchGPU   ) = 1.478e-03 S  per = 31.3  per(accum) = 97.4
 T(local: qops memcpy gpu2cpu          ) = 1.474e-05 S  per = 0.312  per(accum) = 97.7
 T(local: deallocate gpu memory        ) = 3.916e-05 S  per = 0.83  per(accum) = 98.5
 T(local: communication of opS and opH ) = 6.966e-05 S  per = 1.48  per(accum) = 100
##### sweep: 1.278e-01 S #####
 T(sweep: fetch) = 1.322e-03 S  per = 1.03  per(accum) = 1.03
 T(sweep: hdiag) = 1.619e-03 S  per = 1.27  per(accum) = 2.3
 T(sweep: dvdsn) = 1.052e-01 S  per = 82.3  per(accum) = 84.6
 T(sweep: decim) = 2.125e-03 S  per = 1.66  per(accum) = 86.3
 T(sweep: guess) = 1.434e-03 S  per = 1.12  per(accum) = 87.4
 T(sweep: renrm) = 1.512e-02 S  per = 11.8  per(accum) = 99.3
 T(sweep: save ) = 9.554e-04 S  per = 0.748  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.018e-01 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 2.488e-05 S  per = 0.0244  per(accum) = 0.0244
 T(sweep: symbolic_formulae_twodot     ) = 2.022e-03 S  per = 1.99  per(accum) = 2.01
 T(sweep: hintermediate init           ) = 1.792e-04 S  per = 0.176  per(accum) = 2.19
 T(sweep: hintermediates memcpy cpu2gpu) = 9.400e-08 S  per = 9.23e-05  per(accum) = 2.19
 T(sweep: preprocess_hformulae_Hxlist2 ) = 1.128e-02 S  per = 11.1  per(accum) = 13.3
 T(sweep: hmmtasks init                ) = 1.112e-02 S  per = 10.9  per(accum) = 24.2
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 7.581e-02 S  per = 74.5  per(accum) = 98.7
 T(sweep: dvdson solver [communication]) = 1.047e-04 S  per = 0.103  per(accum) = 98.8
 T(sweep: dvdson solver [rest part]    ) = 1.268e-03 S  per = 1.25  per(accum) = 100
Detailed decomposition of T(renrm): 1.467e-02 S
 T(sweep: qops init                    ) = 1.177e-03 S  per = 8.03  per(accum) = 8.03
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.190e-04 S  per = 0.811  per(accum) = 8.84
 T(sweep: symbolic_formulae_renorm     ) = 1.663e-03 S  per = 11.3  per(accum) = 20.2
 T(sweep: rintermediate init           ) = 1.312e-04 S  per = 0.895  per(accum) = 21.1
 T(sweep: rintermediates memcpy cpu2gpu) = 8.600e-08 S  per = 0.000586  per(accum) = 21.1
 T(sweep: preprocess_formulae_Rlist2   ) = 3.301e-03 S  per = 22.5  per(accum) = 43.6
 T(sweep: rmmtasks init                ) = 3.211e-03 S  per = 21.9  per(accum) = 65.5
 T(sweep: qops memset                  ) = 8.800e-08 S  per = 0.0006  per(accum) = 65.5
 T(sweep: preprocess_renorm_batchGPU   ) = 4.709e-03 S  per = 32.1  per(accum) = 97.6
 T(sweep: qops memcpy gpu2cpu          ) = 4.613e-05 S  per = 0.314  per(accum) = 97.9
 T(sweep: deallocate gpu memory        ) = 1.117e-04 S  per = 0.762  per(accum) = 98.7
 T(sweep: communication of opS and opH ) = 1.977e-04 S  per = 1.35  per(accum) = 100
##### global: 6.513e-01 S #####
 T(global: fetch) = 1.024e-02 S  per = 1.57  per(accum) = 1.57
 T(global: hdiag) = 8.316e-03 S  per = 1.28  per(accum) = 2.85
 T(global: dvdsn) = 5.373e-01 S  per = 82.5  per(accum) = 85.3
 T(global: decim) = 1.303e-02 S  per =    2  per(accum) = 87.3
 T(global: guess) = 6.466e-03 S  per = 0.993  per(accum) = 88.3
 T(global: renrm) = 7.156e-02 S  per =   11  per(accum) = 99.3
 T(global: save ) = 4.409e-03 S  per = 0.677  per(accum) = 100
Detailed decomposition of T(dvdsn): 5.216e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 1.618e-04 S  per = 0.031  per(accum) = 0.031
 T(global: symbolic_formulae_twodot     ) = 9.962e-03 S  per = 1.91  per(accum) = 1.94
 T(global: hintermediate init           ) = 8.786e-04 S  per = 0.168  per(accum) = 2.11
 T(global: hintermediates memcpy cpu2gpu) = 4.430e-07 S  per = 8.49e-05  per(accum) = 2.11
 T(global: preprocess_hformulae_Hxlist2 ) = 5.227e-02 S  per =   10  per(accum) = 12.1
 T(global: hmmtasks init                ) = 5.145e-02 S  per = 9.86  per(accum) = 22
 T(global: dvdson solver [Hx_batchGPU]  ) = 3.997e-01 S  per = 76.6  per(accum) = 98.6
 T(global: dvdson solver [communication]) = 5.528e-04 S  per = 0.106  per(accum) = 98.7
 T(global: dvdson solver [rest part]    ) = 6.606e-03 S  per = 1.27  per(accum) = 100
Detailed decomposition of T(renrm): 6.938e-02 S
 T(global: qops init                    ) = 5.294e-03 S  per = 7.63  per(accum) = 7.63
 T(global: qops_dict memcpy cpu2gpu     ) = 6.298e-04 S  per = 0.908  per(accum) = 8.54
 T(global: symbolic_formulae_renorm     ) = 8.120e-03 S  per = 11.7  per(accum) = 20.2
 T(global: rintermediate init           ) = 6.877e-04 S  per = 0.991  per(accum) = 21.2
 T(global: rintermediates memcpy cpu2gpu) = 4.260e-07 S  per = 0.000614  per(accum) = 21.2
 T(global: preprocess_formulae_Rlist2   ) = 1.499e-02 S  per = 21.6  per(accum) = 42.8
 T(global: rmmtasks init                ) = 1.428e-02 S  per = 20.6  per(accum) = 63.4
 T(global: qops memset                  ) = 4.190e-07 S  per = 0.000604  per(accum) = 63.4
 T(global: preprocess_renorm_batchGPU   ) = 2.363e-02 S  per = 34.1  per(accum) = 97.5
 T(global: qops memcpy gpu2cpu          ) = 2.309e-04 S  per = 0.333  per(accum) = 97.8
 T(global: deallocate gpu memory        ) = 5.608e-04 S  per = 0.808  per(accum) = 98.6
 T(global: communication of opS and opH ) = 9.536e-04 S  per = 1.37  per(accum) = 100

isweep=3 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=872:0.00665MB:6.5e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1310:0.00999MB:9.76e-06GB
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x42f4d030
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
### DIAG TIMING: total=0.000359 t1=7.62e-06, t2=1.39e-05, t3=4.84e-05, t4=0.000184, t5=6.08e-05, t6=2.92e-05, t7=1.25e-05, t8=2.55e-06
duration_diagGPU:0.000373
duration_diagreduce:3.97e-06
duration_diagtransform:1.76e-06
rank=0 GPUmem(GB): used=9.76e-06 (oper)=9.76e-06
----- TIMING FOR symbolic_formulae_twodot with size=93 : 6.314e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=93
 no. of hintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.824e-05 S -----
rank=0 GPUmem(GB): used=1.01e-05 (oper,hinter)=9.76e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00339 S size(H_formulae)=93 size(Hxlst2)=49 T(Hmu/Hxlist)=0.00018,0.00321 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00365 S size(H_formulae)=93 size(Hxlst)=3134 -----
rank=0 GPUmem(GB): used=0.000409 (oper,hinter,dvdson,batch)=9.76e-06,2.98e-07,1.49e-06,0.000397 blksize=4 blksize0=8 batchsize=3134
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000218,0.00203,0.000198 cost=4.22e+04 flops[gemm]=2.08e+07
--- TIMING FOR sigma : t_inter=0.000218 t_gemm=0.00203 t_reduction=0.000198 tot=0.00245 ---
 sigma counter=157 i=0 t=0.000257 per=12.7 cost=3.72e+03 flops=1.45e+07
 sigma counter=157 i=1 t=0.000264 per=13 cost=3.74e+03 flops=1.42e+07
 sigma counter=157 i=2 t=0.000244 per=12 cost=3.04e+03 flops=1.24e+07
 sigma counter=157 i=3 t=0.000239 per=11.8 cost=3.03e+03 flops=1.27e+07
 sigma counter=157 i=4 t=0.000256 per=12.6 cost=1e+04 flops=3.91e+07
 sigma counter=157 i=5 t=0.000255 per=12.6 cost=1e+04 flops=3.92e+07
 sigma counter=157 i=6 t=0.000265 per=13 cost=4.34e+03 flops=1.64e+07
 sigma counter=157 i=7 t=0.000251 per=12.4 cost=4.32e+03 flops=1.72e+07
 total GEMM cost=4.22e+04 flops=2.08e+07
--- TIMING FOR sigma_tot : t_inter=0.0334 t_gemm=0.309 t_reduction=0.0309 tot=0.374 ---
 sigma_tot counter=157 i=0 t=0.0382 per=12.3 cost=4.06e+05 flops=1.06e+07
 sigma_tot counter=157 i=1 t=0.0386 per=12.5 cost=4.13e+05 flops=1.07e+07
 sigma_tot counter=157 i=2 t=0.0379 per=12.3 cost=4.71e+05 flops=1.24e+07
 sigma_tot counter=157 i=3 t=0.0378 per=12.2 cost=4.78e+05 flops=1.27e+07
 sigma_tot counter=157 i=4 t=0.0388 per=12.5 cost=8.52e+05 flops=2.2e+07
 sigma_tot counter=157 i=5 t=0.039 per=12.6 cost=8.55e+05 flops=2.19e+07
 sigma_tot counter=157 i=6 t=0.0402 per=13 cost=1.06e+06 flops=2.62e+07
 sigma_tot counter=157 i=7 t=0.039 per=12.6 cost=1.05e+06 flops=2.7e+07
 total GEMM cost=5.58e+06 flops=1.8e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.1e-05,0.000217,0.00203,0.000211 cost=4.22e+04 flops[gemm]=2.07e+07
--- TIMING FOR sigma : t_inter=0.000217 t_gemm=0.00203 t_reduction=0.000211 tot=0.00246 ---
 sigma counter=158 i=0 t=0.000252 per=12.4 cost=3.72e+03 flops=1.47e+07
 sigma counter=158 i=1 t=0.000254 per=12.5 cost=3.74e+03 flops=1.47e+07
 sigma counter=158 i=2 t=0.000241 per=11.8 cost=3.04e+03 flops=1.26e+07
 sigma counter=158 i=3 t=0.000243 per=11.9 cost=3.03e+03 flops=1.25e+07
 sigma counter=158 i=4 t=0.00026 per=12.8 cost=1e+04 flops=3.85e+07
 sigma counter=158 i=5 t=0.000259 per=12.7 cost=1e+04 flops=3.86e+07
 sigma counter=158 i=6 t=0.000264 per=13 cost=4.34e+03 flops=1.64e+07
 sigma counter=158 i=7 t=0.000261 per=12.8 cost=4.32e+03 flops=1.65e+07
 total GEMM cost=4.22e+04 flops=2.07e+07
--- TIMING FOR sigma_tot : t_inter=0.0336 t_gemm=0.311 t_reduction=0.0312 tot=0.376 ---
 sigma_tot counter=158 i=0 t=0.0384 per=12.3 cost=4.1e+05 flops=1.07e+07
 sigma_tot counter=158 i=1 t=0.0389 per=12.5 cost=4.16e+05 flops=1.07e+07
 sigma_tot counter=158 i=2 t=0.0382 per=12.2 cost=4.74e+05 flops=1.24e+07
 sigma_tot counter=158 i=3 t=0.038 per=12.2 cost=4.81e+05 flops=1.27e+07
 sigma_tot counter=158 i=4 t=0.039 per=12.5 cost=8.62e+05 flops=2.21e+07
 sigma_tot counter=158 i=5 t=0.0392 per=12.6 cost=8.65e+05 flops=2.2e+07
 sigma_tot counter=158 i=6 t=0.0405 per=13 cost=1.06e+06 flops=2.62e+07
 sigma_tot counter=158 i=7 t=0.0392 per=12.6 cost=1.05e+06 flops=2.69e+07
 total GEMM cost=5.62e+06 flops=1.81e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643 -1.003e+03  4.639e-05    2     2  5.398e-03 2.699e-03
    1   1 +      -2.436977450693 -1.002e+03  2.690e-05    2     2  5.398e-03 2.699e-03
TIMING FOR Davidson : 5.444e-03  T(cal/comm/rest)=5.344e-03,7.674e-06,9.299e-05
optimized energies: isweep=3 dots=2 ibond=3 e[0]=-2.65451696664 nmvp=2
optimized energies: isweep=3 dots=2 ibond=3 e[1]=-2.43697745069 nmvp=2
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=16 alg_decim=1 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep3_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
----- TMING FOR decimation_genbasis: 3.9e-04 S T(scatter/comp/gather)=3.7e-05,3.9e-05,3.1e-04 -----
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
 qbond: qkept nsym=6 dimAll=20
 (3,1):6 (2,0):4 (4,0):3 (2,2):3 (3,-1):2 (1,1):2
----- TIMING for decimation_row: 7.113e-04 S T(decim/formRot)=4.727e-04,2.386e-04 -----
TIMING FOR decimation: 1.093e-03 S T(wf/decim)=3.514e-04,7.414e-04
ctns::oper_renorm coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:6 A:7 B:11 P:3 Q:5 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=1612:1.230e-02MB:1.201e-05GB
rank=0 GPUmem(GB): used=2.207e-05 (oper)=1.960e-05
rank=0 GPUmem(GB): used=2.319e-05 (oper,site)(GB)=1.960e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=37 : 4.717e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 4.807e-05 S -----
rank=0 GPUmem(GB): used=2.35e-05 (oper,site,rinter)=1.96e-05,1.12e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000952 S size(rtasks)=37 size(Rlst2)=6 T(Rmu/Rlist)=0.000156,0.000795 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00104 S size(rtasks)=37 size(Rlst)=821 -----
rank=0 GPUmem(GB): used=0.000519 (oper,site,rinter,batch)=1.96e-05,1.12e-06,2.98e-07,0.000495 blksize=36 blksize0=8 batchsize=821
timing: allocate=3.42e-05 rmmtasks init=0.001 total=0.00104
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000208,0.00115,0.000194 cost=8.44e+04 flops[gemm]=7.34e+07
--- TIMING FOR renorm : t_inter=0.000207 t_gemm=0.00115 t_reduction=0.000194 tot=0.00155 ---
 renorm counter=16 i=0 t=0.000225 per=19.6 cost=3.06e+03 flops=1.36e+07
 renorm counter=16 i=1 t=0.000232 per=20.2 cost=5.92e+03 flops=2.55e+07
 renorm counter=16 i=2 t=0.000223 per=19.4 cost=9.23e+03 flops=4.14e+07
 renorm counter=16 i=3 t=0.000226 per=19.7 cost=1.58e+04 flops=7.01e+07
 renorm counter=16 i=4 t=1e-06 per=0.087 cost=0 flops=0
 renorm counter=16 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=16 i=6 t=0.000243 per=21.1 cost=5.03e+04 flops=2.07e+08
 total GEMM cost=8.44e+04 flops=7.34e+07
--- TIMING FOR renorm_tot : t_inter=0.00172 t_gemm=0.0185 t_reduction=0.00321 tot=0.0234 ---
 renorm_tot counter=16 i=0 t=0.00372 per=20.2 cost=3.33e+04 flops=8.95e+06
 renorm_tot counter=16 i=1 t=0.00364 per=19.7 cost=5.01e+04 flops=1.38e+07
 renorm_tot counter=16 i=2 t=0.00177 per=9.59 cost=3.4e+04 flops=1.92e+07
 renorm_tot counter=16 i=3 t=0.00179 per=9.7 cost=5.88e+04 flops=3.28e+07
 renorm_tot counter=16 i=4 t=0.00179 per=9.69 cost=3.56e+04 flops=1.99e+07
 renorm_tot counter=16 i=5 t=0.00182 per=9.85 cost=6.23e+04 flops=3.42e+07
 renorm_tot counter=16 i=6 t=0.00393 per=21.3 cost=4.24e+05 flops=1.08e+08
 total GEMM cost=6.98e+05 flops=3.78e+07
timing: gpu2cpu=1.61e-05 deallocate(site/work)=3.66e-06,6.51e-06 total=2.26e-05
check ||H-H.dagger||=5.772e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0048 S T(init/kernel/comm)=0.000315,0.00442,6.27e-05 rank=0 -----
TIMING FOR cleanup: 0.000213 T(erase/save/remove)=4.13e-06,0.000174,3.55e-05
##### local: 2.338e-02 S #####
 T(local: fetch) = 1.049e-03 S  per = 4.49  per(accum) = 4.49
 T(local: hdiag) = 4.923e-04 S  per = 2.11  per(accum) = 6.6
 T(local: dvdsn) = 1.499e-02 S  per = 64.1  per(accum) = 70.7
 T(local: decim) = 1.233e-03 S  per = 5.27  per(accum) = 76
 T(local: guess) = 4.226e-04 S  per = 1.81  per(accum) = 77.8
 T(local: renrm) = 4.966e-03 S  per = 21.2  per(accum) = 99
 T(local: save ) = 2.253e-04 S  per = 0.964  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.381e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 9.099e-06 S  per = 0.0659  per(accum) = 0.0659
 T(local: symbolic_formulae_twodot     ) = 6.435e-04 S  per = 4.66  per(accum) = 4.73
 T(local: hintermediate init           ) = 5.934e-05 S  per = 0.43  per(accum) = 5.16
 T(local: hintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000203  per(accum) = 5.16
 T(local: preprocess_hformulae_Hxlist2 ) = 3.750e-03 S  per = 27.2  per(accum) = 32.3
 T(local: hmmtasks init                ) = 3.900e-03 S  per = 28.2  per(accum) = 60.6
 T(local: dvdson solver [Hx_batchGPU]  ) = 5.344e-03 S  per = 38.7  per(accum) = 99.3
 T(local: dvdson solver [communication]) = 7.674e-06 S  per = 0.0556  per(accum) = 99.3
 T(local: dvdson solver [rest part]    ) = 9.299e-05 S  per = 0.674  per(accum) = 100
Detailed decomposition of T(renrm): 4.797e-03 S
 T(local: qops init                    ) = 3.151e-04 S  per = 6.57  per(accum) = 6.57
 T(local: qops_dict memcpy cpu2gpu     ) = 4.571e-05 S  per = 0.953  per(accum) = 7.52
 T(local: symbolic_formulae_renorm     ) = 4.806e-04 S  per =   10  per(accum) = 17.5
 T(local: rintermediate init           ) = 5.996e-05 S  per = 1.25  per(accum) = 18.8
 T(local: rintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 0.000605  per(accum) = 18.8
 T(local: preprocess_formulae_Rlist2   ) = 1.069e-03 S  per = 22.3  per(accum) = 41.1
 T(local: rmmtasks init                ) = 1.046e-03 S  per = 21.8  per(accum) = 62.9
 T(local: qops memset                  ) = 3.000e-08 S  per = 0.000625  per(accum) = 62.9
 T(local: preprocess_renorm_batchGPU   ) = 1.668e-03 S  per = 34.8  per(accum) = 97.6
 T(local: qops memcpy gpu2cpu          ) = 1.614e-05 S  per = 0.336  per(accum) = 98
 T(local: deallocate gpu memory        ) = 3.405e-05 S  per = 0.71  per(accum) = 98.7
 T(local: communication of opS and opH ) = 6.274e-05 S  per = 1.31  per(accum) = 100
##### sweep: 1.511e-01 S #####
 T(sweep: fetch) = 2.372e-03 S  per = 1.57  per(accum) = 1.57
 T(sweep: hdiag) = 2.111e-03 S  per =  1.4  per(accum) = 2.97
 T(sweep: dvdsn) = 1.202e-01 S  per = 79.5  per(accum) = 82.5
 T(sweep: decim) = 3.358e-03 S  per = 2.22  per(accum) = 84.7
 T(sweep: guess) = 1.857e-03 S  per = 1.23  per(accum) = 85.9
 T(sweep: renrm) = 2.009e-02 S  per = 13.3  per(accum) = 99.2
 T(sweep: save ) = 1.181e-03 S  per = 0.781  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.156e-01 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 3.398e-05 S  per = 0.0294  per(accum) = 0.0294
 T(sweep: symbolic_formulae_twodot     ) = 2.665e-03 S  per = 2.31  per(accum) = 2.33
 T(sweep: hintermediate init           ) = 2.386e-04 S  per = 0.206  per(accum) = 2.54
 T(sweep: hintermediates memcpy cpu2gpu) = 1.220e-07 S  per = 0.000106  per(accum) = 2.54
 T(sweep: preprocess_hformulae_Hxlist2 ) = 1.503e-02 S  per =   13  per(accum) = 15.5
 T(sweep: hmmtasks init                ) = 1.502e-02 S  per =   13  per(accum) = 28.5
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 8.115e-02 S  per = 70.2  per(accum) = 98.7
 T(sweep: dvdson solver [communication]) = 1.124e-04 S  per = 0.0972  per(accum) = 98.8
 T(sweep: dvdson solver [rest part]    ) = 1.361e-03 S  per = 1.18  per(accum) = 100
Detailed decomposition of T(renrm): 1.947e-02 S
 T(sweep: qops init                    ) = 1.492e-03 S  per = 7.67  per(accum) = 7.67
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.647e-04 S  per = 0.846  per(accum) = 8.51
 T(sweep: symbolic_formulae_renorm     ) = 2.144e-03 S  per =   11  per(accum) = 19.5
 T(sweep: rintermediate init           ) = 1.912e-04 S  per = 0.982  per(accum) = 20.5
 T(sweep: rintermediates memcpy cpu2gpu) = 1.150e-07 S  per = 0.000591  per(accum) = 20.5
 T(sweep: preprocess_formulae_Rlist2   ) = 4.370e-03 S  per = 22.5  per(accum) = 43
 T(sweep: rmmtasks init                ) = 4.257e-03 S  per = 21.9  per(accum) = 64.8
 T(sweep: qops memset                  ) = 1.180e-07 S  per = 0.000606  per(accum) = 64.8
 T(sweep: preprocess_renorm_batchGPU   ) = 6.377e-03 S  per = 32.8  per(accum) = 97.6
 T(sweep: qops memcpy gpu2cpu          ) = 6.226e-05 S  per = 0.32  per(accum) = 97.9
 T(sweep: deallocate gpu memory        ) = 1.458e-04 S  per = 0.749  per(accum) = 98.7
 T(sweep: communication of opS and opH ) = 2.605e-04 S  per = 1.34  per(accum) = 100
##### global: 6.747e-01 S #####
 T(global: fetch) = 1.129e-02 S  per = 1.67  per(accum) = 1.67
 T(global: hdiag) = 8.808e-03 S  per = 1.31  per(accum) = 2.98
 T(global: dvdsn) = 5.523e-01 S  per = 81.9  per(accum) = 84.8
 T(global: decim) = 1.426e-02 S  per = 2.11  per(accum) = 86.9
 T(global: guess) = 6.888e-03 S  per = 1.02  per(accum) = 88
 T(global: renrm) = 7.653e-02 S  per = 11.3  per(accum) = 99.3
 T(global: save ) = 4.634e-03 S  per = 0.687  per(accum) = 100
Detailed decomposition of T(dvdsn): 5.354e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 1.709e-04 S  per = 0.0319  per(accum) = 0.0319
 T(global: symbolic_formulae_twodot     ) = 1.061e-02 S  per = 1.98  per(accum) = 2.01
 T(global: hintermediate init           ) = 9.379e-04 S  per = 0.175  per(accum) = 2.19
 T(global: hintermediates memcpy cpu2gpu) = 4.710e-07 S  per = 8.8e-05  per(accum) = 2.19
 T(global: preprocess_hformulae_Hxlist2 ) = 5.602e-02 S  per = 10.5  per(accum) = 12.7
 T(global: hmmtasks init                ) = 5.535e-02 S  per = 10.3  per(accum) = 23
 T(global: dvdson solver [Hx_batchGPU]  ) = 4.051e-01 S  per = 75.7  per(accum) = 98.6
 T(global: dvdson solver [communication]) = 5.605e-04 S  per = 0.105  per(accum) = 98.7
 T(global: dvdson solver [rest part]    ) = 6.699e-03 S  per = 1.25  per(accum) = 100
Detailed decomposition of T(renrm): 7.417e-02 S
 T(global: qops init                    ) = 5.609e-03 S  per = 7.56  per(accum) = 7.56
 T(global: qops_dict memcpy cpu2gpu     ) = 6.755e-04 S  per = 0.911  per(accum) = 8.47
 T(global: symbolic_formulae_renorm     ) = 8.600e-03 S  per = 11.6  per(accum) = 20.1
 T(global: rintermediate init           ) = 7.477e-04 S  per = 1.01  per(accum) = 21.1
 T(global: rintermediates memcpy cpu2gpu) = 4.550e-07 S  per = 0.000613  per(accum) = 21.1
 T(global: preprocess_formulae_Rlist2   ) = 1.606e-02 S  per = 21.6  per(accum) = 42.7
 T(global: rmmtasks init                ) = 1.533e-02 S  per = 20.7  per(accum) = 63.4
 T(global: qops memset                  ) = 4.490e-07 S  per = 0.000605  per(accum) = 63.4
 T(global: preprocess_renorm_batchGPU   ) = 2.530e-02 S  per = 34.1  per(accum) = 97.5
 T(global: qops memcpy gpu2cpu          ) = 2.471e-04 S  per = 0.333  per(accum) = 97.8
 T(global: deallocate gpu memory        ) = 5.949e-04 S  per = 0.802  per(accum) = 98.6
 T(global: communication of opS and opH ) = 1.016e-03 S  per = 1.37  per(accum) = 100

======================================================================
sweep_data::summary isweep=3
----------------------------------------------------------------------
sweep parameters: isweep=3 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.0517
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.023
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.0531
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.0234
 eav_max=-2.54574720706 [ibond=0]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=2]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=1.60475011057e-09
 sweep energies: isweep=3 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[0]=-2.65451696664
 sweep energies: isweep=3 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=3
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.000e-04 1.000e-04 | 51 | 1.940e-01 | 1.940e-01 | 1.116e-02 1.028e-01 1.083e-02 1.248e-01 64.4
            1  2      20 1.000e-04 0.000e+00 | 45 | 1.842e-01 | 3.782e-01 | 2.111e-02 1.958e-01 2.052e-02 2.375e-01 62.8
            2  2      20 1.000e-04 0.000e+00 | 31 | 1.533e-01 | 5.315e-01 | 2.821e-02 2.628e-01 2.744e-02 3.185e-01 59.9
            3  2      20 1.000e-04 0.000e+00 | 31 | 1.538e-01 | 6.852e-01 | 3.531e-02 3.299e-01 3.437e-02 3.996e-01 58.3
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.505e-03 e[0]=-2.65208108952 (2.436e-03) e[1]=-2.43068987874 (6.288e-03)
            1      20 +0.000e+00 e[0]=-2.65451696664 (4.015e-12) e[1]=-2.43697745069 (-2.660e-13)
            2      20 +5.258e-04 e[0]=-2.65451696664 (3.997e-15) e[1]=-2.43697745069 (1.332e-15)
            3      20 +0.000e+00 e[0]=-2.65451696664 (0.000e+00) e[1]=-2.43697745069 (0.000e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep3.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row_nkr dcut=8 nqr=12 alg_decim=0 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep3_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
----- TMING FOR decimation_genbasis: 5.356e-05 S T(scatter/comp/gather)=6.208e-06,4.331e-05,4.037e-06 -----
decimation summary: 80->8 dwt=-2.220e-16 SvN=1.326e+00
 qbond: qkept nsym=4 dimAll=8
 (3,1):2 (4,0):2 (5,1):2 (4,2):2
----- TIMING for decimation_row: 3.247e-04 S T(decim/formRot)=1.196e-04,2.050e-04 -----

Convert [C]RRR => [cR]RRR:
ctns::decimation_row_nkr dcut=2 nqr=9 alg_decim=0 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep3_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
----- TMING FOR decimation_genbasis: 2.750e-05 S T(scatter/comp/gather)=4.353e-06,2.113e-05,2.013e-06 -----
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00
 qbond: qkept nsym=1 dimAll=2
 (5,1):2
----- TIMING for decimation_row: 2.228e-04 S T(decim/formRot)=8.360e-05,1.392e-04 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep3.info

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.000e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.000e+00
 idx=2 node=(2,0) Drow=20 maxdiff=1.757e-15
 idx=3 node=(1,0) Drow=8 maxdiff=9.421e-16
 idx=4 node=(0,0) Drow=2 maxdiff=3.349e-16
stensor2: wf2 own=1 _data=0x44af6ff0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.052e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x44af6ff0
     -1.0000e+00      -2.2704e-17 
     -9.4415e-17       1.0000e+00 
 rwfuns: nroots=2 maxdiff=4.5552e-16
----- TIMING FOR ctns::rcanon_check : 1.982e-04 S -----
..... end of isweep = 3 .....

======================================================================
sweep parameters: isweep=4 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB

isweep=4 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=872:0.00665MB:6.5e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1310:0.00999MB:9.76e-06GB
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44e208f0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
### DIAG TIMING: total=0.000404 t1=1.65e-05, t2=2.06e-05, t3=5.52e-05, t4=0.00019, t5=7.55e-05, t6=2.9e-05, t7=1.39e-05, t8=2.89e-06
duration_diagGPU:0.000419
duration_diagreduce:4.25e-06
duration_diagtransform:1.89e-06
rank=0 GPUmem(GB): used=2.18e-05 (oper)=9.76e-06
----- TIMING FOR symbolic_formulae_twodot with size=93 : 6.957e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=93
 no. of hintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.560e-05 S -----
rank=0 GPUmem(GB): used=2.21e-05 (oper,hinter)=9.76e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00361 S size(H_formulae)=93 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000198,0.00341 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00387 S size(H_formulae)=93 size(Hxlst)=3134 -----
rank=0 GPUmem(GB): used=0.000421 (oper,hinter,dvdson,batch)=9.76e-06,2.98e-07,1.49e-06,0.000397 blksize=4 blksize0=8 batchsize=3134
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000224,0.00206,0.000197 cost=4.22e+04 flops[gemm]=2.05e+07
--- TIMING FOR sigma : t_inter=0.000224 t_gemm=0.00206 t_reduction=0.000196 tot=0.00248 ---
 sigma counter=159 i=0 t=0.000265 per=12.9 cost=3.72e+03 flops=1.4e+07
 sigma counter=159 i=1 t=0.000255 per=12.4 cost=3.74e+03 flops=1.47e+07
 sigma counter=159 i=2 t=0.000248 per=12.1 cost=3.04e+03 flops=1.22e+07
 sigma counter=159 i=3 t=0.000244 per=11.9 cost=3.03e+03 flops=1.24e+07
 sigma counter=159 i=4 t=0.00026 per=12.6 cost=1e+04 flops=3.85e+07
 sigma counter=159 i=5 t=0.00026 per=12.6 cost=1e+04 flops=3.85e+07
 sigma counter=159 i=6 t=0.000272 per=13.2 cost=4.34e+03 flops=1.59e+07
 sigma counter=159 i=7 t=0.000252 per=12.3 cost=4.32e+03 flops=1.71e+07
 total GEMM cost=4.22e+04 flops=2.05e+07
--- TIMING FOR sigma_tot : t_inter=0.0338 t_gemm=0.314 t_reduction=0.0314 tot=0.379 ---
 sigma_tot counter=159 i=0 t=0.0387 per=12.3 cost=4.14e+05 flops=1.07e+07
 sigma_tot counter=159 i=1 t=0.0392 per=12.5 cost=4.2e+05 flops=1.07e+07
 sigma_tot counter=159 i=2 t=0.0384 per=12.2 cost=4.77e+05 flops=1.24e+07
 sigma_tot counter=159 i=3 t=0.0382 per=12.2 cost=4.84e+05 flops=1.27e+07
 sigma_tot counter=159 i=4 t=0.0393 per=12.5 cost=8.72e+05 flops=2.22e+07
 sigma_tot counter=159 i=5 t=0.0395 per=12.6 cost=8.75e+05 flops=2.21e+07
 sigma_tot counter=159 i=6 t=0.0408 per=13 cost=1.06e+06 flops=2.61e+07
 sigma_tot counter=159 i=7 t=0.0395 per=12.6 cost=1.06e+06 flops=2.68e+07
 total GEMM cost=5.66e+06 flops=1.81e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000211,0.00201,0.000195 cost=4.22e+04 flops[gemm]=2.1e+07
--- TIMING FOR sigma : t_inter=0.000211 t_gemm=0.00201 t_reduction=0.000195 tot=0.00241 ---
 sigma counter=160 i=0 t=0.000252 per=12.5 cost=3.72e+03 flops=1.47e+07
 sigma counter=160 i=1 t=0.000257 per=12.8 cost=3.74e+03 flops=1.45e+07
 sigma counter=160 i=2 t=0.000238 per=11.9 cost=3.04e+03 flops=1.28e+07
 sigma counter=160 i=3 t=0.000238 per=11.9 cost=3.03e+03 flops=1.27e+07
 sigma counter=160 i=4 t=0.000254 per=12.6 cost=1e+04 flops=3.94e+07
 sigma counter=160 i=5 t=0.000255 per=12.7 cost=1e+04 flops=3.92e+07
 sigma counter=160 i=6 t=0.000263 per=13.1 cost=4.34e+03 flops=1.65e+07
 sigma counter=160 i=7 t=0.000251 per=12.5 cost=4.32e+03 flops=1.72e+07
 total GEMM cost=4.22e+04 flops=2.1e+07
--- TIMING FOR sigma_tot : t_inter=0.034 t_gemm=0.316 t_reduction=0.0315 tot=0.381 ---
 sigma_tot counter=160 i=0 t=0.039 per=12.3 cost=4.18e+05 flops=1.07e+07
 sigma_tot counter=160 i=1 t=0.0394 per=12.5 cost=4.24e+05 flops=1.08e+07
 sigma_tot counter=160 i=2 t=0.0386 per=12.2 cost=4.8e+05 flops=1.24e+07
 sigma_tot counter=160 i=3 t=0.0385 per=12.2 cost=4.87e+05 flops=1.27e+07
 sigma_tot counter=160 i=4 t=0.0395 per=12.5 cost=8.82e+05 flops=2.23e+07
 sigma_tot counter=160 i=5 t=0.0398 per=12.6 cost=8.85e+05 flops=2.22e+07
 sigma_tot counter=160 i=6 t=0.041 per=13 cost=1.07e+06 flops=2.6e+07
 sigma_tot counter=160 i=7 t=0.0397 per=12.6 cost=1.06e+06 flops=2.68e+07
 total GEMM cost=5.71e+06 flops=1.81e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891 -1.003e+03  6.876e-02    2     2  5.381e-03 2.690e-03
    1   1 -      -2.436233901339 -1.002e+03  4.380e-02    2     2  5.381e-03 2.690e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.260e-04,2.016e-03,1.980e-04 cost=4.217e+04 flops[gemm]=2.092e+07
--- TIMING FOR sigma : t_inter=2.260e-04 t_gemm=2.016e-03 t_reduction=1.980e-04 tot=2.440e-03 ---
 sigma counter=161 i=0 t=2.520e-04 per=1.250e+01 cost=3.716e+03 flops=1.475e+07
 sigma counter=161 i=1 t=2.610e-04 per=1.295e+01 cost=3.736e+03 flops=1.431e+07
 sigma counter=161 i=2 t=2.360e-04 per=1.171e+01 cost=3.036e+03 flops=1.286e+07
 sigma counter=161 i=3 t=2.420e-04 per=1.200e+01 cost=3.026e+03 flops=1.250e+07
 sigma counter=161 i=4 t=2.530e-04 per=1.255e+01 cost=1.000e+04 flops=3.953e+07
 sigma counter=161 i=5 t=2.570e-04 per=1.275e+01 cost=1.000e+04 flops=3.891e+07
 sigma counter=161 i=6 t=2.600e-04 per=1.290e+01 cost=4.336e+03 flops=1.668e+07
 sigma counter=161 i=7 t=2.550e-04 per=1.265e+01 cost=4.316e+03 flops=1.693e+07
 total GEMM cost=4.217e+04 flops=2.092e+07
--- TIMING FOR sigma_tot : t_inter=3.426e-02 t_gemm=3.175e-01 t_reduction=3.175e-02 tot=3.835e-01 ---
 sigma_tot counter=161 i=0 t=3.920e-02 per=1.235e+01 cost=4.214e+05 flops=1.075e+07
 sigma_tot counter=161 i=1 t=3.968e-02 per=1.249e+01 cost=4.276e+05 flops=1.078e+07
 sigma_tot counter=161 i=2 t=3.887e-02 per=1.224e+01 cost=4.828e+05 flops=1.242e+07
 sigma_tot counter=161 i=3 t=3.873e-02 per=1.220e+01 cost=4.900e+05 flops=1.265e+07
 sigma_tot counter=161 i=4 t=3.978e-02 per=1.253e+01 cost=8.921e+05 flops=2.243e+07
 sigma_tot counter=161 i=5 t=4.001e-02 per=1.260e+01 cost=8.945e+05 flops=2.236e+07
 sigma_tot counter=161 i=6 t=4.129e-02 per=1.300e+01 cost=1.073e+06 flops=2.599e+07
 sigma_tot counter=161 i=7 t=3.997e-02 per=1.259e+01 cost=1.068e+06 flops=2.671e+07
 total GEMM cost=5.749e+06 flops=1.811e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.130e-04,2.010e-03,1.990e-04 cost=4.217e+04 flops[gemm]=2.098e+07
--- TIMING FOR sigma : t_inter=2.120e-04 t_gemm=2.010e-03 t_reduction=1.990e-04 tot=2.421e-03 ---
 sigma counter=162 i=0 t=2.550e-04 per=1.269e+01 cost=3.716e+03 flops=1.457e+07
 sigma counter=162 i=1 t=2.520e-04 per=1.254e+01 cost=3.736e+03 flops=1.483e+07
 sigma counter=162 i=2 t=2.370e-04 per=1.179e+01 cost=3.036e+03 flops=1.281e+07
 sigma counter=162 i=3 t=2.380e-04 per=1.184e+01 cost=3.026e+03 flops=1.271e+07
 sigma counter=162 i=4 t=2.580e-04 per=1.284e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=162 i=5 t=2.580e-04 per=1.284e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=162 i=6 t=2.610e-04 per=1.299e+01 cost=4.336e+03 flops=1.661e+07
 sigma counter=162 i=7 t=2.510e-04 per=1.249e+01 cost=4.316e+03 flops=1.720e+07
 total GEMM cost=4.217e+04 flops=2.098e+07
--- TIMING FOR sigma_tot : t_inter=3.447e-02 t_gemm=3.195e-01 t_reduction=3.195e-02 tot=3.860e-01 ---
 sigma_tot counter=162 i=0 t=3.946e-02 per=1.235e+01 cost=4.251e+05 flops=1.077e+07
 sigma_tot counter=162 i=1 t=3.993e-02 per=1.250e+01 cost=4.314e+05 flops=1.080e+07
 sigma_tot counter=162 i=2 t=3.911e-02 per=1.224e+01 cost=4.858e+05 flops=1.242e+07
 sigma_tot counter=162 i=3 t=3.896e-02 per=1.219e+01 cost=4.931e+05 flops=1.265e+07
 sigma_tot counter=162 i=4 t=4.004e-02 per=1.253e+01 cost=9.021e+05 flops=2.253e+07
 sigma_tot counter=162 i=5 t=4.027e-02 per=1.260e+01 cost=9.045e+05 flops=2.246e+07
 sigma_tot counter=162 i=6 t=4.155e-02 per=1.300e+01 cost=1.077e+06 flops=2.593e+07
 sigma_tot counter=162 i=7 t=4.022e-02 per=1.259e+01 cost=1.072e+06 flops=2.665e+07
 total GEMM cost=5.791e+06 flops=1.812e+07
    2   0 -      -2.654428675110 -1.727e-03  1.261e-02    4     4  1.069e-02 2.672e-03
    2   1 -      -2.436964455587 -7.306e-04  4.223e-03    4     4  1.069e-02 2.672e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.180e-04,2.021e-03,1.960e-04 cost=4.217e+04 flops[gemm]=2.086e+07
--- TIMING FOR sigma : t_inter=2.170e-04 t_gemm=2.021e-03 t_reduction=1.960e-04 tot=2.434e-03 ---
 sigma counter=163 i=0 t=2.560e-04 per=1.267e+01 cost=3.716e+03 flops=1.452e+07
 sigma counter=163 i=1 t=2.620e-04 per=1.296e+01 cost=3.736e+03 flops=1.426e+07
 sigma counter=163 i=2 t=2.410e-04 per=1.192e+01 cost=3.036e+03 flops=1.260e+07
 sigma counter=163 i=3 t=2.360e-04 per=1.168e+01 cost=3.026e+03 flops=1.282e+07
 sigma counter=163 i=4 t=2.530e-04 per=1.252e+01 cost=1.000e+04 flops=3.953e+07
 sigma counter=163 i=5 t=2.610e-04 per=1.291e+01 cost=1.000e+04 flops=3.831e+07
 sigma counter=163 i=6 t=2.610e-04 per=1.291e+01 cost=4.336e+03 flops=1.661e+07
 sigma counter=163 i=7 t=2.510e-04 per=1.242e+01 cost=4.316e+03 flops=1.720e+07
 total GEMM cost=4.217e+04 flops=2.086e+07
--- TIMING FOR sigma_tot : t_inter=3.469e-02 t_gemm=3.216e-01 t_reduction=3.214e-02 tot=3.884e-01 ---
 sigma_tot counter=163 i=0 t=3.972e-02 per=1.235e+01 cost=4.288e+05 flops=1.080e+07
 sigma_tot counter=163 i=1 t=4.019e-02 per=1.250e+01 cost=4.351e+05 flops=1.083e+07
 sigma_tot counter=163 i=2 t=3.935e-02 per=1.224e+01 cost=4.889e+05 flops=1.242e+07
 sigma_tot counter=163 i=3 t=3.920e-02 per=1.219e+01 cost=4.961e+05 flops=1.266e+07
 sigma_tot counter=163 i=4 t=4.029e-02 per=1.253e+01 cost=9.121e+05 flops=2.264e+07
 sigma_tot counter=163 i=5 t=4.053e-02 per=1.260e+01 cost=9.145e+05 flops=2.256e+07
 sigma_tot counter=163 i=6 t=4.181e-02 per=1.300e+01 cost=1.082e+06 flops=2.587e+07
 sigma_tot counter=163 i=7 t=4.047e-02 per=1.259e+01 cost=1.076e+06 flops=2.659e+07
 total GEMM cost=5.834e+06 flops=1.814e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.300e-05,2.110e-04,2.023e-03,1.970e-04 cost=4.217e+04 flops[gemm]=2.084e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=2.021e-03 t_reduction=1.960e-04 tot=2.427e-03 ---
 sigma counter=164 i=0 t=2.530e-04 per=1.252e+01 cost=3.716e+03 flops=1.469e+07
 sigma counter=164 i=1 t=2.590e-04 per=1.282e+01 cost=3.736e+03 flops=1.442e+07
 sigma counter=164 i=2 t=2.380e-04 per=1.178e+01 cost=3.036e+03 flops=1.276e+07
 sigma counter=164 i=3 t=2.390e-04 per=1.183e+01 cost=3.026e+03 flops=1.266e+07
 sigma counter=164 i=4 t=2.650e-04 per=1.311e+01 cost=1.000e+04 flops=3.774e+07
 sigma counter=164 i=5 t=2.550e-04 per=1.262e+01 cost=1.000e+04 flops=3.922e+07
 sigma counter=164 i=6 t=2.610e-04 per=1.291e+01 cost=4.336e+03 flops=1.661e+07
 sigma counter=164 i=7 t=2.510e-04 per=1.242e+01 cost=4.316e+03 flops=1.720e+07
 total GEMM cost=4.217e+04 flops=2.086e+07
--- TIMING FOR sigma_tot : t_inter=3.490e-02 t_gemm=3.236e-01 t_reduction=3.234e-02 tot=3.908e-01 ---
 sigma_tot counter=164 i=0 t=3.997e-02 per=1.235e+01 cost=4.325e+05 flops=1.082e+07
 sigma_tot counter=164 i=1 t=4.045e-02 per=1.250e+01 cost=4.388e+05 flops=1.085e+07
 sigma_tot counter=164 i=2 t=3.959e-02 per=1.223e+01 cost=4.919e+05 flops=1.243e+07
 sigma_tot counter=164 i=3 t=3.944e-02 per=1.219e+01 cost=4.991e+05 flops=1.266e+07
 sigma_tot counter=164 i=4 t=4.056e-02 per=1.253e+01 cost=9.221e+05 flops=2.274e+07
 sigma_tot counter=164 i=5 t=4.079e-02 per=1.260e+01 cost=9.245e+05 flops=2.267e+07
 sigma_tot counter=164 i=6 t=4.207e-02 per=1.300e+01 cost=1.086e+06 flops=2.582e+07
 sigma_tot counter=164 i=7 t=4.072e-02 per=1.259e+01 cost=1.081e+06 flops=2.654e+07
 total GEMM cost=5.876e+06 flops=1.816e+07
    3   0 -      -2.654509664652 -8.099e-05  3.660e-03    6     6  1.597e-02 2.662e-03
    3   1 -      -2.436976459250 -1.200e-05  1.113e-03    6     6  1.597e-02 2.662e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.190e-04,2.047e-03,2.000e-04 cost=4.217e+04 flops[gemm]=2.060e+07
--- TIMING FOR sigma : t_inter=2.190e-04 t_gemm=2.046e-03 t_reduction=2.000e-04 tot=2.465e-03 ---
 sigma counter=165 i=0 t=2.600e-04 per=1.271e+01 cost=3.716e+03 flops=1.429e+07
 sigma counter=165 i=1 t=2.630e-04 per=1.285e+01 cost=3.736e+03 flops=1.421e+07
 sigma counter=165 i=2 t=2.440e-04 per=1.193e+01 cost=3.036e+03 flops=1.244e+07
 sigma counter=165 i=3 t=2.460e-04 per=1.202e+01 cost=3.026e+03 flops=1.230e+07
 sigma counter=165 i=4 t=2.620e-04 per=1.281e+01 cost=1.000e+04 flops=3.817e+07
 sigma counter=165 i=5 t=2.580e-04 per=1.261e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=165 i=6 t=2.610e-04 per=1.276e+01 cost=4.336e+03 flops=1.661e+07
 sigma counter=165 i=7 t=2.520e-04 per=1.232e+01 cost=4.316e+03 flops=1.713e+07
 total GEMM cost=4.217e+04 flops=2.061e+07
--- TIMING FOR sigma_tot : t_inter=3.512e-02 t_gemm=3.256e-01 t_reduction=3.254e-02 tot=3.933e-01 ---
 sigma_tot counter=165 i=0 t=4.023e-02 per=1.235e+01 cost=4.362e+05 flops=1.084e+07
 sigma_tot counter=165 i=1 t=4.071e-02 per=1.250e+01 cost=4.426e+05 flops=1.087e+07
 sigma_tot counter=165 i=2 t=3.983e-02 per=1.223e+01 cost=4.949e+05 flops=1.243e+07
 sigma_tot counter=165 i=3 t=3.968e-02 per=1.219e+01 cost=5.022e+05 flops=1.265e+07
 sigma_tot counter=165 i=4 t=4.082e-02 per=1.253e+01 cost=9.321e+05 flops=2.284e+07
 sigma_tot counter=165 i=5 t=4.105e-02 per=1.260e+01 cost=9.345e+05 flops=2.277e+07
 sigma_tot counter=165 i=6 t=4.233e-02 per=1.300e+01 cost=1.090e+06 flops=2.576e+07
 sigma_tot counter=165 i=7 t=4.098e-02 per=1.258e+01 cost=1.085e+06 flops=2.648e+07
 total GEMM cost=5.918e+06 flops=1.817e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.090e-04,2.033e-03,1.960e-04 cost=4.217e+04 flops[gemm]=2.074e+07
--- TIMING FOR sigma : t_inter=2.090e-04 t_gemm=2.030e-03 t_reduction=1.960e-04 tot=2.435e-03 ---
 sigma counter=166 i=0 t=2.520e-04 per=1.241e+01 cost=3.716e+03 flops=1.475e+07
 sigma counter=166 i=1 t=2.510e-04 per=1.236e+01 cost=3.736e+03 flops=1.488e+07
 sigma counter=166 i=2 t=2.410e-04 per=1.187e+01 cost=3.036e+03 flops=1.260e+07
 sigma counter=166 i=3 t=2.430e-04 per=1.197e+01 cost=3.026e+03 flops=1.245e+07
 sigma counter=166 i=4 t=2.560e-04 per=1.261e+01 cost=1.000e+04 flops=3.906e+07
 sigma counter=166 i=5 t=2.580e-04 per=1.271e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=166 i=6 t=2.700e-04 per=1.330e+01 cost=4.336e+03 flops=1.606e+07
 sigma counter=166 i=7 t=2.590e-04 per=1.276e+01 cost=4.316e+03 flops=1.666e+07
 total GEMM cost=4.217e+04 flops=2.077e+07
--- TIMING FOR sigma_tot : t_inter=3.533e-02 t_gemm=3.277e-01 t_reduction=3.273e-02 tot=3.957e-01 ---
 sigma_tot counter=166 i=0 t=4.048e-02 per=1.235e+01 cost=4.399e+05 flops=1.087e+07
 sigma_tot counter=166 i=1 t=4.096e-02 per=1.250e+01 cost=4.463e+05 flops=1.090e+07
 sigma_tot counter=166 i=2 t=4.008e-02 per=1.223e+01 cost=4.980e+05 flops=1.243e+07
 sigma_tot counter=166 i=3 t=3.993e-02 per=1.219e+01 cost=5.052e+05 flops=1.265e+07
 sigma_tot counter=166 i=4 t=4.107e-02 per=1.254e+01 cost=9.421e+05 flops=2.294e+07
 sigma_tot counter=166 i=5 t=4.130e-02 per=1.261e+01 cost=9.445e+05 flops=2.287e+07
 sigma_tot counter=166 i=6 t=4.260e-02 per=1.300e+01 cost=1.095e+06 flops=2.570e+07
 sigma_tot counter=166 i=7 t=4.124e-02 per=1.259e+01 cost=1.089e+06 flops=2.642e+07
 total GEMM cost=5.960e+06 flops=1.819e+07
    4   0 -      -2.654516020764 -6.356e-06  1.139e-03    6     8  2.131e-02 2.664e-03
    4   1 -      -2.436977285934 -8.267e-07  4.032e-04    6     8  2.131e-02 2.664e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.270e-04,2.040e-03,1.960e-04 cost=4.217e+04 flops[gemm]=2.067e+07
--- TIMING FOR sigma : t_inter=2.270e-04 t_gemm=2.040e-03 t_reduction=1.960e-04 tot=2.463e-03 ---
 sigma counter=167 i=0 t=2.600e-04 per=1.275e+01 cost=3.716e+03 flops=1.429e+07
 sigma counter=167 i=1 t=2.640e-04 per=1.294e+01 cost=3.736e+03 flops=1.415e+07
 sigma counter=167 i=2 t=2.460e-04 per=1.206e+01 cost=3.036e+03 flops=1.234e+07
 sigma counter=167 i=3 t=2.470e-04 per=1.211e+01 cost=3.026e+03 flops=1.225e+07
 sigma counter=167 i=4 t=2.560e-04 per=1.255e+01 cost=1.000e+04 flops=3.906e+07
 sigma counter=167 i=5 t=2.580e-04 per=1.265e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=167 i=6 t=2.590e-04 per=1.270e+01 cost=4.336e+03 flops=1.674e+07
 sigma counter=167 i=7 t=2.500e-04 per=1.225e+01 cost=4.316e+03 flops=1.726e+07
 total GEMM cost=4.217e+04 flops=2.067e+07
--- TIMING FOR sigma_tot : t_inter=3.555e-02 t_gemm=3.297e-01 t_reduction=3.293e-02 tot=3.982e-01 ---
 sigma_tot counter=167 i=0 t=4.074e-02 per=1.236e+01 cost=4.437e+05 flops=1.089e+07
 sigma_tot counter=167 i=1 t=4.123e-02 per=1.250e+01 cost=4.501e+05 flops=1.092e+07
 sigma_tot counter=167 i=2 t=4.032e-02 per=1.223e+01 cost=5.010e+05 flops=1.243e+07
 sigma_tot counter=167 i=3 t=4.017e-02 per=1.219e+01 cost=5.082e+05 flops=1.265e+07
 sigma_tot counter=167 i=4 t=4.133e-02 per=1.254e+01 cost=9.521e+05 flops=2.304e+07
 sigma_tot counter=167 i=5 t=4.156e-02 per=1.261e+01 cost=9.545e+05 flops=2.297e+07
 sigma_tot counter=167 i=6 t=4.286e-02 per=1.300e+01 cost=1.099e+06 flops=2.564e+07
 sigma_tot counter=167 i=7 t=4.149e-02 per=1.258e+01 cost=1.094e+06 flops=2.636e+07
 total GEMM cost=6.002e+06 flops=1.821e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.000e-05,2.090e-04,2.012e-03,1.970e-04 cost=4.217e+04 flops[gemm]=2.096e+07
--- TIMING FOR sigma : t_inter=2.090e-04 t_gemm=2.011e-03 t_reduction=1.970e-04 tot=2.417e-03 ---
 sigma counter=168 i=0 t=2.540e-04 per=1.263e+01 cost=3.716e+03 flops=1.463e+07
 sigma counter=168 i=1 t=2.570e-04 per=1.278e+01 cost=3.736e+03 flops=1.454e+07
 sigma counter=168 i=2 t=2.380e-04 per=1.183e+01 cost=3.036e+03 flops=1.276e+07
 sigma counter=168 i=3 t=2.390e-04 per=1.188e+01 cost=3.026e+03 flops=1.266e+07
 sigma counter=168 i=4 t=2.570e-04 per=1.278e+01 cost=1.000e+04 flops=3.891e+07
 sigma counter=168 i=5 t=2.570e-04 per=1.278e+01 cost=1.000e+04 flops=3.891e+07
 sigma counter=168 i=6 t=2.590e-04 per=1.288e+01 cost=4.336e+03 flops=1.674e+07
 sigma counter=168 i=7 t=2.500e-04 per=1.243e+01 cost=4.316e+03 flops=1.726e+07
 total GEMM cost=4.217e+04 flops=2.097e+07
--- TIMING FOR sigma_tot : t_inter=3.576e-02 t_gemm=3.317e-01 t_reduction=3.313e-02 tot=4.006e-01 ---
 sigma_tot counter=168 i=0 t=4.099e-02 per=1.236e+01 cost=4.474e+05 flops=1.091e+07
 sigma_tot counter=168 i=1 t=4.148e-02 per=1.251e+01 cost=4.538e+05 flops=1.094e+07
 sigma_tot counter=168 i=2 t=4.056e-02 per=1.223e+01 cost=5.041e+05 flops=1.243e+07
 sigma_tot counter=168 i=3 t=4.041e-02 per=1.218e+01 cost=5.112e+05 flops=1.265e+07
 sigma_tot counter=168 i=4 t=4.159e-02 per=1.254e+01 cost=9.621e+05 flops=2.314e+07
 sigma_tot counter=168 i=5 t=4.182e-02 per=1.261e+01 cost=9.645e+05 flops=2.307e+07
 sigma_tot counter=168 i=6 t=4.312e-02 per=1.300e+01 cost=1.103e+06 flops=2.559e+07
 sigma_tot counter=168 i=7 t=4.174e-02 per=1.258e+01 cost=1.098e+06 flops=2.631e+07
 total GEMM cost=6.044e+06 flops=1.822e+07
    5   0 -      -2.654516818921 -7.982e-07  4.446e-04    6    10  2.663e-02 2.663e-03
    5   1 -      -2.436977409925 -1.240e-07  2.046e-04    6    10  2.663e-02 2.663e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.170e-04,2.035e-03,1.950e-04 cost=4.217e+04 flops[gemm]=2.072e+07
--- TIMING FOR sigma : t_inter=2.170e-04 t_gemm=2.034e-03 t_reduction=1.950e-04 tot=2.446e-03 ---
 sigma counter=169 i=0 t=2.550e-04 per=1.254e+01 cost=3.716e+03 flops=1.457e+07
 sigma counter=169 i=1 t=2.540e-04 per=1.249e+01 cost=3.736e+03 flops=1.471e+07
 sigma counter=169 i=2 t=2.450e-04 per=1.205e+01 cost=3.036e+03 flops=1.239e+07
 sigma counter=169 i=3 t=2.420e-04 per=1.190e+01 cost=3.026e+03 flops=1.250e+07
 sigma counter=169 i=4 t=2.580e-04 per=1.268e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=169 i=5 t=2.630e-04 per=1.293e+01 cost=1.000e+04 flops=3.802e+07
 sigma counter=169 i=6 t=2.660e-04 per=1.308e+01 cost=4.336e+03 flops=1.630e+07
 sigma counter=169 i=7 t=2.510e-04 per=1.234e+01 cost=4.316e+03 flops=1.720e+07
 total GEMM cost=4.217e+04 flops=2.073e+07
--- TIMING FOR sigma_tot : t_inter=3.598e-02 t_gemm=3.337e-01 t_reduction=3.332e-02 tot=4.030e-01 ---
 sigma_tot counter=169 i=0 t=4.125e-02 per=1.236e+01 cost=4.511e+05 flops=1.094e+07
 sigma_tot counter=169 i=1 t=4.174e-02 per=1.251e+01 cost=4.575e+05 flops=1.096e+07
 sigma_tot counter=169 i=2 t=4.080e-02 per=1.223e+01 cost=5.071e+05 flops=1.243e+07
 sigma_tot counter=169 i=3 t=4.066e-02 per=1.218e+01 cost=5.143e+05 flops=1.265e+07
 sigma_tot counter=169 i=4 t=4.184e-02 per=1.254e+01 cost=9.721e+05 flops=2.323e+07
 sigma_tot counter=169 i=5 t=4.208e-02 per=1.261e+01 cost=9.745e+05 flops=2.316e+07
 sigma_tot counter=169 i=6 t=4.338e-02 per=1.300e+01 cost=1.108e+06 flops=2.553e+07
 sigma_tot counter=169 i=7 t=4.199e-02 per=1.258e+01 cost=1.102e+06 flops=2.625e+07
 total GEMM cost=6.087e+06 flops=1.824e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.100e-04,2.006e-03,1.970e-04 cost=4.217e+04 flops[gemm]=2.102e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=2.003e-03 t_reduction=1.960e-04 tot=2.409e-03 ---
 sigma counter=170 i=0 t=2.530e-04 per=1.263e+01 cost=3.716e+03 flops=1.469e+07
 sigma counter=170 i=1 t=2.570e-04 per=1.283e+01 cost=3.736e+03 flops=1.454e+07
 sigma counter=170 i=2 t=2.380e-04 per=1.188e+01 cost=3.036e+03 flops=1.276e+07
 sigma counter=170 i=3 t=2.410e-04 per=1.203e+01 cost=3.026e+03 flops=1.256e+07
 sigma counter=170 i=4 t=2.530e-04 per=1.263e+01 cost=1.000e+04 flops=3.953e+07
 sigma counter=170 i=5 t=2.540e-04 per=1.268e+01 cost=1.000e+04 flops=3.937e+07
 sigma counter=170 i=6 t=2.570e-04 per=1.283e+01 cost=4.336e+03 flops=1.687e+07
 sigma counter=170 i=7 t=2.500e-04 per=1.248e+01 cost=4.316e+03 flops=1.726e+07
 total GEMM cost=4.217e+04 flops=2.105e+07
--- TIMING FOR sigma_tot : t_inter=3.619e-02 t_gemm=3.357e-01 t_reduction=3.352e-02 tot=4.055e-01 ---
 sigma_tot counter=170 i=0 t=4.150e-02 per=1.236e+01 cost=4.548e+05 flops=1.096e+07
 sigma_tot counter=170 i=1 t=4.199e-02 per=1.251e+01 cost=4.613e+05 flops=1.098e+07
 sigma_tot counter=170 i=2 t=4.104e-02 per=1.222e+01 cost=5.101e+05 flops=1.243e+07
 sigma_tot counter=170 i=3 t=4.090e-02 per=1.218e+01 cost=5.173e+05 flops=1.265e+07
 sigma_tot counter=170 i=4 t=4.210e-02 per=1.254e+01 cost=9.821e+05 flops=2.333e+07
 sigma_tot counter=170 i=5 t=4.234e-02 per=1.261e+01 cost=9.845e+05 flops=2.326e+07
 sigma_tot counter=170 i=6 t=4.364e-02 per=1.300e+01 cost=1.112e+06 flops=2.548e+07
 sigma_tot counter=170 i=7 t=4.224e-02 per=1.258e+01 cost=1.107e+06 flops=2.620e+07
 total GEMM cost=6.129e+06 flops=1.825e+07
    6   0 -      -2.654516950786 -1.319e-07  1.570e-04    6    12  3.191e-02 2.659e-03
    6   1 +      -2.436977447171 -3.725e-08  7.419e-05    6    12  3.191e-02 2.659e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.140e-04,2.018e-03,2.050e-04 cost=4.217e+04 flops[gemm]=2.089e+07
--- TIMING FOR sigma : t_inter=2.140e-04 t_gemm=2.016e-03 t_reduction=2.050e-04 tot=2.435e-03 ---
 sigma counter=171 i=0 t=2.520e-04 per=1.250e+01 cost=3.716e+03 flops=1.475e+07
 sigma counter=171 i=1 t=2.650e-04 per=1.314e+01 cost=3.736e+03 flops=1.410e+07
 sigma counter=171 i=2 t=2.380e-04 per=1.181e+01 cost=3.036e+03 flops=1.276e+07
 sigma counter=171 i=3 t=2.370e-04 per=1.176e+01 cost=3.026e+03 flops=1.277e+07
 sigma counter=171 i=4 t=2.540e-04 per=1.260e+01 cost=1.000e+04 flops=3.937e+07
 sigma counter=171 i=5 t=2.600e-04 per=1.290e+01 cost=1.000e+04 flops=3.846e+07
 sigma counter=171 i=6 t=2.590e-04 per=1.285e+01 cost=4.336e+03 flops=1.674e+07
 sigma counter=171 i=7 t=2.510e-04 per=1.245e+01 cost=4.316e+03 flops=1.720e+07
 total GEMM cost=4.217e+04 flops=2.092e+07
--- TIMING FOR sigma_tot : t_inter=3.640e-02 t_gemm=3.378e-01 t_reduction=3.372e-02 tot=4.079e-01 ---
 sigma_tot counter=171 i=0 t=4.175e-02 per=1.236e+01 cost=4.585e+05 flops=1.098e+07
 sigma_tot counter=171 i=1 t=4.226e-02 per=1.251e+01 cost=4.650e+05 flops=1.100e+07
 sigma_tot counter=171 i=2 t=4.128e-02 per=1.222e+01 cost=5.132e+05 flops=1.243e+07
 sigma_tot counter=171 i=3 t=4.113e-02 per=1.218e+01 cost=5.203e+05 flops=1.265e+07
 sigma_tot counter=171 i=4 t=4.235e-02 per=1.254e+01 cost=9.921e+05 flops=2.343e+07
 sigma_tot counter=171 i=5 t=4.260e-02 per=1.261e+01 cost=9.945e+05 flops=2.335e+07
 sigma_tot counter=171 i=6 t=4.390e-02 per=1.300e+01 cost=1.116e+06 flops=2.543e+07
 sigma_tot counter=171 i=7 t=4.249e-02 per=1.258e+01 cost=1.111e+06 flops=2.615e+07
 total GEMM cost=6.171e+06 flops=1.827e+07
    7   0 +      -2.654516966956 -1.617e-08  3.991e-05    5    13  3.459e-02 2.661e-03
    7   1 +      -2.436977447171 -2.665e-15  7.419e-05    5    13  3.459e-02 2.661e-03
TIMING FOR Davidson : 3.462e-02  T(cal/comm/rest)=3.405e-02,4.505e-05,5.286e-04
optimized energies: isweep=4 dots=2 ibond=0 e[0]=-2.65451696696 nmvp=13
optimized energies: isweep=4 dots=2 ibond=0 e[1]=-2.43697744717 nmvp=13
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=9 alg_decim=1 mpisize=2 maxthreads=2
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
TIMING FOR decimation: 3.7e-04 S T(wf/decim)=3.1e-04,6.1e-05
ctns::oper_renorm coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=852:6.5e-03MB:6.3e-06GB
rank=0 GPUmem(GB): used=2.2e-05 (oper)=8.5e-06
rank=0 GPUmem(GB): used=2.2e-05 (oper,site)(GB)=8.5e-06,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 5.824e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=2.22e-05 (oper,site,rinter)=8.52e-06,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.001 S size(rtasks)=37 size(Rlst2)=9 T(Rmu/Rlist)=0.000199,0.000803 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00108 S size(rtasks)=37 size(Rlst)=860 -----
rank=0 GPUmem(GB): used=0.000234 (oper,site,rinter,batch)=8.52e-06,2.68e-07,0,0.000211 blksize=16 blksize0=0 batchsize=860
timing: allocate=3.61e-05 rmmtasks init=0.00104 total=0.00108
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=6e-06,0.00118,0.00021 cost=1.69e+04 flops[gemm]=1.43e+07
--- TIMING FOR renorm : t_inter=5e-06 t_gemm=0.00118 t_reduction=0.000209 tot=0.00139 ---
 renorm counter=17 i=0 t=0.000238 per=20.2 cost=1.3e+03 flops=5.47e+06
 renorm counter=17 i=1 t=0.000234 per=19.8 cost=1.64e+03 flops=7e+06
 renorm counter=17 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=17 i=3 t=1e-06 per=0.0848 cost=0 flops=0
 renorm counter=17 i=4 t=0.000224 per=19 cost=1.19e+03 flops=5.33e+06
 renorm counter=17 i=5 t=0.000227 per=19.3 cost=1.85e+03 flops=8.17e+06
 renorm counter=17 i=6 t=0.000255 per=21.6 cost=1.09e+04 flops=4.27e+07
 total GEMM cost=1.69e+04 flops=1.43e+07
--- TIMING FOR renorm_tot : t_inter=0.00172 t_gemm=0.0196 t_reduction=0.00342 tot=0.0248 ---
 renorm_tot counter=17 i=0 t=0.00396 per=20.2 cost=3.46e+04 flops=8.74e+06
 renorm_tot counter=17 i=1 t=0.00387 per=19.7 cost=5.17e+04 flops=1.33e+07
 renorm_tot counter=17 i=2 t=0.00177 per=9.01 cost=3.4e+04 flops=1.92e+07
 renorm_tot counter=17 i=3 t=0.00179 per=9.12 cost=5.88e+04 flops=3.28e+07
 renorm_tot counter=17 i=4 t=0.00201 per=10.2 cost=3.68e+04 flops=1.83e+07
 renorm_tot counter=17 i=5 t=0.00205 per=10.4 cost=6.41e+04 flops=3.14e+07
 renorm_tot counter=17 i=6 t=0.00419 per=21.3 cost=4.35e+05 flops=1.04e+08
 total GEMM cost=7.15e+05 flops=3.64e+07
timing: gpu2cpu=1.47e-05 deallocate(site/work)=2.57e-06,5.15e-06 total=1.99e-05
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.00491 S T(init/kernel/comm)=0.00043,0.00441,6.52e-05 rank=0 -----
TIMING FOR cleanup: 0.000365 T(erase/save/remove)=9.5e-05,0.000232,3.82e-05
##### local: 5.156e-02 S #####
 T(local: fetch) = 1.528e-04 S  per = 0.296  per(accum) = 0.296
 T(local: hdiag) = 5.793e-04 S  per = 1.12  per(accum) = 1.42
 T(local: dvdsn) = 4.439e-02 S  per = 86.1  per(accum) = 87.5
 T(local: decim) = 4.670e-04 S  per = 0.906  per(accum) = 88.4
 T(local: guess) = 5.319e-04 S  per = 1.03  per(accum) = 89.5
 T(local: renrm) = 5.058e-03 S  per = 9.81  per(accum) = 99.3
 T(local: save ) = 3.791e-04 S  per = 0.735  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.324e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 8.516e-06 S  per = 0.0197  per(accum) = 0.0197
 T(local: symbolic_formulae_twodot     ) = 7.066e-04 S  per = 1.63  per(accum) = 1.65
 T(local: hintermediate init           ) = 5.988e-05 S  per = 0.138  per(accum) = 1.79
 T(local: hintermediates memcpy cpu2gpu) = 3.200e-08 S  per = 7.4e-05  per(accum) = 1.79
 T(local: preprocess_hformulae_Hxlist2 ) = 3.976e-03 S  per =  9.2  per(accum) = 11
 T(local: hmmtasks init                ) = 3.862e-03 S  per = 8.93  per(accum) = 19.9
 T(local: dvdson solver [Hx_batchGPU]  ) = 3.405e-02 S  per = 78.8  per(accum) = 98.7
 T(local: dvdson solver [communication]) = 4.505e-05 S  per = 0.104  per(accum) = 98.8
 T(local: dvdson solver [rest part]    ) = 5.286e-04 S  per = 1.22  per(accum) = 100
Detailed decomposition of T(renrm): 4.907e-03 S
 T(local: qops init                    ) = 4.301e-04 S  per = 8.76  per(accum) = 8.76
 T(local: qops_dict memcpy cpu2gpu     ) = 3.825e-05 S  per = 0.78  per(accum) = 9.54
 T(local: symbolic_formulae_renorm     ) = 5.913e-04 S  per =   12  per(accum) = 21.6
 T(local: rintermediate init           ) = 2.452e-05 S  per =  0.5  per(accum) = 22.1
 T(local: rintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 0.000591  per(accum) = 22.1
 T(local: preprocess_formulae_Rlist2   ) = 1.110e-03 S  per = 22.6  per(accum) = 44.7
 T(local: rmmtasks init                ) = 1.087e-03 S  per = 22.1  per(accum) = 66.9
 T(local: qops memset                  ) = 2.700e-08 S  per = 0.00055  per(accum) = 66.9
 T(local: preprocess_renorm_batchGPU   ) = 1.508e-03 S  per = 30.7  per(accum) = 97.6
 T(local: qops memcpy gpu2cpu          ) = 1.481e-05 S  per = 0.302  per(accum) = 97.9
 T(local: deallocate gpu memory        ) = 3.889e-05 S  per = 0.792  per(accum) = 98.7
 T(local: communication of opS and opH ) = 6.517e-05 S  per = 1.33  per(accum) = 100
##### sweep: 5.156e-02 S #####
 T(sweep: fetch) = 1.528e-04 S  per = 0.296  per(accum) = 0.296
 T(sweep: hdiag) = 5.793e-04 S  per = 1.12  per(accum) = 1.42
 T(sweep: dvdsn) = 4.439e-02 S  per = 86.1  per(accum) = 87.5
 T(sweep: decim) = 4.670e-04 S  per = 0.906  per(accum) = 88.4
 T(sweep: guess) = 5.319e-04 S  per = 1.03  per(accum) = 89.5
 T(sweep: renrm) = 5.058e-03 S  per = 9.81  per(accum) = 99.3
 T(sweep: save ) = 3.791e-04 S  per = 0.735  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.324e-02 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 8.516e-06 S  per = 0.0197  per(accum) = 0.0197
 T(sweep: symbolic_formulae_twodot     ) = 7.066e-04 S  per = 1.63  per(accum) = 1.65
 T(sweep: hintermediate init           ) = 5.988e-05 S  per = 0.138  per(accum) = 1.79
 T(sweep: hintermediates memcpy cpu2gpu) = 3.200e-08 S  per = 7.4e-05  per(accum) = 1.79
 T(sweep: preprocess_hformulae_Hxlist2 ) = 3.976e-03 S  per =  9.2  per(accum) = 11
 T(sweep: hmmtasks init                ) = 3.862e-03 S  per = 8.93  per(accum) = 19.9
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 3.405e-02 S  per = 78.8  per(accum) = 98.7
 T(sweep: dvdson solver [communication]) = 4.505e-05 S  per = 0.104  per(accum) = 98.8
 T(sweep: dvdson solver [rest part]    ) = 5.286e-04 S  per = 1.22  per(accum) = 100
Detailed decomposition of T(renrm): 4.907e-03 S
 T(sweep: qops init                    ) = 4.301e-04 S  per = 8.76  per(accum) = 8.76
 T(sweep: qops_dict memcpy cpu2gpu     ) = 3.825e-05 S  per = 0.78  per(accum) = 9.54
 T(sweep: symbolic_formulae_renorm     ) = 5.913e-04 S  per =   12  per(accum) = 21.6
 T(sweep: rintermediate init           ) = 2.452e-05 S  per =  0.5  per(accum) = 22.1
 T(sweep: rintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 0.000591  per(accum) = 22.1
 T(sweep: preprocess_formulae_Rlist2   ) = 1.110e-03 S  per = 22.6  per(accum) = 44.7
 T(sweep: rmmtasks init                ) = 1.087e-03 S  per = 22.1  per(accum) = 66.9
 T(sweep: qops memset                  ) = 2.700e-08 S  per = 0.00055  per(accum) = 66.9
 T(sweep: preprocess_renorm_batchGPU   ) = 1.508e-03 S  per = 30.7  per(accum) = 97.6
 T(sweep: qops memcpy gpu2cpu          ) = 1.481e-05 S  per = 0.302  per(accum) = 97.9
 T(sweep: deallocate gpu memory        ) = 3.889e-05 S  per = 0.792  per(accum) = 98.7
 T(sweep: communication of opS and opH ) = 6.517e-05 S  per = 1.33  per(accum) = 100
##### global: 7.262e-01 S #####
 T(global: fetch) = 1.144e-02 S  per = 1.58  per(accum) = 1.58
 T(global: hdiag) = 9.388e-03 S  per = 1.29  per(accum) = 2.87
 T(global: dvdsn) = 5.967e-01 S  per = 82.2  per(accum) = 85
 T(global: decim) = 1.473e-02 S  per = 2.03  per(accum) = 87.1
 T(global: guess) = 7.420e-03 S  per = 1.02  per(accum) = 88.1
 T(global: renrm) = 8.159e-02 S  per = 11.2  per(accum) = 99.3
 T(global: save ) = 5.013e-03 S  per = 0.69  per(accum) = 100
Detailed decomposition of T(dvdsn): 5.786e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 1.794e-04 S  per = 0.031  per(accum) = 0.031
 T(global: symbolic_formulae_twodot     ) = 1.131e-02 S  per = 1.95  per(accum) = 1.99
 T(global: hintermediate init           ) = 9.978e-04 S  per = 0.172  per(accum) = 2.16
 T(global: hintermediates memcpy cpu2gpu) = 5.030e-07 S  per = 8.69e-05  per(accum) = 2.16
 T(global: preprocess_hformulae_Hxlist2 ) = 5.999e-02 S  per = 10.4  per(accum) = 12.5
 T(global: hmmtasks init                ) = 5.921e-02 S  per = 10.2  per(accum) = 22.8
 T(global: dvdson solver [Hx_batchGPU]  ) = 4.391e-01 S  per = 75.9  per(accum) = 98.6
 T(global: dvdson solver [communication]) = 6.055e-04 S  per = 0.105  per(accum) = 98.8
 T(global: dvdson solver [rest part]    ) = 7.228e-03 S  per = 1.25  per(accum) = 100
Detailed decomposition of T(renrm): 7.908e-02 S
 T(global: qops init                    ) = 6.039e-03 S  per = 7.64  per(accum) = 7.64
 T(global: qops_dict memcpy cpu2gpu     ) = 7.137e-04 S  per = 0.903  per(accum) = 8.54
 T(global: symbolic_formulae_renorm     ) = 9.192e-03 S  per = 11.6  per(accum) = 20.2
 T(global: rintermediate init           ) = 7.722e-04 S  per = 0.976  per(accum) = 21.1
 T(global: rintermediates memcpy cpu2gpu) = 4.840e-07 S  per = 0.000612  per(accum) = 21.1
 T(global: preprocess_formulae_Rlist2   ) = 1.717e-02 S  per = 21.7  per(accum) = 42.8
 T(global: rmmtasks init                ) = 1.641e-02 S  per = 20.8  per(accum) = 63.6
 T(global: qops memset                  ) = 4.760e-07 S  per = 0.000602  per(accum) = 63.6
 T(global: preprocess_renorm_batchGPU   ) = 2.681e-02 S  per = 33.9  per(accum) = 97.5
 T(global: qops memcpy gpu2cpu          ) = 2.619e-04 S  per = 0.331  per(accum) = 97.8
 T(global: deallocate gpu memory        ) = 6.338e-04 S  per = 0.801  per(accum) = 98.6
 T(global: communication of opS and opH ) = 1.082e-03 S  per = 1.37  per(accum) = 100

isweep=4 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=852:0.0065MB:6.35e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1290:0.00984MB:9.61e-06GB
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44e21820
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
### DIAG TIMING: total=0.000359 t1=7.26e-06, t2=1.39e-05, t3=4.84e-05, t4=0.000123, t5=0.000124, t6=2.73e-05, t7=1.28e-05, t8=2.41e-06
duration_diagGPU:0.000372
duration_diagreduce:6.65e-06
duration_diagtransform:1.86e-06
rank=0 GPUmem(GB): used=9.61e-06 (oper)=9.61e-06
----- TIMING FOR symbolic_formulae_twodot with size=95 : 6.464e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=95
 no. of hintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.538e-05 S -----
rank=0 GPUmem(GB): used=9.94e-06 (oper,hinter)=9.61e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00331 S size(H_formulae)=95 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000188,0.00313 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00356 S size(H_formulae)=95 size(Hxlst)=2974 -----
rank=0 GPUmem(GB): used=0.000388 (oper,hinter,dvdson,batch)=9.61e-06,3.28e-07,1.49e-06,0.000377 blksize=4 blksize0=8 batchsize=2974
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000221,0.002,0.000198 cost=4.12e+04 flops[gemm]=2.06e+07
--- TIMING FOR sigma : t_inter=0.000221 t_gemm=0.002 t_reduction=0.000197 tot=0.00242 ---
 sigma counter=172 i=0 t=0.000242 per=12.1 cost=2.58e+03 flops=1.07e+07
 sigma counter=172 i=1 t=0.000247 per=12.3 cost=2.57e+03 flops=1.04e+07
 sigma counter=172 i=2 t=0.000245 per=12.2 cost=3.75e+03 flops=1.53e+07
 sigma counter=172 i=3 t=0.000245 per=12.2 cost=3.77e+03 flops=1.54e+07
 sigma counter=172 i=4 t=0.00025 per=12.5 cost=4.11e+03 flops=1.64e+07
 sigma counter=172 i=5 t=0.000253 per=12.6 cost=4.13e+03 flops=1.63e+07
 sigma counter=172 i=6 t=0.00026 per=13 cost=1.01e+04 flops=3.9e+07
 sigma counter=172 i=7 t=0.000259 per=12.9 cost=1.01e+04 flops=3.92e+07
 total GEMM cost=4.12e+04 flops=2.06e+07
--- TIMING FOR sigma_tot : t_inter=0.0366 t_gemm=0.34 t_reduction=0.0339 tot=0.41 ---
 sigma_tot counter=172 i=0 t=0.042 per=12.4 cost=4.61e+05 flops=1.1e+07
 sigma_tot counter=172 i=1 t=0.0425 per=12.5 cost=4.68e+05 flops=1.1e+07
 sigma_tot counter=172 i=2 t=0.0415 per=12.2 cost=5.17e+05 flops=1.24e+07
 sigma_tot counter=172 i=3 t=0.0414 per=12.2 cost=5.24e+05 flops=1.27e+07
 sigma_tot counter=172 i=4 t=0.0426 per=12.5 cost=9.96e+05 flops=2.34e+07
 sigma_tot counter=172 i=5 t=0.0428 per=12.6 cost=9.99e+05 flops=2.33e+07
 sigma_tot counter=172 i=6 t=0.0442 per=13 cost=1.13e+06 flops=2.55e+07
 sigma_tot counter=172 i=7 t=0.0427 per=12.6 cost=1.12e+06 flops=2.62e+07
 total GEMM cost=6.21e+06 flops=1.83e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000212,0.00202,0.000198 cost=4.12e+04 flops[gemm]=2.04e+07
--- TIMING FOR sigma : t_inter=0.000212 t_gemm=0.00202 t_reduction=0.000198 tot=0.00243 ---
 sigma counter=173 i=0 t=0.000242 per=12 cost=2.58e+03 flops=1.07e+07
 sigma counter=173 i=1 t=0.000236 per=11.7 cost=2.57e+03 flops=1.09e+07
 sigma counter=173 i=2 t=0.000251 per=12.4 cost=3.75e+03 flops=1.5e+07
 sigma counter=173 i=3 t=0.00025 per=12.3 cost=3.77e+03 flops=1.51e+07
 sigma counter=173 i=4 t=0.000256 per=12.6 cost=4.11e+03 flops=1.61e+07
 sigma counter=173 i=5 t=0.000258 per=12.7 cost=4.13e+03 flops=1.6e+07
 sigma counter=173 i=6 t=0.000266 per=13.1 cost=1.01e+04 flops=3.81e+07
 sigma counter=173 i=7 t=0.000266 per=13.1 cost=1.01e+04 flops=3.81e+07
 total GEMM cost=4.12e+04 flops=2.04e+07
--- TIMING FOR sigma_tot : t_inter=0.0368 t_gemm=0.342 t_reduction=0.0341 tot=0.413 ---
 sigma_tot counter=173 i=0 t=0.0422 per=12.4 cost=4.64e+05 flops=1.1e+07
 sigma_tot counter=173 i=1 t=0.0427 per=12.5 cost=4.7e+05 flops=1.1e+07
 sigma_tot counter=173 i=2 t=0.0418 per=12.2 cost=5.21e+05 flops=1.25e+07
 sigma_tot counter=173 i=3 t=0.0416 per=12.2 cost=5.28e+05 flops=1.27e+07
 sigma_tot counter=173 i=4 t=0.0429 per=12.5 cost=1e+06 flops=2.33e+07
 sigma_tot counter=173 i=5 t=0.0431 per=12.6 cost=1e+06 flops=2.33e+07
 sigma_tot counter=173 i=6 t=0.0444 per=13 cost=1.14e+06 flops=2.56e+07
 sigma_tot counter=173 i=7 t=0.043 per=12.6 cost=1.13e+06 flops=2.63e+07
 total GEMM cost=6.25e+06 flops=1.83e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956 -1.003e+03  3.991e-05    2     2  5.341e-03 2.671e-03
    1   1 +      -2.436977447171 -1.002e+03  7.419e-05    2     2  5.341e-03 2.671e-03
TIMING FOR Davidson : 5.393e-03  T(cal/comm/rest)=5.289e-03,7.697e-06,9.603e-05
optimized energies: isweep=4 dots=2 ibond=1 e[0]=-2.65451696696 nmvp=2
optimized energies: isweep=4 dots=2 ibond=1 e[1]=-2.43697744717 nmvp=2
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=16 alg_decim=1 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep4_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
----- TMING FOR decimation_genbasis: 3.9e-04 S T(scatter/comp/gather)=3.7e-05,4.0e-05,3.2e-04 -----
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
 qbond: qkept nsym=6 dimAll=20
 (3,1):6 (4,0):4 (2,0):3 (4,2):3 (3,-1):2 (5,1):2
----- TIMING for decimation_row: 7.002e-04 S T(decim/formRot)=4.708e-04,2.295e-04 -----
TIMING FOR decimation: 1.009e-03 S T(wf/decim)=2.932e-04,7.154e-04
ctns::oper_renorm coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:6 A:7 B:11 P:3 Q:5 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=1685:1.286e-02MB:1.255e-05GB
rank=0 GPUmem(GB): used=2.249e-05 (oper)=1.999e-05
rank=0 GPUmem(GB): used=2.361e-05 (oper,site)(GB)=1.999e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=37 : 4.746e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 4.968e-05 S -----
rank=0 GPUmem(GB): used=2.39e-05 (oper,site,rinter)=2e-05,1.12e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00099 S size(rtasks)=37 size(Rlst2)=6 T(Rmu/Rlist)=0.000167,0.000823 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00107 S size(rtasks)=37 size(Rlst)=905 -----
rank=0 GPUmem(GB): used=0.00057 (oper,site,rinter,batch)=2e-05,1.12e-06,3.28e-07,0.000546 blksize=36 blksize0=8 batchsize=905
timing: allocate=3.62e-05 rmmtasks init=0.00112 total=0.00116
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000209,0.00117,0.000207 cost=9.26e+04 flops[gemm]=7.95e+07
--- TIMING FOR renorm : t_inter=0.000209 t_gemm=0.00116 t_reduction=0.000207 tot=0.00158 ---
 renorm counter=18 i=0 t=0.000227 per=19.5 cost=4.54e+03 flops=2e+07
 renorm counter=18 i=1 t=0.000226 per=19.4 cost=5.34e+03 flops=2.36e+07
 renorm counter=18 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=18 i=3 t=1e-06 per=0.0858 cost=0 flops=0
 renorm counter=18 i=4 t=0.000227 per=19.5 cost=9.49e+03 flops=4.18e+07
 renorm counter=18 i=5 t=0.00023 per=19.7 cost=1.68e+04 flops=7.3e+07
 renorm counter=18 i=6 t=0.000254 per=21.8 cost=5.64e+04 flops=2.22e+08
 total GEMM cost=9.26e+04 flops=7.95e+07
--- TIMING FOR renorm_tot : t_inter=0.00193 t_gemm=0.0208 t_reduction=0.00363 tot=0.0264 ---
 renorm_tot counter=18 i=0 t=0.00419 per=20.1 cost=3.91e+04 flops=9.35e+06
 renorm_tot counter=18 i=1 t=0.0041 per=19.7 cost=5.71e+04 flops=1.39e+07
 renorm_tot counter=18 i=2 t=0.00177 per=8.51 cost=3.4e+04 flops=1.92e+07
 renorm_tot counter=18 i=3 t=0.00179 per=8.62 cost=5.88e+04 flops=3.28e+07
 renorm_tot counter=18 i=4 t=0.00224 per=10.8 cost=4.63e+04 flops=2.07e+07
 renorm_tot counter=18 i=5 t=0.00228 per=10.9 cost=8.09e+04 flops=3.56e+07
 renorm_tot counter=18 i=6 t=0.00444 per=21.3 cost=4.91e+05 flops=1.11e+08
 total GEMM cost=8.07e+05 flops=3.88e+07
timing: gpu2cpu=1.7e-05 deallocate(site/work)=3.4e-06,6.49e-06 total=2.35e-05
check ||H-H.dagger||=7.227e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.005 S T(init/kernel/comm)=0.000325,0.00461,6.14e-05 rank=0 -----
TIMING FOR cleanup: 0.000186 T(erase/save/remove)=4.32e-06,0.000146,3.52e-05
##### local: 2.300e-02 S #####
 T(local: fetch) = 1.046e-03 S  per = 4.55  per(accum) = 4.55
 T(local: hdiag) = 5.104e-04 S  per = 2.22  per(accum) = 6.77
 T(local: dvdsn) = 1.454e-02 S  per = 63.2  per(accum) = 70
 T(local: decim) = 1.149e-03 S  per =    5  per(accum) = 75
 T(local: guess) = 3.936e-04 S  per = 1.71  per(accum) = 76.7
 T(local: renrm) = 5.159e-03 S  per = 22.4  per(accum) = 99.1
 T(local: save ) = 1.985e-04 S  per = 0.863  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.340e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 9.475e-06 S  per = 0.0707  per(accum) = 0.0707
 T(local: symbolic_formulae_twodot     ) = 6.555e-04 S  per = 4.89  per(accum) = 4.96
 T(local: hintermediate init           ) = 5.865e-05 S  per = 0.438  per(accum) = 5.4
 T(local: hintermediates memcpy cpu2gpu) = 2.700e-08 S  per = 0.000202  per(accum) = 5.4
 T(local: preprocess_hformulae_Hxlist2 ) = 3.659e-03 S  per = 27.3  per(accum) = 32.7
 T(local: hmmtasks init                ) = 3.623e-03 S  per =   27  per(accum) = 59.7
 T(local: dvdson solver [Hx_batchGPU]  ) = 5.289e-03 S  per = 39.5  per(accum) = 99.2
 T(local: dvdson solver [communication]) = 7.697e-06 S  per = 0.0574  per(accum) = 99.3
 T(local: dvdson solver [rest part]    ) = 9.603e-05 S  per = 0.717  per(accum) = 100
Detailed decomposition of T(renrm): 4.996e-03 S
 T(local: qops init                    ) = 3.254e-04 S  per = 6.51  per(accum) = 6.51
 T(local: qops_dict memcpy cpu2gpu     ) = 4.451e-05 S  per = 0.891  per(accum) = 7.4
 T(local: symbolic_formulae_renorm     ) = 4.833e-04 S  per = 9.68  per(accum) = 17.1
 T(local: rintermediate init           ) = 6.310e-05 S  per = 1.26  per(accum) = 18.3
 T(local: rintermediates memcpy cpu2gpu) = 3.000e-08 S  per = 0.000601  per(accum) = 18.3
 T(local: preprocess_formulae_Rlist2   ) = 1.105e-03 S  per = 22.1  per(accum) = 40.5
 T(local: rmmtasks init                ) = 1.166e-03 S  per = 23.3  per(accum) = 63.8
 T(local: qops memset                  ) = 2.700e-08 S  per = 0.00054  per(accum) = 63.8
 T(local: preprocess_renorm_batchGPU   ) = 1.695e-03 S  per = 33.9  per(accum) = 97.7
 T(local: qops memcpy gpu2cpu          ) = 1.706e-05 S  per = 0.342  per(accum) = 98.1
 T(local: deallocate gpu memory        ) = 3.471e-05 S  per = 0.695  per(accum) = 98.8
 T(local: communication of opS and opH ) = 6.139e-05 S  per = 1.23  per(accum) = 100
##### sweep: 7.456e-02 S #####
 T(sweep: fetch) = 1.199e-03 S  per = 1.61  per(accum) = 1.61
 T(sweep: hdiag) = 1.090e-03 S  per = 1.46  per(accum) = 3.07
 T(sweep: dvdsn) = 5.893e-02 S  per =   79  per(accum) = 82.1
 T(sweep: decim) = 1.616e-03 S  per = 2.17  per(accum) = 84.3
 T(sweep: guess) = 9.255e-04 S  per = 1.24  per(accum) = 85.5
 T(sweep: renrm) = 1.022e-02 S  per = 13.7  per(accum) = 99.2
 T(sweep: save ) = 5.776e-04 S  per = 0.775  per(accum) = 100
Detailed decomposition of T(dvdsn): 5.664e-02 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.799e-05 S  per = 0.0318  per(accum) = 0.0318
 T(sweep: symbolic_formulae_twodot     ) = 1.362e-03 S  per = 2.41  per(accum) = 2.44
 T(sweep: hintermediate init           ) = 1.185e-04 S  per = 0.209  per(accum) = 2.65
 T(sweep: hintermediates memcpy cpu2gpu) = 5.900e-08 S  per = 0.000104  per(accum) = 2.65
 T(sweep: preprocess_hformulae_Hxlist2 ) = 7.635e-03 S  per = 13.5  per(accum) = 16.1
 T(sweep: hmmtasks init                ) = 7.485e-03 S  per = 13.2  per(accum) = 29.3
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 3.934e-02 S  per = 69.5  per(accum) = 98.8
 T(sweep: dvdson solver [communication]) = 5.275e-05 S  per = 0.0931  per(accum) = 98.9
 T(sweep: dvdson solver [rest part]    ) = 6.247e-04 S  per =  1.1  per(accum) = 100
Detailed decomposition of T(renrm): 9.903e-03 S
 T(sweep: qops init                    ) = 7.555e-04 S  per = 7.63  per(accum) = 7.63
 T(sweep: qops_dict memcpy cpu2gpu     ) = 8.276e-05 S  per = 0.836  per(accum) = 8.46
 T(sweep: symbolic_formulae_renorm     ) = 1.075e-03 S  per = 10.9  per(accum) = 19.3
 T(sweep: rintermediate init           ) = 8.762e-05 S  per = 0.885  per(accum) = 20.2
 T(sweep: rintermediates memcpy cpu2gpu) = 5.900e-08 S  per = 0.000596  per(accum) = 20.2
 T(sweep: preprocess_formulae_Rlist2   ) = 2.215e-03 S  per = 22.4  per(accum) = 42.6
 T(sweep: rmmtasks init                ) = 2.253e-03 S  per = 22.7  per(accum) = 65.3
 T(sweep: qops memset                  ) = 5.400e-08 S  per = 0.000545  per(accum) = 65.3
 T(sweep: preprocess_renorm_batchGPU   ) = 3.202e-03 S  per = 32.3  per(accum) = 97.7
 T(sweep: qops memcpy gpu2cpu          ) = 3.187e-05 S  per = 0.322  per(accum) = 98
 T(sweep: deallocate gpu memory        ) = 7.360e-05 S  per = 0.743  per(accum) = 98.7
 T(sweep: communication of opS and opH ) = 1.266e-04 S  per = 1.28  per(accum) = 100
##### global: 7.492e-01 S #####
 T(global: fetch) = 1.249e-02 S  per = 1.67  per(accum) = 1.67
 T(global: hdiag) = 9.898e-03 S  per = 1.32  per(accum) = 2.99
 T(global: dvdsn) = 6.112e-01 S  per = 81.6  per(accum) = 84.6
 T(global: decim) = 1.588e-02 S  per = 2.12  per(accum) = 86.7
 T(global: guess) = 7.814e-03 S  per = 1.04  per(accum) = 87.7
 T(global: renrm) = 8.675e-02 S  per = 11.6  per(accum) = 99.3
 T(global: save ) = 5.212e-03 S  per = 0.696  per(accum) = 100
Detailed decomposition of T(dvdsn): 5.920e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 1.889e-04 S  per = 0.0319  per(accum) = 0.0319
 T(global: symbolic_formulae_twodot     ) = 1.197e-02 S  per = 2.02  per(accum) = 2.05
 T(global: hintermediate init           ) = 1.056e-03 S  per = 0.178  per(accum) = 2.23
 T(global: hintermediates memcpy cpu2gpu) = 5.300e-07 S  per = 8.95e-05  per(accum) = 2.23
 T(global: preprocess_hformulae_Hxlist2 ) = 6.365e-02 S  per = 10.8  per(accum) = 13
 T(global: hmmtasks init                ) = 6.283e-02 S  per = 10.6  per(accum) = 23.6
 T(global: dvdson solver [Hx_batchGPU]  ) = 4.444e-01 S  per = 75.1  per(accum) = 98.7
 T(global: dvdson solver [communication]) = 6.132e-04 S  per = 0.104  per(accum) = 98.8
 T(global: dvdson solver [rest part]    ) = 7.324e-03 S  per = 1.24  per(accum) = 100
Detailed decomposition of T(renrm): 8.408e-02 S
 T(global: qops init                    ) = 6.365e-03 S  per = 7.57  per(accum) = 7.57
 T(global: qops_dict memcpy cpu2gpu     ) = 7.583e-04 S  per = 0.902  per(accum) = 8.47
 T(global: symbolic_formulae_renorm     ) = 9.675e-03 S  per = 11.5  per(accum) = 20
 T(global: rintermediate init           ) = 8.353e-04 S  per = 0.993  per(accum) = 21
 T(global: rintermediates memcpy cpu2gpu) = 5.140e-07 S  per = 0.000611  per(accum) = 21
 T(global: preprocess_formulae_Rlist2   ) = 1.827e-02 S  per = 21.7  per(accum) = 42.7
 T(global: rmmtasks init                ) = 1.758e-02 S  per = 20.9  per(accum) = 63.6
 T(global: qops memset                  ) = 5.030e-07 S  per = 0.000598  per(accum) = 63.6
 T(global: preprocess_renorm_batchGPU   ) = 2.850e-02 S  per = 33.9  per(accum) = 97.5
 T(global: qops memcpy gpu2cpu          ) = 2.790e-04 S  per = 0.332  per(accum) = 97.8
 T(global: deallocate gpu memory        ) = 6.685e-04 S  per = 0.795  per(accum) = 98.6
 T(global: communication of opS and opH ) = 1.143e-03 S  per = 1.36  per(accum) = 100

isweep=4 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=852:0.0065MB:6.35e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1290:0.00984MB:9.61e-06GB
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x4513c560
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
### DIAG TIMING: total=0.000364 t1=1.08e-05, t2=1.65e-05, t3=4.9e-05, t4=0.000123, t5=0.000123, t6=2.71e-05, t7=1.26e-05, t8=2.45e-06
duration_diagGPU:0.000379
duration_diagreduce:4.03e-06
duration_diagtransform:1.82e-06
rank=0 GPUmem(GB): used=2.22e-05 (oper)=9.61e-06
----- TIMING FOR symbolic_formulae_twodot with size=95 : 6.346e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=95
 no. of hintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.354e-05 S -----
rank=0 GPUmem(GB): used=2.25e-05 (oper,hinter)=9.61e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00333 S size(H_formulae)=95 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000193,0.00314 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00358 S size(H_formulae)=95 size(Hxlst)=2974 -----
rank=0 GPUmem(GB): used=0.000401 (oper,hinter,dvdson,batch)=9.61e-06,3.28e-07,1.49e-06,0.000377 blksize=4 blksize0=8 batchsize=2974
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.4e-05,0.000218,0.00201,0.0002 cost=4.12e+04 flops[gemm]=2.05e+07
--- TIMING FOR sigma : t_inter=0.000218 t_gemm=0.00201 t_reduction=0.0002 tot=0.00242 ---
 sigma counter=174 i=0 t=0.000248 per=12.4 cost=2.58e+03 flops=1.04e+07
 sigma counter=174 i=1 t=0.00024 per=12 cost=2.57e+03 flops=1.07e+07
 sigma counter=174 i=2 t=0.000245 per=12.2 cost=3.75e+03 flops=1.53e+07
 sigma counter=174 i=3 t=0.000246 per=12.3 cost=3.77e+03 flops=1.53e+07
 sigma counter=174 i=4 t=0.000255 per=12.7 cost=4.11e+03 flops=1.61e+07
 sigma counter=174 i=5 t=0.000253 per=12.6 cost=4.13e+03 flops=1.63e+07
 sigma counter=174 i=6 t=0.000262 per=13.1 cost=1.01e+04 flops=3.87e+07
 sigma counter=174 i=7 t=0.000257 per=12.8 cost=1.01e+04 flops=3.95e+07
 total GEMM cost=4.12e+04 flops=2.05e+07
--- TIMING FOR sigma_tot : t_inter=0.0371 t_gemm=0.344 t_reduction=0.0343 tot=0.415 ---
 sigma_tot counter=174 i=0 t=0.0425 per=12.4 cost=4.66e+05 flops=1.1e+07
 sigma_tot counter=174 i=1 t=0.043 per=12.5 cost=4.73e+05 flops=1.1e+07
 sigma_tot counter=174 i=2 t=0.042 per=12.2 cost=5.24e+05 flops=1.25e+07
 sigma_tot counter=174 i=3 t=0.0419 per=12.2 cost=5.32e+05 flops=1.27e+07
 sigma_tot counter=174 i=4 t=0.0431 per=12.5 cost=1e+06 flops=2.33e+07
 sigma_tot counter=174 i=5 t=0.0434 per=12.6 cost=1.01e+06 flops=2.32e+07
 sigma_tot counter=174 i=6 t=0.0447 per=13 cost=1.15e+06 flops=2.57e+07
 sigma_tot counter=174 i=7 t=0.0433 per=12.6 cost=1.14e+06 flops=2.64e+07
 total GEMM cost=6.29e+06 flops=1.83e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000214,0.00199,0.000196 cost=4.12e+04 flops[gemm]=2.07e+07
--- TIMING FOR sigma : t_inter=0.000214 t_gemm=0.00199 t_reduction=0.000196 tot=0.0024 ---
 sigma counter=175 i=0 t=0.000238 per=11.9 cost=2.58e+03 flops=1.08e+07
 sigma counter=175 i=1 t=0.000247 per=12.4 cost=2.57e+03 flops=1.04e+07
 sigma counter=175 i=2 t=0.000245 per=12.3 cost=3.75e+03 flops=1.53e+07
 sigma counter=175 i=3 t=0.000246 per=12.3 cost=3.77e+03 flops=1.53e+07
 sigma counter=175 i=4 t=0.000248 per=12.4 cost=4.11e+03 flops=1.66e+07
 sigma counter=175 i=5 t=0.000252 per=12.7 cost=4.13e+03 flops=1.64e+07
 sigma counter=175 i=6 t=0.000263 per=13.2 cost=1.01e+04 flops=3.86e+07
 sigma counter=175 i=7 t=0.000253 per=12.7 cost=1.01e+04 flops=4.01e+07
 total GEMM cost=4.12e+04 flops=2.07e+07
--- TIMING FOR sigma_tot : t_inter=0.0373 t_gemm=0.346 t_reduction=0.0345 tot=0.418 ---
 sigma_tot counter=175 i=0 t=0.0427 per=12.4 cost=4.69e+05 flops=1.1e+07
 sigma_tot counter=175 i=1 t=0.0432 per=12.5 cost=4.75e+05 flops=1.1e+07
 sigma_tot counter=175 i=2 t=0.0423 per=12.2 cost=5.28e+05 flops=1.25e+07
 sigma_tot counter=175 i=3 t=0.0421 per=12.2 cost=5.35e+05 flops=1.27e+07
 sigma_tot counter=175 i=4 t=0.0434 per=12.5 cost=1.01e+06 flops=2.33e+07
 sigma_tot counter=175 i=5 t=0.0436 per=12.6 cost=1.01e+06 flops=2.32e+07
 sigma_tot counter=175 i=6 t=0.045 per=13 cost=1.16e+06 flops=2.57e+07
 sigma_tot counter=175 i=7 t=0.0435 per=12.6 cost=1.15e+06 flops=2.65e+07
 total GEMM cost=6.34e+06 flops=1.83e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592 -1.003e+03  7.009e-02    2     2  5.309e-03 2.655e-03
    1   1 -      -2.436094100141 -1.002e+03  4.918e-02    2     2  5.309e-03 2.655e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.230e-04,2.033e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.027e+07
--- TIMING FOR sigma : t_inter=2.230e-04 t_gemm=2.031e-03 t_reduction=1.960e-04 tot=2.450e-03 ---
 sigma counter=176 i=0 t=2.470e-04 per=1.216e+01 cost=2.582e+03 flops=1.045e+07
 sigma counter=176 i=1 t=2.460e-04 per=1.211e+01 cost=2.572e+03 flops=1.046e+07
 sigma counter=176 i=2 t=2.520e-04 per=1.241e+01 cost=3.754e+03 flops=1.490e+07
 sigma counter=176 i=3 t=2.580e-04 per=1.270e+01 cost=3.774e+03 flops=1.463e+07
 sigma counter=176 i=4 t=2.550e-04 per=1.256e+01 cost=4.112e+03 flops=1.613e+07
 sigma counter=176 i=5 t=2.540e-04 per=1.251e+01 cost=4.132e+03 flops=1.627e+07
 sigma counter=176 i=6 t=2.640e-04 per=1.300e+01 cost=1.014e+04 flops=3.842e+07
 sigma counter=176 i=7 t=2.550e-04 per=1.256e+01 cost=1.014e+04 flops=3.978e+07
 total GEMM cost=4.121e+04 flops=2.029e+07
--- TIMING FOR sigma_tot : t_inter=3.749e-02 t_gemm=3.478e-01 t_reduction=3.471e-02 tot=4.200e-01 ---
 sigma_tot counter=176 i=0 t=4.297e-02 per=1.235e+01 cost=4.714e+05 flops=1.097e+07
 sigma_tot counter=176 i=1 t=4.348e-02 per=1.250e+01 cost=4.779e+05 flops=1.099e+07
 sigma_tot counter=176 i=2 t=4.252e-02 per=1.222e+01 cost=5.319e+05 flops=1.251e+07
 sigma_tot counter=176 i=3 t=4.238e-02 per=1.218e+01 cost=5.392e+05 flops=1.272e+07
 sigma_tot counter=176 i=4 t=4.362e-02 per=1.254e+01 cost=1.013e+06 flops=2.322e+07
 sigma_tot counter=176 i=5 t=4.387e-02 per=1.261e+01 cost=1.015e+06 flops=2.314e+07
 sigma_tot counter=176 i=6 t=4.521e-02 per=1.300e+01 cost=1.167e+06 flops=2.581e+07
 sigma_tot counter=176 i=7 t=4.378e-02 per=1.259e+01 cost=1.162e+06 flops=2.654e+07
 total GEMM cost=6.377e+06 flops=1.833e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.120e-04,1.996e-03,1.970e-04 cost=4.121e+04 flops[gemm]=2.065e+07
--- TIMING FOR sigma : t_inter=2.120e-04 t_gemm=1.996e-03 t_reduction=1.970e-04 tot=2.405e-03 ---
 sigma counter=177 i=0 t=2.390e-04 per=1.197e+01 cost=2.582e+03 flops=1.080e+07
 sigma counter=177 i=1 t=2.380e-04 per=1.192e+01 cost=2.572e+03 flops=1.081e+07
 sigma counter=177 i=2 t=2.580e-04 per=1.293e+01 cost=3.754e+03 flops=1.455e+07
 sigma counter=177 i=3 t=2.470e-04 per=1.237e+01 cost=3.774e+03 flops=1.528e+07
 sigma counter=177 i=4 t=2.480e-04 per=1.242e+01 cost=4.112e+03 flops=1.658e+07
 sigma counter=177 i=5 t=2.520e-04 per=1.263e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=177 i=6 t=2.610e-04 per=1.308e+01 cost=1.014e+04 flops=3.887e+07
 sigma counter=177 i=7 t=2.530e-04 per=1.268e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.065e+07
--- TIMING FOR sigma_tot : t_inter=3.770e-02 t_gemm=3.498e-01 t_reduction=3.491e-02 tot=4.224e-01 ---
 sigma_tot counter=177 i=0 t=4.321e-02 per=1.235e+01 cost=4.740e+05 flops=1.097e+07
 sigma_tot counter=177 i=1 t=4.371e-02 per=1.250e+01 cost=4.804e+05 flops=1.099e+07
 sigma_tot counter=177 i=2 t=4.278e-02 per=1.223e+01 cost=5.357e+05 flops=1.252e+07
 sigma_tot counter=177 i=3 t=4.263e-02 per=1.219e+01 cost=5.430e+05 flops=1.274e+07
 sigma_tot counter=177 i=4 t=4.386e-02 per=1.254e+01 cost=1.017e+06 flops=2.318e+07
 sigma_tot counter=177 i=5 t=4.412e-02 per=1.261e+01 cost=1.019e+06 flops=2.311e+07
 sigma_tot counter=177 i=6 t=4.548e-02 per=1.300e+01 cost=1.177e+06 flops=2.589e+07
 sigma_tot counter=177 i=7 t=4.403e-02 per=1.259e+01 cost=1.172e+06 flops=2.661e+07
 total GEMM cost=6.418e+06 flops=1.835e+07
    2   0 -      -2.654426863105 -1.838e-03  1.257e-02    4     4  1.062e-02 2.656e-03
    2   1 -      -2.436959129202 -8.650e-04  5.189e-03    4     4  1.062e-02 2.656e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.190e-04,2.032e-03,2.020e-04 cost=4.121e+04 flops[gemm]=2.028e+07
--- TIMING FOR sigma : t_inter=2.190e-04 t_gemm=2.032e-03 t_reduction=2.010e-04 tot=2.452e-03 ---
 sigma counter=178 i=0 t=2.430e-04 per=1.196e+01 cost=2.582e+03 flops=1.063e+07
 sigma counter=178 i=1 t=2.410e-04 per=1.186e+01 cost=2.572e+03 flops=1.067e+07
 sigma counter=178 i=2 t=2.510e-04 per=1.235e+01 cost=3.754e+03 flops=1.496e+07
 sigma counter=178 i=3 t=2.520e-04 per=1.240e+01 cost=3.774e+03 flops=1.498e+07
 sigma counter=178 i=4 t=2.560e-04 per=1.260e+01 cost=4.112e+03 flops=1.606e+07
 sigma counter=178 i=5 t=2.590e-04 per=1.275e+01 cost=4.132e+03 flops=1.595e+07
 sigma counter=178 i=6 t=2.680e-04 per=1.319e+01 cost=1.014e+04 flops=3.785e+07
 sigma counter=178 i=7 t=2.620e-04 per=1.289e+01 cost=1.014e+04 flops=3.872e+07
 total GEMM cost=4.121e+04 flops=2.028e+07
--- TIMING FOR sigma_tot : t_inter=3.792e-02 t_gemm=3.518e-01 t_reduction=3.511e-02 tot=4.249e-01 ---
 sigma_tot counter=178 i=0 t=4.345e-02 per=1.235e+01 cost=4.766e+05 flops=1.097e+07
 sigma_tot counter=178 i=1 t=4.395e-02 per=1.249e+01 cost=4.830e+05 flops=1.099e+07
 sigma_tot counter=178 i=2 t=4.303e-02 per=1.223e+01 cost=5.394e+05 flops=1.254e+07
 sigma_tot counter=178 i=3 t=4.288e-02 per=1.219e+01 cost=5.467e+05 flops=1.275e+07
 sigma_tot counter=178 i=4 t=4.412e-02 per=1.254e+01 cost=1.021e+06 flops=2.314e+07
 sigma_tot counter=178 i=5 t=4.438e-02 per=1.261e+01 cost=1.023e+06 flops=2.306e+07
 sigma_tot counter=178 i=6 t=4.574e-02 per=1.300e+01 cost=1.187e+06 flops=2.596e+07
 sigma_tot counter=178 i=7 t=4.429e-02 per=1.259e+01 cost=1.182e+06 flops=2.668e+07
 total GEMM cost=6.459e+06 flops=1.836e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.300e-05,2.100e-04,1.992e-03,1.980e-04 cost=4.121e+04 flops[gemm]=2.069e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=1.992e-03 t_reduction=1.980e-04 tot=2.400e-03 ---
 sigma counter=179 i=0 t=2.400e-04 per=1.205e+01 cost=2.582e+03 flops=1.076e+07
 sigma counter=179 i=1 t=2.440e-04 per=1.225e+01 cost=2.572e+03 flops=1.054e+07
 sigma counter=179 i=2 t=2.460e-04 per=1.235e+01 cost=3.754e+03 flops=1.526e+07
 sigma counter=179 i=3 t=2.450e-04 per=1.230e+01 cost=3.774e+03 flops=1.540e+07
 sigma counter=179 i=4 t=2.480e-04 per=1.245e+01 cost=4.112e+03 flops=1.658e+07
 sigma counter=179 i=5 t=2.510e-04 per=1.260e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=179 i=6 t=2.620e-04 per=1.315e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=179 i=7 t=2.560e-04 per=1.285e+01 cost=1.014e+04 flops=3.962e+07
 total GEMM cost=4.121e+04 flops=2.069e+07
--- TIMING FOR sigma_tot : t_inter=3.813e-02 t_gemm=3.538e-01 t_reduction=3.531e-02 tot=4.273e-01 ---
 sigma_tot counter=179 i=0 t=4.369e-02 per=1.235e+01 cost=4.792e+05 flops=1.097e+07
 sigma_tot counter=179 i=1 t=4.420e-02 per=1.249e+01 cost=4.856e+05 flops=1.099e+07
 sigma_tot counter=179 i=2 t=4.327e-02 per=1.223e+01 cost=5.432e+05 flops=1.255e+07
 sigma_tot counter=179 i=3 t=4.312e-02 per=1.219e+01 cost=5.505e+05 flops=1.277e+07
 sigma_tot counter=179 i=4 t=4.437e-02 per=1.254e+01 cost=1.025e+06 flops=2.310e+07
 sigma_tot counter=179 i=5 t=4.463e-02 per=1.261e+01 cost=1.028e+06 flops=2.303e+07
 sigma_tot counter=179 i=6 t=4.601e-02 per=1.300e+01 cost=1.198e+06 flops=2.603e+07
 sigma_tot counter=179 i=7 t=4.455e-02 per=1.259e+01 cost=1.192e+06 flops=2.676e+07
 total GEMM cost=6.501e+06 flops=1.837e+07
    3   0 -      -2.654508902835 -8.204e-05  3.559e-03    6     6  1.590e-02 2.651e-03
    3   1 -      -2.436975259478 -1.613e-05  1.592e-03    6     6  1.590e-02 2.651e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.500e-05,2.160e-04,1.989e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.072e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=1.988e-03 t_reduction=1.960e-04 tot=2.400e-03 ---
 sigma counter=180 i=0 t=2.430e-04 per=1.222e+01 cost=2.582e+03 flops=1.063e+07
 sigma counter=180 i=1 t=2.460e-04 per=1.237e+01 cost=2.572e+03 flops=1.046e+07
 sigma counter=180 i=2 t=2.440e-04 per=1.227e+01 cost=3.754e+03 flops=1.539e+07
 sigma counter=180 i=3 t=2.440e-04 per=1.227e+01 cost=3.774e+03 flops=1.547e+07
 sigma counter=180 i=4 t=2.480e-04 per=1.247e+01 cost=4.112e+03 flops=1.658e+07
 sigma counter=180 i=5 t=2.500e-04 per=1.258e+01 cost=4.132e+03 flops=1.653e+07
 sigma counter=180 i=6 t=2.600e-04 per=1.308e+01 cost=1.014e+04 flops=3.902e+07
 sigma counter=180 i=7 t=2.530e-04 per=1.273e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.073e+07
--- TIMING FOR sigma_tot : t_inter=3.835e-02 t_gemm=3.558e-01 t_reduction=3.550e-02 tot=4.297e-01 ---
 sigma_tot counter=180 i=0 t=4.394e-02 per=1.235e+01 cost=4.818e+05 flops=1.097e+07
 sigma_tot counter=180 i=1 t=4.444e-02 per=1.249e+01 cost=4.881e+05 flops=1.098e+07
 sigma_tot counter=180 i=2 t=4.352e-02 per=1.223e+01 cost=5.470e+05 flops=1.257e+07
 sigma_tot counter=180 i=3 t=4.337e-02 per=1.219e+01 cost=5.543e+05 flops=1.278e+07
 sigma_tot counter=180 i=4 t=4.462e-02 per=1.254e+01 cost=1.029e+06 flops=2.307e+07
 sigma_tot counter=180 i=5 t=4.488e-02 per=1.261e+01 cost=1.032e+06 flops=2.299e+07
 sigma_tot counter=180 i=6 t=4.627e-02 per=1.300e+01 cost=1.208e+06 flops=2.610e+07
 sigma_tot counter=180 i=7 t=4.480e-02 per=1.259e+01 cost=1.202e+06 flops=2.683e+07
 total GEMM cost=6.542e+06 flops=1.839e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.000e-05,2.100e-04,2.015e-03,1.980e-04 cost=4.121e+04 flops[gemm]=2.045e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=2.014e-03 t_reduction=1.980e-04 tot=2.422e-03 ---
 sigma counter=181 i=0 t=2.390e-04 per=1.187e+01 cost=2.582e+03 flops=1.080e+07
 sigma counter=181 i=1 t=2.370e-04 per=1.177e+01 cost=2.572e+03 flops=1.085e+07
 sigma counter=181 i=2 t=2.530e-04 per=1.256e+01 cost=3.754e+03 flops=1.484e+07
 sigma counter=181 i=3 t=2.490e-04 per=1.236e+01 cost=3.774e+03 flops=1.516e+07
 sigma counter=181 i=4 t=2.540e-04 per=1.261e+01 cost=4.112e+03 flops=1.619e+07
 sigma counter=181 i=5 t=2.560e-04 per=1.271e+01 cost=4.132e+03 flops=1.614e+07
 sigma counter=181 i=6 t=2.640e-04 per=1.311e+01 cost=1.014e+04 flops=3.842e+07
 sigma counter=181 i=7 t=2.620e-04 per=1.301e+01 cost=1.014e+04 flops=3.872e+07
 total GEMM cost=4.121e+04 flops=2.046e+07
--- TIMING FOR sigma_tot : t_inter=3.856e-02 t_gemm=3.578e-01 t_reduction=3.570e-02 tot=4.321e-01 ---
 sigma_tot counter=181 i=0 t=4.418e-02 per=1.235e+01 cost=4.843e+05 flops=1.096e+07
 sigma_tot counter=181 i=1 t=4.468e-02 per=1.249e+01 cost=4.907e+05 flops=1.098e+07
 sigma_tot counter=181 i=2 t=4.377e-02 per=1.223e+01 cost=5.507e+05 flops=1.258e+07
 sigma_tot counter=181 i=3 t=4.362e-02 per=1.219e+01 cost=5.580e+05 flops=1.279e+07
 sigma_tot counter=181 i=4 t=4.487e-02 per=1.254e+01 cost=1.033e+06 flops=2.303e+07
 sigma_tot counter=181 i=5 t=4.513e-02 per=1.261e+01 cost=1.036e+06 flops=2.295e+07
 sigma_tot counter=181 i=6 t=4.653e-02 per=1.300e+01 cost=1.218e+06 flops=2.617e+07
 sigma_tot counter=181 i=7 t=4.506e-02 per=1.259e+01 cost=1.212e+06 flops=2.690e+07
 total GEMM cost=6.583e+06 flops=1.840e+07
    4   0 -      -2.654515665767 -6.763e-06  1.294e-03    6     8  2.115e-02 2.644e-03
    4   1 -      -2.436977069548 -1.810e-06  5.993e-04    6     8  2.115e-02 2.644e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.200e-04,1.998e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.063e+07
--- TIMING FOR sigma : t_inter=2.200e-04 t_gemm=1.997e-03 t_reduction=1.960e-04 tot=2.413e-03 ---
 sigma counter=182 i=0 t=2.420e-04 per=1.212e+01 cost=2.582e+03 flops=1.067e+07
 sigma counter=182 i=1 t=2.470e-04 per=1.237e+01 cost=2.572e+03 flops=1.041e+07
 sigma counter=182 i=2 t=2.430e-04 per=1.217e+01 cost=3.754e+03 flops=1.545e+07
 sigma counter=182 i=3 t=2.480e-04 per=1.242e+01 cost=3.774e+03 flops=1.522e+07
 sigma counter=182 i=4 t=2.490e-04 per=1.247e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=182 i=5 t=2.530e-04 per=1.267e+01 cost=4.132e+03 flops=1.633e+07
 sigma counter=182 i=6 t=2.620e-04 per=1.312e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=182 i=7 t=2.530e-04 per=1.267e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.064e+07
--- TIMING FOR sigma_tot : t_inter=3.878e-02 t_gemm=3.598e-01 t_reduction=3.590e-02 tot=4.345e-01 ---
 sigma_tot counter=182 i=0 t=4.442e-02 per=1.234e+01 cost=4.869e+05 flops=1.096e+07
 sigma_tot counter=182 i=1 t=4.493e-02 per=1.249e+01 cost=4.933e+05 flops=1.098e+07
 sigma_tot counter=182 i=2 t=4.401e-02 per=1.223e+01 cost=5.545e+05 flops=1.260e+07
 sigma_tot counter=182 i=3 t=4.386e-02 per=1.219e+01 cost=5.618e+05 flops=1.281e+07
 sigma_tot counter=182 i=4 t=4.512e-02 per=1.254e+01 cost=1.037e+06 flops=2.299e+07
 sigma_tot counter=182 i=5 t=4.539e-02 per=1.261e+01 cost=1.040e+06 flops=2.291e+07
 sigma_tot counter=182 i=6 t=4.679e-02 per=1.300e+01 cost=1.228e+06 flops=2.624e+07
 sigma_tot counter=182 i=7 t=4.532e-02 per=1.259e+01 cost=1.223e+06 flops=2.698e+07
 total GEMM cost=6.624e+06 flops=1.841e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.170e-04,2.017e-03,2.020e-04 cost=4.121e+04 flops[gemm]=2.043e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=2.017e-03 t_reduction=2.020e-04 tot=2.435e-03 ---
 sigma counter=183 i=0 t=2.350e-04 per=1.165e+01 cost=2.582e+03 flops=1.099e+07
 sigma counter=183 i=1 t=2.380e-04 per=1.180e+01 cost=2.572e+03 flops=1.081e+07
 sigma counter=183 i=2 t=2.490e-04 per=1.235e+01 cost=3.754e+03 flops=1.508e+07
 sigma counter=183 i=3 t=2.500e-04 per=1.239e+01 cost=3.774e+03 flops=1.510e+07
 sigma counter=183 i=4 t=2.520e-04 per=1.249e+01 cost=4.112e+03 flops=1.632e+07
 sigma counter=183 i=5 t=2.630e-04 per=1.304e+01 cost=4.132e+03 flops=1.571e+07
 sigma counter=183 i=6 t=2.680e-04 per=1.329e+01 cost=1.014e+04 flops=3.785e+07
 sigma counter=183 i=7 t=2.620e-04 per=1.299e+01 cost=1.014e+04 flops=3.872e+07
 total GEMM cost=4.121e+04 flops=2.043e+07
--- TIMING FOR sigma_tot : t_inter=3.900e-02 t_gemm=3.619e-01 t_reduction=3.610e-02 tot=4.369e-01 ---
 sigma_tot counter=183 i=0 t=4.465e-02 per=1.234e+01 cost=4.895e+05 flops=1.096e+07
 sigma_tot counter=183 i=1 t=4.517e-02 per=1.248e+01 cost=4.959e+05 flops=1.098e+07
 sigma_tot counter=183 i=2 t=4.426e-02 per=1.223e+01 cost=5.582e+05 flops=1.261e+07
 sigma_tot counter=183 i=3 t=4.411e-02 per=1.219e+01 cost=5.656e+05 flops=1.282e+07
 sigma_tot counter=183 i=4 t=4.537e-02 per=1.254e+01 cost=1.041e+06 flops=2.295e+07
 sigma_tot counter=183 i=5 t=4.565e-02 per=1.262e+01 cost=1.044e+06 flops=2.287e+07
 sigma_tot counter=183 i=6 t=4.706e-02 per=1.301e+01 cost=1.238e+06 flops=2.631e+07
 sigma_tot counter=183 i=7 t=4.558e-02 per=1.260e+01 cost=1.233e+06 flops=2.704e+07
 total GEMM cost=6.666e+06 flops=1.842e+07
    5   0 -      -2.654516771324 -1.106e-06  5.133e-04    6    10  2.642e-02 2.642e-03
    5   1 -      -2.436977368102 -2.986e-07  2.915e-04    6    10  2.642e-02 2.642e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.270e-04,2.004e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.057e+07
--- TIMING FOR sigma : t_inter=2.270e-04 t_gemm=2.003e-03 t_reduction=1.960e-04 tot=2.426e-03 ---
 sigma counter=184 i=0 t=2.450e-04 per=1.223e+01 cost=2.582e+03 flops=1.054e+07
 sigma counter=184 i=1 t=2.420e-04 per=1.208e+01 cost=2.572e+03 flops=1.063e+07
 sigma counter=184 i=2 t=2.480e-04 per=1.238e+01 cost=3.754e+03 flops=1.514e+07
 sigma counter=184 i=3 t=2.460e-04 per=1.228e+01 cost=3.774e+03 flops=1.534e+07
 sigma counter=184 i=4 t=2.510e-04 per=1.253e+01 cost=4.112e+03 flops=1.638e+07
 sigma counter=184 i=5 t=2.510e-04 per=1.253e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=184 i=6 t=2.650e-04 per=1.323e+01 cost=1.014e+04 flops=3.828e+07
 sigma counter=184 i=7 t=2.550e-04 per=1.273e+01 cost=1.014e+04 flops=3.978e+07
 total GEMM cost=4.121e+04 flops=2.058e+07
--- TIMING FOR sigma_tot : t_inter=3.922e-02 t_gemm=3.639e-01 t_reduction=3.630e-02 tot=4.394e-01 ---
 sigma_tot counter=184 i=0 t=4.490e-02 per=1.234e+01 cost=4.921e+05 flops=1.096e+07
 sigma_tot counter=184 i=1 t=4.541e-02 per=1.248e+01 cost=4.984e+05 flops=1.098e+07
 sigma_tot counter=184 i=2 t=4.451e-02 per=1.223e+01 cost=5.620e+05 flops=1.263e+07
 sigma_tot counter=184 i=3 t=4.436e-02 per=1.219e+01 cost=5.694e+05 flops=1.284e+07
 sigma_tot counter=184 i=4 t=4.562e-02 per=1.254e+01 cost=1.046e+06 flops=2.292e+07
 sigma_tot counter=184 i=5 t=4.590e-02 per=1.261e+01 cost=1.048e+06 flops=2.284e+07
 sigma_tot counter=184 i=6 t=4.732e-02 per=1.301e+01 cost=1.248e+06 flops=2.638e+07
 sigma_tot counter=184 i=7 t=4.583e-02 per=1.260e+01 cost=1.243e+06 flops=2.712e+07
 total GEMM cost=6.707e+06 flops=1.843e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.070e-04,2.000e-03,1.980e-04 cost=4.121e+04 flops[gemm]=2.061e+07
--- TIMING FOR sigma : t_inter=2.070e-04 t_gemm=2.000e-03 t_reduction=1.980e-04 tot=2.405e-03 ---
 sigma counter=185 i=0 t=2.420e-04 per=1.210e+01 cost=2.582e+03 flops=1.067e+07
 sigma counter=185 i=1 t=2.380e-04 per=1.190e+01 cost=2.572e+03 flops=1.081e+07
 sigma counter=185 i=2 t=2.560e-04 per=1.280e+01 cost=3.754e+03 flops=1.466e+07
 sigma counter=185 i=3 t=2.460e-04 per=1.230e+01 cost=3.774e+03 flops=1.534e+07
 sigma counter=185 i=4 t=2.500e-04 per=1.250e+01 cost=4.112e+03 flops=1.645e+07
 sigma counter=185 i=5 t=2.520e-04 per=1.260e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=185 i=6 t=2.620e-04 per=1.310e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=185 i=7 t=2.540e-04 per=1.270e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.061e+07
--- TIMING FOR sigma_tot : t_inter=3.943e-02 t_gemm=3.659e-01 t_reduction=3.649e-02 tot=4.418e-01 ---
 sigma_tot counter=185 i=0 t=4.514e-02 per=1.234e+01 cost=4.947e+05 flops=1.096e+07
 sigma_tot counter=185 i=1 t=4.565e-02 per=1.248e+01 cost=5.010e+05 flops=1.098e+07
 sigma_tot counter=185 i=2 t=4.477e-02 per=1.224e+01 cost=5.657e+05 flops=1.264e+07
 sigma_tot counter=185 i=3 t=4.461e-02 per=1.219e+01 cost=5.731e+05 flops=1.285e+07
 sigma_tot counter=185 i=4 t=4.587e-02 per=1.254e+01 cost=1.050e+06 flops=2.288e+07
 sigma_tot counter=185 i=5 t=4.615e-02 per=1.261e+01 cost=1.052e+06 flops=2.280e+07
 sigma_tot counter=185 i=6 t=4.759e-02 per=1.301e+01 cost=1.258e+06 flops=2.644e+07
 sigma_tot counter=185 i=7 t=4.609e-02 per=1.260e+01 cost=1.253e+06 flops=2.719e+07
 total GEMM cost=6.748e+06 flops=1.844e+07
    6   0 -      -2.654516945140 -1.738e-07  1.835e-04    6    12  3.169e-02 2.641e-03
    6   1 -      -2.436977443846 -7.574e-08  1.163e-04    6    12  3.169e-02 2.641e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.190e-04,2.026e-03,1.970e-04 cost=4.121e+04 flops[gemm]=2.034e+07
--- TIMING FOR sigma : t_inter=2.190e-04 t_gemm=2.025e-03 t_reduction=1.970e-04 tot=2.441e-03 ---
 sigma counter=186 i=0 t=2.420e-04 per=1.195e+01 cost=2.582e+03 flops=1.067e+07
 sigma counter=186 i=1 t=2.420e-04 per=1.195e+01 cost=2.572e+03 flops=1.063e+07
 sigma counter=186 i=2 t=2.530e-04 per=1.249e+01 cost=3.754e+03 flops=1.484e+07
 sigma counter=186 i=3 t=2.540e-04 per=1.254e+01 cost=3.774e+03 flops=1.486e+07
 sigma counter=186 i=4 t=2.550e-04 per=1.259e+01 cost=4.112e+03 flops=1.613e+07
 sigma counter=186 i=5 t=2.560e-04 per=1.264e+01 cost=4.132e+03 flops=1.614e+07
 sigma counter=186 i=6 t=2.680e-04 per=1.323e+01 cost=1.014e+04 flops=3.785e+07
 sigma counter=186 i=7 t=2.550e-04 per=1.259e+01 cost=1.014e+04 flops=3.978e+07
 total GEMM cost=4.121e+04 flops=2.035e+07
--- TIMING FOR sigma_tot : t_inter=3.965e-02 t_gemm=3.679e-01 t_reduction=3.669e-02 tot=4.442e-01 ---
 sigma_tot counter=186 i=0 t=4.538e-02 per=1.234e+01 cost=4.973e+05 flops=1.096e+07
 sigma_tot counter=186 i=1 t=4.589e-02 per=1.247e+01 cost=5.036e+05 flops=1.097e+07
 sigma_tot counter=186 i=2 t=4.502e-02 per=1.224e+01 cost=5.695e+05 flops=1.265e+07
 sigma_tot counter=186 i=3 t=4.486e-02 per=1.219e+01 cost=5.769e+05 flops=1.286e+07
 sigma_tot counter=186 i=4 t=4.613e-02 per=1.254e+01 cost=1.054e+06 flops=2.285e+07
 sigma_tot counter=186 i=5 t=4.641e-02 per=1.262e+01 cost=1.057e+06 flops=2.277e+07
 sigma_tot counter=186 i=6 t=4.785e-02 per=1.301e+01 cost=1.269e+06 flops=2.651e+07
 sigma_tot counter=186 i=7 t=4.634e-02 per=1.260e+01 cost=1.263e+06 flops=2.726e+07
 total GEMM cost=6.789e+06 flops=1.845e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.130e-04,1.994e-03,1.970e-04 cost=4.121e+04 flops[gemm]=2.067e+07
--- TIMING FOR sigma : t_inter=2.130e-04 t_gemm=1.993e-03 t_reduction=1.970e-04 tot=2.403e-03 ---
 sigma counter=187 i=0 t=2.380e-04 per=1.194e+01 cost=2.582e+03 flops=1.085e+07
 sigma counter=187 i=1 t=2.450e-04 per=1.229e+01 cost=2.572e+03 flops=1.050e+07
 sigma counter=187 i=2 t=2.450e-04 per=1.229e+01 cost=3.754e+03 flops=1.532e+07
 sigma counter=187 i=3 t=2.500e-04 per=1.254e+01 cost=3.774e+03 flops=1.510e+07
 sigma counter=187 i=4 t=2.490e-04 per=1.249e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=187 i=5 t=2.510e-04 per=1.259e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=187 i=6 t=2.610e-04 per=1.310e+01 cost=1.014e+04 flops=3.887e+07
 sigma counter=187 i=7 t=2.540e-04 per=1.274e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.068e+07
--- TIMING FOR sigma_tot : t_inter=3.986e-02 t_gemm=3.699e-01 t_reduction=3.689e-02 tot=4.466e-01 ---
 sigma_tot counter=187 i=0 t=4.562e-02 per=1.233e+01 cost=4.998e+05 flops=1.096e+07
 sigma_tot counter=187 i=1 t=4.613e-02 per=1.247e+01 cost=5.061e+05 flops=1.097e+07
 sigma_tot counter=187 i=2 t=4.526e-02 per=1.224e+01 cost=5.732e+05 flops=1.266e+07
 sigma_tot counter=187 i=3 t=4.511e-02 per=1.220e+01 cost=5.807e+05 flops=1.287e+07
 sigma_tot counter=187 i=4 t=4.638e-02 per=1.254e+01 cost=1.058e+06 flops=2.281e+07
 sigma_tot counter=187 i=5 t=4.666e-02 per=1.261e+01 cost=1.061e+06 flops=2.273e+07
 sigma_tot counter=187 i=6 t=4.812e-02 per=1.301e+01 cost=1.279e+06 flops=2.657e+07
 sigma_tot counter=187 i=7 t=4.660e-02 per=1.260e+01 cost=1.273e+06 flops=2.732e+07
 total GEMM cost=6.830e+06 flops=1.847e+07
    7   0 +      -2.654516966643 -2.150e-08  4.639e-05    6    14  3.697e-02 2.641e-03
    7   1 +      -2.436977450693 -6.847e-09  2.690e-05    6    14  3.697e-02 2.641e-03
TIMING FOR Davidson : 3.699e-02  T(cal/comm/rest)=3.639e-02,4.938e-05,5.468e-04
optimized energies: isweep=4 dots=2 ibond=2 e[0]=-2.65451696664 nmvp=14
optimized energies: isweep=4 dots=2 ibond=2 e[1]=-2.43697745069 nmvp=14
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=9 alg_decim=1 mpisize=2 maxthreads=2
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
TIMING FOR decimation: 4.0e-04 S T(wf/decim)=3.2e-04,7.4e-05
ctns::oper_renorm coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=872:6.7e-03MB:6.5e-06GB
rank=0 GPUmem(GB): used=2.3e-05 (oper)=8.7e-06
rank=0 GPUmem(GB): used=2.3e-05 (oper,site)(GB)=8.7e-06,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 5.792e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=2.29e-05 (oper,site,rinter)=8.67e-06,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000973 S size(rtasks)=37 size(Rlst2)=9 T(Rmu/Rlist)=0.000202,0.00077 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00105 S size(rtasks)=37 size(Rlst)=788 -----
rank=0 GPUmem(GB): used=0.000217 (oper,site,rinter,batch)=8.67e-06,2.68e-07,0,0.000194 blksize=16 blksize0=0 batchsize=788
timing: allocate=3.58e-05 rmmtasks init=0.000919 total=0.000954
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=5e-06,0.00118,0.000198 cost=1.56e+04 flops[gemm]=1.32e+07
--- TIMING FOR renorm : t_inter=5e-06 t_gemm=0.00118 t_reduction=0.000198 tot=0.00138 ---
 renorm counter=19 i=0 t=0.000235 per=19.9 cost=874 flops=3.72e+06
 renorm counter=19 i=1 t=0.000232 per=19.6 cost=1.76e+03 flops=7.59e+06
 renorm counter=19 i=2 t=0.000226 per=19.1 cost=994 flops=4.4e+06
 renorm counter=19 i=3 t=0.000229 per=19.4 cost=1.75e+03 flops=7.64e+06
 renorm counter=19 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=19 i=5 t=1e-06 per=0.0846 cost=0 flops=0
 renorm counter=19 i=6 t=0.000259 per=21.9 cost=1.02e+04 flops=3.93e+07
 total GEMM cost=1.56e+04 flops=1.32e+07
--- TIMING FOR renorm_tot : t_inter=0.00193 t_gemm=0.022 t_reduction=0.00382 tot=0.0277 ---
 renorm_tot counter=19 i=0 t=0.00442 per=20.1 cost=4e+04 flops=9.05e+06
 renorm_tot counter=19 i=1 t=0.00433 per=19.7 cost=5.88e+04 flops=1.36e+07
 renorm_tot counter=19 i=2 t=0.002 per=9.08 cost=3.5e+04 flops=1.75e+07
 renorm_tot counter=19 i=3 t=0.00202 per=9.2 cost=6.05e+04 flops=2.99e+07
 renorm_tot counter=19 i=4 t=0.00224 per=10.2 cost=4.63e+04 flops=2.07e+07
 renorm_tot counter=19 i=5 t=0.00228 per=10.4 cost=8.09e+04 flops=3.55e+07
 renorm_tot counter=19 i=6 t=0.0047 per=21.4 cost=5.01e+05 flops=1.07e+08
 total GEMM cost=8.23e+05 flops=3.74e+07
timing: gpu2cpu=1.49e-05 deallocate(site/work)=2.76e-06,5.4e-06 total=2.03e-05
check ||H-H.dagger||=0.000e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.00475 S T(init/kernel/comm)=0.000436,0.00425,6.51e-05 rank=0 -----
TIMING FOR cleanup: 0.000327 T(erase/save/remove)=9.57e-05,0.000194,3.71e-05
##### local: 5.298e-02 S #####
 T(local: fetch) = 1.415e-04 S  per = 0.267  per(accum) = 0.267
 T(local: hdiag) = 5.213e-04 S  per = 0.984  per(accum) = 1.25
 T(local: dvdsn) = 4.608e-02 S  per =   87  per(accum) = 88.2
 T(local: decim) = 4.906e-04 S  per = 0.926  per(accum) = 89.2
 T(local: guess) = 5.059e-04 S  per = 0.955  per(accum) = 90.1
 T(local: renrm) = 4.898e-03 S  per = 9.25  per(accum) = 99.4
 T(local: save ) = 3.407e-04 S  per = 0.643  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.500e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 1.772e-05 S  per = 0.0394  per(accum) = 0.0394
 T(local: symbolic_formulae_twodot     ) = 6.436e-04 S  per = 1.43  per(accum) = 1.47
 T(local: hintermediate init           ) = 5.631e-05 S  per = 0.125  per(accum) = 1.59
 T(local: hintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 6.22e-05  per(accum) = 1.59
 T(local: preprocess_hformulae_Hxlist2 ) = 3.674e-03 S  per = 8.16  per(accum) = 9.76
 T(local: hmmtasks init                ) = 3.619e-03 S  per = 8.04  per(accum) = 17.8
 T(local: dvdson solver [Hx_batchGPU]  ) = 3.639e-02 S  per = 80.9  per(accum) = 98.7
 T(local: dvdson solver [communication]) = 4.938e-05 S  per = 0.11  per(accum) = 98.8
 T(local: dvdson solver [rest part]    ) = 5.468e-04 S  per = 1.22  per(accum) = 100
Detailed decomposition of T(renrm): 4.751e-03 S
 T(local: qops init                    ) = 4.358e-04 S  per = 9.17  per(accum) = 9.17
 T(local: qops_dict memcpy cpu2gpu     ) = 3.875e-05 S  per = 0.816  per(accum) = 9.99
 T(local: symbolic_formulae_renorm     ) = 5.885e-04 S  per = 12.4  per(accum) = 22.4
 T(local: rintermediate init           ) = 2.870e-05 S  per = 0.604  per(accum) = 23
 T(local: rintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 0.00061  per(accum) = 23
 T(local: preprocess_formulae_Rlist2   ) = 1.073e-03 S  per = 22.6  per(accum) = 45.6
 T(local: rmmtasks init                ) = 9.634e-04 S  per = 20.3  per(accum) = 65.8
 T(local: qops memset                  ) = 2.800e-08 S  per = 0.000589  per(accum) = 65.8
 T(local: preprocess_renorm_batchGPU   ) = 1.503e-03 S  per = 31.6  per(accum) = 97.5
 T(local: qops memcpy gpu2cpu          ) = 1.502e-05 S  per = 0.316  per(accum) = 97.8
 T(local: deallocate gpu memory        ) = 3.959e-05 S  per = 0.833  per(accum) = 98.6
 T(local: communication of opS and opH ) = 6.511e-05 S  per = 1.37  per(accum) = 100
##### sweep: 1.275e-01 S #####
 T(sweep: fetch) = 1.340e-03 S  per = 1.05  per(accum) = 1.05
 T(sweep: hdiag) = 1.611e-03 S  per = 1.26  per(accum) = 2.31
 T(sweep: dvdsn) = 1.050e-01 S  per = 82.3  per(accum) = 84.7
 T(sweep: decim) = 2.107e-03 S  per = 1.65  per(accum) = 86.3
 T(sweep: guess) = 1.431e-03 S  per = 1.12  per(accum) = 87.4
 T(sweep: renrm) = 1.511e-02 S  per = 11.9  per(accum) = 99.3
 T(sweep: save ) = 9.183e-04 S  per = 0.72  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.016e-01 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 3.571e-05 S  per = 0.0351  per(accum) = 0.0351
 T(sweep: symbolic_formulae_twodot     ) = 2.006e-03 S  per = 1.97  per(accum) = 2.01
 T(sweep: hintermediate init           ) = 1.748e-04 S  per = 0.172  per(accum) = 2.18
 T(sweep: hintermediates memcpy cpu2gpu) = 8.700e-08 S  per = 8.56e-05  per(accum) = 2.18
 T(sweep: preprocess_hformulae_Hxlist2 ) = 1.131e-02 S  per = 11.1  per(accum) = 13.3
 T(sweep: hmmtasks init                ) = 1.110e-02 S  per = 10.9  per(accum) = 24.2
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 7.573e-02 S  per = 74.5  per(accum) = 98.7
 T(sweep: dvdson solver [communication]) = 1.021e-04 S  per =  0.1  per(accum) = 98.8
 T(sweep: dvdson solver [rest part]    ) = 1.171e-03 S  per = 1.15  per(accum) = 100
Detailed decomposition of T(renrm): 1.465e-02 S
 T(sweep: qops init                    ) = 1.191e-03 S  per = 8.13  per(accum) = 8.13
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.215e-04 S  per = 0.829  per(accum) = 8.96
 T(sweep: symbolic_formulae_renorm     ) = 1.663e-03 S  per = 11.3  per(accum) = 20.3
 T(sweep: rintermediate init           ) = 1.163e-04 S  per = 0.794  per(accum) = 21.1
 T(sweep: rintermediates memcpy cpu2gpu) = 8.800e-08 S  per = 0.000601  per(accum) = 21.1
 T(sweep: preprocess_formulae_Rlist2   ) = 3.288e-03 S  per = 22.4  per(accum) = 43.5
 T(sweep: rmmtasks init                ) = 3.216e-03 S  per = 21.9  per(accum) = 65.5
 T(sweep: qops memset                  ) = 8.200e-08 S  per = 0.00056  per(accum) = 65.5
 T(sweep: preprocess_renorm_batchGPU   ) = 4.705e-03 S  per = 32.1  per(accum) = 97.6
 T(sweep: qops memcpy gpu2cpu          ) = 4.689e-05 S  per = 0.32  per(accum) = 97.9
 T(sweep: deallocate gpu memory        ) = 1.132e-04 S  per = 0.772  per(accum) = 98.7
 T(sweep: communication of opS and opH ) = 1.917e-04 S  per = 1.31  per(accum) = 100
##### global: 8.022e-01 S #####
 T(global: fetch) = 1.263e-02 S  per = 1.57  per(accum) = 1.57
 T(global: hdiag) = 1.042e-02 S  per =  1.3  per(accum) = 2.87
 T(global: dvdsn) = 6.573e-01 S  per = 81.9  per(accum) = 84.8
 T(global: decim) = 1.637e-02 S  per = 2.04  per(accum) = 86.8
 T(global: guess) = 8.320e-03 S  per = 1.04  per(accum) = 87.9
 T(global: renrm) = 9.165e-02 S  per = 11.4  per(accum) = 99.3
 T(global: save ) = 5.552e-03 S  per = 0.692  per(accum) = 100
Detailed decomposition of T(dvdsn): 6.370e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 2.066e-04 S  per = 0.0324  per(accum) = 0.0324
 T(global: symbolic_formulae_twodot     ) = 1.261e-02 S  per = 1.98  per(accum) = 2.01
 T(global: hintermediate init           ) = 1.113e-03 S  per = 0.175  per(accum) = 2.19
 T(global: hintermediates memcpy cpu2gpu) = 5.580e-07 S  per = 8.76e-05  per(accum) = 2.19
 T(global: preprocess_hformulae_Hxlist2 ) = 6.733e-02 S  per = 10.6  per(accum) = 12.8
 T(global: hmmtasks init                ) = 6.645e-02 S  per = 10.4  per(accum) = 23.2
 T(global: dvdson solver [Hx_batchGPU]  ) = 4.808e-01 S  per = 75.5  per(accum) = 98.7
 T(global: dvdson solver [communication]) = 6.626e-04 S  per = 0.104  per(accum) = 98.8
 T(global: dvdson solver [rest part]    ) = 7.870e-03 S  per = 1.24  per(accum) = 100
Detailed decomposition of T(renrm): 8.883e-02 S
 T(global: qops init                    ) = 6.800e-03 S  per = 7.66  per(accum) = 7.66
 T(global: qops_dict memcpy cpu2gpu     ) = 7.970e-04 S  per = 0.897  per(accum) = 8.55
 T(global: symbolic_formulae_renorm     ) = 1.026e-02 S  per = 11.6  per(accum) = 20.1
 T(global: rintermediate init           ) = 8.640e-04 S  per = 0.973  per(accum) = 21.1
 T(global: rintermediates memcpy cpu2gpu) = 5.430e-07 S  per = 0.000611  per(accum) = 21.1
 T(global: preprocess_formulae_Rlist2   ) = 1.934e-02 S  per = 21.8  per(accum) = 42.9
 T(global: rmmtasks init                ) = 1.854e-02 S  per = 20.9  per(accum) = 63.7
 T(global: qops memset                  ) = 5.310e-07 S  per = 0.000598  per(accum) = 63.7
 T(global: preprocess_renorm_batchGPU   ) = 3.000e-02 S  per = 33.8  per(accum) = 97.5
 T(global: qops memcpy gpu2cpu          ) = 2.940e-04 S  per = 0.331  per(accum) = 97.8
 T(global: deallocate gpu memory        ) = 7.081e-04 S  per = 0.797  per(accum) = 98.6
 T(global: communication of opS and opH ) = 1.208e-03 S  per = 1.36  per(accum) = 100

isweep=4 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=872:0.00665MB:6.5e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1310:0.00999MB:9.76e-06GB
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44c0e9c0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
### DIAG TIMING: total=0.00036 t1=7.31e-06, t2=1.41e-05, t3=4.83e-05, t4=0.000184, t5=6.18e-05, t6=2.88e-05, t7=1.28e-05, t8=2.59e-06
duration_diagGPU:0.000374
duration_diagreduce:4.28e-06
duration_diagtransform:1.76e-06
rank=0 GPUmem(GB): used=9.76e-06 (oper)=9.76e-06
----- TIMING FOR symbolic_formulae_twodot with size=93 : 6.363e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=93
 no. of hintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.871e-05 S -----
rank=0 GPUmem(GB): used=1.01e-05 (oper,hinter)=9.76e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00338 S size(H_formulae)=93 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000181,0.0032 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00365 S size(H_formulae)=93 size(Hxlst)=3134 -----
rank=0 GPUmem(GB): used=0.000409 (oper,hinter,dvdson,batch)=9.76e-06,2.98e-07,1.49e-06,0.000397 blksize=4 blksize0=8 batchsize=3134
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=3.2e-05,0.00022,0.00208,0.000198 cost=4.22e+04 flops[gemm]=2.03e+07
--- TIMING FOR sigma : t_inter=0.00022 t_gemm=0.00208 t_reduction=0.000198 tot=0.00249 ---
 sigma counter=188 i=0 t=0.000265 per=12.8 cost=3.72e+03 flops=1.4e+07
 sigma counter=188 i=1 t=0.000256 per=12.3 cost=3.74e+03 flops=1.46e+07
 sigma counter=188 i=2 t=0.000248 per=12 cost=3.04e+03 flops=1.22e+07
 sigma counter=188 i=3 t=0.000243 per=11.7 cost=3.03e+03 flops=1.25e+07
 sigma counter=188 i=4 t=0.000266 per=12.8 cost=1e+04 flops=3.76e+07
 sigma counter=188 i=5 t=0.000268 per=12.9 cost=1e+04 flops=3.73e+07
 sigma counter=188 i=6 t=0.000278 per=13.4 cost=4.34e+03 flops=1.56e+07
 sigma counter=188 i=7 t=0.000251 per=12.1 cost=4.32e+03 flops=1.72e+07
 total GEMM cost=4.22e+04 flops=2.03e+07
--- TIMING FOR sigma_tot : t_inter=0.0401 t_gemm=0.372 t_reduction=0.0371 tot=0.449 ---
 sigma_tot counter=188 i=0 t=0.0459 per=12.3 cost=5.04e+05 flops=1.1e+07
 sigma_tot counter=188 i=1 t=0.0464 per=12.5 cost=5.1e+05 flops=1.1e+07
 sigma_tot counter=188 i=2 t=0.0455 per=12.2 cost=5.76e+05 flops=1.27e+07
 sigma_tot counter=188 i=3 t=0.0454 per=12.2 cost=5.84e+05 flops=1.29e+07
 sigma_tot counter=188 i=4 t=0.0466 per=12.5 cost=1.07e+06 flops=2.29e+07
 sigma_tot counter=188 i=5 t=0.0469 per=12.6 cost=1.07e+06 flops=2.28e+07
 sigma_tot counter=188 i=6 t=0.0484 per=13 cost=1.28e+06 flops=2.65e+07
 sigma_tot counter=188 i=7 t=0.0468 per=12.6 cost=1.28e+06 flops=2.73e+07
 total GEMM cost=6.87e+06 flops=1.85e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.1e-05,0.00021,0.00201,0.000195 cost=4.22e+04 flops[gemm]=2.1e+07
--- TIMING FOR sigma : t_inter=0.00021 t_gemm=0.00201 t_reduction=0.000195 tot=0.00242 ---
 sigma counter=189 i=0 t=0.000254 per=12.6 cost=3.72e+03 flops=1.46e+07
 sigma counter=189 i=1 t=0.000257 per=12.8 cost=3.74e+03 flops=1.45e+07
 sigma counter=189 i=2 t=0.00024 per=11.9 cost=3.04e+03 flops=1.26e+07
 sigma counter=189 i=3 t=0.000239 per=11.9 cost=3.03e+03 flops=1.27e+07
 sigma counter=189 i=4 t=0.000254 per=12.6 cost=1e+04 flops=3.94e+07
 sigma counter=189 i=5 t=0.000255 per=12.7 cost=1e+04 flops=3.92e+07
 sigma counter=189 i=6 t=0.000263 per=13.1 cost=4.34e+03 flops=1.65e+07
 sigma counter=189 i=7 t=0.00025 per=12.4 cost=4.32e+03 flops=1.73e+07
 total GEMM cost=4.22e+04 flops=2.1e+07
--- TIMING FOR sigma_tot : t_inter=0.0403 t_gemm=0.374 t_reduction=0.0373 tot=0.452 ---
 sigma_tot counter=189 i=0 t=0.0461 per=12.3 cost=5.07e+05 flops=1.1e+07
 sigma_tot counter=189 i=1 t=0.0466 per=12.5 cost=5.14e+05 flops=1.1e+07
 sigma_tot counter=189 i=2 t=0.0458 per=12.2 cost=5.79e+05 flops=1.27e+07
 sigma_tot counter=189 i=3 t=0.0456 per=12.2 cost=5.87e+05 flops=1.29e+07
 sigma_tot counter=189 i=4 t=0.0469 per=12.5 cost=1.08e+06 flops=2.3e+07
 sigma_tot counter=189 i=5 t=0.0472 per=12.6 cost=1.08e+06 flops=2.29e+07
 sigma_tot counter=189 i=6 t=0.0487 per=13 cost=1.29e+06 flops=2.65e+07
 sigma_tot counter=189 i=7 t=0.0471 per=12.6 cost=1.28e+06 flops=2.72e+07
 total GEMM cost=6.91e+06 flops=1.85e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643 -1.003e+03  4.639e-05    2     2  5.409e-03 2.705e-03
    1   1 +      -2.436977450693 -1.002e+03  2.690e-05    2     2  5.409e-03 2.705e-03
TIMING FOR Davidson : 5.455e-03  T(cal/comm/rest)=5.351e-03,7.770e-06,9.568e-05
optimized energies: isweep=4 dots=2 ibond=3 e[0]=-2.65451696664 nmvp=2
optimized energies: isweep=4 dots=2 ibond=3 e[1]=-2.43697745069 nmvp=2
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=16 alg_decim=1 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep4_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
----- TMING FOR decimation_genbasis: 3.8e-04 S T(scatter/comp/gather)=3.7e-05,3.9e-05,3.1e-04 -----
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
 qbond: qkept nsym=6 dimAll=20
 (3,1):6 (2,0):4 (4,0):3 (2,2):3 (3,-1):2 (1,1):2
----- TIMING for decimation_row: 6.971e-04 S T(decim/formRot)=4.661e-04,2.310e-04 -----
TIMING FOR decimation: 1.073e-03 S T(wf/decim)=3.449e-04,7.279e-04
ctns::oper_renorm coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:6 A:7 B:11 P:3 Q:5 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=1612:1.230e-02MB:1.201e-05GB
rank=0 GPUmem(GB): used=2.207e-05 (oper)=1.960e-05
rank=0 GPUmem(GB): used=2.319e-05 (oper,site)(GB)=1.960e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=37 : 4.687e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 5.038e-05 S -----
rank=0 GPUmem(GB): used=2.35e-05 (oper,site,rinter)=1.96e-05,1.12e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000954 S size(rtasks)=37 size(Rlst2)=6 T(Rmu/Rlist)=0.000158,0.000796 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00104 S size(rtasks)=37 size(Rlst)=821 -----
rank=0 GPUmem(GB): used=0.000519 (oper,site,rinter,batch)=1.96e-05,1.12e-06,2.98e-07,0.000495 blksize=36 blksize0=8 batchsize=821
timing: allocate=3.45e-05 rmmtasks init=0.000989 total=0.00102
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000208,0.00117,0.000199 cost=8.44e+04 flops[gemm]=7.19e+07
--- TIMING FOR renorm : t_inter=0.000208 t_gemm=0.00117 t_reduction=0.000199 tot=0.00158 ---
 renorm counter=20 i=0 t=0.000224 per=19.1 cost=3.06e+03 flops=1.37e+07
 renorm counter=20 i=1 t=0.000234 per=19.9 cost=5.92e+03 flops=2.53e+07
 renorm counter=20 i=2 t=0.000227 per=19.3 cost=9.23e+03 flops=4.07e+07
 renorm counter=20 i=3 t=0.000233 per=19.8 cost=1.58e+04 flops=6.8e+07
 renorm counter=20 i=4 t=1e-06 per=0.0852 cost=0 flops=0
 renorm counter=20 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=20 i=6 t=0.000255 per=21.7 cost=5.03e+04 flops=1.97e+08
 total GEMM cost=8.44e+04 flops=7.19e+07
--- TIMING FOR renorm_tot : t_inter=0.00214 t_gemm=0.0232 t_reduction=0.00402 tot=0.0293 ---
 renorm_tot counter=20 i=0 t=0.00465 per=20.1 cost=4.31e+04 flops=9.27e+06
 renorm_tot counter=20 i=1 t=0.00457 per=19.7 cost=6.47e+04 flops=1.42e+07
 renorm_tot counter=20 i=2 t=0.00222 per=9.6 cost=4.43e+04 flops=1.99e+07
 renorm_tot counter=20 i=3 t=0.00226 per=9.74 cost=7.64e+04 flops=3.39e+07
 renorm_tot counter=20 i=4 t=0.00224 per=9.67 cost=4.63e+04 flops=2.07e+07
 renorm_tot counter=20 i=5 t=0.00228 per=9.83 cost=8.09e+04 flops=3.55e+07
 renorm_tot counter=20 i=6 t=0.00495 per=21.4 cost=5.51e+05 flops=1.11e+08
 total GEMM cost=9.07e+05 flops=3.92e+07
timing: gpu2cpu=1.62e-05 deallocate(site/work)=3.51e-06,6.16e-06 total=2.23e-05
check ||H-H.dagger||=7.187e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00483 S T(init/kernel/comm)=0.000331,0.00444,6.27e-05 rank=0 -----
TIMING FOR cleanup: 0.000185 T(erase/save/remove)=4.3e-06,0.000144,3.59e-05
##### local: 2.337e-02 S #####
 T(local: fetch) = 1.050e-03 S  per = 4.49  per(accum) = 4.49
 T(local: hdiag) = 4.917e-04 S  per =  2.1  per(accum) = 6.6
 T(local: dvdsn) = 1.500e-02 S  per = 64.2  per(accum) = 70.8
 T(local: decim) = 1.213e-03 S  per = 5.19  per(accum) = 76
 T(local: guess) = 4.262e-04 S  per = 1.82  per(accum) = 77.8
 T(local: renrm) = 4.990e-03 S  per = 21.3  per(accum) = 99.2
 T(local: save ) = 1.965e-04 S  per = 0.841  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.383e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 7.866e-06 S  per = 0.0569  per(accum) = 0.0569
 T(local: symbolic_formulae_twodot     ) = 6.465e-04 S  per = 4.68  per(accum) = 4.73
 T(local: hintermediate init           ) = 6.133e-05 S  per = 0.444  per(accum) = 5.18
 T(local: hintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000202  per(accum) = 5.18
 T(local: preprocess_hformulae_Hxlist2 ) = 3.748e-03 S  per = 27.1  per(accum) = 32.3
 T(local: hmmtasks init                ) = 3.910e-03 S  per = 28.3  per(accum) = 60.6
 T(local: dvdson solver [Hx_batchGPU]  ) = 5.351e-03 S  per = 38.7  per(accum) = 99.3
 T(local: dvdson solver [communication]) = 7.770e-06 S  per = 0.0562  per(accum) = 99.3
 T(local: dvdson solver [rest part]    ) = 9.568e-05 S  per = 0.692  per(accum) = 100
Detailed decomposition of T(renrm): 4.832e-03 S
 T(local: qops init                    ) = 3.309e-04 S  per = 6.85  per(accum) = 6.85
 T(local: qops_dict memcpy cpu2gpu     ) = 4.562e-05 S  per = 0.944  per(accum) = 7.79
 T(local: symbolic_formulae_renorm     ) = 4.776e-04 S  per = 9.88  per(accum) = 17.7
 T(local: rintermediate init           ) = 6.252e-05 S  per = 1.29  per(accum) = 19
 T(local: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000579  per(accum) = 19
 T(local: preprocess_formulae_Rlist2   ) = 1.068e-03 S  per = 22.1  per(accum) = 41.1
 T(local: rmmtasks init                ) = 1.033e-03 S  per = 21.4  per(accum) = 62.4
 T(local: qops memset                  ) = 3.100e-08 S  per = 0.000642  per(accum) = 62.4
 T(local: preprocess_renorm_batchGPU   ) = 1.702e-03 S  per = 35.2  per(accum) = 97.7
 T(local: qops memcpy gpu2cpu          ) = 1.625e-05 S  per = 0.336  per(accum) = 98
 T(local: deallocate gpu memory        ) = 3.389e-05 S  per = 0.701  per(accum) = 98.7
 T(local: communication of opS and opH ) = 6.274e-05 S  per =  1.3  per(accum) = 100
##### sweep: 1.509e-01 S #####
 T(sweep: fetch) = 2.390e-03 S  per = 1.58  per(accum) = 1.58
 T(sweep: hdiag) = 2.103e-03 S  per = 1.39  per(accum) = 2.98
 T(sweep: dvdsn) = 1.200e-01 S  per = 79.5  per(accum) = 82.5
 T(sweep: decim) = 3.320e-03 S  per =  2.2  per(accum) = 84.7
 T(sweep: guess) = 1.858e-03 S  per = 1.23  per(accum) = 85.9
 T(sweep: renrm) = 2.010e-02 S  per = 13.3  per(accum) = 99.3
 T(sweep: save ) = 1.115e-03 S  per = 0.739  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.155e-01 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 4.358e-05 S  per = 0.0377  per(accum) = 0.0377
 T(sweep: symbolic_formulae_twodot     ) = 2.652e-03 S  per =  2.3  per(accum) = 2.33
 T(sweep: hintermediate init           ) = 2.362e-04 S  per = 0.205  per(accum) = 2.54
 T(sweep: hintermediates memcpy cpu2gpu) = 1.150e-07 S  per = 9.96e-05  per(accum) = 2.54
 T(sweep: preprocess_hformulae_Hxlist2 ) = 1.506e-02 S  per =   13  per(accum) = 15.6
 T(sweep: hmmtasks init                ) = 1.501e-02 S  per =   13  per(accum) = 28.6
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 8.109e-02 S  per = 70.2  per(accum) = 98.8
 T(sweep: dvdson solver [communication]) = 1.099e-04 S  per = 0.0952  per(accum) = 98.9
 T(sweep: dvdson solver [rest part]    ) = 1.267e-03 S  per =  1.1  per(accum) = 100
Detailed decomposition of T(renrm): 1.949e-02 S
 T(sweep: qops init                    ) = 1.522e-03 S  per = 7.81  per(accum) = 7.81
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.671e-04 S  per = 0.858  per(accum) = 8.67
 T(sweep: symbolic_formulae_renorm     ) = 2.141e-03 S  per =   11  per(accum) = 19.7
 T(sweep: rintermediate init           ) = 1.788e-04 S  per = 0.918  per(accum) = 20.6
 T(sweep: rintermediates memcpy cpu2gpu) = 1.160e-07 S  per = 0.000595  per(accum) = 20.6
 T(sweep: preprocess_formulae_Rlist2   ) = 4.356e-03 S  per = 22.4  per(accum) = 42.9
 T(sweep: rmmtasks init                ) = 4.249e-03 S  per = 21.8  per(accum) = 64.7
 T(sweep: qops memset                  ) = 1.130e-07 S  per = 0.00058  per(accum) = 64.7
 T(sweep: preprocess_renorm_batchGPU   ) = 6.407e-03 S  per = 32.9  per(accum) = 97.6
 T(sweep: qops memcpy gpu2cpu          ) = 6.314e-05 S  per = 0.324  per(accum) = 97.9
 T(sweep: deallocate gpu memory        ) = 1.471e-04 S  per = 0.755  per(accum) = 98.7
 T(sweep: communication of opS and opH ) = 2.544e-04 S  per = 1.31  per(accum) = 100
##### global: 8.256e-01 S #####
 T(global: fetch) = 1.368e-02 S  per = 1.66  per(accum) = 1.66
 T(global: hdiag) = 1.091e-02 S  per = 1.32  per(accum) = 2.98
 T(global: dvdsn) = 6.723e-01 S  per = 81.4  per(accum) = 84.4
 T(global: decim) = 1.758e-02 S  per = 2.13  per(accum) = 86.5
 T(global: guess) = 8.746e-03 S  per = 1.06  per(accum) = 87.6
 T(global: renrm) = 9.664e-02 S  per = 11.7  per(accum) = 99.3
 T(global: save ) = 5.749e-03 S  per = 0.696  per(accum) = 100
Detailed decomposition of T(dvdsn): 6.509e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 2.145e-04 S  per = 0.033  per(accum) = 0.033
 T(global: symbolic_formulae_twodot     ) = 1.326e-02 S  per = 2.04  per(accum) = 2.07
 T(global: hintermediate init           ) = 1.174e-03 S  per = 0.18  per(accum) = 2.25
 T(global: hintermediates memcpy cpu2gpu) = 5.860e-07 S  per = 9e-05  per(accum) = 2.25
 T(global: preprocess_hformulae_Hxlist2 ) = 7.107e-02 S  per = 10.9  per(accum) = 13.2
 T(global: hmmtasks init                ) = 7.036e-02 S  per = 10.8  per(accum) = 24
 T(global: dvdson solver [Hx_batchGPU]  ) = 4.861e-01 S  per = 74.7  per(accum) = 98.7
 T(global: dvdson solver [communication]) = 6.704e-04 S  per = 0.103  per(accum) = 98.8
 T(global: dvdson solver [rest part]    ) = 7.966e-03 S  per = 1.22  per(accum) = 100
Detailed decomposition of T(renrm): 9.366e-02 S
 T(global: qops init                    ) = 7.131e-03 S  per = 7.61  per(accum) = 7.61
 T(global: qops_dict memcpy cpu2gpu     ) = 8.426e-04 S  per =  0.9  per(accum) = 8.51
 T(global: symbolic_formulae_renorm     ) = 1.074e-02 S  per = 11.5  per(accum) = 20
 T(global: rintermediate init           ) = 9.265e-04 S  per = 0.989  per(accum) = 21
 T(global: rintermediates memcpy cpu2gpu) = 5.710e-07 S  per = 0.00061  per(accum) = 21
 T(global: preprocess_formulae_Rlist2   ) = 2.041e-02 S  per = 21.8  per(accum) = 42.8
 T(global: rmmtasks init                ) = 1.958e-02 S  per = 20.9  per(accum) = 63.7
 T(global: qops memset                  ) = 5.620e-07 S  per = 0.0006  per(accum) = 63.7
 T(global: preprocess_renorm_batchGPU   ) = 3.171e-02 S  per = 33.9  per(accum) = 97.5
 T(global: qops memcpy gpu2cpu          ) = 3.102e-04 S  per = 0.331  per(accum) = 97.9
 T(global: deallocate gpu memory        ) = 7.420e-04 S  per = 0.792  per(accum) = 98.6
 T(global: communication of opS and opH ) = 1.271e-03 S  per = 1.36  per(accum) = 100

======================================================================
sweep_data::summary isweep=4
----------------------------------------------------------------------
sweep parameters: isweep=4 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.0516
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.023
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.053
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.0234
 eav_max=-2.54574720706 [ibond=1]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=3]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=1.60474744604e-09
 sweep energies: isweep=4 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[0]=-2.65451696664
 sweep energies: isweep=4 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=4
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.000e-04 1.000e-04 | 51 | 1.940e-01 | 1.940e-01 | 1.116e-02 1.028e-01 1.083e-02 1.248e-01 64.4
            1  2      20 1.000e-04 0.000e+00 | 45 | 1.842e-01 | 3.782e-01 | 2.111e-02 1.958e-01 2.052e-02 2.375e-01 62.8
            2  2      20 1.000e-04 0.000e+00 | 31 | 1.533e-01 | 5.315e-01 | 2.821e-02 2.628e-01 2.744e-02 3.185e-01 59.9
            3  2      20 1.000e-04 0.000e+00 | 31 | 1.538e-01 | 6.852e-01 | 3.531e-02 3.299e-01 3.437e-02 3.996e-01 58.3
            4  2      20 1.000e-04 0.000e+00 | 31 | 1.535e-01 | 8.388e-01 | 4.243e-02 3.971e-01 4.130e-02 4.809e-01 57.3
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.505e-03 e[0]=-2.65208108952 (2.436e-03) e[1]=-2.43068987874 (6.288e-03)
            1      20 +0.000e+00 e[0]=-2.65451696664 (4.013e-12) e[1]=-2.43697745069 (-2.691e-13)
            2      20 +5.258e-04 e[0]=-2.65451696664 (1.776e-15) e[1]=-2.43697745069 (-1.776e-15)
            3      20 +0.000e+00 e[0]=-2.65451696664 (-2.220e-15) e[1]=-2.43697745069 (-3.109e-15)
            4      20 +5.258e-04 e[0]=-2.65451696664 (0.000e+00) e[1]=-2.43697745069 (0.000e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep4.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row_nkr dcut=8 nqr=12 alg_decim=0 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep4_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
----- TMING FOR decimation_genbasis: 5.308e-05 S T(scatter/comp/gather)=6.138e-06,4.301e-05,3.937e-06 -----
decimation summary: 80->8 dwt=-2.220e-16 SvN=1.326e+00
 qbond: qkept nsym=4 dimAll=8
 (3,1):2 (4,0):2 (5,1):2 (4,2):2
----- TIMING for decimation_row: 3.068e-04 S T(decim/formRot)=1.167e-04,1.901e-04 -----

Convert [C]RRR => [cR]RRR:
ctns::decimation_row_nkr dcut=2 nqr=9 alg_decim=0 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep4_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
----- TMING FOR decimation_genbasis: 2.721e-05 S T(scatter/comp/gather)=4.195e-06,2.111e-05,1.901e-06 -----
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00
 qbond: qkept nsym=1 dimAll=2
 (5,1):2
----- TIMING for decimation_row: 1.937e-04 S T(decim/formRot)=8.029e-05,1.134e-04 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep4.info

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.000e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.000e+00
 idx=2 node=(2,0) Drow=20 maxdiff=1.807e-15
 idx=3 node=(1,0) Drow=8 maxdiff=7.109e-16
 idx=4 node=(0,0) Drow=2 maxdiff=4.985e-16
stensor2: wf2 own=1 _data=0x44a523b0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.052e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x44a523b0
     -1.0000e+00       3.0776e-17 
      3.3599e-17      -1.0000e+00 
 rwfuns: nroots=2 maxdiff=9.9718e-16
----- TIMING FOR ctns::rcanon_check : 1.987e-04 S -----
..... end of isweep = 4 .....

======================================================================
sweep parameters: isweep=5 dots=2 dcut=20 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=2
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 sites: len=5 mem=290:0.00221MB:2.16e-06GB
 rwfuns: len=2 mem=4:3.05e-05MB:2.98e-08GB
 cpsi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=417:0.00318MB:3.11e-06GB

isweep=5 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=872:0.00665MB:6.5e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1310:0.00999MB:9.76e-06GB
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44af6540
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
### DIAG TIMING: total=0.000408 t1=1.67e-05, t2=2.09e-05, t3=5.5e-05, t4=0.000194, t5=7.56e-05, t6=2.92e-05, t7=1.33e-05, t8=2.92e-06
duration_diagGPU:0.000424
duration_diagreduce:4.33e-06
duration_diagtransform:1.84e-06
rank=0 GPUmem(GB): used=2.18e-05 (oper)=9.76e-06
----- TIMING FOR symbolic_formulae_twodot with size=93 : 6.964e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=93
 no. of hintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.986e-05 S -----
rank=0 GPUmem(GB): used=2.21e-05 (oper,hinter)=9.76e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00362 S size(H_formulae)=93 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000198,0.00343 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00389 S size(H_formulae)=93 size(Hxlst)=3134 -----
rank=0 GPUmem(GB): used=0.000421 (oper,hinter,dvdson,batch)=9.76e-06,2.98e-07,1.49e-06,0.000397 blksize=4 blksize0=8 batchsize=3134
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.3e-05,0.000222,0.00205,0.000197 cost=4.22e+04 flops[gemm]=2.06e+07
--- TIMING FOR sigma : t_inter=0.000222 t_gemm=0.00205 t_reduction=0.000197 tot=0.00247 ---
 sigma counter=190 i=0 t=0.000254 per=12.4 cost=3.72e+03 flops=1.46e+07
 sigma counter=190 i=1 t=0.000253 per=12.4 cost=3.74e+03 flops=1.48e+07
 sigma counter=190 i=2 t=0.000246 per=12 cost=3.04e+03 flops=1.23e+07
 sigma counter=190 i=3 t=0.000246 per=12 cost=3.03e+03 flops=1.23e+07
 sigma counter=190 i=4 t=0.000259 per=12.7 cost=1e+04 flops=3.86e+07
 sigma counter=190 i=5 t=0.000261 per=12.8 cost=1e+04 flops=3.83e+07
 sigma counter=190 i=6 t=0.000274 per=13.4 cost=4.34e+03 flops=1.58e+07
 sigma counter=190 i=7 t=0.000253 per=12.4 cost=4.32e+03 flops=1.71e+07
 total GEMM cost=4.22e+04 flops=2.06e+07
--- TIMING FOR sigma_tot : t_inter=0.0405 t_gemm=0.376 t_reduction=0.0375 tot=0.454 ---
 sigma_tot counter=190 i=0 t=0.0464 per=12.3 cost=5.11e+05 flops=1.1e+07
 sigma_tot counter=190 i=1 t=0.0469 per=12.5 cost=5.17e+05 flops=1.1e+07
 sigma_tot counter=190 i=2 t=0.046 per=12.2 cost=5.82e+05 flops=1.27e+07
 sigma_tot counter=190 i=3 t=0.0458 per=12.2 cost=5.9e+05 flops=1.29e+07
 sigma_tot counter=190 i=4 t=0.0472 per=12.5 cost=1.09e+06 flops=2.31e+07
 sigma_tot counter=190 i=5 t=0.0474 per=12.6 cost=1.09e+06 flops=2.3e+07
 sigma_tot counter=190 i=6 t=0.0489 per=13 cost=1.29e+06 flops=2.64e+07
 sigma_tot counter=190 i=7 t=0.0474 per=12.6 cost=1.29e+06 flops=2.72e+07
 total GEMM cost=6.96e+06 flops=1.85e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000211,0.00201,0.000196 cost=4.22e+04 flops[gemm]=2.1e+07
--- TIMING FOR sigma : t_inter=0.000211 t_gemm=0.00201 t_reduction=0.000196 tot=0.00242 ---
 sigma counter=191 i=0 t=0.000256 per=12.7 cost=3.72e+03 flops=1.45e+07
 sigma counter=191 i=1 t=0.000252 per=12.5 cost=3.74e+03 flops=1.48e+07
 sigma counter=191 i=2 t=0.000239 per=11.9 cost=3.04e+03 flops=1.27e+07
 sigma counter=191 i=3 t=0.000238 per=11.8 cost=3.03e+03 flops=1.27e+07
 sigma counter=191 i=4 t=0.000257 per=12.8 cost=1e+04 flops=3.89e+07
 sigma counter=191 i=5 t=0.000258 per=12.8 cost=1e+04 flops=3.88e+07
 sigma counter=191 i=6 t=0.00026 per=12.9 cost=4.34e+03 flops=1.67e+07
 sigma counter=191 i=7 t=0.000249 per=12.4 cost=4.32e+03 flops=1.73e+07
 total GEMM cost=4.22e+04 flops=2.1e+07
--- TIMING FOR sigma_tot : t_inter=0.0407 t_gemm=0.378 t_reduction=0.0377 tot=0.456 ---
 sigma_tot counter=191 i=0 t=0.0466 per=12.3 cost=5.15e+05 flops=1.1e+07
 sigma_tot counter=191 i=1 t=0.0472 per=12.5 cost=5.21e+05 flops=1.11e+07
 sigma_tot counter=191 i=2 t=0.0462 per=12.2 cost=5.85e+05 flops=1.27e+07
 sigma_tot counter=191 i=3 t=0.0461 per=12.2 cost=5.93e+05 flops=1.29e+07
 sigma_tot counter=191 i=4 t=0.0474 per=12.5 cost=1.1e+06 flops=2.32e+07
 sigma_tot counter=191 i=5 t=0.0477 per=12.6 cost=1.1e+06 flops=2.31e+07
 sigma_tot counter=191 i=6 t=0.0492 per=13 cost=1.3e+06 flops=2.63e+07
 sigma_tot counter=191 i=7 t=0.0476 per=12.6 cost=1.29e+06 flops=2.71e+07
 total GEMM cost=7e+06 flops=1.85e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891 -1.003e+03  6.876e-02    2     2  5.349e-03 2.675e-03
    1   1 -      -2.436233901339 -1.002e+03  4.380e-02    2     2  5.349e-03 2.675e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.150e-04,2.036e-03,1.960e-04 cost=4.217e+04 flops[gemm]=2.071e+07
--- TIMING FOR sigma : t_inter=2.140e-04 t_gemm=2.035e-03 t_reduction=1.960e-04 tot=2.445e-03 ---
 sigma counter=192 i=0 t=2.550e-04 per=1.253e+01 cost=3.716e+03 flops=1.457e+07
 sigma counter=192 i=1 t=2.700e-04 per=1.327e+01 cost=3.736e+03 flops=1.384e+07
 sigma counter=192 i=2 t=2.430e-04 per=1.194e+01 cost=3.036e+03 flops=1.249e+07
 sigma counter=192 i=3 t=2.410e-04 per=1.184e+01 cost=3.026e+03 flops=1.256e+07
 sigma counter=192 i=4 t=2.590e-04 per=1.273e+01 cost=1.000e+04 flops=3.861e+07
 sigma counter=192 i=5 t=2.580e-04 per=1.268e+01 cost=1.000e+04 flops=3.876e+07
 sigma counter=192 i=6 t=2.600e-04 per=1.278e+01 cost=4.336e+03 flops=1.668e+07
 sigma counter=192 i=7 t=2.490e-04 per=1.224e+01 cost=4.316e+03 flops=1.733e+07
 total GEMM cost=4.217e+04 flops=2.072e+07
--- TIMING FOR sigma_tot : t_inter=4.094e-02 t_gemm=3.800e-01 t_reduction=3.787e-02 tot=4.589e-01 ---
 sigma_tot counter=192 i=0 t=4.690e-02 per=1.234e+01 cost=5.184e+05 flops=1.105e+07
 sigma_tot counter=192 i=1 t=4.742e-02 per=1.248e+01 cost=5.248e+05 flops=1.107e+07
 sigma_tot counter=192 i=2 t=4.648e-02 per=1.223e+01 cost=5.884e+05 flops=1.266e+07
 sigma_tot counter=192 i=3 t=4.632e-02 per=1.219e+01 cost=5.958e+05 flops=1.286e+07
 sigma_tot counter=192 i=4 t=4.767e-02 per=1.254e+01 cost=1.108e+06 flops=2.324e+07
 sigma_tot counter=192 i=5 t=4.796e-02 per=1.262e+01 cost=1.111e+06 flops=2.316e+07
 sigma_tot counter=192 i=6 t=4.945e-02 per=1.301e+01 cost=1.300e+06 flops=2.630e+07
 sigma_tot counter=192 i=7 t=4.785e-02 per=1.259e+01 cost=1.295e+06 flops=2.706e+07
 total GEMM cost=7.041e+06 flops=1.853e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.120e-04,2.007e-03,1.940e-04 cost=4.217e+04 flops[gemm]=2.101e+07
--- TIMING FOR sigma : t_inter=2.110e-04 t_gemm=2.007e-03 t_reduction=1.940e-04 tot=2.412e-03 ---
 sigma counter=193 i=0 t=2.520e-04 per=1.256e+01 cost=3.716e+03 flops=1.475e+07
 sigma counter=193 i=1 t=2.520e-04 per=1.256e+01 cost=3.736e+03 flops=1.483e+07
 sigma counter=193 i=2 t=2.370e-04 per=1.181e+01 cost=3.036e+03 flops=1.281e+07
 sigma counter=193 i=3 t=2.380e-04 per=1.186e+01 cost=3.026e+03 flops=1.271e+07
 sigma counter=193 i=4 t=2.540e-04 per=1.266e+01 cost=1.000e+04 flops=3.937e+07
 sigma counter=193 i=5 t=2.570e-04 per=1.281e+01 cost=1.000e+04 flops=3.891e+07
 sigma counter=193 i=6 t=2.620e-04 per=1.305e+01 cost=4.336e+03 flops=1.655e+07
 sigma counter=193 i=7 t=2.550e-04 per=1.271e+01 cost=4.316e+03 flops=1.693e+07
 total GEMM cost=4.217e+04 flops=2.101e+07
--- TIMING FOR sigma_tot : t_inter=4.115e-02 t_gemm=3.821e-01 t_reduction=3.806e-02 tot=4.613e-01 ---
 sigma_tot counter=193 i=0 t=4.716e-02 per=1.234e+01 cost=5.221e+05 flops=1.107e+07
 sigma_tot counter=193 i=1 t=4.767e-02 per=1.248e+01 cost=5.286e+05 flops=1.109e+07
 sigma_tot counter=193 i=2 t=4.672e-02 per=1.223e+01 cost=5.914e+05 flops=1.266e+07
 sigma_tot counter=193 i=3 t=4.655e-02 per=1.219e+01 cost=5.988e+05 flops=1.286e+07
 sigma_tot counter=193 i=4 t=4.792e-02 per=1.254e+01 cost=1.118e+06 flops=2.333e+07
 sigma_tot counter=193 i=5 t=4.822e-02 per=1.262e+01 cost=1.121e+06 flops=2.324e+07
 sigma_tot counter=193 i=6 t=4.971e-02 per=1.301e+01 cost=1.305e+06 flops=2.624e+07
 sigma_tot counter=193 i=7 t=4.810e-02 per=1.259e+01 cost=1.299e+06 flops=2.701e+07
 total GEMM cost=7.083e+06 flops=1.854e+07
    2   0 -      -2.654428675110 -1.727e-03  1.261e-02    4     4  1.066e-02 2.664e-03
    2   1 -      -2.436964455587 -7.306e-04  4.223e-03    4     4  1.066e-02 2.664e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.160e-04,2.010e-03,1.980e-04 cost=4.217e+04 flops[gemm]=2.098e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=2.007e-03 t_reduction=1.980e-04 tot=2.421e-03 ---
 sigma counter=194 i=0 t=2.520e-04 per=1.256e+01 cost=3.716e+03 flops=1.475e+07
 sigma counter=194 i=1 t=2.620e-04 per=1.305e+01 cost=3.736e+03 flops=1.426e+07
 sigma counter=194 i=2 t=2.350e-04 per=1.171e+01 cost=3.036e+03 flops=1.292e+07
 sigma counter=194 i=3 t=2.360e-04 per=1.176e+01 cost=3.026e+03 flops=1.282e+07
 sigma counter=194 i=4 t=2.560e-04 per=1.276e+01 cost=1.000e+04 flops=3.906e+07
 sigma counter=194 i=5 t=2.560e-04 per=1.276e+01 cost=1.000e+04 flops=3.906e+07
 sigma counter=194 i=6 t=2.580e-04 per=1.286e+01 cost=4.336e+03 flops=1.681e+07
 sigma counter=194 i=7 t=2.520e-04 per=1.256e+01 cost=4.316e+03 flops=1.713e+07
 total GEMM cost=4.217e+04 flops=2.101e+07
--- TIMING FOR sigma_tot : t_inter=4.137e-02 t_gemm=3.841e-01 t_reduction=3.826e-02 tot=4.637e-01 ---
 sigma_tot counter=194 i=0 t=4.741e-02 per=1.234e+01 cost=5.258e+05 flops=1.109e+07
 sigma_tot counter=194 i=1 t=4.794e-02 per=1.248e+01 cost=5.323e+05 flops=1.110e+07
 sigma_tot counter=194 i=2 t=4.695e-02 per=1.223e+01 cost=5.945e+05 flops=1.266e+07
 sigma_tot counter=194 i=3 t=4.679e-02 per=1.218e+01 cost=6.019e+05 flops=1.286e+07
 sigma_tot counter=194 i=4 t=4.818e-02 per=1.254e+01 cost=1.128e+06 flops=2.341e+07
 sigma_tot counter=194 i=5 t=4.847e-02 per=1.262e+01 cost=1.131e+06 flops=2.333e+07
 sigma_tot counter=194 i=6 t=4.997e-02 per=1.301e+01 cost=1.309e+06 flops=2.620e+07
 sigma_tot counter=194 i=7 t=4.836e-02 per=1.259e+01 cost=1.303e+06 flops=2.696e+07
 total GEMM cost=7.126e+06 flops=1.855e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.000e-05,2.100e-04,2.019e-03,1.950e-04 cost=4.217e+04 flops[gemm]=2.088e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=2.018e-03 t_reduction=1.950e-04 tot=2.423e-03 ---
 sigma counter=195 i=0 t=2.540e-04 per=1.259e+01 cost=3.716e+03 flops=1.463e+07
 sigma counter=195 i=1 t=2.510e-04 per=1.244e+01 cost=3.736e+03 flops=1.488e+07
 sigma counter=195 i=2 t=2.420e-04 per=1.199e+01 cost=3.036e+03 flops=1.255e+07
 sigma counter=195 i=3 t=2.400e-04 per=1.189e+01 cost=3.026e+03 flops=1.261e+07
 sigma counter=195 i=4 t=2.550e-04 per=1.264e+01 cost=1.000e+04 flops=3.922e+07
 sigma counter=195 i=5 t=2.590e-04 per=1.283e+01 cost=1.000e+04 flops=3.861e+07
 sigma counter=195 i=6 t=2.630e-04 per=1.303e+01 cost=4.336e+03 flops=1.649e+07
 sigma counter=195 i=7 t=2.540e-04 per=1.259e+01 cost=4.316e+03 flops=1.699e+07
 total GEMM cost=4.217e+04 flops=2.089e+07
--- TIMING FOR sigma_tot : t_inter=4.158e-02 t_gemm=3.861e-01 t_reduction=3.846e-02 tot=4.661e-01 ---
 sigma_tot counter=195 i=0 t=4.766e-02 per=1.234e+01 cost=5.296e+05 flops=1.111e+07
 sigma_tot counter=195 i=1 t=4.819e-02 per=1.248e+01 cost=5.360e+05 flops=1.112e+07
 sigma_tot counter=195 i=2 t=4.719e-02 per=1.222e+01 cost=5.975e+05 flops=1.266e+07
 sigma_tot counter=195 i=3 t=4.703e-02 per=1.218e+01 cost=6.049e+05 flops=1.286e+07
 sigma_tot counter=195 i=4 t=4.844e-02 per=1.255e+01 cost=1.138e+06 flops=2.349e+07
 sigma_tot counter=195 i=5 t=4.873e-02 per=1.262e+01 cost=1.141e+06 flops=2.341e+07
 sigma_tot counter=195 i=6 t=5.023e-02 per=1.301e+01 cost=1.313e+06 flops=2.614e+07
 sigma_tot counter=195 i=7 t=4.861e-02 per=1.259e+01 cost=1.308e+06 flops=2.690e+07
 total GEMM cost=7.168e+06 flops=1.857e+07
    3   0 -      -2.654509664652 -8.099e-05  3.660e-03    6     6  1.593e-02 2.656e-03
    3   1 -      -2.436976459250 -1.200e-05  1.113e-03    6     6  1.593e-02 2.656e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.210e-04,2.024e-03,1.950e-04 cost=4.217e+04 flops[gemm]=2.083e+07
--- TIMING FOR sigma : t_inter=2.190e-04 t_gemm=2.024e-03 t_reduction=1.950e-04 tot=2.438e-03 ---
 sigma counter=196 i=0 t=2.580e-04 per=1.275e+01 cost=3.716e+03 flops=1.440e+07
 sigma counter=196 i=1 t=2.590e-04 per=1.280e+01 cost=3.736e+03 flops=1.442e+07
 sigma counter=196 i=2 t=2.390e-04 per=1.181e+01 cost=3.036e+03 flops=1.270e+07
 sigma counter=196 i=3 t=2.400e-04 per=1.186e+01 cost=3.026e+03 flops=1.261e+07
 sigma counter=196 i=4 t=2.550e-04 per=1.260e+01 cost=1.000e+04 flops=3.922e+07
 sigma counter=196 i=5 t=2.570e-04 per=1.270e+01 cost=1.000e+04 flops=3.891e+07
 sigma counter=196 i=6 t=2.620e-04 per=1.294e+01 cost=4.336e+03 flops=1.655e+07
 sigma counter=196 i=7 t=2.540e-04 per=1.255e+01 cost=4.316e+03 flops=1.699e+07
 total GEMM cost=4.217e+04 flops=2.083e+07
--- TIMING FOR sigma_tot : t_inter=4.179e-02 t_gemm=3.881e-01 t_reduction=3.865e-02 tot=4.685e-01 ---
 sigma_tot counter=196 i=0 t=4.792e-02 per=1.235e+01 cost=5.333e+05 flops=1.113e+07
 sigma_tot counter=196 i=1 t=4.845e-02 per=1.248e+01 cost=5.398e+05 flops=1.114e+07
 sigma_tot counter=196 i=2 t=4.743e-02 per=1.222e+01 cost=6.006e+05 flops=1.266e+07
 sigma_tot counter=196 i=3 t=4.727e-02 per=1.218e+01 cost=6.079e+05 flops=1.286e+07
 sigma_tot counter=196 i=4 t=4.869e-02 per=1.255e+01 cost=1.148e+06 flops=2.358e+07
 sigma_tot counter=196 i=5 t=4.899e-02 per=1.262e+01 cost=1.151e+06 flops=2.349e+07
 sigma_tot counter=196 i=6 t=5.050e-02 per=1.301e+01 cost=1.318e+06 flops=2.610e+07
 sigma_tot counter=196 i=7 t=4.886e-02 per=1.259e+01 cost=1.312e+06 flops=2.685e+07
 total GEMM cost=7.210e+06 flops=1.858e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.100e-04,2.012e-03,1.960e-04 cost=4.217e+04 flops[gemm]=2.096e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=2.012e-03 t_reduction=1.960e-04 tot=2.418e-03 ---
 sigma counter=197 i=0 t=2.510e-04 per=1.248e+01 cost=3.716e+03 flops=1.480e+07
 sigma counter=197 i=1 t=2.600e-04 per=1.292e+01 cost=3.736e+03 flops=1.437e+07
 sigma counter=197 i=2 t=2.380e-04 per=1.183e+01 cost=3.036e+03 flops=1.276e+07
 sigma counter=197 i=3 t=2.370e-04 per=1.178e+01 cost=3.026e+03 flops=1.277e+07
 sigma counter=197 i=4 t=2.540e-04 per=1.262e+01 cost=1.000e+04 flops=3.937e+07
 sigma counter=197 i=5 t=2.570e-04 per=1.277e+01 cost=1.000e+04 flops=3.891e+07
 sigma counter=197 i=6 t=2.620e-04 per=1.302e+01 cost=4.336e+03 flops=1.655e+07
 sigma counter=197 i=7 t=2.530e-04 per=1.257e+01 cost=4.316e+03 flops=1.706e+07
 total GEMM cost=4.217e+04 flops=2.096e+07
--- TIMING FOR sigma_tot : t_inter=4.200e-02 t_gemm=3.901e-01 t_reduction=3.885e-02 tot=4.710e-01 ---
 sigma_tot counter=197 i=0 t=4.817e-02 per=1.235e+01 cost=5.370e+05 flops=1.115e+07
 sigma_tot counter=197 i=1 t=4.871e-02 per=1.248e+01 cost=5.435e+05 flops=1.116e+07
 sigma_tot counter=197 i=2 t=4.767e-02 per=1.222e+01 cost=6.036e+05 flops=1.266e+07
 sigma_tot counter=197 i=3 t=4.751e-02 per=1.218e+01 cost=6.110e+05 flops=1.286e+07
 sigma_tot counter=197 i=4 t=4.894e-02 per=1.255e+01 cost=1.158e+06 flops=2.366e+07
 sigma_tot counter=197 i=5 t=4.925e-02 per=1.262e+01 cost=1.161e+06 flops=2.357e+07
 sigma_tot counter=197 i=6 t=5.076e-02 per=1.301e+01 cost=1.322e+06 flops=2.605e+07
 sigma_tot counter=197 i=7 t=4.912e-02 per=1.259e+01 cost=1.316e+06 flops=2.680e+07
 total GEMM cost=7.252e+06 flops=1.859e+07
    4   0 -      -2.654516020764 -6.356e-06  1.139e-03    6     8  2.123e-02 2.653e-03
    4   1 -      -2.436977285934 -8.267e-07  4.032e-04    6     8  2.123e-02 2.653e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.190e-04,2.056e-03,1.960e-04 cost=4.217e+04 flops[gemm]=2.051e+07
--- TIMING FOR sigma : t_inter=2.190e-04 t_gemm=2.056e-03 t_reduction=1.960e-04 tot=2.471e-03 ---
 sigma counter=198 i=0 t=2.550e-04 per=1.240e+01 cost=3.716e+03 flops=1.457e+07
 sigma counter=198 i=1 t=2.540e-04 per=1.235e+01 cost=3.736e+03 flops=1.471e+07
 sigma counter=198 i=2 t=2.500e-04 per=1.216e+01 cost=3.036e+03 flops=1.214e+07
 sigma counter=198 i=3 t=2.430e-04 per=1.182e+01 cost=3.026e+03 flops=1.245e+07
 sigma counter=198 i=4 t=2.600e-04 per=1.265e+01 cost=1.000e+04 flops=3.846e+07
 sigma counter=198 i=5 t=2.640e-04 per=1.284e+01 cost=1.000e+04 flops=3.788e+07
 sigma counter=198 i=6 t=2.800e-04 per=1.362e+01 cost=4.336e+03 flops=1.549e+07
 sigma counter=198 i=7 t=2.500e-04 per=1.216e+01 cost=4.316e+03 flops=1.726e+07
 total GEMM cost=4.217e+04 flops=2.051e+07
--- TIMING FOR sigma_tot : t_inter=4.222e-02 t_gemm=3.922e-01 t_reduction=3.904e-02 tot=4.734e-01 ---
 sigma_tot counter=198 i=0 t=4.843e-02 per=1.235e+01 cost=5.407e+05 flops=1.117e+07
 sigma_tot counter=198 i=1 t=4.896e-02 per=1.248e+01 cost=5.472e+05 flops=1.118e+07
 sigma_tot counter=198 i=2 t=4.792e-02 per=1.222e+01 cost=6.066e+05 flops=1.266e+07
 sigma_tot counter=198 i=3 t=4.775e-02 per=1.218e+01 cost=6.140e+05 flops=1.286e+07
 sigma_tot counter=198 i=4 t=4.920e-02 per=1.255e+01 cost=1.168e+06 flops=2.374e+07
 sigma_tot counter=198 i=5 t=4.951e-02 per=1.262e+01 cost=1.171e+06 flops=2.365e+07
 sigma_tot counter=198 i=6 t=5.104e-02 per=1.301e+01 cost=1.326e+06 flops=2.599e+07
 sigma_tot counter=198 i=7 t=4.937e-02 per=1.259e+01 cost=1.321e+06 flops=2.675e+07
 total GEMM cost=7.294e+06 flops=1.860e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.070e-04,2.026e-03,1.990e-04 cost=4.217e+04 flops[gemm]=2.081e+07
--- TIMING FOR sigma : t_inter=2.070e-04 t_gemm=2.026e-03 t_reduction=1.990e-04 tot=2.432e-03 ---
 sigma counter=199 i=0 t=2.530e-04 per=1.249e+01 cost=3.716e+03 flops=1.469e+07
 sigma counter=199 i=1 t=2.600e-04 per=1.283e+01 cost=3.736e+03 flops=1.437e+07
 sigma counter=199 i=2 t=2.380e-04 per=1.175e+01 cost=3.036e+03 flops=1.276e+07
 sigma counter=199 i=3 t=2.420e-04 per=1.194e+01 cost=3.026e+03 flops=1.250e+07
 sigma counter=199 i=4 t=2.560e-04 per=1.264e+01 cost=1.000e+04 flops=3.906e+07
 sigma counter=199 i=5 t=2.550e-04 per=1.259e+01 cost=1.000e+04 flops=3.922e+07
 sigma counter=199 i=6 t=2.640e-04 per=1.303e+01 cost=4.336e+03 flops=1.642e+07
 sigma counter=199 i=7 t=2.580e-04 per=1.273e+01 cost=4.316e+03 flops=1.673e+07
 total GEMM cost=4.217e+04 flops=2.081e+07
--- TIMING FOR sigma_tot : t_inter=4.243e-02 t_gemm=3.942e-01 t_reduction=3.924e-02 tot=4.759e-01 ---
 sigma_tot counter=199 i=0 t=4.868e-02 per=1.235e+01 cost=5.444e+05 flops=1.118e+07
 sigma_tot counter=199 i=1 t=4.922e-02 per=1.249e+01 cost=5.510e+05 flops=1.119e+07
 sigma_tot counter=199 i=2 t=4.816e-02 per=1.222e+01 cost=6.097e+05 flops=1.266e+07
 sigma_tot counter=199 i=3 t=4.799e-02 per=1.217e+01 cost=6.170e+05 flops=1.286e+07
 sigma_tot counter=199 i=4 t=4.946e-02 per=1.255e+01 cost=1.178e+06 flops=2.382e+07
 sigma_tot counter=199 i=5 t=4.976e-02 per=1.262e+01 cost=1.181e+06 flops=2.372e+07
 sigma_tot counter=199 i=6 t=5.130e-02 per=1.301e+01 cost=1.331e+06 flops=2.594e+07
 sigma_tot counter=199 i=7 t=4.963e-02 per=1.259e+01 cost=1.325e+06 flops=2.670e+07
 total GEMM cost=7.336e+06 flops=1.861e+07
    5   0 -      -2.654516818921 -7.982e-07  4.446e-04    6    10  2.657e-02 2.657e-03
    5   1 -      -2.436977409925 -1.240e-07  2.046e-04    6    10  2.657e-02 2.657e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.180e-04,2.016e-03,1.940e-04 cost=4.217e+04 flops[gemm]=2.092e+07
--- TIMING FOR sigma : t_inter=2.180e-04 t_gemm=2.016e-03 t_reduction=1.940e-04 tot=2.428e-03 ---
 sigma counter=200 i=0 t=2.570e-04 per=1.275e+01 cost=3.716e+03 flops=1.446e+07
 sigma counter=200 i=1 t=2.650e-04 per=1.314e+01 cost=3.736e+03 flops=1.410e+07
 sigma counter=200 i=2 t=2.370e-04 per=1.176e+01 cost=3.036e+03 flops=1.281e+07
 sigma counter=200 i=3 t=2.360e-04 per=1.171e+01 cost=3.026e+03 flops=1.282e+07
 sigma counter=200 i=4 t=2.540e-04 per=1.260e+01 cost=1.000e+04 flops=3.937e+07
 sigma counter=200 i=5 t=2.570e-04 per=1.275e+01 cost=1.000e+04 flops=3.891e+07
 sigma counter=200 i=6 t=2.600e-04 per=1.290e+01 cost=4.336e+03 flops=1.668e+07
 sigma counter=200 i=7 t=2.500e-04 per=1.240e+01 cost=4.316e+03 flops=1.726e+07
 total GEMM cost=4.217e+04 flops=2.092e+07
--- TIMING FOR sigma_tot : t_inter=4.265e-02 t_gemm=3.962e-01 t_reduction=3.944e-02 tot=4.783e-01 ---
 sigma_tot counter=200 i=0 t=4.894e-02 per=1.235e+01 cost=5.481e+05 flops=1.120e+07
 sigma_tot counter=200 i=1 t=4.948e-02 per=1.249e+01 cost=5.547e+05 flops=1.121e+07
 sigma_tot counter=200 i=2 t=4.840e-02 per=1.221e+01 cost=6.127e+05 flops=1.266e+07
 sigma_tot counter=200 i=3 t=4.823e-02 per=1.217e+01 cost=6.200e+05 flops=1.286e+07
 sigma_tot counter=200 i=4 t=4.971e-02 per=1.255e+01 cost=1.188e+06 flops=2.389e+07
 sigma_tot counter=200 i=5 t=5.002e-02 per=1.262e+01 cost=1.191e+06 flops=2.380e+07
 sigma_tot counter=200 i=6 t=5.156e-02 per=1.301e+01 cost=1.335e+06 flops=2.589e+07
 sigma_tot counter=200 i=7 t=4.988e-02 per=1.259e+01 cost=1.329e+06 flops=2.665e+07
 total GEMM cost=7.379e+06 flops=1.862e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.000e-05,2.100e-04,2.008e-03,1.960e-04 cost=4.217e+04 flops[gemm]=2.100e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=2.008e-03 t_reduction=1.960e-04 tot=2.414e-03 ---
 sigma counter=201 i=0 t=2.520e-04 per=1.255e+01 cost=3.716e+03 flops=1.475e+07
 sigma counter=201 i=1 t=2.600e-04 per=1.295e+01 cost=3.736e+03 flops=1.437e+07
 sigma counter=201 i=2 t=2.370e-04 per=1.180e+01 cost=3.036e+03 flops=1.281e+07
 sigma counter=201 i=3 t=2.390e-04 per=1.190e+01 cost=3.026e+03 flops=1.266e+07
 sigma counter=201 i=4 t=2.540e-04 per=1.265e+01 cost=1.000e+04 flops=3.937e+07
 sigma counter=201 i=5 t=2.540e-04 per=1.265e+01 cost=1.000e+04 flops=3.937e+07
 sigma counter=201 i=6 t=2.610e-04 per=1.300e+01 cost=4.336e+03 flops=1.661e+07
 sigma counter=201 i=7 t=2.510e-04 per=1.250e+01 cost=4.316e+03 flops=1.720e+07
 total GEMM cost=4.217e+04 flops=2.100e+07
--- TIMING FOR sigma_tot : t_inter=4.286e-02 t_gemm=3.982e-01 t_reduction=3.963e-02 tot=4.807e-01 ---
 sigma_tot counter=201 i=0 t=4.919e-02 per=1.235e+01 cost=5.519e+05 flops=1.122e+07
 sigma_tot counter=201 i=1 t=4.974e-02 per=1.249e+01 cost=5.585e+05 flops=1.123e+07
 sigma_tot counter=201 i=2 t=4.863e-02 per=1.221e+01 cost=6.157e+05 flops=1.266e+07
 sigma_tot counter=201 i=3 t=4.847e-02 per=1.217e+01 cost=6.231e+05 flops=1.286e+07
 sigma_tot counter=201 i=4 t=4.997e-02 per=1.255e+01 cost=1.198e+06 flops=2.397e+07
 sigma_tot counter=201 i=5 t=5.028e-02 per=1.262e+01 cost=1.201e+06 flops=2.388e+07
 sigma_tot counter=201 i=6 t=5.182e-02 per=1.301e+01 cost=1.339e+06 flops=2.585e+07
 sigma_tot counter=201 i=7 t=5.013e-02 per=1.259e+01 cost=1.334e+06 flops=2.661e+07
 total GEMM cost=7.421e+06 flops=1.863e+07
    6   0 -      -2.654516950786 -1.319e-07  1.570e-04    6    12  3.185e-02 2.654e-03
    6   1 +      -2.436977447171 -3.725e-08  7.419e-05    6    12  3.185e-02 2.654e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.140e-04,2.006e-03,2.000e-04 cost=4.217e+04 flops[gemm]=2.102e+07
--- TIMING FOR sigma : t_inter=2.130e-04 t_gemm=2.005e-03 t_reduction=1.990e-04 tot=2.417e-03 ---
 sigma counter=202 i=0 t=2.560e-04 per=1.277e+01 cost=3.716e+03 flops=1.452e+07
 sigma counter=202 i=1 t=2.520e-04 per=1.257e+01 cost=3.736e+03 flops=1.483e+07
 sigma counter=202 i=2 t=2.370e-04 per=1.182e+01 cost=3.036e+03 flops=1.281e+07
 sigma counter=202 i=3 t=2.380e-04 per=1.187e+01 cost=3.026e+03 flops=1.271e+07
 sigma counter=202 i=4 t=2.540e-04 per=1.267e+01 cost=1.000e+04 flops=3.937e+07
 sigma counter=202 i=5 t=2.550e-04 per=1.272e+01 cost=1.000e+04 flops=3.922e+07
 sigma counter=202 i=6 t=2.630e-04 per=1.312e+01 cost=4.336e+03 flops=1.649e+07
 sigma counter=202 i=7 t=2.500e-04 per=1.247e+01 cost=4.316e+03 flops=1.726e+07
 total GEMM cost=4.217e+04 flops=2.103e+07
--- TIMING FOR sigma_tot : t_inter=4.307e-02 t_gemm=4.002e-01 t_reduction=3.983e-02 tot=4.831e-01 ---
 sigma_tot counter=202 i=0 t=4.944e-02 per=1.235e+01 cost=5.556e+05 flops=1.124e+07
 sigma_tot counter=202 i=1 t=5.000e-02 per=1.249e+01 cost=5.622e+05 flops=1.124e+07
 sigma_tot counter=202 i=2 t=4.887e-02 per=1.221e+01 cost=6.188e+05 flops=1.266e+07
 sigma_tot counter=202 i=3 t=4.871e-02 per=1.217e+01 cost=6.261e+05 flops=1.285e+07
 sigma_tot counter=202 i=4 t=5.022e-02 per=1.255e+01 cost=1.208e+06 flops=2.405e+07
 sigma_tot counter=202 i=5 t=5.053e-02 per=1.263e+01 cost=1.211e+06 flops=2.396e+07
 sigma_tot counter=202 i=6 t=5.209e-02 per=1.301e+01 cost=1.344e+06 flops=2.580e+07
 sigma_tot counter=202 i=7 t=5.038e-02 per=1.259e+01 cost=1.338e+06 flops=2.656e+07
 total GEMM cost=7.463e+06 flops=1.865e+07
    7   0 +      -2.654516966956 -1.617e-08  3.991e-05    5    13  3.450e-02 2.654e-03
    7   1 +      -2.436977447171 -2.220e-15  7.419e-05    5    13  3.450e-02 2.654e-03
TIMING FOR Davidson : 3.453e-02  T(cal/comm/rest)=3.396e-02,4.535e-05,5.321e-04
optimized energies: isweep=5 dots=2 ibond=0 e[0]=-2.65451696696 nmvp=13
optimized energies: isweep=5 dots=2 ibond=0 e[1]=-2.43697744717 nmvp=13
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=9 alg_decim=1 mpisize=2 maxthreads=2
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
TIMING FOR decimation: 3.7e-04 S T(wf/decim)=3.1e-04,6.0e-05
ctns::oper_renorm coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=852:6.5e-03MB:6.3e-06GB
rank=0 GPUmem(GB): used=2.2e-05 (oper)=8.5e-06
rank=0 GPUmem(GB): used=2.2e-05 (oper,site)(GB)=8.5e-06,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 5.811e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=2.22e-05 (oper,site,rinter)=8.52e-06,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00101 S size(rtasks)=37 size(Rlst2)=9 T(Rmu/Rlist)=0.000201,0.000809 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00109 S size(rtasks)=37 size(Rlst)=860 -----
rank=0 GPUmem(GB): used=0.000234 (oper,site,rinter,batch)=8.52e-06,2.68e-07,0,0.000211 blksize=16 blksize0=0 batchsize=860
timing: allocate=3.59e-05 rmmtasks init=0.00104 total=0.00108
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=5e-06,0.00118,0.000207 cost=1.69e+04 flops[gemm]=1.43e+07
--- TIMING FOR renorm : t_inter=5e-06 t_gemm=0.00118 t_reduction=0.000207 tot=0.00139 ---
 renorm counter=21 i=0 t=0.000245 per=20.7 cost=1.3e+03 flops=5.31e+06
 renorm counter=21 i=1 t=0.000227 per=19.2 cost=1.64e+03 flops=7.22e+06
 renorm counter=21 i=2 t=1e-06 per=0.0847 cost=0 flops=0
 renorm counter=21 i=3 t=1e-06 per=0.0847 cost=0 flops=0
 renorm counter=21 i=4 t=0.000225 per=19.1 cost=1.19e+03 flops=5.31e+06
 renorm counter=21 i=5 t=0.000225 per=19.1 cost=1.85e+03 flops=8.24e+06
 renorm counter=21 i=6 t=0.000257 per=21.8 cost=1.09e+04 flops=4.23e+07
 total GEMM cost=1.69e+04 flops=1.43e+07
--- TIMING FOR renorm_tot : t_inter=0.00215 t_gemm=0.0243 t_reduction=0.00423 tot=0.0307 ---
 renorm_tot counter=21 i=0 t=0.00489 per=20.1 cost=4.44e+04 flops=9.07e+06
 renorm_tot counter=21 i=1 t=0.00479 per=19.7 cost=6.64e+04 flops=1.38e+07
 renorm_tot counter=21 i=2 t=0.00222 per=9.14 cost=4.43e+04 flops=1.99e+07
 renorm_tot counter=21 i=3 t=0.00226 per=9.27 cost=7.64e+04 flops=3.39e+07
 renorm_tot counter=21 i=4 t=0.00246 per=10.1 cost=4.75e+04 flops=1.93e+07
 renorm_tot counter=21 i=5 t=0.0025 per=10.3 cost=8.28e+04 flops=3.31e+07
 renorm_tot counter=21 i=6 t=0.00521 per=21.4 cost=5.62e+05 flops=1.08e+08
 total GEMM cost=9.24e+05 flops=3.8e+07
timing: gpu2cpu=1.45e-05 deallocate(site/work)=2.78e-06,5.38e-06 total=1.99e-05
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.00491 S T(init/kernel/comm)=0.00043,0.00443,5.34e-05 rank=0 -----
TIMING FOR cleanup: 0.000324 T(erase/save/remove)=9.58e-05,0.000191,3.71e-05
##### local: 5.143e-02 S #####
 T(local: fetch) = 1.507e-04 S  per = 0.293  per(accum) = 0.293
 T(local: hdiag) = 5.851e-04 S  per = 1.14  per(accum) = 1.43
 T(local: dvdsn) = 4.428e-02 S  per = 86.1  per(accum) = 87.5
 T(local: decim) = 4.671e-04 S  per = 0.908  per(accum) = 88.4
 T(local: guess) = 5.324e-04 S  per = 1.04  per(accum) = 89.5
 T(local: renrm) = 5.073e-03 S  per = 9.86  per(accum) = 99.3
 T(local: save ) = 3.376e-04 S  per = 0.656  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.313e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 8.244e-06 S  per = 0.0191  per(accum) = 0.0191
 T(local: symbolic_formulae_twodot     ) = 7.062e-04 S  per = 1.64  per(accum) = 1.66
 T(local: hintermediate init           ) = 6.341e-05 S  per = 0.147  per(accum) = 1.8
 T(local: hintermediates memcpy cpu2gpu) = 3.300e-08 S  per = 7.65e-05  per(accum) = 1.8
 T(local: preprocess_hformulae_Hxlist2 ) = 3.987e-03 S  per = 9.24  per(accum) = 11
 T(local: hmmtasks init                ) = 3.833e-03 S  per = 8.89  per(accum) = 19.9
 T(local: dvdson solver [Hx_batchGPU]  ) = 3.396e-02 S  per = 78.7  per(accum) = 98.7
 T(local: dvdson solver [communication]) = 4.535e-05 S  per = 0.105  per(accum) = 98.8
 T(local: dvdson solver [rest part]    ) = 5.321e-04 S  per = 1.23  per(accum) = 100
Detailed decomposition of T(renrm): 4.914e-03 S
 T(local: qops init                    ) = 4.298e-04 S  per = 8.75  per(accum) = 8.75
 T(local: qops_dict memcpy cpu2gpu     ) = 3.723e-05 S  per = 0.758  per(accum) = 9.5
 T(local: symbolic_formulae_renorm     ) = 5.902e-04 S  per =   12  per(accum) = 21.5
 T(local: rintermediate init           ) = 2.998e-05 S  per = 0.61  per(accum) = 22.1
 T(local: rintermediates memcpy cpu2gpu) = 3.000e-08 S  per = 0.000611  per(accum) = 22.1
 T(local: preprocess_formulae_Rlist2   ) = 1.118e-03 S  per = 22.8  per(accum) = 44.9
 T(local: rmmtasks init                ) = 1.088e-03 S  per = 22.1  per(accum) = 67
 T(local: qops memset                  ) = 2.700e-08 S  per = 0.000549  per(accum) = 67
 T(local: preprocess_renorm_batchGPU   ) = 1.513e-03 S  per = 30.8  per(accum) = 97.8
 T(local: qops memcpy gpu2cpu          ) = 1.461e-05 S  per = 0.297  per(accum) = 98.1
 T(local: deallocate gpu memory        ) = 3.958e-05 S  per = 0.805  per(accum) = 98.9
 T(local: communication of opS and opH ) = 5.340e-05 S  per = 1.09  per(accum) = 100
##### sweep: 5.143e-02 S #####
 T(sweep: fetch) = 1.507e-04 S  per = 0.293  per(accum) = 0.293
 T(sweep: hdiag) = 5.851e-04 S  per = 1.14  per(accum) = 1.43
 T(sweep: dvdsn) = 4.428e-02 S  per = 86.1  per(accum) = 87.5
 T(sweep: decim) = 4.671e-04 S  per = 0.908  per(accum) = 88.4
 T(sweep: guess) = 5.324e-04 S  per = 1.04  per(accum) = 89.5
 T(sweep: renrm) = 5.073e-03 S  per = 9.86  per(accum) = 99.3
 T(sweep: save ) = 3.376e-04 S  per = 0.656  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.313e-02 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 8.244e-06 S  per = 0.0191  per(accum) = 0.0191
 T(sweep: symbolic_formulae_twodot     ) = 7.062e-04 S  per = 1.64  per(accum) = 1.66
 T(sweep: hintermediate init           ) = 6.341e-05 S  per = 0.147  per(accum) = 1.8
 T(sweep: hintermediates memcpy cpu2gpu) = 3.300e-08 S  per = 7.65e-05  per(accum) = 1.8
 T(sweep: preprocess_hformulae_Hxlist2 ) = 3.987e-03 S  per = 9.24  per(accum) = 11
 T(sweep: hmmtasks init                ) = 3.833e-03 S  per = 8.89  per(accum) = 19.9
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 3.396e-02 S  per = 78.7  per(accum) = 98.7
 T(sweep: dvdson solver [communication]) = 4.535e-05 S  per = 0.105  per(accum) = 98.8
 T(sweep: dvdson solver [rest part]    ) = 5.321e-04 S  per = 1.23  per(accum) = 100
Detailed decomposition of T(renrm): 4.914e-03 S
 T(sweep: qops init                    ) = 4.298e-04 S  per = 8.75  per(accum) = 8.75
 T(sweep: qops_dict memcpy cpu2gpu     ) = 3.723e-05 S  per = 0.758  per(accum) = 9.5
 T(sweep: symbolic_formulae_renorm     ) = 5.902e-04 S  per =   12  per(accum) = 21.5
 T(sweep: rintermediate init           ) = 2.998e-05 S  per = 0.61  per(accum) = 22.1
 T(sweep: rintermediates memcpy cpu2gpu) = 3.000e-08 S  per = 0.000611  per(accum) = 22.1
 T(sweep: preprocess_formulae_Rlist2   ) = 1.118e-03 S  per = 22.8  per(accum) = 44.9
 T(sweep: rmmtasks init                ) = 1.088e-03 S  per = 22.1  per(accum) = 67
 T(sweep: qops memset                  ) = 2.700e-08 S  per = 0.000549  per(accum) = 67
 T(sweep: preprocess_renorm_batchGPU   ) = 1.513e-03 S  per = 30.8  per(accum) = 97.8
 T(sweep: qops memcpy gpu2cpu          ) = 1.461e-05 S  per = 0.297  per(accum) = 98.1
 T(sweep: deallocate gpu memory        ) = 3.958e-05 S  per = 0.805  per(accum) = 98.9
 T(sweep: communication of opS and opH ) = 5.340e-05 S  per = 1.09  per(accum) = 100
##### global: 8.770e-01 S #####
 T(global: fetch) = 1.383e-02 S  per = 1.58  per(accum) = 1.58
 T(global: hdiag) = 1.150e-02 S  per = 1.31  per(accum) = 2.89
 T(global: dvdsn) = 7.166e-01 S  per = 81.7  per(accum) = 84.6
 T(global: decim) = 1.805e-02 S  per = 2.06  per(accum) = 86.7
 T(global: guess) = 9.278e-03 S  per = 1.06  per(accum) = 87.7
 T(global: renrm) = 1.017e-01 S  per = 11.6  per(accum) = 99.3
 T(global: save ) = 6.087e-03 S  per = 0.694  per(accum) = 100
Detailed decomposition of T(dvdsn): 6.940e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 2.227e-04 S  per = 0.0321  per(accum) = 0.0321
 T(global: symbolic_formulae_twodot     ) = 1.396e-02 S  per = 2.01  per(accum) = 2.04
 T(global: hintermediate init           ) = 1.237e-03 S  per = 0.178  per(accum) = 2.22
 T(global: hintermediates memcpy cpu2gpu) = 6.190e-07 S  per = 8.92e-05  per(accum) = 2.22
 T(global: preprocess_hformulae_Hxlist2 ) = 7.506e-02 S  per = 10.8  per(accum) = 13
 T(global: hmmtasks init                ) = 7.419e-02 S  per = 10.7  per(accum) = 23.7
 T(global: dvdson solver [Hx_batchGPU]  ) = 5.201e-01 S  per = 74.9  per(accum) = 98.7
 T(global: dvdson solver [communication]) = 7.157e-04 S  per = 0.103  per(accum) = 98.8
 T(global: dvdson solver [rest part]    ) = 8.498e-03 S  per = 1.22  per(accum) = 100
Detailed decomposition of T(renrm): 9.857e-02 S
 T(global: qops init                    ) = 7.561e-03 S  per = 7.67  per(accum) = 7.67
 T(global: qops_dict memcpy cpu2gpu     ) = 8.798e-04 S  per = 0.893  per(accum) = 8.56
 T(global: symbolic_formulae_renorm     ) = 1.133e-02 S  per = 11.5  per(accum) = 20.1
 T(global: rintermediate init           ) = 9.565e-04 S  per = 0.97  per(accum) = 21
 T(global: rintermediates memcpy cpu2gpu) = 6.010e-07 S  per = 0.00061  per(accum) = 21
 T(global: preprocess_formulae_Rlist2   ) = 2.153e-02 S  per = 21.8  per(accum) = 42.9
 T(global: rmmtasks init                ) = 2.066e-02 S  per =   21  per(accum) = 63.8
 T(global: qops memset                  ) = 5.890e-07 S  per = 0.000598  per(accum) = 63.8
 T(global: preprocess_renorm_batchGPU   ) = 3.322e-02 S  per = 33.7  per(accum) = 97.5
 T(global: qops memcpy gpu2cpu          ) = 3.248e-04 S  per = 0.33  per(accum) = 97.9
 T(global: deallocate gpu memory        ) = 7.815e-04 S  per = 0.793  per(accum) = 98.7
 T(global: communication of opS and opH ) = 1.324e-03 S  per = 1.34  per(accum) = 100

isweep=5 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=852:0.0065MB:6.35e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1290:0.00984MB:9.61e-06GB
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x445cf2c0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
### DIAG TIMING: total=0.000358 t1=7.19e-06, t2=1.37e-05, t3=4.81e-05, t4=0.000123, t5=0.000124, t6=2.72e-05, t7=1.27e-05, t8=2.49e-06
duration_diagGPU:0.000373
duration_diagreduce:4.16e-06
duration_diagtransform:1.83e-06
rank=0 GPUmem(GB): used=9.61e-06 (oper)=9.61e-06
----- TIMING FOR symbolic_formulae_twodot with size=95 : 6.387e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=95
 no. of hintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.730e-05 S -----
rank=0 GPUmem(GB): used=9.94e-06 (oper,hinter)=9.61e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00331 S size(H_formulae)=95 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000189,0.00312 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00356 S size(H_formulae)=95 size(Hxlst)=2974 -----
rank=0 GPUmem(GB): used=0.000388 (oper,hinter,dvdson,batch)=9.61e-06,3.28e-07,1.49e-06,0.000377 blksize=4 blksize0=8 batchsize=2974
ctns::twodot_guess |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000219,0.00203,0.000202 cost=4.12e+04 flops[gemm]=2.03e+07
--- TIMING FOR sigma : t_inter=0.000219 t_gemm=0.00203 t_reduction=0.000202 tot=0.00245 ---
 sigma counter=203 i=0 t=0.000242 per=11.9 cost=2.58e+03 flops=1.07e+07
 sigma counter=203 i=1 t=0.000246 per=12.1 cost=2.57e+03 flops=1.05e+07
 sigma counter=203 i=2 t=0.000253 per=12.5 cost=3.75e+03 flops=1.48e+07
 sigma counter=203 i=3 t=0.000245 per=12.1 cost=3.77e+03 flops=1.54e+07
 sigma counter=203 i=4 t=0.000249 per=12.3 cost=4.11e+03 flops=1.65e+07
 sigma counter=203 i=5 t=0.000251 per=12.4 cost=4.13e+03 flops=1.65e+07
 sigma counter=203 i=6 t=0.000276 per=13.6 cost=1.01e+04 flops=3.68e+07
 sigma counter=203 i=7 t=0.000265 per=13.1 cost=1.01e+04 flops=3.83e+07
 total GEMM cost=4.12e+04 flops=2.03e+07
--- TIMING FOR sigma_tot : t_inter=0.0433 t_gemm=0.402 t_reduction=0.04 tot=0.486 ---
 sigma_tot counter=203 i=0 t=0.0497 per=12.4 cost=5.58e+05 flops=1.12e+07
 sigma_tot counter=203 i=1 t=0.0502 per=12.5 cost=5.65e+05 flops=1.12e+07
 sigma_tot counter=203 i=2 t=0.0491 per=12.2 cost=6.23e+05 flops=1.27e+07
 sigma_tot counter=203 i=3 t=0.049 per=12.2 cost=6.3e+05 flops=1.29e+07
 sigma_tot counter=203 i=4 t=0.0505 per=12.5 cost=1.21e+06 flops=2.4e+07
 sigma_tot counter=203 i=5 t=0.0508 per=12.6 cost=1.21e+06 flops=2.39e+07
 sigma_tot counter=203 i=6 t=0.0524 per=13 cost=1.35e+06 flops=2.59e+07
 sigma_tot counter=203 i=7 t=0.0506 per=12.6 cost=1.35e+06 flops=2.66e+07
 total GEMM cost=7.5e+06 flops=1.87e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2e-05,0.000216,0.002,0.000195 cost=4.12e+04 flops[gemm]=2.06e+07
--- TIMING FOR sigma : t_inter=0.000216 t_gemm=0.002 t_reduction=0.000195 tot=0.00241 ---
 sigma counter=204 i=0 t=0.000239 per=12 cost=2.58e+03 flops=1.08e+07
 sigma counter=204 i=1 t=0.000258 per=12.9 cost=2.57e+03 flops=9.97e+06
 sigma counter=204 i=2 t=0.000242 per=12.1 cost=3.75e+03 flops=1.55e+07
 sigma counter=204 i=3 t=0.000248 per=12.4 cost=3.77e+03 flops=1.52e+07
 sigma counter=204 i=4 t=0.00025 per=12.5 cost=4.11e+03 flops=1.64e+07
 sigma counter=204 i=5 t=0.000249 per=12.5 cost=4.13e+03 flops=1.66e+07
 sigma counter=204 i=6 t=0.000262 per=13.1 cost=1.01e+04 flops=3.87e+07
 sigma counter=204 i=7 t=0.000251 per=12.6 cost=1.01e+04 flops=4.04e+07
 total GEMM cost=4.12e+04 flops=2.06e+07
--- TIMING FOR sigma_tot : t_inter=0.0435 t_gemm=0.404 t_reduction=0.0402 tot=0.488 ---
 sigma_tot counter=204 i=0 t=0.0499 per=12.3 cost=5.61e+05 flops=1.12e+07
 sigma_tot counter=204 i=1 t=0.0505 per=12.5 cost=5.67e+05 flops=1.12e+07
 sigma_tot counter=204 i=2 t=0.0494 per=12.2 cost=6.26e+05 flops=1.27e+07
 sigma_tot counter=204 i=3 t=0.0492 per=12.2 cost=6.34e+05 flops=1.29e+07
 sigma_tot counter=204 i=4 t=0.0507 per=12.5 cost=1.22e+06 flops=2.4e+07
 sigma_tot counter=204 i=5 t=0.051 per=12.6 cost=1.22e+06 flops=2.39e+07
 sigma_tot counter=204 i=6 t=0.0526 per=13 cost=1.36e+06 flops=2.59e+07
 sigma_tot counter=204 i=7 t=0.0509 per=12.6 cost=1.36e+06 flops=2.67e+07
 total GEMM cost=7.55e+06 flops=1.87e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956 -1.003e+03  3.991e-05    2     2  5.318e-03 2.659e-03
    1   1 +      -2.436977447171 -1.002e+03  7.419e-05    2     2  5.318e-03 2.659e-03
TIMING FOR Davidson : 5.364e-03  T(cal/comm/rest)=5.263e-03,7.583e-06,9.370e-05
optimized energies: isweep=5 dots=2 ibond=1 e[0]=-2.65451696696 nmvp=2
optimized energies: isweep=5 dots=2 ibond=1 e[1]=-2.43697744717 nmvp=2
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=16 alg_decim=1 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep5_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (4,0):9 (3,1):9 (3,-1):9 (1,1):3 (2,2):3 (1,-1):3 (2,-2):3 (5,1):3 (4,2):3 (5,-1):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
----- TMING FOR decimation_genbasis: 3.8e-04 S T(scatter/comp/gather)=4.1e-05,4.0e-05,3.0e-04 -----
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
 qbond: qkept nsym=6 dimAll=20
 (3,1):6 (4,0):4 (2,0):3 (4,2):3 (3,-1):2 (5,1):2
----- TIMING for decimation_row: 6.920e-04 S T(decim/formRot)=4.681e-04,2.238e-04 -----
TIMING FOR decimation: 9.985e-04 S T(wf/decim)=2.927e-04,7.058e-04
ctns::oper_renorm coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:6 A:7 B:11 P:3 Q:5 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=1685:1.286e-02MB:1.255e-05GB
rank=0 GPUmem(GB): used=2.249e-05 (oper)=1.999e-05
rank=0 GPUmem(GB): used=2.361e-05 (oper,site)(GB)=1.999e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=37 : 4.801e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 5.273e-05 S -----
rank=0 GPUmem(GB): used=2.39e-05 (oper,site,rinter)=2e-05,1.12e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000996 S size(rtasks)=37 size(Rlst2)=6 T(Rmu/Rlist)=0.000163,0.000833 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00108 S size(rtasks)=37 size(Rlst)=905 -----
rank=0 GPUmem(GB): used=0.00057 (oper,site,rinter,batch)=2e-05,1.12e-06,3.28e-07,0.000546 blksize=36 blksize0=8 batchsize=905
timing: allocate=3.55e-05 rmmtasks init=0.00112 total=0.00116
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000215,0.00119,0.00021 cost=9.26e+04 flops[gemm]=7.79e+07
--- TIMING FOR renorm : t_inter=0.000215 t_gemm=0.00119 t_reduction=0.00021 tot=0.00161 ---
 renorm counter=22 i=0 t=0.000229 per=19.3 cost=4.54e+03 flops=1.98e+07
 renorm counter=22 i=1 t=0.000232 per=19.5 cost=5.34e+03 flops=2.3e+07
 renorm counter=22 i=2 t=0 per=0 cost=0 flops=-nan
 renorm counter=22 i=3 t=1e-06 per=0.0841 cost=0 flops=0
 renorm counter=22 i=4 t=0.000232 per=19.5 cost=9.49e+03 flops=4.09e+07
 renorm counter=22 i=5 t=0.000234 per=19.7 cost=1.68e+04 flops=7.17e+07
 renorm counter=22 i=6 t=0.000261 per=22 cost=5.64e+04 flops=2.16e+08
 total GEMM cost=9.26e+04 flops=7.79e+07
--- TIMING FOR renorm_tot : t_inter=0.00236 t_gemm=0.0255 t_reduction=0.00444 tot=0.0323 ---
 renorm_tot counter=22 i=0 t=0.00512 per=20.1 cost=4.89e+04 flops=9.55e+06
 renorm_tot counter=22 i=1 t=0.00502 per=19.7 cost=7.17e+04 flops=1.43e+07
 renorm_tot counter=22 i=2 t=0.00222 per=8.71 cost=4.43e+04 flops=1.99e+07
 renorm_tot counter=22 i=3 t=0.00226 per=8.84 cost=7.64e+04 flops=3.38e+07
 renorm_tot counter=22 i=4 t=0.0027 per=10.6 cost=5.7e+04 flops=2.11e+07
 renorm_tot counter=22 i=5 t=0.00274 per=10.7 cost=9.96e+04 flops=3.64e+07
 renorm_tot counter=22 i=6 t=0.00547 per=21.4 cost=6.19e+05 flops=1.13e+08
 total GEMM cost=1.02e+06 flops=3.98e+07
timing: gpu2cpu=1.9e-05 deallocate(site/work)=3.35e-06,6.17e-06 total=2.51e-05
check ||H-H.dagger||=1.633e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00504 S T(init/kernel/comm)=0.000315,0.00466,6.38e-05 rank=0 -----
TIMING FOR cleanup: 0.000181 T(erase/save/remove)=4.36e-06,0.000142,3.52e-05
##### local: 2.303e-02 S #####
 T(local: fetch) = 1.054e-03 S  per = 4.58  per(accum) = 4.58
 T(local: hdiag) = 5.168e-04 S  per = 2.24  per(accum) = 6.82
 T(local: dvdsn) = 1.453e-02 S  per = 63.1  per(accum) = 69.9
 T(local: decim) = 1.139e-03 S  per = 4.94  per(accum) = 74.9
 T(local: guess) = 3.997e-04 S  per = 1.74  per(accum) = 76.6
 T(local: renrm) = 5.196e-03 S  per = 22.6  per(accum) = 99.2
 T(local: save ) = 1.933e-04 S  per = 0.84  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.336e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 8.786e-06 S  per = 0.0658  per(accum) = 0.0658
 T(local: symbolic_formulae_twodot     ) = 6.496e-04 S  per = 4.86  per(accum) = 4.93
 T(local: hintermediate init           ) = 5.973e-05 S  per = 0.447  per(accum) = 5.38
 T(local: hintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.00021  per(accum) = 5.38
 T(local: preprocess_hformulae_Hxlist2 ) = 3.655e-03 S  per = 27.4  per(accum) = 32.7
 T(local: hmmtasks init                ) = 3.620e-03 S  per = 27.1  per(accum) = 59.8
 T(local: dvdson solver [Hx_batchGPU]  ) = 5.263e-03 S  per = 39.4  per(accum) = 99.2
 T(local: dvdson solver [communication]) = 7.583e-06 S  per = 0.0568  per(accum) = 99.3
 T(local: dvdson solver [rest part]    ) = 9.370e-05 S  per = 0.701  per(accum) = 100
Detailed decomposition of T(renrm): 5.037e-03 S
 T(local: qops init                    ) = 3.146e-04 S  per = 6.25  per(accum) = 6.25
 T(local: qops_dict memcpy cpu2gpu     ) = 4.407e-05 S  per = 0.875  per(accum) = 7.12
 T(local: symbolic_formulae_renorm     ) = 4.894e-04 S  per = 9.72  per(accum) = 16.8
 T(local: rintermediate init           ) = 6.503e-05 S  per = 1.29  per(accum) = 18.1
 T(local: rintermediates memcpy cpu2gpu) = 2.900e-08 S  per = 0.000576  per(accum) = 18.1
 T(local: preprocess_formulae_Rlist2   ) = 1.110e-03 S  per =   22  per(accum) = 40.2
 T(local: rmmtasks init                ) = 1.166e-03 S  per = 23.2  per(accum) = 63.3
 T(local: qops memset                  ) = 3.000e-08 S  per = 0.000596  per(accum) = 63.3
 T(local: preprocess_renorm_batchGPU   ) = 1.731e-03 S  per = 34.4  per(accum) = 97.7
 T(local: qops memcpy gpu2cpu          ) = 1.904e-05 S  per = 0.378  per(accum) = 98.1
 T(local: deallocate gpu memory        ) = 3.366e-05 S  per = 0.668  per(accum) = 98.7
 T(local: communication of opS and opH ) = 6.381e-05 S  per = 1.27  per(accum) = 100
##### sweep: 7.446e-02 S #####
 T(sweep: fetch) = 1.204e-03 S  per = 1.62  per(accum) = 1.62
 T(sweep: hdiag) = 1.102e-03 S  per = 1.48  per(accum) = 3.1
 T(sweep: dvdsn) = 5.881e-02 S  per =   79  per(accum) = 82.1
 T(sweep: decim) = 1.606e-03 S  per = 2.16  per(accum) = 84.2
 T(sweep: guess) = 9.321e-04 S  per = 1.25  per(accum) = 85.5
 T(sweep: renrm) = 1.027e-02 S  per = 13.8  per(accum) = 99.3
 T(sweep: save ) = 5.309e-04 S  per = 0.713  per(accum) = 100
Detailed decomposition of T(dvdsn): 5.649e-02 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.703e-05 S  per = 0.0301  per(accum) = 0.0301
 T(sweep: symbolic_formulae_twodot     ) = 1.356e-03 S  per =  2.4  per(accum) = 2.43
 T(sweep: hintermediate init           ) = 1.231e-04 S  per = 0.218  per(accum) = 2.65
 T(sweep: hintermediates memcpy cpu2gpu) = 6.100e-08 S  per = 0.000108  per(accum) = 2.65
 T(sweep: preprocess_hformulae_Hxlist2 ) = 7.642e-03 S  per = 13.5  per(accum) = 16.2
 T(sweep: hmmtasks init                ) = 7.453e-03 S  per = 13.2  per(accum) = 29.4
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 3.922e-02 S  per = 69.4  per(accum) = 98.8
 T(sweep: dvdson solver [communication]) = 5.293e-05 S  per = 0.0937  per(accum) = 98.9
 T(sweep: dvdson solver [rest part]    ) = 6.258e-04 S  per = 1.11  per(accum) = 100
Detailed decomposition of T(renrm): 9.951e-03 S
 T(sweep: qops init                    ) = 7.443e-04 S  per = 7.48  per(accum) = 7.48
 T(sweep: qops_dict memcpy cpu2gpu     ) = 8.130e-05 S  per = 0.817  per(accum) = 8.3
 T(sweep: symbolic_formulae_renorm     ) = 1.080e-03 S  per = 10.8  per(accum) = 19.1
 T(sweep: rintermediate init           ) = 9.502e-05 S  per = 0.955  per(accum) = 20.1
 T(sweep: rintermediates memcpy cpu2gpu) = 5.900e-08 S  per = 0.000593  per(accum) = 20.1
 T(sweep: preprocess_formulae_Rlist2   ) = 2.228e-03 S  per = 22.4  per(accum) = 42.5
 T(sweep: rmmtasks init                ) = 2.255e-03 S  per = 22.7  per(accum) = 65.2
 T(sweep: qops memset                  ) = 5.700e-08 S  per = 0.000573  per(accum) = 65.2
 T(sweep: preprocess_renorm_batchGPU   ) = 3.243e-03 S  per = 32.6  per(accum) = 97.7
 T(sweep: qops memcpy gpu2cpu          ) = 3.365e-05 S  per = 0.338  per(accum) = 98.1
 T(sweep: deallocate gpu memory        ) = 7.324e-05 S  per = 0.736  per(accum) = 98.8
 T(sweep: communication of opS and opH ) = 1.172e-04 S  per = 1.18  per(accum) = 100
##### global: 9.000e-01 S #####
 T(global: fetch) = 1.488e-02 S  per = 1.65  per(accum) = 1.65
 T(global: hdiag) = 1.201e-02 S  per = 1.33  per(accum) = 2.99
 T(global: dvdsn) = 7.311e-01 S  per = 81.2  per(accum) = 84.2
 T(global: decim) = 1.919e-02 S  per = 2.13  per(accum) = 86.3
 T(global: guess) = 9.678e-03 S  per = 1.08  per(accum) = 87.4
 T(global: renrm) = 1.069e-01 S  per = 11.9  per(accum) = 99.3
 T(global: save ) = 6.280e-03 S  per = 0.698  per(accum) = 100
Detailed decomposition of T(dvdsn): 7.073e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 2.315e-04 S  per = 0.0327  per(accum) = 0.0327
 T(global: symbolic_formulae_twodot     ) = 1.461e-02 S  per = 2.07  per(accum) = 2.1
 T(global: hintermediate init           ) = 1.297e-03 S  per = 0.183  per(accum) = 2.28
 T(global: hintermediates memcpy cpu2gpu) = 6.470e-07 S  per = 9.15e-05  per(accum) = 2.28
 T(global: preprocess_hformulae_Hxlist2 ) = 7.872e-02 S  per = 11.1  per(accum) = 13.4
 T(global: hmmtasks init                ) = 7.781e-02 S  per =   11  per(accum) = 24.4
 T(global: dvdson solver [Hx_batchGPU]  ) = 5.254e-01 S  per = 74.3  per(accum) = 98.7
 T(global: dvdson solver [communication]) = 7.233e-04 S  per = 0.102  per(accum) = 98.8
 T(global: dvdson solver [rest part]    ) = 8.592e-03 S  per = 1.21  per(accum) = 100
Detailed decomposition of T(renrm): 1.036e-01 S
 T(global: qops init                    ) = 7.876e-03 S  per =  7.6  per(accum) = 7.6
 T(global: qops_dict memcpy cpu2gpu     ) = 9.239e-04 S  per = 0.892  per(accum) = 8.49
 T(global: symbolic_formulae_renorm     ) = 1.182e-02 S  per = 11.4  per(accum) = 19.9
 T(global: rintermediate init           ) = 1.022e-03 S  per = 0.986  per(accum) = 20.9
 T(global: rintermediates memcpy cpu2gpu) = 6.300e-07 S  per = 0.000608  per(accum) = 20.9
 T(global: preprocess_formulae_Rlist2   ) = 2.264e-02 S  per = 21.9  per(accum) = 42.7
 T(global: rmmtasks init                ) = 2.183e-02 S  per = 21.1  per(accum) = 63.8
 T(global: qops memset                  ) = 6.190e-07 S  per = 0.000597  per(accum) = 63.8
 T(global: preprocess_renorm_batchGPU   ) = 3.495e-02 S  per = 33.7  per(accum) = 97.5
 T(global: qops memcpy gpu2cpu          ) = 3.439e-04 S  per = 0.332  per(accum) = 97.9
 T(global: deallocate gpu memory        ) = 8.152e-04 S  per = 0.787  per(accum) = 98.7
 T(global: communication of opS and opH ) = 1.388e-03 S  per = 1.34  per(accum) = 100

isweep=5 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=852:0.0065MB:6.35e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1290:0.00984MB:9.61e-06GB
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44c845c0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
### DIAG TIMING: total=0.000365 t1=1.1e-05, t2=1.68e-05, t3=4.83e-05, t4=0.000123, t5=0.000124, t6=2.7e-05, t7=1.26e-05, t8=2.46e-06
duration_diagGPU:0.000379
duration_diagreduce:4.06e-06
duration_diagtransform:1.76e-06
rank=0 GPUmem(GB): used=2.22e-05 (oper)=9.61e-06
----- TIMING FOR symbolic_formulae_twodot with size=95 : 6.375e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=95
 no. of hintermediate operators=22
 no. of coefficients=44:0.000336MB:3.28e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.564e-05 S -----
rank=0 GPUmem(GB): used=2.25e-05 (oper,hinter)=9.61e-06,3.28e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0033 S size(H_formulae)=95 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000188,0.00311 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00354 S size(H_formulae)=95 size(Hxlst)=2974 -----
rank=0 GPUmem(GB): used=0.000401 (oper,hinter,dvdson,batch)=9.61e-06,3.28e-07,1.49e-06,0.000377 blksize=4 blksize0=8 batchsize=2974
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.3e-05,0.00022,0.00201,0.000198 cost=4.12e+04 flops[gemm]=2.05e+07
--- TIMING FOR sigma : t_inter=0.00022 t_gemm=0.00201 t_reduction=0.000198 tot=0.00243 ---
 sigma counter=205 i=0 t=0.000242 per=12.1 cost=2.58e+03 flops=1.07e+07
 sigma counter=205 i=1 t=0.000245 per=12.2 cost=2.57e+03 flops=1.05e+07
 sigma counter=205 i=2 t=0.000247 per=12.3 cost=3.75e+03 flops=1.52e+07
 sigma counter=205 i=3 t=0.00025 per=12.5 cost=3.77e+03 flops=1.51e+07
 sigma counter=205 i=4 t=0.000253 per=12.6 cost=4.11e+03 flops=1.63e+07
 sigma counter=205 i=5 t=0.00025 per=12.5 cost=4.13e+03 flops=1.65e+07
 sigma counter=205 i=6 t=0.000261 per=13 cost=1.01e+04 flops=3.89e+07
 sigma counter=205 i=7 t=0.000259 per=12.9 cost=1.01e+04 flops=3.92e+07
 total GEMM cost=4.12e+04 flops=2.05e+07
--- TIMING FOR sigma_tot : t_inter=0.0437 t_gemm=0.406 t_reduction=0.0404 tot=0.49 ---
 sigma_tot counter=205 i=0 t=0.0502 per=12.3 cost=5.63e+05 flops=1.12e+07
 sigma_tot counter=205 i=1 t=0.0507 per=12.5 cost=5.7e+05 flops=1.12e+07
 sigma_tot counter=205 i=2 t=0.0496 per=12.2 cost=6.3e+05 flops=1.27e+07
 sigma_tot counter=205 i=3 t=0.0494 per=12.2 cost=6.37e+05 flops=1.29e+07
 sigma_tot counter=205 i=4 t=0.051 per=12.5 cost=1.22e+06 flops=2.39e+07
 sigma_tot counter=205 i=5 t=0.0513 per=12.6 cost=1.22e+06 flops=2.39e+07
 sigma_tot counter=205 i=6 t=0.0529 per=13 cost=1.37e+06 flops=2.6e+07
 sigma_tot counter=205 i=7 t=0.0512 per=12.6 cost=1.37e+06 flops=2.68e+07
 total GEMM cost=7.59e+06 flops=1.87e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.1e-05,0.000214,0.00201,0.000197 cost=4.12e+04 flops[gemm]=2.05e+07
--- TIMING FOR sigma : t_inter=0.000214 t_gemm=0.00201 t_reduction=0.000197 tot=0.00242 ---
 sigma counter=206 i=0 t=0.000242 per=12.1 cost=2.58e+03 flops=1.07e+07
 sigma counter=206 i=1 t=0.000252 per=12.6 cost=2.57e+03 flops=1.02e+07
 sigma counter=206 i=2 t=0.000246 per=12.3 cost=3.75e+03 flops=1.53e+07
 sigma counter=206 i=3 t=0.000246 per=12.3 cost=3.77e+03 flops=1.53e+07
 sigma counter=206 i=4 t=0.000252 per=12.6 cost=4.11e+03 flops=1.63e+07
 sigma counter=206 i=5 t=0.000253 per=12.6 cost=4.13e+03 flops=1.63e+07
 sigma counter=206 i=6 t=0.000262 per=13.1 cost=1.01e+04 flops=3.87e+07
 sigma counter=206 i=7 t=0.000254 per=12.7 cost=1.01e+04 flops=3.99e+07
 total GEMM cost=4.12e+04 flops=2.05e+07
--- TIMING FOR sigma_tot : t_inter=0.0439 t_gemm=0.408 t_reduction=0.0406 tot=0.493 ---
 sigma_tot counter=206 i=0 t=0.0504 per=12.3 cost=5.66e+05 flops=1.12e+07
 sigma_tot counter=206 i=1 t=0.051 per=12.5 cost=5.72e+05 flops=1.12e+07
 sigma_tot counter=206 i=2 t=0.0499 per=12.2 cost=6.34e+05 flops=1.27e+07
 sigma_tot counter=206 i=3 t=0.0497 per=12.2 cost=6.41e+05 flops=1.29e+07
 sigma_tot counter=206 i=4 t=0.0512 per=12.5 cost=1.22e+06 flops=2.39e+07
 sigma_tot counter=206 i=5 t=0.0515 per=12.6 cost=1.23e+06 flops=2.38e+07
 sigma_tot counter=206 i=6 t=0.0531 per=13 cost=1.38e+06 flops=2.6e+07
 sigma_tot counter=206 i=7 t=0.0514 per=12.6 cost=1.38e+06 flops=2.68e+07
 total GEMM cost=7.63e+06 flops=1.87e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592 -1.003e+03  7.009e-02    2     2  5.299e-03 2.650e-03
    1   1 -      -2.436094100141 -1.002e+03  4.918e-02    2     2  5.299e-03 2.650e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.170e-04,2.033e-03,1.980e-04 cost=4.121e+04 flops[gemm]=2.027e+07
--- TIMING FOR sigma : t_inter=2.170e-04 t_gemm=2.033e-03 t_reduction=1.980e-04 tot=2.448e-03 ---
 sigma counter=207 i=0 t=2.420e-04 per=1.190e+01 cost=2.582e+03 flops=1.067e+07
 sigma counter=207 i=1 t=2.490e-04 per=1.225e+01 cost=2.572e+03 flops=1.033e+07
 sigma counter=207 i=2 t=2.550e-04 per=1.254e+01 cost=3.754e+03 flops=1.472e+07
 sigma counter=207 i=3 t=2.540e-04 per=1.249e+01 cost=3.774e+03 flops=1.486e+07
 sigma counter=207 i=4 t=2.550e-04 per=1.254e+01 cost=4.112e+03 flops=1.613e+07
 sigma counter=207 i=5 t=2.590e-04 per=1.274e+01 cost=4.132e+03 flops=1.595e+07
 sigma counter=207 i=6 t=2.670e-04 per=1.313e+01 cost=1.014e+04 flops=3.799e+07
 sigma counter=207 i=7 t=2.520e-04 per=1.240e+01 cost=1.014e+04 flops=4.025e+07
 total GEMM cost=4.121e+04 flops=2.027e+07
--- TIMING FOR sigma_tot : t_inter=4.416e-02 t_gemm=4.103e-01 t_reduction=4.082e-02 tot=4.953e-01 ---
 sigma_tot counter=207 i=0 t=5.065e-02 per=1.234e+01 cost=5.685e+05 flops=1.122e+07
 sigma_tot counter=207 i=1 t=5.125e-02 per=1.249e+01 cost=5.750e+05 flops=1.122e+07
 sigma_tot counter=207 i=2 t=5.011e-02 per=1.221e+01 cost=6.375e+05 flops=1.272e+07
 sigma_tot counter=207 i=3 t=4.995e-02 per=1.217e+01 cost=6.450e+05 flops=1.291e+07
 sigma_tot counter=207 i=4 t=5.148e-02 per=1.255e+01 cost=1.228e+06 flops=2.386e+07
 sigma_tot counter=207 i=5 t=5.179e-02 per=1.262e+01 cost=1.231e+06 flops=2.377e+07
 sigma_tot counter=207 i=6 t=5.341e-02 per=1.302e+01 cost=1.394e+06 flops=2.611e+07
 sigma_tot counter=207 i=7 t=5.166e-02 per=1.259e+01 cost=1.389e+06 flops=2.688e+07
 total GEMM cost=7.669e+06 flops=1.869e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.130e-04,2.001e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.060e+07
--- TIMING FOR sigma : t_inter=2.130e-04 t_gemm=2.000e-03 t_reduction=1.960e-04 tot=2.409e-03 ---
 sigma counter=208 i=0 t=2.380e-04 per=1.190e+01 cost=2.582e+03 flops=1.085e+07
 sigma counter=208 i=1 t=2.470e-04 per=1.235e+01 cost=2.572e+03 flops=1.041e+07
 sigma counter=208 i=2 t=2.450e-04 per=1.225e+01 cost=3.754e+03 flops=1.532e+07
 sigma counter=208 i=3 t=2.500e-04 per=1.250e+01 cost=3.774e+03 flops=1.510e+07
 sigma counter=208 i=4 t=2.500e-04 per=1.250e+01 cost=4.112e+03 flops=1.645e+07
 sigma counter=208 i=5 t=2.510e-04 per=1.255e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=208 i=6 t=2.610e-04 per=1.305e+01 cost=1.014e+04 flops=3.887e+07
 sigma counter=208 i=7 t=2.580e-04 per=1.290e+01 cost=1.014e+04 flops=3.932e+07
 total GEMM cost=4.121e+04 flops=2.061e+07
--- TIMING FOR sigma_tot : t_inter=4.437e-02 t_gemm=4.123e-01 t_reduction=4.102e-02 tot=4.977e-01 ---
 sigma_tot counter=208 i=0 t=5.089e-02 per=1.234e+01 cost=5.711e+05 flops=1.122e+07
 sigma_tot counter=208 i=1 t=5.149e-02 per=1.249e+01 cost=5.776e+05 flops=1.122e+07
 sigma_tot counter=208 i=2 t=5.036e-02 per=1.221e+01 cost=6.413e+05 flops=1.273e+07
 sigma_tot counter=208 i=3 t=5.020e-02 per=1.218e+01 cost=6.487e+05 flops=1.292e+07
 sigma_tot counter=208 i=4 t=5.173e-02 per=1.255e+01 cost=1.233e+06 flops=2.383e+07
 sigma_tot counter=208 i=5 t=5.204e-02 per=1.262e+01 cost=1.235e+06 flops=2.374e+07
 sigma_tot counter=208 i=6 t=5.367e-02 per=1.302e+01 cost=1.405e+06 flops=2.617e+07
 sigma_tot counter=208 i=7 t=5.192e-02 per=1.259e+01 cost=1.399e+06 flops=2.694e+07
 total GEMM cost=7.710e+06 flops=1.870e+07
    2   0 -      -2.654426863105 -1.838e-03  1.257e-02    4     4  1.060e-02 2.650e-03
    2   1 -      -2.436959129202 -8.650e-04  5.189e-03    4     4  1.060e-02 2.650e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.300e-05,2.180e-04,2.013e-03,2.010e-04 cost=4.121e+04 flops[gemm]=2.047e+07
--- TIMING FOR sigma : t_inter=2.180e-04 t_gemm=2.013e-03 t_reduction=2.010e-04 tot=2.432e-03 ---
 sigma counter=209 i=0 t=2.440e-04 per=1.212e+01 cost=2.582e+03 flops=1.058e+07
 sigma counter=209 i=1 t=2.500e-04 per=1.242e+01 cost=2.572e+03 flops=1.029e+07
 sigma counter=209 i=2 t=2.510e-04 per=1.247e+01 cost=3.754e+03 flops=1.496e+07
 sigma counter=209 i=3 t=2.480e-04 per=1.232e+01 cost=3.774e+03 flops=1.522e+07
 sigma counter=209 i=4 t=2.540e-04 per=1.262e+01 cost=4.112e+03 flops=1.619e+07
 sigma counter=209 i=5 t=2.490e-04 per=1.237e+01 cost=4.132e+03 flops=1.659e+07
 sigma counter=209 i=6 t=2.620e-04 per=1.302e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=209 i=7 t=2.550e-04 per=1.267e+01 cost=1.014e+04 flops=3.978e+07
 total GEMM cost=4.121e+04 flops=2.047e+07
--- TIMING FOR sigma_tot : t_inter=4.459e-02 t_gemm=4.143e-01 t_reduction=4.122e-02 tot=5.001e-01 ---
 sigma_tot counter=209 i=0 t=5.113e-02 per=1.234e+01 cost=5.736e+05 flops=1.122e+07
 sigma_tot counter=209 i=1 t=5.174e-02 per=1.249e+01 cost=5.802e+05 flops=1.121e+07
 sigma_tot counter=209 i=2 t=5.061e-02 per=1.222e+01 cost=6.450e+05 flops=1.275e+07
 sigma_tot counter=209 i=3 t=5.045e-02 per=1.218e+01 cost=6.525e+05 flops=1.293e+07
 sigma_tot counter=209 i=4 t=5.198e-02 per=1.255e+01 cost=1.237e+06 flops=2.379e+07
 sigma_tot counter=209 i=5 t=5.229e-02 per=1.262e+01 cost=1.240e+06 flops=2.370e+07
 sigma_tot counter=209 i=6 t=5.394e-02 per=1.302e+01 cost=1.415e+06 flops=2.623e+07
 sigma_tot counter=209 i=7 t=5.217e-02 per=1.259e+01 cost=1.409e+06 flops=2.701e+07
 total GEMM cost=7.751e+06 flops=1.871e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.100e-04,1.986e-03,1.940e-04 cost=4.121e+04 flops[gemm]=2.075e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=1.986e-03 t_reduction=1.940e-04 tot=2.390e-03 ---
 sigma counter=210 i=0 t=2.380e-04 per=1.198e+01 cost=2.582e+03 flops=1.085e+07
 sigma counter=210 i=1 t=2.370e-04 per=1.193e+01 cost=2.572e+03 flops=1.085e+07
 sigma counter=210 i=2 t=2.480e-04 per=1.249e+01 cost=3.754e+03 flops=1.514e+07
 sigma counter=210 i=3 t=2.460e-04 per=1.239e+01 cost=3.774e+03 flops=1.534e+07
 sigma counter=210 i=4 t=2.490e-04 per=1.254e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=210 i=5 t=2.520e-04 per=1.269e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=210 i=6 t=2.610e-04 per=1.314e+01 cost=1.014e+04 flops=3.887e+07
 sigma counter=210 i=7 t=2.550e-04 per=1.284e+01 cost=1.014e+04 flops=3.978e+07
 total GEMM cost=4.121e+04 flops=2.075e+07
--- TIMING FOR sigma_tot : t_inter=4.480e-02 t_gemm=4.163e-01 t_reduction=4.141e-02 tot=5.025e-01 ---
 sigma_tot counter=210 i=0 t=5.137e-02 per=1.234e+01 cost=5.762e+05 flops=1.122e+07
 sigma_tot counter=210 i=1 t=5.198e-02 per=1.249e+01 cost=5.828e+05 flops=1.121e+07
 sigma_tot counter=210 i=2 t=5.086e-02 per=1.222e+01 cost=6.488e+05 flops=1.276e+07
 sigma_tot counter=210 i=3 t=5.069e-02 per=1.218e+01 cost=6.563e+05 flops=1.295e+07
 sigma_tot counter=210 i=4 t=5.223e-02 per=1.255e+01 cost=1.241e+06 flops=2.375e+07
 sigma_tot counter=210 i=5 t=5.254e-02 per=1.262e+01 cost=1.244e+06 flops=2.367e+07
 sigma_tot counter=210 i=6 t=5.420e-02 per=1.302e+01 cost=1.425e+06 flops=2.629e+07
 sigma_tot counter=210 i=7 t=5.243e-02 per=1.259e+01 cost=1.419e+06 flops=2.707e+07
 total GEMM cost=7.793e+06 flops=1.872e+07
    3   0 -      -2.654508902835 -8.204e-05  3.559e-03    6     6  1.585e-02 2.641e-03
    3   1 -      -2.436975259478 -1.613e-05  1.592e-03    6     6  1.585e-02 2.641e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.160e-04,1.990e-03,1.950e-04 cost=4.121e+04 flops[gemm]=2.071e+07
--- TIMING FOR sigma : t_inter=2.160e-04 t_gemm=1.988e-03 t_reduction=1.950e-04 tot=2.399e-03 ---
 sigma counter=211 i=0 t=2.410e-04 per=1.212e+01 cost=2.582e+03 flops=1.071e+07
 sigma counter=211 i=1 t=2.460e-04 per=1.237e+01 cost=2.572e+03 flops=1.046e+07
 sigma counter=211 i=2 t=2.440e-04 per=1.227e+01 cost=3.754e+03 flops=1.539e+07
 sigma counter=211 i=3 t=2.450e-04 per=1.232e+01 cost=3.774e+03 flops=1.540e+07
 sigma counter=211 i=4 t=2.500e-04 per=1.258e+01 cost=4.112e+03 flops=1.645e+07
 sigma counter=211 i=5 t=2.500e-04 per=1.258e+01 cost=4.132e+03 flops=1.653e+07
 sigma counter=211 i=6 t=2.600e-04 per=1.308e+01 cost=1.014e+04 flops=3.902e+07
 sigma counter=211 i=7 t=2.520e-04 per=1.268e+01 cost=1.014e+04 flops=4.025e+07
 total GEMM cost=4.121e+04 flops=2.073e+07
--- TIMING FOR sigma_tot : t_inter=4.501e-02 t_gemm=4.183e-01 t_reduction=4.161e-02 tot=5.049e-01 ---
 sigma_tot counter=211 i=0 t=5.161e-02 per=1.234e+01 cost=5.788e+05 flops=1.121e+07
 sigma_tot counter=211 i=1 t=5.223e-02 per=1.249e+01 cost=5.853e+05 flops=1.121e+07
 sigma_tot counter=211 i=2 t=5.110e-02 per=1.222e+01 cost=6.526e+05 flops=1.277e+07
 sigma_tot counter=211 i=3 t=5.094e-02 per=1.218e+01 cost=6.600e+05 flops=1.296e+07
 sigma_tot counter=211 i=4 t=5.248e-02 per=1.255e+01 cost=1.245e+06 flops=2.372e+07
 sigma_tot counter=211 i=5 t=5.279e-02 per=1.262e+01 cost=1.248e+06 flops=2.364e+07
 sigma_tot counter=211 i=6 t=5.446e-02 per=1.302e+01 cost=1.435e+06 flops=2.635e+07
 sigma_tot counter=211 i=7 t=5.268e-02 per=1.259e+01 cost=1.429e+06 flops=2.713e+07
 total GEMM cost=7.834e+06 flops=1.873e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.080e-04,2.021e-03,1.940e-04 cost=4.121e+04 flops[gemm]=2.039e+07
--- TIMING FOR sigma : t_inter=2.080e-04 t_gemm=2.021e-03 t_reduction=1.940e-04 tot=2.423e-03 ---
 sigma counter=212 i=0 t=2.400e-04 per=1.188e+01 cost=2.582e+03 flops=1.076e+07
 sigma counter=212 i=1 t=2.420e-04 per=1.197e+01 cost=2.572e+03 flops=1.063e+07
 sigma counter=212 i=2 t=2.510e-04 per=1.242e+01 cost=3.754e+03 flops=1.496e+07
 sigma counter=212 i=3 t=2.490e-04 per=1.232e+01 cost=3.774e+03 flops=1.516e+07
 sigma counter=212 i=4 t=2.530e-04 per=1.252e+01 cost=4.112e+03 flops=1.625e+07
 sigma counter=212 i=5 t=2.570e-04 per=1.272e+01 cost=4.132e+03 flops=1.608e+07
 sigma counter=212 i=6 t=2.660e-04 per=1.316e+01 cost=1.014e+04 flops=3.814e+07
 sigma counter=212 i=7 t=2.630e-04 per=1.301e+01 cost=1.014e+04 flops=3.857e+07
 total GEMM cost=4.121e+04 flops=2.039e+07
--- TIMING FOR sigma_tot : t_inter=4.522e-02 t_gemm=4.203e-01 t_reduction=4.180e-02 tot=5.073e-01 ---
 sigma_tot counter=212 i=0 t=5.185e-02 per=1.234e+01 cost=5.814e+05 flops=1.121e+07
 sigma_tot counter=212 i=1 t=5.247e-02 per=1.248e+01 cost=5.879e+05 flops=1.121e+07
 sigma_tot counter=212 i=2 t=5.135e-02 per=1.222e+01 cost=6.563e+05 flops=1.278e+07
 sigma_tot counter=212 i=3 t=5.119e-02 per=1.218e+01 cost=6.638e+05 flops=1.297e+07
 sigma_tot counter=212 i=4 t=5.274e-02 per=1.255e+01 cost=1.249e+06 flops=2.368e+07
 sigma_tot counter=212 i=5 t=5.305e-02 per=1.262e+01 cost=1.252e+06 flops=2.360e+07
 sigma_tot counter=212 i=6 t=5.472e-02 per=1.302e+01 cost=1.445e+06 flops=2.641e+07
 sigma_tot counter=212 i=7 t=5.294e-02 per=1.260e+01 cost=1.439e+06 flops=2.719e+07
 total GEMM cost=7.875e+06 flops=1.874e+07
    4   0 -      -2.654515665767 -6.763e-06  1.294e-03    6     8  2.110e-02 2.638e-03
    4   1 -      -2.436977069548 -1.810e-06  5.993e-04    6     8  2.110e-02 2.638e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.300e-05,2.180e-04,1.990e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.071e+07
--- TIMING FOR sigma : t_inter=2.180e-04 t_gemm=1.990e-03 t_reduction=1.960e-04 tot=2.404e-03 ---
 sigma counter=213 i=0 t=2.400e-04 per=1.206e+01 cost=2.582e+03 flops=1.076e+07
 sigma counter=213 i=1 t=2.430e-04 per=1.221e+01 cost=2.572e+03 flops=1.058e+07
 sigma counter=213 i=2 t=2.460e-04 per=1.236e+01 cost=3.754e+03 flops=1.526e+07
 sigma counter=213 i=3 t=2.480e-04 per=1.246e+01 cost=3.774e+03 flops=1.522e+07
 sigma counter=213 i=4 t=2.490e-04 per=1.251e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=213 i=5 t=2.510e-04 per=1.261e+01 cost=4.132e+03 flops=1.646e+07
 sigma counter=213 i=6 t=2.600e-04 per=1.307e+01 cost=1.014e+04 flops=3.902e+07
 sigma counter=213 i=7 t=2.530e-04 per=1.271e+01 cost=1.014e+04 flops=4.009e+07
 total GEMM cost=4.121e+04 flops=2.071e+07
--- TIMING FOR sigma_tot : t_inter=4.544e-02 t_gemm=4.223e-01 t_reduction=4.200e-02 tot=5.097e-01 ---
 sigma_tot counter=213 i=0 t=5.209e-02 per=1.234e+01 cost=5.840e+05 flops=1.121e+07
 sigma_tot counter=213 i=1 t=5.271e-02 per=1.248e+01 cost=5.905e+05 flops=1.120e+07
 sigma_tot counter=213 i=2 t=5.160e-02 per=1.222e+01 cost=6.601e+05 flops=1.279e+07
 sigma_tot counter=213 i=3 t=5.143e-02 per=1.218e+01 cost=6.676e+05 flops=1.298e+07
 sigma_tot counter=213 i=4 t=5.299e-02 per=1.255e+01 cost=1.253e+06 flops=2.365e+07
 sigma_tot counter=213 i=5 t=5.330e-02 per=1.262e+01 cost=1.256e+06 flops=2.357e+07
 sigma_tot counter=213 i=6 t=5.498e-02 per=1.302e+01 cost=1.455e+06 flops=2.647e+07
 sigma_tot counter=213 i=7 t=5.319e-02 per=1.260e+01 cost=1.450e+06 flops=2.725e+07
 total GEMM cost=7.916e+06 flops=1.875e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.110e-04,1.991e-03,1.990e-04 cost=4.121e+04 flops[gemm]=2.070e+07
--- TIMING FOR sigma : t_inter=2.110e-04 t_gemm=1.991e-03 t_reduction=1.990e-04 tot=2.401e-03 ---
 sigma counter=214 i=0 t=2.440e-04 per=1.226e+01 cost=2.582e+03 flops=1.058e+07
 sigma counter=214 i=1 t=2.460e-04 per=1.236e+01 cost=2.572e+03 flops=1.046e+07
 sigma counter=214 i=2 t=2.440e-04 per=1.226e+01 cost=3.754e+03 flops=1.539e+07
 sigma counter=214 i=3 t=2.440e-04 per=1.226e+01 cost=3.774e+03 flops=1.547e+07
 sigma counter=214 i=4 t=2.480e-04 per=1.246e+01 cost=4.112e+03 flops=1.658e+07
 sigma counter=214 i=5 t=2.520e-04 per=1.266e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=214 i=6 t=2.580e-04 per=1.296e+01 cost=1.014e+04 flops=3.932e+07
 sigma counter=214 i=7 t=2.550e-04 per=1.281e+01 cost=1.014e+04 flops=3.978e+07
 total GEMM cost=4.121e+04 flops=2.070e+07
--- TIMING FOR sigma_tot : t_inter=4.565e-02 t_gemm=4.243e-01 t_reduction=4.220e-02 tot=5.121e-01 ---
 sigma_tot counter=214 i=0 t=5.234e-02 per=1.233e+01 cost=5.866e+05 flops=1.121e+07
 sigma_tot counter=214 i=1 t=5.296e-02 per=1.248e+01 cost=5.931e+05 flops=1.120e+07
 sigma_tot counter=214 i=2 t=5.184e-02 per=1.222e+01 cost=6.638e+05 flops=1.280e+07
 sigma_tot counter=214 i=3 t=5.168e-02 per=1.218e+01 cost=6.714e+05 flops=1.299e+07
 sigma_tot counter=214 i=4 t=5.323e-02 per=1.255e+01 cost=1.257e+06 flops=2.362e+07
 sigma_tot counter=214 i=5 t=5.355e-02 per=1.262e+01 cost=1.260e+06 flops=2.353e+07
 sigma_tot counter=214 i=6 t=5.524e-02 per=1.302e+01 cost=1.465e+06 flops=2.653e+07
 sigma_tot counter=214 i=7 t=5.345e-02 per=1.260e+01 cost=1.460e+06 flops=2.731e+07
 total GEMM cost=7.957e+06 flops=1.875e+07
    5   0 -      -2.654516771324 -1.106e-06  5.133e-04    6    10  2.633e-02 2.633e-03
    5   1 -      -2.436977368102 -2.986e-07  2.915e-04    6    10  2.633e-02 2.633e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.090e-04,2.000e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.061e+07
--- TIMING FOR sigma : t_inter=2.090e-04 t_gemm=1.999e-03 t_reduction=1.960e-04 tot=2.404e-03 ---
 sigma counter=215 i=0 t=2.410e-04 per=1.206e+01 cost=2.582e+03 flops=1.071e+07
 sigma counter=215 i=1 t=2.480e-04 per=1.241e+01 cost=2.572e+03 flops=1.037e+07
 sigma counter=215 i=2 t=2.440e-04 per=1.221e+01 cost=3.754e+03 flops=1.539e+07
 sigma counter=215 i=3 t=2.450e-04 per=1.226e+01 cost=3.774e+03 flops=1.540e+07
 sigma counter=215 i=4 t=2.490e-04 per=1.246e+01 cost=4.112e+03 flops=1.651e+07
 sigma counter=215 i=5 t=2.530e-04 per=1.266e+01 cost=4.132e+03 flops=1.633e+07
 sigma counter=215 i=6 t=2.650e-04 per=1.326e+01 cost=1.014e+04 flops=3.828e+07
 sigma counter=215 i=7 t=2.540e-04 per=1.271e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.062e+07
--- TIMING FOR sigma_tot : t_inter=4.586e-02 t_gemm=4.263e-01 t_reduction=4.239e-02 tot=5.145e-01 ---
 sigma_tot counter=215 i=0 t=5.258e-02 per=1.233e+01 cost=5.891e+05 flops=1.121e+07
 sigma_tot counter=215 i=1 t=5.321e-02 per=1.248e+01 cost=5.956e+05 flops=1.119e+07
 sigma_tot counter=215 i=2 t=5.209e-02 per=1.222e+01 cost=6.676e+05 flops=1.282e+07
 sigma_tot counter=215 i=3 t=5.192e-02 per=1.218e+01 cost=6.751e+05 flops=1.300e+07
 sigma_tot counter=215 i=4 t=5.348e-02 per=1.255e+01 cost=1.261e+06 flops=2.358e+07
 sigma_tot counter=215 i=5 t=5.381e-02 per=1.262e+01 cost=1.264e+06 flops=2.350e+07
 sigma_tot counter=215 i=6 t=5.551e-02 per=1.302e+01 cost=1.476e+06 flops=2.658e+07
 sigma_tot counter=215 i=7 t=5.370e-02 per=1.260e+01 cost=1.470e+06 flops=2.737e+07
 total GEMM cost=7.999e+06 flops=1.876e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.100e-05,2.100e-04,1.997e-03,1.960e-04 cost=4.121e+04 flops[gemm]=2.064e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=1.996e-03 t_reduction=1.960e-04 tot=2.402e-03 ---
 sigma counter=216 i=0 t=2.400e-04 per=1.202e+01 cost=2.582e+03 flops=1.076e+07
 sigma counter=216 i=1 t=2.480e-04 per=1.242e+01 cost=2.572e+03 flops=1.037e+07
 sigma counter=216 i=2 t=2.440e-04 per=1.222e+01 cost=3.754e+03 flops=1.539e+07
 sigma counter=216 i=3 t=2.470e-04 per=1.237e+01 cost=3.774e+03 flops=1.528e+07
 sigma counter=216 i=4 t=2.480e-04 per=1.242e+01 cost=4.112e+03 flops=1.658e+07
 sigma counter=216 i=5 t=2.500e-04 per=1.253e+01 cost=4.132e+03 flops=1.653e+07
 sigma counter=216 i=6 t=2.620e-04 per=1.313e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=216 i=7 t=2.570e-04 per=1.288e+01 cost=1.014e+04 flops=3.947e+07
 total GEMM cost=4.121e+04 flops=2.065e+07
--- TIMING FOR sigma_tot : t_inter=4.607e-02 t_gemm=4.283e-01 t_reduction=4.259e-02 tot=5.169e-01 ---
 sigma_tot counter=216 i=0 t=5.282e-02 per=1.233e+01 cost=5.917e+05 flops=1.120e+07
 sigma_tot counter=216 i=1 t=5.345e-02 per=1.248e+01 cost=5.982e+05 flops=1.119e+07
 sigma_tot counter=216 i=2 t=5.233e-02 per=1.222e+01 cost=6.713e+05 flops=1.283e+07
 sigma_tot counter=216 i=3 t=5.217e-02 per=1.218e+01 cost=6.789e+05 flops=1.301e+07
 sigma_tot counter=216 i=4 t=5.373e-02 per=1.255e+01 cost=1.265e+06 flops=2.355e+07
 sigma_tot counter=216 i=5 t=5.406e-02 per=1.262e+01 cost=1.268e+06 flops=2.347e+07
 sigma_tot counter=216 i=6 t=5.577e-02 per=1.302e+01 cost=1.486e+06 flops=2.664e+07
 sigma_tot counter=216 i=7 t=5.396e-02 per=1.260e+01 cost=1.480e+06 flops=2.743e+07
 total GEMM cost=8.040e+06 flops=1.877e+07
    6   0 -      -2.654516945140 -1.738e-07  1.835e-04    6    12  3.156e-02 2.630e-03
    6   1 -      -2.436977443846 -7.574e-08  1.163e-04    6    12  3.156e-02 2.630e-03
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.220e-04,2.017e-03,1.980e-04 cost=4.121e+04 flops[gemm]=2.043e+07
--- TIMING FOR sigma : t_inter=2.220e-04 t_gemm=2.016e-03 t_reduction=1.980e-04 tot=2.436e-03 ---
 sigma counter=217 i=0 t=2.490e-04 per=1.235e+01 cost=2.582e+03 flops=1.037e+07
 sigma counter=217 i=1 t=2.460e-04 per=1.220e+01 cost=2.572e+03 flops=1.046e+07
 sigma counter=217 i=2 t=2.500e-04 per=1.240e+01 cost=3.754e+03 flops=1.502e+07
 sigma counter=217 i=3 t=2.470e-04 per=1.225e+01 cost=3.774e+03 flops=1.528e+07
 sigma counter=217 i=4 t=2.540e-04 per=1.260e+01 cost=4.112e+03 flops=1.619e+07
 sigma counter=217 i=5 t=2.530e-04 per=1.255e+01 cost=4.132e+03 flops=1.633e+07
 sigma counter=217 i=6 t=2.620e-04 per=1.300e+01 cost=1.014e+04 flops=3.872e+07
 sigma counter=217 i=7 t=2.550e-04 per=1.265e+01 cost=1.014e+04 flops=3.978e+07
 total GEMM cost=4.121e+04 flops=2.044e+07
--- TIMING FOR sigma_tot : t_inter=4.629e-02 t_gemm=4.303e-01 t_reduction=4.279e-02 tot=5.194e-01 ---
 sigma_tot counter=217 i=0 t=5.307e-02 per=1.233e+01 cost=5.943e+05 flops=1.120e+07
 sigma_tot counter=217 i=1 t=5.370e-02 per=1.248e+01 cost=6.008e+05 flops=1.119e+07
 sigma_tot counter=217 i=2 t=5.258e-02 per=1.222e+01 cost=6.751e+05 flops=1.284e+07
 sigma_tot counter=217 i=3 t=5.242e-02 per=1.218e+01 cost=6.827e+05 flops=1.302e+07
 sigma_tot counter=217 i=4 t=5.398e-02 per=1.255e+01 cost=1.270e+06 flops=2.352e+07
 sigma_tot counter=217 i=5 t=5.431e-02 per=1.262e+01 cost=1.273e+06 flops=2.343e+07
 sigma_tot counter=217 i=6 t=5.603e-02 per=1.302e+01 cost=1.496e+06 flops=2.670e+07
 sigma_tot counter=217 i=7 t=5.421e-02 per=1.260e+01 cost=1.490e+06 flops=2.749e+07
 total GEMM cost=8.081e+06 flops=1.878e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.200e-05,2.100e-04,1.992e-03,1.930e-04 cost=4.121e+04 flops[gemm]=2.069e+07
--- TIMING FOR sigma : t_inter=2.100e-04 t_gemm=1.992e-03 t_reduction=1.930e-04 tot=2.395e-03 ---
 sigma counter=218 i=0 t=2.380e-04 per=1.195e+01 cost=2.582e+03 flops=1.085e+07
 sigma counter=218 i=1 t=2.360e-04 per=1.185e+01 cost=2.572e+03 flops=1.090e+07
 sigma counter=218 i=2 t=2.480e-04 per=1.245e+01 cost=3.754e+03 flops=1.514e+07
 sigma counter=218 i=3 t=2.470e-04 per=1.240e+01 cost=3.774e+03 flops=1.528e+07
 sigma counter=218 i=4 t=2.500e-04 per=1.255e+01 cost=4.112e+03 flops=1.645e+07
 sigma counter=218 i=5 t=2.520e-04 per=1.265e+01 cost=4.132e+03 flops=1.640e+07
 sigma counter=218 i=6 t=2.670e-04 per=1.340e+01 cost=1.014e+04 flops=3.799e+07
 sigma counter=218 i=7 t=2.540e-04 per=1.275e+01 cost=1.014e+04 flops=3.994e+07
 total GEMM cost=4.121e+04 flops=2.069e+07
--- TIMING FOR sigma_tot : t_inter=4.650e-02 t_gemm=4.323e-01 t_reduction=4.298e-02 tot=5.218e-01 ---
 sigma_tot counter=218 i=0 t=5.330e-02 per=1.233e+01 cost=5.969e+05 flops=1.120e+07
 sigma_tot counter=218 i=1 t=5.394e-02 per=1.248e+01 cost=6.033e+05 flops=1.119e+07
 sigma_tot counter=218 i=2 t=5.283e-02 per=1.222e+01 cost=6.788e+05 flops=1.285e+07
 sigma_tot counter=218 i=3 t=5.266e-02 per=1.218e+01 cost=6.865e+05 flops=1.303e+07
 sigma_tot counter=218 i=4 t=5.423e-02 per=1.255e+01 cost=1.274e+06 flops=2.348e+07
 sigma_tot counter=218 i=5 t=5.456e-02 per=1.262e+01 cost=1.277e+06 flops=2.340e+07
 sigma_tot counter=218 i=6 t=5.630e-02 per=1.302e+01 cost=1.506e+06 flops=2.675e+07
 sigma_tot counter=218 i=7 t=5.447e-02 per=1.260e+01 cost=1.500e+06 flops=2.754e+07
 total GEMM cost=8.122e+06 flops=1.879e+07
    7   0 +      -2.654516966643 -2.150e-08  4.639e-05    6    14  3.682e-02 2.630e-03
    7   1 +      -2.436977450693 -6.847e-09  2.690e-05    6    14  3.682e-02 2.630e-03
TIMING FOR Davidson : 3.684e-02  T(cal/comm/rest)=3.625e-02,4.713e-05,5.450e-04
optimized energies: isweep=5 dots=2 ibond=2 e[0]=-2.65451696664 nmvp=14
optimized energies: isweep=5 dots=2 ibond=2 e[1]=-2.43697745069 nmvp=14
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=9 alg_decim=1 mpisize=2 maxthreads=2
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
TIMING FOR decimation: 4.0e-04 S T(wf/decim)=3.3e-04,7.3e-05
ctns::oper_renorm coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=872:6.7e-03MB:6.5e-06GB
rank=0 GPUmem(GB): used=2.3e-05 (oper)=8.7e-06
rank=0 GPUmem(GB): used=2.3e-05 (oper,site)(GB)=8.7e-06,2.7e-07
----- TIMING FOR symbolic_formulae_renorm with size=37 : 5.763e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=2.29e-05 (oper,site,rinter)=8.67e-06,2.68e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000972 S size(rtasks)=37 size(Rlst2)=9 T(Rmu/Rlist)=0.000202,0.000771 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00105 S size(rtasks)=37 size(Rlst)=788 -----
rank=0 GPUmem(GB): used=0.000217 (oper,site,rinter,batch)=8.67e-06,2.68e-07,0,0.000194 blksize=16 blksize0=0 batchsize=788
timing: allocate=3.52e-05 rmmtasks init=0.000919 total=0.000954
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=5e-06,0.00116,0.000195 cost=1.56e+04 flops[gemm]=1.34e+07
--- TIMING FOR renorm : t_inter=5e-06 t_gemm=0.00116 t_reduction=0.000195 tot=0.00136 ---
 renorm counter=23 i=0 t=0.000233 per=20.1 cost=874 flops=3.75e+06
 renorm counter=23 i=1 t=0.000232 per=20 cost=1.76e+03 flops=7.59e+06
 renorm counter=23 i=2 t=0.00022 per=19 cost=994 flops=4.52e+06
 renorm counter=23 i=3 t=0.000225 per=19.4 cost=1.75e+03 flops=7.78e+06
 renorm counter=23 i=4 t=0 per=0 cost=0 flops=-nan
 renorm counter=23 i=5 t=1e-06 per=0.0863 cost=0 flops=0
 renorm counter=23 i=6 t=0.000248 per=21.4 cost=1.02e+04 flops=4.11e+07
 total GEMM cost=1.56e+04 flops=1.34e+07
--- TIMING FOR renorm_tot : t_inter=0.00237 t_gemm=0.0267 t_reduction=0.00464 tot=0.0337 ---
 renorm_tot counter=23 i=0 t=0.00535 per=20.1 cost=4.98e+04 flops=9.3e+06
 renorm_tot counter=23 i=1 t=0.00526 per=19.7 cost=7.35e+04 flops=1.4e+07
 renorm_tot counter=23 i=2 t=0.00244 per=9.16 cost=4.52e+04 flops=1.85e+07
 renorm_tot counter=23 i=3 t=0.00248 per=9.3 cost=7.81e+04 flops=3.15e+07
 renorm_tot counter=23 i=4 t=0.0027 per=10.1 cost=5.7e+04 flops=2.11e+07
 renorm_tot counter=23 i=5 t=0.00274 per=10.3 cost=9.96e+04 flops=3.64e+07
 renorm_tot counter=23 i=6 t=0.00572 per=21.4 cost=6.29e+05 flops=1.1e+08
 total GEMM cost=1.03e+06 flops=3.87e+07
timing: gpu2cpu=1.51e-05 deallocate(site/work)=2.55e-06,5.09e-06 total=2.02e-05
check ||H-H.dagger||=0.000e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.00472 S T(init/kernel/comm)=0.000434,0.00422,6.67e-05 rank=0 -----
TIMING FOR cleanup: 0.000322 T(erase/save/remove)=9.6e-05,0.00019,3.69e-05
##### local: 5.277e-02 S #####
 T(local: fetch) = 1.348e-04 S  per = 0.256  per(accum) = 0.256
 T(local: hdiag) = 5.235e-04 S  per = 0.992  per(accum) = 1.25
 T(local: dvdsn) = 4.590e-02 S  per =   87  per(accum) = 88.2
 T(local: decim) = 4.952e-04 S  per = 0.939  per(accum) = 89.2
 T(local: guess) = 5.059e-04 S  per = 0.959  per(accum) = 90.1
 T(local: renrm) = 4.868e-03 S  per = 9.23  per(accum) = 99.4
 T(local: save ) = 3.366e-04 S  per = 0.638  per(accum) = 100
Detailed decomposition of T(dvdsn): 4.482e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 1.795e-05 S  per = 0.0401  per(accum) = 0.0401
 T(local: symbolic_formulae_twodot     ) = 6.468e-04 S  per = 1.44  per(accum) = 1.48
 T(local: hintermediate init           ) = 5.741e-05 S  per = 0.128  per(accum) = 1.61
 T(local: hintermediates memcpy cpu2gpu) = 3.100e-08 S  per = 6.92e-05  per(accum) = 1.61
 T(local: preprocess_hformulae_Hxlist2 ) = 3.639e-03 S  per = 8.12  per(accum) = 9.73
 T(local: hmmtasks init                ) = 3.619e-03 S  per = 8.07  per(accum) = 17.8
 T(local: dvdson solver [Hx_batchGPU]  ) = 3.625e-02 S  per = 80.9  per(accum) = 98.7
 T(local: dvdson solver [communication]) = 4.713e-05 S  per = 0.105  per(accum) = 98.8
 T(local: dvdson solver [rest part]    ) = 5.450e-04 S  per = 1.22  per(accum) = 100
Detailed decomposition of T(renrm): 4.720e-03 S
 T(local: qops init                    ) = 4.339e-04 S  per = 9.19  per(accum) = 9.19
 T(local: qops_dict memcpy cpu2gpu     ) = 3.824e-05 S  per = 0.81  per(accum) = 10
 T(local: symbolic_formulae_renorm     ) = 5.849e-04 S  per = 12.4  per(accum) = 22.4
 T(local: rintermediate init           ) = 2.769e-05 S  per = 0.587  per(accum) = 23
 T(local: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000593  per(accum) = 23
 T(local: preprocess_formulae_Rlist2   ) = 1.076e-03 S  per = 22.8  per(accum) = 45.8
 T(local: rmmtasks init                ) = 9.624e-04 S  per = 20.4  per(accum) = 66.2
 T(local: qops memset                  ) = 2.900e-08 S  per = 0.000614  per(accum) = 66.2
 T(local: preprocess_renorm_batchGPU   ) = 1.476e-03 S  per = 31.3  per(accum) = 97.4
 T(local: qops memcpy gpu2cpu          ) = 1.519e-05 S  per = 0.322  per(accum) = 97.8
 T(local: deallocate gpu memory        ) = 3.863e-05 S  per = 0.818  per(accum) = 98.6
 T(local: communication of opS and opH ) = 6.673e-05 S  per = 1.41  per(accum) = 100
##### sweep: 1.272e-01 S #####
 T(sweep: fetch) = 1.339e-03 S  per = 1.05  per(accum) = 1.05
 T(sweep: hdiag) = 1.625e-03 S  per = 1.28  per(accum) = 2.33
 T(sweep: dvdsn) = 1.047e-01 S  per = 82.3  per(accum) = 84.6
 T(sweep: decim) = 2.101e-03 S  per = 1.65  per(accum) = 86.3
 T(sweep: guess) = 1.438e-03 S  per = 1.13  per(accum) = 87.4
 T(sweep: renrm) = 1.514e-02 S  per = 11.9  per(accum) = 99.3
 T(sweep: save ) = 8.675e-04 S  per = 0.682  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.013e-01 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 3.498e-05 S  per = 0.0345  per(accum) = 0.0345
 T(sweep: symbolic_formulae_twodot     ) = 2.003e-03 S  per = 1.98  per(accum) = 2.01
 T(sweep: hintermediate init           ) = 1.805e-04 S  per = 0.178  per(accum) = 2.19
 T(sweep: hintermediates memcpy cpu2gpu) = 9.200e-08 S  per = 9.08e-05  per(accum) = 2.19
 T(sweep: preprocess_hformulae_Hxlist2 ) = 1.128e-02 S  per = 11.1  per(accum) = 13.3
 T(sweep: hmmtasks init                ) = 1.107e-02 S  per = 10.9  per(accum) = 24.3
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 7.547e-02 S  per = 74.5  per(accum) = 98.7
 T(sweep: dvdson solver [communication]) = 1.001e-04 S  per = 0.0988  per(accum) = 98.8
 T(sweep: dvdson solver [rest part]    ) = 1.171e-03 S  per = 1.16  per(accum) = 100
Detailed decomposition of T(renrm): 1.467e-02 S
 T(sweep: qops init                    ) = 1.178e-03 S  per = 8.03  per(accum) = 8.03
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.195e-04 S  per = 0.815  per(accum) = 8.85
 T(sweep: symbolic_formulae_renorm     ) = 1.664e-03 S  per = 11.3  per(accum) = 20.2
 T(sweep: rintermediate init           ) = 1.227e-04 S  per = 0.836  per(accum) = 21
 T(sweep: rintermediates memcpy cpu2gpu) = 8.700e-08 S  per = 0.000593  per(accum) = 21
 T(sweep: preprocess_formulae_Rlist2   ) = 3.305e-03 S  per = 22.5  per(accum) = 43.6
 T(sweep: rmmtasks init                ) = 3.217e-03 S  per = 21.9  per(accum) = 65.5
 T(sweep: qops memset                  ) = 8.600e-08 S  per = 0.000586  per(accum) = 65.5
 T(sweep: preprocess_renorm_batchGPU   ) = 4.720e-03 S  per = 32.2  per(accum) = 97.7
 T(sweep: qops memcpy gpu2cpu          ) = 4.884e-05 S  per = 0.333  per(accum) = 98
 T(sweep: deallocate gpu memory        ) = 1.119e-04 S  per = 0.763  per(accum) = 98.7
 T(sweep: communication of opS and opH ) = 1.839e-04 S  per = 1.25  per(accum) = 100
##### global: 9.528e-01 S #####
 T(global: fetch) = 1.502e-02 S  per = 1.58  per(accum) = 1.58
 T(global: hdiag) = 1.254e-02 S  per = 1.32  per(accum) = 2.89
 T(global: dvdsn) = 7.770e-01 S  per = 81.5  per(accum) = 84.4
 T(global: decim) = 1.969e-02 S  per = 2.07  per(accum) = 86.5
 T(global: guess) = 1.018e-02 S  per = 1.07  per(accum) = 87.6
 T(global: renrm) = 1.118e-01 S  per = 11.7  per(accum) = 99.3
 T(global: save ) = 6.616e-03 S  per = 0.694  per(accum) = 100
Detailed decomposition of T(dvdsn): 7.522e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 2.494e-04 S  per = 0.0332  per(accum) = 0.0332
 T(global: symbolic_formulae_twodot     ) = 1.526e-02 S  per = 2.03  per(accum) = 2.06
 T(global: hintermediate init           ) = 1.355e-03 S  per = 0.18  per(accum) = 2.24
 T(global: hintermediates memcpy cpu2gpu) = 6.780e-07 S  per = 9.01e-05  per(accum) = 2.24
 T(global: preprocess_hformulae_Hxlist2 ) = 8.235e-02 S  per = 10.9  per(accum) = 13.2
 T(global: hmmtasks init                ) = 8.143e-02 S  per = 10.8  per(accum) = 24
 T(global: dvdson solver [Hx_batchGPU]  ) = 5.616e-01 S  per = 74.7  per(accum) = 98.7
 T(global: dvdson solver [communication]) = 7.704e-04 S  per = 0.102  per(accum) = 98.8
 T(global: dvdson solver [rest part]    ) = 9.137e-03 S  per = 1.21  per(accum) = 100
Detailed decomposition of T(renrm): 1.083e-01 S
 T(global: qops init                    ) = 8.310e-03 S  per = 7.67  per(accum) = 7.67
 T(global: qops_dict memcpy cpu2gpu     ) = 9.622e-04 S  per = 0.888  per(accum) = 8.56
 T(global: symbolic_formulae_renorm     ) = 1.241e-02 S  per = 11.5  per(accum) = 20
 T(global: rintermediate init           ) = 1.049e-03 S  per = 0.969  per(accum) = 21
 T(global: rintermediates memcpy cpu2gpu) = 6.580e-07 S  per = 0.000607  per(accum) = 21
 T(global: preprocess_formulae_Rlist2   ) = 2.372e-02 S  per = 21.9  per(accum) = 42.9
 T(global: rmmtasks init                ) = 2.279e-02 S  per =   21  per(accum) = 63.9
 T(global: qops memset                  ) = 6.480e-07 S  per = 0.000598  per(accum) = 63.9
 T(global: preprocess_renorm_batchGPU   ) = 3.643e-02 S  per = 33.6  per(accum) = 97.5
 T(global: qops memcpy gpu2cpu          ) = 3.591e-04 S  per = 0.331  per(accum) = 97.9
 T(global: deallocate gpu memory        ) = 8.538e-04 S  per = 0.788  per(accum) = 98.7
 T(global: communication of opS and opH ) = 1.455e-03 S  per = 1.34  per(accum) = 100

isweep=5 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:3 B:5 P:7 Q:11 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=872:0.00665MB:6.5e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1310:0.00999MB:9.76e-06GB
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x44a41f30
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,1):2 (1,-1):2 (3,1):2 (3,-1):2 (0,0):1 (4,0):1 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
### DIAG TIMING: total=0.000359 t1=7.3e-06, t2=1.36e-05, t3=4.81e-05, t4=0.000185, t5=6.14e-05, t6=2.89e-05, t7=1.24e-05, t8=2.44e-06
duration_diagGPU:0.000373
duration_diagreduce:4.25e-06
duration_diagtransform:1.81e-06
rank=0 GPUmem(GB): used=9.76e-06 (oper)=9.76e-06
----- TIMING FOR symbolic_formulae_twodot with size=93 : 6.375e-04 S -----
hintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=93
 no. of hintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR hintermediates<Tm>::initDirect_batch_gpu : 4.448e-05 S -----
rank=0 GPUmem(GB): used=1.01e-05 (oper,hinter)=9.76e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0034 S size(H_formulae)=93 size(Hxlst2)=49 T(Hmu/Hxlist)=0.000181,0.00322 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00367 S size(H_formulae)=93 size(Hxlst)=3134 -----
rank=0 GPUmem(GB): used=0.000409 (oper,hinter,dvdson,batch)=9.76e-06,2.98e-07,1.49e-06,0.000397 blksize=4 blksize0=8 batchsize=3134
ctns::twodot_guess |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=100 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000217,0.00204,0.000198 cost=4.22e+04 flops[gemm]=2.07e+07
--- TIMING FOR sigma : t_inter=0.000217 t_gemm=0.00204 t_reduction=0.000198 tot=0.00245 ---
 sigma counter=219 i=0 t=0.000265 per=13 cost=3.72e+03 flops=1.4e+07
 sigma counter=219 i=1 t=0.000259 per=12.7 cost=3.74e+03 flops=1.44e+07
 sigma counter=219 i=2 t=0.000239 per=11.7 cost=3.04e+03 flops=1.27e+07
 sigma counter=219 i=3 t=0.000241 per=11.8 cost=3.03e+03 flops=1.26e+07
 sigma counter=219 i=4 t=0.000262 per=12.9 cost=1e+04 flops=3.82e+07
 sigma counter=219 i=5 t=0.000256 per=12.6 cost=1e+04 flops=3.91e+07
 sigma counter=219 i=6 t=0.000263 per=12.9 cost=4.34e+03 flops=1.65e+07
 sigma counter=219 i=7 t=0.000253 per=12.4 cost=4.32e+03 flops=1.71e+07
 total GEMM cost=4.22e+04 flops=2.07e+07
--- TIMING FOR sigma_tot : t_inter=0.0467 t_gemm=0.434 t_reduction=0.0432 tot=0.524 ---
 sigma_tot counter=219 i=0 t=0.0536 per=12.3 cost=6.01e+05 flops=1.12e+07
 sigma_tot counter=219 i=1 t=0.0542 per=12.5 cost=6.07e+05 flops=1.12e+07
 sigma_tot counter=219 i=2 t=0.0531 per=12.2 cost=6.82e+05 flops=1.28e+07
 sigma_tot counter=219 i=3 t=0.0529 per=12.2 cost=6.89e+05 flops=1.3e+07
 sigma_tot counter=219 i=4 t=0.0545 per=12.5 cost=1.28e+06 flops=2.36e+07
 sigma_tot counter=219 i=5 t=0.0548 per=12.6 cost=1.29e+06 flops=2.35e+07
 sigma_tot counter=219 i=6 t=0.0566 per=13 cost=1.51e+06 flops=2.67e+07
 sigma_tot counter=219 i=7 t=0.0547 per=12.6 cost=1.5e+06 flops=2.75e+07
 total GEMM cost=8.16e+06 flops=1.88e+07
preprocess_Hx_batchDirectGPUSingle: t[copy,inter,gemm,reduction]=2.2e-05,0.000212,0.00201,0.000196 cost=4.22e+04 flops[gemm]=2.09e+07
--- TIMING FOR sigma : t_inter=0.000212 t_gemm=0.00202 t_reduction=0.000196 tot=0.00242 ---
 sigma counter=220 i=0 t=0.000257 per=12.8 cost=3.72e+03 flops=1.45e+07
 sigma counter=220 i=1 t=0.000257 per=12.8 cost=3.74e+03 flops=1.45e+07
 sigma counter=220 i=2 t=0.000238 per=11.8 cost=3.04e+03 flops=1.28e+07
 sigma counter=220 i=3 t=0.000239 per=11.9 cost=3.03e+03 flops=1.27e+07
 sigma counter=220 i=4 t=0.000254 per=12.6 cost=1e+04 flops=3.94e+07
 sigma counter=220 i=5 t=0.000258 per=12.8 cost=1e+04 flops=3.88e+07
 sigma counter=220 i=6 t=0.000262 per=13 cost=4.34e+03 flops=1.65e+07
 sigma counter=220 i=7 t=0.00025 per=12.4 cost=4.32e+03 flops=1.73e+07
 total GEMM cost=4.22e+04 flops=2.09e+07
--- TIMING FOR sigma_tot : t_inter=0.0469 t_gemm=0.436 t_reduction=0.0434 tot=0.527 ---
 sigma_tot counter=220 i=0 t=0.0538 per=12.3 cost=6.04e+05 flops=1.12e+07
 sigma_tot counter=220 i=1 t=0.0545 per=12.5 cost=6.11e+05 flops=1.12e+07
 sigma_tot counter=220 i=2 t=0.0533 per=12.2 cost=6.85e+05 flops=1.28e+07
 sigma_tot counter=220 i=3 t=0.0531 per=12.2 cost=6.93e+05 flops=1.3e+07
 sigma_tot counter=220 i=4 t=0.0548 per=12.5 cost=1.29e+06 flops=2.36e+07
 sigma_tot counter=220 i=5 t=0.0551 per=12.6 cost=1.3e+06 flops=2.35e+07
 sigma_tot counter=220 i=6 t=0.0568 per=13 cost=1.51e+06 flops=2.67e+07
 sigma_tot counter=220 i=7 t=0.055 per=12.6 cost=1.51e+06 flops=2.74e+07
 total GEMM cost=8.21e+06 flops=1.88e+07
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643 -1.003e+03  4.639e-05    2     2  5.336e-03 2.668e-03
    1   1 +      -2.436977450693 -1.002e+03  2.690e-05    2     2  5.336e-03 2.668e-03
TIMING FOR Davidson : 5.383e-03  T(cal/comm/rest)=5.282e-03,8.037e-06,9.286e-05
optimized energies: isweep=5 dots=2 ibond=3 e[0]=-2.65451696664 nmvp=2
optimized energies: isweep=5 dots=2 ibond=3 e[1]=-2.43697745069 nmvp=2
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row_nkr dcut=20 nqr=16 alg_decim=1 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep5_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,1):9 (3,-1):9 (4,0):9 (1,1):3 (1,-1):3 (2,2):3 (2,-2):3 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (0,0):1 (6,0):1 (3,3):1 (3,-3):1
----- TMING FOR decimation_genbasis: 3.8e-04 S T(scatter/comp/gather)=3.7e-05,3.9e-05,3.1e-04 -----
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
 qbond: qkept nsym=6 dimAll=20
 (3,1):6 (2,0):4 (4,0):3 (2,2):3 (3,-1):2 (1,1):2
----- TIMING for decimation_row: 6.960e-04 S T(decim/formRot)=4.655e-04,2.305e-04 -----
TIMING FOR decimation: 1.072e-03 S T(wf/decim)=3.456e-04,7.265e-04
ctns::oper_renorm coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CABPQSH nops=C:6 A:7 B:11 P:3 Q:5 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:5.951e-04MB size(tot)=1612:1.230e-02MB:1.201e-05GB
rank=0 GPUmem(GB): used=1.989e-05 (oper)=1.960e-05
rank=0 GPUmem(GB): used=2.101e-05 (oper,site)(GB)=1.960e-05,1.118e-06
----- TIMING FOR symbolic_formulae_renorm with size=37 : 4.594e-04 S -----
rintermediates<Tm>::initDirect_batch_gpu maxthreads=2
 no. of formulae=37
 no. of rintermediate operators=20
 no. of coefficients=40:0.000305MB:2.98e-07GB
----- TIMING FOR rintermediates<Tm>::initDirect_batch_gpu : 5.028e-05 S -----
rank=0 GPUmem(GB): used=2.13e-05 (oper,site,rinter)=1.96e-05,1.12e-06,2.98e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000951 S size(rtasks)=37 size(Rlst2)=6 T(Rmu/Rlist)=0.000161,0.000789 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00103 S size(rtasks)=37 size(Rlst)=821 -----
rank=0 GPUmem(GB): used=0.000517 (oper,site,rinter,batch)=1.96e-05,1.12e-06,2.98e-07,0.000495 blksize=36 blksize0=8 batchsize=821
timing: allocate=3.47e-05 rmmtasks init=0.000987 total=0.00102
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000207,0.00114,0.000194 cost=8.44e+04 flops[gemm]=7.39e+07
--- TIMING FOR renorm : t_inter=0.000207 t_gemm=0.00114 t_reduction=0.000194 tot=0.00154 ---
 renorm counter=24 i=0 t=0.000224 per=19.6 cost=3.06e+03 flops=1.37e+07
 renorm counter=24 i=1 t=0.000228 per=20 cost=5.92e+03 flops=2.59e+07
 renorm counter=24 i=2 t=0.000219 per=19.2 cost=9.23e+03 flops=4.21e+07
 renorm counter=24 i=3 t=0.000228 per=20 cost=1.58e+04 flops=6.95e+07
 renorm counter=24 i=4 t=1e-06 per=0.0876 cost=0 flops=0
 renorm counter=24 i=5 t=0 per=0 cost=0 flops=-nan
 renorm counter=24 i=6 t=0.000242 per=21.2 cost=5.03e+04 flops=2.08e+08
 total GEMM cost=8.44e+04 flops=7.39e+07
--- TIMING FOR renorm_tot : t_inter=0.00257 t_gemm=0.0278 t_reduction=0.00483 tot=0.0352 ---
 renorm_tot counter=24 i=0 t=0.00558 per=20 cost=5.29e+04 flops=9.48e+06
 renorm_tot counter=24 i=1 t=0.00548 per=19.7 cost=7.94e+04 flops=1.45e+07
 renorm_tot counter=24 i=2 t=0.00266 per=9.57 cost=5.45e+04 flops=2.05e+07
 renorm_tot counter=24 i=3 t=0.00271 per=9.74 cost=9.4e+04 flops=3.47e+07
 renorm_tot counter=24 i=4 t=0.0027 per=9.69 cost=5.7e+04 flops=2.11e+07
 renorm_tot counter=24 i=5 t=0.00274 per=9.83 cost=9.96e+04 flops=3.64e+07
 renorm_tot counter=24 i=6 t=0.00596 per=21.4 cost=6.79e+05 flops=1.14e+08
 total GEMM cost=1.12e+06 flops=4.01e+07
timing: gpu2cpu=1.67e-05 deallocate(site/work)=4.72e-06,7.55e-06 total=2.42e-05
check ||H-H.dagger||=1.594e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00478 S T(init/kernel/comm)=0.000347,0.00437,6.33e-05 rank=0 -----
TIMING FOR cleanup: 0.00027 T(erase/save/remove)=4.43e-05,0.000188,3.84e-05
##### local: 2.341e-02 S #####
 T(local: fetch) = 1.050e-03 S  per = 4.49  per(accum) = 4.49
 T(local: hdiag) = 4.946e-04 S  per = 2.11  per(accum) = 6.6
 T(local: dvdsn) = 1.490e-02 S  per = 63.6  per(accum) = 70.2
 T(local: decim) = 1.212e-03 S  per = 5.18  per(accum) = 75.4
 T(local: guess) = 4.267e-04 S  per = 1.82  per(accum) = 77.2
 T(local: renrm) = 5.043e-03 S  per = 21.5  per(accum) = 98.8
 T(local: save ) = 2.840e-04 S  per = 1.21  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.373e-02 S
 T(local: qops_dict memcpy cpu2gpu     ) = 7.850e-06 S  per = 0.0572  per(accum) = 0.0572
 T(local: symbolic_formulae_twodot     ) = 6.478e-04 S  per = 4.72  per(accum) = 4.77
 T(local: hintermediate init           ) = 5.614e-05 S  per = 0.409  per(accum) = 5.18
 T(local: hintermediates memcpy cpu2gpu) = 3.400e-08 S  per = 0.000248  per(accum) = 5.18
 T(local: preprocess_hformulae_Hxlist2 ) = 3.766e-03 S  per = 27.4  per(accum) = 32.6
 T(local: hmmtasks init                ) = 3.871e-03 S  per = 28.2  per(accum) = 60.8
 T(local: dvdson solver [Hx_batchGPU]  ) = 5.282e-03 S  per = 38.5  per(accum) = 99.3
 T(local: dvdson solver [communication]) = 8.037e-06 S  per = 0.0585  per(accum) = 99.3
 T(local: dvdson solver [rest part]    ) = 9.286e-05 S  per = 0.676  per(accum) = 100
Detailed decomposition of T(renrm): 4.783e-03 S
 T(local: qops init                    ) = 3.466e-04 S  per = 7.25  per(accum) = 7.25
 T(local: qops_dict memcpy cpu2gpu     ) = 4.078e-05 S  per = 0.853  per(accum) = 8.1
 T(local: symbolic_formulae_renorm     ) = 4.682e-04 S  per = 9.79  per(accum) = 17.9
 T(local: rintermediate init           ) = 6.396e-05 S  per = 1.34  per(accum) = 19.2
 T(local: rintermediates memcpy cpu2gpu) = 2.800e-08 S  per = 0.000585  per(accum) = 19.2
 T(local: preprocess_formulae_Rlist2   ) = 1.056e-03 S  per = 22.1  per(accum) = 41.3
 T(local: rmmtasks init                ) = 1.030e-03 S  per = 21.5  per(accum) = 62.8
 T(local: qops memset                  ) = 2.900e-08 S  per = 0.000606  per(accum) = 62.8
 T(local: preprocess_renorm_batchGPU   ) = 1.660e-03 S  per = 34.7  per(accum) = 97.5
 T(local: qops memcpy gpu2cpu          ) = 1.674e-05 S  per = 0.35  per(accum) = 97.9
 T(local: deallocate gpu memory        ) = 3.718e-05 S  per = 0.777  per(accum) = 98.7
 T(local: communication of opS and opH ) = 6.330e-05 S  per = 1.32  per(accum) = 100
##### sweep: 1.506e-01 S #####
 T(sweep: fetch) = 2.389e-03 S  per = 1.59  per(accum) = 1.59
 T(sweep: hdiag) = 2.120e-03 S  per = 1.41  per(accum) = 2.99
 T(sweep: dvdsn) = 1.196e-01 S  per = 79.4  per(accum) = 82.4
 T(sweep: decim) = 3.313e-03 S  per =  2.2  per(accum) = 84.6
 T(sweep: guess) = 1.865e-03 S  per = 1.24  per(accum) = 85.8
 T(sweep: renrm) = 2.018e-02 S  per = 13.4  per(accum) = 99.2
 T(sweep: save ) = 1.152e-03 S  per = 0.764  per(accum) = 100
Detailed decomposition of T(dvdsn): 1.150e-01 S
 T(sweep: qops_dict memcpy cpu2gpu     ) = 4.283e-05 S  per = 0.0372  per(accum) = 0.0372
 T(sweep: symbolic_formulae_twodot     ) = 2.650e-03 S  per =  2.3  per(accum) = 2.34
 T(sweep: hintermediate init           ) = 2.367e-04 S  per = 0.206  per(accum) = 2.55
 T(sweep: hintermediates memcpy cpu2gpu) = 1.260e-07 S  per = 0.00011  per(accum) = 2.55
 T(sweep: preprocess_hformulae_Hxlist2 ) = 1.505e-02 S  per = 13.1  per(accum) = 15.6
 T(sweep: hmmtasks init                ) = 1.494e-02 S  per =   13  per(accum) = 28.6
 T(sweep: dvdson solver [Hx_batchGPU]  ) = 8.075e-02 S  per = 70.2  per(accum) = 98.8
 T(sweep: dvdson solver [communication]) = 1.081e-04 S  per = 0.094  per(accum) = 98.9
 T(sweep: dvdson solver [rest part]    ) = 1.264e-03 S  per =  1.1  per(accum) = 100
Detailed decomposition of T(renrm): 1.945e-02 S
 T(sweep: qops init                    ) = 1.525e-03 S  per = 7.84  per(accum) = 7.84
 T(sweep: qops_dict memcpy cpu2gpu     ) = 1.603e-04 S  per = 0.824  per(accum) = 8.66
 T(sweep: symbolic_formulae_renorm     ) = 2.133e-03 S  per =   11  per(accum) = 19.6
 T(sweep: rintermediate init           ) = 1.867e-04 S  per = 0.96  per(accum) = 20.6
 T(sweep: rintermediates memcpy cpu2gpu) = 1.150e-07 S  per = 0.000591  per(accum) = 20.6
 T(sweep: preprocess_formulae_Rlist2   ) = 4.360e-03 S  per = 22.4  per(accum) = 43
 T(sweep: rmmtasks init                ) = 4.247e-03 S  per = 21.8  per(accum) = 64.8
 T(sweep: qops memset                  ) = 1.150e-07 S  per = 0.000591  per(accum) = 64.8
 T(sweep: preprocess_renorm_batchGPU   ) = 6.380e-03 S  per = 32.8  per(accum) = 97.6
 T(sweep: qops memcpy gpu2cpu          ) = 6.557e-05 S  per = 0.337  per(accum) = 98
 T(sweep: deallocate gpu memory        ) = 1.491e-04 S  per = 0.766  per(accum) = 98.7
 T(sweep: communication of opS and opH ) = 2.472e-04 S  per = 1.27  per(accum) = 100
##### global: 9.762e-01 S #####
 T(global: fetch) = 1.607e-02 S  per = 1.65  per(accum) = 1.65
 T(global: hdiag) = 1.303e-02 S  per = 1.33  per(accum) = 2.98
 T(global: dvdsn) = 7.919e-01 S  per = 81.1  per(accum) = 84.1
 T(global: decim) = 2.090e-02 S  per = 2.14  per(accum) = 86.2
 T(global: guess) = 1.061e-02 S  per = 1.09  per(accum) = 87.3
 T(global: renrm) = 1.168e-01 S  per =   12  per(accum) = 99.3
 T(global: save ) = 6.900e-03 S  per = 0.707  per(accum) = 100
Detailed decomposition of T(dvdsn): 7.659e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 2.573e-04 S  per = 0.0336  per(accum) = 0.0336
 T(global: symbolic_formulae_twodot     ) = 1.591e-02 S  per = 2.08  per(accum) = 2.11
 T(global: hintermediate init           ) = 1.411e-03 S  per = 0.184  per(accum) = 2.29
 T(global: hintermediates memcpy cpu2gpu) = 7.120e-07 S  per = 9.3e-05  per(accum) = 2.29
 T(global: preprocess_hformulae_Hxlist2 ) = 8.612e-02 S  per = 11.2  per(accum) = 13.5
 T(global: hmmtasks init                ) = 8.530e-02 S  per = 11.1  per(accum) = 24.7
 T(global: dvdson solver [Hx_batchGPU]  ) = 5.669e-01 S  per =   74  per(accum) = 98.7
 T(global: dvdson solver [communication]) = 7.785e-04 S  per = 0.102  per(accum) = 98.8
 T(global: dvdson solver [rest part]    ) = 9.230e-03 S  per = 1.21  per(accum) = 100
Detailed decomposition of T(renrm): 1.131e-01 S
 T(global: qops init                    ) = 8.656e-03 S  per = 7.65  per(accum) = 7.65
 T(global: qops_dict memcpy cpu2gpu     ) = 1.003e-03 S  per = 0.887  per(accum) = 8.54
 T(global: symbolic_formulae_renorm     ) = 1.287e-02 S  per = 11.4  per(accum) = 19.9
 T(global: rintermediate init           ) = 1.113e-03 S  per = 0.984  per(accum) = 20.9
 T(global: rintermediates memcpy cpu2gpu) = 6.860e-07 S  per = 0.000606  per(accum) = 20.9
 T(global: preprocess_formulae_Rlist2   ) = 2.477e-02 S  per = 21.9  per(accum) = 42.8
 T(global: rmmtasks init                ) = 2.382e-02 S  per = 21.1  per(accum) = 63.9
 T(global: qops memset                  ) = 6.770e-07 S  per = 0.000599  per(accum) = 63.9
 T(global: preprocess_renorm_batchGPU   ) = 3.809e-02 S  per = 33.7  per(accum) = 97.5
 T(global: qops memcpy gpu2cpu          ) = 3.758e-04 S  per = 0.332  per(accum) = 97.9
 T(global: deallocate gpu memory        ) = 8.910e-04 S  per = 0.788  per(accum) = 98.7
 T(global: communication of opS and opH ) = 1.518e-03 S  per = 1.34  per(accum) = 100

======================================================================
sweep_data::summary isweep=5
----------------------------------------------------------------------
sweep parameters: isweep=5 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.0514
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717 t=0.023
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.0528
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069 t=0.0234
 eav_max=-2.54574720706 [ibond=1]  dwt_min=0.000e+00 [ibond=0]
 eav_min=-2.54574720867 [ibond=2]  dwt_max=5.784e-04 [ibond=1]
 eav_diff=1.60474700195e-09
 sweep energies: isweep=5 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[0]=-2.65451696664
 sweep energies: isweep=5 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=5
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.000e-04 1.000e-04 | 51 | 1.940e-01 | 1.940e-01 | 1.116e-02 1.028e-01 1.083e-02 1.248e-01 64.4
            1  2      20 1.000e-04 0.000e+00 | 45 | 1.842e-01 | 3.782e-01 | 2.111e-02 1.958e-01 2.052e-02 2.375e-01 62.8
            2  2      20 1.000e-04 0.000e+00 | 31 | 1.533e-01 | 5.315e-01 | 2.821e-02 2.628e-01 2.744e-02 3.185e-01 59.9
            3  2      20 1.000e-04 0.000e+00 | 31 | 1.538e-01 | 6.852e-01 | 3.531e-02 3.299e-01 3.437e-02 3.996e-01 58.3
            4  2      20 1.000e-04 0.000e+00 | 31 | 1.535e-01 | 8.388e-01 | 4.243e-02 3.971e-01 4.130e-02 4.809e-01 57.3
            5  2      20 1.000e-04 0.000e+00 | 31 | 1.534e-01 | 9.921e-01 | 4.951e-02 4.642e-01 4.820e-02 5.619e-01 56.6
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +9.505e-03 e[0]=-2.65208108952 (2.436e-03) e[1]=-2.43068987874 (6.288e-03)
            1      20 +0.000e+00 e[0]=-2.65451696664 (4.014e-12) e[1]=-2.43697745069 (-2.691e-13)
            2      20 +5.258e-04 e[0]=-2.65451696664 (3.109e-15) e[1]=-2.43697745069 (-1.776e-15)
            3      20 +0.000e+00 e[0]=-2.65451696664 (-8.882e-16) e[1]=-2.43697745069 (-3.109e-15)
            4      20 +5.258e-04 e[0]=-2.65451696664 (1.332e-15) e[1]=-2.43697745069 (0.000e+00)
            5      20 +0.000e+00 e[0]=-2.65451696664 (0.000e+00) e[1]=-2.43697745069 (0.000e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep5.info
----------------------------------------------------------------------
Convert [LC]RR => [CR]RR:
ctns::decimation_row_nkr dcut=8 nqr=12 alg_decim=0 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep5_C0R1.txt
 qbond: qsuper nsym=12 dimAll=80
 (3,1):15 (4,0):15 (5,1):9 (4,2):9 (2,0):6 (3,-1):6 (2,2):5 (5,-1):5 (6,0):3 (3,3):3 (1,1):2 (4,-2):2
----- TMING FOR decimation_genbasis: 5.347e-05 S T(scatter/comp/gather)=6.219e-06,4.316e-05,4.087e-06 -----
decimation summary: 80->8 dwt=-2.220e-16 SvN=1.326e+00
 qbond: qkept nsym=4 dimAll=8
 (3,1):2 (4,0):2 (5,1):2 (4,2):2
----- TIMING for decimation_row: 2.952e-04 S T(decim/formRot)=1.172e-04,1.780e-04 -----

Convert [C]RRR => [cR]RRR:
ctns::decimation_row_nkr dcut=2 nqr=9 alg_decim=0 mpisize=2 maxthreads=2 fname=./scratch/sweep/decimation_isweep5_cR0.txt
 qbond: qsuper nsym=9 dimAll=32
 (5,1):8 (4,0):4 (4,2):4 (6,0):4 (6,2):4 (3,1):2 (7,1):2 (5,3):2 (5,-1):2
----- TMING FOR decimation_genbasis: 2.633e-05 S T(scatter/comp/gather)=4.256e-06,1.998e-05,2.087e-06 -----
decimation summary: 32->2 dwt=+0.000e+00 SvN=1.000e+00
 qbond: qkept nsym=1 dimAll=2
 (5,1):2
----- TIMING for decimation_row: 1.965e-04 S T(decim/formRot)=8.080e-05,1.157e-04 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep5.info

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(4,0) Drow=4 maxdiff=0.000e+00
 idx=1 node=(3,0) Drow=16 maxdiff=0.000e+00
 idx=2 node=(2,0) Drow=20 maxdiff=1.649e-15
 idx=3 node=(1,0) Drow=8 maxdiff=8.455e-16
 idx=4 node=(0,0) Drow=2 maxdiff=4.578e-16
stensor2: wf2 own=1 _data=0x445b36e0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (5,1):2
 qbond: qcol nsym=1 dimAll=2
 (5,1):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.052e-05MB
i=0 idx=0 block[(5,1),(5,1)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x445b36e0
      1.0000e+00      -1.3253e-18 
     -5.7602e-17       1.0000e+00 
 rwfuns: nroots=2 maxdiff=6.3354e-16
----- TIMING FOR ctns::rcanon_check : 2.384e-04 S -----
..... end of isweep = 5 .....

----- TIMING FOR ctns::sweep_opt : 1.003e+00 S -----
##### global: 9.762e-01 S #####
 T(global: fetch) = 1.607e-02 S  per = 1.65  per(accum) = 1.65
 T(global: hdiag) = 1.303e-02 S  per = 1.33  per(accum) = 2.98
 T(global: dvdsn) = 7.919e-01 S  per = 81.1  per(accum) = 84.1
 T(global: decim) = 2.090e-02 S  per = 2.14  per(accum) = 86.2
 T(global: guess) = 1.061e-02 S  per = 1.09  per(accum) = 87.3
 T(global: renrm) = 1.168e-01 S  per =   12  per(accum) = 99.3
 T(global: save ) = 6.900e-03 S  per = 0.707  per(accum) = 100
Detailed decomposition of T(dvdsn): 7.659e-01 S
 T(global: qops_dict memcpy cpu2gpu     ) = 2.573e-04 S  per = 0.0336  per(accum) = 0.0336
 T(global: symbolic_formulae_twodot     ) = 1.591e-02 S  per = 2.08  per(accum) = 2.11
 T(global: hintermediate init           ) = 1.411e-03 S  per = 0.184  per(accum) = 2.29
 T(global: hintermediates memcpy cpu2gpu) = 7.120e-07 S  per = 9.3e-05  per(accum) = 2.29
 T(global: preprocess_hformulae_Hxlist2 ) = 8.612e-02 S  per = 11.2  per(accum) = 13.5
 T(global: hmmtasks init                ) = 8.530e-02 S  per = 11.1  per(accum) = 24.7
 T(global: dvdson solver [Hx_batchGPU]  ) = 5.669e-01 S  per =   74  per(accum) = 98.7
 T(global: dvdson solver [communication]) = 7.785e-04 S  per = 0.102  per(accum) = 98.8
 T(global: dvdson solver [rest part]    ) = 9.230e-03 S  per = 1.21  per(accum) = 100
Detailed decomposition of T(renrm): 1.131e-01 S
 T(global: qops init                    ) = 8.656e-03 S  per = 7.65  per(accum) = 7.65
 T(global: qops_dict memcpy cpu2gpu     ) = 1.003e-03 S  per = 0.887  per(accum) = 8.54
 T(global: symbolic_formulae_renorm     ) = 1.287e-02 S  per = 11.4  per(accum) = 19.9
 T(global: rintermediate init           ) = 1.113e-03 S  per = 0.984  per(accum) = 20.9
 T(global: rintermediates memcpy cpu2gpu) = 6.860e-07 S  per = 0.000606  per(accum) = 20.9
 T(global: preprocess_formulae_Rlist2   ) = 2.477e-02 S  per = 21.9  per(accum) = 42.8
 T(global: rmmtasks init                ) = 2.382e-02 S  per = 21.1  per(accum) = 63.9
 T(global: qops memset                  ) = 6.770e-07 S  per = 0.000599  per(accum) = 63.9
 T(global: preprocess_renorm_batchGPU   ) = 3.809e-02 S  per = 33.7  per(accum) = 97.5
 T(global: qops memcpy gpu2cpu          ) = 3.758e-04 S  per = 0.332  per(accum) = 97.9
 T(global: deallocate gpu memory        ) = 8.910e-04 S  per = 0.788  per(accum) = 98.7
 T(global: communication of opS and opH ) = 1.518e-03 S  per = 1.34  per(accum) = 100

Congrats! CTNS calculation finishes successfully. Wed Apr 26 23:21:56 2023

