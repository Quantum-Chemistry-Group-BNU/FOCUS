
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Sun Jan 12 11:19:17 2025

GIT_HASH = ab3ee787337c6f54282df185169c09ba74b96954

mpisize = 1 maxthreads = 112

input file = input.dat

schedule::read fname = input.dat
----------------------------------------------------------------------
dtype 0
sorb 40
nelec 30
twom 0
twos 0 
integral_file moleinfo/fmole.info
scratch ./scratch

$ci
dets
0 2 4 6 8 10 12 14 16 18 20 22 24 36 38   1 3 15 17 19 21 23 25 27 29 31 33 35 37 39
end
checkms
nroots 1 
schedule
0 1.e-3
end
maxiter 1
$end

$ctns
verbose 1
qkind rNSz
maxdets 10 #0 # keep dets as much as possible
topology_file topology/topo4
thresh_proj 1.e-10
thresh_ortho 1.e-8 #1.e-10
nroots 1 
schedule
0  1 100 1.e-4 0.0
end
maxsweep 1
alg_hvec 19
alg_hinter 2
alg_hcoper 2
alg_renorm 19
alg_rinter 2
alg_rcoper 1
task_dmrg
ifab2pq
alg_a2p 3
alg_b2q 3
ifdist1
ifdistc
ifnccl
ifdists
$end

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
sorb  = 40
nelec = 30
twom  = 0
twos  = 0
integral_file = moleinfo/fmole.info
perfcomm = 0

===== params_ci::print =====
nroots = 1
no. of unique seeds = 1
0-th det: 0 1 2 3 4 6 8 10 12 14 15 16 17 18 19 20 21 22 23 24 25 27 29 31 33 35 36 37 38 39 
flip = 0
eps0 = 0.01
miniter = 0
maxiter = 1
schedule: iter eps1
0 0.001
convergence parameters
deltaE = 1e-10
checkms = 1
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 0
jroot = 0
load = 0
ci_file = ci.info
cthrd = 0.1
ifanalysis = 0
rdm = 0
init_aufbau = 0
init_seniority = 0

===== params_ctns::print =====
qkind = rNSz
topology_file = topology/topo4
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
task_oodmrg = 0
task_vmc = 0
task_expand = 0
task_tononsu2 = 0
task_prop = 
task_schmidt = 0
schmidt_file = svalues
restart_sweep = 0
ciroots = 
maxdets = 10
thresh_proj = 1.000000e-10
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
svd_iop = 13
outprec = 12
nroots = 1
guess = 1
dbranch = 0
maxsweep = 1
maxbond = -1
maxidx = -1
schedule: isweep, dots, dcut, eps, noise
0 1 100 1.000000e-04 0.000000e+00
rcfprefix = 
alg_hvec = 19
alg_hinter = 2
alg_hcoper = 2
alg_renorm = 19
alg_rinter = 2
alg_rcoper = 1
alg_rdm = 1
alg_decim = 0
alg_a2p = 3
alg_b2q = 3
notrunc = 0
ifoutcore = 0
ifab2pq = 1
ifdist1 = 1
ifdistc = 1
ifdists = 1
save_formulae = 0
sort_formulae = 0
save_mmtask = 0
batchhvec = 4 4 4
batchrenorm = 4 4 4
batchmem = 1.000000e+01
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
precond = 1
rcanon_file = 
rcanon2_file = 
iomode = 0
async_fetch = 0
async_save = 0
async_remove = 0
ifnccl = 1
iroot = 0
jroot = 0
nsample = 5000
nprt = 10
pthrd = -1.000000e-02
thresh_cabs = 1.100000e+00
detbasis = 0
tosu2 = 0
thresh_tosu2 = 1.000000e-08
singlet = 0
diagcheck = 0
savebin = 0
fromnosym = 0
oodmrg parameters:
 iprt=1
 maxiter=10
 dfac=2
 macroiter=5
 microiter=50
 alpha=5.000000e-01
 thrdopt=1.000000e-04
 thrdloc=1.000000e-06
 thrddwt=1.000000e+00
 thrdeps=1.000000e-08
 nptloc=2.000000e+01
 acceptall=0
 unrestricted=0
 urot=
inputconf = 
saveconfs = 
loadconfs = 
debug_rdm = 0
alg_mrpt2 = 0
nv2 = 0
nc2 = 0
mpisize_debug = 1
debug_gpumem = 0

io::create_scratch scratch=./scratch

gpu_init
rank=0 deviceCount=2
CUDA Runtime version: 11080
CUBLAS version: 111103
nccl init: rank=0 size=1

mem_check: ifgpu=1
rank=0 CPUmem(GB): avail=4.774e+02 total=5.033e+02
min=4.774e+02 max=4.774e+02 diff=0.000e+00
rank=0 GPUmem(GB): avail=6.426e+00 total=3.945e+01
min=6.426e+00 max=6.426e+00 diff=0.000e+00
rank=0 CPUmem(GB): used=1.001e+00 pageheap_free=6.154e-02 change=1.001e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

ctns::topology::read fname=topology/topo4
0
1
2
3
4
16
17
18
19
5
6
7
8
9
10
11
12
13
14
15

ctns::topology::print ifmps=1 ntotal=20 nphysical=20 nbackbone=20
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
 i=5 : 16 
 i=6 : 17 
 i=7 : 18 
 i=8 : 19 
 i=9 : 5 
 i=10 : 6 
 i=11 : 7 
 i=12 : 8 
 i=13 : 9 
 i=14 : 10 
 i=15 : 11 
 i=16 : 12 
 i=17 : 13 
 i=18 : 14 
 i=19 : 15 
rcoord:
 idx=0 coord=(19,0) rindex=0 node: lindex=19 porb=15 type=0 center=(-1,-1) left=(18,0) right=(-2,-2)
 idx=1 coord=(18,0) rindex=1 node: lindex=18 porb=14 type=1 center=(-1,-1) left=(17,0) right=(19,0)
 idx=2 coord=(17,0) rindex=2 node: lindex=17 porb=13 type=1 center=(-1,-1) left=(16,0) right=(18,0)
 idx=3 coord=(16,0) rindex=3 node: lindex=16 porb=12 type=1 center=(-1,-1) left=(15,0) right=(17,0)
 idx=4 coord=(15,0) rindex=4 node: lindex=15 porb=11 type=1 center=(-1,-1) left=(14,0) right=(16,0)
 idx=5 coord=(14,0) rindex=5 node: lindex=14 porb=10 type=1 center=(-1,-1) left=(13,0) right=(15,0)
 idx=6 coord=(13,0) rindex=6 node: lindex=13 porb=9 type=1 center=(-1,-1) left=(12,0) right=(14,0)
 idx=7 coord=(12,0) rindex=7 node: lindex=12 porb=8 type=1 center=(-1,-1) left=(11,0) right=(13,0)
 idx=8 coord=(11,0) rindex=8 node: lindex=11 porb=7 type=1 center=(-1,-1) left=(10,0) right=(12,0)
 idx=9 coord=(10,0) rindex=9 node: lindex=10 porb=6 type=1 center=(-1,-1) left=(9,0) right=(11,0)
 idx=10 coord=(9,0) rindex=10 node: lindex=9 porb=5 type=1 center=(-1,-1) left=(8,0) right=(10,0)
 idx=11 coord=(8,0) rindex=11 node: lindex=8 porb=19 type=1 center=(-1,-1) left=(7,0) right=(9,0)
 idx=12 coord=(7,0) rindex=12 node: lindex=7 porb=18 type=1 center=(-1,-1) left=(6,0) right=(8,0)
 idx=13 coord=(6,0) rindex=13 node: lindex=6 porb=17 type=1 center=(-1,-1) left=(5,0) right=(7,0)
 idx=14 coord=(5,0) rindex=14 node: lindex=5 porb=16 type=1 center=(-1,-1) left=(4,0) right=(6,0)
 idx=15 coord=(4,0) rindex=15 node: lindex=4 porb=4 type=1 center=(-1,-1) left=(3,0) right=(5,0)
 idx=16 coord=(3,0) rindex=16 node: lindex=3 porb=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=17 coord=(2,0) rindex=17 node: lindex=2 porb=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=18 coord=(1,0) rindex=18 node: lindex=1 porb=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=19 coord=(0,0) rindex=19 node: lindex=0 porb=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(19,0) rsupport: 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) rsupport: 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) rsupport: 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) rsupport: 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) rsupport: 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) rsupport: 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) rsupport: 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) rsupport: 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) rsupport: 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) rsupport: 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) rsupport: 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) rsupport: 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) rsupport: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) rsupport: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 
 idx=14 coord=(5,0) rsupport: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 
 idx=15 coord=(4,0) rsupport: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 
 idx=16 coord=(3,0) rsupport: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 
 idx=17 coord=(2,0) rsupport: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 
 idx=18 coord=(1,0) rsupport: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 
 idx=19 coord=(0,0) rsupport: 0 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(19,0) corbs: 15 ; rorbs: ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) corbs: 14 ; rorbs: 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) corbs: 13 ; rorbs: 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) corbs: 12 ; rorbs: 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) corbs: 11 ; rorbs: 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) corbs: 10 ; rorbs: 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) corbs: 9 ; rorbs: 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) corbs: 8 ; rorbs: 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) corbs: 7 ; rorbs: 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) corbs: 6 ; rorbs: 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) corbs: 5 ; rorbs: 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) corbs: 19 ; rorbs: 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) corbs: 18 ; rorbs: 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) corbs: 17 ; rorbs: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 
 idx=14 coord=(5,0) corbs: 16 ; rorbs: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 
 idx=15 coord=(4,0) corbs: 4 ; rorbs: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 
 idx=16 coord=(3,0) corbs: 3 ; rorbs: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 
 idx=17 coord=(2,0) corbs: 2 ; rorbs: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 
 idx=18 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 
 idx=19 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9 32 33 34 35 36 37 38 39 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31

fci::ci_load fname=./scratch/ci.info

ctns::rcanon_init qkind=qNSz

fci::ci_truncate ciconfs=1641 maxdets=10 ifortho=1
 iroot=0 <CI[trunc]|CI>=6.112239740347e-01

ctns::init_rbases rdm_svd=1.500e+00 svd_iop=13 thresh_proj=1.000e-10

idx=
idx=
idx=
idx=
idx=
idx=
idx=
idx=
idx=8 node=(11,0) type=1
idx=
idx=0
idx=6101 rsupport=7 8 9 
idx=
idx=
idx=
idx= node= node= node=15(187 node=(12,0) type=
idx=19 node=12(19,0) type=0 rsupport= node=( node=(7,0) type=(14115 node=(14,0) type=1
idx=
idx= node=(2 node=13 node=(16,0) type=
idx=1( rsupport= rsupport=4 node=(17,818 node=9, node=(1,0) 0 node= type=) type=10911 rsupport=0 rsupport=(1216813,14,01 node=1513(3,0) type=1) node= rsupport=51 2 ( type=0 10,0) type=3)10 type=1 , node=1 0)11( rsupport=40  type=9 rsupport=   180,123  rsupport=15, 0) type=1 rsupport= 5 6 7 8 9 1110 
 0(  10 rsupport= 11 12 13 14 15 11120 1 2 3 4 16 17 18 19 5 6 7  )12 13 14 15 1
84,0) type=1 rsupport=4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 16
 17 1813 14 15 

ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
17 node=(2,0) type=1 rsupport=2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 type= 13 14 15 
 rsupport=19 5 6 7 8 9 10 11 12 13 14 15 15
 rsupport=6 7 8 9 10 11 12 13 14 15 
19 5 6 7 8 9 10 11 12 13 )14 15 type=11 rsupport=9   rsupport=16

 13 ,  90) type=1 rsupport= 191011  12  5 6 1311134 16 17 18 1019 5 6 7 8 9 10 11 12 1713    ctns::right_projection<Qm,Tm> thresh_proj=   18 19 1414 12 5  15 
6ctns::right_projection<Qm,Tm> thresh_proj=ctns::right_projection<Qm,Tm> thresh_proj=131.000e-10
 131.000e-107 8 9 10 11 12 14 15
 13 14(14 
11 14 156 ,0) type=1 rsupport=17 18 19 5 6 7 8 9 10 11 12 13 14 15 15   
ctns::right_projection<Qm,Tm> thresh_proj= ctns::right_projection<Qm,Tm> thresh_proj=15 7
ctns::right_projection<Qm,Tm> thresh_proj= 12 13 14 15 
1.000e-10

 8 9 10 11 12 13 14 15 
1.000e-10
1.000e-10
1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=14 15 
ctns::right_projection<Qm,Tm> thresh_proj=ctns::right_projection<Qm,Tm> thresh_proj=ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
1.000e-10
15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10

ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=10,1,10 dimBc=1 1-popBc=0.000e+00 SvN=0.000e+00
 dim(space,lspace,rspace)= dim(space,lspace,rspace)=10----- TIMING FOR ,9,3 dimBc=3 1-popBc=ctns::right_projection<Qm,Tm> : 10,1.653e-020.000e+00 dim(space,lspace,rspace)= SvN= dim(space,lspace,rspace)= S -----5.721e-0110,9,3 dim(space,lspace,rspace)=
 dim(space,lspace,rspace)=1010 dim(space,lspace,rspace)=----- TIMING FOR ctns::right_projection<Qm,Tm>10 dim(space,lspace,rspace)= : 10,3,10 dimBc=3 1-popBc=101.648e-02, dimBc=, S -----, dim(space,lspace,rspace)=,
 dim(space,lspace,rspace)=510,3
7,2 dim(space,lspace,rspace)=4, 1-popBc=61010 dimBc=,, dim(space,lspace,rspace)= dim(space,lspace,rspace)= dim(space,lspace,rspace)=10 dimBc=41010 dimBc=60, dim(space,lspace,rspace)=10, dim(space,lspace,rspace)=10, dim(space,lspace,rspace)= dimBc=7101.110e-16 1-popBc=71010, SvN=8,1 dimBc=2 1-popBc= 1-popBc=01,0.572 1-popBc=1010,2.22e-16, SvN=4,1.1410 dimBc=1 1-popBc=010 SvN=10
0.23700 SvN=
7,6, dimBc=,87 SvN= SvN=5, dimBc=6
 SvN=----- TIMING FOR ctns::right_projection<Qm,Tm> : 0.722,1031.628e-02 S -----0.000e+00 1-popBc=0.4547
,1.11e-16, dim(space,lspace,rspace)=----- TIMING FOR ----- TIMING FOR 4 SvN=
 1-popBc=ctns::right_projection<Qm,Tm> dimBc=ctns::right_projection<Qm,Tm> dimBc=101.06 : 1.40
----- TIMING FOR ,,6 1-popBc=61
ctns::right_projection<Qm,Tm>
 1-popBc=0.000e+00 SvN=
4.949e-01
0.000e+00 SvN=----- TIMING FOR ctns::right_projection<Qm,Tm> :  dimBc=1.629e-02 S -----
2.811e-02 S -----
----- TIMING FOR ctns::right_projection<Qm,Tm> : ----- TIMING FOR ctns::right_projection<Qm,Tm> : ----- TIMING FOR ctns::right_projection<Qm,Tm> : 21.620e-02 1-popBc= S -----7
0.000e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : ----- TIMING FOR 1.612e-02 S -----
6 1-popBc= dimBc=4 1-popBc=0 SvN=1.14
 : ----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.634e-021.670e-02 S ----- S -----

 SvN=, : 9100.926,ctns::right_projection<Qm,Tm> dimBc=7 1-popBc= dimBc=
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.829e-021.568e-02 S -----
2.22e-16 SvN=2.817e-020.692
----- TIMING FOR ctns::right_projection<Qm,Tm> : 101.671e-02 S -----
71.569e-02 1-popBc=1.11e-16 S ----- S -----
 dimBc=6 1-popBc= SvN=0 SvN=1.14
----- TIMING FOR ctns::right_projection<Qm,Tm> : 
1.707e-02 S -----
 : 0.000e+001.655e-02 SvN= S -----
 S -----
0.291
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.399e+001.669e-02 S -----
0 SvN=1.25
----- TIMING FOR ctns::right_projection<Qm,Tm> : 
2.885e-02----- TIMING FOR ctns::right_projection<Qm,Tm> :  S -----1.706e-02
 S -----

generated rbases with thresh_proj=1e-10
 idx=0 node=(19,0) type=0 shape=4,4 1-popBc=0.000e+00
 idx=1 node=(18,0) type=1 shape=3,3 1-popBc=0.000e+00
 idx=2 node=(17,0) type=1 shape=3,3 1-popBc=0.000e+00
 idx=3 node=(16,0) type=1 shape=4,3 1-popBc=0.000e+00
 idx=4 node=(15,0) type=1 shape=4,2 1-popBc=1.110e-16
 idx=5 node=(14,0) type=1 shape=6,4 1-popBc=2.220e-16
 idx=6 node=(13,0) type=1 shape=8,6 1-popBc=1.110e-16
 idx=7 node=(12,0) type=1 shape=9,7 1-popBc=0.000e+00
 idx=8 node=(11,0) type=1 shape=10,7 1-popBc=0.000e+00
 idx=9 node=(10,0) type=1 shape=10,7 1-popBc=0.000e+00
 idx=10 node=(9,0) type=1 shape=10,6 1-popBc=0.000e+00
 idx=11 node=(8,0) type=1 shape=10,6 1-popBc=0.000e+00
 idx=12 node=(7,0) type=1 shape=10,6 1-popBc=0.000e+00
 idx=13 node=(6,0) type=1 shape=10,5 1-popBc=0.000e+00
 idx=14 node=(5,0) type=1 shape=10,4 1-popBc=0.000e+00
 idx=15 node=(4,0) type=1 shape=10,3 1-popBc=1.110e-16
 idx=16 node=(3,0) type=1 shape=10,2 1-popBc=2.220e-16
 idx=17 node=(2,0) type=1 shape=10,1 1-popBc=0.000e+00
 idx=18 node=(1,0) type=1 shape=10,1 1-popBc=0.000e+00
 idx=19 node=(0,0) type=0 shape=10,1 1-popBc=0.000e+00
maximum bond dimension = 7
----- TIMING FOR ctns::init_rbases : 4.691e-02 S -----

ctns::init_rsites qkind=qNSz thresh_ortho=1e-08
 idx=0 node=(19,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 deviate=0 TIMING=5.349e-05 S
 idx=1 node=(18,0)[1] shape(l,r,c)=(3,4,4) maxdiff=1.570e-16 deviate=0 TIMING=2.138e-02 S
 idx=2 node=(17,0)[1] shape(l,r,c)=(3,3,4) maxdiff=3.140e-16 deviate=0 TIMING=2.343e-02 S
 idx=3 node=(16,0)[1] shape(l,r,c)=(3,3,4) maxdiff=5.565e-16 deviate=0 TIMING=1.679e-02 S
 idx=4 node=(15,0)[1] shape(l,r,c)=(2,3,4) maxdiff=3.433e-16 deviate=0 TIMING=1.139e-02 S
 idx=5 node=(14,0)[1] shape(l,r,c)=(4,2,4) maxdiff=1.129e-15 deviate=0 TIMING=2.181e-02 S
 idx=6 node=(13,0)[1] shape(l,r,c)=(6,4,4) maxdiff=4.470e-16 deviate=0 TIMING=1.327e-02 S
 idx=7 node=(12,0)[1] shape(l,r,c)=(7,6,4) maxdiff=5.648e-16 deviate=0 TIMING=1.275e-02 S
 idx=8 node=(11,0)[1] shape(l,r,c)=(7,7,4) maxdiff=4.441e-16 deviate=0 TIMING=1.210e-02 S
 idx=9 node=(10,0)[1] shape(l,r,c)=(7,7,4) maxdiff=0.000e+00 deviate=0 TIMING=1.162e-02 S
 idx=10 node=(9,0)[1] shape(l,r,c)=(6,7,4) maxdiff=2.220e-16 deviate=0 TIMING=5.996e-03 S
 idx=11 node=(8,0)[1] shape(l,r,c)=(6,6,4) maxdiff=4.441e-16 deviate=0 TIMING=1.084e-02 S
 idx=12 node=(7,0)[1] shape(l,r,c)=(6,6,4) maxdiff=4.441e-16 deviate=0 TIMING=1.055e-02 S
 idx=13 node=(6,0)[1] shape(l,r,c)=(5,6,4) maxdiff=2.220e-16 deviate=0 TIMING=1.015e-02 S
 idx=14 node=(5,0)[1] shape(l,r,c)=(4,5,4) maxdiff=0.000e+00 deviate=0 TIMING=9.831e-03 S
 idx=15 node=(4,0)[1] shape(l,r,c)=(3,4,4) maxdiff=6.661e-16 deviate=0 TIMING=9.579e-03 S
 idx=16 node=(3,0)[1] shape(l,r,c)=(2,3,4) maxdiff=1.110e-16 deviate=0 TIMING=9.300e-03 S
 idx=17 node=(2,0)[1] shape(l,r,c)=(1,2,4) maxdiff=2.220e-16 deviate=0 TIMING=9.092e-03 S
 idx=18 node=(1,0)[1] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=9.070e-03 S
 idx=19 node=(0,0)[0] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=9.094e-03 S
----- TIMING FOR ctns::init_rsites : 2.388e-01 S -----

ctns::init_rwfuns qkind=qNSz thresh_ortho=1e-08
qtensor2: wf2 own=1 _data=0x3a713ec8
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.63e-06MB

check state overlaps ...
matrix: ova_rwfuns size=(1,1)
      1.0000e+00 
matrix: ova0_vs size=(1,1)
      1.0000e+00 
diff of ova matrices = 0
----- TIMING FOR ctns::init_rwfuns : 2.251e-04 S -----

ctns::init_rcanon thresh_ortho=1e-08

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=10
matrix: <CI|CTNS[0]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[0]> size=(1,1)
      1.0000e+00 

rcanon::rcanon_canonicalize ifortho=1 ifab=1 nroots=1 dmax=7
----- TIMING FOR ctns::rcanon_canonicalize : 3.599e-01 S -----

matrix: <CTNS[new]|CTNS[new]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=10
matrix: <CI|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=3 maxdiff=1.377e-17 deviate=0
 idx=2 node=(17,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=3 maxdiff=7.064e-16 deviate=0
 idx=4 node=(15,0) Drow=2 maxdiff=1.115e-15 deviate=0
 idx=5 node=(14,0) Drow=4 maxdiff=3.140e-16 deviate=0
 idx=6 node=(13,0) Drow=6 maxdiff=4.711e-16 deviate=0
 idx=7 node=(12,0) Drow=7 maxdiff=1.570e-16 deviate=0
 idx=8 node=(11,0) Drow=7 maxdiff=0.000e+00 deviate=0
 idx=9 node=(10,0) Drow=7 maxdiff=0.000e+00 deviate=0
 idx=10 node=(9,0) Drow=6 maxdiff=1.110e-16 deviate=0
 idx=11 node=(8,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=12 node=(7,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=13 node=(6,0) Drow=5 maxdiff=2.220e-16 deviate=0
 idx=14 node=(5,0) Drow=4 maxdiff=1.110e-16 deviate=0
 idx=15 node=(4,0) Drow=3 maxdiff=2.220e-16 deviate=0
 idx=16 node=(3,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=17 node=(2,0) Drow=1 maxdiff=3.331e-16 deviate=0
 idx=18 node=(1,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x3a7138f8
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x3a7138f8
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 3.205e-04 S -----
----- TIMING FOR ctns::rcanon_init : 6.641e-01 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci T(save)=0.00084S

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=3 maxdiff=1.377e-17 deviate=0
 idx=2 node=(17,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=3 maxdiff=7.064e-16 deviate=0
 idx=4 node=(15,0) Drow=2 maxdiff=1.115e-15 deviate=0
 idx=5 node=(14,0) Drow=4 maxdiff=3.140e-16 deviate=0
 idx=6 node=(13,0) Drow=6 maxdiff=4.711e-16 deviate=0
 idx=7 node=(12,0) Drow=7 maxdiff=1.570e-16 deviate=0
 idx=8 node=(11,0) Drow=7 maxdiff=0.000e+00 deviate=0
 idx=9 node=(10,0) Drow=7 maxdiff=0.000e+00 deviate=0
 idx=10 node=(9,0) Drow=6 maxdiff=1.110e-16 deviate=0
 idx=11 node=(8,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=12 node=(7,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=13 node=(6,0) Drow=5 maxdiff=2.220e-16 deviate=0
 idx=14 node=(5,0) Drow=4 maxdiff=1.110e-16 deviate=0
 idx=15 node=(4,0) Drow=3 maxdiff=2.220e-16 deviate=0
 idx=16 node=(3,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=17 node=(2,0) Drow=1 maxdiff=3.331e-16 deviate=0
 idx=18 node=(1,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x3a710c00
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x3a710c00
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 3.220e-04 S -----
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.001e+00 pageheap_free=6.096e-02 change=2.113e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

integral::load fname = moleinfo/fmole.info
 sorb = 40
 size(int1e) = 1600:1.221e-02MB:1.192e-05GB
 size(int2e) = 305370:2.330e+00MB:2.275e-03GB
 ecore = 0.000000000000
----- TIMING FOR integral::load : 1.085e-01 S -----

io::remove_scratch scratch=./scratch/sweep
successfully removed ./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=qNSz
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=5.865e-02 change=2.292e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(19,0) size=1.782e-02MB:1.740e-05GB
fname=./scratch/sweep/cop(19,0) size=1.74e-05GB T[save](info/data/tot)=0.000134,6.48e-05,0.000199 speed=0.0876GB/S disk[used]=1.77e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/rop(19,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/rop(19,0) size=1.74e-05GB T[save](info/data/tot)=9.51e-05,5.46e-05,0.00015 speed=0.116GB/S disk[used]=3.54e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(18,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(18,0) size=1.74e-05GB T[save](info/data/tot)=9.25e-05,5.04e-05,0.000143 speed=0.122GB/S disk[used]=5.31e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(17,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(17,0) size=1.74e-05GB T[save](info/data/tot)=9.48e-05,5.33e-05,0.000148 speed=0.118GB/S disk[used]=7.08e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(16,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(16,0) size=1.74e-05GB T[save](info/data/tot)=9.9e-05,5.5e-05,0.000154 speed=0.113GB/S disk[used]=8.84e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(15,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(15,0) size=1.74e-05GB T[save](info/data/tot)=0.000134,5.97e-05,0.000194 speed=0.0898GB/S disk[used]=0.000106GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(14,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(14,0) size=1.74e-05GB T[save](info/data/tot)=9.41e-05,5.15e-05,0.000146 speed=0.12GB/S disk[used]=0.000124GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(13,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(13,0) size=1.74e-05GB T[save](info/data/tot)=9.69e-05,5.04e-05,0.000147 speed=0.118GB/S disk[used]=0.000142GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(12,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(12,0) size=1.74e-05GB T[save](info/data/tot)=9.46e-05,5.06e-05,0.000145 speed=0.12GB/S disk[used]=0.000159GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(11,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(11,0) size=1.74e-05GB T[save](info/data/tot)=9.43e-05,5.13e-05,0.000146 speed=0.119GB/S disk[used]=0.000177GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(10,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(10,0) size=1.74e-05GB T[save](info/data/tot)=9.31e-05,5.34e-05,0.000146 speed=0.119GB/S disk[used]=0.000195GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(9,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(9,0) size=1.74e-05GB T[save](info/data/tot)=9.87e-05,5.1e-05,0.00015 speed=0.116GB/S disk[used]=0.000212GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(8,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(8,0) size=1.74e-05GB T[save](info/data/tot)=9.55e-05,5.21e-05,0.000148 speed=0.118GB/S disk[used]=0.00023GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(7,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(7,0) size=1.74e-05GB T[save](info/data/tot)=9.37e-05,5.55e-05,0.000149 speed=0.117GB/S disk[used]=0.000248GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(6,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(6,0) size=1.74e-05GB T[save](info/data/tot)=0.000101,5.35e-05,0.000155 speed=0.112GB/S disk[used]=0.000265GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(5,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(5,0) size=1.74e-05GB T[save](info/data/tot)=9.5e-05,4.94e-05,0.000144 speed=0.121GB/S disk[used]=0.000283GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(4,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(4,0) size=1.74e-05GB T[save](info/data/tot)=9.77e-05,8.84e-05,0.000186 speed=0.0935GB/S disk[used]=0.000301GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(3,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(3,0) size=1.74e-05GB T[save](info/data/tot)=0.000131,9.04e-05,0.000221 speed=0.0786GB/S disk[used]=0.000318GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(2,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(2,0) size=1.74e-05GB T[save](info/data/tot)=0.000131,8.32e-05,0.000214 speed=0.0812GB/S disk[used]=0.000336GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(1,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(1,0) size=1.74e-05GB T[save](info/data/tot)=0.000132,8.73e-05,0.000219 speed=0.0796GB/S disk[used]=0.000354GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(0,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(0,0) size=1.74e-05GB T[save](info/data/tot)=0.000139,8.59e-05,0.000225 speed=0.0773GB/S disk[used]=0.000371GB
----- TIMING FOR ctns::oper_init_dotCR : 2.263e-01 S -----
T[ctns::oper_init_dotCR](comp/save/tot)=0.208,0.00528,0.213

idx=1 coord=(18,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=5.779e-02 change=1.192e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
ctns::oper_renorm coord=(18,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=75:0.000572MB:5.59e-07GB
        per(mem): H:6.67 C:5.33 S:48 A:0 B:40 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=5.691e-02 change=1.775e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 2.166e-03 S -----
rank=0 GPUmem(GB): used=3.537e-05 (oper)=3.537e-05
rank=0 GPUmem(GB): used=3.541e-05 (oper,site)=3.537e-05,3.725e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=3.541e-05 (oper,site,rinter)=3.537e-05,3.725e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 1.120e-03 S size(rtasks)=57 size(Rlst2)=4 T(Rmu/Rlist)=7.389e-04,3.813e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.145e-03 S size(rtasks)=57 size(Rlst)=109 -----
rank=0 GPUmem(GB): used=3.541e-05 avail=6.176e+00 total=6.176e+00 batch[need]=7.309e-06 blksize=4 blksize0=0 batchsize=109
rank=0 GPUmem(GB): used=4.271e-05 (oper,site,rinter,batch)=3.537e-05,3.725e-08,0.000e+00,7.309e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.940e-04,2.251e-02,1.010e-02
----- TIMING FOR renorm : t_inter=5.9e-04 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.3e-02 -----
 renorm[inter] counter=1 t=5.9e-04 per=1.8e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=3.4e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=1.1e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=7.5e-03 per=2.3e+01 cost=1.2e+02 flops=1.6e+04
 renorm[gemm] counter=1 i=3 t=7.5e-03 per=2.3e+01 cost=1.8e+02 flops=2.4e+04
 renorm[gemm] counter=1 i=4 t=1.3e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=5 t=1.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=6 t=7.5e-03 per=2.3e+01 cost=5.2e+02 flops=7.0e+04
 renorm[gemm] counter=1 total t=2.3e-02 per=6.8e+01 cost=8.3e+02 flops=3.7e+04
 renorm[red] counter=1 t=1.0e-02 per=3.0e+01 cost=5.2e+02 flops=5.2e+04
----- TIMING FOR renorm_tot : t_inter=5.9e-04 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.3e-02 -----
 renorm_tot[inter] counter=1 t=5.9e-04 per=1.8e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=3.4e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=1.1e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=7.5e-03 per=2.3e+01 cost=1.2e+02 flops=1.6e+04
 renorm_tot[gemm] counter=1 i=3 t=7.5e-03 per=2.3e+01 cost=1.8e+02 flops=2.4e+04
 renorm_tot[gemm] counter=1 i=4 t=1.3e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=5 t=1.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=6 t=7.5e-03 per=2.3e+01 cost=5.2e+02 flops=7.0e+04
 renorm_tot[gemm] counter=1 total t=2.3e-02 per=6.8e+01 cost=8.3e+02 flops=3.7e+04
 renorm_tot[red] counter=1 t=1.0e-02 per=3.0e+01 cost=5.2e+02 flops=5.2e+04
qops.to_cpu: size(tot)=75:5.7e-04MB:5.6e-07GB T(to_cpu)=1.0e-04S speed=5.4e-03GB/S
check ||H-H.dagger||=1.256e-15 coord=(18,0) rank=0
----- TIMING FOR oper_renorm : 0.0403 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=5.677e-02 change=1.113e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=5.679e-02 change=-1.852e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=2.980e-08 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 6.541e-02 S #####
 T(local oper_env: fetch) = 2.251e-02 S  per = 34.4  per(accum) = 34.4
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 34.4
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 34.4
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 34.4
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 34.4
 T(local oper_env: renrm) = 4.270e-02 S  per = 65.3  per(accum) = 99.7
 T(local oper_env: save ) = 2.006e-04 S  per = 0.307  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.270e-02 S  T(sum) = 4.270e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.514e-05 S  per = 0.0355  per(accum) = 0.0355
 T(local oper_env: qops init                    ) = 4.398e-04 S  per = 1.03  per(accum) = 1.07
 T(local oper_env: symbolic_formulae_renorm     ) = 2.186e-03 S  per = 5.12  per(accum) = 6.19
 T(local oper_env: allocate qops on gpu         ) = 9.890e-05 S  per = 0.232  per(accum) = 6.42
 T(local oper_env: site memcpy cpu2gpu          ) = 2.179e-03 S  per =  5.1  per(accum) = 11.5
 T(local oper_env: rintermediate init           ) = 4.843e-05 S  per = 0.113  per(accum) = 11.6
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.154e-03 S  per =  2.7  per(accum) = 14.3
 T(local oper_env: rmmtasks init                ) = 6.924e-04 S  per = 1.62  per(accum) = 16
 T(local oper_env: qops memset on cpu           ) = 3.500e-08 S  per = 8.2e-05  per(accum) = 16
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.330e-02 S  per =   78  per(accum) = 94
 T(local oper_env: deallocate cpu and gpu memory) = 5.036e-05 S  per = 0.118  per(accum) = 94.1
 T(local oper_env: construct opS [ifdists=true] ) = 3.500e-08 S  per = 8.2e-05  per(accum) = 94.1
 T(local oper_env: reduction of opS & opH [nccl]) = 4.300e-08 S  per = 0.000101  per(accum) = 94.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.160e-04 S  per = 0.272  per(accum) = 94.4
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.387e-05 S  per = 0.0559  per(accum) = 94.4
 T(local oper_env: qops_pool join and erase     ) = 2.386e-03 S  per = 5.59  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 8.400e-07 S  per = 0.00197  per(accum) = 100
##### sweep oper_env: 6.541e-02 S #####
 T(sweep oper_env: fetch) = 2.251e-02 S  per = 34.4  per(accum) = 34.4
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 34.4
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 34.4
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 34.4
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 34.4
 T(sweep oper_env: renrm) = 4.270e-02 S  per = 65.3  per(accum) = 99.7
 T(sweep oper_env: save ) = 2.006e-04 S  per = 0.307  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(sweep oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.270e-02 S  T(sum) = 4.270e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.514e-05 S  per = 0.0355  per(accum) = 0.0355
 T(sweep oper_env: qops init                    ) = 4.398e-04 S  per = 1.03  per(accum) = 1.07
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.186e-03 S  per = 5.12  per(accum) = 6.19
 T(sweep oper_env: allocate qops on gpu         ) = 9.890e-05 S  per = 0.232  per(accum) = 6.42
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.179e-03 S  per =  5.1  per(accum) = 11.5
 T(sweep oper_env: rintermediate init           ) = 4.843e-05 S  per = 0.113  per(accum) = 11.6
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.154e-03 S  per =  2.7  per(accum) = 14.3
 T(sweep oper_env: rmmtasks init                ) = 6.924e-04 S  per = 1.62  per(accum) = 16
 T(sweep oper_env: qops memset on cpu           ) = 3.500e-08 S  per = 8.2e-05  per(accum) = 16
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.330e-02 S  per =   78  per(accum) = 94
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.036e-05 S  per = 0.118  per(accum) = 94.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.500e-08 S  per = 8.2e-05  per(accum) = 94.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.300e-08 S  per = 0.000101  per(accum) = 94.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.160e-04 S  per = 0.272  per(accum) = 94.4
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.387e-05 S  per = 0.0559  per(accum) = 94.4
 T(sweep oper_env: qops_pool join and erase     ) = 2.386e-03 S  per = 5.59  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 8.400e-07 S  per = 0.00197  per(accum) = 100

idx=2 coord=(17,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=75:0.000572MB:5.59e-07GB
        per(mem): H:6.67 C:5.33 S:48 A:0 B:40 
ctns::oper_renorm coord=(17,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=105:0.000801MB:7.82e-07GB
        per(mem): H:4.76 C:5.71 S:32.4 A:0 B:57.1 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.073e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 3.447e-03 S -----
rank=0 GPUmem(GB): used=1.875e-05 (oper)=1.875e-05
rank=0 GPUmem(GB): used=1.880e-05 (oper,site)=1.875e-05,5.215e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=176
 no. of coefficients=745:5.684e-03MB:5.551e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.535e-03 S -----
rank=0 GPUmem(GB): used=2.435e-05 (oper,site,rinter)=1.875e-05,5.215e-08,5.551e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.215e-03 S size(rtasks)=77 size(Rlst2)=4 T(Rmu/Rlist)=1.758e-03,4.570e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.259e-03 S size(rtasks)=77 size(Rlst)=163 -----
rank=0 GPUmem(GB): used=2.435e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.579e-05 blksize=4 blksize0=4 batchsize=163
rank=0 GPUmem(GB): used=4.014e-05 (oper,site,rinter,batch)=1.875e-05,5.215e-08,5.551e-06,1.579e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.705e-03,2.255e-02,9.918e-03
----- TIMING FOR renorm : t_inter=6.7e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=2 t=6.7e-03 per=1.7e+01 cost=7.4e+02 flops=1.1e+05
 renorm[gemm] counter=2 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=2 t=7.5e-03 per=1.9e+01 cost=4.5e+02 flops=6.0e+04
 renorm[gemm] counter=2 i=3 t=7.6e-03 per=1.9e+01 cost=4.4e+02 flops=5.8e+04
 renorm[gemm] counter=2 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=5 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=6 t=7.5e-03 per=1.9e+01 cost=9.5e+02 flops=1.3e+05
 renorm[gemm] counter=2 total t=2.3e-02 per=5.8e+01 cost=1.8e+03 flops=8.2e+04
 renorm[red] counter=2 t=9.9e-03 per=2.5e+01 cost=7.9e+02 flops=8.0e+04
----- TIMING FOR renorm_tot : t_inter=7.3e-03 t_gemm=4.5e-02 t_reduction=2.0e-02 tot=7.2e-02 -----
 renorm_tot[inter] counter=2 t=7.3e-03 per=1.0e+01 cost=7.4e+02 flops=1.0e+05
 renorm_tot[gemm] counter=2 i=0 t=4.7e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=1 t=2.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=2 t=1.5e-02 per=2.1e+01 cost=5.8e+02 flops=3.8e+04
 renorm_tot[gemm] counter=2 i=3 t=1.5e-02 per=2.1e+01 cost=6.2e+02 flops=4.1e+04
 renorm_tot[gemm] counter=2 i=4 t=2.5e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=5 t=2.5e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=6 t=1.5e-02 per=2.1e+01 cost=1.5e+03 flops=9.8e+04
 renorm_tot[gemm] counter=2 total t=4.5e-02 per=6.2e+01 cost=2.7e+03 flops=5.9e+04
 renorm_tot[red] counter=2 t=2.0e-02 per=2.8e+01 cost=1.3e+03 flops=6.6e+04
qops.to_cpu: size(tot)=105:8.0e-04MB:7.8e-07GB T(to_cpu)=9.4e-05S speed=8.3e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.0505 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.192e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.221e-04 change=-1.110e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 6.315e-02 S #####
 T(local oper_env: fetch) = 1.099e-02 S  per = 17.4  per(accum) = 17.4
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17.4
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17.4
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17.4
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17.4
 T(local oper_env: renrm) = 5.194e-02 S  per = 82.2  per(accum) = 99.6
 T(local oper_env: save ) = 2.221e-04 S  per = 0.352  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.194e-02 S  T(sum) = 5.194e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.875e-06 S  per = 0.019  per(accum) = 0.019
 T(local oper_env: qops init                    ) = 4.893e-04 S  per = 0.942  per(accum) = 0.961
 T(local oper_env: symbolic_formulae_renorm     ) = 3.458e-03 S  per = 6.66  per(accum) = 7.62
 T(local oper_env: allocate qops on gpu         ) = 5.920e-05 S  per = 0.114  per(accum) = 7.73
 T(local oper_env: site memcpy cpu2gpu          ) = 1.279e-03 S  per = 2.46  per(accum) = 10.2
 T(local oper_env: rintermediate init           ) = 2.547e-03 S  per =  4.9  per(accum) = 15.1
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.269e-03 S  per = 4.37  per(accum) = 19.5
 T(local oper_env: rmmtasks init                ) = 9.927e-04 S  per = 1.91  per(accum) = 21.4
 T(local oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 6.55e-05  per(accum) = 21.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.927e-02 S  per = 75.6  per(accum) = 97
 T(local oper_env: deallocate cpu and gpu memory) = 3.592e-05 S  per = 0.0692  per(accum) = 97
 T(local oper_env: construct opS [ifdists=true] ) = 3.300e-08 S  per = 6.35e-05  per(accum) = 97
 T(local oper_env: reduction of opS & opH [nccl]) = 3.400e-08 S  per = 6.55e-05  per(accum) = 97
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.008e-04 S  per = 0.194  per(accum) = 97.2
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.645e-05 S  per = 0.0317  per(accum) = 97.3
 T(local oper_env: qops_pool join and erase     ) = 1.415e-03 S  per = 2.72  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.730e-07 S  per = 0.00149  per(accum) = 100
##### sweep oper_env: 1.286e-01 S #####
 T(sweep oper_env: fetch) = 3.350e-02 S  per = 26.1  per(accum) = 26.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 26.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 26.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 26.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 26.1
 T(sweep oper_env: renrm) = 9.464e-02 S  per = 73.6  per(accum) = 99.7
 T(sweep oper_env: save ) = 4.227e-04 S  per = 0.329  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.473e+09 S  per = -3.473e+31
 T(sweep oper_env: preprocess                  ) = -3.473e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.464e-02 S  T(sum) = 9.464e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.502e-05 S  per = 0.0264  per(accum) = 0.0264
 T(sweep oper_env: qops init                    ) = 9.292e-04 S  per = 0.982  per(accum) = 1.01
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.644e-03 S  per = 5.96  per(accum) = 6.97
 T(sweep oper_env: allocate qops on gpu         ) = 1.581e-04 S  per = 0.167  per(accum) = 7.14
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.458e-03 S  per = 3.65  per(accum) = 10.8
 T(sweep oper_env: rintermediate init           ) = 2.595e-03 S  per = 2.74  per(accum) = 13.5
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.424e-03 S  per = 3.62  per(accum) = 17.2
 T(sweep oper_env: rmmtasks init                ) = 1.685e-03 S  per = 1.78  per(accum) = 18.9
 T(sweep oper_env: qops memset on cpu           ) = 6.900e-08 S  per = 7.29e-05  per(accum) = 18.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 7.257e-02 S  per = 76.7  per(accum) = 95.6
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.628e-05 S  per = 0.0912  per(accum) = 95.7
 T(sweep oper_env: construct opS [ifdists=true] ) = 6.800e-08 S  per = 7.19e-05  per(accum) = 95.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 7.700e-08 S  per = 8.14e-05  per(accum) = 95.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.168e-04 S  per = 0.229  per(accum) = 95.9
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 4.032e-05 S  per = 0.0426  per(accum) = 96
 T(sweep oper_env: qops_pool join and erase     ) = 3.800e-03 S  per = 4.02  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.613e-06 S  per = 0.0017  per(accum) = 100

idx=3 coord=(16,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=105:0.000801MB:7.82e-07GB
        per(mem): H:4.76 C:5.71 S:32.4 A:0 B:57.1 
ctns::oper_renorm coord=(16,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.181e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=105 : 4.807e-03 S -----
rank=0 GPUmem(GB): used=1.927e-05 (oper)=1.927e-05
rank=0 GPUmem(GB): used=1.933e-05 (oper,site)=1.927e-05,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=327
 no. of coefficients=1890:1.442e-02MB:1.408e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.501e-03 S -----
rank=0 GPUmem(GB): used=3.341e-05 (oper,site,rinter)=1.927e-05,5.960e-08,1.408e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.920e-03 S size(rtasks)=105 size(Rlst2)=4 T(Rmu/Rlist)=1.496e-03,4.242e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.956e-03 S size(rtasks)=105 size(Rlst)=184 -----
rank=0 GPUmem(GB): used=3.341e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.782e-05 blksize=4 blksize0=4 batchsize=184
rank=0 GPUmem(GB): used=5.123e-05 (oper,site,rinter,batch)=1.927e-05,5.960e-08,1.408e-05,1.782e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.539e-03,2.275e-02,1.018e-02
----- TIMING FOR renorm : t_inter=5.5e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=3 t=5.5e-03 per=1.4e+01 cost=4.8e+03 flops=8.7e+05
 renorm[gemm] counter=3 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=2 t=7.6e-03 per=2.0e+01 cost=4.2e+02 flops=5.5e+04
 renorm[gemm] counter=3 i=3 t=7.5e-03 per=1.9e+01 cost=6.9e+02 flops=9.2e+04
 renorm[gemm] counter=3 i=4 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=5 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=6 t=7.6e-03 per=2.0e+01 cost=1.4e+03 flops=1.8e+05
 renorm[gemm] counter=3 total t=2.3e-02 per=5.9e+01 cost=2.5e+03 flops=1.1e+05
 renorm[red] counter=3 t=1.0e-02 per=2.6e+01 cost=9.2e+02 flops=9.0e+04
----- TIMING FOR renorm_tot : t_inter=1.3e-02 t_gemm=6.8e-02 t_reduction=3.0e-02 tot=1.1e-01 -----
 renorm_tot[inter] counter=3 t=1.3e-02 per=1.2e+01 cost=5.5e+03 flops=4.3e+05
 renorm_tot[gemm] counter=3 i=0 t=6.0e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=1 t=3.5e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=2 t=2.3e-02 per=2.0e+01 cost=1.0e+03 flops=4.4e+04
 renorm_tot[gemm] counter=3 i=3 t=2.3e-02 per=2.0e+01 cost=1.3e+03 flops=5.8e+04
 renorm_tot[gemm] counter=3 i=4 t=3.6e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=5 t=3.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=6 t=2.3e-02 per=2.0e+01 cost=2.8e+03 flops=1.3e+05
 renorm_tot[gemm] counter=3 total t=6.8e-02 per=6.1e+01 cost=5.2e+03 flops=7.6e+04
 renorm_tot[red] counter=3 t=3.0e-02 per=2.7e+01 cost=2.2e+03 flops=7.4e+04
qops.to_cpu: size(tot)=145:1.1e-03MB:1.1e-06GB T(to_cpu)=1.2e-04S speed=9.2e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.0531 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.526e-05 change=2.896e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.526e-05 change=-1.187e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 6.462e-02 S #####
 T(local oper_env: fetch) = 1.014e-02 S  per = 15.7  per(accum) = 15.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15.7
 T(local oper_env: renrm) = 5.428e-02 S  per =   84  per(accum) = 99.7
 T(local oper_env: save ) = 2.010e-04 S  per = 0.311  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.428e-02 S  T(sum) = 5.428e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.884e-06 S  per = 0.0164  per(accum) = 0.0164
 T(local oper_env: qops init                    ) = 6.003e-04 S  per = 1.11  per(accum) = 1.12
 T(local oper_env: symbolic_formulae_renorm     ) = 4.818e-03 S  per = 8.88  per(accum) = 10
 T(local oper_env: allocate qops on gpu         ) = 5.850e-05 S  per = 0.108  per(accum) = 10.1
 T(local oper_env: site memcpy cpu2gpu          ) = 1.798e-03 S  per = 3.31  per(accum) = 13.4
 T(local oper_env: rintermediate init           ) = 2.511e-03 S  per = 4.63  per(accum) = 18
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.966e-03 S  per = 3.62  per(accum) = 21.7
 T(local oper_env: rmmtasks init                ) = 2.641e-03 S  per = 4.87  per(accum) = 26.5
 T(local oper_env: qops memset on cpu           ) = 3.200e-08 S  per = 5.9e-05  per(accum) = 26.5
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.856e-02 S  per =   71  per(accum) = 97.6
 T(local oper_env: deallocate cpu and gpu memory) = 3.364e-05 S  per = 0.062  per(accum) = 97.6
 T(local oper_env: construct opS [ifdists=true] ) = 3.600e-08 S  per = 6.63e-05  per(accum) = 97.6
 T(local oper_env: reduction of opS & opH [nccl]) = 3.500e-08 S  per = 6.45e-05  per(accum) = 97.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.253e-04 S  per = 0.231  per(accum) = 97.9
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.638e-05 S  per = 0.0302  per(accum) = 97.9
 T(local oper_env: qops_pool join and erase     ) = 1.138e-03 S  per =  2.1  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.710e-07 S  per = 0.00124  per(accum) = 100
##### sweep oper_env: 1.932e-01 S #####
 T(sweep oper_env: fetch) = 4.364e-02 S  per = 22.6  per(accum) = 22.6
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 22.6
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 22.6
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 22.6
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 22.6
 T(sweep oper_env: renrm) = 1.489e-01 S  per = 77.1  per(accum) = 99.7
 T(sweep oper_env: save ) = 6.237e-04 S  per = 0.323  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -5.210e+09 S  per = -5.210e+31
 T(sweep oper_env: preprocess                  ) = -5.210e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.489e-01 S  T(sum) = 1.489e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 3.390e-05 S  per = 0.0228  per(accum) = 0.0228
 T(sweep oper_env: qops init                    ) = 1.529e-03 S  per = 1.03  per(accum) = 1.05
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.046e-02 S  per = 7.02  per(accum) = 8.07
 T(sweep oper_env: allocate qops on gpu         ) = 2.166e-04 S  per = 0.145  per(accum) = 8.22
 T(sweep oper_env: site memcpy cpu2gpu          ) = 5.256e-03 S  per = 3.53  per(accum) = 11.7
 T(sweep oper_env: rintermediate init           ) = 5.106e-03 S  per = 3.43  per(accum) = 15.2
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.390e-03 S  per = 3.62  per(accum) = 18.8
 T(sweep oper_env: rmmtasks init                ) = 4.326e-03 S  per = 2.91  per(accum) = 21.7
 T(sweep oper_env: qops memset on cpu           ) = 1.010e-07 S  per = 6.78e-05  per(accum) = 21.7
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.111e-01 S  per = 74.6  per(accum) = 96.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.199e-04 S  per = 0.0805  per(accum) = 96.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.040e-07 S  per = 6.98e-05  per(accum) = 96.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.120e-07 S  per = 7.52e-05  per(accum) = 96.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.421e-04 S  per = 0.23  per(accum) = 96.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 5.670e-05 S  per = 0.0381  per(accum) = 96.7
 T(sweep oper_env: qops_pool join and erase     ) = 4.939e-03 S  per = 3.32  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.284e-06 S  per = 0.00153  per(accum) = 100

idx=4 coord=(15,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
ctns::oper_renorm coord=(15,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=124:0.000946MB:9.24e-07GB
        per(mem): H:3.23 C:0 S:0 A:0 B:96.8 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.239e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=141 : 6.053e-03 S -----
rank=0 GPUmem(GB): used=1.941e-05 (oper)=1.941e-05
rank=0 GPUmem(GB): used=1.945e-05 (oper,site)=1.941e-05,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=307
 no. of coefficients=2932:2.237e-02MB:2.185e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.495e-03 S -----
rank=0 GPUmem(GB): used=4.130e-05 (oper,site,rinter)=1.941e-05,4.470e-08,2.185e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.756e-03 S size(rtasks)=141 size(Rlst2)=1 T(Rmu/Rlist)=1.482e-03,2.746e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.778e-03 S size(rtasks)=141 size(Rlst)=77 -----
rank=0 GPUmem(GB): used=4.130e-05 avail=6.176e+00 total=6.176e+00 batch[need]=7.458e-06 blksize=4 blksize0=4 batchsize=77
rank=0 GPUmem(GB): used=4.876e-05 (oper,site,rinter,batch)=1.941e-05,4.470e-08,2.185e-05,7.458e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.855e-03,1.030e-02,2.580e-03
----- TIMING FOR renorm : t_inter=7.9e-03 t_gemm=1.0e-02 t_reduction=2.6e-03 tot=2.1e-02 -----
 renorm[inter] counter=4 t=7.9e-03 per=3.8e+01 cost=1.4e+03 flops=1.8e+05
 renorm[gemm] counter=4 i=0 t=1.4e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=1 t=1.3e-06 per=6.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=2 t=7.5e-03 per=3.6e+01 cost=1.6e+02 flops=2.2e+04
 renorm[gemm] counter=4 i=3 t=1.4e-03 per=6.5e+00 cost=5.3e+02 flops=3.9e+05
 renorm[gemm] counter=4 i=4 t=1.1e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=5 t=1.1e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=6 t=1.4e-03 per=6.8e+00 cost=9.6e+02 flops=6.9e+05
 renorm[gemm] counter=4 total t=1.0e-02 per=5.0e+01 cost=1.7e+03 flops=1.6e+05
 renorm[red] counter=4 t=2.6e-03 per=1.2e+01 cost=6.2e+02 flops=2.4e+05
----- TIMING FOR renorm_tot : t_inter=2.1e-02 t_gemm=7.8e-02 t_reduction=3.3e-02 tot=1.3e-01 -----
 renorm_tot[inter] counter=4 t=2.1e-02 per=1.6e+01 cost=7.0e+03 flops=3.4e+05
 renorm_tot[gemm] counter=4 i=0 t=7.4e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=1 t=4.8e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=2 t=3.0e-02 per=2.3e+01 cost=1.2e+03 flops=3.8e+04
 renorm_tot[gemm] counter=4 i=3 t=2.4e-02 per=1.8e+01 cost=1.8e+03 flops=7.7e+04
 renorm_tot[gemm] counter=4 i=4 t=4.7e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=5 t=4.8e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=6 t=2.4e-02 per=1.8e+01 cost=3.8e+03 flops=1.6e+05
 renorm_tot[gemm] counter=4 total t=7.8e-02 per=5.9e+01 cost=6.8e+03 flops=8.7e+04
 renorm_tot[red] counter=4 t=3.3e-02 per=2.5e+01 cost=2.8e+03 flops=8.7e+04
qops.to_cpu: size(tot)=124:9.5e-04MB:9.2e-07GB T(to_cpu)=1.5e-04S speed=6.1e-03GB/S
check ||H-H.dagger||=9.421e-16 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.0335 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=7.629e-06 change=3.282e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=7.629e-06 change=-1.242e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 4.473e-02 S #####
 T(local oper_env: fetch) = 9.970e-03 S  per = 22.3  per(accum) = 22.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 22.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 22.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 22.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 22.3
 T(local oper_env: renrm) = 3.456e-02 S  per = 77.3  per(accum) = 99.6
 T(local oper_env: save ) = 1.995e-04 S  per = 0.446  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.456e-02 S  T(sum) = 3.456e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.737e-06 S  per = 0.0253  per(accum) = 0.0253
 T(local oper_env: qops init                    ) = 7.029e-04 S  per = 2.03  per(accum) = 2.06
 T(local oper_env: symbolic_formulae_renorm     ) = 6.066e-03 S  per = 17.6  per(accum) = 19.6
 T(local oper_env: allocate qops on gpu         ) = 5.505e-05 S  per = 0.159  per(accum) = 19.8
 T(local oper_env: site memcpy cpu2gpu          ) = 8.824e-04 S  per = 2.55  per(accum) = 22.3
 T(local oper_env: rintermediate init           ) = 2.505e-03 S  per = 7.25  per(accum) = 29.6
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.784e-03 S  per = 5.16  per(accum) = 34.7
 T(local oper_env: rmmtasks init                ) = 4.557e-04 S  per = 1.32  per(accum) = 36.1
 T(local oper_env: qops memset on cpu           ) = 6.500e-08 S  per = 0.000188  per(accum) = 36.1
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.084e-02 S  per = 60.3  per(accum) = 96.3
 T(local oper_env: deallocate cpu and gpu memory) = 2.723e-05 S  per = 0.0788  per(accum) = 96.4
 T(local oper_env: construct opS [ifdists=true] ) = 3.900e-08 S  per = 0.000113  per(accum) = 96.4
 T(local oper_env: reduction of opS & opH [nccl]) = 3.500e-08 S  per = 0.000101  per(accum) = 96.4
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.579e-04 S  per = 0.457  per(accum) = 96.9
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.573e-05 S  per = 0.0455  per(accum) = 96.9
 T(local oper_env: qops_pool join and erase     ) = 1.063e-03 S  per = 3.07  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.450e-07 S  per = 0.00187  per(accum) = 100
##### sweep oper_env: 2.379e-01 S #####
 T(sweep oper_env: fetch) = 5.361e-02 S  per = 22.5  per(accum) = 22.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 22.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 22.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 22.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 22.5
 T(sweep oper_env: renrm) = 1.835e-01 S  per = 77.1  per(accum) = 99.7
 T(sweep oper_env: save ) = 8.232e-04 S  per = 0.346  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -6.947e+09 S  per = -6.947e+31
 T(sweep oper_env: preprocess                  ) = -6.947e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.835e-01 S  T(sum) = 1.835e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 4.264e-05 S  per = 0.0232  per(accum) = 0.0232
 T(sweep oper_env: qops init                    ) = 2.232e-03 S  per = 1.22  per(accum) = 1.24
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.653e-02 S  per = 9.01  per(accum) = 10.2
 T(sweep oper_env: allocate qops on gpu         ) = 2.717e-04 S  per = 0.148  per(accum) = 10.4
 T(sweep oper_env: site memcpy cpu2gpu          ) = 6.138e-03 S  per = 3.35  per(accum) = 13.7
 T(sweep oper_env: rintermediate init           ) = 7.612e-03 S  per = 4.15  per(accum) = 17.9
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 7.174e-03 S  per = 3.91  per(accum) = 21.8
 T(sweep oper_env: rmmtasks init                ) = 4.782e-03 S  per = 2.61  per(accum) = 24.4
 T(sweep oper_env: qops memset on cpu           ) = 1.660e-07 S  per = 9.05e-05  per(accum) = 24.4
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.320e-01 S  per = 71.9  per(accum) = 96.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.471e-04 S  per = 0.0802  per(accum) = 96.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.430e-07 S  per = 7.79e-05  per(accum) = 96.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.470e-07 S  per = 8.01e-05  per(accum) = 96.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 5.001e-04 S  per = 0.273  per(accum) = 96.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 7.244e-05 S  per = 0.0395  per(accum) = 96.7
 T(sweep oper_env: qops_pool join and erase     ) = 6.001e-03 S  per = 3.27  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.929e-06 S  per = 0.0016  per(accum) = 100

idx=5 coord=(14,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=124:0.000946MB:9.24e-07GB
        per(mem): H:3.23 C:0 S:0 A:0 B:96.8 
ctns::oper_renorm coord=(14,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=374:0.00285MB:2.79e-06GB
        per(mem): H:1.6 C:6.42 S:15 A:0 B:77 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.716e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 7.382e-03 S -----
rank=0 GPUmem(GB): used=2.111e-05 (oper)=2.111e-05
rank=0 GPUmem(GB): used=2.117e-05 (oper,site)=2.111e-05,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=287
 no. of coefficients=4090:3.120e-02MB:3.047e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.470e-03 S -----
rank=0 GPUmem(GB): used=5.165e-05 (oper,site,rinter)=2.111e-05,5.960e-08,3.047e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.982e-03 S size(rtasks)=185 size(Rlst2)=9 T(Rmu/Rlist)=1.510e-03,4.715e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.017e-03 S size(rtasks)=185 size(Rlst)=209 -----
rank=0 GPUmem(GB): used=5.165e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.024e-05 blksize=4 blksize0=4 batchsize=209
rank=0 GPUmem(GB): used=7.189e-05 (oper,site,rinter,batch)=2.111e-05,5.960e-08,3.047e-05,2.024e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.677e-03,2.236e-02,9.894e-03
----- TIMING FOR renorm : t_inter=6.7e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=5 t=6.7e-03 per=1.7e+01 cost=1.7e+04 flops=2.6e+06
 renorm[gemm] counter=5 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=2 t=7.5e-03 per=1.9e+01 cost=5.8e+02 flops=7.7e+04
 renorm[gemm] counter=5 i=3 t=7.5e-03 per=1.9e+01 cost=1.5e+03 flops=2.0e+05
 renorm[gemm] counter=5 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=5 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=6 t=7.4e-03 per=1.9e+01 cost=1.7e+03 flops=2.3e+05
 renorm[gemm] counter=5 total t=2.2e-02 per=5.7e+01 cost=3.8e+03 flops=1.7e+05
 renorm[red] counter=5 t=9.9e-03 per=2.5e+01 cost=8.5e+02 flops=8.6e+04
----- TIMING FOR renorm_tot : t_inter=2.7e-02 t_gemm=1.0e-01 t_reduction=4.3e-02 tot=1.7e-01 -----
 renorm_tot[inter] counter=5 t=2.7e-02 per=1.6e+01 cost=2.4e+04 flops=8.9e+05
 renorm_tot[gemm] counter=5 i=0 t=8.8e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=1 t=6.0e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=2 t=3.8e-02 per=2.2e+01 cost=1.7e+03 flops=4.6e+04
 renorm_tot[gemm] counter=5 i=3 t=3.1e-02 per=1.8e+01 cost=3.4e+03 flops=1.1e+05
 renorm_tot[gemm] counter=5 i=4 t=5.9e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=5 t=6.0e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=6 t=3.1e-02 per=1.8e+01 cost=5.5e+03 flops=1.8e+05
 renorm_tot[gemm] counter=5 total t=1.0e-01 per=5.9e+01 cost=1.1e+04 flops=1.1e+05
 renorm_tot[red] counter=5 t=4.3e-02 per=2.5e+01 cost=3.7e+03 flops=8.7e+04
qops.to_cpu: size(tot)=374:2.9e-03MB:2.8e-06GB T(to_cpu)=2.0e-04S speed=1.4e-02GB/S
check ||H-H.dagger||=3.140e-16 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.0557 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=4.465e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.364e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 6.690e-02 S #####
 T(local oper_env: fetch) = 9.913e-03 S  per = 14.8  per(accum) = 14.8
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(local oper_env: renrm) = 5.679e-02 S  per = 84.9  per(accum) = 99.7
 T(local oper_env: save ) = 1.991e-04 S  per = 0.298  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.679e-02 S  T(sum) = 5.679e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.633e-06 S  per = 0.0152  per(accum) = 0.0152
 T(local oper_env: qops init                    ) = 1.041e-03 S  per = 1.83  per(accum) = 1.85
 T(local oper_env: symbolic_formulae_renorm     ) = 7.395e-03 S  per =   13  per(accum) = 14.9
 T(local oper_env: allocate qops on gpu         ) = 4.954e-05 S  per = 0.0872  per(accum) = 15
 T(local oper_env: site memcpy cpu2gpu          ) = 2.107e-03 S  per = 3.71  per(accum) = 18.7
 T(local oper_env: rintermediate init           ) = 2.480e-03 S  per = 4.37  per(accum) = 23
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.029e-03 S  per = 3.57  per(accum) = 26.6
 T(local oper_env: rmmtasks init                ) = 1.295e-03 S  per = 2.28  per(accum) = 28.9
 T(local oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 5.99e-05  per(accum) = 28.9
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.903e-02 S  per = 68.7  per(accum) = 97.6
 T(local oper_env: deallocate cpu and gpu memory) = 3.003e-05 S  per = 0.0529  per(accum) = 97.7
 T(local oper_env: construct opS [ifdists=true] ) = 3.800e-08 S  per = 6.69e-05  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [nccl]) = 3.200e-08 S  per = 5.63e-05  per(accum) = 97.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.044e-04 S  per = 0.36  per(accum) = 98
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.738e-05 S  per = 0.0306  per(accum) = 98.1
 T(local oper_env: qops_pool join and erase     ) = 1.105e-03 S  per = 1.95  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.590e-07 S  per = 0.00116  per(accum) = 100
##### sweep oper_env: 3.048e-01 S #####
 T(sweep oper_env: fetch) = 6.352e-02 S  per = 20.8  per(accum) = 20.8
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 20.8
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 20.8
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 20.8
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 20.8
 T(sweep oper_env: renrm) = 2.403e-01 S  per = 78.8  per(accum) = 99.7
 T(sweep oper_env: save ) = 1.022e-03 S  per = 0.335  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -8.683e+09 S  per = -8.683e+31
 T(sweep oper_env: preprocess                  ) = -8.683e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.403e-01 S  T(sum) = 2.403e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 5.127e-05 S  per = 0.0213  per(accum) = 0.0213
 T(sweep oper_env: qops init                    ) = 3.274e-03 S  per = 1.36  per(accum) = 1.38
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.392e-02 S  per = 9.96  per(accum) = 11.3
 T(sweep oper_env: allocate qops on gpu         ) = 3.212e-04 S  per = 0.134  per(accum) = 11.5
 T(sweep oper_env: site memcpy cpu2gpu          ) = 8.245e-03 S  per = 3.43  per(accum) = 14.9
 T(sweep oper_env: rintermediate init           ) = 1.009e-02 S  per =  4.2  per(accum) = 19.1
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 9.203e-03 S  per = 3.83  per(accum) = 22.9
 T(sweep oper_env: rmmtasks init                ) = 6.077e-03 S  per = 2.53  per(accum) = 25.5
 T(sweep oper_env: qops memset on cpu           ) = 2.000e-07 S  per = 8.32e-05  per(accum) = 25.5
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.710e-01 S  per = 71.2  per(accum) = 96.6
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.772e-04 S  per = 0.0737  per(accum) = 96.7
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.810e-07 S  per = 7.53e-05  per(accum) = 96.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.790e-07 S  per = 7.45e-05  per(accum) = 96.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 7.045e-04 S  per = 0.293  per(accum) = 97
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 8.981e-05 S  per = 0.0374  per(accum) = 97
 T(sweep oper_env: qops_pool join and erase     ) = 7.106e-03 S  per = 2.96  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.588e-06 S  per = 0.00149  per(accum) = 100

idx=6 coord=(13,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=374:0.00285MB:2.79e-06GB
        per(mem): H:1.6 C:6.42 S:15 A:0 B:77 
ctns::oper_renorm coord=(13,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=12:9.16e-05MB size(tot)=1040:0.00793MB:7.75e-06GB
        per(mem): H:1.15 C:5.38 S:10 A:0 B:83.5 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.983e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=237 : 8.881e-03 S -----
rank=0 GPUmem(GB): used=2.794e-05 (oper)=2.794e-05
rank=0 GPUmem(GB): used=2.806e-05 (oper,site)=2.794e-05,1.192e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=267
 no. of coefficients=5310:4.051e-02MB:3.956e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.487e-03 S -----
rank=0 GPUmem(GB): used=6.762e-05 (oper,site,rinter)=2.794e-05,1.192e-07,3.956e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.468e-03 S size(rtasks)=237 size(Rlst2)=9 T(Rmu/Rlist)=1.554e-03,9.143e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.541e-03 S size(rtasks)=237 size(Rlst)=529 -----
rank=0 GPUmem(GB): used=6.762e-05 avail=6.176e+00 total=6.176e+00 batch[need]=5.124e-05 blksize=4 blksize0=4 batchsize=529
rank=0 GPUmem(GB): used=1.189e-04 (oper,site,rinter,batch)=2.794e-05,1.192e-07,3.956e-05,5.124e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.887e-03,2.225e-02,1.008e-02
----- TIMING FOR renorm : t_inter=5.9e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=6 t=5.9e-03 per=1.5e+01 cost=2.5e+04 flops=4.3e+06
 renorm[gemm] counter=6 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=2 t=7.4e-03 per=1.9e+01 cost=1.4e+03 flops=1.8e+05
 renorm[gemm] counter=6 i=3 t=7.4e-03 per=1.9e+01 cost=3.5e+03 flops=4.8e+05
 renorm[gemm] counter=6 i=4 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=5 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=6 t=7.5e-03 per=2.0e+01 cost=6.4e+03 flops=8.5e+05
 renorm[gemm] counter=6 total t=2.2e-02 per=5.8e+01 cost=1.1e+04 flops=5.1e+05
 renorm[red] counter=6 t=1.0e-02 per=2.6e+01 cost=4.2e+03 flops=4.2e+05
----- TIMING FOR renorm_tot : t_inter=3.3e-02 t_gemm=1.2e-01 t_reduction=5.3e-02 tot=2.1e-01 -----
 renorm_tot[inter] counter=6 t=3.3e-02 per=1.6e+01 cost=5.0e+04 flops=1.5e+06
 renorm_tot[gemm] counter=6 i=0 t=1.0e-05 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=1 t=7.2e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=2 t=4.5e-02 per=2.2e+01 cost=3.1e+03 flops=6.9e+04
 renorm_tot[gemm] counter=6 i=3 t=3.9e-02 per=1.9e+01 cost=6.9e+03 flops=1.8e+05
 renorm_tot[gemm] counter=6 i=4 t=7.1e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=5 t=7.1e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=6 t=3.9e-02 per=1.9e+01 cost=1.2e+04 flops=3.1e+05
 renorm_tot[gemm] counter=6 total t=1.2e-01 per=5.9e+01 cost=2.2e+04 flops=1.8e+05
 renorm_tot[red] counter=6 t=5.3e-02 per=2.5e+01 cost=7.9e+03 flops=1.5e+05
qops.to_cpu: size(tot)=1040:7.9e-03MB:7.7e-06GB T(to_cpu)=3.2e-04S speed=2.4e-02GB/S
check ||H-H.dagger||=1.570e-16 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.0592 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=6.034e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=6.180e-04 change=-1.563e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 7.252e-02 S #####
 T(local oper_env: fetch) = 9.948e-03 S  per = 13.7  per(accum) = 13.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 13.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 13.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 13.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 13.7
 T(local oper_env: renrm) = 6.225e-02 S  per = 85.8  per(accum) = 99.6
 T(local oper_env: save ) = 3.221e-04 S  per = 0.444  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.225e-02 S  T(sum) = 6.225e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.785e-06 S  per = 0.0141  per(accum) = 0.0141
 T(local oper_env: qops init                    ) = 1.273e-03 S  per = 2.05  per(accum) = 2.06
 T(local oper_env: symbolic_formulae_renorm     ) = 8.896e-03 S  per = 14.3  per(accum) = 16.4
 T(local oper_env: allocate qops on gpu         ) = 7.165e-05 S  per = 0.115  per(accum) = 16.5
 T(local oper_env: site memcpy cpu2gpu          ) = 1.674e-03 S  per = 2.69  per(accum) = 19.2
 T(local oper_env: rintermediate init           ) = 2.499e-03 S  per = 4.01  per(accum) = 23.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.562e-03 S  per = 4.12  per(accum) = 27.3
 T(local oper_env: rmmtasks init                ) = 3.466e-03 S  per = 5.57  per(accum) = 32.9
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 5.3e-05  per(accum) = 32.9
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.832e-02 S  per = 61.6  per(accum) = 94.4
 T(local oper_env: deallocate cpu and gpu memory) = 9.806e-05 S  per = 0.158  per(accum) = 94.6
 T(local oper_env: construct opS [ifdists=true] ) = 2.070e-07 S  per = 0.000333  per(accum) = 94.6
 T(local oper_env: reduction of opS & opH [nccl]) = 4.700e-08 S  per = 7.55e-05  per(accum) = 94.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.288e-04 S  per = 0.528  per(accum) = 95.1
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.199e-05 S  per = 0.0353  per(accum) = 95.1
 T(local oper_env: qops_pool join and erase     ) = 3.031e-03 S  per = 4.87  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 1.035e-06 S  per = 0.00166  per(accum) = 100
##### sweep oper_env: 3.773e-01 S #####
 T(sweep oper_env: fetch) = 7.347e-02 S  per = 19.5  per(accum) = 19.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 19.5
 T(sweep oper_env: renrm) = 3.025e-01 S  per = 80.2  per(accum) = 99.6
 T(sweep oper_env: save ) = 1.344e-03 S  per = 0.356  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.042e+10 S  per = -1.042e+32
 T(sweep oper_env: preprocess                  ) = -1.042e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.025e-01 S  T(sum) = 3.025e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 6.006e-05 S  per = 0.0199  per(accum) = 0.0199
 T(sweep oper_env: qops init                    ) = 4.547e-03 S  per =  1.5  per(accum) = 1.52
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.282e-02 S  per = 10.8  per(accum) = 12.4
 T(sweep oper_env: allocate qops on gpu         ) = 3.928e-04 S  per = 0.13  per(accum) = 12.5
 T(sweep oper_env: site memcpy cpu2gpu          ) = 9.919e-03 S  per = 3.28  per(accum) = 15.8
 T(sweep oper_env: rintermediate init           ) = 1.259e-02 S  per = 4.16  per(accum) = 19.9
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.177e-02 S  per = 3.89  per(accum) = 23.8
 T(sweep oper_env: rmmtasks init                ) = 9.543e-03 S  per = 3.15  per(accum) = 27
 T(sweep oper_env: qops memset on cpu           ) = 2.330e-07 S  per = 7.7e-05  per(accum) = 27
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.093e-01 S  per = 69.2  per(accum) = 96.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.752e-04 S  per = 0.091  per(accum) = 96.3
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.880e-07 S  per = 0.000128  per(accum) = 96.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.260e-07 S  per = 7.47e-05  per(accum) = 96.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.033e-03 S  per = 0.342  per(accum) = 96.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.118e-04 S  per = 0.037  per(accum) = 96.6
 T(sweep oper_env: qops_pool join and erase     ) = 1.014e-02 S  per = 3.35  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 4.623e-06 S  per = 0.00153  per(accum) = 100

idx=7 coord=(12,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=12:9.16e-05MB size(tot)=1040:0.00793MB:7.75e-06GB
        per(mem): H:1.15 C:5.38 S:10 A:0 B:83.5 
ctns::oper_renorm coord=(12,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=7,7 size(op)=17:0.00013MB size(tot)=1825:0.0139MB:1.36e-05GB
        per(mem): H:0.932 C:4.38 S:6.58 A:0 B:88.1 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.029e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=297 : 1.037e-02 S -----
rank=0 GPUmem(GB): used=3.875e-05 (oper)=3.875e-05
rank=0 GPUmem(GB): used=3.893e-05 (oper,site)=3.875e-05,1.788e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=247
 no. of coefficients=6538:4.988e-02MB:4.871e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.520e-03 S -----
rank=0 GPUmem(GB): used=8.764e-05 (oper,site,rinter)=3.875e-05,1.788e-07,4.871e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.784e-03 S size(rtasks)=297 size(Rlst2)=9 T(Rmu/Rlist)=1.691e-03,1.094e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.870e-03 S size(rtasks)=297 size(Rlst)=610 -----
rank=0 GPUmem(GB): used=8.764e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.045e-04 blksize=9 blksize0=4 batchsize=610
rank=0 GPUmem(GB): used=1.922e-04 (oper,site,rinter,batch)=3.875e-05,1.788e-07,4.871e-05,1.045e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.510e-03,2.223e-02,9.940e-03
----- TIMING FOR renorm : t_inter=5.5e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.8e-02 -----
 renorm[inter] counter=7 t=5.5e-03 per=1.5e+01 cost=3.9e+04 flops=7.0e+06
 renorm[gemm] counter=7 i=0 t=1.5e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=2 t=7.4e-03 per=2.0e+01 cost=2.4e+03 flops=3.3e+05
 renorm[gemm] counter=7 i=3 t=7.4e-03 per=2.0e+01 cost=8.1e+03 flops=1.1e+06
 renorm[gemm] counter=7 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=5 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=6 t=7.4e-03 per=2.0e+01 cost=1.4e+04 flops=1.9e+06
 renorm[gemm] counter=7 total t=2.2e-02 per=5.9e+01 cost=2.5e+04 flops=1.1e+06
 renorm[red] counter=7 t=9.9e-03 per=2.6e+01 cost=7.0e+03 flops=7.1e+05
----- TIMING FOR renorm_tot : t_inter=3.9e-02 t_gemm=1.4e-01 t_reduction=6.3e-02 tot=2.5e-01 -----
 renorm_tot[inter] counter=7 t=3.9e-02 per=1.6e+01 cost=8.8e+04 flops=2.3e+06
 renorm_tot[gemm] counter=7 i=0 t=1.2e-05 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=1 t=8.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=2 t=5.2e-02 per=2.1e+01 cost=5.5e+03 flops=1.1e+05
 renorm_tot[gemm] counter=7 i=3 t=4.6e-02 per=1.9e+01 cost=1.5e+04 flops=3.3e+05
 renorm_tot[gemm] counter=7 i=4 t=8.2e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=5 t=8.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=6 t=4.6e-02 per=1.9e+01 cost=2.6e+04 flops=5.6e+05
 renorm_tot[gemm] counter=7 total t=1.4e-01 per=5.9e+01 cost=4.6e+04 flops=3.2e+05
 renorm_tot[red] counter=7 t=6.3e-02 per=2.5e+01 cost=1.5e+04 flops=2.4e+05
qops.to_cpu: size(tot)=1825:1.4e-02MB:1.4e-05GB T(to_cpu)=2.9e-04S speed=4.6e-02GB/S
check ||H-H.dagger||=6.280e-16 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.0603 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=7.468e-04 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.297e-04 change=-1.732e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 7.267e-02 S #####
 T(local oper_env: fetch) = 1.061e-02 S  per = 14.6  per(accum) = 14.6
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.6
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.6
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.6
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.6
 T(local oper_env: renrm) = 6.182e-02 S  per = 85.1  per(accum) = 99.7
 T(local oper_env: save ) = 2.345e-04 S  per = 0.323  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.182e-02 S  T(sum) = 6.182e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.060e-05 S  per = 0.0172  per(accum) = 0.0172
 T(local oper_env: qops init                    ) = 1.716e-03 S  per = 2.78  per(accum) = 2.79
 T(local oper_env: symbolic_formulae_renorm     ) = 1.039e-02 S  per = 16.8  per(accum) = 19.6
 T(local oper_env: allocate qops on gpu         ) = 5.935e-05 S  per = 0.096  per(accum) = 19.7
 T(local oper_env: site memcpy cpu2gpu          ) = 9.272e-04 S  per =  1.5  per(accum) = 21.2
 T(local oper_env: rintermediate init           ) = 2.534e-03 S  per =  4.1  per(accum) = 25.3
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.893e-03 S  per = 4.68  per(accum) = 30
 T(local oper_env: rmmtasks init                ) = 3.655e-03 S  per = 5.91  per(accum) = 35.9
 T(local oper_env: qops memset on cpu           ) = 1.000e-07 S  per = 0.000162  per(accum) = 35.9
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.777e-02 S  per = 61.1  per(accum) = 97
 T(local oper_env: deallocate cpu and gpu memory) = 6.289e-05 S  per = 0.102  per(accum) = 97.1
 T(local oper_env: construct opS [ifdists=true] ) = 3.700e-08 S  per = 5.99e-05  per(accum) = 97.1
 T(local oper_env: reduction of opS & opH [nccl]) = 3.000e-08 S  per = 4.85e-05  per(accum) = 97.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.998e-04 S  per = 0.485  per(accum) = 97.6
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.752e-05 S  per = 0.0283  per(accum) = 97.6
 T(local oper_env: qops_pool join and erase     ) = 1.478e-03 S  per = 2.39  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.220e-07 S  per = 0.00101  per(accum) = 100
##### sweep oper_env: 4.500e-01 S #####
 T(sweep oper_env: fetch) = 8.409e-02 S  per = 18.7  per(accum) = 18.7
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 18.7
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 18.7
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 18.7
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 18.7
 T(sweep oper_env: renrm) = 3.643e-01 S  per =   81  per(accum) = 99.6
 T(sweep oper_env: save ) = 1.579e-03 S  per = 0.351  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.216e+10 S  per = -1.216e+32
 T(sweep oper_env: preprocess                  ) = -1.216e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.643e-01 S  T(sum) = 3.643e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 7.066e-05 S  per = 0.0194  per(accum) = 0.0194
 T(sweep oper_env: qops init                    ) = 6.263e-03 S  per = 1.72  per(accum) = 1.74
 T(sweep oper_env: symbolic_formulae_renorm     ) = 4.321e-02 S  per = 11.9  per(accum) = 13.6
 T(sweep oper_env: allocate qops on gpu         ) = 4.522e-04 S  per = 0.124  per(accum) = 13.7
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.085e-02 S  per = 2.98  per(accum) = 16.7
 T(sweep oper_env: rintermediate init           ) = 1.512e-02 S  per = 4.15  per(accum) = 20.8
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.466e-02 S  per = 4.02  per(accum) = 24.9
 T(sweep oper_env: rmmtasks init                ) = 1.320e-02 S  per = 3.62  per(accum) = 28.5
 T(sweep oper_env: qops memset on cpu           ) = 3.330e-07 S  per = 9.14e-05  per(accum) = 28.5
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.471e-01 S  per = 67.8  per(accum) = 96.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 3.381e-04 S  per = 0.0928  per(accum) = 96.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.250e-07 S  per = 0.000117  per(accum) = 96.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.560e-07 S  per = 7.03e-05  per(accum) = 96.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.333e-03 S  per = 0.366  per(accum) = 96.8
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.293e-04 S  per = 0.0355  per(accum) = 96.8
 T(sweep oper_env: qops_pool join and erase     ) = 1.162e-02 S  per = 3.19  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.245e-06 S  per = 0.00144  per(accum) = 100

idx=8 coord=(11,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=7,7 size(op)=17:0.00013MB size(tot)=1825:0.0139MB:1.36e-05GB
        per(mem): H:0.932 C:4.38 S:6.58 A:0 B:88.1 
ctns::oper_renorm coord=(11,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=2679:0.0204MB:2e-05GB
        per(mem): H:0.784 C:2.02 S:2.46 A:0 B:94.7 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.064e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=365 : 1.155e-02 S -----
rank=0 GPUmem(GB): used=5.096e-05 (oper)=5.096e-05
rank=0 GPUmem(GB): used=5.119e-05 (oper,site)=5.096e-05,2.235e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=227
 no. of coefficients=7720:5.890e-02MB:5.752e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.545e-03 S -----
rank=0 GPUmem(GB): used=1.087e-04 (oper,site,rinter)=5.096e-05,2.235e-07,5.752e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.891e-03 S size(rtasks)=365 size(Rlst2)=9 T(Rmu/Rlist)=1.741e-03,1.150e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.989e-03 S size(rtasks)=365 size(Rlst)=703 -----
rank=0 GPUmem(GB): used=1.087e-04 avail=6.176e+00 total=6.176e+00 batch[need]=2.200e-04 blksize=16 blksize0=9 batchsize=703
rank=0 GPUmem(GB): used=3.287e-04 (oper,site,rinter,batch)=5.096e-05,2.235e-07,5.752e-05,2.200e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.870e-03,2.272e-02,9.901e-03
----- TIMING FOR renorm : t_inter=6.9e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=8 t=6.9e-03 per=1.7e+01 cost=5.3e+04 flops=7.7e+06
 renorm[gemm] counter=8 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=2 t=7.5e-03 per=1.9e+01 cost=2.8e+03 flops=3.7e+05
 renorm[gemm] counter=8 i=3 t=7.6e-03 per=1.9e+01 cost=1.5e+04 flops=1.9e+06
 renorm[gemm] counter=8 i=4 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=5 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=6 t=7.6e-03 per=1.9e+01 cost=2.4e+04 flops=3.2e+06
 renorm[gemm] counter=8 total t=2.3e-02 per=5.8e+01 cost=4.2e+04 flops=1.8e+06
 renorm[red] counter=8 t=9.9e-03 per=2.5e+01 cost=1.0e+04 flops=1.0e+06
----- TIMING FOR renorm_tot : t_inter=4.6e-02 t_gemm=1.7e-01 t_reduction=7.3e-02 tot=2.9e-01 -----
 renorm_tot[inter] counter=8 t=4.6e-02 per=1.6e+01 cost=1.4e+05 flops=3.1e+06
 renorm_tot[gemm] counter=8 i=0 t=1.3e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=1 t=9.5e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=2 t=6.0e-02 per=2.1e+01 cost=8.3e+03 flops=1.4e+05
 renorm_tot[gemm] counter=8 i=3 t=5.4e-02 per=1.9e+01 cost=3.0e+04 flops=5.5e+05
 renorm_tot[gemm] counter=8 i=4 t=9.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=5 t=9.5e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=6 t=5.4e-02 per=1.9e+01 cost=5.0e+04 flops=9.3e+05
 renorm_tot[gemm] counter=8 total t=1.7e-01 per=5.9e+01 cost=8.8e+04 flops=5.3e+05
 renorm_tot[red] counter=8 t=7.3e-02 per=2.5e+01 cost=2.5e+04 flops=3.5e+05
qops.to_cpu: size(tot)=2679:2.0e-02MB:2.0e-05GB T(to_cpu)=3.7e-04S speed=5.5e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.0639 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.278e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=3.357e-04 change=-1.835e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 7.517e-02 S #####
 T(local oper_env: fetch) = 9.575e-03 S  per = 12.7  per(accum) = 12.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 12.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 12.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 12.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 12.7
 T(local oper_env: renrm) = 6.535e-02 S  per = 86.9  per(accum) = 99.7
 T(local oper_env: save ) = 2.389e-04 S  per = 0.318  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.535e-02 S  T(sum) = 6.535e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.263e-06 S  per = 0.0142  per(accum) = 0.0142
 T(local oper_env: qops init                    ) = 1.952e-03 S  per = 2.99  per(accum) = 3
 T(local oper_env: symbolic_formulae_renorm     ) = 1.157e-02 S  per = 17.7  per(accum) = 20.7
 T(local oper_env: allocate qops on gpu         ) = 5.071e-05 S  per = 0.0776  per(accum) = 20.8
 T(local oper_env: site memcpy cpu2gpu          ) = 3.169e-04 S  per = 0.485  per(accum) = 21.3
 T(local oper_env: rintermediate init           ) = 2.558e-03 S  per = 3.91  per(accum) = 25.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.015e-03 S  per = 4.61  per(accum) = 29.8
 T(local oper_env: rmmtasks init                ) = 4.388e-03 S  per = 6.71  per(accum) = 36.5
 T(local oper_env: qops memset on cpu           ) = 3.000e-08 S  per = 4.59e-05  per(accum) = 36.5
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.959e-02 S  per = 60.6  per(accum) = 97.1
 T(local oper_env: deallocate cpu and gpu memory) = 8.119e-05 S  per = 0.124  per(accum) = 97.2
 T(local oper_env: construct opS [ifdists=true] ) = 3.600e-08 S  per = 5.51e-05  per(accum) = 97.2
 T(local oper_env: reduction of opS & opH [nccl]) = 3.000e-08 S  per = 4.59e-05  per(accum) = 97.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.733e-04 S  per = 0.571  per(accum) = 97.8
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.130e-05 S  per = 0.0326  per(accum) = 97.8
 T(local oper_env: qops_pool join and erase     ) = 1.432e-03 S  per = 2.19  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.560e-07 S  per = 0.001  per(accum) = 100
##### sweep oper_env: 5.252e-01 S #####
 T(sweep oper_env: fetch) = 9.366e-02 S  per = 17.8  per(accum) = 17.8
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17.8
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17.8
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17.8
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17.8
 T(sweep oper_env: renrm) = 4.297e-01 S  per = 81.8  per(accum) = 99.7
 T(sweep oper_env: save ) = 1.818e-03 S  per = 0.346  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.389e+10 S  per = -1.389e+32
 T(sweep oper_env: preprocess                  ) = -1.389e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.297e-01 S  T(sum) = 4.297e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 7.993e-05 S  per = 0.0186  per(accum) = 0.0186
 T(sweep oper_env: qops init                    ) = 8.215e-03 S  per = 1.91  per(accum) = 1.93
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.477e-02 S  per = 12.7  per(accum) = 14.7
 T(sweep oper_env: allocate qops on gpu         ) = 5.029e-04 S  per = 0.117  per(accum) = 14.8
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.116e-02 S  per =  2.6  per(accum) = 17.4
 T(sweep oper_env: rintermediate init           ) = 1.768e-02 S  per = 4.12  per(accum) = 21.5
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.767e-02 S  per = 4.11  per(accum) = 25.6
 T(sweep oper_env: rmmtasks init                ) = 1.759e-02 S  per = 4.09  per(accum) = 29.7
 T(sweep oper_env: qops memset on cpu           ) = 3.630e-07 S  per = 8.45e-05  per(accum) = 29.7
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.867e-01 S  per = 66.7  per(accum) = 96.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.193e-04 S  per = 0.0976  per(accum) = 96.5
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.610e-07 S  per = 0.000107  per(accum) = 96.5
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.860e-07 S  per = 6.66e-05  per(accum) = 96.5
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.706e-03 S  per = 0.397  per(accum) = 96.9
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.506e-04 S  per = 0.0351  per(accum) = 97
 T(sweep oper_env: qops_pool join and erase     ) = 1.305e-02 S  per = 3.04  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.901e-06 S  per = 0.00137  per(accum) = 100

idx=9 coord=(10,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=2679:0.0204MB:2e-05GB
        per(mem): H:0.784 C:2.02 S:2.46 A:0 B:94.7 
ctns::oper_renorm coord=(10,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:20 S:20 A:190 B:210 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=3251:0.0248MB:2.42e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 A:0 B:95.7 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.103e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=441 : 1.289e-02 S -----
rank=0 GPUmem(GB): used=6.159e-05 (oper)=6.159e-05
rank=0 GPUmem(GB): used=6.185e-05 (oper,site)=6.159e-05,2.608e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=441
 no. of rintermediate operators=207
 no. of coefficients=8802:6.715e-02MB:6.558e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.576e-03 S -----
rank=0 GPUmem(GB): used=1.274e-04 (oper,site,rinter)=6.159e-05,2.608e-07,6.558e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.197e-03 S size(rtasks)=441 size(Rlst2)=9 T(Rmu/Rlist)=1.804e-03,1.393e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.314e-03 S size(rtasks)=441 size(Rlst)=965 -----
rank=0 GPUmem(GB): used=1.274e-04 avail=6.176e+00 total=6.176e+00 batch[need]=3.523e-04 blksize=16 blksize0=16 batchsize=965
rank=0 GPUmem(GB): used=4.797e-04 (oper,site,rinter,batch)=6.159e-05,2.608e-07,6.558e-05,3.523e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.365e-03,2.261e-02,9.972e-03
----- TIMING FOR renorm : t_inter=7.4e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=9 t=7.4e-03 per=1.8e+01 cost=1.9e+05 flops=2.5e+07
 renorm[gemm] counter=9 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=1 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=2 t=7.6e-03 per=1.9e+01 cost=2.6e+03 flops=3.5e+05
 renorm[gemm] counter=9 i=3 t=7.5e-03 per=1.9e+01 cost=2.8e+04 flops=3.8e+06
 renorm[gemm] counter=9 i=4 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=5 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=6 t=7.5e-03 per=1.9e+01 cost=2.8e+04 flops=3.7e+06
 renorm[gemm] counter=9 total t=2.3e-02 per=5.7e+01 cost=5.9e+04 flops=2.6e+06
 renorm[red] counter=9 t=1.0e-02 per=2.5e+01 cost=8.9e+03 flops=8.9e+05
----- TIMING FOR renorm_tot : t_inter=5.3e-02 t_gemm=1.9e-01 t_reduction=8.3e-02 tot=3.3e-01 -----
 renorm_tot[inter] counter=9 t=5.3e-02 per=1.6e+01 cost=3.3e+05 flops=6.2e+06
 renorm_tot[gemm] counter=9 i=0 t=1.4e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=1 t=1.1e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=2 t=6.8e-02 per=2.1e+01 cost=1.1e+04 flops=1.6e+05
 renorm_tot[gemm] counter=9 i=3 t=6.1e-02 per=1.9e+01 cost=5.8e+04 flops=9.5e+05
 renorm_tot[gemm] counter=9 i=4 t=1.0e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=5 t=1.1e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=6 t=6.1e-02 per=1.9e+01 cost=7.8e+04 flops=1.3e+06
 renorm_tot[gemm] counter=9 total t=1.9e-01 per=5.8e+01 cost=1.5e+05 flops=7.8e+05
 renorm_tot[red] counter=9 t=8.3e-02 per=2.5e+01 cost=3.4e+04 flops=4.1e+05
----- TIMING FOR oper_renorm : 6.7e-02 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.927e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.221e-03 change=-2.057e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::oper_ab2pq coord=(10,0) superblock=cr alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3251:2.480e-02MB:2.422e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.221e-03 change=2.278e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.221e-03 change=7.600e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=4.844e-05 avail=6.176e+00 after qops2.allocate_gpu
ctns::oper_a2p ifab=1 ifkr=0 maxsize=0:0.000e+00GB
ctns::oper_b2q ifab=1 ifkr=0 maxsize=3110:2.317e-05GB
iproc=0
 qops_tmp: oplist=B nops=B:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3110:2.373e-02MB:2.317e-05GB
        per(mem): B:100 
   init qops_tmp: dt=0.00095 tinit=0.00095
   copy opB to qops_tmps: dt=0.00235 tcopy=0.00235
   bcast: size(opB)=3110:2.32e-05GB dt=4.2e-08 speed=552GB/s tcomm=4.2e-08
   compute opQ from opB: dt=0.00756 tcomp=0.00756
iproc=0
 qops_tmp: oplist=N nops=N:210 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=3110:0.0237MB:2.32e-05GB
        per(mem): N:100 
   init qops_tmp: dt=0.000923 tinit=0.00187
   from opB to opB.H(): dt=0.00659 tadjt=0.00659
   bcast: size(opN)=3110:2.32e-05GB dt=4.7e-08 speed=493GB/s tcomm=8.9e-08
   compute opQ from opB.H(): dt=0.00752 tcomp=0.0151
----- TIMING FOR oper_b2qGPU : 0.0263 S T(init/copy/adjt+bcast/comp/rest)=0.00187,0.00235,0.00659,0.0151,0.000371 -----
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.106e-03 change=2.071e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=4.844e-05 avail=6.176e+00 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.106e-03 change=2.480e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=4.844e-05 avail=6.176e+00 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.106e-03 change=-5.960e-08 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before move
rank=0 GPUmem(GB): used=4.844e-05 avail=6.176e+00 before move
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.106e-03 change=-2.289e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after move
rank=0 GPUmem(GB): used=2.422e-05 avail=6.176e+00 after move
check ||H-H.dagger||=0.000e+00 coord=(10,0) rank=0
----- TIMING FOR oper_ab2pq : 0.0295 S T(init/copyHCS/opP/opQ/to_gpu/to_cpu/move)=0.00221,5.17e-05,7.02e-06,0.0263,0,0.000611,0.000319 -----
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.106e-03 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
##### local oper_env: 1.080e-01 S #####
 T(local oper_env: fetch) = 9.633e-03 S  per = 8.92  per(accum) = 8.92
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.92
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.92
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.92
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.92
 T(local oper_env: renrm) = 9.806e-02 S  per = 90.8  per(accum) = 99.8
 T(local oper_env: save ) = 2.691e-04 S  per = 0.249  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.806e-02 S  T(sum) = 9.806e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.237e-06 S  per = 0.00942  per(accum) = 0.00942
 T(local oper_env: qops init                    ) = 2.216e-03 S  per = 2.26  per(accum) = 2.27
 T(local oper_env: symbolic_formulae_renorm     ) = 1.290e-02 S  per = 13.2  per(accum) = 15.4
 T(local oper_env: allocate qops on gpu         ) = 5.967e-05 S  per = 0.0609  per(accum) = 15.5
 T(local oper_env: site memcpy cpu2gpu          ) = 6.545e-04 S  per = 0.667  per(accum) = 16.2
 T(local oper_env: rintermediate init           ) = 2.590e-03 S  per = 2.64  per(accum) = 18.8
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.347e-03 S  per = 3.41  per(accum) = 22.2
 T(local oper_env: rmmtasks init                ) = 5.313e-03 S  per = 5.42  per(accum) = 27.6
 T(local oper_env: qops memset on cpu           ) = 3.100e-08 S  per = 3.16e-05  per(accum) = 27.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.004e-02 S  per = 40.8  per(accum) = 68.5
 T(local oper_env: deallocate cpu and gpu memory) = 5.975e-05 S  per = 0.0609  per(accum) = 68.5
 T(local oper_env: construct opS [ifdists=true] ) = 3.700e-08 S  per = 3.77e-05  per(accum) = 68.5
 T(local oper_env: reduction of opS & opH [nccl]) = 2.900e-08 S  per = 2.96e-05  per(accum) = 68.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.000e-08 S  per = 3.06e-05  per(accum) = 68.5
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.210e-07 S  per = 0.000123  per(accum) = 68.5
 T(local oper_env: qops_pool join and erase     ) = 1.291e-03 S  per = 1.32  per(accum) = 69.8
 T(local oper_env: conversion from opAB to opPQ ) = 2.958e-02 S  per = 30.2  per(accum) = 100
##### sweep oper_env: 6.331e-01 S #####
 T(sweep oper_env: fetch) = 1.033e-01 S  per = 16.3  per(accum) = 16.3
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.3
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.3
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.3
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.3
 T(sweep oper_env: renrm) = 5.278e-01 S  per = 83.4  per(accum) = 99.7
 T(sweep oper_env: save ) = 2.087e-03 S  per = 0.33  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.563e+10 S  per = -1.563e+32
 T(sweep oper_env: preprocess                  ) = -1.563e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.278e-01 S  T(sum) = 5.278e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 8.916e-05 S  per = 0.0169  per(accum) = 0.0169
 T(sweep oper_env: qops init                    ) = 1.043e-02 S  per = 1.98  per(accum) = 1.99
 T(sweep oper_env: symbolic_formulae_renorm     ) = 6.767e-02 S  per = 12.8  per(accum) = 14.8
 T(sweep oper_env: allocate qops on gpu         ) = 5.626e-04 S  per = 0.107  per(accum) = 14.9
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.182e-02 S  per = 2.24  per(accum) = 17.2
 T(sweep oper_env: rintermediate init           ) = 2.027e-02 S  per = 3.84  per(accum) = 21
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.102e-02 S  per = 3.98  per(accum) = 25
 T(sweep oper_env: rmmtasks init                ) = 2.290e-02 S  per = 4.34  per(accum) = 29.3
 T(sweep oper_env: qops memset on cpu           ) = 3.940e-07 S  per = 7.47e-05  per(accum) = 29.3
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.267e-01 S  per = 61.9  per(accum) = 91.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.791e-04 S  per = 0.0908  per(accum) = 91.3
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.980e-07 S  per = 9.44e-05  per(accum) = 91.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.150e-07 S  per = 5.97e-05  per(accum) = 91.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.706e-03 S  per = 0.323  per(accum) = 91.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.507e-04 S  per = 0.0286  per(accum) = 91.7
 T(sweep oper_env: qops_pool join and erase     ) = 1.434e-02 S  per = 2.72  per(accum) = 94.4
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.959e-02 S  per = 5.61  per(accum) = 100

idx=10 coord=(9,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=3251:0.0248MB:2.42e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
ctns::oper_renorm coord=(9,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1860:0.0142MB:1.39e-05GB
        per(mem): H:0.753 C:2.96 S:2.42 P:0 Q:93.9 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.064e-03 heap=1.068e+00 avail=4.775e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=365 : 2.484e-02 S -----
rank=0 GPUmem(GB): used=5.548e-05 (oper)=5.548e-05
rank=0 GPUmem(GB): used=5.572e-05 (oper,site)=5.548e-05,2.310e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=828
 no. of coefficients=8280:6.317e-02MB:6.169e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.498e-03 S -----
rank=0 GPUmem(GB): used=1.174e-04 (oper,site,rinter)=5.548e-05,2.310e-07,6.169e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 7.555e-03 S size(rtasks)=365 size(Rlst2)=9 T(Rmu/Rlist)=4.557e-03,2.998e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 7.763e-03 S size(rtasks)=365 size(Rlst)=2015 -----
rank=0 GPUmem(GB): used=1.174e-04 avail=6.176e+00 total=6.176e+00 batch[need]=4.354e-04 blksize=12 blksize0=4 batchsize=2015
rank=0 GPUmem(GB): used=5.528e-04 (oper,site,rinter,batch)=5.548e-05,2.310e-07,6.169e-05,4.354e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.089e-03,2.290e-02,1.012e-02
----- TIMING FOR renorm : t_inter=6.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=10 t=6.1e-03 per=1.6e+01 cost=4.5e+04 flops=7.4e+06
 renorm[gemm] counter=10 i=0 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=2 t=7.7e-03 per=2.0e+01 cost=4.8e+03 flops=6.3e+05
 renorm[gemm] counter=10 i=3 t=7.6e-03 per=1.9e+01 cost=2.8e+04 flops=3.7e+06
 renorm[gemm] counter=10 i=4 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=5 t=1.0e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=6 t=7.6e-03 per=1.9e+01 cost=4.3e+04 flops=5.7e+06
 renorm[gemm] counter=10 total t=2.3e-02 per=5.9e+01 cost=7.6e+04 flops=3.3e+06
 renorm[red] counter=10 t=1.0e-02 per=2.6e+01 cost=1.5e+04 flops=1.5e+06
----- TIMING FOR renorm_tot : t_inter=5.9e-02 t_gemm=2.1e-01 t_reduction=9.3e-02 tot=3.6e-01 -----
 renorm_tot[inter] counter=10 t=5.9e-02 per=1.6e+01 cost=3.7e+05 flops=6.3e+06
 renorm_tot[gemm] counter=10 i=0 t=1.5e-05 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=1 t=1.2e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=2 t=7.5e-02 per=2.1e+01 cost=1.6e+04 flops=2.1e+05
 renorm_tot[gemm] counter=10 i=3 t=6.9e-02 per=1.9e+01 cost=8.6e+04 flops=1.3e+06
 renorm_tot[gemm] counter=10 i=4 t=1.1e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=5 t=1.2e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=6 t=6.9e-02 per=1.9e+01 cost=1.2e+05 flops=1.8e+06
 renorm_tot[gemm] counter=10 total t=2.1e-01 per=5.8e+01 cost=2.2e+05 flops=1.0e+06
 renorm_tot[red] counter=10 t=9.3e-02 per=2.5e+01 cost=4.9e+04 flops=5.3e+05
qops.to_cpu: size(tot)=1860:1.4e-02MB:1.4e-05GB T(to_cpu)=3.5e-04S speed=3.9e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.0897 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.387e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.541e-03 change=-2.481e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 1.009e-01 S #####
 T(local oper_env: fetch) = 9.462e-03 S  per = 9.38  per(accum) = 9.38
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 9.38
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 9.38
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 9.38
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 9.38
 T(local oper_env: renrm) = 9.124e-02 S  per = 90.4  per(accum) = 99.8
 T(local oper_env: save ) = 2.159e-04 S  per = 0.214  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.124e-02 S  T(sum) = 9.124e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.472e-06 S  per = 0.00929  per(accum) = 0.00929
 T(local oper_env: qops init                    ) = 1.812e-03 S  per = 1.99  per(accum) = 1.99
 T(local oper_env: symbolic_formulae_renorm     ) = 2.485e-02 S  per = 27.2  per(accum) = 29.2
 T(local oper_env: allocate qops on gpu         ) = 5.118e-05 S  per = 0.0561  per(accum) = 29.3
 T(local oper_env: site memcpy cpu2gpu          ) = 4.355e-04 S  per = 0.477  per(accum) = 29.8
 T(local oper_env: rintermediate init           ) = 2.516e-03 S  per = 2.76  per(accum) = 32.5
 T(local oper_env: preprocess_formulae_Rlist2   ) = 7.830e-03 S  per = 8.58  per(accum) = 41.1
 T(local oper_env: rmmtasks init                ) = 1.258e-02 S  per = 13.8  per(accum) = 54.9
 T(local oper_env: qops memset on cpu           ) = 3.100e-08 S  per = 3.4e-05  per(accum) = 54.9
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.920e-02 S  per =   43  per(accum) = 97.8
 T(local oper_env: deallocate cpu and gpu memory) = 8.281e-05 S  per = 0.0908  per(accum) = 97.9
 T(local oper_env: construct opS [ifdists=true] ) = 3.700e-08 S  per = 4.06e-05  per(accum) = 97.9
 T(local oper_env: reduction of opS & opH [nccl]) = 2.900e-08 S  per = 3.18e-05  per(accum) = 97.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.610e-04 S  per = 0.396  per(accum) = 98.3
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.661e-05 S  per = 0.0182  per(accum) = 98.4
 T(local oper_env: qops_pool join and erase     ) = 1.502e-03 S  per = 1.65  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.680e-07 S  per = 0.000732  per(accum) = 100
##### sweep oper_env: 7.341e-01 S #####
 T(sweep oper_env: fetch) = 1.128e-01 S  per = 15.4  per(accum) = 15.4
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15.4
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15.4
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15.4
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15.4
 T(sweep oper_env: renrm) = 6.190e-01 S  per = 84.3  per(accum) = 99.7
 T(sweep oper_env: save ) = 2.303e-03 S  per = 0.314  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+10 S  per = -1.737e+32
 T(sweep oper_env: preprocess                  ) = -1.737e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.190e-01 S  T(sum) = 6.190e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 9.763e-05 S  per = 0.0158  per(accum) = 0.0158
 T(sweep oper_env: qops init                    ) = 1.224e-02 S  per = 1.98  per(accum) = 1.99
 T(sweep oper_env: symbolic_formulae_renorm     ) = 9.253e-02 S  per = 14.9  per(accum) = 16.9
 T(sweep oper_env: allocate qops on gpu         ) = 6.138e-04 S  per = 0.0992  per(accum) = 17
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.225e-02 S  per = 1.98  per(accum) = 19
 T(sweep oper_env: rintermediate init           ) = 2.279e-02 S  per = 3.68  per(accum) = 22.7
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.885e-02 S  per = 4.66  per(accum) = 27.4
 T(sweep oper_env: rmmtasks init                ) = 3.547e-02 S  per = 5.73  per(accum) = 33.1
 T(sweep oper_env: qops memset on cpu           ) = 4.250e-07 S  per = 6.87e-05  per(accum) = 33.1
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.659e-01 S  per = 59.1  per(accum) = 92.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.619e-04 S  per = 0.0908  per(accum) = 92.3
 T(sweep oper_env: construct opS [ifdists=true] ) = 5.350e-07 S  per = 8.64e-05  per(accum) = 92.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.440e-07 S  per = 5.56e-05  per(accum) = 92.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.067e-03 S  per = 0.334  per(accum) = 92.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.673e-04 S  per = 0.027  per(accum) = 92.7
 T(sweep oper_env: qops_pool join and erase     ) = 1.584e-02 S  per = 2.56  per(accum) = 95.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.959e-02 S  per = 4.78  per(accum) = 100

idx=11 coord=(8,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1860:0.0142MB:1.39e-05GB
        per(mem): H:0.753 C:2.96 S:2.42 P:0 Q:93.9 
ctns::oper_renorm coord=(8,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1506:0.0115MB:1.12e-05GB
        per(mem): H:0.93 C:3.98 S:2.66 P:0 Q:92.4 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.029e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=297 : 2.037e-02 S -----
rank=0 GPUmem(GB): used=4.248e-05 (oper)=4.248e-05
rank=0 GPUmem(GB): used=4.262e-05 (oper,site)=4.248e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=664
 no. of coefficients=7304:5.573e-02MB:5.442e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.572e-03 S -----
rank=0 GPUmem(GB): used=9.704e-05 (oper,site,rinter)=4.248e-05,1.416e-07,5.442e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 5.631e-03 S size(rtasks)=297 size(Rlst2)=9 T(Rmu/Rlist)=3.503e-03,2.128e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.907e-03 S size(rtasks)=297 size(Rlst)=1452 -----
rank=0 GPUmem(GB): used=9.704e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.380e-04 blksize=9 blksize0=3 batchsize=1452
rank=0 GPUmem(GB): used=3.350e-04 (oper,site,rinter,batch)=4.248e-05,1.416e-07,5.442e-05,2.380e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=3.668e-03,2.277e-02,1.008e-02
----- TIMING FOR renorm : t_inter=3.7e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.7e-02 -----
 renorm[inter] counter=11 t=3.7e-03 per=1.0e+01 cost=2.5e+04 flops=6.7e+06
 renorm[gemm] counter=11 i=0 t=1.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=2 t=7.6e-03 per=2.1e+01 cost=3.3e+03 flops=4.4e+05
 renorm[gemm] counter=11 i=3 t=7.6e-03 per=2.1e+01 cost=1.2e+04 flops=1.5e+06
 renorm[gemm] counter=11 i=4 t=1.0e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=5 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=6 t=7.5e-03 per=2.1e+01 cost=2.9e+04 flops=3.9e+06
 renorm[gemm] counter=11 total t=2.3e-02 per=6.2e+01 cost=4.4e+04 flops=1.9e+06
 renorm[red] counter=11 t=1.0e-02 per=2.8e+01 cost=1.6e+04 flops=1.6e+06
----- TIMING FOR renorm_tot : t_inter=6.3e-02 t_gemm=2.4e-01 t_reduction=1.0e-01 tot=4.0e-01 -----
 renorm_tot[inter] counter=11 t=6.3e-02 per=1.6e+01 cost=4.0e+05 flops=6.3e+06
 renorm_tot[gemm] counter=11 i=0 t=1.7e-05 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=1 t=1.3e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=2 t=8.3e-02 per=2.1e+01 cost=1.9e+04 flops=2.3e+05
 renorm_tot[gemm] counter=11 i=3 t=7.7e-02 per=1.9e+01 cost=9.8e+04 flops=1.3e+06
 renorm_tot[gemm] counter=11 i=4 t=1.2e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=5 t=1.3e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=6 t=7.7e-02 per=1.9e+01 cost=1.5e+05 flops=2.0e+06
 renorm_tot[gemm] counter=11 total t=2.4e-01 per=5.9e+01 cost=2.7e+05 flops=1.1e+06
 renorm_tot[red] counter=11 t=1.0e-01 per=2.6e+01 cost=6.5e+04 flops=6.3e+05
qops.to_cpu: size(tot)=1506:1.1e-02MB:1.1e-05GB T(to_cpu)=2.9e-04S speed=3.9e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.0765 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.126e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.480e-03 change=-2.178e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 8.735e-02 S #####
 T(local oper_env: fetch) = 9.206e-03 S  per = 10.5  per(accum) = 10.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 10.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 10.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 10.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 10.5
 T(local oper_env: renrm) = 7.793e-02 S  per = 89.2  per(accum) = 99.8
 T(local oper_env: save ) = 2.114e-04 S  per = 0.242  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.793e-02 S  T(sum) = 7.793e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.367e-06 S  per = 0.0107  per(accum) = 0.0107
 T(local oper_env: qops init                    ) = 1.442e-03 S  per = 1.85  per(accum) = 1.86
 T(local oper_env: symbolic_formulae_renorm     ) = 2.038e-02 S  per = 26.2  per(accum) = 28
 T(local oper_env: allocate qops on gpu         ) = 4.978e-05 S  per = 0.0639  per(accum) = 28.1
 T(local oper_env: site memcpy cpu2gpu          ) = 5.521e-04 S  per = 0.708  per(accum) = 28.8
 T(local oper_env: rintermediate init           ) = 2.586e-03 S  per = 3.32  per(accum) = 32.1
 T(local oper_env: preprocess_formulae_Rlist2   ) = 5.955e-03 S  per = 7.64  per(accum) = 39.7
 T(local oper_env: rmmtasks init                ) = 8.522e-03 S  per = 10.9  per(accum) = 50.7
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 4.23e-05  per(accum) = 50.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.661e-02 S  per =   47  per(accum) = 97.7
 T(local oper_env: deallocate cpu and gpu memory) = 7.474e-05 S  per = 0.0959  per(accum) = 97.7
 T(local oper_env: construct opS [ifdists=true] ) = 3.700e-08 S  per = 4.75e-05  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [nccl]) = 2.800e-08 S  per = 3.59e-05  per(accum) = 97.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.939e-04 S  per = 0.377  per(accum) = 98.1
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.669e-05 S  per = 0.0214  per(accum) = 98.1
 T(local oper_env: qops_pool join and erase     ) = 1.445e-03 S  per = 1.85  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.810e-07 S  per = 0.000874  per(accum) = 100
##### sweep oper_env: 8.214e-01 S #####
 T(sweep oper_env: fetch) = 1.220e-01 S  per = 14.8  per(accum) = 14.8
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.8
 T(sweep oper_env: renrm) = 6.969e-01 S  per = 84.8  per(accum) = 99.7
 T(sweep oper_env: save ) = 2.514e-03 S  per = 0.306  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.910e+10 S  per = -1.910e+32
 T(sweep oper_env: preprocess                  ) = -1.910e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.969e-01 S  T(sum) = 6.969e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.060e-04 S  per = 0.0152  per(accum) = 0.0152
 T(sweep oper_env: qops init                    ) = 1.369e-02 S  per = 1.96  per(accum) = 1.98
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.129e-01 S  per = 16.2  per(accum) = 18.2
 T(sweep oper_env: allocate qops on gpu         ) = 6.635e-04 S  per = 0.0952  per(accum) = 18.3
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.281e-02 S  per = 1.84  per(accum) = 20.1
 T(sweep oper_env: rintermediate init           ) = 2.538e-02 S  per = 3.64  per(accum) = 23.8
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.481e-02 S  per = 4.99  per(accum) = 28.7
 T(sweep oper_env: rmmtasks init                ) = 4.400e-02 S  per = 6.31  per(accum) = 35.1
 T(sweep oper_env: qops memset on cpu           ) = 4.580e-07 S  per = 6.57e-05  per(accum) = 35.1
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.025e-01 S  per = 57.8  per(accum) = 92.8
 T(sweep oper_env: deallocate cpu and gpu memory) = 6.366e-04 S  per = 0.0913  per(accum) = 92.9
 T(sweep oper_env: construct opS [ifdists=true] ) = 5.720e-07 S  per = 8.21e-05  per(accum) = 92.9
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.720e-07 S  per = 5.34e-05  per(accum) = 92.9
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.361e-03 S  per = 0.339  per(accum) = 93.2
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.840e-04 S  per = 0.0264  per(accum) = 93.3
 T(sweep oper_env: qops_pool join and erase     ) = 1.729e-02 S  per = 2.48  per(accum) = 95.8
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.959e-02 S  per = 4.25  per(accum) = 100

idx=12 coord=(7,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1506:0.0115MB:1.12e-05GB
        per(mem): H:0.93 C:3.98 S:2.66 P:0 Q:92.4 
ctns::oper_renorm coord=(7,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1192:0.00909MB:8.88e-06GB
        per(mem): H:1.17 C:5.45 S:2.94 P:0 Q:90.4 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.983e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=237 : 1.711e-02 S -----
rank=0 GPUmem(GB): used=3.751e-05 (oper)=3.751e-05
rank=0 GPUmem(GB): used=3.765e-05 (oper,site)=3.751e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=518
 no. of coefficients=6216:4.742e-02MB:4.631e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.514e-03 S -----
rank=0 GPUmem(GB): used=8.396e-05 (oper,site,rinter)=3.751e-05,1.416e-07,4.631e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 4.847e-03 S size(rtasks)=237 size(Rlst2)=9 T(Rmu/Rlist)=3.002e-03,1.844e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.091e-03 S size(rtasks)=237 size(Rlst)=1164 -----
rank=0 GPUmem(GB): used=8.396e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.908e-04 blksize=9 blksize0=3 batchsize=1164
rank=0 GPUmem(GB): used=2.748e-04 (oper,site,rinter,batch)=3.751e-05,1.416e-07,4.631e-05,1.908e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.471e-03,2.217e-02,9.876e-03
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=12 t=6.5e-03 per=1.7e+01 cost=2.1e+04 flops=3.2e+06
 renorm[gemm] counter=12 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=2 t=7.4e-03 per=1.9e+01 cost=2.8e+03 flops=3.7e+05
 renorm[gemm] counter=12 i=3 t=7.4e-03 per=1.9e+01 cost=9.2e+03 flops=1.2e+06
 renorm[gemm] counter=12 i=4 t=1.0e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=5 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=6 t=7.4e-03 per=1.9e+01 cost=2.3e+04 flops=3.1e+06
 renorm[gemm] counter=12 total t=2.2e-02 per=5.8e+01 cost=3.5e+04 flops=1.6e+06
 renorm[red] counter=12 t=9.9e-03 per=2.6e+01 cost=1.3e+04 flops=1.3e+06
----- TIMING FOR renorm_tot : t_inter=6.9e-02 t_gemm=2.6e-01 t_reduction=1.1e-01 tot=4.4e-01 -----
 renorm_tot[inter] counter=12 t=6.9e-02 per=1.6e+01 cost=4.2e+05 flops=6.0e+06
 renorm_tot[gemm] counter=12 i=0 t=1.8e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=1 t=1.4e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=2 t=9.0e-02 per=2.1e+01 cost=2.2e+04 flops=2.4e+05
 renorm_tot[gemm] counter=12 i=3 t=8.4e-02 per=1.9e+01 cost=1.1e+05 flops=1.3e+06
 renorm_tot[gemm] counter=12 i=4 t=1.4e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=5 t=1.4e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=6 t=8.4e-02 per=1.9e+01 cost=1.7e+05 flops=2.1e+06
 renorm_tot[gemm] counter=12 total t=2.6e-01 per=5.9e+01 cost=3.0e+05 flops=1.2e+06
 renorm_tot[red] counter=12 t=1.1e-01 per=2.6e+01 cost=7.8e+04 flops=6.9e+05
qops.to_cpu: size(tot)=1192:9.1e-03MB:8.9e-06GB T(to_cpu)=2.4e-04S speed=3.7e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.0738 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.137e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=4.959e-04 change=-1.930e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 8.458e-02 S #####
 T(local oper_env: fetch) = 9.199e-03 S  per = 10.9  per(accum) = 10.9
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 10.9
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 10.9
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 10.9
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 10.9
 T(local oper_env: renrm) = 7.517e-02 S  per = 88.9  per(accum) = 99.7
 T(local oper_env: save ) = 2.116e-04 S  per = 0.25  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.517e-02 S  T(sum) = 7.517e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.353e-06 S  per = 0.0111  per(accum) = 0.0111
 T(local oper_env: qops init                    ) = 1.186e-03 S  per = 1.58  per(accum) = 1.59
 T(local oper_env: symbolic_formulae_renorm     ) = 1.712e-02 S  per = 22.8  per(accum) = 24.4
 T(local oper_env: allocate qops on gpu         ) = 4.974e-05 S  per = 0.0662  per(accum) = 24.4
 T(local oper_env: site memcpy cpu2gpu          ) = 2.108e-03 S  per =  2.8  per(accum) = 27.2
 T(local oper_env: rintermediate init           ) = 2.529e-03 S  per = 3.36  per(accum) = 30.6
 T(local oper_env: preprocess_formulae_Rlist2   ) = 5.130e-03 S  per = 6.82  per(accum) = 37.4
 T(local oper_env: rmmtasks init                ) = 6.753e-03 S  per = 8.98  per(accum) = 46.4
 T(local oper_env: qops memset on cpu           ) = 4.800e-08 S  per = 6.39e-05  per(accum) = 46.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.860e-02 S  per = 51.4  per(accum) = 97.8
 T(local oper_env: deallocate cpu and gpu memory) = 7.629e-05 S  per = 0.101  per(accum) = 97.9
 T(local oper_env: construct opS [ifdists=true] ) = 3.700e-08 S  per = 4.92e-05  per(accum) = 97.9
 T(local oper_env: reduction of opS & opH [nccl]) = 3.000e-08 S  per = 3.99e-05  per(accum) = 97.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.452e-04 S  per = 0.326  per(accum) = 98.2
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.691e-05 S  per = 0.0225  per(accum) = 98.2
 T(local oper_env: qops_pool join and erase     ) = 1.341e-03 S  per = 1.78  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.430e-07 S  per = 0.000855  per(accum) = 100
##### sweep oper_env: 9.060e-01 S #####
 T(sweep oper_env: fetch) = 1.312e-01 S  per = 14.5  per(accum) = 14.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.5
 T(sweep oper_env: renrm) = 7.721e-01 S  per = 85.2  per(accum) = 99.7
 T(sweep oper_env: save ) = 2.726e-03 S  per = 0.301  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.084e+10 S  per = -2.084e+32
 T(sweep oper_env: preprocess                  ) = -2.084e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.721e-01 S  T(sum) = 7.721e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.144e-04 S  per = 0.0148  per(accum) = 0.0148
 T(sweep oper_env: qops init                    ) = 1.487e-02 S  per = 1.93  per(accum) = 1.94
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.300e-01 S  per = 16.8  per(accum) = 18.8
 T(sweep oper_env: allocate qops on gpu         ) = 7.133e-04 S  per = 0.0924  per(accum) = 18.9
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.491e-02 S  per = 1.93  per(accum) = 20.8
 T(sweep oper_env: rintermediate init           ) = 2.790e-02 S  per = 3.61  per(accum) = 24.4
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.994e-02 S  per = 5.17  per(accum) = 29.6
 T(sweep oper_env: rmmtasks init                ) = 5.075e-02 S  per = 6.57  per(accum) = 36.2
 T(sweep oper_env: qops memset on cpu           ) = 5.060e-07 S  per = 6.55e-05  per(accum) = 36.2
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.411e-01 S  per = 57.1  per(accum) = 93.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 7.129e-04 S  per = 0.0923  per(accum) = 93.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 6.090e-07 S  per = 7.89e-05  per(accum) = 93.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.020e-07 S  per = 5.21e-05  per(accum) = 93.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.606e-03 S  per = 0.338  per(accum) = 93.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.009e-04 S  per = 0.026  per(accum) = 93.8
 T(sweep oper_env: qops_pool join and erase     ) = 1.863e-02 S  per = 2.41  per(accum) = 96.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.959e-02 S  per = 3.83  per(accum) = 100

idx=13 coord=(6,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1192:0.00909MB:8.88e-06GB
        per(mem): H:1.17 C:5.45 S:2.94 P:0 Q:90.4 
ctns::oper_renorm coord=(6,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=661:0.00504MB:4.92e-06GB
        per(mem): H:1.66 C:8.47 S:3.63 P:0 Q:86.2 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.717e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 1.371e-02 S -----
rank=0 GPUmem(GB): used=3.121e-05 (oper)=3.121e-05
rank=0 GPUmem(GB): used=3.138e-05 (oper,site)=3.121e-05,1.714e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=390
 no. of coefficients=5070:3.868e-02MB:3.777e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.513e-03 S -----
rank=0 GPUmem(GB): used=6.916e-05 (oper,site,rinter)=3.121e-05,1.714e-07,3.777e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.631e-03 S size(rtasks)=185 size(Rlst2)=9 T(Rmu/Rlist)=2.140e-03,1.491e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.834e-03 S size(rtasks)=185 size(Rlst)=1049 -----
rank=0 GPUmem(GB): used=6.916e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.719e-04 blksize=9 blksize0=3 batchsize=1049
rank=0 GPUmem(GB): used=2.411e-04 (oper,site,rinter,batch)=3.121e-05,1.714e-07,3.777e-05,1.719e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.466e-03,2.223e-02,9.839e-03
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=2.2e-02 t_reduction=9.8e-03 tot=3.9e-02 -----
 renorm[inter] counter=13 t=6.5e-03 per=1.7e+01 cost=1.9e+04 flops=2.9e+06
 renorm[gemm] counter=13 i=0 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=2 t=7.4e-03 per=1.9e+01 cost=2.5e+03 flops=3.3e+05
 renorm[gemm] counter=13 i=3 t=7.4e-03 per=1.9e+01 cost=8.0e+03 flops=1.1e+06
 renorm[gemm] counter=13 i=4 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=5 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=6 t=7.4e-03 per=1.9e+01 cost=1.9e+04 flops=2.6e+06
 renorm[gemm] counter=13 total t=2.2e-02 per=5.8e+01 cost=3.0e+04 flops=1.3e+06
 renorm[red] counter=13 t=9.8e-03 per=2.6e+01 cost=1.0e+04 flops=1.0e+06
----- TIMING FOR renorm_tot : t_inter=7.6e-02 t_gemm=2.8e-01 t_reduction=1.2e-01 tot=4.8e-01 -----
 renorm_tot[inter] counter=13 t=7.6e-02 per=1.6e+01 cost=4.4e+05 flops=5.8e+06
 renorm_tot[gemm] counter=13 i=0 t=1.9e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=1 t=1.5e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=2 t=9.8e-02 per=2.0e+01 cost=2.4e+04 flops=2.5e+05
 renorm_tot[gemm] counter=13 i=3 t=9.1e-02 per=1.9e+01 cost=1.2e+05 flops=1.3e+06
 renorm_tot[gemm] counter=13 i=4 t=1.5e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=5 t=1.5e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=6 t=9.1e-02 per=1.9e+01 cost=1.9e+05 flops=2.1e+06
 renorm_tot[gemm] counter=13 total t=2.8e-01 per=5.9e+01 cost=3.3e+05 flops=1.2e+06
 renorm_tot[red] counter=13 t=1.2e-01 per=2.6e+01 cost=8.8e+04 flops=7.2e+05
qops.to_cpu: size(tot)=661:5.0e-03MB:4.9e-06GB T(to_cpu)=1.8e-04S speed=2.8e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.0678 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=7.889e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=3.510e-04 change=-1.773e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 7.840e-02 S #####
 T(local oper_env: fetch) = 9.195e-03 S  per = 11.7  per(accum) = 11.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 11.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 11.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 11.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 11.7
 T(local oper_env: renrm) = 6.900e-02 S  per =   88  per(accum) = 99.7
 T(local oper_env: save ) = 2.060e-04 S  per = 0.263  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.900e-02 S  T(sum) = 6.900e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.347e-06 S  per = 0.0121  per(accum) = 0.0121
 T(local oper_env: qops init                    ) = 9.446e-04 S  per = 1.37  per(accum) = 1.38
 T(local oper_env: symbolic_formulae_renorm     ) = 1.372e-02 S  per = 19.9  per(accum) = 21.3
 T(local oper_env: allocate qops on gpu         ) = 5.132e-05 S  per = 0.0744  per(accum) = 21.3
 T(local oper_env: site memcpy cpu2gpu          ) = 1.795e-03 S  per =  2.6  per(accum) = 23.9
 T(local oper_env: rintermediate init           ) = 2.525e-03 S  per = 3.66  per(accum) = 27.6
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.869e-03 S  per = 5.61  per(accum) = 33.2
 T(local oper_env: rmmtasks init                ) = 5.983e-03 S  per = 8.67  per(accum) = 41.9
 T(local oper_env: qops memset on cpu           ) = 4.500e-08 S  per = 6.52e-05  per(accum) = 41.9
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.863e-02 S  per =   56  per(accum) = 97.9
 T(local oper_env: deallocate cpu and gpu memory) = 5.771e-05 S  per = 0.0836  per(accum) = 97.9
 T(local oper_env: construct opS [ifdists=true] ) = 3.600e-08 S  per = 5.22e-05  per(accum) = 97.9
 T(local oper_env: reduction of opS & opH [nccl]) = 2.900e-08 S  per = 4.2e-05  per(accum) = 97.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.855e-04 S  per = 0.269  per(accum) = 98.2
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.643e-05 S  per = 0.0238  per(accum) = 98.2
 T(local oper_env: qops_pool join and erase     ) = 1.214e-03 S  per = 1.76  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.030e-07 S  per = 0.00102  per(accum) = 100
##### sweep oper_env: 9.844e-01 S #####
 T(sweep oper_env: fetch) = 1.404e-01 S  per = 14.3  per(accum) = 14.3
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: renrm) = 8.411e-01 S  per = 85.4  per(accum) = 99.7
 T(sweep oper_env: save ) = 2.932e-03 S  per = 0.298  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.258e+10 S  per = -2.258e+32
 T(sweep oper_env: preprocess                  ) = -2.258e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.411e-01 S  T(sum) = 8.411e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.227e-04 S  per = 0.0146  per(accum) = 0.0146
 T(sweep oper_env: qops init                    ) = 1.582e-02 S  per = 1.88  per(accum) = 1.89
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.438e-01 S  per = 17.1  per(accum) = 19
 T(sweep oper_env: allocate qops on gpu         ) = 7.646e-04 S  per = 0.0909  per(accum) = 19.1
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.671e-02 S  per = 1.99  per(accum) = 21.1
 T(sweep oper_env: rintermediate init           ) = 3.043e-02 S  per = 3.62  per(accum) = 24.7
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.380e-02 S  per = 5.21  per(accum) = 29.9
 T(sweep oper_env: rmmtasks init                ) = 5.673e-02 S  per = 6.74  per(accum) = 36.6
 T(sweep oper_env: qops memset on cpu           ) = 5.510e-07 S  per = 6.55e-05  per(accum) = 36.6
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.798e-01 S  per =   57  per(accum) = 93.7
 T(sweep oper_env: deallocate cpu and gpu memory) = 7.706e-04 S  per = 0.0916  per(accum) = 93.8
 T(sweep oper_env: construct opS [ifdists=true] ) = 6.450e-07 S  per = 7.67e-05  per(accum) = 93.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.310e-07 S  per = 5.12e-05  per(accum) = 93.8
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.792e-03 S  per = 0.332  per(accum) = 94.1
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.174e-04 S  per = 0.0258  per(accum) = 94.1
 T(sweep oper_env: qops_pool join and erase     ) = 1.984e-02 S  per = 2.36  per(accum) = 96.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.959e-02 S  per = 3.52  per(accum) = 100

idx=14 coord=(5,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=661:0.00504MB:4.92e-06GB
        per(mem): H:1.66 C:8.47 S:3.63 P:0 Q:86.2 
ctns::oper_renorm coord=(5,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=10:7.63e-05MB size(tot)=370:0.00282MB:2.76e-06GB
        per(mem): H:2.7 C:12.2 S:4.05 P:0 Q:81.1 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.324e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=141 : 1.026e-02 S -----
rank=0 GPUmem(GB): used=2.509e-05 (oper)=2.509e-05
rank=0 GPUmem(GB): used=2.521e-05 (oper,site)=2.509e-05,1.267e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=280
 no. of coefficients=3920:2.991e-02MB:2.921e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.485e-03 S -----
rank=0 GPUmem(GB): used=5.442e-05 (oper,site,rinter)=2.509e-05,1.267e-07,2.921e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.489e-03 S size(rtasks)=141 size(Rlst2)=4 T(Rmu/Rlist)=1.555e-03,9.338e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.595e-03 S size(rtasks)=141 size(Rlst)=631 -----
rank=0 GPUmem(GB): used=5.442e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.034e-04 blksize=9 blksize0=3 batchsize=631
rank=0 GPUmem(GB): used=1.578e-04 (oper,site,rinter,batch)=2.509e-05,1.267e-07,2.921e-05,1.034e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.928e-03,2.259e-02,1.004e-02
----- TIMING FOR renorm : t_inter=5.9e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=14 t=5.9e-03 per=1.5e+01 cost=9.1e+03 flops=1.5e+06
 renorm[gemm] counter=14 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=2 t=7.5e-03 per=2.0e+01 cost=1.4e+03 flops=1.8e+05
 renorm[gemm] counter=14 i=3 t=7.5e-03 per=1.9e+01 cost=3.8e+03 flops=5.0e+05
 renorm[gemm] counter=14 i=4 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=5 t=1.0e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=6 t=7.6e-03 per=2.0e+01 cost=1.1e+04 flops=1.5e+06
 renorm[gemm] counter=14 total t=2.3e-02 per=5.9e+01 cost=1.6e+04 flops=7.3e+05
 renorm[red] counter=14 t=1.0e-02 per=2.6e+01 cost=7.0e+03 flops=7.0e+05
----- TIMING FOR renorm_tot : t_inter=8.2e-02 t_gemm=3.0e-01 t_reduction=1.3e-01 tot=5.2e-01 -----
 renorm_tot[inter] counter=14 t=8.2e-02 per=1.6e+01 cost=4.5e+05 flops=5.5e+06
 renorm_tot[gemm] counter=14 i=0 t=2.1e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=1 t=1.6e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=2 t=1.1e-01 per=2.0e+01 cost=2.6e+04 flops=2.4e+05
 renorm_tot[gemm] counter=14 i=3 t=9.9e-02 per=1.9e+01 cost=1.2e+05 flops=1.2e+06
 renorm_tot[gemm] counter=14 i=4 t=1.6e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=5 t=1.6e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=6 t=9.9e-02 per=1.9e+01 cost=2.0e+05 flops=2.1e+06
 renorm_tot[gemm] counter=14 total t=3.0e-01 per=5.9e+01 cost=3.5e+05 flops=1.2e+06
 renorm_tot[red] counter=14 t=1.3e-01 per=2.6e+01 cost=9.5e+04 flops=7.2e+05
qops.to_cpu: size(tot)=370:2.8e-03MB:2.8e-06GB T(to_cpu)=1.4e-04S speed=2.0e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.06 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=5.399e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=6.180e-04 change=-1.508e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 7.047e-02 S #####
 T(local oper_env: fetch) = 9.167e-03 S  per =   13  per(accum) = 13
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 13
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 13
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 13
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 13
 T(local oper_env: renrm) = 6.110e-02 S  per = 86.7  per(accum) = 99.7
 T(local oper_env: save ) = 2.049e-04 S  per = 0.291  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.110e-02 S  T(sum) = 6.110e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.485e-06 S  per = 0.0139  per(accum) = 0.0139
 T(local oper_env: qops init                    ) = 7.147e-04 S  per = 1.17  per(accum) = 1.18
 T(local oper_env: symbolic_formulae_renorm     ) = 1.027e-02 S  per = 16.8  per(accum) = 18
 T(local oper_env: allocate qops on gpu         ) = 4.684e-05 S  per = 0.0767  per(accum) = 18.1
 T(local oper_env: site memcpy cpu2gpu          ) = 1.505e-03 S  per = 2.46  per(accum) = 20.5
 T(local oper_env: rintermediate init           ) = 2.496e-03 S  per = 4.08  per(accum) = 24.6
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.617e-03 S  per = 4.28  per(accum) = 28.9
 T(local oper_env: rmmtasks init                ) = 3.480e-03 S  per =  5.7  per(accum) = 34.6
 T(local oper_env: qops memset on cpu           ) = 7.200e-08 S  per = 0.000118  per(accum) = 34.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.864e-02 S  per = 63.2  per(accum) = 97.8
 T(local oper_env: deallocate cpu and gpu memory) = 4.296e-05 S  per = 0.0703  per(accum) = 97.9
 T(local oper_env: construct opS [ifdists=true] ) = 3.100e-08 S  per = 5.07e-05  per(accum) = 97.9
 T(local oper_env: reduction of opS & opH [nccl]) = 3.000e-08 S  per = 4.91e-05  per(accum) = 97.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.470e-04 S  per = 0.241  per(accum) = 98.2
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.548e-05 S  per = 0.0253  per(accum) = 98.2
 T(local oper_env: qops_pool join and erase     ) = 1.111e-03 S  per = 1.82  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.280e-07 S  per = 0.00103  per(accum) = 100
##### sweep oper_env: 1.055e+00 S #####
 T(sweep oper_env: fetch) = 1.495e-01 S  per = 14.2  per(accum) = 14.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: renrm) = 9.022e-01 S  per = 85.5  per(accum) = 99.7
 T(sweep oper_env: save ) = 3.137e-03 S  per = 0.297  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.431e+10 S  per = -2.431e+32
 T(sweep oper_env: preprocess                  ) = -2.431e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.022e-01 S  T(sum) = 9.022e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.312e-04 S  per = 0.0145  per(accum) = 0.0145
 T(sweep oper_env: qops init                    ) = 1.653e-02 S  per = 1.83  per(accum) = 1.85
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.540e-01 S  per = 17.1  per(accum) = 18.9
 T(sweep oper_env: allocate qops on gpu         ) = 8.114e-04 S  per = 0.0899  per(accum) = 19
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.821e-02 S  per = 2.02  per(accum) = 21
 T(sweep oper_env: rintermediate init           ) = 3.292e-02 S  per = 3.65  per(accum) = 24.7
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.642e-02 S  per = 5.15  per(accum) = 29.8
 T(sweep oper_env: rmmtasks init                ) = 6.021e-02 S  per = 6.67  per(accum) = 36.5
 T(sweep oper_env: qops memset on cpu           ) = 6.230e-07 S  per = 6.91e-05  per(accum) = 36.5
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.184e-01 S  per = 57.5  per(accum) = 94
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.136e-04 S  per = 0.0902  per(accum) = 94
 T(sweep oper_env: construct opS [ifdists=true] ) = 6.760e-07 S  per = 7.49e-05  per(accum) = 94
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.610e-07 S  per = 5.11e-05  per(accum) = 94
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.939e-03 S  per = 0.326  per(accum) = 94.4
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.329e-04 S  per = 0.0258  per(accum) = 94.4
 T(sweep oper_env: qops_pool join and erase     ) = 2.095e-02 S  per = 2.32  per(accum) = 96.7
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.959e-02 S  per = 3.28  per(accum) = 100

idx=15 coord=(4,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=10:7.63e-05MB size(tot)=370:0.00282MB:2.76e-06GB
        per(mem): H:2.7 C:12.2 S:4.05 P:0 Q:81.1 
ctns::oper_renorm coord=(4,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.181e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=105 : 7.415e-03 S -----
rank=0 GPUmem(GB): used=2.124e-05 (oper)=2.124e-05
rank=0 GPUmem(GB): used=2.132e-05 (oper,site)=2.124e-05,7.451e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=188
 no. of coefficients=2820:2.151e-02MB:2.101e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.468e-03 S -----
rank=0 GPUmem(GB): used=4.233e-05 (oper,site,rinter)=2.124e-05,7.451e-08,2.101e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.516e-03 S size(rtasks)=105 size(Rlst2)=4 T(Rmu/Rlist)=1.090e-03,4.261e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.567e-03 S size(rtasks)=105 size(Rlst)=244 -----
rank=0 GPUmem(GB): used=4.233e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.909e-05 blksize=6 blksize0=3 batchsize=244
rank=0 GPUmem(GB): used=7.141e-05 (oper,site,rinter,batch)=2.124e-05,7.451e-08,2.101e-05,2.909e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.154e-03,2.260e-02,1.011e-02
----- TIMING FOR renorm : t_inter=7.2e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=15 t=7.2e-03 per=1.8e+01 cost=4.0e+03 flops=5.5e+05
 renorm[gemm] counter=15 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=1 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=2 t=7.5e-03 per=1.9e+01 cost=3.7e+02 flops=4.9e+04
 renorm[gemm] counter=15 i=3 t=7.5e-03 per=1.9e+01 cost=1.7e+03 flops=2.3e+05
 renorm[gemm] counter=15 i=4 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=5 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=6 t=7.6e-03 per=1.9e+01 cost=2.0e+03 flops=2.7e+05
 renorm[gemm] counter=15 total t=2.3e-02 per=5.7e+01 cost=4.1e+03 flops=1.8e+05
 renorm[red] counter=15 t=1.0e-02 per=2.5e+01 cost=8.3e+02 flops=8.2e+04
----- TIMING FOR renorm_tot : t_inter=8.9e-02 t_gemm=3.3e-01 t_reduction=1.4e-01 tot=5.6e-01 -----
 renorm_tot[inter] counter=15 t=8.9e-02 per=1.6e+01 cost=4.5e+05 flops=5.1e+06
 renorm_tot[gemm] counter=15 i=0 t=2.2e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=1 t=1.7e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=2 t=1.1e-01 per=2.0e+01 cost=2.6e+04 flops=2.3e+05
 renorm_tot[gemm] counter=15 i=3 t=1.1e-01 per=1.9e+01 cost=1.2e+05 flops=1.1e+06
 renorm_tot[gemm] counter=15 i=4 t=1.7e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=5 t=1.7e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=6 t=1.1e-01 per=1.9e+01 cost=2.1e+05 flops=1.9e+06
 renorm_tot[gemm] counter=15 total t=3.3e-01 per=5.8e+01 cost=3.5e+05 flops=1.1e+06
 renorm_tot[red] counter=15 t=1.4e-01 per=2.6e+01 cost=9.6e+04 flops=6.7e+05
qops.to_cpu: size(tot)=145:1.1e-03MB:1.1e-06GB T(to_cpu)=1.1e-04S speed=1.0e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.0539 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=3.533e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.280e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 6.426e-02 S #####
 T(local oper_env: fetch) = 9.182e-03 S  per = 14.3  per(accum) = 14.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(local oper_env: renrm) = 5.488e-02 S  per = 85.4  per(accum) = 99.7
 T(local oper_env: save ) = 1.964e-04 S  per = 0.306  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.488e-02 S  T(sum) = 5.488e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.371e-06 S  per = 0.0153  per(accum) = 0.0153
 T(local oper_env: qops init                    ) = 5.597e-04 S  per = 1.02  per(accum) = 1.04
 T(local oper_env: symbolic_formulae_renorm     ) = 7.427e-03 S  per = 13.5  per(accum) = 14.6
 T(local oper_env: allocate qops on gpu         ) = 4.609e-05 S  per = 0.084  per(accum) = 14.7
 T(local oper_env: site memcpy cpu2gpu          ) = 4.243e-04 S  per = 0.773  per(accum) = 15.4
 T(local oper_env: rintermediate init           ) = 2.477e-03 S  per = 4.51  per(accum) = 19.9
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.578e-03 S  per = 2.88  per(accum) = 22.8
 T(local oper_env: rmmtasks init                ) = 1.243e-03 S  per = 2.27  per(accum) = 25.1
 T(local oper_env: qops memset on cpu           ) = 4.900e-08 S  per = 8.93e-05  per(accum) = 25.1
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.996e-02 S  per = 72.8  per(accum) = 97.9
 T(local oper_env: deallocate cpu and gpu memory) = 2.937e-05 S  per = 0.0535  per(accum) = 98
 T(local oper_env: construct opS [ifdists=true] ) = 3.000e-08 S  per = 5.47e-05  per(accum) = 98
 T(local oper_env: reduction of opS & opH [nccl]) = 3.200e-08 S  per = 5.83e-05  per(accum) = 98
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.131e-04 S  per = 0.206  per(accum) = 98.2
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.534e-05 S  per = 0.028  per(accum) = 98.2
 T(local oper_env: qops_pool join and erase     ) = 9.937e-04 S  per = 1.81  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.520e-07 S  per = 0.00119  per(accum) = 100
##### sweep oper_env: 1.119e+00 S #####
 T(sweep oper_env: fetch) = 1.587e-01 S  per = 14.2  per(accum) = 14.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: renrm) = 9.571e-01 S  per = 85.5  per(accum) = 99.7
 T(sweep oper_env: save ) = 3.333e-03 S  per = 0.298  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.605e+10 S  per = -2.605e+32
 T(sweep oper_env: preprocess                  ) = -2.605e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.571e-01 S  T(sum) = 9.571e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.396e-04 S  per = 0.0146  per(accum) = 0.0146
 T(sweep oper_env: qops init                    ) = 1.709e-02 S  per = 1.79  per(accum) = 1.8
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.615e-01 S  per = 16.9  per(accum) = 18.7
 T(sweep oper_env: allocate qops on gpu         ) = 8.575e-04 S  per = 0.0896  per(accum) = 18.8
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.864e-02 S  per = 1.95  per(accum) = 20.7
 T(sweep oper_env: rintermediate init           ) = 3.540e-02 S  per =  3.7  per(accum) = 24.4
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.800e-02 S  per = 5.02  per(accum) = 29.4
 T(sweep oper_env: rmmtasks init                ) = 6.145e-02 S  per = 6.42  per(accum) = 35.8
 T(sweep oper_env: qops memset on cpu           ) = 6.720e-07 S  per = 7.02e-05  per(accum) = 35.8
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.584e-01 S  per = 58.3  per(accum) = 94.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.429e-04 S  per = 0.0881  per(accum) = 94.3
 T(sweep oper_env: construct opS [ifdists=true] ) = 7.060e-07 S  per = 7.38e-05  per(accum) = 94.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.930e-07 S  per = 5.15e-05  per(accum) = 94.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.052e-03 S  per = 0.319  per(accum) = 94.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.482e-04 S  per = 0.0259  per(accum) = 94.6
 T(sweep oper_env: qops_pool join and erase     ) = 2.194e-02 S  per = 2.29  per(accum) = 96.9
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.959e-02 S  per = 3.09  per(accum) = 100

idx=16 coord=(3,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
ctns::oper_renorm coord=(3,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=46:0.000351MB:3.43e-07GB
        per(mem): H:4.35 C:37 S:6.52 P:0 Q:52.2 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.074e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 4.624e-03 S -----
rank=0 GPUmem(GB): used=1.883e-05 (oper)=1.883e-05
rank=0 GPUmem(GB): used=1.886e-05 (oper,site)=1.883e-05,3.725e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=114
 no. of coefficients=1824:1.392e-02MB:1.359e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.466e-03 S -----
rank=0 GPUmem(GB): used=3.245e-05 (oper,site,rinter)=1.883e-05,3.725e-08,1.359e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 9.943e-04 S size(rtasks)=77 size(Rlst2)=4 T(Rmu/Rlist)=6.858e-04,3.084e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.035e-03 S size(rtasks)=77 size(Rlst)=179 -----
rank=0 GPUmem(GB): used=3.245e-05 avail=6.176e+00 total=6.176e+00 batch[need]=9.336e-06 blksize=2 blksize0=2 batchsize=179
rank=0 GPUmem(GB): used=4.179e-05 (oper,site,rinter,batch)=1.883e-05,3.725e-08,1.359e-05,9.336e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.986e-03,2.261e-02,1.014e-02
----- TIMING FOR renorm : t_inter=8.0e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.1e-02 -----
 renorm[inter] counter=16 t=8.0e-03 per=2.0e+01 cost=1.7e+03 flops=2.2e+05
 renorm[gemm] counter=16 i=0 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=2 t=7.5e-03 per=1.9e+01 cost=1.7e+02 flops=2.3e+04
 renorm[gemm] counter=16 i=3 t=7.5e-03 per=1.9e+01 cost=4.8e+02 flops=6.3e+04
 renorm[gemm] counter=16 i=4 t=1.1e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=5 t=1.0e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=6 t=7.5e-03 per=1.8e+01 cost=5.7e+02 flops=7.5e+04
 renorm[gemm] counter=16 total t=2.3e-02 per=5.6e+01 cost=1.2e+03 flops=5.4e+04
 renorm[red] counter=16 t=1.0e-02 per=2.5e+01 cost=3.6e+02 flops=3.5e+04
----- TIMING FOR renorm_tot : t_inter=9.7e-02 t_gemm=3.5e-01 t_reduction=1.5e-01 tot=6.0e-01 -----
 renorm_tot[inter] counter=16 t=9.7e-02 per=1.6e+01 cost=4.5e+05 flops=4.7e+06
 renorm_tot[gemm] counter=16 i=0 t=2.3e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=1 t=1.8e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=2 t=1.2e-01 per=2.0e+01 cost=2.6e+04 flops=2.2e+05
 renorm_tot[gemm] counter=16 i=3 t=1.1e-01 per=1.9e+01 cost=1.2e+05 flops=1.1e+06
 renorm_tot[gemm] counter=16 i=4 t=1.8e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=5 t=1.8e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=6 t=1.1e-01 per=1.9e+01 cost=2.1e+05 flops=1.8e+06
 renorm_tot[gemm] counter=16 total t=3.5e-01 per=5.8e+01 cost=3.5e+05 flops=1.0e+06
 renorm_tot[red] counter=16 t=1.5e-01 per=2.6e+01 cost=9.6e+04 flops=6.3e+05
qops.to_cpu: size(tot)=46:3.5e-04MB:3.4e-07GB T(to_cpu)=1.1e-04S speed=3.3e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0521 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.382e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.153e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 6.236e-02 S #####
 T(local oper_env: fetch) = 9.160e-03 S  per = 14.7  per(accum) = 14.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: renrm) = 5.300e-02 S  per =   85  per(accum) = 99.7
 T(local oper_env: save ) = 1.950e-04 S  per = 0.313  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.300e-02 S  T(sum) = 5.300e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.325e-06 S  per = 0.0157  per(accum) = 0.0157
 T(local oper_env: qops init                    ) = 4.335e-04 S  per = 0.818  per(accum) = 0.834
 T(local oper_env: symbolic_formulae_renorm     ) = 4.634e-03 S  per = 8.74  per(accum) = 9.58
 T(local oper_env: allocate qops on gpu         ) = 4.471e-05 S  per = 0.0844  per(accum) = 9.66
 T(local oper_env: site memcpy cpu2gpu          ) = 1.522e-03 S  per = 2.87  per(accum) = 12.5
 T(local oper_env: rintermediate init           ) = 2.475e-03 S  per = 4.67  per(accum) = 17.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.045e-03 S  per = 1.97  per(accum) = 19.2
 T(local oper_env: rmmtasks init                ) = 9.337e-04 S  per = 1.76  per(accum) = 20.9
 T(local oper_env: qops memset on cpu           ) = 3.200e-08 S  per = 6.04e-05  per(accum) = 20.9
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.083e-02 S  per =   77  per(accum) = 98
 T(local oper_env: deallocate cpu and gpu memory) = 2.596e-05 S  per = 0.049  per(accum) = 98
 T(local oper_env: construct opS [ifdists=true] ) = 3.200e-08 S  per = 6.04e-05  per(accum) = 98
 T(local oper_env: reduction of opS & opH [nccl]) = 3.100e-08 S  per = 5.85e-05  per(accum) = 98
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.120e-04 S  per = 0.211  per(accum) = 98.2
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.497e-05 S  per = 0.0282  per(accum) = 98.3
 T(local oper_env: qops_pool join and erase     ) = 9.266e-04 S  per = 1.75  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.650e-07 S  per = 0.00125  per(accum) = 100
##### sweep oper_env: 1.181e+00 S #####
 T(sweep oper_env: fetch) = 1.679e-01 S  per = 14.2  per(accum) = 14.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.2
 T(sweep oper_env: renrm) = 1.010e+00 S  per = 85.5  per(accum) = 99.7
 T(sweep oper_env: save ) = 3.528e-03 S  per = 0.299  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.779e+10 S  per = -2.779e+32
 T(sweep oper_env: preprocess                  ) = -2.779e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.010e+00 S  T(sum) = 1.010e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.479e-04 S  per = 0.0146  per(accum) = 0.0146
 T(sweep oper_env: qops init                    ) = 1.752e-02 S  per = 1.73  per(accum) = 1.75
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.661e-01 S  per = 16.4  per(accum) = 18.2
 T(sweep oper_env: allocate qops on gpu         ) = 9.022e-04 S  per = 0.0893  per(accum) = 18.3
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.016e-02 S  per =    2  per(accum) = 20.3
 T(sweep oper_env: rintermediate init           ) = 3.788e-02 S  per = 3.75  per(accum) = 24
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.904e-02 S  per = 4.86  per(accum) = 28.9
 T(sweep oper_env: rmmtasks init                ) = 6.239e-02 S  per = 6.18  per(accum) = 35.1
 T(sweep oper_env: qops memset on cpu           ) = 7.040e-07 S  per = 6.97e-05  per(accum) = 35.1
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.992e-01 S  per = 59.3  per(accum) = 94.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.689e-04 S  per = 0.086  per(accum) = 94.5
 T(sweep oper_env: construct opS [ifdists=true] ) = 7.380e-07 S  per = 7.31e-05  per(accum) = 94.5
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.240e-07 S  per = 5.19e-05  per(accum) = 94.5
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.164e-03 S  per = 0.313  per(accum) = 94.8
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.632e-04 S  per = 0.0261  per(accum) = 94.8
 T(sweep oper_env: qops_pool join and erase     ) = 2.287e-02 S  per = 2.26  per(accum) = 97.1
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.959e-02 S  per = 2.93  per(accum) = 100

idx=17 coord=(2,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=46:0.000351MB:3.43e-07GB
        per(mem): H:4.35 C:37 S:6.52 P:0 Q:52.2 
ctns::oper_renorm coord=(2,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:36 S:4 P:6 Q:10 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=7:5.34e-05MB:5.22e-08GB
        per(mem): H:14.3 C:0 S:0 P:0 Q:85.7 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.960e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 2.627e-03 S -----
rank=0 GPUmem(GB): used=1.780e-05 (oper)=1.780e-05
rank=0 GPUmem(GB): used=1.781e-05 (oper,site)=1.780e-05,1.490e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=58
 no. of coefficients=986:7.523e-03MB:7.346e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.517e-03 S -----
rank=0 GPUmem(GB): used=2.516e-05 (oper,site,rinter)=1.780e-05,1.490e-08,7.346e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 5.881e-04 S size(rtasks)=57 size(Rlst2)=1 T(Rmu/Rlist)=4.317e-04,1.564e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.047e-04 S size(rtasks)=57 size(Rlst)=86 -----
rank=0 GPUmem(GB): used=2.516e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.563e-06 blksize=1 blksize0=1 batchsize=86
rank=0 GPUmem(GB): used=2.772e-05 (oper,site,rinter,batch)=1.780e-05,1.490e-08,7.346e-06,2.563e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.856e-03,2.235e-02,1.006e-02
----- TIMING FOR renorm : t_inter=8.9e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=4.1e-02 -----
 renorm[inter] counter=17 t=8.9e-03 per=2.1e+01 cost=4.1e+02 flops=4.6e+04
 renorm[gemm] counter=17 i=0 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=2 t=7.4e-03 per=1.8e+01 cost=5.8e+01 flops=7.8e+03
 renorm[gemm] counter=17 i=3 t=7.4e-03 per=1.8e+01 cost=8.2e+01 flops=1.1e+04
 renorm[gemm] counter=17 i=4 t=1.0e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=5 t=9.9e-07 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=6 t=7.5e-03 per=1.8e+01 cost=1.7e+02 flops=2.3e+04
 renorm[gemm] counter=17 total t=2.2e-02 per=5.4e+01 cost=3.1e+02 flops=1.4e+04
 renorm[red] counter=17 t=1.0e-02 per=2.4e+01 cost=1.7e+02 flops=1.7e+04
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=3.7e-01 t_reduction=1.6e-01 tot=6.4e-01 -----
 renorm_tot[inter] counter=17 t=1.1e-01 per=1.7e+01 cost=4.5e+05 flops=4.3e+06
 renorm_tot[gemm] counter=17 i=0 t=2.4e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=1 t=1.9e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=2 t=1.3e-01 per=2.0e+01 cost=2.6e+04 flops=2.1e+05
 renorm_tot[gemm] counter=17 i=3 t=1.2e-01 per=1.9e+01 cost=1.2e+05 flops=1.0e+06
 renorm_tot[gemm] counter=17 i=4 t=1.9e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=5 t=1.9e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=6 t=1.2e-01 per=1.9e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=17 total t=3.7e-01 per=5.8e+01 cost=3.5e+05 flops=9.6e+05
 renorm_tot[red] counter=17 t=1.6e-01 per=2.5e+01 cost=9.6e+04 flops=5.9e+05
qops.to_cpu: size(tot)=7:5.3e-05MB:5.2e-08GB T(to_cpu)=6.6e-05S speed=7.9e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0498 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.353e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.041e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 6.006e-02 S #####
 T(local oper_env: fetch) = 9.162e-03 S  per = 15.3  per(accum) = 15.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15.3
 T(local oper_env: renrm) = 5.070e-02 S  per = 84.4  per(accum) = 99.7
 T(local oper_env: save ) = 1.902e-04 S  per = 0.317  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.070e-02 S  T(sum) = 5.070e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.278e-06 S  per = 0.0163  per(accum) = 0.0163
 T(local oper_env: qops init                    ) = 3.368e-04 S  per = 0.664  per(accum) = 0.681
 T(local oper_env: symbolic_formulae_renorm     ) = 2.636e-03 S  per =  5.2  per(accum) = 5.88
 T(local oper_env: allocate qops on gpu         ) = 4.656e-05 S  per = 0.0918  per(accum) = 5.97
 T(local oper_env: site memcpy cpu2gpu          ) = 1.699e-03 S  per = 3.35  per(accum) = 9.32
 T(local oper_env: rintermediate init           ) = 2.532e-03 S  per = 4.99  per(accum) = 14.3
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.110e-04 S  per =  1.2  per(accum) = 15.5
 T(local oper_env: rmmtasks init                ) = 4.853e-04 S  per = 0.957  per(accum) = 16.5
 T(local oper_env: qops memset on cpu           ) = 3.200e-08 S  per = 6.31e-05  per(accum) = 16.5
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.135e-02 S  per = 81.6  per(accum) = 98
 T(local oper_env: deallocate cpu and gpu memory) = 2.258e-05 S  per = 0.0445  per(accum) = 98.1
 T(local oper_env: construct opS [ifdists=true] ) = 3.100e-08 S  per = 6.11e-05  per(accum) = 98.1
 T(local oper_env: reduction of opS & opH [nccl]) = 3.000e-08 S  per = 5.92e-05  per(accum) = 98.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 7.316e-05 S  per = 0.144  per(accum) = 98.2
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.417e-05 S  per = 0.0279  per(accum) = 98.3
 T(local oper_env: qops_pool join and erase     ) = 8.861e-04 S  per = 1.75  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.660e-07 S  per = 0.00131  per(accum) = 100
##### sweep oper_env: 1.242e+00 S #####
 T(sweep oper_env: fetch) = 1.770e-01 S  per = 14.3  per(accum) = 14.3
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: renrm) = 1.061e+00 S  per = 85.4  per(accum) = 99.7
 T(sweep oper_env: save ) = 3.718e-03 S  per = 0.299  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.952e+10 S  per = -2.952e+32
 T(sweep oper_env: preprocess                  ) = -2.952e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.061e+00 S  T(sum) = 1.061e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.562e-04 S  per = 0.0147  per(accum) = 0.0147
 T(sweep oper_env: qops init                    ) = 1.786e-02 S  per = 1.68  per(accum) = 1.7
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.687e-01 S  per = 15.9  per(accum) = 17.6
 T(sweep oper_env: allocate qops on gpu         ) = 9.488e-04 S  per = 0.0894  per(accum) = 17.7
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.186e-02 S  per = 2.06  per(accum) = 19.8
 T(sweep oper_env: rintermediate init           ) = 4.041e-02 S  per = 3.81  per(accum) = 23.6
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.966e-02 S  per = 4.68  per(accum) = 28.2
 T(sweep oper_env: rmmtasks init                ) = 6.287e-02 S  per = 5.93  per(accum) = 34.2
 T(sweep oper_env: qops memset on cpu           ) = 7.360e-07 S  per = 6.94e-05  per(accum) = 34.2
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.405e-01 S  per = 60.4  per(accum) = 94.6
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.915e-04 S  per = 0.084  per(accum) = 94.6
 T(sweep oper_env: construct opS [ifdists=true] ) = 7.690e-07 S  per = 7.25e-05  per(accum) = 94.6
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.540e-07 S  per = 5.22e-05  per(accum) = 94.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.237e-03 S  per = 0.305  per(accum) = 94.9
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.773e-04 S  per = 0.0261  per(accum) = 95
 T(sweep oper_env: qops_pool join and erase     ) = 2.376e-02 S  per = 2.24  per(accum) = 97.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.959e-02 S  per = 2.79  per(accum) = 100

idx=18 coord=(1,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:36 S:4 P:6 Q:10 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=7:5.34e-05MB:5.22e-08GB
        per(mem): H:14.3 C:0 S:0 P:0 Q:85.7 
ctns::oper_renorm coord=(1,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:38 S:2 P:1 Q:3 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=3:2.29e-05MB:2.24e-08GB
        per(mem): H:33.3 C:0 S:0 P:0 Q:66.7 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.919e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=45 : 1.103e-03 S -----
rank=0 GPUmem(GB): used=1.748e-05 (oper)=1.748e-05
rank=0 GPUmem(GB): used=1.749e-05 (oper,site)=1.748e-05,7.451e-09
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=45
 no. of rintermediate operators=20
 no. of coefficients=360:2.747e-03MB:2.682e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.514e-03 S -----
rank=0 GPUmem(GB): used=2.017e-05 (oper,site,rinter)=1.748e-05,7.451e-09,2.682e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 3.014e-04 S size(rtasks)=45 size(Rlst2)=1 T(Rmu/Rlist)=2.498e-04,5.157e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.106e-04 S size(rtasks)=45 size(Rlst)=12 -----
rank=0 GPUmem(GB): used=2.017e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.682e-07 blksize=1 blksize0=0 batchsize=12
rank=0 GPUmem(GB): used=2.044e-05 (oper,site,rinter,batch)=1.748e-05,7.451e-09,2.682e-06,2.682e-07
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=2.076e-03,2.269e-02,1.011e-02
----- TIMING FOR renorm : t_inter=2.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.5e-02 -----
 renorm[inter] counter=18 t=2.1e-03 per=6.0e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=0 t=1.5e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=1 t=1.1e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=2 t=7.5e-03 per=2.2e+01 cost=6.0e+00 flops=7.9e+02
 renorm[gemm] counter=18 i=3 t=7.5e-03 per=2.2e+01 cost=1.0e+01 flops=1.3e+03
 renorm[gemm] counter=18 i=4 t=1.1e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=5 t=1.0e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=6 t=7.6e-03 per=2.2e+01 cost=2.4e+01 flops=3.2e+03
 renorm[gemm] counter=18 total t=2.3e-02 per=6.5e+01 cost=4.0e+01 flops=1.8e+03
 renorm[red] counter=18 t=1.0e-02 per=2.9e+01 cost=2.4e+01 flops=2.4e+03
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=3.9e-01 t_reduction=1.7e-01 tot=6.7e-01 -----
 renorm_tot[inter] counter=18 t=1.1e-01 per=1.6e+01 cost=4.5e+05 flops=4.2e+06
 renorm_tot[gemm] counter=18 i=0 t=2.6e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=1 t=2.0e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=2 t=1.4e-01 per=2.0e+01 cost=2.6e+04 flops=1.9e+05
 renorm_tot[gemm] counter=18 i=3 t=1.3e-01 per=1.9e+01 cost=1.2e+05 flops=9.4e+05
 renorm_tot[gemm] counter=18 i=4 t=2.0e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=5 t=2.0e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=6 t=1.3e-01 per=1.9e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=18 total t=3.9e-01 per=5.8e+01 cost=3.5e+05 flops=9.0e+05
 renorm_tot[red] counter=18 t=1.7e-01 per=2.6e+01 cost=9.6e+04 flops=5.6e+05
qops.to_cpu: size(tot)=3:2.3e-05MB:2.2e-08GB T(to_cpu)=4.8e-05S speed=4.7e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0402 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=6.008e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.550e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 5.048e-02 S #####
 T(local oper_env: fetch) = 9.179e-03 S  per = 18.2  per(accum) = 18.2
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 18.2
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 18.2
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 18.2
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 18.2
 T(local oper_env: renrm) = 4.111e-02 S  per = 81.4  per(accum) = 99.6
 T(local oper_env: save ) = 1.929e-04 S  per = 0.382  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.111e-02 S  T(sum) = 4.111e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.101e-05 S  per = 0.0268  per(accum) = 0.0268
 T(local oper_env: qops init                    ) = 2.868e-04 S  per = 0.698  per(accum) = 0.724
 T(local oper_env: symbolic_formulae_renorm     ) = 1.111e-03 S  per =  2.7  per(accum) = 3.43
 T(local oper_env: allocate qops on gpu         ) = 4.402e-05 S  per = 0.107  per(accum) = 3.54
 T(local oper_env: site memcpy cpu2gpu          ) = 7.947e-04 S  per = 1.93  per(accum) = 5.47
 T(local oper_env: rintermediate init           ) = 2.523e-03 S  per = 6.14  per(accum) = 11.6
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.145e-04 S  per = 0.765  per(accum) = 12.4
 T(local oper_env: rmmtasks init                ) = 1.095e-04 S  per = 0.266  per(accum) = 12.6
 T(local oper_env: qops memset on cpu           ) = 4.200e-08 S  per = 0.000102  per(accum) = 12.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.497e-02 S  per = 85.1  per(accum) = 97.7
 T(local oper_env: deallocate cpu and gpu memory) = 1.961e-05 S  per = 0.0477  per(accum) = 97.7
 T(local oper_env: construct opS [ifdists=true] ) = 3.400e-08 S  per = 8.27e-05  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [nccl]) = 3.000e-08 S  per = 7.3e-05  per(accum) = 97.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 5.441e-05 S  per = 0.132  per(accum) = 97.9
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.410e-05 S  per = 0.0343  per(accum) = 97.9
 T(local oper_env: qops_pool join and erase     ) = 8.576e-04 S  per = 2.09  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.120e-07 S  per = 0.00149  per(accum) = 100
##### sweep oper_env: 1.292e+00 S #####
 T(sweep oper_env: fetch) = 1.862e-01 S  per = 14.4  per(accum) = 14.4
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.4
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.4
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.4
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.4
 T(sweep oper_env: renrm) = 1.102e+00 S  per = 85.3  per(accum) = 99.7
 T(sweep oper_env: save ) = 3.911e-03 S  per = 0.303  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.126e+10 S  per = -3.126e+32
 T(sweep oper_env: preprocess                  ) = -3.126e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.102e+00 S  T(sum) = 1.102e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.672e-04 S  per = 0.0152  per(accum) = 0.0152
 T(sweep oper_env: qops init                    ) = 1.815e-02 S  per = 1.65  per(accum) = 1.66
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.698e-01 S  per = 15.4  per(accum) = 17.1
 T(sweep oper_env: allocate qops on gpu         ) = 9.928e-04 S  per = 0.0901  per(accum) = 17.2
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.265e-02 S  per = 2.06  per(accum) = 19.2
 T(sweep oper_env: rintermediate init           ) = 4.293e-02 S  per =  3.9  per(accum) = 23.1
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.997e-02 S  per = 4.53  per(accum) = 27.7
 T(sweep oper_env: rmmtasks init                ) = 6.298e-02 S  per = 5.72  per(accum) = 33.4
 T(sweep oper_env: qops memset on cpu           ) = 7.780e-07 S  per = 7.06e-05  per(accum) = 33.4
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.755e-01 S  per = 61.3  per(accum) = 94.7
 T(sweep oper_env: deallocate cpu and gpu memory) = 9.111e-04 S  per = 0.0827  per(accum) = 94.8
 T(sweep oper_env: construct opS [ifdists=true] ) = 8.030e-07 S  per = 7.29e-05  per(accum) = 94.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.840e-07 S  per = 5.3e-05  per(accum) = 94.8
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.292e-03 S  per = 0.299  per(accum) = 95.1
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.914e-04 S  per = 0.0264  per(accum) = 95.1
 T(sweep oper_env: qops_pool join and erase     ) = 2.461e-02 S  per = 2.23  per(accum) = 97.3
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.959e-02 S  per = 2.69  per(accum) = 100

idx=19 coord=(0,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=271:0.00207MB:2.02e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=320:0.00244MB:2.38e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:38 S:2 P:1 Q:3 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=3:2.29e-05MB:2.24e-08GB
        per(mem): H:33.3 C:0 S:0 P:0 Q:66.7 
ctns::oper_renorm coord=(0,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:40 S:0 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
        per(mem): H:100 C:0 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.897e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=41 : 3.782e-04 S -----
rank=0 GPUmem(GB): used=1.743e-05 (oper)=1.743e-05
rank=0 GPUmem(GB): used=1.744e-05 (oper,site)=1.743e-05,7.451e-09
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=41
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=1.744e-05 (oper,site,rinter)=1.743e-05,7.451e-09,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 2.006e-04 S size(rtasks)=41 size(Rlst2)=1 T(Rmu/Rlist)=1.608e-04,3.971e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.086e-04 S size(rtasks)=41 size(Rlst)=8 -----
rank=0 GPUmem(GB): used=1.744e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.788e-07 blksize=1 blksize0=0 batchsize=8
rank=0 GPUmem(GB): used=1.762e-05 (oper,site,rinter,batch)=1.743e-05,7.451e-09,0.000e+00,1.788e-07
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=2.167e-03,2.096e-02,1.515e-03
----- TIMING FOR renorm : t_inter=2.2e-03 t_gemm=2.1e-02 t_reduction=1.5e-03 tot=2.5e-02 -----
 renorm[inter] counter=19 t=2.2e-03 per=8.8e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=0 t=1.6e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=1 t=1.1e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=2 t=7.5e-03 per=3.1e+01 cost=6.0e+00 flops=7.9e+02
 renorm[gemm] counter=19 i=3 t=7.6e-03 per=3.1e+01 cost=6.0e+00 flops=7.9e+02
 renorm[gemm] counter=19 i=4 t=1.1e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=5 t=1.1e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=6 t=5.8e-03 per=2.3e+01 cost=1.6e+01 flops=2.8e+03
 renorm[gemm] counter=19 total t=2.1e-02 per=8.5e+01 cost=2.8e+01 flops=1.3e+03
 renorm[red] counter=19 t=1.5e-03 per=6.1e+00 cost=1.6e+01 flops=1.1e+04
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=4.1e-01 t_reduction=1.7e-01 tot=7.0e-01 -----
 renorm_tot[inter] counter=19 t=1.1e-01 per=1.6e+01 cost=4.5e+05 flops=4.1e+06
 renorm_tot[gemm] counter=19 i=0 t=2.8e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=1 t=2.1e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=2 t=1.4e-01 per=2.0e+01 cost=2.6e+04 flops=1.8e+05
 renorm_tot[gemm] counter=19 i=3 t=1.4e-01 per=2.0e+01 cost=1.2e+05 flops=8.9e+05
 renorm_tot[gemm] counter=19 i=4 t=2.1e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=5 t=2.1e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=6 t=1.3e-01 per=1.9e+01 cost=2.1e+05 flops=1.5e+06
 renorm_tot[gemm] counter=19 total t=4.1e-01 per=5.9e+01 cost=3.5e+05 flops=8.6e+05
 renorm_tot[red] counter=19 t=1.7e-01 per=2.5e+01 cost=9.6e+04 flops=5.5e+05
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB T(to_cpu)=4.1e-05S speed=1.8e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.0278 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.774e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.188e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local oper_env: 3.802e-02 S #####
 T(local oper_env: fetch) = 9.168e-03 S  per = 24.1  per(accum) = 24.1
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 24.1
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 24.1
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 24.1
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 24.1
 T(local oper_env: renrm) = 2.865e-02 S  per = 75.4  per(accum) = 99.5
 T(local oper_env: save ) = 1.988e-04 S  per = 0.523  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.865e-02 S  T(sum) = 2.865e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.243e-06 S  per = 0.0288  per(accum) = 0.0288
 T(local oper_env: qops init                    ) = 2.656e-04 S  per = 0.927  per(accum) = 0.956
 T(local oper_env: symbolic_formulae_renorm     ) = 3.853e-04 S  per = 1.35  per(accum) = 2.3
 T(local oper_env: allocate qops on gpu         ) = 4.019e-05 S  per = 0.14  per(accum) = 2.44
 T(local oper_env: site memcpy cpu2gpu          ) = 1.974e-03 S  per = 6.89  per(accum) = 9.33
 T(local oper_env: rintermediate init           ) = 1.721e-05 S  per = 0.0601  per(accum) = 9.39
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.151e-04 S  per = 0.751  per(accum) = 10.1
 T(local oper_env: rmmtasks init                ) = 9.399e-05 S  per = 0.328  per(accum) = 10.5
 T(local oper_env: qops memset on cpu           ) = 4.300e-08 S  per = 0.00015  per(accum) = 10.5
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.473e-02 S  per = 86.3  per(accum) = 96.8
 T(local oper_env: deallocate cpu and gpu memory) = 1.883e-05 S  per = 0.0657  per(accum) = 96.9
 T(local oper_env: construct opS [ifdists=true] ) = 3.700e-08 S  per = 0.000129  per(accum) = 96.9
 T(local oper_env: reduction of opS & opH [nccl]) = 2.900e-08 S  per = 0.000101  per(accum) = 96.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.687e-05 S  per = 0.164  per(accum) = 97
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.479e-05 S  per = 0.0516  per(accum) = 97.1
 T(local oper_env: qops_pool join and erase     ) = 8.394e-04 S  per = 2.93  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.170e-07 S  per = 0.00215  per(accum) = 100
##### sweep oper_env: 1.330e+00 S #####
 T(sweep oper_env: fetch) = 1.954e-01 S  per = 14.7  per(accum) = 14.7
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(sweep oper_env: renrm) = 1.131e+00 S  per =   85  per(accum) = 99.7
 T(sweep oper_env: save ) = 4.110e-03 S  per = 0.309  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.300e+10 S  per = -3.300e+32
 T(sweep oper_env: preprocess                  ) = -3.300e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.131e+00 S  T(sum) = 1.131e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.754e-04 S  per = 0.0155  per(accum) = 0.0155
 T(sweep oper_env: qops init                    ) = 1.841e-02 S  per = 1.63  per(accum) = 1.64
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.702e-01 S  per = 15.1  per(accum) = 16.7
 T(sweep oper_env: allocate qops on gpu         ) = 1.033e-03 S  per = 0.0914  per(accum) = 16.8
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.463e-02 S  per = 2.18  per(accum) = 19
 T(sweep oper_env: rintermediate init           ) = 4.295e-02 S  per =  3.8  per(accum) = 22.8
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.019e-02 S  per = 4.44  per(accum) = 27.2
 T(sweep oper_env: rmmtasks init                ) = 6.308e-02 S  per = 5.58  per(accum) = 32.8
 T(sweep oper_env: qops memset on cpu           ) = 8.210e-07 S  per = 7.26e-05  per(accum) = 32.8
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 7.002e-01 S  per = 61.9  per(accum) = 94.7
 T(sweep oper_env: deallocate cpu and gpu memory) = 9.299e-04 S  per = 0.0823  per(accum) = 94.8
 T(sweep oper_env: construct opS [ifdists=true] ) = 8.400e-07 S  per = 7.43e-05  per(accum) = 94.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.130e-07 S  per = 5.42e-05  per(accum) = 94.8
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.339e-03 S  per = 0.295  per(accum) = 95.1
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 3.062e-04 S  per = 0.0271  per(accum) = 95.1
 T(sweep oper_env: qops_pool join and erase     ) = 2.545e-02 S  per = 2.25  per(accum) = 97.4
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.959e-02 S  per = 2.62  per(accum) = 100
----- TIMING FOR ctns::oper_env_right : 1.564e+00 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.226,0.195,1.08,0.0527,1.56
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.732e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::oper_load iomode=0 fname=./scratch/sweep/rop(0,0)
fname=./scratch/sweep/rop(0,0) size=7.451e-09GB T[load](info/setup/data/tot)=2.918e-05,1.702e-04,8.313e-06,2.077e-04 speed=3.587e-05GB/S
matrix: Hij size=(1,1)
     -1.161485695499e+02 
matrix: Sij size=(1,1)
      1.000000000000e+00 

ctns::sweep_opt maxsweep=1
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-2.980e-08 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

ctns::oper_init_dotL isym=2 ifkr=0 singlet=0
ctns::oper_save iomode=0 fname=./scratch/sweep/lop(0,0) size=1.782e-02MB:1.740e-05GB
fname=./scratch/sweep/lop(0,0) size=1.74e-05GB T[save](info/data/tot)=0.000138,8.79e-05,0.000226 speed=0.0769GB/S disk[used]=0.000509GB
----- TIMING FOR ctns::oper_init_dotL : 9.781e-03 S -----

ctns::topology::get_sweeps ifboundary=0
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(3,0)-(4,0) forward=1 cturn=0
 ibond=3 bond=(4,0)-(5,0) forward=1 cturn=0
 ibond=4 bond=(5,0)-(6,0) forward=1 cturn=0
 ibond=5 bond=(6,0)-(7,0) forward=1 cturn=0
 ibond=6 bond=(7,0)-(8,0) forward=1 cturn=0
 ibond=7 bond=(8,0)-(9,0) forward=1 cturn=0
 ibond=8 bond=(9,0)-(10,0) forward=1 cturn=0
 ibond=9 bond=(10,0)-(11,0) forward=1 cturn=0
 ibond=10 bond=(11,0)-(12,0) forward=1 cturn=0
 ibond=11 bond=(12,0)-(13,0) forward=1 cturn=0
 ibond=12 bond=(13,0)-(14,0) forward=1 cturn=0
 ibond=13 bond=(14,0)-(15,0) forward=1 cturn=0
 ibond=14 bond=(15,0)-(16,0) forward=1 cturn=0
 ibond=15 bond=(16,0)-(17,0) forward=1 cturn=0
 ibond=16 bond=(17,0)-(18,0) forward=1 cturn=0
 ibond=17 bond=(17,0)-(18,0) forward=0 cturn=0
 ibond=18 bond=(16,0)-(17,0) forward=0 cturn=0
 ibond=19 bond=(15,0)-(16,0) forward=0 cturn=0
 ibond=20 bond=(14,0)-(15,0) forward=0 cturn=0
 ibond=21 bond=(13,0)-(14,0) forward=0 cturn=0
 ibond=22 bond=(12,0)-(13,0) forward=0 cturn=0
 ibond=23 bond=(11,0)-(12,0) forward=0 cturn=0
 ibond=24 bond=(10,0)-(11,0) forward=0 cturn=0
 ibond=25 bond=(9,0)-(10,0) forward=0 cturn=0
 ibond=26 bond=(8,0)-(9,0) forward=0 cturn=0
 ibond=27 bond=(7,0)-(8,0) forward=0 cturn=0
 ibond=28 bond=(6,0)-(7,0) forward=0 cturn=0
 ibond=29 bond=(5,0)-(6,0) forward=0 cturn=0
 ibond=30 bond=(4,0)-(5,0) forward=0 cturn=0
 ibond=31 bond=(3,0)-(4,0) forward=0 cturn=0
 ibond=32 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=33 bond=(1,0)-(2,0) forward=0 cturn=0
..... end of get_sweeps .....

======================================================================
sweep parameters: isweep=0 dots=1 dcut=100 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=1 sym_state=(30,0) singlet=0
qtensor3: site0new own=1 _data=0x3a6feaa0
qinfo3: site0new sym=(0,0) dir=1,0,1
 qbond: qrow nsym=1 dimAll=1
 (0,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=4 nblocks=16 size=4:3.05e-05MB
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=274:0.00209MB:2.04e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=323:0.00246MB:2.41e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=2.369e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=0/seqsize=34 dots=1 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-6.706e-08 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=274:2.090e-03MB:2.041e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1:7.629e-06MB:7.451e-09GB
total mem of comb=323:2.464e-03MB:2.407e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=1,18,1
 suppl= 0
 suppr= 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 1
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(2,0)
 fqop[2]=./scratch/sweep/cop(1,0)
qops info: rank=0
 lqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:36 S:4 P:6 Q:10 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=7:5.34e-05MB:5.22e-08GB
        per(mem): H:14.3 C:0 S:0 P:0 Q:85.7 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=4679:0.0357MB:3.49e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.772e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.878e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(4,1,4) nnz=1:7.629e-06MB
qtensor3: wf3 own=1 _data=0x3a712ec8
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=1 dimAll=1
 (26,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=1 nblocks=16 size=1:7.629e-06MB
### DIAG TIMING: total=2.212e-02 t1=2.525e-05, t2=2.170e-03, t3=2.526e-03, t4=1.736e-02, t5=5.085e-06, t6=3.069e-05, t7=3.581e-06
duration_diagGPU:2.213e-02
duration_diagreduce:1.080e-07
duration_diagtransform:2.080e-07
----- TIMING FOR symbolic_formulae_onedot with size=123 : 1.380e-03 S -----
rank=0 GPUmem(GB): used=3.486e-05 (oper)=3.486e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=123
 no. of hintermediate operators=20
 no. of coefficients=360:2.747e-03MB:2.682e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.054e-05 S -----
rank=0 GPUmem(GB): used=3.754e-05 (oper,hinter)=3.486e-05,2.682e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.092e-04 S size(H_formulae)=123 size(Hxlst2)=1 T(Hmu/Hxlist)=2.472e-04,6.196e-05 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.177e-04 S size(H_formulae)=123 size(Hxlst)=18 -----
rank=0 GPUmem(GB): used=3.754e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.490e-08 batch[need]=4.023e-07 blksize=1 blksize0=0 batchsize=18
rank=0 GPUmem(GB): used=3.796e-05 (oper,hinter,dvdson,batch)=3.486e-05,2.682e-06,1.490e-08,4.023e-07
ctns::pdvdsonSolver_nkr::solve_iter ndim=1 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.133e-04,2.450e-03,2.972e-02,1.236e-02,4.495e-02
 analyze_tgpu[Hx]: ndim=1:7.451e-09GB T(cpu-gpu)=3.987e-04 speed=3.737e-05GB/S T(nccl)=1.456e-05 speed=1.023e-03GB/S
----- TIMING FOR sigma : t_inter=2.4e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.5e-02 -----
 sigma[inter] counter=1 t=2.4e-03 per=5.5e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=0 t=1.7e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=1 t=1.2e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=2 t=7.4e-03 per=1.7e+01 cost=1.0e+01 flops=1.3e+03
 sigma[gemm] counter=1 i=3 t=7.4e-03 per=1.7e+01 cost=1.0e+01 flops=1.3e+03
 sigma[gemm] counter=1 i=4 t=7.4e-03 per=1.7e+01 cost=1.0e+01 flops=1.4e+03
 sigma[gemm] counter=1 i=5 t=7.5e-03 per=1.7e+01 cost=1.0e+01 flops=1.3e+03
 sigma[gemm] counter=1 total t=3.0e-02 per=6.7e+01 cost=4.0e+01 flops=1.3e+03
 sigma[red] counter=1 t=1.2e-02 per=2.8e+01 cost=3.6e+01 flops=2.9e+03
----- TIMING FOR sigma_tot : t_inter=2.4e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.5e-02 -----
 sigma_tot[inter] counter=1 t=2.4e-03 per=5.5e+00 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=0 t=1.7e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=1 t=1.2e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=2 t=7.4e-03 per=1.7e+01 cost=1.0e+01 flops=1.3e+03
 sigma_tot[gemm] counter=1 i=3 t=7.4e-03 per=1.7e+01 cost=1.0e+01 flops=1.3e+03
 sigma_tot[gemm] counter=1 i=4 t=7.4e-03 per=1.7e+01 cost=1.0e+01 flops=1.4e+03
 sigma_tot[gemm] counter=1 i=5 t=7.5e-03 per=1.7e+01 cost=1.0e+01 flops=1.3e+03
 sigma_tot[gemm] counter=1 total t=3.0e-02 per=6.7e+01 cost=4.0e+01 flops=1.3e+03
 sigma_tot[red] counter=1 t=1.2e-02 per=2.8e+01 cost=3.6e+01 flops=2.9e+03
T(sub)=1.3e-05 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,7.8e-06,2.1e-06,4.0e-07,1.5e-07
settings: ndim=1 neig=1 maxcycle=30 nbuff=4 memory=2e-08GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.148569549899 -1.116e+03  0.000e+00    1     1  4.508e-02 4.508e-02 4.505e-02
TIMING FOR Davidson : 4.511e-02  T(cal/comm/rest)=4.505e-02,1.280e-07,6.172e-05
decomposed t_rest=6.172e-05
 T(sub)    =1.313e-05 per=2.128e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =3.000e-07 per=4.861e-01
 T(xnrm2)  =4.120e-07 per=6.675e-01
 T(other)  =4.788e-05 per=7.757e+01
optimized energies: isweep=0 ibond=0 dots=1 e[0]=-116.148569549899 nmvp=1
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=7.572e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=9 alg_decim=0 mpisize=1
 qbond: qsuper nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
----- TIMING FOR onedot_decimation: 1.3e-04 S T(wf/decim)=7.8e-05,5.2e-05 -----
ctns::oper_renorm coord=(1,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1352:1.0e-02MB:1.0e-05GB
        per(mem): H:2.66 C:7.1 S:63.9 A:5.62 B:20.7 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.509e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 1.440e-03 S -----
rank=0 GPUmem(GB): used=4.756e-05 (oper)=4.488e-05
rank=0 GPUmem(GB): used=4.783e-05 (oper,site)=4.488e-05,2.682e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=4.783e-05 (oper,site,rinter)=4.488e-05,2.682e-07,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 2.667e-03 S size(rtasks)=57 size(Rlst2)=81 T(Rmu/Rlist)=6.676e-04,1.999e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.896e-03 S size(rtasks)=57 size(Rlst)=1636 -----
rank=0 GPUmem(GB): used=4.783e-05 avail=6.176e+00 total=6.176e+00 batch[need]=4.022e-04 blksize=16 blksize0=0 batchsize=1636
rank=0 GPUmem(GB): used=4.501e-04 (oper,site,rinter,batch)=4.488e-05,2.682e-07,0.000e+00,4.022e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.706e-06,2.236e-02,9.948e-03
----- TIMING FOR renorm : t_inter=8.4e-06 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.2e-02 -----
 renorm[inter] counter=1 t=8.4e-06 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=1.5e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=1.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=1.1e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=3 t=1.0e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=4 t=7.3e-03 per=2.3e+01 cost=3.7e+03 flops=5.1e+05
 renorm[gemm] counter=1 i=5 t=7.5e-03 per=2.3e+01 cost=2.4e+03 flops=3.2e+05
 renorm[gemm] counter=1 i=6 t=7.5e-03 per=2.3e+01 cost=1.9e+04 flops=2.5e+06
 renorm[gemm] counter=1 total t=2.2e-02 per=6.9e+01 cost=2.5e+04 flops=1.1e+06
 renorm[red] counter=1 t=9.9e-03 per=3.1e+01 cost=1.9e+04 flops=1.9e+06
----- TIMING FOR renorm_tot : t_inter=8.4e-06 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.2e-02 -----
 renorm_tot[inter] counter=1 t=8.4e-06 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=1.5e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=1.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=1.1e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=3 t=1.0e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=4 t=7.3e-03 per=2.3e+01 cost=3.7e+03 flops=5.1e+05
 renorm_tot[gemm] counter=1 i=5 t=7.5e-03 per=2.3e+01 cost=2.4e+03 flops=3.2e+05
 renorm_tot[gemm] counter=1 i=6 t=7.5e-03 per=2.3e+01 cost=1.9e+04 flops=2.5e+06
 renorm_tot[gemm] counter=1 total t=2.2e-02 per=6.9e+01 cost=2.5e+04 flops=1.1e+06
 renorm_tot[red] counter=1 t=9.9e-03 per=3.1e+01 cost=1.9e+04 flops=1.9e+06
qops.to_cpu: size(tot)=1352:1.0e-02MB:1.0e-05GB T(to_cpu)=6.9e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0497 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.709e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.488e-03 change=-2.200e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.488e-03 change=-1.520e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.454e-01 S #####
 T(local opt: fetch) = 2.399e-02 S  per = 16.5  per(accum) = 16.5
 T(local opt: hdiag) = 2.216e-02 S  per = 15.2  per(accum) = 31.8
 T(local opt: dvdsn) = 4.728e-02 S  per = 32.5  per(accum) = 64.3
 T(local opt: decim) = 1.407e-04 S  per = 0.0968  per(accum) = 64.4
 T(local opt: guess) = 6.277e-05 S  per = 0.0432  per(accum) = 64.4
 T(local opt: renrm) = 5.144e-02 S  per = 35.4  per(accum) = 99.8
 T(local opt: save ) = 2.730e-04 S  per = 0.188  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.728e-02 S  T(sum) = 4.711e-02 S  per = 9.964e+01
 T(local opt: preprocess                  ) = 8.191e-05 S  per = 0.174  per(accum) = 0.174
 T(local opt: symbolic_formulae           ) = 1.388e-03 S  per = 2.95  per(accum) = 3.12
 T(local opt: hintermediate init          ) = 8.273e-05 S  per = 0.176  per(accum) = 3.3
 T(local opt: preprocess_hformulae_Hxlist ) = 3.239e-04 S  per = 0.688  per(accum) = 3.98
 T(local opt: hmmtasks init               ) = 1.192e-04 S  per = 0.253  per(accum) = 4.24
 T(local opt: initial guess for dvdson    ) = 2.571e-06 S  per = 0.00546  per(accum) = 4.24
 T(local opt: dvdson [Hx_batchGPU]        ) = 4.464e-02 S  per = 94.7  per(accum) = 99
 T(local opt: dvdson [cpu-gpu]            ) = 3.987e-04 S  per = 0.846  per(accum) = 99.8
 T(local opt: dvdson [nccl]               ) = 1.456e-05 S  per = 0.0309  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 1.280e-07 S  per = 0.000272  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 6.172e-05 S  per = 0.131  per(accum) = 100
Detailed decomposition of T(renrm) = 5.144e-02 S  T(sum) = 5.144e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.781e-05 S  per = 0.151  per(accum) = 0.151
 T(local opt: qops init                    ) = 8.031e-04 S  per = 1.56  per(accum) = 1.71
 T(local opt: symbolic_formulae_renorm     ) = 1.448e-03 S  per = 2.82  per(accum) = 4.53
 T(local opt: allocate qops on gpu         ) = 4.671e-05 S  per = 0.0908  per(accum) = 4.62
 T(local opt: site memcpy cpu2gpu          ) = 1.703e-03 S  per = 3.31  per(accum) = 7.93
 T(local opt: rintermediate init           ) = 2.966e-05 S  per = 0.0577  per(accum) = 7.99
 T(local opt: preprocess_formulae_Rlist2   ) = 2.954e-03 S  per = 5.74  per(accum) = 13.7
 T(local opt: rmmtasks init                ) = 1.009e-02 S  per = 19.6  per(accum) = 33.4
 T(local opt: qops memset on cpu           ) = 3.200e-08 S  per = 6.22e-05  per(accum) = 33.4
 T(local opt: preprocess_renorm_batchGPU   ) = 3.241e-02 S  per =   63  per(accum) = 96.4
 T(local opt: deallocate cpu and gpu memory) = 7.684e-05 S  per = 0.149  per(accum) = 96.5
 T(local opt: construct opS [ifdists=true] ) = 3.300e-08 S  per = 6.42e-05  per(accum) = 96.5
 T(local opt: reduction of opS & opH [nccl]) = 3.200e-08 S  per = 6.22e-05  per(accum) = 96.5
 T(local opt: qops memcpy gpu2cpu          ) = 7.667e-05 S  per = 0.149  per(accum) = 96.7
 T(local opt: reduction of opS & opH [mpi] ) = 2.364e-05 S  per = 0.0459  per(accum) = 96.7
 T(local opt: qops_pool join and erase     ) = 1.695e-03 S  per =  3.3  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.596e-06 S  per = 0.0031  per(accum) = 100
##### sweep opt: 1.454e-01 S #####
 T(sweep opt: fetch) = 2.399e-02 S  per = 16.5  per(accum) = 16.5
 T(sweep opt: hdiag) = 2.216e-02 S  per = 15.2  per(accum) = 31.8
 T(sweep opt: dvdsn) = 4.728e-02 S  per = 32.5  per(accum) = 64.3
 T(sweep opt: decim) = 1.407e-04 S  per = 0.0968  per(accum) = 64.4
 T(sweep opt: guess) = 6.277e-05 S  per = 0.0432  per(accum) = 64.4
 T(sweep opt: renrm) = 5.144e-02 S  per = 35.4  per(accum) = 99.8
 T(sweep opt: save ) = 2.730e-04 S  per = 0.188  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.728e-02 S  T(sum) = 4.711e-02 S  per = 9.964e+01
 T(sweep opt: preprocess                  ) = 8.191e-05 S  per = 0.174  per(accum) = 0.174
 T(sweep opt: symbolic_formulae           ) = 1.388e-03 S  per = 2.95  per(accum) = 3.12
 T(sweep opt: hintermediate init          ) = 8.273e-05 S  per = 0.176  per(accum) = 3.3
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.239e-04 S  per = 0.688  per(accum) = 3.98
 T(sweep opt: hmmtasks init               ) = 1.192e-04 S  per = 0.253  per(accum) = 4.24
 T(sweep opt: initial guess for dvdson    ) = 2.571e-06 S  per = 0.00546  per(accum) = 4.24
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.464e-02 S  per = 94.7  per(accum) = 99
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.987e-04 S  per = 0.846  per(accum) = 99.8
 T(sweep opt: dvdson [nccl]               ) = 1.456e-05 S  per = 0.0309  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 1.280e-07 S  per = 0.000272  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.172e-05 S  per = 0.131  per(accum) = 100
Detailed decomposition of T(renrm) = 5.144e-02 S  T(sum) = 5.144e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.781e-05 S  per = 0.151  per(accum) = 0.151
 T(sweep opt: qops init                    ) = 8.031e-04 S  per = 1.56  per(accum) = 1.71
 T(sweep opt: symbolic_formulae_renorm     ) = 1.448e-03 S  per = 2.82  per(accum) = 4.53
 T(sweep opt: allocate qops on gpu         ) = 4.671e-05 S  per = 0.0908  per(accum) = 4.62
 T(sweep opt: site memcpy cpu2gpu          ) = 1.703e-03 S  per = 3.31  per(accum) = 7.93
 T(sweep opt: rintermediate init           ) = 2.966e-05 S  per = 0.0577  per(accum) = 7.99
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.954e-03 S  per = 5.74  per(accum) = 13.7
 T(sweep opt: rmmtasks init                ) = 1.009e-02 S  per = 19.6  per(accum) = 33.4
 T(sweep opt: qops memset on cpu           ) = 3.200e-08 S  per = 6.22e-05  per(accum) = 33.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.241e-02 S  per =   63  per(accum) = 96.4
 T(sweep opt: deallocate cpu and gpu memory) = 7.684e-05 S  per = 0.149  per(accum) = 96.5
 T(sweep opt: construct opS [ifdists=true] ) = 3.300e-08 S  per = 6.42e-05  per(accum) = 96.5
 T(sweep opt: reduction of opS & opH [nccl]) = 3.200e-08 S  per = 6.22e-05  per(accum) = 96.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.667e-05 S  per = 0.149  per(accum) = 96.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.364e-05 S  per = 0.0459  per(accum) = 96.7
 T(sweep opt: qops_pool join and erase     ) = 1.695e-03 S  per =  3.3  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.596e-06 S  per = 0.0031  per(accum) = 100
##### global opt: 1.454e-01 S #####
 T(global opt: fetch) = 2.399e-02 S  per = 16.5  per(accum) = 16.5
 T(global opt: hdiag) = 2.216e-02 S  per = 15.2  per(accum) = 31.8
 T(global opt: dvdsn) = 4.728e-02 S  per = 32.5  per(accum) = 64.3
 T(global opt: decim) = 1.407e-04 S  per = 0.0968  per(accum) = 64.4
 T(global opt: guess) = 6.277e-05 S  per = 0.0432  per(accum) = 64.4
 T(global opt: renrm) = 5.144e-02 S  per = 35.4  per(accum) = 99.8
 T(global opt: save ) = 2.730e-04 S  per = 0.188  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.728e-02 S  T(sum) = 4.711e-02 S  per = 9.964e+01
 T(global opt: preprocess                  ) = 8.191e-05 S  per = 0.174  per(accum) = 0.174
 T(global opt: symbolic_formulae           ) = 1.388e-03 S  per = 2.95  per(accum) = 3.12
 T(global opt: hintermediate init          ) = 8.273e-05 S  per = 0.176  per(accum) = 3.3
 T(global opt: preprocess_hformulae_Hxlist ) = 3.239e-04 S  per = 0.688  per(accum) = 3.98
 T(global opt: hmmtasks init               ) = 1.192e-04 S  per = 0.253  per(accum) = 4.24
 T(global opt: initial guess for dvdson    ) = 2.571e-06 S  per = 0.00546  per(accum) = 4.24
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.464e-02 S  per = 94.7  per(accum) = 99
 T(global opt: dvdson [cpu-gpu]            ) = 3.987e-04 S  per = 0.846  per(accum) = 99.8
 T(global opt: dvdson [nccl]               ) = 1.456e-05 S  per = 0.0309  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 1.280e-07 S  per = 0.000272  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 6.172e-05 S  per = 0.131  per(accum) = 100
Detailed decomposition of T(renrm) = 5.144e-02 S  T(sum) = 5.144e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.781e-05 S  per = 0.151  per(accum) = 0.151
 T(global opt: qops init                    ) = 8.031e-04 S  per = 1.56  per(accum) = 1.71
 T(global opt: symbolic_formulae_renorm     ) = 1.448e-03 S  per = 2.82  per(accum) = 4.53
 T(global opt: allocate qops on gpu         ) = 4.671e-05 S  per = 0.0908  per(accum) = 4.62
 T(global opt: site memcpy cpu2gpu          ) = 1.703e-03 S  per = 3.31  per(accum) = 7.93
 T(global opt: rintermediate init           ) = 2.966e-05 S  per = 0.0577  per(accum) = 7.99
 T(global opt: preprocess_formulae_Rlist2   ) = 2.954e-03 S  per = 5.74  per(accum) = 13.7
 T(global opt: rmmtasks init                ) = 1.009e-02 S  per = 19.6  per(accum) = 33.4
 T(global opt: qops memset on cpu           ) = 3.200e-08 S  per = 6.22e-05  per(accum) = 33.4
 T(global opt: preprocess_renorm_batchGPU   ) = 3.241e-02 S  per =   63  per(accum) = 96.4
 T(global opt: deallocate cpu and gpu memory) = 7.684e-05 S  per = 0.149  per(accum) = 96.5
 T(global opt: construct opS [ifdists=true] ) = 3.300e-08 S  per = 6.42e-05  per(accum) = 96.5
 T(global opt: reduction of opS & opH [nccl]) = 3.200e-08 S  per = 6.22e-05  per(accum) = 96.5
 T(global opt: qops memcpy gpu2cpu          ) = 7.667e-05 S  per = 0.149  per(accum) = 96.7
 T(global opt: reduction of opS & opH [mpi] ) = 2.364e-05 S  per = 0.0459  per(accum) = 96.7
 T(global opt: qops_pool join and erase     ) = 1.695e-03 S  per =  3.3  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.596e-06 S  per = 0.0031  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-7.498e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=1/seqsize=34 dots=1 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=309:2.357e-03MB:2.302e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=4:3.052e-05MB:2.980e-08GB
total mem of comb=361:2.754e-03MB:2.690e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=2,17,1
 suppl= 0 1
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 2
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:2.747e-04MB size(tot)=1352:1.031e-02MB:1.007e-05GB
        per(mem): H:2.66 C:7.1 S:63.9 A:5.62 B:20.7 
 rqops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=46:0.000351MB:3.43e-07GB
        per(mem): H:4.35 C:37 S:6.52 P:0 Q:52.2 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3734:0.0285MB:2.78e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.091e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(16,2,4) nnz=4:3.052e-05MB
qtensor3: wf3 own=1 _data=0x3a6fea40
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
 qbond: qcol nsym=2 dimAll=2
 (25,-1):1 (24,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=72 size=4:3.052e-05MB
### DIAG TIMING: total=4.191e-02 t1=2.286e-05, t2=2.223e-03, t3=2.517e-03, t4=3.712e-02, t5=5.221e-06, t6=1.438e-05, t7=3.374e-06
duration_diagGPU:4.192e-02
duration_diagreduce:6.300e-08
duration_diagtransform:2.720e-07
----- TIMING FOR symbolic_formulae_onedot with size=193 : 2.990e-03 S -----
rank=0 GPUmem(GB): used=2.782e-05 (oper)=2.782e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=193
 no. of hintermediate operators=58
 no. of coefficients=986:7.523e-03MB:7.346e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 9.148e-05 S -----
rank=0 GPUmem(GB): used=3.517e-05 (oper,hinter)=2.782e-05,7.346e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.579e-04 S size(H_formulae)=193 size(Hxlst2)=3 T(Hmu/Hxlist)=4.225e-04,3.354e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.815e-04 S size(H_formulae)=193 size(Hxlst)=216 -----
rank=0 GPUmem(GB): used=3.517e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=5.960e-08 batch[need]=9.656e-06 blksize=2 blksize0=1 batchsize=216
rank=0 GPUmem(GB): used=4.488e-05 (oper,hinter,dvdson,batch)=2.782e-05,7.346e-06,5.960e-08,9.656e-06
ctns::pdvdsonSolver_nkr::solve_iter ndim=4 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.022e-03,9.963e-03,3.000e-02,1.258e-02,5.457e-02
 analyze_tgpu[Hx]: ndim=4:2.980e-08GB T(cpu-gpu)=2.017e-03 speed=2.955e-05GB/S T(nccl)=5.206e-06 speed=1.145e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=2 t=1.0e-02 per=1.9e+01 cost=1.1e+03 flops=1.1e+05
 sigma[gemm] counter=2 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=2 t=7.5e-03 per=1.4e+01 cost=2.2e+02 flops=3.0e+04
 sigma[gemm] counter=2 i=3 t=7.5e-03 per=1.4e+01 cost=1.9e+02 flops=2.5e+04
 sigma[gemm] counter=2 i=4 t=7.6e-03 per=1.4e+01 cost=2.9e+02 flops=3.9e+04
 sigma[gemm] counter=2 i=5 t=7.5e-03 per=1.4e+01 cost=2.9e+02 flops=3.9e+04
 sigma[gemm] counter=2 total t=3.0e-02 per=5.7e+01 cost=9.9e+02 flops=3.3e+04
 sigma[red] counter=2 t=1.3e-02 per=2.4e+01 cost=5.6e+02 flops=4.4e+04
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.0e-02 t_reduction=2.5e-02 tot=9.7e-02 -----
 sigma_tot[inter] counter=2 t=1.2e-02 per=1.3e+01 cost=1.1e+03 flops=8.8e+04
 sigma_tot[gemm] counter=2 i=0 t=3.1e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=1 t=2.4e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=2 t=1.5e-02 per=1.5e+01 cost=2.3e+02 flops=1.6e+04
 sigma_tot[gemm] counter=2 i=3 t=1.5e-02 per=1.5e+01 cost=2.0e+02 flops=1.3e+04
 sigma_tot[gemm] counter=2 i=4 t=1.5e-02 per=1.5e+01 cost=3.0e+02 flops=2.0e+04
 sigma_tot[gemm] counter=2 i=5 t=1.5e-02 per=1.5e+01 cost=3.0e+02 flops=2.0e+04
 sigma_tot[gemm] counter=2 total t=6.0e-02 per=6.2e+01 cost=1.0e+03 flops=1.7e+04
 sigma_tot[red] counter=2 t=2.5e-02 per=2.6e+01 cost=5.9e+02 flops=2.4e+04
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.8e-06,1.9e-06,9.2e-07,1.6e-07
settings: ndim=4 neig=1 maxcycle=30 nbuff=4 memory=4e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.148569549899 -1.116e+03  5.980e-02    1     1  5.468e-02 5.468e-02 5.466e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.273e-03,9.973e-03,2.984e-02,1.257e-02,5.366e-02
 analyze_tgpu[Hx]: ndim=4:2.980e-08GB T(cpu-gpu)=1.268e-03 speed=4.701e-05GB/S T(nccl)=5.187e-06 speed=1.149e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=3 t=1.0e-02 per=1.9e+01 cost=1.1e+03 flops=1.1e+05
 sigma[gemm] counter=3 i=0 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=2 t=7.4e-03 per=1.4e+01 cost=2.2e+02 flops=3.0e+04
 sigma[gemm] counter=3 i=3 t=7.4e-03 per=1.4e+01 cost=1.9e+02 flops=2.5e+04
 sigma[gemm] counter=3 i=4 t=7.5e-03 per=1.4e+01 cost=2.9e+02 flops=3.9e+04
 sigma[gemm] counter=3 i=5 t=7.5e-03 per=1.4e+01 cost=2.9e+02 flops=3.9e+04
 sigma[gemm] counter=3 total t=3.0e-02 per=5.7e+01 cost=9.9e+02 flops=3.3e+04
 sigma[red] counter=3 t=1.3e-02 per=2.4e+01 cost=5.6e+02 flops=4.4e+04
----- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=9.0e-02 t_reduction=3.8e-02 tot=1.5e-01 -----
 sigma_tot[inter] counter=3 t=2.2e-02 per=1.5e+01 cost=2.2e+03 flops=9.7e+04
 sigma_tot[gemm] counter=3 i=0 t=4.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=1 t=3.7e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=2 t=2.2e-02 per=1.5e+01 cost=4.5e+02 flops=2.0e+04
 sigma_tot[gemm] counter=3 i=3 t=2.2e-02 per=1.5e+01 cost=3.9e+02 flops=1.7e+04
 sigma_tot[gemm] counter=3 i=4 t=2.2e-02 per=1.5e+01 cost=5.9e+02 flops=2.7e+04
 sigma_tot[gemm] counter=3 i=5 t=2.3e-02 per=1.5e+01 cost=5.9e+02 flops=2.6e+04
 sigma_tot[gemm] counter=3 total t=9.0e-02 per=6.0e+01 cost=2.0e+03 flops=2.3e+04
 sigma_tot[red] counter=3 t=3.8e-02 per=2.5e+01 cost=1.1e+03 flops=3.1e+04
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=7.2e-06,2.4e-05,3.4e-06,1.2e-06,1.4e-07
    2   0 -    -116.178903884613 -3.033e-02  3.333e-03    2     2  1.180e-01 5.901e-02 5.421e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.229e-03,1.215e-02,2.988e-02,1.261e-02,5.588e-02
 analyze_tgpu[Hx]: ndim=4:2.980e-08GB T(cpu-gpu)=1.224e-03 speed=4.870e-05GB/S T(nccl)=4.893e-06 speed=1.218e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.5e-02 -----
 sigma[inter] counter=4 t=1.2e-02 per=2.2e+01 cost=1.1e+03 flops=9.0e+04
 sigma[gemm] counter=4 i=0 t=1.4e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=2 t=7.4e-03 per=1.4e+01 cost=2.2e+02 flops=3.0e+04
 sigma[gemm] counter=4 i=3 t=7.4e-03 per=1.4e+01 cost=1.9e+02 flops=2.5e+04
 sigma[gemm] counter=4 i=4 t=7.4e-03 per=1.4e+01 cost=2.9e+02 flops=3.9e+04
 sigma[gemm] counter=4 i=5 t=7.6e-03 per=1.4e+01 cost=2.9e+02 flops=3.9e+04
 sigma[gemm] counter=4 total t=3.0e-02 per=5.5e+01 cost=9.9e+02 flops=3.3e+04
 sigma[red] counter=4 t=1.3e-02 per=2.3e+01 cost=5.6e+02 flops=4.4e+04
----- TIMING FOR sigma_tot : t_inter=3.5e-02 t_gemm=1.2e-01 t_reduction=5.0e-02 tot=2.0e-01 -----
 sigma_tot[inter] counter=4 t=3.5e-02 per=1.7e+01 cost=3.3e+03 flops=9.5e+04
 sigma_tot[gemm] counter=4 i=0 t=6.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=1 t=4.9e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=2 t=3.0e-02 per=1.5e+01 cost=6.8e+02 flops=2.3e+04
 sigma_tot[gemm] counter=4 i=3 t=3.0e-02 per=1.5e+01 cost=5.7e+02 flops=1.9e+04
 sigma_tot[gemm] counter=4 i=4 t=3.0e-02 per=1.5e+01 cost=8.9e+02 flops=3.0e+04
 sigma_tot[gemm] counter=4 i=5 t=3.0e-02 per=1.5e+01 cost=8.9e+02 flops=2.9e+04
 sigma_tot[gemm] counter=4 total t=1.2e-01 per=5.9e+01 cost=3.0e+03 flops=2.5e+04
 sigma_tot[red] counter=4 t=5.0e-02 per=2.5e+01 cost=1.7e+03 flops=3.4e+04
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.7e-05,2.8e-06,1.2e-06,1.8e-07
    3   0 +    -116.178979049791 -7.517e-05  3.004e-07    3     3  1.836e-01 6.119e-02 5.480e-02
TIMING FOR Davidson : 1.836e-01  T(cal/comm/rest)=1.644e-01,3.250e-07,1.919e-02
decomposed t_rest=1.919e-02
 T(sub)    =7.185e-05 per=3.744e-01
 T(precond)=1.904e-02 per=9.924e+01
 T(ortho)  =7.014e-06 per=3.655e-02
 T(xcopy)  =4.530e-07 per=2.361e-03
 T(xnrm2)  =1.135e-06 per=5.915e-03
 T(other)  =6.617e-05 per=3.449e-01
optimized energies: isweep=0 ibond=1 dots=1 e[0]=-116.178979049791 nmvp=3
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.025e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=16 alg_decim=0 mpisize=1
 qbond: qsuper nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
decimation summary: keep all 64 states
----- TIMING FOR onedot_decimation: 1.6e-04 S T(wf/decim)=7.1e-05,9.2e-05 -----
ctns::oper_renorm coord=(2,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:3.1e-03MB size(tot)=21970:1.7e-01MB:1.6e-04GB
        per(mem): H:1.82 C:8.19 S:46.4 A:12.5 B:31.1 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.974e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 3.058e-03 S -----
rank=0 GPUmem(GB): used=1.985e-04 (oper)=1.912e-04
rank=0 GPUmem(GB): used=2.015e-04 (oper,site)=1.912e-04,2.980e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=176
 no. of coefficients=745:5.684e-03MB:5.551e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.505e-03 S -----
rank=0 GPUmem(GB): used=2.070e-04 (oper,site,rinter)=1.912e-04,2.980e-06,5.551e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 8.837e-03 S size(rtasks)=77 size(Rlst2)=256 T(Rmu/Rlist)=1.194e-03,7.643e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.406e-03 S size(rtasks)=77 size(Rlst)=6692 -----
rank=0 GPUmem(GB): used=2.070e-04 avail=6.176e+00 total=6.176e+00 batch[need]=8.925e-03 blksize=81 blksize0=16 batchsize=6692
rank=0 GPUmem(GB): used=9.132e-03 (oper,site,rinter,batch)=1.912e-04,2.980e-06,5.551e-06,8.925e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.147e-03,2.295e-02,1.015e-02
----- TIMING FOR renorm : t_inter=7.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=2 t=7.1e-03 per=1.8e+01 cost=8.5e+04 flops=1.2e+07
 renorm[gemm] counter=2 i=0 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=1 t=1.0e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=2 t=9.4e-07 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=3 t=9.4e-07 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=4 t=7.7e-03 per=1.9e+01 cost=1.7e+05 flops=2.2e+07
 renorm[gemm] counter=2 i=5 t=7.6e-03 per=1.9e+01 cost=1.5e+05 flops=2.0e+07
 renorm[gemm] counter=2 i=6 t=7.7e-03 per=1.9e+01 cost=1.2e+06 flops=1.5e+08
 renorm[gemm] counter=2 total t=2.3e-02 per=5.7e+01 cost=1.5e+06 flops=6.6e+07
 renorm[red] counter=2 t=1.0e-02 per=2.5e+01 cost=5.3e+05 flops=5.3e+07
----- TIMING FOR renorm_tot : t_inter=7.2e-03 t_gemm=4.5e-02 t_reduction=2.0e-02 tot=7.3e-02 -----
 renorm_tot[inter] counter=2 t=7.2e-03 per=9.9e+00 cost=8.5e+04 flops=1.2e+07
 renorm_tot[gemm] counter=2 i=0 t=2.7e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=1 t=2.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=2 t=2.0e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=3 t=2.0e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=4 t=1.5e-02 per=2.1e+01 cost=1.8e+05 flops=1.2e+07
 renorm_tot[gemm] counter=2 i=5 t=1.5e-02 per=2.1e+01 cost=1.6e+05 flops=1.0e+07
 renorm_tot[gemm] counter=2 i=6 t=1.5e-02 per=2.1e+01 cost=1.2e+06 flops=7.9e+07
 renorm_tot[gemm] counter=2 total t=4.5e-02 per=6.2e+01 cost=1.5e+06 flops=3.4e+07
 renorm_tot[red] counter=2 t=2.0e-02 per=2.8e+01 cost=5.5e+05 flops=2.7e+07
qops.to_cpu: size(tot)=21970:1.7e-01MB:1.6e-04GB T(to_cpu)=1.3e-04S speed=1.2e+00GB/S
check ||H-H.dagger||=1.178e-16 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.107 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.541e-03 change=1.868e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.815e-03 change=-2.683e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.815e-03 change=-6.437e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 3.497e-01 S #####
 T(local opt: fetch) = 1.018e-02 S  per = 2.91  per(accum) = 2.91
 T(local opt: hdiag) = 4.196e-02 S  per =   12  per(accum) = 14.9
 T(local opt: dvdsn) = 1.887e-01 S  per =   54  per(accum) = 68.9
 T(local opt: decim) = 1.703e-04 S  per = 0.0487  per(accum) = 68.9
 T(local opt: guess) = 1.023e-04 S  per = 0.0292  per(accum) = 68.9
 T(local opt: renrm) = 1.082e-01 S  per = 30.9  per(accum) = 99.9
 T(local opt: save ) = 3.624e-04 S  per = 0.104  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.887e-01 S  T(sum) = 1.886e-01 S  per = 9.992e+01
 T(local opt: preprocess                  ) = 1.465e-04 S  per = 0.0777  per(accum) = 0.0777
 T(local opt: symbolic_formulae           ) = 2.998e-03 S  per = 1.59  per(accum) = 1.67
 T(local opt: hintermediate init          ) = 1.056e-04 S  per = 0.056  per(accum) = 1.72
 T(local opt: preprocess_hformulae_Hxlist ) = 7.913e-04 S  per = 0.42  per(accum) = 2.14
 T(local opt: hmmtasks init               ) = 9.334e-04 S  per = 0.495  per(accum) = 2.64
 T(local opt: initial guess for dvdson    ) = 2.757e-06 S  per = 0.00146  per(accum) = 2.64
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.599e-01 S  per = 84.8  per(accum) = 87.4
 T(local opt: dvdson [cpu-gpu]            ) = 4.509e-03 S  per = 2.39  per(accum) = 89.8
 T(local opt: dvdson [nccl]               ) = 1.529e-05 S  per = 0.00811  per(accum) = 89.8
 T(local opt: dvdson [mpi]                ) = 3.250e-07 S  per = 0.000172  per(accum) = 89.8
 T(local opt: dvdson [rest part(linalg)]  ) = 1.919e-02 S  per = 10.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.082e-01 S  T(sum) = 1.082e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.351e-04 S  per = 0.125  per(accum) = 0.125
 T(local opt: qops init                    ) = 1.831e-03 S  per = 1.69  per(accum) = 1.82
 T(local opt: symbolic_formulae_renorm     ) = 3.068e-03 S  per = 2.83  per(accum) = 4.65
 T(local opt: allocate qops on gpu         ) = 4.585e-05 S  per = 0.0424  per(accum) = 4.69
 T(local opt: site memcpy cpu2gpu          ) = 1.070e-03 S  per = 0.989  per(accum) = 5.68
 T(local opt: rintermediate init           ) = 2.514e-03 S  per = 2.32  per(accum) = 8.01
 T(local opt: preprocess_formulae_Rlist2   ) = 9.767e-03 S  per = 9.03  per(accum) = 17
 T(local opt: rmmtasks init                ) = 4.767e-02 S  per =   44  per(accum) = 61.1
 T(local opt: qops memset on cpu           ) = 3.600e-08 S  per = 3.33e-05  per(accum) = 61.1
 T(local opt: preprocess_renorm_batchGPU   ) = 4.032e-02 S  per = 37.3  per(accum) = 98.3
 T(local opt: deallocate cpu and gpu memory) = 4.196e-04 S  per = 0.388  per(accum) = 98.7
 T(local opt: construct opS [ifdists=true] ) = 3.200e-08 S  per = 2.96e-05  per(accum) = 98.7
 T(local opt: reduction of opS & opH [nccl]) = 4.100e-08 S  per = 3.79e-05  per(accum) = 98.7
 T(local opt: qops memcpy gpu2cpu          ) = 1.456e-04 S  per = 0.135  per(accum) = 98.9
 T(local opt: reduction of opS & opH [mpi] ) = 4.381e-05 S  per = 0.0405  per(accum) = 98.9
 T(local opt: qops_pool join and erase     ) = 1.186e-03 S  per =  1.1  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.483e-06 S  per = 0.00137  per(accum) = 100
##### sweep opt: 4.950e-01 S #####
 T(sweep opt: fetch) = 3.417e-02 S  per =  6.9  per(accum) = 6.9
 T(sweep opt: hdiag) = 6.412e-02 S  per =   13  per(accum) = 19.9
 T(sweep opt: dvdsn) = 2.360e-01 S  per = 47.7  per(accum) = 67.5
 T(sweep opt: decim) = 3.110e-04 S  per = 0.0628  per(accum) = 67.6
 T(sweep opt: guess) = 1.650e-04 S  per = 0.0333  per(accum) = 67.6
 T(sweep opt: renrm) = 1.597e-01 S  per = 32.3  per(accum) = 99.9
 T(sweep opt: save ) = 6.354e-04 S  per = 0.128  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.360e-01 S  T(sum) = 2.357e-01 S  per = 9.987e+01
 T(sweep opt: preprocess                  ) = 2.284e-04 S  per = 0.0969  per(accum) = 0.0969
 T(sweep opt: symbolic_formulae           ) = 4.387e-03 S  per = 1.86  per(accum) = 1.96
 T(sweep opt: hintermediate init          ) = 1.883e-04 S  per = 0.0799  per(accum) = 2.04
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.115e-03 S  per = 0.473  per(accum) = 2.51
 T(sweep opt: hmmtasks init               ) = 1.053e-03 S  per = 0.447  per(accum) = 2.96
 T(sweep opt: initial guess for dvdson    ) = 5.328e-06 S  per = 0.00226  per(accum) = 2.96
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.045e-01 S  per = 86.8  per(accum) = 89.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.907e-03 S  per = 2.08  per(accum) = 91.8
 T(sweep opt: dvdson [nccl]               ) = 2.985e-05 S  per = 0.0127  per(accum) = 91.8
 T(sweep opt: dvdson [mpi]                ) = 4.530e-07 S  per = 0.000192  per(accum) = 91.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.925e-02 S  per = 8.17  per(accum) = 100
Detailed decomposition of T(renrm) = 1.597e-01 S  T(sum) = 1.597e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.129e-04 S  per = 0.133  per(accum) = 0.133
 T(sweep opt: qops init                    ) = 2.635e-03 S  per = 1.65  per(accum) = 1.78
 T(sweep opt: symbolic_formulae_renorm     ) = 4.516e-03 S  per = 2.83  per(accum) = 4.61
 T(sweep opt: allocate qops on gpu         ) = 9.255e-05 S  per = 0.058  per(accum) = 4.67
 T(sweep opt: site memcpy cpu2gpu          ) = 2.773e-03 S  per = 1.74  per(accum) = 6.41
 T(sweep opt: rintermediate init           ) = 2.544e-03 S  per = 1.59  per(accum) = 8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.272e-02 S  per = 7.97  per(accum) = 16
 T(sweep opt: rmmtasks init                ) = 5.776e-02 S  per = 36.2  per(accum) = 52.1
 T(sweep opt: qops memset on cpu           ) = 6.800e-08 S  per = 4.26e-05  per(accum) = 52.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.273e-02 S  per = 45.6  per(accum) = 97.7
 T(sweep opt: deallocate cpu and gpu memory) = 4.964e-04 S  per = 0.311  per(accum) = 98
 T(sweep opt: construct opS [ifdists=true] ) = 6.500e-08 S  per = 4.07e-05  per(accum) = 98
 T(sweep opt: reduction of opS & opH [nccl]) = 7.300e-08 S  per = 4.57e-05  per(accum) = 98
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.223e-04 S  per = 0.139  per(accum) = 98.2
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.744e-05 S  per = 0.0422  per(accum) = 98.2
 T(sweep opt: qops_pool join and erase     ) = 2.881e-03 S  per =  1.8  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 3.079e-06 S  per = 0.00193  per(accum) = 100
##### global opt: 4.950e-01 S #####
 T(global opt: fetch) = 3.417e-02 S  per =  6.9  per(accum) = 6.9
 T(global opt: hdiag) = 6.412e-02 S  per =   13  per(accum) = 19.9
 T(global opt: dvdsn) = 2.360e-01 S  per = 47.7  per(accum) = 67.5
 T(global opt: decim) = 3.110e-04 S  per = 0.0628  per(accum) = 67.6
 T(global opt: guess) = 1.650e-04 S  per = 0.0333  per(accum) = 67.6
 T(global opt: renrm) = 1.597e-01 S  per = 32.3  per(accum) = 99.9
 T(global opt: save ) = 6.354e-04 S  per = 0.128  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.360e-01 S  T(sum) = 2.357e-01 S  per = 9.987e+01
 T(global opt: preprocess                  ) = 2.284e-04 S  per = 0.0969  per(accum) = 0.0969
 T(global opt: symbolic_formulae           ) = 4.387e-03 S  per = 1.86  per(accum) = 1.96
 T(global opt: hintermediate init          ) = 1.883e-04 S  per = 0.0799  per(accum) = 2.04
 T(global opt: preprocess_hformulae_Hxlist ) = 1.115e-03 S  per = 0.473  per(accum) = 2.51
 T(global opt: hmmtasks init               ) = 1.053e-03 S  per = 0.447  per(accum) = 2.96
 T(global opt: initial guess for dvdson    ) = 5.328e-06 S  per = 0.00226  per(accum) = 2.96
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.045e-01 S  per = 86.8  per(accum) = 89.7
 T(global opt: dvdson [cpu-gpu]            ) = 4.907e-03 S  per = 2.08  per(accum) = 91.8
 T(global opt: dvdson [nccl]               ) = 2.985e-05 S  per = 0.0127  per(accum) = 91.8
 T(global opt: dvdson [mpi]                ) = 4.530e-07 S  per = 0.000192  per(accum) = 91.8
 T(global opt: dvdson [rest part(linalg)]  ) = 1.925e-02 S  per = 8.17  per(accum) = 100
Detailed decomposition of T(renrm) = 1.597e-01 S  T(sum) = 1.597e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.129e-04 S  per = 0.133  per(accum) = 0.133
 T(global opt: qops init                    ) = 2.635e-03 S  per = 1.65  per(accum) = 1.78
 T(global opt: symbolic_formulae_renorm     ) = 4.516e-03 S  per = 2.83  per(accum) = 4.61
 T(global opt: allocate qops on gpu         ) = 9.255e-05 S  per = 0.058  per(accum) = 4.67
 T(global opt: site memcpy cpu2gpu          ) = 2.773e-03 S  per = 1.74  per(accum) = 6.41
 T(global opt: rintermediate init           ) = 2.544e-03 S  per = 1.59  per(accum) = 8
 T(global opt: preprocess_formulae_Rlist2   ) = 1.272e-02 S  per = 7.97  per(accum) = 16
 T(global opt: rmmtasks init                ) = 5.776e-02 S  per = 36.2  per(accum) = 52.1
 T(global opt: qops memset on cpu           ) = 6.800e-08 S  per = 4.26e-05  per(accum) = 52.1
 T(global opt: preprocess_renorm_batchGPU   ) = 7.273e-02 S  per = 45.6  per(accum) = 97.7
 T(global opt: deallocate cpu and gpu memory) = 4.964e-04 S  per = 0.311  per(accum) = 98
 T(global opt: construct opS [ifdists=true] ) = 6.500e-08 S  per = 4.07e-05  per(accum) = 98
 T(global opt: reduction of opS & opH [nccl]) = 7.300e-08 S  per = 4.57e-05  per(accum) = 98
 T(global opt: qops memcpy gpu2cpu          ) = 2.223e-04 S  per = 0.139  per(accum) = 98.2
 T(global opt: reduction of opS & opH [mpi] ) = 6.744e-05 S  per = 0.0422  per(accum) = 98.2
 T(global opt: qops_pool join and erase     ) = 2.881e-03 S  per =  1.8  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 3.079e-06 S  per = 0.00193  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.985e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=2/seqsize=34 dots=1 dbond=(3,0)-(4,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=707:5.394e-03MB:5.268e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=14:1.068e-04MB:1.043e-07GB
total mem of comb=769:5.867e-03MB:5.729e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=3,16,1
 suppl= 0 1 2
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 3
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:3.052e-03MB size(tot)=21970:1.676e-01MB:1.637e-04GB
        per(mem): H:1.82 C:8.19 S:46.4 A:12.5 B:31.1 
 rqops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=24451:0.187MB:0.000182GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.208e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(3,0) fdel=./scratch/sweep/rop(4,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.345e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(64,3,4) nnz=14:1.068e-04MB
qtensor3: wf3 own=1 _data=0x459d3110
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
 qbond: qcol nsym=2 dimAll=3
 (23,-1):2 (24,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=4 nblocks=128 size=14:1.068e-04MB
### DIAG TIMING: total=4.480e-02 t1=2.283e-05, t2=2.219e-03, t3=2.502e-03, t4=4.000e-02, t5=2.609e-05, t6=2.119e-05, t7=7.471e-06
duration_diagGPU:4.483e-02
duration_diagreduce:8.100e-08
duration_diagtransform:4.820e-07
----- TIMING FOR symbolic_formulae_onedot with size=297 : 4.943e-03 S -----
rank=0 GPUmem(GB): used=1.822e-04 (oper)=1.822e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=297
 no. of hintermediate operators=114
 no. of coefficients=1824:1.392e-02MB:1.359e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.271e-04 S -----
rank=0 GPUmem(GB): used=1.958e-04 (oper,hinter)=1.822e-04,1.359e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.374e-03 S size(H_formulae)=297 size(Hxlst2)=4 T(Hmu/Hxlist)=7.225e-04,6.511e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.454e-03 S size(H_formulae)=297 size(Hxlst)=438 -----
rank=0 GPUmem(GB): used=1.958e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.086e-07 batch[need]=4.895e-05 blksize=6 blksize0=2 batchsize=438
rank=0 GPUmem(GB): used=2.449e-04 (oper,hinter,dvdson,batch)=1.822e-04,1.359e-05,2.086e-07,4.895e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=14 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.335e-03,1.004e-02,2.979e-02,1.238e-02,5.355e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=1.330e-03 speed=1.569e-04GB/S T(nccl)=5.187e-06 speed=4.022e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=5 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=5 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=1 t=1.0e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=5 i=3 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=5 i=4 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=5 i=5 t=7.4e-03 per=1.4e+01 cost=3.6e+03 flops=4.8e+05
 sigma[gemm] counter=5 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=5 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=4.5e-02 t_gemm=1.5e-01 t_reduction=6.2e-02 tot=2.6e-01 -----
 sigma_tot[inter] counter=5 t=4.5e-02 per=1.7e+01 cost=7.9e+03 flops=1.8e+05
 sigma_tot[gemm] counter=5 i=0 t=7.4e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=1 t=6.0e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=2 t=3.7e-02 per=1.5e+01 cost=2.4e+03 flops=6.5e+04
 sigma_tot[gemm] counter=5 i=3 t=3.7e-02 per=1.5e+01 cost=2.2e+03 flops=6.0e+04
 sigma_tot[gemm] counter=5 i=4 t=3.7e-02 per=1.5e+01 cost=4.6e+03 flops=1.2e+05
 sigma_tot[gemm] counter=5 i=5 t=3.7e-02 per=1.5e+01 cost=4.5e+03 flops=1.2e+05
 sigma_tot[gemm] counter=5 total t=1.5e-01 per=5.8e+01 cost=1.4e+04 flops=9.2e+04
 sigma_tot[red] counter=5 t=6.2e-02 per=2.4e+01 cost=4.9e+03 flops=7.9e+04
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.3e-05,6.1e-06,2.0e-06,1.5e-06,2.0e-07
settings: ndim=14 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.178979049791 -1.116e+03  6.213e-02    1     1  5.367e-02 5.367e-02 5.363e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.162e-04,1.157e-02,2.793e-02,1.237e-02,5.229e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=4.091e-04 speed=5.100e-04GB/S T(nccl)=7.108e-06 speed=2.935e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=2.8e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=6 t=1.2e-02 per=2.2e+01 cost=4.6e+03 flops=4.0e+05
 sigma[gemm] counter=6 i=0 t=4.4e-06 per=8.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=1 t=3.4e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=2 t=5.8e-03 per=1.1e+01 cost=1.8e+03 flops=3.1e+05
 sigma[gemm] counter=6 i=3 t=7.4e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=6 i=4 t=7.4e-03 per=1.4e+01 cost=3.7e+03 flops=5.1e+05
 sigma[gemm] counter=6 i=5 t=7.4e-03 per=1.4e+01 cost=3.6e+03 flops=4.9e+05
 sigma[gemm] counter=6 total t=2.8e-02 per=5.4e+01 cost=1.1e+04 flops=3.8e+05
 sigma[red] counter=6 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=5.6e-02 t_gemm=1.8e-01 t_reduction=7.5e-02 tot=3.1e-01 -----
 sigma_tot[inter] counter=6 t=5.6e-02 per=1.8e+01 cost=1.2e+04 flops=2.2e+05
 sigma_tot[gemm] counter=6 i=0 t=1.2e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=1 t=9.4e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=2 t=4.3e-02 per=1.4e+01 cost=4.2e+03 flops=9.8e+04
 sigma_tot[gemm] counter=6 i=3 t=4.5e-02 per=1.4e+01 cost=3.9e+03 flops=8.7e+04
 sigma_tot[gemm] counter=6 i=4 t=4.5e-02 per=1.4e+01 cost=8.4e+03 flops=1.9e+05
 sigma_tot[gemm] counter=6 i=5 t=4.5e-02 per=1.5e+01 cost=8.0e+03 flops=1.8e+05
 sigma_tot[gemm] counter=6 total t=1.8e-01 per=5.7e+01 cost=2.4e+04 flops=1.4e+05
 sigma_tot[red] counter=6 t=7.5e-02 per=2.4e+01 cost=8.2e+03 flops=1.1e+05
T(sub)=7.4e-05 T(gemm/eig/ortho/gemm/axpy)=2.4e-05,4.1e-05,6.4e-06,1.8e-06,4.2e-07
    2   0 -    -116.200644405681 -2.167e-02  1.866e-02    2     2  1.187e-01 5.936e-02 5.306e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.297e-03,1.005e-02,2.996e-02,1.231e-02,5.463e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=2.292e-03 speed=9.102e-05GB/S T(nccl)=5.468e-06 speed=3.815e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=7 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=7 i=0 t=1.8e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=2 t=7.6e-03 per=1.4e+01 cost=1.8e+03 flops=2.3e+05
 sigma[gemm] counter=7 i=3 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=7 i=4 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=7 i=5 t=7.4e-03 per=1.4e+01 cost=3.6e+03 flops=4.8e+05
 sigma[gemm] counter=7 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=7 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=6.6e-02 t_gemm=2.1e-01 t_reduction=8.7e-02 tot=3.6e-01 -----
 sigma_tot[inter] counter=7 t=6.6e-02 per=1.8e+01 cost=1.7e+04 flops=2.6e+05
 sigma_tot[gemm] counter=7 i=0 t=1.4e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=1 t=1.1e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=2 t=5.1e-02 per=1.4e+01 cost=5.9e+03 flops=1.2e+05
 sigma_tot[gemm] counter=7 i=3 t=5.2e-02 per=1.4e+01 cost=5.5e+03 flops=1.1e+05
 sigma_tot[gemm] counter=7 i=4 t=5.2e-02 per=1.4e+01 cost=1.2e+04 flops=2.3e+05
 sigma_tot[gemm] counter=7 i=5 t=5.2e-02 per=1.4e+01 cost=1.2e+04 flops=2.2e+05
 sigma_tot[gemm] counter=7 total t=2.1e-01 per=5.7e+01 cost=3.5e+04 flops=1.7e+05
 sigma_tot[red] counter=7 t=8.7e-02 per=2.4e+01 cost=1.1e+04 flops=1.3e+05
T(sub)=4.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,3.7e-05,3.2e-06,1.1e-06,1.9e-07
    3   0 -    -116.201758145098 -1.114e-03  2.853e-03    3     3  1.923e-01 6.409e-02 5.362e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.005e-03,1.202e-02,3.015e-02,1.252e-02,5.671e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=2.001e-03 speed=1.043e-04GB/S T(nccl)=4.538e-06 speed=4.597e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.5e-02 -----
 sigma[inter] counter=8 t=1.2e-02 per=2.2e+01 cost=4.6e+03 flops=3.8e+05
 sigma[gemm] counter=8 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=2 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.3e+05
 sigma[gemm] counter=8 i=3 t=7.6e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=8 i=4 t=7.6e-03 per=1.4e+01 cost=3.7e+03 flops=4.9e+05
 sigma[gemm] counter=8 i=5 t=7.5e-03 per=1.4e+01 cost=3.6e+03 flops=4.8e+05
 sigma[gemm] counter=8 total t=3.0e-02 per=5.5e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=8 t=1.3e-02 per=2.3e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=7.8e-02 t_gemm=2.4e-01 t_reduction=1.0e-01 tot=4.2e-01 -----
 sigma_tot[inter] counter=8 t=7.8e-02 per=1.9e+01 cost=2.2e+04 flops=2.8e+05
 sigma_tot[gemm] counter=8 i=0 t=1.5e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=1 t=1.2e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=2 t=5.8e-02 per=1.4e+01 cost=7.7e+03 flops=1.3e+05
 sigma_tot[gemm] counter=8 i=3 t=6.0e-02 per=1.4e+01 cost=7.2e+03 flops=1.2e+05
 sigma_tot[gemm] counter=8 i=4 t=6.0e-02 per=1.4e+01 cost=1.6e+04 flops=2.7e+05
 sigma_tot[gemm] counter=8 i=5 t=6.0e-02 per=1.4e+01 cost=1.5e+04 flops=2.5e+05
 sigma_tot[gemm] counter=8 total t=2.4e-01 per=5.7e+01 cost=4.6e+04 flops=1.9e+05
 sigma_tot[red] counter=8 t=1.0e-01 per=2.4e+01 cost=1.5e+04 flops=1.5e+05
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.3e-05,2.7e-06,8.4e-07,1.5e-07
    4   0 -    -116.201797957106 -3.981e-05  6.831e-04    3     4  2.620e-01 6.549e-02 5.441e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.118e-03,9.925e-03,2.995e-02,1.245e-02,5.345e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=1.112e-03 speed=1.876e-04GB/S T(nccl)=5.950e-06 speed=3.506e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=9 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=9 i=0 t=3.2e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=1 t=2.7e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=9 i=3 t=7.4e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=9 i=4 t=7.6e-03 per=1.4e+01 cost=3.7e+03 flops=4.9e+05
 sigma[gemm] counter=9 i=5 t=7.5e-03 per=1.4e+01 cost=3.6e+03 flops=4.8e+05
 sigma[gemm] counter=9 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=9 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=8.8e-02 t_gemm=2.7e-01 t_reduction=1.1e-01 tot=4.7e-01 -----
 sigma_tot[inter] counter=9 t=8.8e-02 per=1.9e+01 cost=2.6e+04 flops=3.0e+05
 sigma_tot[gemm] counter=9 i=0 t=1.8e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=1 t=1.5e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=2 t=6.5e-02 per=1.4e+01 cost=9.5e+03 flops=1.4e+05
 sigma_tot[gemm] counter=9 i=3 t=6.7e-02 per=1.4e+01 cost=8.8e+03 flops=1.3e+05
 sigma_tot[gemm] counter=9 i=4 t=6.7e-02 per=1.4e+01 cost=2.0e+04 flops=2.9e+05
 sigma_tot[gemm] counter=9 i=5 t=6.7e-02 per=1.4e+01 cost=1.9e+04 flops=2.8e+05
 sigma_tot[gemm] counter=9 total t=2.7e-01 per=5.7e+01 cost=5.7e+04 flops=2.1e+05
 sigma_tot[red] counter=9 t=1.1e-01 per=2.4e+01 cost=1.8e+04 flops=1.6e+05
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.9e-06,2.1e-05,1.7e-05,1.6e-06,3.0e-07
    5   0 -    -116.201799666704 -1.710e-06  1.803e-04    3     5  3.273e-01 6.547e-02 5.425e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.056e-03,9.916e-03,3.014e-02,1.264e-02,5.476e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=2.051e-03 speed=1.017e-04GB/S T(nccl)=4.896e-06 speed=4.261e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=10 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=10 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=10 i=3 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=10 i=4 t=7.6e-03 per=1.4e+01 cost=3.7e+03 flops=4.9e+05
 sigma[gemm] counter=10 i=5 t=7.6e-03 per=1.4e+01 cost=3.6e+03 flops=4.7e+05
 sigma[gemm] counter=10 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=10 t=1.3e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=9.8e-02 t_gemm=3.0e-01 t_reduction=1.2e-01 tot=5.2e-01 -----
 sigma_tot[inter] counter=10 t=9.8e-02 per=1.9e+01 cost=3.1e+04 flops=3.2e+05
 sigma_tot[gemm] counter=10 i=0 t=2.0e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=1 t=1.6e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=2 t=7.3e-02 per=1.4e+01 cost=1.1e+04 flops=1.5e+05
 sigma_tot[gemm] counter=10 i=3 t=7.5e-02 per=1.4e+01 cost=1.0e+04 flops=1.4e+05
 sigma_tot[gemm] counter=10 i=4 t=7.5e-02 per=1.4e+01 cost=2.3e+04 flops=3.1e+05
 sigma_tot[gemm] counter=10 i=5 t=7.5e-02 per=1.4e+01 cost=2.2e+04 flops=3.0e+05
 sigma_tot[gemm] counter=10 total t=3.0e-01 per=5.7e+01 cost=6.7e+04 flops=2.3e+05
 sigma_tot[red] counter=10 t=1.2e-01 per=2.4e+01 cost=2.1e+04 flops=1.7e+05
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.3e-05,2.8e-06,9.8e-07,1.7e-07
    6   0 +    -116.201799839537 -1.728e-07  3.861e-05    3     6  3.950e-01 6.583e-02 5.435e-02
TIMING FOR Davidson : 3.950e-01  T(cal/comm/rest)=3.261e-01,7.100e-07,6.892e-02
decomposed t_rest=6.892e-02
 T(sub)    =2.277e-04 per=3.304e-01
 T(precond)=6.852e-02 per=9.942e+01
 T(ortho)  =1.811e-05 per=2.628e-02
 T(xcopy)  =7.640e-07 per=1.109e-03
 T(xnrm2)  =2.987e-06 per=4.334e-03
 T(other)  =1.494e-04 per=2.168e-01
optimized energies: isweep=0 ibond=2 dots=1 e[0]=-116.201799839537 nmvp=6
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.490e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=25 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=25 dimAll=256
 (0,0):1 (2,0):16 (1,1):4 (1,-1):4 (4,0):36 (3,1):24 (3,-1):24 (2,2):6 (2,-2):6 (6,0):16 (5,1):24 (5,-1):24 (4,2):16 (4,-2):16 (3,3):4 (3,-3):4 (8,0):1 (7,1):4 (7,-1):4 (6,2):6 (6,-2):6 (5,3):4 (5,-3):4 (4,4):1 (4,-4):1
timing for divide=1.4e-05
timing for compute=1.3e-02
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(nkr): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.4e-05,1.3e-02,0.0e+00,4.3e-06,1.6e-05 -----
decimation summary: 256->3 dwt=+1.110e-16 SvN=3.282e-01
 qbond: qkept nsym=2 dimAll=3
 (7,1):2 (6,2):1
----- TIMING for decimation_row(nkr): 1.327e-02 S T(decim/select/formRot)=1.287e-02,2.959e-04,1.040e-04 -----
----- TIMING FOR onedot_decimation: 1.340e-02 S T(wf/decim)=1.126e-04,1.329e-02 -----
ctns::oper_renorm coord=(3,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.479e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=105 : 5.664e-03 S -----
rank=0 GPUmem(GB): used=1.958e-04 (oper)=1.822e-04
rank=0 GPUmem(GB): used=1.959e-04 (oper,site)=1.822e-04,1.043e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=327
 no. of coefficients=1890:1.442e-02MB:1.408e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.532e-03 S -----
rank=0 GPUmem(GB): used=2.099e-04 (oper,site,rinter)=1.822e-04,1.043e-07,1.408e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.494e-03 S size(rtasks)=105 size(Rlst2)=4 T(Rmu/Rlist)=1.671e-03,8.233e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.544e-03 S size(rtasks)=105 size(Rlst)=267 -----
rank=0 GPUmem(GB): used=2.099e-04 avail=6.176e+00 total=6.176e+00 batch[need]=4.376e-05 blksize=6 blksize0=9 batchsize=267
rank=0 GPUmem(GB): used=2.537e-04 (oper,site,rinter,batch)=1.822e-04,1.043e-07,1.408e-05,4.376e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.739e-03,2.246e-02,1.011e-02
----- TIMING FOR renorm : t_inter=5.7e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=3 t=5.7e-03 per=1.5e+01 cost=1.4e+04 flops=2.4e+06
 renorm[gemm] counter=3 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=2 t=1.0e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=4 t=7.5e-03 per=1.9e+01 cost=2.6e+03 flops=3.4e+05
 renorm[gemm] counter=3 i=5 t=7.5e-03 per=2.0e+01 cost=2.9e+03 flops=3.8e+05
 renorm[gemm] counter=3 i=6 t=7.5e-03 per=2.0e+01 cost=3.1e+03 flops=4.1e+05
 renorm[gemm] counter=3 total t=2.2e-02 per=5.9e+01 cost=8.5e+03 flops=3.8e+05
 renorm[red] counter=3 t=1.0e-02 per=2.6e+01 cost=1.2e+03 flops=1.2e+05
----- TIMING FOR renorm_tot : t_inter=1.3e-02 t_gemm=6.8e-02 t_reduction=3.0e-02 tot=1.1e-01 -----
 renorm_tot[inter] counter=3 t=1.3e-02 per=1.2e+01 cost=9.8e+04 flops=7.6e+06
 renorm_tot[gemm] counter=3 i=0 t=4.0e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=1 t=3.3e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=2 t=3.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=3 t=3.0e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=4 t=2.2e-02 per=2.0e+01 cost=1.8e+05 flops=8.0e+06
 renorm_tot[gemm] counter=3 i=5 t=2.3e-02 per=2.0e+01 cost=1.6e+05 flops=7.0e+06
 renorm_tot[gemm] counter=3 i=6 t=2.3e-02 per=2.0e+01 cost=1.2e+06 flops=5.3e+07
 renorm_tot[gemm] counter=3 total t=6.8e-02 per=6.1e+01 cost=1.5e+06 flops=2.3e+07
 renorm_tot[red] counter=3 t=3.0e-02 per=2.7e+01 cost=5.5e+05 flops=1.8e+07
qops.to_cpu: size(tot)=145:1.1e-03MB:1.1e-06GB T(to_cpu)=1.1e-04S speed=1.0e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0528 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.059e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=3.128e-04 change=-1.663e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=3.128e-04 change=-1.125e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 5.266e-01 S #####
 T(local opt: fetch) = 9.944e-03 S  per = 1.89  per(accum) = 1.89
 T(local opt: hdiag) = 4.487e-02 S  per = 8.52  per(accum) = 10.4
 T(local opt: dvdsn) = 4.039e-01 S  per = 76.7  per(accum) = 87.1
 T(local opt: decim) = 1.342e-02 S  per = 2.55  per(accum) = 89.7
 T(local opt: guess) = 1.635e-04 S  per = 0.0311  per(accum) = 89.7
 T(local opt: renrm) = 5.409e-02 S  per = 10.3  per(accum) = 100
 T(local opt: save ) = 1.885e-04 S  per = 0.0358  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.039e-01 S  T(sum) = 4.037e-01 S  per = 9.995e+01
 T(local opt: preprocess                  ) = 2.125e-04 S  per = 0.0526  per(accum) = 0.0526
 T(local opt: symbolic_formulae           ) = 4.954e-03 S  per = 1.23  per(accum) = 1.28
 T(local opt: hintermediate init          ) = 1.425e-04 S  per = 0.0353  per(accum) = 1.31
 T(local opt: preprocess_hformulae_Hxlist ) = 1.472e-03 S  per = 0.365  per(accum) = 1.68
 T(local opt: hmmtasks init               ) = 1.924e-03 S  per = 0.477  per(accum) = 2.16
 T(local opt: initial guess for dvdson    ) = 1.070e-05 S  per = 0.00265  per(accum) = 2.16
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.169e-01 S  per = 78.5  per(accum) = 80.6
 T(local opt: dvdson [cpu-gpu]            ) = 9.195e-03 S  per = 2.28  per(accum) = 82.9
 T(local opt: dvdson [nccl]               ) = 3.315e-05 S  per = 0.00821  per(accum) = 82.9
 T(local opt: dvdson [mpi]                ) = 7.100e-07 S  per = 0.000176  per(accum) = 82.9
 T(local opt: dvdson [rest part(linalg)]  ) = 6.892e-02 S  per = 17.1  per(accum) = 100
Detailed decomposition of T(renrm) = 5.409e-02 S  T(sum) = 5.409e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.648e-04 S  per = 0.305  per(accum) = 0.305
 T(local opt: qops init                    ) = 9.906e-04 S  per = 1.83  per(accum) = 2.14
 T(local opt: symbolic_formulae_renorm     ) = 5.677e-03 S  per = 10.5  per(accum) = 12.6
 T(local opt: allocate qops on gpu         ) = 5.165e-05 S  per = 0.0955  per(accum) = 12.7
 T(local opt: site memcpy cpu2gpu          ) = 6.679e-04 S  per = 1.23  per(accum) = 14
 T(local opt: rintermediate init           ) = 2.544e-03 S  per =  4.7  per(accum) = 18.7
 T(local opt: preprocess_formulae_Rlist2   ) = 2.558e-03 S  per = 4.73  per(accum) = 23.4
 T(local opt: rmmtasks init                ) = 1.762e-03 S  per = 3.26  per(accum) = 26.6
 T(local opt: qops memset on cpu           ) = 4.000e-08 S  per = 7.39e-05  per(accum) = 26.6
 T(local opt: preprocess_renorm_batchGPU   ) = 3.839e-02 S  per =   71  per(accum) = 97.6
 T(local opt: deallocate cpu and gpu memory) = 4.435e-05 S  per = 0.082  per(accum) = 97.7
 T(local opt: construct opS [ifdists=true] ) = 3.300e-08 S  per = 6.1e-05  per(accum) = 97.7
 T(local opt: reduction of opS & opH [nccl]) = 3.900e-08 S  per = 7.21e-05  per(accum) = 97.7
 T(local opt: qops memcpy gpu2cpu          ) = 1.118e-04 S  per = 0.207  per(accum) = 97.9
 T(local opt: reduction of opS & opH [mpi] ) = 1.494e-05 S  per = 0.0276  per(accum) = 97.9
 T(local opt: qops_pool join and erase     ) = 1.114e-03 S  per = 2.06  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.912e-06 S  per = 0.00353  per(accum) = 100
##### sweep opt: 1.022e+00 S #####
 T(sweep opt: fetch) = 4.411e-02 S  per = 4.32  per(accum) = 4.32
 T(sweep opt: hdiag) = 1.090e-01 S  per = 10.7  per(accum) = 15
 T(sweep opt: dvdsn) = 6.399e-01 S  per = 62.6  per(accum) = 77.6
 T(sweep opt: decim) = 1.373e-02 S  per = 1.34  per(accum) = 79
 T(sweep opt: guess) = 3.286e-04 S  per = 0.0322  per(accum) = 79
 T(sweep opt: renrm) = 2.138e-01 S  per = 20.9  per(accum) = 99.9
 T(sweep opt: save ) = 8.239e-04 S  per = 0.0806  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.399e-01 S  T(sum) = 6.394e-01 S  per = 9.992e+01
 T(sweep opt: preprocess                  ) = 4.408e-04 S  per = 0.0689  per(accum) = 0.0689
 T(sweep opt: symbolic_formulae           ) = 9.340e-03 S  per = 1.46  per(accum) = 1.53
 T(sweep opt: hintermediate init          ) = 3.308e-04 S  per = 0.0517  per(accum) = 1.58
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.588e-03 S  per = 0.405  per(accum) = 1.99
 T(sweep opt: hmmtasks init               ) = 2.977e-03 S  per = 0.466  per(accum) = 2.45
 T(sweep opt: initial guess for dvdson    ) = 1.603e-05 S  per = 0.00251  per(accum) = 2.45
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.214e-01 S  per = 81.5  per(accum) = 84
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.410e-02 S  per = 2.21  per(accum) = 86.2
 T(sweep opt: dvdson [nccl]               ) = 6.299e-05 S  per = 0.00985  per(accum) = 86.2
 T(sweep opt: dvdson [mpi]                ) = 1.163e-06 S  per = 0.000182  per(accum) = 86.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.817e-02 S  per = 13.8  per(accum) = 100
Detailed decomposition of T(renrm) = 2.138e-01 S  T(sum) = 2.138e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.777e-04 S  per = 0.177  per(accum) = 0.177
 T(sweep opt: qops init                    ) = 3.625e-03 S  per =  1.7  per(accum) = 1.87
 T(sweep opt: symbolic_formulae_renorm     ) = 1.019e-02 S  per = 4.77  per(accum) = 6.64
 T(sweep opt: allocate qops on gpu         ) = 1.442e-04 S  per = 0.0675  per(accum) = 6.71
 T(sweep opt: site memcpy cpu2gpu          ) = 3.441e-03 S  per = 1.61  per(accum) = 8.32
 T(sweep opt: rintermediate init           ) = 5.087e-03 S  per = 2.38  per(accum) = 10.7
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.528e-02 S  per = 7.15  per(accum) = 17.8
 T(sweep opt: rmmtasks init                ) = 5.952e-02 S  per = 27.8  per(accum) = 45.7
 T(sweep opt: qops memset on cpu           ) = 1.080e-07 S  per = 5.05e-05  per(accum) = 45.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.111e-01 S  per =   52  per(accum) = 97.7
 T(sweep opt: deallocate cpu and gpu memory) = 5.408e-04 S  per = 0.253  per(accum) = 97.9
 T(sweep opt: construct opS [ifdists=true] ) = 9.800e-08 S  per = 4.58e-05  per(accum) = 97.9
 T(sweep opt: reduction of opS & opH [nccl]) = 1.120e-07 S  per = 5.24e-05  per(accum) = 97.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.340e-04 S  per = 0.156  per(accum) = 98.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 8.238e-05 S  per = 0.0385  per(accum) = 98.1
 T(sweep opt: qops_pool join and erase     ) = 3.995e-03 S  per = 1.87  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 4.991e-06 S  per = 0.00233  per(accum) = 100
##### global opt: 1.022e+00 S #####
 T(global opt: fetch) = 4.411e-02 S  per = 4.32  per(accum) = 4.32
 T(global opt: hdiag) = 1.090e-01 S  per = 10.7  per(accum) = 15
 T(global opt: dvdsn) = 6.399e-01 S  per = 62.6  per(accum) = 77.6
 T(global opt: decim) = 1.373e-02 S  per = 1.34  per(accum) = 79
 T(global opt: guess) = 3.286e-04 S  per = 0.0322  per(accum) = 79
 T(global opt: renrm) = 2.138e-01 S  per = 20.9  per(accum) = 99.9
 T(global opt: save ) = 8.239e-04 S  per = 0.0806  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.399e-01 S  T(sum) = 6.394e-01 S  per = 9.992e+01
 T(global opt: preprocess                  ) = 4.408e-04 S  per = 0.0689  per(accum) = 0.0689
 T(global opt: symbolic_formulae           ) = 9.340e-03 S  per = 1.46  per(accum) = 1.53
 T(global opt: hintermediate init          ) = 3.308e-04 S  per = 0.0517  per(accum) = 1.58
 T(global opt: preprocess_hformulae_Hxlist ) = 2.588e-03 S  per = 0.405  per(accum) = 1.99
 T(global opt: hmmtasks init               ) = 2.977e-03 S  per = 0.466  per(accum) = 2.45
 T(global opt: initial guess for dvdson    ) = 1.603e-05 S  per = 0.00251  per(accum) = 2.45
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.214e-01 S  per = 81.5  per(accum) = 84
 T(global opt: dvdson [cpu-gpu]            ) = 1.410e-02 S  per = 2.21  per(accum) = 86.2
 T(global opt: dvdson [nccl]               ) = 6.299e-05 S  per = 0.00985  per(accum) = 86.2
 T(global opt: dvdson [mpi]                ) = 1.163e-06 S  per = 0.000182  per(accum) = 86.2
 T(global opt: dvdson [rest part(linalg)]  ) = 8.817e-02 S  per = 13.8  per(accum) = 100
Detailed decomposition of T(renrm) = 2.138e-01 S  T(sum) = 2.138e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.777e-04 S  per = 0.177  per(accum) = 0.177
 T(global opt: qops init                    ) = 3.625e-03 S  per =  1.7  per(accum) = 1.87
 T(global opt: symbolic_formulae_renorm     ) = 1.019e-02 S  per = 4.77  per(accum) = 6.64
 T(global opt: allocate qops on gpu         ) = 1.442e-04 S  per = 0.0675  per(accum) = 6.71
 T(global opt: site memcpy cpu2gpu          ) = 3.441e-03 S  per = 1.61  per(accum) = 8.32
 T(global opt: rintermediate init           ) = 5.087e-03 S  per = 2.38  per(accum) = 10.7
 T(global opt: preprocess_formulae_Rlist2   ) = 1.528e-02 S  per = 7.15  per(accum) = 17.8
 T(global opt: rmmtasks init                ) = 5.952e-02 S  per = 27.8  per(accum) = 45.7
 T(global opt: qops memset on cpu           ) = 1.080e-07 S  per = 5.05e-05  per(accum) = 45.7
 T(global opt: preprocess_renorm_batchGPU   ) = 1.111e-01 S  per =   52  per(accum) = 97.7
 T(global opt: deallocate cpu and gpu memory) = 5.408e-04 S  per = 0.253  per(accum) = 97.9
 T(global opt: construct opS [ifdists=true] ) = 9.800e-08 S  per = 4.58e-05  per(accum) = 97.9
 T(global opt: reduction of opS & opH [nccl]) = 1.120e-07 S  per = 5.24e-05  per(accum) = 97.9
 T(global opt: qops memcpy gpu2cpu          ) = 3.340e-04 S  per = 0.156  per(accum) = 98.1
 T(global opt: reduction of opS & opH [mpi] ) = 8.238e-05 S  per = 0.0385  per(accum) = 98.1
 T(global opt: qops_pool join and erase     ) = 3.995e-03 S  per = 1.87  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 4.991e-06 S  per = 0.00233  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.402e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=3/seqsize=34 dots=1 dbond=(4,0)-(5,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=10:7.629e-05MB:7.451e-08GB
total mem of comb=774:5.905e-03MB:5.767e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=4,15,1
 suppl= 0 1 2 3
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 4
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
 rqops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=10:7.63e-05MB size(tot)=370:0.00282MB:2.76e-06GB
        per(mem): H:2.7 C:12.2 S:4.05 P:0 Q:81.1 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2851:0.0218MB:2.12e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.366e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(4,0) fdel=./scratch/sweep/rop(5,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.503e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(3,4,4) nnz=10:7.629e-05MB
qtensor3: wf3 own=1 _data=0x3c691d10
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=3
 (7,1):2 (6,2):1
 qbond: qcol nsym=2 dimAll=4
 (22,-2):3 (23,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=16 size=10:7.629e-05MB
### DIAG TIMING: total=8.601e-02 t1=2.150e-05, t2=2.220e-03, t3=2.516e-03, t4=8.123e-02, t5=4.306e-06, t6=1.415e-05, t7=3.297e-06
duration_diagGPU:8.602e-02
duration_diagreduce:9.400e-08
duration_diagtransform:2.720e-07
----- TIMING FOR symbolic_formulae_onedot with size=435 : 7.888e-03 S -----
rank=0 GPUmem(GB): used=2.124e-05 (oper)=2.124e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=435
 no. of hintermediate operators=188
 no. of coefficients=2820:2.151e-02MB:2.101e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.711e-04 S -----
rank=0 GPUmem(GB): used=4.225e-05 (oper,hinter)=2.124e-05,2.101e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.707e-03 S size(H_formulae)=435 size(Hxlst2)=3 T(Hmu/Hxlist)=1.061e-03,6.463e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.753e-03 S size(H_formulae)=435 size(Hxlst)=442 -----
rank=0 GPUmem(GB): used=4.225e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.490e-07 batch[need]=5.269e-05 blksize=6 blksize0=3 batchsize=442
rank=0 GPUmem(GB): used=9.509e-05 (oper,hinter,dvdson,batch)=2.124e-05,2.101e-05,1.490e-07,5.269e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=10 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.409e-03,9.981e-03,2.992e-02,1.236e-02,5.368e-02
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=1.404e-03 speed=1.062e-04GB/S T(nccl)=4.984e-06 speed=2.990e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=11 t=1.0e-02 per=1.9e+01 cost=7.9e+03 flops=7.9e+05
 sigma[gemm] counter=11 i=0 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=1 t=1.1e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=2 t=7.5e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=11 i=3 t=7.5e-03 per=1.4e+01 cost=1.9e+03 flops=2.6e+05
 sigma[gemm] counter=11 i=4 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=11 i=5 t=7.4e-03 per=1.4e+01 cost=1.7e+03 flops=2.3e+05
 sigma[gemm] counter=11 total t=3.0e-02 per=5.7e+01 cost=7.3e+03 flops=2.4e+05
 sigma[red] counter=11 t=1.2e-02 per=2.4e+01 cost=2.7e+03 flops=2.2e+05
----- TIMING FOR sigma_tot : t_inter=1.1e-01 t_gemm=3.3e-01 t_reduction=1.4e-01 tot=5.7e-01 -----
 sigma_tot[inter] counter=11 t=1.1e-01 per=1.9e+01 cost=3.9e+04 flops=3.6e+05
 sigma_tot[gemm] counter=11 i=0 t=2.1e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=1 t=1.7e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=2 t=8.0e-02 per=1.4e+01 cost=1.3e+04 flops=1.6e+05
 sigma_tot[gemm] counter=11 i=3 t=8.2e-02 per=1.4e+01 cost=1.2e+04 flops=1.5e+05
 sigma_tot[gemm] counter=11 i=4 t=8.3e-02 per=1.4e+01 cost=2.5e+04 flops=3.0e+05
 sigma_tot[gemm] counter=11 i=5 t=8.2e-02 per=1.4e+01 cost=2.4e+04 flops=2.9e+05
 sigma_tot[gemm] counter=11 total t=3.3e-01 per=5.7e+01 cost=7.5e+04 flops=2.3e+05
 sigma_tot[red] counter=11 t=1.4e-01 per=2.4e+01 cost=2.4e+04 flops=1.7e+05
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,4.4e-06,2.0e-06,7.2e-07,1.6e-07
settings: ndim=10 neig=1 maxcycle=30 nbuff=4 memory=1e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.201799839536 -1.116e+03  3.965e-02    1     1  5.380e-02 5.380e-02 5.377e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.749e-03,1.001e-02,2.967e-02,1.244e-02,5.388e-02
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=1.744e-03 speed=8.546e-05GB/S T(nccl)=4.913e-06 speed=3.033e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=12 t=1.0e-02 per=1.9e+01 cost=7.9e+03 flops=7.9e+05
 sigma[gemm] counter=12 i=0 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=2 t=7.5e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=12 i=3 t=7.4e-03 per=1.4e+01 cost=1.9e+03 flops=2.6e+05
 sigma[gemm] counter=12 i=4 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=12 i=5 t=7.4e-03 per=1.4e+01 cost=1.7e+03 flops=2.4e+05
 sigma[gemm] counter=12 total t=3.0e-02 per=5.7e+01 cost=7.3e+03 flops=2.5e+05
 sigma[red] counter=12 t=1.2e-02 per=2.4e+01 cost=2.7e+03 flops=2.2e+05
----- TIMING FOR sigma_tot : t_inter=1.2e-01 t_gemm=3.6e-01 t_reduction=1.5e-01 tot=6.2e-01 -----
 sigma_tot[inter] counter=12 t=1.2e-01 per=1.9e+01 cost=4.7e+04 flops=4.0e+05
 sigma_tot[gemm] counter=12 i=0 t=2.3e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=1 t=1.9e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=2 t=8.8e-02 per=1.4e+01 cost=1.5e+04 flops=1.7e+05
 sigma_tot[gemm] counter=12 i=3 t=9.0e-02 per=1.4e+01 cost=1.4e+04 flops=1.6e+05
 sigma_tot[gemm] counter=12 i=4 t=9.0e-02 per=1.4e+01 cost=2.7e+04 flops=3.0e+05
 sigma_tot[gemm] counter=12 i=5 t=9.0e-02 per=1.4e+01 cost=2.6e+04 flops=2.9e+05
 sigma_tot[gemm] counter=12 total t=3.6e-01 per=5.7e+01 cost=8.2e+04 flops=2.3e+05
 sigma_tot[red] counter=12 t=1.5e-01 per=2.4e+01 cost=2.7e+04 flops=1.8e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.3e-05,3.2e-06,9.5e-07,1.9e-07
    2   0 -    -116.206813881637 -5.014e-03  1.586e-02    2     2  1.189e-01 5.944e-02 5.387e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.120e-03,9.965e-03,3.004e-02,1.230e-02,5.343e-02
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=1.113e-03 speed=1.338e-04GB/S T(nccl)=6.518e-06 speed=2.286e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=13 t=1.0e-02 per=1.9e+01 cost=7.9e+03 flops=7.9e+05
 sigma[gemm] counter=13 i=0 t=3.5e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=1 t=3.0e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=2 t=7.5e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=13 i=3 t=7.5e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=13 i=4 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=13 i=5 t=7.4e-03 per=1.4e+01 cost=1.7e+03 flops=2.3e+05
 sigma[gemm] counter=13 total t=3.0e-02 per=5.7e+01 cost=7.3e+03 flops=2.4e+05
 sigma[red] counter=13 t=1.2e-02 per=2.4e+01 cost=2.7e+03 flops=2.2e+05
----- TIMING FOR sigma_tot : t_inter=1.3e-01 t_gemm=3.9e-01 t_reduction=1.6e-01 tot=6.8e-01 -----
 sigma_tot[inter] counter=13 t=1.3e-01 per=1.9e+01 cost=5.5e+04 flops=4.3e+05
 sigma_tot[gemm] counter=13 i=0 t=2.6e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=1 t=2.2e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=2 t=9.5e-02 per=1.4e+01 cost=1.7e+04 flops=1.8e+05
 sigma_tot[gemm] counter=13 i=3 t=9.7e-02 per=1.4e+01 cost=1.6e+04 flops=1.7e+05
 sigma_tot[gemm] counter=13 i=4 t=9.7e-02 per=1.4e+01 cost=2.9e+04 flops=2.9e+05
 sigma_tot[gemm] counter=13 i=5 t=9.7e-02 per=1.4e+01 cost=2.8e+04 flops=2.8e+05
 sigma_tot[gemm] counter=13 total t=3.9e-01 per=5.7e+01 cost=8.9e+04 flops=2.3e+05
 sigma_tot[red] counter=13 t=1.6e-01 per=2.4e+01 cost=2.9e+04 flops=1.8e+05
T(sub)=3.7e-05 T(gemm/eig/ortho/gemm/axpy)=6.4e-06,2.4e-05,4.9e-06,1.6e-06,3.4e-07
    3   0 -    -116.207969611591 -1.156e-03  1.425e-03    3     3  1.843e-01 6.142e-02 5.378e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.749e-04,9.917e-03,3.014e-02,1.255e-02,5.289e-02
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=2.697e-04 speed=5.525e-04GB/S T(nccl)=5.203e-06 speed=2.864e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=14 t=9.9e-03 per=1.9e+01 cost=7.9e+03 flops=8.0e+05
 sigma[gemm] counter=14 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=1 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=2 t=7.5e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=14 i=3 t=7.5e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=14 i=4 t=7.6e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=14 i=5 t=7.6e-03 per=1.4e+01 cost=1.7e+03 flops=2.3e+05
 sigma[gemm] counter=14 total t=3.0e-02 per=5.7e+01 cost=7.3e+03 flops=2.4e+05
 sigma[red] counter=14 t=1.3e-02 per=2.4e+01 cost=2.7e+03 flops=2.2e+05
----- TIMING FOR sigma_tot : t_inter=1.4e-01 t_gemm=4.2e-01 t_reduction=1.7e-01 tot=7.3e-01 -----
 sigma_tot[inter] counter=14 t=1.4e-01 per=1.9e+01 cost=6.3e+04 flops=4.5e+05
 sigma_tot[gemm] counter=14 i=0 t=2.8e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=1 t=2.3e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=2 t=1.0e-01 per=1.4e+01 cost=1.9e+04 flops=1.8e+05
 sigma_tot[gemm] counter=14 i=3 t=1.0e-01 per=1.4e+01 cost=1.8e+04 flops=1.7e+05
 sigma_tot[gemm] counter=14 i=4 t=1.1e-01 per=1.4e+01 cost=3.1e+04 flops=2.9e+05
 sigma_tot[gemm] counter=14 i=5 t=1.0e-01 per=1.4e+01 cost=2.9e+04 flops=2.8e+05
 sigma_tot[gemm] counter=14 total t=4.2e-01 per=5.7e+01 cost=9.7e+04 flops=2.3e+05
 sigma_tot[red] counter=14 t=1.7e-01 per=2.4e+01 cost=3.2e+04 flops=1.8e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.4e-05,2.9e-06,1.0e-06,2.2e-07
    4   0 -    -116.207979547961 -9.936e-06  1.341e-04    3     4  2.539e-01 6.348e-02 5.358e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.221e-03,1.201e-02,2.999e-02,1.253e-02,5.675e-02
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=2.216e-03 speed=6.724e-05GB/S T(nccl)=4.535e-06 speed=3.286e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.5e-02 -----
 sigma[inter] counter=15 t=1.2e-02 per=2.2e+01 cost=7.9e+03 flops=6.6e+05
 sigma[gemm] counter=15 i=0 t=1.4e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=2 t=7.4e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=15 i=3 t=7.4e-03 per=1.4e+01 cost=1.9e+03 flops=2.6e+05
 sigma[gemm] counter=15 i=4 t=7.6e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=15 i=5 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.3e+05
 sigma[gemm] counter=15 total t=3.0e-02 per=5.5e+01 cost=7.3e+03 flops=2.4e+05
 sigma[red] counter=15 t=1.3e-02 per=2.3e+01 cost=2.7e+03 flops=2.2e+05
----- TIMING FOR sigma_tot : t_inter=1.5e-01 t_gemm=4.5e-01 t_reduction=1.9e-01 tot=7.8e-01 -----
 sigma_tot[inter] counter=15 t=1.5e-01 per=1.9e+01 cost=7.1e+04 flops=4.7e+05
 sigma_tot[gemm] counter=15 i=0 t=2.9e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=1 t=2.4e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=2 t=1.1e-01 per=1.4e+01 cost=2.1e+04 flops=1.9e+05
 sigma_tot[gemm] counter=15 i=3 t=1.1e-01 per=1.4e+01 cost=2.0e+04 flops=1.8e+05
 sigma_tot[gemm] counter=15 i=4 t=1.1e-01 per=1.4e+01 cost=3.2e+04 flops=2.9e+05
 sigma_tot[gemm] counter=15 i=5 t=1.1e-01 per=1.4e+01 cost=3.1e+04 flops=2.8e+05
 sigma_tot[gemm] counter=15 total t=4.5e-01 per=5.7e+01 cost=1.0e+05 flops=2.3e+05
 sigma_tot[red] counter=15 t=1.9e-01 per=2.4e+01 cost=3.5e+04 flops=1.9e+05
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.2e-05,2.7e-06,8.3e-07,1.7e-07
    5   0 +    -116.207979653445 -1.055e-07  3.101e-05    3     5  3.235e-01 6.470e-02 5.423e-02
TIMING FOR Davidson : 3.235e-01  T(cal/comm/rest)=2.712e-01,6.620e-07,5.234e-02
decomposed t_rest=5.234e-02
 T(sub)    =1.112e-04 per=2.125e-01
 T(precond)=5.208e-02 per=9.950e+01
 T(ortho)  =1.364e-05 per=2.605e-02
 T(xcopy)  =7.320e-07 per=1.399e-03
 T(xnrm2)  =2.326e-06 per=4.444e-03
 T(other)  =1.325e-04 per=2.531e-01
optimized energies: isweep=0 ibond=3 dots=1 e[0]=-116.207979653445 nmvp=5
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=4.391e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=6 dimAll=12
 (7,1):3 (9,1):2 (8,2):3 (8,0):2 (6,2):1 (7,3):1
timing for divide=8.3e-06
timing for compute=1.0e-02
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 1.0e-02 S T(divide/compute[cpu/gpu/rest]/collect)=8.3e-06,1.0e-02,0.0e+00,4.1e-06,1.4e-05 -----
decimation summary: 12->4 dwt=+0.000e+00 SvN=4.937e-01
 qbond: qkept nsym=2 dimAll=4
 (8,2):3 (7,3):1
----- TIMING for decimation_row(nkr): 1.038e-02 S T(decim/select/formRot)=1.019e-02,1.744e-04,1.700e-05 -----
----- TIMING FOR onedot_decimation: 1.043e-02 S T(wf/decim)=3.883e-05,1.039e-02 -----
ctns::oper_renorm coord=(4,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=4,4 size(op)=10:7.629e-05MB size(tot)=370:2.823e-03MB:2.757e-06GB
        per(mem): H:2.7 C:4.05 S:12.2 A:0 B:81.1 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=5.782e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=141 : 6.901e-03 S -----
rank=0 GPUmem(GB): used=4.225e-05 (oper)=2.124e-05
rank=0 GPUmem(GB): used=4.233e-05 (oper,site)=2.124e-05,7.451e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=307
 no. of coefficients=2932:2.237e-02MB:2.185e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.476e-03 S -----
rank=0 GPUmem(GB): used=6.417e-05 (oper,site,rinter)=2.124e-05,7.451e-08,2.185e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.145e-03 S size(rtasks)=141 size(Rlst2)=4 T(Rmu/Rlist)=1.650e-03,4.947e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.212e-03 S size(rtasks)=141 size(Rlst)=186 -----
rank=0 GPUmem(GB): used=6.417e-05 avail=6.176e+00 total=6.176e+00 batch[need]=3.187e-05 blksize=9 blksize0=4 batchsize=186
rank=0 GPUmem(GB): used=9.605e-05 (oper,site,rinter,batch)=2.124e-05,7.451e-08,2.185e-05,3.187e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.527e-03,2.271e-02,1.014e-02
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=4 t=6.5e-03 per=1.7e+01 cost=2.6e+03 flops=3.9e+05
 renorm[gemm] counter=4 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=2 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=3 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=4 t=7.5e-03 per=1.9e+01 cost=4.4e+02 flops=5.8e+04
 renorm[gemm] counter=4 i=5 t=7.6e-03 per=1.9e+01 cost=1.1e+03 flops=1.5e+05
 renorm[gemm] counter=4 i=6 t=7.6e-03 per=1.9e+01 cost=2.6e+03 flops=3.5e+05
 renorm[gemm] counter=4 total t=2.3e-02 per=5.8e+01 cost=4.2e+03 flops=1.9e+05
 renorm[red] counter=4 t=1.0e-02 per=2.6e+01 cost=1.9e+03 flops=1.9e+05
----- TIMING FOR renorm_tot : t_inter=1.9e-02 t_gemm=9.0e-02 t_reduction=4.0e-02 tot=1.5e-01 -----
 renorm_tot[inter] counter=4 t=1.9e-02 per=1.3e+01 cost=1.0e+05 flops=5.2e+06
 renorm_tot[gemm] counter=4 i=0 t=5.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=1 t=4.3e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=2 t=4.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=3 t=4.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=4 t=3.0e-02 per=2.0e+01 cost=1.8e+05 flops=6.0e+06
 renorm_tot[gemm] counter=4 i=5 t=3.0e-02 per=2.0e+01 cost=1.6e+05 flops=5.3e+06
 renorm_tot[gemm] counter=4 i=6 t=3.0e-02 per=2.0e+01 cost=1.2e+06 flops=4.0e+07
 renorm_tot[gemm] counter=4 total t=9.0e-02 per=6.0e+01 cost=1.5e+06 flops=1.7e+07
 renorm_tot[red] counter=4 t=4.0e-02 per=2.7e+01 cost=5.6e+05 flops=1.4e+07
qops.to_cpu: size(tot)=370:2.8e-03MB:2.8e-06GB T(to_cpu)=1.4e-04S speed=2.0e-02GB/S
check ||H-H.dagger||=2.963e-15 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.0539 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.611e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.327e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.502e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.982e-01 S #####
 T(local opt: fetch) = 1.090e-02 S  per = 2.19  per(accum) = 2.19
 T(local opt: hdiag) = 8.605e-02 S  per = 17.3  per(accum) = 19.5
 T(local opt: dvdsn) = 3.354e-01 S  per = 67.3  per(accum) = 86.8
 T(local opt: decim) = 1.044e-02 S  per =  2.1  per(accum) = 88.9
 T(local opt: guess) = 6.270e-05 S  per = 0.0126  per(accum) = 88.9
 T(local opt: renrm) = 5.512e-02 S  per = 11.1  per(accum) = 100
 T(local opt: save ) = 1.836e-04 S  per = 0.0368  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.354e-01 S  T(sum) = 3.353e-01 S  per = 9.995e+01
 T(local opt: preprocess                  ) = 7.012e-05 S  per = 0.0209  per(accum) = 0.0209
 T(local opt: symbolic_formulae           ) = 7.898e-03 S  per = 2.36  per(accum) = 2.38
 T(local opt: hintermediate init          ) = 1.844e-04 S  per = 0.055  per(accum) = 2.43
 T(local opt: preprocess_hformulae_Hxlist ) = 1.769e-03 S  per = 0.528  per(accum) = 2.96
 T(local opt: hmmtasks init               ) = 1.857e-03 S  per = 0.554  per(accum) = 3.51
 T(local opt: initial guess for dvdson    ) = 2.421e-06 S  per = 0.000722  per(accum) = 3.51
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.644e-01 S  per = 78.9  per(accum) = 82.4
 T(local opt: dvdson [cpu-gpu]            ) = 6.747e-03 S  per = 2.01  per(accum) = 84.4
 T(local opt: dvdson [nccl]               ) = 2.615e-05 S  per = 0.0078  per(accum) = 84.4
 T(local opt: dvdson [mpi]                ) = 6.620e-07 S  per = 0.000197  per(accum) = 84.4
 T(local opt: dvdson [rest part(linalg)]  ) = 5.234e-02 S  per = 15.6  per(accum) = 100
Detailed decomposition of T(renrm) = 5.512e-02 S  T(sum) = 5.512e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.950e-05 S  per = 0.108  per(accum) = 0.108
 T(local opt: qops init                    ) = 1.118e-03 S  per = 2.03  per(accum) = 2.14
 T(local opt: symbolic_formulae_renorm     ) = 6.914e-03 S  per = 12.5  per(accum) = 14.7
 T(local opt: allocate qops on gpu         ) = 5.201e-05 S  per = 0.0944  per(accum) = 14.8
 T(local opt: site memcpy cpu2gpu          ) = 3.418e-04 S  per = 0.62  per(accum) = 15.4
 T(local opt: rintermediate init           ) = 2.488e-03 S  per = 4.51  per(accum) = 19.9
 T(local opt: preprocess_formulae_Rlist2   ) = 2.223e-03 S  per = 4.03  per(accum) = 23.9
 T(local opt: rmmtasks init                ) = 1.158e-03 S  per =  2.1  per(accum) = 26
 T(local opt: qops memset on cpu           ) = 5.300e-08 S  per = 9.62e-05  per(accum) = 26
 T(local opt: preprocess_renorm_batchGPU   ) = 3.946e-02 S  per = 71.6  per(accum) = 97.6
 T(local opt: deallocate cpu and gpu memory) = 2.784e-05 S  per = 0.0505  per(accum) = 97.7
 T(local opt: construct opS [ifdists=true] ) = 3.200e-08 S  per = 5.81e-05  per(accum) = 97.7
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 6.71e-05  per(accum) = 97.7
 T(local opt: qops memcpy gpu2cpu          ) = 1.431e-04 S  per = 0.26  per(accum) = 97.9
 T(local opt: reduction of opS & opH [mpi] ) = 1.501e-05 S  per = 0.0272  per(accum) = 98
 T(local opt: qops_pool join and erase     ) = 1.115e-03 S  per = 2.02  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.848e-06 S  per = 0.00335  per(accum) = 100
##### sweep opt: 1.520e+00 S #####
 T(sweep opt: fetch) = 5.501e-02 S  per = 3.62  per(accum) = 3.62
 T(sweep opt: hdiag) = 1.950e-01 S  per = 12.8  per(accum) = 16.5
 T(sweep opt: dvdsn) = 9.753e-01 S  per = 64.2  per(accum) = 80.6
 T(sweep opt: decim) = 2.417e-02 S  per = 1.59  per(accum) = 82.2
 T(sweep opt: guess) = 3.913e-04 S  per = 0.0257  per(accum) = 82.2
 T(sweep opt: renrm) = 2.689e-01 S  per = 17.7  per(accum) = 99.9
 T(sweep opt: save ) = 1.007e-03 S  per = 0.0663  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.753e-01 S  T(sum) = 9.747e-01 S  per = 9.993e+01
 T(sweep opt: preprocess                  ) = 5.109e-04 S  per = 0.0524  per(accum) = 0.0524
 T(sweep opt: symbolic_formulae           ) = 1.724e-02 S  per = 1.77  per(accum) = 1.82
 T(sweep opt: hintermediate init          ) = 5.152e-04 S  per = 0.0529  per(accum) = 1.87
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.356e-03 S  per = 0.447  per(accum) = 2.32
 T(sweep opt: hmmtasks init               ) = 4.834e-03 S  per = 0.496  per(accum) = 2.82
 T(sweep opt: initial guess for dvdson    ) = 1.845e-05 S  per = 0.00189  per(accum) = 2.82
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 7.858e-01 S  per = 80.6  per(accum) = 83.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.085e-02 S  per = 2.14  per(accum) = 85.6
 T(sweep opt: dvdson [nccl]               ) = 8.915e-05 S  per = 0.00915  per(accum) = 85.6
 T(sweep opt: dvdson [mpi]                ) = 1.825e-06 S  per = 0.000187  per(accum) = 85.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.405e-01 S  per = 14.4  per(accum) = 100
Detailed decomposition of T(renrm) = 2.689e-01 S  T(sum) = 2.689e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.372e-04 S  per = 0.163  per(accum) = 0.163
 T(sweep opt: qops init                    ) = 4.743e-03 S  per = 1.76  per(accum) = 1.93
 T(sweep opt: symbolic_formulae_renorm     ) = 1.711e-02 S  per = 6.36  per(accum) = 8.29
 T(sweep opt: allocate qops on gpu         ) = 1.962e-04 S  per = 0.073  per(accum) = 8.36
 T(sweep opt: site memcpy cpu2gpu          ) = 3.783e-03 S  per = 1.41  per(accum) = 9.77
 T(sweep opt: rintermediate init           ) = 7.575e-03 S  per = 2.82  per(accum) = 12.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.750e-02 S  per = 6.51  per(accum) = 19.1
 T(sweep opt: rmmtasks init                ) = 6.068e-02 S  per = 22.6  per(accum) = 41.7
 T(sweep opt: qops memset on cpu           ) = 1.610e-07 S  per = 5.99e-05  per(accum) = 41.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.506e-01 S  per =   56  per(accum) = 97.7
 T(sweep opt: deallocate cpu and gpu memory) = 5.686e-04 S  per = 0.211  per(accum) = 97.9
 T(sweep opt: construct opS [ifdists=true] ) = 1.300e-07 S  per = 4.84e-05  per(accum) = 97.9
 T(sweep opt: reduction of opS & opH [nccl]) = 1.490e-07 S  per = 5.54e-05  per(accum) = 97.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.771e-04 S  per = 0.177  per(accum) = 98.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 9.739e-05 S  per = 0.0362  per(accum) = 98.1
 T(sweep opt: qops_pool join and erase     ) = 5.110e-03 S  per =  1.9  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 6.839e-06 S  per = 0.00254  per(accum) = 100
##### global opt: 1.520e+00 S #####
 T(global opt: fetch) = 5.501e-02 S  per = 3.62  per(accum) = 3.62
 T(global opt: hdiag) = 1.950e-01 S  per = 12.8  per(accum) = 16.5
 T(global opt: dvdsn) = 9.753e-01 S  per = 64.2  per(accum) = 80.6
 T(global opt: decim) = 2.417e-02 S  per = 1.59  per(accum) = 82.2
 T(global opt: guess) = 3.913e-04 S  per = 0.0257  per(accum) = 82.2
 T(global opt: renrm) = 2.689e-01 S  per = 17.7  per(accum) = 99.9
 T(global opt: save ) = 1.007e-03 S  per = 0.0663  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.753e-01 S  T(sum) = 9.747e-01 S  per = 9.993e+01
 T(global opt: preprocess                  ) = 5.109e-04 S  per = 0.0524  per(accum) = 0.0524
 T(global opt: symbolic_formulae           ) = 1.724e-02 S  per = 1.77  per(accum) = 1.82
 T(global opt: hintermediate init          ) = 5.152e-04 S  per = 0.0529  per(accum) = 1.87
 T(global opt: preprocess_hformulae_Hxlist ) = 4.356e-03 S  per = 0.447  per(accum) = 2.32
 T(global opt: hmmtasks init               ) = 4.834e-03 S  per = 0.496  per(accum) = 2.82
 T(global opt: initial guess for dvdson    ) = 1.845e-05 S  per = 0.00189  per(accum) = 2.82
 T(global opt: dvdson [Hx_batchGPU]        ) = 7.858e-01 S  per = 80.6  per(accum) = 83.4
 T(global opt: dvdson [cpu-gpu]            ) = 2.085e-02 S  per = 2.14  per(accum) = 85.6
 T(global opt: dvdson [nccl]               ) = 8.915e-05 S  per = 0.00915  per(accum) = 85.6
 T(global opt: dvdson [mpi]                ) = 1.825e-06 S  per = 0.000187  per(accum) = 85.6
 T(global opt: dvdson [rest part(linalg)]  ) = 1.405e-01 S  per = 14.4  per(accum) = 100
Detailed decomposition of T(renrm) = 2.689e-01 S  T(sum) = 2.689e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.372e-04 S  per = 0.163  per(accum) = 0.163
 T(global opt: qops init                    ) = 4.743e-03 S  per = 1.76  per(accum) = 1.93
 T(global opt: symbolic_formulae_renorm     ) = 1.711e-02 S  per = 6.36  per(accum) = 8.29
 T(global opt: allocate qops on gpu         ) = 1.962e-04 S  per = 0.073  per(accum) = 8.36
 T(global opt: site memcpy cpu2gpu          ) = 3.783e-03 S  per = 1.41  per(accum) = 9.77
 T(global opt: rintermediate init           ) = 7.575e-03 S  per = 2.82  per(accum) = 12.6
 T(global opt: preprocess_formulae_Rlist2   ) = 1.750e-02 S  per = 6.51  per(accum) = 19.1
 T(global opt: rmmtasks init                ) = 6.068e-02 S  per = 22.6  per(accum) = 41.7
 T(global opt: qops memset on cpu           ) = 1.610e-07 S  per = 5.99e-05  per(accum) = 41.7
 T(global opt: preprocess_renorm_batchGPU   ) = 1.506e-01 S  per =   56  per(accum) = 97.7
 T(global opt: deallocate cpu and gpu memory) = 5.686e-04 S  per = 0.211  per(accum) = 97.9
 T(global opt: construct opS [ifdists=true] ) = 1.300e-07 S  per = 4.84e-05  per(accum) = 97.9
 T(global opt: reduction of opS & opH [nccl]) = 1.490e-07 S  per = 5.54e-05  per(accum) = 97.9
 T(global opt: qops memcpy gpu2cpu          ) = 4.771e-04 S  per = 0.177  per(accum) = 98.1
 T(global opt: reduction of opS & opH [mpi] ) = 9.739e-05 S  per = 0.0362  per(accum) = 98.1
 T(global opt: qops_pool join and erase     ) = 5.110e-03 S  per =  1.9  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 6.839e-06 S  per = 0.00254  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-4.324e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=4/seqsize=34 dots=1 dbond=(5,0)-(6,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=17:1.297e-04MB:1.267e-07GB
total mem of comb=781:5.959e-03MB:5.819e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=5,14,1
 suppl= 0 1 2 3 4
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 16
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=4,4 size(op)=10:7.629e-05MB size(tot)=370:2.823e-03MB:2.757e-06GB
        per(mem): H:2.7 C:4.05 S:12.2 A:0 B:81.1 
 rqops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=661:0.00504MB:4.92e-06GB
        per(mem): H:1.66 C:8.47 S:3.63 P:0 Q:86.2 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3367:0.0257MB:2.51e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.789e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(5,0) fdel=./scratch/sweep/rop(6,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-5.364e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(4,5,4) nnz=17:1.297e-04MB
qtensor3: wf3 own=1 _data=0x47891950
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=4
 (8,2):3 (7,3):1
 qbond: qcol nsym=3 dimAll=5
 (21,-1):3 (22,-2):1 (21,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=24 size=17:1.297e-04MB
### DIAG TIMING: total=1.513e-01 t1=2.260e-05, t2=2.231e-03, t3=2.499e-03, t4=1.465e-01, t5=7.735e-06, t6=1.571e-05, t7=4.787e-06
duration_diagGPU:1.513e-01
duration_diagreduce:7.130e-07
duration_diagtransform:9.690e-07
----- TIMING FOR symbolic_formulae_onedot with size=607 : 1.074e-02 S -----
rank=0 GPUmem(GB): used=2.509e-05 (oper)=2.509e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=607
 no. of hintermediate operators=280
 no. of coefficients=3920:2.991e-02MB:2.921e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.461e-04 S -----
rank=0 GPUmem(GB): used=5.429e-05 (oper,hinter)=2.509e-05,2.921e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.900e-03 S size(H_formulae)=607 size(Hxlst2)=5 T(Hmu/Hxlist)=1.455e-03,1.446e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.097e-03 S size(H_formulae)=607 size(Hxlst)=1152 -----
rank=0 GPUmem(GB): used=5.429e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.533e-07 batch[need]=1.888e-04 blksize=9 blksize0=3 batchsize=1152
rank=0 GPUmem(GB): used=2.434e-04 (oper,hinter,dvdson,batch)=2.509e-05,2.921e-05,2.533e-07,1.888e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=17 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.058e-03,9.943e-03,2.989e-02,1.239e-02,5.329e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=1.053e-03 speed=2.405e-04GB/S T(nccl)=4.684e-06 speed=5.408e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=16 t=9.9e-03 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=16 i=0 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=1 t=1.0e-06 per=1.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=2 t=7.5e-03 per=1.4e+01 cost=4.6e+03 flops=6.1e+05
 sigma[gemm] counter=16 i=3 t=7.5e-03 per=1.4e+01 cost=4.7e+03 flops=6.2e+05
 sigma[gemm] counter=16 i=4 t=7.5e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=16 i=5 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=16 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.2e+05
 sigma[red] counter=16 t=1.2e-02 per=2.4e+01 cost=7.8e+03 flops=6.3e+05
----- TIMING FOR sigma_tot : t_inter=1.6e-01 t_gemm=4.8e-01 t_reduction=2.0e-01 tot=8.4e-01 -----
 sigma_tot[inter] counter=16 t=1.6e-01 per=1.9e+01 cost=8.9e+04 flops=5.5e+05
 sigma_tot[gemm] counter=16 i=0 t=3.0e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=1 t=2.5e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=2 t=1.2e-01 per=1.4e+01 cost=2.5e+04 flops=2.1e+05
 sigma_tot[gemm] counter=16 i=3 t=1.2e-01 per=1.4e+01 cost=2.5e+04 flops=2.1e+05
 sigma_tot[gemm] counter=16 i=4 t=1.2e-01 per=1.4e+01 cost=4.1e+04 flops=3.4e+05
 sigma_tot[gemm] counter=16 i=5 t=1.2e-01 per=1.4e+01 cost=4.0e+04 flops=3.4e+05
 sigma_tot[gemm] counter=16 total t=4.8e-01 per=5.7e+01 cost=1.3e+05 flops=2.8e+05
 sigma_tot[red] counter=16 t=2.0e-01 per=2.4e+01 cost=4.2e+04 flops=2.1e+05
T(sub)=9.0e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,3.9e-06,1.8e-06,7.2e-07,1.6e-07
settings: ndim=17 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.207979653445 -1.116e+03  4.933e-03    1     1  5.340e-02 5.340e-02 5.338e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.153e-03,9.977e-03,2.954e-02,1.246e-02,5.413e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=2.148e-03 speed=1.180e-04GB/S T(nccl)=5.590e-06 speed=4.532e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=17 t=1.0e-02 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=17 i=0 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=2 t=7.4e-03 per=1.4e+01 cost=4.6e+03 flops=6.2e+05
 sigma[gemm] counter=17 i=3 t=7.4e-03 per=1.4e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=17 i=4 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=17 i=5 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=17 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.3e+05
 sigma[red] counter=17 t=1.2e-02 per=2.4e+01 cost=7.8e+03 flops=6.3e+05
----- TIMING FOR sigma_tot : t_inter=1.7e-01 t_gemm=5.1e-01 t_reduction=2.1e-01 tot=8.9e-01 -----
 sigma_tot[inter] counter=17 t=1.7e-01 per=1.9e+01 cost=1.1e+05 flops=6.3e+05
 sigma_tot[gemm] counter=17 i=0 t=3.2e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=1 t=2.7e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=2 t=1.3e-01 per=1.4e+01 cost=3.0e+04 flops=2.4e+05
 sigma_tot[gemm] counter=17 i=3 t=1.3e-01 per=1.4e+01 cost=2.9e+04 flops=2.3e+05
 sigma_tot[gemm] counter=17 i=4 t=1.3e-01 per=1.4e+01 cost=5.0e+04 flops=4.0e+05
 sigma_tot[gemm] counter=17 i=5 t=1.3e-01 per=1.4e+01 cost=4.9e+04 flops=3.9e+05
 sigma_tot[gemm] counter=17 total t=5.1e-01 per=5.7e+01 cost=1.6e+05 flops=3.1e+05
 sigma_tot[red] counter=17 t=2.1e-01 per=2.4e+01 cost=5.0e+04 flops=2.4e+05
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.1e-05,3.3e-06,9.6e-07,1.8e-07
    2   0 -    -116.208079427065 -9.977e-05  1.636e-03    2     2  1.184e-01 5.918e-02 5.380e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.982e-03,1.006e-02,2.989e-02,1.232e-02,5.426e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=1.976e-03 speed=1.282e-04GB/S T(nccl)=6.179e-06 speed=4.100e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=18 t=1.0e-02 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=18 i=0 t=3.4e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=1 t=2.9e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=2 t=7.5e-03 per=1.4e+01 cost=4.6e+03 flops=6.1e+05
 sigma[gemm] counter=18 i=3 t=7.5e-03 per=1.4e+01 cost=4.7e+03 flops=6.2e+05
 sigma[gemm] counter=18 i=4 t=7.5e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=18 i=5 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=18 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.2e+05
 sigma[red] counter=18 t=1.2e-02 per=2.4e+01 cost=7.8e+03 flops=6.4e+05
----- TIMING FOR sigma_tot : t_inter=1.8e-01 t_gemm=5.4e-01 t_reduction=2.2e-01 tot=9.4e-01 -----
 sigma_tot[inter] counter=18 t=1.8e-01 per=1.9e+01 cost=1.3e+05 flops=7.0e+05
 sigma_tot[gemm] counter=18 i=0 t=3.5e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=1 t=3.0e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=2 t=1.3e-01 per=1.4e+01 cost=3.4e+04 flops=2.6e+05
 sigma_tot[gemm] counter=18 i=3 t=1.3e-01 per=1.4e+01 cost=3.4e+04 flops=2.5e+05
 sigma_tot[gemm] counter=18 i=4 t=1.3e-01 per=1.4e+01 cost=6.0e+04 flops=4.4e+05
 sigma_tot[gemm] counter=18 i=5 t=1.3e-01 per=1.4e+01 cost=5.8e+04 flops=4.3e+05
 sigma_tot[gemm] counter=18 total t=5.4e-01 per=5.7e+01 cost=1.9e+05 flops=3.5e+05
 sigma_tot[red] counter=18 t=2.2e-01 per=2.4e+01 cost=5.8e+04 flops=2.6e+05
T(sub)=4.0e-05 T(gemm/eig/ortho/gemm/axpy)=6.4e-06,2.6e-05,5.0e-06,1.7e-06,3.2e-07
    3   0 -    -116.208089811987 -1.038e-05  1.346e-04    3     3  1.837e-01 6.125e-02 5.401e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.256e-03,9.936e-03,3.010e-02,1.258e-02,5.488e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=2.251e-03 speed=1.126e-04GB/S T(nccl)=5.346e-06 speed=4.738e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=19 t=9.9e-03 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=19 i=0 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=1 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=2 t=7.5e-03 per=1.4e+01 cost=4.6e+03 flops=6.2e+05
 sigma[gemm] counter=19 i=3 t=7.5e-03 per=1.4e+01 cost=4.7e+03 flops=6.2e+05
 sigma[gemm] counter=19 i=4 t=7.6e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=19 i=5 t=7.5e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=19 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.1e+05
 sigma[red] counter=19 t=1.3e-02 per=2.4e+01 cost=7.8e+03 flops=6.2e+05
----- TIMING FOR sigma_tot : t_inter=1.9e-01 t_gemm=5.7e-01 t_reduction=2.4e-01 tot=9.9e-01 -----
 sigma_tot[inter] counter=19 t=1.9e-01 per=1.9e+01 cost=1.4e+05 flops=7.5e+05
 sigma_tot[gemm] counter=19 i=0 t=3.7e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=1 t=3.1e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=2 t=1.4e-01 per=1.4e+01 cost=3.9e+04 flops=2.8e+05
 sigma_tot[gemm] counter=19 i=3 t=1.4e-01 per=1.4e+01 cost=3.9e+04 flops=2.7e+05
 sigma_tot[gemm] counter=19 i=4 t=1.4e-01 per=1.4e+01 cost=6.9e+04 flops=4.8e+05
 sigma_tot[gemm] counter=19 i=5 t=1.4e-01 per=1.4e+01 cost=6.7e+04 flops=4.8e+05
 sigma_tot[gemm] counter=19 total t=5.7e-01 per=5.7e+01 cost=2.1e+05 flops=3.8e+05
 sigma_tot[red] counter=19 t=2.4e-01 per=2.4e+01 cost=6.6e+04 flops=2.8e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,2.9e-06,1.0e-06,1.9e-07
    4   0 +    -116.208089881617 -6.963e-08  6.534e-06    3     4  2.513e-01 6.283e-02 5.425e-02
TIMING FOR Davidson : 2.513e-01  T(cal/comm/rest)=2.170e-01,5.200e-07,3.433e-02
decomposed t_rest=3.433e-02
 T(sub)    =8.984e-05 per=2.617e-01
 T(precond)=3.412e-02 per=9.940e+01
 T(ortho)  =1.012e-05 per=2.947e-02
 T(xcopy)  =6.470e-07 per=1.885e-03
 T(xnrm2)  =1.887e-06 per=5.497e-03
 T(other)  =1.019e-04 per=2.968e-01
optimized energies: isweep=0 ibond=4 dots=1 e[0]=-116.208089881617 nmvp=4
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=7.166e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond4.txt
 qbond: qsuper nsym=6 dimAll=16
 (8,2):4 (10,2):3 (9,3):4 (9,1):3 (7,3):1 (8,4):1
timing for divide=9.1e-06
timing for compute=9.6e-03
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(nkr): 9.6e-03 S T(divide/compute[cpu/gpu/rest]/collect)=9.1e-06,9.6e-03,0.0e+00,4.4e-06,1.3e-05 -----
decimation summary: 16->5 dwt=-2.220e-16 SvN=7.464e-01
 qbond: qkept nsym=3 dimAll=5
 (9,1):3 (8,2):1 (9,3):1
----- TIMING for decimation_row(nkr): 9.879e-03 S T(decim/select/formRot)=9.681e-03,1.791e-04,1.903e-05 -----
----- TIMING FOR onedot_decimation: 9.932e-03 S T(wf/decim)=4.181e-05,9.890e-03 -----
ctns::oper_renorm coord=(5,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=5,5 size(op)=11:8.392e-05MB size(tot)=661:5.043e-03MB:4.925e-06GB
        per(mem): H:1.66 C:3.63 S:8.47 A:0 B:86.2 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.739e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 1.286e-02 S -----
rank=0 GPUmem(GB): used=5.429e-05 (oper)=2.509e-05
rank=0 GPUmem(GB): used=5.442e-05 (oper,site)=2.509e-05,1.267e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=287
 no. of coefficients=4090:3.120e-02MB:3.047e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.463e-03 S -----
rank=0 GPUmem(GB): used=8.489e-05 (oper,site,rinter)=2.509e-05,1.267e-07,3.047e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.177e-03 S size(rtasks)=185 size(Rlst2)=9 T(Rmu/Rlist)=1.454e-03,7.231e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.282e-03 S size(rtasks)=185 size(Rlst)=423 -----
rank=0 GPUmem(GB): used=8.489e-05 avail=6.176e+00 total=6.176e+00 batch[need]=8.824e-05 blksize=9 blksize0=9 batchsize=423
rank=0 GPUmem(GB): used=1.731e-04 (oper,site,rinter,batch)=2.509e-05,1.267e-07,3.047e-05,8.824e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.295e-03,2.264e-02,1.008e-02
----- TIMING FOR renorm : t_inter=7.3e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=5 t=7.3e-03 per=1.8e+01 cost=3.8e+04 flops=5.2e+06
 renorm[gemm] counter=5 i=0 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=2 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=3 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=4 t=7.6e-03 per=1.9e+01 cost=1.7e+03 flops=2.2e+05
 renorm[gemm] counter=5 i=5 t=7.6e-03 per=1.9e+01 cost=4.6e+03 flops=6.1e+05
 renorm[gemm] counter=5 i=6 t=7.5e-03 per=1.9e+01 cost=4.4e+03 flops=5.9e+05
 renorm[gemm] counter=5 total t=2.3e-02 per=5.7e+01 cost=1.1e+04 flops=4.8e+05
 renorm[red] counter=5 t=1.0e-02 per=2.5e+01 cost=1.8e+03 flops=1.8e+05
----- TIMING FOR renorm_tot : t_inter=2.7e-02 t_gemm=1.1e-01 t_reduction=5.0e-02 tot=1.9e-01 -----
 renorm_tot[inter] counter=5 t=2.7e-02 per=1.4e+01 cost=1.4e+05 flops=5.2e+06
 renorm_tot[gemm] counter=5 i=0 t=6.6e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=1 t=5.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=2 t=5.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=3 t=5.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=4 t=3.8e-02 per=2.0e+01 cost=1.8e+05 flops=4.8e+06
 renorm_tot[gemm] counter=5 i=5 t=3.8e-02 per=2.0e+01 cost=1.6e+05 flops=4.4e+06
 renorm_tot[gemm] counter=5 i=6 t=3.8e-02 per=2.0e+01 cost=1.2e+06 flops=3.2e+07
 renorm_tot[gemm] counter=5 total t=1.1e-01 per=5.9e+01 cost=1.6e+06 flops=1.4e+07
 renorm_tot[red] counter=5 t=5.0e-02 per=2.7e+01 cost=5.6e+05 flops=1.1e+07
qops.to_cpu: size(tot)=661:5.0e-03MB:4.9e-06GB T(to_cpu)=1.8e-04S speed=2.7e-02GB/S
check ||H-H.dagger||=3.538e-17 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.0628 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=5.012e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.586e-04 change=-1.519e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.586e-04 change=-5.066e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 5.078e-01 S #####
 T(local opt: fetch) = 1.076e-02 S  per = 2.12  per(accum) = 2.12
 T(local opt: hdiag) = 1.513e-01 S  per = 29.8  per(accum) = 31.9
 T(local opt: dvdsn) = 2.716e-01 S  per = 53.5  per(accum) = 85.4
 T(local opt: decim) = 9.940e-03 S  per = 1.96  per(accum) = 87.4
 T(local opt: guess) = 6.644e-05 S  per = 0.0131  per(accum) = 87.4
 T(local opt: renrm) = 6.393e-02 S  per = 12.6  per(accum) = 100
 T(local opt: save ) = 1.755e-04 S  per = 0.0346  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.716e-01 S  T(sum) = 2.714e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 8.066e-05 S  per = 0.0297  per(accum) = 0.0297
 T(local opt: symbolic_formulae           ) = 1.075e-02 S  per = 3.96  per(accum) = 3.99
 T(local opt: hintermediate init          ) = 2.604e-04 S  per = 0.0959  per(accum) = 4.09
 T(local opt: preprocess_hformulae_Hxlist ) = 3.133e-03 S  per = 1.15  per(accum) = 5.24
 T(local opt: hmmtasks init               ) = 5.887e-03 S  per = 2.17  per(accum) = 7.41
 T(local opt: initial guess for dvdson    ) = 2.402e-06 S  per = 0.000885  per(accum) = 7.41
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.095e-01 S  per = 77.2  per(accum) = 84.6
 T(local opt: dvdson [cpu-gpu]            ) = 7.428e-03 S  per = 2.74  per(accum) = 87.3
 T(local opt: dvdson [nccl]               ) = 2.180e-05 S  per = 0.00803  per(accum) = 87.4
 T(local opt: dvdson [mpi]                ) = 5.200e-07 S  per = 0.000192  per(accum) = 87.4
 T(local opt: dvdson [rest part(linalg)]  ) = 3.433e-02 S  per = 12.6  per(accum) = 100
Detailed decomposition of T(renrm) = 6.393e-02 S  T(sum) = 6.393e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.066e-05 S  per = 0.0949  per(accum) = 0.0949
 T(local opt: qops init                    ) = 1.463e-03 S  per = 2.29  per(accum) = 2.38
 T(local opt: symbolic_formulae_renorm     ) = 1.287e-02 S  per = 20.1  per(accum) = 22.5
 T(local opt: allocate qops on gpu         ) = 5.312e-05 S  per = 0.0831  per(accum) = 22.6
 T(local opt: site memcpy cpu2gpu          ) = 7.977e-04 S  per = 1.25  per(accum) = 23.8
 T(local opt: rintermediate init           ) = 2.474e-03 S  per = 3.87  per(accum) = 27.7
 T(local opt: preprocess_formulae_Rlist2   ) = 2.299e-03 S  per =  3.6  per(accum) = 31.3
 T(local opt: rmmtasks init                ) = 2.464e-03 S  per = 3.85  per(accum) = 35.2
 T(local opt: qops memset on cpu           ) = 6.600e-08 S  per = 0.000103  per(accum) = 35.2
 T(local opt: preprocess_renorm_batchGPU   ) = 4.010e-02 S  per = 62.7  per(accum) = 97.9
 T(local opt: deallocate cpu and gpu memory) = 3.389e-05 S  per = 0.053  per(accum) = 97.9
 T(local opt: construct opS [ifdists=true] ) = 3.100e-08 S  per = 4.85e-05  per(accum) = 97.9
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 5.79e-05  per(accum) = 97.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.864e-04 S  per = 0.292  per(accum) = 98.2
 T(local opt: reduction of opS & opH [mpi] ) = 1.606e-05 S  per = 0.0251  per(accum) = 98.3
 T(local opt: qops_pool join and erase     ) = 1.115e-03 S  per = 1.74  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.296e-06 S  per = 0.00203  per(accum) = 100
##### sweep opt: 2.028e+00 S #####
 T(sweep opt: fetch) = 6.577e-02 S  per = 3.24  per(accum) = 3.24
 T(sweep opt: hdiag) = 3.464e-01 S  per = 17.1  per(accum) = 20.3
 T(sweep opt: dvdsn) = 1.247e+00 S  per = 61.5  per(accum) = 81.8
 T(sweep opt: decim) = 3.411e-02 S  per = 1.68  per(accum) = 83.5
 T(sweep opt: guess) = 4.577e-04 S  per = 0.0226  per(accum) = 83.5
 T(sweep opt: renrm) = 3.328e-01 S  per = 16.4  per(accum) = 99.9
 T(sweep opt: save ) = 1.183e-03 S  per = 0.0583  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.247e+00 S  T(sum) = 1.246e+00 S  per = 9.993e+01
 T(sweep opt: preprocess                  ) = 5.916e-04 S  per = 0.0475  per(accum) = 0.0475
 T(sweep opt: symbolic_formulae           ) = 2.799e-02 S  per = 2.25  per(accum) = 2.29
 T(sweep opt: hintermediate init          ) = 7.757e-04 S  per = 0.0622  per(accum) = 2.36
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.490e-03 S  per = 0.601  per(accum) = 2.96
 T(sweep opt: hmmtasks init               ) = 1.072e-02 S  per = 0.86  per(accum) = 3.82
 T(sweep opt: initial guess for dvdson    ) = 2.086e-05 S  per = 0.00167  per(accum) = 3.82
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 9.953e-01 S  per = 79.9  per(accum) = 83.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.828e-02 S  per = 2.27  per(accum) = 86
 T(sweep opt: dvdson [nccl]               ) = 1.109e-04 S  per = 0.0089  per(accum) = 86
 T(sweep opt: dvdson [mpi]                ) = 2.345e-06 S  per = 0.000188  per(accum) = 86
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.748e-01 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 3.328e-01 S  T(sum) = 3.328e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.979e-04 S  per = 0.15  per(accum) = 0.15
 T(sweep opt: qops init                    ) = 6.206e-03 S  per = 1.86  per(accum) = 2.01
 T(sweep opt: symbolic_formulae_renorm     ) = 2.998e-02 S  per = 9.01  per(accum) = 11
 T(sweep opt: allocate qops on gpu         ) = 2.493e-04 S  per = 0.0749  per(accum) = 11.1
 T(sweep opt: site memcpy cpu2gpu          ) = 4.581e-03 S  per = 1.38  per(accum) = 12.5
 T(sweep opt: rintermediate init           ) = 1.005e-02 S  per = 3.02  per(accum) = 15.5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.980e-02 S  per = 5.95  per(accum) = 21.4
 T(sweep opt: rmmtasks init                ) = 6.315e-02 S  per =   19  per(accum) = 40.4
 T(sweep opt: qops memset on cpu           ) = 2.270e-07 S  per = 6.82e-05  per(accum) = 40.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.907e-01 S  per = 57.3  per(accum) = 97.7
 T(sweep opt: deallocate cpu and gpu memory) = 6.025e-04 S  per = 0.181  per(accum) = 97.9
 T(sweep opt: construct opS [ifdists=true] ) = 1.610e-07 S  per = 4.84e-05  per(accum) = 97.9
 T(sweep opt: reduction of opS & opH [nccl]) = 1.860e-07 S  per = 5.59e-05  per(accum) = 97.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.635e-04 S  per = 0.199  per(accum) = 98.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.135e-04 S  per = 0.0341  per(accum) = 98.1
 T(sweep opt: qops_pool join and erase     ) = 6.226e-03 S  per = 1.87  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 8.135e-06 S  per = 0.00244  per(accum) = 100
##### global opt: 2.028e+00 S #####
 T(global opt: fetch) = 6.577e-02 S  per = 3.24  per(accum) = 3.24
 T(global opt: hdiag) = 3.464e-01 S  per = 17.1  per(accum) = 20.3
 T(global opt: dvdsn) = 1.247e+00 S  per = 61.5  per(accum) = 81.8
 T(global opt: decim) = 3.411e-02 S  per = 1.68  per(accum) = 83.5
 T(global opt: guess) = 4.577e-04 S  per = 0.0226  per(accum) = 83.5
 T(global opt: renrm) = 3.328e-01 S  per = 16.4  per(accum) = 99.9
 T(global opt: save ) = 1.183e-03 S  per = 0.0583  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.247e+00 S  T(sum) = 1.246e+00 S  per = 9.993e+01
 T(global opt: preprocess                  ) = 5.916e-04 S  per = 0.0475  per(accum) = 0.0475
 T(global opt: symbolic_formulae           ) = 2.799e-02 S  per = 2.25  per(accum) = 2.29
 T(global opt: hintermediate init          ) = 7.757e-04 S  per = 0.0622  per(accum) = 2.36
 T(global opt: preprocess_hformulae_Hxlist ) = 7.490e-03 S  per = 0.601  per(accum) = 2.96
 T(global opt: hmmtasks init               ) = 1.072e-02 S  per = 0.86  per(accum) = 3.82
 T(global opt: initial guess for dvdson    ) = 2.086e-05 S  per = 0.00167  per(accum) = 3.82
 T(global opt: dvdson [Hx_batchGPU]        ) = 9.953e-01 S  per = 79.9  per(accum) = 83.7
 T(global opt: dvdson [cpu-gpu]            ) = 2.828e-02 S  per = 2.27  per(accum) = 86
 T(global opt: dvdson [nccl]               ) = 1.109e-04 S  per = 0.0089  per(accum) = 86
 T(global opt: dvdson [mpi]                ) = 2.345e-06 S  per = 0.000188  per(accum) = 86
 T(global opt: dvdson [rest part(linalg)]  ) = 1.748e-01 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 3.328e-01 S  T(sum) = 3.328e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.979e-04 S  per = 0.15  per(accum) = 0.15
 T(global opt: qops init                    ) = 6.206e-03 S  per = 1.86  per(accum) = 2.01
 T(global opt: symbolic_formulae_renorm     ) = 2.998e-02 S  per = 9.01  per(accum) = 11
 T(global opt: allocate qops on gpu         ) = 2.493e-04 S  per = 0.0749  per(accum) = 11.1
 T(global opt: site memcpy cpu2gpu          ) = 4.581e-03 S  per = 1.38  per(accum) = 12.5
 T(global opt: rintermediate init           ) = 1.005e-02 S  per = 3.02  per(accum) = 15.5
 T(global opt: preprocess_formulae_Rlist2   ) = 1.980e-02 S  per = 5.95  per(accum) = 21.4
 T(global opt: rmmtasks init                ) = 6.315e-02 S  per =   19  per(accum) = 40.4
 T(global opt: qops memset on cpu           ) = 2.270e-07 S  per = 6.82e-05  per(accum) = 40.4
 T(global opt: preprocess_renorm_batchGPU   ) = 1.907e-01 S  per = 57.3  per(accum) = 97.7
 T(global opt: deallocate cpu and gpu memory) = 6.025e-04 S  per = 0.181  per(accum) = 97.9
 T(global opt: construct opS [ifdists=true] ) = 1.610e-07 S  per = 4.84e-05  per(accum) = 97.9
 T(global opt: reduction of opS & opH [nccl]) = 1.860e-07 S  per = 5.59e-05  per(accum) = 97.9
 T(global opt: qops memcpy gpu2cpu          ) = 6.635e-04 S  per = 0.199  per(accum) = 98.1
 T(global opt: reduction of opS & opH [mpi] ) = 1.135e-04 S  per = 0.0341  per(accum) = 98.1
 T(global opt: qops_pool join and erase     ) = 6.226e-03 S  per = 1.87  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 8.135e-06 S  per = 0.00244  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-7.082e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=5/seqsize=34 dots=1 dbond=(6,0)-(7,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=787:6.004e-03MB:5.864e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=6,13,1
 suppl= 0 1 2 3 4 16
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 17
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=5,5 size(op)=11:8.392e-05MB size(tot)=661:5.043e-03MB:4.925e-06GB
        per(mem): H:1.66 C:3.63 S:8.47 A:0 B:86.2 
 rqops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1192:0.00909MB:8.88e-06GB
        per(mem): H:1.17 C:5.45 S:2.94 P:0 Q:90.4 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=4189:0.032MB:3.12e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.009e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(6,0) fdel=./scratch/sweep/rop(7,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-9.179e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(5,6,4) nnz=23:1.755e-04MB
qtensor3: wf3 own=1 _data=0x3c6766c0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=5
 (9,1):3 (8,2):1 (9,3):1
 qbond: qcol nsym=3 dimAll=6
 (20,0):3 (20,-2):2 (21,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=6 nblocks=36 size=23:1.755e-04MB
### DIAG TIMING: total=2.118e-01 t1=2.340e-05, t2=2.187e-03, t3=2.479e-03, t4=2.071e-01, t5=5.908e-06, t6=1.503e-05, t7=4.324e-06
duration_diagGPU:2.118e-01
duration_diagreduce:7.400e-08
duration_diagtransform:3.700e-07
----- TIMING FOR symbolic_formulae_onedot with size=813 : 1.405e-02 S -----
rank=0 GPUmem(GB): used=3.121e-05 (oper)=3.121e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=813
 no. of hintermediate operators=390
 no. of coefficients=5070:3.868e-02MB:3.777e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.410e-04 S -----
rank=0 GPUmem(GB): used=6.898e-05 (oper,hinter)=3.121e-05,3.777e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.587e-03 S size(H_formulae)=813 size(Hxlst2)=6 T(Hmu/Hxlist)=2.020e-03,2.567e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.897e-03 S size(H_formulae)=813 size(Hxlst)=1990 -----
rank=0 GPUmem(GB): used=6.898e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=3.427e-07 batch[need]=3.262e-04 blksize=9 blksize0=3 batchsize=1990
rank=0 GPUmem(GB): used=3.955e-04 (oper,hinter,dvdson,batch)=3.121e-05,3.777e-05,3.427e-07,3.262e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=23 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.908e-03,9.944e-03,2.982e-02,1.245e-02,5.413e-02
 analyze_tgpu[Hx]: ndim=23:1.714e-07GB T(cpu-gpu)=1.903e-03 speed=1.801e-04GB/S T(nccl)=5.487e-06 speed=6.246e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=20 t=9.9e-03 per=1.9e+01 cost=3.7e+04 flops=3.7e+06
 sigma[gemm] counter=20 i=0 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=1 t=1.0e-06 per=1.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=2 t=7.5e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=20 i=3 t=7.4e-03 per=1.4e+01 cost=9.7e+03 flops=1.3e+06
 sigma[gemm] counter=20 i=4 t=7.5e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=20 i=5 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=20 total t=3.0e-02 per=5.7e+01 cost=5.4e+04 flops=1.8e+06
 sigma[red] counter=20 t=1.2e-02 per=2.4e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=2.0e-01 t_gemm=6.0e-01 t_reduction=2.5e-01 tot=1.0e+00 -----
 sigma_tot[inter] counter=20 t=2.0e-01 per=1.9e+01 cost=1.8e+05 flops=9.0e+05
 sigma_tot[gemm] counter=20 i=0 t=3.8e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=1 t=3.2e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=2 t=1.5e-01 per=1.4e+01 cost=4.9e+04 flops=3.3e+05
 sigma_tot[gemm] counter=20 i=3 t=1.5e-01 per=1.4e+01 cost=4.8e+04 flops=3.2e+05
 sigma_tot[gemm] counter=20 i=4 t=1.5e-01 per=1.4e+01 cost=8.6e+04 flops=5.7e+05
 sigma_tot[gemm] counter=20 i=5 t=1.5e-01 per=1.4e+01 cost=8.4e+04 flops=5.7e+05
 sigma_tot[gemm] counter=20 total t=6.0e-01 per=5.7e+01 cost=2.7e+05 flops=4.5e+05
 sigma_tot[red] counter=20 t=2.5e-01 per=2.4e+01 cost=8.1e+04 flops=3.3e+05
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,4.5e-06,2.0e-06,9.2e-07,1.5e-07
settings: ndim=23 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.208089881617 -1.116e+03  9.302e-03    1     1  5.424e-02 5.424e-02 5.422e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.781e-03,1.195e-02,2.979e-02,1.247e-02,5.600e-02
 analyze_tgpu[Hx]: ndim=23:1.714e-07GB T(cpu-gpu)=1.775e-03 speed=1.931e-04GB/S T(nccl)=6.718e-06 speed=5.102e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.4e-02 -----
 sigma[inter] counter=21 t=1.2e-02 per=2.2e+01 cost=3.7e+04 flops=3.1e+06
 sigma[gemm] counter=21 i=0 t=3.6e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=1 t=3.1e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=2 t=7.4e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=21 i=3 t=7.4e-03 per=1.4e+01 cost=9.7e+03 flops=1.3e+06
 sigma[gemm] counter=21 i=4 t=7.5e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=21 i=5 t=7.5e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=21 total t=3.0e-02 per=5.5e+01 cost=5.4e+04 flops=1.8e+06
 sigma[red] counter=21 t=1.2e-02 per=2.3e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=2.1e-01 t_gemm=6.3e-01 t_reduction=2.6e-01 tot=1.1e+00 -----
 sigma_tot[inter] counter=21 t=2.1e-01 per=1.9e+01 cost=2.2e+05 flops=1.0e+06
 sigma_tot[gemm] counter=21 i=0 t=4.2e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=1 t=3.5e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=2 t=1.6e-01 per=1.4e+01 cost=5.9e+04 flops=3.8e+05
 sigma_tot[gemm] counter=21 i=3 t=1.6e-01 per=1.4e+01 cost=5.8e+04 flops=3.7e+05
 sigma_tot[gemm] counter=21 i=4 t=1.6e-01 per=1.4e+01 cost=1.0e+05 flops=6.5e+05
 sigma_tot[gemm] counter=21 i=5 t=1.6e-01 per=1.4e+01 cost=1.0e+05 flops=6.5e+05
 sigma_tot[gemm] counter=21 total t=6.3e-01 per=5.7e+01 cost=3.2e+05 flops=5.1e+05
 sigma_tot[red] counter=21 t=2.6e-01 per=2.4e+01 cost=9.7e+04 flops=3.7e+05
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=7.9e-06,1.9e-05,6.1e-06,1.5e-06,3.6e-07
    2   0 -    -116.208814694433 -7.248e-04  1.720e-03    2     2  1.215e-01 6.076e-02 5.520e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.306e-03,1.004e-02,2.956e-02,1.239e-02,5.331e-02
 analyze_tgpu[Hx]: ndim=23:1.714e-07GB T(cpu-gpu)=1.299e-03 speed=2.637e-04GB/S T(nccl)=6.394e-06 speed=5.360e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=22 t=1.0e-02 per=1.9e+01 cost=3.7e+04 flops=3.7e+06
 sigma[gemm] counter=22 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=2 t=7.4e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=22 i=3 t=7.4e-03 per=1.4e+01 cost=9.7e+03 flops=1.3e+06
 sigma[gemm] counter=22 i=4 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=22 i=5 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=22 total t=3.0e-02 per=5.7e+01 cost=5.4e+04 flops=1.8e+06
 sigma[red] counter=22 t=1.2e-02 per=2.4e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=2.2e-01 t_gemm=6.6e-01 t_reduction=2.7e-01 tot=1.2e+00 -----
 sigma_tot[inter] counter=22 t=2.2e-01 per=1.9e+01 cost=2.5e+05 flops=1.1e+06
 sigma_tot[gemm] counter=22 i=0 t=4.3e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=1 t=3.7e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=2 t=1.6e-01 per=1.4e+01 cost=6.9e+04 flops=4.2e+05
 sigma_tot[gemm] counter=22 i=3 t=1.6e-01 per=1.4e+01 cost=6.8e+04 flops=4.1e+05
 sigma_tot[gemm] counter=22 i=4 t=1.6e-01 per=1.4e+01 cost=1.2e+05 flops=7.3e+05
 sigma_tot[gemm] counter=22 i=5 t=1.6e-01 per=1.4e+01 cost=1.2e+05 flops=7.2e+05
 sigma_tot[gemm] counter=22 total t=6.6e-01 per=5.7e+01 cost=3.7e+05 flops=5.7e+05
 sigma_tot[red] counter=22 t=2.7e-01 per=2.4e+01 cost=1.1e+05 flops=4.1e+05
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.6e-05,3.3e-06,1.2e-06,2.1e-07
    3   0 -    -116.208827574025 -1.288e-05  4.129e-04    3     3  1.906e-01 6.354e-02 5.460e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.222e-03,9.947e-03,3.008e-02,1.259e-02,5.385e-02
 analyze_tgpu[Hx]: ndim=23:1.714e-07GB T(cpu-gpu)=1.217e-03 speed=2.815e-04GB/S T(nccl)=4.842e-06 speed=7.078e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=23 t=9.9e-03 per=1.9e+01 cost=3.7e+04 flops=3.7e+06
 sigma[gemm] counter=23 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=2 t=7.6e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=23 i=3 t=7.6e-03 per=1.4e+01 cost=9.7e+03 flops=1.3e+06
 sigma[gemm] counter=23 i=4 t=7.4e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=23 i=5 t=7.5e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=23 total t=3.0e-02 per=5.7e+01 cost=5.4e+04 flops=1.8e+06
 sigma[red] counter=23 t=1.3e-02 per=2.4e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=2.3e-01 t_gemm=6.9e-01 t_reduction=2.9e-01 tot=1.2e+00 -----
 sigma_tot[inter] counter=23 t=2.3e-01 per=1.9e+01 cost=2.9e+05 flops=1.3e+06
 sigma_tot[gemm] counter=23 i=0 t=4.5e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=1 t=3.8e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=2 t=1.7e-01 per=1.4e+01 cost=7.9e+04 flops=4.6e+05
 sigma_tot[gemm] counter=23 i=3 t=1.7e-01 per=1.4e+01 cost=7.7e+04 flops=4.5e+05
 sigma_tot[gemm] counter=23 i=4 t=1.7e-01 per=1.4e+01 cost=1.4e+05 flops=7.9e+05
 sigma_tot[gemm] counter=23 i=5 t=1.7e-01 per=1.4e+01 cost=1.4e+05 flops=7.9e+05
 sigma_tot[gemm] counter=23 total t=6.9e-01 per=5.7e+01 cost=4.3e+05 flops=6.2e+05
 sigma_tot[red] counter=23 t=2.9e-01 per=2.4e+01 cost=1.3e+05 flops=4.4e+05
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.3e-05,2.9e-06,1.0e-06,1.8e-07
    4   0 +    -116.208828591192 -1.017e-06  5.775e-05    3     4  2.541e-01 6.352e-02 5.444e-02
TIMING FOR Davidson : 2.541e-01  T(cal/comm/rest)=2.177e-01,6.000e-07,3.635e-02
decomposed t_rest=3.635e-02
 T(sub)    =9.257e-05 per=2.547e-01
 T(precond)=3.612e-02 per=9.937e+01
 T(ortho)  =1.054e-05 per=2.900e-02
 T(xcopy)  =5.940e-07 per=1.634e-03
 T(xnrm2)  =1.962e-06 per=5.398e-03
 T(other)  =1.218e-04 per=3.350e-01
optimized energies: isweep=0 ibond=5 dots=1 e[0]=-116.208828591192 nmvp=4
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.061e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond5.txt
 qbond: qsuper nsym=8 dimAll=20
 (9,1):4 (11,1):3 (10,2):5 (10,0):3 (8,2):1 (9,3):2 (11,3):1 (10,4):1
timing for divide=9.3e-06
timing for compute=1.2e-02
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=9.3e-06,1.2e-02,0.0e+00,4.1e-06,1.3e-05 -----
decimation summary: 20->6 dwt=+0.000e+00 SvN=1.007e+00
 qbond: qkept nsym=3 dimAll=6
 (10,0):3 (10,2):2 (9,1):1
----- TIMING for decimation_row(nkr): 1.181e-02 S T(decim/select/formRot)=1.159e-02,2.039e-04,1.972e-05 -----
----- TIMING FOR onedot_decimation: 1.187e-02 S T(wf/decim)=4.572e-05,1.182e-02 -----
ctns::oper_renorm coord=(6,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1192:9.094e-03MB:8.881e-06GB
        per(mem): H:1.17 C:2.94 S:5.45 A:0 B:90.4 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.238e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=237 : 9.122e-03 S -----
rank=0 GPUmem(GB): used=6.898e-05 (oper)=3.121e-05
rank=0 GPUmem(GB): used=6.916e-05 (oper,site)=3.121e-05,1.714e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=267
 no. of coefficients=5310:4.051e-02MB:3.956e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.491e-03 S -----
rank=0 GPUmem(GB): used=1.087e-04 (oper,site,rinter)=3.121e-05,1.714e-07,3.956e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.536e-03 S size(rtasks)=237 size(Rlst2)=9 T(Rmu/Rlist)=1.518e-03,1.018e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.684e-03 S size(rtasks)=237 size(Rlst)=647 -----
rank=0 GPUmem(GB): used=1.087e-04 avail=6.176e+00 total=6.176e+00 batch[need]=1.350e-04 blksize=9 blksize0=9 batchsize=647
rank=0 GPUmem(GB): used=2.437e-04 (oper,site,rinter,batch)=3.121e-05,1.714e-07,3.956e-05,1.350e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.831e-03,2.274e-02,9.933e-03
----- TIMING FOR renorm : t_inter=5.8e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=6 t=5.8e-03 per=1.5e+01 cost=5.4e+04 flops=9.2e+06
 renorm[gemm] counter=6 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=1 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=2 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=3 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=4 t=7.5e-03 per=2.0e+01 cost=2.3e+03 flops=3.1e+05
 renorm[gemm] counter=6 i=5 t=7.6e-03 per=2.0e+01 cost=8.1e+03 flops=1.1e+06
 renorm[gemm] counter=6 i=6 t=7.6e-03 per=2.0e+01 cost=9.2e+03 flops=1.2e+06
 renorm[gemm] counter=6 total t=2.3e-02 per=5.9e+01 cost=2.0e+04 flops=8.6e+05
 renorm[red] counter=6 t=9.9e-03 per=2.6e+01 cost=4.4e+03 flops=4.4e+05
----- TIMING FOR renorm_tot : t_inter=3.3e-02 t_gemm=1.4e-01 t_reduction=6.0e-02 tot=2.3e-01 -----
 renorm_tot[inter] counter=6 t=3.3e-02 per=1.4e+01 cost=1.9e+05 flops=5.9e+06
 renorm_tot[gemm] counter=6 i=0 t=7.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=1 t=6.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=2 t=6.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=3 t=6.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=4 t=4.5e-02 per=2.0e+01 cost=1.8e+05 flops=4.1e+06
 renorm_tot[gemm] counter=6 i=5 t=4.5e-02 per=2.0e+01 cost=1.7e+05 flops=3.8e+06
 renorm_tot[gemm] counter=6 i=6 t=4.5e-02 per=2.0e+01 cost=1.2e+06 flops=2.7e+07
 renorm_tot[gemm] counter=6 total t=1.4e-01 per=5.9e+01 cost=1.6e+06 flops=1.2e+07
 renorm_tot[red] counter=6 t=6.0e-02 per=2.6e+01 cost=5.6e+05 flops=9.3e+06
qops.to_cpu: size(tot)=1192:9.1e-03MB:8.9e-06GB T(to_cpu)=2.2e-04S speed=4.1e-02GB/S
check ||H-H.dagger||=5.025e-15 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.0608 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=6.447e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.335e-03 change=-1.721e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.335e-03 change=-6.258e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 5.810e-01 S #####
 T(local opt: fetch) = 1.065e-02 S  per = 1.83  per(accum) = 1.83
 T(local opt: hdiag) = 2.118e-01 S  per = 36.5  per(accum) = 38.3
 T(local opt: dvdsn) = 2.841e-01 S  per = 48.9  per(accum) = 87.2
 T(local opt: decim) = 1.188e-02 S  per = 2.04  per(accum) = 89.2
 T(local opt: guess) = 7.575e-05 S  per = 0.013  per(accum) = 89.2
 T(local opt: renrm) = 6.233e-02 S  per = 10.7  per(accum) = 100
 T(local opt: save ) = 1.974e-04 S  per = 0.034  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.841e-01 S  T(sum) = 2.838e-01 S  per = 9.992e+01
 T(local opt: preprocess                  ) = 9.726e-05 S  per = 0.0343  per(accum) = 0.0343
 T(local opt: symbolic_formulae           ) = 1.406e-02 S  per = 4.95  per(accum) = 4.99
 T(local opt: hintermediate init          ) = 3.571e-04 S  per = 0.126  per(accum) = 5.11
 T(local opt: preprocess_hformulae_Hxlist ) = 4.954e-03 S  per = 1.75  per(accum) = 6.86
 T(local opt: hmmtasks init               ) = 1.027e-02 S  per = 3.62  per(accum) = 10.5
 T(local opt: initial guess for dvdson    ) = 3.600e-06 S  per = 0.00127  per(accum) = 10.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.115e-01 S  per = 74.5  per(accum) = 85
 T(local opt: dvdson [cpu-gpu]            ) = 6.195e-03 S  per = 2.18  per(accum) = 87.2
 T(local opt: dvdson [nccl]               ) = 2.344e-05 S  per = 0.00826  per(accum) = 87.2
 T(local opt: dvdson [mpi]                ) = 6.000e-07 S  per = 0.000211  per(accum) = 87.2
 T(local opt: dvdson [rest part(linalg)]  ) = 3.635e-02 S  per = 12.8  per(accum) = 100
Detailed decomposition of T(renrm) = 6.233e-02 S  T(sum) = 6.233e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 9.481e-05 S  per = 0.152  per(accum) = 0.152
 T(local opt: qops init                    ) = 1.763e-03 S  per = 2.83  per(accum) = 2.98
 T(local opt: symbolic_formulae_renorm     ) = 9.136e-03 S  per = 14.7  per(accum) = 17.6
 T(local opt: allocate qops on gpu         ) = 6.783e-05 S  per = 0.109  per(accum) = 17.7
 T(local opt: site memcpy cpu2gpu          ) = 2.224e-03 S  per = 3.57  per(accum) = 21.3
 T(local opt: rintermediate init           ) = 2.502e-03 S  per = 4.01  per(accum) = 25.3
 T(local opt: preprocess_formulae_Rlist2   ) = 2.708e-03 S  per = 4.34  per(accum) = 29.7
 T(local opt: rmmtasks init                ) = 3.576e-03 S  per = 5.74  per(accum) = 35.4
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 5.45e-05  per(accum) = 35.4
 T(local opt: preprocess_renorm_batchGPU   ) = 3.859e-02 S  per = 61.9  per(accum) = 97.3
 T(local opt: deallocate cpu and gpu memory) = 3.932e-05 S  per = 0.0631  per(accum) = 97.4
 T(local opt: construct opS [ifdists=true] ) = 4.100e-08 S  per = 6.58e-05  per(accum) = 97.4
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 5.94e-05  per(accum) = 97.4
 T(local opt: qops memcpy gpu2cpu          ) = 2.240e-04 S  per = 0.359  per(accum) = 97.7
 T(local opt: reduction of opS & opH [mpi] ) = 1.605e-05 S  per = 0.0257  per(accum) = 97.8
 T(local opt: qops_pool join and erase     ) = 1.389e-03 S  per = 2.23  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.525e-06 S  per = 0.00245  per(accum) = 100
##### sweep opt: 2.609e+00 S #####
 T(sweep opt: fetch) = 7.642e-02 S  per = 2.93  per(accum) = 2.93
 T(sweep opt: hdiag) = 5.582e-01 S  per = 21.4  per(accum) = 24.3
 T(sweep opt: dvdsn) = 1.531e+00 S  per = 58.7  per(accum) = 83
 T(sweep opt: decim) = 4.599e-02 S  per = 1.76  per(accum) = 84.8
 T(sweep opt: guess) = 5.335e-04 S  per = 0.0204  per(accum) = 84.8
 T(sweep opt: renrm) = 3.951e-01 S  per = 15.1  per(accum) = 99.9
 T(sweep opt: save ) = 1.380e-03 S  per = 0.0529  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.531e+00 S  T(sum) = 1.530e+00 S  per = 9.993e+01
 T(sweep opt: preprocess                  ) = 6.889e-04 S  per = 0.045  per(accum) = 0.045
 T(sweep opt: symbolic_formulae           ) = 4.205e-02 S  per = 2.75  per(accum) = 2.79
 T(sweep opt: hintermediate init          ) = 1.133e-03 S  per = 0.074  per(accum) = 2.87
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.244e-02 S  per = 0.813  per(accum) = 3.68
 T(sweep opt: hmmtasks init               ) = 2.099e-02 S  per = 1.37  per(accum) = 5.05
 T(sweep opt: initial guess for dvdson    ) = 2.446e-05 S  per = 0.0016  per(accum) = 5.05
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.207e+00 S  per = 78.9  per(accum) = 83.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.447e-02 S  per = 2.25  per(accum) = 86.2
 T(sweep opt: dvdson [nccl]               ) = 1.344e-04 S  per = 0.00878  per(accum) = 86.2
 T(sweep opt: dvdson [mpi]                ) = 2.945e-06 S  per = 0.000192  per(accum) = 86.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.112e-01 S  per = 13.8  per(accum) = 100
Detailed decomposition of T(renrm) = 3.951e-01 S  T(sum) = 3.951e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.927e-04 S  per = 0.15  per(accum) = 0.15
 T(sweep opt: qops init                    ) = 7.968e-03 S  per = 2.02  per(accum) = 2.17
 T(sweep opt: symbolic_formulae_renorm     ) = 3.911e-02 S  per =  9.9  per(accum) = 12.1
 T(sweep opt: allocate qops on gpu         ) = 3.172e-04 S  per = 0.0803  per(accum) = 12.1
 T(sweep opt: site memcpy cpu2gpu          ) = 6.804e-03 S  per = 1.72  per(accum) = 13.9
 T(sweep opt: rintermediate init           ) = 1.255e-02 S  per = 3.18  per(accum) = 17
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.251e-02 S  per =  5.7  per(accum) = 22.7
 T(sweep opt: rmmtasks init                ) = 6.672e-02 S  per = 16.9  per(accum) = 39.6
 T(sweep opt: qops memset on cpu           ) = 2.610e-07 S  per = 6.61e-05  per(accum) = 39.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.293e-01 S  per =   58  per(accum) = 97.7
 T(sweep opt: deallocate cpu and gpu memory) = 6.418e-04 S  per = 0.162  per(accum) = 97.8
 T(sweep opt: construct opS [ifdists=true] ) = 2.020e-07 S  per = 5.11e-05  per(accum) = 97.8
 T(sweep opt: reduction of opS & opH [nccl]) = 2.230e-07 S  per = 5.64e-05  per(accum) = 97.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 8.876e-04 S  per = 0.225  per(accum) = 98
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.295e-04 S  per = 0.0328  per(accum) = 98.1
 T(sweep opt: qops_pool join and erase     ) = 7.615e-03 S  per = 1.93  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 9.660e-06 S  per = 0.00244  per(accum) = 100
##### global opt: 2.609e+00 S #####
 T(global opt: fetch) = 7.642e-02 S  per = 2.93  per(accum) = 2.93
 T(global opt: hdiag) = 5.582e-01 S  per = 21.4  per(accum) = 24.3
 T(global opt: dvdsn) = 1.531e+00 S  per = 58.7  per(accum) = 83
 T(global opt: decim) = 4.599e-02 S  per = 1.76  per(accum) = 84.8
 T(global opt: guess) = 5.335e-04 S  per = 0.0204  per(accum) = 84.8
 T(global opt: renrm) = 3.951e-01 S  per = 15.1  per(accum) = 99.9
 T(global opt: save ) = 1.380e-03 S  per = 0.0529  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.531e+00 S  T(sum) = 1.530e+00 S  per = 9.993e+01
 T(global opt: preprocess                  ) = 6.889e-04 S  per = 0.045  per(accum) = 0.045
 T(global opt: symbolic_formulae           ) = 4.205e-02 S  per = 2.75  per(accum) = 2.79
 T(global opt: hintermediate init          ) = 1.133e-03 S  per = 0.074  per(accum) = 2.87
 T(global opt: preprocess_hformulae_Hxlist ) = 1.244e-02 S  per = 0.813  per(accum) = 3.68
 T(global opt: hmmtasks init               ) = 2.099e-02 S  per = 1.37  per(accum) = 5.05
 T(global opt: initial guess for dvdson    ) = 2.446e-05 S  per = 0.0016  per(accum) = 5.05
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.207e+00 S  per = 78.9  per(accum) = 83.9
 T(global opt: dvdson [cpu-gpu]            ) = 3.447e-02 S  per = 2.25  per(accum) = 86.2
 T(global opt: dvdson [nccl]               ) = 1.344e-04 S  per = 0.00878  per(accum) = 86.2
 T(global opt: dvdson [mpi]                ) = 2.945e-06 S  per = 0.000192  per(accum) = 86.2
 T(global opt: dvdson [rest part(linalg)]  ) = 2.112e-01 S  per = 13.8  per(accum) = 100
Detailed decomposition of T(renrm) = 3.951e-01 S  T(sum) = 3.951e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.927e-04 S  per = 0.15  per(accum) = 0.15
 T(global opt: qops init                    ) = 7.968e-03 S  per = 2.02  per(accum) = 2.17
 T(global opt: symbolic_formulae_renorm     ) = 3.911e-02 S  per =  9.9  per(accum) = 12.1
 T(global opt: allocate qops on gpu         ) = 3.172e-04 S  per = 0.0803  per(accum) = 12.1
 T(global opt: site memcpy cpu2gpu          ) = 6.804e-03 S  per = 1.72  per(accum) = 13.9
 T(global opt: rintermediate init           ) = 1.255e-02 S  per = 3.18  per(accum) = 17
 T(global opt: preprocess_formulae_Rlist2   ) = 2.251e-02 S  per =  5.7  per(accum) = 22.7
 T(global opt: rmmtasks init                ) = 6.672e-02 S  per = 16.9  per(accum) = 39.6
 T(global opt: qops memset on cpu           ) = 2.610e-07 S  per = 6.61e-05  per(accum) = 39.6
 T(global opt: preprocess_renorm_batchGPU   ) = 2.293e-01 S  per =   58  per(accum) = 97.7
 T(global opt: deallocate cpu and gpu memory) = 6.418e-04 S  per = 0.162  per(accum) = 97.8
 T(global opt: construct opS [ifdists=true] ) = 2.020e-07 S  per = 5.11e-05  per(accum) = 97.8
 T(global opt: reduction of opS & opH [nccl]) = 2.230e-07 S  per = 5.64e-05  per(accum) = 97.8
 T(global opt: qops memcpy gpu2cpu          ) = 8.876e-04 S  per = 0.225  per(accum) = 98
 T(global opt: reduction of opS & opH [mpi] ) = 1.295e-04 S  per = 0.0328  per(accum) = 98.1
 T(global opt: qops_pool join and erase     ) = 7.615e-03 S  per = 1.93  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 9.660e-06 S  per = 0.00244  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.038e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=6/seqsize=34 dots=1 dbond=(7,0)-(8,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=19:1.450e-04MB:1.416e-07GB
total mem of comb=783:5.974e-03MB:5.834e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=7,12,1
 suppl= 0 1 2 3 4 16 17
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 18
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1192:9.094e-03MB:8.881e-06GB
        per(mem): H:1.17 C:2.94 S:5.45 A:0 B:90.4 
 rqops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1506:0.0115MB:1.12e-05GB
        per(mem): H:0.93 C:3.98 S:2.66 P:0 Q:92.4 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=5034:0.0384MB:3.75e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.042e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(7,0) fdel=./scratch/sweep/rop(8,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.109e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,6,4) nnz=19:1.450e-04MB
qtensor3: wf3 own=1 _data=0x3c5f4640
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (10,0):3 (10,2):2 (9,1):1
 qbond: qcol nsym=3 dimAll=6
 (18,0):3 (18,-2):2 (19,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=19:1.450e-04MB
### DIAG TIMING: total=2.508e-01 t1=2.363e-05, t2=2.222e-03, t3=2.544e-03, t4=2.460e-01, t5=5.160e-06, t6=1.542e-05, t7=4.507e-06
duration_diagGPU:2.508e-01
duration_diagreduce:9.000e-08
duration_diagtransform:3.540e-07
----- TIMING FOR symbolic_formulae_onedot with size=1053 : 1.796e-02 S -----
rank=0 GPUmem(GB): used=3.751e-05 (oper)=3.751e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1053
 no. of hintermediate operators=518
 no. of coefficients=6216:4.742e-02MB:4.631e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.578e-04 S -----
rank=0 GPUmem(GB): used=8.382e-05 (oper,hinter)=3.751e-05,4.631e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.392e-03 S size(H_formulae)=1053 size(Hxlst2)=5 T(Hmu/Hxlist)=2.709e-03,2.682e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.729e-03 S size(H_formulae)=1053 size(Hxlst)=2250 -----
rank=0 GPUmem(GB): used=8.382e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.831e-07 batch[need]=3.688e-04 blksize=9 blksize0=3 batchsize=2250
rank=0 GPUmem(GB): used=4.529e-04 (oper,hinter,dvdson,batch)=3.751e-05,4.631e-05,2.831e-07,3.688e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=19 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.191e-04,1.009e-02,3.016e-02,1.237e-02,5.354e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=9.141e-04 speed=3.097e-04GB/S T(nccl)=4.999e-06 speed=5.664e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=24 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=24 i=0 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=1 t=1.0e-06 per=1.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=2 t=7.5e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=24 i=3 t=7.6e-03 per=1.4e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=24 i=4 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=24 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=24 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=24 t=1.2e-02 per=2.4e+01 cost=1.8e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=2.4e-01 t_gemm=7.2e-01 t_reduction=3.0e-01 tot=1.3e+00 -----
 sigma_tot[inter] counter=24 t=2.4e-01 per=1.9e+01 cost=3.3e+05 flops=1.4e+06
 sigma_tot[gemm] counter=24 i=0 t=4.6e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=1 t=3.9e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=2 t=1.8e-01 per=1.4e+01 cost=9.0e+04 flops=5.1e+05
 sigma_tot[gemm] counter=24 i=3 t=1.8e-01 per=1.4e+01 cost=8.9e+04 flops=5.0e+05
 sigma_tot[gemm] counter=24 i=4 t=1.8e-01 per=1.4e+01 cost=1.6e+05 flops=8.8e+05
 sigma_tot[gemm] counter=24 i=5 t=1.8e-01 per=1.4e+01 cost=1.6e+05 flops=8.7e+05
 sigma_tot[gemm] counter=24 total t=7.2e-01 per=5.7e+01 cost=4.9e+05 flops=6.9e+05
 sigma_tot[red] counter=24 t=3.0e-01 per=2.4e+01 cost=1.5e+05 flops=4.9e+05
T(sub)=9.2e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,3.9e-06,1.9e-06,6.9e-07,1.5e-07
settings: ndim=19 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.208828591192 -1.116e+03  4.959e-02    1     1  5.366e-02 5.366e-02 5.363e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.192e-03,9.920e-03,3.006e-02,1.252e-02,5.370e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.187e-03 speed=2.386e-04GB/S T(nccl)=4.741e-06 speed=5.972e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=25 t=9.9e-03 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=25 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=2 t=7.4e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=25 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=25 i=4 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=25 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=25 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=25 t=1.3e-02 per=2.4e+01 cost=1.8e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=2.5e-01 t_gemm=7.5e-01 t_reduction=3.1e-01 tot=1.3e+00 -----
 sigma_tot[inter] counter=25 t=2.5e-01 per=1.9e+01 cost=3.8e+05 flops=1.5e+06
 sigma_tot[gemm] counter=25 i=0 t=4.8e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=1 t=4.0e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=2 t=1.8e-01 per=1.4e+01 cost=1.0e+05 flops=5.5e+05
 sigma_tot[gemm] counter=25 i=3 t=1.9e-01 per=1.4e+01 cost=1.0e+05 flops=5.4e+05
 sigma_tot[gemm] counter=25 i=4 t=1.9e-01 per=1.4e+01 cost=1.8e+05 flops=9.6e+05
 sigma_tot[gemm] counter=25 i=5 t=1.9e-01 per=1.4e+01 cost=1.8e+05 flops=9.5e+05
 sigma_tot[gemm] counter=25 total t=7.5e-01 per=5.7e+01 cost=5.6e+05 flops=7.5e+05
 sigma_tot[red] counter=25 t=3.1e-01 per=2.4e+01 cost=1.6e+05 flops=5.3e+05
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.0e-05,3.4e-06,9.2e-07,1.9e-07
    2   0 -    -116.221269861784 -1.244e-02  6.706e-03    2     2  1.170e-01 5.851e-02 5.371e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.197e-03,9.940e-03,3.014e-02,1.240e-02,5.369e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.192e-03 speed=2.376e-04GB/S T(nccl)=5.343e-06 speed=5.299e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=26 t=9.9e-03 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=26 i=0 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=2 t=7.5e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=26 i=3 t=7.6e-03 per=1.4e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=26 i=4 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=26 i=5 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=26 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=26 t=1.2e-02 per=2.4e+01 cost=1.8e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=2.6e-01 t_gemm=7.8e-01 t_reduction=3.2e-01 tot=1.4e+00 -----
 sigma_tot[inter] counter=26 t=2.6e-01 per=1.9e+01 cost=4.2e+05 flops=1.6e+06
 sigma_tot[gemm] counter=26 i=0 t=4.9e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=1 t=4.2e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=2 t=1.9e-01 per=1.4e+01 cost=1.1e+05 flops=5.8e+05
 sigma_tot[gemm] counter=26 i=3 t=1.9e-01 per=1.4e+01 cost=1.1e+05 flops=5.8e+05
 sigma_tot[gemm] counter=26 i=4 t=1.9e-01 per=1.4e+01 cost=2.0e+05 flops=1.0e+06
 sigma_tot[gemm] counter=26 i=5 t=1.9e-01 per=1.4e+01 cost=2.0e+05 flops=1.0e+06
 sigma_tot[gemm] counter=26 total t=7.8e-01 per=5.7e+01 cost=6.2e+05 flops=8.0e+05
 sigma_tot[red] counter=26 t=3.2e-01 per=2.4e+01 cost=1.8e+05 flops=5.6e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,2.8e-06,9.5e-07,1.6e-07
    3   0 -    -116.221542303165 -2.724e-04  1.927e-03    3     3  1.804e-01 6.013e-02 5.374e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.521e-03,1.008e-02,3.031e-02,1.245e-02,5.436e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.516e-03 speed=1.868e-04GB/S T(nccl)=5.007e-06 speed=5.655e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=27 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=27 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=2 t=7.6e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=27 i=3 t=7.6e-03 per=1.4e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=27 i=4 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=27 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=27 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=27 t=1.2e-02 per=2.4e+01 cost=1.8e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=2.7e-01 t_gemm=8.1e-01 t_reduction=3.4e-01 tot=1.4e+00 -----
 sigma_tot[inter] counter=27 t=2.7e-01 per=1.9e+01 cost=4.6e+05 flops=1.7e+06
 sigma_tot[gemm] counter=27 i=0 t=5.1e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=1 t=4.3e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=2 t=2.0e-01 per=1.4e+01 cost=1.2e+05 flops=6.2e+05
 sigma_tot[gemm] counter=27 i=3 t=2.0e-01 per=1.4e+01 cost=1.2e+05 flops=6.1e+05
 sigma_tot[gemm] counter=27 i=4 t=2.0e-01 per=1.4e+01 cost=2.2e+05 flops=1.1e+06
 sigma_tot[gemm] counter=27 i=5 t=2.0e-01 per=1.4e+01 cost=2.2e+05 flops=1.1e+06
 sigma_tot[gemm] counter=27 total t=8.1e-01 per=5.7e+01 cost=6.9e+05 flops=8.6e+05
 sigma_tot[red] counter=27 t=3.4e-01 per=2.4e+01 cost=2.0e+05 flops=5.9e+05
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.3e-05,2.8e-06,9.6e-07,1.6e-07
    4   0 -    -116.221563718018 -2.141e-05  2.777e-04    3     4  2.441e-01 6.103e-02 5.391e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.234e-03,1.009e-02,3.046e-02,1.250e-02,5.429e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.229e-03 speed=2.304e-04GB/S T(nccl)=5.439e-06 speed=5.205e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=28 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=28 i=0 t=1.7e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=2 t=7.6e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=28 i=3 t=7.6e-03 per=1.4e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=28 i=4 t=7.7e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=28 i=5 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=28 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.1e+06
 sigma[red] counter=28 t=1.2e-02 per=2.4e+01 cost=1.8e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=2.8e-01 t_gemm=8.4e-01 t_reduction=3.5e-01 tot=1.5e+00 -----
 sigma_tot[inter] counter=28 t=2.8e-01 per=1.9e+01 cost=5.0e+05 flops=1.8e+06
 sigma_tot[gemm] counter=28 i=0 t=5.2e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=1 t=4.4e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=2 t=2.1e-01 per=1.4e+01 cost=1.3e+05 flops=6.5e+05
 sigma_tot[gemm] counter=28 i=3 t=2.1e-01 per=1.4e+01 cost=1.4e+05 flops=6.5e+05
 sigma_tot[gemm] counter=28 i=4 t=2.1e-01 per=1.4e+01 cost=2.4e+05 flops=1.2e+06
 sigma_tot[gemm] counter=28 i=5 t=2.1e-01 per=1.4e+01 cost=2.4e+05 flops=1.2e+06
 sigma_tot[gemm] counter=28 total t=8.4e-01 per=5.7e+01 cost=7.6e+05 flops=9.0e+05
 sigma_tot[red] counter=28 t=3.5e-01 per=2.4e+01 cost=2.2e+05 flops=6.2e+05
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.5e-05,2.9e-06,9.5e-07,1.5e-07
    5   0 +    -116.221564167486 -4.495e-07  6.231e-05    3     5  3.081e-01 6.161e-02 5.401e-02
TIMING FOR Davidson : 3.081e-01  T(cal/comm/rest)=2.700e-01,4.990e-07,3.804e-02
decomposed t_rest=3.804e-02
 T(sub)    =9.450e-05 per=2.484e-01
 T(precond)=3.780e-02 per=9.937e+01
 T(ortho)  =1.420e-05 per=3.732e-02
 T(xcopy)  =6.980e-07 per=1.835e-03
 T(xnrm2)  =1.988e-06 per=5.226e-03
 T(other)  =1.266e-04 per=3.327e-01
optimized energies: isweep=0 ibond=6 dots=1 e[0]=-116.221564167486 nmvp=5
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.269e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond6.txt
 qbond: qsuper nsym=8 dimAll=24
 (10,0):4 (12,0):3 (11,1):6 (11,-1):3 (10,2):3 (12,2):2 (11,3):2 (9,1):1
timing for divide=9.6e-06
timing for compute=1.2e-02
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=9.6e-06,1.2e-02,0.0e+00,4.2e-06,1.4e-05 -----
decimation summary: 24->6 dwt=+0.000e+00 SvN=9.121e-01
 qbond: qkept nsym=3 dimAll=6
 (12,0):3 (12,2):2 (11,1):1
----- TIMING for decimation_row(nkr): 1.269e-02 S T(decim/select/formRot)=1.244e-02,2.258e-04,1.967e-05 -----
----- TIMING FOR onedot_decimation: 1.274e-02 S T(wf/decim)=4.589e-05,1.270e-02 -----
ctns::oper_renorm coord=(7,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1506:1.149e-02MB:1.122e-05GB
        per(mem): H:0.93 C:2.66 S:3.98 A:0 B:92.4 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.546e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=297 : 1.157e-02 S -----
rank=0 GPUmem(GB): used=8.382e-05 (oper)=3.751e-05
rank=0 GPUmem(GB): used=8.396e-05 (oper,site)=3.751e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=247
 no. of coefficients=6538:4.988e-02MB:4.871e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.950e-04 S -----
rank=0 GPUmem(GB): used=1.327e-04 (oper,site,rinter)=3.751e-05,1.416e-07,4.871e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.619e-03 S size(rtasks)=297 size(Rlst2)=9 T(Rmu/Rlist)=1.631e-03,9.877e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.781e-03 S size(rtasks)=297 size(Rlst)=647 -----
rank=0 GPUmem(GB): used=1.327e-04 avail=6.176e+00 total=6.176e+00 batch[need]=1.350e-04 blksize=9 blksize0=9 batchsize=647
rank=0 GPUmem(GB): used=2.676e-04 (oper,site,rinter,batch)=3.751e-05,1.416e-07,4.871e-05,1.350e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.332e-03,4.418e-03,7.867e-03
----- TIMING FOR renorm : t_inter=1.3e-03 t_gemm=4.4e-03 t_reduction=7.9e-03 tot=1.4e-02 -----
 renorm[inter] counter=7 t=1.3e-03 per=9.8e+00 cost=7.0e+04 flops=5.3e+07
 renorm[gemm] counter=7 i=0 t=1.3e-06 per=9.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=1 t=1.1e-06 per=7.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=2 t=1.1e-06 per=7.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=3 t=1.0e-06 per=7.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=4 t=2.2e-03 per=1.6e+01 cost=2.7e+03 flops=1.2e+06
 renorm[gemm] counter=7 i=5 t=1.1e-03 per=7.9e+00 cost=9.6e+03 flops=8.9e+06
 renorm[gemm] counter=7 i=6 t=1.1e-03 per=8.4e+00 cost=9.4e+03 flops=8.2e+06
 renorm[gemm] counter=7 total t=4.4e-03 per=3.2e+01 cost=2.2e+04 flops=4.9e+06
 renorm[red] counter=7 t=7.9e-03 per=5.8e+01 cost=3.9e+03 flops=5.0e+05
----- TIMING FOR renorm_tot : t_inter=3.4e-02 t_gemm=1.4e-01 t_reduction=6.8e-02 tot=2.4e-01 -----
 renorm_tot[inter] counter=7 t=3.4e-02 per=1.4e+01 cost=2.6e+05 flops=7.8e+06
 renorm_tot[gemm] counter=7 i=0 t=9.1e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=1 t=7.5e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=2 t=7.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=3 t=7.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=4 t=4.7e-02 per=1.9e+01 cost=1.9e+05 flops=3.9e+06
 renorm_tot[gemm] counter=7 i=5 t=4.7e-02 per=1.9e+01 cost=1.8e+05 flops=3.9e+06
 renorm_tot[gemm] counter=7 i=6 t=4.6e-02 per=1.9e+01 cost=1.2e+06 flops=2.6e+07
 renorm_tot[gemm] counter=7 total t=1.4e-01 per=5.8e+01 cost=1.6e+06 flops=1.1e+07
 renorm_tot[red] counter=7 t=6.8e-02 per=2.8e+01 cost=5.7e+05 flops=8.3e+06
qops.to_cpu: size(tot)=1506:1.1e-02MB:1.1e-05GB T(to_cpu)=2.9e-04S speed=3.8e-02GB/S
check ||H-H.dagger||=1.533e-15 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.0364 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=7.613e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.007e-03 change=-1.895e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.007e-03 change=-5.960e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 6.581e-01 S #####
 T(local opt: fetch) = 1.228e-02 S  per = 1.87  per(accum) = 1.87
 T(local opt: hdiag) = 2.508e-01 S  per = 38.1  per(accum) = 40
 T(local opt: dvdsn) = 3.437e-01 S  per = 52.2  per(accum) = 92.2
 T(local opt: decim) = 1.275e-02 S  per = 1.94  per(accum) = 94.2
 T(local opt: guess) = 7.464e-05 S  per = 0.0113  per(accum) = 94.2
 T(local opt: renrm) = 3.813e-02 S  per = 5.79  per(accum) = 100
 T(local opt: save ) = 2.499e-04 S  per = 0.038  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.437e-01 S  T(sum) = 3.435e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 9.382e-05 S  per = 0.0273  per(accum) = 0.0273
 T(local opt: symbolic_formulae           ) = 1.797e-02 S  per = 5.23  per(accum) = 5.26
 T(local opt: hintermediate init          ) = 4.757e-04 S  per = 0.138  per(accum) = 5.4
 T(local opt: preprocess_hformulae_Hxlist ) = 5.798e-03 S  per = 1.69  per(accum) = 7.08
 T(local opt: hmmtasks init               ) = 1.110e-02 S  per = 3.23  per(accum) = 10.3
 T(local opt: initial guess for dvdson    ) = 2.538e-06 S  per = 0.000739  per(accum) = 10.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.640e-01 S  per = 76.8  per(accum) = 87.2
 T(local opt: dvdson [cpu-gpu]            ) = 6.037e-03 S  per = 1.76  per(accum) = 88.9
 T(local opt: dvdson [nccl]               ) = 2.553e-05 S  per = 0.00743  per(accum) = 88.9
 T(local opt: dvdson [mpi]                ) = 4.990e-07 S  per = 0.000145  per(accum) = 88.9
 T(local opt: dvdson [rest part(linalg)]  ) = 3.804e-02 S  per = 11.1  per(accum) = 100
Detailed decomposition of T(renrm) = 3.813e-02 S  T(sum) = 3.813e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.248e-05 S  per = 0.19  per(accum) = 0.19
 T(local opt: qops init                    ) = 2.155e-03 S  per = 5.65  per(accum) = 5.84
 T(local opt: symbolic_formulae_renorm     ) = 1.159e-02 S  per = 30.4  per(accum) = 36.2
 T(local opt: allocate qops on gpu         ) = 5.761e-05 S  per = 0.151  per(accum) = 36.4
 T(local opt: site memcpy cpu2gpu          ) = 1.503e-03 S  per = 3.94  per(accum) = 40.3
 T(local opt: rintermediate init           ) = 6.081e-04 S  per = 1.59  per(accum) = 41.9
 T(local opt: preprocess_formulae_Rlist2   ) = 2.805e-03 S  per = 7.36  per(accum) = 49.3
 T(local opt: rmmtasks init                ) = 3.657e-03 S  per = 9.59  per(accum) = 58.9
 T(local opt: qops memset on cpu           ) = 5.600e-08 S  per = 0.000147  per(accum) = 58.9
 T(local opt: preprocess_renorm_batchGPU   ) = 1.371e-02 S  per =   36  per(accum) = 94.8
 T(local opt: deallocate cpu and gpu memory) = 4.095e-05 S  per = 0.107  per(accum) = 94.9
 T(local opt: construct opS [ifdists=true] ) = 3.500e-08 S  per = 9.18e-05  per(accum) = 94.9
 T(local opt: reduction of opS & opH [nccl]) = 2.800e-08 S  per = 7.34e-05  per(accum) = 94.9
 T(local opt: qops memcpy gpu2cpu          ) = 3.008e-04 S  per = 0.789  per(accum) = 95.7
 T(local opt: reduction of opS & opH [mpi] ) = 1.679e-05 S  per = 0.044  per(accum) = 95.8
 T(local opt: qops_pool join and erase     ) = 1.615e-03 S  per = 4.24  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.514e-06 S  per = 0.00397  per(accum) = 100
##### sweep opt: 3.267e+00 S #####
 T(sweep opt: fetch) = 8.870e-02 S  per = 2.72  per(accum) = 2.72
 T(sweep opt: hdiag) = 8.090e-01 S  per = 24.8  per(accum) = 27.5
 T(sweep opt: dvdsn) = 1.875e+00 S  per = 57.4  per(accum) = 84.9
 T(sweep opt: decim) = 5.874e-02 S  per =  1.8  per(accum) = 86.7
 T(sweep opt: guess) = 6.081e-04 S  per = 0.0186  per(accum) = 86.7
 T(sweep opt: renrm) = 4.333e-01 S  per = 13.3  per(accum) = 100
 T(sweep opt: save ) = 1.630e-03 S  per = 0.0499  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.875e+00 S  T(sum) = 1.873e+00 S  per = 9.993e+01
 T(sweep opt: preprocess                  ) = 7.827e-04 S  per = 0.0418  per(accum) = 0.0418
 T(sweep opt: symbolic_formulae           ) = 6.002e-02 S  per =  3.2  per(accum) = 3.25
 T(sweep opt: hintermediate init          ) = 1.609e-03 S  per = 0.0859  per(accum) = 3.33
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.824e-02 S  per = 0.974  per(accum) = 4.31
 T(sweep opt: hmmtasks init               ) = 3.209e-02 S  per = 1.71  per(accum) = 6.02
 T(sweep opt: initial guess for dvdson    ) = 2.699e-05 S  per = 0.00144  per(accum) = 6.02
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.471e+00 S  per = 78.5  per(accum) = 84.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.051e-02 S  per = 2.16  per(accum) = 86.7
 T(sweep opt: dvdson [nccl]               ) = 1.599e-04 S  per = 0.00854  per(accum) = 86.7
 T(sweep opt: dvdson [mpi]                ) = 3.444e-06 S  per = 0.000184  per(accum) = 86.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.492e-01 S  per = 13.3  per(accum) = 100
Detailed decomposition of T(renrm) = 4.333e-01 S  T(sum) = 4.333e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.652e-04 S  per = 0.154  per(accum) = 0.154
 T(sweep opt: qops init                    ) = 1.012e-02 S  per = 2.34  per(accum) = 2.49
 T(sweep opt: symbolic_formulae_renorm     ) = 5.070e-02 S  per = 11.7  per(accum) = 14.2
 T(sweep opt: allocate qops on gpu         ) = 3.748e-04 S  per = 0.0865  per(accum) = 14.3
 T(sweep opt: site memcpy cpu2gpu          ) = 8.307e-03 S  per = 1.92  per(accum) = 16.2
 T(sweep opt: rintermediate init           ) = 1.316e-02 S  per = 3.04  per(accum) = 19.2
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.531e-02 S  per = 5.84  per(accum) = 25.1
 T(sweep opt: rmmtasks init                ) = 7.038e-02 S  per = 16.2  per(accum) = 41.3
 T(sweep opt: qops memset on cpu           ) = 3.170e-07 S  per = 7.32e-05  per(accum) = 41.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.430e-01 S  per = 56.1  per(accum) = 97.4
 T(sweep opt: deallocate cpu and gpu memory) = 6.828e-04 S  per = 0.158  per(accum) = 97.6
 T(sweep opt: construct opS [ifdists=true] ) = 2.370e-07 S  per = 5.47e-05  per(accum) = 97.6
 T(sweep opt: reduction of opS & opH [nccl]) = 2.510e-07 S  per = 5.79e-05  per(accum) = 97.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.188e-03 S  per = 0.274  per(accum) = 97.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.463e-04 S  per = 0.0338  per(accum) = 97.9
 T(sweep opt: qops_pool join and erase     ) = 9.230e-03 S  per = 2.13  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.117e-05 S  per = 0.00258  per(accum) = 100
##### global opt: 3.267e+00 S #####
 T(global opt: fetch) = 8.870e-02 S  per = 2.72  per(accum) = 2.72
 T(global opt: hdiag) = 8.090e-01 S  per = 24.8  per(accum) = 27.5
 T(global opt: dvdsn) = 1.875e+00 S  per = 57.4  per(accum) = 84.9
 T(global opt: decim) = 5.874e-02 S  per =  1.8  per(accum) = 86.7
 T(global opt: guess) = 6.081e-04 S  per = 0.0186  per(accum) = 86.7
 T(global opt: renrm) = 4.333e-01 S  per = 13.3  per(accum) = 100
 T(global opt: save ) = 1.630e-03 S  per = 0.0499  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.875e+00 S  T(sum) = 1.873e+00 S  per = 9.993e+01
 T(global opt: preprocess                  ) = 7.827e-04 S  per = 0.0418  per(accum) = 0.0418
 T(global opt: symbolic_formulae           ) = 6.002e-02 S  per =  3.2  per(accum) = 3.25
 T(global opt: hintermediate init          ) = 1.609e-03 S  per = 0.0859  per(accum) = 3.33
 T(global opt: preprocess_hformulae_Hxlist ) = 1.824e-02 S  per = 0.974  per(accum) = 4.31
 T(global opt: hmmtasks init               ) = 3.209e-02 S  per = 1.71  per(accum) = 6.02
 T(global opt: initial guess for dvdson    ) = 2.699e-05 S  per = 0.00144  per(accum) = 6.02
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.471e+00 S  per = 78.5  per(accum) = 84.5
 T(global opt: dvdson [cpu-gpu]            ) = 4.051e-02 S  per = 2.16  per(accum) = 86.7
 T(global opt: dvdson [nccl]               ) = 1.599e-04 S  per = 0.00854  per(accum) = 86.7
 T(global opt: dvdson [mpi]                ) = 3.444e-06 S  per = 0.000184  per(accum) = 86.7
 T(global opt: dvdson [rest part(linalg)]  ) = 2.492e-01 S  per = 13.3  per(accum) = 100
Detailed decomposition of T(renrm) = 4.333e-01 S  T(sum) = 4.333e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.652e-04 S  per = 0.154  per(accum) = 0.154
 T(global opt: qops init                    ) = 1.012e-02 S  per = 2.34  per(accum) = 2.49
 T(global opt: symbolic_formulae_renorm     ) = 5.070e-02 S  per = 11.7  per(accum) = 14.2
 T(global opt: allocate qops on gpu         ) = 3.748e-04 S  per = 0.0865  per(accum) = 14.3
 T(global opt: site memcpy cpu2gpu          ) = 8.307e-03 S  per = 1.92  per(accum) = 16.2
 T(global opt: rintermediate init           ) = 1.316e-02 S  per = 3.04  per(accum) = 19.2
 T(global opt: preprocess_formulae_Rlist2   ) = 2.531e-02 S  per = 5.84  per(accum) = 25.1
 T(global opt: rmmtasks init                ) = 7.038e-02 S  per = 16.2  per(accum) = 41.3
 T(global opt: qops memset on cpu           ) = 3.170e-07 S  per = 7.32e-05  per(accum) = 41.3
 T(global opt: preprocess_renorm_batchGPU   ) = 2.430e-01 S  per = 56.1  per(accum) = 97.4
 T(global opt: deallocate cpu and gpu memory) = 6.828e-04 S  per = 0.158  per(accum) = 97.6
 T(global opt: construct opS [ifdists=true] ) = 2.370e-07 S  per = 5.47e-05  per(accum) = 97.6
 T(global opt: reduction of opS & opH [nccl]) = 2.510e-07 S  per = 5.79e-05  per(accum) = 97.6
 T(global opt: qops memcpy gpu2cpu          ) = 1.188e-03 S  per = 0.274  per(accum) = 97.8
 T(global opt: reduction of opS & opH [mpi] ) = 1.463e-04 S  per = 0.0338  per(accum) = 97.9
 T(global opt: qops_pool join and erase     ) = 9.230e-03 S  per = 2.13  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.117e-05 S  per = 0.00258  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.253e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=7/seqsize=34 dots=1 dbond=(8,0)-(9,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=19:1.450e-04MB:1.416e-07GB
total mem of comb=783:5.974e-03MB:5.834e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=8,11,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc= 19
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1506:1.149e-02MB:1.122e-05GB
        per(mem): H:0.93 C:2.66 S:3.98 A:0 B:92.4 
 rqops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1860:0.0142MB:1.39e-05GB
        per(mem): H:0.753 C:2.96 S:2.42 P:0 Q:93.9 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=5702:0.0435MB:4.25e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.080e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(8,0) fdel=./scratch/sweep/rop(9,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.490e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,6,4) nnz=19:1.450e-04MB
qtensor3: wf3 own=1 _data=0x3c6e39a0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (12,0):3 (12,2):2 (11,1):1
 qbond: qcol nsym=3 dimAll=6
 (16,0):3 (16,-2):2 (17,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=19:1.450e-04MB
### DIAG TIMING: total=3.711e-01 t1=2.270e-05, t2=2.176e-03, t3=2.472e-03, t4=3.664e-01, t5=5.424e-06, t6=1.437e-05, t7=3.484e-06
duration_diagGPU:3.711e-01
duration_diagreduce:8.700e-08
duration_diagtransform:4.260e-07
----- TIMING FOR symbolic_formulae_onedot with size=1327 : 2.162e-02 S -----
rank=0 GPUmem(GB): used=4.248e-05 (oper)=4.248e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1327
 no. of hintermediate operators=664
 no. of coefficients=7304:5.573e-02MB:5.442e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.494e-04 S -----
rank=0 GPUmem(GB): used=9.690e-05 (oper,hinter)=4.248e-05,5.442e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.994e-03 S size(H_formulae)=1327 size(Hxlst2)=5 T(Hmu/Hxlist)=3.299e-03,3.696e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.500e-03 S size(H_formulae)=1327 size(Hxlst)=2830 -----
rank=0 GPUmem(GB): used=9.690e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.831e-07 batch[need]=4.639e-04 blksize=9 blksize0=3 batchsize=2830
rank=0 GPUmem(GB): used=5.611e-04 (oper,hinter,dvdson,batch)=4.248e-05,5.442e-05,2.831e-07,4.639e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=19 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.956e-03,9.997e-03,3.031e-02,1.273e-02,5.500e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.950e-03 speed=1.452e-04GB/S T(nccl)=5.256e-06 speed=5.387e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=29 t=1.0e-02 per=1.9e+01 cost=4.9e+04 flops=4.9e+06
 sigma[gemm] counter=29 i=0 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=1 t=1.0e-06 per=1.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=2 t=7.5e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=29 i=3 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=1.9e+06
 sigma[gemm] counter=29 i=4 t=7.7e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=29 i=5 t=7.6e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=29 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=29 t=1.3e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=2.9e-01 t_gemm=8.7e-01 t_reduction=3.6e-01 tot=1.5e+00 -----
 sigma_tot[inter] counter=29 t=2.9e-01 per=1.9e+01 cost=5.5e+05 flops=1.9e+06
 sigma_tot[gemm] counter=29 i=0 t=5.4e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=1 t=4.5e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=2 t=2.2e-01 per=1.4e+01 cost=1.5e+05 flops=6.9e+05
 sigma_tot[gemm] counter=29 i=3 t=2.2e-01 per=1.4e+01 cost=1.5e+05 flops=6.9e+05
 sigma_tot[gemm] counter=29 i=4 t=2.2e-01 per=1.4e+01 cost=2.7e+05 flops=1.2e+06
 sigma_tot[gemm] counter=29 i=5 t=2.2e-01 per=1.4e+01 cost=2.7e+05 flops=1.2e+06
 sigma_tot[gemm] counter=29 total t=8.7e-01 per=5.7e+01 cost=8.4e+05 flops=9.7e+05
 sigma_tot[red] counter=29 t=3.6e-01 per=2.4e+01 cost=2.4e+05 flops=6.7e+05
T(sub)=9.1e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,3.8e-06,2.0e-06,6.5e-07,1.5e-07
settings: ndim=19 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.221564167486 -1.116e+03  6.158e-02    1     1  5.512e-02 5.512e-02 5.509e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.836e-03,1.228e-02,2.995e-02,1.271e-02,5.678e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.831e-03 speed=1.546e-04GB/S T(nccl)=4.790e-06 speed=5.911e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.5e-02 -----
 sigma[inter] counter=30 t=1.2e-02 per=2.2e+01 cost=4.9e+04 flops=4.0e+06
 sigma[gemm] counter=30 i=0 t=1.6e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=1 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=2 t=7.5e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=30 i=3 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=30 i=4 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.7e+06
 sigma[gemm] counter=30 i=5 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.7e+06
 sigma[gemm] counter=30 total t=3.0e-02 per=5.5e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=30 t=1.3e-02 per=2.3e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=3.0e-01 t_gemm=9.0e-01 t_reduction=3.7e-01 tot=1.6e+00 -----
 sigma_tot[inter] counter=30 t=3.0e-01 per=1.9e+01 cost=6.0e+05 flops=2.0e+06
 sigma_tot[gemm] counter=30 i=0 t=5.5e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=1 t=4.7e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=2 t=2.2e-01 per=1.4e+01 cost=1.6e+05 flops=7.3e+05
 sigma_tot[gemm] counter=30 i=3 t=2.2e-01 per=1.4e+01 cost=1.6e+05 flops=7.3e+05
 sigma_tot[gemm] counter=30 i=4 t=2.3e-01 per=1.4e+01 cost=3.0e+05 flops=1.3e+06
 sigma_tot[gemm] counter=30 i=5 t=2.2e-01 per=1.4e+01 cost=3.0e+05 flops=1.3e+06
 sigma_tot[gemm] counter=30 total t=9.0e-01 per=5.7e+01 cost=9.2e+05 flops=1.0e+06
 sigma_tot[red] counter=30 t=3.7e-01 per=2.4e+01 cost=2.6e+05 flops=7.0e+05
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.1e-05,3.4e-06,9.4e-07,1.9e-07
    2   0 -    -116.238950861197 -1.739e-02  7.936e-03    2     2  1.252e-01 6.259e-02 5.598e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.715e-03,1.002e-02,2.988e-02,1.241e-02,5.404e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.709e-03 speed=1.657e-04GB/S T(nccl)=6.615e-06 speed=4.280e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=31 t=1.0e-02 per=1.9e+01 cost=4.9e+04 flops=4.9e+06
 sigma[gemm] counter=31 i=0 t=3.9e-06 per=7.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=1 t=3.1e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=2 t=7.4e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=31 i=3 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=31 i=4 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=31 i=5 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.7e+06
 sigma[gemm] counter=31 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=31 t=1.2e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=3.1e-01 t_gemm=9.3e-01 t_reduction=3.9e-01 tot=1.6e+00 -----
 sigma_tot[inter] counter=31 t=3.1e-01 per=1.9e+01 cost=6.5e+05 flops=2.1e+06
 sigma_tot[gemm] counter=31 i=0 t=5.9e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=1 t=5.0e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=2 t=2.3e-01 per=1.4e+01 cost=1.8e+05 flops=7.7e+05
 sigma_tot[gemm] counter=31 i=3 t=2.3e-01 per=1.4e+01 cost=1.8e+05 flops=7.7e+05
 sigma_tot[gemm] counter=31 i=4 t=2.3e-01 per=1.4e+01 cost=3.2e+05 flops=1.4e+06
 sigma_tot[gemm] counter=31 i=5 t=2.3e-01 per=1.4e+01 cost=3.2e+05 flops=1.4e+06
 sigma_tot[gemm] counter=31 total t=9.3e-01 per=5.7e+01 cost=1.0e+06 flops=1.1e+06
 sigma_tot[red] counter=31 t=3.9e-01 per=2.4e+01 cost=2.9e+05 flops=7.4e+05
T(sub)=3.9e-05 T(gemm/eig/ortho/gemm/axpy)=6.7e-06,2.5e-05,5.6e-06,1.7e-06,3.3e-07
    3   0 -    -116.239278591874 -3.277e-04  1.988e-03    3     3  1.925e-01 6.418e-02 5.540e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.835e-03,9.909e-03,2.971e-02,1.240e-02,5.387e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.827e-03 speed=1.550e-04GB/S T(nccl)=8.290e-06 speed=3.415e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=32 t=9.9e-03 per=1.9e+01 cost=4.9e+04 flops=5.0e+06
 sigma[gemm] counter=32 i=0 t=2.4e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=1 t=2.0e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=2 t=7.5e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=32 i=3 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=32 i=4 t=7.4e-03 per=1.4e+01 cost=2.7e+04 flops=3.7e+06
 sigma[gemm] counter=32 i=5 t=7.4e-03 per=1.4e+01 cost=2.7e+04 flops=3.7e+06
 sigma[gemm] counter=32 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=32 t=1.2e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=3.2e-01 t_gemm=9.6e-01 t_reduction=4.0e-01 tot=1.7e+00 -----
 sigma_tot[inter] counter=32 t=3.2e-01 per=1.9e+01 cost=7.0e+05 flops=2.2e+06
 sigma_tot[gemm] counter=32 i=0 t=6.1e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=1 t=5.2e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=2 t=2.4e-01 per=1.4e+01 cost=1.9e+05 flops=8.1e+05
 sigma_tot[gemm] counter=32 i=3 t=2.4e-01 per=1.4e+01 cost=1.9e+05 flops=8.1e+05
 sigma_tot[gemm] counter=32 i=4 t=2.4e-01 per=1.4e+01 cost=3.5e+05 flops=1.5e+06
 sigma_tot[gemm] counter=32 i=5 t=2.4e-01 per=1.4e+01 cost=3.5e+05 flops=1.5e+06
 sigma_tot[gemm] counter=32 total t=9.6e-01 per=5.7e+01 cost=1.1e+06 flops=1.1e+06
 sigma_tot[red] counter=32 t=4.0e-01 per=2.4e+01 cost=3.1e+05 flops=7.7e+05
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.8e-05,4.0e-06,1.4e-06,2.6e-07
    4   0 -    -116.239301759629 -2.317e-05  2.707e-04    3     4  2.575e-01 6.437e-02 5.505e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.221e-04,9.961e-03,3.008e-02,1.234e-02,5.332e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=9.168e-04 speed=3.088e-04GB/S T(nccl)=5.305e-06 speed=5.337e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=33 t=1.0e-02 per=1.9e+01 cost=4.9e+04 flops=4.9e+06
 sigma[gemm] counter=33 i=0 t=1.8e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=1 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=2 t=7.5e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=33 i=3 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=33 i=4 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=33 i=5 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=33 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=33 t=1.2e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=3.3e-01 t_gemm=9.9e-01 t_reduction=4.1e-01 tot=1.7e+00 -----
 sigma_tot[inter] counter=33 t=3.3e-01 per=1.9e+01 cost=7.5e+05 flops=2.2e+06
 sigma_tot[gemm] counter=33 i=0 t=6.3e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=1 t=5.4e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=2 t=2.5e-01 per=1.4e+01 cost=2.1e+05 flops=8.4e+05
 sigma_tot[gemm] counter=33 i=3 t=2.5e-01 per=1.4e+01 cost=2.1e+05 flops=8.5e+05
 sigma_tot[gemm] counter=33 i=4 t=2.5e-01 per=1.4e+01 cost=3.8e+05 flops=1.5e+06
 sigma_tot[gemm] counter=33 i=5 t=2.5e-01 per=1.4e+01 cost=3.8e+05 flops=1.5e+06
 sigma_tot[gemm] counter=33 total t=9.9e-01 per=5.7e+01 cost=1.2e+06 flops=1.2e+06
 sigma_tot[red] counter=33 t=4.1e-01 per=2.4e+01 cost=3.3e+05 flops=8.1e+05
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.5e-05,3.0e-06,1.0e-06,2.0e-07
    5   0 +    -116.239302101363 -3.417e-07  7.746e-05    3     5  3.228e-01 6.455e-02 5.472e-02
TIMING FOR Davidson : 3.228e-01  T(cal/comm/rest)=2.736e-01,8.520e-07,4.917e-02
decomposed t_rest=4.917e-02
 T(sub)    =1.211e-04 per=2.464e-01
 T(precond)=4.889e-02 per=9.942e+01
 T(ortho)  =2.101e-05 per=4.273e-02
 T(xcopy)  =8.510e-07 per=1.731e-03
 T(xnrm2)  =2.430e-06 per=4.942e-03
 T(other)  =1.383e-04 per=2.813e-01
optimized energies: isweep=0 ibond=7 dots=1 e[0]=-116.239302101363 nmvp=5
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=2.670e-04 change=1.535e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond7.txt
 qbond: qsuper nsym=8 dimAll=24
 (12,0):4 (14,0):3 (13,1):6 (13,-1):3 (12,2):3 (14,2):2 (13,3):2 (11,1):1
timing for divide=1.9e-05
timing for compute=1.6e-02
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(nkr): 1.6e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.9e-05,1.6e-02,0.0e+00,4.6e-06,1.6e-05 -----
decimation summary: 24->6 dwt=+0.000e+00 SvN=7.914e-01
 qbond: qkept nsym=3 dimAll=6
 (14,0):3 (14,2):2 (13,1):1
----- TIMING for decimation_row(nkr): 1.656e-02 S T(decim/select/formRot)=1.634e-02,2.005e-04,1.979e-05 -----
----- TIMING FOR onedot_decimation: 1.662e-02 S T(wf/decim)=4.695e-05,1.658e-02 -----
ctns::oper_renorm coord=(8,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1860:1.419e-02MB:1.386e-05GB
        per(mem): H:0.753 C:2.42 S:2.96 A:0 B:93.9 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=2.594e-04 change=1.892e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=365 : 1.192e-02 S -----
rank=0 GPUmem(GB): used=9.690e-05 (oper)=4.248e-05
rank=0 GPUmem(GB): used=9.704e-05 (oper,site)=4.248e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=227
 no. of coefficients=7720:5.890e-02MB:5.752e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.500e-03 S -----
rank=0 GPUmem(GB): used=1.546e-04 (oper,site,rinter)=4.248e-05,1.416e-07,5.752e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.814e-03 S size(rtasks)=365 size(Rlst2)=9 T(Rmu/Rlist)=1.705e-03,1.109e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.990e-03 S size(rtasks)=365 size(Rlst)=734 -----
rank=0 GPUmem(GB): used=1.546e-04 avail=6.176e+00 total=6.176e+00 batch[need]=1.531e-04 blksize=9 blksize0=9 batchsize=734
rank=0 GPUmem(GB): used=3.077e-04 (oper,site,rinter,batch)=4.248e-05,1.416e-07,5.752e-05,1.531e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.093e-03,2.260e-02,1.011e-02
----- TIMING FOR renorm : t_inter=7.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=8 t=7.1e-03 per=1.8e+01 cost=8.5e+04 flops=1.2e+07
 renorm[gemm] counter=8 i=0 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=1 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=2 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=3 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=4 t=7.6e-03 per=1.9e+01 cost=2.6e+03 flops=3.4e+05
 renorm[gemm] counter=8 i=5 t=7.5e-03 per=1.9e+01 cost=1.1e+04 flops=1.5e+06
 renorm[gemm] counter=8 i=6 t=7.5e-03 per=1.9e+01 cost=1.1e+04 flops=1.5e+06
 renorm[gemm] counter=8 total t=2.3e-02 per=5.7e+01 cost=2.5e+04 flops=1.1e+06
 renorm[red] counter=8 t=1.0e-02 per=2.5e+01 cost=4.6e+03 flops=4.5e+05
----- TIMING FOR renorm_tot : t_inter=4.1e-02 t_gemm=1.6e-01 t_reduction=7.8e-02 tot=2.8e-01 -----
 renorm_tot[inter] counter=8 t=4.1e-02 per=1.5e+01 cost=3.5e+05 flops=8.5e+06
 renorm_tot[gemm] counter=8 i=0 t=1.0e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=1 t=8.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=2 t=8.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=3 t=8.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=4 t=5.5e-02 per=1.9e+01 cost=1.9e+05 flops=3.4e+06
 renorm_tot[gemm] counter=8 i=5 t=5.4e-02 per=1.9e+01 cost=1.9e+05 flops=3.6e+06
 renorm_tot[gemm] counter=8 i=6 t=5.4e-02 per=1.9e+01 cost=1.2e+06 flops=2.3e+07
 renorm_tot[gemm] counter=8 total t=1.6e-01 per=5.8e+01 cost=1.6e+06 flops=1.0e+07
 renorm_tot[red] counter=8 t=7.8e-02 per=2.8e+01 cost=5.7e+05 flops=7.3e+06
qops.to_cpu: size(tot)=1860:1.4e-02MB:1.4e-05GB T(to_cpu)=3.3e-04S speed=4.1e-02GB/S
check ||H-H.dagger||=1.005e-14 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.0667 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=6.866e-05 change=8.291e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.785e-03 change=-2.029e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.785e-03 change=-5.960e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 8.361e-01 S #####
 T(local opt: fetch) = 1.176e-02 S  per = 1.41  per(accum) = 1.41
 T(local opt: hdiag) = 3.711e-01 S  per = 44.4  per(accum) = 45.8
 T(local opt: dvdsn) = 3.682e-01 S  per =   44  per(accum) = 89.8
 T(local opt: decim) = 1.663e-02 S  per = 1.99  per(accum) = 91.8
 T(local opt: guess) = 7.614e-05 S  per = 0.00911  per(accum) = 91.8
 T(local opt: renrm) = 6.812e-02 S  per = 8.15  per(accum) = 100
 T(local opt: save ) = 2.375e-04 S  per = 0.0284  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.682e-01 S  T(sum) = 3.678e-01 S  per = 9.990e+01
 T(local opt: preprocess                  ) = 9.288e-05 S  per = 0.0253  per(accum) = 0.0253
 T(local opt: symbolic_formulae           ) = 2.163e-02 S  per = 5.88  per(accum) = 5.91
 T(local opt: hintermediate init          ) = 5.671e-04 S  per = 0.154  per(accum) = 6.06
 T(local opt: preprocess_hformulae_Hxlist ) = 7.582e-03 S  per = 2.06  per(accum) = 8.12
 T(local opt: hmmtasks init               ) = 1.514e-02 S  per = 4.12  per(accum) = 12.2
 T(local opt: initial guess for dvdson    ) = 2.795e-06 S  per = 0.00076  per(accum) = 12.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.653e-01 S  per = 72.1  per(accum) = 84.4
 T(local opt: dvdson [cpu-gpu]            ) = 8.233e-03 S  per = 2.24  per(accum) = 86.6
 T(local opt: dvdson [nccl]               ) = 3.026e-05 S  per = 0.00823  per(accum) = 86.6
 T(local opt: dvdson [mpi]                ) = 8.520e-07 S  per = 0.000232  per(accum) = 86.6
 T(local opt: dvdson [rest part(linalg)]  ) = 4.917e-02 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(renrm) = 6.812e-02 S  T(sum) = 6.812e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.090e-05 S  per = 0.104  per(accum) = 0.104
 T(local opt: qops init                    ) = 2.532e-03 S  per = 3.72  per(accum) = 3.82
 T(local opt: symbolic_formulae_renorm     ) = 1.194e-02 S  per = 17.5  per(accum) = 21.3
 T(local opt: allocate qops on gpu         ) = 6.045e-05 S  per = 0.0887  per(accum) = 21.4
 T(local opt: site memcpy cpu2gpu          ) = 2.158e-03 S  per = 3.17  per(accum) = 24.6
 T(local opt: rintermediate init           ) = 2.513e-03 S  per = 3.69  per(accum) = 28.3
 T(local opt: preprocess_formulae_Rlist2   ) = 3.017e-03 S  per = 4.43  per(accum) = 32.7
 T(local opt: rmmtasks init                ) = 4.158e-03 S  per =  6.1  per(accum) = 38.8
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 4.84e-05  per(accum) = 38.8
 T(local opt: preprocess_renorm_batchGPU   ) = 3.989e-02 S  per = 58.6  per(accum) = 97.4
 T(local opt: deallocate cpu and gpu memory) = 4.601e-05 S  per = 0.0675  per(accum) = 97.5
 T(local opt: construct opS [ifdists=true] ) = 3.500e-08 S  per = 5.14e-05  per(accum) = 97.5
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 5.43e-05  per(accum) = 97.5
 T(local opt: qops memcpy gpu2cpu          ) = 3.414e-04 S  per = 0.501  per(accum) = 98
 T(local opt: reduction of opS & opH [mpi] ) = 1.632e-05 S  per = 0.024  per(accum) = 98
 T(local opt: qops_pool join and erase     ) = 1.375e-03 S  per = 2.02  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.510e-06 S  per = 0.00222  per(accum) = 100
##### sweep opt: 4.103e+00 S #####
 T(sweep opt: fetch) = 1.005e-01 S  per = 2.45  per(accum) = 2.45
 T(sweep opt: hdiag) = 1.180e+00 S  per = 28.8  per(accum) = 31.2
 T(sweep opt: dvdsn) = 2.243e+00 S  per = 54.7  per(accum) = 85.9
 T(sweep opt: decim) = 7.537e-02 S  per = 1.84  per(accum) = 87.7
 T(sweep opt: guess) = 6.842e-04 S  per = 0.0167  per(accum) = 87.7
 T(sweep opt: renrm) = 5.014e-01 S  per = 12.2  per(accum) = 100
 T(sweep opt: save ) = 1.868e-03 S  per = 0.0455  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.243e+00 S  T(sum) = 2.241e+00 S  per = 9.993e+01
 T(sweep opt: preprocess                  ) = 8.756e-04 S  per = 0.0391  per(accum) = 0.0391
 T(sweep opt: symbolic_formulae           ) = 8.166e-02 S  per = 3.64  per(accum) = 3.68
 T(sweep opt: hintermediate init          ) = 2.176e-03 S  per = 0.0971  per(accum) = 3.78
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.582e-02 S  per = 1.15  per(accum) = 4.93
 T(sweep opt: hmmtasks init               ) = 4.723e-02 S  per = 2.11  per(accum) = 7.04
 T(sweep opt: initial guess for dvdson    ) = 2.979e-05 S  per = 0.00133  per(accum) = 7.04
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.736e+00 S  per = 77.5  per(accum) = 84.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.874e-02 S  per = 2.17  per(accum) = 86.7
 T(sweep opt: dvdson [nccl]               ) = 1.902e-04 S  per = 0.00848  per(accum) = 86.7
 T(sweep opt: dvdson [mpi]                ) = 4.296e-06 S  per = 0.000192  per(accum) = 86.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.984e-01 S  per = 13.3  per(accum) = 100
Detailed decomposition of T(renrm) = 5.014e-01 S  T(sum) = 5.014e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.361e-04 S  per = 0.147  per(accum) = 0.147
 T(sweep opt: qops init                    ) = 1.266e-02 S  per = 2.52  per(accum) = 2.67
 T(sweep opt: symbolic_formulae_renorm     ) = 6.264e-02 S  per = 12.5  per(accum) = 15.2
 T(sweep opt: allocate qops on gpu         ) = 4.352e-04 S  per = 0.0868  per(accum) = 15.3
 T(sweep opt: site memcpy cpu2gpu          ) = 1.047e-02 S  per = 2.09  per(accum) = 17.3
 T(sweep opt: rintermediate init           ) = 1.567e-02 S  per = 3.13  per(accum) = 20.5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.833e-02 S  per = 5.65  per(accum) = 26.1
 T(sweep opt: rmmtasks init                ) = 7.454e-02 S  per = 14.9  per(accum) = 41
 T(sweep opt: qops memset on cpu           ) = 3.500e-07 S  per = 6.98e-05  per(accum) = 41
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.829e-01 S  per = 56.4  per(accum) = 97.4
 T(sweep opt: deallocate cpu and gpu memory) = 7.288e-04 S  per = 0.145  per(accum) = 97.5
 T(sweep opt: construct opS [ifdists=true] ) = 2.720e-07 S  per = 5.42e-05  per(accum) = 97.5
 T(sweep opt: reduction of opS & opH [nccl]) = 2.880e-07 S  per = 5.74e-05  per(accum) = 97.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.530e-03 S  per = 0.305  per(accum) = 97.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.626e-04 S  per = 0.0324  per(accum) = 97.9
 T(sweep opt: qops_pool join and erase     ) = 1.061e-02 S  per = 2.12  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.268e-05 S  per = 0.00253  per(accum) = 100
##### global opt: 4.103e+00 S #####
 T(global opt: fetch) = 1.005e-01 S  per = 2.45  per(accum) = 2.45
 T(global opt: hdiag) = 1.180e+00 S  per = 28.8  per(accum) = 31.2
 T(global opt: dvdsn) = 2.243e+00 S  per = 54.7  per(accum) = 85.9
 T(global opt: decim) = 7.537e-02 S  per = 1.84  per(accum) = 87.7
 T(global opt: guess) = 6.842e-04 S  per = 0.0167  per(accum) = 87.7
 T(global opt: renrm) = 5.014e-01 S  per = 12.2  per(accum) = 100
 T(global opt: save ) = 1.868e-03 S  per = 0.0455  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.243e+00 S  T(sum) = 2.241e+00 S  per = 9.993e+01
 T(global opt: preprocess                  ) = 8.756e-04 S  per = 0.0391  per(accum) = 0.0391
 T(global opt: symbolic_formulae           ) = 8.166e-02 S  per = 3.64  per(accum) = 3.68
 T(global opt: hintermediate init          ) = 2.176e-03 S  per = 0.0971  per(accum) = 3.78
 T(global opt: preprocess_hformulae_Hxlist ) = 2.582e-02 S  per = 1.15  per(accum) = 4.93
 T(global opt: hmmtasks init               ) = 4.723e-02 S  per = 2.11  per(accum) = 7.04
 T(global opt: initial guess for dvdson    ) = 2.979e-05 S  per = 0.00133  per(accum) = 7.04
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.736e+00 S  per = 77.5  per(accum) = 84.5
 T(global opt: dvdson [cpu-gpu]            ) = 4.874e-02 S  per = 2.17  per(accum) = 86.7
 T(global opt: dvdson [nccl]               ) = 1.902e-04 S  per = 0.00848  per(accum) = 86.7
 T(global opt: dvdson [mpi]                ) = 4.296e-06 S  per = 0.000192  per(accum) = 86.7
 T(global opt: dvdson [rest part(linalg)]  ) = 2.984e-01 S  per = 13.3  per(accum) = 100
Detailed decomposition of T(renrm) = 5.014e-01 S  T(sum) = 5.014e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.361e-04 S  per = 0.147  per(accum) = 0.147
 T(global opt: qops init                    ) = 1.266e-02 S  per = 2.52  per(accum) = 2.67
 T(global opt: symbolic_formulae_renorm     ) = 6.264e-02 S  per = 12.5  per(accum) = 15.2
 T(global opt: allocate qops on gpu         ) = 4.352e-04 S  per = 0.0868  per(accum) = 15.3
 T(global opt: site memcpy cpu2gpu          ) = 1.047e-02 S  per = 2.09  per(accum) = 17.3
 T(global opt: rintermediate init           ) = 1.567e-02 S  per = 3.13  per(accum) = 20.5
 T(global opt: preprocess_formulae_Rlist2   ) = 2.833e-02 S  per = 5.65  per(accum) = 26.1
 T(global opt: rmmtasks init                ) = 7.454e-02 S  per = 14.9  per(accum) = 41
 T(global opt: qops memset on cpu           ) = 3.500e-07 S  per = 6.98e-05  per(accum) = 41
 T(global opt: preprocess_renorm_batchGPU   ) = 2.829e-01 S  per = 56.4  per(accum) = 97.4
 T(global opt: deallocate cpu and gpu memory) = 7.288e-04 S  per = 0.145  per(accum) = 97.5
 T(global opt: construct opS [ifdists=true] ) = 2.720e-07 S  per = 5.42e-05  per(accum) = 97.5
 T(global opt: reduction of opS & opH [nccl]) = 2.880e-07 S  per = 5.74e-05  per(accum) = 97.5
 T(global opt: qops memcpy gpu2cpu          ) = 1.530e-03 S  per = 0.305  per(accum) = 97.8
 T(global opt: reduction of opS & opH [mpi] ) = 1.626e-04 S  per = 0.0324  per(accum) = 97.9
 T(global opt: qops_pool join and erase     ) = 1.061e-02 S  per = 2.12  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.268e-05 S  per = 0.00253  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.518e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=8/seqsize=34 dots=1 dbond=(9,0)-(10,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=31:2.365e-04MB:2.310e-07GB
total mem of comb=795:6.065e-03MB:5.923e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=9,10,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc= 5
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1860:1.419e-02MB:1.386e-05GB
        per(mem): H:0.753 C:2.42 S:2.96 A:0 B:93.9 
 rqops: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=3251:0.0248MB:2.42e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=7447:0.0568MB:5.55e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.129e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(9,0) fdel=./scratch/sweep/rop(10,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.444e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,7,4) nnz=31:2.365e-04MB
qtensor3: wf3 own=1 _data=0x3c63cc00
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (14,0):3 (14,2):2 (13,1):1
 qbond: qcol nsym=3 dimAll=7
 (15,-1):4 (15,-3):2 (16,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=6 nblocks=36 size=31:2.365e-04MB
### DIAG TIMING: total=4.194e-01 t1=3.015e-05, t2=2.192e-03, t3=2.486e-03, t4=4.147e-01, t5=7.014e-06, t6=1.613e-05, t7=6.456e-06
duration_diagGPU:4.194e-01
duration_diagreduce:2.390e-07
duration_diagtransform:4.660e-07
----- TIMING FOR symbolic_formulae_onedot with size=1635 : 2.549e-02 S -----
rank=0 GPUmem(GB): used=5.548e-05 (oper)=5.548e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1635
 no. of hintermediate operators=828
 no. of coefficients=8280:6.317e-02MB:6.169e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.893e-04 S -----
rank=0 GPUmem(GB): used=1.172e-04 (oper,hinter)=5.548e-05,6.169e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 9.307e-03 S size(H_formulae)=1635 size(Hxlst2)=6 T(Hmu/Hxlist)=4.087e-03,5.220e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.000e-02 S size(H_formulae)=1635 size(Hxlst)=3940 -----
rank=0 GPUmem(GB): used=1.172e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=4.619e-07 batch[need]=8.513e-04 blksize=12 blksize0=4 batchsize=3940
rank=0 GPUmem(GB): used=9.689e-04 (oper,hinter,dvdson,batch)=5.548e-05,6.169e-05,4.619e-07,8.513e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=31 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.118e-04,9.925e-03,2.997e-02,1.254e-02,5.306e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=6.059e-04 speed=7.624e-04GB/S T(nccl)=5.873e-06 speed=7.865e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=34 t=9.9e-03 per=1.9e+01 cost=9.0e+04 flops=9.1e+06
 sigma[gemm] counter=34 i=0 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=1 t=1.0e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=2 t=7.5e-03 per=1.4e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=34 i=3 t=7.5e-03 per=1.4e+01 cost=3.3e+04 flops=4.4e+06
 sigma[gemm] counter=34 i=4 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=34 i=5 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.5e+06
 sigma[gemm] counter=34 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=5.0e+06
 sigma[red] counter=34 t=1.3e-02 per=2.4e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=3.4e-01 t_gemm=1.0e+00 t_reduction=4.2e-01 tot=1.8e+00 -----
 sigma_tot[inter] counter=34 t=3.4e-01 per=1.9e+01 cost=8.4e+05 flops=2.4e+06
 sigma_tot[gemm] counter=34 i=0 t=6.4e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=1 t=5.5e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=2 t=2.5e-01 per=1.4e+01 cost=2.4e+05 flops=9.4e+05
 sigma_tot[gemm] counter=34 i=3 t=2.5e-01 per=1.4e+01 cost=2.4e+05 flops=9.5e+05
 sigma_tot[gemm] counter=34 i=4 t=2.6e-01 per=1.4e+01 cost=4.2e+05 flops=1.7e+06
 sigma_tot[gemm] counter=34 i=5 t=2.5e-01 per=1.4e+01 cost=4.2e+05 flops=1.7e+06
 sigma_tot[gemm] counter=34 total t=1.0e+00 per=5.7e+01 cost=1.3e+06 flops=1.3e+06
 sigma_tot[red] counter=34 t=4.2e-01 per=2.4e+01 cost=3.7e+05 flops=8.8e+05
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,5.4e-06,2.0e-06,7.8e-07,1.5e-07
settings: ndim=31 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.239302101363 -1.116e+03  5.368e-02    1     1  5.317e-02 5.317e-02 5.314e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.107e-03,1.012e-02,2.979e-02,1.261e-02,5.463e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=2.101e-03 speed=2.199e-04GB/S T(nccl)=6.355e-06 speed=7.269e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=35 t=1.0e-02 per=1.9e+01 cost=9.0e+04 flops=8.9e+06
 sigma[gemm] counter=35 i=0 t=5.6e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=1 t=2.8e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=2 t=7.4e-03 per=1.4e+01 cost=3.2e+04 flops=4.4e+06
 sigma[gemm] counter=35 i=3 t=7.4e-03 per=1.4e+01 cost=3.3e+04 flops=4.5e+06
 sigma[gemm] counter=35 i=4 t=7.4e-03 per=1.4e+01 cost=4.2e+04 flops=5.7e+06
 sigma[gemm] counter=35 i=5 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=35 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=5.0e+06
 sigma[red] counter=35 t=1.3e-02 per=2.4e+01 cost=4.1e+04 flops=3.2e+06
----- TIMING FOR sigma_tot : t_inter=3.5e-01 t_gemm=1.0e+00 t_reduction=4.4e-01 tot=1.8e+00 -----
 sigma_tot[inter] counter=35 t=3.5e-01 per=1.9e+01 cost=9.3e+05 flops=2.6e+06
 sigma_tot[gemm] counter=35 i=0 t=7.0e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=1 t=5.7e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=2 t=2.6e-01 per=1.4e+01 cost=2.7e+05 flops=1.0e+06
 sigma_tot[gemm] counter=35 i=3 t=2.6e-01 per=1.4e+01 cost=2.8e+05 flops=1.1e+06
 sigma_tot[gemm] counter=35 i=4 t=2.6e-01 per=1.4e+01 cost=4.6e+05 flops=1.8e+06
 sigma_tot[gemm] counter=35 i=5 t=2.6e-01 per=1.4e+01 cost=4.6e+05 flops=1.8e+06
 sigma_tot[gemm] counter=35 total t=1.0e+00 per=5.7e+01 cost=1.5e+06 flops=1.4e+06
 sigma_tot[red] counter=35 t=4.4e-01 per=2.4e+01 cost=4.1e+05 flops=9.5e+05
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=7.8e-06,1.9e-05,1.9e-05,1.6e-06,3.3e-07
    2   0 -    -116.248657223696 -9.355e-03  1.738e-02    2     2  1.209e-01 6.046e-02 5.397e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.737e-04,1.000e-02,2.991e-02,1.255e-02,5.305e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=5.682e-04 speed=8.130e-04GB/S T(nccl)=5.533e-06 speed=8.349e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=36 t=1.0e-02 per=1.9e+01 cost=9.0e+04 flops=9.0e+06
 sigma[gemm] counter=36 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=2 t=7.4e-03 per=1.4e+01 cost=3.2e+04 flops=4.4e+06
 sigma[gemm] counter=36 i=3 t=7.4e-03 per=1.4e+01 cost=3.3e+04 flops=4.5e+06
 sigma[gemm] counter=36 i=4 t=7.4e-03 per=1.4e+01 cost=4.2e+04 flops=5.7e+06
 sigma[gemm] counter=36 i=5 t=7.6e-03 per=1.4e+01 cost=4.2e+04 flops=5.5e+06
 sigma[gemm] counter=36 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=5.0e+06
 sigma[red] counter=36 t=1.3e-02 per=2.4e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=3.6e-01 t_gemm=1.1e+00 t_reduction=4.5e-01 tot=1.9e+00 -----
 sigma_tot[inter] counter=36 t=3.6e-01 per=1.9e+01 cost=1.0e+06 flops=2.8e+06
 sigma_tot[gemm] counter=36 i=0 t=7.1e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=1 t=5.9e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=2 t=2.7e-01 per=1.4e+01 cost=3.0e+05 flops=1.1e+06
 sigma_tot[gemm] counter=36 i=3 t=2.7e-01 per=1.4e+01 cost=3.1e+05 flops=1.1e+06
 sigma_tot[gemm] counter=36 i=4 t=2.7e-01 per=1.4e+01 cost=5.1e+05 flops=1.9e+06
 sigma_tot[gemm] counter=36 i=5 t=2.7e-01 per=1.4e+01 cost=5.0e+05 flops=1.9e+06
 sigma_tot[gemm] counter=36 total t=1.1e+00 per=5.7e+01 cost=1.6e+06 flops=1.5e+06
 sigma_tot[red] counter=36 t=4.5e-01 per=2.4e+01 cost=4.5e+05 flops=1.0e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.6e-05,3.0e-06,1.1e-06,2.1e-07
    3   0 -    -116.249817092520 -1.160e-03  5.015e-03    3     3  1.905e-01 6.350e-02 5.370e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.734e-04,1.002e-02,3.013e-02,1.248e-02,5.301e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=3.661e-04 speed=1.262e-03GB/S T(nccl)=7.380e-06 speed=6.259e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=37 t=1.0e-02 per=1.9e+01 cost=9.0e+04 flops=9.0e+06
 sigma[gemm] counter=37 i=0 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=2 t=7.6e-03 per=1.4e+01 cost=3.2e+04 flops=4.2e+06
 sigma[gemm] counter=37 i=3 t=7.6e-03 per=1.4e+01 cost=3.3e+04 flops=4.4e+06
 sigma[gemm] counter=37 i=4 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=37 i=5 t=7.4e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=37 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=5.0e+06
 sigma[red] counter=37 t=1.2e-02 per=2.4e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=3.7e-01 t_gemm=1.1e+00 t_reduction=4.6e-01 tot=1.9e+00 -----
 sigma_tot[inter] counter=37 t=3.7e-01 per=1.9e+01 cost=1.1e+06 flops=3.0e+06
 sigma_tot[gemm] counter=37 i=0 t=7.3e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=1 t=6.0e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=2 t=2.8e-01 per=1.4e+01 cost=3.4e+05 flops=1.2e+06
 sigma_tot[gemm] counter=37 i=3 t=2.8e-01 per=1.4e+01 cost=3.4e+05 flops=1.2e+06
 sigma_tot[gemm] counter=37 i=4 t=2.8e-01 per=1.4e+01 cost=5.5e+05 flops=2.0e+06
 sigma_tot[gemm] counter=37 i=5 t=2.8e-01 per=1.4e+01 cost=5.4e+05 flops=2.0e+06
 sigma_tot[gemm] counter=37 total t=1.1e+00 per=5.7e+01 cost=1.8e+06 flops=1.6e+06
 sigma_tot[red] counter=37 t=4.6e-01 per=2.4e+01 cost=5.0e+05 flops=1.1e+06
T(sub)=5.7e-05 T(gemm/eig/ortho/gemm/axpy)=7.9e-06,4.1e-05,6.0e-06,2.2e-06,3.7e-07
    4   0 -    -116.249939278612 -1.222e-04  6.101e-04    3     4  2.563e-01 6.408e-02 5.358e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.329e-03,1.011e-02,3.038e-02,1.248e-02,5.431e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=1.321e-03 speed=3.498e-04GB/S T(nccl)=7.948e-06 speed=5.812e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=38 t=1.0e-02 per=1.9e+01 cost=9.0e+04 flops=8.9e+06
 sigma[gemm] counter=38 i=0 t=4.2e-06 per=7.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=1 t=3.4e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=2 t=7.6e-03 per=1.4e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=38 i=3 t=7.6e-03 per=1.4e+01 cost=3.3e+04 flops=4.4e+06
 sigma[gemm] counter=38 i=4 t=7.7e-03 per=1.4e+01 cost=4.2e+04 flops=5.5e+06
 sigma[gemm] counter=38 i=5 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.5e+06
 sigma[gemm] counter=38 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=4.9e+06
 sigma[red] counter=38 t=1.2e-02 per=2.4e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=3.8e-01 t_gemm=1.1e+00 t_reduction=4.7e-01 tot=2.0e+00 -----
 sigma_tot[inter] counter=38 t=3.8e-01 per=1.9e+01 cost=1.2e+06 flops=3.1e+06
 sigma_tot[gemm] counter=38 i=0 t=7.7e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=1 t=6.3e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=2 t=2.8e-01 per=1.4e+01 cost=3.7e+05 flops=1.3e+06
 sigma_tot[gemm] counter=38 i=3 t=2.8e-01 per=1.4e+01 cost=3.8e+05 flops=1.3e+06
 sigma_tot[gemm] counter=38 i=4 t=2.9e-01 per=1.4e+01 cost=5.9e+05 flops=2.1e+06
 sigma_tot[gemm] counter=38 i=5 t=2.8e-01 per=1.4e+01 cost=5.9e+05 flops=2.1e+06
 sigma_tot[gemm] counter=38 total t=1.1e+00 per=5.7e+01 cost=1.9e+06 flops=1.7e+06
 sigma_tot[red] counter=38 t=4.7e-01 per=2.4e+01 cost=5.4e+05 flops=1.1e+06
T(sub)=5.5e-05 T(gemm/eig/ortho/gemm/axpy)=7.6e-06,3.9e-05,5.7e-06,2.0e-06,4.2e-07
    5   0 -    -116.249940603011 -1.324e-06  1.326e-04    3     5  3.306e-01 6.613e-02 5.377e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.202e-03,1.479e-03,7.564e-03,2.253e-03,1.251e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=1.196e-03 speed=3.862e-04GB/S T(nccl)=6.028e-06 speed=7.663e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-03 t_gemm=7.6e-03 t_reduction=2.3e-03 tot=1.1e-02 -----
 sigma[inter] counter=39 t=1.5e-03 per=1.3e+01 cost=9.0e+04 flops=6.1e+07
 sigma[gemm] counter=39 i=0 t=2.3e-06 per=2.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=1 t=2.0e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=2 t=2.5e-03 per=2.2e+01 cost=3.2e+04 flops=1.3e+07
 sigma[gemm] counter=39 i=3 t=1.2e-03 per=1.0e+01 cost=3.3e+04 flops=2.9e+07
 sigma[gemm] counter=39 i=4 t=1.6e-03 per=1.4e+01 cost=4.2e+04 flops=2.7e+07
 sigma[gemm] counter=39 i=5 t=2.3e-03 per=2.0e+01 cost=4.2e+04 flops=1.8e+07
 sigma[gemm] counter=39 total t=7.6e-03 per=6.7e+01 cost=1.5e+05 flops=2.0e+07
 sigma[red] counter=39 t=2.3e-03 per=2.0e+01 cost=4.1e+04 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=3.9e-01 t_gemm=1.1e+00 t_reduction=4.8e-01 tot=2.0e+00 -----
 sigma_tot[inter] counter=39 t=3.9e-01 per=1.9e+01 cost=1.3e+06 flops=3.3e+06
 sigma_tot[gemm] counter=39 i=0 t=8.0e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=1 t=6.5e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=2 t=2.9e-01 per=1.4e+01 cost=4.0e+05 flops=1.4e+06
 sigma_tot[gemm] counter=39 i=3 t=2.9e-01 per=1.4e+01 cost=4.1e+05 flops=1.4e+06
 sigma_tot[gemm] counter=39 i=4 t=2.9e-01 per=1.4e+01 cost=6.3e+05 flops=2.2e+06
 sigma_tot[gemm] counter=39 i=5 t=2.9e-01 per=1.4e+01 cost=6.3e+05 flops=2.2e+06
 sigma_tot[gemm] counter=39 total t=1.1e+00 per=5.7e+01 cost=2.1e+06 flops=1.8e+06
 sigma_tot[red] counter=39 t=4.8e-01 per=2.4e+01 cost=5.8e+05 flops=1.2e+06
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.7e-05,3.8e-06,1.4e-06,3.2e-07
    6   0 +    -116.249940669273 -6.626e-08  4.928e-05    3     6  3.621e-01 6.035e-02 4.691e-02
TIMING FOR Davidson : 3.621e-01  T(cal/comm/rest)=2.815e-01,1.143e-06,8.063e-02
decomposed t_rest=8.063e-02
 T(sub)    =2.230e-04 per=2.766e-01
 T(precond)=8.021e-02 per=9.949e+01
 T(ortho)  =1.994e-05 per=2.473e-02
 T(xcopy)  =1.003e-06 per=1.244e-03
 T(xnrm2)  =3.898e-06 per=4.835e-03
 T(other)  =1.668e-04 per=2.069e-01
optimized energies: isweep=0 ibond=8 dots=1 e[0]=-116.249940669273 nmvp=6
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.091e-03 change=1.914e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond8.txt
 qbond: qsuper nsym=8 dimAll=24
 (14,0):4 (16,0):3 (15,1):6 (15,-1):3 (14,2):3 (16,2):2 (15,3):2 (13,1):1
timing for divide=1.4e-05
timing for compute=1.2e-02
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.4e-05,1.2e-02,0.0e+00,6.4e-06,1.4e-05 -----
decimation summary: 24->7 dwt=+0.000e+00 SvN=1.007e+00
 qbond: qkept nsym=3 dimAll=7
 (15,1):4 (15,3):2 (14,2):1
----- TIMING for decimation_row(nkr): 1.264e-02 S T(decim/select/formRot)=1.239e-02,2.370e-04,2.089e-05 -----
----- TIMING FOR onedot_decimation: 1.273e-02 S T(wf/decim)=6.731e-05,1.266e-02 -----
ctns::oper_renorm coord=(9,0) superblock=lc oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:20 S:20 A:190 B:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3251:2.480e-02MB:2.422e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 A:0 B:95.7 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.060e-03 change=2.282e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=441 : 1.729e-02 S -----
rank=0 GPUmem(GB): used=1.172e-04 (oper)=5.548e-05
rank=0 GPUmem(GB): used=1.174e-04 (oper,site)=5.548e-05,2.310e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=441
 no. of rintermediate operators=207
 no. of coefficients=8802:6.715e-02MB:6.558e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.521e-03 S -----
rank=0 GPUmem(GB): used=1.830e-04 (oper,site,rinter)=5.548e-05,2.310e-07,6.558e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.829e-03 S size(rtasks)=441 size(Rlst2)=9 T(Rmu/Rlist)=2.181e-03,1.648e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.093e-03 S size(rtasks)=441 size(Rlst)=965 -----
rank=0 GPUmem(GB): used=1.830e-04 avail=6.176e+00 total=6.176e+00 batch[need]=3.020e-04 blksize=16 blksize0=9 batchsize=965
rank=0 GPUmem(GB): used=4.850e-04 (oper,site,rinter,batch)=5.548e-05,2.310e-07,6.558e-05,3.020e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.165e-03,2.246e-02,1.000e-02
----- TIMING FOR renorm : t_inter=7.2e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=9 t=7.2e-03 per=1.8e+01 cost=6.0e+04 flops=8.4e+06
 renorm[gemm] counter=9 i=0 t=1.5e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=1 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=2 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=3 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=4 t=7.5e-03 per=1.9e+01 cost=2.7e+03 flops=3.6e+05
 renorm[gemm] counter=9 i=5 t=7.4e-03 per=1.9e+01 cost=1.8e+04 flops=2.5e+06
 renorm[gemm] counter=9 i=6 t=7.5e-03 per=1.9e+01 cost=3.1e+04 flops=4.1e+06
 renorm[gemm] counter=9 total t=2.2e-02 per=5.7e+01 cost=5.2e+04 flops=2.3e+06
 renorm[red] counter=9 t=1.0e-02 per=2.5e+01 cost=1.6e+04 flops=1.6e+06
----- TIMING FOR renorm_tot : t_inter=4.8e-02 t_gemm=1.9e-01 t_reduction=8.8e-02 tot=3.2e-01 -----
 renorm_tot[inter] counter=9 t=4.8e-02 per=1.5e+01 cost=4.1e+05 flops=8.5e+06
 renorm_tot[gemm] counter=9 i=0 t=1.2e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=1 t=9.9e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=2 t=9.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=3 t=9.4e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=4 t=6.2e-02 per=1.9e+01 cost=1.9e+05 flops=3.1e+06
 renorm_tot[gemm] counter=9 i=5 t=6.1e-02 per=1.9e+01 cost=2.1e+05 flops=3.5e+06
 renorm_tot[gemm] counter=9 i=6 t=6.1e-02 per=1.9e+01 cost=1.3e+06 flops=2.1e+07
 renorm_tot[gemm] counter=9 total t=1.9e-01 per=5.8e+01 cost=1.7e+06 flops=9.0e+06
 renorm_tot[red] counter=9 t=8.8e-02 per=2.7e+01 cost=5.9e+05 flops=6.6e+06
----- TIMING FOR oper_renorm : 7.6e-02 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=6.866e-04 change=9.900e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.571e-03 change=-2.277e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::oper_ab2pq coord=(9,0) superblock=lc alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3251:2.480e-02MB:2.422e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.571e-03 change=2.278e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.571e-03 change=7.600e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 after qops2.allocate_gpu
ctns::oper_a2p ifab=1 ifkr=0 maxsize=0:0.000e+00GB
ctns::oper_b2q ifab=1 ifkr=0 maxsize=3110:2.317e-05GB
iproc=0
 qops_tmp: oplist=B nops=B:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3110:2.373e-02MB:2.317e-05GB
        per(mem): B:100 
   init qops_tmp: dt=0.00102 tinit=0.00102
   copy opB to qops_tmps: dt=0.00147 tcopy=0.00147
   bcast: size(opB)=3110:2.32e-05GB dt=4.9e-08 speed=473GB/s tcomm=4.9e-08
   compute opQ from opB: dt=0.00736 tcomp=0.00736
iproc=0
 qops_tmp: oplist=N nops=N:210 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=3110:0.0237MB:2.32e-05GB
        per(mem): N:100 
   init qops_tmp: dt=0.000975 tinit=0.00199
   from opB to opB.H(): dt=0.00626 tadjt=0.00626
   bcast: size(opN)=3110:2.32e-05GB dt=4.8e-08 speed=483GB/s tcomm=9.7e-08
   compute opQ from opB.H(): dt=0.00743 tcomp=0.0148
----- TIMING FOR oper_b2qGPU : 0.0249 S T(init/copy/adjt+bcast/comp/rest)=0.00199,0.00147,0.00626,0.0148,0.000374 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.480e-03 change=4.321e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.480e-03 change=2.480e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.480e-03 change=-5.960e-08 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before move
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 before move
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.480e-03 change=-2.295e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after move
rank=0 GPUmem(GB): used=8.591e-05 avail=6.176e+00 after move
check ||H-H.dagger||=9.669e-15 coord=(9,0) rank=0
----- TIMING FOR oper_ab2pq : 0.0283 S T(init/copyHCS/opP/opQ/to_gpu/to_cpu/move)=0.00242,1.85e-05,5.33e-06,0.0249,0,0.000608,0.000328 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.480e-03 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.480e-03 change=-6.855e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 9.716e-01 S #####
 T(local opt: fetch) = 1.187e-02 S  per = 1.22  per(accum) = 1.22
 T(local opt: hdiag) = 4.194e-01 S  per = 43.2  per(accum) = 44.4
 T(local opt: dvdsn) = 4.210e-01 S  per = 43.3  per(accum) = 87.7
 T(local opt: decim) = 1.274e-02 S  per = 1.31  per(accum) = 89
 T(local opt: guess) = 8.270e-05 S  per = 0.00851  per(accum) = 89
 T(local opt: renrm) = 1.062e-01 S  per = 10.9  per(accum) = 100
 T(local opt: save ) = 2.653e-04 S  per = 0.0273  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.210e-01 S  T(sum) = 4.205e-01 S  per = 9.989e+01
 T(local opt: preprocess                  ) = 9.795e-05 S  per = 0.0233  per(accum) = 0.0233
 T(local opt: symbolic_formulae           ) = 2.550e-02 S  per = 6.06  per(accum) = 6.09
 T(local opt: hintermediate init          ) = 7.093e-04 S  per = 0.169  per(accum) = 6.26
 T(local opt: preprocess_hformulae_Hxlist ) = 1.013e-02 S  per = 2.41  per(accum) = 8.67
 T(local opt: hmmtasks init               ) = 2.198e-02 S  per = 5.23  per(accum) = 13.9
 T(local opt: initial guess for dvdson    ) = 3.444e-06 S  per = 0.000819  per(accum) = 13.9
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.753e-01 S  per = 65.5  per(accum) = 79.4
 T(local opt: dvdson [cpu-gpu]            ) = 6.158e-03 S  per = 1.46  per(accum) = 80.8
 T(local opt: dvdson [nccl]               ) = 3.912e-05 S  per = 0.0093  per(accum) = 80.8
 T(local opt: dvdson [mpi]                ) = 1.143e-06 S  per = 0.000272  per(accum) = 80.8
 T(local opt: dvdson [rest part(linalg)]  ) = 8.063e-02 S  per = 19.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.062e-01 S  T(sum) = 1.062e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.620e-05 S  per = 0.0717  per(accum) = 0.0717
 T(local opt: qops init                    ) = 3.533e-03 S  per = 3.33  per(accum) = 3.4
 T(local opt: symbolic_formulae_renorm     ) = 1.731e-02 S  per = 16.3  per(accum) = 19.7
 T(local opt: allocate qops on gpu         ) = 6.049e-05 S  per = 0.0569  per(accum) = 19.7
 T(local opt: site memcpy cpu2gpu          ) = 2.049e-03 S  per = 1.93  per(accum) = 21.7
 T(local opt: rintermediate init           ) = 2.537e-03 S  per = 2.39  per(accum) = 24.1
 T(local opt: preprocess_formulae_Rlist2   ) = 4.134e-03 S  per = 3.89  per(accum) = 28
 T(local opt: rmmtasks init                ) = 6.610e-03 S  per = 6.22  per(accum) = 34.2
 T(local opt: qops memset on cpu           ) = 3.800e-08 S  per = 3.58e-05  per(accum) = 34.2
 T(local opt: preprocess_renorm_batchGPU   ) = 3.973e-02 S  per = 37.4  per(accum) = 71.6
 T(local opt: deallocate cpu and gpu memory) = 6.227e-05 S  per = 0.0586  per(accum) = 71.6
 T(local opt: construct opS [ifdists=true] ) = 3.500e-08 S  per = 3.29e-05  per(accum) = 71.6
 T(local opt: reduction of opS & opH [nccl]) = 4.400e-08 S  per = 4.14e-05  per(accum) = 71.6
 T(local opt: qops memcpy gpu2cpu          ) = 3.300e-08 S  per = 3.11e-05  per(accum) = 71.6
 T(local opt: reduction of opS & opH [mpi] ) = 1.390e-07 S  per = 0.000131  per(accum) = 71.6
 T(local opt: qops_pool join and erase     ) = 1.773e-03 S  per = 1.67  per(accum) = 73.3
 T(local opt: conversion from opAB to opPQ ) = 2.836e-02 S  per = 26.7  per(accum) = 100
##### sweep opt: 5.074e+00 S #####
 T(sweep opt: fetch) = 1.123e-01 S  per = 2.21  per(accum) = 2.21
 T(sweep opt: hdiag) = 1.600e+00 S  per = 31.5  per(accum) = 33.7
 T(sweep opt: dvdsn) = 2.664e+00 S  per = 52.5  per(accum) = 86.2
 T(sweep opt: decim) = 8.811e-02 S  per = 1.74  per(accum) = 88
 T(sweep opt: guess) = 7.669e-04 S  per = 0.0151  per(accum) = 88
 T(sweep opt: renrm) = 6.076e-01 S  per =   12  per(accum) = 100
 T(sweep opt: save ) = 2.133e-03 S  per = 0.042  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.664e+00 S  T(sum) = 2.662e+00 S  per = 9.992e+01
 T(sweep opt: preprocess                  ) = 9.735e-04 S  per = 0.0366  per(accum) = 0.0366
 T(sweep opt: symbolic_formulae           ) = 1.072e-01 S  per = 4.03  per(accum) = 4.06
 T(sweep opt: hintermediate init          ) = 2.885e-03 S  per = 0.108  per(accum) = 4.17
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.596e-02 S  per = 1.35  per(accum) = 5.52
 T(sweep opt: hmmtasks init               ) = 6.920e-02 S  per =  2.6  per(accum) = 8.12
 T(sweep opt: initial guess for dvdson    ) = 3.323e-05 S  per = 0.00125  per(accum) = 8.12
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.011e+00 S  per = 75.6  per(accum) = 83.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 5.490e-02 S  per = 2.06  per(accum) = 85.8
 T(sweep opt: dvdson [nccl]               ) = 2.293e-04 S  per = 0.00861  per(accum) = 85.8
 T(sweep opt: dvdson [mpi]                ) = 5.439e-06 S  per = 0.000204  per(accum) = 85.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 3.790e-01 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 6.076e-01 S  T(sum) = 6.076e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.123e-04 S  per = 0.134  per(accum) = 0.134
 T(sweep opt: qops init                    ) = 1.619e-02 S  per = 2.66  per(accum) = 2.8
 T(sweep opt: symbolic_formulae_renorm     ) = 7.994e-02 S  per = 13.2  per(accum) = 16
 T(sweep opt: allocate qops on gpu         ) = 4.957e-04 S  per = 0.0816  per(accum) = 16
 T(sweep opt: site memcpy cpu2gpu          ) = 1.251e-02 S  per = 2.06  per(accum) = 18.1
 T(sweep opt: rintermediate init           ) = 1.821e-02 S  per =    3  per(accum) = 21.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.247e-02 S  per = 5.34  per(accum) = 26.4
 T(sweep opt: rmmtasks init                ) = 8.115e-02 S  per = 13.4  per(accum) = 39.8
 T(sweep opt: qops memset on cpu           ) = 3.880e-07 S  per = 6.39e-05  per(accum) = 39.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.226e-01 S  per = 53.1  per(accum) = 92.9
 T(sweep opt: deallocate cpu and gpu memory) = 7.910e-04 S  per = 0.13  per(accum) = 93
 T(sweep opt: construct opS [ifdists=true] ) = 3.070e-07 S  per = 5.05e-05  per(accum) = 93
 T(sweep opt: reduction of opS & opH [nccl]) = 3.320e-07 S  per = 5.46e-05  per(accum) = 93
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.530e-03 S  per = 0.252  per(accum) = 93.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.627e-04 S  per = 0.0268  per(accum) = 93.3
 T(sweep opt: qops_pool join and erase     ) = 1.238e-02 S  per = 2.04  per(accum) = 95.3
 T(sweep opt: conversion from opAB to opPQ ) = 2.837e-02 S  per = 4.67  per(accum) = 100
##### global opt: 5.074e+00 S #####
 T(global opt: fetch) = 1.123e-01 S  per = 2.21  per(accum) = 2.21
 T(global opt: hdiag) = 1.600e+00 S  per = 31.5  per(accum) = 33.7
 T(global opt: dvdsn) = 2.664e+00 S  per = 52.5  per(accum) = 86.2
 T(global opt: decim) = 8.811e-02 S  per = 1.74  per(accum) = 88
 T(global opt: guess) = 7.669e-04 S  per = 0.0151  per(accum) = 88
 T(global opt: renrm) = 6.076e-01 S  per =   12  per(accum) = 100
 T(global opt: save ) = 2.133e-03 S  per = 0.042  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.664e+00 S  T(sum) = 2.662e+00 S  per = 9.992e+01
 T(global opt: preprocess                  ) = 9.735e-04 S  per = 0.0366  per(accum) = 0.0366
 T(global opt: symbolic_formulae           ) = 1.072e-01 S  per = 4.03  per(accum) = 4.06
 T(global opt: hintermediate init          ) = 2.885e-03 S  per = 0.108  per(accum) = 4.17
 T(global opt: preprocess_hformulae_Hxlist ) = 3.596e-02 S  per = 1.35  per(accum) = 5.52
 T(global opt: hmmtasks init               ) = 6.920e-02 S  per =  2.6  per(accum) = 8.12
 T(global opt: initial guess for dvdson    ) = 3.323e-05 S  per = 0.00125  per(accum) = 8.12
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.011e+00 S  per = 75.6  per(accum) = 83.7
 T(global opt: dvdson [cpu-gpu]            ) = 5.490e-02 S  per = 2.06  per(accum) = 85.8
 T(global opt: dvdson [nccl]               ) = 2.293e-04 S  per = 0.00861  per(accum) = 85.8
 T(global opt: dvdson [mpi]                ) = 5.439e-06 S  per = 0.000204  per(accum) = 85.8
 T(global opt: dvdson [rest part(linalg)]  ) = 3.790e-01 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 6.076e-01 S  T(sum) = 6.076e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.123e-04 S  per = 0.134  per(accum) = 0.134
 T(global opt: qops init                    ) = 1.619e-02 S  per = 2.66  per(accum) = 2.8
 T(global opt: symbolic_formulae_renorm     ) = 7.994e-02 S  per = 13.2  per(accum) = 16
 T(global opt: allocate qops on gpu         ) = 4.957e-04 S  per = 0.0816  per(accum) = 16
 T(global opt: site memcpy cpu2gpu          ) = 1.251e-02 S  per = 2.06  per(accum) = 18.1
 T(global opt: rintermediate init           ) = 1.821e-02 S  per =    3  per(accum) = 21.1
 T(global opt: preprocess_formulae_Rlist2   ) = 3.247e-02 S  per = 5.34  per(accum) = 26.4
 T(global opt: rmmtasks init                ) = 8.115e-02 S  per = 13.4  per(accum) = 39.8
 T(global opt: qops memset on cpu           ) = 3.880e-07 S  per = 6.39e-05  per(accum) = 39.8
 T(global opt: preprocess_renorm_batchGPU   ) = 3.226e-01 S  per = 53.1  per(accum) = 92.9
 T(global opt: deallocate cpu and gpu memory) = 7.910e-04 S  per = 0.13  per(accum) = 93
 T(global opt: construct opS [ifdists=true] ) = 3.070e-07 S  per = 5.05e-05  per(accum) = 93
 T(global opt: reduction of opS & opH [nccl]) = 3.320e-07 S  per = 5.46e-05  per(accum) = 93
 T(global opt: qops memcpy gpu2cpu          ) = 1.530e-03 S  per = 0.252  per(accum) = 93.3
 T(global opt: reduction of opS & opH [mpi] ) = 1.627e-04 S  per = 0.0268  per(accum) = 93.3
 T(global opt: qops_pool join and erase     ) = 1.238e-02 S  per = 2.04  per(accum) = 95.3
 T(global opt: conversion from opAB to opPQ ) = 2.837e-02 S  per = 4.67  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.893e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=9/seqsize=34 dots=1 dbond=(10,0)-(11,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=35:2.670e-04MB:2.608e-07GB
total mem of comb=799:6.096e-03MB:5.953e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=10,9,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc= 6
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3251:2.480e-02MB:2.422e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
 rqops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=2679:0.0204MB:2e-05GB
        per(mem): H:0.784 C:2.02 S:2.46 A:0 B:94.7 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=8266:0.0631MB:6.16e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.088e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(10,0) fdel=./scratch/sweep/rop(11,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.253e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(7,7,4) nnz=35:2.670e-04MB
qtensor3: wf3 own=1 _data=0x4789f7a0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=7
 (15,1):4 (15,3):2 (14,2):1
 qbond: qcol nsym=3 dimAll=7
 (14,-2):4 (14,-4):2 (15,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=6 nblocks=36 size=35:2.670e-04MB
### DIAG TIMING: total=4.366e-01 t1=2.309e-05, t2=2.183e-03, t3=2.470e-03, t4=4.318e-01, t5=3.183e-05, t6=1.718e-05, t7=4.669e-06
duration_diagGPU:4.366e-01
duration_diagreduce:1.380e-07
duration_diagtransform:1.054e-06
----- TIMING FOR symbolic_formulae_onedot with size=1635 : 2.620e-02 S -----
rank=0 GPUmem(GB): used=6.159e-05 (oper)=6.159e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1635
 no. of hintermediate operators=828
 no. of coefficients=8280:6.317e-02MB:6.169e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.647e-04 S -----
rank=0 GPUmem(GB): used=1.233e-04 (oper,hinter)=6.159e-05,6.169e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 9.466e-03 S size(H_formulae)=1635 size(Hxlst2)=6 T(Hmu/Hxlist)=4.094e-03,5.371e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.011e-02 S size(H_formulae)=1635 size(Hxlst)=3940 -----
rank=0 GPUmem(GB): used=1.233e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=5.215e-07 batch[need]=1.086e-03 blksize=16 blksize0=4 batchsize=3940
rank=0 GPUmem(GB): used=1.210e-03 (oper,hinter,dvdson,batch)=6.159e-05,6.169e-05,5.215e-07,1.086e-03
ctns::pdvdsonSolver_nkr::solve_iter ndim=35 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.029e-03,9.889e-03,2.987e-02,1.231e-02,5.311e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=1.023e-03 speed=5.097e-04GB/S T(nccl)=5.652e-06 speed=9.228e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=40 t=9.9e-03 per=1.9e+01 cost=6.8e+04 flops=6.8e+06
 sigma[gemm] counter=40 i=0 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=2 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=40 i=3 t=7.6e-03 per=1.5e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=40 i=4 t=7.4e-03 per=1.4e+01 cost=3.4e+04 flops=4.6e+06
 sigma[gemm] counter=40 i=5 t=7.4e-03 per=1.4e+01 cost=3.5e+04 flops=4.7e+06
 sigma[gemm] counter=40 total t=3.0e-02 per=5.7e+01 cost=2.2e+05 flops=7.5e+06
 sigma[red] counter=40 t=1.2e-02 per=2.4e+01 cost=4.8e+04 flops=3.9e+06
----- TIMING FOR sigma_tot : t_inter=4.0e-01 t_gemm=1.2e+00 t_reduction=4.9e-01 tot=2.1e+00 -----
 sigma_tot[inter] counter=40 t=4.0e-01 per=1.9e+01 cost=1.4e+06 flops=3.4e+06
 sigma_tot[gemm] counter=40 i=0 t=8.1e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=1 t=6.7e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=2 t=2.9e-01 per=1.4e+01 cost=4.8e+05 flops=1.6e+06
 sigma_tot[gemm] counter=40 i=3 t=2.9e-01 per=1.4e+01 cost=4.9e+05 flops=1.7e+06
 sigma_tot[gemm] counter=40 i=4 t=2.9e-01 per=1.4e+01 cost=6.7e+05 flops=2.3e+06
 sigma_tot[gemm] counter=40 i=5 t=2.9e-01 per=1.4e+01 cost=6.6e+05 flops=2.3e+06
 sigma_tot[gemm] counter=40 total t=1.2e+00 per=5.7e+01 cost=2.3e+06 flops=2.0e+06
 sigma_tot[red] counter=40 t=4.9e-01 per=2.4e+01 cost=6.2e+05 flops=1.3e+06
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,5.3e-06,1.8e-06,8.5e-07,1.9e-07
settings: ndim=35 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.249940669272 -1.116e+03  2.052e-02    1     1  5.322e-02 5.322e-02 5.319e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.488e-03,1.452e-02,3.023e-02,1.238e-02,5.863e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=1.481e-03 speed=3.522e-04GB/S T(nccl)=6.976e-06 speed=7.476e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.7e-02 -----
 sigma[inter] counter=41 t=1.5e-02 per=2.5e+01 cost=6.8e+04 flops=4.7e+06
 sigma[gemm] counter=41 i=0 t=3.8e-06 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=1 t=3.4e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=2 t=7.5e-03 per=1.3e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=41 i=3 t=7.6e-03 per=1.3e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=41 i=4 t=7.6e-03 per=1.3e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=41 i=5 t=7.5e-03 per=1.3e+01 cost=3.5e+04 flops=4.6e+06
 sigma[gemm] counter=41 total t=3.0e-02 per=5.3e+01 cost=2.2e+05 flops=7.4e+06
 sigma[red] counter=41 t=1.2e-02 per=2.2e+01 cost=4.8e+04 flops=3.8e+06
----- TIMING FOR sigma_tot : t_inter=4.1e-01 t_gemm=1.2e+00 t_reduction=5.0e-01 tot=2.1e+00 -----
 sigma_tot[inter] counter=41 t=4.1e-01 per=1.9e+01 cost=1.4e+06 flops=3.5e+06
 sigma_tot[gemm] counter=41 i=0 t=8.5e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=1 t=7.0e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=2 t=3.0e-01 per=1.4e+01 cost=5.6e+05 flops=1.9e+06
 sigma_tot[gemm] counter=41 i=3 t=3.0e-01 per=1.4e+01 cost=5.6e+05 flops=1.9e+06
 sigma_tot[gemm] counter=41 i=4 t=3.0e-01 per=1.4e+01 cost=7.0e+05 flops=2.3e+06
 sigma_tot[gemm] counter=41 i=5 t=3.0e-01 per=1.4e+01 cost=7.0e+05 flops=2.3e+06
 sigma_tot[gemm] counter=41 total t=1.2e+00 per=5.7e+01 cost=2.5e+06 flops=2.1e+06
 sigma_tot[red] counter=41 t=5.0e-01 per=2.4e+01 cost=6.7e+05 flops=1.3e+06
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=8.9e-06,2.4e-05,6.9e-06,2.0e-06,4.3e-07
    2   0 -    -116.251292325840 -1.352e-03  1.530e-03    2     2  1.235e-01 6.175e-02 5.602e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.674e-03,9.949e-03,2.999e-02,1.265e-02,5.429e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=1.666e-03 speed=3.131e-04GB/S T(nccl)=7.939e-06 speed=6.569e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=42 t=9.9e-03 per=1.9e+01 cost=6.8e+04 flops=6.8e+06
 sigma[gemm] counter=42 i=0 t=2.3e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=1 t=2.0e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=2 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=42 i=3 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=42 i=4 t=7.5e-03 per=1.4e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=42 i=5 t=7.5e-03 per=1.4e+01 cost=3.5e+04 flops=4.6e+06
 sigma[gemm] counter=42 total t=3.0e-02 per=5.7e+01 cost=2.2e+05 flops=7.5e+06
 sigma[red] counter=42 t=1.3e-02 per=2.4e+01 cost=4.8e+04 flops=3.8e+06
----- TIMING FOR sigma_tot : t_inter=4.2e-01 t_gemm=1.2e+00 t_reduction=5.1e-01 tot=2.2e+00 -----
 sigma_tot[inter] counter=42 t=4.2e-01 per=1.9e+01 cost=1.5e+06 flops=3.6e+06
 sigma_tot[gemm] counter=42 i=0 t=8.7e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=1 t=7.2e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=2 t=3.1e-01 per=1.4e+01 cost=6.3e+05 flops=2.1e+06
 sigma_tot[gemm] counter=42 i=3 t=3.1e-01 per=1.4e+01 cost=6.4e+05 flops=2.1e+06
 sigma_tot[gemm] counter=42 i=4 t=3.1e-01 per=1.4e+01 cost=7.3e+05 flops=2.4e+06
 sigma_tot[gemm] counter=42 i=5 t=3.1e-01 per=1.4e+01 cost=7.3e+05 flops=2.4e+06
 sigma_tot[gemm] counter=42 total t=1.2e+00 per=5.7e+01 cost=2.7e+06 flops=2.2e+06
 sigma_tot[red] counter=42 t=5.1e-01 per=2.4e+01 cost=7.2e+05 flops=1.4e+06
T(sub)=3.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.8e-06,2.4e-05,4.1e-06,2.9e-06,2.9e-07
    3   0 -    -116.251300301942 -7.976e-06  5.930e-04    3     3  1.889e-01 6.298e-02 5.549e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.308e-03,1.011e-02,2.979e-02,1.255e-02,5.477e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=2.302e-03 speed=2.266e-04GB/S T(nccl)=6.461e-06 speed=8.072e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=43 t=1.0e-02 per=1.9e+01 cost=6.8e+04 flops=6.7e+06
 sigma[gemm] counter=43 i=0 t=3.3e-06 per=6.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=1 t=2.7e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=2 t=7.4e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=43 i=3 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=43 i=4 t=7.4e-03 per=1.4e+01 cost=3.4e+04 flops=4.6e+06
 sigma[gemm] counter=43 i=5 t=7.5e-03 per=1.4e+01 cost=3.5e+04 flops=4.6e+06
 sigma[gemm] counter=43 total t=3.0e-02 per=5.7e+01 cost=2.2e+05 flops=7.5e+06
 sigma[red] counter=43 t=1.3e-02 per=2.4e+01 cost=4.8e+04 flops=3.8e+06
----- TIMING FOR sigma_tot : t_inter=4.3e-01 t_gemm=1.3e+00 t_reduction=5.3e-01 tot=2.2e+00 -----
 sigma_tot[inter] counter=43 t=4.3e-01 per=1.9e+01 cost=1.6e+06 flops=3.6e+06
 sigma_tot[gemm] counter=43 i=0 t=9.0e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=1 t=7.5e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=2 t=3.2e-01 per=1.4e+01 cost=7.1e+05 flops=2.3e+06
 sigma_tot[gemm] counter=43 i=3 t=3.2e-01 per=1.4e+01 cost=7.2e+05 flops=2.3e+06
 sigma_tot[gemm] counter=43 i=4 t=3.2e-01 per=1.4e+01 cost=7.7e+05 flops=2.4e+06
 sigma_tot[gemm] counter=43 i=5 t=3.2e-01 per=1.4e+01 cost=7.7e+05 flops=2.4e+06
 sigma_tot[gemm] counter=43 total t=1.3e+00 per=5.7e+01 cost=3.0e+06 flops=2.3e+06
 sigma_tot[red] counter=43 t=5.3e-01 per=2.4e+01 cost=7.7e+05 flops=1.5e+06
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=6.4e-06,2.1e-05,2.2e-05,1.8e-06,3.7e-07
    4   0 +    -116.251301799857 -1.498e-06  9.479e-05    3     4  2.566e-01 6.414e-02 5.535e-02
TIMING FOR Davidson : 2.566e-01  T(cal/comm/rest)=2.214e-01,7.900e-07,3.518e-02
decomposed t_rest=3.518e-02
 T(sub)    =1.421e-04 per=4.039e-01
 T(precond)=3.490e-02 per=9.919e+01
 T(ortho)  =2.024e-05 per=5.753e-02
 T(xcopy)  =8.670e-07 per=2.464e-03
 T(xnrm2)  =2.560e-06 per=7.276e-03
 T(other)  =1.200e-04 per=3.410e-01
optimized energies: isweep=0 ibond=9 dots=1 e[0]=-116.251301799857 nmvp=4
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=3.433e-04 change=1.913e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond9.txt
 qbond: qsuper nsym=8 dimAll=28
 (15,1):5 (17,1):4 (16,2):7 (16,0):4 (15,3):3 (17,3):2 (16,4):2 (14,2):1
timing for divide=1.6e-05
timing for compute=1.2e-02
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.6e-05,1.2e-02,0.0e+00,7.2e-06,1.6e-05 -----
decimation summary: 28->7 dwt=-2.220e-16 SvN=1.013e+00
 qbond: qkept nsym=3 dimAll=7
 (16,2):4 (16,4):2 (15,3):1
----- TIMING for decimation_row(nkr): 1.280e-02 S T(decim/select/formRot)=1.256e-02,2.217e-04,1.991e-05 -----
----- TIMING FOR onedot_decimation: 1.290e-02 S T(wf/decim)=9.080e-05,1.281e-02 -----
ctns::oper_renorm coord=(10,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=2679:2.044e-02MB:1.996e-05GB
        per(mem): H:0.784 C:2.46 S:2.02 P:0 Q:94.7 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=3.433e-04 change=1.900e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=365 : 2.834e-02 S -----
rank=0 GPUmem(GB): used=1.233e-04 (oper)=6.159e-05
rank=0 GPUmem(GB): used=1.235e-04 (oper,site)=6.159e-05,2.608e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=828
 no. of coefficients=8280:6.317e-02MB:6.169e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.543e-03 S -----
rank=0 GPUmem(GB): used=1.852e-04 (oper,site,rinter)=6.159e-05,2.608e-07,6.169e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 7.843e-03 S size(rtasks)=365 size(Rlst2)=9 T(Rmu/Rlist)=4.854e-03,2.989e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.170e-03 S size(rtasks)=365 size(Rlst)=2015 -----
rank=0 GPUmem(GB): used=1.852e-04 avail=6.176e+00 total=6.176e+00 batch[need]=5.555e-04 blksize=16 blksize0=4 batchsize=2015
rank=0 GPUmem(GB): used=7.407e-04 (oper,site,rinter,batch)=6.159e-05,2.608e-07,6.169e-05,5.555e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.369e-03,2.290e-02,1.007e-02
----- TIMING FOR renorm : t_inter=7.4e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=10 t=7.4e-03 per=1.8e+01 cost=3.4e+04 flops=4.6e+06
 renorm[gemm] counter=10 i=0 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=2 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=3 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=4 t=7.6e-03 per=1.9e+01 cost=7.6e+03 flops=1.0e+06
 renorm[gemm] counter=10 i=5 t=7.7e-03 per=1.9e+01 cost=2.8e+04 flops=3.7e+06
 renorm[gemm] counter=10 i=6 t=7.7e-03 per=1.9e+01 cost=8.2e+04 flops=1.1e+07
 renorm[gemm] counter=10 total t=2.3e-02 per=5.7e+01 cost=1.2e+05 flops=5.2e+06
 renorm[red] counter=10 t=1.0e-02 per=2.5e+01 cost=3.8e+04 flops=3.8e+06
----- TIMING FOR renorm_tot : t_inter=5.6e-02 t_gemm=2.1e-01 t_reduction=9.8e-02 tot=3.6e-01 -----
 renorm_tot[inter] counter=10 t=5.6e-02 per=1.5e+01 cost=4.4e+05 flops=8.0e+06
 renorm_tot[gemm] counter=10 i=0 t=1.3e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=1 t=1.1e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=2 t=1.1e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=3 t=1.0e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=4 t=7.0e-02 per=1.9e+01 cost=2.0e+05 flops=2.8e+06
 renorm_tot[gemm] counter=10 i=5 t=6.9e-02 per=1.9e+01 cost=2.4e+05 flops=3.5e+06
 renorm_tot[gemm] counter=10 i=6 t=6.9e-02 per=1.9e+01 cost=1.4e+06 flops=2.0e+07
 renorm_tot[gemm] counter=10 total t=2.1e-01 per=5.7e+01 cost=1.8e+06 flops=8.6e+06
 renorm_tot[red] counter=10 t=9.8e-02 per=2.7e+01 cost=6.2e+05 flops=6.3e+06
qops.to_cpu: size(tot)=2679:2.0e-02MB:2.0e-05GB T(to_cpu)=3.4e-04S speed=5.9e-02GB/S
check ||H-H.dagger||=1.922e-15 coord=(10,0) rank=0
----- TIMING FOR oper_renorm : 0.0974 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=5.875e-04 change=1.392e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.877e-03 change=-2.671e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.877e-03 change=-7.153e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 8.775e-01 S #####
 T(local opt: fetch) = 1.225e-02 S  per =  1.4  per(accum) = 1.4
 T(local opt: hdiag) = 4.366e-01 S  per = 49.8  per(accum) = 51.2
 T(local opt: dvdsn) = 3.162e-01 S  per =   36  per(accum) = 87.2
 T(local opt: decim) = 1.292e-02 S  per = 1.47  per(accum) = 88.7
 T(local opt: guess) = 7.685e-05 S  per = 0.00876  per(accum) = 88.7
 T(local opt: renrm) = 9.920e-02 S  per = 11.3  per(accum) = 100
 T(local opt: save ) = 2.677e-04 S  per = 0.0305  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.162e-01 S  T(sum) = 3.156e-01 S  per = 9.980e+01
 T(local opt: preprocess                  ) = 1.018e-04 S  per = 0.0323  per(accum) = 0.0323
 T(local opt: symbolic_formulae           ) = 2.622e-02 S  per = 8.31  per(accum) = 8.34
 T(local opt: hintermediate init          ) = 6.837e-04 S  per = 0.217  per(accum) = 8.56
 T(local opt: preprocess_hformulae_Hxlist ) = 1.023e-02 S  per = 3.24  per(accum) = 11.8
 T(local opt: hmmtasks init               ) = 2.175e-02 S  per = 6.89  per(accum) = 18.7
 T(local opt: initial guess for dvdson    ) = 4.378e-06 S  per = 0.00139  per(accum) = 18.7
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.149e-01 S  per = 68.1  per(accum) = 86.8
 T(local opt: dvdson [cpu-gpu]            ) = 6.471e-03 S  per = 2.05  per(accum) = 88.8
 T(local opt: dvdson [nccl]               ) = 2.703e-05 S  per = 0.00857  per(accum) = 88.9
 T(local opt: dvdson [mpi]                ) = 7.900e-07 S  per = 0.00025  per(accum) = 88.9
 T(local opt: dvdson [rest part(linalg)]  ) = 3.518e-02 S  per = 11.1  per(accum) = 100
Detailed decomposition of T(renrm) = 9.920e-02 S  T(sum) = 9.920e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.498e-05 S  per = 0.0756  per(accum) = 0.0756
 T(local opt: qops init                    ) = 2.547e-03 S  per = 2.57  per(accum) = 2.64
 T(local opt: symbolic_formulae_renorm     ) = 2.836e-02 S  per = 28.6  per(accum) = 31.2
 T(local opt: allocate qops on gpu         ) = 5.598e-05 S  per = 0.0564  per(accum) = 31.3
 T(local opt: site memcpy cpu2gpu          ) = 1.678e-03 S  per = 1.69  per(accum) = 33
 T(local opt: rintermediate init           ) = 2.559e-03 S  per = 2.58  per(accum) = 35.6
 T(local opt: preprocess_formulae_Rlist2   ) = 8.239e-03 S  per = 8.31  per(accum) = 43.9
 T(local opt: rmmtasks init                ) = 1.301e-02 S  per = 13.1  per(accum) = 57
 T(local opt: qops memset on cpu           ) = 5.500e-08 S  per = 5.54e-05  per(accum) = 57
 T(local opt: preprocess_renorm_batchGPU   ) = 4.043e-02 S  per = 40.8  per(accum) = 97.7
 T(local opt: deallocate cpu and gpu memory) = 1.357e-04 S  per = 0.137  per(accum) = 97.9
 T(local opt: construct opS [ifdists=true] ) = 5.700e-08 S  per = 5.75e-05  per(accum) = 97.9
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 3.83e-05  per(accum) = 97.9
 T(local opt: qops memcpy gpu2cpu          ) = 3.458e-04 S  per = 0.349  per(accum) = 98.2
 T(local opt: reduction of opS & opH [mpi] ) = 1.655e-05 S  per = 0.0167  per(accum) = 98.2
 T(local opt: qops_pool join and erase     ) = 1.740e-03 S  per = 1.75  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.489e-06 S  per = 0.0015  per(accum) = 100
##### sweep opt: 5.952e+00 S #####
 T(sweep opt: fetch) = 1.246e-01 S  per = 2.09  per(accum) = 2.09
 T(sweep opt: hdiag) = 2.036e+00 S  per = 34.2  per(accum) = 36.3
 T(sweep opt: dvdsn) = 2.980e+00 S  per = 50.1  per(accum) = 86.4
 T(sweep opt: decim) = 1.010e-01 S  per =  1.7  per(accum) = 88.1
 T(sweep opt: guess) = 8.438e-04 S  per = 0.0142  per(accum) = 88.1
 T(sweep opt: renrm) = 7.068e-01 S  per = 11.9  per(accum) = 100
 T(sweep opt: save ) = 2.401e-03 S  per = 0.0403  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.980e+00 S  T(sum) = 2.977e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 1.075e-03 S  per = 0.0361  per(accum) = 0.0361
 T(sweep opt: symbolic_formulae           ) = 1.334e-01 S  per = 4.48  per(accum) = 4.52
 T(sweep opt: hintermediate init          ) = 3.569e-03 S  per = 0.12  per(accum) = 4.64
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.618e-02 S  per = 1.55  per(accum) = 6.19
 T(sweep opt: hmmtasks init               ) = 9.096e-02 S  per = 3.06  per(accum) = 9.24
 T(sweep opt: initial guess for dvdson    ) = 3.761e-05 S  per = 0.00126  per(accum) = 9.24
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.226e+00 S  per = 74.8  per(accum) = 84
 T(sweep opt: dvdson [cpu-gpu]            ) = 6.137e-02 S  per = 2.06  per(accum) = 86.1
 T(sweep opt: dvdson [nccl]               ) = 2.563e-04 S  per = 0.00861  per(accum) = 86.1
 T(sweep opt: dvdson [mpi]                ) = 6.229e-06 S  per = 0.000209  per(accum) = 86.1
 T(sweep opt: dvdson [rest part(linalg)]  ) = 4.142e-01 S  per = 13.9  per(accum) = 100
Detailed decomposition of T(renrm) = 7.068e-01 S  T(sum) = 7.068e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.873e-04 S  per = 0.126  per(accum) = 0.126
 T(sweep opt: qops init                    ) = 1.874e-02 S  per = 2.65  per(accum) = 2.78
 T(sweep opt: symbolic_formulae_renorm     ) = 1.083e-01 S  per = 15.3  per(accum) = 18.1
 T(sweep opt: allocate qops on gpu         ) = 5.517e-04 S  per = 0.0781  per(accum) = 18.2
 T(sweep opt: site memcpy cpu2gpu          ) = 1.419e-02 S  per = 2.01  per(accum) = 20.2
 T(sweep opt: rintermediate init           ) = 2.077e-02 S  per = 2.94  per(accum) = 23.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.071e-02 S  per = 5.76  per(accum) = 28.9
 T(sweep opt: rmmtasks init                ) = 9.416e-02 S  per = 13.3  per(accum) = 42.2
 T(sweep opt: qops memset on cpu           ) = 4.430e-07 S  per = 6.27e-05  per(accum) = 42.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.630e-01 S  per = 51.4  per(accum) = 93.6
 T(sweep opt: deallocate cpu and gpu memory) = 9.268e-04 S  per = 0.131  per(accum) = 93.7
 T(sweep opt: construct opS [ifdists=true] ) = 3.640e-07 S  per = 5.15e-05  per(accum) = 93.7
 T(sweep opt: reduction of opS & opH [nccl]) = 3.700e-07 S  per = 5.23e-05  per(accum) = 93.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.876e-03 S  per = 0.265  per(accum) = 94
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.793e-04 S  per = 0.0254  per(accum) = 94
 T(sweep opt: qops_pool join and erase     ) = 1.412e-02 S  per =    2  per(accum) = 96
 T(sweep opt: conversion from opAB to opPQ ) = 2.838e-02 S  per = 4.01  per(accum) = 100
##### global opt: 5.952e+00 S #####
 T(global opt: fetch) = 1.246e-01 S  per = 2.09  per(accum) = 2.09
 T(global opt: hdiag) = 2.036e+00 S  per = 34.2  per(accum) = 36.3
 T(global opt: dvdsn) = 2.980e+00 S  per = 50.1  per(accum) = 86.4
 T(global opt: decim) = 1.010e-01 S  per =  1.7  per(accum) = 88.1
 T(global opt: guess) = 8.438e-04 S  per = 0.0142  per(accum) = 88.1
 T(global opt: renrm) = 7.068e-01 S  per = 11.9  per(accum) = 100
 T(global opt: save ) = 2.401e-03 S  per = 0.0403  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.980e+00 S  T(sum) = 2.977e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 1.075e-03 S  per = 0.0361  per(accum) = 0.0361
 T(global opt: symbolic_formulae           ) = 1.334e-01 S  per = 4.48  per(accum) = 4.52
 T(global opt: hintermediate init          ) = 3.569e-03 S  per = 0.12  per(accum) = 4.64
 T(global opt: preprocess_hformulae_Hxlist ) = 4.618e-02 S  per = 1.55  per(accum) = 6.19
 T(global opt: hmmtasks init               ) = 9.096e-02 S  per = 3.06  per(accum) = 9.24
 T(global opt: initial guess for dvdson    ) = 3.761e-05 S  per = 0.00126  per(accum) = 9.24
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.226e+00 S  per = 74.8  per(accum) = 84
 T(global opt: dvdson [cpu-gpu]            ) = 6.137e-02 S  per = 2.06  per(accum) = 86.1
 T(global opt: dvdson [nccl]               ) = 2.563e-04 S  per = 0.00861  per(accum) = 86.1
 T(global opt: dvdson [mpi]                ) = 6.229e-06 S  per = 0.000209  per(accum) = 86.1
 T(global opt: dvdson [rest part(linalg)]  ) = 4.142e-01 S  per = 13.9  per(accum) = 100
Detailed decomposition of T(renrm) = 7.068e-01 S  T(sum) = 7.068e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.873e-04 S  per = 0.126  per(accum) = 0.126
 T(global opt: qops init                    ) = 1.874e-02 S  per = 2.65  per(accum) = 2.78
 T(global opt: symbolic_formulae_renorm     ) = 1.083e-01 S  per = 15.3  per(accum) = 18.1
 T(global opt: allocate qops on gpu         ) = 5.517e-04 S  per = 0.0781  per(accum) = 18.2
 T(global opt: site memcpy cpu2gpu          ) = 1.419e-02 S  per = 2.01  per(accum) = 20.2
 T(global opt: rintermediate init           ) = 2.077e-02 S  per = 2.94  per(accum) = 23.1
 T(global opt: preprocess_formulae_Rlist2   ) = 4.071e-02 S  per = 5.76  per(accum) = 28.9
 T(global opt: rmmtasks init                ) = 9.416e-02 S  per = 13.3  per(accum) = 42.2
 T(global opt: qops memset on cpu           ) = 4.430e-07 S  per = 6.27e-05  per(accum) = 42.2
 T(global opt: preprocess_renorm_batchGPU   ) = 3.630e-01 S  per = 51.4  per(accum) = 93.6
 T(global opt: deallocate cpu and gpu memory) = 9.268e-04 S  per = 0.131  per(accum) = 93.7
 T(global opt: construct opS [ifdists=true] ) = 3.640e-07 S  per = 5.15e-05  per(accum) = 93.7
 T(global opt: reduction of opS & opH [nccl]) = 3.700e-07 S  per = 5.23e-05  per(accum) = 93.7
 T(global opt: qops memcpy gpu2cpu          ) = 1.876e-03 S  per = 0.265  per(accum) = 94
 T(global opt: reduction of opS & opH [mpi] ) = 1.793e-04 S  per = 0.0254  per(accum) = 94
 T(global opt: qops_pool join and erase     ) = 1.412e-02 S  per =    2  per(accum) = 96
 T(global opt: conversion from opAB to opPQ ) = 2.838e-02 S  per = 4.01  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.893e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=10/seqsize=34 dots=1 dbond=(11,0)-(12,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=30:2.289e-04MB:2.235e-07GB
total mem of comb=794:6.058e-03MB:5.916e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=11,8,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc= 7
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=2679:2.044e-02MB:1.996e-05GB
        per(mem): H:0.784 C:2.46 S:2.02 P:0 Q:94.7 
 rqops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=7,7 size(op)=17:0.00013MB size(tot)=1825:0.0139MB:1.36e-05GB
        per(mem): H:0.932 C:4.38 S:6.58 A:0 B:88.1 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=6840:0.0522MB:5.1e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.046e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(11,0) fdel=./scratch/sweep/rop(12,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.490e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(7,7,4) nnz=30:2.289e-04MB
qtensor3: wf3 own=1 _data=0x3c5c1e00
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=7
 (16,2):4 (16,4):2 (15,3):1
 qbond: qcol nsym=3 dimAll=7
 (12,-2):3 (13,-3):2 (12,-4):2
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=30:2.289e-04MB
### DIAG TIMING: total=3.294e-01 t1=2.610e-05, t2=2.232e-03, t3=2.497e-03, t4=3.246e-01, t5=2.578e-05, t6=2.152e-05, t7=7.679e-06
duration_diagGPU:3.294e-01
duration_diagreduce:6.500e-08
duration_diagtransform:5.260e-07
----- TIMING FOR symbolic_formulae_onedot with size=1327 : 2.198e-02 S -----
rank=0 GPUmem(GB): used=5.096e-05 (oper)=5.096e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1327
 no. of hintermediate operators=664
 no. of coefficients=7304:5.573e-02MB:5.442e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.390e-04 S -----
rank=0 GPUmem(GB): used=1.054e-04 (oper,hinter)=5.096e-05,5.442e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.562e-03 S size(H_formulae)=1327 size(Hxlst2)=5 T(Hmu/Hxlist)=3.355e-03,3.207e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.952e-03 S size(H_formulae)=1327 size(Hxlst)=2480 -----
rank=0 GPUmem(GB): used=1.054e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=4.470e-07 batch[need]=5.358e-04 blksize=12 blksize0=4 batchsize=2480
rank=0 GPUmem(GB): used=6.417e-04 (oper,hinter,dvdson,batch)=5.096e-05,5.442e-05,4.470e-07,5.358e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=30 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.354e-04,1.002e-02,3.018e-02,1.242e-02,5.316e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=5.296e-04 speed=8.442e-04GB/S T(nccl)=5.877e-06 speed=7.607e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=44 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=44 i=0 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=2 t=7.6e-03 per=1.5e+01 cost=3.1e+04 flops=4.0e+06
 sigma[gemm] counter=44 i=3 t=7.6e-03 per=1.5e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=44 i=4 t=7.5e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=44 i=5 t=7.4e-03 per=1.4e+01 cost=2.4e+04 flops=3.2e+06
 sigma[gemm] counter=44 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=44 t=1.2e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=4.4e-01 t_gemm=1.3e+00 t_reduction=5.4e-01 tot=2.3e+00 -----
 sigma_tot[inter] counter=44 t=4.4e-01 per=1.9e+01 cost=1.6e+06 flops=3.6e+06
 sigma_tot[gemm] counter=44 i=0 t=9.1e-05 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=1 t=7.6e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=2 t=3.2e-01 per=1.4e+01 cost=7.4e+05 flops=2.3e+06
 sigma_tot[gemm] counter=44 i=3 t=3.2e-01 per=1.4e+01 cost=7.5e+05 flops=2.3e+06
 sigma_tot[gemm] counter=44 i=4 t=3.2e-01 per=1.4e+01 cost=7.9e+05 flops=2.4e+06
 sigma_tot[gemm] counter=44 i=5 t=3.2e-01 per=1.4e+01 cost=7.9e+05 flops=2.4e+06
 sigma_tot[gemm] counter=44 total t=1.3e+00 per=5.7e+01 cost=3.1e+06 flops=2.4e+06
 sigma_tot[red] counter=44 t=5.4e-01 per=2.4e+01 cost=8.0e+05 flops=1.5e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,7.3e-06,2.1e-06,1.5e-06,1.9e-07
settings: ndim=30 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.251301799857 -1.116e+03  6.597e-02    1     1  5.329e-02 5.329e-02 5.325e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.592e-03,1.211e-02,3.007e-02,1.246e-02,5.625e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=1.585e-03 speed=2.820e-04GB/S T(nccl)=6.824e-06 speed=6.551e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.5e-02 -----
 sigma[inter] counter=45 t=1.2e-02 per=2.2e+01 cost=4.2e+04 flops=3.5e+06
 sigma[gemm] counter=45 i=0 t=4.1e-06 per=7.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=1 t=3.5e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=2 t=7.6e-03 per=1.4e+01 cost=3.1e+04 flops=4.0e+06
 sigma[gemm] counter=45 i=3 t=7.6e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=45 i=4 t=7.5e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=45 i=5 t=7.4e-03 per=1.4e+01 cost=2.4e+04 flops=3.2e+06
 sigma[gemm] counter=45 total t=3.0e-02 per=5.5e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=45 t=1.2e-02 per=2.3e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=4.5e-01 t_gemm=1.3e+00 t_reduction=5.5e-01 tot=2.3e+00 -----
 sigma_tot[inter] counter=45 t=4.5e-01 per=1.9e+01 cost=1.6e+06 flops=3.6e+06
 sigma_tot[gemm] counter=45 i=0 t=9.5e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=1 t=7.9e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=2 t=3.3e-01 per=1.4e+01 cost=7.7e+05 flops=2.3e+06
 sigma_tot[gemm] counter=45 i=3 t=3.3e-01 per=1.4e+01 cost=7.8e+05 flops=2.4e+06
 sigma_tot[gemm] counter=45 i=4 t=3.3e-01 per=1.4e+01 cost=8.1e+05 flops=2.5e+06
 sigma_tot[gemm] counter=45 i=5 t=3.3e-01 per=1.4e+01 cost=8.1e+05 flops=2.5e+06
 sigma_tot[gemm] counter=45 total t=1.3e+00 per=5.7e+01 cost=3.2e+06 flops=2.4e+06
 sigma_tot[red] counter=45 t=5.5e-01 per=2.4e+01 cost=8.2e+05 flops=1.5e+06
T(sub)=7.5e-05 T(gemm/eig/ortho/gemm/axpy)=2.4e-05,4.3e-05,6.4e-06,1.8e-06,4.1e-07
    2   0 -    -116.270096750207 -1.879e-02  1.957e-02    2     2  1.232e-01 6.161e-02 5.484e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.825e-03,1.008e-02,3.023e-02,1.247e-02,5.462e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=1.819e-03 speed=2.458e-04GB/S T(nccl)=6.025e-06 speed=7.420e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=46 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=46 i=0 t=1.9e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=1 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=2 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=46 i=3 t=7.6e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=46 i=4 t=7.6e-03 per=1.4e+01 cost=2.3e+04 flops=3.0e+06
 sigma[gemm] counter=46 i=5 t=7.5e-03 per=1.4e+01 cost=2.4e+04 flops=3.1e+06
 sigma[gemm] counter=46 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=46 t=1.2e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=4.6e-01 t_gemm=1.4e+00 t_reduction=5.6e-01 tot=2.4e+00 -----
 sigma_tot[inter] counter=46 t=4.6e-01 per=1.9e+01 cost=1.7e+06 flops=3.6e+06
 sigma_tot[gemm] counter=46 i=0 t=9.7e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=1 t=8.1e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=2 t=3.4e-01 per=1.4e+01 cost=8.0e+05 flops=2.4e+06
 sigma_tot[gemm] counter=46 i=3 t=3.4e-01 per=1.4e+01 cost=8.1e+05 flops=2.4e+06
 sigma_tot[gemm] counter=46 i=4 t=3.4e-01 per=1.4e+01 cost=8.4e+05 flops=2.5e+06
 sigma_tot[gemm] counter=46 i=5 t=3.4e-01 per=1.4e+01 cost=8.4e+05 flops=2.5e+06
 sigma_tot[gemm] counter=46 total t=1.4e+00 per=5.7e+01 cost=3.3e+06 flops=2.4e+06
 sigma_tot[red] counter=46 t=5.6e-01 per=2.4e+01 cost=8.5e+05 flops=1.5e+06
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,2.5e-05,3.7e-06,1.3e-06,2.2e-07
    3   0 -    -116.271822298222 -1.726e-03  5.812e-03    3     3  1.951e-01 6.505e-02 5.481e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.897e-03,1.010e-02,3.017e-02,1.273e-02,5.491e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=1.892e-03 speed=2.363e-04GB/S T(nccl)=5.067e-06 speed=8.822e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=47 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=47 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=2 t=7.6e-03 per=1.4e+01 cost=3.1e+04 flops=4.0e+06
 sigma[gemm] counter=47 i=3 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=47 i=4 t=7.6e-03 per=1.4e+01 cost=2.3e+04 flops=3.0e+06
 sigma[gemm] counter=47 i=5 t=7.5e-03 per=1.4e+01 cost=2.4e+04 flops=3.2e+06
 sigma[gemm] counter=47 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=47 t=1.3e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=4.7e-01 t_gemm=1.4e+00 t_reduction=5.8e-01 tot=2.4e+00 -----
 sigma_tot[inter] counter=47 t=4.7e-01 per=1.9e+01 cost=1.7e+06 flops=3.7e+06
 sigma_tot[gemm] counter=47 i=0 t=9.9e-05 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=1 t=8.2e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=2 t=3.5e-01 per=1.4e+01 cost=8.3e+05 flops=2.4e+06
 sigma_tot[gemm] counter=47 i=3 t=3.5e-01 per=1.4e+01 cost=8.4e+05 flops=2.4e+06
 sigma_tot[gemm] counter=47 i=4 t=3.5e-01 per=1.4e+01 cost=8.6e+05 flops=2.5e+06
 sigma_tot[gemm] counter=47 i=5 t=3.5e-01 per=1.4e+01 cost=8.6e+05 flops=2.5e+06
 sigma_tot[gemm] counter=47 total t=1.4e+00 per=5.7e+01 cost=3.4e+06 flops=2.5e+06
 sigma_tot[red] counter=47 t=5.8e-01 per=2.4e+01 cost=8.8e+05 flops=1.5e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.4e-05,2.9e-06,1.0e-06,1.7e-07
    4   0 -    -116.271893465758 -7.117e-05  1.023e-03    3     4  2.611e-01 6.528e-02 5.486e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.547e-04,9.961e-03,2.134e-02,3.292e-03,3.516e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=5.469e-04 speed=8.174e-04GB/S T(nccl)=7.786e-06 speed=5.742e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=2.1e-02 t_reduction=3.3e-03 tot=3.5e-02 -----
 sigma[inter] counter=48 t=1.0e-02 per=2.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=48 i=0 t=1.7e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=1 t=1.4e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=2 t=7.5e-03 per=2.2e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=48 i=3 t=7.6e-03 per=2.2e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=48 i=4 t=5.1e-03 per=1.5e+01 cost=2.3e+04 flops=4.5e+06
 sigma[gemm] counter=48 i=5 t=1.1e-03 per=3.3e+00 cost=2.4e+04 flops=2.1e+07
 sigma[gemm] counter=48 total t=2.1e-02 per=6.2e+01 cost=1.1e+05 flops=5.1e+06
 sigma[red] counter=48 t=3.3e-03 per=9.5e+00 cost=2.8e+04 flops=8.4e+06
----- TIMING FOR sigma_tot : t_inter=4.8e-01 t_gemm=1.4e+00 t_reduction=5.8e-01 tot=2.5e+00 -----
 sigma_tot[inter] counter=48 t=4.8e-01 per=2.0e+01 cost=1.8e+06 flops=3.7e+06
 sigma_tot[gemm] counter=48 i=0 t=1.0e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=1 t=8.4e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=2 t=3.5e-01 per=1.4e+01 cost=8.6e+05 flops=2.4e+06
 sigma_tot[gemm] counter=48 i=3 t=3.5e-01 per=1.4e+01 cost=8.8e+05 flops=2.5e+06
 sigma_tot[gemm] counter=48 i=4 t=3.5e-01 per=1.4e+01 cost=8.8e+05 flops=2.5e+06
 sigma_tot[gemm] counter=48 i=5 t=3.5e-01 per=1.4e+01 cost=8.8e+05 flops=2.5e+06
 sigma_tot[gemm] counter=48 total t=1.4e+00 per=5.7e+01 cost=3.5e+06 flops=2.5e+06
 sigma_tot[red] counter=48 t=5.8e-01 per=2.3e+01 cost=9.1e+05 flops=1.6e+06
T(sub)=5.7e-05 T(gemm/eig/ortho/gemm/axpy)=8.0e-06,4.0e-05,6.0e-06,2.3e-06,4.5e-07
    5   0 -    -116.271896238916 -2.773e-06  2.507e-04    3     5  3.089e-01 6.178e-02 5.096e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.005e-03,9.993e-03,2.982e-02,1.237e-02,5.320e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=9.970e-04 speed=4.484e-04GB/S T(nccl)=7.938e-06 speed=5.632e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=49 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=49 i=0 t=3.1e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=1 t=2.7e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=2 t=7.4e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=49 i=3 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=49 i=4 t=7.5e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=49 i=5 t=7.4e-03 per=1.4e+01 cost=2.4e+04 flops=3.2e+06
 sigma[gemm] counter=49 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=49 t=1.2e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=4.9e-01 t_gemm=1.4e+00 t_reduction=5.9e-01 tot=2.5e+00 -----
 sigma_tot[inter] counter=49 t=4.9e-01 per=2.0e+01 cost=1.8e+06 flops=3.7e+06
 sigma_tot[gemm] counter=49 i=0 t=1.0e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=1 t=8.6e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=2 t=3.6e-01 per=1.4e+01 cost=8.9e+05 flops=2.5e+06
 sigma_tot[gemm] counter=49 i=3 t=3.6e-01 per=1.4e+01 cost=9.1e+05 flops=2.5e+06
 sigma_tot[gemm] counter=49 i=4 t=3.6e-01 per=1.4e+01 cost=9.1e+05 flops=2.5e+06
 sigma_tot[gemm] counter=49 i=5 t=3.6e-01 per=1.4e+01 cost=9.1e+05 flops=2.6e+06
 sigma_tot[gemm] counter=49 total t=1.4e+00 per=5.7e+01 cost=3.6e+06 flops=2.5e+06
 sigma_tot[red] counter=49 t=5.9e-01 per=2.3e+01 cost=9.3e+05 flops=1.6e+06
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,1.9e-05,1.7e-05,1.5e-06,2.7e-07
    6   0 +    -116.271896441599 -2.027e-07  6.465e-05    3     6  3.727e-01 6.212e-02 5.136e-02
TIMING FOR Davidson : 3.728e-01  T(cal/comm/rest)=3.082e-01,1.136e-06,6.459e-02
decomposed t_rest=6.459e-02
 T(sub)    =2.580e-04 per=3.994e-01
 T(precond)=6.412e-02 per=9.928e+01
 T(ortho)  =2.379e-05 per=3.684e-02
 T(xcopy)  =3.751e-06 per=5.808e-03
 T(xnrm2)  =3.908e-06 per=6.051e-03
 T(other)  =1.748e-04 per=2.706e-01
optimized energies: isweep=0 ibond=10 dots=1 e[0]=-116.271896441599 nmvp=6
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=3.815e-04 change=1.454e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond10.txt
 qbond: qsuper nsym=8 dimAll=28
 (16,2):5 (18,2):4 (17,3):7 (17,1):4 (16,4):3 (18,4):2 (17,5):2 (15,3):1
timing for divide=1.6e-05
timing for compute=9.0e-03
timing for collect=2.3e-05
----- TMING FOR decimation_genbasis(nkr): 9.1e-03 S T(divide/compute[cpu/gpu/rest]/collect)=1.6e-05,9.0e-03,0.0e+00,7.2e-06,2.3e-05 -----
decimation summary: 28->7 dwt=+0.000e+00 SvN=6.106e-01
 qbond: qkept nsym=3 dimAll=7
 (18,2):3 (17,3):2 (18,4):2
----- TIMING for decimation_row(nkr): 9.452e-03 S T(decim/select/formRot)=9.122e-03,3.042e-04,2.582e-05 -----
----- TIMING FOR onedot_decimation: 9.549e-03 S T(wf/decim)=8.132e-05,9.468e-03 -----
ctns::oper_renorm coord=(11,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=7,7 size(op)=17:1.297e-04MB size(tot)=1825:1.392e-02MB:1.360e-05GB
        per(mem): H:0.932 C:6.58 S:4.38 P:0 Q:88.1 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=3.815e-04 change=1.551e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=297 : 2.446e-02 S -----
rank=0 GPUmem(GB): used=1.054e-04 (oper)=5.096e-05
rank=0 GPUmem(GB): used=1.056e-04 (oper,site)=5.096e-05,2.235e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=664
 no. of coefficients=7304:5.573e-02MB:5.442e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.464e-03 S -----
rank=0 GPUmem(GB): used=1.600e-04 (oper,site,rinter)=5.096e-05,2.235e-07,5.442e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 6.219e-03 S size(rtasks)=297 size(Rlst2)=9 T(Rmu/Rlist)=4.010e-03,2.209e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.502e-03 S size(rtasks)=297 size(Rlst)=1278 -----
rank=0 GPUmem(GB): used=1.600e-04 avail=6.176e+00 total=6.176e+00 batch[need]=2.761e-04 blksize=12 blksize0=4 batchsize=1278
rank=0 GPUmem(GB): used=4.362e-04 (oper,site,rinter,batch)=5.096e-05,2.235e-07,5.442e-05,2.761e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.020e-03,2.246e-02,1.007e-02
----- TIMING FOR renorm : t_inter=6.0e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=11 t=6.0e-03 per=1.6e+01 cost=2.1e+04 flops=3.5e+06
 renorm[gemm] counter=11 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=2 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=3 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=4 t=7.5e-03 per=1.9e+01 cost=4.6e+03 flops=6.2e+05
 renorm[gemm] counter=11 i=5 t=7.4e-03 per=1.9e+01 cost=2.0e+04 flops=2.6e+06
 renorm[gemm] counter=11 i=6 t=7.5e-03 per=2.0e+01 cost=3.2e+04 flops=4.3e+06
 renorm[gemm] counter=11 total t=2.2e-02 per=5.8e+01 cost=5.7e+04 flops=2.5e+06
 renorm[red] counter=11 t=1.0e-02 per=2.6e+01 cost=1.2e+04 flops=1.2e+06
----- TIMING FOR renorm_tot : t_inter=6.2e-02 t_gemm=2.3e-01 t_reduction=1.1e-01 tot=4.0e-01 -----
 renorm_tot[inter] counter=11 t=6.2e-02 per=1.5e+01 cost=4.6e+05 flops=7.5e+06
 renorm_tot[gemm] counter=11 i=0 t=1.4e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=1 t=1.2e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=2 t=1.2e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=3 t=1.2e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=4 t=7.7e-02 per=1.9e+01 cost=2.0e+05 flops=2.6e+06
 renorm_tot[gemm] counter=11 i=5 t=7.7e-02 per=1.9e+01 cost=2.6e+05 flops=3.4e+06
 renorm_tot[gemm] counter=11 i=6 t=7.7e-02 per=1.9e+01 cost=1.4e+06 flops=1.8e+07
 renorm_tot[gemm] counter=11 total t=2.3e-01 per=5.8e+01 cost=1.8e+06 flops=8.0e+06
 renorm_tot[red] counter=11 t=1.1e-01 per=2.7e+01 cost=6.4e+05 flops=5.9e+06
qops.to_cpu: size(tot)=1825:1.4e-02MB:1.4e-05GB T(to_cpu)=2.9e-04S speed=4.6e-02GB/S
check ||H-H.dagger||=9.466e-15 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.0855 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=9.918e-05 change=1.085e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.022e-03 change=-2.300e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.022e-03 change=-6.706e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 8.533e-01 S #####
 T(local opt: fetch) = 1.117e-02 S  per = 1.31  per(accum) = 1.31
 T(local opt: hdiag) = 3.294e-01 S  per = 38.6  per(accum) = 39.9
 T(local opt: dvdsn) = 4.155e-01 S  per = 48.7  per(accum) = 88.6
 T(local opt: decim) = 9.562e-03 S  per = 1.12  per(accum) = 89.7
 T(local opt: guess) = 1.063e-04 S  per = 0.0125  per(accum) = 89.7
 T(local opt: renrm) = 8.727e-02 S  per = 10.2  per(accum) = 100
 T(local opt: save ) = 2.489e-04 S  per = 0.0292  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.155e-01 S  T(sum) = 4.149e-01 S  per = 9.985e+01
 T(local opt: preprocess                  ) = 1.210e-04 S  per = 0.0292  per(accum) = 0.0292
 T(local opt: symbolic_formulae           ) = 2.199e-02 S  per =  5.3  per(accum) = 5.33
 T(local opt: hintermediate init          ) = 5.583e-04 S  per = 0.135  per(accum) = 5.46
 T(local opt: preprocess_hformulae_Hxlist ) = 7.023e-03 S  per = 1.69  per(accum) = 7.16
 T(local opt: hmmtasks init               ) = 1.242e-02 S  per = 2.99  per(accum) = 10.2
 T(local opt: initial guess for dvdson    ) = 1.030e-05 S  per = 0.00248  per(accum) = 10.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.008e-01 S  per = 72.5  per(accum) = 82.6
 T(local opt: dvdson [cpu-gpu]            ) = 7.369e-03 S  per = 1.78  per(accum) = 84.4
 T(local opt: dvdson [nccl]               ) = 3.952e-05 S  per = 0.00952  per(accum) = 84.4
 T(local opt: dvdson [mpi]                ) = 1.136e-06 S  per = 0.000274  per(accum) = 84.4
 T(local opt: dvdson [rest part(linalg)]  ) = 6.459e-02 S  per = 15.6  per(accum) = 100
Detailed decomposition of T(renrm) = 8.727e-02 S  T(sum) = 8.727e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 9.255e-05 S  per = 0.106  per(accum) = 0.106
 T(local opt: qops init                    ) = 3.018e-03 S  per = 3.46  per(accum) = 3.56
 T(local opt: symbolic_formulae_renorm     ) = 2.447e-02 S  per =   28  per(accum) = 31.6
 T(local opt: allocate qops on gpu         ) = 6.329e-05 S  per = 0.0725  per(accum) = 31.7
 T(local opt: site memcpy cpu2gpu          ) = 2.068e-03 S  per = 2.37  per(accum) = 34
 T(local opt: rintermediate init           ) = 2.479e-03 S  per = 2.84  per(accum) = 36.9
 T(local opt: preprocess_formulae_Rlist2   ) = 6.550e-03 S  per =  7.5  per(accum) = 44.4
 T(local opt: rmmtasks init                ) = 7.806e-03 S  per = 8.94  per(accum) = 53.3
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 4.01e-05  per(accum) = 53.3
 T(local opt: preprocess_renorm_batchGPU   ) = 3.864e-02 S  per = 44.3  per(accum) = 97.6
 T(local opt: deallocate cpu and gpu memory) = 7.627e-05 S  per = 0.0874  per(accum) = 97.7
 T(local opt: construct opS [ifdists=true] ) = 5.900e-08 S  per = 6.76e-05  per(accum) = 97.7
 T(local opt: reduction of opS & opH [nccl]) = 4.000e-08 S  per = 4.58e-05  per(accum) = 97.7
 T(local opt: qops memcpy gpu2cpu          ) = 3.005e-04 S  per = 0.344  per(accum) = 98
 T(local opt: reduction of opS & opH [mpi] ) = 1.684e-05 S  per = 0.0193  per(accum) = 98.1
 T(local opt: qops_pool join and erase     ) = 1.686e-03 S  per = 1.93  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.470e-06 S  per = 0.00168  per(accum) = 100
##### sweep opt: 6.805e+00 S #####
 T(sweep opt: fetch) = 1.358e-01 S  per = 1.99  per(accum) = 1.99
 T(sweep opt: hdiag) = 2.366e+00 S  per = 34.8  per(accum) = 36.8
 T(sweep opt: dvdsn) = 3.396e+00 S  per = 49.9  per(accum) = 86.7
 T(sweep opt: decim) = 1.106e-01 S  per = 1.62  per(accum) = 88.3
 T(sweep opt: guess) = 9.501e-04 S  per = 0.014  per(accum) = 88.3
 T(sweep opt: renrm) = 7.941e-01 S  per = 11.7  per(accum) = 100
 T(sweep opt: save ) = 2.650e-03 S  per = 0.0389  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.396e+00 S  T(sum) = 3.392e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 1.196e-03 S  per = 0.0353  per(accum) = 0.0353
 T(sweep opt: symbolic_formulae           ) = 1.554e-01 S  per = 4.58  per(accum) = 4.62
 T(sweep opt: hintermediate init          ) = 4.127e-03 S  per = 0.122  per(accum) = 4.74
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.321e-02 S  per = 1.57  per(accum) = 6.31
 T(sweep opt: hmmtasks init               ) = 1.034e-01 S  per = 3.05  per(accum) = 9.35
 T(sweep opt: initial guess for dvdson    ) = 4.791e-05 S  per = 0.00141  per(accum) = 9.35
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.527e+00 S  per = 74.5  per(accum) = 83.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 6.874e-02 S  per = 2.03  per(accum) = 85.9
 T(sweep opt: dvdson [nccl]               ) = 2.958e-04 S  per = 0.00872  per(accum) = 85.9
 T(sweep opt: dvdson [mpi]                ) = 7.365e-06 S  per = 0.000217  per(accum) = 85.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 4.788e-01 S  per = 14.1  per(accum) = 100
Detailed decomposition of T(renrm) = 7.941e-01 S  T(sum) = 7.941e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.798e-04 S  per = 0.123  per(accum) = 0.123
 T(sweep opt: qops init                    ) = 2.175e-02 S  per = 2.74  per(accum) = 2.86
 T(sweep opt: symbolic_formulae_renorm     ) = 1.328e-01 S  per = 16.7  per(accum) = 19.6
 T(sweep opt: allocate qops on gpu         ) = 6.150e-04 S  per = 0.0774  per(accum) = 19.7
 T(sweep opt: site memcpy cpu2gpu          ) = 1.626e-02 S  per = 2.05  per(accum) = 21.7
 T(sweep opt: rintermediate init           ) = 2.325e-02 S  per = 2.93  per(accum) = 24.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.726e-02 S  per = 5.95  per(accum) = 30.6
 T(sweep opt: rmmtasks init                ) = 1.020e-01 S  per = 12.8  per(accum) = 43.4
 T(sweep opt: qops memset on cpu           ) = 4.780e-07 S  per = 6.02e-05  per(accum) = 43.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.017e-01 S  per = 50.6  per(accum) = 94
 T(sweep opt: deallocate cpu and gpu memory) = 1.003e-03 S  per = 0.126  per(accum) = 94.1
 T(sweep opt: construct opS [ifdists=true] ) = 4.230e-07 S  per = 5.33e-05  per(accum) = 94.1
 T(sweep opt: reduction of opS & opH [nccl]) = 4.100e-07 S  per = 5.16e-05  per(accum) = 94.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.176e-03 S  per = 0.274  per(accum) = 94.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.961e-04 S  per = 0.0247  per(accum) = 94.4
 T(sweep opt: qops_pool join and erase     ) = 1.580e-02 S  per = 1.99  per(accum) = 96.4
 T(sweep opt: conversion from opAB to opPQ ) = 2.838e-02 S  per = 3.57  per(accum) = 100
##### global opt: 6.805e+00 S #####
 T(global opt: fetch) = 1.358e-01 S  per = 1.99  per(accum) = 1.99
 T(global opt: hdiag) = 2.366e+00 S  per = 34.8  per(accum) = 36.8
 T(global opt: dvdsn) = 3.396e+00 S  per = 49.9  per(accum) = 86.7
 T(global opt: decim) = 1.106e-01 S  per = 1.62  per(accum) = 88.3
 T(global opt: guess) = 9.501e-04 S  per = 0.014  per(accum) = 88.3
 T(global opt: renrm) = 7.941e-01 S  per = 11.7  per(accum) = 100
 T(global opt: save ) = 2.650e-03 S  per = 0.0389  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.396e+00 S  T(sum) = 3.392e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 1.196e-03 S  per = 0.0353  per(accum) = 0.0353
 T(global opt: symbolic_formulae           ) = 1.554e-01 S  per = 4.58  per(accum) = 4.62
 T(global opt: hintermediate init          ) = 4.127e-03 S  per = 0.122  per(accum) = 4.74
 T(global opt: preprocess_hformulae_Hxlist ) = 5.321e-02 S  per = 1.57  per(accum) = 6.31
 T(global opt: hmmtasks init               ) = 1.034e-01 S  per = 3.05  per(accum) = 9.35
 T(global opt: initial guess for dvdson    ) = 4.791e-05 S  per = 0.00141  per(accum) = 9.35
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.527e+00 S  per = 74.5  per(accum) = 83.9
 T(global opt: dvdson [cpu-gpu]            ) = 6.874e-02 S  per = 2.03  per(accum) = 85.9
 T(global opt: dvdson [nccl]               ) = 2.958e-04 S  per = 0.00872  per(accum) = 85.9
 T(global opt: dvdson [mpi]                ) = 7.365e-06 S  per = 0.000217  per(accum) = 85.9
 T(global opt: dvdson [rest part(linalg)]  ) = 4.788e-01 S  per = 14.1  per(accum) = 100
Detailed decomposition of T(renrm) = 7.941e-01 S  T(sum) = 7.941e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.798e-04 S  per = 0.123  per(accum) = 0.123
 T(global opt: qops init                    ) = 2.175e-02 S  per = 2.74  per(accum) = 2.86
 T(global opt: symbolic_formulae_renorm     ) = 1.328e-01 S  per = 16.7  per(accum) = 19.6
 T(global opt: allocate qops on gpu         ) = 6.150e-04 S  per = 0.0774  per(accum) = 19.7
 T(global opt: site memcpy cpu2gpu          ) = 1.626e-02 S  per = 2.05  per(accum) = 21.7
 T(global opt: rintermediate init           ) = 2.325e-02 S  per = 2.93  per(accum) = 24.6
 T(global opt: preprocess_formulae_Rlist2   ) = 4.726e-02 S  per = 5.95  per(accum) = 30.6
 T(global opt: rmmtasks init                ) = 1.020e-01 S  per = 12.8  per(accum) = 43.4
 T(global opt: qops memset on cpu           ) = 4.780e-07 S  per = 6.02e-05  per(accum) = 43.4
 T(global opt: preprocess_renorm_batchGPU   ) = 4.017e-01 S  per = 50.6  per(accum) = 94
 T(global opt: deallocate cpu and gpu memory) = 1.003e-03 S  per = 0.126  per(accum) = 94.1
 T(global opt: construct opS [ifdists=true] ) = 4.230e-07 S  per = 5.33e-05  per(accum) = 94.1
 T(global opt: reduction of opS & opH [nccl]) = 4.100e-07 S  per = 5.16e-05  per(accum) = 94.1
 T(global opt: qops memcpy gpu2cpu          ) = 2.176e-03 S  per = 0.274  per(accum) = 94.4
 T(global opt: reduction of opS & opH [mpi] ) = 1.961e-04 S  per = 0.0247  per(accum) = 94.4
 T(global opt: qops_pool join and erase     ) = 1.580e-02 S  per = 1.99  per(accum) = 96.4
 T(global opt: conversion from opAB to opPQ ) = 2.838e-02 S  per = 3.57  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.442e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=11/seqsize=34 dots=1 dbond=(12,0)-(13,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=24:1.831e-04MB:1.788e-07GB
total mem of comb=788:6.012e-03MB:5.871e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=12,7,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc= 8
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=7,7 size(op)=17:1.297e-04MB size(tot)=1825:1.392e-02MB:1.360e-05GB
        per(mem): H:0.932 C:6.58 S:4.38 P:0 Q:88.1 
 rqops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=12:9.16e-05MB size(tot)=1040:0.00793MB:7.75e-06GB
        per(mem): H:1.15 C:5.38 S:10 A:0 B:83.5 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=5201:0.0397MB:3.88e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.008e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(12,0) fdel=./scratch/sweep/rop(13,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.225e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(7,6,4) nnz=24:1.831e-04MB
qtensor3: wf3 own=1 _data=0x3c5de9c0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=7
 (18,2):3 (17,3):2 (18,4):2
 qbond: qcol nsym=3 dimAll=6
 (11,-3):2 (10,-2):2 (10,-4):2
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=24:1.831e-04MB
### DIAG TIMING: total=2.920e-01 t1=2.651e-05, t2=2.176e-03, t3=2.467e-03, t4=2.874e-01, t5=5.164e-06, t6=1.318e-05, t7=4.272e-06
duration_diagGPU:2.921e-01
duration_diagreduce:8.600e-08
duration_diagtransform:4.690e-07
----- TIMING FOR symbolic_formulae_onedot with size=1053 : 1.893e-02 S -----
rank=0 GPUmem(GB): used=3.875e-05 (oper)=3.875e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1053
 no. of hintermediate operators=518
 no. of coefficients=6216:4.742e-02MB:4.631e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.382e-04 S -----
rank=0 GPUmem(GB): used=8.506e-05 (oper,hinter)=3.875e-05,4.631e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.382e-03 S size(H_formulae)=1053 size(Hxlst2)=5 T(Hmu/Hxlist)=2.710e-03,2.671e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.691e-03 S size(H_formulae)=1053 size(Hxlst)=1986 -----
rank=0 GPUmem(GB): used=8.506e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=3.576e-07 batch[need]=2.811e-04 blksize=6 blksize0=6 batchsize=1986
rank=0 GPUmem(GB): used=3.666e-04 (oper,hinter,dvdson,batch)=3.875e-05,4.631e-05,3.576e-07,2.811e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=24 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.330e-03,1.025e-02,3.018e-02,1.263e-02,5.540e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=2.324e-03 speed=1.539e-04GB/S T(nccl)=5.616e-06 speed=6.368e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=50 t=1.0e-02 per=1.9e+01 cost=6.0e+04 flops=5.9e+06
 sigma[gemm] counter=50 i=0 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=1 t=1.0e-06 per=1.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=2 t=7.6e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=50 i=3 t=7.6e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=50 i=4 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=50 i=5 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=50 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=50 t=1.3e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=5.0e-01 t_gemm=1.5e+00 t_reduction=6.0e-01 tot=2.6e+00 -----
 sigma_tot[inter] counter=50 t=5.0e-01 per=2.0e+01 cost=1.9e+06 flops=3.7e+06
 sigma_tot[gemm] counter=50 i=0 t=1.0e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=1 t=8.7e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=2 t=3.7e-01 per=1.4e+01 cost=9.1e+05 flops=2.5e+06
 sigma_tot[gemm] counter=50 i=3 t=3.7e-01 per=1.4e+01 cost=9.2e+05 flops=2.5e+06
 sigma_tot[gemm] counter=50 i=4 t=3.7e-01 per=1.4e+01 cost=9.2e+05 flops=2.5e+06
 sigma_tot[gemm] counter=50 i=5 t=3.6e-01 per=1.4e+01 cost=9.2e+05 flops=2.5e+06
 sigma_tot[gemm] counter=50 total t=1.5e+00 per=5.7e+01 cost=3.7e+06 flops=2.5e+06
 sigma_tot[red] counter=50 t=6.0e-01 per=2.3e+01 cost=9.5e+05 flops=1.6e+06
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.1e-06,4.4e-06,2.0e-06,8.6e-07,1.7e-07
settings: ndim=24 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.271896441600 -1.116e+03  6.710e-02    1     1  5.552e-02 5.552e-02 5.549e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.090e-04,1.509e-03,1.418e-02,1.258e-02,2.888e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=6.037e-04 speed=5.924e-04GB/S T(nccl)=5.284e-06 speed=6.768e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-03 t_gemm=1.4e-02 t_reduction=1.3e-02 tot=2.8e-02 -----
 sigma[inter] counter=51 t=1.5e-03 per=5.3e+00 cost=6.0e+04 flops=4.0e+07
 sigma[gemm] counter=51 i=0 t=1.6e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=1 t=1.4e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=2 t=1.1e-03 per=3.9e+00 cost=1.8e+04 flops=1.6e+07
 sigma[gemm] counter=51 i=3 t=1.3e-04 per=4.5e-01 cost=1.8e+04 flops=1.4e+08
 sigma[gemm] counter=51 i=4 t=5.4e-03 per=1.9e+01 cost=1.5e+04 flops=2.8e+06
 sigma[gemm] counter=51 i=5 t=7.5e-03 per=2.7e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=51 total t=1.4e-02 per=5.0e+01 cost=6.6e+04 flops=4.7e+06
 sigma[red] counter=51 t=1.3e-02 per=4.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=5.0e-01 t_gemm=1.5e+00 t_reduction=6.2e-01 tot=2.6e+00 -----
 sigma_tot[inter] counter=51 t=5.0e-01 per=1.9e+01 cost=1.9e+06 flops=3.8e+06
 sigma_tot[gemm] counter=51 i=0 t=1.1e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=1 t=8.9e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=2 t=3.7e-01 per=1.4e+01 cost=9.3e+05 flops=2.5e+06
 sigma_tot[gemm] counter=51 i=3 t=3.7e-01 per=1.4e+01 cost=9.4e+05 flops=2.6e+06
 sigma_tot[gemm] counter=51 i=4 t=3.7e-01 per=1.4e+01 cost=9.4e+05 flops=2.5e+06
 sigma_tot[gemm] counter=51 i=5 t=3.7e-01 per=1.4e+01 cost=9.4e+05 flops=2.5e+06
 sigma_tot[gemm] counter=51 total t=1.5e+00 per=5.7e+01 cost=3.7e+06 flops=2.5e+06
 sigma_tot[red] counter=51 t=6.2e-01 per=2.4e+01 cost=9.7e+05 flops=1.6e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.3e-05,3.3e-06,1.0e-06,1.7e-07
    2   0 -    -116.290602522307 -1.871e-02  1.627e-02    2     2  9.397e-02 4.699e-02 4.223e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.332e-03,9.909e-03,2.974e-02,1.238e-02,5.337e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=1.327e-03 speed=2.695e-04GB/S T(nccl)=4.653e-06 speed=7.686e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=52 t=9.9e-03 per=1.9e+01 cost=6.0e+04 flops=6.1e+06
 sigma[gemm] counter=52 i=0 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=1 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=52 i=3 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=52 i=4 t=7.4e-03 per=1.4e+01 cost=1.5e+04 flops=2.1e+06
 sigma[gemm] counter=52 i=5 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=52 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=52 t=1.2e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=5.1e-01 t_gemm=1.5e+00 t_reduction=6.3e-01 tot=2.7e+00 -----
 sigma_tot[inter] counter=52 t=5.1e-01 per=1.9e+01 cost=2.0e+06 flops=3.9e+06
 sigma_tot[gemm] counter=52 i=0 t=1.1e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=1 t=9.0e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=2 t=3.8e-01 per=1.4e+01 cost=9.5e+05 flops=2.5e+06
 sigma_tot[gemm] counter=52 i=3 t=3.8e-01 per=1.4e+01 cost=9.6e+05 flops=2.6e+06
 sigma_tot[gemm] counter=52 i=4 t=3.8e-01 per=1.4e+01 cost=9.5e+05 flops=2.5e+06
 sigma_tot[gemm] counter=52 i=5 t=3.8e-01 per=1.4e+01 cost=9.5e+05 flops=2.5e+06
 sigma_tot[gemm] counter=52 total t=1.5e+00 per=5.7e+01 cost=3.8e+06 flops=2.5e+06
 sigma_tot[red] counter=52 t=6.3e-01 per=2.4e+01 cost=9.9e+05 flops=1.6e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.6e-05,2.7e-06,1.1e-06,1.8e-07
    3   0 -    -116.291783348487 -1.181e-03  5.636e-03    3     3  1.569e-01 5.229e-02 4.597e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.156e-04,9.828e-03,2.997e-02,1.238e-02,5.280e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=6.104e-04 speed=5.859e-04GB/S T(nccl)=5.215e-06 speed=6.858e-02GB/S
----- TIMING FOR sigma : t_inter=9.8e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=53 t=9.8e-03 per=1.9e+01 cost=6.0e+04 flops=6.2e+06
 sigma[gemm] counter=53 i=0 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=53 i=3 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=53 i=4 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=53 i=5 t=7.6e-03 per=1.5e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=53 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=53 t=1.2e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=5.2e-01 t_gemm=1.5e+00 t_reduction=6.4e-01 tot=2.7e+00 -----
 sigma_tot[inter] counter=53 t=5.2e-01 per=1.9e+01 cost=2.1e+06 flops=3.9e+06
 sigma_tot[gemm] counter=53 i=0 t=1.1e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=1 t=9.2e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=2 t=3.8e-01 per=1.4e+01 cost=9.7e+05 flops=2.5e+06
 sigma_tot[gemm] counter=53 i=3 t=3.8e-01 per=1.4e+01 cost=9.8e+05 flops=2.5e+06
 sigma_tot[gemm] counter=53 i=4 t=3.9e-01 per=1.4e+01 cost=9.7e+05 flops=2.5e+06
 sigma_tot[gemm] counter=53 i=5 t=3.9e-01 per=1.4e+01 cost=9.7e+05 flops=2.5e+06
 sigma_tot[gemm] counter=53 total t=1.5e+00 per=5.7e+01 cost=3.9e+06 flops=2.5e+06
 sigma_tot[red] counter=53 t=6.4e-01 per=2.4e+01 cost=1.0e+06 flops=1.6e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.3e-05,2.8e-06,1.0e-06,1.7e-07
    4   0 -    -116.291876307608 -9.296e-05  2.067e-03    3     4  2.199e-01 5.497e-02 4.770e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.364e-03,1.005e-02,2.957e-02,1.239e-02,5.338e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=1.359e-03 speed=2.631e-04GB/S T(nccl)=4.709e-06 speed=7.595e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=54 t=1.0e-02 per=1.9e+01 cost=6.0e+04 flops=6.0e+06
 sigma[gemm] counter=54 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=54 i=3 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=54 i=4 t=7.4e-03 per=1.4e+01 cost=1.5e+04 flops=2.1e+06
 sigma[gemm] counter=54 i=5 t=7.4e-03 per=1.4e+01 cost=1.5e+04 flops=2.1e+06
 sigma[gemm] counter=54 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=54 t=1.2e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=5.3e-01 t_gemm=1.6e+00 t_reduction=6.5e-01 tot=2.8e+00 -----
 sigma_tot[inter] counter=54 t=5.3e-01 per=1.9e+01 cost=2.1e+06 flops=4.0e+06
 sigma_tot[gemm] counter=54 i=0 t=1.1e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=1 t=9.3e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=2 t=3.9e-01 per=1.4e+01 cost=9.8e+05 flops=2.5e+06
 sigma_tot[gemm] counter=54 i=3 t=3.9e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=54 i=4 t=3.9e-01 per=1.4e+01 cost=9.8e+05 flops=2.5e+06
 sigma_tot[gemm] counter=54 i=5 t=3.9e-01 per=1.4e+01 cost=9.8e+05 flops=2.5e+06
 sigma_tot[gemm] counter=54 total t=1.6e+00 per=5.7e+01 cost=3.9e+06 flops=2.5e+06
 sigma_tot[red] counter=54 t=6.5e-01 per=2.4e+01 cost=1.0e+06 flops=1.6e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.6e-05,2.8e-06,9.3e-07,2.0e-07
    5   0 -    -116.291888031947 -1.172e-05  3.789e-04    3     5  2.849e-01 5.698e-02 4.886e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.042e-03,9.952e-03,3.000e-02,1.257e-02,5.457e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=2.036e-03 speed=1.757e-04GB/S T(nccl)=5.998e-06 speed=5.962e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=55 t=1.0e-02 per=1.9e+01 cost=6.0e+04 flops=6.1e+06
 sigma[gemm] counter=55 i=0 t=3.5e-06 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=1 t=2.9e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=2 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=55 i=3 t=7.6e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=55 i=4 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=55 i=5 t=7.4e-03 per=1.4e+01 cost=1.5e+04 flops=2.1e+06
 sigma[gemm] counter=55 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=55 t=1.3e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=5.4e-01 t_gemm=1.6e+00 t_reduction=6.7e-01 tot=2.8e+00 -----
 sigma_tot[inter] counter=55 t=5.4e-01 per=1.9e+01 cost=2.2e+06 flops=4.0e+06
 sigma_tot[gemm] counter=55 i=0 t=1.1e-04 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=1 t=9.6e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=2 t=4.0e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=55 i=3 t=4.0e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=55 i=4 t=4.0e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=55 i=5 t=4.0e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=55 total t=1.6e+00 per=5.7e+01 cost=4.0e+06 flops=2.5e+06
 sigma_tot[red] counter=55 t=6.7e-01 per=2.4e+01 cost=1.0e+06 flops=1.6e+06
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=6.3e-06,2.2e-05,1.7e-05,1.7e-06,3.4e-07
    6   0 +    -116.291888550589 -5.186e-07  8.648e-05    3     6  3.505e-01 5.841e-02 4.984e-02
TIMING FOR Davidson : 3.505e-01  T(cal/comm/rest)=2.990e-01,7.120e-07,5.148e-02
decomposed t_rest=5.148e-02
 T(sub)    =1.481e-04 per=2.877e-01
 T(precond)=5.115e-02 per=9.936e+01
 T(ortho)  =1.851e-05 per=3.595e-02
 T(xcopy)  =8.810e-07 per=1.711e-03
 T(xnrm2)  =3.057e-06 per=5.938e-03
 T(other)  =1.596e-04 per=3.100e-01
optimized energies: isweep=0 ibond=11 dots=1 e[0]=-116.291888550589 nmvp=6
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.205e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond11.txt
 qbond: qsuper nsym=8 dimAll=28
 (18,2):5 (20,2):3 (19,3):7 (19,1):3 (17,3):2 (18,4):4 (20,4):2 (19,5):2
timing for divide=1.7e-05
timing for compute=1.3e-02
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(nkr): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.7e-05,1.3e-02,0.0e+00,7.5e-06,1.5e-05 -----
decimation summary: 28->6 dwt=+1.110e-16 SvN=3.112e-01
 qbond: qkept nsym=3 dimAll=6
 (20,2):2 (19,3):2 (20,4):2
----- TIMING for decimation_row(nkr): 1.329e-02 S T(decim/select/formRot)=1.305e-02,2.189e-04,1.923e-05 -----
----- TIMING FOR onedot_decimation: 1.339e-02 S T(wf/decim)=9.494e-05,1.330e-02 -----
ctns::oper_renorm coord=(12,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=12:9.155e-05MB size(tot)=1040:7.935e-03MB:7.749e-06GB
        per(mem): H:1.15 C:10 S:5.38 P:0 Q:83.5 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.238e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=237 : 2.041e-02 S -----
rank=0 GPUmem(GB): used=8.506e-05 (oper)=3.875e-05
rank=0 GPUmem(GB): used=8.524e-05 (oper,site)=3.875e-05,1.788e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=518
 no. of coefficients=6216:4.742e-02MB:4.631e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.508e-03 S -----
rank=0 GPUmem(GB): used=1.316e-04 (oper,site,rinter)=3.875e-05,1.788e-07,4.631e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 4.882e-03 S size(rtasks)=237 size(Rlst2)=9 T(Rmu/Rlist)=3.116e-03,1.766e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.099e-03 S size(rtasks)=237 size(Rlst)=1033 -----
rank=0 GPUmem(GB): used=1.316e-04 avail=6.176e+00 total=6.176e+00 batch[need]=1.462e-04 blksize=6 blksize0=6 batchsize=1033
rank=0 GPUmem(GB): used=2.778e-04 (oper,site,rinter,batch)=3.875e-05,1.788e-07,4.631e-05,1.462e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.524e-03,2.242e-02,1.007e-02
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=12 t=6.5e-03 per=1.7e+01 cost=3.0e+04 flops=4.6e+06
 renorm[gemm] counter=12 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=1 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=2 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=3 t=1.0e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=4 t=7.5e-03 per=1.9e+01 cost=4.4e+03 flops=5.8e+05
 renorm[gemm] counter=12 i=5 t=7.5e-03 per=1.9e+01 cost=1.2e+04 flops=1.6e+06
 renorm[gemm] counter=12 i=6 t=7.5e-03 per=1.9e+01 cost=1.9e+04 flops=2.6e+06
 renorm[gemm] counter=12 total t=2.2e-02 per=5.7e+01 cost=3.6e+04 flops=1.6e+06
 renorm[red] counter=12 t=1.0e-02 per=2.6e+01 cost=8.3e+03 flops=8.2e+05
----- TIMING FOR renorm_tot : t_inter=6.8e-02 t_gemm=2.5e-01 t_reduction=1.2e-01 tot=4.4e-01 -----
 renorm_tot[inter] counter=12 t=6.8e-02 per=1.5e+01 cost=4.9e+05 flops=7.2e+06
 renorm_tot[gemm] counter=12 i=0 t=1.6e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=1 t=1.3e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=2 t=1.3e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=3 t=1.3e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=4 t=8.5e-02 per=1.9e+01 cost=2.1e+05 flops=2.5e+06
 renorm_tot[gemm] counter=12 i=5 t=8.4e-02 per=1.9e+01 cost=2.7e+05 flops=3.2e+06
 renorm_tot[gemm] counter=12 i=6 t=8.4e-02 per=1.9e+01 cost=1.4e+06 flops=1.7e+07
 renorm_tot[gemm] counter=12 total t=2.5e-01 per=5.8e+01 cost=1.9e+06 flops=7.4e+06
 renorm_tot[red] counter=12 t=1.2e-01 per=2.7e+01 cost=6.4e+05 flops=5.4e+06
qops.to_cpu: size(tot)=1040:7.9e-03MB:7.7e-06GB T(to_cpu)=2.4e-04S speed=3.3e-02GB/S
check ||H-H.dagger||=3.556e-15 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.0779 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=8.800e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.251e-03 change=-2.034e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.251e-03 change=-6.258e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 7.840e-01 S #####
 T(local opt: fetch) = 1.150e-02 S  per = 1.47  per(accum) = 1.47
 T(local opt: hdiag) = 2.921e-01 S  per = 37.3  per(accum) = 38.7
 T(local opt: dvdsn) = 3.870e-01 S  per = 49.4  per(accum) = 88.1
 T(local opt: decim) = 1.340e-02 S  per = 1.71  per(accum) = 89.8
 T(local opt: guess) = 7.512e-05 S  per = 0.00958  per(accum) = 89.8
 T(local opt: renrm) = 7.964e-02 S  per = 10.2  per(accum) = 100
 T(local opt: save ) = 2.690e-04 S  per = 0.0343  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.870e-01 S  T(sum) = 3.867e-01 S  per = 9.991e+01
 T(local opt: preprocess                  ) = 1.016e-04 S  per = 0.0263  per(accum) = 0.0263
 T(local opt: symbolic_formulae           ) = 1.895e-02 S  per =  4.9  per(accum) = 4.93
 T(local opt: hintermediate init          ) = 4.554e-04 S  per = 0.118  per(accum) = 5.04
 T(local opt: preprocess_hformulae_Hxlist ) = 5.751e-03 S  per = 1.49  per(accum) = 6.53
 T(local opt: hmmtasks init               ) = 1.093e-02 S  per = 2.83  per(accum) = 9.36
 T(local opt: initial guess for dvdson    ) = 2.629e-06 S  per = 0.00068  per(accum) = 9.36
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.907e-01 S  per = 75.2  per(accum) = 84.5
 T(local opt: dvdson [cpu-gpu]            ) = 8.260e-03 S  per = 2.14  per(accum) = 86.7
 T(local opt: dvdson [nccl]               ) = 3.147e-05 S  per = 0.00814  per(accum) = 86.7
 T(local opt: dvdson [mpi]                ) = 7.120e-07 S  per = 0.000184  per(accum) = 86.7
 T(local opt: dvdson [rest part(linalg)]  ) = 5.148e-02 S  per = 13.3  per(accum) = 100
Detailed decomposition of T(renrm) = 7.964e-02 S  T(sum) = 7.964e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.983e-05 S  per = 0.0877  per(accum) = 0.0877
 T(local opt: qops init                    ) = 1.838e-03 S  per = 2.31  per(accum) = 2.4
 T(local opt: symbolic_formulae_renorm     ) = 2.042e-02 S  per = 25.6  per(accum) = 28
 T(local opt: allocate qops on gpu         ) = 5.407e-05 S  per = 0.0679  per(accum) = 28.1
 T(local opt: site memcpy cpu2gpu          ) = 1.704e-03 S  per = 2.14  per(accum) = 30.2
 T(local opt: rintermediate init           ) = 2.522e-03 S  per = 3.17  per(accum) = 33.4
 T(local opt: preprocess_formulae_Rlist2   ) = 5.138e-03 S  per = 6.45  per(accum) = 39.9
 T(local opt: rmmtasks init                ) = 6.829e-03 S  per = 8.58  per(accum) = 48.4
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 4.14e-05  per(accum) = 48.4
 T(local opt: preprocess_renorm_batchGPU   ) = 3.910e-02 S  per = 49.1  per(accum) = 97.5
 T(local opt: deallocate cpu and gpu memory) = 5.319e-05 S  per = 0.0668  per(accum) = 97.6
 T(local opt: construct opS [ifdists=true] ) = 3.200e-08 S  per = 4.02e-05  per(accum) = 97.6
 T(local opt: reduction of opS & opH [nccl]) = 4.000e-08 S  per = 5.02e-05  per(accum) = 97.6
 T(local opt: qops memcpy gpu2cpu          ) = 2.452e-04 S  per = 0.308  per(accum) = 97.9
 T(local opt: reduction of opS & opH [mpi] ) = 1.616e-05 S  per = 0.0203  per(accum) = 97.9
 T(local opt: qops_pool join and erase     ) = 1.647e-03 S  per = 2.07  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.409e-06 S  per = 0.00177  per(accum) = 100
##### sweep opt: 7.589e+00 S #####
 T(sweep opt: fetch) = 1.473e-01 S  per = 1.94  per(accum) = 1.94
 T(sweep opt: hdiag) = 2.658e+00 S  per =   35  per(accum) = 37
 T(sweep opt: dvdsn) = 3.783e+00 S  per = 49.8  per(accum) = 86.8
 T(sweep opt: decim) = 1.240e-01 S  per = 1.63  per(accum) = 88.4
 T(sweep opt: guess) = 1.025e-03 S  per = 0.0135  per(accum) = 88.4
 T(sweep opt: renrm) = 8.737e-01 S  per = 11.5  per(accum) = 100
 T(sweep opt: save ) = 2.919e-03 S  per = 0.0385  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.783e+00 S  T(sum) = 3.779e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 1.298e-03 S  per = 0.0343  per(accum) = 0.0343
 T(sweep opt: symbolic_formulae           ) = 1.743e-01 S  per = 4.61  per(accum) = 4.65
 T(sweep opt: hintermediate init          ) = 4.582e-03 S  per = 0.121  per(accum) = 4.77
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.896e-02 S  per = 1.56  per(accum) = 6.33
 T(sweep opt: hmmtasks init               ) = 1.143e-01 S  per = 3.02  per(accum) = 9.35
 T(sweep opt: initial guess for dvdson    ) = 5.054e-05 S  per = 0.00134  per(accum) = 9.35
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.818e+00 S  per = 74.6  per(accum) = 83.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 7.700e-02 S  per = 2.04  per(accum) = 86
 T(sweep opt: dvdson [nccl]               ) = 3.273e-04 S  per = 0.00866  per(accum) = 86
 T(sweep opt: dvdson [mpi]                ) = 8.077e-06 S  per = 0.000214  per(accum) = 86
 T(sweep opt: dvdson [rest part(linalg)]  ) = 5.303e-01 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 8.737e-01 S  T(sum) = 8.737e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.050e-03 S  per = 0.12  per(accum) = 0.12
 T(sweep opt: qops init                    ) = 2.359e-02 S  per =  2.7  per(accum) = 2.82
 T(sweep opt: symbolic_formulae_renorm     ) = 1.532e-01 S  per = 17.5  per(accum) = 20.4
 T(sweep opt: allocate qops on gpu         ) = 6.691e-04 S  per = 0.0766  per(accum) = 20.4
 T(sweep opt: site memcpy cpu2gpu          ) = 1.796e-02 S  per = 2.06  per(accum) = 22.5
 T(sweep opt: rintermediate init           ) = 2.577e-02 S  per = 2.95  per(accum) = 25.4
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.239e-02 S  per =    6  per(accum) = 31.4
 T(sweep opt: rmmtasks init                ) = 1.088e-01 S  per = 12.5  per(accum) = 43.9
 T(sweep opt: qops memset on cpu           ) = 5.110e-07 S  per = 5.85e-05  per(accum) = 43.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.408e-01 S  per = 50.4  per(accum) = 94.3
 T(sweep opt: deallocate cpu and gpu memory) = 1.056e-03 S  per = 0.121  per(accum) = 94.5
 T(sweep opt: construct opS [ifdists=true] ) = 4.550e-07 S  per = 5.21e-05  per(accum) = 94.5
 T(sweep opt: reduction of opS & opH [nccl]) = 4.500e-07 S  per = 5.15e-05  per(accum) = 94.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.421e-03 S  per = 0.277  per(accum) = 94.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.123e-04 S  per = 0.0243  per(accum) = 94.8
 T(sweep opt: qops_pool join and erase     ) = 1.745e-02 S  per =    2  per(accum) = 96.8
 T(sweep opt: conversion from opAB to opPQ ) = 2.838e-02 S  per = 3.25  per(accum) = 100
##### global opt: 7.589e+00 S #####
 T(global opt: fetch) = 1.473e-01 S  per = 1.94  per(accum) = 1.94
 T(global opt: hdiag) = 2.658e+00 S  per =   35  per(accum) = 37
 T(global opt: dvdsn) = 3.783e+00 S  per = 49.8  per(accum) = 86.8
 T(global opt: decim) = 1.240e-01 S  per = 1.63  per(accum) = 88.4
 T(global opt: guess) = 1.025e-03 S  per = 0.0135  per(accum) = 88.4
 T(global opt: renrm) = 8.737e-01 S  per = 11.5  per(accum) = 100
 T(global opt: save ) = 2.919e-03 S  per = 0.0385  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.783e+00 S  T(sum) = 3.779e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 1.298e-03 S  per = 0.0343  per(accum) = 0.0343
 T(global opt: symbolic_formulae           ) = 1.743e-01 S  per = 4.61  per(accum) = 4.65
 T(global opt: hintermediate init          ) = 4.582e-03 S  per = 0.121  per(accum) = 4.77
 T(global opt: preprocess_hformulae_Hxlist ) = 5.896e-02 S  per = 1.56  per(accum) = 6.33
 T(global opt: hmmtasks init               ) = 1.143e-01 S  per = 3.02  per(accum) = 9.35
 T(global opt: initial guess for dvdson    ) = 5.054e-05 S  per = 0.00134  per(accum) = 9.35
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.818e+00 S  per = 74.6  per(accum) = 83.9
 T(global opt: dvdson [cpu-gpu]            ) = 7.700e-02 S  per = 2.04  per(accum) = 86
 T(global opt: dvdson [nccl]               ) = 3.273e-04 S  per = 0.00866  per(accum) = 86
 T(global opt: dvdson [mpi]                ) = 8.077e-06 S  per = 0.000214  per(accum) = 86
 T(global opt: dvdson [rest part(linalg)]  ) = 5.303e-01 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 8.737e-01 S  T(sum) = 8.737e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.050e-03 S  per = 0.12  per(accum) = 0.12
 T(global opt: qops init                    ) = 2.359e-02 S  per =  2.7  per(accum) = 2.82
 T(global opt: symbolic_formulae_renorm     ) = 1.532e-01 S  per = 17.5  per(accum) = 20.4
 T(global opt: allocate qops on gpu         ) = 6.691e-04 S  per = 0.0766  per(accum) = 20.4
 T(global opt: site memcpy cpu2gpu          ) = 1.796e-02 S  per = 2.06  per(accum) = 22.5
 T(global opt: rintermediate init           ) = 2.577e-02 S  per = 2.95  per(accum) = 25.4
 T(global opt: preprocess_formulae_Rlist2   ) = 5.239e-02 S  per =    6  per(accum) = 31.4
 T(global opt: rmmtasks init                ) = 1.088e-01 S  per = 12.5  per(accum) = 43.9
 T(global opt: qops memset on cpu           ) = 5.110e-07 S  per = 5.85e-05  per(accum) = 43.9
 T(global opt: preprocess_renorm_batchGPU   ) = 4.408e-01 S  per = 50.4  per(accum) = 94.3
 T(global opt: deallocate cpu and gpu memory) = 1.056e-03 S  per = 0.121  per(accum) = 94.5
 T(global opt: construct opS [ifdists=true] ) = 4.550e-07 S  per = 5.21e-05  per(accum) = 94.5
 T(global opt: reduction of opS & opH [nccl]) = 4.500e-07 S  per = 5.15e-05  per(accum) = 94.5
 T(global opt: qops memcpy gpu2cpu          ) = 2.421e-03 S  per = 0.277  per(accum) = 94.7
 T(global opt: reduction of opS & opH [mpi] ) = 2.123e-04 S  per = 0.0243  per(accum) = 94.8
 T(global opt: qops_pool join and erase     ) = 1.745e-02 S  per =    2  per(accum) = 96.8
 T(global opt: conversion from opAB to opPQ ) = 2.838e-02 S  per = 3.25  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.199e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=12/seqsize=34 dots=1 dbond=(13,0)-(14,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=16:1.221e-04MB:1.192e-07GB
total mem of comb=780:5.951e-03MB:5.811e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=13,6,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc= 9
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=12:9.155e-05MB size(tot)=1040:7.935e-03MB:7.749e-06GB
        per(mem): H:1.15 C:10 S:5.38 P:0 Q:83.5 
 rqops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=374:0.00285MB:2.79e-06GB
        per(mem): H:1.6 C:6.42 S:15 A:0 B:77 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3750:0.0286MB:2.79e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.760e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(13,0) fdel=./scratch/sweep/rop(14,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.503e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,4,4) nnz=16:1.221e-04MB
qtensor3: wf3 own=1 _data=0x3c47f500
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (20,2):2 (19,3):2 (20,4):2
 qbond: qcol nsym=3 dimAll=4
 (9,-3):2 (8,-2):1 (8,-4):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=16:1.221e-04MB
### DIAG TIMING: total=1.767e-01 t1=2.322e-05, t2=2.218e-03, t3=2.505e-03, t4=1.719e-01, t5=4.684e-06, t6=1.375e-05, t7=3.495e-06
duration_diagGPU:1.767e-01
duration_diagreduce:6.500e-08
duration_diagtransform:4.240e-07
----- TIMING FOR symbolic_formulae_onedot with size=813 : 1.502e-02 S -----
rank=0 GPUmem(GB): used=2.794e-05 (oper)=2.794e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=813
 no. of hintermediate operators=390
 no. of coefficients=5070:3.868e-02MB:3.777e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.397e-04 S -----
rank=0 GPUmem(GB): used=6.571e-05 (oper,hinter)=2.794e-05,3.777e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.182e-03 S size(H_formulae)=813 size(Hxlst2)=5 T(Hmu/Hxlist)=2.067e-03,2.116e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.423e-03 S size(H_formulae)=813 size(Hxlst)=1552 -----
rank=0 GPUmem(GB): used=6.571e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.384e-07 batch[need]=1.503e-04 blksize=4 blksize0=4 batchsize=1552
rank=0 GPUmem(GB): used=2.163e-04 (oper,hinter,dvdson,batch)=2.794e-05,3.777e-05,2.384e-07,1.503e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=16 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.317e-04,9.924e-03,2.967e-02,1.229e-02,5.253e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=6.270e-04 speed=3.802e-04GB/S T(nccl)=4.682e-06 speed=5.092e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=56 t=9.9e-03 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=56 i=0 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=2 t=7.4e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=56 i=3 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=56 i=4 t=7.4e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=56 i=5 t=7.4e-03 per=1.4e+01 cost=7.1e+03 flops=9.5e+05
 sigma[gemm] counter=56 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.1e+06
 sigma[red] counter=56 t=1.2e-02 per=2.4e+01 cost=1.0e+04 flops=8.4e+05
----- TIMING FOR sigma_tot : t_inter=5.5e-01 t_gemm=1.6e+00 t_reduction=6.8e-01 tot=2.9e+00 -----
 sigma_tot[inter] counter=56 t=5.5e-01 per=1.9e+01 cost=2.2e+06 flops=4.0e+06
 sigma_tot[gemm] counter=56 i=0 t=1.2e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=1 t=9.7e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=2 t=4.1e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=56 i=3 t=4.1e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=56 i=4 t=4.1e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=56 i=5 t=4.1e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=56 total t=1.6e+00 per=5.7e+01 cost=4.0e+06 flops=2.5e+06
 sigma_tot[red] counter=56 t=6.8e-01 per=2.4e+01 cost=1.1e+06 flops=1.6e+06
T(sub)=9.2e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,3.9e-06,2.0e-06,6.8e-07,1.5e-07
settings: ndim=16 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.291888550589 -1.116e+03  5.401e-02    1     1  5.264e-02 5.264e-02 5.261e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.375e-04,1.000e-02,3.008e-02,1.239e-02,5.302e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=5.319e-04 speed=4.482e-04GB/S T(nccl)=5.612e-06 speed=4.248e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=57 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=57 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=2 t=7.6e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=57 i=3 t=7.6e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=57 i=4 t=7.5e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=57 i=5 t=7.4e-03 per=1.4e+01 cost=7.1e+03 flops=9.5e+05
 sigma[gemm] counter=57 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=57 t=1.2e-02 per=2.4e+01 cost=1.0e+04 flops=8.3e+05
----- TIMING FOR sigma_tot : t_inter=5.6e-01 t_gemm=1.7e+00 t_reduction=6.9e-01 tot=2.9e+00 -----
 sigma_tot[inter] counter=57 t=5.6e-01 per=1.9e+01 cost=2.3e+06 flops=4.0e+06
 sigma_tot[gemm] counter=57 i=0 t=1.2e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=1 t=9.8e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=2 t=4.1e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=57 i=3 t=4.1e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=57 i=4 t=4.2e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=57 i=5 t=4.1e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=57 total t=1.7e+00 per=5.7e+01 cost=4.1e+06 flops=2.5e+06
 sigma_tot[red] counter=57 t=6.9e-01 per=2.4e+01 cost=1.1e+06 flops=1.5e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.1e-05,3.4e-06,9.9e-07,2.0e-07
    2   0 -    -116.300315340199 -8.427e-03  1.529e-02    2     2  1.223e-01 6.114e-02 5.286e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.418e-04,1.446e-02,3.001e-02,1.244e-02,5.726e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=3.348e-04 speed=7.121e-04GB/S T(nccl)=7.031e-06 speed=3.391e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.7e-02 -----
 sigma[inter] counter=58 t=1.4e-02 per=2.5e+01 cost=4.0e+04 flops=2.8e+06
 sigma[gemm] counter=58 i=0 t=1.4e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=1 t=1.5e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=2 t=7.3e-03 per=1.3e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=58 i=3 t=7.5e-03 per=1.3e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=58 i=4 t=7.6e-03 per=1.3e+01 cost=7.6e+03 flops=9.9e+05
 sigma[gemm] counter=58 i=5 t=7.6e-03 per=1.3e+01 cost=7.1e+03 flops=9.4e+05
 sigma[gemm] counter=58 total t=3.0e-02 per=5.3e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=58 t=1.2e-02 per=2.2e+01 cost=1.0e+04 flops=8.3e+05
----- TIMING FOR sigma_tot : t_inter=5.8e-01 t_gemm=1.7e+00 t_reduction=7.0e-01 tot=3.0e+00 -----
 sigma_tot[inter] counter=58 t=5.8e-01 per=1.9e+01 cost=2.3e+06 flops=4.0e+06
 sigma_tot[gemm] counter=58 i=0 t=1.2e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=1 t=1.0e-04 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=2 t=4.2e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=58 i=3 t=4.2e-01 per=1.4e+01 cost=1.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=58 i=4 t=4.2e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=58 i=5 t=4.2e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=58 total t=1.7e+00 per=5.7e+01 cost=4.1e+06 flops=2.4e+06
 sigma_tot[red] counter=58 t=7.0e-01 per=2.4e+01 cost=1.1e+06 flops=1.5e+06
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,2.4e-05,1.3e-05,1.1e-06,1.8e-07
    3   0 -    -116.301344274588 -1.029e-03  3.268e-03    3     3  1.922e-01 6.407e-02 5.436e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.218e-03,1.003e-02,3.003e-02,1.261e-02,5.495e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=2.212e-03 speed=1.078e-04GB/S T(nccl)=5.774e-06 speed=4.129e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=59 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=59 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=2 t=7.6e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=59 i=3 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=59 i=4 t=7.5e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=59 i=5 t=7.5e-03 per=1.4e+01 cost=7.1e+03 flops=9.5e+05
 sigma[gemm] counter=59 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=59 t=1.3e-02 per=2.4e+01 cost=1.0e+04 flops=8.2e+05
----- TIMING FOR sigma_tot : t_inter=5.9e-01 t_gemm=1.7e+00 t_reduction=7.2e-01 tot=3.0e+00 -----
 sigma_tot[inter] counter=59 t=5.9e-01 per=1.9e+01 cost=2.3e+06 flops=4.0e+06
 sigma_tot[gemm] counter=59 i=0 t=1.2e-04 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=1 t=1.0e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=2 t=4.3e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=59 i=3 t=4.3e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=59 i=4 t=4.3e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=59 i=5 t=4.3e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=59 total t=1.7e+00 per=5.7e+01 cost=4.1e+06 flops=2.4e+06
 sigma_tot[red] counter=59 t=7.2e-01 per=2.4e+01 cost=1.1e+06 flops=1.5e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,2.9e-06,9.6e-07,1.8e-07
    4   0 -    -116.301381896987 -3.762e-05  9.727e-04    3     4  2.599e-01 6.498e-02 5.453e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.763e-04,9.979e-03,3.003e-02,1.251e-02,5.291e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=3.698e-04 speed=6.447e-04GB/S T(nccl)=6.429e-06 speed=3.708e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=60 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=60 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=2 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=60 i=3 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=60 i=4 t=7.5e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=60 i=5 t=7.5e-03 per=1.4e+01 cost=7.1e+03 flops=9.4e+05
 sigma[gemm] counter=60 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=60 t=1.3e-02 per=2.4e+01 cost=1.0e+04 flops=8.2e+05
----- TIMING FOR sigma_tot : t_inter=6.0e-01 t_gemm=1.7e+00 t_reduction=7.3e-01 tot=3.1e+00 -----
 sigma_tot[inter] counter=60 t=6.0e-01 per=1.9e+01 cost=2.4e+06 flops=4.0e+06
 sigma_tot[gemm] counter=60 i=0 t=1.2e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=1 t=1.0e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=2 t=4.4e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=60 i=3 t=4.4e-01 per=1.4e+01 cost=1.1e+06 flops=2.4e+06
 sigma_tot[gemm] counter=60 i=4 t=4.4e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=60 i=5 t=4.4e-01 per=1.4e+01 cost=1.0e+06 flops=2.4e+06
 sigma_tot[gemm] counter=60 total t=1.7e+00 per=5.7e+01 cost=4.2e+06 flops=2.4e+06
 sigma_tot[red] counter=60 t=7.3e-01 per=2.4e+01 cost=1.1e+06 flops=1.5e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,3.0e-06,1.0e-06,2.0e-07
    5   0 -    -116.301384728312 -2.831e-06  2.010e-04    3     5  3.254e-01 6.509e-02 5.423e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.036e-04,1.008e-02,3.005e-02,1.009e-02,5.078e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=4.973e-04 speed=4.794e-04GB/S T(nccl)=6.322e-06 speed=3.771e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=5.0e-02 -----
 sigma[inter] counter=61 t=1.0e-02 per=2.0e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=61 i=0 t=1.7e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=1 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=2 t=7.5e-03 per=1.5e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=61 i=3 t=7.5e-03 per=1.5e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=61 i=4 t=7.5e-03 per=1.5e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=61 i=5 t=7.5e-03 per=1.5e+01 cost=7.1e+03 flops=9.4e+05
 sigma[gemm] counter=61 total t=3.0e-02 per=6.0e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=61 t=1.0e-02 per=2.0e+01 cost=1.0e+04 flops=1.0e+06
----- TIMING FOR sigma_tot : t_inter=6.1e-01 t_gemm=1.8e+00 t_reduction=7.4e-01 tot=3.1e+00 -----
 sigma_tot[inter] counter=61 t=6.1e-01 per=1.9e+01 cost=2.4e+06 flops=4.0e+06
 sigma_tot[gemm] counter=61 i=0 t=1.2e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=1 t=1.0e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=2 t=4.4e-01 per=1.4e+01 cost=1.1e+06 flops=2.4e+06
 sigma_tot[gemm] counter=61 i=3 t=4.4e-01 per=1.4e+01 cost=1.1e+06 flops=2.4e+06
 sigma_tot[gemm] counter=61 i=4 t=4.5e-01 per=1.4e+01 cost=1.0e+06 flops=2.3e+06
 sigma_tot[gemm] counter=61 i=5 t=4.4e-01 per=1.4e+01 cost=1.0e+06 flops=2.3e+06
 sigma_tot[gemm] counter=61 total t=1.8e+00 per=5.7e+01 cost=4.2e+06 flops=2.4e+06
 sigma_tot[red] counter=61 t=7.4e-01 per=2.4e+01 cost=1.1e+06 flops=1.5e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,3.0e-06,1.0e-06,2.0e-07
    6   0 +    -116.301384902089 -1.738e-07  5.402e-05    3     6  3.886e-01 6.477e-02 5.367e-02
TIMING FOR Davidson : 3.886e-01  T(cal/comm/rest)=3.220e-01,8.980e-07,6.663e-02
decomposed t_rest=6.663e-02
 T(sub)    =1.401e-04 per=2.102e-01
 T(precond)=6.628e-02 per=9.948e+01
 T(ortho)  =5.397e-05 per=8.100e-02
 T(xcopy)  =7.980e-07 per=1.198e-03
 T(xnrm2)  =2.158e-05 per=3.238e-02
 T(other)  =1.299e-04 per=1.950e-01
optimized energies: isweep=0 ibond=12 dots=1 e[0]=-116.301384902089 nmvp=6
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.432e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond12.txt
 qbond: qsuper nsym=8 dimAll=24
 (20,2):4 (22,2):2 (21,3):6 (21,1):2 (19,3):2 (20,4):4 (22,4):2 (21,5):2
timing for divide=1.1e-05
timing for compute=1.3e-02
timing for collect=3.6e-05
----- TMING FOR decimation_genbasis(nkr): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.1e-05,1.3e-02,0.0e+00,5.2e-06,3.6e-05 -----
decimation summary: 24->4 dwt=+0.000e+00 SvN=1.637e-01
 qbond: qkept nsym=3 dimAll=4
 (21,3):2 (22,2):1 (22,4):1
----- TIMING for decimation_row(nkr): 1.375e-02 S T(decim/select/formRot)=1.346e-02,2.656e-04,2.234e-05 -----
----- TIMING FOR onedot_decimation: 1.383e-02 S T(wf/decim)=6.824e-05,1.376e-02 -----
ctns::oper_renorm coord=(13,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=374:2.853e-03MB:2.787e-06GB
        per(mem): H:1.6 C:15 S:6.42 P:0 Q:77 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.751e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 1.630e-02 S -----
rank=0 GPUmem(GB): used=6.571e-05 (oper)=2.794e-05
rank=0 GPUmem(GB): used=6.583e-05 (oper,site)=2.794e-05,1.192e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=390
 no. of coefficients=5070:3.868e-02MB:3.777e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.500e-03 S -----
rank=0 GPUmem(GB): used=1.036e-04 (oper,site,rinter)=2.794e-05,1.192e-07,3.777e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.655e-03 S size(rtasks)=185 size(Rlst2)=9 T(Rmu/Rlist)=2.294e-03,1.362e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.850e-03 S size(rtasks)=185 size(Rlst)=818 -----
rank=0 GPUmem(GB): used=1.036e-04 avail=6.176e+00 total=6.176e+00 batch[need]=7.923e-05 blksize=4 blksize0=4 batchsize=818
rank=0 GPUmem(GB): used=1.828e-04 (oper,site,rinter,batch)=2.794e-05,1.192e-07,3.777e-05,7.923e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.336e-03,2.238e-02,9.888e-03
----- TIMING FOR renorm : t_inter=5.3e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.8e-02 -----
 renorm[inter] counter=13 t=5.3e-03 per=1.4e+01 cost=2.0e+04 flops=3.7e+06
 renorm[gemm] counter=13 i=0 t=1.3e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=1 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=2 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=3 t=1.0e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=4 t=7.4e-03 per=2.0e+01 cost=2.4e+03 flops=3.2e+05
 renorm[gemm] counter=13 i=5 t=7.5e-03 per=2.0e+01 cost=5.5e+03 flops=7.3e+05
 renorm[gemm] counter=13 i=6 t=7.4e-03 per=2.0e+01 cost=9.6e+03 flops=1.3e+06
 renorm[gemm] counter=13 total t=2.2e-02 per=6.0e+01 cost=1.7e+04 flops=7.8e+05
 renorm[red] counter=13 t=9.9e-03 per=2.6e+01 cost=4.8e+03 flops=4.9e+05
----- TIMING FOR renorm_tot : t_inter=7.3e-02 t_gemm=2.8e-01 t_reduction=1.3e-01 tot=4.8e-01 -----
 renorm_tot[inter] counter=13 t=7.3e-02 per=1.5e+01 cost=5.1e+05 flops=7.0e+06
 renorm_tot[gemm] counter=13 i=0 t=1.7e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=1 t=1.4e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=2 t=1.4e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=3 t=1.4e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=4 t=9.2e-02 per=1.9e+01 cost=2.1e+05 flops=2.3e+06
 renorm_tot[gemm] counter=13 i=5 t=9.2e-02 per=1.9e+01 cost=2.8e+05 flops=3.0e+06
 renorm_tot[gemm] counter=13 i=6 t=9.2e-02 per=1.9e+01 cost=1.4e+06 flops=1.5e+07
 renorm_tot[gemm] counter=13 total t=2.8e-01 per=5.8e+01 cost=1.9e+06 flops=6.9e+06
 renorm_tot[red] counter=13 t=1.3e-01 per=2.7e+01 cost=6.5e+05 flops=5.1e+06
qops.to_cpu: size(tot)=374:2.9e-03MB:2.8e-06GB T(to_cpu)=1.9e-04S speed=1.5e-02GB/S
check ||H-H.dagger||=5.024e-15 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.0685 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=7.244e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.052e-04 change=-1.821e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.052e-04 change=-5.662e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 6.915e-01 S #####
 T(local opt: fetch) = 1.177e-02 S  per =  1.7  per(accum) = 1.7
 T(local opt: hdiag) = 1.767e-01 S  per = 25.6  per(accum) = 27.3
 T(local opt: dvdsn) = 4.176e-01 S  per = 60.4  per(accum) = 87.6
 T(local opt: decim) = 1.384e-02 S  per =    2  per(accum) = 89.6
 T(local opt: guess) = 7.826e-05 S  per = 0.0113  per(accum) = 89.7
 T(local opt: renrm) = 7.122e-02 S  per = 10.3  per(accum) = 100
 T(local opt: save ) = 2.766e-04 S  per = 0.04  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.176e-01 S  T(sum) = 4.168e-01 S  per = 9.981e+01
 T(local opt: preprocess                  ) = 1.015e-04 S  per = 0.0243  per(accum) = 0.0243
 T(local opt: symbolic_formulae           ) = 1.503e-02 S  per = 3.61  per(accum) = 3.63
 T(local opt: hintermediate init          ) = 3.566e-04 S  per = 0.0856  per(accum) = 3.72
 T(local opt: preprocess_hformulae_Hxlist ) = 4.473e-03 S  per = 1.07  per(accum) = 4.79
 T(local opt: hmmtasks init               ) = 8.218e-03 S  per = 1.97  per(accum) = 6.76
 T(local opt: initial guess for dvdson    ) = 2.580e-06 S  per = 0.000619  per(accum) = 6.76
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.174e-01 S  per = 76.1  per(accum) = 82.9
 T(local opt: dvdson [cpu-gpu]            ) = 4.573e-03 S  per =  1.1  per(accum) = 84
 T(local opt: dvdson [nccl]               ) = 3.585e-05 S  per = 0.0086  per(accum) = 84
 T(local opt: dvdson [mpi]                ) = 8.980e-07 S  per = 0.000215  per(accum) = 84
 T(local opt: dvdson [rest part(linalg)]  ) = 6.663e-02 S  per =   16  per(accum) = 100
Detailed decomposition of T(renrm) = 7.122e-02 S  T(sum) = 7.122e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.848e-04 S  per =  1.1  per(accum) = 1.1
 T(local opt: qops init                    ) = 1.682e-03 S  per = 2.36  per(accum) = 3.46
 T(local opt: symbolic_formulae_renorm     ) = 1.631e-02 S  per = 22.9  per(accum) = 26.4
 T(local opt: allocate qops on gpu         ) = 5.226e-05 S  per = 0.0734  per(accum) = 26.4
 T(local opt: site memcpy cpu2gpu          ) = 1.276e-03 S  per = 1.79  per(accum) = 28.2
 T(local opt: rintermediate init           ) = 2.513e-03 S  per = 3.53  per(accum) = 31.8
 T(local opt: preprocess_formulae_Rlist2   ) = 3.880e-03 S  per = 5.45  per(accum) = 37.2
 T(local opt: rmmtasks init                ) = 4.871e-03 S  per = 6.84  per(accum) = 44
 T(local opt: qops memset on cpu           ) = 3.200e-08 S  per = 4.49e-05  per(accum) = 44
 T(local opt: preprocess_renorm_batchGPU   ) = 3.769e-02 S  per = 52.9  per(accum) = 97
 T(local opt: deallocate cpu and gpu memory) = 6.121e-05 S  per = 0.0859  per(accum) = 97.1
 T(local opt: construct opS [ifdists=true] ) = 2.900e-08 S  per = 4.07e-05  per(accum) = 97.1
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 5.34e-05  per(accum) = 97.1
 T(local opt: qops memcpy gpu2cpu          ) = 1.944e-04 S  per = 0.273  per(accum) = 97.3
 T(local opt: reduction of opS & opH [mpi] ) = 1.737e-05 S  per = 0.0244  per(accum) = 97.3
 T(local opt: qops_pool join and erase     ) = 1.886e-03 S  per = 2.65  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.670e-06 S  per = 0.00234  per(accum) = 100
##### sweep opt: 8.281e+00 S #####
 T(sweep opt: fetch) = 1.590e-01 S  per = 1.92  per(accum) = 1.92
 T(sweep opt: hdiag) = 2.834e+00 S  per = 34.2  per(accum) = 36.1
 T(sweep opt: dvdsn) = 4.200e+00 S  per = 50.7  per(accum) = 86.9
 T(sweep opt: decim) = 1.378e-01 S  per = 1.66  per(accum) = 88.5
 T(sweep opt: guess) = 1.103e-03 S  per = 0.0133  per(accum) = 88.6
 T(sweep opt: renrm) = 9.449e-01 S  per = 11.4  per(accum) = 100
 T(sweep opt: save ) = 3.195e-03 S  per = 0.0386  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.200e+00 S  T(sum) = 4.196e+00 S  per = 9.989e+01
 T(sweep opt: preprocess                  ) = 1.399e-03 S  per = 0.0334  per(accum) = 0.0334
 T(sweep opt: symbolic_formulae           ) = 1.893e-01 S  per = 4.51  per(accum) = 4.55
 T(sweep opt: hintermediate init          ) = 4.939e-03 S  per = 0.118  per(accum) = 4.66
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.343e-02 S  per = 1.51  per(accum) = 6.18
 T(sweep opt: hmmtasks init               ) = 1.225e-01 S  per = 2.92  per(accum) = 9.1
 T(sweep opt: initial guess for dvdson    ) = 5.312e-05 S  per = 0.00127  per(accum) = 9.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.135e+00 S  per = 74.7  per(accum) = 83.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 8.157e-02 S  per = 1.94  per(accum) = 85.8
 T(sweep opt: dvdson [nccl]               ) = 3.632e-04 S  per = 0.00866  per(accum) = 85.8
 T(sweep opt: dvdson [mpi]                ) = 8.975e-06 S  per = 0.000214  per(accum) = 85.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 5.969e-01 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 9.449e-01 S  T(sum) = 9.449e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.834e-03 S  per = 0.194  per(accum) = 0.194
 T(sweep opt: qops init                    ) = 2.527e-02 S  per = 2.67  per(accum) = 2.87
 T(sweep opt: symbolic_formulae_renorm     ) = 1.695e-01 S  per = 17.9  per(accum) = 20.8
 T(sweep opt: allocate qops on gpu         ) = 7.213e-04 S  per = 0.0763  per(accum) = 20.9
 T(sweep opt: site memcpy cpu2gpu          ) = 1.924e-02 S  per = 2.04  per(accum) = 22.9
 T(sweep opt: rintermediate init           ) = 2.828e-02 S  per = 2.99  per(accum) = 25.9
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.627e-02 S  per = 5.96  per(accum) = 31.9
 T(sweep opt: rmmtasks init                ) = 1.137e-01 S  per =   12  per(accum) = 43.9
 T(sweep opt: qops memset on cpu           ) = 5.430e-07 S  per = 5.75e-05  per(accum) = 43.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.785e-01 S  per = 50.6  per(accum) = 94.5
 T(sweep opt: deallocate cpu and gpu memory) = 1.117e-03 S  per = 0.118  per(accum) = 94.6
 T(sweep opt: construct opS [ifdists=true] ) = 4.840e-07 S  per = 5.12e-05  per(accum) = 94.6
 T(sweep opt: reduction of opS & opH [nccl]) = 4.880e-07 S  per = 5.16e-05  per(accum) = 94.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.616e-03 S  per = 0.277  per(accum) = 94.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.297e-04 S  per = 0.0243  per(accum) = 95
 T(sweep opt: qops_pool join and erase     ) = 1.934e-02 S  per = 2.05  per(accum) = 97
 T(sweep opt: conversion from opAB to opPQ ) = 2.838e-02 S  per =    3  per(accum) = 100
##### global opt: 8.281e+00 S #####
 T(global opt: fetch) = 1.590e-01 S  per = 1.92  per(accum) = 1.92
 T(global opt: hdiag) = 2.834e+00 S  per = 34.2  per(accum) = 36.1
 T(global opt: dvdsn) = 4.200e+00 S  per = 50.7  per(accum) = 86.9
 T(global opt: decim) = 1.378e-01 S  per = 1.66  per(accum) = 88.5
 T(global opt: guess) = 1.103e-03 S  per = 0.0133  per(accum) = 88.6
 T(global opt: renrm) = 9.449e-01 S  per = 11.4  per(accum) = 100
 T(global opt: save ) = 3.195e-03 S  per = 0.0386  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.200e+00 S  T(sum) = 4.196e+00 S  per = 9.989e+01
 T(global opt: preprocess                  ) = 1.399e-03 S  per = 0.0334  per(accum) = 0.0334
 T(global opt: symbolic_formulae           ) = 1.893e-01 S  per = 4.51  per(accum) = 4.55
 T(global opt: hintermediate init          ) = 4.939e-03 S  per = 0.118  per(accum) = 4.66
 T(global opt: preprocess_hformulae_Hxlist ) = 6.343e-02 S  per = 1.51  per(accum) = 6.18
 T(global opt: hmmtasks init               ) = 1.225e-01 S  per = 2.92  per(accum) = 9.1
 T(global opt: initial guess for dvdson    ) = 5.312e-05 S  per = 0.00127  per(accum) = 9.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.135e+00 S  per = 74.7  per(accum) = 83.8
 T(global opt: dvdson [cpu-gpu]            ) = 8.157e-02 S  per = 1.94  per(accum) = 85.8
 T(global opt: dvdson [nccl]               ) = 3.632e-04 S  per = 0.00866  per(accum) = 85.8
 T(global opt: dvdson [mpi]                ) = 8.975e-06 S  per = 0.000214  per(accum) = 85.8
 T(global opt: dvdson [rest part(linalg)]  ) = 5.969e-01 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 9.449e-01 S  T(sum) = 9.449e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.834e-03 S  per = 0.194  per(accum) = 0.194
 T(global opt: qops init                    ) = 2.527e-02 S  per = 2.67  per(accum) = 2.87
 T(global opt: symbolic_formulae_renorm     ) = 1.695e-01 S  per = 17.9  per(accum) = 20.8
 T(global opt: allocate qops on gpu         ) = 7.213e-04 S  per = 0.0763  per(accum) = 20.9
 T(global opt: site memcpy cpu2gpu          ) = 1.924e-02 S  per = 2.04  per(accum) = 22.9
 T(global opt: rintermediate init           ) = 2.828e-02 S  per = 2.99  per(accum) = 25.9
 T(global opt: preprocess_formulae_Rlist2   ) = 5.627e-02 S  per = 5.96  per(accum) = 31.9
 T(global opt: rmmtasks init                ) = 1.137e-01 S  per =   12  per(accum) = 43.9
 T(global opt: qops memset on cpu           ) = 5.430e-07 S  per = 5.75e-05  per(accum) = 43.9
 T(global opt: preprocess_renorm_batchGPU   ) = 4.785e-01 S  per = 50.6  per(accum) = 94.5
 T(global opt: deallocate cpu and gpu memory) = 1.117e-03 S  per = 0.118  per(accum) = 94.6
 T(global opt: construct opS [ifdists=true] ) = 4.840e-07 S  per = 5.12e-05  per(accum) = 94.6
 T(global opt: reduction of opS & opH [nccl]) = 4.880e-07 S  per = 5.16e-05  per(accum) = 94.6
 T(global opt: qops memcpy gpu2cpu          ) = 2.616e-03 S  per = 0.277  per(accum) = 94.9
 T(global opt: reduction of opS & opH [mpi] ) = 2.297e-04 S  per = 0.0243  per(accum) = 95
 T(global opt: qops_pool join and erase     ) = 1.934e-02 S  per = 2.05  per(accum) = 97
 T(global opt: conversion from opAB to opPQ ) = 2.838e-02 S  per =    3  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.390e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=13/seqsize=34 dots=1 dbond=(14,0)-(15,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=8:6.104e-05MB:5.960e-08GB
total mem of comb=772:5.890e-03MB:5.752e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=14,5,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 11 12 13 14 15
 suppc= 10
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=374:2.853e-03MB:2.787e-06GB
        per(mem): H:1.6 C:15 S:6.42 P:0 Q:77 
 rqops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=124:0.000946MB:9.24e-07GB
        per(mem): H:3.23 C:0 S:0 A:0 B:96.8 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2834:0.0216MB:2.11e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.258e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(14,0) fdel=./scratch/sweep/rop(15,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-5.960e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(4,2,4) nnz=8:6.104e-05MB
qtensor3: wf3 own=1 _data=0x3d160940
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=4
 (21,3):2 (22,2):1 (22,4):1
 qbond: qcol nsym=1 dimAll=2
 (7,-3):2
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=12 size=8:6.104e-05MB
### DIAG TIMING: total=1.613e-01 t1=4.057e-05, t2=2.203e-03, t3=2.532e-03, t4=1.565e-01, t5=6.130e-06, t6=1.418e-05, t7=4.722e-06
duration_diagGPU:1.613e-01
duration_diagreduce:9.900e-08
duration_diagtransform:3.820e-07
----- TIMING FOR symbolic_formulae_onedot with size=607 : 1.139e-02 S -----
rank=0 GPUmem(GB): used=2.111e-05 (oper)=2.111e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=607
 no. of hintermediate operators=280
 no. of coefficients=3920:2.991e-02MB:2.921e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.631e-04 S -----
rank=0 GPUmem(GB): used=5.032e-05 (oper,hinter)=2.111e-05,2.921e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.470e-03 S size(H_formulae)=607 size(Hxlst2)=3 T(Hmu/Hxlist)=1.505e-03,9.654e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.592e-03 S size(H_formulae)=607 size(Hxlst)=688 -----
rank=0 GPUmem(GB): used=5.032e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.192e-07 batch[need]=5.639e-05 blksize=4 blksize0=2 batchsize=688
rank=0 GPUmem(GB): used=1.068e-04 (oper,hinter,dvdson,batch)=2.111e-05,2.921e-05,1.192e-07,5.639e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=8 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.588e-03,9.987e-03,3.003e-02,1.244e-02,5.405e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.583e-03 speed=7.531e-05GB/S T(nccl)=5.049e-06 speed=2.361e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=62 t=1.0e-02 per=1.9e+01 cost=1.3e+04 flops=1.3e+06
 sigma[gemm] counter=62 i=0 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=2 t=7.6e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=62 i=3 t=7.6e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=62 i=4 t=7.4e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=62 i=5 t=7.4e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=62 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=62 t=1.2e-02 per=2.4e+01 cost=3.9e+03 flops=3.1e+05
----- TIMING FOR sigma_tot : t_inter=6.2e-01 t_gemm=1.8e+00 t_reduction=7.5e-01 tot=3.2e+00 -----
 sigma_tot[inter] counter=62 t=6.2e-01 per=1.9e+01 cost=2.4e+06 flops=3.9e+06
 sigma_tot[gemm] counter=62 i=0 t=1.2e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=1 t=1.0e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=2 t=4.5e-01 per=1.4e+01 cost=1.1e+06 flops=2.3e+06
 sigma_tot[gemm] counter=62 i=3 t=4.5e-01 per=1.4e+01 cost=1.1e+06 flops=2.4e+06
 sigma_tot[gemm] counter=62 i=4 t=4.5e-01 per=1.4e+01 cost=1.0e+06 flops=2.3e+06
 sigma_tot[gemm] counter=62 i=5 t=4.5e-01 per=1.4e+01 cost=1.0e+06 flops=2.3e+06
 sigma_tot[gemm] counter=62 total t=1.8e+00 per=5.7e+01 cost=4.2e+06 flops=2.3e+06
 sigma_tot[red] counter=62 t=7.5e-01 per=2.4e+01 cost=1.1e+06 flops=1.5e+06
T(sub)=9.6e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.0e-06,2.1e-06,7.4e-07,1.7e-07
settings: ndim=8 neig=1 maxcycle=30 nbuff=4 memory=9e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.301384902089 -1.116e+03  5.386e-02    1     1  5.417e-02 5.417e-02 5.415e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.637e-04,1.007e-02,3.013e-02,1.241e-02,5.358e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=9.587e-04 speed=1.243e-04GB/S T(nccl)=5.050e-06 speed=2.361e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=63 t=1.0e-02 per=1.9e+01 cost=1.3e+04 flops=1.3e+06
 sigma[gemm] counter=63 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=2 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=63 i=3 t=7.6e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=63 i=4 t=7.6e-03 per=1.4e+01 cost=2.0e+03 flops=2.6e+05
 sigma[gemm] counter=63 i=5 t=7.5e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=63 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=63 t=1.2e-02 per=2.4e+01 cost=3.9e+03 flops=3.1e+05
----- TIMING FOR sigma_tot : t_inter=6.3e-01 t_gemm=1.8e+00 t_reduction=7.6e-01 tot=3.2e+00 -----
 sigma_tot[inter] counter=63 t=6.3e-01 per=1.9e+01 cost=2.4e+06 flops=3.9e+06
 sigma_tot[gemm] counter=63 i=0 t=1.3e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=1 t=1.1e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=2 t=4.6e-01 per=1.4e+01 cost=1.1e+06 flops=2.3e+06
 sigma_tot[gemm] counter=63 i=3 t=4.6e-01 per=1.4e+01 cost=1.1e+06 flops=2.3e+06
 sigma_tot[gemm] counter=63 i=4 t=4.6e-01 per=1.4e+01 cost=1.0e+06 flops=2.3e+06
 sigma_tot[gemm] counter=63 i=5 t=4.6e-01 per=1.4e+01 cost=1.0e+06 flops=2.3e+06
 sigma_tot[gemm] counter=63 total t=1.8e+00 per=5.7e+01 cost=4.2e+06 flops=2.3e+06
 sigma_tot[red] counter=63 t=7.6e-01 per=2.4e+01 cost=1.1e+06 flops=1.5e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.3e-05,3.6e-06,8.6e-07,2.0e-07
    2   0 -    -116.309193956505 -7.809e-03  1.241e-02    2     2  1.156e-01 5.779e-02 5.391e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.354e-03,1.012e-02,3.018e-02,1.254e-02,5.421e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.349e-03 speed=8.838e-05GB/S T(nccl)=5.030e-06 speed=2.370e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=64 t=1.0e-02 per=1.9e+01 cost=1.3e+04 flops=1.3e+06
 sigma[gemm] counter=64 i=0 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=2 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=64 i=3 t=7.6e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=64 i=4 t=7.5e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=64 i=5 t=7.6e-03 per=1.4e+01 cost=2.0e+03 flops=2.6e+05
 sigma[gemm] counter=64 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=64 t=1.3e-02 per=2.4e+01 cost=3.9e+03 flops=3.1e+05
----- TIMING FOR sigma_tot : t_inter=6.4e-01 t_gemm=1.9e+00 t_reduction=7.8e-01 tot=3.3e+00 -----
 sigma_tot[inter] counter=64 t=6.4e-01 per=1.9e+01 cost=2.5e+06 flops=3.8e+06
 sigma_tot[gemm] counter=64 i=0 t=1.3e-04 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=1 t=1.1e-04 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=2 t=4.7e-01 per=1.4e+01 cost=1.1e+06 flops=2.3e+06
 sigma_tot[gemm] counter=64 i=3 t=4.7e-01 per=1.4e+01 cost=1.1e+06 flops=2.3e+06
 sigma_tot[gemm] counter=64 i=4 t=4.7e-01 per=1.4e+01 cost=1.0e+06 flops=2.2e+06
 sigma_tot[gemm] counter=64 i=5 t=4.7e-01 per=1.4e+01 cost=1.0e+06 flops=2.2e+06
 sigma_tot[gemm] counter=64 total t=1.9e+00 per=5.7e+01 cost=4.2e+06 flops=2.3e+06
 sigma_tot[red] counter=64 t=7.8e-01 per=2.4e+01 cost=1.1e+06 flops=1.4e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.5e-05,2.9e-06,1.0e-06,1.9e-07
    3   0 -    -116.309890005097 -6.960e-04  4.101e-03    3     3  1.878e-01 6.258e-02 5.404e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.676e-03,1.014e-02,3.026e-02,1.262e-02,5.470e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.670e-03 speed=7.139e-05GB/S T(nccl)=6.122e-06 speed=1.947e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=65 t=1.0e-02 per=1.9e+01 cost=1.3e+04 flops=1.3e+06
 sigma[gemm] counter=65 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=2 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=65 i=3 t=7.6e-03 per=1.4e+01 cost=3.4e+03 flops=4.4e+05
 sigma[gemm] counter=65 i=4 t=7.5e-03 per=1.4e+01 cost=2.0e+03 flops=2.6e+05
 sigma[gemm] counter=65 i=5 t=7.5e-03 per=1.4e+01 cost=2.0e+03 flops=2.6e+05
 sigma[gemm] counter=65 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=65 t=1.3e-02 per=2.4e+01 cost=3.9e+03 flops=3.1e+05
----- TIMING FOR sigma_tot : t_inter=6.5e-01 t_gemm=1.9e+00 t_reduction=7.9e-01 tot=3.3e+00 -----
 sigma_tot[inter] counter=65 t=6.5e-01 per=1.9e+01 cost=2.5e+06 flops=3.8e+06
 sigma_tot[gemm] counter=65 i=0 t=1.3e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=1 t=1.1e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=2 t=4.7e-01 per=1.4e+01 cost=1.1e+06 flops=2.3e+06
 sigma_tot[gemm] counter=65 i=3 t=4.7e-01 per=1.4e+01 cost=1.1e+06 flops=2.3e+06
 sigma_tot[gemm] counter=65 i=4 t=4.8e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=65 i=5 t=4.7e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=65 total t=1.9e+00 per=5.7e+01 cost=4.2e+06 flops=2.2e+06
 sigma_tot[red] counter=65 t=7.9e-01 per=2.4e+01 cost=1.1e+06 flops=1.4e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.4e-05,3.0e-06,9.8e-07,2.0e-07
    4   0 -    -116.309956159530 -6.615e-05  6.064e-04    3     4  2.558e-01 6.396e-02 5.423e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.157e-03,9.971e-03,2.755e-02,3.222e-03,4.192e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.151e-03 speed=1.036e-04GB/S T(nccl)=5.623e-06 speed=2.120e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=2.8e-02 t_reduction=3.2e-03 tot=4.1e-02 -----
 sigma[inter] counter=66 t=1.0e-02 per=2.4e+01 cost=1.3e+04 flops=1.3e+06
 sigma[gemm] counter=66 i=0 t=1.4e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=1 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=2 t=7.5e-03 per=1.8e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=66 i=3 t=7.5e-03 per=1.8e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=66 i=4 t=7.6e-03 per=1.9e+01 cost=2.0e+03 flops=2.6e+05
 sigma[gemm] counter=66 i=5 t=5.0e-03 per=1.2e+01 cost=2.0e+03 flops=4.0e+05
 sigma[gemm] counter=66 total t=2.8e-02 per=6.8e+01 cost=1.1e+04 flops=3.9e+05
 sigma[red] counter=66 t=3.2e-03 per=7.9e+00 cost=3.9e+03 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=6.6e-01 t_gemm=1.9e+00 t_reduction=7.9e-01 tot=3.4e+00 -----
 sigma_tot[inter] counter=66 t=6.6e-01 per=1.9e+01 cost=2.5e+06 flops=3.8e+06
 sigma_tot[gemm] counter=66 i=0 t=1.3e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=1 t=1.1e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=2 t=4.8e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=66 i=3 t=4.8e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=66 i=4 t=4.8e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=66 i=5 t=4.8e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=66 total t=1.9e+00 per=5.7e+01 cost=4.3e+06 flops=2.2e+06
 sigma_tot[red] counter=66 t=7.9e-01 per=2.3e+01 cost=1.1e+06 flops=1.4e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.4e-05,3.0e-06,1.0e-06,2.0e-07
    5   0 +    -116.309956986587 -8.271e-07  8.085e-05    3     5  3.096e-01 6.191e-02 5.179e-02
TIMING FOR Davidson : 3.096e-01  T(cal/comm/rest)=2.589e-01,5.300e-07,5.063e-02
decomposed t_rest=5.063e-02
 T(sub)    =9.938e-05 per=1.963e-01
 T(precond)=5.038e-02 per=9.951e+01
 T(ortho)  =2.544e-05 per=5.025e-02
 T(xcopy)  =6.360e-07 per=1.256e-03
 T(xnrm2)  =1.134e-05 per=2.240e-02
 T(other)  =1.092e-04 per=2.157e-01
optimized energies: isweep=0 ibond=13 dots=1 e[0]=-116.309956986587 nmvp=5
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=6.112e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond13.txt
 qbond: qsuper nsym=8 dimAll=16
 (21,3):2 (23,3):4 (22,4):3 (22,2):3 (24,2):1 (23,1):1 (24,4):1 (23,5):1
timing for divide=8.1e-06
timing for compute=1.3e-02
timing for collect=1.1e-05
----- TMING FOR decimation_genbasis(nkr): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=8.1e-06,1.3e-02,0.0e+00,4.2e-06,1.1e-05 -----
decimation summary: 16->2 dwt=+0.000e+00 SvN=4.761e-02
 qbond: qkept nsym=1 dimAll=2
 (23,3):2
----- TIMING for decimation_row(nkr): 1.314e-02 S T(decim/select/formRot)=1.293e-02,1.917e-04,1.579e-05 -----
----- TIMING FOR onedot_decimation: 1.319e-02 S T(wf/decim)=4.461e-05,1.315e-02 -----
ctns::oper_renorm coord=(14,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=2,2 size(op)=4:3.052e-05MB size(tot)=124:9.460e-04MB:9.239e-07GB
        per(mem): H:3.23 C:0 S:0 P:0 Q:96.8 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.919e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=141 : 1.156e-02 S -----
rank=0 GPUmem(GB): used=5.032e-05 (oper)=2.111e-05
rank=0 GPUmem(GB): used=5.038e-05 (oper,site)=2.111e-05,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=280
 no. of coefficients=3920:2.991e-02MB:2.921e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.482e-03 S -----
rank=0 GPUmem(GB): used=7.959e-05 (oper,site,rinter)=2.111e-05,5.960e-08,2.921e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.312e-03 S size(rtasks)=141 size(Rlst2)=1 T(Rmu/Rlist)=1.658e-03,6.537e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.371e-03 S size(rtasks)=141 size(Rlst)=382 -----
rank=0 GPUmem(GB): used=7.959e-05 avail=6.176e+00 total=6.176e+00 batch[need]=3.131e-05 blksize=4 blksize0=2 batchsize=382
rank=0 GPUmem(GB): used=1.109e-04 (oper,site,rinter,batch)=2.111e-05,5.960e-08,2.921e-05,3.131e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.247e-03,2.240e-02,9.910e-03
----- TIMING FOR renorm : t_inter=5.2e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.8e-02 -----
 renorm[inter] counter=14 t=5.2e-03 per=1.4e+01 cost=6.7e+03 flops=1.3e+06
 renorm[gemm] counter=14 i=0 t=1.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=2 t=1.0e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=4 t=7.5e-03 per=2.0e+01 cost=7.9e+02 flops=1.1e+05
 renorm[gemm] counter=14 i=5 t=7.5e-03 per=2.0e+01 cost=1.5e+03 flops=2.0e+05
 renorm[gemm] counter=14 i=6 t=7.5e-03 per=2.0e+01 cost=4.3e+03 flops=5.8e+05
 renorm[gemm] counter=14 total t=2.2e-02 per=6.0e+01 cost=6.6e+03 flops=3.0e+05
 renorm[red] counter=14 t=9.9e-03 per=2.6e+01 cost=3.1e+03 flops=3.1e+05
----- TIMING FOR renorm_tot : t_inter=7.9e-02 t_gemm=3.0e-01 t_reduction=1.4e-01 tot=5.1e-01 -----
 renorm_tot[inter] counter=14 t=7.9e-02 per=1.5e+01 cost=5.2e+05 flops=6.6e+06
 renorm_tot[gemm] counter=14 i=0 t=1.8e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=1 t=1.6e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=2 t=1.5e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=3 t=1.5e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=4 t=1.0e-01 per=1.9e+01 cost=2.1e+05 flops=2.1e+06
 renorm_tot[gemm] counter=14 i=5 t=9.9e-02 per=1.9e+01 cost=2.8e+05 flops=2.8e+06
 renorm_tot[gemm] counter=14 i=6 t=9.9e-02 per=1.9e+01 cost=1.4e+06 flops=1.4e+07
 renorm_tot[gemm] counter=14 total t=3.0e-01 per=5.8e+01 cost=1.9e+06 flops=6.4e+06
 renorm_tot[red] counter=14 t=1.4e-01 per=2.7e+01 cost=6.5e+05 flops=4.7e+06
qops.to_cpu: size(tot)=124:9.5e-04MB:9.2e-07GB T(to_cpu)=1.4e-04S speed=6.5e-03GB/S
check ||H-H.dagger||=1.256e-15 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.0595 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.783e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.499e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.906e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 5.752e-01 S #####
 T(local opt: fetch) = 1.122e-02 S  per = 1.95  per(accum) = 1.95
 T(local opt: hdiag) = 1.613e-01 S  per =   28  per(accum) = 30
 T(local opt: dvdsn) = 3.277e-01 S  per =   57  per(accum) = 87
 T(local opt: decim) = 1.320e-02 S  per =  2.3  per(accum) = 89.3
 T(local opt: guess) = 5.971e-05 S  per = 0.0104  per(accum) = 89.3
 T(local opt: renrm) = 6.141e-02 S  per = 10.7  per(accum) = 100
 T(local opt: save ) = 2.375e-04 S  per = 0.0413  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.277e-01 S  T(sum) = 3.276e-01 S  per = 9.995e+01
 T(local opt: preprocess                  ) = 7.206e-05 S  per = 0.022  per(accum) = 0.022
 T(local opt: symbolic_formulae           ) = 1.140e-02 S  per = 3.48  per(accum) = 3.5
 T(local opt: hintermediate init          ) = 2.783e-04 S  per = 0.0849  per(accum) = 3.59
 T(local opt: preprocess_hformulae_Hxlist ) = 2.615e-03 S  per = 0.798  per(accum) = 4.39
 T(local opt: hmmtasks init               ) = 3.637e-03 S  per = 1.11  per(accum) = 5.5
 T(local opt: initial guess for dvdson    ) = 2.455e-06 S  per = 0.000749  per(accum) = 5.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.522e-01 S  per =   77  per(accum) = 82.5
 T(local opt: dvdson [cpu-gpu]            ) = 6.711e-03 S  per = 2.05  per(accum) = 84.5
 T(local opt: dvdson [nccl]               ) = 2.687e-05 S  per = 0.0082  per(accum) = 84.5
 T(local opt: dvdson [mpi]                ) = 5.300e-07 S  per = 0.000162  per(accum) = 84.5
 T(local opt: dvdson [rest part(linalg)]  ) = 5.063e-02 S  per = 15.5  per(accum) = 100
Detailed decomposition of T(renrm) = 6.141e-02 S  T(sum) = 6.141e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.534e-04 S  per = 0.901  per(accum) = 0.901
 T(local opt: qops init                    ) = 1.635e-03 S  per = 2.66  per(accum) = 3.56
 T(local opt: symbolic_formulae_renorm     ) = 1.157e-02 S  per = 18.8  per(accum) = 22.4
 T(local opt: allocate qops on gpu         ) = 4.679e-05 S  per = 0.0762  per(accum) = 22.5
 T(local opt: site memcpy cpu2gpu          ) = 1.263e-03 S  per = 2.06  per(accum) = 24.5
 T(local opt: rintermediate init           ) = 2.493e-03 S  per = 4.06  per(accum) = 28.6
 T(local opt: preprocess_formulae_Rlist2   ) = 2.387e-03 S  per = 3.89  per(accum) = 32.5
 T(local opt: rmmtasks init                ) = 2.235e-03 S  per = 3.64  per(accum) = 36.1
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 5.54e-05  per(accum) = 36.1
 T(local opt: preprocess_renorm_batchGPU   ) = 3.764e-02 S  per = 61.3  per(accum) = 97.4
 T(local opt: deallocate cpu and gpu memory) = 3.740e-05 S  per = 0.0609  per(accum) = 97.5
 T(local opt: construct opS [ifdists=true] ) = 3.100e-08 S  per = 5.05e-05  per(accum) = 97.5
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 6.03e-05  per(accum) = 97.5
 T(local opt: qops memcpy gpu2cpu          ) = 1.500e-04 S  per = 0.244  per(accum) = 97.7
 T(local opt: reduction of opS & opH [mpi] ) = 1.459e-05 S  per = 0.0238  per(accum) = 97.8
 T(local opt: qops_pool join and erase     ) = 1.375e-03 S  per = 2.24  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.456e-06 S  per = 0.00237  per(accum) = 100
##### sweep opt: 8.856e+00 S #####
 T(sweep opt: fetch) = 1.702e-01 S  per = 1.92  per(accum) = 1.92
 T(sweep opt: hdiag) = 2.996e+00 S  per = 33.8  per(accum) = 35.7
 T(sweep opt: dvdsn) = 4.528e+00 S  per = 51.1  per(accum) = 86.9
 T(sweep opt: decim) = 1.510e-01 S  per = 1.71  per(accum) = 88.6
 T(sweep opt: guess) = 1.163e-03 S  per = 0.0131  per(accum) = 88.6
 T(sweep opt: renrm) = 1.006e+00 S  per = 11.4  per(accum) = 100
 T(sweep opt: save ) = 3.433e-03 S  per = 0.0388  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.528e+00 S  T(sum) = 4.523e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 1.471e-03 S  per = 0.0325  per(accum) = 0.0325
 T(sweep opt: symbolic_formulae           ) = 2.007e-01 S  per = 4.44  per(accum) = 4.47
 T(sweep opt: hintermediate init          ) = 5.217e-03 S  per = 0.115  per(accum) = 4.59
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.605e-02 S  per = 1.46  per(accum) = 6.05
 T(sweep opt: hmmtasks init               ) = 1.262e-01 S  per = 2.79  per(accum) = 8.84
 T(sweep opt: initial guess for dvdson    ) = 5.557e-05 S  per = 0.00123  per(accum) = 8.84
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.387e+00 S  per = 74.9  per(accum) = 83.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 8.828e-02 S  per = 1.95  per(accum) = 85.7
 T(sweep opt: dvdson [nccl]               ) = 3.900e-04 S  per = 0.00862  per(accum) = 85.7
 T(sweep opt: dvdson [mpi]                ) = 9.505e-06 S  per = 0.00021  per(accum) = 85.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.475e-01 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.006e+00 S  T(sum) = 1.006e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.388e-03 S  per = 0.237  per(accum) = 0.237
 T(sweep opt: qops init                    ) = 2.691e-02 S  per = 2.67  per(accum) = 2.91
 T(sweep opt: symbolic_formulae_renorm     ) = 1.811e-01 S  per =   18  per(accum) = 20.9
 T(sweep opt: allocate qops on gpu         ) = 7.681e-04 S  per = 0.0763  per(accum) = 21
 T(sweep opt: site memcpy cpu2gpu          ) = 2.050e-02 S  per = 2.04  per(accum) = 23
 T(sweep opt: rintermediate init           ) = 3.078e-02 S  per = 3.06  per(accum) = 26.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.866e-02 S  per = 5.83  per(accum) = 31.9
 T(sweep opt: rmmtasks init                ) = 1.159e-01 S  per = 11.5  per(accum) = 43.4
 T(sweep opt: qops memset on cpu           ) = 5.770e-07 S  per = 5.73e-05  per(accum) = 43.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.161e-01 S  per = 51.3  per(accum) = 94.7
 T(sweep opt: deallocate cpu and gpu memory) = 1.155e-03 S  per = 0.115  per(accum) = 94.8
 T(sweep opt: construct opS [ifdists=true] ) = 5.150e-07 S  per = 5.12e-05  per(accum) = 94.8
 T(sweep opt: reduction of opS & opH [nccl]) = 5.250e-07 S  per = 5.22e-05  per(accum) = 94.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.766e-03 S  per = 0.275  per(accum) = 95.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.443e-04 S  per = 0.0243  per(accum) = 95.1
 T(sweep opt: qops_pool join and erase     ) = 2.071e-02 S  per = 2.06  per(accum) = 97.2
 T(sweep opt: conversion from opAB to opPQ ) = 2.838e-02 S  per = 2.82  per(accum) = 100
##### global opt: 8.856e+00 S #####
 T(global opt: fetch) = 1.702e-01 S  per = 1.92  per(accum) = 1.92
 T(global opt: hdiag) = 2.996e+00 S  per = 33.8  per(accum) = 35.7
 T(global opt: dvdsn) = 4.528e+00 S  per = 51.1  per(accum) = 86.9
 T(global opt: decim) = 1.510e-01 S  per = 1.71  per(accum) = 88.6
 T(global opt: guess) = 1.163e-03 S  per = 0.0131  per(accum) = 88.6
 T(global opt: renrm) = 1.006e+00 S  per = 11.4  per(accum) = 100
 T(global opt: save ) = 3.433e-03 S  per = 0.0388  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.528e+00 S  T(sum) = 4.523e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 1.471e-03 S  per = 0.0325  per(accum) = 0.0325
 T(global opt: symbolic_formulae           ) = 2.007e-01 S  per = 4.44  per(accum) = 4.47
 T(global opt: hintermediate init          ) = 5.217e-03 S  per = 0.115  per(accum) = 4.59
 T(global opt: preprocess_hformulae_Hxlist ) = 6.605e-02 S  per = 1.46  per(accum) = 6.05
 T(global opt: hmmtasks init               ) = 1.262e-01 S  per = 2.79  per(accum) = 8.84
 T(global opt: initial guess for dvdson    ) = 5.557e-05 S  per = 0.00123  per(accum) = 8.84
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.387e+00 S  per = 74.9  per(accum) = 83.7
 T(global opt: dvdson [cpu-gpu]            ) = 8.828e-02 S  per = 1.95  per(accum) = 85.7
 T(global opt: dvdson [nccl]               ) = 3.900e-04 S  per = 0.00862  per(accum) = 85.7
 T(global opt: dvdson [mpi]                ) = 9.505e-06 S  per = 0.00021  per(accum) = 85.7
 T(global opt: dvdson [rest part(linalg)]  ) = 6.475e-01 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.006e+00 S  T(sum) = 1.006e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.388e-03 S  per = 0.237  per(accum) = 0.237
 T(global opt: qops init                    ) = 2.691e-02 S  per = 2.67  per(accum) = 2.91
 T(global opt: symbolic_formulae_renorm     ) = 1.811e-01 S  per =   18  per(accum) = 20.9
 T(global opt: allocate qops on gpu         ) = 7.681e-04 S  per = 0.0763  per(accum) = 21
 T(global opt: site memcpy cpu2gpu          ) = 2.050e-02 S  per = 2.04  per(accum) = 23
 T(global opt: rintermediate init           ) = 3.078e-02 S  per = 3.06  per(accum) = 26.1
 T(global opt: preprocess_formulae_Rlist2   ) = 5.866e-02 S  per = 5.83  per(accum) = 31.9
 T(global opt: rmmtasks init                ) = 1.159e-01 S  per = 11.5  per(accum) = 43.4
 T(global opt: qops memset on cpu           ) = 5.770e-07 S  per = 5.73e-05  per(accum) = 43.4
 T(global opt: preprocess_renorm_batchGPU   ) = 5.161e-01 S  per = 51.3  per(accum) = 94.7
 T(global opt: deallocate cpu and gpu memory) = 1.155e-03 S  per = 0.115  per(accum) = 94.8
 T(global opt: construct opS [ifdists=true] ) = 5.150e-07 S  per = 5.12e-05  per(accum) = 94.8
 T(global opt: reduction of opS & opH [nccl]) = 5.250e-07 S  per = 5.22e-05  per(accum) = 94.8
 T(global opt: qops memcpy gpu2cpu          ) = 2.766e-03 S  per = 0.275  per(accum) = 95.1
 T(global opt: reduction of opS & opH [mpi] ) = 2.443e-04 S  per = 0.0243  per(accum) = 95.1
 T(global opt: qops_pool join and erase     ) = 2.071e-02 S  per = 2.06  per(accum) = 97.2
 T(global opt: conversion from opAB to opPQ ) = 2.838e-02 S  per = 2.82  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-6.074e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=14/seqsize=34 dots=1 dbond=(15,0)-(16,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=6:4.578e-05MB:4.470e-08GB
total mem of comb=770:5.875e-03MB:5.737e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=15,4,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 12 13 14 15
 suppc= 11
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=2,2 size(op)=4:3.052e-05MB size(tot)=124:9.460e-04MB:9.239e-07GB
        per(mem): H:3.23 C:0 S:0 P:0 Q:96.8 
 rqops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2605:0.0199MB:1.94e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.208e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(15,0) fdel=./scratch/sweep/rop(16,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.345e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(2,3,4) nnz=6:4.578e-05MB
qtensor3: wf3 own=1 _data=0x3c5b64b0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=1 dimAll=2
 (23,3):2
 qbond: qcol nsym=2 dimAll=3
 (5,-3):2 (6,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=2 nblocks=8 size=6:4.578e-05MB
### DIAG TIMING: total=1.115e-01 t1=2.249e-05, t2=2.224e-03, t3=2.505e-03, t4=1.067e-01, t5=5.222e-06, t6=1.244e-05, t7=3.388e-06
duration_diagGPU:1.115e-01
duration_diagreduce:9.800e-08
duration_diagtransform:3.400e-07
----- TIMING FOR symbolic_formulae_onedot with size=435 : 7.733e-03 S -----
rank=0 GPUmem(GB): used=1.941e-05 (oper)=1.941e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=435
 no. of hintermediate operators=188
 no. of coefficients=2820:2.151e-02MB:2.101e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.748e-04 S -----
rank=0 GPUmem(GB): used=4.042e-05 (oper,hinter)=1.941e-05,2.101e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.347e-03 S size(H_formulae)=435 size(Hxlst2)=2 T(Hmu/Hxlist)=9.967e-04,3.505e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.373e-03 S size(H_formulae)=435 size(Hxlst)=196 -----
rank=0 GPUmem(GB): used=4.042e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=8.941e-08 batch[need]=1.314e-05 blksize=4 blksize0=0 batchsize=196
rank=0 GPUmem(GB): used=5.365e-05 (oper,hinter,dvdson,batch)=1.941e-05,2.101e-05,8.941e-08,1.314e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=6 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.086e-03,2.467e-03,2.984e-02,1.250e-02,4.590e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=1.080e-03 speed=8.277e-05GB/S T(nccl)=5.618e-06 speed=1.591e-02GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.5e-02 -----
 sigma[inter] counter=67 t=2.5e-03 per=5.5e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=0 t=1.4e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=1 t=1.0e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=2 t=7.4e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=67 i=3 t=7.5e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=67 i=4 t=7.5e-03 per=1.7e+01 cost=5.8e+02 flops=7.7e+04
 sigma[gemm] counter=67 i=5 t=7.5e-03 per=1.7e+01 cost=6.1e+02 flops=8.2e+04
 sigma[gemm] counter=67 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=9.9e+04
 sigma[red] counter=67 t=1.2e-02 per=2.8e+01 cost=1.2e+03 flops=9.4e+04
----- TIMING FOR sigma_tot : t_inter=6.6e-01 t_gemm=2.0e+00 t_reduction=8.0e-01 tot=3.4e+00 -----
 sigma_tot[inter] counter=67 t=6.6e-01 per=1.9e+01 cost=2.5e+06 flops=3.8e+06
 sigma_tot[gemm] counter=67 i=0 t=1.3e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=1 t=1.1e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=2 t=4.9e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=67 i=3 t=4.9e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=67 i=4 t=4.9e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=67 i=5 t=4.9e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=67 total t=2.0e+00 per=5.7e+01 cost=4.3e+06 flops=2.2e+06
 sigma_tot[red] counter=67 t=8.0e-01 per=2.4e+01 cost=1.1e+06 flops=1.4e+06
T(sub)=9.9e-06 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,3.7e-06,1.9e-06,9.1e-07,1.6e-07
settings: ndim=6 neig=1 maxcycle=30 nbuff=4 memory=7e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.309956986587 -1.116e+03  1.797e-03    1     1  4.601e-02 4.601e-02 4.599e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.511e-03,2.516e-03,2.990e-02,1.245e-02,4.639e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=1.506e-03 speed=5.939e-05GB/S T(nccl)=5.631e-06 speed=1.588e-02GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.5e-02 -----
 sigma[inter] counter=68 t=2.5e-03 per=5.6e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=0 t=1.9e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=1 t=1.3e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=2 t=7.6e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=68 i=3 t=7.5e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=68 i=4 t=7.4e-03 per=1.7e+01 cost=5.8e+02 flops=7.8e+04
 sigma[gemm] counter=68 i=5 t=7.4e-03 per=1.7e+01 cost=6.1e+02 flops=8.2e+04
 sigma[gemm] counter=68 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=9.9e+04
 sigma[red] counter=68 t=1.2e-02 per=2.8e+01 cost=1.2e+03 flops=9.5e+04
----- TIMING FOR sigma_tot : t_inter=6.6e-01 t_gemm=2.0e+00 t_reduction=8.2e-01 tot=3.5e+00 -----
 sigma_tot[inter] counter=68 t=6.6e-01 per=1.9e+01 cost=2.5e+06 flops=3.7e+06
 sigma_tot[gemm] counter=68 i=0 t=1.3e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=1 t=1.1e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=2 t=5.0e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=68 i=3 t=5.0e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=68 i=4 t=5.0e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=68 i=5 t=4.9e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=68 total t=2.0e+00 per=5.7e+01 cost=4.3e+06 flops=2.1e+06
 sigma_tot[red] counter=68 t=8.2e-01 per=2.4e+01 cost=1.1e+06 flops=1.4e+06
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.1e-05,3.3e-06,8.7e-07,2.3e-07
    2   0 -    -116.309975579039 -1.859e-05  7.449e-04    2     2  1.059e-01 5.296e-02 4.624e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.408e-03,2.527e-03,3.001e-02,1.238e-02,4.633e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=1.404e-03 speed=6.369e-05GB/S T(nccl)=4.466e-06 speed=2.002e-02GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.5e-02 -----
 sigma[inter] counter=69 t=2.5e-03 per=5.6e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=0 t=1.7e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=1 t=1.3e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=2 t=7.4e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=69 i=3 t=7.5e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=69 i=4 t=7.6e-03 per=1.7e+01 cost=5.8e+02 flops=7.6e+04
 sigma[gemm] counter=69 i=5 t=7.4e-03 per=1.7e+01 cost=6.1e+02 flops=8.2e+04
 sigma[gemm] counter=69 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=9.9e+04
 sigma[red] counter=69 t=1.2e-02 per=2.8e+01 cost=1.2e+03 flops=9.5e+04
----- TIMING FOR sigma_tot : t_inter=6.7e-01 t_gemm=2.0e+00 t_reduction=8.3e-01 tot=3.5e+00 -----
 sigma_tot[inter] counter=69 t=6.7e-01 per=1.9e+01 cost=2.5e+06 flops=3.7e+06
 sigma_tot[gemm] counter=69 i=0 t=1.3e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=1 t=1.1e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=2 t=5.0e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=69 i=3 t=5.0e-01 per=1.4e+01 cost=1.1e+06 flops=2.2e+06
 sigma_tot[gemm] counter=69 i=4 t=5.1e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=69 i=5 t=5.0e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=69 total t=2.0e+00 per=5.7e+01 cost=4.3e+06 flops=2.1e+06
 sigma_tot[red] counter=69 t=8.3e-01 per=2.4e+01 cost=1.1e+06 flops=1.4e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.5e-05,2.9e-06,9.3e-07,2.1e-07
    3   0 -    -116.309976937068 -1.358e-06  2.085e-04    3     3  1.618e-01 5.393e-02 4.630e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.176e-03,2.494e-03,3.031e-02,1.256e-02,4.655e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=1.171e-03 speed=7.632e-05GB/S T(nccl)=4.289e-06 speed=2.085e-02GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=4.5e-02 -----
 sigma[inter] counter=70 t=2.5e-03 per=5.5e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=0 t=1.7e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=1 t=1.3e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=2 t=7.6e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=70 i=3 t=7.6e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=70 i=4 t=7.6e-03 per=1.7e+01 cost=5.8e+02 flops=7.6e+04
 sigma[gemm] counter=70 i=5 t=7.5e-03 per=1.7e+01 cost=6.1e+02 flops=8.1e+04
 sigma[gemm] counter=70 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=9.8e+04
 sigma[red] counter=70 t=1.3e-02 per=2.8e+01 cost=1.2e+03 flops=9.4e+04
----- TIMING FOR sigma_tot : t_inter=6.7e-01 t_gemm=2.0e+00 t_reduction=8.4e-01 tot=3.6e+00 -----
 sigma_tot[inter] counter=70 t=6.7e-01 per=1.9e+01 cost=2.5e+06 flops=3.7e+06
 sigma_tot[gemm] counter=70 i=0 t=1.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=1 t=1.1e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=2 t=5.1e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=70 i=3 t=5.1e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=70 i=4 t=5.1e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=70 i=5 t=5.1e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=70 total t=2.0e+00 per=5.8e+01 cost=4.3e+06 flops=2.1e+06
 sigma_tot[red] counter=70 t=8.4e-01 per=2.4e+01 cost=1.1e+06 flops=1.3e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.3e-05,2.7e-06,8.6e-07,2.0e-07
    4   0 +    -116.309977015224 -7.816e-08  2.696e-05    3     4  2.222e-01 5.555e-02 4.638e-02
TIMING FOR Davidson : 2.222e-01  T(cal/comm/rest)=1.855e-01,3.530e-07,3.670e-02
decomposed t_rest=3.670e-02
 T(sub)    =7.216e-05 per=1.966e-01
 T(precond)=3.650e-02 per=9.947e+01
 T(ortho)  =2.019e-05 per=5.503e-02
 T(xcopy)  =2.245e-06 per=6.118e-03
 T(xnrm2)  =2.820e-06 per=7.685e-03
 T(other)  =9.795e-05 per=2.669e-01
optimized energies: isweep=0 ibond=14 dots=1 e[0]=-116.309977015224 nmvp=4
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.806e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=4 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond14.txt
 qbond: qsuper nsym=4 dimAll=8
 (23,3):2 (25,3):2 (24,4):2 (24,2):2
timing for divide=8.8e-06
timing for compute=1.2e-02
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=8.8e-06,1.2e-02,0.0e+00,4.5e-06,1.3e-05 -----
decimation summary: 8->3 dwt=+0.000e+00 SvN=5.868e-01
 qbond: qkept nsym=2 dimAll=3
 (25,3):2 (24,2):1
----- TIMING for decimation_row(nkr): 1.189e-02 S T(decim/select/formRot)=1.168e-02,1.754e-04,3.312e-05 -----
----- TIMING FOR onedot_decimation: 1.194e-02 S T(wf/decim)=3.810e-05,1.190e-02 -----
ctns::oper_renorm coord=(15,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.368e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=105 : 8.851e-03 S -----
rank=0 GPUmem(GB): used=4.042e-05 (oper)=1.941e-05
rank=0 GPUmem(GB): used=4.046e-05 (oper,site)=1.941e-05,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=188
 no. of coefficients=2820:2.151e-02MB:2.101e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.467e-03 S -----
rank=0 GPUmem(GB): used=6.147e-05 (oper,site,rinter)=1.941e-05,4.470e-08,2.101e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.484e-03 S size(rtasks)=105 size(Rlst2)=4 T(Rmu/Rlist)=1.174e-03,3.099e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.507e-03 S size(rtasks)=105 size(Rlst)=103 -----
rank=0 GPUmem(GB): used=6.147e-05 avail=6.176e+00 total=6.176e+00 batch[need]=6.907e-06 blksize=4 blksize0=0 batchsize=103
rank=0 GPUmem(GB): used=6.838e-05 (oper,site,rinter,batch)=1.941e-05,4.470e-08,2.101e-05,6.907e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=4.552e-04,2.275e-02,1.008e-02
----- TIMING FOR renorm : t_inter=4.5e-04 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.3e-02 -----
 renorm[inter] counter=15 t=4.5e-04 per=1.4e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=0 t=1.6e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=1 t=1.1e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=2 t=1.0e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=3 t=1.0e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=4 t=7.5e-03 per=2.3e+01 cost=1.3e+02 flops=1.7e+04
 renorm[gemm] counter=15 i=5 t=7.6e-03 per=2.3e+01 cost=5.4e+02 flops=7.2e+04
 renorm[gemm] counter=15 i=6 t=7.6e-03 per=2.3e+01 cost=1.0e+03 flops=1.3e+05
 renorm[gemm] counter=15 total t=2.3e-02 per=6.8e+01 cost=1.7e+03 flops=7.5e+04
 renorm[red] counter=15 t=1.0e-02 per=3.0e+01 cost=5.1e+02 flops=5.1e+04
----- TIMING FOR renorm_tot : t_inter=7.9e-02 t_gemm=3.2e-01 t_reduction=1.5e-01 tot=5.5e-01 -----
 renorm_tot[inter] counter=15 t=7.9e-02 per=1.4e+01 cost=5.2e+05 flops=6.6e+06
 renorm_tot[gemm] counter=15 i=0 t=2.0e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=1 t=1.7e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=2 t=1.6e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=3 t=1.6e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=4 t=1.1e-01 per=2.0e+01 cost=2.1e+05 flops=2.0e+06
 renorm_tot[gemm] counter=15 i=5 t=1.1e-01 per=1.9e+01 cost=2.8e+05 flops=2.6e+06
 renorm_tot[gemm] counter=15 i=6 t=1.1e-01 per=1.9e+01 cost=1.4e+06 flops=1.3e+07
 renorm_tot[gemm] counter=15 total t=3.2e-01 per=5.8e+01 cost=1.9e+06 flops=6.0e+06
 renorm_tot[red] counter=15 t=1.5e-01 per=2.7e+01 cost=6.5e+05 flops=4.4e+06
qops.to_cpu: size(tot)=145:1.1e-03MB:1.1e-06GB T(to_cpu)=1.1e-04S speed=1.0e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.0492 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.172e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.281e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.310e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.171e-01 S #####
 T(local opt: fetch) = 1.048e-02 S  per = 2.51  per(accum) = 2.51
 T(local opt: hdiag) = 1.115e-01 S  per = 26.7  per(accum) = 29.2
 T(local opt: dvdsn) = 2.325e-01 S  per = 55.7  per(accum) = 85
 T(local opt: decim) = 1.195e-02 S  per = 2.87  per(accum) = 87.8
 T(local opt: guess) = 5.258e-05 S  per = 0.0126  per(accum) = 87.9
 T(local opt: renrm) = 5.042e-02 S  per = 12.1  per(accum) = 99.9
 T(local opt: save ) = 2.345e-04 S  per = 0.0562  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.325e-01 S  T(sum) = 2.323e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 8.099e-05 S  per = 0.0349  per(accum) = 0.0349
 T(local opt: symbolic_formulae           ) = 7.744e-03 S  per = 3.33  per(accum) = 3.37
 T(local opt: hintermediate init          ) = 1.890e-04 S  per = 0.0814  per(accum) = 3.45
 T(local opt: preprocess_hformulae_Hxlist ) = 1.382e-03 S  per = 0.595  per(accum) = 4.04
 T(local opt: hmmtasks init               ) = 7.038e-04 S  per = 0.303  per(accum) = 4.35
 T(local opt: initial guess for dvdson    ) = 2.279e-06 S  per = 0.000981  per(accum) = 4.35
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.804e-01 S  per = 77.6  per(accum) = 82
 T(local opt: dvdson [cpu-gpu]            ) = 5.161e-03 S  per = 2.22  per(accum) = 84.2
 T(local opt: dvdson [nccl]               ) = 2.000e-05 S  per = 0.00861  per(accum) = 84.2
 T(local opt: dvdson [mpi]                ) = 3.530e-07 S  per = 0.000152  per(accum) = 84.2
 T(local opt: dvdson [rest part(linalg)]  ) = 3.670e-02 S  per = 15.8  per(accum) = 100
Detailed decomposition of T(renrm) = 5.042e-02 S  T(sum) = 5.042e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.177e-05 S  per = 0.103  per(accum) = 0.103
 T(local opt: qops init                    ) = 1.081e-03 S  per = 2.14  per(accum) = 2.25
 T(local opt: symbolic_formulae_renorm     ) = 8.865e-03 S  per = 17.6  per(accum) = 19.8
 T(local opt: allocate qops on gpu         ) = 4.814e-05 S  per = 0.0955  per(accum) = 19.9
 T(local opt: site memcpy cpu2gpu          ) = 1.127e-03 S  per = 2.23  per(accum) = 22.2
 T(local opt: rintermediate init           ) = 2.477e-03 S  per = 4.91  per(accum) = 27.1
 T(local opt: preprocess_formulae_Rlist2   ) = 1.514e-03 S  per =    3  per(accum) = 30.1
 T(local opt: rmmtasks init                ) = 5.091e-04 S  per = 1.01  per(accum) = 31.1
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 8.53e-05  per(accum) = 31.1
 T(local opt: preprocess_renorm_batchGPU   ) = 3.337e-02 S  per = 66.2  per(accum) = 97.3
 T(local opt: deallocate cpu and gpu memory) = 3.119e-05 S  per = 0.0619  per(accum) = 97.3
 T(local opt: construct opS [ifdists=true] ) = 2.900e-08 S  per = 5.75e-05  per(accum) = 97.3
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 7.54e-05  per(accum) = 97.3
 T(local opt: qops memcpy gpu2cpu          ) = 1.151e-04 S  per = 0.228  per(accum) = 97.6
 T(local opt: reduction of opS & opH [mpi] ) = 1.530e-05 S  per = 0.0303  per(accum) = 97.6
 T(local opt: qops_pool join and erase     ) = 1.213e-03 S  per = 2.41  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.494e-06 S  per = 0.00296  per(accum) = 100
##### sweep opt: 9.273e+00 S #####
 T(sweep opt: fetch) = 1.807e-01 S  per = 1.95  per(accum) = 1.95
 T(sweep opt: hdiag) = 3.107e+00 S  per = 33.5  per(accum) = 35.5
 T(sweep opt: dvdsn) = 4.761e+00 S  per = 51.3  per(accum) = 86.8
 T(sweep opt: decim) = 1.630e-01 S  per = 1.76  per(accum) = 88.6
 T(sweep opt: guess) = 1.216e-03 S  per = 0.0131  per(accum) = 88.6
 T(sweep opt: renrm) = 1.057e+00 S  per = 11.4  per(accum) = 100
 T(sweep opt: save ) = 3.667e-03 S  per = 0.0395  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.761e+00 S  T(sum) = 4.756e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 1.552e-03 S  per = 0.0326  per(accum) = 0.0326
 T(sweep opt: symbolic_formulae           ) = 2.085e-01 S  per = 4.38  per(accum) = 4.42
 T(sweep opt: hintermediate init          ) = 5.406e-03 S  per = 0.114  per(accum) = 4.53
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.743e-02 S  per = 1.42  per(accum) = 5.95
 T(sweep opt: hmmtasks init               ) = 1.269e-01 S  per = 2.67  per(accum) = 8.62
 T(sweep opt: initial guess for dvdson    ) = 5.785e-05 S  per = 0.00122  per(accum) = 8.62
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.568e+00 S  per =   75  per(accum) = 83.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 9.344e-02 S  per = 1.96  per(accum) = 85.6
 T(sweep opt: dvdson [nccl]               ) = 4.100e-04 S  per = 0.00862  per(accum) = 85.6
 T(sweep opt: dvdson [mpi]                ) = 9.858e-06 S  per = 0.000207  per(accum) = 85.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.842e-01 S  per = 14.4  per(accum) = 100
Detailed decomposition of T(renrm) = 1.057e+00 S  T(sum) = 1.057e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.440e-03 S  per = 0.231  per(accum) = 0.231
 T(sweep opt: qops init                    ) = 2.799e-02 S  per = 2.65  per(accum) = 2.88
 T(sweep opt: symbolic_formulae_renorm     ) = 1.899e-01 S  per =   18  per(accum) = 20.9
 T(sweep opt: allocate qops on gpu         ) = 8.162e-04 S  per = 0.0772  per(accum) = 20.9
 T(sweep opt: site memcpy cpu2gpu          ) = 2.163e-02 S  per = 2.05  per(accum) = 23
 T(sweep opt: rintermediate init           ) = 3.325e-02 S  per = 3.15  per(accum) = 26.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.017e-02 S  per = 5.69  per(accum) = 31.8
 T(sweep opt: rmmtasks init                ) = 1.164e-01 S  per =   11  per(accum) = 42.8
 T(sweep opt: qops memset on cpu           ) = 6.200e-07 S  per = 5.87e-05  per(accum) = 42.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.495e-01 S  per =   52  per(accum) = 94.8
 T(sweep opt: deallocate cpu and gpu memory) = 1.186e-03 S  per = 0.112  per(accum) = 94.9
 T(sweep opt: construct opS [ifdists=true] ) = 5.440e-07 S  per = 5.15e-05  per(accum) = 94.9
 T(sweep opt: reduction of opS & opH [nccl]) = 5.630e-07 S  per = 5.33e-05  per(accum) = 94.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.881e-03 S  per = 0.273  per(accum) = 95.2
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.596e-04 S  per = 0.0246  per(accum) = 95.2
 T(sweep opt: qops_pool join and erase     ) = 2.192e-02 S  per = 2.07  per(accum) = 97.3
 T(sweep opt: conversion from opAB to opPQ ) = 2.838e-02 S  per = 2.69  per(accum) = 100
##### global opt: 9.273e+00 S #####
 T(global opt: fetch) = 1.807e-01 S  per = 1.95  per(accum) = 1.95
 T(global opt: hdiag) = 3.107e+00 S  per = 33.5  per(accum) = 35.5
 T(global opt: dvdsn) = 4.761e+00 S  per = 51.3  per(accum) = 86.8
 T(global opt: decim) = 1.630e-01 S  per = 1.76  per(accum) = 88.6
 T(global opt: guess) = 1.216e-03 S  per = 0.0131  per(accum) = 88.6
 T(global opt: renrm) = 1.057e+00 S  per = 11.4  per(accum) = 100
 T(global opt: save ) = 3.667e-03 S  per = 0.0395  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.761e+00 S  T(sum) = 4.756e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 1.552e-03 S  per = 0.0326  per(accum) = 0.0326
 T(global opt: symbolic_formulae           ) = 2.085e-01 S  per = 4.38  per(accum) = 4.42
 T(global opt: hintermediate init          ) = 5.406e-03 S  per = 0.114  per(accum) = 4.53
 T(global opt: preprocess_hformulae_Hxlist ) = 6.743e-02 S  per = 1.42  per(accum) = 5.95
 T(global opt: hmmtasks init               ) = 1.269e-01 S  per = 2.67  per(accum) = 8.62
 T(global opt: initial guess for dvdson    ) = 5.785e-05 S  per = 0.00122  per(accum) = 8.62
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.568e+00 S  per =   75  per(accum) = 83.6
 T(global opt: dvdson [cpu-gpu]            ) = 9.344e-02 S  per = 1.96  per(accum) = 85.6
 T(global opt: dvdson [nccl]               ) = 4.100e-04 S  per = 0.00862  per(accum) = 85.6
 T(global opt: dvdson [mpi]                ) = 9.858e-06 S  per = 0.000207  per(accum) = 85.6
 T(global opt: dvdson [rest part(linalg)]  ) = 6.842e-01 S  per = 14.4  per(accum) = 100
Detailed decomposition of T(renrm) = 1.057e+00 S  T(sum) = 1.057e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.440e-03 S  per = 0.231  per(accum) = 0.231
 T(global opt: qops init                    ) = 2.799e-02 S  per = 2.65  per(accum) = 2.88
 T(global opt: symbolic_formulae_renorm     ) = 1.899e-01 S  per =   18  per(accum) = 20.9
 T(global opt: allocate qops on gpu         ) = 8.162e-04 S  per = 0.0772  per(accum) = 20.9
 T(global opt: site memcpy cpu2gpu          ) = 2.163e-02 S  per = 2.05  per(accum) = 23
 T(global opt: rintermediate init           ) = 3.325e-02 S  per = 3.15  per(accum) = 26.1
 T(global opt: preprocess_formulae_Rlist2   ) = 6.017e-02 S  per = 5.69  per(accum) = 31.8
 T(global opt: rmmtasks init                ) = 1.164e-01 S  per =   11  per(accum) = 42.8
 T(global opt: qops memset on cpu           ) = 6.200e-07 S  per = 5.87e-05  per(accum) = 42.8
 T(global opt: preprocess_renorm_batchGPU   ) = 5.495e-01 S  per =   52  per(accum) = 94.8
 T(global opt: deallocate cpu and gpu memory) = 1.186e-03 S  per = 0.112  per(accum) = 94.9
 T(global opt: construct opS [ifdists=true] ) = 5.440e-07 S  per = 5.15e-05  per(accum) = 94.9
 T(global opt: reduction of opS & opH [nccl]) = 5.630e-07 S  per = 5.33e-05  per(accum) = 94.9
 T(global opt: qops memcpy gpu2cpu          ) = 2.881e-03 S  per = 0.273  per(accum) = 95.2
 T(global opt: reduction of opS & opH [mpi] ) = 2.596e-04 S  per = 0.0246  per(accum) = 95.2
 T(global opt: qops_pool join and erase     ) = 2.192e-02 S  per = 2.07  per(accum) = 97.3
 T(global opt: conversion from opAB to opPQ ) = 2.838e-02 S  per = 2.69  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.779e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=15/seqsize=34 dots=1 dbond=(16,0)-(17,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=8:6.104e-05MB:5.960e-08GB
total mem of comb=772:5.890e-03MB:5.752e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=16,3,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 13 14 15
 suppc= 12
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
 rqops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=105:0.000801MB:7.82e-07GB
        per(mem): H:4.76 C:5.71 S:32.4 A:0 B:57.1 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2586:0.0197MB:1.93e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.090e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(16,0) fdel=./scratch/sweep/rop(17,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-4.768e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(3,3,4) nnz=8:6.104e-05MB
qtensor3: wf3 own=1 _data=0x3a6fd8c0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=3
 (25,3):2 (24,2):1
 qbond: qcol nsym=2 dimAll=3
 (4,-2):2 (3,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=16 size=8:6.104e-05MB
### DIAG TIMING: total=5.823e-02 t1=2.255e-05, t2=2.271e-03, t3=2.548e-03, t4=5.337e-02, t5=4.697e-06, t6=1.376e-05, t7=3.295e-06
duration_diagGPU:5.824e-02
duration_diagreduce:6.300e-08
duration_diagtransform:3.800e-07
----- TIMING FOR symbolic_formulae_onedot with size=297 : 5.036e-03 S -----
rank=0 GPUmem(GB): used=1.927e-05 (oper)=1.927e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=297
 no. of hintermediate operators=114
 no. of coefficients=1824:1.392e-02MB:1.359e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.190e-04 S -----
rank=0 GPUmem(GB): used=3.286e-05 (oper,hinter)=1.927e-05,1.359e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.091e-03 S size(H_formulae)=297 size(Hxlst2)=3 T(Hmu/Hxlist)=6.393e-04,4.519e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.137e-03 S size(H_formulae)=297 size(Hxlst)=318 -----
rank=0 GPUmem(GB): used=3.286e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.192e-07 batch[need]=2.606e-05 blksize=4 blksize0=2 batchsize=318
rank=0 GPUmem(GB): used=5.904e-05 (oper,hinter,dvdson,batch)=1.927e-05,1.359e-05,1.192e-07,2.606e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=8 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.968e-03,1.001e-02,2.988e-02,1.234e-02,5.421e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.963e-03 speed=6.074e-05GB/S T(nccl)=4.916e-06 speed=2.425e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=71 t=1.0e-02 per=1.9e+01 cost=3.8e+03 flops=3.8e+05
 sigma[gemm] counter=71 i=0 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=1 t=1.0e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=2 t=7.4e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=71 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=71 i=4 t=7.5e-03 per=1.4e+01 cost=9.7e+02 flops=1.3e+05
 sigma[gemm] counter=71 i=5 t=7.5e-03 per=1.4e+01 cost=8.7e+02 flops=1.2e+05
 sigma[gemm] counter=71 total t=3.0e-02 per=5.7e+01 cost=4.2e+03 flops=1.4e+05
 sigma[red] counter=71 t=1.2e-02 per=2.4e+01 cost=1.7e+03 flops=1.4e+05
----- TIMING FOR sigma_tot : t_inter=6.8e-01 t_gemm=2.1e+00 t_reduction=8.5e-01 tot=3.6e+00 -----
 sigma_tot[inter] counter=71 t=6.8e-01 per=1.9e+01 cost=2.5e+06 flops=3.7e+06
 sigma_tot[gemm] counter=71 i=0 t=1.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=1 t=1.2e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=2 t=5.2e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=71 i=3 t=5.2e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=71 i=4 t=5.2e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=71 i=5 t=5.2e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=71 total t=2.1e+00 per=5.8e+01 cost=4.3e+06 flops=2.1e+06
 sigma_tot[red] counter=71 t=8.5e-01 per=2.4e+01 cost=1.1e+06 flops=1.3e+06
T(sub)=8.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.3e-06,3.7e-06,1.8e-06,6.6e-07,1.4e-07
settings: ndim=8 neig=1 maxcycle=30 nbuff=4 memory=9e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.309977015224 -1.116e+03  1.746e-02    1     1  5.431e-02 5.431e-02 5.429e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.252e-03,9.901e-03,2.974e-02,1.230e-02,5.320e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.247e-03 speed=9.559e-05GB/S T(nccl)=4.498e-06 speed=2.650e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=72 t=9.9e-03 per=1.9e+01 cost=3.8e+03 flops=3.9e+05
 sigma[gemm] counter=72 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=2 t=7.4e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=72 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=72 i=4 t=7.4e-03 per=1.4e+01 cost=9.7e+02 flops=1.3e+05
 sigma[gemm] counter=72 i=5 t=7.4e-03 per=1.4e+01 cost=8.7e+02 flops=1.2e+05
 sigma[gemm] counter=72 total t=3.0e-02 per=5.7e+01 cost=4.2e+03 flops=1.4e+05
 sigma[red] counter=72 t=1.2e-02 per=2.4e+01 cost=1.7e+03 flops=1.4e+05
----- TIMING FOR sigma_tot : t_inter=6.9e-01 t_gemm=2.1e+00 t_reduction=8.7e-01 tot=3.7e+00 -----
 sigma_tot[inter] counter=72 t=6.9e-01 per=1.9e+01 cost=2.5e+06 flops=3.6e+06
 sigma_tot[gemm] counter=72 i=0 t=1.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=1 t=1.2e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=2 t=5.3e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=72 i=3 t=5.3e-01 per=1.4e+01 cost=1.1e+06 flops=2.1e+06
 sigma_tot[gemm] counter=72 i=4 t=5.3e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=72 i=5 t=5.2e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=72 total t=2.1e+00 per=5.8e+01 cost=4.3e+06 flops=2.0e+06
 sigma_tot[red] counter=72 t=8.7e-01 per=2.4e+01 cost=1.1e+06 flops=1.3e+06
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,9.5e-06,3.0e-06,8.6e-07,1.5e-07
    2   0 -    -116.311757695462 -1.781e-03  5.344e-03    2     2  1.171e-01 5.857e-02 5.379e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.297e-03,1.000e-02,3.001e-02,1.247e-02,5.379e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.292e-03 speed=9.225e-05GB/S T(nccl)=4.436e-06 speed=2.687e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=73 t=1.0e-02 per=1.9e+01 cost=3.8e+03 flops=3.8e+05
 sigma[gemm] counter=73 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=2 t=7.4e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=73 i=3 t=7.6e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=73 i=4 t=7.5e-03 per=1.4e+01 cost=9.7e+02 flops=1.3e+05
 sigma[gemm] counter=73 i=5 t=7.5e-03 per=1.4e+01 cost=8.7e+02 flops=1.1e+05
 sigma[gemm] counter=73 total t=3.0e-02 per=5.7e+01 cost=4.2e+03 flops=1.4e+05
 sigma[red] counter=73 t=1.2e-02 per=2.4e+01 cost=1.7e+03 flops=1.4e+05
----- TIMING FOR sigma_tot : t_inter=7.0e-01 t_gemm=2.1e+00 t_reduction=8.8e-01 tot=3.7e+00 -----
 sigma_tot[inter] counter=73 t=7.0e-01 per=1.9e+01 cost=2.5e+06 flops=3.6e+06
 sigma_tot[gemm] counter=73 i=0 t=1.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=1 t=1.2e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=2 t=5.3e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=73 i=3 t=5.3e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=73 i=4 t=5.4e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=73 i=5 t=5.3e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=73 total t=2.1e+00 per=5.8e+01 cost=4.3e+06 flops=2.0e+06
 sigma_tot[red] counter=73 t=8.8e-01 per=2.4e+01 cost=1.1e+06 flops=1.3e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,1.3e-05,2.6e-06,8.2e-07,1.7e-07
    3   0 -    -116.311849054852 -9.136e-05  1.544e-03    3     3  1.805e-01 6.018e-02 5.382e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.534e-03,9.932e-03,2.990e-02,1.257e-02,5.394e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.530e-03 speed=7.794e-05GB/S T(nccl)=4.268e-06 speed=2.793e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=74 t=9.9e-03 per=1.9e+01 cost=3.8e+03 flops=3.9e+05
 sigma[gemm] counter=74 i=0 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=2 t=7.4e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=74 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=74 i=4 t=7.5e-03 per=1.4e+01 cost=9.7e+02 flops=1.3e+05
 sigma[gemm] counter=74 i=5 t=7.5e-03 per=1.4e+01 cost=8.7e+02 flops=1.2e+05
 sigma[gemm] counter=74 total t=3.0e-02 per=5.7e+01 cost=4.2e+03 flops=1.4e+05
 sigma[red] counter=74 t=1.3e-02 per=2.4e+01 cost=1.7e+03 flops=1.3e+05
----- TIMING FOR sigma_tot : t_inter=7.1e-01 t_gemm=2.2e+00 t_reduction=8.9e-01 tot=3.8e+00 -----
 sigma_tot[inter] counter=74 t=7.1e-01 per=1.9e+01 cost=2.5e+06 flops=3.5e+06
 sigma_tot[gemm] counter=74 i=0 t=1.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=1 t=1.2e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=2 t=5.4e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=74 i=3 t=5.4e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=74 i=4 t=5.4e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=74 i=5 t=5.4e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=74 total t=2.2e+00 per=5.8e+01 cost=4.3e+06 flops=2.0e+06
 sigma_tot[red] counter=74 t=8.9e-01 per=2.4e+01 cost=1.1e+06 flops=1.3e+06
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,1.2e-05,2.6e-06,8.0e-07,1.6e-07
    4   0 -    -116.311856283844 -7.229e-06  4.687e-04    3     4  2.480e-01 6.200e-02 5.387e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.412e-03,9.968e-03,2.989e-02,1.245e-02,5.373e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=1.408e-03 speed=8.469e-05GB/S T(nccl)=4.338e-06 speed=2.748e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=75 t=1.0e-02 per=1.9e+01 cost=3.8e+03 flops=3.9e+05
 sigma[gemm] counter=75 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=2 t=7.6e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=75 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+03 flops=1.6e+05
 sigma[gemm] counter=75 i=4 t=7.4e-03 per=1.4e+01 cost=9.7e+02 flops=1.3e+05
 sigma[gemm] counter=75 i=5 t=7.4e-03 per=1.4e+01 cost=8.7e+02 flops=1.2e+05
 sigma[gemm] counter=75 total t=3.0e-02 per=5.7e+01 cost=4.2e+03 flops=1.4e+05
 sigma[red] counter=75 t=1.2e-02 per=2.4e+01 cost=1.7e+03 flops=1.4e+05
----- TIMING FOR sigma_tot : t_inter=7.2e-01 t_gemm=2.2e+00 t_reduction=9.0e-01 tot=3.8e+00 -----
 sigma_tot[inter] counter=75 t=7.2e-01 per=1.9e+01 cost=2.5e+06 flops=3.5e+06
 sigma_tot[gemm] counter=75 i=0 t=1.4e-04 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=1 t=1.2e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=2 t=5.5e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=75 i=3 t=5.5e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=75 i=4 t=5.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=75 i=5 t=5.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=75 total t=2.2e+00 per=5.8e+01 cost=4.3e+06 flops=2.0e+06
 sigma_tot[red] counter=75 t=9.0e-01 per=2.4e+01 cost=1.1e+06 flops=1.3e+06
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,1.2e-05,2.7e-06,8.6e-07,1.5e-07
    5   0 +    -116.311856917920 -6.341e-07  9.866e-05    3     5  3.112e-01 6.224e-02 5.386e-02
TIMING FOR Davidson : 3.112e-01  T(cal/comm/rest)=2.693e-01,4.760e-07,4.189e-02
decomposed t_rest=4.189e-02
 T(sub)    =8.371e-05 per=1.998e-01
 T(precond)=4.168e-02 per=9.948e+01
 T(ortho)  =1.370e-05 per=3.269e-02
 T(xcopy)  =6.510e-07 per=1.554e-03
 T(xnrm2)  =1.857e-06 per=4.433e-03
 T(other)  =1.181e-04 per=2.819e-01
optimized energies: isweep=0 ibond=15 dots=1 e[0]=-116.311856917920 nmvp=5
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=3.084e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond15.txt
 qbond: qsuper nsym=6 dimAll=12
 (25,3):3 (27,3):2 (26,4):2 (26,2):3 (24,2):1 (25,1):1
timing for divide=9.1e-06
timing for compute=1.1e-02
timing for collect=1.1e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=9.1e-06,1.1e-02,0.0e+00,4.2e-06,1.1e-05 -----
decimation summary: 12->3 dwt=+1.110e-16 SvN=8.235e-01
 qbond: qkept nsym=2 dimAll=3
 (26,2):2 (27,3):1
----- TIMING for decimation_row(nkr): 1.174e-02 S T(decim/select/formRot)=1.156e-02,1.617e-04,1.734e-05 -----
----- TIMING FOR onedot_decimation: 1.178e-02 S T(wf/decim)=3.640e-05,1.175e-02 -----
ctns::oper_renorm coord=(16,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=105:8.011e-04MB:7.823e-07GB
        per(mem): H:4.76 C:32.4 S:5.71 P:0 Q:57.1 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.280e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 5.504e-03 S -----
rank=0 GPUmem(GB): used=3.286e-05 (oper)=1.927e-05
rank=0 GPUmem(GB): used=3.292e-05 (oper,site)=1.927e-05,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=114
 no. of coefficients=1824:1.392e-02MB:1.359e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.476e-03 S -----
rank=0 GPUmem(GB): used=4.651e-05 (oper,site,rinter)=1.927e-05,5.960e-08,1.359e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.076e-03 S size(rtasks)=77 size(Rlst2)=4 T(Rmu/Rlist)=7.481e-04,3.279e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.107e-03 S size(rtasks)=77 size(Rlst)=184 -----
rank=0 GPUmem(GB): used=4.651e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.508e-05 blksize=4 blksize0=2 batchsize=184
rank=0 GPUmem(GB): used=6.159e-05 (oper,site,rinter,batch)=1.927e-05,5.960e-08,1.359e-05,1.508e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.983e-03,2.242e-02,9.950e-03
----- TIMING FOR renorm : t_inter=8.0e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=4.0e-02 -----
 renorm[inter] counter=16 t=8.0e-03 per=2.0e+01 cost=1.9e+03 flops=2.4e+05
 renorm[gemm] counter=16 i=0 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=2 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=4 t=7.5e-03 per=1.9e+01 cost=3.5e+02 flops=4.6e+04
 renorm[gemm] counter=16 i=5 t=7.5e-03 per=1.8e+01 cost=7.8e+02 flops=1.0e+05
 renorm[gemm] counter=16 i=6 t=7.5e-03 per=1.8e+01 cost=1.8e+03 flops=2.4e+05
 renorm[gemm] counter=16 total t=2.2e-02 per=5.6e+01 cost=2.9e+03 flops=1.3e+05
 renorm[red] counter=16 t=9.9e-03 per=2.5e+01 cost=1.2e+03 flops=1.2e+05
----- TIMING FOR renorm_tot : t_inter=8.7e-02 t_gemm=3.4e-01 t_reduction=1.6e-01 tot=5.9e-01 -----
 renorm_tot[inter] counter=16 t=8.7e-02 per=1.5e+01 cost=5.2e+05 flops=6.0e+06
 renorm_tot[gemm] counter=16 i=0 t=2.1e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=1 t=1.8e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=2 t=1.7e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=3 t=1.7e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=4 t=1.1e-01 per=1.9e+01 cost=2.1e+05 flops=1.8e+06
 renorm_tot[gemm] counter=16 i=5 t=1.1e-01 per=1.9e+01 cost=2.8e+05 flops=2.5e+06
 renorm_tot[gemm] counter=16 i=6 t=1.1e-01 per=1.9e+01 cost=1.4e+06 flops=1.2e+07
 renorm_tot[gemm] counter=16 total t=3.4e-01 per=5.8e+01 cost=1.9e+06 flops=5.6e+06
 renorm_tot[red] counter=16 t=1.6e-01 per=2.7e+01 cost=6.5e+05 flops=4.1e+06
qops.to_cpu: size(tot)=105:8.0e-04MB:7.8e-07GB T(to_cpu)=8.7e-05S speed=9.0e-03GB/S
check ||H-H.dagger||=6.280e-16 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.0523 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.396e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.186e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-3.353e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.534e-01 S #####
 T(local opt: fetch) = 1.070e-02 S  per = 2.36  per(accum) = 2.36
 T(local opt: hdiag) = 5.827e-02 S  per = 12.9  per(accum) = 15.2
 T(local opt: dvdsn) = 3.190e-01 S  per = 70.4  per(accum) = 85.6
 T(local opt: decim) = 1.179e-02 S  per =  2.6  per(accum) = 88.2
 T(local opt: guess) = 5.654e-05 S  per = 0.0125  per(accum) = 88.2
 T(local opt: renrm) = 5.333e-02 S  per = 11.8  per(accum) = 100
 T(local opt: save ) = 2.009e-04 S  per = 0.0443  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.190e-01 S  T(sum) = 3.189e-01 S  per = 9.995e+01
 T(local opt: preprocess                  ) = 7.454e-05 S  per = 0.0234  per(accum) = 0.0234
 T(local opt: symbolic_formulae           ) = 5.045e-03 S  per = 1.58  per(accum) = 1.61
 T(local opt: hintermediate init          ) = 1.325e-04 S  per = 0.0415  per(accum) = 1.65
 T(local opt: preprocess_hformulae_Hxlist ) = 1.149e-03 S  per = 0.36  per(accum) = 2.01
 T(local opt: hmmtasks init               ) = 1.286e-03 S  per = 0.403  per(accum) = 2.41
 T(local opt: initial guess for dvdson    ) = 2.337e-06 S  per = 0.000733  per(accum) = 2.41
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.618e-01 S  per = 82.1  per(accum) = 84.5
 T(local opt: dvdson [cpu-gpu]            ) = 7.439e-03 S  per = 2.33  per(accum) = 86.9
 T(local opt: dvdson [nccl]               ) = 2.246e-05 S  per = 0.00704  per(accum) = 86.9
 T(local opt: dvdson [mpi]                ) = 4.760e-07 S  per = 0.000149  per(accum) = 86.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.189e-02 S  per = 13.1  per(accum) = 100
Detailed decomposition of T(renrm) = 5.333e-02 S  T(sum) = 5.333e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.992e-05 S  per = 0.112  per(accum) = 0.112
 T(local opt: qops init                    ) = 7.682e-04 S  per = 1.44  per(accum) = 1.55
 T(local opt: symbolic_formulae_renorm     ) = 5.518e-03 S  per = 10.3  per(accum) = 11.9
 T(local opt: allocate qops on gpu         ) = 4.749e-05 S  per = 0.0891  per(accum) = 12
 T(local opt: site memcpy cpu2gpu          ) = 7.711e-04 S  per = 1.45  per(accum) = 13.4
 T(local opt: rintermediate init           ) = 2.486e-03 S  per = 4.66  per(accum) = 18.1
 T(local opt: preprocess_formulae_Rlist2   ) = 1.118e-03 S  per =  2.1  per(accum) = 20.2
 T(local opt: rmmtasks init                ) = 1.014e-03 S  per =  1.9  per(accum) = 22.1
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 6.38e-05  per(accum) = 22.1
 T(local opt: preprocess_renorm_batchGPU   ) = 4.043e-02 S  per = 75.8  per(accum) = 97.9
 T(local opt: deallocate cpu and gpu memory) = 2.599e-05 S  per = 0.0487  per(accum) = 98
 T(local opt: construct opS [ifdists=true] ) = 2.700e-08 S  per = 5.06e-05  per(accum) = 98
 T(local opt: reduction of opS & opH [nccl]) = 3.100e-08 S  per = 5.81e-05  per(accum) = 98
 T(local opt: qops memcpy gpu2cpu          ) = 9.296e-05 S  per = 0.174  per(accum) = 98.1
 T(local opt: reduction of opS & opH [mpi] ) = 1.425e-05 S  per = 0.0267  per(accum) = 98.2
 T(local opt: qops_pool join and erase     ) = 9.759e-04 S  per = 1.83  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.421e-06 S  per = 0.00266  per(accum) = 100
##### sweep opt: 9.727e+00 S #####
 T(sweep opt: fetch) = 1.914e-01 S  per = 1.97  per(accum) = 1.97
 T(sweep opt: hdiag) = 3.166e+00 S  per = 32.5  per(accum) = 34.5
 T(sweep opt: dvdsn) = 5.080e+00 S  per = 52.2  per(accum) = 86.7
 T(sweep opt: decim) = 1.748e-01 S  per =  1.8  per(accum) = 88.5
 T(sweep opt: guess) = 1.272e-03 S  per = 0.0131  per(accum) = 88.5
 T(sweep opt: renrm) = 1.110e+00 S  per = 11.4  per(accum) = 100
 T(sweep opt: save ) = 3.868e-03 S  per = 0.0398  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.080e+00 S  T(sum) = 5.075e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 1.627e-03 S  per = 0.0321  per(accum) = 0.0321
 T(sweep opt: symbolic_formulae           ) = 2.135e-01 S  per = 4.21  per(accum) = 4.24
 T(sweep opt: hintermediate init          ) = 5.539e-03 S  per = 0.109  per(accum) = 4.35
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.858e-02 S  per = 1.35  per(accum) = 5.7
 T(sweep opt: hmmtasks init               ) = 1.282e-01 S  per = 2.53  per(accum) = 8.23
 T(sweep opt: initial guess for dvdson    ) = 6.019e-05 S  per = 0.00119  per(accum) = 8.23
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.830e+00 S  per = 75.5  per(accum) = 83.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.009e-01 S  per = 1.99  per(accum) = 85.7
 T(sweep opt: dvdson [nccl]               ) = 4.325e-04 S  per = 0.00852  per(accum) = 85.7
 T(sweep opt: dvdson [mpi]                ) = 1.033e-05 S  per = 0.000204  per(accum) = 85.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.261e-01 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.110e+00 S  T(sum) = 1.110e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.499e-03 S  per = 0.225  per(accum) = 0.225
 T(sweep opt: qops init                    ) = 2.876e-02 S  per = 2.59  per(accum) = 2.82
 T(sweep opt: symbolic_formulae_renorm     ) = 1.955e-01 S  per = 17.6  per(accum) = 20.4
 T(sweep opt: allocate qops on gpu         ) = 8.637e-04 S  per = 0.0778  per(accum) = 20.5
 T(sweep opt: site memcpy cpu2gpu          ) = 2.240e-02 S  per = 2.02  per(accum) = 22.5
 T(sweep opt: rintermediate init           ) = 3.574e-02 S  per = 3.22  per(accum) = 25.7
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.129e-02 S  per = 5.52  per(accum) = 31.3
 T(sweep opt: rmmtasks init                ) = 1.174e-01 S  per = 10.6  per(accum) = 41.8
 T(sweep opt: qops memset on cpu           ) = 6.540e-07 S  per = 5.89e-05  per(accum) = 41.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.899e-01 S  per = 53.1  per(accum) = 95
 T(sweep opt: deallocate cpu and gpu memory) = 1.212e-03 S  per = 0.109  per(accum) = 95.1
 T(sweep opt: construct opS [ifdists=true] ) = 5.710e-07 S  per = 5.14e-05  per(accum) = 95.1
 T(sweep opt: reduction of opS & opH [nccl]) = 5.940e-07 S  per = 5.35e-05  per(accum) = 95.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.974e-03 S  per = 0.268  per(accum) = 95.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.738e-04 S  per = 0.0247  per(accum) = 95.4
 T(sweep opt: qops_pool join and erase     ) = 2.290e-02 S  per = 2.06  per(accum) = 97.4
 T(sweep opt: conversion from opAB to opPQ ) = 2.838e-02 S  per = 2.56  per(accum) = 100
##### global opt: 9.727e+00 S #####
 T(global opt: fetch) = 1.914e-01 S  per = 1.97  per(accum) = 1.97
 T(global opt: hdiag) = 3.166e+00 S  per = 32.5  per(accum) = 34.5
 T(global opt: dvdsn) = 5.080e+00 S  per = 52.2  per(accum) = 86.7
 T(global opt: decim) = 1.748e-01 S  per =  1.8  per(accum) = 88.5
 T(global opt: guess) = 1.272e-03 S  per = 0.0131  per(accum) = 88.5
 T(global opt: renrm) = 1.110e+00 S  per = 11.4  per(accum) = 100
 T(global opt: save ) = 3.868e-03 S  per = 0.0398  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.080e+00 S  T(sum) = 5.075e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 1.627e-03 S  per = 0.0321  per(accum) = 0.0321
 T(global opt: symbolic_formulae           ) = 2.135e-01 S  per = 4.21  per(accum) = 4.24
 T(global opt: hintermediate init          ) = 5.539e-03 S  per = 0.109  per(accum) = 4.35
 T(global opt: preprocess_hformulae_Hxlist ) = 6.858e-02 S  per = 1.35  per(accum) = 5.7
 T(global opt: hmmtasks init               ) = 1.282e-01 S  per = 2.53  per(accum) = 8.23
 T(global opt: initial guess for dvdson    ) = 6.019e-05 S  per = 0.00119  per(accum) = 8.23
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.830e+00 S  per = 75.5  per(accum) = 83.7
 T(global opt: dvdson [cpu-gpu]            ) = 1.009e-01 S  per = 1.99  per(accum) = 85.7
 T(global opt: dvdson [nccl]               ) = 4.325e-04 S  per = 0.00852  per(accum) = 85.7
 T(global opt: dvdson [mpi]                ) = 1.033e-05 S  per = 0.000204  per(accum) = 85.7
 T(global opt: dvdson [rest part(linalg)]  ) = 7.261e-01 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.110e+00 S  T(sum) = 1.110e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.499e-03 S  per = 0.225  per(accum) = 0.225
 T(global opt: qops init                    ) = 2.876e-02 S  per = 2.59  per(accum) = 2.82
 T(global opt: symbolic_formulae_renorm     ) = 1.955e-01 S  per = 17.6  per(accum) = 20.4
 T(global opt: allocate qops on gpu         ) = 8.637e-04 S  per = 0.0778  per(accum) = 20.5
 T(global opt: site memcpy cpu2gpu          ) = 2.240e-02 S  per = 2.02  per(accum) = 22.5
 T(global opt: rintermediate init           ) = 3.574e-02 S  per = 3.22  per(accum) = 25.7
 T(global opt: preprocess_formulae_Rlist2   ) = 6.129e-02 S  per = 5.52  per(accum) = 31.3
 T(global opt: rmmtasks init                ) = 1.174e-01 S  per = 10.6  per(accum) = 41.8
 T(global opt: qops memset on cpu           ) = 6.540e-07 S  per = 5.89e-05  per(accum) = 41.8
 T(global opt: preprocess_renorm_batchGPU   ) = 5.899e-01 S  per = 53.1  per(accum) = 95
 T(global opt: deallocate cpu and gpu memory) = 1.212e-03 S  per = 0.109  per(accum) = 95.1
 T(global opt: construct opS [ifdists=true] ) = 5.710e-07 S  per = 5.14e-05  per(accum) = 95.1
 T(global opt: reduction of opS & opH [nccl]) = 5.940e-07 S  per = 5.35e-05  per(accum) = 95.1
 T(global opt: qops memcpy gpu2cpu          ) = 2.974e-03 S  per = 0.268  per(accum) = 95.4
 T(global opt: reduction of opS & opH [mpi] ) = 2.738e-04 S  per = 0.0247  per(accum) = 95.4
 T(global opt: qops_pool join and erase     ) = 2.290e-02 S  per = 2.06  per(accum) = 97.4
 T(global opt: conversion from opAB to opPQ ) = 2.838e-02 S  per = 2.56  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.030e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=16/seqsize=34 dots=1 dbond=(17,0)-(18,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=7:5.341e-05MB:5.215e-08GB
total mem of comb=771:5.882e-03MB:5.744e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=17,2,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 14 15
 suppc= 13
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=105:8.011e-04MB:7.823e-07GB
        per(mem): H:4.76 C:32.4 S:5.71 P:0 Q:57.1 
 rqops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=75:0.000572MB:5.59e-07GB
        per(mem): H:6.67 C:5.33 S:48 A:0 B:40 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2516:0.0192MB:1.87e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.014e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(17,0) fdel=./scratch/sweep/rop(18,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(17,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(18,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.384e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(3,3,4) nnz=7:5.341e-05MB
qtensor3: wf3 own=1 _data=0x3c54c280
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=3
 (26,2):2 (27,3):1
 qbond: qcol nsym=2 dimAll=3
 (3,-1):2 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=16 size=7:5.341e-05MB
### DIAG TIMING: total=4.291e-02 t1=2.598e-05, t2=2.282e-03, t3=2.561e-03, t4=3.802e-02, t5=4.167e-06, t6=1.239e-05, t7=3.099e-06
duration_diagGPU:4.292e-02
duration_diagreduce:4.200e-08
duration_diagtransform:2.600e-07
----- TIMING FOR symbolic_formulae_onedot with size=193 : 2.788e-03 S -----
rank=0 GPUmem(GB): used=1.875e-05 (oper)=1.875e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=193
 no. of hintermediate operators=58
 no. of coefficients=986:7.523e-03MB:7.346e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.998e-05 S -----
rank=0 GPUmem(GB): used=2.609e-05 (oper,hinter)=1.875e-05,7.346e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.865e-04 S size(H_formulae)=193 size(Hxlst2)=3 T(Hmu/Hxlist)=3.920e-04,2.944e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.095e-04 S size(H_formulae)=193 size(Hxlst)=210 -----
rank=0 GPUmem(GB): used=2.609e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.043e-07 batch[need]=1.721e-05 blksize=4 blksize0=2 batchsize=210
rank=0 GPUmem(GB): used=4.341e-05 (oper,hinter,dvdson,batch)=1.875e-05,7.346e-06,1.043e-07,1.721e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=7 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.526e-05,9.950e-03,3.011e-02,1.261e-02,5.275e-02
 analyze_tgpu[Hx]: ndim=7:5.215e-08GB T(cpu-gpu)=7.099e-05 speed=1.469e-03GB/S T(nccl)=4.271e-06 speed=2.442e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=76 t=9.9e-03 per=1.9e+01 cost=1.9e+03 flops=1.9e+05
 sigma[gemm] counter=76 i=0 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=2 t=7.5e-03 per=1.4e+01 cost=4.6e+02 flops=6.2e+04
 sigma[gemm] counter=76 i=3 t=7.5e-03 per=1.4e+01 cost=5.1e+02 flops=6.9e+04
 sigma[gemm] counter=76 i=4 t=7.6e-03 per=1.4e+01 cost=5.3e+02 flops=6.9e+04
 sigma[gemm] counter=76 i=5 t=7.6e-03 per=1.4e+01 cost=4.4e+02 flops=5.9e+04
 sigma[gemm] counter=76 total t=3.0e-02 per=5.7e+01 cost=1.9e+03 flops=6.5e+04
 sigma[red] counter=76 t=1.3e-02 per=2.4e+01 cost=9.1e+02 flops=7.2e+04
----- TIMING FOR sigma_tot : t_inter=7.3e-01 t_gemm=2.2e+00 t_reduction=9.2e-01 tot=3.9e+00 -----
 sigma_tot[inter] counter=76 t=7.3e-01 per=1.9e+01 cost=2.5e+06 flops=3.4e+06
 sigma_tot[gemm] counter=76 i=0 t=1.4e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=1 t=1.2e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=2 t=5.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=76 i=3 t=5.6e-01 per=1.4e+01 cost=1.1e+06 flops=2.0e+06
 sigma_tot[gemm] counter=76 i=4 t=5.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=76 i=5 t=5.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=76 total t=2.2e+00 per=5.8e+01 cost=4.3e+06 flops=1.9e+06
 sigma_tot[red] counter=76 t=9.2e-01 per=2.4e+01 cost=1.1e+06 flops=1.2e+06
T(sub)=8.4e-06 T(gemm/eig/ortho/gemm/axpy)=2.2e-06,3.5e-06,1.9e-06,6.7e-07,1.6e-07
settings: ndim=7 neig=1 maxcycle=30 nbuff=4 memory=8e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.311856917920 -1.116e+03  2.134e-02    1     1  5.285e-02 5.285e-02 5.283e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.274e-03,1.004e-02,3.010e-02,1.252e-02,5.394e-02
 analyze_tgpu[Hx]: ndim=7:5.215e-08GB T(cpu-gpu)=1.269e-03 speed=8.218e-05GB/S T(nccl)=4.450e-06 speed=2.344e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=77 t=1.0e-02 per=1.9e+01 cost=1.9e+03 flops=1.9e+05
 sigma[gemm] counter=77 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=2 t=7.6e-03 per=1.5e+01 cost=4.6e+02 flops=6.0e+04
 sigma[gemm] counter=77 i=3 t=7.5e-03 per=1.4e+01 cost=5.1e+02 flops=6.8e+04
 sigma[gemm] counter=77 i=4 t=7.5e-03 per=1.4e+01 cost=5.3e+02 flops=7.1e+04
 sigma[gemm] counter=77 i=5 t=7.5e-03 per=1.4e+01 cost=4.4e+02 flops=5.9e+04
 sigma[gemm] counter=77 total t=3.0e-02 per=5.7e+01 cost=1.9e+03 flops=6.5e+04
 sigma[red] counter=77 t=1.3e-02 per=2.4e+01 cost=9.1e+02 flops=7.2e+04
----- TIMING FOR sigma_tot : t_inter=7.4e-01 t_gemm=2.3e+00 t_reduction=9.3e-01 tot=3.9e+00 -----
 sigma_tot[inter] counter=77 t=7.4e-01 per=1.9e+01 cost=2.5e+06 flops=3.4e+06
 sigma_tot[gemm] counter=77 i=0 t=1.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=1 t=1.2e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=2 t=5.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=77 i=3 t=5.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=77 i=4 t=5.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=77 i=5 t=5.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=77 total t=2.3e+00 per=5.8e+01 cost=4.3e+06 flops=1.9e+06
 sigma_tot[red] counter=77 t=9.3e-01 per=2.4e+01 cost=1.1e+06 flops=1.2e+06
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,9.4e-06,3.1e-06,7.7e-07,1.7e-07
    2   0 -    -116.314200212892 -2.343e-03  2.427e-03    2     2  1.164e-01 5.821e-02 5.343e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.239e-04,1.463e-03,1.674e-02,1.245e-02,3.159e-02
 analyze_tgpu[Hx]: ndim=7:5.215e-08GB T(cpu-gpu)=9.192e-04 speed=1.135e-04GB/S T(nccl)=4.697e-06 speed=2.221e-02GB/S
----- TIMING FOR sigma : t_inter=1.5e-03 t_gemm=1.7e-02 t_reduction=1.2e-02 tot=3.1e-02 -----
 sigma[inter] counter=78 t=1.5e-03 per=4.8e+00 cost=1.9e+03 flops=1.3e+06
 sigma[gemm] counter=78 i=0 t=1.5e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=1 t=1.3e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=2 t=1.2e-03 per=3.8e+00 cost=4.6e+02 flops=4.0e+05
 sigma[gemm] counter=78 i=3 t=4.9e-04 per=1.6e+00 cost=5.1e+02 flops=1.1e+06
 sigma[gemm] counter=78 i=4 t=7.5e-03 per=2.5e+01 cost=5.3e+02 flops=7.0e+04
 sigma[gemm] counter=78 i=5 t=7.6e-03 per=2.5e+01 cost=4.4e+02 flops=5.9e+04
 sigma[gemm] counter=78 total t=1.7e-02 per=5.5e+01 cost=1.9e+03 flops=1.2e+05
 sigma[red] counter=78 t=1.2e-02 per=4.1e+01 cost=9.1e+02 flops=7.3e+04
----- TIMING FOR sigma_tot : t_inter=7.4e-01 t_gemm=2.3e+00 t_reduction=9.4e-01 tot=4.0e+00 -----
 sigma_tot[inter] counter=78 t=7.4e-01 per=1.9e+01 cost=2.5e+06 flops=3.4e+06
 sigma_tot[gemm] counter=78 i=0 t=1.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=1 t=1.2e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=2 t=5.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=78 i=3 t=5.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=78 i=4 t=5.7e-01 per=1.5e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=78 i=5 t=5.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=78 total t=2.3e+00 per=5.7e+01 cost=4.3e+06 flops=1.9e+06
 sigma_tot[red] counter=78 t=9.4e-01 per=2.4e+01 cost=1.1e+06 flops=1.2e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.3e-05,2.7e-06,9.2e-07,1.9e-07
    3   0 -    -116.314230246966 -3.003e-05  1.927e-04    3     3  1.600e-01 5.334e-02 4.618e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.023e-03,9.849e-03,2.967e-02,1.249e-02,5.304e-02
 analyze_tgpu[Hx]: ndim=7:5.215e-08GB T(cpu-gpu)=1.019e-03 speed=1.024e-04GB/S T(nccl)=4.477e-06 speed=2.330e-02GB/S
----- TIMING FOR sigma : t_inter=9.8e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=79 t=9.8e-03 per=1.9e+01 cost=1.9e+03 flops=1.9e+05
 sigma[gemm] counter=79 i=0 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=2 t=7.5e-03 per=1.4e+01 cost=4.6e+02 flops=6.2e+04
 sigma[gemm] counter=79 i=3 t=7.4e-03 per=1.4e+01 cost=5.1e+02 flops=7.0e+04
 sigma[gemm] counter=79 i=4 t=7.5e-03 per=1.4e+01 cost=5.3e+02 flops=7.0e+04
 sigma[gemm] counter=79 i=5 t=7.4e-03 per=1.4e+01 cost=4.4e+02 flops=6.0e+04
 sigma[gemm] counter=79 total t=3.0e-02 per=5.7e+01 cost=1.9e+03 flops=6.6e+04
 sigma[red] counter=79 t=1.2e-02 per=2.4e+01 cost=9.1e+02 flops=7.3e+04
----- TIMING FOR sigma_tot : t_inter=7.5e-01 t_gemm=2.3e+00 t_reduction=9.5e-01 tot=4.0e+00 -----
 sigma_tot[inter] counter=79 t=7.5e-01 per=1.9e+01 cost=2.5e+06 flops=3.3e+06
 sigma_tot[gemm] counter=79 i=0 t=1.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=1 t=1.2e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=2 t=5.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=79 i=3 t=5.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=79 i=4 t=5.8e-01 per=1.5e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=79 i=5 t=5.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=79 total t=2.3e+00 per=5.7e+01 cost=4.3e+06 flops=1.9e+06
 sigma_tot[red] counter=79 t=9.5e-01 per=2.4e+01 cost=1.1e+06 flops=1.2e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.2e-05,2.7e-06,8.8e-07,1.8e-07
    4   0 +    -116.314230523770 -2.768e-07  7.518e-06    3     4  2.250e-01 5.626e-02 4.792e-02
TIMING FOR Davidson : 2.250e-01  T(cal/comm/rest)=1.917e-01,3.970e-07,3.337e-02
decomposed t_rest=3.337e-02
 T(sub)    =6.541e-05 per=1.960e-01
 T(precond)=3.320e-02 per=9.948e+01
 T(ortho)  =1.020e-05 per=3.057e-02
 T(xcopy)  =6.020e-07 per=1.804e-03
 T(xnrm2)  =1.560e-06 per=4.675e-03
 T(other)  =9.466e-05 per=2.837e-01
optimized energies: isweep=0 ibond=16 dots=1 e[0]=-116.314230523770 nmvp=4
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.894e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond16.txt
 qbond: qsuper nsym=6 dimAll=12
 (26,2):2 (28,2):3 (27,3):3 (27,1):2 (29,3):1 (28,4):1
timing for divide=7.0e-06
timing for compute=1.2e-02
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=7.0e-06,1.2e-02,0.0e+00,3.9e-06,1.3e-05 -----
decimation summary: 12->3 dwt=+0.000e+00 SvN=8.191e-01
 qbond: qkept nsym=2 dimAll=3
 (27,1):2 (28,2):1
----- TIMING for decimation_row(nkr): 1.177e-02 S T(decim/select/formRot)=1.158e-02,1.772e-04,1.692e-05 -----
----- TIMING FOR onedot_decimation: 1.182e-02 S T(wf/decim)=3.625e-05,1.178e-02 -----
ctns::oper_renorm coord=(17,0) superblock=lc oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:36 S:4 P:6 Q:10 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=75:5.722e-04MB:5.588e-07GB
        per(mem): H:6.67 C:48 S:5.33 P:0 Q:40 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.512e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 3.272e-03 S -----
rank=0 GPUmem(GB): used=2.609e-05 (oper)=1.875e-05
rank=0 GPUmem(GB): used=2.614e-05 (oper,site)=1.875e-05,5.215e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=58
 no. of coefficients=986:7.523e-03MB:7.346e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.442e-03 S -----
rank=0 GPUmem(GB): used=3.349e-05 (oper,site,rinter)=1.875e-05,5.215e-08,7.346e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 6.716e-04 S size(rtasks)=57 size(Rlst2)=4 T(Rmu/Rlist)=4.459e-04,2.257e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.930e-04 S size(rtasks)=57 size(Rlst)=130 -----
rank=0 GPUmem(GB): used=3.349e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.065e-05 blksize=4 blksize0=2 batchsize=130
rank=0 GPUmem(GB): used=4.414e-05 (oper,site,rinter,batch)=1.875e-05,5.215e-08,7.346e-06,1.065e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.525e-03,2.245e-02,1.003e-02
----- TIMING FOR renorm : t_inter=8.5e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=4.1e-02 -----
 renorm[inter] counter=17 t=8.5e-03 per=2.1e+01 cost=9.5e+02 flops=1.1e+05
 renorm[gemm] counter=17 i=0 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=1 t=1.1e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=2 t=1.1e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=3 t=1.1e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=4 t=7.4e-03 per=1.8e+01 cost=1.8e+02 flops=2.4e+04
 renorm[gemm] counter=17 i=5 t=7.6e-03 per=1.8e+01 cost=4.6e+02 flops=6.0e+04
 renorm[gemm] counter=17 i=6 t=7.4e-03 per=1.8e+01 cost=6.9e+02 flops=9.3e+04
 renorm[gemm] counter=17 total t=2.2e-02 per=5.5e+01 cost=1.3e+03 flops=5.9e+04
 renorm[red] counter=17 t=1.0e-02 per=2.4e+01 cost=4.2e+02 flops=4.2e+04
----- TIMING FOR renorm_tot : t_inter=9.6e-02 t_gemm=3.7e-01 t_reduction=1.7e-01 tot=6.3e-01 -----
 renorm_tot[inter] counter=17 t=9.6e-02 per=1.5e+01 cost=5.2e+05 flops=5.5e+06
 renorm_tot[gemm] counter=17 i=0 t=2.3e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=1 t=1.9e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=2 t=1.8e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=3 t=1.8e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=4 t=1.2e-01 per=1.9e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=17 i=5 t=1.2e-01 per=1.9e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=17 i=6 t=1.2e-01 per=1.9e+01 cost=1.4e+06 flops=1.2e+07
 renorm_tot[gemm] counter=17 total t=3.7e-01 per=5.8e+01 cost=1.9e+06 flops=5.2e+06
 renorm_tot[red] counter=17 t=1.7e-01 per=2.7e+01 cost=6.5e+05 flops=3.9e+06
qops.to_cpu: size(tot)=75:5.7e-04MB:5.6e-07GB T(to_cpu)=9.3e-05S speed=6.0e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.05 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.502e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.078e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.353e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 3.468e-01 S #####
 T(local opt: fetch) = 1.117e-02 S  per = 3.22  per(accum) = 3.22
 T(local opt: hdiag) = 4.295e-02 S  per = 12.4  per(accum) = 15.6
 T(local opt: dvdsn) = 2.297e-01 S  per = 66.2  per(accum) = 81.8
 T(local opt: decim) = 1.183e-02 S  per = 3.41  per(accum) = 85.2
 T(local opt: guess) = 6.017e-05 S  per = 0.0174  per(accum) = 85.3
 T(local opt: renrm) = 5.093e-02 S  per = 14.7  per(accum) = 99.9
 T(local opt: save ) = 1.953e-04 S  per = 0.0563  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.297e-01 S  T(sum) = 2.295e-01 S  per = 9.994e+01
 T(local opt: preprocess                  ) = 6.915e-05 S  per = 0.0301  per(accum) = 0.0301
 T(local opt: symbolic_formulae           ) = 2.797e-03 S  per = 1.22  per(accum) = 1.25
 T(local opt: hintermediate init          ) = 9.296e-05 S  per = 0.0405  per(accum) = 1.29
 T(local opt: preprocess_hformulae_Hxlist ) = 7.184e-04 S  per = 0.313  per(accum) = 1.6
 T(local opt: hmmtasks init               ) = 7.970e-04 S  per = 0.347  per(accum) = 1.95
 T(local opt: initial guess for dvdson    ) = 2.281e-06 S  per = 0.000994  per(accum) = 1.95
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.884e-01 S  per = 82.1  per(accum) = 84
 T(local opt: dvdson [cpu-gpu]            ) = 3.278e-03 S  per = 1.43  per(accum) = 85.5
 T(local opt: dvdson [nccl]               ) = 1.790e-05 S  per = 0.0078  per(accum) = 85.5
 T(local opt: dvdson [mpi]                ) = 3.970e-07 S  per = 0.000173  per(accum) = 85.5
 T(local opt: dvdson [rest part(linalg)]  ) = 3.337e-02 S  per = 14.5  per(accum) = 100
Detailed decomposition of T(renrm) = 5.093e-02 S  T(sum) = 5.093e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.906e-05 S  per = 0.116  per(accum) = 0.116
 T(local opt: qops init                    ) = 5.979e-04 S  per = 1.17  per(accum) = 1.29
 T(local opt: symbolic_formulae_renorm     ) = 3.283e-03 S  per = 6.45  per(accum) = 7.74
 T(local opt: allocate qops on gpu         ) = 5.121e-05 S  per = 0.101  per(accum) = 7.84
 T(local opt: site memcpy cpu2gpu          ) = 9.976e-04 S  per = 1.96  per(accum) = 9.79
 T(local opt: rintermediate init           ) = 2.451e-03 S  per = 4.81  per(accum) = 14.6
 T(local opt: preprocess_formulae_Rlist2   ) = 7.010e-04 S  per = 1.38  per(accum) = 16
 T(local opt: rmmtasks init                ) = 6.889e-04 S  per = 1.35  per(accum) = 17.3
 T(local opt: qops memset on cpu           ) = 3.200e-08 S  per = 6.28e-05  per(accum) = 17.3
 T(local opt: preprocess_renorm_batchGPU   ) = 4.109e-02 S  per = 80.7  per(accum) = 98
 T(local opt: deallocate cpu and gpu memory) = 2.313e-05 S  per = 0.0454  per(accum) = 98.1
 T(local opt: construct opS [ifdists=true] ) = 2.800e-08 S  per = 5.5e-05  per(accum) = 98.1
 T(local opt: reduction of opS & opH [nccl]) = 3.100e-08 S  per = 6.09e-05  per(accum) = 98.1
 T(local opt: qops memcpy gpu2cpu          ) = 9.965e-05 S  per = 0.196  per(accum) = 98.3
 T(local opt: reduction of opS & opH [mpi] ) = 1.407e-05 S  per = 0.0276  per(accum) = 98.3
 T(local opt: qops_pool join and erase     ) = 8.744e-04 S  per = 1.72  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.293e-06 S  per = 0.00254  per(accum) = 100
##### sweep opt: 1.007e+01 S #####
 T(sweep opt: fetch) = 2.026e-01 S  per = 2.01  per(accum) = 2.01
 T(sweep opt: hdiag) = 3.209e+00 S  per = 31.9  per(accum) = 33.9
 T(sweep opt: dvdsn) = 5.309e+00 S  per = 52.7  per(accum) = 86.6
 T(sweep opt: decim) = 1.866e-01 S  per = 1.85  per(accum) = 88.4
 T(sweep opt: guess) = 1.332e-03 S  per = 0.0132  per(accum) = 88.4
 T(sweep opt: renrm) = 1.161e+00 S  per = 11.5  per(accum) = 100
 T(sweep opt: save ) = 4.064e-03 S  per = 0.0403  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.309e+00 S  T(sum) = 5.304e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 1.696e-03 S  per = 0.032  per(accum) = 0.032
 T(sweep opt: symbolic_formulae           ) = 2.163e-01 S  per = 4.08  per(accum) = 4.11
 T(sweep opt: hintermediate init          ) = 5.632e-03 S  per = 0.106  per(accum) = 4.22
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.930e-02 S  per = 1.31  per(accum) = 5.52
 T(sweep opt: hmmtasks init               ) = 1.289e-01 S  per = 2.43  per(accum) = 7.95
 T(sweep opt: initial guess for dvdson    ) = 6.247e-05 S  per = 0.00118  per(accum) = 7.96
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.018e+00 S  per = 75.8  per(accum) = 83.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.042e-01 S  per = 1.96  per(accum) = 85.7
 T(sweep opt: dvdson [nccl]               ) = 4.504e-04 S  per = 0.00849  per(accum) = 85.7
 T(sweep opt: dvdson [mpi]                ) = 1.073e-05 S  per = 0.000202  per(accum) = 85.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.595e-01 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.161e+00 S  T(sum) = 1.161e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.559e-03 S  per = 0.22  per(accum) = 0.22
 T(sweep opt: qops init                    ) = 2.936e-02 S  per = 2.53  per(accum) = 2.75
 T(sweep opt: symbolic_formulae_renorm     ) = 1.987e-01 S  per = 17.1  per(accum) = 19.9
 T(sweep opt: allocate qops on gpu         ) = 9.149e-04 S  per = 0.0788  per(accum) = 19.9
 T(sweep opt: site memcpy cpu2gpu          ) = 2.340e-02 S  per = 2.02  per(accum) = 22
 T(sweep opt: rintermediate init           ) = 3.819e-02 S  per = 3.29  per(accum) = 25.3
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.199e-02 S  per = 5.34  per(accum) = 30.6
 T(sweep opt: rmmtasks init                ) = 1.181e-01 S  per = 10.2  per(accum) = 40.8
 T(sweep opt: qops memset on cpu           ) = 6.860e-07 S  per = 5.91e-05  per(accum) = 40.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.310e-01 S  per = 54.3  per(accum) = 95.1
 T(sweep opt: deallocate cpu and gpu memory) = 1.235e-03 S  per = 0.106  per(accum) = 95.2
 T(sweep opt: construct opS [ifdists=true] ) = 5.990e-07 S  per = 5.16e-05  per(accum) = 95.2
 T(sweep opt: reduction of opS & opH [nccl]) = 6.250e-07 S  per = 5.38e-05  per(accum) = 95.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.073e-03 S  per = 0.265  per(accum) = 95.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.879e-04 S  per = 0.0248  per(accum) = 95.5
 T(sweep opt: qops_pool join and erase     ) = 2.377e-02 S  per = 2.05  per(accum) = 97.6
 T(sweep opt: conversion from opAB to opPQ ) = 2.839e-02 S  per = 2.44  per(accum) = 100
##### global opt: 1.007e+01 S #####
 T(global opt: fetch) = 2.026e-01 S  per = 2.01  per(accum) = 2.01
 T(global opt: hdiag) = 3.209e+00 S  per = 31.9  per(accum) = 33.9
 T(global opt: dvdsn) = 5.309e+00 S  per = 52.7  per(accum) = 86.6
 T(global opt: decim) = 1.866e-01 S  per = 1.85  per(accum) = 88.4
 T(global opt: guess) = 1.332e-03 S  per = 0.0132  per(accum) = 88.4
 T(global opt: renrm) = 1.161e+00 S  per = 11.5  per(accum) = 100
 T(global opt: save ) = 4.064e-03 S  per = 0.0403  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.309e+00 S  T(sum) = 5.304e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 1.696e-03 S  per = 0.032  per(accum) = 0.032
 T(global opt: symbolic_formulae           ) = 2.163e-01 S  per = 4.08  per(accum) = 4.11
 T(global opt: hintermediate init          ) = 5.632e-03 S  per = 0.106  per(accum) = 4.22
 T(global opt: preprocess_hformulae_Hxlist ) = 6.930e-02 S  per = 1.31  per(accum) = 5.52
 T(global opt: hmmtasks init               ) = 1.289e-01 S  per = 2.43  per(accum) = 7.95
 T(global opt: initial guess for dvdson    ) = 6.247e-05 S  per = 0.00118  per(accum) = 7.96
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.018e+00 S  per = 75.8  per(accum) = 83.7
 T(global opt: dvdson [cpu-gpu]            ) = 1.042e-01 S  per = 1.96  per(accum) = 85.7
 T(global opt: dvdson [nccl]               ) = 4.504e-04 S  per = 0.00849  per(accum) = 85.7
 T(global opt: dvdson [mpi]                ) = 1.073e-05 S  per = 0.000202  per(accum) = 85.7
 T(global opt: dvdson [rest part(linalg)]  ) = 7.595e-01 S  per = 14.3  per(accum) = 100
Detailed decomposition of T(renrm) = 1.161e+00 S  T(sum) = 1.161e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.559e-03 S  per = 0.22  per(accum) = 0.22
 T(global opt: qops init                    ) = 2.936e-02 S  per = 2.53  per(accum) = 2.75
 T(global opt: symbolic_formulae_renorm     ) = 1.987e-01 S  per = 17.1  per(accum) = 19.9
 T(global opt: allocate qops on gpu         ) = 9.149e-04 S  per = 0.0788  per(accum) = 19.9
 T(global opt: site memcpy cpu2gpu          ) = 2.340e-02 S  per = 2.02  per(accum) = 22
 T(global opt: rintermediate init           ) = 3.819e-02 S  per = 3.29  per(accum) = 25.3
 T(global opt: preprocess_formulae_Rlist2   ) = 6.199e-02 S  per = 5.34  per(accum) = 30.6
 T(global opt: rmmtasks init                ) = 1.181e-01 S  per = 10.2  per(accum) = 40.8
 T(global opt: qops memset on cpu           ) = 6.860e-07 S  per = 5.91e-05  per(accum) = 40.8
 T(global opt: preprocess_renorm_batchGPU   ) = 6.310e-01 S  per = 54.3  per(accum) = 95.1
 T(global opt: deallocate cpu and gpu memory) = 1.235e-03 S  per = 0.106  per(accum) = 95.2
 T(global opt: construct opS [ifdists=true] ) = 5.990e-07 S  per = 5.16e-05  per(accum) = 95.2
 T(global opt: reduction of opS & opH [nccl]) = 6.250e-07 S  per = 5.38e-05  per(accum) = 95.2
 T(global opt: qops memcpy gpu2cpu          ) = 3.073e-03 S  per = 0.265  per(accum) = 95.5
 T(global opt: reduction of opS & opH [mpi] ) = 2.879e-04 S  per = 0.0248  per(accum) = 95.5
 T(global opt: qops_pool join and erase     ) = 2.377e-02 S  per = 2.05  per(accum) = 97.6
 T(global opt: conversion from opAB to opPQ ) = 2.839e-02 S  per = 2.44  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.837e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=17/seqsize=34 dots=1 dbond=(17,0)-(18,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=716:5.463e-03MB:5.335e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=5:3.815e-05MB:3.725e-08GB
total mem of comb=769:5.867e-03MB:5.729e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=18,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19
 suppr= 15
 suppc= 14
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(17,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(18,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:36 S:4 P:6 Q:10 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=75:5.722e-04MB:5.588e-07GB
        per(mem): H:6.67 C:48 S:5.33 P:0 Q:40 
 rqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=4747:0.0362MB:3.54e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.749e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(18,0) fdel=./scratch/sweep/lop(17,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.872e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(3,4,4) nnz=5:3.815e-05MB
qtensor3: wf3 own=1 _data=0x3c496b70
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=3
 (27,1):2 (28,2):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=32 size=5:3.815e-05MB
### DIAG TIMING: total=2.196e-02 t1=2.252e-05, t2=2.194e-03, t3=2.466e-03, t4=1.726e-02, t5=4.546e-06, t6=1.256e-05, t7=3.707e-06
duration_diagGPU:2.197e-02
duration_diagreduce:8.100e-08
duration_diagtransform:2.370e-07
----- TIMING FOR symbolic_formulae_onedot with size=123 : 1.252e-03 S -----
rank=0 GPUmem(GB): used=3.537e-05 (oper)=3.537e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=123
 no. of hintermediate operators=20
 no. of coefficients=360:2.747e-03MB:2.682e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.283e-05 S -----
rank=0 GPUmem(GB): used=3.805e-05 (oper,hinter)=3.537e-05,2.682e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.273e-04 S size(H_formulae)=123 size(Hxlst2)=3 T(Hmu/Hxlist)=2.292e-04,1.981e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.448e-04 S size(H_formulae)=123 size(Hxlst)=142 -----
rank=0 GPUmem(GB): used=3.805e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=7.451e-08 batch[need]=7.406e-06 blksize=2 blksize0=2 batchsize=142
rank=0 GPUmem(GB): used=4.553e-05 (oper,hinter,dvdson,batch)=3.537e-05,2.682e-06,7.451e-08,7.406e-06
ctns::pdvdsonSolver_nkr::solve_iter ndim=5 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.494e-03,9.887e-03,2.989e-02,1.247e-02,5.474e-02
 analyze_tgpu[Hx]: ndim=5:3.725e-08GB T(cpu-gpu)=2.489e-03 speed=2.994e-05GB/S T(nccl)=4.949e-06 speed=1.505e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=80 t=9.9e-03 per=1.9e+01 cost=7.2e+02 flops=7.3e+04
 sigma[gemm] counter=80 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=1 t=1.0e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=2 t=7.4e-03 per=1.4e+01 cost=1.2e+02 flops=1.6e+04
 sigma[gemm] counter=80 i=3 t=7.4e-03 per=1.4e+01 cost=1.5e+02 flops=2.0e+04
 sigma[gemm] counter=80 i=4 t=7.4e-03 per=1.4e+01 cost=2.6e+02 flops=3.5e+04
 sigma[gemm] counter=80 i=5 t=7.6e-03 per=1.5e+01 cost=2.6e+02 flops=3.4e+04
 sigma[gemm] counter=80 total t=3.0e-02 per=5.7e+01 cost=7.9e+02 flops=2.6e+04
 sigma[red] counter=80 t=1.2e-02 per=2.4e+01 cost=4.5e+02 flops=3.6e+04
----- TIMING FOR sigma_tot : t_inter=7.6e-01 t_gemm=2.3e+00 t_reduction=9.7e-01 tot=4.1e+00 -----
 sigma_tot[inter] counter=80 t=7.6e-01 per=1.9e+01 cost=2.5e+06 flops=3.3e+06
 sigma_tot[gemm] counter=80 i=0 t=1.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=1 t=1.3e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=2 t=5.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=80 i=3 t=5.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=80 i=4 t=5.9e-01 per=1.5e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=80 i=5 t=5.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=80 total t=2.3e+00 per=5.7e+01 cost=4.3e+06 flops=1.8e+06
 sigma_tot[red] counter=80 t=9.7e-01 per=2.4e+01 cost=1.1e+06 flops=1.2e+06
T(sub)=9.2e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,3.9e-06,1.9e-06,6.8e-07,1.9e-07
settings: ndim=5 neig=1 maxcycle=30 nbuff=4 memory=6e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.314230523770 -1.116e+03  6.544e-06    1     1  5.486e-02 5.486e-02 5.484e-02
TIMING FOR Davidson : 5.488e-02  T(cal/comm/rest)=5.484e-02,1.080e-07,4.614e-05
decomposed t_rest=4.614e-05
 T(sub)    =9.226e-06 per=1.999e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =3.560e-07 per=7.715e-01
 T(xnrm2)  =3.550e-07 per=7.693e-01
 T(other)  =3.621e-05 per=7.847e+01
optimized energies: isweep=0 ibond=17 dots=1 e[0]=-116.314230523770 nmvp=1
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.145e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=9 alg_decim=0 mpisize=1
 qbond: qsuper nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
----- TIMING FOR onedot_decimation: 1.2e-04 S T(wf/decim)=5.2e-05,6.4e-05 -----
ctns::oper_renorm coord=(18,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=1352:1.0e-02MB:1.0e-05GB
        per(mem): H:2.66 C:7.1 S:63.9 A:5.62 B:20.7 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.333e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 1.344e-03 S -----
rank=0 GPUmem(GB): used=4.756e-05 (oper)=4.488e-05
rank=0 GPUmem(GB): used=4.783e-05 (oper,site)=4.488e-05,2.682e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=4.783e-05 (oper,site,rinter)=4.488e-05,2.682e-07,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 2.604e-03 S size(rtasks)=57 size(Rlst2)=81 T(Rmu/Rlist)=6.519e-04,1.952e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.905e-03 S size(rtasks)=57 size(Rlst)=1620 -----
rank=0 GPUmem(GB): used=4.783e-05 avail=6.176e+00 total=6.176e+00 batch[need]=3.983e-04 blksize=16 blksize0=0 batchsize=1620
rank=0 GPUmem(GB): used=4.461e-04 (oper,site,rinter,batch)=4.488e-05,2.682e-07,0.000e+00,3.983e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.768e-06,2.096e-02,9.963e-03
----- TIMING FOR renorm : t_inter=7.5e-06 t_gemm=2.1e-02 t_reduction=1.0e-02 tot=3.1e-02 -----
 renorm[inter] counter=18 t=7.5e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=0 t=1.4e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=1 t=1.0e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=2 t=6.1e-03 per=2.0e+01 cost=2.5e+03 flops=4.0e+05
 renorm[gemm] counter=18 i=3 t=7.4e-03 per=2.4e+01 cost=3.6e+03 flops=4.9e+05
 renorm[gemm] counter=18 i=4 t=1.0e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=5 t=9.9e-07 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=6 t=7.4e-03 per=2.4e+01 cost=1.9e+04 flops=2.5e+06
 renorm[gemm] counter=18 total t=2.1e-02 per=6.8e+01 cost=2.5e+04 flops=1.2e+06
 renorm[red] counter=18 t=1.0e-02 per=3.2e+01 cost=1.9e+04 flops=1.9e+06
----- TIMING FOR renorm_tot : t_inter=9.6e-02 t_gemm=3.9e-01 t_reduction=1.8e-01 tot=6.6e-01 -----
 renorm_tot[inter] counter=18 t=9.6e-02 per=1.4e+01 cost=5.2e+05 flops=5.5e+06
 renorm_tot[gemm] counter=18 i=0 t=2.4e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=1 t=2.0e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=2 t=6.1e-03 per=9.3e-01 cost=2.5e+03 flops=4.0e+05
 renorm_tot[gemm] counter=18 i=3 t=7.4e-03 per=1.1e+00 cost=3.6e+03 flops=4.9e+05
 renorm_tot[gemm] counter=18 i=4 t=1.2e-01 per=1.9e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=18 i=5 t=1.2e-01 per=1.8e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=18 i=6 t=1.3e-01 per=2.0e+01 cost=1.4e+06 flops=1.1e+07
 renorm_tot[gemm] counter=18 total t=3.9e-01 per=5.9e+01 cost=1.9e+06 flops=5.0e+06
 renorm_tot[red] counter=18 t=1.8e-01 per=2.7e+01 cost=6.7e+05 flops=3.8e+06
qops.to_cpu: size(tot)=1352:1.0e-02MB:1.0e-05GB T(to_cpu)=6.8e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=0.000e+00 coord=(18,0) rank=0
----- TIMING FOR oper_renorm : 0.0475 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=4.597e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.884e-03 change=-2.196e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.884e-03 change=-1.550e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.491e-01 S #####
 T(local opt: fetch) = 1.962e-02 S  per = 13.2  per(accum) = 13.2
 T(local opt: hdiag) = 2.201e-02 S  per = 14.8  per(accum) = 27.9
 T(local opt: dvdsn) = 5.743e-02 S  per = 38.5  per(accum) = 66.4
 T(local opt: decim) = 1.228e-04 S  per = 0.0823  per(accum) = 66.5
 T(local opt: guess) = 6.748e-05 S  per = 0.0453  per(accum) = 66.6
 T(local opt: renrm) = 4.963e-02 S  per = 33.3  per(accum) = 99.9
 T(local opt: save ) = 2.201e-04 S  per = 0.148  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.743e-02 S  T(sum) = 5.729e-02 S  per = 9.975e+01
 T(local opt: preprocess                  ) = 9.026e-05 S  per = 0.158  per(accum) = 0.158
 T(local opt: symbolic_formulae           ) = 1.260e-03 S  per =  2.2  per(accum) = 2.36
 T(local opt: hintermediate init          ) = 6.552e-05 S  per = 0.114  per(accum) = 2.47
 T(local opt: preprocess_hformulae_Hxlist ) = 4.518e-04 S  per = 0.789  per(accum) = 3.26
 T(local opt: hmmtasks init               ) = 5.365e-04 S  per = 0.937  per(accum) = 4.2
 T(local opt: initial guess for dvdson    ) = 2.280e-06 S  per = 0.00398  per(accum) = 4.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 5.234e-02 S  per = 91.4  per(accum) = 95.6
 T(local opt: dvdson [cpu-gpu]            ) = 2.489e-03 S  per = 4.34  per(accum) = 99.9
 T(local opt: dvdson [nccl]               ) = 4.949e-06 S  per = 0.00864  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 1.080e-07 S  per = 0.000189  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.614e-05 S  per = 0.0805  per(accum) = 100
Detailed decomposition of T(renrm) = 4.963e-02 S  T(sum) = 4.963e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.803e-05 S  per = 0.137  per(accum) = 0.137
 T(local opt: qops init                    ) = 7.304e-04 S  per = 1.47  per(accum) = 1.61
 T(local opt: symbolic_formulae_renorm     ) = 1.352e-03 S  per = 2.72  per(accum) = 4.33
 T(local opt: allocate qops on gpu         ) = 4.659e-05 S  per = 0.0939  per(accum) = 4.43
 T(local opt: site memcpy cpu2gpu          ) = 1.916e-03 S  per = 3.86  per(accum) = 8.29
 T(local opt: rintermediate init           ) = 2.693e-05 S  per = 0.0543  per(accum) = 8.34
 T(local opt: preprocess_formulae_Rlist2   ) = 2.957e-03 S  per = 5.96  per(accum) = 14.3
 T(local opt: rmmtasks init                ) = 9.266e-03 S  per = 18.7  per(accum) = 33
 T(local opt: qops memset on cpu           ) = 2.900e-08 S  per = 5.84e-05  per(accum) = 33
 T(local opt: preprocess_renorm_batchGPU   ) = 3.102e-02 S  per = 62.5  per(accum) = 95.5
 T(local opt: deallocate cpu and gpu memory) = 8.018e-05 S  per = 0.162  per(accum) = 95.6
 T(local opt: construct opS [ifdists=true] ) = 3.300e-08 S  per = 6.65e-05  per(accum) = 95.6
 T(local opt: reduction of opS & opH [nccl]) = 2.700e-08 S  per = 5.44e-05  per(accum) = 95.6
 T(local opt: qops memcpy gpu2cpu          ) = 7.496e-05 S  per = 0.151  per(accum) = 95.8
 T(local opt: reduction of opS & opH [mpi] ) = 2.552e-05 S  per = 0.0514  per(accum) = 95.8
 T(local opt: qops_pool join and erase     ) = 2.060e-03 S  per = 4.15  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.534e-06 S  per = 0.00309  per(accum) = 100
##### sweep opt: 1.022e+01 S #####
 T(sweep opt: fetch) = 2.222e-01 S  per = 2.17  per(accum) = 2.17
 T(sweep opt: hdiag) = 3.231e+00 S  per = 31.6  per(accum) = 33.8
 T(sweep opt: dvdsn) = 5.367e+00 S  per = 52.5  per(accum) = 86.3
 T(sweep opt: decim) = 1.867e-01 S  per = 1.83  per(accum) = 88.1
 T(sweep opt: guess) = 1.400e-03 S  per = 0.0137  per(accum) = 88.1
 T(sweep opt: renrm) = 1.211e+00 S  per = 11.8  per(accum) = 100
 T(sweep opt: save ) = 4.284e-03 S  per = 0.0419  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.367e+00 S  T(sum) = 5.361e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 1.786e-03 S  per = 0.0333  per(accum) = 0.0333
 T(sweep opt: symbolic_formulae           ) = 2.176e-01 S  per = 4.06  per(accum) = 4.09
 T(sweep opt: hintermediate init          ) = 5.697e-03 S  per = 0.106  per(accum) = 4.2
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.975e-02 S  per =  1.3  per(accum) = 5.5
 T(sweep opt: hmmtasks init               ) = 1.295e-01 S  per = 2.42  per(accum) = 7.91
 T(sweep opt: initial guess for dvdson    ) = 6.475e-05 S  per = 0.00121  per(accum) = 7.92
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.070e+00 S  per = 75.9  per(accum) = 83.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.067e-01 S  per = 1.99  per(accum) = 85.8
 T(sweep opt: dvdson [nccl]               ) = 4.553e-04 S  per = 0.00849  per(accum) = 85.8
 T(sweep opt: dvdson [mpi]                ) = 1.084e-05 S  per = 0.000202  per(accum) = 85.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.595e-01 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.211e+00 S  T(sum) = 1.211e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.627e-03 S  per = 0.217  per(accum) = 0.217
 T(sweep opt: qops init                    ) = 3.009e-02 S  per = 2.49  per(accum) = 2.7
 T(sweep opt: symbolic_formulae_renorm     ) = 2.001e-01 S  per = 16.5  per(accum) = 19.2
 T(sweep opt: allocate qops on gpu         ) = 9.615e-04 S  per = 0.0794  per(accum) = 19.3
 T(sweep opt: site memcpy cpu2gpu          ) = 2.531e-02 S  per = 2.09  per(accum) = 21.4
 T(sweep opt: rintermediate init           ) = 3.822e-02 S  per = 3.16  per(accum) = 24.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.495e-02 S  per = 5.36  per(accum) = 29.9
 T(sweep opt: rmmtasks init                ) = 1.274e-01 S  per = 10.5  per(accum) = 40.4
 T(sweep opt: qops memset on cpu           ) = 7.150e-07 S  per = 5.91e-05  per(accum) = 40.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.620e-01 S  per = 54.7  per(accum) = 95.1
 T(sweep opt: deallocate cpu and gpu memory) = 1.315e-03 S  per = 0.109  per(accum) = 95.2
 T(sweep opt: construct opS [ifdists=true] ) = 6.320e-07 S  per = 5.22e-05  per(accum) = 95.2
 T(sweep opt: reduction of opS & opH [nccl]) = 6.520e-07 S  per = 5.39e-05  per(accum) = 95.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.148e-03 S  per = 0.26  per(accum) = 95.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.134e-04 S  per = 0.0259  per(accum) = 95.5
 T(sweep opt: qops_pool join and erase     ) = 2.583e-02 S  per = 2.13  per(accum) = 97.7
 T(sweep opt: conversion from opAB to opPQ ) = 2.839e-02 S  per = 2.34  per(accum) = 100
##### global opt: 1.022e+01 S #####
 T(global opt: fetch) = 2.222e-01 S  per = 2.17  per(accum) = 2.17
 T(global opt: hdiag) = 3.231e+00 S  per = 31.6  per(accum) = 33.8
 T(global opt: dvdsn) = 5.367e+00 S  per = 52.5  per(accum) = 86.3
 T(global opt: decim) = 1.867e-01 S  per = 1.83  per(accum) = 88.1
 T(global opt: guess) = 1.400e-03 S  per = 0.0137  per(accum) = 88.1
 T(global opt: renrm) = 1.211e+00 S  per = 11.8  per(accum) = 100
 T(global opt: save ) = 4.284e-03 S  per = 0.0419  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.367e+00 S  T(sum) = 5.361e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 1.786e-03 S  per = 0.0333  per(accum) = 0.0333
 T(global opt: symbolic_formulae           ) = 2.176e-01 S  per = 4.06  per(accum) = 4.09
 T(global opt: hintermediate init          ) = 5.697e-03 S  per = 0.106  per(accum) = 4.2
 T(global opt: preprocess_hformulae_Hxlist ) = 6.975e-02 S  per =  1.3  per(accum) = 5.5
 T(global opt: hmmtasks init               ) = 1.295e-01 S  per = 2.42  per(accum) = 7.91
 T(global opt: initial guess for dvdson    ) = 6.475e-05 S  per = 0.00121  per(accum) = 7.92
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.070e+00 S  per = 75.9  per(accum) = 83.8
 T(global opt: dvdson [cpu-gpu]            ) = 1.067e-01 S  per = 1.99  per(accum) = 85.8
 T(global opt: dvdson [nccl]               ) = 4.553e-04 S  per = 0.00849  per(accum) = 85.8
 T(global opt: dvdson [mpi]                ) = 1.084e-05 S  per = 0.000202  per(accum) = 85.8
 T(global opt: dvdson [rest part(linalg)]  ) = 7.595e-01 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.211e+00 S  T(sum) = 1.211e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.627e-03 S  per = 0.217  per(accum) = 0.217
 T(global opt: qops init                    ) = 3.009e-02 S  per = 2.49  per(accum) = 2.7
 T(global opt: symbolic_formulae_renorm     ) = 2.001e-01 S  per = 16.5  per(accum) = 19.2
 T(global opt: allocate qops on gpu         ) = 9.615e-04 S  per = 0.0794  per(accum) = 19.3
 T(global opt: site memcpy cpu2gpu          ) = 2.531e-02 S  per = 2.09  per(accum) = 21.4
 T(global opt: rintermediate init           ) = 3.822e-02 S  per = 3.16  per(accum) = 24.6
 T(global opt: preprocess_formulae_Rlist2   ) = 6.495e-02 S  per = 5.36  per(accum) = 29.9
 T(global opt: rmmtasks init                ) = 1.274e-01 S  per = 10.5  per(accum) = 40.4
 T(global opt: qops memset on cpu           ) = 7.150e-07 S  per = 5.91e-05  per(accum) = 40.4
 T(global opt: preprocess_renorm_batchGPU   ) = 6.620e-01 S  per = 54.7  per(accum) = 95.1
 T(global opt: deallocate cpu and gpu memory) = 1.315e-03 S  per = 0.109  per(accum) = 95.2
 T(global opt: construct opS [ifdists=true] ) = 6.320e-07 S  per = 5.22e-05  per(accum) = 95.2
 T(global opt: reduction of opS & opH [nccl]) = 6.520e-07 S  per = 5.39e-05  per(accum) = 95.2
 T(global opt: qops memcpy gpu2cpu          ) = 3.148e-03 S  per = 0.26  per(accum) = 95.5
 T(global opt: reduction of opS & opH [mpi] ) = 3.134e-04 S  per = 0.0259  per(accum) = 95.5
 T(global opt: qops_pool join and erase     ) = 2.583e-02 S  per = 2.13  per(accum) = 97.7
 T(global opt: conversion from opAB to opPQ ) = 2.839e-02 S  per = 2.34  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.109e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=18/seqsize=34 dots=1 dbond=(16,0)-(17,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=747:5.699e-03MB:5.566e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=7:5.341e-05MB:5.215e-08GB
total mem of comb=802:6.119e-03MB:5.975e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=17,2,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 14 15
 suppc= 13
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=105:8.011e-04MB:7.823e-07GB
        per(mem): H:4.76 C:32.4 S:5.71 P:0 Q:57.1 
 rqops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1352:0.0103MB:1.01e-05GB
        per(mem): H:2.66 C:7.1 S:63.9 A:5.62 B:20.7 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3793:0.0289MB:2.83e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.096e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(17,0) fdel=./scratch/sweep/lop(16,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-4.768e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(3,16,4) nnz=7:5.341e-05MB
qtensor3: wf3 own=1 _data=0x3c7c6640
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=3
 (26,2):2 (27,3):1
 qbond: qcol nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=72 size=7:5.341e-05MB
### DIAG TIMING: total=4.234e-02 t1=2.206e-05, t2=2.270e-03, t3=2.493e-03, t4=3.753e-02, t5=4.289e-06, t6=1.291e-05, t7=3.317e-06
duration_diagGPU:4.235e-02
duration_diagreduce:1.060e-07
duration_diagtransform:2.610e-07
----- TIMING FOR symbolic_formulae_onedot with size=193 : 2.772e-03 S -----
rank=0 GPUmem(GB): used=2.826e-05 (oper)=2.826e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=193
 no. of hintermediate operators=58
 no. of coefficients=986:7.523e-03MB:7.346e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.898e-05 S -----
rank=0 GPUmem(GB): used=3.561e-05 (oper,hinter)=2.826e-05,7.346e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.897e-04 S size(H_formulae)=193 size(Hxlst2)=3 T(Hmu/Hxlist)=3.767e-04,3.130e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.134e-04 S size(H_formulae)=193 size(Hxlst)=210 -----
rank=0 GPUmem(GB): used=3.561e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.043e-07 batch[need]=1.721e-05 blksize=4 blksize0=2 batchsize=210
rank=0 GPUmem(GB): used=5.292e-05 (oper,hinter,dvdson,batch)=2.826e-05,7.346e-06,1.043e-07,1.721e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=7 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.501e-03,9.947e-03,3.020e-02,1.259e-02,5.524e-02
 analyze_tgpu[Hx]: ndim=7:5.215e-08GB T(cpu-gpu)=2.496e-03 speed=4.178e-05GB/S T(nccl)=4.583e-06 speed=2.276e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=81 t=9.9e-03 per=1.9e+01 cost=1.9e+03 flops=1.9e+05
 sigma[gemm] counter=81 i=0 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=1 t=1.0e-06 per=1.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=2 t=7.5e-03 per=1.4e+01 cost=4.6e+02 flops=6.1e+04
 sigma[gemm] counter=81 i=3 t=7.6e-03 per=1.4e+01 cost=5.1e+02 flops=6.7e+04
 sigma[gemm] counter=81 i=4 t=7.5e-03 per=1.4e+01 cost=5.3e+02 flops=7.0e+04
 sigma[gemm] counter=81 i=5 t=7.5e-03 per=1.4e+01 cost=4.4e+02 flops=5.9e+04
 sigma[gemm] counter=81 total t=3.0e-02 per=5.7e+01 cost=1.9e+03 flops=6.5e+04
 sigma[red] counter=81 t=1.3e-02 per=2.4e+01 cost=9.1e+02 flops=7.2e+04
----- TIMING FOR sigma_tot : t_inter=7.7e-01 t_gemm=2.4e+00 t_reduction=9.8e-01 tot=4.1e+00 -----
 sigma_tot[inter] counter=81 t=7.7e-01 per=1.9e+01 cost=2.5e+06 flops=3.3e+06
 sigma_tot[gemm] counter=81 i=0 t=1.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=1 t=1.3e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=2 t=5.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=81 i=3 t=5.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.9e+06
 sigma_tot[gemm] counter=81 i=4 t=6.0e-01 per=1.5e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=81 i=5 t=5.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=81 total t=2.4e+00 per=5.7e+01 cost=4.3e+06 flops=1.8e+06
 sigma_tot[red] counter=81 t=9.8e-01 per=2.4e+01 cost=1.1e+06 flops=1.2e+06
T(sub)=8.6e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,3.6e-06,1.7e-06,6.1e-07,1.4e-07
settings: ndim=7 neig=1 maxcycle=30 nbuff=4 memory=8e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.314230523770 -1.116e+03  7.518e-06    1     1  5.535e-02 5.535e-02 5.533e-02
TIMING FOR Davidson : 5.537e-02  T(cal/comm/rest)=5.533e-02,1.180e-07,4.299e-05
decomposed t_rest=4.299e-05
 T(sub)    =8.572e-06 per=1.994e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =9.813e-06 per=2.283e+01
 T(xnrm2)  =3.280e-07 per=7.630e-01
 T(other)  =2.428e-05 per=5.647e+01
optimized energies: isweep=0 ibond=18 dots=1 e[0]=-116.314230523770 nmvp=1
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.900e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=16 alg_decim=0 mpisize=1
 qbond: qsuper nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
decimation summary: keep all 64 states
----- TIMING FOR onedot_decimation: 1.9e-04 S T(wf/decim)=7.4e-05,1.1e-04 -----
ctns::oper_renorm coord=(17,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:3.1e-03MB size(tot)=21970:1.7e-01MB:1.6e-04GB
        per(mem): H:1.82 C:8.19 S:46.4 A:12.5 B:31.1 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.972e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 3.018e-03 S -----
rank=0 GPUmem(GB): used=1.985e-04 (oper)=1.912e-04
rank=0 GPUmem(GB): used=2.015e-04 (oper,site)=1.912e-04,2.980e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=176
 no. of coefficients=745:5.684e-03MB:5.551e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.528e-03 S -----
rank=0 GPUmem(GB): used=2.070e-04 (oper,site,rinter)=1.912e-04,2.980e-06,5.551e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 8.437e-03 S size(rtasks)=77 size(Rlst2)=256 T(Rmu/Rlist)=1.135e-03,7.302e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.639e-03 S size(rtasks)=77 size(Rlst)=6692 -----
rank=0 GPUmem(GB): used=2.070e-04 avail=6.176e+00 total=6.176e+00 batch[need]=8.925e-03 blksize=81 blksize0=16 batchsize=6692
rank=0 GPUmem(GB): used=9.132e-03 (oper,site,rinter,batch)=1.912e-04,2.980e-06,5.551e-06,8.925e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.101e-03,2.323e-02,1.002e-02
----- TIMING FOR renorm : t_inter=7.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=19 t=7.1e-03 per=1.8e+01 cost=8.5e+04 flops=1.2e+07
 renorm[gemm] counter=19 i=0 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=1 t=9.6e-07 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=2 t=7.7e-03 per=1.9e+01 cost=1.8e+05 flops=2.3e+07
 renorm[gemm] counter=19 i=3 t=7.8e-03 per=1.9e+01 cost=1.5e+05 flops=1.9e+07
 renorm[gemm] counter=19 i=4 t=1.0e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=5 t=9.4e-07 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=6 t=7.8e-03 per=1.9e+01 cost=1.2e+06 flops=1.5e+08
 renorm[gemm] counter=19 total t=2.3e-02 per=5.8e+01 cost=1.5e+06 flops=6.5e+07
 renorm[red] counter=19 t=1.0e-02 per=2.5e+01 cost=5.3e+05 flops=5.3e+07
----- TIMING FOR renorm_tot : t_inter=1.0e-01 t_gemm=4.1e-01 t_reduction=1.9e-01 tot=7.0e-01 -----
 renorm_tot[inter] counter=19 t=1.0e-01 per=1.5e+01 cost=6.1e+05 flops=5.9e+06
 renorm_tot[gemm] counter=19 i=0 t=2.5e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=1 t=2.1e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=2 t=1.4e-02 per=2.0e+00 cost=1.8e+05 flops=1.3e+07
 renorm_tot[gemm] counter=19 i=3 t=1.5e-02 per=2.2e+00 cost=1.5e+05 flops=1.0e+07
 renorm_tot[gemm] counter=19 i=4 t=1.2e-01 per=1.7e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=19 i=5 t=1.2e-01 per=1.7e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=19 i=6 t=1.4e-01 per=2.0e+01 cost=2.6e+06 flops=1.9e+07
 renorm_tot[gemm] counter=19 total t=4.1e-01 per=5.8e+01 cost=3.4e+06 flops=8.4e+06
 renorm_tot[red] counter=19 t=1.9e-01 per=2.7e+01 cost=1.2e+06 flops=6.4e+06
qops.to_cpu: size(tot)=21970:1.7e-01MB:1.6e-04GB T(to_cpu)=1.2e-04S speed=1.4e+00GB/S
check ||H-H.dagger||=1.127e-16 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.108 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.900e-03 change=1.858e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.349e-03 change=-2.683e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.349e-03 change=-6.437e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 2.235e-01 S #####
 T(local opt: fetch) = 1.191e-02 S  per = 5.33  per(accum) = 5.33
 T(local opt: hdiag) = 4.239e-02 S  per =   19  per(accum) = 24.3
 T(local opt: dvdsn) = 6.002e-02 S  per = 26.9  per(accum) = 51.1
 T(local opt: decim) = 1.958e-04 S  per = 0.0876  per(accum) = 51.2
 T(local opt: guess) = 1.118e-04 S  per = 0.05  per(accum) = 51.3
 T(local opt: renrm) = 1.086e-01 S  per = 48.6  per(accum) = 99.9
 T(local opt: save ) = 2.866e-04 S  per = 0.128  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.002e-02 S  T(sum) = 5.989e-02 S  per = 9.977e+01
 T(local opt: preprocess                  ) = 1.345e-04 S  per = 0.225  per(accum) = 0.225
 T(local opt: symbolic_formulae           ) = 2.780e-03 S  per = 4.64  per(accum) = 4.87
 T(local opt: hintermediate init          ) = 9.191e-05 S  per = 0.153  per(accum) = 5.02
 T(local opt: preprocess_hformulae_Hxlist ) = 7.223e-04 S  per = 1.21  per(accum) = 6.23
 T(local opt: hmmtasks init               ) = 7.859e-04 S  per = 1.31  per(accum) = 7.54
 T(local opt: initial guess for dvdson    ) = 2.291e-06 S  per = 0.00383  per(accum) = 7.54
 T(local opt: dvdson [Hx_batchGPU]        ) = 5.283e-02 S  per = 88.2  per(accum) = 95.8
 T(local opt: dvdson [cpu-gpu]            ) = 2.496e-03 S  per = 4.17  per(accum) = 99.9
 T(local opt: dvdson [nccl]               ) = 4.583e-06 S  per = 0.00765  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 1.180e-07 S  per = 0.000197  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.299e-05 S  per = 0.0718  per(accum) = 100
Detailed decomposition of T(renrm) = 1.086e-01 S  T(sum) = 1.086e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.345e-04 S  per = 0.124  per(accum) = 0.124
 T(local opt: qops init                    ) = 1.778e-03 S  per = 1.64  per(accum) = 1.76
 T(local opt: symbolic_formulae_renorm     ) = 3.027e-03 S  per = 2.79  per(accum) = 4.55
 T(local opt: allocate qops on gpu         ) = 4.392e-05 S  per = 0.0404  per(accum) = 4.59
 T(local opt: site memcpy cpu2gpu          ) = 1.189e-03 S  per = 1.09  per(accum) = 5.68
 T(local opt: rintermediate init           ) = 2.537e-03 S  per = 2.34  per(accum) = 8.02
 T(local opt: preprocess_formulae_Rlist2   ) = 9.855e-03 S  per = 9.07  per(accum) = 17.1
 T(local opt: rmmtasks init                ) = 4.772e-02 S  per = 43.9  per(accum) = 61
 T(local opt: qops memset on cpu           ) = 4.100e-08 S  per = 3.77e-05  per(accum) = 61
 T(local opt: preprocess_renorm_batchGPU   ) = 4.044e-02 S  per = 37.2  per(accum) = 98.2
 T(local opt: deallocate cpu and gpu memory) = 7.235e-04 S  per = 0.666  per(accum) = 98.9
 T(local opt: construct opS [ifdists=true] ) = 4.300e-08 S  per = 3.96e-05  per(accum) = 98.9
 T(local opt: reduction of opS & opH [nccl]) = 3.400e-08 S  per = 3.13e-05  per(accum) = 98.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.339e-04 S  per = 0.123  per(accum) = 99
 T(local opt: reduction of opS & opH [mpi] ) = 5.695e-05 S  per = 0.0524  per(accum) = 99.1
 T(local opt: qops_pool join and erase     ) = 9.877e-04 S  per = 0.909  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.435e-06 S  per = 0.00224  per(accum) = 100
##### sweep opt: 1.045e+01 S #####
 T(sweep opt: fetch) = 2.341e-01 S  per = 2.24  per(accum) = 2.24
 T(sweep opt: hdiag) = 3.273e+00 S  per = 31.3  per(accum) = 33.6
 T(sweep opt: dvdsn) = 5.427e+00 S  per = 51.9  per(accum) = 85.5
 T(sweep opt: decim) = 1.869e-01 S  per = 1.79  per(accum) = 87.3
 T(sweep opt: guess) = 1.512e-03 S  per = 0.0145  per(accum) = 87.3
 T(sweep opt: renrm) = 1.319e+00 S  per = 12.6  per(accum) = 100
 T(sweep opt: save ) = 4.570e-03 S  per = 0.0438  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.427e+00 S  T(sum) = 5.421e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 1.921e-03 S  per = 0.0354  per(accum) = 0.0354
 T(sweep opt: symbolic_formulae           ) = 2.204e-01 S  per = 4.06  per(accum) = 4.1
 T(sweep opt: hintermediate init          ) = 5.789e-03 S  per = 0.107  per(accum) = 4.21
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.047e-02 S  per =  1.3  per(accum) = 5.51
 T(sweep opt: hmmtasks init               ) = 1.303e-01 S  per =  2.4  per(accum) = 7.91
 T(sweep opt: initial guess for dvdson    ) = 6.704e-05 S  per = 0.00124  per(accum) = 7.91
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.123e+00 S  per = 76.1  per(accum) = 84
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.091e-01 S  per = 2.01  per(accum) = 86
 T(sweep opt: dvdson [nccl]               ) = 4.599e-04 S  per = 0.00848  per(accum) = 86
 T(sweep opt: dvdson [mpi]                ) = 1.096e-05 S  per = 0.000202  per(accum) = 86
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.596e-01 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 1.319e+00 S  T(sum) = 1.319e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.761e-03 S  per = 0.209  per(accum) = 0.209
 T(sweep opt: qops init                    ) = 3.186e-02 S  per = 2.42  per(accum) = 2.62
 T(sweep opt: symbolic_formulae_renorm     ) = 2.031e-01 S  per = 15.4  per(accum) = 18
 T(sweep opt: allocate qops on gpu         ) = 1.005e-03 S  per = 0.0762  per(accum) = 18.1
 T(sweep opt: site memcpy cpu2gpu          ) = 2.650e-02 S  per = 2.01  per(accum) = 20.1
 T(sweep opt: rintermediate init           ) = 4.075e-02 S  per = 3.09  per(accum) = 23.2
 T(sweep opt: preprocess_formulae_Rlist2   ) = 7.481e-02 S  per = 5.67  per(accum) = 28.9
 T(sweep opt: rmmtasks init                ) = 1.751e-01 S  per = 13.3  per(accum) = 42.1
 T(sweep opt: qops memset on cpu           ) = 7.560e-07 S  per = 5.73e-05  per(accum) = 42.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.025e-01 S  per = 53.2  per(accum) = 95.4
 T(sweep opt: deallocate cpu and gpu memory) = 2.039e-03 S  per = 0.155  per(accum) = 95.5
 T(sweep opt: construct opS [ifdists=true] ) = 6.750e-07 S  per = 5.12e-05  per(accum) = 95.5
 T(sweep opt: reduction of opS & opH [nccl]) = 6.860e-07 S  per = 5.2e-05  per(accum) = 95.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.282e-03 S  per = 0.249  per(accum) = 95.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.704e-04 S  per = 0.0281  per(accum) = 95.8
 T(sweep opt: qops_pool join and erase     ) = 2.682e-02 S  per = 2.03  per(accum) = 97.8
 T(sweep opt: conversion from opAB to opPQ ) = 2.839e-02 S  per = 2.15  per(accum) = 100
##### global opt: 1.045e+01 S #####
 T(global opt: fetch) = 2.341e-01 S  per = 2.24  per(accum) = 2.24
 T(global opt: hdiag) = 3.273e+00 S  per = 31.3  per(accum) = 33.6
 T(global opt: dvdsn) = 5.427e+00 S  per = 51.9  per(accum) = 85.5
 T(global opt: decim) = 1.869e-01 S  per = 1.79  per(accum) = 87.3
 T(global opt: guess) = 1.512e-03 S  per = 0.0145  per(accum) = 87.3
 T(global opt: renrm) = 1.319e+00 S  per = 12.6  per(accum) = 100
 T(global opt: save ) = 4.570e-03 S  per = 0.0438  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.427e+00 S  T(sum) = 5.421e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 1.921e-03 S  per = 0.0354  per(accum) = 0.0354
 T(global opt: symbolic_formulae           ) = 2.204e-01 S  per = 4.06  per(accum) = 4.1
 T(global opt: hintermediate init          ) = 5.789e-03 S  per = 0.107  per(accum) = 4.21
 T(global opt: preprocess_hformulae_Hxlist ) = 7.047e-02 S  per =  1.3  per(accum) = 5.51
 T(global opt: hmmtasks init               ) = 1.303e-01 S  per =  2.4  per(accum) = 7.91
 T(global opt: initial guess for dvdson    ) = 6.704e-05 S  per = 0.00124  per(accum) = 7.91
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.123e+00 S  per = 76.1  per(accum) = 84
 T(global opt: dvdson [cpu-gpu]            ) = 1.091e-01 S  per = 2.01  per(accum) = 86
 T(global opt: dvdson [nccl]               ) = 4.599e-04 S  per = 0.00848  per(accum) = 86
 T(global opt: dvdson [mpi]                ) = 1.096e-05 S  per = 0.000202  per(accum) = 86
 T(global opt: dvdson [rest part(linalg)]  ) = 7.596e-01 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 1.319e+00 S  T(sum) = 1.319e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.761e-03 S  per = 0.209  per(accum) = 0.209
 T(global opt: qops init                    ) = 3.186e-02 S  per = 2.42  per(accum) = 2.62
 T(global opt: symbolic_formulae_renorm     ) = 2.031e-01 S  per = 15.4  per(accum) = 18
 T(global opt: allocate qops on gpu         ) = 1.005e-03 S  per = 0.0762  per(accum) = 18.1
 T(global opt: site memcpy cpu2gpu          ) = 2.650e-02 S  per = 2.01  per(accum) = 20.1
 T(global opt: rintermediate init           ) = 4.075e-02 S  per = 3.09  per(accum) = 23.2
 T(global opt: preprocess_formulae_Rlist2   ) = 7.481e-02 S  per = 5.67  per(accum) = 28.9
 T(global opt: rmmtasks init                ) = 1.751e-01 S  per = 13.3  per(accum) = 42.1
 T(global opt: qops memset on cpu           ) = 7.560e-07 S  per = 5.73e-05  per(accum) = 42.1
 T(global opt: preprocess_renorm_batchGPU   ) = 7.025e-01 S  per = 53.2  per(accum) = 95.4
 T(global opt: deallocate cpu and gpu memory) = 2.039e-03 S  per = 0.155  per(accum) = 95.5
 T(global opt: construct opS [ifdists=true] ) = 6.750e-07 S  per = 5.12e-05  per(accum) = 95.5
 T(global opt: reduction of opS & opH [nccl]) = 6.860e-07 S  per = 5.2e-05  per(accum) = 95.5
 T(global opt: qops memcpy gpu2cpu          ) = 3.282e-03 S  per = 0.249  per(accum) = 95.8
 T(global opt: reduction of opS & opH [mpi] ) = 3.704e-04 S  per = 0.0281  per(accum) = 95.8
 T(global opt: qops_pool join and erase     ) = 2.682e-02 S  per = 2.03  per(accum) = 97.8
 T(global opt: conversion from opAB to opPQ ) = 2.839e-02 S  per = 2.15  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.909e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=19/seqsize=34 dots=1 dbond=(15,0)-(16,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1140:8.698e-03MB:8.494e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=14:1.068e-04MB:1.043e-07GB
total mem of comb=1202:9.171e-03MB:8.956e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=16,3,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 13 14 15
 suppc= 12
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
 rqops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:0.00305MB size(tot)=21970:0.168MB:0.000164GB
        per(mem): H:1.82 C:8.19 S:46.4 A:12.5 B:31.1 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=24451:0.187MB:0.000182GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.208e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(16,0) fdel=./scratch/sweep/lop(15,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-8.345e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(3,64,4) nnz=14:1.068e-04MB
qtensor3: wf3 own=1 _data=0x3c8768c0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=3
 (25,3):2 (24,2):1
 qbond: qcol nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=4 nblocks=128 size=14:1.068e-04MB
### DIAG TIMING: total=3.017e-02 t1=2.242e-05, t2=2.273e-03, t3=2.474e-03, t4=2.537e-02, t5=4.837e-06, t6=1.994e-05, t7=3.197e-06
duration_diagGPU:3.018e-02
duration_diagreduce:4.200e-08
duration_diagtransform:3.270e-07
----- TIMING FOR symbolic_formulae_onedot with size=297 : 4.945e-03 S -----
rank=0 GPUmem(GB): used=1.822e-04 (oper)=1.822e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=297
 no. of hintermediate operators=114
 no. of coefficients=1824:1.392e-02MB:1.359e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.213e-04 S -----
rank=0 GPUmem(GB): used=1.958e-04 (oper,hinter)=1.822e-04,1.359e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.221e-03 S size(H_formulae)=297 size(Hxlst2)=4 T(Hmu/Hxlist)=6.269e-04,5.937e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.300e-03 S size(H_formulae)=297 size(Hxlst)=438 -----
rank=0 GPUmem(GB): used=1.958e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.086e-07 batch[need]=4.895e-05 blksize=6 blksize0=2 batchsize=438
rank=0 GPUmem(GB): used=2.449e-04 (oper,hinter,dvdson,batch)=1.822e-04,1.359e-05,2.086e-07,4.895e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=14 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.447e-04,9.945e-03,2.983e-02,1.237e-02,5.290e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=7.398e-04 speed=2.820e-04GB/S T(nccl)=4.908e-06 speed=4.251e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=82 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=82 i=0 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=1 t=1.0e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=2 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=82 i=3 t=7.5e-03 per=1.4e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=82 i=4 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=82 i=5 t=7.4e-03 per=1.4e+01 cost=1.6e+03 flops=2.1e+05
 sigma[gemm] counter=82 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.5e+05
 sigma[red] counter=82 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=7.8e-01 t_gemm=2.4e+00 t_reduction=9.9e-01 tot=4.2e+00 -----
 sigma_tot[inter] counter=82 t=7.8e-01 per=1.9e+01 cost=2.5e+06 flops=3.2e+06
 sigma_tot[gemm] counter=82 i=0 t=1.5e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=1 t=1.3e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=2 t=5.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=82 i=3 t=5.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=82 i=4 t=6.0e-01 per=1.5e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=82 i=5 t=6.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=82 total t=2.4e+00 per=5.7e+01 cost=4.3e+06 flops=1.8e+06
 sigma_tot[red] counter=82 t=9.9e-01 per=2.4e+01 cost=1.1e+06 flops=1.2e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,5.6e-06,2.1e-06,1.4e-06,2.0e-07
settings: ndim=14 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.314230523770 -1.116e+03  5.832e-02    1     1  5.302e-02 5.302e-02 5.298e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.328e-03,9.878e-03,2.959e-02,1.246e-02,5.426e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=2.323e-03 speed=8.982e-05GB/S T(nccl)=4.921e-06 speed=4.239e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=83 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.7e+05
 sigma[gemm] counter=83 i=0 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=2 t=7.3e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=83 i=3 t=7.3e-03 per=1.4e+01 cost=3.5e+03 flops=4.8e+05
 sigma[gemm] counter=83 i=4 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=83 i=5 t=7.5e-03 per=1.5e+01 cost=1.6e+03 flops=2.1e+05
 sigma[gemm] counter=83 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=83 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=7.9e-01 t_gemm=2.4e+00 t_reduction=1.0e+00 tot=4.2e+00 -----
 sigma_tot[inter] counter=83 t=7.9e-01 per=1.9e+01 cost=2.5e+06 flops=3.2e+06
 sigma_tot[gemm] counter=83 i=0 t=1.5e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=1 t=1.3e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=2 t=6.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=83 i=3 t=6.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=83 i=4 t=6.1e-01 per=1.5e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=83 i=5 t=6.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=83 total t=2.4e+00 per=5.7e+01 cost=4.3e+06 flops=1.8e+06
 sigma_tot[red] counter=83 t=1.0e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=5.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,2.4e-05,3.2e-06,1.1e-05,2.0e-07
    2   0 -    -116.321452777886 -7.222e-03  1.088e-02    2     2  1.201e-01 6.003e-02 5.367e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.070e-03,1.003e-02,2.982e-02,1.232e-02,5.325e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=1.065e-03 speed=1.960e-04GB/S T(nccl)=5.621e-06 speed=3.711e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=84 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=84 i=0 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=2 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=4.9e+05
 sigma[gemm] counter=84 i=3 t=7.5e-03 per=1.4e+01 cost=3.5e+03 flops=4.6e+05
 sigma[gemm] counter=84 i=4 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=84 i=5 t=7.4e-03 per=1.4e+01 cost=1.6e+03 flops=2.1e+05
 sigma[gemm] counter=84 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.5e+05
 sigma[red] counter=84 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=8.0e-01 t_gemm=2.5e+00 t_reduction=1.0e+00 tot=4.3e+00 -----
 sigma_tot[inter] counter=84 t=8.0e-01 per=1.9e+01 cost=2.5e+06 flops=3.2e+06
 sigma_tot[gemm] counter=84 i=0 t=1.5e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=1 t=1.3e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=2 t=6.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=84 i=3 t=6.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=84 i=4 t=6.2e-01 per=1.5e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=84 i=5 t=6.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=84 total t=2.5e+00 per=5.7e+01 cost=4.3e+06 flops=1.8e+06
 sigma_tot[red] counter=84 t=1.0e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=3.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,2.2e-05,1.2e-05,9.7e-07,1.4e-07
    3   0 -    -116.321975705786 -5.229e-04  2.987e-03    3     3  1.852e-01 6.174e-02 5.356e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.929e-04,9.914e-03,3.001e-02,1.245e-02,5.317e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=7.885e-04 speed=2.646e-04GB/S T(nccl)=4.446e-06 speed=4.692e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=85 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=85 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=1 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=2 t=7.4e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=85 i=3 t=7.5e-03 per=1.4e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=85 i=4 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=85 i=5 t=7.6e-03 per=1.5e+01 cost=1.6e+03 flops=2.1e+05
 sigma[gemm] counter=85 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.5e+05
 sigma[red] counter=85 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=8.1e-01 t_gemm=2.5e+00 t_reduction=1.0e+00 tot=4.3e+00 -----
 sigma_tot[inter] counter=85 t=8.1e-01 per=1.9e+01 cost=2.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=85 i=0 t=1.6e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=1 t=1.3e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=2 t=6.2e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=85 i=3 t=6.2e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=85 i=4 t=6.3e-01 per=1.5e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=85 i=5 t=6.2e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=85 total t=2.5e+00 per=5.7e+01 cost=4.3e+06 flops=1.7e+06
 sigma_tot[red] counter=85 t=1.0e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.3e-05,2.7e-06,8.7e-07,2.1e-07
    4   0 -    -116.322003027943 -2.732e-05  5.455e-04    3     4  2.485e-01 6.211e-02 5.348e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.304e-04,9.867e-03,2.995e-02,1.246e-02,5.261e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=3.259e-04 speed=6.401e-04GB/S T(nccl)=4.479e-06 speed=4.658e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=86 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.7e+05
 sigma[gemm] counter=86 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=1 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=2 t=7.4e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=86 i=3 t=7.5e-03 per=1.4e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=86 i=4 t=7.6e-03 per=1.5e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=86 i=5 t=7.5e-03 per=1.4e+01 cost=1.6e+03 flops=2.1e+05
 sigma[gemm] counter=86 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.5e+05
 sigma[red] counter=86 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=8.2e-01 t_gemm=2.5e+00 t_reduction=1.0e+00 tot=4.4e+00 -----
 sigma_tot[inter] counter=86 t=8.2e-01 per=1.9e+01 cost=2.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=86 i=0 t=1.6e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=1 t=1.3e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=2 t=6.2e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=86 i=3 t=6.2e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=86 i=4 t=6.3e-01 per=1.5e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=86 i=5 t=6.3e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=86 total t=2.5e+00 per=5.7e+01 cost=4.4e+06 flops=1.7e+06
 sigma_tot[red] counter=86 t=1.0e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.3e-05,2.9e-06,9.4e-07,2.3e-07
    5   0 -    -116.322004221593 -1.194e-06  1.622e-04    3     5  3.137e-01 6.274e-02 5.333e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.420e-03,9.914e-03,2.993e-02,1.254e-02,5.381e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=1.416e-03 speed=1.474e-04GB/S T(nccl)=4.619e-06 speed=4.516e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=87 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=87 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=2 t=7.4e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=87 i=3 t=7.5e-03 per=1.4e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=87 i=4 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=87 i=5 t=7.5e-03 per=1.4e+01 cost=1.6e+03 flops=2.1e+05
 sigma[gemm] counter=87 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.5e+05
 sigma[red] counter=87 t=1.3e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=8.3e-01 t_gemm=2.5e+00 t_reduction=1.1e+00 tot=4.4e+00 -----
 sigma_tot[inter] counter=87 t=8.3e-01 per=1.9e+01 cost=2.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=87 i=0 t=1.6e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=1 t=1.3e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=2 t=6.3e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=87 i=3 t=6.3e-01 per=1.4e+01 cost=1.1e+06 flops=1.8e+06
 sigma_tot[gemm] counter=87 i=4 t=6.4e-01 per=1.5e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=87 i=5 t=6.4e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=87 total t=2.5e+00 per=5.7e+01 cost=4.4e+06 flops=1.7e+06
 sigma_tot[red] counter=87 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.3e-05,2.7e-06,8.7e-07,2.0e-07
    6   0 +    -116.322004322050 -1.005e-07  3.779e-05    3     6  3.770e-01 6.283e-02 5.342e-02
TIMING FOR Davidson : 3.770e-01  T(cal/comm/rest)=3.205e-01,5.930e-07,5.647e-02
decomposed t_rest=5.647e-02
 T(sub)    =1.710e-04 per=3.028e-01
 T(precond)=5.616e-02 per=9.946e+01
 T(ortho)  =1.757e-05 per=3.111e-02
 T(xcopy)  =8.520e-07 per=1.509e-03
 T(xnrm2)  =2.267e-06 per=4.015e-03
 T(other)  =1.141e-04 per=2.021e-01
optimized energies: isweep=0 ibond=19 dots=1 e[0]=-116.322004322050 nmvp=6
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.464e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=25 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond19.txt
 qbond: qsuper nsym=25 dimAll=256
 (0,0):1 (2,0):16 (1,1):4 (1,-1):4 (4,0):36 (3,1):24 (3,-1):24 (2,2):6 (2,-2):6 (6,0):16 (5,1):24 (5,-1):24 (4,2):16 (4,-2):16 (3,3):4 (3,-3):4 (8,0):1 (7,1):4 (7,-1):4 (6,2):6 (6,-2):6 (5,3):4 (5,-3):4 (4,4):1 (4,-4):1
timing for divide=1.3e-05
timing for compute=1.2e-02
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(nkr): 1.2e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.3e-05,1.2e-02,0.0e+00,4.0e-06,1.3e-05 -----
decimation summary: 256->3 dwt=+0.000e+00 SvN=6.227e-01
 qbond: qkept nsym=2 dimAll=3
 (5,-3):2 (6,-2):1
----- TIMING for decimation_row(nkr): 1.262e-02 S T(decim/select/formRot)=1.241e-02,1.809e-04,2.574e-05 -----
----- TIMING FOR onedot_decimation: 1.276e-02 S T(wf/decim)=1.095e-04,1.265e-02 -----
ctns::oper_renorm coord=(16,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.463e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=105 : 5.244e-03 S -----
rank=0 GPUmem(GB): used=1.958e-04 (oper)=1.822e-04
rank=0 GPUmem(GB): used=1.959e-04 (oper,site)=1.822e-04,1.043e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=327
 no. of coefficients=1890:1.442e-02MB:1.408e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.526e-03 S -----
rank=0 GPUmem(GB): used=2.099e-04 (oper,site,rinter)=1.822e-04,1.043e-07,1.408e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.984e-03 S size(rtasks)=105 size(Rlst2)=4 T(Rmu/Rlist)=1.417e-03,5.663e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.026e-03 S size(rtasks)=105 size(Rlst)=267 -----
rank=0 GPUmem(GB): used=2.099e-04 avail=6.176e+00 total=6.176e+00 batch[need]=4.376e-05 blksize=6 blksize0=9 batchsize=267
rank=0 GPUmem(GB): used=2.537e-04 (oper,site,rinter,batch)=1.822e-04,1.043e-07,1.408e-05,4.376e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.508e-03,2.241e-02,1.006e-02
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=20 t=6.5e-03 per=1.7e+01 cost=1.2e+04 flops=1.9e+06
 renorm[gemm] counter=20 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=1 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=2 t=7.4e-03 per=1.9e+01 cost=1.3e+03 flops=1.8e+05
 renorm[gemm] counter=20 i=3 t=7.5e-03 per=1.9e+01 cost=2.1e+03 flops=2.8e+05
 renorm[gemm] counter=20 i=4 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=5 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=6 t=7.5e-03 per=1.9e+01 cost=2.5e+03 flops=3.3e+05
 renorm[gemm] counter=20 total t=2.2e-02 per=5.7e+01 cost=6.0e+03 flops=2.7e+05
 renorm[red] counter=20 t=1.0e-02 per=2.6e+01 cost=1.2e+03 flops=1.2e+05
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=4.3e-01 t_reduction=2.0e-01 tot=7.4e-01 -----
 renorm_tot[inter] counter=20 t=1.1e-01 per=1.5e+01 cost=6.2e+05 flops=5.7e+06
 renorm_tot[gemm] counter=20 i=0 t=2.6e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=1 t=2.2e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=2 t=2.1e-02 per=2.9e+00 cost=1.8e+05 flops=8.6e+06
 renorm_tot[gemm] counter=20 i=3 t=2.3e-02 per=3.1e+00 cost=1.5e+05 flops=6.8e+06
 renorm_tot[gemm] counter=20 i=4 t=1.2e-01 per=1.7e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=20 i=5 t=1.2e-01 per=1.6e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=20 i=6 t=1.4e-01 per=2.0e+01 cost=2.6e+06 flops=1.8e+07
 renorm_tot[gemm] counter=20 total t=4.3e-01 per=5.8e+01 cost=3.5e+06 flops=8.0e+06
 renorm_tot[red] counter=20 t=2.0e-01 per=2.7e+01 cost=1.2e+06 flops=6.1e+06
qops.to_cpu: size(tot)=145:1.1e-03MB:1.1e-06GB T(to_cpu)=1.0e-04S speed=1.0e-02GB/S
check ||H-H.dagger||=6.280e-15 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.0534 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.013e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.663e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.125e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.934e-01 S #####
 T(local opt: fetch) = 9.952e-03 S  per = 2.02  per(accum) = 2.02
 T(local opt: hdiag) = 3.022e-02 S  per = 6.13  per(accum) = 8.14
 T(local opt: dvdsn) = 3.855e-01 S  per = 78.1  per(accum) = 86.3
 T(local opt: decim) = 1.279e-02 S  per = 2.59  per(accum) = 88.9
 T(local opt: guess) = 1.640e-04 S  per = 0.0332  per(accum) = 88.9
 T(local opt: renrm) = 5.455e-02 S  per = 11.1  per(accum) = 100
 T(local opt: save ) = 1.718e-04 S  per = 0.0348  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.855e-01 S  T(sum) = 3.854e-01 S  per = 9.996e+01
 T(local opt: preprocess                  ) = 1.892e-04 S  per = 0.0491  per(accum) = 0.0491
 T(local opt: symbolic_formulae           ) = 4.955e-03 S  per = 1.29  per(accum) = 1.33
 T(local opt: hintermediate init          ) = 1.346e-04 S  per = 0.0349  per(accum) = 1.37
 T(local opt: preprocess_hformulae_Hxlist ) = 1.315e-03 S  per = 0.341  per(accum) = 1.71
 T(local opt: hmmtasks init               ) = 1.779e-03 S  per = 0.462  per(accum) = 2.17
 T(local opt: initial guess for dvdson    ) = 4.283e-06 S  per = 0.00111  per(accum) = 2.17
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.138e-01 S  per = 81.4  per(accum) = 83.6
 T(local opt: dvdson [cpu-gpu]            ) = 6.657e-03 S  per = 1.73  per(accum) = 85.3
 T(local opt: dvdson [nccl]               ) = 2.899e-05 S  per = 0.00752  per(accum) = 85.3
 T(local opt: dvdson [mpi]                ) = 5.930e-07 S  per = 0.000154  per(accum) = 85.3
 T(local opt: dvdson [rest part(linalg)]  ) = 5.647e-02 S  per = 14.7  per(accum) = 100
Detailed decomposition of T(renrm) = 5.455e-02 S  T(sum) = 5.455e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.709e-04 S  per = 0.313  per(accum) = 0.313
 T(local opt: qops init                    ) = 9.092e-04 S  per = 1.67  per(accum) = 1.98
 T(local opt: symbolic_formulae_renorm     ) = 5.256e-03 S  per = 9.63  per(accum) = 11.6
 T(local opt: allocate qops on gpu         ) = 4.933e-05 S  per = 0.0904  per(accum) = 11.7
 T(local opt: site memcpy cpu2gpu          ) = 1.807e-03 S  per = 3.31  per(accum) = 15
 T(local opt: rintermediate init           ) = 2.537e-03 S  per = 4.65  per(accum) = 19.7
 T(local opt: preprocess_formulae_Rlist2   ) = 2.038e-03 S  per = 3.74  per(accum) = 23.4
 T(local opt: rmmtasks init                ) = 1.535e-03 S  per = 2.81  per(accum) = 26.2
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 6.05e-05  per(accum) = 26.2
 T(local opt: preprocess_renorm_batchGPU   ) = 3.907e-02 S  per = 71.6  per(accum) = 97.8
 T(local opt: deallocate cpu and gpu memory) = 3.475e-05 S  per = 0.0637  per(accum) = 97.9
 T(local opt: construct opS [ifdists=true] ) = 2.900e-08 S  per = 5.32e-05  per(accum) = 97.9
 T(local opt: reduction of opS & opH [nccl]) = 3.000e-08 S  per = 5.5e-05  per(accum) = 97.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.113e-04 S  per = 0.204  per(accum) = 98.1
 T(local opt: reduction of opS & opH [mpi] ) = 1.444e-05 S  per = 0.0265  per(accum) = 98.1
 T(local opt: qops_pool join and erase     ) = 1.018e-03 S  per = 1.87  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.438e-06 S  per = 0.00264  per(accum) = 100
##### sweep opt: 1.094e+01 S #####
 T(sweep opt: fetch) = 2.441e-01 S  per = 2.23  per(accum) = 2.23
 T(sweep opt: hdiag) = 3.303e+00 S  per = 30.2  per(accum) = 32.4
 T(sweep opt: dvdsn) = 5.812e+00 S  per = 53.1  per(accum) = 85.6
 T(sweep opt: decim) = 1.997e-01 S  per = 1.83  per(accum) = 87.4
 T(sweep opt: guess) = 1.676e-03 S  per = 0.0153  per(accum) = 87.4
 T(sweep opt: renrm) = 1.374e+00 S  per = 12.6  per(accum) = 100
 T(sweep opt: save ) = 4.742e-03 S  per = 0.0433  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.812e+00 S  T(sum) = 5.807e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 2.110e-03 S  per = 0.0363  per(accum) = 0.0363
 T(sweep opt: symbolic_formulae           ) = 2.253e-01 S  per = 3.88  per(accum) = 3.92
 T(sweep opt: hintermediate init          ) = 5.924e-03 S  per = 0.102  per(accum) = 4.02
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.179e-02 S  per = 1.24  per(accum) = 5.26
 T(sweep opt: hmmtasks init               ) = 1.321e-01 S  per = 2.27  per(accum) = 7.53
 T(sweep opt: initial guess for dvdson    ) = 7.132e-05 S  per = 0.00123  per(accum) = 7.53
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.437e+00 S  per = 76.4  per(accum) = 83.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.158e-01 S  per = 1.99  per(accum) = 85.9
 T(sweep opt: dvdson [nccl]               ) = 4.889e-04 S  per = 0.00842  per(accum) = 85.9
 T(sweep opt: dvdson [mpi]                ) = 1.155e-05 S  per = 0.000199  per(accum) = 85.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.160e-01 S  per = 14.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.374e+00 S  T(sum) = 1.374e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.932e-03 S  per = 0.213  per(accum) = 0.213
 T(sweep opt: qops init                    ) = 3.277e-02 S  per = 2.39  per(accum) = 2.6
 T(sweep opt: symbolic_formulae_renorm     ) = 2.084e-01 S  per = 15.2  per(accum) = 17.8
 T(sweep opt: allocate qops on gpu         ) = 1.055e-03 S  per = 0.0768  per(accum) = 17.8
 T(sweep opt: site memcpy cpu2gpu          ) = 2.831e-02 S  per = 2.06  per(accum) = 19.9
 T(sweep opt: rintermediate init           ) = 4.329e-02 S  per = 3.15  per(accum) = 23.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 7.684e-02 S  per = 5.59  per(accum) = 28.6
 T(sweep opt: rmmtasks init                ) = 1.766e-01 S  per = 12.9  per(accum) = 41.5
 T(sweep opt: qops memset on cpu           ) = 7.890e-07 S  per = 5.74e-05  per(accum) = 41.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.415e-01 S  per =   54  per(accum) = 95.5
 T(sweep opt: deallocate cpu and gpu memory) = 2.074e-03 S  per = 0.151  per(accum) = 95.6
 T(sweep opt: construct opS [ifdists=true] ) = 7.040e-07 S  per = 5.12e-05  per(accum) = 95.6
 T(sweep opt: reduction of opS & opH [nccl]) = 7.160e-07 S  per = 5.21e-05  per(accum) = 95.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.394e-03 S  per = 0.247  per(accum) = 95.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.848e-04 S  per = 0.028  per(accum) = 95.9
 T(sweep opt: qops_pool join and erase     ) = 2.784e-02 S  per = 2.03  per(accum) = 97.9
 T(sweep opt: conversion from opAB to opPQ ) = 2.839e-02 S  per = 2.07  per(accum) = 100
##### global opt: 1.094e+01 S #####
 T(global opt: fetch) = 2.441e-01 S  per = 2.23  per(accum) = 2.23
 T(global opt: hdiag) = 3.303e+00 S  per = 30.2  per(accum) = 32.4
 T(global opt: dvdsn) = 5.812e+00 S  per = 53.1  per(accum) = 85.6
 T(global opt: decim) = 1.997e-01 S  per = 1.83  per(accum) = 87.4
 T(global opt: guess) = 1.676e-03 S  per = 0.0153  per(accum) = 87.4
 T(global opt: renrm) = 1.374e+00 S  per = 12.6  per(accum) = 100
 T(global opt: save ) = 4.742e-03 S  per = 0.0433  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.812e+00 S  T(sum) = 5.807e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 2.110e-03 S  per = 0.0363  per(accum) = 0.0363
 T(global opt: symbolic_formulae           ) = 2.253e-01 S  per = 3.88  per(accum) = 3.92
 T(global opt: hintermediate init          ) = 5.924e-03 S  per = 0.102  per(accum) = 4.02
 T(global opt: preprocess_hformulae_Hxlist ) = 7.179e-02 S  per = 1.24  per(accum) = 5.26
 T(global opt: hmmtasks init               ) = 1.321e-01 S  per = 2.27  per(accum) = 7.53
 T(global opt: initial guess for dvdson    ) = 7.132e-05 S  per = 0.00123  per(accum) = 7.53
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.437e+00 S  per = 76.4  per(accum) = 83.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.158e-01 S  per = 1.99  per(accum) = 85.9
 T(global opt: dvdson [nccl]               ) = 4.889e-04 S  per = 0.00842  per(accum) = 85.9
 T(global opt: dvdson [mpi]                ) = 1.155e-05 S  per = 0.000199  per(accum) = 85.9
 T(global opt: dvdson [rest part(linalg)]  ) = 8.160e-01 S  per = 14.1  per(accum) = 100
Detailed decomposition of T(renrm) = 1.374e+00 S  T(sum) = 1.374e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.932e-03 S  per = 0.213  per(accum) = 0.213
 T(global opt: qops init                    ) = 3.277e-02 S  per = 2.39  per(accum) = 2.6
 T(global opt: symbolic_formulae_renorm     ) = 2.084e-01 S  per = 15.2  per(accum) = 17.8
 T(global opt: allocate qops on gpu         ) = 1.055e-03 S  per = 0.0768  per(accum) = 17.8
 T(global opt: site memcpy cpu2gpu          ) = 2.831e-02 S  per = 2.06  per(accum) = 19.9
 T(global opt: rintermediate init           ) = 4.329e-02 S  per = 3.15  per(accum) = 23.1
 T(global opt: preprocess_formulae_Rlist2   ) = 7.684e-02 S  per = 5.59  per(accum) = 28.6
 T(global opt: rmmtasks init                ) = 1.766e-01 S  per = 12.9  per(accum) = 41.5
 T(global opt: qops memset on cpu           ) = 7.890e-07 S  per = 5.74e-05  per(accum) = 41.5
 T(global opt: preprocess_renorm_batchGPU   ) = 7.415e-01 S  per =   54  per(accum) = 95.5
 T(global opt: deallocate cpu and gpu memory) = 2.074e-03 S  per = 0.151  per(accum) = 95.6
 T(global opt: construct opS [ifdists=true] ) = 7.040e-07 S  per = 5.12e-05  per(accum) = 95.6
 T(global opt: reduction of opS & opH [nccl]) = 7.160e-07 S  per = 5.21e-05  per(accum) = 95.6
 T(global opt: qops memcpy gpu2cpu          ) = 3.394e-03 S  per = 0.247  per(accum) = 95.9
 T(global opt: reduction of opS & opH [mpi] ) = 3.848e-04 S  per = 0.028  per(accum) = 95.9
 T(global opt: qops_pool join and erase     ) = 2.784e-02 S  per = 2.03  per(accum) = 97.9
 T(global opt: conversion from opAB to opPQ ) = 2.839e-02 S  per = 2.07  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.402e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=20/seqsize=34 dots=1 dbond=(14,0)-(15,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=6:4.578e-05MB:4.470e-08GB
total mem of comb=1200:9.155e-03MB:8.941e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=15,4,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 12 13 14 15
 suppc= 11
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=2,2 size(op)=4:3.052e-05MB size(tot)=124:9.460e-04MB:9.239e-07GB
        per(mem): H:3.23 C:0 S:0 P:0 Q:96.8 
 rqops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2605:0.0199MB:1.94e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.263e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(15,0) fdel=./scratch/sweep/lop(14,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-5.960e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(2,3,4) nnz=6:4.578e-05MB
qtensor3: wf3 own=1 _data=0x3c4d0090
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=1 dimAll=2
 (23,3):2
 qbond: qcol nsym=2 dimAll=3
 (5,-3):2 (6,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=2 nblocks=8 size=6:4.578e-05MB
### DIAG TIMING: total=8.729e-02 t1=2.167e-05, t2=2.225e-03, t3=2.496e-03, t4=8.251e-02, t5=4.422e-06, t6=2.795e-05, t7=3.163e-06
duration_diagGPU:8.730e-02
duration_diagreduce:7.400e-08
duration_diagtransform:3.040e-07
----- TIMING FOR symbolic_formulae_onedot with size=435 : 7.776e-03 S -----
rank=0 GPUmem(GB): used=1.941e-05 (oper)=1.941e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=435
 no. of hintermediate operators=188
 no. of coefficients=2820:2.151e-02MB:2.101e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.741e-04 S -----
rank=0 GPUmem(GB): used=4.042e-05 (oper,hinter)=1.941e-05,2.101e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.321e-03 S size(H_formulae)=435 size(Hxlst2)=2 T(Hmu/Hxlist)=9.759e-04,3.454e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.345e-03 S size(H_formulae)=435 size(Hxlst)=196 -----
rank=0 GPUmem(GB): used=4.042e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=8.941e-08 batch[need]=1.314e-05 blksize=4 blksize0=0 batchsize=196
rank=0 GPUmem(GB): used=5.365e-05 (oper,hinter,dvdson,batch)=1.941e-05,2.101e-05,8.941e-08,1.314e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=6 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.123e-03,2.507e-03,2.993e-02,1.229e-02,4.686e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=2.118e-03 speed=4.221e-05GB/S T(nccl)=4.392e-06 speed=2.036e-02GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.5e-02 -----
 sigma[inter] counter=88 t=2.5e-03 per=5.6e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=0 t=1.5e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=1 t=1.0e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=2 t=7.5e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=88 i=3 t=7.5e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=88 i=4 t=7.5e-03 per=1.7e+01 cost=5.8e+02 flops=7.7e+04
 sigma[gemm] counter=88 i=5 t=7.5e-03 per=1.7e+01 cost=6.1e+02 flops=8.1e+04
 sigma[gemm] counter=88 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=9.9e+04
 sigma[red] counter=88 t=1.2e-02 per=2.7e+01 cost=1.2e+03 flops=9.6e+04
----- TIMING FOR sigma_tot : t_inter=8.3e-01 t_gemm=2.6e+00 t_reduction=1.1e+00 tot=4.5e+00 -----
 sigma_tot[inter] counter=88 t=8.3e-01 per=1.9e+01 cost=2.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=88 i=0 t=1.6e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=1 t=1.4e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=2 t=6.4e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=88 i=3 t=6.4e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=88 i=4 t=6.5e-01 per=1.5e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=88 i=5 t=6.4e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=88 total t=2.6e+00 per=5.8e+01 cost=4.4e+06 flops=1.7e+06
 sigma_tot[red] counter=88 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=9.1e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,3.8e-06,1.9e-06,6.7e-07,1.7e-07
settings: ndim=6 neig=1 maxcycle=30 nbuff=4 memory=7e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.322004322050 -1.116e+03  4.334e-03    1     1  4.697e-02 4.697e-02 4.695e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.224e-03,2.503e-03,2.981e-02,1.228e-02,4.682e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=2.219e-03 speed=4.029e-05GB/S T(nccl)=4.368e-06 speed=2.047e-02GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.5e-02 -----
 sigma[inter] counter=89 t=2.5e-03 per=5.6e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=0 t=1.7e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=1 t=1.3e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=2 t=7.4e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=89 i=3 t=7.5e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=89 i=4 t=7.5e-03 per=1.7e+01 cost=5.8e+02 flops=7.7e+04
 sigma[gemm] counter=89 i=5 t=7.4e-03 per=1.7e+01 cost=6.1e+02 flops=8.3e+04
 sigma[gemm] counter=89 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=1.0e+05
 sigma[red] counter=89 t=1.2e-02 per=2.8e+01 cost=1.2e+03 flops=9.6e+04
----- TIMING FOR sigma_tot : t_inter=8.3e-01 t_gemm=2.6e+00 t_reduction=1.1e+00 tot=4.5e+00 -----
 sigma_tot[inter] counter=89 t=8.3e-01 per=1.8e+01 cost=2.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=89 i=0 t=1.6e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=1 t=1.4e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=2 t=6.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=89 i=3 t=6.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=89 i=4 t=6.6e-01 per=1.5e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=89 i=5 t=6.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=89 total t=2.6e+00 per=5.8e+01 cost=4.4e+06 flops=1.7e+06
 sigma_tot[red] counter=89 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.0e-05,3.2e-06,8.6e-07,1.9e-07
    2   0 -    -116.322032794698 -2.847e-05  7.625e-04    2     2  1.045e-01 5.226e-02 4.693e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.374e-04,2.547e-03,3.009e-02,1.257e-02,4.566e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=4.328e-04 speed=2.066e-04GB/S T(nccl)=4.646e-06 speed=1.924e-02GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=4.5e-02 -----
 sigma[inter] counter=90 t=2.5e-03 per=5.6e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=0 t=1.7e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=1 t=1.4e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=2 t=7.5e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=90 i=3 t=7.6e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=90 i=4 t=7.5e-03 per=1.7e+01 cost=5.8e+02 flops=7.7e+04
 sigma[gemm] counter=90 i=5 t=7.5e-03 per=1.7e+01 cost=6.1e+02 flops=8.1e+04
 sigma[gemm] counter=90 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=9.9e+04
 sigma[red] counter=90 t=1.3e-02 per=2.8e+01 cost=1.2e+03 flops=9.4e+04
----- TIMING FOR sigma_tot : t_inter=8.4e-01 t_gemm=2.6e+00 t_reduction=1.1e+00 tot=4.6e+00 -----
 sigma_tot[inter] counter=90 t=8.4e-01 per=1.8e+01 cost=2.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=90 i=0 t=1.6e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=1 t=1.4e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=2 t=6.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=90 i=3 t=6.5e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=90 i=4 t=6.6e-01 per=1.5e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=90 i=5 t=6.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=90 total t=2.6e+00 per=5.8e+01 cost=4.4e+06 flops=1.7e+06
 sigma_tot[red] counter=90 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,1.4e-05,2.7e-06,9.0e-07,1.9e-07
    3   0 -    -116.322035104158 -2.309e-06  4.652e-04    3     3  1.606e-01 5.355e-02 4.653e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.419e-03,2.445e-03,2.960e-02,1.243e-02,4.593e-02
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=1.408e-03 speed=6.349e-05GB/S T(nccl)=1.039e-05 speed=8.602e-03GB/S
----- TIMING FOR sigma : t_inter=2.4e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.4e-02 -----
 sigma[inter] counter=91 t=2.4e-03 per=5.5e+00 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=0 t=3.7e-06 per=8.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=1 t=2.7e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=2 t=7.4e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=91 i=3 t=7.4e-03 per=1.7e+01 cost=8.9e+02 flops=1.2e+05
 sigma[gemm] counter=91 i=4 t=7.4e-03 per=1.7e+01 cost=5.8e+02 flops=7.8e+04
 sigma[gemm] counter=91 i=5 t=7.4e-03 per=1.7e+01 cost=6.1e+02 flops=8.2e+04
 sigma[gemm] counter=91 total t=3.0e-02 per=6.7e+01 cost=3.0e+03 flops=1.0e+05
 sigma[red] counter=91 t=1.2e-02 per=2.8e+01 cost=1.2e+03 flops=9.5e+04
----- TIMING FOR sigma_tot : t_inter=8.4e-01 t_gemm=2.7e+00 t_reduction=1.1e+00 tot=4.6e+00 -----
 sigma_tot[inter] counter=91 t=8.4e-01 per=1.8e+01 cost=2.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=91 i=0 t=1.7e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=1 t=1.4e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=2 t=6.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=91 i=3 t=6.6e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=91 i=4 t=6.7e-01 per=1.5e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=91 i=5 t=6.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=91 total t=2.7e+00 per=5.8e+01 cost=4.4e+06 flops=1.6e+06
 sigma_tot[red] counter=91 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,2.2e-05,1.8e-05,1.4e-06,3.3e-07
    4   0 +    -116.322036004501 -9.003e-07  5.842e-05    3     4  2.161e-01 5.402e-02 4.642e-02
TIMING FOR Davidson : 2.161e-01  T(cal/comm/rest)=1.857e-01,4.410e-07,3.041e-02
decomposed t_rest=3.041e-02
 T(sub)    =9.490e-05 per=3.120e-01
 T(precond)=3.020e-02 per=9.928e+01
 T(ortho)  =1.980e-05 per=6.511e-02
 T(xcopy)  =9.010e-07 per=2.963e-03
 T(xnrm2)  =1.756e-06 per=5.774e-03
 T(other)  =1.005e-04 per=3.306e-01
optimized energies: isweep=0 ibond=20 dots=1 e[0]=-116.322036004501 nmvp=4
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.770e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond20.txt
 qbond: qsuper nsym=6 dimAll=12
 (5,-3):2 (6,-2):3 (7,-3):3 (8,-2):1 (7,-1):1 (6,-4):2
timing for divide=1.2e-05
timing for compute=1.6e-02
timing for collect=1.0e-05
----- TMING FOR decimation_genbasis(nkr): 1.6e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.2e-05,1.6e-02,0.0e+00,7.0e-06,1.0e-05 -----
decimation summary: 12->2 dwt=+0.000e+00 SvN=4.485e-02
 qbond: qkept nsym=1 dimAll=2
 (7,-3):2
----- TIMING for decimation_row(nkr): 1.605e-02 S T(decim/select/formRot)=1.586e-02,1.710e-04,1.539e-05 -----
----- TIMING FOR onedot_decimation: 1.614e-02 S T(wf/decim)=6.957e-05,1.607e-02 -----
ctns::oper_renorm coord=(15,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=2,2 size(op)=4:3.052e-05MB size(tot)=124:9.460e-04MB:9.239e-07GB
        per(mem): H:3.23 C:0 S:0 A:0 B:96.8 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.920e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=141 : 7.140e-03 S -----
rank=0 GPUmem(GB): used=4.042e-05 (oper)=1.941e-05
rank=0 GPUmem(GB): used=4.046e-05 (oper,site)=1.941e-05,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=307
 no. of coefficients=2932:2.237e-02MB:2.185e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.534e-03 S -----
rank=0 GPUmem(GB): used=6.231e-05 (oper,site,rinter)=1.941e-05,4.470e-08,2.185e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.953e-03 S size(rtasks)=141 size(Rlst2)=1 T(Rmu/Rlist)=1.652e-03,3.013e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.978e-03 S size(rtasks)=141 size(Rlst)=77 -----
rank=0 GPUmem(GB): used=6.231e-05 avail=6.176e+00 total=6.176e+00 batch[need]=7.458e-06 blksize=4 blksize0=4 batchsize=77
rank=0 GPUmem(GB): used=6.977e-05 (oper,site,rinter,batch)=1.941e-05,4.470e-08,2.185e-05,7.458e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.628e-03,2.262e-02,9.881e-03
----- TIMING FOR renorm : t_inter=7.6e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=4.0e-02 -----
 renorm[inter] counter=21 t=7.6e-03 per=1.9e+01 cost=1.4e+03 flops=1.9e+05
 renorm[gemm] counter=21 i=0 t=1.6e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=1 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=2 t=7.5e-03 per=1.9e+01 cost=1.6e+02 flops=2.2e+04
 renorm[gemm] counter=21 i=3 t=7.6e-03 per=1.9e+01 cost=5.3e+02 flops=7.0e+04
 renorm[gemm] counter=21 i=4 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=5 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=6 t=7.5e-03 per=1.9e+01 cost=9.6e+02 flops=1.3e+05
 renorm[gemm] counter=21 total t=2.3e-02 per=5.6e+01 cost=1.7e+03 flops=7.3e+04
 renorm[red] counter=21 t=9.9e-03 per=2.5e+01 cost=6.2e+02 flops=6.2e+04
----- TIMING FOR renorm_tot : t_inter=1.2e-01 t_gemm=4.5e-01 t_reduction=2.1e-01 tot=7.8e-01 -----
 renorm_tot[inter] counter=21 t=1.2e-01 per=1.5e+01 cost=6.2e+05 flops=5.3e+06
 renorm_tot[gemm] counter=21 i=0 t=2.8e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=21 i=1 t=2.3e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=21 i=2 t=2.9e-02 per=3.7e+00 cost=1.8e+05 flops=6.3e+06
 renorm_tot[gemm] counter=21 i=3 t=3.0e-02 per=3.9e+00 cost=1.5e+05 flops=5.1e+06
 renorm_tot[gemm] counter=21 i=4 t=1.2e-01 per=1.6e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=21 i=5 t=1.2e-01 per=1.6e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=21 i=6 t=1.5e-01 per=1.9e+01 cost=2.6e+06 flops=1.7e+07
 renorm_tot[gemm] counter=21 total t=4.5e-01 per=5.8e+01 cost=3.5e+06 flops=7.6e+06
 renorm_tot[red] counter=21 t=2.1e-01 per=2.7e+01 cost=1.2e+06 flops=5.8e+06
qops.to_cpu: size(tot)=124:9.5e-04MB:9.2e-07GB T(to_cpu)=1.5e-04S speed=6.0e-03GB/S
check ||H-H.dagger||=1.256e-15 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.0543 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.231e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.291e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.459e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 3.967e-01 S #####
 T(local opt: fetch) = 1.102e-02 S  per = 2.78  per(accum) = 2.78
 T(local opt: hdiag) = 8.733e-02 S  per =   22  per(accum) = 24.8
 T(local opt: dvdsn) = 2.264e-01 S  per = 57.1  per(accum) = 81.9
 T(local opt: decim) = 1.615e-02 S  per = 4.07  per(accum) = 85.9
 T(local opt: guess) = 5.940e-05 S  per = 0.015  per(accum) = 85.9
 T(local opt: renrm) = 5.555e-02 S  per =   14  per(accum) = 100
 T(local opt: save ) = 1.948e-04 S  per = 0.0491  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.264e-01 S  T(sum) = 2.262e-01 S  per = 9.990e+01
 T(local opt: preprocess                  ) = 6.316e-05 S  per = 0.0279  per(accum) = 0.0279
 T(local opt: symbolic_formulae           ) = 7.787e-03 S  per = 3.44  per(accum) = 3.47
 T(local opt: hintermediate init          ) = 1.878e-04 S  per = 0.083  per(accum) = 3.55
 T(local opt: preprocess_hformulae_Hxlist ) = 1.354e-03 S  per = 0.598  per(accum) = 4.15
 T(local opt: hmmtasks init               ) = 6.865e-04 S  per = 0.304  per(accum) = 4.46
 T(local opt: initial guess for dvdson    ) = 2.301e-06 S  per = 0.00102  per(accum) = 4.46
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.795e-01 S  per = 79.4  per(accum) = 83.8
 T(local opt: dvdson [cpu-gpu]            ) = 6.178e-03 S  per = 2.73  per(accum) = 86.5
 T(local opt: dvdson [nccl]               ) = 2.380e-05 S  per = 0.0105  per(accum) = 86.6
 T(local opt: dvdson [mpi]                ) = 4.410e-07 S  per = 0.000195  per(accum) = 86.6
 T(local opt: dvdson [rest part(linalg)]  ) = 3.041e-02 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(renrm) = 5.555e-02 S  T(sum) = 5.555e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.105e-05 S  per = 0.11  per(accum) = 0.11
 T(local opt: qops init                    ) = 1.076e-03 S  per = 1.94  per(accum) = 2.05
 T(local opt: symbolic_formulae_renorm     ) = 7.154e-03 S  per = 12.9  per(accum) = 14.9
 T(local opt: allocate qops on gpu         ) = 6.941e-05 S  per = 0.125  per(accum) = 15
 T(local opt: site memcpy cpu2gpu          ) = 5.717e-04 S  per = 1.03  per(accum) = 16.1
 T(local opt: rintermediate init           ) = 2.546e-03 S  per = 4.58  per(accum) = 20.7
 T(local opt: preprocess_formulae_Rlist2   ) = 1.985e-03 S  per = 3.57  per(accum) = 24.2
 T(local opt: rmmtasks init                ) = 4.908e-04 S  per = 0.883  per(accum) = 25.1
 T(local opt: qops memset on cpu           ) = 6.900e-08 S  per = 0.000124  per(accum) = 25.1
 T(local opt: preprocess_renorm_batchGPU   ) = 4.022e-02 S  per = 72.4  per(accum) = 97.5
 T(local opt: deallocate cpu and gpu memory) = 2.486e-05 S  per = 0.0448  per(accum) = 97.6
 T(local opt: construct opS [ifdists=true] ) = 3.400e-08 S  per = 6.12e-05  per(accum) = 97.6
 T(local opt: reduction of opS & opH [nccl]) = 4.300e-08 S  per = 7.74e-05  per(accum) = 97.6
 T(local opt: qops memcpy gpu2cpu          ) = 1.609e-04 S  per = 0.29  per(accum) = 97.9
 T(local opt: reduction of opS & opH [mpi] ) = 1.563e-05 S  per = 0.0281  per(accum) = 97.9
 T(local opt: qops_pool join and erase     ) = 1.176e-03 S  per = 2.12  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.365e-06 S  per = 0.00246  per(accum) = 100
##### sweep opt: 1.134e+01 S #####
 T(sweep opt: fetch) = 2.551e-01 S  per = 2.25  per(accum) = 2.25
 T(sweep opt: hdiag) = 3.390e+00 S  per = 29.9  per(accum) = 32.2
 T(sweep opt: dvdsn) = 6.039e+00 S  per = 53.3  per(accum) = 85.4
 T(sweep opt: decim) = 2.159e-01 S  per =  1.9  per(accum) = 87.3
 T(sweep opt: guess) = 1.735e-03 S  per = 0.0153  per(accum) = 87.3
 T(sweep opt: renrm) = 1.429e+00 S  per = 12.6  per(accum) = 100
 T(sweep opt: save ) = 4.937e-03 S  per = 0.0436  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.039e+00 S  T(sum) = 6.033e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 2.173e-03 S  per = 0.036  per(accum) = 0.036
 T(sweep opt: symbolic_formulae           ) = 2.331e-01 S  per = 3.86  per(accum) = 3.9
 T(sweep opt: hintermediate init          ) = 6.112e-03 S  per = 0.101  per(accum) = 4
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.314e-02 S  per = 1.21  per(accum) = 5.21
 T(sweep opt: hmmtasks init               ) = 1.327e-01 S  per =  2.2  per(accum) = 7.41
 T(sweep opt: initial guess for dvdson    ) = 7.363e-05 S  per = 0.00122  per(accum) = 7.42
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.616e+00 S  per = 76.5  per(accum) = 83.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.220e-01 S  per = 2.02  per(accum) = 86
 T(sweep opt: dvdson [nccl]               ) = 5.127e-04 S  per = 0.0085  per(accum) = 86
 T(sweep opt: dvdson [mpi]                ) = 1.199e-05 S  per = 0.000199  per(accum) = 86
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.465e-01 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 1.429e+00 S  T(sum) = 1.429e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.993e-03 S  per = 0.209  per(accum) = 0.209
 T(sweep opt: qops init                    ) = 3.385e-02 S  per = 2.37  per(accum) = 2.58
 T(sweep opt: symbolic_formulae_renorm     ) = 2.155e-01 S  per = 15.1  per(accum) = 17.7
 T(sweep opt: allocate qops on gpu         ) = 1.124e-03 S  per = 0.0786  per(accum) = 17.7
 T(sweep opt: site memcpy cpu2gpu          ) = 2.888e-02 S  per = 2.02  per(accum) = 19.8
 T(sweep opt: rintermediate init           ) = 4.584e-02 S  per = 3.21  per(accum) = 23
 T(sweep opt: preprocess_formulae_Rlist2   ) = 7.883e-02 S  per = 5.51  per(accum) = 28.5
 T(sweep opt: rmmtasks init                ) = 1.771e-01 S  per = 12.4  per(accum) = 40.9
 T(sweep opt: qops memset on cpu           ) = 8.580e-07 S  per = 6e-05  per(accum) = 40.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.818e-01 S  per = 54.7  per(accum) = 95.6
 T(sweep opt: deallocate cpu and gpu memory) = 2.098e-03 S  per = 0.147  per(accum) = 95.7
 T(sweep opt: construct opS [ifdists=true] ) = 7.380e-07 S  per = 5.16e-05  per(accum) = 95.7
 T(sweep opt: reduction of opS & opH [nccl]) = 7.590e-07 S  per = 5.31e-05  per(accum) = 95.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.555e-03 S  per = 0.249  per(accum) = 96
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.004e-04 S  per = 0.028  per(accum) = 96
 T(sweep opt: qops_pool join and erase     ) = 2.902e-02 S  per = 2.03  per(accum) = 98
 T(sweep opt: conversion from opAB to opPQ ) = 2.839e-02 S  per = 1.99  per(accum) = 100
##### global opt: 1.134e+01 S #####
 T(global opt: fetch) = 2.551e-01 S  per = 2.25  per(accum) = 2.25
 T(global opt: hdiag) = 3.390e+00 S  per = 29.9  per(accum) = 32.2
 T(global opt: dvdsn) = 6.039e+00 S  per = 53.3  per(accum) = 85.4
 T(global opt: decim) = 2.159e-01 S  per =  1.9  per(accum) = 87.3
 T(global opt: guess) = 1.735e-03 S  per = 0.0153  per(accum) = 87.3
 T(global opt: renrm) = 1.429e+00 S  per = 12.6  per(accum) = 100
 T(global opt: save ) = 4.937e-03 S  per = 0.0436  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.039e+00 S  T(sum) = 6.033e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 2.173e-03 S  per = 0.036  per(accum) = 0.036
 T(global opt: symbolic_formulae           ) = 2.331e-01 S  per = 3.86  per(accum) = 3.9
 T(global opt: hintermediate init          ) = 6.112e-03 S  per = 0.101  per(accum) = 4
 T(global opt: preprocess_hformulae_Hxlist ) = 7.314e-02 S  per = 1.21  per(accum) = 5.21
 T(global opt: hmmtasks init               ) = 1.327e-01 S  per =  2.2  per(accum) = 7.41
 T(global opt: initial guess for dvdson    ) = 7.363e-05 S  per = 0.00122  per(accum) = 7.42
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.616e+00 S  per = 76.5  per(accum) = 83.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.220e-01 S  per = 2.02  per(accum) = 86
 T(global opt: dvdson [nccl]               ) = 5.127e-04 S  per = 0.0085  per(accum) = 86
 T(global opt: dvdson [mpi]                ) = 1.199e-05 S  per = 0.000199  per(accum) = 86
 T(global opt: dvdson [rest part(linalg)]  ) = 8.465e-01 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 1.429e+00 S  T(sum) = 1.429e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.993e-03 S  per = 0.209  per(accum) = 0.209
 T(global opt: qops init                    ) = 3.385e-02 S  per = 2.37  per(accum) = 2.58
 T(global opt: symbolic_formulae_renorm     ) = 2.155e-01 S  per = 15.1  per(accum) = 17.7
 T(global opt: allocate qops on gpu         ) = 1.124e-03 S  per = 0.0786  per(accum) = 17.7
 T(global opt: site memcpy cpu2gpu          ) = 2.888e-02 S  per = 2.02  per(accum) = 19.8
 T(global opt: rintermediate init           ) = 4.584e-02 S  per = 3.21  per(accum) = 23
 T(global opt: preprocess_formulae_Rlist2   ) = 7.883e-02 S  per = 5.51  per(accum) = 28.5
 T(global opt: rmmtasks init                ) = 1.771e-01 S  per = 12.4  per(accum) = 40.9
 T(global opt: qops memset on cpu           ) = 8.580e-07 S  per = 6e-05  per(accum) = 40.9
 T(global opt: preprocess_renorm_batchGPU   ) = 7.818e-01 S  per = 54.7  per(accum) = 95.6
 T(global opt: deallocate cpu and gpu memory) = 2.098e-03 S  per = 0.147  per(accum) = 95.7
 T(global opt: construct opS [ifdists=true] ) = 7.380e-07 S  per = 5.16e-05  per(accum) = 95.7
 T(global opt: reduction of opS & opH [nccl]) = 7.590e-07 S  per = 5.31e-05  per(accum) = 95.7
 T(global opt: qops memcpy gpu2cpu          ) = 3.555e-03 S  per = 0.249  per(accum) = 96
 T(global opt: reduction of opS & opH [mpi] ) = 4.004e-04 S  per = 0.028  per(accum) = 96
 T(global opt: qops_pool join and erase     ) = 2.902e-02 S  per = 2.03  per(accum) = 98
 T(global opt: conversion from opAB to opPQ ) = 2.839e-02 S  per = 1.99  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.779e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=21/seqsize=34 dots=1 dbond=(13,0)-(14,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=8:6.104e-05MB:5.960e-08GB
total mem of comb=1202:9.171e-03MB:8.956e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=14,5,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 11 12 13 14 15
 suppc= 10
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=374:2.853e-03MB:2.787e-06GB
        per(mem): H:1.6 C:15 S:6.42 P:0 Q:77 
 rqops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=124:0.000946MB:9.24e-07GB
        per(mem): H:3.23 C:0 S:0 A:0 B:96.8 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2834:0.0216MB:2.11e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.760e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(14,0) fdel=./scratch/sweep/lop(13,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.503e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(4,2,4) nnz=8:6.104e-05MB
qtensor3: wf3 own=1 _data=0x3cbb2940
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=4
 (21,3):2 (22,2):1 (22,4):1
 qbond: qcol nsym=1 dimAll=2
 (7,-3):2
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=12 size=8:6.104e-05MB
### DIAG TIMING: total=1.628e-01 t1=2.532e-05, t2=2.160e-03, t3=2.505e-03, t4=1.581e-01, t5=5.251e-06, t6=1.379e-05, t7=4.266e-06
duration_diagGPU:1.628e-01
duration_diagreduce:9.900e-08
duration_diagtransform:3.450e-07
----- TIMING FOR symbolic_formulae_onedot with size=607 : 1.082e-02 S -----
rank=0 GPUmem(GB): used=2.111e-05 (oper)=2.111e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=607
 no. of hintermediate operators=280
 no. of coefficients=3920:2.991e-02MB:2.921e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.546e-04 S -----
rank=0 GPUmem(GB): used=5.032e-05 (oper,hinter)=2.111e-05,2.921e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.434e-03 S size(H_formulae)=607 size(Hxlst2)=3 T(Hmu/Hxlist)=1.491e-03,9.429e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.562e-03 S size(H_formulae)=607 size(Hxlst)=688 -----
rank=0 GPUmem(GB): used=5.032e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.192e-07 batch[need]=5.639e-05 blksize=4 blksize0=2 batchsize=688
rank=0 GPUmem(GB): used=1.068e-04 (oper,hinter,dvdson,batch)=2.111e-05,2.921e-05,1.192e-07,5.639e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=8 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.984e-04,1.009e-02,3.018e-02,1.243e-02,5.311e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=3.937e-04 speed=3.028e-04GB/S T(nccl)=4.627e-06 speed=2.576e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=92 t=1.0e-02 per=1.9e+01 cost=1.3e+04 flops=1.3e+06
 sigma[gemm] counter=92 i=0 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=1 t=1.0e-06 per=1.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=2 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=92 i=3 t=7.6e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=92 i=4 t=7.6e-03 per=1.4e+01 cost=2.0e+03 flops=2.6e+05
 sigma[gemm] counter=92 i=5 t=7.5e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=92 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=92 t=1.2e-02 per=2.4e+01 cost=3.9e+03 flops=3.1e+05
----- TIMING FOR sigma_tot : t_inter=8.5e-01 t_gemm=2.7e+00 t_reduction=1.1e+00 tot=4.7e+00 -----
 sigma_tot[inter] counter=92 t=8.5e-01 per=1.8e+01 cost=2.6e+06 flops=3.0e+06
 sigma_tot[gemm] counter=92 i=0 t=1.7e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=1 t=1.4e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=2 t=6.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=92 i=3 t=6.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=92 i=4 t=6.8e-01 per=1.5e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=92 i=5 t=6.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=92 total t=2.7e+00 per=5.8e+01 cost=4.4e+06 flops=1.6e+06
 sigma_tot[red] counter=92 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=8.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,3.5e-06,1.7e-06,6.6e-07,1.7e-07
settings: ndim=8 neig=1 maxcycle=30 nbuff=4 memory=9e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.322036004501 -1.116e+03  4.577e-04    1     1  5.322e-02 5.322e-02 5.320e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.747e-04,8.973e-03,5.728e-03,1.248e-03,1.653e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=5.699e-04 speed=2.092e-04GB/S T(nccl)=4.818e-06 speed=2.474e-02GB/S
----- TIMING FOR sigma : t_inter=9.0e-03 t_gemm=5.7e-03 t_reduction=1.2e-03 tot=1.6e-02 -----
 sigma[inter] counter=93 t=9.0e-03 per=5.6e+01 cost=1.3e+04 flops=1.5e+06
 sigma[gemm] counter=93 i=0 t=1.3e-06 per=8.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=1 t=1.2e-06 per=7.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=2 t=1.1e-03 per=6.8e+00 cost=3.4e+03 flops=3.1e+06
 sigma[gemm] counter=93 i=3 t=1.4e-03 per=8.6e+00 cost=3.4e+03 flops=2.5e+06
 sigma[gemm] counter=93 i=4 t=2.2e-03 per=1.4e+01 cost=2.0e+03 flops=9.1e+05
 sigma[gemm] counter=93 i=5 t=1.1e-03 per=6.9e+00 cost=2.0e+03 flops=1.8e+06
 sigma[gemm] counter=93 total t=5.7e-03 per=3.6e+01 cost=1.1e+04 flops=1.9e+06
 sigma[red] counter=93 t=1.2e-03 per=7.8e+00 cost=3.9e+03 flops=3.1e+06
----- TIMING FOR sigma_tot : t_inter=8.6e-01 t_gemm=2.7e+00 t_reduction=1.1e+00 tot=4.7e+00 -----
 sigma_tot[inter] counter=93 t=8.6e-01 per=1.8e+01 cost=2.6e+06 flops=3.0e+06
 sigma_tot[gemm] counter=93 i=0 t=1.7e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=1 t=1.4e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=2 t=6.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=93 i=3 t=6.7e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=93 i=4 t=6.8e-01 per=1.5e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=93 i=5 t=6.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=93 total t=2.7e+00 per=5.8e+01 cost=4.4e+06 flops=1.6e+06
 sigma_tot[red] counter=93 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.1e+06
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,9.6e-06,3.1e-06,7.9e-07,1.9e-07
    2   0 -    -116.322036680222 -6.757e-07  1.350e-04    2     2  8.011e-02 4.005e-02 3.491e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.871e-04,9.986e-03,2.973e-02,1.238e-02,5.299e-02
 analyze_tgpu[Hx]: ndim=8:5.960e-08GB T(cpu-gpu)=8.821e-04 speed=1.351e-04GB/S T(nccl)=4.937e-06 speed=2.415e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=94 t=1.0e-02 per=1.9e+01 cost=1.3e+04 flops=1.3e+06
 sigma[gemm] counter=94 i=0 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=2 t=7.4e-03 per=1.4e+01 cost=3.4e+03 flops=4.6e+05
 sigma[gemm] counter=94 i=3 t=7.5e-03 per=1.4e+01 cost=3.4e+03 flops=4.5e+05
 sigma[gemm] counter=94 i=4 t=7.5e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=94 i=5 t=7.4e-03 per=1.4e+01 cost=2.0e+03 flops=2.7e+05
 sigma[gemm] counter=94 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=94 t=1.2e-02 per=2.4e+01 cost=3.9e+03 flops=3.1e+05
----- TIMING FOR sigma_tot : t_inter=8.7e-01 t_gemm=2.7e+00 t_reduction=1.1e+00 tot=4.7e+00 -----
 sigma_tot[inter] counter=94 t=8.7e-01 per=1.8e+01 cost=2.6e+06 flops=3.0e+06
 sigma_tot[gemm] counter=94 i=0 t=1.7e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=1 t=1.4e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=2 t=6.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=94 i=3 t=6.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=94 i=4 t=6.9e-01 per=1.5e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=94 i=5 t=6.8e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=94 total t=2.7e+00 per=5.8e+01 cost=4.4e+06 flops=1.6e+06
 sigma_tot[red] counter=94 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.3e-05,2.7e-06,8.9e-07,1.9e-07
    3   0 +    -116.322036723062 -4.284e-08  5.976e-05    3     3  1.467e-01 4.890e-02 4.096e-02
TIMING FOR Davidson : 1.467e-01  T(cal/comm/rest)=1.229e-01,2.680e-07,2.382e-02
decomposed t_rest=2.382e-02
 T(sub)    =4.635e-05 per=1.946e-01
 T(precond)=2.369e-02 per=9.946e+01
 T(ortho)  =6.658e-06 per=2.795e-02
 T(xcopy)  =4.840e-07 per=2.032e-03
 T(xnrm2)  =1.090e-06 per=4.576e-03
 T(other)  =7.328e-05 per=3.076e-01
optimized energies: isweep=0 ibond=21 dots=1 e[0]=-116.322036723062 nmvp=3
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=6.065e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=4 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond21.txt
 qbond: qsuper nsym=4 dimAll=8
 (7,-3):2 (9,-3):2 (8,-2):2 (8,-4):2
timing for divide=7.6e-06
timing for compute=9.4e-03
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 9.4e-03 S T(divide/compute[cpu/gpu/rest]/collect)=7.6e-06,9.4e-03,0.0e+00,4.1e-06,1.4e-05 -----
decimation summary: 8->4 dwt=+0.000e+00 SvN=3.351e-01
 qbond: qkept nsym=3 dimAll=4
 (9,-3):2 (8,-2):1 (8,-4):1
----- TIMING for decimation_row(nkr): 9.662e-03 S T(decim/select/formRot)=9.475e-03,1.693e-04,1.779e-05 -----
----- TIMING FOR onedot_decimation: 9.715e-03 S T(wf/decim)=3.533e-05,9.679e-03 -----
ctns::oper_renorm coord=(14,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=374:2.853e-03MB:2.787e-06GB
        per(mem): H:1.6 C:6.42 S:15 A:0 B:77 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.740e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 8.463e-03 S -----
rank=0 GPUmem(GB): used=5.032e-05 (oper)=2.111e-05
rank=0 GPUmem(GB): used=5.038e-05 (oper,site)=2.111e-05,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=287
 no. of coefficients=4090:3.120e-02MB:3.047e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.500e-03 S -----
rank=0 GPUmem(GB): used=8.085e-05 (oper,site,rinter)=2.111e-05,5.960e-08,3.047e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.113e-03 S size(rtasks)=185 size(Rlst2)=9 T(Rmu/Rlist)=1.662e-03,4.511e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.150e-03 S size(rtasks)=185 size(Rlst)=209 -----
rank=0 GPUmem(GB): used=8.085e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.024e-05 blksize=4 blksize0=4 batchsize=209
rank=0 GPUmem(GB): used=1.011e-04 (oper,site,rinter,batch)=2.111e-05,5.960e-08,3.047e-05,2.024e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.452e-03,2.220e-02,9.957e-03
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=22 t=6.5e-03 per=1.7e+01 cost=1.7e+04 flops=2.7e+06
 renorm[gemm] counter=22 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=1 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=2 t=7.4e-03 per=1.9e+01 cost=5.8e+02 flops=7.8e+04
 renorm[gemm] counter=22 i=3 t=7.4e-03 per=1.9e+01 cost=1.5e+03 flops=2.1e+05
 renorm[gemm] counter=22 i=4 t=1.0e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=5 t=9.9e-07 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=6 t=7.5e-03 per=1.9e+01 cost=1.7e+03 flops=2.3e+05
 renorm[gemm] counter=22 total t=2.2e-02 per=5.7e+01 cost=3.8e+03 flops=1.7e+05
 renorm[red] counter=22 t=1.0e-02 per=2.6e+01 cost=8.5e+02 flops=8.6e+04
----- TIMING FOR renorm_tot : t_inter=1.2e-01 t_gemm=4.8e-01 t_reduction=2.2e-01 tot=8.2e-01 -----
 renorm_tot[inter] counter=22 t=1.2e-01 per=1.5e+01 cost=6.4e+05 flops=5.2e+06
 renorm_tot[gemm] counter=22 i=0 t=2.9e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=22 i=1 t=2.4e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=22 i=2 t=3.6e-02 per=4.4e+00 cost=1.8e+05 flops=5.1e+06
 renorm_tot[gemm] counter=22 i=3 t=3.8e-02 per=4.6e+00 cost=1.6e+05 flops=4.1e+06
 renorm_tot[gemm] counter=22 i=4 t=1.2e-01 per=1.5e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=22 i=5 t=1.2e-01 per=1.5e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=22 i=6 t=1.6e-01 per=1.9e+01 cost=2.6e+06 flops=1.7e+07
 renorm_tot[gemm] counter=22 total t=4.8e-01 per=5.8e+01 cost=3.5e+06 flops=7.3e+06
 renorm_tot[red] counter=22 t=2.2e-01 per=2.7e+01 cost=1.2e+06 flops=5.5e+06
qops.to_cpu: size(tot)=374:2.9e-03MB:2.8e-06GB T(to_cpu)=1.7e-04S speed=1.6e-02GB/S
check ||H-H.dagger||=7.850e-17 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.0561 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.412e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.461e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-3.129e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.070e-01 S #####
 T(local opt: fetch) = 1.285e-02 S  per = 3.16  per(accum) = 3.16
 T(local opt: hdiag) = 1.628e-01 S  per =   40  per(accum) = 43.2
 T(local opt: dvdsn) = 1.641e-01 S  per = 40.3  per(accum) = 83.5
 T(local opt: decim) = 9.727e-03 S  per = 2.39  per(accum) = 85.9
 T(local opt: guess) = 6.006e-05 S  per = 0.0148  per(accum) = 85.9
 T(local opt: renrm) = 5.724e-02 S  per = 14.1  per(accum) = 100
 T(local opt: save ) = 1.825e-04 S  per = 0.0448  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.641e-01 S  T(sum) = 1.639e-01 S  per = 9.990e+01
 T(local opt: preprocess                  ) = 7.005e-05 S  per = 0.0427  per(accum) = 0.0427
 T(local opt: symbolic_formulae           ) = 1.083e-02 S  per = 6.61  per(accum) = 6.65
 T(local opt: hintermediate init          ) = 2.727e-04 S  per = 0.166  per(accum) = 6.82
 T(local opt: preprocess_hformulae_Hxlist ) = 2.584e-03 S  per = 1.58  per(accum) = 8.39
 T(local opt: hmmtasks init               ) = 3.432e-03 S  per = 2.09  per(accum) = 10.5
 T(local opt: initial guess for dvdson    ) = 2.263e-06 S  per = 0.00138  per(accum) = 10.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.210e-01 S  per = 73.8  per(accum) = 84.3
 T(local opt: dvdson [cpu-gpu]            ) = 1.846e-03 S  per = 1.13  per(accum) = 85.5
 T(local opt: dvdson [nccl]               ) = 1.438e-05 S  per = 0.00877  per(accum) = 85.5
 T(local opt: dvdson [mpi]                ) = 2.680e-07 S  per = 0.000164  per(accum) = 85.5
 T(local opt: dvdson [rest part(linalg)]  ) = 2.382e-02 S  per = 14.5  per(accum) = 100
Detailed decomposition of T(renrm) = 5.724e-02 S  T(sum) = 5.724e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.107e-05 S  per = 0.0892  per(accum) = 0.0892
 T(local opt: qops init                    ) = 1.452e-03 S  per = 2.54  per(accum) = 2.63
 T(local opt: symbolic_formulae_renorm     ) = 8.478e-03 S  per = 14.8  per(accum) = 17.4
 T(local opt: allocate qops on gpu         ) = 5.206e-05 S  per = 0.0909  per(accum) = 17.5
 T(local opt: site memcpy cpu2gpu          ) = 1.285e-03 S  per = 2.25  per(accum) = 19.8
 T(local opt: rintermediate init           ) = 2.512e-03 S  per = 4.39  per(accum) = 24.2
 T(local opt: preprocess_formulae_Rlist2   ) = 2.161e-03 S  per = 3.78  per(accum) = 27.9
 T(local opt: rmmtasks init                ) = 1.247e-03 S  per = 2.18  per(accum) = 30.1
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 5.94e-05  per(accum) = 30.1
 T(local opt: preprocess_renorm_batchGPU   ) = 3.869e-02 S  per = 67.6  per(accum) = 97.7
 T(local opt: deallocate cpu and gpu memory) = 2.565e-05 S  per = 0.0448  per(accum) = 97.7
 T(local opt: construct opS [ifdists=true] ) = 3.200e-08 S  per = 5.59e-05  per(accum) = 97.7
 T(local opt: reduction of opS & opH [nccl]) = 2.800e-08 S  per = 4.89e-05  per(accum) = 97.7
 T(local opt: qops memcpy gpu2cpu          ) = 1.776e-04 S  per = 0.31  per(accum) = 98.1
 T(local opt: reduction of opS & opH [mpi] ) = 1.529e-05 S  per = 0.0267  per(accum) = 98.1
 T(local opt: qops_pool join and erase     ) = 1.095e-03 S  per = 1.91  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.338e-06 S  per = 0.00234  per(accum) = 100
##### sweep opt: 1.174e+01 S #####
 T(sweep opt: fetch) = 2.679e-01 S  per = 2.28  per(accum) = 2.28
 T(sweep opt: hdiag) = 3.553e+00 S  per = 30.3  per(accum) = 32.5
 T(sweep opt: dvdsn) = 6.203e+00 S  per = 52.8  per(accum) = 85.4
 T(sweep opt: decim) = 2.256e-01 S  per = 1.92  per(accum) = 87.3
 T(sweep opt: guess) = 1.795e-03 S  per = 0.0153  per(accum) = 87.3
 T(sweep opt: renrm) = 1.487e+00 S  per = 12.7  per(accum) = 100
 T(sweep opt: save ) = 5.119e-03 S  per = 0.0436  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.203e+00 S  T(sum) = 6.197e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 2.243e-03 S  per = 0.0362  per(accum) = 0.0362
 T(sweep opt: symbolic_formulae           ) = 2.439e-01 S  per = 3.94  per(accum) = 3.97
 T(sweep opt: hintermediate init          ) = 6.384e-03 S  per = 0.103  per(accum) = 4.08
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.572e-02 S  per = 1.22  per(accum) = 5.3
 T(sweep opt: hmmtasks init               ) = 1.362e-01 S  per =  2.2  per(accum) = 7.5
 T(sweep opt: initial guess for dvdson    ) = 7.589e-05 S  per = 0.00122  per(accum) = 7.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.738e+00 S  per = 76.5  per(accum) = 83.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.238e-01 S  per =    2  per(accum) = 85.9
 T(sweep opt: dvdson [nccl]               ) = 5.271e-04 S  per = 0.00851  per(accum) = 86
 T(sweep opt: dvdson [mpi]                ) = 1.226e-05 S  per = 0.000198  per(accum) = 86
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.703e-01 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 1.487e+00 S  T(sum) = 1.487e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.044e-03 S  per = 0.205  per(accum) = 0.205
 T(sweep opt: qops init                    ) = 3.530e-02 S  per = 2.37  per(accum) = 2.58
 T(sweep opt: symbolic_formulae_renorm     ) = 2.240e-01 S  per = 15.1  per(accum) = 17.6
 T(sweep opt: allocate qops on gpu         ) = 1.176e-03 S  per = 0.0791  per(accum) = 17.7
 T(sweep opt: site memcpy cpu2gpu          ) = 3.017e-02 S  per = 2.03  per(accum) = 19.8
 T(sweep opt: rintermediate init           ) = 4.835e-02 S  per = 3.25  per(accum) = 23
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.099e-02 S  per = 5.45  per(accum) = 28.5
 T(sweep opt: rmmtasks init                ) = 1.784e-01 S  per =   12  per(accum) = 40.5
 T(sweep opt: qops memset on cpu           ) = 8.920e-07 S  per = 6e-05  per(accum) = 40.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.204e-01 S  per = 55.2  per(accum) = 95.6
 T(sweep opt: deallocate cpu and gpu memory) = 2.124e-03 S  per = 0.143  per(accum) = 95.8
 T(sweep opt: construct opS [ifdists=true] ) = 7.700e-07 S  per = 5.18e-05  per(accum) = 95.8
 T(sweep opt: reduction of opS & opH [nccl]) = 7.870e-07 S  per = 5.29e-05  per(accum) = 95.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.732e-03 S  per = 0.251  per(accum) = 96
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.157e-04 S  per = 0.028  per(accum) = 96.1
 T(sweep opt: qops_pool join and erase     ) = 3.011e-02 S  per = 2.03  per(accum) = 98.1
 T(sweep opt: conversion from opAB to opPQ ) = 2.839e-02 S  per = 1.91  per(accum) = 100
##### global opt: 1.174e+01 S #####
 T(global opt: fetch) = 2.679e-01 S  per = 2.28  per(accum) = 2.28
 T(global opt: hdiag) = 3.553e+00 S  per = 30.3  per(accum) = 32.5
 T(global opt: dvdsn) = 6.203e+00 S  per = 52.8  per(accum) = 85.4
 T(global opt: decim) = 2.256e-01 S  per = 1.92  per(accum) = 87.3
 T(global opt: guess) = 1.795e-03 S  per = 0.0153  per(accum) = 87.3
 T(global opt: renrm) = 1.487e+00 S  per = 12.7  per(accum) = 100
 T(global opt: save ) = 5.119e-03 S  per = 0.0436  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.203e+00 S  T(sum) = 6.197e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 2.243e-03 S  per = 0.0362  per(accum) = 0.0362
 T(global opt: symbolic_formulae           ) = 2.439e-01 S  per = 3.94  per(accum) = 3.97
 T(global opt: hintermediate init          ) = 6.384e-03 S  per = 0.103  per(accum) = 4.08
 T(global opt: preprocess_hformulae_Hxlist ) = 7.572e-02 S  per = 1.22  per(accum) = 5.3
 T(global opt: hmmtasks init               ) = 1.362e-01 S  per =  2.2  per(accum) = 7.5
 T(global opt: initial guess for dvdson    ) = 7.589e-05 S  per = 0.00122  per(accum) = 7.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.738e+00 S  per = 76.5  per(accum) = 83.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.238e-01 S  per =    2  per(accum) = 85.9
 T(global opt: dvdson [nccl]               ) = 5.271e-04 S  per = 0.00851  per(accum) = 86
 T(global opt: dvdson [mpi]                ) = 1.226e-05 S  per = 0.000198  per(accum) = 86
 T(global opt: dvdson [rest part(linalg)]  ) = 8.703e-01 S  per =   14  per(accum) = 100
Detailed decomposition of T(renrm) = 1.487e+00 S  T(sum) = 1.487e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.044e-03 S  per = 0.205  per(accum) = 0.205
 T(global opt: qops init                    ) = 3.530e-02 S  per = 2.37  per(accum) = 2.58
 T(global opt: symbolic_formulae_renorm     ) = 2.240e-01 S  per = 15.1  per(accum) = 17.6
 T(global opt: allocate qops on gpu         ) = 1.176e-03 S  per = 0.0791  per(accum) = 17.7
 T(global opt: site memcpy cpu2gpu          ) = 3.017e-02 S  per = 2.03  per(accum) = 19.8
 T(global opt: rintermediate init           ) = 4.835e-02 S  per = 3.25  per(accum) = 23
 T(global opt: preprocess_formulae_Rlist2   ) = 8.099e-02 S  per = 5.45  per(accum) = 28.5
 T(global opt: rmmtasks init                ) = 1.784e-01 S  per =   12  per(accum) = 40.5
 T(global opt: qops memset on cpu           ) = 8.920e-07 S  per = 6e-05  per(accum) = 40.5
 T(global opt: preprocess_renorm_batchGPU   ) = 8.204e-01 S  per = 55.2  per(accum) = 95.6
 T(global opt: deallocate cpu and gpu memory) = 2.124e-03 S  per = 0.143  per(accum) = 95.8
 T(global opt: construct opS [ifdists=true] ) = 7.700e-07 S  per = 5.18e-05  per(accum) = 95.8
 T(global opt: reduction of opS & opH [nccl]) = 7.870e-07 S  per = 5.29e-05  per(accum) = 95.8
 T(global opt: qops memcpy gpu2cpu          ) = 3.732e-03 S  per = 0.251  per(accum) = 96
 T(global opt: reduction of opS & opH [mpi] ) = 4.157e-04 S  per = 0.028  per(accum) = 96.1
 T(global opt: qops_pool join and erase     ) = 3.011e-02 S  per = 2.03  per(accum) = 98.1
 T(global opt: conversion from opAB to opPQ ) = 2.839e-02 S  per = 1.91  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-6.074e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=22/seqsize=34 dots=1 dbond=(12,0)-(13,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=16:1.221e-04MB:1.192e-07GB
total mem of comb=1210:9.232e-03MB:9.015e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=13,6,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc= 9
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=12:9.155e-05MB size(tot)=1040:7.935e-03MB:7.749e-06GB
        per(mem): H:1.15 C:10 S:5.38 P:0 Q:83.5 
 rqops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=374:0.00285MB:2.79e-06GB
        per(mem): H:1.6 C:6.42 S:15 A:0 B:77 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3750:0.0286MB:2.79e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.008e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(13,0) fdel=./scratch/sweep/lop(12,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.225e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,4,4) nnz=16:1.221e-04MB
qtensor3: wf3 own=1 _data=0x3c546f80
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (20,2):2 (19,3):2 (20,4):2
 qbond: qcol nsym=3 dimAll=4
 (9,-3):2 (8,-2):1 (8,-4):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=16:1.221e-04MB
### DIAG TIMING: total=2.218e-01 t1=2.143e-05, t2=2.199e-03, t3=2.521e-03, t4=2.170e-01, t5=5.020e-06, t6=1.218e-05, t7=3.391e-06
duration_diagGPU:2.218e-01
duration_diagreduce:7.700e-08
duration_diagtransform:3.490e-07
----- TIMING FOR symbolic_formulae_onedot with size=813 : 1.425e-02 S -----
rank=0 GPUmem(GB): used=2.794e-05 (oper)=2.794e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=813
 no. of hintermediate operators=390
 no. of coefficients=5070:3.868e-02MB:3.777e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.557e-04 S -----
rank=0 GPUmem(GB): used=6.571e-05 (oper,hinter)=2.794e-05,3.777e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.950e-03 S size(H_formulae)=813 size(Hxlst2)=5 T(Hmu/Hxlist)=1.954e-03,1.996e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.195e-03 S size(H_formulae)=813 size(Hxlst)=1552 -----
rank=0 GPUmem(GB): used=6.571e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.384e-07 batch[need]=1.503e-04 blksize=4 blksize0=4 batchsize=1552
rank=0 GPUmem(GB): used=2.163e-04 (oper,hinter,dvdson,batch)=2.794e-05,3.777e-05,2.384e-07,1.503e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=16 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.146e-03,1.011e-02,3.041e-02,1.253e-02,5.420e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=1.142e-03 speed=2.088e-04GB/S T(nccl)=4.370e-06 speed=5.456e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=95 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=95 i=0 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=1 t=1.0e-06 per=1.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=2 t=7.6e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=95 i=3 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=95 i=4 t=7.6e-03 per=1.4e+01 cost=7.6e+03 flops=9.9e+05
 sigma[gemm] counter=95 i=5 t=7.6e-03 per=1.4e+01 cost=7.1e+03 flops=9.3e+05
 sigma[gemm] counter=95 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=95 t=1.3e-02 per=2.4e+01 cost=1.0e+04 flops=8.2e+05
----- TIMING FOR sigma_tot : t_inter=8.8e-01 t_gemm=2.8e+00 t_reduction=1.1e+00 tot=4.8e+00 -----
 sigma_tot[inter] counter=95 t=8.8e-01 per=1.8e+01 cost=2.6e+06 flops=3.0e+06
 sigma_tot[gemm] counter=95 i=0 t=1.7e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=1 t=1.5e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=2 t=6.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=95 i=3 t=6.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=95 i=4 t=7.0e-01 per=1.5e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=95 i=5 t=6.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=95 total t=2.8e+00 per=5.8e+01 cost=4.4e+06 flops=1.6e+06
 sigma_tot[red] counter=95 t=1.1e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=8.9e-06 T(gemm/eig/ortho/gemm/axpy)=2.3e-06,3.9e-06,1.9e-06,6.1e-07,1.7e-07
settings: ndim=16 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.322036723062 -1.116e+03  5.782e-03    1     1  5.431e-02 5.431e-02 5.429e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.442e-03,1.007e-02,3.037e-02,1.249e-02,5.438e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=1.437e-03 speed=1.659e-04GB/S T(nccl)=4.474e-06 speed=5.329e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=96 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=96 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=2 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=96 i=3 t=7.7e-03 per=1.5e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=96 i=4 t=7.6e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=96 i=5 t=7.6e-03 per=1.4e+01 cost=7.1e+03 flops=9.3e+05
 sigma[gemm] counter=96 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=96 t=1.2e-02 per=2.4e+01 cost=1.0e+04 flops=8.2e+05
----- TIMING FOR sigma_tot : t_inter=8.9e-01 t_gemm=2.8e+00 t_reduction=1.2e+00 tot=4.8e+00 -----
 sigma_tot[inter] counter=96 t=8.9e-01 per=1.8e+01 cost=2.7e+06 flops=3.0e+06
 sigma_tot[gemm] counter=96 i=0 t=1.7e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=1 t=1.5e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=2 t=6.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=96 i=3 t=6.9e-01 per=1.4e+01 cost=1.1e+06 flops=1.7e+06
 sigma_tot[gemm] counter=96 i=4 t=7.0e-01 per=1.5e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=96 i=5 t=7.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=96 total t=2.8e+00 per=5.8e+01 cost=4.5e+06 flops=1.6e+06
 sigma_tot[red] counter=96 t=1.2e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,9.7e-06,3.3e-06,8.4e-07,1.8e-07
    2   0 -    -116.322143984300 -1.073e-04  1.939e-03    2     2  1.181e-01 5.906e-02 5.438e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.475e-03,9.961e-03,3.006e-02,2.609e-03,4.411e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=1.470e-03 speed=1.622e-04GB/S T(nccl)=5.046e-06 speed=4.725e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=2.6e-03 tot=4.3e-02 -----
 sigma[inter] counter=97 t=1.0e-02 per=2.3e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=97 i=0 t=1.5e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=1 t=1.4e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=2 t=7.5e-03 per=1.8e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=97 i=3 t=7.5e-03 per=1.8e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=97 i=4 t=7.6e-03 per=1.8e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=97 i=5 t=7.5e-03 per=1.8e+01 cost=7.1e+03 flops=9.4e+05
 sigma[gemm] counter=97 total t=3.0e-02 per=7.1e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=97 t=2.6e-03 per=6.1e+00 cost=1.0e+04 flops=3.9e+06
----- TIMING FOR sigma_tot : t_inter=9.0e-01 t_gemm=2.8e+00 t_reduction=1.2e+00 tot=4.9e+00 -----
 sigma_tot[inter] counter=97 t=9.0e-01 per=1.8e+01 cost=2.7e+06 flops=3.0e+06
 sigma_tot[gemm] counter=97 i=0 t=1.8e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=1 t=1.5e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=2 t=7.0e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=97 i=3 t=7.0e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=97 i=4 t=7.1e-01 per=1.5e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=97 i=5 t=7.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=97 total t=2.8e+00 per=5.8e+01 cost=4.5e+06 flops=1.6e+06
 sigma_tot[red] counter=97 t=1.2e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.6e-05,2.9e-06,9.5e-07,2.2e-07
    3   0 -    -116.322160749635 -1.677e-05  6.207e-04    3     3  1.717e-01 5.723e-02 5.099e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.243e-03,1.008e-02,2.990e-02,1.244e-02,5.467e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=2.238e-03 speed=1.066e-04GB/S T(nccl)=5.037e-06 speed=4.733e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=98 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=98 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=2 t=7.4e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=98 i=3 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=98 i=4 t=7.5e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=98 i=5 t=7.4e-03 per=1.4e+01 cost=7.1e+03 flops=9.5e+05
 sigma[gemm] counter=98 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.1e+06
 sigma[red] counter=98 t=1.2e-02 per=2.4e+01 cost=1.0e+04 flops=8.3e+05
----- TIMING FOR sigma_tot : t_inter=9.1e-01 t_gemm=2.8e+00 t_reduction=1.2e+00 tot=4.9e+00 -----
 sigma_tot[inter] counter=98 t=9.1e-01 per=1.8e+01 cost=2.7e+06 flops=3.0e+06
 sigma_tot[gemm] counter=98 i=0 t=1.8e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=1 t=1.5e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=2 t=7.1e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=98 i=3 t=7.1e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=98 i=4 t=7.2e-01 per=1.5e+01 cost=1.1e+06 flops=1.5e+06
 sigma_tot[gemm] counter=98 i=5 t=7.1e-01 per=1.4e+01 cost=1.1e+06 flops=1.6e+06
 sigma_tot[gemm] counter=98 total t=2.8e+00 per=5.8e+01 cost=4.5e+06 flops=1.6e+06
 sigma_tot[red] counter=98 t=1.2e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,3.1e-06,8.5e-07,1.7e-07
    4   0 -    -116.322161904565 -1.155e-06  2.090e-04    3     4  2.356e-01 5.889e-02 5.193e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.396e-03,9.809e-03,2.973e-02,1.234e-02,5.328e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=1.391e-03 speed=1.714e-04GB/S T(nccl)=4.671e-06 speed=5.104e-02GB/S
----- TIMING FOR sigma : t_inter=9.8e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=99 t=9.8e-03 per=1.9e+01 cost=4.0e+04 flops=4.1e+06
 sigma[gemm] counter=99 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=2 t=7.4e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=99 i=3 t=7.5e-03 per=1.5e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=99 i=4 t=7.4e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=99 i=5 t=7.4e-03 per=1.4e+01 cost=7.1e+03 flops=9.6e+05
 sigma[gemm] counter=99 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.1e+06
 sigma[red] counter=99 t=1.2e-02 per=2.4e+01 cost=1.0e+04 flops=8.3e+05
----- TIMING FOR sigma_tot : t_inter=9.2e-01 t_gemm=2.9e+00 t_reduction=1.2e+00 tot=5.0e+00 -----
 sigma_tot[inter] counter=99 t=9.2e-01 per=1.8e+01 cost=2.8e+06 flops=3.0e+06
 sigma_tot[gemm] counter=99 i=0 t=1.8e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=1 t=1.5e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=2 t=7.2e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=99 i=3 t=7.2e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=99 i=4 t=7.3e-01 per=1.5e+01 cost=1.1e+06 flops=1.5e+06
 sigma_tot[gemm] counter=99 i=5 t=7.2e-01 per=1.4e+01 cost=1.1e+06 flops=1.5e+06
 sigma_tot[gemm] counter=99 total t=2.9e+00 per=5.8e+01 cost=4.6e+06 flops=1.6e+06
 sigma_tot[red] counter=99 t=1.2e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.2e-05,2.7e-06,8.1e-07,1.9e-07
    5   0 -    -116.322162086116 -1.816e-07  1.035e-04    3     5  2.983e-01 5.967e-02 5.222e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.235e-03,1.005e-02,3.006e-02,1.250e-02,5.385e-02
 analyze_tgpu[Hx]: ndim=16:1.192e-07GB T(cpu-gpu)=1.229e-03 speed=1.940e-04GB/S T(nccl)=5.695e-06 speed=4.186e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=100 t=1.0e-02 per=1.9e+01 cost=4.0e+04 flops=4.0e+06
 sigma[gemm] counter=100 i=0 t=2.9e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=1 t=2.5e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=2 t=7.4e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=100 i=3 t=7.5e-03 per=1.4e+01 cost=8.4e+03 flops=1.1e+06
 sigma[gemm] counter=100 i=4 t=7.6e-03 per=1.4e+01 cost=7.6e+03 flops=1.0e+06
 sigma[gemm] counter=100 i=5 t=7.6e-03 per=1.4e+01 cost=7.1e+03 flops=9.4e+05
 sigma[gemm] counter=100 total t=3.0e-02 per=5.7e+01 cost=3.1e+04 flops=1.0e+06
 sigma[red] counter=100 t=1.2e-02 per=2.4e+01 cost=1.0e+04 flops=8.2e+05
----- TIMING FOR sigma_tot : t_inter=9.3e-01 t_gemm=2.9e+00 t_reduction=1.2e+00 tot=5.0e+00 -----
 sigma_tot[inter] counter=100 t=9.3e-01 per=1.8e+01 cost=2.8e+06 flops=3.0e+06
 sigma_tot[gemm] counter=100 i=0 t=1.8e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=1 t=1.5e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=2 t=7.2e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=100 i=3 t=7.2e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=100 i=4 t=7.3e-01 per=1.5e+01 cost=1.1e+06 flops=1.5e+06
 sigma_tot[gemm] counter=100 i=5 t=7.3e-01 per=1.4e+01 cost=1.1e+06 flops=1.5e+06
 sigma_tot[gemm] counter=100 total t=2.9e+00 per=5.8e+01 cost=4.6e+06 flops=1.6e+06
 sigma_tot[red] counter=100 t=1.2e+00 per=2.4e+01 cost=1.2e+06 flops=1.0e+06
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.9e-05,4.3e-06,1.4e-05,2.7e-07
    6   0 +    -116.322162108317 -2.220e-08  1.484e-05    3     6  3.619e-01 6.032e-02 5.251e-02
TIMING FOR Davidson : 3.619e-01  T(cal/comm/rest)=3.151e-01,5.890e-07,4.686e-02
decomposed t_rest=4.686e-02
 T(sub)    =1.360e-04 per=2.902e-01
 T(precond)=4.656e-02 per=9.935e+01
 T(ortho)  =1.700e-05 per=3.627e-02
 T(xcopy)  =8.130e-07 per=1.735e-03
 T(xnrm2)  =2.718e-06 per=5.800e-03
 T(other)  =1.466e-04 per=3.128e-01
optimized energies: isweep=0 ibond=22 dots=1 e[0]=-116.322162108317 nmvp=6
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.383e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond22.txt
 qbond: qsuper nsym=8 dimAll=16
 (9,-3):4 (8,-2):1 (8,-4):1 (11,-3):2 (10,-2):3 (10,-4):3 (9,-1):1 (9,-5):1
timing for divide=1.4e-05
timing for compute=1.3e-02
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 1.3e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.4e-05,1.3e-02,0.0e+00,6.6e-06,1.4e-05 -----
decimation summary: 16->6 dwt=+0.000e+00 SvN=6.385e-01
 qbond: qkept nsym=3 dimAll=6
 (11,-3):2 (10,-2):2 (10,-4):2
----- TIMING for decimation_row(nkr): 1.326e-02 S T(decim/select/formRot)=1.300e-02,2.350e-04,1.953e-05 -----
----- TIMING FOR onedot_decimation: 1.335e-02 S T(wf/decim)=7.556e-05,1.328e-02 -----
ctns::oper_renorm coord=(13,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=12:9.155e-05MB size(tot)=1040:7.935e-03MB:7.749e-06GB
        per(mem): H:1.15 C:5.38 S:10 A:0 B:83.5 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.238e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=237 : 9.295e-03 S -----
rank=0 GPUmem(GB): used=6.571e-05 (oper)=2.794e-05
rank=0 GPUmem(GB): used=6.583e-05 (oper,site)=2.794e-05,1.192e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=267
 no. of coefficients=5310:4.051e-02MB:3.956e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.476e-03 S -----
rank=0 GPUmem(GB): used=1.054e-04 (oper,site,rinter)=2.794e-05,1.192e-07,3.956e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.350e-03 S size(rtasks)=237 size(Rlst2)=9 T(Rmu/Rlist)=1.481e-03,8.690e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.437e-03 S size(rtasks)=237 size(Rlst)=529 -----
rank=0 GPUmem(GB): used=1.054e-04 avail=6.176e+00 total=6.176e+00 batch[need]=5.124e-05 blksize=4 blksize0=4 batchsize=529
rank=0 GPUmem(GB): used=1.566e-04 (oper,site,rinter,batch)=2.794e-05,1.192e-07,3.956e-05,5.124e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.430e-03,2.270e-02,1.009e-02
----- TIMING FOR renorm : t_inter=6.4e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=23 t=6.4e-03 per=1.6e+01 cost=2.5e+04 flops=4.0e+06
 renorm[gemm] counter=23 i=0 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=1 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=2 t=7.5e-03 per=1.9e+01 cost=1.4e+03 flops=1.8e+05
 renorm[gemm] counter=23 i=3 t=7.5e-03 per=1.9e+01 cost=3.5e+03 flops=4.7e+05
 renorm[gemm] counter=23 i=4 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=5 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=6 t=7.6e-03 per=1.9e+01 cost=6.4e+03 flops=8.3e+05
 renorm[gemm] counter=23 total t=2.3e-02 per=5.8e+01 cost=1.1e+04 flops=5.0e+05
 renorm[red] counter=23 t=1.0e-02 per=2.6e+01 cost=4.2e+03 flops=4.2e+05
----- TIMING FOR renorm_tot : t_inter=1.3e-01 t_gemm=5.0e-01 t_reduction=2.3e-01 tot=8.6e-01 -----
 renorm_tot[inter] counter=23 t=1.3e-01 per=1.5e+01 cost=6.6e+05 flops=5.1e+06
 renorm_tot[gemm] counter=23 i=0 t=3.0e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=23 i=1 t=2.5e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=23 i=2 t=4.4e-02 per=5.1e+00 cost=1.8e+05 flops=4.2e+06
 renorm_tot[gemm] counter=23 i=3 t=4.5e-02 per=5.3e+00 cost=1.6e+05 flops=3.5e+06
 renorm_tot[gemm] counter=23 i=4 t=1.2e-01 per=1.4e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=23 i=5 t=1.2e-01 per=1.4e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=23 i=6 t=1.7e-01 per=1.9e+01 cost=2.6e+06 flops=1.6e+07
 renorm_tot[gemm] counter=23 total t=5.0e-01 per=5.8e+01 cost=3.5e+06 flops=6.9e+06
 renorm_tot[red] counter=23 t=2.3e-01 per=2.7e+01 cost=1.2e+06 flops=5.3e+06
qops.to_cpu: size(tot)=1040:7.9e-03MB:7.7e-06GB T(to_cpu)=2.2e-04S speed=3.5e-02GB/S
check ||H-H.dagger||=5.027e-15 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.0593 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=5.961e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=5.722e-04 change=-1.686e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=5.722e-04 change=-5.662e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 6.960e-01 S #####
 T(local opt: fetch) = 1.065e-02 S  per = 1.53  per(accum) = 1.53
 T(local opt: hdiag) = 2.218e-01 S  per = 31.9  per(accum) = 33.4
 T(local opt: dvdsn) = 3.892e-01 S  per = 55.9  per(accum) = 89.3
 T(local opt: decim) = 1.336e-02 S  per = 1.92  per(accum) = 91.2
 T(local opt: guess) = 7.797e-05 S  per = 0.0112  per(accum) = 91.2
 T(local opt: renrm) = 6.071e-02 S  per = 8.72  per(accum) = 100
 T(local opt: save ) = 2.036e-04 S  per = 0.0293  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.892e-01 S  T(sum) = 3.889e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 9.494e-05 S  per = 0.0244  per(accum) = 0.0244
 T(local opt: symbolic_formulae           ) = 1.427e-02 S  per = 3.67  per(accum) = 3.69
 T(local opt: hintermediate init          ) = 3.720e-04 S  per = 0.0957  per(accum) = 3.79
 T(local opt: preprocess_hformulae_Hxlist ) = 4.240e-03 S  per = 1.09  per(accum) = 4.88
 T(local opt: hmmtasks init               ) = 7.954e-03 S  per = 2.05  per(accum) = 6.93
 T(local opt: initial guess for dvdson    ) = 2.619e-06 S  per = 0.000673  per(accum) = 6.93
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.061e-01 S  per = 78.7  per(accum) = 85.7
 T(local opt: dvdson [cpu-gpu]            ) = 8.906e-03 S  per = 2.29  per(accum) = 87.9
 T(local opt: dvdson [nccl]               ) = 2.929e-05 S  per = 0.00753  per(accum) = 87.9
 T(local opt: dvdson [mpi]                ) = 5.890e-07 S  per = 0.000151  per(accum) = 87.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.686e-02 S  per = 12.1  per(accum) = 100
Detailed decomposition of T(renrm) = 6.071e-02 S  T(sum) = 6.071e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.083e-05 S  per = 0.117  per(accum) = 0.117
 T(local opt: qops init                    ) = 1.807e-03 S  per = 2.98  per(accum) = 3.09
 T(local opt: symbolic_formulae_renorm     ) = 9.310e-03 S  per = 15.3  per(accum) = 18.4
 T(local opt: allocate qops on gpu         ) = 5.104e-05 S  per = 0.0841  per(accum) = 18.5
 T(local opt: site memcpy cpu2gpu          ) = 3.874e-04 S  per = 0.638  per(accum) = 19.1
 T(local opt: rintermediate init           ) = 2.487e-03 S  per =  4.1  per(accum) = 23.2
 T(local opt: preprocess_formulae_Rlist2   ) = 2.457e-03 S  per = 4.05  per(accum) = 27.3
 T(local opt: rmmtasks init                ) = 3.192e-03 S  per = 5.26  per(accum) = 32.5
 T(local opt: qops memset on cpu           ) = 3.200e-08 S  per = 5.27e-05  per(accum) = 32.5
 T(local opt: preprocess_renorm_batchGPU   ) = 3.930e-02 S  per = 64.7  per(accum) = 97.3
 T(local opt: deallocate cpu and gpu memory) = 3.716e-05 S  per = 0.0612  per(accum) = 97.3
 T(local opt: construct opS [ifdists=true] ) = 3.100e-08 S  per = 5.11e-05  per(accum) = 97.3
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 6.26e-05  per(accum) = 97.3
 T(local opt: qops memcpy gpu2cpu          ) = 2.295e-04 S  per = 0.378  per(accum) = 97.7
 T(local opt: reduction of opS & opH [mpi] ) = 1.579e-05 S  per = 0.026  per(accum) = 97.7
 T(local opt: qops_pool join and erase     ) = 1.366e-03 S  per = 2.25  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.383e-06 S  per = 0.00228  per(accum) = 100
##### sweep opt: 1.244e+01 S #####
 T(sweep opt: fetch) = 2.786e-01 S  per = 2.24  per(accum) = 2.24
 T(sweep opt: hdiag) = 3.775e+00 S  per = 30.3  per(accum) = 32.6
 T(sweep opt: dvdsn) = 6.592e+00 S  per =   53  per(accum) = 85.6
 T(sweep opt: decim) = 2.389e-01 S  per = 1.92  per(accum) = 87.5
 T(sweep opt: guess) = 1.873e-03 S  per = 0.0151  per(accum) = 87.5
 T(sweep opt: renrm) = 1.547e+00 S  per = 12.4  per(accum) = 100
 T(sweep opt: save ) = 5.323e-03 S  per = 0.0428  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.592e+00 S  T(sum) = 6.586e+00 S  per = 9.991e+01
 T(sweep opt: preprocess                  ) = 2.338e-03 S  per = 0.0355  per(accum) = 0.0355
 T(sweep opt: symbolic_formulae           ) = 2.582e-01 S  per = 3.92  per(accum) = 3.96
 T(sweep opt: hintermediate init          ) = 6.756e-03 S  per = 0.103  per(accum) = 4.06
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.996e-02 S  per = 1.21  per(accum) = 5.27
 T(sweep opt: hmmtasks init               ) = 1.441e-01 S  per = 2.19  per(accum) = 7.46
 T(sweep opt: initial guess for dvdson    ) = 7.851e-05 S  per = 0.00119  per(accum) = 7.46
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.044e+00 S  per = 76.6  per(accum) = 84
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.327e-01 S  per = 2.02  per(accum) = 86.1
 T(sweep opt: dvdson [nccl]               ) = 5.564e-04 S  per = 0.00845  per(accum) = 86.1
 T(sweep opt: dvdson [mpi]                ) = 1.285e-05 S  per = 0.000195  per(accum) = 86.1
 T(sweep opt: dvdson [rest part(linalg)]  ) = 9.171e-01 S  per = 13.9  per(accum) = 100
Detailed decomposition of T(renrm) = 1.547e+00 S  T(sum) = 1.547e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.115e-03 S  per = 0.201  per(accum) = 0.201
 T(sweep opt: qops init                    ) = 3.711e-02 S  per =  2.4  per(accum) = 2.6
 T(sweep opt: symbolic_formulae_renorm     ) = 2.333e-01 S  per = 15.1  per(accum) = 17.7
 T(sweep opt: allocate qops on gpu         ) = 1.227e-03 S  per = 0.0793  per(accum) = 17.8
 T(sweep opt: site memcpy cpu2gpu          ) = 3.055e-02 S  per = 1.97  per(accum) = 19.7
 T(sweep opt: rintermediate init           ) = 5.084e-02 S  per = 3.29  per(accum) = 23
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.345e-02 S  per = 5.39  per(accum) = 28.4
 T(sweep opt: rmmtasks init                ) = 1.816e-01 S  per = 11.7  per(accum) = 40.1
 T(sweep opt: qops memset on cpu           ) = 9.240e-07 S  per = 5.97e-05  per(accum) = 40.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.597e-01 S  per = 55.6  per(accum) = 95.7
 T(sweep opt: deallocate cpu and gpu memory) = 2.161e-03 S  per = 0.14  per(accum) = 95.8
 T(sweep opt: construct opS [ifdists=true] ) = 8.010e-07 S  per = 5.18e-05  per(accum) = 95.8
 T(sweep opt: reduction of opS & opH [nccl]) = 8.250e-07 S  per = 5.33e-05  per(accum) = 95.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.962e-03 S  per = 0.256  per(accum) = 96.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.315e-04 S  per = 0.0279  per(accum) = 96.1
 T(sweep opt: qops_pool join and erase     ) = 3.148e-02 S  per = 2.03  per(accum) = 98.2
 T(sweep opt: conversion from opAB to opPQ ) = 2.839e-02 S  per = 1.84  per(accum) = 100
##### global opt: 1.244e+01 S #####
 T(global opt: fetch) = 2.786e-01 S  per = 2.24  per(accum) = 2.24
 T(global opt: hdiag) = 3.775e+00 S  per = 30.3  per(accum) = 32.6
 T(global opt: dvdsn) = 6.592e+00 S  per =   53  per(accum) = 85.6
 T(global opt: decim) = 2.389e-01 S  per = 1.92  per(accum) = 87.5
 T(global opt: guess) = 1.873e-03 S  per = 0.0151  per(accum) = 87.5
 T(global opt: renrm) = 1.547e+00 S  per = 12.4  per(accum) = 100
 T(global opt: save ) = 5.323e-03 S  per = 0.0428  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.592e+00 S  T(sum) = 6.586e+00 S  per = 9.991e+01
 T(global opt: preprocess                  ) = 2.338e-03 S  per = 0.0355  per(accum) = 0.0355
 T(global opt: symbolic_formulae           ) = 2.582e-01 S  per = 3.92  per(accum) = 3.96
 T(global opt: hintermediate init          ) = 6.756e-03 S  per = 0.103  per(accum) = 4.06
 T(global opt: preprocess_hformulae_Hxlist ) = 7.996e-02 S  per = 1.21  per(accum) = 5.27
 T(global opt: hmmtasks init               ) = 1.441e-01 S  per = 2.19  per(accum) = 7.46
 T(global opt: initial guess for dvdson    ) = 7.851e-05 S  per = 0.00119  per(accum) = 7.46
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.044e+00 S  per = 76.6  per(accum) = 84
 T(global opt: dvdson [cpu-gpu]            ) = 1.327e-01 S  per = 2.02  per(accum) = 86.1
 T(global opt: dvdson [nccl]               ) = 5.564e-04 S  per = 0.00845  per(accum) = 86.1
 T(global opt: dvdson [mpi]                ) = 1.285e-05 S  per = 0.000195  per(accum) = 86.1
 T(global opt: dvdson [rest part(linalg)]  ) = 9.171e-01 S  per = 13.9  per(accum) = 100
Detailed decomposition of T(renrm) = 1.547e+00 S  T(sum) = 1.547e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.115e-03 S  per = 0.201  per(accum) = 0.201
 T(global opt: qops init                    ) = 3.711e-02 S  per =  2.4  per(accum) = 2.6
 T(global opt: symbolic_formulae_renorm     ) = 2.333e-01 S  per = 15.1  per(accum) = 17.7
 T(global opt: allocate qops on gpu         ) = 1.227e-03 S  per = 0.0793  per(accum) = 17.8
 T(global opt: site memcpy cpu2gpu          ) = 3.055e-02 S  per = 1.97  per(accum) = 19.7
 T(global opt: rintermediate init           ) = 5.084e-02 S  per = 3.29  per(accum) = 23
 T(global opt: preprocess_formulae_Rlist2   ) = 8.345e-02 S  per = 5.39  per(accum) = 28.4
 T(global opt: rmmtasks init                ) = 1.816e-01 S  per = 11.7  per(accum) = 40.1
 T(global opt: qops memset on cpu           ) = 9.240e-07 S  per = 5.97e-05  per(accum) = 40.1
 T(global opt: preprocess_renorm_batchGPU   ) = 8.597e-01 S  per = 55.6  per(accum) = 95.7
 T(global opt: deallocate cpu and gpu memory) = 2.161e-03 S  per = 0.14  per(accum) = 95.8
 T(global opt: construct opS [ifdists=true] ) = 8.010e-07 S  per = 5.18e-05  per(accum) = 95.8
 T(global opt: reduction of opS & opH [nccl]) = 8.250e-07 S  per = 5.33e-05  per(accum) = 95.8
 T(global opt: qops memcpy gpu2cpu          ) = 3.962e-03 S  per = 0.256  per(accum) = 96.1
 T(global opt: reduction of opS & opH [mpi] ) = 4.315e-04 S  per = 0.0279  per(accum) = 96.1
 T(global opt: qops_pool join and erase     ) = 3.148e-02 S  per = 2.03  per(accum) = 98.2
 T(global opt: conversion from opAB to opPQ ) = 2.839e-02 S  per = 1.84  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.390e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=23/seqsize=34 dots=1 dbond=(11,0)-(12,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=24:1.831e-04MB:1.788e-07GB
total mem of comb=1218:9.293e-03MB:9.075e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=12,7,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc= 8
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=7,7 size(op)=17:1.297e-04MB size(tot)=1825:1.392e-02MB:1.360e-05GB
        per(mem): H:0.932 C:6.58 S:4.38 P:0 Q:88.1 
 rqops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=12:9.16e-05MB size(tot)=1040:0.00793MB:7.75e-06GB
        per(mem): H:1.15 C:5.38 S:10 A:0 B:83.5 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=5201:0.0397MB:3.88e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.046e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(12,0) fdel=./scratch/sweep/lop(11,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.490e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(7,6,4) nnz=24:1.831e-04MB
qtensor3: wf3 own=1 _data=0x3c714480
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=7
 (18,2):3 (17,3):2 (18,4):2
 qbond: qcol nsym=3 dimAll=6
 (11,-3):2 (10,-2):2 (10,-4):2
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=24:1.831e-04MB
### DIAG TIMING: total=2.934e-01 t1=2.321e-05, t2=2.259e-03, t3=2.541e-03, t4=2.886e-01, t5=4.864e-06, t6=1.274e-05, t7=4.126e-06
duration_diagGPU:2.935e-01
duration_diagreduce:7.400e-08
duration_diagtransform:4.900e-07
----- TIMING FOR symbolic_formulae_onedot with size=1053 : 1.809e-02 S -----
rank=0 GPUmem(GB): used=3.875e-05 (oper)=3.875e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1053
 no. of hintermediate operators=518
 no. of coefficients=6216:4.742e-02MB:4.631e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.348e-04 S -----
rank=0 GPUmem(GB): used=8.506e-05 (oper,hinter)=3.875e-05,4.631e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.146e-03 S size(H_formulae)=1053 size(Hxlst2)=5 T(Hmu/Hxlist)=2.575e-03,2.571e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.465e-03 S size(H_formulae)=1053 size(Hxlst)=1986 -----
rank=0 GPUmem(GB): used=8.506e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=3.576e-07 batch[need]=2.811e-04 blksize=6 blksize0=6 batchsize=1986
rank=0 GPUmem(GB): used=3.666e-04 (oper,hinter,dvdson,batch)=3.875e-05,4.631e-05,3.576e-07,2.811e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=24 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.865e-03,9.928e-03,2.977e-02,1.250e-02,5.406e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=1.860e-03 speed=1.922e-04GB/S T(nccl)=4.597e-06 speed=7.780e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=101 t=9.9e-03 per=1.9e+01 cost=6.0e+04 flops=6.1e+06
 sigma[gemm] counter=101 i=0 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=1 t=9.9e-07 per=1.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=101 i=3 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=101 i=4 t=7.4e-03 per=1.4e+01 cost=1.5e+04 flops=2.1e+06
 sigma[gemm] counter=101 i=5 t=7.4e-03 per=1.4e+01 cost=1.5e+04 flops=2.1e+06
 sigma[gemm] counter=101 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=101 t=1.2e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=9.4e-01 t_gemm=2.9e+00 t_reduction=1.2e+00 tot=5.1e+00 -----
 sigma_tot[inter] counter=101 t=9.4e-01 per=1.8e+01 cost=2.9e+06 flops=3.1e+06
 sigma_tot[gemm] counter=101 i=0 t=1.8e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=1 t=1.5e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=2 t=7.3e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=101 i=3 t=7.3e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=101 i=4 t=7.4e-01 per=1.5e+01 cost=1.1e+06 flops=1.5e+06
 sigma_tot[gemm] counter=101 i=5 t=7.4e-01 per=1.4e+01 cost=1.1e+06 flops=1.5e+06
 sigma_tot[gemm] counter=101 total t=2.9e+00 per=5.8e+01 cost=4.7e+06 flops=1.6e+06
 sigma_tot[red] counter=101 t=1.2e+00 per=2.4e+01 cost=1.3e+06 flops=1.0e+06
T(sub)=8.9e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,3.8e-06,1.9e-06,6.7e-07,1.6e-07
settings: ndim=24 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.322162108317 -1.116e+03  8.836e-03    1     1  5.418e-02 5.418e-02 5.415e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.205e-03,1.214e-02,2.960e-02,1.251e-02,5.545e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=1.200e-03 speed=2.981e-04GB/S T(nccl)=4.906e-06 speed=7.290e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.4e-02 -----
 sigma[inter] counter=102 t=1.2e-02 per=2.2e+01 cost=6.0e+04 flops=5.0e+06
 sigma[gemm] counter=102 i=0 t=1.6e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=1 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=102 i=3 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=102 i=4 t=7.4e-03 per=1.4e+01 cost=1.5e+04 flops=2.1e+06
 sigma[gemm] counter=102 i=5 t=7.4e-03 per=1.4e+01 cost=1.5e+04 flops=2.1e+06
 sigma[gemm] counter=102 total t=3.0e-02 per=5.5e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=102 t=1.3e-02 per=2.3e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=9.5e-01 t_gemm=3.0e+00 t_reduction=1.2e+00 tot=5.1e+00 -----
 sigma_tot[inter] counter=102 t=9.5e-01 per=1.8e+01 cost=2.9e+06 flops=3.1e+06
 sigma_tot[gemm] counter=102 i=0 t=1.8e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=1 t=1.6e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=2 t=7.4e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=102 i=3 t=7.4e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=102 i=4 t=7.5e-01 per=1.5e+01 cost=1.2e+06 flops=1.5e+06
 sigma_tot[gemm] counter=102 i=5 t=7.4e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=102 total t=3.0e+00 per=5.8e+01 cost=4.7e+06 flops=1.6e+06
 sigma_tot[red] counter=102 t=1.2e+00 per=2.4e+01 cost=1.3e+06 flops=1.0e+06
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.0e-05,3.3e-06,8.9e-07,2.0e-07
    2   0 -    -116.322343412170 -1.813e-04  2.077e-03    2     2  1.193e-01 5.966e-02 5.485e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.219e-03,1.004e-02,2.998e-02,1.257e-02,5.381e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=1.215e-03 speed=2.944e-04GB/S T(nccl)=4.550e-06 speed=7.860e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=103 t=1.0e-02 per=1.9e+01 cost=6.0e+04 flops=6.0e+06
 sigma[gemm] counter=103 i=0 t=3.2e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=1 t=3.9e-06 per=7.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=103 i=3 t=7.5e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=103 i=4 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=103 i=5 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=103 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=103 t=1.3e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=9.6e-01 t_gemm=3.0e+00 t_reduction=1.2e+00 tot=5.2e+00 -----
 sigma_tot[inter] counter=103 t=9.6e-01 per=1.9e+01 cost=3.0e+06 flops=3.1e+06
 sigma_tot[gemm] counter=103 i=0 t=1.9e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=1 t=1.6e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=2 t=7.4e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=103 i=3 t=7.5e-01 per=1.4e+01 cost=1.2e+06 flops=1.7e+06
 sigma_tot[gemm] counter=103 i=4 t=7.6e-01 per=1.5e+01 cost=1.2e+06 flops=1.5e+06
 sigma_tot[gemm] counter=103 i=5 t=7.5e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=103 total t=3.0e+00 per=5.8e+01 cost=4.8e+06 flops=1.6e+06
 sigma_tot[red] counter=103 t=1.2e+00 per=2.4e+01 cost=1.3e+06 flops=1.1e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.3e-05,2.8e-06,9.6e-07,1.8e-07
    3   0 -    -116.322360945000 -1.753e-05  9.524e-04    3     3  1.828e-01 6.093e-02 5.453e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.837e-04,1.002e-02,3.018e-02,1.252e-02,5.330e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=5.787e-04 speed=6.180e-04GB/S T(nccl)=4.949e-06 speed=7.226e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=104 t=1.0e-02 per=1.9e+01 cost=6.0e+04 flops=6.0e+06
 sigma[gemm] counter=104 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=2 t=7.6e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=104 i=3 t=7.6e-03 per=1.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=104 i=4 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=104 i=5 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=104 total t=3.0e-02 per=5.7e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=104 t=1.3e-02 per=2.4e+01 cost=1.9e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=9.7e-01 t_gemm=3.0e+00 t_reduction=1.2e+00 tot=5.2e+00 -----
 sigma_tot[inter] counter=104 t=9.7e-01 per=1.9e+01 cost=3.1e+06 flops=3.2e+06
 sigma_tot[gemm] counter=104 i=0 t=1.9e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=1 t=1.6e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=2 t=7.5e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=104 i=3 t=7.5e-01 per=1.4e+01 cost=1.3e+06 flops=1.7e+06
 sigma_tot[gemm] counter=104 i=4 t=7.6e-01 per=1.5e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=104 i=5 t=7.6e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=104 total t=3.0e+00 per=5.8e+01 cost=4.9e+06 flops=1.6e+06
 sigma_tot[red] counter=104 t=1.2e+00 per=2.4e+01 cost=1.3e+06 flops=1.1e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.2e-05,2.8e-06,8.9e-07,1.8e-07
    4   0 -    -116.322362823573 -1.879e-06  2.502e-04    3     4  2.485e-01 6.212e-02 5.425e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.210e-03,1.219e-02,3.009e-02,9.410e-03,5.290e-02
 analyze_tgpu[Hx]: ndim=24:1.788e-07GB T(cpu-gpu)=1.204e-03 speed=2.971e-04GB/S T(nccl)=6.452e-06 speed=5.543e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=9.4e-03 tot=5.2e-02 -----
 sigma[inter] counter=105 t=1.2e-02 per=2.4e+01 cost=6.0e+04 flops=5.0e+06
 sigma[gemm] counter=105 i=0 t=3.8e-06 per=7.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=1 t=3.3e-06 per=6.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=2 t=7.6e-03 per=1.5e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=105 i=3 t=7.5e-03 per=1.5e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=105 i=4 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=105 i=5 t=7.5e-03 per=1.5e+01 cost=1.5e+04 flops=2.0e+06
 sigma[gemm] counter=105 total t=3.0e-02 per=5.8e+01 cost=6.6e+04 flops=2.2e+06
 sigma[red] counter=105 t=9.4e-03 per=1.8e+01 cost=1.9e+04 flops=2.0e+06
----- TIMING FOR sigma_tot : t_inter=9.8e-01 t_gemm=3.1e+00 t_reduction=1.3e+00 tot=5.3e+00 -----
 sigma_tot[inter] counter=105 t=9.8e-01 per=1.9e+01 cost=3.1e+06 flops=3.2e+06
 sigma_tot[gemm] counter=105 i=0 t=1.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=1 t=1.6e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=2 t=7.6e-01 per=1.4e+01 cost=1.3e+06 flops=1.7e+06
 sigma_tot[gemm] counter=105 i=3 t=7.6e-01 per=1.4e+01 cost=1.3e+06 flops=1.7e+06
 sigma_tot[gemm] counter=105 i=4 t=7.7e-01 per=1.5e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=105 i=5 t=7.7e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=105 total t=3.1e+00 per=5.8e+01 cost=4.9e+06 flops=1.6e+06
 sigma_tot[red] counter=105 t=1.3e+00 per=2.4e+01 cost=1.3e+06 flops=1.1e+06
T(sub)=3.7e-05 T(gemm/eig/ortho/gemm/axpy)=6.8e-06,2.3e-05,5.2e-06,1.8e-06,3.5e-07
    5   0 +    -116.322363025516 -2.019e-07  4.939e-05    3     5  3.112e-01 6.224e-02 5.402e-02
TIMING FOR Davidson : 3.112e-01  T(cal/comm/rest)=2.701e-01,5.600e-07,4.112e-02
decomposed t_rest=4.112e-02
 T(sub)    =1.061e-04 per=2.581e-01
 T(precond)=4.087e-02 per=9.939e+01
 T(ortho)  =1.352e-05 per=3.287e-02
 T(xcopy)  =8.400e-07 per=2.043e-03
 T(xnrm2)  =2.390e-06 per=5.812e-03
 T(other)  =1.285e-04 per=3.124e-01
optimized energies: isweep=0 ibond=23 dots=1 e[0]=-116.322363025516 nmvp=5
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.199e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond23.txt
 qbond: qsuper nsym=8 dimAll=24
 (11,-3):6 (10,-2):2 (10,-4):2 (13,-3):2 (12,-2):4 (12,-4):4 (11,-1):2 (11,-5):2
timing for divide=1.8e-05
timing for compute=1.7e-02
timing for collect=2.1e-05
----- TMING FOR decimation_genbasis(nkr): 1.7e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.8e-05,1.7e-02,0.0e+00,8.1e-06,2.1e-05 -----
decimation summary: 24->7 dwt=-2.220e-16 SvN=9.814e-01
 qbond: qkept nsym=3 dimAll=7
 (12,-2):3 (13,-3):2 (12,-4):2
----- TIMING for decimation_row(nkr): 1.697e-02 S T(decim/select/formRot)=1.668e-02,2.585e-04,2.845e-05 -----
----- TIMING FOR onedot_decimation: 1.710e-02 S T(wf/decim)=9.652e-05,1.700e-02 -----
ctns::oper_renorm coord=(12,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=7,7 size(op)=17:1.297e-04MB size(tot)=1825:1.392e-02MB:1.360e-05GB
        per(mem): H:0.932 C:4.38 S:6.58 A:0 B:88.1 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.551e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=297 : 2.619e-02 S -----
rank=0 GPUmem(GB): used=8.506e-05 (oper)=3.875e-05
rank=0 GPUmem(GB): used=8.524e-05 (oper,site)=3.875e-05,1.788e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=247
 no. of coefficients=6538:4.988e-02MB:4.871e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.490e-03 S -----
rank=0 GPUmem(GB): used=1.340e-04 (oper,site,rinter)=3.875e-05,1.788e-07,4.871e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 6.312e-03 S size(rtasks)=297 size(Rlst2)=9 T(Rmu/Rlist)=3.987e-03,2.325e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.488e-03 S size(rtasks)=297 size(Rlst)=610 -----
rank=0 GPUmem(GB): used=1.340e-04 avail=6.176e+00 total=6.176e+00 batch[need]=1.045e-04 blksize=9 blksize0=4 batchsize=610
rank=0 GPUmem(GB): used=2.385e-04 (oper,site,rinter,batch)=3.875e-05,1.788e-07,4.871e-05,1.045e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.274e-03,2.217e-02,9.965e-03
----- TIMING FOR renorm : t_inter=7.3e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=24 t=7.3e-03 per=1.8e+01 cost=3.9e+04 flops=5.3e+06
 renorm[gemm] counter=24 i=0 t=2.9e-06 per=7.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=1 t=2.3e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=2 t=7.4e-03 per=1.9e+01 cost=2.4e+03 flops=3.3e+05
 renorm[gemm] counter=24 i=3 t=7.4e-03 per=1.9e+01 cost=8.1e+03 flops=1.1e+06
 renorm[gemm] counter=24 i=4 t=8.4e-06 per=2.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=5 t=2.1e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=6 t=7.4e-03 per=1.9e+01 cost=1.4e+04 flops=1.9e+06
 renorm[gemm] counter=24 total t=2.2e-02 per=5.6e+01 cost=2.5e+04 flops=1.1e+06
 renorm[red] counter=24 t=1.0e-02 per=2.5e+01 cost=7.0e+03 flops=7.1e+05
----- TIMING FOR renorm_tot : t_inter=1.4e-01 t_gemm=5.2e-01 t_reduction=2.4e-01 tot=9.0e-01 -----
 renorm_tot[inter] counter=24 t=1.4e-01 per=1.5e+01 cost=7.0e+05 flops=5.1e+06
 renorm_tot[gemm] counter=24 i=0 t=3.3e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=24 i=1 t=2.8e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=24 i=2 t=5.1e-02 per=5.7e+00 cost=1.9e+05 flops=3.7e+06
 renorm_tot[gemm] counter=24 i=3 t=5.3e-02 per=5.9e+00 cost=1.7e+05 flops=3.2e+06
 renorm_tot[gemm] counter=24 i=4 t=1.2e-01 per=1.4e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=24 i=5 t=1.2e-01 per=1.4e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=24 i=6 t=1.7e-01 per=1.9e+01 cost=2.6e+06 flops=1.5e+07
 renorm_tot[gemm] counter=24 total t=5.2e-01 per=5.8e+01 cost=3.5e+06 flops=6.7e+06
 renorm_tot[red] counter=24 t=2.4e-01 per=2.7e+01 cost=1.2e+06 flops=5.1e+06
qops.to_cpu: size(tot)=1825:1.4e-02MB:1.4e-05GB T(to_cpu)=5.3e-04S speed=2.6e-02GB/S
check ||H-H.dagger||=7.540e-15 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.0894 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=7.391e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=3.433e-04 change=-1.886e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=3.433e-04 change=-6.258e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 7.615e-01 S #####
 T(local opt: fetch) = 1.238e-02 S  per = 1.63  per(accum) = 1.63
 T(local opt: hdiag) = 2.935e-01 S  per = 38.5  per(accum) = 40.2
 T(local opt: dvdsn) = 3.464e-01 S  per = 45.5  per(accum) = 85.6
 T(local opt: decim) = 1.711e-02 S  per = 2.25  per(accum) = 87.9
 T(local opt: guess) = 1.143e-04 S  per = 0.015  per(accum) = 87.9
 T(local opt: renrm) = 9.172e-02 S  per =   12  per(accum) = 100
 T(local opt: save ) = 3.388e-04 S  per = 0.0445  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.464e-01 S  T(sum) = 3.460e-01 S  per = 9.990e+01
 T(local opt: preprocess                  ) = 9.276e-05 S  per = 0.0268  per(accum) = 0.0268
 T(local opt: symbolic_formulae           ) = 1.810e-02 S  per = 5.23  per(accum) = 5.26
 T(local opt: hintermediate init          ) = 4.516e-04 S  per = 0.131  per(accum) = 5.39
 T(local opt: preprocess_hformulae_Hxlist ) = 5.523e-03 S  per =  1.6  per(accum) = 6.98
 T(local opt: hmmtasks init               ) = 1.064e-02 S  per = 3.08  per(accum) = 10.1
 T(local opt: initial guess for dvdson    ) = 2.446e-06 S  per = 0.000707  per(accum) = 10.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.640e-01 S  per = 76.3  per(accum) = 86.4
 T(local opt: dvdson [cpu-gpu]            ) = 6.057e-03 S  per = 1.75  per(accum) = 88.1
 T(local opt: dvdson [nccl]               ) = 2.545e-05 S  per = 0.00736  per(accum) = 88.1
 T(local opt: dvdson [mpi]                ) = 5.600e-07 S  per = 0.000162  per(accum) = 88.1
 T(local opt: dvdson [rest part(linalg)]  ) = 4.112e-02 S  per = 11.9  per(accum) = 100
Detailed decomposition of T(renrm) = 9.172e-02 S  T(sum) = 9.172e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 9.859e-05 S  per = 0.107  per(accum) = 0.107
 T(local opt: qops init                    ) = 3.212e-03 S  per =  3.5  per(accum) = 3.61
 T(local opt: symbolic_formulae_renorm     ) = 2.623e-02 S  per = 28.6  per(accum) = 32.2
 T(local opt: allocate qops on gpu         ) = 1.143e-04 S  per = 0.125  per(accum) = 32.3
 T(local opt: site memcpy cpu2gpu          ) = 1.944e-03 S  per = 2.12  per(accum) = 34.5
 T(local opt: rintermediate init           ) = 2.518e-03 S  per = 2.75  per(accum) = 37.2
 T(local opt: preprocess_formulae_Rlist2   ) = 6.548e-03 S  per = 7.14  per(accum) = 44.3
 T(local opt: rmmtasks init                ) = 8.633e-03 S  per = 9.41  per(accum) = 53.7
 T(local opt: qops memset on cpu           ) = 7.700e-08 S  per = 8.4e-05  per(accum) = 53.7
 T(local opt: preprocess_renorm_batchGPU   ) = 3.957e-02 S  per = 43.1  per(accum) = 96.9
 T(local opt: deallocate cpu and gpu memory) = 7.033e-05 S  per = 0.0767  per(accum) = 97
 T(local opt: construct opS [ifdists=true] ) = 8.400e-08 S  per = 9.16e-05  per(accum) = 97
 T(local opt: reduction of opS & opH [nccl]) = 7.600e-08 S  per = 8.29e-05  per(accum) = 97
 T(local opt: qops memcpy gpu2cpu          ) = 5.449e-04 S  per = 0.594  per(accum) = 97.6
 T(local opt: reduction of opS & opH [mpi] ) = 2.986e-05 S  per = 0.0326  per(accum) = 97.6
 T(local opt: qops_pool join and erase     ) = 2.203e-03 S  per =  2.4  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.210e-06 S  per = 0.00241  per(accum) = 100
##### sweep opt: 1.320e+01 S #####
 T(sweep opt: fetch) = 2.910e-01 S  per =  2.2  per(accum) = 2.2
 T(sweep opt: hdiag) = 4.069e+00 S  per = 30.8  per(accum) = 33
 T(sweep opt: dvdsn) = 6.938e+00 S  per = 52.6  per(accum) = 85.6
 T(sweep opt: decim) = 2.561e-01 S  per = 1.94  per(accum) = 87.5
 T(sweep opt: guess) = 1.987e-03 S  per = 0.0151  per(accum) = 87.5
 T(sweep opt: renrm) = 1.639e+00 S  per = 12.4  per(accum) = 100
 T(sweep opt: save ) = 5.662e-03 S  per = 0.0429  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.938e+00 S  T(sum) = 6.932e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 2.431e-03 S  per = 0.0351  per(accum) = 0.0351
 T(sweep opt: symbolic_formulae           ) = 2.763e-01 S  per = 3.99  per(accum) = 4.02
 T(sweep opt: hintermediate init          ) = 7.208e-03 S  per = 0.104  per(accum) = 4.13
 T(sweep opt: preprocess_hformulae_Hxlist ) = 8.549e-02 S  per = 1.23  per(accum) = 5.36
 T(sweep opt: hmmtasks init               ) = 1.548e-01 S  per = 2.23  per(accum) = 7.59
 T(sweep opt: initial guess for dvdson    ) = 8.095e-05 S  per = 0.00117  per(accum) = 7.59
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.308e+00 S  per = 76.6  per(accum) = 84.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.388e-01 S  per =    2  per(accum) = 86.2
 T(sweep opt: dvdson [nccl]               ) = 5.818e-04 S  per = 0.00839  per(accum) = 86.2
 T(sweep opt: dvdson [mpi]                ) = 1.341e-05 S  per = 0.000193  per(accum) = 86.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 9.583e-01 S  per = 13.8  per(accum) = 100
Detailed decomposition of T(renrm) = 1.639e+00 S  T(sum) = 1.639e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.214e-03 S  per = 0.196  per(accum) = 0.196
 T(sweep opt: qops init                    ) = 4.032e-02 S  per = 2.46  per(accum) = 2.66
 T(sweep opt: symbolic_formulae_renorm     ) = 2.596e-01 S  per = 15.8  per(accum) = 18.5
 T(sweep opt: allocate qops on gpu         ) = 1.342e-03 S  per = 0.0818  per(accum) = 18.6
 T(sweep opt: site memcpy cpu2gpu          ) = 3.250e-02 S  per = 1.98  per(accum) = 20.6
 T(sweep opt: rintermediate init           ) = 5.335e-02 S  per = 3.26  per(accum) = 23.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 9.000e-02 S  per = 5.49  per(accum) = 29.3
 T(sweep opt: rmmtasks init                ) = 1.902e-01 S  per = 11.6  per(accum) = 40.9
 T(sweep opt: qops memset on cpu           ) = 1.001e-06 S  per = 6.11e-05  per(accum) = 40.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.993e-01 S  per = 54.9  per(accum) = 95.8
 T(sweep opt: deallocate cpu and gpu memory) = 2.232e-03 S  per = 0.136  per(accum) = 95.9
 T(sweep opt: construct opS [ifdists=true] ) = 8.850e-07 S  per = 5.4e-05  per(accum) = 95.9
 T(sweep opt: reduction of opS & opH [nccl]) = 9.010e-07 S  per = 5.5e-05  per(accum) = 95.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.507e-03 S  per = 0.275  per(accum) = 96.2
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.614e-04 S  per = 0.0281  per(accum) = 96.2
 T(sweep opt: qops_pool join and erase     ) = 3.368e-02 S  per = 2.05  per(accum) = 98.3
 T(sweep opt: conversion from opAB to opPQ ) = 2.840e-02 S  per = 1.73  per(accum) = 100
##### global opt: 1.320e+01 S #####
 T(global opt: fetch) = 2.910e-01 S  per =  2.2  per(accum) = 2.2
 T(global opt: hdiag) = 4.069e+00 S  per = 30.8  per(accum) = 33
 T(global opt: dvdsn) = 6.938e+00 S  per = 52.6  per(accum) = 85.6
 T(global opt: decim) = 2.561e-01 S  per = 1.94  per(accum) = 87.5
 T(global opt: guess) = 1.987e-03 S  per = 0.0151  per(accum) = 87.5
 T(global opt: renrm) = 1.639e+00 S  per = 12.4  per(accum) = 100
 T(global opt: save ) = 5.662e-03 S  per = 0.0429  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.938e+00 S  T(sum) = 6.932e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 2.431e-03 S  per = 0.0351  per(accum) = 0.0351
 T(global opt: symbolic_formulae           ) = 2.763e-01 S  per = 3.99  per(accum) = 4.02
 T(global opt: hintermediate init          ) = 7.208e-03 S  per = 0.104  per(accum) = 4.13
 T(global opt: preprocess_hformulae_Hxlist ) = 8.549e-02 S  per = 1.23  per(accum) = 5.36
 T(global opt: hmmtasks init               ) = 1.548e-01 S  per = 2.23  per(accum) = 7.59
 T(global opt: initial guess for dvdson    ) = 8.095e-05 S  per = 0.00117  per(accum) = 7.59
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.308e+00 S  per = 76.6  per(accum) = 84.2
 T(global opt: dvdson [cpu-gpu]            ) = 1.388e-01 S  per =    2  per(accum) = 86.2
 T(global opt: dvdson [nccl]               ) = 5.818e-04 S  per = 0.00839  per(accum) = 86.2
 T(global opt: dvdson [mpi]                ) = 1.341e-05 S  per = 0.000193  per(accum) = 86.2
 T(global opt: dvdson [rest part(linalg)]  ) = 9.583e-01 S  per = 13.8  per(accum) = 100
Detailed decomposition of T(renrm) = 1.639e+00 S  T(sum) = 1.639e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.214e-03 S  per = 0.196  per(accum) = 0.196
 T(global opt: qops init                    ) = 4.032e-02 S  per = 2.46  per(accum) = 2.66
 T(global opt: symbolic_formulae_renorm     ) = 2.596e-01 S  per = 15.8  per(accum) = 18.5
 T(global opt: allocate qops on gpu         ) = 1.342e-03 S  per = 0.0818  per(accum) = 18.6
 T(global opt: site memcpy cpu2gpu          ) = 3.250e-02 S  per = 1.98  per(accum) = 20.6
 T(global opt: rintermediate init           ) = 5.335e-02 S  per = 3.26  per(accum) = 23.8
 T(global opt: preprocess_formulae_Rlist2   ) = 9.000e-02 S  per = 5.49  per(accum) = 29.3
 T(global opt: rmmtasks init                ) = 1.902e-01 S  per = 11.6  per(accum) = 40.9
 T(global opt: qops memset on cpu           ) = 1.001e-06 S  per = 6.11e-05  per(accum) = 40.9
 T(global opt: preprocess_renorm_batchGPU   ) = 8.993e-01 S  per = 54.9  per(accum) = 95.8
 T(global opt: deallocate cpu and gpu memory) = 2.232e-03 S  per = 0.136  per(accum) = 95.9
 T(global opt: construct opS [ifdists=true] ) = 8.850e-07 S  per = 5.4e-05  per(accum) = 95.9
 T(global opt: reduction of opS & opH [nccl]) = 9.010e-07 S  per = 5.5e-05  per(accum) = 95.9
 T(global opt: qops memcpy gpu2cpu          ) = 4.507e-03 S  per = 0.275  per(accum) = 96.2
 T(global opt: reduction of opS & opH [mpi] ) = 4.614e-04 S  per = 0.0281  per(accum) = 96.2
 T(global opt: qops_pool join and erase     ) = 3.368e-02 S  per = 2.05  per(accum) = 98.3
 T(global opt: conversion from opAB to opPQ ) = 2.840e-02 S  per = 1.73  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.199e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=24/seqsize=34 dots=1 dbond=(10,0)-(11,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=30:2.289e-04MB:2.235e-07GB
total mem of comb=1224:9.338e-03MB:9.120e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=11,8,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc= 7
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=2679:2.044e-02MB:1.996e-05GB
        per(mem): H:0.784 C:2.46 S:2.02 P:0 Q:94.7 
 rqops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=7,7 size(op)=17:0.00013MB size(tot)=1825:0.0139MB:1.36e-05GB
        per(mem): H:0.932 C:4.38 S:6.58 A:0 B:88.1 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=6840:0.0522MB:5.1e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.088e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(11,0) fdel=./scratch/sweep/lop(10,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-2.253e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(7,7,4) nnz=30:2.289e-04MB
qtensor3: wf3 own=1 _data=0x3c590b40
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=7
 (16,2):4 (16,4):2 (15,3):1
 qbond: qcol nsym=3 dimAll=7
 (12,-2):3 (13,-3):2 (12,-4):2
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=30:2.289e-04MB
### DIAG TIMING: total=3.720e-01 t1=3.734e-05, t2=2.023e-03, t3=2.518e-03, t4=3.674e-01, t5=5.129e-06, t6=1.397e-05, t7=4.310e-06
duration_diagGPU:3.720e-01
duration_diagreduce:1.040e-07
duration_diagtransform:4.880e-07
----- TIMING FOR symbolic_formulae_onedot with size=1327 : 2.195e-02 S -----
rank=0 GPUmem(GB): used=5.096e-05 (oper)=5.096e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1327
 no. of hintermediate operators=664
 no. of coefficients=7304:5.573e-02MB:5.442e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.767e-04 S -----
rank=0 GPUmem(GB): used=1.054e-04 (oper,hinter)=5.096e-05,5.442e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.584e-03 S size(H_formulae)=1327 size(Hxlst2)=5 T(Hmu/Hxlist)=3.331e-03,3.253e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.978e-03 S size(H_formulae)=1327 size(Hxlst)=2480 -----
rank=0 GPUmem(GB): used=1.054e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=4.470e-07 batch[need]=5.358e-04 blksize=12 blksize0=4 batchsize=2480
rank=0 GPUmem(GB): used=6.417e-04 (oper,hinter,dvdson,batch)=5.096e-05,5.442e-05,4.470e-07,5.358e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=30 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.672e-04,9.980e-03,2.123e-02,3.308e-03,3.519e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=6.615e-04 speed=6.758e-04GB/S T(nccl)=5.726e-06 speed=7.807e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=2.1e-02 t_reduction=3.3e-03 tot=3.5e-02 -----
 sigma[inter] counter=106 t=1.0e-02 per=2.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=106 i=0 t=1.2e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=1 t=1.1e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=2 t=7.6e-03 per=2.2e+01 cost=3.1e+04 flops=4.0e+06
 sigma[gemm] counter=106 i=3 t=7.7e-03 per=2.2e+01 cost=3.1e+04 flops=4.0e+06
 sigma[gemm] counter=106 i=4 t=4.7e-03 per=1.4e+01 cost=2.3e+04 flops=4.8e+06
 sigma[gemm] counter=106 i=5 t=1.2e-03 per=3.4e+00 cost=2.4e+04 flops=2.0e+07
 sigma[gemm] counter=106 total t=2.1e-02 per=6.2e+01 cost=1.1e+05 flops=5.1e+06
 sigma[red] counter=106 t=3.3e-03 per=9.6e+00 cost=2.8e+04 flops=8.4e+06
----- TIMING FOR sigma_tot : t_inter=9.9e-01 t_gemm=3.1e+00 t_reduction=1.3e+00 tot=5.3e+00 -----
 sigma_tot[inter] counter=106 t=9.9e-01 per=1.9e+01 cost=3.2e+06 flops=3.2e+06
 sigma_tot[gemm] counter=106 i=0 t=1.9e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=1 t=1.7e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=2 t=7.7e-01 per=1.4e+01 cost=1.3e+06 flops=1.7e+06
 sigma_tot[gemm] counter=106 i=3 t=7.7e-01 per=1.4e+01 cost=1.3e+06 flops=1.7e+06
 sigma_tot[gemm] counter=106 i=4 t=7.8e-01 per=1.5e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=106 i=5 t=7.7e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=106 total t=3.1e+00 per=5.8e+01 cost=5.0e+06 flops=1.6e+06
 sigma_tot[red] counter=106 t=1.3e+00 per=2.4e+01 cost=1.4e+06 flops=1.1e+06
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,4.4e-06,2.0e-06,8.2e-07,1.9e-07
settings: ndim=30 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.322363025516 -1.116e+03  1.581e-02    1     1  3.531e-02 3.531e-02 3.528e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.137e-03,1.218e-02,2.985e-02,1.239e-02,5.657e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.130e-03 speed=2.099e-04GB/S T(nccl)=7.022e-06 speed=6.366e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.4e-02 -----
 sigma[inter] counter=107 t=1.2e-02 per=2.2e+01 cost=4.2e+04 flops=3.5e+06
 sigma[gemm] counter=107 i=0 t=3.7e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=1 t=3.0e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=2 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=107 i=3 t=7.6e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=107 i=4 t=7.4e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=107 i=5 t=7.4e-03 per=1.4e+01 cost=2.4e+04 flops=3.2e+06
 sigma[gemm] counter=107 total t=3.0e-02 per=5.5e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=107 t=1.2e-02 per=2.3e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=3.1e+00 t_reduction=1.3e+00 tot=5.4e+00 -----
 sigma_tot[inter] counter=107 t=1.0e+00 per=1.9e+01 cost=3.2e+06 flops=3.2e+06
 sigma_tot[gemm] counter=107 i=0 t=2.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=1 t=1.7e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=2 t=7.8e-01 per=1.4e+01 cost=1.3e+06 flops=1.7e+06
 sigma_tot[gemm] counter=107 i=3 t=7.8e-01 per=1.4e+01 cost=1.3e+06 flops=1.7e+06
 sigma_tot[gemm] counter=107 i=4 t=7.8e-01 per=1.5e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=107 i=5 t=7.7e-01 per=1.4e+01 cost=1.2e+06 flops=1.6e+06
 sigma_tot[gemm] counter=107 total t=3.1e+00 per=5.8e+01 cost=5.1e+06 flops=1.7e+06
 sigma_tot[red] counter=107 t=1.3e+00 per=2.4e+01 cost=1.4e+06 flops=1.1e+06
T(sub)=3.7e-05 T(gemm/eig/ortho/gemm/axpy)=8.8e-06,2.0e-05,6.4e-06,1.6e-06,3.5e-07
    2   0 -    -116.322986511550 -6.235e-04  4.573e-03    2     2  1.018e-01 5.088e-02 4.603e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.944e-04,1.001e-02,2.957e-02,1.251e-02,5.240e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.885e-04 speed=1.549e-03GB/S T(nccl)=5.919e-06 speed=7.553e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=108 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=108 i=0 t=1.8e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=1 t=1.6e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=2 t=7.4e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=108 i=3 t=7.4e-03 per=1.4e+01 cost=3.1e+04 flops=4.2e+06
 sigma[gemm] counter=108 i=4 t=7.4e-03 per=1.4e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=108 i=5 t=7.4e-03 per=1.4e+01 cost=2.4e+04 flops=3.2e+06
 sigma[gemm] counter=108 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.7e+06
 sigma[red] counter=108 t=1.3e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=3.1e+00 t_reduction=1.3e+00 tot=5.4e+00 -----
 sigma_tot[inter] counter=108 t=1.0e+00 per=1.9e+01 cost=3.2e+06 flops=3.2e+06
 sigma_tot[gemm] counter=108 i=0 t=2.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=1 t=1.7e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=2 t=7.8e-01 per=1.4e+01 cost=1.3e+06 flops=1.7e+06
 sigma_tot[gemm] counter=108 i=3 t=7.8e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=108 i=4 t=7.9e-01 per=1.5e+01 cost=1.3e+06 flops=1.6e+06
 sigma_tot[gemm] counter=108 i=5 t=7.8e-01 per=1.4e+01 cost=1.3e+06 flops=1.6e+06
 sigma_tot[gemm] counter=108 total t=3.1e+00 per=5.8e+01 cost=5.3e+06 flops=1.7e+06
 sigma_tot[red] counter=108 t=1.3e+00 per=2.4e+01 cost=1.4e+06 flops=1.1e+06
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.7e-05,3.5e-06,1.2e-06,2.8e-07
    3   0 -    -116.323063959884 -7.745e-05  1.743e-03    3     3  1.709e-01 5.696e-02 4.819e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.927e-03,1.004e-02,3.001e-02,1.231e-02,5.430e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=1.922e-03 speed=2.326e-04GB/S T(nccl)=5.522e-06 speed=8.096e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=109 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=109 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=2 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=109 i=3 t=7.6e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=109 i=4 t=7.5e-03 per=1.4e+01 cost=2.3e+04 flops=3.0e+06
 sigma[gemm] counter=109 i=5 t=7.4e-03 per=1.4e+01 cost=2.4e+04 flops=3.2e+06
 sigma[gemm] counter=109 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=109 t=1.2e-02 per=2.4e+01 cost=2.8e+04 flops=2.3e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=3.2e+00 t_reduction=1.3e+00 tot=5.5e+00 -----
 sigma_tot[inter] counter=109 t=1.0e+00 per=1.9e+01 cost=3.3e+06 flops=3.2e+06
 sigma_tot[gemm] counter=109 i=0 t=2.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=1 t=1.7e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=2 t=7.9e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=109 i=3 t=7.9e-01 per=1.4e+01 cost=1.4e+06 flops=1.8e+06
 sigma_tot[gemm] counter=109 i=4 t=8.0e-01 per=1.5e+01 cost=1.3e+06 flops=1.6e+06
 sigma_tot[gemm] counter=109 i=5 t=7.9e-01 per=1.4e+01 cost=1.3e+06 flops=1.6e+06
 sigma_tot[gemm] counter=109 total t=3.2e+00 per=5.8e+01 cost=5.4e+06 flops=1.7e+06
 sigma_tot[red] counter=109 t=1.3e+00 per=2.4e+01 cost=1.4e+06 flops=1.1e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.3e-05,2.8e-06,1.0e-06,1.9e-07
    4   0 -    -116.323071442041 -7.482e-06  2.606e-04    3     4  2.362e-01 5.904e-02 4.974e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.564e-03,9.940e-03,3.017e-02,1.247e-02,5.415e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=1.557e-03 speed=2.871e-04GB/S T(nccl)=6.955e-06 speed=6.428e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=110 t=9.9e-03 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=110 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=2 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=110 i=3 t=7.5e-03 per=1.4e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=110 i=4 t=7.6e-03 per=1.4e+01 cost=2.3e+04 flops=3.0e+06
 sigma[gemm] counter=110 i=5 t=7.6e-03 per=1.4e+01 cost=2.4e+04 flops=3.1e+06
 sigma[gemm] counter=110 total t=3.0e-02 per=5.7e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=110 t=1.2e-02 per=2.4e+01 cost=2.8e+04 flops=2.2e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=3.2e+00 t_reduction=1.3e+00 tot=5.5e+00 -----
 sigma_tot[inter] counter=110 t=1.0e+00 per=1.9e+01 cost=3.3e+06 flops=3.2e+06
 sigma_tot[gemm] counter=110 i=0 t=2.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=1 t=1.7e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=2 t=8.0e-01 per=1.4e+01 cost=1.4e+06 flops=1.8e+06
 sigma_tot[gemm] counter=110 i=3 t=8.0e-01 per=1.4e+01 cost=1.4e+06 flops=1.8e+06
 sigma_tot[gemm] counter=110 i=4 t=8.1e-01 per=1.5e+01 cost=1.3e+06 flops=1.6e+06
 sigma_tot[gemm] counter=110 i=5 t=8.0e-01 per=1.4e+01 cost=1.3e+06 flops=1.7e+06
 sigma_tot[gemm] counter=110 total t=3.2e+00 per=5.8e+01 cost=5.5e+06 flops=1.7e+06
 sigma_tot[red] counter=110 t=1.3e+00 per=2.4e+01 cost=1.5e+06 flops=1.1e+06
T(sub)=4.0e-05 T(gemm/eig/ortho/gemm/axpy)=7.2e-06,2.5e-05,5.5e-06,1.9e-06,4.3e-07
    5   0 +    -116.323071653332 -2.113e-07  6.679e-05    3     5  3.039e-01 6.079e-02 5.066e-02
TIMING FOR Davidson : 3.040e-01  T(cal/comm/rest)=2.533e-01,8.240e-07,5.066e-02
decomposed t_rest=5.066e-02
 T(sub)    =1.349e-04 per=2.664e-01
 T(precond)=5.037e-02 per=9.943e+01
 T(ortho)  =1.555e-05 per=3.070e-02
 T(xcopy)  =9.820e-07 per=1.939e-03
 T(xnrm2)  =2.958e-06 per=5.839e-03
 T(other)  =1.323e-04 per=2.611e-01
optimized energies: isweep=0 ibond=24 dots=1 e[0]=-116.323071653332 nmvp=5
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.442e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond24.txt
 qbond: qsuper nsym=8 dimAll=28
 (12,-2):3 (13,-3):7 (12,-4):2 (14,-2):5 (15,-3):2 (14,-4):4 (13,-1):3 (13,-5):2
timing for divide=1.9e-05
timing for compute=1.6e-02
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(nkr): 1.6e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.9e-05,1.6e-02,0.0e+00,8.8e-06,1.5e-05 -----
decimation summary: 28->7 dwt=+0.000e+00 SvN=1.263e+00
 qbond: qkept nsym=3 dimAll=7
 (14,-2):4 (14,-4):2 (15,-3):1
----- TIMING for decimation_row(nkr): 1.650e-02 S T(decim/select/formRot)=1.625e-02,2.227e-04,2.143e-05 -----
----- TIMING FOR onedot_decimation: 1.662e-02 S T(wf/decim)=1.039e-04,1.652e-02 -----
ctns::oper_renorm coord=(11,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=2679:2.044e-02MB:1.996e-05GB
        per(mem): H:0.784 C:2.02 S:2.46 A:0 B:94.7 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.902e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=365 : 1.585e-02 S -----
rank=0 GPUmem(GB): used=1.054e-04 (oper)=5.096e-05
rank=0 GPUmem(GB): used=1.056e-04 (oper,site)=5.096e-05,2.235e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=227
 no. of coefficients=7720:5.890e-02MB:5.752e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.461e-03 S -----
rank=0 GPUmem(GB): used=1.631e-04 (oper,site,rinter)=5.096e-05,2.235e-07,5.752e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.652e-03 S size(rtasks)=365 size(Rlst2)=9 T(Rmu/Rlist)=2.221e-03,1.431e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.848e-03 S size(rtasks)=365 size(Rlst)=703 -----
rank=0 GPUmem(GB): used=1.631e-04 avail=6.176e+00 total=6.176e+00 batch[need]=2.200e-04 blksize=16 blksize0=9 batchsize=703
rank=0 GPUmem(GB): used=3.831e-04 (oper,site,rinter,batch)=5.096e-05,2.235e-07,5.752e-05,2.200e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.207e-03,2.269e-02,9.921e-03
----- TIMING FOR renorm : t_inter=7.2e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=4.0e-02 -----
 renorm[inter] counter=25 t=7.2e-03 per=1.8e+01 cost=5.3e+04 flops=7.4e+06
 renorm[gemm] counter=25 i=0 t=1.6e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=1 t=1.4e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=2 t=7.5e-03 per=1.9e+01 cost=2.8e+03 flops=3.7e+05
 renorm[gemm] counter=25 i=3 t=7.6e-03 per=1.9e+01 cost=1.5e+04 flops=1.9e+06
 renorm[gemm] counter=25 i=4 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=5 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=6 t=7.5e-03 per=1.9e+01 cost=2.4e+04 flops=3.3e+06
 renorm[gemm] counter=25 total t=2.3e-02 per=5.7e+01 cost=4.2e+04 flops=1.8e+06
 renorm[red] counter=25 t=9.9e-03 per=2.5e+01 cost=1.0e+04 flops=1.0e+06
----- TIMING FOR renorm_tot : t_inter=1.4e-01 t_gemm=5.4e-01 t_reduction=2.5e-01 tot=9.4e-01 -----
 renorm_tot[inter] counter=25 t=1.4e-01 per=1.5e+01 cost=7.6e+05 flops=5.2e+06
 renorm_tot[gemm] counter=25 i=0 t=3.5e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=25 i=1 t=2.9e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=25 i=2 t=5.9e-02 per=6.2e+00 cost=1.9e+05 flops=3.2e+06
 renorm_tot[gemm] counter=25 i=3 t=6.0e-02 per=6.4e+00 cost=1.8e+05 flops=3.0e+06
 renorm_tot[gemm] counter=25 i=4 t=1.2e-01 per=1.3e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=25 i=5 t=1.2e-01 per=1.3e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=25 i=6 t=1.8e-01 per=1.9e+01 cost=2.7e+06 flops=1.5e+07
 renorm_tot[gemm] counter=25 total t=5.4e-01 per=5.8e+01 cost=3.5e+06 flops=6.5e+06
 renorm_tot[red] counter=25 t=2.5e-01 per=2.6e+01 cost=1.2e+06 flops=5.0e+06
qops.to_cpu: size(tot)=2679:2.0e-02MB:2.0e-05GB T(to_cpu)=4.1e-04S speed=4.8e-02GB/S
check ||H-H.dagger||=6.748e-15 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.0727 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=8.128e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-2.024e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-6.706e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 8.320e-01 S #####
 T(local opt: fetch) = 2.224e-02 S  per = 2.67  per(accum) = 2.67
 T(local opt: hdiag) = 3.720e-01 S  per = 44.7  per(accum) = 47.4
 T(local opt: dvdsn) = 3.464e-01 S  per = 41.6  per(accum) = 89
 T(local opt: decim) = 1.663e-02 S  per =    2  per(accum) = 91
 T(local opt: guess) = 9.343e-05 S  per = 0.0112  per(accum) = 91
 T(local opt: renrm) = 7.430e-02 S  per = 8.93  per(accum) = 100
 T(local opt: save ) = 2.451e-04 S  per = 0.0295  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.464e-01 S  T(sum) = 3.460e-01 S  per = 9.988e+01
 T(local opt: preprocess                  ) = 9.622e-05 S  per = 0.0278  per(accum) = 0.0278
 T(local opt: symbolic_formulae           ) = 2.196e-02 S  per = 6.35  per(accum) = 6.37
 T(local opt: hintermediate init          ) = 5.961e-04 S  per = 0.172  per(accum) = 6.55
 T(local opt: preprocess_hformulae_Hxlist ) = 7.054e-03 S  per = 2.04  per(accum) = 8.59
 T(local opt: hmmtasks init               ) = 1.236e-02 S  per = 3.57  per(accum) = 12.2
 T(local opt: initial guess for dvdson    ) = 2.877e-06 S  per = 0.000831  per(accum) = 12.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.467e-01 S  per = 71.3  per(accum) = 83.5
 T(local opt: dvdson [cpu-gpu]            ) = 6.559e-03 S  per =  1.9  per(accum) = 85.4
 T(local opt: dvdson [nccl]               ) = 3.114e-05 S  per = 0.009  per(accum) = 85.4
 T(local opt: dvdson [mpi]                ) = 8.240e-07 S  per = 0.000238  per(accum) = 85.4
 T(local opt: dvdson [rest part(linalg)]  ) = 5.066e-02 S  per = 14.6  per(accum) = 100
Detailed decomposition of T(renrm) = 7.430e-02 S  T(sum) = 7.430e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.837e-05 S  per = 0.105  per(accum) = 0.105
 T(local opt: qops init                    ) = 3.049e-03 S  per =  4.1  per(accum) = 4.21
 T(local opt: symbolic_formulae_renorm     ) = 1.587e-02 S  per = 21.4  per(accum) = 25.6
 T(local opt: allocate qops on gpu         ) = 6.392e-05 S  per = 0.086  per(accum) = 25.7
 T(local opt: site memcpy cpu2gpu          ) = 1.723e-03 S  per = 2.32  per(accum) = 28
 T(local opt: rintermediate init           ) = 2.478e-03 S  per = 3.33  per(accum) = 31.3
 T(local opt: preprocess_formulae_Rlist2   ) = 3.882e-03 S  per = 5.22  per(accum) = 36.5
 T(local opt: rmmtasks init                ) = 5.193e-03 S  per = 6.99  per(accum) = 43.5
 T(local opt: qops memset on cpu           ) = 4.200e-08 S  per = 5.65e-05  per(accum) = 43.5
 T(local opt: preprocess_renorm_batchGPU   ) = 3.992e-02 S  per = 53.7  per(accum) = 97.3
 T(local opt: deallocate cpu and gpu memory) = 5.148e-05 S  per = 0.0693  per(accum) = 97.3
 T(local opt: construct opS [ifdists=true] ) = 3.800e-08 S  per = 5.11e-05  per(accum) = 97.3
 T(local opt: reduction of opS & opH [nccl]) = 4.800e-08 S  per = 6.46e-05  per(accum) = 97.3
 T(local opt: qops memcpy gpu2cpu          ) = 4.203e-04 S  per = 0.566  per(accum) = 97.9
 T(local opt: reduction of opS & opH [mpi] ) = 1.888e-05 S  per = 0.0254  per(accum) = 97.9
 T(local opt: qops_pool join and erase     ) = 1.549e-03 S  per = 2.08  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.710e-06 S  per = 0.0023  per(accum) = 100
##### sweep opt: 1.403e+01 S #####
 T(sweep opt: fetch) = 3.132e-01 S  per = 2.23  per(accum) = 2.23
 T(sweep opt: hdiag) = 4.441e+00 S  per = 31.6  per(accum) = 33.9
 T(sweep opt: dvdsn) = 7.285e+00 S  per = 51.9  per(accum) = 85.8
 T(sweep opt: decim) = 2.727e-01 S  per = 1.94  per(accum) = 87.7
 T(sweep opt: guess) = 2.081e-03 S  per = 0.0148  per(accum) = 87.7
 T(sweep opt: renrm) = 1.713e+00 S  per = 12.2  per(accum) = 100
 T(sweep opt: save ) = 5.907e-03 S  per = 0.0421  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.285e+00 S  T(sum) = 7.278e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 2.527e-03 S  per = 0.0347  per(accum) = 0.0347
 T(sweep opt: symbolic_formulae           ) = 2.983e-01 S  per =  4.1  per(accum) = 4.13
 T(sweep opt: hintermediate init          ) = 7.804e-03 S  per = 0.107  per(accum) = 4.24
 T(sweep opt: preprocess_hformulae_Hxlist ) = 9.254e-02 S  per = 1.27  per(accum) = 5.51
 T(sweep opt: hmmtasks init               ) = 1.671e-01 S  per =  2.3  per(accum) = 7.81
 T(sweep opt: initial guess for dvdson    ) = 8.383e-05 S  per = 0.00115  per(accum) = 7.81
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.554e+00 S  per = 76.3  per(accum) = 84.1
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.454e-01 S  per =    2  per(accum) = 86.1
 T(sweep opt: dvdson [nccl]               ) = 6.130e-04 S  per = 0.00842  per(accum) = 86.1
 T(sweep opt: dvdson [mpi]                ) = 1.423e-05 S  per = 0.000196  per(accum) = 86.1
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.009e+00 S  per = 13.9  per(accum) = 100
Detailed decomposition of T(renrm) = 1.713e+00 S  T(sum) = 1.713e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.292e-03 S  per = 0.192  per(accum) = 0.192
 T(sweep opt: qops init                    ) = 4.337e-02 S  per = 2.53  per(accum) = 2.72
 T(sweep opt: symbolic_formulae_renorm     ) = 2.754e-01 S  per = 16.1  per(accum) = 18.8
 T(sweep opt: allocate qops on gpu         ) = 1.405e-03 S  per = 0.082  per(accum) = 18.9
 T(sweep opt: site memcpy cpu2gpu          ) = 3.422e-02 S  per =    2  per(accum) = 20.9
 T(sweep opt: rintermediate init           ) = 5.583e-02 S  per = 3.26  per(accum) = 24.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 9.388e-02 S  per = 5.48  per(accum) = 29.6
 T(sweep opt: rmmtasks init                ) = 1.954e-01 S  per = 11.4  per(accum) = 41
 T(sweep opt: qops memset on cpu           ) = 1.043e-06 S  per = 6.09e-05  per(accum) = 41
 T(sweep opt: preprocess_renorm_batchGPU   ) = 9.392e-01 S  per = 54.8  per(accum) = 95.8
 T(sweep opt: deallocate cpu and gpu memory) = 2.283e-03 S  per = 0.133  per(accum) = 96
 T(sweep opt: construct opS [ifdists=true] ) = 9.230e-07 S  per = 5.39e-05  per(accum) = 96
 T(sweep opt: reduction of opS & opH [nccl]) = 9.490e-07 S  per = 5.54e-05  per(accum) = 96
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.927e-03 S  per = 0.288  per(accum) = 96.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.802e-04 S  per = 0.028  per(accum) = 96.3
 T(sweep opt: qops_pool join and erase     ) = 3.523e-02 S  per = 2.06  per(accum) = 98.3
 T(sweep opt: conversion from opAB to opPQ ) = 2.840e-02 S  per = 1.66  per(accum) = 100
##### global opt: 1.403e+01 S #####
 T(global opt: fetch) = 3.132e-01 S  per = 2.23  per(accum) = 2.23
 T(global opt: hdiag) = 4.441e+00 S  per = 31.6  per(accum) = 33.9
 T(global opt: dvdsn) = 7.285e+00 S  per = 51.9  per(accum) = 85.8
 T(global opt: decim) = 2.727e-01 S  per = 1.94  per(accum) = 87.7
 T(global opt: guess) = 2.081e-03 S  per = 0.0148  per(accum) = 87.7
 T(global opt: renrm) = 1.713e+00 S  per = 12.2  per(accum) = 100
 T(global opt: save ) = 5.907e-03 S  per = 0.0421  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.285e+00 S  T(sum) = 7.278e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 2.527e-03 S  per = 0.0347  per(accum) = 0.0347
 T(global opt: symbolic_formulae           ) = 2.983e-01 S  per =  4.1  per(accum) = 4.13
 T(global opt: hintermediate init          ) = 7.804e-03 S  per = 0.107  per(accum) = 4.24
 T(global opt: preprocess_hformulae_Hxlist ) = 9.254e-02 S  per = 1.27  per(accum) = 5.51
 T(global opt: hmmtasks init               ) = 1.671e-01 S  per =  2.3  per(accum) = 7.81
 T(global opt: initial guess for dvdson    ) = 8.383e-05 S  per = 0.00115  per(accum) = 7.81
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.554e+00 S  per = 76.3  per(accum) = 84.1
 T(global opt: dvdson [cpu-gpu]            ) = 1.454e-01 S  per =    2  per(accum) = 86.1
 T(global opt: dvdson [nccl]               ) = 6.130e-04 S  per = 0.00842  per(accum) = 86.1
 T(global opt: dvdson [mpi]                ) = 1.423e-05 S  per = 0.000196  per(accum) = 86.1
 T(global opt: dvdson [rest part(linalg)]  ) = 1.009e+00 S  per = 13.9  per(accum) = 100
Detailed decomposition of T(renrm) = 1.713e+00 S  T(sum) = 1.713e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.292e-03 S  per = 0.192  per(accum) = 0.192
 T(global opt: qops init                    ) = 4.337e-02 S  per = 2.53  per(accum) = 2.72
 T(global opt: symbolic_formulae_renorm     ) = 2.754e-01 S  per = 16.1  per(accum) = 18.8
 T(global opt: allocate qops on gpu         ) = 1.405e-03 S  per = 0.082  per(accum) = 18.9
 T(global opt: site memcpy cpu2gpu          ) = 3.422e-02 S  per =    2  per(accum) = 20.9
 T(global opt: rintermediate init           ) = 5.583e-02 S  per = 3.26  per(accum) = 24.1
 T(global opt: preprocess_formulae_Rlist2   ) = 9.388e-02 S  per = 5.48  per(accum) = 29.6
 T(global opt: rmmtasks init                ) = 1.954e-01 S  per = 11.4  per(accum) = 41
 T(global opt: qops memset on cpu           ) = 1.043e-06 S  per = 6.09e-05  per(accum) = 41
 T(global opt: preprocess_renorm_batchGPU   ) = 9.392e-01 S  per = 54.8  per(accum) = 95.8
 T(global opt: deallocate cpu and gpu memory) = 2.283e-03 S  per = 0.133  per(accum) = 96
 T(global opt: construct opS [ifdists=true] ) = 9.230e-07 S  per = 5.39e-05  per(accum) = 96
 T(global opt: reduction of opS & opH [nccl]) = 9.490e-07 S  per = 5.54e-05  per(accum) = 96
 T(global opt: qops memcpy gpu2cpu          ) = 4.927e-03 S  per = 0.288  per(accum) = 96.3
 T(global opt: reduction of opS & opH [mpi] ) = 4.802e-04 S  per = 0.028  per(accum) = 96.3
 T(global opt: qops_pool join and erase     ) = 3.523e-02 S  per = 2.06  per(accum) = 98.3
 T(global opt: conversion from opAB to opPQ ) = 2.840e-02 S  per = 1.66  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.442e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=25/seqsize=34 dots=1 dbond=(9,0)-(10,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=35:2.670e-04MB:2.608e-07GB
total mem of comb=1229:9.377e-03MB:9.157e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=10,9,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc= 6
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3251:2.480e-02MB:2.422e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
 rqops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=2679:0.0204MB:2e-05GB
        per(mem): H:0.784 C:2.02 S:2.46 A:0 B:94.7 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=8266:0.0631MB:6.16e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.128e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(10,0) fdel=./scratch/sweep/lop(9,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-2.444e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(7,7,4) nnz=35:2.670e-04MB
qtensor3: wf3 own=1 _data=0x38f2aea0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=7
 (15,1):4 (15,3):2 (14,2):1
 qbond: qcol nsym=3 dimAll=7
 (14,-2):4 (14,-4):2 (15,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=6 nblocks=36 size=35:2.670e-04MB
### DIAG TIMING: total=4.189e-01 t1=2.911e-05, t2=2.158e-03, t3=2.533e-03, t4=4.141e-01, t5=7.407e-06, t6=1.492e-05, t7=3.811e-06
duration_diagGPU:4.189e-01
duration_diagreduce:1.490e-07
duration_diagtransform:4.970e-07
----- TIMING FOR symbolic_formulae_onedot with size=1635 : 2.572e-02 S -----
rank=0 GPUmem(GB): used=6.159e-05 (oper)=6.159e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1635
 no. of hintermediate operators=828
 no. of coefficients=8280:6.317e-02MB:6.169e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.065e-04 S -----
rank=0 GPUmem(GB): used=1.233e-04 (oper,hinter)=6.159e-05,6.169e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 9.278e-03 S size(H_formulae)=1635 size(Hxlst2)=6 T(Hmu/Hxlist)=4.158e-03,5.120e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 9.922e-03 S size(H_formulae)=1635 size(Hxlst)=3940 -----
rank=0 GPUmem(GB): used=1.233e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=5.215e-07 batch[need]=1.086e-03 blksize=16 blksize0=4 batchsize=3940
rank=0 GPUmem(GB): used=1.210e-03 (oper,hinter,dvdson,batch)=6.159e-05,6.169e-05,5.215e-07,1.086e-03
ctns::pdvdsonSolver_nkr::solve_iter ndim=35 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.068e-04,9.978e-03,3.029e-02,1.257e-02,5.335e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=5.012e-04 speed=1.041e-03GB/S T(nccl)=5.646e-06 speed=9.237e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=111 t=1.0e-02 per=1.9e+01 cost=6.8e+04 flops=6.8e+06
 sigma[gemm] counter=111 i=0 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=1 t=1.0e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=2 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=111 i=3 t=7.6e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=111 i=4 t=7.6e-03 per=1.4e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=111 i=5 t=7.6e-03 per=1.4e+01 cost=3.5e+04 flops=4.6e+06
 sigma[gemm] counter=111 total t=3.0e-02 per=5.7e+01 cost=2.2e+05 flops=7.4e+06
 sigma[red] counter=111 t=1.3e-02 per=2.4e+01 cost=4.8e+04 flops=3.8e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=3.2e+00 t_reduction=1.3e+00 tot=5.6e+00 -----
 sigma_tot[inter] counter=111 t=1.0e+00 per=1.9e+01 cost=3.4e+06 flops=3.3e+06
 sigma_tot[gemm] counter=111 i=0 t=2.0e-04 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=1 t=1.7e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=2 t=8.1e-01 per=1.4e+01 cost=1.5e+06 flops=1.8e+06
 sigma_tot[gemm] counter=111 i=3 t=8.1e-01 per=1.4e+01 cost=1.5e+06 flops=1.9e+06
 sigma_tot[gemm] counter=111 i=4 t=8.1e-01 per=1.5e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=111 i=5 t=8.0e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=111 total t=3.2e+00 per=5.8e+01 cost=5.7e+06 flops=1.8e+06
 sigma_tot[red] counter=111 t=1.3e+00 per=2.4e+01 cost=1.5e+06 flops=1.2e+06
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,5.0e-06,1.8e-06,8.2e-07,1.9e-07
settings: ndim=35 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.323071653332 -1.116e+03  3.775e-03    1     1  5.347e-02 5.347e-02 5.344e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.207e-03,9.939e-03,3.004e-02,1.266e-02,5.386e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=1.189e-03 speed=4.385e-04GB/S T(nccl)=1.724e-05 speed=3.025e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=112 t=9.9e-03 per=1.9e+01 cost=6.8e+04 flops=6.8e+06
 sigma[gemm] counter=112 i=0 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=2 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=112 i=3 t=7.6e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=112 i=4 t=7.5e-03 per=1.4e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=112 i=5 t=7.5e-03 per=1.4e+01 cost=3.5e+04 flops=4.6e+06
 sigma[gemm] counter=112 total t=3.0e-02 per=5.7e+01 cost=2.2e+05 flops=7.5e+06
 sigma[red] counter=112 t=1.3e-02 per=2.4e+01 cost=4.8e+04 flops=3.8e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.3e+00 t_reduction=1.3e+00 tot=5.6e+00 -----
 sigma_tot[inter] counter=112 t=1.1e+00 per=1.9e+01 cost=3.5e+06 flops=3.3e+06
 sigma_tot[gemm] counter=112 i=0 t=2.1e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=1 t=1.7e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=2 t=8.1e-01 per=1.4e+01 cost=1.6e+06 flops=1.9e+06
 sigma_tot[gemm] counter=112 i=3 t=8.1e-01 per=1.4e+01 cost=1.6e+06 flops=1.9e+06
 sigma_tot[gemm] counter=112 i=4 t=8.2e-01 per=1.5e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=112 i=5 t=8.1e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=112 total t=3.3e+00 per=5.8e+01 cost=5.9e+06 flops=1.8e+06
 sigma_tot[red] counter=112 t=1.3e+00 per=2.4e+01 cost=1.6e+06 flops=1.2e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.2e-05,3.3e-06,8.5e-07,1.8e-07
    2   0 -    -116.323141789501 -7.014e-05  3.796e-04    2     2  1.170e-01 5.851e-02 5.369e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.209e-03,1.018e-02,3.004e-02,1.270e-02,5.514e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=2.204e-03 speed=2.367e-04GB/S T(nccl)=4.739e-06 speed=1.101e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=113 t=1.0e-02 per=1.9e+01 cost=6.8e+04 flops=6.6e+06
 sigma[gemm] counter=113 i=0 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=1 t=1.1e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=2 t=7.6e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=113 i=3 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=113 i=4 t=7.5e-03 per=1.4e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=113 i=5 t=7.5e-03 per=1.4e+01 cost=3.5e+04 flops=4.6e+06
 sigma[gemm] counter=113 total t=3.0e-02 per=5.7e+01 cost=2.2e+05 flops=7.5e+06
 sigma[red] counter=113 t=1.3e-02 per=2.4e+01 cost=4.8e+04 flops=3.7e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.3e+00 t_reduction=1.3e+00 tot=5.7e+00 -----
 sigma_tot[inter] counter=113 t=1.1e+00 per=1.9e+01 cost=3.5e+06 flops=3.3e+06
 sigma_tot[gemm] counter=113 i=0 t=2.1e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=1 t=1.8e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=2 t=8.2e-01 per=1.4e+01 cost=1.6e+06 flops=2.0e+06
 sigma_tot[gemm] counter=113 i=3 t=8.2e-01 per=1.4e+01 cost=1.7e+06 flops=2.0e+06
 sigma_tot[gemm] counter=113 i=4 t=8.3e-01 per=1.5e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=113 i=5 t=8.2e-01 per=1.4e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[gemm] counter=113 total t=3.3e+00 per=5.8e+01 cost=6.1e+06 flops=1.9e+06
 sigma_tot[red] counter=113 t=1.3e+00 per=2.4e+01 cost=1.6e+06 flops=1.2e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.4e-05,2.8e-06,1.1e-06,1.8e-07
    3   0 -    -116.323142446351 -6.569e-07  1.172e-04    3     3  1.851e-01 6.169e-02 5.420e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.273e-03,1.009e-02,3.037e-02,1.244e-02,5.418e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=1.269e-03 speed=4.111e-04GB/S T(nccl)=4.702e-06 speed=1.109e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=114 t=1.0e-02 per=1.9e+01 cost=6.8e+04 flops=6.7e+06
 sigma[gemm] counter=114 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=2 t=7.6e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=114 i=3 t=7.5e-03 per=1.4e+01 cost=7.8e+04 flops=1.0e+07
 sigma[gemm] counter=114 i=4 t=7.6e-03 per=1.4e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=114 i=5 t=7.6e-03 per=1.4e+01 cost=3.5e+04 flops=4.6e+06
 sigma[gemm] counter=114 total t=3.0e-02 per=5.7e+01 cost=2.2e+05 flops=7.4e+06
 sigma[red] counter=114 t=1.2e-02 per=2.4e+01 cost=4.8e+04 flops=3.8e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.3e+00 t_reduction=1.4e+00 tot=5.8e+00 -----
 sigma_tot[inter] counter=114 t=1.1e+00 per=1.9e+01 cost=3.6e+06 flops=3.4e+06
 sigma_tot[gemm] counter=114 i=0 t=2.1e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=1 t=1.8e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=2 t=8.3e-01 per=1.4e+01 cost=1.7e+06 flops=2.1e+06
 sigma_tot[gemm] counter=114 i=3 t=8.3e-01 per=1.4e+01 cost=1.7e+06 flops=2.1e+06
 sigma_tot[gemm] counter=114 i=4 t=8.4e-01 per=1.5e+01 cost=1.5e+06 flops=1.7e+06
 sigma_tot[gemm] counter=114 i=5 t=8.3e-01 per=1.4e+01 cost=1.5e+06 flops=1.8e+06
 sigma_tot[gemm] counter=114 total t=3.3e+00 per=5.8e+01 cost=6.4e+06 flops=1.9e+06
 sigma_tot[red] counter=114 t=1.4e+00 per=2.4e+01 cost=1.7e+06 flops=1.2e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.3e-05,2.8e-06,1.1e-06,1.7e-07
    4   0 +    -116.323142503667 -5.732e-08  2.168e-05    3     4  2.489e-01 6.223e-02 5.422e-02
TIMING FOR Davidson : 2.489e-01  T(cal/comm/rest)=2.169e-01,3.580e-07,3.204e-02
decomposed t_rest=3.204e-02
 T(sub)    =7.575e-05 per=2.364e-01
 T(precond)=3.185e-02 per=9.941e+01
 T(ortho)  =9.787e-06 per=3.054e-02
 T(xcopy)  =6.190e-07 per=1.932e-03
 T(xnrm2)  =1.143e-05 per=3.568e-02
 T(other)  =9.124e-05 per=2.847e-01
optimized energies: isweep=0 ibond=25 dots=1 e[0]=-116.323142503667 nmvp=4
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=2.747e-04 change=1.893e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond25.txt
 qbond: qsuper nsym=8 dimAll=28
 (14,-2):4 (14,-4):2 (15,-3):7 (16,-2):5 (16,-4):3 (17,-3):1 (15,-1):4 (15,-5):2
timing for divide=1.0e-05
timing for compute=9.6e-03
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(nkr): 9.6e-03 S T(divide/compute[cpu/gpu/rest]/collect)=1.0e-05,9.6e-03,0.0e+00,4.2e-06,1.5e-05 -----
decimation summary: 28->7 dwt=+0.000e+00 SvN=1.234e+00
 qbond: qkept nsym=3 dimAll=7
 (15,-1):4 (15,-3):2 (16,-2):1
----- TIMING for decimation_row(nkr): 9.868e-03 S T(decim/select/formRot)=9.636e-03,2.126e-04,1.958e-05 -----
----- TIMING FOR onedot_decimation: 9.949e-03 S T(wf/decim)=5.952e-05,9.889e-03 -----
ctns::oper_renorm coord=(10,0) superblock=cr oplist=HCSAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSAB nops=H:1 C:20 S:20 A:190 B:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3251:2.480e-02MB:2.422e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 A:0 B:95.7 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.747e-04 change=2.281e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=441 : 3.147e-02 S -----
rank=0 GPUmem(GB): used=1.233e-04 (oper)=6.159e-05
rank=0 GPUmem(GB): used=1.235e-04 (oper,site)=6.159e-05,2.608e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=441
 no. of rintermediate operators=207
 no. of coefficients=8802:6.715e-02MB:6.558e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.536e-03 S -----
rank=0 GPUmem(GB): used=1.891e-04 (oper,site,rinter)=6.159e-05,2.608e-07,6.558e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 7.032e-03 S size(rtasks)=441 size(Rlst2)=9 T(Rmu/Rlist)=4.005e-03,3.026e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 7.282e-03 S size(rtasks)=441 size(Rlst)=965 -----
rank=0 GPUmem(GB): used=1.891e-04 avail=6.176e+00 total=6.176e+00 batch[need]=3.523e-04 blksize=16 blksize0=16 batchsize=965
rank=0 GPUmem(GB): used=5.414e-04 (oper,site,rinter,batch)=6.159e-05,2.608e-07,6.558e-05,3.523e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.425e-03,2.244e-02,9.868e-03
----- TIMING FOR renorm : t_inter=5.4e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.8e-02 -----
 renorm[inter] counter=26 t=5.4e-03 per=1.4e+01 cost=1.9e+05 flops=3.4e+07
 renorm[gemm] counter=26 i=0 t=2.4e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=1 t=2.1e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=2 t=7.4e-03 per=2.0e+01 cost=2.6e+03 flops=3.5e+05
 renorm[gemm] counter=26 i=3 t=7.5e-03 per=2.0e+01 cost=2.8e+04 flops=3.8e+06
 renorm[gemm] counter=26 i=4 t=2.0e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=5 t=2.0e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=6 t=7.5e-03 per=2.0e+01 cost=2.8e+04 flops=3.7e+06
 renorm[gemm] counter=26 total t=2.2e-02 per=5.9e+01 cost=5.9e+04 flops=2.6e+06
 renorm[red] counter=26 t=9.9e-03 per=2.6e+01 cost=8.9e+03 flops=9.0e+05
----- TIMING FOR renorm_tot : t_inter=1.5e-01 t_gemm=5.7e-01 t_reduction=2.6e-01 tot=9.7e-01 -----
 renorm_tot[inter] counter=26 t=1.5e-01 per=1.5e+01 cost=9.4e+05 flops=6.3e+06
 renorm_tot[gemm] counter=26 i=0 t=3.7e-05 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=26 i=1 t=3.1e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=26 i=2 t=6.6e-02 per=6.8e+00 cost=1.9e+05 flops=2.9e+06
 renorm_tot[gemm] counter=26 i=3 t=6.8e-02 per=6.9e+00 cost=2.1e+05 flops=3.1e+06
 renorm_tot[gemm] counter=26 i=4 t=1.2e-01 per=1.3e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=26 i=5 t=1.2e-01 per=1.2e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=26 i=6 t=1.9e-01 per=1.9e+01 cost=2.7e+06 flops=1.4e+07
 renorm_tot[gemm] counter=26 total t=5.7e-01 per=5.8e+01 cost=3.6e+06 flops=6.3e+06
 renorm_tot[red] counter=26 t=2.6e-01 per=2.6e+01 cost=1.2e+06 flops=4.8e+06
----- TIMING FOR oper_renorm : 9.5e-02 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=6.104e-05 change=9.697e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.190e-03 change=-2.285e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::oper_ab2pq coord=(10,0) superblock=cr alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3251:2.480e-02MB:2.422e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.190e-03 change=2.278e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.190e-03 change=7.600e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 after qops2.allocate_gpu
ctns::oper_a2p ifab=1 ifkr=0 maxsize=0:0.000e+00GB
ctns::oper_b2q ifab=1 ifkr=0 maxsize=3110:2.317e-05GB
iproc=0
 qops_tmp: oplist=B nops=B:210 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=3110:2.373e-02MB:2.317e-05GB
        per(mem): B:100 
   init qops_tmp: dt=0.00161 tinit=0.00161
   copy opB to qops_tmps: dt=0.000906 tcopy=0.000906
   bcast: size(opB)=3110:2.32e-05GB dt=7.8e-08 speed=297GB/s tcomm=7.8e-08
   compute opQ from opB: dt=0.00747 tcomp=0.00747
iproc=0
 qops_tmp: oplist=N nops=N:210 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=3110:0.0237MB:2.32e-05GB
        per(mem): N:100 
   init qops_tmp: dt=0.0015 tinit=0.0031
   from opB to opB.H(): dt=0.00781 tadjt=0.00781
   bcast: size(opN)=3110:2.32e-05GB dt=7.2e-08 speed=322GB/s tcomm=1.5e-07
   compute opQ from opB.H(): dt=0.00735 tcomp=0.0148
----- TIMING FOR oper_b2qGPU : 0.0272 S T(init/copy/adjt+bcast/comp/rest)=0.0031,0.000906,0.00781,0.0148,0.000559 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.099e-03 change=4.321e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.099e-03 change=2.480e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.099e-03 change=-5.960e-08 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 before move
rank=0 GPUmem(GB): used=1.101e-04 avail=6.176e+00 before move
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.099e-03 change=-2.284e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after move
rank=0 GPUmem(GB): used=8.591e-05 avail=6.176e+00 after move
check ||H-H.dagger||=2.081e-15 coord=(10,0) rank=0
----- TIMING FOR oper_ab2pq : 0.0324 S T(init/copyHCS/opP/opQ/to_gpu/to_cpu/move)=0.00376,2.72e-05,7.8e-06,0.0272,0,0.000861,0.000462 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.099e-03 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.099e-03 change=-7.153e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 8.819e-01 S #####
 T(local opt: fetch) = 1.529e-02 S  per = 1.73  per(accum) = 1.73
 T(local opt: hdiag) = 4.189e-01 S  per = 47.5  per(accum) = 49.2
 T(local opt: dvdsn) = 3.078e-01 S  per = 34.9  per(accum) = 84.1
 T(local opt: decim) = 9.958e-03 S  per = 1.13  per(accum) = 85.3
 T(local opt: guess) = 8.590e-05 S  per = 0.00974  per(accum) = 85.3
 T(local opt: renrm) = 1.296e-01 S  per = 14.7  per(accum) = 100
 T(local opt: save ) = 2.981e-04 S  per = 0.0338  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.078e-01 S  T(sum) = 3.075e-01 S  per = 9.991e+01
 T(local opt: preprocess                  ) = 9.997e-05 S  per = 0.0325  per(accum) = 0.0325
 T(local opt: symbolic_formulae           ) = 2.574e-02 S  per = 8.37  per(accum) = 8.4
 T(local opt: hintermediate init          ) = 7.257e-04 S  per = 0.236  per(accum) = 8.64
 T(local opt: preprocess_hformulae_Hxlist ) = 1.004e-02 S  per = 3.26  per(accum) = 11.9
 T(local opt: hmmtasks init               ) = 2.196e-02 S  per = 7.14  per(accum) = 19
 T(local opt: initial guess for dvdson    ) = 3.272e-06 S  per = 0.00106  per(accum) = 19
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.117e-01 S  per = 68.8  per(accum) = 87.9
 T(local opt: dvdson [cpu-gpu]            ) = 5.163e-03 S  per = 1.68  per(accum) = 89.6
 T(local opt: dvdson [nccl]               ) = 3.233e-05 S  per = 0.0105  per(accum) = 89.6
 T(local opt: dvdson [mpi]                ) = 3.580e-07 S  per = 0.000116  per(accum) = 89.6
 T(local opt: dvdson [rest part(linalg)]  ) = 3.204e-02 S  per = 10.4  per(accum) = 100
Detailed decomposition of T(renrm) = 1.296e-01 S  T(sum) = 1.296e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 9.926e-05 S  per = 0.0766  per(accum) = 0.0766
 T(local opt: qops init                    ) = 2.930e-03 S  per = 2.26  per(accum) = 2.34
 T(local opt: symbolic_formulae_renorm     ) = 3.150e-02 S  per = 24.3  per(accum) = 26.6
 T(local opt: allocate qops on gpu         ) = 1.034e-04 S  per = 0.0797  per(accum) = 26.7
 T(local opt: site memcpy cpu2gpu          ) = 6.922e-04 S  per = 0.534  per(accum) = 27.3
 T(local opt: rintermediate init           ) = 2.564e-03 S  per = 1.98  per(accum) = 29.2
 T(local opt: preprocess_formulae_Rlist2   ) = 7.356e-03 S  per = 5.68  per(accum) = 34.9
 T(local opt: rmmtasks init                ) = 1.150e-02 S  per = 8.88  per(accum) = 43.8
 T(local opt: qops memset on cpu           ) = 7.200e-08 S  per = 5.55e-05  per(accum) = 43.8
 T(local opt: preprocess_renorm_batchGPU   ) = 3.789e-02 S  per = 29.2  per(accum) = 73
 T(local opt: deallocate cpu and gpu memory) = 8.315e-05 S  per = 0.0641  per(accum) = 73.1
 T(local opt: construct opS [ifdists=true] ) = 9.200e-08 S  per = 7.1e-05  per(accum) = 73.1
 T(local opt: reduction of opS & opH [nccl]) = 7.000e-08 S  per = 5.4e-05  per(accum) = 73.1
 T(local opt: qops memcpy gpu2cpu          ) = 5.000e-08 S  per = 3.86e-05  per(accum) = 73.1
 T(local opt: reduction of opS & opH [mpi] ) = 1.250e-07 S  per = 9.64e-05  per(accum) = 73.1
 T(local opt: qops_pool join and erase     ) = 2.434e-03 S  per = 1.88  per(accum) = 75
 T(local opt: conversion from opAB to opPQ ) = 3.246e-02 S  per =   25  per(accum) = 100
##### sweep opt: 1.491e+01 S #####
 T(sweep opt: fetch) = 3.285e-01 S  per =  2.2  per(accum) = 2.2
 T(sweep opt: hdiag) = 4.860e+00 S  per = 32.6  per(accum) = 34.8
 T(sweep opt: dvdsn) = 7.592e+00 S  per = 50.9  per(accum) = 85.7
 T(sweep opt: decim) = 2.826e-01 S  per =  1.9  per(accum) = 87.6
 T(sweep opt: guess) = 2.167e-03 S  per = 0.0145  per(accum) = 87.6
 T(sweep opt: renrm) = 1.843e+00 S  per = 12.4  per(accum) = 100
 T(sweep opt: save ) = 6.205e-03 S  per = 0.0416  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.592e+00 S  T(sum) = 7.585e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 2.627e-03 S  per = 0.0346  per(accum) = 0.0346
 T(sweep opt: symbolic_formulae           ) = 3.240e-01 S  per = 4.27  per(accum) = 4.31
 T(sweep opt: hintermediate init          ) = 8.530e-03 S  per = 0.112  per(accum) = 4.42
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.026e-01 S  per = 1.35  per(accum) = 5.77
 T(sweep opt: hmmtasks init               ) = 1.891e-01 S  per = 2.49  per(accum) = 8.26
 T(sweep opt: initial guess for dvdson    ) = 8.710e-05 S  per = 0.00115  per(accum) = 8.27
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.766e+00 S  per =   76  per(accum) = 84.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.505e-01 S  per = 1.98  per(accum) = 86.3
 T(sweep opt: dvdson [nccl]               ) = 6.453e-04 S  per = 0.00851  per(accum) = 86.3
 T(sweep opt: dvdson [mpi]                ) = 1.459e-05 S  per = 0.000192  per(accum) = 86.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.041e+00 S  per = 13.7  per(accum) = 100
Detailed decomposition of T(renrm) = 1.843e+00 S  T(sum) = 1.843e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.391e-03 S  per = 0.184  per(accum) = 0.184
 T(sweep opt: qops init                    ) = 4.630e-02 S  per = 2.51  per(accum) = 2.7
 T(sweep opt: symbolic_formulae_renorm     ) = 3.069e-01 S  per = 16.7  per(accum) = 19.3
 T(sweep opt: allocate qops on gpu         ) = 1.509e-03 S  per = 0.0819  per(accum) = 19.4
 T(sweep opt: site memcpy cpu2gpu          ) = 3.491e-02 S  per = 1.89  per(accum) = 21.3
 T(sweep opt: rintermediate init           ) = 5.840e-02 S  per = 3.17  per(accum) = 24.5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.012e-01 S  per = 5.49  per(accum) = 30
 T(sweep opt: rmmtasks init                ) = 2.069e-01 S  per = 11.2  per(accum) = 41.2
 T(sweep opt: qops memset on cpu           ) = 1.115e-06 S  per = 6.05e-05  per(accum) = 41.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 9.771e-01 S  per =   53  per(accum) = 94.2
 T(sweep opt: deallocate cpu and gpu memory) = 2.366e-03 S  per = 0.128  per(accum) = 94.4
 T(sweep opt: construct opS [ifdists=true] ) = 1.015e-06 S  per = 5.51e-05  per(accum) = 94.4
 T(sweep opt: reduction of opS & opH [nccl]) = 1.019e-06 S  per = 5.53e-05  per(accum) = 94.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.927e-03 S  per = 0.267  per(accum) = 94.6
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.804e-04 S  per = 0.0261  per(accum) = 94.7
 T(sweep opt: qops_pool join and erase     ) = 3.766e-02 S  per = 2.04  per(accum) = 96.7
 T(sweep opt: conversion from opAB to opPQ ) = 6.086e-02 S  per =  3.3  per(accum) = 100
##### global opt: 1.491e+01 S #####
 T(global opt: fetch) = 3.285e-01 S  per =  2.2  per(accum) = 2.2
 T(global opt: hdiag) = 4.860e+00 S  per = 32.6  per(accum) = 34.8
 T(global opt: dvdsn) = 7.592e+00 S  per = 50.9  per(accum) = 85.7
 T(global opt: decim) = 2.826e-01 S  per =  1.9  per(accum) = 87.6
 T(global opt: guess) = 2.167e-03 S  per = 0.0145  per(accum) = 87.6
 T(global opt: renrm) = 1.843e+00 S  per = 12.4  per(accum) = 100
 T(global opt: save ) = 6.205e-03 S  per = 0.0416  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.592e+00 S  T(sum) = 7.585e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 2.627e-03 S  per = 0.0346  per(accum) = 0.0346
 T(global opt: symbolic_formulae           ) = 3.240e-01 S  per = 4.27  per(accum) = 4.31
 T(global opt: hintermediate init          ) = 8.530e-03 S  per = 0.112  per(accum) = 4.42
 T(global opt: preprocess_hformulae_Hxlist ) = 1.026e-01 S  per = 1.35  per(accum) = 5.77
 T(global opt: hmmtasks init               ) = 1.891e-01 S  per = 2.49  per(accum) = 8.26
 T(global opt: initial guess for dvdson    ) = 8.710e-05 S  per = 0.00115  per(accum) = 8.27
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.766e+00 S  per =   76  per(accum) = 84.3
 T(global opt: dvdson [cpu-gpu]            ) = 1.505e-01 S  per = 1.98  per(accum) = 86.3
 T(global opt: dvdson [nccl]               ) = 6.453e-04 S  per = 0.00851  per(accum) = 86.3
 T(global opt: dvdson [mpi]                ) = 1.459e-05 S  per = 0.000192  per(accum) = 86.3
 T(global opt: dvdson [rest part(linalg)]  ) = 1.041e+00 S  per = 13.7  per(accum) = 100
Detailed decomposition of T(renrm) = 1.843e+00 S  T(sum) = 1.843e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.391e-03 S  per = 0.184  per(accum) = 0.184
 T(global opt: qops init                    ) = 4.630e-02 S  per = 2.51  per(accum) = 2.7
 T(global opt: symbolic_formulae_renorm     ) = 3.069e-01 S  per = 16.7  per(accum) = 19.3
 T(global opt: allocate qops on gpu         ) = 1.509e-03 S  per = 0.0819  per(accum) = 19.4
 T(global opt: site memcpy cpu2gpu          ) = 3.491e-02 S  per = 1.89  per(accum) = 21.3
 T(global opt: rintermediate init           ) = 5.840e-02 S  per = 3.17  per(accum) = 24.5
 T(global opt: preprocess_formulae_Rlist2   ) = 1.012e-01 S  per = 5.49  per(accum) = 30
 T(global opt: rmmtasks init                ) = 2.069e-01 S  per = 11.2  per(accum) = 41.2
 T(global opt: qops memset on cpu           ) = 1.115e-06 S  per = 6.05e-05  per(accum) = 41.2
 T(global opt: preprocess_renorm_batchGPU   ) = 9.771e-01 S  per =   53  per(accum) = 94.2
 T(global opt: deallocate cpu and gpu memory) = 2.366e-03 S  per = 0.128  per(accum) = 94.4
 T(global opt: construct opS [ifdists=true] ) = 1.015e-06 S  per = 5.51e-05  per(accum) = 94.4
 T(global opt: reduction of opS & opH [nccl]) = 1.019e-06 S  per = 5.53e-05  per(accum) = 94.4
 T(global opt: qops memcpy gpu2cpu          ) = 4.927e-03 S  per = 0.267  per(accum) = 94.6
 T(global opt: reduction of opS & opH [mpi] ) = 4.804e-04 S  per = 0.0261  per(accum) = 94.7
 T(global opt: qops_pool join and erase     ) = 3.766e-02 S  per = 2.04  per(accum) = 96.7
 T(global opt: conversion from opAB to opPQ ) = 6.086e-02 S  per =  3.3  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.893e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=26/seqsize=34 dots=1 dbond=(8,0)-(9,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=31:2.365e-04MB:2.310e-07GB
total mem of comb=1225:9.346e-03MB:9.127e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=9,10,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc= 5
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:18 S:22 A:153 B:171 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1860:1.419e-02MB:1.386e-05GB
        per(mem): H:0.753 C:2.42 S:2.96 A:0 B:93.9 
 rqops: oplist=HCSPQ nops=H:1 C:20 S:20 P:190 Q:210 
        dim(bra,ket)=7,7 size(op)=21:0.00016MB size(tot)=3251:0.0248MB:2.42e-05GB
        per(mem): H:0.646 C:1.85 S:1.85 P:0 Q:95.7 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=7447:0.0568MB:5.55e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.080e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(9,0) fdel=./scratch/sweep/lop(8,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.490e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,7,4) nnz=31:2.365e-04MB
qtensor3: wf3 own=1 _data=0x3c62a900
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (14,0):3 (14,2):2 (13,1):1
 qbond: qcol nsym=3 dimAll=7
 (15,-1):4 (15,-3):2 (16,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=6 nblocks=36 size=31:2.365e-04MB
### DIAG TIMING: total=4.394e-01 t1=3.013e-05, t2=2.083e-03, t3=2.482e-03, t4=4.348e-01, t5=6.228e-06, t6=1.599e-05, t7=4.269e-06
duration_diagGPU:4.394e-01
duration_diagreduce:1.500e-07
duration_diagtransform:5.420e-07
----- TIMING FOR symbolic_formulae_onedot with size=1635 : 2.560e-02 S -----
rank=0 GPUmem(GB): used=5.548e-05 (oper)=5.548e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1635
 no. of hintermediate operators=828
 no. of coefficients=8280:6.317e-02MB:6.169e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.012e-04 S -----
rank=0 GPUmem(GB): used=1.172e-04 (oper,hinter)=5.548e-05,6.169e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 8.984e-03 S size(H_formulae)=1635 size(Hxlst2)=6 T(Hmu/Hxlist)=4.078e-03,4.906e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 9.586e-03 S size(H_formulae)=1635 size(Hxlst)=3940 -----
rank=0 GPUmem(GB): used=1.172e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=4.619e-07 batch[need]=8.513e-04 blksize=12 blksize0=4 batchsize=3940
rank=0 GPUmem(GB): used=9.689e-04 (oper,hinter,dvdson,batch)=5.548e-05,6.169e-05,4.619e-07,8.513e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=31 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.784e-04,9.958e-03,2.993e-02,1.233e-02,5.300e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=7.729e-04 speed=5.976e-04GB/S T(nccl)=5.522e-06 speed=8.365e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=115 t=1.0e-02 per=1.9e+01 cost=9.0e+04 flops=9.0e+06
 sigma[gemm] counter=115 i=0 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=1 t=1.0e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=2 t=7.5e-03 per=1.4e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=115 i=3 t=7.6e-03 per=1.4e+01 cost=3.3e+04 flops=4.4e+06
 sigma[gemm] counter=115 i=4 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=115 i=5 t=7.4e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=115 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=5.0e+06
 sigma[red] counter=115 t=1.2e-02 per=2.4e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.3e+00 t_reduction=1.4e+00 tot=5.8e+00 -----
 sigma_tot[inter] counter=115 t=1.1e+00 per=1.9e+01 cost=3.7e+06 flops=3.4e+06
 sigma_tot[gemm] counter=115 i=0 t=2.1e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=1 t=1.8e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=2 t=8.4e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=115 i=3 t=8.4e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=115 i=4 t=8.4e-01 per=1.5e+01 cost=1.5e+06 flops=1.8e+06
 sigma_tot[gemm] counter=115 i=5 t=8.3e-01 per=1.4e+01 cost=1.5e+06 flops=1.8e+06
 sigma_tot[gemm] counter=115 total t=3.3e+00 per=5.8e+01 cost=6.5e+06 flops=1.9e+06
 sigma_tot[red] counter=115 t=1.4e+00 per=2.4e+01 cost=1.7e+06 flops=1.2e+06
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,4.4e-06,1.9e-06,8.5e-07,1.4e-07
settings: ndim=31 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.323142503667 -1.116e+03  3.263e-03    1     1  5.311e-02 5.311e-02 5.309e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.274e-03,1.417e-02,3.007e-02,1.246e-02,5.798e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=1.266e-03 speed=3.648e-04GB/S T(nccl)=7.374e-06 speed=6.264e-02GB/S
----- TIMING FOR sigma : t_inter=1.4e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.7e-02 -----
 sigma[inter] counter=116 t=1.4e-02 per=2.5e+01 cost=9.0e+04 flops=6.4e+06
 sigma[gemm] counter=116 i=0 t=3.6e-06 per=6.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=1 t=3.0e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=2 t=7.5e-03 per=1.3e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=116 i=3 t=7.5e-03 per=1.3e+01 cost=3.3e+04 flops=4.4e+06
 sigma[gemm] counter=116 i=4 t=7.5e-03 per=1.3e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=116 i=5 t=7.5e-03 per=1.3e+01 cost=4.2e+04 flops=5.5e+06
 sigma[gemm] counter=116 total t=3.0e-02 per=5.3e+01 cost=1.5e+05 flops=5.0e+06
 sigma[red] counter=116 t=1.2e-02 per=2.2e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.4e+00 t_reduction=1.4e+00 tot=5.9e+00 -----
 sigma_tot[inter] counter=116 t=1.1e+00 per=1.9e+01 cost=3.8e+06 flops=3.4e+06
 sigma_tot[gemm] counter=116 i=0 t=2.1e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=1 t=1.8e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=2 t=8.4e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=116 i=3 t=8.4e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=116 i=4 t=8.5e-01 per=1.5e+01 cost=1.5e+06 flops=1.8e+06
 sigma_tot[gemm] counter=116 i=5 t=8.4e-01 per=1.4e+01 cost=1.5e+06 flops=1.8e+06
 sigma_tot[gemm] counter=116 total t=3.4e+00 per=5.8e+01 cost=6.7e+06 flops=2.0e+06
 sigma_tot[red] counter=116 t=1.4e+00 per=2.4e+01 cost=1.7e+06 flops=1.3e+06
T(sub)=4.0e-05 T(gemm/eig/ortho/gemm/axpy)=9.1e-06,2.3e-05,6.4e-06,1.8e-06,3.6e-07
    2   0 -    -116.323153793083 -1.129e-05  2.010e-04    2     2  1.209e-01 6.044e-02 5.563e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.395e-04,9.924e-03,3.001e-02,1.267e-02,5.315e-02
 analyze_tgpu[Hx]: ndim=31:2.310e-07GB T(cpu-gpu)=5.334e-04 speed=8.660e-04GB/S T(nccl)=6.010e-06 speed=7.686e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=117 t=9.9e-03 per=1.9e+01 cost=9.0e+04 flops=9.1e+06
 sigma[gemm] counter=117 i=0 t=1.9e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=1 t=1.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=2 t=7.5e-03 per=1.4e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=117 i=3 t=7.5e-03 per=1.4e+01 cost=3.3e+04 flops=4.4e+06
 sigma[gemm] counter=117 i=4 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.6e+06
 sigma[gemm] counter=117 i=5 t=7.5e-03 per=1.4e+01 cost=4.2e+04 flops=5.5e+06
 sigma[gemm] counter=117 total t=3.0e-02 per=5.7e+01 cost=1.5e+05 flops=5.0e+06
 sigma[red] counter=117 t=1.3e-02 per=2.4e+01 cost=4.1e+04 flops=3.2e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.4e+00 t_reduction=1.4e+00 tot=5.9e+00 -----
 sigma_tot[inter] counter=117 t=1.1e+00 per=1.9e+01 cost=3.9e+06 flops=3.5e+06
 sigma_tot[gemm] counter=117 i=0 t=2.2e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=1 t=1.8e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=2 t=8.5e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=117 i=3 t=8.5e-01 per=1.4e+01 cost=1.8e+06 flops=2.2e+06
 sigma_tot[gemm] counter=117 i=4 t=8.6e-01 per=1.5e+01 cost=1.6e+06 flops=1.8e+06
 sigma_tot[gemm] counter=117 i=5 t=8.5e-01 per=1.4e+01 cost=1.6e+06 flops=1.9e+06
 sigma_tot[gemm] counter=117 total t=3.4e+00 per=5.8e+01 cost=6.8e+06 flops=2.0e+06
 sigma_tot[red] counter=117 t=1.4e+00 per=2.4e+01 cost=1.8e+06 flops=1.3e+06
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.7e-05,3.5e-06,1.3e-06,2.1e-07
    3   0 +    -116.323153873735 -8.065e-08  1.462e-05    3     3  1.905e-01 6.350e-02 5.484e-02
TIMING FOR Davidson : 1.905e-01  T(cal/comm/rest)=1.645e-01,5.020e-07,2.598e-02
decomposed t_rest=2.598e-02
 T(sub)    =7.840e-05 per=3.018e-01
 T(precond)=2.580e-02 per=9.932e+01
 T(ortho)  =8.161e-06 per=3.141e-02
 T(xcopy)  =6.320e-07 per=2.433e-03
 T(xnrm2)  =1.684e-06 per=6.482e-03
 T(other)  =8.781e-05 per=3.380e-01
optimized energies: isweep=0 ibond=26 dots=1 e[0]=-116.323153873735 nmvp=3
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.747e-04 change=1.893e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond26.txt
 qbond: qsuper nsym=8 dimAll=28
 (15,-1):4 (15,-3):2 (16,-2):7 (17,-1):5 (17,-3):3 (18,-2):1 (16,0):4 (16,-4):2
timing for divide=1.2e-05
timing for compute=1.1e-02
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(nkr): 1.1e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.2e-05,1.1e-02,0.0e+00,5.4e-06,1.5e-05 -----
decimation summary: 28->6 dwt=+0.000e+00 SvN=1.010e+00
 qbond: qkept nsym=3 dimAll=6
 (16,0):3 (16,-2):2 (17,-1):1
----- TIMING for decimation_row(nkr): 1.125e-02 S T(decim/select/formRot)=1.098e-02,2.558e-04,1.991e-05 -----
----- TIMING FOR onedot_decimation: 1.134e-02 S T(wf/decim)=6.863e-05,1.128e-02 -----
ctns::oper_renorm coord=(9,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1860:1.419e-02MB:1.386e-05GB
        per(mem): H:0.753 C:2.96 S:2.42 P:0 Q:93.9 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.747e-04 change=1.895e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=365 : 6.149e-02 S -----
rank=0 GPUmem(GB): used=1.172e-04 (oper)=5.548e-05
rank=0 GPUmem(GB): used=1.174e-04 (oper,site)=5.548e-05,2.310e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=365
 no. of rintermediate operators=828
 no. of coefficients=8280:6.317e-02MB:6.169e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.561e-03 S -----
rank=0 GPUmem(GB): used=1.791e-04 (oper,site,rinter)=5.548e-05,2.310e-07,6.169e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.547e-02 S size(rtasks)=365 size(Rlst2)=9 T(Rmu/Rlist)=9.537e-03,5.937e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.588e-02 S size(rtasks)=365 size(Rlst)=2015 -----
rank=0 GPUmem(GB): used=1.791e-04 avail=6.176e+00 total=6.176e+00 batch[need]=4.354e-04 blksize=12 blksize0=4 batchsize=2015
rank=0 GPUmem(GB): used=6.145e-04 (oper,site,rinter,batch)=5.548e-05,2.310e-07,6.169e-05,4.354e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.937e-03,2.279e-02,1.010e-02
----- TIMING FOR renorm : t_inter=5.9e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=27 t=5.9e-03 per=1.5e+01 cost=4.5e+04 flops=7.6e+06
 renorm[gemm] counter=27 i=0 t=2.1e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=1 t=1.8e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=2 t=7.6e-03 per=1.9e+01 cost=4.8e+03 flops=6.4e+05
 renorm[gemm] counter=27 i=3 t=7.6e-03 per=2.0e+01 cost=2.8e+04 flops=3.7e+06
 renorm[gemm] counter=27 i=4 t=1.8e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=5 t=1.7e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=6 t=7.6e-03 per=1.9e+01 cost=4.3e+04 flops=5.7e+06
 renorm[gemm] counter=27 total t=2.3e-02 per=5.9e+01 cost=7.6e+04 flops=3.3e+06
 renorm[red] counter=27 t=1.0e-02 per=2.6e+01 cost=1.5e+04 flops=1.5e+06
----- TIMING FOR renorm_tot : t_inter=1.6e-01 t_gemm=5.9e-01 t_reduction=2.7e-01 tot=1.0e+00 -----
 renorm_tot[inter] counter=27 t=1.6e-01 per=1.5e+01 cost=9.9e+05 flops=6.3e+06
 renorm_tot[gemm] counter=27 i=0 t=3.9e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=27 i=1 t=3.3e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=27 i=2 t=7.4e-02 per=7.3e+00 cost=2.0e+05 flops=2.7e+06
 renorm_tot[gemm] counter=27 i=3 t=7.5e-02 per=7.4e+00 cost=2.4e+05 flops=3.2e+06
 renorm_tot[gemm] counter=27 i=4 t=1.2e-01 per=1.2e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=27 i=5 t=1.2e-01 per=1.2e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=27 i=6 t=2.0e-01 per=1.9e+01 cost=2.7e+06 flops=1.4e+07
 renorm_tot[gemm] counter=27 total t=5.9e-01 per=5.8e+01 cost=3.7e+06 flops=6.2e+06
 renorm_tot[red] counter=27 t=2.7e-01 per=2.6e+01 cost=1.3e+06 flops=4.7e+06
qops.to_cpu: size(tot)=1860:1.4e-02MB:1.4e-05GB T(to_cpu)=5.2e-04S speed=2.6e-02GB/S
check ||H-H.dagger||=5.145e-15 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.148 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=2.747e-04 change=1.369e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.090e-03 change=-2.671e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=2.090e-03 change=-6.855e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 8.677e-01 S #####
 T(local opt: fetch) = 1.775e-02 S  per = 2.05  per(accum) = 2.05
 T(local opt: hdiag) = 4.395e-01 S  per = 50.6  per(accum) = 52.7
 T(local opt: dvdsn) = 2.484e-01 S  per = 28.6  per(accum) = 81.3
 T(local opt: decim) = 1.138e-02 S  per = 1.31  per(accum) = 82.6
 T(local opt: guess) = 8.384e-05 S  per = 0.00966  per(accum) = 82.6
 T(local opt: renrm) = 1.503e-01 S  per = 17.3  per(accum) = 100
 T(local opt: save ) = 2.993e-04 S  per = 0.0345  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.484e-01 S  T(sum) = 2.481e-01 S  per = 9.986e+01
 T(local opt: preprocess                  ) = 9.600e-05 S  per = 0.0387  per(accum) = 0.0387
 T(local opt: symbolic_formulae           ) = 2.561e-02 S  per = 10.3  per(accum) = 10.4
 T(local opt: hintermediate init          ) = 7.205e-04 S  per = 0.29  per(accum) = 10.7
 T(local opt: preprocess_hformulae_Hxlist ) = 9.707e-03 S  per = 3.91  per(accum) = 14.6
 T(local opt: hmmtasks init               ) = 2.145e-02 S  per = 8.65  per(accum) = 23.2
 T(local opt: initial guess for dvdson    ) = 3.241e-06 S  per = 0.00131  per(accum) = 23.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.619e-01 S  per = 65.3  per(accum) = 88.5
 T(local opt: dvdson [cpu-gpu]            ) = 2.573e-03 S  per = 1.04  per(accum) = 89.5
 T(local opt: dvdson [nccl]               ) = 1.891e-05 S  per = 0.00762  per(accum) = 89.5
 T(local opt: dvdson [mpi]                ) = 5.020e-07 S  per = 0.000202  per(accum) = 89.5
 T(local opt: dvdson [rest part(linalg)]  ) = 2.598e-02 S  per = 10.5  per(accum) = 100
Detailed decomposition of T(renrm) = 1.503e-01 S  T(sum) = 1.503e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.115e-05 S  per = 0.0473  per(accum) = 0.0473
 T(local opt: qops init                    ) = 2.481e-03 S  per = 1.65  per(accum) = 1.7
 T(local opt: symbolic_formulae_renorm     ) = 6.152e-02 S  per = 40.9  per(accum) = 42.6
 T(local opt: allocate qops on gpu         ) = 9.786e-05 S  per = 0.0651  per(accum) = 42.7
 T(local opt: site memcpy cpu2gpu          ) = 1.911e-03 S  per = 1.27  per(accum) = 44
 T(local opt: rintermediate init           ) = 2.585e-03 S  per = 1.72  per(accum) = 45.7
 T(local opt: preprocess_formulae_Rlist2   ) = 1.600e-02 S  per = 10.6  per(accum) = 56.3
 T(local opt: rmmtasks init                ) = 2.345e-02 S  per = 15.6  per(accum) = 71.9
 T(local opt: qops memset on cpu           ) = 5.900e-08 S  per = 3.93e-05  per(accum) = 71.9
 T(local opt: preprocess_renorm_batchGPU   ) = 3.896e-02 S  per = 25.9  per(accum) = 97.9
 T(local opt: deallocate cpu and gpu memory) = 1.223e-04 S  per = 0.0813  per(accum) = 97.9
 T(local opt: construct opS [ifdists=true] ) = 8.300e-08 S  per = 5.52e-05  per(accum) = 97.9
 T(local opt: reduction of opS & opH [nccl]) = 6.100e-08 S  per = 4.06e-05  per(accum) = 97.9
 T(local opt: qops memcpy gpu2cpu          ) = 5.359e-04 S  per = 0.357  per(accum) = 98.3
 T(local opt: reduction of opS & opH [mpi] ) = 2.380e-05 S  per = 0.0158  per(accum) = 98.3
 T(local opt: qops_pool join and erase     ) = 2.541e-03 S  per = 1.69  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.846e-06 S  per = 0.00123  per(accum) = 100
##### sweep opt: 1.578e+01 S #####
 T(sweep opt: fetch) = 3.462e-01 S  per = 2.19  per(accum) = 2.19
 T(sweep opt: hdiag) = 5.299e+00 S  per = 33.6  per(accum) = 35.8
 T(sweep opt: dvdsn) = 7.841e+00 S  per = 49.7  per(accum) = 85.5
 T(sweep opt: decim) = 2.940e-01 S  per = 1.86  per(accum) = 87.3
 T(sweep opt: guess) = 2.251e-03 S  per = 0.0143  per(accum) = 87.3
 T(sweep opt: renrm) = 1.993e+00 S  per = 12.6  per(accum) = 100
 T(sweep opt: save ) = 6.504e-03 S  per = 0.0412  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.841e+00 S  T(sum) = 7.833e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 2.723e-03 S  per = 0.0348  per(accum) = 0.0348
 T(sweep opt: symbolic_formulae           ) = 3.496e-01 S  per = 4.46  per(accum) = 4.5
 T(sweep opt: hintermediate init          ) = 9.250e-03 S  per = 0.118  per(accum) = 4.62
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.123e-01 S  per = 1.43  per(accum) = 6.05
 T(sweep opt: hmmtasks init               ) = 2.105e-01 S  per = 2.69  per(accum) = 8.74
 T(sweep opt: initial guess for dvdson    ) = 9.034e-05 S  per = 0.00115  per(accum) = 8.74
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.928e+00 S  per = 75.7  per(accum) = 84.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.531e-01 S  per = 1.95  per(accum) = 86.4
 T(sweep opt: dvdson [nccl]               ) = 6.642e-04 S  per = 0.00848  per(accum) = 86.4
 T(sweep opt: dvdson [mpi]                ) = 1.509e-05 S  per = 0.000193  per(accum) = 86.4
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.067e+00 S  per = 13.6  per(accum) = 100
Detailed decomposition of T(renrm) = 1.993e+00 S  T(sum) = 1.993e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.462e-03 S  per = 0.174  per(accum) = 0.174
 T(sweep opt: qops init                    ) = 4.878e-02 S  per = 2.45  per(accum) = 2.62
 T(sweep opt: symbolic_formulae_renorm     ) = 3.684e-01 S  per = 18.5  per(accum) = 21.1
 T(sweep opt: allocate qops on gpu         ) = 1.607e-03 S  per = 0.0806  per(accum) = 21.2
 T(sweep opt: site memcpy cpu2gpu          ) = 3.682e-02 S  per = 1.85  per(accum) = 23
 T(sweep opt: rintermediate init           ) = 6.098e-02 S  per = 3.06  per(accum) = 26.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.172e-01 S  per = 5.88  per(accum) = 32
 T(sweep opt: rmmtasks init                ) = 2.303e-01 S  per = 11.6  per(accum) = 43.5
 T(sweep opt: qops memset on cpu           ) = 1.174e-06 S  per = 5.89e-05  per(accum) = 43.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.016e+00 S  per =   51  per(accum) = 94.5
 T(sweep opt: deallocate cpu and gpu memory) = 2.488e-03 S  per = 0.125  per(accum) = 94.6
 T(sweep opt: construct opS [ifdists=true] ) = 1.098e-06 S  per = 5.51e-05  per(accum) = 94.6
 T(sweep opt: reduction of opS & opH [nccl]) = 1.080e-06 S  per = 5.42e-05  per(accum) = 94.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.463e-03 S  per = 0.274  per(accum) = 94.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.042e-04 S  per = 0.0253  per(accum) = 94.9
 T(sweep opt: qops_pool join and erase     ) = 4.020e-02 S  per = 2.02  per(accum) = 96.9
 T(sweep opt: conversion from opAB to opPQ ) = 6.086e-02 S  per = 3.05  per(accum) = 100
##### global opt: 1.578e+01 S #####
 T(global opt: fetch) = 3.462e-01 S  per = 2.19  per(accum) = 2.19
 T(global opt: hdiag) = 5.299e+00 S  per = 33.6  per(accum) = 35.8
 T(global opt: dvdsn) = 7.841e+00 S  per = 49.7  per(accum) = 85.5
 T(global opt: decim) = 2.940e-01 S  per = 1.86  per(accum) = 87.3
 T(global opt: guess) = 2.251e-03 S  per = 0.0143  per(accum) = 87.3
 T(global opt: renrm) = 1.993e+00 S  per = 12.6  per(accum) = 100
 T(global opt: save ) = 6.504e-03 S  per = 0.0412  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.841e+00 S  T(sum) = 7.833e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 2.723e-03 S  per = 0.0348  per(accum) = 0.0348
 T(global opt: symbolic_formulae           ) = 3.496e-01 S  per = 4.46  per(accum) = 4.5
 T(global opt: hintermediate init          ) = 9.250e-03 S  per = 0.118  per(accum) = 4.62
 T(global opt: preprocess_hformulae_Hxlist ) = 1.123e-01 S  per = 1.43  per(accum) = 6.05
 T(global opt: hmmtasks init               ) = 2.105e-01 S  per = 2.69  per(accum) = 8.74
 T(global opt: initial guess for dvdson    ) = 9.034e-05 S  per = 0.00115  per(accum) = 8.74
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.928e+00 S  per = 75.7  per(accum) = 84.4
 T(global opt: dvdson [cpu-gpu]            ) = 1.531e-01 S  per = 1.95  per(accum) = 86.4
 T(global opt: dvdson [nccl]               ) = 6.642e-04 S  per = 0.00848  per(accum) = 86.4
 T(global opt: dvdson [mpi]                ) = 1.509e-05 S  per = 0.000193  per(accum) = 86.4
 T(global opt: dvdson [rest part(linalg)]  ) = 1.067e+00 S  per = 13.6  per(accum) = 100
Detailed decomposition of T(renrm) = 1.993e+00 S  T(sum) = 1.993e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.462e-03 S  per = 0.174  per(accum) = 0.174
 T(global opt: qops init                    ) = 4.878e-02 S  per = 2.45  per(accum) = 2.62
 T(global opt: symbolic_formulae_renorm     ) = 3.684e-01 S  per = 18.5  per(accum) = 21.1
 T(global opt: allocate qops on gpu         ) = 1.607e-03 S  per = 0.0806  per(accum) = 21.2
 T(global opt: site memcpy cpu2gpu          ) = 3.682e-02 S  per = 1.85  per(accum) = 23
 T(global opt: rintermediate init           ) = 6.098e-02 S  per = 3.06  per(accum) = 26.1
 T(global opt: preprocess_formulae_Rlist2   ) = 1.172e-01 S  per = 5.88  per(accum) = 32
 T(global opt: rmmtasks init                ) = 2.303e-01 S  per = 11.6  per(accum) = 43.5
 T(global opt: qops memset on cpu           ) = 1.174e-06 S  per = 5.89e-05  per(accum) = 43.5
 T(global opt: preprocess_renorm_batchGPU   ) = 1.016e+00 S  per =   51  per(accum) = 94.5
 T(global opt: deallocate cpu and gpu memory) = 2.488e-03 S  per = 0.125  per(accum) = 94.6
 T(global opt: construct opS [ifdists=true] ) = 1.098e-06 S  per = 5.51e-05  per(accum) = 94.6
 T(global opt: reduction of opS & opH [nccl]) = 1.080e-06 S  per = 5.42e-05  per(accum) = 94.6
 T(global opt: qops memcpy gpu2cpu          ) = 5.463e-03 S  per = 0.274  per(accum) = 94.9
 T(global opt: reduction of opS & opH [mpi] ) = 5.042e-04 S  per = 0.0253  per(accum) = 94.9
 T(global opt: qops_pool join and erase     ) = 4.020e-02 S  per = 2.02  per(accum) = 96.9
 T(global opt: conversion from opAB to opPQ ) = 6.086e-02 S  per = 3.05  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.893e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=27/seqsize=34 dots=1 dbond=(7,0)-(8,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=19:1.450e-04MB:1.416e-07GB
total mem of comb=1213:9.254e-03MB:9.038e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=8,11,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc= 19
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:16 S:24 A:120 B:136 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1506:1.149e-02MB:1.122e-05GB
        per(mem): H:0.93 C:2.66 S:3.98 A:0 B:92.4 
 rqops: oplist=HCSPQ nops=H:1 C:22 S:18 P:153 Q:171 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1860:0.0142MB:1.39e-05GB
        per(mem): H:0.753 C:2.96 S:2.42 P:0 Q:93.9 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=5702:0.0435MB:4.25e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.042e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(8,0) fdel=./scratch/sweep/lop(7,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.109e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,6,4) nnz=19:1.450e-04MB
qtensor3: wf3 own=1 _data=0x3c64ec80
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (12,0):3 (12,2):2 (11,1):1
 qbond: qcol nsym=3 dimAll=6
 (16,0):3 (16,-2):2 (17,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=19:1.450e-04MB
### DIAG TIMING: total=3.295e-01 t1=3.252e-05, t2=2.092e-03, t3=2.494e-03, t4=3.248e-01, t5=4.965e-06, t6=1.437e-05, t7=4.176e-06
duration_diagGPU:3.295e-01
duration_diagreduce:9.100e-08
duration_diagtransform:4.370e-07
----- TIMING FOR symbolic_formulae_onedot with size=1327 : 2.115e-02 S -----
rank=0 GPUmem(GB): used=4.248e-05 (oper)=4.248e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1327
 no. of hintermediate operators=664
 no. of coefficients=7304:5.573e-02MB:5.442e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.284e-04 S -----
rank=0 GPUmem(GB): used=9.690e-05 (oper,hinter)=4.248e-05,5.442e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.607e-03 S size(H_formulae)=1327 size(Hxlst2)=5 T(Hmu/Hxlist)=3.210e-03,3.397e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.034e-03 S size(H_formulae)=1327 size(Hxlst)=2830 -----
rank=0 GPUmem(GB): used=9.690e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.831e-07 batch[need]=4.639e-04 blksize=9 blksize0=3 batchsize=2830
rank=0 GPUmem(GB): used=5.611e-04 (oper,hinter,dvdson,batch)=4.248e-05,5.442e-05,2.831e-07,4.639e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=19 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.217e-04,1.008e-02,3.023e-02,1.246e-02,5.369e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=9.123e-04 speed=3.103e-04GB/S T(nccl)=9.384e-06 speed=3.017e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=118 t=1.0e-02 per=1.9e+01 cost=4.9e+04 flops=4.9e+06
 sigma[gemm] counter=118 i=0 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=1 t=9.9e-07 per=1.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=2 t=7.6e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=118 i=3 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=1.9e+06
 sigma[gemm] counter=118 i=4 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=118 i=5 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.7e+06
 sigma[gemm] counter=118 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=118 t=1.2e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.4e+00 t_reduction=1.4e+00 tot=6.0e+00 -----
 sigma_tot[inter] counter=118 t=1.1e+00 per=1.9e+01 cost=3.9e+06 flops=3.5e+06
 sigma_tot[gemm] counter=118 i=0 t=2.2e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=1 t=1.8e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=2 t=8.6e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=118 i=3 t=8.6e-01 per=1.4e+01 cost=1.9e+06 flops=2.2e+06
 sigma_tot[gemm] counter=118 i=4 t=8.7e-01 per=1.5e+01 cost=1.6e+06 flops=1.9e+06
 sigma_tot[gemm] counter=118 i=5 t=8.6e-01 per=1.4e+01 cost=1.6e+06 flops=1.9e+06
 sigma_tot[gemm] counter=118 total t=3.4e+00 per=5.8e+01 cost=6.9e+06 flops=2.0e+06
 sigma_tot[red] counter=118 t=1.4e+00 per=2.4e+01 cost=1.8e+06 flops=1.3e+06
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,5.2e-06,2.0e-06,9.7e-07,1.8e-07
settings: ndim=19 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.323153873735 -1.116e+03  3.184e-02    1     1  5.381e-02 5.381e-02 5.378e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.192e-03,1.009e-02,3.010e-02,1.239e-02,5.378e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.187e-03 speed=2.385e-04GB/S T(nccl)=5.228e-06 speed=5.415e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=119 t=1.0e-02 per=1.9e+01 cost=4.9e+04 flops=4.9e+06
 sigma[gemm] counter=119 i=0 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=1 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=2 t=7.5e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=119 i=3 t=7.6e-03 per=1.4e+01 cost=1.5e+04 flops=1.9e+06
 sigma[gemm] counter=119 i=4 t=7.6e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=119 i=5 t=7.4e-03 per=1.4e+01 cost=2.7e+04 flops=3.7e+06
 sigma[gemm] counter=119 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=119 t=1.2e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.5e+00 t_reduction=1.4e+00 tot=6.0e+00 -----
 sigma_tot[inter] counter=119 t=1.1e+00 per=1.9e+01 cost=4.0e+06 flops=3.5e+06
 sigma_tot[gemm] counter=119 i=0 t=2.2e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=1 t=1.9e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=2 t=8.7e-01 per=1.4e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[gemm] counter=119 i=3 t=8.7e-01 per=1.4e+01 cost=1.9e+06 flops=2.2e+06
 sigma_tot[gemm] counter=119 i=4 t=8.7e-01 per=1.5e+01 cost=1.6e+06 flops=1.9e+06
 sigma_tot[gemm] counter=119 i=5 t=8.6e-01 per=1.4e+01 cost=1.6e+06 flops=1.9e+06
 sigma_tot[gemm] counter=119 total t=3.5e+00 per=5.8e+01 cost=7.0e+06 flops=2.0e+06
 sigma_tot[red] counter=119 t=1.4e+00 per=2.4e+01 cost=1.8e+06 flops=1.3e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,1.5e-05,3.4e-06,1.3e-06,1.9e-07
    2   0 -    -116.325715901524 -2.562e-03  8.671e-03    2     2  1.173e-01 5.865e-02 5.383e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.023e-03,1.020e-02,3.024e-02,1.258e-02,5.505e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=2.018e-03 speed=1.403e-04GB/S T(nccl)=4.871e-06 speed=5.812e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=120 t=1.0e-02 per=1.9e+01 cost=4.9e+04 flops=4.8e+06
 sigma[gemm] counter=120 i=0 t=1.3e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=1 t=1.2e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=2 t=7.5e-03 per=1.4e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=120 i=3 t=7.7e-03 per=1.4e+01 cost=1.5e+04 flops=1.9e+06
 sigma[gemm] counter=120 i=4 t=7.5e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=120 i=5 t=7.6e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=120 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.8e+06
 sigma[red] counter=120 t=1.3e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.5e+00 t_reduction=1.4e+00 tot=6.1e+00 -----
 sigma_tot[inter] counter=120 t=1.1e+00 per=1.9e+01 cost=4.0e+06 flops=3.5e+06
 sigma_tot[gemm] counter=120 i=0 t=2.2e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=1 t=1.9e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=2 t=8.7e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=120 i=3 t=8.7e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=120 i=4 t=8.8e-01 per=1.5e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=120 i=5 t=8.7e-01 per=1.4e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=120 total t=3.5e+00 per=5.8e+01 cost=7.1e+06 flops=2.0e+06
 sigma_tot[red] counter=120 t=1.4e+00 per=2.4e+01 cost=1.9e+06 flops=1.3e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,2.7e-06,1.0e-06,1.7e-07
    3   0 -    -116.326034029175 -3.181e-04  7.341e-04    3     3  1.875e-01 6.249e-02 5.426e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.670e-03,1.004e-02,3.043e-02,1.257e-02,5.471e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.662e-03 speed=1.703e-04GB/S T(nccl)=7.301e-06 speed=3.878e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=121 t=1.0e-02 per=1.9e+01 cost=4.9e+04 flops=4.9e+06
 sigma[gemm] counter=121 i=0 t=1.6e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=2 t=7.7e-03 per=1.4e+01 cost=1.4e+04 flops=1.8e+06
 sigma[gemm] counter=121 i=3 t=7.5e-03 per=1.4e+01 cost=1.5e+04 flops=1.9e+06
 sigma[gemm] counter=121 i=4 t=7.6e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=121 i=5 t=7.6e-03 per=1.4e+01 cost=2.7e+04 flops=3.6e+06
 sigma[gemm] counter=121 total t=3.0e-02 per=5.7e+01 cost=8.3e+04 flops=2.7e+06
 sigma[red] counter=121 t=1.3e-02 per=2.4e+01 cost=2.3e+04 flops=1.8e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=3.5e+00 t_reduction=1.4e+00 tot=6.1e+00 -----
 sigma_tot[inter] counter=121 t=1.1e+00 per=1.9e+01 cost=4.1e+06 flops=3.5e+06
 sigma_tot[gemm] counter=121 i=0 t=2.2e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=1 t=1.9e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=2 t=8.8e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=121 i=3 t=8.8e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=121 i=4 t=8.9e-01 per=1.5e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=121 i=5 t=8.8e-01 per=1.4e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=121 total t=3.5e+00 per=5.8e+01 cost=7.1e+06 flops=2.0e+06
 sigma_tot[red] counter=121 t=1.4e+00 per=2.4e+01 cost=1.9e+06 flops=1.3e+06
T(sub)=5.8e-05 T(gemm/eig/ortho/gemm/axpy)=8.1e-06,4.1e-05,6.1e-06,2.2e-06,4.3e-07
    4   0 +    -116.326036515321 -2.486e-06  6.400e-05    3     4  2.536e-01 6.341e-02 5.443e-02
TIMING FOR Davidson : 2.537e-01  T(cal/comm/rest)=2.177e-01,5.740e-07,3.594e-02
decomposed t_rest=3.594e-02
 T(sub)    =1.181e-04 per=3.285e-01
 T(precond)=3.569e-02 per=9.930e+01
 T(ortho)  =1.044e-05 per=2.904e-02
 T(xcopy)  =9.080e-07 per=2.526e-03
 T(xnrm2)  =2.159e-06 per=6.007e-03
 T(other)  =1.208e-04 per=3.360e-01
optimized energies: isweep=0 ibond=27 dots=1 e[0]=-116.326036515321 nmvp=4
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.518e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond27.txt
 qbond: qsuper nsym=8 dimAll=24
 (16,0):3 (16,-2):2 (17,-1):6 (18,0):4 (18,-2):3 (19,-1):1 (17,1):3 (17,-3):2
timing for divide=2.0e-05
timing for compute=1.9e-02
timing for collect=1.8e-05
----- TMING FOR decimation_genbasis(nkr): 1.9e-02 S T(divide/compute[cpu/gpu/rest]/collect)=2.0e-05,1.9e-02,0.0e+00,9.3e-06,1.8e-05 -----
decimation summary: 24->6 dwt=+1.110e-16 SvN=1.096e+00
 qbond: qkept nsym=3 dimAll=6
 (18,0):3 (18,-2):2 (19,-1):1
----- TIMING for decimation_row(nkr): 1.986e-02 S T(decim/select/formRot)=1.957e-02,2.653e-04,2.436e-05 -----
----- TIMING FOR onedot_decimation: 2.000e-02 S T(wf/decim)=1.089e-04,1.989e-02 -----
ctns::oper_renorm coord=(8,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1506:1.149e-02MB:1.122e-05GB
        per(mem): H:0.93 C:3.98 S:2.66 P:0 Q:92.4 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.545e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=297 : 3.024e-02 S -----
rank=0 GPUmem(GB): used=9.690e-05 (oper)=4.248e-05
rank=0 GPUmem(GB): used=9.704e-05 (oper,site)=4.248e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=297
 no. of rintermediate operators=664
 no. of coefficients=7304:5.573e-02MB:5.442e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.324e-03 S -----
rank=0 GPUmem(GB): used=1.515e-04 (oper,site,rinter)=4.248e-05,1.416e-07,5.442e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 7.666e-03 S size(rtasks)=297 size(Rlst2)=9 T(Rmu/Rlist)=4.826e-03,2.841e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.026e-03 S size(rtasks)=297 size(Rlst)=1452 -----
rank=0 GPUmem(GB): used=1.515e-04 avail=6.176e+00 total=6.176e+00 batch[need]=2.380e-04 blksize=9 blksize0=3 batchsize=1452
rank=0 GPUmem(GB): used=3.895e-04 (oper,site,rinter,batch)=4.248e-05,1.416e-07,5.442e-05,2.380e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.774e-03,2.234e-02,9.931e-03
----- TIMING FOR renorm : t_inter=6.8e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=28 t=6.8e-03 per=1.7e+01 cost=2.5e+04 flops=3.6e+06
 renorm[gemm] counter=28 i=0 t=1.6e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=1 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=2 t=7.5e-03 per=1.9e+01 cost=3.3e+03 flops=4.5e+05
 renorm[gemm] counter=28 i=3 t=7.5e-03 per=1.9e+01 cost=1.2e+04 flops=1.5e+06
 renorm[gemm] counter=28 i=4 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=5 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=6 t=7.4e-03 per=1.9e+01 cost=2.9e+04 flops=3.9e+06
 renorm[gemm] counter=28 total t=2.2e-02 per=5.7e+01 cost=4.4e+04 flops=2.0e+06
 renorm[red] counter=28 t=9.9e-03 per=2.5e+01 cost=1.6e+04 flops=1.6e+06
----- TIMING FOR renorm_tot : t_inter=1.6e-01 t_gemm=6.1e-01 t_reduction=2.8e-01 tot=1.1e+00 -----
 renorm_tot[inter] counter=28 t=1.6e-01 per=1.5e+01 cost=1.0e+06 flops=6.2e+06
 renorm_tot[gemm] counter=28 i=0 t=4.1e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=28 i=1 t=3.4e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=28 i=2 t=8.1e-02 per=7.7e+00 cost=2.0e+05 flops=2.5e+06
 renorm_tot[gemm] counter=28 i=3 t=8.3e-02 per=7.9e+00 cost=2.5e+05 flops=3.0e+06
 renorm_tot[gemm] counter=28 i=4 t=1.2e-01 per=1.2e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=28 i=5 t=1.2e-01 per=1.2e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=28 i=6 t=2.0e-01 per=1.9e+01 cost=2.8e+06 flops=1.4e+07
 renorm_tot[gemm] counter=28 total t=6.1e-01 per=5.8e+01 cost=3.7e+06 flops=6.1e+06
 renorm_tot[red] counter=28 t=2.8e-01 per=2.6e+01 cost=1.3e+06 flops=4.6e+06
qops.to_cpu: size(tot)=1506:1.1e-02MB:1.1e-05GB T(to_cpu)=3.2e-04S speed=3.5e-02GB/S
check ||H-H.dagger||=1.310e-15 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.0934 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=1.109e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=9.918e-04 change=-2.332e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=9.918e-04 change=-5.960e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 7.615e-01 S #####
 T(local opt: fetch) = 1.798e-02 S  per = 2.36  per(accum) = 2.36
 T(local opt: hdiag) = 3.296e-01 S  per = 43.3  per(accum) = 45.6
 T(local opt: dvdsn) = 2.981e-01 S  per = 39.1  per(accum) = 84.8
 T(local opt: decim) = 2.001e-02 S  per = 2.63  per(accum) = 87.4
 T(local opt: guess) = 1.010e-04 S  per = 0.0133  per(accum) = 87.4
 T(local opt: renrm) = 9.553e-02 S  per = 12.5  per(accum) = 100
 T(local opt: save ) = 2.408e-04 S  per = 0.0316  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.981e-01 S  T(sum) = 2.975e-01 S  per = 9.983e+01
 T(local opt: preprocess                  ) = 9.319e-05 S  per = 0.0313  per(accum) = 0.0313
 T(local opt: symbolic_formulae           ) = 2.117e-02 S  per = 7.11  per(accum) = 7.15
 T(local opt: hintermediate init          ) = 5.452e-04 S  per = 0.183  per(accum) = 7.33
 T(local opt: preprocess_hformulae_Hxlist ) = 7.114e-03 S  per = 2.39  per(accum) = 9.72
 T(local opt: hmmtasks init               ) = 1.497e-02 S  per = 5.03  per(accum) = 14.8
 T(local opt: initial guess for dvdson    ) = 2.499e-06 S  per = 0.00084  per(accum) = 14.8
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.119e-01 S  per = 71.2  per(accum) = 86
 T(local opt: dvdson [cpu-gpu]            ) = 5.780e-03 S  per = 1.94  per(accum) = 87.9
 T(local opt: dvdson [nccl]               ) = 2.678e-05 S  per = 0.009  per(accum) = 87.9
 T(local opt: dvdson [mpi]                ) = 5.740e-07 S  per = 0.000193  per(accum) = 87.9
 T(local opt: dvdson [rest part(linalg)]  ) = 3.594e-02 S  per = 12.1  per(accum) = 100
Detailed decomposition of T(renrm) = 9.553e-02 S  T(sum) = 9.553e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 8.836e-05 S  per = 0.0925  per(accum) = 0.0925
 T(local opt: qops init                    ) = 2.776e-03 S  per = 2.91  per(accum) = 3
 T(local opt: symbolic_formulae_renorm     ) = 3.026e-02 S  per = 31.7  per(accum) = 34.7
 T(local opt: allocate qops on gpu         ) = 6.620e-05 S  per = 0.0693  per(accum) = 34.7
 T(local opt: site memcpy cpu2gpu          ) = 1.886e-04 S  per = 0.197  per(accum) = 34.9
 T(local opt: rintermediate init           ) = 1.341e-03 S  per =  1.4  per(accum) = 36.3
 T(local opt: preprocess_formulae_Rlist2   ) = 8.090e-03 S  per = 8.47  per(accum) = 44.8
 T(local opt: rmmtasks init                ) = 1.107e-02 S  per = 11.6  per(accum) = 56.4
 T(local opt: qops memset on cpu           ) = 6.300e-08 S  per = 6.59e-05  per(accum) = 56.4
 T(local opt: preprocess_renorm_batchGPU   ) = 3.915e-02 S  per =   41  per(accum) = 97.4
 T(local opt: deallocate cpu and gpu memory) = 7.936e-05 S  per = 0.0831  per(accum) = 97.5
 T(local opt: construct opS [ifdists=true] ) = 3.900e-08 S  per = 4.08e-05  per(accum) = 97.5
 T(local opt: reduction of opS & opH [nccl]) = 4.500e-08 S  per = 4.71e-05  per(accum) = 97.5
 T(local opt: qops memcpy gpu2cpu          ) = 3.320e-04 S  per = 0.348  per(accum) = 97.8
 T(local opt: reduction of opS & opH [mpi] ) = 2.501e-05 S  per = 0.0262  per(accum) = 97.8
 T(local opt: qops_pool join and erase     ) = 2.066e-03 S  per = 2.16  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.716e-06 S  per = 0.0018  per(accum) = 100
##### sweep opt: 1.654e+01 S #####
 T(sweep opt: fetch) = 3.642e-01 S  per =  2.2  per(accum) = 2.2
 T(sweep opt: hdiag) = 5.629e+00 S  per =   34  per(accum) = 36.2
 T(sweep opt: dvdsn) = 8.139e+00 S  per = 49.2  per(accum) = 85.4
 T(sweep opt: decim) = 3.140e-01 S  per =  1.9  per(accum) = 87.3
 T(sweep opt: guess) = 2.352e-03 S  per = 0.0142  per(accum) = 87.3
 T(sweep opt: renrm) = 2.089e+00 S  per = 12.6  per(accum) = 100
 T(sweep opt: save ) = 6.745e-03 S  per = 0.0408  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.139e+00 S  T(sum) = 8.131e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 2.816e-03 S  per = 0.0346  per(accum) = 0.0346
 T(sweep opt: symbolic_formulae           ) = 3.708e-01 S  per = 4.56  per(accum) = 4.59
 T(sweep opt: hintermediate init          ) = 9.795e-03 S  per = 0.12  per(accum) = 4.72
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.194e-01 S  per = 1.47  per(accum) = 6.18
 T(sweep opt: hmmtasks init               ) = 2.255e-01 S  per = 2.77  per(accum) = 8.96
 T(sweep opt: initial guess for dvdson    ) = 9.284e-05 S  per = 0.00114  per(accum) = 8.96
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.140e+00 S  per = 75.5  per(accum) = 84.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.589e-01 S  per = 1.95  per(accum) = 86.4
 T(sweep opt: dvdson [nccl]               ) = 6.910e-04 S  per = 0.0085  per(accum) = 86.4
 T(sweep opt: dvdson [mpi]                ) = 1.567e-05 S  per = 0.000193  per(accum) = 86.4
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.103e+00 S  per = 13.6  per(accum) = 100
Detailed decomposition of T(renrm) = 2.089e+00 S  T(sum) = 2.089e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.551e-03 S  per = 0.17  per(accum) = 0.17
 T(sweep opt: qops init                    ) = 5.156e-02 S  per = 2.47  per(accum) = 2.64
 T(sweep opt: symbolic_formulae_renorm     ) = 3.987e-01 S  per = 19.1  per(accum) = 21.7
 T(sweep opt: allocate qops on gpu         ) = 1.673e-03 S  per = 0.0801  per(accum) = 21.8
 T(sweep opt: site memcpy cpu2gpu          ) = 3.701e-02 S  per = 1.77  per(accum) = 23.6
 T(sweep opt: rintermediate init           ) = 6.232e-02 S  per = 2.98  per(accum) = 26.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.253e-01 S  per =    6  per(accum) = 32.6
 T(sweep opt: rmmtasks init                ) = 2.414e-01 S  per = 11.6  per(accum) = 44.1
 T(sweep opt: qops memset on cpu           ) = 1.237e-06 S  per = 5.92e-05  per(accum) = 44.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.055e+00 S  per = 50.5  per(accum) = 94.6
 T(sweep opt: deallocate cpu and gpu memory) = 2.568e-03 S  per = 0.123  per(accum) = 94.8
 T(sweep opt: construct opS [ifdists=true] ) = 1.137e-06 S  per = 5.44e-05  per(accum) = 94.8
 T(sweep opt: reduction of opS & opH [nccl]) = 1.125e-06 S  per = 5.39e-05  per(accum) = 94.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.795e-03 S  per = 0.277  per(accum) = 95
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.292e-04 S  per = 0.0253  per(accum) = 95.1
 T(sweep opt: qops_pool join and erase     ) = 4.227e-02 S  per = 2.02  per(accum) = 97.1
 T(sweep opt: conversion from opAB to opPQ ) = 6.086e-02 S  per = 2.91  per(accum) = 100
##### global opt: 1.654e+01 S #####
 T(global opt: fetch) = 3.642e-01 S  per =  2.2  per(accum) = 2.2
 T(global opt: hdiag) = 5.629e+00 S  per =   34  per(accum) = 36.2
 T(global opt: dvdsn) = 8.139e+00 S  per = 49.2  per(accum) = 85.4
 T(global opt: decim) = 3.140e-01 S  per =  1.9  per(accum) = 87.3
 T(global opt: guess) = 2.352e-03 S  per = 0.0142  per(accum) = 87.3
 T(global opt: renrm) = 2.089e+00 S  per = 12.6  per(accum) = 100
 T(global opt: save ) = 6.745e-03 S  per = 0.0408  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.139e+00 S  T(sum) = 8.131e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 2.816e-03 S  per = 0.0346  per(accum) = 0.0346
 T(global opt: symbolic_formulae           ) = 3.708e-01 S  per = 4.56  per(accum) = 4.59
 T(global opt: hintermediate init          ) = 9.795e-03 S  per = 0.12  per(accum) = 4.72
 T(global opt: preprocess_hformulae_Hxlist ) = 1.194e-01 S  per = 1.47  per(accum) = 6.18
 T(global opt: hmmtasks init               ) = 2.255e-01 S  per = 2.77  per(accum) = 8.96
 T(global opt: initial guess for dvdson    ) = 9.284e-05 S  per = 0.00114  per(accum) = 8.96
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.140e+00 S  per = 75.5  per(accum) = 84.5
 T(global opt: dvdson [cpu-gpu]            ) = 1.589e-01 S  per = 1.95  per(accum) = 86.4
 T(global opt: dvdson [nccl]               ) = 6.910e-04 S  per = 0.0085  per(accum) = 86.4
 T(global opt: dvdson [mpi]                ) = 1.567e-05 S  per = 0.000193  per(accum) = 86.4
 T(global opt: dvdson [rest part(linalg)]  ) = 1.103e+00 S  per = 13.6  per(accum) = 100
Detailed decomposition of T(renrm) = 2.089e+00 S  T(sum) = 2.089e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.551e-03 S  per = 0.17  per(accum) = 0.17
 T(global opt: qops init                    ) = 5.156e-02 S  per = 2.47  per(accum) = 2.64
 T(global opt: symbolic_formulae_renorm     ) = 3.987e-01 S  per = 19.1  per(accum) = 21.7
 T(global opt: allocate qops on gpu         ) = 1.673e-03 S  per = 0.0801  per(accum) = 21.8
 T(global opt: site memcpy cpu2gpu          ) = 3.701e-02 S  per = 1.77  per(accum) = 23.6
 T(global opt: rintermediate init           ) = 6.232e-02 S  per = 2.98  per(accum) = 26.6
 T(global opt: preprocess_formulae_Rlist2   ) = 1.253e-01 S  per =    6  per(accum) = 32.6
 T(global opt: rmmtasks init                ) = 2.414e-01 S  per = 11.6  per(accum) = 44.1
 T(global opt: qops memset on cpu           ) = 1.237e-06 S  per = 5.92e-05  per(accum) = 44.1
 T(global opt: preprocess_renorm_batchGPU   ) = 1.055e+00 S  per = 50.5  per(accum) = 94.6
 T(global opt: deallocate cpu and gpu memory) = 2.568e-03 S  per = 0.123  per(accum) = 94.8
 T(global opt: construct opS [ifdists=true] ) = 1.137e-06 S  per = 5.44e-05  per(accum) = 94.8
 T(global opt: reduction of opS & opH [nccl]) = 1.125e-06 S  per = 5.39e-05  per(accum) = 94.8
 T(global opt: qops memcpy gpu2cpu          ) = 5.795e-03 S  per = 0.277  per(accum) = 95
 T(global opt: reduction of opS & opH [mpi] ) = 5.292e-04 S  per = 0.0253  per(accum) = 95.1
 T(global opt: qops_pool join and erase     ) = 4.227e-02 S  per = 2.02  per(accum) = 97.1
 T(global opt: conversion from opAB to opPQ ) = 6.086e-02 S  per = 2.91  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.518e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=28/seqsize=34 dots=1 dbond=(6,0)-(7,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=19:1.450e-04MB:1.416e-07GB
total mem of comb=1213:9.254e-03MB:9.038e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=7,12,1
 suppl= 0 1 2 3 4 16 17
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 18
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:14 S:26 A:91 B:105 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1192:9.094e-03MB:8.881e-06GB
        per(mem): H:1.17 C:2.94 S:5.45 A:0 B:90.4 
 rqops: oplist=HCSPQ nops=H:1 C:24 S:16 P:120 Q:136 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1506:0.0115MB:1.12e-05GB
        per(mem): H:0.93 C:3.98 S:2.66 P:0 Q:92.4 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=5034:0.0384MB:3.75e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.009e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(7,0) fdel=./scratch/sweep/lop(6,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-9.179e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(6,6,4) nnz=19:1.450e-04MB
qtensor3: wf3 own=1 _data=0x3c830aa0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=6
 (10,0):3 (10,2):2 (9,1):1
 qbond: qcol nsym=3 dimAll=6
 (18,0):3 (18,-2):2 (19,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=36 size=19:1.450e-04MB
### DIAG TIMING: total=2.907e-01 t1=2.641e-05, t2=2.136e-03, t3=2.506e-03, t4=2.860e-01, t5=4.936e-06, t6=1.325e-05, t7=4.022e-06
duration_diagGPU:2.907e-01
duration_diagreduce:9.000e-08
duration_diagtransform:4.240e-07
----- TIMING FOR symbolic_formulae_onedot with size=1053 : 1.777e-02 S -----
rank=0 GPUmem(GB): used=3.751e-05 (oper)=3.751e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=1053
 no. of hintermediate operators=518
 no. of coefficients=6216:4.742e-02MB:4.631e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.252e-04 S -----
rank=0 GPUmem(GB): used=8.382e-05 (oper,hinter)=3.751e-05,4.631e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.366e-03 S size(H_formulae)=1053 size(Hxlst2)=5 T(Hmu/Hxlist)=2.649e-03,2.717e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.695e-03 S size(H_formulae)=1053 size(Hxlst)=2250 -----
rank=0 GPUmem(GB): used=8.382e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.831e-07 batch[need]=3.688e-04 blksize=9 blksize0=3 batchsize=2250
rank=0 GPUmem(GB): used=4.529e-04 (oper,hinter,dvdson,batch)=3.751e-05,4.631e-05,2.831e-07,3.688e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=19 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.128e-03,1.015e-02,3.034e-02,1.251e-02,5.415e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.123e-03 speed=2.520e-04GB/S T(nccl)=4.769e-06 speed=5.937e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=122 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.1e+06
 sigma[gemm] counter=122 i=0 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=1 t=1.1e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=2 t=7.6e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=122 i=3 t=7.7e-03 per=1.4e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=122 i=4 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=122 i=5 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=122 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=122 t=1.3e-02 per=2.4e+01 cost=1.8e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.6e+00 t_reduction=1.5e+00 tot=6.2e+00 -----
 sigma_tot[inter] counter=122 t=1.2e+00 per=1.9e+01 cost=4.1e+06 flops=3.5e+06
 sigma_tot[gemm] counter=122 i=0 t=2.2e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=1 t=1.9e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=2 t=8.9e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=122 i=3 t=8.9e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=122 i=4 t=9.0e-01 per=1.5e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=122 i=5 t=8.9e-01 per=1.4e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=122 total t=3.6e+00 per=5.8e+01 cost=7.2e+06 flops=2.0e+06
 sigma_tot[red] counter=122 t=1.5e+00 per=2.4e+01 cost=1.9e+06 flops=1.3e+06
T(sub)=9.2e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.1e-06,1.8e-06,7.0e-07,1.5e-07
settings: ndim=19 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.326036515321 -1.116e+03  2.733e-02    1     1  5.426e-02 5.426e-02 5.423e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.469e-03,1.014e-02,3.031e-02,1.273e-02,5.465e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.464e-03 speed=1.934e-04GB/S T(nccl)=4.799e-06 speed=5.900e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=123 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.1e+06
 sigma[gemm] counter=123 i=0 t=1.7e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=1 t=1.5e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=2 t=7.6e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=123 i=3 t=7.6e-03 per=1.4e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=123 i=4 t=7.6e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=123 i=5 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=123 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=123 t=1.3e-02 per=2.4e+01 cost=1.8e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.6e+00 t_reduction=1.5e+00 tot=6.2e+00 -----
 sigma_tot[inter] counter=123 t=1.2e+00 per=1.9e+01 cost=4.2e+06 flops=3.6e+06
 sigma_tot[gemm] counter=123 i=0 t=2.2e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=1 t=1.9e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=2 t=9.0e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=123 i=3 t=9.0e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=123 i=4 t=9.0e-01 per=1.5e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=123 i=5 t=8.9e-01 per=1.4e+01 cost=1.7e+06 flops=1.9e+06
 sigma_tot[gemm] counter=123 total t=3.6e+00 per=5.8e+01 cost=7.3e+06 flops=2.0e+06
 sigma_tot[red] counter=123 t=1.5e+00 per=2.4e+01 cost=1.9e+06 flops=1.3e+06
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.0e-05,3.3e-06,8.1e-07,1.8e-07
    2   0 -    -116.328001626551 -1.965e-03  7.022e-03    2     2  1.184e-01 5.920e-02 5.448e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.454e-03,9.920e-03,2.004e-02,3.332e-03,3.476e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=1.449e-03 speed=1.954e-04GB/S T(nccl)=5.205e-06 speed=5.439e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=2.0e-02 t_reduction=3.3e-03 tot=3.3e-02 -----
 sigma[inter] counter=124 t=9.9e-03 per=3.0e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=124 i=0 t=1.5e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=1 t=8.3e-06 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=2 t=7.5e-03 per=2.3e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=124 i=3 t=7.6e-03 per=2.3e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=124 i=4 t=3.8e-03 per=1.1e+01 cost=2.1e+04 flops=5.6e+06
 sigma[gemm] counter=124 i=5 t=1.1e-03 per=3.4e+00 cost=2.1e+04 flops=1.9e+07
 sigma[gemm] counter=124 total t=2.0e-02 per=6.0e+01 cost=6.5e+04 flops=3.3e+06
 sigma[red] counter=124 t=3.3e-03 per=1.0e+01 cost=1.8e+04 flops=5.4e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.6e+00 t_reduction=1.5e+00 tot=6.3e+00 -----
 sigma_tot[inter] counter=124 t=1.2e+00 per=1.9e+01 cost=4.2e+06 flops=3.6e+06
 sigma_tot[gemm] counter=124 i=0 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=1 t=2.0e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=2 t=9.0e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=124 i=3 t=9.1e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=124 i=4 t=9.1e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=124 i=5 t=8.9e-01 per=1.4e+01 cost=1.8e+06 flops=2.0e+06
 sigma_tot[gemm] counter=124 total t=3.6e+00 per=5.8e+01 cost=7.3e+06 flops=2.0e+06
 sigma_tot[red] counter=124 t=1.5e+00 per=2.4e+01 cost=1.9e+06 flops=1.3e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,3.0e-06,9.4e-07,1.6e-07
    3   0 -    -116.328195629028 -1.940e-04  9.900e-04    3     3  1.626e-01 5.419e-02 4.794e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.997e-04,1.001e-02,2.988e-02,1.239e-02,5.258e-02
 analyze_tgpu[Hx]: ndim=19:1.416e-07GB T(cpu-gpu)=2.947e-04 speed=9.608e-04GB/S T(nccl)=5.081e-06 speed=5.572e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=125 t=1.0e-02 per=1.9e+01 cost=4.2e+04 flops=4.2e+06
 sigma[gemm] counter=125 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=2 t=7.5e-03 per=1.4e+01 cost=1.1e+04 flops=1.5e+06
 sigma[gemm] counter=125 i=3 t=7.5e-03 per=1.4e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=125 i=4 t=7.5e-03 per=1.4e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=125 i=5 t=7.4e-03 per=1.4e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=125 total t=3.0e-02 per=5.7e+01 cost=6.5e+04 flops=2.2e+06
 sigma[red] counter=125 t=1.2e-02 per=2.4e+01 cost=1.8e+04 flops=1.5e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.6e+00 t_reduction=1.5e+00 tot=6.3e+00 -----
 sigma_tot[inter] counter=125 t=1.2e+00 per=1.9e+01 cost=4.2e+06 flops=3.6e+06
 sigma_tot[gemm] counter=125 i=0 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=1 t=2.0e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=2 t=9.1e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=125 i=3 t=9.1e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=125 i=4 t=9.2e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=125 i=5 t=9.0e-01 per=1.4e+01 cost=1.8e+06 flops=2.0e+06
 sigma_tot[gemm] counter=125 total t=3.6e+00 per=5.8e+01 cost=7.4e+06 flops=2.0e+06
 sigma_tot[red] counter=125 t=1.5e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.3e-05,2.8e-06,9.5e-07,1.8e-07
    4   0 +    -116.328199520972 -3.892e-06  6.006e-05    3     4  2.287e-01 5.718e-02 4.912e-02
TIMING FOR Davidson : 2.287e-01  T(cal/comm/rest)=1.965e-01,3.440e-07,3.223e-02
decomposed t_rest=3.223e-02
 T(sub)    =7.074e-05 per=2.195e-01
 T(precond)=3.205e-02 per=9.943e+01
 T(ortho)  =1.059e-05 per=3.285e-02
 T(xcopy)  =7.020e-07 per=2.178e-03
 T(xnrm2)  =1.598e-06 per=4.958e-03
 T(other)  =1.015e-04 per=3.150e-01
optimized energies: isweep=0 ibond=28 dots=1 e[0]=-116.328199520972 nmvp=4
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.252e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond28.txt
 qbond: qsuper nsym=8 dimAll=24
 (18,0):3 (18,-2):2 (19,-1):6 (20,0):4 (20,-2):3 (21,-1):1 (19,1):3 (19,-3):2
timing for divide=8.8e-06
timing for compute=9.2e-03
timing for collect=6.8e-05
----- TMING FOR decimation_genbasis(nkr): 9.3e-03 S T(divide/compute[cpu/gpu/rest]/collect)=8.8e-06,9.2e-03,0.0e+00,5.1e-06,6.8e-05 -----
decimation summary: 24->6 dwt=+2.220e-16 SvN=1.154e+00
 qbond: qkept nsym=3 dimAll=6
 (20,0):3 (20,-2):2 (21,-1):1
----- TIMING for decimation_row(nkr): 9.871e-03 S T(decim/select/formRot)=9.356e-03,4.600e-04,5.585e-05 -----
----- TIMING FOR onedot_decimation: 9.974e-03 S T(wf/decim)=4.865e-05,9.925e-03 -----
ctns::oper_renorm coord=(7,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=1192:9.094e-03MB:8.881e-06GB
        per(mem): H:1.17 C:5.45 S:2.94 P:0 Q:90.4 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.233e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=237 : 1.844e-02 S -----
rank=0 GPUmem(GB): used=8.382e-05 (oper)=3.751e-05
rank=0 GPUmem(GB): used=8.396e-05 (oper,site)=3.751e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=237
 no. of rintermediate operators=518
 no. of coefficients=6216:4.742e-02MB:4.631e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.455e-03 S -----
rank=0 GPUmem(GB): used=1.303e-04 (oper,site,rinter)=3.751e-05,1.416e-07,4.631e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 4.704e-03 S size(rtasks)=237 size(Rlst2)=9 T(Rmu/Rlist)=2.917e-03,1.787e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.951e-03 S size(rtasks)=237 size(Rlst)=1164 -----
rank=0 GPUmem(GB): used=1.303e-04 avail=6.176e+00 total=6.176e+00 batch[need]=1.908e-04 blksize=9 blksize0=3 batchsize=1164
rank=0 GPUmem(GB): used=3.211e-04 (oper,site,rinter,batch)=3.751e-05,1.416e-07,4.631e-05,1.908e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.207e-03,2.264e-02,1.004e-02
----- TIMING FOR renorm : t_inter=7.2e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=29 t=7.2e-03 per=1.8e+01 cost=2.1e+04 flops=2.9e+06
 renorm[gemm] counter=29 i=0 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=1 t=9.4e-07 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=2 t=7.5e-03 per=1.9e+01 cost=2.8e+03 flops=3.7e+05
 renorm[gemm] counter=29 i=3 t=7.6e-03 per=1.9e+01 cost=9.2e+03 flops=1.2e+06
 renorm[gemm] counter=29 i=4 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=5 t=9.9e-07 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=6 t=7.5e-03 per=1.9e+01 cost=2.3e+04 flops=3.1e+06
 renorm[gemm] counter=29 total t=2.3e-02 per=5.7e+01 cost=3.5e+04 flops=1.6e+06
 renorm[red] counter=29 t=1.0e-02 per=2.5e+01 cost=1.3e+04 flops=1.3e+06
----- TIMING FOR renorm_tot : t_inter=1.7e-01 t_gemm=6.3e-01 t_reduction=2.9e-01 tot=1.1e+00 -----
 renorm_tot[inter] counter=29 t=1.7e-01 per=1.6e+01 cost=1.0e+06 flops=6.1e+06
 renorm_tot[gemm] counter=29 i=0 t=4.2e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=29 i=1 t=3.5e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=29 i=2 t=8.9e-02 per=8.1e+00 cost=2.0e+05 flops=2.3e+06
 renorm_tot[gemm] counter=29 i=3 t=9.0e-02 per=8.3e+00 cost=2.6e+05 flops=2.9e+06
 renorm_tot[gemm] counter=29 i=4 t=1.2e-01 per=1.1e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=29 i=5 t=1.2e-01 per=1.1e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=29 i=6 t=2.1e-01 per=1.9e+01 cost=2.8e+06 flops=1.3e+07
 renorm_tot[gemm] counter=29 total t=6.3e-01 per=5.8e+01 cost=3.8e+06 flops=5.9e+06
 renorm_tot[red] counter=29 t=2.9e-01 per=2.6e+01 cost=1.3e+06 flops=4.5e+06
qops.to_cpu: size(tot)=1192:9.1e-03MB:8.9e-06GB T(to_cpu)=2.5e-04S speed=3.6e-02GB/S
check ||H-H.dagger||=1.031e-15 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.077 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=8.989e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=6.638e-04 change=-2.054e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=6.638e-04 change=-5.960e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 6.583e-01 S #####
 T(local opt: fetch) = 1.306e-02 S  per = 1.98  per(accum) = 1.98
 T(local opt: hdiag) = 2.907e-01 S  per = 44.2  per(accum) = 46.1
 T(local opt: dvdsn) = 2.642e-01 S  per = 40.1  per(accum) = 86.3
 T(local opt: decim) = 9.995e-03 S  per = 1.52  per(accum) = 87.8
 T(local opt: guess) = 2.610e-04 S  per = 0.0396  per(accum) = 87.8
 T(local opt: renrm) = 7.970e-02 S  per = 12.1  per(accum) = 100
 T(local opt: save ) = 2.751e-04 S  per = 0.0418  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.642e-01 S  T(sum) = 2.640e-01 S  per = 9.992e+01
 T(local opt: preprocess                  ) = 9.414e-05 S  per = 0.0357  per(accum) = 0.0357
 T(local opt: symbolic_formulae           ) = 1.778e-02 S  per = 6.73  per(accum) = 6.77
 T(local opt: hintermediate init          ) = 4.422e-04 S  per = 0.167  per(accum) = 6.94
 T(local opt: preprocess_hformulae_Hxlist ) = 5.760e-03 S  per = 2.18  per(accum) = 9.12
 T(local opt: hmmtasks init               ) = 1.124e-02 S  per = 4.26  per(accum) = 13.4
 T(local opt: initial guess for dvdson    ) = 2.600e-06 S  per = 0.000985  per(accum) = 13.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.921e-01 S  per = 72.8  per(accum) = 86.1
 T(local opt: dvdson [cpu-gpu]            ) = 4.330e-03 S  per = 1.64  per(accum) = 87.8
 T(local opt: dvdson [nccl]               ) = 1.985e-05 S  per = 0.00752  per(accum) = 87.8
 T(local opt: dvdson [mpi]                ) = 3.440e-07 S  per = 0.00013  per(accum) = 87.8
 T(local opt: dvdson [rest part(linalg)]  ) = 3.223e-02 S  per = 12.2  per(accum) = 100
Detailed decomposition of T(renrm) = 7.970e-02 S  T(sum) = 7.970e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.095e-04 S  per = 0.263  per(accum) = 0.263
 T(local opt: qops init                    ) = 2.378e-03 S  per = 2.98  per(accum) = 3.25
 T(local opt: symbolic_formulae_renorm     ) = 1.845e-02 S  per = 23.2  per(accum) = 26.4
 T(local opt: allocate qops on gpu         ) = 8.702e-05 S  per = 0.109  per(accum) = 26.5
 T(local opt: site memcpy cpu2gpu          ) = 2.211e-03 S  per = 2.77  per(accum) = 29.3
 T(local opt: rintermediate init           ) = 2.468e-03 S  per =  3.1  per(accum) = 32.4
 T(local opt: preprocess_formulae_Rlist2   ) = 4.988e-03 S  per = 6.26  per(accum) = 38.6
 T(local opt: rmmtasks init                ) = 6.123e-03 S  per = 7.68  per(accum) = 46.3
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 4.27e-05  per(accum) = 46.3
 T(local opt: preprocess_renorm_batchGPU   ) = 3.998e-02 S  per = 50.2  per(accum) = 96.5
 T(local opt: deallocate cpu and gpu memory) = 6.596e-05 S  per = 0.0828  per(accum) = 96.6
 T(local opt: construct opS [ifdists=true] ) = 4.200e-08 S  per = 5.27e-05  per(accum) = 96.6
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 4.77e-05  per(accum) = 96.6
 T(local opt: qops memcpy gpu2cpu          ) = 2.544e-04 S  per = 0.319  per(accum) = 96.9
 T(local opt: reduction of opS & opH [mpi] ) = 1.807e-05 S  per = 0.0227  per(accum) = 96.9
 T(local opt: qops_pool join and erase     ) = 2.467e-03 S  per =  3.1  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.975e-06 S  per = 0.00248  per(accum) = 100
##### sweep opt: 1.720e+01 S #####
 T(sweep opt: fetch) = 3.773e-01 S  per = 2.19  per(accum) = 2.19
 T(sweep opt: hdiag) = 5.919e+00 S  per = 34.4  per(accum) = 36.6
 T(sweep opt: dvdsn) = 8.403e+00 S  per = 48.8  per(accum) = 85.5
 T(sweep opt: decim) = 3.240e-01 S  per = 1.88  per(accum) = 87.3
 T(sweep opt: guess) = 2.612e-03 S  per = 0.0152  per(accum) = 87.4
 T(sweep opt: renrm) = 2.169e+00 S  per = 12.6  per(accum) = 100
 T(sweep opt: save ) = 7.020e-03 S  per = 0.0408  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.403e+00 S  T(sum) = 8.395e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 2.911e-03 S  per = 0.0347  per(accum) = 0.0347
 T(sweep opt: symbolic_formulae           ) = 3.886e-01 S  per = 4.63  per(accum) = 4.66
 T(sweep opt: hintermediate init          ) = 1.024e-02 S  per = 0.122  per(accum) = 4.79
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.252e-01 S  per = 1.49  per(accum) = 6.28
 T(sweep opt: hmmtasks init               ) = 2.367e-01 S  per = 2.82  per(accum) = 9.1
 T(sweep opt: initial guess for dvdson    ) = 9.544e-05 S  per = 0.00114  per(accum) = 9.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.332e+00 S  per = 75.4  per(accum) = 84.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.632e-01 S  per = 1.94  per(accum) = 86.5
 T(sweep opt: dvdson [nccl]               ) = 7.109e-04 S  per = 0.00847  per(accum) = 86.5
 T(sweep opt: dvdson [mpi]                ) = 1.601e-05 S  per = 0.000191  per(accum) = 86.5
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.135e+00 S  per = 13.5  per(accum) = 100
Detailed decomposition of T(renrm) = 2.169e+00 S  T(sum) = 2.169e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.760e-03 S  per = 0.173  per(accum) = 0.173
 T(sweep opt: qops init                    ) = 5.394e-02 S  per = 2.49  per(accum) = 2.66
 T(sweep opt: symbolic_formulae_renorm     ) = 4.172e-01 S  per = 19.2  per(accum) = 21.9
 T(sweep opt: allocate qops on gpu         ) = 1.760e-03 S  per = 0.0812  per(accum) = 22
 T(sweep opt: site memcpy cpu2gpu          ) = 3.922e-02 S  per = 1.81  per(accum) = 23.8
 T(sweep opt: rintermediate init           ) = 6.479e-02 S  per = 2.99  per(accum) = 26.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.303e-01 S  per = 6.01  per(accum) = 32.8
 T(sweep opt: rmmtasks init                ) = 2.475e-01 S  per = 11.4  per(accum) = 44.2
 T(sweep opt: qops memset on cpu           ) = 1.271e-06 S  per = 5.86e-05  per(accum) = 44.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.095e+00 S  per = 50.5  per(accum) = 94.7
 T(sweep opt: deallocate cpu and gpu memory) = 2.634e-03 S  per = 0.121  per(accum) = 94.8
 T(sweep opt: construct opS [ifdists=true] ) = 1.179e-06 S  per = 5.44e-05  per(accum) = 94.8
 T(sweep opt: reduction of opS & opH [nccl]) = 1.163e-06 S  per = 5.36e-05  per(accum) = 94.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.049e-03 S  per = 0.279  per(accum) = 95.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.472e-04 S  per = 0.0252  per(accum) = 95.1
 T(sweep opt: qops_pool join and erase     ) = 4.474e-02 S  per = 2.06  per(accum) = 97.2
 T(sweep opt: conversion from opAB to opPQ ) = 6.086e-02 S  per = 2.81  per(accum) = 100
##### global opt: 1.720e+01 S #####
 T(global opt: fetch) = 3.773e-01 S  per = 2.19  per(accum) = 2.19
 T(global opt: hdiag) = 5.919e+00 S  per = 34.4  per(accum) = 36.6
 T(global opt: dvdsn) = 8.403e+00 S  per = 48.8  per(accum) = 85.5
 T(global opt: decim) = 3.240e-01 S  per = 1.88  per(accum) = 87.3
 T(global opt: guess) = 2.612e-03 S  per = 0.0152  per(accum) = 87.4
 T(global opt: renrm) = 2.169e+00 S  per = 12.6  per(accum) = 100
 T(global opt: save ) = 7.020e-03 S  per = 0.0408  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.403e+00 S  T(sum) = 8.395e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 2.911e-03 S  per = 0.0347  per(accum) = 0.0347
 T(global opt: symbolic_formulae           ) = 3.886e-01 S  per = 4.63  per(accum) = 4.66
 T(global opt: hintermediate init          ) = 1.024e-02 S  per = 0.122  per(accum) = 4.79
 T(global opt: preprocess_hformulae_Hxlist ) = 1.252e-01 S  per = 1.49  per(accum) = 6.28
 T(global opt: hmmtasks init               ) = 2.367e-01 S  per = 2.82  per(accum) = 9.1
 T(global opt: initial guess for dvdson    ) = 9.544e-05 S  per = 0.00114  per(accum) = 9.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.332e+00 S  per = 75.4  per(accum) = 84.5
 T(global opt: dvdson [cpu-gpu]            ) = 1.632e-01 S  per = 1.94  per(accum) = 86.5
 T(global opt: dvdson [nccl]               ) = 7.109e-04 S  per = 0.00847  per(accum) = 86.5
 T(global opt: dvdson [mpi]                ) = 1.601e-05 S  per = 0.000191  per(accum) = 86.5
 T(global opt: dvdson [rest part(linalg)]  ) = 1.135e+00 S  per = 13.5  per(accum) = 100
Detailed decomposition of T(renrm) = 2.169e+00 S  T(sum) = 2.169e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.760e-03 S  per = 0.173  per(accum) = 0.173
 T(global opt: qops init                    ) = 5.394e-02 S  per = 2.49  per(accum) = 2.66
 T(global opt: symbolic_formulae_renorm     ) = 4.172e-01 S  per = 19.2  per(accum) = 21.9
 T(global opt: allocate qops on gpu         ) = 1.760e-03 S  per = 0.0812  per(accum) = 22
 T(global opt: site memcpy cpu2gpu          ) = 3.922e-02 S  per = 1.81  per(accum) = 23.8
 T(global opt: rintermediate init           ) = 6.479e-02 S  per = 2.99  per(accum) = 26.8
 T(global opt: preprocess_formulae_Rlist2   ) = 1.303e-01 S  per = 6.01  per(accum) = 32.8
 T(global opt: rmmtasks init                ) = 2.475e-01 S  per = 11.4  per(accum) = 44.2
 T(global opt: qops memset on cpu           ) = 1.271e-06 S  per = 5.86e-05  per(accum) = 44.2
 T(global opt: preprocess_renorm_batchGPU   ) = 1.095e+00 S  per = 50.5  per(accum) = 94.7
 T(global opt: deallocate cpu and gpu memory) = 2.634e-03 S  per = 0.121  per(accum) = 94.8
 T(global opt: construct opS [ifdists=true] ) = 1.179e-06 S  per = 5.44e-05  per(accum) = 94.8
 T(global opt: reduction of opS & opH [nccl]) = 1.163e-06 S  per = 5.36e-05  per(accum) = 94.8
 T(global opt: qops memcpy gpu2cpu          ) = 6.049e-03 S  per = 0.279  per(accum) = 95.1
 T(global opt: reduction of opS & opH [mpi] ) = 5.472e-04 S  per = 0.0252  per(accum) = 95.1
 T(global opt: qops_pool join and erase     ) = 4.474e-02 S  per = 2.06  per(accum) = 97.2
 T(global opt: conversion from opAB to opPQ ) = 6.086e-02 S  per = 2.81  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.253e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=29/seqsize=34 dots=1 dbond=(5,0)-(6,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=1217:9.285e-03MB:9.067e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=6,13,1
 suppl= 0 1 2 3 4 16
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 17
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:12 S:28 A:66 B:78 
        dim(bra,ket)=5,5 size(op)=11:8.392e-05MB size(tot)=661:5.043e-03MB:4.925e-06GB
        per(mem): H:1.66 C:3.63 S:8.47 A:0 B:86.2 
 rqops: oplist=HCSPQ nops=H:1 C:26 S:14 P:91 Q:105 
        dim(bra,ket)=6,6 size(op)=14:0.000107MB size(tot)=1192:0.00909MB:8.88e-06GB
        per(mem): H:1.17 C:5.45 S:2.94 P:0 Q:90.4 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=4189:0.032MB:3.12e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.789e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(6,0) fdel=./scratch/sweep/lop(5,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-5.364e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(5,6,4) nnz=23:1.755e-04MB
qtensor3: wf3 own=1 _data=0x467032c0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=5
 (9,1):3 (8,2):1 (9,3):1
 qbond: qcol nsym=3 dimAll=6
 (20,0):3 (20,-2):2 (21,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=6 nblocks=36 size=23:1.755e-04MB
### DIAG TIMING: total=2.219e-01 t1=2.540e-05, t2=2.238e-03, t3=2.525e-03, t4=2.171e-01, t5=5.995e-06, t6=1.868e-05, t7=4.059e-06
duration_diagGPU:2.219e-01
duration_diagreduce:1.020e-07
duration_diagtransform:5.950e-07
----- TIMING FOR symbolic_formulae_onedot with size=813 : 1.452e-02 S -----
rank=0 GPUmem(GB): used=3.121e-05 (oper)=3.121e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=813
 no. of hintermediate operators=390
 no. of coefficients=5070:3.868e-02MB:3.777e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.890e-04 S -----
rank=0 GPUmem(GB): used=6.898e-05 (oper,hinter)=3.121e-05,3.777e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.698e-03 S size(H_formulae)=813 size(Hxlst2)=6 T(Hmu/Hxlist)=2.064e-03,2.633e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.040e-03 S size(H_formulae)=813 size(Hxlst)=1990 -----
rank=0 GPUmem(GB): used=6.898e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=3.427e-07 batch[need]=3.262e-04 blksize=9 blksize0=3 batchsize=1990
rank=0 GPUmem(GB): used=3.955e-04 (oper,hinter,dvdson,batch)=3.121e-05,3.777e-05,3.427e-07,3.262e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=23 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.182e-03,1.019e-02,3.003e-02,1.271e-02,5.512e-02
 analyze_tgpu[Hx]: ndim=23:1.714e-07GB T(cpu-gpu)=2.176e-03 speed=1.575e-04GB/S T(nccl)=5.658e-06 speed=6.057e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=126 t=1.0e-02 per=1.9e+01 cost=3.7e+04 flops=3.6e+06
 sigma[gemm] counter=126 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=1 t=1.0e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=2 t=7.5e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=126 i=3 t=7.5e-03 per=1.4e+01 cost=9.7e+03 flops=1.3e+06
 sigma[gemm] counter=126 i=4 t=7.5e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=126 i=5 t=7.5e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=126 total t=3.0e-02 per=5.7e+01 cost=5.4e+04 flops=1.8e+06
 sigma[red] counter=126 t=1.3e-02 per=2.4e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.7e+00 t_reduction=1.5e+00 tot=6.4e+00 -----
 sigma_tot[inter] counter=126 t=1.2e+00 per=1.9e+01 cost=4.3e+06 flops=3.6e+06
 sigma_tot[gemm] counter=126 i=0 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=1 t=2.0e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=2 t=9.2e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=126 i=3 t=9.2e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=126 i=4 t=9.2e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=126 i=5 t=9.1e-01 per=1.4e+01 cost=1.8e+06 flops=2.0e+06
 sigma_tot[gemm] counter=126 total t=3.7e+00 per=5.8e+01 cost=7.5e+06 flops=2.0e+06
 sigma_tot[red] counter=126 t=1.5e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,4.7e-06,2.2e-06,8.3e-07,1.5e-07
settings: ndim=23 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.328199520972 -1.116e+03  3.996e-03    1     1  5.523e-02 5.523e-02 5.521e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.012e-04,1.021e-02,3.022e-02,1.245e-02,5.330e-02
 analyze_tgpu[Hx]: ndim=23:1.714e-07GB T(cpu-gpu)=3.951e-04 speed=8.674e-04GB/S T(nccl)=6.117e-06 speed=5.603e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=127 t=1.0e-02 per=1.9e+01 cost=3.7e+04 flops=3.6e+06
 sigma[gemm] counter=127 i=0 t=1.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=2 t=7.5e-03 per=1.4e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=127 i=3 t=7.6e-03 per=1.4e+01 cost=9.7e+03 flops=1.3e+06
 sigma[gemm] counter=127 i=4 t=7.6e-03 per=1.4e+01 cost=1.7e+04 flops=2.2e+06
 sigma[gemm] counter=127 i=5 t=7.5e-03 per=1.4e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=127 total t=3.0e-02 per=5.7e+01 cost=5.4e+04 flops=1.8e+06
 sigma[red] counter=127 t=1.2e-02 per=2.4e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.7e+00 t_reduction=1.5e+00 tot=6.4e+00 -----
 sigma_tot[inter] counter=127 t=1.2e+00 per=1.9e+01 cost=4.3e+06 flops=3.6e+06
 sigma_tot[gemm] counter=127 i=0 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=1 t=2.0e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=2 t=9.3e-01 per=1.4e+01 cost=1.9e+06 flops=2.1e+06
 sigma_tot[gemm] counter=127 i=3 t=9.3e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=127 i=4 t=9.3e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=127 i=5 t=9.2e-01 per=1.4e+01 cost=1.8e+06 flops=2.0e+06
 sigma_tot[gemm] counter=127 total t=3.7e+00 per=5.8e+01 cost=7.5e+06 flops=2.0e+06
 sigma_tot[red] counter=127 t=1.5e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.2e-05,3.5e-06,1.0e-06,2.0e-07
    2   0 -    -116.328223639321 -2.412e-05  3.577e-04    2     2  1.211e-01 6.056e-02 5.430e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.321e-03,3.054e-03,5.179e-03,2.258e-03,1.283e-02
 analyze_tgpu[Hx]: ndim=23:1.714e-07GB T(cpu-gpu)=2.315e-03 speed=1.480e-04GB/S T(nccl)=6.341e-06 speed=5.405e-02GB/S
----- TIMING FOR sigma : t_inter=3.1e-03 t_gemm=5.2e-03 t_reduction=2.3e-03 tot=1.0e-02 -----
 sigma[inter] counter=128 t=3.1e-03 per=2.9e+01 cost=3.7e+04 flops=1.2e+07
 sigma[gemm] counter=128 i=0 t=1.6e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=1 t=1.4e-06 per=1.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=2 t=1.5e-03 per=1.4e+01 cost=9.9e+03 flops=6.7e+06
 sigma[gemm] counter=128 i=3 t=1.4e-03 per=1.4e+01 cost=9.7e+03 flops=6.7e+06
 sigma[gemm] counter=128 i=4 t=1.1e-03 per=1.1e+01 cost=1.7e+04 flops=1.5e+07
 sigma[gemm] counter=128 i=5 t=1.1e-03 per=1.1e+01 cost=1.7e+04 flops=1.5e+07
 sigma[gemm] counter=128 total t=5.2e-03 per=4.9e+01 cost=5.4e+04 flops=1.0e+07
 sigma[red] counter=128 t=2.3e-03 per=2.2e+01 cost=1.5e+04 flops=6.8e+06
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.7e+00 t_reduction=1.5e+00 tot=6.4e+00 -----
 sigma_tot[inter] counter=128 t=1.2e+00 per=1.9e+01 cost=4.3e+06 flops=3.6e+06
 sigma_tot[gemm] counter=128 i=0 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=1 t=2.0e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=2 t=9.3e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=128 i=3 t=9.3e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=128 i=4 t=9.3e-01 per=1.4e+01 cost=1.8e+06 flops=2.0e+06
 sigma_tot[gemm] counter=128 i=5 t=9.2e-01 per=1.4e+01 cost=1.8e+06 flops=2.0e+06
 sigma_tot[gemm] counter=128 total t=3.7e+00 per=5.8e+01 cost=7.6e+06 flops=2.0e+06
 sigma_tot[red] counter=128 t=1.5e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.6e-05,3.2e-06,1.2e-06,2.1e-07
    3   0 +    -116.328224067176 -4.279e-07  8.204e-05    3     3  1.467e-01 4.891e-02 4.052e-02
TIMING FOR Davidson : 1.467e-01  T(cal/comm/rest)=1.216e-01,3.370e-07,2.520e-02
decomposed t_rest=2.520e-02
 T(sub)    =5.783e-05 per=2.295e-01
 T(precond)=2.501e-02 per=9.928e+01
 T(ortho)  =2.632e-05 per=1.045e-01
 T(xcopy)  =7.460e-07 per=2.961e-03
 T(xnrm2)  =1.243e-06 per=4.933e-03
 T(other)  =9.585e-05 per=3.804e-01
optimized energies: isweep=0 ibond=29 dots=1 e[0]=-116.328224067176 nmvp=3
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.038e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond29.txt
 qbond: qsuper nsym=8 dimAll=24
 (20,0):3 (20,-2):2 (21,-1):6 (22,0):4 (22,-2):3 (23,-1):1 (21,1):3 (21,-3):2
timing for divide=1.3e-05
timing for compute=8.6e-03
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 8.6e-03 S T(divide/compute[cpu/gpu/rest]/collect)=1.3e-05,8.6e-03,0.0e+00,5.4e-06,1.4e-05 -----
decimation summary: 24->5 dwt=+0.000e+00 SvN=9.728e-01
 qbond: qkept nsym=3 dimAll=5
 (21,-1):3 (22,-2):1 (21,-3):1
----- TIMING for decimation_row(nkr): 8.828e-03 S T(decim/select/formRot)=8.640e-03,1.702e-04,1.820e-05 -----
----- TIMING FOR onedot_decimation: 8.915e-03 S T(wf/decim)=6.804e-05,8.847e-03 -----
ctns::oper_renorm coord=(6,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=5,5 size(op)=11:8.392e-05MB size(tot)=661:5.043e-03MB:4.925e-06GB
        per(mem): H:1.66 C:8.47 S:3.63 P:0 Q:86.2 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=9.761e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 1.490e-02 S -----
rank=0 GPUmem(GB): used=6.898e-05 (oper)=3.121e-05
rank=0 GPUmem(GB): used=6.916e-05 (oper,site)=3.121e-05,1.714e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=185
 no. of rintermediate operators=390
 no. of coefficients=5070:3.868e-02MB:3.777e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.516e-03 S -----
rank=0 GPUmem(GB): used=1.069e-04 (oper,site,rinter)=3.121e-05,1.714e-07,3.777e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 3.947e-03 S size(rtasks)=185 size(Rlst2)=9 T(Rmu/Rlist)=2.337e-03,1.610e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.182e-03 S size(rtasks)=185 size(Rlst)=1049 -----
rank=0 GPUmem(GB): used=1.069e-04 avail=6.176e+00 total=6.176e+00 batch[need]=1.719e-04 blksize=9 blksize0=3 batchsize=1049
rank=0 GPUmem(GB): used=2.789e-04 (oper,site,rinter,batch)=3.121e-05,1.714e-07,3.777e-05,1.719e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.933e-03,2.247e-02,9.962e-03
----- TIMING FOR renorm : t_inter=5.9e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=30 t=5.9e-03 per=1.5e+01 cost=1.9e+04 flops=3.1e+06
 renorm[gemm] counter=30 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=1 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=2 t=7.4e-03 per=1.9e+01 cost=2.5e+03 flops=3.3e+05
 renorm[gemm] counter=30 i=3 t=7.6e-03 per=2.0e+01 cost=8.0e+03 flops=1.1e+06
 renorm[gemm] counter=30 i=4 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=5 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=6 t=7.5e-03 per=1.9e+01 cost=1.9e+04 flops=2.6e+06
 renorm[gemm] counter=30 total t=2.2e-02 per=5.9e+01 cost=3.0e+04 flops=1.3e+06
 renorm[red] counter=30 t=1.0e-02 per=2.6e+01 cost=1.0e+04 flops=1.0e+06
----- TIMING FOR renorm_tot : t_inter=1.8e-01 t_gemm=6.6e-01 t_reduction=3.0e-01 tot=1.1e+00 -----
 renorm_tot[inter] counter=30 t=1.8e-01 per=1.6e+01 cost=1.1e+06 flops=6.0e+06
 renorm_tot[gemm] counter=30 i=0 t=4.4e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=30 i=1 t=3.6e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=30 i=2 t=9.6e-02 per=8.5e+00 cost=2.1e+05 flops=2.1e+06
 renorm_tot[gemm] counter=30 i=3 t=9.8e-02 per=8.7e+00 cost=2.7e+05 flops=2.7e+06
 renorm_tot[gemm] counter=30 i=4 t=1.2e-01 per=1.1e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=30 i=5 t=1.2e-01 per=1.1e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=30 i=6 t=2.2e-01 per=1.9e+01 cost=2.8e+06 flops=1.3e+07
 renorm_tot[gemm] counter=30 total t=6.6e-01 per=5.8e+01 cost=3.8e+06 flops=5.8e+06
 renorm_tot[red] counter=30 t=3.0e-01 per=2.6e+01 cost=1.3e+06 flops=4.3e+06
qops.to_cpu: size(tot)=661:5.0e-03MB:4.9e-06GB T(to_cpu)=1.9e-04S speed=2.6e-02GB/S
check ||H-H.dagger||=1.408e-16 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.069 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=7.706e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.433e-04 change=-1.870e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.433e-04 change=-6.258e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.910e-01 S #####
 T(local opt: fetch) = 1.219e-02 S  per = 2.48  per(accum) = 2.48
 T(local opt: hdiag) = 2.219e-01 S  per = 45.2  per(accum) = 47.7
 T(local opt: dvdsn) = 1.771e-01 S  per = 36.1  per(accum) = 83.7
 T(local opt: decim) = 8.924e-03 S  per = 1.82  per(accum) = 85.6
 T(local opt: guess) = 7.570e-05 S  per = 0.0154  per(accum) = 85.6
 T(local opt: renrm) = 7.060e-02 S  per = 14.4  per(accum) = 100
 T(local opt: save ) = 2.260e-04 S  per = 0.046  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.771e-01 S  T(sum) = 1.769e-01 S  per = 9.986e+01
 T(local opt: preprocess                  ) = 1.054e-04 S  per = 0.0596  per(accum) = 0.0596
 T(local opt: symbolic_formulae           ) = 1.454e-02 S  per = 8.22  per(accum) = 8.28
 T(local opt: hintermediate init          ) = 4.070e-04 S  per = 0.23  per(accum) = 8.51
 T(local opt: preprocess_hformulae_Hxlist ) = 5.101e-03 S  per = 2.88  per(accum) = 11.4
 T(local opt: hmmtasks init               ) = 9.949e-03 S  per = 5.63  per(accum) = 17
 T(local opt: initial guess for dvdson    ) = 2.936e-06 S  per = 0.00166  per(accum) = 17
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.166e-01 S  per =   66  per(accum) = 83
 T(local opt: dvdson [cpu-gpu]            ) = 4.886e-03 S  per = 2.76  per(accum) = 85.7
 T(local opt: dvdson [nccl]               ) = 1.812e-05 S  per = 0.0102  per(accum) = 85.8
 T(local opt: dvdson [mpi]                ) = 3.370e-07 S  per = 0.000191  per(accum) = 85.8
 T(local opt: dvdson [rest part(linalg)]  ) = 2.520e-02 S  per = 14.2  per(accum) = 100
Detailed decomposition of T(renrm) = 7.060e-02 S  T(sum) = 7.060e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.774e-05 S  per = 0.0959  per(accum) = 0.0959
 T(local opt: qops init                    ) = 1.368e-03 S  per = 1.94  per(accum) = 2.03
 T(local opt: symbolic_formulae_renorm     ) = 1.492e-02 S  per = 21.1  per(accum) = 23.2
 T(local opt: allocate qops on gpu         ) = 5.634e-05 S  per = 0.0798  per(accum) = 23.2
 T(local opt: site memcpy cpu2gpu          ) = 1.027e-03 S  per = 1.45  per(accum) = 24.7
 T(local opt: rintermediate init           ) = 2.529e-03 S  per = 3.58  per(accum) = 28.3
 T(local opt: preprocess_formulae_Rlist2   ) = 4.219e-03 S  per = 5.98  per(accum) = 34.3
 T(local opt: rmmtasks init                ) = 6.139e-03 S  per =  8.7  per(accum) = 43
 T(local opt: qops memset on cpu           ) = 3.200e-08 S  per = 4.53e-05  per(accum) = 43
 T(local opt: preprocess_renorm_batchGPU   ) = 3.846e-02 S  per = 54.5  per(accum) = 97.4
 T(local opt: deallocate cpu and gpu memory) = 6.283e-05 S  per = 0.089  per(accum) = 97.5
 T(local opt: construct opS [ifdists=true] ) = 3.400e-08 S  per = 4.82e-05  per(accum) = 97.5
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 5.38e-05  per(accum) = 97.5
 T(local opt: qops memcpy gpu2cpu          ) = 1.975e-04 S  per = 0.28  per(accum) = 97.8
 T(local opt: reduction of opS & opH [mpi] ) = 1.617e-05 S  per = 0.0229  per(accum) = 97.8
 T(local opt: qops_pool join and erase     ) = 1.534e-03 S  per = 2.17  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.373e-06 S  per = 0.00194  per(accum) = 100
##### sweep opt: 1.769e+01 S #####
 T(sweep opt: fetch) = 3.895e-01 S  per =  2.2  per(accum) = 2.2
 T(sweep opt: hdiag) = 6.141e+00 S  per = 34.7  per(accum) = 36.9
 T(sweep opt: dvdsn) = 8.580e+00 S  per = 48.5  per(accum) = 85.4
 T(sweep opt: decim) = 3.330e-01 S  per = 1.88  per(accum) = 87.3
 T(sweep opt: guess) = 2.688e-03 S  per = 0.0152  per(accum) = 87.3
 T(sweep opt: renrm) = 2.239e+00 S  per = 12.7  per(accum) = 100
 T(sweep opt: save ) = 7.246e-03 S  per = 0.041  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.580e+00 S  T(sum) = 8.572e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 3.016e-03 S  per = 0.0352  per(accum) = 0.0352
 T(sweep opt: symbolic_formulae           ) = 4.031e-01 S  per =  4.7  per(accum) = 4.74
 T(sweep opt: hintermediate init          ) = 1.064e-02 S  per = 0.124  per(accum) = 4.86
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.303e-01 S  per = 1.52  per(accum) = 6.38
 T(sweep opt: hmmtasks init               ) = 2.467e-01 S  per = 2.88  per(accum) = 9.26
 T(sweep opt: initial guess for dvdson    ) = 9.838e-05 S  per = 0.00115  per(accum) = 9.26
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.449e+00 S  per = 75.2  per(accum) = 84.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.681e-01 S  per = 1.96  per(accum) = 86.5
 T(sweep opt: dvdson [nccl]               ) = 7.290e-04 S  per = 0.0085  per(accum) = 86.5
 T(sweep opt: dvdson [mpi]                ) = 1.635e-05 S  per = 0.000191  per(accum) = 86.5
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.160e+00 S  per = 13.5  per(accum) = 100
Detailed decomposition of T(renrm) = 2.239e+00 S  T(sum) = 2.239e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.828e-03 S  per = 0.171  per(accum) = 0.171
 T(sweep opt: qops init                    ) = 5.530e-02 S  per = 2.47  per(accum) = 2.64
 T(sweep opt: symbolic_formulae_renorm     ) = 4.321e-01 S  per = 19.3  per(accum) = 21.9
 T(sweep opt: allocate qops on gpu         ) = 1.816e-03 S  per = 0.0811  per(accum) = 22
 T(sweep opt: site memcpy cpu2gpu          ) = 4.025e-02 S  per =  1.8  per(accum) = 23.8
 T(sweep opt: rintermediate init           ) = 6.732e-02 S  per = 3.01  per(accum) = 26.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.345e-01 S  per = 6.01  per(accum) = 32.8
 T(sweep opt: rmmtasks init                ) = 2.537e-01 S  per = 11.3  per(accum) = 44.2
 T(sweep opt: qops memset on cpu           ) = 1.303e-06 S  per = 5.82e-05  per(accum) = 44.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.134e+00 S  per = 50.6  per(accum) = 94.8
 T(sweep opt: deallocate cpu and gpu memory) = 2.697e-03 S  per = 0.12  per(accum) = 94.9
 T(sweep opt: construct opS [ifdists=true] ) = 1.213e-06 S  per = 5.42e-05  per(accum) = 94.9
 T(sweep opt: reduction of opS & opH [nccl]) = 1.201e-06 S  per = 5.36e-05  per(accum) = 94.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.247e-03 S  per = 0.279  per(accum) = 95.2
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.634e-04 S  per = 0.0252  per(accum) = 95.2
 T(sweep opt: qops_pool join and erase     ) = 4.627e-02 S  per = 2.07  per(accum) = 97.3
 T(sweep opt: conversion from opAB to opPQ ) = 6.087e-02 S  per = 2.72  per(accum) = 100
##### global opt: 1.769e+01 S #####
 T(global opt: fetch) = 3.895e-01 S  per =  2.2  per(accum) = 2.2
 T(global opt: hdiag) = 6.141e+00 S  per = 34.7  per(accum) = 36.9
 T(global opt: dvdsn) = 8.580e+00 S  per = 48.5  per(accum) = 85.4
 T(global opt: decim) = 3.330e-01 S  per = 1.88  per(accum) = 87.3
 T(global opt: guess) = 2.688e-03 S  per = 0.0152  per(accum) = 87.3
 T(global opt: renrm) = 2.239e+00 S  per = 12.7  per(accum) = 100
 T(global opt: save ) = 7.246e-03 S  per = 0.041  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.580e+00 S  T(sum) = 8.572e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 3.016e-03 S  per = 0.0352  per(accum) = 0.0352
 T(global opt: symbolic_formulae           ) = 4.031e-01 S  per =  4.7  per(accum) = 4.74
 T(global opt: hintermediate init          ) = 1.064e-02 S  per = 0.124  per(accum) = 4.86
 T(global opt: preprocess_hformulae_Hxlist ) = 1.303e-01 S  per = 1.52  per(accum) = 6.38
 T(global opt: hmmtasks init               ) = 2.467e-01 S  per = 2.88  per(accum) = 9.26
 T(global opt: initial guess for dvdson    ) = 9.838e-05 S  per = 0.00115  per(accum) = 9.26
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.449e+00 S  per = 75.2  per(accum) = 84.5
 T(global opt: dvdson [cpu-gpu]            ) = 1.681e-01 S  per = 1.96  per(accum) = 86.5
 T(global opt: dvdson [nccl]               ) = 7.290e-04 S  per = 0.0085  per(accum) = 86.5
 T(global opt: dvdson [mpi]                ) = 1.635e-05 S  per = 0.000191  per(accum) = 86.5
 T(global opt: dvdson [rest part(linalg)]  ) = 1.160e+00 S  per = 13.5  per(accum) = 100
Detailed decomposition of T(renrm) = 2.239e+00 S  T(sum) = 2.239e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.828e-03 S  per = 0.171  per(accum) = 0.171
 T(global opt: qops init                    ) = 5.530e-02 S  per = 2.47  per(accum) = 2.64
 T(global opt: symbolic_formulae_renorm     ) = 4.321e-01 S  per = 19.3  per(accum) = 21.9
 T(global opt: allocate qops on gpu         ) = 1.816e-03 S  per = 0.0811  per(accum) = 22
 T(global opt: site memcpy cpu2gpu          ) = 4.025e-02 S  per =  1.8  per(accum) = 23.8
 T(global opt: rintermediate init           ) = 6.732e-02 S  per = 3.01  per(accum) = 26.8
 T(global opt: preprocess_formulae_Rlist2   ) = 1.345e-01 S  per = 6.01  per(accum) = 32.8
 T(global opt: rmmtasks init                ) = 2.537e-01 S  per = 11.3  per(accum) = 44.2
 T(global opt: qops memset on cpu           ) = 1.303e-06 S  per = 5.82e-05  per(accum) = 44.2
 T(global opt: preprocess_renorm_batchGPU   ) = 1.134e+00 S  per = 50.6  per(accum) = 94.8
 T(global opt: deallocate cpu and gpu memory) = 2.697e-03 S  per = 0.12  per(accum) = 94.9
 T(global opt: construct opS [ifdists=true] ) = 1.213e-06 S  per = 5.42e-05  per(accum) = 94.9
 T(global opt: reduction of opS & opH [nccl]) = 1.201e-06 S  per = 5.36e-05  per(accum) = 94.9
 T(global opt: qops memcpy gpu2cpu          ) = 6.247e-03 S  per = 0.279  per(accum) = 95.2
 T(global opt: reduction of opS & opH [mpi] ) = 5.634e-04 S  per = 0.0252  per(accum) = 95.2
 T(global opt: qops_pool join and erase     ) = 4.627e-02 S  per = 2.07  per(accum) = 97.3
 T(global opt: conversion from opAB to opPQ ) = 6.087e-02 S  per = 2.72  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.038e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=30/seqsize=34 dots=1 dbond=(4,0)-(5,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=17:1.297e-04MB:1.267e-07GB
total mem of comb=1211:9.239e-03MB:9.023e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=5,14,1
 suppl= 0 1 2 3 4
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 16
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:10 S:30 A:45 B:55 
        dim(bra,ket)=4,4 size(op)=10:7.629e-05MB size(tot)=370:2.823e-03MB:2.757e-06GB
        per(mem): H:2.7 C:4.05 S:12.2 A:0 B:81.1 
 rqops: oplist=HCSPQ nops=H:1 C:28 S:12 P:66 Q:78 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=661:0.00504MB:4.92e-06GB
        per(mem): H:1.66 C:8.47 S:3.63 P:0 Q:86.2 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3367:0.0257MB:2.51e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.362e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(5,0) fdel=./scratch/sweep/lop(4,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.503e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(4,5,4) nnz=17:1.297e-04MB
qtensor3: wf3 own=1 _data=0x47890b40
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=4
 (8,2):3 (7,3):1
 qbond: qcol nsym=3 dimAll=5
 (21,-1):3 (22,-2):1 (21,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=24 size=17:1.297e-04MB
### DIAG TIMING: total=7.348e-02 t1=2.753e-05, t2=2.165e-03, t3=2.486e-03, t4=6.877e-02, t5=5.783e-06, t6=1.472e-05, t7=3.186e-06
duration_diagGPU:7.349e-02
duration_diagreduce:1.040e-07
duration_diagtransform:7.350e-07
----- TIMING FOR symbolic_formulae_onedot with size=607 : 1.079e-02 S -----
rank=0 GPUmem(GB): used=2.509e-05 (oper)=2.509e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=607
 no. of hintermediate operators=280
 no. of coefficients=3920:2.991e-02MB:2.921e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.524e-04 S -----
rank=0 GPUmem(GB): used=5.429e-05 (oper,hinter)=2.509e-05,2.921e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.991e-03 S size(H_formulae)=607 size(Hxlst2)=5 T(Hmu/Hxlist)=1.519e-03,1.472e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.166e-03 S size(H_formulae)=607 size(Hxlst)=1152 -----
rank=0 GPUmem(GB): used=5.429e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.533e-07 batch[need]=1.888e-04 blksize=9 blksize0=3 batchsize=1152
rank=0 GPUmem(GB): used=2.434e-04 (oper,hinter,dvdson,batch)=2.509e-05,2.921e-05,2.533e-07,1.888e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=17 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.612e-03,9.880e-03,2.969e-02,1.235e-02,5.354e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=1.607e-03 speed=1.576e-04GB/S T(nccl)=5.127e-06 speed=4.941e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=129 t=9.9e-03 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=129 i=0 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=1 t=1.0e-06 per=1.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=2 t=7.4e-03 per=1.4e+01 cost=4.6e+03 flops=6.2e+05
 sigma[gemm] counter=129 i=3 t=7.3e-03 per=1.4e+01 cost=4.7e+03 flops=6.4e+05
 sigma[gemm] counter=129 i=4 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=129 i=5 t=7.5e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=129 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.2e+05
 sigma[red] counter=129 t=1.2e-02 per=2.4e+01 cost=7.8e+03 flops=6.3e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.7e+00 t_reduction=1.5e+00 tot=6.5e+00 -----
 sigma_tot[inter] counter=129 t=1.2e+00 per=1.9e+01 cost=4.4e+06 flops=3.6e+06
 sigma_tot[gemm] counter=129 i=0 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=1 t=2.0e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=2 t=9.3e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=129 i=3 t=9.4e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=129 i=4 t=9.4e-01 per=1.4e+01 cost=1.8e+06 flops=2.0e+06
 sigma_tot[gemm] counter=129 i=5 t=9.3e-01 per=1.4e+01 cost=1.8e+06 flops=2.0e+06
 sigma_tot[gemm] counter=129 total t=3.7e+00 per=5.8e+01 cost=7.6e+06 flops=2.0e+06
 sigma_tot[red] counter=129 t=1.5e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=9.4e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,3.9e-06,2.0e-06,7.8e-07,1.9e-07
settings: ndim=17 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.328224067176 -1.116e+03  5.951e-03    1     1  5.365e-02 5.365e-02 5.363e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.346e-03,9.977e-03,2.997e-02,1.259e-02,5.489e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=2.336e-03 speed=1.084e-04GB/S T(nccl)=9.569e-06 speed=2.647e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=130 t=1.0e-02 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=130 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=2 t=7.5e-03 per=1.4e+01 cost=4.6e+03 flops=6.1e+05
 sigma[gemm] counter=130 i=3 t=7.4e-03 per=1.4e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=130 i=4 t=7.5e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=130 i=5 t=7.6e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=130 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.2e+05
 sigma[red] counter=130 t=1.3e-02 per=2.4e+01 cost=7.8e+03 flops=6.2e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.8e+00 t_reduction=1.5e+00 tot=6.5e+00 -----
 sigma_tot[inter] counter=130 t=1.2e+00 per=1.9e+01 cost=4.4e+06 flops=3.6e+06
 sigma_tot[gemm] counter=130 i=0 t=2.3e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=1 t=2.1e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=2 t=9.4e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=130 i=3 t=9.4e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=130 i=4 t=9.5e-01 per=1.4e+01 cost=1.8e+06 flops=1.9e+06
 sigma_tot[gemm] counter=130 i=5 t=9.3e-01 per=1.4e+01 cost=1.8e+06 flops=2.0e+06
 sigma_tot[gemm] counter=130 total t=3.8e+00 per=5.8e+01 cost=7.6e+06 flops=2.0e+06
 sigma_tot[red] counter=130 t=1.5e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.1e-05,3.7e-06,8.6e-07,2.3e-07
    2   0 -    -116.328278203751 -5.414e-05  5.345e-04    2     2  1.213e-01 6.064e-02 5.431e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.940e-03,9.892e-03,2.976e-02,1.245e-02,5.410e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=1.933e-03 speed=1.311e-04GB/S T(nccl)=7.537e-06 speed=3.361e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=131 t=9.9e-03 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=131 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=2 t=7.4e-03 per=1.4e+01 cost=4.6e+03 flops=6.2e+05
 sigma[gemm] counter=131 i=3 t=7.4e-03 per=1.4e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=131 i=4 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=131 i=5 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=131 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.2e+05
 sigma[red] counter=131 t=1.2e-02 per=2.4e+01 cost=7.8e+03 flops=6.3e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=3.8e+00 t_reduction=1.6e+00 tot=6.6e+00 -----
 sigma_tot[inter] counter=131 t=1.2e+00 per=1.9e+01 cost=4.4e+06 flops=3.5e+06
 sigma_tot[gemm] counter=131 i=0 t=2.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=1 t=2.1e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=2 t=9.5e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=131 i=3 t=9.5e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=131 i=4 t=9.5e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=131 i=5 t=9.4e-01 per=1.4e+01 cost=1.9e+06 flops=2.0e+06
 sigma_tot[gemm] counter=131 total t=3.8e+00 per=5.8e+01 cost=7.7e+06 flops=2.0e+06
 sigma_tot[red] counter=131 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.5e-05,2.9e-06,9.7e-07,1.9e-07
    3   0 -    -116.328279238851 -1.035e-06  1.702e-04    3     3  1.884e-01 6.281e-02 5.427e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.021e-03,1.005e-02,3.001e-02,1.240e-02,5.449e-02
 analyze_tgpu[Hx]: ndim=17:1.267e-07GB T(cpu-gpu)=2.016e-03 speed=1.257e-04GB/S T(nccl)=5.031e-06 speed=5.035e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=132 t=1.0e-02 per=1.9e+01 cost=1.8e+04 flops=1.8e+06
 sigma[gemm] counter=132 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=2 t=7.5e-03 per=1.4e+01 cost=4.6e+03 flops=6.1e+05
 sigma[gemm] counter=132 i=3 t=7.6e-03 per=1.4e+01 cost=4.7e+03 flops=6.1e+05
 sigma[gemm] counter=132 i=4 t=7.5e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=132 i=5 t=7.4e-03 per=1.4e+01 cost=9.1e+03 flops=1.2e+06
 sigma[gemm] counter=132 total t=3.0e-02 per=5.7e+01 cost=2.7e+04 flops=9.1e+05
 sigma[red] counter=132 t=1.2e-02 per=2.4e+01 cost=7.8e+03 flops=6.3e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.8e+00 t_reduction=1.6e+00 tot=6.6e+00 -----
 sigma_tot[inter] counter=132 t=1.3e+00 per=1.9e+01 cost=4.4e+06 flops=3.5e+06
 sigma_tot[gemm] counter=132 i=0 t=2.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=1 t=2.1e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=2 t=9.6e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=132 i=3 t=9.6e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=132 i=4 t=9.6e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=132 i=5 t=9.5e-01 per=1.4e+01 cost=1.9e+06 flops=2.0e+06
 sigma_tot[gemm] counter=132 total t=3.8e+00 per=5.8e+01 cost=7.7e+06 flops=2.0e+06
 sigma_tot[red] counter=132 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.4e-05,3.0e-06,1.1e-06,1.6e-07
    4   0 +    -116.328279347223 -1.084e-07  1.611e-05    3     4  2.539e-01 6.348e-02 5.435e-02
TIMING FOR Davidson : 2.539e-01  T(cal/comm/rest)=2.174e-01,3.900e-07,3.652e-02
decomposed t_rest=3.652e-02
 T(sub)    =7.518e-05 per=2.059e-01
 T(precond)=3.633e-02 per=9.948e+01
 T(ortho)  =1.820e-05 per=4.983e-02
 T(xcopy)  =9.090e-07 per=2.489e-03
 T(xnrm2)  =1.729e-06 per=4.734e-03
 T(other)  =9.469e-05 per=2.593e-01
optimized energies: isweep=0 ibond=30 dots=1 e[0]=-116.328279347223 nmvp=4
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=7.079e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond30.txt
 qbond: qsuper nsym=8 dimAll=20
 (21,-1):3 (22,-2):5 (21,-3):1 (23,-1):4 (24,-2):1 (23,-3):2 (22,0):3 (22,-4):1
timing for divide=1.1e-05
timing for compute=7.4e-03
timing for collect=1.8e-05
----- TMING FOR decimation_genbasis(nkr): 7.4e-03 S T(divide/compute[cpu/gpu/rest]/collect)=1.1e-05,7.4e-03,0.0e+00,5.9e-06,1.8e-05 -----
decimation summary: 20->4 dwt=+1.110e-16 SvN=7.934e-01
 qbond: qkept nsym=2 dimAll=4
 (22,-2):3 (23,-3):1
----- TIMING for decimation_row(nkr): 7.769e-03 S T(decim/select/formRot)=7.481e-03,2.597e-04,2.733e-05 -----
----- TIMING FOR onedot_decimation: 7.859e-03 S T(wf/decim)=6.029e-05,7.798e-03 -----
ctns::oper_renorm coord=(5,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=10:7.629e-05MB size(tot)=370:2.823e-03MB:2.757e-06GB
        per(mem): H:2.7 C:12.2 S:4.05 P:0 Q:81.1 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=5.734e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=141 : 1.979e-02 S -----
rank=0 GPUmem(GB): used=5.429e-05 (oper)=2.509e-05
rank=0 GPUmem(GB): used=5.442e-05 (oper,site)=2.509e-05,1.267e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=141
 no. of rintermediate operators=280
 no. of coefficients=3920:2.991e-02MB:2.921e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.532e-03 S -----
rank=0 GPUmem(GB): used=8.363e-05 (oper,site,rinter)=2.509e-05,1.267e-07,2.921e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 4.567e-03 S size(rtasks)=141 size(Rlst2)=4 T(Rmu/Rlist)=2.755e-03,1.812e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.694e-03 S size(rtasks)=141 size(Rlst)=631 -----
rank=0 GPUmem(GB): used=8.363e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.034e-04 blksize=9 blksize0=3 batchsize=631
rank=0 GPUmem(GB): used=1.871e-04 (oper,site,rinter,batch)=2.509e-05,1.267e-07,2.921e-05,1.034e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.933e-03,2.258e-02,1.009e-02
----- TIMING FOR renorm : t_inter=5.9e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=31 t=5.9e-03 per=1.5e+01 cost=9.1e+03 flops=1.5e+06
 renorm[gemm] counter=31 i=0 t=2.2e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=1 t=2.1e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=2 t=7.5e-03 per=1.9e+01 cost=1.4e+03 flops=1.8e+05
 renorm[gemm] counter=31 i=3 t=7.5e-03 per=1.9e+01 cost=3.8e+03 flops=5.0e+05
 renorm[gemm] counter=31 i=4 t=1.8e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=5 t=1.8e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=6 t=7.6e-03 per=2.0e+01 cost=1.1e+04 flops=1.5e+06
 renorm[gemm] counter=31 total t=2.3e-02 per=5.8e+01 cost=1.6e+04 flops=7.3e+05
 renorm[red] counter=31 t=1.0e-02 per=2.6e+01 cost=7.0e+03 flops=7.0e+05
----- TIMING FOR renorm_tot : t_inter=1.8e-01 t_gemm=6.8e-01 t_reduction=3.1e-01 tot=1.2e+00 -----
 renorm_tot[inter] counter=31 t=1.8e-01 per=1.6e+01 cost=1.1e+06 flops=5.8e+06
 renorm_tot[gemm] counter=31 i=0 t=4.6e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=31 i=1 t=3.8e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=31 i=2 t=1.0e-01 per=8.8e+00 cost=2.1e+05 flops=2.0e+06
 renorm_tot[gemm] counter=31 i=3 t=1.1e-01 per=9.0e+00 cost=2.7e+05 flops=2.6e+06
 renorm_tot[gemm] counter=31 i=4 t=1.2e-01 per=1.0e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=31 i=5 t=1.2e-01 per=1.0e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=31 i=6 t=2.3e-01 per=1.9e+01 cost=2.8e+06 flops=1.2e+07
 renorm_tot[gemm] counter=31 total t=6.8e-01 per=5.8e+01 cost=3.8e+06 flops=5.6e+06
 renorm_tot[red] counter=31 t=3.1e-01 per=2.6e+01 cost=1.3e+06 flops=4.2e+06
qops.to_cpu: size(tot)=370:2.8e-03MB:2.8e-06GB T(to_cpu)=4.9e-04S speed=5.7e-03GB/S
check ||H-H.dagger||=1.288e-16 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.076 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=5.326e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.565e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-4.694e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.459e-01 S #####
 T(local opt: fetch) = 1.005e-02 S  per = 2.25  per(accum) = 2.25
 T(local opt: hdiag) = 7.352e-02 S  per = 16.5  per(accum) = 18.7
 T(local opt: dvdsn) = 2.742e-01 S  per = 61.5  per(accum) = 80.2
 T(local opt: decim) = 7.872e-03 S  per = 1.77  per(accum) = 82
 T(local opt: guess) = 1.116e-04 S  per = 0.025  per(accum) = 82
 T(local opt: renrm) = 7.954e-02 S  per = 17.8  per(accum) = 99.9
 T(local opt: save ) = 6.136e-04 S  per = 0.138  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.742e-01 S  T(sum) = 2.740e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 8.478e-05 S  per = 0.0309  per(accum) = 0.0309
 T(local opt: symbolic_formulae           ) = 1.080e-02 S  per = 3.94  per(accum) = 3.97
 T(local opt: hintermediate init          ) = 2.685e-04 S  per = 0.098  per(accum) = 4.07
 T(local opt: preprocess_hformulae_Hxlist ) = 3.201e-03 S  per = 1.17  per(accum) = 5.24
 T(local opt: hmmtasks init               ) = 5.716e-03 S  per = 2.09  per(accum) = 7.33
 T(local opt: initial guess for dvdson    ) = 6.603e-06 S  per = 0.00241  per(accum) = 7.33
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.095e-01 S  per = 76.5  per(accum) = 83.8
 T(local opt: dvdson [cpu-gpu]            ) = 7.892e-03 S  per = 2.88  per(accum) = 86.7
 T(local opt: dvdson [nccl]               ) = 2.726e-05 S  per = 0.00995  per(accum) = 86.7
 T(local opt: dvdson [mpi]                ) = 3.900e-07 S  per = 0.000142  per(accum) = 86.7
 T(local opt: dvdson [rest part(linalg)]  ) = 3.652e-02 S  per = 13.3  per(accum) = 100
Detailed decomposition of T(renrm) = 7.954e-02 S  T(sum) = 7.954e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.413e-04 S  per = 0.178  per(accum) = 0.178
 T(local opt: qops init                    ) = 1.639e-03 S  per = 2.06  per(accum) = 2.24
 T(local opt: symbolic_formulae_renorm     ) = 1.981e-02 S  per = 24.9  per(accum) = 27.1
 T(local opt: allocate qops on gpu         ) = 8.192e-05 S  per = 0.103  per(accum) = 27.2
 T(local opt: site memcpy cpu2gpu          ) = 1.935e-03 S  per = 2.43  per(accum) = 29.7
 T(local opt: rintermediate init           ) = 2.553e-03 S  per = 3.21  per(accum) = 32.9
 T(local opt: preprocess_formulae_Rlist2   ) = 4.732e-03 S  per = 5.95  per(accum) = 38.8
 T(local opt: rmmtasks init                ) = 5.633e-03 S  per = 7.08  per(accum) = 45.9
 T(local opt: qops memset on cpu           ) = 6.100e-08 S  per = 7.67e-05  per(accum) = 45.9
 T(local opt: preprocess_renorm_batchGPU   ) = 3.892e-02 S  per = 48.9  per(accum) = 94.8
 T(local opt: deallocate cpu and gpu memory) = 1.344e-04 S  per = 0.169  per(accum) = 95
 T(local opt: construct opS [ifdists=true] ) = 1.590e-07 S  per = 0.0002  per(accum) = 95
 T(local opt: reduction of opS & opH [nccl]) = 1.470e-07 S  per = 0.000185  per(accum) = 95
 T(local opt: qops memcpy gpu2cpu          ) = 5.209e-04 S  per = 0.655  per(accum) = 95.7
 T(local opt: reduction of opS & opH [mpi] ) = 5.348e-05 S  per = 0.0672  per(accum) = 95.7
 T(local opt: qops_pool join and erase     ) = 3.391e-03 S  per = 4.26  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 3.844e-06 S  per = 0.00483  per(accum) = 100
##### sweep opt: 1.814e+01 S #####
 T(sweep opt: fetch) = 3.995e-01 S  per =  2.2  per(accum) = 2.2
 T(sweep opt: hdiag) = 6.215e+00 S  per = 34.3  per(accum) = 36.5
 T(sweep opt: dvdsn) = 8.854e+00 S  per = 48.8  per(accum) = 85.3
 T(sweep opt: decim) = 3.408e-01 S  per = 1.88  per(accum) = 87.2
 T(sweep opt: guess) = 2.800e-03 S  per = 0.0154  per(accum) = 87.2
 T(sweep opt: renrm) = 2.319e+00 S  per = 12.8  per(accum) = 100
 T(sweep opt: save ) = 7.860e-03 S  per = 0.0433  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.854e+00 S  T(sum) = 8.846e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 3.101e-03 S  per = 0.0351  per(accum) = 0.0351
 T(sweep opt: symbolic_formulae           ) = 4.139e-01 S  per = 4.68  per(accum) = 4.71
 T(sweep opt: hintermediate init          ) = 1.091e-02 S  per = 0.123  per(accum) = 4.84
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.335e-01 S  per = 1.51  per(accum) = 6.35
 T(sweep opt: hmmtasks init               ) = 2.524e-01 S  per = 2.85  per(accum) = 9.2
 T(sweep opt: initial guess for dvdson    ) = 1.050e-04 S  per = 0.00119  per(accum) = 9.2
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.658e+00 S  per = 75.3  per(accum) = 84.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.760e-01 S  per = 1.99  per(accum) = 86.5
 T(sweep opt: dvdson [nccl]               ) = 7.562e-04 S  per = 0.00855  per(accum) = 86.5
 T(sweep opt: dvdson [mpi]                ) = 1.674e-05 S  per = 0.000189  per(accum) = 86.5
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.197e+00 S  per = 13.5  per(accum) = 100
Detailed decomposition of T(renrm) = 2.319e+00 S  T(sum) = 2.319e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.969e-03 S  per = 0.171  per(accum) = 0.171
 T(sweep opt: qops init                    ) = 5.694e-02 S  per = 2.46  per(accum) = 2.63
 T(sweep opt: symbolic_formulae_renorm     ) = 4.519e-01 S  per = 19.5  per(accum) = 22.1
 T(sweep opt: allocate qops on gpu         ) = 1.898e-03 S  per = 0.0819  per(accum) = 22.2
 T(sweep opt: site memcpy cpu2gpu          ) = 4.219e-02 S  per = 1.82  per(accum) = 24
 T(sweep opt: rintermediate init           ) = 6.987e-02 S  per = 3.01  per(accum) = 27
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.393e-01 S  per = 6.01  per(accum) = 33
 T(sweep opt: rmmtasks init                ) = 2.593e-01 S  per = 11.2  per(accum) = 44.2
 T(sweep opt: qops memset on cpu           ) = 1.364e-06 S  per = 5.88e-05  per(accum) = 44.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.173e+00 S  per = 50.6  per(accum) = 94.8
 T(sweep opt: deallocate cpu and gpu memory) = 2.831e-03 S  per = 0.122  per(accum) = 94.9
 T(sweep opt: construct opS [ifdists=true] ) = 1.372e-06 S  per = 5.92e-05  per(accum) = 94.9
 T(sweep opt: reduction of opS & opH [nccl]) = 1.348e-06 S  per = 5.81e-05  per(accum) = 94.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.768e-03 S  per = 0.292  per(accum) = 95.2
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.169e-04 S  per = 0.0266  per(accum) = 95.2
 T(sweep opt: qops_pool join and erase     ) = 4.966e-02 S  per = 2.14  per(accum) = 97.4
 T(sweep opt: conversion from opAB to opPQ ) = 6.087e-02 S  per = 2.63  per(accum) = 100
##### global opt: 1.814e+01 S #####
 T(global opt: fetch) = 3.995e-01 S  per =  2.2  per(accum) = 2.2
 T(global opt: hdiag) = 6.215e+00 S  per = 34.3  per(accum) = 36.5
 T(global opt: dvdsn) = 8.854e+00 S  per = 48.8  per(accum) = 85.3
 T(global opt: decim) = 3.408e-01 S  per = 1.88  per(accum) = 87.2
 T(global opt: guess) = 2.800e-03 S  per = 0.0154  per(accum) = 87.2
 T(global opt: renrm) = 2.319e+00 S  per = 12.8  per(accum) = 100
 T(global opt: save ) = 7.860e-03 S  per = 0.0433  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.854e+00 S  T(sum) = 8.846e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 3.101e-03 S  per = 0.0351  per(accum) = 0.0351
 T(global opt: symbolic_formulae           ) = 4.139e-01 S  per = 4.68  per(accum) = 4.71
 T(global opt: hintermediate init          ) = 1.091e-02 S  per = 0.123  per(accum) = 4.84
 T(global opt: preprocess_hformulae_Hxlist ) = 1.335e-01 S  per = 1.51  per(accum) = 6.35
 T(global opt: hmmtasks init               ) = 2.524e-01 S  per = 2.85  per(accum) = 9.2
 T(global opt: initial guess for dvdson    ) = 1.050e-04 S  per = 0.00119  per(accum) = 9.2
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.658e+00 S  per = 75.3  per(accum) = 84.5
 T(global opt: dvdson [cpu-gpu]            ) = 1.760e-01 S  per = 1.99  per(accum) = 86.5
 T(global opt: dvdson [nccl]               ) = 7.562e-04 S  per = 0.00855  per(accum) = 86.5
 T(global opt: dvdson [mpi]                ) = 1.674e-05 S  per = 0.000189  per(accum) = 86.5
 T(global opt: dvdson [rest part(linalg)]  ) = 1.197e+00 S  per = 13.5  per(accum) = 100
Detailed decomposition of T(renrm) = 2.319e+00 S  T(sum) = 2.319e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.969e-03 S  per = 0.171  per(accum) = 0.171
 T(global opt: qops init                    ) = 5.694e-02 S  per = 2.46  per(accum) = 2.63
 T(global opt: symbolic_formulae_renorm     ) = 4.519e-01 S  per = 19.5  per(accum) = 22.1
 T(global opt: allocate qops on gpu         ) = 1.898e-03 S  per = 0.0819  per(accum) = 22.2
 T(global opt: site memcpy cpu2gpu          ) = 4.219e-02 S  per = 1.82  per(accum) = 24
 T(global opt: rintermediate init           ) = 6.987e-02 S  per = 3.01  per(accum) = 27
 T(global opt: preprocess_formulae_Rlist2   ) = 1.393e-01 S  per = 6.01  per(accum) = 33
 T(global opt: rmmtasks init                ) = 2.593e-01 S  per = 11.2  per(accum) = 44.2
 T(global opt: qops memset on cpu           ) = 1.364e-06 S  per = 5.88e-05  per(accum) = 44.2
 T(global opt: preprocess_renorm_batchGPU   ) = 1.173e+00 S  per = 50.6  per(accum) = 94.8
 T(global opt: deallocate cpu and gpu memory) = 2.831e-03 S  per = 0.122  per(accum) = 94.9
 T(global opt: construct opS [ifdists=true] ) = 1.372e-06 S  per = 5.92e-05  per(accum) = 94.9
 T(global opt: reduction of opS & opH [nccl]) = 1.348e-06 S  per = 5.81e-05  per(accum) = 94.9
 T(global opt: qops memcpy gpu2cpu          ) = 6.768e-03 S  per = 0.292  per(accum) = 95.2
 T(global opt: reduction of opS & opH [mpi] ) = 6.169e-04 S  per = 0.0266  per(accum) = 95.2
 T(global opt: qops_pool join and erase     ) = 4.966e-02 S  per = 2.14  per(accum) = 97.4
 T(global opt: conversion from opAB to opPQ ) = 6.087e-02 S  per = 2.63  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-7.082e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=31/seqsize=34 dots=1 dbond=(3,0)-(4,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=10:7.629e-05MB:7.451e-08GB
total mem of comb=1204:9.186e-03MB:8.970e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=4,15,1
 suppl= 0 1 2 3
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 4
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:8 S:32 A:28 B:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:5.52 S:22.1 A:0 B:69 
 rqops: oplist=HCSPQ nops=H:1 C:30 S:10 P:45 Q:55 
        dim(bra,ket)=4,4 size(op)=10:7.63e-05MB size(tot)=370:0.00282MB:2.76e-06GB
        per(mem): H:2.7 C:12.2 S:4.05 P:0 Q:81.1 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2851:0.0218MB:2.12e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.208e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(4,0) fdel=./scratch/sweep/lop(3,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.345e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(3,4,4) nnz=10:7.629e-05MB
qtensor3: wf3 own=1 _data=0x3c5cc140
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=2 dimAll=3
 (7,1):2 (6,2):1
 qbond: qcol nsym=2 dimAll=4
 (22,-2):3 (23,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=3 nblocks=16 size=10:7.629e-05MB
### DIAG TIMING: total=1.123e-01 t1=6.982e-05, t2=1.722e-03, t3=2.531e-03, t4=1.079e-01, t5=7.170e-06, t6=1.753e-05, t7=5.335e-06
duration_diagGPU:1.123e-01
duration_diagreduce:9.400e-08
duration_diagtransform:4.120e-07
----- TIMING FOR symbolic_formulae_onedot with size=435 : 1.243e-02 S -----
rank=0 GPUmem(GB): used=2.124e-05 (oper)=2.124e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=435
 no. of hintermediate operators=188
 no. of coefficients=2820:2.151e-02MB:2.101e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.722e-04 S -----
rank=0 GPUmem(GB): used=4.225e-05 (oper,hinter)=2.124e-05,2.101e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.577e-03 S size(H_formulae)=435 size(Hxlst2)=3 T(Hmu/Hxlist)=1.596e-03,9.809e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.682e-03 S size(H_formulae)=435 size(Hxlst)=442 -----
rank=0 GPUmem(GB): used=4.225e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.490e-07 batch[need]=5.269e-05 blksize=6 blksize0=3 batchsize=442
rank=0 GPUmem(GB): used=9.509e-05 (oper,hinter,dvdson,batch)=2.124e-05,2.101e-05,1.490e-07,5.269e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=10 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.754e-03,1.006e-02,3.004e-02,1.231e-02,5.417e-02
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=1.748e-03 speed=8.525e-05GB/S T(nccl)=5.953e-06 speed=2.503e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=133 t=1.0e-02 per=1.9e+01 cost=7.9e+03 flops=7.9e+05
 sigma[gemm] counter=133 i=0 t=1.9e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=1 t=1.6e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=2 t=7.5e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=133 i=3 t=7.5e-03 per=1.4e+01 cost=1.9e+03 flops=2.5e+05
 sigma[gemm] counter=133 i=4 t=7.6e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=133 i=5 t=7.4e-03 per=1.4e+01 cost=1.7e+03 flops=2.3e+05
 sigma[gemm] counter=133 total t=3.0e-02 per=5.7e+01 cost=7.3e+03 flops=2.4e+05
 sigma[red] counter=133 t=1.2e-02 per=2.3e+01 cost=2.7e+03 flops=2.2e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.9e+00 t_reduction=1.6e+00 tot=6.7e+00 -----
 sigma_tot[inter] counter=133 t=1.3e+00 per=1.9e+01 cost=4.4e+06 flops=3.5e+06
 sigma_tot[gemm] counter=133 i=0 t=2.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=1 t=2.1e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=2 t=9.6e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=133 i=3 t=9.7e-01 per=1.4e+01 cost=2.0e+06 flops=2.1e+06
 sigma_tot[gemm] counter=133 i=4 t=9.7e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=133 i=5 t=9.6e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=133 total t=3.9e+00 per=5.8e+01 cost=7.7e+06 flops=2.0e+06
 sigma_tot[red] counter=133 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,4.5e-06,2.4e-06,8.7e-07,2.6e-07
settings: ndim=10 neig=1 maxcycle=30 nbuff=4 memory=1e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.328279347224 -1.116e+03  9.851e-06    1     1  5.431e-02 5.431e-02 5.428e-02
TIMING FOR Davidson : 5.433e-02  T(cal/comm/rest)=5.428e-02,9.400e-08,4.641e-05
decomposed t_rest=4.641e-05
 T(sub)    =1.076e-05 per=2.318e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =4.220e-07 per=9.092e-01
 T(xnrm2)  =4.710e-07 per=1.015e+00
 T(other)  =3.476e-05 per=7.490e+01
optimized energies: isweep=0 ibond=31 dots=1 e[0]=-116.328279347224 nmvp=1
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.316e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond31.txt
 qbond: qsuper nsym=6 dimAll=16
 (22,-2):3 (23,-3):4 (24,-2):4 (25,-3):1 (23,-1):3 (24,-4):1
timing for divide=9.1e-06
timing for compute=1.6e-02
timing for collect=3.5e-05
----- TMING FOR decimation_genbasis(nkr): 1.6e-02 S T(divide/compute[cpu/gpu/rest]/collect)=9.1e-06,1.6e-02,0.0e+00,5.2e-06,3.5e-05 -----
decimation summary: 16->3 dwt=+0.000e+00 SvN=5.810e-01
 qbond: qkept nsym=2 dimAll=3
 (23,-1):2 (24,-2):1
----- TIMING for decimation_row(nkr): 1.607e-02 S T(decim/select/formRot)=1.588e-02,1.696e-04,1.856e-05 -----
----- TIMING FOR onedot_decimation: 1.614e-02 S T(wf/decim)=4.945e-05,1.609e-02 -----
ctns::oper_renorm coord=(4,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.497e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=105 : 8.935e-03 S -----
rank=0 GPUmem(GB): used=4.225e-05 (oper)=2.124e-05
rank=0 GPUmem(GB): used=4.233e-05 (oper,site)=2.124e-05,7.451e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=105
 no. of rintermediate operators=188
 no. of coefficients=2820:2.151e-02MB:2.101e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.503e-03 S -----
rank=0 GPUmem(GB): used=6.334e-05 (oper,site,rinter)=2.124e-05,7.451e-08,2.101e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.533e-03 S size(rtasks)=105 size(Rlst2)=4 T(Rmu/Rlist)=1.103e-03,4.301e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.569e-03 S size(rtasks)=105 size(Rlst)=244 -----
rank=0 GPUmem(GB): used=6.334e-05 avail=6.176e+00 total=6.176e+00 batch[need]=2.909e-05 blksize=6 blksize0=3 batchsize=244
rank=0 GPUmem(GB): used=9.242e-05 (oper,site,rinter,batch)=2.124e-05,7.451e-08,2.101e-05,2.909e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.178e-03,2.213e-02,9.996e-03
----- TIMING FOR renorm : t_inter=7.2e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=32 t=7.2e-03 per=1.8e+01 cost=4.0e+03 flops=5.5e+05
 renorm[gemm] counter=32 i=0 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=1 t=1.0e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=2 t=7.4e-03 per=1.9e+01 cost=3.7e+02 flops=5.0e+04
 renorm[gemm] counter=32 i=3 t=7.4e-03 per=1.9e+01 cost=1.7e+03 flops=2.4e+05
 renorm[gemm] counter=32 i=4 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=5 t=1.0e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=6 t=7.4e-03 per=1.9e+01 cost=2.0e+03 flops=2.8e+05
 renorm[gemm] counter=32 total t=2.2e-02 per=5.6e+01 cost=4.1e+03 flops=1.9e+05
 renorm[red] counter=32 t=1.0e-02 per=2.5e+01 cost=8.3e+02 flops=8.3e+04
----- TIMING FOR renorm_tot : t_inter=1.9e-01 t_gemm=7.0e-01 t_reduction=3.2e-01 tot=1.2e+00 -----
 renorm_tot[inter] counter=32 t=1.9e-01 per=1.6e+01 cost=1.1e+06 flops=5.6e+06
 renorm_tot[gemm] counter=32 i=0 t=4.7e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=32 i=1 t=3.9e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=32 i=2 t=1.1e-01 per=9.2e+00 cost=2.1e+05 flops=1.9e+06
 renorm_tot[gemm] counter=32 i=3 t=1.1e-01 per=9.3e+00 cost=2.7e+05 flops=2.4e+06
 renorm_tot[gemm] counter=32 i=4 t=1.2e-01 per=1.0e+01 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=32 i=5 t=1.2e-01 per=1.0e+01 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=32 i=6 t=2.3e-01 per=1.9e+01 cost=2.8e+06 flops=1.2e+07
 renorm_tot[gemm] counter=32 total t=7.0e-01 per=5.8e+01 cost=3.8e+06 flops=5.4e+06
 renorm_tot[red] counter=32 t=3.2e-01 per=2.6e+01 cost=1.3e+06 flops=4.1e+06
qops.to_cpu: size(tot)=145:1.1e-03MB:1.1e-06GB T(to_cpu)=1.0e-04S speed=1.0e-02GB/S
check ||H-H.dagger||=7.850e-17 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.0559 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.452e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.323e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-3.502e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 2.910e-01 S #####
 T(local opt: fetch) = 3.234e-02 S  per = 11.1  per(accum) = 11.1
 T(local opt: hdiag) = 1.124e-01 S  per = 38.6  per(accum) = 49.7
 T(local opt: dvdsn) = 7.286e-02 S  per =   25  per(accum) = 74.8
 T(local opt: decim) = 1.615e-02 S  per = 5.55  per(accum) = 80.3
 T(local opt: guess) = 8.020e-05 S  per = 0.0276  per(accum) = 80.3
 T(local opt: renrm) = 5.702e-02 S  per = 19.6  per(accum) = 99.9
 T(local opt: save ) = 1.964e-04 S  per = 0.0675  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.286e-02 S  T(sum) = 7.268e-02 S  per = 9.975e+01
 T(local opt: preprocess                  ) = 1.138e-04 S  per = 0.157  per(accum) = 0.157
 T(local opt: symbolic_formulae           ) = 1.244e-02 S  per = 17.1  per(accum) = 17.3
 T(local opt: hintermediate init          ) = 2.937e-04 S  per = 0.404  per(accum) = 17.7
 T(local opt: preprocess_hformulae_Hxlist ) = 2.706e-03 S  per = 3.72  per(accum) = 21.4
 T(local opt: hmmtasks init               ) = 2.794e-03 S  per = 3.84  per(accum) = 25.2
 T(local opt: initial guess for dvdson    ) = 3.143e-06 S  per = 0.00432  per(accum) = 25.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 5.253e-02 S  per = 72.3  per(accum) = 97.5
 T(local opt: dvdson [cpu-gpu]            ) = 1.748e-03 S  per =  2.4  per(accum) = 99.9
 T(local opt: dvdson [nccl]               ) = 5.953e-06 S  per = 0.00819  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 9.400e-08 S  per = 0.000129  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.641e-05 S  per = 0.0639  per(accum) = 100
Detailed decomposition of T(renrm) = 5.702e-02 S  T(sum) = 5.702e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 9.186e-05 S  per = 0.161  per(accum) = 0.161
 T(local opt: qops init                    ) = 9.068e-04 S  per = 1.59  per(accum) = 1.75
 T(local opt: symbolic_formulae_renorm     ) = 8.949e-03 S  per = 15.7  per(accum) = 17.4
 T(local opt: allocate qops on gpu         ) = 5.802e-05 S  per = 0.102  per(accum) = 17.5
 T(local opt: site memcpy cpu2gpu          ) = 1.134e-03 S  per = 1.99  per(accum) = 19.5
 T(local opt: rintermediate init           ) = 2.513e-03 S  per = 4.41  per(accum) = 23.9
 T(local opt: preprocess_formulae_Rlist2   ) = 1.580e-03 S  per = 2.77  per(accum) = 26.7
 T(local opt: rmmtasks init                ) = 1.206e-03 S  per = 2.12  per(accum) = 28.8
 T(local opt: qops memset on cpu           ) = 6.100e-08 S  per = 0.000107  per(accum) = 28.8
 T(local opt: preprocess_renorm_batchGPU   ) = 3.939e-02 S  per = 69.1  per(accum) = 97.9
 T(local opt: deallocate cpu and gpu memory) = 3.218e-05 S  per = 0.0564  per(accum) = 98
 T(local opt: construct opS [ifdists=true] ) = 2.900e-08 S  per = 5.09e-05  per(accum) = 98
 T(local opt: reduction of opS & opH [nccl]) = 3.800e-08 S  per = 6.66e-05  per(accum) = 98
 T(local opt: qops memcpy gpu2cpu          ) = 1.115e-04 S  per = 0.196  per(accum) = 98.2
 T(local opt: reduction of opS & opH [mpi] ) = 1.471e-05 S  per = 0.0258  per(accum) = 98.2
 T(local opt: qops_pool join and erase     ) = 1.030e-03 S  per = 1.81  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.225e-06 S  per = 0.00215  per(accum) = 100
##### sweep opt: 1.843e+01 S #####
 T(sweep opt: fetch) = 4.319e-01 S  per = 2.34  per(accum) = 2.34
 T(sweep opt: hdiag) = 6.327e+00 S  per = 34.3  per(accum) = 36.7
 T(sweep opt: dvdsn) = 8.927e+00 S  per = 48.4  per(accum) = 85.1
 T(sweep opt: decim) = 3.570e-01 S  per = 1.94  per(accum) = 87.1
 T(sweep opt: guess) = 2.880e-03 S  per = 0.0156  per(accum) = 87.1
 T(sweep opt: renrm) = 2.376e+00 S  per = 12.9  per(accum) = 100
 T(sweep opt: save ) = 8.056e-03 S  per = 0.0437  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.927e+00 S  T(sum) = 8.918e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 3.215e-03 S  per = 0.036  per(accum) = 0.036
 T(sweep opt: symbolic_formulae           ) = 4.264e-01 S  per = 4.78  per(accum) = 4.82
 T(sweep opt: hintermediate init          ) = 1.121e-02 S  per = 0.126  per(accum) = 4.94
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.362e-01 S  per = 1.53  per(accum) = 6.47
 T(sweep opt: hmmtasks init               ) = 2.552e-01 S  per = 2.86  per(accum) = 9.33
 T(sweep opt: initial guess for dvdson    ) = 1.081e-04 S  per = 0.00121  per(accum) = 9.33
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.711e+00 S  per = 75.2  per(accum) = 84.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.777e-01 S  per = 1.99  per(accum) = 86.6
 T(sweep opt: dvdson [nccl]               ) = 7.622e-04 S  per = 0.00855  per(accum) = 86.6
 T(sweep opt: dvdson [mpi]                ) = 1.683e-05 S  per = 0.000189  per(accum) = 86.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.197e+00 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(renrm) = 2.376e+00 S  T(sum) = 2.376e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.061e-03 S  per = 0.171  per(accum) = 0.171
 T(sweep opt: qops init                    ) = 5.785e-02 S  per = 2.44  per(accum) = 2.61
 T(sweep opt: symbolic_formulae_renorm     ) = 4.608e-01 S  per = 19.4  per(accum) = 22
 T(sweep opt: allocate qops on gpu         ) = 1.956e-03 S  per = 0.0823  per(accum) = 22.1
 T(sweep opt: site memcpy cpu2gpu          ) = 4.332e-02 S  per = 1.82  per(accum) = 23.9
 T(sweep opt: rintermediate init           ) = 7.239e-02 S  per = 3.05  per(accum) = 27
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.408e-01 S  per = 5.93  per(accum) = 32.9
 T(sweep opt: rmmtasks init                ) = 2.605e-01 S  per =   11  per(accum) = 43.9
 T(sweep opt: qops memset on cpu           ) = 1.425e-06 S  per = 6e-05  per(accum) = 43.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.212e+00 S  per =   51  per(accum) = 94.9
 T(sweep opt: deallocate cpu and gpu memory) = 2.863e-03 S  per = 0.121  per(accum) = 95
 T(sweep opt: construct opS [ifdists=true] ) = 1.401e-06 S  per = 5.9e-05  per(accum) = 95
 T(sweep opt: reduction of opS & opH [nccl]) = 1.386e-06 S  per = 5.83e-05  per(accum) = 95
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.879e-03 S  per = 0.29  per(accum) = 95.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.316e-04 S  per = 0.0266  per(accum) = 95.3
 T(sweep opt: qops_pool join and erase     ) = 5.069e-02 S  per = 2.13  per(accum) = 97.4
 T(sweep opt: conversion from opAB to opPQ ) = 6.087e-02 S  per = 2.56  per(accum) = 100
##### global opt: 1.843e+01 S #####
 T(global opt: fetch) = 4.319e-01 S  per = 2.34  per(accum) = 2.34
 T(global opt: hdiag) = 6.327e+00 S  per = 34.3  per(accum) = 36.7
 T(global opt: dvdsn) = 8.927e+00 S  per = 48.4  per(accum) = 85.1
 T(global opt: decim) = 3.570e-01 S  per = 1.94  per(accum) = 87.1
 T(global opt: guess) = 2.880e-03 S  per = 0.0156  per(accum) = 87.1
 T(global opt: renrm) = 2.376e+00 S  per = 12.9  per(accum) = 100
 T(global opt: save ) = 8.056e-03 S  per = 0.0437  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.927e+00 S  T(sum) = 8.918e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 3.215e-03 S  per = 0.036  per(accum) = 0.036
 T(global opt: symbolic_formulae           ) = 4.264e-01 S  per = 4.78  per(accum) = 4.82
 T(global opt: hintermediate init          ) = 1.121e-02 S  per = 0.126  per(accum) = 4.94
 T(global opt: preprocess_hformulae_Hxlist ) = 1.362e-01 S  per = 1.53  per(accum) = 6.47
 T(global opt: hmmtasks init               ) = 2.552e-01 S  per = 2.86  per(accum) = 9.33
 T(global opt: initial guess for dvdson    ) = 1.081e-04 S  per = 0.00121  per(accum) = 9.33
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.711e+00 S  per = 75.2  per(accum) = 84.6
 T(global opt: dvdson [cpu-gpu]            ) = 1.777e-01 S  per = 1.99  per(accum) = 86.6
 T(global opt: dvdson [nccl]               ) = 7.622e-04 S  per = 0.00855  per(accum) = 86.6
 T(global opt: dvdson [mpi]                ) = 1.683e-05 S  per = 0.000189  per(accum) = 86.6
 T(global opt: dvdson [rest part(linalg)]  ) = 1.197e+00 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(renrm) = 2.376e+00 S  T(sum) = 2.376e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.061e-03 S  per = 0.171  per(accum) = 0.171
 T(global opt: qops init                    ) = 5.785e-02 S  per = 2.44  per(accum) = 2.61
 T(global opt: symbolic_formulae_renorm     ) = 4.608e-01 S  per = 19.4  per(accum) = 22
 T(global opt: allocate qops on gpu         ) = 1.956e-03 S  per = 0.0823  per(accum) = 22.1
 T(global opt: site memcpy cpu2gpu          ) = 4.332e-02 S  per = 1.82  per(accum) = 23.9
 T(global opt: rintermediate init           ) = 7.239e-02 S  per = 3.05  per(accum) = 27
 T(global opt: preprocess_formulae_Rlist2   ) = 1.408e-01 S  per = 5.93  per(accum) = 32.9
 T(global opt: rmmtasks init                ) = 2.605e-01 S  per =   11  per(accum) = 43.9
 T(global opt: qops memset on cpu           ) = 1.425e-06 S  per = 6e-05  per(accum) = 43.9
 T(global opt: preprocess_renorm_batchGPU   ) = 1.212e+00 S  per =   51  per(accum) = 94.9
 T(global opt: deallocate cpu and gpu memory) = 2.863e-03 S  per = 0.121  per(accum) = 95
 T(global opt: construct opS [ifdists=true] ) = 1.401e-06 S  per = 5.9e-05  per(accum) = 95
 T(global opt: reduction of opS & opH [nccl]) = 1.386e-06 S  per = 5.83e-05  per(accum) = 95
 T(global opt: qops memcpy gpu2cpu          ) = 6.879e-03 S  per = 0.29  per(accum) = 95.3
 T(global opt: reduction of opS & opH [mpi] ) = 6.316e-04 S  per = 0.0266  per(accum) = 95.3
 T(global opt: qops_pool join and erase     ) = 5.069e-02 S  per = 2.13  per(accum) = 97.4
 T(global opt: conversion from opAB to opPQ ) = 6.087e-02 S  per = 2.56  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-4.324e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=32/seqsize=34 dots=1 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1146:8.743e-03MB:8.538e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=14:1.068e-04MB:1.043e-07GB
total mem of comb=1208:9.216e-03MB:9.000e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=3,16,1
 suppl= 0 1 2
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 3
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:6 S:34 A:15 B:21 
        dim(bra,ket)=64,64 size(op)=400:3.052e-03MB size(tot)=21970:1.676e-01MB:1.637e-04GB
        per(mem): H:1.82 C:8.19 S:46.4 A:12.5 B:31.1 
 rqops: oplist=HCSPQ nops=H:1 C:32 S:8 P:28 Q:36 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
        per(mem): H:3.45 C:22.1 S:5.52 P:0 Q:69 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=24451:0.187MB:0.000182GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.325e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.675e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(64,3,4) nnz=14:1.068e-04MB
qtensor3: wf3 own=1 _data=0x4788fb90
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
 qbond: qcol nsym=2 dimAll=3
 (23,-1):2 (24,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=4 nblocks=128 size=14:1.068e-04MB
### DIAG TIMING: total=7.148e-02 t1=2.479e-05, t2=1.689e-03, t3=2.524e-03, t4=6.722e-02, t5=5.828e-06, t6=1.354e-05, t7=3.159e-06
duration_diagGPU:7.149e-02
duration_diagreduce:9.800e-08
duration_diagtransform:3.620e-07
----- TIMING FOR symbolic_formulae_onedot with size=297 : 5.134e-03 S -----
rank=0 GPUmem(GB): used=1.822e-04 (oper)=1.822e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=297
 no. of hintermediate operators=114
 no. of coefficients=1824:1.392e-02MB:1.359e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.262e-04 S -----
rank=0 GPUmem(GB): used=1.958e-04 (oper,hinter)=1.822e-04,1.359e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.308e-03 S size(H_formulae)=297 size(Hxlst2)=4 T(Hmu/Hxlist)=6.710e-04,6.369e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.350e-03 S size(H_formulae)=297 size(Hxlst)=438 -----
rank=0 GPUmem(GB): used=1.958e-04 avail=6.176e+00 total=6.176e+00 dvdson[need]=2.086e-07 batch[need]=4.895e-05 blksize=6 blksize0=2 batchsize=438
rank=0 GPUmem(GB): used=2.449e-04 (oper,hinter,dvdson,batch)=1.822e-04,1.359e-05,2.086e-07,4.895e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=14 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.040e-04,9.967e-03,3.020e-02,1.250e-02,5.307e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=3.990e-04 speed=5.228e-04GB/S T(nccl)=4.945e-06 speed=4.219e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.3e-02 -----
 sigma[inter] counter=134 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=134 i=0 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=1 t=1.1e-06 per=2.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=2 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=134 i=3 t=7.6e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=134 i=4 t=7.6e-03 per=1.4e+01 cost=3.7e+03 flops=4.9e+05
 sigma[gemm] counter=134 i=5 t=7.6e-03 per=1.4e+01 cost=3.6e+03 flops=4.7e+05
 sigma[gemm] counter=134 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=134 t=1.2e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.9e+00 t_reduction=1.6e+00 tot=6.7e+00 -----
 sigma_tot[inter] counter=134 t=1.3e+00 per=1.9e+01 cost=4.4e+06 flops=3.5e+06
 sigma_tot[gemm] counter=134 i=0 t=2.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=1 t=2.1e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=2 t=9.7e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=134 i=3 t=9.7e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=134 i=4 t=9.8e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=134 i=5 t=9.6e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=134 total t=3.9e+00 per=5.8e+01 cost=7.7e+06 flops=2.0e+06
 sigma_tot[red] counter=134 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=9.1e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,3.8e-06,2.1e-06,6.4e-07,1.8e-07
settings: ndim=14 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.328279347224 -1.116e+03  1.121e-02    1     1  5.318e-02 5.318e-02 5.316e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.667e-03,9.861e-03,3.011e-02,1.251e-02,5.415e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=1.663e-03 speed=1.255e-04GB/S T(nccl)=4.847e-06 speed=4.304e-02GB/S
----- TIMING FOR sigma : t_inter=9.9e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.2e-02 -----
 sigma[inter] counter=135 t=9.9e-03 per=1.9e+01 cost=4.6e+03 flops=4.7e+05
 sigma[gemm] counter=135 i=0 t=2.8e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=2 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.3e+05
 sigma[gemm] counter=135 i=3 t=7.6e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=135 i=4 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=135 i=5 t=7.5e-03 per=1.4e+01 cost=3.6e+03 flops=4.8e+05
 sigma[gemm] counter=135 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=135 t=1.3e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.9e+00 t_reduction=1.6e+00 tot=6.8e+00 -----
 sigma_tot[inter] counter=135 t=1.3e+00 per=1.9e+01 cost=4.4e+06 flops=3.5e+06
 sigma_tot[gemm] counter=135 i=0 t=2.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=1 t=2.1e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=2 t=9.8e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=135 i=3 t=9.8e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=135 i=4 t=9.8e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=135 i=5 t=9.7e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=135 total t=3.9e+00 per=5.8e+01 cost=7.7e+06 flops=2.0e+06
 sigma_tot[red] counter=135 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.0e-05,3.4e-06,8.7e-07,2.0e-07
    2   0 -    -116.328864816862 -5.855e-04  3.175e-03    2     2  1.207e-01 6.036e-02 5.370e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.206e-03,1.000e-02,3.032e-02,1.257e-02,5.511e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=2.200e-03 speed=9.481e-05GB/S T(nccl)=5.876e-06 speed=3.550e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=136 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.6e+05
 sigma[gemm] counter=136 i=0 t=1.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=1 t=1.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=2 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.3e+05
 sigma[gemm] counter=136 i=3 t=7.6e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=136 i=4 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=136 i=5 t=7.6e-03 per=1.4e+01 cost=3.6e+03 flops=4.7e+05
 sigma[gemm] counter=136 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.5e+05
 sigma[red] counter=136 t=1.3e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=3.9e+00 t_reduction=1.6e+00 tot=6.9e+00 -----
 sigma_tot[inter] counter=136 t=1.3e+00 per=1.9e+01 cost=4.4e+06 flops=3.4e+06
 sigma_tot[gemm] counter=136 i=0 t=2.4e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=1 t=2.1e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=2 t=9.9e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=136 i=3 t=9.9e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=136 i=4 t=9.9e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=136 i=5 t=9.8e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=136 total t=3.9e+00 per=5.8e+01 cost=7.7e+06 flops=2.0e+06
 sigma_tot[red] counter=136 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,3.0e-06,1.0e-06,2.3e-07
    3   0 -    -116.328903031272 -3.821e-05  5.925e-04    3     3  1.887e-01 6.290e-02 5.420e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.812e-03,1.014e-02,2.988e-02,1.259e-02,5.443e-02
 analyze_tgpu[Hx]: ndim=14:1.043e-07GB T(cpu-gpu)=1.806e-03 speed=1.155e-04GB/S T(nccl)=5.904e-06 speed=3.533e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.3e-02 -----
 sigma[inter] counter=137 t=1.0e-02 per=1.9e+01 cost=4.6e+03 flops=4.5e+05
 sigma[gemm] counter=137 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=2 t=7.5e-03 per=1.4e+01 cost=1.8e+03 flops=2.3e+05
 sigma[gemm] counter=137 i=3 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.2e+05
 sigma[gemm] counter=137 i=4 t=7.5e-03 per=1.4e+01 cost=3.7e+03 flops=5.0e+05
 sigma[gemm] counter=137 i=5 t=7.5e-03 per=1.4e+01 cost=3.6e+03 flops=4.8e+05
 sigma[gemm] counter=137 total t=3.0e-02 per=5.7e+01 cost=1.1e+04 flops=3.6e+05
 sigma[red] counter=137 t=1.3e-02 per=2.4e+01 cost=3.2e+03 flops=2.6e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=4.0e+00 t_reduction=1.6e+00 tot=6.9e+00 -----
 sigma_tot[inter] counter=137 t=1.3e+00 per=1.9e+01 cost=4.4e+06 flops=3.4e+06
 sigma_tot[gemm] counter=137 i=0 t=2.5e-04 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=1 t=2.1e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=2 t=9.9e-01 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=137 i=3 t=1.0e+00 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=137 i=4 t=1.0e+00 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=137 i=5 t=9.9e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=137 total t=4.0e+00 per=5.8e+01 cost=7.7e+06 flops=1.9e+06
 sigma_tot[red] counter=137 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.3e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,3.1e-06,9.7e-07,2.0e-07
    4   0 +    -116.328903814930 -7.837e-07  7.417e-05    3     4  2.523e-01 6.306e-02 5.428e-02
TIMING FOR Davidson : 2.523e-01  T(cal/comm/rest)=2.171e-01,4.740e-07,3.513e-02
decomposed t_rest=3.513e-02
 T(sub)    =7.274e-05 per=2.071e-01
 T(precond)=3.489e-02 per=9.933e+01
 T(ortho)  =4.463e-05 per=1.270e-01
 T(xcopy)  =6.200e-07 per=1.765e-03
 T(xnrm2)  =1.142e-05 per=3.251e-02
 T(other)  =1.060e-04 per=3.018e-01
optimized energies: isweep=0 ibond=32 dots=1 e[0]=-116.328903814930 nmvp=4
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.395e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond32.txt
 qbond: qsuper nsym=6 dimAll=12
 (23,-1):2 (24,-2):3 (25,-1):3 (26,-2):1 (24,0):2 (25,-3):1
timing for divide=1.1e-05
timing for compute=1.1e-02
timing for collect=2.7e-05
----- TMING FOR decimation_genbasis(nkr): 1.1e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.1e-05,1.1e-02,0.0e+00,4.5e-06,2.7e-05 -----
decimation summary: 12->5 dwt=-2.220e-16 SvN=6.547e-01
 qbond: qkept nsym=3 dimAll=5
 (25,-1):3 (26,-2):1 (24,0):1
----- TIMING for decimation_row(nkr): 1.120e-02 S T(decim/select/formRot)=1.099e-02,1.932e-04,2.127e-05 -----
----- TIMING FOR onedot_decimation: 1.128e-02 S T(wf/decim)=5.644e-05,1.122e-02 -----
ctns::oper_renorm coord=(3,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=5,5 size(op)=11:8.392e-05MB size(tot)=266:2.029e-03MB:1.982e-06GB
        per(mem): H:4.14 C:38.3 S:6.77 P:1.13 Q:49.6 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.043e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 6.260e-03 S -----
rank=0 GPUmem(GB): used=3.406e-05 (oper)=2.047e-05
rank=0 GPUmem(GB): used=3.415e-05 (oper,site)=2.047e-05,8.941e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=77
 no. of rintermediate operators=114
 no. of coefficients=1824:1.392e-02MB:1.359e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.537e-03 S -----
rank=0 GPUmem(GB): used=4.774e-05 (oper,site,rinter)=2.047e-05,8.941e-08,1.359e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.486e-03 S size(rtasks)=77 size(Rlst2)=9 T(Rmu/Rlist)=9.494e-04,5.367e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.533e-03 S size(rtasks)=77 size(Rlst)=246 -----
rank=0 GPUmem(GB): used=4.774e-05 avail=6.176e+00 total=6.176e+00 batch[need]=3.849e-05 blksize=9 blksize0=2 batchsize=246
rank=0 GPUmem(GB): used=8.623e-05 (oper,site,rinter,batch)=2.047e-05,8.941e-08,1.359e-05,3.849e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.067e-03,2.270e-02,9.933e-03
----- TIMING FOR renorm : t_inter=7.1e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=4.0e-02 -----
 renorm[inter] counter=33 t=7.1e-03 per=1.8e+01 cost=2.3e+03 flops=3.3e+05
 renorm[gemm] counter=33 i=0 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=2 t=7.6e-03 per=1.9e+01 cost=5.3e+02 flops=6.9e+04
 renorm[gemm] counter=33 i=3 t=7.6e-03 per=1.9e+01 cost=1.3e+03 flops=1.7e+05
 renorm[gemm] counter=33 i=4 t=9.4e-07 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=5 t=9.3e-07 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=6 t=7.5e-03 per=1.9e+01 cost=4.0e+03 flops=5.3e+05
 renorm[gemm] counter=33 total t=2.3e-02 per=5.7e+01 cost=5.8e+03 flops=2.6e+05
 renorm[red] counter=33 t=9.9e-03 per=2.5e+01 cost=2.7e+03 flops=2.7e+05
----- TIMING FOR renorm_tot : t_inter=2.0e-01 t_gemm=7.2e-01 t_reduction=3.3e-01 tot=1.2e+00 -----
 renorm_tot[inter] counter=33 t=2.0e-01 per=1.6e+01 cost=1.1e+06 flops=5.5e+06
 renorm_tot[gemm] counter=33 i=0 t=4.8e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=33 i=1 t=4.0e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=33 i=2 t=1.2e-01 per=9.5e+00 cost=2.1e+05 flops=1.8e+06
 renorm_tot[gemm] counter=33 i=3 t=1.2e-01 per=9.7e+00 cost=2.7e+05 flops=2.3e+06
 renorm_tot[gemm] counter=33 i=4 t=1.2e-01 per=9.8e+00 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=33 i=5 t=1.2e-01 per=9.7e+00 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=33 i=6 t=2.4e-01 per=1.9e+01 cost=2.8e+06 flops=1.2e+07
 renorm_tot[gemm] counter=33 total t=7.2e-01 per=5.8e+01 cost=3.8e+06 flops=5.3e+06
 renorm_tot[red] counter=33 t=3.3e-01 per=2.6e+01 cost=1.3e+06 flops=4.0e+06
qops.to_cpu: size(tot)=266:2.0e-03MB:2.0e-06GB T(to_cpu)=8.1e-05S speed=2.4e-02GB/S
check ||H-H.dagger||=7.536e-15 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0529 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.513e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.443e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-4.619e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 4.095e-01 S #####
 T(local opt: fetch) = 1.105e-02 S  per =  2.7  per(accum) = 2.7
 T(local opt: hdiag) = 7.154e-02 S  per = 17.5  per(accum) = 20.2
 T(local opt: dvdsn) = 2.611e-01 S  per = 63.8  per(accum) = 83.9
 T(local opt: decim) = 1.129e-02 S  per = 2.76  per(accum) = 86.7
 T(local opt: guess) = 1.067e-04 S  per = 0.0261  per(accum) = 86.7
 T(local opt: renrm) = 5.409e-02 S  per = 13.2  per(accum) = 99.9
 T(local opt: save ) = 2.861e-04 S  per = 0.0699  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.611e-01 S  T(sum) = 2.610e-01 S  per = 9.994e+01
 T(local opt: preprocess                  ) = 2.102e-04 S  per = 0.0805  per(accum) = 0.0805
 T(local opt: symbolic_formulae           ) = 5.144e-03 S  per = 1.97  per(accum) = 2.05
 T(local opt: hintermediate init          ) = 1.405e-04 S  per = 0.0538  per(accum) = 2.11
 T(local opt: preprocess_hformulae_Hxlist ) = 1.366e-03 S  per = 0.523  per(accum) = 2.63
 T(local opt: hmmtasks init               ) = 1.844e-03 S  per = 0.707  per(accum) = 3.34
 T(local opt: initial guess for dvdson    ) = 2.473e-06 S  per = 0.000948  per(accum) = 3.34
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.110e-01 S  per = 80.9  per(accum) = 84.2
 T(local opt: dvdson [cpu-gpu]            ) = 6.068e-03 S  per = 2.33  per(accum) = 86.5
 T(local opt: dvdson [nccl]               ) = 2.157e-05 S  per = 0.00827  per(accum) = 86.5
 T(local opt: dvdson [mpi]                ) = 4.740e-07 S  per = 0.000182  per(accum) = 86.5
 T(local opt: dvdson [rest part(linalg)]  ) = 3.513e-02 S  per = 13.5  per(accum) = 100
Detailed decomposition of T(renrm) = 5.409e-02 S  T(sum) = 5.409e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.890e-05 S  per = 0.146  per(accum) = 0.146
 T(local opt: qops init                    ) = 8.516e-04 S  per = 1.57  per(accum) = 1.72
 T(local opt: symbolic_formulae_renorm     ) = 6.319e-03 S  per = 11.7  per(accum) = 13.4
 T(local opt: allocate qops on gpu         ) = 9.291e-05 S  per = 0.172  per(accum) = 13.6
 T(local opt: site memcpy cpu2gpu          ) = 2.890e-04 S  per = 0.534  per(accum) = 14.1
 T(local opt: rintermediate init           ) = 2.549e-03 S  per = 4.71  per(accum) = 18.8
 T(local opt: preprocess_formulae_Rlist2   ) = 1.546e-03 S  per = 2.86  per(accum) = 21.7
 T(local opt: rmmtasks init                ) = 1.368e-03 S  per = 2.53  per(accum) = 24.2
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 6.47e-05  per(accum) = 24.2
 T(local opt: preprocess_renorm_batchGPU   ) = 3.978e-02 S  per = 73.6  per(accum) = 97.8
 T(local opt: deallocate cpu and gpu memory) = 2.935e-05 S  per = 0.0543  per(accum) = 97.8
 T(local opt: construct opS [ifdists=true] ) = 3.300e-08 S  per = 6.1e-05  per(accum) = 97.8
 T(local opt: reduction of opS & opH [nccl]) = 3.700e-08 S  per = 6.84e-05  per(accum) = 97.8
 T(local opt: qops memcpy gpu2cpu          ) = 8.802e-05 S  per = 0.163  per(accum) = 98
 T(local opt: reduction of opS & opH [mpi] ) = 1.565e-05 S  per = 0.0289  per(accum) = 98
 T(local opt: qops_pool join and erase     ) = 1.077e-03 S  per = 1.99  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.351e-06 S  per = 0.0025  per(accum) = 100
##### sweep opt: 1.884e+01 S #####
 T(sweep opt: fetch) = 4.429e-01 S  per = 2.35  per(accum) = 2.35
 T(sweep opt: hdiag) = 6.399e+00 S  per =   34  per(accum) = 36.3
 T(sweep opt: dvdsn) = 9.188e+00 S  per = 48.8  per(accum) = 85.1
 T(sweep opt: decim) = 3.683e-01 S  per = 1.95  per(accum) = 87
 T(sweep opt: guess) = 2.987e-03 S  per = 0.0159  per(accum) = 87.1
 T(sweep opt: renrm) = 2.430e+00 S  per = 12.9  per(accum) = 100
 T(sweep opt: save ) = 8.342e-03 S  per = 0.0443  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.188e+00 S  T(sum) = 9.179e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 3.425e-03 S  per = 0.0373  per(accum) = 0.0373
 T(sweep opt: symbolic_formulae           ) = 4.315e-01 S  per =  4.7  per(accum) = 4.74
 T(sweep opt: hintermediate init          ) = 1.135e-02 S  per = 0.124  per(accum) = 4.86
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.375e-01 S  per =  1.5  per(accum) = 6.36
 T(sweep opt: hmmtasks init               ) = 2.570e-01 S  per =  2.8  per(accum) = 9.16
 T(sweep opt: initial guess for dvdson    ) = 1.106e-04 S  per = 0.0012  per(accum) = 9.16
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.922e+00 S  per = 75.4  per(accum) = 84.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.838e-01 S  per =    2  per(accum) = 86.6
 T(sweep opt: dvdson [nccl]               ) = 7.838e-04 S  per = 0.00854  per(accum) = 86.6
 T(sweep opt: dvdson [mpi]                ) = 1.730e-05 S  per = 0.000189  per(accum) = 86.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.232e+00 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(renrm) = 2.430e+00 S  T(sum) = 2.430e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.140e-03 S  per = 0.17  per(accum) = 0.17
 T(sweep opt: qops init                    ) = 5.870e-02 S  per = 2.42  per(accum) = 2.59
 T(sweep opt: symbolic_formulae_renorm     ) = 4.672e-01 S  per = 19.2  per(accum) = 21.8
 T(sweep opt: allocate qops on gpu         ) = 2.049e-03 S  per = 0.0843  per(accum) = 21.9
 T(sweep opt: site memcpy cpu2gpu          ) = 4.361e-02 S  per = 1.79  per(accum) = 23.7
 T(sweep opt: rintermediate init           ) = 7.494e-02 S  per = 3.08  per(accum) = 26.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.424e-01 S  per = 5.86  per(accum) = 32.6
 T(sweep opt: rmmtasks init                ) = 2.619e-01 S  per = 10.8  per(accum) = 43.4
 T(sweep opt: qops memset on cpu           ) = 1.460e-06 S  per = 6.01e-05  per(accum) = 43.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.252e+00 S  per = 51.5  per(accum) = 94.9
 T(sweep opt: deallocate cpu and gpu memory) = 2.893e-03 S  per = 0.119  per(accum) = 95.1
 T(sweep opt: construct opS [ifdists=true] ) = 1.434e-06 S  per = 5.9e-05  per(accum) = 95.1
 T(sweep opt: reduction of opS & opH [nccl]) = 1.423e-06 S  per = 5.86e-05  per(accum) = 95.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.967e-03 S  per = 0.287  per(accum) = 95.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.473e-04 S  per = 0.0266  per(accum) = 95.4
 T(sweep opt: qops_pool join and erase     ) = 5.177e-02 S  per = 2.13  per(accum) = 97.5
 T(sweep opt: conversion from opAB to opPQ ) = 6.087e-02 S  per = 2.51  per(accum) = 100
##### global opt: 1.884e+01 S #####
 T(global opt: fetch) = 4.429e-01 S  per = 2.35  per(accum) = 2.35
 T(global opt: hdiag) = 6.399e+00 S  per =   34  per(accum) = 36.3
 T(global opt: dvdsn) = 9.188e+00 S  per = 48.8  per(accum) = 85.1
 T(global opt: decim) = 3.683e-01 S  per = 1.95  per(accum) = 87
 T(global opt: guess) = 2.987e-03 S  per = 0.0159  per(accum) = 87.1
 T(global opt: renrm) = 2.430e+00 S  per = 12.9  per(accum) = 100
 T(global opt: save ) = 8.342e-03 S  per = 0.0443  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.188e+00 S  T(sum) = 9.179e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 3.425e-03 S  per = 0.0373  per(accum) = 0.0373
 T(global opt: symbolic_formulae           ) = 4.315e-01 S  per =  4.7  per(accum) = 4.74
 T(global opt: hintermediate init          ) = 1.135e-02 S  per = 0.124  per(accum) = 4.86
 T(global opt: preprocess_hformulae_Hxlist ) = 1.375e-01 S  per =  1.5  per(accum) = 6.36
 T(global opt: hmmtasks init               ) = 2.570e-01 S  per =  2.8  per(accum) = 9.16
 T(global opt: initial guess for dvdson    ) = 1.106e-04 S  per = 0.0012  per(accum) = 9.16
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.922e+00 S  per = 75.4  per(accum) = 84.6
 T(global opt: dvdson [cpu-gpu]            ) = 1.838e-01 S  per =    2  per(accum) = 86.6
 T(global opt: dvdson [nccl]               ) = 7.838e-04 S  per = 0.00854  per(accum) = 86.6
 T(global opt: dvdson [mpi]                ) = 1.730e-05 S  per = 0.000189  per(accum) = 86.6
 T(global opt: dvdson [rest part(linalg)]  ) = 1.232e+00 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(renrm) = 2.430e+00 S  T(sum) = 2.430e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.140e-03 S  per = 0.17  per(accum) = 0.17
 T(global opt: qops init                    ) = 5.870e-02 S  per = 2.42  per(accum) = 2.59
 T(global opt: symbolic_formulae_renorm     ) = 4.672e-01 S  per = 19.2  per(accum) = 21.8
 T(global opt: allocate qops on gpu         ) = 2.049e-03 S  per = 0.0843  per(accum) = 21.9
 T(global opt: site memcpy cpu2gpu          ) = 4.361e-02 S  per = 1.79  per(accum) = 23.7
 T(global opt: rintermediate init           ) = 7.494e-02 S  per = 3.08  per(accum) = 26.8
 T(global opt: preprocess_formulae_Rlist2   ) = 1.424e-01 S  per = 5.86  per(accum) = 32.6
 T(global opt: rmmtasks init                ) = 2.619e-01 S  per = 10.8  per(accum) = 43.4
 T(global opt: qops memset on cpu           ) = 1.460e-06 S  per = 6.01e-05  per(accum) = 43.4
 T(global opt: preprocess_renorm_batchGPU   ) = 1.252e+00 S  per = 51.5  per(accum) = 94.9
 T(global opt: deallocate cpu and gpu memory) = 2.893e-03 S  per = 0.119  per(accum) = 95.1
 T(global opt: construct opS [ifdists=true] ) = 1.434e-06 S  per = 5.9e-05  per(accum) = 95.1
 T(global opt: reduction of opS & opH [nccl]) = 1.423e-06 S  per = 5.86e-05  per(accum) = 95.1
 T(global opt: qops memcpy gpu2cpu          ) = 6.967e-03 S  per = 0.287  per(accum) = 95.3
 T(global opt: reduction of opS & opH [mpi] ) = 6.473e-04 S  per = 0.0266  per(accum) = 95.4
 T(global opt: qops_pool join and erase     ) = 5.177e-02 S  per = 2.13  per(accum) = 97.5
 T(global opt: conversion from opAB to opPQ ) = 6.087e-02 S  per = 2.51  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-3.402e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

isweep=0 ibond=33/seqsize=34 dots=1 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:3.586e-04MB:3.502e-07GB
 sites: len=20 mem=1144:8.728e-03MB:8.523e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=13:9.918e-05MB:9.686e-08GB
total mem of comb=1205:9.193e-03MB:8.978e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc)=2,17,1
 suppl= 0 1
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 2
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:4 S:36 A:6 B:10 
        dim(bra,ket)=16,16 size(op)=36:2.747e-04MB size(tot)=1352:1.031e-02MB:1.007e-05GB
        per(mem): H:2.66 C:7.1 S:63.9 A:5.62 B:20.7 
 rqops: oplist=HCSPQ nops=H:1 C:34 S:6 P:15 Q:21 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=266:0.00203MB:1.98e-06GB
        per(mem): H:4.14 C:38.3 S:6.77 P:1.13 Q:49.6 
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3954:0.0302MB:2.95e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.787e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.127e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(16,5,4) nnz=13:9.918e-05MB
qtensor3: wf3 own=1 _data=0x3c8765b0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
 qbond: qcol nsym=3 dimAll=5
 (25,-1):3 (26,-2):1 (24,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=5 nblocks=108 size=13:9.918e-05MB
### DIAG TIMING: total=1.459e-02 t1=2.954e-05, t2=2.270e-03, t3=2.499e-03, t4=9.764e-03, t5=4.460e-06, t6=1.740e-05, t7=3.818e-06
duration_diagGPU:1.460e-02
duration_diagreduce:9.600e-08
duration_diagtransform:3.680e-07
----- TIMING FOR symbolic_formulae_onedot with size=193 : 2.835e-03 S -----
rank=0 GPUmem(GB): used=2.946e-05 (oper)=2.946e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of hformulae=193
 no. of hintermediate operators=58
 no. of coefficients=986:7.523e-03MB:7.346e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 8.277e-05 S -----
rank=0 GPUmem(GB): used=3.681e-05 (oper,hinter)=2.946e-05,7.346e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 9.777e-04 S size(H_formulae)=193 size(Hxlst2)=5 T(Hmu/Hxlist)=4.014e-04,5.762e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.043e-03 S size(H_formulae)=193 size(Hxlst)=448 -----
rank=0 GPUmem(GB): used=3.681e-05 avail=6.176e+00 total=6.176e+00 dvdson[need]=1.937e-07 batch[need]=5.341e-05 blksize=6 blksize0=3 batchsize=448
rank=0 GPUmem(GB): used=9.041e-05 (oper,hinter,dvdson,batch)=2.946e-05,7.346e-06,1.937e-07,5.341e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=13 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.152e-03,1.003e-02,2.993e-02,1.232e-02,5.443e-02
 analyze_tgpu[Hx]: ndim=13:9.686e-08GB T(cpu-gpu)=2.147e-03 speed=9.024e-05GB/S T(nccl)=5.024e-06 speed=3.856e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-02 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.2e-02 -----
 sigma[inter] counter=138 t=1.0e-02 per=1.9e+01 cost=7.1e+03 flops=7.1e+05
 sigma[gemm] counter=138 i=0 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=1 t=1.0e-06 per=2.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=2 t=7.4e-03 per=1.4e+01 cost=1.8e+03 flops=2.4e+05
 sigma[gemm] counter=138 i=3 t=7.5e-03 per=1.4e+01 cost=1.7e+03 flops=2.3e+05
 sigma[gemm] counter=138 i=4 t=7.5e-03 per=1.4e+01 cost=1.5e+03 flops=2.0e+05
 sigma[gemm] counter=138 i=5 t=7.5e-03 per=1.4e+01 cost=1.4e+03 flops=1.8e+05
 sigma[gemm] counter=138 total t=3.0e-02 per=5.7e+01 cost=6.3e+03 flops=2.1e+05
 sigma[red] counter=138 t=1.2e-02 per=2.4e+01 cost=2.6e+03 flops=2.1e+05
----- TIMING FOR sigma_tot : t_inter=1.3e+00 t_gemm=4.0e+00 t_reduction=1.6e+00 tot=7.0e+00 -----
 sigma_tot[inter] counter=138 t=1.3e+00 per=1.9e+01 cost=4.5e+06 flops=3.4e+06
 sigma_tot[gemm] counter=138 i=0 t=2.5e-04 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=1 t=2.2e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=2 t=1.0e+00 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=138 i=3 t=1.0e+00 per=1.4e+01 cost=2.0e+06 flops=2.0e+06
 sigma_tot[gemm] counter=138 i=4 t=1.0e+00 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=138 i=5 t=9.9e-01 per=1.4e+01 cost=1.9e+06 flops=1.9e+06
 sigma_tot[gemm] counter=138 total t=4.0e+00 per=5.8e+01 cost=7.7e+06 flops=1.9e+06
 sigma_tot[red] counter=138 t=1.6e+00 per=2.4e+01 cost=2.0e+06 flops=1.2e+06
T(sub)=9.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,3.9e-06,2.0e-06,6.7e-07,1.6e-07
settings: ndim=13 neig=1 maxcycle=30 nbuff=4 memory=1e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.328903814930 -1.116e+03  6.275e-05    1     1  5.454e-02 5.454e-02 5.452e-02
TIMING FOR Davidson : 5.456e-02  T(cal/comm/rest)=5.452e-02,7.900e-08,4.712e-05
decomposed t_rest=4.712e-05
 T(sub)    =9.520e-06 per=2.020e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =3.750e-07 per=7.958e-01
 T(xnrm2)  =3.510e-07 per=7.448e-01
 T(other)  =3.688e-05 per=7.826e+01
optimized energies: isweep=0 ibond=33 dots=1 e[0]=-116.328903814930 nmvp=1
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.749e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond33.txt
 qbond: qsuper nsym=8 dimAll=20
 (25,-1):4 (26,-2):4 (24,0):1 (27,-1):4 (28,-2):1 (26,0):4 (25,1):1 (27,-3):1
timing for divide=1.0e-05
timing for compute=1.0e-02
timing for collect=3.5e-05
----- TMING FOR decimation_genbasis(nkr): 1.0e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.0e-05,1.0e-02,0.0e+00,4.6e-06,3.5e-05 -----
decimation summary: 20->4 dwt=+0.000e+00 SvN=5.393e-01
 qbond: qkept nsym=3 dimAll=4
 (27,-1):2 (28,-2):1 (26,0):1
----- TIMING for decimation_row(nkr): 1.065e-02 S T(decim/select/formRot)=1.027e-02,3.453e-04,3.455e-05 -----
----- TIMING FOR onedot_decimation: 1.074e-02 S T(wf/decim)=5.422e-05,1.069e-02 -----
ctns::oper_renorm coord=(2,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:36 S:4 P:6 Q:10 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=123:9.384e-04MB:9.164e-07GB
        per(mem): H:4.88 C:58.5 S:6.5 P:0.813 Q:29.3 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.225e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=57 : 4.411e-03 S -----
rank=0 GPUmem(GB): used=2.765e-05 (oper)=2.030e-05
rank=0 GPUmem(GB): used=2.775e-05 (oper,site)=2.030e-05,9.686e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=57
 no. of rintermediate operators=58
 no. of coefficients=986:7.523e-03MB:7.346e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.442e-03 S -----
rank=0 GPUmem(GB): used=3.509e-05 (oper,site,rinter)=2.030e-05,9.686e-08,7.346e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.347e-03 S size(rtasks)=57 size(Rlst2)=9 T(Rmu/Rlist)=6.778e-04,6.692e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.423e-03 S size(rtasks)=57 size(Rlst)=273 -----
rank=0 GPUmem(GB): used=3.509e-05 avail=6.176e+00 total=6.176e+00 batch[need]=3.254e-05 blksize=6 blksize0=3 batchsize=273
rank=0 GPUmem(GB): used=6.764e-05 (oper,site,rinter,batch)=2.030e-05,9.686e-08,7.346e-06,3.254e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.403e-03,2.220e-02,9.806e-03
----- TIMING FOR renorm : t_inter=6.4e-03 t_gemm=2.2e-02 t_reduction=9.8e-03 tot=3.8e-02 -----
 renorm[inter] counter=34 t=6.4e-03 per=1.7e+01 cost=3.6e+03 flops=5.6e+05
 renorm[gemm] counter=34 i=0 t=1.8e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=1 t=1.5e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=2 t=7.5e-03 per=1.9e+01 cost=7.0e+02 flops=9.4e+04
 renorm[gemm] counter=34 i=3 t=7.4e-03 per=1.9e+01 cost=1.5e+03 flops=2.1e+05
 renorm[gemm] counter=34 i=4 t=1.5e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=5 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=6 t=7.4e-03 per=1.9e+01 cost=2.4e+03 flops=3.2e+05
 renorm[gemm] counter=34 total t=2.2e-02 per=5.8e+01 cost=4.6e+03 flops=2.1e+05
 renorm[red] counter=34 t=9.8e-03 per=2.6e+01 cost=1.2e+03 flops=1.2e+05
----- TIMING FOR renorm_tot : t_inter=2.0e-01 t_gemm=7.5e-01 t_reduction=3.4e-01 tot=1.3e+00 -----
 renorm_tot[inter] counter=34 t=2.0e-01 per=1.6e+01 cost=1.1e+06 flops=5.3e+06
 renorm_tot[gemm] counter=34 i=0 t=5.0e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=34 i=1 t=4.2e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=34 i=2 t=1.3e-01 per=9.8e+00 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=34 i=3 t=1.3e-01 per=9.9e+00 cost=2.8e+05 flops=2.2e+06
 renorm_tot[gemm] counter=34 i=4 t=1.2e-01 per=9.5e+00 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=34 i=5 t=1.2e-01 per=9.5e+00 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=34 i=6 t=2.5e-01 per=1.9e+01 cost=2.8e+06 flops=1.1e+07
 renorm_tot[gemm] counter=34 total t=7.5e-01 per=5.8e+01 cost=3.8e+06 flops=5.1e+06
 renorm_tot[red] counter=34 t=3.4e-01 per=2.6e+01 cost=1.3e+06 flops=3.9e+06
qops.to_cpu: size(tot)=123:9.4e-04MB:9.2e-07GB T(to_cpu)=8.1e-05S speed=1.1e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0505 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.862e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.187e-03 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-5.513e-07 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
##### local opt: 1.491e-01 S #####
 T(local opt: fetch) = 1.090e-02 S  per = 7.31  per(accum) = 7.31
 T(local opt: hdiag) = 1.464e-02 S  per = 9.82  per(accum) = 17.1
 T(local opt: dvdsn) = 6.068e-02 S  per = 40.7  per(accum) = 57.8
 T(local opt: decim) = 1.076e-02 S  per = 7.21  per(accum) = 65
 T(local opt: guess) = 1.511e-04 S  per = 0.101  per(accum) = 65.1
 T(local opt: renrm) = 5.171e-02 S  per = 34.7  per(accum) = 99.8
 T(local opt: save ) = 2.974e-04 S  per = 0.199  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.068e-02 S  T(sum) = 6.053e-02 S  per = 9.976e+01
 T(local opt: preprocess                  ) = 1.836e-04 S  per = 0.303  per(accum) = 0.303
 T(local opt: symbolic_formulae           ) = 2.844e-03 S  per =  4.7  per(accum) = 5
 T(local opt: hintermediate init          ) = 9.582e-05 S  per = 0.158  per(accum) = 5.16
 T(local opt: preprocess_hformulae_Hxlist ) = 1.059e-03 S  per = 1.75  per(accum) = 6.91
 T(local opt: hmmtasks init               ) = 1.784e-03 S  per = 2.95  per(accum) = 9.86
 T(local opt: initial guess for dvdson    ) = 2.497e-06 S  per = 0.00413  per(accum) = 9.86
 T(local opt: dvdson [Hx_batchGPU]        ) = 5.237e-02 S  per = 86.5  per(accum) = 96.4
 T(local opt: dvdson [cpu-gpu]            ) = 2.147e-03 S  per = 3.55  per(accum) = 99.9
 T(local opt: dvdson [nccl]               ) = 5.024e-06 S  per = 0.0083  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 7.900e-08 S  per = 0.000131  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.712e-05 S  per = 0.0779  per(accum) = 100
Detailed decomposition of T(renrm) = 5.171e-02 S  T(sum) = 5.171e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.669e-04 S  per = 0.323  per(accum) = 0.323
 T(local opt: qops init                    ) = 8.669e-04 S  per = 1.68  per(accum) = 2
 T(local opt: symbolic_formulae_renorm     ) = 4.425e-03 S  per = 8.56  per(accum) = 10.6
 T(local opt: allocate qops on gpu         ) = 6.680e-05 S  per = 0.129  per(accum) = 10.7
 T(local opt: site memcpy cpu2gpu          ) = 4.458e-04 S  per = 0.862  per(accum) = 11.5
 T(local opt: rintermediate init           ) = 2.458e-03 S  per = 4.75  per(accum) = 16.3
 T(local opt: preprocess_formulae_Rlist2   ) = 1.443e-03 S  per = 2.79  per(accum) = 19.1
 T(local opt: rmmtasks init                ) = 2.165e-03 S  per = 4.19  per(accum) = 23.3
 T(local opt: qops memset on cpu           ) = 4.800e-08 S  per = 9.28e-05  per(accum) = 23.3
 T(local opt: preprocess_renorm_batchGPU   ) = 3.852e-02 S  per = 74.5  per(accum) = 97.8
 T(local opt: deallocate cpu and gpu memory) = 3.636e-05 S  per = 0.0703  per(accum) = 97.8
 T(local opt: construct opS [ifdists=true] ) = 4.200e-08 S  per = 8.12e-05  per(accum) = 97.8
 T(local opt: reduction of opS & opH [nccl]) = 5.200e-08 S  per = 0.000101  per(accum) = 97.8
 T(local opt: qops memcpy gpu2cpu          ) = 8.914e-05 S  per = 0.172  per(accum) = 98
 T(local opt: reduction of opS & opH [mpi] ) = 1.925e-05 S  per = 0.0372  per(accum) = 98.1
 T(local opt: qops_pool join and erase     ) = 1.005e-03 S  per = 1.94  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.593e-06 S  per = 0.00308  per(accum) = 100
##### sweep opt: 1.899e+01 S #####
 T(sweep opt: fetch) = 4.538e-01 S  per = 2.39  per(accum) = 2.39
 T(sweep opt: hdiag) = 6.413e+00 S  per = 33.8  per(accum) = 36.2
 T(sweep opt: dvdsn) = 9.249e+00 S  per = 48.7  per(accum) = 84.9
 T(sweep opt: decim) = 3.790e-01 S  per =    2  per(accum) = 86.9
 T(sweep opt: guess) = 3.138e-03 S  per = 0.0165  per(accum) = 86.9
 T(sweep opt: renrm) = 2.482e+00 S  per = 13.1  per(accum) = 100
 T(sweep opt: save ) = 8.640e-03 S  per = 0.0455  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.249e+00 S  T(sum) = 9.240e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 3.608e-03 S  per = 0.0391  per(accum) = 0.0391
 T(sweep opt: symbolic_formulae           ) = 4.343e-01 S  per =  4.7  per(accum) = 4.74
 T(sweep opt: hintermediate init          ) = 1.144e-02 S  per = 0.124  per(accum) = 4.86
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.386e-01 S  per =  1.5  per(accum) = 6.36
 T(sweep opt: hmmtasks init               ) = 2.588e-01 S  per =  2.8  per(accum) = 9.16
 T(sweep opt: initial guess for dvdson    ) = 1.131e-04 S  per = 0.00122  per(accum) = 9.17
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.974e+00 S  per = 75.5  per(accum) = 84.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.859e-01 S  per = 2.01  per(accum) = 86.7
 T(sweep opt: dvdson [nccl]               ) = 7.888e-04 S  per = 0.00854  per(accum) = 86.7
 T(sweep opt: dvdson [mpi]                ) = 1.738e-05 S  per = 0.000188  per(accum) = 86.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.232e+00 S  per = 13.3  per(accum) = 100
Detailed decomposition of T(renrm) = 2.482e+00 S  T(sum) = 2.482e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.307e-03 S  per = 0.174  per(accum) = 0.174
 T(sweep opt: qops init                    ) = 5.957e-02 S  per =  2.4  per(accum) = 2.57
 T(sweep opt: symbolic_formulae_renorm     ) = 4.716e-01 S  per =   19  per(accum) = 21.6
 T(sweep opt: allocate qops on gpu         ) = 2.116e-03 S  per = 0.0853  per(accum) = 21.7
 T(sweep opt: site memcpy cpu2gpu          ) = 4.405e-02 S  per = 1.78  per(accum) = 23.4
 T(sweep opt: rintermediate init           ) = 7.739e-02 S  per = 3.12  per(accum) = 26.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.438e-01 S  per =  5.8  per(accum) = 32.4
 T(sweep opt: rmmtasks init                ) = 2.640e-01 S  per = 10.6  per(accum) = 43
 T(sweep opt: qops memset on cpu           ) = 1.508e-06 S  per = 6.08e-05  per(accum) = 43
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.290e+00 S  per =   52  per(accum) = 95
 T(sweep opt: deallocate cpu and gpu memory) = 2.929e-03 S  per = 0.118  per(accum) = 95.1
 T(sweep opt: construct opS [ifdists=true] ) = 1.476e-06 S  per = 5.95e-05  per(accum) = 95.1
 T(sweep opt: reduction of opS & opH [nccl]) = 1.475e-06 S  per = 5.94e-05  per(accum) = 95.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.056e-03 S  per = 0.284  per(accum) = 95.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.665e-04 S  per = 0.0269  per(accum) = 95.4
 T(sweep opt: qops_pool join and erase     ) = 5.277e-02 S  per = 2.13  per(accum) = 97.5
 T(sweep opt: conversion from opAB to opPQ ) = 6.087e-02 S  per = 2.45  per(accum) = 100
##### global opt: 1.899e+01 S #####
 T(global opt: fetch) = 4.538e-01 S  per = 2.39  per(accum) = 2.39
 T(global opt: hdiag) = 6.413e+00 S  per = 33.8  per(accum) = 36.2
 T(global opt: dvdsn) = 9.249e+00 S  per = 48.7  per(accum) = 84.9
 T(global opt: decim) = 3.790e-01 S  per =    2  per(accum) = 86.9
 T(global opt: guess) = 3.138e-03 S  per = 0.0165  per(accum) = 86.9
 T(global opt: renrm) = 2.482e+00 S  per = 13.1  per(accum) = 100
 T(global opt: save ) = 8.640e-03 S  per = 0.0455  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.249e+00 S  T(sum) = 9.240e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 3.608e-03 S  per = 0.0391  per(accum) = 0.0391
 T(global opt: symbolic_formulae           ) = 4.343e-01 S  per =  4.7  per(accum) = 4.74
 T(global opt: hintermediate init          ) = 1.144e-02 S  per = 0.124  per(accum) = 4.86
 T(global opt: preprocess_hformulae_Hxlist ) = 1.386e-01 S  per =  1.5  per(accum) = 6.36
 T(global opt: hmmtasks init               ) = 2.588e-01 S  per =  2.8  per(accum) = 9.16
 T(global opt: initial guess for dvdson    ) = 1.131e-04 S  per = 0.00122  per(accum) = 9.17
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.974e+00 S  per = 75.5  per(accum) = 84.6
 T(global opt: dvdson [cpu-gpu]            ) = 1.859e-01 S  per = 2.01  per(accum) = 86.7
 T(global opt: dvdson [nccl]               ) = 7.888e-04 S  per = 0.00854  per(accum) = 86.7
 T(global opt: dvdson [mpi]                ) = 1.738e-05 S  per = 0.000188  per(accum) = 86.7
 T(global opt: dvdson [rest part(linalg)]  ) = 1.232e+00 S  per = 13.3  per(accum) = 100
Detailed decomposition of T(renrm) = 2.482e+00 S  T(sum) = 2.482e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.307e-03 S  per = 0.174  per(accum) = 0.174
 T(global opt: qops init                    ) = 5.957e-02 S  per =  2.4  per(accum) = 2.57
 T(global opt: symbolic_formulae_renorm     ) = 4.716e-01 S  per =   19  per(accum) = 21.6
 T(global opt: allocate qops on gpu         ) = 2.116e-03 S  per = 0.0853  per(accum) = 21.7
 T(global opt: site memcpy cpu2gpu          ) = 4.405e-02 S  per = 1.78  per(accum) = 23.4
 T(global opt: rintermediate init           ) = 7.739e-02 S  per = 3.12  per(accum) = 26.6
 T(global opt: preprocess_formulae_Rlist2   ) = 1.438e-01 S  per =  5.8  per(accum) = 32.4
 T(global opt: rmmtasks init                ) = 2.640e-01 S  per = 10.6  per(accum) = 43
 T(global opt: qops memset on cpu           ) = 1.508e-06 S  per = 6.08e-05  per(accum) = 43
 T(global opt: preprocess_renorm_batchGPU   ) = 1.290e+00 S  per =   52  per(accum) = 95
 T(global opt: deallocate cpu and gpu memory) = 2.929e-03 S  per = 0.118  per(accum) = 95.1
 T(global opt: construct opS [ifdists=true] ) = 1.476e-06 S  per = 5.95e-05  per(accum) = 95.1
 T(global opt: reduction of opS & opH [nccl]) = 1.475e-06 S  per = 5.94e-05  per(accum) = 95.1
 T(global opt: qops memcpy gpu2cpu          ) = 7.056e-03 S  per = 0.284  per(accum) = 95.4
 T(global opt: reduction of opS & opH [mpi] ) = 6.665e-04 S  per = 0.0269  per(accum) = 95.4
 T(global opt: qops_pool join and erase     ) = 5.277e-02 S  per = 2.13  per(accum) = 97.5
 T(global opt: conversion from opAB to opPQ ) = 6.087e-02 S  per = 2.45  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-2.488e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

======================================================================
sweep_data::summary isweep=0 mpisize=1 maxthreads=112
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=1 dcut=100 eps=1.000e-04 noise=0.000e+00
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=1 e[0]=-116.148569549899 t=0.145
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=64 dwt=+0.000e+00 nmvp=3 e[0]=-116.178979049791 t=0.350
 ibond=2 bond=(3,0)-(4,0) forward=1 deff=3 dwt=+1.110e-16 nmvp=6 e[0]=-116.201799839537 t=0.527
 ibond=3 bond=(4,0)-(5,0) forward=1 deff=4 dwt=+0.000e+00 nmvp=5 e[0]=-116.207979653445 t=0.498
 ibond=4 bond=(5,0)-(6,0) forward=1 deff=5 dwt=-2.220e-16 nmvp=4 e[0]=-116.208089881617 t=0.508
 ibond=5 bond=(6,0)-(7,0) forward=1 deff=6 dwt=+0.000e+00 nmvp=4 e[0]=-116.208828591192 t=0.581
 ibond=6 bond=(7,0)-(8,0) forward=1 deff=6 dwt=+0.000e+00 nmvp=5 e[0]=-116.221564167486 t=0.658
 ibond=7 bond=(8,0)-(9,0) forward=1 deff=6 dwt=+0.000e+00 nmvp=5 e[0]=-116.239302101363 t=0.836
 ibond=8 bond=(9,0)-(10,0) forward=1 deff=7 dwt=+0.000e+00 nmvp=6 e[0]=-116.249940669273 t=0.972
 ibond=9 bond=(10,0)-(11,0) forward=1 deff=7 dwt=-2.220e-16 nmvp=4 e[0]=-116.251301799857 t=0.878
 ibond=10 bond=(11,0)-(12,0) forward=1 deff=7 dwt=+0.000e+00 nmvp=6 e[0]=-116.271896441599 t=0.853
 ibond=11 bond=(12,0)-(13,0) forward=1 deff=6 dwt=+1.110e-16 nmvp=6 e[0]=-116.291888550589 t=0.784
 ibond=12 bond=(13,0)-(14,0) forward=1 deff=4 dwt=+0.000e+00 nmvp=6 e[0]=-116.301384902089 t=0.692
 ibond=13 bond=(14,0)-(15,0) forward=1 deff=2 dwt=+0.000e+00 nmvp=5 e[0]=-116.309956986587 t=0.575
 ibond=14 bond=(15,0)-(16,0) forward=1 deff=3 dwt=+0.000e+00 nmvp=4 e[0]=-116.309977015224 t=0.417
 ibond=15 bond=(16,0)-(17,0) forward=1 deff=3 dwt=+1.110e-16 nmvp=5 e[0]=-116.311856917920 t=0.453
 ibond=16 bond=(17,0)-(18,0) forward=1 deff=3 dwt=+0.000e+00 nmvp=4 e[0]=-116.314230523770 t=0.347
 ibond=17 bond=(17,0)-(18,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=1 e[0]=-116.314230523770 t=0.149
 ibond=18 bond=(16,0)-(17,0) forward=0 deff=64 dwt=+0.000e+00 nmvp=1 e[0]=-116.314230523770 t=0.224
 ibond=19 bond=(15,0)-(16,0) forward=0 deff=3 dwt=+0.000e+00 nmvp=6 e[0]=-116.322004322050 t=0.493
 ibond=20 bond=(14,0)-(15,0) forward=0 deff=2 dwt=+0.000e+00 nmvp=4 e[0]=-116.322036004501 t=0.397
 ibond=21 bond=(13,0)-(14,0) forward=0 deff=4 dwt=+0.000e+00 nmvp=3 e[0]=-116.322036723062 t=0.407
 ibond=22 bond=(12,0)-(13,0) forward=0 deff=6 dwt=+0.000e+00 nmvp=6 e[0]=-116.322162108317 t=0.696
 ibond=23 bond=(11,0)-(12,0) forward=0 deff=7 dwt=-2.220e-16 nmvp=5 e[0]=-116.322363025516 t=0.762
 ibond=24 bond=(10,0)-(11,0) forward=0 deff=7 dwt=+0.000e+00 nmvp=5 e[0]=-116.323071653332 t=0.832
 ibond=25 bond=(9,0)-(10,0) forward=0 deff=7 dwt=+0.000e+00 nmvp=4 e[0]=-116.323142503667 t=0.882
 ibond=26 bond=(8,0)-(9,0) forward=0 deff=6 dwt=+0.000e+00 nmvp=3 e[0]=-116.323153873735 t=0.868
 ibond=27 bond=(7,0)-(8,0) forward=0 deff=6 dwt=+1.110e-16 nmvp=4 e[0]=-116.326036515321 t=0.761
 ibond=28 bond=(6,0)-(7,0) forward=0 deff=6 dwt=+2.220e-16 nmvp=4 e[0]=-116.328199520972 t=0.658
 ibond=29 bond=(5,0)-(6,0) forward=0 deff=5 dwt=+0.000e+00 nmvp=3 e[0]=-116.328224067176 t=0.491
 ibond=30 bond=(4,0)-(5,0) forward=0 deff=4 dwt=+1.110e-16 nmvp=4 e[0]=-116.328279347223 t=0.446
 ibond=31 bond=(3,0)-(4,0) forward=0 deff=3 dwt=+0.000e+00 nmvp=1 e[0]=-116.328279347224 t=0.291
 ibond=32 bond=(2,0)-(3,0) forward=0 deff=5 dwt=-2.220e-16 nmvp=4 e[0]=-116.328903814930 t=0.409
 ibond=33 bond=(1,0)-(2,0) forward=0 deff=4 dwt=+0.000e+00 nmvp=1 e[0]=-116.328903814930 t=0.149
 eav_max=-116.148569549899 [ibond=0]  dwt_min=-2.220e-16 [ibond=4]
 eav_min=-116.328903814930 [ibond=32]  dwt_max=2.220e-16 [ibond=28]
 eav_diff=0.180334265031
 sweep energies: isweep=0 dots=1 dcut=100 deff=5 dwt=-2.220e-16 e[0]=-116.328903814930
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0 mpisize=1 maxthreads=112
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  1     100 1.000e-04 0.000e+00 | 138 | 1.903e+01 | 1.903e+01 | 1.515e+00 4.754e+00 1.976e+00 8.244e+00 43.3
results: isweep, dcut, dwt, energies (delta_e)
            0     100 -2.220e-16 e[0]=-116.328903814930 (0.000e+00)
======================================================================
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=7.451e-09 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep0
----------------------------------------------------------------------

ctns::sweep_final_LCR2CRR: convert [LC]R => [CR]R
ctns::decimation_row ifab=1 iftrunc=1 dcut=4 nqr=8 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_C0R1.txt
 qbond: qsuper nsym=8 dimAll=16
 (27,-1):3 (28,-2):3 (26,0):1 (29,-1):3 (30,-2):1 (28,0):3 (27,1):1 (29,-3):1
timing for divide=1.025e-05
timing for compute=1.342e-02
timing for collect=1.351e-05
----- TMING FOR decimation_genbasis(nkr): 1.344e-02 S T(divide/compute[cpu/gpu/rest]/collect)=1.025e-05,1.341e-02,0.000e+00,5.360e-06,1.351e-05 -----
decimation summary: 16->2 dwt=+0.000e+00 SvN=3.629e-01
 qbond: qkept nsym=2 dimAll=2
 (29,-1):1 (28,0):1
----- TIMING for decimation_row(nkr): 1.370e-02 S T(decim/select/formRot)=1.349e-02,1.996e-04,1.775e-05 -----

ctns::sweep_final_CR2cRR: convert [C]R => [cR]R
ctns::decimation_row ifab=1 iftrunc=1 dcut=1 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_cR0.txt
 qbond: qsuper nsym=6 dimAll=8
 (29,-1):2 (28,0):1 (31,-1):1 (30,0):2 (29,1):1 (30,-2):1
timing for divide=7.110e-06
timing for compute=1.143e-02
timing for collect=6.455e-06
----- TMING FOR decimation_genbasis(nkr): 1.144e-02 S T(divide/compute[cpu/gpu/rest]/collect)=7.110e-06,1.142e-02,0.000e+00,5.371e-06,6.455e-06 -----
decimation summary: 8->1 dwt=+0.000e+00 SvN=0.000e+00
 qbond: qkept nsym=1 dimAll=1
 (30,0):1
----- TIMING for decimation_row(nkr): 1.166e-02 S T(decim/select/formRot)=1.148e-02,1.593e-04,1.446e-05 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep0 T(save)=8.15e-04S

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=16 maxdiff=0.000e+00 deviate=0
 idx=2 node=(17,0) Drow=64 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=3 maxdiff=5.275e-16 deviate=0
 idx=4 node=(15,0) Drow=2 maxdiff=6.665e-16 deviate=0
 idx=5 node=(14,0) Drow=4 maxdiff=3.331e-16 deviate=0
 idx=6 node=(13,0) Drow=6 maxdiff=9.424e-16 deviate=0
 idx=7 node=(12,0) Drow=7 maxdiff=9.691e-16 deviate=0
 idx=8 node=(11,0) Drow=7 maxdiff=8.883e-16 deviate=0
 idx=9 node=(10,0) Drow=7 maxdiff=7.260e-16 deviate=0
 idx=10 node=(9,0) Drow=6 maxdiff=9.738e-16 deviate=0
 idx=11 node=(8,0) Drow=6 maxdiff=3.147e-16 deviate=0
 idx=12 node=(7,0) Drow=6 maxdiff=7.977e-16 deviate=0
 idx=13 node=(6,0) Drow=5 maxdiff=1.144e-15 deviate=0
 idx=14 node=(5,0) Drow=4 maxdiff=1.199e-15 deviate=0
 idx=15 node=(4,0) Drow=3 maxdiff=2.220e-16 deviate=0
 idx=16 node=(3,0) Drow=5 maxdiff=3.745e-16 deviate=0
 idx=17 node=(2,0) Drow=4 maxdiff=1.016e-15 deviate=0
 idx=18 node=(1,0) Drow=2 maxdiff=4.441e-16 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=2.220e-16 deviate=0
qtensor2: wf2 own=1 _data=0x3a70ebe0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x3a70ebe0
      1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 5.511e-04 S -----
comb::display_size qkind=qNSz
 rbases: len=20 mem=47:0.000359MB:3.5e-07GB
 sites: len=20 mem=725:0.00553MB:5.4e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=2:1.53e-05MB:1.49e-08GB
total mem of comb=775:0.00591MB:5.77e-06GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-2.176e-06 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

ctns::oper_final - build Hmat for RCF at isweep=0

coord=(1,0)
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:36 S:4 P:6 Q:10 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=123:0.000938MB:9.16e-07GB
        per(mem): H:4.88 C:58.5 S:6.5 P:0.813 Q:29.3 
ctns::oper_renorm coord=(1,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:38 S:2 P:1 Q:3 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=26:0.000198MB:1.94e-07GB
        per(mem): H:7.69 C:73.1 S:3.85 P:0 Q:15.4 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.945e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=45 : 1.142e-03 S -----
rank=0 GPUmem(GB): used=1.851e-05 (oper)=1.851e-05
rank=0 GPUmem(GB): used=1.856e-05 (oper,site)=1.851e-05,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=45
 no. of rintermediate operators=20
 no. of coefficients=360:2.747e-03MB:2.682e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.510e-03 S -----
rank=0 GPUmem(GB): used=2.124e-05 (oper,site,rinter)=1.851e-05,4.470e-08,2.682e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 5.062e-04 S size(rtasks)=45 size(Rlst2)=4 T(Rmu/Rlist)=2.553e-04,2.508e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.319e-04 S size(rtasks)=45 size(Rlst)=173 -----
rank=0 GPUmem(GB): used=2.124e-05 avail=6.176e+00 total=6.176e+00 batch[need]=9.023e-06 blksize=2 blksize0=2 batchsize=173
rank=0 GPUmem(GB): used=3.026e-05 (oper,site,rinter,batch)=1.851e-05,4.470e-08,2.682e-06,9.023e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.455e-03,2.214e-02,9.879e-03
----- TIMING FOR renorm : t_inter=8.5e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=4.0e-02 -----
 renorm[inter] counter=35 t=8.5e-03 per=2.1e+01 cost=7.9e+02 flops=9.4e+04
 renorm[gemm] counter=35 i=0 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=1 t=1.0e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=2 t=7.4e-03 per=1.8e+01 cost=2.3e+02 flops=3.1e+04
 renorm[gemm] counter=35 i=3 t=7.4e-03 per=1.8e+01 cost=4.2e+02 flops=5.7e+04
 renorm[gemm] counter=35 i=4 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=5 t=1.4e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=6 t=7.4e-03 per=1.8e+01 cost=5.2e+02 flops=7.1e+04
 renorm[gemm] counter=35 total t=2.2e-02 per=5.5e+01 cost=1.2e+03 flops=5.3e+04
 renorm[red] counter=35 t=9.9e-03 per=2.4e+01 cost=3.5e+02 flops=3.5e+04
----- TIMING FOR renorm_tot : t_inter=2.1e-01 t_gemm=7.7e-01 t_reduction=3.5e-01 tot=1.3e+00 -----
 renorm_tot[inter] counter=35 t=2.1e-01 per=1.6e+01 cost=1.1e+06 flops=5.1e+06
 renorm_tot[gemm] counter=35 i=0 t=5.1e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=35 i=1 t=4.3e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=35 i=2 t=1.3e-01 per=1.0e+01 cost=2.1e+05 flops=1.6e+06
 renorm_tot[gemm] counter=35 i=3 t=1.4e-01 per=1.0e+01 cost=2.8e+05 flops=2.0e+06
 renorm_tot[gemm] counter=35 i=4 t=1.2e-01 per=9.2e+00 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=35 i=5 t=1.2e-01 per=9.2e+00 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=35 i=6 t=2.6e-01 per=1.9e+01 cost=2.8e+06 flops=1.1e+07
 renorm_tot[gemm] counter=35 total t=7.7e-01 per=5.8e+01 cost=3.8e+06 flops=5.0e+06
 renorm_tot[red] counter=35 t=3.5e-01 per=2.6e+01 cost=1.3e+06 flops=3.8e+06
qops.to_cpu: size(tot)=26:2.0e-04MB:1.9e-07GB T(to_cpu)=6.1e-05S speed=3.2e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0476 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.994e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

coord=(0,0)
 cqops: oplist=HCSABPQ nops=H:1 C:2 S:38 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): H:0.171 C:0.171 S:3.25 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=HCSPQ nops=H:1 C:38 S:2 P:1 Q:3 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=26:0.000198MB:1.94e-07GB
        per(mem): H:7.69 C:73.1 S:3.85 P:0 Q:15.4 
ctns::oper_renorm coord=(0,0) superblock=cr oplist=HCSPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=HCSPQ nops=H:1 C:40 S:0 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
        per(mem): H:100 C:0 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.138e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=41 : 3.727e-04 S -----
rank=0 GPUmem(GB): used=1.761e-05 (oper)=1.761e-05
rank=0 GPUmem(GB): used=1.762e-05 (oper,site)=1.761e-05,1.490e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of rformulae=41
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=1.762e-05 (oper,site,rinter)=1.761e-05,1.490e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 2.539e-04 S size(rtasks)=41 size(Rlst2)=1 T(Rmu/Rlist)=1.623e-04,9.157e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.732e-04 S size(rtasks)=41 size(Rlst)=54 -----
rank=0 GPUmem(GB): used=1.762e-05 avail=6.176e+00 total=6.176e+00 batch[need]=1.207e-06 blksize=1 blksize0=0 batchsize=54
rank=0 GPUmem(GB): used=1.883e-05 (oper,site,rinter,batch)=1.761e-05,1.490e-08,0.000e+00,1.207e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.883e-03,2.248e-02,9.958e-03
----- TIMING FOR renorm : t_inter=1.9e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.4e-02 -----
 renorm[inter] counter=36 t=1.9e-03 per=5.5e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=0 t=1.7e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=1 t=9.8e-07 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=2 t=7.5e-03 per=2.2e+01 cost=5.0e+01 flops=6.7e+03
 renorm[gemm] counter=36 i=3 t=7.5e-03 per=2.2e+01 cost=5.0e+01 flops=6.7e+03
 renorm[gemm] counter=36 i=4 t=1.0e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=5 t=9.6e-07 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=6 t=7.5e-03 per=2.2e+01 cost=1.1e+02 flops=1.4e+04
 renorm[gemm] counter=36 total t=2.2e-02 per=6.5e+01 cost=2.1e+02 flops=9.3e+03
 renorm[red] counter=36 t=1.0e-02 per=2.9e+01 cost=1.1e+02 flops=1.1e+04
----- TIMING FOR renorm_tot : t_inter=2.1e-01 t_gemm=7.9e-01 t_reduction=3.6e-01 tot=1.4e+00 -----
 renorm_tot[inter] counter=36 t=2.1e-01 per=1.6e+01 cost=1.1e+06 flops=5.0e+06
 renorm_tot[gemm] counter=36 i=0 t=5.3e-05 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=1 t=4.4e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=2 t=1.4e-01 per=1.0e+01 cost=2.1e+05 flops=1.5e+06
 renorm_tot[gemm] counter=36 i=3 t=1.4e-01 per=1.0e+01 cost=2.8e+05 flops=1.9e+06
 renorm_tot[gemm] counter=36 i=4 t=1.2e-01 per=9.0e+00 cost=2.1e+05 flops=1.7e+06
 renorm_tot[gemm] counter=36 i=5 t=1.2e-01 per=8.9e+00 cost=2.8e+05 flops=2.3e+06
 renorm_tot[gemm] counter=36 i=6 t=2.6e-01 per=1.9e+01 cost=2.8e+06 flops=1.1e+07
 renorm_tot[gemm] counter=36 total t=7.9e-01 per=5.8e+01 cost=3.8e+06 flops=4.8e+06
 renorm_tot[red] counter=36 t=3.6e-01 per=2.6e+01 cost=1.3e+06 flops=3.6e+06
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB T(to_cpu)=3.9e-05S speed=1.9e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.0378 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=3.935e-05 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

matrix: Hmat_isweep0 size=(1,1)
     -1.163289038149e+02 

----- TIMING FOR sweep_opt: isweep=0 : 1.917e+01 S -----

----- TIMING FOR ctns::sweep_opt : 1.918e+01 S -----
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.498e-04 heap=1.068e+00 avail=4.774e+02 total=5.033e+02 

Congrats! CTNS calculation finishes successfully. Sun Jan 12 11:19:42 2025

