
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Wed Mar  1 21:17:57 2023

GIT_HASH = 4bb9ee613a7abe1855945189aa69879cb29341a3

mpisize = 1 maxthreads = 112

input file = results/input.dat

schedule::read fname = results/input.dat
----------------------------------------------------------------------
dtype 0
nelec 5
twoms 1
integral_file moleinfo/fmole.info 
scratch ./scratch

$sci
dets 
0 1 2 3 4 
end
nroots 4
eps0 1.e-6
schedule
0 1.e-2
end
maxiter 6
$end

$ctns
verbose 1
qkind rNSz
nroots 2
maxdets 500 #000
topology_file topology/topo0
thresh_ortho 1.e-8
thresh_proj 1.e-14
schedule
# (n-th, dot, Dcut, dvdson, noise)
0 2 10 1.e-4 1.e-4
1 2 20 1.e-4 0.0
2 2 20 1.e-4 0.0
end
maxsweep 6
task_dmrg
alg_hvec 7
alg_renorm 2
$end
notice: automatically set batchgemm=2 for alg_hvec=7

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
nelec = 5
twoms = 1
integral_file = moleinfo/fmole.info

===== params_sci::print =====
nroots = 4
no. of unique seeds = 1
0-th det: 0 1 2 3 4 
flip = 0
eps0 = 1e-06
miniter = 0
maxiter = 6
schedule: iter eps1
0 0.01
1 0.01
2 0.01
3 0.01
4 0.01
5 0.01
convergence parameters
deltaE = 1e-10
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 0
load = 0
ci_file = ci.info
cthrd = 0.01

===== params_ctns::print =====
qkind = rNSz
topology_file = topology/topo0
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
task_restart = 0
rsweep = -1
rbond = -1
maxdets = 500
thresh_proj = 1.000000e-14
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
nroots = 2
guess = 1
dbranch = 0
maxsweep = 6
maxbond = -1
lastdot = 0
schedule: isweep, dots, dcut, eps, noise
0 2 10 1.000000e-04 1.000000e-04
1 2 20 1.000000e-04 0.000000e+00
2 2 20 1.000000e-04 0.000000e+00
3 2 20 1.000000e-04 0.000000e+00
4 2 20 1.000000e-04 0.000000e+00
5 2 20 1.000000e-04 0.000000e+00
alg_hvec = 7
alg_renorm = 2
ifdist1 = 0
save_formulae = 0
sort_formulae = 1
hxorder = 0
batchgemm = 2
batchsize = 10000
batchcase = 1
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
rcanon_load = 0
rcanon_file = rcanon.info
iomode = 0
ioasync = 0
iroot = 0
nsample = 100000
ndetprt = 10

io::create_scratch scratch=./scratch
rank =0 num_gpus=1 device_id=0 magma_queue=0xf3fb40
allocated gpu mem size (GB) = 3.841431e+01

ctns::topology::read fname=topology/topo0
0
1
2
3
4

ctns::topology::print ntotal=5 nphysical=5 nbackbone=5
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
rcoord:
 idx=0 coord=(4,0) node: pindex=4 type=0 center=(-1,-1) left=(3,0) right=(-2,-2)
 idx=1 coord=(3,0) node: pindex=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=2 coord=(2,0) node: pindex=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=3 coord=(1,0) node: pindex=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=4 coord=(0,0) node: pindex=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(4,0) rsupport: 4 ; lsupport: 0 1 2 3 
 idx=1 coord=(3,0) rsupport: 3 4 ; lsupport: 0 1 2 
 idx=2 coord=(2,0) rsupport: 2 3 4 ; lsupport: 0 1 
 idx=3 coord=(1,0) rsupport: 1 2 3 4 ; lsupport: 0 
 idx=4 coord=(0,0) rsupport: 0 1 2 3 4 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(4,0) corbs: 4 ; rorbs: ; lorbs: 0 1 2 3 
 idx=1 coord=(3,0) corbs: 3 ; rorbs: 4 ; lorbs: 0 1 2 
 idx=2 coord=(2,0) corbs: 2 ; rorbs: 3 4 ; lorbs: 0 1 
 idx=3 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 ; lorbs: 0 
 idx=4 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9

fci::ci_load fname=./scratch/ci.info

fci::ci_truncate maxdets=500 ifortho=1
 reduction from 52 to 52 dets
 iroot=0 ova=1.000000000000e+00
 iroot=1 ova=1.000000000000e+00
 iroot=2 ova=1.000000000000e+00
 iroot=3 ova=1.000000000000e+00

ctns::rcanon_init qkind=rNSz

ctns::init_rbases rdm_svd=1.50e+00 thresh_proj=1.00e-14

idx=
idx=01 node=
idx= node=(3,02 node=(2,)0 type=) type=(14 rsupport=12, 3 4  rsupport=0
)3 4 
 type=0ctns::right_projection<Km> thresh_proj= rsupport=4 

idx=4 node=1.00e-14ctns::right_projection<Km> thresh_proj=(
01.00e-14
,0) type=0 rsupport=0 1 2 3 4 

idx=3 node=(1,0) type=1 rsupport=1 2 3 4 
ctns::right_projection<Km> thresh_proj=1.00e-14
 qr=(0,0) dimB,dimBi=1,1 popBi=4.36e-01 popBc=4.36e-01 1-popBc=5.64e-01
ctns::right_projection<Km> thresh_proj=1.00e-14
 qr=(1,-1) dimB,dimBi=2,2 popBi=2.12e-01 popBc=6.48e-01 1-popBc=3.52e-01
 qr=(1,1) dimB,dimBi=2,2 popBi=3.09e-01 popBc=9.58e-01 1-popBc=4.24e-02
 qr=(2,-2) dimB,dimBi=1,1 popBi=8.30e-04 popBc=9.58e-01 1-popBc=4.15e-02
 qr=(2,0) dimB,dimBi=4,4 popBi=3.41e-02 popBc=9.93e-01 1-popBc=7.39e-03
 qr= qr=(2,2) dimB,dimBi=1,1 popBi=(1,1) dimB,dimBi=4.54e-03 popBc=2,29.97e-01 1-popBc= popBi=2.85e-03
2.74e-01 popBc=2.74e-01 1-popBc=7.26e-01
 qr=(3,-1) dimB,dimBi=2,2 popBi=8.28e-04 popBc=9.98e-01 1-popBc=2.02e-03
 qr=(3,1) dimB,dimBi=2,2 popBi=1.92e-03 popBc=1.00e+00 1-popBc=1.06e-04
 qr=(3,1) dimB,dimBi=12,4 popBi= qr=(4,0) dimB,dimBi=1,1 popBi=1.06e-04 popBc=1.00e+00 1-popBc=0.00e+00
 qr=7.39e-01 popBc=7.39e-01 1-popBc=2.61e-01
 qr=(2,0) dimB,dimBi=9,8 popBi=dim(space,lspace,rspace)=5.64e-01 popBc=8.38e-01 1-popBc=1.62e-01
52(5,1), dimB,dimBi=43,1652 dimBc=,416 popBi= popBc=1.00e+00 SvN=2.04e+00
----- TIMING FOR ctns::right_projection<Km> : 1.00e+003.000e-03 popBc= S -----
 qr=(2,2) dimB,dimBi=3,3 popBi=0.114 popBc=0.952 1-popBc= qr=0.0478
1 1-popBc=-2.22e-16
(4,0) dimB,dimBi=20,4 popBi=0.243 popBc=0.982 1-popBc=0.0182
dim(space,lspace,rspace)=52,1,52 dimBc=4 popBc=1 SvN=2
----- TIMING FOR ctns::right_projection<Km> :  qr=2.000e-03 S -----(3,-1)
 qr=(4,2) dimB,dimBi=8,4 popBi=0.0135 popBc=0.995 1-popBc=0.00475
 dimB,dimBi=5,4 popBi=0.00962 popBc=0.962 1-popBc=0.0382
 qr=(5,1) dimB,dimBi=12,4 popBi=0.00475 popBc=1 1-popBc=-4.44e-16
dim(space,lspace,rspace)=52,4,52 dimBc=16 popBc=1 SvN=2.46
----- TIMING FOR ctns::right_projection<Km> : 2.000e-03 S -----
 qr=(3,1) dimB,dimBi=9,9 popBi=0.0321 popBc=0.994 1-popBc=0.00605
 qr=(3,3) dimB,dimBi=1,1 popBi=0.000357 popBc=0.994 1-popBc=0.00569
 qr=(4,0) dimB,dimBi=9,8 popBi=0.005 popBc=0.999 1-popBc=0.000688
 qr=(4,2) dimB,dimBi=3,3 popBi=0.000581 popBc=1 1-popBc=0.000107
 qr=(5,1) dimB,dimBi=2,2 popBi=0.000107 popBc=1 1-popBc=5.55e-16
dim(space,lspace,rspace)=52,16,43 dimBc=40 popBc=1 SvN=2.86
----- TIMING FOR ctns::right_projection<Km> : 3.000e-03 S -----

final rbases with thresh_proj=1e-14
 idx=0 node=(4,0) type=0 shape=4,4
 idx=1 node=(3,0) type=1 shape=16,16
 idx=2 node=(2,0) type=1 shape=43,40
 idx=3 node=(1,0) type=1 shape=52,16
 idx=4 node=(0,0) type=0 shape=52,4
maximum bond dimension = 40
----- TIMING FOR ctns::init_rbases : 3.100e-02 S -----

ctns::init_rsites qkind=rNSz thresh_ortho=1e-08
 idx=0 node=(4,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 TIMING=0.000e+00 S
 idx=1 node=(3,0)[1] shape(l,r,c)=(16,4,4) maxdiff=3.163e-16 TIMING=0.000e+00 S
 idx=2 node=(2,0)[1] shape(l,r,c)=(40,16,4) maxdiff=1.995e-15 TIMING=1.000e-02 S
 idx=3 node=(1,0)[1] shape(l,r,c)=(16,40,4) maxdiff=1.810e-15 TIMING=0.000e+00 S
 idx=4 node=(0,0)[0] shape(l,r,c)=(4,16,4) maxdiff=9.494e-16 TIMING=0.000e+00 S
----- TIMING FOR ctns::init_rsites : 1.200e-02 S -----

ctns::init_rwfuns qkind=rNSz thresh_ortho=1e-08
stensor2: wf2 own=1 _data=0x478a5220
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=4
 (5,1):4
 qbond: qcol nsym=1 dimAll=4
 (5,1):4
total no. of nonzero blocks=1 nblocks=1 size=16:0.000122MB

check state overlaps ...
matrix: ova_rwfuns size=(4,4)
      1.0000e+00       6.9514e-18      -2.9241e-18      -1.0699e-17 
      6.9514e-18       1.0000e+00       9.3123e-17      -2.0232e-16 
     -2.9241e-18       9.3123e-17       1.0000e+00       1.8109e-16 
     -1.0699e-17      -2.0232e-16       1.8109e-16       1.0000e+00 
matrix: ova0_vs size=(4,4)
      1.0000e+00       0.0000e+00       1.3878e-17      -1.3878e-17 
      0.0000e+00       1.0000e+00      -1.3878e-17       5.5511e-17 
      1.3878e-17      -1.3878e-17       1.0000e+00       2.7756e-17 
     -1.3878e-17       5.5511e-17       2.7756e-17       1.0000e+00 
diff of ova matrices = 7.812e-16
----- TIMING FOR ctns::init_rwfuns : 0.000e+00 S -----
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=0 mem=0:0MB:0GB
 psi: len=0 mem=0:0MB:0GB
total mem of comb=795:0.00607MB:5.92e-06GB
----- TIMING FOR ctns::rcanon_init : 4.300e-02 S -----

ctns::rcanon_save fname=./scratch/rcanon.info

ctns::rcanon_check thresh_ortho=1.00e-08
 idx=0 node=(4,0) Dtot=4 maxdiff=0.00e+00
 idx=1 node=(3,0) Dtot=16 maxdiff=3.16e-16
 idx=2 node=(2,0) Dtot=40 maxdiff=2.00e-15
 idx=3 node=(1,0) Dtot=16 maxdiff=1.81e-15
 idx=4 node=(0,0) Dtot=4 maxdiff=9.49e-16

integral::load fname = moleinfo/fmole.info
sorb = 10
size(int1e) = 100:7.63e-04MB:7.45e-07GB
size(int2e) = 1080:8.24e-03MB:8.05e-06GB
ecore = 3.40e+00
----- TIMING FOR integral::load_integral : 0.000e+00 S -----

io::remove_scratch scratch=./scratch/sweep
successfully removed ./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=rNSz
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/cop(4,0) size=0.00111MB speed=infMB/s
fsize=0.00111MB ratio=1 usage=1.31e-06GB available=8.68e+03GB
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(4,0) size=0.00111MB speed=infMB/s
fsize=0.00111MB ratio=1 usage=2.62e-06GB available=8.68e+03GB
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/cop(3,0) size=0.00111MB speed=infMB/s
fsize=0.00111MB ratio=1 usage=3.93e-06GB available=8.68e+03GB
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/cop(2,0) size=0.00111MB speed=infMB/s
fsize=0.00111MB ratio=1 usage=5.24e-06GB available=8.68e+03GB
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/cop(1,0) size=0.00111MB speed=infMB/s
fsize=0.00111MB ratio=1 usage=6.55e-06GB available=8.68e+03GB
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/cop(0,0) size=0.00111MB speed=infMB/s
fsize=0.00111MB ratio=1 usage=7.86e-06GB available=8.68e+03GB
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(0,0) size=0.00111MB speed=infMB/s
fsize=0.00111MB ratio=1 usage=9.17e-06GB available=8.68e+03GB
----- TIMING FOR ctns::oper_init : 3.000e-03 S -----
T[ctns::oper_init](comp/save/tot)=0,0,0

idx=1 coord=(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 1.000e-03 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=12544:0.0957MB:9.35e-05GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.002  T(cal/comm)=0.002,0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(3,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=1.98e-05GB available=8.68e+03GB

idx=2 coord=(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=36 wfsize=292 worktot=102144:0.779MB:0.000761GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=40,40 size(op)=252:0.00192MB size(tot)=9246:0.0705MB:6.89e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(2,0) size=0.0705MB speed=infMB/s
fsize=0.0705MB ratio=1 usage=8.9e-05GB available=8.68e+03GB

idx=3 coord=(1,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
ctns::oper_renorm_opAll coord=(1,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=79 : 0.000e+00 S -----
preprocess for renorm: opsize=252 wfsize=356 worktot=147840:1.13MB:0.0011GB
 qops: oplist=CABPQSH nops=C:8 A:28 B:36 P:1 Q:3 S:2 H:1 
        dim(bra,ket)=16,16 size(op)=64:0.000488MB size(tot)=2336:0.0178MB:1.74e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(1,0) size=0.0178MB speed=infMB/s
fsize=0.0178MB ratio=1 usage=0.000107GB available=8.68e+03GB

idx=4 coord=(0,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
ctns::oper_renorm_opAll coord=(0,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=111 : 0.000e+00 S -----
preprocess for renorm: opsize=64 wfsize=64 worktot=28672:0.219MB:0.000214GB
 qops: oplist=CABPQSH nops=C:10 A:45 B:55 P:0 Q:0 S:0 H:1 
        dim(bra,ket)=4,4 size(op)=16:0.000122MB size(tot)=496:0.00378MB:3.7e-06GB
TIMING for Renormalization : 0  T(cal/comm)=0,0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(0,0) size=0.00378MB speed=infMB/s
fsize=0.00378MB ratio=1 usage=0.000111GB available=8.68e+03GB
----- TIMING FOR ctns::oper_env_right : 1.200e-02 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.003,0,0.004,0,0.007
matrix: Hij size=(4,4)
     -2.65451697e+00      -5.92957673e-16      -5.89486277e-16      -3.28932222e-17 
     -5.92957673e-16      -2.27865403e+00       3.92606726e-15      -2.13831049e-17 
     -5.89486277e-16       3.92620172e-15      -2.24308285e+00       5.11009468e-16 
     -3.28932222e-17      -2.14059398e-17       5.15034618e-16      -1.91229192e+00 
matrix: Sij size=(4,4)
      1.0000e+00      -8.0339e-17       9.1986e-17      -3.5887e-16 
     -7.9255e-17       1.0000e+00       1.9655e-16      -1.2091e-15 
      1.0851e-16       1.9653e-16       1.0000e+00      -1.3329e-16 
     -3.8381e-16      -1.2642e-15      -1.3334e-16       1.0000e+00 

ctns::sweep_opt maxsweep=6
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.012e-07GB
 rsites: len=5 mem=752:0.005737MB:5.603e-06GB
 rwfuns: len=4 mem=16:0.0001221MB:1.192e-07GB
 lsites: len=5 mem=4:3.052e-05MB:2.98e-08GB
 psi: len=0 mem=0:0MB:0GB
total mem of comb=799:0.006096MB:5.953e-06GB

ctns::topology::get_sweeps
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=3 bond=(1,0)-(2,0) forward=0 cturn=0
======================================================================
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0.0001
======================================================================

=== start rank=0 ibond=0
ISWEEP,IBOND=0,0

isweep=0 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=4:3.05e-05MB:2.98e-08GB
 psi: len=0 mem=0:0MB:0GB
total mem of comb=799:0.0061MB:5.95e-06GB
===== CPUmem(GB): tot=1.96e-05 (comb,oper,dvdson,hvec,renorm)=5.95e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47727880
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (0,0):1 (1,-1):2 (1,1):2 (2,-2):1 (2,0):4 (2,2):1 (3,-1):2 (3,1):2 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 1.000e-03 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.002
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=3.45e-05 (comb,oper,dvdson,hvec,renorm)=5.95e-06,1.36e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=5.8e-05
--- time_gemm_kernel=0.0782
--- time_gemm_reduction=0.00154
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.01e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=4.6e-05
--- time_gemm_kernel=0.0742
--- time_gemm_reduction=0.00113
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.06e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966941  -1.00e+03   4.48e-05    2     2   1.55e-01  7.75e-02
    1   1 +      -2.278654025976  -1.00e+03   6.71e-05    2     2   1.55e-01  7.75e-02
TIMING for Davidson : 1.55e-01  T(cal/comm/rest)=1.54e-01,0.00e+00,1.00e-03
optimized energies: isweep=0 dots=2 ibond=0 e[0]=-2.65451696694
optimized energies: isweep=0 dots=2 ibond=0 e[1]=-2.27865402598
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond0.txt
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: 16->10 dwt=+2.886e-03 SvN=1.645e+00
===== CPUmem(GB): tot=1.956e-05 (comb,oper,dvdson,hvec,renorm)=5.953e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=4 wfsize=26 worktot=9184:0.0701MB:6.84e-05GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=730:0.00557MB:5.44e-06GB
TIMING for Renormalization : 0  T(cal/comm)=0,0
===== CPUmem(GB): tot=2.81e-05 (comb,oper,dvdson,hvec,renorm)=5.95e-06,1.36e-05,0,0,8.55e-06 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=30:0.000229MB:2.24e-07GB
 psi: len=2 mem=156:0.00119MB:1.16e-06GB
total mem of comb=981:0.00748MB:7.31e-06GB
===== CPUmem(GB): tot=3.49e-05 (comb,oper,dvdson,hvec,renorm)=7.31e-06,1.9e-05,0,0,8.55e-06 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(1,0) size=0.00557MB speed=infMB/s
fsize=0.00557MB ratio=1 usage=0.000117GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 1.64e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.62e-01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 0.00e+00 S  per =    0  per(accum) = 99
 T( save) = 0.00e+00 S  per =    0  per(accum) = 99
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.62
 T(preprocess_formulae_Hxlist2) = 2.00e-03 S  per =  1.2
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per =  1.2
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.55e-01 S  per =   96
end rank=0 sweep_twodot
##### time_sweep: 1.64e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.62e-01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 0.00e+00 S  per =    0  per(accum) = 99
 T( save) = 0.00e+00 S  per =    0  per(accum) = 99
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.62
 T(preprocess_formulae_Hxlist2) = 2.00e-03 S  per =  1.2
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per =  1.2
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.55e-01 S  per =   96
##### time_global: 1.64e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.62e-01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 0.00e+00 S  per =    0  per(accum) = 99
 T( save) = 0.00e+00 S  per =    0  per(accum) = 99
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.62
 T(preprocess_formulae_Hxlist2) = 2.00e-03 S  per =  1.2
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per =  1.2
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.55e-01 S  per =   96

=== end rank=0 ibond=0

=== start rank=0 ibond=1
ISWEEP,IBOND=0,1

isweep=0 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=730:0.00557MB:5.44e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1168:0.00891MB:8.7e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=30:0.000229MB:2.24e-07GB
 psi: len=2 mem=156:0.00119MB:1.16e-06GB
total mem of comb=981:0.00748MB:7.31e-06GB
===== CPUmem(GB): tot=1.6e-05 (comb,oper,dvdson,hvec,renorm)=7.31e-06,8.7e-06,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(10,4,4,4) nnz=78:0.000595MB
stensor4: wf own=1 _data=0x477293e0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=6 dimAll=10
 (2,0):4 (3,1):2 (1,1):1 (3,-1):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=42 nblocks=384 size=78:0.000595MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 0.000e+00 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=506:0.00386MB:3.77e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=4522 blksize=4 cost=5.42e+04
total cost for Hx=5.42e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=2.07e-05 (oper,dvdson,batch)(GB)=1.25e-05,1.16e-06,7.03e-06 batchsize=118
===== CPUmem(GB): tot=2.76e-05 (comb,oper,dvdson,hvec,renorm)=7.31e-06,8.7e-06,1.16e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.7e-05
--- time_gemm_kernel=0.0599
--- time_gemm_reduction=0.000868
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.05e+05
--- preprocess_Hx_batchGPU ---
--- time_copy=3.9e-05
--- time_gemm_kernel=0.0598
--- time_gemm_reduction=0.000852
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.06e+05
settings: ndim=78 neig=2 maxcycle=30 nbuff=4 memory=1.05e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.650929828270  -1.00e+03   1.40e-02    2     2   1.21e-01  6.05e-02
    1   1 -      -2.272369769849  -1.00e+03   1.99e-02    2     2   1.21e-01  6.05e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.10e-05
--- time_gemm_kernel=5.98e-02
--- time_gemm_reduction=8.63e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.05e+05
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=5.90e-02
--- time_gemm_reduction=8.40e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.19e+05
    2   0 -      -2.651065954099  -1.36e-04   5.04e-03    4     4   2.42e-01  6.05e-02
    2   1 -      -2.272592282889  -2.23e-04   5.20e-03    4     4   2.42e-01  6.05e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.90e-05
--- time_gemm_kernel=5.85e-02
--- time_gemm_reduction=8.46e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.26e+05
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=5.69e-02
--- time_gemm_reduction=7.96e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.51e+05
    3   0 -      -2.651089357882  -2.34e-05   2.26e-03    6     6   3.59e-01  5.98e-02
    3   1 -      -2.272612963049  -2.07e-05   1.96e-03    6     6   3.59e-01  5.98e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.00e-05
--- time_gemm_kernel=5.69e-02
--- time_gemm_reduction=7.97e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.52e+05
--- preprocess_Hx_batchGPU ---
--- time_copy=3.80e-05
--- time_gemm_kernel=5.68e-02
--- time_gemm_reduction=7.91e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.53e+05
    4   0 -      -2.651092511739  -3.15e-06   6.33e-04    6     8   4.74e-01  5.93e-02
    4   1 -      -2.272617245996  -4.28e-06   1.97e-03    6     8   4.74e-01  5.93e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=5.59e-02
--- time_gemm_reduction=7.83e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.69e+05
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=5.52e-02
--- time_gemm_reduction=7.74e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.81e+05
    5   0 -      -2.651092802460  -2.91e-07   2.02e-04    6    10   5.87e-01  5.87e-02
    5   1 -      -2.316448882707  -4.38e-02   2.50e-01    6    10   5.87e-01  5.87e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=5.53e-02
--- time_gemm_reduction=7.73e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.80e+05
--- preprocess_Hx_batchGPU ---
--- time_copy=2.60e-05
--- time_gemm_kernel=5.54e-02
--- time_gemm_reduction=7.74e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.77e+05
    6   0 +      -2.651092829901  -2.74e-08   5.73e-05    6    12   7.00e-01  5.83e-02
    6   1 -      -2.403734394821  -8.73e-02   1.73e-01    6    12   7.00e-01  5.83e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=5.52e-02
--- time_gemm_reduction=7.72e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.82e+05
    7   0 +      -2.651092829966  -6.51e-11   5.62e-05    5    13   7.56e-01  5.82e-02
    7   1 -      -2.425078874454  -2.13e-02   5.75e-02    5    13   7.56e-01  5.82e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=5.52e-02
--- time_gemm_reduction=7.71e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.82e+05
    8   0 +      -2.651092829970  -3.75e-12   5.62e-05    4    14   8.12e-01  5.80e-02
    8   1 -      -2.427378302017  -2.30e-03   1.66e-02    4    14   8.12e-01  5.80e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=5.52e-02
--- time_gemm_reduction=7.70e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.81e+05
    9   0 +      -2.651092829971  -1.28e-12   5.62e-05    4    15   8.68e-01  5.79e-02
    9   1 -      -2.427604093680  -2.26e-04   7.09e-03    4    15   8.68e-01  5.79e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.00e-05
--- time_gemm_kernel=5.61e-02
--- time_gemm_reduction=7.74e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.65e+05
   10   0 +      -2.651092829975  -3.88e-12   5.61e-05    4    16   9.25e-01  5.78e-02
   10   1 -      -2.427637714348  -3.36e-05   2.47e-03    4    16   9.25e-01  5.78e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=5.46e-02
--- time_gemm_reduction=7.67e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.93e+05
   11   0 +      -2.651092830004  -2.98e-11   5.60e-05    4    17   9.80e-01  5.76e-02
   11   1 -      -2.427642189941  -4.48e-06   1.02e-03    4    17   9.80e-01  5.76e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=5.48e-02
--- time_gemm_reduction=7.92e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.88e+05
   12   0 +      -2.651092830006  -1.13e-12   5.61e-05    4    18   1.04e+00  5.76e-02
   12   1 -      -2.427642988501  -7.99e-07   3.91e-04    4    18   1.04e+00  5.76e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=5.46e-02
--- time_gemm_reduction=7.59e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.92e+05
   13   0 +      -2.651092830048  -4.21e-11   5.56e-05    4    19   1.09e+00  5.74e-02
   13   1 -      -2.427643152187  -1.64e-07   1.50e-04    4    19   1.09e+00  5.74e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=5.49e-02
--- time_gemm_reduction=7.62e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.86e+05
   14   0 +      -2.651092830084  -3.60e-11   5.58e-05    4    20   1.15e+00  5.73e-02
   14   1 +      -2.427643179122  -2.69e-08   8.55e-05    4    20   1.15e+00  5.73e-02
TIMING for Davidson : 1.15e+00  T(cal/comm/rest)=1.14e+00,0.00e+00,1.20e-02
optimized energies: isweep=0 dots=2 ibond=1 e[0]=-2.65109283008
optimized energies: isweep=0 dots=2 ibond=1 e[1]=-2.42764317912
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond1.txt
 qbond: qsuper nsym=12 dimAll=40
 (3,1):8 (4,0):8 (2,0):5 (3,-1):5 (4,2):3 (5,1):3 (2,2):2 (5,-1):2 (1,1):1 (3,3):1 (4,-2):1 (6,0):1
decimation summary: 40->10 dwt=+9.642e-03 SvN=1.843e+00
===== CPUmem(GB): tot=1.601e-05 (comb,oper,dvdson,hvec,renorm)=7.309e-06,8.702e-06,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=24 wfsize=62 worktot=23520:0.179MB:0.000175GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=775:0.00591MB:5.77e-06GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=3.79e-05 (comb,oper,dvdson,hvec,renorm)=7.31e-06,8.7e-06,0,0,2.19e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=90:0.000687MB:6.71e-07GB
 psi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=933:0.00712MB:6.95e-06GB
===== CPUmem(GB): tot=4.33e-05 (comb,oper,dvdson,hvec,renorm)=6.95e-06,1.45e-05,0,0,2.19e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(2,0) size=0.00591MB speed=infMB/s
fsize=0.00591MB ratio=1 usage=5.49e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 1.15e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.15e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.00e-03 S  per = 0.087  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.087
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.00e-03 S  per = 0.087
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.15e+00 S  per = 1e+02
end rank=0 sweep_twodot
##### time_sweep: 1.32e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.31e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.00e-03 S  per = 0.076  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.076
 T(preprocess_formulae_Hxlist2) = 3.00e-03 S  per = 0.23
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 3.00e-03 S  per = 0.23
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.30e+00 S  per =   99
##### time_global: 1.32e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.31e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.00e-03 S  per = 0.076  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.076
 T(preprocess_formulae_Hxlist2) = 3.00e-03 S  per = 0.23
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 3.00e-03 S  per = 0.23
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.30e+00 S  per =   99

=== end rank=0 ibond=1

=== start rank=0 ibond=2
ISWEEP,IBOND=0,2

isweep=0 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=730:0.00557MB:5.44e-06GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1168:0.00891MB:8.7e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=752:0.00574MB:5.6e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=90:0.000687MB:6.71e-07GB
 psi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=933:0.00712MB:6.95e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=6.95e-06,1.45e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(10,4,4,4) nnz=78:0.000595MB
stensor4: wf own=1 _data=0x473fc9d0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=6 dimAll=10
 (2,0):4 (3,1):2 (1,1):1 (3,-1):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=42 nblocks=384 size=78:0.000595MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 0.000e+00 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=506:0.00386MB:3.77e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=4522 blksize=4 cost=5.42e+04
total cost for Hx=5.42e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=2.07e-05 (oper,dvdson,batch)(GB)=1.25e-05,1.16e-06,7.03e-06 batchsize=118
===== CPUmem(GB): tot=3.31e-05 (comb,oper,dvdson,hvec,renorm)=6.95e-06,1.45e-05,1.16e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.6e-05
--- time_gemm_kernel=0.0553
--- time_gemm_reduction=0.00082
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.79e+05
--- preprocess_Hx_batchGPU ---
--- time_copy=3.9e-05
--- time_gemm_kernel=0.0552
--- time_gemm_reduction=0.000796
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.81e+05
settings: ndim=78 neig=2 maxcycle=30 nbuff=4 memory=1.05e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.640927682312  -1.00e+03   1.43e-01    2     2   1.12e-01  5.60e-02
    1   1 -      -2.405168738927  -1.00e+03   1.99e-01    2     2   1.12e-01  5.60e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.10e-05
--- time_gemm_kernel=5.54e-02
--- time_gemm_reduction=8.02e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.77e+05
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=5.52e-02
--- time_gemm_reduction=7.85e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.81e+05
    2   0 -      -2.650501602995  -9.57e-03   3.19e-02    4     4   2.24e-01  5.60e-02
    2   1 -      -2.425169084233  -2.00e-02   5.86e-02    4     4   2.24e-01  5.60e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=5.50e-02
--- time_gemm_reduction=7.80e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.85e+05
--- preprocess_Hx_batchGPU ---
--- time_copy=3.60e-05
--- time_gemm_kernel=5.49e-02
--- time_gemm_reduction=7.62e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.86e+05
    3   0 -      -2.651051838172  -5.50e-04   6.68e-03    6     6   3.36e-01  5.60e-02
    3   1 -      -2.427538237890  -2.37e-03   1.15e-02    6     6   3.36e-01  5.60e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=5.50e-02
--- time_gemm_reduction=7.73e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.84e+05
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=5.50e-02
--- time_gemm_reduction=7.82e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.85e+05
    4   0 -      -2.651086717819  -3.49e-05   2.38e-03    6     8   4.48e-01  5.60e-02
    4   1 -      -2.427625973413  -8.77e-05   4.41e-03    6     8   4.48e-01  5.60e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=5.49e-02
--- time_gemm_reduction=7.65e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.86e+05
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=5.50e-02
--- time_gemm_reduction=7.69e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.85e+05
    5   0 -      -2.651091761828  -5.04e-06   1.21e-03    6    10   5.59e-01  5.59e-02
    5   1 -      -2.427640491585  -1.45e-05   1.74e-03    6    10   5.59e-01  5.59e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=5.50e-02
--- time_gemm_reduction=7.66e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.84e+05
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=5.50e-02
--- time_gemm_reduction=7.61e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.85e+05
    6   0 -      -2.651092751183  -9.89e-07   3.54e-04    6    12   6.71e-01  5.59e-02
    6   1 -      -2.427643024864  -2.53e-06   4.44e-04    6    12   6.71e-01  5.59e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=5.50e-02
--- time_gemm_reduction=7.69e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.85e+05
--- preprocess_Hx_batchGPU ---
--- time_copy=3.50e-05
--- time_gemm_kernel=5.50e-02
--- time_gemm_reduction=7.63e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.85e+05
    7   0 +      -2.651092827031  -7.58e-08   9.15e-05    6    14   7.83e-01  5.59e-02
    7   1 -      -2.427643166985  -1.42e-07   1.32e-04    6    14   7.83e-01  5.59e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=5.65e-02
--- time_gemm_reduction=7.94e-04
--- cost_gemm_kernel=5.42e+04 flops=kernel/time=9.59e+05
    8   0 +      -2.651092827031  -2.35e-13   9.15e-05    5    15   8.40e-01  5.60e-02
    8   1 +      -2.427643182403  -1.54e-08   5.43e-05    5    15   8.40e-01  5.60e-02
TIMING for Davidson : 8.40e-01  T(cal/comm/rest)=8.31e-01,0.00e+00,9.00e-03
optimized energies: isweep=0 dots=2 ibond=2 e[0]=-2.65109282703
optimized energies: isweep=0 dots=2 ibond=2 e[1]=-2.4276431824
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: 16->10 dwt=+1.381e-03 SvN=1.071e+00
===== CPUmem(GB): tot=2.143e-05 (comb,oper,dvdson,hvec,renorm)=6.951e-06,1.448e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=4 wfsize=26 worktot=9184:0.0701MB:6.84e-05GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=764:0.00583MB:5.69e-06GB
TIMING for Renormalization : 0.001  T(cal/comm)=0,0
===== CPUmem(GB): tot=3e-05 (comb,oper,dvdson,hvec,renorm)=6.95e-06,1.45e-05,0,0,8.55e-06 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=742:0.00566MB:5.53e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=90:0.000687MB:6.71e-07GB
 psi: len=2 mem=124:0.000946MB:9.24e-07GB
total mem of comb=999:0.00762MB:7.44e-06GB
===== CPUmem(GB): tot=3.62e-05 (comb,oper,dvdson,hvec,renorm)=7.44e-06,2.02e-05,0,0,8.55e-06 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(3,0) size=0.00583MB speed=infMB/s
fsize=0.00583MB ratio=1 usage=5.12e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 8.46e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 8.44e-01 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.00e-03 S  per = 0.12  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.12
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.00e-03 S  per = 0.12
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 8.40e-01 S  per = 1e+02
end rank=0 sweep_twodot
##### time_sweep: 2.16e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 2.16e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 2.00e-03 S  per = 0.092  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.046
 T(preprocess_formulae_Hxlist2) = 4.00e-03 S  per = 0.19
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 4.00e-03 S  per = 0.19
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.14e+00 S  per =   99
##### time_global: 2.16e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 2.16e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 2.00e-03 S  per = 0.092  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.046
 T(preprocess_formulae_Hxlist2) = 4.00e-03 S  per = 0.19
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 4.00e-03 S  per = 0.19
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.14e+00 S  per =   99

=== end rank=0 ibond=2

=== start rank=0 ibond=3
ISWEEP,IBOND=0,3

isweep=0 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=764:0.00583MB:5.69e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1202:0.00917MB:8.96e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=742:0.00566MB:5.53e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=90:0.000687MB:6.71e-07GB
 psi: len=2 mem=124:0.000946MB:9.24e-07GB
total mem of comb=999:0.00762MB:7.44e-06GB
===== CPUmem(GB): tot=1.64e-05 (comb,oper,dvdson,hvec,renorm)=7.44e-06,8.96e-06,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,10,4,4) nnz=72:0.000549MB
stensor4: wf own=1 _data=0x473567a0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=5 dimAll=10
 (2,0):4 (1,-1):2 (1,1):2 (0,0):1 (2,2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=33 nblocks=320 size=72:0.000549MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 0.000e+00 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=506:0.00386MB:3.77e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=3136 blksize=4 cost=4.52e+04
total cost for Hx=4.52e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=2.06e-05 (oper,dvdson,batch)(GB)=1.27e-05,1.07e-06,6.79e-06 batchsize=114
===== CPUmem(GB): tot=2.71e-05 (comb,oper,dvdson,hvec,renorm)=7.44e-06,8.96e-06,1.07e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.9e-05
--- time_gemm_kernel=0.0436
--- time_gemm_reduction=0.000648
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.04e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.8e-05
--- time_gemm_kernel=0.0435
--- time_gemm_reduction=0.000623
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.04e+06
settings: ndim=72 neig=2 maxcycle=30 nbuff=4 memory=9.66e-06GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.649584713864  -1.00e+03   5.61e-02    2     2   8.80e-02  4.40e-02
    1   1 -      -2.422873628513  -1.00e+03   1.13e-01    2     2   8.80e-02  4.40e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=4.37e-02
--- time_gemm_reduction=6.27e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.03e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.80e-05
--- time_gemm_kernel=4.35e-02
--- time_gemm_reduction=6.19e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.04e+06
    2   0 -      -2.651942778229  -2.36e-03   1.27e-02    4     4   1.77e-01  4.42e-02
    2   1 -      -2.430205458049  -7.33e-03   2.58e-02    4     4   1.77e-01  4.42e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.00e-05
--- time_gemm_kernel=4.34e-02
--- time_gemm_reduction=6.14e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.04e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=4.30e-02
--- time_gemm_reduction=5.94e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
    3   0 -      -2.652054181524  -1.11e-04   5.06e-03    6     6   2.64e-01  4.40e-02
    3   1 -      -2.430611168739  -4.06e-04   9.32e-03    6     6   2.64e-01  4.40e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=4.31e-02
--- time_gemm_reduction=6.10e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=4.29e-02
--- time_gemm_reduction=5.90e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
    4   0 -      -2.652078566267  -2.44e-05   1.91e-03    6     8   3.52e-01  4.40e-02
    4   1 -      -2.430673357895  -6.22e-05   4.16e-03    6     8   3.52e-01  4.40e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=4.29e-02
--- time_gemm_reduction=6.15e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.60e-05
--- time_gemm_kernel=4.30e-02
--- time_gemm_reduction=5.98e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
    5   0 -      -2.652080842775  -2.28e-06   5.13e-04    6    10   4.39e-01  4.39e-02
    5   1 -      -2.430687478560  -1.41e-05   1.80e-03    6    10   4.39e-01  4.39e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=4.30e-02
--- time_gemm_reduction=6.05e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.60e-05
--- time_gemm_kernel=4.31e-02
--- time_gemm_reduction=6.05e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
    6   0 -      -2.652081069573  -2.27e-07   1.76e-04    6    12   5.26e-01  4.38e-02
    6   1 -      -2.430689675202  -2.20e-06   5.57e-04    6    12   5.26e-01  4.38e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=4.33e-02
--- time_gemm_reduction=5.99e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.04e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=4.31e-02
--- time_gemm_reduction=6.00e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
    7   0 +      -2.652081089523  -1.99e-08   6.38e-05    6    14   6.14e-01  4.39e-02
    7   1 -      -2.430689869838  -1.95e-07   1.13e-04    6    14   6.14e-01  4.39e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=4.29e-02
--- time_gemm_reduction=5.93e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
    8   0 +      -2.652081089524  -5.14e-13   6.38e-05    5    15   6.58e-01  4.39e-02
    8   1 +      -2.430689878738  -8.90e-09   3.44e-05    5    15   6.58e-01  4.39e-02
TIMING for Davidson : 6.58e-01  T(cal/comm/rest)=6.50e-01,0.00e+00,8.00e-03
optimized energies: isweep=0 dots=2 ibond=3 e[0]=-2.65208108952
optimized energies: isweep=0 dots=2 ibond=3 e[1]=-2.43068987874
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,1.0e-04
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=11 dimAll=40
 (2,0):9 (3,1):7 (3,-1):6 (4,0):4 (1,-1):3 (1,1):3 (2,2):3 (2,-2):2 (0,0):1 (3,3):1 (4,2):1
decimation summary: 40->10 dwt=+9.511e-03 SvN=1.828e+00
===== CPUmem(GB): tot=1.640e-05 (comb,oper,dvdson,hvec,renorm)=7.443e-06,8.956e-06,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=26 wfsize=62 worktot=23744:0.181MB:0.000177GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=775:0.00591MB:5.77e-06GB
TIMING for Renormalization : 0  T(cal/comm)=0,0
===== CPUmem(GB): tot=3.85e-05 (comb,oper,dvdson,hvec,renorm)=7.44e-06,8.96e-06,0,0,2.21e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=510:0.00389MB:3.8e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=90:0.000687MB:6.71e-07GB
 psi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=691:0.00527MB:5.15e-06GB
===== CPUmem(GB): tot=4.2e-05 (comb,oper,dvdson,hvec,renorm)=5.15e-06,1.47e-05,0,0,2.21e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(2,0) size=0.00591MB speed=infMB/s
fsize=0.00591MB ratio=1 usage=5.21e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 6.63e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 6.61e-01 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.15
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.00e-03 S  per = 0.15
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 6.58e-01 S  per = 1e+02
end rank=0 sweep_twodot
##### time_sweep: 2.83e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 2.82e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 2.00e-03 S  per = 0.071  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.035
 T(preprocess_formulae_Hxlist2) = 5.00e-03 S  per = 0.18
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 5.00e-03 S  per = 0.18
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.80e+00 S  per =   99
##### time_global: 2.83e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 2.82e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 2.00e-03 S  per = 0.071  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.035
 T(preprocess_formulae_Hxlist2) = 5.00e-03 S  per = 0.18
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 5.00e-03 S  per = 0.18
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.80e+00 S  per =   99

=== end rank=0 ibond=3

======================================================================
sweep_data::summary isweep=0
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0.0001
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=10 dwt=+2.886e-03 nmvp=2 e[0]=-2.65451696694 e[1]=-2.27865402598
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=10 dwt=+9.642e-03 nmvp=20 e[0]=-2.65109283008 e[1]=-2.42764317912
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=10 dwt=+1.381e-03 nmvp=15 e[0]=-2.65109282703 e[1]=-2.4276431824
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=10 dwt=+9.511e-03 nmvp=15 e[0]=-2.65208108952 e[1]=-2.43068987874
 eav_max=-2.46658549646 [ibond=0]  dwt_min=0.00138101155864 [ibond=2]
 eav_min=-2.54138548413 [ibond=3]  dwt_max=0.00964194854724 [ibond=1]
 eav_diff=0.0747999876727
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+9.511e-03 e[0]=-2.65208108952
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+9.511e-03 e[1]=-2.43068987874
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Tav/S | Taccum/S| t_kernel/S | t_reduction/S 
         0  2  10  1.00e-04  1.00e-04 | 52 | 2.83e+00 | 5.44e-02 | 2.83e+00 | 2.76e+00 | 3.94e-02
results: isweep, dcut, dwt, energies (delta_e)
         0      10 +9.51e-03 e[0]=-2.65208108952 (0.00e+00) e[1]=-2.43068987874 (0.00e+00)
======================================================================

======================================================================
sweep parameters: isweep=1 dots=2 dcut=20 eps=1.00e-04 noise=0.00e+00
======================================================================

=== start rank=0 ibond=0
ISWEEP,IBOND=1,0

isweep=1 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=10,10 size(op)=26:0.000198MB size(tot)=764:0.00583MB:5.69e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1202:0.00917MB:8.96e-06GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=510:0.00389MB:3.8e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=90:0.000687MB:6.71e-07GB
 psi: len=2 mem=48:0.000366MB:3.58e-07GB
total mem of comb=691:0.00527MB:5.15e-06GB
===== CPUmem(GB): tot=1.99e-05 (comb,oper,dvdson,hvec,renorm)=5.15e-06,1.47e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,10,4,4) nnz=72:0.000549MB
stensor4: wf own=1 _data=0x473567a0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=5 dimAll=10
 (2,0):4 (1,-1):2 (1,1):2 (0,0):1 (2,2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=33 nblocks=320 size=72:0.000549MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 0.000e+00 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=506:0.00386MB:3.77e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=3136 blksize=4 cost=4.52e+04
total cost for Hx=4.52e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=2.06e-05 (oper,dvdson,batch)(GB)=1.27e-05,1.07e-06,6.79e-06 batchsize=114
===== CPUmem(GB): tot=3.06e-05 (comb,oper,dvdson,hvec,renorm)=5.15e-06,1.47e-05,1.07e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=2.7e-05
--- time_gemm_kernel=0.0436
--- time_gemm_reduction=0.000646
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.04e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.8e-05
--- time_gemm_kernel=0.0434
--- time_gemm_reduction=0.000619
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.04e+06
settings: ndim=72 neig=2 maxcycle=30 nbuff=4 memory=9.66e-06GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.641968340945  -1.00e+03   1.43e-01    2     2   8.80e-02  4.40e-02
    1   1 -      -2.409571684907  -1.00e+03   1.87e-01    2     2   8.80e-02  4.40e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.10e-05
--- time_gemm_kernel=4.34e-02
--- time_gemm_reduction=6.60e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.04e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=4.36e-02
--- time_gemm_reduction=6.36e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.04e+06
    2   0 -      -2.651378394623  -9.41e-03   3.41e-02    4     4   1.76e-01  4.40e-02
    2   1 -      -2.428930569681  -1.94e-02   5.14e-02    4     4   1.76e-01  4.40e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=4.33e-02
--- time_gemm_reduction=6.06e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.04e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.50e-05
--- time_gemm_kernel=4.32e-02
--- time_gemm_reduction=6.00e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
    3   0 -      -2.652042545355  -6.64e-04   6.56e-03    6     6   2.64e-01  4.40e-02
    3   1 -      -2.430569705944  -1.64e-03   1.22e-02    6     6   2.64e-01  4.40e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=4.32e-02
--- time_gemm_reduction=5.97e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=4.36e-02
--- time_gemm_reduction=6.07e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.04e+06
    4   0 -      -2.652077154162  -3.46e-05   1.95e-03    6     8   3.52e-01  4.40e-02
    4   1 -      -2.430677289788  -1.08e-04   3.53e-03    6     8   3.52e-01  4.40e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=4.33e-02
--- time_gemm_reduction=6.07e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.04e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.60e-05
--- time_gemm_kernel=4.31e-02
--- time_gemm_reduction=6.04e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
    5   0 -      -2.652080297079  -3.14e-06   9.86e-04    6    10   4.40e-01  4.40e-02
    5   1 -      -2.430686755333  -9.47e-06   1.83e-03    6    10   4.40e-01  4.40e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=4.29e-02
--- time_gemm_reduction=5.92e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=4.29e-02
--- time_gemm_reduction=5.90e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
    6   0 -      -2.652081026668  -7.30e-07   3.13e-04    6    12   5.27e-01  4.39e-02
    6   1 -      -2.430689427532  -2.67e-06   7.41e-04    6    12   5.27e-01  4.39e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=4.30e-02
--- time_gemm_reduction=5.91e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.50e-05
--- time_gemm_kernel=4.29e-02
--- time_gemm_reduction=5.87e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
    7   0 +      -2.652081087241  -6.06e-08   8.27e-05    6    14   6.15e-01  4.39e-02
    7   1 -      -2.430689831168  -4.04e-07   2.50e-04    6    14   6.15e-01  4.39e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=4.29e-02
--- time_gemm_reduction=6.07e-04
--- cost_gemm_kernel=4.52e+04 flops=kernel/time=1.05e+06
    8   0 +      -2.652081087241  -3.42e-14   8.27e-05    5    15   6.58e-01  4.39e-02
    8   1 +      -2.430689876399  -4.52e-08   6.79e-05    5    15   6.58e-01  4.39e-02
TIMING for Davidson : 6.58e-01  T(cal/comm/rest)=6.51e-01,0.00e+00,7.00e-03
optimized energies: isweep=1 dots=2 ibond=0 e[0]=-2.65208108724
optimized energies: isweep=1 dots=2 ibond=0 e[1]=-2.4306898764
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=2.0e-05 (comb,oper,dvdson,hvec,renorm)=5.1e-06,1.5e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=12544:0.0957MB:9.35e-05GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.003  T(cal/comm)=0.003,0
===== CPUmem(GB): tot=3.16e-05 (comb,oper,dvdson,hvec,renorm)=5.15e-06,1.47e-05,0,0,1.17e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=510:0.00389MB:3.8e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=100:0.000763MB:7.45e-07GB
 psi: len=2 mem=144:0.0011MB:1.07e-06GB
total mem of comb=797:0.00608MB:5.94e-06GB
===== CPUmem(GB): tot=4.27e-05 (comb,oper,dvdson,hvec,renorm)=5.94e-06,2.51e-05,0,0,1.17e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(1,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=5.7e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 6.65e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 6.61e-01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 3.00e-03 S  per = 0.45  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.15
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.00e-03 S  per = 0.15
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 6.58e-01 S  per = 1e+02
end rank=0 sweep_twodot
##### time_sweep: 6.65e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 6.61e-01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 3.00e-03 S  per = 0.45  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.15
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.00e-03 S  per = 0.15
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 6.58e-01 S  per = 1e+02
##### time_global: 3.49e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 3.48e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 5.00e-03 S  per = 0.14  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.029
 T(preprocess_formulae_Hxlist2) = 6.00e-03 S  per = 0.17
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 6.00e-03 S  per = 0.17
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 3.46e+00 S  per =   99

=== end rank=0 ibond=0

=== start rank=0 ibond=1
ISWEEP,IBOND=1,1

isweep=1 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=510:0.00389MB:3.8e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=100:0.000763MB:7.45e-07GB
 psi: len=2 mem=144:0.0011MB:1.07e-06GB
total mem of comb=797:0.00608MB:5.94e-06GB
===== CPUmem(GB): tot=1.95e-05 (comb,oper,dvdson,hvec,renorm)=5.94e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47695d70
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 0.000e+00 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=3.44e-05 (comb,oper,dvdson,hvec,renorm)=5.94e-06,1.36e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.6e-05
--- time_gemm_kernel=0.064
--- time_gemm_reduction=0.000946
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.9e-05
--- time_gemm_kernel=0.064
--- time_gemm_reduction=0.000916
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.23e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652081087241  -1.00e+03   7.61e-02    2     2   1.30e-01  6.50e-02
    1   1 -      -2.430689876399  -1.00e+03   1.16e-01    2     2   1.30e-01  6.50e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.20e-05
--- time_gemm_kernel=6.46e-02
--- time_gemm_reduction=9.47e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=6.40e-02
--- time_gemm_reduction=8.84e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    2   0 -      -2.654436755885  -2.36e-03   1.10e-02    4     4   2.60e-01  6.50e-02
    2   1 -      -2.436722360852  -6.03e-03   1.83e-02    4     4   2.60e-01  6.50e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.34e-02
--- time_gemm_reduction=8.80e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.25e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.60e-05
--- time_gemm_kernel=6.37e-02
--- time_gemm_reduction=8.88e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    3   0 -      -2.654509457773  -7.27e-05   3.58e-03    6     6   3.89e-01  6.48e-02
    3   1 -      -2.436951014567  -2.29e-04   5.90e-03    6     6   3.89e-01  6.48e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.32e-02
--- time_gemm_reduction=9.08e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.25e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.50e-05
--- time_gemm_kernel=6.35e-02
--- time_gemm_reduction=8.76e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    4   0 -      -2.654516214551  -6.76e-06   1.01e-03    6     8   5.18e-01  6.48e-02
    4   1 -      -2.436975310136  -2.43e-05   1.78e-03    6     8   5.18e-01  6.48e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.34e-02
--- time_gemm_reduction=9.28e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.25e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.60e-05
--- time_gemm_kernel=6.34e-02
--- time_gemm_reduction=8.98e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.25e+06
    5   0 -      -2.654516839741  -6.25e-07   4.21e-04    6    10   6.47e-01  6.47e-02
    5   1 -      -2.436977310241  -2.00e-06   4.24e-04    6    10   6.47e-01  6.47e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.39e-02
--- time_gemm_reduction=8.85e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.60e-05
--- time_gemm_kernel=6.37e-02
--- time_gemm_reduction=8.92e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    6   0 -      -2.654516957904  -1.18e-07   1.26e-04    6    12   7.76e-01  6.47e-02
    6   1 -      -2.436977427915  -1.18e-07   1.80e-04    6    12   7.76e-01  6.47e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=6.36e-02
--- time_gemm_reduction=9.10e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.35e-02
--- time_gemm_reduction=8.88e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    7   0 +      -2.654516967213  -9.31e-09   3.92e-05    6    14   9.05e-01  6.46e-02
    7   1 +      -2.436977447783  -1.99e-08   6.16e-05    6    14   9.05e-01  6.46e-02
TIMING for Davidson : 9.05e-01  T(cal/comm/rest)=8.98e-01,0.00e+00,7.00e-03
optimized energies: isweep=1 dots=2 ibond=1 e[0]=-2.65451696721
optimized energies: isweep=1 dots=2 ibond=1 e[1]=-2.43697744778
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep1_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=1.954e-05 (comb,oper,dvdson,hvec,renorm)=5.938e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=54432:0.415MB:0.000406GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.002  T(cal/comm)=0.002,0
===== CPUmem(GB): tot=7.02e-05 (comb,oper,dvdson,hvec,renorm)=5.94e-06,1.36e-05,0,0,5.07e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=510:0.00389MB:3.8e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=839:0.0064MB:6.25e-06GB
===== CPUmem(GB): tot=8.99e-05 (comb,oper,dvdson,hvec,renorm)=6.25e-06,3.3e-05,0,0,5.07e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=7.21e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 9.14e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 9.10e-01 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 2.00e-03 S  per = 0.22  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.11
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.00e-03 S  per = 0.11
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 9.05e-01 S  per =   99
end rank=0 sweep_twodot
##### time_sweep: 1.58e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.57e+00 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 5.00e-03 S  per = 0.32  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 2.00e-03 S  per = 0.13
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per = 0.13
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.56e+00 S  per =   99
##### time_global: 4.40e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 4.39e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 7.00e-03 S  per = 0.16  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.023
 T(preprocess_formulae_Hxlist2) = 7.00e-03 S  per = 0.16
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 7.00e-03 S  per = 0.16
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 4.36e+00 S  per =   99

=== end rank=0 ibond=1

=== start rank=0 ibond=2
ISWEEP,IBOND=1,2

isweep=1 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=510:0.00389MB:3.8e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=839:0.0064MB:6.25e-06GB
===== CPUmem(GB): tot=3.92e-05 (comb,oper,dvdson,hvec,renorm)=6.25e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x476bb6a0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 1.000e-03 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.002
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=5.41e-05 (comb,oper,dvdson,hvec,renorm)=6.25e-06,3.3e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.1e-05
--- time_gemm_kernel=0.0702
--- time_gemm_reduction=0.00112
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.13e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.3e-05
--- time_gemm_kernel=0.0701
--- time_gemm_reduction=0.00111
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.13e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588771090  -1.00e+03   7.01e-02    2     2   1.42e-01  7.10e-02
    1   1 -      -2.436093960625  -1.00e+03   4.92e-02    2     2   1.42e-01  7.10e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.20e-05
--- time_gemm_kernel=6.71e-02
--- time_gemm_reduction=1.01e-03
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.18e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.38e-02
--- time_gemm_reduction=8.85e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    2   0 -      -2.654426819282  -1.84e-03   1.26e-02    4     4   2.75e-01  6.88e-02
    2   1 -      -2.436959163107  -8.65e-04   5.19e-03    4     4   2.75e-01  6.88e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.36e-02
--- time_gemm_reduction=8.81e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.34e-02
--- time_gemm_reduction=8.75e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    3   0 -      -2.654508896837  -8.21e-05   3.56e-03    6     6   4.04e-01  6.73e-02
    3   1 -      -2.436975274428  -1.61e-05   1.59e-03    6     6   4.04e-01  6.73e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.00e-05
--- time_gemm_kernel=6.36e-02
--- time_gemm_reduction=8.79e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.32e-02
--- time_gemm_reduction=8.91e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.25e+06
    4   0 -      -2.654515664927  -6.77e-06   1.29e-03    6     8   5.33e-01  6.66e-02
    4   1 -      -2.436977078524  -1.80e-06   5.94e-04    6     8   5.33e-01  6.66e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.36e-02
--- time_gemm_reduction=9.03e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=4.10e-05
--- time_gemm_kernel=6.33e-02
--- time_gemm_reduction=8.75e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.25e+06
    5   0 -      -2.654516771391  -1.11e-06   5.13e-04    6    10   6.62e-01  6.62e-02
    5   1 -      -2.436977369938  -2.91e-07   2.87e-04    6    10   6.62e-01  6.62e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.35e-02
--- time_gemm_reduction=8.91e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.80e-05
--- time_gemm_kernel=6.34e-02
--- time_gemm_reduction=8.76e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.25e+06
    6   0 -      -2.654516945145  -1.74e-07   1.83e-04    6    12   7.91e-01  6.59e-02
    6   1 -      -2.436977443895  -7.40e-08   1.16e-04    6    12   7.91e-01  6.59e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.39e-02
--- time_gemm_reduction=8.98e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.35e-02
--- time_gemm_reduction=8.82e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    7   0 +      -2.654516966639  -2.15e-08   4.64e-05    6    14   9.20e-01  6.57e-02
    7   1 +      -2.436977450693  -6.80e-09   2.69e-05    6    14   9.20e-01  6.57e-02
TIMING for Davidson : 9.20e-01  T(cal/comm/rest)=9.14e-01,0.00e+00,6.00e-03
optimized energies: isweep=1 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=1 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=3.9e-05 (comb,oper,dvdson,hvec,renorm)=6.3e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=12544:0.0957MB:9.35e-05GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.008  T(cal/comm)=0.008,0
===== CPUmem(GB): tot=5.09e-05 (comb,oper,dvdson,hvec,renorm)=6.25e-06,3.3e-05,0,0,1.17e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=520:0.00397MB:3.87e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=953:0.00727MB:7.1e-06GB
===== CPUmem(GB): tot=6.21e-05 (comb,oper,dvdson,hvec,renorm)=7.1e-06,4.33e-05,0,0,1.17e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(3,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=7.69e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 9.36e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 9.26e-01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 8.00e-03 S  per = 0.85  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.11
 T(preprocess_formulae_Hxlist2) = 2.00e-03 S  per = 0.22
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per = 0.22
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 9.20e-01 S  per =   99
end rank=0 sweep_twodot
##### time_sweep: 2.52e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 2.50e+00 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 1.30e-02 S  per = 0.52  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.04
 T(preprocess_formulae_Hxlist2) = 4.00e-03 S  per = 0.16
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 4.00e-03 S  per = 0.16
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.48e+00 S  per =   99
##### time_global: 5.34e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 5.32e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.50e-02 S  per = 0.28  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 2.00e-03 S  per = 0.038
 T(preprocess_formulae_Hxlist2) = 9.00e-03 S  per = 0.17
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 9.00e-03 S  per = 0.17
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 5.28e+00 S  per =   99

=== end rank=0 ibond=2

=== start rank=0 ibond=3
ISWEEP,IBOND=1,3

isweep=1 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=520:0.00397MB:3.87e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=953:0.00727MB:7.1e-06GB
===== CPUmem(GB): tot=2.07e-05 (comb,oper,dvdson,hvec,renorm)=7.1e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x476965f0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 1.000e-03 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.002
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=3.56e-05 (comb,oper,dvdson,hvec,renorm)=7.1e-06,1.36e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.2e-05
--- time_gemm_kernel=0.0702
--- time_gemm_reduction=0.00111
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.13e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.4e-05
--- time_gemm_kernel=0.0702
--- time_gemm_reduction=0.00112
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.13e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966639  -1.00e+03   4.64e-05    2     2   1.42e-01  7.10e-02
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   1.42e-01  7.10e-02
TIMING for Davidson : 1.42e-01  T(cal/comm/rest)=1.42e-01,0.00e+00,0.00e+00
optimized energies: isweep=1 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=1 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep1_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=2.071e-05 (comb,oper,dvdson,hvec,renorm)=7.100e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=54432:0.415MB:0.000406GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=7.14e-05 (comb,oper,dvdson,hvec,renorm)=7.1e-06,1.36e-05,0,0,5.07e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=9.07e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,5.07e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=7.84e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 1.53e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.49e-01 S  per =   97  per(accum) = 97
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 97
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 97
 T(renrm) = 1.00e-03 S  per = 0.65  per(accum) = 98
 T( save) = 0.00e+00 S  per =    0  per(accum) = 98
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.67
 T(preprocess_formulae_Hxlist2) = 2.00e-03 S  per =  1.3
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per =  1.3
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.43e-01 S  per =   96
end rank=0 sweep_twodot
##### time_sweep: 2.67e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 2.65e+00 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 1.40e-02 S  per = 0.52  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 2.00e-03 S  per = 0.076
 T(preprocess_formulae_Hxlist2) = 6.00e-03 S  per = 0.23
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 6.00e-03 S  per = 0.23
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.63e+00 S  per =   99
##### time_global: 5.49e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 5.46e+00 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 1.60e-02 S  per = 0.29  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 3.00e-03 S  per = 0.055
 T(preprocess_formulae_Hxlist2) = 1.10e-02 S  per =  0.2
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.10e-02 S  per =  0.2
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 5.43e+00 S  per =   99

=== end rank=0 ibond=3

======================================================================
sweep_data::summary isweep=1
----------------------------------------------------------------------
sweep parameters: isweep=1 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=15 e[0]=-2.65208108724 e[1]=-2.4306898764
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=14 e[0]=-2.65451696721 e[1]=-2.43697744778
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069
 eav_max=-2.54138548182 [ibond=0]  dwt_min=0 [ibond=0]
 eav_min=-2.54574720867 [ibond=3]  dwt_max=0.000578414060519 [ibond=1]
 eav_diff=0.00436172684618
 sweep energies: isweep=1 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[0]=-2.65451696664
 sweep energies: isweep=1 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=1
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Tav/S | Taccum/S| t_kernel/S | t_reduction/S 
         0  2  10  1.00e-04  1.00e-04 | 52 | 2.83e+00 | 5.44e-02 | 2.83e+00 | 2.76e+00 | 3.94e-02
         1  2  20  1.00e-04  0.00e+00 | 45 | 2.67e+00 | 5.94e-02 | 5.50e+00 | 2.59e+00 | 3.70e-02
results: isweep, dcut, dwt, energies (delta_e)
         0      10 +9.51e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
         1      20 +5.26e-04 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

======================================================================
sweep parameters: isweep=2 dots=2 dcut=20 eps=1.00e-04 noise=0.00e+00
======================================================================

=== start rank=0 ibond=0
ISWEEP,IBOND=2,0

isweep=2 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x476965f0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 1.000e-03 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=5.49e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.1e-05
--- time_gemm_kernel=0.07
--- time_gemm_reduction=0.00113
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.13e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.4e-05
--- time_gemm_kernel=0.069
--- time_gemm_reduction=0.00109
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.15e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701465761  -1.00e+03   6.88e-02    2     2   1.41e-01  7.05e-02
    1   1 -      -2.436233901586  -1.00e+03   4.38e-02    2     2   1.41e-01  7.05e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.50e-05
--- time_gemm_kernel=6.54e-02
--- time_gemm_reduction=9.85e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.21e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.43e-02
--- time_gemm_reduction=9.12e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    2   0 -      -2.654428675224  -1.73e-03   1.26e-02    4     4   2.73e-01  6.83e-02
    2   1 -      -2.436964455562  -7.31e-04   4.22e-03    4     4   2.73e-01  6.83e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=8.95e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.80e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=8.89e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    3   0 -      -2.654509664616  -8.10e-05   3.66e-03    6     6   4.03e-01  6.72e-02
    3   1 -      -2.436976459235  -1.20e-05   1.11e-03    6     6   4.03e-01  6.72e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=8.89e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.42e-02
--- time_gemm_reduction=8.79e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    4   0 -      -2.654516020750  -6.36e-06   1.14e-03    6     8   5.33e-01  6.66e-02
    4   1 -      -2.436977285929  -8.27e-07   4.03e-04    6     8   5.33e-01  6.66e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.00e-05
--- time_gemm_kernel=6.40e-02
--- time_gemm_reduction=8.82e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.60e-05
--- time_gemm_kernel=6.35e-02
--- time_gemm_reduction=8.76e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    5   0 -      -2.654516818919  -7.98e-07   4.45e-04    6    10   6.62e-01  6.62e-02
    5   1 -      -2.436977409924  -1.24e-07   2.05e-04    6    10   6.62e-01  6.62e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.42e-02
--- time_gemm_reduction=8.86e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=8.94e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    6   0 -      -2.654516950785  -1.32e-07   1.57e-04    6    12   7.93e-01  6.61e-02
    6   1 +      -2.436977447170  -3.72e-08   7.42e-05    6    12   7.93e-01  6.61e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.39e-02
--- time_gemm_reduction=9.01e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   8.58e-01  6.60e-02
    7   1 +      -2.436977447170  -1.33e-15   7.42e-05    5    13   8.58e-01  6.60e-02
TIMING for Davidson : 8.58e-01  T(cal/comm/rest)=8.54e-01,0.00e+00,4.00e-03
optimized energies: isweep=2 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=2 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=12544:0.0957MB:9.35e-05GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=5.16e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.17e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=6.28e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,1.17e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(1,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=7.84e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 8.67e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 8.64e-01 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.00e-03 S  per = 0.12  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.12
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.12
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per = 0.23
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 8.58e-01 S  per =   99
end rank=0 sweep_twodot
##### time_sweep: 8.67e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 8.64e-01 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.00e-03 S  per = 0.12  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.12
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.12
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per = 0.23
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 8.58e-01 S  per =   99
##### time_global: 6.36e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 6.33e+00 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 1.70e-02 S  per = 0.27  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 4.00e-03 S  per = 0.063
 T(preprocess_formulae_Hxlist2) = 1.20e-02 S  per = 0.19
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.30e-02 S  per = 0.21
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 6.28e+00 S  per =   99

=== end rank=0 ibond=0

=== start rank=0 ibond=1
ISWEEP,IBOND=2,1

isweep=2 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x43e289b0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 0.000e+00 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 4.000e-03 S -----
T(inter/Hmu/Hxlist/tot)=0.004,0,0.001,0.006
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=3.63e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.8e-05
--- time_gemm_kernel=0.0645
--- time_gemm_reduction=0.000949
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=4e-05
--- time_gemm_kernel=0.0645
--- time_gemm_reduction=0.000949
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.23e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   1.31e-01  6.55e-02
    1   1 +      -2.436977447170  -1.00e+03   7.42e-05    2     2   1.31e-01  6.55e-02
TIMING for Davidson : 1.31e-01  T(cal/comm/rest)=1.30e-01,0.00e+00,1.00e-03
optimized energies: isweep=2 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=2 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep2_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=54432:0.415MB:0.000406GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=7.21e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,5.07e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=9.07e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,5.07e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=7.99e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 1.42e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.40e-01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 1.00e-03 S  per =  0.7  per(accum) = 99
 T( save) = 0.00e+00 S  per =    0  per(accum) = 99
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 6.00e-03 S  per =  4.3
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.00e-03 S  per = 0.71
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.31e-01 S  per =   94
end rank=0 sweep_twodot
##### time_sweep: 1.01e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.00e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 2.00e-03 S  per =  0.2  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per =  0.1
 T(preprocess_formulae_Hxlist2) = 7.00e-03 S  per =  0.7
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 3.00e-03 S  per =  0.3
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 9.89e-01 S  per =   99
##### time_global: 6.50e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 6.47e+00 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 1.80e-02 S  per = 0.28  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 4.00e-03 S  per = 0.062
 T(preprocess_formulae_Hxlist2) = 1.80e-02 S  per = 0.28
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.40e-02 S  per = 0.22
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 6.41e+00 S  per =   99

=== end rank=0 ibond=1

=== start rank=0 ibond=2
ISWEEP,IBOND=2,2

isweep=2 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x45735230
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 0.000e+00 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=5.49e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.8e-05
--- time_gemm_kernel=0.0641
--- time_gemm_reduction=0.000933
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.1e-05
--- time_gemm_kernel=0.0679
--- time_gemm_reduction=0.00103
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.16e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819590  -1.00e+03   7.01e-02    2     2   1.34e-01  6.70e-02
    1   1 -      -2.436094100139  -1.00e+03   4.92e-02    2     2   1.34e-01  6.70e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.10e-05
--- time_gemm_kernel=6.55e-02
--- time_gemm_reduction=9.92e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.21e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.42e-02
--- time_gemm_reduction=8.95e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    2   0 -      -2.654426863106  -1.84e-03   1.26e-02    4     4   2.65e-01  6.63e-02
    2   1 -      -2.436959129206  -8.65e-04   5.19e-03    4     4   2.65e-01  6.63e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=8.87e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.80e-05
--- time_gemm_kernel=6.40e-02
--- time_gemm_reduction=8.85e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   3.95e-01  6.58e-02
    3   1 -      -2.436975259479  -1.61e-05   1.59e-03    6     6   3.95e-01  6.58e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=8.87e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.60e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=8.78e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   5.26e-01  6.58e-02
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   5.26e-01  6.58e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.00e-05
--- time_gemm_kernel=6.42e-02
--- time_gemm_reduction=8.89e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=8.88e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   6.56e-01  6.56e-02
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   6.56e-01  6.56e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.90e-05
--- time_gemm_kernel=6.46e-02
--- time_gemm_reduction=9.26e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.39e-02
--- time_gemm_reduction=8.82e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   7.86e-01  6.55e-02
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   7.86e-01  6.55e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.40e-02
--- time_gemm_reduction=8.83e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.38e-02
--- time_gemm_reduction=8.83e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   9.16e-01  6.54e-02
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   9.16e-01  6.54e-02
TIMING for Davidson : 9.16e-01  T(cal/comm/rest)=9.10e-01,0.00e+00,6.00e-03
optimized energies: isweep=2 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=2 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=12544:0.0957MB:9.35e-05GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=5.16e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.17e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=6.28e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,1.17e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(3,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=7.99e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 9.23e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 9.20e-01 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.00e-03 S  per = 0.11  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.11
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.00e-03 S  per = 0.11
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 9.16e-01 S  per = 1e+02
end rank=0 sweep_twodot
##### time_sweep: 1.93e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.92e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 3.00e-03 S  per = 0.16  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.052
 T(preprocess_formulae_Hxlist2) = 8.00e-03 S  per = 0.42
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 4.00e-03 S  per = 0.21
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.91e+00 S  per =   99
##### time_global: 7.43e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 7.39e+00 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 1.90e-02 S  per = 0.26  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 4.00e-03 S  per = 0.054
 T(preprocess_formulae_Hxlist2) = 1.90e-02 S  per = 0.26
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.50e-02 S  per =  0.2
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 7.33e+00 S  per =   99

=== end rank=0 ibond=2

=== start rank=0 ibond=3
ISWEEP,IBOND=2,3

isweep=2 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x473ceae0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 0.000e+00 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=3.63e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.7e-05
--- time_gemm_kernel=0.0644
--- time_gemm_reduction=0.000927
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.8e-05
--- time_gemm_kernel=0.0643
--- time_gemm_reduction=0.000918
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.23e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   1.30e-01  6.50e-02
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   1.30e-01  6.50e-02
TIMING for Davidson : 1.30e-01  T(cal/comm/rest)=1.30e-01,0.00e+00,0.00e+00
optimized energies: isweep=2 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=2 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep2_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=54432:0.415MB:0.000406GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0  T(cal/comm)=0,0
===== CPUmem(GB): tot=7.21e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,5.07e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=9.07e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,5.07e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=8.14e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 1.37e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.35e-01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 1.00e-03 S  per = 0.73  per(accum) = 99
 T( save) = 0.00e+00 S  per =    0  per(accum) = 99
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.74
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.00e-03 S  per = 0.74
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.31e-01 S  per =   97
end rank=0 sweep_twodot
##### time_sweep: 2.07e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 2.06e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 4.00e-03 S  per = 0.19  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.049
 T(preprocess_formulae_Hxlist2) = 9.00e-03 S  per = 0.44
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 5.00e-03 S  per = 0.24
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.04e+00 S  per =   99
##### time_global: 7.56e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 7.52e+00 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 2.00e-02 S  per = 0.26  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 4.00e-03 S  per = 0.053
 T(preprocess_formulae_Hxlist2) = 2.00e-02 S  per = 0.27
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.60e-02 S  per = 0.21
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 7.46e+00 S  per =   99

=== end rank=0 ibond=3

======================================================================
sweep_data::summary isweep=2
----------------------------------------------------------------------
sweep parameters: isweep=2 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069
 eav_max=-2.54574720706 [ibond=0]  dwt_min=0 [ibond=0]
 eav_min=-2.54574720867 [ibond=3]  dwt_max=0.000578360234059 [ibond=1]
 eav_diff=1.60478652589e-09
 sweep energies: isweep=2 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[0]=-2.65451696664
 sweep energies: isweep=2 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=2
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Tav/S | Taccum/S| t_kernel/S | t_reduction/S 
         0  2  10  1.00e-04  1.00e-04 | 52 | 2.83e+00 | 5.44e-02 | 2.83e+00 | 2.76e+00 | 3.94e-02
         1  2  20  1.00e-04  0.00e+00 | 45 | 2.67e+00 | 5.94e-02 | 5.50e+00 | 2.59e+00 | 3.70e-02
         2  2  20  1.00e-04  0.00e+00 | 31 | 2.07e+00 | 6.69e-02 | 7.58e+00 | 2.01e+00 | 2.86e-02
results: isweep, dcut, dwt, energies (delta_e)
         0      10 +9.51e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
         1      20 +5.26e-04 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.67e-13)
         2      20 +5.26e-04 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

======================================================================
sweep parameters: isweep=3 dots=2 dcut=20 eps=1.00e-04 noise=0.00e+00
======================================================================

=== start rank=0 ibond=0
ISWEEP,IBOND=3,0

isweep=3 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x45844180
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 0.000e+00 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=5.49e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=2.8e-05
--- time_gemm_kernel=0.0655
--- time_gemm_reduction=0.000974
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.21e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=4e-05
--- time_gemm_kernel=0.0705
--- time_gemm_reduction=0.00111
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.12e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891  -1.00e+03   6.88e-02    2     2   1.38e-01  6.90e-02
    1   1 -      -2.436233901339  -1.00e+03   4.38e-02    2     2   1.38e-01  6.90e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.10e-05
--- time_gemm_kernel=6.82e-02
--- time_gemm_reduction=1.02e-03
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.16e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.60e-05
--- time_gemm_kernel=6.42e-02
--- time_gemm_reduction=8.87e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    2   0 -      -2.654428675110  -1.73e-03   1.26e-02    4     4   2.72e-01  6.80e-02
    2   1 -      -2.436964455587  -7.31e-04   4.22e-03    4     4   2.72e-01  6.80e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=8.84e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.80e-05
--- time_gemm_kernel=6.43e-02
--- time_gemm_reduction=8.92e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    3   0 -      -2.654509664652  -8.10e-05   3.66e-03    6     6   4.03e-01  6.72e-02
    3   1 -      -2.436976459250  -1.20e-05   1.11e-03    6     6   4.03e-01  6.72e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.80e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=8.87e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.80e-05
--- time_gemm_kernel=6.45e-02
--- time_gemm_reduction=8.95e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
    4   0 -      -2.654516020764  -6.36e-06   1.14e-03    6     8   5.33e-01  6.66e-02
    4   1 -      -2.436977285934  -8.27e-07   4.03e-04    6     8   5.33e-01  6.66e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.20e-05
--- time_gemm_kernel=6.46e-02
--- time_gemm_reduction=8.88e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.50e-02
--- time_gemm_reduction=9.01e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
    5   0 -      -2.654516818921  -7.98e-07   4.45e-04    6    10   6.65e-01  6.65e-02
    5   1 -      -2.436977409925  -1.24e-07   2.05e-04    6    10   6.65e-01  6.65e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.47e-02
--- time_gemm_reduction=9.07e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.49e-02
--- time_gemm_reduction=8.94e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
    6   0 -      -2.654516950786  -1.32e-07   1.57e-04    6    12   7.96e-01  6.63e-02
    6   1 +      -2.436977447171  -3.72e-08   7.42e-05    6    12   7.96e-01  6.63e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.48e-02
--- time_gemm_reduction=8.86e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   8.62e-01  6.63e-02
    7   1 +      -2.436977447171  -2.66e-15   7.42e-05    5    13   8.62e-01  6.63e-02
TIMING for Davidson : 8.62e-01  T(cal/comm/rest)=8.56e-01,0.00e+00,6.00e-03
optimized energies: isweep=3 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=3 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=12544:0.0957MB:9.35e-05GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=5.16e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.17e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=6.28e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,1.17e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(1,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=8.14e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 8.68e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 8.66e-01 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.00e-03 S  per = 0.12  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.12
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.00e-03 S  per = 0.12
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 8.62e-01 S  per = 1e+02
end rank=0 sweep_twodot
##### time_sweep: 8.68e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 8.66e-01 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.00e-03 S  per = 0.12  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.12
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.00e-03 S  per = 0.12
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 8.62e-01 S  per = 1e+02
##### time_global: 8.43e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 8.39e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 2.10e-02 S  per = 0.25  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 4.00e-03 S  per = 0.048
 T(preprocess_formulae_Hxlist2) = 2.10e-02 S  per = 0.25
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.70e-02 S  per =  0.2
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 8.32e+00 S  per =   99

=== end rank=0 ibond=0

=== start rank=0 ibond=1
ISWEEP,IBOND=3,1

isweep=3 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x4573a010
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 1.000e-03 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.002
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=3.63e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.1e-05
--- time_gemm_kernel=0.0704
--- time_gemm_reduction=0.0011
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.12e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.4e-05
--- time_gemm_kernel=0.0705
--- time_gemm_reduction=0.00111
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.12e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   1.43e-01  7.15e-02
    1   1 +      -2.436977447171  -1.00e+03   7.42e-05    2     2   1.43e-01  7.15e-02
TIMING for Davidson : 1.43e-01  T(cal/comm/rest)=1.42e-01,0.00e+00,1.00e-03
optimized energies: isweep=3 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=3 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep3_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=54432:0.415MB:0.000406GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=7.21e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,5.07e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=9.07e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,5.07e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=8.29e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 1.52e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.49e-01 S  per =   98  per(accum) = 98
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 98
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 98
 T(renrm) = 1.00e-03 S  per = 0.66  per(accum) = 99
 T( save) = 0.00e+00 S  per =    0  per(accum) = 99
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.67
 T(preprocess_formulae_Hxlist2) = 2.00e-03 S  per =  1.3
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per =  1.3
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.43e-01 S  per =   96
end rank=0 sweep_twodot
##### time_sweep: 1.02e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.01e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 2.00e-03 S  per =  0.2  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.099
 T(preprocess_formulae_Hxlist2) = 3.00e-03 S  per =  0.3
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 3.00e-03 S  per =  0.3
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.00e+00 S  per =   99
##### time_global: 8.58e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 8.54e+00 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 2.20e-02 S  per = 0.26  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 5.00e-03 S  per = 0.059
 T(preprocess_formulae_Hxlist2) = 2.30e-02 S  per = 0.27
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.90e-02 S  per = 0.22
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 8.47e+00 S  per =   99

=== end rank=0 ibond=1

=== start rank=0 ibond=2
ISWEEP,IBOND=3,2

isweep=3 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x45734d10
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 1.000e-03 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=5.49e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.2e-05
--- time_gemm_kernel=0.0705
--- time_gemm_reduction=0.00113
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.12e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.5e-05
--- time_gemm_kernel=0.0708
--- time_gemm_reduction=0.00111
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.12e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592  -1.00e+03   7.01e-02    2     2   1.43e-01  7.15e-02
    1   1 -      -2.436094100141  -1.00e+03   4.92e-02    2     2   1.43e-01  7.15e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.40e-05
--- time_gemm_kernel=6.81e-02
--- time_gemm_reduction=1.02e-03
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.16e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.80e-05
--- time_gemm_kernel=6.48e-02
--- time_gemm_reduction=9.14e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
    2   0 -      -2.654426863105  -1.84e-03   1.26e-02    4     4   2.78e-01  6.95e-02
    2   1 -      -2.436959129202  -8.65e-04   5.19e-03    4     4   2.78e-01  6.95e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.00e-05
--- time_gemm_kernel=6.50e-02
--- time_gemm_reduction=9.14e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.48e-02
--- time_gemm_reduction=8.96e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   4.10e-01  6.83e-02
    3   1 -      -2.436975259478  -1.61e-05   1.59e-03    6     6   4.10e-01  6.83e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.49e-02
--- time_gemm_reduction=8.95e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.60e-05
--- time_gemm_kernel=6.49e-02
--- time_gemm_reduction=9.04e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   5.42e-01  6.78e-02
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   5.42e-01  6.78e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.00e-05
--- time_gemm_kernel=6.42e-02
--- time_gemm_reduction=8.96e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.43e-02
--- time_gemm_reduction=8.89e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   6.72e-01  6.72e-02
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   6.72e-01  6.72e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.42e-02
--- time_gemm_reduction=8.95e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=8.86e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   8.02e-01  6.68e-02
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   8.02e-01  6.68e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.40e-02
--- time_gemm_reduction=8.86e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=6.42e-02
--- time_gemm_reduction=8.88e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   9.33e-01  6.66e-02
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   9.33e-01  6.66e-02
TIMING for Davidson : 9.33e-01  T(cal/comm/rest)=9.25e-01,0.00e+00,8.00e-03
optimized energies: isweep=3 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=3 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=12544:0.0957MB:9.35e-05GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=5.16e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.17e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=6.28e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,1.17e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(3,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=8.29e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 9.41e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 9.39e-01 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.00e-03 S  per = 0.11  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.11
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.11
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per = 0.21
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 9.33e-01 S  per =   99
end rank=0 sweep_twodot
##### time_sweep: 1.96e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.95e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 3.00e-03 S  per = 0.15  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 2.00e-03 S  per =  0.1
 T(preprocess_formulae_Hxlist2) = 4.00e-03 S  per =  0.2
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 5.00e-03 S  per = 0.26
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.94e+00 S  per =   99
##### time_global: 9.52e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 9.48e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 2.30e-02 S  per = 0.24  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 6.00e-03 S  per = 0.063
 T(preprocess_formulae_Hxlist2) = 2.40e-02 S  per = 0.25
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.10e-02 S  per = 0.22
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 9.40e+00 S  per =   99

=== end rank=0 ibond=2

=== start rank=0 ibond=3
ISWEEP,IBOND=3,3

isweep=3 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x45739ff0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 1.000e-03 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 2.000e-03 S -----
T(inter/Hmu/Hxlist/tot)=0.002,0,0.001,0.003
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=3.63e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=4.2e-05
--- time_gemm_kernel=0.0706
--- time_gemm_reduction=0.00113
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.12e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.1e-05
--- time_gemm_kernel=0.0705
--- time_gemm_reduction=0.0011
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.12e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   1.43e-01  7.15e-02
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   1.43e-01  7.15e-02
TIMING for Davidson : 1.43e-01  T(cal/comm/rest)=1.42e-01,0.00e+00,1.00e-03
optimized energies: isweep=3 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=3 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep3_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=54432:0.415MB:0.000406GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=7.21e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,5.07e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=9.07e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,5.07e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=8.44e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 1.54e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.51e-01 S  per =   98  per(accum) = 98
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 98
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 98
 T(renrm) = 1.00e-03 S  per = 0.65  per(accum) = 99
 T( save) = 0.00e+00 S  per =    0  per(accum) = 99
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.66
 T(preprocess_formulae_Hxlist2) = 3.00e-03 S  per =    2
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per =  1.3
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.43e-01 S  per =   95
end rank=0 sweep_twodot
##### time_sweep: 2.12e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 2.10e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 4.00e-03 S  per = 0.19  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 3.00e-03 S  per = 0.14
 T(preprocess_formulae_Hxlist2) = 7.00e-03 S  per = 0.33
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 7.00e-03 S  per = 0.33
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.08e+00 S  per =   99
##### time_global: 9.68e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 9.63e+00 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 2.40e-02 S  per = 0.25  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 7.00e-03 S  per = 0.073
 T(preprocess_formulae_Hxlist2) = 2.70e-02 S  per = 0.28
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.30e-02 S  per = 0.24
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 9.54e+00 S  per =   99

=== end rank=0 ibond=3

======================================================================
sweep_data::summary isweep=3
----------------------------------------------------------------------
sweep parameters: isweep=3 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069
 eav_max=-2.54574720706 [ibond=0]  dwt_min=0 [ibond=0]
 eav_min=-2.54574720867 [ibond=2]  dwt_max=0.00057836023195 [ibond=1]
 eav_diff=1.60474833422e-09
 sweep energies: isweep=3 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[0]=-2.65451696664
 sweep energies: isweep=3 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=3
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Tav/S | Taccum/S| t_kernel/S | t_reduction/S 
         0  2  10  1.00e-04  1.00e-04 | 52 | 2.83e+00 | 5.44e-02 | 2.83e+00 | 2.76e+00 | 3.94e-02
         1  2  20  1.00e-04  0.00e+00 | 45 | 2.67e+00 | 5.94e-02 | 5.50e+00 | 2.59e+00 | 3.70e-02
         2  2  20  1.00e-04  0.00e+00 | 31 | 2.07e+00 | 6.69e-02 | 7.58e+00 | 2.01e+00 | 2.86e-02
         3  2  20  1.00e-04  0.00e+00 | 31 | 2.12e+00 | 6.84e-02 | 9.70e+00 | 2.05e+00 | 2.96e-02
results: isweep, dcut, dwt, energies (delta_e)
         0      10 +9.51e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
         1      20 +5.26e-04 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.62e-13)
         2      20 +5.26e-04 e[0]=-2.65451696664 (-3.11e-15) e[1]=-2.43697745069 (4.88e-15)
         3      20 +0.00e+00 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

======================================================================
sweep parameters: isweep=4 dots=2 dcut=20 eps=1.00e-04 noise=0.00e+00
======================================================================

=== start rank=0 ibond=0
ISWEEP,IBOND=4,0

isweep=4 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x457f6460
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 1.000e-03 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=5.49e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.3e-05
--- time_gemm_kernel=0.0706
--- time_gemm_reduction=0.00114
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.12e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.8e-05
--- time_gemm_kernel=0.0691
--- time_gemm_reduction=0.00108
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.14e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891  -1.00e+03   6.88e-02    2     2   1.42e-01  7.10e-02
    1   1 -      -2.436233901339  -1.00e+03   4.38e-02    2     2   1.42e-01  7.10e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.20e-05
--- time_gemm_kernel=6.70e-02
--- time_gemm_reduction=1.01e-03
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.18e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.43e-02
--- time_gemm_reduction=8.86e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    2   0 -      -2.654428675110  -1.73e-03   1.26e-02    4     4   2.75e-01  6.88e-02
    2   1 -      -2.436964455587  -7.31e-04   4.22e-03    4     4   2.75e-01  6.88e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.39e-02
--- time_gemm_reduction=8.76e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.39e-02
--- time_gemm_reduction=8.75e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    3   0 -      -2.654509664652  -8.10e-05   3.66e-03    6     6   4.05e-01  6.75e-02
    3   1 -      -2.436976459250  -1.20e-05   1.11e-03    6     6   4.05e-01  6.75e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=8.81e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.60e-05
--- time_gemm_kernel=6.36e-02
--- time_gemm_reduction=9.09e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    4   0 -      -2.654516020764  -6.36e-06   1.14e-03    6     8   5.34e-01  6.68e-02
    4   1 -      -2.436977285934  -8.27e-07   4.03e-04    6     8   5.34e-01  6.68e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.46e-02
--- time_gemm_reduction=8.97e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.42e-02
--- time_gemm_reduction=8.82e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    5   0 -      -2.654516818921  -7.98e-07   4.45e-04    6    10   6.65e-01  6.65e-02
    5   1 -      -2.436977409925  -1.24e-07   2.05e-04    6    10   6.65e-01  6.65e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.52e-02
--- time_gemm_reduction=9.03e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.21e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=4.00e-05
--- time_gemm_kernel=6.37e-02
--- time_gemm_reduction=8.76e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    6   0 -      -2.654516950786  -1.32e-07   1.57e-04    6    12   7.96e-01  6.63e-02
    6   1 +      -2.436977447171  -3.72e-08   7.42e-05    6    12   7.96e-01  6.63e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.39e-02
--- time_gemm_reduction=8.82e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   8.61e-01  6.62e-02
    7   1 +      -2.436977447171  -2.66e-15   7.42e-05    5    13   8.61e-01  6.62e-02
TIMING for Davidson : 8.61e-01  T(cal/comm/rest)=8.54e-01,0.00e+00,7.00e-03
optimized energies: isweep=4 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=4 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=12544:0.0957MB:9.35e-05GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=5.16e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.17e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=6.28e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,1.17e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(1,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=8.44e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 8.69e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 8.67e-01 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.00e-03 S  per = 0.12  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.12
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.12
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per = 0.23
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 8.61e-01 S  per =   99
end rank=0 sweep_twodot
##### time_sweep: 8.69e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 8.67e-01 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.00e-03 S  per = 0.12  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.12
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.12
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per = 0.23
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 8.61e-01 S  per =   99
##### time_global: 1.05e+01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.05e+01 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 2.50e-02 S  per = 0.24  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 8.00e-03 S  per = 0.076
 T(preprocess_formulae_Hxlist2) = 2.80e-02 S  per = 0.27
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.50e-02 S  per = 0.24
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.04e+01 S  per =   99

=== end rank=0 ibond=0

=== start rank=0 ibond=1
ISWEEP,IBOND=4,1

isweep=4 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x43fd8a80
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 1.000e-03 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.002
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=3.63e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.1e-05
--- time_gemm_kernel=0.069
--- time_gemm_reduction=0.00108
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.14e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.3e-05
--- time_gemm_kernel=0.069
--- time_gemm_reduction=0.00106
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.14e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   1.40e-01  7.00e-02
    1   1 +      -2.436977447171  -1.00e+03   7.42e-05    2     2   1.40e-01  7.00e-02
TIMING for Davidson : 1.40e-01  T(cal/comm/rest)=1.40e-01,0.00e+00,0.00e+00
optimized energies: isweep=4 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=4 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep4_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=54432:0.415MB:0.000406GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=7.21e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,5.07e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=9.07e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,5.07e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=8.59e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 1.49e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.46e-01 S  per =   98  per(accum) = 98
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 98
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 98
 T(renrm) = 1.00e-03 S  per = 0.67  per(accum) = 99
 T( save) = 0.00e+00 S  per =    0  per(accum) = 99
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.68
 T(preprocess_formulae_Hxlist2) = 2.00e-03 S  per =  1.4
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per =  1.4
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.40e-01 S  per =   96
end rank=0 sweep_twodot
##### time_sweep: 1.02e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.01e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 2.00e-03 S  per =  0.2  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 2.00e-03 S  per =  0.2
 T(preprocess_formulae_Hxlist2) = 3.00e-03 S  per =  0.3
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 4.00e-03 S  per = 0.39
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.00e+00 S  per =   99
##### time_global: 1.07e+01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.06e+01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 2.60e-02 S  per = 0.24  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 9.00e-03 S  per = 0.085
 T(preprocess_formulae_Hxlist2) = 3.00e-02 S  per = 0.28
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.70e-02 S  per = 0.25
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.05e+01 S  per =   99

=== end rank=0 ibond=1

=== start rank=0 ibond=2
ISWEEP,IBOND=4,2

isweep=4 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x473be620
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 1.000e-03 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=5.49e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3e-05
--- time_gemm_kernel=0.0694
--- time_gemm_reduction=0.0011
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.14e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.2e-05
--- time_gemm_kernel=0.0706
--- time_gemm_reduction=0.00109
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.12e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592  -1.00e+03   7.01e-02    2     2   1.42e-01  7.10e-02
    1   1 -      -2.436094100141  -1.00e+03   4.92e-02    2     2   1.42e-01  7.10e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.20e-05
--- time_gemm_kernel=6.78e-02
--- time_gemm_reduction=1.03e-03
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.17e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.45e-02
--- time_gemm_reduction=8.84e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
    2   0 -      -2.654426863105  -1.84e-03   1.26e-02    4     4   2.76e-01  6.90e-02
    2   1 -      -2.436959129202  -8.65e-04   5.19e-03    4     4   2.76e-01  6.90e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.39e-02
--- time_gemm_reduction=8.90e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.80e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=9.06e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   4.06e-01  6.77e-02
    3   1 -      -2.436975259478  -1.61e-05   1.59e-03    6     6   4.06e-01  6.77e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.38e-02
--- time_gemm_reduction=8.94e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.60e-05
--- time_gemm_kernel=6.42e-02
--- time_gemm_reduction=9.13e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   5.36e-01  6.70e-02
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   5.36e-01  6.70e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=8.88e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.40e-02
--- time_gemm_reduction=9.01e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   6.66e-01  6.66e-02
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   6.66e-01  6.66e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.40e-02
--- time_gemm_reduction=8.82e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.80e-05
--- time_gemm_kernel=6.36e-02
--- time_gemm_reduction=8.82e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   7.96e-01  6.63e-02
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   7.96e-01  6.63e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.43e-02
--- time_gemm_reduction=8.88e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.37e-02
--- time_gemm_reduction=8.85e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   9.26e-01  6.61e-02
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   9.26e-01  6.61e-02
TIMING for Davidson : 9.26e-01  T(cal/comm/rest)=9.18e-01,0.00e+00,8.00e-03
optimized energies: isweep=4 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=4 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=12544:0.0957MB:9.35e-05GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=5.16e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.17e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=6.28e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,1.17e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(3,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=8.59e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 9.34e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 9.32e-01 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.00e-03 S  per = 0.11  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.11
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.11
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per = 0.21
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 9.26e-01 S  per =   99
end rank=0 sweep_twodot
##### time_sweep: 1.95e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.94e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 3.00e-03 S  per = 0.15  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 3.00e-03 S  per = 0.15
 T(preprocess_formulae_Hxlist2) = 4.00e-03 S  per = 0.21
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 6.00e-03 S  per = 0.31
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.93e+00 S  per =   99
##### time_global: 1.16e+01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.16e+01 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 2.70e-02 S  per = 0.23  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-02 S  per = 0.086
 T(preprocess_formulae_Hxlist2) = 3.10e-02 S  per = 0.27
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.90e-02 S  per = 0.25
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.15e+01 S  per =   99

=== end rank=0 ibond=2

=== start rank=0 ibond=3
ISWEEP,IBOND=4,3

isweep=4 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x457f8d80
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 1.000e-03 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.002
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=3.63e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.1e-05
--- time_gemm_kernel=0.0707
--- time_gemm_reduction=0.00112
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.12e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.3e-05
--- time_gemm_kernel=0.0707
--- time_gemm_reduction=0.0011
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.12e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   1.43e-01  7.15e-02
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   1.43e-01  7.15e-02
TIMING for Davidson : 1.43e-01  T(cal/comm/rest)=1.42e-01,0.00e+00,1.00e-03
optimized energies: isweep=4 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=4 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep4_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=54432:0.415MB:0.000406GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=7.21e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,5.07e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=9.07e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,5.07e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=8.74e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 1.53e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.50e-01 S  per =   98  per(accum) = 98
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 98
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 98
 T(renrm) = 1.00e-03 S  per = 0.65  per(accum) = 99
 T( save) = 0.00e+00 S  per =    0  per(accum) = 99
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.67
 T(preprocess_formulae_Hxlist2) = 2.00e-03 S  per =  1.3
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per =  1.3
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.44e-01 S  per =   96
end rank=0 sweep_twodot
##### time_sweep: 2.10e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 2.09e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 4.00e-03 S  per = 0.19  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 4.00e-03 S  per = 0.19
 T(preprocess_formulae_Hxlist2) = 6.00e-03 S  per = 0.29
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 8.00e-03 S  per = 0.38
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.07e+00 S  per =   99
##### time_global: 1.18e+01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.17e+01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 2.80e-02 S  per = 0.24  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.10e-02 S  per = 0.094
 T(preprocess_formulae_Hxlist2) = 3.30e-02 S  per = 0.28
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 3.10e-02 S  per = 0.26
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.16e+01 S  per =   99

=== end rank=0 ibond=3

======================================================================
sweep_data::summary isweep=4
----------------------------------------------------------------------
sweep parameters: isweep=4 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069
 eav_max=-2.54574720706 [ibond=1]  dwt_min=0 [ibond=0]
 eav_min=-2.54574720867 [ibond=2]  dwt_max=0.00057836023195 [ibond=1]
 eav_diff=1.60474744604e-09
 sweep energies: isweep=4 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[0]=-2.65451696664
 sweep energies: isweep=4 dots=2 dcut=20 deff=16 dwt=+0.000e+00 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=4
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Tav/S | Taccum/S| t_kernel/S | t_reduction/S 
         0  2  10  1.00e-04  1.00e-04 | 52 | 2.83e+00 | 5.44e-02 | 2.83e+00 | 2.76e+00 | 3.94e-02
         1  2  20  1.00e-04  0.00e+00 | 45 | 2.67e+00 | 5.94e-02 | 5.50e+00 | 2.59e+00 | 3.70e-02
         2  2  20  1.00e-04  0.00e+00 | 31 | 2.07e+00 | 6.69e-02 | 7.58e+00 | 2.01e+00 | 2.86e-02
         3  2  20  1.00e-04  0.00e+00 | 31 | 2.12e+00 | 6.84e-02 | 9.70e+00 | 2.05e+00 | 2.96e-02
         4  2  20  1.00e-04  0.00e+00 | 31 | 2.11e+00 | 6.80e-02 | 1.18e+01 | 2.04e+00 | 2.95e-02
results: isweep, dcut, dwt, energies (delta_e)
         0      10 +9.51e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
         1      20 +5.26e-04 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.66e-13)
         2      20 +5.26e-04 e[0]=-2.65451696664 (8.88e-16) e[1]=-2.43697745069 (1.78e-15)
         3      20 +0.00e+00 e[0]=-2.65451696664 (4.00e-15) e[1]=-2.43697745069 (-3.11e-15)
         4      20 +0.00e+00 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

======================================================================
sweep parameters: isweep=5 dots=2 dcut=20 eps=1.00e-04 noise=0.00e+00
======================================================================

=== start rank=0 ibond=0
ISWEEP,IBOND=5,0

isweep=5 ibond=0/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x45838f80
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 1.000e-03 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=5.49e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.2e-05
--- time_gemm_kernel=0.0707
--- time_gemm_reduction=0.00113
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.12e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.3e-05
--- time_gemm_kernel=0.0709
--- time_gemm_reduction=0.00111
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.11e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652701464891  -1.00e+03   6.88e-02    2     2   1.43e-01  7.15e-02
    1   1 -      -2.436233901339  -1.00e+03   4.38e-02    2     2   1.43e-01  7.15e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.30e-05
--- time_gemm_kernel=6.82e-02
--- time_gemm_reduction=1.04e-03
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.16e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=5.20e-05
--- time_gemm_kernel=6.49e-02
--- time_gemm_reduction=9.01e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
    2   0 -      -2.654428675110  -1.73e-03   1.26e-02    4     4   2.79e-01  6.98e-02
    2   1 -      -2.436964455587  -7.31e-04   4.22e-03    4     4   2.79e-01  6.98e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.47e-02
--- time_gemm_reduction=8.95e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.43e-02
--- time_gemm_reduction=8.91e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    3   0 -      -2.654509664652  -8.10e-05   3.66e-03    6     6   4.10e-01  6.83e-02
    3   1 -      -2.436976459250  -1.20e-05   1.11e-03    6     6   4.10e-01  6.83e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.90e-05
--- time_gemm_kernel=6.48e-02
--- time_gemm_reduction=9.16e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.37e-02
--- time_gemm_reduction=8.84e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    4   0 -      -2.654516020764  -6.36e-06   1.14e-03    6     8   5.40e-01  6.75e-02
    4   1 -      -2.436977285934  -8.27e-07   4.03e-04    6     8   5.40e-01  6.75e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.46e-02
--- time_gemm_reduction=8.87e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.70e-05
--- time_gemm_kernel=6.40e-02
--- time_gemm_reduction=8.92e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    5   0 -      -2.654516818921  -7.98e-07   4.45e-04    6    10   6.71e-01  6.71e-02
    5   1 -      -2.436977409925  -1.24e-07   2.05e-04    6    10   6.71e-01  6.71e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.40e-02
--- time_gemm_reduction=8.93e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=6.42e-02
--- time_gemm_reduction=8.72e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    6   0 -      -2.654516950786  -1.32e-07   1.57e-04    6    12   8.01e-01  6.68e-02
    6   1 +      -2.436977447171  -3.72e-08   7.42e-05    6    12   8.01e-01  6.68e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.10e-05
--- time_gemm_kernel=6.36e-02
--- time_gemm_reduction=8.79e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
    7   0 +      -2.654516966956  -1.62e-08   3.99e-05    5    13   8.65e-01  6.65e-02
    7   1 +      -2.436977447171  -1.78e-15   7.42e-05    5    13   8.65e-01  6.65e-02
TIMING for Davidson : 8.65e-01  T(cal/comm/rest)=8.58e-01,0.00e+00,7.00e-03
optimized energies: isweep=5 dots=2 ibond=0 e[0]=-2.65451696696
optimized energies: isweep=5 dots=2 ibond=0 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(1,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=12544:0.0957MB:9.35e-05GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.009  T(cal/comm)=0.009,0
===== CPUmem(GB): tot=5.16e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.17e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=6.28e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,1.17e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(1,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=8.74e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 8.82e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 8.71e-01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 9.00e-03 S  per =    1  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.11
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.11
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per = 0.23
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 8.66e-01 S  per =   99
end rank=0 sweep_twodot
##### time_sweep: 8.82e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 8.71e-01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 9.00e-03 S  per =    1  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.11
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.11
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per = 0.23
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 8.66e-01 S  per =   99
##### time_global: 1.27e+01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.26e+01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 3.70e-02 S  per = 0.29  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.20e-02 S  per = 0.095
 T(preprocess_formulae_Hxlist2) = 3.40e-02 S  per = 0.27
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 3.30e-02 S  per = 0.26
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.25e+01 S  per =   99

=== end rank=0 ibond=0

=== start rank=0 ibond=1
ISWEEP,IBOND=5,1

isweep=5 ibond=1/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x43fd8ab0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 1.000e-03 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.002
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=3.63e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.1e-05
--- time_gemm_kernel=0.0708
--- time_gemm_reduction=0.00113
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.12e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.2e-05
--- time_gemm_kernel=0.0707
--- time_gemm_reduction=0.00109
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.12e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966956  -1.00e+03   3.99e-05    2     2   1.43e-01  7.15e-02
    1   1 +      -2.436977447171  -1.00e+03   7.42e-05    2     2   1.43e-01  7.15e-02
TIMING for Davidson : 1.43e-01  T(cal/comm/rest)=1.42e-01,0.00e+00,1.00e-03
optimized energies: isweep=5 dots=2 ibond=1 e[0]=-2.65451696696
optimized energies: isweep=5 dots=2 ibond=1 e[1]=-2.43697744717
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep5_ibond1.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.784e-04 SvN=1.965e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=lc isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=54432:0.415MB:0.000406GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=7.21e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,5.07e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=9.07e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,5.07e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/lop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=8.89e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 1.53e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.50e-01 S  per =   98  per(accum) = 98
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 98
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 98
 T(renrm) = 1.00e-03 S  per = 0.65  per(accum) = 99
 T( save) = 0.00e+00 S  per =    0  per(accum) = 99
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.67
 T(preprocess_formulae_Hxlist2) = 2.00e-03 S  per =  1.3
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 2.00e-03 S  per =  1.3
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.44e-01 S  per =   96
end rank=0 sweep_twodot
##### time_sweep: 1.03e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.02e+00 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 1.00e-02 S  per = 0.97  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 2.00e-03 S  per =  0.2
 T(preprocess_formulae_Hxlist2) = 3.00e-03 S  per = 0.29
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 4.00e-03 S  per = 0.39
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.01e+00 S  per =   99
##### time_global: 1.28e+01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.27e+01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 3.80e-02 S  per =  0.3  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.30e-02 S  per =  0.1
 T(preprocess_formulae_Hxlist2) = 3.60e-02 S  per = 0.28
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 3.50e-02 S  per = 0.27
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.26e+01 S  per =   99

=== end rank=0 ibond=1

=== start rank=0 ibond=2
ISWEEP,IBOND=5,2

isweep=5 ibond=2/seqsize=4 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,1,1,1 ifNC=0
 suppl= 0 1
 suppr= 4
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 rqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=4e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(16,4,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x4746d6f0
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 1.000e-03 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=5.49e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=4.4e-05
--- time_gemm_kernel=0.0663
--- time_gemm_reduction=0.00101
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.19e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.8e-05
--- time_gemm_kernel=0.0644
--- time_gemm_reduction=0.000949
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.23e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 -      -2.652588819592  -1.00e+03   7.01e-02    2     2   1.32e-01  6.60e-02
    1   1 -      -2.436094100141  -1.00e+03   4.92e-02    2     2   1.32e-01  6.60e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=3.00e-05
--- time_gemm_kernel=6.44e-02
--- time_gemm_reduction=9.23e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.45e-02
--- time_gemm_reduction=8.94e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    2   0 -      -2.654426863105  -1.84e-03   1.26e-02    4     4   2.63e-01  6.58e-02
    2   1 -      -2.436959129202  -8.65e-04   5.19e-03    4     4   2.63e-01  6.58e-02
--- preprocess_Hx_batchGPU ---
--- time_copy=2.20e-05
--- time_gemm_kernel=8.86e-01
--- time_gemm_reduction=1.12e-03
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=8.91e+04
--- preprocess_Hx_batchGPU ---
--- time_copy=3.10e-05
--- time_gemm_kernel=6.56e-02
--- time_gemm_reduction=9.90e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.20e+06
    3   0 -      -2.654508902835  -8.20e-05   3.56e-03    6     6   1.22e+00  2.03e-01
    3   1 -      -2.436975259478  -1.61e-05   1.59e-03    6     6   1.22e+00  2.03e-01
--- preprocess_Hx_batchGPU ---
--- time_copy=3.00e-05
--- time_gemm_kernel=6.43e-02
--- time_gemm_reduction=9.24e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=6.45e-02
--- time_gemm_reduction=8.99e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
    4   0 -      -2.654515665767  -6.76e-06   1.29e-03    6     8   1.35e+00  1.69e-01
    4   1 -      -2.436977069548  -1.81e-06   5.99e-04    6     8   1.35e+00  1.69e-01
--- preprocess_Hx_batchGPU ---
--- time_copy=3.00e-05
--- time_gemm_kernel=6.44e-02
--- time_gemm_reduction=9.12e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.60e-05
--- time_gemm_kernel=6.44e-02
--- time_gemm_reduction=8.89e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    5   0 -      -2.654516771324  -1.11e-06   5.13e-04    6    10   1.48e+00  1.48e-01
    5   1 -      -2.436977368102  -2.99e-07   2.92e-04    6    10   1.48e+00  1.48e-01
--- preprocess_Hx_batchGPU ---
--- time_copy=2.80e-05
--- time_gemm_kernel=6.46e-02
--- time_gemm_reduction=8.94e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.22e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=6.40e-02
--- time_gemm_reduction=8.83e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    6   0 -      -2.654516945140  -1.74e-07   1.83e-04    6    12   1.61e+00  1.34e-01
    6   1 -      -2.436977443846  -7.57e-08   1.16e-04    6    12   1.61e+00  1.34e-01
--- preprocess_Hx_batchGPU ---
--- time_copy=2.70e-05
--- time_gemm_kernel=6.38e-02
--- time_gemm_reduction=9.02e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.24e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=3.80e-05
--- time_gemm_kernel=6.41e-02
--- time_gemm_reduction=8.82e-04
--- cost_gemm_kernel=7.90e+04 flops=kernel/time=1.23e+06
    7   0 +      -2.654516966643  -2.15e-08   4.64e-05    6    14   1.74e+00  1.24e-01
    7   1 +      -2.436977450693  -6.85e-09   2.69e-05    6    14   1.74e+00  1.24e-01
TIMING for Davidson : 1.74e+00  T(cal/comm/rest)=1.73e+00,0.00e+00,6.00e-03
optimized energies: isweep=5 dots=2 ibond=2 e[0]=-2.65451696664
optimized energies: isweep=5 dots=2 ibond=2 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,0,0.0e+00
ctns::decimation_row: 
 qbond: qsuper nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
decimation summary: keep all 16 states
===== CPUmem(GB): tot=4.0e-05 (comb,oper,dvdson,hvec,renorm)=7.0e-06,3.3e-05,0.0e+00,0.0e+00,0.0e+00 =====
ctns::oper_renorm_opAll coord=(3,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=4 wfsize=36 worktot=12544:0.0957MB:9.35e-05GB
 qops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
TIMING for Renormalization : 0.001  T(cal/comm)=0.001,0
===== CPUmem(GB): tot=5.16e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,1.17e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=6.28e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,4.33e-05,0,0,1.17e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(3,0) size=0.0106MB speed=infMB/s
fsize=0.0106MB ratio=1 usage=8.89e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 1.75e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.75e+00 S  per = 1e+02  per(accum) = 1e+02
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(renrm) = 1.00e-03 S  per = 0.057  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.00e-03 S  per = 0.057
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.057
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 3.00e-03 S  per = 0.17
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.74e+00 S  per = 1e+02
end rank=0 sweep_twodot
##### time_sweep: 2.78e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 2.77e+00 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 1.10e-02 S  per =  0.4  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 3.00e-03 S  per = 0.11
 T(preprocess_formulae_Hxlist2) = 4.00e-03 S  per = 0.14
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 7.00e-03 S  per = 0.25
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.75e+00 S  per =   99
##### time_global: 1.46e+01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.45e+01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 3.90e-02 S  per = 0.27  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.40e-02 S  per = 0.097
 T(preprocess_formulae_Hxlist2) = 3.70e-02 S  per = 0.26
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 3.80e-02 S  per = 0.26
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.44e+01 S  per =   99

=== end rank=0 ibond=2

=== start rank=0 ibond=3
ISWEEP,IBOND=5,3

isweep=5 ibond=3/seqsize=4 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
start sweep_twodot
ctns::sweep_twodot alg_hvec=7 alg_renorm=2 mpisize=1 maxthreads=112
start rank=0 sweep_twodot
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,2,1,1 ifNC=1
 suppl= 0
 suppr= 3 4
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
----- TIMING FOR ctns::oper_pool<Tm>::fetch : 0.000e+00 S -----
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 rqops: oplist=CABPQSH nops=C:4 A:6 B:10 P:15 Q:21 S:6 H:1 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=1388:0.0106MB:1.03e-05GB
 c1qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 c2qops: oplist=CABPQSH nops=C:2 A:1 B:3 P:28 Q:36 S:8 H:1 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=146:0.00111MB:1.09e-06GB
 qops(tot)=1826:0.0139MB:1.36e-05GB
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=200:0.00153MB:1.49e-06GB
total mem of comb=1043:0.00796MB:7.77e-06GB
===== CPUmem(GB): tot=2.14e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,0 =====
wf4(diml,dimr,dimc1,dimc2)=(4,16,4,4) nnz=100:0.000763MB
stensor4: wf own=1 _data=0x47392540
qinfo4: wf sym=(5,1)
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=9 dimAll=16
 (2,0):4 (1,-1):2 (1,1):2 (3,-1):2 (3,1):2 (0,0):1 (2,-2):1 (2,2):1 (4,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qver nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=49 nblocks=576 size=100:0.000763MB
rank,diag0=0
rank,diag1=0
rank,diag2=0
----- TIMING FOR symbolic_formulae_twodot with size=188 : 0.000e+00 S -----
intermediates<Tm>::init maxthreads=112
 no. of formulae=188
 no. of intermediate operators=46
 size of intermediate operators=1104:0.00842MB:8.23e-06GB
----- TIMING FOR intermediates<Tm>::init : 0.000e+00 S -----
T(inter/Hmu/Hxlist/tot)=0,0,0.001,0.001
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.000e-03 S -----
partition of Hxlst:
 * rank=0 size(H_formulae)=188 size(Hxlst)=5552 blksize=4 cost=7.9e+04
total cost for Hx=7.9e+04
rank=0 gpumem.size(GB)=38.4 gpumem.used(GB)=3.11e-05 (oper,dvdson,batch)(GB)=2.18e-05,1.49e-06,7.81e-06 batchsize=131
===== CPUmem(GB): tot=3.63e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,1.49e-05,0,0 =====
ctns::pdvdsonSolver_nkr::solve_iter is_complex=0 mpisize=1
--- preprocess_Hx_batchGPU ---
--- time_copy=3.8e-05
--- time_gemm_kernel=0.0646
--- time_gemm_reduction=0.000944
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.22e+06
--- preprocess_Hx_batchGPU ---
--- time_copy=2.8e-05
--- time_gemm_kernel=0.0645
--- time_gemm_reduction=0.000926
--- cost_gemm_kernel=7.9e+04 flops=kernel/time=1.22e+06
settings: ndim=100 neig=2 maxcycle=30 nbuff=4 memory=1.34e-05GB
          damping=1e-10 crit_v=1.000e-04 crit_indp=1.000e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s
    1   0 +      -2.654516966643  -1.00e+03   4.64e-05    2     2   1.31e-01  6.55e-02
    1   1 +      -2.436977450693  -1.00e+03   2.69e-05    2     2   1.31e-01  6.55e-02
TIMING for Davidson : 1.31e-01  T(cal/comm/rest)=1.30e-01,0.00e+00,1.00e-03
optimized energies: isweep=5 dots=2 ibond=3 e[0]=-2.65451696664
optimized energies: isweep=5 dots=2 ibond=3 e[1]=-2.43697745069
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,20,1,0.0e+00
ctns::decimation_row: fname=./scratch/sweep/decimation_isweep5_ibond3.txt
 qbond: qsuper nsym=16 dimAll=64
 (2,0):9 (3,-1):9 (3,1):9 (4,0):9 (1,-1):3 (1,1):3 (2,-2):3 (2,2):3 (4,-2):3 (4,2):3 (5,-1):3 (5,1):3 (0,0):1 (3,-3):1 (3,3):1 (6,0):1
decimation summary: 64->20 dwt=+5.258e-04 SvN=1.960e+00
===== CPUmem(GB): tot=2.138e-05 (comb,oper,dvdson,hvec,renorm)=7.771e-06,1.360e-05,0.000e+00,0.000e+00,0.000e+00 =====
ctns::oper_renorm_opAll coord=(2,0) superblock=cr isym=2 ifkr=0 alg_renorm=2 mpisize=1
----- TIMING FOR symbolic_formulae_renorm with size=63 : 0.000e+00 S -----
preprocess for renorm: opsize=36 wfsize=150 worktot=54432:0.415MB:0.000406GB
 qops: oplist=CABPQSH nops=C:6 A:15 B:21 P:6 Q:10 S:4 H:1 
        dim(bra,ket)=20,20 size(op)=78:0.000595MB size(tot)=2598:0.0198MB:1.94e-05GB
TIMING for Renormalization : 0  T(cal/comm)=0,0
===== CPUmem(GB): tot=7.21e-05 (comb,oper,dvdson,hvec,renorm)=7.77e-06,1.36e-05,0,0,5.07e-05 =====
comb::display_size
 rbases: len=5 mem=27:0.000206MB:2.01e-07GB
 rsites: len=5 mem=610:0.00465MB:4.54e-06GB
 rwfuns: len=4 mem=16:0.000122MB:1.19e-07GB
 lsites: len=5 mem=190:0.00145MB:1.42e-06GB
 psi: len=2 mem=96:0.000732MB:7.15e-07GB
total mem of comb=939:0.00716MB:7e-06GB
===== CPUmem(GB): tot=9.07e-05 (comb,oper,dvdson,hvec,renorm)=7e-06,3.3e-05,0,0,5.07e-05 =====
### lzd ###0
T[save](info/data/tot)=0,0,0 fname=./scratch/sweep/rop(2,0) size=0.0198MB speed=infMB/s
fsize=0.0198MB ratio=1 usage=9.04e-05GB available=8.68e+03GB
=== lzd ===0
--- lzd ---0
##### time_local: 1.38e-01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.35e-01 S  per =   98  per(accum) = 98
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 98
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 98
 T(renrm) = 1.00e-03 S  per = 0.72  per(accum) = 99
 T( save) = 0.00e+00 S  per =    0  per(accum) = 99
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 0.00e+00 S  per =    0
 T(preprocess_formulae_Hxlist2) = 1.00e-03 S  per = 0.74
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 1.00e-03 S  per = 0.74
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.31e-01 S  per =   97
end rank=0 sweep_twodot
##### time_sweep: 2.92e+00 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 2.90e+00 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 1.20e-02 S  per = 0.41  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 3.00e-03 S  per =  0.1
 T(preprocess_formulae_Hxlist2) = 5.00e-03 S  per = 0.17
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 8.00e-03 S  per = 0.28
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 2.88e+00 S  per =   99
##### time_global: 1.47e+01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.46e+01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 4.00e-02 S  per = 0.27  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.40e-02 S  per = 0.096
 T(preprocess_formulae_Hxlist2) = 3.80e-02 S  per = 0.26
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 3.90e-02 S  per = 0.27
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.45e+01 S  per =   99

=== end rank=0 ibond=3

======================================================================
sweep_data::summary isweep=5
----------------------------------------------------------------------
sweep parameters: isweep=5 dots=2 dcut=20 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=13 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=20 dwt=+5.784e-04 nmvp=2 e[0]=-2.65451696696 e[1]=-2.43697744717
 ibond=2 bond=(2,0)-(3,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=14 e[0]=-2.65451696664 e[1]=-2.43697745069
 ibond=3 bond=(1,0)-(2,0) forward=0 deff=20 dwt=+5.258e-04 nmvp=2 e[0]=-2.65451696664 e[1]=-2.43697745069
 eav_max=-2.54574720706 [ibond=1]  dwt_min=0 [ibond=0]
 eav_min=-2.54574720867 [ibond=3]  dwt_max=0.00057836023195 [ibond=1]
 eav_diff=1.60474655786e-09
 sweep energies: isweep=5 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[0]=-2.65451696664
 sweep energies: isweep=5 dots=2 dcut=20 deff=20 dwt=+5.258e-04 e[1]=-2.43697745069
----------------------------------------------------------------------
summary of sweep optimization up to isweep=5
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Tav/S | Taccum/S| t_kernel/S | t_reduction/S 
         0  2  10  1.00e-04  1.00e-04 | 52 | 2.83e+00 | 5.44e-02 | 2.83e+00 | 2.76e+00 | 3.94e-02
         1  2  20  1.00e-04  0.00e+00 | 45 | 2.67e+00 | 5.94e-02 | 5.50e+00 | 2.59e+00 | 3.70e-02
         2  2  20  1.00e-04  0.00e+00 | 31 | 2.07e+00 | 6.69e-02 | 7.58e+00 | 2.01e+00 | 2.86e-02
         3  2  20  1.00e-04  0.00e+00 | 31 | 2.12e+00 | 6.84e-02 | 9.70e+00 | 2.05e+00 | 2.96e-02
         4  2  20  1.00e-04  0.00e+00 | 31 | 2.11e+00 | 6.80e-02 | 1.18e+01 | 2.04e+00 | 2.95e-02
         5  2  20  1.00e-04  0.00e+00 | 31 | 2.93e+00 | 9.44e-02 | 1.47e+01 | 2.85e+00 | 2.93e-02
results: isweep, dcut, dwt, energies (delta_e)
         0      10 +9.51e-03 e[0]=-2.65208108952 (2.44e-03) e[1]=-2.43068987874 (6.29e-03)
         1      20 +5.26e-04 e[0]=-2.65451696664 (4.01e-12) e[1]=-2.43697745069 (-2.68e-13)
         2      20 +5.26e-04 e[0]=-2.65451696664 (4.44e-16) e[1]=-2.43697745069 (-8.88e-16)
         3      20 +0.00e+00 e[0]=-2.65451696664 (3.55e-15) e[1]=-2.43697745069 (-5.77e-15)
         4      20 +0.00e+00 e[0]=-2.65451696664 (-4.44e-16) e[1]=-2.43697745069 (-2.66e-15)
         5      20 +5.26e-04 e[0]=-2.65451696664 (0.00e+00) e[1]=-2.43697745069 (0.00e+00)
======================================================================

----- TIMING FOR ctns::sweep_opt : 1.473e+01 S -----
##### time_global: 1.47e+01 S #####
 T(fetch) = 0.00e+00 S  per =    0  per(accum) = 0
 T(hdiag) = 0.00e+00 S  per =    0  per(accum) = 0
 T(dvdsn) = 1.46e+01 S  per =   99  per(accum) = 99
 T(decim) = 0.00e+00 S  per =    0  per(accum) = 99
 T(guess) = 0.00e+00 S  per =    0  per(accum) = 99
 T(renrm) = 4.00e-02 S  per = 0.27  per(accum) = 1e+02
 T( save) = 0.00e+00 S  per =    0  per(accum) = 1e+02
 T(preprocess_op_wf           ) = 0.00e+00 S  per =    0
 T(symbolic_formulae_twodot   ) = 1.40e-02 S  per = 0.096
 T(preprocess_formulae_Hxlist2) = 3.80e-02 S  per = 0.26
 T(verbose1_debug_Hxlst2      ) = 0.00e+00 S  per =    0
 T(op_lrc1c2_memory_host2GPU  ) = 0.00e+00 S  per =    0
 T(inter_memory_host2GPU      ) = 0.00e+00 S  per =    0
 T(batchsize_compute          ) = 0.00e+00 S  per =    0
 T(generate_mmtasks           ) = 3.90e-02 S  per = 0.27
 T(save_mmtasks               ) = 0.00e+00 S  per =    0
 T(preprocess_Hx_batchGPU     ) = 1.45e+01 S  per =   99

ctns::rcanon_save fname=./scratch/rcanon_new.info

Congrats! CTNS calculation finishes successfully. Wed Mar  1 21:18:16 2023

