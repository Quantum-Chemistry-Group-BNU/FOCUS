
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Sat Nov 23 06:50:18 2024

GIT_HASH = 4f03402d367bde51faf85f5707fd24cbc48d11ae

mpisize = 1 maxthreads = 64

input file = input.dat

schedule::read fname = input.dat
----------------------------------------------------------------------
dtype 0
sorb 40
nelec 30
twom 0
twos 0 
integral_file moleinfo/fmole.info
scratch ./scratch

$ci
dets
0 2 4 6 8 10 12 14 16 18 20 22 24 36 38   1 3 15 17 19 21 23 25 27 29 31 33 35 37 39
end
checkms
nroots 1 
schedule
0 1.e-3
end
maxiter 1
$end

$ctns
verbose 1
qkind rNS
tosu2
maxdets 10 #000 # keep dets as much as possible
topology_file topology/topo4
thresh_proj 1.e-10
thresh_ortho 1.e-8 #1.e-10
nroots 1 
schedule
0  2 10 1.e-4 0.0
end
maxsweep 1
alg_hvec 19
alg_hinter 2
alg_hcoper 2
alg_renorm 19
alg_rinter 2
alg_rcoper 1
task_dmrg
ifab2pq
ifdist1
ifdistc
ifnccl
#save_formulae
batchhvec 4 4 4
batchrenorm 4 4 4
$end

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
sorb  = 40
nelec = 30
twom  = 0
twos  = 0
integral_file = moleinfo/fmole.info
perfcomm = 0

===== params_ci::print =====
nroots = 1
no. of unique seeds = 1
0-th det: 0 1 2 3 4 6 8 10 12 14 15 16 17 18 19 20 21 22 23 24 25 27 29 31 33 35 36 37 38 39 
flip = 0
eps0 = 0.01
miniter = 0
maxiter = 1
schedule: iter eps1
0 0.001
convergence parameters
deltaE = 1e-10
checkms = 1
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 0
jroot = 0
load = 0
ci_file = ci.info
cthrd = 0.1
ifanalysis = 0
rdm = 0
init_aufbau = 0
init_seniority = 0

===== params_ctns::print =====
qkind = rNS
topology_file = topology/topo4
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
task_oodmrg = 0
task_vmc = 0
task_expand = 0
task_tononsu2 = 0
task_prop = 
task_schmidt = 0
schmidt_file = svalues
restart_sweep = 0
restart_bond = 0
timestamp = 0
ciroots = 
maxdets = 10
thresh_proj = 1.000000e-10
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
outprec = 12
nroots = 1
guess = 1
dbranch = 0
maxsweep = 1
maxbond = -1
schedule: isweep, dots, dcut, eps, noise
0 2 10 1.000000e-04 0.000000e+00
rcfprefix = 
alg_hvec = 19
alg_hinter = 2
alg_hcoper = 2
alg_renorm = 19
alg_rinter = 2
alg_rcoper = 1
alg_rdm = 1
alg_decim = 1
notrunc = 0
ifab2pq = 1
ifdist1 = 1
ifdistc = 1
save_formulae = 0
sort_formulae = 0
save_mmtask = 0
batchhvec = 4 4 4
batchrenorm = 4 4 4
batchmem = 1.000000e+01
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
precond = 1
rcanon_file = 
rcanon2_file = 
iomode = 0
async_fetch = 0
async_save = 0
async_remove = 0
ifnccl = 1
iroot = 0
jroot = 0
nsample = 5000
nprt = 10
pthrd = -1.000000e-02
thresh_cabs = 1.100000e+00
detbasis = 0
tosu2 = 1
thresh_tosu2 = 1.000000e-08
singlet = 0
diagcheck = 0
savebin = 0
fromnosym = 0
oodmrg parameters:
 iprt=1
 maxiter=10
 dfac=2
 macroiter=5
 microiter=50
 alpha=5.000000e-01
 thrdopt=1.000000e-04
 thrdloc=1.000000e-06
 thrddwt=1.000000e+00
 thrdeps=1.000000e-08
 nptloc=2.000000e+01
 acceptall=0
 unrestricted=0
 urot=
inputconf = 
saveconfs = 
loadconfs = 
debug_rdm = 0
alg_mrpt2 = 0
nv2 = 0
nc2 = 0

io::create_scratch scratch=./scratch

gpu_init
CUDA Runtime version: 12040
CUBLAS version: 120405
rank=0 num_gpus=8 device_id=0 magma_queue=0x55a31a32b5c0

ctns::topology::read fname=topology/topo4
0
1
2
3
4
16
17
18
19
5
6
7
8
9
10
11
12
13
14
15

ctns::topology::print ifmps=1 ntotal=20 nphysical=20 nbackbone=20
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
 i=5 : 16 
 i=6 : 17 
 i=7 : 18 
 i=8 : 19 
 i=9 : 5 
 i=10 : 6 
 i=11 : 7 
 i=12 : 8 
 i=13 : 9 
 i=14 : 10 
 i=15 : 11 
 i=16 : 12 
 i=17 : 13 
 i=18 : 14 
 i=19 : 15 
rcoord:
 idx=0 coord=(19,0) rindex=0 node: lindex=19 porb=15 type=0 center=(-1,-1) left=(18,0) right=(-2,-2)
 idx=1 coord=(18,0) rindex=1 node: lindex=18 porb=14 type=1 center=(-1,-1) left=(17,0) right=(19,0)
 idx=2 coord=(17,0) rindex=2 node: lindex=17 porb=13 type=1 center=(-1,-1) left=(16,0) right=(18,0)
 idx=3 coord=(16,0) rindex=3 node: lindex=16 porb=12 type=1 center=(-1,-1) left=(15,0) right=(17,0)
 idx=4 coord=(15,0) rindex=4 node: lindex=15 porb=11 type=1 center=(-1,-1) left=(14,0) right=(16,0)
 idx=5 coord=(14,0) rindex=5 node: lindex=14 porb=10 type=1 center=(-1,-1) left=(13,0) right=(15,0)
 idx=6 coord=(13,0) rindex=6 node: lindex=13 porb=9 type=1 center=(-1,-1) left=(12,0) right=(14,0)
 idx=7 coord=(12,0) rindex=7 node: lindex=12 porb=8 type=1 center=(-1,-1) left=(11,0) right=(13,0)
 idx=8 coord=(11,0) rindex=8 node: lindex=11 porb=7 type=1 center=(-1,-1) left=(10,0) right=(12,0)
 idx=9 coord=(10,0) rindex=9 node: lindex=10 porb=6 type=1 center=(-1,-1) left=(9,0) right=(11,0)
 idx=10 coord=(9,0) rindex=10 node: lindex=9 porb=5 type=1 center=(-1,-1) left=(8,0) right=(10,0)
 idx=11 coord=(8,0) rindex=11 node: lindex=8 porb=19 type=1 center=(-1,-1) left=(7,0) right=(9,0)
 idx=12 coord=(7,0) rindex=12 node: lindex=7 porb=18 type=1 center=(-1,-1) left=(6,0) right=(8,0)
 idx=13 coord=(6,0) rindex=13 node: lindex=6 porb=17 type=1 center=(-1,-1) left=(5,0) right=(7,0)
 idx=14 coord=(5,0) rindex=14 node: lindex=5 porb=16 type=1 center=(-1,-1) left=(4,0) right=(6,0)
 idx=15 coord=(4,0) rindex=15 node: lindex=4 porb=4 type=1 center=(-1,-1) left=(3,0) right=(5,0)
 idx=16 coord=(3,0) rindex=16 node: lindex=3 porb=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=17 coord=(2,0) rindex=17 node: lindex=2 porb=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=18 coord=(1,0) rindex=18 node: lindex=1 porb=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=19 coord=(0,0) rindex=19 node: lindex=0 porb=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(19,0) rsupport: 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) rsupport: 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) rsupport: 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) rsupport: 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) rsupport: 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) rsupport: 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) rsupport: 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) rsupport: 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) rsupport: 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) rsupport: 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) rsupport: 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) rsupport: 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) rsupport: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) rsupport: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 
 idx=14 coord=(5,0) rsupport: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 
 idx=15 coord=(4,0) rsupport: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 
 idx=16 coord=(3,0) rsupport: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 
 idx=17 coord=(2,0) rsupport: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 
 idx=18 coord=(1,0) rsupport: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 
 idx=19 coord=(0,0) rsupport: 0 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(19,0) corbs: 15 ; rorbs: ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) corbs: 14 ; rorbs: 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) corbs: 13 ; rorbs: 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) corbs: 12 ; rorbs: 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) corbs: 11 ; rorbs: 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) corbs: 10 ; rorbs: 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) corbs: 9 ; rorbs: 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) corbs: 8 ; rorbs: 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) corbs: 7 ; rorbs: 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) corbs: 6 ; rorbs: 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) corbs: 5 ; rorbs: 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) corbs: 19 ; rorbs: 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) corbs: 18 ; rorbs: 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) corbs: 17 ; rorbs: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 
 idx=14 coord=(5,0) corbs: 16 ; rorbs: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 
 idx=15 coord=(4,0) corbs: 4 ; rorbs: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 
 idx=16 coord=(3,0) corbs: 3 ; rorbs: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 
 idx=17 coord=(2,0) corbs: 2 ; rorbs: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 
 idx=18 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 
 idx=19 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9 32 33 34 35 36 37 38 39 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31

fci::ci_load fname=./scratch/ci.info

ctns::rcanon_init qkind=qNSz

fci::ci_truncate ciconfs=1641 maxdets=10 ifortho=1
 iroot=0 <CI[trunc]|CI>=6.112239740347e-01

ctns::init_rbases rdm_svd=1.500e+00 thresh_proj=1.000e-10

idx=
idx=
idx=
idx=
idx=
idx=
idx=1
idx=
idx=
idx=97
idx=16
idx= node=(3,0) type=1 rsupport=3 
idx=8 node=(11,0) type=1 rsupport=7 8 node= (18, node=5104
idx=9 10 11 412
idx=(
idx= node=1718 node= node=191212 node=(7,(014
idx=13(
idx= node=
idx= node=15), node=,3 node=60( 9, type=0( node=15 node=
idx=2013)11401,(0(16,0) type=1 rsupport= node= type=1 rsupport=  rsupport=) type=0) type=(110 node=) node=11( node=18 19 5 6 7 8 21, node=12,5(( type=09 )(( 0 )4,0) type= node=,,6, type=190  type=1 rsupport=6 7 (1681100)0 type=1) type=0 rsupport= rsupport=1313(6 7 8 9 10 11 rsupport=11 rsupport=14 rsupport=11 58  rsupport=  rsupport=  2 14 15 ,4
,17011 12 13 1415 ,12 3 4 160 ),0) type=1 rsupport=16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
0) type=1 rsupport=17 18 19 5 6 7 8 9 10 11 12 13 14 15 
0) type=0 rsupport=15 
 9 10 11 12 13 14 15 
(17,0) type=1 rsupport=13 14 15 
8 9 10 11 12 13 14 15 
 type=1 rsupport=1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
12
) type=1 rsupport=9 10 11 12 13 14 15 
 18 19 5 6 7 8 9 10 11 12 13 14 15 
 15 
 13 14 15 
 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=14 15 
 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=0 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
) type=1 rsupport=19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=ctns::right_projection<Qm,Tm> thresh_proj=ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
1.000e-10
1.000e-10
1.000e-10
1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
1.000e-10
1.000e-10
1.000e-10
1.000e-10
1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=10,2,10 dimBc=2 1-popBc= dim(space,lspace,rspace)= dim(space,lspace,rspace)=10,1,0.000e+00 dim(space,lspace,rspace)= dim(space,lspace,rspace)=1010, SvN=,2.370e-01
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.693e-02 S -----
10 dimBc=1 1-popBc=12.22e-16 SvN=2.22e-16
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.681e-02 S -----
 dim(space,lspace,rspace)=10,9,3 dimBc=3 1-popBc= dim(space,lspace,rspace)=1.11e-16 SvN=0.572
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.688e-02 S -----
 dim(space,lspace,rspace)=10,7,6 dimBc=4 1-popBc= dim(space,lspace,rspace)=0 SvN=0.692
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.642e-02 S -----
 dim(space,lspace,rspace)=10,3,10 dimBc=3 1-popBc= dim(space,lspace,rspace)=1.11e-16 SvN=0.454
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.581e-02 S -----
 dim(space,lspace,rspace)=10,7,9 dimBc=7 1-popBc=13.33e-16 SvN=,101.25 dimBc=
,1 1-popBc=----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.818e-02 S -----
10,7,8 dimBc=6 1-popBc= dim(space,lspace,rspace)=0 SvN=1.06
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.804e-02 S -----
 dim(space,lspace,rspace)=10,6,10 dimBc=6 1-popBc= dim(space,lspace,rspace)=101.11e-16, SvN=107,10 dimBc=7 1-popBc= dimBc=1.141
 dim(space,lspace,rspace)= 1-popBc=----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.745e-02 S -----
 dim(space,lspace,rspace)=10,6,10 dimBc=6 1-popBc=101.11e-16 SvN=,1.146
,10----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.820e-02 S -----2.22e-16
 SvN=10 dimBc=6 1-popBc=101.11e-16, SvN=5,10 dimBc=5 1-popBc=0,0 SvN= dim(space,lspace,rspace)=0.926
 SvN=----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.926e-02 S ----- dim(space,lspace,rspace)=
4,10 dimBc=4 1-popBc=1.40 SvN=
0.722----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.22e-162.884e-02
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.817e-02 S -----
10,7,4 dimBc=2 1-popBc=
0 SvN=----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.977e-02 S -----
 S -----
10,7,10 dimBc=7 1-popBc=1.140
 SvN=----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.867e-02 S -----10
,10,9,3 dimBc=3 1-popBc=2.22e-161.11e-16 SvN= SvN=0.572
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.982e-02 S -----0.291

----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.923e-02 S -----8
2.22e-16
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.988e-02 S -----
1.4
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.034e-02 S -----
,4 dimBc=3 1-popBc=0 SvN=0.495
----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.099e-02 S -----

generated rbases with thresh_proj=1e-10
 idx=0 node=(19,0) type=0 shape=4,4 1-popBc=0.000e+00
 idx=1 node=(18,0) type=1 shape=3,3 1-popBc=1.110e-16
 idx=2 node=(17,0) type=1 shape=3,3 1-popBc=1.110e-16
 idx=3 node=(16,0) type=1 shape=4,3 1-popBc=0.000e+00
 idx=4 node=(15,0) type=1 shape=4,2 1-popBc=0.000e+00
 idx=5 node=(14,0) type=1 shape=6,4 1-popBc=0.000e+00
 idx=6 node=(13,0) type=1 shape=8,6 1-popBc=0.000e+00
 idx=7 node=(12,0) type=1 shape=9,7 1-popBc=3.331e-16
 idx=8 node=(11,0) type=1 shape=10,7 1-popBc=0.000e+00
 idx=9 node=(10,0) type=1 shape=10,7 1-popBc=0.000e+00
 idx=10 node=(9,0) type=1 shape=10,6 1-popBc=1.110e-16
 idx=11 node=(8,0) type=1 shape=10,6 1-popBc=1.110e-16
 idx=12 node=(7,0) type=1 shape=10,6 1-popBc=1.110e-16
 idx=13 node=(6,0) type=1 shape=10,5 1-popBc=0.000e+00
 idx=14 node=(5,0) type=1 shape=10,4 1-popBc=0.000e+00
 idx=15 node=(4,0) type=1 shape=10,3 1-popBc=1.110e-16
 idx=16 node=(3,0) type=1 shape=10,2 1-popBc=0.000e+00
 idx=17 node=(2,0) type=1 shape=10,1 1-popBc=2.220e-16
 idx=18 node=(1,0) type=1 shape=10,1 1-popBc=2.220e-16
 idx=19 node=(0,0) type=0 shape=10,1 1-popBc=2.220e-16
maximum bond dimension = 7
----- TIMING FOR ctns::init_rbases : 3.772e-02 S -----

ctns::init_rsites qkind=qNSz thresh_ortho=1e-08
 idx=0 node=(19,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 deviate=0 TIMING=8.619e-06 S
 idx=1 node=(18,0)[1] shape(l,r,c)=(3,4,4) maxdiff=4.018e-16 deviate=0 TIMING=7.299e-05 S
 idx=2 node=(17,0)[1] shape(l,r,c)=(3,3,4) maxdiff=6.280e-16 deviate=0 TIMING=6.795e-05 S
 idx=3 node=(16,0)[1] shape(l,r,c)=(3,3,4) maxdiff=5.103e-16 deviate=0 TIMING=4.011e-05 S
 idx=4 node=(15,0)[1] shape(l,r,c)=(2,3,4) maxdiff=5.701e-16 deviate=0 TIMING=5.539e-05 S
 idx=5 node=(14,0)[1] shape(l,r,c)=(4,2,4) maxdiff=1.243e-15 deviate=0 TIMING=4.056e-05 S
 idx=6 node=(13,0)[1] shape(l,r,c)=(6,4,4) maxdiff=4.520e-16 deviate=0 TIMING=6.396e-05 S
 idx=7 node=(12,0)[1] shape(l,r,c)=(7,6,4) maxdiff=6.188e-16 deviate=0 TIMING=4.551e-05 S
 idx=8 node=(11,0)[1] shape(l,r,c)=(7,7,4) maxdiff=2.220e-16 deviate=0 TIMING=4.376e-05 S
 idx=9 node=(10,0)[1] shape(l,r,c)=(7,7,4) maxdiff=4.441e-16 deviate=0 TIMING=5.993e-05 S
 idx=10 node=(9,0)[1] shape(l,r,c)=(6,7,4) maxdiff=0.000e+00 deviate=0 TIMING=5.374e-05 S
 idx=11 node=(8,0)[1] shape(l,r,c)=(6,6,4) maxdiff=0.000e+00 deviate=0 TIMING=3.075e-05 S
 idx=12 node=(7,0)[1] shape(l,r,c)=(6,6,4) maxdiff=0.000e+00 deviate=0 TIMING=2.032e-05 S
 idx=13 node=(6,0)[1] shape(l,r,c)=(5,6,4) maxdiff=2.220e-16 deviate=0 TIMING=7.404e-05 S
 idx=14 node=(5,0)[1] shape(l,r,c)=(4,5,4) maxdiff=4.441e-16 deviate=0 TIMING=3.777e-05 S
 idx=15 node=(4,0)[1] shape(l,r,c)=(3,4,4) maxdiff=4.441e-16 deviate=0 TIMING=1.964e-05 S
 idx=16 node=(3,0)[1] shape(l,r,c)=(2,3,4) maxdiff=0.000e+00 deviate=0 TIMING=1.949e-05 S
 idx=17 node=(2,0)[1] shape(l,r,c)=(1,2,4) maxdiff=6.661e-16 deviate=0 TIMING=3.680e-05 S
 idx=18 node=(1,0)[1] shape(l,r,c)=(1,1,4) maxdiff=8.882e-16 deviate=0 TIMING=2.289e-05 S
 idx=19 node=(0,0)[0] shape(l,r,c)=(1,1,4) maxdiff=8.882e-16 deviate=0 TIMING=1.493e-05 S
----- TIMING FOR ctns::init_rsites : 2.387e-03 S -----

ctns::init_rwfuns qkind=qNSz thresh_ortho=1e-08
qtensor2: wf2 own=1 _data=0x55a31e9f1530
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.63e-06MB

check state overlaps ...
matrix: ova_rwfuns size=(1,1)
      1.0000e+00 
matrix: ova0_vs size=(1,1)
      1.0000e+00 
diff of ova matrices = 5.551e-16
----- TIMING FOR ctns::init_rwfuns : 9.651e-04 S -----

ctns::init_rcanon thresh_ortho=1e-08

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=10
matrix: <CI|CTNS[0]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[0]> size=(1,1)
      1.0000e+00 

rcanon::rcanon_canonicalize ifortho=1 ifab=1 nroots=1 dmax=7
----- TIMING FOR ctns::rcanon_canonicalize : 2.679e-03 S -----

matrix: <CTNS[new]|CTNS[new]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=10
matrix: <CI|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=3 maxdiff=1.577e-16 deviate=0
 idx=2 node=(17,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=3 maxdiff=1.110e-16 deviate=0
 idx=4 node=(15,0) Drow=2 maxdiff=6.305e-16 deviate=0
 idx=5 node=(14,0) Drow=4 maxdiff=2.220e-16 deviate=0
 idx=6 node=(13,0) Drow=6 maxdiff=3.140e-16 deviate=0
 idx=7 node=(12,0) Drow=7 maxdiff=4.710e-16 deviate=0
 idx=8 node=(11,0) Drow=7 maxdiff=1.110e-16 deviate=0
 idx=9 node=(10,0) Drow=7 maxdiff=2.220e-16 deviate=0
 idx=10 node=(9,0) Drow=6 maxdiff=2.220e-16 deviate=0
 idx=11 node=(8,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=12 node=(7,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=13 node=(6,0) Drow=5 maxdiff=2.220e-16 deviate=0
 idx=14 node=(5,0) Drow=4 maxdiff=2.220e-16 deviate=0
 idx=15 node=(4,0) Drow=3 maxdiff=2.220e-16 deviate=0
 idx=16 node=(3,0) Drow=2 maxdiff=2.220e-16 deviate=0
 idx=17 node=(2,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=18 node=(1,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x55a31ea02cb0
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x55a31ea02cb0
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 2.493e-03 S -----
----- TIMING FOR ctns::rcanon_init : 5.302e-02 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci

ctns::rcanon_tosu2 twos=0 thresh_tosu2=1e-08
>>> idx=1
 qbond: ys nsym=2 dimAll=3
 (2,2):1 (3,1):2
 sigs2sum=1 diff(1-sigs2sum)=-2.22e-16
>>> idx=2
 qbond: ys nsym=2 dimAll=3
 (3,3):1 (4,2):2
 sigs2sum=1 diff(1-sigs2sum)=-2.22e-16
>>> idx=3
 qbond: ys nsym=2 dimAll=3
 (5,3):2 (6,2):1
 sigs2sum=1 diff(1-sigs2sum)=-4.44e-16
>>> idx=4
 qbond: ys nsym=1 dimAll=2
 (7,3):2
 sigs2sum=1 diff(1-sigs2sum)=-2.22e-16
>>> idx=5
 qbond: ys nsym=3 dimAll=4
 (8,2):1 (8,4):1 (9,3):2
 sigs2sum=1 diff(1-sigs2sum)=-2.22e-16
>>> idx=6
 qbond: ys nsym=3 dimAll=6
 (10,2):2 (10,4):2 (11,3):2
 sigs2sum=1 diff(1-sigs2sum)=-2.22e-16
>>> idx=7
 qbond: ys nsym=3 dimAll=8
 (12,2):3 (12,4):3 (13,3):2
 sigs2sum=1 diff(1-sigs2sum)=2.22e-16
>>> idx=8
 qbond: ys nsym=3 dimAll=9
 (14,2):4 (14,4):4 (15,3):1
 sigs2sum=1 diff(1-sigs2sum)=4.44e-16
>>> idx=9
 qbond: ys nsym=5 dimAll=16
 (15,1):4 (15,3):6 (15,5):4 (16,2):1 (16,4):1
 sigs2sum=1 diff(1-sigs2sum)=6.66e-16
>>> idx=10
 qbond: ys nsym=7 dimAll=19
 (16,0):3 (16,2):5 (16,4):5 (16,6):3 (17,1):1 (17,3):1 (17,5):1
 sigs2sum=1 diff(1-sigs2sum)=6.66e-16
>>> idx=11
 qbond: ys nsym=7 dimAll=19
 (18,0):3 (18,2):5 (18,4):5 (18,6):3 (19,1):1 (19,3):1 (19,5):1
 sigs2sum=1 diff(1-sigs2sum)=6.66e-16
>>> idx=12
 qbond: ys nsym=7 dimAll=19
 (20,0):3 (20,2):5 (20,4):5 (20,6):3 (21,1):1 (21,3):1 (21,5):1
 sigs2sum=1 diff(1-sigs2sum)=8.88e-16
>>> idx=13
 qbond: ys nsym=7 dimAll=17
 (21,1):3 (21,3):4 (21,5):4 (21,7):3 (22,2):1 (22,4):1 (22,6):1
 sigs2sum=1 diff(1-sigs2sum)=8.88e-16
>>> idx=14
 qbond: ys nsym=7 dimAll=15
 (22,2):3 (22,4):3 (22,6):3 (22,8):3 (23,3):1 (23,5):1 (23,7):1
 sigs2sum=1 diff(1-sigs2sum)=1.11e-15
>>> idx=15
 qbond: ys nsym=9 dimAll=14
 (23,1):2 (23,3):2 (23,5):2 (23,7):2 (23,9):2 (24,2):1 (24,4):1 (24,6):1 (24,8):1
 sigs2sum=1 diff(1-sigs2sum)=1.78e-15
>>> idx=16
 qbond: ys nsym=11 dimAll=11
 (24,0):1 (24,2):1 (24,4):1 (24,6):1 (24,8):1 (24,10):1 (25,1):1 (25,3):1 (25,5):1 (25,7):1 (25,9):1
 sigs2sum=1 diff(1-sigs2sum)=1.44e-15
>>> idx=17
 qbond: ys nsym=6 dimAll=6
 (26,0):1 (26,2):1 (26,4):1 (26,6):1 (26,8):1 (26,10):1
 sigs2sum=1 diff(1-sigs2sum)=1.89e-15
>>> idx=18
 qbond: ys nsym=6 dimAll=6
 (28,0):1 (28,2):1 (28,4):1 (28,6):1 (28,8):1 (28,10):1
 sigs2sum=1 diff(1-sigs2sum)=1.89e-15
>>> idx=19
 qbond: ys nsym=6 dimAll=6
 (30,0):1 (30,2):1 (30,4):1 (30,6):1 (30,8):1 (30,10):1
 sigs2sum=1 diff(1-sigs2sum)=2.22e-15

ctns::updateRWFuns twos=0

### iroot=0 ###
> j=0 sym=(30,0,0) pop[j]=0.167 target sector!
matrix: rwfunW size=(1,1)
      4.0825e-01 
> j=2 sym=(30,2,0) pop[j]=0.357
matrix: rwfunW size=(1,1)
      5.9761e-01 
> j=6 sym=(30,4,0) pop[j]=0.298
matrix: rwfunW size=(1,1)
      5.4554e-01 
> j=12 sym=(30,6,0) pop[j]=0.139
matrix: rwfunW size=(1,1)
     -3.7268e-01 
> j=20 sym=(30,8,0) pop[j]=0.0357
matrix: rwfunW size=(1,1)
     -1.8898e-01 
> j=30 sym=(30,10,0) pop[j]=0.00397
matrix: rwfunW size=(1,1)
     -6.2994e-02 
total pop=1 diff(1-pop)=2.220446049e-15

comb::display_shape qkind=qNSz
 idx=0 node=(19,0) shape(l,r,c)=(4,1,4)
 idx=1 node=(18,0) shape(l,r,c)=(3,4,4)
 idx=2 node=(17,0) shape(l,r,c)=(3,3,4)
 idx=3 node=(16,0) shape(l,r,c)=(3,3,4)
 idx=4 node=(15,0) shape(l,r,c)=(2,3,4)
 idx=5 node=(14,0) shape(l,r,c)=(4,2,4)
 idx=6 node=(13,0) shape(l,r,c)=(6,4,4)
 idx=7 node=(12,0) shape(l,r,c)=(7,6,4)
 idx=8 node=(11,0) shape(l,r,c)=(7,7,4)
 idx=9 node=(10,0) shape(l,r,c)=(7,7,4)
 idx=10 node=(9,0) shape(l,r,c)=(6,7,4)
 idx=11 node=(8,0) shape(l,r,c)=(6,6,4)
 idx=12 node=(7,0) shape(l,r,c)=(6,6,4)
 idx=13 node=(6,0) shape(l,r,c)=(5,6,4)
 idx=14 node=(5,0) shape(l,r,c)=(4,5,4)
 idx=15 node=(4,0) shape(l,r,c)=(3,4,4)
 idx=16 node=(3,0) shape(l,r,c)=(2,3,4)
 idx=17 node=(2,0) shape(l,r,c)=(1,2,4)
 idx=18 node=(1,0) shape(l,r,c)=(1,1,4)
 idx=19 node=(0,0) shape(l,r,c)=(1,1,4)
qtensor2: wf2 own=1 _data=0x55a31e9ef530
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629394531e-06MB

comb::display_shape qkind=qNS
 idx=0 node=(19,0) shape(l,r,c)=(3,1,3) shapeU1(l,r,c)=(4,1,4)
 idx=1 node=(18,0) shape(l,r,c)=(3,3,3) shapeU1(l,r,c)=(7,4,4)
 idx=2 node=(17,0) shape(l,r,c)=(3,3,3) shapeU1(l,r,c)=(10,7,4)
 idx=3 node=(16,0) shape(l,r,c)=(3,3,3) shapeU1(l,r,c)=(11,10,4)
 idx=4 node=(15,0) shape(l,r,c)=(2,3,3) shapeU1(l,r,c)=(8,11,4)
 idx=5 node=(14,0) shape(l,r,c)=(4,2,3) shapeU1(l,r,c)=(16,8,4)
 idx=6 node=(13,0) shape(l,r,c)=(6,4,3) shapeU1(l,r,c)=(24,16,4)
 idx=7 node=(12,0) shape(l,r,c)=(8,6,3) shapeU1(l,r,c)=(32,24,4)
 idx=8 node=(11,0) shape(l,r,c)=(9,8,3) shapeU1(l,r,c)=(36,32,4)
 idx=9 node=(10,0) shape(l,r,c)=(16,9,3) shapeU1(l,r,c)=(64,36,4)
 idx=10 node=(9,0) shape(l,r,c)=(19,16,3) shapeU1(l,r,c)=(76,64,4)
 idx=11 node=(8,0) shape(l,r,c)=(19,19,3) shapeU1(l,r,c)=(76,76,4)
 idx=12 node=(7,0) shape(l,r,c)=(19,19,3) shapeU1(l,r,c)=(76,76,4)
 idx=13 node=(6,0) shape(l,r,c)=(17,19,3) shapeU1(l,r,c)=(85,76,4)
 idx=14 node=(5,0) shape(l,r,c)=(15,17,3) shapeU1(l,r,c)=(90,85,4)
 idx=15 node=(4,0) shape(l,r,c)=(14,15,3) shapeU1(l,r,c)=(84,90,4)
 idx=16 node=(3,0) shape(l,r,c)=(11,14,3) shapeU1(l,r,c)=(66,84,4)
 idx=17 node=(2,0) shape(l,r,c)=(6,11,3) shapeU1(l,r,c)=(36,66,4)
 idx=18 node=(1,0) shape(l,r,c)=(6,6,3) shapeU1(l,r,c)=(36,36,4)
 idx=19 node=(0,0) shape(l,r,c)=(6,6,3) shapeU1(l,r,c)=(36,36,4)
qtensor2: wf2 own=1 _data=0x55a31e9ef070
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=6 dimAll=6
 (30,0):1 (30,2):1 (30,4):1 (30,6):1 (30,8):1 (30,10):1
total no. of nonzero blocks=1 nblocks=6 size=1:7.629394531e-06MB

Summary of sweep projection: nroot[nonsu2]=1 => nstate[su2]=1
----- TIMING FOR ctns::rcanon_tosu2 : 2.590e-02 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci_su2

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=3 maxdiff=1.209e-17 deviate=0
 idx=2 node=(17,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=3 maxdiff=3.533e-16 deviate=0
 idx=4 node=(15,0) Drow=2 maxdiff=4.471e-16 deviate=0
 idx=5 node=(14,0) Drow=4 maxdiff=4.441e-16 deviate=0
 idx=6 node=(13,0) Drow=6 maxdiff=3.140e-16 deviate=0
 idx=7 node=(12,0) Drow=8 maxdiff=4.003e-16 deviate=0
 idx=8 node=(11,0) Drow=9 maxdiff=4.441e-16 deviate=0
 idx=9 node=(10,0) Drow=16 maxdiff=6.689e-16 deviate=0
 idx=10 node=(9,0) Drow=19 maxdiff=1.097e-15 deviate=0
 idx=11 node=(8,0) Drow=19 maxdiff=1.250e-15 deviate=0
 idx=12 node=(7,0) Drow=19 maxdiff=1.100e-15 deviate=0
 idx=13 node=(6,0) Drow=17 maxdiff=1.595e-15 deviate=0
 idx=14 node=(5,0) Drow=15 maxdiff=1.347e-15 deviate=0
 idx=15 node=(4,0) Drow=14 maxdiff=2.294e-16 deviate=0
 idx=16 node=(3,0) Drow=11 maxdiff=2.220e-16 deviate=0
 idx=17 node=(2,0) Drow=6 maxdiff=3.331e-16 deviate=0
 idx=18 node=(1,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=19 node=(0,0) Drow=6 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x55a31e9f3020
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=6 dimAll=6
 (30,0):1 (30,2):1 (30,4):1 (30,6):1 (30,8):1 (30,10):1
total no. of nonzero blocks=1 nblocks=6 size=1:7.629e-06MB
i=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x55a31e9f3020
      1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 3.049e-03 S -----

integral::load fname = moleinfo/fmole.info
 sorb = 40
 size(int1e) = 1600:0.0122MB:1.19e-05GB
 size(int2e) = 305370:2.33MB:0.00228GB
 ecore = 0.000000000000
----- TIMING FOR integral::load : 9.353e-02 S -----

io::remove_scratch scratch=./scratch/sweep
successfully removed ./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=qNS
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(19,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(19,0) size=7.44e-06GB T[save](info/data/tot)=0.00158,0.00138,0.00296 speed=0.00251GB/S disk[used]=7.7e-06GB
ctns::oper_save iomode=0 fname=./scratch/sweep/rop(19,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/rop(19,0) size=7.44e-06GB T[save](info/data/tot)=0.00139,0.00132,0.00272 speed=0.00274GB/S disk[used]=1.54e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(18,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(18,0) size=7.44e-06GB T[save](info/data/tot)=0.00338,0.00136,0.00474 speed=0.00157GB/S disk[used]=2.31e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(17,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(17,0) size=7.44e-06GB T[save](info/data/tot)=0.00125,0.00134,0.00259 speed=0.00287GB/S disk[used]=3.08e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(16,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(16,0) size=7.44e-06GB T[save](info/data/tot)=0.00143,0.00132,0.00276 speed=0.0027GB/S disk[used]=3.85e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(15,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(15,0) size=7.44e-06GB T[save](info/data/tot)=0.00142,0.00127,0.00269 speed=0.00276GB/S disk[used]=4.62e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(14,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(14,0) size=7.44e-06GB T[save](info/data/tot)=0.00129,0.00125,0.00253 speed=0.00294GB/S disk[used]=5.39e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(13,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(13,0) size=7.44e-06GB T[save](info/data/tot)=0.00125,0.00174,0.00298 speed=0.00249GB/S disk[used]=6.16e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(12,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(12,0) size=7.44e-06GB T[save](info/data/tot)=0.00123,0.00128,0.00252 speed=0.00295GB/S disk[used]=6.93e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(11,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(11,0) size=7.44e-06GB T[save](info/data/tot)=0.0012,0.00118,0.00237 speed=0.00313GB/S disk[used]=7.7e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(10,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(10,0) size=7.44e-06GB T[save](info/data/tot)=0.00114,0.00124,0.00238 speed=0.00312GB/S disk[used]=8.47e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(9,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(9,0) size=7.44e-06GB T[save](info/data/tot)=0.00115,0.00116,0.00232 speed=0.00321GB/S disk[used]=9.23e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(8,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(8,0) size=7.44e-06GB T[save](info/data/tot)=0.00117,0.00125,0.00242 speed=0.00307GB/S disk[used]=0.0001GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(7,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(7,0) size=7.44e-06GB T[save](info/data/tot)=0.00122,0.00114,0.00236 speed=0.00315GB/S disk[used]=0.000108GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(6,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(6,0) size=7.44e-06GB T[save](info/data/tot)=0.00121,0.00119,0.0024 speed=0.0031GB/S disk[used]=0.000115GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(5,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(5,0) size=7.44e-06GB T[save](info/data/tot)=0.00127,0.00122,0.00249 speed=0.00299GB/S disk[used]=0.000123GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(4,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(4,0) size=7.44e-06GB T[save](info/data/tot)=0.00123,0.00137,0.00261 speed=0.00285GB/S disk[used]=0.000131GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(3,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(3,0) size=7.44e-06GB T[save](info/data/tot)=0.00113,0.00193,0.00306 speed=0.00243GB/S disk[used]=0.000139GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(2,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(2,0) size=7.44e-06GB T[save](info/data/tot)=0.00125,0.00142,0.00266 speed=0.00279GB/S disk[used]=0.000146GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(1,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(1,0) size=7.44e-06GB T[save](info/data/tot)=0.00123,0.0012,0.00243 speed=0.00306GB/S disk[used]=0.000154GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(0,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(0,0) size=7.44e-06GB T[save](info/data/tot)=0.00113,0.00138,0.00251 speed=0.00296GB/S disk[used]=0.000162GB
----- TIMING FOR ctns::oper_init_dotCR : 9.823e-02 S -----
T[ctns::oper_init_dotCR](comp/save/tot)=0.0192,0.072,0.0912

idx=1 coord=(18,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
ctns::oper_renorm coord=(18,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:2 S:18 H:1 A:4 B:6 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=75:0.000572MB:5.59e-07GB
CPUmem: VM:7.236e+01GB RSS:5.002e-01GB  Timing: User:1.548e+00S Sys:9.809e-01S Total:2.529e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=31 : 1.442e-04 S -----
rank=0 GPUmem(GB): used=1.54e-05 (oper)=1.54e-05
rank=0 GPUmem(GB): used=1.55e-05 (oper,site)(GB)=1.54e-05,3.73e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=31
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=1.55e-05 (oper,site,rinter)=1.54e-05,3.73e-08,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000276 S size(rtasks)=31 size(Rlst2)=4 T(Rmu/Rlist)=6.05e-05,0.000216 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000375 S size(rtasks)=31 size(Rlst)=146 -----
rank=0 GPUmem(GB): used=1.55e-05 (oper,site,rinter,batch)=1.54e-05,3.73e-08,0,9.79e-06 blksize=4 blksize0=0 batchsize=146
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=2.13e-05,0.0306,0.00679
--- TIMING FOR renorm : t_inter=2.1e-05 t_gemm=3.1e-02 t_reduction=6.8e-03 tot=3.7e-02 ---
 renorm[inter] counter=1 t=2.1e-05 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=3.4e-06 per=9.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=2.2e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=3.0e-02 per=8.1e+01 cost=2.1e+02 flops=7.0e+03
 renorm[gemm] counter=1 i=3 t=1.0e-04 per=2.7e-01 cost=2.3e+02 flops=2.3e+06
 renorm[gemm] counter=1 i=4 t=2.3e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=5 t=2.2e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=6 t=1.1e-04 per=3.0e-01 cost=6.6e+02 flops=5.9e+06
 renorm[gemm] counter=1 total t=3.1e-02 per=8.2e+01 cost=1.1e+03 flops=3.6e+04
 renorm[red] counter=1 t=6.8e-03 per=1.8e+01 cost=6.6e+02 flops=9.7e+04
--- TIMING FOR renorm_tot : t_inter=2.1e-05 t_gemm=3.1e-02 t_reduction=6.8e-03 tot=3.7e-02 ---
 renorm_tot[inter] counter=1 t=2.1e-05 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=3.4e-06 per=9.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=2.2e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=3.0e-02 per=8.1e+01 cost=2.1e+02 flops=7.0e+03
 renorm_tot[gemm] counter=1 i=3 t=1.0e-04 per=2.7e-01 cost=2.3e+02 flops=2.3e+06
 renorm_tot[gemm] counter=1 i=4 t=2.3e-06 per=6.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=5 t=2.2e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=6 t=1.1e-04 per=3.0e-01 cost=6.6e+02 flops=5.9e+06
 renorm_tot[gemm] counter=1 total t=3.1e-02 per=8.2e+01 cost=1.1e+03 flops=3.6e+04
 renorm_tot[red] counter=1 t=6.8e-03 per=1.8e+01 cost=6.6e+02 flops=9.7e+04
qops.to_cpu: size(tot)=75:5.7e-04MB:5.6e-07GB t[to_cpu]=2.6e-05S speed=2.2e-02GB/S
check ||H-H.dagger||=2.512e-15 coord=(18,0) rank=0
ctns::oper_ab2pq coord=(18,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0413 S rank=0 -----
##### local oper_env: 5.105e-02 S #####
 T(local oper_env: fetch) = 4.831e-03 S  per = 9.46  per(accum) = 9.46
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 9.46
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 9.46
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 9.46
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 9.46
 T(local oper_env: renrm) = 4.159e-02 S  per = 81.5  per(accum) = 90.9
 T(local oper_env: save ) = 4.633e-03 S  per = 9.08  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.159e-02 S  T(sum) = 4.159e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.084e-05 S  per = 0.218  per(accum) = 0.218
 T(local oper_env: qops init                    ) = 3.186e-04 S  per = 0.766  per(accum) = 0.985
 T(local oper_env: symbolic_formulae_renorm     ) = 2.311e-04 S  per = 0.556  per(accum) = 1.54
 T(local oper_env: allocate qops on gpu         ) = 1.042e-04 S  per = 0.251  per(accum) = 1.79
 T(local oper_env: site memcpy cpu2gpu          ) = 8.893e-05 S  per = 0.214  per(accum) = 2
 T(local oper_env: rintermediate init           ) = 3.904e-04 S  per = 0.939  per(accum) = 2.94
 T(local oper_env: preprocess_formulae_Rlist2   ) = 4.509e-04 S  per = 1.08  per(accum) = 4.03
 T(local oper_env: rmmtasks init                ) = 1.700e-04 S  per = 0.409  per(accum) = 4.44
 T(local oper_env: qops memset on cpu           ) = 5.200e-08 S  per = 0.000125  per(accum) = 4.44
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.936e-02 S  per = 94.6  per(accum) = 99.1
 T(local oper_env: reduction of opS & opH [nccl]) = 1.186e-06 S  per = 0.00285  per(accum) = 99.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.060e-04 S  per = 0.255  per(accum) = 99.3
 T(local oper_env: deallocate cpu and gpu memory) = 1.520e-05 S  per = 0.0365  per(accum) = 99.4
 T(local oper_env: reduction of opS & opH [comm]) = 8.519e-05 S  per = 0.205  per(accum) = 99.6
 T(local oper_env: conversion from opAB to opPQ ) = 7.857e-05 S  per = 0.189  per(accum) = 99.8
 T(local oper_env: after oper_renorm            ) = 1.028e-04 S  per = 0.247  per(accum) = 100
##### sweep oper_env: 5.105e-02 S #####
 T(sweep oper_env: fetch) = 4.831e-03 S  per = 9.46  per(accum) = 9.46
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 9.46
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 9.46
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 9.46
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 9.46
 T(sweep oper_env: renrm) = 4.159e-02 S  per = 81.5  per(accum) = 90.9
 T(sweep oper_env: save ) = 4.633e-03 S  per = 9.08  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(sweep oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.159e-02 S  T(sum) = 4.159e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 9.084e-05 S  per = 0.218  per(accum) = 0.218
 T(sweep oper_env: qops init                    ) = 3.186e-04 S  per = 0.766  per(accum) = 0.985
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.311e-04 S  per = 0.556  per(accum) = 1.54
 T(sweep oper_env: allocate qops on gpu         ) = 1.042e-04 S  per = 0.251  per(accum) = 1.79
 T(sweep oper_env: site memcpy cpu2gpu          ) = 8.893e-05 S  per = 0.214  per(accum) = 2
 T(sweep oper_env: rintermediate init           ) = 3.904e-04 S  per = 0.939  per(accum) = 2.94
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.509e-04 S  per = 1.08  per(accum) = 4.03
 T(sweep oper_env: rmmtasks init                ) = 1.700e-04 S  per = 0.409  per(accum) = 4.44
 T(sweep oper_env: qops memset on cpu           ) = 5.200e-08 S  per = 0.000125  per(accum) = 4.44
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.936e-02 S  per = 94.6  per(accum) = 99.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.186e-06 S  per = 0.00285  per(accum) = 99.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.060e-04 S  per = 0.255  per(accum) = 99.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.520e-05 S  per = 0.0365  per(accum) = 99.4
 T(sweep oper_env: reduction of opS & opH [comm]) = 8.519e-05 S  per = 0.205  per(accum) = 99.6
 T(sweep oper_env: conversion from opAB to opPQ ) = 7.857e-05 S  per = 0.189  per(accum) = 99.8
 T(sweep oper_env: after oper_renorm            ) = 1.028e-04 S  per = 0.247  per(accum) = 100

idx=2 coord=(17,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHAB nops=C:2 S:18 H:1 A:4 B:6 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=75:0.000572MB:5.59e-07GB
ctns::oper_renorm coord=(17,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:3 S:17 H:1 A:9 B:12 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=105:0.000801MB:7.82e-07GB
CPUmem: VM:7.240e+01GB RSS:5.402e-01GB  Timing: User:1.579e+00S Sys:9.908e-01S Total:2.570e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=42 : 2.345e-04 S -----
rank=0 GPUmem(GB): used=8.78e-06 (oper)=8.78e-06
rank=0 GPUmem(GB): used=8.83e-06 (oper,site)(GB)=8.78e-06,5.22e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=42
 no. of rintermediate operators=141
 no. of coefficients=372:0.00284MB:2.77e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.218e-04 S -----
rank=0 GPUmem(GB): used=1.16e-05 (oper,site,rinter)=8.78e-06,5.22e-08,2.77e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00029 S size(rtasks)=42 size(Rlst2)=4 T(Rmu/Rlist)=5.66e-05,0.000233 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000372 S size(rtasks)=42 size(Rlst)=204 -----
rank=0 GPUmem(GB): used=1.16e-05 (oper,site,rinter,batch)=8.78e-06,5.22e-08,2.77e-06,1.98e-05 blksize=4 blksize0=4 batchsize=204
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000149,0.0054,0.000136
--- TIMING FOR renorm : t_inter=1.5e-04 t_gemm=5.4e-03 t_reduction=1.4e-04 tot=5.7e-03 ---
 renorm[inter] counter=2 t=1.5e-04 per=2.6e+00 cost=9.4e+02 flops=6.3e+06
 renorm[gemm] counter=2 i=0 t=2.9e-06 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=1 t=2.3e-06 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=2 t=2.5e-03 per=4.5e+01 cost=5.7e+02 flops=2.2e+05
 renorm[gemm] counter=2 i=3 t=2.7e-03 per=4.8e+01 cost=5.4e+02 flops=2.0e+05
 renorm[gemm] counter=2 i=4 t=2.7e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=5 t=2.3e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=6 t=1.5e-04 per=2.7e+00 cost=1.1e+03 flops=7.6e+06
 renorm[gemm] counter=2 total t=5.4e-03 per=9.5e+01 cost=2.3e+03 flops=4.2e+05
 renorm[red] counter=2 t=1.4e-04 per=2.4e+00 cost=9.6e+02 flops=7.1e+06
--- TIMING FOR renorm_tot : t_inter=1.7e-04 t_gemm=3.6e-02 t_reduction=6.9e-03 tot=4.3e-02 ---
 renorm_tot[inter] counter=2 t=1.7e-04 per=4.0e-01 cost=9.4e+02 flops=5.5e+06
 renorm_tot[gemm] counter=2 i=0 t=6.2e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=1 t=4.5e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=2 t=3.3e-02 per=7.6e+01 cost=7.8e+02 flops=2.4e+04
 renorm_tot[gemm] counter=2 i=3 t=2.8e-03 per=6.5e+00 cost=7.7e+02 flops=2.7e+05
 renorm_tot[gemm] counter=2 i=4 t=5.0e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=5 t=4.5e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=6 t=2.6e-04 per=6.1e-01 cost=1.8e+03 flops=6.9e+06
 renorm_tot[gemm] counter=2 total t=3.6e-02 per=8.4e+01 cost=3.4e+03 flops=9.3e+04
 renorm_tot[red] counter=2 t=6.9e-03 per=1.6e+01 cost=1.6e+03 flops=2.3e+05
qops.to_cpu: size(tot)=105:8.0e-04MB:7.8e-07GB t[to_cpu]=1.8e-05S speed=4.3e-02GB/S
check ||H-H.dagger||=4.907e-18 coord=(17,0) rank=0
ctns::oper_ab2pq coord=(17,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00953 S rank=0 -----
##### local oper_env: 1.589e-02 S #####
 T(local oper_env: fetch) = 3.189e-03 S  per = 20.1  per(accum) = 20.1
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 20.1
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 20.1
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 20.1
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 20.1
 T(local oper_env: renrm) = 9.796e-03 S  per = 61.6  per(accum) = 81.7
 T(local oper_env: save ) = 2.907e-03 S  per = 18.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.796e-03 S  T(sum) = 9.796e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.741e-05 S  per = 0.892  per(accum) = 0.892
 T(local oper_env: qops init                    ) = 3.108e-04 S  per = 3.17  per(accum) = 4.06
 T(local oper_env: symbolic_formulae_renorm     ) = 3.148e-04 S  per = 3.21  per(accum) = 7.28
 T(local oper_env: allocate qops on gpu         ) = 9.276e-05 S  per = 0.947  per(accum) = 8.23
 T(local oper_env: site memcpy cpu2gpu          ) = 8.683e-05 S  per = 0.886  per(accum) = 9.11
 T(local oper_env: rintermediate init           ) = 4.756e-04 S  per = 4.86  per(accum) = 14
 T(local oper_env: preprocess_formulae_Rlist2   ) = 4.433e-04 S  per = 4.52  per(accum) = 18.5
 T(local oper_env: rmmtasks init                ) = 1.830e-04 S  per = 1.87  per(accum) = 20.4
 T(local oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 0.000347  per(accum) = 20.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 7.432e-03 S  per = 75.9  per(accum) = 96.2
 T(local oper_env: reduction of opS & opH [nccl]) = 8.560e-07 S  per = 0.00874  per(accum) = 96.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 9.258e-05 S  per = 0.945  per(accum) = 97.2
 T(local oper_env: deallocate cpu and gpu memory) = 9.650e-06 S  per = 0.0985  per(accum) = 97.3
 T(local oper_env: reduction of opS & opH [comm]) = 8.613e-05 S  per = 0.879  per(accum) = 98.2
 T(local oper_env: conversion from opAB to opPQ ) = 7.331e-05 S  per = 0.748  per(accum) = 98.9
 T(local oper_env: after oper_renorm            ) = 1.075e-04 S  per =  1.1  per(accum) = 100
##### sweep oper_env: 6.695e-02 S #####
 T(sweep oper_env: fetch) = 8.020e-03 S  per =   12  per(accum) = 12
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 12
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 12
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 12
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 12
 T(sweep oper_env: renrm) = 5.139e-02 S  per = 76.8  per(accum) = 88.7
 T(sweep oper_env: save ) = 7.540e-03 S  per = 11.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.465e+09 S  per = -3.465e+31
 T(sweep oper_env: preprocess                  ) = -3.465e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.139e-02 S  T(sum) = 5.139e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.783e-04 S  per = 0.347  per(accum) = 0.347
 T(sweep oper_env: qops init                    ) = 6.294e-04 S  per = 1.22  per(accum) = 1.57
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.459e-04 S  per = 1.06  per(accum) = 2.63
 T(sweep oper_env: allocate qops on gpu         ) = 1.969e-04 S  per = 0.383  per(accum) = 3.02
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.758e-04 S  per = 0.342  per(accum) = 3.36
 T(sweep oper_env: rintermediate init           ) = 8.660e-04 S  per = 1.69  per(accum) = 5.04
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 8.942e-04 S  per = 1.74  per(accum) = 6.78
 T(sweep oper_env: rmmtasks init                ) = 3.530e-04 S  per = 0.687  per(accum) = 7.47
 T(sweep oper_env: qops memset on cpu           ) = 8.600e-08 S  per = 0.000167  per(accum) = 7.47
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.679e-02 S  per = 91.1  per(accum) = 98.5
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.042e-06 S  per = 0.00397  per(accum) = 98.5
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.985e-04 S  per = 0.386  per(accum) = 98.9
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.485e-05 S  per = 0.0484  per(accum) = 99
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.713e-04 S  per = 0.333  per(accum) = 99.3
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.519e-04 S  per = 0.296  per(accum) = 99.6
 T(sweep oper_env: after oper_renorm            ) = 2.103e-04 S  per = 0.409  per(accum) = 100

idx=3 coord=(16,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHAB nops=C:3 S:17 H:1 A:9 B:12 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=105:0.000801MB:7.82e-07GB
ctns::oper_renorm coord=(16,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:4 S:16 H:1 A:16 B:20 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
CPUmem: VM:7.240e+01GB RSS:5.449e-01GB  Timing: User:1.583e+00S Sys:9.950e-01S Total:2.578e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=57 : 2.536e-04 S -----
rank=0 GPUmem(GB): used=9.3e-06 (oper)=9.3e-06
rank=0 GPUmem(GB): used=9.36e-06 (oper,site)(GB)=9.3e-06,5.96e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=57
 no. of rintermediate operators=149
 no. of coefficients=702:0.00536MB:5.23e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.095e-04 S -----
rank=0 GPUmem(GB): used=1.46e-05 (oper,site,rinter)=9.3e-06,5.96e-08,5.23e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000288 S size(rtasks)=57 size(Rlst2)=4 T(Rmu/Rlist)=6.73e-05,0.000221 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000375 S size(rtasks)=57 size(Rlst)=198 -----
rank=0 GPUmem(GB): used=1.46e-05 (oper,site,rinter,batch)=9.3e-06,5.96e-08,5.23e-06,1.92e-05 blksize=4 blksize0=4 batchsize=198
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000114,0.000377,0.000117
--- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=3.8e-04 t_reduction=1.2e-04 tot=6.1e-04 ---
 renorm[inter] counter=3 t=1.1e-04 per=1.9e+01 cost=3.9e+03 flops=3.4e+07
 renorm[gemm] counter=3 i=0 t=2.7e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=1 t=2.2e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=2 t=1.4e-04 per=2.2e+01 cost=5.2e+02 flops=3.8e+06
 renorm[gemm] counter=3 i=3 t=1.3e-04 per=2.1e+01 cost=8.3e+02 flops=6.5e+06
 renorm[gemm] counter=3 i=4 t=2.3e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=5 t=2.2e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=6 t=1.0e-04 per=1.7e+01 cost=1.6e+03 flops=1.5e+07
 renorm[gemm] counter=3 total t=3.8e-04 per=6.2e+01 cost=3.0e+03 flops=7.8e+06
 renorm[red] counter=3 t=1.2e-04 per=1.9e+01 cost=9.9e+02 flops=8.5e+06
--- TIMING FOR renorm_tot : t_inter=2.8e-04 t_gemm=3.6e-02 t_reduction=7.0e-03 tot=4.4e-02 ---
 renorm_tot[inter] counter=3 t=2.8e-04 per=6.5e-01 cost=4.8e+03 flops=1.7e+07
 renorm_tot[gemm] counter=3 i=0 t=9.0e-06 per=2.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=1 t=6.7e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=2 t=3.3e-02 per=7.6e+01 cost=1.3e+03 flops=3.9e+04
 renorm_tot[gemm] counter=3 i=3 t=2.9e-03 per=6.7e+00 cost=1.6e+03 flops=5.4e+05
 renorm_tot[gemm] counter=3 i=4 t=7.3e-06 per=1.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=5 t=6.8e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=6 t=3.7e-04 per=8.4e-01 cost=3.4e+03 flops=9.3e+06
 renorm_tot[gemm] counter=3 total t=3.6e-02 per=8.3e+01 cost=6.3e+03 flops=1.7e+05
 renorm_tot[red] counter=3 t=7.0e-03 per=1.6e+01 cost=2.6e+03 flops=3.7e+05
qops.to_cpu: size(tot)=145:1.1e-03MB:1.1e-06GB t[to_cpu]=1.6e-05S speed=6.6e-02GB/S
check ||H-H.dagger||=2.512e-15 coord=(16,0) rank=0
ctns::oper_ab2pq coord=(16,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00447 S rank=0 -----
##### local oper_env: 9.724e-03 S #####
 T(local oper_env: fetch) = 2.138e-03 S  per =   22  per(accum) = 22
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 22
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 22
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 22
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 22
 T(local oper_env: renrm) = 4.728e-03 S  per = 48.6  per(accum) = 70.6
 T(local oper_env: save ) = 2.857e-03 S  per = 29.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.728e-03 S  T(sum) = 4.728e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.956e-05 S  per = 1.68  per(accum) = 1.68
 T(local oper_env: qops init                    ) = 3.215e-04 S  per =  6.8  per(accum) = 8.48
 T(local oper_env: symbolic_formulae_renorm     ) = 3.459e-04 S  per = 7.32  per(accum) = 15.8
 T(local oper_env: allocate qops on gpu         ) = 9.549e-05 S  per = 2.02  per(accum) = 17.8
 T(local oper_env: site memcpy cpu2gpu          ) = 9.054e-05 S  per = 1.92  per(accum) = 19.7
 T(local oper_env: rintermediate init           ) = 4.660e-04 S  per = 9.86  per(accum) = 29.6
 T(local oper_env: preprocess_formulae_Rlist2   ) = 4.490e-04 S  per =  9.5  per(accum) = 39.1
 T(local oper_env: rmmtasks init                ) = 1.893e-04 S  per =    4  per(accum) = 43.1
 T(local oper_env: qops memset on cpu           ) = 3.500e-08 S  per = 0.00074  per(accum) = 43.1
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.337e-03 S  per = 49.4  per(accum) = 92.5
 T(local oper_env: reduction of opS & opH [nccl]) = 5.140e-07 S  per = 0.0109  per(accum) = 92.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.503e-05 S  per =  1.8  per(accum) = 94.3
 T(local oper_env: deallocate cpu and gpu memory) = 1.020e-05 S  per = 0.216  per(accum) = 94.5
 T(local oper_env: reduction of opS & opH [comm]) = 7.964e-05 S  per = 1.68  per(accum) = 96.2
 T(local oper_env: conversion from opAB to opPQ ) = 6.955e-05 S  per = 1.47  per(accum) = 97.7
 T(local oper_env: after oper_renorm            ) = 1.089e-04 S  per =  2.3  per(accum) = 100
##### sweep oper_env: 7.667e-02 S #####
 T(sweep oper_env: fetch) = 1.016e-02 S  per = 13.2  per(accum) = 13.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 13.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 13.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 13.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 13.2
 T(sweep oper_env: renrm) = 5.611e-02 S  per = 73.2  per(accum) = 86.4
 T(sweep oper_env: save ) = 1.040e-02 S  per = 13.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -5.197e+09 S  per = -5.197e+31
 T(sweep oper_env: preprocess                  ) = -5.197e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.611e-02 S  T(sum) = 5.611e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.578e-04 S  per = 0.459  per(accum) = 0.459
 T(sweep oper_env: qops init                    ) = 9.509e-04 S  per = 1.69  per(accum) = 2.15
 T(sweep oper_env: symbolic_formulae_renorm     ) = 8.917e-04 S  per = 1.59  per(accum) = 3.74
 T(sweep oper_env: allocate qops on gpu         ) = 2.924e-04 S  per = 0.521  per(accum) = 4.26
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.663e-04 S  per = 0.475  per(accum) = 4.74
 T(sweep oper_env: rintermediate init           ) = 1.332e-03 S  per = 2.37  per(accum) = 7.11
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.343e-03 S  per = 2.39  per(accum) = 9.51
 T(sweep oper_env: rmmtasks init                ) = 5.423e-04 S  per = 0.966  per(accum) = 10.5
 T(sweep oper_env: qops memset on cpu           ) = 1.210e-07 S  per = 0.000216  per(accum) = 10.5
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.912e-02 S  per = 87.5  per(accum) = 98
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.556e-06 S  per = 0.00455  per(accum) = 98
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.836e-04 S  per = 0.505  per(accum) = 98.5
 T(sweep oper_env: deallocate cpu and gpu memory) = 3.505e-05 S  per = 0.0625  per(accum) = 98.6
 T(sweep oper_env: reduction of opS & opH [comm]) = 2.510e-04 S  per = 0.447  per(accum) = 99
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.214e-04 S  per = 0.395  per(accum) = 99.4
 T(sweep oper_env: after oper_renorm            ) = 3.192e-04 S  per = 0.569  per(accum) = 100

idx=4 coord=(15,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHAB nops=C:4 S:16 H:1 A:16 B:20 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=145:0.00111MB:1.08e-06GB
ctns::oper_renorm coord=(15,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:5 S:15 H:1 A:25 B:30 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=124:0.000946MB:9.24e-07GB
CPUmem: VM:7.240e+01GB RSS:5.451e-01GB  Timing: User:1.583e+00S Sys:9.989e-01S Total:2.582e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=76 : 2.936e-04 S -----
rank=0 GPUmem(GB): used=9.44e-06 (oper)=9.44e-06
rank=0 GPUmem(GB): used=9.48e-06 (oper,site)(GB)=9.44e-06,4.47e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=76
 no. of rintermediate operators=140
 no. of coefficients=1070:0.00816MB:7.97e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.177e-04 S -----
rank=0 GPUmem(GB): used=1.75e-05 (oper,site,rinter)=9.44e-06,4.47e-08,7.97e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000208 S size(rtasks)=76 size(Rlst2)=1 T(Rmu/Rlist)=6.83e-05,0.000139 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000286 S size(rtasks)=76 size(Rlst)=81 -----
rank=0 GPUmem(GB): used=1.75e-05 (oper,site,rinter,batch)=9.44e-06,4.47e-08,7.97e-06,7.85e-06 blksize=4 blksize0=4 batchsize=81
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.12e-05,0.000266,7.2e-05
--- TIMING FOR renorm : t_inter=9.1e-05 t_gemm=2.7e-04 t_reduction=7.2e-05 tot=4.3e-04 ---
 renorm[inter] counter=4 t=9.1e-05 per=2.1e+01 cost=4.8e+02 flops=5.3e+06
 renorm[gemm] counter=4 i=0 t=2.7e-06 per=6.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=1 t=2.2e-06 per=5.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=2 t=9.4e-05 per=2.2e+01 cost=1.7e+02 flops=1.8e+06
 renorm[gemm] counter=4 i=3 t=8.8e-05 per=2.0e+01 cost=5.1e+02 flops=5.8e+06
 renorm[gemm] counter=4 i=4 t=2.4e-06 per=5.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=5 t=2.2e-06 per=5.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=6 t=7.4e-05 per=1.7e+01 cost=9.8e+02 flops=1.3e+07
 renorm[gemm] counter=4 total t=2.7e-04 per=6.2e+01 cost=1.7e+03 flops=6.3e+06
 renorm[red] counter=4 t=7.2e-05 per=1.7e+01 cost=6.5e+02 flops=9.0e+06
--- TIMING FOR renorm_tot : t_inter=3.8e-04 t_gemm=3.7e-02 t_reduction=7.1e-03 tot=4.4e-02 ---
 renorm_tot[inter] counter=4 t=3.8e-04 per=8.5e-01 cost=5.3e+03 flops=1.4e+07
 renorm_tot[gemm] counter=4 i=0 t=1.2e-05 per=2.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=1 t=8.9e-06 per=2.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=2 t=3.3e-02 per=7.5e+01 cost=1.5e+03 flops=4.4e+04
 renorm_tot[gemm] counter=4 i=3 t=3.0e-03 per=6.8e+00 cost=2.1e+03 flops=7.0e+05
 renorm_tot[gemm] counter=4 i=4 t=9.7e-06 per=2.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=5 t=9.0e-06 per=2.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=6 t=4.4e-04 per=1.0e+00 cost=4.4e+03 flops=1.0e+07
 renorm_tot[gemm] counter=4 total t=3.7e-02 per=8.3e+01 cost=8.0e+03 flops=2.2e+05
 renorm_tot[red] counter=4 t=7.1e-03 per=1.6e+01 cost=3.3e+03 flops=4.6e+05
qops.to_cpu: size(tot)=124:9.5e-04MB:9.2e-07GB t[to_cpu]=1.5e-05S speed=6.2e-02GB/S
check ||H-H.dagger||=2.512e-15 coord=(15,0) rank=0
ctns::oper_ab2pq coord=(15,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00411 S rank=0 -----
##### local oper_env: 9.804e-03 S #####
 T(local oper_env: fetch) = 2.168e-03 S  per = 22.1  per(accum) = 22.1
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 22.1
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 22.1
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 22.1
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 22.1
 T(local oper_env: renrm) = 4.361e-03 S  per = 44.5  per(accum) = 66.6
 T(local oper_env: save ) = 3.275e-03 S  per = 33.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.361e-03 S  T(sum) = 4.361e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.834e-05 S  per =  1.8  per(accum) = 1.8
 T(local oper_env: qops init                    ) = 2.981e-04 S  per = 6.84  per(accum) = 8.63
 T(local oper_env: symbolic_formulae_renorm     ) = 3.752e-04 S  per =  8.6  per(accum) = 17.2
 T(local oper_env: allocate qops on gpu         ) = 9.374e-05 S  per = 2.15  per(accum) = 19.4
 T(local oper_env: site memcpy cpu2gpu          ) = 9.325e-05 S  per = 2.14  per(accum) = 21.5
 T(local oper_env: rintermediate init           ) = 4.751e-04 S  per = 10.9  per(accum) = 32.4
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.557e-04 S  per = 8.16  per(accum) = 40.6
 T(local oper_env: rmmtasks init                ) = 1.376e-04 S  per = 3.16  per(accum) = 43.7
 T(local oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 0.00078  per(accum) = 43.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.105e-03 S  per = 48.3  per(accum) = 92
 T(local oper_env: reduction of opS & opH [nccl]) = 5.140e-07 S  per = 0.0118  per(accum) = 92
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.481e-05 S  per = 1.94  per(accum) = 94
 T(local oper_env: deallocate cpu and gpu memory) = 9.997e-06 S  per = 0.229  per(accum) = 94.2
 T(local oper_env: reduction of opS & opH [comm]) = 7.796e-05 S  per = 1.79  per(accum) = 96
 T(local oper_env: conversion from opAB to opPQ ) = 7.792e-05 S  per = 1.79  per(accum) = 97.8
 T(local oper_env: after oper_renorm            ) = 9.793e-05 S  per = 2.25  per(accum) = 100
##### sweep oper_env: 8.647e-02 S #####
 T(sweep oper_env: fetch) = 1.233e-02 S  per = 14.3  per(accum) = 14.3
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: renrm) = 6.048e-02 S  per = 69.9  per(accum) = 84.2
 T(sweep oper_env: save ) = 1.367e-02 S  per = 15.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -6.929e+09 S  per = -6.929e+31
 T(sweep oper_env: preprocess                  ) = -6.929e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.048e-02 S  T(sum) = 6.048e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 3.362e-04 S  per = 0.556  per(accum) = 0.556
 T(sweep oper_env: qops init                    ) = 1.249e-03 S  per = 2.07  per(accum) = 2.62
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.267e-03 S  per = 2.09  per(accum) = 4.72
 T(sweep oper_env: allocate qops on gpu         ) = 3.862e-04 S  per = 0.639  per(accum) = 5.35
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.596e-04 S  per = 0.595  per(accum) = 5.95
 T(sweep oper_env: rintermediate init           ) = 1.807e-03 S  per = 2.99  per(accum) = 8.94
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.699e-03 S  per = 2.81  per(accum) = 11.7
 T(sweep oper_env: rmmtasks init                ) = 6.799e-04 S  per = 1.12  per(accum) = 12.9
 T(sweep oper_env: qops memset on cpu           ) = 1.550e-07 S  per = 0.000256  per(accum) = 12.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.123e-02 S  per = 84.7  per(accum) = 97.6
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.070e-06 S  per = 0.00508  per(accum) = 97.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.684e-04 S  per = 0.609  per(accum) = 98.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.505e-05 S  per = 0.0745  per(accum) = 98.3
 T(sweep oper_env: reduction of opS & opH [comm]) = 3.289e-04 S  per = 0.544  per(accum) = 98.8
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.993e-04 S  per = 0.495  per(accum) = 99.3
 T(sweep oper_env: after oper_renorm            ) = 4.172e-04 S  per = 0.69  per(accum) = 100

idx=5 coord=(14,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHAB nops=C:5 S:15 H:1 A:25 B:30 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=124:0.000946MB:9.24e-07GB
ctns::oper_renorm coord=(14,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:6 S:14 H:1 A:36 B:42 
        dim(bra,ket)=4,4 size(op)=8:6.1e-05MB size(tot)=380:0.0029MB:2.83e-06GB
CPUmem: VM:7.240e+01GB RSS:5.451e-01GB  Timing: User:1.588e+00S Sys:9.995e-01S Total:2.588e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=99 : 3.423e-04 S -----
rank=0 GPUmem(GB): used=1.12e-05 (oper)=1.12e-05
rank=0 GPUmem(GB): used=1.13e-05 (oper,site)(GB)=1.12e-05,5.96e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=99
 no. of rintermediate operators=131
 no. of coefficients=1475:0.0113MB:1.1e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.430e-04 S -----
rank=0 GPUmem(GB): used=2.22e-05 (oper,site,rinter)=1.12e-05,5.96e-08,1.1e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000404 S size(rtasks)=99 size(Rlst2)=9 T(Rmu/Rlist)=8.89e-05,0.000315 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000503 S size(rtasks)=99 size(Rlst)=301 -----
rank=0 GPUmem(GB): used=2.22e-05 (oper,site,rinter,batch)=1.12e-05,5.96e-08,1.1e-05,2.92e-05 blksize=4 blksize0=4 batchsize=301
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.73e-05,0.00287,0.000125
--- TIMING FOR renorm : t_inter=7.7e-05 t_gemm=2.9e-03 t_reduction=1.2e-04 tot=3.1e-03 ---
 renorm[inter] counter=5 t=7.7e-05 per=2.5e+00 cost=1.6e+04 flops=2.1e+08
 renorm[gemm] counter=5 i=0 t=2.7e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=1 t=2.2e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=2 t=7.3e-05 per=2.4e+00 cost=1.0e+03 flops=1.4e+07
 renorm[gemm] counter=5 i=3 t=8.3e-05 per=2.7e+00 cost=2.2e+03 flops=2.7e+07
 renorm[gemm] counter=5 i=4 t=2.3e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=5 t=2.2e-06 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=6 t=2.7e-03 per=8.8e+01 cost=2.2e+03 flops=8.3e+05
 renorm[gemm] counter=5 total t=2.9e-03 per=9.3e+01 cost=5.5e+03 flops=1.9e+06
 renorm[red] counter=5 t=1.2e-04 per=4.1e+00 cost=1.1e+03 flops=9.0e+06
--- TIMING FOR renorm_tot : t_inter=4.5e-04 t_gemm=4.0e-02 t_reduction=7.2e-03 tot=4.7e-02 ---
 renorm_tot[inter] counter=5 t=4.5e-04 per=9.6e-01 cost=2.1e+04 flops=4.7e+07
 renorm_tot[gemm] counter=5 i=0 t=1.4e-05 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=1 t=1.1e-05 per=2.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=2 t=3.3e-02 per=7.0e+01 cost=2.5e+03 flops=7.5e+04
 renorm_tot[gemm] counter=5 i=3 t=3.1e-03 per=6.6e+00 cost=4.3e+03 flops=1.4e+06
 renorm_tot[gemm] counter=5 i=4 t=1.2e-05 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=5 t=1.1e-05 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=6 t=3.1e-03 per=6.7e+00 cost=6.6e+03 flops=2.1e+06
 renorm_tot[gemm] counter=5 total t=4.0e-02 per=8.4e+01 cost=1.3e+04 flops=3.4e+05
 renorm_tot[red] counter=5 t=7.2e-03 per=1.5e+01 cost=4.4e+03 flops=6.0e+05
qops.to_cpu: size(tot)=380:2.9e-03MB:2.8e-06GB t[to_cpu]=1.6e-05S speed=1.8e-01GB/S
check ||H-H.dagger||=0.000e+00 coord=(14,0) rank=0
ctns::oper_ab2pq coord=(14,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00754 S rank=0 -----
##### local oper_env: 1.416e-02 S #####
 T(local oper_env: fetch) = 2.996e-03 S  per = 21.1  per(accum) = 21.1
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 21.1
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 21.1
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 21.1
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 21.1
 T(local oper_env: renrm) = 7.826e-03 S  per = 55.3  per(accum) = 76.4
 T(local oper_env: save ) = 3.342e-03 S  per = 23.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.826e-03 S  T(sum) = 7.826e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.052e-04 S  per = 1.34  per(accum) = 1.34
 T(local oper_env: qops init                    ) = 7.257e-04 S  per = 9.27  per(accum) = 10.6
 T(local oper_env: symbolic_formulae_renorm     ) = 4.230e-04 S  per =  5.4  per(accum) = 16
 T(local oper_env: allocate qops on gpu         ) = 8.947e-05 S  per = 1.14  per(accum) = 17.2
 T(local oper_env: site memcpy cpu2gpu          ) = 8.757e-05 S  per = 1.12  per(accum) = 18.3
 T(local oper_env: rintermediate init           ) = 4.944e-04 S  per = 6.32  per(accum) = 24.6
 T(local oper_env: preprocess_formulae_Rlist2   ) = 5.791e-04 S  per =  7.4  per(accum) = 32
 T(local oper_env: rmmtasks init                ) = 1.884e-04 S  per = 2.41  per(accum) = 34.4
 T(local oper_env: qops memset on cpu           ) = 4.100e-08 S  per = 0.000524  per(accum) = 34.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.767e-03 S  per = 60.9  per(accum) = 95.3
 T(local oper_env: reduction of opS & opH [nccl]) = 5.130e-07 S  per = 0.00656  per(accum) = 95.3
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.482e-05 S  per = 1.08  per(accum) = 96.4
 T(local oper_env: deallocate cpu and gpu memory) = 9.634e-06 S  per = 0.123  per(accum) = 96.5
 T(local oper_env: reduction of opS & opH [comm]) = 9.148e-05 S  per = 1.17  per(accum) = 97.7
 T(local oper_env: conversion from opAB to opPQ ) = 7.327e-05 S  per = 0.936  per(accum) = 98.6
 T(local oper_env: after oper_renorm            ) = 1.065e-04 S  per = 1.36  per(accum) = 100
##### sweep oper_env: 1.006e-01 S #####
 T(sweep oper_env: fetch) = 1.532e-02 S  per = 15.2  per(accum) = 15.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15.2
 T(sweep oper_env: renrm) = 6.830e-02 S  per = 67.9  per(accum) = 83.1
 T(sweep oper_env: save ) = 1.701e-02 S  per = 16.9  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -8.662e+09 S  per = -8.662e+31
 T(sweep oper_env: preprocess                  ) = -8.662e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.830e-02 S  T(sum) = 6.830e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 4.414e-04 S  per = 0.646  per(accum) = 0.646
 T(sweep oper_env: qops init                    ) = 1.975e-03 S  per = 2.89  per(accum) = 3.54
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.690e-03 S  per = 2.47  per(accum) = 6.01
 T(sweep oper_env: allocate qops on gpu         ) = 4.756e-04 S  per = 0.696  per(accum) = 6.71
 T(sweep oper_env: site memcpy cpu2gpu          ) = 4.471e-04 S  per = 0.655  per(accum) = 7.36
 T(sweep oper_env: rintermediate init           ) = 2.302e-03 S  per = 3.37  per(accum) = 10.7
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.278e-03 S  per = 3.34  per(accum) = 14.1
 T(sweep oper_env: rmmtasks init                ) = 8.684e-04 S  per = 1.27  per(accum) = 15.3
 T(sweep oper_env: qops memset on cpu           ) = 1.960e-07 S  per = 0.000287  per(accum) = 15.3
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.600e-02 S  per =   82  per(accum) = 97.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.583e-06 S  per = 0.00525  per(accum) = 97.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 4.532e-04 S  per = 0.664  per(accum) = 98
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.468e-05 S  per = 0.0801  per(accum) = 98.1
 T(sweep oper_env: reduction of opS & opH [comm]) = 4.204e-04 S  per = 0.615  per(accum) = 98.7
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.726e-04 S  per = 0.546  per(accum) = 99.2
 T(sweep oper_env: after oper_renorm            ) = 5.236e-04 S  per = 0.767  per(accum) = 100

idx=6 coord=(13,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHAB nops=C:6 S:14 H:1 A:36 B:42 
        dim(bra,ket)=4,4 size(op)=8:6.1e-05MB size(tot)=380:0.0029MB:2.83e-06GB
ctns::oper_renorm coord=(13,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:7 S:13 H:1 A:49 B:56 
        dim(bra,ket)=6,6 size(op)=20:0.000153MB size(tot)=1068:0.00815MB:7.96e-06GB
CPUmem: VM:7.241e+01GB RSS:5.503e-01GB  Timing: User:1.593e+00S Sys:1.003e+00S Total:2.596e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=126 : 4.592e-04 S -----
rank=0 GPUmem(GB): used=1.82e-05 (oper)=1.82e-05
rank=0 GPUmem(GB): used=1.83e-05 (oper,site)(GB)=1.82e-05,1.19e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=126
 no. of rintermediate operators=122
 no. of coefficients=1899:0.0145MB:1.41e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.251e-04 S -----
rank=0 GPUmem(GB): used=3.25e-05 (oper,site,rinter)=1.82e-05,1.19e-07,1.41e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00068 S size(rtasks)=126 size(Rlst2)=9 T(Rmu/Rlist)=8.55e-05,0.000595 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000812 S size(rtasks)=126 size(Rlst)=611 -----
rank=0 GPUmem(GB): used=3.25e-05 (oper,site,rinter,batch)=1.82e-05,1.19e-07,1.41e-05,5.92e-05 blksize=4 blksize0=4 batchsize=611
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000115,0.000286,0.000104
--- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=2.9e-04 t_reduction=1.0e-04 tot=5.0e-04 ---
 renorm[inter] counter=6 t=1.1e-04 per=2.3e+01 cost=2.2e+04 flops=1.9e+08
 renorm[gemm] counter=6 i=0 t=2.7e-06 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=1 t=2.2e-06 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=2 t=9.9e-05 per=2.0e+01 cost=1.7e+03 flops=1.7e+07
 renorm[gemm] counter=6 i=3 t=9.6e-05 per=1.9e+01 cost=4.7e+03 flops=4.9e+07
 renorm[gemm] counter=6 i=4 t=2.3e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=5 t=2.2e-06 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=6 t=8.1e-05 per=1.6e+01 cost=7.8e+03 flops=9.6e+07
 renorm[gemm] counter=6 total t=2.9e-04 per=5.7e+01 cost=1.4e+04 flops=5.0e+07
 renorm[red] counter=6 t=1.0e-04 per=2.1e+01 cost=4.9e+03 flops=4.7e+07
--- TIMING FOR renorm_tot : t_inter=5.7e-04 t_gemm=4.0e-02 t_reduction=7.3e-03 tot=4.8e-02 ---
 renorm_tot[inter] counter=6 t=5.7e-04 per=1.2e+00 cost=4.3e+04 flops=7.6e+07
 renorm_tot[gemm] counter=6 i=0 t=1.7e-05 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=1 t=1.3e-05 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=2 t=3.3e-02 per=7.0e+01 cost=4.2e+03 flops=1.2e+05
 renorm_tot[gemm] counter=6 i=3 t=3.2e-03 per=6.7e+00 cost=9.0e+03 flops=2.8e+06
 renorm_tot[gemm] counter=6 i=4 t=1.4e-05 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=5 t=1.3e-05 per=2.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=6 t=3.2e-03 per=6.8e+00 cost=1.4e+04 flops=4.5e+06
 renorm_tot[gemm] counter=6 total t=4.0e-02 per=8.3e+01 cost=2.8e+04 flops=6.9e+05
 renorm_tot[red] counter=6 t=7.3e-03 per=1.5e+01 cost=9.3e+03 flops=1.3e+06
qops.to_cpu: size(tot)=1068:8.1e-03MB:8.0e-06GB t[to_cpu]=1.7e-05S speed=4.7e-01GB/S
check ||H-H.dagger||=3.142e-16 coord=(13,0) rank=0
ctns::oper_ab2pq coord=(13,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00514 S rank=0 -----
##### local oper_env: 1.187e-02 S #####
 T(local oper_env: fetch) = 2.746e-03 S  per = 23.1  per(accum) = 23.1
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 23.1
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 23.1
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 23.1
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 23.1
 T(local oper_env: renrm) = 5.575e-03 S  per =   47  per(accum) = 70.1
 T(local oper_env: save ) = 3.547e-03 S  per = 29.9  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.575e-03 S  T(sum) = 5.575e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.524e-05 S  per = 1.53  per(accum) = 1.53
 T(local oper_env: qops init                    ) = 3.858e-04 S  per = 6.92  per(accum) = 8.45
 T(local oper_env: symbolic_formulae_renorm     ) = 5.378e-04 S  per = 9.65  per(accum) = 18.1
 T(local oper_env: allocate qops on gpu         ) = 9.743e-05 S  per = 1.75  per(accum) = 19.8
 T(local oper_env: site memcpy cpu2gpu          ) = 8.586e-05 S  per = 1.54  per(accum) = 21.4
 T(local oper_env: rintermediate init           ) = 4.843e-04 S  per = 8.69  per(accum) = 30.1
 T(local oper_env: preprocess_formulae_Rlist2   ) = 8.948e-04 S  per = 16.1  per(accum) = 46.1
 T(local oper_env: rmmtasks init                ) = 2.706e-04 S  per = 4.85  per(accum) = 51
 T(local oper_env: qops memset on cpu           ) = 4.100e-08 S  per = 0.000735  per(accum) = 51
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.203e-03 S  per = 39.5  per(accum) = 90.5
 T(local oper_env: reduction of opS & opH [nccl]) = 5.730e-07 S  per = 0.0103  per(accum) = 90.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.997e-05 S  per = 1.61  per(accum) = 92.1
 T(local oper_env: deallocate cpu and gpu memory) = 1.059e-05 S  per = 0.19  per(accum) = 92.3
 T(local oper_env: reduction of opS & opH [comm]) = 8.124e-05 S  per = 1.46  per(accum) = 93.8
 T(local oper_env: conversion from opAB to opPQ ) = 2.330e-04 S  per = 4.18  per(accum) = 97.9
 T(local oper_env: after oper_renorm            ) = 1.144e-04 S  per = 2.05  per(accum) = 100
##### sweep oper_env: 1.125e-01 S #####
 T(sweep oper_env: fetch) = 1.807e-02 S  per = 16.1  per(accum) = 16.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.1
 T(sweep oper_env: renrm) = 7.388e-02 S  per = 65.7  per(accum) = 81.7
 T(sweep oper_env: save ) = 2.056e-02 S  per = 18.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.039e+10 S  per = -1.039e+32
 T(sweep oper_env: preprocess                  ) = -1.039e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.388e-02 S  T(sum) = 7.388e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 5.266e-04 S  per = 0.713  per(accum) = 0.713
 T(sweep oper_env: qops init                    ) = 2.361e-03 S  per =  3.2  per(accum) = 3.91
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.228e-03 S  per = 3.02  per(accum) = 6.92
 T(sweep oper_env: allocate qops on gpu         ) = 5.731e-04 S  per = 0.776  per(accum) = 7.7
 T(sweep oper_env: site memcpy cpu2gpu          ) = 5.330e-04 S  per = 0.721  per(accum) = 8.42
 T(sweep oper_env: rintermediate init           ) = 2.786e-03 S  per = 3.77  per(accum) = 12.2
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.173e-03 S  per = 4.29  per(accum) = 16.5
 T(sweep oper_env: rmmtasks init                ) = 1.139e-03 S  per = 1.54  per(accum) = 18
 T(sweep oper_env: qops memset on cpu           ) = 2.370e-07 S  per = 0.000321  per(accum) = 18
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.820e-02 S  per = 78.8  per(accum) = 96.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.156e-06 S  per = 0.00563  per(accum) = 96.8
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 5.432e-04 S  per = 0.735  per(accum) = 97.5
 T(sweep oper_env: deallocate cpu and gpu memory) = 6.527e-05 S  per = 0.0884  per(accum) = 97.6
 T(sweep oper_env: reduction of opS & opH [comm]) = 5.016e-04 S  per = 0.679  per(accum) = 98.3
 T(sweep oper_env: conversion from opAB to opPQ ) = 6.056e-04 S  per = 0.82  per(accum) = 99.1
 T(sweep oper_env: after oper_renorm            ) = 6.380e-04 S  per = 0.864  per(accum) = 100

idx=7 coord=(12,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHAB nops=C:7 S:13 H:1 A:49 B:56 
        dim(bra,ket)=6,6 size(op)=20:0.000153MB size(tot)=1068:0.00815MB:7.96e-06GB
ctns::oper_renorm coord=(12,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:8 S:12 H:1 A:64 B:72 
        dim(bra,ket)=8,8 size(op)=40:0.000305MB size(tot)=2494:0.019MB:1.86e-05GB
CPUmem: VM:7.241e+01GB RSS:5.508e-01GB  Timing: User:1.598e+00S Sys:1.003e+00S Total:2.602e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=157 : 5.052e-04 S -----
rank=0 GPUmem(GB): used=3.4e-05 (oper)=3.4e-05
rank=0 GPUmem(GB): used=3.42e-05 (oper,site)(GB)=3.4e-05,2.09e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=157
 no. of rintermediate operators=113
 no. of coefficients=2324:0.0177MB:1.73e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.272e-04 S -----
rank=0 GPUmem(GB): used=5.15e-05 (oper,site,rinter)=3.4e-05,2.09e-07,1.73e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000679 S size(rtasks)=157 size(Rlst2)=9 T(Rmu/Rlist)=8.86e-05,0.000591 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00083 S size(rtasks)=157 size(Rlst)=707 -----
rank=0 GPUmem(GB): used=5.15e-05 (oper,site,rinter,batch)=3.4e-05,2.09e-07,1.73e-05,0.000121 blksize=9 blksize0=4 batchsize=707
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.0001,0.000286,0.000126
--- TIMING FOR renorm : t_inter=1.0e-04 t_gemm=2.9e-04 t_reduction=1.3e-04 tot=5.1e-04 ---
 renorm[inter] counter=7 t=1.0e-04 per=2.0e+01 cost=2.9e+04 flops=2.9e+08
 renorm[gemm] counter=7 i=0 t=2.8e-06 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=1 t=2.2e-06 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=2 t=7.0e-05 per=1.4e+01 cost=3.0e+03 flops=4.3e+07
 renorm[gemm] counter=7 i=3 t=9.7e-05 per=1.9e+01 cost=1.1e+04 flops=1.2e+08
 renorm[gemm] counter=7 i=4 t=2.3e-06 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=5 t=2.2e-06 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=6 t=1.1e-04 per=2.1e+01 cost=2.2e+04 flops=2.0e+08
 renorm[gemm] counter=7 total t=2.9e-04 per=5.6e+01 cost=3.6e+04 flops=1.3e+08
 renorm[red] counter=7 t=1.3e-04 per=2.5e+01 cost=1.1e+04 flops=8.7e+07
--- TIMING FOR renorm_tot : t_inter=6.7e-04 t_gemm=4.0e-02 t_reduction=7.5e-03 tot=4.8e-02 ---
 renorm_tot[inter] counter=7 t=6.7e-04 per=1.4e+00 cost=7.2e+04 flops=1.1e+08
 renorm_tot[gemm] counter=7 i=0 t=2.0e-05 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=1 t=1.5e-05 per=3.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=2 t=3.3e-02 per=6.9e+01 cost=7.1e+03 flops=2.1e+05
 renorm_tot[gemm] counter=7 i=3 t=3.3e-03 per=6.8e+00 cost=2.0e+04 flops=6.1e+06
 renorm_tot[gemm] counter=7 i=4 t=1.6e-05 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=5 t=1.6e-05 per=3.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=6 t=3.3e-03 per=6.9e+00 cost=3.6e+04 flops=1.1e+07
 renorm_tot[gemm] counter=7 total t=4.0e-02 per=8.3e+01 cost=6.4e+04 flops=1.6e+06
 renorm_tot[red] counter=7 t=7.5e-03 per=1.5e+01 cost=2.0e+04 flops=2.7e+06
qops.to_cpu: size(tot)=2494:1.9e-02MB:1.9e-05GB t[to_cpu]=2.2e-05S speed=8.5e-01GB/S
check ||H-H.dagger||=1.571e-16 coord=(12,0) rank=0
ctns::oper_ab2pq coord=(12,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00527 S rank=0 -----
##### local oper_env: 1.185e-02 S #####
 T(local oper_env: fetch) = 2.664e-03 S  per = 22.5  per(accum) = 22.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 22.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 22.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 22.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 22.5
 T(local oper_env: renrm) = 5.535e-03 S  per = 46.7  per(accum) = 69.2
 T(local oper_env: save ) = 3.652e-03 S  per = 30.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.535e-03 S  T(sum) = 5.535e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.501e-05 S  per = 1.36  per(accum) = 1.36
 T(local oper_env: qops init                    ) = 4.145e-04 S  per = 7.49  per(accum) = 8.84
 T(local oper_env: symbolic_formulae_renorm     ) = 5.825e-04 S  per = 10.5  per(accum) = 19.4
 T(local oper_env: allocate qops on gpu         ) = 9.470e-05 S  per = 1.71  per(accum) = 21.1
 T(local oper_env: site memcpy cpu2gpu          ) = 8.690e-05 S  per = 1.57  per(accum) = 22.7
 T(local oper_env: rintermediate init           ) = 4.837e-04 S  per = 8.74  per(accum) = 31.4
 T(local oper_env: preprocess_formulae_Rlist2   ) = 9.119e-04 S  per = 16.5  per(accum) = 47.9
 T(local oper_env: rmmtasks init                ) = 2.690e-04 S  per = 4.86  per(accum) = 52.7
 T(local oper_env: qops memset on cpu           ) = 5.100e-08 S  per = 0.000921  per(accum) = 52.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.237e-03 S  per = 40.4  per(accum) = 93.2
 T(local oper_env: reduction of opS & opH [nccl]) = 5.590e-07 S  per = 0.0101  per(accum) = 93.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 9.810e-05 S  per = 1.77  per(accum) = 94.9
 T(local oper_env: deallocate cpu and gpu memory) = 9.620e-06 S  per = 0.174  per(accum) = 95.1
 T(local oper_env: reduction of opS & opH [comm]) = 8.299e-05 S  per =  1.5  per(accum) = 96.6
 T(local oper_env: conversion from opAB to opPQ ) = 7.191e-05 S  per =  1.3  per(accum) = 97.9
 T(local oper_env: after oper_renorm            ) = 1.159e-04 S  per = 2.09  per(accum) = 100
##### sweep oper_env: 1.244e-01 S #####
 T(sweep oper_env: fetch) = 2.073e-02 S  per = 16.7  per(accum) = 16.7
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.7
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.7
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.7
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.7
 T(sweep oper_env: renrm) = 7.941e-02 S  per = 63.9  per(accum) = 80.5
 T(sweep oper_env: save ) = 2.421e-02 S  per = 19.5  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.213e+10 S  per = -1.213e+32
 T(sweep oper_env: preprocess                  ) = -1.213e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.941e-02 S  T(sum) = 7.941e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 6.016e-04 S  per = 0.758  per(accum) = 0.758
 T(sweep oper_env: qops init                    ) = 2.775e-03 S  per = 3.49  per(accum) = 4.25
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.810e-03 S  per = 3.54  per(accum) = 7.79
 T(sweep oper_env: allocate qops on gpu         ) = 6.678e-04 S  per = 0.841  per(accum) = 8.63
 T(sweep oper_env: site memcpy cpu2gpu          ) = 6.199e-04 S  per = 0.781  per(accum) = 9.41
 T(sweep oper_env: rintermediate init           ) = 3.270e-03 S  per = 4.12  per(accum) = 13.5
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.085e-03 S  per = 5.14  per(accum) = 18.7
 T(sweep oper_env: rmmtasks init                ) = 1.408e-03 S  per = 1.77  per(accum) = 20.4
 T(sweep oper_env: qops memset on cpu           ) = 2.880e-07 S  per = 0.000363  per(accum) = 20.4
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.044e-02 S  per = 76.1  per(accum) = 96.6
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.715e-06 S  per = 0.00594  per(accum) = 96.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 6.413e-04 S  per = 0.808  per(accum) = 97.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 7.489e-05 S  per = 0.0943  per(accum) = 97.5
 T(sweep oper_env: reduction of opS & opH [comm]) = 5.846e-04 S  per = 0.736  per(accum) = 98.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 6.775e-04 S  per = 0.853  per(accum) = 99.1
 T(sweep oper_env: after oper_renorm            ) = 7.539e-04 S  per = 0.949  per(accum) = 100

idx=8 coord=(11,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHAB nops=C:8 S:12 H:1 A:64 B:72 
        dim(bra,ket)=8,8 size(op)=40:0.000305MB size(tot)=2494:0.019MB:1.86e-05GB
ctns::oper_renorm coord=(11,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:9 S:11 H:1 A:81 B:90 
        dim(bra,ket)=9,9 size(op)=65:0.000496MB size(tot)=4603:0.0351MB:3.43e-05GB
CPUmem: VM:7.241e+01GB RSS:5.508e-01GB  Timing: User:1.604e+00S Sys:1.003e+00S Total:2.608e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=192 : 5.637e-04 S -----
rank=0 GPUmem(GB): used=6.03e-05 (oper)=6.03e-05
rank=0 GPUmem(GB): used=6.06e-05 (oper,site)(GB)=6.03e-05,3.13e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=192
 no. of rintermediate operators=104
 no. of coefficients=2732:0.0208MB:2.04e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.392e-04 S -----
rank=0 GPUmem(GB): used=8.1e-05 (oper,site,rinter)=6.03e-05,3.13e-07,2.04e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000755 S size(rtasks)=192 size(Rlst2)=9 T(Rmu/Rlist)=0.000101,0.000655 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000923 S size(rtasks)=192 size(Rlst)=817 -----
rank=0 GPUmem(GB): used=8.1e-05 (oper,site,rinter,batch)=6.03e-05,3.13e-07,2.04e-05,0.000256 blksize=16 blksize0=9 batchsize=817
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000108,0.000409,0.000119
--- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=4.1e-04 t_reduction=1.2e-04 tot=6.4e-04 ---
 renorm[inter] counter=8 t=1.1e-04 per=1.7e+01 cost=3.8e+04 flops=3.5e+08
 renorm[gemm] counter=8 i=0 t=2.8e-06 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=1 t=2.2e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=2 t=1.5e-04 per=2.3e+01 cost=4.6e+03 flops=3.1e+07
 renorm[gemm] counter=8 i=3 t=1.4e-04 per=2.1e+01 cost=2.6e+04 flops=1.9e+08
 renorm[gemm] counter=8 i=4 t=2.3e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=5 t=2.2e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=6 t=1.2e-04 per=1.8e+01 cost=4.9e+04 flops=4.3e+08
 renorm[gemm] counter=8 total t=4.1e-04 per=6.4e+01 cost=8.0e+04 flops=2.0e+08
 renorm[red] counter=8 t=1.2e-04 per=1.9e+01 cost=2.0e+04 flops=1.6e+08
--- TIMING FOR renorm_tot : t_inter=7.8e-04 t_gemm=4.1e-02 t_reduction=7.6e-03 tot=4.9e-02 ---
 renorm_tot[inter] counter=8 t=7.8e-04 per=1.6e+00 cost=1.1e+05 flops=1.4e+08
 renorm_tot[gemm] counter=8 i=0 t=2.3e-05 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=1 t=1.8e-05 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=2 t=3.4e-02 per=6.9e+01 cost=1.2e+04 flops=3.5e+05
 renorm_tot[gemm] counter=8 i=3 t=3.4e-03 per=7.0e+00 cost=4.6e+04 flops=1.3e+07
 renorm_tot[gemm] counter=8 i=4 t=1.9e-05 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=5 t=1.8e-05 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=6 t=3.5e-03 per=7.1e+00 cost=8.6e+04 flops=2.5e+07
 renorm_tot[gemm] counter=8 total t=4.1e-02 per=8.3e+01 cost=1.4e+05 flops=3.5e+06
 renorm_tot[red] counter=8 t=7.6e-03 per=1.6e+01 cost=4.0e+04 flops=5.2e+06
qops.to_cpu: size(tot)=4603:3.5e-02MB:3.4e-05GB t[to_cpu]=3.2e-05S speed=1.1e+00GB/S
check ||H-H.dagger||=7.852e-17 coord=(11,0) rank=0
ctns::oper_ab2pq coord=(11,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0058 S rank=0 -----
##### local oper_env: 1.259e-02 S #####
 T(local oper_env: fetch) = 2.748e-03 S  per = 21.8  per(accum) = 21.8
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 21.8
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 21.8
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 21.8
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 21.8
 T(local oper_env: renrm) = 6.082e-03 S  per = 48.3  per(accum) = 70.1
 T(local oper_env: save ) = 3.762e-03 S  per = 29.9  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.082e-03 S  T(sum) = 6.082e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.260e-05 S  per = 1.36  per(accum) = 1.36
 T(local oper_env: qops init                    ) = 4.721e-04 S  per = 7.76  per(accum) = 9.12
 T(local oper_env: symbolic_formulae_renorm     ) = 6.760e-04 S  per = 11.1  per(accum) = 20.2
 T(local oper_env: allocate qops on gpu         ) = 1.016e-04 S  per = 1.67  per(accum) = 21.9
 T(local oper_env: site memcpy cpu2gpu          ) = 9.024e-05 S  per = 1.48  per(accum) = 23.4
 T(local oper_env: rintermediate init           ) = 5.034e-04 S  per = 8.28  per(accum) = 31.7
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.005e-03 S  per = 16.5  per(accum) = 48.2
 T(local oper_env: rmmtasks init                ) = 3.129e-04 S  per = 5.14  per(accum) = 53.3
 T(local oper_env: qops memset on cpu           ) = 4.200e-08 S  per = 0.000691  per(accum) = 53.3
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.428e-03 S  per = 39.9  per(accum) = 93.3
 T(local oper_env: reduction of opS & opH [nccl]) = 5.580e-07 S  per = 0.00917  per(accum) = 93.3
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.149e-04 S  per = 1.89  per(accum) = 95.2
 T(local oper_env: deallocate cpu and gpu memory) = 9.621e-06 S  per = 0.158  per(accum) = 95.3
 T(local oper_env: reduction of opS & opH [comm]) = 8.500e-05 S  per =  1.4  per(accum) = 96.7
 T(local oper_env: conversion from opAB to opPQ ) = 8.156e-05 S  per = 1.34  per(accum) = 98.1
 T(local oper_env: after oper_renorm            ) = 1.177e-04 S  per = 1.94  per(accum) = 100
##### sweep oper_env: 1.369e-01 S #####
 T(sweep oper_env: fetch) = 2.348e-02 S  per = 17.1  per(accum) = 17.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17.1
 T(sweep oper_env: renrm) = 8.549e-02 S  per = 62.4  per(accum) = 79.6
 T(sweep oper_env: save ) = 2.797e-02 S  per = 20.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.386e+10 S  per = -1.386e+32
 T(sweep oper_env: preprocess                  ) = -1.386e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.549e-02 S  T(sum) = 8.549e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 6.842e-04 S  per =  0.8  per(accum) = 0.8
 T(sweep oper_env: qops init                    ) = 3.247e-03 S  per =  3.8  per(accum) = 4.6
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.486e-03 S  per = 4.08  per(accum) = 8.68
 T(sweep oper_env: allocate qops on gpu         ) = 7.694e-04 S  per =  0.9  per(accum) = 9.58
 T(sweep oper_env: site memcpy cpu2gpu          ) = 7.101e-04 S  per = 0.831  per(accum) = 10.4
 T(sweep oper_env: rintermediate init           ) = 3.773e-03 S  per = 4.41  per(accum) = 14.8
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.090e-03 S  per = 5.95  per(accum) = 20.8
 T(sweep oper_env: rmmtasks init                ) = 1.721e-03 S  per = 2.01  per(accum) = 22.8
 T(sweep oper_env: qops memset on cpu           ) = 3.300e-07 S  per = 0.000386  per(accum) = 22.8
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.287e-02 S  per = 73.5  per(accum) = 96.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.273e-06 S  per = 0.00617  per(accum) = 96.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 7.562e-04 S  per = 0.885  per(accum) = 97.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.451e-05 S  per = 0.0989  per(accum) = 97.3
 T(sweep oper_env: reduction of opS & opH [comm]) = 6.696e-04 S  per = 0.783  per(accum) = 98.1
 T(sweep oper_env: conversion from opAB to opPQ ) = 7.591e-04 S  per = 0.888  per(accum) = 99
 T(sweep oper_env: after oper_renorm            ) = 8.716e-04 S  per = 1.02  per(accum) = 100

idx=9 coord=(10,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHAB nops=C:9 S:11 H:1 A:81 B:90 
        dim(bra,ket)=9,9 size(op)=65:0.000496MB size(tot)=4603:0.0351MB:3.43e-05GB
ctns::oper_renorm coord=(10,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:10 S:10 H:1 A:100 B:110 
        dim(bra,ket)=16,16 size(op)=168:0.00128MB size(tot)=13560:0.103MB:0.000101GB
CPUmem: VM:7.241e+01GB RSS:5.511e-01GB  Timing: User:1.610e+00S Sys:1.005e+00S Total:2.616e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=231 : 6.276e-04 S -----
rank=0 GPUmem(GB): used=0.000143 (oper)=0.000143
rank=0 GPUmem(GB): used=0.000143 (oper,site)(GB)=0.000143,7.15e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=231
 no. of rintermediate operators=95
 no. of coefficients=3105:0.0237MB:2.31e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.592e-04 S -----
rank=0 GPUmem(GB): used=0.000167 (oper,site,rinter)=0.000143,7.15e-07,2.31e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00219 S size(rtasks)=231 size(Rlst2)=25 T(Rmu/Rlist)=0.000119,0.00207 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00249 S size(rtasks)=231 size(Rlst)=2346 -----
rank=0 GPUmem(GB): used=0.000167 (oper,site,rinter,batch)=0.000143,7.15e-07,2.31e-05,0.00156 blksize=36 blksize0=16 batchsize=2346
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000154,0.000637,0.000232
--- TIMING FOR renorm : t_inter=1.5e-04 t_gemm=6.4e-04 t_reduction=2.3e-04 tot=1.0e-03 ---
 renorm[inter] counter=9 t=1.5e-04 per=1.5e+01 cost=3.8e+05 flops=2.4e+09
 renorm[gemm] counter=9 i=0 t=2.8e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=1 t=2.3e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=2 t=2.2e-04 per=2.1e+01 cost=1.3e+04 flops=5.8e+07
 renorm[gemm] counter=9 i=3 t=1.8e-04 per=1.8e+01 cost=1.5e+05 flops=8.4e+08
 renorm[gemm] counter=9 i=4 t=2.3e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=5 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=6 t=2.3e-04 per=2.2e+01 cost=2.4e+05 flops=1.0e+09
 renorm[gemm] counter=9 total t=6.4e-04 per=6.2e+01 cost=4.0e+05 flops=6.3e+08
 renorm[red] counter=9 t=2.3e-04 per=2.3e+01 cost=6.7e+04 flops=2.9e+08
--- TIMING FOR renorm_tot : t_inter=9.3e-04 t_gemm=4.1e-02 t_reduction=7.8e-03 tot=5.0e-02 ---
 renorm_tot[inter] counter=9 t=9.3e-04 per=1.9e+00 cost=4.9e+05 flops=5.2e+08
 renorm_tot[gemm] counter=9 i=0 t=2.5e-05 per=5.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=1 t=2.0e-05 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=2 t=3.4e-02 per=6.8e+01 cost=2.4e+04 flops=7.2e+05
 renorm_tot[gemm] counter=9 i=3 t=3.6e-03 per=7.2e+00 cost=2.0e+05 flops=5.5e+07
 renorm_tot[gemm] counter=9 i=4 t=2.1e-05 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=5 t=2.0e-05 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=6 t=3.7e-03 per=7.4e+00 cost=3.2e+05 flops=8.7e+07
 renorm_tot[gemm] counter=9 total t=4.1e-02 per=8.2e+01 cost=5.5e+05 flops=1.3e+07
 renorm_tot[red] counter=9 t=7.8e-03 per=1.6e+01 cost=1.1e+05 flops=1.4e+07
qops.to_cpu: size(tot)=13560:1.0e-01MB:1.0e-04GB t[to_cpu]=4.1e-05S speed=2.5e+00GB/S
check ||H-H.dagger||=3.553e-15 coord=(10,0) rank=0
ctns::oper_ab2pq coord=(10,0) superblock=cr ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 0.00708 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.000555,3.23e-06,0.00276,0.00351,4.23e-05,0.000208 -----
----- TIMING FOR oper_renorm : 0.00948 S rank=0 -----
##### local oper_env: 2.358e-02 S #####
 T(local oper_env: fetch) = 3.617e-03 S  per = 15.3  per(accum) = 15.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15.3
 T(local oper_env: renrm) = 1.698e-02 S  per =   72  per(accum) = 87.3
 T(local oper_env: save ) = 2.990e-03 S  per = 12.7  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.698e-02 S  T(sum) = 1.698e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.090e-04 S  per = 0.642  per(accum) = 0.642
 T(local oper_env: qops init                    ) = 1.149e-03 S  per = 6.77  per(accum) = 7.41
 T(local oper_env: symbolic_formulae_renorm     ) = 7.134e-04 S  per =  4.2  per(accum) = 11.6
 T(local oper_env: allocate qops on gpu         ) = 9.761e-05 S  per = 0.575  per(accum) = 12.2
 T(local oper_env: site memcpy cpu2gpu          ) = 8.653e-05 S  per = 0.51  per(accum) = 12.7
 T(local oper_env: rintermediate init           ) = 5.165e-04 S  per = 3.04  per(accum) = 15.7
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.577e-03 S  per = 15.2  per(accum) = 30.9
 T(local oper_env: rmmtasks init                ) = 1.066e-03 S  per = 6.28  per(accum) = 37.2
 T(local oper_env: qops memset on cpu           ) = 4.300e-08 S  per = 0.000253  per(accum) = 37.2
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.880e-03 S  per =   17  per(accum) = 54.2
 T(local oper_env: reduction of opS & opH [nccl]) = 5.430e-07 S  per = 0.0032  per(accum) = 54.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.185e-04 S  per = 0.698  per(accum) = 54.9
 T(local oper_env: deallocate cpu and gpu memory) = 1.771e-04 S  per = 1.04  per(accum) = 55.9
 T(local oper_env: reduction of opS & opH [comm]) = 9.845e-05 S  per = 0.58  per(accum) = 56.5
 T(local oper_env: conversion from opAB to opPQ ) = 7.247e-03 S  per = 42.7  per(accum) = 99.2
 T(local oper_env: after oper_renorm            ) = 1.393e-04 S  per = 0.821  per(accum) = 100
##### sweep oper_env: 1.605e-01 S #####
 T(sweep oper_env: fetch) = 2.710e-02 S  per = 16.9  per(accum) = 16.9
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.9
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.9
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.9
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.9
 T(sweep oper_env: renrm) = 1.025e-01 S  per = 63.8  per(accum) = 80.7
 T(sweep oper_env: save ) = 3.096e-02 S  per = 19.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.559e+10 S  per = -1.559e+32
 T(sweep oper_env: preprocess                  ) = -1.559e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.025e-01 S  T(sum) = 1.025e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 7.932e-04 S  per = 0.774  per(accum) = 0.774
 T(sweep oper_env: qops init                    ) = 4.396e-03 S  per = 4.29  per(accum) = 5.06
 T(sweep oper_env: symbolic_formulae_renorm     ) = 4.200e-03 S  per =  4.1  per(accum) = 9.16
 T(sweep oper_env: allocate qops on gpu         ) = 8.670e-04 S  per = 0.846  per(accum) = 10
 T(sweep oper_env: site memcpy cpu2gpu          ) = 7.967e-04 S  per = 0.777  per(accum) = 10.8
 T(sweep oper_env: rintermediate init           ) = 4.289e-03 S  per = 4.19  per(accum) = 15
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 7.667e-03 S  per = 7.48  per(accum) = 22.5
 T(sweep oper_env: rmmtasks init                ) = 2.787e-03 S  per = 2.72  per(accum) = 25.2
 T(sweep oper_env: qops memset on cpu           ) = 3.730e-07 S  per = 0.000364  per(accum) = 25.2
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.575e-02 S  per = 64.2  per(accum) = 89.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.816e-06 S  per = 0.00568  per(accum) = 89.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 8.747e-04 S  per = 0.854  per(accum) = 90.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.616e-04 S  per = 0.255  per(accum) = 90.5
 T(sweep oper_env: reduction of opS & opH [comm]) = 7.681e-04 S  per = 0.75  per(accum) = 91.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 8.006e-03 S  per = 7.81  per(accum) = 99
 T(sweep oper_env: after oper_renorm            ) = 1.011e-03 S  per = 0.987  per(accum) = 100

idx=10 coord=(9,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHPQ nops=C:10 S:10 H:1 P:100 Q:110 
        dim(bra,ket)=16,16 size(op)=168:0.00128MB size(tot)=13560:0.103MB:0.000101GB
ctns::oper_renorm coord=(9,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:11 S:9 H:1 P:81 Q:90 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=11706:0.0893MB:8.72e-05GB
CPUmem: VM:7.242e+01GB RSS:5.531e-01GB  Timing: User:2.237e+00S Sys:1.062e+00S Total:3.299e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=192 : 8.318e-04 S -----
rank=0 GPUmem(GB): used=0.000196 (oper)=0.000196
rank=0 GPUmem(GB): used=0.000197 (oper,site)(GB)=0.000196,1.13e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=192
 no. of rintermediate operators=288
 no. of coefficients=2880:0.022MB:2.15e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.337e-04 S -----
rank=0 GPUmem(GB): used=0.000218 (oper,site,rinter)=0.000196,1.13e-06,2.15e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00654 S size(rtasks)=192 size(Rlst2)=49 T(Rmu/Rlist)=0.000231,0.00631 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0073 S size(rtasks)=192 size(Rlst)=7539 -----
rank=0 GPUmem(GB): used=0.000218 (oper,site,rinter,batch)=0.000196,1.13e-06,2.15e-05,0.00376 blksize=30 blksize0=6 batchsize=7539
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000123,0.000961,0.000287
--- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=9.6e-04 t_reduction=2.9e-04 tot=1.4e-03 ---
 renorm[inter] counter=10 t=1.2e-04 per=8.9e+00 cost=2.4e+05 flops=2.0e+09
 renorm[gemm] counter=10 i=0 t=2.8e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=1 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=2 t=2.8e-04 per=2.1e+01 cost=4.5e+04 flops=1.6e+08
 renorm[gemm] counter=10 i=3 t=3.3e-04 per=2.4e+01 cost=3.6e+05 flops=1.1e+09
 renorm[gemm] counter=10 i=4 t=2.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=5 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=6 t=3.4e-04 per=2.5e+01 cost=6.5e+05 flops=1.9e+09
 renorm[gemm] counter=10 total t=9.6e-04 per=7.0e+01 cost=1.0e+06 flops=1.1e+09
 renorm[red] counter=10 t=2.9e-04 per=2.1e+01 cost=1.7e+05 flops=5.9e+08
--- TIMING FOR renorm_tot : t_inter=1.1e-03 t_gemm=4.2e-02 t_reduction=8.1e-03 tot=5.1e-02 ---
 renorm_tot[inter] counter=10 t=1.1e-03 per=2.1e+00 cost=7.3e+05 flops=6.9e+08
 renorm_tot[gemm] counter=10 i=0 t=2.8e-05 per=5.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=1 t=2.2e-05 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=2 t=3.4e-02 per=6.6e+01 cost=6.9e+04 flops=2.0e+06
 renorm_tot[gemm] counter=10 i=3 t=3.9e-03 per=7.7e+00 cost=5.6e+05 flops=1.4e+08
 renorm_tot[gemm] counter=10 i=4 t=2.3e-05 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=5 t=2.2e-05 per=4.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=6 t=4.0e-03 per=7.8e+00 cost=9.7e+05 flops=2.4e+08
 renorm_tot[gemm] counter=10 total t=4.2e-02 per=8.2e+01 cost=1.6e+06 flops=3.8e+07
 renorm_tot[red] counter=10 t=8.1e-03 per=1.6e+01 cost=2.8e+05 flops=3.4e+07
qops.to_cpu: size(tot)=11706:8.9e-02MB:8.7e-05GB t[to_cpu]=3.1e-05S speed=2.9e+00GB/S
check ||H-H.dagger||=9.338e-15 coord=(9,0) rank=0
ctns::oper_ab2pq coord=(9,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0163 S rank=0 -----
##### local oper_env: 2.319e-02 S #####
 T(local oper_env: fetch) = 2.846e-03 S  per = 12.3  per(accum) = 12.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 12.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 12.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 12.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 12.3
 T(local oper_env: renrm) = 1.666e-02 S  per = 71.9  per(accum) = 84.1
 T(local oper_env: save ) = 3.681e-03 S  per = 15.9  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.666e-02 S  T(sum) = 1.666e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.001e-04 S  per = 0.601  per(accum) = 0.601
 T(local oper_env: qops init                    ) = 1.327e-03 S  per = 7.96  per(accum) = 8.56
 T(local oper_env: symbolic_formulae_renorm     ) = 9.601e-04 S  per = 5.76  per(accum) = 14.3
 T(local oper_env: allocate qops on gpu         ) = 9.203e-05 S  per = 0.552  per(accum) = 14.9
 T(local oper_env: site memcpy cpu2gpu          ) = 8.962e-05 S  per = 0.538  per(accum) = 15.4
 T(local oper_env: rintermediate init           ) = 4.824e-04 S  per =  2.9  per(accum) = 18.3
 T(local oper_env: preprocess_formulae_Rlist2   ) = 7.423e-03 S  per = 44.6  per(accum) = 62.9
 T(local oper_env: rmmtasks init                ) = 2.431e-03 S  per = 14.6  per(accum) = 77.5
 T(local oper_env: qops memset on cpu           ) = 7.200e-08 S  per = 0.000432  per(accum) = 77.5
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.156e-03 S  per = 18.9  per(accum) = 96.4
 T(local oper_env: reduction of opS & opH [nccl]) = 5.710e-07 S  per = 0.00343  per(accum) = 96.4
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.005e-04 S  per = 0.604  per(accum) = 97
 T(local oper_env: deallocate cpu and gpu memory) = 1.611e-04 S  per = 0.967  per(accum) = 98
 T(local oper_env: reduction of opS & opH [comm]) = 9.502e-05 S  per = 0.57  per(accum) = 98.6
 T(local oper_env: conversion from opAB to opPQ ) = 7.437e-05 S  per = 0.446  per(accum) = 99
 T(local oper_env: after oper_renorm            ) = 1.671e-04 S  per =    1  per(accum) = 100
##### sweep oper_env: 1.837e-01 S #####
 T(sweep oper_env: fetch) = 2.994e-02 S  per = 16.3  per(accum) = 16.3
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.3
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.3
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.3
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.3
 T(sweep oper_env: renrm) = 1.191e-01 S  per = 64.8  per(accum) = 81.1
 T(sweep oper_env: save ) = 3.465e-02 S  per = 18.9  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+10 S  per = -1.732e+32
 T(sweep oper_env: preprocess                  ) = -1.732e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.191e-01 S  T(sum) = 1.191e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 8.933e-04 S  per = 0.75  per(accum) = 0.75
 T(sweep oper_env: qops init                    ) = 5.722e-03 S  per =  4.8  per(accum) = 5.55
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.160e-03 S  per = 4.33  per(accum) = 9.88
 T(sweep oper_env: allocate qops on gpu         ) = 9.590e-04 S  per = 0.805  per(accum) = 10.7
 T(sweep oper_env: site memcpy cpu2gpu          ) = 8.863e-04 S  per = 0.744  per(accum) = 11.4
 T(sweep oper_env: rintermediate init           ) = 4.772e-03 S  per = 4.01  per(accum) = 15.4
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.509e-02 S  per = 12.7  per(accum) = 28.1
 T(sweep oper_env: rmmtasks init                ) = 5.218e-03 S  per = 4.38  per(accum) = 32.5
 T(sweep oper_env: qops memset on cpu           ) = 4.450e-07 S  per = 0.000374  per(accum) = 32.5
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.890e-02 S  per = 57.8  per(accum) = 90.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.387e-06 S  per = 0.00536  per(accum) = 90.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 9.752e-04 S  per = 0.819  per(accum) = 91.1
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.227e-04 S  per = 0.355  per(accum) = 91.5
 T(sweep oper_env: reduction of opS & opH [comm]) = 8.631e-04 S  per = 0.725  per(accum) = 92.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 8.080e-03 S  per = 6.78  per(accum) = 99
 T(sweep oper_env: after oper_renorm            ) = 1.178e-03 S  per = 0.989  per(accum) = 100

idx=11 coord=(8,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHPQ nops=C:11 S:9 H:1 P:81 Q:90 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=11706:0.0893MB:8.72e-05GB
ctns::oper_renorm coord=(8,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:12 S:8 H:1 P:64 Q:72 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=9483:0.0723MB:7.07e-05GB
CPUmem: VM:7.242e+01GB RSS:5.569e-01GB  Timing: User:2.254e+00S Sys:1.062e+00S Total:3.316e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=157 : 6.632e-04 S -----
rank=0 GPUmem(GB): used=0.000165 (oper)=0.000165
rank=0 GPUmem(GB): used=0.000166 (oper,site)(GB)=0.000165,7.23e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=157
 no. of rintermediate operators=232
 no. of coefficients=2552:0.0195MB:1.9e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.286e-04 S -----
rank=0 GPUmem(GB): used=0.000185 (oper,site,rinter)=0.000165,7.23e-07,1.9e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00386 S size(rtasks)=157 size(Rlst2)=49 T(Rmu/Rlist)=0.000185,0.00367 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00407 S size(rtasks)=157 size(Rlst)=4546 -----
rank=0 GPUmem(GB): used=0.000185 (oper,site,rinter,batch)=0.000165,7.23e-07,1.9e-05,0.0019 blksize=25 blksize0=5 batchsize=4546
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000103,0.000755,0.000201
--- TIMING FOR renorm : t_inter=1.0e-04 t_gemm=7.5e-04 t_reduction=2.0e-04 tot=1.1e-03 ---
 renorm[inter] counter=11 t=1.0e-04 per=9.7e+00 cost=1.2e+05 flops=1.2e+09
 renorm[gemm] counter=11 i=0 t=2.8e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=1 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=2 t=2.6e-04 per=2.4e+01 cost=2.9e+04 flops=1.1e+08
 renorm[gemm] counter=11 i=3 t=2.4e-04 per=2.2e+01 cost=1.2e+05 flops=5.1e+08
 renorm[gemm] counter=11 i=4 t=2.3e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=5 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=6 t=2.5e-04 per=2.4e+01 cost=3.3e+05 flops=1.3e+09
 renorm[gemm] counter=11 total t=7.5e-04 per=7.1e+01 cost=4.8e+05 flops=6.4e+08
 renorm[red] counter=11 t=2.0e-04 per=1.9e+01 cost=1.5e+05 flops=7.5e+08
--- TIMING FOR renorm_tot : t_inter=1.2e-03 t_gemm=4.3e-02 t_reduction=8.3e-03 tot=5.2e-02 ---
 renorm_tot[inter] counter=11 t=1.2e-03 per=2.2e+00 cost=8.5e+05 flops=7.4e+08
 renorm_tot[gemm] counter=11 i=0 t=3.1e-05 per=5.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=1 t=2.4e-05 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=2 t=3.4e-02 per=6.6e+01 cost=9.8e+04 flops=2.9e+06
 renorm_tot[gemm] counter=11 i=3 t=4.2e-03 per=8.0e+00 cost=6.8e+05 flops=1.6e+08
 renorm_tot[gemm] counter=11 i=4 t=2.6e-05 per=4.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=5 t=2.5e-05 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=6 t=4.3e-03 per=8.2e+00 cost=1.3e+06 flops=3.0e+08
 renorm_tot[gemm] counter=11 total t=4.3e-02 per=8.2e+01 cost=2.1e+06 flops=4.8e+07
 renorm_tot[red] counter=11 t=8.3e-03 per=1.6e+01 cost=4.3e+05 flops=5.1e+07
qops.to_cpu: size(tot)=9483:7.2e-02MB:7.1e-05GB t[to_cpu]=2.9e-05S speed=2.4e+00GB/S
check ||H-H.dagger||=1.063e-18 coord=(8,0) rank=0
ctns::oper_ab2pq coord=(8,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0107 S rank=0 -----
##### local oper_env: 1.826e-02 S #####
 T(local oper_env: fetch) = 3.290e-03 S  per =   18  per(accum) = 18
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 18
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 18
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 18
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 18
 T(local oper_env: renrm) = 1.105e-02 S  per = 60.5  per(accum) = 78.5
 T(local oper_env: save ) = 3.927e-03 S  per = 21.5  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.105e-02 S  T(sum) = 1.105e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.433e-05 S  per = 0.854  per(accum) = 0.854
 T(local oper_env: qops init                    ) = 7.284e-04 S  per = 6.59  per(accum) = 7.45
 T(local oper_env: symbolic_formulae_renorm     ) = 7.435e-04 S  per = 6.73  per(accum) = 14.2
 T(local oper_env: allocate qops on gpu         ) = 9.791e-05 S  per = 0.886  per(accum) = 15.1
 T(local oper_env: site memcpy cpu2gpu          ) = 8.346e-05 S  per = 0.756  per(accum) = 15.8
 T(local oper_env: rintermediate init           ) = 4.715e-04 S  per = 4.27  per(accum) = 20.1
 T(local oper_env: preprocess_formulae_Rlist2   ) = 4.171e-03 S  per = 37.8  per(accum) = 57.8
 T(local oper_env: rmmtasks init                ) = 1.269e-03 S  per = 11.5  per(accum) = 69.3
 T(local oper_env: qops memset on cpu           ) = 4.900e-08 S  per = 0.000444  per(accum) = 69.3
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.820e-03 S  per = 25.5  per(accum) = 94.9
 T(local oper_env: reduction of opS & opH [nccl]) = 4.900e-07 S  per = 0.00444  per(accum) = 94.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.008e-04 S  per = 0.912  per(accum) = 95.8
 T(local oper_env: deallocate cpu and gpu memory) = 1.543e-04 S  per =  1.4  per(accum) = 97.2
 T(local oper_env: reduction of opS & opH [comm]) = 9.511e-05 S  per = 0.861  per(accum) = 98
 T(local oper_env: conversion from opAB to opPQ ) = 7.049e-05 S  per = 0.638  per(accum) = 98.7
 T(local oper_env: after oper_renorm            ) = 1.472e-04 S  per = 1.33  per(accum) = 100
##### sweep oper_env: 2.020e-01 S #####
 T(sweep oper_env: fetch) = 3.323e-02 S  per = 16.5  per(accum) = 16.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.5
 T(sweep oper_env: renrm) = 1.302e-01 S  per = 64.4  per(accum) = 80.9
 T(sweep oper_env: save ) = 3.857e-02 S  per = 19.1  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.906e+10 S  per = -1.906e+32
 T(sweep oper_env: preprocess                  ) = -1.906e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.302e-01 S  T(sum) = 1.302e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 9.876e-04 S  per = 0.759  per(accum) = 0.759
 T(sweep oper_env: qops init                    ) = 6.451e-03 S  per = 4.96  per(accum) = 5.71
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.903e-03 S  per = 4.53  per(accum) = 10.2
 T(sweep oper_env: allocate qops on gpu         ) = 1.057e-03 S  per = 0.812  per(accum) = 11.1
 T(sweep oper_env: site memcpy cpu2gpu          ) = 9.697e-04 S  per = 0.745  per(accum) = 11.8
 T(sweep oper_env: rintermediate init           ) = 5.243e-03 S  per = 4.03  per(accum) = 15.8
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.926e-02 S  per = 14.8  per(accum) = 30.6
 T(sweep oper_env: rmmtasks init                ) = 6.487e-03 S  per = 4.98  per(accum) = 35.6
 T(sweep oper_env: qops memset on cpu           ) = 4.940e-07 S  per = 0.000379  per(accum) = 35.6
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 7.172e-02 S  per = 55.1  per(accum) = 90.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.877e-06 S  per = 0.00528  per(accum) = 90.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.076e-03 S  per = 0.827  per(accum) = 91.5
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.769e-04 S  per = 0.443  per(accum) = 92
 T(sweep oper_env: reduction of opS & opH [comm]) = 9.582e-04 S  per = 0.736  per(accum) = 92.7
 T(sweep oper_env: conversion from opAB to opPQ ) = 8.150e-03 S  per = 6.26  per(accum) = 99
 T(sweep oper_env: after oper_renorm            ) = 1.325e-03 S  per = 1.02  per(accum) = 100

idx=12 coord=(7,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHPQ nops=C:12 S:8 H:1 P:64 Q:72 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=9483:0.0723MB:7.07e-05GB
ctns::oper_renorm coord=(7,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:13 S:7 H:1 P:49 Q:56 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=7507:0.0573MB:5.59e-05GB
CPUmem: VM:7.242e+01GB RSS:5.569e-01GB  Timing: User:2.264e+00S Sys:1.063e+00S Total:3.328e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=126 : 5.657e-04 S -----
rank=0 GPUmem(GB): used=0.000134 (oper)=0.000134
rank=0 GPUmem(GB): used=0.000135 (oper,site)(GB)=0.000134,7.23e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=126
 no. of rintermediate operators=182
 no. of coefficients=2184:0.0167MB:1.63e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.191e-04 S -----
rank=0 GPUmem(GB): used=0.000151 (oper,site,rinter)=0.000134,7.23e-07,1.63e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00314 S size(rtasks)=126 size(Rlst2)=49 T(Rmu/Rlist)=0.000151,0.00299 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00332 S size(rtasks)=126 size(Rlst)=3650 -----
rank=0 GPUmem(GB): used=0.000151 (oper,site,rinter,batch)=0.000134,7.23e-07,1.63e-05,0.00152 blksize=25 blksize0=5 batchsize=3650
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.78e-05,0.00115,0.000208
--- TIMING FOR renorm : t_inter=9.8e-05 t_gemm=1.1e-03 t_reduction=2.1e-04 tot=1.5e-03 ---
 renorm[inter] counter=12 t=9.8e-05 per=6.7e+00 cost=1.1e+05 flops=1.1e+09
 renorm[gemm] counter=12 i=0 t=2.8e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=1 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=2 t=1.6e-04 per=1.1e+01 cost=2.4e+04 flops=1.5e+08
 renorm[gemm] counter=12 i=3 t=4.9e-04 per=3.4e+01 cost=9.5e+04 flops=1.9e+08
 renorm[gemm] counter=12 i=4 t=2.7e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=5 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=6 t=4.8e-04 per=3.3e+01 cost=2.7e+05 flops=5.5e+08
 renorm[gemm] counter=12 total t=1.1e-03 per=7.9e+01 cost=3.8e+05 flops=3.4e+08
 renorm[red] counter=12 t=2.1e-04 per=1.4e+01 cost=1.2e+05 flops=5.8e+08
--- TIMING FOR renorm_tot : t_inter=1.3e-03 t_gemm=4.4e-02 t_reduction=8.5e-03 tot=5.4e-02 ---
 renorm_tot[inter] counter=12 t=1.3e-03 per=2.3e+00 cost=9.6e+05 flops=7.6e+08
 renorm_tot[gemm] counter=12 i=0 t=3.4e-05 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=1 t=2.7e-05 per=4.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=2 t=3.4e-02 per=6.4e+01 cost=1.2e+05 flops=3.5e+06
 renorm_tot[gemm] counter=12 i=3 t=4.7e-03 per=8.7e+00 cost=7.7e+05 flops=1.7e+08
 renorm_tot[gemm] counter=12 i=4 t=2.8e-05 per=5.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=5 t=2.7e-05 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=6 t=4.8e-03 per=8.8e+00 cost=1.6e+06 flops=3.3e+08
 renorm_tot[gemm] counter=12 total t=4.4e-02 per=8.2e+01 cost=2.5e+06 flops=5.6e+07
 renorm_tot[red] counter=12 t=8.5e-03 per=1.6e+01 cost=5.5e+05 flops=6.4e+07
qops.to_cpu: size(tot)=7507:5.7e-02MB:5.6e-05GB t[to_cpu]=2.5e-05S speed=2.2e+00GB/S
check ||H-H.dagger||=9.202e-19 coord=(7,0) rank=0
ctns::oper_ab2pq coord=(7,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0096 S rank=0 -----
##### local oper_env: 1.849e-02 S #####
 T(local oper_env: fetch) = 2.680e-03 S  per = 14.5  per(accum) = 14.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.5
 T(local oper_env: renrm) = 9.877e-03 S  per = 53.4  per(accum) = 67.9
 T(local oper_env: save ) = 5.935e-03 S  per = 32.1  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.877e-03 S  T(sum) = 9.877e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.548e-05 S  per = 0.764  per(accum) = 0.764
 T(local oper_env: qops init                    ) = 6.367e-04 S  per = 6.45  per(accum) = 7.21
 T(local oper_env: symbolic_formulae_renorm     ) = 6.447e-04 S  per = 6.53  per(accum) = 13.7
 T(local oper_env: allocate qops on gpu         ) = 9.706e-05 S  per = 0.983  per(accum) = 14.7
 T(local oper_env: site memcpy cpu2gpu          ) = 9.066e-05 S  per = 0.918  per(accum) = 15.6
 T(local oper_env: rintermediate init           ) = 4.704e-04 S  per = 4.76  per(accum) = 20.4
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.401e-03 S  per = 34.4  per(accum) = 54.8
 T(local oper_env: rmmtasks init                ) = 9.138e-04 S  per = 9.25  per(accum) = 64.1
 T(local oper_env: qops memset on cpu           ) = 3.900e-08 S  per = 0.000395  per(accum) = 64.1
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.146e-03 S  per = 31.9  per(accum) = 95.9
 T(local oper_env: reduction of opS & opH [nccl]) = 6.010e-07 S  per = 0.00608  per(accum) = 96
 T(local oper_env: qops memcpy gpu2cpu          ) = 9.797e-05 S  per = 0.992  per(accum) = 96.9
 T(local oper_env: deallocate cpu and gpu memory) = 1.099e-05 S  per = 0.111  per(accum) = 97.1
 T(local oper_env: reduction of opS & opH [comm]) = 8.955e-05 S  per = 0.907  per(accum) = 98
 T(local oper_env: conversion from opAB to opPQ ) = 7.295e-05 S  per = 0.739  per(accum) = 98.7
 T(local oper_env: after oper_renorm            ) = 1.285e-04 S  per =  1.3  per(accum) = 100
##### sweep oper_env: 2.205e-01 S #####
 T(sweep oper_env: fetch) = 3.591e-02 S  per = 16.3  per(accum) = 16.3
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.3
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.3
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.3
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.3
 T(sweep oper_env: renrm) = 1.401e-01 S  per = 63.5  per(accum) = 79.8
 T(sweep oper_env: save ) = 4.451e-02 S  per = 20.2  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.079e+10 S  per = -2.079e+32
 T(sweep oper_env: preprocess                  ) = -2.079e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.401e-01 S  T(sum) = 1.401e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.063e-03 S  per = 0.759  per(accum) = 0.759
 T(sweep oper_env: qops init                    ) = 7.087e-03 S  per = 5.06  per(accum) = 5.82
 T(sweep oper_env: symbolic_formulae_renorm     ) = 6.548e-03 S  per = 4.68  per(accum) = 10.5
 T(sweep oper_env: allocate qops on gpu         ) = 1.154e-03 S  per = 0.824  per(accum) = 11.3
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.060e-03 S  per = 0.757  per(accum) = 12.1
 T(sweep oper_env: rintermediate init           ) = 5.714e-03 S  per = 4.08  per(accum) = 16.2
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.266e-02 S  per = 16.2  per(accum) = 32.3
 T(sweep oper_env: rmmtasks init                ) = 7.401e-03 S  per = 5.28  per(accum) = 37.6
 T(sweep oper_env: qops memset on cpu           ) = 5.330e-07 S  per = 0.000381  per(accum) = 37.6
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 7.487e-02 S  per = 53.5  per(accum) = 91.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 7.478e-06 S  per = 0.00534  per(accum) = 91.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.174e-03 S  per = 0.838  per(accum) = 91.9
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.879e-04 S  per = 0.42  per(accum) = 92.3
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.048e-03 S  per = 0.748  per(accum) = 93.1
 T(sweep oper_env: conversion from opAB to opPQ ) = 8.223e-03 S  per = 5.87  per(accum) = 99
 T(sweep oper_env: after oper_renorm            ) = 1.454e-03 S  per = 1.04  per(accum) = 100

idx=13 coord=(6,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHPQ nops=C:13 S:7 H:1 P:49 Q:56 
        dim(bra,ket)=19,19 size(op)=176:0.00134MB size(tot)=7507:0.0573MB:5.59e-05GB
ctns::oper_renorm coord=(6,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:14 S:6 H:1 P:36 Q:42 
        dim(bra,ket)=17,17 size(op)=137:0.00105MB size(tot)=4483:0.0342MB:3.34e-05GB
CPUmem: VM:7.242e+01GB RSS:5.571e-01GB  Timing: User:2.271e+00S Sys:1.071e+00S Total:3.342e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=99 : 6.083e-04 S -----
rank=0 GPUmem(GB): used=9.68e-05 (oper)=9.68e-05
rank=0 GPUmem(GB): used=9.78e-05 (oper,site)(GB)=9.68e-05,9.98e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=99
 no. of rintermediate operators=138
 no. of coefficients=1794:0.0137MB:1.34e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.244e-04 S -----
rank=0 GPUmem(GB): used=0.000111 (oper,site,rinter)=9.68e-05,9.98e-07,1.34e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00456 S size(rtasks)=99 size(Rlst2)=49 T(Rmu/Rlist)=0.000303,0.00426 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00495 S size(rtasks)=99 size(Rlst)=4942 -----
rank=0 GPUmem(GB): used=0.000111 (oper,site,rinter,batch)=9.68e-05,9.98e-07,1.34e-05,0.00169 blksize=20 blksize0=5 batchsize=4942
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000561,0.00155,0.000348
--- TIMING FOR renorm : t_inter=5.6e-04 t_gemm=1.6e-03 t_reduction=3.5e-04 tot=2.5e-03 ---
 renorm[inter] counter=13 t=5.6e-04 per=2.3e+01 cost=1.8e+05 flops=3.1e+08
 renorm[gemm] counter=13 i=0 t=4.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=1 t=3.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=2 t=6.5e-04 per=2.7e+01 cost=2.3e+04 flops=3.5e+07
 renorm[gemm] counter=13 i=3 t=4.7e-04 per=1.9e+01 cost=1.5e+05 flops=3.2e+08
 renorm[gemm] counter=13 i=4 t=2.3e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=5 t=2.3e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=6 t=4.2e-04 per=1.7e+01 cost=2.4e+05 flops=5.7e+08
 renorm[gemm] counter=13 total t=1.6e-03 per=6.3e+01 cost=4.1e+05 flops=2.6e+08
 renorm[red] counter=13 t=3.5e-04 per=1.4e+01 cost=7.2e+04 flops=2.1e+08
--- TIMING FOR renorm_tot : t_inter=1.8e-03 t_gemm=4.6e-02 t_reduction=8.9e-03 tot=5.6e-02 ---
 renorm_tot[inter] counter=13 t=1.8e-03 per=3.2e+00 cost=1.1e+06 flops=6.2e+08
 renorm_tot[gemm] counter=13 i=0 t=3.8e-05 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=1 t=3.0e-05 per=5.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=2 t=3.5e-02 per=6.2e+01 cost=1.5e+05 flops=4.1e+06
 renorm_tot[gemm] counter=13 i=3 t=5.1e-03 per=9.1e+00 cost=9.2e+05 flops=1.8e+08
 renorm_tot[gemm] counter=13 i=4 t=3.1e-05 per=5.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=5 t=2.9e-05 per=5.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=6 t=5.2e-03 per=9.2e+00 cost=1.8e+06 flops=3.5e+08
 renorm_tot[gemm] counter=13 total t=4.6e-02 per=8.1e+01 cost=2.9e+06 flops=6.3e+07
 renorm_tot[red] counter=13 t=8.9e-03 per=1.6e+01 cost=6.2e+05 flops=7.0e+07
qops.to_cpu: size(tot)=4483:3.4e-02MB:3.3e-05GB t[to_cpu]=5.1e-05S speed=6.5e-01GB/S
check ||H-H.dagger||=1.256e-15 coord=(6,0) rank=0
ctns::oper_ab2pq coord=(6,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0136 S rank=0 -----
##### local oper_env: 2.218e-02 S #####
 T(local oper_env: fetch) = 3.930e-03 S  per = 17.7  per(accum) = 17.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17.7
 T(local oper_env: renrm) = 1.391e-02 S  per = 62.7  per(accum) = 80.4
 T(local oper_env: save ) = 4.340e-03 S  per = 19.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.391e-02 S  T(sum) = 1.391e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.097e-05 S  per = 0.582  per(accum) = 0.582
 T(local oper_env: qops init                    ) = 7.189e-04 S  per = 5.17  per(accum) = 5.75
 T(local oper_env: symbolic_formulae_renorm     ) = 6.843e-04 S  per = 4.92  per(accum) = 10.7
 T(local oper_env: allocate qops on gpu         ) = 1.956e-04 S  per = 1.41  per(accum) = 12.1
 T(local oper_env: site memcpy cpu2gpu          ) = 1.277e-04 S  per = 0.918  per(accum) = 13
 T(local oper_env: rintermediate init           ) = 4.702e-04 S  per = 3.38  per(accum) = 16.4
 T(local oper_env: preprocess_formulae_Rlist2   ) = 5.035e-03 S  per = 36.2  per(accum) = 52.6
 T(local oper_env: rmmtasks init                ) = 1.731e-03 S  per = 12.4  per(accum) = 65
 T(local oper_env: qops memset on cpu           ) = 6.700e-08 S  per = 0.000482  per(accum) = 65
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.204e-03 S  per = 30.2  per(accum) = 95.2
 T(local oper_env: reduction of opS & opH [nccl]) = 5.080e-07 S  per = 0.00365  per(accum) = 95.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.331e-04 S  per = 0.957  per(accum) = 96.2
 T(local oper_env: deallocate cpu and gpu memory) = 2.048e-04 S  per = 1.47  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [comm]) = 1.038e-04 S  per = 0.746  per(accum) = 98.4
 T(local oper_env: conversion from opAB to opPQ ) = 7.736e-05 S  per = 0.556  per(accum) = 99
 T(local oper_env: after oper_renorm            ) = 1.442e-04 S  per = 1.04  per(accum) = 100
##### sweep oper_env: 2.427e-01 S #####
 T(sweep oper_env: fetch) = 3.984e-02 S  per = 16.4  per(accum) = 16.4
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.4
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.4
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.4
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.4
 T(sweep oper_env: renrm) = 1.540e-01 S  per = 63.5  per(accum) = 79.9
 T(sweep oper_env: save ) = 4.885e-02 S  per = 20.1  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.252e+10 S  per = -2.252e+32
 T(sweep oper_env: preprocess                  ) = -2.252e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.540e-01 S  T(sum) = 1.540e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.144e-03 S  per = 0.743  per(accum) = 0.743
 T(sweep oper_env: qops init                    ) = 7.806e-03 S  per = 5.07  per(accum) = 5.81
 T(sweep oper_env: symbolic_formulae_renorm     ) = 7.232e-03 S  per =  4.7  per(accum) = 10.5
 T(sweep oper_env: allocate qops on gpu         ) = 1.350e-03 S  per = 0.877  per(accum) = 11.4
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.188e-03 S  per = 0.772  per(accum) = 12.2
 T(sweep oper_env: rintermediate init           ) = 6.184e-03 S  per = 4.02  per(accum) = 16.2
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.770e-02 S  per =   18  per(accum) = 34.2
 T(sweep oper_env: rmmtasks init                ) = 9.132e-03 S  per = 5.93  per(accum) = 40.1
 T(sweep oper_env: qops memset on cpu           ) = 6.000e-07 S  per = 0.00039  per(accum) = 40.1
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 7.907e-02 S  per = 51.4  per(accum) = 91.5
 T(sweep oper_env: reduction of opS & opH [nccl]) = 7.986e-06 S  per = 0.00519  per(accum) = 91.5
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.307e-03 S  per = 0.849  per(accum) = 92.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 7.927e-04 S  per = 0.515  per(accum) = 92.8
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.152e-03 S  per = 0.748  per(accum) = 93.6
 T(sweep oper_env: conversion from opAB to opPQ ) = 8.301e-03 S  per = 5.39  per(accum) = 99
 T(sweep oper_env: after oper_renorm            ) = 1.598e-03 S  per = 1.04  per(accum) = 100

idx=14 coord=(5,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHPQ nops=C:14 S:6 H:1 P:36 Q:42 
        dim(bra,ket)=17,17 size(op)=137:0.00105MB size(tot)=4483:0.0342MB:3.34e-05GB
ctns::oper_renorm coord=(5,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:15 S:5 H:1 P:25 Q:30 
        dim(bra,ket)=15,15 size(op)=97:0.00074MB size(tot)=2439:0.0186MB:1.82e-05GB
CPUmem: VM:7.242e+01GB RSS:5.571e-01GB  Timing: User:2.281e+00S Sys:1.076e+00S Total:3.357e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=76 : 4.384e-04 S -----
rank=0 GPUmem(GB): used=5.9e-05 (oper)=5.9e-05
rank=0 GPUmem(GB): used=5.98e-05 (oper,site)(GB)=5.9e-05,7.45e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=76
 no. of rintermediate operators=100
 no. of coefficients=1400:0.0107MB:1.04e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.308e-04 S -----
rank=0 GPUmem(GB): used=7.02e-05 (oper,site,rinter)=5.9e-05,7.45e-07,1.04e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00321 S size(rtasks)=76 size(Rlst2)=49 T(Rmu/Rlist)=8.73e-05,0.00313 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0034 S size(rtasks)=76 size(Rlst)=3836 -----
rank=0 GPUmem(GB): used=7.02e-05 (oper,site,rinter,batch)=5.9e-05,7.45e-07,1.04e-05,0.000829 blksize=12 blksize0=4 batchsize=3836
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000107,0.000704,0.000251
--- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=7.0e-04 t_reduction=2.5e-04 tot=1.1e-03 ---
 renorm[inter] counter=14 t=1.1e-04 per=1.0e+01 cost=1.2e+05 flops=1.1e+09
 renorm[gemm] counter=14 i=0 t=2.8e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=1 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=2 t=2.4e-04 per=2.2e+01 cost=1.3e+04 flops=5.6e+07
 renorm[gemm] counter=14 i=3 t=2.6e-04 per=2.5e+01 cost=6.9e+04 flops=2.6e+08
 renorm[gemm] counter=14 i=4 t=2.3e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=5 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=6 t=1.9e-04 per=1.8e+01 cost=1.1e+05 flops=5.5e+08
 renorm[gemm] counter=14 total t=7.0e-04 per=6.6e+01 cost=1.9e+05 flops=2.7e+08
 renorm[red] counter=14 t=2.5e-04 per=2.4e+01 cost=3.8e+04 flops=1.5e+08
--- TIMING FOR renorm_tot : t_inter=1.9e-03 t_gemm=4.6e-02 t_reduction=9.1e-03 tot=5.7e-02 ---
 renorm_tot[inter] counter=14 t=1.9e-03 per=3.4e+00 cost=1.2e+06 flops=6.5e+08
 renorm_tot[gemm] counter=14 i=0 t=4.1e-05 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=1 t=3.2e-05 per=5.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=2 t=3.5e-02 per=6.2e+01 cost=1.6e+05 flops=4.5e+06
 renorm_tot[gemm] counter=14 i=3 t=5.4e-03 per=9.4e+00 cost=9.9e+05 flops=1.8e+08
 renorm_tot[gemm] counter=14 i=4 t=3.3e-05 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=5 t=3.1e-05 per=5.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=6 t=5.4e-03 per=9.4e+00 cost=1.9e+06 flops=3.6e+08
 renorm_tot[gemm] counter=14 total t=4.6e-02 per=8.1e+01 cost=3.1e+06 flops=6.6e+07
 renorm_tot[red] counter=14 t=9.1e-03 per=1.6e+01 cost=6.6e+05 flops=7.2e+07
qops.to_cpu: size(tot)=2439:1.9e-02MB:1.8e-05GB t[to_cpu]=2.0e-05S speed=9.1e-01GB/S
check ||H-H.dagger||=9.736e-18 coord=(5,0) rank=0
ctns::oper_ab2pq coord=(5,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0093 S rank=0 -----
##### local oper_env: 1.608e-02 S #####
 T(local oper_env: fetch) = 2.898e-03 S  per =   18  per(accum) = 18
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 18
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 18
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 18
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 18
 T(local oper_env: renrm) = 9.586e-03 S  per = 59.6  per(accum) = 77.6
 T(local oper_env: save ) = 3.596e-03 S  per = 22.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.586e-03 S  T(sum) = 9.586e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.796e-05 S  per = 0.813  per(accum) = 0.813
 T(local oper_env: qops init                    ) = 5.100e-04 S  per = 5.32  per(accum) = 6.13
 T(local oper_env: symbolic_formulae_renorm     ) = 5.256e-04 S  per = 5.48  per(accum) = 11.6
 T(local oper_env: allocate qops on gpu         ) = 9.049e-05 S  per = 0.944  per(accum) = 12.6
 T(local oper_env: site memcpy cpu2gpu          ) = 1.111e-04 S  per = 1.16  per(accum) = 13.7
 T(local oper_env: rintermediate init           ) = 4.827e-04 S  per = 5.04  per(accum) = 18.8
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.487e-03 S  per = 36.4  per(accum) = 55.1
 T(local oper_env: rmmtasks init                ) = 1.040e-03 S  per = 10.9  per(accum) = 66
 T(local oper_env: qops memset on cpu           ) = 5.200e-08 S  per = 0.000542  per(accum) = 66
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.857e-03 S  per = 29.8  per(accum) = 95.8
 T(local oper_env: reduction of opS & opH [nccl]) = 5.410e-07 S  per = 0.00564  per(accum) = 95.8
 T(local oper_env: qops memcpy gpu2cpu          ) = 9.729e-05 S  per = 1.01  per(accum) = 96.8
 T(local oper_env: deallocate cpu and gpu memory) = 1.121e-05 S  per = 0.117  per(accum) = 96.9
 T(local oper_env: reduction of opS & opH [comm]) = 9.040e-05 S  per = 0.943  per(accum) = 97.9
 T(local oper_env: conversion from opAB to opPQ ) = 7.656e-05 S  per = 0.799  per(accum) = 98.7
 T(local oper_env: after oper_renorm            ) = 1.279e-04 S  per = 1.33  per(accum) = 100
##### sweep oper_env: 2.587e-01 S #####
 T(sweep oper_env: fetch) = 4.274e-02 S  per = 16.5  per(accum) = 16.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.5
 T(sweep oper_env: renrm) = 1.636e-01 S  per = 63.2  per(accum) = 79.7
 T(sweep oper_env: save ) = 5.244e-02 S  per = 20.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.425e+10 S  per = -2.425e+32
 T(sweep oper_env: preprocess                  ) = -2.425e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.636e-01 S  T(sum) = 1.636e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.222e-03 S  per = 0.747  per(accum) = 0.747
 T(sweep oper_env: qops init                    ) = 8.316e-03 S  per = 5.08  per(accum) = 5.83
 T(sweep oper_env: symbolic_formulae_renorm     ) = 7.758e-03 S  per = 4.74  per(accum) = 10.6
 T(sweep oper_env: allocate qops on gpu         ) = 1.440e-03 S  per = 0.881  per(accum) = 11.5
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.299e-03 S  per = 0.794  per(accum) = 12.3
 T(sweep oper_env: rintermediate init           ) = 6.667e-03 S  per = 4.08  per(accum) = 16.3
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.118e-02 S  per = 19.1  per(accum) = 35.4
 T(sweep oper_env: rmmtasks init                ) = 1.017e-02 S  per = 6.22  per(accum) = 41.6
 T(sweep oper_env: qops memset on cpu           ) = 6.520e-07 S  per = 0.000399  per(accum) = 41.6
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 8.193e-02 S  per = 50.1  per(accum) = 91.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 8.527e-06 S  per = 0.00521  per(accum) = 91.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.404e-03 S  per = 0.859  per(accum) = 92.6
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.039e-04 S  per = 0.492  per(accum) = 93.1
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.242e-03 S  per = 0.759  per(accum) = 93.8
 T(sweep oper_env: conversion from opAB to opPQ ) = 8.377e-03 S  per = 5.12  per(accum) = 98.9
 T(sweep oper_env: after oper_renorm            ) = 1.726e-03 S  per = 1.06  per(accum) = 100

idx=15 coord=(4,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHPQ nops=C:15 S:5 H:1 P:25 Q:30 
        dim(bra,ket)=15,15 size(op)=97:0.00074MB size(tot)=2439:0.0186MB:1.82e-05GB
ctns::oper_renorm coord=(4,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:16 S:4 H:1 P:16 Q:20 
        dim(bra,ket)=14,14 size(op)=62:0.000473MB size(tot)=1204:0.00919MB:8.97e-06GB
CPUmem: VM:7.242e+01GB RSS:5.571e-01GB  Timing: User:2.290e+00S Sys:1.076e+00S Total:3.366e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=57 : 4.160e-04 S -----
rank=0 GPUmem(GB): used=3.46e-05 (oper)=3.46e-05
rank=0 GPUmem(GB): used=3.51e-05 (oper,site)(GB)=3.46e-05,5.36e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=57
 no. of rintermediate operators=68
 no. of coefficients=1020:0.00778MB:7.6e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.305e-04 S -----
rank=0 GPUmem(GB): used=4.27e-05 (oper,site,rinter)=3.46e-05,5.36e-07,7.6e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00303 S size(rtasks)=57 size(Rlst2)=81 T(Rmu/Rlist)=6.37e-05,0.00297 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00321 S size(rtasks)=57 size(Rlst)=3418 -----
rank=0 GPUmem(GB): used=4.27e-05 (oper,site,rinter,batch)=3.46e-05,5.36e-07,7.6e-06,0.000407 blksize=6 blksize0=3 batchsize=3418
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.88e-05,0.000443,0.000243
--- TIMING FOR renorm : t_inter=8.9e-05 t_gemm=4.4e-04 t_reduction=2.4e-04 tot=7.7e-04 ---
 renorm[inter] counter=15 t=8.9e-05 per=1.1e+01 cost=8.0e+04 flops=9.0e+08
 renorm[gemm] counter=15 i=0 t=2.8e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=1 t=2.2e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=2 t=1.3e-04 per=1.7e+01 cost=7.1e+03 flops=5.4e+07
 renorm[gemm] counter=15 i=3 t=1.5e-04 per=1.9e+01 cost=3.0e+04 flops=2.1e+08
 renorm[gemm] counter=15 i=4 t=2.3e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=5 t=2.2e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=6 t=1.5e-04 per=2.0e+01 cost=3.8e+04 flops=2.4e+08
 renorm[gemm] counter=15 total t=4.4e-04 per=5.7e+01 cost=7.5e+04 flops=1.7e+08
 renorm[red] counter=15 t=2.4e-04 per=3.1e+01 cost=1.7e+04 flops=6.9e+07
--- TIMING FOR renorm_tot : t_inter=2.0e-03 t_gemm=4.7e-02 t_reduction=9.4e-03 tot=5.8e-02 ---
 renorm_tot[inter] counter=15 t=2.0e-03 per=3.5e+00 cost=1.3e+06 flops=6.6e+08
 renorm_tot[gemm] counter=15 i=0 t=4.4e-05 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=1 t=3.4e-05 per=5.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=2 t=3.6e-02 per=6.1e+01 cost=1.7e+05 flops=4.7e+06
 renorm_tot[gemm] counter=15 i=3 t=5.6e-03 per=9.6e+00 cost=1.0e+06 flops=1.8e+08
 renorm_tot[gemm] counter=15 i=4 t=3.5e-05 per=6.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=5 t=3.4e-05 per=5.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=6 t=5.5e-03 per=9.5e+00 cost=1.9e+06 flops=3.5e+08
 renorm_tot[gemm] counter=15 total t=4.7e-02 per=8.0e+01 cost=3.1e+06 flops=6.7e+07
 renorm_tot[red] counter=15 t=9.4e-03 per=1.6e+01 cost=6.7e+05 flops=7.2e+07
qops.to_cpu: size(tot)=1204:9.2e-03MB:9.0e-06GB t[to_cpu]=1.8e-05S speed=5.0e-01GB/S
check ||H-H.dagger||=6.939e-18 coord=(4,0) rank=0
ctns::oper_ab2pq coord=(4,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00878 S rank=0 -----
##### local oper_env: 1.482e-02 S #####
 T(local oper_env: fetch) = 2.334e-03 S  per = 15.7  per(accum) = 15.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15.7
 T(local oper_env: renrm) = 9.085e-03 S  per = 61.3  per(accum) = 77
 T(local oper_env: save ) = 3.402e-03 S  per =   23  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.085e-03 S  T(sum) = 9.085e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.043e-04 S  per = 1.15  per(accum) = 1.15
 T(local oper_env: qops init                    ) = 6.106e-04 S  per = 6.72  per(accum) = 7.87
 T(local oper_env: symbolic_formulae_renorm     ) = 5.164e-04 S  per = 5.68  per(accum) = 13.6
 T(local oper_env: allocate qops on gpu         ) = 9.616e-05 S  per = 1.06  per(accum) = 14.6
 T(local oper_env: site memcpy cpu2gpu          ) = 9.005e-05 S  per = 0.991  per(accum) = 15.6
 T(local oper_env: rintermediate init           ) = 4.852e-04 S  per = 5.34  per(accum) = 20.9
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.302e-03 S  per = 36.3  per(accum) = 57.3
 T(local oper_env: rmmtasks init                ) = 8.841e-04 S  per = 9.73  per(accum) = 67
 T(local oper_env: qops memset on cpu           ) = 5.700e-08 S  per = 0.000627  per(accum) = 67
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.586e-03 S  per = 28.5  per(accum) = 95.5
 T(local oper_env: reduction of opS & opH [nccl]) = 5.720e-07 S  per = 0.0063  per(accum) = 95.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.019e-04 S  per = 1.12  per(accum) = 96.6
 T(local oper_env: deallocate cpu and gpu memory) = 1.090e-05 S  per = 0.12  per(accum) = 96.7
 T(local oper_env: reduction of opS & opH [comm]) = 9.877e-05 S  per = 1.09  per(accum) = 97.8
 T(local oper_env: conversion from opAB to opPQ ) = 7.617e-05 S  per = 0.838  per(accum) = 98.7
 T(local oper_env: after oper_renorm            ) = 1.215e-04 S  per = 1.34  per(accum) = 100
##### sweep oper_env: 2.736e-01 S #####
 T(sweep oper_env: fetch) = 4.508e-02 S  per = 16.5  per(accum) = 16.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.5
 T(sweep oper_env: renrm) = 1.726e-01 S  per = 63.1  per(accum) = 79.6
 T(sweep oper_env: save ) = 5.585e-02 S  per = 20.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.599e+10 S  per = -2.599e+32
 T(sweep oper_env: preprocess                  ) = -2.599e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.726e-01 S  T(sum) = 1.726e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.326e-03 S  per = 0.768  per(accum) = 0.768
 T(sweep oper_env: qops init                    ) = 8.927e-03 S  per = 5.17  per(accum) = 5.94
 T(sweep oper_env: symbolic_formulae_renorm     ) = 8.274e-03 S  per = 4.79  per(accum) = 10.7
 T(sweep oper_env: allocate qops on gpu         ) = 1.536e-03 S  per = 0.89  per(accum) = 11.6
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.389e-03 S  per = 0.805  per(accum) = 12.4
 T(sweep oper_env: rintermediate init           ) = 7.152e-03 S  per = 4.14  per(accum) = 16.6
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.449e-02 S  per =   20  per(accum) = 36.5
 T(sweep oper_env: rmmtasks init                ) = 1.106e-02 S  per =  6.4  per(accum) = 43
 T(sweep oper_env: qops memset on cpu           ) = 7.090e-07 S  per = 0.000411  per(accum) = 43
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 8.452e-02 S  per =   49  per(accum) = 91.9
 T(sweep oper_env: reduction of opS & opH [nccl]) = 9.099e-06 S  per = 0.00527  per(accum) = 91.9
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.506e-03 S  per = 0.873  per(accum) = 92.8
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.148e-04 S  per = 0.472  per(accum) = 93.3
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.341e-03 S  per = 0.777  per(accum) = 94
 T(sweep oper_env: conversion from opAB to opPQ ) = 8.454e-03 S  per =  4.9  per(accum) = 98.9
 T(sweep oper_env: after oper_renorm            ) = 1.847e-03 S  per = 1.07  per(accum) = 100

idx=16 coord=(3,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHPQ nops=C:16 S:4 H:1 P:16 Q:20 
        dim(bra,ket)=14,14 size(op)=62:0.000473MB size(tot)=1204:0.00919MB:8.97e-06GB
ctns::oper_renorm coord=(3,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:17 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=11,11 size(op)=28:0.000214MB size(tot)=445:0.0034MB:3.32e-06GB
CPUmem: VM:7.242e+01GB RSS:5.571e-01GB  Timing: User:2.299e+00S Sys:1.077e+00S Total:3.376e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=42 : 2.329e-04 S -----
rank=0 GPUmem(GB): used=1.97e-05 (oper)=1.97e-05
rank=0 GPUmem(GB): used=2e-05 (oper,site)(GB)=1.97e-05,3.13e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=42
 no. of rintermediate operators=42
 no. of coefficients=672:0.00513MB:5.01e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.450e-04 S -----
rank=0 GPUmem(GB): used=2.5e-05 (oper,site,rinter)=1.97e-05,3.13e-07,5.01e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00397 S size(rtasks)=42 size(Rlst2)=121 T(Rmu/Rlist)=4.45e-05,0.00392 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00414 S size(rtasks)=42 size(Rlst)=3286 -----
rank=0 GPUmem(GB): used=2.5e-05 (oper,site,rinter,batch)=1.97e-05,3.13e-07,5.01e-06,0.000171 blksize=2 blksize0=2 batchsize=3286
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.09e-05,0.000272,0.000205
--- TIMING FOR renorm : t_inter=9.1e-05 t_gemm=2.7e-04 t_reduction=2.0e-04 tot=5.7e-04 ---
 renorm[inter] counter=16 t=9.1e-05 per=1.6e+01 cost=4.8e+04 flops=5.2e+08
 renorm[gemm] counter=16 i=0 t=2.8e-06 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=1 t=2.3e-06 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=2 t=8.7e-05 per=1.5e+01 cost=3.3e+03 flops=3.7e+07
 renorm[gemm] counter=16 i=3 t=9.0e-05 per=1.6e+01 cost=9.5e+03 flops=1.1e+08
 renorm[gemm] counter=16 i=4 t=2.2e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=5 t=2.2e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=6 t=8.4e-05 per=1.5e+01 cost=9.9e+03 flops=1.2e+08
 renorm[gemm] counter=16 total t=2.7e-04 per=4.8e+01 cost=2.3e+04 flops=8.3e+07
 renorm[red] counter=16 t=2.0e-04 per=3.6e+01 cost=6.6e+03 flops=3.2e+07
--- TIMING FOR renorm_tot : t_inter=2.1e-03 t_gemm=4.7e-02 t_reduction=9.6e-03 tot=5.9e-02 ---
 renorm_tot[inter] counter=16 t=2.1e-03 per=3.6e+00 cost=1.4e+06 flops=6.6e+08
 renorm_tot[gemm] counter=16 i=0 t=4.6e-05 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=1 t=3.6e-05 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=2 t=3.6e-02 per=6.1e+01 cost=1.7e+05 flops=4.7e+06
 renorm_tot[gemm] counter=16 i=3 t=5.6e-03 per=9.6e+00 cost=1.0e+06 flops=1.8e+08
 renorm_tot[gemm] counter=16 i=4 t=3.7e-05 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=5 t=3.6e-05 per=6.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=6 t=5.6e-03 per=9.5e+00 cost=2.0e+06 flops=3.5e+08
 renorm_tot[gemm] counter=16 total t=4.7e-02 per=8.0e+01 cost=3.2e+06 flops=6.7e+07
 renorm_tot[red] counter=16 t=9.6e-03 per=1.6e+01 cost=6.8e+05 flops=7.1e+07
qops.to_cpu: size(tot)=445:3.4e-03MB:3.3e-06GB t[to_cpu]=1.6e-05S speed=2.1e-01GB/S
check ||H-H.dagger||=0.000e+00 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00918 S rank=0 -----
##### local oper_env: 1.560e-02 S #####
 T(local oper_env: fetch) = 3.122e-03 S  per =   20  per(accum) = 20
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 20
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 20
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 20
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 20
 T(local oper_env: renrm) = 9.454e-03 S  per = 60.6  per(accum) = 80.6
 T(local oper_env: save ) = 3.027e-03 S  per = 19.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.454e-03 S  T(sum) = 9.454e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.231e-05 S  per = 0.871  per(accum) = 0.871
 T(local oper_env: qops init                    ) = 5.784e-04 S  per = 6.12  per(accum) = 6.99
 T(local oper_env: symbolic_formulae_renorm     ) = 3.102e-04 S  per = 3.28  per(accum) = 10.3
 T(local oper_env: allocate qops on gpu         ) = 9.795e-05 S  per = 1.04  per(accum) = 11.3
 T(local oper_env: site memcpy cpu2gpu          ) = 1.223e-04 S  per = 1.29  per(accum) = 12.6
 T(local oper_env: rintermediate init           ) = 4.937e-04 S  per = 5.22  per(accum) = 17.8
 T(local oper_env: preprocess_formulae_Rlist2   ) = 4.230e-03 S  per = 44.7  per(accum) = 62.6
 T(local oper_env: rmmtasks init                ) = 8.551e-04 S  per = 9.04  per(accum) = 71.6
 T(local oper_env: qops memset on cpu           ) = 3.700e-08 S  per = 0.000391  per(accum) = 71.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.280e-03 S  per = 24.1  per(accum) = 95.7
 T(local oper_env: reduction of opS & opH [nccl]) = 5.630e-07 S  per = 0.00596  per(accum) = 95.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.016e-04 S  per = 1.07  per(accum) = 96.8
 T(local oper_env: deallocate cpu and gpu memory) = 9.843e-06 S  per = 0.104  per(accum) = 96.9
 T(local oper_env: reduction of opS & opH [comm]) = 1.001e-04 S  per = 1.06  per(accum) = 98
 T(local oper_env: conversion from opAB to opPQ ) = 8.221e-05 S  per = 0.87  per(accum) = 98.8
 T(local oper_env: after oper_renorm            ) = 1.094e-04 S  per = 1.16  per(accum) = 100
##### sweep oper_env: 2.892e-01 S #####
 T(sweep oper_env: fetch) = 4.820e-02 S  per = 16.7  per(accum) = 16.7
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.7
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.7
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.7
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.7
 T(sweep oper_env: renrm) = 1.821e-01 S  per =   63  per(accum) = 79.6
 T(sweep oper_env: save ) = 5.887e-02 S  per = 20.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.772e+10 S  per = -2.772e+32
 T(sweep oper_env: preprocess                  ) = -2.772e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.821e-01 S  T(sum) = 1.821e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.409e-03 S  per = 0.774  per(accum) = 0.774
 T(sweep oper_env: qops init                    ) = 9.505e-03 S  per = 5.22  per(accum) = 5.99
 T(sweep oper_env: symbolic_formulae_renorm     ) = 8.584e-03 S  per = 4.71  per(accum) = 10.7
 T(sweep oper_env: allocate qops on gpu         ) = 1.634e-03 S  per = 0.897  per(accum) = 11.6
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.512e-03 S  per = 0.83  per(accum) = 12.4
 T(sweep oper_env: rintermediate init           ) = 7.646e-03 S  per =  4.2  per(accum) = 16.6
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.872e-02 S  per = 21.3  per(accum) = 37.9
 T(sweep oper_env: rmmtasks init                ) = 1.191e-02 S  per = 6.54  per(accum) = 44.4
 T(sweep oper_env: qops memset on cpu           ) = 7.460e-07 S  per = 0.00041  per(accum) = 44.4
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 8.680e-02 S  per = 47.7  per(accum) = 92.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 9.662e-06 S  per = 0.00531  per(accum) = 92.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.608e-03 S  per = 0.883  per(accum) = 93
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.247e-04 S  per = 0.453  per(accum) = 93.4
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.441e-03 S  per = 0.791  per(accum) = 94.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 8.536e-03 S  per = 4.69  per(accum) = 98.9
 T(sweep oper_env: after oper_renorm            ) = 1.957e-03 S  per = 1.07  per(accum) = 100

idx=17 coord=(2,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHPQ nops=C:17 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=11,11 size(op)=28:0.000214MB size(tot)=445:0.0034MB:3.32e-06GB
ctns::oper_renorm coord=(2,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:18 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=69:0.000526MB:5.14e-07GB
CPUmem: VM:7.242e+01GB RSS:5.571e-01GB  Timing: User:2.309e+00S Sys:1.077e+00S Total:3.386e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=31 : 1.698e-04 S -----
rank=0 GPUmem(GB): used=1.13e-05 (oper)=1.13e-05
rank=0 GPUmem(GB): used=1.14e-05 (oper,site)(GB)=1.13e-05,1.19e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=31
 no. of rintermediate operators=22
 no. of coefficients=374:0.00285MB:2.79e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.978e-04 S -----
rank=0 GPUmem(GB): used=1.42e-05 (oper,site,rinter)=1.13e-05,1.19e-07,2.79e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000932 S size(rtasks)=31 size(Rlst2)=36 T(Rmu/Rlist)=3.1e-05,0.0009 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00104 S size(rtasks)=31 size(Rlst)=993 -----
rank=0 GPUmem(GB): used=1.42e-05 (oper,site,rinter,batch)=1.13e-05,1.19e-07,2.79e-06,2.96e-05 blksize=1 blksize0=1 batchsize=993
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.8e-05,0.000177,0.000118
--- TIMING FOR renorm : t_inter=7.8e-05 t_gemm=1.8e-04 t_reduction=1.2e-04 tot=3.7e-04 ---
 renorm[inter] counter=17 t=7.8e-05 per=2.1e+01 cost=5.9e+03 flops=7.6e+07
 renorm[gemm] counter=17 i=0 t=2.7e-06 per=7.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=1 t=2.2e-06 per=5.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=2 t=5.9e-05 per=1.6e+01 cost=6.3e+02 flops=1.1e+07
 renorm[gemm] counter=17 i=3 t=5.3e-05 per=1.4e+01 cost=1.1e+03 flops=2.0e+07
 renorm[gemm] counter=17 i=4 t=2.3e-06 per=6.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=5 t=2.2e-06 per=5.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=6 t=5.6e-05 per=1.5e+01 cost=2.0e+03 flops=3.6e+07
 renorm[gemm] counter=17 total t=1.8e-04 per=4.7e+01 cost=3.7e+03 flops=2.1e+07
 renorm[red] counter=17 t=1.2e-04 per=3.2e+01 cost=2.0e+03 flops=1.7e+07
--- TIMING FOR renorm_tot : t_inter=2.2e-03 t_gemm=4.7e-02 t_reduction=9.7e-03 tot=5.9e-02 ---
 renorm_tot[inter] counter=17 t=2.2e-03 per=3.7e+00 cost=1.4e+06 flops=6.3e+08
 renorm_tot[gemm] counter=17 i=0 t=4.9e-05 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=1 t=3.9e-05 per=6.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=2 t=3.6e-02 per=6.0e+01 cost=1.7e+05 flops=4.8e+06
 renorm_tot[gemm] counter=17 i=3 t=5.7e-03 per=9.7e+00 cost=1.0e+06 flops=1.8e+08
 renorm_tot[gemm] counter=17 i=4 t=4.0e-05 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=5 t=3.8e-05 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=6 t=5.7e-03 per=9.6e+00 cost=2.0e+06 flops=3.5e+08
 renorm_tot[gemm] counter=17 total t=4.7e-02 per=8.0e+01 cost=3.2e+06 flops=6.7e+07
 renorm_tot[red] counter=17 t=9.7e-03 per=1.6e+01 cost=6.8e+05 flops=7.0e+07
qops.to_cpu: size(tot)=69:5.3e-04MB:5.1e-07GB t[to_cpu]=1.5e-05S speed=3.5e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.005 S rank=0 -----
##### local oper_env: 1.178e-02 S #####
 T(local oper_env: fetch) = 3.372e-03 S  per = 28.6  per(accum) = 28.6
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 28.6
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 28.6
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 28.6
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 28.6
 T(local oper_env: renrm) = 5.287e-03 S  per = 44.9  per(accum) = 73.5
 T(local oper_env: save ) = 3.120e-03 S  per = 26.5  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.287e-03 S  T(sum) = 5.287e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.034e-04 S  per = 1.96  per(accum) = 1.96
 T(local oper_env: qops init                    ) = 4.033e-04 S  per = 7.63  per(accum) = 9.58
 T(local oper_env: symbolic_formulae_renorm     ) = 2.410e-04 S  per = 4.56  per(accum) = 14.1
 T(local oper_env: allocate qops on gpu         ) = 9.142e-05 S  per = 1.73  per(accum) = 15.9
 T(local oper_env: site memcpy cpu2gpu          ) = 8.971e-05 S  per =  1.7  per(accum) = 17.6
 T(local oper_env: rintermediate init           ) = 4.439e-04 S  per =  8.4  per(accum) = 26
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.114e-03 S  per = 21.1  per(accum) = 47
 T(local oper_env: rmmtasks init                ) = 3.130e-04 S  per = 5.92  per(accum) = 53
 T(local oper_env: qops memset on cpu           ) = 6.800e-08 S  per = 0.00129  per(accum) = 53
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.126e-03 S  per = 40.2  per(accum) = 93.2
 T(local oper_env: reduction of opS & opH [nccl]) = 5.350e-07 S  per = 0.0101  per(accum) = 93.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.608e-05 S  per = 1.63  per(accum) = 94.8
 T(local oper_env: deallocate cpu and gpu memory) = 1.020e-05 S  per = 0.193  per(accum) = 95
 T(local oper_env: reduction of opS & opH [comm]) = 8.412e-05 S  per = 1.59  per(accum) = 96.6
 T(local oper_env: conversion from opAB to opPQ ) = 8.785e-05 S  per = 1.66  per(accum) = 98.2
 T(local oper_env: after oper_renorm            ) = 9.285e-05 S  per = 1.76  per(accum) = 100
##### sweep oper_env: 3.009e-01 S #####
 T(sweep oper_env: fetch) = 5.157e-02 S  per = 17.1  per(accum) = 17.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17.1
 T(sweep oper_env: renrm) = 1.874e-01 S  per = 62.3  per(accum) = 79.4
 T(sweep oper_env: save ) = 6.199e-02 S  per = 20.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.945e+10 S  per = -2.945e+32
 T(sweep oper_env: preprocess                  ) = -2.945e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.874e-01 S  T(sum) = 1.874e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.512e-03 S  per = 0.807  per(accum) = 0.807
 T(sweep oper_env: qops init                    ) = 9.909e-03 S  per = 5.29  per(accum) = 6.1
 T(sweep oper_env: symbolic_formulae_renorm     ) = 8.826e-03 S  per = 4.71  per(accum) = 10.8
 T(sweep oper_env: allocate qops on gpu         ) = 1.726e-03 S  per = 0.921  per(accum) = 11.7
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.601e-03 S  per = 0.855  per(accum) = 12.6
 T(sweep oper_env: rintermediate init           ) = 8.089e-03 S  per = 4.32  per(accum) = 16.9
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.983e-02 S  per = 21.3  per(accum) = 38.2
 T(sweep oper_env: rmmtasks init                ) = 1.222e-02 S  per = 6.52  per(accum) = 44.7
 T(sweep oper_env: qops memset on cpu           ) = 8.140e-07 S  per = 0.000434  per(accum) = 44.7
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 8.892e-02 S  per = 47.5  per(accum) = 92.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.020e-05 S  per = 0.00544  per(accum) = 92.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.694e-03 S  per = 0.904  per(accum) = 93
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.349e-04 S  per = 0.446  per(accum) = 93.5
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.525e-03 S  per = 0.814  per(accum) = 94.3
 T(sweep oper_env: conversion from opAB to opPQ ) = 8.624e-03 S  per =  4.6  per(accum) = 98.9
 T(sweep oper_env: after oper_renorm            ) = 2.050e-03 S  per = 1.09  per(accum) = 100

idx=18 coord=(1,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHPQ nops=C:18 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=69:0.000526MB:5.14e-07GB
ctns::oper_renorm coord=(1,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:19 S:1 H:1 P:1 Q:2 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=27:0.000206MB:2.01e-07GB
CPUmem: VM:7.242e+01GB RSS:5.571e-01GB  Timing: User:2.315e+00S Sys:1.077e+00S Total:3.392e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=24 : 9.611e-05 S -----
rank=0 GPUmem(GB): used=8.15e-06 (oper)=8.15e-06
rank=0 GPUmem(GB): used=8.2e-06 (oper,site)(GB)=8.15e-06,4.47e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=24
 no. of rintermediate operators=8
 no. of coefficients=144:0.0011MB:1.07e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.247e-04 S -----
rank=0 GPUmem(GB): used=9.27e-06 (oper,site,rinter)=8.15e-06,4.47e-08,1.07e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000119 S size(rtasks)=24 size(Rlst2)=36 T(Rmu/Rlist)=2.22e-05,9.7e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000195 S size(rtasks)=24 size(Rlst)=63 -----
rank=0 GPUmem(GB): used=9.27e-06 (oper,site,rinter,batch)=8.15e-06,4.47e-08,1.07e-06,1.41e-06 blksize=1 blksize0=0 batchsize=63
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=6.58e-06,0.000182,7.31e-05
--- TIMING FOR renorm : t_inter=6.5e-06 t_gemm=1.8e-04 t_reduction=7.3e-05 tot=2.6e-04 ---
 renorm[inter] counter=18 t=6.5e-06 per=2.5e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=0 t=3.1e-06 per=1.2e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=1 t=2.3e-06 per=8.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=2 t=6.9e-05 per=2.6e+01 cost=2.4e+01 flops=3.5e+05
 renorm[gemm] counter=18 i=3 t=5.3e-05 per=2.0e+01 cost=6.6e+01 flops=1.2e+06
 renorm[gemm] counter=18 i=4 t=2.3e-06 per=8.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=5 t=2.3e-06 per=8.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=6 t=5.0e-05 per=1.9e+01 cost=1.3e+02 flops=2.5e+06
 renorm[gemm] counter=18 total t=1.8e-04 per=7.0e+01 cost=2.2e+02 flops=1.2e+06
 renorm[red] counter=18 t=7.3e-05 per=2.8e+01 cost=1.3e+02 flops=1.7e+06
--- TIMING FOR renorm_tot : t_inter=2.2e-03 t_gemm=4.7e-02 t_reduction=9.8e-03 tot=5.9e-02 ---
 renorm_tot[inter] counter=18 t=2.2e-03 per=3.7e+00 cost=1.4e+06 flops=6.3e+08
 renorm_tot[gemm] counter=18 i=0 t=5.2e-05 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=1 t=4.1e-05 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=2 t=3.6e-02 per=6.0e+01 cost=1.7e+05 flops=4.7e+06
 renorm_tot[gemm] counter=18 i=3 t=5.8e-03 per=9.7e+00 cost=1.0e+06 flops=1.8e+08
 renorm_tot[gemm] counter=18 i=4 t=4.2e-05 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=5 t=4.0e-05 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=6 t=5.7e-03 per=9.6e+00 cost=2.0e+06 flops=3.4e+08
 renorm_tot[gemm] counter=18 total t=4.7e-02 per=8.0e+01 cost=3.2e+06 flops=6.7e+07
 renorm_tot[red] counter=18 t=9.8e-03 per=1.6e+01 cost=6.8e+05 flops=7.0e+07
qops.to_cpu: size(tot)=27:2.1e-04MB:2.0e-07GB t[to_cpu]=1.4e-05S speed=1.4e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0037 S rank=0 -----
##### local oper_env: 1.067e-02 S #####
 T(local oper_env: fetch) = 3.369e-03 S  per = 31.6  per(accum) = 31.6
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 31.6
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 31.6
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 31.6
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 31.6
 T(local oper_env: renrm) = 3.964e-03 S  per = 37.2  per(accum) = 68.8
 T(local oper_env: save ) = 3.333e-03 S  per = 31.2  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.964e-03 S  T(sum) = 3.964e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.028e-04 S  per = 2.59  per(accum) = 2.59
 T(local oper_env: qops init                    ) = 3.621e-04 S  per = 9.13  per(accum) = 11.7
 T(local oper_env: symbolic_formulae_renorm     ) = 1.725e-04 S  per = 4.35  per(accum) = 16.1
 T(local oper_env: allocate qops on gpu         ) = 9.162e-05 S  per = 2.31  per(accum) = 18.4
 T(local oper_env: site memcpy cpu2gpu          ) = 8.752e-05 S  per = 2.21  per(accum) = 20.6
 T(local oper_env: rintermediate init           ) = 4.742e-04 S  per =   12  per(accum) = 32.6
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.696e-04 S  per =  6.8  per(accum) = 39.4
 T(local oper_env: rmmtasks init                ) = 1.224e-04 S  per = 3.09  per(accum) = 42.4
 T(local oper_env: qops memset on cpu           ) = 4.700e-08 S  per = 0.00119  per(accum) = 42.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.936e-03 S  per = 48.8  per(accum) = 91.3
 T(local oper_env: reduction of opS & opH [nccl]) = 4.190e-07 S  per = 0.0106  per(accum) = 91.3
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.523e-05 S  per = 2.15  per(accum) = 93.5
 T(local oper_env: deallocate cpu and gpu memory) = 8.957e-06 S  per = 0.226  per(accum) = 93.7
 T(local oper_env: reduction of opS & opH [comm]) = 8.984e-05 S  per = 2.27  per(accum) = 95.9
 T(local oper_env: conversion from opAB to opPQ ) = 7.352e-05 S  per = 1.85  per(accum) = 97.8
 T(local oper_env: after oper_renorm            ) = 8.733e-05 S  per =  2.2  per(accum) = 100
##### sweep oper_env: 3.116e-01 S #####
 T(sweep oper_env: fetch) = 5.494e-02 S  per = 17.6  per(accum) = 17.6
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 17.6
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 17.6
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 17.6
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 17.6
 T(sweep oper_env: renrm) = 1.913e-01 S  per = 61.4  per(accum) = 79
 T(sweep oper_env: save ) = 6.533e-02 S  per =   21  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.118e+10 S  per = -3.118e+32
 T(sweep oper_env: preprocess                  ) = -3.118e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.913e-01 S  T(sum) = 1.913e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.615e-03 S  per = 0.844  per(accum) = 0.844
 T(sweep oper_env: qops init                    ) = 1.027e-02 S  per = 5.37  per(accum) = 6.21
 T(sweep oper_env: symbolic_formulae_renorm     ) = 8.998e-03 S  per =  4.7  per(accum) = 10.9
 T(sweep oper_env: allocate qops on gpu         ) = 1.817e-03 S  per = 0.95  per(accum) = 11.9
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.689e-03 S  per = 0.883  per(accum) = 12.7
 T(sweep oper_env: rintermediate init           ) = 8.564e-03 S  per = 4.48  per(accum) = 17.2
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.010e-02 S  per =   21  per(accum) = 38.2
 T(sweep oper_env: rmmtasks init                ) = 1.235e-02 S  per = 6.45  per(accum) = 44.6
 T(sweep oper_env: qops memset on cpu           ) = 8.610e-07 S  per = 0.00045  per(accum) = 44.6
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 9.086e-02 S  per = 47.5  per(accum) = 92.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.062e-05 S  per = 0.00555  per(accum) = 92.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.779e-03 S  per = 0.93  per(accum) = 93.1
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.438e-04 S  per = 0.441  per(accum) = 93.5
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.615e-03 S  per = 0.844  per(accum) = 94.3
 T(sweep oper_env: conversion from opAB to opPQ ) = 8.697e-03 S  per = 4.55  per(accum) = 98.9
 T(sweep oper_env: after oper_renorm            ) = 2.137e-03 S  per = 1.12  per(accum) = 100

idx=19 coord=(0,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHPQ nops=C:19 S:1 H:1 P:1 Q:2 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=27:0.000206MB:2.01e-07GB
ctns::oper_renorm coord=(0,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:20 S:0 H:1 P:0 Q:0 
        dim(bra,ket)=6,6 size(op)=6:4.58e-05MB size(tot)=6:4.58e-05MB:4.47e-08GB
CPUmem: VM:7.242e+01GB RSS:5.571e-01GB  Timing: User:2.320e+00S Sys:1.077e+00S Total:3.396e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=21 : 3.794e-05 S -----
rank=0 GPUmem(GB): used=7.68e-06 (oper)=7.68e-06
rank=0 GPUmem(GB): used=7.73e-06 (oper,site)(GB)=7.68e-06,4.47e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=21
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=7.73e-06 (oper,site,rinter)=7.68e-06,4.47e-08,0
----- TIMING FOR preprocess_formulae_Rlist2 : 8.61e-05 S size(rtasks)=21 size(Rlst2)=36 T(Rmu/Rlist)=1.81e-05,6.8e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000164 S size(rtasks)=21 size(Rlst)=36 -----
rank=0 GPUmem(GB): used=7.73e-06 (oper,site,rinter,batch)=7.68e-06,4.47e-08,0,8.05e-07 blksize=1 blksize0=0 batchsize=36
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=6.81e-06,0.00017,5.31e-05
--- TIMING FOR renorm : t_inter=6.7e-06 t_gemm=1.7e-04 t_reduction=5.3e-05 tot=2.3e-04 ---
 renorm[inter] counter=19 t=6.7e-06 per=2.9e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=0 t=3.0e-06 per=1.3e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=1 t=2.3e-06 per=1.0e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=2 t=6.2e-05 per=2.7e+01 cost=2.4e+01 flops=3.9e+05
 renorm[gemm] counter=19 i=3 t=4.7e-05 per=2.0e+01 cost=2.4e+01 flops=5.1e+05
 renorm[gemm] counter=19 i=4 t=2.3e-06 per=9.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=5 t=2.2e-06 per=9.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=6 t=5.1e-05 per=2.2e+01 cost=7.2e+01 flops=1.4e+06
 renorm[gemm] counter=19 total t=1.7e-04 per=7.4e+01 cost=1.2e+02 flops=7.1e+05
 renorm[red] counter=19 t=5.3e-05 per=2.3e+01 cost=7.2e+01 flops=1.4e+06
--- TIMING FOR renorm_tot : t_inter=2.2e-03 t_gemm=4.8e-02 t_reduction=9.8e-03 tot=6.0e-02 ---
 renorm_tot[inter] counter=19 t=2.2e-03 per=3.7e+00 cost=1.4e+06 flops=6.3e+08
 renorm_tot[gemm] counter=19 i=0 t=5.5e-05 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=1 t=4.3e-05 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=2 t=3.6e-02 per=6.0e+01 cost=1.7e+05 flops=4.7e+06
 renorm_tot[gemm] counter=19 i=3 t=5.8e-03 per=9.7e+00 cost=1.0e+06 flops=1.8e+08
 renorm_tot[gemm] counter=19 i=4 t=4.4e-05 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=5 t=4.2e-05 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=6 t=5.8e-03 per=9.7e+00 cost=2.0e+06 flops=3.4e+08
 renorm_tot[gemm] counter=19 total t=4.8e-02 per=8.0e+01 cost=3.2e+06 flops=6.6e+07
 renorm_tot[red] counter=19 t=9.8e-03 per=1.6e+01 cost=6.8e+05 flops=7.0e+07
qops.to_cpu: size(tot)=6:4.6e-05MB:4.5e-08GB t[to_cpu]=1.4e-05S speed=3.2e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
ctns::oper_ab2pq coord=(0,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00351 S rank=0 -----
##### local oper_env: 1.026e-02 S #####
 T(local oper_env: fetch) = 2.960e-03 S  per = 28.8  per(accum) = 28.8
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 28.8
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 28.8
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 28.8
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 28.8
 T(local oper_env: renrm) = 3.769e-03 S  per = 36.7  per(accum) = 65.6
 T(local oper_env: save ) = 3.531e-03 S  per = 34.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.769e-03 S  T(sum) = 3.769e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.069e-04 S  per = 2.84  per(accum) = 2.84
 T(local oper_env: qops init                    ) = 3.443e-04 S  per = 9.14  per(accum) = 12
 T(local oper_env: symbolic_formulae_renorm     ) = 1.117e-04 S  per = 2.97  per(accum) = 14.9
 T(local oper_env: allocate qops on gpu         ) = 8.702e-05 S  per = 2.31  per(accum) = 17.2
 T(local oper_env: site memcpy cpu2gpu          ) = 9.429e-05 S  per =  2.5  per(accum) = 19.7
 T(local oper_env: rintermediate init           ) = 3.770e-04 S  per =   10  per(accum) = 29.8
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.373e-04 S  per =  6.3  per(accum) = 36
 T(local oper_env: rmmtasks init                ) = 1.188e-04 S  per = 3.15  per(accum) = 39.2
 T(local oper_env: qops memset on cpu           ) = 3.800e-08 S  per = 0.00101  per(accum) = 39.2
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.958e-03 S  per = 51.9  per(accum) = 91.1
 T(local oper_env: reduction of opS & opH [nccl]) = 4.590e-07 S  per = 0.0122  per(accum) = 91.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.735e-05 S  per = 2.32  per(accum) = 93.5
 T(local oper_env: deallocate cpu and gpu memory) = 9.059e-06 S  per = 0.24  per(accum) = 93.7
 T(local oper_env: reduction of opS & opH [comm]) = 8.535e-05 S  per = 2.26  per(accum) = 96
 T(local oper_env: conversion from opAB to opPQ ) = 7.344e-05 S  per = 1.95  per(accum) = 97.9
 T(local oper_env: after oper_renorm            ) = 7.813e-05 S  per = 2.07  per(accum) = 100
##### sweep oper_env: 3.219e-01 S #####
 T(sweep oper_env: fetch) = 5.790e-02 S  per =   18  per(accum) = 18
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 18
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 18
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 18
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 18
 T(sweep oper_env: renrm) = 1.951e-01 S  per = 60.6  per(accum) = 78.6
 T(sweep oper_env: save ) = 6.886e-02 S  per = 21.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.291e+10 S  per = -3.291e+32
 T(sweep oper_env: preprocess                  ) = -3.291e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.951e-01 S  T(sum) = 1.951e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.722e-03 S  per = 0.882  per(accum) = 0.882
 T(sweep oper_env: qops init                    ) = 1.061e-02 S  per = 5.44  per(accum) = 6.32
 T(sweep oper_env: symbolic_formulae_renorm     ) = 9.110e-03 S  per = 4.67  per(accum) = 11
 T(sweep oper_env: allocate qops on gpu         ) = 1.904e-03 S  per = 0.976  per(accum) = 12
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.783e-03 S  per = 0.914  per(accum) = 12.9
 T(sweep oper_env: rintermediate init           ) = 8.941e-03 S  per = 4.58  per(accum) = 17.5
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.034e-02 S  per = 20.7  per(accum) = 38.1
 T(sweep oper_env: rmmtasks init                ) = 1.247e-02 S  per = 6.39  per(accum) = 44.5
 T(sweep oper_env: qops memset on cpu           ) = 8.990e-07 S  per = 0.000461  per(accum) = 44.5
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 9.281e-02 S  per = 47.6  per(accum) = 92.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.108e-05 S  per = 0.00568  per(accum) = 92.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.866e-03 S  per = 0.957  per(accum) = 93.1
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.529e-04 S  per = 0.437  per(accum) = 93.5
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.700e-03 S  per = 0.871  per(accum) = 94.4
 T(sweep oper_env: conversion from opAB to opPQ ) = 8.771e-03 S  per =  4.5  per(accum) = 98.9
 T(sweep oper_env: after oper_renorm            ) = 2.215e-03 S  per = 1.14  per(accum) = 100
----- TIMING FOR ctns::oper_env_right : 5.235e-01 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.0984,0.0579,0.195,0.0689,0.42
ctns::oper_load iomode=0 fname=./scratch/sweep/rop(0,0)
fname=./scratch/sweep/rop(0,0) size=4.47e-08GB T[load](info/setup/data/tot)=0.000533,7.25e-05,0.000507,0.00111 speed=4.02e-05GB/S
matrix: Hij size=(1,1)
     -1.161471167558e+02 
matrix: Sij size=(1,1)
      1.000000000000e+00 

ctns::sweep_opt maxsweep=1

ctns::oper_init_dotL isym=3 ifkr=1 singlet=0
ctns::oper_save iomode=0 fname=./scratch/sweep/lop(0,0) size=0.00761413574219MB:7.43567943573e-06GB
fname=./scratch/sweep/lop(0,0) size=7.44e-06GB T[save](info/data/tot)=0.00121,0.00118,0.00239 speed=0.00311GB/S disk[used]=0.000621GB
----- TIMING FOR ctns::oper_init_dotL : 8.169e-03 S -----

ctns::topology::get_sweeps ifboundary=0
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(3,0)-(4,0) forward=1 cturn=0
 ibond=3 bond=(4,0)-(5,0) forward=1 cturn=0
 ibond=4 bond=(5,0)-(6,0) forward=1 cturn=0
 ibond=5 bond=(6,0)-(7,0) forward=1 cturn=0
 ibond=6 bond=(7,0)-(8,0) forward=1 cturn=0
 ibond=7 bond=(8,0)-(9,0) forward=1 cturn=0
 ibond=8 bond=(9,0)-(10,0) forward=1 cturn=0
 ibond=9 bond=(10,0)-(11,0) forward=1 cturn=0
 ibond=10 bond=(11,0)-(12,0) forward=1 cturn=0
 ibond=11 bond=(12,0)-(13,0) forward=1 cturn=0
 ibond=12 bond=(13,0)-(14,0) forward=1 cturn=0
 ibond=13 bond=(14,0)-(15,0) forward=1 cturn=0
 ibond=14 bond=(15,0)-(16,0) forward=1 cturn=0
 ibond=15 bond=(16,0)-(17,0) forward=1 cturn=0
 ibond=16 bond=(17,0)-(18,0) forward=1 cturn=0
 ibond=17 bond=(17,0)-(18,0) forward=0 cturn=0
 ibond=18 bond=(16,0)-(17,0) forward=0 cturn=0
 ibond=19 bond=(15,0)-(16,0) forward=0 cturn=0
 ibond=20 bond=(14,0)-(15,0) forward=0 cturn=0
 ibond=21 bond=(13,0)-(14,0) forward=0 cturn=0
 ibond=22 bond=(12,0)-(13,0) forward=0 cturn=0
 ibond=23 bond=(11,0)-(12,0) forward=0 cturn=0
 ibond=24 bond=(10,0)-(11,0) forward=0 cturn=0
 ibond=25 bond=(9,0)-(10,0) forward=0 cturn=0
 ibond=26 bond=(8,0)-(9,0) forward=0 cturn=0
 ibond=27 bond=(7,0)-(8,0) forward=0 cturn=0
 ibond=28 bond=(6,0)-(7,0) forward=0 cturn=0
 ibond=29 bond=(5,0)-(6,0) forward=0 cturn=0
 ibond=30 bond=(4,0)-(5,0) forward=0 cturn=0
 ibond=31 bond=(3,0)-(4,0) forward=0 cturn=0
 ibond=32 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=33 bond=(1,0)-(2,0) forward=0 cturn=0
..... end of get_sweeps .....

======================================================================
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=1 sym_state=(30,0) singlet=0
qtensor3: site0new own=1 _data=0x55a31ea23700
qinfo3su2: site0new sym=(0,0) dir=1,0,1 couple=0
 qbond: qrow nsym=1 dimAll=1
 (0,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=3 nblocks=9 size=3:2.29e-05MB
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=938:0.00716MB:6.99e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=940:0.00717MB:7e-06GB

isweep=0 ibond=0/seqsize=34 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.242e+01GB RSS:5.571e-01GB  Timing: User:2.327e+00S Sys:1.077e+00S Total:3.403e+00S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=938:7.156e-03MB:6.989e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1:7.629e-06MB:7.451e-09GB
total mem of comb=940:7.172e-03MB:7.004e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,17,1,1
 suppl= 0
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 rqops: oplist=CSHPQ nops=C:17 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=11,11 size(op)=28:2.136e-04MB size(tot)=445:3.395e-03MB:3.316e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=3439:2.624e-02MB:2.562e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
wf4(diml,dimr,dimc1,dimc2)=(3,11,3,3) nnz=4:3.052e-05MB
qtensor4: wf4 own=1 _data=0x55a3227d6c30
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qcol nsym=11 dimAll=11
 (24,0):1 (24,2):1 (24,4):1 (24,6):1 (24,8):1 (24,10):1 (25,1):1 (25,3):1 (25,5):1 (25,7):1 (25,9):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=4 nblocks=430 size=4:3.052e-05MB
### DIAG TIMING: total=8.634e-04 t1=8.391e-06, t2=9.862e-06, t3=4.459e-04, t4=3.682e-04, t5=4.537e-06, t6=2.242e-05, t7=3.965e-06
duration_diagGPU:9.656e-04
duration_diagreduce:5.900e-08
duration_diagtransform:1.310e-07
----- TIMING FOR symbolic_formulae_twodot with size=228 : 3.547e-04 S -----
rank=0 GPUmem(GB): used=2.56e-05 (oper)=2.56e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=228
 no. of hintermediate operators=22
 no. of coefficients=374:0.00285MB:2.79e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.179e-04 S -----
rank=0 GPUmem(GB): used=2.84e-05 (oper,hinter)=2.56e-05,2.79e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.000686 S size(H_formulae)=228 size(Hxlst2)=4 T(Hmu/Hxlist)=8.32e-05,0.000602 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.000769 S size(H_formulae)=228 size(Hxlst)=304 -----
rank=0 GPUmem(GB): used=3.75e-05 (oper,hinter,dvdson,batch)=2.56e-05,2.79e-06,5.96e-08,9.06e-06 blksize=1 blksize0=1 batchsize=304
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=4 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.48e-05,7.2e-05,0.000214,0.00498,0.00531
 ndim=4:2.98e-08GB t[comm(intra)]=2.41e-05 speed=0.00248GB/S t[comm(inter)]=1.07e-05 speed=0.00557GB/S
--- TIMING FOR sigma : t_inter=7.2e-05 t_gemm=2.1e-04 t_reduction=5.0e-03 tot=5.3e-03 ---
 sigma[inter] counter=1 t=7.2e-05 per=1.4e+00 cost=4.1e+02 flops=5.7e+06
 sigma[gemm] counter=1 i=0 t=2.8e-06 per=5.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=1 t=2.2e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=2 t=2.2e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=3 t=2.2e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=4 t=5.6e-05 per=1.1e+00 cost=2.4e+02 flops=4.2e+06
 sigma[gemm] counter=1 i=5 t=5.1e-05 per=9.6e-01 cost=2.4e+02 flops=4.7e+06
 sigma[gemm] counter=1 i=6 t=4.9e-05 per=9.2e-01 cost=1.7e+02 flops=3.4e+06
 sigma[gemm] counter=1 i=7 t=4.9e-05 per=9.3e-01 cost=1.7e+02 flops=3.4e+06
 sigma[gemm] counter=1 total t=2.1e-04 per=4.1e+00 cost=8.1e+02 flops=3.8e+06
 sigma[red] counter=1 t=5.0e-03 per=9.5e+01 cost=6.1e+02 flops=1.2e+05
--- TIMING FOR sigma_tot : t_inter=7.2e-05 t_gemm=2.1e-04 t_reduction=5.0e-03 tot=5.3e-03 ---
 sigma_tot[inter] counter=1 t=7.2e-05 per=1.4e+00 cost=4.1e+02 flops=5.7e+06
 sigma_tot[gemm] counter=1 i=0 t=2.8e-06 per=5.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=1 t=2.2e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=2 t=2.2e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=3 t=2.2e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=4 t=5.6e-05 per=1.1e+00 cost=2.4e+02 flops=4.2e+06
 sigma_tot[gemm] counter=1 i=5 t=5.1e-05 per=9.6e-01 cost=2.4e+02 flops=4.7e+06
 sigma_tot[gemm] counter=1 i=6 t=4.9e-05 per=9.2e-01 cost=1.7e+02 flops=3.4e+06
 sigma_tot[gemm] counter=1 i=7 t=4.9e-05 per=9.3e-01 cost=1.7e+02 flops=3.4e+06
 sigma_tot[gemm] counter=1 total t=2.1e-04 per=4.1e+00 cost=8.1e+02 flops=3.8e+06
 sigma_tot[red] counter=1 t=5.0e-03 per=9.5e+01 cost=6.1e+02 flops=1.2e+05
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,5.1e-06,1.1e-06,1.5e-06,2.5e-07
settings: ndim=4 neig=1 maxcycle=30 nbuff=4 memory=4e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.147116755810 -1.116e+03  5.974e-02    1     1  7.642e-03 7.642e-03 7.475e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.748e-05,5.955e-05,2.035e-04,1.676e-04,4.641e-04
 ndim=4:2.980e-08GB t[comm(intra)]=2.242e-05 speed=2.659e-03GB/S t[comm(inter)]=5.062e-06 speed=1.177e-02GB/S
--- TIMING FOR sigma : t_inter=5.9e-05 t_gemm=2.0e-04 t_reduction=1.7e-04 tot=4.3e-04 ---
 sigma[inter] counter=2 t=5.9e-05 per=1.4e+01 cost=4.1e+02 flops=6.9e+06
 sigma[gemm] counter=2 i=0 t=2.7e-06 per=6.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=1 t=2.3e-06 per=5.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=2 t=2.2e-06 per=5.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=3 t=2.2e-06 per=5.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=4 t=5.4e-05 per=1.2e+01 cost=2.4e+02 flops=4.4e+06
 sigma[gemm] counter=2 i=5 t=4.8e-05 per=1.1e+01 cost=2.4e+02 flops=5.0e+06
 sigma[gemm] counter=2 i=6 t=4.7e-05 per=1.1e+01 cost=1.7e+02 flops=3.5e+06
 sigma[gemm] counter=2 i=7 t=4.5e-05 per=1.1e+01 cost=1.7e+02 flops=3.7e+06
 sigma[gemm] counter=2 total t=2.0e-04 per=4.7e+01 cost=8.1e+02 flops=4.0e+06
 sigma[red] counter=2 t=1.7e-04 per=3.9e+01 cost=6.1e+02 flops=3.6e+06
--- TIMING FOR sigma_tot : t_inter=1.3e-04 t_gemm=4.2e-04 t_reduction=5.2e-03 tot=5.7e-03 ---
 sigma_tot[inter] counter=2 t=1.3e-04 per=2.3e+00 cost=8.2e+02 flops=6.2e+06
 sigma_tot[gemm] counter=2 i=0 t=5.5e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=1 t=4.5e-06 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=2 t=4.5e-06 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=3 t=4.4e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=4 t=1.1e-04 per=1.9e+00 cost=4.8e+02 flops=4.3e+06
 sigma_tot[gemm] counter=2 i=5 t=9.8e-05 per=1.7e+00 cost=4.8e+02 flops=4.8e+06
 sigma_tot[gemm] counter=2 i=6 t=9.5e-05 per=1.7e+00 cost=3.3e+02 flops=3.5e+06
 sigma_tot[gemm] counter=2 i=7 t=9.4e-05 per=1.7e+00 cost=3.3e+02 flops=3.5e+06
 sigma_tot[gemm] counter=2 total t=4.2e-04 per=7.3e+00 cost=1.6e+03 flops=3.9e+06
 sigma_tot[red] counter=2 t=5.2e-03 per=9.0e+01 cost=1.2e+03 flops=2.4e+05
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=8.5e-06,2.0e-05,2.0e-06,1.3e-06,1.2e-07
    2   0 -    -116.177424126215 -3.031e-02  3.883e-03    2     2  1.062e-02 5.311e-03 4.949e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.646e-05,5.180e-05,1.940e-04,1.490e-04,4.253e-04
 ndim=4:2.980e-08GB t[comm(intra)]=2.188e-05 speed=2.725e-03GB/S t[comm(inter)]=4.581e-06 speed=1.301e-02GB/S
--- TIMING FOR sigma : t_inter=5.2e-05 t_gemm=1.9e-04 t_reduction=1.5e-04 tot=3.9e-04 ---
 sigma[inter] counter=3 t=5.2e-05 per=1.3e+01 cost=4.1e+02 flops=7.9e+06
 sigma[gemm] counter=3 i=0 t=2.4e-06 per=6.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=1 t=2.3e-06 per=5.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=2 t=2.2e-06 per=5.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=3 t=2.2e-06 per=5.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=4 t=4.8e-05 per=1.2e+01 cost=2.4e+02 flops=5.0e+06
 sigma[gemm] counter=3 i=5 t=4.6e-05 per=1.2e+01 cost=2.4e+02 flops=5.2e+06
 sigma[gemm] counter=3 i=6 t=4.6e-05 per=1.2e+01 cost=1.7e+02 flops=3.6e+06
 sigma[gemm] counter=3 i=7 t=4.5e-05 per=1.2e+01 cost=1.7e+02 flops=3.7e+06
 sigma[gemm] counter=3 total t=1.9e-04 per=4.9e+01 cost=8.1e+02 flops=4.2e+06
 sigma[red] counter=3 t=1.5e-04 per=3.8e+01 cost=6.1e+02 flops=4.1e+06
--- TIMING FOR sigma_tot : t_inter=1.8e-04 t_gemm=6.1e-04 t_reduction=5.3e-03 tot=6.1e-03 ---
 sigma_tot[inter] counter=3 t=1.8e-04 per=3.0e+00 cost=1.2e+03 flops=6.7e+06
 sigma_tot[gemm] counter=3 i=0 t=7.9e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=1 t=6.8e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=2 t=6.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=3 t=6.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=4 t=1.6e-04 per=2.6e+00 cost=7.1e+02 flops=4.5e+06
 sigma_tot[gemm] counter=3 i=5 t=1.4e-04 per=2.4e+00 cost=7.1e+02 flops=5.0e+06
 sigma_tot[gemm] counter=3 i=6 t=1.4e-04 per=2.3e+00 cost=5.0e+02 flops=3.5e+06
 sigma_tot[gemm] counter=3 i=7 t=1.4e-04 per=2.3e+00 cost=5.0e+02 flops=3.6e+06
 sigma_tot[gemm] counter=3 total t=6.1e-04 per=1.0e+01 cost=2.4e+03 flops=4.0e+06
 sigma_tot[red] counter=3 t=5.3e-03 per=8.7e+01 cost=1.8e+03 flops=3.4e+05
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,1.4e-05,1.5e-06,7.4e-07,1.3e-07
    3   0 +    -116.177526452453 -1.023e-04  2.607e-06    3     3  1.309e-02 4.362e-03 4.060e-03
TIMING FOR Davidson : 1.316e-02  T(cal/comm/rest)=1.218e-02,1.590e-07,9.835e-04
decomposed t_rest=9.835e-04
 T(sub)    =6.209e-05 per=6.313e+00
 T(precond)=1.635e-04 per=1.663e+01
 T(ortho)  =5.324e-06 per=5.413e-01
 T(xcopy)  =4.330e-07 per=4.403e-02
 T(xnrm2)  =3.640e-07 per=3.701e-02
 T(other)  =7.517e-04 per=7.644e+01
optimized energies: isweep=0 ibond=0 dots=2 e[0]=-116.177526452453 nmvp=3
CPUmem: VM:7.242e+01GB RSS:5.575e-01GB  Timing: User:2.559e+00S Sys:1.080e+00S Total:3.640e+00S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=6 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond0.txt
 qbond: qsuper nsym=6 dimAll=10
 (0,0):1 (2,0):3 (1,1):2 (4,0):1 (3,1):2 (2,2):1
----- TMING FOR decimation_genbasis(su2): 3.3e-05 S -----
decimation summary: 10->2 dwt=+1.110e-16 SvN=5.084e-01
 qbond: qkept nsym=2 dimAll=2
 (4,0):1 (3,1):1
----- TIMING for decimation_row(nkr): 2.315e-03 S T(decim/select/formRot)=3.211e-04,1.853e-03,1.411e-04 -----
----- TIMING FOR twodot_decimation: 2.536e-03 S T(wf/decim)=1.423e-04,2.393e-03 -----
ctns::oper_renorm coord=(1,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:2 S:18 H:1 A:4 B:6 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=31:2.365e-04MB:2.310e-07GB
CPUmem: VM:7.242e+01GB RSS:5.575e-01GB  Timing: User:2.811e+00S Sys:1.080e+00S Total:3.891e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=31 : 1.302e-04 S -----
rank=0 GPUmem(GB): used=2.53e-05 (oper)=1.51e-05
rank=0 GPUmem(GB): used=2.53e-05 (oper,site)(GB)=1.51e-05,2.24e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=31
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=2.53e-05 (oper,site,rinter)=1.51e-05,2.24e-08,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000212 S size(rtasks)=31 size(Rlst2)=4 T(Rmu/Rlist)=7.17e-05,0.00014 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000297 S size(rtasks)=31 size(Rlst)=106 -----
rank=0 GPUmem(GB): used=2.53e-05 (oper,site,rinter,batch)=1.51e-05,2.24e-08,0,2.37e-06 blksize=1 blksize0=0 batchsize=106
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.21e-06,0.000193,0.000104
--- TIMING FOR renorm : t_inter=8.1e-06 t_gemm=1.9e-04 t_reduction=1.0e-04 tot=3.0e-04 ---
 renorm[inter] counter=1 t=8.1e-06 per=2.7e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=3.0e-06 per=9.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=2.3e-06 per=7.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=2.2e-06 per=7.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=3 t=2.2e-06 per=7.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=4 t=7.6e-05 per=2.5e+01 cost=8.8e+01 flops=1.2e+06
 renorm[gemm] counter=1 i=5 t=5.5e-05 per=1.8e+01 cost=6.6e+01 flops=1.2e+06
 renorm[gemm] counter=1 i=6 t=5.2e-05 per=1.7e+01 cost=2.1e+02 flops=4.1e+06
 renorm[gemm] counter=1 total t=1.9e-04 per=6.3e+01 cost=3.7e+02 flops=1.9e+06
 renorm[red] counter=1 t=1.0e-04 per=3.4e+01 cost=2.1e+02 flops=2.0e+06
--- TIMING FOR renorm_tot : t_inter=8.1e-06 t_gemm=1.9e-04 t_reduction=1.0e-04 tot=3.0e-04 ---
 renorm_tot[inter] counter=1 t=8.1e-06 per=2.7e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=3.0e-06 per=9.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=2.3e-06 per=7.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=2.2e-06 per=7.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=3 t=2.2e-06 per=7.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=4 t=7.6e-05 per=2.5e+01 cost=8.8e+01 flops=1.2e+06
 renorm_tot[gemm] counter=1 i=5 t=5.5e-05 per=1.8e+01 cost=6.6e+01 flops=1.2e+06
 renorm_tot[gemm] counter=1 i=6 t=5.2e-05 per=1.7e+01 cost=2.1e+02 flops=4.1e+06
 renorm_tot[gemm] counter=1 total t=1.9e-04 per=6.3e+01 cost=3.7e+02 flops=1.9e+06
 renorm_tot[red] counter=1 t=1.0e-04 per=3.4e+01 cost=2.1e+02 flops=2.0e+06
qops.to_cpu: size(tot)=31:2.4e-04MB:2.3e-07GB t[to_cpu]=1.5e-05S speed=1.6e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00368 S rank=0 -----
CPUmem: VM:7.242e+01GB RSS:5.575e-01GB  Timing: User:2.971e+00S Sys:1.123e+00S Total:4.094e+00S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=935:7.133e-03MB:6.966e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=3:2.289e-05MB:2.235e-08GB
total mem of comb=939:7.164e-03MB:6.996e-06GB
CPUmem: VM:7.242e+01GB RSS:5.575e-01GB  Timing: User:2.972e+00S Sys:1.124e+00S Total:4.096e+00S
##### local opt: 4.195e-02 S #####
 T(local opt: fetch) = 1.144e-02 S  per = 27.3  per(accum) = 27.3
 T(local opt: hdiag) = 1.891e-03 S  per = 4.51  per(accum) = 31.8
 T(local opt: dvdsn) = 1.686e-02 S  per = 40.2  per(accum) = 72
 T(local opt: decim) = 2.629e-03 S  per = 6.27  per(accum) = 78.2
 T(local opt: guess) = 1.029e-04 S  per = 0.245  per(accum) = 78.5
 T(local opt: renrm) = 4.664e-03 S  per = 11.1  per(accum) = 89.6
 T(local opt: save ) = 4.371e-03 S  per = 10.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.686e-02 S  T(sum) = 1.610e-02 S  per = 9.547e+01
 T(local opt: preprocess                  ) = 7.212e-04 S  per = 4.48  per(accum) = 4.48
 T(local opt: symbolic_formulae           ) = 4.395e-04 S  per = 2.73  per(accum) = 7.21
 T(local opt: hintermediate init          ) = 5.443e-04 S  per = 3.38  per(accum) = 10.6
 T(local opt: preprocess_hformulae_Hxlist ) = 8.530e-04 S  per =  5.3  per(accum) = 15.9
 T(local opt: hmmtasks init               ) = 1.740e-04 S  per = 1.08  per(accum) = 17
 T(local opt: initial guess for dvdson    ) = 2.027e-04 S  per = 1.26  per(accum) = 18.2
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.209e-02 S  per = 75.1  per(accum) = 93.3
 T(local opt: dvdson solver [comm(gpu)]   ) = 8.869e-05 S  per = 0.551  per(accum) = 93.9
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.590e-07 S  per = 0.000988  per(accum) = 93.9
 T(local opt: dvdson solver [rest part]   ) = 9.835e-04 S  per = 6.11  per(accum) = 100
Detailed decomposition of T(renrm) = 4.664e-03 S  T(sum) = 4.664e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.026e-04 S  per =  2.2  per(accum) = 2.2
 T(local opt: qops init                    ) = 2.921e-04 S  per = 6.26  per(accum) = 8.46
 T(local opt: symbolic_formulae_renorm     ) = 2.065e-04 S  per = 4.43  per(accum) = 12.9
 T(local opt: allocate qops on gpu         ) = 9.743e-05 S  per = 2.09  per(accum) = 15
 T(local opt: site memcpy cpu2gpu          ) = 8.164e-05 S  per = 1.75  per(accum) = 16.7
 T(local opt: rintermediate init           ) = 3.514e-04 S  per = 7.53  per(accum) = 24.3
 T(local opt: preprocess_formulae_Rlist2   ) = 3.691e-04 S  per = 7.91  per(accum) = 32.2
 T(local opt: rmmtasks init                ) = 1.390e-04 S  per = 2.98  per(accum) = 35.2
 T(local opt: qops memset on cpu           ) = 3.700e-08 S  per = 0.000793  per(accum) = 35.2
 T(local opt: preprocess_renorm_batchGPU   ) = 1.972e-03 S  per = 42.3  per(accum) = 77.4
 T(local opt: reduction of opS & opH [nccl]) = 5.170e-07 S  per = 0.0111  per(accum) = 77.5
 T(local opt: qops memcpy gpu2cpu          ) = 8.617e-05 S  per = 1.85  per(accum) = 79.3
 T(local opt: deallocate cpu and gpu memory) = 9.175e-06 S  per = 0.197  per(accum) = 79.5
 T(local opt: reduction of opS & opH [comm]) = 7.692e-05 S  per = 1.65  per(accum) = 81.2
 T(local opt: conversion from opAB to opPQ ) = 7.521e-05 S  per = 1.61  per(accum) = 82.8
 T(local opt: after oper_renorm            ) = 8.039e-04 S  per = 17.2  per(accum) = 100
##### sweep opt: 4.195e-02 S #####
 T(sweep opt: fetch) = 1.144e-02 S  per = 27.3  per(accum) = 27.3
 T(sweep opt: hdiag) = 1.891e-03 S  per = 4.51  per(accum) = 31.8
 T(sweep opt: dvdsn) = 1.686e-02 S  per = 40.2  per(accum) = 72
 T(sweep opt: decim) = 2.629e-03 S  per = 6.27  per(accum) = 78.2
 T(sweep opt: guess) = 1.029e-04 S  per = 0.245  per(accum) = 78.5
 T(sweep opt: renrm) = 4.664e-03 S  per = 11.1  per(accum) = 89.6
 T(sweep opt: save ) = 4.371e-03 S  per = 10.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.686e-02 S  T(sum) = 1.610e-02 S  per = 9.547e+01
 T(sweep opt: preprocess                  ) = 7.212e-04 S  per = 4.48  per(accum) = 4.48
 T(sweep opt: symbolic_formulae           ) = 4.395e-04 S  per = 2.73  per(accum) = 7.21
 T(sweep opt: hintermediate init          ) = 5.443e-04 S  per = 3.38  per(accum) = 10.6
 T(sweep opt: preprocess_hformulae_Hxlist ) = 8.530e-04 S  per =  5.3  per(accum) = 15.9
 T(sweep opt: hmmtasks init               ) = 1.740e-04 S  per = 1.08  per(accum) = 17
 T(sweep opt: initial guess for dvdson    ) = 2.027e-04 S  per = 1.26  per(accum) = 18.2
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.209e-02 S  per = 75.1  per(accum) = 93.3
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 8.869e-05 S  per = 0.551  per(accum) = 93.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.590e-07 S  per = 0.000988  per(accum) = 93.9
 T(sweep opt: dvdson solver [rest part]   ) = 9.835e-04 S  per = 6.11  per(accum) = 100
Detailed decomposition of T(renrm) = 4.664e-03 S  T(sum) = 4.664e-03 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.026e-04 S  per =  2.2  per(accum) = 2.2
 T(sweep opt: qops init                    ) = 2.921e-04 S  per = 6.26  per(accum) = 8.46
 T(sweep opt: symbolic_formulae_renorm     ) = 2.065e-04 S  per = 4.43  per(accum) = 12.9
 T(sweep opt: allocate qops on gpu         ) = 9.743e-05 S  per = 2.09  per(accum) = 15
 T(sweep opt: site memcpy cpu2gpu          ) = 8.164e-05 S  per = 1.75  per(accum) = 16.7
 T(sweep opt: rintermediate init           ) = 3.514e-04 S  per = 7.53  per(accum) = 24.3
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.691e-04 S  per = 7.91  per(accum) = 32.2
 T(sweep opt: rmmtasks init                ) = 1.390e-04 S  per = 2.98  per(accum) = 35.2
 T(sweep opt: qops memset on cpu           ) = 3.700e-08 S  per = 0.000793  per(accum) = 35.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.972e-03 S  per = 42.3  per(accum) = 77.4
 T(sweep opt: reduction of opS & opH [nccl]) = 5.170e-07 S  per = 0.0111  per(accum) = 77.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 8.617e-05 S  per = 1.85  per(accum) = 79.3
 T(sweep opt: deallocate cpu and gpu memory) = 9.175e-06 S  per = 0.197  per(accum) = 79.5
 T(sweep opt: reduction of opS & opH [comm]) = 7.692e-05 S  per = 1.65  per(accum) = 81.2
 T(sweep opt: conversion from opAB to opPQ ) = 7.521e-05 S  per = 1.61  per(accum) = 82.8
 T(sweep opt: after oper_renorm            ) = 8.039e-04 S  per = 17.2  per(accum) = 100
##### global opt: 4.195e-02 S #####
 T(global opt: fetch) = 1.144e-02 S  per = 27.3  per(accum) = 27.3
 T(global opt: hdiag) = 1.891e-03 S  per = 4.51  per(accum) = 31.8
 T(global opt: dvdsn) = 1.686e-02 S  per = 40.2  per(accum) = 72
 T(global opt: decim) = 2.629e-03 S  per = 6.27  per(accum) = 78.2
 T(global opt: guess) = 1.029e-04 S  per = 0.245  per(accum) = 78.5
 T(global opt: renrm) = 4.664e-03 S  per = 11.1  per(accum) = 89.6
 T(global opt: save ) = 4.371e-03 S  per = 10.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.686e-02 S  T(sum) = 1.610e-02 S  per = 9.547e+01
 T(global opt: preprocess                  ) = 7.212e-04 S  per = 4.48  per(accum) = 4.48
 T(global opt: symbolic_formulae           ) = 4.395e-04 S  per = 2.73  per(accum) = 7.21
 T(global opt: hintermediate init          ) = 5.443e-04 S  per = 3.38  per(accum) = 10.6
 T(global opt: preprocess_hformulae_Hxlist ) = 8.530e-04 S  per =  5.3  per(accum) = 15.9
 T(global opt: hmmtasks init               ) = 1.740e-04 S  per = 1.08  per(accum) = 17
 T(global opt: initial guess for dvdson    ) = 2.027e-04 S  per = 1.26  per(accum) = 18.2
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.209e-02 S  per = 75.1  per(accum) = 93.3
 T(global opt: dvdson solver [comm(gpu)]   ) = 8.869e-05 S  per = 0.551  per(accum) = 93.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.590e-07 S  per = 0.000988  per(accum) = 93.9
 T(global opt: dvdson solver [rest part]   ) = 9.835e-04 S  per = 6.11  per(accum) = 100
Detailed decomposition of T(renrm) = 4.664e-03 S  T(sum) = 4.664e-03 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.026e-04 S  per =  2.2  per(accum) = 2.2
 T(global opt: qops init                    ) = 2.921e-04 S  per = 6.26  per(accum) = 8.46
 T(global opt: symbolic_formulae_renorm     ) = 2.065e-04 S  per = 4.43  per(accum) = 12.9
 T(global opt: allocate qops on gpu         ) = 9.743e-05 S  per = 2.09  per(accum) = 15
 T(global opt: site memcpy cpu2gpu          ) = 8.164e-05 S  per = 1.75  per(accum) = 16.7
 T(global opt: rintermediate init           ) = 3.514e-04 S  per = 7.53  per(accum) = 24.3
 T(global opt: preprocess_formulae_Rlist2   ) = 3.691e-04 S  per = 7.91  per(accum) = 32.2
 T(global opt: rmmtasks init                ) = 1.390e-04 S  per = 2.98  per(accum) = 35.2
 T(global opt: qops memset on cpu           ) = 3.700e-08 S  per = 0.000793  per(accum) = 35.2
 T(global opt: preprocess_renorm_batchGPU   ) = 1.972e-03 S  per = 42.3  per(accum) = 77.4
 T(global opt: reduction of opS & opH [nccl]) = 5.170e-07 S  per = 0.0111  per(accum) = 77.5
 T(global opt: qops memcpy gpu2cpu          ) = 8.617e-05 S  per = 1.85  per(accum) = 79.3
 T(global opt: deallocate cpu and gpu memory) = 9.175e-06 S  per = 0.197  per(accum) = 79.5
 T(global opt: reduction of opS & opH [comm]) = 7.692e-05 S  per = 1.65  per(accum) = 81.2
 T(global opt: conversion from opAB to opPQ ) = 7.521e-05 S  per = 1.61  per(accum) = 82.8
 T(global opt: after oper_renorm            ) = 8.039e-04 S  per = 17.2  per(accum) = 100

isweep=0 ibond=1/seqsize=34 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.242e+01GB RSS:5.575e-01GB  Timing: User:2.973e+00S Sys:1.124e+00S Total:4.097e+00S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=935:7.133e-03MB:6.966e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=3:2.289e-05MB:2.235e-08GB
total mem of comb=939:7.164e-03MB:6.996e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,16,1,1
 suppl= 0 1
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:2 S:18 H:1 A:4 B:6 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=31:2.365e-04MB:2.310e-07GB
 rqops: oplist=CSHPQ nops=C:16 S:4 H:1 P:16 Q:20 
        dim(bra,ket)=14,14 size(op)=62:4.730e-04MB size(tot)=1204:9.186e-03MB:8.970e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=3231:2.465e-02MB:2.407e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
wf4(diml,dimr,dimc1,dimc2)=(2,14,3,3) nnz=9:6.866e-05MB
qtensor4: wf4 own=1 _data=0x55a31eb0b240
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=2 dimAll=2
 (4,0):1 (3,1):1
 qbond: qcol nsym=9 dimAll=14
 (23,1):2 (23,3):2 (23,5):2 (23,7):2 (23,9):2 (24,2):1 (24,4):1 (24,6):1 (24,8):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=6 nblocks=252 size=9:6.866e-05MB
### DIAG TIMING: total=6.517e-04 t1=8.880e-06, t2=1.093e-05, t3=1.702e-05, t4=5.881e-04, t5=4.371e-06, t6=1.813e-05, t7=4.265e-06
duration_diagGPU:7.470e-04
duration_diagreduce:3.000e-08
duration_diagtransform:1.230e-07
----- TIMING FOR symbolic_formulae_twodot with size=321 : 5.060e-04 S -----
rank=0 GPUmem(GB): used=2.41e-05 (oper)=2.41e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=321
 no. of hintermediate operators=183
 no. of coefficients=1044:0.00797MB:7.78e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.401e-04 S -----
rank=0 GPUmem(GB): used=3.19e-05 (oper,hinter)=2.41e-05,7.78e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00175 S size(H_formulae)=321 size(Hxlst2)=6 T(Hmu/Hxlist)=0.0001,0.00165 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00187 S size(H_formulae)=321 size(Hxlst)=906 -----
rank=0 GPUmem(GB): used=7.92e-05 (oper,hinter,dvdson,batch)=2.41e-05,7.78e-06,1.34e-07,4.73e-05 blksize=2 blksize0=2 batchsize=906
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=9 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.06e-05,0.000113,0.000324,0.000279,0.000754
 ndim=9:6.71e-08GB t[comm(intra)]=2.37e-05 speed=0.00566GB/S t[comm(inter)]=6.93e-06 speed=0.0194GB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=3.2e-04 t_reduction=2.8e-04 tot=7.2e-04 ---
 sigma[inter] counter=4 t=1.1e-04 per=1.6e+01 cost=7.3e+03 flops=6.5e+07
 sigma[gemm] counter=4 i=0 t=2.8e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=1 t=2.2e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=2 t=2.2e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=3 t=2.2e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=4 t=1.0e-04 per=1.4e+01 cost=1.5e+03 flops=1.5e+07
 sigma[gemm] counter=4 i=5 t=8.9e-05 per=1.2e+01 cost=1.5e+03 flops=1.7e+07
 sigma[gemm] counter=4 i=6 t=6.4e-05 per=9.0e+00 cost=9.3e+02 flops=1.5e+07
 sigma[gemm] counter=4 i=7 t=5.9e-05 per=8.2e+00 cost=9.9e+02 flops=1.7e+07
 sigma[gemm] counter=4 total t=3.2e-04 per=4.5e+01 cost=4.9e+03 flops=1.5e+07
 sigma[red] counter=4 t=2.8e-04 per=3.9e+01 cost=2.7e+03 flops=9.6e+06
--- TIMING FOR sigma_tot : t_inter=3.0e-04 t_gemm=9.3e-04 t_reduction=5.6e-03 tot=6.8e-03 ---
 sigma_tot[inter] counter=4 t=3.0e-04 per=4.4e+00 cost=8.5e+03 flops=2.9e+07
 sigma_tot[gemm] counter=4 i=0 t=1.1e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=1 t=9.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=2 t=8.9e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=3 t=8.8e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=4 t=2.6e-04 per=3.8e+00 cost=2.2e+03 flops=8.5e+06
 sigma_tot[gemm] counter=4 i=5 t=2.3e-04 per=3.4e+00 cost=2.2e+03 flops=9.5e+06
 sigma_tot[gemm] counter=4 i=6 t=2.1e-04 per=3.0e+00 cost=1.4e+03 flops=7.0e+06
 sigma_tot[gemm] counter=4 i=7 t=2.0e-04 per=2.9e+00 cost=1.5e+03 flops=7.5e+06
 sigma_tot[gemm] counter=4 total t=9.3e-04 per=1.4e+01 cost=7.4e+03 flops=7.9e+06
 sigma_tot[red] counter=4 t=5.6e-03 per=8.2e+01 cost=4.5e+03 flops=8.1e+05
T(sub)=7.3e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,2.8e-06,9.6e-07,7.7e-07,1.9e-07
settings: ndim=9 neig=1 maxcycle=30 nbuff=4 memory=1e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.177526452453 -1.116e+03  6.213e-02    1     1  2.937e-03 2.937e-03 2.767e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.744e-05,7.878e-05,2.536e-04,2.260e-04,5.905e-04
 ndim=9:6.706e-08GB t[comm(intra)]=2.220e-05 speed=6.040e-03GB/S t[comm(inter)]=5.233e-06 speed=2.563e-02GB/S
--- TIMING FOR sigma : t_inter=7.9e-05 t_gemm=2.5e-04 t_reduction=2.3e-04 tot=5.6e-04 ---
 sigma[inter] counter=5 t=7.9e-05 per=1.4e+01 cost=7.3e+03 flops=9.3e+07
 sigma[gemm] counter=5 i=0 t=2.7e-06 per=4.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=1 t=2.2e-06 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=2 t=2.2e-06 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=3 t=2.2e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=4 t=7.4e-05 per=1.3e+01 cost=1.5e+03 flops=2.0e+07
 sigma[gemm] counter=5 i=5 t=6.4e-05 per=1.2e+01 cost=1.5e+03 flops=2.3e+07
 sigma[gemm] counter=5 i=6 t=5.2e-05 per=9.4e+00 cost=9.3e+02 flops=1.8e+07
 sigma[gemm] counter=5 i=7 t=5.3e-05 per=9.5e+00 cost=9.9e+02 flops=1.9e+07
 sigma[gemm] counter=5 total t=2.5e-04 per=4.5e+01 cost=4.9e+03 flops=1.9e+07
 sigma[red] counter=5 t=2.3e-04 per=4.0e+01 cost=2.7e+03 flops=1.2e+07
--- TIMING FOR sigma_tot : t_inter=3.8e-04 t_gemm=1.2e-03 t_reduction=5.8e-03 tot=7.4e-03 ---
 sigma_tot[inter] counter=5 t=3.8e-04 per=5.1e+00 cost=1.6e+04 flops=4.2e+07
 sigma_tot[gemm] counter=5 i=0 t=1.3e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=1 t=1.1e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=2 t=1.1e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=3 t=1.1e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=4 t=3.3e-04 per=4.5e+00 cost=3.7e+03 flops=1.1e+07
 sigma_tot[gemm] counter=5 i=5 t=3.0e-04 per=4.0e+00 cost=3.7e+03 flops=1.2e+07
 sigma_tot[gemm] counter=5 i=6 t=2.6e-04 per=3.5e+00 cost=2.4e+03 flops=9.2e+06
 sigma_tot[gemm] counter=5 i=7 t=2.5e-04 per=3.4e+00 cost=2.5e+03 flops=9.9e+06
 sigma_tot[gemm] counter=5 total t=1.2e-03 per=1.6e+01 cost=1.2e+04 flops=1.0e+07
 sigma_tot[red] counter=5 t=5.8e-03 per=7.9e+01 cost=7.2e+03 flops=1.2e+06
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,9.2e-06,2.3e-06,9.1e-07,1.8e-07
    2   0 -    -116.199122515660 -2.160e-02  1.974e-02    2     2  5.951e-03 2.975e-03 2.644e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.737e-05,7.401e-05,2.414e-04,2.264e-04,5.738e-04
 ndim=9:6.706e-08GB t[comm(intra)]=2.248e-05 speed=5.964e-03GB/S t[comm(inter)]=4.889e-06 speed=2.743e-02GB/S
--- TIMING FOR sigma : t_inter=7.4e-05 t_gemm=2.4e-04 t_reduction=2.3e-04 tot=5.4e-04 ---
 sigma[inter] counter=6 t=7.4e-05 per=1.4e+01 cost=7.3e+03 flops=9.9e+07
 sigma[gemm] counter=6 i=0 t=2.4e-06 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=1 t=2.3e-06 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=2 t=2.3e-06 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=3 t=2.2e-06 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=4 t=6.4e-05 per=1.2e+01 cost=1.5e+03 flops=2.3e+07
 sigma[gemm] counter=6 i=5 t=6.4e-05 per=1.2e+01 cost=1.5e+03 flops=2.4e+07
 sigma[gemm] counter=6 i=6 t=5.2e-05 per=9.7e+00 cost=9.3e+02 flops=1.8e+07
 sigma[gemm] counter=6 i=7 t=5.1e-05 per=9.5e+00 cost=9.9e+02 flops=1.9e+07
 sigma[gemm] counter=6 total t=2.4e-04 per=4.5e+01 cost=4.9e+03 flops=2.0e+07
 sigma[red] counter=6 t=2.3e-04 per=4.2e+01 cost=2.7e+03 flops=1.2e+07
--- TIMING FOR sigma_tot : t_inter=4.5e-04 t_gemm=1.4e-03 t_reduction=6.0e-03 tot=7.9e-03 ---
 sigma_tot[inter] counter=6 t=4.5e-04 per=5.7e+00 cost=2.3e+04 flops=5.2e+07
 sigma_tot[gemm] counter=6 i=0 t=1.6e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=1 t=1.4e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=2 t=1.3e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=3 t=1.3e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=4 t=4.0e-04 per=5.0e+00 cost=5.2e+03 flops=1.3e+07
 sigma_tot[gemm] counter=6 i=5 t=3.6e-04 per=4.6e+00 cost=5.2e+03 flops=1.4e+07
 sigma_tot[gemm] counter=6 i=6 t=3.1e-04 per=3.9e+00 cost=3.3e+03 flops=1.1e+07
 sigma_tot[gemm] counter=6 i=7 t=3.0e-04 per=3.8e+00 cost=3.5e+03 flops=1.1e+07
 sigma_tot[gemm] counter=6 total t=1.4e-03 per=1.8e+01 cost=1.7e+04 flops=1.2e+07
 sigma_tot[red] counter=6 t=6.0e-03 per=7.6e+01 cost=9.9e+03 flops=1.6e+06
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,1.2e-05,1.5e-06,8.9e-07,1.3e-07
    3   0 -    -116.200256352489 -1.134e-03  3.227e-03    3     3  8.688e-03 2.896e-03 2.610e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.649e-05,7.227e-05,2.420e-04,2.216e-04,5.661e-04
 ndim=9:6.706e-08GB t[comm(intra)]=2.184e-05 speed=6.142e-03GB/S t[comm(inter)]=4.657e-06 speed=2.880e-02GB/S
--- TIMING FOR sigma : t_inter=7.2e-05 t_gemm=2.4e-04 t_reduction=2.2e-04 tot=5.4e-04 ---
 sigma[inter] counter=7 t=7.2e-05 per=1.3e+01 cost=7.3e+03 flops=1.0e+08
 sigma[gemm] counter=7 i=0 t=2.4e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=1 t=2.2e-06 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=2 t=2.3e-06 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=3 t=2.2e-06 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=4 t=6.5e-05 per=1.2e+01 cost=1.5e+03 flops=2.3e+07
 sigma[gemm] counter=7 i=5 t=6.5e-05 per=1.2e+01 cost=1.5e+03 flops=2.3e+07
 sigma[gemm] counter=7 i=6 t=5.2e-05 per=9.7e+00 cost=9.3e+02 flops=1.8e+07
 sigma[gemm] counter=7 i=7 t=5.1e-05 per=9.6e+00 cost=9.9e+02 flops=1.9e+07
 sigma[gemm] counter=7 total t=2.4e-04 per=4.5e+01 cost=4.9e+03 flops=2.0e+07
 sigma[red] counter=7 t=2.2e-04 per=4.1e+01 cost=2.7e+03 flops=1.2e+07
--- TIMING FOR sigma_tot : t_inter=5.2e-04 t_gemm=1.7e-03 t_reduction=6.3e-03 tot=8.4e-03 ---
 sigma_tot[inter] counter=7 t=5.2e-04 per=6.2e+00 cost=3.0e+04 flops=5.8e+07
 sigma_tot[gemm] counter=7 i=0 t=1.8e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=1 t=1.6e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=2 t=1.6e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=3 t=1.5e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=4 t=4.6e-04 per=5.5e+00 cost=6.7e+03 flops=1.5e+07
 sigma_tot[gemm] counter=7 i=5 t=4.3e-04 per=5.0e+00 cost=6.7e+03 flops=1.6e+07
 sigma_tot[gemm] counter=7 i=6 t=3.6e-04 per=4.3e+00 cost=4.2e+03 flops=1.2e+07
 sigma_tot[gemm] counter=7 i=7 t=3.5e-04 per=4.2e+00 cost=4.5e+03 flops=1.3e+07
 sigma_tot[gemm] counter=7 total t=1.7e-03 per=2.0e+01 cost=2.2e+04 flops=1.3e+07
 sigma_tot[red] counter=7 t=6.3e-03 per=7.4e+01 cost=1.3e+04 flops=2.0e+06
T(sub)=1.4e-05 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,8.9e-06,1.5e-06,7.5e-07,1.1e-07
    4   0 -    -116.200293375986 -3.702e-05  6.151e-04    3     4  1.140e-02 2.851e-03 2.592e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.625e-05,7.013e-05,2.516e-04,2.178e-04,5.694e-04
 ndim=9:6.706e-08GB t[comm(intra)]=2.160e-05 speed=6.208e-03GB/S t[comm(inter)]=4.643e-06 speed=2.888e-02GB/S
--- TIMING FOR sigma : t_inter=7.0e-05 t_gemm=2.5e-04 t_reduction=2.2e-04 tot=5.4e-04 ---
 sigma[inter] counter=8 t=7.0e-05 per=1.3e+01 cost=7.3e+03 flops=1.0e+08
 sigma[gemm] counter=8 i=0 t=2.4e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=1 t=2.3e-06 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=2 t=2.3e-06 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=3 t=2.2e-06 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=4 t=6.4e-05 per=1.2e+01 cost=1.5e+03 flops=2.4e+07
 sigma[gemm] counter=8 i=5 t=6.8e-05 per=1.3e+01 cost=1.5e+03 flops=2.2e+07
 sigma[gemm] counter=8 i=6 t=5.1e-05 per=9.5e+00 cost=9.3e+02 flops=1.8e+07
 sigma[gemm] counter=8 i=7 t=6.0e-05 per=1.1e+01 cost=9.9e+02 flops=1.7e+07
 sigma[gemm] counter=8 total t=2.5e-04 per=4.7e+01 cost=4.9e+03 flops=2.0e+07
 sigma[red] counter=8 t=2.2e-04 per=4.0e+01 cost=2.7e+03 flops=1.2e+07
--- TIMING FOR sigma_tot : t_inter=5.9e-04 t_gemm=1.9e-03 t_reduction=6.5e-03 tot=9.0e-03 ---
 sigma_tot[inter] counter=8 t=5.9e-04 per=6.6e+00 cost=3.8e+04 flops=6.4e+07
 sigma_tot[gemm] counter=8 i=0 t=2.1e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=1 t=1.8e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=2 t=1.8e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=3 t=1.8e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=4 t=5.3e-04 per=5.9e+00 cost=8.2e+03 flops=1.6e+07
 sigma_tot[gemm] counter=8 i=5 t=4.9e-04 per=5.5e+00 cost=8.2e+03 flops=1.7e+07
 sigma_tot[gemm] counter=8 i=6 t=4.1e-04 per=4.6e+00 cost=5.2e+03 flops=1.3e+07
 sigma_tot[gemm] counter=8 i=7 t=4.1e-04 per=4.6e+00 cost=5.4e+03 flops=1.3e+07
 sigma_tot[gemm] counter=8 total t=1.9e-03 per=2.1e+01 cost=2.7e+04 flops=1.4e+07
 sigma_tot[red] counter=8 t=6.5e-03 per=7.2e+01 cost=1.5e+04 flops=2.4e+06
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,1.0e-05,1.5e-06,8.2e-07,1.2e-07
    5   0 -    -116.200295015218 -1.639e-06  1.722e-04    3     5  1.413e-02 2.827e-03 2.584e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.683e-05,7.429e-05,2.421e-04,2.277e-04,5.755e-04
 ndim=9:6.706e-08GB t[comm(intra)]=2.193e-05 speed=6.116e-03GB/S t[comm(inter)]=4.900e-06 speed=2.737e-02GB/S
--- TIMING FOR sigma : t_inter=7.4e-05 t_gemm=2.4e-04 t_reduction=2.3e-04 tot=5.4e-04 ---
 sigma[inter] counter=9 t=7.4e-05 per=1.4e+01 cost=7.3e+03 flops=9.8e+07
 sigma[gemm] counter=9 i=0 t=2.7e-06 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=1 t=2.3e-06 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=2 t=2.2e-06 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=3 t=2.2e-06 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=4 t=6.5e-05 per=1.2e+01 cost=1.5e+03 flops=2.3e+07
 sigma[gemm] counter=9 i=5 t=6.2e-05 per=1.1e+01 cost=1.5e+03 flops=2.4e+07
 sigma[gemm] counter=9 i=6 t=5.3e-05 per=9.8e+00 cost=9.3e+02 flops=1.8e+07
 sigma[gemm] counter=9 i=7 t=5.2e-05 per=9.5e+00 cost=9.9e+02 flops=1.9e+07
 sigma[gemm] counter=9 total t=2.4e-04 per=4.4e+01 cost=4.9e+03 flops=2.0e+07
 sigma[red] counter=9 t=2.3e-04 per=4.2e+01 cost=2.7e+03 flops=1.2e+07
--- TIMING FOR sigma_tot : t_inter=6.7e-04 t_gemm=2.2e-03 t_reduction=6.7e-03 tot=9.5e-03 ---
 sigma_tot[inter] counter=9 t=6.7e-04 per=7.0e+00 cost=4.5e+04 flops=6.8e+07
 sigma_tot[gemm] counter=9 i=0 t=2.3e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=1 t=2.0e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=2 t=2.0e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=3 t=2.0e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=4 t=5.9e-04 per=6.2e+00 cost=9.7e+03 flops=1.6e+07
 sigma_tot[gemm] counter=9 i=5 t=5.6e-04 per=5.8e+00 cost=9.7e+03 flops=1.8e+07
 sigma_tot[gemm] counter=9 i=6 t=4.7e-04 per=4.9e+00 cost=6.1e+03 flops=1.3e+07
 sigma_tot[gemm] counter=9 i=7 t=4.7e-04 per=4.9e+00 cost=6.4e+03 flops=1.4e+07
 sigma_tot[gemm] counter=9 total t=2.2e-03 per=2.3e+01 cost=3.2e+04 flops=1.5e+07
 sigma_tot[red] counter=9 t=6.7e-03 per=7.0e+01 cost=1.8e+04 flops=2.7e+06
T(sub)=1.3e-05 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,8.4e-06,1.4e-06,8.0e-07,1.3e-07
    6   0 +    -116.200295182409 -1.672e-07  4.298e-05    3     6  1.674e-02 2.791e-03 2.560e-03
TIMING FOR Davidson : 1.681e-02  T(cal/comm/rest)=1.536e-02,2.990e-07,1.454e-03
decomposed t_rest=1.454e-03
 T(sub)    =8.351e-05 per=5.744e+00
 T(precond)=1.482e-04 per=1.019e+01
 T(ortho)  =1.640e-05 per=1.128e+00
 T(xcopy)  =6.780e-07 per=4.663e-02
 T(xnrm2)  =8.270e-07 per=5.688e-02
 T(other)  =1.204e-03 per=8.283e+01
optimized energies: isweep=0 ibond=1 dots=2 e[0]=-116.200295182409 nmvp=6
CPUmem: VM:7.242e+01GB RSS:5.575e-01GB  Timing: User:3.833e+00S Sys:1.125e+00S Total:4.958e+00S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=5 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond1.txt
 qbond: qsuper nsym=5 dimAll=7
 (4,0):2 (6,0):1 (5,1):2 (3,1):1 (4,2):1
----- TMING FOR decimation_genbasis(su2): 4.6e-05 S -----
decimation summary: 7->4 dwt=+0.000e+00 SvN=5.745e-01
 qbond: qkept nsym=3 dimAll=4
 (5,1):2 (6,0):1 (4,2):1
----- TIMING for decimation_row(nkr): 2.420e-03 S T(decim/select/formRot)=3.424e-04,1.920e-03,1.574e-04 -----
----- TIMING FOR twodot_decimation: 2.634e-03 S T(wf/decim)=1.290e-04,2.505e-03 -----
ctns::oper_renorm coord=(2,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:3 S:17 H:1 A:9 B:12 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=155:1.183e-03MB:1.155e-06GB
CPUmem: VM:7.242e+01GB RSS:5.575e-01GB  Timing: User:3.835e+00S Sys:1.125e+00S Total:4.960e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=42 : 1.989e-04 S -----
rank=0 GPUmem(GB): used=2.4e-05 (oper)=8.82e-06
rank=0 GPUmem(GB): used=2.41e-05 (oper,site)(GB)=8.82e-06,4.47e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=42
 no. of rintermediate operators=141
 no. of coefficients=372:0.00284MB:2.77e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.214e-04 S -----
rank=0 GPUmem(GB): used=2.69e-05 (oper,site,rinter)=8.82e-06,4.47e-08,2.77e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000351 S size(rtasks)=42 size(Rlst2)=9 T(Rmu/Rlist)=5.8e-05,0.000293 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000433 S size(rtasks)=42 size(Rlst)=299 -----
rank=0 GPUmem(GB): used=2.69e-05 (oper,site,rinter,batch)=8.82e-06,4.47e-08,2.77e-06,2.23e-05 blksize=4 blksize0=1 batchsize=299
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.86e-05,0.000224,0.000128
--- TIMING FOR renorm : t_inter=9.9e-05 t_gemm=2.2e-04 t_reduction=1.3e-04 tot=4.5e-04 ---
 renorm[inter] counter=2 t=9.9e-05 per=2.2e+01 cost=9.4e+02 flops=9.5e+06
 renorm[gemm] counter=2 i=0 t=2.8e-06 per=6.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=1 t=2.2e-06 per=5.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=2 t=2.2e-06 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=3 t=2.2e-06 per=4.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=4 t=6.8e-05 per=1.5e+01 cost=3.9e+02 flops=5.8e+06
 renorm[gemm] counter=2 i=5 t=6.3e-05 per=1.4e+01 cost=4.1e+02 flops=6.5e+06
 renorm[gemm] counter=2 i=6 t=8.3e-05 per=1.8e+01 cost=1.3e+03 flops=1.5e+07
 renorm[gemm] counter=2 total t=2.2e-04 per=5.0e+01 cost=2.1e+03 flops=9.3e+06
 renorm[red] counter=2 t=1.3e-04 per=2.8e+01 cost=1.3e+03 flops=1.0e+07
--- TIMING FOR renorm_tot : t_inter=1.1e-04 t_gemm=4.2e-04 t_reduction=2.3e-04 tot=7.5e-04 ---
 renorm_tot[inter] counter=2 t=1.1e-04 per=1.4e+01 cost=9.4e+02 flops=8.8e+06
 renorm_tot[gemm] counter=2 i=0 t=5.8e-06 per=7.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=1 t=4.6e-06 per=6.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=2 t=4.4e-06 per=5.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=3 t=4.4e-06 per=5.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=4 t=1.4e-04 per=1.9e+01 cost=4.8e+02 flops=3.3e+06
 renorm_tot[gemm] counter=2 i=5 t=1.2e-04 per=1.6e+01 cost=4.8e+02 flops=4.0e+06
 renorm_tot[gemm] counter=2 i=6 t=1.3e-04 per=1.8e+01 cost=1.5e+03 flops=1.1e+07
 renorm_tot[gemm] counter=2 total t=4.2e-04 per=5.5e+01 cost=2.4e+03 flops=5.9e+06
 renorm_tot[red] counter=2 t=2.3e-04 per=3.1e+01 cost=1.5e+03 flops=6.4e+06
qops.to_cpu: size(tot)=155:1.2e-03MB:1.2e-06GB t[to_cpu]=1.5e-05S speed=7.6e-02GB/S
check ||H-H.dagger||=7.536e-15 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0043 S rank=0 -----
CPUmem: VM:7.242e+01GB RSS:5.575e-01GB  Timing: User:4.189e+00S Sys:1.125e+00S Total:5.313e+00S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=925:7.057e-03MB:6.892e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=9:6.866e-05MB:6.706e-08GB
total mem of comb=935:7.133e-03MB:6.966e-06GB
CPUmem: VM:7.242e+01GB RSS:5.575e-01GB  Timing: User:4.190e+00S Sys:1.125e+00S Total:5.315e+00S
##### local opt: 4.186e-02 S #####
 T(local opt: fetch) = 6.245e-03 S  per = 14.9  per(accum) = 14.9
 T(local opt: hdiag) = 1.681e-03 S  per = 4.02  per(accum) = 18.9
 T(local opt: dvdsn) = 2.170e-02 S  per = 51.8  per(accum) = 70.8
 T(local opt: decim) = 2.721e-03 S  per =  6.5  per(accum) = 77.3
 T(local opt: guess) = 9.512e-05 S  per = 0.227  per(accum) = 77.5
 T(local opt: renrm) = 5.151e-03 S  per = 12.3  per(accum) = 89.8
 T(local opt: save ) = 4.265e-03 S  per = 10.2  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.170e-02 S  T(sum) = 2.094e-02 S  per = 9.651e+01
 T(local opt: preprocess                  ) = 5.204e-04 S  per = 2.48  per(accum) = 2.48
 T(local opt: symbolic_formulae           ) = 5.912e-04 S  per = 2.82  per(accum) = 5.31
 T(local opt: hintermediate init          ) = 5.656e-04 S  per =  2.7  per(accum) = 8.01
 T(local opt: preprocess_hformulae_Hxlist ) = 1.952e-03 S  per = 9.32  per(accum) = 17.3
 T(local opt: hmmtasks init               ) = 3.176e-04 S  per = 1.52  per(accum) = 18.8
 T(local opt: initial guess for dvdson    ) = 1.827e-04 S  per = 0.872  per(accum) = 19.7
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.520e-02 S  per = 72.6  per(accum) = 92.3
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.650e-04 S  per = 0.788  per(accum) = 93.1
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.990e-07 S  per = 0.00143  per(accum) = 93.1
 T(local opt: dvdson solver [rest part]   ) = 1.454e-03 S  per = 6.94  per(accum) = 100
Detailed decomposition of T(renrm) = 5.151e-03 S  T(sum) = 5.151e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.070e-04 S  per = 2.08  per(accum) = 2.08
 T(local opt: qops init                    ) = 3.114e-04 S  per = 6.05  per(accum) = 8.12
 T(local opt: symbolic_formulae_renorm     ) = 2.746e-04 S  per = 5.33  per(accum) = 13.5
 T(local opt: allocate qops on gpu         ) = 9.060e-05 S  per = 1.76  per(accum) = 15.2
 T(local opt: site memcpy cpu2gpu          ) = 8.602e-05 S  per = 1.67  per(accum) = 16.9
 T(local opt: rintermediate init           ) = 4.834e-04 S  per = 9.38  per(accum) = 26.3
 T(local opt: preprocess_formulae_Rlist2   ) = 5.102e-04 S  per =  9.9  per(accum) = 36.2
 T(local opt: rmmtasks init                ) = 1.855e-04 S  per =  3.6  per(accum) = 39.8
 T(local opt: qops memset on cpu           ) = 3.900e-08 S  per = 0.000757  per(accum) = 39.8
 T(local opt: preprocess_renorm_batchGPU   ) = 2.172e-03 S  per = 42.2  per(accum) = 81.9
 T(local opt: reduction of opS & opH [nccl]) = 4.910e-07 S  per = 0.00953  per(accum) = 82
 T(local opt: qops memcpy gpu2cpu          ) = 8.791e-05 S  per = 1.71  per(accum) = 83.7
 T(local opt: deallocate cpu and gpu memory) = 9.563e-06 S  per = 0.186  per(accum) = 83.8
 T(local opt: reduction of opS & opH [comm]) = 8.740e-05 S  per =  1.7  per(accum) = 85.5
 T(local opt: conversion from opAB to opPQ ) = 7.835e-05 S  per = 1.52  per(accum) = 87.1
 T(local opt: after oper_renorm            ) = 6.666e-04 S  per = 12.9  per(accum) = 100
##### sweep opt: 8.381e-02 S #####
 T(sweep opt: fetch) = 1.768e-02 S  per = 21.1  per(accum) = 21.1
 T(sweep opt: hdiag) = 3.572e-03 S  per = 4.26  per(accum) = 25.4
 T(sweep opt: dvdsn) = 3.856e-02 S  per =   46  per(accum) = 71.4
 T(sweep opt: decim) = 5.350e-03 S  per = 6.38  per(accum) = 77.7
 T(sweep opt: guess) = 1.980e-04 S  per = 0.236  per(accum) = 78
 T(sweep opt: renrm) = 9.815e-03 S  per = 11.7  per(accum) = 89.7
 T(sweep opt: save ) = 8.635e-03 S  per = 10.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.856e-02 S  T(sum) = 3.704e-02 S  per = 9.606e+01
 T(sweep opt: preprocess                  ) = 1.242e-03 S  per = 3.35  per(accum) = 3.35
 T(sweep opt: symbolic_formulae           ) = 1.031e-03 S  per = 2.78  per(accum) = 6.13
 T(sweep opt: hintermediate init          ) = 1.110e-03 S  per =    3  per(accum) = 9.13
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.805e-03 S  per = 7.57  per(accum) = 16.7
 T(sweep opt: hmmtasks init               ) = 4.916e-04 S  per = 1.33  per(accum) = 18
 T(sweep opt: initial guess for dvdson    ) = 3.854e-04 S  per = 1.04  per(accum) = 19.1
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 2.729e-02 S  per = 73.7  per(accum) = 92.7
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.537e-04 S  per = 0.685  per(accum) = 93.4
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 4.580e-07 S  per = 0.00124  per(accum) = 93.4
 T(sweep opt: dvdson solver [rest part]   ) = 2.437e-03 S  per = 6.58  per(accum) = 100
Detailed decomposition of T(renrm) = 9.815e-03 S  T(sum) = 9.815e-03 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.096e-04 S  per = 2.14  per(accum) = 2.14
 T(sweep opt: qops init                    ) = 6.036e-04 S  per = 6.15  per(accum) = 8.28
 T(sweep opt: symbolic_formulae_renorm     ) = 4.811e-04 S  per =  4.9  per(accum) = 13.2
 T(sweep opt: allocate qops on gpu         ) = 1.880e-04 S  per = 1.92  per(accum) = 15.1
 T(sweep opt: site memcpy cpu2gpu          ) = 1.677e-04 S  per = 1.71  per(accum) = 16.8
 T(sweep opt: rintermediate init           ) = 8.348e-04 S  per = 8.51  per(accum) = 25.3
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.792e-04 S  per = 8.96  per(accum) = 34.3
 T(sweep opt: rmmtasks init                ) = 3.245e-04 S  per = 3.31  per(accum) = 37.6
 T(sweep opt: qops memset on cpu           ) = 7.600e-08 S  per = 0.000774  per(accum) = 37.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.145e-03 S  per = 42.2  per(accum) = 79.8
 T(sweep opt: reduction of opS & opH [nccl]) = 1.008e-06 S  per = 0.0103  per(accum) = 79.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.741e-04 S  per = 1.77  per(accum) = 81.6
 T(sweep opt: deallocate cpu and gpu memory) = 1.874e-05 S  per = 0.191  per(accum) = 81.8
 T(sweep opt: reduction of opS & opH [comm]) = 1.643e-04 S  per = 1.67  per(accum) = 83.5
 T(sweep opt: conversion from opAB to opPQ ) = 1.536e-04 S  per = 1.56  per(accum) = 85
 T(sweep opt: after oper_renorm            ) = 1.471e-03 S  per =   15  per(accum) = 100
##### global opt: 8.381e-02 S #####
 T(global opt: fetch) = 1.768e-02 S  per = 21.1  per(accum) = 21.1
 T(global opt: hdiag) = 3.572e-03 S  per = 4.26  per(accum) = 25.4
 T(global opt: dvdsn) = 3.856e-02 S  per =   46  per(accum) = 71.4
 T(global opt: decim) = 5.350e-03 S  per = 6.38  per(accum) = 77.7
 T(global opt: guess) = 1.980e-04 S  per = 0.236  per(accum) = 78
 T(global opt: renrm) = 9.815e-03 S  per = 11.7  per(accum) = 89.7
 T(global opt: save ) = 8.635e-03 S  per = 10.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.856e-02 S  T(sum) = 3.704e-02 S  per = 9.606e+01
 T(global opt: preprocess                  ) = 1.242e-03 S  per = 3.35  per(accum) = 3.35
 T(global opt: symbolic_formulae           ) = 1.031e-03 S  per = 2.78  per(accum) = 6.13
 T(global opt: hintermediate init          ) = 1.110e-03 S  per =    3  per(accum) = 9.13
 T(global opt: preprocess_hformulae_Hxlist ) = 2.805e-03 S  per = 7.57  per(accum) = 16.7
 T(global opt: hmmtasks init               ) = 4.916e-04 S  per = 1.33  per(accum) = 18
 T(global opt: initial guess for dvdson    ) = 3.854e-04 S  per = 1.04  per(accum) = 19.1
 T(global opt: dvdson solver [Hx_batchGPU] ) = 2.729e-02 S  per = 73.7  per(accum) = 92.7
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.537e-04 S  per = 0.685  per(accum) = 93.4
 T(global opt: dvdson solver [comm(cpu)]   ) = 4.580e-07 S  per = 0.00124  per(accum) = 93.4
 T(global opt: dvdson solver [rest part]   ) = 2.437e-03 S  per = 6.58  per(accum) = 100
Detailed decomposition of T(renrm) = 9.815e-03 S  T(sum) = 9.815e-03 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.096e-04 S  per = 2.14  per(accum) = 2.14
 T(global opt: qops init                    ) = 6.036e-04 S  per = 6.15  per(accum) = 8.28
 T(global opt: symbolic_formulae_renorm     ) = 4.811e-04 S  per =  4.9  per(accum) = 13.2
 T(global opt: allocate qops on gpu         ) = 1.880e-04 S  per = 1.92  per(accum) = 15.1
 T(global opt: site memcpy cpu2gpu          ) = 1.677e-04 S  per = 1.71  per(accum) = 16.8
 T(global opt: rintermediate init           ) = 8.348e-04 S  per = 8.51  per(accum) = 25.3
 T(global opt: preprocess_formulae_Rlist2   ) = 8.792e-04 S  per = 8.96  per(accum) = 34.3
 T(global opt: rmmtasks init                ) = 3.245e-04 S  per = 3.31  per(accum) = 37.6
 T(global opt: qops memset on cpu           ) = 7.600e-08 S  per = 0.000774  per(accum) = 37.6
 T(global opt: preprocess_renorm_batchGPU   ) = 4.145e-03 S  per = 42.2  per(accum) = 79.8
 T(global opt: reduction of opS & opH [nccl]) = 1.008e-06 S  per = 0.0103  per(accum) = 79.8
 T(global opt: qops memcpy gpu2cpu          ) = 1.741e-04 S  per = 1.77  per(accum) = 81.6
 T(global opt: deallocate cpu and gpu memory) = 1.874e-05 S  per = 0.191  per(accum) = 81.8
 T(global opt: reduction of opS & opH [comm]) = 1.643e-04 S  per = 1.67  per(accum) = 83.5
 T(global opt: conversion from opAB to opPQ ) = 1.536e-04 S  per = 1.56  per(accum) = 85
 T(global opt: after oper_renorm            ) = 1.471e-03 S  per =   15  per(accum) = 100

isweep=0 ibond=2/seqsize=34 dots=2 dbond=(3,0)-(4,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.242e+01GB RSS:5.575e-01GB  Timing: User:4.191e+00S Sys:1.125e+00S Total:5.316e+00S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=925:7.057e-03MB:6.892e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=9:6.866e-05MB:6.706e-08GB
total mem of comb=935:7.133e-03MB:6.966e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=3,15,1,1
 suppl= 0 1 2
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 3
 suppc2= 4
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:3 S:17 H:1 A:9 B:12 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=155:1.183e-03MB:1.155e-06GB
 rqops: oplist=CSHPQ nops=C:15 S:5 H:1 P:25 Q:30 
        dim(bra,ket)=15,15 size(op)=97:7.401e-04MB size(tot)=2439:1.861e-02MB:1.817e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=4590:3.502e-02MB:3.420e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(3,0) fdel=./scratch/sweep/rop(4,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
wf4(diml,dimr,dimc1,dimc2)=(4,15,3,3) nnz=22:1.678e-04MB
qtensor4: wf4 own=1 _data=0x55a32269dfc0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=4
 (5,1):2 (6,0):1 (4,2):1
 qbond: qcol nsym=7 dimAll=15
 (22,2):3 (22,4):3 (22,6):3 (22,8):3 (23,3):1 (23,5):1 (23,7):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=7 nblocks=308 size=22:1.678e-04MB
### DIAG TIMING: total=1.071e-03 t1=1.048e-05, t2=1.152e-05, t3=1.788e-05, t4=1.004e-03, t5=4.360e-06, t6=1.810e-05, t7=4.014e-06
duration_diagGPU:1.166e-03
duration_diagreduce:2.800e-08
duration_diagtransform:1.430e-07
----- TIMING FOR symbolic_formulae_twodot with size=372 : 6.068e-04 S -----
rank=0 GPUmem(GB): used=3.42e-05 (oper)=3.42e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=372
 no. of hintermediate operators=217
 no. of coefficients=1722:0.0131MB:1.28e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.520e-04 S -----
rank=0 GPUmem(GB): used=4.7e-05 (oper,hinter)=3.42e-05,1.28e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00278 S size(H_formulae)=372 size(Hxlst2)=7 T(Hmu/Hxlist)=0.000126,0.00265 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0029 S size(H_formulae)=372 size(Hxlst)=1464 -----
rank=0 GPUmem(GB): used=0.000233 (oper,hinter,dvdson,batch)=3.42e-05,1.28e-05,3.28e-07,0.000185 blksize=6 blksize0=4 batchsize=1464
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=22 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.21e-05,0.000156,0.000641,0.000341,0.00118
 ndim=22:1.64e-07GB t[comm(intra)]=2.5e-05 speed=0.0131GB/S t[comm(inter)]=7.09e-06 speed=0.0463GB/S
--- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=6.4e-04 t_reduction=3.4e-04 tot=1.1e-03 ---
 sigma[inter] counter=10 t=1.6e-04 per=1.4e+01 cost=2.7e+04 flops=1.7e+08
 sigma[gemm] counter=10 i=0 t=2.7e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=1 t=2.3e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=2 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=3 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=4 t=1.3e-04 per=1.2e+01 cost=6.1e+03 flops=4.6e+07
 sigma[gemm] counter=10 i=5 t=1.5e-04 per=1.3e+01 cost=6.3e+03 flops=4.3e+07
 sigma[gemm] counter=10 i=6 t=2.2e-04 per=1.9e+01 cost=5.4e+03 flops=2.4e+07
 sigma[gemm] counter=10 i=7 t=1.3e-04 per=1.1e+01 cost=5.9e+03 flops=4.6e+07
 sigma[gemm] counter=10 total t=6.4e-04 per=5.6e+01 cost=2.4e+04 flops=3.7e+07
 sigma[red] counter=10 t=3.4e-04 per=3.0e+01 cost=9.1e+03 flops=2.7e+07
--- TIMING FOR sigma_tot : t_inter=8.2e-04 t_gemm=2.8e-03 t_reduction=7.0e-03 tot=1.1e-02 ---
 sigma_tot[inter] counter=10 t=8.2e-04 per=7.7e+00 cost=7.2e+04 flops=8.8e+07
 sigma_tot[gemm] counter=10 i=0 t=2.6e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=1 t=2.3e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=2 t=2.2e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=3 t=2.2e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=4 t=7.3e-04 per=6.8e+00 cost=1.6e+04 flops=2.2e+07
 sigma_tot[gemm] counter=10 i=5 t=7.0e-04 per=6.6e+00 cost=1.6e+04 flops=2.3e+07
 sigma_tot[gemm] counter=10 i=6 t=6.9e-04 per=6.4e+00 cost=1.1e+04 flops=1.7e+07
 sigma_tot[gemm] counter=10 i=7 t=5.9e-04 per=5.6e+00 cost=1.2e+04 flops=2.1e+07
 sigma_tot[gemm] counter=10 total t=2.8e-03 per=2.6e+01 cost=5.6e+04 flops=2.0e+07
 sigma_tot[red] counter=10 t=7.0e-03 per=6.6e+01 cost=2.7e+04 flops=3.8e+06
T(sub)=7.6e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,2.8e-06,1.1e-06,7.5e-07,2.1e-07
settings: ndim=22 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.200295182409 -1.116e+03  6.222e-02    1     1  3.310e-03 3.310e-03 3.143e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.767e-05,9.984e-05,3.838e-04,2.663e-04,7.821e-04
 ndim=22:1.639e-07GB t[comm(intra)]=2.253e-05 speed=1.455e-02GB/S t[comm(inter)]=5.147e-06 speed=6.369e-02GB/S
--- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=3.8e-04 t_reduction=2.7e-04 tot=7.5e-04 ---
 sigma[inter] counter=11 t=1.0e-04 per=1.3e+01 cost=2.7e+04 flops=2.7e+08
 sigma[gemm] counter=11 i=0 t=2.3e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=1 t=2.2e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=2 t=2.2e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=3 t=2.2e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=4 t=9.9e-05 per=1.3e+01 cost=6.1e+03 flops=6.2e+07
 sigma[gemm] counter=11 i=5 t=9.6e-05 per=1.3e+01 cost=6.3e+03 flops=6.6e+07
 sigma[gemm] counter=11 i=6 t=9.1e-05 per=1.2e+01 cost=5.4e+03 flops=5.9e+07
 sigma[gemm] counter=11 i=7 t=8.9e-05 per=1.2e+01 cost=5.9e+03 flops=6.6e+07
 sigma[gemm] counter=11 total t=3.8e-04 per=5.1e+01 cost=2.4e+04 flops=6.2e+07
 sigma[red] counter=11 t=2.7e-04 per=3.6e+01 cost=9.1e+03 flops=3.4e+07
--- TIMING FOR sigma_tot : t_inter=9.2e-04 t_gemm=3.2e-03 t_reduction=7.3e-03 tot=1.1e-02 ---
 sigma_tot[inter] counter=11 t=9.2e-04 per=8.1e+00 cost=9.9e+04 flops=1.1e+08
 sigma_tot[gemm] counter=11 i=0 t=2.8e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=1 t=2.5e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=2 t=2.5e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=3 t=2.4e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=4 t=8.2e-04 per=7.2e+00 cost=2.2e+04 flops=2.7e+07
 sigma_tot[gemm] counter=11 i=5 t=8.0e-04 per=7.0e+00 cost=2.2e+04 flops=2.8e+07
 sigma_tot[gemm] counter=11 i=6 t=7.8e-04 per=6.8e+00 cost=1.7e+04 flops=2.2e+07
 sigma_tot[gemm] counter=11 i=7 t=6.8e-04 per=6.0e+00 cost=1.8e+04 flops=2.7e+07
 sigma_tot[gemm] counter=11 total t=3.2e-03 per=2.8e+01 cost=7.9e+04 flops=2.5e+07
 sigma_tot[red] counter=11 t=7.3e-03 per=6.4e+01 cost=3.6e+04 flops=4.9e+06
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,9.1e-06,2.1e-06,1.0e-06,1.8e-07
    2   0 -    -116.214498322664 -1.420e-02  1.954e-02    2     2  6.707e-03 3.353e-03 3.018e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.640e-05,9.931e-05,3.807e-04,2.605e-04,7.712e-04
 ndim=22:1.639e-07GB t[comm(intra)]=2.154e-05 speed=1.522e-02GB/S t[comm(inter)]=4.863e-06 speed=6.741e-02GB/S
--- TIMING FOR sigma : t_inter=9.9e-05 t_gemm=3.8e-04 t_reduction=2.6e-04 tot=7.4e-04 ---
 sigma[inter] counter=12 t=9.9e-05 per=1.3e+01 cost=2.7e+04 flops=2.7e+08
 sigma[gemm] counter=12 i=0 t=2.3e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=1 t=2.2e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=2 t=2.2e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=3 t=2.2e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=4 t=9.4e-05 per=1.3e+01 cost=6.1e+03 flops=6.5e+07
 sigma[gemm] counter=12 i=5 t=9.2e-05 per=1.2e+01 cost=6.3e+03 flops=6.9e+07
 sigma[gemm] counter=12 i=6 t=9.1e-05 per=1.2e+01 cost=5.4e+03 flops=5.9e+07
 sigma[gemm] counter=12 i=7 t=9.4e-05 per=1.3e+01 cost=5.9e+03 flops=6.3e+07
 sigma[gemm] counter=12 total t=3.8e-04 per=5.1e+01 cost=2.4e+04 flops=6.2e+07
 sigma[red] counter=12 t=2.6e-04 per=3.5e+01 cost=9.1e+03 flops=3.5e+07
--- TIMING FOR sigma_tot : t_inter=1.0e-03 t_gemm=3.6e-03 t_reduction=7.6e-03 tot=1.2e-02 ---
 sigma_tot[inter] counter=12 t=1.0e-03 per=8.4e+00 cost=1.3e+05 flops=1.2e+08
 sigma_tot[gemm] counter=12 i=0 t=3.1e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=1 t=2.7e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=2 t=2.7e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=3 t=2.6e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=4 t=9.2e-04 per=7.6e+00 cost=2.8e+04 flops=3.1e+07
 sigma_tot[gemm] counter=12 i=5 t=8.9e-04 per=7.3e+00 cost=2.9e+04 flops=3.2e+07
 sigma_tot[gemm] counter=12 i=6 t=8.7e-04 per=7.1e+00 cost=2.2e+04 flops=2.6e+07
 sigma_tot[gemm] counter=12 i=7 t=7.8e-04 per=6.4e+00 cost=2.4e+04 flops=3.1e+07
 sigma_tot[gemm] counter=12 total t=3.6e-03 per=2.9e+01 cost=1.0e+05 flops=2.9e+07
 sigma_tot[red] counter=12 t=7.6e-03 per=6.2e+01 cost=4.5e+04 flops=6.0e+06
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.1e-06,1.2e-05,1.6e-06,9.1e-07,1.8e-07
    3   0 -    -116.215692407464 -1.194e-03  6.197e-03    3     3  9.638e-03 3.213e-03 2.928e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.655e-05,9.257e-05,3.720e-04,2.560e-04,7.513e-04
 ndim=22:1.639e-07GB t[comm(intra)]=2.185e-05 speed=1.500e-02GB/S t[comm(inter)]=4.700e-06 speed=6.975e-02GB/S
--- TIMING FOR sigma : t_inter=9.3e-05 t_gemm=3.7e-04 t_reduction=2.6e-04 tot=7.2e-04 ---
 sigma[inter] counter=13 t=9.3e-05 per=1.3e+01 cost=2.7e+04 flops=2.9e+08
 sigma[gemm] counter=13 i=0 t=2.3e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=1 t=2.2e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=2 t=2.2e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=3 t=2.2e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=4 t=9.1e-05 per=1.3e+01 cost=6.1e+03 flops=6.7e+07
 sigma[gemm] counter=13 i=5 t=9.2e-05 per=1.3e+01 cost=6.3e+03 flops=6.8e+07
 sigma[gemm] counter=13 i=6 t=9.0e-05 per=1.2e+01 cost=5.4e+03 flops=6.0e+07
 sigma[gemm] counter=13 i=7 t=8.9e-05 per=1.2e+01 cost=5.9e+03 flops=6.6e+07
 sigma[gemm] counter=13 total t=3.7e-04 per=5.2e+01 cost=2.4e+04 flops=6.4e+07
 sigma[red] counter=13 t=2.6e-04 per=3.6e+01 cost=9.1e+03 flops=3.5e+07
--- TIMING FOR sigma_tot : t_inter=1.1e-03 t_gemm=3.9e-03 t_reduction=7.8e-03 tot=1.3e-02 ---
 sigma_tot[inter] counter=13 t=1.1e-03 per=8.6e+00 cost=1.5e+05 flops=1.4e+08
 sigma_tot[gemm] counter=13 i=0 t=3.3e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=1 t=2.9e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=2 t=2.9e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=3 t=2.9e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=4 t=1.0e-03 per=7.8e+00 cost=3.4e+04 flops=3.4e+07
 sigma_tot[gemm] counter=13 i=5 t=9.8e-04 per=7.6e+00 cost=3.5e+04 flops=3.6e+07
 sigma_tot[gemm] counter=13 i=6 t=9.6e-04 per=7.4e+00 cost=2.8e+04 flops=2.9e+07
 sigma_tot[gemm] counter=13 i=7 t=8.7e-04 per=6.7e+00 cost=3.0e+04 flops=3.5e+07
 sigma_tot[gemm] counter=13 total t=3.9e-03 per=3.1e+01 cost=1.3e+05 flops=3.2e+07
 sigma_tot[red] counter=13 t=7.8e-03 per=6.1e+01 cost=5.4e+04 flops=6.9e+06
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,9.6e-06,1.4e-06,8.0e-07,1.2e-07
    4   0 -    -116.215785169807 -9.276e-05  1.460e-03    3     4  1.255e-02 3.137e-03 2.876e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.653e-05,9.104e-05,3.803e-04,2.598e-04,7.613e-04
 ndim=22:1.639e-07GB t[comm(intra)]=2.172e-05 speed=1.509e-02GB/S t[comm(inter)]=4.811e-06 speed=6.814e-02GB/S
--- TIMING FOR sigma : t_inter=9.1e-05 t_gemm=3.8e-04 t_reduction=2.6e-04 tot=7.3e-04 ---
 sigma[inter] counter=14 t=9.1e-05 per=1.2e+01 cost=2.7e+04 flops=3.0e+08
 sigma[gemm] counter=14 i=0 t=2.4e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=1 t=2.3e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=2 t=2.2e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=3 t=2.2e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=4 t=1.0e-04 per=1.4e+01 cost=6.1e+03 flops=6.1e+07
 sigma[gemm] counter=14 i=5 t=9.2e-05 per=1.3e+01 cost=6.3e+03 flops=6.8e+07
 sigma[gemm] counter=14 i=6 t=8.9e-05 per=1.2e+01 cost=5.4e+03 flops=6.0e+07
 sigma[gemm] counter=14 i=7 t=8.9e-05 per=1.2e+01 cost=5.9e+03 flops=6.6e+07
 sigma[gemm] counter=14 total t=3.8e-04 per=5.2e+01 cost=2.4e+04 flops=6.2e+07
 sigma[red] counter=14 t=2.6e-04 per=3.6e+01 cost=9.1e+03 flops=3.5e+07
--- TIMING FOR sigma_tot : t_inter=1.2e-03 t_gemm=4.3e-03 t_reduction=8.1e-03 tot=1.4e-02 ---
 sigma_tot[inter] counter=14 t=1.2e-03 per=8.9e+00 cost=1.8e+05 flops=1.5e+08
 sigma_tot[gemm] counter=14 i=0 t=3.5e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=1 t=3.2e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=2 t=3.1e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=3 t=3.1e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=4 t=1.1e-03 per=8.2e+00 cost=4.0e+04 flops=3.6e+07
 sigma_tot[gemm] counter=14 i=5 t=1.1e-03 per=7.9e+00 cost=4.1e+04 flops=3.8e+07
 sigma_tot[gemm] counter=14 i=6 t=1.0e-03 per=7.7e+00 cost=3.3e+04 flops=3.1e+07
 sigma_tot[gemm] counter=14 i=7 t=9.6e-04 per=7.0e+00 cost=3.6e+04 flops=3.8e+07
 sigma_tot[gemm] counter=14 total t=4.3e-03 per=3.2e+01 cost=1.5e+05 flops=3.5e+07
 sigma_tot[red] counter=14 t=8.1e-03 per=5.9e+01 cost=6.3e+04 flops=7.8e+06
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,9.5e-06,1.5e-06,7.5e-07,1.5e-07
    5   0 -    -116.215791754882 -6.585e-06  4.041e-04    3     5  1.551e-02 3.102e-03 2.856e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.706e-05,1.046e-04,3.832e-04,2.686e-04,7.871e-04
 ndim=22:1.639e-07GB t[comm(intra)]=2.239e-05 speed=1.464e-02GB/S t[comm(inter)]=4.662e-06 speed=7.032e-02GB/S
--- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=3.8e-04 t_reduction=2.7e-04 tot=7.6e-04 ---
 sigma[inter] counter=15 t=1.0e-04 per=1.4e+01 cost=2.7e+04 flops=2.6e+08
 sigma[gemm] counter=15 i=0 t=2.3e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=1 t=2.2e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=2 t=2.2e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=3 t=2.1e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=4 t=9.1e-05 per=1.2e+01 cost=6.1e+03 flops=6.8e+07
 sigma[gemm] counter=15 i=5 t=9.4e-05 per=1.2e+01 cost=6.3e+03 flops=6.7e+07
 sigma[gemm] counter=15 i=6 t=1.0e-04 per=1.3e+01 cost=5.4e+03 flops=5.3e+07
 sigma[gemm] counter=15 i=7 t=8.8e-05 per=1.2e+01 cost=5.9e+03 flops=6.7e+07
 sigma[gemm] counter=15 total t=3.8e-04 per=5.1e+01 cost=2.4e+04 flops=6.2e+07
 sigma[red] counter=15 t=2.7e-04 per=3.6e+01 cost=9.1e+03 flops=3.4e+07
--- TIMING FOR sigma_tot : t_inter=1.3e-03 t_gemm=4.7e-03 t_reduction=8.3e-03 tot=1.4e-02 ---
 sigma_tot[inter] counter=15 t=1.3e-03 per=9.1e+00 cost=2.1e+05 flops=1.6e+08
 sigma_tot[gemm] counter=15 i=0 t=3.8e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=1 t=3.4e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=2 t=3.3e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=3 t=3.3e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=4 t=1.2e-03 per=8.4e+00 cost=4.7e+04 flops=3.9e+07
 sigma_tot[gemm] counter=15 i=5 t=1.2e-03 per=8.2e+00 cost=4.8e+04 flops=4.1e+07
 sigma_tot[gemm] counter=15 i=6 t=1.1e-03 per=8.0e+00 cost=3.8e+04 flops=3.3e+07
 sigma_tot[gemm] counter=15 i=7 t=1.0e-03 per=7.3e+00 cost=4.2e+04 flops=4.0e+07
 sigma_tot[gemm] counter=15 total t=4.7e-03 per=3.3e+01 cost=1.7e+05 flops=3.7e+07
 sigma_tot[red] counter=15 t=8.3e-03 per=5.8e+01 cost=7.2e+04 flops=8.7e+06
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,9.7e-06,1.6e-06,7.8e-07,1.3e-07
    6   0 -    -116.215792238422 -4.835e-07  1.486e-04    3     6  1.851e-02 3.085e-03 2.849e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.658e-05,9.256e-05,3.713e-04,2.620e-04,7.561e-04
 ndim=22:1.639e-07GB t[comm(intra)]=2.196e-05 speed=1.493e-02GB/S t[comm(inter)]=4.623e-06 speed=7.091e-02GB/S
--- TIMING FOR sigma : t_inter=9.3e-05 t_gemm=3.7e-04 t_reduction=2.6e-04 tot=7.3e-04 ---
 sigma[inter] counter=16 t=9.3e-05 per=1.3e+01 cost=2.7e+04 flops=2.9e+08
 sigma[gemm] counter=16 i=0 t=2.3e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=1 t=2.3e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=2 t=2.2e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=3 t=2.2e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=4 t=9.1e-05 per=1.3e+01 cost=6.1e+03 flops=6.8e+07
 sigma[gemm] counter=16 i=5 t=9.5e-05 per=1.3e+01 cost=6.3e+03 flops=6.7e+07
 sigma[gemm] counter=16 i=6 t=9.0e-05 per=1.2e+01 cost=5.4e+03 flops=5.9e+07
 sigma[gemm] counter=16 i=7 t=8.6e-05 per=1.2e+01 cost=5.9e+03 flops=6.8e+07
 sigma[gemm] counter=16 total t=3.7e-04 per=5.1e+01 cost=2.4e+04 flops=6.4e+07
 sigma[red] counter=16 t=2.6e-04 per=3.6e+01 cost=9.1e+03 flops=3.5e+07
--- TIMING FOR sigma_tot : t_inter=1.4e-03 t_gemm=5.1e-03 t_reduction=8.6e-03 tot=1.5e-02 ---
 sigma_tot[inter] counter=16 t=1.4e-03 per=9.3e+00 cost=2.4e+05 flops=1.7e+08
 sigma_tot[gemm] counter=16 i=0 t=4.0e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=1 t=3.6e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=2 t=3.5e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=3 t=3.5e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=4 t=1.3e-03 per=8.6e+00 cost=5.3e+04 flops=4.1e+07
 sigma_tot[gemm] counter=16 i=5 t=1.3e-03 per=8.4e+00 cost=5.4e+04 flops=4.3e+07
 sigma_tot[gemm] counter=16 i=6 t=1.2e-03 per=8.2e+00 cost=4.4e+04 flops=3.5e+07
 sigma_tot[gemm] counter=16 i=7 t=1.1e-03 per=7.5e+00 cost=4.8e+04 flops=4.2e+07
 sigma_tot[gemm] counter=16 total t=5.1e-03 per=3.4e+01 cost=2.0e+05 flops=3.9e+07
 sigma_tot[red] counter=16 t=8.6e-03 per=5.7e+01 cost=8.2e+04 flops=9.5e+06
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,9.4e-06,1.5e-06,7.6e-07,1.1e-07
    7   0 +    -116.215792300366 -6.194e-08  5.489e-05    3     7  2.144e-02 3.063e-03 2.835e-03
TIMING FOR Davidson : 2.152e-02  T(cal/comm/rest)=1.985e-02,3.140e-07,1.673e-03
decomposed t_rest=1.673e-03
 T(sub)    =1.017e-04 per=6.078e+00
 T(precond)=1.542e-04 per=9.217e+00
 T(ortho)  =8.647e-06 per=5.169e-01
 T(xcopy)  =7.760e-07 per=4.638e-02
 T(xnrm2)  =9.520e-07 per=5.690e-02
 T(other)  =1.407e-03 per=8.409e+01
optimized energies: isweep=0 ibond=2 dots=2 e[0]=-116.215792300366 nmvp=7
CPUmem: VM:7.242e+01GB RSS:5.575e-01GB  Timing: User:5.217e+00S Sys:1.125e+00S Total:6.342e+00S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=7 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=7 dimAll=15
 (5,1):3 (7,1):3 (6,0):3 (6,2):3 (8,0):1 (4,2):1 (5,3):1
----- TMING FOR decimation_genbasis(su2): 4.5e-05 S -----
decimation summary: 15->7 dwt=+0.000e+00 SvN=6.051e-01
 qbond: qkept nsym=3 dimAll=7
 (7,1):3 (6,2):3 (5,3):1
----- TIMING for decimation_row(nkr): 2.683e-03 S T(decim/select/formRot)=3.387e-04,2.191e-03,1.538e-04 -----
----- TIMING FOR twodot_decimation: 2.897e-03 S T(wf/decim)=1.350e-04,2.762e-03 -----
ctns::oper_renorm coord=(3,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:4 S:16 H:1 A:16 B:20 
        dim(bra,ket)=7,7 size(op)=19:1.450e-04MB size(tot)=657:5.013e-03MB:4.895e-06GB
CPUmem: VM:7.248e+01GB RSS:5.575e-01GB  Timing: User:5.469e+00S Sys:1.125e+00S Total:6.594e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=57 : 2.232e-04 S -----
rank=0 GPUmem(GB): used=3.38e-05 (oper)=1.35e-05
rank=0 GPUmem(GB): used=3.39e-05 (oper,site)(GB)=1.35e-05,1.42e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=57
 no. of rintermediate operators=149
 no. of coefficients=702:0.00536MB:5.23e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.316e-04 S -----
rank=0 GPUmem(GB): used=3.91e-05 (oper,site,rinter)=1.35e-05,1.42e-07,5.23e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000503 S size(rtasks)=57 size(Rlst2)=9 T(Rmu/Rlist)=7.06e-05,0.000432 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000603 S size(rtasks)=57 size(Rlst)=459 -----
rank=0 GPUmem(GB): used=3.91e-05 (oper,site,rinter,batch)=1.35e-05,1.42e-07,5.23e-06,7.87e-05 blksize=9 blksize0=4 batchsize=459
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000136,0.000307,0.000141
--- TIMING FOR renorm : t_inter=1.4e-04 t_gemm=3.1e-04 t_reduction=1.4e-04 tot=5.8e-04 ---
 renorm[inter] counter=3 t=1.4e-04 per=2.3e+01 cost=5.7e+03 flops=4.2e+07
 renorm[gemm] counter=3 i=0 t=2.7e-06 per=4.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=1 t=2.2e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=2 t=2.2e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=3 t=2.2e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=4 t=1.0e-04 per=1.7e+01 cost=2.4e+03 flops=2.4e+07
 renorm[gemm] counter=3 i=5 t=9.9e-05 per=1.7e+01 cost=2.8e+03 flops=2.9e+07
 renorm[gemm] counter=3 i=6 t=9.9e-05 per=1.7e+01 cost=9.7e+03 flops=9.8e+07
 renorm[gemm] counter=3 total t=3.1e-04 per=5.3e+01 cost=1.5e+04 flops=4.8e+07
 renorm[red] counter=3 t=1.4e-04 per=2.4e+01 cost=6.2e+03 flops=4.4e+07
--- TIMING FOR renorm_tot : t_inter=2.4e-04 t_gemm=7.2e-04 t_reduction=3.7e-04 tot=1.3e-03 ---
 renorm_tot[inter] counter=3 t=2.4e-04 per=1.8e+01 cost=6.6e+03 flops=2.7e+07
 renorm_tot[gemm] counter=3 i=0 t=8.5e-06 per=6.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=1 t=6.8e-06 per=5.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=2 t=6.6e-06 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=3 t=6.5e-06 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=4 t=2.4e-04 per=1.8e+01 cost=2.8e+03 flops=1.2e+07
 renorm_tot[gemm] counter=3 i=5 t=2.2e-04 per=1.6e+01 cost=3.3e+03 flops=1.5e+07
 renorm_tot[gemm] counter=3 i=6 t=2.3e-04 per=1.7e+01 cost=1.1e+04 flops=4.8e+07
 renorm_tot[gemm] counter=3 total t=7.2e-04 per=5.4e+01 cost=1.7e+04 flops=2.4e+07
 renorm_tot[red] counter=3 t=3.7e-04 per=2.8e+01 cost=7.7e+03 flops=2.1e+07
qops.to_cpu: size(tot)=657:5.0e-03MB:4.9e-06GB t[to_cpu]=1.6e-05S speed=3.0e-01GB/S
check ||H-H.dagger||=7.745e-15 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00486 S rank=0 -----
CPUmem: VM:7.248e+01GB RSS:5.575e-01GB  Timing: User:5.687e+00S Sys:1.125e+00S Total:6.812e+00S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=902:6.882e-03MB:6.720e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=22:1.678e-04MB:1.639e-07GB
total mem of comb=925:7.057e-03MB:6.892e-06GB
CPUmem: VM:7.248e+01GB RSS:5.575e-01GB  Timing: User:5.689e+00S Sys:1.125e+00S Total:6.814e+00S
##### local opt: 4.954e-02 S #####
 T(local opt: fetch) = 6.680e-03 S  per = 13.5  per(accum) = 13.5
 T(local opt: hdiag) = 2.071e-03 S  per = 4.18  per(accum) = 17.7
 T(local opt: dvdsn) = 2.781e-02 S  per = 56.1  per(accum) = 73.8
 T(local opt: decim) = 2.989e-03 S  per = 6.03  per(accum) = 79.8
 T(local opt: guess) = 8.702e-05 S  per = 0.176  per(accum) = 80
 T(local opt: renrm) = 5.733e-03 S  per = 11.6  per(accum) = 91.6
 T(local opt: save ) = 4.177e-03 S  per = 8.43  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.781e-02 S  T(sum) = 2.703e-02 S  per = 9.719e+01
 T(local opt: preprocess                  ) = 6.099e-04 S  per = 2.26  per(accum) = 2.26
 T(local opt: symbolic_formulae           ) = 6.873e-04 S  per = 2.54  per(accum) = 4.8
 T(local opt: hintermediate init          ) = 5.723e-04 S  per = 2.12  per(accum) = 6.92
 T(local opt: preprocess_hformulae_Hxlist ) = 2.983e-03 S  per =   11  per(accum) = 18
 T(local opt: hmmtasks init               ) = 4.450e-04 S  per = 1.65  per(accum) = 19.6
 T(local opt: initial guess for dvdson    ) = 2.091e-04 S  per = 0.774  per(accum) = 20.4
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.965e-02 S  per = 72.7  per(accum) = 93.1
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.929e-04 S  per = 0.714  per(accum) = 93.8
 T(local opt: dvdson solver [comm(cpu)]   ) = 3.140e-07 S  per = 0.00116  per(accum) = 93.8
 T(local opt: dvdson solver [rest part]   ) = 1.673e-03 S  per = 6.19  per(accum) = 100
Detailed decomposition of T(renrm) = 5.733e-03 S  T(sum) = 5.733e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.082e-04 S  per = 1.89  per(accum) = 1.89
 T(local opt: qops init                    ) = 3.312e-04 S  per = 5.78  per(accum) = 7.67
 T(local opt: symbolic_formulae_renorm     ) = 3.045e-04 S  per = 5.31  per(accum) = 13
 T(local opt: allocate qops on gpu         ) = 9.396e-05 S  per = 1.64  per(accum) = 14.6
 T(local opt: site memcpy cpu2gpu          ) = 8.805e-05 S  per = 1.54  per(accum) = 16.2
 T(local opt: rintermediate init           ) = 4.887e-04 S  per = 8.53  per(accum) = 24.7
 T(local opt: preprocess_formulae_Rlist2   ) = 6.791e-04 S  per = 11.8  per(accum) = 36.5
 T(local opt: rmmtasks init                ) = 2.345e-04 S  per = 4.09  per(accum) = 40.6
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 0.000576  per(accum) = 40.6
 T(local opt: preprocess_renorm_batchGPU   ) = 2.443e-03 S  per = 42.6  per(accum) = 83.2
 T(local opt: reduction of opS & opH [nccl]) = 5.250e-07 S  per = 0.00916  per(accum) = 83.2
 T(local opt: qops memcpy gpu2cpu          ) = 9.847e-05 S  per = 1.72  per(accum) = 85
 T(local opt: deallocate cpu and gpu memory) = 9.872e-06 S  per = 0.172  per(accum) = 85.1
 T(local opt: reduction of opS & opH [comm]) = 9.100e-05 S  per = 1.59  per(accum) = 86.7
 T(local opt: conversion from opAB to opPQ ) = 7.930e-05 S  per = 1.38  per(accum) = 88.1
 T(local opt: after oper_renorm            ) = 6.819e-04 S  per = 11.9  per(accum) = 100
##### sweep opt: 1.334e-01 S #####
 T(sweep opt: fetch) = 2.436e-02 S  per = 18.3  per(accum) = 18.3
 T(sweep opt: hdiag) = 5.643e-03 S  per = 4.23  per(accum) = 22.5
 T(sweep opt: dvdsn) = 6.637e-02 S  per = 49.8  per(accum) = 72.3
 T(sweep opt: decim) = 8.339e-03 S  per = 6.25  per(accum) = 78.5
 T(sweep opt: guess) = 2.850e-04 S  per = 0.214  per(accum) = 78.7
 T(sweep opt: renrm) = 1.555e-02 S  per = 11.7  per(accum) = 90.4
 T(sweep opt: save ) = 1.281e-02 S  per = 9.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.637e-02 S  T(sum) = 6.407e-02 S  per = 9.653e+01
 T(sweep opt: preprocess                  ) = 1.851e-03 S  per = 2.89  per(accum) = 2.89
 T(sweep opt: symbolic_formulae           ) = 1.718e-03 S  per = 2.68  per(accum) = 5.57
 T(sweep opt: hintermediate init          ) = 1.682e-03 S  per = 2.63  per(accum) = 8.2
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.789e-03 S  per = 9.04  per(accum) = 17.2
 T(sweep opt: hmmtasks init               ) = 9.366e-04 S  per = 1.46  per(accum) = 18.7
 T(sweep opt: initial guess for dvdson    ) = 5.945e-04 S  per = 0.928  per(accum) = 19.6
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 4.694e-02 S  per = 73.3  per(accum) = 92.9
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.466e-04 S  per = 0.697  per(accum) = 93.6
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 7.720e-07 S  per = 0.0012  per(accum) = 93.6
 T(sweep opt: dvdson solver [rest part]   ) = 4.110e-03 S  per = 6.42  per(accum) = 100
Detailed decomposition of T(renrm) = 1.555e-02 S  T(sum) = 1.555e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.178e-04 S  per = 2.04  per(accum) = 2.04
 T(sweep opt: qops init                    ) = 9.348e-04 S  per = 6.01  per(accum) = 8.06
 T(sweep opt: symbolic_formulae_renorm     ) = 7.856e-04 S  per = 5.05  per(accum) = 13.1
 T(sweep opt: allocate qops on gpu         ) = 2.820e-04 S  per = 1.81  per(accum) = 14.9
 T(sweep opt: site memcpy cpu2gpu          ) = 2.557e-04 S  per = 1.64  per(accum) = 16.6
 T(sweep opt: rintermediate init           ) = 1.324e-03 S  per = 8.51  per(accum) = 25.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.558e-03 S  per =   10  per(accum) = 35.1
 T(sweep opt: rmmtasks init                ) = 5.590e-04 S  per =  3.6  per(accum) = 38.7
 T(sweep opt: qops memset on cpu           ) = 1.090e-07 S  per = 0.000701  per(accum) = 38.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.588e-03 S  per = 42.4  per(accum) = 81.1
 T(sweep opt: reduction of opS & opH [nccl]) = 1.533e-06 S  per = 0.00986  per(accum) = 81.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.725e-04 S  per = 1.75  per(accum) = 82.8
 T(sweep opt: deallocate cpu and gpu memory) = 2.861e-05 S  per = 0.184  per(accum) = 83
 T(sweep opt: reduction of opS & opH [comm]) = 2.553e-04 S  per = 1.64  per(accum) = 84.7
 T(sweep opt: conversion from opAB to opPQ ) = 2.329e-04 S  per =  1.5  per(accum) = 86.2
 T(sweep opt: after oper_renorm            ) = 2.152e-03 S  per = 13.8  per(accum) = 100
##### global opt: 1.334e-01 S #####
 T(global opt: fetch) = 2.436e-02 S  per = 18.3  per(accum) = 18.3
 T(global opt: hdiag) = 5.643e-03 S  per = 4.23  per(accum) = 22.5
 T(global opt: dvdsn) = 6.637e-02 S  per = 49.8  per(accum) = 72.3
 T(global opt: decim) = 8.339e-03 S  per = 6.25  per(accum) = 78.5
 T(global opt: guess) = 2.850e-04 S  per = 0.214  per(accum) = 78.7
 T(global opt: renrm) = 1.555e-02 S  per = 11.7  per(accum) = 90.4
 T(global opt: save ) = 1.281e-02 S  per = 9.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.637e-02 S  T(sum) = 6.407e-02 S  per = 9.653e+01
 T(global opt: preprocess                  ) = 1.851e-03 S  per = 2.89  per(accum) = 2.89
 T(global opt: symbolic_formulae           ) = 1.718e-03 S  per = 2.68  per(accum) = 5.57
 T(global opt: hintermediate init          ) = 1.682e-03 S  per = 2.63  per(accum) = 8.2
 T(global opt: preprocess_hformulae_Hxlist ) = 5.789e-03 S  per = 9.04  per(accum) = 17.2
 T(global opt: hmmtasks init               ) = 9.366e-04 S  per = 1.46  per(accum) = 18.7
 T(global opt: initial guess for dvdson    ) = 5.945e-04 S  per = 0.928  per(accum) = 19.6
 T(global opt: dvdson solver [Hx_batchGPU] ) = 4.694e-02 S  per = 73.3  per(accum) = 92.9
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.466e-04 S  per = 0.697  per(accum) = 93.6
 T(global opt: dvdson solver [comm(cpu)]   ) = 7.720e-07 S  per = 0.0012  per(accum) = 93.6
 T(global opt: dvdson solver [rest part]   ) = 4.110e-03 S  per = 6.42  per(accum) = 100
Detailed decomposition of T(renrm) = 1.555e-02 S  T(sum) = 1.555e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.178e-04 S  per = 2.04  per(accum) = 2.04
 T(global opt: qops init                    ) = 9.348e-04 S  per = 6.01  per(accum) = 8.06
 T(global opt: symbolic_formulae_renorm     ) = 7.856e-04 S  per = 5.05  per(accum) = 13.1
 T(global opt: allocate qops on gpu         ) = 2.820e-04 S  per = 1.81  per(accum) = 14.9
 T(global opt: site memcpy cpu2gpu          ) = 2.557e-04 S  per = 1.64  per(accum) = 16.6
 T(global opt: rintermediate init           ) = 1.324e-03 S  per = 8.51  per(accum) = 25.1
 T(global opt: preprocess_formulae_Rlist2   ) = 1.558e-03 S  per =   10  per(accum) = 35.1
 T(global opt: rmmtasks init                ) = 5.590e-04 S  per =  3.6  per(accum) = 38.7
 T(global opt: qops memset on cpu           ) = 1.090e-07 S  per = 0.000701  per(accum) = 38.7
 T(global opt: preprocess_renorm_batchGPU   ) = 6.588e-03 S  per = 42.4  per(accum) = 81.1
 T(global opt: reduction of opS & opH [nccl]) = 1.533e-06 S  per = 0.00986  per(accum) = 81.1
 T(global opt: qops memcpy gpu2cpu          ) = 2.725e-04 S  per = 1.75  per(accum) = 82.8
 T(global opt: deallocate cpu and gpu memory) = 2.861e-05 S  per = 0.184  per(accum) = 83
 T(global opt: reduction of opS & opH [comm]) = 2.553e-04 S  per = 1.64  per(accum) = 84.7
 T(global opt: conversion from opAB to opPQ ) = 2.329e-04 S  per =  1.5  per(accum) = 86.2
 T(global opt: after oper_renorm            ) = 2.152e-03 S  per = 13.8  per(accum) = 100

isweep=0 ibond=3/seqsize=34 dots=2 dbond=(4,0)-(5,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.248e+01GB RSS:5.575e-01GB  Timing: User:5.690e+00S Sys:1.125e+00S Total:6.815e+00S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=902:6.882e-03MB:6.720e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=22:1.678e-04MB:1.639e-07GB
total mem of comb=925:7.057e-03MB:6.892e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=4,14,1,1
 suppl= 0 1 2 3
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 4
 suppc2= 16
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:4 S:16 H:1 A:16 B:20 
        dim(bra,ket)=7,7 size(op)=19:1.450e-04MB size(tot)=657:5.013e-03MB:4.895e-06GB
 rqops: oplist=CSHPQ nops=C:14 S:6 H:1 P:36 Q:42 
        dim(bra,ket)=17,17 size(op)=137:1.045e-03MB size(tot)=4483:3.420e-02MB:3.340e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=7136:5.444e-02MB:5.317e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(4,0) fdel=./scratch/sweep/rop(5,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
wf4(diml,dimr,dimc1,dimc2)=(7,17,3,3) nnz=119:9.079e-04MB
qtensor4: wf4 own=1 _data=0x55a322721880
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=7
 (7,1):3 (6,2):3 (5,3):1
 qbond: qcol nsym=7 dimAll=17
 (21,1):3 (21,3):4 (21,5):4 (21,7):3 (22,2):1 (22,4):1 (22,6):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=336 size=119:9.079e-04MB
### DIAG TIMING: total=2.472e-03 t1=9.316e-06, t2=1.446e-05, t3=1.665e-05, t4=2.406e-03, t5=4.341e-06, t6=1.741e-05, t7=4.346e-06
duration_diagGPU:2.576e-03
duration_diagreduce:2.800e-08
duration_diagtransform:2.560e-07
----- TIMING FOR symbolic_formulae_twodot with size=437 : 7.406e-04 S -----
rank=0 GPUmem(GB): used=5.32e-05 (oper)=5.32e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=437
 no. of hintermediate operators=240
 no. of coefficients=2470:0.0188MB:1.84e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.508e-04 S -----
rank=0 GPUmem(GB): used=7.16e-05 (oper,hinter)=5.32e-05,1.84e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0145 S size(H_formulae)=437 size(Hxlst2)=21 T(Hmu/Hxlist)=0.000148,0.0143 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0153 S size(H_formulae)=437 size(Hxlst)=8552 -----
rank=0 GPUmem(GB): used=0.00224 (oper,hinter,dvdson,batch)=5.32e-05,1.84e-05,1.77e-06,0.00217 blksize=12 blksize0=9 batchsize=8552
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=119 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.14e-05,0.000175,0.000923,0.000794,0.00193
 ndim=119:8.87e-07GB t[comm(intra)]=2.4e-05 speed=0.0739GB/S t[comm(inter)]=7.36e-06 speed=0.241GB/S
--- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=9.2e-04 t_reduction=7.9e-04 tot=1.9e-03 ---
 sigma[inter] counter=17 t=1.7e-04 per=9.2e+00 cost=4.6e+05 flops=2.6e+09
 sigma[gemm] counter=17 i=0 t=2.8e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=1 t=2.4e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=2 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=3 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=4 t=2.3e-04 per=1.2e+01 cost=7.8e+04 flops=3.4e+08
 sigma[gemm] counter=17 i=5 t=2.5e-04 per=1.3e+01 cost=8.1e+04 flops=3.2e+08
 sigma[gemm] counter=17 i=6 t=2.4e-04 per=1.3e+01 cost=1.1e+05 flops=4.7e+08
 sigma[gemm] counter=17 i=7 t=1.9e-04 per=1.0e+01 cost=1.2e+05 flops=6.4e+08
 sigma[gemm] counter=17 total t=9.2e-04 per=4.9e+01 cost=3.9e+05 flops=4.2e+08
 sigma[red] counter=17 t=7.9e-04 per=4.2e+01 cost=1.0e+05 flops=1.3e+08
--- TIMING FOR sigma_tot : t_inter=1.6e-03 t_gemm=6.0e-03 t_reduction=9.4e-03 tot=1.7e-02 ---
 sigma_tot[inter] counter=17 t=1.6e-03 per=9.3e+00 cost=7.0e+05 flops=4.4e+08
 sigma_tot[gemm] counter=17 i=0 t=4.3e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=1 t=3.8e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=2 t=3.8e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=3 t=3.7e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=4 t=1.5e-03 per=9.0e+00 cost=1.3e+05 flops=8.6e+07
 sigma_tot[gemm] counter=17 i=5 t=1.5e-03 per=8.9e+00 cost=1.4e+05 flops=8.9e+07
 sigma_tot[gemm] counter=17 i=6 t=1.5e-03 per=8.7e+00 cost=1.5e+05 flops=1.0e+08
 sigma_tot[gemm] counter=17 i=7 t=1.3e-03 per=7.8e+00 cost=1.7e+05 flops=1.3e+08
 sigma_tot[gemm] counter=17 total t=6.0e-03 per=3.5e+01 cost=5.9e+05 flops=9.8e+07
 sigma_tot[red] counter=17 t=9.4e-03 per=5.5e+01 cost=1.8e+05 flops=1.9e+07
T(sub)=7.7e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,2.9e-06,8.9e-07,9.5e-07,2.2e-07
settings: ndim=119 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.215792300366 -1.116e+03  9.651e-03    1     1  4.158e-03 4.158e-03 3.980e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.859e-05,1.205e-04,6.060e-04,7.338e-04,1.494e-03
 ndim=119:8.866e-07GB t[comm(intra)]=2.264e-05 speed=7.832e-02GB/S t[comm(inter)]=5.950e-06 speed=2.980e-01GB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=6.1e-04 t_reduction=7.3e-04 tot=1.5e-03 ---
 sigma[inter] counter=18 t=1.2e-04 per=8.3e+00 cost=4.6e+05 flops=3.8e+09
 sigma[gemm] counter=18 i=0 t=2.7e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=1 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=4 t=1.6e-04 per=1.1e+01 cost=7.8e+04 flops=4.9e+08
 sigma[gemm] counter=18 i=5 t=1.8e-04 per=1.2e+01 cost=8.1e+04 flops=4.6e+08
 sigma[gemm] counter=18 i=6 t=1.3e-04 per=8.7e+00 cost=1.1e+05 flops=8.8e+08
 sigma[gemm] counter=18 i=7 t=1.3e-04 per=9.0e+00 cost=1.2e+05 flops=9.1e+08
 sigma[gemm] counter=18 total t=6.1e-04 per=4.1e+01 cost=3.9e+05 flops=6.5e+08
 sigma[red] counter=18 t=7.3e-04 per=5.0e+01 cost=1.0e+05 flops=1.4e+08
--- TIMING FOR sigma_tot : t_inter=1.7e-03 t_gemm=6.6e-03 t_reduction=1.0e-02 tot=1.8e-02 ---
 sigma_tot[inter] counter=18 t=1.7e-03 per=9.2e+00 cost=1.2e+06 flops=6.8e+08
 sigma_tot[gemm] counter=18 i=0 t=4.5e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=1 t=4.1e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=2 t=4.0e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=3 t=4.0e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=4 t=1.7e-03 per=9.1e+00 cost=2.1e+05 flops=1.2e+08
 sigma_tot[gemm] counter=18 i=5 t=1.7e-03 per=9.2e+00 cost=2.2e+05 flops=1.3e+08
 sigma_tot[gemm] counter=18 i=6 t=1.6e-03 per=8.7e+00 cost=2.7e+05 flops=1.7e+08
 sigma_tot[gemm] counter=18 i=7 t=1.4e-03 per=7.9e+00 cost=2.9e+05 flops=2.0e+08
 sigma_tot[gemm] counter=18 total t=6.6e-03 per=3.6e+01 cost=9.8e+05 flops=1.5e+08
 sigma_tot[red] counter=18 t=1.0e-02 per=5.5e+01 cost=2.8e+05 flops=2.8e+07
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,9.2e-06,2.4e-06,1.0e-06,2.2e-07
    2   0 -    -116.216193153147 -4.009e-04  2.956e-03    2     2  8.146e-03 4.073e-03 3.702e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.810e-05,1.167e-04,6.138e-04,7.393e-04,1.503e-03
 ndim=119:8.866e-07GB t[comm(intra)]=2.243e-05 speed=7.904e-02GB/S t[comm(inter)]=5.668e-06 speed=3.129e-01GB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=6.1e-04 t_reduction=7.4e-04 tot=1.5e-03 ---
 sigma[inter] counter=19 t=1.2e-04 per=7.9e+00 cost=4.6e+05 flops=4.0e+09
 sigma[gemm] counter=19 i=0 t=2.3e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=1 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=4 t=1.7e-04 per=1.1e+01 cost=7.8e+04 flops=4.8e+08
 sigma[gemm] counter=19 i=5 t=1.8e-04 per=1.2e+01 cost=8.1e+04 flops=4.6e+08
 sigma[gemm] counter=19 i=6 t=1.3e-04 per=9.1e+00 cost=1.1e+05 flops=8.3e+08
 sigma[gemm] counter=19 i=7 t=1.3e-04 per=8.9e+00 cost=1.2e+05 flops=9.2e+08
 sigma[gemm] counter=19 total t=6.1e-04 per=4.2e+01 cost=3.9e+05 flops=6.4e+08
 sigma[red] counter=19 t=7.4e-04 per=5.0e+01 cost=1.0e+05 flops=1.4e+08
--- TIMING FOR sigma_tot : t_inter=1.8e-03 t_gemm=7.2e-03 t_reduction=1.1e-02 tot=2.0e-02 ---
 sigma_tot[inter] counter=19 t=1.8e-03 per=9.1e+00 cost=1.6e+06 flops=8.9e+08
 sigma_tot[gemm] counter=19 i=0 t=4.8e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=1 t=4.3e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=2 t=4.2e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=3 t=4.2e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=4 t=1.9e-03 per=9.3e+00 cost=2.9e+05 flops=1.6e+08
 sigma_tot[gemm] counter=19 i=5 t=1.9e-03 per=9.4e+00 cost=3.0e+05 flops=1.6e+08
 sigma_tot[gemm] counter=19 i=6 t=1.7e-03 per=8.7e+00 cost=3.8e+05 flops=2.2e+08
 sigma_tot[gemm] counter=19 i=7 t=1.6e-03 per=7.9e+00 cost=4.1e+05 flops=2.6e+08
 sigma_tot[gemm] counter=19 total t=7.2e-03 per=3.6e+01 cost=1.4e+06 flops=1.9e+08
 sigma_tot[red] counter=19 t=1.1e-02 per=5.5e+01 cost=3.9e+05 flops=3.5e+07
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.2e-05,1.8e-06,1.1e-06,1.6e-07
    3   0 -    -116.216231819044 -3.867e-05  1.098e-03    3     3  1.182e-02 3.939e-03 3.631e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.687e-05,1.155e-04,5.937e-04,7.186e-04,1.460e-03
 ndim=119:8.866e-07GB t[comm(intra)]=2.186e-05 speed=8.113e-02GB/S t[comm(inter)]=5.008e-06 speed=3.541e-01GB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=5.9e-04 t_reduction=7.2e-04 tot=1.4e-03 ---
 sigma[inter] counter=20 t=1.2e-04 per=8.1e+00 cost=4.6e+05 flops=4.0e+09
 sigma[gemm] counter=20 i=0 t=2.4e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=1 t=2.3e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=3 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=4 t=1.6e-04 per=1.1e+01 cost=7.8e+04 flops=4.9e+08
 sigma[gemm] counter=20 i=5 t=1.7e-04 per=1.2e+01 cost=8.1e+04 flops=4.9e+08
 sigma[gemm] counter=20 i=6 t=1.3e-04 per=8.9e+00 cost=1.1e+05 flops=8.7e+08
 sigma[gemm] counter=20 i=7 t=1.3e-04 per=9.3e+00 cost=1.2e+05 flops=9.1e+08
 sigma[gemm] counter=20 total t=5.9e-04 per=4.2e+01 cost=3.9e+05 flops=6.6e+08
 sigma[red] counter=20 t=7.2e-04 per=5.0e+01 cost=1.0e+05 flops=1.4e+08
--- TIMING FOR sigma_tot : t_inter=1.9e-03 t_gemm=7.8e-03 t_reduction=1.2e-02 tot=2.1e-02 ---
 sigma_tot[inter] counter=20 t=1.9e-03 per=9.0e+00 cost=2.1e+06 flops=1.1e+09
 sigma_tot[gemm] counter=20 i=0 t=5.0e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=1 t=4.5e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=2 t=4.4e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=3 t=4.4e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=4 t=2.0e-03 per=9.4e+00 cost=3.7e+05 flops=1.8e+08
 sigma_tot[gemm] counter=20 i=5 t=2.0e-03 per=9.5e+00 cost=3.8e+05 flops=1.9e+08
 sigma_tot[gemm] counter=20 i=6 t=1.9e-03 per=8.7e+00 cost=4.9e+05 flops=2.6e+08
 sigma_tot[gemm] counter=20 i=7 t=1.7e-03 per=8.0e+00 cost=5.3e+05 flops=3.1e+08
 sigma_tot[gemm] counter=20 total t=7.8e-03 per=3.7e+01 cost=1.8e+06 flops=2.3e+08
 sigma_tot[red] counter=20 t=1.2e-02 per=5.4e+01 cost=4.9e+05 flops=4.2e+07
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.1e-05,1.6e-06,9.2e-07,1.6e-07
    4   0 -    -116.216235377586 -3.559e-06  3.848e-04    3     4  1.541e-02 3.853e-03 3.574e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.729e-05,1.142e-04,5.670e-04,7.331e-04,1.446e-03
 ndim=119:8.866e-07GB t[comm(intra)]=2.201e-05 speed=8.058e-02GB/S t[comm(inter)]=5.282e-06 speed=3.357e-01GB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=5.7e-04 t_reduction=7.3e-04 tot=1.4e-03 ---
 sigma[inter] counter=21 t=1.1e-04 per=8.1e+00 cost=4.6e+05 flops=4.0e+09
 sigma[gemm] counter=21 i=0 t=2.3e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=1 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=2 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=4 t=1.5e-04 per=1.1e+01 cost=7.8e+04 flops=5.1e+08
 sigma[gemm] counter=21 i=5 t=1.6e-04 per=1.1e+01 cost=8.1e+04 flops=5.1e+08
 sigma[gemm] counter=21 i=6 t=1.2e-04 per=8.6e+00 cost=1.1e+05 flops=9.1e+08
 sigma[gemm] counter=21 i=7 t=1.2e-04 per=8.7e+00 cost=1.2e+05 flops=9.8e+08
 sigma[gemm] counter=21 total t=5.7e-04 per=4.0e+01 cost=3.9e+05 flops=6.9e+08
 sigma[red] counter=21 t=7.3e-04 per=5.2e+01 cost=1.0e+05 flops=1.4e+08
--- TIMING FOR sigma_tot : t_inter=2.0e-03 t_gemm=8.4e-03 t_reduction=1.2e-02 tot=2.3e-02 ---
 sigma_tot[inter] counter=21 t=2.0e-03 per=9.0e+00 cost=2.5e+06 flops=1.2e+09
 sigma_tot[gemm] counter=21 i=0 t=5.2e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=1 t=4.7e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=2 t=4.7e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=3 t=4.6e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=4 t=2.2e-03 per=9.5e+00 cost=4.5e+05 flops=2.1e+08
 sigma_tot[gemm] counter=21 i=5 t=2.2e-03 per=9.7e+00 cost=4.6e+05 flops=2.1e+08
 sigma_tot[gemm] counter=21 i=6 t=2.0e-03 per=8.7e+00 cost=6.0e+05 flops=3.0e+08
 sigma_tot[gemm] counter=21 i=7 t=1.8e-03 per=8.1e+00 cost=6.5e+05 flops=3.5e+08
 sigma_tot[gemm] counter=21 total t=8.4e-03 per=3.7e+01 cost=2.2e+06 flops=2.6e+08
 sigma_tot[red] counter=21 t=1.2e-02 per=5.4e+01 cost=5.9e+05 flops=4.8e+07
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.1e-05,1.7e-06,9.1e-07,1.4e-07
    5   0 -    -116.216235753288 -3.757e-07  1.510e-04    3     5  1.899e-02 3.798e-03 3.537e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.811e-05,1.193e-04,5.895e-04,7.300e-04,1.471e-03
 ndim=119:8.866e-07GB t[comm(intra)]=2.267e-05 speed=7.823e-02GB/S t[comm(inter)]=5.439e-06 speed=3.260e-01GB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=5.9e-04 t_reduction=7.3e-04 tot=1.4e-03 ---
 sigma[inter] counter=22 t=1.2e-04 per=8.3e+00 cost=4.6e+05 flops=3.9e+09
 sigma[gemm] counter=22 i=0 t=2.3e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=1 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=4 t=1.6e-04 per=1.1e+01 cost=7.8e+04 flops=5.0e+08
 sigma[gemm] counter=22 i=5 t=1.7e-04 per=1.2e+01 cost=8.1e+04 flops=4.9e+08
 sigma[gemm] counter=22 i=6 t=1.3e-04 per=8.8e+00 cost=1.1e+05 flops=8.8e+08
 sigma[gemm] counter=22 i=7 t=1.3e-04 per=9.1e+00 cost=1.2e+05 flops=9.2e+08
 sigma[gemm] counter=22 total t=5.9e-04 per=4.1e+01 cost=3.9e+05 flops=6.6e+08
 sigma[red] counter=22 t=7.3e-04 per=5.1e+01 cost=1.0e+05 flops=1.4e+08
--- TIMING FOR sigma_tot : t_inter=2.2e-03 t_gemm=9.0e-03 t_reduction=1.3e-02 tot=2.4e-02 ---
 sigma_tot[inter] counter=22 t=2.2e-03 per=8.9e+00 cost=3.0e+06 flops=1.4e+09
 sigma_tot[gemm] counter=22 i=0 t=5.5e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=1 t=4.9e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=2 t=4.9e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=3 t=4.8e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=4 t=2.3e-03 per=9.6e+00 cost=5.2e+05 flops=2.3e+08
 sigma_tot[gemm] counter=22 i=5 t=2.4e-03 per=9.8e+00 cost=5.4e+05 flops=2.3e+08
 sigma_tot[gemm] counter=22 i=6 t=2.1e-03 per=8.7e+00 cost=7.1e+05 flops=3.4e+08
 sigma_tot[gemm] counter=22 i=7 t=2.0e-03 per=8.1e+00 cost=7.7e+05 flops=3.9e+08
 sigma_tot[gemm] counter=22 total t=9.0e-03 per=3.7e+01 cost=2.5e+06 flops=2.8e+08
 sigma_tot[red] counter=22 t=1.3e-02 per=5.4e+01 cost=6.9e+05 flops=5.3e+07
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.1e-05,1.6e-06,9.7e-07,1.7e-07
    6   0 +    -116.216235822396 -6.911e-08  5.084e-05    3     6  2.265e-02 3.776e-03 3.528e-03
TIMING FOR Davidson : 2.273e-02  T(cal/comm/rest)=2.117e-02,2.980e-07,1.558e-03
decomposed t_rest=1.558e-03
 T(sub)    =9.815e-05 per=6.300e+00
 T(precond)=2.004e-04 per=1.286e+01
 T(ortho)  =1.015e-05 per=6.514e-01
 T(xcopy)  =6.730e-07 per=4.320e-02
 T(xnrm2)  =1.109e-06 per=7.118e-02
 T(other)  =1.248e-03 per=8.007e+01
optimized energies: isweep=0 ibond=3 dots=2 e[0]=-116.216235822396 nmvp=6
CPUmem: VM:7.248e+01GB RSS:5.593e-01GB  Timing: User:6.881e+00S Sys:1.125e+00S Total:8.005e+00S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=8 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=8 dimAll=28
 (7,1):6 (9,1):3 (8,0):3 (8,2):6 (6,2):4 (7,3):4 (5,3):1 (6,4):1
----- TMING FOR decimation_genbasis(su2): 8.1e-05 S -----
decimation summary: 28->10 dwt=+1.070e-06 SvN=4.910e-01
 qbond: qkept nsym=6 dimAll=10
 (8,2):3 (7,1):2 (7,3):2 (9,1):1 (6,2):1 (6,4):1
----- TIMING for decimation_row(nkr): 3.200e-03 S T(decim/select/formRot)=3.889e-04,2.659e-03,1.520e-04 -----
----- TIMING FOR twodot_decimation: 3.432e-03 S T(wf/decim)=1.536e-04,3.279e-03 -----
ctns::oper_renorm coord=(4,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:5 S:15 H:1 A:25 B:30 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1365:1.041e-02MB:1.017e-05GB
CPUmem: VM:7.248e+01GB RSS:5.593e-01GB  Timing: User:6.979e+00S Sys:1.125e+00S Total:8.103e+00S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=76 : 2.640e-04 S -----
rank=0 GPUmem(GB): used=4.83e-05 (oper)=2.25e-05
rank=0 GPUmem(GB): used=4.87e-05 (oper,site)(GB)=2.25e-05,3.43e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=76
 no. of rintermediate operators=140
 no. of coefficients=1070:0.00816MB:7.97e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.276e-04 S -----
rank=0 GPUmem(GB): used=5.67e-05 (oper,site,rinter)=2.25e-05,3.43e-07,7.97e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0013 S size(rtasks)=76 size(Rlst2)=36 T(Rmu/Rlist)=7.72e-05,0.00122 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00142 S size(rtasks)=76 size(Rlst)=1481 -----
rank=0 GPUmem(GB): used=5.67e-05 (oper,site,rinter,batch)=2.25e-05,3.43e-07,7.97e-06,0.000309 blksize=9 blksize0=9 batchsize=1481
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000128,0.000565,0.000289
--- TIMING FOR renorm : t_inter=1.3e-04 t_gemm=5.6e-04 t_reduction=2.9e-04 tot=9.8e-04 ---
 renorm[inter] counter=4 t=1.3e-04 per=1.3e+01 cost=8.4e+04 flops=6.5e+08
 renorm[gemm] counter=4 i=0 t=2.8e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=1 t=2.2e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=2 t=2.2e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=3 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=4 t=2.0e-04 per=2.0e+01 cost=1.5e+04 flops=7.3e+07
 renorm[gemm] counter=4 i=5 t=1.6e-04 per=1.6e+01 cost=2.2e+04 flops=1.4e+08
 renorm[gemm] counter=4 i=6 t=2.0e-04 per=2.0e+01 cost=2.8e+04 flops=1.4e+08
 renorm[gemm] counter=4 total t=5.6e-04 per=5.8e+01 cost=6.5e+04 flops=1.1e+08
 renorm[red] counter=4 t=2.9e-04 per=2.9e+01 cost=1.1e+04 flops=3.8e+07
--- TIMING FOR renorm_tot : t_inter=3.7e-04 t_gemm=1.3e-03 t_reduction=6.6e-04 tot=2.3e-03 ---
 renorm_tot[inter] counter=4 t=3.7e-04 per=1.6e+01 cost=9.0e+04 flops=2.4e+08
 renorm_tot[gemm] counter=4 i=0 t=1.1e-05 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=1 t=9.0e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=2 t=8.8e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=3 t=8.7e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=4 t=4.4e-04 per=1.9e+01 cost=1.7e+04 flops=3.9e+07
 renorm_tot[gemm] counter=4 i=5 t=3.8e-04 per=1.6e+01 cost=2.5e+04 flops=6.7e+07
 renorm_tot[gemm] counter=4 i=6 t=4.3e-04 per=1.9e+01 cost=3.9e+04 flops=9.1e+07
 renorm_tot[gemm] counter=4 total t=1.3e-03 per=5.5e+01 cost=8.2e+04 flops=6.4e+07
 renorm_tot[red] counter=4 t=6.6e-04 per=2.9e+01 cost=1.9e+04 flops=2.8e+07
qops.to_cpu: size(tot)=1365:1.0e-02MB:1.0e-05GB t[to_cpu]=1.7e-05S speed=5.8e-01GB/S
check ||H-H.dagger||=6.793e-15 coord=(4,0) rank=0
ctns::oper_ab2pq coord=(4,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00644 S rank=0 -----
CPUmem: VM:7.248e+01GB RSS:5.595e-01GB  Timing: User:7.228e+00S Sys:1.125e+00S Total:8.353e+00S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=876:6.683e-03MB:6.527e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=49:3.738e-04MB:3.651e-07GB
total mem of comb=926:7.065e-03MB:6.899e-06GB
CPUmem: VM:7.248e+01GB RSS:5.595e-01GB  Timing: User:7.230e+00S Sys:1.125e+00S Total:8.355e+00S
##### local opt: 6.892e-02 S #####
 T(local opt: fetch) = 5.902e-03 S  per = 8.56  per(accum) = 8.56
 T(local opt: hdiag) = 3.527e-03 S  per = 5.12  per(accum) = 13.7
 T(local opt: dvdsn) = 4.418e-02 S  per = 64.1  per(accum) = 77.8
 T(local opt: decim) = 3.513e-03 S  per =  5.1  per(accum) = 82.9
 T(local opt: guess) = 1.268e-04 S  per = 0.184  per(accum) = 83.1
 T(local opt: renrm) = 7.318e-03 S  per = 10.6  per(accum) = 93.7
 T(local opt: save ) = 4.351e-03 S  per = 6.31  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.418e-02 S  T(sum) = 4.324e-02 S  per = 9.788e+01
 T(local opt: preprocess                  ) = 6.505e-04 S  per =  1.5  per(accum) = 1.5
 T(local opt: symbolic_formulae           ) = 8.242e-04 S  per = 1.91  per(accum) = 3.41
 T(local opt: hintermediate init          ) = 5.896e-04 S  per = 1.36  per(accum) = 4.77
 T(local opt: preprocess_hformulae_Hxlist ) = 1.538e-02 S  per = 35.6  per(accum) = 40.3
 T(local opt: hmmtasks init               ) = 2.835e-03 S  per = 6.56  per(accum) = 46.9
 T(local opt: initial guess for dvdson    ) = 2.381e-04 S  per = 0.551  per(accum) = 47.4
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.100e-02 S  per = 48.6  per(accum) = 96
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.703e-04 S  per = 0.394  per(accum) = 96.4
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.980e-07 S  per = 0.000689  per(accum) = 96.4
 T(local opt: dvdson solver [rest part]   ) = 1.558e-03 S  per =  3.6  per(accum) = 100
Detailed decomposition of T(renrm) = 7.318e-03 S  T(sum) = 7.318e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.168e-04 S  per =  1.6  per(accum) = 1.6
 T(local opt: qops init                    ) = 4.600e-04 S  per = 6.29  per(accum) = 7.88
 T(local opt: symbolic_formulae_renorm     ) = 3.361e-04 S  per = 4.59  per(accum) = 12.5
 T(local opt: allocate qops on gpu         ) = 9.849e-05 S  per = 1.35  per(accum) = 13.8
 T(local opt: site memcpy cpu2gpu          ) = 8.512e-05 S  per = 1.16  per(accum) = 15
 T(local opt: rintermediate init           ) = 4.845e-04 S  per = 6.62  per(accum) = 21.6
 T(local opt: preprocess_formulae_Rlist2   ) = 1.501e-03 S  per = 20.5  per(accum) = 42.1
 T(local opt: rmmtasks init                ) = 5.120e-04 S  per =    7  per(accum) = 49.1
 T(local opt: qops memset on cpu           ) = 5.200e-08 S  per = 0.000711  per(accum) = 49.1
 T(local opt: preprocess_renorm_batchGPU   ) = 2.749e-03 S  per = 37.6  per(accum) = 86.7
 T(local opt: reduction of opS & opH [nccl]) = 5.630e-07 S  per = 0.00769  per(accum) = 86.7
 T(local opt: qops memcpy gpu2cpu          ) = 9.532e-05 S  per =  1.3  per(accum) = 88
 T(local opt: deallocate cpu and gpu memory) = 1.848e-05 S  per = 0.253  per(accum) = 88.2
 T(local opt: reduction of opS & opH [comm]) = 9.680e-05 S  per = 1.32  per(accum) = 89.6
 T(local opt: conversion from opAB to opPQ ) = 7.686e-05 S  per = 1.05  per(accum) = 90.6
 T(local opt: after oper_renorm            ) = 6.864e-04 S  per = 9.38  per(accum) = 100
##### sweep opt: 2.023e-01 S #####
 T(sweep opt: fetch) = 3.026e-02 S  per =   15  per(accum) = 15
 T(sweep opt: hdiag) = 9.170e-03 S  per = 4.53  per(accum) = 19.5
 T(sweep opt: dvdsn) = 1.105e-01 S  per = 54.7  per(accum) = 74.1
 T(sweep opt: decim) = 1.185e-02 S  per = 5.86  per(accum) = 80
 T(sweep opt: guess) = 4.119e-04 S  per = 0.204  per(accum) = 80.2
 T(sweep opt: renrm) = 2.287e-02 S  per = 11.3  per(accum) = 91.5
 T(sweep opt: save ) = 1.716e-02 S  per = 8.49  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.105e-01 S  T(sum) = 1.073e-01 S  per = 9.707e+01
 T(sweep opt: preprocess                  ) = 2.502e-03 S  per = 2.33  per(accum) = 2.33
 T(sweep opt: symbolic_formulae           ) = 2.542e-03 S  per = 2.37  per(accum) = 4.7
 T(sweep opt: hintermediate init          ) = 2.272e-03 S  per = 2.12  per(accum) = 6.82
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.117e-02 S  per = 19.7  per(accum) = 26.5
 T(sweep opt: hmmtasks init               ) = 3.771e-03 S  per = 3.51  per(accum) = 30.1
 T(sweep opt: initial guess for dvdson    ) = 8.326e-04 S  per = 0.776  per(accum) = 30.8
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 6.794e-02 S  per = 63.3  per(accum) = 94.1
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 6.169e-04 S  per = 0.575  per(accum) = 94.7
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.070e-06 S  per = 0.000997  per(accum) = 94.7
 T(sweep opt: dvdson solver [rest part]   ) = 5.668e-03 S  per = 5.28  per(accum) = 100
Detailed decomposition of T(renrm) = 2.287e-02 S  T(sum) = 2.287e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.346e-04 S  per =  1.9  per(accum) = 1.9
 T(sweep opt: qops init                    ) = 1.395e-03 S  per =  6.1  per(accum) = 8
 T(sweep opt: symbolic_formulae_renorm     ) = 1.122e-03 S  per = 4.91  per(accum) = 12.9
 T(sweep opt: allocate qops on gpu         ) = 3.805e-04 S  per = 1.66  per(accum) = 14.6
 T(sweep opt: site memcpy cpu2gpu          ) = 3.408e-04 S  per = 1.49  per(accum) = 16.1
 T(sweep opt: rintermediate init           ) = 1.808e-03 S  per = 7.91  per(accum) = 24
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.059e-03 S  per = 13.4  per(accum) = 37.3
 T(sweep opt: rmmtasks init                ) = 1.071e-03 S  per = 4.68  per(accum) = 42
 T(sweep opt: qops memset on cpu           ) = 1.610e-07 S  per = 0.000704  per(accum) = 42
 T(sweep opt: preprocess_renorm_batchGPU   ) = 9.337e-03 S  per = 40.8  per(accum) = 82.9
 T(sweep opt: reduction of opS & opH [nccl]) = 2.096e-06 S  per = 0.00917  per(accum) = 82.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.679e-04 S  per = 1.61  per(accum) = 84.5
 T(sweep opt: deallocate cpu and gpu memory) = 4.709e-05 S  per = 0.206  per(accum) = 84.7
 T(sweep opt: reduction of opS & opH [comm]) = 3.521e-04 S  per = 1.54  per(accum) = 86.2
 T(sweep opt: conversion from opAB to opPQ ) = 3.097e-04 S  per = 1.35  per(accum) = 87.6
 T(sweep opt: after oper_renorm            ) = 2.839e-03 S  per = 12.4  per(accum) = 100
##### global opt: 2.023e-01 S #####
 T(global opt: fetch) = 3.026e-02 S  per =   15  per(accum) = 15
 T(global opt: hdiag) = 9.170e-03 S  per = 4.53  per(accum) = 19.5
 T(global opt: dvdsn) = 1.105e-01 S  per = 54.7  per(accum) = 74.1
 T(global opt: decim) = 1.185e-02 S  per = 5.86  per(accum) = 80
 T(global opt: guess) = 4.119e-04 S  per = 0.204  per(accum) = 80.2
 T(global opt: renrm) = 2.287e-02 S  per = 11.3  per(accum) = 91.5
 T(global opt: save ) = 1.716e-02 S  per = 8.49  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.105e-01 S  T(sum) = 1.073e-01 S  per = 9.707e+01
 T(global opt: preprocess                  ) = 2.502e-03 S  per = 2.33  per(accum) = 2.33
 T(global opt: symbolic_formulae           ) = 2.542e-03 S  per = 2.37  per(accum) = 4.7
 T(global opt: hintermediate init          ) = 2.272e-03 S  per = 2.12  per(accum) = 6.82
 T(global opt: preprocess_hformulae_Hxlist ) = 2.117e-02 S  per = 19.7  per(accum) = 26.5
 T(global opt: hmmtasks init               ) = 3.771e-03 S  per = 3.51  per(accum) = 30.1
 T(global opt: initial guess for dvdson    ) = 8.326e-04 S  per = 0.776  per(accum) = 30.8
 T(global opt: dvdson solver [Hx_batchGPU] ) = 6.794e-02 S  per = 63.3  per(accum) = 94.1
 T(global opt: dvdson solver [comm(gpu)]   ) = 6.169e-04 S  per = 0.575  per(accum) = 94.7
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.070e-06 S  per = 0.000997  per(accum) = 94.7
 T(global opt: dvdson solver [rest part]   ) = 5.668e-03 S  per = 5.28  per(accum) = 100
Detailed decomposition of T(renrm) = 2.287e-02 S  T(sum) = 2.287e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.346e-04 S  per =  1.9  per(accum) = 1.9
 T(global opt: qops init                    ) = 1.395e-03 S  per =  6.1  per(accum) = 8
 T(global opt: symbolic_formulae_renorm     ) = 1.122e-03 S  per = 4.91  per(accum) = 12.9
 T(global opt: allocate qops on gpu         ) = 3.805e-04 S  per = 1.66  per(accum) = 14.6
 T(global opt: site memcpy cpu2gpu          ) = 3.408e-04 S  per = 1.49  per(accum) = 16.1
 T(global opt: rintermediate init           ) = 1.808e-03 S  per = 7.91  per(accum) = 24
 T(global opt: preprocess_formulae_Rlist2   ) = 3.059e-03 S  per = 13.4  per(accum) = 37.3
 T(global opt: rmmtasks init                ) = 1.071e-03 S  per = 4.68  per(accum) = 42
 T(global opt: qops memset on cpu           ) = 1.610e-07 S  per = 0.000704  per(accum) = 42
 T(global opt: preprocess_renorm_batchGPU   ) = 9.337e-03 S  per = 40.8  per(accum) = 82.9
 T(global opt: reduction of opS & opH [nccl]) = 2.096e-06 S  per = 0.00917  per(accum) = 82.9
 T(global opt: qops memcpy gpu2cpu          ) = 3.679e-04 S  per = 1.61  per(accum) = 84.5
 T(global opt: deallocate cpu and gpu memory) = 4.709e-05 S  per = 0.206  per(accum) = 84.7
 T(global opt: reduction of opS & opH [comm]) = 3.521e-04 S  per = 1.54  per(accum) = 86.2
 T(global opt: conversion from opAB to opPQ ) = 3.097e-04 S  per = 1.35  per(accum) = 87.6
 T(global opt: after oper_renorm            ) = 2.839e-03 S  per = 12.4  per(accum) = 100

isweep=0 ibond=4/seqsize=34 dots=2 dbond=(5,0)-(6,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.248e+01GB RSS:5.595e-01GB  Timing: User:7.231e+00S Sys:1.125e+00S Total:8.356e+00S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=876:6.683e-03MB:6.527e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=49:3.738e-04MB:3.651e-07GB
total mem of comb=926:7.065e-03MB:6.899e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=5,13,1,1
 suppl= 0 1 2 3 4
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 16
 suppc2= 17
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:5 S:15 H:1 A:25 B:30 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1365:1.041e-02MB:1.017e-05GB
 rqops: oplist=CSHPQ nops=C:13 S:7 H:1 P:49 Q:56 
        dim(bra,ket)=19,19 size(op)=176:1.343e-03MB size(tot)=7507:5.727e-02MB:5.593e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=10868:8.292e-02MB:8.097e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(5,0) fdel=./scratch/sweep/rop(6,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
wf4(diml,dimr,dimc1,dimc2)=(10,19,3,3) nnz=225:1.717e-03MB
qtensor4: wf4 own=1 _data=0x55a3228f5950
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (8,2):3 (7,1):2 (7,3):2 (9,1):1 (6,2):1 (6,4):1
 qbond: qcol nsym=7 dimAll=19
 (20,0):3 (20,2):5 (20,4):5 (20,6):3 (21,1):1 (21,3):1 (21,5):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=44 nblocks=648 size=225:1.717e-03MB
### DIAG TIMING: total=5.627e-03 t1=1.021e-05, t2=2.253e-05, t3=2.097e-05, t4=5.546e-03, t5=4.874e-06, t6=1.776e-05, t7=4.173e-06
duration_diagGPU:5.721e-03
duration_diagreduce:2.700e-08
duration_diagtransform:3.510e-07
----- TIMING FOR symbolic_formulae_twodot with size=516 : 9.079e-04 S -----
rank=0 GPUmem(GB): used=8.1e-05 (oper)=8.1e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=516
 no. of hintermediate operators=269
 no. of coefficients=3269:0.0249MB:2.44e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.425e-04 S -----
rank=0 GPUmem(GB): used=0.000105 (oper,hinter)=8.1e-05,2.44e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0502 S size(H_formulae)=516 size(Hxlst2)=44 T(Hmu/Hxlist)=0.000175,0.0501 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0529 S size(H_formulae)=516 size(Hxlst)=29432 -----
rank=0 GPUmem(GB): used=0.00888 (oper,hinter,dvdson,batch)=8.1e-05,2.44e-05,3.35e-06,0.00877 blksize=15 blksize0=9 batchsize=29432
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=225 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.68e-05,0.0003,0.00181,0.0016,0.00375
 ndim=225:1.68e-06GB t[comm(intra)]=2.92e-05 speed=0.115GB/S t[comm(inter)]=7.65e-06 speed=0.438GB/S
--- TIMING FOR sigma : t_inter=3.0e-04 t_gemm=1.8e-03 t_reduction=1.6e-03 tot=3.7e-03 ---
 sigma[inter] counter=23 t=3.0e-04 per=8.1e+00 cost=1.5e+06 flops=5.1e+09
 sigma[gemm] counter=23 i=0 t=2.8e-06 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=1 t=2.2e-06 per=5.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=2 t=2.2e-06 per=5.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=3 t=2.2e-06 per=5.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=4 t=4.5e-04 per=1.2e+01 cost=3.1e+05 flops=6.9e+08
 sigma[gemm] counter=23 i=5 t=5.0e-04 per=1.3e+01 cost=3.2e+05 flops=6.4e+08
 sigma[gemm] counter=23 i=6 t=4.4e-04 per=1.2e+01 cost=2.8e+05 flops=6.4e+08
 sigma[gemm] counter=23 i=7 t=4.1e-04 per=1.1e+01 cost=3.3e+05 flops=8.0e+08
 sigma[gemm] counter=23 total t=1.8e-03 per=4.9e+01 cost=1.2e+06 flops=6.8e+08
 sigma[red] counter=23 t=1.6e-03 per=4.3e+01 cost=3.3e+05 flops=2.1e+08
--- TIMING FOR sigma_tot : t_inter=2.5e-03 t_gemm=1.1e-02 t_reduction=1.5e-02 tot=2.8e-02 ---
 sigma_tot[inter] counter=23 t=2.5e-03 per=8.8e+00 cost=4.5e+06 flops=1.8e+09
 sigma_tot[gemm] counter=23 i=0 t=5.8e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=1 t=5.2e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=2 t=5.1e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=3 t=5.0e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=4 t=2.8e-03 per=9.9e+00 cost=8.3e+05 flops=3.0e+08
 sigma_tot[gemm] counter=23 i=5 t=2.9e-03 per=1.0e+01 cost=8.6e+05 flops=3.0e+08
 sigma_tot[gemm] counter=23 i=6 t=2.6e-03 per=9.2e+00 cost=9.9e+05 flops=3.9e+08
 sigma_tot[gemm] counter=23 i=7 t=2.4e-03 per=8.5e+00 cost=1.1e+06 flops=4.6e+08
 sigma_tot[gemm] counter=23 total t=1.1e-02 per=3.9e+01 cost=3.8e+06 flops=3.5e+08
 sigma_tot[red] counter=23 t=1.5e-02 per=5.3e+01 cost=1.0e+06 flops=6.9e+07
T(sub)=8.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,3.5e-06,1.0e-06,8.4e-07,2.3e-07
settings: ndim=225 neig=1 maxcycle=30 nbuff=4 memory=3e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.216235107147 -1.116e+03  1.315e-02    1     1  6.012e-03 6.012e-03 5.814e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.968e-05,2.301e-04,1.185e-03,1.378e-03,2.828e-03
 ndim=225:1.676e-06GB t[comm(intra)]=2.369e-05 speed=1.415e-01GB/S t[comm(inter)]=5.987e-06 speed=5.600e-01GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=1.2e-03 t_reduction=1.4e-03 tot=2.8e-03 ---
 sigma[inter] counter=24 t=2.3e-04 per=8.2e+00 cost=1.5e+06 flops=6.7e+09
 sigma[gemm] counter=24 i=0 t=2.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=1 t=2.2e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=2 t=2.2e-06 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=3 t=2.2e-06 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=4 t=3.0e-04 per=1.1e+01 cost=3.1e+05 flops=1.0e+09
 sigma[gemm] counter=24 i=5 t=3.0e-04 per=1.1e+01 cost=3.2e+05 flops=1.1e+09
 sigma[gemm] counter=24 i=6 t=2.9e-04 per=1.0e+01 cost=2.8e+05 flops=1.0e+09
 sigma[gemm] counter=24 i=7 t=3.0e-04 per=1.1e+01 cost=3.3e+05 flops=1.1e+09
 sigma[gemm] counter=24 total t=1.2e-03 per=4.2e+01 cost=1.2e+06 flops=1.0e+09
 sigma[red] counter=24 t=1.4e-03 per=4.9e+01 cost=3.3e+05 flops=2.4e+08
--- TIMING FOR sigma_tot : t_inter=2.7e-03 t_gemm=1.2e-02 t_reduction=1.6e-02 tot=3.1e-02 ---
 sigma_tot[inter] counter=24 t=2.7e-03 per=8.8e+00 cost=6.1e+06 flops=2.3e+09
 sigma_tot[gemm] counter=24 i=0 t=6.0e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=1 t=5.4e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=2 t=5.3e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=3 t=5.3e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=4 t=3.1e-03 per=1.0e+01 cost=1.1e+06 flops=3.7e+08
 sigma_tot[gemm] counter=24 i=5 t=3.2e-03 per=1.0e+01 cost=1.2e+06 flops=3.7e+08
 sigma_tot[gemm] counter=24 i=6 t=2.8e-03 per=9.3e+00 cost=1.3e+06 flops=4.5e+08
 sigma_tot[gemm] counter=24 i=7 t=2.7e-03 per=8.7e+00 cost=1.4e+06 flops=5.3e+08
 sigma_tot[gemm] counter=24 total t=1.2e-02 per=3.9e+01 cost=5.0e+06 flops=4.2e+08
 sigma_tot[red] counter=24 t=1.6e-02 per=5.2e+01 cost=1.3e+06 flops=8.4e+07
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=7.2e-06,9.9e-06,2.4e-06,1.6e-06,2.3e-07
    2   0 -    -116.217230900952 -9.958e-04  5.902e-03    2     2  1.128e-02 5.640e-03 5.304e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.888e-05,2.209e-04,1.177e-03,1.359e-03,2.792e-03
 ndim=225:1.676e-06GB t[comm(intra)]=2.319e-05 speed=1.446e-01GB/S t[comm(inter)]=5.688e-06 speed=5.894e-01GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=1.2e-03 t_reduction=1.4e-03 tot=2.8e-03 ---
 sigma[inter] counter=25 t=2.2e-04 per=8.0e+00 cost=1.5e+06 flops=7.0e+09
 sigma[gemm] counter=25 i=0 t=2.7e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=1 t=2.2e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=2 t=2.2e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=3 t=2.2e-06 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=4 t=2.9e-04 per=1.1e+01 cost=3.1e+05 flops=1.1e+09
 sigma[gemm] counter=25 i=5 t=3.0e-04 per=1.1e+01 cost=3.2e+05 flops=1.1e+09
 sigma[gemm] counter=25 i=6 t=2.9e-04 per=1.0e+01 cost=2.8e+05 flops=9.8e+08
 sigma[gemm] counter=25 i=7 t=2.9e-04 per=1.0e+01 cost=3.3e+05 flops=1.1e+09
 sigma[gemm] counter=25 total t=1.2e-03 per=4.3e+01 cost=1.2e+06 flops=1.1e+09
 sigma[red] counter=25 t=1.4e-03 per=4.9e+01 cost=3.3e+05 flops=2.4e+08
--- TIMING FOR sigma_tot : t_inter=2.9e-03 t_gemm=1.3e-02 t_reduction=1.7e-02 tot=3.3e-02 ---
 sigma_tot[inter] counter=25 t=2.9e-03 per=8.7e+00 cost=7.6e+06 flops=2.6e+09
 sigma_tot[gemm] counter=25 i=0 t=6.3e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=1 t=5.6e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=2 t=5.5e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=3 t=5.5e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=4 t=3.4e-03 per=1.0e+01 cost=1.4e+06 flops=4.3e+08
 sigma_tot[gemm] counter=25 i=5 t=3.5e-03 per=1.0e+01 cost=1.5e+06 flops=4.3e+08
 sigma_tot[gemm] counter=25 i=6 t=3.1e-03 per=9.4e+00 cost=1.6e+06 flops=5.0e+08
 sigma_tot[gemm] counter=25 i=7 t=3.0e-03 per=8.9e+00 cost=1.8e+06 flops=5.9e+08
 sigma_tot[gemm] counter=25 total t=1.3e-02 per=3.9e+01 cost=6.3e+06 flops=4.8e+08
 sigma_tot[red] counter=25 t=1.7e-02 per=5.2e+01 cost=1.7e+06 flops=9.6e+07
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.5e-06,1.3e-05,1.9e-06,1.2e-06,1.7e-07
    3   0 -    -116.217352341305 -1.214e-04  2.403e-03    3     3  1.628e-02 5.427e-03 5.119e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.824e-05,2.351e-04,1.184e-03,1.349e-03,2.801e-03
 ndim=225:1.676e-06GB t[comm(intra)]=2.241e-05 speed=1.496e-01GB/S t[comm(inter)]=5.825e-06 speed=5.756e-01GB/S
--- TIMING FOR sigma : t_inter=2.4e-04 t_gemm=1.2e-03 t_reduction=1.3e-03 tot=2.8e-03 ---
 sigma[inter] counter=26 t=2.4e-04 per=8.5e+00 cost=1.5e+06 flops=6.5e+09
 sigma[gemm] counter=26 i=0 t=2.7e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=1 t=2.2e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=2 t=2.2e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=3 t=2.2e-06 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=4 t=2.9e-04 per=1.0e+01 cost=3.1e+05 flops=1.1e+09
 sigma[gemm] counter=26 i=5 t=3.0e-04 per=1.1e+01 cost=3.2e+05 flops=1.0e+09
 sigma[gemm] counter=26 i=6 t=2.9e-04 per=1.0e+01 cost=2.8e+05 flops=9.8e+08
 sigma[gemm] counter=26 i=7 t=2.9e-04 per=1.1e+01 cost=3.3e+05 flops=1.1e+09
 sigma[gemm] counter=26 total t=1.2e-03 per=4.3e+01 cost=1.2e+06 flops=1.0e+09
 sigma[red] counter=26 t=1.3e-03 per=4.9e+01 cost=3.3e+05 flops=2.4e+08
--- TIMING FOR sigma_tot : t_inter=3.1e-03 t_gemm=1.4e-02 t_reduction=1.9e-02 tot=3.6e-02 ---
 sigma_tot[inter] counter=26 t=3.1e-03 per=8.7e+00 cost=9.1e+06 flops=2.9e+09
 sigma_tot[gemm] counter=26 i=0 t=6.6e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=1 t=5.8e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=2 t=5.8e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=3 t=5.7e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=4 t=3.6e-03 per=1.0e+01 cost=1.8e+06 flops=4.8e+08
 sigma_tot[gemm] counter=26 i=5 t=3.8e-03 per=1.0e+01 cost=1.8e+06 flops=4.8e+08
 sigma_tot[gemm] counter=26 i=6 t=3.4e-03 per=9.4e+00 cost=1.8e+06 flops=5.4e+08
 sigma_tot[gemm] counter=26 i=7 t=3.3e-03 per=9.0e+00 cost=2.1e+06 flops=6.4e+08
 sigma_tot[gemm] counter=26 total t=1.4e-02 per=4.0e+01 cost=7.5e+06 flops=5.2e+08
 sigma_tot[red] counter=26 t=1.9e-02 per=5.2e+01 cost=2.0e+06 flops=1.1e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.5e-06,1.1e-05,1.7e-06,1.2e-06,1.7e-07
    4   0 -    -116.217369818296 -1.748e-05  8.241e-04    3     4  2.130e-02 5.325e-03 5.028e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.856e-05,2.249e-04,1.201e-03,1.341e-03,2.801e-03
 ndim=225:1.676e-06GB t[comm(intra)]=2.240e-05 speed=1.497e-01GB/S t[comm(inter)]=6.159e-06 speed=5.444e-01GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=1.2e-03 t_reduction=1.3e-03 tot=2.8e-03 ---
 sigma[inter] counter=27 t=2.2e-04 per=8.1e+00 cost=1.5e+06 flops=6.8e+09
 sigma[gemm] counter=27 i=0 t=2.7e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=1 t=2.2e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=2 t=2.2e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=3 t=2.2e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=4 t=3.1e-04 per=1.1e+01 cost=3.1e+05 flops=1.0e+09
 sigma[gemm] counter=27 i=5 t=3.0e-04 per=1.1e+01 cost=3.2e+05 flops=1.1e+09
 sigma[gemm] counter=27 i=6 t=2.9e-04 per=1.1e+01 cost=2.8e+05 flops=9.7e+08
 sigma[gemm] counter=27 i=7 t=2.9e-04 per=1.1e+01 cost=3.3e+05 flops=1.1e+09
 sigma[gemm] counter=27 total t=1.2e-03 per=4.3e+01 cost=1.2e+06 flops=1.0e+09
 sigma[red] counter=27 t=1.3e-03 per=4.8e+01 cost=3.3e+05 flops=2.4e+08
--- TIMING FOR sigma_tot : t_inter=3.4e-03 t_gemm=1.6e-02 t_reduction=2.0e-02 tot=3.9e-02 ---
 sigma_tot[inter] counter=27 t=3.4e-03 per=8.7e+00 cost=1.1e+07 flops=3.2e+09
 sigma_tot[gemm] counter=27 i=0 t=6.8e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=1 t=6.1e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=2 t=6.0e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=3 t=5.9e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=4 t=3.9e-03 per=1.0e+01 cost=2.1e+06 flops=5.2e+08
 sigma_tot[gemm] counter=27 i=5 t=4.1e-03 per=1.0e+01 cost=2.1e+06 flops=5.2e+08
 sigma_tot[gemm] counter=27 i=6 t=3.7e-03 per=9.5e+00 cost=2.1e+06 flops=5.7e+08
 sigma_tot[gemm] counter=27 i=7 t=3.5e-03 per=9.1e+00 cost=2.4e+06 flops=6.8e+08
 sigma_tot[gemm] counter=27 total t=1.6e-02 per=4.0e+01 cost=8.7e+06 flops=5.6e+08
 sigma_tot[red] counter=27 t=2.0e-02 per=5.2e+01 cost=2.3e+06 flops=1.2e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,1.1e-05,1.7e-06,1.2e-06,2.0e-07
    5   0 -    -116.217371742200 -1.924e-06  2.959e-04    3     5  2.633e-02 5.265e-03 4.971e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.843e-05,2.320e-04,1.231e-03,1.361e-03,2.857e-03
 ndim=225:1.676e-06GB t[comm(intra)]=2.282e-05 speed=1.469e-01GB/S t[comm(inter)]=5.615e-06 speed=5.971e-01GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=1.2e-03 t_reduction=1.4e-03 tot=2.8e-03 ---
 sigma[inter] counter=28 t=2.3e-04 per=8.2e+00 cost=1.5e+06 flops=6.6e+09
 sigma[gemm] counter=28 i=0 t=2.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=1 t=2.4e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=2 t=2.4e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=3 t=2.4e-06 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=4 t=3.2e-04 per=1.1e+01 cost=3.1e+05 flops=9.7e+08
 sigma[gemm] counter=28 i=5 t=3.2e-04 per=1.1e+01 cost=3.2e+05 flops=9.8e+08
 sigma[gemm] counter=28 i=6 t=2.9e-04 per=1.0e+01 cost=2.8e+05 flops=9.7e+08
 sigma[gemm] counter=28 i=7 t=2.8e-04 per=1.0e+01 cost=3.3e+05 flops=1.2e+09
 sigma[gemm] counter=28 total t=1.2e-03 per=4.4e+01 cost=1.2e+06 flops=1.0e+09
 sigma[red] counter=28 t=1.4e-03 per=4.8e+01 cost=3.3e+05 flops=2.4e+08
--- TIMING FOR sigma_tot : t_inter=3.6e-03 t_gemm=1.7e-02 t_reduction=2.1e-02 tot=4.2e-02 ---
 sigma_tot[inter] counter=28 t=3.6e-03 per=8.6e+00 cost=1.2e+07 flops=3.4e+09
 sigma_tot[gemm] counter=28 i=0 t=7.1e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=1 t=6.3e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=2 t=6.2e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=3 t=6.2e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=4 t=4.3e-03 per=1.0e+01 cost=2.4e+06 flops=5.6e+08
 sigma_tot[gemm] counter=28 i=5 t=4.4e-03 per=1.0e+01 cost=2.4e+06 flops=5.6e+08
 sigma_tot[gemm] counter=28 i=6 t=4.0e-03 per=9.6e+00 cost=2.4e+06 flops=6.0e+08
 sigma_tot[gemm] counter=28 i=7 t=3.8e-03 per=9.2e+00 cost=2.7e+06 flops=7.1e+08
 sigma_tot[gemm] counter=28 total t=1.7e-02 per=4.0e+01 cost=1.0e+07 flops=6.0e+08
 sigma_tot[red] counter=28 t=2.1e-02 per=5.1e+01 cost=2.7e+06 flops=1.2e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,1.0e-05,1.7e-06,1.1e-06,1.7e-07
    6   0 -    -116.217372032857 -2.907e-07  1.396e-04    3     6  3.168e-02 5.280e-03 4.994e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.768e-05,2.185e-04,1.177e-03,1.346e-03,2.774e-03
 ndim=225:1.676e-06GB t[comm(intra)]=2.214e-05 speed=1.515e-01GB/S t[comm(inter)]=5.548e-06 speed=6.043e-01GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=1.2e-03 t_reduction=1.3e-03 tot=2.7e-03 ---
 sigma[inter] counter=29 t=2.2e-04 per=8.0e+00 cost=1.5e+06 flops=7.0e+09
 sigma[gemm] counter=29 i=0 t=2.7e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=1 t=2.2e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=2 t=2.2e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=3 t=2.2e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=4 t=2.9e-04 per=1.0e+01 cost=3.1e+05 flops=1.1e+09
 sigma[gemm] counter=29 i=5 t=2.9e-04 per=1.1e+01 cost=3.2e+05 flops=1.1e+09
 sigma[gemm] counter=29 i=6 t=2.9e-04 per=1.1e+01 cost=2.8e+05 flops=9.9e+08
 sigma[gemm] counter=29 i=7 t=3.0e-04 per=1.1e+01 cost=3.3e+05 flops=1.1e+09
 sigma[gemm] counter=29 total t=1.2e-03 per=4.3e+01 cost=1.2e+06 flops=1.1e+09
 sigma[red] counter=29 t=1.3e-03 per=4.9e+01 cost=3.3e+05 flops=2.4e+08
--- TIMING FOR sigma_tot : t_inter=3.8e-03 t_gemm=1.8e-02 t_reduction=2.3e-02 tot=4.5e-02 ---
 sigma_tot[inter] counter=29 t=3.8e-03 per=8.6e+00 cost=1.4e+07 flops=3.6e+09
 sigma_tot[gemm] counter=29 i=0 t=7.4e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=1 t=6.5e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=2 t=6.4e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=3 t=6.4e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=4 t=4.6e-03 per=1.0e+01 cost=2.7e+06 flops=5.9e+08
 sigma_tot[gemm] counter=29 i=5 t=4.7e-03 per=1.0e+01 cost=2.8e+06 flops=5.9e+08
 sigma_tot[gemm] counter=29 i=6 t=4.3e-03 per=9.6e+00 cost=2.7e+06 flops=6.3e+08
 sigma_tot[gemm] counter=29 i=7 t=4.1e-03 per=9.3e+00 cost=3.1e+06 flops=7.4e+08
 sigma_tot[gemm] counter=29 total t=1.8e-02 per=4.0e+01 cost=1.1e+07 flops=6.3e+08
 sigma_tot[red] counter=29 t=2.3e-02 per=5.1e+01 cost=3.0e+06 flops=1.3e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.1e-05,1.7e-06,1.2e-06,1.7e-07
    7   0 +    -116.217372098438 -6.558e-08  5.394e-05    3     7  3.672e-02 5.246e-03 4.964e-03
TIMING FOR Davidson : 3.680e-02  T(cal/comm/rest)=3.474e-02,3.440e-07,2.051e-03
decomposed t_rest=2.051e-03
 T(sub)    =1.287e-04 per=6.273e+00
 T(precond)=5.037e-04 per=2.455e+01
 T(ortho)  =1.791e-05 per=8.728e-01
 T(xcopy)  =9.170e-07 per=4.470e-02
 T(xnrm2)  =1.513e-06 per=7.375e-02
 T(other)  =1.399e-03 per=6.818e+01
optimized energies: isweep=0 ibond=4 dots=2 e[0]=-116.217372098438 nmvp=7
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:9.055e+00S Sys:1.125e+00S Total:1.018e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=13 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond4.txt
 qbond: qsuper nsym=13 dimAll=40
 (8,2):8 (10,2):4 (9,1):6 (9,3):5 (7,1):3 (8,0):2 (7,3):4 (8,4):3 (11,1):1 (10,0):1 (6,2):1 (6,4):1 (7,5):1
----- TMING FOR decimation_genbasis(su2): 8.3e-05 S -----
decimation summary: 40->10 dwt=+1.978e-04 SvN=1.078e+00
 qbond: qkept nsym=4 dimAll=10
 (9,3):4 (9,1):3 (8,2):2 (8,4):1
----- TIMING for decimation_row(nkr): 6.122e-03 S T(decim/select/formRot)=3.788e-04,5.523e-03,2.203e-04 -----
----- TIMING FOR twodot_decimation: 6.441e-03 S T(wf/decim)=1.915e-04,6.249e-03 -----
ctns::oper_renorm coord=(5,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:6 S:14 H:1 A:36 B:42 
        dim(bra,ket)=10,10 size(op)=58:4.425e-04MB size(tot)=2238:1.707e-02MB:1.667e-05GB
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:9.349e+00S Sys:1.125e+00S Total:1.047e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=99 : 3.192e-04 S -----
rank=0 GPUmem(GB): used=6.61e-05 (oper)=3.43e-05
rank=0 GPUmem(GB): used=6.65e-05 (oper,site)(GB)=3.43e-05,4.25e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=99
 no. of rintermediate operators=131
 no. of coefficients=1475:0.0113MB:1.1e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.281e-04 S -----
rank=0 GPUmem(GB): used=7.75e-05 (oper,site,rinter)=3.43e-05,4.25e-07,1.1e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00145 S size(rtasks)=99 size(Rlst2)=16 T(Rmu/Rlist)=8.04e-05,0.00137 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00158 S size(rtasks)=99 size(Rlst)=1746 -----
rank=0 GPUmem(GB): used=7.75e-05 (oper,site,rinter,batch)=3.43e-05,4.25e-07,1.1e-05,0.000546 blksize=16 blksize0=9 batchsize=1746
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000186,0.00114,0.000312
--- TIMING FOR renorm : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=3.1e-04 tot=1.6e-03 ---
 renorm[inter] counter=5 t=1.9e-04 per=1.1e+01 cost=8.5e+04 flops=4.6e+08
 renorm[gemm] counter=5 i=0 t=2.8e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=1 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=2 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=3 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=4 t=4.0e-04 per=2.4e+01 cost=1.8e+04 flops=4.5e+07
 renorm[gemm] counter=5 i=5 t=3.3e-04 per=2.0e+01 cost=2.9e+04 flops=8.8e+07
 renorm[gemm] counter=5 i=6 t=4.0e-04 per=2.5e+01 cost=4.9e+04 flops=1.2e+08
 renorm[gemm] counter=5 total t=1.1e-03 per=7.0e+01 cost=9.6e+04 flops=8.4e+07
 renorm[red] counter=5 t=3.1e-04 per=1.9e+01 cost=2.3e+04 flops=7.2e+07
--- TIMING FOR renorm_tot : t_inter=5.6e-04 t_gemm=2.4e-03 t_reduction=9.7e-04 tot=4.0e-03 ---
 renorm_tot[inter] counter=5 t=5.6e-04 per=1.4e+01 cost=1.8e+05 flops=3.1e+08
 renorm_tot[gemm] counter=5 i=0 t=1.4e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=1 t=1.1e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=2 t=1.1e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=3 t=1.1e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=4 t=8.4e-04 per=2.1e+01 cost=3.5e+04 flops=4.2e+07
 renorm_tot[gemm] counter=5 i=5 t=7.1e-04 per=1.8e+01 cost=5.5e+04 flops=7.7e+07
 renorm_tot[gemm] counter=5 i=6 t=8.4e-04 per=2.1e+01 cost=8.9e+04 flops=1.1e+08
 renorm_tot[gemm] counter=5 total t=2.4e-03 per=6.1e+01 cost=1.8e+05 flops=7.3e+07
 renorm_tot[red] counter=5 t=9.7e-04 per=2.5e+01 cost=4.1e+04 flops=4.2e+07
qops.to_cpu: size(tot)=2238:1.7e-02MB:1.7e-05GB t[to_cpu]=2.0e-05S speed=8.4e-01GB/S
check ||H-H.dagger||=3.252e-15 coord=(5,0) rank=0
ctns::oper_ab2pq coord=(5,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00732 S rank=0 -----
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:9.353e+00S Sys:1.125e+00S Total:1.048e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=833:6.355e-03MB:6.206e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=92:7.019e-04MB:6.855e-07GB
total mem of comb=926:7.065e-03MB:6.899e-06GB
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:9.355e+00S Sys:1.125e+00S Total:1.048e+01S
##### local opt: 1.370e-01 S #####
 T(local opt: fetch) = 6.233e-03 S  per = 4.55  per(accum) = 4.55
 T(local opt: hdiag) = 6.710e-03 S  per =  4.9  per(accum) = 9.45
 T(local opt: dvdsn) = 1.041e-01 S  per =   76  per(accum) = 85.5
 T(local opt: decim) = 6.560e-03 S  per = 4.79  per(accum) = 90.3
 T(local opt: guess) = 6.155e-04 S  per = 0.449  per(accum) = 90.7
 T(local opt: renrm) = 8.313e-03 S  per = 6.07  per(accum) = 96.8
 T(local opt: save ) = 4.419e-03 S  per = 3.23  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.041e-01 S  T(sum) = 1.032e-01 S  per = 9.909e+01
 T(local opt: preprocess                  ) = 1.043e-03 S  per = 1.01  per(accum) = 1.01
 T(local opt: symbolic_formulae           ) = 1.002e-03 S  per = 0.971  per(accum) = 1.98
 T(local opt: hintermediate init          ) = 5.650e-04 S  per = 0.548  per(accum) = 2.53
 T(local opt: preprocess_hformulae_Hxlist ) = 5.310e-02 S  per = 51.5  per(accum) = 54
 T(local opt: hmmtasks init               ) = 1.030e-02 S  per = 9.99  per(accum) = 64
 T(local opt: initial guess for dvdson    ) = 3.770e-04 S  per = 0.365  per(accum) = 64.3
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.454e-02 S  per = 33.5  per(accum) = 97.8
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.083e-04 S  per = 0.202  per(accum) = 98
 T(local opt: dvdson solver [comm(cpu)]   ) = 3.440e-07 S  per = 0.000333  per(accum) = 98
 T(local opt: dvdson solver [rest part]   ) = 2.051e-03 S  per = 1.99  per(accum) = 100
Detailed decomposition of T(renrm) = 8.313e-03 S  T(sum) = 8.313e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.507e-04 S  per = 3.02  per(accum) = 3.02
 T(local opt: qops init                    ) = 4.228e-04 S  per = 5.09  per(accum) = 8.1
 T(local opt: symbolic_formulae_renorm     ) = 3.985e-04 S  per = 4.79  per(accum) = 12.9
 T(local opt: allocate qops on gpu         ) = 9.426e-05 S  per = 1.13  per(accum) = 14
 T(local opt: site memcpy cpu2gpu          ) = 8.437e-05 S  per = 1.01  per(accum) = 15
 T(local opt: rintermediate init           ) = 4.844e-04 S  per = 5.83  per(accum) = 20.9
 T(local opt: preprocess_formulae_Rlist2   ) = 1.666e-03 S  per =   20  per(accum) = 40.9
 T(local opt: rmmtasks init                ) = 5.627e-04 S  per = 6.77  per(accum) = 47.7
 T(local opt: qops memset on cpu           ) = 4.900e-08 S  per = 0.000589  per(accum) = 47.7
 T(local opt: preprocess_renorm_batchGPU   ) = 3.426e-03 S  per = 41.2  per(accum) = 88.9
 T(local opt: reduction of opS & opH [nccl]) = 7.310e-07 S  per = 0.00879  per(accum) = 88.9
 T(local opt: qops memcpy gpu2cpu          ) = 8.775e-05 S  per = 1.06  per(accum) = 90
 T(local opt: deallocate cpu and gpu memory) = 1.017e-05 S  per = 0.122  per(accum) = 90.1
 T(local opt: reduction of opS & opH [comm]) = 7.802e-05 S  per = 0.939  per(accum) = 91
 T(local opt: conversion from opAB to opPQ ) = 7.370e-05 S  per = 0.887  per(accum) = 91.9
 T(local opt: after oper_renorm            ) = 6.723e-04 S  per = 8.09  per(accum) = 100
##### sweep opt: 3.393e-01 S #####
 T(sweep opt: fetch) = 3.650e-02 S  per = 10.8  per(accum) = 10.8
 T(sweep opt: hdiag) = 1.588e-02 S  per = 4.68  per(accum) = 15.4
 T(sweep opt: dvdsn) = 2.147e-01 S  per = 63.3  per(accum) = 78.7
 T(sweep opt: decim) = 1.841e-02 S  per = 5.43  per(accum) = 84.1
 T(sweep opt: guess) = 1.027e-03 S  per = 0.303  per(accum) = 84.4
 T(sweep opt: renrm) = 3.118e-02 S  per = 9.19  per(accum) = 93.6
 T(sweep opt: save ) = 2.158e-02 S  per = 6.36  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.147e-01 S  T(sum) = 2.105e-01 S  per = 9.805e+01
 T(sweep opt: preprocess                  ) = 3.545e-03 S  per = 1.68  per(accum) = 1.68
 T(sweep opt: symbolic_formulae           ) = 3.544e-03 S  per = 1.68  per(accum) = 3.37
 T(sweep opt: hintermediate init          ) = 2.837e-03 S  per = 1.35  per(accum) = 4.72
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.426e-02 S  per = 35.3  per(accum) = 40
 T(sweep opt: hmmtasks init               ) = 1.408e-02 S  per = 6.69  per(accum) = 46.7
 T(sweep opt: initial guess for dvdson    ) = 1.210e-03 S  per = 0.575  per(accum) = 47.3
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.025e-01 S  per = 48.7  per(accum) = 95.9
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 8.252e-04 S  per = 0.392  per(accum) = 96.3
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.414e-06 S  per = 0.000672  per(accum) = 96.3
 T(sweep opt: dvdson solver [rest part]   ) = 7.720e-03 S  per = 3.67  per(accum) = 100
Detailed decomposition of T(renrm) = 3.118e-02 S  T(sum) = 3.118e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.853e-04 S  per =  2.2  per(accum) = 2.2
 T(sweep opt: qops init                    ) = 1.818e-03 S  per = 5.83  per(accum) = 8.03
 T(sweep opt: symbolic_formulae_renorm     ) = 1.520e-03 S  per = 4.88  per(accum) = 12.9
 T(sweep opt: allocate qops on gpu         ) = 4.747e-04 S  per = 1.52  per(accum) = 14.4
 T(sweep opt: site memcpy cpu2gpu          ) = 4.252e-04 S  per = 1.36  per(accum) = 15.8
 T(sweep opt: rintermediate init           ) = 2.292e-03 S  per = 7.35  per(accum) = 23.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.726e-03 S  per = 15.2  per(accum) = 38.3
 T(sweep opt: rmmtasks init                ) = 1.634e-03 S  per = 5.24  per(accum) = 43.5
 T(sweep opt: qops memset on cpu           ) = 2.100e-07 S  per = 0.000674  per(accum) = 43.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.276e-02 S  per = 40.9  per(accum) = 84.5
 T(sweep opt: reduction of opS & opH [nccl]) = 2.827e-06 S  per = 0.00907  per(accum) = 84.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.556e-04 S  per = 1.46  per(accum) = 85.9
 T(sweep opt: deallocate cpu and gpu memory) = 5.727e-05 S  per = 0.184  per(accum) = 86.1
 T(sweep opt: reduction of opS & opH [comm]) = 4.301e-04 S  per = 1.38  per(accum) = 87.5
 T(sweep opt: conversion from opAB to opPQ ) = 3.834e-04 S  per = 1.23  per(accum) = 88.7
 T(sweep opt: after oper_renorm            ) = 3.511e-03 S  per = 11.3  per(accum) = 100
##### global opt: 3.393e-01 S #####
 T(global opt: fetch) = 3.650e-02 S  per = 10.8  per(accum) = 10.8
 T(global opt: hdiag) = 1.588e-02 S  per = 4.68  per(accum) = 15.4
 T(global opt: dvdsn) = 2.147e-01 S  per = 63.3  per(accum) = 78.7
 T(global opt: decim) = 1.841e-02 S  per = 5.43  per(accum) = 84.1
 T(global opt: guess) = 1.027e-03 S  per = 0.303  per(accum) = 84.4
 T(global opt: renrm) = 3.118e-02 S  per = 9.19  per(accum) = 93.6
 T(global opt: save ) = 2.158e-02 S  per = 6.36  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.147e-01 S  T(sum) = 2.105e-01 S  per = 9.805e+01
 T(global opt: preprocess                  ) = 3.545e-03 S  per = 1.68  per(accum) = 1.68
 T(global opt: symbolic_formulae           ) = 3.544e-03 S  per = 1.68  per(accum) = 3.37
 T(global opt: hintermediate init          ) = 2.837e-03 S  per = 1.35  per(accum) = 4.72
 T(global opt: preprocess_hformulae_Hxlist ) = 7.426e-02 S  per = 35.3  per(accum) = 40
 T(global opt: hmmtasks init               ) = 1.408e-02 S  per = 6.69  per(accum) = 46.7
 T(global opt: initial guess for dvdson    ) = 1.210e-03 S  per = 0.575  per(accum) = 47.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.025e-01 S  per = 48.7  per(accum) = 95.9
 T(global opt: dvdson solver [comm(gpu)]   ) = 8.252e-04 S  per = 0.392  per(accum) = 96.3
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.414e-06 S  per = 0.000672  per(accum) = 96.3
 T(global opt: dvdson solver [rest part]   ) = 7.720e-03 S  per = 3.67  per(accum) = 100
Detailed decomposition of T(renrm) = 3.118e-02 S  T(sum) = 3.118e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.853e-04 S  per =  2.2  per(accum) = 2.2
 T(global opt: qops init                    ) = 1.818e-03 S  per = 5.83  per(accum) = 8.03
 T(global opt: symbolic_formulae_renorm     ) = 1.520e-03 S  per = 4.88  per(accum) = 12.9
 T(global opt: allocate qops on gpu         ) = 4.747e-04 S  per = 1.52  per(accum) = 14.4
 T(global opt: site memcpy cpu2gpu          ) = 4.252e-04 S  per = 1.36  per(accum) = 15.8
 T(global opt: rintermediate init           ) = 2.292e-03 S  per = 7.35  per(accum) = 23.1
 T(global opt: preprocess_formulae_Rlist2   ) = 4.726e-03 S  per = 15.2  per(accum) = 38.3
 T(global opt: rmmtasks init                ) = 1.634e-03 S  per = 5.24  per(accum) = 43.5
 T(global opt: qops memset on cpu           ) = 2.100e-07 S  per = 0.000674  per(accum) = 43.5
 T(global opt: preprocess_renorm_batchGPU   ) = 1.276e-02 S  per = 40.9  per(accum) = 84.5
 T(global opt: reduction of opS & opH [nccl]) = 2.827e-06 S  per = 0.00907  per(accum) = 84.5
 T(global opt: qops memcpy gpu2cpu          ) = 4.556e-04 S  per = 1.46  per(accum) = 85.9
 T(global opt: deallocate cpu and gpu memory) = 5.727e-05 S  per = 0.184  per(accum) = 86.1
 T(global opt: reduction of opS & opH [comm]) = 4.301e-04 S  per = 1.38  per(accum) = 87.5
 T(global opt: conversion from opAB to opPQ ) = 3.834e-04 S  per = 1.23  per(accum) = 88.7
 T(global opt: after oper_renorm            ) = 3.511e-03 S  per = 11.3  per(accum) = 100

isweep=0 ibond=5/seqsize=34 dots=2 dbond=(6,0)-(7,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:9.357e+00S Sys:1.125e+00S Total:1.048e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=833:6.355e-03MB:6.206e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=92:7.019e-04MB:6.855e-07GB
total mem of comb=926:7.065e-03MB:6.899e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=6,12,1,1
 suppl= 0 1 2 3 4 16
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 17
 suppc2= 18
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:6 S:14 H:1 A:36 B:42 
        dim(bra,ket)=10,10 size(op)=58:4.425e-04MB size(tot)=2238:1.707e-02MB:1.667e-05GB
 rqops: oplist=CSHPQ nops=C:12 S:8 H:1 P:64 Q:72 
        dim(bra,ket)=19,19 size(op)=176:1.343e-03MB size(tot)=9483:7.235e-02MB:7.065e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=13717:1.047e-01MB:1.022e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(6,0) fdel=./scratch/sweep/rop(7,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
wf4(diml,dimr,dimc1,dimc2)=(10,19,3,3) nnz=194:1.480e-03MB
qtensor4: wf4 own=1 _data=0x55a322770ad0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (9,3):4 (9,1):3 (8,2):2 (8,4):1
 qbond: qcol nsym=7 dimAll=19
 (18,0):3 (18,2):5 (18,4):5 (18,6):3 (19,1):1 (19,3):1 (19,5):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=29 nblocks=432 size=194:1.480e-03MB
### DIAG TIMING: total=5.819e-03 t1=1.001e-05, t2=1.774e-05, t3=1.962e-05, t4=5.745e-03, t5=4.516e-06, t6=1.792e-05, t7=3.895e-06
duration_diagGPU:5.914e-03
duration_diagreduce:4.600e-08
duration_diagtransform:3.330e-07
----- TIMING FOR symbolic_formulae_twodot with size=609 : 1.203e-03 S -----
rank=0 GPUmem(GB): used=0.000102 (oper)=0.000102
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=609
 no. of hintermediate operators=304
 no. of coefficients=4083:0.0312MB:3.04e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.547e-04 S -----
rank=0 GPUmem(GB): used=0.000133 (oper,hinter)=0.000102,3.04e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0325 S size(H_formulae)=609 size(Hxlst2)=29 T(Hmu/Hxlist)=0.000209,0.0323 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.033 S size(H_formulae)=609 size(Hxlst)=20302 -----
rank=0 GPUmem(GB): used=0.00876 (oper,hinter,dvdson,batch)=0.000102,3.04e-05,2.89e-06,0.00862 blksize=20 blksize0=16 batchsize=20302
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=194 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.48e-05,0.000271,0.00158,0.00109,0.00298
 ndim=194:1.45e-06GB t[comm(intra)]=2.78e-05 speed=0.104GB/S t[comm(inter)]=7.05e-06 speed=0.41GB/S
--- TIMING FOR sigma : t_inter=2.7e-04 t_gemm=1.6e-03 t_reduction=1.1e-03 tot=2.9e-03 ---
 sigma[inter] counter=30 t=2.7e-04 per=9.2e+00 cost=1.8e+06 flops=6.5e+09
 sigma[gemm] counter=30 i=0 t=3.7e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=1 t=3.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=2 t=3.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=3 t=3.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=4 t=3.5e-04 per=1.2e+01 cost=2.9e+05 flops=8.2e+08
 sigma[gemm] counter=30 i=5 t=4.0e-04 per=1.4e+01 cost=2.9e+05 flops=7.2e+08
 sigma[gemm] counter=30 i=6 t=4.0e-04 per=1.4e+01 cost=4.1e+05 flops=1.0e+09
 sigma[gemm] counter=30 i=7 t=4.1e-04 per=1.4e+01 cost=4.3e+05 flops=1.1e+09
 sigma[gemm] counter=30 total t=1.6e-03 per=5.4e+01 cost=1.4e+06 flops=9.1e+08
 sigma[red] counter=30 t=1.1e-03 per=3.7e+01 cost=3.0e+05 flops=2.8e+08
--- TIMING FOR sigma_tot : t_inter=4.1e-03 t_gemm=1.9e-02 t_reduction=2.4e-02 tot=4.7e-02 ---
 sigma_tot[inter] counter=30 t=4.1e-03 per=8.6e+00 cost=1.6e+07 flops=3.8e+09
 sigma_tot[gemm] counter=30 i=0 t=7.8e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=1 t=6.8e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=2 t=6.7e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=3 t=6.7e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=4 t=4.9e-03 per=1.0e+01 cost=3.0e+06 flops=6.1e+08
 sigma_tot[gemm] counter=30 i=5 t=5.1e-03 per=1.1e+01 cost=3.1e+06 flops=6.0e+08
 sigma_tot[gemm] counter=30 i=6 t=4.7e-03 per=9.9e+00 cost=3.1e+06 flops=6.6e+08
 sigma_tot[gemm] counter=30 i=7 t=4.5e-03 per=9.6e+00 cost=3.5e+06 flops=7.7e+08
 sigma_tot[gemm] counter=30 total t=1.9e-02 per=4.1e+01 cost=1.3e+07 flops=6.5e+08
 sigma_tot[red] counter=30 t=2.4e-02 per=5.0e+01 cost=3.3e+06 flops=1.4e+08
T(sub)=7.9e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,2.9e-06,9.4e-07,8.8e-07,2.4e-07
settings: ndim=194 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.217292960069 -1.116e+03  5.493e-02    1     1  5.263e-03 5.263e-03 5.073e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.884e-05,1.987e-04,1.106e-03,1.017e-03,2.356e-03
 ndim=194:1.445e-06GB t[comm(intra)]=2.302e-05 speed=1.256e-01GB/S t[comm(inter)]=5.812e-06 speed=4.974e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=1.1e-03 t_reduction=1.0e-03 tot=2.3e-03 ---
 sigma[inter] counter=31 t=2.0e-04 per=8.6e+00 cost=1.8e+06 flops=8.9e+09
 sigma[gemm] counter=31 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=1 t=2.2e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=2 t=2.2e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=3 t=2.2e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=4 t=2.4e-04 per=1.1e+01 cost=2.9e+05 flops=1.2e+09
 sigma[gemm] counter=31 i=5 t=2.5e-04 per=1.1e+01 cost=2.9e+05 flops=1.2e+09
 sigma[gemm] counter=31 i=6 t=3.0e-04 per=1.3e+01 cost=4.1e+05 flops=1.4e+09
 sigma[gemm] counter=31 i=7 t=3.0e-04 per=1.3e+01 cost=4.3e+05 flops=1.5e+09
 sigma[gemm] counter=31 total t=1.1e-03 per=4.8e+01 cost=1.4e+06 flops=1.3e+09
 sigma[red] counter=31 t=1.0e-03 per=4.4e+01 cost=3.0e+05 flops=3.0e+08
--- TIMING FOR sigma_tot : t_inter=4.3e-03 t_gemm=2.1e-02 t_reduction=2.5e-02 tot=5.0e-02 ---
 sigma_tot[inter] counter=31 t=4.3e-03 per=8.6e+00 cost=1.7e+07 flops=4.0e+09
 sigma_tot[gemm] counter=31 i=0 t=8.0e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=1 t=7.0e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=2 t=7.0e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=3 t=6.9e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=4 t=5.1e-03 per=1.0e+01 cost=3.3e+06 flops=6.3e+08
 sigma_tot[gemm] counter=31 i=5 t=5.3e-03 per=1.1e+01 cost=3.3e+06 flops=6.3e+08
 sigma_tot[gemm] counter=31 i=6 t=5.0e-03 per=1.0e+01 cost=3.5e+06 flops=7.1e+08
 sigma_tot[gemm] counter=31 i=7 t=4.8e-03 per=9.7e+00 cost=3.9e+06 flops=8.1e+08
 sigma_tot[gemm] counter=31 total t=2.1e-02 per=4.1e+01 cost=1.4e+07 flops=6.8e+08
 sigma_tot[red] counter=31 t=2.5e-02 per=5.0e+01 cost=3.6e+06 flops=1.4e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,9.7e-06,2.3e-06,1.2e-06,2.0e-07
    2   0 -    -116.232659895835 -1.537e-02  2.305e-02    2     2  1.008e-02 5.040e-03 4.699e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.778e-05,1.945e-04,1.125e-03,9.872e-04,2.340e-03
 ndim=194:1.445e-06GB t[comm(intra)]=2.195e-05 speed=1.317e-01GB/S t[comm(inter)]=5.834e-06 speed=4.955e-01GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=9.9e-04 tot=2.3e-03 ---
 sigma[inter] counter=32 t=1.9e-04 per=8.4e+00 cost=1.8e+06 flops=9.1e+09
 sigma[gemm] counter=32 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=1 t=2.2e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=2 t=2.2e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=3 t=2.2e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=4 t=2.4e-04 per=1.1e+01 cost=2.9e+05 flops=1.2e+09
 sigma[gemm] counter=32 i=5 t=2.6e-04 per=1.1e+01 cost=2.9e+05 flops=1.1e+09
 sigma[gemm] counter=32 i=6 t=3.0e-04 per=1.3e+01 cost=4.1e+05 flops=1.4e+09
 sigma[gemm] counter=32 i=7 t=3.1e-04 per=1.3e+01 cost=4.3e+05 flops=1.4e+09
 sigma[gemm] counter=32 total t=1.1e-03 per=4.9e+01 cost=1.4e+06 flops=1.3e+09
 sigma[red] counter=32 t=9.9e-04 per=4.3e+01 cost=3.0e+05 flops=3.1e+08
--- TIMING FOR sigma_tot : t_inter=4.5e-03 t_gemm=2.2e-02 t_reduction=2.6e-02 tot=5.2e-02 ---
 sigma_tot[inter] counter=32 t=4.5e-03 per=8.6e+00 cost=1.9e+07 flops=4.2e+09
 sigma_tot[gemm] counter=32 i=0 t=8.3e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=1 t=7.3e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=2 t=7.2e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=3 t=7.1e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=4 t=5.4e-03 per=1.0e+01 cost=3.5e+06 flops=6.6e+08
 sigma_tot[gemm] counter=32 i=5 t=5.6e-03 per=1.1e+01 cost=3.6e+06 flops=6.5e+08
 sigma_tot[gemm] counter=32 i=6 t=5.3e-03 per=1.0e+01 cost=3.9e+06 flops=7.4e+08
 sigma_tot[gemm] counter=32 i=7 t=5.1e-03 per=9.9e+00 cost=4.4e+06 flops=8.5e+08
 sigma_tot[gemm] counter=32 total t=2.2e-02 per=4.2e+01 cost=1.5e+07 flops=7.1e+08
 sigma_tot[red] counter=32 t=2.6e-02 per=5.0e+01 cost=3.9e+06 flops=1.5e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.3e-05,1.9e-06,1.3e-06,1.9e-07
    3   0 -    -116.234226590508 -1.567e-03  9.046e-03    3     3  1.464e-02 4.881e-03 4.572e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.769e-05,2.026e-04,1.107e-03,9.799e-04,2.323e-03
 ndim=194:1.445e-06GB t[comm(intra)]=2.195e-05 speed=1.317e-01GB/S t[comm(inter)]=5.742e-06 speed=5.035e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=1.1e-03 t_reduction=9.8e-04 tot=2.3e-03 ---
 sigma[inter] counter=33 t=2.0e-04 per=8.9e+00 cost=1.8e+06 flops=8.7e+09
 sigma[gemm] counter=33 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=1 t=2.3e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=2 t=2.2e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=3 t=2.2e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=4 t=2.4e-04 per=1.1e+01 cost=2.9e+05 flops=1.2e+09
 sigma[gemm] counter=33 i=5 t=2.6e-04 per=1.1e+01 cost=2.9e+05 flops=1.1e+09
 sigma[gemm] counter=33 i=6 t=3.0e-04 per=1.3e+01 cost=4.1e+05 flops=1.4e+09
 sigma[gemm] counter=33 i=7 t=2.9e-04 per=1.3e+01 cost=4.3e+05 flops=1.5e+09
 sigma[gemm] counter=33 total t=1.1e-03 per=4.8e+01 cost=1.4e+06 flops=1.3e+09
 sigma[red] counter=33 t=9.8e-04 per=4.3e+01 cost=3.0e+05 flops=3.1e+08
--- TIMING FOR sigma_tot : t_inter=4.7e-03 t_gemm=2.3e-02 t_reduction=2.7e-02 tot=5.4e-02 ---
 sigma_tot[inter] counter=33 t=4.7e-03 per=8.6e+00 cost=2.1e+07 flops=4.4e+09
 sigma_tot[gemm] counter=33 i=0 t=8.6e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=1 t=7.5e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=2 t=7.4e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=3 t=7.3e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=4 t=5.6e-03 per=1.0e+01 cost=3.8e+06 flops=6.8e+08
 sigma_tot[gemm] counter=33 i=5 t=5.8e-03 per=1.1e+01 cost=3.9e+06 flops=6.7e+08
 sigma_tot[gemm] counter=33 i=6 t=5.6e-03 per=1.0e+01 cost=4.4e+06 flops=7.8e+08
 sigma_tot[gemm] counter=33 i=7 t=5.4e-03 per=1.0e+01 cost=4.8e+06 flops=8.8e+08
 sigma_tot[gemm] counter=33 total t=2.3e-02 per=4.2e+01 cost=1.7e+07 flops=7.4e+08
 sigma_tot[red] counter=33 t=2.7e-02 per=4.9e+01 cost=4.2e+06 flops=1.6e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.5e-06,1.1e-05,1.7e-06,1.1e-06,1.8e-07
    4   0 -    -116.234459483751 -2.329e-04  3.726e-03    3     4  1.923e-02 4.807e-03 4.516e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.680e-05,1.940e-04,1.182e-03,9.872e-04,2.405e-03
 ndim=194:1.445e-06GB t[comm(intra)]=3.097e-05 speed=9.334e-02GB/S t[comm(inter)]=5.830e-06 speed=4.959e-01GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.2e-03 t_reduction=9.9e-04 tot=2.4e-03 ---
 sigma[inter] counter=34 t=1.9e-04 per=8.2e+00 cost=1.8e+06 flops=9.1e+09
 sigma[gemm] counter=34 i=0 t=2.8e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=1 t=2.4e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=2 t=2.3e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=3 t=2.3e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=4 t=2.6e-04 per=1.1e+01 cost=2.9e+05 flops=1.1e+09
 sigma[gemm] counter=34 i=5 t=2.7e-04 per=1.1e+01 cost=2.9e+05 flops=1.1e+09
 sigma[gemm] counter=34 i=6 t=3.1e-04 per=1.3e+01 cost=4.1e+05 flops=1.3e+09
 sigma[gemm] counter=34 i=7 t=3.3e-04 per=1.4e+01 cost=4.3e+05 flops=1.3e+09
 sigma[gemm] counter=34 total t=1.2e-03 per=5.0e+01 cost=1.4e+06 flops=1.2e+09
 sigma[red] counter=34 t=9.9e-04 per=4.2e+01 cost=3.0e+05 flops=3.1e+08
--- TIMING FOR sigma_tot : t_inter=4.9e-03 t_gemm=2.4e-02 t_reduction=2.8e-02 tot=5.7e-02 ---
 sigma_tot[inter] counter=34 t=4.9e-03 per=8.6e+00 cost=2.3e+07 flops=4.6e+09
 sigma_tot[gemm] counter=34 i=0 t=8.9e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=1 t=7.7e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=2 t=7.6e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=3 t=7.6e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=4 t=5.9e-03 per=1.0e+01 cost=4.1e+06 flops=7.0e+08
 sigma_tot[gemm] counter=34 i=5 t=6.1e-03 per=1.1e+01 cost=4.2e+06 flops=6.9e+08
 sigma_tot[gemm] counter=34 i=6 t=5.9e-03 per=1.0e+01 cost=4.8e+06 flops=8.1e+08
 sigma_tot[gemm] counter=34 i=7 t=5.8e-03 per=1.0e+01 cost=5.2e+06 flops=9.1e+08
 sigma_tot[gemm] counter=34 total t=2.4e-02 per=4.2e+01 cost=1.8e+07 flops=7.6e+08
 sigma_tot[red] counter=34 t=2.8e-02 per=4.9e+01 cost=4.5e+06 flops=1.6e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,1.1e-05,1.7e-06,1.1e-06,1.8e-07
    5   0 -    -116.234499291415 -3.981e-05  1.449e-03    3     5  2.394e-02 4.789e-03 4.506e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.857e-05,1.943e-04,1.100e-03,9.866e-04,2.315e-03
 ndim=194:1.445e-06GB t[comm(intra)]=2.271e-05 speed=1.273e-01GB/S t[comm(inter)]=5.853e-06 speed=4.939e-01GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=9.9e-04 tot=2.3e-03 ---
 sigma[inter] counter=35 t=1.9e-04 per=8.5e+00 cost=1.8e+06 flops=9.1e+09
 sigma[gemm] counter=35 i=0 t=2.8e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=1 t=2.4e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=2 t=2.3e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=3 t=2.3e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=4 t=2.4e-04 per=1.1e+01 cost=2.9e+05 flops=1.2e+09
 sigma[gemm] counter=35 i=5 t=2.5e-04 per=1.1e+01 cost=2.9e+05 flops=1.2e+09
 sigma[gemm] counter=35 i=6 t=3.0e-04 per=1.3e+01 cost=4.1e+05 flops=1.4e+09
 sigma[gemm] counter=35 i=7 t=2.9e-04 per=1.3e+01 cost=4.3e+05 flops=1.5e+09
 sigma[gemm] counter=35 total t=1.1e-03 per=4.8e+01 cost=1.4e+06 flops=1.3e+09
 sigma[red] counter=35 t=9.9e-04 per=4.3e+01 cost=3.0e+05 flops=3.1e+08
--- TIMING FOR sigma_tot : t_inter=5.1e-03 t_gemm=2.5e-02 t_reduction=2.9e-02 tot=5.9e-02 ---
 sigma_tot[inter] counter=35 t=5.1e-03 per=8.6e+00 cost=2.4e+07 flops=4.8e+09
 sigma_tot[gemm] counter=35 i=0 t=9.1e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=1 t=8.0e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=2 t=7.9e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=3 t=7.8e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=4 t=6.1e-03 per=1.0e+01 cost=4.4e+06 flops=7.2e+08
 sigma_tot[gemm] counter=35 i=5 t=6.4e-03 per=1.1e+01 cost=4.5e+06 flops=7.1e+08
 sigma_tot[gemm] counter=35 i=6 t=6.2e-03 per=1.1e+01 cost=5.2e+06 flops=8.3e+08
 sigma_tot[gemm] counter=35 i=7 t=6.1e-03 per=1.0e+01 cost=5.7e+06 flops=9.4e+08
 sigma_tot[gemm] counter=35 total t=2.5e-02 per=4.3e+01 cost=2.0e+07 flops=7.9e+08
 sigma_tot[red] counter=35 t=2.9e-02 per=4.9e+01 cost=4.8e+06 flops=1.7e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,1.0e-05,1.7e-06,1.0e-06,1.6e-07
    6   0 -    -116.234505308352 -6.017e-06  4.517e-04    3     6  2.846e-02 4.744e-03 4.466e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.743e-05,1.938e-04,1.098e-03,9.922e-04,2.317e-03
 ndim=194:1.445e-06GB t[comm(intra)]=2.185e-05 speed=1.323e-01GB/S t[comm(inter)]=5.576e-06 speed=5.184e-01GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=9.9e-04 tot=2.3e-03 ---
 sigma[inter] counter=36 t=1.9e-04 per=8.5e+00 cost=1.8e+06 flops=9.1e+09
 sigma[gemm] counter=36 i=0 t=2.8e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=1 t=2.4e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=2 t=2.3e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=3 t=2.3e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=4 t=2.4e-04 per=1.1e+01 cost=2.9e+05 flops=1.2e+09
 sigma[gemm] counter=36 i=5 t=2.5e-04 per=1.1e+01 cost=2.9e+05 flops=1.2e+09
 sigma[gemm] counter=36 i=6 t=3.0e-04 per=1.3e+01 cost=4.1e+05 flops=1.4e+09
 sigma[gemm] counter=36 i=7 t=2.9e-04 per=1.3e+01 cost=4.3e+05 flops=1.5e+09
 sigma[gemm] counter=36 total t=1.1e-03 per=4.8e+01 cost=1.4e+06 flops=1.3e+09
 sigma[red] counter=36 t=9.9e-04 per=4.3e+01 cost=3.0e+05 flops=3.1e+08
--- TIMING FOR sigma_tot : t_inter=5.3e-03 t_gemm=2.6e-02 t_reduction=3.0e-02 tot=6.1e-02 ---
 sigma_tot[inter] counter=36 t=5.3e-03 per=8.6e+00 cost=2.6e+07 flops=5.0e+09
 sigma_tot[gemm] counter=36 i=0 t=9.4e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=1 t=8.2e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=2 t=8.1e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=3 t=8.0e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=4 t=6.4e-03 per=1.0e+01 cost=4.7e+06 flops=7.4e+08
 sigma_tot[gemm] counter=36 i=5 t=6.6e-03 per=1.1e+01 cost=4.8e+06 flops=7.2e+08
 sigma_tot[gemm] counter=36 i=6 t=6.5e-03 per=1.1e+01 cost=5.6e+06 flops=8.6e+08
 sigma_tot[gemm] counter=36 i=7 t=6.3e-03 per=1.0e+01 cost=6.1e+06 flops=9.6e+08
 sigma_tot[gemm] counter=36 total t=2.6e-02 per=4.3e+01 cost=2.1e+07 flops=8.1e+08
 sigma_tot[red] counter=36 t=3.0e-02 per=4.9e+01 cost=5.1e+06 flops=1.7e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.1e-05,1.7e-06,1.1e-06,1.9e-07
    7   0 -    -116.234506073987 -7.656e-07  2.023e-04    3     7  3.296e-02 4.709e-03 4.439e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.902e-05,1.915e-04,1.098e-03,1.279e-03,2.602e-03
 ndim=194:1.445e-06GB t[comm(intra)]=2.343e-05 speed=1.234e-01GB/S t[comm(inter)]=5.592e-06 speed=5.170e-01GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=1.3e-03 tot=2.6e-03 ---
 sigma[inter] counter=37 t=1.9e-04 per=7.5e+00 cost=1.8e+06 flops=9.2e+09
 sigma[gemm] counter=37 i=0 t=2.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=1 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=2 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=3 t=2.2e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=4 t=2.5e-04 per=9.6e+00 cost=2.9e+05 flops=1.2e+09
 sigma[gemm] counter=37 i=5 t=2.5e-04 per=9.7e+00 cost=2.9e+05 flops=1.2e+09
 sigma[gemm] counter=37 i=6 t=3.0e-04 per=1.2e+01 cost=4.1e+05 flops=1.4e+09
 sigma[gemm] counter=37 i=7 t=2.9e-04 per=1.1e+01 cost=4.3e+05 flops=1.5e+09
 sigma[gemm] counter=37 total t=1.1e-03 per=4.3e+01 cost=1.4e+06 flops=1.3e+09
 sigma[red] counter=37 t=1.3e-03 per=5.0e+01 cost=3.0e+05 flops=2.4e+08
--- TIMING FOR sigma_tot : t_inter=5.5e-03 t_gemm=2.7e-02 t_reduction=3.1e-02 tot=6.4e-02 ---
 sigma_tot[inter] counter=37 t=5.5e-03 per=8.6e+00 cost=2.8e+07 flops=5.1e+09
 sigma_tot[gemm] counter=37 i=0 t=9.7e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=1 t=8.4e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=2 t=8.3e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=3 t=8.3e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=4 t=6.6e-03 per=1.0e+01 cost=5.0e+06 flops=7.5e+08
 sigma_tot[gemm] counter=37 i=5 t=6.9e-03 per=1.1e+01 cost=5.1e+06 flops=7.4e+08
 sigma_tot[gemm] counter=37 i=6 t=6.8e-03 per=1.1e+01 cost=6.0e+06 flops=8.8e+08
 sigma_tot[gemm] counter=37 i=7 t=6.6e-03 per=1.0e+01 cost=6.5e+06 flops=9.8e+08
 sigma_tot[gemm] counter=37 total t=2.7e-02 per=4.3e+01 cost=2.3e+07 flops=8.3e+08
 sigma_tot[red] counter=37 t=3.1e-02 per=4.9e+01 cost=5.4e+06 flops=1.7e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.1e-05,1.6e-06,1.1e-06,1.8e-07
    8   0 +    -116.234506198197 -1.242e-07  6.082e-05    3     8  3.775e-02 4.718e-03 4.452e-03
TIMING FOR Davidson : 3.783e-02  T(cal/comm/rest)=3.561e-02,4.190e-07,2.210e-03
decomposed t_rest=2.210e-03
 T(sub)    =1.439e-04 per=6.511e+00
 T(precond)=4.542e-04 per=2.055e+01
 T(ortho)  =1.508e-05 per=6.822e-01
 T(xcopy)  =9.660e-07 per=4.371e-02
 T(xnrm2)  =1.644e-06 per=7.439e-02
 T(other)  =1.594e-03 per=7.214e+01
optimized energies: isweep=0 ibond=5 dots=2 e[0]=-116.234506198197 nmvp=8
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:1.139e+01S Sys:1.125e+00S Total:1.252e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=10 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond5.txt
 qbond: qsuper nsym=10 dimAll=40
 (9,3):7 (11,3):4 (10,2):9 (10,4):5 (9,1):5 (11,1):3 (10,0):3 (8,2):2 (8,4):1 (9,5):1
----- TMING FOR decimation_genbasis(su2): 1.9e-03 S -----
decimation summary: 40->10 dwt=+5.145e-02 SvN=1.503e+00
 qbond: qkept nsym=5 dimAll=10
 (10,2):4 (10,0):3 (9,3):1 (10,4):1 (9,1):1
----- TIMING for decimation_row(nkr): 5.156e-03 S T(decim/select/formRot)=2.246e-03,2.750e-03,1.604e-04 -----
----- TIMING FOR twodot_decimation: 5.402e-03 S T(wf/decim)=1.698e-04,5.232e-03 -----
ctns::oper_renorm coord=(6,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:7 S:13 H:1 A:49 B:56 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=2536:1.935e-02MB:1.889e-05GB
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:1.165e+01S Sys:1.125e+00S Total:1.278e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=126 : 4.110e-04 S -----
rank=0 GPUmem(GB): used=8.09e-05 (oper)=4.3e-05
rank=0 GPUmem(GB): used=8.13e-05 (oper,site)(GB)=4.3e-05,4.62e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=126
 no. of rintermediate operators=122
 no. of coefficients=1899:0.0145MB:1.41e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.276e-04 S -----
rank=0 GPUmem(GB): used=9.55e-05 (oper,site,rinter)=4.3e-05,4.62e-07,1.41e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00171 S size(rtasks)=126 size(Rlst2)=25 T(Rmu/Rlist)=8.8e-05,0.00163 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00185 S size(rtasks)=126 size(Rlst)=2153 -----
rank=0 GPUmem(GB): used=9.55e-05 (oper,site,rinter,batch)=4.3e-05,4.62e-07,1.41e-05,0.000786 blksize=16 blksize0=16 batchsize=2153
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000206,0.000879,0.000287
--- TIMING FOR renorm : t_inter=2.1e-04 t_gemm=8.8e-04 t_reduction=2.9e-04 tot=1.4e-03 ---
 renorm[inter] counter=6 t=2.1e-04 per=1.5e+01 cost=2.0e+05 flops=9.9e+08
 renorm[gemm] counter=6 i=0 t=2.8e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=1 t=2.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=2 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=3 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=4 t=2.9e-04 per=2.1e+01 cost=2.3e+04 flops=8.1e+07
 renorm[gemm] counter=6 i=5 t=3.2e-04 per=2.4e+01 cost=5.7e+04 flops=1.8e+08
 renorm[gemm] counter=6 i=6 t=2.6e-04 per=1.9e+01 cost=5.7e+04 flops=2.2e+08
 renorm[gemm] counter=6 total t=8.8e-04 per=6.4e+01 cost=1.4e+05 flops=1.6e+08
 renorm[red] counter=6 t=2.9e-04 per=2.1e+01 cost=2.0e+04 flops=6.9e+07
--- TIMING FOR renorm_tot : t_inter=7.6e-04 t_gemm=3.3e-03 t_reduction=1.3e-03 tot=5.3e-03 ---
 renorm_tot[inter] counter=6 t=7.6e-04 per=1.4e+01 cost=3.8e+05 flops=5.0e+08
 renorm_tot[gemm] counter=6 i=0 t=1.7e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=1 t=1.3e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=2 t=1.3e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=3 t=1.3e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=6 i=4 t=1.1e-03 per=2.1e+01 cost=5.8e+04 flops=5.2e+07
 renorm_tot[gemm] counter=6 i=5 t=1.0e-03 per=1.9e+01 cost=1.1e+05 flops=1.1e+08
 renorm_tot[gemm] counter=6 i=6 t=1.1e-03 per=2.1e+01 cost=1.5e+05 flops=1.3e+08
 renorm_tot[gemm] counter=6 total t=3.3e-03 per=6.2e+01 cost=3.2e+05 flops=9.6e+07
 renorm_tot[red] counter=6 t=1.3e-03 per=2.4e+01 cost=6.1e+04 flops=4.8e+07
qops.to_cpu: size(tot)=2536:1.9e-02MB:1.9e-05GB t[to_cpu]=2.1e-05S speed=9.2e-01GB/S
check ||H-H.dagger||=3.640e-15 coord=(6,0) rank=0
ctns::oper_ab2pq coord=(6,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00758 S rank=0 -----
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:1.179e+01S Sys:1.125e+00S Total:1.292e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=761:5.806e-03MB:5.670e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=49:3.738e-04MB:3.651e-07GB
total mem of comb=811:6.187e-03MB:6.042e-06GB
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:1.179e+01S Sys:1.125e+00S Total:1.292e+01S
##### local opt: 1.124e-01 S #####
 T(local opt: fetch) = 6.379e-03 S  per = 5.68  per(accum) = 5.68
 T(local opt: hdiag) = 6.853e-03 S  per =  6.1  per(accum) = 11.8
 T(local opt: dvdsn) = 8.041e-02 S  per = 71.6  per(accum) = 83.3
 T(local opt: decim) = 5.478e-03 S  per = 4.88  per(accum) = 88.2
 T(local opt: guess) = 1.395e-04 S  per = 0.124  per(accum) = 88.3
 T(local opt: renrm) = 8.457e-03 S  per = 7.53  per(accum) = 95.9
 T(local opt: save ) = 4.635e-03 S  per = 4.13  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.041e-02 S  T(sum) = 7.945e-02 S  per = 9.881e+01
 T(local opt: preprocess                  ) = 7.899e-04 S  per = 0.994  per(accum) = 0.994
 T(local opt: symbolic_formulae           ) = 1.297e-03 S  per = 1.63  per(accum) = 2.63
 T(local opt: hintermediate init          ) = 5.911e-04 S  per = 0.744  per(accum) = 3.37
 T(local opt: preprocess_hformulae_Hxlist ) = 3.321e-02 S  per = 41.8  per(accum) = 45.2
 T(local opt: hmmtasks init               ) = 5.435e-03 S  per = 6.84  per(accum) = 52
 T(local opt: initial guess for dvdson    ) = 3.044e-04 S  per = 0.383  per(accum) = 52.4
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.537e-02 S  per = 44.5  per(accum) = 96.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.410e-04 S  per = 0.303  per(accum) = 97.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 4.190e-07 S  per = 0.000527  per(accum) = 97.2
 T(local opt: dvdson solver [rest part]   ) = 2.210e-03 S  per = 2.78  per(accum) = 100
Detailed decomposition of T(renrm) = 8.457e-03 S  T(sum) = 8.457e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.242e-04 S  per = 1.47  per(accum) = 1.47
 T(local opt: qops init                    ) = 5.073e-04 S  per =    6  per(accum) = 7.47
 T(local opt: symbolic_formulae_renorm     ) = 4.962e-04 S  per = 5.87  per(accum) = 13.3
 T(local opt: allocate qops on gpu         ) = 9.723e-05 S  per = 1.15  per(accum) = 14.5
 T(local opt: site memcpy cpu2gpu          ) = 1.054e-04 S  per = 1.25  per(accum) = 15.7
 T(local opt: rintermediate init           ) = 4.775e-04 S  per = 5.65  per(accum) = 21.4
 T(local opt: preprocess_formulae_Rlist2   ) = 1.935e-03 S  per = 22.9  per(accum) = 44.3
 T(local opt: rmmtasks init                ) = 6.710e-04 S  per = 7.93  per(accum) = 52.2
 T(local opt: qops memset on cpu           ) = 4.200e-08 S  per = 0.000497  per(accum) = 52.2
 T(local opt: preprocess_renorm_batchGPU   ) = 3.101e-03 S  per = 36.7  per(accum) = 88.9
 T(local opt: reduction of opS & opH [nccl]) = 6.120e-07 S  per = 0.00724  per(accum) = 88.9
 T(local opt: qops memcpy gpu2cpu          ) = 9.163e-05 S  per = 1.08  per(accum) = 89.9
 T(local opt: deallocate cpu and gpu memory) = 1.042e-05 S  per = 0.123  per(accum) = 90.1
 T(local opt: reduction of opS & opH [comm]) = 8.916e-05 S  per = 1.05  per(accum) = 91.1
 T(local opt: conversion from opAB to opPQ ) = 7.188e-05 S  per = 0.85  per(accum) = 92
 T(local opt: after oper_renorm            ) = 6.785e-04 S  per = 8.02  per(accum) = 100
##### sweep opt: 4.516e-01 S #####
 T(sweep opt: fetch) = 4.288e-02 S  per = 9.49  per(accum) = 9.49
 T(sweep opt: hdiag) = 2.273e-02 S  per = 5.03  per(accum) = 14.5
 T(sweep opt: dvdsn) = 2.951e-01 S  per = 65.3  per(accum) = 79.9
 T(sweep opt: decim) = 2.389e-02 S  per = 5.29  per(accum) = 85.2
 T(sweep opt: guess) = 1.167e-03 S  per = 0.258  per(accum) = 85.4
 T(sweep opt: renrm) = 3.963e-02 S  per = 8.78  per(accum) = 94.2
 T(sweep opt: save ) = 2.622e-02 S  per = 5.81  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.951e-01 S  T(sum) = 2.899e-01 S  per = 9.826e+01
 T(sweep opt: preprocess                  ) = 4.335e-03 S  per =  1.5  per(accum) = 1.5
 T(sweep opt: symbolic_formulae           ) = 4.840e-03 S  per = 1.67  per(accum) = 3.16
 T(sweep opt: hintermediate init          ) = 3.428e-03 S  per = 1.18  per(accum) = 4.35
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.075e-01 S  per = 37.1  per(accum) = 41.4
 T(sweep opt: hmmtasks init               ) = 1.951e-02 S  per = 6.73  per(accum) = 48.1
 T(sweep opt: initial guess for dvdson    ) = 1.514e-03 S  per = 0.522  per(accum) = 48.7
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.378e-01 S  per = 47.5  per(accum) = 96.2
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 1.066e-03 S  per = 0.368  per(accum) = 96.6
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.833e-06 S  per = 0.000632  per(accum) = 96.6
 T(sweep opt: dvdson solver [rest part]   ) = 9.930e-03 S  per = 3.42  per(accum) = 100
Detailed decomposition of T(renrm) = 3.963e-02 S  T(sum) = 3.963e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.096e-04 S  per = 2.04  per(accum) = 2.04
 T(sweep opt: qops init                    ) = 2.325e-03 S  per = 5.87  per(accum) = 7.91
 T(sweep opt: symbolic_formulae_renorm     ) = 2.016e-03 S  per = 5.09  per(accum) = 13
 T(sweep opt: allocate qops on gpu         ) = 5.720e-04 S  per = 1.44  per(accum) = 14.4
 T(sweep opt: site memcpy cpu2gpu          ) = 5.306e-04 S  per = 1.34  per(accum) = 15.8
 T(sweep opt: rintermediate init           ) = 2.770e-03 S  per = 6.99  per(accum) = 22.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.661e-03 S  per = 16.8  per(accum) = 39.6
 T(sweep opt: rmmtasks init                ) = 2.305e-03 S  per = 5.81  per(accum) = 45.4
 T(sweep opt: qops memset on cpu           ) = 2.520e-07 S  per = 0.000636  per(accum) = 45.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.586e-02 S  per =   40  per(accum) = 85.4
 T(sweep opt: reduction of opS & opH [nccl]) = 3.439e-06 S  per = 0.00868  per(accum) = 85.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.472e-04 S  per = 1.38  per(accum) = 86.8
 T(sweep opt: deallocate cpu and gpu memory) = 6.768e-05 S  per = 0.171  per(accum) = 87
 T(sweep opt: reduction of opS & opH [comm]) = 5.193e-04 S  per = 1.31  per(accum) = 88.3
 T(sweep opt: conversion from opAB to opPQ ) = 4.553e-04 S  per = 1.15  per(accum) = 89.4
 T(sweep opt: after oper_renorm            ) = 4.190e-03 S  per = 10.6  per(accum) = 100
##### global opt: 4.516e-01 S #####
 T(global opt: fetch) = 4.288e-02 S  per = 9.49  per(accum) = 9.49
 T(global opt: hdiag) = 2.273e-02 S  per = 5.03  per(accum) = 14.5
 T(global opt: dvdsn) = 2.951e-01 S  per = 65.3  per(accum) = 79.9
 T(global opt: decim) = 2.389e-02 S  per = 5.29  per(accum) = 85.2
 T(global opt: guess) = 1.167e-03 S  per = 0.258  per(accum) = 85.4
 T(global opt: renrm) = 3.963e-02 S  per = 8.78  per(accum) = 94.2
 T(global opt: save ) = 2.622e-02 S  per = 5.81  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.951e-01 S  T(sum) = 2.899e-01 S  per = 9.826e+01
 T(global opt: preprocess                  ) = 4.335e-03 S  per =  1.5  per(accum) = 1.5
 T(global opt: symbolic_formulae           ) = 4.840e-03 S  per = 1.67  per(accum) = 3.16
 T(global opt: hintermediate init          ) = 3.428e-03 S  per = 1.18  per(accum) = 4.35
 T(global opt: preprocess_hformulae_Hxlist ) = 1.075e-01 S  per = 37.1  per(accum) = 41.4
 T(global opt: hmmtasks init               ) = 1.951e-02 S  per = 6.73  per(accum) = 48.1
 T(global opt: initial guess for dvdson    ) = 1.514e-03 S  per = 0.522  per(accum) = 48.7
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.378e-01 S  per = 47.5  per(accum) = 96.2
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.066e-03 S  per = 0.368  per(accum) = 96.6
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.833e-06 S  per = 0.000632  per(accum) = 96.6
 T(global opt: dvdson solver [rest part]   ) = 9.930e-03 S  per = 3.42  per(accum) = 100
Detailed decomposition of T(renrm) = 3.963e-02 S  T(sum) = 3.963e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.096e-04 S  per = 2.04  per(accum) = 2.04
 T(global opt: qops init                    ) = 2.325e-03 S  per = 5.87  per(accum) = 7.91
 T(global opt: symbolic_formulae_renorm     ) = 2.016e-03 S  per = 5.09  per(accum) = 13
 T(global opt: allocate qops on gpu         ) = 5.720e-04 S  per = 1.44  per(accum) = 14.4
 T(global opt: site memcpy cpu2gpu          ) = 5.306e-04 S  per = 1.34  per(accum) = 15.8
 T(global opt: rintermediate init           ) = 2.770e-03 S  per = 6.99  per(accum) = 22.8
 T(global opt: preprocess_formulae_Rlist2   ) = 6.661e-03 S  per = 16.8  per(accum) = 39.6
 T(global opt: rmmtasks init                ) = 2.305e-03 S  per = 5.81  per(accum) = 45.4
 T(global opt: qops memset on cpu           ) = 2.520e-07 S  per = 0.000636  per(accum) = 45.4
 T(global opt: preprocess_renorm_batchGPU   ) = 1.586e-02 S  per =   40  per(accum) = 85.4
 T(global opt: reduction of opS & opH [nccl]) = 3.439e-06 S  per = 0.00868  per(accum) = 85.4
 T(global opt: qops memcpy gpu2cpu          ) = 5.472e-04 S  per = 1.38  per(accum) = 86.8
 T(global opt: deallocate cpu and gpu memory) = 6.768e-05 S  per = 0.171  per(accum) = 87
 T(global opt: reduction of opS & opH [comm]) = 5.193e-04 S  per = 1.31  per(accum) = 88.3
 T(global opt: conversion from opAB to opPQ ) = 4.553e-04 S  per = 1.15  per(accum) = 89.4
 T(global opt: after oper_renorm            ) = 4.190e-03 S  per = 10.6  per(accum) = 100

isweep=0 ibond=6/seqsize=34 dots=2 dbond=(7,0)-(8,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:1.179e+01S Sys:1.125e+00S Total:1.292e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=761:5.806e-03MB:5.670e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=49:3.738e-04MB:3.651e-07GB
total mem of comb=811:6.187e-03MB:6.042e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=7,11,1,1
 suppl= 0 1 2 3 4 16 17
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 18
 suppc2= 19
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:7 S:13 H:1 A:49 B:56 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=2536:1.935e-02MB:1.889e-05GB
 rqops: oplist=CSHPQ nops=C:11 S:9 H:1 P:81 Q:90 
        dim(bra,ket)=19,19 size(op)=176:1.343e-03MB size(tot)=11706:8.931e-02MB:8.722e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=16238:1.239e-01MB:1.210e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(7,0) fdel=./scratch/sweep/rop(8,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
wf4(diml,dimr,dimc1,dimc2)=(10,19,3,3) nnz=62:4.730e-04MB
qtensor4: wf4 own=1 _data=0x55a32269a160
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (10,2):4 (10,0):3 (9,3):1 (10,4):1 (9,1):1
 qbond: qcol nsym=7 dimAll=19
 (16,0):3 (16,2):5 (16,4):5 (16,6):3 (17,1):1 (17,3):1 (17,5):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=15 nblocks=513 size=62:4.730e-04MB
### DIAG TIMING: total=5.152e-03 t1=9.154e-06, t2=1.319e-05, t3=1.723e-05, t4=5.086e-03, t5=4.316e-06, t6=1.799e-05, t7=3.856e-06
duration_diagGPU:5.242e-03
duration_diagreduce:3.000e-08
duration_diagtransform:2.500e-07
----- TIMING FOR symbolic_formulae_twodot with size=716 : 1.375e-03 S -----
rank=0 GPUmem(GB): used=0.000121 (oper)=0.000121
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=716
 no. of hintermediate operators=345
 no. of coefficients=4876:0.0372MB:3.63e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.457e-04 S -----
rank=0 GPUmem(GB): used=0.000157 (oper,hinter)=0.000121,3.63e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0132 S size(H_formulae)=716 size(Hxlst2)=15 T(Hmu/Hxlist)=0.000254,0.0129 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0134 S size(H_formulae)=716 size(Hxlst)=8228 -----
rank=0 GPUmem(GB): used=0.00365 (oper,hinter,dvdson,batch)=0.000121,3.63e-05,9.24e-07,0.00349 blksize=20 blksize0=16 batchsize=8228
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=62 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.09e-05,0.000194,0.00094,0.000533,0.0017
 ndim=62:4.62e-07GB t[comm(intra)]=2.38e-05 speed=0.0387GB/S t[comm(inter)]=7.06e-06 speed=0.131GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=9.4e-04 t_reduction=5.3e-04 tot=1.7e-03 ---
 sigma[inter] counter=38 t=1.9e-04 per=1.2e+01 cost=5.0e+05 flops=2.6e+09
 sigma[gemm] counter=38 i=0 t=2.8e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=1 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=2 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=3 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=4 t=2.4e-04 per=1.4e+01 cost=6.8e+04 flops=2.8e+08
 sigma[gemm] counter=38 i=5 t=2.4e-04 per=1.4e+01 cost=6.9e+04 flops=2.9e+08
 sigma[gemm] counter=38 i=6 t=2.3e-04 per=1.4e+01 cost=1.1e+05 flops=4.8e+08
 sigma[gemm] counter=38 i=7 t=2.3e-04 per=1.4e+01 cost=1.1e+05 flops=4.7e+08
 sigma[gemm] counter=38 total t=9.4e-04 per=5.6e+01 cost=3.5e+05 flops=3.8e+08
 sigma[red] counter=38 t=5.3e-04 per=3.2e+01 cost=8.1e+04 flops=1.5e+08
--- TIMING FOR sigma_tot : t_inter=5.7e-03 t_gemm=2.8e-02 t_reduction=3.2e-02 tot=6.6e-02 ---
 sigma_tot[inter] counter=38 t=5.7e-03 per=8.6e+00 cost=2.8e+07 flops=5.0e+09
 sigma_tot[gemm] counter=38 i=0 t=1.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=1 t=8.6e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=2 t=8.5e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=3 t=8.5e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=4 t=6.9e-03 per=1.0e+01 cost=5.1e+06 flops=7.4e+08
 sigma_tot[gemm] counter=38 i=5 t=7.1e-03 per=1.1e+01 cost=5.2e+06 flops=7.3e+08
 sigma_tot[gemm] counter=38 i=6 t=7.0e-03 per=1.1e+01 cost=6.1e+06 flops=8.7e+08
 sigma_tot[gemm] counter=38 i=7 t=6.9e-03 per=1.0e+01 cost=6.6e+06 flops=9.7e+08
 sigma_tot[gemm] counter=38 total t=2.8e-02 per=4.3e+01 cost=2.3e+07 flops=8.1e+08
 sigma_tot[red] counter=38 t=3.2e-02 per=4.8e+01 cost=5.5e+06 flops=1.7e+08
T(sub)=7.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,3.0e-06,9.4e-07,9.4e-07,2.4e-07
settings: ndim=62 neig=1 maxcycle=30 nbuff=4 memory=7e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.218052701478 -1.116e+03  6.554e-02    1     1  3.871e-03 3.871e-03 3.689e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.781e-05,1.423e-04,6.881e-04,4.955e-04,1.359e-03
 ndim=62:4.619e-07GB t[comm(intra)]=2.225e-05 speed=4.153e-02GB/S t[comm(inter)]=5.564e-06 speed=1.660e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=6.9e-04 t_reduction=5.0e-04 tot=1.3e-03 ---
 sigma[inter] counter=39 t=1.4e-04 per=1.1e+01 cost=5.0e+05 flops=3.5e+09
 sigma[gemm] counter=39 i=0 t=2.3e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=1 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=2 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=3 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=4 t=1.7e-04 per=1.3e+01 cost=6.8e+04 flops=4.0e+08
 sigma[gemm] counter=39 i=5 t=1.6e-04 per=1.2e+01 cost=6.9e+04 flops=4.4e+08
 sigma[gemm] counter=39 i=6 t=1.7e-04 per=1.3e+01 cost=1.1e+05 flops=6.3e+08
 sigma[gemm] counter=39 i=7 t=1.8e-04 per=1.4e+01 cost=1.1e+05 flops=6.0e+08
 sigma[gemm] counter=39 total t=6.9e-04 per=5.2e+01 cost=3.5e+05 flops=5.1e+08
 sigma[red] counter=39 t=5.0e-04 per=3.7e+01 cost=8.1e+04 flops=1.6e+08
--- TIMING FOR sigma_tot : t_inter=5.8e-03 t_gemm=2.9e-02 t_reduction=3.2e-02 tot=6.7e-02 ---
 sigma_tot[inter] counter=39 t=5.8e-03 per=8.7e+00 cost=2.9e+07 flops=5.0e+09
 sigma_tot[gemm] counter=39 i=0 t=1.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=1 t=8.9e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=2 t=8.8e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=3 t=8.7e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=4 t=7.0e-03 per=1.1e+01 cost=5.1e+06 flops=7.3e+08
 sigma_tot[gemm] counter=39 i=5 t=7.3e-03 per=1.1e+01 cost=5.2e+06 flops=7.2e+08
 sigma_tot[gemm] counter=39 i=6 t=7.2e-03 per=1.1e+01 cost=6.2e+06 flops=8.6e+08
 sigma_tot[gemm] counter=39 i=7 t=7.0e-03 per=1.1e+01 cost=6.7e+06 flops=9.6e+08
 sigma_tot[gemm] counter=39 total t=2.9e-02 per=4.3e+01 cost=2.3e+07 flops=8.1e+08
 sigma_tot[red] counter=39 t=3.2e-02 per=4.8e+01 cost=5.6e+06 flops=1.7e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,9.1e-06,2.3e-06,9.5e-07,2.1e-07
    2   0 -    -116.236358060038 -1.831e-02  2.245e-02    2     2  7.662e-03 3.831e-03 3.478e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.690e-05,1.387e-04,6.934e-04,4.841e-04,1.348e-03
 ndim=62:4.619e-07GB t[comm(intra)]=2.183e-05 speed=4.233e-02GB/S t[comm(inter)]=5.079e-06 speed=1.819e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=6.9e-04 t_reduction=4.8e-04 tot=1.3e-03 ---
 sigma[inter] counter=40 t=1.4e-04 per=1.1e+01 cost=5.0e+05 flops=3.6e+09
 sigma[gemm] counter=40 i=0 t=2.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=1 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=2 t=2.1e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=3 t=2.1e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=4 t=1.7e-04 per=1.3e+01 cost=6.8e+04 flops=4.0e+08
 sigma[gemm] counter=40 i=5 t=1.6e-04 per=1.2e+01 cost=6.9e+04 flops=4.3e+08
 sigma[gemm] counter=40 i=6 t=1.8e-04 per=1.3e+01 cost=1.1e+05 flops=6.1e+08
 sigma[gemm] counter=40 i=7 t=1.8e-04 per=1.3e+01 cost=1.1e+05 flops=6.1e+08
 sigma[gemm] counter=40 total t=6.9e-04 per=5.3e+01 cost=3.5e+05 flops=5.1e+08
 sigma[red] counter=40 t=4.8e-04 per=3.7e+01 cost=8.1e+04 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=5.9e-03 t_gemm=3.0e-02 t_reduction=3.3e-02 tot=6.8e-02 ---
 sigma_tot[inter] counter=40 t=5.9e-03 per=8.7e+00 cost=2.9e+07 flops=5.0e+09
 sigma_tot[gemm] counter=40 i=0 t=1.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=1 t=9.1e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=2 t=9.0e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=3 t=8.9e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=4 t=7.2e-03 per=1.1e+01 cost=5.2e+06 flops=7.2e+08
 sigma_tot[gemm] counter=40 i=5 t=7.4e-03 per=1.1e+01 cost=5.3e+06 flops=7.1e+08
 sigma_tot[gemm] counter=40 i=6 t=7.4e-03 per=1.1e+01 cost=6.3e+06 flops=8.6e+08
 sigma_tot[gemm] counter=40 i=7 t=7.2e-03 per=1.1e+01 cost=6.9e+06 flops=9.5e+08
 sigma_tot[gemm] counter=40 total t=3.0e-02 per=4.3e+01 cost=2.4e+07 flops=8.0e+08
 sigma_tot[red] counter=40 t=3.3e-02 per=4.8e+01 cost=5.6e+06 flops=1.7e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.2e-05,1.7e-06,1.1e-06,2.1e-07
    3   0 -    -116.237815456215 -1.457e-03  8.140e-03    3     3  1.186e-02 3.954e-03 3.656e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.738e-05,1.423e-04,6.843e-04,4.830e-04,1.342e-03
 ndim=62:4.619e-07GB t[comm(intra)]=2.204e-05 speed=4.192e-02GB/S t[comm(inter)]=5.343e-06 speed=1.729e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=6.8e-04 t_reduction=4.8e-04 tot=1.3e-03 ---
 sigma[inter] counter=41 t=1.4e-04 per=1.1e+01 cost=5.0e+05 flops=3.5e+09
 sigma[gemm] counter=41 i=0 t=2.7e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=1 t=2.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=2 t=2.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=3 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=4 t=1.7e-04 per=1.3e+01 cost=6.8e+04 flops=4.0e+08
 sigma[gemm] counter=41 i=5 t=1.6e-04 per=1.2e+01 cost=6.9e+04 flops=4.3e+08
 sigma[gemm] counter=41 i=6 t=1.7e-04 per=1.3e+01 cost=1.1e+05 flops=6.4e+08
 sigma[gemm] counter=41 i=7 t=1.8e-04 per=1.4e+01 cost=1.1e+05 flops=6.1e+08
 sigma[gemm] counter=41 total t=6.8e-04 per=5.2e+01 cost=3.5e+05 flops=5.2e+08
 sigma[red] counter=41 t=4.8e-04 per=3.7e+01 cost=8.1e+04 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=6.1e-03 t_gemm=3.0e-02 t_reduction=3.3e-02 tot=6.9e-02 ---
 sigma_tot[inter] counter=41 t=6.1e-03 per=8.7e+00 cost=3.0e+07 flops=4.9e+09
 sigma_tot[gemm] counter=41 i=0 t=1.1e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=1 t=9.3e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=2 t=9.2e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=3 t=9.1e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=4 t=7.4e-03 per=1.1e+01 cost=5.3e+06 flops=7.1e+08
 sigma_tot[gemm] counter=41 i=5 t=7.6e-03 per=1.1e+01 cost=5.4e+06 flops=7.1e+08
 sigma_tot[gemm] counter=41 i=6 t=7.6e-03 per=1.1e+01 cost=6.4e+06 flops=8.5e+08
 sigma_tot[gemm] counter=41 i=7 t=7.4e-03 per=1.1e+01 cost=7.0e+06 flops=9.4e+08
 sigma_tot[gemm] counter=41 total t=3.0e-02 per=4.4e+01 cost=2.4e+07 flops=7.9e+08
 sigma_tot[red] counter=41 t=3.3e-02 per=4.8e+01 cost=5.7e+06 flops=1.7e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.1e-05,1.7e-06,9.2e-07,1.5e-07
    4   0 -    -116.238019717468 -2.043e-04  2.814e-03    3     4  1.530e-02 3.825e-03 3.553e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.752e-05,1.360e-04,6.793e-04,4.811e-04,1.328e-03
 ndim=62:4.619e-07GB t[comm(intra)]=2.226e-05 speed=4.150e-02GB/S t[comm(inter)]=5.261e-06 speed=1.756e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=6.8e-04 t_reduction=4.8e-04 tot=1.3e-03 ---
 sigma[inter] counter=42 t=1.4e-04 per=1.0e+01 cost=5.0e+05 flops=3.7e+09
 sigma[gemm] counter=42 i=0 t=2.3e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=1 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=2 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=3 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=4 t=1.7e-04 per=1.3e+01 cost=6.8e+04 flops=4.1e+08
 sigma[gemm] counter=42 i=5 t=1.6e-04 per=1.2e+01 cost=6.9e+04 flops=4.4e+08
 sigma[gemm] counter=42 i=6 t=1.7e-04 per=1.3e+01 cost=1.1e+05 flops=6.3e+08
 sigma[gemm] counter=42 i=7 t=1.8e-04 per=1.4e+01 cost=1.1e+05 flops=6.1e+08
 sigma[gemm] counter=42 total t=6.8e-04 per=5.2e+01 cost=3.5e+05 flops=5.2e+08
 sigma[red] counter=42 t=4.8e-04 per=3.7e+01 cost=8.1e+04 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=6.2e-03 t_gemm=3.1e-02 t_reduction=3.4e-02 tot=7.1e-02 ---
 sigma_tot[inter] counter=42 t=6.2e-03 per=8.8e+00 cost=3.0e+07 flops=4.9e+09
 sigma_tot[gemm] counter=42 i=0 t=1.1e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=1 t=9.5e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=2 t=9.4e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=3 t=9.3e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=4 t=7.5e-03 per=1.1e+01 cost=5.3e+06 flops=7.1e+08
 sigma_tot[gemm] counter=42 i=5 t=7.7e-03 per=1.1e+01 cost=5.4e+06 flops=7.0e+08
 sigma_tot[gemm] counter=42 i=6 t=7.7e-03 per=1.1e+01 cost=6.6e+06 flops=8.5e+08
 sigma_tot[gemm] counter=42 i=7 t=7.6e-03 per=1.1e+01 cost=7.1e+06 flops=9.3e+08
 sigma_tot[gemm] counter=42 total t=3.1e-02 per=4.4e+01 cost=2.4e+07 flops=7.9e+08
 sigma_tot[red] counter=42 t=3.4e-02 per=4.7e+01 cost=5.8e+06 flops=1.7e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.1e-05,1.6e-06,9.3e-07,1.5e-07
    5   0 -    -116.238042505393 -2.279e-05  7.202e-04    3     5  1.874e-02 3.747e-03 3.493e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.646e-05,1.362e-04,6.775e-04,4.802e-04,1.325e-03
 ndim=62:4.619e-07GB t[comm(intra)]=2.135e-05 speed=4.328e-02GB/S t[comm(inter)]=5.113e-06 speed=1.807e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=6.8e-04 t_reduction=4.8e-04 tot=1.3e-03 ---
 sigma[inter] counter=43 t=1.4e-04 per=1.1e+01 cost=5.0e+05 flops=3.6e+09
 sigma[gemm] counter=43 i=0 t=2.4e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=1 t=2.3e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=2 t=2.3e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=3 t=2.3e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=4 t=1.7e-04 per=1.3e+01 cost=6.8e+04 flops=4.1e+08
 sigma[gemm] counter=43 i=5 t=1.6e-04 per=1.2e+01 cost=6.9e+04 flops=4.5e+08
 sigma[gemm] counter=43 i=6 t=1.7e-04 per=1.3e+01 cost=1.1e+05 flops=6.4e+08
 sigma[gemm] counter=43 i=7 t=1.8e-04 per=1.4e+01 cost=1.1e+05 flops=6.1e+08
 sigma[gemm] counter=43 total t=6.8e-04 per=5.2e+01 cost=3.5e+05 flops=5.2e+08
 sigma[red] counter=43 t=4.8e-04 per=3.7e+01 cost=8.1e+04 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=6.4e-03 t_gemm=3.2e-02 t_reduction=3.4e-02 tot=7.2e-02 ---
 sigma_tot[inter] counter=43 t=6.4e-03 per=8.8e+00 cost=3.1e+07 flops=4.9e+09
 sigma_tot[gemm] counter=43 i=0 t=1.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=1 t=9.8e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=2 t=9.6e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=3 t=9.6e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=4 t=7.7e-03 per=1.1e+01 cost=5.4e+06 flops=7.0e+08
 sigma_tot[gemm] counter=43 i=5 t=7.9e-03 per=1.1e+01 cost=5.5e+06 flops=7.0e+08
 sigma_tot[gemm] counter=43 i=6 t=7.9e-03 per=1.1e+01 cost=6.7e+06 flops=8.4e+08
 sigma_tot[gemm] counter=43 i=7 t=7.8e-03 per=1.1e+01 cost=7.2e+06 flops=9.3e+08
 sigma_tot[gemm] counter=43 total t=3.2e-02 per=4.4e+01 cost=2.5e+07 flops=7.8e+08
 sigma_tot[red] counter=43 t=3.4e-02 per=4.7e+01 cost=5.9e+06 flops=1.7e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,1.0e-05,1.6e-06,8.6e-07,1.3e-07
    6   0 -    -116.238044081056 -1.576e-06  1.845e-04    3     6  2.216e-02 3.694e-03 3.451e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.691e-05,1.390e-04,7.132e-04,4.777e-04,1.361e-03
 ndim=62:4.619e-07GB t[comm(intra)]=2.142e-05 speed=4.313e-02GB/S t[comm(inter)]=5.488e-06 speed=1.683e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=7.1e-04 t_reduction=4.8e-04 tot=1.3e-03 ---
 sigma[inter] counter=44 t=1.4e-04 per=1.0e+01 cost=5.0e+05 flops=3.6e+09
 sigma[gemm] counter=44 i=0 t=2.3e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=1 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=2 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=3 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=4 t=1.7e-04 per=1.3e+01 cost=6.8e+04 flops=4.1e+08
 sigma[gemm] counter=44 i=5 t=1.7e-04 per=1.2e+01 cost=6.9e+04 flops=4.2e+08
 sigma[gemm] counter=44 i=6 t=1.8e-04 per=1.4e+01 cost=1.1e+05 flops=6.0e+08
 sigma[gemm] counter=44 i=7 t=1.9e-04 per=1.4e+01 cost=1.1e+05 flops=5.7e+08
 sigma[gemm] counter=44 total t=7.1e-04 per=5.4e+01 cost=3.5e+05 flops=5.0e+08
 sigma[red] counter=44 t=4.8e-04 per=3.6e+01 cost=8.1e+04 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=6.5e-03 t_gemm=3.2e-02 t_reduction=3.5e-02 tot=7.3e-02 ---
 sigma_tot[inter] counter=44 t=6.5e-03 per=8.8e+00 cost=3.1e+07 flops=4.8e+09
 sigma_tot[gemm] counter=44 i=0 t=1.1e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=1 t=1.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=2 t=9.9e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=3 t=9.8e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=4 t=7.9e-03 per=1.1e+01 cost=5.5e+06 flops=7.0e+08
 sigma_tot[gemm] counter=44 i=5 t=8.1e-03 per=1.1e+01 cost=5.6e+06 flops=6.9e+08
 sigma_tot[gemm] counter=44 i=6 t=8.1e-03 per=1.1e+01 cost=6.8e+06 flops=8.4e+08
 sigma_tot[gemm] counter=44 i=7 t=8.0e-03 per=1.1e+01 cost=7.3e+06 flops=9.2e+08
 sigma_tot[gemm] counter=44 total t=3.2e-02 per=4.4e+01 cost=2.5e+07 flops=7.8e+08
 sigma_tot[red] counter=44 t=3.5e-02 per=4.7e+01 cost=6.0e+06 flops=1.7e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,9.9e-06,1.6e-06,9.2e-07,1.3e-07
    7   0 +    -116.238044195480 -1.144e-07  5.542e-05    3     7  2.563e-02 3.661e-03 3.428e-03
TIMING FOR Davidson : 2.570e-02  T(cal/comm/rest)=2.399e-02,2.910e-07,1.712e-03
decomposed t_rest=1.712e-03
 T(sub)    =1.106e-04 per=6.461e+00
 T(precond)=1.664e-04 per=9.724e+00
 T(ortho)  =8.866e-06 per=5.180e-01
 T(xcopy)  =8.540e-07 per=4.990e-02
 T(xnrm2)  =1.092e-06 per=6.380e-02
 T(other)  =1.424e-03 per=8.318e+01
optimized energies: isweep=0 ibond=6 dots=2 e[0]=-116.238044195480 nmvp=7
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:1.318e+01S Sys:1.125e+00S Total:1.430e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond6.txt
 qbond: qsuper nsym=11 dimAll=37
 (10,2):6 (12,2):4 (11,1):8 (11,3):6 (10,0):4 (12,0):3 (9,3):1 (10,4):2 (12,4):1 (11,5):1 (9,1):1
----- TMING FOR decimation_genbasis(su2): 8.0e-05 S -----
decimation summary: 37->10 dwt=+2.363e-04 SvN=1.336e+00
 qbond: qkept nsym=5 dimAll=10
 (12,2):4 (12,0):3 (11,1):1 (11,3):1 (12,4):1
----- TIMING for decimation_row(nkr): 3.349e-03 S T(decim/select/formRot)=3.880e-04,2.797e-03,1.641e-04 -----
----- TIMING FOR twodot_decimation: 3.585e-03 S T(wf/decim)=1.583e-04,3.427e-03 -----
ctns::oper_renorm coord=(7,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:8 S:12 H:1 A:64 B:72 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3184:2.429e-02MB:2.372e-05GB
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:1.341e+01S Sys:1.125e+00S Total:1.453e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=157 : 4.550e-04 S -----
rank=0 GPUmem(GB): used=9.38e-05 (oper)=5.01e-05
rank=0 GPUmem(GB): used=9.41e-05 (oper,site)(GB)=5.01e-05,2.98e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=157
 no. of rintermediate operators=113
 no. of coefficients=2324:0.0177MB:1.73e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.458e-04 S -----
rank=0 GPUmem(GB): used=0.000111 (oper,site,rinter)=5.01e-05,2.98e-07,1.73e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00137 S size(rtasks)=157 size(Rlst2)=25 T(Rmu/Rlist)=0.000103,0.00127 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0015 S size(rtasks)=157 size(Rlst)=1585 -----
rank=0 GPUmem(GB): used=0.000111 (oper,site,rinter,batch)=5.01e-05,2.98e-07,1.73e-05,0.000579 blksize=16 blksize0=16 batchsize=1585
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00017,0.000577,0.000217
--- TIMING FOR renorm : t_inter=1.7e-04 t_gemm=5.8e-04 t_reduction=2.2e-04 tot=9.6e-04 ---
 renorm[inter] counter=7 t=1.7e-04 per=1.8e+01 cost=1.8e+05 flops=1.0e+09
 renorm[gemm] counter=7 i=0 t=2.7e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=1 t=2.2e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=2 t=2.2e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=3 t=2.2e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=4 t=1.9e-04 per=2.0e+01 cost=1.2e+04 flops=6.1e+07
 renorm[gemm] counter=7 i=5 t=1.9e-04 per=2.0e+01 cost=3.7e+04 flops=1.9e+08
 renorm[gemm] counter=7 i=6 t=1.8e-04 per=1.9e+01 cost=2.8e+04 flops=1.5e+08
 renorm[gemm] counter=7 total t=5.8e-04 per=6.0e+01 cost=7.6e+04 flops=1.3e+08
 renorm[red] counter=7 t=2.2e-04 per=2.3e+01 cost=9.0e+03 flops=4.2e+07
--- TIMING FOR renorm_tot : t_inter=9.3e-04 t_gemm=3.9e-03 t_reduction=1.5e-03 tot=6.3e-03 ---
 renorm_tot[inter] counter=7 t=9.3e-04 per=1.5e+01 cost=5.5e+05 flops=5.9e+08
 renorm_tot[gemm] counter=7 i=0 t=2.0e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=1 t=1.6e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=2 t=1.5e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=3 t=1.5e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=7 i=4 t=1.3e-03 per=2.1e+01 cost=7.0e+04 flops=5.3e+07
 renorm_tot[gemm] counter=7 i=5 t=1.2e-03 per=1.9e+01 cost=1.5e+05 flops=1.2e+08
 renorm_tot[gemm] counter=7 i=6 t=1.3e-03 per=2.0e+01 cost=1.7e+05 flops=1.4e+08
 renorm_tot[gemm] counter=7 total t=3.9e-03 per=6.2e+01 cost=3.9e+05 flops=1.0e+08
 renorm_tot[red] counter=7 t=1.5e-03 per=2.3e+01 cost=7.0e+04 flops=4.7e+07
qops.to_cpu: size(tot)=3184:2.4e-02MB:2.4e-05GB t[to_cpu]=2.2e-05S speed=1.1e+00GB/S
check ||H-H.dagger||=5.244e-15 coord=(7,0) rank=0
ctns::oper_ab2pq coord=(7,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0068 S rank=0 -----
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:1.353e+01S Sys:1.125e+00S Total:1.465e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=704:5.371e-03MB:5.245e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=49:3.738e-04MB:3.651e-07GB
total mem of comb=754:5.753e-03MB:5.618e-06GB
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:1.353e+01S Sys:1.125e+00S Total:1.466e+01S
##### local opt: 7.499e-02 S #####
 T(local opt: fetch) = 6.287e-03 S  per = 8.38  per(accum) = 8.38
 T(local opt: hdiag) = 6.182e-03 S  per = 8.24  per(accum) = 16.6
 T(local opt: dvdsn) = 4.543e-02 S  per = 60.6  per(accum) = 77.2
 T(local opt: decim) = 3.668e-03 S  per = 4.89  per(accum) = 82.1
 T(local opt: guess) = 1.404e-04 S  per = 0.187  per(accum) = 82.3
 T(local opt: renrm) = 7.661e-03 S  per = 10.2  per(accum) = 92.5
 T(local opt: save ) = 5.617e-03 S  per = 7.49  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.543e-02 S  T(sum) = 4.454e-02 S  per = 9.803e+01
 T(local opt: preprocess                  ) = 8.853e-04 S  per = 1.99  per(accum) = 1.99
 T(local opt: symbolic_formulae           ) = 1.462e-03 S  per = 3.28  per(accum) = 5.27
 T(local opt: hintermediate init          ) = 5.682e-04 S  per = 1.28  per(accum) = 6.55
 T(local opt: preprocess_hformulae_Hxlist ) = 1.356e-02 S  per = 30.4  per(accum) = 37
 T(local opt: hmmtasks init               ) = 2.077e-03 S  per = 4.66  per(accum) = 41.6
 T(local opt: initial guess for dvdson    ) = 2.848e-04 S  per = 0.639  per(accum) = 42.3
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.380e-02 S  per = 53.4  per(accum) = 95.7
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.939e-04 S  per = 0.435  per(accum) = 96.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.910e-07 S  per = 0.000653  per(accum) = 96.2
 T(local opt: dvdson solver [rest part]   ) = 1.712e-03 S  per = 3.84  per(accum) = 100
Detailed decomposition of T(renrm) = 7.661e-03 S  T(sum) = 7.661e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.195e-04 S  per = 1.56  per(accum) = 1.56
 T(local opt: qops init                    ) = 5.543e-04 S  per = 7.24  per(accum) = 8.8
 T(local opt: symbolic_formulae_renorm     ) = 5.545e-04 S  per = 7.24  per(accum) = 16
 T(local opt: allocate qops on gpu         ) = 9.608e-05 S  per = 1.25  per(accum) = 17.3
 T(local opt: site memcpy cpu2gpu          ) = 9.197e-05 S  per =  1.2  per(accum) = 18.5
 T(local opt: rintermediate init           ) = 4.993e-04 S  per = 6.52  per(accum) = 25
 T(local opt: preprocess_formulae_Rlist2   ) = 1.582e-03 S  per = 20.7  per(accum) = 45.7
 T(local opt: rmmtasks init                ) = 4.794e-04 S  per = 6.26  per(accum) = 51.9
 T(local opt: qops memset on cpu           ) = 7.800e-08 S  per = 0.00102  per(accum) = 51.9
 T(local opt: preprocess_renorm_batchGPU   ) = 2.742e-03 S  per = 35.8  per(accum) = 87.7
 T(local opt: reduction of opS & opH [nccl]) = 5.620e-07 S  per = 0.00734  per(accum) = 87.7
 T(local opt: qops memcpy gpu2cpu          ) = 1.040e-04 S  per = 1.36  per(accum) = 89.1
 T(local opt: deallocate cpu and gpu memory) = 1.020e-05 S  per = 0.133  per(accum) = 89.2
 T(local opt: reduction of opS & opH [comm]) = 8.380e-05 S  per = 1.09  per(accum) = 90.3
 T(local opt: conversion from opAB to opPQ ) = 6.400e-05 S  per = 0.835  per(accum) = 91.1
 T(local opt: after oper_renorm            ) = 6.786e-04 S  per = 8.86  per(accum) = 100
##### sweep opt: 5.266e-01 S #####
 T(sweep opt: fetch) = 4.916e-02 S  per = 9.34  per(accum) = 9.34
 T(sweep opt: hdiag) = 2.892e-02 S  per = 5.49  per(accum) = 14.8
 T(sweep opt: dvdsn) = 3.405e-01 S  per = 64.7  per(accum) = 79.5
 T(sweep opt: decim) = 2.756e-02 S  per = 5.23  per(accum) = 84.7
 T(sweep opt: guess) = 1.307e-03 S  per = 0.248  per(accum) = 85
 T(sweep opt: renrm) = 4.730e-02 S  per = 8.98  per(accum) = 94
 T(sweep opt: save ) = 3.183e-02 S  per = 6.05  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.405e-01 S  T(sum) = 3.345e-01 S  per = 9.823e+01
 T(sweep opt: preprocess                  ) = 5.220e-03 S  per = 1.56  per(accum) = 1.56
 T(sweep opt: symbolic_formulae           ) = 6.302e-03 S  per = 1.88  per(accum) = 3.44
 T(sweep opt: hintermediate init          ) = 3.996e-03 S  per = 1.19  per(accum) = 4.64
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.210e-01 S  per = 36.2  per(accum) = 40.8
 T(sweep opt: hmmtasks init               ) = 2.159e-02 S  per = 6.45  per(accum) = 47.3
 T(sweep opt: initial guess for dvdson    ) = 1.799e-03 S  per = 0.538  per(accum) = 47.8
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.616e-01 S  per = 48.3  per(accum) = 96.1
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 1.260e-03 S  per = 0.377  per(accum) = 96.5
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.124e-06 S  per = 0.000635  per(accum) = 96.5
 T(sweep opt: dvdson solver [rest part]   ) = 1.164e-02 S  per = 3.48  per(accum) = 100
Detailed decomposition of T(renrm) = 4.730e-02 S  T(sum) = 4.730e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.291e-04 S  per = 1.96  per(accum) = 1.96
 T(sweep opt: qops init                    ) = 2.879e-03 S  per = 6.09  per(accum) = 8.05
 T(sweep opt: symbolic_formulae_renorm     ) = 2.571e-03 S  per = 5.44  per(accum) = 13.5
 T(sweep opt: allocate qops on gpu         ) = 6.681e-04 S  per = 1.41  per(accum) = 14.9
 T(sweep opt: site memcpy cpu2gpu          ) = 6.225e-04 S  per = 1.32  per(accum) = 16.2
 T(sweep opt: rintermediate init           ) = 3.269e-03 S  per = 6.91  per(accum) = 23.1
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.243e-03 S  per = 17.4  per(accum) = 40.6
 T(sweep opt: rmmtasks init                ) = 2.784e-03 S  per = 5.89  per(accum) = 46.4
 T(sweep opt: qops memset on cpu           ) = 3.300e-07 S  per = 0.000698  per(accum) = 46.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.861e-02 S  per = 39.3  per(accum) = 85.8
 T(sweep opt: reduction of opS & opH [nccl]) = 4.001e-06 S  per = 0.00846  per(accum) = 85.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.513e-04 S  per = 1.38  per(accum) = 87.2
 T(sweep opt: deallocate cpu and gpu memory) = 7.788e-05 S  per = 0.165  per(accum) = 87.3
 T(sweep opt: reduction of opS & opH [comm]) = 6.031e-04 S  per = 1.28  per(accum) = 88.6
 T(sweep opt: conversion from opAB to opPQ ) = 5.193e-04 S  per =  1.1  per(accum) = 89.7
 T(sweep opt: after oper_renorm            ) = 4.868e-03 S  per = 10.3  per(accum) = 100
##### global opt: 5.266e-01 S #####
 T(global opt: fetch) = 4.916e-02 S  per = 9.34  per(accum) = 9.34
 T(global opt: hdiag) = 2.892e-02 S  per = 5.49  per(accum) = 14.8
 T(global opt: dvdsn) = 3.405e-01 S  per = 64.7  per(accum) = 79.5
 T(global opt: decim) = 2.756e-02 S  per = 5.23  per(accum) = 84.7
 T(global opt: guess) = 1.307e-03 S  per = 0.248  per(accum) = 85
 T(global opt: renrm) = 4.730e-02 S  per = 8.98  per(accum) = 94
 T(global opt: save ) = 3.183e-02 S  per = 6.05  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.405e-01 S  T(sum) = 3.345e-01 S  per = 9.823e+01
 T(global opt: preprocess                  ) = 5.220e-03 S  per = 1.56  per(accum) = 1.56
 T(global opt: symbolic_formulae           ) = 6.302e-03 S  per = 1.88  per(accum) = 3.44
 T(global opt: hintermediate init          ) = 3.996e-03 S  per = 1.19  per(accum) = 4.64
 T(global opt: preprocess_hformulae_Hxlist ) = 1.210e-01 S  per = 36.2  per(accum) = 40.8
 T(global opt: hmmtasks init               ) = 2.159e-02 S  per = 6.45  per(accum) = 47.3
 T(global opt: initial guess for dvdson    ) = 1.799e-03 S  per = 0.538  per(accum) = 47.8
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.616e-01 S  per = 48.3  per(accum) = 96.1
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.260e-03 S  per = 0.377  per(accum) = 96.5
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.124e-06 S  per = 0.000635  per(accum) = 96.5
 T(global opt: dvdson solver [rest part]   ) = 1.164e-02 S  per = 3.48  per(accum) = 100
Detailed decomposition of T(renrm) = 4.730e-02 S  T(sum) = 4.730e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.291e-04 S  per = 1.96  per(accum) = 1.96
 T(global opt: qops init                    ) = 2.879e-03 S  per = 6.09  per(accum) = 8.05
 T(global opt: symbolic_formulae_renorm     ) = 2.571e-03 S  per = 5.44  per(accum) = 13.5
 T(global opt: allocate qops on gpu         ) = 6.681e-04 S  per = 1.41  per(accum) = 14.9
 T(global opt: site memcpy cpu2gpu          ) = 6.225e-04 S  per = 1.32  per(accum) = 16.2
 T(global opt: rintermediate init           ) = 3.269e-03 S  per = 6.91  per(accum) = 23.1
 T(global opt: preprocess_formulae_Rlist2   ) = 8.243e-03 S  per = 17.4  per(accum) = 40.6
 T(global opt: rmmtasks init                ) = 2.784e-03 S  per = 5.89  per(accum) = 46.4
 T(global opt: qops memset on cpu           ) = 3.300e-07 S  per = 0.000698  per(accum) = 46.4
 T(global opt: preprocess_renorm_batchGPU   ) = 1.861e-02 S  per = 39.3  per(accum) = 85.8
 T(global opt: reduction of opS & opH [nccl]) = 4.001e-06 S  per = 0.00846  per(accum) = 85.8
 T(global opt: qops memcpy gpu2cpu          ) = 6.513e-04 S  per = 1.38  per(accum) = 87.2
 T(global opt: deallocate cpu and gpu memory) = 7.788e-05 S  per = 0.165  per(accum) = 87.3
 T(global opt: reduction of opS & opH [comm]) = 6.031e-04 S  per = 1.28  per(accum) = 88.6
 T(global opt: conversion from opAB to opPQ ) = 5.193e-04 S  per =  1.1  per(accum) = 89.7
 T(global opt: after oper_renorm            ) = 4.868e-03 S  per = 10.3  per(accum) = 100

isweep=0 ibond=7/seqsize=34 dots=2 dbond=(8,0)-(9,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.250e+01GB RSS:5.747e-01GB  Timing: User:1.353e+01S Sys:1.125e+00S Total:1.466e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=704:5.371e-03MB:5.245e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=49:3.738e-04MB:3.651e-07GB
total mem of comb=754:5.753e-03MB:5.618e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=8,10,1,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc1= 19
 suppc2= 5
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:8 S:12 H:1 A:64 B:72 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3184:2.429e-02MB:2.372e-05GB
 rqops: oplist=CSHPQ nops=C:10 S:10 H:1 P:100 Q:110 
        dim(bra,ket)=16,16 size(op)=168:1.282e-03MB size(tot)=13560:1.035e-01MB:1.010e-04GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=18740:1.430e-01MB:1.396e-04GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(8,0) fdel=./scratch/sweep/rop(9,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
wf4(diml,dimr,dimc1,dimc2)=(10,16,3,3) nnz=168:1.282e-03MB
qtensor4: wf4 own=1 _data=0x55a32284c7c0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (12,2):4 (12,0):3 (11,1):1 (11,3):1 (12,4):1
 qbond: qcol nsym=5 dimAll=16
 (15,1):4 (15,3):6 (15,5):4 (16,2):1 (16,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=29 nblocks=380 size=168:1.282e-03MB
### DIAG TIMING: total=9.733e-03 t1=1.005e-05, t2=1.705e-05, t3=1.765e-05, t4=9.662e-03, t5=4.298e-06, t6=1.783e-05, t7=3.906e-06
duration_diagGPU:9.833e-03
duration_diagreduce:2.800e-08
duration_diagtransform:4.130e-07
----- TIMING FOR symbolic_formulae_twodot with size=837 : 1.594e-03 S -----
rank=0 GPUmem(GB): used=0.00014 (oper)=0.00014
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=837
 no. of hintermediate operators=392
 no. of coefficients=5612:0.0428MB:4.18e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.711e-04 S -----
rank=0 GPUmem(GB): used=0.000181 (oper,hinter)=0.00014,4.18e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0462 S size(H_formulae)=837 size(Hxlst2)=29 T(Hmu/Hxlist)=0.000309,0.0459 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0471 S size(H_formulae)=837 size(Hxlst)=29740 -----
rank=0 GPUmem(GB): used=0.0146 (oper,hinter,dvdson,batch)=0.00014,4.18e-05,2.5e-06,0.0144 blksize=24 blksize0=16 batchsize=29740
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=168 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.31e-05,0.000256,0.00149,0.00107,0.00287
 ndim=168:1.25e-06GB t[comm(intra)]=3.58e-05 speed=0.0699GB/S t[comm(inter)]=7.28e-06 speed=0.344GB/S
--- TIMING FOR sigma : t_inter=2.6e-04 t_gemm=1.5e-03 t_reduction=1.1e-03 tot=2.8e-03 ---
 sigma[inter] counter=45 t=2.6e-04 per=9.1e+00 cost=2.0e+06 flops=7.9e+09
 sigma[gemm] counter=45 i=0 t=2.8e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=1 t=2.2e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=2 t=2.2e-06 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=3 t=2.2e-06 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=4 t=3.7e-04 per=1.3e+01 cost=4.1e+05 flops=1.1e+09
 sigma[gemm] counter=45 i=5 t=4.1e-04 per=1.5e+01 cost=4.1e+05 flops=9.9e+08
 sigma[gemm] counter=45 i=6 t=3.5e-04 per=1.2e+01 cost=4.5e+05 flops=1.3e+09
 sigma[gemm] counter=45 i=7 t=3.5e-04 per=1.2e+01 cost=4.6e+05 flops=1.3e+09
 sigma[gemm] counter=45 total t=1.5e-03 per=5.3e+01 cost=1.7e+06 flops=1.2e+09
 sigma[red] counter=45 t=1.1e-03 per=3.8e+01 cost=3.7e+05 flops=3.5e+08
--- TIMING FOR sigma_tot : t_inter=6.7e-03 t_gemm=3.4e-02 t_reduction=3.6e-02 tot=7.6e-02 ---
 sigma_tot[inter] counter=45 t=6.7e-03 per=8.8e+00 cost=3.3e+07 flops=5.0e+09
 sigma_tot[gemm] counter=45 i=0 t=1.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=1 t=1.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=2 t=1.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=3 t=1.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=4 t=8.2e-03 per=1.1e+01 cost=5.9e+06 flops=7.1e+08
 sigma_tot[gemm] counter=45 i=5 t=8.5e-03 per=1.1e+01 cost=6.0e+06 flops=7.1e+08
 sigma_tot[gemm] counter=45 i=6 t=8.4e-03 per=1.1e+01 cost=7.2e+06 flops=8.6e+08
 sigma_tot[gemm] counter=45 i=7 t=8.3e-03 per=1.1e+01 cost=7.8e+06 flops=9.3e+08
 sigma_tot[gemm] counter=45 total t=3.4e-02 per=4.4e+01 cost=2.7e+07 flops=7.9e+08
 sigma_tot[red] counter=45 t=3.6e-02 per=4.7e+01 cost=6.3e+06 flops=1.8e+08
T(sub)=8.2e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,3.3e-06,9.1e-07,8.2e-07,2.4e-07
settings: ndim=168 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.237931699329 -1.116e+03  5.705e-02    1     1  5.134e-03 5.134e-03 4.955e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.849e-05,1.908e-04,1.079e-03,9.960e-04,2.300e-03
 ndim=168:1.252e-06GB t[comm(intra)]=2.276e-05 speed=1.100e-01GB/S t[comm(inter)]=5.730e-06 speed=4.369e-01GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=1.0e-03 tot=2.3e-03 ---
 sigma[inter] counter=46 t=1.9e-04 per=8.4e+00 cost=2.0e+06 flops=1.1e+10
 sigma[gemm] counter=46 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=1 t=2.2e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=2 t=2.2e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=3 t=2.2e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=4 t=2.7e-04 per=1.2e+01 cost=4.1e+05 flops=1.5e+09
 sigma[gemm] counter=46 i=5 t=2.7e-04 per=1.2e+01 cost=4.1e+05 flops=1.5e+09
 sigma[gemm] counter=46 i=6 t=2.7e-04 per=1.2e+01 cost=4.5e+05 flops=1.7e+09
 sigma[gemm] counter=46 i=7 t=2.6e-04 per=1.2e+01 cost=4.6e+05 flops=1.8e+09
 sigma[gemm] counter=46 total t=1.1e-03 per=4.8e+01 cost=1.7e+06 flops=1.6e+09
 sigma[red] counter=46 t=1.0e-03 per=4.4e+01 cost=3.7e+05 flops=3.7e+08
--- TIMING FOR sigma_tot : t_inter=6.9e-03 t_gemm=3.5e-02 t_reduction=3.7e-02 tot=7.8e-02 ---
 sigma_tot[inter] counter=46 t=6.9e-03 per=8.8e+00 cost=3.5e+07 flops=5.1e+09
 sigma_tot[gemm] counter=46 i=0 t=1.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=1 t=1.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=2 t=1.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=3 t=1.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=4 t=8.5e-03 per=1.1e+01 cost=6.3e+06 flops=7.4e+08
 sigma_tot[gemm] counter=46 i=5 t=8.7e-03 per=1.1e+01 cost=6.4e+06 flops=7.3e+08
 sigma_tot[gemm] counter=46 i=6 t=8.7e-03 per=1.1e+01 cost=7.7e+06 flops=8.8e+08
 sigma_tot[gemm] counter=46 i=7 t=8.6e-03 per=1.1e+01 cost=8.2e+06 flops=9.6e+08
 sigma_tot[gemm] counter=46 total t=3.5e-02 per=4.5e+01 cost=2.9e+07 flops=8.2e+08
 sigma_tot[red] counter=46 t=3.7e-02 per=4.7e+01 cost=6.7e+06 flops=1.8e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.9e-06,1.0e-05,2.2e-06,1.2e-06,1.9e-07
    2   0 -    -116.247601693789 -9.670e-03  2.179e-02    2     2  9.939e-03 4.969e-03 4.620e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.780e-05,1.881e-04,1.077e-03,1.000e-03,2.298e-03
 ndim=168:1.252e-06GB t[comm(intra)]=2.217e-05 speed=1.129e-01GB/S t[comm(inter)]=5.625e-06 speed=4.450e-01GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=1.0e-03 tot=2.3e-03 ---
 sigma[inter] counter=47 t=1.9e-04 per=8.3e+00 cost=2.0e+06 flops=1.1e+10
 sigma[gemm] counter=47 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=1 t=2.2e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=2 t=2.2e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=3 t=2.2e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=4 t=2.6e-04 per=1.2e+01 cost=4.1e+05 flops=1.6e+09
 sigma[gemm] counter=47 i=5 t=2.8e-04 per=1.2e+01 cost=4.1e+05 flops=1.5e+09
 sigma[gemm] counter=47 i=6 t=2.6e-04 per=1.2e+01 cost=4.5e+05 flops=1.7e+09
 sigma[gemm] counter=47 i=7 t=2.6e-04 per=1.2e+01 cost=4.6e+05 flops=1.8e+09
 sigma[gemm] counter=47 total t=1.1e-03 per=4.8e+01 cost=1.7e+06 flops=1.6e+09
 sigma[red] counter=47 t=1.0e-03 per=4.4e+01 cost=3.7e+05 flops=3.7e+08
--- TIMING FOR sigma_tot : t_inter=7.1e-03 t_gemm=3.6e-02 t_reduction=3.8e-02 tot=8.1e-02 ---
 sigma_tot[inter] counter=47 t=7.1e-03 per=8.8e+00 cost=3.7e+07 flops=5.3e+09
 sigma_tot[gemm] counter=47 i=0 t=1.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=1 t=1.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=2 t=1.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=3 t=1.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=4 t=8.8e-03 per=1.1e+01 cost=6.7e+06 flops=7.6e+08
 sigma_tot[gemm] counter=47 i=5 t=9.0e-03 per=1.1e+01 cost=6.8e+06 flops=7.5e+08
 sigma_tot[gemm] counter=47 i=6 t=9.0e-03 per=1.1e+01 cost=8.1e+06 flops=9.1e+08
 sigma_tot[gemm] counter=47 i=7 t=8.8e-03 per=1.1e+01 cost=8.7e+06 flops=9.8e+08
 sigma_tot[gemm] counter=47 total t=3.6e-02 per=4.5e+01 cost=3.0e+07 flops=8.4e+08
 sigma_tot[red] counter=47 t=3.8e-02 per=4.7e+01 cost=7.1e+06 flops=1.9e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.3e-05,1.8e-06,1.2e-06,1.9e-07
    3   0 -    -116.248767971210 -1.166e-03  8.644e-03    3     3  1.447e-02 4.824e-03 4.516e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.830e-05,1.948e-04,1.081e-03,1.004e-03,2.313e-03
 ndim=168:1.252e-06GB t[comm(intra)]=2.253e-05 speed=1.111e-01GB/S t[comm(inter)]=5.778e-06 speed=4.333e-01GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=1.0e-03 tot=2.3e-03 ---
 sigma[inter] counter=48 t=1.9e-04 per=8.5e+00 cost=2.0e+06 flops=1.0e+10
 sigma[gemm] counter=48 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=1 t=2.3e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=2 t=2.2e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=3 t=2.3e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=4 t=2.8e-04 per=1.2e+01 cost=4.1e+05 flops=1.5e+09
 sigma[gemm] counter=48 i=5 t=2.6e-04 per=1.2e+01 cost=4.1e+05 flops=1.6e+09
 sigma[gemm] counter=48 i=6 t=2.6e-04 per=1.2e+01 cost=4.5e+05 flops=1.7e+09
 sigma[gemm] counter=48 i=7 t=2.6e-04 per=1.1e+01 cost=4.6e+05 flops=1.8e+09
 sigma[gemm] counter=48 total t=1.1e-03 per=4.7e+01 cost=1.7e+06 flops=1.6e+09
 sigma[red] counter=48 t=1.0e-03 per=4.4e+01 cost=3.7e+05 flops=3.7e+08
--- TIMING FOR sigma_tot : t_inter=7.3e-03 t_gemm=3.7e-02 t_reduction=3.9e-02 tot=8.3e-02 ---
 sigma_tot[inter] counter=48 t=7.3e-03 per=8.8e+00 cost=4.0e+07 flops=5.4e+09
 sigma_tot[gemm] counter=48 i=0 t=1.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=1 t=1.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=2 t=1.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=3 t=1.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=4 t=9.1e-03 per=1.1e+01 cost=7.1e+06 flops=7.9e+08
 sigma_tot[gemm] counter=48 i=5 t=9.3e-03 per=1.1e+01 cost=7.2e+06 flops=7.8e+08
 sigma_tot[gemm] counter=48 i=6 t=9.2e-03 per=1.1e+01 cost=8.6e+06 flops=9.3e+08
 sigma_tot[gemm] counter=48 i=7 t=9.1e-03 per=1.1e+01 cost=9.1e+06 flops=1.0e+09
 sigma_tot[gemm] counter=48 total t=3.7e-02 per=4.5e+01 cost=3.2e+07 flops=8.6e+08
 sigma_tot[red] counter=48 t=3.9e-02 per=4.6e+01 cost=7.5e+06 flops=1.9e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.1e-05,1.8e-06,1.1e-06,1.7e-07
    4   0 -    -116.248968824981 -2.009e-04  3.032e-03    3     4  1.899e-02 4.747e-03 4.458e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.769e-05,1.881e-04,1.080e-03,1.006e-03,2.307e-03
 ndim=168:1.252e-06GB t[comm(intra)]=2.214e-05 speed=1.131e-01GB/S t[comm(inter)]=5.555e-06 speed=4.507e-01GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=1.0e-03 tot=2.3e-03 ---
 sigma[inter] counter=49 t=1.9e-04 per=8.3e+00 cost=2.0e+06 flops=1.1e+10
 sigma[gemm] counter=49 i=0 t=2.6e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=1 t=2.2e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=2 t=2.2e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=3 t=2.2e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=4 t=2.6e-04 per=1.2e+01 cost=4.1e+05 flops=1.6e+09
 sigma[gemm] counter=49 i=5 t=2.7e-04 per=1.2e+01 cost=4.1e+05 flops=1.5e+09
 sigma[gemm] counter=49 i=6 t=2.7e-04 per=1.2e+01 cost=4.5e+05 flops=1.7e+09
 sigma[gemm] counter=49 i=7 t=2.7e-04 per=1.2e+01 cost=4.6e+05 flops=1.7e+09
 sigma[gemm] counter=49 total t=1.1e-03 per=4.7e+01 cost=1.7e+06 flops=1.6e+09
 sigma[red] counter=49 t=1.0e-03 per=4.4e+01 cost=3.7e+05 flops=3.7e+08
--- TIMING FOR sigma_tot : t_inter=7.5e-03 t_gemm=3.8e-02 t_reduction=4.0e-02 tot=8.5e-02 ---
 sigma_tot[inter] counter=49 t=7.5e-03 per=8.8e+00 cost=4.2e+07 flops=5.5e+09
 sigma_tot[gemm] counter=49 i=0 t=1.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=1 t=1.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=2 t=1.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=3 t=1.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=4 t=9.3e-03 per=1.1e+01 cost=7.5e+06 flops=8.1e+08
 sigma_tot[gemm] counter=49 i=5 t=9.6e-03 per=1.1e+01 cost=7.6e+06 flops=8.0e+08
 sigma_tot[gemm] counter=49 i=6 t=9.5e-03 per=1.1e+01 cost=9.0e+06 flops=9.5e+08
 sigma_tot[gemm] counter=49 i=7 t=9.4e-03 per=1.1e+01 cost=9.6e+06 flops=1.0e+09
 sigma_tot[gemm] counter=49 total t=3.8e-02 per=4.5e+01 cost=3.4e+07 flops=8.8e+08
 sigma_tot[red] counter=49 t=4.0e-02 per=4.6e+01 cost=7.8e+06 flops=2.0e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.1e-05,1.7e-06,1.1e-06,1.4e-07
    5   0 -    -116.248992623280 -2.380e-05  9.245e-04    3     5  2.357e-02 4.715e-03 4.434e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.754e-05,1.873e-04,1.079e-03,9.872e-04,2.286e-03
 ndim=168:1.252e-06GB t[comm(intra)]=2.212e-05 speed=1.132e-01GB/S t[comm(inter)]=5.416e-06 speed=4.622e-01GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=9.9e-04 tot=2.3e-03 ---
 sigma[inter] counter=50 t=1.9e-04 per=8.3e+00 cost=2.0e+06 flops=1.1e+10
 sigma[gemm] counter=50 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=1 t=2.2e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=2 t=2.2e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=3 t=2.2e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=4 t=2.6e-04 per=1.2e+01 cost=4.1e+05 flops=1.6e+09
 sigma[gemm] counter=50 i=5 t=2.6e-04 per=1.2e+01 cost=4.1e+05 flops=1.6e+09
 sigma[gemm] counter=50 i=6 t=2.7e-04 per=1.2e+01 cost=4.5e+05 flops=1.7e+09
 sigma[gemm] counter=50 i=7 t=2.7e-04 per=1.2e+01 cost=4.6e+05 flops=1.7e+09
 sigma[gemm] counter=50 total t=1.1e-03 per=4.8e+01 cost=1.7e+06 flops=1.6e+09
 sigma[red] counter=50 t=9.9e-04 per=4.4e+01 cost=3.7e+05 flops=3.8e+08
--- TIMING FOR sigma_tot : t_inter=7.7e-03 t_gemm=3.9e-02 t_reduction=4.1e-02 tot=8.8e-02 ---
 sigma_tot[inter] counter=50 t=7.7e-03 per=8.8e+00 cost=4.4e+07 flops=5.7e+09
 sigma_tot[gemm] counter=50 i=0 t=1.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=1 t=1.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=2 t=1.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=3 t=1.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=4 t=9.6e-03 per=1.1e+01 cost=7.9e+06 flops=8.3e+08
 sigma_tot[gemm] counter=50 i=5 t=9.8e-03 per=1.1e+01 cost=8.0e+06 flops=8.2e+08
 sigma_tot[gemm] counter=50 i=6 t=9.8e-03 per=1.1e+01 cost=9.5e+06 flops=9.7e+08
 sigma_tot[gemm] counter=50 i=7 t=9.6e-03 per=1.1e+01 cost=1.0e+07 flops=1.0e+09
 sigma_tot[gemm] counter=50 total t=3.9e-02 per=4.5e+01 cost=3.6e+07 flops=9.0e+08
 sigma_tot[red] counter=50 t=4.1e-02 per=4.6e+01 cost=8.2e+06 flops=2.0e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.0e-05,1.7e-06,1.1e-06,1.9e-07
    6   0 -    -116.248994383554 -1.760e-06  1.963e-04    3     6  2.811e-02 4.685e-03 4.411e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.769e-05,1.884e-04,1.070e-03,9.890e-04,2.280e-03
 ndim=168:1.252e-06GB t[comm(intra)]=2.220e-05 speed=1.127e-01GB/S t[comm(inter)]=5.482e-06 speed=4.567e-01GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=9.9e-04 tot=2.2e-03 ---
 sigma[inter] counter=51 t=1.9e-04 per=8.4e+00 cost=2.0e+06 flops=1.1e+10
 sigma[gemm] counter=51 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=1 t=2.2e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=2 t=2.3e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=3 t=2.2e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=4 t=2.6e-04 per=1.2e+01 cost=4.1e+05 flops=1.6e+09
 sigma[gemm] counter=51 i=5 t=2.7e-04 per=1.2e+01 cost=4.1e+05 flops=1.5e+09
 sigma[gemm] counter=51 i=6 t=2.6e-04 per=1.2e+01 cost=4.5e+05 flops=1.7e+09
 sigma[gemm] counter=51 i=7 t=2.6e-04 per=1.2e+01 cost=4.6e+05 flops=1.8e+09
 sigma[gemm] counter=51 total t=1.1e-03 per=4.8e+01 cost=1.7e+06 flops=1.6e+09
 sigma[red] counter=51 t=9.9e-04 per=4.4e+01 cost=3.7e+05 flops=3.8e+08
--- TIMING FOR sigma_tot : t_inter=7.9e-03 t_gemm=4.0e-02 t_reduction=4.2e-02 tot=9.0e-02 ---
 sigma_tot[inter] counter=51 t=7.9e-03 per=8.8e+00 cost=4.6e+07 flops=5.8e+09
 sigma_tot[gemm] counter=51 i=0 t=1.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=1 t=1.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=2 t=1.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=3 t=1.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=4 t=9.9e-03 per=1.1e+01 cost=8.3e+06 flops=8.5e+08
 sigma_tot[gemm] counter=51 i=5 t=1.0e-02 per=1.1e+01 cost=8.4e+06 flops=8.4e+08
 sigma_tot[gemm] counter=51 i=6 t=1.0e-02 per=1.1e+01 cost=9.9e+06 flops=9.9e+08
 sigma_tot[gemm] counter=51 i=7 t=9.9e-03 per=1.1e+01 cost=1.1e+07 flops=1.1e+09
 sigma_tot[gemm] counter=51 total t=4.0e-02 per=4.5e+01 cost=3.7e+07 flops=9.2e+08
 sigma_tot[red] counter=51 t=4.2e-02 per=4.6e+01 cost=8.6e+06 flops=2.1e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.1e-05,1.7e-06,1.0e-06,2.0e-07
    7   0 +    -116.248994471347 -8.779e-08  5.467e-05    3     7  3.270e-02 4.672e-03 4.403e-03
TIMING FOR Davidson : 3.279e-02  T(cal/comm/rest)=3.082e-02,3.310e-07,1.969e-03
decomposed t_rest=1.969e-03
 T(sub)    =1.214e-04 per=6.167e+00
 T(precond)=3.896e-04 per=1.979e+01
 T(ortho)  =1.114e-05 per=5.658e-01
 T(xcopy)  =8.850e-07 per=4.495e-02
 T(xnrm2)  =1.472e-06 per=7.477e-02
 T(other)  =1.444e-03 per=7.335e+01
optimized energies: isweep=0 ibond=7 dots=2 e[0]=-116.248994471347 nmvp=7
CPUmem: VM:7.250e+01GB RSS:5.759e-01GB  Timing: User:1.530e+01S Sys:1.125e+00S Total:1.643e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond7.txt
 qbond: qsuper nsym=11 dimAll=37
 (12,2):6 (14,2):4 (13,1):8 (13,3):6 (12,0):4 (14,0):3 (11,1):1 (11,3):1 (12,4):2 (14,4):1 (13,5):1
----- TMING FOR decimation_genbasis(su2): 7.4e-05 S -----
decimation summary: 37->10 dwt=+5.960e-04 SvN=1.233e+00
 qbond: qkept nsym=5 dimAll=10
 (14,2):4 (14,0):3 (13,1):1 (13,3):1 (14,4):1
----- TIMING for decimation_row(nkr): 3.363e-03 S T(decim/select/formRot)=4.011e-04,2.794e-03,1.686e-04 -----
----- TIMING FOR twodot_decimation: 3.606e-03 S T(wf/decim)=1.613e-04,3.445e-03 -----
ctns::oper_renorm coord=(8,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:9 S:11 H:1 A:81 B:90 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3913:2.985e-02MB:2.915e-05GB
CPUmem: VM:7.250e+01GB RSS:5.759e-01GB  Timing: User:1.547e+01S Sys:1.125e+00S Total:1.659e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=192 : 5.091e-04 S -----
rank=0 GPUmem(GB): used=0.00011 (oper)=6.03e-05
rank=0 GPUmem(GB): used=0.00011 (oper,site)(GB)=6.03e-05,2.98e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=192
 no. of rintermediate operators=104
 no. of coefficients=2732:0.0208MB:2.04e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.500e-04 S -----
rank=0 GPUmem(GB): used=0.00013 (oper,site,rinter)=6.03e-05,2.98e-07,2.04e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00156 S size(rtasks)=192 size(Rlst2)=25 T(Rmu/Rlist)=0.000117,0.00144 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00169 S size(rtasks)=192 size(Rlst)=1829 -----
rank=0 GPUmem(GB): used=0.00013 (oper,site,rinter,batch)=6.03e-05,2.98e-07,2.04e-05,0.000668 blksize=16 blksize0=16 batchsize=1829
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000171,0.000572,0.000215
--- TIMING FOR renorm : t_inter=1.7e-04 t_gemm=5.7e-04 t_reduction=2.1e-04 tot=9.6e-04 ---
 renorm[inter] counter=8 t=1.7e-04 per=1.8e+01 cost=2.1e+05 flops=1.2e+09
 renorm[gemm] counter=8 i=0 t=2.9e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=1 t=2.3e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=2 t=2.2e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=3 t=2.2e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=4 t=1.8e-04 per=1.9e+01 cost=1.1e+04 flops=5.9e+07
 renorm[gemm] counter=8 i=5 t=1.9e-04 per=2.0e+01 cost=4.3e+04 flops=2.2e+08
 renorm[gemm] counter=8 i=6 t=1.9e-04 per=2.0e+01 cost=3.3e+04 flops=1.7e+08
 renorm[gemm] counter=8 total t=5.7e-04 per=6.0e+01 cost=8.7e+04 flops=1.5e+08
 renorm[red] counter=8 t=2.1e-04 per=2.2e+01 cost=1.0e+04 flops=4.9e+07
--- TIMING FOR renorm_tot : t_inter=1.1e-03 t_gemm=4.5e-03 t_reduction=1.7e-03 tot=7.2e-03 ---
 renorm_tot[inter] counter=8 t=1.1e-03 per=1.5e+01 cost=7.6e+05 flops=6.9e+08
 renorm_tot[gemm] counter=8 i=0 t=2.3e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=1 t=1.8e-05 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=2 t=1.8e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=3 t=1.8e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=8 i=4 t=1.5e-03 per=2.1e+01 cost=8.1e+04 flops=5.4e+07
 renorm_tot[gemm] counter=8 i=5 t=1.4e-03 per=2.0e+01 cost=1.9e+05 flops=1.4e+08
 renorm_tot[gemm] counter=8 i=6 t=1.5e-03 per=2.0e+01 cost=2.1e+05 flops=1.4e+08
 renorm_tot[gemm] counter=8 total t=4.5e-03 per=6.1e+01 cost=4.8e+05 flops=1.1e+08
 renorm_tot[red] counter=8 t=1.7e-03 per=2.3e+01 cost=8.0e+04 flops=4.7e+07
qops.to_cpu: size(tot)=3913:3.0e-02MB:2.9e-05GB t[to_cpu]=2.2e-05S speed=1.3e+00GB/S
check ||H-H.dagger||=3.824e-15 coord=(8,0) rank=0
ctns::oper_ab2pq coord=(8,0) superblock=lc ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 0.00583 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.000486,3.13e-06,0.00252,0.00266,3.09e-05,0.00013 -----
----- TIMING FOR oper_renorm : 0.00727 S rank=0 -----
CPUmem: VM:7.250e+01GB RSS:5.775e-01GB  Timing: User:1.579e+01S Sys:1.125e+00S Total:1.692e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=647:4.936e-03MB:4.821e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=80:6.104e-04MB:5.960e-07GB
total mem of comb=728:5.554e-03MB:5.424e-06GB
CPUmem: VM:7.250e+01GB RSS:5.775e-01GB  Timing: User:1.619e+01S Sys:1.125e+00S Total:1.732e+01S
##### local opt: 1.325e-01 S #####
 T(local opt: fetch) = 6.503e-03 S  per = 4.91  per(accum) = 4.91
 T(local opt: hdiag) = 1.076e-02 S  per = 8.12  per(accum) = 13
 T(local opt: dvdsn) = 9.255e-02 S  per = 69.9  per(accum) = 82.9
 T(local opt: decim) = 3.706e-03 S  per =  2.8  per(accum) = 85.7
 T(local opt: guess) = 1.249e-04 S  per = 0.0943  per(accum) = 85.8
 T(local opt: renrm) = 1.428e-02 S  per = 10.8  per(accum) = 96.6
 T(local opt: save ) = 4.543e-03 S  per = 3.43  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.255e-02 S  T(sum) = 9.155e-02 S  per = 9.892e+01
 T(local opt: preprocess                  ) = 7.130e-04 S  per = 0.779  per(accum) = 0.779
 T(local opt: symbolic_formulae           ) = 1.686e-03 S  per = 1.84  per(accum) = 2.62
 T(local opt: hintermediate init          ) = 6.036e-04 S  per = 0.659  per(accum) = 3.28
 T(local opt: preprocess_hformulae_Hxlist ) = 4.733e-02 S  per = 51.7  per(accum) = 55
 T(local opt: hmmtasks init               ) = 8.139e-03 S  per = 8.89  per(accum) = 63.9
 T(local opt: initial guess for dvdson    ) = 2.888e-04 S  per = 0.315  per(accum) = 64.2
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.061e-02 S  per = 33.4  per(accum) = 97.6
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.106e-04 S  per = 0.23  per(accum) = 97.8
 T(local opt: dvdson solver [comm(cpu)]   ) = 3.310e-07 S  per = 0.000362  per(accum) = 97.8
 T(local opt: dvdson solver [rest part]   ) = 1.969e-03 S  per = 2.15  per(accum) = 100
Detailed decomposition of T(renrm) = 1.428e-02 S  T(sum) = 1.428e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.329e-04 S  per = 0.931  per(accum) = 0.931
 T(local opt: qops init                    ) = 6.533e-04 S  per = 4.58  per(accum) = 5.51
 T(local opt: symbolic_formulae_renorm     ) = 6.073e-04 S  per = 4.25  per(accum) = 9.76
 T(local opt: allocate qops on gpu         ) = 1.013e-04 S  per = 0.709  per(accum) = 10.5
 T(local opt: site memcpy cpu2gpu          ) = 1.043e-04 S  per = 0.73  per(accum) = 11.2
 T(local opt: rintermediate init           ) = 4.999e-04 S  per =  3.5  per(accum) = 14.7
 T(local opt: preprocess_formulae_Rlist2   ) = 1.780e-03 S  per = 12.5  per(accum) = 27.2
 T(local opt: rmmtasks init                ) = 5.453e-04 S  per = 3.82  per(accum) = 31
 T(local opt: qops memset on cpu           ) = 6.000e-08 S  per = 0.00042  per(accum) = 31
 T(local opt: preprocess_renorm_batchGPU   ) = 2.768e-03 S  per = 19.4  per(accum) = 50.4
 T(local opt: reduction of opS & opH [nccl]) = 5.350e-07 S  per = 0.00375  per(accum) = 50.4
 T(local opt: qops memcpy gpu2cpu          ) = 9.962e-05 S  per = 0.698  per(accum) = 51.1
 T(local opt: deallocate cpu and gpu memory) = 1.019e-05 S  per = 0.0714  per(accum) = 51.1
 T(local opt: reduction of opS & opH [comm]) = 9.788e-05 S  per = 0.686  per(accum) = 51.8
 T(local opt: conversion from opAB to opPQ ) = 6.029e-03 S  per = 42.2  per(accum) = 94.1
 T(local opt: after oper_renorm            ) = 8.488e-04 S  per = 5.94  per(accum) = 100
##### sweep opt: 6.591e-01 S #####
 T(sweep opt: fetch) = 5.567e-02 S  per = 8.45  per(accum) = 8.45
 T(sweep opt: hdiag) = 3.967e-02 S  per = 6.02  per(accum) = 14.5
 T(sweep opt: dvdsn) = 4.331e-01 S  per = 65.7  per(accum) = 80.2
 T(sweep opt: decim) = 3.126e-02 S  per = 4.74  per(accum) = 84.9
 T(sweep opt: guess) = 1.432e-03 S  per = 0.217  per(accum) = 85.1
 T(sweep opt: renrm) = 6.157e-02 S  per = 9.34  per(accum) = 94.5
 T(sweep opt: save ) = 3.638e-02 S  per = 5.52  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.331e-01 S  T(sum) = 4.260e-01 S  per = 9.837e+01
 T(sweep opt: preprocess                  ) = 5.933e-03 S  per = 1.39  per(accum) = 1.39
 T(sweep opt: symbolic_formulae           ) = 7.988e-03 S  per = 1.87  per(accum) = 3.27
 T(sweep opt: hintermediate init          ) = 4.600e-03 S  per = 1.08  per(accum) = 4.35
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.684e-01 S  per = 39.5  per(accum) = 43.9
 T(sweep opt: hmmtasks init               ) = 2.973e-02 S  per = 6.98  per(accum) = 50.8
 T(sweep opt: initial guess for dvdson    ) = 2.088e-03 S  per = 0.49  per(accum) = 51.3
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.923e-01 S  per = 45.1  per(accum) = 96.5
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 1.471e-03 S  per = 0.345  per(accum) = 96.8
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.455e-06 S  per = 0.000576  per(accum) = 96.8
 T(sweep opt: dvdson solver [rest part]   ) = 1.361e-02 S  per = 3.19  per(accum) = 100
Detailed decomposition of T(renrm) = 6.157e-02 S  T(sum) = 6.157e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.062e-03 S  per = 1.72  per(accum) = 1.72
 T(sweep opt: qops init                    ) = 3.532e-03 S  per = 5.74  per(accum) = 7.46
 T(sweep opt: symbolic_formulae_renorm     ) = 3.178e-03 S  per = 5.16  per(accum) = 12.6
 T(sweep opt: allocate qops on gpu         ) = 7.694e-04 S  per = 1.25  per(accum) = 13.9
 T(sweep opt: site memcpy cpu2gpu          ) = 7.268e-04 S  per = 1.18  per(accum) = 15.1
 T(sweep opt: rintermediate init           ) = 3.769e-03 S  per = 6.12  per(accum) = 21.2
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.002e-02 S  per = 16.3  per(accum) = 37.5
 T(sweep opt: rmmtasks init                ) = 3.329e-03 S  per = 5.41  per(accum) = 42.9
 T(sweep opt: qops memset on cpu           ) = 3.900e-07 S  per = 0.000633  per(accum) = 42.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.137e-02 S  per = 34.7  per(accum) = 77.6
 T(sweep opt: reduction of opS & opH [nccl]) = 4.536e-06 S  per = 0.00737  per(accum) = 77.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.509e-04 S  per = 1.22  per(accum) = 78.8
 T(sweep opt: deallocate cpu and gpu memory) = 8.808e-05 S  per = 0.143  per(accum) = 78.9
 T(sweep opt: reduction of opS & opH [comm]) = 7.010e-04 S  per = 1.14  per(accum) = 80.1
 T(sweep opt: conversion from opAB to opPQ ) = 6.548e-03 S  per = 10.6  per(accum) = 90.7
 T(sweep opt: after oper_renorm            ) = 5.717e-03 S  per = 9.28  per(accum) = 100
##### global opt: 6.591e-01 S #####
 T(global opt: fetch) = 5.567e-02 S  per = 8.45  per(accum) = 8.45
 T(global opt: hdiag) = 3.967e-02 S  per = 6.02  per(accum) = 14.5
 T(global opt: dvdsn) = 4.331e-01 S  per = 65.7  per(accum) = 80.2
 T(global opt: decim) = 3.126e-02 S  per = 4.74  per(accum) = 84.9
 T(global opt: guess) = 1.432e-03 S  per = 0.217  per(accum) = 85.1
 T(global opt: renrm) = 6.157e-02 S  per = 9.34  per(accum) = 94.5
 T(global opt: save ) = 3.638e-02 S  per = 5.52  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.331e-01 S  T(sum) = 4.260e-01 S  per = 9.837e+01
 T(global opt: preprocess                  ) = 5.933e-03 S  per = 1.39  per(accum) = 1.39
 T(global opt: symbolic_formulae           ) = 7.988e-03 S  per = 1.87  per(accum) = 3.27
 T(global opt: hintermediate init          ) = 4.600e-03 S  per = 1.08  per(accum) = 4.35
 T(global opt: preprocess_hformulae_Hxlist ) = 1.684e-01 S  per = 39.5  per(accum) = 43.9
 T(global opt: hmmtasks init               ) = 2.973e-02 S  per = 6.98  per(accum) = 50.8
 T(global opt: initial guess for dvdson    ) = 2.088e-03 S  per = 0.49  per(accum) = 51.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.923e-01 S  per = 45.1  per(accum) = 96.5
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.471e-03 S  per = 0.345  per(accum) = 96.8
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.455e-06 S  per = 0.000576  per(accum) = 96.8
 T(global opt: dvdson solver [rest part]   ) = 1.361e-02 S  per = 3.19  per(accum) = 100
Detailed decomposition of T(renrm) = 6.157e-02 S  T(sum) = 6.157e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.062e-03 S  per = 1.72  per(accum) = 1.72
 T(global opt: qops init                    ) = 3.532e-03 S  per = 5.74  per(accum) = 7.46
 T(global opt: symbolic_formulae_renorm     ) = 3.178e-03 S  per = 5.16  per(accum) = 12.6
 T(global opt: allocate qops on gpu         ) = 7.694e-04 S  per = 1.25  per(accum) = 13.9
 T(global opt: site memcpy cpu2gpu          ) = 7.268e-04 S  per = 1.18  per(accum) = 15.1
 T(global opt: rintermediate init           ) = 3.769e-03 S  per = 6.12  per(accum) = 21.2
 T(global opt: preprocess_formulae_Rlist2   ) = 1.002e-02 S  per = 16.3  per(accum) = 37.5
 T(global opt: rmmtasks init                ) = 3.329e-03 S  per = 5.41  per(accum) = 42.9
 T(global opt: qops memset on cpu           ) = 3.900e-07 S  per = 0.000633  per(accum) = 42.9
 T(global opt: preprocess_renorm_batchGPU   ) = 2.137e-02 S  per = 34.7  per(accum) = 77.6
 T(global opt: reduction of opS & opH [nccl]) = 4.536e-06 S  per = 0.00737  per(accum) = 77.6
 T(global opt: qops memcpy gpu2cpu          ) = 7.509e-04 S  per = 1.22  per(accum) = 78.8
 T(global opt: deallocate cpu and gpu memory) = 8.808e-05 S  per = 0.143  per(accum) = 78.9
 T(global opt: reduction of opS & opH [comm]) = 7.010e-04 S  per = 1.14  per(accum) = 80.1
 T(global opt: conversion from opAB to opPQ ) = 6.548e-03 S  per = 10.6  per(accum) = 90.7
 T(global opt: after oper_renorm            ) = 5.717e-03 S  per = 9.28  per(accum) = 100

isweep=0 ibond=8/seqsize=34 dots=2 dbond=(9,0)-(10,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.250e+01GB RSS:5.775e-01GB  Timing: User:1.619e+01S Sys:1.125e+00S Total:1.732e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=647:4.936e-03MB:4.821e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=80:6.104e-04MB:5.960e-07GB
total mem of comb=728:5.554e-03MB:5.424e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=9,9,1,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc1= 5
 suppc2= 6
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:9 S:11 H:1 P:121 Q:132 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=5614:4.283e-02MB:4.183e-05GB
 rqops: oplist=CSHAB nops=C:9 S:11 H:1 A:81 B:90 
        dim(bra,ket)=9,9 size(op)=65:4.959e-04MB size(tot)=4603:3.512e-02MB:3.430e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=12213:9.318e-02MB:9.099e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(9,0) fdel=./scratch/sweep/rop(10,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
wf4(diml,dimr,dimc1,dimc2)=(10,9,3,3) nnz=151:1.152e-03MB
qtensor4: wf4 own=1 _data=0x55a322dd4f60
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (14,2):4 (14,0):3 (13,1):1 (13,3):1 (14,4):1
 qbond: qcol nsym=3 dimAll=9
 (14,2):4 (14,4):4 (15,3):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=26 nblocks=228 size=151:1.152e-03MB
### DIAG TIMING: total=1.190e-02 t1=9.152e-06, t2=1.499e-05, t3=1.725e-05, t4=1.183e-02, t5=4.608e-06, t6=1.809e-05, t7=4.234e-06
duration_diagGPU:1.200e-02
duration_diagreduce:2.800e-08
duration_diagtransform:3.280e-07
----- TIMING FOR symbolic_formulae_twodot with size=972 : 1.859e-03 S -----
rank=0 GPUmem(GB): used=9.1e-05 (oper)=9.1e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=972
 no. of hintermediate operators=445
 no. of coefficients=6255:0.0477MB:4.66e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.888e-04 S -----
rank=0 GPUmem(GB): used=0.000138 (oper,hinter)=9.1e-05,4.66e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0503 S size(H_formulae)=972 size(Hxlst2)=26 T(Hmu/Hxlist)=0.000359,0.0499 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0511 S size(H_formulae)=972 size(Hxlst)=30986 -----
rank=0 GPUmem(GB): used=0.0115 (oper,hinter,dvdson,batch)=9.1e-05,4.66e-05,2.25e-06,0.0113 blksize=16 blksize0=16 batchsize=30986
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=151 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.47e-05,0.000275,0.00109,0.000988,0.0024
 ndim=151:1.13e-06GB t[comm(intra)]=2.7e-05 speed=0.0834GB/S t[comm(inter)]=7.69e-06 speed=0.292GB/S
--- TIMING FOR sigma : t_inter=2.8e-04 t_gemm=1.1e-03 t_reduction=9.9e-04 tot=2.4e-03 ---
 sigma[inter] counter=52 t=2.8e-04 per=1.2e+01 cost=2.5e+06 flops=9.2e+09
 sigma[gemm] counter=52 i=0 t=2.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=1 t=2.3e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=2 t=2.2e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=3 t=2.2e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=4 t=2.5e-04 per=1.0e+01 cost=6.3e+05 flops=2.5e+09
 sigma[gemm] counter=52 i=5 t=3.0e-04 per=1.3e+01 cost=6.4e+05 flops=2.1e+09
 sigma[gemm] counter=52 i=6 t=2.8e-04 per=1.2e+01 cost=2.9e+05 flops=1.0e+09
 sigma[gemm] counter=52 i=7 t=2.6e-04 per=1.1e+01 cost=3.2e+05 flops=1.2e+09
 sigma[gemm] counter=52 total t=1.1e-03 per=4.6e+01 cost=1.9e+06 flops=1.7e+09
 sigma[red] counter=52 t=9.9e-04 per=4.2e+01 cost=3.9e+05 flops=3.9e+08
--- TIMING FOR sigma_tot : t_inter=8.2e-03 t_gemm=4.1e-02 t_reduction=4.3e-02 tot=9.2e-02 ---
 sigma_tot[inter] counter=52 t=8.2e-03 per=8.9e+00 cost=4.8e+07 flops=5.9e+09
 sigma_tot[gemm] counter=52 i=0 t=1.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=1 t=1.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=2 t=1.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=3 t=1.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=4 t=1.0e-02 per=1.1e+01 cost=9.0e+06 flops=8.9e+08
 sigma_tot[gemm] counter=52 i=5 t=1.0e-02 per=1.1e+01 cost=9.1e+06 flops=8.7e+08
 sigma_tot[gemm] counter=52 i=6 t=1.0e-02 per=1.1e+01 cost=1.0e+07 flops=9.9e+08
 sigma_tot[gemm] counter=52 i=7 t=1.0e-02 per=1.1e+01 cost=1.1e+07 flops=1.1e+09
 sigma_tot[gemm] counter=52 total t=4.1e-02 per=4.5e+01 cost=3.9e+07 flops=9.4e+08
 sigma_tot[red] counter=52 t=4.3e-02 per=4.6e+01 cost=9.0e+06 flops=2.1e+08
T(sub)=8.5e-06 T(gemm/eig/ortho/gemm/axpy)=3.0e-06,3.3e-06,1.0e-06,9.5e-07,2.5e-07
settings: ndim=151 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.248757672847 -1.116e+03  2.443e-02    1     1  4.928e-03 4.928e-03 4.602e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.819e-05,1.680e-04,8.924e-04,9.130e-04,2.007e-03
 ndim=151:1.125e-06GB t[comm(intra)]=2.248e-05 speed=1.001e-01GB/S t[comm(inter)]=5.709e-06 speed=3.941e-01GB/S
--- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=8.9e-04 t_reduction=9.1e-04 tot=2.0e-03 ---
 sigma[inter] counter=53 t=1.7e-04 per=8.5e+00 cost=2.5e+06 flops=1.5e+10
 sigma[gemm] counter=53 i=0 t=2.8e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=1 t=2.3e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=4 t=1.9e-04 per=9.5e+00 cost=6.3e+05 flops=3.4e+09
 sigma[gemm] counter=53 i=5 t=2.8e-04 per=1.4e+01 cost=6.4e+05 flops=2.3e+09
 sigma[gemm] counter=53 i=6 t=2.1e-04 per=1.1e+01 cost=2.9e+05 flops=1.4e+09
 sigma[gemm] counter=53 i=7 t=2.0e-04 per=1.0e+01 cost=3.2e+05 flops=1.6e+09
 sigma[gemm] counter=53 total t=8.9e-04 per=4.5e+01 cost=1.9e+06 flops=2.1e+09
 sigma[red] counter=53 t=9.1e-04 per=4.6e+01 cost=3.9e+05 flops=4.2e+08
--- TIMING FOR sigma_tot : t_inter=8.3e-03 t_gemm=4.2e-02 t_reduction=4.3e-02 tot=9.4e-02 ---
 sigma_tot[inter] counter=53 t=8.3e-03 per=8.8e+00 cost=5.1e+07 flops=6.1e+09
 sigma_tot[gemm] counter=53 i=0 t=1.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=1 t=1.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=2 t=1.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=3 t=1.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=4 t=1.0e-02 per=1.1e+01 cost=9.6e+06 flops=9.3e+08
 sigma_tot[gemm] counter=53 i=5 t=1.1e-02 per=1.1e+01 cost=9.7e+06 flops=9.1e+08
 sigma_tot[gemm] counter=53 i=6 t=1.1e-02 per=1.1e+01 cost=1.1e+07 flops=1.0e+09
 sigma_tot[gemm] counter=53 i=7 t=1.0e-02 per=1.1e+01 cost=1.1e+07 flops=1.1e+09
 sigma_tot[gemm] counter=53 total t=4.2e-02 per=4.5e+01 cost=4.1e+07 flops=9.7e+08
 sigma_tot[red] counter=53 t=4.3e-02 per=4.6e+01 cost=9.3e+06 flops=2.1e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,1.0e-05,2.4e-06,1.2e-06,2.0e-07
    2   0 -    -116.250671974043 -1.914e-03  6.274e-03    2     2  9.493e-03 4.746e-03 4.318e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.798e-05,1.660e-04,8.757e-04,8.972e-04,1.972e-03
 ndim=151:1.125e-06GB t[comm(intra)]=2.232e-05 speed=1.008e-01GB/S t[comm(inter)]=5.656e-06 speed=3.978e-01GB/S
--- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=8.7e-04 t_reduction=9.0e-04 tot=1.9e-03 ---
 sigma[inter] counter=54 t=1.7e-04 per=8.6e+00 cost=2.5e+06 flops=1.5e+10
 sigma[gemm] counter=54 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=4 t=1.9e-04 per=9.6e+00 cost=6.3e+05 flops=3.4e+09
 sigma[gemm] counter=54 i=5 t=2.8e-04 per=1.4e+01 cost=6.4e+05 flops=2.3e+09
 sigma[gemm] counter=54 i=6 t=2.1e-04 per=1.1e+01 cost=2.9e+05 flops=1.4e+09
 sigma[gemm] counter=54 i=7 t=2.0e-04 per=1.0e+01 cost=3.2e+05 flops=1.6e+09
 sigma[gemm] counter=54 total t=8.7e-04 per=4.5e+01 cost=1.9e+06 flops=2.1e+09
 sigma[red] counter=54 t=9.0e-04 per=4.6e+01 cost=3.9e+05 flops=4.3e+08
--- TIMING FOR sigma_tot : t_inter=8.5e-03 t_gemm=4.3e-02 t_reduction=4.4e-02 tot=9.6e-02 ---
 sigma_tot[inter] counter=54 t=8.5e-03 per=8.8e+00 cost=5.3e+07 flops=6.3e+09
 sigma_tot[gemm] counter=54 i=0 t=1.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=1 t=1.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=2 t=1.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=3 t=1.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=4 t=1.0e-02 per=1.1e+01 cost=1.0e+07 flops=9.8e+08
 sigma_tot[gemm] counter=54 i=5 t=1.1e-02 per=1.1e+01 cost=1.0e+07 flops=9.5e+08
 sigma_tot[gemm] counter=54 i=6 t=1.1e-02 per=1.1e+01 cost=1.1e+07 flops=1.0e+09
 sigma_tot[gemm] counter=54 i=7 t=1.1e-02 per=1.1e+01 cost=1.1e+07 flops=1.1e+09
 sigma_tot[gemm] counter=54 total t=4.3e-02 per=4.5e+01 cost=4.3e+07 flops=9.9e+08
 sigma_tot[red] counter=54 t=4.4e-02 per=4.6e+01 cost=9.7e+06 flops=2.2e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.2e-05,1.9e-06,1.1e-06,1.7e-07
    3   0 -    -116.250763625795 -9.165e-05  1.816e-03    3     3  1.377e-02 4.589e-03 4.238e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.779e-05,1.636e-04,8.734e-04,9.037e-04,1.973e-03
 ndim=151:1.125e-06GB t[comm(intra)]=2.225e-05 speed=1.011e-01GB/S t[comm(inter)]=5.545e-06 speed=4.058e-01GB/S
--- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=8.7e-04 t_reduction=9.0e-04 tot=1.9e-03 ---
 sigma[inter] counter=55 t=1.6e-04 per=8.4e+00 cost=2.5e+06 flops=1.5e+10
 sigma[gemm] counter=55 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=1 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=2 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=4 t=1.8e-04 per=9.4e+00 cost=6.3e+05 flops=3.4e+09
 sigma[gemm] counter=55 i=5 t=2.8e-04 per=1.4e+01 cost=6.4e+05 flops=2.3e+09
 sigma[gemm] counter=55 i=6 t=2.0e-04 per=1.1e+01 cost=2.9e+05 flops=1.4e+09
 sigma[gemm] counter=55 i=7 t=2.0e-04 per=1.0e+01 cost=3.2e+05 flops=1.6e+09
 sigma[gemm] counter=55 total t=8.7e-04 per=4.5e+01 cost=1.9e+06 flops=2.2e+09
 sigma[red] counter=55 t=9.0e-04 per=4.7e+01 cost=3.9e+05 flops=4.3e+08
--- TIMING FOR sigma_tot : t_inter=8.7e-03 t_gemm=4.4e-02 t_reduction=4.5e-02 tot=9.8e-02 ---
 sigma_tot[inter] counter=55 t=8.7e-03 per=8.8e+00 cost=5.6e+07 flops=6.4e+09
 sigma_tot[gemm] counter=55 i=0 t=1.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=1 t=1.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=2 t=1.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=3 t=1.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=4 t=1.1e-02 per=1.1e+01 cost=1.1e+07 flops=1.0e+09
 sigma_tot[gemm] counter=55 i=5 t=1.1e-02 per=1.1e+01 cost=1.1e+07 flops=9.8e+08
 sigma_tot[gemm] counter=55 i=6 t=1.1e-02 per=1.1e+01 cost=1.1e+07 flops=1.0e+09
 sigma_tot[gemm] counter=55 i=7 t=1.1e-02 per=1.1e+01 cost=1.2e+07 flops=1.1e+09
 sigma_tot[gemm] counter=55 total t=4.4e-02 per=4.5e+01 cost=4.5e+07 flops=1.0e+09
 sigma_tot[red] counter=55 t=4.5e-02 per=4.6e+01 cost=1.0e+07 flops=2.2e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.1e-05,1.7e-06,1.1e-06,1.5e-07
    4   0 -    -116.250772291414 -8.666e-06  6.851e-04    3     4  1.797e-02 4.494e-03 4.185e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.783e-05,1.633e-04,8.777e-04,9.054e-04,1.979e-03
 ndim=151:1.125e-06GB t[comm(intra)]=2.246e-05 speed=1.002e-01GB/S t[comm(inter)]=5.367e-06 speed=4.192e-01GB/S
--- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=8.8e-04 t_reduction=9.1e-04 tot=1.9e-03 ---
 sigma[inter] counter=56 t=1.6e-04 per=8.4e+00 cost=2.5e+06 flops=1.5e+10
 sigma[gemm] counter=56 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=4 t=1.8e-04 per=9.5e+00 cost=6.3e+05 flops=3.4e+09
 sigma[gemm] counter=56 i=5 t=2.8e-04 per=1.4e+01 cost=6.4e+05 flops=2.3e+09
 sigma[gemm] counter=56 i=6 t=2.1e-04 per=1.1e+01 cost=2.9e+05 flops=1.4e+09
 sigma[gemm] counter=56 i=7 t=2.0e-04 per=1.0e+01 cost=3.2e+05 flops=1.6e+09
 sigma[gemm] counter=56 total t=8.8e-04 per=4.5e+01 cost=1.9e+06 flops=2.1e+09
 sigma[red] counter=56 t=9.1e-04 per=4.7e+01 cost=3.9e+05 flops=4.3e+08
--- TIMING FOR sigma_tot : t_inter=8.8e-03 t_gemm=4.5e-02 t_reduction=4.6e-02 tot=1.0e-01 ---
 sigma_tot[inter] counter=56 t=8.8e-03 per=8.8e+00 cost=5.8e+07 flops=6.6e+09
 sigma_tot[gemm] counter=56 i=0 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=1 t=1.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=2 t=1.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=3 t=1.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=4 t=1.1e-02 per=1.1e+01 cost=1.1e+07 flops=1.1e+09
 sigma_tot[gemm] counter=56 i=5 t=1.2e-02 per=1.2e+01 cost=1.2e+07 flops=1.0e+09
 sigma_tot[gemm] counter=56 i=6 t=1.1e-02 per=1.1e+01 cost=1.1e+07 flops=1.0e+09
 sigma_tot[gemm] counter=56 i=7 t=1.1e-02 per=1.1e+01 cost=1.2e+07 flops=1.1e+09
 sigma_tot[gemm] counter=56 total t=4.5e-02 per=4.5e+01 cost=4.7e+07 flops=1.0e+09
 sigma_tot[red] counter=56 t=4.6e-02 per=4.6e+01 cost=1.0e+07 flops=2.3e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.1e-05,1.7e-06,1.1e-06,1.6e-07
    5   0 -    -116.250773469210 -1.178e-06  1.611e-04    3     5  2.218e-02 4.435e-03 4.147e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.661e-05,1.709e-04,8.746e-04,9.059e-04,1.983e-03
 ndim=151:1.125e-06GB t[comm(intra)]=2.126e-05 speed=1.058e-01GB/S t[comm(inter)]=5.346e-06 speed=4.209e-01GB/S
--- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=8.7e-04 t_reduction=9.1e-04 tot=2.0e-03 ---
 sigma[inter] counter=57 t=1.7e-04 per=8.8e+00 cost=2.5e+06 flops=1.5e+10
 sigma[gemm] counter=57 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=1 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=4 t=1.8e-04 per=9.4e+00 cost=6.3e+05 flops=3.4e+09
 sigma[gemm] counter=57 i=5 t=2.8e-04 per=1.4e+01 cost=6.4e+05 flops=2.3e+09
 sigma[gemm] counter=57 i=6 t=2.1e-04 per=1.1e+01 cost=2.9e+05 flops=1.4e+09
 sigma[gemm] counter=57 i=7 t=2.0e-04 per=1.0e+01 cost=3.2e+05 flops=1.6e+09
 sigma[gemm] counter=57 total t=8.7e-04 per=4.5e+01 cost=1.9e+06 flops=2.1e+09
 sigma[red] counter=57 t=9.1e-04 per=4.6e+01 cost=3.9e+05 flops=4.3e+08
--- TIMING FOR sigma_tot : t_inter=9.0e-03 t_gemm=4.6e-02 t_reduction=4.7e-02 tot=1.0e-01 ---
 sigma_tot[inter] counter=57 t=9.0e-03 per=8.8e+00 cost=6.1e+07 flops=6.8e+09
 sigma_tot[gemm] counter=57 i=0 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=1 t=1.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=2 t=1.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=3 t=1.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=4 t=1.1e-02 per=1.1e+01 cost=1.2e+07 flops=1.1e+09
 sigma_tot[gemm] counter=57 i=5 t=1.2e-02 per=1.2e+01 cost=1.2e+07 flops=1.0e+09
 sigma_tot[gemm] counter=57 i=6 t=1.1e-02 per=1.1e+01 cost=1.2e+07 flops=1.0e+09
 sigma_tot[gemm] counter=57 i=7 t=1.1e-02 per=1.1e+01 cost=1.2e+07 flops=1.1e+09
 sigma_tot[gemm] counter=57 total t=4.6e-02 per=4.5e+01 cost=4.9e+07 flops=1.1e+09
 sigma_tot[red] counter=57 t=4.7e-02 per=4.6e+01 cost=1.1e+07 flops=2.3e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.1e-05,1.6e-06,1.0e-06,1.5e-07
    6   0 +    -116.250773542643 -7.343e-08  3.777e-05    3     6  2.744e-02 4.573e-03 4.303e-03
TIMING FOR Davidson : 2.752e-02  T(cal/comm/rest)=2.582e-02,2.450e-07,1.702e-03
decomposed t_rest=1.702e-03
 T(sub)    =1.023e-04 per=6.009e+00
 T(precond)=1.509e-04 per=8.863e+00
 T(ortho)  =1.084e-05 per=6.366e-01
 T(xcopy)  =7.340e-07 per=4.312e-02
 T(xnrm2)  =1.263e-06 per=7.420e-02
 T(other)  =1.436e-03 per=8.437e+01
optimized energies: isweep=0 ibond=8 dots=2 e[0]=-116.250773542643 nmvp=6
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:1.763e+01S Sys:1.125e+00S Total:1.876e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond8.txt
 qbond: qsuper nsym=11 dimAll=37
 (14,2):6 (16,2):4 (15,1):8 (15,3):6 (14,0):4 (16,0):3 (13,1):1 (13,3):1 (14,4):2 (16,4):1 (15,5):1
----- TMING FOR decimation_genbasis(su2): 8.1e-05 S -----
decimation summary: 37->10 dwt=+4.871e-03 SvN=1.161e+00
 qbond: qkept nsym=5 dimAll=10
 (15,1):4 (15,3):3 (14,2):1 (14,4):1 (15,5):1
----- TIMING for decimation_row(nkr): 3.333e-03 S T(decim/select/formRot)=3.837e-04,2.782e-03,1.680e-04 -----
----- TIMING FOR twodot_decimation: 3.543e-03 S T(wf/decim)=1.355e-04,3.407e-03 -----
ctns::oper_renorm coord=(9,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:10 S:10 H:1 P:100 Q:110 
        dim(bra,ket)=10,10 size(op)=60:4.578e-04MB size(tot)=5088:3.882e-02MB:3.791e-05GB
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:1.782e+01S Sys:1.125e+00S Total:1.894e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=231 : 9.065e-04 S -----
rank=0 GPUmem(GB): used=0.000141 (oper)=8.72e-05
rank=0 GPUmem(GB): used=0.000142 (oper,site)(GB)=8.72e-05,4.4e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=231
 no. of rintermediate operators=350
 no. of coefficients=3150:0.024MB:2.35e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.758e-04 S -----
rank=0 GPUmem(GB): used=0.000165 (oper,site,rinter)=8.72e-05,4.4e-07,2.35e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0054 S size(rtasks)=231 size(Rlst2)=25 T(Rmu/Rlist)=0.000287,0.00511 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00566 S size(rtasks)=231 size(Rlst)=6873 -----
rank=0 GPUmem(GB): used=0.000165 (oper,site,rinter,batch)=8.72e-05,4.4e-07,2.35e-05,0.00189 blksize=16 blksize0=4 batchsize=6873
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000122,0.000786,0.000287
--- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=7.9e-04 t_reduction=2.9e-04 tot=1.2e-03 ---
 renorm[inter] counter=9 t=1.2e-04 per=1.0e+01 cost=1.2e+05 flops=1.0e+09
 renorm[gemm] counter=9 i=0 t=2.8e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=1 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=2 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=3 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=9 i=4 t=2.3e-04 per=1.9e+01 cost=2.7e+04 flops=1.2e+08
 renorm[gemm] counter=9 i=5 t=2.6e-04 per=2.2e+01 cost=9.8e+04 flops=3.7e+08
 renorm[gemm] counter=9 i=6 t=2.8e-04 per=2.4e+01 cost=2.1e+05 flops=7.5e+08
 renorm[gemm] counter=9 total t=7.9e-04 per=6.6e+01 cost=3.4e+05 flops=4.3e+08
 renorm[red] counter=9 t=2.9e-04 per=2.4e+01 cost=9.0e+04 flops=3.1e+08
--- TIMING FOR renorm_tot : t_inter=1.2e-03 t_gemm=5.2e-03 t_reduction=2.0e-03 tot=8.4e-03 ---
 renorm_tot[inter] counter=9 t=1.2e-03 per=1.5e+01 cost=8.9e+05 flops=7.2e+08
 renorm_tot[gemm] counter=9 i=0 t=2.5e-05 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=1 t=2.0e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=2 t=2.0e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=3 t=2.0e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=9 i=4 t=1.7e-03 per=2.0e+01 cost=1.1e+05 flops=6.3e+07
 renorm_tot[gemm] counter=9 i=5 t=1.7e-03 per=2.0e+01 cost=2.9e+05 flops=1.7e+08
 renorm_tot[gemm] counter=9 i=6 t=1.7e-03 per=2.1e+01 cost=4.2e+05 flops=2.4e+08
 renorm_tot[gemm] counter=9 total t=5.2e-03 per=6.2e+01 cost=8.2e+05 flops=1.6e+08
 renorm_tot[red] counter=9 t=2.0e-03 per=2.3e+01 cost=1.7e+05 flops=8.6e+07
qops.to_cpu: size(tot)=5088:3.9e-02MB:3.8e-05GB t[to_cpu]=2.4e-05S speed=1.6e+00GB/S
check ||H-H.dagger||=1.104e-14 coord=(9,0) rank=0
ctns::oper_ab2pq coord=(9,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0135 S rank=0 -----
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:1.794e+01S Sys:1.125e+00S Total:1.907e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=554:4.227e-03MB:4.128e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=612:4.669e-03MB:4.560e-06GB
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:1.794e+01S Sys:1.125e+00S Total:1.907e+01S
##### local opt: 1.343e-01 S #####
 T(local opt: fetch) = 6.847e-03 S  per =  5.1  per(accum) = 5.1
 T(local opt: hdiag) = 1.293e-02 S  per = 9.63  per(accum) = 14.7
 T(local opt: dvdsn) = 9.159e-02 S  per = 68.2  per(accum) = 82.9
 T(local opt: decim) = 3.637e-03 S  per = 2.71  per(accum) = 85.6
 T(local opt: guess) = 8.861e-05 S  per = 0.066  per(accum) = 85.7
 T(local opt: renrm) = 1.449e-02 S  per = 10.8  per(accum) = 96.5
 T(local opt: save ) = 4.711e-03 S  per = 3.51  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.159e-02 S  T(sum) = 9.063e-02 S  per = 9.895e+01
 T(local opt: preprocess                  ) = 5.657e-04 S  per = 0.624  per(accum) = 0.624
 T(local opt: symbolic_formulae           ) = 1.969e-03 S  per = 2.17  per(accum) = 2.8
 T(local opt: hintermediate init          ) = 6.424e-04 S  per = 0.709  per(accum) = 3.51
 T(local opt: preprocess_hformulae_Hxlist ) = 5.129e-02 S  per = 56.6  per(accum) = 60.1
 T(local opt: hmmtasks init               ) = 8.392e-03 S  per = 9.26  per(accum) = 69.4
 T(local opt: initial guess for dvdson    ) = 2.486e-04 S  per = 0.274  per(accum) = 69.6
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.564e-02 S  per = 28.3  per(accum) = 97.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.731e-04 S  per = 0.191  per(accum) = 98.1
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.450e-07 S  per = 0.00027  per(accum) = 98.1
 T(local opt: dvdson solver [rest part]   ) = 1.702e-03 S  per = 1.88  per(accum) = 100
Detailed decomposition of T(renrm) = 1.449e-02 S  T(sum) = 1.449e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.319e-04 S  per = 0.91  per(accum) = 0.91
 T(local opt: qops init                    ) = 7.398e-04 S  per =  5.1  per(accum) = 6.01
 T(local opt: symbolic_formulae_renorm     ) = 1.006e-03 S  per = 6.94  per(accum) = 13
 T(local opt: allocate qops on gpu         ) = 1.047e-04 S  per = 0.723  per(accum) = 13.7
 T(local opt: site memcpy cpu2gpu          ) = 8.906e-05 S  per = 0.615  per(accum) = 14.3
 T(local opt: rintermediate init           ) = 5.248e-04 S  per = 3.62  per(accum) = 17.9
 T(local opt: preprocess_formulae_Rlist2   ) = 5.770e-03 S  per = 39.8  per(accum) = 57.7
 T(local opt: rmmtasks init                ) = 1.820e-03 S  per = 12.6  per(accum) = 70.3
 T(local opt: qops memset on cpu           ) = 7.300e-08 S  per = 0.000504  per(accum) = 70.3
 T(local opt: preprocess_renorm_batchGPU   ) = 3.074e-03 S  per = 21.2  per(accum) = 91.5
 T(local opt: reduction of opS & opH [nccl]) = 5.830e-07 S  per = 0.00402  per(accum) = 91.5
 T(local opt: qops memcpy gpu2cpu          ) = 1.027e-04 S  per = 0.708  per(accum) = 92.2
 T(local opt: deallocate cpu and gpu memory) = 1.422e-04 S  per = 0.981  per(accum) = 93.2
 T(local opt: reduction of opS & opH [comm]) = 1.012e-04 S  per = 0.698  per(accum) = 93.9
 T(local opt: conversion from opAB to opPQ ) = 7.501e-05 S  per = 0.518  per(accum) = 94.4
 T(local opt: after oper_renorm            ) = 8.110e-04 S  per =  5.6  per(accum) = 100
##### sweep opt: 7.934e-01 S #####
 T(sweep opt: fetch) = 6.251e-02 S  per = 7.88  per(accum) = 7.88
 T(sweep opt: hdiag) = 5.260e-02 S  per = 6.63  per(accum) = 14.5
 T(sweep opt: dvdsn) = 5.247e-01 S  per = 66.1  per(accum) = 80.6
 T(sweep opt: decim) = 3.490e-02 S  per =  4.4  per(accum) = 85
 T(sweep opt: guess) = 1.521e-03 S  per = 0.192  per(accum) = 85.2
 T(sweep opt: renrm) = 7.607e-02 S  per = 9.59  per(accum) = 94.8
 T(sweep opt: save ) = 4.109e-02 S  per = 5.18  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.247e-01 S  T(sum) = 5.167e-01 S  per = 9.847e+01
 T(sweep opt: preprocess                  ) = 6.499e-03 S  per = 1.26  per(accum) = 1.26
 T(sweep opt: symbolic_formulae           ) = 9.957e-03 S  per = 1.93  per(accum) = 3.19
 T(sweep opt: hintermediate init          ) = 5.242e-03 S  per = 1.01  per(accum) = 4.2
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.197e-01 S  per = 42.5  per(accum) = 46.7
 T(sweep opt: hmmtasks init               ) = 3.812e-02 S  per = 7.38  per(accum) = 54.1
 T(sweep opt: initial guess for dvdson    ) = 2.336e-03 S  per = 0.452  per(accum) = 54.5
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 2.179e-01 S  per = 42.2  per(accum) = 96.7
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 1.644e-03 S  per = 0.318  per(accum) = 97
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.700e-06 S  per = 0.000523  per(accum) = 97
 T(sweep opt: dvdson solver [rest part]   ) = 1.531e-02 S  per = 2.96  per(accum) = 100
Detailed decomposition of T(renrm) = 7.607e-02 S  T(sum) = 7.607e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.194e-03 S  per = 1.57  per(accum) = 1.57
 T(sweep opt: qops init                    ) = 4.272e-03 S  per = 5.62  per(accum) = 7.19
 T(sweep opt: symbolic_formulae_renorm     ) = 4.185e-03 S  per =  5.5  per(accum) = 12.7
 T(sweep opt: allocate qops on gpu         ) = 8.741e-04 S  per = 1.15  per(accum) = 13.8
 T(sweep opt: site memcpy cpu2gpu          ) = 8.159e-04 S  per = 1.07  per(accum) = 14.9
 T(sweep opt: rintermediate init           ) = 4.294e-03 S  per = 5.64  per(accum) = 20.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.579e-02 S  per = 20.8  per(accum) = 41.3
 T(sweep opt: rmmtasks init                ) = 5.149e-03 S  per = 6.77  per(accum) = 48.1
 T(sweep opt: qops memset on cpu           ) = 4.630e-07 S  per = 0.000609  per(accum) = 48.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.445e-02 S  per = 32.1  per(accum) = 80.2
 T(sweep opt: reduction of opS & opH [nccl]) = 5.119e-06 S  per = 0.00673  per(accum) = 80.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 8.536e-04 S  per = 1.12  per(accum) = 81.4
 T(sweep opt: deallocate cpu and gpu memory) = 2.303e-04 S  per = 0.303  per(accum) = 81.7
 T(sweep opt: reduction of opS & opH [comm]) = 8.021e-04 S  per = 1.05  per(accum) = 82.7
 T(sweep opt: conversion from opAB to opPQ ) = 6.623e-03 S  per = 8.71  per(accum) = 91.4
 T(sweep opt: after oper_renorm            ) = 6.528e-03 S  per = 8.58  per(accum) = 100
##### global opt: 7.934e-01 S #####
 T(global opt: fetch) = 6.251e-02 S  per = 7.88  per(accum) = 7.88
 T(global opt: hdiag) = 5.260e-02 S  per = 6.63  per(accum) = 14.5
 T(global opt: dvdsn) = 5.247e-01 S  per = 66.1  per(accum) = 80.6
 T(global opt: decim) = 3.490e-02 S  per =  4.4  per(accum) = 85
 T(global opt: guess) = 1.521e-03 S  per = 0.192  per(accum) = 85.2
 T(global opt: renrm) = 7.607e-02 S  per = 9.59  per(accum) = 94.8
 T(global opt: save ) = 4.109e-02 S  per = 5.18  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.247e-01 S  T(sum) = 5.167e-01 S  per = 9.847e+01
 T(global opt: preprocess                  ) = 6.499e-03 S  per = 1.26  per(accum) = 1.26
 T(global opt: symbolic_formulae           ) = 9.957e-03 S  per = 1.93  per(accum) = 3.19
 T(global opt: hintermediate init          ) = 5.242e-03 S  per = 1.01  per(accum) = 4.2
 T(global opt: preprocess_hformulae_Hxlist ) = 2.197e-01 S  per = 42.5  per(accum) = 46.7
 T(global opt: hmmtasks init               ) = 3.812e-02 S  per = 7.38  per(accum) = 54.1
 T(global opt: initial guess for dvdson    ) = 2.336e-03 S  per = 0.452  per(accum) = 54.5
 T(global opt: dvdson solver [Hx_batchGPU] ) = 2.179e-01 S  per = 42.2  per(accum) = 96.7
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.644e-03 S  per = 0.318  per(accum) = 97
 T(global opt: dvdson solver [comm(cpu)]   ) = 2.700e-06 S  per = 0.000523  per(accum) = 97
 T(global opt: dvdson solver [rest part]   ) = 1.531e-02 S  per = 2.96  per(accum) = 100
Detailed decomposition of T(renrm) = 7.607e-02 S  T(sum) = 7.607e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.194e-03 S  per = 1.57  per(accum) = 1.57
 T(global opt: qops init                    ) = 4.272e-03 S  per = 5.62  per(accum) = 7.19
 T(global opt: symbolic_formulae_renorm     ) = 4.185e-03 S  per =  5.5  per(accum) = 12.7
 T(global opt: allocate qops on gpu         ) = 8.741e-04 S  per = 1.15  per(accum) = 13.8
 T(global opt: site memcpy cpu2gpu          ) = 8.159e-04 S  per = 1.07  per(accum) = 14.9
 T(global opt: rintermediate init           ) = 4.294e-03 S  per = 5.64  per(accum) = 20.6
 T(global opt: preprocess_formulae_Rlist2   ) = 1.579e-02 S  per = 20.8  per(accum) = 41.3
 T(global opt: rmmtasks init                ) = 5.149e-03 S  per = 6.77  per(accum) = 48.1
 T(global opt: qops memset on cpu           ) = 4.630e-07 S  per = 0.000609  per(accum) = 48.1
 T(global opt: preprocess_renorm_batchGPU   ) = 2.445e-02 S  per = 32.1  per(accum) = 80.2
 T(global opt: reduction of opS & opH [nccl]) = 5.119e-06 S  per = 0.00673  per(accum) = 80.2
 T(global opt: qops memcpy gpu2cpu          ) = 8.536e-04 S  per = 1.12  per(accum) = 81.4
 T(global opt: deallocate cpu and gpu memory) = 2.303e-04 S  per = 0.303  per(accum) = 81.7
 T(global opt: reduction of opS & opH [comm]) = 8.021e-04 S  per = 1.05  per(accum) = 82.7
 T(global opt: conversion from opAB to opPQ ) = 6.623e-03 S  per = 8.71  per(accum) = 91.4
 T(global opt: after oper_renorm            ) = 6.528e-03 S  per = 8.58  per(accum) = 100

isweep=0 ibond=9/seqsize=34 dots=2 dbond=(10,0)-(11,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:1.795e+01S Sys:1.125e+00S Total:1.907e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=554:4.227e-03MB:4.128e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=612:4.669e-03MB:4.560e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=10,8,1,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc1= 6
 suppc2= 7
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:10 S:10 H:1 P:100 Q:110 
        dim(bra,ket)=10,10 size(op)=60:4.578e-04MB size(tot)=5088:3.882e-02MB:3.791e-05GB
 rqops: oplist=CSHAB nops=C:8 S:12 H:1 A:64 B:72 
        dim(bra,ket)=8,8 size(op)=40:3.052e-04MB size(tot)=2494:1.903e-02MB:1.858e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=9578:7.307e-02MB:7.136e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(10,0) fdel=./scratch/sweep/rop(11,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
wf4(diml,dimr,dimc1,dimc2)=(10,8,3,3) nnz=114:8.698e-04MB
qtensor4: wf4 own=1 _data=0x55a322862440
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (15,1):4 (15,3):3 (14,2):1 (14,4):1 (15,5):1
 qbond: qcol nsym=3 dimAll=8
 (12,2):3 (12,4):3 (13,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=20 nblocks=240 size=114:8.698e-04MB
### DIAG TIMING: total=8.110e-03 t1=9.757e-06, t2=1.395e-05, t3=1.740e-05, t4=8.043e-03, t5=4.516e-06, t6=1.816e-05, t7=4.026e-06
duration_diagGPU:8.220e-03
duration_diagreduce:2.800e-08
duration_diagtransform:2.870e-07
----- TIMING FOR symbolic_formulae_twodot with size=837 : 1.582e-03 S -----
rank=0 GPUmem(GB): used=7.14e-05 (oper)=7.14e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=837
 no. of hintermediate operators=392
 no. of coefficients=5612:0.0428MB:4.18e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.013e-04 S -----
rank=0 GPUmem(GB): used=0.000113 (oper,hinter)=7.14e-05,4.18e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0269 S size(H_formulae)=837 size(Hxlst2)=20 T(Hmu/Hxlist)=0.000318,0.0265 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0273 S size(H_formulae)=837 size(Hxlst)=16830 -----
rank=0 GPUmem(GB): used=0.00438 (oper,hinter,dvdson,batch)=7.14e-05,4.18e-05,1.7e-06,0.00426 blksize=12 blksize0=9 batchsize=16830
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=114 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.13e-05,0.000194,0.00112,0.000701,0.00205
 ndim=114:8.49e-07GB t[comm(intra)]=2.41e-05 speed=0.0704GB/S t[comm(inter)]=7.19e-06 speed=0.236GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=7.0e-04 tot=2.0e-03 ---
 sigma[inter] counter=58 t=1.9e-04 per=9.6e+00 cost=8.3e+05 flops=4.3e+09
 sigma[gemm] counter=58 i=0 t=2.9e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=1 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=4 t=2.3e-04 per=1.2e+01 cost=2.2e+05 flops=9.4e+08
 sigma[gemm] counter=58 i=5 t=3.2e-04 per=1.6e+01 cost=2.3e+05 flops=7.2e+08
 sigma[gemm] counter=58 i=6 t=2.8e-04 per=1.4e+01 cost=1.6e+05 flops=5.5e+08
 sigma[gemm] counter=58 i=7 t=2.7e-04 per=1.4e+01 cost=1.6e+05 flops=6.1e+08
 sigma[gemm] counter=58 total t=1.1e-03 per=5.6e+01 cost=7.7e+05 flops=6.9e+08
 sigma[red] counter=58 t=7.0e-04 per=3.5e+01 cost=1.9e+05 flops=2.7e+08
--- TIMING FOR sigma_tot : t_inter=9.2e-03 t_gemm=4.7e-02 t_reduction=4.8e-02 tot=1.0e-01 ---
 sigma_tot[inter] counter=58 t=9.2e-03 per=8.8e+00 cost=6.2e+07 flops=6.7e+09
 sigma_tot[gemm] counter=58 i=0 t=1.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=1 t=1.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=2 t=1.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=3 t=1.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=4 t=1.1e-02 per=1.1e+01 cost=1.2e+07 flops=1.1e+09
 sigma_tot[gemm] counter=58 i=5 t=1.2e-02 per=1.2e+01 cost=1.3e+07 flops=1.0e+09
 sigma_tot[gemm] counter=58 i=6 t=1.2e-02 per=1.1e+01 cost=1.2e+07 flops=1.0e+09
 sigma_tot[gemm] counter=58 i=7 t=1.1e-02 per=1.1e+01 cost=1.3e+07 flops=1.1e+09
 sigma_tot[gemm] counter=58 total t=4.7e-02 per=4.5e+01 cost=4.9e+07 flops=1.1e+09
 sigma_tot[red] counter=58 t=4.8e-02 per=4.6e+01 cost=1.1e+07 flops=2.3e+08
T(sub)=8.1e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,3.2e-06,9.5e-07,8.2e-07,2.4e-07
settings: ndim=114 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.248461708954 -1.116e+03  6.701e-02    1     1  4.416e-03 4.416e-03 4.233e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.819e-05,1.387e-04,8.971e-04,6.529e-04,1.722e-03
 ndim=114:8.494e-07GB t[comm(intra)]=2.236e-05 speed=7.598e-02GB/S t[comm(inter)]=5.827e-06 speed=2.915e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=9.0e-04 t_reduction=6.5e-04 tot=1.7e-03 ---
 sigma[inter] counter=59 t=1.4e-04 per=8.2e+00 cost=8.3e+05 flops=6.0e+09
 sigma[gemm] counter=59 i=0 t=2.7e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=1 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=2 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=3 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=4 t=1.7e-04 per=1.0e+01 cost=2.2e+05 flops=1.3e+09
 sigma[gemm] counter=59 i=5 t=3.0e-04 per=1.8e+01 cost=2.3e+05 flops=7.6e+08
 sigma[gemm] counter=59 i=6 t=2.1e-04 per=1.3e+01 cost=1.6e+05 flops=7.3e+08
 sigma[gemm] counter=59 i=7 t=2.0e-04 per=1.2e+01 cost=1.6e+05 flops=8.4e+08
 sigma[gemm] counter=59 total t=9.0e-04 per=5.3e+01 cost=7.7e+05 flops=8.6e+08
 sigma[red] counter=59 t=6.5e-04 per=3.9e+01 cost=1.9e+05 flops=2.9e+08
--- TIMING FOR sigma_tot : t_inter=9.3e-03 t_gemm=4.8e-02 t_reduction=4.8e-02 tot=1.1e-01 ---
 sigma_tot[inter] counter=59 t=9.3e-03 per=8.8e+00 cost=6.2e+07 flops=6.7e+09
 sigma_tot[gemm] counter=59 i=0 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=1 t=1.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=2 t=1.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=3 t=1.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=4 t=1.1e-02 per=1.1e+01 cost=1.3e+07 flops=1.1e+09
 sigma_tot[gemm] counter=59 i=5 t=1.2e-02 per=1.2e+01 cost=1.3e+07 flops=1.0e+09
 sigma_tot[gemm] counter=59 i=6 t=1.2e-02 per=1.1e+01 cost=1.2e+07 flops=1.0e+09
 sigma_tot[gemm] counter=59 i=7 t=1.2e-02 per=1.1e+01 cost=1.3e+07 flops=1.1e+09
 sigma_tot[gemm] counter=59 total t=4.8e-02 per=4.5e+01 cost=5.0e+07 flops=1.0e+09
 sigma_tot[red] counter=59 t=4.8e-02 per=4.6e+01 cost=1.1e+07 flops=2.3e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.0e-05,2.4e-06,9.8e-07,2.0e-07
    2   0 -    -116.264421556857 -1.596e-02  2.513e-02    2     2  8.726e-03 4.363e-03 4.015e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.724e-05,1.339e-04,8.833e-04,6.521e-04,1.702e-03
 ndim=114:8.494e-07GB t[comm(intra)]=2.152e-05 speed=7.893e-02GB/S t[comm(inter)]=5.717e-06 speed=2.971e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=8.8e-04 t_reduction=6.5e-04 tot=1.7e-03 ---
 sigma[inter] counter=60 t=1.3e-04 per=8.0e+00 cost=8.3e+05 flops=6.2e+09
 sigma[gemm] counter=60 i=0 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=1 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=2 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=3 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=4 t=1.6e-04 per=9.5e+00 cost=2.2e+05 flops=1.4e+09
 sigma[gemm] counter=60 i=5 t=3.0e-04 per=1.8e+01 cost=2.3e+05 flops=7.7e+08
 sigma[gemm] counter=60 i=6 t=2.1e-04 per=1.3e+01 cost=1.6e+05 flops=7.4e+08
 sigma[gemm] counter=60 i=7 t=2.1e-04 per=1.2e+01 cost=1.6e+05 flops=7.9e+08
 sigma[gemm] counter=60 total t=8.8e-04 per=5.3e+01 cost=7.7e+05 flops=8.7e+08
 sigma[red] counter=60 t=6.5e-04 per=3.9e+01 cost=1.9e+05 flops=2.9e+08
--- TIMING FOR sigma_tot : t_inter=9.5e-03 t_gemm=4.9e-02 t_reduction=4.9e-02 tot=1.1e-01 ---
 sigma_tot[inter] counter=60 t=9.5e-03 per=8.8e+00 cost=6.3e+07 flops=6.7e+09
 sigma_tot[gemm] counter=60 i=0 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=1 t=1.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=2 t=1.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=3 t=1.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=4 t=1.2e-02 per=1.1e+01 cost=1.3e+07 flops=1.1e+09
 sigma_tot[gemm] counter=60 i=5 t=1.3e-02 per=1.2e+01 cost=1.3e+07 flops=1.0e+09
 sigma_tot[gemm] counter=60 i=6 t=1.2e-02 per=1.1e+01 cost=1.2e+07 flops=1.0e+09
 sigma_tot[gemm] counter=60 i=7 t=1.2e-02 per=1.1e+01 cost=1.3e+07 flops=1.1e+09
 sigma_tot[gemm] counter=60 total t=4.9e-02 per=4.5e+01 cost=5.1e+07 flops=1.0e+09
 sigma_tot[red] counter=60 t=4.9e-02 per=4.6e+01 cost=1.1e+07 flops=2.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.2e-05,1.9e-06,1.1e-06,1.6e-07
    3   0 -    -116.266390591391 -1.969e-03  9.422e-03    3     3  1.270e-02 4.234e-03 3.937e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.702e-05,1.335e-04,8.889e-04,6.521e-04,1.707e-03
 ndim=114:8.494e-07GB t[comm(intra)]=2.146e-05 speed=7.916e-02GB/S t[comm(inter)]=5.561e-06 speed=3.055e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=8.9e-04 t_reduction=6.5e-04 tot=1.7e-03 ---
 sigma[inter] counter=61 t=1.3e-04 per=8.0e+00 cost=8.3e+05 flops=6.2e+09
 sigma[gemm] counter=61 i=0 t=2.7e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=1 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=2 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=3 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=4 t=1.6e-04 per=9.6e+00 cost=2.2e+05 flops=1.4e+09
 sigma[gemm] counter=61 i=5 t=3.0e-04 per=1.8e+01 cost=2.3e+05 flops=7.7e+08
 sigma[gemm] counter=61 i=6 t=2.1e-04 per=1.3e+01 cost=1.6e+05 flops=7.4e+08
 sigma[gemm] counter=61 i=7 t=2.1e-04 per=1.2e+01 cost=1.6e+05 flops=8.0e+08
 sigma[gemm] counter=61 total t=8.9e-04 per=5.3e+01 cost=7.7e+05 flops=8.7e+08
 sigma[red] counter=61 t=6.5e-04 per=3.9e+01 cost=1.9e+05 flops=2.9e+08
--- TIMING FOR sigma_tot : t_inter=9.6e-03 t_gemm=5.0e-02 t_reduction=5.0e-02 tot=1.1e-01 ---
 sigma_tot[inter] counter=61 t=9.6e-03 per=8.8e+00 cost=6.4e+07 flops=6.7e+09
 sigma_tot[gemm] counter=61 i=0 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=1 t=1.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=2 t=1.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=3 t=1.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=4 t=1.2e-02 per=1.1e+01 cost=1.3e+07 flops=1.1e+09
 sigma_tot[gemm] counter=61 i=5 t=1.3e-02 per=1.2e+01 cost=1.3e+07 flops=1.0e+09
 sigma_tot[gemm] counter=61 i=6 t=1.2e-02 per=1.1e+01 cost=1.2e+07 flops=1.0e+09
 sigma_tot[gemm] counter=61 i=7 t=1.2e-02 per=1.1e+01 cost=1.3e+07 flops=1.1e+09
 sigma_tot[gemm] counter=61 total t=5.0e-02 per=4.6e+01 cost=5.2e+07 flops=1.0e+09
 sigma_tot[red] counter=61 t=5.0e-02 per=4.6e+01 cost=1.2e+07 flops=2.3e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.1e-05,1.7e-06,9.9e-07,1.3e-07
    4   0 -    -116.266651227099 -2.606e-04  4.244e-03    3     4  1.668e-02 4.171e-03 3.902e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.667e-05,1.415e-04,9.194e-04,6.476e-04,1.740e-03
 ndim=114:8.494e-07GB t[comm(intra)]=2.147e-05 speed=7.914e-02GB/S t[comm(inter)]=5.205e-06 speed=3.264e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=9.2e-04 t_reduction=6.5e-04 tot=1.7e-03 ---
 sigma[inter] counter=62 t=1.4e-04 per=8.3e+00 cost=8.3e+05 flops=5.9e+09
 sigma[gemm] counter=62 i=0 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=1 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=2 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=3 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=4 t=1.9e-04 per=1.1e+01 cost=2.2e+05 flops=1.2e+09
 sigma[gemm] counter=62 i=5 t=3.0e-04 per=1.8e+01 cost=2.3e+05 flops=7.6e+08
 sigma[gemm] counter=62 i=6 t=2.1e-04 per=1.2e+01 cost=1.6e+05 flops=7.4e+08
 sigma[gemm] counter=62 i=7 t=2.1e-04 per=1.2e+01 cost=1.6e+05 flops=8.0e+08
 sigma[gemm] counter=62 total t=9.2e-04 per=5.4e+01 cost=7.7e+05 flops=8.4e+08
 sigma[red] counter=62 t=6.5e-04 per=3.8e+01 cost=1.9e+05 flops=2.9e+08
--- TIMING FOR sigma_tot : t_inter=9.7e-03 t_gemm=5.1e-02 t_reduction=5.0e-02 tot=1.1e-01 ---
 sigma_tot[inter] counter=62 t=9.7e-03 per=8.8e+00 cost=6.5e+07 flops=6.7e+09
 sigma_tot[gemm] counter=62 i=0 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=1 t=1.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=2 t=1.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=3 t=1.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=4 t=1.2e-02 per=1.1e+01 cost=1.3e+07 flops=1.1e+09
 sigma_tot[gemm] counter=62 i=5 t=1.3e-02 per=1.2e+01 cost=1.3e+07 flops=1.0e+09
 sigma_tot[gemm] counter=62 i=6 t=1.2e-02 per=1.1e+01 cost=1.2e+07 flops=1.0e+09
 sigma_tot[gemm] counter=62 i=7 t=1.2e-02 per=1.1e+01 cost=1.3e+07 flops=1.1e+09
 sigma_tot[gemm] counter=62 total t=5.1e-02 per=4.6e+01 cost=5.2e+07 flops=1.0e+09
 sigma_tot[red] counter=62 t=5.0e-02 per=4.6e+01 cost=1.2e+07 flops=2.3e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.1e-05,1.7e-06,1.0e-06,1.4e-07
    5   0 -    -116.266697415709 -4.619e-05  1.196e-03    3     5  2.065e-02 4.131e-03 3.878e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.679e-05,1.424e-04,8.718e-04,6.525e-04,1.698e-03
 ndim=114:8.494e-07GB t[comm(intra)]=2.159e-05 speed=7.869e-02GB/S t[comm(inter)]=5.204e-06 speed=3.264e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=8.7e-04 t_reduction=6.5e-04 tot=1.7e-03 ---
 sigma[inter] counter=63 t=1.4e-04 per=8.5e+00 cost=8.3e+05 flops=5.8e+09
 sigma[gemm] counter=63 i=0 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=1 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=2 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=3 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=4 t=1.7e-04 per=1.0e+01 cost=2.2e+05 flops=1.3e+09
 sigma[gemm] counter=63 i=5 t=2.9e-04 per=1.7e+01 cost=2.3e+05 flops=8.0e+08
 sigma[gemm] counter=63 i=6 t=2.0e-04 per=1.2e+01 cost=1.6e+05 flops=7.9e+08
 sigma[gemm] counter=63 i=7 t=2.1e-04 per=1.3e+01 cost=1.6e+05 flops=7.9e+08
 sigma[gemm] counter=63 total t=8.7e-04 per=5.2e+01 cost=7.7e+05 flops=8.9e+08
 sigma[red] counter=63 t=6.5e-04 per=3.9e+01 cost=1.9e+05 flops=2.9e+08
--- TIMING FOR sigma_tot : t_inter=9.9e-03 t_gemm=5.1e-02 t_reduction=5.1e-02 tot=1.1e-01 ---
 sigma_tot[inter] counter=63 t=9.9e-03 per=8.8e+00 cost=6.6e+07 flops=6.7e+09
 sigma_tot[gemm] counter=63 i=0 t=1.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=1 t=1.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=2 t=1.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=3 t=1.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=4 t=1.2e-02 per=1.1e+01 cost=1.3e+07 flops=1.1e+09
 sigma_tot[gemm] counter=63 i=5 t=1.4e-02 per=1.2e+01 cost=1.4e+07 flops=1.0e+09
 sigma_tot[gemm] counter=63 i=6 t=1.3e-02 per=1.1e+01 cost=1.3e+07 flops=9.9e+08
 sigma_tot[gemm] counter=63 i=7 t=1.2e-02 per=1.1e+01 cost=1.3e+07 flops=1.1e+09
 sigma_tot[gemm] counter=63 total t=5.1e-02 per=4.6e+01 cost=5.3e+07 flops=1.0e+09
 sigma_tot[red] counter=63 t=5.1e-02 per=4.5e+01 cost=1.2e+07 flops=2.4e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.0e-05,1.7e-06,9.9e-07,1.5e-07
    6   0 -    -116.266700925753 -3.510e-06  3.469e-04    3     6  2.460e-02 4.100e-03 3.855e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.642e-05,1.412e-04,8.901e-04,6.462e-04,1.708e-03
 ndim=114:8.494e-07GB t[comm(intra)]=2.132e-05 speed=7.967e-02GB/S t[comm(inter)]=5.102e-06 speed=3.330e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=8.9e-04 t_reduction=6.5e-04 tot=1.7e-03 ---
 sigma[inter] counter=64 t=1.4e-04 per=8.4e+00 cost=8.3e+05 flops=5.9e+09
 sigma[gemm] counter=64 i=0 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=1 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=2 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=3 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=4 t=1.7e-04 per=1.0e+01 cost=2.2e+05 flops=1.3e+09
 sigma[gemm] counter=64 i=5 t=3.0e-04 per=1.8e+01 cost=2.3e+05 flops=7.7e+08
 sigma[gemm] counter=64 i=6 t=2.1e-04 per=1.2e+01 cost=1.6e+05 flops=7.5e+08
 sigma[gemm] counter=64 i=7 t=2.1e-04 per=1.2e+01 cost=1.6e+05 flops=8.0e+08
 sigma[gemm] counter=64 total t=8.9e-04 per=5.3e+01 cost=7.7e+05 flops=8.7e+08
 sigma[red] counter=64 t=6.5e-04 per=3.9e+01 cost=1.9e+05 flops=2.9e+08
--- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=5.2e-02 t_reduction=5.2e-02 tot=1.1e-01 ---
 sigma_tot[inter] counter=64 t=1.0e-02 per=8.8e+00 cost=6.7e+07 flops=6.6e+09
 sigma_tot[gemm] counter=64 i=0 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=1 t=1.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=2 t=1.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=3 t=1.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=4 t=1.2e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=64 i=5 t=1.4e-02 per=1.2e+01 cost=1.4e+07 flops=1.0e+09
 sigma_tot[gemm] counter=64 i=6 t=1.3e-02 per=1.1e+01 cost=1.3e+07 flops=9.9e+08
 sigma_tot[gemm] counter=64 i=7 t=1.3e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=64 total t=5.2e-02 per=4.6e+01 cost=5.4e+07 flops=1.0e+09
 sigma_tot[red] counter=64 t=5.2e-02 per=4.5e+01 cost=1.2e+07 flops=2.4e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.0e-05,1.7e-06,1.0e-06,1.5e-07
    7   0 +    -116.266701220274 -2.945e-07  9.912e-05    3     7  2.855e-02 4.078e-03 3.842e-03
TIMING FOR Davidson : 2.863e-02  T(cal/comm/rest)=2.689e-02,4.040e-07,1.735e-03
decomposed t_rest=1.735e-03
 T(sub)    =1.160e-04 per=6.685e+00
 T(precond)=1.557e-04 per=8.973e+00
 T(ortho)  =1.033e-05 per=5.953e-01
 T(xcopy)  =7.710e-07 per=4.444e-02
 T(xnrm2)  =1.153e-06 per=6.646e-02
 T(other)  =1.451e-03 per=8.364e+01
optimized energies: isweep=0 ibond=9 dots=2 e[0]=-116.266701220274 nmvp=7
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:1.954e+01S Sys:1.125e+00S Total:2.066e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond9.txt
 qbond: qsuper nsym=12 dimAll=40
 (15,1):5 (17,1):4 (16,0):4 (16,2):8 (15,3):5 (17,3):3 (16,4):5 (14,2):1 (14,4):1 (15,5):2 (17,5):1 (16,6):1
----- TMING FOR decimation_genbasis(su2): 8.1e-05 S -----
decimation summary: 40->10 dwt=+1.232e-03 SvN=1.012e+00
 qbond: qkept nsym=4 dimAll=10
 (16,2):4 (16,4):4 (15,3):1 (17,3):1
----- TIMING for decimation_row(nkr): 3.396e-03 S T(decim/select/formRot)=4.166e-04,2.813e-03,1.666e-04 -----
----- TIMING FOR twodot_decimation: 3.618e-03 S T(wf/decim)=1.363e-04,3.481e-03 -----
ctns::oper_renorm coord=(10,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:11 S:9 H:1 P:81 Q:90 
        dim(bra,ket)=10,10 size(op)=66:5.035e-04MB size(tot)=4935:3.765e-02MB:3.677e-05GB
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:1.967e+01S Sys:1.125e+00S Total:2.080e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=192 : 7.921e-04 S -----
rank=0 GPUmem(GB): used=0.000131 (oper)=8.21e-05
rank=0 GPUmem(GB): used=0.000132 (oper,site)(GB)=8.21e-05,4.47e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=192
 no. of rintermediate operators=288
 no. of coefficients=2880:0.022MB:2.15e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.406e-04 S -----
rank=0 GPUmem(GB): used=0.000153 (oper,site,rinter)=8.21e-05,4.47e-07,2.15e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00351 S size(rtasks)=192 size(Rlst2)=16 T(Rmu/Rlist)=0.000243,0.00327 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00372 S size(rtasks)=192 size(Rlst)=4492 -----
rank=0 GPUmem(GB): used=0.000153 (oper,site,rinter,batch)=8.21e-05,4.47e-07,2.15e-05,0.00124 blksize=16 blksize0=4 batchsize=4492
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000114,0.000572,0.000218
--- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=5.7e-04 t_reduction=2.2e-04 tot=9.0e-04 ---
 renorm[inter] counter=10 t=1.1e-04 per=1.3e+01 cost=9.0e+04 flops=7.9e+08
 renorm[gemm] counter=10 i=0 t=2.9e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=1 t=2.3e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=2 t=2.2e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=3 t=2.2e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=10 i=4 t=1.9e-04 per=2.1e+01 cost=2.2e+04 flops=1.1e+08
 renorm[gemm] counter=10 i=5 t=2.0e-04 per=2.2e+01 cost=7.5e+04 flops=3.8e+08
 renorm[gemm] counter=10 i=6 t=1.7e-04 per=1.9e+01 cost=2.0e+05 flops=1.2e+09
 renorm[gemm] counter=10 total t=5.7e-04 per=6.3e+01 cost=3.0e+05 flops=5.2e+08
 renorm[red] counter=10 t=2.2e-04 per=2.4e+01 cost=9.2e+04 flops=4.2e+08
--- TIMING FOR renorm_tot : t_inter=1.3e-03 t_gemm=5.8e-03 t_reduction=2.2e-03 tot=9.3e-03 ---
 renorm_tot[inter] counter=10 t=1.3e-03 per=1.4e+01 cost=9.8e+05 flops=7.3e+08
 renorm_tot[gemm] counter=10 i=0 t=2.8e-05 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=1 t=2.2e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=2 t=2.2e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=3 t=2.2e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=10 i=4 t=1.9e-03 per=2.1e+01 cost=1.3e+05 flops=6.8e+07
 renorm_tot[gemm] counter=10 i=5 t=1.9e-03 per=2.0e+01 cost=3.7e+05 flops=1.9e+08
 renorm_tot[gemm] counter=10 i=6 t=1.9e-03 per=2.1e+01 cost=6.2e+05 flops=3.2e+08
 renorm_tot[gemm] counter=10 total t=5.8e-03 per=6.2e+01 cost=1.1e+06 flops=1.9e+08
 renorm_tot[red] counter=10 t=2.2e-03 per=2.4e+01 cost=2.6e+05 flops=1.2e+08
qops.to_cpu: size(tot)=4935:3.8e-02MB:3.7e-05GB t[to_cpu]=2.3e-05S speed=1.6e+00GB/S
check ||H-H.dagger||=3.585e-15 coord=(10,0) rank=0
ctns::oper_ab2pq coord=(10,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.01 S rank=0 -----
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:1.984e+01S Sys:1.125e+00S Total:2.097e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=518:3.952e-03MB:3.859e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=50:3.815e-04MB:3.725e-07GB
total mem of comb=569:4.341e-03MB:4.239e-06GB
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:1.984e+01S Sys:1.125e+00S Total:2.097e+01S
##### local opt: 9.940e-02 S #####
 T(local opt: fetch) = 6.470e-03 S  per = 6.51  per(accum) = 6.51
 T(local opt: hdiag) = 9.170e-03 S  per = 9.23  per(accum) = 15.7
 T(local opt: dvdsn) = 6.453e-02 S  per = 64.9  per(accum) = 80.7
 T(local opt: decim) = 3.706e-03 S  per = 3.73  per(accum) = 84.4
 T(local opt: guess) = 8.386e-05 S  per = 0.0844  per(accum) = 84.5
 T(local opt: renrm) = 1.097e-02 S  per =   11  per(accum) = 95.5
 T(local opt: save ) = 4.465e-03 S  per = 4.49  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.453e-02 S  T(sum) = 6.357e-02 S  per = 9.852e+01
 T(local opt: preprocess                  ) = 5.778e-04 S  per = 0.909  per(accum) = 0.909
 T(local opt: symbolic_formulae           ) = 1.685e-03 S  per = 2.65  per(accum) = 3.56
 T(local opt: hintermediate init          ) = 6.593e-04 S  per = 1.04  per(accum) = 4.6
 T(local opt: preprocess_hformulae_Hxlist ) = 2.749e-02 S  per = 43.2  per(accum) = 47.8
 T(local opt: hmmtasks init               ) = 4.310e-03 S  per = 6.78  per(accum) = 54.6
 T(local opt: initial guess for dvdson    ) = 2.304e-04 S  per = 0.362  per(accum) = 55
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.670e-02 S  per =   42  per(accum) = 97
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.937e-04 S  per = 0.305  per(accum) = 97.3
 T(local opt: dvdson solver [comm(cpu)]   ) = 4.040e-07 S  per = 0.000635  per(accum) = 97.3
 T(local opt: dvdson solver [rest part]   ) = 1.735e-03 S  per = 2.73  per(accum) = 100
Detailed decomposition of T(renrm) = 1.097e-02 S  T(sum) = 1.097e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.091e-04 S  per = 0.994  per(accum) = 0.994
 T(local opt: qops init                    ) = 5.478e-04 S  per = 4.99  per(accum) = 5.99
 T(local opt: symbolic_formulae_renorm     ) = 8.902e-04 S  per = 8.11  per(accum) = 14.1
 T(local opt: allocate qops on gpu         ) = 1.007e-04 S  per = 0.918  per(accum) = 15
 T(local opt: site memcpy cpu2gpu          ) = 9.458e-05 S  per = 0.862  per(accum) = 15.9
 T(local opt: rintermediate init           ) = 4.885e-04 S  per = 4.45  per(accum) = 20.3
 T(local opt: preprocess_formulae_Rlist2   ) = 3.813e-03 S  per = 34.8  per(accum) = 55.1
 T(local opt: rmmtasks init                ) = 1.160e-03 S  per = 10.6  per(accum) = 65.7
 T(local opt: qops memset on cpu           ) = 7.500e-08 S  per = 0.000684  per(accum) = 65.7
 T(local opt: preprocess_renorm_batchGPU   ) = 2.733e-03 S  per = 24.9  per(accum) = 90.6
 T(local opt: reduction of opS & opH [nccl]) = 6.070e-07 S  per = 0.00553  per(accum) = 90.6
 T(local opt: qops memcpy gpu2cpu          ) = 9.895e-05 S  per = 0.902  per(accum) = 91.5
 T(local opt: deallocate cpu and gpu memory) = 9.823e-06 S  per = 0.0895  per(accum) = 91.6
 T(local opt: reduction of opS & opH [comm]) = 8.141e-05 S  per = 0.742  per(accum) = 92.3
 T(local opt: conversion from opAB to opPQ ) = 7.355e-05 S  per = 0.67  per(accum) = 93
 T(local opt: after oper_renorm            ) = 7.694e-04 S  per = 7.01  per(accum) = 100
##### sweep opt: 8.928e-01 S #####
 T(sweep opt: fetch) = 6.898e-02 S  per = 7.73  per(accum) = 7.73
 T(sweep opt: hdiag) = 6.177e-02 S  per = 6.92  per(accum) = 14.6
 T(sweep opt: dvdsn) = 5.892e-01 S  per =   66  per(accum) = 80.6
 T(sweep opt: decim) = 3.861e-02 S  per = 4.32  per(accum) = 85
 T(sweep opt: guess) = 1.605e-03 S  per = 0.18  per(accum) = 85.1
 T(sweep opt: renrm) = 8.704e-02 S  per = 9.75  per(accum) = 94.9
 T(sweep opt: save ) = 4.555e-02 S  per =  5.1  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.892e-01 S  T(sum) = 5.802e-01 S  per = 9.848e+01
 T(sweep opt: preprocess                  ) = 7.077e-03 S  per = 1.22  per(accum) = 1.22
 T(sweep opt: symbolic_formulae           ) = 1.164e-02 S  per = 2.01  per(accum) = 3.23
 T(sweep opt: hintermediate init          ) = 5.901e-03 S  per = 1.02  per(accum) = 4.24
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.471e-01 S  per = 42.6  per(accum) = 46.8
 T(sweep opt: hmmtasks init               ) = 4.243e-02 S  per = 7.31  per(accum) = 54.1
 T(sweep opt: initial guess for dvdson    ) = 2.566e-03 S  per = 0.442  per(accum) = 54.6
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 2.446e-01 S  per = 42.2  per(accum) = 96.7
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 1.837e-03 S  per = 0.317  per(accum) = 97.1
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 3.104e-06 S  per = 0.000535  per(accum) = 97.1
 T(sweep opt: dvdson solver [rest part]   ) = 1.705e-02 S  per = 2.94  per(accum) = 100
Detailed decomposition of T(renrm) = 8.704e-02 S  T(sum) = 8.704e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.303e-03 S  per =  1.5  per(accum) = 1.5
 T(sweep opt: qops init                    ) = 4.820e-03 S  per = 5.54  per(accum) = 7.03
 T(sweep opt: symbolic_formulae_renorm     ) = 5.075e-03 S  per = 5.83  per(accum) = 12.9
 T(sweep opt: allocate qops on gpu         ) = 9.748e-04 S  per = 1.12  per(accum) = 14
 T(sweep opt: site memcpy cpu2gpu          ) = 9.104e-04 S  per = 1.05  per(accum) = 15
 T(sweep opt: rintermediate init           ) = 4.782e-03 S  per = 5.49  per(accum) = 20.5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.961e-02 S  per = 22.5  per(accum) = 43.1
 T(sweep opt: rmmtasks init                ) = 6.309e-03 S  per = 7.25  per(accum) = 50.3
 T(sweep opt: qops memset on cpu           ) = 5.380e-07 S  per = 0.000618  per(accum) = 50.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.718e-02 S  per = 31.2  per(accum) = 81.5
 T(sweep opt: reduction of opS & opH [nccl]) = 5.726e-06 S  per = 0.00658  per(accum) = 81.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 9.525e-04 S  per = 1.09  per(accum) = 82.6
 T(sweep opt: deallocate cpu and gpu memory) = 2.401e-04 S  per = 0.276  per(accum) = 82.9
 T(sweep opt: reduction of opS & opH [comm]) = 8.836e-04 S  per = 1.02  per(accum) = 83.9
 T(sweep opt: conversion from opAB to opPQ ) = 6.696e-03 S  per = 7.69  per(accum) = 91.6
 T(sweep opt: after oper_renorm            ) = 7.297e-03 S  per = 8.38  per(accum) = 100
##### global opt: 8.928e-01 S #####
 T(global opt: fetch) = 6.898e-02 S  per = 7.73  per(accum) = 7.73
 T(global opt: hdiag) = 6.177e-02 S  per = 6.92  per(accum) = 14.6
 T(global opt: dvdsn) = 5.892e-01 S  per =   66  per(accum) = 80.6
 T(global opt: decim) = 3.861e-02 S  per = 4.32  per(accum) = 85
 T(global opt: guess) = 1.605e-03 S  per = 0.18  per(accum) = 85.1
 T(global opt: renrm) = 8.704e-02 S  per = 9.75  per(accum) = 94.9
 T(global opt: save ) = 4.555e-02 S  per =  5.1  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.892e-01 S  T(sum) = 5.802e-01 S  per = 9.848e+01
 T(global opt: preprocess                  ) = 7.077e-03 S  per = 1.22  per(accum) = 1.22
 T(global opt: symbolic_formulae           ) = 1.164e-02 S  per = 2.01  per(accum) = 3.23
 T(global opt: hintermediate init          ) = 5.901e-03 S  per = 1.02  per(accum) = 4.24
 T(global opt: preprocess_hformulae_Hxlist ) = 2.471e-01 S  per = 42.6  per(accum) = 46.8
 T(global opt: hmmtasks init               ) = 4.243e-02 S  per = 7.31  per(accum) = 54.1
 T(global opt: initial guess for dvdson    ) = 2.566e-03 S  per = 0.442  per(accum) = 54.6
 T(global opt: dvdson solver [Hx_batchGPU] ) = 2.446e-01 S  per = 42.2  per(accum) = 96.7
 T(global opt: dvdson solver [comm(gpu)]   ) = 1.837e-03 S  per = 0.317  per(accum) = 97.1
 T(global opt: dvdson solver [comm(cpu)]   ) = 3.104e-06 S  per = 0.000535  per(accum) = 97.1
 T(global opt: dvdson solver [rest part]   ) = 1.705e-02 S  per = 2.94  per(accum) = 100
Detailed decomposition of T(renrm) = 8.704e-02 S  T(sum) = 8.704e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.303e-03 S  per =  1.5  per(accum) = 1.5
 T(global opt: qops init                    ) = 4.820e-03 S  per = 5.54  per(accum) = 7.03
 T(global opt: symbolic_formulae_renorm     ) = 5.075e-03 S  per = 5.83  per(accum) = 12.9
 T(global opt: allocate qops on gpu         ) = 9.748e-04 S  per = 1.12  per(accum) = 14
 T(global opt: site memcpy cpu2gpu          ) = 9.104e-04 S  per = 1.05  per(accum) = 15
 T(global opt: rintermediate init           ) = 4.782e-03 S  per = 5.49  per(accum) = 20.5
 T(global opt: preprocess_formulae_Rlist2   ) = 1.961e-02 S  per = 22.5  per(accum) = 43.1
 T(global opt: rmmtasks init                ) = 6.309e-03 S  per = 7.25  per(accum) = 50.3
 T(global opt: qops memset on cpu           ) = 5.380e-07 S  per = 0.000618  per(accum) = 50.3
 T(global opt: preprocess_renorm_batchGPU   ) = 2.718e-02 S  per = 31.2  per(accum) = 81.5
 T(global opt: reduction of opS & opH [nccl]) = 5.726e-06 S  per = 0.00658  per(accum) = 81.5
 T(global opt: qops memcpy gpu2cpu          ) = 9.525e-04 S  per = 1.09  per(accum) = 82.6
 T(global opt: deallocate cpu and gpu memory) = 2.401e-04 S  per = 0.276  per(accum) = 82.9
 T(global opt: reduction of opS & opH [comm]) = 8.836e-04 S  per = 1.02  per(accum) = 83.9
 T(global opt: conversion from opAB to opPQ ) = 6.696e-03 S  per = 7.69  per(accum) = 91.6
 T(global opt: after oper_renorm            ) = 7.297e-03 S  per = 8.38  per(accum) = 100

isweep=0 ibond=10/seqsize=34 dots=2 dbond=(11,0)-(12,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:1.985e+01S Sys:1.125e+00S Total:2.097e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=518:3.952e-03MB:3.859e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=50:3.815e-04MB:3.725e-07GB
total mem of comb=569:4.341e-03MB:4.239e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=11,7,1,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc1= 7
 suppc2= 8
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:11 S:9 H:1 P:81 Q:90 
        dim(bra,ket)=10,10 size(op)=66:5.035e-04MB size(tot)=4935:3.765e-02MB:3.677e-05GB
 rqops: oplist=CSHAB nops=C:7 S:13 H:1 A:49 B:56 
        dim(bra,ket)=6,6 size(op)=20:1.526e-04MB size(tot)=1068:8.148e-03MB:7.957e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=7999:6.103e-02MB:5.960e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(11,0) fdel=./scratch/sweep/rop(12,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
wf4(diml,dimr,dimc1,dimc2)=(10,6,3,3) nnz=66:5.035e-04MB
qtensor4: wf4 own=1 _data=0x55a3193135a0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (16,2):4 (16,4):4 (15,3):1 (17,3):1
 qbond: qcol nsym=3 dimAll=6
 (10,2):2 (10,4):2 (11,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=15 nblocks=192 size=66:5.035e-04MB
### DIAG TIMING: total=5.475e-03 t1=2.336e-05, t2=1.943e-05, t3=1.987e-05, t4=5.384e-03, t5=5.051e-06, t6=1.869e-05, t7=3.919e-06
duration_diagGPU:5.575e-03
duration_diagreduce:6.000e-08
duration_diagtransform:3.340e-07
----- TIMING FOR symbolic_formulae_twodot with size=716 : 1.377e-03 S -----
rank=0 GPUmem(GB): used=5.96e-05 (oper)=5.96e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=716
 no. of hintermediate operators=345
 no. of coefficients=4876:0.0372MB:3.63e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.886e-04 S -----
rank=0 GPUmem(GB): used=9.59e-05 (oper,hinter)=5.96e-05,3.63e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0174 S size(H_formulae)=716 size(Hxlst2)=15 T(Hmu/Hxlist)=0.000263,0.0171 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0177 S size(H_formulae)=716 size(Hxlst)=10128 -----
rank=0 GPUmem(GB): used=0.00168 (oper,hinter,dvdson,batch)=5.96e-05,3.63e-05,9.83e-07,0.00158 blksize=8 blksize0=4 batchsize=10128
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=66 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.13e-05,0.000151,0.000515,0.000533,0.00124
 ndim=66:4.92e-07GB t[comm(intra)]=2.38e-05 speed=0.0414GB/S t[comm(inter)]=7.48e-06 speed=0.131GB/S
--- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=5.1e-04 t_reduction=5.3e-04 tot=1.2e-03 ---
 sigma[inter] counter=65 t=1.5e-04 per=1.3e+01 cost=5.2e+05 flops=3.5e+09
 sigma[gemm] counter=65 i=0 t=2.8e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=1 t=2.3e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=2 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=3 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=4 t=1.1e-04 per=8.9e+00 cost=8.7e+04 flops=8.2e+08
 sigma[gemm] counter=65 i=5 t=1.8e-04 per=1.5e+01 cost=8.3e+04 flops=4.5e+08
 sigma[gemm] counter=65 i=6 t=1.1e-04 per=9.0e+00 cost=8.3e+04 flops=7.7e+08
 sigma[gemm] counter=65 i=7 t=1.1e-04 per=8.9e+00 cost=8.3e+04 flops=7.8e+08
 sigma[gemm] counter=65 total t=5.1e-04 per=4.3e+01 cost=3.4e+05 flops=6.5e+08
 sigma[red] counter=65 t=5.3e-04 per=4.4e+01 cost=9.3e+04 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=5.3e-02 t_reduction=5.2e-02 tot=1.2e-01 ---
 sigma_tot[inter] counter=65 t=1.0e-02 per=8.8e+00 cost=6.7e+07 flops=6.6e+09
 sigma_tot[gemm] counter=65 i=0 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=1 t=1.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=2 t=1.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=3 t=1.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=4 t=1.2e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=65 i=5 t=1.4e-02 per=1.2e+01 cost=1.4e+07 flops=9.9e+08
 sigma_tot[gemm] counter=65 i=6 t=1.3e-02 per=1.1e+01 cost=1.3e+07 flops=9.9e+08
 sigma_tot[gemm] counter=65 i=7 t=1.3e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=65 total t=5.3e-02 per=4.6e+01 cost=5.4e+07 flops=1.0e+09
 sigma_tot[red] counter=65 t=5.2e-02 per=4.5e+01 cost=1.2e+07 flops=2.4e+08
T(sub)=9.9e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,3.2e-06,9.8e-07,2.6e-06,1.9e-07
settings: ndim=66 neig=1 maxcycle=30 nbuff=4 memory=7e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.265955787654 -1.116e+03  6.723e-02    1     1  3.644e-03 3.644e-03 3.466e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.834e-05,1.264e-04,4.305e-04,4.899e-04,1.080e-03
 ndim=66:4.917e-07GB t[comm(intra)]=2.262e-05 speed=4.348e-02GB/S t[comm(inter)]=5.724e-06 speed=1.718e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=4.3e-04 t_reduction=4.9e-04 tot=1.0e-03 ---
 sigma[inter] counter=66 t=1.3e-04 per=1.2e+01 cost=5.2e+05 flops=4.1e+09
 sigma[gemm] counter=66 i=0 t=2.7e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=1 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=2 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=3 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=4 t=9.1e-05 per=8.7e+00 cost=8.7e+04 flops=9.6e+08
 sigma[gemm] counter=66 i=5 t=1.6e-04 per=1.5e+01 cost=8.3e+04 flops=5.3e+08
 sigma[gemm] counter=66 i=6 t=8.7e-05 per=8.3e+00 cost=8.3e+04 flops=9.5e+08
 sigma[gemm] counter=66 i=7 t=8.6e-05 per=8.2e+00 cost=8.3e+04 flops=9.7e+08
 sigma[gemm] counter=66 total t=4.3e-04 per=4.1e+01 cost=3.4e+05 flops=7.8e+08
 sigma[red] counter=66 t=4.9e-04 per=4.7e+01 cost=9.3e+04 flops=1.9e+08
--- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=5.3e-02 t_reduction=5.3e-02 tot=1.2e-01 ---
 sigma_tot[inter] counter=66 t=1.0e-02 per=8.9e+00 cost=6.8e+07 flops=6.6e+09
 sigma_tot[gemm] counter=66 i=0 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=1 t=1.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=2 t=1.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=3 t=1.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=4 t=1.2e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=66 i=5 t=1.4e-02 per=1.2e+01 cost=1.4e+07 flops=9.9e+08
 sigma_tot[gemm] counter=66 i=6 t=1.3e-02 per=1.1e+01 cost=1.3e+07 flops=9.9e+08
 sigma_tot[gemm] counter=66 i=7 t=1.3e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=66 total t=5.3e-02 per=4.6e+01 cost=5.5e+07 flops=1.0e+09
 sigma_tot[red] counter=66 t=5.3e-02 per=4.5e+01 cost=1.2e+07 flops=2.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.2e-05,2.2e-06,9.4e-07,1.8e-07
    2   0 -    -116.283268563121 -1.731e-02  1.917e-02    2     2  7.325e-03 3.663e-03 3.282e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.701e-05,1.088e-04,4.282e-04,4.853e-04,1.054e-03
 ndim=66:4.917e-07GB t[comm(intra)]=2.151e-05 speed=4.573e-02GB/S t[comm(inter)]=5.503e-06 speed=1.787e-01GB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=4.3e-04 t_reduction=4.9e-04 tot=1.0e-03 ---
 sigma[inter] counter=67 t=1.1e-04 per=1.1e+01 cost=5.2e+05 flops=4.8e+09
 sigma[gemm] counter=67 i=0 t=2.3e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=1 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=2 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=3 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=4 t=8.9e-05 per=8.7e+00 cost=8.7e+04 flops=9.8e+08
 sigma[gemm] counter=67 i=5 t=1.6e-04 per=1.5e+01 cost=8.3e+04 flops=5.3e+08
 sigma[gemm] counter=67 i=6 t=8.8e-05 per=8.6e+00 cost=8.3e+04 flops=9.4e+08
 sigma[gemm] counter=67 i=7 t=8.5e-05 per=8.4e+00 cost=8.3e+04 flops=9.7e+08
 sigma[gemm] counter=67 total t=4.3e-04 per=4.2e+01 cost=3.4e+05 flops=7.9e+08
 sigma[red] counter=67 t=4.9e-04 per=4.7e+01 cost=9.3e+04 flops=1.9e+08
--- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=5.4e-02 t_reduction=5.3e-02 tot=1.2e-01 ---
 sigma_tot[inter] counter=67 t=1.0e-02 per=8.9e+00 cost=6.8e+07 flops=6.5e+09
 sigma_tot[gemm] counter=67 i=0 t=1.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=1 t=1.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=2 t=1.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=3 t=1.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=4 t=1.3e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=67 i=5 t=1.4e-02 per=1.2e+01 cost=1.4e+07 flops=9.8e+08
 sigma_tot[gemm] counter=67 i=6 t=1.3e-02 per=1.1e+01 cost=1.3e+07 flops=9.9e+08
 sigma_tot[gemm] counter=67 i=7 t=1.3e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=67 total t=5.4e-02 per=4.6e+01 cost=5.5e+07 flops=1.0e+09
 sigma_tot[red] counter=67 t=5.3e-02 per=4.5e+01 cost=1.2e+07 flops=2.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.3e-05,1.8e-06,8.4e-07,1.8e-07
    3   0 -    -116.284692016057 -1.423e-03  9.291e-03    3     3  1.060e-02 3.535e-03 3.216e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.792e-05,1.100e-04,4.373e-04,4.871e-04,1.067e-03
 ndim=66:4.917e-07GB t[comm(intra)]=2.245e-05 speed=4.381e-02GB/S t[comm(inter)]=5.471e-06 speed=1.798e-01GB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=4.4e-04 t_reduction=4.9e-04 tot=1.0e-03 ---
 sigma[inter] counter=68 t=1.1e-04 per=1.1e+01 cost=5.2e+05 flops=4.8e+09
 sigma[gemm] counter=68 i=0 t=2.7e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=1 t=2.3e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=2 t=2.3e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=3 t=2.3e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=4 t=9.1e-05 per=8.8e+00 cost=8.7e+04 flops=9.6e+08
 sigma[gemm] counter=68 i=5 t=1.7e-04 per=1.6e+01 cost=8.3e+04 flops=5.0e+08
 sigma[gemm] counter=68 i=6 t=8.7e-05 per=8.4e+00 cost=8.3e+04 flops=9.6e+08
 sigma[gemm] counter=68 i=7 t=8.5e-05 per=8.2e+00 cost=8.3e+04 flops=9.8e+08
 sigma[gemm] counter=68 total t=4.4e-04 per=4.2e+01 cost=3.4e+05 flops=7.7e+08
 sigma[red] counter=68 t=4.9e-04 per=4.7e+01 cost=9.3e+04 flops=1.9e+08
--- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.4e-02 t_reduction=5.4e-02 tot=1.2e-01 ---
 sigma_tot[inter] counter=68 t=1.1e-02 per=8.9e+00 cost=6.9e+07 flops=6.5e+09
 sigma_tot[gemm] counter=68 i=0 t=1.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=1 t=1.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=2 t=1.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=3 t=1.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=4 t=1.3e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=68 i=5 t=1.5e-02 per=1.2e+01 cost=1.4e+07 flops=9.8e+08
 sigma_tot[gemm] counter=68 i=6 t=1.3e-02 per=1.1e+01 cost=1.3e+07 flops=9.9e+08
 sigma_tot[gemm] counter=68 i=7 t=1.3e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=68 total t=5.4e-02 per=4.6e+01 cost=5.5e+07 flops=1.0e+09
 sigma_tot[red] counter=68 t=5.4e-02 per=4.5e+01 cost=1.3e+07 flops=2.3e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.1e-05,1.7e-06,7.8e-07,1.3e-07
    4   0 -    -116.284939065654 -2.470e-04  3.261e-03    3     4  1.383e-02 3.457e-03 3.172e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.758e-05,1.231e-04,4.312e-04,4.852e-04,1.072e-03
 ndim=66:4.917e-07GB t[comm(intra)]=2.215e-05 speed=4.440e-02GB/S t[comm(inter)]=5.433e-06 speed=1.810e-01GB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=4.3e-04 t_reduction=4.9e-04 tot=1.0e-03 ---
 sigma[inter] counter=69 t=1.2e-04 per=1.2e+01 cost=5.2e+05 flops=4.3e+09
 sigma[gemm] counter=69 i=0 t=2.7e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=1 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=2 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=3 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=4 t=8.1e-05 per=7.8e+00 cost=8.7e+04 flops=1.1e+09
 sigma[gemm] counter=69 i=5 t=1.7e-04 per=1.6e+01 cost=8.3e+04 flops=5.0e+08
 sigma[gemm] counter=69 i=6 t=8.7e-05 per=8.4e+00 cost=8.3e+04 flops=9.5e+08
 sigma[gemm] counter=69 i=7 t=8.7e-05 per=8.3e+00 cost=8.3e+04 flops=9.6e+08
 sigma[gemm] counter=69 total t=4.3e-04 per=4.1e+01 cost=3.4e+05 flops=7.8e+08
 sigma[red] counter=69 t=4.9e-04 per=4.7e+01 cost=9.3e+04 flops=1.9e+08
--- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.5e-02 t_reduction=5.4e-02 tot=1.2e-01 ---
 sigma_tot[inter] counter=69 t=1.1e-02 per=8.9e+00 cost=6.9e+07 flops=6.5e+09
 sigma_tot[gemm] counter=69 i=0 t=1.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=1 t=1.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=2 t=1.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=3 t=1.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=4 t=1.3e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=69 i=5 t=1.5e-02 per=1.2e+01 cost=1.4e+07 flops=9.7e+08
 sigma_tot[gemm] counter=69 i=6 t=1.3e-02 per=1.1e+01 cost=1.3e+07 flops=9.9e+08
 sigma_tot[gemm] counter=69 i=7 t=1.3e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=69 total t=5.5e-02 per=4.6e+01 cost=5.6e+07 flops=1.0e+09
 sigma_tot[red] counter=69 t=5.4e-02 per=4.5e+01 cost=1.3e+07 flops=2.3e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.0e-05,1.6e-06,8.1e-07,1.3e-07
    5   0 -    -116.284965677036 -2.661e-05  8.213e-04    3     5  1.706e-02 3.413e-03 3.149e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.746e-05,1.121e-04,4.355e-04,4.854e-04,1.065e-03
 ndim=66:4.917e-07GB t[comm(intra)]=2.247e-05 speed=4.377e-02GB/S t[comm(inter)]=4.988e-06 speed=1.972e-01GB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=4.4e-04 t_reduction=4.9e-04 tot=1.0e-03 ---
 sigma[inter] counter=70 t=1.1e-04 per=1.1e+01 cost=5.2e+05 flops=4.7e+09
 sigma[gemm] counter=70 i=0 t=2.4e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=1 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=2 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=3 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=4 t=8.9e-05 per=8.6e+00 cost=8.7e+04 flops=9.8e+08
 sigma[gemm] counter=70 i=5 t=1.7e-04 per=1.6e+01 cost=8.3e+04 flops=5.0e+08
 sigma[gemm] counter=70 i=6 t=8.6e-05 per=8.3e+00 cost=8.3e+04 flops=9.7e+08
 sigma[gemm] counter=70 i=7 t=8.6e-05 per=8.3e+00 cost=8.3e+04 flops=9.7e+08
 sigma[gemm] counter=70 total t=4.4e-04 per=4.2e+01 cost=3.4e+05 flops=7.7e+08
 sigma[red] counter=70 t=4.9e-04 per=4.7e+01 cost=9.3e+04 flops=1.9e+08
--- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.5e-02 t_reduction=5.5e-02 tot=1.2e-01 ---
 sigma_tot[inter] counter=70 t=1.1e-02 per=8.9e+00 cost=7.0e+07 flops=6.5e+09
 sigma_tot[gemm] counter=70 i=0 t=1.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=1 t=1.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=2 t=1.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=3 t=1.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=4 t=1.3e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=70 i=5 t=1.5e-02 per=1.2e+01 cost=1.4e+07 flops=9.7e+08
 sigma_tot[gemm] counter=70 i=6 t=1.3e-02 per=1.1e+01 cost=1.3e+07 flops=9.9e+08
 sigma_tot[gemm] counter=70 i=7 t=1.3e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=70 total t=5.5e-02 per=4.6e+01 cost=5.6e+07 flops=1.0e+09
 sigma_tot[red] counter=70 t=5.5e-02 per=4.5e+01 cost=1.3e+07 flops=2.3e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.2e-05,1.8e-06,8.2e-07,1.3e-07
    6   0 -    -116.284967142752 -1.466e-06  2.087e-04    3     6  2.037e-02 3.395e-03 3.142e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.774e-05,1.014e-04,5.019e-04,4.866e-04,1.123e-03
 ndim=66:4.917e-07GB t[comm(intra)]=2.195e-05 speed=4.481e-02GB/S t[comm(inter)]=5.788e-06 speed=1.699e-01GB/S
--- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=5.0e-04 t_reduction=4.9e-04 tot=1.1e-03 ---
 sigma[inter] counter=71 t=1.0e-04 per=9.3e+00 cost=5.2e+05 flops=5.2e+09
 sigma[gemm] counter=71 i=0 t=2.3e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=1 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=2 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=3 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=4 t=9.3e-05 per=8.5e+00 cost=8.7e+04 flops=9.4e+08
 sigma[gemm] counter=71 i=5 t=1.7e-04 per=1.5e+01 cost=8.3e+04 flops=5.0e+08
 sigma[gemm] counter=71 i=6 t=1.1e-04 per=1.0e+01 cost=8.3e+04 flops=7.5e+08
 sigma[gemm] counter=71 i=7 t=1.2e-04 per=1.1e+01 cost=8.3e+04 flops=6.7e+08
 sigma[gemm] counter=71 total t=5.0e-04 per=4.6e+01 cost=3.4e+05 flops=6.7e+08
 sigma[red] counter=71 t=4.9e-04 per=4.5e+01 cost=9.3e+04 flops=1.9e+08
--- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.5e-02 t_reduction=5.5e-02 tot=1.2e-01 ---
 sigma_tot[inter] counter=71 t=1.1e-02 per=8.9e+00 cost=7.0e+07 flops=6.5e+09
 sigma_tot[gemm] counter=71 i=0 t=1.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=1 t=1.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=2 t=1.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=3 t=1.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=4 t=1.3e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=71 i=5 t=1.5e-02 per=1.2e+01 cost=1.4e+07 flops=9.6e+08
 sigma_tot[gemm] counter=71 i=6 t=1.4e-02 per=1.1e+01 cost=1.3e+07 flops=9.9e+08
 sigma_tot[gemm] counter=71 i=7 t=1.3e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=71 total t=5.5e-02 per=4.6e+01 cost=5.6e+07 flops=1.0e+09
 sigma_tot[red] counter=71 t=5.5e-02 per=4.5e+01 cost=1.3e+07 flops=2.3e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.1e-05,1.6e-06,8.0e-07,1.4e-07
    7   0 +    -116.284967260831 -1.181e-07  7.495e-05    3     7  2.374e-02 3.391e-03 3.146e-03
TIMING FOR Davidson : 2.382e-02  T(cal/comm/rest)=2.202e-02,3.080e-07,1.802e-03
decomposed t_rest=1.802e-03
 T(sub)    =1.174e-04 per=6.515e+00
 T(precond)=2.110e-04 per=1.171e+01
 T(ortho)  =1.102e-05 per=6.116e-01
 T(xcopy)  =8.150e-07 per=4.523e-02
 T(xnrm2)  =1.135e-06 per=6.298e-02
 T(other)  =1.461e-03 per=8.106e+01
optimized energies: isweep=0 ibond=10 dots=2 e[0]=-116.284967260831 nmvp=7
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:2.095e+01S Sys:1.132e+00S Total:2.208e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond10.txt
 qbond: qsuper nsym=9 dimAll=40
 (16,2):5 (18,2):5 (17,1):4 (17,3):10 (16,4):5 (18,4):5 (17,5):4 (15,3):1 (19,3):1
----- TMING FOR decimation_genbasis(su2): 7.0e-05 S -----
decimation summary: 40->10 dwt=+7.393e-07 SvN=7.321e-01
 qbond: qkept nsym=4 dimAll=10
 (18,2):4 (18,4):3 (17,3):2 (19,3):1
----- TIMING for decimation_row(nkr): 3.177e-03 S T(decim/select/formRot)=3.930e-04,2.621e-03,1.625e-04 -----
----- TIMING FOR twodot_decimation: 3.379e-03 S T(wf/decim)=1.227e-04,3.256e-03 -----
ctns::oper_renorm coord=(11,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:12 S:8 H:1 P:64 Q:72 
        dim(bra,ket)=10,10 size(op)=54:4.120e-04MB size(tot)=3602:2.748e-02MB:2.684e-05GB
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:2.119e+01S Sys:1.136e+00S Total:2.232e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=157 : 6.715e-04 S -----
rank=0 GPUmem(GB): used=0.000115 (oper)=7.1e-05
rank=0 GPUmem(GB): used=0.000115 (oper,site)(GB)=7.1e-05,4.17e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=157
 no. of rintermediate operators=232
 no. of coefficients=2552:0.0195MB:1.9e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.444e-04 S -----
rank=0 GPUmem(GB): used=0.000134 (oper,site,rinter)=7.1e-05,4.17e-07,1.9e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00261 S size(rtasks)=157 size(Rlst2)=16 T(Rmu/Rlist)=0.000206,0.00241 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00281 S size(rtasks)=157 size(Rlst)=3274 -----
rank=0 GPUmem(GB): used=0.000134 (oper,site,rinter,batch)=7.1e-05,4.17e-07,1.9e-05,0.000903 blksize=16 blksize0=4 batchsize=3274
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.72e-05,0.000721,0.000289
--- TIMING FOR renorm : t_inter=9.7e-05 t_gemm=7.2e-04 t_reduction=2.9e-04 tot=1.1e-03 ---
 renorm[inter] counter=11 t=9.7e-05 per=8.8e+00 cost=1.1e+05 flops=1.1e+09
 renorm[gemm] counter=11 i=0 t=2.8e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=1 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=2 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=3 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=11 i=4 t=2.0e-04 per=1.8e+01 cost=2.2e+04 flops=1.1e+08
 renorm[gemm] counter=11 i=5 t=2.0e-04 per=1.8e+01 cost=5.7e+04 flops=2.9e+08
 renorm[gemm] counter=11 i=6 t=3.2e-04 per=2.9e+01 cost=1.1e+05 flops=3.6e+08
 renorm[gemm] counter=11 total t=7.2e-04 per=6.5e+01 cost=1.9e+05 flops=2.7e+08
 renorm[red] counter=11 t=2.9e-04 per=2.6e+01 cost=4.7e+04 flops=1.6e+08
--- TIMING FOR renorm_tot : t_inter=1.4e-03 t_gemm=6.5e-03 t_reduction=2.5e-03 tot=1.0e-02 ---
 renorm_tot[inter] counter=11 t=1.4e-03 per=1.4e+01 cost=1.1e+06 flops=7.6e+08
 renorm_tot[gemm] counter=11 i=0 t=3.1e-05 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=1 t=2.5e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=2 t=2.4e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=3 t=2.4e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=11 i=4 t=2.1e-03 per=2.0e+01 cost=1.5e+05 flops=7.2e+07
 renorm_tot[gemm] counter=11 i=5 t=2.1e-03 per=2.0e+01 cost=4.2e+05 flops=2.0e+08
 renorm_tot[gemm] counter=11 i=6 t=2.2e-03 per=2.1e+01 cost=7.4e+05 flops=3.3e+08
 renorm_tot[gemm] counter=11 total t=6.5e-03 per=6.2e+01 cost=1.3e+06 flops=2.0e+08
 renorm_tot[red] counter=11 t=2.5e-03 per=2.4e+01 cost=3.1e+05 flops=1.2e+08
qops.to_cpu: size(tot)=3602:2.7e-02MB:2.7e-05GB t[to_cpu]=2.1e-05S speed=1.3e+00GB/S
check ||H-H.dagger||=6.190e-15 coord=(11,0) rank=0
ctns::oper_ab2pq coord=(11,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00895 S rank=0 -----
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:2.147e+01S Sys:1.136e+00S Total:2.261e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=532:4.059e-03MB:3.964e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=38:2.899e-04MB:2.831e-07GB
total mem of comb=571:4.356e-03MB:4.254e-06GB
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:2.147e+01S Sys:1.138e+00S Total:2.261e+01S
##### local opt: 8.022e-02 S #####
 T(local opt: fetch) = 5.883e-03 S  per = 7.33  per(accum) = 7.33
 T(local opt: hdiag) = 6.542e-03 S  per = 8.15  per(accum) = 15.5
 T(local opt: dvdsn) = 4.833e-02 S  per = 60.2  per(accum) = 75.7
 T(local opt: decim) = 3.457e-03 S  per = 4.31  per(accum) = 80
 T(local opt: guess) = 6.993e-05 S  per = 0.0872  per(accum) = 80.1
 T(local opt: renrm) = 9.947e-03 S  per = 12.4  per(accum) = 92.5
 T(local opt: save ) = 5.989e-03 S  per = 7.47  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.833e-02 S  T(sum) = 4.739e-02 S  per = 9.806e+01
 T(local opt: preprocess                  ) = 4.795e-04 S  per = 1.01  per(accum) = 1.01
 T(local opt: symbolic_formulae           ) = 1.475e-03 S  per = 3.11  per(accum) = 4.12
 T(local opt: hintermediate init          ) = 6.304e-04 S  per = 1.33  per(accum) = 5.45
 T(local opt: preprocess_hformulae_Hxlist ) = 1.782e-02 S  per = 37.6  per(accum) = 43.1
 T(local opt: hmmtasks init               ) = 2.942e-03 S  per = 6.21  per(accum) = 49.3
 T(local opt: initial guess for dvdson    ) = 2.171e-04 S  per = 0.458  per(accum) = 49.7
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.182e-02 S  per = 46.1  per(accum) = 95.8
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.973e-04 S  per = 0.416  per(accum) = 96.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 3.080e-07 S  per = 0.00065  per(accum) = 96.2
 T(local opt: dvdson solver [rest part]   ) = 1.802e-03 S  per =  3.8  per(accum) = 100
Detailed decomposition of T(renrm) = 9.947e-03 S  T(sum) = 9.947e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 9.969e-05 S  per =    1  per(accum) = 1
 T(local opt: qops init                    ) = 4.825e-04 S  per = 4.85  per(accum) = 5.85
 T(local opt: symbolic_formulae_renorm     ) = 7.597e-04 S  per = 7.64  per(accum) = 13.5
 T(local opt: allocate qops on gpu         ) = 9.171e-05 S  per = 0.922  per(accum) = 14.4
 T(local opt: site memcpy cpu2gpu          ) = 9.069e-05 S  per = 0.912  per(accum) = 15.3
 T(local opt: rintermediate init           ) = 4.993e-04 S  per = 5.02  per(accum) = 20.3
 T(local opt: preprocess_formulae_Rlist2   ) = 2.904e-03 S  per = 29.2  per(accum) = 49.5
 T(local opt: rmmtasks init                ) = 8.817e-04 S  per = 8.86  per(accum) = 58.4
 T(local opt: qops memset on cpu           ) = 4.700e-08 S  per = 0.000473  per(accum) = 58.4
 T(local opt: preprocess_renorm_batchGPU   ) = 3.026e-03 S  per = 30.4  per(accum) = 88.8
 T(local opt: reduction of opS & opH [nccl]) = 6.730e-07 S  per = 0.00677  per(accum) = 88.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.154e-04 S  per = 1.16  per(accum) = 90
 T(local opt: deallocate cpu and gpu memory) = 1.188e-05 S  per = 0.119  per(accum) = 90.1
 T(local opt: reduction of opS & opH [comm]) = 8.898e-05 S  per = 0.895  per(accum) = 91
 T(local opt: conversion from opAB to opPQ ) = 8.182e-05 S  per = 0.823  per(accum) = 91.8
 T(local opt: after oper_renorm            ) = 8.127e-04 S  per = 8.17  per(accum) = 100
##### sweep opt: 9.730e-01 S #####
 T(sweep opt: fetch) = 7.487e-02 S  per = 7.69  per(accum) = 7.69
 T(sweep opt: hdiag) = 6.831e-02 S  per = 7.02  per(accum) = 14.7
 T(sweep opt: dvdsn) = 6.375e-01 S  per = 65.5  per(accum) = 80.2
 T(sweep opt: decim) = 4.206e-02 S  per = 4.32  per(accum) = 84.6
 T(sweep opt: guess) = 1.675e-03 S  per = 0.172  per(accum) = 84.7
 T(sweep opt: renrm) = 9.698e-02 S  per = 9.97  per(accum) = 94.7
 T(sweep opt: save ) = 5.154e-02 S  per =  5.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.375e-01 S  T(sum) = 6.276e-01 S  per = 9.845e+01
 T(sweep opt: preprocess                  ) = 7.556e-03 S  per =  1.2  per(accum) = 1.2
 T(sweep opt: symbolic_formulae           ) = 1.312e-02 S  per = 2.09  per(accum) = 3.29
 T(sweep opt: hintermediate init          ) = 6.532e-03 S  per = 1.04  per(accum) = 4.33
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.650e-01 S  per = 42.2  per(accum) = 46.6
 T(sweep opt: hmmtasks init               ) = 4.537e-02 S  per = 7.23  per(accum) = 53.8
 T(sweep opt: initial guess for dvdson    ) = 2.784e-03 S  per = 0.444  per(accum) = 54.2
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 2.664e-01 S  per = 42.4  per(accum) = 96.7
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.035e-03 S  per = 0.324  per(accum) = 97
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 3.412e-06 S  per = 0.000544  per(accum) = 97
 T(sweep opt: dvdson solver [rest part]   ) = 1.885e-02 S  per =    3  per(accum) = 100
Detailed decomposition of T(renrm) = 9.698e-02 S  T(sum) = 9.698e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.403e-03 S  per = 1.45  per(accum) = 1.45
 T(sweep opt: qops init                    ) = 5.302e-03 S  per = 5.47  per(accum) = 6.91
 T(sweep opt: symbolic_formulae_renorm     ) = 5.834e-03 S  per = 6.02  per(accum) = 12.9
 T(sweep opt: allocate qops on gpu         ) = 1.066e-03 S  per =  1.1  per(accum) = 14
 T(sweep opt: site memcpy cpu2gpu          ) = 1.001e-03 S  per = 1.03  per(accum) = 15.1
 T(sweep opt: rintermediate init           ) = 5.282e-03 S  per = 5.45  per(accum) = 20.5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.251e-02 S  per = 23.2  per(accum) = 43.7
 T(sweep opt: rmmtasks init                ) = 7.191e-03 S  per = 7.41  per(accum) = 51.1
 T(sweep opt: qops memset on cpu           ) = 5.850e-07 S  per = 0.000603  per(accum) = 51.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.021e-02 S  per = 31.1  per(accum) = 82.3
 T(sweep opt: reduction of opS & opH [nccl]) = 6.399e-06 S  per = 0.0066  per(accum) = 82.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.068e-03 S  per =  1.1  per(accum) = 83.4
 T(sweep opt: deallocate cpu and gpu memory) = 2.520e-04 S  per = 0.26  per(accum) = 83.6
 T(sweep opt: reduction of opS & opH [comm]) = 9.725e-04 S  per =    1  per(accum) = 84.6
 T(sweep opt: conversion from opAB to opPQ ) = 6.778e-03 S  per = 6.99  per(accum) = 91.6
 T(sweep opt: after oper_renorm            ) = 8.110e-03 S  per = 8.36  per(accum) = 100
##### global opt: 9.730e-01 S #####
 T(global opt: fetch) = 7.487e-02 S  per = 7.69  per(accum) = 7.69
 T(global opt: hdiag) = 6.831e-02 S  per = 7.02  per(accum) = 14.7
 T(global opt: dvdsn) = 6.375e-01 S  per = 65.5  per(accum) = 80.2
 T(global opt: decim) = 4.206e-02 S  per = 4.32  per(accum) = 84.6
 T(global opt: guess) = 1.675e-03 S  per = 0.172  per(accum) = 84.7
 T(global opt: renrm) = 9.698e-02 S  per = 9.97  per(accum) = 94.7
 T(global opt: save ) = 5.154e-02 S  per =  5.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.375e-01 S  T(sum) = 6.276e-01 S  per = 9.845e+01
 T(global opt: preprocess                  ) = 7.556e-03 S  per =  1.2  per(accum) = 1.2
 T(global opt: symbolic_formulae           ) = 1.312e-02 S  per = 2.09  per(accum) = 3.29
 T(global opt: hintermediate init          ) = 6.532e-03 S  per = 1.04  per(accum) = 4.33
 T(global opt: preprocess_hformulae_Hxlist ) = 2.650e-01 S  per = 42.2  per(accum) = 46.6
 T(global opt: hmmtasks init               ) = 4.537e-02 S  per = 7.23  per(accum) = 53.8
 T(global opt: initial guess for dvdson    ) = 2.784e-03 S  per = 0.444  per(accum) = 54.2
 T(global opt: dvdson solver [Hx_batchGPU] ) = 2.664e-01 S  per = 42.4  per(accum) = 96.7
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.035e-03 S  per = 0.324  per(accum) = 97
 T(global opt: dvdson solver [comm(cpu)]   ) = 3.412e-06 S  per = 0.000544  per(accum) = 97
 T(global opt: dvdson solver [rest part]   ) = 1.885e-02 S  per =    3  per(accum) = 100
Detailed decomposition of T(renrm) = 9.698e-02 S  T(sum) = 9.698e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.403e-03 S  per = 1.45  per(accum) = 1.45
 T(global opt: qops init                    ) = 5.302e-03 S  per = 5.47  per(accum) = 6.91
 T(global opt: symbolic_formulae_renorm     ) = 5.834e-03 S  per = 6.02  per(accum) = 12.9
 T(global opt: allocate qops on gpu         ) = 1.066e-03 S  per =  1.1  per(accum) = 14
 T(global opt: site memcpy cpu2gpu          ) = 1.001e-03 S  per = 1.03  per(accum) = 15.1
 T(global opt: rintermediate init           ) = 5.282e-03 S  per = 5.45  per(accum) = 20.5
 T(global opt: preprocess_formulae_Rlist2   ) = 2.251e-02 S  per = 23.2  per(accum) = 43.7
 T(global opt: rmmtasks init                ) = 7.191e-03 S  per = 7.41  per(accum) = 51.1
 T(global opt: qops memset on cpu           ) = 5.850e-07 S  per = 0.000603  per(accum) = 51.1
 T(global opt: preprocess_renorm_batchGPU   ) = 3.021e-02 S  per = 31.1  per(accum) = 82.3
 T(global opt: reduction of opS & opH [nccl]) = 6.399e-06 S  per = 0.0066  per(accum) = 82.3
 T(global opt: qops memcpy gpu2cpu          ) = 1.068e-03 S  per =  1.1  per(accum) = 83.4
 T(global opt: deallocate cpu and gpu memory) = 2.520e-04 S  per = 0.26  per(accum) = 83.6
 T(global opt: reduction of opS & opH [comm]) = 9.725e-04 S  per =    1  per(accum) = 84.6
 T(global opt: conversion from opAB to opPQ ) = 6.778e-03 S  per = 6.99  per(accum) = 91.6
 T(global opt: after oper_renorm            ) = 8.110e-03 S  per = 8.36  per(accum) = 100

isweep=0 ibond=11/seqsize=34 dots=2 dbond=(12,0)-(13,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:2.147e+01S Sys:1.139e+00S Total:2.261e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=532:4.059e-03MB:3.964e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=38:2.899e-04MB:2.831e-07GB
total mem of comb=571:4.356e-03MB:4.254e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=12,6,1,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc1= 8
 suppc2= 9
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:12 S:8 H:1 P:64 Q:72 
        dim(bra,ket)=10,10 size(op)=54:4.120e-04MB size(tot)=3602:2.748e-02MB:2.684e-05GB
 rqops: oplist=CSHAB nops=C:6 S:14 H:1 A:36 B:42 
        dim(bra,ket)=4,4 size(op)=8:6.104e-05MB size(tot)=380:2.899e-03MB:2.831e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=5978:4.561e-02MB:4.454e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(12,0) fdel=./scratch/sweep/rop(13,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
wf4(diml,dimr,dimc1,dimc2)=(10,4,3,3) nnz=51:3.891e-04MB
qtensor4: wf4 own=1 _data=0x55a319c09ed0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (18,2):4 (18,4):3 (17,3):2 (19,3):1
 qbond: qcol nsym=3 dimAll=4
 (8,2):1 (8,4):1 (9,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=15 nblocks=192 size=51:3.891e-04MB
### DIAG TIMING: total=4.151e-03 t1=8.835e-06, t2=1.345e-05, t3=2.460e-05, t4=4.078e-03, t5=4.678e-06, t6=1.762e-05, t7=3.762e-06
duration_diagGPU:4.246e-03
duration_diagreduce:4.200e-08
duration_diagtransform:1.600e-07
----- TIMING FOR symbolic_formulae_twodot with size=609 : 1.168e-03 S -----
rank=0 GPUmem(GB): used=4.45e-05 (oper)=4.45e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=609
 no. of hintermediate operators=304
 no. of coefficients=4083:0.0312MB:3.04e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.816e-04 S -----
rank=0 GPUmem(GB): used=7.5e-05 (oper,hinter)=4.45e-05,3.04e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0136 S size(H_formulae)=609 size(Hxlst2)=15 T(Hmu/Hxlist)=0.00022,0.0134 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0139 S size(H_formulae)=609 size(Hxlst)=8592 -----
rank=0 GPUmem(GB): used=0.00168 (oper,hinter,dvdson,batch)=4.45e-05,3.04e-05,7.6e-07,0.0016 blksize=8 blksize0=8 batchsize=8592
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=51 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.09e-05,0.000435,0.002,0.000543,0.00301
 ndim=51:3.8e-07GB t[comm(intra)]=2.36e-05 speed=0.0322GB/S t[comm(inter)]=7.34e-06 speed=0.104GB/S
--- TIMING FOR sigma : t_inter=4.4e-04 t_gemm=2.0e-03 t_reduction=5.4e-04 tot=3.0e-03 ---
 sigma[inter] counter=72 t=4.4e-04 per=1.5e+01 cost=3.9e+05 flops=8.9e+08
 sigma[gemm] counter=72 i=0 t=2.8e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=1 t=2.2e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=2 t=2.3e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=3 t=2.2e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=4 t=4.5e-04 per=1.5e+01 cost=4.7e+04 flops=1.0e+08
 sigma[gemm] counter=72 i=5 t=4.6e-04 per=1.5e+01 cost=4.5e+04 flops=9.9e+07
 sigma[gemm] counter=72 i=6 t=5.3e-04 per=1.8e+01 cost=5.6e+04 flops=1.0e+08
 sigma[gemm] counter=72 i=7 t=5.4e-04 per=1.8e+01 cost=5.2e+04 flops=9.5e+07
 sigma[gemm] counter=72 total t=2.0e-03 per=6.7e+01 cost=2.0e+05 flops=1.0e+08
 sigma[red] counter=72 t=5.4e-04 per=1.8e+01 cost=6.2e+04 flops=1.1e+08
--- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=5.7e-02 t_reduction=5.6e-02 tot=1.2e-01 ---
 sigma_tot[inter] counter=72 t=1.1e-02 per=9.1e+00 cost=7.1e+07 flops=6.3e+09
 sigma_tot[gemm] counter=72 i=0 t=1.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=1 t=1.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=2 t=1.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=3 t=1.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=4 t=1.3e-02 per=1.1e+01 cost=1.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=72 i=5 t=1.6e-02 per=1.2e+01 cost=1.5e+07 flops=9.4e+08
 sigma_tot[gemm] counter=72 i=6 t=1.4e-02 per=1.1e+01 cost=1.3e+07 flops=9.5e+08
 sigma_tot[gemm] counter=72 i=7 t=1.4e-02 per=1.1e+01 cost=1.4e+07 flops=1.0e+09
 sigma_tot[gemm] counter=72 total t=5.7e-02 per=4.6e+01 cost=5.6e+07 flops=9.8e+08
 sigma_tot[red] counter=72 t=5.6e-02 per=4.5e+01 cost=1.3e+07 flops=2.3e+08
T(sub)=8.2e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,3.2e-06,9.8e-07,9.1e-07,2.3e-07
settings: ndim=51 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.284966887172 -1.116e+03  5.064e-02    1     1  5.381e-03 5.381e-03 5.205e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.864e-05,3.856e-04,1.636e-03,5.111e-04,2.567e-03
 ndim=51:3.800e-07GB t[comm(intra)]=2.269e-05 speed=3.349e-02GB/S t[comm(inter)]=5.949e-06 speed=1.277e-01GB/S
--- TIMING FOR sigma : t_inter=3.9e-04 t_gemm=1.6e-03 t_reduction=5.1e-04 tot=2.5e-03 ---
 sigma[inter] counter=73 t=3.9e-04 per=1.5e+01 cost=3.9e+05 flops=1.0e+09
 sigma[gemm] counter=73 i=0 t=2.8e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=1 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=2 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=3 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=4 t=3.7e-04 per=1.5e+01 cost=4.7e+04 flops=1.3e+08
 sigma[gemm] counter=73 i=5 t=3.7e-04 per=1.5e+01 cost=4.5e+04 flops=1.2e+08
 sigma[gemm] counter=73 i=6 t=4.5e-04 per=1.8e+01 cost=5.6e+04 flops=1.3e+08
 sigma[gemm] counter=73 i=7 t=4.4e-04 per=1.7e+01 cost=5.2e+04 flops=1.2e+08
 sigma[gemm] counter=73 total t=1.6e-03 per=6.5e+01 cost=2.0e+05 flops=1.2e+08
 sigma[red] counter=73 t=5.1e-04 per=2.0e+01 cost=6.2e+04 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=5.9e-02 t_reduction=5.6e-02 tot=1.3e-01 ---
 sigma_tot[inter] counter=73 t=1.2e-02 per=9.2e+00 cost=7.1e+07 flops=6.1e+09
 sigma_tot[gemm] counter=73 i=0 t=1.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=1 t=1.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=2 t=1.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=3 t=1.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=4 t=1.4e-02 per=1.1e+01 cost=1.4e+07 flops=1.0e+09
 sigma_tot[gemm] counter=73 i=5 t=1.6e-02 per=1.2e+01 cost=1.5e+07 flops=9.2e+08
 sigma_tot[gemm] counter=73 i=6 t=1.5e-02 per=1.1e+01 cost=1.3e+07 flops=9.3e+08
 sigma_tot[gemm] counter=73 i=7 t=1.4e-02 per=1.1e+01 cost=1.4e+07 flops=1.0e+09
 sigma_tot[gemm] counter=73 total t=5.9e-02 per=4.7e+01 cost=5.7e+07 flops=9.6e+08
 sigma_tot[red] counter=73 t=5.6e-02 per=4.4e+01 cost=1.3e+07 flops=2.3e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.0e-05,2.5e-06,1.0e-06,2.1e-07
    2   0 -    -116.290956146613 -5.989e-03  1.085e-02    2     2  1.054e-02 5.268e-03 4.933e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.916e-05,3.746e-04,1.654e-03,5.051e-04,2.568e-03
 ndim=51:3.800e-07GB t[comm(intra)]=2.307e-05 speed=3.294e-02GB/S t[comm(inter)]=6.088e-06 speed=1.248e-01GB/S
--- TIMING FOR sigma : t_inter=3.7e-04 t_gemm=1.7e-03 t_reduction=5.0e-04 tot=2.5e-03 ---
 sigma[inter] counter=74 t=3.7e-04 per=1.5e+01 cost=3.9e+05 flops=1.0e+09
 sigma[gemm] counter=74 i=0 t=2.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=1 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=2 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=3 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=4 t=3.6e-04 per=1.4e+01 cost=4.7e+04 flops=1.3e+08
 sigma[gemm] counter=74 i=5 t=3.9e-04 per=1.6e+01 cost=4.5e+04 flops=1.1e+08
 sigma[gemm] counter=74 i=6 t=4.5e-04 per=1.8e+01 cost=5.6e+04 flops=1.3e+08
 sigma[gemm] counter=74 i=7 t=4.4e-04 per=1.7e+01 cost=5.2e+04 flops=1.2e+08
 sigma[gemm] counter=74 total t=1.7e-03 per=6.5e+01 cost=2.0e+05 flops=1.2e+08
 sigma[red] counter=74 t=5.0e-04 per=2.0e+01 cost=6.2e+04 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.1e-02 t_reduction=5.7e-02 tot=1.3e-01 ---
 sigma_tot[inter] counter=74 t=1.2e-02 per=9.3e+00 cost=7.1e+07 flops=5.9e+09
 sigma_tot[gemm] counter=74 i=0 t=1.9e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=1 t=1.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=2 t=1.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=3 t=1.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=4 t=1.4e-02 per=1.1e+01 cost=1.4e+07 flops=1.0e+09
 sigma_tot[gemm] counter=74 i=5 t=1.6e-02 per=1.3e+01 cost=1.5e+07 flops=9.0e+08
 sigma_tot[gemm] counter=74 i=6 t=1.5e-02 per=1.2e+01 cost=1.4e+07 flops=9.0e+08
 sigma_tot[gemm] counter=74 i=7 t=1.5e-02 per=1.1e+01 cost=1.4e+07 flops=9.7e+08
 sigma_tot[gemm] counter=74 total t=6.1e-02 per=4.7e+01 cost=5.7e+07 flops=9.4e+08
 sigma_tot[red] counter=74 t=5.7e-02 per=4.4e+01 cost=1.3e+07 flops=2.3e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.3e-05,1.9e-06,1.1e-06,1.8e-07
    3   0 -    -116.291453914930 -4.978e-04  2.000e-03    3     3  1.536e-02 5.121e-03 4.824e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.835e-05,3.635e-04,1.658e-03,5.043e-04,2.560e-03
 ndim=51:3.800e-07GB t[comm(intra)]=2.226e-05 speed=3.414e-02GB/S t[comm(inter)]=6.086e-06 speed=1.249e-01GB/S
--- TIMING FOR sigma : t_inter=3.6e-04 t_gemm=1.7e-03 t_reduction=5.0e-04 tot=2.5e-03 ---
 sigma[inter] counter=75 t=3.6e-04 per=1.4e+01 cost=3.9e+05 flops=1.1e+09
 sigma[gemm] counter=75 i=0 t=2.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=1 t=2.2e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=2 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=3 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=4 t=3.8e-04 per=1.5e+01 cost=4.7e+04 flops=1.2e+08
 sigma[gemm] counter=75 i=5 t=3.7e-04 per=1.5e+01 cost=4.5e+04 flops=1.2e+08
 sigma[gemm] counter=75 i=6 t=4.6e-04 per=1.8e+01 cost=5.6e+04 flops=1.2e+08
 sigma[gemm] counter=75 i=7 t=4.3e-04 per=1.7e+01 cost=5.2e+04 flops=1.2e+08
 sigma[gemm] counter=75 total t=1.7e-03 per=6.6e+01 cost=2.0e+05 flops=1.2e+08
 sigma[red] counter=75 t=5.0e-04 per=2.0e+01 cost=6.2e+04 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=6.2e-02 t_reduction=5.7e-02 tot=1.3e-01 ---
 sigma_tot[inter] counter=75 t=1.2e-02 per=9.4e+00 cost=7.2e+07 flops=5.8e+09
 sigma_tot[gemm] counter=75 i=0 t=2.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=1 t=1.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=2 t=1.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=3 t=1.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=4 t=1.4e-02 per=1.1e+01 cost=1.4e+07 flops=1.0e+09
 sigma_tot[gemm] counter=75 i=5 t=1.7e-02 per=1.3e+01 cost=1.5e+07 flops=8.8e+08
 sigma_tot[gemm] counter=75 i=6 t=1.5e-02 per=1.2e+01 cost=1.4e+07 flops=8.8e+08
 sigma_tot[gemm] counter=75 i=7 t=1.5e-02 per=1.1e+01 cost=1.4e+07 flops=9.5e+08
 sigma_tot[gemm] counter=75 total t=6.2e-02 per=4.7e+01 cost=5.7e+07 flops=9.1e+08
 sigma_tot[red] counter=75 t=5.7e-02 per=4.3e+01 cost=1.3e+07 flops=2.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.3e-05,1.8e-06,9.1e-07,1.8e-07
    4   0 -    -116.291463949187 -1.003e-05  4.314e-04    3     4  2.024e-02 5.059e-03 4.747e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.830e-05,3.608e-04,1.634e-03,5.066e-04,2.534e-03
 ndim=51:3.800e-07GB t[comm(intra)]=2.255e-05 speed=3.371e-02GB/S t[comm(inter)]=5.749e-06 speed=1.322e-01GB/S
--- TIMING FOR sigma : t_inter=3.6e-04 t_gemm=1.6e-03 t_reduction=5.1e-04 tot=2.5e-03 ---
 sigma[inter] counter=76 t=3.6e-04 per=1.4e+01 cost=3.9e+05 flops=1.1e+09
 sigma[gemm] counter=76 i=0 t=2.8e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=1 t=2.2e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=2 t=2.2e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=3 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=4 t=3.7e-04 per=1.5e+01 cost=4.7e+04 flops=1.3e+08
 sigma[gemm] counter=76 i=5 t=3.7e-04 per=1.5e+01 cost=4.5e+04 flops=1.2e+08
 sigma[gemm] counter=76 i=6 t=4.5e-04 per=1.8e+01 cost=5.6e+04 flops=1.3e+08
 sigma[gemm] counter=76 i=7 t=4.4e-04 per=1.7e+01 cost=5.2e+04 flops=1.2e+08
 sigma[gemm] counter=76 total t=1.6e-03 per=6.5e+01 cost=2.0e+05 flops=1.2e+08
 sigma[red] counter=76 t=5.1e-04 per=2.0e+01 cost=6.2e+04 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=6.4e-02 t_reduction=5.8e-02 tot=1.3e-01 ---
 sigma_tot[inter] counter=76 t=1.3e-02 per=9.5e+00 cost=7.2e+07 flops=5.7e+09
 sigma_tot[gemm] counter=76 i=0 t=2.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=1 t=1.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=2 t=1.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=3 t=1.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=4 t=1.5e-02 per=1.1e+01 cost=1.5e+07 flops=9.8e+08
 sigma_tot[gemm] counter=76 i=5 t=1.7e-02 per=1.3e+01 cost=1.5e+07 flops=8.6e+08
 sigma_tot[gemm] counter=76 i=6 t=1.6e-02 per=1.2e+01 cost=1.4e+07 flops=8.6e+08
 sigma_tot[gemm] counter=76 i=7 t=1.6e-02 per=1.2e+01 cost=1.4e+07 flops=9.3e+08
 sigma_tot[gemm] counter=76 total t=6.4e-02 per=4.8e+01 cost=5.7e+07 flops=8.9e+08
 sigma_tot[red] counter=76 t=5.8e-02 per=4.3e+01 cost=1.3e+07 flops=2.3e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.6e-05,1.8e-06,9.8e-07,1.8e-07
    5   0 -    -116.291464608223 -6.590e-07  1.600e-04    3     5  2.500e-02 4.999e-03 4.698e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.776e-05,3.734e-04,1.626e-03,5.026e-04,2.535e-03
 ndim=51:3.800e-07GB t[comm(intra)]=2.187e-05 speed=3.476e-02GB/S t[comm(inter)]=5.892e-06 speed=1.290e-01GB/S
--- TIMING FOR sigma : t_inter=3.7e-04 t_gemm=1.6e-03 t_reduction=5.0e-04 tot=2.5e-03 ---
 sigma[inter] counter=77 t=3.7e-04 per=1.5e+01 cost=3.9e+05 flops=1.0e+09
 sigma[gemm] counter=77 i=0 t=2.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=1 t=2.3e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=2 t=2.2e-06 per=8.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=3 t=2.2e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=4 t=3.6e-04 per=1.5e+01 cost=4.7e+04 flops=1.3e+08
 sigma[gemm] counter=77 i=5 t=3.7e-04 per=1.5e+01 cost=4.5e+04 flops=1.2e+08
 sigma[gemm] counter=77 i=6 t=4.4e-04 per=1.8e+01 cost=5.6e+04 flops=1.3e+08
 sigma[gemm] counter=77 i=7 t=4.4e-04 per=1.8e+01 cost=5.2e+04 flops=1.2e+08
 sigma[gemm] counter=77 total t=1.6e-03 per=6.5e+01 cost=2.0e+05 flops=1.2e+08
 sigma[red] counter=77 t=5.0e-04 per=2.0e+01 cost=6.2e+04 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=6.6e-02 t_reduction=5.8e-02 tot=1.4e-01 ---
 sigma_tot[inter] counter=77 t=1.3e-02 per=9.6e+00 cost=7.3e+07 flops=5.5e+09
 sigma_tot[gemm] counter=77 i=0 t=2.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=1 t=1.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=2 t=1.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=3 t=1.7e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=4 t=1.5e-02 per=1.1e+01 cost=1.5e+07 flops=9.6e+08
 sigma_tot[gemm] counter=77 i=5 t=1.7e-02 per=1.3e+01 cost=1.5e+07 flops=8.5e+08
 sigma_tot[gemm] counter=77 i=6 t=1.6e-02 per=1.2e+01 cost=1.4e+07 flops=8.4e+08
 sigma_tot[gemm] counter=77 i=7 t=1.6e-02 per=1.2e+01 cost=1.4e+07 flops=9.0e+08
 sigma_tot[gemm] counter=77 total t=6.6e-02 per=4.8e+01 cost=5.7e+07 flops=8.8e+08
 sigma_tot[red] counter=77 t=5.8e-02 per=4.2e+01 cost=1.3e+07 flops=2.3e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.3e-05,1.8e-06,9.6e-07,1.5e-07
    6   0 +    -116.291464685952 -7.773e-08  5.642e-05    3     6  2.969e-02 4.948e-03 4.662e-03
TIMING FOR Davidson : 2.976e-02  T(cal/comm/rest)=2.797e-02,2.760e-07,1.792e-03
decomposed t_rest=1.792e-03
 T(sub)    =1.120e-04 per=6.249e+00
 T(precond)=4.381e-04 per=2.445e+01
 T(ortho)  =1.409e-05 per=7.862e-01
 T(xcopy)  =7.600e-07 per=4.242e-02
 T(xnrm2)  =9.710e-07 per=5.419e-02
 T(other)  =1.226e-03 per=6.842e+01
optimized energies: isweep=0 ibond=11 dots=2 e[0]=-116.291464685952 nmvp=6
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:2.293e+01S Sys:1.147e+00S Total:2.408e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond11.txt
 qbond: qsuper nsym=9 dimAll=40
 (18,2):6 (20,2):5 (19,1):4 (19,3):10 (18,4):5 (20,4):4 (19,5):3 (17,3):2 (21,3):1
----- TMING FOR decimation_genbasis(su2): 8.1e-05 S -----
decimation summary: 40->9 dwt=+0.000e+00 SvN=4.139e-01
 qbond: qkept nsym=4 dimAll=9
 (20,2):3 (20,4):3 (19,3):2 (21,3):1
----- TIMING for decimation_row(nkr): 3.253e-03 S T(decim/select/formRot)=3.972e-04,2.660e-03,1.958e-04 -----
----- TIMING FOR twodot_decimation: 3.460e-03 S T(wf/decim)=1.239e-04,3.337e-03 -----
ctns::oper_renorm coord=(12,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:13 S:7 H:1 P:49 Q:56 
        dim(bra,ket)=9,9 size(op)=41:3.128e-04MB size(tot)=2273:1.734e-02MB:1.694e-05GB
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:2.304e+01S Sys:1.147e+00S Total:2.419e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=126 : 5.622e-04 S -----
rank=0 GPUmem(GB): used=8.91e-05 (oper)=5.12e-05
rank=0 GPUmem(GB): used=8.94e-05 (oper,site)(GB)=5.12e-05,3.58e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=126
 no. of rintermediate operators=182
 no. of coefficients=2184:0.0167MB:1.63e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.431e-04 S -----
rank=0 GPUmem(GB): used=0.000106 (oper,site,rinter)=5.12e-05,3.58e-07,1.63e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00213 S size(rtasks)=126 size(Rlst2)=16 T(Rmu/Rlist)=0.000161,0.00197 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00229 S size(rtasks)=126 size(Rlst)=2667 -----
rank=0 GPUmem(GB): used=0.000106 (oper,site,rinter,batch)=5.12e-05,3.58e-07,1.63e-05,0.000656 blksize=12 blksize0=8 batchsize=2667
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000116,0.000971,0.000204
--- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=9.7e-04 t_reduction=2.0e-04 tot=1.3e-03 ---
 renorm[inter] counter=12 t=1.2e-04 per=9.0e+00 cost=1.0e+05 flops=8.8e+08
 renorm[gemm] counter=12 i=0 t=2.8e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=1 t=2.3e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=2 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=3 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=12 i=4 t=3.4e-04 per=2.6e+01 cost=1.7e+04 flops=4.9e+07
 renorm[gemm] counter=12 i=5 t=3.5e-04 per=2.7e+01 cost=3.8e+04 flops=1.1e+08
 renorm[gemm] counter=12 i=6 t=2.7e-04 per=2.1e+01 cost=7.1e+04 flops=2.6e+08
 renorm[gemm] counter=12 total t=9.7e-04 per=7.5e+01 cost=1.3e+05 flops=1.3e+08
 renorm[red] counter=12 t=2.0e-04 per=1.6e+01 cost=3.1e+04 flops=1.5e+08
--- TIMING FOR renorm_tot : t_inter=1.6e-03 t_gemm=7.5e-03 t_reduction=2.7e-03 tot=1.2e-02 ---
 renorm_tot[inter] counter=12 t=1.6e-03 per=1.3e+01 cost=1.2e+06 flops=7.7e+08
 renorm_tot[gemm] counter=12 i=0 t=3.4e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=1 t=2.7e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=2 t=2.6e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=3 t=2.6e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=12 i=4 t=2.5e-03 per=2.1e+01 cost=1.7e+05 flops=6.9e+07
 renorm_tot[gemm] counter=12 i=5 t=2.4e-03 per=2.1e+01 cost=4.6e+05 flops=1.9e+08
 renorm_tot[gemm] counter=12 i=6 t=2.5e-03 per=2.1e+01 cost=8.1e+05 flops=3.2e+08
 renorm_tot[gemm] counter=12 total t=7.5e-03 per=6.4e+01 cost=1.4e+06 flops=1.9e+08
 renorm_tot[red] counter=12 t=2.7e-03 per=2.3e+01 cost=3.4e+05 flops=1.3e+08
qops.to_cpu: size(tot)=2273:1.7e-02MB:1.7e-05GB t[to_cpu]=1.9e-05S speed=9.1e-01GB/S
check ||H-H.dagger||=2.260e-14 coord=(12,0) rank=0
ctns::oper_ab2pq coord=(12,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00822 S rank=0 -----
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:2.325e+01S Sys:1.150e+00S Total:2.440e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=552:4.211e-03MB:4.113e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=26:1.984e-04MB:1.937e-07GB
total mem of comb=579:4.417e-03MB:4.314e-06GB
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:2.325e+01S Sys:1.150e+00S Total:2.440e+01S
##### local opt: 7.828e-02 S #####
 T(local opt: fetch) = 5.945e-03 S  per = 7.59  per(accum) = 7.59
 T(local opt: hdiag) = 5.243e-03 S  per =  6.7  per(accum) = 14.3
 T(local opt: dvdsn) = 4.963e-02 S  per = 63.4  per(accum) = 77.7
 T(local opt: decim) = 3.544e-03 S  per = 4.53  per(accum) = 82.2
 T(local opt: guess) = 6.706e-05 S  per = 0.0857  per(accum) = 82.3
 T(local opt: renrm) = 9.176e-03 S  per = 11.7  per(accum) = 94
 T(local opt: save ) = 4.677e-03 S  per = 5.97  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.963e-02 S  T(sum) = 4.864e-02 S  per = 9.799e+01
 T(local opt: preprocess                  ) = 4.988e-04 S  per = 1.03  per(accum) = 1.03
 T(local opt: symbolic_formulae           ) = 1.270e-03 S  per = 2.61  per(accum) = 3.64
 T(local opt: hintermediate init          ) = 6.379e-04 S  per = 1.31  per(accum) = 4.95
 T(local opt: preprocess_hformulae_Hxlist ) = 1.405e-02 S  per = 28.9  per(accum) = 33.8
 T(local opt: hmmtasks init               ) = 2.217e-03 S  per = 4.56  per(accum) = 38.4
 T(local opt: initial guess for dvdson    ) = 1.999e-04 S  per = 0.411  per(accum) = 38.8
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.780e-02 S  per = 57.2  per(accum) = 96
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.732e-04 S  per = 0.356  per(accum) = 96.3
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.760e-07 S  per = 0.000567  per(accum) = 96.3
 T(local opt: dvdson solver [rest part]   ) = 1.792e-03 S  per = 3.68  per(accum) = 100
Detailed decomposition of T(renrm) = 9.176e-03 S  T(sum) = 9.176e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.112e-04 S  per = 1.21  per(accum) = 1.21
 T(local opt: qops init                    ) = 4.577e-04 S  per = 4.99  per(accum) = 6.2
 T(local opt: symbolic_formulae_renorm     ) = 6.552e-04 S  per = 7.14  per(accum) = 13.3
 T(local opt: allocate qops on gpu         ) = 1.003e-04 S  per = 1.09  per(accum) = 14.4
 T(local opt: site memcpy cpu2gpu          ) = 9.473e-05 S  per = 1.03  per(accum) = 15.5
 T(local opt: rintermediate init           ) = 5.055e-04 S  per = 5.51  per(accum) = 21
 T(local opt: preprocess_formulae_Rlist2   ) = 2.371e-03 S  per = 25.8  per(accum) = 46.8
 T(local opt: rmmtasks init                ) = 7.460e-04 S  per = 8.13  per(accum) = 54.9
 T(local opt: qops memset on cpu           ) = 4.400e-08 S  per = 0.00048  per(accum) = 54.9
 T(local opt: preprocess_renorm_batchGPU   ) = 3.086e-03 S  per = 33.6  per(accum) = 88.6
 T(local opt: reduction of opS & opH [nccl]) = 6.110e-07 S  per = 0.00666  per(accum) = 88.6
 T(local opt: qops memcpy gpu2cpu          ) = 1.075e-04 S  per = 1.17  per(accum) = 89.8
 T(local opt: deallocate cpu and gpu memory) = 9.526e-06 S  per = 0.104  per(accum) = 89.9
 T(local opt: reduction of opS & opH [comm]) = 8.196e-05 S  per = 0.893  per(accum) = 90.7
 T(local opt: conversion from opAB to opPQ ) = 8.080e-05 S  per = 0.881  per(accum) = 91.6
 T(local opt: after oper_renorm            ) = 7.682e-04 S  per = 8.37  per(accum) = 100
##### sweep opt: 1.051e+00 S #####
 T(sweep opt: fetch) = 8.081e-02 S  per = 7.69  per(accum) = 7.69
 T(sweep opt: hdiag) = 7.356e-02 S  per =    7  per(accum) = 14.7
 T(sweep opt: dvdsn) = 6.872e-01 S  per = 65.4  per(accum) = 80
 T(sweep opt: decim) = 4.561e-02 S  per = 4.34  per(accum) = 84.4
 T(sweep opt: guess) = 1.742e-03 S  per = 0.166  per(accum) = 84.6
 T(sweep opt: renrm) = 1.062e-01 S  per = 10.1  per(accum) = 94.7
 T(sweep opt: save ) = 5.622e-02 S  per = 5.35  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.872e-01 S  T(sum) = 6.763e-01 S  per = 9.841e+01
 T(sweep opt: preprocess                  ) = 8.055e-03 S  per = 1.19  per(accum) = 1.19
 T(sweep opt: symbolic_formulae           ) = 1.439e-02 S  per = 2.13  per(accum) = 3.32
 T(sweep opt: hintermediate init          ) = 7.170e-03 S  per = 1.06  per(accum) = 4.38
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.790e-01 S  per = 41.3  per(accum) = 45.6
 T(sweep opt: hmmtasks init               ) = 4.759e-02 S  per = 7.04  per(accum) = 52.7
 T(sweep opt: initial guess for dvdson    ) = 2.984e-03 S  per = 0.441  per(accum) = 53.1
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 2.942e-01 S  per = 43.5  per(accum) = 96.6
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.208e-03 S  per = 0.326  per(accum) = 96.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 3.688e-06 S  per = 0.000545  per(accum) = 96.9
 T(sweep opt: dvdson solver [rest part]   ) = 2.064e-02 S  per = 3.05  per(accum) = 100
Detailed decomposition of T(renrm) = 1.062e-01 S  T(sum) = 1.062e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.514e-03 S  per = 1.43  per(accum) = 1.43
 T(sweep opt: qops init                    ) = 5.760e-03 S  per = 5.43  per(accum) = 6.85
 T(sweep opt: symbolic_formulae_renorm     ) = 6.490e-03 S  per = 6.11  per(accum) = 13
 T(sweep opt: allocate qops on gpu         ) = 1.167e-03 S  per =  1.1  per(accum) = 14.1
 T(sweep opt: site memcpy cpu2gpu          ) = 1.096e-03 S  per = 1.03  per(accum) = 15.1
 T(sweep opt: rintermediate init           ) = 5.787e-03 S  per = 5.45  per(accum) = 20.5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.488e-02 S  per = 23.4  per(accum) = 44
 T(sweep opt: rmmtasks init                ) = 7.937e-03 S  per = 7.48  per(accum) = 51.5
 T(sweep opt: qops memset on cpu           ) = 6.290e-07 S  per = 0.000593  per(accum) = 51.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.329e-02 S  per = 31.4  per(accum) = 82.8
 T(sweep opt: reduction of opS & opH [nccl]) = 7.010e-06 S  per = 0.0066  per(accum) = 82.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.175e-03 S  per = 1.11  per(accum) = 83.9
 T(sweep opt: deallocate cpu and gpu memory) = 2.615e-04 S  per = 0.246  per(accum) = 84.2
 T(sweep opt: reduction of opS & opH [comm]) = 1.054e-03 S  per = 0.993  per(accum) = 85.2
 T(sweep opt: conversion from opAB to opPQ ) = 6.859e-03 S  per = 6.46  per(accum) = 91.6
 T(sweep opt: after oper_renorm            ) = 8.878e-03 S  per = 8.36  per(accum) = 100
##### global opt: 1.051e+00 S #####
 T(global opt: fetch) = 8.081e-02 S  per = 7.69  per(accum) = 7.69
 T(global opt: hdiag) = 7.356e-02 S  per =    7  per(accum) = 14.7
 T(global opt: dvdsn) = 6.872e-01 S  per = 65.4  per(accum) = 80
 T(global opt: decim) = 4.561e-02 S  per = 4.34  per(accum) = 84.4
 T(global opt: guess) = 1.742e-03 S  per = 0.166  per(accum) = 84.6
 T(global opt: renrm) = 1.062e-01 S  per = 10.1  per(accum) = 94.7
 T(global opt: save ) = 5.622e-02 S  per = 5.35  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.872e-01 S  T(sum) = 6.763e-01 S  per = 9.841e+01
 T(global opt: preprocess                  ) = 8.055e-03 S  per = 1.19  per(accum) = 1.19
 T(global opt: symbolic_formulae           ) = 1.439e-02 S  per = 2.13  per(accum) = 3.32
 T(global opt: hintermediate init          ) = 7.170e-03 S  per = 1.06  per(accum) = 4.38
 T(global opt: preprocess_hformulae_Hxlist ) = 2.790e-01 S  per = 41.3  per(accum) = 45.6
 T(global opt: hmmtasks init               ) = 4.759e-02 S  per = 7.04  per(accum) = 52.7
 T(global opt: initial guess for dvdson    ) = 2.984e-03 S  per = 0.441  per(accum) = 53.1
 T(global opt: dvdson solver [Hx_batchGPU] ) = 2.942e-01 S  per = 43.5  per(accum) = 96.6
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.208e-03 S  per = 0.326  per(accum) = 96.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 3.688e-06 S  per = 0.000545  per(accum) = 96.9
 T(global opt: dvdson solver [rest part]   ) = 2.064e-02 S  per = 3.05  per(accum) = 100
Detailed decomposition of T(renrm) = 1.062e-01 S  T(sum) = 1.062e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.514e-03 S  per = 1.43  per(accum) = 1.43
 T(global opt: qops init                    ) = 5.760e-03 S  per = 5.43  per(accum) = 6.85
 T(global opt: symbolic_formulae_renorm     ) = 6.490e-03 S  per = 6.11  per(accum) = 13
 T(global opt: allocate qops on gpu         ) = 1.167e-03 S  per =  1.1  per(accum) = 14.1
 T(global opt: site memcpy cpu2gpu          ) = 1.096e-03 S  per = 1.03  per(accum) = 15.1
 T(global opt: rintermediate init           ) = 5.787e-03 S  per = 5.45  per(accum) = 20.5
 T(global opt: preprocess_formulae_Rlist2   ) = 2.488e-02 S  per = 23.4  per(accum) = 44
 T(global opt: rmmtasks init                ) = 7.937e-03 S  per = 7.48  per(accum) = 51.5
 T(global opt: qops memset on cpu           ) = 6.290e-07 S  per = 0.000593  per(accum) = 51.5
 T(global opt: preprocess_renorm_batchGPU   ) = 3.329e-02 S  per = 31.4  per(accum) = 82.8
 T(global opt: reduction of opS & opH [nccl]) = 7.010e-06 S  per = 0.0066  per(accum) = 82.8
 T(global opt: qops memcpy gpu2cpu          ) = 1.175e-03 S  per = 1.11  per(accum) = 83.9
 T(global opt: deallocate cpu and gpu memory) = 2.615e-04 S  per = 0.246  per(accum) = 84.2
 T(global opt: reduction of opS & opH [comm]) = 1.054e-03 S  per = 0.993  per(accum) = 85.2
 T(global opt: conversion from opAB to opPQ ) = 6.859e-03 S  per = 6.46  per(accum) = 91.6
 T(global opt: after oper_renorm            ) = 8.878e-03 S  per = 8.36  per(accum) = 100

isweep=0 ibond=12/seqsize=34 dots=2 dbond=(13,0)-(14,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:2.325e+01S Sys:1.150e+00S Total:2.440e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=552:4.211e-03MB:4.113e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=26:1.984e-04MB:1.937e-07GB
total mem of comb=579:4.417e-03MB:4.314e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=13,5,1,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 11 12 13 14 15
 suppc1= 9
 suppc2= 10
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:13 S:7 H:1 P:49 Q:56 
        dim(bra,ket)=9,9 size(op)=41:3.128e-04MB size(tot)=2273:1.734e-02MB:1.694e-05GB
 rqops: oplist=CSHAB nops=C:5 S:15 H:1 A:25 B:30 
        dim(bra,ket)=2,2 size(op)=4:3.052e-05MB size(tot)=124:9.460e-04MB:9.239e-07GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=4393:3.352e-02MB:3.273e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(13,0) fdel=./scratch/sweep/rop(14,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
wf4(diml,dimr,dimc1,dimc2)=(9,2,3,3) nnz=36:2.747e-04MB
qtensor4: wf4 own=1 _data=0x55a322903860
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=9
 (20,2):3 (20,4):3 (19,3):2 (21,3):1
 qbond: qcol nsym=1 dimAll=2
 (7,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=9 nblocks=64 size=36:2.747e-04MB
### DIAG TIMING: total=2.472e-03 t1=9.263e-06, t2=1.067e-05, t3=1.619e-05, t4=2.411e-03, t5=4.225e-06, t6=1.725e-05, t7=3.819e-06
duration_diagGPU:2.565e-03
duration_diagreduce:2.900e-08
duration_diagtransform:1.540e-07
----- TIMING FOR symbolic_formulae_twodot with size=516 : 9.139e-04 S -----
rank=0 GPUmem(GB): used=3.27e-05 (oper)=3.27e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=516
 no. of hintermediate operators=269
 no. of coefficients=3269:0.0249MB:2.44e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.616e-04 S -----
rank=0 GPUmem(GB): used=5.71e-05 (oper,hinter)=3.27e-05,2.44e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00573 S size(H_formulae)=516 size(Hxlst2)=9 T(Hmu/Hxlist)=0.000183,0.00554 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00589 S size(H_formulae)=516 size(Hxlst)=3588 -----
rank=0 GPUmem(GB): used=0.000566 (oper,hinter,dvdson,batch)=3.27e-05,2.44e-05,5.36e-07,0.000508 blksize=6 blksize0=6 batchsize=3588
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=36 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.2e-05,0.000106,0.000488,0.000354,0.000987
 ndim=36:2.68e-07GB t[comm(intra)]=2.5e-05 speed=0.0214GB/S t[comm(inter)]=6.95e-06 speed=0.0772GB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=4.9e-04 t_reduction=3.5e-04 tot=9.5e-04 ---
 sigma[inter] counter=78 t=1.1e-04 per=1.1e+01 cost=2.0e+05 flops=1.9e+09
 sigma[gemm] counter=78 i=0 t=2.7e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=1 t=2.2e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=2 t=2.2e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=3 t=2.2e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=4 t=8.8e-05 per=9.3e+00 cost=2.4e+04 flops=2.8e+08
 sigma[gemm] counter=78 i=5 t=1.2e-04 per=1.3e+01 cost=2.4e+04 flops=2.0e+08
 sigma[gemm] counter=78 i=6 t=1.3e-04 per=1.4e+01 cost=2.5e+04 flops=1.9e+08
 sigma[gemm] counter=78 i=7 t=1.3e-04 per=1.4e+01 cost=2.5e+04 flops=1.9e+08
 sigma[gemm] counter=78 total t=4.9e-04 per=5.1e+01 cost=9.9e+04 flops=2.0e+08
 sigma[red] counter=78 t=3.5e-04 per=3.7e+01 cost=3.0e+04 flops=8.4e+07
--- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=6.6e-02 t_reduction=5.9e-02 tot=1.4e-01 ---
 sigma_tot[inter] counter=78 t=1.3e-02 per=9.6e+00 cost=7.3e+07 flops=5.5e+09
 sigma_tot[gemm] counter=78 i=0 t=2.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=1 t=1.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=2 t=1.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=3 t=1.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=4 t=1.5e-02 per=1.1e+01 cost=1.5e+07 flops=9.5e+08
 sigma_tot[gemm] counter=78 i=5 t=1.7e-02 per=1.3e+01 cost=1.5e+07 flops=8.4e+08
 sigma_tot[gemm] counter=78 i=6 t=1.6e-02 per=1.2e+01 cost=1.4e+07 flops=8.3e+08
 sigma_tot[gemm] counter=78 i=7 t=1.6e-02 per=1.2e+01 cost=1.5e+07 flops=9.0e+08
 sigma_tot[gemm] counter=78 total t=6.6e-02 per=4.8e+01 cost=5.8e+07 flops=8.7e+08
 sigma_tot[red] counter=78 t=5.9e-02 per=4.2e+01 cost=1.3e+07 flops=2.3e+08
T(sub)=7.7e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,3.0e-06,9.4e-07,8.1e-07,2.0e-07
settings: ndim=36 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.291464685952 -1.116e+03  5.531e-02    1     1  3.208e-03 3.208e-03 3.040e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.834e-05,8.193e-05,3.689e-04,3.448e-04,8.284e-04
 ndim=36:2.682e-07GB t[comm(intra)]=2.309e-05 speed=2.323e-02GB/S t[comm(inter)]=5.251e-06 speed=1.022e-01GB/S
--- TIMING FOR sigma : t_inter=8.2e-05 t_gemm=3.7e-04 t_reduction=3.4e-04 tot=8.0e-04 ---
 sigma[inter] counter=79 t=8.2e-05 per=1.0e+01 cost=2.0e+05 flops=2.5e+09
 sigma[gemm] counter=79 i=0 t=2.4e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=1 t=2.2e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=2 t=2.2e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=3 t=2.2e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=4 t=7.0e-05 per=8.8e+00 cost=2.4e+04 flops=3.5e+08
 sigma[gemm] counter=79 i=5 t=9.9e-05 per=1.2e+01 cost=2.4e+04 flops=2.5e+08
 sigma[gemm] counter=79 i=6 t=9.6e-05 per=1.2e+01 cost=2.5e+04 flops=2.6e+08
 sigma[gemm] counter=79 i=7 t=9.5e-05 per=1.2e+01 cost=2.5e+04 flops=2.6e+08
 sigma[gemm] counter=79 total t=3.7e-04 per=4.6e+01 cost=9.9e+04 flops=2.7e+08
 sigma[red] counter=79 t=3.4e-04 per=4.3e+01 cost=3.0e+04 flops=8.7e+07
--- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=6.7e-02 t_reduction=5.9e-02 tot=1.4e-01 ---
 sigma_tot[inter] counter=79 t=1.3e-02 per=9.6e+00 cost=7.3e+07 flops=5.5e+09
 sigma_tot[gemm] counter=79 i=0 t=2.1e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=1 t=1.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=2 t=1.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=3 t=1.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=4 t=1.5e-02 per=1.1e+01 cost=1.5e+07 flops=9.5e+08
 sigma_tot[gemm] counter=79 i=5 t=1.8e-02 per=1.3e+01 cost=1.5e+07 flops=8.4e+08
 sigma_tot[gemm] counter=79 i=6 t=1.7e-02 per=1.2e+01 cost=1.4e+07 flops=8.3e+08
 sigma_tot[gemm] counter=79 i=7 t=1.6e-02 per=1.2e+01 cost=1.5e+07 flops=8.9e+08
 sigma_tot[gemm] counter=79 total t=6.7e-02 per=4.8e+01 cost=5.8e+07 flops=8.7e+08
 sigma_tot[red] counter=79 t=5.9e-02 per=4.2e+01 cost=1.3e+07 flops=2.3e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,9.5e-06,2.3e-06,9.2e-07,1.9e-07
    2   0 -    -116.298300665264 -6.836e-03  1.037e-02    2     2  6.513e-03 3.256e-03 2.919e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.777e-05,7.695e-05,3.648e-04,3.321e-04,8.063e-04
 ndim=36:2.682e-07GB t[comm(intra)]=2.293e-05 speed=2.340e-02GB/S t[comm(inter)]=4.848e-06 speed=1.107e-01GB/S
--- TIMING FOR sigma : t_inter=7.7e-05 t_gemm=3.6e-04 t_reduction=3.3e-04 tot=7.7e-04 ---
 sigma[inter] counter=80 t=7.7e-05 per=9.9e+00 cost=2.0e+05 flops=2.6e+09
 sigma[gemm] counter=80 i=0 t=2.3e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=1 t=2.2e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=2 t=2.2e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=3 t=2.2e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=4 t=6.8e-05 per=8.9e+00 cost=2.4e+04 flops=3.6e+08
 sigma[gemm] counter=80 i=5 t=9.9e-05 per=1.3e+01 cost=2.4e+04 flops=2.5e+08
 sigma[gemm] counter=80 i=6 t=9.6e-05 per=1.2e+01 cost=2.5e+04 flops=2.6e+08
 sigma[gemm] counter=80 i=7 t=9.2e-05 per=1.2e+01 cost=2.5e+04 flops=2.7e+08
 sigma[gemm] counter=80 total t=3.6e-04 per=4.7e+01 cost=9.9e+04 flops=2.7e+08
 sigma[red] counter=80 t=3.3e-04 per=4.3e+01 cost=3.0e+04 flops=9.0e+07
--- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=6.7e-02 t_reduction=5.9e-02 tot=1.4e-01 ---
 sigma_tot[inter] counter=80 t=1.3e-02 per=9.6e+00 cost=7.3e+07 flops=5.5e+09
 sigma_tot[gemm] counter=80 i=0 t=2.1e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=1 t=1.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=2 t=1.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=3 t=1.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=4 t=1.5e-02 per=1.1e+01 cost=1.5e+07 flops=9.5e+08
 sigma_tot[gemm] counter=80 i=5 t=1.8e-02 per=1.3e+01 cost=1.5e+07 flops=8.4e+08
 sigma_tot[gemm] counter=80 i=6 t=1.7e-02 per=1.2e+01 cost=1.4e+07 flops=8.3e+08
 sigma_tot[gemm] counter=80 i=7 t=1.6e-02 per=1.2e+01 cost=1.5e+07 flops=8.9e+08
 sigma_tot[gemm] counter=80 total t=6.7e-02 per=4.8e+01 cost=5.8e+07 flops=8.6e+08
 sigma_tot[red] counter=80 t=5.9e-02 per=4.2e+01 cost=1.3e+07 flops=2.2e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.2e-05,1.8e-06,9.1e-07,1.6e-07
    3   0 -    -116.298781495821 -4.808e-04  3.350e-03    3     3  9.477e-03 3.159e-03 2.871e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.722e-05,7.582e-05,3.651e-04,3.305e-04,8.026e-04
 ndim=36:2.682e-07GB t[comm(intra)]=2.224e-05 speed=2.412e-02GB/S t[comm(inter)]=4.981e-06 speed=1.077e-01GB/S
--- TIMING FOR sigma : t_inter=7.6e-05 t_gemm=3.6e-04 t_reduction=3.3e-04 tot=7.7e-04 ---
 sigma[inter] counter=81 t=7.6e-05 per=9.8e+00 cost=2.0e+05 flops=2.7e+09
 sigma[gemm] counter=81 i=0 t=2.3e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=1 t=2.2e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=2 t=2.2e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=3 t=2.2e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=4 t=6.7e-05 per=8.7e+00 cost=2.4e+04 flops=3.6e+08
 sigma[gemm] counter=81 i=5 t=9.9e-05 per=1.3e+01 cost=2.4e+04 flops=2.5e+08
 sigma[gemm] counter=81 i=6 t=9.8e-05 per=1.3e+01 cost=2.5e+04 flops=2.5e+08
 sigma[gemm] counter=81 i=7 t=9.2e-05 per=1.2e+01 cost=2.5e+04 flops=2.7e+08
 sigma[gemm] counter=81 total t=3.6e-04 per=4.7e+01 cost=9.9e+04 flops=2.7e+08
 sigma[red] counter=81 t=3.3e-04 per=4.3e+01 cost=3.0e+04 flops=9.0e+07
--- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=6.7e-02 t_reduction=6.0e-02 tot=1.4e-01 ---
 sigma_tot[inter] counter=81 t=1.3e-02 per=9.6e+00 cost=7.3e+07 flops=5.4e+09
 sigma_tot[gemm] counter=81 i=0 t=2.1e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=1 t=1.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=2 t=1.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=3 t=1.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=4 t=1.6e-02 per=1.1e+01 cost=1.5e+07 flops=9.5e+08
 sigma_tot[gemm] counter=81 i=5 t=1.8e-02 per=1.3e+01 cost=1.5e+07 flops=8.3e+08
 sigma_tot[gemm] counter=81 i=6 t=1.7e-02 per=1.2e+01 cost=1.4e+07 flops=8.2e+08
 sigma_tot[gemm] counter=81 i=7 t=1.6e-02 per=1.2e+01 cost=1.5e+07 flops=8.9e+08
 sigma_tot[gemm] counter=81 total t=6.7e-02 per=4.8e+01 cost=5.8e+07 flops=8.6e+08
 sigma_tot[red] counter=81 t=6.0e-02 per=4.2e+01 cost=1.3e+07 flops=2.2e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.1e-05,1.8e-06,8.0e-07,1.2e-07
    4   0 -    -116.298816092521 -3.460e-05  1.166e-03    3     4  1.246e-02 3.115e-03 2.854e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.761e-05,7.996e-05,3.682e-04,3.394e-04,8.194e-04
 ndim=36:2.682e-07GB t[comm(intra)]=2.252e-05 speed=2.383e-02GB/S t[comm(inter)]=5.098e-06 speed=1.052e-01GB/S
--- TIMING FOR sigma : t_inter=8.0e-05 t_gemm=3.7e-04 t_reduction=3.4e-04 tot=7.9e-04 ---
 sigma[inter] counter=82 t=8.0e-05 per=1.0e+01 cost=2.0e+05 flops=2.5e+09
 sigma[gemm] counter=82 i=0 t=2.4e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=1 t=2.3e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=2 t=2.3e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=3 t=2.3e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=4 t=6.9e-05 per=8.7e+00 cost=2.4e+04 flops=3.5e+08
 sigma[gemm] counter=82 i=5 t=9.6e-05 per=1.2e+01 cost=2.4e+04 flops=2.5e+08
 sigma[gemm] counter=82 i=6 t=9.9e-05 per=1.3e+01 cost=2.5e+04 flops=2.5e+08
 sigma[gemm] counter=82 i=7 t=9.5e-05 per=1.2e+01 cost=2.5e+04 flops=2.6e+08
 sigma[gemm] counter=82 total t=3.7e-04 per=4.7e+01 cost=9.9e+04 flops=2.7e+08
 sigma[red] counter=82 t=3.4e-04 per=4.3e+01 cost=3.0e+04 flops=8.8e+07
--- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=6.8e-02 t_reduction=6.0e-02 tot=1.4e-01 ---
 sigma_tot[inter] counter=82 t=1.4e-02 per=9.6e+00 cost=7.4e+07 flops=5.4e+09
 sigma_tot[gemm] counter=82 i=0 t=2.1e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=1 t=1.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=2 t=1.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=3 t=1.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=4 t=1.6e-02 per=1.1e+01 cost=1.5e+07 flops=9.4e+08
 sigma_tot[gemm] counter=82 i=5 t=1.8e-02 per=1.3e+01 cost=1.5e+07 flops=8.3e+08
 sigma_tot[gemm] counter=82 i=6 t=1.7e-02 per=1.2e+01 cost=1.4e+07 flops=8.2e+08
 sigma_tot[gemm] counter=82 i=7 t=1.7e-02 per=1.2e+01 cost=1.5e+07 flops=8.8e+08
 sigma_tot[gemm] counter=82 total t=6.8e-02 per=4.8e+01 cost=5.8e+07 flops=8.6e+08
 sigma_tot[red] counter=82 t=6.0e-02 per=4.2e+01 cost=1.3e+07 flops=2.2e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.1e-06,1.0e-05,1.7e-06,7.9e-07,1.4e-07
    5   0 -    -116.298821082598 -4.990e-06  3.193e-04    3     5  1.539e-02 3.079e-03 2.835e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.701e-05,7.828e-05,3.686e-04,3.394e-04,8.170e-04
 ndim=36:2.682e-07GB t[comm(intra)]=2.224e-05 speed=2.412e-02GB/S t[comm(inter)]=4.771e-06 speed=1.124e-01GB/S
--- TIMING FOR sigma : t_inter=7.8e-05 t_gemm=3.7e-04 t_reduction=3.4e-04 tot=7.9e-04 ---
 sigma[inter] counter=83 t=7.8e-05 per=1.0e+01 cost=2.0e+05 flops=2.6e+09
 sigma[gemm] counter=83 i=0 t=2.3e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=1 t=2.2e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=2 t=2.2e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=3 t=2.2e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=4 t=6.5e-05 per=8.3e+00 cost=2.4e+04 flops=3.8e+08
 sigma[gemm] counter=83 i=5 t=9.9e-05 per=1.3e+01 cost=2.4e+04 flops=2.5e+08
 sigma[gemm] counter=83 i=6 t=1.0e-04 per=1.3e+01 cost=2.5e+04 flops=2.5e+08
 sigma[gemm] counter=83 i=7 t=9.6e-05 per=1.2e+01 cost=2.5e+04 flops=2.6e+08
 sigma[gemm] counter=83 total t=3.7e-04 per=4.7e+01 cost=9.9e+04 flops=2.7e+08
 sigma[red] counter=83 t=3.4e-04 per=4.3e+01 cost=3.0e+04 flops=8.8e+07
--- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=6.8e-02 t_reduction=6.0e-02 tot=1.4e-01 ---
 sigma_tot[inter] counter=83 t=1.4e-02 per=9.6e+00 cost=7.4e+07 flops=5.4e+09
 sigma_tot[gemm] counter=83 i=0 t=2.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=1 t=1.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=2 t=1.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=3 t=1.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=4 t=1.6e-02 per=1.1e+01 cost=1.5e+07 flops=9.4e+08
 sigma_tot[gemm] counter=83 i=5 t=1.8e-02 per=1.3e+01 cost=1.5e+07 flops=8.3e+08
 sigma_tot[gemm] counter=83 i=6 t=1.7e-02 per=1.2e+01 cost=1.4e+07 flops=8.2e+08
 sigma_tot[gemm] counter=83 i=7 t=1.7e-02 per=1.2e+01 cost=1.5e+07 flops=8.8e+08
 sigma_tot[gemm] counter=83 total t=6.8e-02 per=4.8e+01 cost=5.8e+07 flops=8.5e+08
 sigma_tot[red] counter=83 t=6.0e-02 per=4.2e+01 cost=1.3e+07 flops=2.2e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,1.0e-05,1.6e-06,8.7e-07,1.3e-07
    6   0 +    -116.298821391660 -3.091e-07  6.914e-05    3     6  1.833e-02 3.055e-03 2.823e-03
TIMING FOR Davidson : 1.841e-02  T(cal/comm/rest)=1.694e-02,2.150e-07,1.470e-03
decomposed t_rest=1.470e-03
 T(sub)    =9.227e-05 per=6.276e+00
 T(precond)=1.496e-04 per=1.017e+01
 T(ortho)  =8.540e-06 per=5.808e-01
 T(xcopy)  =7.390e-07 per=5.026e-02
 T(xnrm2)  =8.460e-07 per=5.754e-02
 T(other)  =1.218e-03 per=8.286e+01
optimized energies: isweep=0 ibond=12 dots=2 e[0]=-116.298821391660 nmvp=6
CPUmem: VM:7.250e+01GB RSS:5.787e-01GB  Timing: User:2.407e+01S Sys:1.150e+00S Total:2.522e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond12.txt
 qbond: qsuper nsym=9 dimAll=36
 (20,2):5 (22,2):4 (21,1):3 (21,3):9 (20,4):5 (22,4):4 (21,5):3 (19,3):2 (23,3):1
----- TMING FOR decimation_genbasis(su2): 8.0e-05 S -----
decimation summary: 36->7 dwt=+1.110e-16 SvN=3.298e-01
 qbond: qkept nsym=4 dimAll=7
 (22,2):2 (21,3):2 (22,4):2 (23,3):1
----- TIMING for decimation_row(nkr): 2.954e-03 S T(decim/select/formRot)=3.766e-04,2.420e-03,1.574e-04 -----
----- TIMING FOR twodot_decimation: 3.133e-03 S T(wf/decim)=1.026e-04,3.030e-03 -----
ctns::oper_renorm coord=(13,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:14 S:6 H:1 P:36 Q:42 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=1039:7.927e-03MB:7.741e-06GB
CPUmem: VM:7.269e+01GB RSS:5.787e-01GB  Timing: User:2.433e+01S Sys:1.150e+00S Total:2.548e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=99 : 4.527e-04 S -----
rank=0 GPUmem(GB): used=6.39e-05 (oper)=3.21e-05
rank=0 GPUmem(GB): used=6.42e-05 (oper,site)(GB)=3.21e-05,2.61e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=99
 no. of rintermediate operators=138
 no. of coefficients=1794:0.0137MB:1.34e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.247e-04 S -----
rank=0 GPUmem(GB): used=7.75e-05 (oper,site,rinter)=3.21e-05,2.61e-07,1.34e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00171 S size(rtasks)=99 size(Rlst2)=16 T(Rmu/Rlist)=0.000118,0.0016 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00185 S size(rtasks)=99 size(Rlst)=2133 -----
rank=0 GPUmem(GB): used=7.75e-05 (oper,site,rinter,batch)=3.21e-05,2.61e-07,1.34e-05,0.000302 blksize=6 blksize0=6 batchsize=2133
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.85e-05,0.000427,0.000203
--- TIMING FOR renorm : t_inter=9.8e-05 t_gemm=4.3e-04 t_reduction=2.0e-04 tot=7.3e-04 ---
 renorm[inter] counter=13 t=9.8e-05 per=1.4e+01 cost=7.2e+04 flops=7.3e+08
 renorm[gemm] counter=13 i=0 t=2.8e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=1 t=2.3e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=2 t=2.2e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=3 t=2.2e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=13 i=4 t=1.4e-04 per=1.9e+01 cost=9.2e+03 flops=6.6e+07
 renorm[gemm] counter=13 i=5 t=1.6e-04 per=2.2e+01 cost=2.0e+04 flops=1.2e+08
 renorm[gemm] counter=13 i=6 t=1.2e-04 per=1.6e+01 cost=3.4e+04 flops=2.8e+08
 renorm[gemm] counter=13 total t=4.3e-04 per=5.9e+01 cost=6.2e+04 flops=1.5e+08
 renorm[red] counter=13 t=2.0e-04 per=2.8e+01 cost=1.6e+04 flops=7.8e+07
--- TIMING FOR renorm_tot : t_inter=1.7e-03 t_gemm=7.9e-03 t_reduction=2.9e-03 tot=1.2e-02 ---
 renorm_tot[inter] counter=13 t=1.7e-03 per=1.3e+01 cost=1.3e+06 flops=7.6e+08
 renorm_tot[gemm] counter=13 i=0 t=3.7e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=1 t=2.9e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=2 t=2.9e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=3 t=2.8e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=13 i=4 t=2.6e-03 per=2.1e+01 cost=1.8e+05 flops=6.9e+07
 renorm_tot[gemm] counter=13 i=5 t=2.6e-03 per=2.1e+01 cost=4.8e+05 flops=1.9e+08
 renorm_tot[gemm] counter=13 i=6 t=2.6e-03 per=2.1e+01 cost=8.4e+05 flops=3.2e+08
 renorm_tot[gemm] counter=13 total t=7.9e-03 per=6.4e+01 cost=1.5e+06 flops=1.9e+08
 renorm_tot[red] counter=13 t=2.9e-03 per=2.3e+01 cost=3.6e+05 flops=1.2e+08
qops.to_cpu: size(tot)=1039:7.9e-03MB:7.7e-06GB t[to_cpu]=1.7e-05S speed=4.5e-01GB/S
check ||H-H.dagger||=7.623e-15 coord=(13,0) rank=0
ctns::oper_ab2pq coord=(13,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00677 S rank=0 -----
CPUmem: VM:7.269e+01GB RSS:5.787e-01GB  Timing: User:2.456e+01S Sys:1.150e+00S Total:2.571e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=571:4.356e-03MB:4.254e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=14:1.068e-04MB:1.043e-07GB
total mem of comb=586:4.471e-03MB:4.366e-06GB
CPUmem: VM:7.269e+01GB RSS:5.787e-01GB  Timing: User:2.456e+01S Sys:1.150e+00S Total:2.571e+01S
##### local opt: 5.290e-02 S #####
 T(local opt: fetch) = 6.416e-03 S  per = 12.1  per(accum) = 12.1
 T(local opt: hdiag) = 3.474e-03 S  per = 6.57  per(accum) = 18.7
 T(local opt: dvdsn) = 2.813e-02 S  per = 53.2  per(accum) = 71.9
 T(local opt: decim) = 3.218e-03 S  per = 6.08  per(accum) = 78
 T(local opt: guess) = 3.709e-05 S  per = 0.0701  per(accum) = 78
 T(local opt: renrm) = 7.681e-03 S  per = 14.5  per(accum) = 92.5
 T(local opt: save ) = 3.944e-03 S  per = 7.45  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.813e-02 S  T(sum) = 2.735e-02 S  per = 9.719e+01
 T(local opt: preprocess                  ) = 3.045e-04 S  per = 1.11  per(accum) = 1.11
 T(local opt: symbolic_formulae           ) = 1.006e-03 S  per = 3.68  per(accum) = 4.79
 T(local opt: hintermediate init          ) = 5.903e-04 S  per = 2.16  per(accum) = 6.95
 T(local opt: preprocess_hformulae_Hxlist ) = 5.977e-03 S  per = 21.9  per(accum) = 28.8
 T(local opt: hmmtasks init               ) = 9.110e-04 S  per = 3.33  per(accum) = 32.1
 T(local opt: initial guess for dvdson    ) = 1.492e-04 S  per = 0.546  per(accum) = 32.7
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.677e-02 S  per = 61.3  per(accum) = 94
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.699e-04 S  per = 0.621  per(accum) = 94.6
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.150e-07 S  per = 0.000786  per(accum) = 94.6
 T(local opt: dvdson solver [rest part]   ) = 1.470e-03 S  per = 5.38  per(accum) = 100
Detailed decomposition of T(renrm) = 7.681e-03 S  T(sum) = 7.681e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.011e-04 S  per = 1.32  per(accum) = 1.32
 T(local opt: qops init                    ) = 3.991e-04 S  per =  5.2  per(accum) = 6.51
 T(local opt: symbolic_formulae_renorm     ) = 5.316e-04 S  per = 6.92  per(accum) = 13.4
 T(local opt: allocate qops on gpu         ) = 8.974e-05 S  per = 1.17  per(accum) = 14.6
 T(local opt: site memcpy cpu2gpu          ) = 8.391e-05 S  per = 1.09  per(accum) = 15.7
 T(local opt: rintermediate init           ) = 4.797e-04 S  per = 6.25  per(accum) = 21.9
 T(local opt: preprocess_formulae_Rlist2   ) = 1.928e-03 S  per = 25.1  per(accum) = 47
 T(local opt: rmmtasks init                ) = 6.123e-04 S  per = 7.97  per(accum) = 55
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 0.00056  per(accum) = 55
 T(local opt: preprocess_renorm_batchGPU   ) = 2.455e-03 S  per =   32  per(accum) = 87
 T(local opt: reduction of opS & opH [nccl]) = 5.960e-07 S  per = 0.00776  per(accum) = 87
 T(local opt: qops memcpy gpu2cpu          ) = 9.121e-05 S  per = 1.19  per(accum) = 88.2
 T(local opt: deallocate cpu and gpu memory) = 9.926e-06 S  per = 0.129  per(accum) = 88.3
 T(local opt: reduction of opS & opH [comm]) = 8.599e-05 S  per = 1.12  per(accum) = 89.4
 T(local opt: conversion from opAB to opPQ ) = 6.988e-05 S  per = 0.91  per(accum) = 90.3
 T(local opt: after oper_renorm            ) = 7.424e-04 S  per = 9.67  per(accum) = 100
##### sweep opt: 1.104e+00 S #####
 T(sweep opt: fetch) = 8.723e-02 S  per =  7.9  per(accum) = 7.9
 T(sweep opt: hdiag) = 7.703e-02 S  per = 6.98  per(accum) = 14.9
 T(sweep opt: dvdsn) = 7.153e-01 S  per = 64.8  per(accum) = 79.7
 T(sweep opt: decim) = 4.883e-02 S  per = 4.42  per(accum) = 84.1
 T(sweep opt: guess) = 1.779e-03 S  per = 0.161  per(accum) = 84.2
 T(sweep opt: renrm) = 1.138e-01 S  per = 10.3  per(accum) = 94.6
 T(sweep opt: save ) = 6.016e-02 S  per = 5.45  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.153e-01 S  T(sum) = 7.036e-01 S  per = 9.837e+01
 T(sweep opt: preprocess                  ) = 8.360e-03 S  per = 1.19  per(accum) = 1.19
 T(sweep opt: symbolic_formulae           ) = 1.539e-02 S  per = 2.19  per(accum) = 3.38
 T(sweep opt: hintermediate init          ) = 7.760e-03 S  per =  1.1  per(accum) = 4.48
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.850e-01 S  per = 40.5  per(accum) = 45
 T(sweep opt: hmmtasks init               ) = 4.850e-02 S  per = 6.89  per(accum) = 51.9
 T(sweep opt: initial guess for dvdson    ) = 3.133e-03 S  per = 0.445  per(accum) = 52.3
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 3.110e-01 S  per = 44.2  per(accum) = 96.5
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.378e-03 S  per = 0.338  per(accum) = 96.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 3.903e-06 S  per = 0.000555  per(accum) = 96.9
 T(sweep opt: dvdson solver [rest part]   ) = 2.211e-02 S  per = 3.14  per(accum) = 100
Detailed decomposition of T(renrm) = 1.138e-01 S  T(sum) = 1.138e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.615e-03 S  per = 1.42  per(accum) = 1.42
 T(sweep opt: qops init                    ) = 6.159e-03 S  per = 5.41  per(accum) = 6.83
 T(sweep opt: symbolic_formulae_renorm     ) = 7.021e-03 S  per = 6.17  per(accum) = 13
 T(sweep opt: allocate qops on gpu         ) = 1.256e-03 S  per =  1.1  per(accum) = 14.1
 T(sweep opt: site memcpy cpu2gpu          ) = 1.180e-03 S  per = 1.04  per(accum) = 15.1
 T(sweep opt: rintermediate init           ) = 6.267e-03 S  per =  5.5  per(accum) = 20.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.681e-02 S  per = 23.5  per(accum) = 44.2
 T(sweep opt: rmmtasks init                ) = 8.549e-03 S  per = 7.51  per(accum) = 51.7
 T(sweep opt: qops memset on cpu           ) = 6.720e-07 S  per = 0.00059  per(accum) = 51.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.575e-02 S  per = 31.4  per(accum) = 83.1
 T(sweep opt: reduction of opS & opH [nccl]) = 7.606e-06 S  per = 0.00668  per(accum) = 83.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.267e-03 S  per = 1.11  per(accum) = 84.2
 T(sweep opt: deallocate cpu and gpu memory) = 2.714e-04 S  per = 0.238  per(accum) = 84.5
 T(sweep opt: reduction of opS & opH [comm]) = 1.140e-03 S  per =    1  per(accum) = 85.5
 T(sweep opt: conversion from opAB to opPQ ) = 6.929e-03 S  per = 6.09  per(accum) = 91.5
 T(sweep opt: after oper_renorm            ) = 9.621e-03 S  per = 8.45  per(accum) = 100
##### global opt: 1.104e+00 S #####
 T(global opt: fetch) = 8.723e-02 S  per =  7.9  per(accum) = 7.9
 T(global opt: hdiag) = 7.703e-02 S  per = 6.98  per(accum) = 14.9
 T(global opt: dvdsn) = 7.153e-01 S  per = 64.8  per(accum) = 79.7
 T(global opt: decim) = 4.883e-02 S  per = 4.42  per(accum) = 84.1
 T(global opt: guess) = 1.779e-03 S  per = 0.161  per(accum) = 84.2
 T(global opt: renrm) = 1.138e-01 S  per = 10.3  per(accum) = 94.6
 T(global opt: save ) = 6.016e-02 S  per = 5.45  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.153e-01 S  T(sum) = 7.036e-01 S  per = 9.837e+01
 T(global opt: preprocess                  ) = 8.360e-03 S  per = 1.19  per(accum) = 1.19
 T(global opt: symbolic_formulae           ) = 1.539e-02 S  per = 2.19  per(accum) = 3.38
 T(global opt: hintermediate init          ) = 7.760e-03 S  per =  1.1  per(accum) = 4.48
 T(global opt: preprocess_hformulae_Hxlist ) = 2.850e-01 S  per = 40.5  per(accum) = 45
 T(global opt: hmmtasks init               ) = 4.850e-02 S  per = 6.89  per(accum) = 51.9
 T(global opt: initial guess for dvdson    ) = 3.133e-03 S  per = 0.445  per(accum) = 52.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 3.110e-01 S  per = 44.2  per(accum) = 96.5
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.378e-03 S  per = 0.338  per(accum) = 96.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 3.903e-06 S  per = 0.000555  per(accum) = 96.9
 T(global opt: dvdson solver [rest part]   ) = 2.211e-02 S  per = 3.14  per(accum) = 100
Detailed decomposition of T(renrm) = 1.138e-01 S  T(sum) = 1.138e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.615e-03 S  per = 1.42  per(accum) = 1.42
 T(global opt: qops init                    ) = 6.159e-03 S  per = 5.41  per(accum) = 6.83
 T(global opt: symbolic_formulae_renorm     ) = 7.021e-03 S  per = 6.17  per(accum) = 13
 T(global opt: allocate qops on gpu         ) = 1.256e-03 S  per =  1.1  per(accum) = 14.1
 T(global opt: site memcpy cpu2gpu          ) = 1.180e-03 S  per = 1.04  per(accum) = 15.1
 T(global opt: rintermediate init           ) = 6.267e-03 S  per =  5.5  per(accum) = 20.6
 T(global opt: preprocess_formulae_Rlist2   ) = 2.681e-02 S  per = 23.5  per(accum) = 44.2
 T(global opt: rmmtasks init                ) = 8.549e-03 S  per = 7.51  per(accum) = 51.7
 T(global opt: qops memset on cpu           ) = 6.720e-07 S  per = 0.00059  per(accum) = 51.7
 T(global opt: preprocess_renorm_batchGPU   ) = 3.575e-02 S  per = 31.4  per(accum) = 83.1
 T(global opt: reduction of opS & opH [nccl]) = 7.606e-06 S  per = 0.00668  per(accum) = 83.1
 T(global opt: qops memcpy gpu2cpu          ) = 1.267e-03 S  per = 1.11  per(accum) = 84.2
 T(global opt: deallocate cpu and gpu memory) = 2.714e-04 S  per = 0.238  per(accum) = 84.5
 T(global opt: reduction of opS & opH [comm]) = 1.140e-03 S  per =    1  per(accum) = 85.5
 T(global opt: conversion from opAB to opPQ ) = 6.929e-03 S  per = 6.09  per(accum) = 91.5
 T(global opt: after oper_renorm            ) = 9.621e-03 S  per = 8.45  per(accum) = 100

isweep=0 ibond=13/seqsize=34 dots=2 dbond=(14,0)-(15,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.269e+01GB RSS:5.787e-01GB  Timing: User:2.457e+01S Sys:1.150e+00S Total:2.572e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=571:4.356e-03MB:4.254e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=14:1.068e-04MB:1.043e-07GB
total mem of comb=586:4.471e-03MB:4.366e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=14,4,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 12 13 14 15
 suppc1= 10
 suppc2= 11
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:14 S:6 H:1 P:36 Q:42 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=1039:7.927e-03MB:7.741e-06GB
 rqops: oplist=CSHAB nops=C:4 S:16 H:1 A:16 B:20 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=145:1.106e-03MB:1.080e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=3180:2.426e-02MB:2.369e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(14,0) fdel=./scratch/sweep/rop(15,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
wf4(diml,dimr,dimc1,dimc2)=(7,3,3,3) nnz=44:3.357e-04MB
qtensor4: wf4 own=1 _data=0x55a323863550
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=7
 (22,2):2 (21,3):2 (22,4):2 (23,3):1
 qbond: qcol nsym=2 dimAll=3
 (5,3):2 (6,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=18 nblocks=128 size=44:3.357e-04MB
### DIAG TIMING: total=2.337e-03 t1=7.490e-06, t2=1.362e-05, t3=1.728e-05, t4=2.273e-03, t5=4.790e-06, t6=1.735e-05, t7=3.399e-06
duration_diagGPU:2.420e-03
duration_diagreduce:3.100e-08
duration_diagtransform:1.540e-07
----- TIMING FOR symbolic_formulae_twodot with size=437 : 7.524e-04 S -----
rank=0 GPUmem(GB): used=2.37e-05 (oper)=2.37e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=437
 no. of hintermediate operators=240
 no. of coefficients=2470:0.0188MB:1.84e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.320e-04 S -----
rank=0 GPUmem(GB): used=4.21e-05 (oper,hinter)=2.37e-05,1.84e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0127 S size(H_formulae)=437 size(Hxlst2)=18 T(Hmu/Hxlist)=0.000147,0.0126 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.013 S size(H_formulae)=437 size(Hxlst)=8088 -----
rank=0 GPUmem(GB): used=0.000826 (oper,hinter,dvdson,batch)=2.37e-05,1.84e-05,6.56e-07,0.000783 blksize=4 blksize0=4 batchsize=8088
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=44 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.11e-05,0.000149,0.000582,0.000689,0.00146
 ndim=44:3.28e-07GB t[comm(intra)]=2.39e-05 speed=0.0275GB/S t[comm(inter)]=7.21e-06 speed=0.0909GB/S
--- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=5.8e-04 t_reduction=6.9e-04 tot=1.4e-03 ---
 sigma[inter] counter=84 t=1.5e-04 per=1.0e+01 cost=2.4e+05 flops=1.6e+09
 sigma[gemm] counter=84 i=0 t=2.7e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=1 t=2.3e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=4 t=1.6e-04 per=1.1e+01 cost=2.6e+04 flops=1.7e+08
 sigma[gemm] counter=84 i=5 t=1.5e-04 per=1.0e+01 cost=2.6e+04 flops=1.7e+08
 sigma[gemm] counter=84 i=6 t=1.4e-04 per=9.5e+00 cost=2.7e+04 flops=2.0e+08
 sigma[gemm] counter=84 i=7 t=1.3e-04 per=9.5e+00 cost=3.0e+04 flops=2.2e+08
 sigma[gemm] counter=84 total t=5.8e-04 per=4.1e+01 cost=1.1e+05 flops=1.9e+08
 sigma[red] counter=84 t=6.9e-04 per=4.9e+01 cost=4.0e+04 flops=5.8e+07
--- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=6.9e-02 t_reduction=6.1e-02 tot=1.4e-01 ---
 sigma_tot[inter] counter=84 t=1.4e-02 per=9.6e+00 cost=7.4e+07 flops=5.4e+09
 sigma_tot[gemm] counter=84 i=0 t=2.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=1 t=1.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=2 t=1.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=3 t=1.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=4 t=1.6e-02 per=1.1e+01 cost=1.5e+07 flops=9.3e+08
 sigma_tot[gemm] counter=84 i=5 t=1.8e-02 per=1.3e+01 cost=1.5e+07 flops=8.2e+08
 sigma_tot[gemm] counter=84 i=6 t=1.7e-02 per=1.2e+01 cost=1.4e+07 flops=8.1e+08
 sigma_tot[gemm] counter=84 i=7 t=1.7e-02 per=1.2e+01 cost=1.5e+07 flops=8.7e+08
 sigma_tot[gemm] counter=84 total t=6.9e-02 per=4.8e+01 cost=5.8e+07 flops=8.5e+08
 sigma_tot[red] counter=84 t=6.1e-02 per=4.3e+01 cost=1.3e+07 flops=2.2e+08
T(sub)=7.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,2.9e-06,1.1e-06,8.3e-07,2.2e-07
settings: ndim=44 neig=1 maxcycle=30 nbuff=4 memory=5e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.298821391660 -1.116e+03  2.683e-02    1     1  3.570e-03 3.570e-03 3.404e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.852e-05,1.161e-04,4.624e-04,6.516e-04,1.263e-03
 ndim=44:3.278e-07GB t[comm(intra)]=2.322e-05 speed=2.824e-02GB/S t[comm(inter)]=5.301e-06 speed=1.237e-01GB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=4.6e-04 t_reduction=6.5e-04 tot=1.2e-03 ---
 sigma[inter] counter=85 t=1.2e-04 per=9.4e+00 cost=2.4e+05 flops=2.1e+09
 sigma[gemm] counter=85 i=0 t=2.8e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=1 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=2 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=3 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=4 t=1.2e-04 per=9.7e+00 cost=2.6e+04 flops=2.2e+08
 sigma[gemm] counter=85 i=5 t=1.2e-04 per=1.0e+01 cost=2.6e+04 flops=2.1e+08
 sigma[gemm] counter=85 i=6 t=1.1e-04 per=8.6e+00 cost=2.7e+04 flops=2.5e+08
 sigma[gemm] counter=85 i=7 t=1.1e-04 per=8.6e+00 cost=3.0e+04 flops=2.8e+08
 sigma[gemm] counter=85 total t=4.6e-04 per=3.8e+01 cost=1.1e+05 flops=2.3e+08
 sigma[red] counter=85 t=6.5e-04 per=5.3e+01 cost=4.0e+04 flops=6.1e+07
--- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=6.9e-02 t_reduction=6.2e-02 tot=1.4e-01 ---
 sigma_tot[inter] counter=85 t=1.4e-02 per=9.6e+00 cost=7.4e+07 flops=5.3e+09
 sigma_tot[gemm] counter=85 i=0 t=2.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=1 t=1.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=2 t=1.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=3 t=1.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=4 t=1.6e-02 per=1.1e+01 cost=1.5e+07 flops=9.3e+08
 sigma_tot[gemm] counter=85 i=5 t=1.8e-02 per=1.3e+01 cost=1.5e+07 flops=8.2e+08
 sigma_tot[gemm] counter=85 i=6 t=1.7e-02 per=1.2e+01 cost=1.4e+07 flops=8.1e+08
 sigma_tot[gemm] counter=85 i=7 t=1.7e-02 per=1.2e+01 cost=1.5e+07 flops=8.7e+08
 sigma_tot[gemm] counter=85 total t=6.9e-02 per=4.8e+01 cost=5.8e+07 flops=8.4e+08
 sigma_tot[red] counter=85 t=6.2e-02 per=4.3e+01 cost=1.3e+07 flops=2.2e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,9.8e-06,2.3e-06,1.0e-06,1.9e-07
    2   0 -    -116.301168729010 -2.347e-03  9.570e-03    2     2  7.262e-03 3.631e-03 3.306e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.814e-05,1.157e-04,4.651e-04,6.364e-04,1.250e-03
 ndim=44:3.278e-07GB t[comm(intra)]=2.247e-05 speed=2.918e-02GB/S t[comm(inter)]=5.674e-06 speed=1.156e-01GB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=4.6e-04 t_reduction=6.4e-04 tot=1.2e-03 ---
 sigma[inter] counter=86 t=1.2e-04 per=9.5e+00 cost=2.4e+05 flops=2.1e+09
 sigma[gemm] counter=86 i=0 t=2.7e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=1 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=2 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=3 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=4 t=1.1e-04 per=9.3e+00 cost=2.6e+04 flops=2.3e+08
 sigma[gemm] counter=86 i=5 t=1.1e-04 per=9.4e+00 cost=2.6e+04 flops=2.2e+08
 sigma[gemm] counter=86 i=6 t=1.2e-04 per=1.0e+01 cost=2.7e+04 flops=2.2e+08
 sigma[gemm] counter=86 i=7 t=1.0e-04 per=8.6e+00 cost=3.0e+04 flops=2.8e+08
 sigma[gemm] counter=86 total t=4.6e-04 per=3.8e+01 cost=1.1e+05 flops=2.3e+08
 sigma[red] counter=86 t=6.4e-04 per=5.2e+01 cost=4.0e+04 flops=6.3e+07
--- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=6.9e-02 t_reduction=6.2e-02 tot=1.5e-01 ---
 sigma_tot[inter] counter=86 t=1.4e-02 per=9.6e+00 cost=7.4e+07 flops=5.3e+09
 sigma_tot[gemm] counter=86 i=0 t=2.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=1 t=1.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=2 t=1.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=3 t=1.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=4 t=1.6e-02 per=1.1e+01 cost=1.5e+07 flops=9.2e+08
 sigma_tot[gemm] counter=86 i=5 t=1.8e-02 per=1.3e+01 cost=1.5e+07 flops=8.1e+08
 sigma_tot[gemm] counter=86 i=6 t=1.7e-02 per=1.2e+01 cost=1.4e+07 flops=8.0e+08
 sigma_tot[gemm] counter=86 i=7 t=1.7e-02 per=1.2e+01 cost=1.5e+07 flops=8.7e+08
 sigma_tot[gemm] counter=86 total t=6.9e-02 per=4.8e+01 cost=5.8e+07 flops=8.4e+08
 sigma_tot[red] counter=86 t=6.2e-02 per=4.3e+01 cost=1.4e+07 flops=2.2e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.2e-05,1.8e-06,9.0e-07,1.7e-07
    3   0 -    -116.301414230834 -2.455e-04  3.487e-03    3     3  1.060e-02 3.533e-03 3.256e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.804e-05,1.066e-04,4.680e-04,6.594e-04,1.266e-03
 ndim=44:3.278e-07GB t[comm(intra)]=2.285e-05 speed=2.869e-02GB/S t[comm(inter)]=5.189e-06 speed=1.264e-01GB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=4.7e-04 t_reduction=6.6e-04 tot=1.2e-03 ---
 sigma[inter] counter=87 t=1.1e-04 per=8.6e+00 cost=2.4e+05 flops=2.3e+09
 sigma[gemm] counter=87 i=0 t=2.3e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=1 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=2 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=3 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=4 t=1.2e-04 per=9.5e+00 cost=2.6e+04 flops=2.2e+08
 sigma[gemm] counter=87 i=5 t=1.2e-04 per=1.0e+01 cost=2.6e+04 flops=2.1e+08
 sigma[gemm] counter=87 i=6 t=1.1e-04 per=9.2e+00 cost=2.7e+04 flops=2.4e+08
 sigma[gemm] counter=87 i=7 t=1.0e-04 per=8.4e+00 cost=3.0e+04 flops=2.9e+08
 sigma[gemm] counter=87 total t=4.7e-04 per=3.8e+01 cost=1.1e+05 flops=2.3e+08
 sigma[red] counter=87 t=6.6e-04 per=5.3e+01 cost=4.0e+04 flops=6.1e+07
--- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=7.0e-02 t_reduction=6.3e-02 tot=1.5e-01 ---
 sigma_tot[inter] counter=87 t=1.4e-02 per=9.6e+00 cost=7.5e+07 flops=5.3e+09
 sigma_tot[gemm] counter=87 i=0 t=2.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=1 t=2.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=2 t=1.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=3 t=1.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=4 t=1.6e-02 per=1.1e+01 cost=1.5e+07 flops=9.2e+08
 sigma_tot[gemm] counter=87 i=5 t=1.8e-02 per=1.3e+01 cost=1.5e+07 flops=8.1e+08
 sigma_tot[gemm] counter=87 i=6 t=1.7e-02 per=1.2e+01 cost=1.4e+07 flops=8.0e+08
 sigma_tot[gemm] counter=87 i=7 t=1.7e-02 per=1.2e+01 cost=1.5e+07 flops=8.6e+08
 sigma_tot[gemm] counter=87 total t=7.0e-02 per=4.8e+01 cost=5.8e+07 flops=8.4e+08
 sigma_tot[red] counter=87 t=6.3e-02 per=4.3e+01 cost=1.4e+07 flops=2.2e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.1e-05,1.7e-06,8.3e-07,1.6e-07
    4   0 -    -116.301450947453 -3.672e-05  1.343e-03    3     4  1.398e-02 3.494e-03 3.244e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.778e-05,1.102e-04,4.576e-04,6.433e-04,1.243e-03
 ndim=44:3.278e-07GB t[comm(intra)]=2.235e-05 speed=2.934e-02GB/S t[comm(inter)]=5.434e-06 speed=1.207e-01GB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=4.6e-04 t_reduction=6.4e-04 tot=1.2e-03 ---
 sigma[inter] counter=88 t=1.1e-04 per=9.1e+00 cost=2.4e+05 flops=2.2e+09
 sigma[gemm] counter=88 i=0 t=2.3e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=1 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=2 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=3 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=4 t=1.1e-04 per=8.9e+00 cost=2.6e+04 flops=2.4e+08
 sigma[gemm] counter=88 i=5 t=1.1e-04 per=9.3e+00 cost=2.6e+04 flops=2.3e+08
 sigma[gemm] counter=88 i=6 t=1.2e-04 per=1.0e+01 cost=2.7e+04 flops=2.2e+08
 sigma[gemm] counter=88 i=7 t=1.0e-04 per=8.7e+00 cost=3.0e+04 flops=2.8e+08
 sigma[gemm] counter=88 total t=4.6e-04 per=3.8e+01 cost=1.1e+05 flops=2.4e+08
 sigma[red] counter=88 t=6.4e-04 per=5.3e+01 cost=4.0e+04 flops=6.2e+07
--- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=7.0e-02 t_reduction=6.4e-02 tot=1.5e-01 ---
 sigma_tot[inter] counter=88 t=1.4e-02 per=9.6e+00 cost=7.5e+07 flops=5.3e+09
 sigma_tot[gemm] counter=88 i=0 t=2.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=1 t=2.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=2 t=2.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=3 t=1.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=4 t=1.6e-02 per=1.1e+01 cost=1.5e+07 flops=9.1e+08
 sigma_tot[gemm] counter=88 i=5 t=1.9e-02 per=1.3e+01 cost=1.5e+07 flops=8.1e+08
 sigma_tot[gemm] counter=88 i=6 t=1.8e-02 per=1.2e+01 cost=1.4e+07 flops=8.0e+08
 sigma_tot[gemm] counter=88 i=7 t=1.7e-02 per=1.2e+01 cost=1.5e+07 flops=8.6e+08
 sigma_tot[gemm] counter=88 total t=7.0e-02 per=4.8e+01 cost=5.9e+07 flops=8.3e+08
 sigma_tot[red] counter=88 t=6.4e-02 per=4.3e+01 cost=1.4e+07 flops=2.1e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.0e-05,1.6e-06,7.7e-07,1.3e-07
    5   0 -    -116.301456187403 -5.240e-06  3.883e-04    3     5  1.731e-02 3.461e-03 3.226e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.782e-05,1.051e-04,4.589e-04,6.502e-04,1.246e-03
 ndim=44:3.278e-07GB t[comm(intra)]=2.241e-05 speed=2.925e-02GB/S t[comm(inter)]=5.412e-06 speed=1.211e-01GB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=4.6e-04 t_reduction=6.5e-04 tot=1.2e-03 ---
 sigma[inter] counter=89 t=1.1e-04 per=8.7e+00 cost=2.4e+05 flops=2.3e+09
 sigma[gemm] counter=89 i=0 t=2.3e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=1 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=2 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=3 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=4 t=1.1e-04 per=9.4e+00 cost=2.6e+04 flops=2.3e+08
 sigma[gemm] counter=89 i=5 t=1.3e-04 per=1.0e+01 cost=2.6e+04 flops=2.0e+08
 sigma[gemm] counter=89 i=6 t=1.1e-04 per=8.9e+00 cost=2.7e+04 flops=2.5e+08
 sigma[gemm] counter=89 i=7 t=1.0e-04 per=8.4e+00 cost=3.0e+04 flops=2.9e+08
 sigma[gemm] counter=89 total t=4.6e-04 per=3.8e+01 cost=1.1e+05 flops=2.4e+08
 sigma[red] counter=89 t=6.5e-04 per=5.4e+01 cost=4.0e+04 flops=6.1e+07
--- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=7.1e-02 t_reduction=6.4e-02 tot=1.5e-01 ---
 sigma_tot[inter] counter=89 t=1.4e-02 per=9.6e+00 cost=7.5e+07 flops=5.2e+09
 sigma_tot[gemm] counter=89 i=0 t=2.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=1 t=2.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=2 t=2.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=3 t=2.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=4 t=1.6e-02 per=1.1e+01 cost=1.5e+07 flops=9.1e+08
 sigma_tot[gemm] counter=89 i=5 t=1.9e-02 per=1.3e+01 cost=1.5e+07 flops=8.0e+08
 sigma_tot[gemm] counter=89 i=6 t=1.8e-02 per=1.2e+01 cost=1.4e+07 flops=7.9e+08
 sigma_tot[gemm] counter=89 i=7 t=1.7e-02 per=1.2e+01 cost=1.5e+07 flops=8.6e+08
 sigma_tot[gemm] counter=89 total t=7.1e-02 per=4.7e+01 cost=5.9e+07 flops=8.3e+08
 sigma_tot[red] counter=89 t=6.4e-02 per=4.3e+01 cost=1.4e+07 flops=2.1e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,1.0e-05,1.6e-06,7.8e-07,1.2e-07
    6   0 +    -116.301456582762 -3.954e-07  7.438e-05    3     6  2.072e-02 3.453e-03 3.227e-03
TIMING FOR Davidson : 2.080e-02  T(cal/comm/rest)=1.936e-02,2.790e-07,1.435e-03
decomposed t_rest=1.435e-03
 T(sub)    =9.381e-05 per=6.536e+00
 T(precond)=1.355e-04 per=9.440e+00
 T(ortho)  =8.055e-06 per=5.612e-01
 T(xcopy)  =6.700e-07 per=4.668e-02
 T(xnrm2)  =9.770e-07 per=6.807e-02
 T(other)  =1.196e-03 per=8.335e+01
optimized energies: isweep=0 ibond=13 dots=2 e[0]=-116.301456582762 nmvp=6
CPUmem: VM:7.269e+01GB RSS:5.787e-01GB  Timing: User:2.555e+01S Sys:1.150e+00S Total:2.670e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond13.txt
 qbond: qsuper nsym=9 dimAll=28
 (22,2):4 (24,2):3 (23,1):2 (23,3):7 (21,3):2 (22,4):4 (24,4):3 (23,5):2 (25,3):1
----- TMING FOR decimation_genbasis(su2): 7.3e-05 S -----
decimation summary: 28->10 dwt=+7.605e-09 SvN=1.460e-01
 qbond: qkept nsym=6 dimAll=10
 (23,3):3 (24,2):2 (24,4):2 (22,2):1 (23,1):1 (25,3):1
----- TIMING for decimation_row(nkr): 3.437e-03 S T(decim/select/formRot)=3.740e-04,2.920e-03,1.438e-04 -----
----- TIMING FOR twodot_decimation: 3.628e-03 S T(wf/decim)=1.144e-04,3.514e-03 -----
ctns::oper_renorm coord=(14,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:15 S:5 H:1 P:25 Q:30 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=1425:1.087e-02MB:1.062e-05GB
CPUmem: VM:7.275e+01GB RSS:5.787e-01GB  Timing: User:2.580e+01S Sys:1.150e+00S Total:2.695e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=76 : 3.543e-04 S -----
rank=0 GPUmem(GB): used=5.16e-05 (oper)=2.58e-05
rank=0 GPUmem(GB): used=5.19e-05 (oper,site)(GB)=2.58e-05,2.98e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=76
 no. of rintermediate operators=100
 no. of coefficients=1400:0.0107MB:1.04e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.038e-04 S -----
rank=0 GPUmem(GB): used=6.24e-05 (oper,site,rinter)=2.58e-05,2.98e-07,1.04e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00198 S size(rtasks)=76 size(Rlst2)=36 T(Rmu/Rlist)=9.16e-05,0.00189 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00212 S size(rtasks)=76 size(Rlst)=2429 -----
rank=0 GPUmem(GB): used=6.24e-05 (oper,site,rinter,batch)=2.58e-05,2.98e-07,1.04e-05,0.000416 blksize=9 blksize0=4 batchsize=2429
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.96e-05,0.000556,0.00028
--- TIMING FOR renorm : t_inter=9.9e-05 t_gemm=5.6e-04 t_reduction=2.8e-04 tot=9.3e-04 ---
 renorm[inter] counter=14 t=9.9e-05 per=1.1e+01 cost=6.0e+04 flops=6.1e+08
 renorm[gemm] counter=14 i=0 t=2.8e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=1 t=2.2e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=2 t=2.2e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=3 t=2.2e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=14 i=4 t=1.6e-04 per=1.7e+01 cost=8.9e+03 flops=5.5e+07
 renorm[gemm] counter=14 i=5 t=1.6e-04 per=1.7e+01 cost=1.6e+04 flops=9.6e+07
 renorm[gemm] counter=14 i=6 t=2.2e-04 per=2.4e+01 cost=3.9e+04 flops=1.7e+08
 renorm[gemm] counter=14 total t=5.6e-04 per=5.9e+01 cost=6.3e+04 flops=1.1e+08
 renorm[red] counter=14 t=2.8e-04 per=3.0e+01 cost=2.3e+04 flops=8.1e+07
--- TIMING FOR renorm_tot : t_inter=1.8e-03 t_gemm=8.5e-03 t_reduction=3.2e-03 tot=1.3e-02 ---
 renorm_tot[inter] counter=14 t=1.8e-03 per=1.3e+01 cost=1.3e+06 flops=7.5e+08
 renorm_tot[gemm] counter=14 i=0 t=4.0e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=1 t=3.1e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=2 t=3.1e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=3 t=3.1e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=14 i=4 t=2.8e-03 per=2.1e+01 cost=1.9e+05 flops=6.8e+07
 renorm_tot[gemm] counter=14 i=5 t=2.7e-03 per=2.0e+01 cost=5.0e+05 flops=1.8e+08
 renorm_tot[gemm] counter=14 i=6 t=2.9e-03 per=2.1e+01 cost=8.8e+05 flops=3.1e+08
 renorm_tot[gemm] counter=14 total t=8.5e-03 per=6.3e+01 cost=1.6e+06 flops=1.8e+08
 renorm_tot[red] counter=14 t=3.2e-03 per=2.4e+01 cost=3.8e+05 flops=1.2e+08
qops.to_cpu: size(tot)=1425:1.1e-02MB:1.1e-05GB t[to_cpu]=1.9e-05S speed=5.7e-01GB/S
check ||H-H.dagger||=1.284e-14 coord=(14,0) rank=0
ctns::oper_ab2pq coord=(14,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00729 S rank=0 -----
CPUmem: VM:7.275e+01GB RSS:5.787e-01GB  Timing: User:2.600e+01S Sys:1.157e+00S Total:2.716e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=603:4.601e-03MB:4.493e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=627:4.784e-03MB:4.672e-06GB
CPUmem: VM:7.275e+01GB RSS:5.787e-01GB  Timing: User:2.600e+01S Sys:1.157e+00S Total:2.716e+01S
##### local opt: 6.368e-02 S #####
 T(local opt: fetch) = 5.316e-03 S  per = 8.35  per(accum) = 8.35
 T(local opt: hdiag) = 3.319e-03 S  per = 5.21  per(accum) = 13.6
 T(local opt: dvdsn) = 3.868e-02 S  per = 60.7  per(accum) = 74.3
 T(local opt: decim) = 3.712e-03 S  per = 5.83  per(accum) = 80.1
 T(local opt: guess) = 5.918e-05 S  per = 0.0929  per(accum) = 80.2
 T(local opt: renrm) = 8.182e-03 S  per = 12.8  per(accum) = 93.1
 T(local opt: save ) = 4.413e-03 S  per = 6.93  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.868e-02 S  T(sum) = 3.790e-02 S  per = 9.797e+01
 T(local opt: preprocess                  ) = 4.022e-04 S  per = 1.06  per(accum) = 1.06
 T(local opt: symbolic_formulae           ) = 8.358e-04 S  per = 2.21  per(accum) = 3.27
 T(local opt: hintermediate init          ) = 5.497e-04 S  per = 1.45  per(accum) = 4.72
 T(local opt: preprocess_hformulae_Hxlist ) = 1.310e-02 S  per = 34.6  per(accum) = 39.3
 T(local opt: hmmtasks init               ) = 2.061e-03 S  per = 5.44  per(accum) = 44.7
 T(local opt: initial guess for dvdson    ) = 1.574e-04 S  per = 0.415  per(accum) = 45.1
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.919e-02 S  per = 50.6  per(accum) = 95.8
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.714e-04 S  per = 0.452  per(accum) = 96.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.790e-07 S  per = 0.000736  per(accum) = 96.2
 T(local opt: dvdson solver [rest part]   ) = 1.435e-03 S  per = 3.79  per(accum) = 100
Detailed decomposition of T(renrm) = 8.182e-03 S  T(sum) = 8.182e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.117e-04 S  per = 1.36  per(accum) = 1.36
 T(local opt: qops init                    ) = 4.653e-04 S  per = 5.69  per(accum) = 7.05
 T(local opt: symbolic_formulae_renorm     ) = 4.316e-04 S  per = 5.27  per(accum) = 12.3
 T(local opt: allocate qops on gpu         ) = 9.375e-05 S  per = 1.15  per(accum) = 13.5
 T(local opt: site memcpy cpu2gpu          ) = 8.135e-05 S  per = 0.994  per(accum) = 14.5
 T(local opt: rintermediate init           ) = 4.577e-04 S  per = 5.59  per(accum) = 20.1
 T(local opt: preprocess_formulae_Rlist2   ) = 2.199e-03 S  per = 26.9  per(accum) = 46.9
 T(local opt: rmmtasks init                ) = 6.671e-04 S  per = 8.15  per(accum) = 55.1
 T(local opt: qops memset on cpu           ) = 4.200e-08 S  per = 0.000513  per(accum) = 55.1
 T(local opt: preprocess_renorm_batchGPU   ) = 2.710e-03 S  per = 33.1  per(accum) = 88.2
 T(local opt: reduction of opS & opH [nccl]) = 5.940e-07 S  per = 0.00726  per(accum) = 88.2
 T(local opt: qops memcpy gpu2cpu          ) = 9.138e-05 S  per = 1.12  per(accum) = 89.3
 T(local opt: deallocate cpu and gpu memory) = 9.817e-06 S  per = 0.12  per(accum) = 89.5
 T(local opt: reduction of opS & opH [comm]) = 8.717e-05 S  per = 1.07  per(accum) = 90.5
 T(local opt: conversion from opAB to opPQ ) = 7.940e-05 S  per = 0.97  per(accum) = 91.5
 T(local opt: after oper_renorm            ) = 6.961e-04 S  per = 8.51  per(accum) = 100
##### sweep opt: 1.168e+00 S #####
 T(sweep opt: fetch) = 9.254e-02 S  per = 7.92  per(accum) = 7.92
 T(sweep opt: hdiag) = 8.035e-02 S  per = 6.88  per(accum) = 14.8
 T(sweep opt: dvdsn) = 7.540e-01 S  per = 64.6  per(accum) = 79.4
 T(sweep opt: decim) = 5.254e-02 S  per =  4.5  per(accum) = 83.9
 T(sweep opt: guess) = 1.838e-03 S  per = 0.157  per(accum) = 84
 T(sweep opt: renrm) = 1.220e-01 S  per = 10.4  per(accum) = 94.5
 T(sweep opt: save ) = 6.458e-02 S  per = 5.53  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.540e-01 S  T(sum) = 7.415e-01 S  per = 9.835e+01
 T(sweep opt: preprocess                  ) = 8.762e-03 S  per = 1.18  per(accum) = 1.18
 T(sweep opt: symbolic_formulae           ) = 1.623e-02 S  per = 2.19  per(accum) = 3.37
 T(sweep opt: hintermediate init          ) = 8.310e-03 S  per = 1.12  per(accum) = 4.49
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.981e-01 S  per = 40.2  per(accum) = 44.7
 T(sweep opt: hmmtasks init               ) = 5.056e-02 S  per = 6.82  per(accum) = 51.5
 T(sweep opt: initial guess for dvdson    ) = 3.290e-03 S  per = 0.444  per(accum) = 52
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 3.302e-01 S  per = 44.5  per(accum) = 96.5
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.549e-03 S  per = 0.344  per(accum) = 96.8
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 4.182e-06 S  per = 0.000564  per(accum) = 96.8
 T(sweep opt: dvdson solver [rest part]   ) = 2.355e-02 S  per = 3.18  per(accum) = 100
Detailed decomposition of T(renrm) = 1.220e-01 S  T(sum) = 1.220e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.727e-03 S  per = 1.41  per(accum) = 1.41
 T(sweep opt: qops init                    ) = 6.624e-03 S  per = 5.43  per(accum) = 6.84
 T(sweep opt: symbolic_formulae_renorm     ) = 7.453e-03 S  per = 6.11  per(accum) = 13
 T(sweep opt: allocate qops on gpu         ) = 1.350e-03 S  per = 1.11  per(accum) = 14.1
 T(sweep opt: site memcpy cpu2gpu          ) = 1.261e-03 S  per = 1.03  per(accum) = 15.1
 T(sweep opt: rintermediate init           ) = 6.725e-03 S  per = 5.51  per(accum) = 20.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.901e-02 S  per = 23.8  per(accum) = 44.4
 T(sweep opt: rmmtasks init                ) = 9.216e-03 S  per = 7.55  per(accum) = 51.9
 T(sweep opt: qops memset on cpu           ) = 7.140e-07 S  per = 0.000585  per(accum) = 51.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.846e-02 S  per = 31.5  per(accum) = 83.4
 T(sweep opt: reduction of opS & opH [nccl]) = 8.200e-06 S  per = 0.00672  per(accum) = 83.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.358e-03 S  per = 1.11  per(accum) = 84.6
 T(sweep opt: deallocate cpu and gpu memory) = 2.813e-04 S  per = 0.23  per(accum) = 84.8
 T(sweep opt: reduction of opS & opH [comm]) = 1.228e-03 S  per = 1.01  per(accum) = 85.8
 T(sweep opt: conversion from opAB to opPQ ) = 7.008e-03 S  per = 5.74  per(accum) = 91.5
 T(sweep opt: after oper_renorm            ) = 1.032e-02 S  per = 8.45  per(accum) = 100
##### global opt: 1.168e+00 S #####
 T(global opt: fetch) = 9.254e-02 S  per = 7.92  per(accum) = 7.92
 T(global opt: hdiag) = 8.035e-02 S  per = 6.88  per(accum) = 14.8
 T(global opt: dvdsn) = 7.540e-01 S  per = 64.6  per(accum) = 79.4
 T(global opt: decim) = 5.254e-02 S  per =  4.5  per(accum) = 83.9
 T(global opt: guess) = 1.838e-03 S  per = 0.157  per(accum) = 84
 T(global opt: renrm) = 1.220e-01 S  per = 10.4  per(accum) = 94.5
 T(global opt: save ) = 6.458e-02 S  per = 5.53  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.540e-01 S  T(sum) = 7.415e-01 S  per = 9.835e+01
 T(global opt: preprocess                  ) = 8.762e-03 S  per = 1.18  per(accum) = 1.18
 T(global opt: symbolic_formulae           ) = 1.623e-02 S  per = 2.19  per(accum) = 3.37
 T(global opt: hintermediate init          ) = 8.310e-03 S  per = 1.12  per(accum) = 4.49
 T(global opt: preprocess_hformulae_Hxlist ) = 2.981e-01 S  per = 40.2  per(accum) = 44.7
 T(global opt: hmmtasks init               ) = 5.056e-02 S  per = 6.82  per(accum) = 51.5
 T(global opt: initial guess for dvdson    ) = 3.290e-03 S  per = 0.444  per(accum) = 52
 T(global opt: dvdson solver [Hx_batchGPU] ) = 3.302e-01 S  per = 44.5  per(accum) = 96.5
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.549e-03 S  per = 0.344  per(accum) = 96.8
 T(global opt: dvdson solver [comm(cpu)]   ) = 4.182e-06 S  per = 0.000564  per(accum) = 96.8
 T(global opt: dvdson solver [rest part]   ) = 2.355e-02 S  per = 3.18  per(accum) = 100
Detailed decomposition of T(renrm) = 1.220e-01 S  T(sum) = 1.220e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.727e-03 S  per = 1.41  per(accum) = 1.41
 T(global opt: qops init                    ) = 6.624e-03 S  per = 5.43  per(accum) = 6.84
 T(global opt: symbolic_formulae_renorm     ) = 7.453e-03 S  per = 6.11  per(accum) = 13
 T(global opt: allocate qops on gpu         ) = 1.350e-03 S  per = 1.11  per(accum) = 14.1
 T(global opt: site memcpy cpu2gpu          ) = 1.261e-03 S  per = 1.03  per(accum) = 15.1
 T(global opt: rintermediate init           ) = 6.725e-03 S  per = 5.51  per(accum) = 20.6
 T(global opt: preprocess_formulae_Rlist2   ) = 2.901e-02 S  per = 23.8  per(accum) = 44.4
 T(global opt: rmmtasks init                ) = 9.216e-03 S  per = 7.55  per(accum) = 51.9
 T(global opt: qops memset on cpu           ) = 7.140e-07 S  per = 0.000585  per(accum) = 51.9
 T(global opt: preprocess_renorm_batchGPU   ) = 3.846e-02 S  per = 31.5  per(accum) = 83.4
 T(global opt: reduction of opS & opH [nccl]) = 8.200e-06 S  per = 0.00672  per(accum) = 83.5
 T(global opt: qops memcpy gpu2cpu          ) = 1.358e-03 S  per = 1.11  per(accum) = 84.6
 T(global opt: deallocate cpu and gpu memory) = 2.813e-04 S  per = 0.23  per(accum) = 84.8
 T(global opt: reduction of opS & opH [comm]) = 1.228e-03 S  per = 1.01  per(accum) = 85.8
 T(global opt: conversion from opAB to opPQ ) = 7.008e-03 S  per = 5.74  per(accum) = 91.5
 T(global opt: after oper_renorm            ) = 1.032e-02 S  per = 8.45  per(accum) = 100

isweep=0 ibond=14/seqsize=34 dots=2 dbond=(15,0)-(16,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.275e+01GB RSS:5.787e-01GB  Timing: User:2.600e+01S Sys:1.157e+00S Total:2.716e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=603:4.601e-03MB:4.493e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=627:4.784e-03MB:4.672e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=15,3,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 13 14 15
 suppc1= 11
 suppc2= 12
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:15 S:5 H:1 P:25 Q:30 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=1425:1.087e-02MB:1.062e-05GB
 rqops: oplist=CSHAB nops=C:3 S:17 H:1 A:9 B:12 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=105:8.011e-04MB:7.823e-07GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=3526:2.690e-02MB:2.627e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(15,0) fdel=./scratch/sweep/rop(16,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=57:4.349e-04MB
qtensor4: wf4 own=1 _data=0x55a31ea09750
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (23,3):3 (24,2):2 (24,4):2 (22,2):1 (23,1):1 (25,3):1
 qbond: qcol nsym=2 dimAll=3
 (3,3):1 (4,2):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=192 size=57:4.349e-04MB
### DIAG TIMING: total=1.649e-03 t1=9.002e-06, t2=1.438e-05, t3=1.763e-05, t4=1.581e-03, t5=4.590e-06, t6=1.774e-05, t7=4.179e-06
duration_diagGPU:1.728e-03
duration_diagreduce:2.800e-08
duration_diagtransform:2.130e-07
----- TIMING FOR symbolic_formulae_twodot with size=372 : 6.100e-04 S -----
rank=0 GPUmem(GB): used=2.63e-05 (oper)=2.63e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=372
 no. of hintermediate operators=217
 no. of coefficients=1722:0.0131MB:1.28e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.370e-04 S -----
rank=0 GPUmem(GB): used=3.91e-05 (oper,hinter)=2.63e-05,1.28e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0136 S size(H_formulae)=372 size(Hxlst2)=21 T(Hmu/Hxlist)=0.000128,0.0135 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0139 S size(H_formulae)=372 size(Hxlst)=8768 -----
rank=0 GPUmem(GB): used=0.00128 (oper,hinter,dvdson,batch)=2.63e-05,1.28e-05,8.49e-07,0.00124 blksize=6 blksize0=6 batchsize=8768
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=57 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3e-05,0.00016,0.000887,0.000764,0.00185
 ndim=57:4.25e-07GB t[comm(intra)]=2.27e-05 speed=0.0374GB/S t[comm(inter)]=7.31e-06 speed=0.116GB/S
--- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=8.9e-04 t_reduction=7.6e-04 tot=1.8e-03 ---
 sigma[inter] counter=90 t=1.6e-04 per=8.8e+00 cost=2.4e+05 flops=1.5e+09
 sigma[gemm] counter=90 i=0 t=2.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=3 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=4 t=2.0e-04 per=1.1e+01 cost=3.2e+04 flops=1.6e+08
 sigma[gemm] counter=90 i=5 t=2.1e-04 per=1.1e+01 cost=3.2e+04 flops=1.5e+08
 sigma[gemm] counter=90 i=6 t=2.4e-04 per=1.4e+01 cost=4.2e+04 flops=1.7e+08
 sigma[gemm] counter=90 i=7 t=2.3e-04 per=1.3e+01 cost=3.8e+04 flops=1.6e+08
 sigma[gemm] counter=90 total t=8.9e-04 per=4.9e+01 cost=1.4e+05 flops=1.6e+08
 sigma[red] counter=90 t=7.6e-04 per=4.2e+01 cost=5.0e+04 flops=6.6e+07
--- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=7.2e-02 t_reduction=6.5e-02 tot=1.5e-01 ---
 sigma_tot[inter] counter=90 t=1.5e-02 per=9.6e+00 cost=7.5e+07 flops=5.2e+09
 sigma_tot[gemm] counter=90 i=0 t=2.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=1 t=2.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=2 t=2.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=3 t=2.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=4 t=1.7e-02 per=1.1e+01 cost=1.5e+07 flops=9.0e+08
 sigma_tot[gemm] counter=90 i=5 t=1.9e-02 per=1.3e+01 cost=1.5e+07 flops=8.0e+08
 sigma_tot[gemm] counter=90 i=6 t=1.8e-02 per=1.2e+01 cost=1.4e+07 flops=7.8e+08
 sigma_tot[gemm] counter=90 i=7 t=1.8e-02 per=1.2e+01 cost=1.5e+07 flops=8.5e+08
 sigma_tot[gemm] counter=90 total t=7.2e-02 per=4.7e+01 cost=5.9e+07 flops=8.2e+08
 sigma_tot[red] counter=90 t=6.5e-02 per=4.3e+01 cost=1.4e+07 flops=2.1e+08
T(sub)=7.9e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,2.9e-06,9.7e-07,8.9e-07,2.2e-07
settings: ndim=57 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.301456576461 -1.116e+03  3.490e-02    1     1  4.020e-03 4.020e-03 3.848e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.728e-05,1.259e-04,6.611e-04,7.138e-04,1.533e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.165e-05 speed=3.923e-02GB/S t[comm(inter)]=5.627e-06 speed=1.509e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=6.6e-04 t_reduction=7.1e-04 tot=1.5e-03 ---
 sigma[inter] counter=91 t=1.3e-04 per=8.4e+00 cost=2.4e+05 flops=1.9e+09
 sigma[gemm] counter=91 i=0 t=2.3e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=1 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=4 t=1.5e-04 per=9.8e+00 cost=3.2e+04 flops=2.2e+08
 sigma[gemm] counter=91 i=5 t=1.4e-04 per=9.4e+00 cost=3.2e+04 flops=2.2e+08
 sigma[gemm] counter=91 i=6 t=1.9e-04 per=1.3e+01 cost=4.2e+04 flops=2.2e+08
 sigma[gemm] counter=91 i=7 t=1.7e-04 per=1.2e+01 cost=3.8e+04 flops=2.2e+08
 sigma[gemm] counter=91 total t=6.6e-04 per=4.4e+01 cost=1.4e+05 flops=2.2e+08
 sigma[red] counter=91 t=7.1e-04 per=4.8e+01 cost=5.0e+04 flops=7.0e+07
--- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=7.2e-02 t_reduction=6.6e-02 tot=1.5e-01 ---
 sigma_tot[inter] counter=91 t=1.5e-02 per=9.6e+00 cost=7.6e+07 flops=5.2e+09
 sigma_tot[gemm] counter=91 i=0 t=2.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=1 t=2.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=2 t=2.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=3 t=2.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=4 t=1.7e-02 per=1.1e+01 cost=1.5e+07 flops=8.9e+08
 sigma_tot[gemm] counter=91 i=5 t=1.9e-02 per=1.2e+01 cost=1.5e+07 flops=7.9e+08
 sigma_tot[gemm] counter=91 i=6 t=1.8e-02 per=1.2e+01 cost=1.4e+07 flops=7.8e+08
 sigma_tot[gemm] counter=91 i=7 t=1.8e-02 per=1.2e+01 cost=1.5e+07 flops=8.4e+08
 sigma_tot[gemm] counter=91 total t=7.2e-02 per=4.7e+01 cost=5.9e+07 flops=8.1e+08
 sigma_tot[red] counter=91 t=6.6e-02 per=4.3e+01 cost=1.4e+07 flops=2.1e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.0e-05,2.3e-06,9.5e-07,2.5e-07
    2   0 -    -116.306474424740 -5.018e-03  1.734e-02    2     2  7.968e-03 3.984e-03 3.655e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.720e-05,1.192e-04,6.558e-04,7.214e-04,1.528e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.177e-05 speed=3.902e-02GB/S t[comm(inter)]=5.435e-06 speed=1.563e-01GB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=6.6e-04 t_reduction=7.2e-04 tot=1.5e-03 ---
 sigma[inter] counter=92 t=1.2e-04 per=8.0e+00 cost=2.4e+05 flops=2.0e+09
 sigma[gemm] counter=92 i=0 t=2.4e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=1 t=2.3e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=4 t=1.5e-04 per=9.7e+00 cost=3.2e+04 flops=2.2e+08
 sigma[gemm] counter=92 i=5 t=1.4e-04 per=9.5e+00 cost=3.2e+04 flops=2.2e+08
 sigma[gemm] counter=92 i=6 t=1.8e-04 per=1.2e+01 cost=4.2e+04 flops=2.3e+08
 sigma[gemm] counter=92 i=7 t=1.7e-04 per=1.2e+01 cost=3.8e+04 flops=2.2e+08
 sigma[gemm] counter=92 total t=6.6e-04 per=4.4e+01 cost=1.4e+05 flops=2.2e+08
 sigma[red] counter=92 t=7.2e-04 per=4.8e+01 cost=5.0e+04 flops=6.9e+07
--- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=7.3e-02 t_reduction=6.6e-02 tot=1.5e-01 ---
 sigma_tot[inter] counter=92 t=1.5e-02 per=9.6e+00 cost=7.6e+07 flops=5.1e+09
 sigma_tot[gemm] counter=92 i=0 t=2.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=1 t=2.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=2 t=2.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=3 t=2.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=4 t=1.7e-02 per=1.1e+01 cost=1.5e+07 flops=8.9e+08
 sigma_tot[gemm] counter=92 i=5 t=1.9e-02 per=1.2e+01 cost=1.5e+07 flops=7.9e+08
 sigma_tot[gemm] counter=92 i=6 t=1.8e-02 per=1.2e+01 cost=1.4e+07 flops=7.7e+08
 sigma_tot[gemm] counter=92 i=7 t=1.8e-02 per=1.2e+01 cost=1.5e+07 flops=8.4e+08
 sigma_tot[gemm] counter=92 total t=7.3e-02 per=4.7e+01 cost=5.9e+07 flops=8.1e+08
 sigma_tot[red] counter=92 t=6.6e-02 per=4.3e+01 cost=1.4e+07 flops=2.1e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.3e-05,1.8e-06,8.8e-07,1.7e-07
    3   0 -    -116.307204522826 -7.301e-04  5.966e-03    3     3  1.163e-02 3.875e-03 3.597e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.767e-05,1.216e-04,6.724e-04,7.155e-04,1.541e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.216e-05 speed=3.834e-02GB/S t[comm(inter)]=5.517e-06 speed=1.540e-01GB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=6.7e-04 t_reduction=7.2e-04 tot=1.5e-03 ---
 sigma[inter] counter=93 t=1.2e-04 per=8.1e+00 cost=2.4e+05 flops=2.0e+09
 sigma[gemm] counter=93 i=0 t=2.7e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=1 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=4 t=1.4e-04 per=9.1e+00 cost=3.2e+04 flops=2.3e+08
 sigma[gemm] counter=93 i=5 t=1.4e-04 per=9.6e+00 cost=3.2e+04 flops=2.2e+08
 sigma[gemm] counter=93 i=6 t=1.9e-04 per=1.3e+01 cost=4.2e+04 flops=2.2e+08
 sigma[gemm] counter=93 i=7 t=1.9e-04 per=1.3e+01 cost=3.8e+04 flops=2.0e+08
 sigma[gemm] counter=93 total t=6.7e-04 per=4.5e+01 cost=1.4e+05 flops=2.1e+08
 sigma[red] counter=93 t=7.2e-04 per=4.7e+01 cost=5.0e+04 flops=7.0e+07
--- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=7.4e-02 t_reduction=6.7e-02 tot=1.6e-01 ---
 sigma_tot[inter] counter=93 t=1.5e-02 per=9.5e+00 cost=7.6e+07 flops=5.1e+09
 sigma_tot[gemm] counter=93 i=0 t=2.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=1 t=2.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=2 t=2.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=3 t=2.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=4 t=1.7e-02 per=1.1e+01 cost=1.5e+07 flops=8.8e+08
 sigma_tot[gemm] counter=93 i=5 t=1.9e-02 per=1.2e+01 cost=1.5e+07 flops=7.8e+08
 sigma_tot[gemm] counter=93 i=6 t=1.8e-02 per=1.2e+01 cost=1.4e+07 flops=7.7e+08
 sigma_tot[gemm] counter=93 i=7 t=1.8e-02 per=1.2e+01 cost=1.5e+07 flops=8.3e+08
 sigma_tot[gemm] counter=93 total t=7.4e-02 per=4.7e+01 cost=5.9e+07 flops=8.0e+08
 sigma_tot[red] counter=93 t=6.7e-02 per=4.3e+01 cost=1.4e+07 flops=2.1e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.1e-05,1.7e-06,9.0e-07,1.6e-07
    4   0 -    -116.307292153216 -8.763e-05  2.234e-03    3     4  1.532e-02 3.830e-03 3.575e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.732e-05,1.259e-04,6.507e-04,7.178e-04,1.526e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.190e-05 speed=3.879e-02GB/S t[comm(inter)]=5.423e-06 speed=1.566e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=6.5e-04 t_reduction=7.2e-04 tot=1.5e-03 ---
 sigma[inter] counter=94 t=1.3e-04 per=8.4e+00 cost=2.4e+05 flops=1.9e+09
 sigma[gemm] counter=94 i=0 t=2.7e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=1 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=4 t=1.4e-04 per=9.5e+00 cost=3.2e+04 flops=2.3e+08
 sigma[gemm] counter=94 i=5 t=1.4e-04 per=9.3e+00 cost=3.2e+04 flops=2.3e+08
 sigma[gemm] counter=94 i=6 t=1.8e-04 per=1.2e+01 cost=4.2e+04 flops=2.3e+08
 sigma[gemm] counter=94 i=7 t=1.8e-04 per=1.2e+01 cost=3.8e+04 flops=2.1e+08
 sigma[gemm] counter=94 total t=6.5e-04 per=4.4e+01 cost=1.4e+05 flops=2.2e+08
 sigma[red] counter=94 t=7.2e-04 per=4.8e+01 cost=5.0e+04 flops=7.0e+07
--- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=7.4e-02 t_reduction=6.8e-02 tot=1.6e-01 ---
 sigma_tot[inter] counter=94 t=1.5e-02 per=9.5e+00 cost=7.6e+07 flops=5.1e+09
 sigma_tot[gemm] counter=94 i=0 t=2.4e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=1 t=2.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=2 t=2.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=3 t=2.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=4 t=1.7e-02 per=1.1e+01 cost=1.5e+07 flops=8.8e+08
 sigma_tot[gemm] counter=94 i=5 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.8e+08
 sigma_tot[gemm] counter=94 i=6 t=1.9e-02 per=1.2e+01 cost=1.4e+07 flops=7.6e+08
 sigma_tot[gemm] counter=94 i=7 t=1.8e-02 per=1.2e+01 cost=1.5e+07 flops=8.2e+08
 sigma_tot[gemm] counter=94 total t=7.4e-02 per=4.7e+01 cost=5.9e+07 flops=8.0e+08
 sigma_tot[red] counter=94 t=6.8e-02 per=4.3e+01 cost=1.4e+07 flops=2.0e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.1e-05,1.7e-06,8.7e-07,1.4e-07
    5   0 -    -116.307302063452 -9.910e-06  5.918e-04    3     5  1.910e-02 3.820e-03 3.578e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.717e-05,1.201e-04,6.589e-04,7.125e-04,1.523e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.203e-05 speed=3.855e-02GB/S t[comm(inter)]=5.135e-06 speed=1.654e-01GB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=6.6e-04 t_reduction=7.1e-04 tot=1.5e-03 ---
 sigma[inter] counter=95 t=1.2e-04 per=8.1e+00 cost=2.4e+05 flops=2.0e+09
 sigma[gemm] counter=95 i=0 t=2.4e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=1 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=4 t=1.4e-04 per=9.5e+00 cost=3.2e+04 flops=2.3e+08
 sigma[gemm] counter=95 i=5 t=1.4e-04 per=9.5e+00 cost=3.2e+04 flops=2.2e+08
 sigma[gemm] counter=95 i=6 t=1.8e-04 per=1.2e+01 cost=4.2e+04 flops=2.3e+08
 sigma[gemm] counter=95 i=7 t=1.9e-04 per=1.3e+01 cost=3.8e+04 flops=2.0e+08
 sigma[gemm] counter=95 total t=6.6e-04 per=4.4e+01 cost=1.4e+05 flops=2.2e+08
 sigma[red] counter=95 t=7.1e-04 per=4.8e+01 cost=5.0e+04 flops=7.0e+07
--- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=7.5e-02 t_reduction=6.9e-02 tot=1.6e-01 ---
 sigma_tot[inter] counter=95 t=1.5e-02 per=9.5e+00 cost=7.7e+07 flops=5.1e+09
 sigma_tot[gemm] counter=95 i=0 t=2.5e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=1 t=2.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=2 t=2.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=3 t=2.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=4 t=1.7e-02 per=1.1e+01 cost=1.5e+07 flops=8.7e+08
 sigma_tot[gemm] counter=95 i=5 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.7e+08
 sigma_tot[gemm] counter=95 i=6 t=1.9e-02 per=1.2e+01 cost=1.4e+07 flops=7.6e+08
 sigma_tot[gemm] counter=95 i=7 t=1.8e-02 per=1.2e+01 cost=1.5e+07 flops=8.2e+08
 sigma_tot[gemm] counter=95 total t=7.5e-02 per=4.7e+01 cost=6.0e+07 flops=7.9e+08
 sigma_tot[red] counter=95 t=6.9e-02 per=4.3e+01 cost=1.4e+07 flops=2.0e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,1.1e-05,1.6e-06,8.8e-07,1.8e-07
    6   0 -    -116.307302748026 -6.846e-07  1.732e-04    3     6  2.265e-02 3.775e-03 3.545e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.714e-05,1.178e-04,6.500e-04,7.058e-04,1.505e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.197e-05 speed=3.866e-02GB/S t[comm(inter)]=5.169e-06 speed=1.643e-01GB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=6.5e-04 t_reduction=7.1e-04 tot=1.5e-03 ---
 sigma[inter] counter=96 t=1.2e-04 per=8.0e+00 cost=2.4e+05 flops=2.1e+09
 sigma[gemm] counter=96 i=0 t=2.4e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=1 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=4 t=1.4e-04 per=9.8e+00 cost=3.2e+04 flops=2.2e+08
 sigma[gemm] counter=96 i=5 t=1.4e-04 per=9.8e+00 cost=3.2e+04 flops=2.2e+08
 sigma[gemm] counter=96 i=6 t=1.8e-04 per=1.2e+01 cost=4.2e+04 flops=2.3e+08
 sigma[gemm] counter=96 i=7 t=1.7e-04 per=1.2e+01 cost=3.8e+04 flops=2.2e+08
 sigma[gemm] counter=96 total t=6.5e-04 per=4.4e+01 cost=1.4e+05 flops=2.2e+08
 sigma[red] counter=96 t=7.1e-04 per=4.8e+01 cost=5.0e+04 flops=7.1e+07
--- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=7.6e-02 t_reduction=6.9e-02 tot=1.6e-01 ---
 sigma_tot[inter] counter=96 t=1.5e-02 per=9.5e+00 cost=7.7e+07 flops=5.0e+09
 sigma_tot[gemm] counter=96 i=0 t=2.5e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=1 t=2.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=2 t=2.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=3 t=2.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=4 t=1.7e-02 per=1.1e+01 cost=1.5e+07 flops=8.7e+08
 sigma_tot[gemm] counter=96 i=5 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.7e+08
 sigma_tot[gemm] counter=96 i=6 t=1.9e-02 per=1.2e+01 cost=1.4e+07 flops=7.5e+08
 sigma_tot[gemm] counter=96 i=7 t=1.9e-02 per=1.2e+01 cost=1.5e+07 flops=8.1e+08
 sigma_tot[gemm] counter=96 total t=7.6e-02 per=4.7e+01 cost=6.0e+07 flops=7.9e+08
 sigma_tot[red] counter=96 t=6.9e-02 per=4.3e+01 cost=1.4e+07 flops=2.0e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.0e-05,1.8e-06,8.6e-07,1.4e-07
    7   0 +    -116.307302820366 -7.234e-08  5.927e-05    3     7  2.623e-02 3.747e-03 3.524e-03
TIMING FOR Davidson : 2.631e-02  T(cal/comm/rest)=2.467e-02,2.750e-07,1.643e-03
decomposed t_rest=1.643e-03
 T(sub)    =1.132e-04 per=6.892e+00
 T(precond)=1.416e-04 per=8.619e+00
 T(ortho)  =8.765e-06 per=5.335e-01
 T(xcopy)  =7.830e-07 per=4.766e-02
 T(xnrm2)  =1.059e-06 per=6.446e-02
 T(other)  =1.378e-03 per=8.384e+01
optimized energies: isweep=0 ibond=14 dots=2 e[0]=-116.307302820366 nmvp=7
CPUmem: VM:7.275e+01GB RSS:5.787e-01GB  Timing: User:2.733e+01S Sys:1.157e+00S Total:2.848e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond14.txt
 qbond: qsuper nsym=12 dimAll=40
 (23,3):4 (25,3):8 (24,2):7 (24,4):5 (26,2):3 (25,1):3 (26,4):3 (25,5):2 (22,2):1 (23,1):2 (24,0):1 (27,3):1
----- TMING FOR decimation_genbasis(su2): 8.0e-05 S -----
decimation summary: 40->10 dwt=+6.494e-06 SvN=7.273e-01
 qbond: qkept nsym=6 dimAll=10
 (25,3):3 (24,2):2 (26,2):2 (25,1):1 (26,4):1 (27,3):1
----- TIMING for decimation_row(nkr): 3.284e-03 S T(decim/select/formRot)=3.892e-04,2.744e-03,1.508e-04 -----
----- TIMING FOR twodot_decimation: 3.481e-03 S T(wf/decim)=1.216e-04,3.359e-03 -----
ctns::oper_renorm coord=(15,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:16 S:4 H:1 P:16 Q:20 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1090:8.316e-03MB:8.121e-06GB
CPUmem: VM:7.275e+01GB RSS:5.787e-01GB  Timing: User:2.756e+01S Sys:1.157e+00S Total:2.872e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=57 : 2.683e-04 S -----
rank=0 GPUmem(GB): used=4.64e-05 (oper)=2.62e-05
rank=0 GPUmem(GB): used=4.68e-05 (oper,site)(GB)=2.62e-05,3.8e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=57
 no. of rintermediate operators=68
 no. of coefficients=1020:0.00778MB:7.6e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.005e-04 S -----
rank=0 GPUmem(GB): used=5.44e-05 (oper,site,rinter)=2.62e-05,3.8e-07,7.6e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00207 S size(rtasks)=57 size(Rlst2)=36 T(Rmu/Rlist)=6.7e-05,0.002 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0022 S size(rtasks)=57 size(Rlst)=2557 -----
rank=0 GPUmem(GB): used=5.44e-05 (oper,site,rinter,batch)=2.62e-05,3.8e-07,7.6e-06,0.000476 blksize=9 blksize0=6 batchsize=2557
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000119,0.00085,0.00032
--- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=8.5e-04 t_reduction=3.2e-04 tot=1.3e-03 ---
 renorm[inter] counter=15 t=1.2e-04 per=9.2e+00 cost=6.9e+04 flops=5.9e+08
 renorm[gemm] counter=15 i=0 t=2.8e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=1 t=2.3e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=2 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=3 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=15 i=4 t=2.7e-04 per=2.1e+01 cost=1.0e+04 flops=3.8e+07
 renorm[gemm] counter=15 i=5 t=2.8e-04 per=2.2e+01 cost=1.9e+04 flops=6.7e+07
 renorm[gemm] counter=15 i=6 t=2.8e-04 per=2.2e+01 cost=4.1e+04 flops=1.4e+08
 renorm[gemm] counter=15 total t=8.5e-04 per=6.6e+01 cost=7.0e+04 flops=8.3e+07
 renorm[red] counter=15 t=3.2e-04 per=2.5e+01 cost=2.2e+04 flops=6.9e+07
--- TIMING FOR renorm_tot : t_inter=1.9e-03 t_gemm=9.3e-03 t_reduction=3.5e-03 tot=1.5e-02 ---
 renorm_tot[inter] counter=15 t=1.9e-03 per=1.3e+01 cost=1.4e+06 flops=7.4e+08
 renorm_tot[gemm] counter=15 i=0 t=4.2e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=1 t=3.4e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=2 t=3.3e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=3 t=3.3e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=15 i=4 t=3.0e-03 per=2.1e+01 cost=2.0e+05 flops=6.5e+07
 renorm_tot[gemm] counter=15 i=5 t=3.0e-03 per=2.1e+01 cost=5.1e+05 flops=1.7e+08
 renorm_tot[gemm] counter=15 i=6 t=3.1e-03 per=2.1e+01 cost=9.2e+05 flops=2.9e+08
 renorm_tot[gemm] counter=15 total t=9.3e-03 per=6.4e+01 cost=1.6e+06 flops=1.7e+08
 renorm_tot[red] counter=15 t=3.5e-03 per=2.4e+01 cost=4.0e+05 flops=1.1e+08
qops.to_cpu: size(tot)=1090:8.3e-03MB:8.1e-06GB t[to_cpu]=1.7e-05S speed=4.8e-01GB/S
check ||H-H.dagger||=5.896e-15 coord=(15,0) rank=0
ctns::oper_ab2pq coord=(15,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00761 S rank=0 -----
CPUmem: VM:7.275e+01GB RSS:5.787e-01GB  Timing: User:2.777e+01S Sys:1.157e+00S Total:2.893e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=648:4.944e-03MB:4.828e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=672:5.127e-03MB:5.007e-06GB
CPUmem: VM:7.275e+01GB RSS:5.787e-01GB  Timing: User:2.777e+01S Sys:1.157e+00S Total:2.893e+01S
##### local opt: 7.064e-02 S #####
 T(local opt: fetch) = 6.240e-03 S  per = 8.83  per(accum) = 8.83
 T(local opt: hdiag) = 2.672e-03 S  per = 3.78  per(accum) = 12.6
 T(local opt: dvdsn) = 4.529e-02 S  per = 64.1  per(accum) = 76.7
 T(local opt: decim) = 3.558e-03 S  per = 5.04  per(accum) = 81.8
 T(local opt: guess) = 7.131e-05 S  per = 0.101  per(accum) = 81.9
 T(local opt: renrm) = 8.483e-03 S  per =   12  per(accum) = 93.9
 T(local opt: save ) = 4.328e-03 S  per = 6.13  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.529e-02 S  T(sum) = 4.452e-02 S  per = 9.830e+01
 T(local opt: preprocess                  ) = 4.755e-04 S  per = 1.07  per(accum) = 1.07
 T(local opt: symbolic_formulae           ) = 6.894e-04 S  per = 1.55  per(accum) = 2.62
 T(local opt: hintermediate init          ) = 5.635e-04 S  per = 1.27  per(accum) = 3.88
 T(local opt: preprocess_hformulae_Hxlist ) = 1.396e-02 S  per = 31.4  per(accum) = 35.2
 T(local opt: hmmtasks init               ) = 2.333e-03 S  per = 5.24  per(accum) = 40.5
 T(local opt: initial guess for dvdson    ) = 1.873e-04 S  per = 0.421  per(accum) = 40.9
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.447e-02 S  per =   55  per(accum) = 95.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.938e-04 S  per = 0.435  per(accum) = 96.3
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.750e-07 S  per = 0.000618  per(accum) = 96.3
 T(local opt: dvdson solver [rest part]   ) = 1.643e-03 S  per = 3.69  per(accum) = 100
Detailed decomposition of T(renrm) = 8.483e-03 S  T(sum) = 8.483e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.174e-04 S  per = 1.38  per(accum) = 1.38
 T(local opt: qops init                    ) = 4.578e-04 S  per =  5.4  per(accum) = 6.78
 T(local opt: symbolic_formulae_renorm     ) = 3.416e-04 S  per = 4.03  per(accum) = 10.8
 T(local opt: allocate qops on gpu         ) = 8.594e-05 S  per = 1.01  per(accum) = 11.8
 T(local opt: site memcpy cpu2gpu          ) = 7.922e-05 S  per = 0.934  per(accum) = 12.8
 T(local opt: rintermediate init           ) = 4.509e-04 S  per = 5.32  per(accum) = 18.1
 T(local opt: preprocess_formulae_Rlist2   ) = 2.292e-03 S  per =   27  per(accum) = 45.1
 T(local opt: rmmtasks init                ) = 7.388e-04 S  per = 8.71  per(accum) = 53.8
 T(local opt: qops memset on cpu           ) = 5.900e-08 S  per = 0.000696  per(accum) = 53.8
 T(local opt: preprocess_renorm_batchGPU   ) = 2.977e-03 S  per = 35.1  per(accum) = 88.9
 T(local opt: reduction of opS & opH [nccl]) = 5.450e-07 S  per = 0.00642  per(accum) = 88.9
 T(local opt: qops memcpy gpu2cpu          ) = 9.159e-05 S  per = 1.08  per(accum) = 90
 T(local opt: deallocate cpu and gpu memory) = 9.525e-06 S  per = 0.112  per(accum) = 90.1
 T(local opt: reduction of opS & opH [comm]) = 8.804e-05 S  per = 1.04  per(accum) = 91.1
 T(local opt: conversion from opAB to opPQ ) = 7.264e-05 S  per = 0.856  per(accum) = 92
 T(local opt: after oper_renorm            ) = 6.795e-04 S  per = 8.01  per(accum) = 100
##### sweep opt: 1.238e+00 S #####
 T(sweep opt: fetch) = 9.878e-02 S  per = 7.98  per(accum) = 7.98
 T(sweep opt: hdiag) = 8.302e-02 S  per =  6.7  per(accum) = 14.7
 T(sweep opt: dvdsn) = 7.993e-01 S  per = 64.5  per(accum) = 79.2
 T(sweep opt: decim) = 5.610e-02 S  per = 4.53  per(accum) = 83.7
 T(sweep opt: guess) = 1.909e-03 S  per = 0.154  per(accum) = 83.9
 T(sweep opt: renrm) = 1.305e-01 S  per = 10.5  per(accum) = 94.4
 T(sweep opt: save ) = 6.890e-02 S  per = 5.56  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.993e-01 S  T(sum) = 7.860e-01 S  per = 9.834e+01
 T(sweep opt: preprocess                  ) = 9.237e-03 S  per = 1.18  per(accum) = 1.18
 T(sweep opt: symbolic_formulae           ) = 1.692e-02 S  per = 2.15  per(accum) = 3.33
 T(sweep opt: hintermediate init          ) = 8.873e-03 S  per = 1.13  per(accum) = 4.46
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.120e-01 S  per = 39.7  per(accum) = 44.2
 T(sweep opt: hmmtasks init               ) = 5.289e-02 S  per = 6.73  per(accum) = 50.9
 T(sweep opt: initial guess for dvdson    ) = 3.477e-03 S  per = 0.442  per(accum) = 51.3
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 3.546e-01 S  per = 45.1  per(accum) = 96.4
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.743e-03 S  per = 0.349  per(accum) = 96.8
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 4.457e-06 S  per = 0.000567  per(accum) = 96.8
 T(sweep opt: dvdson solver [rest part]   ) = 2.519e-02 S  per =  3.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.305e-01 S  T(sum) = 1.305e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.844e-03 S  per = 1.41  per(accum) = 1.41
 T(sweep opt: qops init                    ) = 7.082e-03 S  per = 5.43  per(accum) = 6.84
 T(sweep opt: symbolic_formulae_renorm     ) = 7.794e-03 S  per = 5.97  per(accum) = 12.8
 T(sweep opt: allocate qops on gpu         ) = 1.436e-03 S  per =  1.1  per(accum) = 13.9
 T(sweep opt: site memcpy cpu2gpu          ) = 1.340e-03 S  per = 1.03  per(accum) = 14.9
 T(sweep opt: rintermediate init           ) = 7.176e-03 S  per =  5.5  per(accum) = 20.4
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.130e-02 S  per =   24  per(accum) = 44.4
 T(sweep opt: rmmtasks init                ) = 9.955e-03 S  per = 7.63  per(accum) = 52.1
 T(sweep opt: qops memset on cpu           ) = 7.730e-07 S  per = 0.000592  per(accum) = 52.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.143e-02 S  per = 31.7  per(accum) = 83.8
 T(sweep opt: reduction of opS & opH [nccl]) = 8.745e-06 S  per = 0.0067  per(accum) = 83.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.450e-03 S  per = 1.11  per(accum) = 84.9
 T(sweep opt: deallocate cpu and gpu memory) = 2.908e-04 S  per = 0.223  per(accum) = 85.1
 T(sweep opt: reduction of opS & opH [comm]) = 1.316e-03 S  per = 1.01  per(accum) = 86.1
 T(sweep opt: conversion from opAB to opPQ ) = 7.081e-03 S  per = 5.43  per(accum) = 91.6
 T(sweep opt: after oper_renorm            ) = 1.100e-02 S  per = 8.43  per(accum) = 100
##### global opt: 1.238e+00 S #####
 T(global opt: fetch) = 9.878e-02 S  per = 7.98  per(accum) = 7.98
 T(global opt: hdiag) = 8.302e-02 S  per =  6.7  per(accum) = 14.7
 T(global opt: dvdsn) = 7.993e-01 S  per = 64.5  per(accum) = 79.2
 T(global opt: decim) = 5.610e-02 S  per = 4.53  per(accum) = 83.7
 T(global opt: guess) = 1.909e-03 S  per = 0.154  per(accum) = 83.9
 T(global opt: renrm) = 1.305e-01 S  per = 10.5  per(accum) = 94.4
 T(global opt: save ) = 6.890e-02 S  per = 5.56  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.993e-01 S  T(sum) = 7.860e-01 S  per = 9.834e+01
 T(global opt: preprocess                  ) = 9.237e-03 S  per = 1.18  per(accum) = 1.18
 T(global opt: symbolic_formulae           ) = 1.692e-02 S  per = 2.15  per(accum) = 3.33
 T(global opt: hintermediate init          ) = 8.873e-03 S  per = 1.13  per(accum) = 4.46
 T(global opt: preprocess_hformulae_Hxlist ) = 3.120e-01 S  per = 39.7  per(accum) = 44.2
 T(global opt: hmmtasks init               ) = 5.289e-02 S  per = 6.73  per(accum) = 50.9
 T(global opt: initial guess for dvdson    ) = 3.477e-03 S  per = 0.442  per(accum) = 51.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 3.546e-01 S  per = 45.1  per(accum) = 96.4
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.743e-03 S  per = 0.349  per(accum) = 96.8
 T(global opt: dvdson solver [comm(cpu)]   ) = 4.457e-06 S  per = 0.000567  per(accum) = 96.8
 T(global opt: dvdson solver [rest part]   ) = 2.519e-02 S  per =  3.2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.305e-01 S  T(sum) = 1.305e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.844e-03 S  per = 1.41  per(accum) = 1.41
 T(global opt: qops init                    ) = 7.082e-03 S  per = 5.43  per(accum) = 6.84
 T(global opt: symbolic_formulae_renorm     ) = 7.794e-03 S  per = 5.97  per(accum) = 12.8
 T(global opt: allocate qops on gpu         ) = 1.436e-03 S  per =  1.1  per(accum) = 13.9
 T(global opt: site memcpy cpu2gpu          ) = 1.340e-03 S  per = 1.03  per(accum) = 14.9
 T(global opt: rintermediate init           ) = 7.176e-03 S  per =  5.5  per(accum) = 20.4
 T(global opt: preprocess_formulae_Rlist2   ) = 3.130e-02 S  per =   24  per(accum) = 44.4
 T(global opt: rmmtasks init                ) = 9.955e-03 S  per = 7.63  per(accum) = 52.1
 T(global opt: qops memset on cpu           ) = 7.730e-07 S  per = 0.000592  per(accum) = 52.1
 T(global opt: preprocess_renorm_batchGPU   ) = 4.143e-02 S  per = 31.7  per(accum) = 83.8
 T(global opt: reduction of opS & opH [nccl]) = 8.745e-06 S  per = 0.0067  per(accum) = 83.8
 T(global opt: qops memcpy gpu2cpu          ) = 1.450e-03 S  per = 1.11  per(accum) = 84.9
 T(global opt: deallocate cpu and gpu memory) = 2.908e-04 S  per = 0.223  per(accum) = 85.1
 T(global opt: reduction of opS & opH [comm]) = 1.316e-03 S  per = 1.01  per(accum) = 86.1
 T(global opt: conversion from opAB to opPQ ) = 7.081e-03 S  per = 5.43  per(accum) = 91.6
 T(global opt: after oper_renorm            ) = 1.100e-02 S  per = 8.43  per(accum) = 100

isweep=0 ibond=15/seqsize=34 dots=2 dbond=(16,0)-(17,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.275e+01GB RSS:5.787e-01GB  Timing: User:2.777e+01S Sys:1.157e+00S Total:2.893e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=648:4.944e-03MB:4.828e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=672:5.127e-03MB:5.007e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=16,2,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 14 15
 suppc1= 12
 suppc2= 13
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:16 S:4 H:1 P:16 Q:20 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1090:8.316e-03MB:8.121e-06GB
 rqops: oplist=CSHAB nops=C:2 S:18 H:1 A:4 B:6 
        dim(bra,ket)=3,3 size(op)=5:3.815e-05MB size(tot)=75:5.722e-04MB:5.588e-07GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=3161:2.412e-02MB:2.355e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(16,0) fdel=./scratch/sweep/rop(17,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=51:3.891e-04MB
qtensor4: wf4 own=1 _data=0x55a319c09ed0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (25,3):3 (24,2):2 (26,2):2 (25,1):1 (26,4):1 (27,3):1
 qbond: qcol nsym=2 dimAll=3
 (2,2):1 (3,1):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=192 size=51:3.891e-04MB
### DIAG TIMING: total=9.686e-04 t1=8.806e-06, t2=1.343e-05, t3=1.714e-05, t4=9.037e-04, t5=4.254e-06, t6=1.761e-05, t7=3.652e-06
duration_diagGPU:1.055e-03
duration_diagreduce:2.800e-08
duration_diagtransform:1.620e-07
----- TIMING FOR symbolic_formulae_twodot with size=321 : 5.056e-04 S -----
rank=0 GPUmem(GB): used=2.36e-05 (oper)=2.36e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=321
 no. of hintermediate operators=183
 no. of coefficients=1044:0.00797MB:7.78e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.491e-04 S -----
rank=0 GPUmem(GB): used=3.13e-05 (oper,hinter)=2.36e-05,7.78e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.012 S size(H_formulae)=321 size(Hxlst2)=21 T(Hmu/Hxlist)=0.000102,0.0119 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0123 S size(H_formulae)=321 size(Hxlst)=7764 -----
rank=0 GPUmem(GB): used=0.00113 (oper,hinter,dvdson,batch)=2.36e-05,7.78e-06,7.6e-07,0.0011 blksize=6 blksize0=6 batchsize=7764
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=51 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.17e-05,0.000171,0.000906,0.000778,0.00189
 ndim=51:3.8e-07GB t[comm(intra)]=2.46e-05 speed=0.0308GB/S t[comm(inter)]=7.03e-06 speed=0.108GB/S
--- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=9.1e-04 t_reduction=7.8e-04 tot=1.9e-03 ---
 sigma[inter] counter=97 t=1.7e-04 per=9.2e+00 cost=1.4e+05 flops=8.0e+08
 sigma[gemm] counter=97 i=0 t=2.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=3 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=4 t=1.8e-04 per=9.9e+00 cost=2.2e+04 flops=1.2e+08
 sigma[gemm] counter=97 i=5 t=1.9e-04 per=1.0e+01 cost=2.2e+04 flops=1.1e+08
 sigma[gemm] counter=97 i=6 t=2.5e-04 per=1.4e+01 cost=3.3e+04 flops=1.3e+08
 sigma[gemm] counter=97 i=7 t=2.7e-04 per=1.4e+01 cost=3.0e+04 flops=1.1e+08
 sigma[gemm] counter=97 total t=9.1e-04 per=4.9e+01 cost=1.1e+05 flops=1.2e+08
 sigma[red] counter=97 t=7.8e-04 per=4.2e+01 cost=3.9e+04 flops=5.0e+07
--- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=7.7e-02 t_reduction=7.0e-02 tot=1.6e-01 ---
 sigma_tot[inter] counter=97 t=1.5e-02 per=9.5e+00 cost=7.7e+07 flops=5.0e+09
 sigma_tot[gemm] counter=97 i=0 t=2.5e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=1 t=2.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=2 t=2.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=3 t=2.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=4 t=1.8e-02 per=1.1e+01 cost=1.5e+07 flops=8.6e+08
 sigma_tot[gemm] counter=97 i=5 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.6e+08
 sigma_tot[gemm] counter=97 i=6 t=1.9e-02 per=1.2e+01 cost=1.4e+07 flops=7.4e+08
 sigma_tot[gemm] counter=97 i=7 t=1.9e-02 per=1.2e+01 cost=1.5e+07 flops=8.0e+08
 sigma_tot[gemm] counter=97 total t=7.7e-02 per=4.7e+01 cost=6.0e+07 flops=7.8e+08
 sigma_tot[red] counter=97 t=7.0e-02 per=4.3e+01 cost=1.4e+07 flops=2.0e+08
T(sub)=7.9e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,3.0e-06,1.0e-06,8.8e-07,2.0e-07
settings: ndim=51 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.307298452327 -1.116e+03  3.154e-02    1     1  4.027e-03 4.027e-03 3.863e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.919e-05,1.346e-04,6.385e-04,7.002e-04,1.508e-03
 ndim=51:3.800e-07GB t[comm(intra)]=2.333e-05 speed=3.257e-02GB/S t[comm(inter)]=5.859e-06 speed=1.297e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=6.4e-04 t_reduction=7.0e-04 tot=1.5e-03 ---
 sigma[inter] counter=98 t=1.3e-04 per=9.1e+00 cost=1.4e+05 flops=1.0e+09
 sigma[gemm] counter=98 i=0 t=2.7e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=1 t=2.3e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=4 t=1.4e-04 per=9.2e+00 cost=2.2e+04 flops=1.6e+08
 sigma[gemm] counter=98 i=5 t=1.4e-04 per=9.3e+00 cost=2.2e+04 flops=1.6e+08
 sigma[gemm] counter=98 i=6 t=1.8e-04 per=1.2e+01 cost=3.3e+04 flops=1.9e+08
 sigma[gemm] counter=98 i=7 t=1.8e-04 per=1.2e+01 cost=3.0e+04 flops=1.6e+08
 sigma[gemm] counter=98 total t=6.4e-04 per=4.3e+01 cost=1.1e+05 flops=1.7e+08
 sigma[red] counter=98 t=7.0e-04 per=4.8e+01 cost=3.9e+04 flops=5.6e+07
--- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=7.7e-02 t_reduction=7.1e-02 tot=1.6e-01 ---
 sigma_tot[inter] counter=98 t=1.6e-02 per=9.5e+00 cost=7.7e+07 flops=5.0e+09
 sigma_tot[gemm] counter=98 i=0 t=2.5e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=1 t=2.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=2 t=2.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=3 t=2.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=4 t=1.8e-02 per=1.1e+01 cost=1.5e+07 flops=8.5e+08
 sigma_tot[gemm] counter=98 i=5 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.6e+08
 sigma_tot[gemm] counter=98 i=6 t=1.9e-02 per=1.2e+01 cost=1.4e+07 flops=7.4e+08
 sigma_tot[gemm] counter=98 i=7 t=1.9e-02 per=1.2e+01 cost=1.5e+07 flops=7.9e+08
 sigma_tot[gemm] counter=98 total t=7.7e-02 per=4.7e+01 cost=6.0e+07 flops=7.8e+08
 sigma_tot[red] counter=98 t=7.1e-02 per=4.3e+01 cost=1.4e+07 flops=2.0e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=6.1e-06,1.2e-05,2.5e-06,2.3e-06,2.3e-07
    2   0 -    -116.311083616854 -3.785e-03  1.515e-02    2     2  1.042e-02 5.211e-03 3.666e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.069e-05,1.994e-04,6.832e-04,7.174e-04,1.681e-03
 ndim=51:3.800e-07GB t[comm(intra)]=2.595e-05 speed=2.929e-02GB/S t[comm(inter)]=1.474e-05 speed=5.156e-02GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=6.8e-04 t_reduction=7.2e-04 tot=1.6e-03 ---
 sigma[inter] counter=99 t=2.0e-04 per=1.2e+01 cost=1.4e+05 flops=6.8e+08
 sigma[gemm] counter=99 i=0 t=2.7e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=1 t=2.2e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=2 t=2.2e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=3 t=2.2e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=4 t=1.4e-04 per=9.0e+00 cost=2.2e+04 flops=1.5e+08
 sigma[gemm] counter=99 i=5 t=1.5e-04 per=9.2e+00 cost=2.2e+04 flops=1.5e+08
 sigma[gemm] counter=99 i=6 t=1.9e-04 per=1.2e+01 cost=3.3e+04 flops=1.7e+08
 sigma[gemm] counter=99 i=7 t=1.9e-04 per=1.2e+01 cost=3.0e+04 flops=1.6e+08
 sigma[gemm] counter=99 total t=6.8e-04 per=4.3e+01 cost=1.1e+05 flops=1.6e+08
 sigma[red] counter=99 t=7.2e-04 per=4.5e+01 cost=3.9e+04 flops=5.5e+07
--- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=7.8e-02 t_reduction=7.1e-02 tot=1.7e-01 ---
 sigma_tot[inter] counter=99 t=1.6e-02 per=9.5e+00 cost=7.7e+07 flops=4.9e+09
 sigma_tot[gemm] counter=99 i=0 t=2.6e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=1 t=2.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=2 t=2.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=3 t=2.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=4 t=1.8e-02 per=1.1e+01 cost=1.5e+07 flops=8.5e+08
 sigma_tot[gemm] counter=99 i=5 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.6e+08
 sigma_tot[gemm] counter=99 i=6 t=2.0e-02 per=1.2e+01 cost=1.4e+07 flops=7.3e+08
 sigma_tot[gemm] counter=99 i=7 t=1.9e-02 per=1.2e+01 cost=1.5e+07 flops=7.9e+08
 sigma_tot[gemm] counter=99 total t=7.8e-02 per=4.7e+01 cost=6.0e+07 flops=7.7e+08
 sigma_tot[red] counter=99 t=7.1e-02 per=4.3e+01 cost=1.4e+07 flops=2.0e+08
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=9.1e-06,3.3e-05,1.8e-06,1.0e-06,1.9e-07
    3   0 -    -116.311472269527 -3.887e-04  2.220e-03    3     3  1.513e-02 5.043e-03 3.634e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.789e-05,1.303e-04,6.349e-04,6.988e-04,1.496e-03
 ndim=51:3.800e-07GB t[comm(intra)]=2.230e-05 speed=3.408e-02GB/S t[comm(inter)]=5.596e-06 speed=1.358e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=6.3e-04 t_reduction=7.0e-04 tot=1.5e-03 ---
 sigma[inter] counter=100 t=1.3e-04 per=8.9e+00 cost=1.4e+05 flops=1.0e+09
 sigma[gemm] counter=100 i=0 t=2.4e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=1 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=4 t=1.3e-04 per=9.1e+00 cost=2.2e+04 flops=1.7e+08
 sigma[gemm] counter=100 i=5 t=1.3e-04 per=9.2e+00 cost=2.2e+04 flops=1.6e+08
 sigma[gemm] counter=100 i=6 t=1.8e-04 per=1.2e+01 cost=3.3e+04 flops=1.9e+08
 sigma[gemm] counter=100 i=7 t=1.8e-04 per=1.2e+01 cost=3.0e+04 flops=1.6e+08
 sigma[gemm] counter=100 total t=6.3e-04 per=4.3e+01 cost=1.1e+05 flops=1.7e+08
 sigma[red] counter=100 t=7.0e-04 per=4.8e+01 cost=3.9e+04 flops=5.6e+07
--- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=7.9e-02 t_reduction=7.2e-02 tot=1.7e-01 ---
 sigma_tot[inter] counter=100 t=1.6e-02 per=9.5e+00 cost=7.7e+07 flops=4.9e+09
 sigma_tot[gemm] counter=100 i=0 t=2.6e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=1 t=2.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=2 t=2.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=3 t=2.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=4 t=1.8e-02 per=1.1e+01 cost=1.5e+07 flops=8.4e+08
 sigma_tot[gemm] counter=100 i=5 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.5e+08
 sigma_tot[gemm] counter=100 i=6 t=2.0e-02 per=1.2e+01 cost=1.4e+07 flops=7.3e+08
 sigma_tot[gemm] counter=100 i=7 t=1.9e-02 per=1.2e+01 cost=1.5e+07 flops=7.8e+08
 sigma_tot[gemm] counter=100 total t=7.9e-02 per=4.7e+01 cost=6.0e+07 flops=7.7e+08
 sigma_tot[red] counter=100 t=7.2e-02 per=4.3e+01 cost=1.4e+07 flops=2.0e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.1e-05,1.7e-06,9.0e-07,1.2e-07
    4   0 -    -116.311486264161 -1.399e-05  7.097e-04    3     4  1.878e-02 4.695e-03 3.591e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.767e-05,1.267e-04,6.443e-04,7.118e-04,1.515e-03
 ndim=51:3.800e-07GB t[comm(intra)]=2.219e-05 speed=3.425e-02GB/S t[comm(inter)]=5.478e-06 speed=1.387e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=6.4e-04 t_reduction=7.1e-04 tot=1.5e-03 ---
 sigma[inter] counter=101 t=1.3e-04 per=8.5e+00 cost=1.4e+05 flops=1.1e+09
 sigma[gemm] counter=101 i=0 t=2.3e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=1 t=2.3e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=4 t=1.3e-04 per=9.0e+00 cost=2.2e+04 flops=1.6e+08
 sigma[gemm] counter=101 i=5 t=1.3e-04 per=9.0e+00 cost=2.2e+04 flops=1.6e+08
 sigma[gemm] counter=101 i=6 t=1.8e-04 per=1.2e+01 cost=3.3e+04 flops=1.8e+08
 sigma[gemm] counter=101 i=7 t=1.8e-04 per=1.2e+01 cost=3.0e+04 flops=1.6e+08
 sigma[gemm] counter=101 total t=6.4e-04 per=4.3e+01 cost=1.1e+05 flops=1.7e+08
 sigma[red] counter=101 t=7.1e-04 per=4.8e+01 cost=3.9e+04 flops=5.5e+07
--- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=7.9e-02 t_reduction=7.3e-02 tot=1.7e-01 ---
 sigma_tot[inter] counter=101 t=1.6e-02 per=9.5e+00 cost=7.8e+07 flops=4.8e+09
 sigma_tot[gemm] counter=101 i=0 t=2.6e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=1 t=2.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=2 t=2.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=3 t=2.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=4 t=1.8e-02 per=1.1e+01 cost=1.5e+07 flops=8.4e+08
 sigma_tot[gemm] counter=101 i=5 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.5e+08
 sigma_tot[gemm] counter=101 i=6 t=2.0e-02 per=1.2e+01 cost=1.4e+07 flops=7.2e+08
 sigma_tot[gemm] counter=101 i=7 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.8e+08
 sigma_tot[gemm] counter=101 total t=7.9e-02 per=4.7e+01 cost=6.0e+07 flops=7.6e+08
 sigma_tot[red] counter=101 t=7.3e-02 per=4.3e+01 cost=1.4e+07 flops=1.9e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.0e-05,1.7e-06,8.1e-07,1.4e-07
    5   0 -    -116.311487642229 -1.378e-06  2.297e-04    3     5  2.240e-02 4.479e-03 3.559e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.803e-05,1.253e-04,6.417e-04,7.047e-04,1.504e-03
 ndim=51:3.800e-07GB t[comm(intra)]=2.260e-05 speed=3.363e-02GB/S t[comm(inter)]=5.429e-06 speed=1.400e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=6.4e-04 t_reduction=7.0e-04 tot=1.5e-03 ---
 sigma[inter] counter=102 t=1.3e-04 per=8.5e+00 cost=1.4e+05 flops=1.1e+09
 sigma[gemm] counter=102 i=0 t=2.7e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=1 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=2 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=3 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=4 t=1.5e-04 per=1.0e+01 cost=2.2e+04 flops=1.5e+08
 sigma[gemm] counter=102 i=5 t=1.3e-04 per=9.1e+00 cost=2.2e+04 flops=1.6e+08
 sigma[gemm] counter=102 i=6 t=1.7e-04 per=1.2e+01 cost=3.3e+04 flops=1.9e+08
 sigma[gemm] counter=102 i=7 t=1.8e-04 per=1.2e+01 cost=3.0e+04 flops=1.7e+08
 sigma[gemm] counter=102 total t=6.4e-04 per=4.4e+01 cost=1.1e+05 flops=1.7e+08
 sigma[red] counter=102 t=7.0e-04 per=4.8e+01 cost=3.9e+04 flops=5.6e+07
--- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=8.0e-02 t_reduction=7.4e-02 tot=1.7e-01 ---
 sigma_tot[inter] counter=102 t=1.6e-02 per=9.5e+00 cost=7.8e+07 flops=4.8e+09
 sigma_tot[gemm] counter=102 i=0 t=2.6e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=1 t=2.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=2 t=2.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=3 t=2.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=4 t=1.8e-02 per=1.1e+01 cost=1.5e+07 flops=8.3e+08
 sigma_tot[gemm] counter=102 i=5 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.4e+08
 sigma_tot[gemm] counter=102 i=6 t=2.0e-02 per=1.2e+01 cost=1.4e+07 flops=7.2e+08
 sigma_tot[gemm] counter=102 i=7 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.7e+08
 sigma_tot[gemm] counter=102 total t=8.0e-02 per=4.7e+01 cost=6.0e+07 flops=7.6e+08
 sigma_tot[red] counter=102 t=7.4e-02 per=4.3e+01 cost=1.4e+07 flops=1.9e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.0e-05,1.7e-06,8.9e-07,1.3e-07
    6   0 +    -116.311487752567 -1.103e-07  5.271e-05    3     6  2.603e-02 4.339e-03 3.543e-03
TIMING FOR Davidson : 2.610e-02  T(cal/comm/rest)=2.126e-02,4.000e-07,4.847e-03
decomposed t_rest=4.847e-03
 T(sub)    =1.272e-04 per=2.625e+00
 T(precond)=3.477e-03 per=7.173e+01
 T(ortho)  =3.906e-05 per=8.058e-01
 T(xcopy)  =6.690e-07 per=1.380e-02
 T(xnrm2)  =1.147e-06 per=2.366e-02
 T(other)  =1.202e-03 per=2.480e+01
optimized energies: isweep=0 ibond=15 dots=2 e[0]=-116.311487752567 nmvp=6
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:2.903e+01S Sys:1.157e+00S Total:3.019e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond15.txt
 qbond: qsuper nsym=12 dimAll=40
 (25,3):5 (27,3):7 (26,2):8 (26,4):4 (24,2):2 (25,1):3 (28,2):3 (27,1):3 (26,0):1 (28,4):2 (27,5):1 (29,3):1
----- TMING FOR decimation_genbasis(su2): 8.4e-05 S -----
decimation summary: 40->10 dwt=+5.064e-08 SvN=8.797e-01
 qbond: qkept nsym=6 dimAll=10
 (26,2):3 (25,1):2 (27,1):2 (27,3):1 (28,2):1 (26,0):1
----- TIMING for decimation_row(nkr): 3.287e-03 S T(decim/select/formRot)=3.757e-04,2.745e-03,1.670e-04 -----
----- TIMING FOR twodot_decimation: 3.483e-03 S T(wf/decim)=1.229e-04,3.360e-03 -----
ctns::oper_renorm coord=(16,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:17 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=826:6.302e-03MB:6.154e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:2.926e+01S Sys:1.157e+00S Total:3.042e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=42 : 2.062e-04 S -----
rank=0 GPUmem(GB): used=3.69e-05 (oper)=2.17e-05
rank=0 GPUmem(GB): used=3.73e-05 (oper,site)(GB)=2.17e-05,3.5e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=42
 no. of rintermediate operators=42
 no. of coefficients=672:0.00513MB:5.01e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.990e-04 S -----
rank=0 GPUmem(GB): used=4.23e-05 (oper,site,rinter)=2.17e-05,3.5e-07,5.01e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00159 S size(rtasks)=42 size(Rlst2)=36 T(Rmu/Rlist)=5.58e-05,0.00153 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00171 S size(rtasks)=42 size(Rlst)=1910 -----
rank=0 GPUmem(GB): used=4.23e-05 (oper,site,rinter,batch)=2.17e-05,3.5e-07,5.01e-06,0.000356 blksize=9 blksize0=6 batchsize=1910
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000123,0.000842,0.000336
--- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=8.4e-04 t_reduction=3.4e-04 tot=1.3e-03 ---
 renorm[inter] counter=16 t=1.2e-04 per=9.5e+00 cost=4.6e+04 flops=3.7e+08
 renorm[gemm] counter=16 i=0 t=2.7e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=1 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=2 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=3 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=4 t=3.0e-04 per=2.3e+01 cost=6.8e+03 flops=2.3e+07
 renorm[gemm] counter=16 i=5 t=2.7e-04 per=2.1e+01 cost=1.3e+04 flops=4.9e+07
 renorm[gemm] counter=16 i=6 t=2.6e-04 per=2.0e+01 cost=2.7e+04 flops=1.0e+08
 renorm[gemm] counter=16 total t=8.4e-04 per=6.5e+01 cost=4.7e+04 flops=5.6e+07
 renorm[red] counter=16 t=3.4e-04 per=2.6e+01 cost=1.5e+04 flops=4.3e+07
--- TIMING FOR renorm_tot : t_inter=2.0e-03 t_gemm=1.0e-02 t_reduction=3.8e-03 tot=1.6e-02 ---
 renorm_tot[inter] counter=16 t=2.0e-03 per=1.2e+01 cost=1.4e+06 flops=7.2e+08
 renorm_tot[gemm] counter=16 i=0 t=4.5e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=1 t=3.6e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=2 t=3.5e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=3 t=3.5e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=4 t=3.3e-03 per=2.1e+01 cost=2.0e+05 flops=6.2e+07
 renorm_tot[gemm] counter=16 i=5 t=3.3e-03 per=2.1e+01 cost=5.3e+05 flops=1.6e+08
 renorm_tot[gemm] counter=16 i=6 t=3.4e-03 per=2.1e+01 cost=9.5e+05 flops=2.8e+08
 renorm_tot[gemm] counter=16 total t=1.0e-02 per=6.4e+01 cost=1.7e+06 flops=1.6e+08
 renorm_tot[red] counter=16 t=3.8e-03 per=2.4e+01 cost=4.2e+05 flops=1.1e+08
qops.to_cpu: size(tot)=826:6.3e-03MB:6.2e-06GB t[to_cpu]=2.6e-05S speed=2.4e-01GB/S
check ||H-H.dagger||=2.151e-14 coord=(16,0) rank=0
ctns::oper_ab2pq coord=(16,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00703 S rank=0 -----
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:2.950e+01S Sys:1.157e+00S Total:3.066e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=687:5.241e-03MB:5.119e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=711:5.424e-03MB:5.297e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:2.951e+01S Sys:1.157e+00S Total:3.066e+01S
##### local opt: 6.708e-02 S #####
 T(local opt: fetch) = 6.120e-03 S  per = 9.12  per(accum) = 9.12
 T(local opt: hdiag) = 1.970e-03 S  per = 2.94  per(accum) = 12.1
 T(local opt: dvdsn) = 4.313e-02 S  per = 64.3  per(accum) = 76.4
 T(local opt: decim) = 3.563e-03 S  per = 5.31  per(accum) = 81.7
 T(local opt: guess) = 7.520e-05 S  per = 0.112  per(accum) = 81.8
 T(local opt: renrm) = 7.969e-03 S  per = 11.9  per(accum) = 93.7
 T(local opt: save ) = 4.252e-03 S  per = 6.34  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.313e-02 S  T(sum) = 4.236e-02 S  per = 9.821e+01
 T(local opt: preprocess                  ) = 4.723e-04 S  per = 1.12  per(accum) = 1.12
 T(local opt: symbolic_formulae           ) = 5.868e-04 S  per = 1.39  per(accum) = 2.5
 T(local opt: hintermediate init          ) = 5.764e-04 S  per = 1.36  per(accum) = 3.86
 T(local opt: preprocess_hformulae_Hxlist ) = 1.236e-02 S  per = 29.2  per(accum) = 33
 T(local opt: hmmtasks init               ) = 2.071e-03 S  per = 4.89  per(accum) = 37.9
 T(local opt: initial guess for dvdson    ) = 1.885e-04 S  per = 0.445  per(accum) = 38.4
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.107e-02 S  per = 49.7  per(accum) = 88.1
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.851e-04 S  per = 0.437  per(accum) = 88.6
 T(local opt: dvdson solver [comm(cpu)]   ) = 4.000e-07 S  per = 0.000944  per(accum) = 88.6
 T(local opt: dvdson solver [rest part]   ) = 4.847e-03 S  per = 11.4  per(accum) = 100
Detailed decomposition of T(renrm) = 7.969e-03 S  T(sum) = 7.969e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.104e-04 S  per = 1.39  per(accum) = 1.39
 T(local opt: qops init                    ) = 3.769e-04 S  per = 4.73  per(accum) = 6.12
 T(local opt: symbolic_formulae_renorm     ) = 2.807e-04 S  per = 3.52  per(accum) = 9.64
 T(local opt: allocate qops on gpu         ) = 9.029e-05 S  per = 1.13  per(accum) = 10.8
 T(local opt: site memcpy cpu2gpu          ) = 8.380e-05 S  per = 1.05  per(accum) = 11.8
 T(local opt: rintermediate init           ) = 4.433e-04 S  per = 5.56  per(accum) = 17.4
 T(local opt: preprocess_formulae_Rlist2   ) = 1.791e-03 S  per = 22.5  per(accum) = 39.9
 T(local opt: rmmtasks init                ) = 6.005e-04 S  per = 7.54  per(accum) = 47.4
 T(local opt: qops memset on cpu           ) = 6.200e-08 S  per = 0.000778  per(accum) = 47.4
 T(local opt: preprocess_renorm_batchGPU   ) = 3.142e-03 S  per = 39.4  per(accum) = 86.8
 T(local opt: reduction of opS & opH [nccl]) = 7.370e-07 S  per = 0.00925  per(accum) = 86.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.102e-04 S  per = 1.38  per(accum) = 88.2
 T(local opt: deallocate cpu and gpu memory) = 9.968e-06 S  per = 0.125  per(accum) = 88.3
 T(local opt: reduction of opS & opH [comm]) = 9.819e-05 S  per = 1.23  per(accum) = 89.6
 T(local opt: conversion from opAB to opPQ ) = 9.112e-05 S  per = 1.14  per(accum) = 90.7
 T(local opt: after oper_renorm            ) = 7.397e-04 S  per = 9.28  per(accum) = 100
##### sweep opt: 1.306e+00 S #####
 T(sweep opt: fetch) = 1.049e-01 S  per = 8.04  per(accum) = 8.04
 T(sweep opt: hdiag) = 8.499e-02 S  per = 6.51  per(accum) = 14.5
 T(sweep opt: dvdsn) = 8.424e-01 S  per = 64.5  per(accum) = 79.1
 T(sweep opt: decim) = 5.966e-02 S  per = 4.57  per(accum) = 83.6
 T(sweep opt: guess) = 1.984e-03 S  per = 0.152  per(accum) = 83.8
 T(sweep opt: renrm) = 1.385e-01 S  per = 10.6  per(accum) = 94.4
 T(sweep opt: save ) = 7.316e-02 S  per =  5.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.424e-01 S  T(sum) = 8.284e-01 S  per = 9.834e+01
 T(sweep opt: preprocess                  ) = 9.709e-03 S  per = 1.17  per(accum) = 1.17
 T(sweep opt: symbolic_formulae           ) = 1.751e-02 S  per = 2.11  per(accum) = 3.29
 T(sweep opt: hintermediate init          ) = 9.450e-03 S  per = 1.14  per(accum) = 4.43
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.244e-01 S  per = 39.2  per(accum) = 43.6
 T(sweep opt: hmmtasks init               ) = 5.496e-02 S  per = 6.63  per(accum) = 50.2
 T(sweep opt: initial guess for dvdson    ) = 3.666e-03 S  per = 0.443  per(accum) = 50.7
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 3.757e-01 S  per = 45.4  per(accum) = 96
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.928e-03 S  per = 0.353  per(accum) = 96.4
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 4.857e-06 S  per = 0.000586  per(accum) = 96.4
 T(sweep opt: dvdson solver [rest part]   ) = 3.004e-02 S  per = 3.63  per(accum) = 100
Detailed decomposition of T(renrm) = 1.385e-01 S  T(sum) = 1.385e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.954e-03 S  per = 1.41  per(accum) = 1.41
 T(sweep opt: qops init                    ) = 7.459e-03 S  per = 5.39  per(accum) = 6.8
 T(sweep opt: symbolic_formulae_renorm     ) = 8.075e-03 S  per = 5.83  per(accum) = 12.6
 T(sweep opt: allocate qops on gpu         ) = 1.526e-03 S  per =  1.1  per(accum) = 13.7
 T(sweep opt: site memcpy cpu2gpu          ) = 1.424e-03 S  per = 1.03  per(accum) = 14.8
 T(sweep opt: rintermediate init           ) = 7.619e-03 S  per =  5.5  per(accum) = 20.3
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.309e-02 S  per = 23.9  per(accum) = 44.2
 T(sweep opt: rmmtasks init                ) = 1.056e-02 S  per = 7.62  per(accum) = 51.8
 T(sweep opt: qops memset on cpu           ) = 8.350e-07 S  per = 0.000603  per(accum) = 51.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.458e-02 S  per = 32.2  per(accum) = 84
 T(sweep opt: reduction of opS & opH [nccl]) = 9.482e-06 S  per = 0.00685  per(accum) = 84
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.560e-03 S  per = 1.13  per(accum) = 85.1
 T(sweep opt: deallocate cpu and gpu memory) = 3.008e-04 S  per = 0.217  per(accum) = 85.3
 T(sweep opt: reduction of opS & opH [comm]) = 1.414e-03 S  per = 1.02  per(accum) = 86.3
 T(sweep opt: conversion from opAB to opPQ ) = 7.172e-03 S  per = 5.18  per(accum) = 91.5
 T(sweep opt: after oper_renorm            ) = 1.174e-02 S  per = 8.48  per(accum) = 100
##### global opt: 1.306e+00 S #####
 T(global opt: fetch) = 1.049e-01 S  per = 8.04  per(accum) = 8.04
 T(global opt: hdiag) = 8.499e-02 S  per = 6.51  per(accum) = 14.5
 T(global opt: dvdsn) = 8.424e-01 S  per = 64.5  per(accum) = 79.1
 T(global opt: decim) = 5.966e-02 S  per = 4.57  per(accum) = 83.6
 T(global opt: guess) = 1.984e-03 S  per = 0.152  per(accum) = 83.8
 T(global opt: renrm) = 1.385e-01 S  per = 10.6  per(accum) = 94.4
 T(global opt: save ) = 7.316e-02 S  per =  5.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.424e-01 S  T(sum) = 8.284e-01 S  per = 9.834e+01
 T(global opt: preprocess                  ) = 9.709e-03 S  per = 1.17  per(accum) = 1.17
 T(global opt: symbolic_formulae           ) = 1.751e-02 S  per = 2.11  per(accum) = 3.29
 T(global opt: hintermediate init          ) = 9.450e-03 S  per = 1.14  per(accum) = 4.43
 T(global opt: preprocess_hformulae_Hxlist ) = 3.244e-01 S  per = 39.2  per(accum) = 43.6
 T(global opt: hmmtasks init               ) = 5.496e-02 S  per = 6.63  per(accum) = 50.2
 T(global opt: initial guess for dvdson    ) = 3.666e-03 S  per = 0.443  per(accum) = 50.7
 T(global opt: dvdson solver [Hx_batchGPU] ) = 3.757e-01 S  per = 45.4  per(accum) = 96
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.928e-03 S  per = 0.353  per(accum) = 96.4
 T(global opt: dvdson solver [comm(cpu)]   ) = 4.857e-06 S  per = 0.000586  per(accum) = 96.4
 T(global opt: dvdson solver [rest part]   ) = 3.004e-02 S  per = 3.63  per(accum) = 100
Detailed decomposition of T(renrm) = 1.385e-01 S  T(sum) = 1.385e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.954e-03 S  per = 1.41  per(accum) = 1.41
 T(global opt: qops init                    ) = 7.459e-03 S  per = 5.39  per(accum) = 6.8
 T(global opt: symbolic_formulae_renorm     ) = 8.075e-03 S  per = 5.83  per(accum) = 12.6
 T(global opt: allocate qops on gpu         ) = 1.526e-03 S  per =  1.1  per(accum) = 13.7
 T(global opt: site memcpy cpu2gpu          ) = 1.424e-03 S  per = 1.03  per(accum) = 14.8
 T(global opt: rintermediate init           ) = 7.619e-03 S  per =  5.5  per(accum) = 20.3
 T(global opt: preprocess_formulae_Rlist2   ) = 3.309e-02 S  per = 23.9  per(accum) = 44.2
 T(global opt: rmmtasks init                ) = 1.056e-02 S  per = 7.62  per(accum) = 51.8
 T(global opt: qops memset on cpu           ) = 8.350e-07 S  per = 0.000603  per(accum) = 51.8
 T(global opt: preprocess_renorm_batchGPU   ) = 4.458e-02 S  per = 32.2  per(accum) = 84
 T(global opt: reduction of opS & opH [nccl]) = 9.482e-06 S  per = 0.00685  per(accum) = 84
 T(global opt: qops memcpy gpu2cpu          ) = 1.560e-03 S  per = 1.13  per(accum) = 85.1
 T(global opt: deallocate cpu and gpu memory) = 3.008e-04 S  per = 0.217  per(accum) = 85.3
 T(global opt: reduction of opS & opH [comm]) = 1.414e-03 S  per = 1.02  per(accum) = 86.3
 T(global opt: conversion from opAB to opPQ ) = 7.172e-03 S  per = 5.18  per(accum) = 91.5
 T(global opt: after oper_renorm            ) = 1.174e-02 S  per = 8.48  per(accum) = 100

isweep=0 ibond=16/seqsize=34 dots=2 dbond=(17,0)-(18,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:2.951e+01S Sys:1.158e+00S Total:3.066e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=687:5.241e-03MB:5.119e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=711:5.424e-03MB:5.297e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=17,1,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 15
 suppc1= 13
 suppc2= 14
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:17 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=826:6.302e-03MB:6.154e-06GB
 rqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=3820:2.914e-02MB:2.846e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(17,0) fdel=./scratch/sweep/rop(18,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=41:3.128e-04MB
qtensor4: wf4 own=1 _data=0x55a319428ae0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (26,2):3 (25,1):2 (27,1):2 (27,3):1 (28,2):1 (26,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=24 nblocks=230 size=41:3.128e-04MB
### DIAG TIMING: total=5.401e-04 t1=1.007e-05, t2=1.615e-05, t3=2.109e-05, t4=4.657e-04, t5=4.350e-06, t6=1.863e-05, t7=4.139e-06
duration_diagGPU:6.160e-04
duration_diagreduce:3.200e-08
duration_diagtransform:1.710e-07
----- TIMING FOR symbolic_formulae_twodot with size=228 : 3.555e-04 S -----
rank=0 GPUmem(GB): used=2.85e-05 (oper)=2.85e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=228
 no. of hintermediate operators=22
 no. of coefficients=374:0.00285MB:2.79e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.972e-04 S -----
rank=0 GPUmem(GB): used=3.12e-05 (oper,hinter)=2.85e-05,2.79e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00973 S size(H_formulae)=228 size(Hxlst2)=24 T(Hmu/Hxlist)=8.12e-05,0.00965 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00995 S size(H_formulae)=228 size(Hxlst)=6332 -----
rank=0 GPUmem(GB): used=0.000645 (oper,hinter,dvdson,batch)=2.85e-05,2.79e-06,6.11e-07,0.000613 blksize=3 blksize0=6 batchsize=6332
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=41 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.15e-05,0.00011,0.000482,0.000755,0.00139
 ndim=41:3.05e-07GB t[comm(intra)]=2.41e-05 speed=0.0253GB/S t[comm(inter)]=7.35e-06 speed=0.0831GB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=4.8e-04 t_reduction=7.5e-04 tot=1.3e-03 ---
 sigma[inter] counter=103 t=1.1e-04 per=8.1e+00 cost=5.4e+04 flops=4.9e+08
 sigma[gemm] counter=103 i=0 t=2.8e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=1 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=2 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=3 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=4 t=1.0e-04 per=7.4e+00 cost=7.6e+03 flops=7.7e+07
 sigma[gemm] counter=103 i=5 t=9.2e-05 per=6.8e+00 cost=7.6e+03 flops=8.3e+07
 sigma[gemm] counter=103 i=6 t=1.4e-04 per=1.1e+01 cost=1.8e+04 flops=1.3e+08
 sigma[gemm] counter=103 i=7 t=1.4e-04 per=1.0e+01 cost=1.8e+04 flops=1.3e+08
 sigma[gemm] counter=103 total t=4.8e-04 per=3.6e+01 cost=5.2e+04 flops=1.1e+08
 sigma[red] counter=103 t=7.5e-04 per=5.6e+01 cost=2.3e+04 flops=3.0e+07
--- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=8.0e-02 t_reduction=7.4e-02 tot=1.7e-01 ---
 sigma_tot[inter] counter=103 t=1.6e-02 per=9.5e+00 cost=7.8e+07 flops=4.8e+09
 sigma_tot[gemm] counter=103 i=0 t=2.7e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=1 t=2.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=2 t=2.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=3 t=2.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=4 t=1.8e-02 per=1.1e+01 cost=1.5e+07 flops=8.3e+08
 sigma_tot[gemm] counter=103 i=5 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.4e+08
 sigma_tot[gemm] counter=103 i=6 t=2.0e-02 per=1.2e+01 cost=1.4e+07 flops=7.1e+08
 sigma_tot[gemm] counter=103 i=7 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.7e+08
 sigma_tot[gemm] counter=103 total t=8.0e-02 per=4.7e+01 cost=6.0e+07 flops=7.5e+08
 sigma_tot[red] counter=103 t=7.4e-02 per=4.3e+01 cost=1.4e+07 flops=1.9e+08
T(sub)=7.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,2.9e-06,1.1e-06,8.6e-07,1.9e-07
settings: ndim=41 neig=1 maxcycle=30 nbuff=4 memory=5e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.311487721541 -1.116e+03  4.799e-02    1     1  3.526e-03 3.526e-03 3.369e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.928e-05,7.764e-05,3.738e-04,7.088e-04,1.195e-03
 ndim=41:3.055e-07GB t[comm(intra)]=2.357e-05 speed=2.592e-02GB/S t[comm(inter)]=5.714e-06 speed=1.069e-01GB/S
--- TIMING FOR sigma : t_inter=7.8e-05 t_gemm=3.7e-04 t_reduction=7.1e-04 tot=1.2e-03 ---
 sigma[inter] counter=104 t=7.8e-05 per=6.7e+00 cost=5.4e+04 flops=6.9e+08
 sigma[gemm] counter=104 i=0 t=2.3e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=1 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=2 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=3 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=4 t=7.3e-05 per=6.3e+00 cost=7.6e+03 flops=1.1e+08
 sigma[gemm] counter=104 i=5 t=6.8e-05 per=5.8e+00 cost=7.6e+03 flops=1.1e+08
 sigma[gemm] counter=104 i=6 t=1.1e-04 per=9.4e+00 cost=1.8e+04 flops=1.7e+08
 sigma[gemm] counter=104 i=7 t=1.1e-04 per=9.9e+00 cost=1.8e+04 flops=1.6e+08
 sigma[gemm] counter=104 total t=3.7e-04 per=3.2e+01 cost=5.2e+04 flops=1.4e+08
 sigma[red] counter=104 t=7.1e-04 per=6.1e+01 cost=2.3e+04 flops=3.2e+07
--- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=8.1e-02 t_reduction=7.5e-02 tot=1.7e-01 ---
 sigma_tot[inter] counter=104 t=1.6e-02 per=9.5e+00 cost=7.8e+07 flops=4.8e+09
 sigma_tot[gemm] counter=104 i=0 t=2.7e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=1 t=2.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=2 t=2.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=3 t=2.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=4 t=1.8e-02 per=1.1e+01 cost=1.5e+07 flops=8.3e+08
 sigma_tot[gemm] counter=104 i=5 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.4e+08
 sigma_tot[gemm] counter=104 i=6 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.1e+08
 sigma_tot[gemm] counter=104 i=7 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.6e+08
 sigma_tot[gemm] counter=104 total t=8.1e-02 per=4.7e+01 cost=6.0e+07 flops=7.5e+08
 sigma_tot[red] counter=104 t=7.5e-02 per=4.4e+01 cost=1.4e+07 flops=1.9e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,9.5e-06,2.4e-06,9.9e-07,2.4e-07
    2   0 -    -116.316320812362 -4.833e-03  9.176e-03    2     2  7.221e-03 3.610e-03 3.275e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.807e-05,7.828e-05,3.756e-04,7.069e-04,1.194e-03
 ndim=41:3.055e-07GB t[comm(intra)]=2.297e-05 speed=2.660e-02GB/S t[comm(inter)]=5.097e-06 speed=1.199e-01GB/S
--- TIMING FOR sigma : t_inter=7.8e-05 t_gemm=3.8e-04 t_reduction=7.1e-04 tot=1.2e-03 ---
 sigma[inter] counter=105 t=7.8e-05 per=6.7e+00 cost=5.4e+04 flops=6.9e+08
 sigma[gemm] counter=105 i=0 t=2.3e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=1 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=2 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=3 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=4 t=7.1e-05 per=6.1e+00 cost=7.6e+03 flops=1.1e+08
 sigma[gemm] counter=105 i=5 t=6.8e-05 per=5.9e+00 cost=7.6e+03 flops=1.1e+08
 sigma[gemm] counter=105 i=6 t=1.1e-04 per=9.6e+00 cost=1.8e+04 flops=1.7e+08
 sigma[gemm] counter=105 i=7 t=1.2e-04 per=1.0e+01 cost=1.8e+04 flops=1.6e+08
 sigma[gemm] counter=105 total t=3.8e-04 per=3.2e+01 cost=5.2e+04 flops=1.4e+08
 sigma[red] counter=105 t=7.1e-04 per=6.1e+01 cost=2.3e+04 flops=3.2e+07
--- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=8.1e-02 t_reduction=7.6e-02 tot=1.7e-01 ---
 sigma_tot[inter] counter=105 t=1.6e-02 per=9.5e+00 cost=7.8e+07 flops=4.8e+09
 sigma_tot[gemm] counter=105 i=0 t=2.7e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=1 t=2.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=2 t=2.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=3 t=2.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=4 t=1.9e-02 per=1.1e+01 cost=1.5e+07 flops=8.2e+08
 sigma_tot[gemm] counter=105 i=5 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.4e+08
 sigma_tot[gemm] counter=105 i=6 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.1e+08
 sigma_tot[gemm] counter=105 i=7 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.6e+08
 sigma_tot[gemm] counter=105 total t=8.1e-02 per=4.7e+01 cost=6.1e+07 flops=7.5e+08
 sigma_tot[red] counter=105 t=7.6e-02 per=4.4e+01 cost=1.4e+07 flops=1.9e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.7e-05,1.8e-06,9.9e-07,2.0e-07
    3   0 -    -116.316684783080 -3.640e-04  2.834e-03    3     3  1.055e-02 3.517e-03 3.230e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.794e-05,7.336e-05,3.740e-04,7.064e-04,1.186e-03
 ndim=41:3.055e-07GB t[comm(intra)]=2.278e-05 speed=2.682e-02GB/S t[comm(inter)]=5.158e-06 speed=1.184e-01GB/S
--- TIMING FOR sigma : t_inter=7.3e-05 t_gemm=3.7e-04 t_reduction=7.1e-04 tot=1.2e-03 ---
 sigma[inter] counter=106 t=7.3e-05 per=6.4e+00 cost=5.4e+04 flops=7.3e+08
 sigma[gemm] counter=106 i=0 t=2.3e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=1 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=2 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=3 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=4 t=6.9e-05 per=6.0e+00 cost=7.6e+03 flops=1.1e+08
 sigma[gemm] counter=106 i=5 t=6.7e-05 per=5.8e+00 cost=7.6e+03 flops=1.1e+08
 sigma[gemm] counter=106 i=6 t=1.1e-04 per=9.8e+00 cost=1.8e+04 flops=1.6e+08
 sigma[gemm] counter=106 i=7 t=1.2e-04 per=1.0e+01 cost=1.8e+04 flops=1.6e+08
 sigma[gemm] counter=106 total t=3.7e-04 per=3.2e+01 cost=5.2e+04 flops=1.4e+08
 sigma[red] counter=106 t=7.1e-04 per=6.1e+01 cost=2.3e+04 flops=3.2e+07
--- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=8.1e-02 t_reduction=7.6e-02 tot=1.7e-01 ---
 sigma_tot[inter] counter=106 t=1.6e-02 per=9.4e+00 cost=7.8e+07 flops=4.7e+09
 sigma_tot[gemm] counter=106 i=0 t=2.7e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=1 t=2.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=2 t=2.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=3 t=2.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=4 t=1.9e-02 per=1.1e+01 cost=1.5e+07 flops=8.2e+08
 sigma_tot[gemm] counter=106 i=5 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.4e+08
 sigma_tot[gemm] counter=106 i=6 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.1e+08
 sigma_tot[gemm] counter=106 i=7 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.6e+08
 sigma_tot[gemm] counter=106 total t=8.1e-02 per=4.7e+01 cost=6.1e+07 flops=7.4e+08
 sigma_tot[red] counter=106 t=7.6e-02 per=4.4e+01 cost=1.4e+07 flops=1.9e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,1.0e-05,1.6e-06,8.0e-07,1.6e-07
    4   0 -    -116.316727036912 -4.225e-05  7.229e-04    3     4  1.386e-02 3.465e-03 3.204e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.722e-05,7.359e-05,3.741e-04,6.993e-04,1.178e-03
 ndim=41:3.055e-07GB t[comm(intra)]=2.196e-05 speed=2.782e-02GB/S t[comm(inter)]=5.257e-06 speed=1.162e-01GB/S
--- TIMING FOR sigma : t_inter=7.4e-05 t_gemm=3.7e-04 t_reduction=7.0e-04 tot=1.1e-03 ---
 sigma[inter] counter=107 t=7.4e-05 per=6.4e+00 cost=5.4e+04 flops=7.3e+08
 sigma[gemm] counter=107 i=0 t=2.3e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=1 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=2 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=3 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=4 t=7.0e-05 per=6.1e+00 cost=7.6e+03 flops=1.1e+08
 sigma[gemm] counter=107 i=5 t=6.9e-05 per=6.0e+00 cost=7.6e+03 flops=1.1e+08
 sigma[gemm] counter=107 i=6 t=1.1e-04 per=9.9e+00 cost=1.8e+04 flops=1.6e+08
 sigma[gemm] counter=107 i=7 t=1.1e-04 per=9.9e+00 cost=1.8e+04 flops=1.6e+08
 sigma[gemm] counter=107 total t=3.7e-04 per=3.3e+01 cost=5.2e+04 flops=1.4e+08
 sigma[red] counter=107 t=7.0e-04 per=6.1e+01 cost=2.3e+04 flops=3.2e+07
--- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=8.2e-02 t_reduction=7.7e-02 tot=1.8e-01 ---
 sigma_tot[inter] counter=107 t=1.7e-02 per=9.4e+00 cost=7.8e+07 flops=4.7e+09
 sigma_tot[gemm] counter=107 i=0 t=2.8e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=1 t=2.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=2 t=2.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=3 t=2.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=4 t=1.9e-02 per=1.1e+01 cost=1.5e+07 flops=8.2e+08
 sigma_tot[gemm] counter=107 i=5 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.3e+08
 sigma_tot[gemm] counter=107 i=6 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.0e+08
 sigma_tot[gemm] counter=107 i=7 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.5e+08
 sigma_tot[gemm] counter=107 total t=8.2e-02 per=4.7e+01 cost=6.1e+07 flops=7.4e+08
 sigma_tot[red] counter=107 t=7.7e-02 per=4.4e+01 cost=1.4e+07 flops=1.9e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,1.0e-05,1.6e-06,8.4e-07,1.2e-07
    5   0 -    -116.316728559371 -1.522e-06  2.466e-04    3     5  1.716e-02 3.432e-03 3.188e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.702e-05,7.296e-05,3.711e-04,6.969e-04,1.172e-03
 ndim=41:3.055e-07GB t[comm(intra)]=2.236e-05 speed=2.733e-02GB/S t[comm(inter)]=4.664e-06 speed=1.310e-01GB/S
--- TIMING FOR sigma : t_inter=7.3e-05 t_gemm=3.7e-04 t_reduction=7.0e-04 tot=1.1e-03 ---
 sigma[inter] counter=108 t=7.3e-05 per=6.4e+00 cost=5.4e+04 flops=7.4e+08
 sigma[gemm] counter=108 i=0 t=2.3e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=1 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=2 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=3 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=4 t=6.8e-05 per=5.9e+00 cost=7.6e+03 flops=1.1e+08
 sigma[gemm] counter=108 i=5 t=6.6e-05 per=5.8e+00 cost=7.6e+03 flops=1.1e+08
 sigma[gemm] counter=108 i=6 t=1.1e-04 per=9.9e+00 cost=1.8e+04 flops=1.6e+08
 sigma[gemm] counter=108 i=7 t=1.1e-04 per=1.0e+01 cost=1.8e+04 flops=1.6e+08
 sigma[gemm] counter=108 total t=3.7e-04 per=3.3e+01 cost=5.2e+04 flops=1.4e+08
 sigma[red] counter=108 t=7.0e-04 per=6.1e+01 cost=2.3e+04 flops=3.2e+07
--- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=8.2e-02 t_reduction=7.8e-02 tot=1.8e-01 ---
 sigma_tot[inter] counter=108 t=1.7e-02 per=9.4e+00 cost=7.8e+07 flops=4.7e+09
 sigma_tot[gemm] counter=108 i=0 t=2.8e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=1 t=2.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=2 t=2.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=3 t=2.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=4 t=1.9e-02 per=1.1e+01 cost=1.5e+07 flops=8.1e+08
 sigma_tot[gemm] counter=108 i=5 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.3e+08
 sigma_tot[gemm] counter=108 i=6 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.0e+08
 sigma_tot[gemm] counter=108 i=7 t=2.0e-02 per=1.2e+01 cost=1.5e+07 flops=7.5e+08
 sigma_tot[gemm] counter=108 total t=8.2e-02 per=4.7e+01 cost=6.1e+07 flops=7.4e+08
 sigma_tot[red] counter=108 t=7.8e-02 per=4.4e+01 cost=1.4e+07 flops=1.8e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.1e-06,1.0e-05,1.6e-06,9.2e-07,1.3e-07
    6   0 +    -116.316728679445 -1.201e-07  3.658e-05    3     6  2.044e-02 3.406e-03 3.172e-03
TIMING FOR Davidson : 2.051e-02  T(cal/comm/rest)=1.903e-02,2.310e-07,1.482e-03
decomposed t_rest=1.482e-03
 T(sub)    =9.728e-05 per=6.566e+00
 T(precond)=1.486e-04 per=1.003e+01
 T(ortho)  =6.820e-06 per=4.603e-01
 T(xcopy)  =6.760e-07 per=4.562e-02
 T(xnrm2)  =1.000e-06 per=6.749e-02
 T(other)  =1.227e-03 per=8.283e+01
optimized energies: isweep=0 ibond=16 dots=2 e[0]=-116.316728679445 nmvp=6
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.045e+01S Sys:1.160e+00S Total:3.161e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond16.txt
 qbond: qsuper nsym=11 dimAll=39
 (26,2):5 (28,2):7 (27,1):8 (27,3):4 (25,1):2 (26,0):3 (29,1):3 (28,0):3 (29,3):2 (28,4):1 (30,2):1
----- TMING FOR decimation_genbasis(su2): 6.8e-05 S -----
decimation summary: 39->9 dwt=+1.110e-16 SvN=9.103e-01
 qbond: qkept nsym=5 dimAll=9
 (28,0):3 (27,1):2 (29,1):2 (28,2):1 (26,0):1
----- TIMING for decimation_row(nkr): 3.554e-03 S T(decim/select/formRot)=3.751e-04,3.027e-03,1.528e-04 -----
----- TIMING FOR twodot_decimation: 3.759e-03 S T(wf/decim)=1.262e-04,3.633e-03 -----
ctns::oper_renorm coord=(17,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:18 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=9,9 size(op)=19:1.450e-04MB size(tot)=507:3.868e-03MB:3.777e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.070e+01S Sys:1.160e+00S Total:3.186e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=31 : 1.629e-04 S -----
rank=0 GPUmem(GB): used=3.5e-05 (oper)=1.74e-05
rank=0 GPUmem(GB): used=3.53e-05 (oper,site)(GB)=1.74e-05,3.05e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=31
 no. of rintermediate operators=22
 no. of coefficients=374:0.00285MB:2.79e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.989e-04 S -----
rank=0 GPUmem(GB): used=3.81e-05 (oper,site,rinter)=1.74e-05,3.05e-07,2.79e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00102 S size(rtasks)=31 size(Rlst2)=25 T(Rmu/Rlist)=3.39e-05,0.000991 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00113 S size(rtasks)=31 size(Rlst)=1279 -----
rank=0 GPUmem(GB): used=3.81e-05 (oper,site,rinter,batch)=1.74e-05,3.05e-07,2.79e-06,0.000238 blksize=9 blksize0=6 batchsize=1279
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.00011,0.000841,0.00027
--- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=8.4e-04 t_reduction=2.7e-04 tot=1.2e-03 ---
 renorm[inter] counter=17 t=1.1e-04 per=9.0e+00 cost=2.3e+04 flops=2.1e+08
 renorm[gemm] counter=17 i=0 t=2.6e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=1 t=3.0e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=2 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=3 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=17 i=4 t=2.7e-04 per=2.2e+01 cost=4.6e+03 flops=1.7e+07
 renorm[gemm] counter=17 i=5 t=2.9e-04 per=2.4e+01 cost=8.3e+03 flops=2.9e+07
 renorm[gemm] counter=17 i=6 t=2.7e-04 per=2.2e+01 cost=1.4e+04 flops=5.2e+07
 renorm[gemm] counter=17 total t=8.4e-04 per=6.9e+01 cost=2.7e+04 flops=3.2e+07
 renorm[red] counter=17 t=2.7e-04 per=2.2e+01 cost=8.1e+03 flops=3.0e+07
--- TIMING FOR renorm_tot : t_inter=2.1e-03 t_gemm=1.1e-02 t_reduction=4.1e-03 tot=1.7e-02 ---
 renorm_tot[inter] counter=17 t=2.1e-03 per=1.2e+01 cost=1.5e+06 flops=6.9e+08
 renorm_tot[gemm] counter=17 i=0 t=4.8e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=1 t=3.9e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=2 t=3.7e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=3 t=3.7e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=17 i=4 t=3.6e-03 per=2.1e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=17 i=5 t=3.6e-03 per=2.1e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=17 i=6 t=3.7e-03 per=2.1e+01 cost=9.6e+05 flops=2.6e+08
 renorm_tot[gemm] counter=17 total t=1.1e-02 per=6.4e+01 cost=1.7e+06 flops=1.5e+08
 renorm_tot[red] counter=17 t=4.1e-03 per=2.4e+01 cost=4.2e+05 flops=1.0e+08
qops.to_cpu: size(tot)=507:3.9e-03MB:3.8e-06GB t[to_cpu]=1.6e-05S speed=2.3e-01GB/S
check ||H-H.dagger||=9.929e-16 coord=(17,0) rank=0
ctns::oper_ab2pq coord=(17,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00597 S rank=0 -----
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.092e+01S Sys:1.168e+00S Total:3.209e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=721:5.501e-03MB:5.372e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=19:1.450e-04MB:1.416e-07GB
total mem of comb=741:5.653e-03MB:5.521e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.093e+01S Sys:1.168e+00S Total:3.209e+01S
##### local opt: 5.697e-02 S #####
 T(local opt: fetch) = 7.014e-03 S  per = 12.3  per(accum) = 12.3
 T(local opt: hdiag) = 1.509e-03 S  per = 2.65  per(accum) = 15
 T(local opt: dvdsn) = 3.447e-02 S  per = 60.5  per(accum) = 75.5
 T(local opt: decim) = 3.840e-03 S  per = 6.74  per(accum) = 82.2
 T(local opt: guess) = 7.350e-05 S  per = 0.129  per(accum) = 82.3
 T(local opt: renrm) = 6.809e-03 S  per =   12  per(accum) = 94.3
 T(local opt: save ) = 3.263e-03 S  per = 5.73  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.447e-02 S  T(sum) = 3.365e-02 S  per = 9.764e+01
 T(local opt: preprocess                  ) = 5.103e-04 S  per = 1.52  per(accum) = 1.52
 T(local opt: symbolic_formulae           ) = 4.244e-04 S  per = 1.26  per(accum) = 2.78
 T(local opt: hintermediate init          ) = 5.277e-04 S  per = 1.57  per(accum) = 4.35
 T(local opt: preprocess_hformulae_Hxlist ) = 1.005e-02 S  per = 29.9  per(accum) = 34.2
 T(local opt: hmmtasks init               ) = 1.425e-03 S  per = 4.23  per(accum) = 38.5
 T(local opt: initial guess for dvdson    ) = 1.964e-04 S  per = 0.584  per(accum) = 39
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.886e-02 S  per = 56.1  per(accum) = 95.1
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.710e-04 S  per = 0.508  per(accum) = 95.6
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.310e-07 S  per = 0.000686  per(accum) = 95.6
 T(local opt: dvdson solver [rest part]   ) = 1.482e-03 S  per =  4.4  per(accum) = 100
Detailed decomposition of T(renrm) = 6.809e-03 S  T(sum) = 6.809e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.052e-04 S  per = 1.54  per(accum) = 1.54
 T(local opt: qops init                    ) = 3.389e-04 S  per = 4.98  per(accum) = 6.52
 T(local opt: symbolic_formulae_renorm     ) = 2.440e-04 S  per = 3.58  per(accum) = 10.1
 T(local opt: allocate qops on gpu         ) = 8.881e-05 S  per =  1.3  per(accum) = 11.4
 T(local opt: site memcpy cpu2gpu          ) = 9.035e-05 S  per = 1.33  per(accum) = 12.7
 T(local opt: rintermediate init           ) = 4.449e-04 S  per = 6.53  per(accum) = 19.3
 T(local opt: preprocess_formulae_Rlist2   ) = 1.220e-03 S  per = 17.9  per(accum) = 37.2
 T(local opt: rmmtasks init                ) = 4.281e-04 S  per = 6.29  per(accum) = 43.5
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 0.000485  per(accum) = 43.5
 T(local opt: preprocess_renorm_batchGPU   ) = 2.931e-03 S  per =   43  per(accum) = 86.5
 T(local opt: reduction of opS & opH [nccl]) = 6.030e-07 S  per = 0.00886  per(accum) = 86.5
 T(local opt: qops memcpy gpu2cpu          ) = 8.949e-05 S  per = 1.31  per(accum) = 87.8
 T(local opt: deallocate cpu and gpu memory) = 1.038e-05 S  per = 0.152  per(accum) = 88
 T(local opt: reduction of opS & opH [comm]) = 8.174e-05 S  per =  1.2  per(accum) = 89.2
 T(local opt: conversion from opAB to opPQ ) = 6.983e-05 S  per = 1.03  per(accum) = 90.2
 T(local opt: after oper_renorm            ) = 6.656e-04 S  per = 9.78  per(accum) = 100
##### sweep opt: 1.363e+00 S #####
 T(sweep opt: fetch) = 1.119e-01 S  per = 8.21  per(accum) = 8.21
 T(sweep opt: hdiag) = 8.650e-02 S  per = 6.35  per(accum) = 14.6
 T(sweep opt: dvdsn) = 8.769e-01 S  per = 64.4  per(accum) = 78.9
 T(sweep opt: decim) = 6.350e-02 S  per = 4.66  per(accum) = 83.6
 T(sweep opt: guess) = 2.058e-03 S  per = 0.151  per(accum) = 83.7
 T(sweep opt: renrm) = 1.453e-01 S  per = 10.7  per(accum) = 94.4
 T(sweep opt: save ) = 7.642e-02 S  per = 5.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.769e-01 S  T(sum) = 8.620e-01 S  per = 9.831e+01
 T(sweep opt: preprocess                  ) = 1.022e-02 S  per = 1.19  per(accum) = 1.19
 T(sweep opt: symbolic_formulae           ) = 1.793e-02 S  per = 2.08  per(accum) = 3.27
 T(sweep opt: hintermediate init          ) = 9.977e-03 S  per = 1.16  per(accum) = 4.42
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.345e-01 S  per = 38.8  per(accum) = 43.2
 T(sweep opt: hmmtasks init               ) = 5.639e-02 S  per = 6.54  per(accum) = 49.8
 T(sweep opt: initial guess for dvdson    ) = 3.862e-03 S  per = 0.448  per(accum) = 50.2
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 3.946e-01 S  per = 45.8  per(accum) = 96
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 3.099e-03 S  per = 0.36  per(accum) = 96.3
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 5.088e-06 S  per = 0.00059  per(accum) = 96.3
 T(sweep opt: dvdson solver [rest part]   ) = 3.152e-02 S  per = 3.66  per(accum) = 100
Detailed decomposition of T(renrm) = 1.453e-01 S  T(sum) = 1.453e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.060e-03 S  per = 1.42  per(accum) = 1.42
 T(sweep opt: qops init                    ) = 7.798e-03 S  per = 5.37  per(accum) = 6.79
 T(sweep opt: symbolic_formulae_renorm     ) = 8.319e-03 S  per = 5.73  per(accum) = 12.5
 T(sweep opt: allocate qops on gpu         ) = 1.615e-03 S  per = 1.11  per(accum) = 13.6
 T(sweep opt: site memcpy cpu2gpu          ) = 1.514e-03 S  per = 1.04  per(accum) = 14.7
 T(sweep opt: rintermediate init           ) = 8.064e-03 S  per = 5.55  per(accum) = 20.2
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.431e-02 S  per = 23.6  per(accum) = 43.8
 T(sweep opt: rmmtasks init                ) = 1.098e-02 S  per = 7.56  per(accum) = 51.4
 T(sweep opt: qops memset on cpu           ) = 8.680e-07 S  per = 0.000597  per(accum) = 51.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.751e-02 S  per = 32.7  per(accum) = 84.1
 T(sweep opt: reduction of opS & opH [nccl]) = 1.009e-05 S  per = 0.00694  per(accum) = 84.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.649e-03 S  per = 1.14  per(accum) = 85.2
 T(sweep opt: deallocate cpu and gpu memory) = 3.111e-04 S  per = 0.214  per(accum) = 85.4
 T(sweep opt: reduction of opS & opH [comm]) = 1.496e-03 S  per = 1.03  per(accum) = 86.5
 T(sweep opt: conversion from opAB to opPQ ) = 7.242e-03 S  per = 4.98  per(accum) = 91.5
 T(sweep opt: after oper_renorm            ) = 1.240e-02 S  per = 8.54  per(accum) = 100
##### global opt: 1.363e+00 S #####
 T(global opt: fetch) = 1.119e-01 S  per = 8.21  per(accum) = 8.21
 T(global opt: hdiag) = 8.650e-02 S  per = 6.35  per(accum) = 14.6
 T(global opt: dvdsn) = 8.769e-01 S  per = 64.4  per(accum) = 78.9
 T(global opt: decim) = 6.350e-02 S  per = 4.66  per(accum) = 83.6
 T(global opt: guess) = 2.058e-03 S  per = 0.151  per(accum) = 83.7
 T(global opt: renrm) = 1.453e-01 S  per = 10.7  per(accum) = 94.4
 T(global opt: save ) = 7.642e-02 S  per = 5.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.769e-01 S  T(sum) = 8.620e-01 S  per = 9.831e+01
 T(global opt: preprocess                  ) = 1.022e-02 S  per = 1.19  per(accum) = 1.19
 T(global opt: symbolic_formulae           ) = 1.793e-02 S  per = 2.08  per(accum) = 3.27
 T(global opt: hintermediate init          ) = 9.977e-03 S  per = 1.16  per(accum) = 4.42
 T(global opt: preprocess_hformulae_Hxlist ) = 3.345e-01 S  per = 38.8  per(accum) = 43.2
 T(global opt: hmmtasks init               ) = 5.639e-02 S  per = 6.54  per(accum) = 49.8
 T(global opt: initial guess for dvdson    ) = 3.862e-03 S  per = 0.448  per(accum) = 50.2
 T(global opt: dvdson solver [Hx_batchGPU] ) = 3.946e-01 S  per = 45.8  per(accum) = 96
 T(global opt: dvdson solver [comm(gpu)]   ) = 3.099e-03 S  per = 0.36  per(accum) = 96.3
 T(global opt: dvdson solver [comm(cpu)]   ) = 5.088e-06 S  per = 0.00059  per(accum) = 96.3
 T(global opt: dvdson solver [rest part]   ) = 3.152e-02 S  per = 3.66  per(accum) = 100
Detailed decomposition of T(renrm) = 1.453e-01 S  T(sum) = 1.453e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.060e-03 S  per = 1.42  per(accum) = 1.42
 T(global opt: qops init                    ) = 7.798e-03 S  per = 5.37  per(accum) = 6.79
 T(global opt: symbolic_formulae_renorm     ) = 8.319e-03 S  per = 5.73  per(accum) = 12.5
 T(global opt: allocate qops on gpu         ) = 1.615e-03 S  per = 1.11  per(accum) = 13.6
 T(global opt: site memcpy cpu2gpu          ) = 1.514e-03 S  per = 1.04  per(accum) = 14.7
 T(global opt: rintermediate init           ) = 8.064e-03 S  per = 5.55  per(accum) = 20.2
 T(global opt: preprocess_formulae_Rlist2   ) = 3.431e-02 S  per = 23.6  per(accum) = 43.8
 T(global opt: rmmtasks init                ) = 1.098e-02 S  per = 7.56  per(accum) = 51.4
 T(global opt: qops memset on cpu           ) = 8.680e-07 S  per = 0.000597  per(accum) = 51.4
 T(global opt: preprocess_renorm_batchGPU   ) = 4.751e-02 S  per = 32.7  per(accum) = 84.1
 T(global opt: reduction of opS & opH [nccl]) = 1.009e-05 S  per = 0.00694  per(accum) = 84.1
 T(global opt: qops memcpy gpu2cpu          ) = 1.649e-03 S  per = 1.14  per(accum) = 85.2
 T(global opt: deallocate cpu and gpu memory) = 3.111e-04 S  per = 0.214  per(accum) = 85.4
 T(global opt: reduction of opS & opH [comm]) = 1.496e-03 S  per = 1.03  per(accum) = 86.5
 T(global opt: conversion from opAB to opPQ ) = 7.242e-03 S  per = 4.98  per(accum) = 91.5
 T(global opt: after oper_renorm            ) = 1.240e-02 S  per = 8.54  per(accum) = 100

isweep=0 ibond=17/seqsize=34 dots=2 dbond=(17,0)-(18,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.093e+01S Sys:1.168e+00S Total:3.209e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=721:5.501e-03MB:5.372e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=19:1.450e-04MB:1.416e-07GB
total mem of comb=741:5.653e-03MB:5.521e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=17,1,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 15
 suppc1= 13
 suppc2= 14
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:17 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=826:6.302e-03MB:6.154e-06GB
 rqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=3820:2.914e-02MB:2.846e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(18,0) fdel=./scratch/sweep/lop(17,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=41:3.128e-04MB
qtensor4: wf4 own=1 _data=0x55a319428ae0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (26,2):3 (25,1):2 (27,1):2 (27,3):1 (28,2):1 (26,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=24 nblocks=230 size=41:3.128e-04MB
### DIAG TIMING: total=5.335e-04 t1=1.343e-05, t2=1.763e-05, t3=1.727e-05, t4=4.601e-04, t5=4.129e-06, t6=1.692e-05, t7=4.070e-06
duration_diagGPU:6.118e-04
duration_diagreduce:2.900e-08
duration_diagtransform:1.650e-07
----- TIMING FOR symbolic_formulae_twodot with size=228 : 3.526e-04 S -----
rank=0 GPUmem(GB): used=3.22e-05 (oper)=2.85e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=228
 no. of hintermediate operators=22
 no. of coefficients=374:0.00285MB:2.79e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.153e-04 S -----
rank=0 GPUmem(GB): used=3.5e-05 (oper,hinter)=2.85e-05,2.79e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00974 S size(H_formulae)=228 size(Hxlst2)=24 T(Hmu/Hxlist)=8.16e-05,0.00966 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00996 S size(H_formulae)=228 size(Hxlst)=6332 -----
rank=0 GPUmem(GB): used=0.000649 (oper,hinter,dvdson,batch)=2.85e-05,2.79e-06,6.11e-07,0.000613 blksize=3 blksize0=6 batchsize=6332
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=41 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.13e-05,9.23e-05,0.00038,0.000716,0.00123
 ndim=41:3.05e-07GB t[comm(intra)]=2.42e-05 speed=0.0252GB/S t[comm(inter)]=7.06e-06 speed=0.0865GB/S
--- TIMING FOR sigma : t_inter=9.2e-05 t_gemm=3.8e-04 t_reduction=7.2e-04 tot=1.2e-03 ---
 sigma[inter] counter=109 t=9.2e-05 per=7.8e+00 cost=5.4e+04 flops=5.8e+08
 sigma[gemm] counter=109 i=0 t=2.7e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=1 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=2 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=3 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=4 t=7.2e-05 per=6.1e+00 cost=7.6e+03 flops=1.1e+08
 sigma[gemm] counter=109 i=5 t=6.9e-05 per=5.8e+00 cost=7.6e+03 flops=1.1e+08
 sigma[gemm] counter=109 i=6 t=1.2e-04 per=9.8e+00 cost=1.8e+04 flops=1.6e+08
 sigma[gemm] counter=109 i=7 t=1.1e-04 per=9.5e+00 cost=1.8e+04 flops=1.6e+08
 sigma[gemm] counter=109 total t=3.8e-04 per=3.2e+01 cost=5.2e+04 flops=1.4e+08
 sigma[red] counter=109 t=7.2e-04 per=6.0e+01 cost=2.3e+04 flops=3.2e+07
--- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=8.3e-02 t_reduction=7.9e-02 tot=1.8e-01 ---
 sigma_tot[inter] counter=109 t=1.7e-02 per=9.4e+00 cost=7.8e+07 flops=4.7e+09
 sigma_tot[gemm] counter=109 i=0 t=2.8e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=1 t=2.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=2 t=2.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=3 t=2.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=4 t=1.9e-02 per=1.1e+01 cost=1.5e+07 flops=8.1e+08
 sigma_tot[gemm] counter=109 i=5 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.3e+08
 sigma_tot[gemm] counter=109 i=6 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.0e+08
 sigma_tot[gemm] counter=109 i=7 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.5e+08
 sigma_tot[gemm] counter=109 total t=8.3e-02 per=4.6e+01 cost=6.1e+07 flops=7.4e+08
 sigma_tot[red] counter=109 t=7.9e-02 per=4.4e+01 cost=1.4e+07 flops=1.8e+08
T(sub)=7.6e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,2.7e-06,1.0e-06,9.2e-07,2.0e-07
settings: ndim=41 neig=1 maxcycle=30 nbuff=4 memory=5e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.316728679445 -1.116e+03  3.658e-05    1     1  3.431e-03 3.431e-03 3.263e-03
TIMING FOR Davidson : 3.741e-03  T(cal/comm/rest)=3.263e-03,3.400e-08,4.783e-04
decomposed t_rest=4.783e-04
 T(sub)    =7.567e-06 per=1.582e+00
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =3.320e-07 per=6.941e-02
 T(xnrm2)  =1.560e-07 per=3.262e-02
 T(other)  =4.702e-04 per=9.832e+01
optimized energies: isweep=0 ibond=17 dots=2 e[0]=-116.316728679445 nmvp=1
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.094e+01S Sys:1.168e+00S Total:3.211e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=6 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond17.txt
 qbond: qsuper nsym=6 dimAll=10
 (0,0):1 (2,0):3 (1,1):2 (4,0):1 (3,1):2 (2,2):1
----- TMING FOR decimation_genbasis(su2): 1.1e-04 S -----
decimation summary: 10->9 dwt=+0.000e+00 SvN=9.103e-01
 qbond: qkept nsym=5 dimAll=9
 (2,0):3 (1,1):2 (3,1):2 (4,0):1 (2,2):1
----- TIMING for decimation_row(nkr): 3.232e-03 S T(decim/select/formRot)=4.115e-04,2.665e-03,1.557e-04 -----
----- TIMING FOR twodot_decimation: 3.458e-03 S T(wf/decim)=1.346e-04,3.324e-03 -----
ctns::oper_renorm coord=(18,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:2 S:18 H:1 A:4 B:6 
        dim(bra,ket)=9,9 size(op)=19:1.450e-04MB size(tot)=507:3.868e-03MB:3.777e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.097e+01S Sys:1.168e+00S Total:3.214e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=31 : 1.234e-04 S -----
rank=0 GPUmem(GB): used=3.26e-05 (oper)=1.86e-05
rank=0 GPUmem(GB): used=3.28e-05 (oper,site)(GB)=1.86e-05,1.42e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=31
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=3.28e-05 (oper,site,rinter)=1.86e-05,1.42e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000709 S size(rtasks)=31 size(Rlst2)=25 T(Rmu/Rlist)=5.74e-05,0.000651 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000799 S size(rtasks)=31 size(Rlst)=828 -----
rank=0 GPUmem(GB): used=3.28e-05 (oper,site,rinter,batch)=1.86e-05,1.42e-07,0,0.000117 blksize=9 blksize0=0 batchsize=828
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.74e-06,0.000303,0.000202
--- TIMING FOR renorm : t_inter=7.7e-06 t_gemm=3.0e-04 t_reduction=2.0e-04 tot=5.1e-04 ---
 renorm[inter] counter=18 t=7.7e-06 per=1.5e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=0 t=3.2e-06 per=6.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=1 t=2.3e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=2 t=9.5e-05 per=1.9e+01 cost=1.2e+03 flops=1.3e+07
 renorm[gemm] counter=18 i=3 t=7.2e-05 per=1.4e+01 cost=1.5e+03 flops=2.1e+07
 renorm[gemm] counter=18 i=4 t=2.4e-06 per=4.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=5 t=2.2e-06 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=6 t=1.2e-04 per=2.4e+01 cost=7.3e+03 flops=5.9e+07
 renorm[gemm] counter=18 total t=3.0e-04 per=5.9e+01 cost=1.0e+04 flops=3.3e+07
 renorm[red] counter=18 t=2.0e-04 per=3.9e+01 cost=7.3e+03 flops=3.6e+07
--- TIMING FOR renorm_tot : t_inter=2.1e-03 t_gemm=1.1e-02 t_reduction=4.3e-03 tot=1.8e-02 ---
 renorm_tot[inter] counter=18 t=2.1e-03 per=1.2e+01 cost=1.5e+06 flops=6.9e+08
 renorm_tot[gemm] counter=18 i=0 t=5.1e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=1 t=4.1e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=2 t=1.3e-04 per=7.5e-01 cost=1.2e+03 flops=9.0e+06
 renorm_tot[gemm] counter=18 i=3 t=1.1e-04 per=6.2e-01 cost=1.5e+03 flops=1.4e+07
 renorm_tot[gemm] counter=18 i=4 t=3.6e-03 per=2.0e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=18 i=5 t=3.6e-03 per=2.0e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=18 i=6 t=3.8e-03 per=2.1e+01 cost=9.7e+05 flops=2.5e+08
 renorm_tot[gemm] counter=18 total t=1.1e-02 per=6.4e+01 cost=1.7e+06 flops=1.5e+08
 renorm_tot[red] counter=18 t=4.3e-03 per=2.4e+01 cost=4.3e+05 flops=1.0e+08
qops.to_cpu: size(tot)=507:3.9e-03MB:3.8e-06GB t[to_cpu]=1.6e-05S speed=2.4e-01GB/S
check ||H-H.dagger||=3.113e-15 coord=(18,0) rank=0
ctns::oper_ab2pq coord=(18,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00509 S rank=0 -----
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.124e+01S Sys:1.168e+00S Total:3.241e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=735:5.608e-03MB:5.476e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=41:3.128e-04MB:3.055e-07GB
total mem of comb=777:5.928e-03MB:5.789e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.124e+01S Sys:1.168e+00S Total:3.241e+01S
##### local opt: 3.529e-02 S #####
 T(local opt: fetch) = 1.917e-03 S  per = 5.43  per(accum) = 5.43
 T(local opt: hdiag) = 1.513e-03 S  per = 4.29  per(accum) = 9.72
 T(local opt: dvdsn) = 1.772e-02 S  per = 50.2  per(accum) = 59.9
 T(local opt: decim) = 3.538e-03 S  per =   10  per(accum) = 70
 T(local opt: guess) = 8.714e-05 S  per = 0.247  per(accum) = 70.2
 T(local opt: renrm) = 5.928e-03 S  per = 16.8  per(accum) = 87
 T(local opt: save ) = 4.585e-03 S  per =   13  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.772e-02 S  T(sum) = 1.691e-02 S  per = 9.539e+01
 T(local opt: preprocess                  ) = 5.162e-04 S  per = 3.05  per(accum) = 3.05
 T(local opt: symbolic_formulae           ) = 4.282e-04 S  per = 2.53  per(accum) = 5.59
 T(local opt: hintermediate init          ) = 5.444e-04 S  per = 3.22  per(accum) = 8.81
 T(local opt: preprocess_hformulae_Hxlist ) = 1.006e-02 S  per = 59.5  per(accum) = 68.3
 T(local opt: hmmtasks init               ) = 1.424e-03 S  per = 8.42  per(accum) = 76.7
 T(local opt: initial guess for dvdson    ) = 1.956e-04 S  per = 1.16  per(accum) = 77.9
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.231e-03 S  per = 19.1  per(accum) = 97
 T(local opt: dvdson solver [comm(gpu)]   ) = 3.131e-05 S  per = 0.185  per(accum) = 97.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 3.400e-08 S  per = 0.000201  per(accum) = 97.2
 T(local opt: dvdson solver [rest part]   ) = 4.783e-04 S  per = 2.83  per(accum) = 100
Detailed decomposition of T(renrm) = 5.928e-03 S  T(sum) = 5.928e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.029e-04 S  per = 1.74  per(accum) = 1.74
 T(local opt: qops init                    ) = 3.545e-04 S  per = 5.98  per(accum) = 7.72
 T(local opt: symbolic_formulae_renorm     ) = 2.009e-04 S  per = 3.39  per(accum) = 11.1
 T(local opt: allocate qops on gpu         ) = 8.444e-05 S  per = 1.42  per(accum) = 12.5
 T(local opt: site memcpy cpu2gpu          ) = 8.849e-05 S  per = 1.49  per(accum) = 14
 T(local opt: rintermediate init           ) = 3.895e-04 S  per = 6.57  per(accum) = 20.6
 T(local opt: preprocess_formulae_Rlist2   ) = 8.703e-04 S  per = 14.7  per(accum) = 35.3
 T(local opt: rmmtasks init                ) = 2.618e-04 S  per = 4.42  per(accum) = 39.7
 T(local opt: qops memset on cpu           ) = 5.000e-08 S  per = 0.000843  per(accum) = 39.7
 T(local opt: preprocess_renorm_batchGPU   ) = 2.487e-03 S  per = 41.9  per(accum) = 81.6
 T(local opt: reduction of opS & opH [nccl]) = 5.330e-07 S  per = 0.00899  per(accum) = 81.6
 T(local opt: qops memcpy gpu2cpu          ) = 2.538e-04 S  per = 4.28  per(accum) = 85.9
 T(local opt: deallocate cpu and gpu memory) = 9.931e-06 S  per = 0.168  per(accum) = 86.1
 T(local opt: reduction of opS & opH [comm]) = 8.916e-05 S  per =  1.5  per(accum) = 87.6
 T(local opt: conversion from opAB to opPQ ) = 9.335e-05 S  per = 1.57  per(accum) = 89.2
 T(local opt: after oper_renorm            ) = 6.420e-04 S  per = 10.8  per(accum) = 100
##### sweep opt: 1.398e+00 S #####
 T(sweep opt: fetch) = 1.138e-01 S  per = 8.14  per(accum) = 8.14
 T(sweep opt: hdiag) = 8.801e-02 S  per =  6.3  per(accum) = 14.4
 T(sweep opt: dvdsn) = 8.946e-01 S  per =   64  per(accum) = 78.4
 T(sweep opt: decim) = 6.704e-02 S  per =  4.8  per(accum) = 83.2
 T(sweep opt: guess) = 2.145e-03 S  per = 0.153  per(accum) = 83.4
 T(sweep opt: renrm) = 1.512e-01 S  per = 10.8  per(accum) = 94.2
 T(sweep opt: save ) = 8.100e-02 S  per =  5.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.946e-01 S  T(sum) = 8.789e-01 S  per = 9.825e+01
 T(sweep opt: preprocess                  ) = 1.074e-02 S  per = 1.22  per(accum) = 1.22
 T(sweep opt: symbolic_formulae           ) = 1.836e-02 S  per = 2.09  per(accum) = 3.31
 T(sweep opt: hintermediate init          ) = 1.052e-02 S  per =  1.2  per(accum) = 4.51
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.445e-01 S  per = 39.2  per(accum) = 43.7
 T(sweep opt: hmmtasks init               ) = 5.781e-02 S  per = 6.58  per(accum) = 50.3
 T(sweep opt: initial guess for dvdson    ) = 4.058e-03 S  per = 0.462  per(accum) = 50.7
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 3.978e-01 S  per = 45.3  per(accum) = 96
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 3.130e-03 S  per = 0.356  per(accum) = 96.4
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 5.122e-06 S  per = 0.000583  per(accum) = 96.4
 T(sweep opt: dvdson solver [rest part]   ) = 3.200e-02 S  per = 3.64  per(accum) = 100
Detailed decomposition of T(renrm) = 1.512e-01 S  T(sum) = 1.512e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.162e-03 S  per = 1.43  per(accum) = 1.43
 T(sweep opt: qops init                    ) = 8.153e-03 S  per = 5.39  per(accum) = 6.82
 T(sweep opt: symbolic_formulae_renorm     ) = 8.520e-03 S  per = 5.63  per(accum) = 12.5
 T(sweep opt: allocate qops on gpu         ) = 1.700e-03 S  per = 1.12  per(accum) = 13.6
 T(sweep opt: site memcpy cpu2gpu          ) = 1.603e-03 S  per = 1.06  per(accum) = 14.6
 T(sweep opt: rintermediate init           ) = 8.453e-03 S  per = 5.59  per(accum) = 20.2
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.518e-02 S  per = 23.3  per(accum) = 43.5
 T(sweep opt: rmmtasks init                ) = 1.125e-02 S  per = 7.44  per(accum) = 50.9
 T(sweep opt: qops memset on cpu           ) = 9.180e-07 S  per = 0.000607  per(accum) = 50.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.999e-02 S  per = 33.1  per(accum) = 84
 T(sweep opt: reduction of opS & opH [nccl]) = 1.062e-05 S  per = 0.00702  per(accum) = 84
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.903e-03 S  per = 1.26  per(accum) = 85.3
 T(sweep opt: deallocate cpu and gpu memory) = 3.211e-04 S  per = 0.212  per(accum) = 85.5
 T(sweep opt: reduction of opS & opH [comm]) = 1.585e-03 S  per = 1.05  per(accum) = 86.5
 T(sweep opt: conversion from opAB to opPQ ) = 7.335e-03 S  per = 4.85  per(accum) = 91.4
 T(sweep opt: after oper_renorm            ) = 1.304e-02 S  per = 8.63  per(accum) = 100
##### global opt: 1.398e+00 S #####
 T(global opt: fetch) = 1.138e-01 S  per = 8.14  per(accum) = 8.14
 T(global opt: hdiag) = 8.801e-02 S  per =  6.3  per(accum) = 14.4
 T(global opt: dvdsn) = 8.946e-01 S  per =   64  per(accum) = 78.4
 T(global opt: decim) = 6.704e-02 S  per =  4.8  per(accum) = 83.2
 T(global opt: guess) = 2.145e-03 S  per = 0.153  per(accum) = 83.4
 T(global opt: renrm) = 1.512e-01 S  per = 10.8  per(accum) = 94.2
 T(global opt: save ) = 8.100e-02 S  per =  5.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.946e-01 S  T(sum) = 8.789e-01 S  per = 9.825e+01
 T(global opt: preprocess                  ) = 1.074e-02 S  per = 1.22  per(accum) = 1.22
 T(global opt: symbolic_formulae           ) = 1.836e-02 S  per = 2.09  per(accum) = 3.31
 T(global opt: hintermediate init          ) = 1.052e-02 S  per =  1.2  per(accum) = 4.51
 T(global opt: preprocess_hformulae_Hxlist ) = 3.445e-01 S  per = 39.2  per(accum) = 43.7
 T(global opt: hmmtasks init               ) = 5.781e-02 S  per = 6.58  per(accum) = 50.3
 T(global opt: initial guess for dvdson    ) = 4.058e-03 S  per = 0.462  per(accum) = 50.7
 T(global opt: dvdson solver [Hx_batchGPU] ) = 3.978e-01 S  per = 45.3  per(accum) = 96
 T(global opt: dvdson solver [comm(gpu)]   ) = 3.130e-03 S  per = 0.356  per(accum) = 96.4
 T(global opt: dvdson solver [comm(cpu)]   ) = 5.122e-06 S  per = 0.000583  per(accum) = 96.4
 T(global opt: dvdson solver [rest part]   ) = 3.200e-02 S  per = 3.64  per(accum) = 100
Detailed decomposition of T(renrm) = 1.512e-01 S  T(sum) = 1.512e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.162e-03 S  per = 1.43  per(accum) = 1.43
 T(global opt: qops init                    ) = 8.153e-03 S  per = 5.39  per(accum) = 6.82
 T(global opt: symbolic_formulae_renorm     ) = 8.520e-03 S  per = 5.63  per(accum) = 12.5
 T(global opt: allocate qops on gpu         ) = 1.700e-03 S  per = 1.12  per(accum) = 13.6
 T(global opt: site memcpy cpu2gpu          ) = 1.603e-03 S  per = 1.06  per(accum) = 14.6
 T(global opt: rintermediate init           ) = 8.453e-03 S  per = 5.59  per(accum) = 20.2
 T(global opt: preprocess_formulae_Rlist2   ) = 3.518e-02 S  per = 23.3  per(accum) = 43.5
 T(global opt: rmmtasks init                ) = 1.125e-02 S  per = 7.44  per(accum) = 50.9
 T(global opt: qops memset on cpu           ) = 9.180e-07 S  per = 0.000607  per(accum) = 50.9
 T(global opt: preprocess_renorm_batchGPU   ) = 4.999e-02 S  per = 33.1  per(accum) = 84
 T(global opt: reduction of opS & opH [nccl]) = 1.062e-05 S  per = 0.00702  per(accum) = 84
 T(global opt: qops memcpy gpu2cpu          ) = 1.903e-03 S  per = 1.26  per(accum) = 85.3
 T(global opt: deallocate cpu and gpu memory) = 3.211e-04 S  per = 0.212  per(accum) = 85.5
 T(global opt: reduction of opS & opH [comm]) = 1.585e-03 S  per = 1.05  per(accum) = 86.5
 T(global opt: conversion from opAB to opPQ ) = 7.335e-03 S  per = 4.85  per(accum) = 91.4
 T(global opt: after oper_renorm            ) = 1.304e-02 S  per = 8.63  per(accum) = 100

isweep=0 ibond=18/seqsize=34 dots=2 dbond=(16,0)-(17,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.125e+01S Sys:1.168e+00S Total:3.241e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=735:5.608e-03MB:5.476e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=41:3.128e-04MB:3.055e-07GB
total mem of comb=777:5.928e-03MB:5.789e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=16,2,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 14 15
 suppc1= 12
 suppc2= 13
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:16 S:4 H:1 P:16 Q:20 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1090:8.316e-03MB:8.121e-06GB
 rqops: oplist=CSHAB nops=C:2 S:18 H:1 A:4 B:6 
        dim(bra,ket)=9,9 size(op)=19:1.450e-04MB size(tot)=507:3.868e-03MB:3.777e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=3593:2.741e-02MB:2.677e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(17,0) fdel=./scratch/sweep/lop(16,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
wf4(diml,dimr,dimc1,dimc2)=(10,9,3,3) nnz=79:6.027e-04MB
qtensor4: wf4 own=1 _data=0x55a31e9dedd0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (25,3):3 (24,2):2 (26,2):2 (25,1):1 (26,4):1 (27,3):1
 qbond: qcol nsym=5 dimAll=9
 (2,0):3 (1,1):2 (3,1):2 (4,0):1 (2,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=31 nblocks=432 size=79:6.027e-04MB
### DIAG TIMING: total=1.180e-03 t1=9.308e-06, t2=1.564e-05, t3=1.854e-05, t4=1.112e-03, t5=4.224e-06, t6=1.727e-05, t7=3.506e-06
duration_diagGPU:1.263e-03
duration_diagreduce:3.000e-08
duration_diagtransform:2.510e-07
----- TIMING FOR symbolic_formulae_twodot with size=321 : 5.029e-04 S -----
rank=0 GPUmem(GB): used=2.68e-05 (oper)=2.68e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=321
 no. of hintermediate operators=183
 no. of coefficients=1044:0.00797MB:7.78e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.159e-04 S -----
rank=0 GPUmem(GB): used=3.45e-05 (oper,hinter)=2.68e-05,7.78e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0212 S size(H_formulae)=321 size(Hxlst2)=31 T(Hmu/Hxlist)=0.000103,0.0211 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0216 S size(H_formulae)=321 size(Hxlst)=13246 -----
rank=0 GPUmem(GB): used=0.0028 (oper,hinter,dvdson,batch)=2.68e-05,7.78e-06,1.18e-06,0.00276 blksize=9 blksize0=9 batchsize=13246
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=79 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.2e-05,0.000241,0.0013,0.00105,0.00263
 ndim=79:5.89e-07GB t[comm(intra)]=2.47e-05 speed=0.0477GB/S t[comm(inter)]=7.28e-06 speed=0.162GB/S
--- TIMING FOR sigma : t_inter=2.4e-04 t_gemm=1.3e-03 t_reduction=1.1e-03 tot=2.6e-03 ---
 sigma[inter] counter=110 t=2.4e-04 per=9.3e+00 cost=2.2e+05 flops=9.3e+08
 sigma[gemm] counter=110 i=0 t=2.8e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=1 t=2.2e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=2 t=2.2e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=3 t=2.2e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=4 t=3.2e-04 per=1.2e+01 cost=5.0e+04 flops=1.6e+08
 sigma[gemm] counter=110 i=5 t=3.8e-04 per=1.5e+01 cost=5.0e+04 flops=1.3e+08
 sigma[gemm] counter=110 i=6 t=3.1e-04 per=1.2e+01 cost=5.4e+04 flops=1.8e+08
 sigma[gemm] counter=110 i=7 t=2.9e-04 per=1.1e+01 cost=5.5e+04 flops=1.9e+08
 sigma[gemm] counter=110 total t=1.3e-03 per=5.0e+01 cost=2.1e+05 flops=1.6e+08
 sigma[red] counter=110 t=1.1e-03 per=4.1e+01 cost=7.2e+04 flops=6.9e+07
--- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=8.4e-02 t_reduction=8.0e-02 tot=1.8e-01 ---
 sigma_tot[inter] counter=110 t=1.7e-02 per=9.4e+00 cost=7.8e+07 flops=4.6e+09
 sigma_tot[gemm] counter=110 i=0 t=2.8e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=1 t=2.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=2 t=2.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=3 t=2.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=4 t=1.9e-02 per=1.1e+01 cost=1.5e+07 flops=8.0e+08
 sigma_tot[gemm] counter=110 i=5 t=2.2e-02 per=1.2e+01 cost=1.5e+07 flops=7.2e+08
 sigma_tot[gemm] counter=110 i=6 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=6.9e+08
 sigma_tot[gemm] counter=110 i=7 t=2.1e-02 per=1.2e+01 cost=1.5e+07 flops=7.4e+08
 sigma_tot[gemm] counter=110 total t=8.4e-02 per=4.6e+01 cost=6.1e+07 flops=7.3e+08
 sigma_tot[red] counter=110 t=8.0e-02 per=4.4e+01 cost=1.4e+07 flops=1.8e+08
T(sub)=7.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,3.0e-06,9.8e-07,8.7e-07,2.2e-07
settings: ndim=79 neig=1 maxcycle=30 nbuff=4 memory=9e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.316728679445 -1.116e+03  4.972e-03    1     1  4.792e-03 4.792e-03 4.622e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.798e-05,1.983e-04,9.734e-04,9.683e-04,2.173e-03
 ndim=79:5.886e-07GB t[comm(intra)]=2.220e-05 speed=5.302e-02GB/S t[comm(inter)]=5.780e-06 speed=2.037e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=9.7e-04 t_reduction=9.7e-04 tot=2.1e-03 ---
 sigma[inter] counter=111 t=2.0e-04 per=9.3e+00 cost=2.2e+05 flops=1.1e+09
 sigma[gemm] counter=111 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=1 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=2 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=3 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=4 t=2.3e-04 per=1.1e+01 cost=5.0e+04 flops=2.2e+08
 sigma[gemm] counter=111 i=5 t=2.4e-04 per=1.1e+01 cost=5.0e+04 flops=2.0e+08
 sigma[gemm] counter=111 i=6 t=2.5e-04 per=1.2e+01 cost=5.4e+04 flops=2.2e+08
 sigma[gemm] counter=111 i=7 t=2.4e-04 per=1.1e+01 cost=5.5e+04 flops=2.3e+08
 sigma[gemm] counter=111 total t=9.7e-04 per=4.5e+01 cost=2.1e+05 flops=2.2e+08
 sigma[red] counter=111 t=9.7e-04 per=4.5e+01 cost=7.2e+04 flops=7.5e+07
--- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=8.5e-02 t_reduction=8.1e-02 tot=1.8e-01 ---
 sigma_tot[inter] counter=111 t=1.7e-02 per=9.4e+00 cost=7.9e+07 flops=4.6e+09
 sigma_tot[gemm] counter=111 i=0 t=2.9e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=1 t=2.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=2 t=2.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=3 t=2.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=4 t=1.9e-02 per=1.1e+01 cost=1.5e+07 flops=7.9e+08
 sigma_tot[gemm] counter=111 i=5 t=2.2e-02 per=1.2e+01 cost=1.6e+07 flops=7.1e+08
 sigma_tot[gemm] counter=111 i=6 t=2.2e-02 per=1.2e+01 cost=1.5e+07 flops=6.8e+08
 sigma_tot[gemm] counter=111 i=7 t=2.1e-02 per=1.2e+01 cost=1.6e+07 flops=7.3e+08
 sigma_tot[gemm] counter=111 total t=8.5e-02 per=4.6e+01 cost=6.1e+07 flops=7.2e+08
 sigma_tot[red] counter=111 t=8.1e-02 per=4.4e+01 cost=1.5e+07 flops=1.8e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,9.5e-06,2.3e-06,1.1e-06,1.8e-07
    2   0 -    -116.316764282601 -3.560e-05  8.028e-04    2     2  9.506e-03 4.753e-03 4.428e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.777e-05,2.141e-04,9.646e-04,9.889e-04,2.200e-03
 ndim=79:5.886e-07GB t[comm(intra)]=2.215e-05 speed=5.315e-02GB/S t[comm(inter)]=5.618e-06 speed=2.095e-01GB/S
--- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=9.6e-04 t_reduction=9.9e-04 tot=2.2e-03 ---
 sigma[inter] counter=112 t=2.1e-04 per=9.9e+00 cost=2.2e+05 flops=1.1e+09
 sigma[gemm] counter=112 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=1 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=2 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=3 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=4 t=2.4e-04 per=1.1e+01 cost=5.0e+04 flops=2.1e+08
 sigma[gemm] counter=112 i=5 t=2.3e-04 per=1.1e+01 cost=5.0e+04 flops=2.2e+08
 sigma[gemm] counter=112 i=6 t=2.5e-04 per=1.1e+01 cost=5.4e+04 flops=2.2e+08
 sigma[gemm] counter=112 i=7 t=2.4e-04 per=1.1e+01 cost=5.5e+04 flops=2.3e+08
 sigma[gemm] counter=112 total t=9.6e-04 per=4.4e+01 cost=2.1e+05 flops=2.2e+08
 sigma[red] counter=112 t=9.9e-04 per=4.6e+01 cost=7.2e+04 flops=7.3e+07
--- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=8.6e-02 t_reduction=8.2e-02 tot=1.8e-01 ---
 sigma_tot[inter] counter=112 t=1.7e-02 per=9.4e+00 cost=7.9e+07 flops=4.5e+09
 sigma_tot[gemm] counter=112 i=0 t=2.9e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=1 t=2.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=2 t=2.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=3 t=2.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=4 t=2.0e-02 per=1.1e+01 cost=1.5e+07 flops=7.9e+08
 sigma_tot[gemm] counter=112 i=5 t=2.2e-02 per=1.2e+01 cost=1.6e+07 flops=7.1e+08
 sigma_tot[gemm] counter=112 i=6 t=2.2e-02 per=1.2e+01 cost=1.5e+07 flops=6.8e+08
 sigma_tot[gemm] counter=112 i=7 t=2.1e-02 per=1.2e+01 cost=1.6e+07 flops=7.3e+08
 sigma_tot[gemm] counter=112 total t=8.6e-02 per=4.6e+01 cost=6.1e+07 flops=7.1e+08
 sigma_tot[red] counter=112 t=8.2e-02 per=4.4e+01 cost=1.5e+07 flops=1.8e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.3e-05,1.8e-06,1.1e-06,1.8e-07
    3   0 -    -116.316765757078 -1.474e-06  3.027e-04    3     3  1.389e-02 4.631e-03 4.346e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.740e-05,1.962e-04,9.698e-04,9.644e-04,2.162e-03
 ndim=79:5.886e-07GB t[comm(intra)]=2.204e-05 speed=5.341e-02GB/S t[comm(inter)]=5.362e-06 speed=2.195e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=9.7e-04 t_reduction=9.6e-04 tot=2.1e-03 ---
 sigma[inter] counter=113 t=2.0e-04 per=9.2e+00 cost=2.2e+05 flops=1.1e+09
 sigma[gemm] counter=113 i=0 t=2.6e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=1 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=2 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=3 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=4 t=2.4e-04 per=1.1e+01 cost=5.0e+04 flops=2.1e+08
 sigma[gemm] counter=113 i=5 t=2.5e-04 per=1.2e+01 cost=5.0e+04 flops=2.0e+08
 sigma[gemm] counter=113 i=6 t=2.3e-04 per=1.1e+01 cost=5.4e+04 flops=2.3e+08
 sigma[gemm] counter=113 i=7 t=2.4e-04 per=1.1e+01 cost=5.5e+04 flops=2.3e+08
 sigma[gemm] counter=113 total t=9.7e-04 per=4.6e+01 cost=2.1e+05 flops=2.2e+08
 sigma[red] counter=113 t=9.6e-04 per=4.5e+01 cost=7.2e+04 flops=7.5e+07
--- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=8.7e-02 t_reduction=8.3e-02 tot=1.9e-01 ---
 sigma_tot[inter] counter=113 t=1.8e-02 per=9.4e+00 cost=7.9e+07 flops=4.5e+09
 sigma_tot[gemm] counter=113 i=0 t=2.9e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=1 t=2.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=2 t=2.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=3 t=2.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=4 t=2.0e-02 per=1.1e+01 cost=1.5e+07 flops=7.8e+08
 sigma_tot[gemm] counter=113 i=5 t=2.2e-02 per=1.2e+01 cost=1.6e+07 flops=7.0e+08
 sigma_tot[gemm] counter=113 i=6 t=2.2e-02 per=1.2e+01 cost=1.5e+07 flops=6.7e+08
 sigma_tot[gemm] counter=113 i=7 t=2.2e-02 per=1.2e+01 cost=1.6e+07 flops=7.2e+08
 sigma_tot[gemm] counter=113 total t=8.7e-02 per=4.6e+01 cost=6.2e+07 flops=7.1e+08
 sigma_tot[red] counter=113 t=8.3e-02 per=4.4e+01 cost=1.5e+07 flops=1.8e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.1e-05,1.7e-06,9.5e-07,1.1e-07
    4   0 -    -116.316765951898 -1.948e-07  1.027e-04    3     4  1.811e-02 4.526e-03 4.269e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.668e-05,1.923e-04,9.559e-04,9.641e-04,2.144e-03
 ndim=79:5.886e-07GB t[comm(intra)]=2.175e-05 speed=5.413e-02GB/S t[comm(inter)]=4.934e-06 speed=2.386e-01GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=9.6e-04 t_reduction=9.6e-04 tot=2.1e-03 ---
 sigma[inter] counter=114 t=1.9e-04 per=9.1e+00 cost=2.2e+05 flops=1.2e+09
 sigma[gemm] counter=114 i=0 t=2.7e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=1 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=2 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=3 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=4 t=2.4e-04 per=1.1e+01 cost=5.0e+04 flops=2.1e+08
 sigma[gemm] counter=114 i=5 t=2.3e-04 per=1.1e+01 cost=5.0e+04 flops=2.2e+08
 sigma[gemm] counter=114 i=6 t=2.4e-04 per=1.1e+01 cost=5.4e+04 flops=2.3e+08
 sigma[gemm] counter=114 i=7 t=2.4e-04 per=1.1e+01 cost=5.5e+04 flops=2.3e+08
 sigma[gemm] counter=114 total t=9.6e-04 per=4.5e+01 cost=2.1e+05 flops=2.2e+08
 sigma[red] counter=114 t=9.6e-04 per=4.6e+01 cost=7.2e+04 flops=7.5e+07
--- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=8.8e-02 t_reduction=8.3e-02 tot=1.9e-01 ---
 sigma_tot[inter] counter=114 t=1.8e-02 per=9.4e+00 cost=7.9e+07 flops=4.5e+09
 sigma_tot[gemm] counter=114 i=0 t=2.9e-04 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=1 t=2.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=2 t=2.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=3 t=2.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=4 t=2.0e-02 per=1.1e+01 cost=1.6e+07 flops=7.7e+08
 sigma_tot[gemm] counter=114 i=5 t=2.2e-02 per=1.2e+01 cost=1.6e+07 flops=7.0e+08
 sigma_tot[gemm] counter=114 i=6 t=2.2e-02 per=1.2e+01 cost=1.5e+07 flops=6.7e+08
 sigma_tot[gemm] counter=114 i=7 t=2.2e-02 per=1.2e+01 cost=1.6e+07 flops=7.2e+08
 sigma_tot[gemm] counter=114 total t=8.8e-02 per=4.6e+01 cost=6.2e+07 flops=7.0e+08
 sigma_tot[red] counter=114 t=8.3e-02 per=4.4e+01 cost=1.5e+07 flops=1.8e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.0e-05,1.7e-06,8.9e-07,1.4e-07
    5   0 +    -116.316765976237 -2.434e-08  3.292e-05    3     5  2.234e-02 4.469e-03 4.229e-03
TIMING FOR Davidson : 2.242e-02  T(cal/comm/rest)=2.114e-02,2.070e-07,1.275e-03
decomposed t_rest=1.275e-03
 T(sub)    =7.972e-05 per=6.252e+00
 T(precond)=1.430e-04 per=1.122e+01
 T(ortho)  =6.679e-06 per=5.238e-01
 T(xcopy)  =7.130e-07 per=5.592e-02
 T(xnrm2)  =9.110e-07 per=7.144e-02
 T(other)  =1.044e-03 per=8.188e+01
optimized energies: isweep=0 ibond=18 dots=2 e[0]=-116.316765976237 nmvp=5
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.238e+01S Sys:1.170e+00S Total:3.355e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond18.txt
 qbond: qsuper nsym=9 dimAll=32
 (2,0):5 (1,1):2 (3,1):8 (4,0):6 (2,2):3 (5,1):3 (6,0):1 (4,2):3 (3,3):1
----- TMING FOR decimation_genbasis(su2): 9.3e-05 S -----
decimation summary: 32->10 dwt=+2.861e-05 SvN=9.576e-01
 qbond: qkept nsym=6 dimAll=10
 (4,2):3 (3,1):2 (2,2):2 (4,0):1 (5,1):1 (3,3):1
----- TIMING for decimation_row(nkr): 3.129e-03 S T(decim/select/formRot)=3.940e-04,2.586e-03,1.482e-04 -----
----- TIMING FOR twodot_decimation: 3.395e-03 S T(wf/decim)=1.704e-04,3.224e-03 -----
ctns::oper_renorm coord=(17,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:3 S:17 H:1 A:9 B:12 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=815:6.218e-03MB:6.072e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.245e+01S Sys:1.170e+00S Total:3.362e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=42 : 1.968e-04 S -----
rank=0 GPUmem(GB): used=3.25e-05 (oper)=1.73e-05
rank=0 GPUmem(GB): used=3.28e-05 (oper,site)(GB)=1.73e-05,3.05e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=42
 no. of rintermediate operators=141
 no. of coefficients=372:0.00284MB:2.77e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.081e-04 S -----
rank=0 GPUmem(GB): used=3.56e-05 (oper,site,rinter)=1.73e-05,3.05e-07,2.77e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00187 S size(rtasks)=42 size(Rlst2)=36 T(Rmu/Rlist)=6.38e-05,0.0018 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.002 S size(rtasks)=42 size(Rlst)=2315 -----
rank=0 GPUmem(GB): used=3.56e-05 (oper,site,rinter,batch)=1.73e-05,3.05e-07,2.77e-06,0.000483 blksize=9 blksize0=9 batchsize=2315
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000173,0.000904,0.000316
--- TIMING FOR renorm : t_inter=1.7e-04 t_gemm=9.0e-04 t_reduction=3.2e-04 tot=1.4e-03 ---
 renorm[inter] counter=19 t=1.7e-04 per=1.2e+01 cost=2.3e+04 flops=1.3e+08
 renorm[gemm] counter=19 i=0 t=2.8e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=1 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=2 t=2.9e-04 per=2.1e+01 cost=1.2e+04 flops=4.1e+07
 renorm[gemm] counter=19 i=3 t=3.0e-04 per=2.1e+01 cost=1.0e+04 flops=3.4e+07
 renorm[gemm] counter=19 i=4 t=2.3e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=5 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=19 i=6 t=3.1e-04 per=2.2e+01 cost=2.6e+04 flops=8.6e+07
 renorm[gemm] counter=19 total t=9.0e-04 per=6.5e+01 cost=4.8e+04 flops=5.4e+07
 renorm[red] counter=19 t=3.2e-04 per=2.3e+01 cost=1.5e+04 flops=4.8e+07
--- TIMING FOR renorm_tot : t_inter=2.3e-03 t_gemm=1.2e-02 t_reduction=4.6e-03 tot=1.9e-02 ---
 renorm_tot[inter] counter=19 t=2.3e-03 per=1.2e+01 cost=1.5e+06 flops=6.5e+08
 renorm_tot[gemm] counter=19 i=0 t=5.4e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=1 t=4.4e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=19 i=2 t=4.2e-04 per=2.2e+00 cost=1.3e+04 flops=3.1e+07
 renorm_tot[gemm] counter=19 i=3 t=4.1e-04 per=2.1e+00 cost=1.2e+04 flops=2.9e+07
 renorm_tot[gemm] counter=19 i=4 t=3.6e-03 per=1.9e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=19 i=5 t=3.6e-03 per=1.9e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=19 i=6 t=4.1e-03 per=2.2e+01 cost=9.9e+05 flops=2.4e+08
 renorm_tot[gemm] counter=19 total t=1.2e-02 per=6.4e+01 cost=1.8e+06 flops=1.4e+08
 renorm_tot[red] counter=19 t=4.6e-03 per=2.4e+01 cost=4.5e+05 flops=9.7e+07
qops.to_cpu: size(tot)=815:6.2e-03MB:6.1e-06GB t[to_cpu]=1.6e-05S speed=3.7e-01GB/S
check ||H-H.dagger||=3.511e-16 coord=(17,0) rank=0
ctns::oper_ab2pq coord=(17,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00739 S rank=0 -----
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.268e+01S Sys:1.171e+00S Total:3.385e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=735:5.608e-03MB:5.476e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=47:3.586e-04MB:3.502e-07GB
total mem of comb=783:5.974e-03MB:5.834e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.269e+01S Sys:1.171e+00S Total:3.386e+01S
##### local opt: 7.558e-02 S #####
 T(local opt: fetch) = 6.553e-03 S  per = 8.67  per(accum) = 8.67
 T(local opt: hdiag) = 2.185e-03 S  per = 2.89  per(accum) = 11.6
 T(local opt: dvdsn) = 5.132e-02 S  per = 67.9  per(accum) = 79.5
 T(local opt: decim) = 3.471e-03 S  per = 4.59  per(accum) = 84.1
 T(local opt: guess) = 1.298e-04 S  per = 0.172  per(accum) = 84.2
 T(local opt: renrm) = 8.258e-03 S  per = 10.9  per(accum) = 95.2
 T(local opt: save ) = 3.662e-03 S  per = 4.85  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.132e-02 S  T(sum) = 5.040e-02 S  per = 9.820e+01
 T(local opt: preprocess                  ) = 7.763e-04 S  per = 1.54  per(accum) = 1.54
 T(local opt: symbolic_formulae           ) = 5.851e-04 S  per = 1.16  per(accum) = 2.7
 T(local opt: hintermediate init          ) = 5.298e-04 S  per = 1.05  per(accum) = 3.75
 T(local opt: preprocess_hformulae_Hxlist ) = 2.175e-02 S  per = 43.2  per(accum) = 46.9
 T(local opt: hmmtasks init               ) = 4.045e-03 S  per = 8.03  per(accum) = 54.9
 T(local opt: initial guess for dvdson    ) = 2.908e-04 S  per = 0.577  per(accum) = 55.5
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.100e-02 S  per = 41.7  per(accum) = 97.2
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.418e-04 S  per = 0.281  per(accum) = 97.5
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.070e-07 S  per = 0.000411  per(accum) = 97.5
 T(local opt: dvdson solver [rest part]   ) = 1.275e-03 S  per = 2.53  per(accum) = 100
Detailed decomposition of T(renrm) = 8.258e-03 S  T(sum) = 8.258e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.069e-04 S  per = 1.29  per(accum) = 1.29
 T(local opt: qops init                    ) = 3.809e-04 S  per = 4.61  per(accum) = 5.91
 T(local opt: symbolic_formulae_renorm     ) = 2.733e-04 S  per = 3.31  per(accum) = 9.22
 T(local opt: allocate qops on gpu         ) = 7.981e-05 S  per = 0.966  per(accum) = 10.2
 T(local opt: site memcpy cpu2gpu          ) = 8.302e-05 S  per = 1.01  per(accum) = 11.2
 T(local opt: rintermediate init           ) = 4.474e-04 S  per = 5.42  per(accum) = 16.6
 T(local opt: preprocess_formulae_Rlist2   ) = 2.072e-03 S  per = 25.1  per(accum) = 41.7
 T(local opt: rmmtasks init                ) = 7.758e-04 S  per = 9.39  per(accum) = 51.1
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 0.0004  per(accum) = 51.1
 T(local opt: preprocess_renorm_batchGPU   ) = 3.090e-03 S  per = 37.4  per(accum) = 88.5
 T(local opt: reduction of opS & opH [nccl]) = 4.750e-07 S  per = 0.00575  per(accum) = 88.5
 T(local opt: qops memcpy gpu2cpu          ) = 9.151e-05 S  per = 1.11  per(accum) = 89.6
 T(local opt: deallocate cpu and gpu memory) = 1.073e-05 S  per = 0.13  per(accum) = 89.8
 T(local opt: reduction of opS & opH [comm]) = 8.913e-05 S  per = 1.08  per(accum) = 90.8
 T(local opt: conversion from opAB to opPQ ) = 7.467e-05 S  per = 0.904  per(accum) = 91.7
 T(local opt: after oper_renorm            ) = 6.823e-04 S  per = 8.26  per(accum) = 100
##### sweep opt: 1.473e+00 S #####
 T(sweep opt: fetch) = 1.204e-01 S  per = 8.17  per(accum) = 8.17
 T(sweep opt: hdiag) = 9.020e-02 S  per = 6.12  per(accum) = 14.3
 T(sweep opt: dvdsn) = 9.459e-01 S  per = 64.2  per(accum) = 78.5
 T(sweep opt: decim) = 7.051e-02 S  per = 4.79  per(accum) = 83.3
 T(sweep opt: guess) = 2.275e-03 S  per = 0.154  per(accum) = 83.4
 T(sweep opt: renrm) = 1.595e-01 S  per = 10.8  per(accum) = 94.3
 T(sweep opt: save ) = 8.467e-02 S  per = 5.75  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.459e-01 S  T(sum) = 9.293e-01 S  per = 9.825e+01
 T(sweep opt: preprocess                  ) = 1.151e-02 S  per = 1.24  per(accum) = 1.24
 T(sweep opt: symbolic_formulae           ) = 1.894e-02 S  per = 2.04  per(accum) = 3.28
 T(sweep opt: hintermediate init          ) = 1.105e-02 S  per = 1.19  per(accum) = 4.47
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.663e-01 S  per = 39.4  per(accum) = 43.9
 T(sweep opt: hmmtasks init               ) = 6.186e-02 S  per = 6.66  per(accum) = 50.5
 T(sweep opt: initial guess for dvdson    ) = 4.349e-03 S  per = 0.468  per(accum) = 51
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 4.188e-01 S  per = 45.1  per(accum) = 96.1
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 3.272e-03 S  per = 0.352  per(accum) = 96.4
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 5.329e-06 S  per = 0.000573  per(accum) = 96.4
 T(sweep opt: dvdson solver [rest part]   ) = 3.327e-02 S  per = 3.58  per(accum) = 100
Detailed decomposition of T(renrm) = 1.595e-01 S  T(sum) = 1.595e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.269e-03 S  per = 1.42  per(accum) = 1.42
 T(sweep opt: qops init                    ) = 8.533e-03 S  per = 5.35  per(accum) = 6.77
 T(sweep opt: symbolic_formulae_renorm     ) = 8.793e-03 S  per = 5.51  per(accum) = 12.3
 T(sweep opt: allocate qops on gpu         ) = 1.780e-03 S  per = 1.12  per(accum) = 13.4
 T(sweep opt: site memcpy cpu2gpu          ) = 1.686e-03 S  per = 1.06  per(accum) = 14.5
 T(sweep opt: rintermediate init           ) = 8.901e-03 S  per = 5.58  per(accum) = 20
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.725e-02 S  per = 23.4  per(accum) = 43.4
 T(sweep opt: rmmtasks init                ) = 1.202e-02 S  per = 7.54  per(accum) = 50.9
 T(sweep opt: qops memset on cpu           ) = 9.510e-07 S  per = 0.000596  per(accum) = 50.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.308e-02 S  per = 33.3  per(accum) = 84.2
 T(sweep opt: reduction of opS & opH [nccl]) = 1.109e-05 S  per = 0.00696  per(accum) = 84.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.995e-03 S  per = 1.25  per(accum) = 85.5
 T(sweep opt: deallocate cpu and gpu memory) = 3.318e-04 S  per = 0.208  per(accum) = 85.7
 T(sweep opt: reduction of opS & opH [comm]) = 1.674e-03 S  per = 1.05  per(accum) = 86.7
 T(sweep opt: conversion from opAB to opPQ ) = 7.410e-03 S  per = 4.65  per(accum) = 91.4
 T(sweep opt: after oper_renorm            ) = 1.373e-02 S  per = 8.61  per(accum) = 100
##### global opt: 1.473e+00 S #####
 T(global opt: fetch) = 1.204e-01 S  per = 8.17  per(accum) = 8.17
 T(global opt: hdiag) = 9.020e-02 S  per = 6.12  per(accum) = 14.3
 T(global opt: dvdsn) = 9.459e-01 S  per = 64.2  per(accum) = 78.5
 T(global opt: decim) = 7.051e-02 S  per = 4.79  per(accum) = 83.3
 T(global opt: guess) = 2.275e-03 S  per = 0.154  per(accum) = 83.4
 T(global opt: renrm) = 1.595e-01 S  per = 10.8  per(accum) = 94.3
 T(global opt: save ) = 8.467e-02 S  per = 5.75  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.459e-01 S  T(sum) = 9.293e-01 S  per = 9.825e+01
 T(global opt: preprocess                  ) = 1.151e-02 S  per = 1.24  per(accum) = 1.24
 T(global opt: symbolic_formulae           ) = 1.894e-02 S  per = 2.04  per(accum) = 3.28
 T(global opt: hintermediate init          ) = 1.105e-02 S  per = 1.19  per(accum) = 4.47
 T(global opt: preprocess_hformulae_Hxlist ) = 3.663e-01 S  per = 39.4  per(accum) = 43.9
 T(global opt: hmmtasks init               ) = 6.186e-02 S  per = 6.66  per(accum) = 50.5
 T(global opt: initial guess for dvdson    ) = 4.349e-03 S  per = 0.468  per(accum) = 51
 T(global opt: dvdson solver [Hx_batchGPU] ) = 4.188e-01 S  per = 45.1  per(accum) = 96.1
 T(global opt: dvdson solver [comm(gpu)]   ) = 3.272e-03 S  per = 0.352  per(accum) = 96.4
 T(global opt: dvdson solver [comm(cpu)]   ) = 5.329e-06 S  per = 0.000573  per(accum) = 96.4
 T(global opt: dvdson solver [rest part]   ) = 3.327e-02 S  per = 3.58  per(accum) = 100
Detailed decomposition of T(renrm) = 1.595e-01 S  T(sum) = 1.595e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.269e-03 S  per = 1.42  per(accum) = 1.42
 T(global opt: qops init                    ) = 8.533e-03 S  per = 5.35  per(accum) = 6.77
 T(global opt: symbolic_formulae_renorm     ) = 8.793e-03 S  per = 5.51  per(accum) = 12.3
 T(global opt: allocate qops on gpu         ) = 1.780e-03 S  per = 1.12  per(accum) = 13.4
 T(global opt: site memcpy cpu2gpu          ) = 1.686e-03 S  per = 1.06  per(accum) = 14.5
 T(global opt: rintermediate init           ) = 8.901e-03 S  per = 5.58  per(accum) = 20
 T(global opt: preprocess_formulae_Rlist2   ) = 3.725e-02 S  per = 23.4  per(accum) = 43.4
 T(global opt: rmmtasks init                ) = 1.202e-02 S  per = 7.54  per(accum) = 50.9
 T(global opt: qops memset on cpu           ) = 9.510e-07 S  per = 0.000596  per(accum) = 50.9
 T(global opt: preprocess_renorm_batchGPU   ) = 5.308e-02 S  per = 33.3  per(accum) = 84.2
 T(global opt: reduction of opS & opH [nccl]) = 1.109e-05 S  per = 0.00696  per(accum) = 84.2
 T(global opt: qops memcpy gpu2cpu          ) = 1.995e-03 S  per = 1.25  per(accum) = 85.5
 T(global opt: deallocate cpu and gpu memory) = 3.318e-04 S  per = 0.208  per(accum) = 85.7
 T(global opt: reduction of opS & opH [comm]) = 1.674e-03 S  per = 1.05  per(accum) = 86.7
 T(global opt: conversion from opAB to opPQ ) = 7.410e-03 S  per = 4.65  per(accum) = 91.4
 T(global opt: after oper_renorm            ) = 1.373e-02 S  per = 8.61  per(accum) = 100

isweep=0 ibond=19/seqsize=34 dots=2 dbond=(15,0)-(16,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.269e+01S Sys:1.171e+00S Total:3.386e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=735:5.608e-03MB:5.476e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=47:3.586e-04MB:3.502e-07GB
total mem of comb=783:5.974e-03MB:5.834e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=15,3,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 13 14 15
 suppc1= 11
 suppc2= 12
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:15 S:5 H:1 P:25 Q:30 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=1425:1.087e-02MB:1.062e-05GB
 rqops: oplist=CSHAB nops=C:3 S:17 H:1 A:9 B:12 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=815:6.218e-03MB:6.072e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=4236:3.232e-02MB:3.156e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(16,0) fdel=./scratch/sweep/lop(15,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=115:8.774e-04MB
qtensor4: wf4 own=1 _data=0x55a322862440
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (23,3):3 (24,2):2 (24,4):2 (22,2):1 (23,1):1 (25,3):1
 qbond: qcol nsym=6 dimAll=10
 (4,2):3 (3,1):2 (2,2):2 (4,0):1 (5,1):1 (3,3):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=40 nblocks=552 size=115:8.774e-04MB
### DIAG TIMING: total=2.412e-03 t1=9.766e-06, t2=2.024e-05, t3=2.260e-05, t4=2.332e-03, t5=4.539e-06, t6=1.869e-05, t7=4.221e-06
duration_diagGPU:2.493e-03
duration_diagreduce:4.500e-08
duration_diagtransform:2.650e-07
----- TIMING FOR symbolic_formulae_twodot with size=372 : 6.086e-04 S -----
rank=0 GPUmem(GB): used=3.16e-05 (oper)=3.16e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=372
 no. of hintermediate operators=217
 no. of coefficients=1722:0.0131MB:1.28e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.217e-04 S -----
rank=0 GPUmem(GB): used=4.44e-05 (oper,hinter)=3.16e-05,1.28e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0352 S size(H_formulae)=372 size(Hxlst2)=40 T(Hmu/Hxlist)=0.000133,0.035 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0358 S size(H_formulae)=372 size(Hxlst)=21844 -----
rank=0 GPUmem(GB): used=0.0046 (oper,hinter,dvdson,batch)=3.16e-05,1.28e-05,1.71e-06,0.00456 blksize=9 blksize0=9 batchsize=21844
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=115 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.39e-05,0.000353,0.00139,0.00136,0.00315
 ndim=115:8.57e-07GB t[comm(intra)]=2.65e-05 speed=0.0648GB/S t[comm(inter)]=7.46e-06 speed=0.23GB/S
--- TIMING FOR sigma : t_inter=3.5e-04 t_gemm=1.4e-03 t_reduction=1.4e-03 tot=3.1e-03 ---
 sigma[inter] counter=115 t=3.5e-04 per=1.1e+01 cost=6.3e+05 flops=1.8e+09
 sigma[gemm] counter=115 i=0 t=2.5e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=1 t=3.0e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=2 t=2.2e-06 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=3 t=3.0e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=4 t=3.5e-04 per=1.1e+01 cost=1.2e+05 flops=3.4e+08
 sigma[gemm] counter=115 i=5 t=4.0e-04 per=1.3e+01 cost=1.1e+05 flops=2.9e+08
 sigma[gemm] counter=115 i=6 t=3.2e-04 per=1.0e+01 cost=1.0e+05 flops=3.2e+08
 sigma[gemm] counter=115 i=7 t=3.2e-04 per=1.0e+01 cost=1.0e+05 flops=3.2e+08
 sigma[gemm] counter=115 total t=1.4e-03 per=4.5e+01 cost=4.4e+05 flops=3.1e+08
 sigma[red] counter=115 t=1.4e-03 per=4.4e+01 cost=1.4e+05 flops=1.0e+08
--- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=8.9e-02 t_reduction=8.5e-02 tot=1.9e-01 ---
 sigma_tot[inter] counter=115 t=1.8e-02 per=9.4e+00 cost=8.0e+07 flops=4.4e+09
 sigma_tot[gemm] counter=115 i=0 t=3.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=1 t=2.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=2 t=2.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=3 t=2.5e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=4 t=2.0e-02 per=1.1e+01 cost=1.6e+07 flops=7.7e+08
 sigma_tot[gemm] counter=115 i=5 t=2.3e-02 per=1.2e+01 cost=1.6e+07 flops=6.9e+08
 sigma_tot[gemm] counter=115 i=6 t=2.3e-02 per=1.2e+01 cost=1.5e+07 flops=6.6e+08
 sigma_tot[gemm] counter=115 i=7 t=2.2e-02 per=1.2e+01 cost=1.6e+07 flops=7.1e+08
 sigma_tot[gemm] counter=115 total t=8.9e-02 per=4.6e+01 cost=6.2e+07 flops=7.0e+08
 sigma_tot[red] counter=115 t=8.5e-02 per=4.4e+01 cost=1.5e+07 flops=1.8e+08
T(sub)=8.3e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,3.2e-06,1.0e-06,9.2e-07,2.3e-07
settings: ndim=115 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.316747067343 -1.116e+03  1.828e-02    1     1  5.359e-03 5.359e-03 5.180e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.835e-05,2.673e-04,1.041e-03,1.288e-03,2.629e-03
 ndim=115:8.568e-07GB t[comm(intra)]=2.260e-05 speed=7.584e-02GB/S t[comm(inter)]=5.756e-06 speed=2.977e-01GB/S
--- TIMING FOR sigma : t_inter=2.7e-04 t_gemm=1.0e-03 t_reduction=1.3e-03 tot=2.6e-03 ---
 sigma[inter] counter=116 t=2.7e-04 per=1.0e+01 cost=6.3e+05 flops=2.4e+09
 sigma[gemm] counter=116 i=0 t=2.7e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=1 t=2.2e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=2 t=2.2e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=3 t=2.2e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=4 t=2.5e-04 per=9.8e+00 cost=1.2e+05 flops=4.6e+08
 sigma[gemm] counter=116 i=5 t=2.6e-04 per=1.0e+01 cost=1.1e+05 flops=4.4e+08
 sigma[gemm] counter=116 i=6 t=2.7e-04 per=1.0e+01 cost=1.0e+05 flops=3.8e+08
 sigma[gemm] counter=116 i=7 t=2.5e-04 per=9.5e+00 cost=1.0e+05 flops=4.1e+08
 sigma[gemm] counter=116 total t=1.0e-03 per=4.0e+01 cost=4.4e+05 flops=4.2e+08
 sigma[red] counter=116 t=1.3e-03 per=5.0e+01 cost=1.4e+05 flops=1.1e+08
--- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=9.0e-02 t_reduction=8.6e-02 tot=1.9e-01 ---
 sigma_tot[inter] counter=116 t=1.8e-02 per=9.4e+00 cost=8.0e+07 flops=4.4e+09
 sigma_tot[gemm] counter=116 i=0 t=3.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=1 t=2.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=2 t=2.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=3 t=2.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=4 t=2.1e-02 per=1.1e+01 cost=1.6e+07 flops=7.6e+08
 sigma_tot[gemm] counter=116 i=5 t=2.3e-02 per=1.2e+01 cost=1.6e+07 flops=6.9e+08
 sigma_tot[gemm] counter=116 i=6 t=2.3e-02 per=1.2e+01 cost=1.5e+07 flops=6.6e+08
 sigma_tot[gemm] counter=116 i=7 t=2.2e-02 per=1.2e+01 cost=1.6e+07 flops=7.1e+08
 sigma_tot[gemm] counter=116 total t=9.0e-02 per=4.6e+01 cost=6.3e+07 flops=6.9e+08
 sigma_tot[red] counter=116 t=8.6e-02 per=4.4e+01 cost=1.5e+07 flops=1.7e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,1.0e-05,2.5e-06,1.2e-06,2.0e-07
    2   0 -    -116.317173934304 -4.269e-04  3.616e-03    2     2  1.053e-02 5.266e-03 4.926e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.866e-05,2.618e-04,1.026e-03,1.278e-03,2.600e-03
 ndim=115:8.568e-07GB t[comm(intra)]=2.281e-05 speed=7.514e-02GB/S t[comm(inter)]=5.856e-06 speed=2.926e-01GB/S
--- TIMING FOR sigma : t_inter=2.6e-04 t_gemm=1.0e-03 t_reduction=1.3e-03 tot=2.6e-03 ---
 sigma[inter] counter=117 t=2.6e-04 per=1.0e+01 cost=6.3e+05 flops=2.4e+09
 sigma[gemm] counter=117 i=0 t=2.7e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=1 t=2.2e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=2 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=3 t=2.2e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=4 t=2.5e-04 per=9.8e+00 cost=1.2e+05 flops=4.7e+08
 sigma[gemm] counter=117 i=5 t=2.6e-04 per=1.0e+01 cost=1.1e+05 flops=4.4e+08
 sigma[gemm] counter=117 i=6 t=2.5e-04 per=9.9e+00 cost=1.0e+05 flops=4.1e+08
 sigma[gemm] counter=117 i=7 t=2.5e-04 per=9.7e+00 cost=1.0e+05 flops=4.1e+08
 sigma[gemm] counter=117 total t=1.0e-03 per=4.0e+01 cost=4.4e+05 flops=4.3e+08
 sigma[red] counter=117 t=1.3e-03 per=5.0e+01 cost=1.4e+05 flops=1.1e+08
--- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=9.1e-02 t_reduction=8.7e-02 tot=2.0e-01 ---
 sigma_tot[inter] counter=117 t=1.9e-02 per=9.4e+00 cost=8.1e+07 flops=4.4e+09
 sigma_tot[gemm] counter=117 i=0 t=3.0e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=1 t=2.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=2 t=2.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=3 t=2.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=4 t=2.1e-02 per=1.1e+01 cost=1.6e+07 flops=7.6e+08
 sigma_tot[gemm] counter=117 i=5 t=2.3e-02 per=1.2e+01 cost=1.6e+07 flops=6.8e+08
 sigma_tot[gemm] counter=117 i=6 t=2.3e-02 per=1.2e+01 cost=1.5e+07 flops=6.6e+08
 sigma_tot[gemm] counter=117 i=7 t=2.3e-02 per=1.1e+01 cost=1.6e+07 flops=7.0e+08
 sigma_tot[gemm] counter=117 total t=9.1e-02 per=4.6e+01 cost=6.3e+07 flops=6.9e+08
 sigma_tot[red] counter=117 t=8.7e-02 per=4.4e+01 cost=1.5e+07 flops=1.7e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.3e-05,1.8e-06,1.0e-06,1.9e-07
    3   0 -    -116.317223655373 -4.972e-05  1.683e-03    3     3  1.533e-02 5.109e-03 4.795e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.723e-05,2.579e-04,1.005e-03,1.272e-03,2.567e-03
 ndim=115:8.568e-07GB t[comm(intra)]=2.165e-05 speed=7.916e-02GB/S t[comm(inter)]=5.576e-06 speed=3.073e-01GB/S
--- TIMING FOR sigma : t_inter=2.6e-04 t_gemm=1.0e-03 t_reduction=1.3e-03 tot=2.5e-03 ---
 sigma[inter] counter=118 t=2.6e-04 per=1.0e+01 cost=6.3e+05 flops=2.4e+09
 sigma[gemm] counter=118 i=0 t=2.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=1 t=2.2e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=2 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=3 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=4 t=2.5e-04 per=9.8e+00 cost=1.2e+05 flops=4.7e+08
 sigma[gemm] counter=118 i=5 t=2.6e-04 per=1.0e+01 cost=1.1e+05 flops=4.4e+08
 sigma[gemm] counter=118 i=6 t=2.4e-04 per=9.7e+00 cost=1.0e+05 flops=4.2e+08
 sigma[gemm] counter=118 i=7 t=2.5e-04 per=9.7e+00 cost=1.0e+05 flops=4.2e+08
 sigma[gemm] counter=118 total t=1.0e-03 per=4.0e+01 cost=4.4e+05 flops=4.4e+08
 sigma[red] counter=118 t=1.3e-03 per=5.0e+01 cost=1.4e+05 flops=1.1e+08
--- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=9.2e-02 t_reduction=8.9e-02 tot=2.0e-01 ---
 sigma_tot[inter] counter=118 t=1.9e-02 per=9.4e+00 cost=8.2e+07 flops=4.3e+09
 sigma_tot[gemm] counter=118 i=0 t=3.1e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=1 t=2.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=2 t=2.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=3 t=2.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=4 t=2.1e-02 per=1.1e+01 cost=1.6e+07 flops=7.6e+08
 sigma_tot[gemm] counter=118 i=5 t=2.4e-02 per=1.2e+01 cost=1.6e+07 flops=6.8e+08
 sigma_tot[gemm] counter=118 i=6 t=2.3e-02 per=1.2e+01 cost=1.5e+07 flops=6.6e+08
 sigma_tot[gemm] counter=118 i=7 t=2.3e-02 per=1.1e+01 cost=1.6e+07 flops=7.0e+08
 sigma_tot[gemm] counter=118 total t=9.2e-02 per=4.6e+01 cost=6.4e+07 flops=6.9e+08
 sigma_tot[red] counter=118 t=8.9e-02 per=4.4e+01 cost=1.5e+07 flops=1.7e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.1e-05,1.8e-06,1.1e-06,1.7e-07
    4   0 -    -116.317230451088 -6.796e-06  6.074e-04    3     4  2.004e-02 5.009e-03 4.722e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.838e-05,2.593e-04,1.047e-03,1.267e-03,2.606e-03
 ndim=115:8.568e-07GB t[comm(intra)]=2.286e-05 speed=7.497e-02GB/S t[comm(inter)]=5.524e-06 speed=3.102e-01GB/S
--- TIMING FOR sigma : t_inter=2.6e-04 t_gemm=1.0e-03 t_reduction=1.3e-03 tot=2.6e-03 ---
 sigma[inter] counter=119 t=2.6e-04 per=1.0e+01 cost=6.3e+05 flops=2.4e+09
 sigma[gemm] counter=119 i=0 t=2.4e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=1 t=2.4e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=2 t=3.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=3 t=3.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=4 t=2.7e-04 per=1.0e+01 cost=1.2e+05 flops=4.4e+08
 sigma[gemm] counter=119 i=5 t=2.6e-04 per=1.0e+01 cost=1.1e+05 flops=4.3e+08
 sigma[gemm] counter=119 i=6 t=2.6e-04 per=1.0e+01 cost=1.0e+05 flops=4.0e+08
 sigma[gemm] counter=119 i=7 t=2.5e-04 per=9.6e+00 cost=1.0e+05 flops=4.2e+08
 sigma[gemm] counter=119 total t=1.0e-03 per=4.1e+01 cost=4.4e+05 flops=4.2e+08
 sigma[red] counter=119 t=1.3e-03 per=4.9e+01 cost=1.4e+05 flops=1.1e+08
--- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=9.3e-02 t_reduction=9.0e-02 tot=2.0e-01 ---
 sigma_tot[inter] counter=119 t=1.9e-02 per=9.5e+00 cost=8.2e+07 flops=4.3e+09
 sigma_tot[gemm] counter=119 i=0 t=3.1e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=1 t=2.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=2 t=2.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=3 t=2.6e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=4 t=2.1e-02 per=1.1e+01 cost=1.6e+07 flops=7.5e+08
 sigma_tot[gemm] counter=119 i=5 t=2.4e-02 per=1.2e+01 cost=1.6e+07 flops=6.8e+08
 sigma_tot[gemm] counter=119 i=6 t=2.4e-02 per=1.2e+01 cost=1.5e+07 flops=6.5e+08
 sigma_tot[gemm] counter=119 i=7 t=2.3e-02 per=1.1e+01 cost=1.6e+07 flops=7.0e+08
 sigma_tot[gemm] counter=119 total t=9.3e-02 per=4.6e+01 cost=6.4e+07 flops=6.9e+08
 sigma_tot[red] counter=119 t=9.0e-02 per=4.4e+01 cost=1.5e+07 flops=1.7e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.1e-05,1.8e-06,9.7e-07,1.5e-07
    5   0 -    -116.317231340389 -8.893e-07  2.148e-04    3     5  2.486e-02 4.971e-03 4.690e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.726e-05,2.639e-04,1.025e-03,1.268e-03,2.589e-03
 ndim=115:8.568e-07GB t[comm(intra)]=2.158e-05 speed=7.939e-02GB/S t[comm(inter)]=5.673e-06 speed=3.021e-01GB/S
--- TIMING FOR sigma : t_inter=2.6e-04 t_gemm=1.0e-03 t_reduction=1.3e-03 tot=2.6e-03 ---
 sigma[inter] counter=120 t=2.6e-04 per=1.0e+01 cost=6.3e+05 flops=2.4e+09
 sigma[gemm] counter=120 i=0 t=2.7e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=1 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=2 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=3 t=2.2e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=4 t=2.5e-04 per=9.8e+00 cost=1.2e+05 flops=4.7e+08
 sigma[gemm] counter=120 i=5 t=2.6e-04 per=1.0e+01 cost=1.1e+05 flops=4.4e+08
 sigma[gemm] counter=120 i=6 t=2.6e-04 per=1.0e+01 cost=1.0e+05 flops=4.0e+08
 sigma[gemm] counter=120 i=7 t=2.5e-04 per=9.7e+00 cost=1.0e+05 flops=4.1e+08
 sigma[gemm] counter=120 total t=1.0e-03 per=4.0e+01 cost=4.4e+05 flops=4.3e+08
 sigma[red] counter=120 t=1.3e-03 per=5.0e+01 cost=1.4e+05 flops=1.1e+08
--- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=9.4e-02 t_reduction=9.1e-02 tot=2.0e-01 ---
 sigma_tot[inter] counter=120 t=1.9e-02 per=9.5e+00 cost=8.3e+07 flops=4.3e+09
 sigma_tot[gemm] counter=120 i=0 t=3.1e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=1 t=2.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=2 t=2.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=3 t=2.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=4 t=2.2e-02 per=1.1e+01 cost=1.6e+07 flops=7.5e+08
 sigma_tot[gemm] counter=120 i=5 t=2.4e-02 per=1.2e+01 cost=1.6e+07 flops=6.8e+08
 sigma_tot[gemm] counter=120 i=6 t=2.4e-02 per=1.2e+01 cost=1.5e+07 flops=6.5e+08
 sigma_tot[gemm] counter=120 i=7 t=2.3e-02 per=1.1e+01 cost=1.6e+07 flops=7.0e+08
 sigma_tot[gemm] counter=120 total t=9.4e-02 per=4.6e+01 cost=6.4e+07 flops=6.8e+08
 sigma_tot[red] counter=120 t=9.1e-02 per=4.5e+01 cost=1.6e+07 flops=1.7e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.1e-05,1.8e-06,9.3e-07,1.5e-07
    6   0 +    -116.317231466819 -1.264e-07  8.444e-05    3     6  2.966e-02 4.944e-03 4.668e-03
TIMING FOR Davidson : 2.974e-02  T(cal/comm/rest)=2.801e-02,2.470e-07,1.732e-03
decomposed t_rest=1.732e-03
 T(sub)    =1.017e-04 per=5.872e+00
 T(precond)=3.782e-04 per=2.184e+01
 T(ortho)  =1.076e-05 per=6.212e-01
 T(xcopy)  =7.510e-07 per=4.337e-02
 T(xnrm2)  =1.134e-06 per=6.549e-02
 T(other)  =1.239e-03 per=7.156e+01
optimized energies: isweep=0 ibond=19 dots=2 e[0]=-116.317231466819 nmvp=6
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.418e+01S Sys:1.175e+00S Total:3.536e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond19.txt
 qbond: qsuper nsym=11 dimAll=39
 (4,2):8 (3,1):4 (2,2):2 (4,0):3 (5,1):7 (3,3):3 (6,2):4 (6,0):2 (7,1):1 (5,3):4 (4,4):1
----- TMING FOR decimation_genbasis(su2): 8.5e-05 S -----
decimation summary: 39->10 dwt=+3.341e-04 SvN=7.724e-01
 qbond: qkept nsym=6 dimAll=10
 (5,3):3 (4,2):2 (6,2):2 (5,1):1 (7,1):1 (4,4):1
----- TIMING for decimation_row(nkr): 3.333e-03 S T(decim/select/formRot)=3.822e-04,2.786e-03,1.651e-04 -----
----- TIMING FOR twodot_decimation: 3.631e-03 S T(wf/decim)=1.967e-04,3.435e-03 -----
ctns::oper_renorm coord=(16,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:4 S:16 H:1 A:16 B:20 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1050:8.011e-03MB:7.823e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.431e+01S Sys:1.175e+00S Total:3.549e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=57 : 2.406e-04 S -----
rank=0 GPUmem(GB): used=4.16e-05 (oper)=2.13e-05
rank=0 GPUmem(GB): used=4.19e-05 (oper,site)(GB)=2.13e-05,3.35e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=57
 no. of rintermediate operators=149
 no. of coefficients=702:0.00536MB:5.23e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.391e-04 S -----
rank=0 GPUmem(GB): used=4.72e-05 (oper,site,rinter)=2.13e-05,3.35e-07,5.23e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00198 S size(rtasks)=57 size(Rlst2)=36 T(Rmu/Rlist)=7.06e-05,0.00191 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00212 S size(rtasks)=57 size(Rlst)=2376 -----
rank=0 GPUmem(GB): used=4.72e-05 (oper,site,rinter,batch)=2.13e-05,3.35e-07,5.23e-06,0.000496 blksize=9 blksize0=9 batchsize=2376
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000244,0.000897,0.000344
--- TIMING FOR renorm : t_inter=2.4e-04 t_gemm=9.0e-04 t_reduction=3.4e-04 tot=1.5e-03 ---
 renorm[inter] counter=20 t=2.4e-04 per=1.6e+01 cost=5.5e+04 flops=2.3e+08
 renorm[gemm] counter=20 i=0 t=2.9e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=1 t=2.3e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=2 t=2.8e-04 per=1.9e+01 cost=1.5e+04 flops=5.5e+07
 renorm[gemm] counter=20 i=3 t=2.9e-04 per=1.9e+01 cost=1.6e+04 flops=5.4e+07
 renorm[gemm] counter=20 i=4 t=2.3e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=5 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=6 t=3.2e-04 per=2.2e+01 cost=3.1e+04 flops=9.6e+07
 renorm[gemm] counter=20 total t=9.0e-04 per=6.0e+01 cost=6.2e+04 flops=6.9e+07
 renorm[red] counter=20 t=3.4e-04 per=2.3e+01 cost=1.6e+04 flops=4.6e+07
--- TIMING FOR renorm_tot : t_inter=2.5e-03 t_gemm=1.3e-02 t_reduction=5.0e-03 tot=2.1e-02 ---
 renorm_tot[inter] counter=20 t=2.5e-03 per=1.2e+01 cost=1.5e+06 flops=6.1e+08
 renorm_tot[gemm] counter=20 i=0 t=5.7e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=1 t=4.6e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=2 t=7.0e-04 per=3.4e+00 cost=2.8e+04 flops=4.0e+07
 renorm_tot[gemm] counter=20 i=3 t=7.0e-04 per=3.4e+00 cost=2.7e+04 flops=3.9e+07
 renorm_tot[gemm] counter=20 i=4 t=3.6e-03 per=1.7e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=20 i=5 t=3.6e-03 per=1.7e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=20 i=6 t=4.4e-03 per=2.2e+01 cost=1.0e+06 flops=2.3e+08
 renorm_tot[gemm] counter=20 total t=1.3e-02 per=6.4e+01 cost=1.8e+06 flops=1.4e+08
 renorm_tot[red] counter=20 t=5.0e-03 per=2.4e+01 cost=4.6e+05 flops=9.3e+07
qops.to_cpu: size(tot)=1050:8.0e-03MB:7.8e-06GB t[to_cpu]=1.8e-05S speed=4.4e-01GB/S
check ||H-H.dagger||=1.609e-15 coord=(16,0) rank=0
ctns::oper_ab2pq coord=(16,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00785 S rank=0 -----
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.449e+01S Sys:1.175e+00S Total:3.567e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=733:5.592e-03MB:5.461e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=52:3.967e-04MB:3.874e-07GB
total mem of comb=786:5.997e-03MB:5.856e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.450e+01S Sys:1.175e+00S Total:3.567e+01S
##### local opt: 1.034e-01 S #####
 T(local opt: fetch) = 7.204e-03 S  per = 6.97  per(accum) = 6.97
 T(local opt: hdiag) = 3.455e-03 S  per = 3.34  per(accum) = 10.3
 T(local opt: dvdsn) = 7.567e-02 S  per = 73.2  per(accum) = 83.5
 T(local opt: decim) = 3.718e-03 S  per =  3.6  per(accum) = 87.1
 T(local opt: guess) = 1.473e-04 S  per = 0.142  per(accum) = 87.3
 T(local opt: renrm) = 8.736e-03 S  per = 8.45  per(accum) = 95.7
 T(local opt: save ) = 4.428e-03 S  per = 4.28  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.567e-02 S  T(sum) = 7.471e-02 S  per = 9.873e+01
 T(local opt: preprocess                  ) = 9.404e-04 S  per = 1.26  per(accum) = 1.26
 T(local opt: symbolic_formulae           ) = 6.945e-04 S  per = 0.93  per(accum) = 2.19
 T(local opt: hintermediate init          ) = 5.365e-04 S  per = 0.718  per(accum) = 2.91
 T(local opt: preprocess_hformulae_Hxlist ) = 3.597e-02 S  per = 48.1  per(accum) = 51
 T(local opt: hmmtasks init               ) = 6.510e-03 S  per = 8.71  per(accum) = 59.8
 T(local opt: initial guess for dvdson    ) = 3.192e-04 S  per = 0.427  per(accum) = 60.2
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.784e-02 S  per = 37.3  per(accum) = 97.4
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.738e-04 S  per = 0.233  per(accum) = 97.7
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.470e-07 S  per = 0.000331  per(accum) = 97.7
 T(local opt: dvdson solver [rest part]   ) = 1.732e-03 S  per = 2.32  per(accum) = 100
Detailed decomposition of T(renrm) = 8.736e-03 S  T(sum) = 8.736e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.305e-04 S  per = 1.49  per(accum) = 1.49
 T(local opt: qops init                    ) = 4.288e-04 S  per = 4.91  per(accum) = 6.4
 T(local opt: symbolic_formulae_renorm     ) = 3.220e-04 S  per = 3.69  per(accum) = 10.1
 T(local opt: allocate qops on gpu         ) = 9.549e-05 S  per = 1.09  per(accum) = 11.2
 T(local opt: site memcpy cpu2gpu          ) = 9.518e-05 S  per = 1.09  per(accum) = 12.3
 T(local opt: rintermediate init           ) = 4.843e-04 S  per = 5.54  per(accum) = 17.8
 T(local opt: preprocess_formulae_Rlist2   ) = 2.199e-03 S  per = 25.2  per(accum) = 43
 T(local opt: rmmtasks init                ) = 8.125e-04 S  per =  9.3  per(accum) = 52.3
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 0.000378  per(accum) = 52.3
 T(local opt: preprocess_renorm_batchGPU   ) = 3.223e-03 S  per = 36.9  per(accum) = 89.2
 T(local opt: reduction of opS & opH [nccl]) = 6.400e-07 S  per = 0.00733  per(accum) = 89.2
 T(local opt: qops memcpy gpu2cpu          ) = 9.009e-05 S  per = 1.03  per(accum) = 90.2
 T(local opt: deallocate cpu and gpu memory) = 1.125e-05 S  per = 0.129  per(accum) = 90.4
 T(local opt: reduction of opS & opH [comm]) = 8.511e-05 S  per = 0.974  per(accum) = 91.3
 T(local opt: conversion from opAB to opPQ ) = 7.393e-05 S  per = 0.846  per(accum) = 92.2
 T(local opt: after oper_renorm            ) = 6.839e-04 S  per = 7.83  per(accum) = 100
##### sweep opt: 1.577e+00 S #####
 T(sweep opt: fetch) = 1.276e-01 S  per = 8.09  per(accum) = 8.09
 T(sweep opt: hdiag) = 9.365e-02 S  per = 5.94  per(accum) = 14
 T(sweep opt: dvdsn) = 1.022e+00 S  per = 64.8  per(accum) = 78.8
 T(sweep opt: decim) = 7.423e-02 S  per = 4.71  per(accum) = 83.5
 T(sweep opt: guess) = 2.422e-03 S  per = 0.154  per(accum) = 83.7
 T(sweep opt: renrm) = 1.682e-01 S  per = 10.7  per(accum) = 94.3
 T(sweep opt: save ) = 8.910e-02 S  per = 5.65  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.022e+00 S  T(sum) = 1.004e+00 S  per = 9.828e+01
 T(sweep opt: preprocess                  ) = 1.245e-02 S  per = 1.24  per(accum) = 1.24
 T(sweep opt: symbolic_formulae           ) = 1.964e-02 S  per = 1.96  per(accum) = 3.2
 T(sweep opt: hintermediate init          ) = 1.159e-02 S  per = 1.15  per(accum) = 4.35
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.022e-01 S  per = 40.1  per(accum) = 44.4
 T(sweep opt: hmmtasks init               ) = 6.837e-02 S  per = 6.81  per(accum) = 51.2
 T(sweep opt: initial guess for dvdson    ) = 4.668e-03 S  per = 0.465  per(accum) = 51.7
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 4.466e-01 S  per = 44.5  per(accum) = 96.2
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 3.446e-03 S  per = 0.343  per(accum) = 96.5
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 5.576e-06 S  per = 0.000555  per(accum) = 96.5
 T(sweep opt: dvdson solver [rest part]   ) = 3.500e-02 S  per = 3.49  per(accum) = 100
Detailed decomposition of T(renrm) = 1.682e-01 S  T(sum) = 1.682e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.400e-03 S  per = 1.43  per(accum) = 1.43
 T(sweep opt: qops init                    ) = 8.962e-03 S  per = 5.33  per(accum) = 6.75
 T(sweep opt: symbolic_formulae_renorm     ) = 9.115e-03 S  per = 5.42  per(accum) = 12.2
 T(sweep opt: allocate qops on gpu         ) = 1.875e-03 S  per = 1.11  per(accum) = 13.3
 T(sweep opt: site memcpy cpu2gpu          ) = 1.781e-03 S  per = 1.06  per(accum) = 14.3
 T(sweep opt: rintermediate init           ) = 9.385e-03 S  per = 5.58  per(accum) = 19.9
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.945e-02 S  per = 23.5  per(accum) = 43.4
 T(sweep opt: rmmtasks init                ) = 1.283e-02 S  per = 7.63  per(accum) = 51
 T(sweep opt: qops memset on cpu           ) = 9.840e-07 S  per = 0.000585  per(accum) = 51
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.631e-02 S  per = 33.5  per(accum) = 84.5
 T(sweep opt: reduction of opS & opH [nccl]) = 1.173e-05 S  per = 0.00698  per(accum) = 84.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.085e-03 S  per = 1.24  per(accum) = 85.7
 T(sweep opt: deallocate cpu and gpu memory) = 3.430e-04 S  per = 0.204  per(accum) = 85.9
 T(sweep opt: reduction of opS & opH [comm]) = 1.759e-03 S  per = 1.05  per(accum) = 87
 T(sweep opt: conversion from opAB to opPQ ) = 7.484e-03 S  per = 4.45  per(accum) = 91.4
 T(sweep opt: after oper_renorm            ) = 1.441e-02 S  per = 8.57  per(accum) = 100
##### global opt: 1.577e+00 S #####
 T(global opt: fetch) = 1.276e-01 S  per = 8.09  per(accum) = 8.09
 T(global opt: hdiag) = 9.365e-02 S  per = 5.94  per(accum) = 14
 T(global opt: dvdsn) = 1.022e+00 S  per = 64.8  per(accum) = 78.8
 T(global opt: decim) = 7.423e-02 S  per = 4.71  per(accum) = 83.5
 T(global opt: guess) = 2.422e-03 S  per = 0.154  per(accum) = 83.7
 T(global opt: renrm) = 1.682e-01 S  per = 10.7  per(accum) = 94.3
 T(global opt: save ) = 8.910e-02 S  per = 5.65  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.022e+00 S  T(sum) = 1.004e+00 S  per = 9.828e+01
 T(global opt: preprocess                  ) = 1.245e-02 S  per = 1.24  per(accum) = 1.24
 T(global opt: symbolic_formulae           ) = 1.964e-02 S  per = 1.96  per(accum) = 3.2
 T(global opt: hintermediate init          ) = 1.159e-02 S  per = 1.15  per(accum) = 4.35
 T(global opt: preprocess_hformulae_Hxlist ) = 4.022e-01 S  per = 40.1  per(accum) = 44.4
 T(global opt: hmmtasks init               ) = 6.837e-02 S  per = 6.81  per(accum) = 51.2
 T(global opt: initial guess for dvdson    ) = 4.668e-03 S  per = 0.465  per(accum) = 51.7
 T(global opt: dvdson solver [Hx_batchGPU] ) = 4.466e-01 S  per = 44.5  per(accum) = 96.2
 T(global opt: dvdson solver [comm(gpu)]   ) = 3.446e-03 S  per = 0.343  per(accum) = 96.5
 T(global opt: dvdson solver [comm(cpu)]   ) = 5.576e-06 S  per = 0.000555  per(accum) = 96.5
 T(global opt: dvdson solver [rest part]   ) = 3.500e-02 S  per = 3.49  per(accum) = 100
Detailed decomposition of T(renrm) = 1.682e-01 S  T(sum) = 1.682e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.400e-03 S  per = 1.43  per(accum) = 1.43
 T(global opt: qops init                    ) = 8.962e-03 S  per = 5.33  per(accum) = 6.75
 T(global opt: symbolic_formulae_renorm     ) = 9.115e-03 S  per = 5.42  per(accum) = 12.2
 T(global opt: allocate qops on gpu         ) = 1.875e-03 S  per = 1.11  per(accum) = 13.3
 T(global opt: site memcpy cpu2gpu          ) = 1.781e-03 S  per = 1.06  per(accum) = 14.3
 T(global opt: rintermediate init           ) = 9.385e-03 S  per = 5.58  per(accum) = 19.9
 T(global opt: preprocess_formulae_Rlist2   ) = 3.945e-02 S  per = 23.5  per(accum) = 43.4
 T(global opt: rmmtasks init                ) = 1.283e-02 S  per = 7.63  per(accum) = 51
 T(global opt: qops memset on cpu           ) = 9.840e-07 S  per = 0.000585  per(accum) = 51
 T(global opt: preprocess_renorm_batchGPU   ) = 5.631e-02 S  per = 33.5  per(accum) = 84.5
 T(global opt: reduction of opS & opH [nccl]) = 1.173e-05 S  per = 0.00698  per(accum) = 84.5
 T(global opt: qops memcpy gpu2cpu          ) = 2.085e-03 S  per = 1.24  per(accum) = 85.7
 T(global opt: deallocate cpu and gpu memory) = 3.430e-04 S  per = 0.204  per(accum) = 85.9
 T(global opt: reduction of opS & opH [comm]) = 1.759e-03 S  per = 1.05  per(accum) = 87
 T(global opt: conversion from opAB to opPQ ) = 7.484e-03 S  per = 4.45  per(accum) = 91.4
 T(global opt: after oper_renorm            ) = 1.441e-02 S  per = 8.57  per(accum) = 100

isweep=0 ibond=20/seqsize=34 dots=2 dbond=(14,0)-(15,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.450e+01S Sys:1.175e+00S Total:3.567e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=733:5.592e-03MB:5.461e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=52:3.967e-04MB:3.874e-07GB
total mem of comb=786:5.997e-03MB:5.856e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=14,4,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 12 13 14 15
 suppc1= 10
 suppc2= 11
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:14 S:6 H:1 P:36 Q:42 
        dim(bra,ket)=7,7 size(op)=21:1.602e-04MB size(tot)=1039:7.927e-03MB:7.741e-06GB
 rqops: oplist=CSHAB nops=C:4 S:16 H:1 A:16 B:20 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1050:8.011e-03MB:7.823e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=4085:3.117e-02MB:3.044e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(15,0) fdel=./scratch/sweep/lop(14,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
wf4(diml,dimr,dimc1,dimc2)=(7,10,3,3) nnz=97:7.401e-04MB
qtensor4: wf4 own=1 _data=0x55a322c7c310
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=7
 (22,2):2 (21,3):2 (22,4):2 (23,3):1
 qbond: qcol nsym=6 dimAll=10
 (5,3):3 (4,2):2 (6,2):2 (5,1):1 (7,1):1 (4,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=30 nblocks=384 size=97:7.401e-04MB
### DIAG TIMING: total=3.157e-03 t1=9.010e-06, t2=1.609e-05, t3=1.829e-05, t4=3.087e-03, t5=4.254e-06, t6=1.778e-05, t7=4.381e-06
duration_diagGPU:3.243e-03
duration_diagreduce:4.200e-08
duration_diagtransform:2.360e-07
----- TIMING FOR symbolic_formulae_twodot with size=437 : 7.672e-04 S -----
rank=0 GPUmem(GB): used=3.04e-05 (oper)=3.04e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=437
 no. of hintermediate operators=240
 no. of coefficients=2470:0.0188MB:1.84e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.523e-04 S -----
rank=0 GPUmem(GB): used=4.88e-05 (oper,hinter)=3.04e-05,1.84e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0268 S size(H_formulae)=437 size(Hxlst2)=30 T(Hmu/Hxlist)=0.000149,0.0267 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0273 S size(H_formulae)=437 size(Hxlst)=16598 -----
rank=0 GPUmem(GB): used=0.00277 (oper,hinter,dvdson,batch)=3.04e-05,1.84e-05,1.45e-06,0.00272 blksize=6 blksize0=9 batchsize=16598
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=97 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.22e-05,0.000295,0.001,0.00104,0.00238
 ndim=97:7.23e-07GB t[comm(intra)]=2.48e-05 speed=0.0582GB/S t[comm(inter)]=7.33e-06 speed=0.197GB/S
--- TIMING FOR sigma : t_inter=2.9e-04 t_gemm=1.0e-03 t_reduction=1.0e-03 tot=2.3e-03 ---
 sigma[inter] counter=121 t=2.9e-04 per=1.3e+01 cost=6.3e+05 flops=2.1e+09
 sigma[gemm] counter=121 i=0 t=2.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=1 t=2.3e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=2 t=2.2e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=3 t=2.2e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=4 t=2.9e-04 per=1.2e+01 cost=1.1e+05 flops=3.8e+08
 sigma[gemm] counter=121 i=5 t=2.9e-04 per=1.3e+01 cost=1.0e+05 flops=3.5e+08
 sigma[gemm] counter=121 i=6 t=2.1e-04 per=9.1e+00 cost=7.7e+04 flops=3.7e+08
 sigma[gemm] counter=121 i=7 t=2.0e-04 per=8.6e+00 cost=7.8e+04 flops=3.9e+08
 sigma[gemm] counter=121 total t=1.0e-03 per=4.3e+01 cost=3.6e+05 flops=3.6e+08
 sigma[red] counter=121 t=1.0e-03 per=4.5e+01 cost=1.1e+05 flops=1.1e+08
--- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=9.5e-02 t_reduction=9.2e-02 tot=2.1e-01 ---
 sigma_tot[inter] counter=121 t=2.0e-02 per=9.5e+00 cost=8.4e+07 flops=4.2e+09
 sigma_tot[gemm] counter=121 i=0 t=3.1e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=1 t=2.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=2 t=2.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=3 t=2.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=4 t=2.2e-02 per=1.1e+01 cost=1.6e+07 flops=7.4e+08
 sigma_tot[gemm] counter=121 i=5 t=2.4e-02 per=1.2e+01 cost=1.6e+07 flops=6.7e+08
 sigma_tot[gemm] counter=121 i=6 t=2.4e-02 per=1.2e+01 cost=1.6e+07 flops=6.5e+08
 sigma_tot[gemm] counter=121 i=7 t=2.4e-02 per=1.1e+01 cost=1.6e+07 flops=6.9e+08
 sigma_tot[gemm] counter=121 total t=9.5e-02 per=4.6e+01 cost=6.5e+07 flops=6.8e+08
 sigma_tot[red] counter=121 t=9.2e-02 per=4.5e+01 cost=1.6e+07 flops=1.7e+08
T(sub)=8.2e-06 T(gemm/eig/ortho/gemm/axpy)=3.0e-06,3.0e-06,9.9e-07,9.3e-07,2.4e-07
settings: ndim=97 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.316983833544 -1.116e+03  1.087e-02    1     1  4.686e-03 4.686e-03 4.499e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.809e-05,2.390e-04,8.053e-04,9.708e-04,2.048e-03
 ndim=97:7.227e-07GB t[comm(intra)]=2.232e-05 speed=6.475e-02GB/S t[comm(inter)]=5.770e-06 speed=2.505e-01GB/S
--- TIMING FOR sigma : t_inter=2.4e-04 t_gemm=8.0e-04 t_reduction=9.7e-04 tot=2.0e-03 ---
 sigma[inter] counter=122 t=2.4e-04 per=1.2e+01 cost=6.3e+05 flops=2.6e+09
 sigma[gemm] counter=122 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=1 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=4 t=2.1e-04 per=1.1e+01 cost=1.1e+05 flops=5.0e+08
 sigma[gemm] counter=122 i=5 t=2.2e-04 per=1.1e+01 cost=1.0e+05 flops=4.5e+08
 sigma[gemm] counter=122 i=6 t=1.8e-04 per=8.8e+00 cost=7.7e+04 flops=4.3e+08
 sigma[gemm] counter=122 i=7 t=1.8e-04 per=8.9e+00 cost=7.8e+04 flops=4.3e+08
 sigma[gemm] counter=122 total t=8.0e-04 per=4.0e+01 cost=3.6e+05 flops=4.5e+08
 sigma[red] counter=122 t=9.7e-04 per=4.8e+01 cost=1.1e+05 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=9.6e-02 t_reduction=9.3e-02 tot=2.1e-01 ---
 sigma_tot[inter] counter=122 t=2.0e-02 per=9.5e+00 cost=8.4e+07 flops=4.2e+09
 sigma_tot[gemm] counter=122 i=0 t=3.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=1 t=2.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=2 t=2.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=3 t=2.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=4 t=2.2e-02 per=1.1e+01 cost=1.6e+07 flops=7.4e+08
 sigma_tot[gemm] counter=122 i=5 t=2.5e-02 per=1.2e+01 cost=1.7e+07 flops=6.7e+08
 sigma_tot[gemm] counter=122 i=6 t=2.4e-02 per=1.2e+01 cost=1.6e+07 flops=6.5e+08
 sigma_tot[gemm] counter=122 i=7 t=2.4e-02 per=1.1e+01 cost=1.6e+07 flops=6.9e+08
 sigma_tot[gemm] counter=122 total t=9.6e-02 per=4.6e+01 cost=6.5e+07 flops=6.8e+08
 sigma_tot[red] counter=122 t=9.3e-02 per=4.5e+01 cost=1.6e+07 flops=1.7e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,9.6e-06,2.2e-06,1.0e-06,2.2e-07
    2   0 -    -116.317273851910 -2.900e-04  2.982e-03    2     2  9.238e-03 4.619e-03 4.274e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.772e-05,2.251e-04,7.579e-04,9.601e-04,1.976e-03
 ndim=97:7.227e-07GB t[comm(intra)]=2.232e-05 speed=6.476e-02GB/S t[comm(inter)]=5.402e-06 speed=2.676e-01GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=7.6e-04 t_reduction=9.6e-04 tot=1.9e-03 ---
 sigma[inter] counter=123 t=2.3e-04 per=1.2e+01 cost=6.3e+05 flops=2.8e+09
 sigma[gemm] counter=123 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=1 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=4 t=2.1e-04 per=1.1e+01 cost=1.1e+05 flops=5.1e+08
 sigma[gemm] counter=123 i=5 t=2.2e-04 per=1.1e+01 cost=1.0e+05 flops=4.6e+08
 sigma[gemm] counter=123 i=6 t=1.6e-04 per=8.1e+00 cost=7.7e+04 flops=4.9e+08
 sigma[gemm] counter=123 i=7 t=1.6e-04 per=8.2e+00 cost=7.8e+04 flops=4.9e+08
 sigma[gemm] counter=123 total t=7.6e-04 per=3.9e+01 cost=3.6e+05 flops=4.8e+08
 sigma[red] counter=123 t=9.6e-04 per=4.9e+01 cost=1.1e+05 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=9.7e-02 t_reduction=9.4e-02 tot=2.1e-01 ---
 sigma_tot[inter] counter=123 t=2.0e-02 per=9.5e+00 cost=8.5e+07 flops=4.2e+09
 sigma_tot[gemm] counter=123 i=0 t=3.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=1 t=2.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=2 t=2.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=3 t=2.7e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=4 t=2.2e-02 per=1.1e+01 cost=1.7e+07 flops=7.4e+08
 sigma_tot[gemm] counter=123 i=5 t=2.5e-02 per=1.2e+01 cost=1.7e+07 flops=6.7e+08
 sigma_tot[gemm] counter=123 i=6 t=2.4e-02 per=1.2e+01 cost=1.6e+07 flops=6.5e+08
 sigma_tot[gemm] counter=123 i=7 t=2.4e-02 per=1.1e+01 cost=1.7e+07 flops=6.9e+08
 sigma_tot[gemm] counter=123 total t=9.7e-02 per=4.6e+01 cost=6.5e+07 flops=6.8e+08
 sigma_tot[red] counter=123 t=9.4e-02 per=4.5e+01 cost=1.6e+07 flops=1.7e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.2e-05,1.9e-06,9.8e-07,2.3e-07
    3   0 -    -116.317293224830 -1.937e-05  1.085e-03    3     3  1.339e-02 4.462e-03 4.169e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.714e-05,2.218e-04,7.819e-04,9.564e-04,1.991e-03
 ndim=97:7.227e-07GB t[comm(intra)]=2.214e-05 speed=6.529e-02GB/S t[comm(inter)]=4.999e-06 speed=2.891e-01GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=7.8e-04 t_reduction=9.6e-04 tot=2.0e-03 ---
 sigma[inter] counter=124 t=2.2e-04 per=1.1e+01 cost=6.3e+05 flops=2.9e+09
 sigma[gemm] counter=124 i=0 t=2.6e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=1 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=4 t=2.0e-04 per=1.0e+01 cost=1.1e+05 flops=5.3e+08
 sigma[gemm] counter=124 i=5 t=2.2e-04 per=1.1e+01 cost=1.0e+05 flops=4.6e+08
 sigma[gemm] counter=124 i=6 t=1.7e-04 per=8.5e+00 cost=7.7e+04 flops=4.6e+08
 sigma[gemm] counter=124 i=7 t=1.8e-04 per=9.1e+00 cost=7.8e+04 flops=4.4e+08
 sigma[gemm] counter=124 total t=7.8e-04 per=4.0e+01 cost=3.6e+05 flops=4.7e+08
 sigma[red] counter=124 t=9.6e-04 per=4.9e+01 cost=1.1e+05 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=9.8e-02 t_reduction=9.5e-02 tot=2.1e-01 ---
 sigma_tot[inter] counter=124 t=2.0e-02 per=9.6e+00 cost=8.6e+07 flops=4.2e+09
 sigma_tot[gemm] counter=124 i=0 t=3.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=1 t=2.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=2 t=2.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=3 t=2.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=4 t=2.3e-02 per=1.1e+01 cost=1.7e+07 flops=7.4e+08
 sigma_tot[gemm] counter=124 i=5 t=2.5e-02 per=1.2e+01 cost=1.7e+07 flops=6.7e+08
 sigma_tot[gemm] counter=124 i=6 t=2.5e-02 per=1.2e+01 cost=1.6e+07 flops=6.4e+08
 sigma_tot[gemm] counter=124 i=7 t=2.4e-02 per=1.1e+01 cost=1.7e+07 flops=6.9e+08
 sigma_tot[gemm] counter=124 total t=9.8e-02 per=4.6e+01 cost=6.6e+07 flops=6.7e+08
 sigma_tot[red] counter=124 t=9.5e-02 per=4.5e+01 cost=1.6e+07 flops=1.7e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.1e-05,1.7e-06,8.7e-07,1.9e-07
    4   0 -    -116.317295375903 -2.151e-06  3.934e-04    3     4  1.750e-02 4.375e-03 4.109e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.763e-05,2.384e-04,8.434e-04,9.669e-04,2.081e-03
 ndim=97:7.227e-07GB t[comm(intra)]=2.168e-05 speed=6.665e-02GB/S t[comm(inter)]=5.948e-06 speed=2.430e-01GB/S
--- TIMING FOR sigma : t_inter=2.4e-04 t_gemm=8.4e-04 t_reduction=9.7e-04 tot=2.0e-03 ---
 sigma[inter] counter=125 t=2.4e-04 per=1.2e+01 cost=6.3e+05 flops=2.7e+09
 sigma[gemm] counter=125 i=0 t=2.4e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=1 t=2.7e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=2 t=3.1e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=3 t=3.0e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=4 t=2.4e-04 per=1.2e+01 cost=1.1e+05 flops=4.5e+08
 sigma[gemm] counter=125 i=5 t=2.4e-04 per=1.2e+01 cost=1.0e+05 flops=4.2e+08
 sigma[gemm] counter=125 i=6 t=1.8e-04 per=8.9e+00 cost=7.7e+04 flops=4.2e+08
 sigma[gemm] counter=125 i=7 t=1.7e-04 per=8.4e+00 cost=7.8e+04 flops=4.5e+08
 sigma[gemm] counter=125 total t=8.4e-04 per=4.1e+01 cost=3.6e+05 flops=4.3e+08
 sigma[red] counter=125 t=9.7e-04 per=4.7e+01 cost=1.1e+05 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=9.8e-02 t_reduction=9.6e-02 tot=2.2e-01 ---
 sigma_tot[inter] counter=125 t=2.1e-02 per=9.6e+00 cost=8.6e+07 flops=4.2e+09
 sigma_tot[gemm] counter=125 i=0 t=3.2e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=1 t=2.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=2 t=2.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=3 t=2.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=4 t=2.3e-02 per=1.1e+01 cost=1.7e+07 flops=7.3e+08
 sigma_tot[gemm] counter=125 i=5 t=2.5e-02 per=1.2e+01 cost=1.7e+07 flops=6.6e+08
 sigma_tot[gemm] counter=125 i=6 t=2.5e-02 per=1.1e+01 cost=1.6e+07 flops=6.4e+08
 sigma_tot[gemm] counter=125 i=7 t=2.4e-02 per=1.1e+01 cost=1.7e+07 flops=6.9e+08
 sigma_tot[gemm] counter=125 total t=9.8e-02 per=4.6e+01 cost=6.6e+07 flops=6.7e+08
 sigma_tot[red] counter=125 t=9.6e-02 per=4.5e+01 cost=1.6e+07 flops=1.7e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.0e-05,1.7e-06,8.4e-07,1.5e-07
    5   0 -    -116.317295765957 -3.901e-07  1.661e-04    3     5  2.174e-02 4.349e-03 4.099e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.747e-05,2.220e-04,7.779e-04,9.505e-04,1.982e-03
 ndim=97:7.227e-07GB t[comm(intra)]=2.220e-05 speed=6.512e-02GB/S t[comm(inter)]=5.269e-06 speed=2.743e-01GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=7.8e-04 t_reduction=9.5e-04 tot=1.9e-03 ---
 sigma[inter] counter=126 t=2.2e-04 per=1.1e+01 cost=6.3e+05 flops=2.9e+09
 sigma[gemm] counter=126 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=1 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=4 t=2.2e-04 per=1.1e+01 cost=1.1e+05 flops=5.0e+08
 sigma[gemm] counter=126 i=5 t=2.4e-04 per=1.2e+01 cost=1.0e+05 flops=4.3e+08
 sigma[gemm] counter=126 i=6 t=1.6e-04 per=8.1e+00 cost=7.7e+04 flops=4.9e+08
 sigma[gemm] counter=126 i=7 t=1.6e-04 per=8.1e+00 cost=7.8e+04 flops=4.9e+08
 sigma[gemm] counter=126 total t=7.8e-04 per=4.0e+01 cost=3.6e+05 flops=4.7e+08
 sigma[red] counter=126 t=9.5e-04 per=4.9e+01 cost=1.1e+05 flops=1.2e+08
--- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=9.9e-02 t_reduction=9.7e-02 tot=2.2e-01 ---
 sigma_tot[inter] counter=126 t=2.1e-02 per=9.6e+00 cost=8.7e+07 flops=4.2e+09
 sigma_tot[gemm] counter=126 i=0 t=3.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=1 t=2.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=2 t=2.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=3 t=2.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=4 t=2.3e-02 per=1.1e+01 cost=1.7e+07 flops=7.3e+08
 sigma_tot[gemm] counter=126 i=5 t=2.6e-02 per=1.2e+01 cost=1.7e+07 flops=6.6e+08
 sigma_tot[gemm] counter=126 i=6 t=2.5e-02 per=1.1e+01 cost=1.6e+07 flops=6.4e+08
 sigma_tot[gemm] counter=126 i=7 t=2.4e-02 per=1.1e+01 cost=1.7e+07 flops=6.8e+08
 sigma_tot[gemm] counter=126 total t=9.9e-02 per=4.6e+01 cost=6.7e+07 flops=6.7e+08
 sigma_tot[red] counter=126 t=9.7e-02 per=4.5e+01 cost=1.6e+07 flops=1.7e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.0e-05,1.6e-06,8.0e-07,1.2e-07
    6   0 +    -116.317295830465 -6.451e-08  7.554e-05    3     6  2.583e-02 4.306e-03 4.068e-03
TIMING FOR Davidson : 2.590e-02  T(cal/comm/rest)=2.441e-02,2.850e-07,1.488e-03
decomposed t_rest=1.488e-03
 T(sub)    =9.591e-05 per=6.446e+00
 T(precond)=1.368e-04 per=9.197e+00
 T(ortho)  =9.079e-06 per=6.102e-01
 T(xcopy)  =7.430e-07 per=4.993e-02
 T(xnrm2)  =9.650e-07 per=6.485e-02
 T(other)  =1.244e-03 per=8.363e+01
optimized energies: isweep=0 ibond=20 dots=2 e[0]=-116.317295830465 nmvp=6
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.587e+01S Sys:1.184e+00S Total:3.706e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=13 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond20.txt
 qbond: qsuper nsym=13 dimAll=40
 (5,3):6 (4,2):2 (6,2):8 (5,1):3 (7,1):4 (4,4):1 (7,3):5 (8,2):3 (9,1):1 (6,4):4 (6,0):1 (8,0):1 (5,5):1
----- TMING FOR decimation_genbasis(su2): 8.3e-05 S -----
decimation summary: 40->10 dwt=+6.719e-05 SvN=2.693e-01
 qbond: qkept nsym=5 dimAll=10
 (6,2):3 (7,3):3 (6,4):2 (5,3):1 (8,2):1
----- TIMING for decimation_row(nkr): 3.499e-03 S T(decim/select/formRot)=3.909e-04,2.947e-03,1.611e-04 -----
----- TIMING FOR twodot_decimation: 3.787e-03 S T(wf/decim)=1.997e-04,3.588e-03 -----
ctns::oper_renorm coord=(15,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:5 S:15 H:1 A:25 B:30 
        dim(bra,ket)=10,10 size(op)=36:2.747e-04MB size(tot)=1554:1.186e-02MB:1.158e-05GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.608e+01S Sys:1.184e+00S Total:3.726e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=76 : 2.802e-04 S -----
rank=0 GPUmem(GB): used=5.27e-05 (oper)=2.68e-05
rank=0 GPUmem(GB): used=5.31e-05 (oper,site)(GB)=2.68e-05,4.17e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=76
 no. of rintermediate operators=140
 no. of coefficients=1070:0.00816MB:7.97e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.265e-04 S -----
rank=0 GPUmem(GB): used=6.11e-05 (oper,site,rinter)=2.68e-05,4.17e-07,7.97e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00185 S size(rtasks)=76 size(Rlst2)=25 T(Rmu/Rlist)=7.68e-05,0.00178 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.002 S size(rtasks)=76 size(Rlst)=2258 -----
rank=0 GPUmem(GB): used=6.11e-05 (oper,site,rinter,batch)=2.68e-05,4.17e-07,7.97e-06,0.000471 blksize=9 blksize0=9 batchsize=2258
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000218,0.000869,0.000294
--- TIMING FOR renorm : t_inter=2.2e-04 t_gemm=8.7e-04 t_reduction=2.9e-04 tot=1.4e-03 ---
 renorm[inter] counter=21 t=2.2e-04 per=1.6e+01 cost=8.9e+04 flops=4.1e+08
 renorm[gemm] counter=21 i=0 t=2.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=1 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=2 t=2.6e-04 per=1.9e+01 cost=2.1e+04 flops=7.9e+07
 renorm[gemm] counter=21 i=3 t=3.0e-04 per=2.2e+01 cost=2.6e+04 flops=8.7e+07
 renorm[gemm] counter=21 i=4 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=5 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=21 i=6 t=3.0e-04 per=2.2e+01 cost=4.6e+04 flops=1.5e+08
 renorm[gemm] counter=21 total t=8.7e-04 per=6.3e+01 cost=9.3e+04 flops=1.1e+08
 renorm[red] counter=21 t=2.9e-04 per=2.1e+01 cost=2.2e+04 flops=7.3e+07
--- TIMING FOR renorm_tot : t_inter=2.7e-03 t_gemm=1.4e-02 t_reduction=5.3e-03 tot=2.2e-02 ---
 renorm_tot[inter] counter=21 t=2.7e-03 per=1.2e+01 cost=1.6e+06 flops=5.9e+08
 renorm_tot[gemm] counter=21 i=0 t=5.9e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=21 i=1 t=4.8e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=21 i=2 t=9.6e-04 per=4.4e+00 cost=4.9e+04 flops=5.1e+07
 renorm_tot[gemm] counter=21 i=3 t=1.0e-03 per=4.5e+00 cost=5.3e+04 flops=5.3e+07
 renorm_tot[gemm] counter=21 i=4 t=3.6e-03 per=1.6e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=21 i=5 t=3.6e-03 per=1.6e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=21 i=6 t=4.7e-03 per=2.2e+01 cost=1.1e+06 flops=2.3e+08
 renorm_tot[gemm] counter=21 total t=1.4e-02 per=6.4e+01 cost=1.9e+06 flops=1.4e+08
 renorm_tot[red] counter=21 t=5.3e-03 per=2.4e+01 cost=4.8e+05 flops=9.2e+07
qops.to_cpu: size(tot)=1554:1.2e-02MB:1.2e-05GB t[to_cpu]=1.7e-05S speed=6.9e-01GB/S
check ||H-H.dagger||=1.561e-14 coord=(15,0) rank=0
ctns::oper_ab2pq coord=(15,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00762 S rank=0 -----
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.616e+01S Sys:1.184e+00S Total:3.734e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=738:5.630e-03MB:5.499e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=41:3.128e-04MB:3.055e-07GB
total mem of comb=780:5.951e-03MB:5.811e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.616e+01S Sys:1.185e+00S Total:3.735e+01S
##### local opt: 8.937e-02 S #####
 T(local opt: fetch) = 6.905e-03 S  per = 7.73  per(accum) = 7.73
 T(local opt: hdiag) = 4.167e-03 S  per = 4.66  per(accum) = 12.4
 T(local opt: dvdsn) = 6.143e-02 S  per = 68.7  per(accum) = 81.1
 T(local opt: decim) = 3.872e-03 S  per = 4.33  per(accum) = 85.5
 T(local opt: guess) = 1.131e-04 S  per = 0.127  per(accum) = 85.6
 T(local opt: renrm) = 8.500e-03 S  per = 9.51  per(accum) = 95.1
 T(local opt: save ) = 4.381e-03 S  per =  4.9  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.143e-02 S  T(sum) = 6.052e-02 S  per = 9.852e+01
 T(local opt: preprocess                  ) = 7.389e-04 S  per = 1.22  per(accum) = 1.22
 T(local opt: symbolic_formulae           ) = 8.496e-04 S  per =  1.4  per(accum) = 2.62
 T(local opt: hintermediate init          ) = 5.639e-04 S  per = 0.932  per(accum) = 3.56
 T(local opt: preprocess_hformulae_Hxlist ) = 2.742e-02 S  per = 45.3  per(accum) = 48.9
 T(local opt: hmmtasks init               ) = 4.739e-03 S  per = 7.83  per(accum) = 56.7
 T(local opt: initial guess for dvdson    ) = 3.046e-04 S  per = 0.503  per(accum) = 57.2
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.424e-02 S  per = 40.1  per(accum) = 97.3
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.702e-04 S  per = 0.281  per(accum) = 97.5
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.850e-07 S  per = 0.000471  per(accum) = 97.5
 T(local opt: dvdson solver [rest part]   ) = 1.488e-03 S  per = 2.46  per(accum) = 100
Detailed decomposition of T(renrm) = 8.500e-03 S  T(sum) = 8.500e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.247e-04 S  per = 1.47  per(accum) = 1.47
 T(local opt: qops init                    ) = 4.123e-04 S  per = 4.85  per(accum) = 6.32
 T(local opt: symbolic_formulae_renorm     ) = 3.592e-04 S  per = 4.23  per(accum) = 10.5
 T(local opt: allocate qops on gpu         ) = 9.539e-05 S  per = 1.12  per(accum) = 11.7
 T(local opt: site memcpy cpu2gpu          ) = 8.940e-05 S  per = 1.05  per(accum) = 12.7
 T(local opt: rintermediate init           ) = 4.798e-04 S  per = 5.64  per(accum) = 18.4
 T(local opt: preprocess_formulae_Rlist2   ) = 2.085e-03 S  per = 24.5  per(accum) = 42.9
 T(local opt: rmmtasks init                ) = 7.491e-04 S  per = 8.81  per(accum) = 51.7
 T(local opt: qops memset on cpu           ) = 5.200e-08 S  per = 0.000612  per(accum) = 51.7
 T(local opt: preprocess_renorm_batchGPU   ) = 3.166e-03 S  per = 37.2  per(accum) = 88.9
 T(local opt: reduction of opS & opH [nccl]) = 6.110e-07 S  per = 0.00719  per(accum) = 89
 T(local opt: qops memcpy gpu2cpu          ) = 8.986e-05 S  per = 1.06  per(accum) = 90
 T(local opt: deallocate cpu and gpu memory) = 1.007e-05 S  per = 0.118  per(accum) = 90.1
 T(local opt: reduction of opS & opH [comm]) = 8.842e-05 S  per = 1.04  per(accum) = 91.2
 T(local opt: conversion from opAB to opPQ ) = 6.966e-05 S  per = 0.82  per(accum) = 92
 T(local opt: after oper_renorm            ) = 6.807e-04 S  per = 8.01  per(accum) = 100
##### sweep opt: 1.666e+00 S #####
 T(sweep opt: fetch) = 1.345e-01 S  per = 8.07  per(accum) = 8.07
 T(sweep opt: hdiag) = 9.782e-02 S  per = 5.87  per(accum) = 13.9
 T(sweep opt: dvdsn) = 1.083e+00 S  per =   65  per(accum) = 78.9
 T(sweep opt: decim) = 7.810e-02 S  per = 4.69  per(accum) = 83.6
 T(sweep opt: guess) = 2.535e-03 S  per = 0.152  per(accum) = 83.8
 T(sweep opt: renrm) = 1.767e-01 S  per = 10.6  per(accum) = 94.4
 T(sweep opt: save ) = 9.348e-02 S  per = 5.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.083e+00 S  T(sum) = 1.065e+00 S  per = 9.830e+01
 T(sweep opt: preprocess                  ) = 1.319e-02 S  per = 1.24  per(accum) = 1.24
 T(sweep opt: symbolic_formulae           ) = 2.049e-02 S  per = 1.92  per(accum) = 3.16
 T(sweep opt: hintermediate init          ) = 1.215e-02 S  per = 1.14  per(accum) = 4.31
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.297e-01 S  per = 40.4  per(accum) = 44.7
 T(sweep opt: hmmtasks init               ) = 7.311e-02 S  per = 6.87  per(accum) = 51.5
 T(sweep opt: initial guess for dvdson    ) = 4.973e-03 S  per = 0.467  per(accum) = 52
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 4.709e-01 S  per = 44.2  per(accum) = 96.2
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 3.616e-03 S  per = 0.34  per(accum) = 96.6
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 5.861e-06 S  per = 0.000551  per(accum) = 96.6
 T(sweep opt: dvdson solver [rest part]   ) = 3.649e-02 S  per = 3.43  per(accum) = 100
Detailed decomposition of T(renrm) = 1.767e-01 S  T(sum) = 1.767e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.525e-03 S  per = 1.43  per(accum) = 1.43
 T(sweep opt: qops init                    ) = 9.375e-03 S  per = 5.31  per(accum) = 6.73
 T(sweep opt: symbolic_formulae_renorm     ) = 9.474e-03 S  per = 5.36  per(accum) = 12.1
 T(sweep opt: allocate qops on gpu         ) = 1.970e-03 S  per = 1.12  per(accum) = 13.2
 T(sweep opt: site memcpy cpu2gpu          ) = 1.871e-03 S  per = 1.06  per(accum) = 14.3
 T(sweep opt: rintermediate init           ) = 9.865e-03 S  per = 5.58  per(accum) = 19.9
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.154e-02 S  per = 23.5  per(accum) = 43.4
 T(sweep opt: rmmtasks init                ) = 1.358e-02 S  per = 7.69  per(accum) = 51
 T(sweep opt: qops memset on cpu           ) = 1.036e-06 S  per = 0.000586  per(accum) = 51
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.947e-02 S  per = 33.7  per(accum) = 84.7
 T(sweep opt: reduction of opS & opH [nccl]) = 1.234e-05 S  per = 0.00699  per(accum) = 84.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.175e-03 S  per = 1.23  per(accum) = 85.9
 T(sweep opt: deallocate cpu and gpu memory) = 3.531e-04 S  per =  0.2  per(accum) = 86.1
 T(sweep opt: reduction of opS & opH [comm]) = 1.847e-03 S  per = 1.05  per(accum) = 87.2
 T(sweep opt: conversion from opAB to opPQ ) = 7.553e-03 S  per = 4.27  per(accum) = 91.5
 T(sweep opt: after oper_renorm            ) = 1.509e-02 S  per = 8.54  per(accum) = 100
##### global opt: 1.666e+00 S #####
 T(global opt: fetch) = 1.345e-01 S  per = 8.07  per(accum) = 8.07
 T(global opt: hdiag) = 9.782e-02 S  per = 5.87  per(accum) = 13.9
 T(global opt: dvdsn) = 1.083e+00 S  per =   65  per(accum) = 78.9
 T(global opt: decim) = 7.810e-02 S  per = 4.69  per(accum) = 83.6
 T(global opt: guess) = 2.535e-03 S  per = 0.152  per(accum) = 83.8
 T(global opt: renrm) = 1.767e-01 S  per = 10.6  per(accum) = 94.4
 T(global opt: save ) = 9.348e-02 S  per = 5.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.083e+00 S  T(sum) = 1.065e+00 S  per = 9.830e+01
 T(global opt: preprocess                  ) = 1.319e-02 S  per = 1.24  per(accum) = 1.24
 T(global opt: symbolic_formulae           ) = 2.049e-02 S  per = 1.92  per(accum) = 3.16
 T(global opt: hintermediate init          ) = 1.215e-02 S  per = 1.14  per(accum) = 4.31
 T(global opt: preprocess_hformulae_Hxlist ) = 4.297e-01 S  per = 40.4  per(accum) = 44.7
 T(global opt: hmmtasks init               ) = 7.311e-02 S  per = 6.87  per(accum) = 51.5
 T(global opt: initial guess for dvdson    ) = 4.973e-03 S  per = 0.467  per(accum) = 52
 T(global opt: dvdson solver [Hx_batchGPU] ) = 4.709e-01 S  per = 44.2  per(accum) = 96.2
 T(global opt: dvdson solver [comm(gpu)]   ) = 3.616e-03 S  per = 0.34  per(accum) = 96.6
 T(global opt: dvdson solver [comm(cpu)]   ) = 5.861e-06 S  per = 0.000551  per(accum) = 96.6
 T(global opt: dvdson solver [rest part]   ) = 3.649e-02 S  per = 3.43  per(accum) = 100
Detailed decomposition of T(renrm) = 1.767e-01 S  T(sum) = 1.767e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.525e-03 S  per = 1.43  per(accum) = 1.43
 T(global opt: qops init                    ) = 9.375e-03 S  per = 5.31  per(accum) = 6.73
 T(global opt: symbolic_formulae_renorm     ) = 9.474e-03 S  per = 5.36  per(accum) = 12.1
 T(global opt: allocate qops on gpu         ) = 1.970e-03 S  per = 1.12  per(accum) = 13.2
 T(global opt: site memcpy cpu2gpu          ) = 1.871e-03 S  per = 1.06  per(accum) = 14.3
 T(global opt: rintermediate init           ) = 9.865e-03 S  per = 5.58  per(accum) = 19.9
 T(global opt: preprocess_formulae_Rlist2   ) = 4.154e-02 S  per = 23.5  per(accum) = 43.4
 T(global opt: rmmtasks init                ) = 1.358e-02 S  per = 7.69  per(accum) = 51
 T(global opt: qops memset on cpu           ) = 1.036e-06 S  per = 0.000586  per(accum) = 51
 T(global opt: preprocess_renorm_batchGPU   ) = 5.947e-02 S  per = 33.7  per(accum) = 84.7
 T(global opt: reduction of opS & opH [nccl]) = 1.234e-05 S  per = 0.00699  per(accum) = 84.7
 T(global opt: qops memcpy gpu2cpu          ) = 2.175e-03 S  per = 1.23  per(accum) = 85.9
 T(global opt: deallocate cpu and gpu memory) = 3.531e-04 S  per =  0.2  per(accum) = 86.1
 T(global opt: reduction of opS & opH [comm]) = 1.847e-03 S  per = 1.05  per(accum) = 87.2
 T(global opt: conversion from opAB to opPQ ) = 7.553e-03 S  per = 4.27  per(accum) = 91.5
 T(global opt: after oper_renorm            ) = 1.509e-02 S  per = 8.54  per(accum) = 100

isweep=0 ibond=21/seqsize=34 dots=2 dbond=(13,0)-(14,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.616e+01S Sys:1.186e+00S Total:3.735e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=738:5.630e-03MB:5.499e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=41:3.128e-04MB:3.055e-07GB
total mem of comb=780:5.951e-03MB:5.811e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=13,5,1,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 11 12 13 14 15
 suppc1= 9
 suppc2= 10
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:13 S:7 H:1 P:49 Q:56 
        dim(bra,ket)=9,9 size(op)=41:3.128e-04MB size(tot)=2273:1.734e-02MB:1.694e-05GB
 rqops: oplist=CSHAB nops=C:5 S:15 H:1 A:25 B:30 
        dim(bra,ket)=10,10 size(op)=36:2.747e-04MB size(tot)=1554:1.186e-02MB:1.158e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=5823:4.443e-02MB:4.338e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(14,0) fdel=./scratch/sweep/lop(13,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
wf4(diml,dimr,dimc1,dimc2)=(9,10,3,3) nnz=101:7.706e-04MB
qtensor4: wf4 own=1 _data=0x55a31ea7a350
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=9
 (20,2):3 (20,4):3 (19,3):2 (21,3):1
 qbond: qcol nsym=5 dimAll=10
 (6,2):3 (7,3):3 (6,4):2 (5,3):1 (8,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=25 nblocks=320 size=101:7.706e-04MB
### DIAG TIMING: total=4.021e-03 t1=9.136e-06, t2=1.534e-05, t3=1.787e-05, t4=3.953e-03, t5=4.515e-06, t6=1.759e-05, t7=4.326e-06
duration_diagGPU:4.114e-03
duration_diagreduce:4.300e-08
duration_diagtransform:2.530e-07
----- TIMING FOR symbolic_formulae_twodot with size=516 : 9.087e-04 S -----
rank=0 GPUmem(GB): used=4.34e-05 (oper)=4.34e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=516
 no. of hintermediate operators=269
 no. of coefficients=3269:0.0249MB:2.44e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.564e-04 S -----
rank=0 GPUmem(GB): used=6.77e-05 (oper,hinter)=4.34e-05,2.44e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0232 S size(H_formulae)=516 size(Hxlst2)=25 T(Hmu/Hxlist)=0.000179,0.0231 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0236 S size(H_formulae)=516 size(Hxlst)=14730 -----
rank=0 GPUmem(GB): used=0.00314 (oper,hinter,dvdson,batch)=4.34e-05,2.44e-05,1.51e-06,0.00307 blksize=9 blksize0=9 batchsize=14730
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=101 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.24e-05,0.000259,0.00126,0.0009,0.00246
 ndim=101:7.53e-07GB t[comm(intra)]=2.55e-05 speed=0.059GB/S t[comm(inter)]=6.86e-06 speed=0.219GB/S
--- TIMING FOR sigma : t_inter=2.6e-04 t_gemm=1.3e-03 t_reduction=9.0e-04 tot=2.4e-03 ---
 sigma[inter] counter=127 t=2.6e-04 per=1.1e+01 cost=7.9e+05 flops=3.0e+09
 sigma[gemm] counter=127 i=0 t=2.8e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=1 t=2.2e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=2 t=2.3e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=3 t=2.2e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=4 t=3.2e-04 per=1.3e+01 cost=1.3e+05 flops=4.2e+08
 sigma[gemm] counter=127 i=5 t=3.4e-04 per=1.4e+01 cost=1.2e+05 flops=3.6e+08
 sigma[gemm] counter=127 i=6 t=3.1e-04 per=1.3e+01 cost=9.8e+04 flops=3.2e+08
 sigma[gemm] counter=127 i=7 t=2.8e-04 per=1.2e+01 cost=1.1e+05 flops=3.8e+08
 sigma[gemm] counter=127 total t=1.3e-03 per=5.2e+01 cost=4.6e+05 flops=3.7e+08
 sigma[red] counter=127 t=9.0e-04 per=3.7e+01 cost=1.3e+05 flops=1.4e+08
--- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=1.0e-01 t_reduction=9.8e-02 tot=2.2e-01 ---
 sigma_tot[inter] counter=127 t=2.1e-02 per=9.6e+00 cost=8.8e+07 flops=4.2e+09
 sigma_tot[gemm] counter=127 i=0 t=3.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=1 t=2.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=2 t=2.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=3 t=2.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=4 t=2.3e-02 per=1.1e+01 cost=1.7e+07 flops=7.3e+08
 sigma_tot[gemm] counter=127 i=5 t=2.6e-02 per=1.2e+01 cost=1.7e+07 flops=6.6e+08
 sigma_tot[gemm] counter=127 i=6 t=2.5e-02 per=1.1e+01 cost=1.6e+07 flops=6.4e+08
 sigma_tot[gemm] counter=127 i=7 t=2.5e-02 per=1.1e+01 cost=1.7e+07 flops=6.8e+08
 sigma_tot[gemm] counter=127 total t=1.0e-01 per=4.6e+01 cost=6.7e+07 flops=6.7e+08
 sigma_tot[red] counter=127 t=9.8e-02 per=4.5e+01 cost=1.6e+07 flops=1.7e+08
T(sub)=7.9e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,3.1e-06,9.2e-07,9.0e-07,2.1e-07
settings: ndim=101 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.317262557765 -1.116e+03  4.006e-02    1     1  4.829e-03 4.829e-03 4.649e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.852e-05,1.999e-04,9.433e-04,8.263e-04,2.004e-03
 ndim=101:7.525e-07GB t[comm(intra)]=2.276e-05 speed=6.612e-02GB/S t[comm(inter)]=5.756e-06 speed=2.615e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=9.4e-04 t_reduction=8.3e-04 tot=2.0e-03 ---
 sigma[inter] counter=128 t=2.0e-04 per=1.0e+01 cost=7.9e+05 flops=4.0e+09
 sigma[gemm] counter=128 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=1 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=4 t=2.5e-04 per=1.3e+01 cost=1.3e+05 flops=5.4e+08
 sigma[gemm] counter=128 i=5 t=2.3e-04 per=1.2e+01 cost=1.2e+05 flops=5.4e+08
 sigma[gemm] counter=128 i=6 t=2.3e-04 per=1.2e+01 cost=9.8e+04 flops=4.2e+08
 sigma[gemm] counter=128 i=7 t=2.3e-04 per=1.2e+01 cost=1.1e+05 flops=4.8e+08
 sigma[gemm] counter=128 total t=9.4e-04 per=4.8e+01 cost=4.6e+05 flops=4.9e+08
 sigma[red] counter=128 t=8.3e-04 per=4.2e+01 cost=1.3e+05 flops=1.5e+08
--- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=1.0e-01 t_reduction=9.9e-02 tot=2.2e-01 ---
 sigma_tot[inter] counter=128 t=2.1e-02 per=9.6e+00 cost=8.8e+07 flops=4.1e+09
 sigma_tot[gemm] counter=128 i=0 t=3.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=1 t=2.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=2 t=2.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=3 t=2.8e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=4 t=2.4e-02 per=1.1e+01 cost=1.7e+07 flops=7.3e+08
 sigma_tot[gemm] counter=128 i=5 t=2.6e-02 per=1.2e+01 cost=1.7e+07 flops=6.6e+08
 sigma_tot[gemm] counter=128 i=6 t=2.5e-02 per=1.1e+01 cost=1.6e+07 flops=6.4e+08
 sigma_tot[gemm] counter=128 i=7 t=2.5e-02 per=1.1e+01 cost=1.7e+07 flops=6.8e+08
 sigma_tot[gemm] counter=128 total t=1.0e-01 per=4.6e+01 cost=6.8e+07 flops=6.7e+08
 sigma_tot[red] counter=128 t=9.9e-02 per=4.5e+01 cost=1.6e+07 flops=1.7e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,9.5e-06,2.3e-06,1.0e-06,1.9e-07
    2   0 -    -116.323091101205 -5.829e-03  1.019e-02    2     2  9.395e-03 4.698e-03 4.349e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.726e-05,2.258e-04,9.989e-04,8.189e-04,2.076e-03
 ndim=101:7.525e-07GB t[comm(intra)]=2.165e-05 speed=6.951e-02GB/S t[comm(inter)]=5.606e-06 speed=2.685e-01GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=1.0e-03 t_reduction=8.2e-04 tot=2.0e-03 ---
 sigma[inter] counter=129 t=2.3e-04 per=1.1e+01 cost=7.9e+05 flops=3.5e+09
 sigma[gemm] counter=129 i=0 t=2.7e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=1 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=4 t=2.5e-04 per=1.2e+01 cost=1.3e+05 flops=5.3e+08
 sigma[gemm] counter=129 i=5 t=2.5e-04 per=1.2e+01 cost=1.2e+05 flops=4.8e+08
 sigma[gemm] counter=129 i=6 t=2.5e-04 per=1.2e+01 cost=9.8e+04 flops=3.9e+08
 sigma[gemm] counter=129 i=7 t=2.3e-04 per=1.1e+01 cost=1.1e+05 flops=4.6e+08
 sigma[gemm] counter=129 total t=1.0e-03 per=4.9e+01 cost=4.6e+05 flops=4.6e+08
 sigma[red] counter=129 t=8.2e-04 per=4.0e+01 cost=1.3e+05 flops=1.5e+08
--- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=1.0e-01 t_reduction=1.0e-01 tot=2.2e-01 ---
 sigma_tot[inter] counter=129 t=2.2e-02 per=9.6e+00 cost=8.9e+07 flops=4.1e+09
 sigma_tot[gemm] counter=129 i=0 t=3.3e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=1 t=2.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=2 t=2.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=3 t=2.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=4 t=2.4e-02 per=1.1e+01 cost=1.7e+07 flops=7.2e+08
 sigma_tot[gemm] counter=129 i=5 t=2.6e-02 per=1.2e+01 cost=1.7e+07 flops=6.6e+08
 sigma_tot[gemm] counter=129 i=6 t=2.6e-02 per=1.1e+01 cost=1.6e+07 flops=6.3e+08
 sigma_tot[gemm] counter=129 i=7 t=2.5e-02 per=1.1e+01 cost=1.7e+07 flops=6.8e+08
 sigma_tot[gemm] counter=129 total t=1.0e-01 per=4.6e+01 cost=6.8e+07 flops=6.6e+08
 sigma_tot[red] counter=129 t=1.0e-01 per=4.5e+01 cost=1.7e+07 flops=1.7e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.2e-05,1.7e-06,1.0e-06,2.0e-07
    3   0 -    -116.323357526302 -2.664e-04  3.036e-03    3     3  1.400e-02 4.666e-03 4.370e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.735e-05,1.958e-04,9.220e-04,8.193e-04,1.970e-03
 ndim=101:7.525e-07GB t[comm(intra)]=2.164e-05 speed=6.955e-02GB/S t[comm(inter)]=5.715e-06 speed=2.633e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=9.2e-04 t_reduction=8.2e-04 tot=1.9e-03 ---
 sigma[inter] counter=130 t=2.0e-04 per=1.0e+01 cost=7.9e+05 flops=4.0e+09
 sigma[gemm] counter=130 i=0 t=2.4e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=4 t=2.3e-04 per=1.2e+01 cost=1.3e+05 flops=5.7e+08
 sigma[gemm] counter=130 i=5 t=2.3e-04 per=1.2e+01 cost=1.2e+05 flops=5.2e+08
 sigma[gemm] counter=130 i=6 t=2.2e-04 per=1.1e+01 cost=9.8e+04 flops=4.4e+08
 sigma[gemm] counter=130 i=7 t=2.2e-04 per=1.2e+01 cost=1.1e+05 flops=4.9e+08
 sigma[gemm] counter=130 total t=9.2e-04 per=4.8e+01 cost=4.6e+05 flops=5.0e+08
 sigma[red] counter=130 t=8.2e-04 per=4.2e+01 cost=1.3e+05 flops=1.5e+08
--- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=1.0e-01 t_reduction=1.0e-01 tot=2.3e-01 ---
 sigma_tot[inter] counter=130 t=2.2e-02 per=9.6e+00 cost=9.0e+07 flops=4.1e+09
 sigma_tot[gemm] counter=130 i=0 t=3.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=1 t=2.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=2 t=2.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=3 t=2.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=4 t=2.4e-02 per=1.1e+01 cost=1.7e+07 flops=7.2e+08
 sigma_tot[gemm] counter=130 i=5 t=2.7e-02 per=1.2e+01 cost=1.7e+07 flops=6.5e+08
 sigma_tot[gemm] counter=130 i=6 t=2.6e-02 per=1.1e+01 cost=1.6e+07 flops=6.3e+08
 sigma_tot[gemm] counter=130 i=7 t=2.5e-02 per=1.1e+01 cost=1.7e+07 flops=6.8e+08
 sigma_tot[gemm] counter=130 total t=1.0e-01 per=4.6e+01 cost=6.8e+07 flops=6.6e+08
 sigma_tot[red] counter=130 t=1.0e-01 per=4.5e+01 cost=1.7e+07 flops=1.7e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.0e-05,1.6e-06,9.2e-07,1.8e-07
    4   0 -    -116.323385101891 -2.758e-05  1.279e-03    3     4  1.813e-02 4.533e-03 4.256e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.738e-05,2.090e-04,9.357e-04,8.132e-04,1.990e-03
 ndim=101:7.525e-07GB t[comm(intra)]=2.188e-05 speed=6.877e-02GB/S t[comm(inter)]=5.494e-06 speed=2.739e-01GB/S
--- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=9.4e-04 t_reduction=8.1e-04 tot=2.0e-03 ---
 sigma[inter] counter=131 t=2.1e-04 per=1.1e+01 cost=7.9e+05 flops=3.8e+09
 sigma[gemm] counter=131 i=0 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=1 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=4 t=2.4e-04 per=1.2e+01 cost=1.3e+05 flops=5.6e+08
 sigma[gemm] counter=131 i=5 t=2.3e-04 per=1.2e+01 cost=1.2e+05 flops=5.4e+08
 sigma[gemm] counter=131 i=6 t=2.5e-04 per=1.3e+01 cost=9.8e+04 flops=4.0e+08
 sigma[gemm] counter=131 i=7 t=2.2e-04 per=1.1e+01 cost=1.1e+05 flops=5.0e+08
 sigma[gemm] counter=131 total t=9.4e-04 per=4.8e+01 cost=4.6e+05 flops=4.9e+08
 sigma[red] counter=131 t=8.1e-04 per=4.2e+01 cost=1.3e+05 flops=1.5e+08
--- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=1.0e-01 t_reduction=1.0e-01 tot=2.3e-01 ---
 sigma_tot[inter] counter=131 t=2.2e-02 per=9.6e+00 cost=9.1e+07 flops=4.1e+09
 sigma_tot[gemm] counter=131 i=0 t=3.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=1 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=2 t=2.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=3 t=2.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=4 t=2.4e-02 per=1.1e+01 cost=1.8e+07 flops=7.2e+08
 sigma_tot[gemm] counter=131 i=5 t=2.7e-02 per=1.2e+01 cost=1.8e+07 flops=6.5e+08
 sigma_tot[gemm] counter=131 i=6 t=2.6e-02 per=1.1e+01 cost=1.6e+07 flops=6.3e+08
 sigma_tot[gemm] counter=131 i=7 t=2.6e-02 per=1.1e+01 cost=1.7e+07 flops=6.7e+08
 sigma_tot[gemm] counter=131 total t=1.0e-01 per=4.6e+01 cost=6.9e+07 flops=6.6e+08
 sigma_tot[red] counter=131 t=1.0e-01 per=4.5e+01 cost=1.7e+07 flops=1.7e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.0e-05,1.6e-06,9.4e-07,1.4e-07
    5   0 -    -116.323388886296 -3.784e-06  3.463e-04    3     5  2.218e-02 4.436e-03 4.179e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.693e-05,2.185e-04,9.647e-04,8.164e-04,2.031e-03
 ndim=101:7.525e-07GB t[comm(intra)]=2.149e-05 speed=7.004e-02GB/S t[comm(inter)]=5.443e-06 speed=2.765e-01GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=9.6e-04 t_reduction=8.2e-04 tot=2.0e-03 ---
 sigma[inter] counter=132 t=2.2e-04 per=1.1e+01 cost=7.9e+05 flops=3.6e+09
 sigma[gemm] counter=132 i=0 t=2.8e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=1 t=3.0e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=2 t=3.0e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=4 t=2.9e-04 per=1.5e+01 cost=1.3e+05 flops=4.6e+08
 sigma[gemm] counter=132 i=5 t=2.3e-04 per=1.1e+01 cost=1.2e+05 flops=5.4e+08
 sigma[gemm] counter=132 i=6 t=2.2e-04 per=1.1e+01 cost=9.8e+04 flops=4.4e+08
 sigma[gemm] counter=132 i=7 t=2.2e-04 per=1.1e+01 cost=1.1e+05 flops=5.0e+08
 sigma[gemm] counter=132 total t=9.6e-04 per=4.8e+01 cost=4.6e+05 flops=4.8e+08
 sigma[red] counter=132 t=8.2e-04 per=4.1e+01 cost=1.3e+05 flops=1.5e+08
--- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=1.1e-01 t_reduction=1.0e-01 tot=2.3e-01 ---
 sigma_tot[inter] counter=132 t=2.2e-02 per=9.7e+00 cost=9.2e+07 flops=4.1e+09
 sigma_tot[gemm] counter=132 i=0 t=3.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=1 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=2 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=3 t=2.9e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=4 t=2.5e-02 per=1.1e+01 cost=1.8e+07 flops=7.2e+08
 sigma_tot[gemm] counter=132 i=5 t=2.7e-02 per=1.2e+01 cost=1.8e+07 flops=6.5e+08
 sigma_tot[gemm] counter=132 i=6 t=2.6e-02 per=1.1e+01 cost=1.7e+07 flops=6.3e+08
 sigma_tot[gemm] counter=132 i=7 t=2.6e-02 per=1.1e+01 cost=1.7e+07 flops=6.7e+08
 sigma_tot[gemm] counter=132 total t=1.1e-01 per=4.6e+01 cost=6.9e+07 flops=6.6e+08
 sigma_tot[red] counter=132 t=1.0e-01 per=4.4e+01 cost=1.7e+07 flops=1.7e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.0e-05,1.6e-06,1.1e-06,1.3e-07
    6   0 -    -116.323389262986 -3.767e-07  1.551e-04    3     6  2.631e-02 4.384e-03 4.142e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.729e-05,2.149e-04,9.449e-04,8.166e-04,2.008e-03
 ndim=101:7.525e-07GB t[comm(intra)]=2.184e-05 speed=6.890e-02GB/S t[comm(inter)]=5.444e-06 speed=2.765e-01GB/S
--- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=9.4e-04 t_reduction=8.2e-04 tot=2.0e-03 ---
 sigma[inter] counter=133 t=2.1e-04 per=1.1e+01 cost=7.9e+05 flops=3.7e+09
 sigma[gemm] counter=133 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=1 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=4 t=2.4e-04 per=1.2e+01 cost=1.3e+05 flops=5.6e+08
 sigma[gemm] counter=133 i=5 t=2.5e-04 per=1.2e+01 cost=1.2e+05 flops=5.0e+08
 sigma[gemm] counter=133 i=6 t=2.2e-04 per=1.1e+01 cost=9.8e+04 flops=4.4e+08
 sigma[gemm] counter=133 i=7 t=2.3e-04 per=1.2e+01 cost=1.1e+05 flops=4.7e+08
 sigma[gemm] counter=133 total t=9.4e-04 per=4.8e+01 cost=4.6e+05 flops=4.9e+08
 sigma[red] counter=133 t=8.2e-04 per=4.1e+01 cost=1.3e+05 flops=1.5e+08
--- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=1.1e-01 t_reduction=1.0e-01 tot=2.3e-01 ---
 sigma_tot[inter] counter=133 t=2.2e-02 per=9.7e+00 cost=9.2e+07 flops=4.1e+09
 sigma_tot[gemm] counter=133 i=0 t=3.4e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=1 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=2 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=3 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=4 t=2.5e-02 per=1.1e+01 cost=1.8e+07 flops=7.2e+08
 sigma_tot[gemm] counter=133 i=5 t=2.7e-02 per=1.2e+01 cost=1.8e+07 flops=6.5e+08
 sigma_tot[gemm] counter=133 i=6 t=2.7e-02 per=1.1e+01 cost=1.7e+07 flops=6.3e+08
 sigma_tot[gemm] counter=133 i=7 t=2.6e-02 per=1.1e+01 cost=1.8e+07 flops=6.7e+08
 sigma_tot[gemm] counter=133 total t=1.1e-01 per=4.6e+01 cost=7.0e+07 flops=6.6e+08
 sigma_tot[red] counter=133 t=1.0e-01 per=4.4e+01 cost=1.7e+07 flops=1.7e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.0e-05,1.7e-06,9.9e-07,1.8e-07
    7   0 +    -116.323389329774 -6.679e-08  5.925e-05    3     7  3.047e-02 4.353e-03 4.118e-03
TIMING FOR Davidson : 3.055e-02  T(cal/comm/rest)=2.883e-02,2.690e-07,1.721e-03
decomposed t_rest=1.721e-03
 T(sub)    =1.116e-04 per=6.487e+00
 T(precond)=2.057e-04 per=1.195e+01
 T(ortho)  =1.039e-05 per=6.036e-01
 T(xcopy)  =6.980e-07 per=4.056e-02
 T(xnrm2)  =1.222e-06 per=7.101e-02
 T(other)  =1.391e-03 per=8.084e+01
optimized energies: isweep=0 ibond=21 dots=2 e[0]=-116.323389329774 nmvp=7
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.781e+01S Sys:1.192e+00S Total:3.900e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond21.txt
 qbond: qsuper nsym=11 dimAll=40
 (6,2):4 (7,3):9 (6,4):3 (5,3):1 (8,2):7 (9,3):4 (8,4):5 (10,2):1 (7,1):3 (7,5):2 (9,1):1
----- TMING FOR decimation_genbasis(su2): 1.1e-04 S -----
decimation summary: 40->10 dwt=+4.290e-04 SvN=5.600e-01
 qbond: qkept nsym=6 dimAll=10
 (9,3):3 (8,2):2 (8,4):2 (7,3):1 (10,2):1 (9,1):1
----- TIMING for decimation_row(nkr): 3.465e-03 S T(decim/select/formRot)=4.833e-04,2.825e-03,1.568e-04 -----
----- TIMING FOR twodot_decimation: 3.707e-03 S T(wf/decim)=1.596e-04,3.547e-03 -----
ctns::oper_renorm coord=(14,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:6 S:14 H:1 A:36 B:42 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=1819:1.388e-02MB:1.355e-05GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.798e+01S Sys:1.192e+00S Total:3.917e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=99 : 3.174e-04 S -----
rank=0 GPUmem(GB): used=6.44e-05 (oper)=3.26e-05
rank=0 GPUmem(GB): used=6.47e-05 (oper,site)(GB)=3.26e-05,3.5e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=99
 no. of rintermediate operators=131
 no. of coefficients=1475:0.0113MB:1.1e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.559e-04 S -----
rank=0 GPUmem(GB): used=7.57e-05 (oper,site,rinter)=3.26e-05,3.5e-07,1.1e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00203 S size(rtasks)=99 size(Rlst2)=36 T(Rmu/Rlist)=8.1e-05,0.00195 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00217 S size(rtasks)=99 size(Rlst)=2511 -----
rank=0 GPUmem(GB): used=7.57e-05 (oper,site,rinter,batch)=3.26e-05,3.5e-07,1.1e-05,0.000524 blksize=9 blksize0=9 batchsize=2511
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000212,0.000843,0.000322
--- TIMING FOR renorm : t_inter=2.1e-04 t_gemm=8.4e-04 t_reduction=3.2e-04 tot=1.4e-03 ---
 renorm[inter] counter=22 t=2.1e-04 per=1.5e+01 cost=1.4e+05 flops=6.6e+08
 renorm[gemm] counter=22 i=0 t=2.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=1 t=2.4e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=2 t=2.7e-04 per=2.0e+01 cost=1.9e+04 flops=7.1e+07
 renorm[gemm] counter=22 i=3 t=2.9e-04 per=2.1e+01 cost=2.6e+04 flops=9.1e+07
 renorm[gemm] counter=22 i=4 t=2.3e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=5 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=22 i=6 t=2.8e-04 per=2.0e+01 cost=3.6e+04 flops=1.3e+08
 renorm[gemm] counter=22 total t=8.4e-04 per=6.1e+01 cost=8.1e+04 flops=9.6e+07
 renorm[red] counter=22 t=3.2e-04 per=2.3e+01 cost=1.6e+04 flops=4.9e+07
--- TIMING FOR renorm_tot : t_inter=3.0e-03 t_gemm=1.5e-02 t_reduction=5.6e-03 tot=2.3e-02 ---
 renorm_tot[inter] counter=22 t=3.0e-03 per=1.3e+01 cost=1.8e+06 flops=6.0e+08
 renorm_tot[gemm] counter=22 i=0 t=6.2e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=22 i=1 t=5.0e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=22 i=2 t=1.2e-03 per=5.2e+00 cost=6.8e+04 flops=5.5e+07
 renorm_tot[gemm] counter=22 i=3 t=1.3e-03 per=5.5e+00 cost=7.9e+04 flops=6.2e+07
 renorm_tot[gemm] counter=22 i=4 t=3.6e-03 per=1.5e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=22 i=5 t=3.6e-03 per=1.5e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=22 i=6 t=5.0e-03 per=2.1e+01 cost=1.1e+06 flops=2.2e+08
 renorm_tot[gemm] counter=22 total t=1.5e-02 per=6.3e+01 cost=2.0e+06 flops=1.3e+08
 renorm_tot[red] counter=22 t=5.6e-03 per=2.4e+01 cost=5.0e+05 flops=9.0e+07
qops.to_cpu: size(tot)=1819:1.4e-02MB:1.4e-05GB t[to_cpu]=1.8e-05S speed=7.5e-01GB/S
check ||H-H.dagger||=7.584e-15 coord=(14,0) rank=0
ctns::oper_ab2pq coord=(14,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00806 S rank=0 -----
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.812e+01S Sys:1.192e+00S Total:3.931e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=745:5.684e-03MB:5.551e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=52:3.967e-04MB:3.874e-07GB
total mem of comb=798:6.088e-03MB:5.946e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.812e+01S Sys:1.192e+00S Total:3.932e+01S
##### local opt: 9.171e-02 S #####
 T(local opt: fetch) = 7.459e-03 S  per = 8.13  per(accum) = 8.13
 T(local opt: hdiag) = 5.093e-03 S  per = 5.55  per(accum) = 13.7
 T(local opt: dvdsn) = 6.188e-02 S  per = 67.5  per(accum) = 81.2
 T(local opt: decim) = 3.794e-03 S  per = 4.14  per(accum) = 85.3
 T(local opt: guess) = 1.097e-04 S  per = 0.12  per(accum) = 85.4
 T(local opt: renrm) = 8.947e-03 S  per = 9.76  per(accum) = 95.2
 T(local opt: save ) = 4.423e-03 S  per = 4.82  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.188e-02 S  T(sum) = 6.096e-02 S  per = 9.850e+01
 T(local opt: preprocess                  ) = 6.486e-04 S  per = 1.06  per(accum) = 1.06
 T(local opt: symbolic_formulae           ) = 9.944e-04 S  per = 1.63  per(accum) = 2.7
 T(local opt: hintermediate init          ) = 5.979e-04 S  per = 0.981  per(accum) = 3.68
 T(local opt: preprocess_hformulae_Hxlist ) = 2.378e-02 S  per =   39  per(accum) = 42.7
 T(local opt: hmmtasks init               ) = 4.108e-03 S  per = 6.74  per(accum) = 49.4
 T(local opt: initial guess for dvdson    ) = 2.806e-04 S  per = 0.46  per(accum) = 49.9
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.863e-02 S  per =   47  per(accum) = 96.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.971e-04 S  per = 0.323  per(accum) = 97.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.690e-07 S  per = 0.000441  per(accum) = 97.2
 T(local opt: dvdson solver [rest part]   ) = 1.721e-03 S  per = 2.82  per(accum) = 100
Detailed decomposition of T(renrm) = 8.947e-03 S  T(sum) = 8.947e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.235e-04 S  per = 1.38  per(accum) = 1.38
 T(local opt: qops init                    ) = 5.312e-04 S  per = 5.94  per(accum) = 7.32
 T(local opt: symbolic_formulae_renorm     ) = 3.992e-04 S  per = 4.46  per(accum) = 11.8
 T(local opt: allocate qops on gpu         ) = 9.528e-05 S  per = 1.06  per(accum) = 12.8
 T(local opt: site memcpy cpu2gpu          ) = 8.891e-05 S  per = 0.994  per(accum) = 13.8
 T(local opt: rintermediate init           ) = 5.001e-04 S  per = 5.59  per(accum) = 19.4
 T(local opt: preprocess_formulae_Rlist2   ) = 2.261e-03 S  per = 25.3  per(accum) = 44.7
 T(local opt: rmmtasks init                ) = 7.757e-04 S  per = 8.67  per(accum) = 53.4
 T(local opt: qops memset on cpu           ) = 4.800e-08 S  per = 0.000536  per(accum) = 53.4
 T(local opt: preprocess_renorm_batchGPU   ) = 3.205e-03 S  per = 35.8  per(accum) = 89.2
 T(local opt: reduction of opS & opH [nccl]) = 6.170e-07 S  per = 0.0069  per(accum) = 89.2
 T(local opt: qops memcpy gpu2cpu          ) = 9.752e-05 S  per = 1.09  per(accum) = 90.3
 T(local opt: deallocate cpu and gpu memory) = 1.011e-05 S  per = 0.113  per(accum) = 90.4
 T(local opt: reduction of opS & opH [comm]) = 9.614e-05 S  per = 1.07  per(accum) = 91.5
 T(local opt: conversion from opAB to opPQ ) = 7.496e-05 S  per = 0.838  per(accum) = 92.3
 T(local opt: after oper_renorm            ) = 6.869e-04 S  per = 7.68  per(accum) = 100
##### sweep opt: 1.758e+00 S #####
 T(sweep opt: fetch) = 1.420e-01 S  per = 8.08  per(accum) = 8.08
 T(sweep opt: hdiag) = 1.029e-01 S  per = 5.85  per(accum) = 13.9
 T(sweep opt: dvdsn) = 1.145e+00 S  per = 65.1  per(accum) = 79.1
 T(sweep opt: decim) = 8.189e-02 S  per = 4.66  per(accum) = 83.7
 T(sweep opt: guess) = 2.645e-03 S  per = 0.15  per(accum) = 83.9
 T(sweep opt: renrm) = 1.857e-01 S  per = 10.6  per(accum) = 94.4
 T(sweep opt: save ) = 9.790e-02 S  per = 5.57  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.145e+00 S  T(sum) = 1.126e+00 S  per = 9.831e+01
 T(sweep opt: preprocess                  ) = 1.384e-02 S  per = 1.23  per(accum) = 1.23
 T(sweep opt: symbolic_formulae           ) = 2.148e-02 S  per = 1.91  per(accum) = 3.14
 T(sweep opt: hintermediate init          ) = 1.275e-02 S  per = 1.13  per(accum) = 4.27
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.534e-01 S  per = 40.3  per(accum) = 44.6
 T(sweep opt: hmmtasks init               ) = 7.721e-02 S  per = 6.86  per(accum) = 51.4
 T(sweep opt: initial guess for dvdson    ) = 5.253e-03 S  per = 0.467  per(accum) = 51.9
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 4.995e-01 S  per = 44.4  per(accum) = 96.3
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 3.813e-03 S  per = 0.339  per(accum) = 96.6
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 6.130e-06 S  per = 0.000545  per(accum) = 96.6
 T(sweep opt: dvdson solver [rest part]   ) = 3.821e-02 S  per =  3.4  per(accum) = 100
Detailed decomposition of T(renrm) = 1.857e-01 S  T(sum) = 1.857e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.648e-03 S  per = 1.43  per(accum) = 1.43
 T(sweep opt: qops init                    ) = 9.906e-03 S  per = 5.34  per(accum) = 6.76
 T(sweep opt: symbolic_formulae_renorm     ) = 9.874e-03 S  per = 5.32  per(accum) = 12.1
 T(sweep opt: allocate qops on gpu         ) = 2.066e-03 S  per = 1.11  per(accum) = 13.2
 T(sweep opt: site memcpy cpu2gpu          ) = 1.959e-03 S  per = 1.06  per(accum) = 14.2
 T(sweep opt: rintermediate init           ) = 1.036e-02 S  per = 5.58  per(accum) = 19.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.380e-02 S  per = 23.6  per(accum) = 43.4
 T(sweep opt: rmmtasks init                ) = 1.436e-02 S  per = 7.73  per(accum) = 51.2
 T(sweep opt: qops memset on cpu           ) = 1.084e-06 S  per = 0.000584  per(accum) = 51.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.268e-02 S  per = 33.8  per(accum) = 84.9
 T(sweep opt: reduction of opS & opH [nccl]) = 1.296e-05 S  per = 0.00698  per(accum) = 84.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.272e-03 S  per = 1.22  per(accum) = 86.2
 T(sweep opt: deallocate cpu and gpu memory) = 3.632e-04 S  per = 0.196  per(accum) = 86.3
 T(sweep opt: reduction of opS & opH [comm]) = 1.944e-03 S  per = 1.05  per(accum) = 87.4
 T(sweep opt: conversion from opAB to opPQ ) = 7.628e-03 S  per = 4.11  per(accum) = 91.5
 T(sweep opt: after oper_renorm            ) = 1.578e-02 S  per =  8.5  per(accum) = 100
##### global opt: 1.758e+00 S #####
 T(global opt: fetch) = 1.420e-01 S  per = 8.08  per(accum) = 8.08
 T(global opt: hdiag) = 1.029e-01 S  per = 5.85  per(accum) = 13.9
 T(global opt: dvdsn) = 1.145e+00 S  per = 65.1  per(accum) = 79.1
 T(global opt: decim) = 8.189e-02 S  per = 4.66  per(accum) = 83.7
 T(global opt: guess) = 2.645e-03 S  per = 0.15  per(accum) = 83.9
 T(global opt: renrm) = 1.857e-01 S  per = 10.6  per(accum) = 94.4
 T(global opt: save ) = 9.790e-02 S  per = 5.57  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.145e+00 S  T(sum) = 1.126e+00 S  per = 9.831e+01
 T(global opt: preprocess                  ) = 1.384e-02 S  per = 1.23  per(accum) = 1.23
 T(global opt: symbolic_formulae           ) = 2.148e-02 S  per = 1.91  per(accum) = 3.14
 T(global opt: hintermediate init          ) = 1.275e-02 S  per = 1.13  per(accum) = 4.27
 T(global opt: preprocess_hformulae_Hxlist ) = 4.534e-01 S  per = 40.3  per(accum) = 44.6
 T(global opt: hmmtasks init               ) = 7.721e-02 S  per = 6.86  per(accum) = 51.4
 T(global opt: initial guess for dvdson    ) = 5.253e-03 S  per = 0.467  per(accum) = 51.9
 T(global opt: dvdson solver [Hx_batchGPU] ) = 4.995e-01 S  per = 44.4  per(accum) = 96.3
 T(global opt: dvdson solver [comm(gpu)]   ) = 3.813e-03 S  per = 0.339  per(accum) = 96.6
 T(global opt: dvdson solver [comm(cpu)]   ) = 6.130e-06 S  per = 0.000545  per(accum) = 96.6
 T(global opt: dvdson solver [rest part]   ) = 3.821e-02 S  per =  3.4  per(accum) = 100
Detailed decomposition of T(renrm) = 1.857e-01 S  T(sum) = 1.857e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.648e-03 S  per = 1.43  per(accum) = 1.43
 T(global opt: qops init                    ) = 9.906e-03 S  per = 5.34  per(accum) = 6.76
 T(global opt: symbolic_formulae_renorm     ) = 9.874e-03 S  per = 5.32  per(accum) = 12.1
 T(global opt: allocate qops on gpu         ) = 2.066e-03 S  per = 1.11  per(accum) = 13.2
 T(global opt: site memcpy cpu2gpu          ) = 1.959e-03 S  per = 1.06  per(accum) = 14.2
 T(global opt: rintermediate init           ) = 1.036e-02 S  per = 5.58  per(accum) = 19.8
 T(global opt: preprocess_formulae_Rlist2   ) = 4.380e-02 S  per = 23.6  per(accum) = 43.4
 T(global opt: rmmtasks init                ) = 1.436e-02 S  per = 7.73  per(accum) = 51.2
 T(global opt: qops memset on cpu           ) = 1.084e-06 S  per = 0.000584  per(accum) = 51.2
 T(global opt: preprocess_renorm_batchGPU   ) = 6.268e-02 S  per = 33.8  per(accum) = 84.9
 T(global opt: reduction of opS & opH [nccl]) = 1.296e-05 S  per = 0.00698  per(accum) = 84.9
 T(global opt: qops memcpy gpu2cpu          ) = 2.272e-03 S  per = 1.22  per(accum) = 86.2
 T(global opt: deallocate cpu and gpu memory) = 3.632e-04 S  per = 0.196  per(accum) = 86.3
 T(global opt: reduction of opS & opH [comm]) = 1.944e-03 S  per = 1.05  per(accum) = 87.4
 T(global opt: conversion from opAB to opPQ ) = 7.628e-03 S  per = 4.11  per(accum) = 91.5
 T(global opt: after oper_renorm            ) = 1.578e-02 S  per =  8.5  per(accum) = 100

isweep=0 ibond=22/seqsize=34 dots=2 dbond=(12,0)-(13,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.812e+01S Sys:1.192e+00S Total:3.932e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=745:5.684e-03MB:5.551e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=52:3.967e-04MB:3.874e-07GB
total mem of comb=798:6.088e-03MB:5.946e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=12,6,1,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc1= 8
 suppc2= 9
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:12 S:8 H:1 P:64 Q:72 
        dim(bra,ket)=10,10 size(op)=54:4.120e-04MB size(tot)=3602:2.748e-02MB:2.684e-05GB
 rqops: oplist=CSHAB nops=C:6 S:14 H:1 A:36 B:42 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=1819:1.388e-02MB:1.355e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=7417:5.659e-02MB:5.526e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(13,0) fdel=./scratch/sweep/lop(12,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=117:8.926e-04MB
qtensor4: wf4 own=1 _data=0x55a322a9c670
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (18,2):4 (18,4):3 (17,3):2 (19,3):1
 qbond: qcol nsym=6 dimAll=10
 (9,3):3 (8,2):2 (8,4):2 (7,3):1 (10,2):1 (9,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=28 nblocks=384 size=117:8.926e-04MB
### DIAG TIMING: total=5.924e-03 t1=8.707e-06, t2=1.630e-05, t3=1.864e-05, t4=5.855e-03, t5=4.451e-06, t6=1.749e-05, t7=3.990e-06
duration_diagGPU:6.015e-03
duration_diagreduce:2.800e-08
duration_diagtransform:2.660e-07
----- TIMING FOR symbolic_formulae_twodot with size=609 : 1.156e-03 S -----
rank=0 GPUmem(GB): used=5.53e-05 (oper)=5.53e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=609
 no. of hintermediate operators=304
 no. of coefficients=4083:0.0312MB:3.04e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.486e-04 S -----
rank=0 GPUmem(GB): used=8.57e-05 (oper,hinter)=5.53e-05,3.04e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0341 S size(H_formulae)=609 size(Hxlst2)=28 T(Hmu/Hxlist)=0.000223,0.0339 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0347 S size(H_formulae)=609 size(Hxlst)=21324 -----
rank=0 GPUmem(GB): used=0.00549 (oper,hinter,dvdson,batch)=5.53e-05,3.04e-05,1.74e-06,0.0054 blksize=12 blksize0=9 batchsize=21324
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=117 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.14e-05,0.000309,0.00183,0.000989,0.00317
 ndim=117:8.72e-07GB t[comm(intra)]=2.42e-05 speed=0.0721GB/S t[comm(inter)]=7.19e-06 speed=0.242GB/S
--- TIMING FOR sigma : t_inter=3.1e-04 t_gemm=1.8e-03 t_reduction=9.9e-04 tot=3.1e-03 ---
 sigma[inter] counter=134 t=3.1e-04 per=9.9e+00 cost=1.2e+06 flops=3.9e+09
 sigma[gemm] counter=134 i=0 t=2.7e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=1 t=2.2e-06 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=2 t=2.2e-06 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=3 t=2.2e-06 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=4 t=4.3e-04 per=1.4e+01 cost=1.8e+05 flops=4.2e+08
 sigma[gemm] counter=134 i=5 t=4.5e-04 per=1.4e+01 cost=1.7e+05 flops=3.7e+08
 sigma[gemm] counter=134 i=6 t=4.7e-04 per=1.5e+01 cost=1.7e+05 flops=3.5e+08
 sigma[gemm] counter=134 i=7 t=4.7e-04 per=1.5e+01 cost=1.8e+05 flops=3.8e+08
 sigma[gemm] counter=134 total t=1.8e-03 per=5.9e+01 cost=6.9e+05 flops=3.8e+08
 sigma[red] counter=134 t=9.9e-04 per=3.2e+01 cost=1.9e+05 flops=1.9e+08
--- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=1.1e-01 t_reduction=1.0e-01 tot=2.3e-01 ---
 sigma_tot[inter] counter=134 t=2.3e-02 per=9.7e+00 cost=9.3e+07 flops=4.1e+09
 sigma_tot[gemm] counter=134 i=0 t=3.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=1 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=2 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=3 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=4 t=2.5e-02 per=1.1e+01 cost=1.8e+07 flops=7.1e+08
 sigma_tot[gemm] counter=134 i=5 t=2.8e-02 per=1.2e+01 cost=1.8e+07 flops=6.5e+08
 sigma_tot[gemm] counter=134 i=6 t=2.7e-02 per=1.2e+01 cost=1.7e+07 flops=6.2e+08
 sigma_tot[gemm] counter=134 i=7 t=2.7e-02 per=1.1e+01 cost=1.8e+07 flops=6.7e+08
 sigma_tot[gemm] counter=134 total t=1.1e-01 per=4.6e+01 cost=7.1e+07 flops=6.5e+08
 sigma_tot[red] counter=134 t=1.0e-01 per=4.4e+01 cost=1.7e+07 flops=1.7e+08
T(sub)=7.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,3.1e-06,9.6e-07,8.7e-07,2.3e-07
settings: ndim=117 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.323178960724 -1.116e+03  3.577e-02    1     1  5.528e-03 5.528e-03 5.340e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.881e-05,2.418e-04,1.370e-03,9.403e-04,2.587e-03
 ndim=117:8.717e-07GB t[comm(intra)]=2.314e-05 speed=7.534e-02GB/S t[comm(inter)]=5.672e-06 speed=3.074e-01GB/S
--- TIMING FOR sigma : t_inter=2.4e-04 t_gemm=1.4e-03 t_reduction=9.4e-04 tot=2.6e-03 ---
 sigma[inter] counter=135 t=2.4e-04 per=9.5e+00 cost=1.2e+06 flops=4.9e+09
 sigma[gemm] counter=135 i=0 t=2.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=1 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=2 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=3 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=4 t=3.2e-04 per=1.2e+01 cost=1.8e+05 flops=5.7e+08
 sigma[gemm] counter=135 i=5 t=3.2e-04 per=1.3e+01 cost=1.7e+05 flops=5.2e+08
 sigma[gemm] counter=135 i=6 t=3.7e-04 per=1.4e+01 cost=1.7e+05 flops=4.5e+08
 sigma[gemm] counter=135 i=7 t=3.6e-04 per=1.4e+01 cost=1.8e+05 flops=5.0e+08
 sigma[gemm] counter=135 total t=1.4e-03 per=5.4e+01 cost=6.9e+05 flops=5.1e+08
 sigma[red] counter=135 t=9.4e-04 per=3.7e+01 cost=1.9e+05 flops=2.0e+08
--- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=1.1e-01 t_reduction=1.0e-01 tot=2.4e-01 ---
 sigma_tot[inter] counter=135 t=2.3e-02 per=9.7e+00 cost=9.5e+07 flops=4.1e+09
 sigma_tot[gemm] counter=135 i=0 t=3.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=1 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=2 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=3 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=4 t=2.6e-02 per=1.1e+01 cost=1.8e+07 flops=7.1e+08
 sigma_tot[gemm] counter=135 i=5 t=2.8e-02 per=1.2e+01 cost=1.8e+07 flops=6.5e+08
 sigma_tot[gemm] counter=135 i=6 t=2.7e-02 per=1.2e+01 cost=1.7e+07 flops=6.2e+08
 sigma_tot[gemm] counter=135 i=7 t=2.7e-02 per=1.1e+01 cost=1.8e+07 flops=6.6e+08
 sigma_tot[gemm] counter=135 total t=1.1e-01 per=4.6e+01 cost=7.1e+07 flops=6.5e+08
 sigma_tot[red] counter=135 t=1.0e-01 per=4.4e+01 cost=1.7e+07 flops=1.7e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,9.7e-06,2.3e-06,1.4e-06,2.0e-07
    2   0 -    -116.327002472094 -3.824e-03  1.195e-02    2     2  1.067e-02 5.335e-03 4.992e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.825e-05,2.390e-04,1.367e-03,9.287e-04,2.568e-03
 ndim=117:8.717e-07GB t[comm(intra)]=2.268e-05 speed=7.686e-02GB/S t[comm(inter)]=5.564e-06 speed=3.133e-01GB/S
--- TIMING FOR sigma : t_inter=2.4e-04 t_gemm=1.4e-03 t_reduction=9.3e-04 tot=2.5e-03 ---
 sigma[inter] counter=136 t=2.4e-04 per=9.4e+00 cost=1.2e+06 flops=5.0e+09
 sigma[gemm] counter=136 i=0 t=2.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=1 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=2 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=3 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=4 t=3.2e-04 per=1.3e+01 cost=1.8e+05 flops=5.7e+08
 sigma[gemm] counter=136 i=5 t=3.2e-04 per=1.3e+01 cost=1.7e+05 flops=5.2e+08
 sigma[gemm] counter=136 i=6 t=3.7e-04 per=1.5e+01 cost=1.7e+05 flops=4.5e+08
 sigma[gemm] counter=136 i=7 t=3.5e-04 per=1.4e+01 cost=1.8e+05 flops=5.1e+08
 sigma[gemm] counter=136 total t=1.4e-03 per=5.4e+01 cost=6.9e+05 flops=5.1e+08
 sigma[red] counter=136 t=9.3e-04 per=3.7e+01 cost=1.9e+05 flops=2.0e+08
--- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=1.1e-01 t_reduction=1.1e-01 tot=2.4e-01 ---
 sigma_tot[inter] counter=136 t=2.3e-02 per=9.7e+00 cost=9.6e+07 flops=4.1e+09
 sigma_tot[gemm] counter=136 i=0 t=3.5e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=1 t=3.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=2 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=3 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=4 t=2.6e-02 per=1.1e+01 cost=1.8e+07 flops=7.1e+08
 sigma_tot[gemm] counter=136 i=5 t=2.8e-02 per=1.2e+01 cost=1.8e+07 flops=6.4e+08
 sigma_tot[gemm] counter=136 i=6 t=2.8e-02 per=1.2e+01 cost=1.7e+07 flops=6.2e+08
 sigma_tot[gemm] counter=136 i=7 t=2.7e-02 per=1.1e+01 cost=1.8e+07 flops=6.6e+08
 sigma_tot[gemm] counter=136 total t=1.1e-01 per=4.6e+01 cost=7.2e+07 flops=6.5e+08
 sigma_tot[red] counter=136 t=1.1e-01 per=4.4e+01 cost=1.8e+07 flops=1.7e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.3e-05,2.0e-06,9.8e-07,1.7e-07
    3   0 -    -116.327419414968 -4.169e-04  4.801e-03    3     3  1.549e-02 5.163e-03 4.856e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.790e-05,2.457e-04,1.362e-03,9.280e-04,2.569e-03
 ndim=117:8.717e-07GB t[comm(intra)]=2.221e-05 speed=7.849e-02GB/S t[comm(inter)]=5.687e-06 speed=3.066e-01GB/S
--- TIMING FOR sigma : t_inter=2.5e-04 t_gemm=1.4e-03 t_reduction=9.3e-04 tot=2.5e-03 ---
 sigma[inter] counter=137 t=2.5e-04 per=9.7e+00 cost=1.2e+06 flops=4.9e+09
 sigma[gemm] counter=137 i=0 t=2.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=1 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=2 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=3 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=4 t=3.1e-04 per=1.2e+01 cost=1.8e+05 flops=5.8e+08
 sigma[gemm] counter=137 i=5 t=3.2e-04 per=1.3e+01 cost=1.7e+05 flops=5.2e+08
 sigma[gemm] counter=137 i=6 t=3.7e-04 per=1.5e+01 cost=1.7e+05 flops=4.5e+08
 sigma[gemm] counter=137 i=7 t=3.5e-04 per=1.4e+01 cost=1.8e+05 flops=5.1e+08
 sigma[gemm] counter=137 total t=1.4e-03 per=5.4e+01 cost=6.9e+05 flops=5.1e+08
 sigma[red] counter=137 t=9.3e-04 per=3.7e+01 cost=1.9e+05 flops=2.0e+08
--- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=1.1e-01 t_reduction=1.1e-01 tot=2.4e-01 ---
 sigma_tot[inter] counter=137 t=2.3e-02 per=9.7e+00 cost=9.7e+07 flops=4.1e+09
 sigma_tot[gemm] counter=137 i=0 t=3.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=1 t=3.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=2 t=3.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=3 t=3.0e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=4 t=2.6e-02 per=1.1e+01 cost=1.9e+07 flops=7.1e+08
 sigma_tot[gemm] counter=137 i=5 t=2.9e-02 per=1.2e+01 cost=1.8e+07 flops=6.4e+08
 sigma_tot[gemm] counter=137 i=6 t=2.8e-02 per=1.2e+01 cost=1.7e+07 flops=6.1e+08
 sigma_tot[gemm] counter=137 i=7 t=2.8e-02 per=1.1e+01 cost=1.8e+07 flops=6.6e+08
 sigma_tot[gemm] counter=137 total t=1.1e-01 per=4.6e+01 cost=7.3e+07 flops=6.5e+08
 sigma_tot[red] counter=137 t=1.1e-01 per=4.4e+01 cost=1.8e+07 flops=1.7e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.1e-05,1.7e-06,9.6e-07,1.6e-07
    4   0 -    -116.327507432792 -8.802e-05  2.485e-03    3     4  2.039e-02 5.098e-03 4.805e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.785e-05,2.378e-04,1.393e-03,9.203e-04,2.584e-03
 ndim=117:8.717e-07GB t[comm(intra)]=2.224e-05 speed=7.840e-02GB/S t[comm(inter)]=5.617e-06 speed=3.104e-01GB/S
--- TIMING FOR sigma : t_inter=2.4e-04 t_gemm=1.4e-03 t_reduction=9.2e-04 tot=2.5e-03 ---
 sigma[inter] counter=138 t=2.4e-04 per=9.3e+00 cost=1.2e+06 flops=5.0e+09
 sigma[gemm] counter=138 i=0 t=2.4e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=1 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=2 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=3 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=4 t=3.5e-04 per=1.4e+01 cost=1.8e+05 flops=5.2e+08
 sigma[gemm] counter=138 i=5 t=3.2e-04 per=1.2e+01 cost=1.7e+05 flops=5.2e+08
 sigma[gemm] counter=138 i=6 t=3.7e-04 per=1.4e+01 cost=1.7e+05 flops=4.5e+08
 sigma[gemm] counter=138 i=7 t=3.5e-04 per=1.4e+01 cost=1.8e+05 flops=5.1e+08
 sigma[gemm] counter=138 total t=1.4e-03 per=5.5e+01 cost=6.9e+05 flops=5.0e+08
 sigma[red] counter=138 t=9.2e-04 per=3.6e+01 cost=1.9e+05 flops=2.0e+08
--- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=1.1e-01 t_reduction=1.1e-01 tot=2.4e-01 ---
 sigma_tot[inter] counter=138 t=2.4e-02 per=9.7e+00 cost=9.8e+07 flops=4.2e+09
 sigma_tot[gemm] counter=138 i=0 t=3.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=1 t=3.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=2 t=3.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=3 t=3.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=4 t=2.7e-02 per=1.1e+01 cost=1.9e+07 flops=7.0e+08
 sigma_tot[gemm] counter=138 i=5 t=2.9e-02 per=1.2e+01 cost=1.9e+07 flops=6.4e+08
 sigma_tot[gemm] counter=138 i=6 t=2.9e-02 per=1.2e+01 cost=1.7e+07 flops=6.1e+08
 sigma_tot[gemm] counter=138 i=7 t=2.8e-02 per=1.1e+01 cost=1.8e+07 flops=6.6e+08
 sigma_tot[gemm] counter=138 total t=1.1e-01 per=4.6e+01 cost=7.3e+07 flops=6.5e+08
 sigma_tot[red] counter=138 t=1.1e-01 per=4.4e+01 cost=1.8e+07 flops=1.7e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.1e-05,1.7e-06,1.0e-06,1.5e-07
    5   0 -    -116.327523715919 -1.628e-05  7.352e-04    3     5  2.529e-02 5.058e-03 4.777e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.826e-05,2.413e-04,1.360e-03,9.391e-04,2.574e-03
 ndim=117:8.717e-07GB t[comm(intra)]=2.238e-05 speed=7.792e-02GB/S t[comm(inter)]=5.879e-06 speed=2.966e-01GB/S
--- TIMING FOR sigma : t_inter=2.4e-04 t_gemm=1.4e-03 t_reduction=9.4e-04 tot=2.5e-03 ---
 sigma[inter] counter=139 t=2.4e-04 per=9.5e+00 cost=1.2e+06 flops=4.9e+09
 sigma[gemm] counter=139 i=0 t=2.7e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=1 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=2 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=3 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=4 t=3.1e-04 per=1.2e+01 cost=1.8e+05 flops=5.8e+08
 sigma[gemm] counter=139 i=5 t=3.2e-04 per=1.3e+01 cost=1.7e+05 flops=5.2e+08
 sigma[gemm] counter=139 i=6 t=3.7e-04 per=1.4e+01 cost=1.7e+05 flops=4.6e+08
 sigma[gemm] counter=139 i=7 t=3.5e-04 per=1.4e+01 cost=1.8e+05 flops=5.1e+08
 sigma[gemm] counter=139 total t=1.4e-03 per=5.4e+01 cost=6.9e+05 flops=5.1e+08
 sigma[red] counter=139 t=9.4e-04 per=3.7e+01 cost=1.9e+05 flops=2.0e+08
--- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=1.1e-01 t_reduction=1.1e-01 tot=2.5e-01 ---
 sigma_tot[inter] counter=139 t=2.4e-02 per=9.7e+00 cost=9.9e+07 flops=4.2e+09
 sigma_tot[gemm] counter=139 i=0 t=3.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=1 t=3.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=2 t=3.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=3 t=3.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=4 t=2.7e-02 per=1.1e+01 cost=1.9e+07 flops=7.0e+08
 sigma_tot[gemm] counter=139 i=5 t=2.9e-02 per=1.2e+01 cost=1.9e+07 flops=6.4e+08
 sigma_tot[gemm] counter=139 i=6 t=2.9e-02 per=1.2e+01 cost=1.8e+07 flops=6.1e+08
 sigma_tot[gemm] counter=139 i=7 t=2.8e-02 per=1.1e+01 cost=1.9e+07 flops=6.6e+08
 sigma_tot[gemm] counter=139 total t=1.1e-01 per=4.6e+01 cost=7.4e+07 flops=6.4e+08
 sigma_tot[red] counter=139 t=1.1e-01 per=4.4e+01 cost=1.8e+07 flops=1.7e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.1e-05,1.7e-06,9.8e-07,1.3e-07
    6   0 -    -116.327525646040 -1.930e-06  2.496e-04    3     6  3.020e-02 5.034e-03 4.756e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.770e-05,2.366e-04,1.365e-03,9.216e-04,2.556e-03
 ndim=117:8.717e-07GB t[comm(intra)]=2.219e-05 speed=7.855e-02GB/S t[comm(inter)]=5.501e-06 speed=3.169e-01GB/S
--- TIMING FOR sigma : t_inter=2.4e-04 t_gemm=1.4e-03 t_reduction=9.2e-04 tot=2.5e-03 ---
 sigma[inter] counter=140 t=2.4e-04 per=9.4e+00 cost=1.2e+06 flops=5.0e+09
 sigma[gemm] counter=140 i=0 t=2.3e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=1 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=2 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=3 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=4 t=3.1e-04 per=1.2e+01 cost=1.8e+05 flops=5.8e+08
 sigma[gemm] counter=140 i=5 t=3.2e-04 per=1.2e+01 cost=1.7e+05 flops=5.3e+08
 sigma[gemm] counter=140 i=6 t=3.7e-04 per=1.5e+01 cost=1.7e+05 flops=4.5e+08
 sigma[gemm] counter=140 i=7 t=3.6e-04 per=1.4e+01 cost=1.8e+05 flops=5.0e+08
 sigma[gemm] counter=140 total t=1.4e-03 per=5.4e+01 cost=6.9e+05 flops=5.1e+08
 sigma[red] counter=140 t=9.2e-04 per=3.7e+01 cost=1.9e+05 flops=2.0e+08
--- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.5e-01 ---
 sigma_tot[inter] counter=140 t=2.4e-02 per=9.7e+00 cost=1.0e+08 flops=4.2e+09
 sigma_tot[gemm] counter=140 i=0 t=3.6e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=1 t=3.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=2 t=3.1e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=3 t=3.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=4 t=2.7e-02 per=1.1e+01 cost=1.9e+07 flops=7.0e+08
 sigma_tot[gemm] counter=140 i=5 t=3.0e-02 per=1.2e+01 cost=1.9e+07 flops=6.4e+08
 sigma_tot[gemm] counter=140 i=6 t=2.9e-02 per=1.2e+01 cost=1.8e+07 flops=6.1e+08
 sigma_tot[gemm] counter=140 i=7 t=2.9e-02 per=1.1e+01 cost=1.9e+07 flops=6.5e+08
 sigma_tot[gemm] counter=140 total t=1.2e-01 per=4.7e+01 cost=7.5e+07 flops=6.4e+08
 sigma_tot[red] counter=140 t=1.1e-01 per=4.4e+01 cost=1.8e+07 flops=1.7e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.0e-05,1.6e-06,9.3e-07,1.5e-07
    7   0 +    -116.327525813352 -1.673e-07  7.757e-05    3     7  3.504e-02 5.006e-03 4.736e-03
TIMING FOR Davidson : 3.513e-02  T(cal/comm/rest)=3.315e-02,3.230e-07,1.972e-03
decomposed t_rest=1.972e-03
 T(sub)    =1.187e-04 per=6.016e+00
 T(precond)=4.147e-04 per=2.103e+01
 T(ortho)  =1.734e-05 per=8.792e-01
 T(xcopy)  =8.620e-07 per=4.371e-02
 T(xnrm2)  =1.201e-06 per=6.089e-02
 T(other)  =1.420e-03 per=7.197e+01
optimized energies: isweep=0 ibond=22 dots=2 e[0]=-116.327525813352 nmvp=7
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:3.992e+01S Sys:1.192e+00S Total:4.111e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond22.txt
 qbond: qsuper nsym=12 dimAll=40
 (9,3):8 (8,2):3 (8,4):3 (7,3):1 (10,2):7 (9,1):3 (11,3):4 (10,4):5 (12,2):1 (11,1):2 (9,5):2 (10,0):1
----- TMING FOR decimation_genbasis(su2): 1.3e-04 S -----
decimation summary: 40->10 dwt=+7.384e-04 SvN=7.675e-01
 qbond: qkept nsym=5 dimAll=10
 (10,2):3 (11,3):3 (10,4):2 (9,3):1 (12,2):1
----- TIMING for decimation_row(nkr): 3.541e-03 S T(decim/select/formRot)=4.514e-04,2.891e-03,1.986e-04 -----
----- TIMING FOR twodot_decimation: 3.810e-03 S T(wf/decim)=1.712e-04,3.639e-03 -----
ctns::oper_renorm coord=(13,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:7 S:13 H:1 A:49 B:56 
        dim(bra,ket)=10,10 size(op)=36:2.747e-04MB size(tot)=2500:1.907e-02MB:1.863e-05GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:4.015e+01S Sys:1.192e+00S Total:4.134e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=126 : 4.282e-04 S -----
rank=0 GPUmem(GB): used=7.75e-05 (oper)=3.96e-05
rank=0 GPUmem(GB): used=7.79e-05 (oper,site)(GB)=3.96e-05,3.87e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=126
 no. of rintermediate operators=122
 no. of coefficients=1899:0.0145MB:1.41e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.405e-04 S -----
rank=0 GPUmem(GB): used=9.2e-05 (oper,site,rinter)=3.96e-05,3.87e-07,1.41e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00221 S size(rtasks)=126 size(Rlst2)=25 T(Rmu/Rlist)=8.97e-05,0.00212 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00275 S size(rtasks)=126 size(Rlst)=2748 -----
rank=0 GPUmem(GB): used=9.2e-05 (oper,site,rinter,batch)=3.96e-05,3.87e-07,1.41e-05,0.000573 blksize=9 blksize0=9 batchsize=2748
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000222,0.000885,0.000322
--- TIMING FOR renorm : t_inter=2.2e-04 t_gemm=8.8e-04 t_reduction=3.2e-04 tot=1.4e-03 ---
 renorm[inter] counter=23 t=2.2e-04 per=1.6e+01 cost=1.6e+05 flops=7.1e+08
 renorm[gemm] counter=23 i=0 t=2.8e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=1 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=2 t=2.6e-04 per=1.8e+01 cost=1.9e+04 flops=7.5e+07
 renorm[gemm] counter=23 i=3 t=3.1e-04 per=2.1e+01 cost=3.2e+04 flops=1.0e+08
 renorm[gemm] counter=23 i=4 t=2.3e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=5 t=2.2e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=23 i=6 t=3.1e-04 per=2.2e+01 cost=5.2e+04 flops=1.7e+08
 renorm[gemm] counter=23 total t=8.8e-04 per=6.2e+01 cost=1.0e+05 flops=1.2e+08
 renorm[red] counter=23 t=3.2e-04 per=2.3e+01 cost=2.6e+04 flops=8.1e+07
--- TIMING FOR renorm_tot : t_inter=3.2e-03 t_gemm=1.6e-02 t_reduction=5.9e-03 tot=2.5e-02 ---
 renorm_tot[inter] counter=23 t=3.2e-03 per=1.3e+01 cost=1.9e+06 flops=6.1e+08
 renorm_tot[gemm] counter=23 i=0 t=6.5e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=23 i=1 t=5.3e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=23 i=2 t=1.5e-03 per=6.0e+00 cost=8.7e+04 flops=5.9e+07
 renorm_tot[gemm] counter=23 i=3 t=1.6e-03 per=6.4e+00 cost=1.1e+05 flops=7.0e+07
 renorm_tot[gemm] counter=23 i=4 t=3.6e-03 per=1.5e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=23 i=5 t=3.6e-03 per=1.5e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=23 i=6 t=5.3e-03 per=2.1e+01 cost=1.2e+06 flops=2.2e+08
 renorm_tot[gemm] counter=23 total t=1.6e-02 per=6.3e+01 cost=2.1e+06 flops=1.3e+08
 renorm_tot[red] counter=23 t=5.9e-03 per=2.4e+01 cost=5.2e+05 flops=8.9e+07
qops.to_cpu: size(tot)=2500:1.9e-02MB:1.9e-05GB t[to_cpu]=2.1e-05S speed=8.8e-01GB/S
check ||H-H.dagger||=1.690e-14 coord=(13,0) rank=0
ctns::oper_ab2pq coord=(13,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00906 S rank=0 -----
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:4.022e+01S Sys:1.192e+00S Total:4.141e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=762:5.814e-03MB:5.677e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=60:4.578e-04MB:4.470e-07GB
total mem of comb=823:6.279e-03MB:6.132e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:4.022e+01S Sys:1.192e+00S Total:4.142e+01S
##### local opt: 1.119e-01 S #####
 T(local opt: fetch) = 6.222e-03 S  per = 5.56  per(accum) = 5.56
 T(local opt: hdiag) = 6.926e-03 S  per = 6.19  per(accum) = 11.7
 T(local opt: dvdsn) = 7.978e-02 S  per = 71.3  per(accum) = 83
 T(local opt: decim) = 3.908e-03 S  per = 3.49  per(accum) = 86.5
 T(local opt: guess) = 1.144e-04 S  per = 0.102  per(accum) = 86.6
 T(local opt: renrm) = 9.994e-03 S  per = 8.93  per(accum) = 95.6
 T(local opt: save ) = 4.958e-03 S  per = 4.43  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.978e-02 S  T(sum) = 7.881e-02 S  per = 9.878e+01
 T(local opt: preprocess                  ) = 7.216e-04 S  per = 0.916  per(accum) = 0.916
 T(local opt: symbolic_formulae           ) = 1.247e-03 S  per = 1.58  per(accum) = 2.5
 T(local opt: hintermediate init          ) = 5.745e-04 S  per = 0.729  per(accum) = 3.23
 T(local opt: preprocess_hformulae_Hxlist ) = 3.486e-02 S  per = 44.2  per(accum) = 47.5
 T(local opt: hmmtasks init               ) = 6.007e-03 S  per = 7.62  per(accum) = 55.1
 T(local opt: initial guess for dvdson    ) = 2.720e-04 S  per = 0.345  per(accum) = 55.4
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.295e-02 S  per = 41.8  per(accum) = 97.2
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.001e-04 S  per = 0.254  per(accum) = 97.5
 T(local opt: dvdson solver [comm(cpu)]   ) = 3.230e-07 S  per = 0.00041  per(accum) = 97.5
 T(local opt: dvdson solver [rest part]   ) = 1.972e-03 S  per =  2.5  per(accum) = 100
Detailed decomposition of T(renrm) = 9.994e-03 S  T(sum) = 9.994e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.301e-04 S  per =  1.3  per(accum) = 1.3
 T(local opt: qops init                    ) = 5.423e-04 S  per = 5.43  per(accum) = 6.73
 T(local opt: symbolic_formulae_renorm     ) = 5.135e-04 S  per = 5.14  per(accum) = 11.9
 T(local opt: allocate qops on gpu         ) = 1.021e-04 S  per = 1.02  per(accum) = 12.9
 T(local opt: site memcpy cpu2gpu          ) = 9.806e-05 S  per = 0.981  per(accum) = 13.9
 T(local opt: rintermediate init           ) = 4.955e-04 S  per = 4.96  per(accum) = 18.8
 T(local opt: preprocess_formulae_Rlist2   ) = 2.894e-03 S  per =   29  per(accum) = 47.8
 T(local opt: rmmtasks init                ) = 8.995e-04 S  per =    9  per(accum) = 56.8
 T(local opt: qops memset on cpu           ) = 4.800e-08 S  per = 0.00048  per(accum) = 56.8
 T(local opt: preprocess_renorm_batchGPU   ) = 3.324e-03 S  per = 33.3  per(accum) = 90.1
 T(local opt: reduction of opS & opH [nccl]) = 6.880e-07 S  per = 0.00688  per(accum) = 90.1
 T(local opt: qops memcpy gpu2cpu          ) = 9.261e-05 S  per = 0.927  per(accum) = 91
 T(local opt: deallocate cpu and gpu memory) = 1.028e-05 S  per = 0.103  per(accum) = 91.1
 T(local opt: reduction of opS & opH [comm]) = 8.955e-05 S  per = 0.896  per(accum) = 92
 T(local opt: conversion from opAB to opPQ ) = 8.002e-05 S  per = 0.801  per(accum) = 92.8
 T(local opt: after oper_renorm            ) = 7.207e-04 S  per = 7.21  per(accum) = 100
##### sweep opt: 1.870e+00 S #####
 T(sweep opt: fetch) = 1.482e-01 S  per = 7.92  per(accum) = 7.92
 T(sweep opt: hdiag) = 1.098e-01 S  per = 5.87  per(accum) = 13.8
 T(sweep opt: dvdsn) = 1.225e+00 S  per = 65.5  per(accum) = 79.3
 T(sweep opt: decim) = 8.580e-02 S  per = 4.59  per(accum) = 83.9
 T(sweep opt: guess) = 2.759e-03 S  per = 0.148  per(accum) = 84
 T(sweep opt: renrm) = 1.956e-01 S  per = 10.5  per(accum) = 94.5
 T(sweep opt: save ) = 1.029e-01 S  per =  5.5  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.225e+00 S  T(sum) = 1.204e+00 S  per = 9.834e+01
 T(sweep opt: preprocess                  ) = 1.456e-02 S  per = 1.21  per(accum) = 1.21
 T(sweep opt: symbolic_formulae           ) = 2.273e-02 S  per = 1.89  per(accum) = 3.1
 T(sweep opt: hintermediate init          ) = 1.332e-02 S  per = 1.11  per(accum) = 4.2
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.883e-01 S  per = 40.5  per(accum) = 44.7
 T(sweep opt: hmmtasks init               ) = 8.322e-02 S  per = 6.91  per(accum) = 51.7
 T(sweep opt: initial guess for dvdson    ) = 5.525e-03 S  per = 0.459  per(accum) = 52.1
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 5.325e-01 S  per = 44.2  per(accum) = 96.3
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.013e-03 S  per = 0.333  per(accum) = 96.7
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 6.453e-06 S  per = 0.000536  per(accum) = 96.7
 T(sweep opt: dvdson solver [rest part]   ) = 4.018e-02 S  per = 3.34  per(accum) = 100
Detailed decomposition of T(renrm) = 1.956e-01 S  T(sum) = 1.956e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.778e-03 S  per = 1.42  per(accum) = 1.42
 T(sweep opt: qops init                    ) = 1.045e-02 S  per = 5.34  per(accum) = 6.76
 T(sweep opt: symbolic_formulae_renorm     ) = 1.039e-02 S  per = 5.31  per(accum) = 12.1
 T(sweep opt: allocate qops on gpu         ) = 2.168e-03 S  per = 1.11  per(accum) = 13.2
 T(sweep opt: site memcpy cpu2gpu          ) = 2.058e-03 S  per = 1.05  per(accum) = 14.2
 T(sweep opt: rintermediate init           ) = 1.086e-02 S  per = 5.55  per(accum) = 19.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.669e-02 S  per = 23.9  per(accum) = 43.6
 T(sweep opt: rmmtasks init                ) = 1.526e-02 S  per =  7.8  per(accum) = 51.4
 T(sweep opt: qops memset on cpu           ) = 1.132e-06 S  per = 0.000579  per(accum) = 51.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.600e-02 S  per = 33.7  per(accum) = 85.2
 T(sweep opt: reduction of opS & opH [nccl]) = 1.365e-05 S  per = 0.00698  per(accum) = 85.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.365e-03 S  per = 1.21  per(accum) = 86.4
 T(sweep opt: deallocate cpu and gpu memory) = 3.735e-04 S  per = 0.191  per(accum) = 86.6
 T(sweep opt: reduction of opS & opH [comm]) = 2.033e-03 S  per = 1.04  per(accum) = 87.6
 T(sweep opt: conversion from opAB to opPQ ) = 7.708e-03 S  per = 3.94  per(accum) = 91.6
 T(sweep opt: after oper_renorm            ) = 1.650e-02 S  per = 8.43  per(accum) = 100
##### global opt: 1.870e+00 S #####
 T(global opt: fetch) = 1.482e-01 S  per = 7.92  per(accum) = 7.92
 T(global opt: hdiag) = 1.098e-01 S  per = 5.87  per(accum) = 13.8
 T(global opt: dvdsn) = 1.225e+00 S  per = 65.5  per(accum) = 79.3
 T(global opt: decim) = 8.580e-02 S  per = 4.59  per(accum) = 83.9
 T(global opt: guess) = 2.759e-03 S  per = 0.148  per(accum) = 84
 T(global opt: renrm) = 1.956e-01 S  per = 10.5  per(accum) = 94.5
 T(global opt: save ) = 1.029e-01 S  per =  5.5  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.225e+00 S  T(sum) = 1.204e+00 S  per = 9.834e+01
 T(global opt: preprocess                  ) = 1.456e-02 S  per = 1.21  per(accum) = 1.21
 T(global opt: symbolic_formulae           ) = 2.273e-02 S  per = 1.89  per(accum) = 3.1
 T(global opt: hintermediate init          ) = 1.332e-02 S  per = 1.11  per(accum) = 4.2
 T(global opt: preprocess_hformulae_Hxlist ) = 4.883e-01 S  per = 40.5  per(accum) = 44.7
 T(global opt: hmmtasks init               ) = 8.322e-02 S  per = 6.91  per(accum) = 51.7
 T(global opt: initial guess for dvdson    ) = 5.525e-03 S  per = 0.459  per(accum) = 52.1
 T(global opt: dvdson solver [Hx_batchGPU] ) = 5.325e-01 S  per = 44.2  per(accum) = 96.3
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.013e-03 S  per = 0.333  per(accum) = 96.7
 T(global opt: dvdson solver [comm(cpu)]   ) = 6.453e-06 S  per = 0.000536  per(accum) = 96.7
 T(global opt: dvdson solver [rest part]   ) = 4.018e-02 S  per = 3.34  per(accum) = 100
Detailed decomposition of T(renrm) = 1.956e-01 S  T(sum) = 1.956e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.778e-03 S  per = 1.42  per(accum) = 1.42
 T(global opt: qops init                    ) = 1.045e-02 S  per = 5.34  per(accum) = 6.76
 T(global opt: symbolic_formulae_renorm     ) = 1.039e-02 S  per = 5.31  per(accum) = 12.1
 T(global opt: allocate qops on gpu         ) = 2.168e-03 S  per = 1.11  per(accum) = 13.2
 T(global opt: site memcpy cpu2gpu          ) = 2.058e-03 S  per = 1.05  per(accum) = 14.2
 T(global opt: rintermediate init           ) = 1.086e-02 S  per = 5.55  per(accum) = 19.8
 T(global opt: preprocess_formulae_Rlist2   ) = 4.669e-02 S  per = 23.9  per(accum) = 43.6
 T(global opt: rmmtasks init                ) = 1.526e-02 S  per =  7.8  per(accum) = 51.4
 T(global opt: qops memset on cpu           ) = 1.132e-06 S  per = 0.000579  per(accum) = 51.4
 T(global opt: preprocess_renorm_batchGPU   ) = 6.600e-02 S  per = 33.7  per(accum) = 85.2
 T(global opt: reduction of opS & opH [nccl]) = 1.365e-05 S  per = 0.00698  per(accum) = 85.2
 T(global opt: qops memcpy gpu2cpu          ) = 2.365e-03 S  per = 1.21  per(accum) = 86.4
 T(global opt: deallocate cpu and gpu memory) = 3.735e-04 S  per = 0.191  per(accum) = 86.6
 T(global opt: reduction of opS & opH [comm]) = 2.033e-03 S  per = 1.04  per(accum) = 87.6
 T(global opt: conversion from opAB to opPQ ) = 7.708e-03 S  per = 3.94  per(accum) = 91.6
 T(global opt: after oper_renorm            ) = 1.650e-02 S  per = 8.43  per(accum) = 100

isweep=0 ibond=23/seqsize=34 dots=2 dbond=(11,0)-(12,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:4.022e+01S Sys:1.194e+00S Total:4.142e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=762:5.814e-03MB:5.677e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=60:4.578e-04MB:4.470e-07GB
total mem of comb=823:6.279e-03MB:6.132e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=11,7,1,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc1= 7
 suppc2= 8
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:11 S:9 H:1 P:81 Q:90 
        dim(bra,ket)=10,10 size(op)=66:5.035e-04MB size(tot)=4935:3.765e-02MB:3.677e-05GB
 rqops: oplist=CSHAB nops=C:7 S:13 H:1 A:49 B:56 
        dim(bra,ket)=10,10 size(op)=36:2.747e-04MB size(tot)=2500:1.907e-02MB:1.863e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=9431:7.195e-02MB:7.027e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(12,0) fdel=./scratch/sweep/lop(11,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=118:9.003e-04MB
qtensor4: wf4 own=1 _data=0x55a322700fa0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (16,2):4 (16,4):4 (15,3):1 (17,3):1
 qbond: qcol nsym=5 dimAll=10
 (10,2):3 (11,3):3 (10,4):2 (9,3):1 (12,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=25 nblocks=320 size=118:9.003e-04MB
### DIAG TIMING: total=7.184e-03 t1=9.322e-06, t2=1.543e-05, t3=1.752e-05, t4=7.116e-03, t5=4.234e-06, t6=1.760e-05, t7=3.772e-06
duration_diagGPU:7.296e-03
duration_diagreduce:2.900e-08
duration_diagtransform:2.900e-07
----- TIMING FOR symbolic_formulae_twodot with size=716 : 1.339e-03 S -----
rank=0 GPUmem(GB): used=7.03e-05 (oper)=7.03e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=716
 no. of hintermediate operators=345
 no. of coefficients=4876:0.0372MB:3.63e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.870e-04 S -----
rank=0 GPUmem(GB): used=0.000107 (oper,hinter)=7.03e-05,3.63e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0321 S size(H_formulae)=716 size(Hxlst2)=25 T(Hmu/Hxlist)=0.00026,0.0319 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0327 S size(H_formulae)=716 size(Hxlst)=20306 -----
rank=0 GPUmem(GB): used=0.00525 (oper,hinter,dvdson,batch)=7.03e-05,3.63e-05,1.76e-06,0.00514 blksize=12 blksize0=9 batchsize=20306
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=118 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.06e-05,0.000257,0.000987,0.00089,0.00217
 ndim=118:8.79e-07GB t[comm(intra)]=2.35e-05 speed=0.0749GB/S t[comm(inter)]=7.14e-06 speed=0.246GB/S
--- TIMING FOR sigma : t_inter=2.6e-04 t_gemm=9.9e-04 t_reduction=8.9e-04 tot=2.1e-03 ---
 sigma[inter] counter=141 t=2.6e-04 per=1.2e+01 cost=1.2e+06 flops=4.8e+09
 sigma[gemm] counter=141 i=0 t=2.7e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=1 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=2 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=3 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=4 t=2.8e-04 per=1.3e+01 cost=2.2e+05 flops=8.1e+08
 sigma[gemm] counter=141 i=5 t=2.9e-04 per=1.4e+01 cost=2.1e+05 flops=7.1e+08
 sigma[gemm] counter=141 i=6 t=2.1e-04 per=9.9e+00 cost=1.7e+05 flops=8.1e+08
 sigma[gemm] counter=141 i=7 t=2.0e-04 per=9.4e+00 cost=1.9e+05 flops=9.3e+08
 sigma[gemm] counter=141 total t=9.9e-04 per=4.6e+01 cost=7.9e+05 flops=8.0e+08
 sigma[red] counter=141 t=8.9e-04 per=4.2e+01 cost=2.0e+05 flops=2.3e+08
--- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.5e-01 ---
 sigma_tot[inter] counter=141 t=2.4e-02 per=9.7e+00 cost=1.0e+08 flops=4.2e+09
 sigma_tot[gemm] counter=141 i=0 t=3.7e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=1 t=3.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=2 t=3.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=3 t=3.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=4 t=2.8e-02 per=1.1e+01 cost=1.9e+07 flops=7.0e+08
 sigma_tot[gemm] counter=141 i=5 t=3.0e-02 per=1.2e+01 cost=1.9e+07 flops=6.4e+08
 sigma_tot[gemm] counter=141 i=6 t=2.9e-02 per=1.2e+01 cost=1.8e+07 flops=6.1e+08
 sigma_tot[gemm] counter=141 i=7 t=2.9e-02 per=1.1e+01 cost=1.9e+07 flops=6.6e+08
 sigma_tot[gemm] counter=141 total t=1.2e-01 per=4.7e+01 cost=7.5e+07 flops=6.4e+08
 sigma_tot[red] counter=141 t=1.1e-01 per=4.4e+01 cost=1.9e+07 flops=1.7e+08
T(sub)=8.0e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,3.1e-06,9.5e-07,9.4e-07,2.4e-07
settings: ndim=118 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.327207159735 -1.116e+03  3.081e-02    1     1  4.752e-03 4.752e-03 4.558e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.787e-05,2.037e-04,7.804e-04,8.357e-04,1.853e-03
 ndim=118:8.792e-07GB t[comm(intra)]=2.233e-05 speed=7.875e-02GB/S t[comm(inter)]=5.544e-06 speed=3.172e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=7.8e-04 t_reduction=8.4e-04 tot=1.8e-03 ---
 sigma[inter] counter=142 t=2.0e-04 per=1.1e+01 cost=1.2e+06 flops=6.0e+09
 sigma[gemm] counter=142 i=0 t=2.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=3 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=4 t=2.1e-04 per=1.2e+01 cost=2.2e+05 flops=1.0e+09
 sigma[gemm] counter=142 i=5 t=2.1e-04 per=1.2e+01 cost=2.1e+05 flops=9.8e+08
 sigma[gemm] counter=142 i=6 t=1.8e-04 per=1.0e+01 cost=1.7e+05 flops=9.3e+08
 sigma[gemm] counter=142 i=7 t=1.6e-04 per=9.0e+00 cost=1.9e+05 flops=1.1e+09
 sigma[gemm] counter=142 total t=7.8e-04 per=4.3e+01 cost=7.9e+05 flops=1.0e+09
 sigma[red] counter=142 t=8.4e-04 per=4.6e+01 cost=2.0e+05 flops=2.4e+08
--- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.5e-01 ---
 sigma_tot[inter] counter=142 t=2.5e-02 per=9.7e+00 cost=1.0e+08 flops=4.2e+09
 sigma_tot[gemm] counter=142 i=0 t=3.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=1 t=3.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=2 t=3.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=3 t=3.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=4 t=2.8e-02 per=1.1e+01 cost=2.0e+07 flops=7.0e+08
 sigma_tot[gemm] counter=142 i=5 t=3.0e-02 per=1.2e+01 cost=1.9e+07 flops=6.4e+08
 sigma_tot[gemm] counter=142 i=6 t=3.0e-02 per=1.2e+01 cost=1.8e+07 flops=6.1e+08
 sigma_tot[gemm] counter=142 i=7 t=2.9e-02 per=1.1e+01 cost=1.9e+07 flops=6.6e+08
 sigma_tot[gemm] counter=142 total t=1.2e-01 per=4.7e+01 cost=7.6e+07 flops=6.5e+08
 sigma_tot[red] counter=142 t=1.1e-01 per=4.4e+01 cost=1.9e+07 flops=1.7e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,9.7e-06,2.3e-06,1.0e-06,1.9e-07
    2   0 -    -116.329431037463 -2.224e-03  1.179e-02    2     2  9.306e-03 4.653e-03 4.286e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.775e-05,2.015e-04,7.698e-04,8.268e-04,1.831e-03
 ndim=118:8.792e-07GB t[comm(intra)]=2.233e-05 speed=7.873e-02GB/S t[comm(inter)]=5.419e-06 speed=3.245e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=7.7e-04 t_reduction=8.3e-04 tot=1.8e-03 ---
 sigma[inter] counter=143 t=2.0e-04 per=1.1e+01 cost=1.2e+06 flops=6.1e+09
 sigma[gemm] counter=143 i=0 t=2.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=3 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=4 t=2.1e-04 per=1.2e+01 cost=2.2e+05 flops=1.1e+09
 sigma[gemm] counter=143 i=5 t=2.2e-04 per=1.2e+01 cost=2.1e+05 flops=9.5e+08
 sigma[gemm] counter=143 i=6 t=1.7e-04 per=9.3e+00 cost=1.7e+05 flops=1.0e+09
 sigma[gemm] counter=143 i=7 t=1.6e-04 per=9.1e+00 cost=1.9e+05 flops=1.1e+09
 sigma[gemm] counter=143 total t=7.7e-04 per=4.3e+01 cost=7.9e+05 flops=1.0e+09
 sigma[red] counter=143 t=8.3e-04 per=4.6e+01 cost=2.0e+05 flops=2.4e+08
--- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.6e-01 ---
 sigma_tot[inter] counter=143 t=2.5e-02 per=9.7e+00 cost=1.0e+08 flops=4.2e+09
 sigma_tot[gemm] counter=143 i=0 t=3.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=1 t=3.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=2 t=3.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=3 t=3.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=4 t=2.8e-02 per=1.1e+01 cost=2.0e+07 flops=7.1e+08
 sigma_tot[gemm] counter=143 i=5 t=3.0e-02 per=1.2e+01 cost=2.0e+07 flops=6.4e+08
 sigma_tot[gemm] counter=143 i=6 t=3.0e-02 per=1.2e+01 cost=1.8e+07 flops=6.1e+08
 sigma_tot[gemm] counter=143 i=7 t=2.9e-02 per=1.1e+01 cost=1.9e+07 flops=6.6e+08
 sigma_tot[gemm] counter=143 total t=1.2e-01 per=4.6e+01 cost=7.7e+07 flops=6.5e+08
 sigma_tot[red] counter=143 t=1.1e-01 per=4.4e+01 cost=1.9e+07 flops=1.7e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.2e-05,1.7e-06,1.0e-06,1.9e-07
    3   0 -    -116.329868692264 -4.377e-04  5.326e-03    3     3  1.336e-02 4.455e-03 4.143e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.700e-05,1.976e-04,7.638e-04,8.231e-04,1.816e-03
 ndim=118:8.792e-07GB t[comm(intra)]=2.143e-05 speed=8.206e-02GB/S t[comm(inter)]=5.575e-06 speed=3.154e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=7.6e-04 t_reduction=8.2e-04 tot=1.8e-03 ---
 sigma[inter] counter=144 t=2.0e-04 per=1.1e+01 cost=1.2e+06 flops=6.2e+09
 sigma[gemm] counter=144 i=0 t=2.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=3 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=4 t=2.1e-04 per=1.2e+01 cost=2.2e+05 flops=1.1e+09
 sigma[gemm] counter=144 i=5 t=2.2e-04 per=1.2e+01 cost=2.1e+05 flops=9.5e+08
 sigma[gemm] counter=144 i=6 t=1.7e-04 per=9.3e+00 cost=1.7e+05 flops=1.0e+09
 sigma[gemm] counter=144 i=7 t=1.6e-04 per=9.2e+00 cost=1.9e+05 flops=1.1e+09
 sigma[gemm] counter=144 total t=7.6e-04 per=4.3e+01 cost=7.9e+05 flops=1.0e+09
 sigma[red] counter=144 t=8.2e-04 per=4.6e+01 cost=2.0e+05 flops=2.5e+08
--- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.6e-01 ---
 sigma_tot[inter] counter=144 t=2.5e-02 per=9.7e+00 cost=1.1e+08 flops=4.2e+09
 sigma_tot[gemm] counter=144 i=0 t=3.7e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=1 t=3.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=2 t=3.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=3 t=3.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=4 t=2.8e-02 per=1.1e+01 cost=2.0e+07 flops=7.1e+08
 sigma_tot[gemm] counter=144 i=5 t=3.1e-02 per=1.2e+01 cost=2.0e+07 flops=6.5e+08
 sigma_tot[gemm] counter=144 i=6 t=3.0e-02 per=1.2e+01 cost=1.8e+07 flops=6.2e+08
 sigma_tot[gemm] counter=144 i=7 t=2.9e-02 per=1.1e+01 cost=2.0e+07 flops=6.6e+08
 sigma_tot[gemm] counter=144 total t=1.2e-01 per=4.6e+01 cost=7.8e+07 flops=6.5e+08
 sigma_tot[red] counter=144 t=1.1e-01 per=4.4e+01 cost=1.9e+07 flops=1.7e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.0e-05,1.6e-06,9.9e-07,1.3e-07
    4   0 -    -116.329961643364 -9.295e-05  2.485e-03    3     4  1.748e-02 4.371e-03 4.087e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.675e-05,1.975e-04,7.633e-04,8.242e-04,1.816e-03
 ndim=118:8.792e-07GB t[comm(intra)]=2.147e-05 speed=8.191e-02GB/S t[comm(inter)]=5.281e-06 speed=3.330e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=7.6e-04 t_reduction=8.2e-04 tot=1.8e-03 ---
 sigma[inter] counter=145 t=2.0e-04 per=1.1e+01 cost=1.2e+06 flops=6.2e+09
 sigma[gemm] counter=145 i=0 t=2.3e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=3 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=4 t=2.2e-04 per=1.2e+01 cost=2.2e+05 flops=1.0e+09
 sigma[gemm] counter=145 i=5 t=2.1e-04 per=1.2e+01 cost=2.1e+05 flops=1.0e+09
 sigma[gemm] counter=145 i=6 t=1.7e-04 per=9.3e+00 cost=1.7e+05 flops=1.0e+09
 sigma[gemm] counter=145 i=7 t=1.6e-04 per=9.1e+00 cost=1.9e+05 flops=1.1e+09
 sigma[gemm] counter=145 total t=7.6e-04 per=4.3e+01 cost=7.9e+05 flops=1.0e+09
 sigma[red] counter=145 t=8.2e-04 per=4.6e+01 cost=2.0e+05 flops=2.5e+08
--- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.6e-01 ---
 sigma_tot[inter] counter=145 t=2.5e-02 per=9.7e+00 cost=1.1e+08 flops=4.2e+09
 sigma_tot[gemm] counter=145 i=0 t=3.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=1 t=3.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=2 t=3.2e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=3 t=3.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=4 t=2.8e-02 per=1.1e+01 cost=2.0e+07 flops=7.1e+08
 sigma_tot[gemm] counter=145 i=5 t=3.1e-02 per=1.2e+01 cost=2.0e+07 flops=6.5e+08
 sigma_tot[gemm] counter=145 i=6 t=3.0e-02 per=1.2e+01 cost=1.9e+07 flops=6.2e+08
 sigma_tot[gemm] counter=145 i=7 t=3.0e-02 per=1.1e+01 cost=2.0e+07 flops=6.7e+08
 sigma_tot[gemm] counter=145 total t=1.2e-01 per=4.6e+01 cost=7.9e+07 flops=6.5e+08
 sigma_tot[red] counter=145 t=1.1e-01 per=4.4e+01 cost=1.9e+07 flops=1.7e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,9.9e-06,1.7e-06,8.8e-07,1.4e-07
    5   0 -    -116.329978641602 -1.700e-05  7.597e-04    3     5  2.155e-02 4.310e-03 4.046e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.715e-05,1.970e-04,7.688e-04,8.218e-04,1.819e-03
 ndim=118:8.792e-07GB t[comm(intra)]=2.177e-05 speed=8.078e-02GB/S t[comm(inter)]=5.380e-06 speed=3.268e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=7.7e-04 t_reduction=8.2e-04 tot=1.8e-03 ---
 sigma[inter] counter=146 t=2.0e-04 per=1.1e+01 cost=1.2e+06 flops=6.2e+09
 sigma[gemm] counter=146 i=0 t=2.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=1 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=3 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=4 t=2.2e-04 per=1.2e+01 cost=2.2e+05 flops=1.0e+09
 sigma[gemm] counter=146 i=5 t=2.1e-04 per=1.2e+01 cost=2.1e+05 flops=9.9e+08
 sigma[gemm] counter=146 i=6 t=1.7e-04 per=9.3e+00 cost=1.7e+05 flops=1.0e+09
 sigma[gemm] counter=146 i=7 t=1.6e-04 per=9.2e+00 cost=1.9e+05 flops=1.1e+09
 sigma[gemm] counter=146 total t=7.7e-04 per=4.3e+01 cost=7.9e+05 flops=1.0e+09
 sigma[red] counter=146 t=8.2e-04 per=4.6e+01 cost=2.0e+05 flops=2.5e+08
--- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=1.2e-01 t_reduction=1.1e-01 tot=2.6e-01 ---
 sigma_tot[inter] counter=146 t=2.5e-02 per=9.7e+00 cost=1.1e+08 flops=4.3e+09
 sigma_tot[gemm] counter=146 i=0 t=3.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=1 t=3.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=2 t=3.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=3 t=3.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=4 t=2.9e-02 per=1.1e+01 cost=2.0e+07 flops=7.1e+08
 sigma_tot[gemm] counter=146 i=5 t=3.1e-02 per=1.2e+01 cost=2.0e+07 flops=6.5e+08
 sigma_tot[gemm] counter=146 i=6 t=3.0e-02 per=1.2e+01 cost=1.9e+07 flops=6.2e+08
 sigma_tot[gemm] counter=146 i=7 t=3.0e-02 per=1.1e+01 cost=2.0e+07 flops=6.7e+08
 sigma_tot[gemm] counter=146 total t=1.2e-01 per=4.6e+01 cost=7.9e+07 flops=6.6e+08
 sigma_tot[red] counter=146 t=1.1e-01 per=4.4e+01 cost=2.0e+07 flops=1.7e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.0e-05,1.6e-06,9.6e-07,1.5e-07
    6   0 -    -116.329980035776 -1.394e-06  2.286e-04    3     6  2.907e-02 4.845e-03 4.594e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.771e-05,1.977e-04,7.690e-04,8.277e-04,1.827e-03
 ndim=118:8.792e-07GB t[comm(intra)]=2.212e-05 speed=7.949e-02GB/S t[comm(inter)]=5.585e-06 speed=3.148e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=7.7e-04 t_reduction=8.3e-04 tot=1.8e-03 ---
 sigma[inter] counter=147 t=2.0e-04 per=1.1e+01 cost=1.2e+06 flops=6.2e+09
 sigma[gemm] counter=147 i=0 t=2.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=1 t=2.3e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=3 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=4 t=2.1e-04 per=1.2e+01 cost=2.2e+05 flops=1.1e+09
 sigma[gemm] counter=147 i=5 t=2.1e-04 per=1.2e+01 cost=2.1e+05 flops=9.9e+08
 sigma[gemm] counter=147 i=6 t=1.8e-04 per=1.0e+01 cost=1.7e+05 flops=9.5e+08
 sigma[gemm] counter=147 i=7 t=1.6e-04 per=9.0e+00 cost=1.9e+05 flops=1.2e+09
 sigma[gemm] counter=147 total t=7.7e-04 per=4.3e+01 cost=7.9e+05 flops=1.0e+09
 sigma[red] counter=147 t=8.3e-04 per=4.6e+01 cost=2.0e+05 flops=2.4e+08
--- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=1.2e-01 t_reduction=1.2e-01 tot=2.6e-01 ---
 sigma_tot[inter] counter=147 t=2.6e-02 per=9.7e+00 cost=1.1e+08 flops=4.3e+09
 sigma_tot[gemm] counter=147 i=0 t=3.8e-04 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=1 t=3.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=2 t=3.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=3 t=3.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=4 t=2.9e-02 per=1.1e+01 cost=2.1e+07 flops=7.2e+08
 sigma_tot[gemm] counter=147 i=5 t=3.1e-02 per=1.2e+01 cost=2.0e+07 flops=6.5e+08
 sigma_tot[gemm] counter=147 i=6 t=3.1e-02 per=1.2e+01 cost=1.9e+07 flops=6.2e+08
 sigma_tot[gemm] counter=147 i=7 t=3.0e-02 per=1.1e+01 cost=2.0e+07 flops=6.7e+08
 sigma_tot[gemm] counter=147 total t=1.2e-01 per=4.6e+01 cost=8.0e+07 flops=6.6e+08
 sigma_tot[red] counter=147 t=1.2e-01 per=4.4e+01 cost=2.0e+07 flops=1.7e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.0e-05,1.7e-06,9.8e-07,1.8e-07
    7   0 +    -116.329980164892 -1.291e-07  8.649e-05    3     7  3.323e-02 4.746e-03 4.493e-03
TIMING FOR Davidson : 3.330e-02  T(cal/comm/rest)=3.145e-02,3.030e-07,1.856e-03
decomposed t_rest=1.856e-03
 T(sub)    =1.130e-04 per=6.087e+00
 T(precond)=2.400e-04 per=1.293e+01
 T(ortho)  =9.784e-06 per=5.271e-01
 T(xcopy)  =8.740e-07 per=4.709e-02
 T(xnrm2)  =1.143e-06 per=6.158e-02
 T(other)  =1.491e-03 per=8.034e+01
optimized energies: isweep=0 ibond=23 dots=2 e[0]=-116.329980164892 nmvp=7
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:4.190e+01S Sys:1.196e+00S Total:4.309e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond23.txt
 qbond: qsuper nsym=11 dimAll=40
 (10,2):4 (11,3):9 (10,4):3 (9,3):1 (12,2):7 (13,3):4 (12,4):5 (14,2):1 (11,1):3 (11,5):2 (13,1):1
----- TMING FOR decimation_genbasis(su2): 8.0e-05 S -----
decimation summary: 40->10 dwt=+3.719e-03 SvN=1.041e+00
 qbond: qkept nsym=5 dimAll=10
 (12,2):4 (12,4):3 (11,3):1 (13,3):1 (14,2):1
----- TIMING for decimation_row(nkr): 3.305e-03 S T(decim/select/formRot)=3.732e-04,2.758e-03,1.745e-04 -----
----- TIMING FOR twodot_decimation: 3.550e-03 S T(wf/decim)=1.575e-04,3.392e-03 -----
ctns::oper_renorm coord=(12,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:8 S:12 H:1 A:64 B:72 
        dim(bra,ket)=10,10 size(op)=52:3.967e-04MB size(tot)=3612:2.756e-02MB:2.691e-05GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:4.211e+01S Sys:1.196e+00S Total:4.330e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=157 : 4.696e-04 S -----
rank=0 GPUmem(GB): used=9.67e-05 (oper)=5.3e-05
rank=0 GPUmem(GB): used=9.72e-05 (oper,site)(GB)=5.3e-05,4.25e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=157
 no. of rintermediate operators=113
 no. of coefficients=2324:0.0177MB:1.73e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.367e-04 S -----
rank=0 GPUmem(GB): used=0.000114 (oper,site,rinter)=5.3e-05,4.25e-07,1.73e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00207 S size(rtasks)=157 size(Rlst2)=25 T(Rmu/Rlist)=0.000101,0.00197 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00223 S size(rtasks)=157 size(Rlst)=2612 -----
rank=0 GPUmem(GB): used=0.000114 (oper,site,rinter,batch)=5.3e-05,4.25e-07,1.73e-05,0.000817 blksize=16 blksize0=9 batchsize=2612
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000212,0.000788,0.000288
--- TIMING FOR renorm : t_inter=2.1e-04 t_gemm=7.9e-04 t_reduction=2.9e-04 tot=1.3e-03 ---
 renorm[inter] counter=24 t=2.1e-04 per=1.6e+01 cost=2.1e+05 flops=1.0e+09
 renorm[gemm] counter=24 i=0 t=2.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=1 t=2.3e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=2 t=2.4e-04 per=1.9e+01 cost=2.1e+04 flops=8.9e+07
 renorm[gemm] counter=24 i=3 t=2.7e-04 per=2.1e+01 cost=4.3e+04 flops=1.6e+08
 renorm[gemm] counter=24 i=4 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=5 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=24 i=6 t=2.7e-04 per=2.1e+01 cost=5.9e+04 flops=2.2e+08
 renorm[gemm] counter=24 total t=7.9e-04 per=6.1e+01 cost=1.2e+05 flops=1.6e+08
 renorm[red] counter=24 t=2.9e-04 per=2.2e+01 cost=2.4e+04 flops=8.4e+07
--- TIMING FOR renorm_tot : t_inter=3.4e-03 t_gemm=1.7e-02 t_reduction=6.2e-03 tot=2.6e-02 ---
 renorm_tot[inter] counter=24 t=3.4e-03 per=1.3e+01 cost=2.1e+06 flops=6.3e+08
 renorm_tot[gemm] counter=24 i=0 t=6.8e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=24 i=1 t=5.5e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=24 i=2 t=1.7e-03 per=6.6e+00 cost=1.1e+05 flops=6.3e+07
 renorm_tot[gemm] counter=24 i=3 t=1.9e-03 per=7.1e+00 cost=1.5e+05 flops=8.3e+07
 renorm_tot[gemm] counter=24 i=4 t=3.6e-03 per=1.4e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=24 i=5 t=3.6e-03 per=1.4e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=24 i=6 t=5.6e-03 per=2.1e+01 cost=1.2e+06 flops=2.2e+08
 renorm_tot[gemm] counter=24 total t=1.7e-02 per=6.3e+01 cost=2.2e+06 flops=1.3e+08
 renorm_tot[red] counter=24 t=6.2e-03 per=2.4e+01 cost=5.5e+05 flops=8.9e+07
qops.to_cpu: size(tot)=3612:2.8e-02MB:2.7e-05GB t[to_cpu]=2.0e-05S speed=1.3e+00GB/S
check ||H-H.dagger||=8.974e-15 coord=(12,0) rank=0
ctns::oper_ab2pq coord=(12,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00827 S rank=0 -----
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:4.219e+01S Sys:1.196e+00S Total:4.338e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=771:5.882e-03MB:5.744e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=51:3.891e-04MB:3.800e-07GB
total mem of comb=823:6.279e-03MB:6.132e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:4.219e+01S Sys:1.196e+00S Total:4.338e+01S
##### local opt: 1.084e-01 S #####
 T(local opt: fetch) = 7.052e-03 S  per =  6.5  per(accum) = 6.5
 T(local opt: hdiag) = 8.290e-03 S  per = 7.65  per(accum) = 14.2
 T(local opt: dvdsn) = 7.562e-02 S  per = 69.7  per(accum) = 83.9
 T(local opt: decim) = 3.641e-03 S  per = 3.36  per(accum) = 87.2
 T(local opt: guess) = 1.064e-04 S  per = 0.0982  per(accum) = 87.3
 T(local opt: renrm) = 9.217e-03 S  per =  8.5  per(accum) = 95.8
 T(local opt: save ) = 4.506e-03 S  per = 4.16  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.562e-02 S  T(sum) = 7.465e-02 S  per = 9.873e+01
 T(local opt: preprocess                  ) = 6.779e-04 S  per = 0.908  per(accum) = 0.908
 T(local opt: symbolic_formulae           ) = 1.442e-03 S  per = 1.93  per(accum) = 2.84
 T(local opt: hintermediate init          ) = 6.276e-04 S  per = 0.841  per(accum) = 3.68
 T(local opt: preprocess_hformulae_Hxlist ) = 3.287e-02 S  per =   44  per(accum) = 47.7
 T(local opt: hmmtasks init               ) = 5.442e-03 S  per = 7.29  per(accum) = 55
 T(local opt: initial guess for dvdson    ) = 2.895e-04 S  per = 0.388  per(accum) = 55.4
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.125e-02 S  per = 41.9  per(accum) = 97.3
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.948e-04 S  per = 0.261  per(accum) = 97.5
 T(local opt: dvdson solver [comm(cpu)]   ) = 3.030e-07 S  per = 0.000406  per(accum) = 97.5
 T(local opt: dvdson solver [rest part]   ) = 1.856e-03 S  per = 2.49  per(accum) = 100
Detailed decomposition of T(renrm) = 9.217e-03 S  T(sum) = 9.217e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.168e-04 S  per = 1.27  per(accum) = 1.27
 T(local opt: qops init                    ) = 5.928e-04 S  per = 6.43  per(accum) = 7.7
 T(local opt: symbolic_formulae_renorm     ) = 5.596e-04 S  per = 6.07  per(accum) = 13.8
 T(local opt: allocate qops on gpu         ) = 1.061e-04 S  per = 1.15  per(accum) = 14.9
 T(local opt: site memcpy cpu2gpu          ) = 9.441e-05 S  per = 1.02  per(accum) = 15.9
 T(local opt: rintermediate init           ) = 4.935e-04 S  per = 5.35  per(accum) = 21.3
 T(local opt: preprocess_formulae_Rlist2   ) = 2.318e-03 S  per = 25.2  per(accum) = 46.5
 T(local opt: rmmtasks init                ) = 7.665e-04 S  per = 8.32  per(accum) = 54.8
 T(local opt: qops memset on cpu           ) = 5.200e-08 S  per = 0.000564  per(accum) = 54.8
 T(local opt: preprocess_renorm_batchGPU   ) = 3.131e-03 S  per =   34  per(accum) = 88.7
 T(local opt: reduction of opS & opH [nccl]) = 5.600e-07 S  per = 0.00608  per(accum) = 88.8
 T(local opt: qops memcpy gpu2cpu          ) = 1.036e-04 S  per = 1.12  per(accum) = 89.9
 T(local opt: deallocate cpu and gpu memory) = 9.889e-06 S  per = 0.107  per(accum) = 90
 T(local opt: reduction of opS & opH [comm]) = 9.117e-05 S  per = 0.989  per(accum) = 91
 T(local opt: conversion from opAB to opPQ ) = 8.349e-05 S  per = 0.906  per(accum) = 91.9
 T(local opt: after oper_renorm            ) = 7.484e-04 S  per = 8.12  per(accum) = 100
##### sweep opt: 1.978e+00 S #####
 T(sweep opt: fetch) = 1.552e-01 S  per = 7.85  per(accum) = 7.85
 T(sweep opt: hdiag) = 1.181e-01 S  per = 5.97  per(accum) = 13.8
 T(sweep opt: dvdsn) = 1.300e+00 S  per = 65.7  per(accum) = 79.6
 T(sweep opt: decim) = 8.944e-02 S  per = 4.52  per(accum) = 84.1
 T(sweep opt: guess) = 2.866e-03 S  per = 0.145  per(accum) = 84.2
 T(sweep opt: renrm) = 2.049e-01 S  per = 10.4  per(accum) = 94.6
 T(sweep opt: save ) = 1.074e-01 S  per = 5.43  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.300e+00 S  T(sum) = 1.279e+00 S  per = 9.836e+01
 T(sweep opt: preprocess                  ) = 1.524e-02 S  per = 1.19  per(accum) = 1.19
 T(sweep opt: symbolic_formulae           ) = 2.417e-02 S  per = 1.89  per(accum) = 3.08
 T(sweep opt: hintermediate init          ) = 1.395e-02 S  per = 1.09  per(accum) = 4.17
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.212e-01 S  per = 40.7  per(accum) = 44.9
 T(sweep opt: hmmtasks init               ) = 8.866e-02 S  per = 6.93  per(accum) = 51.9
 T(sweep opt: initial guess for dvdson    ) = 5.815e-03 S  per = 0.455  per(accum) = 52.3
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 5.637e-01 S  per = 44.1  per(accum) = 96.4
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.208e-03 S  per = 0.329  per(accum) = 96.7
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 6.756e-06 S  per = 0.000528  per(accum) = 96.7
 T(sweep opt: dvdson solver [rest part]   ) = 4.204e-02 S  per = 3.29  per(accum) = 100
Detailed decomposition of T(renrm) = 2.049e-01 S  T(sum) = 2.049e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.895e-03 S  per = 1.41  per(accum) = 1.41
 T(sweep opt: qops init                    ) = 1.104e-02 S  per = 5.39  per(accum) = 6.8
 T(sweep opt: symbolic_formulae_renorm     ) = 1.095e-02 S  per = 5.34  per(accum) = 12.1
 T(sweep opt: allocate qops on gpu         ) = 2.274e-03 S  per = 1.11  per(accum) = 13.3
 T(sweep opt: site memcpy cpu2gpu          ) = 2.152e-03 S  per = 1.05  per(accum) = 14.3
 T(sweep opt: rintermediate init           ) = 1.135e-02 S  per = 5.54  per(accum) = 19.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.901e-02 S  per = 23.9  per(accum) = 43.8
 T(sweep opt: rmmtasks init                ) = 1.602e-02 S  per = 7.82  per(accum) = 51.6
 T(sweep opt: qops memset on cpu           ) = 1.184e-06 S  per = 0.000578  per(accum) = 51.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.913e-02 S  per = 33.7  per(accum) = 85.3
 T(sweep opt: reduction of opS & opH [nccl]) = 1.421e-05 S  per = 0.00694  per(accum) = 85.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.468e-03 S  per =  1.2  per(accum) = 86.6
 T(sweep opt: deallocate cpu and gpu memory) = 3.834e-04 S  per = 0.187  per(accum) = 86.7
 T(sweep opt: reduction of opS & opH [comm]) = 2.124e-03 S  per = 1.04  per(accum) = 87.8
 T(sweep opt: conversion from opAB to opPQ ) = 7.792e-03 S  per =  3.8  per(accum) = 91.6
 T(sweep opt: after oper_renorm            ) = 1.725e-02 S  per = 8.42  per(accum) = 100
##### global opt: 1.978e+00 S #####
 T(global opt: fetch) = 1.552e-01 S  per = 7.85  per(accum) = 7.85
 T(global opt: hdiag) = 1.181e-01 S  per = 5.97  per(accum) = 13.8
 T(global opt: dvdsn) = 1.300e+00 S  per = 65.7  per(accum) = 79.6
 T(global opt: decim) = 8.944e-02 S  per = 4.52  per(accum) = 84.1
 T(global opt: guess) = 2.866e-03 S  per = 0.145  per(accum) = 84.2
 T(global opt: renrm) = 2.049e-01 S  per = 10.4  per(accum) = 94.6
 T(global opt: save ) = 1.074e-01 S  per = 5.43  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.300e+00 S  T(sum) = 1.279e+00 S  per = 9.836e+01
 T(global opt: preprocess                  ) = 1.524e-02 S  per = 1.19  per(accum) = 1.19
 T(global opt: symbolic_formulae           ) = 2.417e-02 S  per = 1.89  per(accum) = 3.08
 T(global opt: hintermediate init          ) = 1.395e-02 S  per = 1.09  per(accum) = 4.17
 T(global opt: preprocess_hformulae_Hxlist ) = 5.212e-01 S  per = 40.7  per(accum) = 44.9
 T(global opt: hmmtasks init               ) = 8.866e-02 S  per = 6.93  per(accum) = 51.9
 T(global opt: initial guess for dvdson    ) = 5.815e-03 S  per = 0.455  per(accum) = 52.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 5.637e-01 S  per = 44.1  per(accum) = 96.4
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.208e-03 S  per = 0.329  per(accum) = 96.7
 T(global opt: dvdson solver [comm(cpu)]   ) = 6.756e-06 S  per = 0.000528  per(accum) = 96.7
 T(global opt: dvdson solver [rest part]   ) = 4.204e-02 S  per = 3.29  per(accum) = 100
Detailed decomposition of T(renrm) = 2.049e-01 S  T(sum) = 2.049e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.895e-03 S  per = 1.41  per(accum) = 1.41
 T(global opt: qops init                    ) = 1.104e-02 S  per = 5.39  per(accum) = 6.8
 T(global opt: symbolic_formulae_renorm     ) = 1.095e-02 S  per = 5.34  per(accum) = 12.1
 T(global opt: allocate qops on gpu         ) = 2.274e-03 S  per = 1.11  per(accum) = 13.3
 T(global opt: site memcpy cpu2gpu          ) = 2.152e-03 S  per = 1.05  per(accum) = 14.3
 T(global opt: rintermediate init           ) = 1.135e-02 S  per = 5.54  per(accum) = 19.8
 T(global opt: preprocess_formulae_Rlist2   ) = 4.901e-02 S  per = 23.9  per(accum) = 43.8
 T(global opt: rmmtasks init                ) = 1.602e-02 S  per = 7.82  per(accum) = 51.6
 T(global opt: qops memset on cpu           ) = 1.184e-06 S  per = 0.000578  per(accum) = 51.6
 T(global opt: preprocess_renorm_batchGPU   ) = 6.913e-02 S  per = 33.7  per(accum) = 85.3
 T(global opt: reduction of opS & opH [nccl]) = 1.421e-05 S  per = 0.00694  per(accum) = 85.3
 T(global opt: qops memcpy gpu2cpu          ) = 2.468e-03 S  per =  1.2  per(accum) = 86.6
 T(global opt: deallocate cpu and gpu memory) = 3.834e-04 S  per = 0.187  per(accum) = 86.7
 T(global opt: reduction of opS & opH [comm]) = 2.124e-03 S  per = 1.04  per(accum) = 87.8
 T(global opt: conversion from opAB to opPQ ) = 7.792e-03 S  per =  3.8  per(accum) = 91.6
 T(global opt: after oper_renorm            ) = 1.725e-02 S  per = 8.42  per(accum) = 100

isweep=0 ibond=24/seqsize=34 dots=2 dbond=(10,0)-(11,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:4.219e+01S Sys:1.196e+00S Total:4.339e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=771:5.882e-03MB:5.744e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=51:3.891e-04MB:3.800e-07GB
total mem of comb=823:6.279e-03MB:6.132e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=10,8,1,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc1= 6
 suppc2= 7
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:10 S:10 H:1 P:100 Q:110 
        dim(bra,ket)=10,10 size(op)=60:4.578e-04MB size(tot)=5088:3.882e-02MB:3.791e-05GB
 rqops: oplist=CSHAB nops=C:8 S:12 H:1 A:64 B:72 
        dim(bra,ket)=10,10 size(op)=52:3.967e-04MB size(tot)=3612:2.756e-02MB:2.691e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=10696:8.160e-02MB:7.969e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(11,0) fdel=./scratch/sweep/lop(10,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=130:9.918e-04MB
qtensor4: wf4 own=1 _data=0x55a31eadc2b0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (15,1):4 (15,3):3 (14,2):1 (14,4):1 (15,5):1
 qbond: qcol nsym=5 dimAll=10
 (12,2):4 (12,4):3 (11,3):1 (13,3):1 (14,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=30 nblocks=400 size=130:9.918e-04MB
### DIAG TIMING: total=1.038e-02 t1=8.507e-06, t2=1.583e-05, t3=1.814e-05, t4=1.031e-02, t5=4.323e-06, t6=1.753e-05, t7=4.077e-06
duration_diagGPU:1.049e-02
duration_diagreduce:2.700e-08
duration_diagtransform:2.940e-07
----- TIMING FOR symbolic_formulae_twodot with size=837 : 1.541e-03 S -----
rank=0 GPUmem(GB): used=7.97e-05 (oper)=7.97e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=837
 no. of hintermediate operators=392
 no. of coefficients=5612:0.0428MB:4.18e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.839e-04 S -----
rank=0 GPUmem(GB): used=0.000122 (oper,hinter)=7.97e-05,4.18e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0457 S size(H_formulae)=837 size(Hxlst2)=30 T(Hmu/Hxlist)=0.000308,0.0454 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0465 S size(H_formulae)=837 size(Hxlst)=28214 -----
rank=0 GPUmem(GB): used=0.0104 (oper,hinter,dvdson,batch)=7.97e-05,4.18e-05,1.94e-06,0.0103 blksize=16 blksize0=16 batchsize=28214
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=130 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.39e-05,0.000301,0.00138,0.00104,0.00276
 ndim=130:9.69e-07GB t[comm(intra)]=2.67e-05 speed=0.0726GB/S t[comm(inter)]=7.25e-06 speed=0.267GB/S
--- TIMING FOR sigma : t_inter=3.0e-04 t_gemm=1.4e-03 t_reduction=1.0e-03 tot=2.7e-03 ---
 sigma[inter] counter=148 t=3.0e-04 per=1.1e+01 cost=1.2e+06 flops=3.9e+09
 sigma[gemm] counter=148 i=0 t=2.8e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=1 t=2.2e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=2 t=2.2e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=3 t=2.2e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=4 t=3.7e-04 per=1.4e+01 cost=2.5e+05 flops=6.8e+08
 sigma[gemm] counter=148 i=5 t=3.7e-04 per=1.4e+01 cost=2.7e+05 flops=7.4e+08
 sigma[gemm] counter=148 i=6 t=3.1e-04 per=1.2e+01 cost=1.9e+05 flops=5.9e+08
 sigma[gemm] counter=148 i=7 t=3.2e-04 per=1.2e+01 cost=2.2e+05 flops=6.8e+08
 sigma[gemm] counter=148 total t=1.4e-03 per=5.1e+01 cost=9.3e+05 flops=6.7e+08
 sigma[red] counter=148 t=1.0e-03 per=3.8e+01 cost=2.4e+05 flops=2.3e+08
--- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=1.2e-01 t_reduction=1.2e-01 tot=2.7e-01 ---
 sigma_tot[inter] counter=148 t=2.6e-02 per=9.7e+00 cost=1.1e+08 flops=4.3e+09
 sigma_tot[gemm] counter=148 i=0 t=3.8e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=1 t=3.3e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=2 t=3.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=3 t=3.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=4 t=2.9e-02 per=1.1e+01 cost=2.1e+07 flops=7.2e+08
 sigma_tot[gemm] counter=148 i=5 t=3.2e-02 per=1.2e+01 cost=2.1e+07 flops=6.5e+08
 sigma_tot[gemm] counter=148 i=6 t=3.1e-02 per=1.2e+01 cost=1.9e+07 flops=6.2e+08
 sigma_tot[gemm] counter=148 i=7 t=3.0e-02 per=1.1e+01 cost=2.0e+07 flops=6.7e+08
 sigma_tot[gemm] counter=148 total t=1.2e-01 per=4.6e+01 cost=8.1e+07 flops=6.6e+08
 sigma_tot[red] counter=148 t=1.2e-01 per=4.4e+01 cost=2.0e+07 flops=1.7e+08
T(sub)=8.4e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,3.3e-06,9.5e-07,9.6e-07,2.7e-07
settings: ndim=130 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.328558693349 -1.116e+03  3.333e-02    1     1  5.146e-03 5.146e-03 4.968e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.950e-05,2.364e-04,1.070e-03,9.718e-04,2.313e-03
 ndim=130:9.686e-07GB t[comm(intra)]=2.389e-05 speed=8.108e-02GB/S t[comm(inter)]=5.604e-06 speed=3.457e-01GB/S
--- TIMING FOR sigma : t_inter=2.4e-04 t_gemm=1.1e-03 t_reduction=9.7e-04 tot=2.3e-03 ---
 sigma[inter] counter=149 t=2.4e-04 per=1.0e+01 cost=1.2e+06 flops=5.0e+09
 sigma[gemm] counter=149 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=1 t=2.2e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=2 t=2.2e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=3 t=2.2e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=4 t=2.7e-04 per=1.2e+01 cost=2.5e+05 flops=9.3e+08
 sigma[gemm] counter=149 i=5 t=2.8e-04 per=1.2e+01 cost=2.7e+05 flops=9.7e+08
 sigma[gemm] counter=149 i=6 t=2.6e-04 per=1.1e+01 cost=1.9e+05 flops=7.2e+08
 sigma[gemm] counter=149 i=7 t=2.5e-04 per=1.1e+01 cost=2.2e+05 flops=8.7e+08
 sigma[gemm] counter=149 total t=1.1e-03 per=4.7e+01 cost=9.3e+05 flops=8.7e+08
 sigma[red] counter=149 t=9.7e-04 per=4.3e+01 cost=2.4e+05 flops=2.5e+08
--- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=1.2e-01 t_reduction=1.2e-01 tot=2.7e-01 ---
 sigma_tot[inter] counter=149 t=2.6e-02 per=9.8e+00 cost=1.1e+08 flops=4.3e+09
 sigma_tot[gemm] counter=149 i=0 t=3.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=1 t=3.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=2 t=3.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=3 t=3.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=4 t=2.9e-02 per=1.1e+01 cost=2.1e+07 flops=7.2e+08
 sigma_tot[gemm] counter=149 i=5 t=3.2e-02 per=1.2e+01 cost=2.1e+07 flops=6.6e+08
 sigma_tot[gemm] counter=149 i=6 t=3.1e-02 per=1.2e+01 cost=1.9e+07 flops=6.2e+08
 sigma_tot[gemm] counter=149 i=7 t=3.0e-02 per=1.1e+01 cost=2.0e+07 flops=6.7e+08
 sigma_tot[gemm] counter=149 total t=1.2e-01 per=4.6e+01 cost=8.2e+07 flops=6.6e+08
 sigma_tot[red] counter=149 t=1.2e-01 per=4.4e+01 cost=2.0e+07 flops=1.7e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.0e-05,2.3e-06,1.2e-06,2.4e-07
    2   0 -    -116.330776748166 -2.218e-03  8.955e-03    2     2  1.001e-02 5.003e-03 4.670e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.838e-05,2.462e-04,1.090e-03,9.737e-04,2.343e-03
 ndim=130:9.686e-07GB t[comm(intra)]=2.269e-05 speed=8.537e-02GB/S t[comm(inter)]=5.687e-06 speed=3.406e-01GB/S
--- TIMING FOR sigma : t_inter=2.5e-04 t_gemm=1.1e-03 t_reduction=9.7e-04 tot=2.3e-03 ---
 sigma[inter] counter=150 t=2.5e-04 per=1.1e+01 cost=1.2e+06 flops=4.8e+09
 sigma[gemm] counter=150 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=1 t=3.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=2 t=3.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=3 t=3.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=4 t=2.7e-04 per=1.2e+01 cost=2.5e+05 flops=9.2e+08
 sigma[gemm] counter=150 i=5 t=3.0e-04 per=1.3e+01 cost=2.7e+05 flops=9.2e+08
 sigma[gemm] counter=150 i=6 t=2.6e-04 per=1.1e+01 cost=1.9e+05 flops=7.2e+08
 sigma[gemm] counter=150 i=7 t=2.5e-04 per=1.1e+01 cost=2.2e+05 flops=8.7e+08
 sigma[gemm] counter=150 total t=1.1e-03 per=4.7e+01 cost=9.3e+05 flops=8.5e+08
 sigma[red] counter=150 t=9.7e-04 per=4.2e+01 cost=2.4e+05 flops=2.5e+08
--- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.7e-01 ---
 sigma_tot[inter] counter=150 t=2.6e-02 per=9.8e+00 cost=1.1e+08 flops=4.3e+09
 sigma_tot[gemm] counter=150 i=0 t=3.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=1 t=3.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=2 t=3.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=3 t=3.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=4 t=3.0e-02 per=1.1e+01 cost=2.1e+07 flops=7.2e+08
 sigma_tot[gemm] counter=150 i=5 t=3.2e-02 per=1.2e+01 cost=2.1e+07 flops=6.6e+08
 sigma_tot[gemm] counter=150 i=6 t=3.1e-02 per=1.2e+01 cost=2.0e+07 flops=6.2e+08
 sigma_tot[gemm] counter=150 i=7 t=3.1e-02 per=1.1e+01 cost=2.1e+07 flops=6.8e+08
 sigma_tot[gemm] counter=150 total t=1.3e-01 per=4.6e+01 cost=8.3e+07 flops=6.6e+08
 sigma_tot[red] counter=150 t=1.2e-01 per=4.4e+01 cost=2.1e+07 flops=1.7e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.3e-05,1.9e-06,1.1e-06,2.6e-07
    3   0 -    -116.330990410498 -2.137e-04  2.929e-03    3     3  1.467e-02 4.889e-03 4.583e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.757e-05,2.318e-04,1.048e-03,9.746e-04,2.287e-03
 ndim=130:9.686e-07GB t[comm(intra)]=2.195e-05 speed=8.824e-02GB/S t[comm(inter)]=5.621e-06 speed=3.446e-01GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=1.0e-03 t_reduction=9.7e-04 tot=2.3e-03 ---
 sigma[inter] counter=151 t=2.3e-04 per=1.0e+01 cost=1.2e+06 flops=5.1e+09
 sigma[gemm] counter=151 i=0 t=2.8e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=1 t=2.2e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=2 t=2.2e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=3 t=2.2e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=4 t=2.7e-04 per=1.2e+01 cost=2.5e+05 flops=9.3e+08
 sigma[gemm] counter=151 i=5 t=2.7e-04 per=1.2e+01 cost=2.7e+05 flops=1.0e+09
 sigma[gemm] counter=151 i=6 t=2.5e-04 per=1.1e+01 cost=1.9e+05 flops=7.5e+08
 sigma[gemm] counter=151 i=7 t=2.5e-04 per=1.1e+01 cost=2.2e+05 flops=8.8e+08
 sigma[gemm] counter=151 total t=1.0e-03 per=4.6e+01 cost=9.3e+05 flops=8.9e+08
 sigma[red] counter=151 t=9.7e-04 per=4.3e+01 cost=2.4e+05 flops=2.5e+08
--- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.7e-01 ---
 sigma_tot[inter] counter=151 t=2.7e-02 per=9.8e+00 cost=1.1e+08 flops=4.3e+09
 sigma_tot[gemm] counter=151 i=0 t=3.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=1 t=3.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=2 t=3.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=3 t=3.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=4 t=3.0e-02 per=1.1e+01 cost=2.2e+07 flops=7.2e+08
 sigma_tot[gemm] counter=151 i=5 t=3.3e-02 per=1.2e+01 cost=2.2e+07 flops=6.6e+08
 sigma_tot[gemm] counter=151 i=6 t=3.2e-02 per=1.2e+01 cost=2.0e+07 flops=6.3e+08
 sigma_tot[gemm] counter=151 i=7 t=3.1e-02 per=1.1e+01 cost=2.1e+07 flops=6.8e+08
 sigma_tot[gemm] counter=151 total t=1.3e-01 per=4.6e+01 cost=8.4e+07 flops=6.6e+08
 sigma_tot[red] counter=151 t=1.2e-01 per=4.4e+01 cost=2.1e+07 flops=1.7e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.1e-05,1.6e-06,1.1e-06,1.9e-07
    4   0 -    -116.331013186422 -2.278e-05  1.108e-03    3     4  1.919e-02 4.797e-03 4.507e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.802e-05,2.313e-04,1.047e-03,9.704e-04,2.281e-03
 ndim=130:9.686e-07GB t[comm(intra)]=2.245e-05 speed=8.630e-02GB/S t[comm(inter)]=5.573e-06 speed=3.476e-01GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=1.0e-03 t_reduction=9.7e-04 tot=2.2e-03 ---
 sigma[inter] counter=152 t=2.3e-04 per=1.0e+01 cost=1.2e+06 flops=5.1e+09
 sigma[gemm] counter=152 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=1 t=2.2e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=2 t=2.2e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=3 t=2.2e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=4 t=2.7e-04 per=1.2e+01 cost=2.5e+05 flops=9.4e+08
 sigma[gemm] counter=152 i=5 t=2.7e-04 per=1.2e+01 cost=2.7e+05 flops=1.0e+09
 sigma[gemm] counter=152 i=6 t=2.5e-04 per=1.1e+01 cost=1.9e+05 flops=7.5e+08
 sigma[gemm] counter=152 i=7 t=2.5e-04 per=1.1e+01 cost=2.2e+05 flops=8.8e+08
 sigma[gemm] counter=152 total t=1.0e-03 per=4.7e+01 cost=9.3e+05 flops=8.9e+08
 sigma[red] counter=152 t=9.7e-04 per=4.3e+01 cost=2.4e+05 flops=2.5e+08
--- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.7e-01 ---
 sigma_tot[inter] counter=152 t=2.7e-02 per=9.8e+00 cost=1.2e+08 flops=4.3e+09
 sigma_tot[gemm] counter=152 i=0 t=3.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=1 t=3.4e-04 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=2 t=3.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=3 t=3.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=4 t=3.0e-02 per=1.1e+01 cost=2.2e+07 flops=7.2e+08
 sigma_tot[gemm] counter=152 i=5 t=3.3e-02 per=1.2e+01 cost=2.2e+07 flops=6.7e+08
 sigma_tot[gemm] counter=152 i=6 t=3.2e-02 per=1.2e+01 cost=2.0e+07 flops=6.3e+08
 sigma_tot[gemm] counter=152 i=7 t=3.1e-02 per=1.1e+01 cost=2.1e+07 flops=6.8e+08
 sigma_tot[gemm] counter=152 total t=1.3e-01 per=4.6e+01 cost=8.5e+07 flops=6.7e+08
 sigma_tot[red] counter=152 t=1.2e-01 per=4.4e+01 cost=2.1e+07 flops=1.8e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.1e-05,1.7e-06,1.0e-06,1.9e-07
    5   0 -    -116.331016817102 -3.631e-06  4.098e-04    3     5  2.431e-02 4.863e-03 4.582e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.825e-05,2.459e-04,1.044e-03,9.663e-04,2.290e-03
 ndim=130:9.686e-07GB t[comm(intra)]=2.272e-05 speed=8.525e-02GB/S t[comm(inter)]=5.528e-06 speed=3.504e-01GB/S
--- TIMING FOR sigma : t_inter=2.5e-04 t_gemm=1.0e-03 t_reduction=9.7e-04 tot=2.3e-03 ---
 sigma[inter] counter=153 t=2.5e-04 per=1.1e+01 cost=1.2e+06 flops=4.8e+09
 sigma[gemm] counter=153 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=1 t=2.2e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=2 t=2.2e-06 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=3 t=2.2e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=4 t=2.7e-04 per=1.2e+01 cost=2.5e+05 flops=9.4e+08
 sigma[gemm] counter=153 i=5 t=2.7e-04 per=1.2e+01 cost=2.7e+05 flops=1.0e+09
 sigma[gemm] counter=153 i=6 t=2.5e-04 per=1.1e+01 cost=1.9e+05 flops=7.5e+08
 sigma[gemm] counter=153 i=7 t=2.5e-04 per=1.1e+01 cost=2.2e+05 flops=8.8e+08
 sigma[gemm] counter=153 total t=1.0e-03 per=4.6e+01 cost=9.3e+05 flops=8.9e+08
 sigma[red] counter=153 t=9.7e-04 per=4.3e+01 cost=2.4e+05 flops=2.5e+08
--- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.8e-01 ---
 sigma_tot[inter] counter=153 t=2.7e-02 per=9.8e+00 cost=1.2e+08 flops=4.3e+09
 sigma_tot[gemm] counter=153 i=0 t=4.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=1 t=3.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=2 t=3.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=3 t=3.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=4 t=3.1e-02 per=1.1e+01 cost=2.2e+07 flops=7.3e+08
 sigma_tot[gemm] counter=153 i=5 t=3.3e-02 per=1.2e+01 cost=2.2e+07 flops=6.7e+08
 sigma_tot[gemm] counter=153 i=6 t=3.2e-02 per=1.2e+01 cost=2.0e+07 flops=6.3e+08
 sigma_tot[gemm] counter=153 i=7 t=3.1e-02 per=1.1e+01 cost=2.1e+07 flops=6.8e+08
 sigma_tot[gemm] counter=153 total t=1.3e-01 per=4.6e+01 cost=8.6e+07 flops=6.7e+08
 sigma_tot[red] counter=153 t=1.2e-01 per=4.4e+01 cost=2.1e+07 flops=1.8e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.0e-05,1.8e-06,9.6e-07,1.4e-07
    6   0 -    -116.331017275736 -4.586e-07  1.172e-04    3     6  2.893e-02 4.822e-03 4.541e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.745e-05,2.315e-04,1.064e-03,9.840e-04,2.312e-03
 ndim=130:9.686e-07GB t[comm(intra)]=2.199e-05 speed=8.811e-02GB/S t[comm(inter)]=5.460e-06 speed=3.548e-01GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=1.1e-03 t_reduction=9.8e-04 tot=2.3e-03 ---
 sigma[inter] counter=154 t=2.3e-04 per=1.0e+01 cost=1.2e+06 flops=5.1e+09
 sigma[gemm] counter=154 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=1 t=2.2e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=2 t=2.2e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=3 t=2.2e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=4 t=2.7e-04 per=1.2e+01 cost=2.5e+05 flops=9.4e+08
 sigma[gemm] counter=154 i=5 t=2.8e-04 per=1.2e+01 cost=2.7e+05 flops=9.7e+08
 sigma[gemm] counter=154 i=6 t=2.5e-04 per=1.1e+01 cost=1.9e+05 flops=7.3e+08
 sigma[gemm] counter=154 i=7 t=2.5e-04 per=1.1e+01 cost=2.2e+05 flops=8.7e+08
 sigma[gemm] counter=154 total t=1.1e-03 per=4.7e+01 cost=9.3e+05 flops=8.7e+08
 sigma[red] counter=154 t=9.8e-04 per=4.3e+01 cost=2.4e+05 flops=2.4e+08
--- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.8e-01 ---
 sigma_tot[inter] counter=154 t=2.7e-02 per=9.8e+00 cost=1.2e+08 flops=4.3e+09
 sigma_tot[gemm] counter=154 i=0 t=4.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=1 t=3.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=2 t=3.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=3 t=3.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=4 t=3.1e-02 per=1.1e+01 cost=2.2e+07 flops=7.3e+08
 sigma_tot[gemm] counter=154 i=5 t=3.3e-02 per=1.2e+01 cost=2.2e+07 flops=6.7e+08
 sigma_tot[gemm] counter=154 i=6 t=3.2e-02 per=1.2e+01 cost=2.0e+07 flops=6.3e+08
 sigma_tot[gemm] counter=154 i=7 t=3.2e-02 per=1.1e+01 cost=2.2e+07 flops=6.8e+08
 sigma_tot[gemm] counter=154 total t=1.3e-01 per=4.6e+01 cost=8.7e+07 flops=6.7e+08
 sigma_tot[red] counter=154 t=1.2e-01 per=4.4e+01 cost=2.2e+07 flops=1.8e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.1e-05,1.7e-06,9.9e-07,1.5e-07
    7   0 +    -116.331017307255 -3.152e-08  2.668e-05    3     7  3.348e-02 4.783e-03 4.510e-03
TIMING FOR Davidson : 3.360e-02  T(cal/comm/rest)=3.157e-02,3.100e-07,2.033e-03
decomposed t_rest=2.033e-03
 T(sub)    =1.201e-04 per=5.906e+00
 T(precond)=4.170e-04 per=2.051e+01
 T(ortho)  =1.327e-05 per=6.530e-01
 T(xcopy)  =8.180e-07 per=4.024e-02
 T(xnrm2)  =1.275e-06 per=6.272e-02
 T(other)  =1.480e-03 per=7.282e+01
optimized energies: isweep=0 ibond=24 dots=2 e[0]=-116.331017307255 nmvp=7
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:4.396e+01S Sys:1.200e+00S Total:4.516e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond24.txt
 qbond: qsuper nsym=11 dimAll=40
 (12,2):5 (12,4):4 (11,3):1 (13,3):9 (14,2):6 (14,4):4 (15,3):2 (16,2):1 (13,1):4 (13,5):3 (15,1):1
----- TMING FOR decimation_genbasis(su2): 1.1e-04 S -----
decimation summary: 40->10 dwt=+3.623e-03 SvN=1.286e+00
 qbond: qkept nsym=4 dimAll=10
 (14,2):5 (14,4):3 (13,3):1 (15,3):1
----- TIMING for decimation_row(nkr): 3.342e-03 S T(decim/select/formRot)=4.313e-04,2.743e-03,1.671e-04 -----
----- TIMING FOR twodot_decimation: 3.643e-03 S T(wf/decim)=1.914e-04,3.452e-03 -----
ctns::oper_renorm coord=(11,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:9 S:11 H:1 A:81 B:90 
        dim(bra,ket)=10,10 size(op)=66:5.035e-04MB size(tot)=5027:3.835e-02MB:3.745e-05GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:4.412e+01S Sys:1.200e+00S Total:4.532e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=192 : 5.380e-04 S -----
rank=0 GPUmem(GB): used=0.000121 (oper)=7.18e-05
rank=0 GPUmem(GB): used=0.000121 (oper,site)(GB)=7.18e-05,3.95e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=192
 no. of rintermediate operators=104
 no. of coefficients=2732:0.0208MB:2.04e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.713e-04 S -----
rank=0 GPUmem(GB): used=0.000142 (oper,site,rinter)=7.18e-05,3.95e-07,2.04e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00206 S size(rtasks)=192 size(Rlst2)=16 T(Rmu/Rlist)=0.000114,0.00195 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00222 S size(rtasks)=192 size(Rlst)=2597 -----
rank=0 GPUmem(GB): used=0.000142 (oper,site,rinter,batch)=7.18e-05,3.95e-07,2.04e-05,0.0013 blksize=25 blksize0=16 batchsize=2597
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000211,0.000771,0.000267
--- TIMING FOR renorm : t_inter=2.1e-04 t_gemm=7.7e-04 t_reduction=2.7e-04 tot=1.2e-03 ---
 renorm[inter] counter=25 t=2.1e-04 per=1.7e+01 cost=1.9e+05 flops=9.1e+08
 renorm[gemm] counter=25 i=0 t=2.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=1 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=2 t=2.5e-04 per=2.0e+01 cost=1.7e+04 flops=6.7e+07
 renorm[gemm] counter=25 i=3 t=2.6e-04 per=2.1e+01 cost=4.5e+04 flops=1.7e+08
 renorm[gemm] counter=25 i=4 t=2.3e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=5 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=25 i=6 t=2.5e-04 per=2.0e+01 cost=7.1e+04 flops=2.8e+08
 renorm[gemm] counter=25 total t=7.7e-04 per=6.2e+01 cost=1.3e+05 flops=1.7e+08
 renorm[red] counter=25 t=2.7e-04 per=2.1e+01 cost=3.4e+04 flops=1.3e+08
--- TIMING FOR renorm_tot : t_inter=3.6e-03 t_gemm=1.7e-02 t_reduction=6.5e-03 tot=2.7e-02 ---
 renorm_tot[inter] counter=25 t=3.6e-03 per=1.3e+01 cost=2.3e+06 flops=6.5e+08
 renorm_tot[gemm] counter=25 i=0 t=7.1e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=25 i=1 t=5.7e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=25 i=2 t=2.0e-03 per=7.2e+00 cost=1.3e+05 flops=6.4e+07
 renorm_tot[gemm] counter=25 i=3 t=2.1e-03 per=7.7e+00 cost=2.0e+05 flops=9.4e+07
 renorm_tot[gemm] counter=25 i=4 t=3.6e-03 per=1.3e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=25 i=5 t=3.6e-03 per=1.3e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=25 i=6 t=5.8e-03 per=2.1e+01 cost=1.3e+06 flops=2.2e+08
 renorm_tot[gemm] counter=25 total t=1.7e-02 per=6.3e+01 cost=2.4e+06 flops=1.4e+08
 renorm_tot[red] counter=25 t=6.5e-03 per=2.4e+01 cost=5.8e+05 flops=9.0e+07
qops.to_cpu: size(tot)=5027:3.8e-02MB:3.7e-05GB t[to_cpu]=2.3e-05S speed=1.6e+00GB/S
check ||H-H.dagger||=6.299e-15 coord=(11,0) rank=0
ctns::oper_ab2pq coord=(11,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00849 S rank=0 -----
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:4.426e+01S Sys:1.201e+00S Total:4.546e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=768:5.859e-03MB:5.722e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=63:4.807e-04MB:4.694e-07GB
total mem of comb=832:6.348e-03MB:6.199e-06GB
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:4.426e+01S Sys:1.201e+00S Total:4.546e+01S
##### local opt: 1.288e-01 S #####
 T(local opt: fetch) = 6.586e-03 S  per = 5.11  per(accum) = 5.11
 T(local opt: hdiag) = 1.147e-02 S  per = 8.91  per(accum) = 14
 T(local opt: dvdsn) = 9.232e-02 S  per = 71.7  per(accum) = 85.7
 T(local opt: decim) = 3.728e-03 S  per = 2.89  per(accum) = 88.6
 T(local opt: guess) = 1.193e-04 S  per = 0.0926  per(accum) = 88.7
 T(local opt: renrm) = 9.397e-03 S  per =  7.3  per(accum) = 96
 T(local opt: save ) = 5.158e-03 S  per = 4.01  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.232e-02 S  T(sum) = 9.131e-02 S  per = 9.891e+01
 T(local opt: preprocess                  ) = 7.965e-04 S  per = 0.872  per(accum) = 0.872
 T(local opt: symbolic_formulae           ) = 1.652e-03 S  per = 1.81  per(accum) = 2.68
 T(local opt: hintermediate init          ) = 7.271e-04 S  per = 0.796  per(accum) = 3.48
 T(local opt: preprocess_hformulae_Hxlist ) = 4.666e-02 S  per = 51.1  per(accum) = 54.6
 T(local opt: hmmtasks init               ) = 7.592e-03 S  per = 8.31  per(accum) = 62.9
 T(local opt: initial guess for dvdson    ) = 2.831e-04 S  per = 0.31  per(accum) = 63.2
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.137e-02 S  per = 34.4  per(accum) = 97.6
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.031e-04 S  per = 0.222  per(accum) = 97.8
 T(local opt: dvdson solver [comm(cpu)]   ) = 3.100e-07 S  per = 0.000339  per(accum) = 97.8
 T(local opt: dvdson solver [rest part]   ) = 2.033e-03 S  per = 2.23  per(accum) = 100
Detailed decomposition of T(renrm) = 9.397e-03 S  T(sum) = 9.397e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.136e-04 S  per = 1.21  per(accum) = 1.21
 T(local opt: qops init                    ) = 5.464e-04 S  per = 5.81  per(accum) = 7.02
 T(local opt: symbolic_formulae_renorm     ) = 8.036e-04 S  per = 8.55  per(accum) = 15.6
 T(local opt: allocate qops on gpu         ) = 1.022e-04 S  per = 1.09  per(accum) = 16.7
 T(local opt: site memcpy cpu2gpu          ) = 9.473e-05 S  per = 1.01  per(accum) = 17.7
 T(local opt: rintermediate init           ) = 5.229e-04 S  per = 5.56  per(accum) = 23.2
 T(local opt: preprocess_formulae_Rlist2   ) = 2.308e-03 S  per = 24.6  per(accum) = 47.8
 T(local opt: rmmtasks init                ) = 7.549e-04 S  per = 8.03  per(accum) = 55.8
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 0.000458  per(accum) = 55.8
 T(local opt: preprocess_renorm_batchGPU   ) = 3.146e-03 S  per = 33.5  per(accum) = 89.3
 T(local opt: reduction of opS & opH [nccl]) = 6.200e-07 S  per = 0.0066  per(accum) = 89.3
 T(local opt: qops memcpy gpu2cpu          ) = 1.057e-04 S  per = 1.13  per(accum) = 90.4
 T(local opt: deallocate cpu and gpu memory) = 1.062e-05 S  per = 0.113  per(accum) = 90.6
 T(local opt: reduction of opS & opH [comm]) = 9.437e-05 S  per =    1  per(accum) = 91.6
 T(local opt: conversion from opAB to opPQ ) = 7.512e-05 S  per = 0.799  per(accum) = 92.4
 T(local opt: after oper_renorm            ) = 7.180e-04 S  per = 7.64  per(accum) = 100
##### sweep opt: 2.107e+00 S #####
 T(sweep opt: fetch) = 1.618e-01 S  per = 7.68  per(accum) = 7.68
 T(sweep opt: hdiag) = 1.296e-01 S  per = 6.15  per(accum) = 13.8
 T(sweep opt: dvdsn) = 1.393e+00 S  per = 66.1  per(accum) = 79.9
 T(sweep opt: decim) = 9.317e-02 S  per = 4.42  per(accum) = 84.3
 T(sweep opt: guess) = 2.985e-03 S  per = 0.142  per(accum) = 84.5
 T(sweep opt: renrm) = 2.143e-01 S  per = 10.2  per(accum) = 94.7
 T(sweep opt: save ) = 1.125e-01 S  per = 5.34  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.393e+00 S  T(sum) = 1.370e+00 S  per = 9.840e+01
 T(sweep opt: preprocess                  ) = 1.604e-02 S  per = 1.17  per(accum) = 1.17
 T(sweep opt: symbolic_formulae           ) = 2.582e-02 S  per = 1.88  per(accum) = 3.05
 T(sweep opt: hintermediate init          ) = 1.468e-02 S  per = 1.07  per(accum) = 4.13
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.678e-01 S  per = 41.4  per(accum) = 45.6
 T(sweep opt: hmmtasks init               ) = 9.626e-02 S  per = 7.02  per(accum) = 52.6
 T(sweep opt: initial guess for dvdson    ) = 6.098e-03 S  per = 0.445  per(accum) = 53
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 5.951e-01 S  per = 43.4  per(accum) = 96.5
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.411e-03 S  per = 0.322  per(accum) = 96.8
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 7.066e-06 S  per = 0.000516  per(accum) = 96.8
 T(sweep opt: dvdson solver [rest part]   ) = 4.407e-02 S  per = 3.22  per(accum) = 100
Detailed decomposition of T(renrm) = 2.143e-01 S  T(sum) = 2.143e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.009e-03 S  per =  1.4  per(accum) = 1.4
 T(sweep opt: qops init                    ) = 1.159e-02 S  per = 5.41  per(accum) = 6.81
 T(sweep opt: symbolic_formulae_renorm     ) = 1.175e-02 S  per = 5.48  per(accum) = 12.3
 T(sweep opt: allocate qops on gpu         ) = 2.376e-03 S  per = 1.11  per(accum) = 13.4
 T(sweep opt: site memcpy cpu2gpu          ) = 2.247e-03 S  per = 1.05  per(accum) = 14.5
 T(sweep opt: rintermediate init           ) = 1.188e-02 S  per = 5.54  per(accum) = 20
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.132e-02 S  per =   24  per(accum) = 43.9
 T(sweep opt: rmmtasks init                ) = 1.678e-02 S  per = 7.83  per(accum) = 51.8
 T(sweep opt: qops memset on cpu           ) = 1.227e-06 S  per = 0.000573  per(accum) = 51.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.228e-02 S  per = 33.7  per(accum) = 85.5
 T(sweep opt: reduction of opS & opH [nccl]) = 1.483e-05 S  per = 0.00692  per(accum) = 85.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.574e-03 S  per =  1.2  per(accum) = 86.7
 T(sweep opt: deallocate cpu and gpu memory) = 3.940e-04 S  per = 0.184  per(accum) = 86.9
 T(sweep opt: reduction of opS & opH [comm]) = 2.219e-03 S  per = 1.04  per(accum) = 87.9
 T(sweep opt: conversion from opAB to opPQ ) = 7.867e-03 S  per = 3.67  per(accum) = 91.6
 T(sweep opt: after oper_renorm            ) = 1.796e-02 S  per = 8.38  per(accum) = 100
##### global opt: 2.107e+00 S #####
 T(global opt: fetch) = 1.618e-01 S  per = 7.68  per(accum) = 7.68
 T(global opt: hdiag) = 1.296e-01 S  per = 6.15  per(accum) = 13.8
 T(global opt: dvdsn) = 1.393e+00 S  per = 66.1  per(accum) = 79.9
 T(global opt: decim) = 9.317e-02 S  per = 4.42  per(accum) = 84.3
 T(global opt: guess) = 2.985e-03 S  per = 0.142  per(accum) = 84.5
 T(global opt: renrm) = 2.143e-01 S  per = 10.2  per(accum) = 94.7
 T(global opt: save ) = 1.125e-01 S  per = 5.34  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.393e+00 S  T(sum) = 1.370e+00 S  per = 9.840e+01
 T(global opt: preprocess                  ) = 1.604e-02 S  per = 1.17  per(accum) = 1.17
 T(global opt: symbolic_formulae           ) = 2.582e-02 S  per = 1.88  per(accum) = 3.05
 T(global opt: hintermediate init          ) = 1.468e-02 S  per = 1.07  per(accum) = 4.13
 T(global opt: preprocess_hformulae_Hxlist ) = 5.678e-01 S  per = 41.4  per(accum) = 45.6
 T(global opt: hmmtasks init               ) = 9.626e-02 S  per = 7.02  per(accum) = 52.6
 T(global opt: initial guess for dvdson    ) = 6.098e-03 S  per = 0.445  per(accum) = 53
 T(global opt: dvdson solver [Hx_batchGPU] ) = 5.951e-01 S  per = 43.4  per(accum) = 96.5
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.411e-03 S  per = 0.322  per(accum) = 96.8
 T(global opt: dvdson solver [comm(cpu)]   ) = 7.066e-06 S  per = 0.000516  per(accum) = 96.8
 T(global opt: dvdson solver [rest part]   ) = 4.407e-02 S  per = 3.22  per(accum) = 100
Detailed decomposition of T(renrm) = 2.143e-01 S  T(sum) = 2.143e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.009e-03 S  per =  1.4  per(accum) = 1.4
 T(global opt: qops init                    ) = 1.159e-02 S  per = 5.41  per(accum) = 6.81
 T(global opt: symbolic_formulae_renorm     ) = 1.175e-02 S  per = 5.48  per(accum) = 12.3
 T(global opt: allocate qops on gpu         ) = 2.376e-03 S  per = 1.11  per(accum) = 13.4
 T(global opt: site memcpy cpu2gpu          ) = 2.247e-03 S  per = 1.05  per(accum) = 14.5
 T(global opt: rintermediate init           ) = 1.188e-02 S  per = 5.54  per(accum) = 20
 T(global opt: preprocess_formulae_Rlist2   ) = 5.132e-02 S  per =   24  per(accum) = 43.9
 T(global opt: rmmtasks init                ) = 1.678e-02 S  per = 7.83  per(accum) = 51.8
 T(global opt: qops memset on cpu           ) = 1.227e-06 S  per = 0.000573  per(accum) = 51.8
 T(global opt: preprocess_renorm_batchGPU   ) = 7.228e-02 S  per = 33.7  per(accum) = 85.5
 T(global opt: reduction of opS & opH [nccl]) = 1.483e-05 S  per = 0.00692  per(accum) = 85.5
 T(global opt: qops memcpy gpu2cpu          ) = 2.574e-03 S  per =  1.2  per(accum) = 86.7
 T(global opt: deallocate cpu and gpu memory) = 3.940e-04 S  per = 0.184  per(accum) = 86.9
 T(global opt: reduction of opS & opH [comm]) = 2.219e-03 S  per = 1.04  per(accum) = 87.9
 T(global opt: conversion from opAB to opPQ ) = 7.867e-03 S  per = 3.67  per(accum) = 91.6
 T(global opt: after oper_renorm            ) = 1.796e-02 S  per = 8.38  per(accum) = 100

isweep=0 ibond=25/seqsize=34 dots=2 dbond=(9,0)-(10,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.275e+01GB RSS:5.788e-01GB  Timing: User:4.426e+01S Sys:1.202e+00S Total:4.546e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=768:5.859e-03MB:5.722e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=63:4.807e-04MB:4.694e-07GB
total mem of comb=832:6.348e-03MB:6.199e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=9,9,1,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc1= 5
 suppc2= 6
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:9 S:11 H:1 P:121 Q:132 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=5614:4.283e-02MB:4.183e-05GB
 rqops: oplist=CSHAB nops=C:9 S:11 H:1 A:81 B:90 
        dim(bra,ket)=10,10 size(op)=66:5.035e-04MB size(tot)=5027:3.835e-02MB:3.745e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=12637:9.641e-02MB:9.415e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(10,0) fdel=./scratch/sweep/lop(9,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=176:1.343e-03MB
qtensor4: wf4 own=1 _data=0x55a31ea695d0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (14,2):4 (14,0):3 (13,1):1 (13,3):1 (14,4):1
 qbond: qcol nsym=4 dimAll=10
 (14,2):5 (14,4):3 (13,3):1 (15,3):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=31 nblocks=304 size=176:1.343e-03MB
### DIAG TIMING: total=1.327e-02 t1=8.726e-06, t2=1.610e-05, t3=1.920e-05, t4=1.320e-02, t5=5.104e-06, t6=1.838e-05, t7=3.994e-06
duration_diagGPU:1.338e-02
duration_diagreduce:4.100e-08
duration_diagtransform:3.910e-07
----- TIMING FOR symbolic_formulae_twodot with size=972 : 1.760e-03 S -----
rank=0 GPUmem(GB): used=9.42e-05 (oper)=9.42e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=972
 no. of hintermediate operators=445
 no. of coefficients=6255:0.0477MB:4.66e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.120e-04 S -----
rank=0 GPUmem(GB): used=0.000141 (oper,hinter)=9.42e-05,4.66e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0622 S size(H_formulae)=972 size(Hxlst2)=31 T(Hmu/Hxlist)=0.000364,0.0619 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0642 S size(H_formulae)=972 size(Hxlst)=38638 -----
rank=0 GPUmem(GB): used=0.0191 (oper,hinter,dvdson,batch)=9.42e-05,4.66e-05,2.62e-06,0.019 blksize=20 blksize0=25 batchsize=38638
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=176 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.66e-05,0.000294,0.00144,0.00114,0.00292
 ndim=176:1.31e-06GB t[comm(intra)]=2.8e-05 speed=0.0935GB/S t[comm(inter)]=8.53e-06 speed=0.307GB/S
--- TIMING FOR sigma : t_inter=2.9e-04 t_gemm=1.4e-03 t_reduction=1.1e-03 tot=2.9e-03 ---
 sigma[inter] counter=155 t=2.9e-04 per=1.0e+01 cost=3.0e+06 flops=1.0e+10
 sigma[gemm] counter=155 i=0 t=2.8e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=1 t=2.2e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=2 t=2.2e-06 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=3 t=2.2e-06 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=4 t=3.7e-04 per=1.3e+01 cost=7.7e+05 flops=2.1e+09
 sigma[gemm] counter=155 i=5 t=4.1e-04 per=1.4e+01 cost=7.9e+05 flops=1.9e+09
 sigma[gemm] counter=155 i=6 t=3.2e-04 per=1.1e+01 cost=3.7e+05 flops=1.2e+09
 sigma[gemm] counter=155 i=7 t=3.3e-04 per=1.1e+01 cost=3.8e+05 flops=1.2e+09
 sigma[gemm] counter=155 total t=1.4e-03 per=5.0e+01 cost=2.3e+06 flops=1.6e+09
 sigma[red] counter=155 t=1.1e-03 per=4.0e+01 cost=4.7e+05 flops=4.1e+08
--- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.8e-01 ---
 sigma_tot[inter] counter=155 t=2.8e-02 per=9.8e+00 cost=1.2e+08 flops=4.4e+09
 sigma_tot[gemm] counter=155 i=0 t=4.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=1 t=3.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=2 t=3.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=3 t=3.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=4 t=3.1e-02 per=1.1e+01 cost=2.3e+07 flops=7.4e+08
 sigma_tot[gemm] counter=155 i=5 t=3.4e-02 per=1.2e+01 cost=2.3e+07 flops=6.9e+08
 sigma_tot[gemm] counter=155 i=6 t=3.3e-02 per=1.2e+01 cost=2.1e+07 flops=6.3e+08
 sigma_tot[gemm] counter=155 i=7 t=3.2e-02 per=1.1e+01 cost=2.2e+07 flops=6.9e+08
 sigma_tot[gemm] counter=155 total t=1.3e-01 per=4.6e+01 cost=8.9e+07 flops=6.8e+08
 sigma_tot[red] counter=155 t=1.2e-01 per=4.4e+01 cost=2.2e+07 flops=1.8e+08
T(sub)=8.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,3.3e-06,1.0e-06,1.0e-06,2.4e-07
settings: ndim=176 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.329089711429 -1.116e+03  3.540e-02    1     1  5.686e-03 5.686e-03 5.476e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=4.080e-05,2.236e-04,1.119e-03,1.060e-03,2.449e-03
 ndim=176:1.311e-06GB t[comm(intra)]=3.491e-05 speed=7.513e-02GB/S t[comm(inter)]=5.893e-06 speed=4.450e-01GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=1.1e-03 t_reduction=1.1e-03 tot=2.4e-03 ---
 sigma[inter] counter=156 t=2.2e-04 per=9.3e+00 cost=3.0e+06 flops=1.3e+10
 sigma[gemm] counter=156 i=0 t=2.8e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=1 t=2.3e-06 per=9.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=2 t=2.3e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=3 t=2.3e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=4 t=2.8e-04 per=1.2e+01 cost=7.7e+05 flops=2.7e+09
 sigma[gemm] counter=156 i=5 t=3.2e-04 per=1.3e+01 cost=7.9e+05 flops=2.5e+09
 sigma[gemm] counter=156 i=6 t=2.5e-04 per=1.1e+01 cost=3.7e+05 flops=1.5e+09
 sigma[gemm] counter=156 i=7 t=2.6e-04 per=1.1e+01 cost=3.8e+05 flops=1.5e+09
 sigma[gemm] counter=156 total t=1.1e-03 per=4.7e+01 cost=2.3e+06 flops=2.1e+09
 sigma[red] counter=156 t=1.1e-03 per=4.4e+01 cost=4.7e+05 flops=4.4e+08
--- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=1.3e-01 t_reduction=1.2e-01 tot=2.8e-01 ---
 sigma_tot[inter] counter=156 t=2.8e-02 per=9.8e+00 cost=1.2e+08 flops=4.4e+09
 sigma_tot[gemm] counter=156 i=0 t=4.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=1 t=3.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=2 t=3.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=3 t=3.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=4 t=3.1e-02 per=1.1e+01 cost=2.4e+07 flops=7.6e+08
 sigma_tot[gemm] counter=156 i=5 t=3.4e-02 per=1.2e+01 cost=2.4e+07 flops=7.0e+08
 sigma_tot[gemm] counter=156 i=6 t=3.3e-02 per=1.2e+01 cost=2.1e+07 flops=6.4e+08
 sigma_tot[gemm] counter=156 i=7 t=3.2e-02 per=1.1e+01 cost=2.2e+07 flops=6.9e+08
 sigma_tot[gemm] counter=156 total t=1.3e-01 per=4.6e+01 cost=9.1e+07 flops=6.9e+08
 sigma_tot[red] counter=156 t=1.2e-01 per=4.4e+01 cost=2.2e+07 flops=1.8e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=5.9e-06,1.1e-05,2.4e-06,1.2e-06,2.0e-07
    2   0 -    -116.332238333927 -3.149e-03  9.601e-03    2     2  1.107e-02 5.537e-03 5.141e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.893e-05,2.231e-04,1.100e-03,1.056e-03,2.413e-03
 ndim=176:1.311e-06GB t[comm(intra)]=2.284e-05 speed=1.149e-01GB/S t[comm(inter)]=6.094e-06 speed=4.304e-01GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=1.1e-03 t_reduction=1.1e-03 tot=2.4e-03 ---
 sigma[inter] counter=157 t=2.2e-04 per=9.4e+00 cost=3.0e+06 flops=1.3e+10
 sigma[gemm] counter=157 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=1 t=2.2e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=2 t=2.2e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=3 t=2.2e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=4 t=2.8e-04 per=1.2e+01 cost=7.7e+05 flops=2.8e+09
 sigma[gemm] counter=157 i=5 t=3.1e-04 per=1.3e+01 cost=7.9e+05 flops=2.5e+09
 sigma[gemm] counter=157 i=6 t=2.5e-04 per=1.0e+01 cost=3.7e+05 flops=1.5e+09
 sigma[gemm] counter=157 i=7 t=2.5e-04 per=1.1e+01 cost=3.8e+05 flops=1.5e+09
 sigma[gemm] counter=157 total t=1.1e-03 per=4.6e+01 cost=2.3e+06 flops=2.1e+09
 sigma[red] counter=157 t=1.1e-03 per=4.4e+01 cost=4.7e+05 flops=4.4e+08
--- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=1.3e-01 t_reduction=1.3e-01 tot=2.9e-01 ---
 sigma_tot[inter] counter=157 t=2.8e-02 per=9.8e+00 cost=1.3e+08 flops=4.5e+09
 sigma_tot[gemm] counter=157 i=0 t=4.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=1 t=3.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=2 t=3.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=3 t=3.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=4 t=3.2e-02 per=1.1e+01 cost=2.5e+07 flops=7.8e+08
 sigma_tot[gemm] counter=157 i=5 t=3.4e-02 per=1.2e+01 cost=2.5e+07 flops=7.2e+08
 sigma_tot[gemm] counter=157 i=6 t=3.3e-02 per=1.2e+01 cost=2.1e+07 flops=6.5e+08
 sigma_tot[gemm] counter=157 i=7 t=3.3e-02 per=1.1e+01 cost=2.3e+07 flops=7.0e+08
 sigma_tot[gemm] counter=157 total t=1.3e-01 per=4.6e+01 cost=9.4e+07 flops=7.0e+08
 sigma_tot[red] counter=157 t=1.3e-01 per=4.4e+01 cost=2.3e+07 flops=1.8e+08
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.3e-05,1.9e-06,1.2e-06,1.8e-07
    3   0 -    -116.332525303671 -2.870e-04  3.692e-03    3     3  1.607e-02 5.358e-03 5.000e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.788e-05,2.194e-04,1.120e-03,1.059e-03,2.431e-03
 ndim=176:1.311e-06GB t[comm(intra)]=2.223e-05 speed=1.180e-01GB/S t[comm(inter)]=5.651e-06 speed=4.641e-01GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=1.1e-03 t_reduction=1.1e-03 tot=2.4e-03 ---
 sigma[inter] counter=158 t=2.2e-04 per=9.2e+00 cost=3.0e+06 flops=1.4e+10
 sigma[gemm] counter=158 i=0 t=2.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=1 t=2.3e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=2 t=2.2e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=3 t=2.2e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=4 t=2.8e-04 per=1.2e+01 cost=7.7e+05 flops=2.8e+09
 sigma[gemm] counter=158 i=5 t=3.1e-04 per=1.3e+01 cost=7.9e+05 flops=2.5e+09
 sigma[gemm] counter=158 i=6 t=2.7e-04 per=1.1e+01 cost=3.7e+05 flops=1.4e+09
 sigma[gemm] counter=158 i=7 t=2.5e-04 per=1.0e+01 cost=3.8e+05 flops=1.5e+09
 sigma[gemm] counter=158 total t=1.1e-03 per=4.7e+01 cost=2.3e+06 flops=2.1e+09
 sigma[red] counter=158 t=1.1e-03 per=4.4e+01 cost=4.7e+05 flops=4.4e+08
--- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=1.3e-01 t_reduction=1.3e-01 tot=2.9e-01 ---
 sigma_tot[inter] counter=158 t=2.8e-02 per=9.8e+00 cost=1.3e+08 flops=4.6e+09
 sigma_tot[gemm] counter=158 i=0 t=4.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=1 t=3.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=2 t=3.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=3 t=3.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=4 t=3.2e-02 per=1.1e+01 cost=2.6e+07 flops=8.0e+08
 sigma_tot[gemm] counter=158 i=5 t=3.5e-02 per=1.2e+01 cost=2.5e+07 flops=7.3e+08
 sigma_tot[gemm] counter=158 i=6 t=3.3e-02 per=1.2e+01 cost=2.2e+07 flops=6.5e+08
 sigma_tot[gemm] counter=158 i=7 t=3.3e-02 per=1.1e+01 cost=2.3e+07 flops=7.0e+08
 sigma_tot[gemm] counter=158 total t=1.3e-01 per=4.6e+01 cost=9.6e+07 flops=7.1e+08
 sigma_tot[red] counter=158 t=1.3e-01 per=4.4e+01 cost=2.3e+07 flops=1.8e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.1e-05,1.7e-06,1.1e-06,1.4e-07
    4   0 -    -116.332566343534 -4.104e-05  1.347e-03    3     4  2.120e-02 5.299e-03 4.964e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.821e-05,2.174e-04,1.103e-03,1.058e-03,2.411e-03
 ndim=176:1.311e-06GB t[comm(intra)]=2.240e-05 speed=1.171e-01GB/S t[comm(inter)]=5.809e-06 speed=4.515e-01GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=1.1e-03 t_reduction=1.1e-03 tot=2.4e-03 ---
 sigma[inter] counter=159 t=2.2e-04 per=9.1e+00 cost=3.0e+06 flops=1.4e+10
 sigma[gemm] counter=159 i=0 t=2.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=1 t=2.2e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=2 t=2.2e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=3 t=2.2e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=4 t=2.7e-04 per=1.2e+01 cost=7.7e+05 flops=2.8e+09
 sigma[gemm] counter=159 i=5 t=3.1e-04 per=1.3e+01 cost=7.9e+05 flops=2.5e+09
 sigma[gemm] counter=159 i=6 t=2.6e-04 per=1.1e+01 cost=3.7e+05 flops=1.4e+09
 sigma[gemm] counter=159 i=7 t=2.5e-04 per=1.0e+01 cost=3.8e+05 flops=1.5e+09
 sigma[gemm] counter=159 total t=1.1e-03 per=4.6e+01 cost=2.3e+06 flops=2.1e+09
 sigma[red] counter=159 t=1.1e-03 per=4.4e+01 cost=4.7e+05 flops=4.4e+08
--- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=2.9e-01 ---
 sigma_tot[inter] counter=159 t=2.8e-02 per=9.8e+00 cost=1.3e+08 flops=4.7e+09
 sigma_tot[gemm] counter=159 i=0 t=4.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=1 t=3.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=2 t=3.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=3 t=3.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=4 t=3.2e-02 per=1.1e+01 cost=2.6e+07 flops=8.1e+08
 sigma_tot[gemm] counter=159 i=5 t=3.5e-02 per=1.2e+01 cost=2.6e+07 flops=7.5e+08
 sigma_tot[gemm] counter=159 i=6 t=3.4e-02 per=1.2e+01 cost=2.2e+07 flops=6.6e+08
 sigma_tot[gemm] counter=159 i=7 t=3.3e-02 per=1.1e+01 cost=2.3e+07 flops=7.1e+08
 sigma_tot[gemm] counter=159 total t=1.4e-01 per=4.6e+01 cost=9.8e+07 flops=7.2e+08
 sigma_tot[red] counter=159 t=1.3e-01 per=4.4e+01 cost=2.4e+07 flops=1.9e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.1e-05,1.8e-06,1.0e-06,1.5e-07
    5   0 -    -116.332571893962 -5.550e-06  4.656e-04    3     5  2.668e-02 5.336e-03 5.013e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.859e-05,2.185e-04,1.129e-03,1.058e-03,2.441e-03
 ndim=176:1.311e-06GB t[comm(intra)]=2.265e-05 speed=1.158e-01GB/S t[comm(inter)]=5.938e-06 speed=4.417e-01GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=1.1e-03 t_reduction=1.1e-03 tot=2.4e-03 ---
 sigma[inter] counter=160 t=2.2e-04 per=9.1e+00 cost=3.0e+06 flops=1.4e+10
 sigma[gemm] counter=160 i=0 t=2.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=1 t=2.2e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=2 t=2.2e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=3 t=2.2e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=4 t=2.8e-04 per=1.2e+01 cost=7.7e+05 flops=2.8e+09
 sigma[gemm] counter=160 i=5 t=3.1e-04 per=1.3e+01 cost=7.9e+05 flops=2.5e+09
 sigma[gemm] counter=160 i=6 t=2.7e-04 per=1.1e+01 cost=3.7e+05 flops=1.4e+09
 sigma[gemm] counter=160 i=7 t=2.6e-04 per=1.1e+01 cost=3.8e+05 flops=1.5e+09
 sigma[gemm] counter=160 total t=1.1e-03 per=4.7e+01 cost=2.3e+06 flops=2.0e+09
 sigma[red] counter=160 t=1.1e-03 per=4.4e+01 cost=4.7e+05 flops=4.4e+08
--- TIMING FOR sigma_tot : t_inter=2.9e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=2.9e-01 ---
 sigma_tot[inter] counter=160 t=2.9e-02 per=9.8e+00 cost=1.4e+08 flops=4.7e+09
 sigma_tot[gemm] counter=160 i=0 t=4.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=1 t=3.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=2 t=3.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=3 t=3.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=4 t=3.3e-02 per=1.1e+01 cost=2.7e+07 flops=8.3e+08
 sigma_tot[gemm] counter=160 i=5 t=3.5e-02 per=1.2e+01 cost=2.7e+07 flops=7.7e+08
 sigma_tot[gemm] counter=160 i=6 t=3.4e-02 per=1.2e+01 cost=2.3e+07 flops=6.6e+08
 sigma_tot[gemm] counter=160 i=7 t=3.3e-02 per=1.1e+01 cost=2.4e+07 flops=7.2e+08
 sigma_tot[gemm] counter=160 total t=1.4e-01 per=4.6e+01 cost=1.0e+08 flops=7.4e+08
 sigma_tot[red] counter=160 t=1.3e-01 per=4.4e+01 cost=2.4e+07 flops=1.9e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.0e-05,1.6e-06,9.8e-07,1.5e-07
    6   0 -    -116.332572616534 -7.226e-07  1.438e-04    3     6  3.188e-02 5.313e-03 4.997e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.776e-05,2.159e-04,1.117e-03,1.050e-03,2.416e-03
 ndim=176:1.311e-06GB t[comm(intra)]=2.227e-05 speed=1.177e-01GB/S t[comm(inter)]=5.481e-06 speed=4.785e-01GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=1.1e-03 t_reduction=1.1e-03 tot=2.4e-03 ---
 sigma[inter] counter=161 t=2.2e-04 per=9.1e+00 cost=3.0e+06 flops=1.4e+10
 sigma[gemm] counter=161 i=0 t=2.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=1 t=2.2e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=2 t=2.2e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=3 t=2.2e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=4 t=2.8e-04 per=1.2e+01 cost=7.7e+05 flops=2.8e+09
 sigma[gemm] counter=161 i=5 t=3.1e-04 per=1.3e+01 cost=7.9e+05 flops=2.5e+09
 sigma[gemm] counter=161 i=6 t=2.6e-04 per=1.1e+01 cost=3.7e+05 flops=1.4e+09
 sigma[gemm] counter=161 i=7 t=2.6e-04 per=1.1e+01 cost=3.8e+05 flops=1.5e+09
 sigma[gemm] counter=161 total t=1.1e-03 per=4.7e+01 cost=2.3e+06 flops=2.1e+09
 sigma[red] counter=161 t=1.1e-03 per=4.4e+01 cost=4.7e+05 flops=4.4e+08
--- TIMING FOR sigma_tot : t_inter=2.9e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.0e-01 ---
 sigma_tot[inter] counter=161 t=2.9e-02 per=9.8e+00 cost=1.4e+08 flops=4.8e+09
 sigma_tot[gemm] counter=161 i=0 t=4.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=1 t=3.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=2 t=3.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=3 t=3.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=4 t=3.3e-02 per=1.1e+01 cost=2.8e+07 flops=8.5e+08
 sigma_tot[gemm] counter=161 i=5 t=3.6e-02 per=1.2e+01 cost=2.8e+07 flops=7.8e+08
 sigma_tot[gemm] counter=161 i=6 t=3.4e-02 per=1.2e+01 cost=2.3e+07 flops=6.7e+08
 sigma_tot[gemm] counter=161 i=7 t=3.4e-02 per=1.1e+01 cost=2.4e+07 flops=7.2e+08
 sigma_tot[gemm] counter=161 total t=1.4e-01 per=4.6e+01 cost=1.0e+08 flops=7.5e+08
 sigma_tot[red] counter=161 t=1.3e-01 per=4.4e+01 cost=2.5e+07 flops=1.9e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.0e-05,1.7e-06,1.0e-06,1.4e-07
    7   0 +    -116.332572672318 -5.578e-08  3.729e-05    3     7  3.696e-02 5.280e-03 4.971e-03
TIMING FOR Davidson : 3.705e-02  T(cal/comm/rest)=3.480e-02,3.340e-07,2.250e-03
decomposed t_rest=2.250e-03
 T(sub)    =1.242e-04 per=5.521e+00
 T(precond)=4.850e-04 per=2.155e+01
 T(ortho)  =1.903e-05 per=8.456e-01
 T(xcopy)  =8.520e-07 per=3.786e-02
 T(xnrm2)  =1.508e-06 per=6.701e-02
 T(other)  =1.620e-03 per=7.198e+01
optimized energies: isweep=0 ibond=25 dots=2 e[0]=-116.332572672318 nmvp=7
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:4.608e+01S Sys:1.213e+00S Total:4.729e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond25.txt
 qbond: qsuper nsym=9 dimAll=40
 (14,2):6 (14,4):4 (13,3):1 (15,3):10 (16,2):6 (16,4):4 (17,3):1 (15,1):5 (15,5):3
----- TMING FOR decimation_genbasis(su2): 6.7e-04 S -----
decimation summary: 40->10 dwt=+4.776e-03 SvN=1.463e+00
 qbond: qkept nsym=4 dimAll=10
 (15,3):4 (15,1):4 (16,2):1 (16,4):1
----- TIMING for decimation_row(nkr): 3.870e-03 S T(decim/select/formRot)=1.019e-03,2.671e-03,1.800e-04 -----
----- TIMING FOR twodot_decimation: 4.170e-03 S T(wf/decim)=1.717e-04,3.998e-03 -----
ctns::oper_renorm coord=(10,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHAB nops=C:10 S:10 H:1 A:100 B:110 
        dim(bra,ket)=10,10 size(op)=68:5.188e-04MB size(tot)=5884:4.489e-02MB:4.384e-05GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:4.624e+01S Sys:1.213e+00S Total:4.745e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=231 : 6.105e-04 S -----
rank=0 GPUmem(GB): used=0.000143 (oper)=8.87e-05
rank=0 GPUmem(GB): used=0.000143 (oper,site)(GB)=8.87e-05,5.22e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=231
 no. of rintermediate operators=95
 no. of coefficients=3105:0.0237MB:2.31e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.751e-04 S -----
rank=0 GPUmem(GB): used=0.000166 (oper,site,rinter)=8.87e-05,5.22e-07,2.31e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00192 S size(rtasks)=231 size(Rlst2)=16 T(Rmu/Rlist)=0.000129,0.00179 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00208 S size(rtasks)=231 size(Rlst)=2245 -----
rank=0 GPUmem(GB): used=0.000166 (oper,site,rinter,batch)=8.87e-05,5.22e-07,2.31e-05,0.0011 blksize=20 blksize0=25 batchsize=2245
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000181,0.000663,0.000191
--- TIMING FOR renorm : t_inter=1.8e-04 t_gemm=6.6e-04 t_reduction=1.9e-04 tot=1.0e-03 ---
 renorm[inter] counter=26 t=1.8e-04 per=1.8e+01 cost=3.5e+05 flops=2.0e+09
 renorm[gemm] counter=26 i=0 t=2.7e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=1 t=2.9e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=2 t=2.3e-04 per=2.2e+01 cost=1.2e+04 flops=5.3e+07
 renorm[gemm] counter=26 i=3 t=2.5e-04 per=2.4e+01 cost=1.0e+05 flops=4.2e+08
 renorm[gemm] counter=26 i=4 t=2.9e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=5 t=3.0e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=26 i=6 t=1.8e-04 per=1.7e+01 cost=1.2e+05 flops=6.8e+08
 renorm[gemm] counter=26 total t=6.6e-04 per=6.4e+01 cost=2.4e+05 flops=3.6e+08
 renorm[red] counter=26 t=1.9e-04 per=1.8e+01 cost=3.7e+04 flops=1.9e+08
--- TIMING FOR renorm_tot : t_inter=3.8e-03 t_gemm=1.8e-02 t_reduction=6.6e-03 tot=2.8e-02 ---
 renorm_tot[inter] counter=26 t=3.8e-03 per=1.3e+01 cost=2.7e+06 flops=7.1e+08
 renorm_tot[gemm] counter=26 i=0 t=7.4e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=26 i=1 t=6.0e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=26 i=2 t=2.2e-03 per=7.8e+00 cost=1.4e+05 flops=6.2e+07
 renorm_tot[gemm] counter=26 i=3 t=2.4e-03 per=8.3e+00 cost=3.0e+05 flops=1.3e+08
 renorm_tot[gemm] counter=26 i=4 t=3.6e-03 per=1.3e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=26 i=5 t=3.6e-03 per=1.3e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=26 i=6 t=6.0e-03 per=2.1e+01 cost=1.4e+06 flops=2.3e+08
 renorm_tot[gemm] counter=26 total t=1.8e-02 per=6.3e+01 cost=2.6e+06 flops=1.4e+08
 renorm_tot[red] counter=26 t=6.6e-03 per=2.3e+01 cost=6.2e+05 flops=9.3e+07
qops.to_cpu: size(tot)=5884:4.5e-02MB:4.4e-05GB t[to_cpu]=2.4e-05S speed=1.8e+00GB/S
check ||H-H.dagger||=1.778e-15 coord=(10,0) rank=0
ctns::oper_ab2pq coord=(10,0) superblock=cr ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 0.0061 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.000336,3.41e-06,0.00266,0.00294,3.63e-05,0.000132 -----
----- TIMING FOR oper_renorm : 0.00852 S rank=0 -----
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:4.676e+01S Sys:1.213e+00S Total:4.797e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=778:5.936e-03MB:5.797e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=64:4.883e-04MB:4.768e-07GB
total mem of comb=843:6.432e-03MB:6.281e-06GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:4.704e+01S Sys:1.213e+00S Total:4.825e+01S
##### local opt: 1.638e-01 S #####
 T(local opt: fetch) = 6.716e-03 S  per =  4.1  per(accum) = 4.1
 T(local opt: hdiag) = 1.441e-02 S  per =  8.8  per(accum) = 12.9
 T(local opt: dvdsn) = 1.179e-01 S  per =   72  per(accum) = 84.9
 T(local opt: decim) = 4.269e-03 S  per = 2.61  per(accum) = 87.5
 T(local opt: guess) = 1.033e-04 S  per = 0.0631  per(accum) = 87.6
 T(local opt: renrm) = 1.575e-02 S  per = 9.62  per(accum) = 97.2
 T(local opt: save ) = 4.626e-03 S  per = 2.82  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.179e-01 S  T(sum) = 1.168e-01 S  per = 9.907e+01
 T(local opt: preprocess                  ) = 6.647e-04 S  per = 0.569  per(accum) = 0.569
 T(local opt: symbolic_formulae           ) = 1.867e-03 S  per =  1.6  per(accum) = 2.17
 T(local opt: hintermediate init          ) = 6.657e-04 S  per = 0.57  per(accum) = 2.74
 T(local opt: preprocess_hformulae_Hxlist ) = 6.447e-02 S  per = 55.2  per(accum) = 57.9
 T(local opt: hmmtasks init               ) = 1.180e-02 S  per = 10.1  per(accum) = 68
 T(local opt: initial guess for dvdson    ) = 2.726e-04 S  per = 0.233  per(accum) = 68.3
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.458e-02 S  per = 29.6  per(accum) = 97.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.187e-04 S  per = 0.187  per(accum) = 98.1
 T(local opt: dvdson solver [comm(cpu)]   ) = 3.340e-07 S  per = 0.000286  per(accum) = 98.1
 T(local opt: dvdson solver [rest part]   ) = 2.250e-03 S  per = 1.93  per(accum) = 100
Detailed decomposition of T(renrm) = 1.575e-02 S  T(sum) = 1.575e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.180e-04 S  per = 0.749  per(accum) = 0.749
 T(local opt: qops init                    ) = 6.461e-04 S  per =  4.1  per(accum) = 4.85
 T(local opt: symbolic_formulae_renorm     ) = 7.133e-04 S  per = 4.53  per(accum) = 9.38
 T(local opt: allocate qops on gpu         ) = 1.087e-04 S  per = 0.69  per(accum) = 10.1
 T(local opt: site memcpy cpu2gpu          ) = 1.121e-04 S  per = 0.712  per(accum) = 10.8
 T(local opt: rintermediate init           ) = 5.323e-04 S  per = 3.38  per(accum) = 14.2
 T(local opt: preprocess_formulae_Rlist2   ) = 2.173e-03 S  per = 13.8  per(accum) = 28
 T(local opt: rmmtasks init                ) = 6.720e-04 S  per = 4.27  per(accum) = 32.2
 T(local opt: qops memset on cpu           ) = 5.200e-08 S  per = 0.00033  per(accum) = 32.2
 T(local opt: preprocess_renorm_batchGPU   ) = 3.157e-03 S  per =   20  per(accum) = 52.3
 T(local opt: reduction of opS & opH [nccl]) = 5.310e-07 S  per = 0.00337  per(accum) = 52.3
 T(local opt: qops memcpy gpu2cpu          ) = 1.189e-04 S  per = 0.755  per(accum) = 53
 T(local opt: deallocate cpu and gpu memory) = 1.143e-05 S  per = 0.0725  per(accum) = 53.1
 T(local opt: reduction of opS & opH [comm]) = 2.735e-04 S  per = 1.74  per(accum) = 54.8
 T(local opt: conversion from opAB to opPQ ) = 6.291e-03 S  per = 39.9  per(accum) = 94.8
 T(local opt: after oper_renorm            ) = 8.247e-04 S  per = 5.24  per(accum) = 100
##### sweep opt: 2.271e+00 S #####
 T(sweep opt: fetch) = 1.685e-01 S  per = 7.42  per(accum) = 7.42
 T(sweep opt: hdiag) = 1.440e-01 S  per = 6.34  per(accum) = 13.8
 T(sweep opt: dvdsn) = 1.510e+00 S  per = 66.5  per(accum) = 80.3
 T(sweep opt: decim) = 9.744e-02 S  per = 4.29  per(accum) = 84.6
 T(sweep opt: guess) = 3.088e-03 S  per = 0.136  per(accum) = 84.7
 T(sweep opt: renrm) = 2.300e-01 S  per = 10.1  per(accum) = 94.8
 T(sweep opt: save ) = 1.171e-01 S  per = 5.16  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.510e+00 S  T(sum) = 1.487e+00 S  per = 9.845e+01
 T(sweep opt: preprocess                  ) = 1.670e-02 S  per = 1.12  per(accum) = 1.12
 T(sweep opt: symbolic_formulae           ) = 2.769e-02 S  per = 1.86  per(accum) = 2.99
 T(sweep opt: hintermediate init          ) = 1.534e-02 S  per = 1.03  per(accum) = 4.02
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.323e-01 S  per = 42.5  per(accum) = 46.5
 T(sweep opt: hmmtasks init               ) = 1.081e-01 S  per = 7.27  per(accum) = 53.8
 T(sweep opt: initial guess for dvdson    ) = 6.370e-03 S  per = 0.428  per(accum) = 54.2
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 6.297e-01 S  per = 42.3  per(accum) = 96.6
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.630e-03 S  per = 0.311  per(accum) = 96.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 7.400e-06 S  per = 0.000498  per(accum) = 96.9
 T(sweep opt: dvdson solver [rest part]   ) = 4.632e-02 S  per = 3.12  per(accum) = 100
Detailed decomposition of T(renrm) = 2.300e-01 S  T(sum) = 2.300e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.127e-03 S  per = 1.36  per(accum) = 1.36
 T(sweep opt: qops init                    ) = 1.223e-02 S  per = 5.32  per(accum) = 6.68
 T(sweep opt: symbolic_formulae_renorm     ) = 1.246e-02 S  per = 5.42  per(accum) = 12.1
 T(sweep opt: allocate qops on gpu         ) = 2.485e-03 S  per = 1.08  per(accum) = 13.2
 T(sweep opt: site memcpy cpu2gpu          ) = 2.359e-03 S  per = 1.03  per(accum) = 14.2
 T(sweep opt: rintermediate init           ) = 1.241e-02 S  per = 5.39  per(accum) = 19.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.349e-02 S  per = 23.3  per(accum) = 42.9
 T(sweep opt: rmmtasks init                ) = 1.745e-02 S  per = 7.59  per(accum) = 50.4
 T(sweep opt: qops memset on cpu           ) = 1.279e-06 S  per = 0.000556  per(accum) = 50.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.544e-02 S  per = 32.8  per(accum) = 83.2
 T(sweep opt: reduction of opS & opH [nccl]) = 1.536e-05 S  per = 0.00668  per(accum) = 83.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.693e-03 S  per = 1.17  per(accum) = 84.4
 T(sweep opt: deallocate cpu and gpu memory) = 4.054e-04 S  per = 0.176  per(accum) = 84.6
 T(sweep opt: reduction of opS & opH [comm]) = 2.492e-03 S  per = 1.08  per(accum) = 85.7
 T(sweep opt: conversion from opAB to opPQ ) = 1.416e-02 S  per = 6.16  per(accum) = 91.8
 T(sweep opt: after oper_renorm            ) = 1.879e-02 S  per = 8.17  per(accum) = 100
##### global opt: 2.271e+00 S #####
 T(global opt: fetch) = 1.685e-01 S  per = 7.42  per(accum) = 7.42
 T(global opt: hdiag) = 1.440e-01 S  per = 6.34  per(accum) = 13.8
 T(global opt: dvdsn) = 1.510e+00 S  per = 66.5  per(accum) = 80.3
 T(global opt: decim) = 9.744e-02 S  per = 4.29  per(accum) = 84.6
 T(global opt: guess) = 3.088e-03 S  per = 0.136  per(accum) = 84.7
 T(global opt: renrm) = 2.300e-01 S  per = 10.1  per(accum) = 94.8
 T(global opt: save ) = 1.171e-01 S  per = 5.16  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.510e+00 S  T(sum) = 1.487e+00 S  per = 9.845e+01
 T(global opt: preprocess                  ) = 1.670e-02 S  per = 1.12  per(accum) = 1.12
 T(global opt: symbolic_formulae           ) = 2.769e-02 S  per = 1.86  per(accum) = 2.99
 T(global opt: hintermediate init          ) = 1.534e-02 S  per = 1.03  per(accum) = 4.02
 T(global opt: preprocess_hformulae_Hxlist ) = 6.323e-01 S  per = 42.5  per(accum) = 46.5
 T(global opt: hmmtasks init               ) = 1.081e-01 S  per = 7.27  per(accum) = 53.8
 T(global opt: initial guess for dvdson    ) = 6.370e-03 S  per = 0.428  per(accum) = 54.2
 T(global opt: dvdson solver [Hx_batchGPU] ) = 6.297e-01 S  per = 42.3  per(accum) = 96.6
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.630e-03 S  per = 0.311  per(accum) = 96.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 7.400e-06 S  per = 0.000498  per(accum) = 96.9
 T(global opt: dvdson solver [rest part]   ) = 4.632e-02 S  per = 3.12  per(accum) = 100
Detailed decomposition of T(renrm) = 2.300e-01 S  T(sum) = 2.300e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.127e-03 S  per = 1.36  per(accum) = 1.36
 T(global opt: qops init                    ) = 1.223e-02 S  per = 5.32  per(accum) = 6.68
 T(global opt: symbolic_formulae_renorm     ) = 1.246e-02 S  per = 5.42  per(accum) = 12.1
 T(global opt: allocate qops on gpu         ) = 2.485e-03 S  per = 1.08  per(accum) = 13.2
 T(global opt: site memcpy cpu2gpu          ) = 2.359e-03 S  per = 1.03  per(accum) = 14.2
 T(global opt: rintermediate init           ) = 1.241e-02 S  per = 5.39  per(accum) = 19.6
 T(global opt: preprocess_formulae_Rlist2   ) = 5.349e-02 S  per = 23.3  per(accum) = 42.9
 T(global opt: rmmtasks init                ) = 1.745e-02 S  per = 7.59  per(accum) = 50.4
 T(global opt: qops memset on cpu           ) = 1.279e-06 S  per = 0.000556  per(accum) = 50.4
 T(global opt: preprocess_renorm_batchGPU   ) = 7.544e-02 S  per = 32.8  per(accum) = 83.2
 T(global opt: reduction of opS & opH [nccl]) = 1.536e-05 S  per = 0.00668  per(accum) = 83.2
 T(global opt: qops memcpy gpu2cpu          ) = 2.693e-03 S  per = 1.17  per(accum) = 84.4
 T(global opt: deallocate cpu and gpu memory) = 4.054e-04 S  per = 0.176  per(accum) = 84.6
 T(global opt: reduction of opS & opH [comm]) = 2.492e-03 S  per = 1.08  per(accum) = 85.7
 T(global opt: conversion from opAB to opPQ ) = 1.416e-02 S  per = 6.16  per(accum) = 91.8
 T(global opt: after oper_renorm            ) = 1.879e-02 S  per = 8.17  per(accum) = 100

isweep=0 ibond=26/seqsize=34 dots=2 dbond=(8,0)-(9,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:4.704e+01S Sys:1.213e+00S Total:4.825e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=778:5.936e-03MB:5.797e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=64:4.883e-04MB:4.768e-07GB
total mem of comb=843:6.432e-03MB:6.281e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=8,10,1,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc1= 19
 suppc2= 5
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:8 S:12 H:1 A:64 B:72 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3184:2.429e-02MB:2.372e-05GB
 rqops: oplist=CSHPQ nops=C:10 S:10 H:1 P:100 Q:110 
        dim(bra,ket)=10,10 size(op)=68:5.188e-04MB size(tot)=5884:4.489e-02MB:4.384e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=11064:8.441e-02MB:8.243e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(9,0) fdel=./scratch/sweep/lop(8,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=138:1.053e-03MB
qtensor4: wf4 own=1 _data=0x55a3228bb320
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (12,2):4 (12,0):3 (11,1):1 (11,3):1 (12,4):1
 qbond: qcol nsym=4 dimAll=10
 (15,3):4 (15,1):4 (16,2):1 (16,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=27 nblocks=304 size=138:1.053e-03MB
### DIAG TIMING: total=9.330e-03 t1=9.361e-06, t2=1.630e-05, t3=1.848e-05, t4=9.259e-03, t5=4.542e-06, t6=1.802e-05, t7=3.969e-06
duration_diagGPU:9.420e-03
duration_diagreduce:3.800e-08
duration_diagtransform:2.990e-07
----- TIMING FOR symbolic_formulae_twodot with size=837 : 1.587e-03 S -----
rank=0 GPUmem(GB): used=8.24e-05 (oper)=8.24e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=837
 no. of hintermediate operators=392
 no. of coefficients=5612:0.0428MB:4.18e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.280e-04 S -----
rank=0 GPUmem(GB): used=0.000124 (oper,hinter)=8.24e-05,4.18e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0439 S size(H_formulae)=837 size(Hxlst2)=27 T(Hmu/Hxlist)=0.000315,0.0436 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0447 S size(H_formulae)=837 size(Hxlst)=27044 -----
rank=0 GPUmem(GB): used=0.01 (oper,hinter,dvdson,batch)=8.24e-05,4.18e-05,2.06e-06,0.00987 blksize=16 blksize0=16 batchsize=27044
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=138 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.44e-05,0.000218,0.000984,0.00101,0.00225
 ndim=138:1.03e-06GB t[comm(intra)]=2.7e-05 speed=0.0762GB/S t[comm(inter)]=7.43e-06 speed=0.277GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=9.8e-04 t_reduction=1.0e-03 tot=2.2e-03 ---
 sigma[inter] counter=162 t=2.2e-04 per=9.9e+00 cost=1.7e+06 flops=7.9e+09
 sigma[gemm] counter=162 i=0 t=2.9e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=1 t=2.2e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=2 t=2.3e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=3 t=2.2e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=4 t=2.2e-04 per=9.8e+00 cost=2.6e+05 flops=1.2e+09
 sigma[gemm] counter=162 i=5 t=2.3e-04 per=1.0e+01 cost=2.6e+05 flops=1.2e+09
 sigma[gemm] counter=162 i=6 t=2.7e-04 per=1.2e+01 cost=3.7e+05 flops=1.4e+09
 sigma[gemm] counter=162 i=7 t=2.7e-04 per=1.2e+01 cost=3.8e+05 flops=1.4e+09
 sigma[gemm] counter=162 total t=9.8e-04 per=4.5e+01 cost=1.3e+06 flops=1.3e+09
 sigma[red] counter=162 t=1.0e-03 per=4.6e+01 cost=2.9e+05 flops=2.9e+08
--- TIMING FOR sigma_tot : t_inter=2.9e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.0e-01 ---
 sigma_tot[inter] counter=162 t=2.9e-02 per=9.8e+00 cost=1.4e+08 flops=4.8e+09
 sigma_tot[gemm] counter=162 i=0 t=4.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=1 t=3.7e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=2 t=3.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=3 t=3.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=4 t=3.3e-02 per=1.1e+01 cost=2.8e+07 flops=8.5e+08
 sigma_tot[gemm] counter=162 i=5 t=3.6e-02 per=1.2e+01 cost=2.8e+07 flops=7.8e+08
 sigma_tot[gemm] counter=162 i=6 t=3.4e-02 per=1.2e+01 cost=2.3e+07 flops=6.7e+08
 sigma_tot[gemm] counter=162 i=7 t=3.4e-02 per=1.1e+01 cost=2.5e+07 flops=7.3e+08
 sigma_tot[gemm] counter=162 total t=1.4e-01 per=4.6e+01 cost=1.0e+08 flops=7.5e+08
 sigma_tot[red] counter=162 t=1.3e-01 per=4.4e+01 cost=2.5e+07 flops=1.9e+08
T(sub)=8.4e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,3.4e-06,9.7e-07,9.2e-07,2.3e-07
settings: ndim=138 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.330547046388 -1.116e+03  2.582e-02    1     1  4.284e-03 4.284e-03 4.110e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.838e-05,1.784e-04,8.693e-04,9.376e-04,2.019e-03
 ndim=138:1.028e-06GB t[comm(intra)]=2.274e-05 speed=9.043e-02GB/S t[comm(inter)]=5.645e-06 speed=3.643e-01GB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=8.7e-04 t_reduction=9.4e-04 tot=2.0e-03 ---
 sigma[inter] counter=163 t=1.8e-04 per=9.0e+00 cost=1.7e+06 flops=9.7e+09
 sigma[gemm] counter=163 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=1 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=4 t=1.8e-04 per=9.3e+00 cost=2.6e+05 flops=1.4e+09
 sigma[gemm] counter=163 i=5 t=1.9e-04 per=9.5e+00 cost=2.6e+05 flops=1.4e+09
 sigma[gemm] counter=163 i=6 t=2.4e-04 per=1.2e+01 cost=3.7e+05 flops=1.5e+09
 sigma[gemm] counter=163 i=7 t=2.4e-04 per=1.2e+01 cost=3.8e+05 flops=1.6e+09
 sigma[gemm] counter=163 total t=8.7e-04 per=4.4e+01 cost=1.3e+06 flops=1.5e+09
 sigma[red] counter=163 t=9.4e-04 per=4.7e+01 cost=2.9e+05 flops=3.1e+08
--- TIMING FOR sigma_tot : t_inter=2.9e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.0e-01 ---
 sigma_tot[inter] counter=163 t=2.9e-02 per=9.8e+00 cost=1.4e+08 flops=4.8e+09
 sigma_tot[gemm] counter=163 i=0 t=4.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=1 t=3.7e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=2 t=3.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=3 t=3.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=4 t=3.3e-02 per=1.1e+01 cost=2.8e+07 flops=8.5e+08
 sigma_tot[gemm] counter=163 i=5 t=3.6e-02 per=1.2e+01 cost=2.8e+07 flops=7.9e+08
 sigma_tot[gemm] counter=163 i=6 t=3.5e-02 per=1.2e+01 cost=2.4e+07 flops=6.8e+08
 sigma_tot[gemm] counter=163 i=7 t=3.4e-02 per=1.1e+01 cost=2.5e+07 flops=7.3e+08
 sigma_tot[gemm] counter=163 total t=1.4e-01 per=4.6e+01 cost=1.1e+08 flops=7.5e+08
 sigma_tot[red] counter=163 t=1.3e-01 per=4.4e+01 cost=2.5e+07 flops=1.9e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.0e-05,2.3e-06,1.3e-06,2.1e-07
    2   0 -    -116.332203099011 -1.656e-03  8.292e-03    2     2  8.567e-03 4.283e-03 3.974e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.798e-05,1.763e-04,8.274e-04,9.333e-04,1.970e-03
 ndim=138:1.028e-06GB t[comm(intra)]=2.252e-05 speed=9.133e-02GB/S t[comm(inter)]=5.460e-06 speed=3.766e-01GB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=8.3e-04 t_reduction=9.3e-04 tot=1.9e-03 ---
 sigma[inter] counter=164 t=1.8e-04 per=9.1e+00 cost=1.7e+06 flops=9.8e+09
 sigma[gemm] counter=164 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=1 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=4 t=1.8e-04 per=9.1e+00 cost=2.6e+05 flops=1.5e+09
 sigma[gemm] counter=164 i=5 t=1.8e-04 per=9.2e+00 cost=2.6e+05 flops=1.5e+09
 sigma[gemm] counter=164 i=6 t=2.3e-04 per=1.2e+01 cost=3.7e+05 flops=1.6e+09
 sigma[gemm] counter=164 i=7 t=2.3e-04 per=1.2e+01 cost=3.8e+05 flops=1.6e+09
 sigma[gemm] counter=164 total t=8.3e-04 per=4.3e+01 cost=1.3e+06 flops=1.5e+09
 sigma[red] counter=164 t=9.3e-04 per=4.8e+01 cost=2.9e+05 flops=3.1e+08
--- TIMING FOR sigma_tot : t_inter=2.9e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.0e-01 ---
 sigma_tot[inter] counter=164 t=2.9e-02 per=9.7e+00 cost=1.4e+08 flops=4.9e+09
 sigma_tot[gemm] counter=164 i=0 t=4.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=1 t=3.7e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=2 t=3.7e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=3 t=3.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=4 t=3.3e-02 per=1.1e+01 cost=2.9e+07 flops=8.6e+08
 sigma_tot[gemm] counter=164 i=5 t=3.6e-02 per=1.2e+01 cost=2.9e+07 flops=7.9e+08
 sigma_tot[gemm] counter=164 i=6 t=3.5e-02 per=1.2e+01 cost=2.4e+07 flops=6.9e+08
 sigma_tot[gemm] counter=164 i=7 t=3.4e-02 per=1.1e+01 cost=2.5e+07 flops=7.4e+08
 sigma_tot[gemm] counter=164 total t=1.4e-01 per=4.6e+01 cost=1.1e+08 flops=7.6e+08
 sigma_tot[red] counter=164 t=1.3e-01 per=4.4e+01 cost=2.6e+07 flops=1.9e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.2e-05,1.7e-06,1.1e-06,1.8e-07
    3   0 -    -116.332367339197 -1.642e-04  2.832e-03    3     3  1.247e-02 4.157e-03 3.894e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.748e-05,1.748e-04,8.251e-04,9.274e-04,1.959e-03
 ndim=138:1.028e-06GB t[comm(intra)]=2.200e-05 speed=9.348e-02GB/S t[comm(inter)]=5.484e-06 speed=3.750e-01GB/S
--- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=8.2e-04 t_reduction=9.3e-04 tot=1.9e-03 ---
 sigma[inter] counter=165 t=1.7e-04 per=9.1e+00 cost=1.7e+06 flops=9.9e+09
 sigma[gemm] counter=165 i=0 t=2.6e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=1 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=4 t=1.7e-04 per=9.1e+00 cost=2.6e+05 flops=1.5e+09
 sigma[gemm] counter=165 i=5 t=1.8e-04 per=9.4e+00 cost=2.6e+05 flops=1.5e+09
 sigma[gemm] counter=165 i=6 t=2.3e-04 per=1.2e+01 cost=3.7e+05 flops=1.6e+09
 sigma[gemm] counter=165 i=7 t=2.3e-04 per=1.2e+01 cost=3.8e+05 flops=1.7e+09
 sigma[gemm] counter=165 total t=8.2e-04 per=4.3e+01 cost=1.3e+06 flops=1.5e+09
 sigma[red] counter=165 t=9.3e-04 per=4.8e+01 cost=2.9e+05 flops=3.1e+08
--- TIMING FOR sigma_tot : t_inter=3.0e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.0e-01 ---
 sigma_tot[inter] counter=165 t=3.0e-02 per=9.7e+00 cost=1.5e+08 flops=4.9e+09
 sigma_tot[gemm] counter=165 i=0 t=4.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=1 t=3.7e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=2 t=3.7e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=3 t=3.7e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=4 t=3.4e-02 per=1.1e+01 cost=2.9e+07 flops=8.6e+08
 sigma_tot[gemm] counter=165 i=5 t=3.6e-02 per=1.2e+01 cost=2.9e+07 flops=7.9e+08
 sigma_tot[gemm] counter=165 i=6 t=3.5e-02 per=1.2e+01 cost=2.4e+07 flops=6.9e+08
 sigma_tot[gemm] counter=165 i=7 t=3.4e-02 per=1.1e+01 cost=2.6e+07 flops=7.5e+08
 sigma_tot[gemm] counter=165 total t=1.4e-01 per=4.6e+01 cost=1.1e+08 flops=7.6e+08
 sigma_tot[red] counter=165 t=1.3e-01 per=4.4e+01 cost=2.6e+07 flops=1.9e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.0e-05,1.7e-06,1.0e-06,1.7e-07
    4   0 -    -116.332389606967 -2.227e-05  9.163e-04    3     4  1.640e-02 4.100e-03 3.861e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.680e-05,1.730e-04,8.222e-04,9.262e-04,1.953e-03
 ndim=138:1.028e-06GB t[comm(intra)]=2.155e-05 speed=9.544e-02GB/S t[comm(inter)]=5.256e-06 speed=3.912e-01GB/S
--- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=8.2e-04 t_reduction=9.3e-04 tot=1.9e-03 ---
 sigma[inter] counter=166 t=1.7e-04 per=9.0e+00 cost=1.7e+06 flops=1.0e+10
 sigma[gemm] counter=166 i=0 t=2.6e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=1 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=4 t=1.8e-04 per=9.2e+00 cost=2.6e+05 flops=1.5e+09
 sigma[gemm] counter=166 i=5 t=1.8e-04 per=9.4e+00 cost=2.6e+05 flops=1.5e+09
 sigma[gemm] counter=166 i=6 t=2.3e-04 per=1.2e+01 cost=3.7e+05 flops=1.6e+09
 sigma[gemm] counter=166 i=7 t=2.3e-04 per=1.2e+01 cost=3.8e+05 flops=1.7e+09
 sigma[gemm] counter=166 total t=8.2e-04 per=4.3e+01 cost=1.3e+06 flops=1.6e+09
 sigma[red] counter=166 t=9.3e-04 per=4.8e+01 cost=2.9e+05 flops=3.1e+08
--- TIMING FOR sigma_tot : t_inter=3.0e-02 t_gemm=1.4e-01 t_reduction=1.3e-01 tot=3.1e-01 ---
 sigma_tot[inter] counter=166 t=3.0e-02 per=9.7e+00 cost=1.5e+08 flops=4.9e+09
 sigma_tot[gemm] counter=166 i=0 t=4.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=1 t=3.7e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=2 t=3.7e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=3 t=3.7e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=4 t=3.4e-02 per=1.1e+01 cost=2.9e+07 flops=8.6e+08
 sigma_tot[gemm] counter=166 i=5 t=3.7e-02 per=1.2e+01 cost=2.9e+07 flops=8.0e+08
 sigma_tot[gemm] counter=166 i=6 t=3.5e-02 per=1.2e+01 cost=2.5e+07 flops=7.0e+08
 sigma_tot[gemm] counter=166 i=7 t=3.5e-02 per=1.1e+01 cost=2.6e+07 flops=7.5e+08
 sigma_tot[gemm] counter=166 total t=1.4e-01 per=4.6e+01 cost=1.1e+08 flops=7.7e+08
 sigma_tot[red] counter=166 t=1.3e-01 per=4.4e+01 cost=2.6e+07 flops=2.0e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.0e-05,1.6e-06,9.8e-07,1.3e-07
    5   0 -    -116.332392482142 -2.875e-06  2.901e-04    3     5  2.030e-02 4.060e-03 3.835e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.707e-05,1.715e-04,8.237e-04,9.270e-04,1.954e-03
 ndim=138:1.028e-06GB t[comm(intra)]=2.176e-05 speed=9.451e-02GB/S t[comm(inter)]=5.314e-06 speed=3.870e-01GB/S
--- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=8.2e-04 t_reduction=9.3e-04 tot=1.9e-03 ---
 sigma[inter] counter=167 t=1.7e-04 per=8.9e+00 cost=1.7e+06 flops=1.0e+10
 sigma[gemm] counter=167 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=4 t=1.8e-04 per=9.1e+00 cost=2.6e+05 flops=1.5e+09
 sigma[gemm] counter=167 i=5 t=1.8e-04 per=9.3e+00 cost=2.6e+05 flops=1.5e+09
 sigma[gemm] counter=167 i=6 t=2.3e-04 per=1.2e+01 cost=3.7e+05 flops=1.6e+09
 sigma[gemm] counter=167 i=7 t=2.3e-04 per=1.2e+01 cost=3.8e+05 flops=1.6e+09
 sigma[gemm] counter=167 total t=8.2e-04 per=4.3e+01 cost=1.3e+06 flops=1.6e+09
 sigma[red] counter=167 t=9.3e-04 per=4.8e+01 cost=2.9e+05 flops=3.1e+08
--- TIMING FOR sigma_tot : t_inter=3.0e-02 t_gemm=1.4e-01 t_reduction=1.4e-01 tot=3.1e-01 ---
 sigma_tot[inter] counter=167 t=3.0e-02 per=9.7e+00 cost=1.5e+08 flops=5.0e+09
 sigma_tot[gemm] counter=167 i=0 t=4.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=1 t=3.8e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=2 t=3.7e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=3 t=3.7e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=4 t=3.4e-02 per=1.1e+01 cost=2.9e+07 flops=8.7e+08
 sigma_tot[gemm] counter=167 i=5 t=3.7e-02 per=1.2e+01 cost=2.9e+07 flops=8.0e+08
 sigma_tot[gemm] counter=167 i=6 t=3.6e-02 per=1.2e+01 cost=2.5e+07 flops=7.0e+08
 sigma_tot[gemm] counter=167 i=7 t=3.5e-02 per=1.1e+01 cost=2.7e+07 flops=7.6e+08
 sigma_tot[gemm] counter=167 total t=1.4e-01 per=4.6e+01 cost=1.1e+08 flops=7.7e+08
 sigma_tot[red] counter=167 t=1.4e-01 per=4.4e+01 cost=2.7e+07 flops=2.0e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.0e-05,1.7e-06,9.8e-07,1.3e-07
    6   0 +    -116.332392700332 -2.182e-07  7.807e-05    3     6  2.423e-02 4.039e-03 3.823e-03
TIMING FOR Davidson : 2.430e-02  T(cal/comm/rest)=2.294e-02,2.490e-07,1.362e-03
decomposed t_rest=1.362e-03
 T(sub)    =9.907e-05 per=7.275e+00
 T(precond)=1.479e-04 per=1.086e+01
 T(ortho)  =7.651e-06 per=5.619e-01
 T(xcopy)  =7.620e-07 per=5.596e-02
 T(xnrm2)  =1.179e-06 per=8.658e-02
 T(other)  =1.105e-03 per=8.116e+01
optimized energies: isweep=0 ibond=26 dots=2 e[0]=-116.332392700332 nmvp=6
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:4.839e+01S Sys:1.215e+00S Total:4.961e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=10 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond26.txt
 qbond: qsuper nsym=10 dimAll=40
 (15,3):4 (15,1):4 (16,2):9 (16,4):5 (17,3):6 (17,1):5 (18,2):1 (18,4):1 (16,0):4 (17,5):1
----- TMING FOR decimation_genbasis(su2): 8.1e-05 S -----
decimation summary: 40->10 dwt=+1.635e-04 SvN=1.494e+00
 qbond: qkept nsym=5 dimAll=10
 (16,2):4 (16,0):3 (16,4):1 (17,3):1 (17,1):1
----- TIMING for decimation_row(nkr): 3.578e-03 S T(decim/select/formRot)=3.443e-04,3.090e-03,1.434e-04 -----
----- TIMING FOR twodot_decimation: 3.814e-03 S T(wf/decim)=1.534e-04,3.660e-03 -----
ctns::oper_renorm coord=(9,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:11 S:9 H:1 P:81 Q:90 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3913:2.985e-02MB:2.915e-05GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:4.866e+01S Sys:1.215e+00S Total:4.987e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=192 : 8.043e-04 S -----
rank=0 GPUmem(GB): used=0.00013 (oper)=8.04e-05
rank=0 GPUmem(GB): used=0.00013 (oper,site)(GB)=8.04e-05,4.77e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=192
 no. of rintermediate operators=288
 no. of coefficients=2880:0.022MB:2.15e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.264e-04 S -----
rank=0 GPUmem(GB): used=0.000152 (oper,site,rinter)=8.04e-05,4.77e-07,2.15e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.004 S size(rtasks)=192 size(Rlst2)=25 T(Rmu/Rlist)=0.000231,0.00377 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00421 S size(rtasks)=192 size(Rlst)=5087 -----
rank=0 GPUmem(GB): used=0.000152 (oper,site,rinter,batch)=8.04e-05,4.77e-07,2.15e-05,0.0014 blksize=16 blksize0=4 batchsize=5087
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.77e-05,0.000546,0.00026
--- TIMING FOR renorm : t_inter=9.8e-05 t_gemm=5.5e-04 t_reduction=2.6e-04 tot=9.0e-04 ---
 renorm[inter] counter=27 t=9.8e-05 per=1.1e+01 cost=1.4e+05 flops=1.4e+09
 renorm[gemm] counter=27 i=0 t=2.9e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=1 t=2.2e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=2 t=1.4e-04 per=1.5e+01 cost=1.8e+04 flops=1.3e+08
 renorm[gemm] counter=27 i=3 t=1.7e-04 per=1.9e+01 cost=1.1e+05 flops=6.3e+08
 renorm[gemm] counter=27 i=4 t=2.3e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=5 t=2.2e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=27 i=6 t=2.3e-04 per=2.5e+01 cost=1.7e+05 flops=7.3e+08
 renorm[gemm] counter=27 total t=5.5e-04 per=6.0e+01 cost=2.9e+05 flops=5.4e+08
 renorm[red] counter=27 t=2.6e-04 per=2.9e+01 cost=5.4e+04 flops=2.1e+08
--- TIMING FOR renorm_tot : t_inter=3.9e-03 t_gemm=1.8e-02 t_reduction=6.9e-03 tot=2.9e-02 ---
 renorm_tot[inter] counter=27 t=3.9e-03 per=1.3e+01 cost=2.8e+06 flops=7.3e+08
 renorm_tot[gemm] counter=27 i=0 t=7.6e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=27 i=1 t=6.2e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=27 i=2 t=2.3e-03 per=8.0e+00 cost=1.6e+05 flops=6.6e+07
 renorm_tot[gemm] counter=27 i=3 t=2.5e-03 per=8.7e+00 cost=4.1e+05 flops=1.6e+08
 renorm_tot[gemm] counter=27 i=4 t=3.6e-03 per=1.2e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=27 i=5 t=3.6e-03 per=1.2e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=27 i=6 t=6.3e-03 per=2.1e+01 cost=1.6e+06 flops=2.5e+08
 renorm_tot[gemm] counter=27 total t=1.8e-02 per=6.3e+01 cost=2.9e+06 flops=1.6e+08
 renorm_tot[red] counter=27 t=6.9e-03 per=2.4e+01 cost=6.7e+05 flops=9.8e+07
qops.to_cpu: size(tot)=3913:3.0e-02MB:2.9e-05GB t[to_cpu]=2.2e-05S speed=1.3e+00GB/S
check ||H-H.dagger||=2.013e-14 coord=(9,0) rank=0
ctns::oper_ab2pq coord=(9,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0104 S rank=0 -----
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:4.868e+01S Sys:1.215e+00S Total:4.990e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=783:5.974e-03MB:5.834e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=40:3.052e-04MB:2.980e-07GB
total mem of comb=824:6.287e-03MB:6.139e-06GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:4.868e+01S Sys:1.215e+00S Total:4.990e+01S
##### local opt: 1.183e-01 S #####
 T(local opt: fetch) = 6.964e-03 S  per = 5.89  per(accum) = 5.89
 T(local opt: hdiag) = 1.027e-02 S  per = 8.68  per(accum) = 14.6
 T(local opt: dvdsn) = 8.010e-02 S  per = 67.7  per(accum) = 82.3
 T(local opt: decim) = 3.891e-03 S  per = 3.29  per(accum) = 85.6
 T(local opt: guess) = 1.144e-04 S  per = 0.0968  per(accum) = 85.7
 T(local opt: renrm) = 1.136e-02 S  per = 9.61  per(accum) = 95.3
 T(local opt: save ) = 5.551e-03 S  per = 4.69  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.010e-02 S  T(sum) = 7.922e-02 S  per = 9.890e+01
 T(local opt: preprocess                  ) = 6.184e-04 S  per = 0.781  per(accum) = 0.781
 T(local opt: symbolic_formulae           ) = 1.680e-03 S  per = 2.12  per(accum) = 2.9
 T(local opt: hintermediate init          ) = 5.432e-04 S  per = 0.686  per(accum) = 3.59
 T(local opt: preprocess_hformulae_Hxlist ) = 4.484e-02 S  per = 56.6  per(accum) = 60.2
 T(local opt: hmmtasks init               ) = 6.996e-03 S  per = 8.83  per(accum) = 69
 T(local opt: initial guess for dvdson    ) = 2.430e-04 S  per = 0.307  per(accum) = 69.3
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.277e-02 S  per = 28.7  per(accum) = 98.1
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.721e-04 S  per = 0.217  per(accum) = 98.3
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.490e-07 S  per = 0.000314  per(accum) = 98.3
 T(local opt: dvdson solver [rest part]   ) = 1.362e-03 S  per = 1.72  per(accum) = 100
Detailed decomposition of T(renrm) = 1.136e-02 S  T(sum) = 1.136e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.059e-04 S  per = 0.932  per(accum) = 0.932
 T(local opt: qops init                    ) = 6.149e-04 S  per = 5.41  per(accum) = 6.34
 T(local opt: symbolic_formulae_renorm     ) = 8.784e-04 S  per = 7.73  per(accum) = 14.1
 T(local opt: allocate qops on gpu         ) = 9.360e-05 S  per = 0.824  per(accum) = 14.9
 T(local opt: site memcpy cpu2gpu          ) = 8.410e-05 S  per = 0.74  per(accum) = 15.6
 T(local opt: rintermediate init           ) = 4.642e-04 S  per = 4.08  per(accum) = 19.7
 T(local opt: preprocess_formulae_Rlist2   ) = 4.296e-03 S  per = 37.8  per(accum) = 57.5
 T(local opt: rmmtasks init                ) = 1.255e-03 S  per =   11  per(accum) = 68.6
 T(local opt: qops memset on cpu           ) = 5.600e-08 S  per = 0.000493  per(accum) = 68.6
 T(local opt: preprocess_renorm_batchGPU   ) = 2.569e-03 S  per = 22.6  per(accum) = 91.2
 T(local opt: reduction of opS & opH [nccl]) = 4.860e-07 S  per = 0.00428  per(accum) = 91.2
 T(local opt: qops memcpy gpu2cpu          ) = 8.948e-05 S  per = 0.787  per(accum) = 92
 T(local opt: deallocate cpu and gpu memory) = 9.702e-06 S  per = 0.0854  per(accum) = 92.1
 T(local opt: reduction of opS & opH [comm]) = 8.148e-05 S  per = 0.717  per(accum) = 92.8
 T(local opt: conversion from opAB to opPQ ) = 7.297e-05 S  per = 0.642  per(accum) = 93.4
 T(local opt: after oper_renorm            ) = 7.485e-04 S  per = 6.59  per(accum) = 100
##### sweep opt: 2.389e+00 S #####
 T(sweep opt: fetch) = 1.755e-01 S  per = 7.35  per(accum) = 7.35
 T(sweep opt: hdiag) = 1.543e-01 S  per = 6.46  per(accum) = 13.8
 T(sweep opt: dvdsn) = 1.591e+00 S  per = 66.6  per(accum) = 80.4
 T(sweep opt: decim) = 1.013e-01 S  per = 4.24  per(accum) = 84.6
 T(sweep opt: guess) = 3.203e-03 S  per = 0.134  per(accum) = 84.8
 T(sweep opt: renrm) = 2.414e-01 S  per = 10.1  per(accum) = 94.9
 T(sweep opt: save ) = 1.227e-01 S  per = 5.14  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.591e+00 S  T(sum) = 1.566e+00 S  per = 9.847e+01
 T(sweep opt: preprocess                  ) = 1.732e-02 S  per = 1.11  per(accum) = 1.11
 T(sweep opt: symbolic_formulae           ) = 2.937e-02 S  per = 1.88  per(accum) = 2.98
 T(sweep opt: hintermediate init          ) = 1.589e-02 S  per = 1.01  per(accum) = 4
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.771e-01 S  per = 43.2  per(accum) = 47.2
 T(sweep opt: hmmtasks init               ) = 1.150e-01 S  per = 7.35  per(accum) = 54.6
 T(sweep opt: initial guess for dvdson    ) = 6.613e-03 S  per = 0.422  per(accum) = 55
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 6.524e-01 S  per = 41.7  per(accum) = 96.6
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.802e-03 S  per = 0.307  per(accum) = 97
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 7.649e-06 S  per = 0.000488  per(accum) = 97
 T(sweep opt: dvdson solver [rest part]   ) = 4.769e-02 S  per = 3.04  per(accum) = 100
Detailed decomposition of T(renrm) = 2.414e-01 S  T(sum) = 2.414e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.233e-03 S  per = 1.34  per(accum) = 1.34
 T(sweep opt: qops init                    ) = 1.285e-02 S  per = 5.32  per(accum) = 6.66
 T(sweep opt: symbolic_formulae_renorm     ) = 1.334e-02 S  per = 5.53  per(accum) = 12.2
 T(sweep opt: allocate qops on gpu         ) = 2.578e-03 S  per = 1.07  per(accum) = 13.3
 T(sweep opt: site memcpy cpu2gpu          ) = 2.443e-03 S  per = 1.01  per(accum) = 14.3
 T(sweep opt: rintermediate init           ) = 1.287e-02 S  per = 5.33  per(accum) = 19.6
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.779e-02 S  per = 23.9  per(accum) = 43.5
 T(sweep opt: rmmtasks init                ) = 1.871e-02 S  per = 7.75  per(accum) = 51.3
 T(sweep opt: qops memset on cpu           ) = 1.335e-06 S  per = 0.000553  per(accum) = 51.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.801e-02 S  per = 32.3  per(accum) = 83.6
 T(sweep opt: reduction of opS & opH [nccl]) = 1.585e-05 S  per = 0.00656  per(accum) = 83.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.782e-03 S  per = 1.15  per(accum) = 84.8
 T(sweep opt: deallocate cpu and gpu memory) = 4.151e-04 S  per = 0.172  per(accum) = 84.9
 T(sweep opt: reduction of opS & opH [comm]) = 2.574e-03 S  per = 1.07  per(accum) = 86
 T(sweep opt: conversion from opAB to opPQ ) = 1.423e-02 S  per =  5.9  per(accum) = 91.9
 T(sweep opt: after oper_renorm            ) = 1.954e-02 S  per = 8.09  per(accum) = 100
##### global opt: 2.389e+00 S #####
 T(global opt: fetch) = 1.755e-01 S  per = 7.35  per(accum) = 7.35
 T(global opt: hdiag) = 1.543e-01 S  per = 6.46  per(accum) = 13.8
 T(global opt: dvdsn) = 1.591e+00 S  per = 66.6  per(accum) = 80.4
 T(global opt: decim) = 1.013e-01 S  per = 4.24  per(accum) = 84.6
 T(global opt: guess) = 3.203e-03 S  per = 0.134  per(accum) = 84.8
 T(global opt: renrm) = 2.414e-01 S  per = 10.1  per(accum) = 94.9
 T(global opt: save ) = 1.227e-01 S  per = 5.14  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.591e+00 S  T(sum) = 1.566e+00 S  per = 9.847e+01
 T(global opt: preprocess                  ) = 1.732e-02 S  per = 1.11  per(accum) = 1.11
 T(global opt: symbolic_formulae           ) = 2.937e-02 S  per = 1.88  per(accum) = 2.98
 T(global opt: hintermediate init          ) = 1.589e-02 S  per = 1.01  per(accum) = 4
 T(global opt: preprocess_hformulae_Hxlist ) = 6.771e-01 S  per = 43.2  per(accum) = 47.2
 T(global opt: hmmtasks init               ) = 1.150e-01 S  per = 7.35  per(accum) = 54.6
 T(global opt: initial guess for dvdson    ) = 6.613e-03 S  per = 0.422  per(accum) = 55
 T(global opt: dvdson solver [Hx_batchGPU] ) = 6.524e-01 S  per = 41.7  per(accum) = 96.6
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.802e-03 S  per = 0.307  per(accum) = 97
 T(global opt: dvdson solver [comm(cpu)]   ) = 7.649e-06 S  per = 0.000488  per(accum) = 97
 T(global opt: dvdson solver [rest part]   ) = 4.769e-02 S  per = 3.04  per(accum) = 100
Detailed decomposition of T(renrm) = 2.414e-01 S  T(sum) = 2.414e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.233e-03 S  per = 1.34  per(accum) = 1.34
 T(global opt: qops init                    ) = 1.285e-02 S  per = 5.32  per(accum) = 6.66
 T(global opt: symbolic_formulae_renorm     ) = 1.334e-02 S  per = 5.53  per(accum) = 12.2
 T(global opt: allocate qops on gpu         ) = 2.578e-03 S  per = 1.07  per(accum) = 13.3
 T(global opt: site memcpy cpu2gpu          ) = 2.443e-03 S  per = 1.01  per(accum) = 14.3
 T(global opt: rintermediate init           ) = 1.287e-02 S  per = 5.33  per(accum) = 19.6
 T(global opt: preprocess_formulae_Rlist2   ) = 5.779e-02 S  per = 23.9  per(accum) = 43.5
 T(global opt: rmmtasks init                ) = 1.871e-02 S  per = 7.75  per(accum) = 51.3
 T(global opt: qops memset on cpu           ) = 1.335e-06 S  per = 0.000553  per(accum) = 51.3
 T(global opt: preprocess_renorm_batchGPU   ) = 7.801e-02 S  per = 32.3  per(accum) = 83.6
 T(global opt: reduction of opS & opH [nccl]) = 1.585e-05 S  per = 0.00656  per(accum) = 83.6
 T(global opt: qops memcpy gpu2cpu          ) = 2.782e-03 S  per = 1.15  per(accum) = 84.8
 T(global opt: deallocate cpu and gpu memory) = 4.151e-04 S  per = 0.172  per(accum) = 84.9
 T(global opt: reduction of opS & opH [comm]) = 2.574e-03 S  per = 1.07  per(accum) = 86
 T(global opt: conversion from opAB to opPQ ) = 1.423e-02 S  per =  5.9  per(accum) = 91.9
 T(global opt: after oper_renorm            ) = 1.954e-02 S  per = 8.09  per(accum) = 100

isweep=0 ibond=27/seqsize=34 dots=2 dbond=(7,0)-(8,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:4.869e+01S Sys:1.215e+00S Total:4.990e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=783:5.974e-03MB:5.834e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=40:3.052e-04MB:2.980e-07GB
total mem of comb=824:6.287e-03MB:6.139e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=7,11,1,1
 suppl= 0 1 2 3 4 16 17
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 18
 suppc2= 19
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:7 S:13 H:1 A:49 B:56 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=2536:1.935e-02MB:1.889e-05GB
 rqops: oplist=CSHPQ nops=C:11 S:9 H:1 P:81 Q:90 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3913:2.985e-02MB:2.915e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=8445:6.443e-02MB:6.292e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(8,0) fdel=./scratch/sweep/lop(7,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=52:3.967e-04MB
qtensor4: wf4 own=1 _data=0x55a31edcadf0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=10
 (10,2):4 (10,0):3 (9,3):1 (10,4):1 (9,1):1
 qbond: qcol nsym=5 dimAll=10
 (16,2):4 (16,0):3 (16,4):1 (17,3):1 (17,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=13 nblocks=361 size=52:3.967e-04MB
### DIAG TIMING: total=4.884e-03 t1=9.026e-06, t2=1.342e-05, t3=1.692e-05, t4=4.818e-03, t5=4.152e-06, t6=1.785e-05, t7=4.157e-06
duration_diagGPU:4.972e-03
duration_diagreduce:2.800e-08
duration_diagtransform:1.670e-07
----- TIMING FOR symbolic_formulae_twodot with size=716 : 1.342e-03 S -----
rank=0 GPUmem(GB): used=6.29e-05 (oper)=6.29e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=716
 no. of hintermediate operators=345
 no. of coefficients=4876:0.0372MB:3.63e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.414e-04 S -----
rank=0 GPUmem(GB): used=9.92e-05 (oper,hinter)=6.29e-05,3.63e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.011 S size(H_formulae)=716 size(Hxlst2)=13 T(Hmu/Hxlist)=0.000269,0.0108 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0113 S size(H_formulae)=716 size(Hxlst)=6922 -----
rank=0 GPUmem(GB): used=0.00263 (oper,hinter,dvdson,batch)=6.29e-05,3.63e-05,7.75e-07,0.00253 blksize=16 blksize0=16 batchsize=6922
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=52 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.17e-05,0.000187,0.00076,0.000431,0.00142
 ndim=52:3.87e-07GB t[comm(intra)]=2.45e-05 speed=0.0317GB/S t[comm(inter)]=7.2e-06 speed=0.108GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=7.6e-04 t_reduction=4.3e-04 tot=1.4e-03 ---
 sigma[inter] counter=168 t=1.9e-04 per=1.4e+01 cost=4.2e+05 flops=2.2e+09
 sigma[gemm] counter=168 i=0 t=2.7e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=1 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=2 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=3 t=2.2e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=4 t=2.0e-04 per=1.4e+01 cost=4.3e+04 flops=2.2e+08
 sigma[gemm] counter=168 i=5 t=2.0e-04 per=1.4e+01 cost=4.5e+04 flops=2.3e+08
 sigma[gemm] counter=168 i=6 t=1.7e-04 per=1.3e+01 cost=9.1e+04 flops=5.2e+08
 sigma[gemm] counter=168 i=7 t=1.8e-04 per=1.3e+01 cost=9.2e+04 flops=5.1e+08
 sigma[gemm] counter=168 total t=7.6e-04 per=5.5e+01 cost=2.7e+05 flops=3.6e+08
 sigma[red] counter=168 t=4.3e-04 per=3.1e+01 cost=6.4e+04 flops=1.5e+08
--- TIMING FOR sigma_tot : t_inter=3.0e-02 t_gemm=1.4e-01 t_reduction=1.4e-01 tot=3.1e-01 ---
 sigma_tot[inter] counter=168 t=3.0e-02 per=9.7e+00 cost=1.5e+08 flops=4.9e+09
 sigma_tot[gemm] counter=168 i=0 t=4.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=1 t=3.8e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=2 t=3.8e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=3 t=3.7e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=4 t=3.4e-02 per=1.1e+01 cost=2.9e+07 flops=8.6e+08
 sigma_tot[gemm] counter=168 i=5 t=3.7e-02 per=1.2e+01 cost=2.9e+07 flops=8.0e+08
 sigma_tot[gemm] counter=168 i=6 t=3.6e-02 per=1.2e+01 cost=2.5e+07 flops=7.0e+08
 sigma_tot[gemm] counter=168 i=7 t=3.5e-02 per=1.1e+01 cost=2.7e+07 flops=7.6e+08
 sigma_tot[gemm] counter=168 total t=1.4e-01 per=4.6e+01 cost=1.1e+08 flops=7.7e+08
 sigma_tot[red] counter=168 t=1.4e-01 per=4.4e+01 cost=2.7e+07 flops=2.0e+08
T(sub)=7.7e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,2.9e-06,1.1e-06,8.7e-07,2.3e-07
settings: ndim=52 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.332314928371 -1.116e+03  3.331e-02    1     1  3.395e-03 3.395e-03 3.233e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.894e-05,1.530e-04,6.350e-04,4.050e-04,1.227e-03
 ndim=52:3.874e-07GB t[comm(intra)]=2.318e-05 speed=3.342e-02GB/S t[comm(inter)]=5.752e-06 speed=1.347e-01GB/S
--- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=6.3e-04 t_reduction=4.0e-04 tot=1.2e-03 ---
 sigma[inter] counter=169 t=1.5e-04 per=1.3e+01 cost=4.2e+05 flops=2.7e+09
 sigma[gemm] counter=169 i=0 t=2.7e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=1 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=2 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=3 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=4 t=1.6e-04 per=1.4e+01 cost=4.3e+04 flops=2.7e+08
 sigma[gemm] counter=169 i=5 t=1.5e-04 per=1.2e+01 cost=4.5e+04 flops=3.1e+08
 sigma[gemm] counter=169 i=6 t=1.5e-04 per=1.3e+01 cost=9.1e+04 flops=5.9e+08
 sigma[gemm] counter=169 i=7 t=1.6e-04 per=1.4e+01 cost=9.2e+04 flops=5.6e+08
 sigma[gemm] counter=169 total t=6.3e-04 per=5.3e+01 cost=2.7e+05 flops=4.3e+08
 sigma[red] counter=169 t=4.0e-04 per=3.4e+01 cost=6.4e+04 flops=1.6e+08
--- TIMING FOR sigma_tot : t_inter=3.0e-02 t_gemm=1.4e-01 t_reduction=1.4e-01 tot=3.1e-01 ---
 sigma_tot[inter] counter=169 t=3.0e-02 per=9.8e+00 cost=1.5e+08 flops=4.9e+09
 sigma_tot[gemm] counter=169 i=0 t=4.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=1 t=3.8e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=2 t=3.8e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=3 t=3.8e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=4 t=3.4e-02 per=1.1e+01 cost=2.9e+07 flops=8.6e+08
 sigma_tot[gemm] counter=169 i=5 t=3.7e-02 per=1.2e+01 cost=3.0e+07 flops=8.0e+08
 sigma_tot[gemm] counter=169 i=6 t=3.6e-02 per=1.2e+01 cost=2.5e+07 flops=7.0e+08
 sigma_tot[gemm] counter=169 i=7 t=3.5e-02 per=1.1e+01 cost=2.7e+07 flops=7.6e+08
 sigma_tot[gemm] counter=169 total t=1.4e-01 per=4.6e+01 cost=1.1e+08 flops=7.7e+08
 sigma_tot[red] counter=169 t=1.4e-01 per=4.4e+01 cost=2.7e+07 flops=2.0e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,9.4e-06,2.1e-06,1.0e-06,2.2e-07
    2   0 -    -116.335303794645 -2.989e-03  9.109e-03    2     2  6.821e-03 3.411e-03 3.093e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.813e-05,1.524e-04,6.314e-04,4.021e-04,1.219e-03
 ndim=52:3.874e-07GB t[comm(intra)]=2.297e-05 speed=3.373e-02GB/S t[comm(inter)]=5.163e-06 speed=1.501e-01GB/S
--- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=6.3e-04 t_reduction=4.0e-04 tot=1.2e-03 ---
 sigma[inter] counter=170 t=1.5e-04 per=1.3e+01 cost=4.2e+05 flops=2.7e+09
 sigma[gemm] counter=170 i=0 t=2.7e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=1 t=2.3e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=2 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=3 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=4 t=1.5e-04 per=1.3e+01 cost=4.3e+04 flops=2.8e+08
 sigma[gemm] counter=170 i=5 t=1.5e-04 per=1.2e+01 cost=4.5e+04 flops=3.1e+08
 sigma[gemm] counter=170 i=6 t=1.5e-04 per=1.3e+01 cost=9.1e+04 flops=5.9e+08
 sigma[gemm] counter=170 i=7 t=1.7e-04 per=1.4e+01 cost=9.2e+04 flops=5.5e+08
 sigma[gemm] counter=170 total t=6.3e-04 per=5.3e+01 cost=2.7e+05 flops=4.3e+08
 sigma[red] counter=170 t=4.0e-04 per=3.4e+01 cost=6.4e+04 flops=1.6e+08
--- TIMING FOR sigma_tot : t_inter=3.0e-02 t_gemm=1.4e-01 t_reduction=1.4e-01 tot=3.1e-01 ---
 sigma_tot[inter] counter=170 t=3.0e-02 per=9.8e+00 cost=1.5e+08 flops=4.9e+09
 sigma_tot[gemm] counter=170 i=0 t=4.4e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=1 t=3.8e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=2 t=3.8e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=3 t=3.8e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=4 t=3.4e-02 per=1.1e+01 cost=3.0e+07 flops=8.6e+08
 sigma_tot[gemm] counter=170 i=5 t=3.7e-02 per=1.2e+01 cost=3.0e+07 flops=7.9e+08
 sigma_tot[gemm] counter=170 i=6 t=3.6e-02 per=1.2e+01 cost=2.5e+07 flops=7.0e+08
 sigma_tot[gemm] counter=170 i=7 t=3.5e-02 per=1.1e+01 cost=2.7e+07 flops=7.6e+08
 sigma_tot[gemm] counter=170 total t=1.4e-01 per=4.6e+01 cost=1.1e+08 flops=7.7e+08
 sigma_tot[red] counter=170 t=1.4e-01 per=4.4e+01 cost=2.7e+07 flops=2.0e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.2e-05,1.7e-06,9.5e-07,1.7e-07
    3   0 -    -116.335522245947 -2.185e-04  2.815e-03    3     3  9.940e-03 3.313e-03 3.046e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.743e-05,1.418e-04,6.302e-04,3.998e-04,1.204e-03
 ndim=52:3.874e-07GB t[comm(intra)]=2.236e-05 speed=3.466e-02GB/S t[comm(inter)]=5.069e-06 speed=1.529e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=6.3e-04 t_reduction=4.0e-04 tot=1.2e-03 ---
 sigma[inter] counter=171 t=1.4e-04 per=1.2e+01 cost=4.2e+05 flops=2.9e+09
 sigma[gemm] counter=171 i=0 t=2.4e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=1 t=2.3e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=2 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=3 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=4 t=1.6e-04 per=1.4e+01 cost=4.3e+04 flops=2.7e+08
 sigma[gemm] counter=171 i=5 t=1.4e-04 per=1.2e+01 cost=4.5e+04 flops=3.3e+08
 sigma[gemm] counter=171 i=6 t=1.6e-04 per=1.3e+01 cost=9.1e+04 flops=5.8e+08
 sigma[gemm] counter=171 i=7 t=1.7e-04 per=1.4e+01 cost=9.2e+04 flops=5.6e+08
 sigma[gemm] counter=171 total t=6.3e-04 per=5.4e+01 cost=2.7e+05 flops=4.3e+08
 sigma[red] counter=171 t=4.0e-04 per=3.4e+01 cost=6.4e+04 flops=1.6e+08
--- TIMING FOR sigma_tot : t_inter=3.1e-02 t_gemm=1.5e-01 t_reduction=1.4e-01 tot=3.1e-01 ---
 sigma_tot[inter] counter=171 t=3.1e-02 per=9.8e+00 cost=1.5e+08 flops=4.9e+09
 sigma_tot[gemm] counter=171 i=0 t=4.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=1 t=3.9e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=2 t=3.8e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=3 t=3.8e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=4 t=3.5e-02 per=1.1e+01 cost=3.0e+07 flops=8.5e+08
 sigma_tot[gemm] counter=171 i=5 t=3.7e-02 per=1.2e+01 cost=3.0e+07 flops=7.9e+08
 sigma_tot[gemm] counter=171 i=6 t=3.6e-02 per=1.2e+01 cost=2.5e+07 flops=7.0e+08
 sigma_tot[gemm] counter=171 i=7 t=3.6e-02 per=1.1e+01 cost=2.7e+07 flops=7.5e+08
 sigma_tot[gemm] counter=171 total t=1.5e-01 per=4.6e+01 cost=1.1e+08 flops=7.7e+08
 sigma_tot[red] counter=171 t=1.4e-01 per=4.4e+01 cost=2.7e+07 flops=2.0e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.0e-05,1.5e-06,7.4e-07,1.5e-07
    4   0 -    -116.335546244339 -2.400e-05  9.969e-04    3     4  1.304e-02 3.260e-03 3.018e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.773e-05,1.416e-04,6.212e-04,4.155e-04,1.210e-03
 ndim=52:3.874e-07GB t[comm(intra)]=2.261e-05 speed=3.427e-02GB/S t[comm(inter)]=5.124e-06 speed=1.512e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=6.2e-04 t_reduction=4.2e-04 tot=1.2e-03 ---
 sigma[inter] counter=172 t=1.4e-04 per=1.2e+01 cost=4.2e+05 flops=3.0e+09
 sigma[gemm] counter=172 i=0 t=2.4e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=1 t=2.3e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=2 t=2.3e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=3 t=2.3e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=4 t=1.6e-04 per=1.3e+01 cost=4.3e+04 flops=2.7e+08
 sigma[gemm] counter=172 i=5 t=1.4e-04 per=1.2e+01 cost=4.5e+04 flops=3.3e+08
 sigma[gemm] counter=172 i=6 t=1.5e-04 per=1.3e+01 cost=9.1e+04 flops=5.9e+08
 sigma[gemm] counter=172 i=7 t=1.6e-04 per=1.4e+01 cost=9.2e+04 flops=5.7e+08
 sigma[gemm] counter=172 total t=6.2e-04 per=5.3e+01 cost=2.7e+05 flops=4.4e+08
 sigma[red] counter=172 t=4.2e-04 per=3.5e+01 cost=6.4e+04 flops=1.6e+08
--- TIMING FOR sigma_tot : t_inter=3.1e-02 t_gemm=1.5e-01 t_reduction=1.4e-01 tot=3.1e-01 ---
 sigma_tot[inter] counter=172 t=3.1e-02 per=9.8e+00 cost=1.5e+08 flops=4.9e+09
 sigma_tot[gemm] counter=172 i=0 t=4.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=1 t=3.9e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=2 t=3.8e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=3 t=3.8e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=4 t=3.5e-02 per=1.1e+01 cost=3.0e+07 flops=8.5e+08
 sigma_tot[gemm] counter=172 i=5 t=3.8e-02 per=1.2e+01 cost=3.0e+07 flops=7.9e+08
 sigma_tot[gemm] counter=172 i=6 t=3.6e-02 per=1.2e+01 cost=2.6e+07 flops=7.0e+08
 sigma_tot[gemm] counter=172 i=7 t=3.6e-02 per=1.1e+01 cost=2.7e+07 flops=7.5e+08
 sigma_tot[gemm] counter=172 total t=1.5e-01 per=4.7e+01 cost=1.1e+08 flops=7.7e+08
 sigma_tot[red] counter=172 t=1.4e-01 per=4.4e+01 cost=2.7e+07 flops=2.0e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.0e-05,1.6e-06,8.2e-07,1.4e-07
    5   0 -    -116.335549638719 -3.394e-06  2.545e-04    3     5  1.614e-02 3.228e-03 3.003e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.794e-05,1.420e-04,6.189e-04,4.141e-04,1.207e-03
 ndim=52:3.874e-07GB t[comm(intra)]=2.287e-05 speed=3.389e-02GB/S t[comm(inter)]=5.074e-06 speed=1.527e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=6.2e-04 t_reduction=4.1e-04 tot=1.2e-03 ---
 sigma[inter] counter=173 t=1.4e-04 per=1.2e+01 cost=4.2e+05 flops=2.9e+09
 sigma[gemm] counter=173 i=0 t=2.3e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=1 t=2.3e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=2 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=3 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=4 t=1.6e-04 per=1.3e+01 cost=4.3e+04 flops=2.7e+08
 sigma[gemm] counter=173 i=5 t=1.4e-04 per=1.2e+01 cost=4.5e+04 flops=3.2e+08
 sigma[gemm] counter=173 i=6 t=1.6e-04 per=1.3e+01 cost=9.1e+04 flops=5.9e+08
 sigma[gemm] counter=173 i=7 t=1.6e-04 per=1.3e+01 cost=9.2e+04 flops=5.9e+08
 sigma[gemm] counter=173 total t=6.2e-04 per=5.3e+01 cost=2.7e+05 flops=4.4e+08
 sigma[red] counter=173 t=4.1e-04 per=3.5e+01 cost=6.4e+04 flops=1.6e+08
--- TIMING FOR sigma_tot : t_inter=3.1e-02 t_gemm=1.5e-01 t_reduction=1.4e-01 tot=3.2e-01 ---
 sigma_tot[inter] counter=173 t=3.1e-02 per=9.8e+00 cost=1.5e+08 flops=4.9e+09
 sigma_tot[gemm] counter=173 i=0 t=4.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=1 t=3.9e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=2 t=3.9e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=3 t=3.8e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=4 t=3.5e-02 per=1.1e+01 cost=3.0e+07 flops=8.5e+08
 sigma_tot[gemm] counter=173 i=5 t=3.8e-02 per=1.2e+01 cost=3.0e+07 flops=7.9e+08
 sigma_tot[gemm] counter=173 i=6 t=3.7e-02 per=1.2e+01 cost=2.6e+07 flops=7.0e+08
 sigma_tot[gemm] counter=173 i=7 t=3.6e-02 per=1.1e+01 cost=2.7e+07 flops=7.5e+08
 sigma_tot[gemm] counter=173 total t=1.5e-01 per=4.7e+01 cost=1.1e+08 flops=7.6e+08
 sigma_tot[red] counter=173 t=1.4e-01 per=4.4e+01 cost=2.7e+07 flops=2.0e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,9.9e-06,1.6e-06,8.2e-07,1.4e-07
    6   0 +    -116.335549867109 -2.284e-07  8.407e-05    3     6  1.920e-02 3.200e-03 2.984e-03
TIMING FOR Davidson : 1.927e-02  T(cal/comm/rest)=1.791e-02,2.230e-07,1.363e-03
decomposed t_rest=1.363e-03
 T(sub)    =9.162e-05 per=6.722e+00
 T(precond)=1.554e-04 per=1.140e+01
 T(ortho)  =7.559e-06 per=5.546e-01
 T(xcopy)  =6.950e-07 per=5.099e-02
 T(xnrm2)  =9.480e-07 per=6.955e-02
 T(other)  =1.107e-03 per=8.120e+01
optimized energies: isweep=0 ibond=27 dots=2 e[0]=-116.335549867109 nmvp=6
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:4.964e+01S Sys:1.215e+00S Total:5.085e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond27.txt
 qbond: qsuper nsym=11 dimAll=37
 (16,2):4 (16,0):3 (16,4):1 (17,3):6 (17,1):8 (18,2):6 (18,0):4 (18,4):2 (19,3):1 (19,1):1 (17,5):1
----- TMING FOR decimation_genbasis(su2): 5.8e-05 S -----
decimation summary: 37->10 dwt=-2.220e-16 SvN=1.560e+00
 qbond: qkept nsym=5 dimAll=10
 (18,2):4 (18,0):3 (18,4):1 (19,3):1 (19,1):1
----- TIMING for decimation_row(nkr): 3.232e-03 S T(decim/select/formRot)=3.156e-04,2.772e-03,1.442e-04 -----
----- TIMING FOR twodot_decimation: 3.474e-03 S T(wf/decim)=1.555e-04,3.319e-03 -----
ctns::oper_renorm coord=(8,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:12 S:8 H:1 P:64 Q:72 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3184:2.429e-02MB:2.372e-05GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:4.989e+01S Sys:1.215e+00S Total:5.111e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=157 : 6.511e-04 S -----
rank=0 GPUmem(GB): used=0.000104 (oper)=6.03e-05
rank=0 GPUmem(GB): used=0.000104 (oper,site)(GB)=6.03e-05,2.98e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=157
 no. of rintermediate operators=232
 no. of coefficients=2552:0.0195MB:1.9e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.983e-04 S -----
rank=0 GPUmem(GB): used=0.000123 (oper,site,rinter)=6.03e-05,2.98e-07,1.9e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00241 S size(rtasks)=157 size(Rlst2)=25 T(Rmu/Rlist)=0.000199,0.00221 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00256 S size(rtasks)=157 size(Rlst)=2906 -----
rank=0 GPUmem(GB): used=0.000123 (oper,site,rinter,batch)=6.03e-05,2.98e-07,1.9e-05,0.000801 blksize=16 blksize0=4 batchsize=2906
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000106,0.000568,0.000172
--- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=5.7e-04 t_reduction=1.7e-04 tot=8.4e-04 ---
 renorm[inter] counter=28 t=1.1e-04 per=1.2e+01 cost=5.4e+04 flops=5.2e+08
 renorm[gemm] counter=28 i=0 t=2.8e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=1 t=2.2e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=2 t=1.7e-04 per=2.0e+01 cost=9.4e+03 flops=5.6e+07
 renorm[gemm] counter=28 i=3 t=1.9e-04 per=2.3e+01 cost=3.4e+04 flops=1.8e+08
 renorm[gemm] counter=28 i=4 t=2.3e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=5 t=2.2e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=28 i=6 t=2.0e-04 per=2.4e+01 cost=9.1e+04 flops=4.5e+08
 renorm[gemm] counter=28 total t=5.7e-04 per=6.7e+01 cost=1.3e+05 flops=2.4e+08
 renorm[red] counter=28 t=1.7e-04 per=2.0e+01 cost=4.8e+04 flops=2.8e+08
--- TIMING FOR renorm_tot : t_inter=4.0e-03 t_gemm=1.9e-02 t_reduction=7.1e-03 tot=3.0e-02 ---
 renorm_tot[inter] counter=28 t=4.0e-03 per=1.3e+01 cost=2.9e+06 flops=7.2e+08
 renorm_tot[gemm] counter=28 i=0 t=7.9e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=28 i=1 t=6.4e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=28 i=2 t=2.5e-03 per=8.3e+00 cost=1.6e+05 flops=6.6e+07
 renorm_tot[gemm] counter=28 i=3 t=2.7e-03 per=9.1e+00 cost=4.4e+05 flops=1.6e+08
 renorm_tot[gemm] counter=28 i=4 t=3.6e-03 per=1.2e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=28 i=5 t=3.6e-03 per=1.2e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=28 i=6 t=6.5e-03 per=2.1e+01 cost=1.7e+06 flops=2.6e+08
 renorm_tot[gemm] counter=28 total t=1.9e-02 per=6.3e+01 cost=3.0e+06 flops=1.6e+08
 renorm_tot[red] counter=28 t=7.1e-03 per=2.3e+01 cost=7.2e+05 flops=1.0e+08
qops.to_cpu: size(tot)=3184:2.4e-02MB:2.4e-05GB t[to_cpu]=2.2e-05S speed=1.1e+00GB/S
check ||H-H.dagger||=1.997e-15 coord=(8,0) rank=0
ctns::oper_ab2pq coord=(8,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0079 S rank=0 -----
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.006e+01S Sys:1.215e+00S Total:5.127e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=783:5.974e-03MB:5.834e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=40:3.052e-04MB:2.980e-07GB
total mem of comb=824:6.287e-03MB:6.139e-06GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.006e+01S Sys:1.215e+00S Total:5.128e+01S
##### local opt: 6.628e-02 S #####
 T(local opt: fetch) = 6.608e-03 S  per = 9.97  per(accum) = 9.97
 T(local opt: hdiag) = 5.802e-03 S  per = 8.75  per(accum) = 18.7
 T(local opt: dvdsn) = 3.621e-02 S  per = 54.6  per(accum) = 73.4
 T(local opt: decim) = 3.559e-03 S  per = 5.37  per(accum) = 78.7
 T(local opt: guess) = 1.160e-04 S  per = 0.175  per(accum) = 78.9
 T(local opt: renrm) = 8.771e-03 S  per = 13.2  per(accum) = 92.1
 T(local opt: save ) = 5.205e-03 S  per = 7.85  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.621e-02 S  T(sum) = 3.537e-02 S  per = 9.766e+01
 T(local opt: preprocess                  ) = 6.964e-04 S  per = 1.97  per(accum) = 1.97
 T(local opt: symbolic_formulae           ) = 1.423e-03 S  per = 4.02  per(accum) = 5.99
 T(local opt: hintermediate init          ) = 5.547e-04 S  per = 1.57  per(accum) = 7.56
 T(local opt: preprocess_hformulae_Hxlist ) = 1.136e-02 S  per = 32.1  per(accum) = 39.7
 T(local opt: hmmtasks init               ) = 1.808e-03 S  per = 5.11  per(accum) = 44.8
 T(local opt: initial guess for dvdson    ) = 2.540e-04 S  per = 0.718  per(accum) = 45.5
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.774e-02 S  per = 50.1  per(accum) = 95.7
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.718e-04 S  per = 0.486  per(accum) = 96.1
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.230e-07 S  per = 0.000631  per(accum) = 96.1
 T(local opt: dvdson solver [rest part]   ) = 1.363e-03 S  per = 3.85  per(accum) = 100
Detailed decomposition of T(renrm) = 8.771e-03 S  T(sum) = 8.771e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.121e-04 S  per = 1.28  per(accum) = 1.28
 T(local opt: qops init                    ) = 5.385e-04 S  per = 6.14  per(accum) = 7.42
 T(local opt: symbolic_formulae_renorm     ) = 7.232e-04 S  per = 8.25  per(accum) = 15.7
 T(local opt: allocate qops on gpu         ) = 8.433e-05 S  per = 0.961  per(accum) = 16.6
 T(local opt: site memcpy cpu2gpu          ) = 8.641e-05 S  per = 0.985  per(accum) = 17.6
 T(local opt: rintermediate init           ) = 4.351e-04 S  per = 4.96  per(accum) = 22.6
 T(local opt: preprocess_formulae_Rlist2   ) = 2.642e-03 S  per = 30.1  per(accum) = 52.7
 T(local opt: rmmtasks init                ) = 7.155e-04 S  per = 8.16  per(accum) = 60.9
 T(local opt: qops memset on cpu           ) = 4.800e-08 S  per = 0.000547  per(accum) = 60.9
 T(local opt: preprocess_renorm_batchGPU   ) = 2.488e-03 S  per = 28.4  per(accum) = 89.2
 T(local opt: reduction of opS & opH [nccl]) = 5.980e-07 S  per = 0.00682  per(accum) = 89.2
 T(local opt: qops memcpy gpu2cpu          ) = 9.403e-05 S  per = 1.07  per(accum) = 90.3
 T(local opt: deallocate cpu and gpu memory) = 1.058e-05 S  per = 0.121  per(accum) = 90.4
 T(local opt: reduction of opS & opH [comm]) = 8.299e-05 S  per = 0.946  per(accum) = 91.4
 T(local opt: conversion from opAB to opPQ ) = 7.055e-05 S  per = 0.804  per(accum) = 92.2
 T(local opt: after oper_renorm            ) = 6.873e-04 S  per = 7.84  per(accum) = 100
##### sweep opt: 2.455e+00 S #####
 T(sweep opt: fetch) = 1.821e-01 S  per = 7.42  per(accum) = 7.42
 T(sweep opt: hdiag) = 1.601e-01 S  per = 6.52  per(accum) = 13.9
 T(sweep opt: dvdsn) = 1.627e+00 S  per = 66.3  per(accum) = 80.2
 T(sweep opt: decim) = 1.049e-01 S  per = 4.27  per(accum) = 84.5
 T(sweep opt: guess) = 3.319e-03 S  per = 0.135  per(accum) = 84.6
 T(sweep opt: renrm) = 2.501e-01 S  per = 10.2  per(accum) = 94.8
 T(sweep opt: save ) = 1.279e-01 S  per = 5.21  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.627e+00 S  T(sum) = 1.602e+00 S  per = 9.845e+01
 T(sweep opt: preprocess                  ) = 1.802e-02 S  per = 1.12  per(accum) = 1.12
 T(sweep opt: symbolic_formulae           ) = 3.079e-02 S  per = 1.92  per(accum) = 3.05
 T(sweep opt: hintermediate init          ) = 1.644e-02 S  per = 1.03  per(accum) = 4.07
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.885e-01 S  per =   43  per(accum) = 47.1
 T(sweep opt: hmmtasks init               ) = 1.169e-01 S  per =  7.3  per(accum) = 54.4
 T(sweep opt: initial guess for dvdson    ) = 6.867e-03 S  per = 0.429  per(accum) = 54.8
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 6.702e-01 S  per = 41.8  per(accum) = 96.6
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.974e-03 S  per = 0.311  per(accum) = 96.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 7.872e-06 S  per = 0.000491  per(accum) = 96.9
 T(sweep opt: dvdson solver [rest part]   ) = 4.905e-02 S  per = 3.06  per(accum) = 100
Detailed decomposition of T(renrm) = 2.501e-01 S  T(sum) = 2.501e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.345e-03 S  per = 1.34  per(accum) = 1.34
 T(sweep opt: qops init                    ) = 1.339e-02 S  per = 5.35  per(accum) = 6.69
 T(sweep opt: symbolic_formulae_renorm     ) = 1.407e-02 S  per = 5.62  per(accum) = 12.3
 T(sweep opt: allocate qops on gpu         ) = 2.663e-03 S  per = 1.06  per(accum) = 13.4
 T(sweep opt: site memcpy cpu2gpu          ) = 2.529e-03 S  per = 1.01  per(accum) = 14.4
 T(sweep opt: rintermediate init           ) = 1.331e-02 S  per = 5.32  per(accum) = 19.7
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.043e-02 S  per = 24.2  per(accum) = 43.9
 T(sweep opt: rmmtasks init                ) = 1.942e-02 S  per = 7.76  per(accum) = 51.6
 T(sweep opt: qops memset on cpu           ) = 1.383e-06 S  per = 0.000553  per(accum) = 51.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.049e-02 S  per = 32.2  per(accum) = 83.8
 T(sweep opt: reduction of opS & opH [nccl]) = 1.644e-05 S  per = 0.00657  per(accum) = 83.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.876e-03 S  per = 1.15  per(accum) = 85
 T(sweep opt: deallocate cpu and gpu memory) = 4.257e-04 S  per = 0.17  per(accum) = 85.1
 T(sweep opt: reduction of opS & opH [comm]) = 2.657e-03 S  per = 1.06  per(accum) = 86.2
 T(sweep opt: conversion from opAB to opPQ ) = 1.430e-02 S  per = 5.72  per(accum) = 91.9
 T(sweep opt: after oper_renorm            ) = 2.022e-02 S  per = 8.09  per(accum) = 100
##### global opt: 2.455e+00 S #####
 T(global opt: fetch) = 1.821e-01 S  per = 7.42  per(accum) = 7.42
 T(global opt: hdiag) = 1.601e-01 S  per = 6.52  per(accum) = 13.9
 T(global opt: dvdsn) = 1.627e+00 S  per = 66.3  per(accum) = 80.2
 T(global opt: decim) = 1.049e-01 S  per = 4.27  per(accum) = 84.5
 T(global opt: guess) = 3.319e-03 S  per = 0.135  per(accum) = 84.6
 T(global opt: renrm) = 2.501e-01 S  per = 10.2  per(accum) = 94.8
 T(global opt: save ) = 1.279e-01 S  per = 5.21  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.627e+00 S  T(sum) = 1.602e+00 S  per = 9.845e+01
 T(global opt: preprocess                  ) = 1.802e-02 S  per = 1.12  per(accum) = 1.12
 T(global opt: symbolic_formulae           ) = 3.079e-02 S  per = 1.92  per(accum) = 3.05
 T(global opt: hintermediate init          ) = 1.644e-02 S  per = 1.03  per(accum) = 4.07
 T(global opt: preprocess_hformulae_Hxlist ) = 6.885e-01 S  per =   43  per(accum) = 47.1
 T(global opt: hmmtasks init               ) = 1.169e-01 S  per =  7.3  per(accum) = 54.4
 T(global opt: initial guess for dvdson    ) = 6.867e-03 S  per = 0.429  per(accum) = 54.8
 T(global opt: dvdson solver [Hx_batchGPU] ) = 6.702e-01 S  per = 41.8  per(accum) = 96.6
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.974e-03 S  per = 0.311  per(accum) = 96.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 7.872e-06 S  per = 0.000491  per(accum) = 96.9
 T(global opt: dvdson solver [rest part]   ) = 4.905e-02 S  per = 3.06  per(accum) = 100
Detailed decomposition of T(renrm) = 2.501e-01 S  T(sum) = 2.501e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.345e-03 S  per = 1.34  per(accum) = 1.34
 T(global opt: qops init                    ) = 1.339e-02 S  per = 5.35  per(accum) = 6.69
 T(global opt: symbolic_formulae_renorm     ) = 1.407e-02 S  per = 5.62  per(accum) = 12.3
 T(global opt: allocate qops on gpu         ) = 2.663e-03 S  per = 1.06  per(accum) = 13.4
 T(global opt: site memcpy cpu2gpu          ) = 2.529e-03 S  per = 1.01  per(accum) = 14.4
 T(global opt: rintermediate init           ) = 1.331e-02 S  per = 5.32  per(accum) = 19.7
 T(global opt: preprocess_formulae_Rlist2   ) = 6.043e-02 S  per = 24.2  per(accum) = 43.9
 T(global opt: rmmtasks init                ) = 1.942e-02 S  per = 7.76  per(accum) = 51.6
 T(global opt: qops memset on cpu           ) = 1.383e-06 S  per = 0.000553  per(accum) = 51.6
 T(global opt: preprocess_renorm_batchGPU   ) = 8.049e-02 S  per = 32.2  per(accum) = 83.8
 T(global opt: reduction of opS & opH [nccl]) = 1.644e-05 S  per = 0.00657  per(accum) = 83.8
 T(global opt: qops memcpy gpu2cpu          ) = 2.876e-03 S  per = 1.15  per(accum) = 85
 T(global opt: deallocate cpu and gpu memory) = 4.257e-04 S  per = 0.17  per(accum) = 85.1
 T(global opt: reduction of opS & opH [comm]) = 2.657e-03 S  per = 1.06  per(accum) = 86.2
 T(global opt: conversion from opAB to opPQ ) = 1.430e-02 S  per = 5.72  per(accum) = 91.9
 T(global opt: after oper_renorm            ) = 2.022e-02 S  per = 8.09  per(accum) = 100

isweep=0 ibond=28/seqsize=34 dots=2 dbond=(6,0)-(7,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.006e+01S Sys:1.215e+00S Total:5.128e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=783:5.974e-03MB:5.834e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=40:3.052e-04MB:2.980e-07GB
total mem of comb=824:6.287e-03MB:6.139e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=6,12,1,1
 suppl= 0 1 2 3 4 16
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 17
 suppc2= 18
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:6 S:14 H:1 A:36 B:42 
        dim(bra,ket)=10,10 size(op)=58:4.425e-04MB size(tot)=2238:1.707e-02MB:1.667e-05GB
 rqops: oplist=CSHPQ nops=C:12 S:8 H:1 P:64 Q:72 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=3184:2.429e-02MB:2.372e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=7418:5.659e-02MB:5.527e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(7,0) fdel=./scratch/sweep/lop(6,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=136:1.038e-03MB
qtensor4: wf4 own=1 _data=0x55a31e9e29a0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=10
 (9,3):4 (9,1):3 (8,2):2 (8,4):1
 qbond: qcol nsym=5 dimAll=10
 (18,2):4 (18,0):3 (18,4):1 (19,3):1 (19,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=26 nblocks=304 size=136:1.038e-03MB
### DIAG TIMING: total=5.396e-03 t1=9.559e-06, t2=1.617e-05, t3=1.808e-05, t4=5.326e-03, t5=4.688e-06, t6=1.748e-05, t7=4.385e-06
duration_diagGPU:5.485e-03
duration_diagreduce:2.800e-08
duration_diagtransform:3.530e-07
----- TIMING FOR symbolic_formulae_twodot with size=609 : 1.153e-03 S -----
rank=0 GPUmem(GB): used=5.53e-05 (oper)=5.53e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=609
 no. of hintermediate operators=304
 no. of coefficients=4083:0.0312MB:3.04e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.184e-04 S -----
rank=0 GPUmem(GB): used=8.57e-05 (oper,hinter)=5.53e-05,3.04e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0282 S size(H_formulae)=609 size(Hxlst2)=26 T(Hmu/Hxlist)=0.00022,0.028 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0287 S size(H_formulae)=609 size(Hxlst)=18034 -----
rank=0 GPUmem(GB): used=0.00667 (oper,hinter,dvdson,batch)=5.53e-05,3.04e-05,2.03e-06,0.00658 blksize=16 blksize0=16 batchsize=18034
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=136 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.05e-05,0.000251,0.00132,0.000949,0.00256
 ndim=136:1.01e-06GB t[comm(intra)]=2.34e-05 speed=0.0868GB/S t[comm(inter)]=7.17e-06 speed=0.282GB/S
--- TIMING FOR sigma : t_inter=2.5e-04 t_gemm=1.3e-03 t_reduction=9.5e-04 tot=2.5e-03 ---
 sigma[inter] counter=174 t=2.5e-04 per=1.0e+01 cost=1.5e+06 flops=5.9e+09
 sigma[gemm] counter=174 i=0 t=2.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=1 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=2 t=2.2e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=3 t=2.2e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=4 t=2.9e-04 per=1.2e+01 cost=1.6e+05 flops=5.3e+08
 sigma[gemm] counter=174 i=5 t=3.4e-04 per=1.3e+01 cost=1.6e+05 flops=4.7e+08
 sigma[gemm] counter=174 i=6 t=3.5e-04 per=1.4e+01 cost=2.9e+05 flops=8.3e+08
 sigma[gemm] counter=174 i=7 t=3.3e-04 per=1.3e+01 cost=3.0e+05 flops=9.0e+08
 sigma[gemm] counter=174 total t=1.3e-03 per=5.2e+01 cost=9.0e+05 flops=6.8e+08
 sigma[red] counter=174 t=9.5e-04 per=3.8e+01 cost=2.1e+05 flops=2.2e+08
--- TIMING FOR sigma_tot : t_inter=3.1e-02 t_gemm=1.5e-01 t_reduction=1.4e-01 tot=3.2e-01 ---
 sigma_tot[inter] counter=174 t=3.1e-02 per=9.8e+00 cost=1.5e+08 flops=4.9e+09
 sigma_tot[gemm] counter=174 i=0 t=4.5e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=1 t=3.9e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=2 t=3.9e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=3 t=3.9e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=4 t=3.5e-02 per=1.1e+01 cost=3.0e+07 flops=8.5e+08
 sigma_tot[gemm] counter=174 i=5 t=3.8e-02 per=1.2e+01 cost=3.0e+07 flops=7.9e+08
 sigma_tot[gemm] counter=174 i=6 t=3.7e-02 per=1.2e+01 cost=2.6e+07 flops=7.0e+08
 sigma_tot[gemm] counter=174 i=7 t=3.6e-02 per=1.1e+01 cost=2.7e+07 flops=7.5e+08
 sigma_tot[gemm] counter=174 total t=1.5e-01 per=4.7e+01 cost=1.1e+08 flops=7.6e+08
 sigma_tot[red] counter=174 t=1.4e-01 per=4.4e+01 cost=2.7e+07 flops=2.0e+08
T(sub)=7.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,3.0e-06,9.7e-07,8.5e-07,2.2e-07
settings: ndim=136 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.335549867108 -1.116e+03  4.103e-02    1     1  4.601e-03 4.601e-03 4.433e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.782e-05,2.106e-04,1.025e-03,8.955e-04,2.164e-03
 ndim=136:1.013e-06GB t[comm(intra)]=2.210e-05 speed=9.171e-02GB/S t[comm(inter)]=5.719e-06 speed=3.544e-01GB/S
--- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=1.0e-03 t_reduction=9.0e-04 tot=2.1e-03 ---
 sigma[inter] counter=175 t=2.1e-04 per=9.9e+00 cost=1.5e+06 flops=7.0e+09
 sigma[gemm] counter=175 i=0 t=2.8e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=1 t=2.3e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=2 t=2.3e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=3 t=2.3e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=4 t=2.3e-04 per=1.1e+01 cost=1.6e+05 flops=6.7e+08
 sigma[gemm] counter=175 i=5 t=2.4e-04 per=1.1e+01 cost=1.6e+05 flops=6.7e+08
 sigma[gemm] counter=175 i=6 t=2.8e-04 per=1.3e+01 cost=2.9e+05 flops=1.0e+09
 sigma[gemm] counter=175 i=7 t=2.7e-04 per=1.3e+01 cost=3.0e+05 flops=1.1e+09
 sigma[gemm] counter=175 total t=1.0e-03 per=4.8e+01 cost=9.0e+05 flops=8.8e+08
 sigma[red] counter=175 t=9.0e-04 per=4.2e+01 cost=2.1e+05 flops=2.3e+08
--- TIMING FOR sigma_tot : t_inter=3.1e-02 t_gemm=1.5e-01 t_reduction=1.4e-01 tot=3.2e-01 ---
 sigma_tot[inter] counter=175 t=3.1e-02 per=9.8e+00 cost=1.5e+08 flops=4.9e+09
 sigma_tot[gemm] counter=175 i=0 t=4.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=1 t=3.9e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=2 t=3.9e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=3 t=3.9e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=4 t=3.5e-02 per=1.1e+01 cost=3.0e+07 flops=8.4e+08
 sigma_tot[gemm] counter=175 i=5 t=3.8e-02 per=1.2e+01 cost=3.0e+07 flops=7.9e+08
 sigma_tot[gemm] counter=175 i=6 t=3.7e-02 per=1.2e+01 cost=2.6e+07 flops=7.1e+08
 sigma_tot[gemm] counter=175 i=7 t=3.7e-02 per=1.1e+01 cost=2.8e+07 flops=7.6e+08
 sigma_tot[gemm] counter=175 total t=1.5e-01 per=4.7e+01 cost=1.1e+08 flops=7.6e+08
 sigma_tot[red] counter=175 t=1.4e-01 per=4.4e+01 cost=2.7e+07 flops=2.0e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=5.4e-06,9.5e-06,2.2e-06,1.0e-06,2.2e-07
    2   0 -    -116.339286171806 -3.736e-03  1.160e-02    2     2  9.016e-03 4.508e-03 4.191e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.806e-05,2.139e-04,1.020e-03,8.970e-04,2.163e-03
 ndim=136:1.013e-06GB t[comm(intra)]=2.255e-05 speed=8.985e-02GB/S t[comm(inter)]=5.509e-06 speed=3.679e-01GB/S
--- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=1.0e-03 t_reduction=9.0e-04 tot=2.1e-03 ---
 sigma[inter] counter=176 t=2.1e-04 per=1.0e+01 cost=1.5e+06 flops=6.9e+09
 sigma[gemm] counter=176 i=0 t=2.7e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=1 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=2 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=3 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=4 t=2.3e-04 per=1.1e+01 cost=1.6e+05 flops=6.9e+08
 sigma[gemm] counter=176 i=5 t=2.3e-04 per=1.1e+01 cost=1.6e+05 flops=6.7e+08
 sigma[gemm] counter=176 i=6 t=2.8e-04 per=1.3e+01 cost=2.9e+05 flops=1.0e+09
 sigma[gemm] counter=176 i=7 t=2.7e-04 per=1.3e+01 cost=3.0e+05 flops=1.1e+09
 sigma[gemm] counter=176 total t=1.0e-03 per=4.8e+01 cost=9.0e+05 flops=8.8e+08
 sigma[red] counter=176 t=9.0e-04 per=4.2e+01 cost=2.1e+05 flops=2.3e+08
--- TIMING FOR sigma_tot : t_inter=3.2e-02 t_gemm=1.5e-01 t_reduction=1.4e-01 tot=3.2e-01 ---
 sigma_tot[inter] counter=176 t=3.2e-02 per=9.8e+00 cost=1.6e+08 flops=4.9e+09
 sigma_tot[gemm] counter=176 i=0 t=4.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=1 t=4.0e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=2 t=3.9e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=3 t=3.9e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=4 t=3.6e-02 per=1.1e+01 cost=3.0e+07 flops=8.4e+08
 sigma_tot[gemm] counter=176 i=5 t=3.8e-02 per=1.2e+01 cost=3.0e+07 flops=7.8e+08
 sigma_tot[gemm] counter=176 i=6 t=3.7e-02 per=1.2e+01 cost=2.7e+07 flops=7.1e+08
 sigma_tot[gemm] counter=176 i=7 t=3.7e-02 per=1.1e+01 cost=2.8e+07 flops=7.6e+08
 sigma_tot[gemm] counter=176 total t=1.5e-01 per=4.7e+01 cost=1.1e+08 flops=7.6e+08
 sigma_tot[red] counter=176 t=1.4e-01 per=4.4e+01 cost=2.8e+07 flops=2.0e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.2e-05,1.8e-06,1.1e-06,1.5e-07
    3   0 -    -116.339632081738 -3.459e-04  3.859e-03    3     3  1.307e-02 4.355e-03 4.087e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.701e-05,1.981e-04,1.056e-03,8.927e-04,2.179e-03
 ndim=136:1.013e-06GB t[comm(intra)]=2.153e-05 speed=9.412e-02GB/S t[comm(inter)]=5.479e-06 speed=3.699e-01GB/S
--- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=1.1e-03 t_reduction=8.9e-04 tot=2.1e-03 ---
 sigma[inter] counter=177 t=2.0e-04 per=9.2e+00 cost=1.5e+06 flops=7.4e+09
 sigma[gemm] counter=177 i=0 t=2.7e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=1 t=2.3e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=2 t=2.3e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=3 t=2.3e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=4 t=2.5e-04 per=1.2e+01 cost=1.6e+05 flops=6.2e+08
 sigma[gemm] counter=177 i=5 t=2.5e-04 per=1.1e+01 cost=1.6e+05 flops=6.4e+08
 sigma[gemm] counter=177 i=6 t=2.8e-04 per=1.3e+01 cost=2.9e+05 flops=1.0e+09
 sigma[gemm] counter=177 i=7 t=2.7e-04 per=1.3e+01 cost=3.0e+05 flops=1.1e+09
 sigma[gemm] counter=177 total t=1.1e-03 per=4.9e+01 cost=9.0e+05 flops=8.5e+08
 sigma[red] counter=177 t=8.9e-04 per=4.2e+01 cost=2.1e+05 flops=2.3e+08
--- TIMING FOR sigma_tot : t_inter=3.2e-02 t_gemm=1.5e-01 t_reduction=1.4e-01 tot=3.2e-01 ---
 sigma_tot[inter] counter=177 t=3.2e-02 per=9.8e+00 cost=1.6e+08 flops=4.9e+09
 sigma_tot[gemm] counter=177 i=0 t=4.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=1 t=4.0e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=2 t=4.0e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=3 t=3.9e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=4 t=3.6e-02 per=1.1e+01 cost=3.0e+07 flops=8.4e+08
 sigma_tot[gemm] counter=177 i=5 t=3.9e-02 per=1.2e+01 cost=3.0e+07 flops=7.8e+08
 sigma_tot[gemm] counter=177 i=6 t=3.8e-02 per=1.2e+01 cost=2.7e+07 flops=7.1e+08
 sigma_tot[gemm] counter=177 i=7 t=3.7e-02 per=1.1e+01 cost=2.8e+07 flops=7.6e+08
 sigma_tot[gemm] counter=177 total t=1.5e-01 per=4.7e+01 cost=1.2e+08 flops=7.7e+08
 sigma_tot[red] counter=177 t=1.4e-01 per=4.4e+01 cost=2.8e+07 flops=2.0e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.0e-05,1.6e-06,9.4e-07,1.5e-07
    4   0 -    -116.339667732622 -3.565e-05  1.253e-03    3     4  1.722e-02 4.305e-03 4.062e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.723e-05,2.254e-04,1.049e-03,8.962e-04,2.203e-03
 ndim=136:1.013e-06GB t[comm(intra)]=2.171e-05 speed=9.333e-02GB/S t[comm(inter)]=5.520e-06 speed=3.671e-01GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=1.0e-03 t_reduction=9.0e-04 tot=2.2e-03 ---
 sigma[inter] counter=178 t=2.3e-04 per=1.0e+01 cost=1.5e+06 flops=6.5e+09
 sigma[gemm] counter=178 i=0 t=2.3e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=1 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=2 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=3 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=4 t=2.3e-04 per=1.1e+01 cost=1.6e+05 flops=6.6e+08
 sigma[gemm] counter=178 i=5 t=2.6e-04 per=1.2e+01 cost=1.6e+05 flops=6.1e+08
 sigma[gemm] counter=178 i=6 t=2.8e-04 per=1.3e+01 cost=2.9e+05 flops=1.0e+09
 sigma[gemm] counter=178 i=7 t=2.7e-04 per=1.2e+01 cost=3.0e+05 flops=1.1e+09
 sigma[gemm] counter=178 total t=1.0e-03 per=4.8e+01 cost=9.0e+05 flops=8.6e+08
 sigma[red] counter=178 t=9.0e-04 per=4.1e+01 cost=2.1e+05 flops=2.3e+08
--- TIMING FOR sigma_tot : t_inter=3.2e-02 t_gemm=1.5e-01 t_reduction=1.4e-01 tot=3.3e-01 ---
 sigma_tot[inter] counter=178 t=3.2e-02 per=9.8e+00 cost=1.6e+08 flops=5.0e+09
 sigma_tot[gemm] counter=178 i=0 t=4.6e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=1 t=4.0e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=2 t=4.0e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=3 t=4.0e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=4 t=3.6e-02 per=1.1e+01 cost=3.0e+07 flops=8.4e+08
 sigma_tot[gemm] counter=178 i=5 t=3.9e-02 per=1.2e+01 cost=3.0e+07 flops=7.8e+08
 sigma_tot[gemm] counter=178 i=6 t=3.8e-02 per=1.2e+01 cost=2.7e+07 flops=7.1e+08
 sigma_tot[gemm] counter=178 i=7 t=3.7e-02 per=1.1e+01 cost=2.9e+07 flops=7.6e+08
 sigma_tot[gemm] counter=178 total t=1.5e-01 per=4.7e+01 cost=1.2e+08 flops=7.7e+08
 sigma_tot[red] counter=178 t=1.4e-01 per=4.4e+01 cost=2.8e+07 flops=2.0e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.0e-05,1.7e-06,9.5e-07,1.3e-07
    5   0 -    -116.339671397293 -3.665e-06  3.962e-04    3     5  2.139e-02 4.279e-03 4.052e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.746e-05,2.090e-04,1.041e-03,8.873e-04,2.170e-03
 ndim=136:1.013e-06GB t[comm(intra)]=2.199e-05 speed=9.217e-02GB/S t[comm(inter)]=5.473e-06 speed=3.703e-01GB/S
--- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=1.0e-03 t_reduction=8.9e-04 tot=2.1e-03 ---
 sigma[inter] counter=179 t=2.1e-04 per=9.8e+00 cost=1.5e+06 flops=7.1e+09
 sigma[gemm] counter=179 i=0 t=2.3e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=1 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=2 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=3 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=4 t=2.4e-04 per=1.1e+01 cost=1.6e+05 flops=6.5e+08
 sigma[gemm] counter=179 i=5 t=2.5e-04 per=1.2e+01 cost=1.6e+05 flops=6.4e+08
 sigma[gemm] counter=179 i=6 t=2.8e-04 per=1.3e+01 cost=2.9e+05 flops=1.0e+09
 sigma[gemm] counter=179 i=7 t=2.7e-04 per=1.3e+01 cost=3.0e+05 flops=1.1e+09
 sigma[gemm] counter=179 total t=1.0e-03 per=4.9e+01 cost=9.0e+05 flops=8.6e+08
 sigma[red] counter=179 t=8.9e-04 per=4.2e+01 cost=2.1e+05 flops=2.3e+08
--- TIMING FOR sigma_tot : t_inter=3.2e-02 t_gemm=1.5e-01 t_reduction=1.4e-01 tot=3.3e-01 ---
 sigma_tot[inter] counter=179 t=3.2e-02 per=9.8e+00 cost=1.6e+08 flops=5.0e+09
 sigma_tot[gemm] counter=179 i=0 t=4.7e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=1 t=4.0e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=2 t=4.0e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=3 t=4.0e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=4 t=3.6e-02 per=1.1e+01 cost=3.1e+07 flops=8.4e+08
 sigma_tot[gemm] counter=179 i=5 t=3.9e-02 per=1.2e+01 cost=3.1e+07 flops=7.8e+08
 sigma_tot[gemm] counter=179 i=6 t=3.8e-02 per=1.2e+01 cost=2.7e+07 flops=7.1e+08
 sigma_tot[gemm] counter=179 i=7 t=3.8e-02 per=1.1e+01 cost=2.9e+07 flops=7.7e+08
 sigma_tot[gemm] counter=179 total t=1.5e-01 per=4.7e+01 cost=1.2e+08 flops=7.7e+08
 sigma_tot[red] counter=179 t=1.4e-01 per=4.4e+01 cost=2.8e+07 flops=2.0e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.0e-05,1.6e-06,9.5e-07,1.3e-07
    6   0 -    -116.339671851543 -4.543e-07  1.380e-04    3     6  2.550e-02 4.251e-03 4.033e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.791e-05,2.093e-04,1.052e-03,9.017e-04,2.195e-03
 ndim=136:1.013e-06GB t[comm(intra)]=2.255e-05 speed=8.986e-02GB/S t[comm(inter)]=5.361e-06 speed=3.780e-01GB/S
--- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=1.1e-03 t_reduction=9.0e-04 tot=2.2e-03 ---
 sigma[inter] counter=180 t=2.1e-04 per=9.7e+00 cost=1.5e+06 flops=7.0e+09
 sigma[gemm] counter=180 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=1 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=2 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=3 t=2.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=4 t=2.5e-04 per=1.2e+01 cost=1.6e+05 flops=6.2e+08
 sigma[gemm] counter=180 i=5 t=2.5e-04 per=1.1e+01 cost=1.6e+05 flops=6.3e+08
 sigma[gemm] counter=180 i=6 t=2.8e-04 per=1.3e+01 cost=2.9e+05 flops=1.0e+09
 sigma[gemm] counter=180 i=7 t=2.7e-04 per=1.2e+01 cost=3.0e+05 flops=1.1e+09
 sigma[gemm] counter=180 total t=1.1e-03 per=4.9e+01 cost=9.0e+05 flops=8.5e+08
 sigma[red] counter=180 t=9.0e-04 per=4.2e+01 cost=2.1e+05 flops=2.3e+08
--- TIMING FOR sigma_tot : t_inter=3.2e-02 t_gemm=1.5e-01 t_reduction=1.4e-01 tot=3.3e-01 ---
 sigma_tot[inter] counter=180 t=3.2e-02 per=9.8e+00 cost=1.6e+08 flops=5.0e+09
 sigma_tot[gemm] counter=180 i=0 t=4.7e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=1 t=4.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=2 t=4.0e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=3 t=4.0e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=4 t=3.7e-02 per=1.1e+01 cost=3.1e+07 flops=8.4e+08
 sigma_tot[gemm] counter=180 i=5 t=3.9e-02 per=1.2e+01 cost=3.1e+07 flops=7.8e+08
 sigma_tot[gemm] counter=180 i=6 t=3.9e-02 per=1.2e+01 cost=2.8e+07 flops=7.2e+08
 sigma_tot[gemm] counter=180 i=7 t=3.8e-02 per=1.1e+01 cost=2.9e+07 flops=7.7e+08
 sigma_tot[gemm] counter=180 total t=1.5e-01 per=4.7e+01 cost=1.2e+08 flops=7.7e+08
 sigma_tot[red] counter=180 t=1.4e-01 per=4.4e+01 cost=2.8e+07 flops=2.0e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.0e-05,1.5e-06,9.4e-07,1.5e-07
    7   0 +    -116.339671899742 -4.820e-08  4.304e-05    3     7  2.961e-02 4.230e-03 4.020e-03
TIMING FOR Davidson : 2.968e-02  T(cal/comm/rest)=2.814e-02,3.370e-07,1.538e-03
decomposed t_rest=1.538e-03
 T(sub)    =1.140e-04 per=7.414e+00
 T(precond)=1.564e-04 per=1.016e+01
 T(ortho)  =9.716e-06 per=6.316e-01
 T(xcopy)  =8.380e-07 per=5.448e-02
 T(xnrm2)  =1.401e-06 per=9.108e-02
 T(other)  =1.256e-03 per=8.164e+01
optimized energies: isweep=0 ibond=28 dots=2 e[0]=-116.339671899742 nmvp=7
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.170e+01S Sys:1.219e+00S Total:5.292e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond28.txt
 qbond: qsuper nsym=11 dimAll=37
 (18,2):4 (18,0):3 (18,4):1 (19,3):6 (19,1):8 (20,2):6 (20,0):4 (20,4):2 (21,3):1 (21,1):1 (19,5):1
----- TMING FOR decimation_genbasis(su2): 7.0e-05 S -----
decimation summary: 37->10 dwt=+8.624e-03 SvN=1.626e+00
 qbond: qkept nsym=5 dimAll=10
 (20,2):4 (20,0):3 (20,4):1 (21,3):1 (21,1):1
----- TIMING for decimation_row(nkr): 3.356e-03 S T(decim/select/formRot)=3.327e-04,2.881e-03,1.423e-04 -----
----- TIMING FOR twodot_decimation: 3.590e-03 S T(wf/decim)=1.558e-04,3.435e-03 -----
ctns::oper_renorm coord=(7,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:13 S:7 H:1 P:49 Q:56 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=2536:1.935e-02MB:1.889e-05GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.173e+01S Sys:1.219e+00S Total:5.295e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=126 : 5.678e-04 S -----
rank=0 GPUmem(GB): used=8.79e-05 (oper)=5.01e-05
rank=0 GPUmem(GB): used=8.82e-05 (oper,site)(GB)=5.01e-05,2.98e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=126
 no. of rintermediate operators=182
 no. of coefficients=2184:0.0167MB:1.63e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.977e-04 S -----
rank=0 GPUmem(GB): used=0.000104 (oper,site,rinter)=5.01e-05,2.98e-07,1.63e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00196 S size(rtasks)=126 size(Rlst2)=25 T(Rmu/Rlist)=0.000154,0.00181 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00211 S size(rtasks)=126 size(Rlst)=2336 -----
rank=0 GPUmem(GB): used=0.000104 (oper,site,rinter,batch)=5.01e-05,2.98e-07,1.63e-05,0.000644 blksize=16 blksize0=4 batchsize=2336
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000108,0.000542,0.000176
--- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=5.4e-04 t_reduction=1.8e-04 tot=8.2e-04 ---
 renorm[inter] counter=29 t=1.1e-04 per=1.3e+01 cost=4.6e+04 flops=4.3e+08
 renorm[gemm] counter=29 i=0 t=2.8e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=1 t=2.2e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=2 t=1.5e-04 per=1.9e+01 cost=7.7e+03 flops=5.0e+07
 renorm[gemm] counter=29 i=3 t=1.7e-04 per=2.0e+01 cost=2.7e+04 flops=1.6e+08
 renorm[gemm] counter=29 i=4 t=2.3e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=5 t=2.2e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=29 i=6 t=2.1e-04 per=2.5e+01 cost=7.3e+04 flops=3.5e+08
 renorm[gemm] counter=29 total t=5.4e-04 per=6.6e+01 cost=1.1e+05 flops=2.0e+08
 renorm[red] counter=29 t=1.8e-04 per=2.1e+01 cost=3.8e+04 flops=2.2e+08
--- TIMING FOR renorm_tot : t_inter=4.1e-03 t_gemm=2.0e-02 t_reduction=7.2e-03 tot=3.1e-02 ---
 renorm_tot[inter] counter=29 t=4.1e-03 per=1.3e+01 cost=2.9e+06 flops=7.1e+08
 renorm_tot[gemm] counter=29 i=0 t=8.2e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=29 i=1 t=6.7e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=29 i=2 t=2.7e-03 per=8.6e+00 cost=1.7e+05 flops=6.5e+07
 renorm_tot[gemm] counter=29 i=3 t=2.9e-03 per=9.4e+00 cost=4.7e+05 flops=1.6e+08
 renorm_tot[gemm] counter=29 i=4 t=3.6e-03 per=1.2e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=29 i=5 t=3.6e-03 per=1.2e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=29 i=6 t=6.7e-03 per=2.2e+01 cost=1.7e+06 flops=2.6e+08
 renorm_tot[gemm] counter=29 total t=2.0e-02 per=6.3e+01 cost=3.1e+06 flops=1.6e+08
 renorm_tot[red] counter=29 t=7.2e-03 per=2.3e+01 cost=7.6e+05 flops=1.0e+08
qops.to_cpu: size(tot)=2536:1.9e-02MB:1.9e-05GB t[to_cpu]=1.9e-05S speed=1.0e+00GB/S
check ||H-H.dagger||=3.312e-15 coord=(7,0) rank=0
ctns::oper_ab2pq coord=(7,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00709 S rank=0 -----
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.199e+01S Sys:1.219e+00S Total:5.320e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=783:5.974e-03MB:5.834e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=62:4.730e-04MB:4.619e-07GB
total mem of comb=846:6.454e-03MB:6.303e-06GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.199e+01S Sys:1.219e+00S Total:5.321e+01S
##### local opt: 9.575e-02 S #####
 T(local opt: fetch) = 6.017e-03 S  per = 6.28  per(accum) = 6.28
 T(local opt: hdiag) = 6.334e-03 S  per = 6.61  per(accum) = 12.9
 T(local opt: dvdsn) = 6.696e-02 S  per = 69.9  per(accum) = 82.8
 T(local opt: decim) = 3.657e-03 S  per = 3.82  per(accum) = 86.6
 T(local opt: guess) = 1.102e-04 S  per = 0.115  per(accum) = 86.8
 T(local opt: renrm) = 7.905e-03 S  per = 8.26  per(accum) = 95
 T(local opt: save ) = 4.769e-03 S  per = 4.98  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.696e-02 S  T(sum) = 6.612e-02 S  per = 9.874e+01
 T(local opt: preprocess                  ) = 6.195e-04 S  per = 0.937  per(accum) = 0.937
 T(local opt: symbolic_formulae           ) = 1.236e-03 S  per = 1.87  per(accum) = 2.81
 T(local opt: hintermediate init          ) = 5.313e-04 S  per = 0.804  per(accum) = 3.61
 T(local opt: preprocess_hformulae_Hxlist ) = 2.888e-02 S  per = 43.7  per(accum) = 47.3
 T(local opt: hmmtasks init               ) = 4.911e-03 S  per = 7.43  per(accum) = 54.7
 T(local opt: initial guess for dvdson    ) = 2.589e-04 S  per = 0.392  per(accum) = 55.1
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.794e-02 S  per = 42.3  per(accum) = 97.4
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.960e-04 S  per = 0.296  per(accum) = 97.7
 T(local opt: dvdson solver [comm(cpu)]   ) = 3.370e-07 S  per = 0.00051  per(accum) = 97.7
 T(local opt: dvdson solver [rest part]   ) = 1.538e-03 S  per = 2.33  per(accum) = 100
Detailed decomposition of T(renrm) = 7.905e-03 S  T(sum) = 7.905e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.053e-04 S  per = 1.33  per(accum) = 1.33
 T(local opt: qops init                    ) = 4.797e-04 S  per = 6.07  per(accum) = 7.4
 T(local opt: symbolic_formulae_renorm     ) = 6.439e-04 S  per = 8.15  per(accum) = 15.5
 T(local opt: allocate qops on gpu         ) = 8.458e-05 S  per = 1.07  per(accum) = 16.6
 T(local opt: site memcpy cpu2gpu          ) = 8.134e-05 S  per = 1.03  per(accum) = 17.6
 T(local opt: rintermediate init           ) = 4.307e-04 S  per = 5.45  per(accum) = 23.1
 T(local opt: preprocess_formulae_Rlist2   ) = 2.186e-03 S  per = 27.7  per(accum) = 50.8
 T(local opt: rmmtasks init                ) = 6.120e-04 S  per = 7.74  per(accum) = 58.5
 T(local opt: qops memset on cpu           ) = 4.600e-08 S  per = 0.000582  per(accum) = 58.5
 T(local opt: preprocess_renorm_batchGPU   ) = 2.396e-03 S  per = 30.3  per(accum) = 88.8
 T(local opt: reduction of opS & opH [nccl]) = 5.640e-07 S  per = 0.00713  per(accum) = 88.8
 T(local opt: qops memcpy gpu2cpu          ) = 8.598e-05 S  per = 1.09  per(accum) = 89.9
 T(local opt: deallocate cpu and gpu memory) = 1.050e-05 S  per = 0.133  per(accum) = 90
 T(local opt: reduction of opS & opH [comm]) = 7.950e-05 S  per = 1.01  per(accum) = 91
 T(local opt: conversion from opAB to opPQ ) = 6.410e-05 S  per = 0.811  per(accum) = 91.8
 T(local opt: after oper_renorm            ) = 6.444e-04 S  per = 8.15  per(accum) = 100
##### sweep opt: 2.551e+00 S #####
 T(sweep opt: fetch) = 1.881e-01 S  per = 7.37  per(accum) = 7.37
 T(sweep opt: hdiag) = 1.664e-01 S  per = 6.52  per(accum) = 13.9
 T(sweep opt: dvdsn) = 1.694e+00 S  per = 66.4  per(accum) = 80.3
 T(sweep opt: decim) = 1.085e-01 S  per = 4.25  per(accum) = 84.5
 T(sweep opt: guess) = 3.429e-03 S  per = 0.134  per(accum) = 84.7
 T(sweep opt: renrm) = 2.581e-01 S  per = 10.1  per(accum) = 94.8
 T(sweep opt: save ) = 1.327e-01 S  per =  5.2  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.694e+00 S  T(sum) = 1.668e+00 S  per = 9.847e+01
 T(sweep opt: preprocess                  ) = 1.864e-02 S  per = 1.12  per(accum) = 1.12
 T(sweep opt: symbolic_formulae           ) = 3.203e-02 S  per = 1.92  per(accum) = 3.04
 T(sweep opt: hintermediate init          ) = 1.697e-02 S  per = 1.02  per(accum) = 4.06
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.174e-01 S  per =   43  per(accum) = 47.1
 T(sweep opt: hmmtasks init               ) = 1.218e-01 S  per =  7.3  per(accum) = 54.4
 T(sweep opt: initial guess for dvdson    ) = 7.126e-03 S  per = 0.427  per(accum) = 54.8
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 6.981e-01 S  per = 41.9  per(accum) = 96.7
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 5.170e-03 S  per = 0.31  per(accum) = 97
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 8.209e-06 S  per = 0.000492  per(accum) = 97
 T(sweep opt: dvdson solver [rest part]   ) = 5.059e-02 S  per = 3.03  per(accum) = 100
Detailed decomposition of T(renrm) = 2.581e-01 S  T(sum) = 2.581e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.450e-03 S  per = 1.34  per(accum) = 1.34
 T(sweep opt: qops init                    ) = 1.387e-02 S  per = 5.37  per(accum) = 6.71
 T(sweep opt: symbolic_formulae_renorm     ) = 1.471e-02 S  per =  5.7  per(accum) = 12.4
 T(sweep opt: allocate qops on gpu         ) = 2.747e-03 S  per = 1.06  per(accum) = 13.5
 T(sweep opt: site memcpy cpu2gpu          ) = 2.611e-03 S  per = 1.01  per(accum) = 14.5
 T(sweep opt: rintermediate init           ) = 1.374e-02 S  per = 5.32  per(accum) = 19.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.262e-02 S  per = 24.3  per(accum) = 44.1
 T(sweep opt: rmmtasks init                ) = 2.003e-02 S  per = 7.76  per(accum) = 51.8
 T(sweep opt: qops memset on cpu           ) = 1.429e-06 S  per = 0.000554  per(accum) = 51.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.289e-02 S  per = 32.1  per(accum) = 84
 T(sweep opt: reduction of opS & opH [nccl]) = 1.701e-05 S  per = 0.00659  per(accum) = 84
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.962e-03 S  per = 1.15  per(accum) = 85.1
 T(sweep opt: deallocate cpu and gpu memory) = 4.362e-04 S  per = 0.169  per(accum) = 85.3
 T(sweep opt: reduction of opS & opH [comm]) = 2.736e-03 S  per = 1.06  per(accum) = 86.3
 T(sweep opt: conversion from opAB to opPQ ) = 1.437e-02 S  per = 5.57  per(accum) = 91.9
 T(sweep opt: after oper_renorm            ) = 2.087e-02 S  per = 8.09  per(accum) = 100
##### global opt: 2.551e+00 S #####
 T(global opt: fetch) = 1.881e-01 S  per = 7.37  per(accum) = 7.37
 T(global opt: hdiag) = 1.664e-01 S  per = 6.52  per(accum) = 13.9
 T(global opt: dvdsn) = 1.694e+00 S  per = 66.4  per(accum) = 80.3
 T(global opt: decim) = 1.085e-01 S  per = 4.25  per(accum) = 84.5
 T(global opt: guess) = 3.429e-03 S  per = 0.134  per(accum) = 84.7
 T(global opt: renrm) = 2.581e-01 S  per = 10.1  per(accum) = 94.8
 T(global opt: save ) = 1.327e-01 S  per =  5.2  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.694e+00 S  T(sum) = 1.668e+00 S  per = 9.847e+01
 T(global opt: preprocess                  ) = 1.864e-02 S  per = 1.12  per(accum) = 1.12
 T(global opt: symbolic_formulae           ) = 3.203e-02 S  per = 1.92  per(accum) = 3.04
 T(global opt: hintermediate init          ) = 1.697e-02 S  per = 1.02  per(accum) = 4.06
 T(global opt: preprocess_hformulae_Hxlist ) = 7.174e-01 S  per =   43  per(accum) = 47.1
 T(global opt: hmmtasks init               ) = 1.218e-01 S  per =  7.3  per(accum) = 54.4
 T(global opt: initial guess for dvdson    ) = 7.126e-03 S  per = 0.427  per(accum) = 54.8
 T(global opt: dvdson solver [Hx_batchGPU] ) = 6.981e-01 S  per = 41.9  per(accum) = 96.7
 T(global opt: dvdson solver [comm(gpu)]   ) = 5.170e-03 S  per = 0.31  per(accum) = 97
 T(global opt: dvdson solver [comm(cpu)]   ) = 8.209e-06 S  per = 0.000492  per(accum) = 97
 T(global opt: dvdson solver [rest part]   ) = 5.059e-02 S  per = 3.03  per(accum) = 100
Detailed decomposition of T(renrm) = 2.581e-01 S  T(sum) = 2.581e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.450e-03 S  per = 1.34  per(accum) = 1.34
 T(global opt: qops init                    ) = 1.387e-02 S  per = 5.37  per(accum) = 6.71
 T(global opt: symbolic_formulae_renorm     ) = 1.471e-02 S  per =  5.7  per(accum) = 12.4
 T(global opt: allocate qops on gpu         ) = 2.747e-03 S  per = 1.06  per(accum) = 13.5
 T(global opt: site memcpy cpu2gpu          ) = 2.611e-03 S  per = 1.01  per(accum) = 14.5
 T(global opt: rintermediate init           ) = 1.374e-02 S  per = 5.32  per(accum) = 19.8
 T(global opt: preprocess_formulae_Rlist2   ) = 6.262e-02 S  per = 24.3  per(accum) = 44.1
 T(global opt: rmmtasks init                ) = 2.003e-02 S  per = 7.76  per(accum) = 51.8
 T(global opt: qops memset on cpu           ) = 1.429e-06 S  per = 0.000554  per(accum) = 51.8
 T(global opt: preprocess_renorm_batchGPU   ) = 8.289e-02 S  per = 32.1  per(accum) = 84
 T(global opt: reduction of opS & opH [nccl]) = 1.701e-05 S  per = 0.00659  per(accum) = 84
 T(global opt: qops memcpy gpu2cpu          ) = 2.962e-03 S  per = 1.15  per(accum) = 85.1
 T(global opt: deallocate cpu and gpu memory) = 4.362e-04 S  per = 0.169  per(accum) = 85.3
 T(global opt: reduction of opS & opH [comm]) = 2.736e-03 S  per = 1.06  per(accum) = 86.3
 T(global opt: conversion from opAB to opPQ ) = 1.437e-02 S  per = 5.57  per(accum) = 91.9
 T(global opt: after oper_renorm            ) = 2.087e-02 S  per = 8.09  per(accum) = 100

isweep=0 ibond=29/seqsize=34 dots=2 dbond=(5,0)-(6,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.199e+01S Sys:1.219e+00S Total:5.321e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=783:5.974e-03MB:5.834e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=62:4.730e-04MB:4.619e-07GB
total mem of comb=846:6.454e-03MB:6.303e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=5,13,1,1
 suppl= 0 1 2 3 4
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 16
 suppc2= 17
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:5 S:15 H:1 A:25 B:30 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=1365:1.041e-02MB:1.017e-05GB
 rqops: oplist=CSHPQ nops=C:13 S:7 H:1 P:49 Q:56 
        dim(bra,ket)=10,10 size(op)=53:4.044e-04MB size(tot)=2536:1.935e-02MB:1.889e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=5897:4.499e-02MB:4.394e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(6,0) fdel=./scratch/sweep/lop(5,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=166:1.266e-03MB
qtensor4: wf4 own=1 _data=0x55a3234c0d60
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (8,2):3 (7,1):2 (7,3):2 (9,1):1 (6,2):1 (6,4):1
 qbond: qcol nsym=5 dimAll=10
 (20,2):4 (20,0):3 (20,4):1 (21,3):1 (21,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=41 nblocks=456 size=166:1.266e-03MB
### DIAG TIMING: total=5.329e-03 t1=8.541e-06, t2=1.837e-05, t3=1.975e-05, t4=5.256e-03, t5=4.469e-06, t6=1.846e-05, t7=3.615e-06
duration_diagGPU:5.410e-03
duration_diagreduce:2.800e-08
duration_diagtransform:4.520e-07
----- TIMING FOR symbolic_formulae_twodot with size=516 : 9.144e-04 S -----
rank=0 GPUmem(GB): used=4.39e-05 (oper)=4.39e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=516
 no. of hintermediate operators=269
 no. of coefficients=3269:0.0249MB:2.44e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.414e-04 S -----
rank=0 GPUmem(GB): used=6.83e-05 (oper,hinter)=4.39e-05,2.44e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0444 S size(H_formulae)=516 size(Hxlst2)=41 T(Hmu/Hxlist)=0.000184,0.0442 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0451 S size(H_formulae)=516 size(Hxlst)=27406 -----
rank=0 GPUmem(GB): used=0.00701 (oper,hinter,dvdson,batch)=4.39e-05,2.44e-05,2.47e-06,0.00694 blksize=12 blksize0=9 batchsize=27406
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=166 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.24e-05,0.000274,0.00144,0.00134,0.00309
 ndim=166:1.24e-06GB t[comm(intra)]=2.47e-05 speed=0.1GB/S t[comm(inter)]=7.7e-06 speed=0.321GB/S
--- TIMING FOR sigma : t_inter=2.7e-04 t_gemm=1.4e-03 t_reduction=1.3e-03 tot=3.0e-03 ---
 sigma[inter] counter=181 t=2.7e-04 per=9.0e+00 cost=1.2e+06 flops=4.5e+09
 sigma[gemm] counter=181 i=0 t=2.8e-06 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=1 t=2.3e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=2 t=2.2e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=3 t=2.2e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=4 t=3.6e-04 per=1.2e+01 cost=1.8e+05 flops=5.1e+08
 sigma[gemm] counter=181 i=5 t=3.9e-04 per=1.3e+01 cost=1.9e+05 flops=4.8e+08
 sigma[gemm] counter=181 i=6 t=3.4e-04 per=1.1e+01 cost=2.1e+05 flops=6.2e+08
 sigma[gemm] counter=181 i=7 t=3.3e-04 per=1.1e+01 cost=2.4e+05 flops=7.2e+08
 sigma[gemm] counter=181 total t=1.4e-03 per=4.7e+01 cost=8.3e+05 flops=5.7e+08
 sigma[red] counter=181 t=1.3e-03 per=4.4e+01 cost=2.4e+05 flops=1.8e+08
--- TIMING FOR sigma_tot : t_inter=3.3e-02 t_gemm=1.6e-01 t_reduction=1.5e-01 tot=3.3e-01 ---
 sigma_tot[inter] counter=181 t=3.3e-02 per=9.8e+00 cost=1.6e+08 flops=5.0e+09
 sigma_tot[gemm] counter=181 i=0 t=4.7e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=1 t=4.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=2 t=4.0e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=3 t=4.0e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=4 t=3.7e-02 per=1.1e+01 cost=3.1e+07 flops=8.4e+08
 sigma_tot[gemm] counter=181 i=5 t=4.0e-02 per=1.2e+01 cost=3.1e+07 flops=7.8e+08
 sigma_tot[gemm] counter=181 i=6 t=3.9e-02 per=1.2e+01 cost=2.8e+07 flops=7.2e+08
 sigma_tot[gemm] counter=181 i=7 t=3.8e-02 per=1.1e+01 cost=2.9e+07 flops=7.7e+08
 sigma_tot[gemm] counter=181 total t=1.6e-01 per=4.7e+01 cost=1.2e+08 flops=7.7e+08
 sigma_tot[red] counter=181 t=1.5e-01 per=4.4e+01 cost=2.9e+07 flops=2.0e+08
T(sub)=8.2e-06 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,3.1e-06,1.0e-06,9.5e-07,2.3e-07
settings: ndim=166 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336065256982 -1.116e+03  1.593e-02    1     1  5.208e-03 5.208e-03 5.035e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.845e-05,2.279e-04,1.145e-03,1.257e-03,2.665e-03
 ndim=166:1.237e-06GB t[comm(intra)]=2.270e-05 speed=1.090e-01GB/S t[comm(inter)]=5.750e-06 speed=4.302e-01GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=1.1e-03 t_reduction=1.3e-03 tot=2.6e-03 ---
 sigma[inter] counter=182 t=2.3e-04 per=8.7e+00 cost=1.2e+06 flops=5.4e+09
 sigma[gemm] counter=182 i=0 t=2.7e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=1 t=2.3e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=2 t=2.2e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=3 t=2.2e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=4 t=2.9e-04 per=1.1e+01 cost=1.8e+05 flops=6.4e+08
 sigma[gemm] counter=182 i=5 t=2.9e-04 per=1.1e+01 cost=1.9e+05 flops=6.6e+08
 sigma[gemm] counter=182 i=6 t=2.8e-04 per=1.1e+01 cost=2.1e+05 flops=7.6e+08
 sigma[gemm] counter=182 i=7 t=2.8e-04 per=1.1e+01 cost=2.4e+05 flops=8.5e+08
 sigma[gemm] counter=182 total t=1.1e-03 per=4.4e+01 cost=8.3e+05 flops=7.2e+08
 sigma[red] counter=182 t=1.3e-03 per=4.8e+01 cost=2.4e+05 flops=1.9e+08
--- TIMING FOR sigma_tot : t_inter=3.3e-02 t_gemm=1.6e-01 t_reduction=1.5e-01 tot=3.4e-01 ---
 sigma_tot[inter] counter=182 t=3.3e-02 per=9.8e+00 cost=1.6e+08 flops=5.0e+09
 sigma_tot[gemm] counter=182 i=0 t=4.7e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=1 t=4.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=2 t=4.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=3 t=4.0e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=4 t=3.7e-02 per=1.1e+01 cost=3.1e+07 flops=8.3e+08
 sigma_tot[gemm] counter=182 i=5 t=4.0e-02 per=1.2e+01 cost=3.1e+07 flops=7.8e+08
 sigma_tot[gemm] counter=182 i=6 t=3.9e-02 per=1.2e+01 cost=2.8e+07 flops=7.2e+08
 sigma_tot[gemm] counter=182 i=7 t=3.9e-02 per=1.1e+01 cost=3.0e+07 flops=7.7e+08
 sigma_tot[gemm] counter=182 total t=1.6e-01 per=4.7e+01 cost=1.2e+08 flops=7.7e+08
 sigma_tot[red] counter=182 t=1.5e-01 per=4.4e+01 cost=2.9e+07 flops=2.0e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=5.7e-06,1.0e-05,2.3e-06,1.2e-06,2.1e-07
    2   0 -    -116.336645214260 -5.800e-04  4.132e-03    2     2  1.014e-02 5.068e-03 4.752e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.814e-05,2.255e-04,1.154e-03,1.249e-03,2.661e-03
 ndim=166:1.237e-06GB t[comm(intra)]=2.250e-05 speed=1.099e-01GB/S t[comm(inter)]=5.642e-06 speed=4.384e-01GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=1.2e-03 t_reduction=1.2e-03 tot=2.6e-03 ---
 sigma[inter] counter=183 t=2.3e-04 per=8.6e+00 cost=1.2e+06 flops=5.5e+09
 sigma[gemm] counter=183 i=0 t=2.8e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=1 t=2.4e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=2 t=2.3e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=3 t=2.3e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=4 t=2.8e-04 per=1.1e+01 cost=1.8e+05 flops=6.4e+08
 sigma[gemm] counter=183 i=5 t=2.9e-04 per=1.1e+01 cost=1.9e+05 flops=6.5e+08
 sigma[gemm] counter=183 i=6 t=2.8e-04 per=1.1e+01 cost=2.1e+05 flops=7.5e+08
 sigma[gemm] counter=183 i=7 t=2.8e-04 per=1.1e+01 cost=2.4e+05 flops=8.5e+08
 sigma[gemm] counter=183 total t=1.2e-03 per=4.4e+01 cost=8.3e+05 flops=7.2e+08
 sigma[red] counter=183 t=1.2e-03 per=4.8e+01 cost=2.4e+05 flops=1.9e+08
--- TIMING FOR sigma_tot : t_inter=3.3e-02 t_gemm=1.6e-01 t_reduction=1.5e-01 tot=3.4e-01 ---
 sigma_tot[inter] counter=183 t=3.3e-02 per=9.8e+00 cost=1.7e+08 flops=5.0e+09
 sigma_tot[gemm] counter=183 i=0 t=4.8e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=1 t=4.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=2 t=4.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=3 t=4.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=4 t=3.8e-02 per=1.1e+01 cost=3.1e+07 flops=8.3e+08
 sigma_tot[gemm] counter=183 i=5 t=4.0e-02 per=1.2e+01 cost=3.1e+07 flops=7.8e+08
 sigma_tot[gemm] counter=183 i=6 t=4.0e-02 per=1.2e+01 cost=2.8e+07 flops=7.2e+08
 sigma_tot[gemm] counter=183 i=7 t=3.9e-02 per=1.1e+01 cost=3.0e+07 flops=7.7e+08
 sigma_tot[gemm] counter=183 total t=1.6e-01 per=4.7e+01 cost=1.2e+08 flops=7.6e+08
 sigma_tot[red] counter=183 t=1.5e-01 per=4.4e+01 cost=2.9e+07 flops=2.0e+08
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.3e-05,1.8e-06,1.1e-06,1.8e-07
    3   0 -    -116.336688708784 -4.349e-05  1.614e-03    3     3  1.481e-02 4.935e-03 4.651e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.831e-05,2.231e-04,1.158e-03,1.247e-03,2.662e-03
 ndim=166:1.237e-06GB t[comm(intra)]=2.285e-05 speed=1.082e-01GB/S t[comm(inter)]=5.457e-06 speed=4.533e-01GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=1.2e-03 t_reduction=1.2e-03 tot=2.6e-03 ---
 sigma[inter] counter=184 t=2.2e-04 per=8.5e+00 cost=1.2e+06 flops=5.5e+09
 sigma[gemm] counter=184 i=0 t=2.7e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=1 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=2 t=2.2e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=3 t=2.2e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=4 t=2.8e-04 per=1.1e+01 cost=1.8e+05 flops=6.5e+08
 sigma[gemm] counter=184 i=5 t=2.9e-04 per=1.1e+01 cost=1.9e+05 flops=6.5e+08
 sigma[gemm] counter=184 i=6 t=2.9e-04 per=1.1e+01 cost=2.1e+05 flops=7.3e+08
 sigma[gemm] counter=184 i=7 t=2.8e-04 per=1.1e+01 cost=2.4e+05 flops=8.5e+08
 sigma[gemm] counter=184 total t=1.2e-03 per=4.4e+01 cost=8.3e+05 flops=7.1e+08
 sigma[red] counter=184 t=1.2e-03 per=4.7e+01 cost=2.4e+05 flops=1.9e+08
--- TIMING FOR sigma_tot : t_inter=3.3e-02 t_gemm=1.6e-01 t_reduction=1.5e-01 tot=3.4e-01 ---
 sigma_tot[inter] counter=184 t=3.3e-02 per=9.8e+00 cost=1.7e+08 flops=5.0e+09
 sigma_tot[gemm] counter=184 i=0 t=4.8e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=1 t=4.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=2 t=4.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=3 t=4.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=4 t=3.8e-02 per=1.1e+01 cost=3.1e+07 flops=8.3e+08
 sigma_tot[gemm] counter=184 i=5 t=4.1e-02 per=1.2e+01 cost=3.2e+07 flops=7.8e+08
 sigma_tot[gemm] counter=184 i=6 t=4.0e-02 per=1.2e+01 cost=2.9e+07 flops=7.2e+08
 sigma_tot[gemm] counter=184 i=7 t=3.9e-02 per=1.1e+01 cost=3.0e+07 flops=7.7e+08
 sigma_tot[gemm] counter=184 total t=1.6e-01 per=4.7e+01 cost=1.2e+08 flops=7.6e+08
 sigma_tot[red] counter=184 t=1.5e-01 per=4.4e+01 cost=2.9e+07 flops=2.0e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.1e-05,1.6e-06,1.0e-06,1.8e-07
    4   0 -    -116.336696022089 -7.313e-06  6.245e-04    3     4  1.939e-02 4.849e-03 4.588e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.734e-05,2.340e-04,1.134e-03,1.247e-03,2.646e-03
 ndim=166:1.237e-06GB t[comm(intra)]=2.175e-05 speed=1.137e-01GB/S t[comm(inter)]=5.592e-06 speed=4.423e-01GB/S
--- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=1.1e-03 t_reduction=1.2e-03 tot=2.6e-03 ---
 sigma[inter] counter=185 t=2.3e-04 per=9.0e+00 cost=1.2e+06 flops=5.3e+09
 sigma[gemm] counter=185 i=0 t=2.8e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=1 t=2.2e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=2 t=2.2e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=3 t=2.2e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=4 t=2.8e-04 per=1.1e+01 cost=1.8e+05 flops=6.5e+08
 sigma[gemm] counter=185 i=5 t=2.9e-04 per=1.1e+01 cost=1.9e+05 flops=6.7e+08
 sigma[gemm] counter=185 i=6 t=2.7e-04 per=1.0e+01 cost=2.1e+05 flops=7.8e+08
 sigma[gemm] counter=185 i=7 t=2.8e-04 per=1.1e+01 cost=2.4e+05 flops=8.5e+08
 sigma[gemm] counter=185 total t=1.1e-03 per=4.3e+01 cost=8.3e+05 flops=7.3e+08
 sigma[red] counter=185 t=1.2e-03 per=4.8e+01 cost=2.4e+05 flops=1.9e+08
--- TIMING FOR sigma_tot : t_inter=3.4e-02 t_gemm=1.6e-01 t_reduction=1.5e-01 tot=3.4e-01 ---
 sigma_tot[inter] counter=185 t=3.4e-02 per=9.8e+00 cost=1.7e+08 flops=5.0e+09
 sigma_tot[gemm] counter=185 i=0 t=4.8e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=1 t=4.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=2 t=4.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=3 t=4.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=4 t=3.8e-02 per=1.1e+01 cost=3.2e+07 flops=8.3e+08
 sigma_tot[gemm] counter=185 i=5 t=4.1e-02 per=1.2e+01 cost=3.2e+07 flops=7.7e+08
 sigma_tot[gemm] counter=185 i=6 t=4.0e-02 per=1.2e+01 cost=2.9e+07 flops=7.2e+08
 sigma_tot[gemm] counter=185 i=7 t=3.9e-02 per=1.1e+01 cost=3.0e+07 flops=7.7e+08
 sigma_tot[gemm] counter=185 total t=1.6e-01 per=4.7e+01 cost=1.2e+08 flops=7.6e+08
 sigma_tot[red] counter=185 t=1.5e-01 per=4.4e+01 cost=3.0e+07 flops=2.0e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.1e-05,1.7e-06,1.0e-06,1.4e-07
    5   0 -    -116.336696950672 -9.286e-07  1.592e-04    3     5  2.400e-02 4.799e-03 4.548e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.758e-05,2.234e-04,1.196e-03,1.248e-03,2.700e-03
 ndim=166:1.237e-06GB t[comm(intra)]=2.200e-05 speed=1.125e-01GB/S t[comm(inter)]=5.582e-06 speed=4.431e-01GB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=1.2e-03 t_reduction=1.2e-03 tot=2.7e-03 ---
 sigma[inter] counter=186 t=2.2e-04 per=8.4e+00 cost=1.2e+06 flops=5.5e+09
 sigma[gemm] counter=186 i=0 t=2.8e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=1 t=2.3e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=2 t=2.3e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=3 t=2.3e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=4 t=3.0e-04 per=1.1e+01 cost=1.8e+05 flops=6.1e+08
 sigma[gemm] counter=186 i=5 t=3.0e-04 per=1.1e+01 cost=1.9e+05 flops=6.3e+08
 sigma[gemm] counter=186 i=6 t=3.0e-04 per=1.1e+01 cost=2.1e+05 flops=7.1e+08
 sigma[gemm] counter=186 i=7 t=2.8e-04 per=1.1e+01 cost=2.4e+05 flops=8.5e+08
 sigma[gemm] counter=186 total t=1.2e-03 per=4.5e+01 cost=8.3e+05 flops=6.9e+08
 sigma[red] counter=186 t=1.2e-03 per=4.7e+01 cost=2.4e+05 flops=1.9e+08
--- TIMING FOR sigma_tot : t_inter=3.4e-02 t_gemm=1.6e-01 t_reduction=1.5e-01 tot=3.5e-01 ---
 sigma_tot[inter] counter=186 t=3.4e-02 per=9.7e+00 cost=1.7e+08 flops=5.0e+09
 sigma_tot[gemm] counter=186 i=0 t=4.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=1 t=4.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=2 t=4.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=3 t=4.1e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=4 t=3.8e-02 per=1.1e+01 cost=3.2e+07 flops=8.3e+08
 sigma_tot[gemm] counter=186 i=5 t=4.1e-02 per=1.2e+01 cost=3.2e+07 flops=7.7e+08
 sigma_tot[gemm] counter=186 i=6 t=4.0e-02 per=1.2e+01 cost=2.9e+07 flops=7.2e+08
 sigma_tot[gemm] counter=186 i=7 t=4.0e-02 per=1.1e+01 cost=3.1e+07 flops=7.7e+08
 sigma_tot[gemm] counter=186 total t=1.6e-01 per=4.7e+01 cost=1.2e+08 flops=7.6e+08
 sigma_tot[red] counter=186 t=1.5e-01 per=4.4e+01 cost=3.0e+07 flops=2.0e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.0e-05,1.6e-06,1.0e-06,1.7e-07
    6   0 +    -116.336697017628 -6.696e-08  4.375e-05    3     6  2.865e-02 4.775e-03 4.528e-03
TIMING FOR Davidson : 2.872e-02  T(cal/comm/rest)=2.717e-02,2.260e-07,1.550e-03
decomposed t_rest=1.550e-03
 T(sub)    =1.019e-04 per=6.577e+00
 T(precond)=3.386e-04 per=2.185e+01
 T(ortho)  =1.010e-05 per=6.517e-01
 T(xcopy)  =7.480e-07 per=4.826e-02
 T(xnrm2)  =1.323e-06 per=8.536e-02
 T(other)  =1.097e-03 per=7.079e+01
optimized energies: isweep=0 ibond=29 dots=2 e[0]=-116.336697017628 nmvp=6
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.348e+01S Sys:1.219e+00S Total:5.470e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond29.txt
 qbond: qsuper nsym=11 dimAll=37
 (20,2):4 (20,0):3 (20,4):1 (21,3):6 (21,1):8 (22,2):6 (22,0):4 (22,4):2 (23,3):1 (23,1):1 (21,5):1
----- TMING FOR decimation_genbasis(su2): 7.9e-05 S -----
decimation summary: 37->10 dwt=+1.424e-04 SvN=1.184e+00
 qbond: qkept nsym=4 dimAll=10
 (21,3):4 (21,1):3 (22,2):2 (22,4):1
----- TIMING for decimation_row(nkr): 3.447e-03 S T(decim/select/formRot)=3.569e-04,2.949e-03,1.415e-04 -----
----- TIMING FOR twodot_decimation: 3.722e-03 S T(wf/decim)=1.892e-04,3.533e-03 -----
ctns::oper_renorm coord=(6,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:14 S:6 H:1 P:36 Q:42 
        dim(bra,ket)=10,10 size(op)=58:4.425e-04MB size(tot)=2238:1.707e-02MB:1.667e-05GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.358e+01S Sys:1.219e+00S Total:5.480e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=99 : 4.596e-04 S -----
rank=0 GPUmem(GB): used=7.48e-05 (oper)=4.3e-05
rank=0 GPUmem(GB): used=7.53e-05 (oper,site)(GB)=4.3e-05,4.62e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=99
 no. of rintermediate operators=138
 no. of coefficients=1794:0.0137MB:1.34e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.093e-04 S -----
rank=0 GPUmem(GB): used=8.86e-05 (oper,site,rinter)=4.3e-05,4.62e-07,1.34e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00216 S size(rtasks)=99 size(Rlst2)=16 T(Rmu/Rlist)=0.000133,0.00202 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00231 S size(rtasks)=99 size(Rlst)=2725 -----
rank=0 GPUmem(GB): used=8.86e-05 (oper,site,rinter,batch)=4.3e-05,4.62e-07,1.34e-05,0.000751 blksize=16 blksize0=4 batchsize=2725
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000106,0.000874,0.000229
--- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=8.7e-04 t_reduction=2.3e-04 tot=1.2e-03 ---
 renorm[inter] counter=30 t=1.1e-04 per=8.7e+00 cost=6.9e+04 flops=6.6e+08
 renorm[gemm] counter=30 i=0 t=2.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=1 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=2 t=2.2e-04 per=1.9e+01 cost=1.0e+04 flops=4.5e+07
 renorm[gemm] counter=30 i=3 t=3.0e-04 per=2.5e+01 cost=4.4e+04 flops=1.5e+08
 renorm[gemm] counter=30 i=4 t=2.3e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=5 t=2.2e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=30 i=6 t=3.4e-04 per=2.8e+01 cost=9.7e+04 flops=2.9e+08
 renorm[gemm] counter=30 total t=8.7e-04 per=7.2e+01 cost=1.5e+05 flops=1.7e+08
 renorm[red] counter=30 t=2.3e-04 per=1.9e+01 cost=4.2e+04 flops=1.8e+08
--- TIMING FOR renorm_tot : t_inter=4.2e-03 t_gemm=2.0e-02 t_reduction=7.5e-03 tot=3.2e-02 ---
 renorm_tot[inter] counter=30 t=4.2e-03 per=1.3e+01 cost=3.0e+06 flops=7.1e+08
 renorm_tot[gemm] counter=30 i=0 t=8.5e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=30 i=1 t=6.9e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=30 i=2 t=2.9e-03 per=9.0e+00 cost=1.8e+05 flops=6.3e+07
 renorm_tot[gemm] counter=30 i=3 t=3.2e-03 per=9.9e+00 cost=5.1e+05 flops=1.6e+08
 renorm_tot[gemm] counter=30 i=4 t=3.6e-03 per=1.1e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=30 i=5 t=3.6e-03 per=1.1e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=30 i=6 t=7.0e-03 per=2.2e+01 cost=1.8e+06 flops=2.6e+08
 renorm_tot[gemm] counter=30 total t=2.0e-02 per=6.4e+01 cost=3.3e+06 flops=1.6e+08
 renorm_tot[red] counter=30 t=7.5e-03 per=2.3e+01 cost=8.0e+05 flops=1.1e+08
qops.to_cpu: size(tot)=2238:1.7e-02MB:1.7e-05GB t[to_cpu]=1.9e-05S speed=8.7e-01GB/S
check ||H-H.dagger||=7.955e-15 coord=(6,0) rank=0
ctns::oper_ab2pq coord=(6,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00767 S rank=0 -----
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.376e+01S Sys:1.219e+00S Total:5.498e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=783:5.974e-03MB:5.834e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=841:6.416e-03MB:6.266e-06GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.377e+01S Sys:1.219e+00S Total:5.498e+01S
##### local opt: 1.147e-01 S #####
 T(local opt: fetch) = 6.575e-03 S  per = 5.73  per(accum) = 5.73
 T(local opt: hdiag) = 6.291e-03 S  per = 5.48  per(accum) = 11.2
 T(local opt: dvdsn) = 8.502e-02 S  per = 74.1  per(accum) = 85.3
 T(local opt: decim) = 3.806e-03 S  per = 3.32  per(accum) = 88.6
 T(local opt: guess) = 1.345e-04 S  per = 0.117  per(accum) = 88.8
 T(local opt: renrm) = 8.499e-03 S  per = 7.41  per(accum) = 96.2
 T(local opt: save ) = 4.389e-03 S  per = 3.83  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.502e-02 S  T(sum) = 8.413e-02 S  per = 9.896e+01
 T(local opt: preprocess                  ) = 8.307e-04 S  per = 0.987  per(accum) = 0.987
 T(local opt: symbolic_formulae           ) = 1.008e-03 S  per =  1.2  per(accum) = 2.19
 T(local opt: hintermediate init          ) = 5.513e-04 S  per = 0.655  per(accum) = 2.84
 T(local opt: preprocess_hformulae_Hxlist ) = 4.527e-02 S  per = 53.8  per(accum) = 56.7
 T(local opt: hmmtasks init               ) = 7.468e-03 S  per = 8.88  per(accum) = 65.5
 T(local opt: initial guess for dvdson    ) = 2.856e-04 S  per = 0.339  per(accum) = 65.9
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.700e-02 S  per = 32.1  per(accum) = 98
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.722e-04 S  per = 0.205  per(accum) = 98.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.260e-07 S  per = 0.000269  per(accum) = 98.2
 T(local opt: dvdson solver [rest part]   ) = 1.550e-03 S  per = 1.84  per(accum) = 100
Detailed decomposition of T(renrm) = 8.499e-03 S  T(sum) = 8.499e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.137e-04 S  per = 1.34  per(accum) = 1.34
 T(local opt: qops init                    ) = 3.957e-04 S  per = 4.66  per(accum) = 5.99
 T(local opt: symbolic_formulae_renorm     ) = 5.287e-04 S  per = 6.22  per(accum) = 12.2
 T(local opt: allocate qops on gpu         ) = 8.671e-05 S  per = 1.02  per(accum) = 13.2
 T(local opt: site memcpy cpu2gpu          ) = 8.327e-05 S  per = 0.98  per(accum) = 14.2
 T(local opt: rintermediate init           ) = 4.466e-04 S  per = 5.25  per(accum) = 19.5
 T(local opt: preprocess_formulae_Rlist2   ) = 2.383e-03 S  per =   28  per(accum) = 47.5
 T(local opt: rmmtasks init                ) = 7.376e-04 S  per = 8.68  per(accum) = 56.2
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 0.000506  per(accum) = 56.2
 T(local opt: preprocess_renorm_batchGPU   ) = 2.829e-03 S  per = 33.3  per(accum) = 89.5
 T(local opt: reduction of opS & opH [nccl]) = 6.120e-07 S  per = 0.0072  per(accum) = 89.5
 T(local opt: qops memcpy gpu2cpu          ) = 8.937e-05 S  per = 1.05  per(accum) = 90.5
 T(local opt: deallocate cpu and gpu memory) = 1.016e-05 S  per = 0.12  per(accum) = 90.7
 T(local opt: reduction of opS & opH [comm]) = 8.069e-05 S  per = 0.949  per(accum) = 91.6
 T(local opt: conversion from opAB to opPQ ) = 6.912e-05 S  per = 0.813  per(accum) = 92.4
 T(local opt: after oper_renorm            ) = 6.444e-04 S  per = 7.58  per(accum) = 100
##### sweep opt: 2.666e+00 S #####
 T(sweep opt: fetch) = 1.947e-01 S  per =  7.3  per(accum) = 7.3
 T(sweep opt: hdiag) = 1.727e-01 S  per = 6.48  per(accum) = 13.8
 T(sweep opt: dvdsn) = 1.779e+00 S  per = 66.7  per(accum) = 80.5
 T(sweep opt: decim) = 1.124e-01 S  per = 4.21  per(accum) = 84.7
 T(sweep opt: guess) = 3.563e-03 S  per = 0.134  per(accum) = 84.9
 T(sweep opt: renrm) = 2.666e-01 S  per =   10  per(accum) = 94.9
 T(sweep opt: save ) = 1.371e-01 S  per = 5.14  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.779e+00 S  T(sum) = 1.752e+00 S  per = 9.849e+01
 T(sweep opt: preprocess                  ) = 1.947e-02 S  per = 1.11  per(accum) = 1.11
 T(sweep opt: symbolic_formulae           ) = 3.304e-02 S  per = 1.89  per(accum) = 3
 T(sweep opt: hintermediate init          ) = 1.753e-02 S  per =    1  per(accum) = 4
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.626e-01 S  per = 43.5  per(accum) = 47.5
 T(sweep opt: hmmtasks init               ) = 1.292e-01 S  per = 7.38  per(accum) = 54.9
 T(sweep opt: initial guess for dvdson    ) = 7.412e-03 S  per = 0.423  per(accum) = 55.3
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 7.251e-01 S  per = 41.4  per(accum) = 96.7
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 5.342e-03 S  per = 0.305  per(accum) = 97
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 8.435e-06 S  per = 0.000481  per(accum) = 97
 T(sweep opt: dvdson solver [rest part]   ) = 5.214e-02 S  per = 2.98  per(accum) = 100
Detailed decomposition of T(renrm) = 2.666e-01 S  T(sum) = 2.666e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.564e-03 S  per = 1.34  per(accum) = 1.34
 T(sweep opt: qops init                    ) = 1.426e-02 S  per = 5.35  per(accum) = 6.69
 T(sweep opt: symbolic_formulae_renorm     ) = 1.524e-02 S  per = 5.72  per(accum) = 12.4
 T(sweep opt: allocate qops on gpu         ) = 2.834e-03 S  per = 1.06  per(accum) = 13.5
 T(sweep opt: site memcpy cpu2gpu          ) = 2.694e-03 S  per = 1.01  per(accum) = 14.5
 T(sweep opt: rintermediate init           ) = 1.419e-02 S  per = 5.32  per(accum) = 19.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.500e-02 S  per = 24.4  per(accum) = 44.2
 T(sweep opt: rmmtasks init                ) = 2.077e-02 S  per = 7.79  per(accum) = 52
 T(sweep opt: qops memset on cpu           ) = 1.472e-06 S  per = 0.000552  per(accum) = 52
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.572e-02 S  per = 32.2  per(accum) = 84.1
 T(sweep opt: reduction of opS & opH [nccl]) = 1.762e-05 S  per = 0.00661  per(accum) = 84.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.052e-03 S  per = 1.14  per(accum) = 85.3
 T(sweep opt: deallocate cpu and gpu memory) = 4.464e-04 S  per = 0.167  per(accum) = 85.5
 T(sweep opt: reduction of opS & opH [comm]) = 2.817e-03 S  per = 1.06  per(accum) = 86.5
 T(sweep opt: conversion from opAB to opPQ ) = 1.443e-02 S  per = 5.42  per(accum) = 91.9
 T(sweep opt: after oper_renorm            ) = 2.151e-02 S  per = 8.07  per(accum) = 100
##### global opt: 2.666e+00 S #####
 T(global opt: fetch) = 1.947e-01 S  per =  7.3  per(accum) = 7.3
 T(global opt: hdiag) = 1.727e-01 S  per = 6.48  per(accum) = 13.8
 T(global opt: dvdsn) = 1.779e+00 S  per = 66.7  per(accum) = 80.5
 T(global opt: decim) = 1.124e-01 S  per = 4.21  per(accum) = 84.7
 T(global opt: guess) = 3.563e-03 S  per = 0.134  per(accum) = 84.9
 T(global opt: renrm) = 2.666e-01 S  per =   10  per(accum) = 94.9
 T(global opt: save ) = 1.371e-01 S  per = 5.14  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.779e+00 S  T(sum) = 1.752e+00 S  per = 9.849e+01
 T(global opt: preprocess                  ) = 1.947e-02 S  per = 1.11  per(accum) = 1.11
 T(global opt: symbolic_formulae           ) = 3.304e-02 S  per = 1.89  per(accum) = 3
 T(global opt: hintermediate init          ) = 1.753e-02 S  per =    1  per(accum) = 4
 T(global opt: preprocess_hformulae_Hxlist ) = 7.626e-01 S  per = 43.5  per(accum) = 47.5
 T(global opt: hmmtasks init               ) = 1.292e-01 S  per = 7.38  per(accum) = 54.9
 T(global opt: initial guess for dvdson    ) = 7.412e-03 S  per = 0.423  per(accum) = 55.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 7.251e-01 S  per = 41.4  per(accum) = 96.7
 T(global opt: dvdson solver [comm(gpu)]   ) = 5.342e-03 S  per = 0.305  per(accum) = 97
 T(global opt: dvdson solver [comm(cpu)]   ) = 8.435e-06 S  per = 0.000481  per(accum) = 97
 T(global opt: dvdson solver [rest part]   ) = 5.214e-02 S  per = 2.98  per(accum) = 100
Detailed decomposition of T(renrm) = 2.666e-01 S  T(sum) = 2.666e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.564e-03 S  per = 1.34  per(accum) = 1.34
 T(global opt: qops init                    ) = 1.426e-02 S  per = 5.35  per(accum) = 6.69
 T(global opt: symbolic_formulae_renorm     ) = 1.524e-02 S  per = 5.72  per(accum) = 12.4
 T(global opt: allocate qops on gpu         ) = 2.834e-03 S  per = 1.06  per(accum) = 13.5
 T(global opt: site memcpy cpu2gpu          ) = 2.694e-03 S  per = 1.01  per(accum) = 14.5
 T(global opt: rintermediate init           ) = 1.419e-02 S  per = 5.32  per(accum) = 19.8
 T(global opt: preprocess_formulae_Rlist2   ) = 6.500e-02 S  per = 24.4  per(accum) = 44.2
 T(global opt: rmmtasks init                ) = 2.077e-02 S  per = 7.79  per(accum) = 52
 T(global opt: qops memset on cpu           ) = 1.472e-06 S  per = 0.000552  per(accum) = 52
 T(global opt: preprocess_renorm_batchGPU   ) = 8.572e-02 S  per = 32.2  per(accum) = 84.1
 T(global opt: reduction of opS & opH [nccl]) = 1.762e-05 S  per = 0.00661  per(accum) = 84.1
 T(global opt: qops memcpy gpu2cpu          ) = 3.052e-03 S  per = 1.14  per(accum) = 85.3
 T(global opt: deallocate cpu and gpu memory) = 4.464e-04 S  per = 0.167  per(accum) = 85.5
 T(global opt: reduction of opS & opH [comm]) = 2.817e-03 S  per = 1.06  per(accum) = 86.5
 T(global opt: conversion from opAB to opPQ ) = 1.443e-02 S  per = 5.42  per(accum) = 91.9
 T(global opt: after oper_renorm            ) = 2.151e-02 S  per = 8.07  per(accum) = 100

isweep=0 ibond=30/seqsize=34 dots=2 dbond=(4,0)-(5,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.377e+01S Sys:1.219e+00S Total:5.499e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=783:5.974e-03MB:5.834e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=841:6.416e-03MB:6.266e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=4,14,1,1
 suppl= 0 1 2 3
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 4
 suppc2= 16
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:4 S:16 H:1 A:16 B:20 
        dim(bra,ket)=7,7 size(op)=19:1.450e-04MB size(tot)=657:5.013e-03MB:4.895e-06GB
 rqops: oplist=CSHPQ nops=C:14 S:6 H:1 P:36 Q:42 
        dim(bra,ket)=10,10 size(op)=58:4.425e-04MB size(tot)=2238:1.707e-02MB:1.667e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=4891:3.732e-02MB:3.644e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(5,0) fdel=./scratch/sweep/lop(4,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
wf4(diml,dimr,dimc1,dimc2)=(7,10,3,3) nnz=139:1.060e-03MB
qtensor4: wf4 own=1 _data=0x55a32284db80
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=7
 (7,1):3 (6,2):3 (5,3):1
 qbond: qcol nsym=4 dimAll=10
 (21,3):4 (21,1):3 (22,2):2 (22,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=192 size=139:1.060e-03MB
### DIAG TIMING: total=2.461e-03 t1=8.986e-06, t2=1.333e-05, t3=1.711e-05, t4=2.397e-03, t5=4.209e-06, t6=1.726e-05, t7=4.005e-06
duration_diagGPU:2.536e-03
duration_diagreduce:3.100e-08
duration_diagtransform:3.250e-07
----- TIMING FOR symbolic_formulae_twodot with size=437 : 7.636e-04 S -----
rank=0 GPUmem(GB): used=3.64e-05 (oper)=3.64e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=437
 no. of hintermediate operators=240
 no. of coefficients=2470:0.0188MB:1.84e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.057e-04 S -----
rank=0 GPUmem(GB): used=5.48e-05 (oper,hinter)=3.64e-05,1.84e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0141 S size(H_formulae)=437 size(Hxlst2)=21 T(Hmu/Hxlist)=0.000151,0.014 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0144 S size(H_formulae)=437 size(Hxlst)=8552 -----
rank=0 GPUmem(GB): used=0.00222 (oper,hinter,dvdson,batch)=3.64e-05,1.84e-05,2.07e-06,0.00217 blksize=12 blksize0=9 batchsize=8552
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=139 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.05e-05,0.000159,0.000967,0.000733,0.0019
 ndim=139:1.04e-06GB t[comm(intra)]=2.34e-05 speed=0.0886GB/S t[comm(inter)]=7.15e-06 speed=0.29GB/S
--- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=9.7e-04 t_reduction=7.3e-04 tot=1.9e-03 ---
 sigma[inter] counter=187 t=1.6e-04 per=8.6e+00 cost=5.9e+05 flops=3.7e+09
 sigma[gemm] counter=187 i=0 t=2.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=2 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=3 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=4 t=2.8e-04 per=1.5e+01 cost=1.2e+05 flops=4.3e+08
 sigma[gemm] counter=187 i=5 t=3.2e-04 per=1.7e+01 cost=1.3e+05 flops=4.0e+08
 sigma[gemm] counter=187 i=6 t=1.7e-04 per=9.4e+00 cost=1.3e+05 flops=7.6e+08
 sigma[gemm] counter=187 i=7 t=1.8e-04 per=9.6e+00 cost=1.4e+05 flops=7.8e+08
 sigma[gemm] counter=187 total t=9.7e-04 per=5.2e+01 cost=5.2e+05 flops=5.4e+08
 sigma[red] counter=187 t=7.3e-04 per=3.9e+01 cost=1.2e+05 flops=1.6e+08
--- TIMING FOR sigma_tot : t_inter=3.4e-02 t_gemm=1.6e-01 t_reduction=1.5e-01 tot=3.5e-01 ---
 sigma_tot[inter] counter=187 t=3.4e-02 per=9.7e+00 cost=1.7e+08 flops=5.0e+09
 sigma_tot[gemm] counter=187 i=0 t=4.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=1 t=4.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=2 t=4.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=3 t=4.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=4 t=3.9e-02 per=1.1e+01 cost=3.2e+07 flops=8.2e+08
 sigma_tot[gemm] counter=187 i=5 t=4.2e-02 per=1.2e+01 cost=3.2e+07 flops=7.7e+08
 sigma_tot[gemm] counter=187 i=6 t=4.1e-02 per=1.2e+01 cost=2.9e+07 flops=7.2e+08
 sigma_tot[gemm] counter=187 i=7 t=4.0e-02 per=1.1e+01 cost=3.1e+07 flops=7.7e+08
 sigma_tot[gemm] counter=187 total t=1.6e-01 per=4.7e+01 cost=1.2e+08 flops=7.6e+08
 sigma_tot[red] counter=187 t=1.5e-01 per=4.4e+01 cost=3.0e+07 flops=2.0e+08
T(sub)=7.7e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,3.1e-06,9.5e-07,8.8e-07,2.2e-07
settings: ndim=139 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336635896538 -1.116e+03  1.000e-02    1     1  3.944e-03 3.944e-03 3.776e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.848e-05,1.402e-04,7.880e-04,7.118e-04,1.673e-03
 ndim=139:1.036e-06GB t[comm(intra)]=2.276e-05 speed=9.101e-02GB/S t[comm(inter)]=5.725e-06 speed=3.618e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=7.9e-04 t_reduction=7.1e-04 tot=1.6e-03 ---
 sigma[inter] counter=188 t=1.4e-04 per=8.5e+00 cost=5.9e+05 flops=4.2e+09
 sigma[gemm] counter=188 i=0 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=1 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=2 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=3 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=4 t=2.3e-04 per=1.4e+01 cost=1.2e+05 flops=5.3e+08
 sigma[gemm] counter=188 i=5 t=2.4e-04 per=1.5e+01 cost=1.3e+05 flops=5.3e+08
 sigma[gemm] counter=188 i=6 t=1.5e-04 per=9.4e+00 cost=1.3e+05 flops=8.7e+08
 sigma[gemm] counter=188 i=7 t=1.6e-04 per=9.5e+00 cost=1.4e+05 flops=8.9e+08
 sigma[gemm] counter=188 total t=7.9e-04 per=4.8e+01 cost=5.2e+05 flops=6.6e+08
 sigma[red] counter=188 t=7.1e-04 per=4.3e+01 cost=1.2e+05 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=3.4e-02 t_gemm=1.6e-01 t_reduction=1.5e-01 tot=3.5e-01 ---
 sigma_tot[inter] counter=188 t=3.4e-02 per=9.7e+00 cost=1.7e+08 flops=5.0e+09
 sigma_tot[gemm] counter=188 i=0 t=4.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=1 t=4.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=2 t=4.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=3 t=4.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=4 t=3.9e-02 per=1.1e+01 cost=3.2e+07 flops=8.2e+08
 sigma_tot[gemm] counter=188 i=5 t=4.2e-02 per=1.2e+01 cost=3.2e+07 flops=7.7e+08
 sigma_tot[gemm] counter=188 i=6 t=4.1e-02 per=1.2e+01 cost=2.9e+07 flops=7.2e+08
 sigma_tot[gemm] counter=188 i=7 t=4.0e-02 per=1.1e+01 cost=3.1e+07 flops=7.7e+08
 sigma_tot[gemm] counter=188 total t=1.6e-01 per=4.7e+01 cost=1.2e+08 flops=7.6e+08
 sigma_tot[red] counter=188 t=1.5e-01 per=4.4e+01 cost=3.0e+07 flops=2.0e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,9.9e-06,2.2e-06,1.0e-06,1.8e-07
    2   0 -    -116.336823387383 -1.875e-04  2.655e-03    2     2  7.882e-03 3.941e-03 3.626e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.730e-05,1.311e-04,7.922e-04,7.123e-04,1.668e-03
 ndim=139:1.036e-06GB t[comm(intra)]=2.212e-05 speed=9.362e-02GB/S t[comm(inter)]=5.178e-06 speed=4.000e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=7.9e-04 t_reduction=7.1e-04 tot=1.6e-03 ---
 sigma[inter] counter=189 t=1.3e-04 per=8.0e+00 cost=5.9e+05 flops=4.5e+09
 sigma[gemm] counter=189 i=0 t=2.8e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=1 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=2 t=2.2e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=3 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=4 t=2.2e-04 per=1.3e+01 cost=1.2e+05 flops=5.5e+08
 sigma[gemm] counter=189 i=5 t=2.5e-04 per=1.5e+01 cost=1.3e+05 flops=5.1e+08
 sigma[gemm] counter=189 i=6 t=1.6e-04 per=9.7e+00 cost=1.3e+05 flops=8.4e+08
 sigma[gemm] counter=189 i=7 t=1.6e-04 per=9.6e+00 cost=1.4e+05 flops=8.9e+08
 sigma[gemm] counter=189 total t=7.9e-04 per=4.8e+01 cost=5.2e+05 flops=6.6e+08
 sigma[red] counter=189 t=7.1e-04 per=4.4e+01 cost=1.2e+05 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=3.4e-02 t_gemm=1.6e-01 t_reduction=1.5e-01 tot=3.5e-01 ---
 sigma_tot[inter] counter=189 t=3.4e-02 per=9.7e+00 cost=1.7e+08 flops=5.0e+09
 sigma_tot[gemm] counter=189 i=0 t=4.9e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=1 t=4.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=2 t=4.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=3 t=4.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=4 t=3.9e-02 per=1.1e+01 cost=3.2e+07 flops=8.2e+08
 sigma_tot[gemm] counter=189 i=5 t=4.2e-02 per=1.2e+01 cost=3.2e+07 flops=7.7e+08
 sigma_tot[gemm] counter=189 i=6 t=4.1e-02 per=1.2e+01 cost=2.9e+07 flops=7.2e+08
 sigma_tot[gemm] counter=189 i=7 t=4.0e-02 per=1.1e+01 cost=3.1e+07 flops=7.7e+08
 sigma_tot[gemm] counter=189 total t=1.6e-01 per=4.7e+01 cost=1.2e+08 flops=7.6e+08
 sigma_tot[red] counter=189 t=1.5e-01 per=4.4e+01 cost=3.0e+07 flops=2.0e+08
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.2e-05,1.9e-06,1.1e-06,1.6e-07
    3   0 -    -116.336847409293 -2.402e-05  1.454e-03    3     3  1.146e-02 3.820e-03 3.553e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.694e-05,1.272e-04,7.875e-04,7.143e-04,1.661e-03
 ndim=139:1.036e-06GB t[comm(intra)]=2.186e-05 speed=9.474e-02GB/S t[comm(inter)]=5.073e-06 speed=4.083e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=7.9e-04 t_reduction=7.1e-04 tot=1.6e-03 ---
 sigma[inter] counter=190 t=1.3e-04 per=7.8e+00 cost=5.9e+05 flops=4.6e+09
 sigma[gemm] counter=190 i=0 t=2.4e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=1 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=2 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=3 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=4 t=2.3e-04 per=1.4e+01 cost=1.2e+05 flops=5.4e+08
 sigma[gemm] counter=190 i=5 t=2.4e-04 per=1.5e+01 cost=1.3e+05 flops=5.3e+08
 sigma[gemm] counter=190 i=6 t=1.5e-04 per=9.3e+00 cost=1.3e+05 flops=8.8e+08
 sigma[gemm] counter=190 i=7 t=1.6e-04 per=1.0e+01 cost=1.4e+05 flops=8.5e+08
 sigma[gemm] counter=190 total t=7.9e-04 per=4.8e+01 cost=5.2e+05 flops=6.6e+08
 sigma[red] counter=190 t=7.1e-04 per=4.4e+01 cost=1.2e+05 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=3.4e-02 t_gemm=1.6e-01 t_reduction=1.5e-01 tot=3.5e-01 ---
 sigma_tot[inter] counter=190 t=3.4e-02 per=9.7e+00 cost=1.7e+08 flops=5.0e+09
 sigma_tot[gemm] counter=190 i=0 t=5.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=1 t=4.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=2 t=4.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=3 t=4.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=4 t=3.9e-02 per=1.1e+01 cost=3.2e+07 flops=8.2e+08
 sigma_tot[gemm] counter=190 i=5 t=4.2e-02 per=1.2e+01 cost=3.2e+07 flops=7.7e+08
 sigma_tot[gemm] counter=190 i=6 t=4.1e-02 per=1.2e+01 cost=2.9e+07 flops=7.2e+08
 sigma_tot[gemm] counter=190 i=7 t=4.0e-02 per=1.1e+01 cost=3.1e+07 flops=7.7e+08
 sigma_tot[gemm] counter=190 total t=1.6e-01 per=4.7e+01 cost=1.3e+08 flops=7.6e+08
 sigma_tot[red] counter=190 t=1.5e-01 per=4.4e+01 cost=3.0e+07 flops=2.0e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.0e-05,1.7e-06,1.0e-06,1.4e-07
    4   0 -    -116.336854059180 -6.650e-06  6.153e-04    3     4  1.506e-02 3.765e-03 3.521e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.691e-05,1.268e-04,7.734e-04,7.113e-04,1.643e-03
 ndim=139:1.036e-06GB t[comm(intra)]=2.157e-05 speed=9.604e-02GB/S t[comm(inter)]=5.346e-06 speed=3.874e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=7.7e-04 t_reduction=7.1e-04 tot=1.6e-03 ---
 sigma[inter] counter=191 t=1.3e-04 per=7.9e+00 cost=5.9e+05 flops=4.7e+09
 sigma[gemm] counter=191 i=0 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=1 t=2.2e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=2 t=2.2e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=3 t=2.2e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=4 t=2.2e-04 per=1.4e+01 cost=1.2e+05 flops=5.5e+08
 sigma[gemm] counter=191 i=5 t=2.4e-04 per=1.5e+01 cost=1.3e+05 flops=5.4e+08
 sigma[gemm] counter=191 i=6 t=1.5e-04 per=9.6e+00 cost=1.3e+05 flops=8.6e+08
 sigma[gemm] counter=191 i=7 t=1.5e-04 per=9.5e+00 cost=1.4e+05 flops=9.1e+08
 sigma[gemm] counter=191 total t=7.7e-04 per=4.8e+01 cost=5.2e+05 flops=6.7e+08
 sigma[red] counter=191 t=7.1e-04 per=4.4e+01 cost=1.2e+05 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=3.5e-02 t_gemm=1.7e-01 t_reduction=1.6e-01 tot=3.6e-01 ---
 sigma_tot[inter] counter=191 t=3.5e-02 per=9.7e+00 cost=1.7e+08 flops=5.0e+09
 sigma_tot[gemm] counter=191 i=0 t=5.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=1 t=4.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=2 t=4.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=3 t=4.2e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=4 t=4.0e-02 per=1.1e+01 cost=3.2e+07 flops=8.2e+08
 sigma_tot[gemm] counter=191 i=5 t=4.3e-02 per=1.2e+01 cost=3.3e+07 flops=7.6e+08
 sigma_tot[gemm] counter=191 i=6 t=4.1e-02 per=1.2e+01 cost=3.0e+07 flops=7.2e+08
 sigma_tot[gemm] counter=191 i=7 t=4.0e-02 per=1.1e+01 cost=3.1e+07 flops=7.7e+08
 sigma_tot[gemm] counter=191 total t=1.7e-01 per=4.7e+01 cost=1.3e+08 flops=7.6e+08
 sigma_tot[red] counter=191 t=1.6e-01 per=4.4e+01 cost=3.0e+07 flops=2.0e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.1e-05,1.5e-06,1.0e-06,1.3e-07
    5   0 -    -116.336854925618 -8.664e-07  2.552e-04    3     5  1.860e-02 3.719e-03 3.491e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.680e-05,1.282e-04,7.848e-04,7.097e-04,1.654e-03
 ndim=139:1.036e-06GB t[comm(intra)]=2.188e-05 speed=9.469e-02GB/S t[comm(inter)]=4.923e-06 speed=4.207e-01GB/S
--- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=7.8e-04 t_reduction=7.1e-04 tot=1.6e-03 ---
 sigma[inter] counter=192 t=1.3e-04 per=7.9e+00 cost=5.9e+05 flops=4.6e+09
 sigma[gemm] counter=192 i=0 t=2.4e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=1 t=2.2e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=2 t=2.2e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=3 t=2.2e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=4 t=2.3e-04 per=1.4e+01 cost=1.2e+05 flops=5.3e+08
 sigma[gemm] counter=192 i=5 t=2.4e-04 per=1.5e+01 cost=1.3e+05 flops=5.3e+08
 sigma[gemm] counter=192 i=6 t=1.5e-04 per=9.3e+00 cost=1.3e+05 flops=8.8e+08
 sigma[gemm] counter=192 i=7 t=1.6e-04 per=9.6e+00 cost=1.4e+05 flops=8.9e+08
 sigma[gemm] counter=192 total t=7.8e-04 per=4.8e+01 cost=5.2e+05 flops=6.6e+08
 sigma[red] counter=192 t=7.1e-04 per=4.4e+01 cost=1.2e+05 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=3.5e-02 t_gemm=1.7e-01 t_reduction=1.6e-01 tot=3.6e-01 ---
 sigma_tot[inter] counter=192 t=3.5e-02 per=9.7e+00 cost=1.7e+08 flops=5.0e+09
 sigma_tot[gemm] counter=192 i=0 t=5.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=1 t=4.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=2 t=4.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=3 t=4.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=4 t=4.0e-02 per=1.1e+01 cost=3.3e+07 flops=8.2e+08
 sigma_tot[gemm] counter=192 i=5 t=4.3e-02 per=1.2e+01 cost=3.3e+07 flops=7.6e+08
 sigma_tot[gemm] counter=192 i=6 t=4.1e-02 per=1.2e+01 cost=3.0e+07 flops=7.2e+08
 sigma_tot[gemm] counter=192 i=7 t=4.1e-02 per=1.1e+01 cost=3.1e+07 flops=7.7e+08
 sigma_tot[gemm] counter=192 total t=1.7e-01 per=4.7e+01 cost=1.3e+08 flops=7.6e+08
 sigma_tot[red] counter=192 t=1.6e-01 per=4.4e+01 cost=3.1e+07 flops=2.0e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.0e-05,1.7e-06,1.1e-06,1.2e-07
    6   0 -    -116.336855100777 -1.752e-07  1.084e-04    3     6  2.215e-02 3.691e-03 3.473e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.789e-05,1.357e-04,7.773e-04,7.089e-04,1.655e-03
 ndim=139:1.036e-06GB t[comm(intra)]=2.294e-05 speed=9.028e-02GB/S t[comm(inter)]=4.951e-06 speed=4.184e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=7.8e-04 t_reduction=7.1e-04 tot=1.6e-03 ---
 sigma[inter] counter=193 t=1.4e-04 per=8.4e+00 cost=5.9e+05 flops=4.4e+09
 sigma[gemm] counter=193 i=0 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=1 t=2.9e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=2 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=3 t=3.0e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=4 t=2.2e-04 per=1.4e+01 cost=1.2e+05 flops=5.5e+08
 sigma[gemm] counter=193 i=5 t=2.3e-04 per=1.4e+01 cost=1.3e+05 flops=5.4e+08
 sigma[gemm] counter=193 i=6 t=1.6e-04 per=9.7e+00 cost=1.3e+05 flops=8.5e+08
 sigma[gemm] counter=193 i=7 t=1.6e-04 per=9.6e+00 cost=1.4e+05 flops=9.0e+08
 sigma[gemm] counter=193 total t=7.8e-04 per=4.8e+01 cost=5.2e+05 flops=6.7e+08
 sigma[red] counter=193 t=7.1e-04 per=4.4e+01 cost=1.2e+05 flops=1.7e+08
--- TIMING FOR sigma_tot : t_inter=3.5e-02 t_gemm=1.7e-01 t_reduction=1.6e-01 tot=3.6e-01 ---
 sigma_tot[inter] counter=193 t=3.5e-02 per=9.7e+00 cost=1.7e+08 flops=5.0e+09
 sigma_tot[gemm] counter=193 i=0 t=5.0e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=1 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=2 t=4.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=3 t=4.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=4 t=4.0e-02 per=1.1e+01 cost=3.3e+07 flops=8.2e+08
 sigma_tot[gemm] counter=193 i=5 t=4.3e-02 per=1.2e+01 cost=3.3e+07 flops=7.6e+08
 sigma_tot[gemm] counter=193 i=6 t=4.1e-02 per=1.2e+01 cost=3.0e+07 flops=7.2e+08
 sigma_tot[gemm] counter=193 i=7 t=4.1e-02 per=1.1e+01 cost=3.2e+07 flops=7.7e+08
 sigma_tot[gemm] counter=193 total t=1.7e-01 per=4.7e+01 cost=1.3e+08 flops=7.6e+08
 sigma_tot[red] counter=193 t=1.6e-01 per=4.4e+01 cost=3.1e+07 flops=2.0e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.0e-05,1.6e-06,1.0e-06,1.5e-07
    7   0 +    -116.336855132062 -3.128e-08  3.614e-05    3     7  2.571e-02 3.673e-03 3.462e-03
TIMING FOR Davidson : 2.578e-02  T(cal/comm/rest)=2.423e-02,2.910e-07,1.550e-03
decomposed t_rest=1.550e-03
 T(sub)    =1.151e-04 per=7.427e+00
 T(precond)=1.618e-04 per=1.044e+01
 T(ortho)  =1.062e-05 per=6.854e-01
 T(xcopy)  =8.540e-07 per=5.511e-02
 T(xnrm2)  =1.269e-06 per=8.189e-02
 T(other)  =1.260e-03 per=8.131e+01
optimized energies: isweep=0 ibond=30 dots=2 e[0]=-116.336855132062 nmvp=7
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.507e+01S Sys:1.219e+00S Total:5.629e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=10 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond30.txt
 qbond: qsuper nsym=10 dimAll=40
 (21,3):4 (21,1):3 (22,2):9 (22,4):5 (23,3):7 (23,1):5 (24,2):2 (24,4):1 (22,0):3 (23,5):1
----- TMING FOR decimation_genbasis(su2): 8.1e-05 S -----
decimation summary: 40->10 dwt=+5.309e-06 SvN=6.954e-01
 qbond: qkept nsym=5 dimAll=10
 (22,2):3 (23,3):3 (23,1):2 (21,1):1 (24,2):1
----- TIMING for decimation_row(nkr): 3.109e-03 S T(decim/select/formRot)=3.420e-04,2.608e-03,1.587e-04 -----
----- TIMING FOR twodot_decimation: 3.335e-03 S T(wf/decim)=1.469e-04,3.189e-03 -----
ctns::oper_renorm coord=(5,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:15 S:5 H:1 P:25 Q:30 
        dim(bra,ket)=10,10 size(op)=36:2.747e-04MB size(tot)=1539:1.174e-02MB:1.147e-05GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.530e+01S Sys:1.219e+00S Total:5.652e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=76 : 3.580e-04 S -----
rank=0 GPUmem(GB): used=6.14e-05 (oper)=3.56e-05
rank=0 GPUmem(GB): used=6.19e-05 (oper,site)(GB)=3.56e-05,4.69e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=76
 no. of rintermediate operators=100
 no. of coefficients=1400:0.0107MB:1.04e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.858e-04 S -----
rank=0 GPUmem(GB): used=7.23e-05 (oper,site,rinter)=3.56e-05,4.69e-07,1.04e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00143 S size(rtasks)=76 size(Rlst2)=25 T(Rmu/Rlist)=9.3e-05,0.00134 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00155 S size(rtasks)=76 size(Rlst)=1729 -----
rank=0 GPUmem(GB): used=7.23e-05 (oper,site,rinter,batch)=3.56e-05,4.69e-07,1.04e-05,0.000425 blksize=12 blksize0=8 batchsize=1729
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000103,0.000918,0.000252
--- TIMING FOR renorm : t_inter=1.0e-04 t_gemm=9.2e-04 t_reduction=2.5e-04 tot=1.3e-03 ---
 renorm[inter] counter=31 t=1.0e-04 per=8.1e+00 cost=9.4e+04 flops=9.1e+08
 renorm[gemm] counter=31 i=0 t=2.8e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=1 t=2.3e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=2 t=2.4e-04 per=1.9e+01 cost=1.4e+04 flops=5.6e+07
 renorm[gemm] counter=31 i=3 t=3.7e-04 per=2.9e+01 cost=3.6e+04 flops=9.6e+07
 renorm[gemm] counter=31 i=4 t=2.3e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=5 t=2.2e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=31 i=6 t=2.9e-04 per=2.3e+01 cost=6.1e+04 flops=2.1e+08
 renorm[gemm] counter=31 total t=9.2e-04 per=7.2e+01 cost=1.1e+05 flops=1.2e+08
 renorm[red] counter=31 t=2.5e-04 per=2.0e+01 cost=2.3e+04 flops=9.1e+07
--- TIMING FOR renorm_tot : t_inter=4.3e-03 t_gemm=2.1e-02 t_reduction=7.7e-03 tot=3.3e-02 ---
 renorm_tot[inter] counter=31 t=4.3e-03 per=1.3e+01 cost=3.1e+06 flops=7.2e+08
 renorm_tot[gemm] counter=31 i=0 t=8.8e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=31 i=1 t=7.1e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=31 i=2 t=3.1e-03 per=9.4e+00 cost=2.0e+05 flops=6.3e+07
 renorm_tot[gemm] counter=31 i=3 t=3.6e-03 per=1.1e+01 cost=5.5e+05 flops=1.5e+08
 renorm_tot[gemm] counter=31 i=4 t=3.6e-03 per=1.1e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=31 i=5 t=3.6e-03 per=1.1e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=31 i=6 t=7.3e-03 per=2.2e+01 cost=1.9e+06 flops=2.6e+08
 renorm_tot[gemm] counter=31 total t=2.1e-02 per=6.4e+01 cost=3.4e+06 flops=1.6e+08
 renorm_tot[red] counter=31 t=7.7e-03 per=2.3e+01 cost=8.3e+05 flops=1.1e+08
qops.to_cpu: size(tot)=1539:1.2e-02MB:1.1e-05GB t[to_cpu]=1.8e-05S speed=6.5e-01GB/S
check ||H-H.dagger||=1.353e-14 coord=(5,0) rank=0
ctns::oper_ab2pq coord=(5,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00665 S rank=0 -----
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.552e+01S Sys:1.219e+00S Total:5.673e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=789:6.020e-03MB:5.879e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=49:3.738e-04MB:3.651e-07GB
total mem of comb=839:6.401e-03MB:6.251e-06GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.552e+01S Sys:1.219e+00S Total:5.674e+01S
##### local opt: 7.087e-02 S #####
 T(local opt: fetch) = 6.372e-03 S  per = 8.99  per(accum) = 8.99
 T(local opt: hdiag) = 3.362e-03 S  per = 4.74  per(accum) = 13.7
 T(local opt: dvdsn) = 4.549e-02 S  per = 64.2  per(accum) = 77.9
 T(local opt: decim) = 3.419e-03 S  per = 4.83  per(accum) = 82.8
 T(local opt: guess) = 8.750e-05 S  per = 0.123  per(accum) = 82.9
 T(local opt: renrm) = 7.463e-03 S  per = 10.5  per(accum) = 93.4
 T(local opt: save ) = 4.672e-03 S  per = 6.59  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.549e-02 S  T(sum) = 4.467e-02 S  per = 9.819e+01
 T(local opt: preprocess                  ) = 4.653e-04 S  per = 1.04  per(accum) = 1.04
 T(local opt: symbolic_formulae           ) = 8.393e-04 S  per = 1.88  per(accum) = 2.92
 T(local opt: hintermediate init          ) = 5.101e-04 S  per = 1.14  per(accum) = 4.06
 T(local opt: preprocess_hformulae_Hxlist ) = 1.450e-02 S  per = 32.5  per(accum) = 36.5
 T(local opt: hmmtasks init               ) = 2.346e-03 S  per = 5.25  per(accum) = 41.8
 T(local opt: initial guess for dvdson    ) = 2.189e-04 S  per = 0.49  per(accum) = 42.3
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.404e-02 S  per = 53.8  per(accum) = 96.1
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.948e-04 S  per = 0.436  per(accum) = 96.5
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.910e-07 S  per = 0.000651  per(accum) = 96.5
 T(local opt: dvdson solver [rest part]   ) = 1.550e-03 S  per = 3.47  per(accum) = 100
Detailed decomposition of T(renrm) = 7.463e-03 S  T(sum) = 7.463e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.036e-04 S  per = 1.39  per(accum) = 1.39
 T(local opt: qops init                    ) = 4.104e-04 S  per =  5.5  per(accum) = 6.89
 T(local opt: symbolic_formulae_renorm     ) = 4.364e-04 S  per = 5.85  per(accum) = 12.7
 T(local opt: allocate qops on gpu         ) = 9.142e-05 S  per = 1.22  per(accum) = 14
 T(local opt: site memcpy cpu2gpu          ) = 8.024e-05 S  per = 1.08  per(accum) = 15
 T(local opt: rintermediate init           ) = 4.159e-04 S  per = 5.57  per(accum) = 20.6
 T(local opt: preprocess_formulae_Rlist2   ) = 1.620e-03 S  per = 21.7  per(accum) = 42.3
 T(local opt: rmmtasks init                ) = 5.217e-04 S  per = 6.99  per(accum) = 49.3
 T(local opt: qops memset on cpu           ) = 4.700e-08 S  per = 0.00063  per(accum) = 49.3
 T(local opt: preprocess_renorm_batchGPU   ) = 2.900e-03 S  per = 38.9  per(accum) = 88.2
 T(local opt: reduction of opS & opH [nccl]) = 6.200e-07 S  per = 0.00831  per(accum) = 88.2
 T(local opt: qops memcpy gpu2cpu          ) = 8.285e-05 S  per = 1.11  per(accum) = 89.3
 T(local opt: deallocate cpu and gpu memory) = 9.742e-06 S  per = 0.131  per(accum) = 89.4
 T(local opt: reduction of opS & opH [comm]) = 8.270e-05 S  per = 1.11  per(accum) = 90.5
 T(local opt: conversion from opAB to opPQ ) = 7.037e-05 S  per = 0.943  per(accum) = 91.5
 T(local opt: after oper_renorm            ) = 6.371e-04 S  per = 8.54  per(accum) = 100
##### sweep opt: 2.737e+00 S #####
 T(sweep opt: fetch) = 2.011e-01 S  per = 7.35  per(accum) = 7.35
 T(sweep opt: hdiag) = 1.761e-01 S  per = 6.43  per(accum) = 13.8
 T(sweep opt: dvdsn) = 1.824e+00 S  per = 66.7  per(accum) = 80.4
 T(sweep opt: decim) = 1.158e-01 S  per = 4.23  per(accum) = 84.7
 T(sweep opt: guess) = 3.651e-03 S  per = 0.133  per(accum) = 84.8
 T(sweep opt: renrm) = 2.740e-01 S  per =   10  per(accum) = 94.8
 T(sweep opt: save ) = 1.417e-01 S  per = 5.18  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.824e+00 S  T(sum) = 1.797e+00 S  per = 9.848e+01
 T(sweep opt: preprocess                  ) = 1.993e-02 S  per = 1.11  per(accum) = 1.11
 T(sweep opt: symbolic_formulae           ) = 3.388e-02 S  per = 1.89  per(accum) = 2.99
 T(sweep opt: hintermediate init          ) = 1.804e-02 S  per =    1  per(accum) = 4
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.771e-01 S  per = 43.3  per(accum) = 47.3
 T(sweep opt: hmmtasks init               ) = 1.316e-01 S  per = 7.32  per(accum) = 54.6
 T(sweep opt: initial guess for dvdson    ) = 7.631e-03 S  per = 0.425  per(accum) = 55
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 7.492e-01 S  per = 41.7  per(accum) = 96.7
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 5.537e-03 S  per = 0.308  per(accum) = 97
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 8.726e-06 S  per = 0.000486  per(accum) = 97
 T(sweep opt: dvdson solver [rest part]   ) = 5.369e-02 S  per = 2.99  per(accum) = 100
Detailed decomposition of T(renrm) = 2.740e-01 S  T(sum) = 2.740e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.668e-03 S  per = 1.34  per(accum) = 1.34
 T(sweep opt: qops init                    ) = 1.467e-02 S  per = 5.35  per(accum) = 6.69
 T(sweep opt: symbolic_formulae_renorm     ) = 1.567e-02 S  per = 5.72  per(accum) = 12.4
 T(sweep opt: allocate qops on gpu         ) = 2.925e-03 S  per = 1.07  per(accum) = 13.5
 T(sweep opt: site memcpy cpu2gpu          ) = 2.774e-03 S  per = 1.01  per(accum) = 14.5
 T(sweep opt: rintermediate init           ) = 1.460e-02 S  per = 5.33  per(accum) = 19.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.662e-02 S  per = 24.3  per(accum) = 44.1
 T(sweep opt: rmmtasks init                ) = 2.129e-02 S  per = 7.77  per(accum) = 51.9
 T(sweep opt: qops memset on cpu           ) = 1.519e-06 S  per = 0.000554  per(accum) = 51.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.862e-02 S  per = 32.3  per(accum) = 84.2
 T(sweep opt: reduction of opS & opH [nccl]) = 1.824e-05 S  per = 0.00666  per(accum) = 84.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.135e-03 S  per = 1.14  per(accum) = 85.4
 T(sweep opt: deallocate cpu and gpu memory) = 4.561e-04 S  per = 0.166  per(accum) = 85.6
 T(sweep opt: reduction of opS & opH [comm]) = 2.899e-03 S  per = 1.06  per(accum) = 86.6
 T(sweep opt: conversion from opAB to opPQ ) = 1.450e-02 S  per = 5.29  per(accum) = 91.9
 T(sweep opt: after oper_renorm            ) = 2.215e-02 S  per = 8.08  per(accum) = 100
##### global opt: 2.737e+00 S #####
 T(global opt: fetch) = 2.011e-01 S  per = 7.35  per(accum) = 7.35
 T(global opt: hdiag) = 1.761e-01 S  per = 6.43  per(accum) = 13.8
 T(global opt: dvdsn) = 1.824e+00 S  per = 66.7  per(accum) = 80.4
 T(global opt: decim) = 1.158e-01 S  per = 4.23  per(accum) = 84.7
 T(global opt: guess) = 3.651e-03 S  per = 0.133  per(accum) = 84.8
 T(global opt: renrm) = 2.740e-01 S  per =   10  per(accum) = 94.8
 T(global opt: save ) = 1.417e-01 S  per = 5.18  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.824e+00 S  T(sum) = 1.797e+00 S  per = 9.848e+01
 T(global opt: preprocess                  ) = 1.993e-02 S  per = 1.11  per(accum) = 1.11
 T(global opt: symbolic_formulae           ) = 3.388e-02 S  per = 1.89  per(accum) = 2.99
 T(global opt: hintermediate init          ) = 1.804e-02 S  per =    1  per(accum) = 4
 T(global opt: preprocess_hformulae_Hxlist ) = 7.771e-01 S  per = 43.3  per(accum) = 47.3
 T(global opt: hmmtasks init               ) = 1.316e-01 S  per = 7.32  per(accum) = 54.6
 T(global opt: initial guess for dvdson    ) = 7.631e-03 S  per = 0.425  per(accum) = 55
 T(global opt: dvdson solver [Hx_batchGPU] ) = 7.492e-01 S  per = 41.7  per(accum) = 96.7
 T(global opt: dvdson solver [comm(gpu)]   ) = 5.537e-03 S  per = 0.308  per(accum) = 97
 T(global opt: dvdson solver [comm(cpu)]   ) = 8.726e-06 S  per = 0.000486  per(accum) = 97
 T(global opt: dvdson solver [rest part]   ) = 5.369e-02 S  per = 2.99  per(accum) = 100
Detailed decomposition of T(renrm) = 2.740e-01 S  T(sum) = 2.740e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.668e-03 S  per = 1.34  per(accum) = 1.34
 T(global opt: qops init                    ) = 1.467e-02 S  per = 5.35  per(accum) = 6.69
 T(global opt: symbolic_formulae_renorm     ) = 1.567e-02 S  per = 5.72  per(accum) = 12.4
 T(global opt: allocate qops on gpu         ) = 2.925e-03 S  per = 1.07  per(accum) = 13.5
 T(global opt: site memcpy cpu2gpu          ) = 2.774e-03 S  per = 1.01  per(accum) = 14.5
 T(global opt: rintermediate init           ) = 1.460e-02 S  per = 5.33  per(accum) = 19.8
 T(global opt: preprocess_formulae_Rlist2   ) = 6.662e-02 S  per = 24.3  per(accum) = 44.1
 T(global opt: rmmtasks init                ) = 2.129e-02 S  per = 7.77  per(accum) = 51.9
 T(global opt: qops memset on cpu           ) = 1.519e-06 S  per = 0.000554  per(accum) = 51.9
 T(global opt: preprocess_renorm_batchGPU   ) = 8.862e-02 S  per = 32.3  per(accum) = 84.2
 T(global opt: reduction of opS & opH [nccl]) = 1.824e-05 S  per = 0.00666  per(accum) = 84.3
 T(global opt: qops memcpy gpu2cpu          ) = 3.135e-03 S  per = 1.14  per(accum) = 85.4
 T(global opt: deallocate cpu and gpu memory) = 4.561e-04 S  per = 0.166  per(accum) = 85.6
 T(global opt: reduction of opS & opH [comm]) = 2.899e-03 S  per = 1.06  per(accum) = 86.6
 T(global opt: conversion from opAB to opPQ ) = 1.450e-02 S  per = 5.29  per(accum) = 91.9
 T(global opt: after oper_renorm            ) = 2.215e-02 S  per = 8.08  per(accum) = 100

isweep=0 ibond=31/seqsize=34 dots=2 dbond=(3,0)-(4,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.552e+01S Sys:1.220e+00S Total:5.674e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=789:6.020e-03MB:5.879e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=49:3.738e-04MB:3.651e-07GB
total mem of comb=839:6.401e-03MB:6.251e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=3,15,1,1
 suppl= 0 1 2
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 3
 suppc2= 4
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:3 S:17 H:1 A:9 B:12 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=155:1.183e-03MB:1.155e-06GB
 rqops: oplist=CSHPQ nops=C:15 S:5 H:1 P:25 Q:30 
        dim(bra,ket)=10,10 size(op)=36:2.747e-04MB size(tot)=1539:1.174e-02MB:1.147e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=3690:2.815e-02MB:2.749e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(4,0) fdel=./scratch/sweep/lop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
wf4(diml,dimr,dimc1,dimc2)=(4,10,3,3) nnz=66:5.035e-04MB
qtensor4: wf4 own=1 _data=0x55a3226cfcb0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=4
 (5,1):2 (6,0):1 (4,2):1
 qbond: qcol nsym=5 dimAll=10
 (22,2):3 (23,3):3 (23,1):2 (21,1):1 (24,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=24 nblocks=220 size=66:5.035e-04MB
### DIAG TIMING: total=1.666e-03 t1=8.666e-06, t2=1.412e-05, t3=1.808e-05, t4=1.599e-03, t5=4.348e-06, t6=1.748e-05, t7=4.031e-06
duration_diagGPU:1.757e-03
duration_diagreduce:2.700e-08
duration_diagtransform:2.550e-07
----- TIMING FOR symbolic_formulae_twodot with size=372 : 6.255e-04 S -----
rank=0 GPUmem(GB): used=2.75e-05 (oper)=2.75e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=372
 no. of hintermediate operators=217
 no. of coefficients=1722:0.0131MB:1.28e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.060e-04 S -----
rank=0 GPUmem(GB): used=4.03e-05 (oper,hinter)=2.75e-05,1.28e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0153 S size(H_formulae)=372 size(Hxlst2)=24 T(Hmu/Hxlist)=0.000128,0.0152 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0156 S size(H_formulae)=372 size(Hxlst)=9278 -----
rank=0 GPUmem(GB): used=0.00156 (oper,hinter,dvdson,batch)=2.75e-05,1.28e-05,9.83e-07,0.00152 blksize=6 blksize0=9 batchsize=9278
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=66 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.05e-05,0.000191,0.000892,0.000833,0.00195
 ndim=66:4.92e-07GB t[comm(intra)]=2.36e-05 speed=0.0416GB/S t[comm(inter)]=6.91e-06 speed=0.142GB/S
--- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=8.9e-04 t_reduction=8.3e-04 tot=1.9e-03 ---
 sigma[inter] counter=194 t=1.9e-04 per=1.0e+01 cost=2.7e+05 flops=1.4e+09
 sigma[gemm] counter=194 i=0 t=2.8e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=1 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=2 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=3 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=4 t=2.6e-04 per=1.3e+01 cost=5.0e+04 flops=2.0e+08
 sigma[gemm] counter=194 i=5 t=2.7e-04 per=1.4e+01 cost=5.1e+04 flops=1.9e+08
 sigma[gemm] counter=194 i=6 t=1.8e-04 per=9.6e+00 cost=3.4e+04 flops=1.9e+08
 sigma[gemm] counter=194 i=7 t=1.7e-04 per=9.0e+00 cost=3.5e+04 flops=2.0e+08
 sigma[gemm] counter=194 total t=8.9e-04 per=4.7e+01 cost=1.7e+05 flops=1.9e+08
 sigma[red] counter=194 t=8.3e-04 per=4.3e+01 cost=5.7e+04 flops=6.8e+07
--- TIMING FOR sigma_tot : t_inter=3.5e-02 t_gemm=1.7e-01 t_reduction=1.6e-01 tot=3.6e-01 ---
 sigma_tot[inter] counter=194 t=3.5e-02 per=9.7e+00 cost=1.7e+08 flops=5.0e+09
 sigma_tot[gemm] counter=194 i=0 t=5.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=1 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=2 t=4.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=3 t=4.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=4 t=4.0e-02 per=1.1e+01 cost=3.3e+07 flops=8.1e+08
 sigma_tot[gemm] counter=194 i=5 t=4.3e-02 per=1.2e+01 cost=3.3e+07 flops=7.6e+08
 sigma_tot[gemm] counter=194 i=6 t=4.2e-02 per=1.2e+01 cost=3.0e+07 flops=7.2e+08
 sigma_tot[gemm] counter=194 i=7 t=4.1e-02 per=1.1e+01 cost=3.2e+07 flops=7.7e+08
 sigma_tot[gemm] counter=194 total t=1.7e-01 per=4.7e+01 cost=1.3e+08 flops=7.6e+08
 sigma_tot[red] counter=194 t=1.6e-01 per=4.4e+01 cost=3.1e+07 flops=1.9e+08
T(sub)=7.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,3.0e-06,9.7e-07,8.0e-07,2.2e-07
settings: ndim=66 neig=1 maxcycle=30 nbuff=4 memory=7e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336851548809 -1.116e+03  2.723e-03    1     1  3.988e-03 3.988e-03 3.821e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.725e-05,1.533e-04,6.800e-04,7.902e-04,1.656e-03
 ndim=66:4.917e-07GB t[comm(intra)]=2.167e-05 speed=4.539e-02GB/S t[comm(inter)]=5.583e-06 speed=1.762e-01GB/S
--- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=6.8e-04 t_reduction=7.9e-04 tot=1.6e-03 ---
 sigma[inter] counter=195 t=1.5e-04 per=9.4e+00 cost=2.7e+05 flops=1.8e+09
 sigma[gemm] counter=195 i=0 t=2.3e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=1 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=2 t=2.2e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=3 t=2.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=4 t=1.9e-04 per=1.2e+01 cost=5.0e+04 flops=2.7e+08
 sigma[gemm] counter=195 i=5 t=1.9e-04 per=1.2e+01 cost=5.1e+04 flops=2.7e+08
 sigma[gemm] counter=195 i=6 t=1.4e-04 per=8.6e+00 cost=3.4e+04 flops=2.5e+08
 sigma[gemm] counter=195 i=7 t=1.5e-04 per=9.3e+00 cost=3.5e+04 flops=2.3e+08
 sigma[gemm] counter=195 total t=6.8e-04 per=4.2e+01 cost=1.7e+05 flops=2.5e+08
 sigma[red] counter=195 t=7.9e-04 per=4.9e+01 cost=5.7e+04 flops=7.2e+07
--- TIMING FOR sigma_tot : t_inter=3.5e-02 t_gemm=1.7e-01 t_reduction=1.6e-01 tot=3.6e-01 ---
 sigma_tot[inter] counter=195 t=3.5e-02 per=9.7e+00 cost=1.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=195 i=0 t=5.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=1 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=2 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=3 t=4.3e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=4 t=4.1e-02 per=1.1e+01 cost=3.3e+07 flops=8.1e+08
 sigma_tot[gemm] counter=195 i=5 t=4.4e-02 per=1.2e+01 cost=3.3e+07 flops=7.6e+08
 sigma_tot[gemm] counter=195 i=6 t=4.2e-02 per=1.2e+01 cost=3.0e+07 flops=7.2e+08
 sigma_tot[gemm] counter=195 i=7 t=4.1e-02 per=1.1e+01 cost=3.2e+07 flops=7.7e+08
 sigma_tot[gemm] counter=195 total t=1.7e-01 per=4.7e+01 cost=1.3e+08 flops=7.5e+08
 sigma_tot[red] counter=195 t=1.6e-01 per=4.4e+01 cost=3.1e+07 flops=1.9e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,9.2e-06,2.3e-06,9.5e-07,1.7e-07
    2   0 -    -116.336863539288 -1.199e-05  5.361e-04    2     2  7.830e-03 3.915e-03 3.596e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.666e-05,1.405e-04,6.702e-04,7.823e-04,1.624e-03
 ndim=66:4.917e-07GB t[comm(intra)]=2.168e-05 speed=4.537e-02GB/S t[comm(inter)]=4.986e-06 speed=1.972e-01GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=6.7e-04 t_reduction=7.8e-04 tot=1.6e-03 ---
 sigma[inter] counter=196 t=1.4e-04 per=8.8e+00 cost=2.7e+05 flops=1.9e+09
 sigma[gemm] counter=196 i=0 t=2.3e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=1 t=2.2e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=2 t=2.2e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=3 t=2.2e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=4 t=1.8e-04 per=1.2e+01 cost=5.0e+04 flops=2.7e+08
 sigma[gemm] counter=196 i=5 t=1.9e-04 per=1.2e+01 cost=5.1e+04 flops=2.7e+08
 sigma[gemm] counter=196 i=6 t=1.5e-04 per=9.5e+00 cost=3.4e+04 flops=2.3e+08
 sigma[gemm] counter=196 i=7 t=1.4e-04 per=8.7e+00 cost=3.5e+04 flops=2.5e+08
 sigma[gemm] counter=196 total t=6.7e-04 per=4.2e+01 cost=1.7e+05 flops=2.5e+08
 sigma[red] counter=196 t=7.8e-04 per=4.9e+01 cost=5.7e+04 flops=7.3e+07
--- TIMING FOR sigma_tot : t_inter=3.5e-02 t_gemm=1.7e-01 t_reduction=1.6e-01 tot=3.6e-01 ---
 sigma_tot[inter] counter=196 t=3.5e-02 per=9.7e+00 cost=1.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=196 i=0 t=5.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=1 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=2 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=3 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=4 t=4.1e-02 per=1.1e+01 cost=3.3e+07 flops=8.1e+08
 sigma_tot[gemm] counter=196 i=5 t=4.4e-02 per=1.2e+01 cost=3.3e+07 flops=7.5e+08
 sigma_tot[gemm] counter=196 i=6 t=4.2e-02 per=1.2e+01 cost=3.0e+07 flops=7.2e+08
 sigma_tot[gemm] counter=196 i=7 t=4.1e-02 per=1.1e+01 cost=3.2e+07 flops=7.7e+08
 sigma_tot[gemm] counter=196 total t=1.7e-01 per=4.7e+01 cost=1.3e+08 flops=7.5e+08
 sigma_tot[red] counter=196 t=1.6e-01 per=4.4e+01 cost=3.1e+07 flops=1.9e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.2e-05,1.8e-06,9.4e-07,1.8e-07
    3   0 +    -116.336863937704 -3.984e-07  8.443e-05    3     3  1.131e-02 3.770e-03 3.502e-03
TIMING FOR Davidson : 1.138e-02  T(cal/comm/rest)=1.051e-02,1.330e-07,8.780e-04
decomposed t_rest=8.780e-04
 T(sub)    =4.332e-05 per=4.934e+00
 T(precond)=1.076e-04 per=1.226e+01
 T(ortho)  =3.271e-06 per=3.726e-01
 T(xcopy)  =5.910e-07 per=6.732e-02
 T(xnrm2)  =5.010e-07 per=5.706e-02
 T(other)  =7.227e-04 per=8.231e+01
optimized energies: isweep=0 ibond=31 dots=2 e[0]=-116.336863937704 nmvp=3
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.595e+01S Sys:1.221e+00S Total:5.717e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond31.txt
 qbond: qsuper nsym=11 dimAll=40
 (22,2):4 (23,3):6 (23,1):6 (21,1):1 (24,2):9 (25,3):4 (25,1):3 (26,2):1 (24,4):3 (24,0):2 (22,0):1
----- TMING FOR decimation_genbasis(su2): 7.0e-05 S -----
decimation summary: 40->10 dwt=+2.094e-06 SvN=6.273e-01
 qbond: qkept nsym=6 dimAll=10
 (23,1):3 (24,2):3 (25,3):1 (25,1):1 (26,2):1 (24,0):1
----- TIMING for decimation_row(nkr): 3.497e-03 S T(decim/select/formRot)=3.452e-04,3.001e-03,1.508e-04 -----
----- TIMING FOR twodot_decimation: 3.720e-03 S T(wf/decim)=1.406e-04,3.579e-03 -----
ctns::oper_renorm coord=(4,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:16 S:4 H:1 P:16 Q:20 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=1072:8.179e-03MB:7.987e-06GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.619e+01S Sys:1.221e+00S Total:5.741e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=57 : 2.756e-04 S -----
rank=0 GPUmem(GB): used=4.72e-05 (oper)=2.69e-05
rank=0 GPUmem(GB): used=4.76e-05 (oper,site)(GB)=2.69e-05,4.1e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=57
 no. of rintermediate operators=68
 no. of coefficients=1020:0.00778MB:7.6e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.871e-04 S -----
rank=0 GPUmem(GB): used=5.52e-05 (oper,site,rinter)=2.69e-05,4.1e-07,7.6e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00163 S size(rtasks)=57 size(Rlst2)=36 T(Rmu/Rlist)=6.63e-05,0.00157 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00175 S size(rtasks)=57 size(Rlst)=2006 -----
rank=0 GPUmem(GB): used=5.52e-05 (oper,site,rinter,batch)=2.69e-05,4.1e-07,7.6e-06,0.000418 blksize=9 blksize0=9 batchsize=2006
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000111,0.000591,0.000226
--- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=5.9e-04 t_reduction=2.3e-04 tot=9.3e-04 ---
 renorm[inter] counter=32 t=1.1e-04 per=1.2e+01 cost=6.9e+04 flops=6.2e+08
 renorm[gemm] counter=32 i=0 t=2.8e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=1 t=2.2e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=2 t=1.9e-04 per=2.0e+01 cost=9.5e+03 flops=5.1e+07
 renorm[gemm] counter=32 i=3 t=2.3e-04 per=2.4e+01 cost=2.3e+04 flops=1.0e+08
 renorm[gemm] counter=32 i=4 t=2.8e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=5 t=3.0e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=32 i=6 t=1.7e-04 per=1.8e+01 cost=4.4e+04 flops=2.7e+08
 renorm[gemm] counter=32 total t=5.9e-04 per=6.4e+01 cost=7.6e+04 flops=1.3e+08
 renorm[red] counter=32 t=2.3e-04 per=2.4e+01 cost=2.0e+04 flops=8.9e+07
--- TIMING FOR renorm_tot : t_inter=4.4e-03 t_gemm=2.2e-02 t_reduction=8.0e-03 tot=3.4e-02 ---
 renorm_tot[inter] counter=32 t=4.4e-03 per=1.3e+01 cost=3.2e+06 flops=7.1e+08
 renorm_tot[gemm] counter=32 i=0 t=9.0e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=32 i=1 t=7.3e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=32 i=2 t=3.3e-03 per=9.7e+00 cost=2.1e+05 flops=6.2e+07
 renorm_tot[gemm] counter=32 i=3 t=3.8e-03 per=1.1e+01 cost=5.7e+05 flops=1.5e+08
 renorm_tot[gemm] counter=32 i=4 t=3.6e-03 per=1.1e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=32 i=5 t=3.6e-03 per=1.1e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=32 i=6 t=7.5e-03 per=2.2e+01 cost=1.9e+06 flops=2.6e+08
 renorm_tot[gemm] counter=32 total t=2.2e-02 per=6.4e+01 cost=3.5e+06 flops=1.6e+08
 renorm_tot[red] counter=32 t=8.0e-03 per=2.3e+01 cost=8.5e+05 flops=1.1e+08
qops.to_cpu: size(tot)=1072:8.2e-03MB:8.0e-06GB t[to_cpu]=1.7e-05S speed=4.8e-01GB/S
check ||H-H.dagger||=1.581e-14 coord=(4,0) rank=0
ctns::oper_ab2pq coord=(4,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00644 S rank=0 -----
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.633e+01S Sys:1.221e+00S Total:5.755e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=798:6.088e-03MB:5.946e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=26:1.984e-04MB:1.937e-07GB
total mem of comb=825:6.294e-03MB:6.147e-06GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.634e+01S Sys:1.221e+00S Total:5.756e+01S
##### local opt: 5.904e-02 S #####
 T(local opt: fetch) = 8.444e-03 S  per = 14.3  per(accum) = 14.3
 T(local opt: hdiag) = 2.581e-03 S  per = 4.37  per(accum) = 18.7
 T(local opt: dvdsn) = 3.226e-02 S  per = 54.6  per(accum) = 73.3
 T(local opt: decim) = 3.802e-03 S  per = 6.44  per(accum) = 79.8
 T(local opt: guess) = 9.129e-05 S  per = 0.155  per(accum) = 79.9
 T(local opt: renrm) = 7.237e-03 S  per = 12.3  per(accum) = 92.2
 T(local opt: save ) = 4.623e-03 S  per = 7.83  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.226e-02 S  T(sum) = 3.153e-02 S  per = 9.775e+01
 T(local opt: preprocess                  ) = 5.038e-04 S  per =  1.6  per(accum) = 1.6
 T(local opt: symbolic_formulae           ) = 7.115e-04 S  per = 2.26  per(accum) = 3.85
 T(local opt: hintermediate init          ) = 5.135e-04 S  per = 1.63  per(accum) = 5.48
 T(local opt: preprocess_hformulae_Hxlist ) = 1.569e-02 S  per = 49.7  per(accum) = 55.2
 T(local opt: hmmtasks init               ) = 2.528e-03 S  per = 8.02  per(accum) = 63.2
 T(local opt: initial guess for dvdson    ) = 2.058e-04 S  per = 0.653  per(accum) = 63.9
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.042e-02 S  per =   33  per(accum) = 96.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 8.444e-05 S  per = 0.268  per(accum) = 97.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.330e-07 S  per = 0.000422  per(accum) = 97.2
 T(local opt: dvdson solver [rest part]   ) = 8.780e-04 S  per = 2.78  per(accum) = 100
Detailed decomposition of T(renrm) = 7.237e-03 S  T(sum) = 7.237e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.076e-04 S  per = 1.49  per(accum) = 1.49
 T(local opt: qops init                    ) = 4.075e-04 S  per = 5.63  per(accum) = 7.12
 T(local opt: symbolic_formulae_renorm     ) = 3.438e-04 S  per = 4.75  per(accum) = 11.9
 T(local opt: allocate qops on gpu         ) = 8.303e-05 S  per = 1.15  per(accum) = 13
 T(local opt: site memcpy cpu2gpu          ) = 8.456e-05 S  per = 1.17  per(accum) = 14.2
 T(local opt: rintermediate init           ) = 4.232e-04 S  per = 5.85  per(accum) = 20
 T(local opt: preprocess_formulae_Rlist2   ) = 1.827e-03 S  per = 25.2  per(accum) = 45.3
 T(local opt: rmmtasks init                ) = 5.965e-04 S  per = 8.24  per(accum) = 53.5
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 0.000594  per(accum) = 53.5
 T(local opt: preprocess_renorm_batchGPU   ) = 2.491e-03 S  per = 34.4  per(accum) = 87.9
 T(local opt: reduction of opS & opH [nccl]) = 5.690e-07 S  per = 0.00786  per(accum) = 88
 T(local opt: qops memcpy gpu2cpu          ) = 8.078e-05 S  per = 1.12  per(accum) = 89.1
 T(local opt: deallocate cpu and gpu memory) = 1.031e-05 S  per = 0.142  per(accum) = 89.2
 T(local opt: reduction of opS & opH [comm]) = 9.044e-05 S  per = 1.25  per(accum) = 90.5
 T(local opt: conversion from opAB to opPQ ) = 6.738e-05 S  per = 0.931  per(accum) = 91.4
 T(local opt: after oper_renorm            ) = 6.228e-04 S  per = 8.61  per(accum) = 100
##### sweep opt: 2.796e+00 S #####
 T(sweep opt: fetch) = 2.095e-01 S  per = 7.49  per(accum) = 7.49
 T(sweep opt: hdiag) = 1.786e-01 S  per = 6.39  per(accum) = 13.9
 T(sweep opt: dvdsn) = 1.857e+00 S  per = 66.4  per(accum) = 80.3
 T(sweep opt: decim) = 1.196e-01 S  per = 4.28  per(accum) = 84.6
 T(sweep opt: guess) = 3.742e-03 S  per = 0.134  per(accum) = 84.7
 T(sweep opt: renrm) = 2.813e-01 S  per = 10.1  per(accum) = 94.8
 T(sweep opt: save ) = 1.464e-01 S  per = 5.24  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.857e+00 S  T(sum) = 1.828e+00 S  per = 9.847e+01
 T(sweep opt: preprocess                  ) = 2.044e-02 S  per = 1.12  per(accum) = 1.12
 T(sweep opt: symbolic_formulae           ) = 3.459e-02 S  per = 1.89  per(accum) = 3.01
 T(sweep opt: hintermediate init          ) = 1.855e-02 S  per = 1.01  per(accum) = 4.02
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.928e-01 S  per = 43.4  per(accum) = 47.4
 T(sweep opt: hmmtasks init               ) = 1.341e-01 S  per = 7.34  per(accum) = 54.7
 T(sweep opt: initial guess for dvdson    ) = 7.836e-03 S  per = 0.429  per(accum) = 55.2
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 7.596e-01 S  per = 41.5  per(accum) = 96.7
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 5.622e-03 S  per = 0.308  per(accum) = 97
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 8.859e-06 S  per = 0.000485  per(accum) = 97
 T(sweep opt: dvdson solver [rest part]   ) = 5.456e-02 S  per = 2.98  per(accum) = 100
Detailed decomposition of T(renrm) = 2.813e-01 S  T(sum) = 2.813e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.775e-03 S  per = 1.34  per(accum) = 1.34
 T(sweep opt: qops init                    ) = 1.508e-02 S  per = 5.36  per(accum) = 6.7
 T(sweep opt: symbolic_formulae_renorm     ) = 1.602e-02 S  per =  5.7  per(accum) = 12.4
 T(sweep opt: allocate qops on gpu         ) = 3.008e-03 S  per = 1.07  per(accum) = 13.5
 T(sweep opt: site memcpy cpu2gpu          ) = 2.859e-03 S  per = 1.02  per(accum) = 14.5
 T(sweep opt: rintermediate init           ) = 1.502e-02 S  per = 5.34  per(accum) = 19.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.845e-02 S  per = 24.3  per(accum) = 44.2
 T(sweep opt: rmmtasks init                ) = 2.189e-02 S  per = 7.78  per(accum) = 51.9
 T(sweep opt: qops memset on cpu           ) = 1.562e-06 S  per = 0.000555  per(accum) = 51.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 9.111e-02 S  per = 32.4  per(accum) = 84.3
 T(sweep opt: reduction of opS & opH [nccl]) = 1.881e-05 S  per = 0.00669  per(accum) = 84.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.215e-03 S  per = 1.14  per(accum) = 85.5
 T(sweep opt: deallocate cpu and gpu memory) = 4.664e-04 S  per = 0.166  per(accum) = 85.7
 T(sweep opt: reduction of opS & opH [comm]) = 2.990e-03 S  per = 1.06  per(accum) = 86.7
 T(sweep opt: conversion from opAB to opPQ ) = 1.457e-02 S  per = 5.18  per(accum) = 91.9
 T(sweep opt: after oper_renorm            ) = 2.277e-02 S  per =  8.1  per(accum) = 100
##### global opt: 2.796e+00 S #####
 T(global opt: fetch) = 2.095e-01 S  per = 7.49  per(accum) = 7.49
 T(global opt: hdiag) = 1.786e-01 S  per = 6.39  per(accum) = 13.9
 T(global opt: dvdsn) = 1.857e+00 S  per = 66.4  per(accum) = 80.3
 T(global opt: decim) = 1.196e-01 S  per = 4.28  per(accum) = 84.6
 T(global opt: guess) = 3.742e-03 S  per = 0.134  per(accum) = 84.7
 T(global opt: renrm) = 2.813e-01 S  per = 10.1  per(accum) = 94.8
 T(global opt: save ) = 1.464e-01 S  per = 5.24  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.857e+00 S  T(sum) = 1.828e+00 S  per = 9.847e+01
 T(global opt: preprocess                  ) = 2.044e-02 S  per = 1.12  per(accum) = 1.12
 T(global opt: symbolic_formulae           ) = 3.459e-02 S  per = 1.89  per(accum) = 3.01
 T(global opt: hintermediate init          ) = 1.855e-02 S  per = 1.01  per(accum) = 4.02
 T(global opt: preprocess_hformulae_Hxlist ) = 7.928e-01 S  per = 43.4  per(accum) = 47.4
 T(global opt: hmmtasks init               ) = 1.341e-01 S  per = 7.34  per(accum) = 54.7
 T(global opt: initial guess for dvdson    ) = 7.836e-03 S  per = 0.429  per(accum) = 55.2
 T(global opt: dvdson solver [Hx_batchGPU] ) = 7.596e-01 S  per = 41.5  per(accum) = 96.7
 T(global opt: dvdson solver [comm(gpu)]   ) = 5.622e-03 S  per = 0.308  per(accum) = 97
 T(global opt: dvdson solver [comm(cpu)]   ) = 8.859e-06 S  per = 0.000485  per(accum) = 97
 T(global opt: dvdson solver [rest part]   ) = 5.456e-02 S  per = 2.98  per(accum) = 100
Detailed decomposition of T(renrm) = 2.813e-01 S  T(sum) = 2.813e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.775e-03 S  per = 1.34  per(accum) = 1.34
 T(global opt: qops init                    ) = 1.508e-02 S  per = 5.36  per(accum) = 6.7
 T(global opt: symbolic_formulae_renorm     ) = 1.602e-02 S  per =  5.7  per(accum) = 12.4
 T(global opt: allocate qops on gpu         ) = 3.008e-03 S  per = 1.07  per(accum) = 13.5
 T(global opt: site memcpy cpu2gpu          ) = 2.859e-03 S  per = 1.02  per(accum) = 14.5
 T(global opt: rintermediate init           ) = 1.502e-02 S  per = 5.34  per(accum) = 19.8
 T(global opt: preprocess_formulae_Rlist2   ) = 6.845e-02 S  per = 24.3  per(accum) = 44.2
 T(global opt: rmmtasks init                ) = 2.189e-02 S  per = 7.78  per(accum) = 51.9
 T(global opt: qops memset on cpu           ) = 1.562e-06 S  per = 0.000555  per(accum) = 51.9
 T(global opt: preprocess_renorm_batchGPU   ) = 9.111e-02 S  per = 32.4  per(accum) = 84.3
 T(global opt: reduction of opS & opH [nccl]) = 1.881e-05 S  per = 0.00669  per(accum) = 84.3
 T(global opt: qops memcpy gpu2cpu          ) = 3.215e-03 S  per = 1.14  per(accum) = 85.5
 T(global opt: deallocate cpu and gpu memory) = 4.664e-04 S  per = 0.166  per(accum) = 85.7
 T(global opt: reduction of opS & opH [comm]) = 2.990e-03 S  per = 1.06  per(accum) = 86.7
 T(global opt: conversion from opAB to opPQ ) = 1.457e-02 S  per = 5.18  per(accum) = 91.9
 T(global opt: after oper_renorm            ) = 2.277e-02 S  per =  8.1  per(accum) = 100

isweep=0 ibond=32/seqsize=34 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.634e+01S Sys:1.221e+00S Total:5.756e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=798:6.088e-03MB:5.946e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=26:1.984e-04MB:1.937e-07GB
total mem of comb=825:6.294e-03MB:6.147e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,16,1,1
 suppl= 0 1
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:2 S:18 H:1 A:4 B:6 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=31:2.365e-04MB:2.310e-07GB
 rqops: oplist=CSHPQ nops=C:16 S:4 H:1 P:16 Q:20 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=1072:8.179e-03MB:7.987e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=3099:2.364e-02MB:2.309e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
wf4(diml,dimr,dimc1,dimc2)=(2,10,3,3) nnz=32:2.441e-04MB
qtensor4: wf4 own=1 _data=0x55a31eae9960
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=2 dimAll=2
 (4,0):1 (3,1):1
 qbond: qcol nsym=6 dimAll=10
 (23,1):3 (24,2):3 (25,3):1 (25,1):1 (26,2):1 (24,0):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=20 nblocks=161 size=32:2.441e-04MB
### DIAG TIMING: total=8.854e-04 t1=8.933e-06, t2=1.354e-05, t3=1.681e-05, t4=8.201e-04, t5=4.461e-06, t6=1.757e-05, t7=4.008e-06
duration_diagGPU:9.599e-04
duration_diagreduce:2.800e-08
duration_diagtransform:1.750e-07
----- TIMING FOR symbolic_formulae_twodot with size=321 : 5.131e-04 S -----
rank=0 GPUmem(GB): used=2.31e-05 (oper)=2.31e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=321
 no. of hintermediate operators=183
 no. of coefficients=1044:0.00797MB:7.78e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.169e-04 S -----
rank=0 GPUmem(GB): used=3.09e-05 (oper,hinter)=2.31e-05,7.78e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0105 S size(H_formulae)=321 size(Hxlst2)=20 T(Hmu/Hxlist)=0.000106,0.0104 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0107 S size(H_formulae)=321 size(Hxlst)=6456 -----
rank=0 GPUmem(GB): used=0.000801 (oper,hinter,dvdson,batch)=2.31e-05,7.78e-06,4.77e-07,0.00077 blksize=3 blksize0=9 batchsize=6456
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=32 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.09e-05,0.000136,0.000342,0.000683,0.0012
 ndim=32:2.38e-07GB t[comm(intra)]=2.37e-05 speed=0.0201GB/S t[comm(inter)]=7.16e-06 speed=0.0666GB/S
--- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=3.4e-04 t_reduction=6.8e-04 tot=1.2e-03 ---
 sigma[inter] counter=197 t=1.4e-04 per=1.2e+01 cost=8.2e+04 flops=6.0e+08
 sigma[gemm] counter=197 i=0 t=2.8e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=1 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=2 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=3 t=2.2e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=4 t=1.0e-04 per=8.6e+00 cost=1.6e+04 flops=1.6e+08
 sigma[gemm] counter=197 i=5 t=9.1e-05 per=7.8e+00 cost=1.6e+04 flops=1.8e+08
 sigma[gemm] counter=197 i=6 t=7.2e-05 per=6.2e+00 cost=7.5e+03 flops=1.0e+08
 sigma[gemm] counter=197 i=7 t=7.0e-05 per=6.0e+00 cost=7.9e+03 flops=1.1e+08
 sigma[gemm] counter=197 total t=3.4e-04 per=2.9e+01 cost=4.8e+04 flops=1.4e+08
 sigma[red] counter=197 t=6.8e-04 per=5.9e+01 cost=2.1e+04 flops=3.1e+07
--- TIMING FOR sigma_tot : t_inter=3.5e-02 t_gemm=1.7e-01 t_reduction=1.6e-01 tot=3.6e-01 ---
 sigma_tot[inter] counter=197 t=3.5e-02 per=9.7e+00 cost=1.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=197 i=0 t=5.1e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=1 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=2 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=3 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=4 t=4.1e-02 per=1.1e+01 cost=3.3e+07 flops=8.0e+08
 sigma_tot[gemm] counter=197 i=5 t=4.4e-02 per=1.2e+01 cost=3.3e+07 flops=7.5e+08
 sigma_tot[gemm] counter=197 i=6 t=4.2e-02 per=1.2e+01 cost=3.0e+07 flops=7.1e+08
 sigma_tot[gemm] counter=197 i=7 t=4.1e-02 per=1.1e+01 cost=3.2e+07 flops=7.7e+08
 sigma_tot[gemm] counter=197 total t=1.7e-01 per=4.7e+01 cost=1.3e+08 flops=7.5e+08
 sigma_tot[red] counter=197 t=1.6e-01 per=4.4e+01 cost=3.1e+07 flops=1.9e+08
T(sub)=7.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,3.0e-06,1.0e-06,7.5e-07,1.8e-07
settings: ndim=32 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336862474661 -1.116e+03  1.798e-03    1     1  3.189e-03 3.189e-03 3.035e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.891e-05,1.215e-04,3.106e-04,6.457e-04,1.111e-03
 ndim=32:2.384e-07GB t[comm(intra)]=2.353e-05 speed=2.027e-02GB/S t[comm(inter)]=5.384e-06 speed=8.857e-02GB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=3.1e-04 t_reduction=6.5e-04 tot=1.1e-03 ---
 sigma[inter] counter=198 t=1.2e-04 per=1.1e+01 cost=8.2e+04 flops=6.7e+08
 sigma[gemm] counter=198 i=0 t=2.8e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=1 t=3.0e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=2 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=3 t=2.1e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=4 t=8.1e-05 per=7.5e+00 cost=1.6e+04 flops=2.0e+08
 sigma[gemm] counter=198 i=5 t=7.8e-05 per=7.3e+00 cost=1.6e+04 flops=2.1e+08
 sigma[gemm] counter=198 i=6 t=7.2e-05 per=6.7e+00 cost=7.5e+03 flops=1.0e+08
 sigma[gemm] counter=198 i=7 t=6.9e-05 per=6.4e+00 cost=7.9e+03 flops=1.1e+08
 sigma[gemm] counter=198 total t=3.1e-04 per=2.9e+01 cost=4.8e+04 flops=1.6e+08
 sigma[red] counter=198 t=6.5e-04 per=6.0e+01 cost=2.1e+04 flops=3.3e+07
--- TIMING FOR sigma_tot : t_inter=3.6e-02 t_gemm=1.7e-01 t_reduction=1.6e-01 tot=3.7e-01 ---
 sigma_tot[inter] counter=198 t=3.6e-02 per=9.7e+00 cost=1.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=198 i=0 t=5.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=1 t=4.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=2 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=3 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=4 t=4.1e-02 per=1.1e+01 cost=3.3e+07 flops=8.0e+08
 sigma_tot[gemm] counter=198 i=5 t=4.4e-02 per=1.2e+01 cost=3.3e+07 flops=7.5e+08
 sigma_tot[gemm] counter=198 i=6 t=4.2e-02 per=1.2e+01 cost=3.0e+07 flops=7.1e+08
 sigma_tot[gemm] counter=198 i=7 t=4.1e-02 per=1.1e+01 cost=3.2e+07 flops=7.7e+08
 sigma_tot[gemm] counter=198 total t=1.7e-01 per=4.6e+01 cost=1.3e+08 flops=7.5e+08
 sigma_tot[red] counter=198 t=1.6e-01 per=4.4e+01 cost=3.1e+07 flops=1.9e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,9.5e-06,2.2e-06,9.1e-07,1.9e-07
    2   0 -    -116.336865861083 -3.386e-06  1.724e-04    2     2  6.539e-03 3.269e-03 2.964e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.750e-05,1.106e-04,3.092e-04,6.373e-04,1.090e-03
 ndim=32:2.384e-07GB t[comm(intra)]=2.244e-05 speed=2.125e-02GB/S t[comm(inter)]=5.060e-06 speed=9.424e-02GB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=3.1e-04 t_reduction=6.4e-04 tot=1.1e-03 ---
 sigma[inter] counter=199 t=1.1e-04 per=1.0e+01 cost=8.2e+04 flops=7.4e+08
 sigma[gemm] counter=199 i=0 t=2.3e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=1 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=2 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=3 t=2.2e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=4 t=8.2e-05 per=7.7e+00 cost=1.6e+04 flops=2.0e+08
 sigma[gemm] counter=199 i=5 t=8.9e-05 per=8.4e+00 cost=1.6e+04 flops=1.8e+08
 sigma[gemm] counter=199 i=6 t=6.6e-05 per=6.2e+00 cost=7.5e+03 flops=1.1e+08
 sigma[gemm] counter=199 i=7 t=6.4e-05 per=6.0e+00 cost=7.9e+03 flops=1.2e+08
 sigma[gemm] counter=199 total t=3.1e-04 per=2.9e+01 cost=4.8e+04 flops=1.6e+08
 sigma[red] counter=199 t=6.4e-04 per=6.0e+01 cost=2.1e+04 flops=3.3e+07
--- TIMING FOR sigma_tot : t_inter=3.6e-02 t_gemm=1.7e-01 t_reduction=1.6e-01 tot=3.7e-01 ---
 sigma_tot[inter] counter=199 t=3.6e-02 per=9.7e+00 cost=1.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=199 i=0 t=5.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=1 t=4.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=2 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=3 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=4 t=4.1e-02 per=1.1e+01 cost=3.3e+07 flops=8.0e+08
 sigma_tot[gemm] counter=199 i=5 t=4.4e-02 per=1.2e+01 cost=3.3e+07 flops=7.5e+08
 sigma_tot[gemm] counter=199 i=6 t=4.2e-02 per=1.1e+01 cost=3.0e+07 flops=7.1e+08
 sigma_tot[gemm] counter=199 i=7 t=4.1e-02 per=1.1e+01 cost=3.2e+07 flops=7.6e+08
 sigma_tot[gemm] counter=199 total t=1.7e-01 per=4.6e+01 cost=1.3e+08 flops=7.5e+08
 sigma_tot[red] counter=199 t=1.6e-01 per=4.4e+01 cost=3.1e+07 flops=1.9e+08
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.3e-05,1.8e-06,9.3e-07,1.6e-07
    3   0 +    -116.336865909158 -4.807e-08  1.931e-05    3     3  9.651e-03 3.217e-03 2.955e-03
TIMING FOR Davidson : 9.720e-03  T(cal/comm/rest)=8.864e-03,1.580e-07,8.554e-04
decomposed t_rest=8.554e-04
 T(sub)    =4.458e-05 per=5.211e+00
 T(precond)=1.105e-04 per=1.292e+01
 T(ortho)  =3.105e-06 per=3.630e-01
 T(xcopy)  =4.920e-07 per=5.751e-02
 T(xnrm2)  =5.490e-07 per=6.418e-02
 T(other)  =6.962e-04 per=8.138e+01
optimized energies: isweep=0 ibond=32 dots=2 e[0]=-116.336865909158 nmvp=3
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.672e+01S Sys:1.221e+00S Total:5.794e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond32.txt
 qbond: qsuper nsym=11 dimAll=39
 (23,1):3 (24,2):6 (25,3):4 (25,1):8 (26,2):6 (24,0):4 (27,3):2 (27,1):2 (28,2):1 (26,0):2 (26,4):1
----- TMING FOR decimation_genbasis(su2): 4.2e-05 S -----
decimation summary: 39->7 dwt=+0.000e+00 SvN=6.828e-01
 qbond: qkept nsym=5 dimAll=7
 (25,1):2 (26,0):2 (26,2):1 (24,0):1 (27,1):1
----- TIMING for decimation_row(nkr): 2.879e-03 S T(decim/select/formRot)=3.224e-04,2.412e-03,1.441e-04 -----
----- TIMING FOR twodot_decimation: 3.083e-03 S T(wf/decim)=1.286e-04,2.954e-03 -----
ctns::oper_renorm coord=(3,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:17 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=7,7 size(op)=11:8.392e-05MB size(tot)=390:2.975e-03MB:2.906e-06GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.697e+01S Sys:1.221e+00S Total:5.819e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=42 : 2.133e-04 S -----
rank=0 GPUmem(GB): used=3.35e-05 (oper)=1.83e-05
rank=0 GPUmem(GB): used=3.38e-05 (oper,site)(GB)=1.83e-05,2.38e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=42
 no. of rintermediate operators=42
 no. of coefficients=672:0.00513MB:5.01e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.944e-04 S -----
rank=0 GPUmem(GB): used=3.88e-05 (oper,site,rinter)=1.83e-05,2.38e-07,5.01e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00134 S size(rtasks)=42 size(Rlst2)=25 T(Rmu/Rlist)=4.63e-05,0.00129 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00145 S size(rtasks)=42 size(Rlst)=1671 -----
rank=0 GPUmem(GB): used=3.88e-05 (oper,site,rinter,batch)=1.83e-05,2.38e-07,5.01e-06,0.000274 blksize=6 blksize0=9 batchsize=1671
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000101,0.000385,0.000277
--- TIMING FOR renorm : t_inter=1.0e-04 t_gemm=3.8e-04 t_reduction=2.8e-04 tot=7.6e-04 ---
 renorm[inter] counter=33 t=1.0e-04 per=1.3e+01 cost=3.3e+04 flops=3.3e+08
 renorm[gemm] counter=33 i=0 t=2.8e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=1 t=2.2e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=2 t=1.2e-04 per=1.6e+01 cost=3.9e+03 flops=3.3e+07
 renorm[gemm] counter=33 i=3 t=1.3e-04 per=1.7e+01 cost=8.6e+03 flops=6.7e+07
 renorm[gemm] counter=33 i=4 t=2.3e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=5 t=2.2e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=33 i=6 t=1.3e-04 per=1.7e+01 cost=1.3e+04 flops=1.0e+08
 renorm[gemm] counter=33 total t=3.8e-04 per=5.0e+01 cost=2.5e+04 flops=6.6e+07
 renorm[red] counter=33 t=2.8e-04 per=3.6e+01 cost=7.5e+03 flops=2.7e+07
--- TIMING FOR renorm_tot : t_inter=4.5e-03 t_gemm=2.2e-02 t_reduction=8.2e-03 tot=3.5e-02 ---
 renorm_tot[inter] counter=33 t=4.5e-03 per=1.3e+01 cost=3.2e+06 flops=7.1e+08
 renorm_tot[gemm] counter=33 i=0 t=9.3e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=33 i=1 t=7.6e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=33 i=2 t=3.4e-03 per=9.8e+00 cost=2.1e+05 flops=6.1e+07
 renorm_tot[gemm] counter=33 i=3 t=3.9e-03 per=1.1e+01 cost=5.8e+05 flops=1.5e+08
 renorm_tot[gemm] counter=33 i=4 t=3.6e-03 per=1.0e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=33 i=5 t=3.6e-03 per=1.0e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=33 i=6 t=7.6e-03 per=2.2e+01 cost=2.0e+06 flops=2.6e+08
 renorm_tot[gemm] counter=33 total t=2.2e-02 per=6.4e+01 cost=3.5e+06 flops=1.6e+08
 renorm_tot[red] counter=33 t=8.2e-03 per=2.3e+01 cost=8.5e+05 flops=1.0e+08
qops.to_cpu: size(tot)=390:3.0e-03MB:2.9e-06GB t[to_cpu]=1.5e-05S speed=1.9e-01GB/S
check ||H-H.dagger||=7.222e-15 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00575 S rank=0 -----
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.709e+01S Sys:1.221e+00S Total:5.831e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=811:6.187e-03MB:6.042e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=11:8.392e-05MB:8.196e-08GB
total mem of comb=823:6.279e-03MB:6.132e-06GB
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.709e+01S Sys:1.221e+00S Total:5.832e+01S
##### local opt: 4.567e-02 S #####
 T(local opt: fetch) = 5.335e-03 S  per = 11.7  per(accum) = 11.7
 T(local opt: hdiag) = 1.755e-03 S  per = 3.84  per(accum) = 15.5
 T(local opt: dvdsn) = 2.454e-02 S  per = 53.7  per(accum) = 69.3
 T(local opt: decim) = 3.159e-03 S  per = 6.92  per(accum) = 76.2
 T(local opt: guess) = 7.067e-05 S  per = 0.155  per(accum) = 76.3
 T(local opt: renrm) = 6.540e-03 S  per = 14.3  per(accum) = 90.7
 T(local opt: save ) = 4.269e-03 S  per = 9.35  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.454e-02 S  T(sum) = 2.386e-02 S  per = 9.723e+01
 T(local opt: preprocess                  ) = 4.233e-04 S  per = 1.77  per(accum) = 1.77
 T(local opt: symbolic_formulae           ) = 5.921e-04 S  per = 2.48  per(accum) = 4.26
 T(local opt: hintermediate init          ) = 5.105e-04 S  per = 2.14  per(accum) = 6.39
 T(local opt: preprocess_hformulae_Hxlist ) = 1.081e-02 S  per = 45.3  per(accum) = 51.7
 T(local opt: hmmtasks init               ) = 1.622e-03 S  per =  6.8  per(accum) = 58.5
 T(local opt: initial guess for dvdson    ) = 1.881e-04 S  per = 0.788  per(accum) = 59.3
 T(local opt: dvdson solver [Hx_batchGPU] ) = 8.777e-03 S  per = 36.8  per(accum) = 96
 T(local opt: dvdson solver [comm(gpu)]   ) = 8.726e-05 S  per = 0.366  per(accum) = 96.4
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.580e-07 S  per = 0.000662  per(accum) = 96.4
 T(local opt: dvdson solver [rest part]   ) = 8.554e-04 S  per = 3.58  per(accum) = 100
Detailed decomposition of T(renrm) = 6.540e-03 S  T(sum) = 6.540e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 9.998e-05 S  per = 1.53  per(accum) = 1.53
 T(local opt: qops init                    ) = 3.360e-04 S  per = 5.14  per(accum) = 6.67
 T(local opt: symbolic_formulae_renorm     ) = 2.848e-04 S  per = 4.35  per(accum) = 11
 T(local opt: allocate qops on gpu         ) = 7.907e-05 S  per = 1.21  per(accum) = 12.2
 T(local opt: site memcpy cpu2gpu          ) = 8.242e-05 S  per = 1.26  per(accum) = 13.5
 T(local opt: rintermediate init           ) = 4.345e-04 S  per = 6.64  per(accum) = 20.1
 T(local opt: preprocess_formulae_Rlist2   ) = 1.529e-03 S  per = 23.4  per(accum) = 43.5
 T(local opt: rmmtasks init                ) = 4.884e-04 S  per = 7.47  per(accum) = 51
 T(local opt: qops memset on cpu           ) = 5.000e-08 S  per = 0.000765  per(accum) = 51
 T(local opt: preprocess_renorm_batchGPU   ) = 2.346e-03 S  per = 35.9  per(accum) = 86.9
 T(local opt: reduction of opS & opH [nccl]) = 5.310e-07 S  per = 0.00812  per(accum) = 86.9
 T(local opt: qops memcpy gpu2cpu          ) = 8.273e-05 S  per = 1.27  per(accum) = 88.1
 T(local opt: deallocate cpu and gpu memory) = 9.302e-06 S  per = 0.142  per(accum) = 88.3
 T(local opt: reduction of opS & opH [comm]) = 7.433e-05 S  per = 1.14  per(accum) = 89.4
 T(local opt: conversion from opAB to opPQ ) = 6.810e-05 S  per = 1.04  per(accum) = 90.5
 T(local opt: after oper_renorm            ) = 6.243e-04 S  per = 9.55  per(accum) = 100
##### sweep opt: 2.841e+00 S #####
 T(sweep opt: fetch) = 2.148e-01 S  per = 7.56  per(accum) = 7.56
 T(sweep opt: hdiag) = 1.804e-01 S  per = 6.35  per(accum) = 13.9
 T(sweep opt: dvdsn) = 1.881e+00 S  per = 66.2  per(accum) = 80.1
 T(sweep opt: decim) = 1.227e-01 S  per = 4.32  per(accum) = 84.4
 T(sweep opt: guess) = 3.813e-03 S  per = 0.134  per(accum) = 84.6
 T(sweep opt: renrm) = 2.878e-01 S  per = 10.1  per(accum) = 94.7
 T(sweep opt: save ) = 1.506e-01 S  per =  5.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.881e+00 S  T(sum) = 1.852e+00 S  per = 9.845e+01
 T(sweep opt: preprocess                  ) = 2.086e-02 S  per = 1.13  per(accum) = 1.13
 T(sweep opt: symbolic_formulae           ) = 3.518e-02 S  per =  1.9  per(accum) = 3.03
 T(sweep opt: hintermediate init          ) = 1.906e-02 S  per = 1.03  per(accum) = 4.05
 T(sweep opt: preprocess_hformulae_Hxlist ) = 8.036e-01 S  per = 43.4  per(accum) = 47.4
 T(sweep opt: hmmtasks init               ) = 1.357e-01 S  per = 7.33  per(accum) = 54.8
 T(sweep opt: initial guess for dvdson    ) = 8.025e-03 S  per = 0.433  per(accum) = 55.2
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 7.684e-01 S  per = 41.5  per(accum) = 96.7
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 5.709e-03 S  per = 0.308  per(accum) = 97
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 9.017e-06 S  per = 0.000487  per(accum) = 97
 T(sweep opt: dvdson solver [rest part]   ) = 5.542e-02 S  per = 2.99  per(accum) = 100
Detailed decomposition of T(renrm) = 2.878e-01 S  T(sum) = 2.878e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.875e-03 S  per = 1.35  per(accum) = 1.35
 T(sweep opt: qops init                    ) = 1.542e-02 S  per = 5.36  per(accum) = 6.7
 T(sweep opt: symbolic_formulae_renorm     ) = 1.630e-02 S  per = 5.66  per(accum) = 12.4
 T(sweep opt: allocate qops on gpu         ) = 3.087e-03 S  per = 1.07  per(accum) = 13.4
 T(sweep opt: site memcpy cpu2gpu          ) = 2.941e-03 S  per = 1.02  per(accum) = 14.5
 T(sweep opt: rintermediate init           ) = 1.546e-02 S  per = 5.37  per(accum) = 19.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.998e-02 S  per = 24.3  per(accum) = 44.1
 T(sweep opt: rmmtasks init                ) = 2.238e-02 S  per = 7.78  per(accum) = 51.9
 T(sweep opt: qops memset on cpu           ) = 1.612e-06 S  per = 0.00056  per(accum) = 51.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 9.346e-02 S  per = 32.5  per(accum) = 84.4
 T(sweep opt: reduction of opS & opH [nccl]) = 1.934e-05 S  per = 0.00672  per(accum) = 84.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.298e-03 S  per = 1.15  per(accum) = 85.6
 T(sweep opt: deallocate cpu and gpu memory) = 4.757e-04 S  per = 0.165  per(accum) = 85.7
 T(sweep opt: reduction of opS & opH [comm]) = 3.064e-03 S  per = 1.06  per(accum) = 86.8
 T(sweep opt: conversion from opAB to opPQ ) = 1.464e-02 S  per = 5.09  per(accum) = 91.9
 T(sweep opt: after oper_renorm            ) = 2.340e-02 S  per = 8.13  per(accum) = 100
##### global opt: 2.841e+00 S #####
 T(global opt: fetch) = 2.148e-01 S  per = 7.56  per(accum) = 7.56
 T(global opt: hdiag) = 1.804e-01 S  per = 6.35  per(accum) = 13.9
 T(global opt: dvdsn) = 1.881e+00 S  per = 66.2  per(accum) = 80.1
 T(global opt: decim) = 1.227e-01 S  per = 4.32  per(accum) = 84.4
 T(global opt: guess) = 3.813e-03 S  per = 0.134  per(accum) = 84.6
 T(global opt: renrm) = 2.878e-01 S  per = 10.1  per(accum) = 94.7
 T(global opt: save ) = 1.506e-01 S  per =  5.3  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.881e+00 S  T(sum) = 1.852e+00 S  per = 9.845e+01
 T(global opt: preprocess                  ) = 2.086e-02 S  per = 1.13  per(accum) = 1.13
 T(global opt: symbolic_formulae           ) = 3.518e-02 S  per =  1.9  per(accum) = 3.03
 T(global opt: hintermediate init          ) = 1.906e-02 S  per = 1.03  per(accum) = 4.05
 T(global opt: preprocess_hformulae_Hxlist ) = 8.036e-01 S  per = 43.4  per(accum) = 47.4
 T(global opt: hmmtasks init               ) = 1.357e-01 S  per = 7.33  per(accum) = 54.8
 T(global opt: initial guess for dvdson    ) = 8.025e-03 S  per = 0.433  per(accum) = 55.2
 T(global opt: dvdson solver [Hx_batchGPU] ) = 7.684e-01 S  per = 41.5  per(accum) = 96.7
 T(global opt: dvdson solver [comm(gpu)]   ) = 5.709e-03 S  per = 0.308  per(accum) = 97
 T(global opt: dvdson solver [comm(cpu)]   ) = 9.017e-06 S  per = 0.000487  per(accum) = 97
 T(global opt: dvdson solver [rest part]   ) = 5.542e-02 S  per = 2.99  per(accum) = 100
Detailed decomposition of T(renrm) = 2.878e-01 S  T(sum) = 2.878e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.875e-03 S  per = 1.35  per(accum) = 1.35
 T(global opt: qops init                    ) = 1.542e-02 S  per = 5.36  per(accum) = 6.7
 T(global opt: symbolic_formulae_renorm     ) = 1.630e-02 S  per = 5.66  per(accum) = 12.4
 T(global opt: allocate qops on gpu         ) = 3.087e-03 S  per = 1.07  per(accum) = 13.4
 T(global opt: site memcpy cpu2gpu          ) = 2.941e-03 S  per = 1.02  per(accum) = 14.5
 T(global opt: rintermediate init           ) = 1.546e-02 S  per = 5.37  per(accum) = 19.8
 T(global opt: preprocess_formulae_Rlist2   ) = 6.998e-02 S  per = 24.3  per(accum) = 44.1
 T(global opt: rmmtasks init                ) = 2.238e-02 S  per = 7.78  per(accum) = 51.9
 T(global opt: qops memset on cpu           ) = 1.612e-06 S  per = 0.00056  per(accum) = 51.9
 T(global opt: preprocess_renorm_batchGPU   ) = 9.346e-02 S  per = 32.5  per(accum) = 84.4
 T(global opt: reduction of opS & opH [nccl]) = 1.934e-05 S  per = 0.00672  per(accum) = 84.4
 T(global opt: qops memcpy gpu2cpu          ) = 3.298e-03 S  per = 1.15  per(accum) = 85.6
 T(global opt: deallocate cpu and gpu memory) = 4.757e-04 S  per = 0.165  per(accum) = 85.7
 T(global opt: reduction of opS & opH [comm]) = 3.064e-03 S  per = 1.06  per(accum) = 86.8
 T(global opt: conversion from opAB to opPQ ) = 1.464e-02 S  per = 5.09  per(accum) = 91.9
 T(global opt: after oper_renorm            ) = 2.340e-02 S  per = 8.13  per(accum) = 100

isweep=0 ibond=33/seqsize=34 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=64
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.710e+01S Sys:1.221e+00S Total:5.832e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=811:6.187e-03MB:6.042e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=11:8.392e-05MB:8.196e-08GB
total mem of comb=823:6.279e-03MB:6.132e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,17,1,1
 suppl= 0
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 rqops: oplist=CSHPQ nops=C:17 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=7,7 size(op)=11:8.392e-05MB size(tot)=390:2.975e-03MB:2.906e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 c2qops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
 qops(tot)=3384:2.582e-02MB:2.521e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
wf4(diml,dimr,dimc1,dimc2)=(3,7,3,3) nnz=30:2.289e-04MB
qtensor4: wf4 own=1 _data=0x55a321de99c0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qcol nsym=5 dimAll=7
 (25,1):2 (26,0):2 (26,2):1 (24,0):1 (27,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=180 size=30:2.289e-04MB
### DIAG TIMING: total=4.886e-04 t1=7.917e-06, t2=1.421e-05, t3=1.728e-05, t4=4.241e-04, t5=4.456e-06, t6=1.721e-05, t7=3.420e-06
duration_diagGPU:5.605e-04
duration_diagreduce:2.800e-08
duration_diagtransform:1.740e-07
----- TIMING FOR symbolic_formulae_twodot with size=228 : 3.590e-04 S -----
rank=0 GPUmem(GB): used=2.52e-05 (oper)=2.52e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=228
 no. of hintermediate operators=22
 no. of coefficients=374:0.00285MB:2.79e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.774e-04 S -----
rank=0 GPUmem(GB): used=2.8e-05 (oper,hinter)=2.52e-05,2.79e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00758 S size(H_formulae)=228 size(Hxlst2)=21 T(Hmu/Hxlist)=8.59e-05,0.0075 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00778 S size(H_formulae)=228 size(Hxlst)=4804 -----
rank=0 GPUmem(GB): used=0.000351 (oper,hinter,dvdson,batch)=2.52e-05,2.79e-06,4.47e-07,0.000322 blksize=2 blksize0=4 batchsize=4804
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=30 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.1e-05,9.43e-05,0.00033,0.00068,0.00114
 ndim=30:2.24e-07GB t[comm(intra)]=2.39e-05 speed=0.0187GB/S t[comm(inter)]=7.11e-06 speed=0.0629GB/S
--- TIMING FOR sigma : t_inter=9.4e-05 t_gemm=3.3e-04 t_reduction=6.8e-04 tot=1.1e-03 ---
 sigma[inter] counter=200 t=9.4e-05 per=8.5e+00 cost=2.5e+04 flops=2.7e+08
 sigma[gemm] counter=200 i=0 t=2.7e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=1 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=2 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=3 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=4 t=9.5e-05 per=8.6e+00 cost=9.0e+03 flops=9.5e+07
 sigma[gemm] counter=200 i=5 t=8.9e-05 per=8.1e+00 cost=9.0e+03 flops=1.0e+08
 sigma[gemm] counter=200 i=6 t=7.1e-05 per=6.4e+00 cost=4.3e+03 flops=6.1e+07
 sigma[gemm] counter=200 i=7 t=6.5e-05 per=5.9e+00 cost=4.9e+03 flops=7.5e+07
 sigma[gemm] counter=200 total t=3.3e-04 per=3.0e+01 cost=2.7e+04 flops=8.3e+07
 sigma[red] counter=200 t=6.8e-04 per=6.2e+01 cost=1.4e+04 flops=2.0e+07
--- TIMING FOR sigma_tot : t_inter=3.6e-02 t_gemm=1.7e-01 t_reduction=1.6e-01 tot=3.7e-01 ---
 sigma_tot[inter] counter=200 t=3.6e-02 per=9.7e+00 cost=1.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=200 i=0 t=5.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=1 t=4.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=2 t=4.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=3 t=4.4e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=4 t=4.1e-02 per=1.1e+01 cost=3.3e+07 flops=8.0e+08
 sigma_tot[gemm] counter=200 i=5 t=4.4e-02 per=1.2e+01 cost=3.3e+07 flops=7.5e+08
 sigma_tot[gemm] counter=200 i=6 t=4.2e-02 per=1.1e+01 cost=3.0e+07 flops=7.1e+08
 sigma_tot[gemm] counter=200 i=7 t=4.1e-02 per=1.1e+01 cost=3.2e+07 flops=7.6e+08
 sigma_tot[gemm] counter=200 total t=1.7e-01 per=4.6e+01 cost=1.3e+08 flops=7.5e+08
 sigma_tot[red] counter=200 t=1.6e-01 per=4.4e+01 cost=3.1e+07 flops=1.9e+08
T(sub)=7.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,3.0e-06,9.0e-07,8.2e-07,2.3e-07
settings: ndim=30 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.336865909158 -1.116e+03  1.855e-02    1     1  3.135e-03 3.135e-03 2.982e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.710e-05,7.118e-05,2.843e-04,6.340e-04,1.021e-03
 ndim=30:2.235e-07GB t[comm(intra)]=2.190e-05 speed=2.042e-02GB/S t[comm(inter)]=5.203e-06 speed=8.592e-02GB/S
--- TIMING FOR sigma : t_inter=7.1e-05 t_gemm=2.8e-04 t_reduction=6.3e-04 tot=9.9e-04 ---
 sigma[inter] counter=201 t=7.1e-05 per=7.2e+00 cost=2.5e+04 flops=3.6e+08
 sigma[gemm] counter=201 i=0 t=2.3e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=1 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=2 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=3 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=4 t=7.5e-05 per=7.6e+00 cost=9.0e+03 flops=1.2e+08
 sigma[gemm] counter=201 i=5 t=7.5e-05 per=7.6e+00 cost=9.0e+03 flops=1.2e+08
 sigma[gemm] counter=201 i=6 t=6.1e-05 per=6.2e+00 cost=4.3e+03 flops=7.0e+07
 sigma[gemm] counter=201 i=7 t=6.3e-05 per=6.4e+00 cost=4.9e+03 flops=7.7e+07
 sigma[gemm] counter=201 total t=2.8e-04 per=2.9e+01 cost=2.7e+04 flops=9.6e+07
 sigma[red] counter=201 t=6.3e-04 per=6.4e+01 cost=1.4e+04 flops=2.2e+07
--- TIMING FOR sigma_tot : t_inter=3.6e-02 t_gemm=1.7e-01 t_reduction=1.6e-01 tot=3.7e-01 ---
 sigma_tot[inter] counter=201 t=3.6e-02 per=9.7e+00 cost=1.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=201 i=0 t=5.2e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=1 t=4.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=2 t=4.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=3 t=4.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=4 t=4.1e-02 per=1.1e+01 cost=3.3e+07 flops=8.0e+08
 sigma_tot[gemm] counter=201 i=5 t=4.4e-02 per=1.2e+01 cost=3.3e+07 flops=7.5e+08
 sigma_tot[gemm] counter=201 i=6 t=4.2e-02 per=1.1e+01 cost=3.0e+07 flops=7.1e+08
 sigma_tot[gemm] counter=201 i=7 t=4.2e-02 per=1.1e+01 cost=3.2e+07 flops=7.6e+08
 sigma_tot[gemm] counter=201 total t=1.7e-01 per=4.6e+01 cost=1.3e+08 flops=7.5e+08
 sigma_tot[red] counter=201 t=1.6e-01 per=4.4e+01 cost=3.1e+07 flops=1.9e+08
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,9.3e-06,2.2e-06,1.0e-06,1.5e-07
    2   0 -    -116.338361861071 -1.496e-03  6.724e-03    2     2  6.340e-03 3.170e-03 2.867e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.726e-05,6.769e-05,2.969e-04,6.323e-04,1.029e-03
 ndim=30:2.235e-07GB t[comm(intra)]=2.220e-05 speed=2.013e-02GB/S t[comm(inter)]=5.059e-06 speed=8.836e-02GB/S
--- TIMING FOR sigma : t_inter=6.8e-05 t_gemm=3.0e-04 t_reduction=6.3e-04 tot=1.0e-03 ---
 sigma[inter] counter=202 t=6.8e-05 per=6.8e+00 cost=2.5e+04 flops=3.8e+08
 sigma[gemm] counter=202 i=0 t=2.4e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=1 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=2 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=3 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=4 t=8.0e-05 per=8.0e+00 cost=9.0e+03 flops=1.1e+08
 sigma[gemm] counter=202 i=5 t=7.7e-05 per=7.7e+00 cost=9.0e+03 flops=1.2e+08
 sigma[gemm] counter=202 i=6 t=6.0e-05 per=6.0e+00 cost=4.3e+03 flops=7.2e+07
 sigma[gemm] counter=202 i=7 t=7.1e-05 per=7.2e+00 cost=4.9e+03 flops=6.8e+07
 sigma[gemm] counter=202 total t=3.0e-04 per=3.0e+01 cost=2.7e+04 flops=9.2e+07
 sigma[red] counter=202 t=6.3e-04 per=6.3e+01 cost=1.4e+04 flops=2.2e+07
--- TIMING FOR sigma_tot : t_inter=3.6e-02 t_gemm=1.7e-01 t_reduction=1.6e-01 tot=3.7e-01 ---
 sigma_tot[inter] counter=202 t=3.6e-02 per=9.7e+00 cost=1.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=202 i=0 t=5.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=1 t=4.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=2 t=4.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=3 t=4.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=4 t=4.1e-02 per=1.1e+01 cost=3.3e+07 flops=8.0e+08
 sigma_tot[gemm] counter=202 i=5 t=4.4e-02 per=1.2e+01 cost=3.3e+07 flops=7.5e+08
 sigma_tot[gemm] counter=202 i=6 t=4.2e-02 per=1.1e+01 cost=3.0e+07 flops=7.1e+08
 sigma_tot[gemm] counter=202 i=7 t=4.2e-02 per=1.1e+01 cost=3.2e+07 flops=7.6e+08
 sigma_tot[gemm] counter=202 total t=1.7e-01 per=4.6e+01 cost=1.3e+08 flops=7.5e+08
 sigma_tot[red] counter=202 t=1.6e-01 per=4.4e+01 cost=3.1e+07 flops=1.9e+08
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.2e-05,1.8e-06,1.0e-06,1.5e-07
    3   0 -    -116.338434948551 -7.309e-05  7.110e-04    3     3  9.267e-03 3.089e-03 2.829e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.694e-05,6.636e-05,2.870e-04,6.315e-04,1.016e-03
 ndim=30:2.235e-07GB t[comm(intra)]=2.203e-05 speed=2.029e-02GB/S t[comm(inter)]=4.907e-06 speed=9.110e-02GB/S
--- TIMING FOR sigma : t_inter=6.6e-05 t_gemm=2.9e-04 t_reduction=6.3e-04 tot=9.8e-04 ---
 sigma[inter] counter=203 t=6.6e-05 per=6.7e+00 cost=2.5e+04 flops=3.8e+08
 sigma[gemm] counter=203 i=0 t=2.4e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=1 t=2.2e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=2 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=3 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=4 t=7.8e-05 per=7.9e+00 cost=9.0e+03 flops=1.2e+08
 sigma[gemm] counter=203 i=5 t=7.8e-05 per=7.9e+00 cost=9.0e+03 flops=1.2e+08
 sigma[gemm] counter=203 i=6 t=6.3e-05 per=6.4e+00 cost=4.3e+03 flops=6.8e+07
 sigma[gemm] counter=203 i=7 t=5.8e-05 per=5.9e+00 cost=4.9e+03 flops=8.3e+07
 sigma[gemm] counter=203 total t=2.9e-04 per=2.9e+01 cost=2.7e+04 flops=9.5e+07
 sigma[red] counter=203 t=6.3e-04 per=6.4e+01 cost=1.4e+04 flops=2.2e+07
--- TIMING FOR sigma_tot : t_inter=3.6e-02 t_gemm=1.7e-01 t_reduction=1.6e-01 tot=3.7e-01 ---
 sigma_tot[inter] counter=203 t=3.6e-02 per=9.7e+00 cost=1.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=203 i=0 t=5.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=1 t=4.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=2 t=4.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=3 t=4.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=4 t=4.1e-02 per=1.1e+01 cost=3.3e+07 flops=8.0e+08
 sigma_tot[gemm] counter=203 i=5 t=4.4e-02 per=1.2e+01 cost=3.3e+07 flops=7.5e+08
 sigma_tot[gemm] counter=203 i=6 t=4.2e-02 per=1.1e+01 cost=3.0e+07 flops=7.1e+08
 sigma_tot[gemm] counter=203 i=7 t=4.2e-02 per=1.1e+01 cost=3.2e+07 flops=7.6e+08
 sigma_tot[gemm] counter=203 total t=1.7e-01 per=4.6e+01 cost=1.3e+08 flops=7.4e+08
 sigma_tot[red] counter=203 t=1.6e-01 per=4.4e+01 cost=3.1e+07 flops=1.9e+08
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,9.4e-06,1.6e-06,8.8e-07,1.2e-07
    4   0 -    -116.338436814482 -1.866e-06  1.919e-04    3     4  1.220e-02 3.049e-03 2.813e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.743e-05,6.624e-05,2.904e-04,6.291e-04,1.017e-03
 ndim=30:2.235e-07GB t[comm(intra)]=2.207e-05 speed=2.025e-02GB/S t[comm(inter)]=5.356e-06 speed=8.346e-02GB/S
--- TIMING FOR sigma : t_inter=6.6e-05 t_gemm=2.9e-04 t_reduction=6.3e-04 tot=9.9e-04 ---
 sigma[inter] counter=204 t=6.6e-05 per=6.7e+00 cost=2.5e+04 flops=3.8e+08
 sigma[gemm] counter=204 i=0 t=2.7e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=1 t=2.3e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=2 t=2.3e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=3 t=2.3e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=4 t=8.0e-05 per=8.1e+00 cost=9.0e+03 flops=1.1e+08
 sigma[gemm] counter=204 i=5 t=7.8e-05 per=7.9e+00 cost=9.0e+03 flops=1.2e+08
 sigma[gemm] counter=204 i=6 t=6.5e-05 per=6.6e+00 cost=4.3e+03 flops=6.7e+07
 sigma[gemm] counter=204 i=7 t=5.8e-05 per=5.9e+00 cost=4.9e+03 flops=8.3e+07
 sigma[gemm] counter=204 total t=2.9e-04 per=2.9e+01 cost=2.7e+04 flops=9.4e+07
 sigma[red] counter=204 t=6.3e-04 per=6.4e+01 cost=1.4e+04 flops=2.2e+07
--- TIMING FOR sigma_tot : t_inter=3.6e-02 t_gemm=1.7e-01 t_reduction=1.6e-01 tot=3.7e-01 ---
 sigma_tot[inter] counter=204 t=3.6e-02 per=9.7e+00 cost=1.7e+08 flops=4.8e+09
 sigma_tot[gemm] counter=204 i=0 t=5.3e-04 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=1 t=4.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=2 t=4.6e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=3 t=4.5e-04 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=4 t=4.1e-02 per=1.1e+01 cost=3.3e+07 flops=8.0e+08
 sigma_tot[gemm] counter=204 i=5 t=4.4e-02 per=1.2e+01 cost=3.3e+07 flops=7.5e+08
 sigma_tot[gemm] counter=204 i=6 t=4.2e-02 per=1.1e+01 cost=3.0e+07 flops=7.1e+08
 sigma_tot[gemm] counter=204 i=7 t=4.2e-02 per=1.1e+01 cost=3.2e+07 flops=7.6e+08
 sigma_tot[gemm] counter=204 total t=1.7e-01 per=4.6e+01 cost=1.3e+08 flops=7.4e+08
 sigma_tot[red] counter=204 t=1.6e-01 per=4.4e+01 cost=3.1e+07 flops=1.9e+08
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=3.1e-06,9.5e-06,1.7e-06,8.6e-07,1.5e-07
    5   0 +    -116.338436942700 -1.282e-07  3.305e-05    3     5  1.520e-02 3.040e-03 2.817e-03
TIMING FOR Davidson : 1.527e-02  T(cal/comm/rest)=1.409e-02,2.090e-07,1.180e-03
decomposed t_rest=1.180e-03
 T(sub)    =7.317e-05 per=6.202e+00
 T(precond)=1.373e-04 per=1.164e+01
 T(ortho)  =6.419e-06 per=5.441e-01
 T(xcopy)  =5.980e-07 per=5.069e-02
 T(xnrm2)  =6.340e-07 per=5.374e-02
 T(other)  =9.617e-04 per=8.151e+01
optimized energies: isweep=0 ibond=33 dots=2 e[0]=-116.338436942700 nmvp=5
CPUmem: VM:7.276e+01GB RSS:5.852e-01GB  Timing: User:5.783e+01S Sys:1.221e+00S Total:5.905e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond33.txt
 qbond: qsuper nsym=9 dimAll=25
 (25,1):3 (26,0):5 (26,2):3 (24,0):1 (27,1):6 (28,0):3 (28,2):2 (29,1):1 (27,3):1
----- TMING FOR decimation_genbasis(su2): 6.7e-05 S -----
decimation summary: 25->8 dwt=+1.110e-16 SvN=6.290e-01
 qbond: qkept nsym=5 dimAll=8
 (28,0):3 (27,1):2 (26,0):1 (28,2):1 (29,1):1
----- TIMING for decimation_row(nkr): 3.226e-03 S T(decim/select/formRot)=3.427e-04,2.752e-03,1.310e-04 -----
----- TIMING FOR twodot_decimation: 3.433e-03 S T(wf/decim)=1.316e-04,3.302e-03 -----
ctns::oper_renorm coord=(2,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:18 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=8,8 size(op)=16:1.221e-04MB size(tot)=398:3.036e-03MB:2.965e-06GB
CPUmem: VM:7.282e+01GB RSS:5.852e-01GB  Timing: User:5.808e+01S Sys:1.221e+00S Total:5.930e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=31 : 1.619e-04 S -----
rank=0 GPUmem(GB): used=1.61e-05 (oper)=1.33e-05
rank=0 GPUmem(GB): used=1.63e-05 (oper,site)(GB)=1.33e-05,2.16e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=31
 no. of rintermediate operators=22
 no. of coefficients=374:0.00285MB:2.79e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.824e-04 S -----
rank=0 GPUmem(GB): used=1.91e-05 (oper,site,rinter)=1.33e-05,2.16e-07,2.79e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000782 S size(rtasks)=31 size(Rlst2)=25 T(Rmu/Rlist)=3.39e-05,0.000748 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000878 S size(rtasks)=31 size(Rlst)=951 -----
rank=0 GPUmem(GB): used=1.91e-05 (oper,site,rinter,batch)=1.33e-05,2.16e-07,2.79e-06,0.000163 blksize=9 blksize0=4 batchsize=951
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.65e-05,0.00054,0.000231
--- TIMING FOR renorm : t_inter=9.6e-05 t_gemm=5.4e-04 t_reduction=2.3e-04 tot=8.7e-04 ---
 renorm[inter] counter=34 t=9.6e-05 per=1.1e+01 cost=1.0e+04 flops=1.1e+08
 renorm[gemm] counter=34 i=0 t=2.8e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=1 t=2.2e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=2 t=1.5e-04 per=1.7e+01 cost=2.1e+03 flops=1.4e+07
 renorm[gemm] counter=34 i=3 t=1.6e-04 per=1.9e+01 cost=4.3e+03 flops=2.6e+07
 renorm[gemm] counter=34 i=4 t=2.3e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=5 t=2.2e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=34 i=6 t=2.2e-04 per=2.5e+01 cost=8.9e+03 flops=4.1e+07
 renorm[gemm] counter=34 total t=5.4e-04 per=6.2e+01 cost=1.5e+04 flops=2.8e+07
 renorm[red] counter=34 t=2.3e-04 per=2.7e+01 cost=6.2e+03 flops=2.7e+07
--- TIMING FOR renorm_tot : t_inter=4.6e-03 t_gemm=2.3e-02 t_reduction=8.5e-03 tot=3.6e-02 ---
 renorm_tot[inter] counter=34 t=4.6e-03 per=1.3e+01 cost=3.2e+06 flops=6.9e+08
 renorm_tot[gemm] counter=34 i=0 t=9.6e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=34 i=1 t=7.8e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=34 i=2 t=3.6e-03 per=1.0e+01 cost=2.1e+05 flops=5.9e+07
 renorm_tot[gemm] counter=34 i=3 t=4.1e-03 per=1.1e+01 cost=5.9e+05 flops=1.4e+08
 renorm_tot[gemm] counter=34 i=4 t=3.6e-03 per=1.0e+01 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=34 i=5 t=3.6e-03 per=1.0e+01 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=34 i=6 t=7.8e-03 per=2.2e+01 cost=2.0e+06 flops=2.5e+08
 renorm_tot[gemm] counter=34 total t=2.3e-02 per=6.4e+01 cost=3.5e+06 flops=1.5e+08
 renorm_tot[red] counter=34 t=8.5e-03 per=2.4e+01 cost=8.6e+05 flops=1.0e+08
qops.to_cpu: size(tot)=398:3.0e-03MB:3.0e-06GB t[to_cpu]=1.7e-05S speed=1.8e-01GB/S
check ||H-H.dagger||=1.766e-14 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00504 S rank=0 -----
CPUmem: VM:7.282e+01GB RSS:5.852e-01GB  Timing: User:5.821e+01S Sys:1.222e+00S Total:5.943e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=834:6.363e-03MB:6.214e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=17:1.297e-04MB:1.267e-07GB
total mem of comb=852:6.500e-03MB:6.348e-06GB
CPUmem: VM:7.282e+01GB RSS:5.852e-01GB  Timing: User:5.821e+01S Sys:1.222e+00S Total:5.943e+01S
##### local opt: 4.865e-02 S #####
 T(local opt: fetch) = 6.057e-03 S  per = 12.5  per(accum) = 12.5
 T(local opt: hdiag) = 1.388e-03 S  per = 2.85  per(accum) = 15.3
 T(local opt: dvdsn) = 2.643e-02 S  per = 54.3  per(accum) = 69.6
 T(local opt: decim) = 3.512e-03 S  per = 7.22  per(accum) = 76.9
 T(local opt: guess) = 7.141e-05 S  per = 0.147  per(accum) = 77
 T(local opt: renrm) = 5.816e-03 S  per =   12  per(accum) = 89
 T(local opt: save ) = 5.369e-03 S  per =   11  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.643e-02 S  T(sum) = 2.573e-02 S  per = 9.734e+01
 T(local opt: preprocess                  ) = 4.399e-04 S  per = 1.71  per(accum) = 1.71
 T(local opt: symbolic_formulae           ) = 4.317e-04 S  per = 1.68  per(accum) = 3.39
 T(local opt: hintermediate init          ) = 4.826e-04 S  per = 1.88  per(accum) = 5.26
 T(local opt: preprocess_hformulae_Hxlist ) = 7.864e-03 S  per = 30.6  per(accum) = 35.8
 T(local opt: hmmtasks init               ) = 1.064e-03 S  per = 4.14  per(accum) = 40
 T(local opt: initial guess for dvdson    ) = 1.808e-04 S  per = 0.703  per(accum) = 40.7
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.395e-02 S  per = 54.2  per(accum) = 94.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.398e-04 S  per = 0.543  per(accum) = 95.4
 T(local opt: dvdson solver [comm(cpu)]   ) = 2.090e-07 S  per = 0.000812  per(accum) = 95.4
 T(local opt: dvdson solver [rest part]   ) = 1.180e-03 S  per = 4.59  per(accum) = 100
Detailed decomposition of T(renrm) = 5.816e-03 S  T(sum) = 5.816e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.005e-04 S  per = 1.73  per(accum) = 1.73
 T(local opt: qops init                    ) = 3.270e-04 S  per = 5.62  per(accum) = 7.35
 T(local opt: symbolic_formulae_renorm     ) = 2.345e-04 S  per = 4.03  per(accum) = 11.4
 T(local opt: allocate qops on gpu         ) = 7.925e-05 S  per = 1.36  per(accum) = 12.7
 T(local opt: site memcpy cpu2gpu          ) = 8.417e-05 S  per = 1.45  per(accum) = 14.2
 T(local opt: rintermediate init           ) = 4.191e-04 S  per = 7.21  per(accum) = 21.4
 T(local opt: preprocess_formulae_Rlist2   ) = 9.510e-04 S  per = 16.4  per(accum) = 37.8
 T(local opt: rmmtasks init                ) = 3.199e-04 S  per =  5.5  per(accum) = 43.3
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 0.000567  per(accum) = 43.3
 T(local opt: preprocess_renorm_batchGPU   ) = 2.452e-03 S  per = 42.2  per(accum) = 85.4
 T(local opt: reduction of opS & opH [nccl]) = 5.660e-07 S  per = 0.00973  per(accum) = 85.4
 T(local opt: qops memcpy gpu2cpu          ) = 8.120e-05 S  per =  1.4  per(accum) = 86.8
 T(local opt: deallocate cpu and gpu memory) = 9.616e-06 S  per = 0.165  per(accum) = 87
 T(local opt: reduction of opS & opH [comm]) = 7.891e-05 S  per = 1.36  per(accum) = 88.3
 T(local opt: conversion from opAB to opPQ ) = 6.437e-05 S  per = 1.11  per(accum) = 89.5
 T(local opt: after oper_renorm            ) = 6.135e-04 S  per = 10.5  per(accum) = 100
##### sweep opt: 2.890e+00 S #####
 T(sweep opt: fetch) = 2.209e-01 S  per = 7.64  per(accum) = 7.64
 T(sweep opt: hdiag) = 1.818e-01 S  per = 6.29  per(accum) = 13.9
 T(sweep opt: dvdsn) = 1.908e+00 S  per =   66  per(accum) = 79.9
 T(sweep opt: decim) = 1.262e-01 S  per = 4.37  per(accum) = 84.3
 T(sweep opt: guess) = 3.884e-03 S  per = 0.134  per(accum) = 84.4
 T(sweep opt: renrm) = 2.936e-01 S  per = 10.2  per(accum) = 94.6
 T(sweep opt: save ) = 1.560e-01 S  per =  5.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.908e+00 S  T(sum) = 1.878e+00 S  per = 9.844e+01
 T(sweep opt: preprocess                  ) = 2.130e-02 S  per = 1.13  per(accum) = 1.13
 T(sweep opt: symbolic_formulae           ) = 3.561e-02 S  per =  1.9  per(accum) = 3.03
 T(sweep opt: hintermediate init          ) = 1.954e-02 S  per = 1.04  per(accum) = 4.07
 T(sweep opt: preprocess_hformulae_Hxlist ) = 8.115e-01 S  per = 43.2  per(accum) = 47.3
 T(sweep opt: hmmtasks init               ) = 1.368e-01 S  per = 7.29  per(accum) = 54.6
 T(sweep opt: initial guess for dvdson    ) = 8.205e-03 S  per = 0.437  per(accum) = 55
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 7.823e-01 S  per = 41.7  per(accum) = 96.7
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 5.849e-03 S  per = 0.311  per(accum) = 97
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 9.226e-06 S  per = 0.000491  per(accum) = 97
 T(sweep opt: dvdson solver [rest part]   ) = 5.660e-02 S  per = 3.01  per(accum) = 100
Detailed decomposition of T(renrm) = 2.936e-01 S  T(sum) = 2.936e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.976e-03 S  per = 1.35  per(accum) = 1.35
 T(sweep opt: qops init                    ) = 1.574e-02 S  per = 5.36  per(accum) = 6.72
 T(sweep opt: symbolic_formulae_renorm     ) = 1.654e-02 S  per = 5.63  per(accum) = 12.3
 T(sweep opt: allocate qops on gpu         ) = 3.167e-03 S  per = 1.08  per(accum) = 13.4
 T(sweep opt: site memcpy cpu2gpu          ) = 3.025e-03 S  per = 1.03  per(accum) = 14.5
 T(sweep opt: rintermediate init           ) = 1.588e-02 S  per = 5.41  per(accum) = 19.9
 T(sweep opt: preprocess_formulae_Rlist2   ) = 7.093e-02 S  per = 24.2  per(accum) = 44
 T(sweep opt: rmmtasks init                ) = 2.270e-02 S  per = 7.73  per(accum) = 51.8
 T(sweep opt: qops memset on cpu           ) = 1.645e-06 S  per = 0.00056  per(accum) = 51.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 9.591e-02 S  per = 32.7  per(accum) = 84.4
 T(sweep opt: reduction of opS & opH [nccl]) = 1.991e-05 S  per = 0.00678  per(accum) = 84.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.379e-03 S  per = 1.15  per(accum) = 85.6
 T(sweep opt: deallocate cpu and gpu memory) = 4.853e-04 S  per = 0.165  per(accum) = 85.7
 T(sweep opt: reduction of opS & opH [comm]) = 3.143e-03 S  per = 1.07  per(accum) = 86.8
 T(sweep opt: conversion from opAB to opPQ ) = 1.470e-02 S  per = 5.01  per(accum) = 91.8
 T(sweep opt: after oper_renorm            ) = 2.401e-02 S  per = 8.18  per(accum) = 100
##### global opt: 2.890e+00 S #####
 T(global opt: fetch) = 2.209e-01 S  per = 7.64  per(accum) = 7.64
 T(global opt: hdiag) = 1.818e-01 S  per = 6.29  per(accum) = 13.9
 T(global opt: dvdsn) = 1.908e+00 S  per =   66  per(accum) = 79.9
 T(global opt: decim) = 1.262e-01 S  per = 4.37  per(accum) = 84.3
 T(global opt: guess) = 3.884e-03 S  per = 0.134  per(accum) = 84.4
 T(global opt: renrm) = 2.936e-01 S  per = 10.2  per(accum) = 94.6
 T(global opt: save ) = 1.560e-01 S  per =  5.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.908e+00 S  T(sum) = 1.878e+00 S  per = 9.844e+01
 T(global opt: preprocess                  ) = 2.130e-02 S  per = 1.13  per(accum) = 1.13
 T(global opt: symbolic_formulae           ) = 3.561e-02 S  per =  1.9  per(accum) = 3.03
 T(global opt: hintermediate init          ) = 1.954e-02 S  per = 1.04  per(accum) = 4.07
 T(global opt: preprocess_hformulae_Hxlist ) = 8.115e-01 S  per = 43.2  per(accum) = 47.3
 T(global opt: hmmtasks init               ) = 1.368e-01 S  per = 7.29  per(accum) = 54.6
 T(global opt: initial guess for dvdson    ) = 8.205e-03 S  per = 0.437  per(accum) = 55
 T(global opt: dvdson solver [Hx_batchGPU] ) = 7.823e-01 S  per = 41.7  per(accum) = 96.7
 T(global opt: dvdson solver [comm(gpu)]   ) = 5.849e-03 S  per = 0.311  per(accum) = 97
 T(global opt: dvdson solver [comm(cpu)]   ) = 9.226e-06 S  per = 0.000491  per(accum) = 97
 T(global opt: dvdson solver [rest part]   ) = 5.660e-02 S  per = 3.01  per(accum) = 100
Detailed decomposition of T(renrm) = 2.936e-01 S  T(sum) = 2.936e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.976e-03 S  per = 1.35  per(accum) = 1.35
 T(global opt: qops init                    ) = 1.574e-02 S  per = 5.36  per(accum) = 6.72
 T(global opt: symbolic_formulae_renorm     ) = 1.654e-02 S  per = 5.63  per(accum) = 12.3
 T(global opt: allocate qops on gpu         ) = 3.167e-03 S  per = 1.08  per(accum) = 13.4
 T(global opt: site memcpy cpu2gpu          ) = 3.025e-03 S  per = 1.03  per(accum) = 14.5
 T(global opt: rintermediate init           ) = 1.588e-02 S  per = 5.41  per(accum) = 19.9
 T(global opt: preprocess_formulae_Rlist2   ) = 7.093e-02 S  per = 24.2  per(accum) = 44
 T(global opt: rmmtasks init                ) = 2.270e-02 S  per = 7.73  per(accum) = 51.8
 T(global opt: qops memset on cpu           ) = 1.645e-06 S  per = 0.00056  per(accum) = 51.8
 T(global opt: preprocess_renorm_batchGPU   ) = 9.591e-02 S  per = 32.7  per(accum) = 84.4
 T(global opt: reduction of opS & opH [nccl]) = 1.991e-05 S  per = 0.00678  per(accum) = 84.4
 T(global opt: qops memcpy gpu2cpu          ) = 3.379e-03 S  per = 1.15  per(accum) = 85.6
 T(global opt: deallocate cpu and gpu memory) = 4.853e-04 S  per = 0.165  per(accum) = 85.7
 T(global opt: reduction of opS & opH [comm]) = 3.143e-03 S  per = 1.07  per(accum) = 86.8
 T(global opt: conversion from opAB to opPQ ) = 1.470e-02 S  per = 5.01  per(accum) = 91.8
 T(global opt: after oper_renorm            ) = 2.401e-02 S  per = 8.18  per(accum) = 100

======================================================================
sweep_data::summary isweep=0 mpisize=1 maxthreads=64
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=2 dwt=+1.110e-16 nmvp=3 e[0]=-116.177526452453 t=0.042
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=4 dwt=+0.000e+00 nmvp=6 e[0]=-116.200295182409 t=0.042
 ibond=2 bond=(3,0)-(4,0) forward=1 deff=7 dwt=+0.000e+00 nmvp=7 e[0]=-116.215792300366 t=0.050
 ibond=3 bond=(4,0)-(5,0) forward=1 deff=10 dwt=+1.070e-06 nmvp=6 e[0]=-116.216235822396 t=0.069
 ibond=4 bond=(5,0)-(6,0) forward=1 deff=10 dwt=+1.978e-04 nmvp=7 e[0]=-116.217372098438 t=0.137
 ibond=5 bond=(6,0)-(7,0) forward=1 deff=10 dwt=+5.145e-02 nmvp=8 e[0]=-116.234506198197 t=0.112
 ibond=6 bond=(7,0)-(8,0) forward=1 deff=10 dwt=+2.363e-04 nmvp=7 e[0]=-116.238044195480 t=0.075
 ibond=7 bond=(8,0)-(9,0) forward=1 deff=10 dwt=+5.960e-04 nmvp=7 e[0]=-116.248994471347 t=0.132
 ibond=8 bond=(9,0)-(10,0) forward=1 deff=10 dwt=+4.871e-03 nmvp=6 e[0]=-116.250773542643 t=0.134
 ibond=9 bond=(10,0)-(11,0) forward=1 deff=10 dwt=+1.232e-03 nmvp=7 e[0]=-116.266701220274 t=0.099
 ibond=10 bond=(11,0)-(12,0) forward=1 deff=10 dwt=+7.393e-07 nmvp=7 e[0]=-116.284967260831 t=0.080
 ibond=11 bond=(12,0)-(13,0) forward=1 deff=9 dwt=+0.000e+00 nmvp=6 e[0]=-116.291464685952 t=0.078
 ibond=12 bond=(13,0)-(14,0) forward=1 deff=7 dwt=+1.110e-16 nmvp=6 e[0]=-116.298821391660 t=0.053
 ibond=13 bond=(14,0)-(15,0) forward=1 deff=10 dwt=+7.605e-09 nmvp=6 e[0]=-116.301456582762 t=0.064
 ibond=14 bond=(15,0)-(16,0) forward=1 deff=10 dwt=+6.494e-06 nmvp=7 e[0]=-116.307302820366 t=0.071
 ibond=15 bond=(16,0)-(17,0) forward=1 deff=10 dwt=+5.064e-08 nmvp=6 e[0]=-116.311487752567 t=0.067
 ibond=16 bond=(17,0)-(18,0) forward=1 deff=9 dwt=+1.110e-16 nmvp=6 e[0]=-116.316728679445 t=0.057
 ibond=17 bond=(17,0)-(18,0) forward=0 deff=9 dwt=+0.000e+00 nmvp=1 e[0]=-116.316728679445 t=0.035
 ibond=18 bond=(16,0)-(17,0) forward=0 deff=10 dwt=+2.861e-05 nmvp=5 e[0]=-116.316765976237 t=0.076
 ibond=19 bond=(15,0)-(16,0) forward=0 deff=10 dwt=+3.341e-04 nmvp=6 e[0]=-116.317231466819 t=0.103
 ibond=20 bond=(14,0)-(15,0) forward=0 deff=10 dwt=+6.719e-05 nmvp=6 e[0]=-116.317295830465 t=0.089
 ibond=21 bond=(13,0)-(14,0) forward=0 deff=10 dwt=+4.290e-04 nmvp=7 e[0]=-116.323389329774 t=0.092
 ibond=22 bond=(12,0)-(13,0) forward=0 deff=10 dwt=+7.384e-04 nmvp=7 e[0]=-116.327525813352 t=0.112
 ibond=23 bond=(11,0)-(12,0) forward=0 deff=10 dwt=+3.719e-03 nmvp=7 e[0]=-116.329980164892 t=0.108
 ibond=24 bond=(10,0)-(11,0) forward=0 deff=10 dwt=+3.623e-03 nmvp=7 e[0]=-116.331017307255 t=0.129
 ibond=25 bond=(9,0)-(10,0) forward=0 deff=10 dwt=+4.776e-03 nmvp=7 e[0]=-116.332572672318 t=0.164
 ibond=26 bond=(8,0)-(9,0) forward=0 deff=10 dwt=+1.635e-04 nmvp=6 e[0]=-116.332392700332 t=0.118
 ibond=27 bond=(7,0)-(8,0) forward=0 deff=10 dwt=-2.220e-16 nmvp=6 e[0]=-116.335549867109 t=0.066
 ibond=28 bond=(6,0)-(7,0) forward=0 deff=10 dwt=+8.624e-03 nmvp=7 e[0]=-116.339671899742 t=0.096
 ibond=29 bond=(5,0)-(6,0) forward=0 deff=10 dwt=+1.424e-04 nmvp=6 e[0]=-116.336697017628 t=0.115
 ibond=30 bond=(4,0)-(5,0) forward=0 deff=10 dwt=+5.309e-06 nmvp=7 e[0]=-116.336855132062 t=0.071
 ibond=31 bond=(3,0)-(4,0) forward=0 deff=10 dwt=+2.094e-06 nmvp=3 e[0]=-116.336863937704 t=0.059
 ibond=32 bond=(2,0)-(3,0) forward=0 deff=7 dwt=+0.000e+00 nmvp=3 e[0]=-116.336865909158 t=0.046
 ibond=33 bond=(1,0)-(2,0) forward=0 deff=8 dwt=+1.110e-16 nmvp=5 e[0]=-116.338436942700 t=0.049
 eav_max=-116.177526452453 [ibond=0]  dwt_min=-2.220e-16 [ibond=27]
 eav_min=-116.339671899742 [ibond=28]  dwt_max=5.145e-02 [ibond=5]
 eav_diff=0.162145447288
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+8.624e-03 e[0]=-116.339671899742
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0 mpisize=1 maxthreads=64
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.000e-04 0.000e+00 | 204 | 3.200e+00 | 3.200e+00 | 4.061e-02 1.948e-01 1.727e-01 4.081e-01 12.8
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +8.624e-03 e[0]=-116.339671899742 (0.000e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep0_su2
----------------------------------------------------------------------

ctns::sweep_final_LCR2CRR: convert [LC]R => [CR]R
ctns::decimation_row ifab=0 iftrunc=1 dcut=4 nqr=9 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_C0R1.txt
 qbond: qsuper nsym=9 dimAll=28
 (28,0):6 (27,1):3 (26,0):1 (28,2):3 (29,1):7 (30,0):4 (30,2):2 (31,1):1 (29,3):1
----- TMING FOR decimation_genbasis(su2): 1.002e-04 S -----
decimation summary: 28->3 dwt=+0.000e+00 SvN=4.721e-01
 qbond: qkept nsym=3 dimAll=3
 (28,0):1 (29,1):1 (30,0):1
----- TIMING for decimation_row(nkr): 2.543e-03 S T(decim/select/formRot)=3.703e-04,2.036e-03,1.366e-04 -----

ctns::sweep_final_CR2cRR: convert [C]R => [cR]R
ctns::decimation_row ifab=0 iftrunc=1 dcut=1 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_cR0.txt
 qbond: qsuper nsym=6 dimAll=10
 (28,0):1 (29,1):2 (30,0):3 (31,1):2 (32,0):1 (30,2):1
----- TMING FOR decimation_genbasis(su2): 2.561e-05 S -----
decimation summary: 10->1 dwt=+0.000e+00 SvN=0.000e+00
 qbond: qkept nsym=1 dimAll=1
 (30,0):1
----- TIMING for decimation_row(nkr): 2.034e-03 S T(decim/select/formRot)=2.924e-04,1.610e-03,1.318e-04 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep0_su2

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=9 maxdiff=6.932e-16 deviate=0
 idx=2 node=(17,0) Drow=10 maxdiff=9.500e-16 deviate=0
 idx=3 node=(16,0) Drow=10 maxdiff=8.988e-16 deviate=0
 idx=4 node=(15,0) Drow=10 maxdiff=1.230e-15 deviate=0
 idx=5 node=(14,0) Drow=10 maxdiff=1.278e-15 deviate=0
 idx=6 node=(13,0) Drow=10 maxdiff=9.961e-16 deviate=0
 idx=7 node=(12,0) Drow=10 maxdiff=2.359e-15 deviate=0
 idx=8 node=(11,0) Drow=10 maxdiff=2.590e-15 deviate=0
 idx=9 node=(10,0) Drow=10 maxdiff=1.780e-15 deviate=0
 idx=10 node=(9,0) Drow=10 maxdiff=1.568e-15 deviate=0
 idx=11 node=(8,0) Drow=10 maxdiff=1.342e-15 deviate=0
 idx=12 node=(7,0) Drow=10 maxdiff=1.057e-15 deviate=0
 idx=13 node=(6,0) Drow=10 maxdiff=1.103e-15 deviate=0
 idx=14 node=(5,0) Drow=10 maxdiff=1.104e-15 deviate=0
 idx=15 node=(4,0) Drow=10 maxdiff=8.014e-16 deviate=0
 idx=16 node=(3,0) Drow=7 maxdiff=2.546e-16 deviate=0
 idx=17 node=(2,0) Drow=8 maxdiff=5.442e-16 deviate=0
 idx=18 node=(1,0) Drow=3 maxdiff=2.220e-16 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x55a32397adb0
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x55a32397adb0
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 2.542e-03 S -----

ctns::oper_final - build Hmat for RCF at isweep=0

coord=(1,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHPQ nops=C:18 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=8,8 size(op)=16:0.000122MB size(tot)=398:0.00304MB:2.97e-06GB
ctns::oper_renorm coord=(1,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:19 S:1 H:1 P:1 Q:2 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=48:0.000366MB:3.58e-07GB
CPUmem: VM:7.282e+01GB RSS:5.852e-01GB  Timing: User:5.867e+01S Sys:1.222e+00S Total:5.989e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=24 : 9.521e-05 S -----
rank=0 GPUmem(GB): used=1.08e-05 (oper)=1.08e-05
rank=0 GPUmem(GB): used=1.09e-05 (oper,site)(GB)=1.08e-05,1.27e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=24
 no. of rintermediate operators=8
 no. of coefficients=144:0.0011MB:1.07e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.707e-04 S -----
rank=0 GPUmem(GB): used=1.2e-05 (oper,site,rinter)=1.08e-05,1.27e-07,1.07e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000435 S size(rtasks)=24 size(Rlst2)=9 T(Rmu/Rlist)=2.34e-05,0.000412 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000523 S size(rtasks)=24 size(Rlst)=543 -----
rank=0 GPUmem(GB): used=1.2e-05 (oper,site,rinter,batch)=1.08e-05,1.27e-07,1.07e-06,5.26e-05 blksize=3 blksize0=6 batchsize=543
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000109,0.000308,0.000146
--- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=3.1e-04 t_reduction=1.5e-04 tot=5.6e-04 ---
 renorm[inter] counter=35 t=1.1e-04 per=1.9e+01 cost=4.3e+03 flops=4.0e+07
 renorm[gemm] counter=35 i=0 t=2.8e-06 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=1 t=2.2e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=2 t=1.2e-04 per=2.1e+01 cost=1.2e+03 flops=1.0e+07
 renorm[gemm] counter=35 i=3 t=1.2e-04 per=2.0e+01 cost=2.2e+03 flops=1.9e+07
 renorm[gemm] counter=35 i=4 t=2.3e-06 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=5 t=2.2e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=35 i=6 t=6.6e-05 per=1.2e+01 cost=2.0e+03 flops=3.0e+07
 renorm[gemm] counter=35 total t=3.1e-04 per=5.5e+01 cost=5.4e+03 flops=1.8e+07
 renorm[red] counter=35 t=1.5e-04 per=2.6e+01 cost=1.1e+03 flops=7.4e+06
--- TIMING FOR renorm_tot : t_inter=4.7e-03 t_gemm=2.3e-02 t_reduction=8.6e-03 tot=3.7e-02 ---
 renorm_tot[inter] counter=35 t=4.7e-03 per=1.3e+01 cost=3.2e+06 flops=6.8e+08
 renorm_tot[gemm] counter=35 i=0 t=9.9e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=35 i=1 t=8.0e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=35 i=2 t=3.7e-03 per=1.0e+01 cost=2.1e+05 flops=5.7e+07
 renorm_tot[gemm] counter=35 i=3 t=4.2e-03 per=1.1e+01 cost=5.9e+05 flops=1.4e+08
 renorm_tot[gemm] counter=35 i=4 t=3.6e-03 per=9.9e+00 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=35 i=5 t=3.6e-03 per=9.9e+00 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=35 i=6 t=7.9e-03 per=2.2e+01 cost=2.0e+06 flops=2.5e+08
 renorm_tot[gemm] counter=35 total t=2.3e-02 per=6.4e+01 cost=3.5e+06 flops=1.5e+08
 renorm_tot[red] counter=35 t=8.6e-03 per=2.4e+01 cost=8.6e+05 flops=1.0e+08
qops.to_cpu: size(tot)=48:3.7e-04MB:3.6e-07GB t[to_cpu]=1.5e-05S speed=2.3e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00411 S rank=0 -----

coord=(0,0)
 cqops: oplist=CABPQSH nops=C:1 S:19 H:1 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
 rqops: oplist=CSHPQ nops=C:19 S:1 H:1 P:1 Q:2 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=48:0.000366MB:3.58e-07GB
ctns::oper_renorm coord=(0,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=64
 qops: oplist=CSHPQ nops=C:20 S:0 H:1 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
CPUmem: VM:7.282e+01GB RSS:5.852e-01GB  Timing: User:5.867e+01S Sys:1.222e+00S Total:5.989e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=21 : 3.978e-05 S -----
rank=0 GPUmem(GB): used=7.8e-06 (oper)=7.8e-06
rank=0 GPUmem(GB): used=7.82e-06 (oper,site)(GB)=7.8e-06,2.24e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=64
 no. of formulae=21
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=7.82e-06 (oper,site,rinter)=7.8e-06,2.24e-08,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000105 S size(rtasks)=21 size(Rlst2)=1 T(Rmu/Rlist)=1.88e-05,8.65e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000181 S size(rtasks)=21 size(Rlst)=98 -----
rank=0 GPUmem(GB): used=7.82e-06 (oper,site,rinter,batch)=7.8e-06,2.24e-08,0,2.19e-06 blksize=1 blksize0=0 batchsize=98
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.34e-06,0.000184,5.58e-05
--- TIMING FOR renorm : t_inter=7.3e-06 t_gemm=1.8e-04 t_reduction=5.6e-05 tot=2.5e-04 ---
 renorm[inter] counter=36 t=7.3e-06 per=3.0e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=0 t=3.1e-06 per=1.2e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=1 t=2.3e-06 per=9.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=2 t=7.2e-05 per=2.9e+01 cost=9.4e+01 flops=1.3e+06
 renorm[gemm] counter=36 i=3 t=5.1e-05 per=2.1e+01 cost=9.4e+01 flops=1.8e+06
 renorm[gemm] counter=36 i=4 t=2.3e-06 per=9.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=5 t=2.2e-06 per=9.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=6 t=5.0e-05 per=2.0e+01 cost=2.0e+02 flops=3.9e+06
 renorm[gemm] counter=36 total t=1.8e-04 per=7.4e+01 cost=3.8e+02 flops=2.1e+06
 renorm[red] counter=36 t=5.6e-05 per=2.3e+01 cost=2.0e+02 flops=3.5e+06
--- TIMING FOR renorm_tot : t_inter=4.7e-03 t_gemm=2.3e-02 t_reduction=8.7e-03 tot=3.7e-02 ---
 renorm_tot[inter] counter=36 t=4.7e-03 per=1.3e+01 cost=3.2e+06 flops=6.8e+08
 renorm_tot[gemm] counter=36 i=0 t=1.0e-04 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=1 t=8.2e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=2 t=3.8e-03 per=1.0e+01 cost=2.1e+05 flops=5.6e+07
 renorm_tot[gemm] counter=36 i=3 t=4.2e-03 per=1.2e+01 cost=5.9e+05 flops=1.4e+08
 renorm_tot[gemm] counter=36 i=4 t=3.6e-03 per=9.9e+00 cost=2.1e+05 flops=5.8e+07
 renorm_tot[gemm] counter=36 i=5 t=3.6e-03 per=9.9e+00 cost=5.4e+05 flops=1.5e+08
 renorm_tot[gemm] counter=36 i=6 t=7.9e-03 per=2.2e+01 cost=2.0e+06 flops=2.5e+08
 renorm_tot[gemm] counter=36 total t=2.3e-02 per=6.4e+01 cost=3.5e+06 flops=1.5e+08
 renorm_tot[red] counter=36 t=8.7e-03 per=2.4e+01 cost=8.6e+05 flops=9.9e+07
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB t[to_cpu]=1.4e-05S speed=5.2e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
ctns::oper_ab2pq coord=(0,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00321 S rank=0 -----

matrix: Hmat_isweep0 size=(1,1)
     -1.163384369427e+02 

----- TIMING FOR ctns::sweep_opt : 3.246e+00 S -----

Congrats! SADMRG calculation finishes successfully. Sat Nov 23 06:50:23 2024

