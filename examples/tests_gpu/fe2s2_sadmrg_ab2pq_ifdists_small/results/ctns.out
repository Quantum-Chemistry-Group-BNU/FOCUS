
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Sun Jan 12 11:07:11 2025

GIT_HASH = ab3ee787337c6f54282df185169c09ba74b96954

mpisize = 2 maxthreads = 2

input file = input.dat

schedule::read fname = input.dat
----------------------------------------------------------------------
dtype 0
sorb 40
nelec 30
twom 0
twos 0 
integral_file moleinfo/fmole.info
scratch ./scratch

$ci
dets
0 2 4 6 8 10 12 14 16 18 20 22 24 36 38   1 3 15 17 19 21 23 25 27 29 31 33 35 37 39
end
checkms
nroots 1 
schedule
0 1.e-3
end
maxiter 1
$end

$ctns
verbose 1
qkind rNS
tosu2
maxdets 3 #000 # keep dets as much as possible
topology_file topology/topo4
thresh_proj 1.e-10
thresh_ortho 1.e-8 #1.e-10
nroots 1 
schedule
0  2 10 1.e-4 0.0
end
maxsweep 1
alg_hvec 19
alg_hinter 2
alg_hcoper 2
alg_renorm 19
alg_rinter 2
alg_rcoper 1
task_dmrg
ifab2pq
alg_a2p 3
alg_b2q 3
ifnccl
ifdist1
ifdistc
ifdists
$end

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
sorb  = 40
nelec = 30
twom  = 0
twos  = 0
integral_file = moleinfo/fmole.info
perfcomm = 0

===== params_ci::print =====
nroots = 1
no. of unique seeds = 1
0-th det: 0 1 2 3 4 6 8 10 12 14 15 16 17 18 19 20 21 22 23 24 25 27 29 31 33 35 36 37 38 39 
flip = 0
eps0 = 0.01
miniter = 0
maxiter = 1
schedule: iter eps1
0 0.001
convergence parameters
deltaE = 1e-10
checkms = 1
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 0
jroot = 0
load = 0
ci_file = ci.info
cthrd = 0.1
ifanalysis = 0
rdm = 0
init_aufbau = 0
init_seniority = 0

===== params_ctns::print =====
qkind = rNS
topology_file = topology/topo4
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
task_oodmrg = 0
task_vmc = 0
task_expand = 0
task_tononsu2 = 0
task_prop = 
task_schmidt = 0
schmidt_file = svalues
restart_sweep = 0
ciroots = 
maxdets = 3
thresh_proj = 1.000000e-10
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
svd_iop = 13
outprec = 12
nroots = 1
guess = 1
dbranch = 0
maxsweep = 1
maxbond = -1
maxidx = -1
schedule: isweep, dots, dcut, eps, noise
0 2 10 1.000000e-04 0.000000e+00
rcfprefix = 
alg_hvec = 19
alg_hinter = 2
alg_hcoper = 2
alg_renorm = 19
alg_rinter = 2
alg_rcoper = 1
alg_rdm = 1
alg_decim = 0
alg_a2p = 3
alg_b2q = 3
notrunc = 0
ifoutcore = 0
ifab2pq = 1
ifdist1 = 1
ifdistc = 1
ifdists = 1
save_formulae = 0
sort_formulae = 0
save_mmtask = 0
batchhvec = 4 4 4
batchrenorm = 4 4 4
batchmem = 1.000000e+01
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
precond = 1
rcanon_file = 
rcanon2_file = 
iomode = 0
async_fetch = 0
async_save = 0
async_remove = 0
ifnccl = 1
iroot = 0
jroot = 0
nsample = 5000
nprt = 10
pthrd = -1.000000e-02
thresh_cabs = 1.100000e+00
detbasis = 0
tosu2 = 1
thresh_tosu2 = 1.000000e-08
singlet = 0
diagcheck = 0
savebin = 0
fromnosym = 0
oodmrg parameters:
 iprt=1
 maxiter=10
 dfac=2
 macroiter=5
 microiter=50
 alpha=5.000000e-01
 thrdopt=1.000000e-04
 thrdloc=1.000000e-06
 thrddwt=1.000000e+00
 thrdeps=1.000000e-08
 nptloc=2.000000e+01
 acceptall=0
 unrestricted=0
 urot=
inputconf = 
saveconfs = 
loadconfs = 
debug_rdm = 0
alg_mrpt2 = 0
nv2 = 0
nc2 = 0
mpisize_debug = 1
debug_gpumem = 0

io::create_scratch scratch=./scratch

gpu_init
rank=0 deviceCount=2
CUDA Runtime version: 11080
CUBLAS version: 111103
nccl init: rank=1 size=2
nccl init: rank=0 size=2

mem_check: ifgpu=1
rank=0 CPUmem(GB): avail=4.761e+02 total=5.033e+02
rank=1 CPUmem(GB): avail=4.761e+02 total=5.033e+02
min=4.761e+02 max=4.761e+02 diff=0.000e+00
rank=0 GPUmem(GB): avail=6.485e+00 total=3.945e+01
rank=0 GPUmem(GB): avail=6.475e+00 total=3.945e+01
min=6.475e+00 max=6.485e+00 diff=9.766e-03
rank=0 CPUmem(GB): used=1.001e+00 pageheap_free=6.124e-02 change=1.001e+00 heap=1.068e+00 avail=4.761e+02 total=5.033e+02 

ctns::topology::read fname=topology/topo4
0
1
2
3
4
16
17
18
19
5
6
7
8
9
10
11
12
13
14
15

ctns::topology::print ifmps=1 ntotal=20 nphysical=20 nbackbone=20
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
 i=5 : 16 
 i=6 : 17 
 i=7 : 18 
 i=8 : 19 
 i=9 : 5 
 i=10 : 6 
 i=11 : 7 
 i=12 : 8 
 i=13 : 9 
 i=14 : 10 
 i=15 : 11 
 i=16 : 12 
 i=17 : 13 
 i=18 : 14 
 i=19 : 15 
rcoord:
 idx=0 coord=(19,0) rindex=0 node: lindex=19 porb=15 type=0 center=(-1,-1) left=(18,0) right=(-2,-2)
 idx=1 coord=(18,0) rindex=1 node: lindex=18 porb=14 type=1 center=(-1,-1) left=(17,0) right=(19,0)
 idx=2 coord=(17,0) rindex=2 node: lindex=17 porb=13 type=1 center=(-1,-1) left=(16,0) right=(18,0)
 idx=3 coord=(16,0) rindex=3 node: lindex=16 porb=12 type=1 center=(-1,-1) left=(15,0) right=(17,0)
 idx=4 coord=(15,0) rindex=4 node: lindex=15 porb=11 type=1 center=(-1,-1) left=(14,0) right=(16,0)
 idx=5 coord=(14,0) rindex=5 node: lindex=14 porb=10 type=1 center=(-1,-1) left=(13,0) right=(15,0)
 idx=6 coord=(13,0) rindex=6 node: lindex=13 porb=9 type=1 center=(-1,-1) left=(12,0) right=(14,0)
 idx=7 coord=(12,0) rindex=7 node: lindex=12 porb=8 type=1 center=(-1,-1) left=(11,0) right=(13,0)
 idx=8 coord=(11,0) rindex=8 node: lindex=11 porb=7 type=1 center=(-1,-1) left=(10,0) right=(12,0)
 idx=9 coord=(10,0) rindex=9 node: lindex=10 porb=6 type=1 center=(-1,-1) left=(9,0) right=(11,0)
 idx=10 coord=(9,0) rindex=10 node: lindex=9 porb=5 type=1 center=(-1,-1) left=(8,0) right=(10,0)
 idx=11 coord=(8,0) rindex=11 node: lindex=8 porb=19 type=1 center=(-1,-1) left=(7,0) right=(9,0)
 idx=12 coord=(7,0) rindex=12 node: lindex=7 porb=18 type=1 center=(-1,-1) left=(6,0) right=(8,0)
 idx=13 coord=(6,0) rindex=13 node: lindex=6 porb=17 type=1 center=(-1,-1) left=(5,0) right=(7,0)
 idx=14 coord=(5,0) rindex=14 node: lindex=5 porb=16 type=1 center=(-1,-1) left=(4,0) right=(6,0)
 idx=15 coord=(4,0) rindex=15 node: lindex=4 porb=4 type=1 center=(-1,-1) left=(3,0) right=(5,0)
 idx=16 coord=(3,0) rindex=16 node: lindex=3 porb=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=17 coord=(2,0) rindex=17 node: lindex=2 porb=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=18 coord=(1,0) rindex=18 node: lindex=1 porb=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=19 coord=(0,0) rindex=19 node: lindex=0 porb=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(19,0) rsupport: 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) rsupport: 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) rsupport: 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) rsupport: 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) rsupport: 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) rsupport: 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) rsupport: 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) rsupport: 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) rsupport: 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) rsupport: 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) rsupport: 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) rsupport: 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) rsupport: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) rsupport: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 
 idx=14 coord=(5,0) rsupport: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 
 idx=15 coord=(4,0) rsupport: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 
 idx=16 coord=(3,0) rsupport: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 
 idx=17 coord=(2,0) rsupport: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 
 idx=18 coord=(1,0) rsupport: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 
 idx=19 coord=(0,0) rsupport: 0 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(19,0) corbs: 15 ; rorbs: ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) corbs: 14 ; rorbs: 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) corbs: 13 ; rorbs: 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) corbs: 12 ; rorbs: 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) corbs: 11 ; rorbs: 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) corbs: 10 ; rorbs: 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) corbs: 9 ; rorbs: 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) corbs: 8 ; rorbs: 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) corbs: 7 ; rorbs: 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) corbs: 6 ; rorbs: 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) corbs: 5 ; rorbs: 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) corbs: 19 ; rorbs: 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) corbs: 18 ; rorbs: 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) corbs: 17 ; rorbs: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 
 idx=14 coord=(5,0) corbs: 16 ; rorbs: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 
 idx=15 coord=(4,0) corbs: 4 ; rorbs: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 
 idx=16 coord=(3,0) corbs: 3 ; rorbs: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 
 idx=17 coord=(2,0) corbs: 2 ; rorbs: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 
 idx=18 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 
 idx=19 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9 32 33 34 35 36 37 38 39 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31

fci::ci_load fname=./scratch/ci.info

ctns::rcanon_init qkind=qNSz

fci::ci_truncate ciconfs=1641 maxdets=3 ifortho=1
 iroot=0 <CI[trunc]|CI>=4.658673369179e-01

ctns::init_rbases rdm_svd=1.500e+00 svd_iop=13 thresh_proj=1.000e-10

idx=0 node=(19,0)
idx=1 node=(18,0) type=1 rsupport= type=14 015  rsupport=
15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10

idx=2 node=(17,0) type=1 rsupport=13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)= dim(space,lspace,rspace)=3,3,3,3,22 dimBc= dimBc=22 1-popBc= 1-popBc=0.000e+000.000e+00 SvN= SvN=4.447e-014.447e-01

----- TIMING FOR ctns::right_projection<Qm,Tm> : ----- TIMING FOR ctns::right_projection<Qm,Tm> : 3.885e-04 S -----
0.000308 S -----

idx=3 node=(16,0) type=1 rsupport=12 13 14 15 

idx=4 node=(15,0) type=1 rsupport=11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=3,3,2 dimBc=2 1-popBc=0.000e+00 SvN=4.447e-01
----- TIMING FOR ctns::right_projection<Qm,Tm> : 6.958e-05 S -----

idx=5 node=(14,0) type=1 rsupport=10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)= dim(space,lspace,rspace)=33,,22,2 dimBc=,2 1-popBc=2 dimBc=2 1-popBc=0.000e+000.000e+00 SvN= SvN=1.142e-011.142e-01

----- TIMING FOR ----- TIMING FOR ctns::right_projection<Qm,Tm>ctns::right_projection<Qm,Tm> :  : 3.529e-033.627e-03 S -----
 S -----

idx=6
idx=7 node=(12,0) type= node=1(13 rsupport=,80 )9 10  type=111  rsupport=12 13 14 915 
 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=3,2, dim(space,lspace,rspace)=23, dimBc=2 1-popBc=2,2 dimBc=2 1-popBc=0.000e+00 SvN=0.000e+00 SvN=1.142e-01
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.142e-01
----- TIMING FOR ctns::right_projection<Qm,Tm> : 6.716e-05 S -----
7.875e-05 S -----

idx=8 node=(11,0) type=1 rsupport=7 
idx=9 node=(10,0) type=1 rsupport=6 78  9 810 11  912  13 10 1411 12 15  
13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=3 dim(space,lspace,rspace)=,3,22,,33 dimBc= dimBc=22 1-popBc= 1-popBc=0.000e+000.000e+00 SvN= SvN=4.142e-014.142e-01
----- TIMING FOR ctns::right_projection<Qm,Tm>
 : ----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.909e-043.104e-04 S ----- S -----


idx=10 node=(9,0) type=1 rsupport=
idx=11 node=(8,0) type=15 rsupport= 6 719  8 59 6  7 8 109 10  11 1211 13  1412 13  1514 
 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=3,1,3 dimBc=1 1-popBc=0.000e+00 SvN=0.000e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> :  dim(space,lspace,rspace)=3,8.357e-05 S -----
1,3 dimBc=1 1-popBc=0 SvN=0
----- TIMING FOR ctns::right_projection<Qm,Tm> : 
idx=12 node=(7,0) type=1.006e-041 S ----- rsupport=
18 19 5 6 7 8 9 10 11 12 13 14 15 

idx=13 node=(6,0) type=1 rsupport=17 18 19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=3,1,3 dimBc=1 1-popBc=0.000e+00 SvN=0.000e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 5.630e-05 S -----
 dim(space,lspace,rspace)=3,1,3 dimBc=1 1-popBc=0 SvN=0
----- TIMING FOR ctns::right_projection<Qm,Tm> : 
idx=14 node=(5,0) type=1 rsupport=6.213e-0516 17 18  S -----19 
5 6 7 8 9 10 11 12 13 14 15 

idx=15 node=(4,0) type=1 rsupport=4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=3,1,3 dimBc=1 1-popBc=0.000e+00 SvN=0.000e+00
 dim(space,lspace,rspace)=----- TIMING FOR 3ctns::right_projection<Qm,Tm> : ,1,3 dimBc=1 1-popBc=6.429e-05 S -----
0.000e+00 SvN=0
----- TIMING FOR ctns::right_projection<Qm,Tm> : 
idx=16 node=(3,0) type=17.501e-05 rsupport= S -----
3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 

idx=17 node=(2,0) type=1 rsupport=2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=3,1,3 dimBc=1 1-popBc=0.000e+00 SvN=0.000e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> :  dim(space,lspace,rspace)=3,1,5.812e-053 S ----- dimBc=
1 1-popBc=0 SvN=0
----- TIMING FOR ctns::right_projection<Qm,Tm> : 
idx=18 node=(1,0) type=1 rsupport=1 26.853e-05  S -----
3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 

idx=19 node=(0,0) type=0 rsupport=0 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=3,1,3 dimBc=1 1-popBc=0.000e+00 SvN=0.000e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 5.142e-05 S -----
 dim(space,lspace,rspace)=3,1,3 dimBc=1 1-popBc=0 SvN=0
----- TIMING FOR ctns::right_projection<Qm,Tm> : 6.093e-05 S -----

generated rbases with thresh_proj=1e-10
 idx=0 node=(19,0) type=0 shape=4,4 1-popBc=0.000e+00
 idx=1 node=(18,0) type=1 shape=2,2 1-popBc=0.000e+00
 idx=2 node=(17,0) type=1 shape=2,2 1-popBc=0.000e+00
 idx=3 node=(16,0) type=1 shape=2,2 1-popBc=0.000e+00
 idx=4 node=(15,0) type=1 shape=2,2 1-popBc=0.000e+00
 idx=5 node=(14,0) type=1 shape=2,2 1-popBc=0.000e+00
 idx=6 node=(13,0) type=1 shape=2,2 1-popBc=0.000e+00
 idx=7 node=(12,0) type=1 shape=2,2 1-popBc=0.000e+00
 idx=8 node=(11,0) type=1 shape=3,2 1-popBc=0.000e+00
 idx=9 node=(10,0) type=1 shape=3,2 1-popBc=0.000e+00
 idx=10 node=(9,0) type=1 shape=3,1 1-popBc=0.000e+00
 idx=11 node=(8,0) type=1 shape=3,1 1-popBc=0.000e+00
 idx=12 node=(7,0) type=1 shape=3,1 1-popBc=0.000e+00
 idx=13 node=(6,0) type=1 shape=3,1 1-popBc=0.000e+00
 idx=14 node=(5,0) type=1 shape=3,1 1-popBc=0.000e+00
 idx=15 node=(4,0) type=1 shape=3,1 1-popBc=0.000e+00
 idx=16 node=(3,0) type=1 shape=3,1 1-popBc=0.000e+00
 idx=17 node=(2,0) type=1 shape=3,1 1-popBc=0.000e+00
 idx=18 node=(1,0) type=1 shape=3,1 1-popBc=0.000e+00
 idx=19 node=(0,0) type=0 shape=3,1 1-popBc=0.000e+00
maximum bond dimension = 4
----- TIMING FOR ctns::init_rbases : 5.811e-03 S -----

ctns::init_rsites qkind=qNSz thresh_ortho=1e-08
 idx=0 node=(19,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 deviate=0 TIMING=2.173e-05 S
 idx=1 node=(18,0)[1] shape(l,r,c)=(2,4,4) maxdiff=0.000e+00 deviate=0 TIMING=4.597e-05 S
 idx=2 node=(17,0)[1] shape(l,r,c)=(2,2,4) maxdiff=0.000e+00 deviate=0 TIMING=1.808e-05 S
 idx=3 node=(16,0)[1] shape(l,r,c)=(2,2,4) maxdiff=0.000e+00 deviate=0 TIMING=1.719e-05 S
 idx=4 node=(15,0)[1] shape(l,r,c)=(2,2,4) maxdiff=1.584e-16 deviate=0 TIMING=1.491e-05 S
 idx=5 node=(14,0)[1] shape(l,r,c)=(2,2,4) maxdiff=6.280e-16 deviate=0 TIMING=1.562e-05 S
 idx=6 node=(13,0)[1] shape(l,r,c)=(2,2,4) maxdiff=6.280e-16 deviate=0 TIMING=1.392e-05 S
 idx=7 node=(12,0)[1] shape(l,r,c)=(2,2,4) maxdiff=6.280e-16 deviate=0 TIMING=1.371e-05 S
 idx=8 node=(11,0)[1] shape(l,r,c)=(2,2,4) maxdiff=2.220e-16 deviate=0 TIMING=1.529e-05 S
 idx=9 node=(10,0)[1] shape(l,r,c)=(2,2,4) maxdiff=4.441e-16 deviate=0 TIMING=1.902e-05 S
 idx=10 node=(9,0)[1] shape(l,r,c)=(1,2,4) maxdiff=0.000e+00 deviate=0 TIMING=1.673e-05 S
 idx=11 node=(8,0)[1] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=1.498e-05 S
 idx=12 node=(7,0)[1] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=1.491e-05 S
 idx=13 node=(6,0)[1] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=1.493e-05 S
 idx=14 node=(5,0)[1] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=1.501e-05 S
 idx=15 node=(4,0)[1] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=1.563e-05 S
 idx=16 node=(3,0)[1] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=1.736e-05 S
 idx=17 node=(2,0)[1] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=1.546e-05 S
 idx=18 node=(1,0)[1] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=1.605e-05 S
 idx=19 node=(0,0)[0] shape(l,r,c)=(1,1,4) maxdiff=4.441e-16 deviate=0 TIMING=1.561e-05 S
----- TIMING FOR ctns::init_rsites : 7.342e-04 S -----

ctns::init_rwfuns qkind=qNSz thresh_ortho=1e-08
qtensor2: wf2 own=1 _data=0x3a99d628
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.63e-06MB

check state overlaps ...
matrix: ova_rwfuns size=(1,1)
      1.0000e+00 
matrix: ova0_vs size=(1,1)
      1.0000e+00 
diff of ova matrices = 0
----- TIMING FOR ctns::init_rwfuns : 1.626e-04 S -----

ctns::init_rcanon thresh_ortho=1e-08

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=3
matrix: <CI|CTNS[0]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[0]> size=(1,1)
      1.0000e+00 

rcanon::rcanon_canonicalize ifortho=1 ifab=1 nroots=1 dmax=4
----- TIMING FOR ctns::rcanon_canonicalize : 7.514e-03 S -----

matrix: <CTNS[new]|CTNS[new]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=3
matrix: <CI|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=2 node=(17,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=4 node=(15,0) Drow=2 maxdiff=8.453e-18 deviate=0
 idx=5 node=(14,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=6 node=(13,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=7 node=(12,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=8 node=(11,0) Drow=2 maxdiff=6.661e-16 deviate=0
 idx=9 node=(10,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=10 node=(9,0) Drow=1 maxdiff=2.220e-16 deviate=0
 idx=11 node=(8,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=12 node=(7,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=13 node=(6,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=14 node=(5,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=15 node=(4,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=16 node=(3,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=17 node=(2,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=18 node=(1,0) Drow=1 maxdiff=0.000e+00 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x3a99da78
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x3a99da78
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 3.808e-04 S -----
----- TIMING FOR ctns::rcanon_init : 2.993e-02 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci T(save)=0.00059S

ctns::rcanon_tosu2 twos=0 thresh_tosu2=1e-08
>>> idx=1
 qbond: ys nsym=2 dimAll=2
 (2,2):1 (3,1):1
 sigs2sum=1 diff(1-sigs2sum)=-2.2e-16
>>> idx=2
 qbond: ys nsym=2 dimAll=2
 (3,3):1 (4,2):1
 sigs2sum=1 diff(1-sigs2sum)=-2.2e-16
>>> idx=3
 qbond: ys nsym=2 dimAll=2
 (5,3):1 (6,2):1
 sigs2sum=1 diff(1-sigs2sum)=-2.2e-16
>>> idx=4
 qbond: ys nsym=1 dimAll=2
 (7,3):2
 sigs2sum=1 diff(1-sigs2sum)=-2.2e-16
>>> idx=5
 qbond: ys nsym=1 dimAll=2
 (9,3):2
 sigs2sum=1 diff(1-sigs2sum)=-2.2e-16
>>> idx=6
 qbond: ys nsym=1 dimAll=2
 (11,3):2
 sigs2sum=1 diff(1-sigs2sum)=-2.2e-16
>>> idx=7
 qbond: ys nsym=1 dimAll=2
 (13,3):2
 sigs2sum=1 diff(1-sigs2sum)=-2.2e-16
>>> idx=8
 qbond: ys nsym=3 dimAll=3
 (14,2):1 (14,4):1 (15,3):1
 sigs2sum=1 diff(1-sigs2sum)=0
>>> idx=9
 qbond: ys nsym=5 dimAll=5
 (15,1):1 (15,3):1 (15,5):1 (16,2):1 (16,4):1
 sigs2sum=1 diff(1-sigs2sum)=4.4e-16
>>> idx=10
 qbond: ys nsym=3 dimAll=3
 (17,1):1 (17,3):1 (17,5):1
 sigs2sum=1 diff(1-sigs2sum)=2.2e-16
>>> idx=11
 qbond: ys nsym=3 dimAll=3
 (19,1):1 (19,3):1 (19,5):1
 sigs2sum=1 diff(1-sigs2sum)=0
>>> idx=12
 qbond: ys nsym=3 dimAll=3
 (21,1):1 (21,3):1 (21,5):1
 sigs2sum=1 diff(1-sigs2sum)=0
>>> idx=13
 qbond: ys nsym=3 dimAll=3
 (22,2):1 (22,4):1 (22,6):1
 sigs2sum=1 diff(1-sigs2sum)=2.2e-16
>>> idx=14
 qbond: ys nsym=3 dimAll=3
 (23,3):1 (23,5):1 (23,7):1
 sigs2sum=1 diff(1-sigs2sum)=2.2e-16
>>> idx=15
 qbond: ys nsym=4 dimAll=4
 (24,2):1 (24,4):1 (24,6):1 (24,8):1
 sigs2sum=1 diff(1-sigs2sum)=6.7e-16
>>> idx=16
 qbond: ys nsym=5 dimAll=5
 (25,1):1 (25,3):1 (25,5):1 (25,7):1 (25,9):1
 sigs2sum=1 diff(1-sigs2sum)=6.7e-16
>>> idx=17
 qbond: ys nsym=6 dimAll=6
 (26,0):1 (26,2):1 (26,4):1 (26,6):1 (26,8):1 (26,10):1
 sigs2sum=1 diff(1-sigs2sum)=1.1e-15
>>> idx=18
 qbond: ys nsym=6 dimAll=6
 (28,0):1 (28,2):1 (28,4):1 (28,6):1 (28,8):1 (28,10):1
 sigs2sum=1 diff(1-sigs2sum)=1.2e-15
>>> idx=19
 qbond: ys nsym=6 dimAll=6
 (30,0):1 (30,2):1 (30,4):1 (30,6):1 (30,8):1 (30,10):1
 sigs2sum=1 diff(1-sigs2sum)=1.4e-15

ctns::updateRWFuns twos=0

### iroot=0 ###
> j=0 sym=(30,0,0) pop[j]=0.167 target sector!
matrix: rwfunW size=(1,1)
     -4.0825e-01 
> j=2 sym=(30,2,0) pop[j]=0.357
matrix: rwfunW size=(1,1)
      5.9761e-01 
> j=6 sym=(30,4,0) pop[j]=0.298
matrix: rwfunW size=(1,1)
     -5.4554e-01 
> j=12 sym=(30,6,0) pop[j]=0.139
matrix: rwfunW size=(1,1)
      3.7268e-01 
> j=20 sym=(30,8,0) pop[j]=0.0357
matrix: rwfunW size=(1,1)
     -1.8898e-01 
> j=30 sym=(30,10,0) pop[j]=0.00397
matrix: rwfunW size=(1,1)
     -6.2994e-02 
total pop=1 diff(1-pop)=1.443289932e-15

comb::display_shape qkind=qNSz
 idx=0 node=(19,0) shape(l,r,c)=(4,1,4)
 idx=1 node=(18,0) shape(l,r,c)=(2,4,4)
 idx=2 node=(17,0) shape(l,r,c)=(2,2,4)
 idx=3 node=(16,0) shape(l,r,c)=(2,2,4)
 idx=4 node=(15,0) shape(l,r,c)=(2,2,4)
 idx=5 node=(14,0) shape(l,r,c)=(2,2,4)
 idx=6 node=(13,0) shape(l,r,c)=(2,2,4)
 idx=7 node=(12,0) shape(l,r,c)=(2,2,4)
 idx=8 node=(11,0) shape(l,r,c)=(2,2,4)
 idx=9 node=(10,0) shape(l,r,c)=(2,2,4)
 idx=10 node=(9,0) shape(l,r,c)=(1,2,4)
 idx=11 node=(8,0) shape(l,r,c)=(1,1,4)
 idx=12 node=(7,0) shape(l,r,c)=(1,1,4)
 idx=13 node=(6,0) shape(l,r,c)=(1,1,4)
 idx=14 node=(5,0) shape(l,r,c)=(1,1,4)
 idx=15 node=(4,0) shape(l,r,c)=(1,1,4)
 idx=16 node=(3,0) shape(l,r,c)=(1,1,4)
 idx=17 node=(2,0) shape(l,r,c)=(1,1,4)
 idx=18 node=(1,0) shape(l,r,c)=(1,1,4)
 idx=19 node=(0,0) shape(l,r,c)=(1,1,4)
qtensor2: wf2 own=1 _data=0x3a99a210
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629394531e-06MB

comb::display_shape qkind=qNS
 idx=0 node=(19,0) shape(l,r,c)=(3,1,3) shapeU1(l,r,c)=(4,1,4)
 idx=1 node=(18,0) shape(l,r,c)=(2,3,3) shapeU1(l,r,c)=(5,4,4)
 idx=2 node=(17,0) shape(l,r,c)=(2,2,3) shapeU1(l,r,c)=(7,5,4)
 idx=3 node=(16,0) shape(l,r,c)=(2,2,3) shapeU1(l,r,c)=(7,7,4)
 idx=4 node=(15,0) shape(l,r,c)=(2,2,3) shapeU1(l,r,c)=(8,7,4)
 idx=5 node=(14,0) shape(l,r,c)=(2,2,3) shapeU1(l,r,c)=(8,8,4)
 idx=6 node=(13,0) shape(l,r,c)=(2,2,3) shapeU1(l,r,c)=(8,8,4)
 idx=7 node=(12,0) shape(l,r,c)=(2,2,3) shapeU1(l,r,c)=(8,8,4)
 idx=8 node=(11,0) shape(l,r,c)=(3,2,3) shapeU1(l,r,c)=(12,8,4)
 idx=9 node=(10,0) shape(l,r,c)=(5,3,3) shapeU1(l,r,c)=(20,12,4)
 idx=10 node=(9,0) shape(l,r,c)=(3,5,3) shapeU1(l,r,c)=(12,20,4)
 idx=11 node=(8,0) shape(l,r,c)=(3,3,3) shapeU1(l,r,c)=(12,12,4)
 idx=12 node=(7,0) shape(l,r,c)=(3,3,3) shapeU1(l,r,c)=(12,12,4)
 idx=13 node=(6,0) shape(l,r,c)=(3,3,3) shapeU1(l,r,c)=(15,12,4)
 idx=14 node=(5,0) shape(l,r,c)=(3,3,3) shapeU1(l,r,c)=(18,15,4)
 idx=15 node=(4,0) shape(l,r,c)=(4,3,3) shapeU1(l,r,c)=(24,18,4)
 idx=16 node=(3,0) shape(l,r,c)=(5,4,3) shapeU1(l,r,c)=(30,24,4)
 idx=17 node=(2,0) shape(l,r,c)=(6,5,3) shapeU1(l,r,c)=(36,30,4)
 idx=18 node=(1,0) shape(l,r,c)=(6,6,3) shapeU1(l,r,c)=(36,36,4)
 idx=19 node=(0,0) shape(l,r,c)=(6,6,3) shapeU1(l,r,c)=(36,36,4)
qtensor2: wf2 own=1 _data=0x3a99a1b8
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=6 dimAll=6
 (30,0):1 (30,2):1 (30,4):1 (30,6):1 (30,8):1 (30,10):1
total no. of nonzero blocks=1 nblocks=6 size=1:7.629394531e-06MB

Summary of sweep projection: nroot[nonsu2]=1 => nstate[su2]=1
----- TIMING FOR ctns::rcanon_tosu2 : 5.543e-02 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci_su2 T(save)=0.00044S

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=2 node=(17,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=4 node=(15,0) Drow=2 maxdiff=8.453e-18 deviate=0
 idx=5 node=(14,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=6 node=(13,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=7 node=(12,0) Drow=2 maxdiff=0.000e+00 deviate=0
 idx=8 node=(11,0) Drow=3 maxdiff=2.220e-16 deviate=0
 idx=9 node=(10,0) Drow=5 maxdiff=2.220e-16 deviate=0
 idx=10 node=(9,0) Drow=3 maxdiff=1.110e-16 deviate=0
 idx=11 node=(8,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=12 node=(7,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=13 node=(6,0) Drow=3 maxdiff=2.220e-16 deviate=0
 idx=14 node=(5,0) Drow=3 maxdiff=1.110e-16 deviate=0
 idx=15 node=(4,0) Drow=4 maxdiff=2.220e-16 deviate=0
 idx=16 node=(3,0) Drow=5 maxdiff=2.220e-16 deviate=0
 idx=17 node=(2,0) Drow=6 maxdiff=2.220e-16 deviate=0
 idx=18 node=(1,0) Drow=6 maxdiff=0.000e+00 deviate=0
 idx=19 node=(0,0) Drow=6 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x3a99d5a8
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=6 dimAll=6
 (30,0):1 (30,2):1 (30,4):1 (30,6):1 (30,8):1 (30,10):1
total no. of nonzero blocks=1 nblocks=6 size=1:7.629e-06MB
i=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x3a99d5a8
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 1.736e-03 S -----
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.001e+00 pageheap_free=6.048e-02 change=1.540e-04 heap=1.068e+00 avail=4.761e+02 total=5.033e+02 

integral::load fname = moleinfo/fmole.info
 sorb = 40
 size(int1e) = 1600:1.221e-02MB:1.192e-05GB
 size(int2e) = 305370:2.330e+00MB:2.275e-03GB
 ecore = 0.000000000000
----- TIMING FOR integral::load : 9.678e-02 S -----

io::remove_scratch scratch=./scratch/sweep
successfully removed ./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=qNS
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=5.813e-02 change=2.312e-03 heap=1.068e+00 avail=4.761e+02 total=5.033e+02 
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(19,0) size=7.614e-03MB:7.436e-06GB
fname=./scratch/sweep/cop(19,0) size=7.44e-06GB T[save](info/data/tot)=0.000113,5.69e-05,0.00017 speed=0.0437GB/S disk[used]=7.7e-06GB
ctns::oper_save iomode=0 fname=./scratch/sweep/rop(19,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/rop(19,0) size=7.44e-06GB T[save](info/data/tot)=9.24e-05,4.57e-05,0.000138 speed=0.0538GB/S disk[used]=1.54e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(18,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(18,0) size=7.44e-06GB T[save](info/data/tot)=8.91e-05,4.2e-05,0.000131 speed=0.0567GB/S disk[used]=2.31e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(17,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(17,0) size=7.44e-06GB T[save](info/data/tot)=8.69e-05,4.94e-05,0.000136 speed=0.0545GB/S disk[used]=3.08e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(16,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(16,0) size=7.44e-06GB T[save](info/data/tot)=8.18e-05,4.28e-05,0.000125 speed=0.0597GB/S disk[used]=3.85e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(15,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(15,0) size=7.44e-06GB T[save](info/data/tot)=0.000117,4.23e-05,0.000159 speed=0.0467GB/S disk[used]=4.62e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(14,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(14,0) size=7.44e-06GB T[save](info/data/tot)=8.33e-05,4.12e-05,0.000124 speed=0.0597GB/S disk[used]=5.39e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(13,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(13,0) size=7.44e-06GB T[save](info/data/tot)=8.49e-05,4.08e-05,0.000126 speed=0.0592GB/S disk[used]=6.16e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(12,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(12,0) size=7.44e-06GB T[save](info/data/tot)=8.26e-05,4.04e-05,0.000123 speed=0.0604GB/S disk[used]=6.93e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(11,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(11,0) size=7.44e-06GB T[save](info/data/tot)=8.37e-05,4e-05,0.000124 speed=0.0601GB/S disk[used]=7.7e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(10,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(10,0) size=7.44e-06GB T[save](info/data/tot)=8.1e-05,3.93e-05,0.00012 speed=0.0618GB/S disk[used]=8.47e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(9,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(9,0) size=7.44e-06GB T[save](info/data/tot)=8.55e-05,3.82e-05,0.000124 speed=0.0601GB/S disk[used]=9.24e-05GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(8,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(8,0) size=7.44e-06GB T[save](info/data/tot)=8.26e-05,3.65e-05,0.000119 speed=0.0624GB/S disk[used]=0.0001GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(7,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(7,0) size=7.44e-06GB T[save](info/data/tot)=8.33e-05,4.16e-05,0.000125 speed=0.0595GB/S disk[used]=0.000108GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(6,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(6,0) size=7.44e-06GB T[save](info/data/tot)=8.81e-05,3.84e-05,0.000126 speed=0.0588GB/S disk[used]=0.000115GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(5,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(5,0) size=7.44e-06GB T[save](info/data/tot)=0.000103,3.96e-05,0.000143 speed=0.0521GB/S disk[used]=0.000123GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(4,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(4,0) size=7.44e-06GB T[save](info/data/tot)=8.35e-05,3.94e-05,0.000123 speed=0.0605GB/S disk[used]=0.000131GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(3,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(3,0) size=7.44e-06GB T[save](info/data/tot)=8.7e-05,4.01e-05,0.000127 speed=0.0585GB/S disk[used]=0.000139GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(2,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(2,0) size=7.44e-06GB T[save](info/data/tot)=8.45e-05,4.09e-05,0.000125 speed=0.0593GB/S disk[used]=0.000146GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(1,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(1,0) size=7.44e-06GB T[save](info/data/tot)=8.38e-05,3.92e-05,0.000123 speed=0.0604GB/S disk[used]=0.000154GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(0,0) size=0.00761MB:7.44e-06GB
fname=./scratch/sweep/cop(0,0) size=7.44e-06GB T[save](info/data/tot)=8.4e-05,4.14e-05,0.000125 speed=0.0593GB/S disk[used]=0.000162GB
----- TIMING FOR ctns::oper_init_dotCR : 1.883e-01 S -----
T[ctns::oper_init_dotCR](comp/save/tot)=0.166,0.00455,0.171

idx=1 coord=(18,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=5.776e-02 change=1.192e-07 heap=1.068e+00 avail=4.761e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
ctns::oper_renorm coord=(18,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:2 S:9 A:1 B:4 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=21:0.00016MB:1.56e-07GB
        per(mem): H:9.52 C:9.52 S:42.9 A:0 B:38.1 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=5.703e-02 change=1.603e-03 heap=1.068e+00 avail=4.761e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=8 : 1.531e-04 S -----
rank=0 GPUmem(GB): used=1.503e-05 (oper)=1.503e-05
rank=0 GPUmem(GB): used=1.505e-05 (oper,site)=1.503e-05,2.235e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=8
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=1.505e-05 (oper,site,rinter)=1.503e-05,2.235e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 2.709e-04 S size(rtasks)=8 size(Rlst2)=4 T(Rmu/Rlist)=3.344e-05,2.374e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.877e-04 S size(rtasks)=8 size(Rlst)=23 -----
rank=0 GPUmem(GB): used=1.505e-05 avail=6.235e+00 total=6.235e+00 batch[need]=5.141e-07 blksize=1 blksize0=0 batchsize=23
rank=0 GPUmem(GB): used=1.556e-05 (oper,site,rinter,batch)=1.503e-05,2.235e-08,0.000e+00,5.141e-07
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.961e-03,2.283e-02,1.020e-02
----- TIMING FOR renorm : t_inter=2.0e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.5e-02 -----
 renorm[inter] counter=1 t=2.0e-03 per=5.6e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=3.4e-06 per=9.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=1.4e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=7.7e-03 per=2.2e+01 cost=1.2e+01 flops=1.6e+03
 renorm[gemm] counter=1 i=3 t=7.6e-03 per=2.2e+01 cost=2.0e+01 flops=2.6e+03
 renorm[gemm] counter=1 i=4 t=1.2e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=5 t=1.1e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=6 t=7.5e-03 per=2.2e+01 cost=4.6e+01 flops=6.1e+03
 renorm[gemm] counter=1 total t=2.3e-02 per=6.5e+01 cost=7.8e+01 flops=3.4e+03
 renorm[red] counter=1 t=1.0e-02 per=2.9e+01 cost=4.6e+01 flops=4.5e+03
----- TIMING FOR renorm_tot : t_inter=2.0e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.5e-02 -----
 renorm_tot[inter] counter=1 t=2.0e-03 per=5.6e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=3.4e-06 per=9.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=1.4e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=7.7e-03 per=2.2e+01 cost=1.2e+01 flops=1.6e+03
 renorm_tot[gemm] counter=1 i=3 t=7.6e-03 per=2.2e+01 cost=2.0e+01 flops=2.6e+03
 renorm_tot[gemm] counter=1 i=4 t=1.2e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=5 t=1.1e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=6 t=7.5e-03 per=2.2e+01 cost=4.6e+01 flops=6.1e+03
 renorm_tot[gemm] counter=1 total t=2.3e-02 per=6.5e+01 cost=7.8e+01 flops=3.4e+03
 renorm_tot[red] counter=1 t=1.0e-02 per=2.9e+01 cost=4.6e+01 flops=4.5e+03
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.504e-05 (optmp,oper)=7.451e-09,1.503e-05
rank=0 GPUmem(GB): used=1.506e-05 (optmp,oper,site,rinter)=7.451e-09,1.503e-05,2.235e-08,0.000e+00
rank=0 GPUmem(GB): used=1.519e-05 (optmp,oper,site,rinter,batch)=7.451e-09,1.503e-05,2.235e-08,0.000e+00,1.341e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 5.675e-01 S T(prep/alloc/comp/red/dealloc)=1.420e-03,2.199e-03,4.492e-01,1.135e-01,2.485e-03 -----
----- TIMING FOR oper_renorm_opS : 5.676e-01 S rank=0 -----
qops.to_cpu: size(tot)=21:1.602e-04MB:1.565e-07GB T(to_cpu)=5.147e-05S speed=3.040e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(18,0) rank=0
----- TIMING FOR oper_renorm : 0.608 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=5.687e-02 change=8.096e-05 heap=1.068e+00 avail=4.761e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=5.711e-02 change=-1.599e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=2.980e-08 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 6.288e-01 S #####
 T(local oper_env: fetch) = 1.812e-02 S  per = 2.88  per(accum) = 2.88
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.88
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.88
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.88
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.88
 T(local oper_env: renrm) = 6.106e-01 S  per = 97.1  per(accum) = 100
 T(local oper_env: save ) = 1.341e-04 S  per = 0.0213  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.106e-01 S  T(sum) = 6.106e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.490e-05 S  per = 0.00244  per(accum) = 0.00244
 T(local oper_env: qops init                    ) = 2.719e-04 S  per = 0.0445  per(accum) = 0.047
 T(local oper_env: symbolic_formulae_renorm     ) = 1.658e-04 S  per = 0.0272  per(accum) = 0.0741
 T(local oper_env: allocate qops on gpu         ) = 7.459e-05 S  per = 0.0122  per(accum) = 0.0863
 T(local oper_env: site memcpy cpu2gpu          ) = 1.969e-03 S  per = 0.322  per(accum) = 0.409
 T(local oper_env: rintermediate init           ) = 2.932e-05 S  per = 0.0048  per(accum) = 0.414
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.940e-04 S  per = 0.0482  per(accum) = 0.462
 T(local oper_env: rmmtasks init                ) = 2.185e-04 S  per = 0.0358  per(accum) = 0.498
 T(local oper_env: qops memset on cpu           ) = 3.800e-08 S  per = 6.22e-06  per(accum) = 0.498
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.515e-02 S  per = 5.76  per(accum) = 6.25
 T(local oper_env: deallocate cpu and gpu memory) = 2.778e-05 S  per = 0.00455  per(accum) = 6.26
 T(local oper_env: construct opS [ifdists=true] ) = 5.676e-01 S  per =   93  per(accum) = 99.2
 T(local oper_env: reduction of opS & opH [nccl]) = 2.290e-03 S  per = 0.375  per(accum) = 99.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 6.351e-05 S  per = 0.0104  per(accum) = 99.6
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.599e-05 S  per = 0.00426  per(accum) = 99.6
 T(local oper_env: qops_pool join and erase     ) = 2.314e-03 S  per = 0.379  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.010e-07 S  per = 0.000115  per(accum) = 100
##### sweep oper_env: 6.288e-01 S #####
 T(sweep oper_env: fetch) = 1.812e-02 S  per = 2.88  per(accum) = 2.88
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.88
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.88
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.88
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.88
 T(sweep oper_env: renrm) = 6.106e-01 S  per = 97.1  per(accum) = 100
 T(sweep oper_env: save ) = 1.341e-04 S  per = 0.0213  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(sweep oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.106e-01 S  T(sum) = 6.106e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.490e-05 S  per = 0.00244  per(accum) = 0.00244
 T(sweep oper_env: qops init                    ) = 2.719e-04 S  per = 0.0445  per(accum) = 0.047
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.658e-04 S  per = 0.0272  per(accum) = 0.0741
 T(sweep oper_env: allocate qops on gpu         ) = 7.459e-05 S  per = 0.0122  per(accum) = 0.0863
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.969e-03 S  per = 0.322  per(accum) = 0.409
 T(sweep oper_env: rintermediate init           ) = 2.932e-05 S  per = 0.0048  per(accum) = 0.414
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.940e-04 S  per = 0.0482  per(accum) = 0.462
 T(sweep oper_env: rmmtasks init                ) = 2.185e-04 S  per = 0.0358  per(accum) = 0.498
 T(sweep oper_env: qops memset on cpu           ) = 3.800e-08 S  per = 6.22e-06  per(accum) = 0.498
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.515e-02 S  per = 5.76  per(accum) = 6.25
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.778e-05 S  per = 0.00455  per(accum) = 6.26
 T(sweep oper_env: construct opS [ifdists=true] ) = 5.676e-01 S  per =   93  per(accum) = 99.2
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.290e-03 S  per = 0.375  per(accum) = 99.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 6.351e-05 S  per = 0.0104  per(accum) = 99.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.599e-05 S  per = 0.00426  per(accum) = 99.6
 T(sweep oper_env: qops_pool join and erase     ) = 2.314e-03 S  per = 0.379  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 7.010e-07 S  per = 0.000115  per(accum) = 100

idx=2 coord=(17,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:2 S:9 A:1 B:4 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=21:0.00016MB:1.56e-07GB
        per(mem): H:9.52 C:9.52 S:42.9 A:0 B:38.1 
ctns::oper_renorm coord=(17,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:3 S:8 A:4 B:7 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=27:0.000206MB:2.01e-07GB
        per(mem): H:7.41 C:11.1 S:29.6 A:0 B:51.9 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=8.119e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=15 : 1.540e-04 S -----
rank=0 GPUmem(GB): used=7.793e-06 (oper)=7.793e-06
rank=0 GPUmem(GB): used=7.816e-06 (oper,site)=7.793e-06,2.235e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=15
 no. of rintermediate operators=4
 no. of coefficients=8:6.104e-05MB:5.960e-08GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.512e-03 S -----
rank=0 GPUmem(GB): used=7.875e-06 (oper,site,rinter)=7.793e-06,2.235e-08,5.960e-08
----- TIMING FOR preprocess_formulae_Rlist2 : 5.170e-04 S size(rtasks)=15 size(Rlst2)=4 T(Rmu/Rlist)=4.828e-05,4.687e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.359e-04 S size(rtasks)=15 size(Rlst)=56 -----
rank=0 GPUmem(GB): used=7.875e-06 avail=6.231e+00 total=6.231e+00 batch[need]=1.669e-06 blksize=1 blksize0=1 batchsize=56
rank=0 GPUmem(GB): used=9.544e-06 (oper,site,rinter,batch)=7.793e-06,2.235e-08,5.960e-08,1.669e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.091e-03,2.271e-02,9.996e-03
----- TIMING FOR renorm : t_inter=9.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.2e-02 -----
 renorm[inter] counter=18 t=9.1e-03 per=2.2e+01 cost=8.0e+01 flops=8.8e+03
 renorm[gemm] counter=18 i=0 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=2 t=7.5e-03 per=1.8e+01 cost=3.4e+01 flops=4.5e+03
 renorm[gemm] counter=18 i=3 t=7.6e-03 per=1.8e+01 cost=5.8e+01 flops=7.6e+03
 renorm[gemm] counter=18 i=4 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=5 t=1.2e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=18 i=6 t=7.6e-03 per=1.8e+01 cost=1.1e+02 flops=1.5e+04
 renorm[gemm] counter=18 total t=2.3e-02 per=5.4e+01 cost=2.0e+02 flops=9.0e+03
 renorm[red] counter=18 t=1.0e-02 per=2.4e+01 cost=1.1e+02 flops=1.1e+04
----- TIMING FOR renorm_tot : t_inter=1.1e-02 t_gemm=4.6e-02 t_reduction=2.0e-02 tot=7.7e-02 -----
 renorm_tot[inter] counter=18 t=1.1e-02 per=1.4e+01 cost=8.0e+01 flops=7.2e+03
 renorm_tot[gemm] counter=18 i=0 t=4.7e-06 per=6.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=1 t=2.7e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=2 t=1.5e-02 per=2.0e+01 cost=4.6e+01 flops=3.0e+03
 renorm_tot[gemm] counter=18 i=3 t=1.5e-02 per=2.0e+01 cost=7.8e+01 flops=5.1e+03
 renorm_tot[gemm] counter=18 i=4 t=2.5e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=5 t=2.3e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=18 i=6 t=1.5e-02 per=2.0e+01 cost=1.6e+02 flops=1.0e+04
 renorm_tot[gemm] counter=18 total t=4.6e-02 per=5.9e+01 cost=2.8e+02 flops=6.2e+03
 renorm_tot[red] counter=18 t=2.0e-02 per=2.6e+01 cost=1.6e+02 flops=7.8e+03
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=9.231e-06 (optmp,oper)=7.451e-09,7.793e-06
rank=0 GPUmem(GB): used=9.254e-06 (optmp,oper,site,rinter)=7.451e-09,7.793e-06,2.235e-08,1.371e-06
rank=0 GPUmem(GB): used=9.492e-06 (optmp,oper,site,rinter,batch)=7.451e-09,7.793e-06,2.235e-08,1.371e-06,2.384e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 7.925e-01 S T(prep/alloc/comp/red/dealloc)=3.992e-02,4.341e-02,6.679e-01,7.862e-02,2.565e-03 -----
----- TIMING FOR oper_renorm_opS : 7.926e-01 S rank=0 -----
qops.to_cpu: size(tot)=27:2.060e-04MB:2.012e-07GB T(to_cpu)=4.945e-05S speed=4.068e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.842 S rank=0 -----
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=7.629e-06 change=2.842e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=7.629e-06 change=-8.320e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 8.512e-01 S #####
 T(local oper_env: fetch) = 8.313e-03 S  per = 0.977  per(accum) = 0.977
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 0.977
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 0.977
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 0.977
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 0.977
 T(local oper_env: renrm) = 8.428e-01 S  per =   99  per(accum) = 100
 T(local oper_env: save ) = 1.219e-04 S  per = 0.0143  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.428e-01 S  T(sum) = 8.428e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.168e-05 S  per = 0.00139  per(accum) = 0.00139
 T(local oper_env: qops init                    ) = 3.114e-04 S  per = 0.0369  per(accum) = 0.0383
 T(local oper_env: symbolic_formulae_renorm     ) = 1.658e-04 S  per = 0.0197  per(accum) = 0.058
 T(local oper_env: allocate qops on gpu         ) = 8.406e-05 S  per = 0.00997  per(accum) = 0.068
 T(local oper_env: site memcpy cpu2gpu          ) = 6.338e-04 S  per = 0.0752  per(accum) = 0.143
 T(local oper_env: rintermediate init           ) = 2.526e-03 S  per =  0.3  per(accum) = 0.443
 T(local oper_env: preprocess_formulae_Rlist2   ) = 5.426e-04 S  per = 0.0644  per(accum) = 0.507
 T(local oper_env: rmmtasks init                ) = 3.413e-04 S  per = 0.0405  per(accum) = 0.548
 T(local oper_env: qops memset on cpu           ) = 4.000e-08 S  per = 4.75e-06  per(accum) = 0.548
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.196e-02 S  per = 4.98  per(accum) = 5.53
 T(local oper_env: deallocate cpu and gpu memory) = 2.659e-05 S  per = 0.00315  per(accum) = 5.53
 T(local oper_env: construct opS [ifdists=true] ) = 7.927e-01 S  per = 94.1  per(accum) = 99.6
 T(local oper_env: reduction of opS & opH [nccl]) = 2.260e-03 S  per = 0.268  per(accum) = 99.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 6.175e-05 S  per = 0.00733  per(accum) = 99.9
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.382e-05 S  per = 0.00283  per(accum) = 99.9
 T(local oper_env: qops_pool join and erase     ) = 1.129e-03 S  per = 0.134  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.930e-07 S  per = 8.22e-05  per(accum) = 100
##### sweep oper_env: 1.480e+00 S #####
 T(sweep oper_env: fetch) = 2.643e-02 S  per = 1.79  per(accum) = 1.79
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 1.79
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 1.79
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 1.79
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 1.79
 T(sweep oper_env: renrm) = 1.453e+00 S  per = 98.2  per(accum) = 100
 T(sweep oper_env: save ) = 2.560e-04 S  per = 0.0173  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.473e+09 S  per = -3.473e+31
 T(sweep oper_env: preprocess                  ) = -3.473e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.453e+00 S  T(sum) = 1.453e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.658e-05 S  per = 0.00183  per(accum) = 0.00183
 T(sweep oper_env: qops init                    ) = 5.834e-04 S  per = 0.0401  per(accum) = 0.042
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.316e-04 S  per = 0.0228  per(accum) = 0.0648
 T(sweep oper_env: allocate qops on gpu         ) = 1.587e-04 S  per = 0.0109  per(accum) = 0.0757
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.603e-03 S  per = 0.179  per(accum) = 0.255
 T(sweep oper_env: rintermediate init           ) = 2.555e-03 S  per = 0.176  per(accum) = 0.431
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 8.366e-04 S  per = 0.0576  per(accum) = 0.488
 T(sweep oper_env: rmmtasks init                ) = 5.598e-04 S  per = 0.0385  per(accum) = 0.527
 T(sweep oper_env: qops memset on cpu           ) = 7.800e-08 S  per = 5.37e-06  per(accum) = 0.527
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 7.711e-02 S  per = 5.31  per(accum) = 5.83
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.437e-05 S  per = 0.00374  per(accum) = 5.84
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.360e+00 S  per = 93.6  per(accum) = 99.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.550e-03 S  per = 0.313  per(accum) = 99.8
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.253e-04 S  per = 0.00862  per(accum) = 99.8
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 4.981e-05 S  per = 0.00343  per(accum) = 99.8
 T(sweep oper_env: qops_pool join and erase     ) = 3.444e-03 S  per = 0.237  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.394e-06 S  per = 9.59e-05  per(accum) = 100

idx=3 coord=(16,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:3 S:8 A:4 B:7 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=27:0.000206MB:2.01e-07GB
        per(mem): H:7.41 C:11.1 S:29.6 A:0 B:51.9 
ctns::oper_renorm coord=(16,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:4 S:8 A:8 B:10 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=34:0.000259MB:2.53e-07GB
        per(mem): H:5.88 C:11.8 S:23.5 A:0 B:58.8 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=8.171e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=23 : 2.057e-04 S -----
rank=0 GPUmem(GB): used=7.890e-06 (oper)=7.890e-06
rank=0 GPUmem(GB): used=7.913e-06 (oper,site)=7.890e-06,2.235e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=23
 no. of rintermediate operators=5
 no. of coefficients=17:1.297e-04MB:1.267e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.449e-03 S -----
rank=0 GPUmem(GB): used=8.039e-06 (oper,site,rinter)=7.890e-06,2.235e-08,1.267e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 5.389e-04 S size(rtasks)=23 size(Rlst2)=4 T(Rmu/Rlist)=6.401e-05,4.749e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.643e-04 S size(rtasks)=23 size(Rlst)=60 -----
rank=0 GPUmem(GB): used=8.039e-06 avail=6.231e+00 total=6.231e+00 batch[need]=1.788e-06 blksize=1 blksize0=1 batchsize=60
rank=0 GPUmem(GB): used=9.827e-06 (oper,site,rinter,batch)=7.890e-06,2.235e-08,1.267e-07,1.788e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=2.573e-03,4.683e-03,8.259e-05
----- TIMING FOR renorm : t_inter=2.6e-03 t_gemm=4.7e-03 t_reduction=8.2e-05 tot=7.3e-03 -----
 renorm[inter] counter=36 t=2.6e-03 per=3.5e+01 cost=1.2e+02 flops=4.7e+04
 renorm[gemm] counter=36 i=0 t=1.4e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=1 t=1.2e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=2 t=2.5e-03 per=3.4e+01 cost=3.0e+01 flops=1.2e+04
 renorm[gemm] counter=36 i=3 t=1.1e-03 per=1.6e+01 cost=7.4e+01 flops=6.5e+04
 renorm[gemm] counter=36 i=4 t=1.2e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=5 t=1.1e-06 per=1.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=36 i=6 t=1.1e-03 per=1.5e+01 cost=1.2e+02 flops=1.1e+05
 renorm[gemm] counter=36 total t=4.7e-03 per=6.4e+01 cost=2.2e+02 flops=4.8e+04
 renorm[red] counter=36 t=8.2e-05 per=1.1e+00 cost=1.2e+02 flops=1.5e+06
----- TIMING FOR renorm_tot : t_inter=1.4e-02 t_gemm=5.0e-02 t_reduction=2.0e-02 tot=8.4e-02 -----
 renorm_tot[inter] counter=36 t=1.4e-02 per=1.6e+01 cost=2.0e+02 flops=1.5e+04
 renorm_tot[gemm] counter=36 i=0 t=6.1e-06 per=7.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=1 t=3.9e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=2 t=1.8e-02 per=2.1e+01 cost=7.6e+01 flops=4.3e+03
 renorm_tot[gemm] counter=36 i=3 t=1.6e-02 per=1.9e+01 cost=1.5e+02 flops=9.3e+03
 renorm_tot[gemm] counter=36 i=4 t=3.6e-06 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=5 t=3.4e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=36 i=6 t=1.6e-02 per=1.9e+01 cost=2.8e+02 flops=1.7e+04
 renorm_tot[gemm] counter=36 total t=5.0e-02 per=6.0e+01 cost=5.1e+02 flops=1.0e+04
 renorm_tot[red] counter=36 t=2.0e-02 per=2.4e+01 cost=2.8e+02 flops=1.4e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.059e-05 (optmp,oper)=7.451e-09,7.890e-06
rank=0 GPUmem(GB): used=1.061e-05 (optmp,oper,site,rinter)=7.451e-09,7.890e-06,2.235e-08,2.563e-06
rank=0 GPUmem(GB): used=1.082e-05 (optmp,oper,site,rinter,batch)=7.451e-09,7.890e-06,2.235e-08,2.563e-06,2.086e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 7.081e-01 S T(prep/alloc/comp/red/dealloc)=1.954e-02,2.286e-02,6.425e-01,4.016e-02,2.527e-03 -----
----- TIMING FOR oper_renorm_opS : 7.082e-01 S rank=0 -----
qops.to_cpu: size(tot)=34:2.594e-04MB:2.533e-07GB T(to_cpu)=5.733e-05S speed=4.419e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.722 S rank=0 -----
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=3.424e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-8.416e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 7.318e-01 S #####
 T(local oper_env: fetch) = 8.087e-03 S  per = 1.11  per(accum) = 1.11
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 1.11
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 1.11
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 1.11
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 1.11
 T(local oper_env: renrm) = 7.236e-01 S  per = 98.9  per(accum) = 100
 T(local oper_env: save ) = 1.218e-04 S  per = 0.0166  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.236e-01 S  T(sum) = 7.236e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.431e-06 S  per = 0.0013  per(accum) = 0.0013
 T(local oper_env: qops init                    ) = 3.674e-04 S  per = 0.0508  per(accum) = 0.0521
 T(local oper_env: symbolic_formulae_renorm     ) = 2.170e-04 S  per = 0.03  per(accum) = 0.0821
 T(local oper_env: allocate qops on gpu         ) = 6.923e-05 S  per = 0.00957  per(accum) = 0.0916
 T(local oper_env: site memcpy cpu2gpu          ) = 2.047e-04 S  per = 0.0283  per(accum) = 0.12
 T(local oper_env: rintermediate init           ) = 2.464e-03 S  per = 0.34  per(accum) = 0.46
 T(local oper_env: preprocess_formulae_Rlist2   ) = 5.720e-04 S  per = 0.0791  per(accum) = 0.539
 T(local oper_env: rmmtasks init                ) = 4.054e-04 S  per = 0.056  per(accum) = 0.595
 T(local oper_env: qops memset on cpu           ) = 3.000e-08 S  per = 4.15e-06  per(accum) = 0.595
 T(local oper_env: preprocess_renorm_batchGPU   ) = 7.541e-03 S  per = 1.04  per(accum) = 1.64
 T(local oper_env: deallocate cpu and gpu memory) = 2.104e-05 S  per = 0.00291  per(accum) = 1.64
 T(local oper_env: construct opS [ifdists=true] ) = 7.082e-01 S  per = 97.9  per(accum) = 99.5
 T(local oper_env: reduction of opS & opH [nccl]) = 2.284e-03 S  per = 0.316  per(accum) = 99.8
 T(local oper_env: qops memcpy gpu2cpu          ) = 6.874e-05 S  per = 0.0095  per(accum) = 99.8
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.682e-05 S  per = 0.00371  per(accum) = 99.9
 T(local oper_env: qops_pool join and erase     ) = 1.073e-03 S  per = 0.148  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.520e-07 S  per = 9.01e-05  per(accum) = 100
##### sweep oper_env: 2.212e+00 S #####
 T(sweep oper_env: fetch) = 3.452e-02 S  per = 1.56  per(accum) = 1.56
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 1.56
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 1.56
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 1.56
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 1.56
 T(sweep oper_env: renrm) = 2.177e+00 S  per = 98.4  per(accum) = 100
 T(sweep oper_env: save ) = 3.778e-04 S  per = 0.0171  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -5.210e+09 S  per = -5.210e+31
 T(sweep oper_env: preprocess                  ) = -5.210e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.177e+00 S  T(sum) = 2.177e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 3.601e-05 S  per = 0.00165  per(accum) = 0.00165
 T(sweep oper_env: qops init                    ) = 9.507e-04 S  per = 0.0437  per(accum) = 0.0453
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.487e-04 S  per = 0.0252  per(accum) = 0.0705
 T(sweep oper_env: allocate qops on gpu         ) = 2.279e-04 S  per = 0.0105  per(accum) = 0.081
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.807e-03 S  per = 0.129  per(accum) = 0.21
 T(sweep oper_env: rintermediate init           ) = 5.019e-03 S  per = 0.231  per(accum) = 0.44
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.409e-03 S  per = 0.0647  per(accum) = 0.505
 T(sweep oper_env: rmmtasks init                ) = 9.651e-04 S  per = 0.0443  per(accum) = 0.55
 T(sweep oper_env: qops memset on cpu           ) = 1.080e-07 S  per = 4.96e-06  per(accum) = 0.55
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 8.465e-02 S  per = 3.89  per(accum) = 4.44
 T(sweep oper_env: deallocate cpu and gpu memory) = 7.541e-05 S  per = 0.00346  per(accum) = 4.44
 T(sweep oper_env: construct opS [ifdists=true] ) = 2.069e+00 S  per =   95  per(accum) = 99.5
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.834e-03 S  per = 0.314  per(accum) = 99.8
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.940e-04 S  per = 0.00891  per(accum) = 99.8
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 7.663e-05 S  per = 0.00352  per(accum) = 99.8
 T(sweep oper_env: qops_pool join and erase     ) = 4.517e-03 S  per = 0.208  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.046e-06 S  per = 9.4e-05  per(accum) = 100

idx=4 coord=(15,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:4 S:8 A:8 B:10 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=34:0.000259MB:2.53e-07GB
        per(mem): H:5.88 C:11.8 S:23.5 A:0 B:58.8 
ctns::oper_renorm coord=(15,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:5 S:7 A:12 B:16 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=68:0.000519MB:5.07e-07GB
        per(mem): H:5.88 C:0 S:0 A:0 B:94.1 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=8.145e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=34 : 2.800e-04 S -----
rank=0 GPUmem(GB): used=8.196e-06 (oper)=8.196e-06
rank=0 GPUmem(GB): used=8.225e-06 (oper,site)=8.196e-06,2.980e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=34
 no. of rintermediate operators=5
 no. of coefficients=25:1.907e-04MB:1.863e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.493e-03 S -----
rank=0 GPUmem(GB): used=8.412e-06 (oper,site,rinter)=8.196e-06,2.980e-08,1.863e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 5.122e-04 S size(rtasks)=34 size(Rlst2)=1 T(Rmu/Rlist)=8.338e-05,4.288e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.299e-04 S size(rtasks)=34 size(Rlst)=53 -----
rank=0 GPUmem(GB): used=8.412e-06 avail=6.231e+00 total=6.231e+00 batch[need]=3.949e-06 blksize=4 blksize0=1 batchsize=53
rank=0 GPUmem(GB): used=1.236e-05 (oper,site,rinter,batch)=8.196e-06,2.980e-08,1.863e-07,3.949e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.123e-03,2.256e-02,1.004e-02
----- TIMING FOR renorm : t_inter=9.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.2e-02 -----
 renorm[inter] counter=53 t=9.1e-03 per=2.2e+01 cost=1.2e+02 flops=1.3e+04
 renorm[gemm] counter=53 i=0 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=53 i=1 t=1.2e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=53 i=2 t=7.5e-03 per=1.8e+01 cost=6.0e+01 flops=8.0e+03
 renorm[gemm] counter=53 i=3 t=7.5e-03 per=1.8e+01 cost=1.2e+02 flops=1.6e+04
 renorm[gemm] counter=53 i=4 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=53 i=5 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=53 i=6 t=7.5e-03 per=1.8e+01 cost=4.2e+02 flops=5.6e+04
 renorm[gemm] counter=53 total t=2.3e-02 per=5.4e+01 cost=6.1e+02 flops=2.7e+04
 renorm[red] counter=53 t=1.0e-02 per=2.4e+01 cost=4.2e+02 flops=4.2e+04
----- TIMING FOR renorm_tot : t_inter=2.3e-02 t_gemm=7.3e-02 t_reduction=3.0e-02 tot=1.3e-01 -----
 renorm_tot[inter] counter=53 t=2.3e-02 per=1.8e+01 cost=3.2e+02 flops=1.4e+04
 renorm_tot[gemm] counter=53 i=0 t=7.4e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=53 i=1 t=5.0e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=53 i=2 t=2.5e-02 per=2.0e+01 cost=1.4e+02 flops=5.4e+03
 renorm_tot[gemm] counter=53 i=3 t=2.4e-02 per=1.9e+01 cost=2.8e+02 flops=1.2e+04
 renorm_tot[gemm] counter=53 i=4 t=4.8e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=53 i=5 t=4.6e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=53 i=6 t=2.4e-02 per=1.9e+01 cost=7.0e+02 flops=3.0e+04
 renorm_tot[gemm] counter=53 total t=7.3e-02 per=5.8e+01 cost=1.1e+03 flops=1.5e+04
 renorm_tot[red] counter=53 t=3.0e-02 per=2.4e+01 cost=7.0e+02 flops=2.3e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 3.7e-02 S rank=0 -----
qops.to_cpu: size(tot)=68:5.2e-04MB:5.1e-07GB T(to_cpu)=6.4e-05S speed=7.9e-03GB/S
check ||H-H.dagger||=7.850e-17 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.0856 S rank=0 -----
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=3.473e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-8.487e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 9.487e-02 S #####
 T(local oper_env: fetch) = 8.043e-03 S  per = 8.48  per(accum) = 8.48
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.48
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.48
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.48
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.48
 T(local oper_env: renrm) = 8.670e-02 S  per = 91.4  per(accum) = 99.9
 T(local oper_env: save ) = 1.254e-04 S  per = 0.132  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.670e-02 S  T(sum) = 8.670e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.766e-06 S  per = 0.0113  per(accum) = 0.0113
 T(local oper_env: qops init                    ) = 3.270e-04 S  per = 0.377  per(accum) = 0.388
 T(local oper_env: symbolic_formulae_renorm     ) = 2.914e-04 S  per = 0.336  per(accum) = 0.725
 T(local oper_env: allocate qops on gpu         ) = 7.461e-05 S  per = 0.0861  per(accum) = 0.811
 T(local oper_env: site memcpy cpu2gpu          ) = 2.451e-04 S  per = 0.283  per(accum) = 1.09
 T(local oper_env: rintermediate init           ) = 2.507e-03 S  per = 2.89  per(accum) = 3.99
 T(local oper_env: preprocess_formulae_Rlist2   ) = 5.364e-04 S  per = 0.619  per(accum) = 4.6
 T(local oper_env: rmmtasks init                ) = 3.072e-04 S  per = 0.354  per(accum) = 4.96
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 3.81e-05  per(accum) = 4.96
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.193e-02 S  per = 48.4  per(accum) = 53.3
 T(local oper_env: deallocate cpu and gpu memory) = 2.047e-05 S  per = 0.0236  per(accum) = 53.3
 T(local oper_env: construct opS [ifdists=true] ) = 3.683e-02 S  per = 42.5  per(accum) = 95.8
 T(local oper_env: reduction of opS & opH [nccl]) = 2.429e-03 S  per =  2.8  per(accum) = 98.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 7.737e-05 S  per = 0.0892  per(accum) = 98.7
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.842e-05 S  per = 0.0212  per(accum) = 98.7
 T(local oper_env: qops_pool join and erase     ) = 1.087e-03 S  per = 1.25  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.010e-07 S  per = 0.000809  per(accum) = 100
##### sweep oper_env: 2.307e+00 S #####
 T(sweep oper_env: fetch) = 4.256e-02 S  per = 1.85  per(accum) = 1.85
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 1.85
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 1.85
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 1.85
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 1.85
 T(sweep oper_env: renrm) = 2.264e+00 S  per = 98.1  per(accum) = 100
 T(sweep oper_env: save ) = 5.032e-04 S  per = 0.0218  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -6.947e+09 S  per = -6.947e+31
 T(sweep oper_env: preprocess                  ) = -6.947e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.264e+00 S  T(sum) = 2.264e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 4.578e-05 S  per = 0.00202  per(accum) = 0.00202
 T(sweep oper_env: qops init                    ) = 1.278e-03 S  per = 0.0564  per(accum) = 0.0585
 T(sweep oper_env: symbolic_formulae_renorm     ) = 8.401e-04 S  per = 0.0371  per(accum) = 0.0956
 T(sweep oper_env: allocate qops on gpu         ) = 3.025e-04 S  per = 0.0134  per(accum) = 0.109
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.052e-03 S  per = 0.135  per(accum) = 0.244
 T(sweep oper_env: rintermediate init           ) = 7.526e-03 S  per = 0.332  per(accum) = 0.576
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.945e-03 S  per = 0.0859  per(accum) = 0.662
 T(sweep oper_env: rmmtasks init                ) = 1.272e-03 S  per = 0.0562  per(accum) = 0.718
 T(sweep oper_env: qops memset on cpu           ) = 1.410e-07 S  per = 6.23e-06  per(accum) = 0.718
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.266e-01 S  per = 5.59  per(accum) = 6.31
 T(sweep oper_env: deallocate cpu and gpu memory) = 9.588e-05 S  per = 0.00424  per(accum) = 6.31
 T(sweep oper_env: construct opS [ifdists=true] ) = 2.105e+00 S  per =   93  per(accum) = 99.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 9.263e-03 S  per = 0.409  per(accum) = 99.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.714e-04 S  per = 0.012  per(accum) = 99.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 9.506e-05 S  per = 0.0042  per(accum) = 99.8
 T(sweep oper_env: qops_pool join and erase     ) = 5.604e-03 S  per = 0.248  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.747e-06 S  per = 0.000121  per(accum) = 100

idx=5 coord=(14,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:5 S:7 A:12 B:16 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=68:0.000519MB:5.07e-07GB
        per(mem): H:5.88 C:0 S:0 A:0 B:94.1 
ctns::oper_renorm coord=(14,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:6 S:7 A:17 B:22 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=92:0.000702MB:6.85e-07GB
        per(mem): H:4.35 C:0 S:0 A:0 B:95.7 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=8.197e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=46 : 3.514e-04 S -----
rank=0 GPUmem(GB): used=8.628e-06 (oper)=8.628e-06
rank=0 GPUmem(GB): used=8.658e-06 (oper,site)=8.628e-06,2.980e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=46
 no. of rintermediate operators=5
 no. of coefficients=39:2.975e-04MB:2.906e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.473e-03 S -----
rank=0 GPUmem(GB): used=8.948e-06 (oper,site,rinter)=8.628e-06,2.980e-08,2.906e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 3.405e-04 S size(rtasks)=46 size(Rlst2)=1 T(Rmu/Rlist)=1.060e-04,2.344e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.566e-04 S size(rtasks)=46 size(Rlst)=24 -----
rank=0 GPUmem(GB): used=8.948e-06 avail=6.231e+00 total=6.231e+00 batch[need]=2.325e-06 blksize=4 blksize0=4 batchsize=24
rank=0 GPUmem(GB): used=1.127e-05 (oper,site,rinter,batch)=8.628e-06,2.980e-08,2.906e-07,2.325e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.431e-03,2.275e-02,1.002e-02
----- TIMING FOR renorm : t_inter=9.4e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.2e-02 -----
 renorm[inter] counter=54 t=9.4e-03 per=2.2e+01 cost=2.6e+02 flops=2.7e+04
 renorm[gemm] counter=54 i=0 t=1.4e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=54 i=1 t=1.2e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=54 i=2 t=7.5e-03 per=1.8e+01 cost=4.8e+01 flops=6.4e+03
 renorm[gemm] counter=54 i=3 t=7.6e-03 per=1.8e+01 cost=3.0e+02 flops=4.0e+04
 renorm[gemm] counter=54 i=4 t=1.2e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=54 i=5 t=1.1e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=54 i=6 t=7.6e-03 per=1.8e+01 cost=3.8e+02 flops=5.1e+04
 renorm[gemm] counter=54 total t=2.3e-02 per=5.4e+01 cost=7.4e+02 flops=3.2e+04
 renorm[red] counter=54 t=1.0e-02 per=2.4e+01 cost=1.9e+02 flops=1.9e+04
----- TIMING FOR renorm_tot : t_inter=3.2e-02 t_gemm=9.6e-02 t_reduction=4.0e-02 tot=1.7e-01 -----
 renorm_tot[inter] counter=54 t=3.2e-02 per=1.9e+01 cost=5.8e+02 flops=1.8e+04
 renorm_tot[gemm] counter=54 i=0 t=8.8e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=54 i=1 t=6.2e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=54 i=2 t=3.3e-02 per=1.9e+01 cost=1.8e+02 flops=5.6e+03
 renorm_tot[gemm] counter=54 i=3 t=3.1e-02 per=1.9e+01 cost=5.8e+02 flops=1.8e+04
 renorm_tot[gemm] counter=54 i=4 t=6.0e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=54 i=5 t=5.7e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=54 i=6 t=3.1e-02 per=1.9e+01 cost=1.1e+03 flops=3.5e+04
 renorm_tot[gemm] counter=54 total t=9.6e-02 per=5.7e+01 cost=1.8e+03 flops=1.9e+04
 renorm_tot[red] counter=54 t=4.0e-02 per=2.4e+01 cost=8.9e+02 flops=2.2e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 3.5e-02 S rank=0 -----
qops.to_cpu: size(tot)=92:7.0e-04MB:6.9e-07GB T(to_cpu)=7.7e-05S speed=8.9e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.085 S rank=0 -----
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=3.107e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-8.432e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 9.439e-02 S #####
 T(local oper_env: fetch) = 8.111e-03 S  per = 8.59  per(accum) = 8.59
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.59
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.59
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.59
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.59
 T(local oper_env: renrm) = 8.616e-02 S  per = 91.3  per(accum) = 99.9
 T(local oper_env: save ) = 1.227e-04 S  per = 0.13  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.616e-02 S  T(sum) = 8.616e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.377e-06 S  per = 0.0109  per(accum) = 0.0109
 T(local oper_env: qops init                    ) = 3.833e-04 S  per = 0.445  per(accum) = 0.456
 T(local oper_env: symbolic_formulae_renorm     ) = 3.630e-04 S  per = 0.421  per(accum) = 0.877
 T(local oper_env: allocate qops on gpu         ) = 6.931e-05 S  per = 0.0804  per(accum) = 0.957
 T(local oper_env: site memcpy cpu2gpu          ) = 2.633e-05 S  per = 0.0306  per(accum) = 0.988
 T(local oper_env: rintermediate init           ) = 2.487e-03 S  per = 2.89  per(accum) = 3.87
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.624e-04 S  per = 0.421  per(accum) = 4.3
 T(local oper_env: rmmtasks init                ) = 1.827e-04 S  per = 0.212  per(accum) = 4.51
 T(local oper_env: qops memset on cpu           ) = 4.000e-08 S  per = 4.64e-05  per(accum) = 4.51
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.238e-02 S  per = 49.2  per(accum) = 53.7
 T(local oper_env: deallocate cpu and gpu memory) = 2.012e-05 S  per = 0.0234  per(accum) = 53.7
 T(local oper_env: construct opS [ifdists=true] ) = 3.471e-02 S  per = 40.3  per(accum) = 94
 T(local oper_env: reduction of opS & opH [nccl]) = 3.925e-03 S  per = 4.56  per(accum) = 98.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.967e-05 S  per = 0.104  per(accum) = 98.7
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.866e-05 S  per = 0.0217  per(accum) = 98.7
 T(local oper_env: qops_pool join and erase     ) = 1.131e-03 S  per = 1.31  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.270e-07 S  per = 0.000728  per(accum) = 100
##### sweep oper_env: 2.401e+00 S #####
 T(sweep oper_env: fetch) = 5.067e-02 S  per = 2.11  per(accum) = 2.11
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.11
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.11
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.11
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.11
 T(sweep oper_env: renrm) = 2.350e+00 S  per = 97.9  per(accum) = 100
 T(sweep oper_env: save ) = 6.259e-04 S  per = 0.0261  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -8.683e+09 S  per = -8.683e+31
 T(sweep oper_env: preprocess                  ) = -8.683e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.350e+00 S  T(sum) = 2.350e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 5.516e-05 S  per = 0.00235  per(accum) = 0.00235
 T(sweep oper_env: qops init                    ) = 1.661e-03 S  per = 0.0707  per(accum) = 0.073
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.203e-03 S  per = 0.0512  per(accum) = 0.124
 T(sweep oper_env: allocate qops on gpu         ) = 3.718e-04 S  per = 0.0158  per(accum) = 0.14
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.079e-03 S  per = 0.131  per(accum) = 0.271
 T(sweep oper_env: rintermediate init           ) = 1.001e-02 S  per = 0.426  per(accum) = 0.697
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.307e-03 S  per = 0.0982  per(accum) = 0.795
 T(sweep oper_env: rmmtasks init                ) = 1.455e-03 S  per = 0.0619  per(accum) = 0.857
 T(sweep oper_env: qops memset on cpu           ) = 1.810e-07 S  per = 7.7e-06  per(accum) = 0.857
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.690e-01 S  per = 7.19  per(accum) = 8.05
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.160e-04 S  per = 0.00494  per(accum) = 8.05
 T(sweep oper_env: construct opS [ifdists=true] ) = 2.140e+00 S  per = 91.1  per(accum) = 99.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.319e-02 S  per = 0.561  per(accum) = 99.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.610e-04 S  per = 0.0154  per(accum) = 99.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.137e-04 S  per = 0.00484  per(accum) = 99.7
 T(sweep oper_env: qops_pool join and erase     ) = 6.735e-03 S  per = 0.287  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.374e-06 S  per = 0.000144  per(accum) = 100

idx=6 coord=(13,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:6 S:7 A:17 B:22 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=92:0.000702MB:6.85e-07GB
        per(mem): H:4.35 C:0 S:0 A:0 B:95.7 
ctns::oper_renorm coord=(13,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:7 S:6 A:23 B:28 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=116:0.000885MB:8.64e-07GB
        per(mem): H:3.45 C:0 S:0 A:0 B:96.6 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=8.249e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=59 : 4.424e-04 S -----
rank=0 GPUmem(GB): used=8.985e-06 (oper)=8.985e-06
rank=0 GPUmem(GB): used=9.015e-06 (oper,site)=8.985e-06,2.980e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=59
 no. of rintermediate operators=5
 no. of coefficients=54:4.120e-04MB:4.023e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.507e-03 S -----
rank=0 GPUmem(GB): used=9.418e-06 (oper,site,rinter)=8.985e-06,2.980e-08,4.023e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 4.208e-04 S size(rtasks)=59 size(Rlst2)=1 T(Rmu/Rlist)=1.316e-04,2.891e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.378e-04 S size(rtasks)=59 size(Rlst)=30 -----
rank=0 GPUmem(GB): used=9.418e-06 avail=6.231e+00 total=6.231e+00 batch[need]=2.906e-06 blksize=4 blksize0=4 batchsize=30
rank=0 GPUmem(GB): used=1.232e-05 (oper,site,rinter,batch)=8.985e-06,2.980e-08,4.023e-07,2.906e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.360e-03,2.266e-02,9.909e-03
----- TIMING FOR renorm : t_inter=9.4e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=4.2e-02 -----
 renorm[inter] counter=55 t=9.4e-03 per=2.2e+01 cost=3.5e+02 flops=3.8e+04
 renorm[gemm] counter=55 i=0 t=1.4e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=55 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=55 i=2 t=7.6e-03 per=1.8e+01 cost=4.8e+01 flops=6.4e+03
 renorm[gemm] counter=55 i=3 t=7.6e-03 per=1.8e+01 cost=4.0e+02 flops=5.3e+04
 renorm[gemm] counter=55 i=4 t=1.3e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=55 i=5 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=55 i=6 t=7.5e-03 per=1.8e+01 cost=4.8e+02 flops=6.4e+04
 renorm[gemm] counter=55 total t=2.3e-02 per=5.4e+01 cost=9.3e+02 flops=4.1e+04
 renorm[red] counter=55 t=9.9e-03 per=2.4e+01 cost=2.4e+02 flops=2.4e+04
----- TIMING FOR renorm_tot : t_inter=4.2e-02 t_gemm=1.2e-01 t_reduction=5.0e-02 tot=2.1e-01 -----
 renorm_tot[inter] counter=55 t=4.2e-02 per=2.0e+01 cost=9.3e+02 flops=2.2e+04
 renorm_tot[gemm] counter=55 i=0 t=1.0e-05 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=55 i=1 t=7.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=55 i=2 t=4.0e-02 per=1.9e+01 cost=2.3e+02 flops=5.8e+03
 renorm_tot[gemm] counter=55 i=3 t=3.9e-02 per=1.9e+01 cost=9.8e+02 flops=2.5e+04
 renorm_tot[gemm] counter=55 i=4 t=7.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=55 i=5 t=6.9e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=55 i=6 t=3.9e-02 per=1.9e+01 cost=1.6e+03 flops=4.0e+04
 renorm_tot[gemm] counter=55 total t=1.2e-01 per=5.6e+01 cost=2.8e+03 flops=2.4e+04
 renorm_tot[red] counter=55 t=5.0e-02 per=2.4e+01 cost=1.1e+03 flops=2.3e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 3.2e-02 S rank=0 -----
qops.to_cpu: size(tot)=116:8.9e-04MB:8.6e-07GB T(to_cpu)=9.1e-05S speed=9.5e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.0824 S rank=0 -----
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=3.715e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-8.551e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 9.267e-02 S #####
 T(local oper_env: fetch) = 9.011e-03 S  per = 9.72  per(accum) = 9.72
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 9.72
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 9.72
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 9.72
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 9.72
 T(local oper_env: renrm) = 8.353e-02 S  per = 90.1  per(accum) = 99.9
 T(local oper_env: save ) = 1.217e-04 S  per = 0.131  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.353e-02 S  T(sum) = 8.353e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.282e-06 S  per = 0.0111  per(accum) = 0.0111
 T(local oper_env: qops init                    ) = 4.294e-04 S  per = 0.514  per(accum) = 0.525
 T(local oper_env: symbolic_formulae_renorm     ) = 4.542e-04 S  per = 0.544  per(accum) = 1.07
 T(local oper_env: allocate qops on gpu         ) = 7.163e-05 S  per = 0.0857  per(accum) = 1.15
 T(local oper_env: site memcpy cpu2gpu          ) = 1.037e-03 S  per = 1.24  per(accum) = 2.4
 T(local oper_env: rintermediate init           ) = 2.521e-03 S  per = 3.02  per(accum) = 5.41
 T(local oper_env: preprocess_formulae_Rlist2   ) = 4.435e-04 S  per = 0.531  per(accum) = 5.94
 T(local oper_env: rmmtasks init                ) = 2.756e-04 S  per = 0.33  per(accum) = 6.27
 T(local oper_env: qops memset on cpu           ) = 2.300e-08 S  per = 2.75e-05  per(accum) = 6.27
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.214e-02 S  per = 50.5  per(accum) = 56.7
 T(local oper_env: deallocate cpu and gpu memory) = 2.080e-05 S  per = 0.0249  per(accum) = 56.8
 T(local oper_env: construct opS [ifdists=true] ) = 3.238e-02 S  per = 38.8  per(accum) = 95.5
 T(local oper_env: reduction of opS & opH [nccl]) = 2.482e-03 S  per = 2.97  per(accum) = 98.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.037e-04 S  per = 0.124  per(accum) = 98.6
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.827e-05 S  per = 0.0219  per(accum) = 98.6
 T(local oper_env: qops_pool join and erase     ) = 1.140e-03 S  per = 1.36  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 5.420e-07 S  per = 0.000649  per(accum) = 100
##### sweep oper_env: 2.494e+00 S #####
 T(sweep oper_env: fetch) = 5.968e-02 S  per = 2.39  per(accum) = 2.39
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.39
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.39
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.39
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.39
 T(sweep oper_env: renrm) = 2.433e+00 S  per = 97.6  per(accum) = 100
 T(sweep oper_env: save ) = 7.477e-04 S  per = 0.03  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.042e+10 S  per = -1.042e+32
 T(sweep oper_env: preprocess                  ) = -1.042e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.433e+00 S  T(sum) = 2.433e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 6.444e-05 S  per = 0.00265  per(accum) = 0.00265
 T(sweep oper_env: qops init                    ) = 2.090e-03 S  per = 0.0859  per(accum) = 0.0886
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.657e-03 S  per = 0.0681  per(accum) = 0.157
 T(sweep oper_env: allocate qops on gpu         ) = 4.434e-04 S  per = 0.0182  per(accum) = 0.175
 T(sweep oper_env: site memcpy cpu2gpu          ) = 4.116e-03 S  per = 0.169  per(accum) = 0.344
 T(sweep oper_env: rintermediate init           ) = 1.253e-02 S  per = 0.515  per(accum) = 0.859
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.751e-03 S  per = 0.113  per(accum) = 0.972
 T(sweep oper_env: rmmtasks init                ) = 1.731e-03 S  per = 0.0711  per(accum) = 1.04
 T(sweep oper_env: qops memset on cpu           ) = 2.040e-07 S  per = 8.38e-06  per(accum) = 1.04
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.111e-01 S  per = 8.68  per(accum) = 9.72
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.368e-04 S  per = 0.00562  per(accum) = 9.72
 T(sweep oper_env: construct opS [ifdists=true] ) = 2.173e+00 S  per = 89.3  per(accum) = 99
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.567e-02 S  per = 0.644  per(accum) = 99.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 4.648e-04 S  per = 0.0191  per(accum) = 99.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.320e-04 S  per = 0.00542  per(accum) = 99.7
 T(sweep oper_env: qops_pool join and erase     ) = 7.875e-03 S  per = 0.324  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.916e-06 S  per = 0.000161  per(accum) = 100

idx=7 coord=(12,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:7 S:6 A:23 B:28 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=116:0.000885MB:8.64e-07GB
        per(mem): H:3.45 C:0 S:0 A:0 B:96.6 
ctns::oper_renorm coord=(12,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:8 S:6 A:28 B:40 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=164:0.00125MB:1.22e-06GB
        per(mem): H:2.44 C:0 S:0 A:0 B:97.6 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=8.329e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 5.608e-04 S -----
rank=0 GPUmem(GB): used=9.522e-06 (oper)=9.522e-06
rank=0 GPUmem(GB): used=9.552e-06 (oper,site)=9.522e-06,2.980e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=77
 no. of rintermediate operators=5
 no. of coefficients=69:5.264e-04MB:5.141e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.483e-03 S -----
rank=0 GPUmem(GB): used=1.007e-05 (oper,site,rinter)=9.522e-06,2.980e-08,5.141e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 5.219e-04 S size(rtasks)=77 size(Rlst2)=1 T(Rmu/Rlist)=1.692e-04,3.527e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.416e-04 S size(rtasks)=77 size(Rlst)=37 -----
rank=0 GPUmem(GB): used=1.007e-05 avail=6.231e+00 total=6.231e+00 batch[need]=3.584e-06 blksize=4 blksize0=4 batchsize=37
rank=0 GPUmem(GB): used=1.365e-05 (oper,site,rinter,batch)=9.522e-06,2.980e-08,5.141e-07,3.584e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.274e-03,2.264e-02,9.945e-03
----- TIMING FOR renorm : t_inter=9.3e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=4.2e-02 -----
 renorm[inter] counter=56 t=9.3e-03 per=2.2e+01 cost=4.5e+02 flops=4.8e+04
 renorm[gemm] counter=56 i=0 t=1.3e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=56 i=1 t=1.2e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=56 i=2 t=7.6e-03 per=1.8e+01 cost=4.8e+01 flops=6.3e+03
 renorm[gemm] counter=56 i=3 t=7.6e-03 per=1.8e+01 cost=5.0e+02 flops=6.6e+04
 renorm[gemm] counter=56 i=4 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=56 i=5 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=56 i=6 t=7.5e-03 per=1.8e+01 cost=5.9e+02 flops=7.9e+04
 renorm[gemm] counter=56 total t=2.3e-02 per=5.4e+01 cost=1.1e+03 flops=5.0e+04
 renorm[red] counter=56 t=9.9e-03 per=2.4e+01 cost=3.0e+02 flops=3.0e+04
----- TIMING FOR renorm_tot : t_inter=5.1e-02 t_gemm=1.4e-01 t_reduction=6.0e-02 tot=2.5e-01 -----
 renorm_tot[inter] counter=56 t=5.1e-02 per=2.0e+01 cost=1.4e+03 flops=2.7e+04
 renorm_tot[gemm] counter=56 i=0 t=1.1e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=56 i=1 t=8.5e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=56 i=2 t=4.8e-02 per=1.9e+01 cost=2.8e+02 flops=5.9e+03
 renorm_tot[gemm] counter=56 i=3 t=4.7e-02 per=1.9e+01 cost=1.5e+03 flops=3.2e+04
 renorm_tot[gemm] counter=56 i=4 t=8.5e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=56 i=5 t=8.0e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=56 i=6 t=4.6e-02 per=1.8e+01 cost=2.2e+03 flops=4.7e+04
 renorm_tot[gemm] counter=56 total t=1.4e-01 per=5.6e+01 cost=3.9e+03 flops=2.8e+04
 renorm_tot[red] counter=56 t=6.0e-02 per=2.4e+01 cost=1.4e+03 flops=2.4e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 3.0e-02 S rank=0 -----
qops.to_cpu: size(tot)=164:1.3e-03MB:1.2e-06GB T(to_cpu)=1.1e-04S speed=1.1e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.0812 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=4.633e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-8.695e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 9.052e-02 S #####
 T(local oper_env: fetch) = 8.059e-03 S  per =  8.9  per(accum) = 8.9
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.9
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.9
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.9
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.9
 T(local oper_env: renrm) = 8.233e-02 S  per =   91  per(accum) = 99.9
 T(local oper_env: save ) = 1.244e-04 S  per = 0.137  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.233e-02 S  T(sum) = 8.233e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.160e-06 S  per = 0.0111  per(accum) = 0.0111
 T(local oper_env: qops init                    ) = 4.522e-04 S  per = 0.549  per(accum) = 0.56
 T(local oper_env: symbolic_formulae_renorm     ) = 5.729e-04 S  per = 0.696  per(accum) = 1.26
 T(local oper_env: allocate qops on gpu         ) = 7.289e-05 S  per = 0.0885  per(accum) = 1.34
 T(local oper_env: site memcpy cpu2gpu          ) = 2.219e-03 S  per =  2.7  per(accum) = 4.04
 T(local oper_env: rintermediate init           ) = 2.498e-03 S  per = 3.03  per(accum) = 7.07
 T(local oper_env: preprocess_formulae_Rlist2   ) = 5.477e-04 S  per = 0.665  per(accum) = 7.74
 T(local oper_env: rmmtasks init                ) = 2.434e-04 S  per = 0.296  per(accum) = 8.03
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 4.01e-05  per(accum) = 8.03
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.197e-02 S  per =   51  per(accum) = 59
 T(local oper_env: deallocate cpu and gpu memory) = 2.171e-05 S  per = 0.0264  per(accum) = 59
 T(local oper_env: construct opS [ifdists=true] ) = 3.002e-02 S  per = 36.5  per(accum) = 95.5
 T(local oper_env: reduction of opS & opH [nccl]) = 2.457e-03 S  per = 2.98  per(accum) = 98.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.250e-04 S  per = 0.152  per(accum) = 98.6
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.837e-05 S  per = 0.0223  per(accum) = 98.7
 T(local oper_env: qops_pool join and erase     ) = 1.109e-03 S  per = 1.35  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.200e-07 S  per = 0.000874  per(accum) = 100
##### sweep oper_env: 2.584e+00 S #####
 T(sweep oper_env: fetch) = 6.774e-02 S  per = 2.62  per(accum) = 2.62
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.62
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.62
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.62
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.62
 T(sweep oper_env: renrm) = 2.516e+00 S  per = 97.3  per(accum) = 100
 T(sweep oper_env: save ) = 8.721e-04 S  per = 0.0337  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.216e+10 S  per = -1.216e+32
 T(sweep oper_env: preprocess                  ) = -1.216e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.516e+00 S  T(sum) = 2.516e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 7.360e-05 S  per = 0.00293  per(accum) = 0.00293
 T(sweep oper_env: qops init                    ) = 2.543e-03 S  per = 0.101  per(accum) = 0.104
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.230e-03 S  per = 0.0886  per(accum) = 0.193
 T(sweep oper_env: allocate qops on gpu         ) = 5.163e-04 S  per = 0.0205  per(accum) = 0.213
 T(sweep oper_env: site memcpy cpu2gpu          ) = 6.335e-03 S  per = 0.252  per(accum) = 0.465
 T(sweep oper_env: rintermediate init           ) = 1.503e-02 S  per = 0.598  per(accum) = 1.06
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.299e-03 S  per = 0.131  per(accum) = 1.19
 T(sweep oper_env: rmmtasks init                ) = 1.974e-03 S  per = 0.0785  per(accum) = 1.27
 T(sweep oper_env: qops memset on cpu           ) = 2.370e-07 S  per = 9.42e-06  per(accum) = 1.27
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.531e-01 S  per = 10.1  per(accum) = 11.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.585e-04 S  per = 0.0063  per(accum) = 11.3
 T(sweep oper_env: construct opS [ifdists=true] ) = 2.203e+00 S  per = 87.6  per(accum) = 98.9
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.813e-02 S  per = 0.721  per(accum) = 99.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 5.898e-04 S  per = 0.0234  per(accum) = 99.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.504e-04 S  per = 0.00598  per(accum) = 99.6
 T(sweep oper_env: qops_pool join and erase     ) = 8.983e-03 S  per = 0.357  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 4.636e-06 S  per = 0.000184  per(accum) = 100

idx=8 coord=(11,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:8 S:6 A:28 B:40 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=164:0.00125MB:1.22e-06GB
        per(mem): H:2.44 C:0 S:0 A:0 B:97.6 
ctns::oper_renorm coord=(11,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:9 S:5 A:40 B:44 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=207:0.00158MB:1.54e-06GB
        per(mem): H:1.45 C:8.7 S:4.83 A:0 B:85 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.984e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=94 : 6.773e-04 S -----
rank=0 GPUmem(GB): used=1.020e-05 (oper)=1.020e-05
rank=0 GPUmem(GB): used=1.024e-05 (oper,site)=1.020e-05,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=94
 no. of rintermediate operators=5
 no. of coefficients=96:7.324e-04MB:7.153e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.480e-03 S -----
rank=0 GPUmem(GB): used=1.096e-05 (oper,site,rinter)=1.020e-05,4.470e-08,7.153e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.776e-03 S size(rtasks)=94 size(Rlst2)=9 T(Rmu/Rlist)=1.999e-04,1.576e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.829e-03 S size(rtasks)=94 size(Rlst)=198 -----
rank=0 GPUmem(GB): used=1.096e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.328e-05 blksize=2 blksize0=4 batchsize=198
rank=0 GPUmem(GB): used=2.424e-05 (oper,site,rinter,batch)=1.020e-05,4.470e-08,7.153e-07,1.328e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.140e-03,2.250e-02,9.918e-03
----- TIMING FOR renorm : t_inter=7.1e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=4.0e-02 -----
 renorm[inter] counter=57 t=7.1e-03 per=1.8e+01 cost=3.2e+03 flops=4.5e+05
 renorm[gemm] counter=57 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=57 i=1 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=57 i=2 t=7.6e-03 per=1.9e+01 cost=1.0e+02 flops=1.4e+04
 renorm[gemm] counter=57 i=3 t=7.5e-03 per=1.9e+01 cost=1.4e+03 flops=1.9e+05
 renorm[gemm] counter=57 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=57 i=5 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=57 i=6 t=7.4e-03 per=1.9e+01 cost=7.9e+02 flops=1.1e+05
 renorm[gemm] counter=57 total t=2.2e-02 per=5.7e+01 cost=2.3e+03 flops=1.0e+05
 renorm[red] counter=57 t=9.9e-03 per=2.5e+01 cost=4.0e+02 flops=4.0e+04
----- TIMING FOR renorm_tot : t_inter=5.8e-02 t_gemm=1.6e-01 t_reduction=7.0e-02 tot=2.9e-01 -----
 renorm_tot[inter] counter=57 t=5.8e-02 per=2.0e+01 cost=4.6e+03 flops=7.9e+04
 renorm_tot[gemm] counter=57 i=0 t=1.3e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=57 i=1 t=9.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=57 i=2 t=5.5e-02 per=1.9e+01 cost=3.8e+02 flops=6.9e+03
 renorm_tot[gemm] counter=57 i=3 t=5.4e-02 per=1.9e+01 cost=2.9e+03 flops=5.3e+04
 renorm_tot[gemm] counter=57 i=4 t=9.7e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=57 i=5 t=9.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=57 i=6 t=5.4e-02 per=1.8e+01 cost=3.0e+03 flops=5.5e+04
 renorm_tot[gemm] counter=57 total t=1.6e-01 per=5.6e+01 cost=6.2e+03 flops=3.8e+04
 renorm_tot[red] counter=57 t=7.0e-02 per=2.4e+01 cost=1.8e+03 flops=2.6e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.068e-05 (optmp,oper)=1.490e-08,1.020e-05
rank=0 GPUmem(GB): used=2.072e-05 (optmp,oper,site,rinter)=1.490e-08,1.020e-05,4.470e-08,9.745e-06
rank=0 GPUmem(GB): used=2.139e-05 (optmp,oper,site,rinter,batch)=1.490e-08,1.020e-05,4.470e-08,9.745e-06,6.706e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.846e-01 S T(prep/alloc/comp/red/dealloc)=1.778e-02,1.887e-02,4.139e-01,4.919e-02,2.525e-03 -----
----- TIMING FOR oper_renorm_opS : 4.847e-01 S rank=0 -----
qops.to_cpu: size(tot)=207:1.579e-03MB:1.542e-06GB T(to_cpu)=1.335e-04S speed=1.155e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.536 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.464e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=6.104e-05 change=-9.224e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 5.451e-01 S #####
 T(local oper_env: fetch) = 8.081e-03 S  per = 1.48  per(accum) = 1.48
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 1.48
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 1.48
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 1.48
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 1.48
 T(local oper_env: renrm) = 5.369e-01 S  per = 98.5  per(accum) = 100
 T(local oper_env: save ) = 1.436e-04 S  per = 0.0263  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.369e-01 S  T(sum) = 5.369e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.260e-06 S  per = 0.00172  per(accum) = 0.00172
 T(local oper_env: qops init                    ) = 1.122e-03 S  per = 0.209  per(accum) = 0.211
 T(local oper_env: symbolic_formulae_renorm     ) = 6.896e-04 S  per = 0.128  per(accum) = 0.339
 T(local oper_env: allocate qops on gpu         ) = 7.157e-05 S  per = 0.0133  per(accum) = 0.353
 T(local oper_env: site memcpy cpu2gpu          ) = 1.465e-03 S  per = 0.273  per(accum) = 0.625
 T(local oper_env: rintermediate init           ) = 2.494e-03 S  per = 0.465  per(accum) = 1.09
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.841e-03 S  per = 0.343  per(accum) = 1.43
 T(local oper_env: rmmtasks init                ) = 1.121e-03 S  per = 0.209  per(accum) = 1.64
 T(local oper_env: qops memset on cpu           ) = 2.300e-08 S  per = 4.28e-06  per(accum) = 1.64
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.972e-02 S  per =  7.4  per(accum) = 9.04
 T(local oper_env: deallocate cpu and gpu memory) = 2.525e-05 S  per = 0.0047  per(accum) = 9.05
 T(local oper_env: construct opS [ifdists=true] ) = 4.847e-01 S  per = 90.3  per(accum) = 99.3
 T(local oper_env: reduction of opS & opH [nccl]) = 2.345e-03 S  per = 0.437  per(accum) = 99.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.481e-04 S  per = 0.0276  per(accum) = 99.8
 T(local oper_env: reduction of opS & opH [mpi] ) = 3.095e-05 S  per = 0.00576  per(accum) = 99.8
 T(local oper_env: qops_pool join and erase     ) = 1.163e-03 S  per = 0.217  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.740e-07 S  per = 0.000126  per(accum) = 100
##### sweep oper_env: 3.129e+00 S #####
 T(sweep oper_env: fetch) = 7.582e-02 S  per = 2.42  per(accum) = 2.42
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.42
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.42
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.42
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.42
 T(sweep oper_env: renrm) = 3.053e+00 S  per = 97.5  per(accum) = 100
 T(sweep oper_env: save ) = 1.016e-03 S  per = 0.0325  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.389e+10 S  per = -1.389e+32
 T(sweep oper_env: preprocess                  ) = -1.389e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.053e+00 S  T(sum) = 3.053e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 8.286e-05 S  per = 0.00271  per(accum) = 0.00271
 T(sweep oper_env: qops init                    ) = 3.665e-03 S  per = 0.12  per(accum) = 0.123
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.920e-03 S  per = 0.0956  per(accum) = 0.218
 T(sweep oper_env: allocate qops on gpu         ) = 5.879e-04 S  per = 0.0193  per(accum) = 0.238
 T(sweep oper_env: site memcpy cpu2gpu          ) = 7.800e-03 S  per = 0.256  per(accum) = 0.493
 T(sweep oper_env: rintermediate init           ) = 1.753e-02 S  per = 0.574  per(accum) = 1.07
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.139e-03 S  per = 0.168  per(accum) = 1.24
 T(sweep oper_env: rmmtasks init                ) = 3.095e-03 S  per = 0.101  per(accum) = 1.34
 T(sweep oper_env: qops memset on cpu           ) = 2.600e-07 S  per = 8.52e-06  per(accum) = 1.34
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.928e-01 S  per = 9.59  per(accum) = 10.9
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.838e-04 S  per = 0.00602  per(accum) = 10.9
 T(sweep oper_env: construct opS [ifdists=true] ) = 2.687e+00 S  per =   88  per(accum) = 99
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.047e-02 S  per = 0.671  per(accum) = 99.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 7.379e-04 S  per = 0.0242  per(accum) = 99.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.813e-04 S  per = 0.00594  per(accum) = 99.7
 T(sweep oper_env: qops_pool join and erase     ) = 1.015e-02 S  per = 0.332  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.310e-06 S  per = 0.000174  per(accum) = 100

idx=9 coord=(10,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSAB nops=H:1 C:9 S:5 A:40 B:44 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=207:0.00158MB:1.54e-06GB
        per(mem): H:1.45 C:8.7 S:4.83 A:0 B:85 
ctns::oper_renorm coord=(10,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:10 S:5 A:49 B:56 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=513:0.00391MB:3.82e-06GB
        per(mem): H:0.975 C:7.8 S:3.9 A:0 B:87.3 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.039e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=116 : 8.152e-04 S -----
rank=0 GPUmem(GB): used=1.280e-05 (oper)=1.280e-05
rank=0 GPUmem(GB): used=1.287e-05 (oper,site)=1.280e-05,6.706e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=116
 no. of rintermediate operators=5
 no. of coefficients=110:8.392e-04MB:8.196e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.550e-03 S -----
rank=0 GPUmem(GB): used=1.369e-05 (oper,site,rinter)=1.280e-05,6.706e-08,8.196e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 9.700e-03 S size(rtasks)=116 size(Rlst2)=25 T(Rmu/Rlist)=2.500e-04,9.450e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.888e-03 S size(rtasks)=116 size(Rlst)=978 -----
rank=0 GPUmem(GB): used=1.369e-05 avail=6.231e+00 total=6.231e+00 batch[need]=2.915e-05 blksize=1 blksize0=1 batchsize=978
rank=0 GPUmem(GB): used=4.283e-05 (oper,site,rinter,batch)=1.280e-05,6.706e-08,8.196e-07,2.915e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.904e-03,2.272e-02,1.001e-02
----- TIMING FOR renorm : t_inter=6.9e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=69 t=6.9e-03 per=1.7e+01 cost=2.8e+03 flops=4.1e+05
 renorm[gemm] counter=69 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=69 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=69 i=2 t=7.6e-03 per=1.9e+01 cost=2.6e+02 flops=3.4e+04
 renorm[gemm] counter=69 i=3 t=7.6e-03 per=1.9e+01 cost=1.6e+03 flops=2.2e+05
 renorm[gemm] counter=69 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=69 i=5 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=69 i=6 t=7.5e-03 per=1.9e+01 cost=2.0e+03 flops=2.6e+05
 renorm[gemm] counter=69 total t=2.3e-02 per=5.7e+01 cost=3.9e+03 flops=1.7e+05
 renorm[red] counter=69 t=1.0e-02 per=2.5e+01 cost=2.0e+03 flops=2.0e+05
----- TIMING FOR renorm_tot : t_inter=6.5e-02 t_gemm=1.9e-01 t_reduction=8.0e-02 tot=3.3e-01 -----
 renorm_tot[inter] counter=69 t=6.5e-02 per=2.0e+01 cost=7.4e+03 flops=1.1e+05
 renorm_tot[gemm] counter=69 i=0 t=1.4e-05 per=4.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=69 i=1 t=1.1e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=69 i=2 t=6.3e-02 per=1.9e+01 cost=6.4e+02 flops=1.0e+04
 renorm_tot[gemm] counter=69 i=3 t=6.2e-02 per=1.9e+01 cost=4.5e+03 flops=7.3e+04
 renorm_tot[gemm] counter=69 i=4 t=1.1e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=69 i=5 t=1.0e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=69 i=6 t=6.1e-02 per=1.9e+01 cost=4.9e+03 flops=8.0e+04
 renorm_tot[gemm] counter=69 total t=1.9e-01 per=5.6e+01 cost=1.0e+04 flops=5.4e+04
 renorm_tot[red] counter=69 t=8.0e-02 per=2.4e+01 cost=3.8e+03 flops=4.7e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.419e-05 (optmp,oper)=2.980e-08,1.280e-05
rank=0 GPUmem(GB): used=2.426e-05 (optmp,oper,site,rinter)=2.980e-08,1.280e-05,6.706e-08,1.054e-05
rank=0 GPUmem(GB): used=2.587e-05 (optmp,oper,site,rinter,batch)=2.980e-08,1.280e-05,6.706e-08,1.054e-05,1.609e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.367e-01 S T(prep/alloc/comp/red/dealloc)=2.195e-02,2.461e-02,3.657e-01,4.381e-02,2.527e-03 -----
----- TIMING FOR oper_renorm_opS : 4.368e-01 S rank=0 -----
----- TIMING FOR oper_renorm : 5.026e-01 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.777e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=2.594e-04 change=-1.169e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::oper_ab2pq coord=(10,0) superblock=cr alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=HCSPQ nops=H:1 C:10 S:5 P:49 Q:56 
        dim(bra,ket)=5,5 size(op)=11:8.392e-05MB size(tot)=513:3.914e-03MB:3.822e-06GB
        per(mem): H:0.975 C:7.8 S:3.9 P:0 Q:87.3 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=2.289e-04 change=2.440e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=2.289e-04 change=7.600e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=7.644e-06 avail=6.231e+00 after qops2.allocate_gpu
ctns::oper_a2p ifab=0 ifkr=1 maxsize=0:0.000e+00GB
ctns::oper_b2q ifab=0 ifkr=1 maxsize=448:3.338e-06GB
rank=1 size=448 iproc=0
iproc=0
 qops_tmp: oplist=B nops=B:56 
        dim(bra,ket)=5,5 size(op)=11:8.392e-05MB size(tot)=448:3.418e-03MB:3.338e-06GB
        per(mem): B:100 
   init qops_tmp: dt=0.00142 tinit=0.00142
   copy opB to qops_tmps: dt=0.00038 tcopy=0.00038
rank=0 size=448 iproc=0
   bcast: size(opB)=448:3.34e-06GB dt=0.00247 speed=0.00135GB/s tcomm=0.00247
   compute opQ from opB: dt=0.00502 tcomp=0.00502
iproc=0
 qops_tmp: oplist=N nops=N:56 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=448:0.00342MB:3.34e-06GB
        per(mem): N:100 
   init qops_tmp: dt=0.00138 tinit=0.0028
   from opB to opB.H(): dt=0.0081 tadjt=0.0081
   bcast: size(opN)=448:3.34e-06GB dt=0.00249 speed=0.00134GB/s tcomm=0.00496
   compute opQ from opB.H(): dt=0.0051 tcomp=0.0101
rank=0 size=432 iproc=1
iproc=1
 qops_tmp: oplist=B nops=B:54 
        dim(bra,ket)=5,5 size(op)=11:8.39233e-05MB size(tot)=432:0.0032959MB:3.21865e-06GB
        per(mem): B:100 
   init qops_tmp: dt=0.00132 tinit=0.00411
   copy opB to qops_tmps: dt=0.00094 tcopy=0.00094
rank=1 size=432 iproc=1
   bcast: size(opB)=432:3.22e-06GB dt=0.00246 speed=0.00131GB/s tcomm=0.0179
   compute opQ from opB: dt=0.00494 tcomp=0.015
iproc=1
 qops_tmp: oplist=N nops=N:54 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=432:0.0033MB:3.22e-06GB
        per(mem): N:100 
   init qops_tmp: dt=0.00133 tinit=0.00544
   from opB to opB.H(): dt=0.00808 tadjt=0.00808
   bcast: size(opN)=432:3.22e-06GB dt=0.00244 speed=0.00132GB/s tcomm=0.0203
   compute opQ from opB.H(): dt=0.00496 tcomp=0.0199
----- TIMING FOR oper_b2qGPU : 0.0557 S T(init/copy/adjt+bcast/comp/rest)=0.00545,0.00038,0.0291,0.0201,0.000714 -----
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=2.060e-04 change=1.743e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=7.644e-06 avail=6.231e+00 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=2.060e-04 change=4.292e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=7.644e-06 avail=6.231e+00 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=2.060e-04 change=-5.960e-08 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 before move
rank=0 GPUmem(GB): used=7.644e-06 avail=6.231e+00 before move
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=2.060e-04 change=-2.456e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after move
rank=0 GPUmem(GB): used=3.822e-06 avail=6.231e+00 after move
check ||H-H.dagger||=0.000e+00 coord=(10,0) rank=0
----- TIMING FOR oper_ab2pq : 0.0599 S T(init/copyHCS/opP/opQ/to_gpu/to_cpu/move)=0.00315,2.1e-05,6.68e-05,0.0558,0,0.000371,0.000462 -----
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=2.060e-04 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 5.724e-01 S #####
 T(local oper_env: fetch) = 8.093e-03 S  per = 1.41  per(accum) = 1.41
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 1.41
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 1.41
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 1.41
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 1.41
 T(local oper_env: renrm) = 5.641e-01 S  per = 98.6  per(accum) = 100
 T(local oper_env: save ) = 1.598e-04 S  per = 0.0279  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.641e-01 S  T(sum) = 5.641e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.354e-06 S  per = 0.00166  per(accum) = 0.00166
 T(local oper_env: qops init                    ) = 3.123e-03 S  per = 0.554  per(accum) = 0.555
 T(local oper_env: symbolic_formulae_renorm     ) = 8.280e-04 S  per = 0.147  per(accum) = 0.702
 T(local oper_env: allocate qops on gpu         ) = 7.917e-05 S  per = 0.014  per(accum) = 0.716
 T(local oper_env: site memcpy cpu2gpu          ) = 1.257e-03 S  per = 0.223  per(accum) = 0.939
 T(local oper_env: rintermediate init           ) = 2.565e-03 S  per = 0.455  per(accum) = 1.39
 T(local oper_env: preprocess_formulae_Rlist2   ) = 9.925e-03 S  per = 1.76  per(accum) = 3.15
 T(local oper_env: rmmtasks init                ) = 5.865e-03 S  per = 1.04  per(accum) = 4.19
 T(local oper_env: qops memset on cpu           ) = 3.600e-08 S  per = 6.38e-06  per(accum) = 4.19
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.980e-02 S  per = 7.06  per(accum) = 11.2
 T(local oper_env: deallocate cpu and gpu memory) = 5.926e-05 S  per = 0.0105  per(accum) = 11.3
 T(local oper_env: construct opS [ifdists=true] ) = 4.368e-01 S  per = 77.4  per(accum) = 88.7
 T(local oper_env: reduction of opS & opH [nccl]) = 2.286e-03 S  per = 0.405  per(accum) = 89.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.700e-08 S  per = 4.79e-06  per(accum) = 89.1
 T(local oper_env: reduction of opS & opH [mpi] ) = 7.100e-08 S  per = 1.26e-05  per(accum) = 89.1
 T(local oper_env: qops_pool join and erase     ) = 1.539e-03 S  per = 0.273  per(accum) = 89.4
 T(local oper_env: conversion from opAB to opPQ ) = 5.997e-02 S  per = 10.6  per(accum) = 100
##### sweep oper_env: 3.702e+00 S #####
 T(sweep oper_env: fetch) = 8.392e-02 S  per = 2.27  per(accum) = 2.27
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.27
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.27
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.27
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.27
 T(sweep oper_env: renrm) = 3.617e+00 S  per = 97.7  per(accum) = 100
 T(sweep oper_env: save ) = 1.175e-03 S  per = 0.0318  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.563e+10 S  per = -1.563e+32
 T(sweep oper_env: preprocess                  ) = -1.563e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.617e+00 S  T(sum) = 3.617e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 9.221e-05 S  per = 0.00255  per(accum) = 0.00255
 T(sweep oper_env: qops init                    ) = 6.788e-03 S  per = 0.188  per(accum) = 0.19
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.748e-03 S  per = 0.104  per(accum) = 0.294
 T(sweep oper_env: allocate qops on gpu         ) = 6.671e-04 S  per = 0.0184  per(accum) = 0.312
 T(sweep oper_env: site memcpy cpu2gpu          ) = 9.057e-03 S  per = 0.25  per(accum) = 0.563
 T(sweep oper_env: rintermediate init           ) = 2.009e-02 S  per = 0.556  per(accum) = 1.12
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.506e-02 S  per = 0.417  per(accum) = 1.53
 T(sweep oper_env: rmmtasks init                ) = 8.960e-03 S  per = 0.248  per(accum) = 1.78
 T(sweep oper_env: qops memset on cpu           ) = 2.960e-07 S  per = 8.18e-06  per(accum) = 1.78
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.326e-01 S  per =  9.2  per(accum) = 11
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.430e-04 S  per = 0.00672  per(accum) = 11
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.124e+00 S  per = 86.4  per(accum) = 97.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.276e-02 S  per = 0.629  per(accum) = 98
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 7.379e-04 S  per = 0.0204  per(accum) = 98
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.814e-04 S  per = 0.00501  per(accum) = 98
 T(sweep oper_env: qops_pool join and erase     ) = 1.169e-02 S  per = 0.323  per(accum) = 98.3
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.997e-02 S  per = 1.66  per(accum) = 100

idx=10 coord=(9,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:10 S:5 P:49 Q:56 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=513:0.00391MB:3.82e-06GB
        per(mem): H:0.975 C:7.8 S:3.9 P:0 Q:87.3 
ctns::oper_renorm coord=(9,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:11 S:4 P:40 Q:46 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=233:0.00178MB:1.74e-06GB
        per(mem): H:1.29 C:0 S:0 P:0 Q:98.7 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=9.015e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=98 : 2.960e-03 S -----
rank=0 GPUmem(GB): used=1.299e-05 (oper)=1.299e-05
rank=0 GPUmem(GB): used=1.305e-05 (oper,site)=1.299e-05,5.215e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=98
 no. of rintermediate operators=132
 no. of coefficients=1320:1.007e-02MB:9.835e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.462e-03 S -----
rank=0 GPUmem(GB): used=2.288e-05 (oper,site,rinter)=1.299e-05,5.215e-08,9.835e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.621e-02 S size(rtasks)=98 size(Rlst2)=9 T(Rmu/Rlist)=7.419e-04,1.547e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.637e-02 S size(rtasks)=98 size(Rlst)=1617 -----
rank=0 GPUmem(GB): used=2.288e-05 avail=6.231e+00 total=6.231e+00 batch[need]=4.819e-05 blksize=1 blksize0=1 batchsize=1617
rank=0 GPUmem(GB): used=7.107e-05 (oper,site,rinter,batch)=1.299e-05,5.215e-08,9.835e-06,4.819e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.525e-03,2.282e-02,1.005e-02
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=80 t=6.5e-03 per=1.7e+01 cost=1.1e+04 flops=1.7e+06
 renorm[gemm] counter=80 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=80 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=80 i=2 t=7.6e-03 per=1.9e+01 cost=6.1e+02 flops=8.0e+04
 renorm[gemm] counter=80 i=3 t=7.6e-03 per=1.9e+01 cost=1.9e+03 flops=2.5e+05
 renorm[gemm] counter=80 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=80 i=5 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=80 i=6 t=7.6e-03 per=1.9e+01 cost=3.2e+03 flops=4.2e+05
 renorm[gemm] counter=80 total t=2.3e-02 per=5.8e+01 cost=5.8e+03 flops=2.5e+05
 renorm[red] counter=80 t=1.0e-02 per=2.6e+01 cost=3.2e+03 flops=3.2e+05
----- TIMING FOR renorm_tot : t_inter=7.1e-02 t_gemm=2.1e-01 t_reduction=9.0e-02 tot=3.7e-01 -----
 renorm_tot[inter] counter=80 t=7.1e-02 per=1.9e+01 cost=1.8e+04 flops=2.6e+05
 renorm_tot[gemm] counter=80 i=0 t=1.6e-05 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=80 i=1 t=1.2e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=80 i=2 t=7.1e-02 per=1.9e+01 cost=1.3e+03 flops=1.8e+04
 renorm_tot[gemm] counter=80 i=3 t=6.9e-02 per=1.9e+01 cost=6.4e+03 flops=9.2e+04
 renorm_tot[gemm] counter=80 i=4 t=1.2e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=80 i=5 t=1.1e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=80 i=6 t=6.9e-02 per=1.9e+01 cost=8.1e+03 flops=1.2e+05
 renorm_tot[gemm] counter=80 total t=2.1e-01 per=5.6e+01 cost=1.6e+04 flops=7.6e+04
 renorm_tot[red] counter=80 t=9.0e-02 per=2.4e+01 cost=7.0e+03 flops=7.8e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 9.9e-03 S rank=0 -----
qops.to_cpu: size(tot)=233:1.8e-03MB:1.7e-06GB T(to_cpu)=1.4e-04S speed=1.3e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.0867 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=3.662e-04 change=5.365e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=1.648e-03 change=-1.574e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 9.653e-02 S #####
 T(local oper_env: fetch) = 8.219e-03 S  per = 8.51  per(accum) = 8.51
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.51
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.51
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.51
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.51
 T(local oper_env: renrm) = 8.818e-02 S  per = 91.3  per(accum) = 99.9
 T(local oper_env: save ) = 1.332e-04 S  per = 0.138  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.818e-02 S  T(sum) = 8.818e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.030e-05 S  per = 0.0117  per(accum) = 0.0117
 T(local oper_env: qops init                    ) = 1.213e-03 S  per = 1.38  per(accum) = 1.39
 T(local oper_env: symbolic_formulae_renorm     ) = 2.974e-03 S  per = 3.37  per(accum) = 4.76
 T(local oper_env: allocate qops on gpu         ) = 4.758e-05 S  per = 0.054  per(accum) = 4.81
 T(local oper_env: site memcpy cpu2gpu          ) = 1.229e-03 S  per = 1.39  per(accum) = 6.21
 T(local oper_env: rintermediate init           ) = 2.476e-03 S  per = 2.81  per(accum) = 9.02
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.644e-02 S  per = 18.6  per(accum) = 27.7
 T(local oper_env: rmmtasks init                ) = 1.012e-02 S  per = 11.5  per(accum) = 39.1
 T(local oper_env: qops memset on cpu           ) = 3.000e-08 S  per = 3.4e-05  per(accum) = 39.1
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.952e-02 S  per = 44.8  per(accum) = 84
 T(local oper_env: deallocate cpu and gpu memory) = 1.471e-04 S  per = 0.167  per(accum) = 84.1
 T(local oper_env: construct opS [ifdists=true] ) = 9.893e-03 S  per = 11.2  per(accum) = 95.3
 T(local oper_env: reduction of opS & opH [nccl]) = 2.440e-03 S  per = 2.77  per(accum) = 98.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.477e-04 S  per = 0.168  per(accum) = 98.3
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.921e-05 S  per = 0.0331  per(accum) = 98.3
 T(local oper_env: qops_pool join and erase     ) = 1.484e-03 S  per = 1.68  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.660e-07 S  per = 0.000869  per(accum) = 100
##### sweep oper_env: 3.798e+00 S #####
 T(sweep oper_env: fetch) = 9.214e-02 S  per = 2.43  per(accum) = 2.43
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.43
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.43
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.43
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.43
 T(sweep oper_env: renrm) = 3.705e+00 S  per = 97.5  per(accum) = 100
 T(sweep oper_env: save ) = 1.309e-03 S  per = 0.0345  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+10 S  per = -1.737e+32
 T(sweep oper_env: preprocess                  ) = -1.737e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.705e+00 S  T(sum) = 3.705e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.025e-04 S  per = 0.00277  per(accum) = 0.00277
 T(sweep oper_env: qops init                    ) = 8.001e-03 S  per = 0.216  per(accum) = 0.219
 T(sweep oper_env: symbolic_formulae_renorm     ) = 6.721e-03 S  per = 0.181  per(accum) = 0.4
 T(sweep oper_env: allocate qops on gpu         ) = 7.146e-04 S  per = 0.0193  per(accum) = 0.419
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.029e-02 S  per = 0.278  per(accum) = 0.697
 T(sweep oper_env: rintermediate init           ) = 2.257e-02 S  per = 0.609  per(accum) = 1.31
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.150e-02 S  per = 0.85  per(accum) = 2.16
 T(sweep oper_env: rmmtasks init                ) = 1.908e-02 S  per = 0.515  per(accum) = 2.67
 T(sweep oper_env: qops memset on cpu           ) = 3.260e-07 S  per = 8.8e-06  per(accum) = 2.67
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.721e-01 S  per =   10  per(accum) = 12.7
 T(sweep oper_env: deallocate cpu and gpu memory) = 3.901e-04 S  per = 0.0105  per(accum) = 12.7
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.134e+00 S  per = 84.6  per(accum) = 97.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.520e-02 S  per = 0.68  per(accum) = 98
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 8.857e-04 S  per = 0.0239  per(accum) = 98
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.106e-04 S  per = 0.00568  per(accum) = 98
 T(sweep oper_env: qops_pool join and erase     ) = 1.317e-02 S  per = 0.355  per(accum) = 98.4
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.997e-02 S  per = 1.62  per(accum) = 100

idx=11 coord=(8,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:11 S:4 P:40 Q:46 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=233:0.00178MB:1.74e-06GB
        per(mem): H:1.29 C:0 S:0 P:0 Q:98.7 
ctns::oper_renorm coord=(8,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:12 S:3 P:31 Q:36 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=183:0.0014MB:1.36e-06GB
        per(mem): H:1.64 C:0 S:0 P:0 Q:98.4 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.819e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=80 : 2.426e-03 S -----
rank=0 GPUmem(GB): used=1.054e-05 (oper)=1.054e-05
rank=0 GPUmem(GB): used=1.056e-05 (oper,site)=1.054e-05,2.235e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=80
 no. of rintermediate operators=103
 no. of coefficients=1133:8.644e-03MB:8.442e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.482e-03 S -----
rank=0 GPUmem(GB): used=1.900e-05 (oper,site,rinter)=1.054e-05,2.235e-08,8.442e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 3.252e-03 S size(rtasks)=80 size(Rlst2)=9 T(Rmu/Rlist)=5.769e-04,2.675e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.305e-03 S size(rtasks)=80 size(Rlst)=252 -----
rank=0 GPUmem(GB): used=1.900e-05 avail=6.231e+00 total=6.231e+00 batch[need]=5.633e-06 blksize=1 blksize0=0 batchsize=252
rank=0 GPUmem(GB): used=2.463e-05 (oper,site,rinter,batch)=1.054e-05,2.235e-08,8.442e-06,5.633e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.223e-06,1.886e-02,1.477e-03
----- TIMING FOR renorm : t_inter=8.0e-06 t_gemm=1.9e-02 t_reduction=1.5e-03 tot=2.0e-02 -----
 renorm[inter] counter=81 t=8.0e-06 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=81 i=0 t=1.5e-06 per=7.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=81 i=1 t=1.2e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=81 i=2 t=5.3e-03 per=2.6e+01 cost=1.2e+01 flops=2.3e+03
 renorm[gemm] counter=81 i=3 t=7.6e-03 per=3.8e+01 cost=3.7e+02 flops=4.9e+04
 renorm[gemm] counter=81 i=4 t=1.2e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=81 i=5 t=1.1e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=81 i=6 t=5.9e-03 per=2.9e+01 cost=5.0e+02 flops=8.5e+04
 renorm[gemm] counter=81 total t=1.9e-02 per=9.3e+01 cost=8.9e+02 flops=4.7e+04
 renorm[red] counter=81 t=1.5e-03 per=7.3e+00 cost=5.0e+02 flops=3.4e+05
----- TIMING FOR renorm_tot : t_inter=7.1e-02 t_gemm=2.3e-01 t_reduction=9.2e-02 tot=3.9e-01 -----
 renorm_tot[inter] counter=81 t=7.1e-02 per=1.8e+01 cost=1.8e+04 flops=2.6e+05
 renorm_tot[gemm] counter=81 i=0 t=1.7e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=81 i=1 t=1.3e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=81 i=2 t=7.6e-02 per=1.9e+01 cost=1.3e+03 flops=1.7e+04
 renorm_tot[gemm] counter=81 i=3 t=7.7e-02 per=2.0e+01 cost=6.8e+03 flops=8.8e+04
 renorm_tot[gemm] counter=81 i=4 t=1.3e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=81 i=5 t=1.3e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=81 i=6 t=7.5e-02 per=1.9e+01 cost=8.6e+03 flops=1.2e+05
 renorm_tot[gemm] counter=81 total t=2.3e-01 per=5.8e+01 cost=1.7e+04 flops=7.3e+04
 renorm_tot[red] counter=81 t=9.2e-02 per=2.3e+01 cost=7.5e+03 flops=8.2e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 2.3e-03 S rank=0 -----
qops.to_cpu: size(tot)=183:1.4e-03MB:1.4e-06GB T(to_cpu)=1.2e-04S speed=1.2e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.0353 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=7.629e-06 change=2.065e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=7.629e-06 change=-1.107e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 4.486e-02 S #####
 T(local oper_env: fetch) = 8.107e-03 S  per = 18.1  per(accum) = 18.1
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 18.1
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 18.1
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 18.1
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 18.1
 T(local oper_env: renrm) = 3.664e-02 S  per = 81.7  per(accum) = 99.7
 T(local oper_env: save ) = 1.197e-04 S  per = 0.267  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.664e-02 S  T(sum) = 3.664e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.293e-06 S  per = 0.0254  per(accum) = 0.0254
 T(local oper_env: qops init                    ) = 9.803e-04 S  per = 2.68  per(accum) = 2.7
 T(local oper_env: symbolic_formulae_renorm     ) = 2.439e-03 S  per = 6.66  per(accum) = 9.36
 T(local oper_env: allocate qops on gpu         ) = 6.121e-05 S  per = 0.167  per(accum) = 9.53
 T(local oper_env: site memcpy cpu2gpu          ) = 1.333e-03 S  per = 3.64  per(accum) = 13.2
 T(local oper_env: rintermediate init           ) = 2.497e-03 S  per = 6.82  per(accum) = 20
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.318e-03 S  per = 9.06  per(accum) = 29
 T(local oper_env: rmmtasks init                ) = 1.354e-03 S  per =  3.7  per(accum) = 32.7
 T(local oper_env: qops memset on cpu           ) = 5.600e-08 S  per = 0.000153  per(accum) = 32.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.051e-02 S  per =   56  per(accum) = 88.7
 T(local oper_env: deallocate cpu and gpu memory) = 2.797e-05 S  per = 0.0764  per(accum) = 88.8
 T(local oper_env: construct opS [ifdists=true] ) = 2.290e-03 S  per = 6.25  per(accum) = 95
 T(local oper_env: reduction of opS & opH [nccl]) = 3.429e-04 S  per = 0.936  per(accum) = 96
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.308e-04 S  per = 0.357  per(accum) = 96.3
 T(local oper_env: reduction of opS & opH [mpi] ) = 3.072e-05 S  per = 0.0838  per(accum) = 96.4
 T(local oper_env: qops_pool join and erase     ) = 1.310e-03 S  per = 3.58  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.120e-07 S  per = 0.00194  per(accum) = 100
##### sweep oper_env: 3.843e+00 S #####
 T(sweep oper_env: fetch) = 1.002e-01 S  per = 2.61  per(accum) = 2.61
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.61
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.61
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.61
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.61
 T(sweep oper_env: renrm) = 3.742e+00 S  per = 97.4  per(accum) = 100
 T(sweep oper_env: save ) = 1.428e-03 S  per = 0.0372  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.910e+10 S  per = -1.910e+32
 T(sweep oper_env: preprocess                  ) = -1.910e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.742e+00 S  T(sum) = 3.742e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.118e-04 S  per = 0.00299  per(accum) = 0.00299
 T(sweep oper_env: qops init                    ) = 8.982e-03 S  per = 0.24  per(accum) = 0.243
 T(sweep oper_env: symbolic_formulae_renorm     ) = 9.161e-03 S  per = 0.245  per(accum) = 0.488
 T(sweep oper_env: allocate qops on gpu         ) = 7.759e-04 S  per = 0.0207  per(accum) = 0.509
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.162e-02 S  per = 0.311  per(accum) = 0.819
 T(sweep oper_env: rintermediate init           ) = 2.506e-02 S  per = 0.67  per(accum) = 1.49
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.482e-02 S  per = 0.931  per(accum) = 2.42
 T(sweep oper_env: rmmtasks init                ) = 2.044e-02 S  per = 0.546  per(accum) = 2.97
 T(sweep oper_env: qops memset on cpu           ) = 3.820e-07 S  per = 1.02e-05  per(accum) = 2.97
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.926e-01 S  per = 10.5  per(accum) = 13.5
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.181e-04 S  per = 0.0112  per(accum) = 13.5
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.136e+00 S  per = 83.8  per(accum) = 97.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.554e-02 S  per = 0.683  per(accum) = 98
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.017e-03 S  per = 0.0272  per(accum) = 98
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.413e-04 S  per = 0.00645  per(accum) = 98
 T(sweep oper_env: qops_pool join and erase     ) = 1.448e-02 S  per = 0.387  per(accum) = 98.4
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.997e-02 S  per =  1.6  per(accum) = 100

idx=12 coord=(7,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:12 S:3 P:31 Q:36 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=183:0.0014MB:1.36e-06GB
        per(mem): H:1.64 C:0 S:0 P:0 Q:98.4 
ctns::oper_renorm coord=(7,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:13 S:3 P:27 Q:26 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=133:0.00101MB:9.91e-07GB
        per(mem): H:2.26 C:0 S:0 P:0 Q:97.7 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.682e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=67 : 2.013e-03 S -----
rank=0 GPUmem(GB): used=9.790e-06 (oper)=9.790e-06
rank=0 GPUmem(GB): used=9.812e-06 (oper,site)=9.790e-06,2.235e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=67
 no. of rintermediate operators=79
 no. of coefficients=948:7.233e-03MB:7.063e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.482e-03 S -----
rank=0 GPUmem(GB): used=1.688e-05 (oper,site,rinter)=9.790e-06,2.235e-08,7.063e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.445e-03 S size(rtasks)=67 size(Rlst2)=9 T(Rmu/Rlist)=4.536e-04,1.991e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.490e-03 S size(rtasks)=67 size(Rlst)=181 -----
rank=0 GPUmem(GB): used=1.688e-05 avail=6.231e+00 total=6.231e+00 batch[need]=4.046e-06 blksize=1 blksize0=0 batchsize=181
rank=0 GPUmem(GB): used=2.092e-05 (oper,site,rinter,batch)=9.790e-06,2.235e-08,7.063e-06,4.046e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.693e-06,2.139e-02,9.964e-03
----- TIMING FOR renorm : t_inter=7.5e-06 t_gemm=2.1e-02 t_reduction=1.0e-02 tot=3.1e-02 -----
 renorm[inter] counter=82 t=7.5e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=82 i=0 t=1.6e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=82 i=1 t=1.3e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=82 i=2 t=6.4e-03 per=2.0e+01 cost=6.0e+00 flops=9.4e+02
 renorm[gemm] counter=82 i=3 t=7.5e-03 per=2.4e+01 cost=2.7e+02 flops=3.5e+04
 renorm[gemm] counter=82 i=4 t=1.2e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=82 i=5 t=1.1e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=82 i=6 t=7.4e-03 per=2.4e+01 cost=3.6e+02 flops=4.9e+04
 renorm[gemm] counter=82 total t=2.1e-02 per=6.8e+01 cost=6.3e+02 flops=3.0e+04
 renorm[red] counter=82 t=1.0e-02 per=3.2e+01 cost=3.6e+02 flops=3.6e+04
----- TIMING FOR renorm_tot : t_inter=7.1e-02 t_gemm=2.5e-01 t_reduction=1.0e-01 tot=4.2e-01 -----
 renorm_tot[inter] counter=82 t=7.1e-02 per=1.7e+01 cost=1.8e+04 flops=2.6e+05
 renorm_tot[gemm] counter=82 i=0 t=1.9e-05 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=82 i=1 t=1.5e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=82 i=2 t=8.2e-02 per=2.0e+01 cost=1.3e+03 flops=1.5e+04
 renorm_tot[gemm] counter=82 i=3 t=8.4e-02 per=2.0e+01 cost=7.0e+03 flops=8.3e+04
 renorm_tot[gemm] counter=82 i=4 t=1.5e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=82 i=5 t=1.4e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=82 i=6 t=8.2e-02 per=1.9e+01 cost=9.0e+03 flops=1.1e+05
 renorm_tot[gemm] counter=82 total t=2.5e-01 per=5.9e+01 cost=1.7e+04 flops=7.0e+04
 renorm_tot[red] counter=82 t=1.0e-01 per=2.4e+01 cost=7.9e+03 flops=7.8e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 7.2e-03 S rank=0 -----
qops.to_cpu: size(tot)=133:1.0e-03MB:9.9e-07GB T(to_cpu)=9.6e-05S speed=1.0e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.0524 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.667e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=3.815e-05 change=-1.047e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 6.184e-02 S #####
 T(local oper_env: fetch) = 8.069e-03 S  per =   13  per(accum) = 13
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 13
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 13
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 13
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 13
 T(local oper_env: renrm) = 5.365e-02 S  per = 86.8  per(accum) = 99.8
 T(local oper_env: save ) = 1.213e-04 S  per = 0.196  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.365e-02 S  T(sum) = 5.365e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.091e-06 S  per = 0.0169  per(accum) = 0.0169
 T(local oper_env: qops init                    ) = 8.273e-04 S  per = 1.54  per(accum) = 1.56
 T(local oper_env: symbolic_formulae_renorm     ) = 2.025e-03 S  per = 3.78  per(accum) = 5.33
 T(local oper_env: allocate qops on gpu         ) = 4.528e-05 S  per = 0.0844  per(accum) = 5.42
 T(local oper_env: site memcpy cpu2gpu          ) = 2.106e-03 S  per = 3.93  per(accum) = 9.34
 T(local oper_env: rintermediate init           ) = 2.498e-03 S  per = 4.65  per(accum) = 14
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.532e-03 S  per = 4.72  per(accum) = 18.7
 T(local oper_env: rmmtasks init                ) = 9.914e-04 S  per = 1.85  per(accum) = 20.6
 T(local oper_env: qops memset on cpu           ) = 3.000e-08 S  per = 5.59e-05  per(accum) = 20.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.152e-02 S  per = 58.8  per(accum) = 79.3
 T(local oper_env: deallocate cpu and gpu memory) = 2.332e-05 S  per = 0.0435  per(accum) = 79.4
 T(local oper_env: construct opS [ifdists=true] ) = 7.237e-03 S  per = 13.5  per(accum) = 92.9
 T(local oper_env: reduction of opS & opH [nccl]) = 2.478e-03 S  per = 4.62  per(accum) = 97.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.094e-04 S  per = 0.204  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.922e-05 S  per = 0.0545  per(accum) = 97.7
 T(local oper_env: qops_pool join and erase     ) = 1.218e-03 S  per = 2.27  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.180e-07 S  per = 0.00134  per(accum) = 100
##### sweep oper_env: 3.905e+00 S #####
 T(sweep oper_env: fetch) = 1.083e-01 S  per = 2.77  per(accum) = 2.77
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.77
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.77
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.77
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.77
 T(sweep oper_env: renrm) = 3.795e+00 S  per = 97.2  per(accum) = 100
 T(sweep oper_env: save ) = 1.550e-03 S  per = 0.0397  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.084e+10 S  per = -2.084e+32
 T(sweep oper_env: preprocess                  ) = -2.084e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.795e+00 S  T(sum) = 3.795e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.209e-04 S  per = 0.00319  per(accum) = 0.00319
 T(sweep oper_env: qops init                    ) = 9.809e-03 S  per = 0.258  per(accum) = 0.262
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.119e-02 S  per = 0.295  per(accum) = 0.556
 T(sweep oper_env: allocate qops on gpu         ) = 8.211e-04 S  per = 0.0216  per(accum) = 0.578
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.372e-02 S  per = 0.362  per(accum) = 0.94
 T(sweep oper_env: rintermediate init           ) = 2.756e-02 S  per = 0.726  per(accum) = 1.67
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.735e-02 S  per = 0.984  per(accum) = 2.65
 T(sweep oper_env: rmmtasks init                ) = 2.143e-02 S  per = 0.565  per(accum) = 3.21
 T(sweep oper_env: qops memset on cpu           ) = 4.120e-07 S  per = 1.09e-05  per(accum) = 3.21
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.242e-01 S  per = 11.2  per(accum) = 14.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.414e-04 S  per = 0.0116  per(accum) = 14.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.143e+00 S  per = 82.8  per(accum) = 97.2
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.802e-02 S  per = 0.738  per(accum) = 98
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.126e-03 S  per = 0.0297  per(accum) = 98
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.705e-04 S  per = 0.00713  per(accum) = 98
 T(sweep oper_env: qops_pool join and erase     ) = 1.570e-02 S  per = 0.414  per(accum) = 98.4
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.997e-02 S  per = 1.58  per(accum) = 100

idx=13 coord=(6,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:13 S:3 P:27 Q:26 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=133:0.00101MB:9.91e-07GB
        per(mem): H:2.26 C:0 S:0 P:0 Q:97.7 
ctns::oper_renorm coord=(6,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:14 S:2 P:18 Q:20 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=103:0.000786MB:7.67e-07GB
        per(mem): H:2.91 C:0 S:0 P:0 Q:97.1 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.530e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=53 : 1.584e-03 S -----
rank=0 GPUmem(GB): used=9.194e-06 (oper)=9.194e-06
rank=0 GPUmem(GB): used=9.231e-06 (oper,site)=9.194e-06,3.725e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=53
 no. of rintermediate operators=58
 no. of coefficients=754:5.753e-03MB:5.618e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.444e-03 S -----
rank=0 GPUmem(GB): used=1.485e-05 (oper,site,rinter)=9.194e-06,3.725e-08,5.618e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 3.801e-03 S size(rtasks)=53 size(Rlst2)=9 T(Rmu/Rlist)=3.509e-04,3.450e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.878e-03 S size(rtasks)=53 size(Rlst)=410 -----
rank=0 GPUmem(GB): used=1.485e-05 avail=6.231e+00 total=6.231e+00 batch[need]=9.164e-06 blksize=1 blksize0=0 batchsize=410
rank=0 GPUmem(GB): used=2.401e-05 (oper,site,rinter,batch)=9.194e-06,3.725e-08,5.618e-06,9.164e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.897e-06,2.101e-02,9.819e-03
----- TIMING FOR renorm : t_inter=7.6e-06 t_gemm=2.1e-02 t_reduction=9.8e-03 tot=3.1e-02 -----
 renorm[inter] counter=83 t=7.6e-06 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=83 i=0 t=1.6e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=83 i=1 t=1.2e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=83 i=2 t=6.2e-03 per=2.0e+01 cost=2.0e+01 flops=3.3e+03
 renorm[gemm] counter=83 i=3 t=7.5e-03 per=2.4e+01 cost=5.0e+02 flops=6.7e+04
 renorm[gemm] counter=83 i=4 t=1.2e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=83 i=5 t=1.1e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=83 i=6 t=7.4e-03 per=2.4e+01 cost=8.2e+02 flops=1.1e+05
 renorm[gemm] counter=83 total t=2.1e-02 per=6.8e+01 cost=1.3e+03 flops=6.4e+04
 renorm[red] counter=83 t=9.8e-03 per=3.2e+01 cost=8.2e+02 flops=8.4e+04
----- TIMING FOR renorm_tot : t_inter=7.1e-02 t_gemm=2.7e-01 t_reduction=1.1e-01 tot=4.5e-01 -----
 renorm_tot[inter] counter=83 t=7.1e-02 per=1.6e+01 cost=1.8e+04 flops=2.6e+05
 renorm_tot[gemm] counter=83 i=0 t=2.0e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=83 i=1 t=1.6e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=83 i=2 t=8.9e-02 per=2.0e+01 cost=1.3e+03 flops=1.5e+04
 renorm_tot[gemm] counter=83 i=3 t=9.2e-02 per=2.0e+01 cost=7.5e+03 flops=8.2e+04
 renorm_tot[gemm] counter=83 i=4 t=1.6e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=83 i=5 t=1.5e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=83 i=6 t=9.0e-02 per=2.0e+01 cost=9.8e+03 flops=1.1e+05
 renorm_tot[gemm] counter=83 total t=2.7e-01 per=6.0e+01 cost=1.9e+04 flops=6.9e+04
 renorm_tot[red] counter=83 t=1.1e-01 per=2.5e+01 cost=8.7e+03 flops=7.8e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 4.7e-03 S rank=0 -----
qops.to_cpu: size(tot)=103:7.9e-04MB:7.7e-07GB T(to_cpu)=8.0e-05S speed=9.6e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.0512 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.917e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.058e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 6.059e-02 S #####
 T(local oper_env: fetch) = 8.123e-03 S  per = 13.4  per(accum) = 13.4
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 13.4
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 13.4
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 13.4
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 13.4
 T(local oper_env: renrm) = 5.234e-02 S  per = 86.4  per(accum) = 99.8
 T(local oper_env: save ) = 1.256e-04 S  per = 0.207  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.234e-02 S  T(sum) = 5.234e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.153e-06 S  per = 0.0175  per(accum) = 0.0175
 T(local oper_env: qops init                    ) = 6.852e-04 S  per = 1.31  per(accum) = 1.33
 T(local oper_env: symbolic_formulae_renorm     ) = 1.596e-03 S  per = 3.05  per(accum) = 4.38
 T(local oper_env: allocate qops on gpu         ) = 4.443e-05 S  per = 0.0849  per(accum) = 4.46
 T(local oper_env: site memcpy cpu2gpu          ) = 8.242e-04 S  per = 1.57  per(accum) = 6.04
 T(local oper_env: rintermediate init           ) = 2.459e-03 S  per =  4.7  per(accum) = 10.7
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.899e-03 S  per = 7.45  per(accum) = 18.2
 T(local oper_env: rmmtasks init                ) = 1.938e-03 S  per =  3.7  per(accum) = 21.9
 T(local oper_env: qops memset on cpu           ) = 3.100e-08 S  per = 5.92e-05  per(accum) = 21.9
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.104e-02 S  per = 59.3  per(accum) = 81.2
 T(local oper_env: deallocate cpu and gpu memory) = 3.165e-05 S  per = 0.0605  per(accum) = 81.2
 T(local oper_env: construct opS [ifdists=true] ) = 4.693e-03 S  per = 8.97  per(accum) = 90.2
 T(local oper_env: reduction of opS & opH [nccl]) = 3.823e-03 S  per =  7.3  per(accum) = 97.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 9.201e-05 S  per = 0.176  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.824e-05 S  per = 0.0539  per(accum) = 97.7
 T(local oper_env: qops_pool join and erase     ) = 1.179e-03 S  per = 2.25  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.760e-07 S  per = 0.00129  per(accum) = 100
##### sweep oper_env: 3.966e+00 S #####
 T(sweep oper_env: fetch) = 1.164e-01 S  per = 2.94  per(accum) = 2.94
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.94
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.94
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.94
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.94
 T(sweep oper_env: renrm) = 3.848e+00 S  per =   97  per(accum) = 100
 T(sweep oper_env: save ) = 1.675e-03 S  per = 0.0422  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.258e+10 S  per = -2.258e+32
 T(sweep oper_env: preprocess                  ) = -2.258e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.848e+00 S  T(sum) = 3.848e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.300e-04 S  per = 0.00338  per(accum) = 0.00338
 T(sweep oper_env: qops init                    ) = 1.049e-02 S  per = 0.273  per(accum) = 0.276
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.278e-02 S  per = 0.332  per(accum) = 0.608
 T(sweep oper_env: allocate qops on gpu         ) = 8.656e-04 S  per = 0.0225  per(accum) = 0.631
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.455e-02 S  per = 0.378  per(accum) = 1.01
 T(sweep oper_env: rintermediate init           ) = 3.002e-02 S  per = 0.78  per(accum) = 1.79
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.125e-02 S  per = 1.07  per(accum) = 2.86
 T(sweep oper_env: rmmtasks init                ) = 2.337e-02 S  per = 0.607  per(accum) = 3.47
 T(sweep oper_env: qops memset on cpu           ) = 4.430e-07 S  per = 1.15e-05  per(accum) = 3.47
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.552e-01 S  per = 11.8  per(accum) = 15.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.731e-04 S  per = 0.0123  per(accum) = 15.3
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.148e+00 S  per = 81.8  per(accum) = 97.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.184e-02 S  per = 0.828  per(accum) = 98
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.218e-03 S  per = 0.0317  per(accum) = 98
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.988e-04 S  per = 0.00777  per(accum) = 98
 T(sweep oper_env: qops_pool join and erase     ) = 1.688e-02 S  per = 0.439  per(accum) = 98.4
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.997e-02 S  per = 1.56  per(accum) = 100

idx=14 coord=(5,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:14 S:2 P:18 Q:20 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=103:0.000786MB:7.67e-07GB
        per(mem): H:2.91 C:0 S:0 P:0 Q:97.1 
ctns::oper_renorm coord=(5,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:15 S:2 P:12 Q:16 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=83:0.000633MB:6.18e-07GB
        per(mem): H:3.61 C:0 S:0 P:0 Q:96.4 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.436e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=44 : 1.258e-03 S -----
rank=0 GPUmem(GB): used=8.821e-06 (oper)=8.821e-06
rank=0 GPUmem(GB): used=8.859e-06 (oper,site)=8.821e-06,3.725e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=44
 no. of rintermediate operators=44
 no. of coefficients=616:4.700e-03MB:4.590e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.507e-03 S -----
rank=0 GPUmem(GB): used=1.345e-05 (oper,site,rinter)=8.821e-06,3.725e-08,4.590e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 3.199e-03 S size(rtasks)=44 size(Rlst2)=9 T(Rmu/Rlist)=2.705e-04,2.929e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.270e-03 S size(rtasks)=44 size(Rlst)=342 -----
rank=0 GPUmem(GB): used=1.345e-05 avail=6.231e+00 total=6.231e+00 batch[need]=7.644e-06 blksize=1 blksize0=0 batchsize=342
rank=0 GPUmem(GB): used=2.109e-05 (oper,site,rinter,batch)=8.821e-06,3.725e-08,4.590e-06,7.644e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.053e-06,2.206e-02,1.003e-02
----- TIMING FOR renorm : t_inter=7.8e-06 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.2e-02 -----
 renorm[inter] counter=84 t=7.8e-06 per=2.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=84 i=0 t=1.6e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=84 i=1 t=1.2e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=84 i=2 t=7.0e-03 per=2.2e+01 cost=2.8e+01 flops=4.0e+03
 renorm[gemm] counter=84 i=3 t=7.5e-03 per=2.3e+01 cost=4.1e+02 flops=5.5e+04
 renorm[gemm] counter=84 i=4 t=1.2e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=84 i=5 t=1.1e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=84 i=6 t=7.5e-03 per=2.3e+01 cost=6.8e+02 flops=9.1e+04
 renorm[gemm] counter=84 total t=2.2e-02 per=6.9e+01 cost=1.1e+03 flops=5.1e+04
 renorm[red] counter=84 t=1.0e-02 per=3.1e+01 cost=6.8e+02 flops=6.8e+04
----- TIMING FOR renorm_tot : t_inter=7.1e-02 t_gemm=2.9e-01 t_reduction=1.2e-01 tot=4.9e-01 -----
 renorm_tot[inter] counter=84 t=7.1e-02 per=1.5e+01 cost=1.8e+04 flops=2.6e+05
 renorm_tot[gemm] counter=84 i=0 t=2.2e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=84 i=1 t=1.7e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=84 i=2 t=9.6e-02 per=2.0e+01 cost=1.3e+03 flops=1.4e+04
 renorm_tot[gemm] counter=84 i=3 t=9.9e-02 per=2.0e+01 cost=8.0e+03 flops=8.0e+04
 renorm_tot[gemm] counter=84 i=4 t=1.7e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=84 i=5 t=1.6e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=84 i=6 t=9.7e-02 per=2.0e+01 cost=1.1e+04 flops=1.1e+05
 renorm_tot[gemm] counter=84 total t=2.9e-01 per=6.0e+01 cost=2.0e+04 flops=6.8e+04
 renorm_tot[red] counter=84 t=1.2e-01 per=2.5e+01 cost=9.4e+03 flops=7.7e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 4.7e-03 S rank=0 -----
qops.to_cpu: size(tot)=83:6.3e-04MB:6.2e-07GB T(to_cpu)=6.9e-05S speed=9.0e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.0549 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=2.289e-05 change=1.562e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=2.289e-05 change=-1.007e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 6.441e-02 S #####
 T(local oper_env: fetch) = 8.161e-03 S  per = 12.7  per(accum) = 12.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 12.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 12.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 12.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 12.7
 T(local oper_env: renrm) = 5.612e-02 S  per = 87.1  per(accum) = 99.8
 T(local oper_env: save ) = 1.287e-04 S  per =  0.2  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.612e-02 S  T(sum) = 5.612e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.482e-06 S  per = 0.0169  per(accum) = 0.0169
 T(local oper_env: qops init                    ) = 5.891e-04 S  per = 1.05  per(accum) = 1.07
 T(local oper_env: symbolic_formulae_renorm     ) = 1.270e-03 S  per = 2.26  per(accum) = 3.33
 T(local oper_env: allocate qops on gpu         ) = 4.338e-05 S  per = 0.0773  per(accum) = 3.41
 T(local oper_env: site memcpy cpu2gpu          ) = 1.308e-03 S  per = 2.33  per(accum) = 5.74
 T(local oper_env: rintermediate init           ) = 2.522e-03 S  per = 4.49  per(accum) = 10.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.289e-03 S  per = 5.86  per(accum) = 16.1
 T(local oper_env: rmmtasks init                ) = 1.677e-03 S  per = 2.99  per(accum) = 19.1
 T(local oper_env: qops memset on cpu           ) = 2.200e-08 S  per = 3.92e-05  per(accum) = 19.1
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.228e-02 S  per = 57.5  per(accum) = 76.6
 T(local oper_env: deallocate cpu and gpu memory) = 3.164e-05 S  per = 0.0564  per(accum) = 76.6
 T(local oper_env: construct opS [ifdists=true] ) = 4.796e-03 S  per = 8.55  per(accum) = 85.2
 T(local oper_env: reduction of opS & opH [nccl]) = 7.018e-03 S  per = 12.5  per(accum) = 97.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.191e-05 S  per = 0.146  per(accum) = 97.8
 T(local oper_env: reduction of opS & opH [mpi] ) = 2.943e-05 S  per = 0.0524  per(accum) = 97.9
 T(local oper_env: qops_pool join and erase     ) = 1.180e-03 S  per =  2.1  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.520e-07 S  per = 0.00134  per(accum) = 100
##### sweep oper_env: 4.030e+00 S #####
 T(sweep oper_env: fetch) = 1.246e-01 S  per = 3.09  per(accum) = 3.09
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 3.09
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 3.09
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 3.09
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 3.09
 T(sweep oper_env: renrm) = 3.904e+00 S  per = 96.9  per(accum) = 100
 T(sweep oper_env: save ) = 1.804e-03 S  per = 0.0448  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.431e+10 S  per = -2.431e+32
 T(sweep oper_env: preprocess                  ) = -2.431e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.904e+00 S  T(sum) = 3.904e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.395e-04 S  per = 0.00357  per(accum) = 0.00357
 T(sweep oper_env: qops init                    ) = 1.108e-02 S  per = 0.284  per(accum) = 0.287
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.405e-02 S  per = 0.36  per(accum) = 0.647
 T(sweep oper_env: allocate qops on gpu         ) = 9.089e-04 S  per = 0.0233  per(accum) = 0.671
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.586e-02 S  per = 0.406  per(accum) = 1.08
 T(sweep oper_env: rintermediate init           ) = 3.254e-02 S  per = 0.834  per(accum) = 1.91
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.454e-02 S  per = 1.14  per(accum) = 3.05
 T(sweep oper_env: rmmtasks init                ) = 2.504e-02 S  per = 0.642  per(accum) = 3.69
 T(sweep oper_env: qops memset on cpu           ) = 4.650e-07 S  per = 1.19e-05  per(accum) = 3.69
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.875e-01 S  per = 12.5  per(accum) = 16.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.047e-04 S  per = 0.0129  per(accum) = 16.2
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.153e+00 S  per = 80.8  per(accum) = 97
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.886e-02 S  per = 0.995  per(accum) = 98
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.300e-03 S  per = 0.0333  per(accum) = 98
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 3.282e-04 S  per = 0.00841  per(accum) = 98
 T(sweep oper_env: qops_pool join and erase     ) = 1.806e-02 S  per = 0.463  per(accum) = 98.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.997e-02 S  per = 1.54  per(accum) = 100

idx=15 coord=(4,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:15 S:2 P:12 Q:16 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=83:0.000633MB:6.18e-07GB
        per(mem): H:3.61 C:0 S:0 P:0 Q:96.4 
ctns::oper_renorm coord=(4,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:16 S:2 P:8 Q:10 
        dim(bra,ket)=4,4 size(op)=10:7.63e-05MB size(tot)=74:0.000565MB:5.51e-07GB
        per(mem): H:5.41 C:0 S:0 P:0 Q:94.6 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.489e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=35 : 9.317e-04 S -----
rank=0 GPUmem(GB): used=8.605e-06 (oper)=8.605e-06
rank=0 GPUmem(GB): used=8.650e-06 (oper,site)=8.605e-06,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=35
 no. of rintermediate operators=28
 no. of coefficients=420:3.204e-03MB:3.129e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.448e-03 S -----
rank=0 GPUmem(GB): used=1.178e-05 (oper,site,rinter)=8.605e-06,4.470e-08,3.129e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.927e-03 S size(rtasks)=35 size(Rlst2)=16 T(Rmu/Rlist)=1.967e-04,2.731e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.972e-03 S size(rtasks)=35 size(Rlst)=296 -----
rank=0 GPUmem(GB): used=1.178e-05 avail=6.231e+00 total=6.231e+00 batch[need]=6.616e-06 blksize=1 blksize0=0 batchsize=296
rank=0 GPUmem(GB): used=1.840e-05 (oper,site,rinter,batch)=8.605e-06,4.470e-08,3.129e-06,6.616e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.801e-06,2.024e-02,9.921e-03
----- TIMING FOR renorm : t_inter=7.5e-06 t_gemm=2.0e-02 t_reduction=9.9e-03 tot=3.0e-02 -----
 renorm[inter] counter=85 t=7.5e-06 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=85 i=0 t=1.5e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=85 i=1 t=1.2e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=85 i=2 t=5.4e-03 per=1.8e+01 cost=4.4e+01 flops=8.1e+03
 renorm[gemm] counter=85 i=3 t=7.4e-03 per=2.5e+01 cost=3.4e+02 flops=4.6e+04
 renorm[gemm] counter=85 i=4 t=1.1e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=85 i=5 t=1.1e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=85 i=6 t=7.4e-03 per=2.5e+01 cost=5.9e+02 flops=8.0e+04
 renorm[gemm] counter=85 total t=2.0e-02 per=6.7e+01 cost=9.8e+02 flops=4.8e+04
 renorm[red] counter=85 t=9.9e-03 per=3.3e+01 cost=5.9e+02 flops=6.0e+04
----- TIMING FOR renorm_tot : t_inter=7.1e-02 t_gemm=3.1e-01 t_reduction=1.3e-01 tot=5.2e-01 -----
 renorm_tot[inter] counter=85 t=7.1e-02 per=1.4e+01 cost=1.8e+04 flops=2.6e+05
 renorm_tot[gemm] counter=85 i=0 t=2.3e-05 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=85 i=1 t=1.8e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=85 i=2 t=1.0e-01 per=2.0e+01 cost=1.4e+03 flops=1.4e+04
 renorm_tot[gemm] counter=85 i=3 t=1.1e-01 per=2.1e+01 cost=8.3e+03 flops=7.8e+04
 renorm_tot[gemm] counter=85 i=4 t=1.8e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=85 i=5 t=1.7e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=85 i=6 t=1.0e-01 per=2.0e+01 cost=1.1e+04 flops=1.1e+05
 renorm_tot[gemm] counter=85 total t=3.1e-01 per=6.1e+01 cost=2.1e+04 flops=6.6e+04
 renorm_tot[red] counter=85 t=1.3e-01 per=2.6e+01 cost=1.0e+04 flops=7.6e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 4.8e-03 S rank=0 -----
qops.to_cpu: size(tot)=74:5.6e-04MB:5.5e-07GB T(to_cpu)=5.6e-05S speed=9.9e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.0476 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.291e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.710e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 5.709e-02 S #####
 T(local oper_env: fetch) = 8.207e-03 S  per = 14.4  per(accum) = 14.4
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.4
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.4
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.4
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.4
 T(local oper_env: renrm) = 4.876e-02 S  per = 85.4  per(accum) = 99.8
 T(local oper_env: save ) = 1.241e-04 S  per = 0.217  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.876e-02 S  T(sum) = 4.876e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.096e-06 S  per = 0.0187  per(accum) = 0.0187
 T(local oper_env: qops init                    ) = 7.136e-04 S  per = 1.46  per(accum) = 1.48
 T(local oper_env: symbolic_formulae_renorm     ) = 9.439e-04 S  per = 1.94  per(accum) = 3.42
 T(local oper_env: allocate qops on gpu         ) = 6.776e-05 S  per = 0.139  per(accum) = 3.56
 T(local oper_env: site memcpy cpu2gpu          ) = 1.303e-03 S  per = 2.67  per(accum) = 6.23
 T(local oper_env: rintermediate init           ) = 2.463e-03 S  per = 5.05  per(accum) = 11.3
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.986e-03 S  per = 6.12  per(accum) = 17.4
 T(local oper_env: rmmtasks init                ) = 1.422e-03 S  per = 2.92  per(accum) = 20.3
 T(local oper_env: qops memset on cpu           ) = 2.800e-08 S  per = 5.74e-05  per(accum) = 20.3
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.028e-02 S  per = 62.1  per(accum) = 82.4
 T(local oper_env: deallocate cpu and gpu memory) = 3.047e-05 S  per = 0.0625  per(accum) = 82.5
 T(local oper_env: construct opS [ifdists=true] ) = 4.817e-03 S  per = 9.88  per(accum) = 92.4
 T(local oper_env: reduction of opS & opH [nccl]) = 2.482e-03 S  per = 5.09  per(accum) = 97.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 6.873e-05 S  per = 0.141  per(accum) = 97.6
 T(local oper_env: reduction of opS & opH [mpi] ) = 3.817e-05 S  per = 0.0783  per(accum) = 97.7
 T(local oper_env: qops_pool join and erase     ) = 1.127e-03 S  per = 2.31  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.550e-07 S  per = 0.00134  per(accum) = 100
##### sweep oper_env: 4.087e+00 S #####
 T(sweep oper_env: fetch) = 1.328e-01 S  per = 3.25  per(accum) = 3.25
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 3.25
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 3.25
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 3.25
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 3.25
 T(sweep oper_env: renrm) = 3.952e+00 S  per = 96.7  per(accum) = 100
 T(sweep oper_env: save ) = 1.928e-03 S  per = 0.0472  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.605e+10 S  per = -2.605e+32
 T(sweep oper_env: preprocess                  ) = -2.605e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.952e+00 S  T(sum) = 3.952e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.486e-04 S  per = 0.00376  per(accum) = 0.00376
 T(sweep oper_env: qops init                    ) = 1.180e-02 S  per = 0.298  per(accum) = 0.302
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.500e-02 S  per = 0.379  per(accum) = 0.682
 T(sweep oper_env: allocate qops on gpu         ) = 9.767e-04 S  per = 0.0247  per(accum) = 0.706
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.716e-02 S  per = 0.434  per(accum) = 1.14
 T(sweep oper_env: rintermediate init           ) = 3.501e-02 S  per = 0.886  per(accum) = 2.03
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 4.753e-02 S  per =  1.2  per(accum) = 3.23
 T(sweep oper_env: rmmtasks init                ) = 2.647e-02 S  per = 0.67  per(accum) = 3.9
 T(sweep oper_env: qops memset on cpu           ) = 4.930e-07 S  per = 1.25e-05  per(accum) = 3.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.178e-01 S  per = 13.1  per(accum) = 17
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.352e-04 S  per = 0.0135  per(accum) = 17
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.158e+00 S  per = 79.9  per(accum) = 96.9
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.134e-02 S  per = 1.05  per(accum) = 98
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.369e-03 S  per = 0.0346  per(accum) = 98
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 3.664e-04 S  per = 0.00927  per(accum) = 98
 T(sweep oper_env: qops_pool join and erase     ) = 1.918e-02 S  per = 0.485  per(accum) = 98.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.997e-02 S  per = 1.52  per(accum) = 100

idx=16 coord=(3,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:16 S:2 P:8 Q:10 
        dim(bra,ket)=4,4 size(op)=10:7.63e-05MB size(tot)=74:0.000565MB:5.51e-07GB
        per(mem): H:5.41 C:0 S:0 P:0 Q:94.6 
ctns::oper_renorm coord=(3,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:17 S:1 P:4 Q:7 
        dim(bra,ket)=5,5 size(op)=13:9.92e-05MB size(tot)=64:0.000488MB:4.77e-07GB
        per(mem): H:7.81 C:0 S:0 P:0 Q:92.2 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.561e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=29 : 6.479e-04 S -----
rank=0 GPUmem(GB): used=8.464e-06 (oper)=8.464e-06
rank=0 GPUmem(GB): used=8.523e-06 (oper,site)=8.464e-06,5.960e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=29
 no. of rintermediate operators=18
 no. of coefficients=288:2.197e-03MB:2.146e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.456e-03 S -----
rank=0 GPUmem(GB): used=1.067e-05 (oper,site,rinter)=8.464e-06,5.960e-08,2.146e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.960e-03 S size(rtasks)=29 size(Rlst2)=25 T(Rmu/Rlist)=1.407e-04,2.819e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.999e-03 S size(rtasks)=29 size(Rlst)=274 -----
rank=0 GPUmem(GB): used=1.067e-05 avail=6.231e+00 total=6.231e+00 batch[need]=6.124e-06 blksize=1 blksize0=0 batchsize=274
rank=0 GPUmem(GB): used=1.679e-05 (oper,site,rinter,batch)=8.464e-06,5.960e-08,2.146e-06,6.124e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.725e-06,2.066e-02,9.865e-03
----- TIMING FOR renorm : t_inter=7.5e-06 t_gemm=2.1e-02 t_reduction=9.9e-03 tot=3.1e-02 -----
 renorm[inter] counter=86 t=7.5e-06 per=2.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=86 i=0 t=1.6e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=86 i=1 t=1.2e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=86 i=2 t=5.6e-03 per=1.8e+01 cost=4.4e+01 flops=7.9e+03
 renorm[gemm] counter=86 i=3 t=7.6e-03 per=2.5e+01 cost=3.1e+02 flops=4.1e+04
 renorm[gemm] counter=86 i=4 t=1.2e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=86 i=5 t=1.1e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=86 i=6 t=7.5e-03 per=2.5e+01 cost=5.5e+02 flops=7.3e+04
 renorm[gemm] counter=86 total t=2.1e-02 per=6.8e+01 cost=9.0e+02 flops=4.4e+04
 renorm[red] counter=86 t=9.9e-03 per=3.2e+01 cost=5.5e+02 flops=5.6e+04
----- TIMING FOR renorm_tot : t_inter=7.1e-02 t_gemm=3.3e-01 t_reduction=1.4e-01 tot=5.5e-01 -----
 renorm_tot[inter] counter=86 t=7.1e-02 per=1.3e+01 cost=1.8e+04 flops=2.6e+05
 renorm_tot[gemm] counter=86 i=0 t=2.5e-05 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=86 i=1 t=1.9e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=86 i=2 t=1.1e-01 per=2.0e+01 cost=1.4e+03 flops=1.3e+04
 renorm_tot[gemm] counter=86 i=3 t=1.1e-01 per=2.1e+01 cost=8.6e+03 flops=7.5e+04
 renorm_tot[gemm] counter=86 i=4 t=1.9e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=86 i=5 t=1.8e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=86 i=6 t=1.1e-01 per=2.1e+01 cost=1.2e+04 flops=1.0e+05
 renorm_tot[gemm] counter=86 total t=3.3e-01 per=6.1e+01 cost=2.2e+04 flops=6.5e+04
 renorm_tot[red] counter=86 t=1.4e-01 per=2.6e+01 cost=1.1e+04 flops=7.5e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 2.2e-03 S rank=0 -----
qops.to_cpu: size(tot)=64:4.9e-04MB:4.8e-07GB T(to_cpu)=4.8e-05S speed=1.0e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0457 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.055e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=2.441e-04 change=-9.520e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 5.507e-02 S #####
 T(local oper_env: fetch) = 8.089e-03 S  per = 14.7  per(accum) = 14.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: renrm) = 4.685e-02 S  per = 85.1  per(accum) = 99.8
 T(local oper_env: save ) = 1.256e-04 S  per = 0.228  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.685e-02 S  T(sum) = 4.685e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.389e-06 S  per = 0.02  per(accum) = 0.02
 T(local oper_env: qops init                    ) = 8.609e-04 S  per = 1.84  per(accum) = 1.86
 T(local oper_env: symbolic_formulae_renorm     ) = 6.595e-04 S  per = 1.41  per(accum) = 3.27
 T(local oper_env: allocate qops on gpu         ) = 6.966e-05 S  per = 0.149  per(accum) = 3.41
 T(local oper_env: site memcpy cpu2gpu          ) = 1.755e-03 S  per = 3.75  per(accum) = 7.16
 T(local oper_env: rintermediate init           ) = 2.471e-03 S  per = 5.27  per(accum) = 12.4
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.013e-03 S  per = 6.43  per(accum) = 18.9
 T(local oper_env: rmmtasks init                ) = 1.276e-03 S  per = 2.72  per(accum) = 21.6
 T(local oper_env: qops memset on cpu           ) = 2.700e-08 S  per = 5.76e-05  per(accum) = 21.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.073e-02 S  per = 65.6  per(accum) = 87.2
 T(local oper_env: deallocate cpu and gpu memory) = 2.601e-05 S  per = 0.0555  per(accum) = 87.2
 T(local oper_env: construct opS [ifdists=true] ) = 2.252e-03 S  per = 4.81  per(accum) = 92
 T(local oper_env: reduction of opS & opH [nccl]) = 2.463e-03 S  per = 5.26  per(accum) = 97.3
 T(local oper_env: qops memcpy gpu2cpu          ) = 5.978e-05 S  per = 0.128  per(accum) = 97.4
 T(local oper_env: reduction of opS & opH [mpi] ) = 4.924e-05 S  per = 0.105  per(accum) = 97.5
 T(local oper_env: qops_pool join and erase     ) = 1.157e-03 S  per = 2.47  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.500e-07 S  per = 0.00139  per(accum) = 100
##### sweep oper_env: 4.142e+00 S #####
 T(sweep oper_env: fetch) = 1.409e-01 S  per =  3.4  per(accum) = 3.4
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 3.4
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 3.4
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 3.4
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 3.4
 T(sweep oper_env: renrm) = 3.999e+00 S  per = 96.5  per(accum) = 100
 T(sweep oper_env: save ) = 2.054e-03 S  per = 0.0496  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.779e+10 S  per = -2.779e+32
 T(sweep oper_env: preprocess                  ) = -2.779e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.999e+00 S  T(sum) = 3.999e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.580e-04 S  per = 0.00395  per(accum) = 0.00395
 T(sweep oper_env: qops init                    ) = 1.266e-02 S  per = 0.317  per(accum) = 0.32
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.566e-02 S  per = 0.391  per(accum) = 0.712
 T(sweep oper_env: allocate qops on gpu         ) = 1.046e-03 S  per = 0.0262  per(accum) = 0.738
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.891e-02 S  per = 0.473  per(accum) = 1.21
 T(sweep oper_env: rintermediate init           ) = 3.748e-02 S  per = 0.937  per(accum) = 2.15
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.054e-02 S  per = 1.26  per(accum) = 3.41
 T(sweep oper_env: rmmtasks init                ) = 2.774e-02 S  per = 0.694  per(accum) = 4.11
 T(sweep oper_env: qops memset on cpu           ) = 5.200e-07 S  per = 1.3e-05  per(accum) = 4.11
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.485e-01 S  per = 13.7  per(accum) = 17.8
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.612e-04 S  per = 0.014  per(accum) = 17.8
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.160e+00 S  per =   79  per(accum) = 96.9
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.380e-02 S  per =  1.1  per(accum) = 97.9
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.428e-03 S  per = 0.0357  per(accum) = 98
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 4.156e-04 S  per = 0.0104  per(accum) = 98
 T(sweep oper_env: qops_pool join and erase     ) = 2.034e-02 S  per = 0.509  per(accum) = 98.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.998e-02 S  per =  1.5  per(accum) = 100

idx=17 coord=(2,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:17 S:1 P:4 Q:7 
        dim(bra,ket)=5,5 size(op)=13:9.92e-05MB size(tot)=64:0.000488MB:4.77e-07GB
        per(mem): H:7.81 C:0 S:0 P:0 Q:92.2 
ctns::oper_renorm coord=(2,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:18 S:1 P:1 Q:4 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=48:0.000366MB:3.58e-07GB
        per(mem): H:12.5 C:0 S:0 P:0 Q:87.5 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.618e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=24 : 4.317e-04 S -----
rank=0 GPUmem(GB): used=8.270e-06 (oper)=8.270e-06
rank=0 GPUmem(GB): used=8.345e-06 (oper,site)=8.270e-06,7.451e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=24
 no. of rintermediate operators=9
 no. of coefficients=153:1.167e-03MB:1.140e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.527e-03 S -----
rank=0 GPUmem(GB): used=9.485e-06 (oper,site,rinter)=8.270e-06,7.451e-08,1.140e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.582e-03 S size(rtasks)=24 size(Rlst2)=36 T(Rmu/Rlist)=9.820e-05,2.483e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.635e-03 S size(rtasks)=24 size(Rlst)=224 -----
rank=0 GPUmem(GB): used=9.485e-06 avail=6.231e+00 total=6.231e+00 batch[need]=5.007e-06 blksize=1 blksize0=0 batchsize=224
rank=0 GPUmem(GB): used=1.449e-05 (oper,site,rinter,batch)=8.270e-06,7.451e-08,1.140e-06,5.007e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.498e-06,2.140e-02,1.011e-02
----- TIMING FOR renorm : t_inter=7.3e-06 t_gemm=2.1e-02 t_reduction=1.0e-02 tot=3.2e-02 -----
 renorm[inter] counter=87 t=7.3e-06 per=2.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=87 i=0 t=1.5e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=87 i=1 t=1.2e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=87 i=2 t=6.4e-03 per=2.0e+01 cost=4.0e+01 flops=6.2e+03
 renorm[gemm] counter=87 i=3 t=7.5e-03 per=2.4e+01 cost=2.5e+02 flops=3.4e+04
 renorm[gemm] counter=87 i=4 t=1.2e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=87 i=5 t=1.1e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=87 i=6 t=7.5e-03 per=2.4e+01 cost=4.5e+02 flops=6.0e+04
 renorm[gemm] counter=87 total t=2.1e-02 per=6.8e+01 cost=7.4e+02 flops=3.5e+04
 renorm[red] counter=87 t=1.0e-02 per=3.2e+01 cost=4.5e+02 flops=4.4e+04
----- TIMING FOR renorm_tot : t_inter=7.1e-02 t_gemm=3.5e-01 t_reduction=1.5e-01 tot=5.8e-01 -----
 renorm_tot[inter] counter=87 t=7.1e-02 per=1.2e+01 cost=1.8e+04 flops=2.6e+05
 renorm_tot[gemm] counter=87 i=0 t=2.6e-05 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=87 i=1 t=2.1e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=87 i=2 t=1.1e-01 per=2.0e+01 cost=1.4e+03 flops=1.3e+04
 renorm_tot[gemm] counter=87 i=3 t=1.2e-01 per=2.1e+01 cost=8.9e+03 flops=7.3e+04
 renorm_tot[gemm] counter=87 i=4 t=2.0e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=87 i=5 t=1.9e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=87 i=6 t=1.2e-01 per=2.1e+01 cost=1.2e+04 flops=1.0e+05
 renorm_tot[gemm] counter=87 total t=3.5e-01 per=6.1e+01 cost=2.2e+04 flops=6.3e+04
 renorm_tot[red] counter=87 t=1.5e-01 per=2.6e+01 cost=1.1e+04 flops=7.3e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 2.2e-03 S rank=0 -----
qops.to_cpu: size(tot)=48:3.7e-04MB:3.6e-07GB T(to_cpu)=3.9e-05S speed=9.1e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.046 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.433e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-9.385e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 5.540e-02 S #####
 T(local oper_env: fetch) = 8.126e-03 S  per = 14.7  per(accum) = 14.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.7
 T(local oper_env: renrm) = 4.715e-02 S  per = 85.1  per(accum) = 99.8
 T(local oper_env: save ) = 1.254e-04 S  per = 0.226  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.715e-02 S  T(sum) = 4.715e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.817e-06 S  per = 0.0208  per(accum) = 0.0208
 T(local oper_env: qops init                    ) = 9.585e-04 S  per = 2.03  per(accum) = 2.05
 T(local oper_env: symbolic_formulae_renorm     ) = 4.440e-04 S  per = 0.942  per(accum) = 3
 T(local oper_env: allocate qops on gpu         ) = 7.006e-05 S  per = 0.149  per(accum) = 3.14
 T(local oper_env: site memcpy cpu2gpu          ) = 1.737e-03 S  per = 3.69  per(accum) = 6.83
 T(local oper_env: rintermediate init           ) = 2.542e-03 S  per = 5.39  per(accum) = 12.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.647e-03 S  per = 5.61  per(accum) = 17.8
 T(local oper_env: rmmtasks init                ) = 9.950e-04 S  per = 2.11  per(accum) = 19.9
 T(local oper_env: qops memset on cpu           ) = 2.200e-08 S  per = 4.67e-05  per(accum) = 19.9
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.169e-02 S  per = 67.2  per(accum) = 87.2
 T(local oper_env: deallocate cpu and gpu memory) = 6.302e-05 S  per = 0.134  per(accum) = 87.3
 T(local oper_env: construct opS [ifdists=true] ) = 2.250e-03 S  per = 4.77  per(accum) = 92.1
 T(local oper_env: reduction of opS & opH [nccl]) = 2.465e-03 S  per = 5.23  per(accum) = 97.3
 T(local oper_env: qops memcpy gpu2cpu          ) = 5.083e-05 S  per = 0.108  per(accum) = 97.4
 T(local oper_env: reduction of opS & opH [mpi] ) = 6.825e-05 S  per = 0.145  per(accum) = 97.5
 T(local oper_env: qops_pool join and erase     ) = 1.157e-03 S  per = 2.45  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.450e-07 S  per = 0.00137  per(accum) = 100
##### sweep oper_env: 4.198e+00 S #####
 T(sweep oper_env: fetch) = 1.490e-01 S  per = 3.55  per(accum) = 3.55
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 3.55
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 3.55
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 3.55
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 3.55
 T(sweep oper_env: renrm) = 4.046e+00 S  per = 96.4  per(accum) = 99.9
 T(sweep oper_env: save ) = 2.179e-03 S  per = 0.0519  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.952e+10 S  per = -2.952e+32
 T(sweep oper_env: preprocess                  ) = -2.952e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.046e+00 S  T(sum) = 4.046e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.678e-04 S  per = 0.00415  per(accum) = 0.00415
 T(sweep oper_env: qops init                    ) = 1.362e-02 S  per = 0.337  per(accum) = 0.341
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.610e-02 S  per = 0.398  per(accum) = 0.739
 T(sweep oper_env: allocate qops on gpu         ) = 1.116e-03 S  per = 0.0276  per(accum) = 0.766
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.065e-02 S  per = 0.51  per(accum) = 1.28
 T(sweep oper_env: rintermediate init           ) = 4.002e-02 S  per = 0.989  per(accum) = 2.27
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.319e-02 S  per = 1.31  per(accum) = 3.58
 T(sweep oper_env: rmmtasks init                ) = 2.874e-02 S  per = 0.71  per(accum) = 4.29
 T(sweep oper_env: qops memset on cpu           ) = 5.420e-07 S  per = 1.34e-05  per(accum) = 4.29
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 5.802e-01 S  per = 14.3  per(accum) = 18.6
 T(sweep oper_env: deallocate cpu and gpu memory) = 6.242e-04 S  per = 0.0154  per(accum) = 18.6
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.162e+00 S  per = 78.2  per(accum) = 96.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.627e-02 S  per = 1.14  per(accum) = 97.9
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.479e-03 S  per = 0.0366  per(accum) = 98
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 4.839e-04 S  per = 0.012  per(accum) = 98
 T(sweep oper_env: qops_pool join and erase     ) = 2.150e-02 S  per = 0.531  per(accum) = 98.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.998e-02 S  per = 1.48  per(accum) = 100

idx=18 coord=(1,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:18 S:1 P:1 Q:4 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=48:0.000366MB:3.58e-07GB
        per(mem): H:12.5 C:0 S:0 P:0 Q:87.5 
ctns::oper_renorm coord=(1,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:19 S:0 P:0 Q:2 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=27:0.000206MB:2.01e-07GB
        per(mem): H:22.2 C:0 Q:77.8 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.534e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=22 : 2.950e-04 S -----
rank=0 GPUmem(GB): used=7.994e-06 (oper)=7.994e-06
rank=0 GPUmem(GB): used=8.039e-06 (oper,site)=7.994e-06,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=22
 no. of rintermediate operators=4
 no. of coefficients=72:5.493e-04MB:5.364e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.457e-03 S -----
rank=0 GPUmem(GB): used=8.576e-06 (oper,site,rinter)=7.994e-06,4.470e-08,5.364e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 8.144e-04 S size(rtasks)=22 size(Rlst2)=36 T(Rmu/Rlist)=7.597e-05,7.384e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.343e-04 S size(rtasks)=22 size(Rlst)=51 -----
rank=0 GPUmem(GB): used=8.576e-06 avail=6.231e+00 total=6.231e+00 batch[need]=1.140e-06 blksize=1 blksize0=0 batchsize=51
rank=0 GPUmem(GB): used=9.716e-06 (oper,site,rinter,batch)=7.994e-06,4.470e-08,5.364e-07,1.140e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.312e-03,2.275e-02,9.940e-03
----- TIMING FOR renorm : t_inter=1.3e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=3.4e-02 -----
 renorm[inter] counter=88 t=1.3e-03 per=3.9e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=88 i=0 t=1.6e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=88 i=1 t=1.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=88 i=2 t=7.6e-03 per=2.2e+01 cost=1.2e+01 flops=1.6e+03
 renorm[gemm] counter=88 i=3 t=7.6e-03 per=2.2e+01 cost=5.4e+01 flops=7.1e+03
 renorm[gemm] counter=88 i=4 t=1.2e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=88 i=5 t=1.1e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=88 i=6 t=7.6e-03 per=2.2e+01 cost=1.0e+02 flops=1.3e+04
 renorm[gemm] counter=88 total t=2.3e-02 per=6.7e+01 cost=1.7e+02 flops=7.4e+03
 renorm[red] counter=88 t=9.9e-03 per=2.9e+01 cost=1.0e+02 flops=1.0e+04
----- TIMING FOR renorm_tot : t_inter=7.3e-02 t_gemm=3.8e-01 t_reduction=1.6e-01 tot=6.1e-01 -----
 renorm_tot[inter] counter=88 t=7.3e-02 per=1.2e+01 cost=1.8e+04 flops=2.5e+05
 renorm_tot[gemm] counter=88 i=0 t=2.8e-05 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=88 i=1 t=2.2e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=88 i=2 t=1.2e-01 per=2.0e+01 cost=1.5e+03 flops=1.2e+04
 renorm_tot[gemm] counter=88 i=3 t=1.3e-01 per=2.1e+01 cost=8.9e+03 flops=6.9e+04
 renorm_tot[gemm] counter=88 i=4 t=2.2e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=88 i=5 t=2.0e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=88 i=6 t=1.3e-01 per=2.1e+01 cost=1.2e+04 flops=9.6e+04
 renorm_tot[gemm] counter=88 total t=3.8e-01 per=6.2e+01 cost=2.3e+04 flops=6.0e+04
 renorm_tot[red] counter=88 t=1.6e-01 per=2.6e+01 cost=1.1e+04 flops=6.9e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 1.7e-04 S rank=0 -----
qops.to_cpu: size(tot)=27:2.1e-04MB:2.0e-07GB T(to_cpu)=3.4e-05S speed=5.8e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0435 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=3.286e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-8.933e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 5.288e-02 S #####
 T(local oper_env: fetch) = 8.103e-03 S  per = 15.3  per(accum) = 15.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15.3
 T(local oper_env: renrm) = 4.466e-02 S  per = 84.4  per(accum) = 99.8
 T(local oper_env: save ) = 1.258e-04 S  per = 0.238  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.466e-02 S  T(sum) = 4.466e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.577e-06 S  per = 0.0214  per(accum) = 0.0214
 T(local oper_env: qops init                    ) = 8.381e-04 S  per = 1.88  per(accum) = 1.9
 T(local oper_env: symbolic_formulae_renorm     ) = 3.068e-04 S  per = 0.687  per(accum) = 2.59
 T(local oper_env: allocate qops on gpu         ) = 7.160e-05 S  per = 0.16  per(accum) = 2.75
 T(local oper_env: site memcpy cpu2gpu          ) = 2.022e-03 S  per = 4.53  per(accum) = 7.27
 T(local oper_env: rintermediate init           ) = 2.472e-03 S  per = 5.53  per(accum) = 12.8
 T(local oper_env: preprocess_formulae_Rlist2   ) = 8.811e-04 S  per = 1.97  per(accum) = 14.8
 T(local oper_env: rmmtasks init                ) = 2.593e-04 S  per = 0.581  per(accum) = 15.4
 T(local oper_env: qops memset on cpu           ) = 5.800e-08 S  per = 0.00013  per(accum) = 15.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.417e-02 S  per = 76.5  per(accum) = 91.9
 T(local oper_env: deallocate cpu and gpu memory) = 1.895e-05 S  per = 0.0424  per(accum) = 91.9
 T(local oper_env: construct opS [ifdists=true] ) = 2.182e-04 S  per = 0.489  per(accum) = 92.4
 T(local oper_env: reduction of opS & opH [nccl]) = 2.118e-03 S  per = 4.74  per(accum) = 97.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.538e-05 S  per = 0.102  per(accum) = 97.3
 T(local oper_env: reduction of opS & opH [mpi] ) = 6.319e-05 S  per = 0.141  per(accum) = 97.4
 T(local oper_env: qops_pool join and erase     ) = 1.164e-03 S  per = 2.61  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 6.740e-07 S  per = 0.00151  per(accum) = 100
##### sweep oper_env: 4.250e+00 S #####
 T(sweep oper_env: fetch) = 1.571e-01 S  per =  3.7  per(accum) = 3.7
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 3.7
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 3.7
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 3.7
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 3.7
 T(sweep oper_env: renrm) = 4.091e+00 S  per = 96.2  per(accum) = 99.9
 T(sweep oper_env: save ) = 2.305e-03 S  per = 0.0542  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.126e+10 S  per = -3.126e+32
 T(sweep oper_env: preprocess                  ) = -3.126e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.091e+00 S  T(sum) = 4.091e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.774e-04 S  per = 0.00434  per(accum) = 0.00434
 T(sweep oper_env: qops init                    ) = 1.445e-02 S  per = 0.353  per(accum) = 0.358
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.641e-02 S  per = 0.401  per(accum) = 0.759
 T(sweep oper_env: allocate qops on gpu         ) = 1.188e-03 S  per = 0.029  per(accum) = 0.788
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.267e-02 S  per = 0.554  per(accum) = 1.34
 T(sweep oper_env: rintermediate init           ) = 4.249e-02 S  per = 1.04  per(accum) = 2.38
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.407e-02 S  per = 1.32  per(accum) = 3.7
 T(sweep oper_env: rmmtasks init                ) = 2.900e-02 S  per = 0.709  per(accum) = 4.41
 T(sweep oper_env: qops memset on cpu           ) = 6.000e-07 S  per = 1.47e-05  per(accum) = 4.41
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.143e-01 S  per =   15  per(accum) = 19.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 6.432e-04 S  per = 0.0157  per(accum) = 19.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.162e+00 S  per = 77.3  per(accum) = 96.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.839e-02 S  per = 1.18  per(accum) = 97.9
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.525e-03 S  per = 0.0373  per(accum) = 98
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 5.470e-04 S  per = 0.0134  per(accum) = 98
 T(sweep oper_env: qops_pool join and erase     ) = 2.266e-02 S  per = 0.554  per(accum) = 98.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.998e-02 S  per = 1.47  per(accum) = 100

idx=19 coord=(0,0)
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=102:0.000778MB:7.6e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=0 mem=0:0MB:0GB
total mem of comb=103:0.000786MB:7.67e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:19 S:0 P:0 Q:2 
        dim(bra,ket)=6,6 size(op)=15:0.000114MB size(tot)=27:0.000206MB:2.01e-07GB
        per(mem): H:22.2 C:0 Q:77.8 
ctns::oper_renorm coord=(0,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:20 S:0 P:0 Q:0 
        dim(bra,ket)=6,6 size(op)=6:4.58e-05MB size(tot)=6:4.58e-05MB:4.47e-08GB
        per(mem): H:100 C:0 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.504e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=21 : 1.832e-04 S -----
rank=0 GPUmem(GB): used=7.682e-06 (oper)=7.682e-06
rank=0 GPUmem(GB): used=7.726e-06 (oper,site)=7.682e-06,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=21
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=7.726e-06 (oper,site,rinter)=7.682e-06,4.470e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 6.107e-04 S size(rtasks)=21 size(Rlst2)=36 T(Rmu/Rlist)=6.145e-05,5.492e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.287e-04 S size(rtasks)=21 size(Rlst)=36 -----
rank=0 GPUmem(GB): used=7.726e-06 avail=6.231e+00 total=6.231e+00 batch[need]=8.047e-07 blksize=1 blksize0=0 batchsize=36
rank=0 GPUmem(GB): used=8.531e-06 (oper,site,rinter,batch)=7.682e-06,4.470e-08,0.000e+00,8.047e-07
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.651e-03,2.248e-02,9.890e-03
----- TIMING FOR renorm : t_inter=1.7e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.4e-02 -----
 renorm[inter] counter=89 t=1.7e-03 per=4.9e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=89 i=0 t=1.6e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=89 i=1 t=1.3e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=89 i=2 t=7.6e-03 per=2.2e+01 cost=2.4e+01 flops=3.2e+03
 renorm[gemm] counter=89 i=3 t=7.5e-03 per=2.2e+01 cost=2.4e+01 flops=3.2e+03
 renorm[gemm] counter=89 i=4 t=1.2e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=89 i=5 t=1.1e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=89 i=6 t=7.4e-03 per=2.2e+01 cost=7.2e+01 flops=9.7e+03
 renorm[gemm] counter=89 total t=2.2e-02 per=6.6e+01 cost=1.2e+02 flops=5.3e+03
 renorm[red] counter=89 t=9.9e-03 per=2.9e+01 cost=7.2e+01 flops=7.3e+03
----- TIMING FOR renorm_tot : t_inter=7.4e-02 t_gemm=4.0e-01 t_reduction=1.7e-01 tot=6.5e-01 -----
 renorm_tot[inter] counter=89 t=7.4e-02 per=1.2e+01 cost=1.8e+04 flops=2.5e+05
 renorm_tot[gemm] counter=89 i=0 t=3.0e-05 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=89 i=1 t=2.3e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=89 i=2 t=1.3e-01 per=2.0e+01 cost=1.5e+03 flops=1.2e+04
 renorm_tot[gemm] counter=89 i=3 t=1.4e-01 per=2.1e+01 cost=8.9e+03 flops=6.5e+04
 renorm_tot[gemm] counter=89 i=4 t=2.3e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=89 i=5 t=2.2e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=89 i=6 t=1.3e-01 per=2.1e+01 cost=1.2e+04 flops=9.1e+04
 renorm_tot[gemm] counter=89 total t=4.0e-01 per=6.2e+01 cost=2.3e+04 flops=5.7e+04
 renorm_tot[red] counter=89 t=1.7e-01 per=2.7e+01 cost=1.1e+04 flops=6.5e+04
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 7.9e-06 S rank=0 -----
qops.to_cpu: size(tot)=6:4.6e-05MB:4.5e-08GB T(to_cpu)=2.9e-05S speed=1.6e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.0409 S rank=0 -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=2.225e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-8.744e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local oper_env: 5.025e-02 S #####
 T(local oper_env: fetch) = 8.097e-03 S  per = 16.1  per(accum) = 16.1
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 16.1
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 16.1
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 16.1
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 16.1
 T(local oper_env: renrm) = 4.203e-02 S  per = 83.6  per(accum) = 99.7
 T(local oper_env: save ) = 1.264e-04 S  per = 0.252  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.737e+09 S  per = -1.737e+31
 T(local oper_env: preprocess                  ) = -1.737e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.203e-02 S  T(sum) = 4.203e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 9.205e-06 S  per = 0.0219  per(accum) = 0.0219
 T(local oper_env: qops init                    ) = 7.914e-04 S  per = 1.88  per(accum) = 1.9
 T(local oper_env: symbolic_formulae_renorm     ) = 1.951e-04 S  per = 0.464  per(accum) = 2.37
 T(local oper_env: allocate qops on gpu         ) = 7.097e-05 S  per = 0.169  per(accum) = 2.54
 T(local oper_env: site memcpy cpu2gpu          ) = 2.331e-03 S  per = 5.55  per(accum) = 8.08
 T(local oper_env: rintermediate init           ) = 1.933e-05 S  per = 0.046  per(accum) = 8.13
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.358e-04 S  per = 1.51  per(accum) = 9.64
 T(local oper_env: rmmtasks init                ) = 2.058e-04 S  per = 0.49  per(accum) = 10.1
 T(local oper_env: qops memset on cpu           ) = 4.100e-08 S  per = 9.76e-05  per(accum) = 10.1
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.419e-02 S  per = 81.4  per(accum) = 91.5
 T(local oper_env: deallocate cpu and gpu memory) = 1.892e-05 S  per = 0.045  per(accum) = 91.5
 T(local oper_env: construct opS [ifdists=true] ) = 1.883e-05 S  per = 0.0448  per(accum) = 91.6
 T(local oper_env: reduction of opS & opH [nccl]) = 2.284e-03 S  per = 5.44  per(accum) = 97
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.961e-05 S  per = 0.0942  per(accum) = 97.1
 T(local oper_env: reduction of opS & opH [mpi] ) = 6.714e-05 S  per = 0.16  per(accum) = 97.3
 T(local oper_env: qops_pool join and erase     ) = 1.150e-03 S  per = 2.74  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 7.200e-07 S  per = 0.00171  per(accum) = 100
##### sweep oper_env: 4.301e+00 S #####
 T(sweep oper_env: fetch) = 1.652e-01 S  per = 3.84  per(accum) = 3.84
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 3.84
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 3.84
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 3.84
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 3.84
 T(sweep oper_env: renrm) = 4.133e+00 S  per = 96.1  per(accum) = 99.9
 T(sweep oper_env: save ) = 2.431e-03 S  per = 0.0565  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.300e+10 S  per = -3.300e+32
 T(sweep oper_env: preprocess                  ) = -3.300e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.133e+00 S  T(sum) = 4.133e+00 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.866e-04 S  per = 0.00452  per(accum) = 0.00452
 T(sweep oper_env: qops init                    ) = 1.525e-02 S  per = 0.369  per(accum) = 0.373
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.660e-02 S  per = 0.402  per(accum) = 0.775
 T(sweep oper_env: allocate qops on gpu         ) = 1.259e-03 S  per = 0.0305  per(accum) = 0.806
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.501e-02 S  per = 0.605  per(accum) = 1.41
 T(sweep oper_env: rintermediate init           ) = 4.251e-02 S  per = 1.03  per(accum) = 2.44
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.470e-02 S  per = 1.32  per(accum) = 3.76
 T(sweep oper_env: rmmtasks init                ) = 2.920e-02 S  per = 0.707  per(accum) = 4.47
 T(sweep oper_env: qops memset on cpu           ) = 6.410e-07 S  per = 1.55e-05  per(accum) = 4.47
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.485e-01 S  per = 15.7  per(accum) = 20.2
 T(sweep oper_env: deallocate cpu and gpu memory) = 6.621e-04 S  per = 0.016  per(accum) = 20.2
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.163e+00 S  per = 76.5  per(accum) = 96.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.067e-02 S  per = 1.23  per(accum) = 97.9
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.564e-03 S  per = 0.0378  per(accum) = 98
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 6.142e-04 S  per = 0.0149  per(accum) = 98
 T(sweep oper_env: qops_pool join and erase     ) = 2.381e-02 S  per = 0.576  per(accum) = 98.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.998e-02 S  per = 1.45  per(accum) = 100
----- TIMING FOR ctns::oper_env_right : 4.501e+00 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.188,0.165,4.05,0.0833,4.49
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-5.800e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::oper_load iomode=0 fname=./scratch/sweep/rop(0,0)
fname=./scratch/sweep/rop(0,0) size=4.470e-08GB T[load](info/setup/data/tot)=3.987e-05,6.899e-04,1.040e-05,7.402e-04 speed=6.040e-05GB/S
matrix: Hij size=(1,1)
     -1.160545355850e+02 
matrix: Sij size=(1,1)
      1.000000000000e+00 

ctns::sweep_opt maxsweep=1
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-2.980e-08 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

ctns::oper_init_dotL isym=3 ifkr=1 singlet=0
ctns::oper_save iomode=0 fname=./scratch/sweep/lop(0,0) size=7.614e-03MB:7.436e-06GB
fname=./scratch/sweep/lop(0,0) size=7.44e-06GB T[save](info/data/tot)=8.78e-05,4.17e-05,0.000129 speed=0.0574GB/S disk[used]=0.000191GB
----- TIMING FOR ctns::oper_init_dotL : 8.418e-03 S -----

ctns::topology::get_sweeps ifboundary=0
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(3,0)-(4,0) forward=1 cturn=0
 ibond=3 bond=(4,0)-(5,0) forward=1 cturn=0
 ibond=4 bond=(5,0)-(6,0) forward=1 cturn=0
 ibond=5 bond=(6,0)-(7,0) forward=1 cturn=0
 ibond=6 bond=(7,0)-(8,0) forward=1 cturn=0
 ibond=7 bond=(8,0)-(9,0) forward=1 cturn=0
 ibond=8 bond=(9,0)-(10,0) forward=1 cturn=0
 ibond=9 bond=(10,0)-(11,0) forward=1 cturn=0
 ibond=10 bond=(11,0)-(12,0) forward=1 cturn=0
 ibond=11 bond=(12,0)-(13,0) forward=1 cturn=0
 ibond=12 bond=(13,0)-(14,0) forward=1 cturn=0
 ibond=13 bond=(14,0)-(15,0) forward=1 cturn=0
 ibond=14 bond=(15,0)-(16,0) forward=1 cturn=0
 ibond=15 bond=(16,0)-(17,0) forward=1 cturn=0
 ibond=16 bond=(17,0)-(18,0) forward=1 cturn=0
 ibond=17 bond=(17,0)-(18,0) forward=0 cturn=0
 ibond=18 bond=(16,0)-(17,0) forward=0 cturn=0
 ibond=19 bond=(15,0)-(16,0) forward=0 cturn=0
 ibond=20 bond=(14,0)-(15,0) forward=0 cturn=0
 ibond=21 bond=(13,0)-(14,0) forward=0 cturn=0
 ibond=22 bond=(12,0)-(13,0) forward=0 cturn=0
 ibond=23 bond=(11,0)-(12,0) forward=0 cturn=0
 ibond=24 bond=(10,0)-(11,0) forward=0 cturn=0
 ibond=25 bond=(9,0)-(10,0) forward=0 cturn=0
 ibond=26 bond=(8,0)-(9,0) forward=0 cturn=0
 ibond=27 bond=(7,0)-(8,0) forward=0 cturn=0
 ibond=28 bond=(6,0)-(7,0) forward=0 cturn=0
 ibond=29 bond=(5,0)-(6,0) forward=0 cturn=0
 ibond=30 bond=(4,0)-(5,0) forward=0 cturn=0
 ibond=31 bond=(3,0)-(4,0) forward=0 cturn=0
 ibond=32 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=33 bond=(1,0)-(2,0) forward=0 cturn=0
..... end of get_sweeps .....

======================================================================
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=1 sym_state=(30,0) singlet=0
qtensor3: site0new own=1 _data=0x3a8b59a0
qinfo3su2: site0new sym=(0,0) dir=1,0,1 couple=0
 qbond: qrow nsym=1 dimAll=1
 (0,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=3 nblocks=9 size=3:2.29e-05MB
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=99:0.000755MB:7.38e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1:7.63e-06MB:7.45e-09GB
total mem of comb=101:0.000771MB:7.53e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=1.945e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=0/seqsize=34 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.639e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=99:7.553e-04MB:7.376e-07GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=1:7.629e-06MB:7.451e-09GB
total mem of comb=101:7.706e-04MB:7.525e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,17,1,1
 suppl= 0
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:17 S:1 P:4 Q:7 
        dim(bra,ket)=5,5 size(op)=13:9.92e-05MB size(tot)=64:0.000488MB:4.77e-07GB
        per(mem): H:7.81 C:0 S:0 P:0 Q:92.2 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3058:0.0233MB:2.28e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.447e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-7.689e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(3,5,3,3) nnz=3:2.289e-05MB
qtensor4: wf4 own=1 _data=0x3b203040
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qcol nsym=5 dimAll=5
 (25,1):1 (25,3):1 (25,5):1 (25,7):1 (25,9):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=3 nblocks=200 size=3:2.289e-05MB
### DIAG TIMING: total=4.443e-02 t1=2.669e-05, t2=1.653e-03, t3=2.564e-03, t4=3.764e-02, t5=3.010e-06, t6=2.544e-03, t7=5.731e-06
duration_diagGPU:4.445e-02
duration_diagreduce:6.700e-08
duration_diagtransform:1.106e-06
----- TIMING FOR symbolic_formulae_twodot with size=111 : 1.157e-03 S -----
rank=0 GPUmem(GB): used=2.278e-05 (oper)=2.278e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=111
 no. of hintermediate operators=12
 no. of coefficients=204:1.556e-03MB:1.520e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.135e-05 S -----
rank=0 GPUmem(GB): used=2.430e-05 (oper,hinter)=2.278e-05,1.520e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.944e-03 S size(H_formulae)=111 size(Hxlst2)=3 T(Hmu/Hxlist)=2.638e-04,2.681e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.962e-03 S size(H_formulae)=111 size(Hxlst)=66 -----
rank=0 GPUmem(GB): used=2.430e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=4.470e-08 batch[need]=1.475e-06 blksize=1 blksize0=0 batchsize=66
rank=0 GPUmem(GB): used=2.582e-05 (oper,hinter,dvdson,batch)=2.278e-05,1.520e-06,4.470e-08,1.475e-06
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=3 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.693e-03,6.045e-06,2.798e-02,1.255e-02,4.824e-02
 analyze_tgpu[Hx]: ndim=3:2.235e-08GB T(cpu-gpu)=1.970e-04 speed=2.269e-04GB/S T(nccl)=7.496e-03 speed=5.963e-06GB/S
----- TIMING FOR sigma : t_inter=5.8e-06 t_gemm=2.8e-02 t_reduction=1.3e-02 tot=4.1e-02 -----
 sigma[inter] counter=1 t=5.8e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=0 t=1.6e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=2 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=3 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=4 t=5.4e-03 per=1.3e+01 cost=2.8e+01 flops=5.1e+03
 sigma[gemm] counter=1 i=5 t=7.5e-03 per=1.9e+01 cost=2.8e+01 flops=3.7e+03
 sigma[gemm] counter=1 i=6 t=7.5e-03 per=1.9e+01 cost=3.6e+01 flops=4.8e+03
 sigma[gemm] counter=1 i=7 t=7.5e-03 per=1.8e+01 cost=3.6e+01 flops=4.8e+03
 sigma[gemm] counter=1 total t=2.8e-02 per=6.9e+01 cost=1.3e+02 flops=4.6e+03
 sigma[red] counter=1 t=1.3e-02 per=3.1e+01 cost=1.3e+02 flops=1.1e+04
----- TIMING FOR sigma_tot : t_inter=5.8e-06 t_gemm=2.8e-02 t_reduction=1.3e-02 tot=4.1e-02 -----
 sigma_tot[inter] counter=1 t=5.8e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=0 t=1.6e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=2 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=3 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=4 t=5.4e-03 per=1.3e+01 cost=2.8e+01 flops=5.1e+03
 sigma_tot[gemm] counter=1 i=5 t=7.5e-03 per=1.9e+01 cost=2.8e+01 flops=3.7e+03
 sigma_tot[gemm] counter=1 i=6 t=7.5e-03 per=1.9e+01 cost=3.6e+01 flops=4.8e+03
 sigma_tot[gemm] counter=1 i=7 t=7.5e-03 per=1.8e+01 cost=3.6e+01 flops=4.8e+03
 sigma_tot[gemm] counter=1 total t=2.8e-02 per=6.9e+01 cost=1.3e+02 flops=4.6e+03
 sigma_tot[red] counter=1 t=1.3e-02 per=3.1e+01 cost=1.3e+02 flops=1.1e+04
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.3e-05,1.3e-05,2.4e-06,1.5e-06,1.9e-07
settings: ndim=3 neig=1 maxcycle=30 nbuff=4 memory=2e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.054535585049 -1.116e+03  5.588e-02    1     1  4.857e-02 4.857e-02 4.848e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.805e-03,4.619e-06,2.960e-02,1.241e-02,4.983e-02
 analyze_tgpu[Hx]: ndim=3:2.235e-08GB T(cpu-gpu)=2.027e-03 speed=2.206e-05GB/S T(nccl)=5.778e-03 speed=7.737e-06GB/S
----- TIMING FOR sigma : t_inter=4.5e-06 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.2e-02 -----
 sigma[inter] counter=2 t=4.5e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=0 t=1.7e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=1 t=1.4e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=2 t=1.4e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=3 t=1.4e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=4 t=7.4e-03 per=1.8e+01 cost=2.8e+01 flops=3.8e+03
 sigma[gemm] counter=2 i=5 t=7.4e-03 per=1.8e+01 cost=2.8e+01 flops=3.8e+03
 sigma[gemm] counter=2 i=6 t=7.4e-03 per=1.8e+01 cost=3.6e+01 flops=4.9e+03
 sigma[gemm] counter=2 i=7 t=7.4e-03 per=1.8e+01 cost=3.6e+01 flops=4.9e+03
 sigma[gemm] counter=2 total t=3.0e-02 per=7.0e+01 cost=1.3e+02 flops=4.3e+03
 sigma[red] counter=2 t=1.2e-02 per=3.0e+01 cost=1.3e+02 flops=1.1e+04
----- TIMING FOR sigma_tot : t_inter=1.0e-05 t_gemm=5.8e-02 t_reduction=2.5e-02 tot=8.3e-02 -----
 sigma_tot[inter] counter=2 t=1.0e-05 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=0 t=3.2e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=1 t=2.7e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=2 t=2.6e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=3 t=2.5e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=4 t=1.3e-02 per=1.6e+01 cost=5.6e+01 flops=4.4e+03
 sigma_tot[gemm] counter=2 i=5 t=1.5e-02 per=1.8e+01 cost=5.6e+01 flops=3.8e+03
 sigma_tot[gemm] counter=2 i=6 t=1.5e-02 per=1.8e+01 cost=7.2e+01 flops=4.8e+03
 sigma_tot[gemm] counter=2 i=7 t=1.5e-02 per=1.8e+01 cost=7.2e+01 flops=4.8e+03
 sigma_tot[gemm] counter=2 total t=5.8e-02 per=7.0e+01 cost=2.6e+02 flops=4.4e+03
 sigma_tot[red] counter=2 t=2.5e-02 per=3.0e+01 cost=2.6e+02 flops=1.1e+04
T(sub)=6.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,5.0e-05,3.6e-06,1.4e-06,1.7e-07
    2   0 -    -116.091258810005 -3.672e-02  1.195e-03    2     2  9.881e-02 4.940e-02 4.926e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.167e-02,4.434e-06,2.958e-02,1.249e-02,5.374e-02
 analyze_tgpu[Hx]: ndim=3:2.235e-08GB T(cpu-gpu)=2.156e-03 speed=2.073e-05GB/S T(nccl)=9.513e-03 speed=4.699e-06GB/S
----- TIMING FOR sigma : t_inter=4.3e-06 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=4.2e-02 -----
 sigma[inter] counter=3 t=4.3e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=0 t=1.6e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=1 t=1.4e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=2 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=3 t=1.4e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=4 t=7.3e-03 per=1.7e+01 cost=2.8e+01 flops=3.8e+03
 sigma[gemm] counter=3 i=5 t=7.3e-03 per=1.7e+01 cost=2.8e+01 flops=3.8e+03
 sigma[gemm] counter=3 i=6 t=7.4e-03 per=1.8e+01 cost=3.6e+01 flops=4.9e+03
 sigma[gemm] counter=3 i=7 t=7.5e-03 per=1.8e+01 cost=3.6e+01 flops=4.8e+03
 sigma[gemm] counter=3 total t=3.0e-02 per=7.0e+01 cost=1.3e+02 flops=4.3e+03
 sigma[red] counter=3 t=1.2e-02 per=3.0e+01 cost=1.3e+02 flops=1.1e+04
----- TIMING FOR sigma_tot : t_inter=1.5e-05 t_gemm=8.7e-02 t_reduction=3.7e-02 tot=1.2e-01 -----
 sigma_tot[inter] counter=3 t=1.5e-05 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=0 t=4.9e-06 per=3.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=1 t=4.1e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=2 t=3.9e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=3 t=3.9e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=4 t=2.0e-02 per=1.6e+01 cost=8.4e+01 flops=4.2e+03
 sigma_tot[gemm] counter=3 i=5 t=2.2e-02 per=1.8e+01 cost=8.4e+01 flops=3.8e+03
 sigma_tot[gemm] counter=3 i=6 t=2.2e-02 per=1.8e+01 cost=1.1e+02 flops=4.8e+03
 sigma_tot[gemm] counter=3 i=7 t=2.2e-02 per=1.8e+01 cost=1.1e+02 flops=4.8e+03
 sigma_tot[gemm] counter=3 total t=8.7e-02 per=7.0e+01 cost=3.8e+02 flops=4.4e+03
 sigma_tot[red] counter=3 t=3.7e-02 per=3.0e+01 cost=4.0e+02 flops=1.1e+04
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,4.0e-05,3.0e-06,1.1e-06,1.7e-07
    3   0 +    -116.091268021088 -9.211e-06  9.195e-15    3     3  1.528e-01 5.092e-02 5.080e-02
TIMING FOR Davidson : 1.528e-01  T(cal/comm/rest)=1.524e-01,8.190e-07,4.000e-04
decomposed t_rest=4.000e-04
 T(sub)    =1.471e-04 per=3.677e+01
 T(precond)=4.366e-05 per=1.091e+01
 T(ortho)  =6.468e-06 per=1.617e+00
 T(xcopy)  =1.820e-06 per=4.550e-01
 T(xnrm2)  =1.111e-06 per=2.777e-01
 T(other)  =1.999e-04 per=4.996e+01
optimized energies: isweep=0 ibond=0 dots=2 e[0]=-116.091268021088 nmvp=3
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.998e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=6 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond0.txt
 qbond: qsuper nsym=6 dimAll=10
 (0,0):1 (2,0):3 (1,1):2 (4,0):1 (3,1):2 (2,2):1
timing for divide=8.2e-05
timing for compute=6.2e-05
timing for collect=3.0e-05
----- TMING FOR decimation_genbasis(su2): 1.7e-04 S T(divide/compute[cpu/gpu/rest]/collect)=8.2e-05,5.2e-05,0.0e+00,9.5e-06,3.0e-05 -----
decimation summary: 10->2 dwt=+0.000e+00 SvN=6.126e-01
 qbond: qkept nsym=2 dimAll=2
 (4,0):1 (3,1):1
----- TIMING for decimation_row(nkr): 4.629e-04 S T(decim/select/formRot)=2.218e-04,1.699e-04,7.118e-05 -----
----- TIMING FOR twodot_decimation: 8.745e-04 S T(wf/decim)=3.923e-04,4.822e-04 -----
ctns::oper_renorm coord=(1,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:2 S:9 A:1 B:4 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=19:1.450e-04MB:1.416e-07GB
        per(mem): H:10.5 C:10.5 S:47.4 A:0 B:31.6 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.599e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=8 : 1.002e-04 S -----
rank=0 GPUmem(GB): used=2.397e-05 (oper)=1.501e-05
rank=0 GPUmem(GB): used=2.399e-05 (oper,site)=1.501e-05,2.235e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=8
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=2.399e-05 (oper,site,rinter)=1.501e-05,2.235e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 2.927e-04 S size(rtasks)=8 size(Rlst2)=4 T(Rmu/Rlist)=4.004e-05,2.526e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.108e-04 S size(rtasks)=8 size(Rlst)=28 -----
rank=0 GPUmem(GB): used=2.399e-05 avail=6.231e+00 total=6.231e+00 batch[need]=6.258e-07 blksize=1 blksize0=0 batchsize=28
rank=0 GPUmem(GB): used=2.462e-05 (oper,site,rinter,batch)=1.501e-05,2.235e-08,0.000e+00,6.258e-07
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.911e-03,2.258e-02,9.953e-03
----- TIMING FOR renorm : t_inter=1.9e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.4e-02 -----
 renorm[inter] counter=1 t=1.9e-03 per=5.5e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=1.8e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=1.2e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=1.1e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=3 t=1.1e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=4 t=7.5e-03 per=2.2e+01 cost=1.4e+01 flops=1.9e+03
 renorm[gemm] counter=1 i=5 t=7.5e-03 per=2.2e+01 cost=2.8e+01 flops=3.7e+03
 renorm[gemm] counter=1 i=6 t=7.5e-03 per=2.2e+01 cost=5.6e+01 flops=7.4e+03
 renorm[gemm] counter=1 total t=2.3e-02 per=6.6e+01 cost=9.8e+01 flops=4.3e+03
 renorm[red] counter=1 t=1.0e-02 per=2.9e+01 cost=5.6e+01 flops=5.6e+03
----- TIMING FOR renorm_tot : t_inter=1.9e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.4e-02 -----
 renorm_tot[inter] counter=1 t=1.9e-03 per=5.5e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=1.8e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=1.2e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=1.1e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=3 t=1.1e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=4 t=7.5e-03 per=2.2e+01 cost=1.4e+01 flops=1.9e+03
 renorm_tot[gemm] counter=1 i=5 t=7.5e-03 per=2.2e+01 cost=2.8e+01 flops=3.7e+03
 renorm_tot[gemm] counter=1 i=6 t=7.5e-03 per=2.2e+01 cost=5.6e+01 flops=7.4e+03
 renorm_tot[gemm] counter=1 total t=2.3e-02 per=6.6e+01 cost=9.8e+01 flops=4.3e+03
 renorm_tot[red] counter=1 t=1.0e-02 per=2.9e+01 cost=5.6e+01 flops=5.6e+03
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.398e-05 (optmp,oper)=7.451e-09,1.501e-05
rank=0 GPUmem(GB): used=2.400e-05 (optmp,oper,site,rinter)=7.451e-09,1.501e-05,2.235e-08,0.000e+00
rank=0 GPUmem(GB): used=2.409e-05 (optmp,oper,site,rinter,batch)=7.451e-09,1.501e-05,2.235e-08,0.000e+00,8.941e-08
----- TIMING FOR preprocess_renorm_batchGPU_opS : 5.692e-01 S T(prep/alloc/comp/red/dealloc)=1.252e-03,2.011e-03,5.091e-01,5.555e-02,2.525e-03 -----
----- TIMING FOR oper_renorm_opS : 5.693e-01 S rank=0 -----
qops.to_cpu: size(tot)=19:1.450e-04MB:1.416e-07GB T(to_cpu)=3.966e-05S speed=3.570e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.609 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.527e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=2.441e-04 change=-1.653e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=2.441e-04 change=-9.388e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 8.513e-01 S #####
 T(local opt: fetch) = 3.190e-02 S  per = 3.75  per(accum) = 3.75
 T(local opt: hdiag) = 4.491e-02 S  per = 5.28  per(accum) = 9.02
 T(local opt: dvdsn) = 1.611e-01 S  per = 18.9  per(accum) = 28
 T(local opt: decim) = 9.579e-04 S  per = 0.113  per(accum) = 28.1
 T(local opt: guess) = 5.217e-04 S  per = 0.0613  per(accum) = 28.1
 T(local opt: renrm) = 6.117e-01 S  per = 71.9  per(accum) = 100
 T(local opt: save ) = 1.668e-04 S  per = 0.0196  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.611e-01 S  T(sum) = 1.609e-01 S  per = 9.986e+01
 T(local opt: preprocess                  ) = 2.901e-03 S  per =  1.8  per(accum) = 1.8
 T(local opt: symbolic_formulae           ) = 1.171e-03 S  per = 0.728  per(accum) = 2.53
 T(local opt: hintermediate init          ) = 8.364e-05 S  per = 0.052  per(accum) = 2.58
 T(local opt: preprocess_hformulae_Hxlist ) = 2.970e-03 S  per = 1.85  per(accum) = 4.43
 T(local opt: hmmtasks init               ) = 2.585e-04 S  per = 0.161  per(accum) = 4.59
 T(local opt: initial guess for dvdson    ) = 7.367e-04 S  per = 0.458  per(accum) = 5.05
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.252e-01 S  per = 77.8  per(accum) = 82.9
 T(local opt: dvdson [cpu-gpu]            ) = 4.380e-03 S  per = 2.72  per(accum) = 85.6
 T(local opt: dvdson [nccl]               ) = 2.279e-02 S  per = 14.2  per(accum) = 99.8
 T(local opt: dvdson [mpi]                ) = 8.190e-07 S  per = 0.000509  per(accum) = 99.8
 T(local opt: dvdson [rest part(linalg)]  ) = 4.000e-04 S  per = 0.249  per(accum) = 100
Detailed decomposition of T(renrm) = 6.117e-01 S  T(sum) = 6.117e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.035e-04 S  per = 0.0169  per(accum) = 0.0169
 T(local opt: qops init                    ) = 2.885e-04 S  per = 0.0472  per(accum) = 0.0641
 T(local opt: symbolic_formulae_renorm     ) = 1.123e-04 S  per = 0.0184  per(accum) = 0.0824
 T(local opt: allocate qops on gpu         ) = 5.554e-05 S  per = 0.00908  per(accum) = 0.0915
 T(local opt: site memcpy cpu2gpu          ) = 2.097e-03 S  per = 0.343  per(accum) = 0.434
 T(local opt: rintermediate init           ) = 2.035e-05 S  per = 0.00333  per(accum) = 0.438
 T(local opt: preprocess_formulae_Rlist2   ) = 3.178e-04 S  per = 0.052  per(accum) = 0.49
 T(local opt: rmmtasks init                ) = 1.964e-04 S  per = 0.0321  per(accum) = 0.522
 T(local opt: qops memset on cpu           ) = 3.700e-08 S  per = 6.05e-06  per(accum) = 0.522
 T(local opt: preprocess_renorm_batchGPU   ) = 3.456e-02 S  per = 5.65  per(accum) = 6.17
 T(local opt: deallocate cpu and gpu memory) = 1.981e-05 S  per = 0.00324  per(accum) = 6.18
 T(local opt: construct opS [ifdists=true] ) = 5.693e-01 S  per = 93.1  per(accum) = 99.3
 T(local opt: reduction of opS & opH [nccl]) = 2.388e-03 S  per = 0.39  per(accum) = 99.6
 T(local opt: qops memcpy gpu2cpu          ) = 5.077e-05 S  per = 0.0083  per(accum) = 99.7
 T(local opt: reduction of opS & opH [mpi] ) = 2.361e-05 S  per = 0.00386  per(accum) = 99.7
 T(local opt: qops_pool join and erase     ) = 2.114e-03 S  per = 0.346  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.601e-06 S  per = 0.000425  per(accum) = 100
##### sweep opt: 8.513e-01 S #####
 T(sweep opt: fetch) = 3.190e-02 S  per = 3.75  per(accum) = 3.75
 T(sweep opt: hdiag) = 4.491e-02 S  per = 5.28  per(accum) = 9.02
 T(sweep opt: dvdsn) = 1.611e-01 S  per = 18.9  per(accum) = 28
 T(sweep opt: decim) = 9.579e-04 S  per = 0.113  per(accum) = 28.1
 T(sweep opt: guess) = 5.217e-04 S  per = 0.0613  per(accum) = 28.1
 T(sweep opt: renrm) = 6.117e-01 S  per = 71.9  per(accum) = 100
 T(sweep opt: save ) = 1.668e-04 S  per = 0.0196  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.611e-01 S  T(sum) = 1.609e-01 S  per = 9.986e+01
 T(sweep opt: preprocess                  ) = 2.901e-03 S  per =  1.8  per(accum) = 1.8
 T(sweep opt: symbolic_formulae           ) = 1.171e-03 S  per = 0.728  per(accum) = 2.53
 T(sweep opt: hintermediate init          ) = 8.364e-05 S  per = 0.052  per(accum) = 2.58
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.970e-03 S  per = 1.85  per(accum) = 4.43
 T(sweep opt: hmmtasks init               ) = 2.585e-04 S  per = 0.161  per(accum) = 4.59
 T(sweep opt: initial guess for dvdson    ) = 7.367e-04 S  per = 0.458  per(accum) = 5.05
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.252e-01 S  per = 77.8  per(accum) = 82.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.380e-03 S  per = 2.72  per(accum) = 85.6
 T(sweep opt: dvdson [nccl]               ) = 2.279e-02 S  per = 14.2  per(accum) = 99.8
 T(sweep opt: dvdson [mpi]                ) = 8.190e-07 S  per = 0.000509  per(accum) = 99.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 4.000e-04 S  per = 0.249  per(accum) = 100
Detailed decomposition of T(renrm) = 6.117e-01 S  T(sum) = 6.117e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.035e-04 S  per = 0.0169  per(accum) = 0.0169
 T(sweep opt: qops init                    ) = 2.885e-04 S  per = 0.0472  per(accum) = 0.0641
 T(sweep opt: symbolic_formulae_renorm     ) = 1.123e-04 S  per = 0.0184  per(accum) = 0.0824
 T(sweep opt: allocate qops on gpu         ) = 5.554e-05 S  per = 0.00908  per(accum) = 0.0915
 T(sweep opt: site memcpy cpu2gpu          ) = 2.097e-03 S  per = 0.343  per(accum) = 0.434
 T(sweep opt: rintermediate init           ) = 2.035e-05 S  per = 0.00333  per(accum) = 0.438
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.178e-04 S  per = 0.052  per(accum) = 0.49
 T(sweep opt: rmmtasks init                ) = 1.964e-04 S  per = 0.0321  per(accum) = 0.522
 T(sweep opt: qops memset on cpu           ) = 3.700e-08 S  per = 6.05e-06  per(accum) = 0.522
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.456e-02 S  per = 5.65  per(accum) = 6.17
 T(sweep opt: deallocate cpu and gpu memory) = 1.981e-05 S  per = 0.00324  per(accum) = 6.18
 T(sweep opt: construct opS [ifdists=true] ) = 5.693e-01 S  per = 93.1  per(accum) = 99.3
 T(sweep opt: reduction of opS & opH [nccl]) = 2.388e-03 S  per = 0.39  per(accum) = 99.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.077e-05 S  per = 0.0083  per(accum) = 99.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.361e-05 S  per = 0.00386  per(accum) = 99.7
 T(sweep opt: qops_pool join and erase     ) = 2.114e-03 S  per = 0.346  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 2.601e-06 S  per = 0.000425  per(accum) = 100
##### global opt: 8.513e-01 S #####
 T(global opt: fetch) = 3.190e-02 S  per = 3.75  per(accum) = 3.75
 T(global opt: hdiag) = 4.491e-02 S  per = 5.28  per(accum) = 9.02
 T(global opt: dvdsn) = 1.611e-01 S  per = 18.9  per(accum) = 28
 T(global opt: decim) = 9.579e-04 S  per = 0.113  per(accum) = 28.1
 T(global opt: guess) = 5.217e-04 S  per = 0.0613  per(accum) = 28.1
 T(global opt: renrm) = 6.117e-01 S  per = 71.9  per(accum) = 100
 T(global opt: save ) = 1.668e-04 S  per = 0.0196  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.611e-01 S  T(sum) = 1.609e-01 S  per = 9.986e+01
 T(global opt: preprocess                  ) = 2.901e-03 S  per =  1.8  per(accum) = 1.8
 T(global opt: symbolic_formulae           ) = 1.171e-03 S  per = 0.728  per(accum) = 2.53
 T(global opt: hintermediate init          ) = 8.364e-05 S  per = 0.052  per(accum) = 2.58
 T(global opt: preprocess_hformulae_Hxlist ) = 2.970e-03 S  per = 1.85  per(accum) = 4.43
 T(global opt: hmmtasks init               ) = 2.585e-04 S  per = 0.161  per(accum) = 4.59
 T(global opt: initial guess for dvdson    ) = 7.367e-04 S  per = 0.458  per(accum) = 5.05
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.252e-01 S  per = 77.8  per(accum) = 82.9
 T(global opt: dvdson [cpu-gpu]            ) = 4.380e-03 S  per = 2.72  per(accum) = 85.6
 T(global opt: dvdson [nccl]               ) = 2.279e-02 S  per = 14.2  per(accum) = 99.8
 T(global opt: dvdson [mpi]                ) = 8.190e-07 S  per = 0.000509  per(accum) = 99.8
 T(global opt: dvdson [rest part(linalg)]  ) = 4.000e-04 S  per = 0.249  per(accum) = 100
Detailed decomposition of T(renrm) = 6.117e-01 S  T(sum) = 6.117e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.035e-04 S  per = 0.0169  per(accum) = 0.0169
 T(global opt: qops init                    ) = 2.885e-04 S  per = 0.0472  per(accum) = 0.0641
 T(global opt: symbolic_formulae_renorm     ) = 1.123e-04 S  per = 0.0184  per(accum) = 0.0824
 T(global opt: allocate qops on gpu         ) = 5.554e-05 S  per = 0.00908  per(accum) = 0.0915
 T(global opt: site memcpy cpu2gpu          ) = 2.097e-03 S  per = 0.343  per(accum) = 0.434
 T(global opt: rintermediate init           ) = 2.035e-05 S  per = 0.00333  per(accum) = 0.438
 T(global opt: preprocess_formulae_Rlist2   ) = 3.178e-04 S  per = 0.052  per(accum) = 0.49
 T(global opt: rmmtasks init                ) = 1.964e-04 S  per = 0.0321  per(accum) = 0.522
 T(global opt: qops memset on cpu           ) = 3.700e-08 S  per = 6.05e-06  per(accum) = 0.522
 T(global opt: preprocess_renorm_batchGPU   ) = 3.456e-02 S  per = 5.65  per(accum) = 6.17
 T(global opt: deallocate cpu and gpu memory) = 1.981e-05 S  per = 0.00324  per(accum) = 6.18
 T(global opt: construct opS [ifdists=true] ) = 5.693e-01 S  per = 93.1  per(accum) = 99.3
 T(global opt: reduction of opS & opH [nccl]) = 2.388e-03 S  per = 0.39  per(accum) = 99.6
 T(global opt: qops memcpy gpu2cpu          ) = 5.077e-05 S  per = 0.0083  per(accum) = 99.7
 T(global opt: reduction of opS & opH [mpi] ) = 2.361e-05 S  per = 0.00386  per(accum) = 99.7
 T(global opt: qops_pool join and erase     ) = 2.114e-03 S  per = 0.346  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 2.601e-06 S  per = 0.000425  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.989e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=1/seqsize=34 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=96:7.324e-04MB:7.153e-07GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=2:1.526e-05MB:1.490e-08GB
total mem of comb=99:7.553e-04MB:7.376e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,16,1,1
 suppl= 0 1
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:2 S:9 A:1 B:4 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=19:1.450e-04MB:1.416e-07GB
        per(mem): H:10.5 C:10.5 S:47.4 A:0 B:31.6 
 rqops: oplist=HCSPQ nops=H:1 C:16 S:2 P:8 Q:10 
        dim(bra,ket)=4,4 size(op)=10:7.63e-05MB size(tot)=74:0.000565MB:5.51e-07GB
        per(mem): H:5.41 C:0 S:0 P:0 Q:94.6 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2089:0.0159MB:1.56e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.505e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.788e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(2,4,3,3) nnz=3:2.289e-05MB
qtensor4: wf4 own=1 _data=0x3b203be0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=2 dimAll=2
 (4,0):1 (3,1):1
 qbond: qcol nsym=4 dimAll=4
 (24,2):1 (24,4):1 (24,6):1 (24,8):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=3 nblocks=112 size=3:2.289e-05MB
### DIAG TIMING: total=8.380e-02 t1=2.465e-05, t2=1.816e-03, t3=2.468e-03, t4=7.694e-02, t5=3.125e-06, t6=2.535e-03, t7=3.985e-06
duration_diagGPU:8.382e-02
duration_diagreduce:6.900e-08
duration_diagtransform:1.580e-07
----- TIMING FOR symbolic_formulae_twodot with size=107 : 1.343e-03 S -----
rank=0 GPUmem(GB): used=1.556e-05 (oper)=1.556e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=107
 no. of hintermediate operators=42
 no. of coefficients=518:3.952e-03MB:3.859e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 8.246e-05 S -----
rank=0 GPUmem(GB): used=1.942e-05 (oper,hinter)=1.556e-05,3.859e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.523e-03 S size(H_formulae)=107 size(Hxlst2)=3 T(Hmu/Hxlist)=2.490e-04,3.274e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.545e-03 S size(H_formulae)=107 size(Hxlst)=124 -----
rank=0 GPUmem(GB): used=1.942e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=4.470e-08 batch[need]=3.695e-06 blksize=1 blksize0=1 batchsize=124
rank=0 GPUmem(GB): used=2.316e-05 (oper,hinter,dvdson,batch)=1.556e-05,3.859e-06,4.470e-08,3.695e-06
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=3 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.526e-03,7.580e-03,2.972e-02,1.260e-02,5.643e-02
 analyze_tgpu[Hx]: ndim=3:2.235e-08GB T(cpu-gpu)=1.547e-03 speed=2.889e-05GB/S T(nccl)=4.979e-03 speed=8.979e-06GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=4 t=7.6e-03 per=1.5e+01 cost=1.1e+02 flops=1.5e+04
 sigma[gemm] counter=4 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=4 t=7.5e-03 per=1.5e+01 cost=4.4e+01 flops=5.9e+03
 sigma[gemm] counter=4 i=5 t=7.4e-03 per=1.5e+01 cost=4.4e+01 flops=5.9e+03
 sigma[gemm] counter=4 i=6 t=7.4e-03 per=1.5e+01 cost=8.8e+01 flops=1.2e+04
 sigma[gemm] counter=4 i=7 t=7.4e-03 per=1.5e+01 cost=8.8e+01 flops=1.2e+04
 sigma[gemm] counter=4 total t=3.0e-02 per=6.0e+01 cost=2.6e+02 flops=8.9e+03
 sigma[red] counter=4 t=1.3e-02 per=2.5e+01 cost=2.5e+02 flops=2.0e+04
----- TIMING FOR sigma_tot : t_inter=7.6e-03 t_gemm=1.2e-01 t_reduction=5.0e-02 tot=1.7e-01 -----
 sigma_tot[inter] counter=4 t=7.6e-03 per=4.4e+00 cost=1.1e+02 flops=1.5e+04
 sigma_tot[gemm] counter=4 i=0 t=6.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=1 t=5.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=2 t=5.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=3 t=5.0e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=4 t=2.8e-02 per=1.6e+01 cost=1.3e+02 flops=4.6e+03
 sigma_tot[gemm] counter=4 i=5 t=3.0e-02 per=1.7e+01 cost=1.3e+02 flops=4.3e+03
 sigma_tot[gemm] counter=4 i=6 t=3.0e-02 per=1.7e+01 cost=2.0e+02 flops=6.6e+03
 sigma_tot[gemm] counter=4 i=7 t=3.0e-02 per=1.7e+01 cost=2.0e+02 flops=6.6e+03
 sigma_tot[gemm] counter=4 total t=1.2e-01 per=6.7e+01 cost=6.5e+02 flops=5.5e+03
 sigma_tot[red] counter=4 t=5.0e-02 per=2.9e+01 cost=6.4e+02 flops=1.3e+04
T(sub)=9.1e-06 T(gemm/eig/ortho/gemm/axpy)=2.3e-06,3.9e-06,2.0e-06,7.1e-07,1.7e-07
settings: ndim=3 neig=1 maxcycle=30 nbuff=4 memory=2e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.091268021088 -1.116e+03  4.686e-02    1     1  5.666e-02 5.666e-02 5.663e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.185e-03,7.541e-03,3.009e-02,1.249e-02,5.731e-02
 analyze_tgpu[Hx]: ndim=3:2.235e-08GB T(cpu-gpu)=2.162e-03 speed=2.068e-05GB/S T(nccl)=5.023e-03 speed=8.900e-06GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.0e-02 -----
 sigma[inter] counter=5 t=7.5e-03 per=1.5e+01 cost=1.1e+02 flops=1.5e+04
 sigma[gemm] counter=5 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=4 t=7.6e-03 per=1.5e+01 cost=4.4e+01 flops=5.8e+03
 sigma[gemm] counter=5 i=5 t=7.6e-03 per=1.5e+01 cost=4.4e+01 flops=5.8e+03
 sigma[gemm] counter=5 i=6 t=7.5e-03 per=1.5e+01 cost=8.8e+01 flops=1.2e+04
 sigma[gemm] counter=5 i=7 t=7.4e-03 per=1.5e+01 cost=8.8e+01 flops=1.2e+04
 sigma[gemm] counter=5 total t=3.0e-02 per=6.0e+01 cost=2.6e+02 flops=8.8e+03
 sigma[red] counter=5 t=1.2e-02 per=2.5e+01 cost=2.5e+02 flops=2.0e+04
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=1.5e-01 t_reduction=6.3e-02 tot=2.2e-01 -----
 sigma_tot[inter] counter=5 t=1.5e-02 per=6.7e+00 cost=2.2e+02 flops=1.5e+04
 sigma_tot[gemm] counter=5 i=0 t=7.5e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=1 t=6.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=2 t=6.2e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=3 t=6.2e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=4 t=3.5e-02 per=1.6e+01 cost=1.7e+02 flops=4.9e+03
 sigma_tot[gemm] counter=5 i=5 t=3.7e-02 per=1.7e+01 cost=1.7e+02 flops=4.6e+03
 sigma_tot[gemm] counter=5 i=6 t=3.7e-02 per=1.7e+01 cost=2.8e+02 flops=7.6e+03
 sigma_tot[gemm] counter=5 i=7 t=3.7e-02 per=1.7e+01 cost=2.8e+02 flops=7.6e+03
 sigma_tot[gemm] counter=5 total t=1.5e-01 per=6.5e+01 cost=9.1e+02 flops=6.2e+03
 sigma_tot[red] counter=5 t=6.3e-02 per=2.8e+01 cost=8.9e+02 flops=1.4e+04
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.0e-05,3.5e-06,8.5e-07,1.7e-07
    2   0 -    -116.112524332765 -2.126e-02  9.419e-03    2     2  1.143e-01 5.713e-02 5.704e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.312e-03,7.589e-03,3.025e-02,1.258e-02,5.774e-02
 analyze_tgpu[Hx]: ndim=3:2.235e-08GB T(cpu-gpu)=2.272e-03 speed=1.967e-05GB/S T(nccl)=5.040e-03 speed=8.870e-06GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=6 t=7.6e-03 per=1.5e+01 cost=1.1e+02 flops=1.5e+04
 sigma[gemm] counter=6 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=4 t=7.6e-03 per=1.5e+01 cost=4.4e+01 flops=5.8e+03
 sigma[gemm] counter=6 i=5 t=7.6e-03 per=1.5e+01 cost=4.4e+01 flops=5.8e+03
 sigma[gemm] counter=6 i=6 t=7.5e-03 per=1.5e+01 cost=8.8e+01 flops=1.2e+04
 sigma[gemm] counter=6 i=7 t=7.6e-03 per=1.5e+01 cost=8.8e+01 flops=1.2e+04
 sigma[gemm] counter=6 total t=3.0e-02 per=6.0e+01 cost=2.6e+02 flops=8.7e+03
 sigma[red] counter=6 t=1.3e-02 per=2.5e+01 cost=2.5e+02 flops=2.0e+04
----- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=1.8e-01 t_reduction=7.5e-02 tot=2.8e-01 -----
 sigma_tot[inter] counter=6 t=2.3e-02 per=8.3e+00 cost=3.4e+02 flops=1.5e+04
 sigma_tot[gemm] counter=6 i=0 t=8.8e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=1 t=7.6e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=2 t=7.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=3 t=7.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=4 t=4.3e-02 per=1.6e+01 cost=2.2e+02 flops=5.0e+03
 sigma_tot[gemm] counter=6 i=5 t=4.5e-02 per=1.6e+01 cost=2.2e+02 flops=4.8e+03
 sigma_tot[gemm] counter=6 i=6 t=4.5e-02 per=1.6e+01 cost=3.7e+02 flops=8.3e+03
 sigma_tot[gemm] counter=6 i=7 t=4.5e-02 per=1.6e+01 cost=3.7e+02 flops=8.3e+03
 sigma_tot[gemm] counter=6 total t=1.8e-01 per=6.4e+01 cost=1.2e+03 flops=6.6e+03
 sigma_tot[red] counter=6 t=7.5e-02 per=2.7e+01 cost=1.1e+03 flops=1.5e+04
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.5e-05,2.9e-06,9.6e-07,2.0e-07
    3   0 +    -116.113157849033 -6.335e-04  2.053e-14    3     3  1.724e-01 5.745e-02 5.735e-02
TIMING FOR Davidson : 1.724e-01  T(cal/comm/rest)=1.720e-01,9.910e-07,3.667e-04
decomposed t_rest=3.667e-04
 T(sub)    =5.019e-05 per=1.369e+01
 T(precond)=1.605e-05 per=4.376e+00
 T(ortho)  =4.773e-06 per=1.302e+00
 T(xcopy)  =4.970e-07 per=1.355e-01
 T(xnrm2)  =1.298e-06 per=3.540e-01
 T(other)  =2.939e-04 per=8.015e+01
optimized energies: isweep=0 ibond=1 dots=2 e[0]=-116.113157849033 nmvp=3
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=1.823e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=5 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond1.txt
 qbond: qsuper nsym=5 dimAll=7
 (4,0):2 (6,0):1 (5,1):2 (3,1):1 (4,2):1
timing for divide=5.3e-05
timing for compute=3.5e-05
timing for collect=1.1e-05
----- TMING FOR decimation_genbasis(su2): 9.9e-05 S T(divide/compute[cpu/gpu/rest]/collect)=5.3e-05,2.6e-05,0.0e+00,9.0e-06,1.1e-05 -----
decimation summary: 7->2 dwt=+0.000e+00 SvN=4.688e-01
 qbond: qkept nsym=2 dimAll=2
 (5,1):1 (4,2):1
----- TIMING for decimation_row(nkr): 3.031e-04 S T(decim/select/formRot)=1.466e-04,1.221e-04,3.439e-05 -----
----- TIMING FOR twodot_decimation: 5.829e-04 S T(wf/decim)=2.681e-04,3.148e-04 -----
ctns::oper_renorm coord=(2,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:3 S:9 A:4 B:7 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=28:2.136e-04MB:2.086e-07GB
        per(mem): H:7.14 C:10.7 S:32.1 A:0 B:50 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=3.052e-05 change=1.028e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=15 : 1.813e-04 S -----
rank=0 GPUmem(GB): used=1.908e-05 (oper)=7.786e-06
rank=0 GPUmem(GB): used=1.910e-05 (oper,site)=7.786e-06,2.235e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=15
 no. of rintermediate operators=4
 no. of coefficients=8:6.104e-05MB:5.960e-08GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.516e-03 S -----
rank=0 GPUmem(GB): used=1.916e-05 (oper,site,rinter)=7.786e-06,2.235e-08,5.960e-08
----- TIMING FOR preprocess_formulae_Rlist2 : 4.738e-04 S size(rtasks)=15 size(Rlst2)=4 T(Rmu/Rlist)=4.977e-05,4.240e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.939e-04 S size(rtasks)=15 size(Rlst)=48 -----
rank=0 GPUmem(GB): used=1.916e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.431e-06 blksize=1 blksize0=1 batchsize=48
rank=0 GPUmem(GB): used=2.059e-05 (oper,site,rinter,batch)=7.786e-06,2.235e-08,5.960e-08,1.431e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.074e-03,2.238e-02,1.006e-02
----- TIMING FOR renorm : t_inter=9.1e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=4.2e-02 -----
 renorm[inter] counter=20 t=9.1e-03 per=2.2e+01 cost=6.4e+01 flops=7.1e+03
 renorm[gemm] counter=20 i=0 t=1.3e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=2 t=1.1e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=3 t=1.1e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=20 i=4 t=7.4e-03 per=1.8e+01 cost=2.4e+01 flops=3.2e+03
 renorm[gemm] counter=20 i=5 t=7.4e-03 per=1.8e+01 cost=5.2e+01 flops=7.0e+03
 renorm[gemm] counter=20 i=6 t=7.5e-03 per=1.8e+01 cost=9.6e+01 flops=1.3e+04
 renorm[gemm] counter=20 total t=2.2e-02 per=5.4e+01 cost=1.7e+02 flops=7.7e+03
 renorm[red] counter=20 t=1.0e-02 per=2.4e+01 cost=9.6e+01 flops=9.5e+03
----- TIMING FOR renorm_tot : t_inter=1.1e-02 t_gemm=4.5e-02 t_reduction=2.0e-02 tot=7.6e-02 -----
 renorm_tot[inter] counter=20 t=1.1e-02 per=1.4e+01 cost=6.4e+01 flops=5.8e+03
 renorm_tot[gemm] counter=20 i=0 t=3.0e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=1 t=2.3e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=2 t=2.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=3 t=2.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=20 i=4 t=1.5e-02 per=2.0e+01 cost=3.8e+01 flops=2.5e+03
 renorm_tot[gemm] counter=20 i=5 t=1.5e-02 per=2.0e+01 cost=8.0e+01 flops=5.3e+03
 renorm_tot[gemm] counter=20 i=6 t=1.5e-02 per=2.0e+01 cost=1.5e+02 flops=1.0e+04
 renorm_tot[gemm] counter=20 total t=4.5e-02 per=5.9e+01 cost=2.7e+02 flops=6.0e+03
 renorm_tot[red] counter=20 t=2.0e-02 per=2.6e+01 cost=1.5e+02 flops=7.6e+03
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.056e-05 (optmp,oper)=7.451e-09,7.786e-06
rank=0 GPUmem(GB): used=2.059e-05 (optmp,oper,site,rinter)=7.451e-09,7.786e-06,2.235e-08,1.416e-06
rank=0 GPUmem(GB): used=2.082e-05 (optmp,oper,site,rinter,batch)=7.451e-09,7.786e-06,2.235e-08,1.416e-06,2.384e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 7.523e-01 S T(prep/alloc/comp/red/dealloc)=4.028e-02,4.379e-02,6.170e-01,8.888e-02,2.559e-03 -----
----- TIMING FOR oper_renorm_opS : 7.524e-01 S rank=0 -----
qops.to_cpu: size(tot)=28:2.136e-04MB:2.086e-07GB T(to_cpu)=5.539e-05S speed=3.766e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.801 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.526e-05 change=2.502e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.526e-05 change=-8.848e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=1.526e-05 change=-8.345e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.077e+00 S #####
 T(local opt: fetch) = 9.825e-03 S  per = 0.912  per(accum) = 0.912
 T(local opt: hdiag) = 8.410e-02 S  per = 7.81  per(accum) = 8.72
 T(local opt: dvdsn) = 1.802e-01 S  per = 16.7  per(accum) = 25.4
 T(local opt: decim) = 6.485e-04 S  per = 0.0602  per(accum) = 25.5
 T(local opt: guess) = 3.817e-04 S  per = 0.0354  per(accum) = 25.5
 T(local opt: renrm) = 8.022e-01 S  per = 74.5  per(accum) = 100
 T(local opt: save ) = 1.674e-04 S  per = 0.0155  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.802e-01 S  T(sum) = 1.800e-01 S  per = 9.990e+01
 T(local opt: preprocess                  ) = 1.573e-03 S  per = 0.874  per(accum) = 0.874
 T(local opt: symbolic_formulae           ) = 1.357e-03 S  per = 0.754  per(accum) = 1.63
 T(local opt: hintermediate init          ) = 1.015e-04 S  per = 0.0564  per(accum) = 1.68
 T(local opt: preprocess_hformulae_Hxlist ) = 3.554e-03 S  per = 1.97  per(accum) = 3.66
 T(local opt: hmmtasks init               ) = 5.149e-04 S  per = 0.286  per(accum) = 3.95
 T(local opt: initial guess for dvdson    ) = 4.656e-04 S  per = 0.259  per(accum) = 4.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.510e-01 S  per = 83.9  per(accum) = 88.1
 T(local opt: dvdson [cpu-gpu]            ) = 5.981e-03 S  per = 3.32  per(accum) = 91.4
 T(local opt: dvdson [nccl]               ) = 1.504e-02 S  per = 8.36  per(accum) = 99.8
 T(local opt: dvdson [mpi]                ) = 9.910e-07 S  per = 0.000551  per(accum) = 99.8
 T(local opt: dvdson [rest part(linalg)]  ) = 3.667e-04 S  per = 0.204  per(accum) = 100
Detailed decomposition of T(renrm) = 8.022e-01 S  T(sum) = 8.022e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.045e-04 S  per = 0.013  per(accum) = 0.013
 T(local opt: qops init                    ) = 3.571e-04 S  per = 0.0445  per(accum) = 0.0576
 T(local opt: symbolic_formulae_renorm     ) = 1.930e-04 S  per = 0.0241  per(accum) = 0.0816
 T(local opt: allocate qops on gpu         ) = 5.351e-05 S  per = 0.00667  per(accum) = 0.0883
 T(local opt: site memcpy cpu2gpu          ) = 2.791e-04 S  per = 0.0348  per(accum) = 0.123
 T(local opt: rintermediate init           ) = 2.532e-03 S  per = 0.316  per(accum) = 0.439
 T(local opt: preprocess_formulae_Rlist2   ) = 5.061e-04 S  per = 0.0631  per(accum) = 0.502
 T(local opt: rmmtasks init                ) = 3.323e-04 S  per = 0.0414  per(accum) = 0.543
 T(local opt: qops memset on cpu           ) = 3.800e-08 S  per = 4.74e-06  per(accum) = 0.543
 T(local opt: preprocess_renorm_batchGPU   ) = 4.163e-02 S  per = 5.19  per(accum) = 5.73
 T(local opt: deallocate cpu and gpu memory) = 2.130e-05 S  per = 0.00266  per(accum) = 5.74
 T(local opt: construct opS [ifdists=true] ) = 7.524e-01 S  per = 93.8  per(accum) = 99.5
 T(local opt: reduction of opS & opH [nccl]) = 2.283e-03 S  per = 0.285  per(accum) = 99.8
 T(local opt: qops memcpy gpu2cpu          ) = 6.732e-05 S  per = 0.00839  per(accum) = 99.8
 T(local opt: reduction of opS & opH [mpi] ) = 2.404e-05 S  per = 0.003  per(accum) = 99.8
 T(local opt: qops_pool join and erase     ) = 1.364e-03 S  per = 0.17  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.716e-06 S  per = 0.000339  per(accum) = 100
##### sweep opt: 1.929e+00 S #####
 T(sweep opt: fetch) = 4.172e-02 S  per = 2.16  per(accum) = 2.16
 T(sweep opt: hdiag) = 1.290e-01 S  per = 6.69  per(accum) = 8.85
 T(sweep opt: dvdsn) = 3.413e-01 S  per = 17.7  per(accum) = 26.5
 T(sweep opt: decim) = 1.606e-03 S  per = 0.0833  per(accum) = 26.6
 T(sweep opt: guess) = 9.034e-04 S  per = 0.0468  per(accum) = 26.7
 T(sweep opt: renrm) = 1.414e+00 S  per = 73.3  per(accum) = 100
 T(sweep opt: save ) = 3.342e-04 S  per = 0.0173  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.413e-01 S  T(sum) = 3.409e-01 S  per = 9.988e+01
 T(sweep opt: preprocess                  ) = 4.474e-03 S  per = 1.31  per(accum) = 1.31
 T(sweep opt: symbolic_formulae           ) = 2.528e-03 S  per = 0.742  per(accum) = 2.05
 T(sweep opt: hintermediate init          ) = 1.851e-04 S  per = 0.0543  per(accum) = 2.11
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.524e-03 S  per = 1.91  per(accum) = 4.02
 T(sweep opt: hmmtasks init               ) = 7.734e-04 S  per = 0.227  per(accum) = 4.25
 T(sweep opt: initial guess for dvdson    ) = 1.202e-03 S  per = 0.353  per(accum) = 4.6
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.762e-01 S  per =   81  per(accum) = 85.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.036e-02 S  per = 3.04  per(accum) = 88.7
 T(sweep opt: dvdson [nccl]               ) = 3.783e-02 S  per = 11.1  per(accum) = 99.8
 T(sweep opt: dvdson [mpi]                ) = 1.810e-06 S  per = 0.000531  per(accum) = 99.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.667e-04 S  per = 0.225  per(accum) = 100
Detailed decomposition of T(renrm) = 1.414e+00 S  T(sum) = 1.414e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.080e-04 S  per = 0.0147  per(accum) = 0.0147
 T(sweep opt: qops init                    ) = 6.456e-04 S  per = 0.0457  per(accum) = 0.0604
 T(sweep opt: symbolic_formulae_renorm     ) = 3.053e-04 S  per = 0.0216  per(accum) = 0.082
 T(sweep opt: allocate qops on gpu         ) = 1.091e-04 S  per = 0.00771  per(accum) = 0.0897
 T(sweep opt: site memcpy cpu2gpu          ) = 2.377e-03 S  per = 0.168  per(accum) = 0.258
 T(sweep opt: rintermediate init           ) = 2.553e-03 S  per = 0.181  per(accum) = 0.438
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.239e-04 S  per = 0.0583  per(accum) = 0.497
 T(sweep opt: rmmtasks init                ) = 5.288e-04 S  per = 0.0374  per(accum) = 0.534
 T(sweep opt: qops memset on cpu           ) = 7.500e-08 S  per = 5.3e-06  per(accum) = 0.534
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.620e-02 S  per = 5.39  per(accum) = 5.92
 T(sweep opt: deallocate cpu and gpu memory) = 4.111e-05 S  per = 0.00291  per(accum) = 5.93
 T(sweep opt: construct opS [ifdists=true] ) = 1.322e+00 S  per = 93.5  per(accum) = 99.4
 T(sweep opt: reduction of opS & opH [nccl]) = 4.671e-03 S  per = 0.33  per(accum) = 99.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.181e-04 S  per = 0.00835  per(accum) = 99.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.765e-05 S  per = 0.00337  per(accum) = 99.8
 T(sweep opt: qops_pool join and erase     ) = 3.478e-03 S  per = 0.246  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 5.317e-06 S  per = 0.000376  per(accum) = 100
##### global opt: 1.929e+00 S #####
 T(global opt: fetch) = 4.172e-02 S  per = 2.16  per(accum) = 2.16
 T(global opt: hdiag) = 1.290e-01 S  per = 6.69  per(accum) = 8.85
 T(global opt: dvdsn) = 3.413e-01 S  per = 17.7  per(accum) = 26.5
 T(global opt: decim) = 1.606e-03 S  per = 0.0833  per(accum) = 26.6
 T(global opt: guess) = 9.034e-04 S  per = 0.0468  per(accum) = 26.7
 T(global opt: renrm) = 1.414e+00 S  per = 73.3  per(accum) = 100
 T(global opt: save ) = 3.342e-04 S  per = 0.0173  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.413e-01 S  T(sum) = 3.409e-01 S  per = 9.988e+01
 T(global opt: preprocess                  ) = 4.474e-03 S  per = 1.31  per(accum) = 1.31
 T(global opt: symbolic_formulae           ) = 2.528e-03 S  per = 0.742  per(accum) = 2.05
 T(global opt: hintermediate init          ) = 1.851e-04 S  per = 0.0543  per(accum) = 2.11
 T(global opt: preprocess_hformulae_Hxlist ) = 6.524e-03 S  per = 1.91  per(accum) = 4.02
 T(global opt: hmmtasks init               ) = 7.734e-04 S  per = 0.227  per(accum) = 4.25
 T(global opt: initial guess for dvdson    ) = 1.202e-03 S  per = 0.353  per(accum) = 4.6
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.762e-01 S  per =   81  per(accum) = 85.6
 T(global opt: dvdson [cpu-gpu]            ) = 1.036e-02 S  per = 3.04  per(accum) = 88.7
 T(global opt: dvdson [nccl]               ) = 3.783e-02 S  per = 11.1  per(accum) = 99.8
 T(global opt: dvdson [mpi]                ) = 1.810e-06 S  per = 0.000531  per(accum) = 99.8
 T(global opt: dvdson [rest part(linalg)]  ) = 7.667e-04 S  per = 0.225  per(accum) = 100
Detailed decomposition of T(renrm) = 1.414e+00 S  T(sum) = 1.414e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.080e-04 S  per = 0.0147  per(accum) = 0.0147
 T(global opt: qops init                    ) = 6.456e-04 S  per = 0.0457  per(accum) = 0.0604
 T(global opt: symbolic_formulae_renorm     ) = 3.053e-04 S  per = 0.0216  per(accum) = 0.082
 T(global opt: allocate qops on gpu         ) = 1.091e-04 S  per = 0.00771  per(accum) = 0.0897
 T(global opt: site memcpy cpu2gpu          ) = 2.377e-03 S  per = 0.168  per(accum) = 0.258
 T(global opt: rintermediate init           ) = 2.553e-03 S  per = 0.181  per(accum) = 0.438
 T(global opt: preprocess_formulae_Rlist2   ) = 8.239e-04 S  per = 0.0583  per(accum) = 0.497
 T(global opt: rmmtasks init                ) = 5.288e-04 S  per = 0.0374  per(accum) = 0.534
 T(global opt: qops memset on cpu           ) = 7.500e-08 S  per = 5.3e-06  per(accum) = 0.534
 T(global opt: preprocess_renorm_batchGPU   ) = 7.620e-02 S  per = 5.39  per(accum) = 5.92
 T(global opt: deallocate cpu and gpu memory) = 4.111e-05 S  per = 0.00291  per(accum) = 5.93
 T(global opt: construct opS [ifdists=true] ) = 1.322e+00 S  per = 93.5  per(accum) = 99.4
 T(global opt: reduction of opS & opH [nccl]) = 4.671e-03 S  per = 0.33  per(accum) = 99.7
 T(global opt: qops memcpy gpu2cpu          ) = 1.181e-04 S  per = 0.00835  per(accum) = 99.8
 T(global opt: reduction of opS & opH [mpi] ) = 4.765e-05 S  per = 0.00337  per(accum) = 99.8
 T(global opt: qops_pool join and erase     ) = 3.478e-03 S  per = 0.246  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 5.317e-06 S  per = 0.000376  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-1.814e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=2/seqsize=34 dots=2 dbond=(3,0)-(4,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=89:6.790e-04MB:6.631e-07GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=2:1.526e-05MB:1.490e-08GB
total mem of comb=92:7.019e-04MB:6.855e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=3,15,1,1
 suppl= 0 1 2
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 3
 suppc2= 4
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:3 S:9 A:4 B:7 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=28:2.136e-04MB:2.086e-07GB
        per(mem): H:7.14 C:10.7 S:32.1 A:0 B:50 
 rqops: oplist=HCSPQ nops=H:1 C:15 S:2 P:12 Q:16 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=83:0.000633MB:6.18e-07GB
        per(mem): H:3.61 C:0 S:0 P:0 Q:96.4 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2107:0.0161MB:1.57e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.454e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(3,0) fdel=./scratch/sweep/rop(4,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.384e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(2,3,3,3) nnz=3:2.289e-05MB
qtensor4: wf4 own=1 _data=0x3ac0d5c0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=2 dimAll=2
 (5,1):1 (4,2):1
 qbond: qcol nsym=3 dimAll=3
 (23,3):1 (23,5):1 (23,7):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=3 nblocks=96 size=3:2.289e-05MB
### DIAG TIMING: total=1.334e-01 t1=2.485e-05, t2=1.741e-03, t3=2.458e-03, t4=1.267e-01, t5=3.223e-06, t6=2.461e-03, t7=3.950e-06
duration_diagGPU:1.334e-01
duration_diagreduce:6.800e-08
duration_diagtransform:1.720e-07
----- TIMING FOR symbolic_formulae_twodot with size=143 : 1.907e-03 S -----
rank=0 GPUmem(GB): used=1.570e-05 (oper)=1.570e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=143
 no. of hintermediate operators=62
 no. of coefficients=814:6.210e-03MB:6.065e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 9.640e-05 S -----
rank=0 GPUmem(GB): used=2.176e-05 (oper,hinter)=1.570e-05,6.065e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.310e-03 S size(H_formulae)=143 size(Hxlst2)=3 T(Hmu/Hxlist)=3.572e-04,4.952e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.350e-03 S size(H_formulae)=143 size(Hxlst)=170 -----
rank=0 GPUmem(GB): used=2.176e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=4.470e-08 batch[need]=5.066e-06 blksize=1 blksize0=1 batchsize=170
rank=0 GPUmem(GB): used=2.687e-05 (oper,hinter,dvdson,batch)=1.570e-05,6.065e-06,4.470e-08,5.066e-06
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=3 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.480e-03,7.441e-03,2.986e-02,1.260e-02,5.739e-02
 analyze_tgpu[Hx]: ndim=3:2.235e-08GB T(cpu-gpu)=1.235e-03 speed=3.621e-05GB/S T(nccl)=6.245e-03 speed=7.158e-06GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=7 t=7.4e-03 per=1.5e+01 cost=2.0e+02 flops=2.7e+04
 sigma[gemm] counter=7 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=4 t=7.5e-03 per=1.5e+01 cost=7.4e+01 flops=9.9e+03
 sigma[gemm] counter=7 i=5 t=7.5e-03 per=1.5e+01 cost=7.4e+01 flops=9.9e+03
 sigma[gemm] counter=7 i=6 t=7.5e-03 per=1.5e+01 cost=1.3e+02 flops=1.8e+04
 sigma[gemm] counter=7 i=7 t=7.5e-03 per=1.5e+01 cost=1.3e+02 flops=1.8e+04
 sigma[gemm] counter=7 total t=3.0e-02 per=6.0e+01 cost=4.2e+02 flops=1.4e+04
 sigma[red] counter=7 t=1.3e-02 per=2.5e+01 cost=3.4e+02 flops=2.7e+04
----- TIMING FOR sigma_tot : t_inter=3.0e-02 t_gemm=2.1e-01 t_reduction=8.8e-02 tot=3.2e-01 -----
 sigma_tot[inter] counter=7 t=3.0e-02 per=9.3e+00 cost=5.4e+02 flops=1.8e+04
 sigma_tot[gemm] counter=7 i=0 t=1.0e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=1 t=8.8e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=2 t=8.4e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=3 t=8.5e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=4 t=5.0e-02 per=1.5e+01 cost=2.9e+02 flops=5.8e+03
 sigma_tot[gemm] counter=7 i=5 t=5.2e-02 per=1.6e+01 cost=2.9e+02 flops=5.5e+03
 sigma_tot[gemm] counter=7 i=6 t=5.2e-02 per=1.6e+01 cost=5.1e+02 flops=9.7e+03
 sigma_tot[gemm] counter=7 i=7 t=5.2e-02 per=1.6e+01 cost=5.1e+02 flops=9.7e+03
 sigma_tot[gemm] counter=7 total t=2.1e-01 per=6.4e+01 cost=1.6e+03 flops=7.7e+03
 sigma_tot[red] counter=7 t=8.8e-02 per=2.7e+01 cost=1.5e+03 flops=1.7e+04
T(sub)=9.7e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.3e-06,2.0e-06,6.8e-07,1.8e-07
settings: ndim=3 neig=1 maxcycle=30 nbuff=4 memory=2e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.113157849033 -1.116e+03  2.453e-02    1     1  5.762e-02 5.762e-02 5.758e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.594e-03,7.457e-03,2.988e-02,1.242e-02,5.836e-02
 analyze_tgpu[Hx]: ndim=3:2.235e-08GB T(cpu-gpu)=2.268e-03 speed=1.971e-05GB/S T(nccl)=6.326e-03 speed=7.066e-06GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.0e-02 -----
 sigma[inter] counter=8 t=7.5e-03 per=1.5e+01 cost=2.0e+02 flops=2.7e+04
 sigma[gemm] counter=8 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=4 t=7.5e-03 per=1.5e+01 cost=7.4e+01 flops=9.9e+03
 sigma[gemm] counter=8 i=5 t=7.6e-03 per=1.5e+01 cost=7.4e+01 flops=9.8e+03
 sigma[gemm] counter=8 i=6 t=7.4e-03 per=1.5e+01 cost=1.3e+02 flops=1.8e+04
 sigma[gemm] counter=8 i=7 t=7.4e-03 per=1.5e+01 cost=1.3e+02 flops=1.8e+04
 sigma[gemm] counter=8 total t=3.0e-02 per=6.0e+01 cost=4.2e+02 flops=1.4e+04
 sigma[red] counter=8 t=1.2e-02 per=2.5e+01 cost=3.4e+02 flops=2.7e+04
----- TIMING FOR sigma_tot : t_inter=3.8e-02 t_gemm=2.4e-01 t_reduction=1.0e-01 tot=3.7e-01 -----
 sigma_tot[inter] counter=8 t=3.8e-02 per=1.0e+01 cost=7.4e+02 flops=2.0e+04
 sigma_tot[gemm] counter=8 i=0 t=1.1e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=1 t=1.0e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=2 t=9.6e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=3 t=9.6e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=4 t=5.8e-02 per=1.5e+01 cost=3.6e+02 flops=6.3e+03
 sigma_tot[gemm] counter=8 i=5 t=6.0e-02 per=1.6e+01 cost=3.6e+02 flops=6.1e+03
 sigma_tot[gemm] counter=8 i=6 t=6.0e-02 per=1.6e+01 cost=6.4e+02 flops=1.1e+04
 sigma_tot[gemm] counter=8 i=7 t=6.0e-02 per=1.6e+01 cost=6.4e+02 flops=1.1e+04
 sigma_tot[gemm] counter=8 total t=2.4e-01 per=6.3e+01 cost=2.0e+03 flops=8.5e+03
 sigma_tot[red] counter=8 t=1.0e-01 per=2.7e+01 cost=1.8e+03 flops=1.8e+04
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.2e-05,3.6e-06,8.8e-07,1.8e-07
    2   0 -    -116.120678712513 -7.521e-03  4.112e-03    2     2  1.163e-01 5.813e-02 5.807e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.905e-03,7.568e-03,3.002e-02,1.244e-02,5.894e-02
 analyze_tgpu[Hx]: ndim=3:2.235e-08GB T(cpu-gpu)=2.248e-03 speed=1.989e-05GB/S T(nccl)=6.657e-03 speed=6.716e-06GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.0e-02 -----
 sigma[inter] counter=9 t=7.6e-03 per=1.5e+01 cost=2.0e+02 flops=2.6e+04
 sigma[gemm] counter=9 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=4 t=7.4e-03 per=1.5e+01 cost=7.4e+01 flops=9.9e+03
 sigma[gemm] counter=9 i=5 t=7.4e-03 per=1.5e+01 cost=7.4e+01 flops=9.9e+03
 sigma[gemm] counter=9 i=6 t=7.6e-03 per=1.5e+01 cost=1.3e+02 flops=1.8e+04
 sigma[gemm] counter=9 i=7 t=7.5e-03 per=1.5e+01 cost=1.3e+02 flops=1.8e+04
 sigma[gemm] counter=9 total t=3.0e-02 per=6.0e+01 cost=4.2e+02 flops=1.4e+04
 sigma[red] counter=9 t=1.2e-02 per=2.5e+01 cost=3.4e+02 flops=2.7e+04
----- TIMING FOR sigma_tot : t_inter=4.5e-02 t_gemm=2.7e-01 t_reduction=1.1e-01 tot=4.2e-01 -----
 sigma_tot[inter] counter=9 t=4.5e-02 per=1.1e+01 cost=9.4e+02 flops=2.1e+04
 sigma_tot[gemm] counter=9 i=0 t=1.3e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=1 t=1.1e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=2 t=1.1e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=3 t=1.1e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=4 t=6.5e-02 per=1.5e+01 cost=4.4e+02 flops=6.7e+03
 sigma_tot[gemm] counter=9 i=5 t=6.7e-02 per=1.6e+01 cost=4.4e+02 flops=6.5e+03
 sigma_tot[gemm] counter=9 i=6 t=6.7e-02 per=1.6e+01 cost=7.7e+02 flops=1.2e+04
 sigma_tot[gemm] counter=9 i=7 t=6.7e-02 per=1.6e+01 cost=7.7e+02 flops=1.2e+04
 sigma_tot[gemm] counter=9 total t=2.7e-01 per=6.3e+01 cost=2.4e+03 flops=9.1e+03
 sigma_tot[red] counter=9 t=1.1e-01 per=2.7e+01 cost=2.2e+03 flops=1.9e+04
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.5e-05,3.1e-06,9.6e-07,1.9e-07
    3   0 +    -116.120806705492 -1.280e-04  3.866e-14    3     3  1.755e-01 5.849e-02 5.840e-02
TIMING FOR Davidson : 1.755e-01  T(cal/comm/rest)=1.752e-01,8.400e-07,2.688e-04
decomposed t_rest=2.688e-04
 T(sub)    =5.320e-05 per=1.979e+01
 T(precond)=1.814e-05 per=6.750e+00
 T(ortho)  =4.512e-06 per=1.679e+00
 T(xcopy)  =4.830e-07 per=1.797e-01
 T(xnrm2)  =1.168e-06 per=4.346e-01
 T(other)  =1.912e-04 per=7.116e+01
optimized energies: isweep=0 ibond=2 dots=2 e[0]=-116.120806705492 nmvp=3
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.258e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=6 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=6 dimAll=8
 (5,1):2 (7,1):1 (6,0):1 (6,2):2 (4,2):1 (5,3):1
timing for divide=4.9e-05
timing for compute=3.3e-05
timing for collect=1.0e-05
----- TMING FOR decimation_genbasis(su2): 9.2e-05 S T(divide/compute[cpu/gpu/rest]/collect)=4.9e-05,2.3e-05,0.0e+00,9.2e-06,1.0e-05 -----
decimation summary: 8->2 dwt=+0.000e+00 SvN=2.991e-01
 qbond: qkept nsym=2 dimAll=2
 (6,2):1 (5,3):1
----- TIMING for decimation_row(nkr): 2.997e-04 S T(decim/select/formRot)=1.393e-04,1.251e-04,3.538e-05 -----
----- TIMING FOR twodot_decimation: 5.487e-04 S T(wf/decim)=2.371e-04,3.116e-04 -----
ctns::oper_renorm coord=(3,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:4 S:8 A:8 B:10 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=34:2.594e-04MB:2.533e-07GB
        per(mem): H:5.88 C:11.8 S:23.5 A:0 B:58.8 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.805e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=23 : 2.568e-04 S -----
rank=0 GPUmem(GB): used=2.140e-05 (oper)=7.898e-06
rank=0 GPUmem(GB): used=2.142e-05 (oper,site)=7.898e-06,2.235e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=23
 no. of rintermediate operators=5
 no. of coefficients=17:1.297e-04MB:1.267e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.464e-03 S -----
rank=0 GPUmem(GB): used=2.155e-05 (oper,site,rinter)=7.898e-06,2.235e-08,1.267e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 6.063e-04 S size(rtasks)=23 size(Rlst2)=4 T(Rmu/Rlist)=6.547e-05,5.408e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.253e-04 S size(rtasks)=23 size(Rlst)=65 -----
rank=0 GPUmem(GB): used=2.155e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.937e-06 blksize=1 blksize0=1 batchsize=65
rank=0 GPUmem(GB): used=2.348e-05 (oper,site,rinter,batch)=7.898e-06,2.235e-08,1.267e-07,1.937e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.022e-03,2.256e-02,9.995e-03
----- TIMING FOR renorm : t_inter=9.0e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.2e-02 -----
 renorm[inter] counter=38 t=9.0e-03 per=2.2e+01 cost=1.4e+02 flops=1.6e+04
 renorm[gemm] counter=38 i=0 t=1.3e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=38 i=1 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=38 i=2 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=38 i=3 t=1.1e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=38 i=4 t=7.5e-03 per=1.8e+01 cost=3.0e+01 flops=4.0e+03
 renorm[gemm] counter=38 i=5 t=7.6e-03 per=1.8e+01 cost=8.2e+01 flops=1.1e+04
 renorm[gemm] counter=38 i=6 t=7.5e-03 per=1.8e+01 cost=1.3e+02 flops=1.7e+04
 renorm[gemm] counter=38 total t=2.3e-02 per=5.4e+01 cost=2.4e+02 flops=1.1e+04
 renorm[red] counter=38 t=1.0e-02 per=2.4e+01 cost=1.3e+02 flops=1.3e+04
----- TIMING FOR renorm_tot : t_inter=2.0e-02 t_gemm=6.8e-02 t_reduction=3.0e-02 tot=1.2e-01 -----
 renorm_tot[inter] counter=38 t=2.0e-02 per=1.7e+01 cost=2.1e+02 flops=1.0e+04
 renorm_tot[gemm] counter=38 i=0 t=4.3e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=38 i=1 t=3.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=38 i=2 t=3.3e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=38 i=3 t=3.3e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=38 i=4 t=2.2e-02 per=1.9e+01 cost=6.8e+01 flops=3.0e+03
 renorm_tot[gemm] counter=38 i=5 t=2.3e-02 per=1.9e+01 cost=1.6e+02 flops=7.2e+03
 renorm_tot[gemm] counter=38 i=6 t=2.3e-02 per=1.9e+01 cost=2.8e+02 flops=1.3e+04
 renorm_tot[gemm] counter=38 total t=6.8e-02 per=5.7e+01 cost=5.1e+02 flops=7.6e+03
 renorm_tot[red] counter=38 t=3.0e-02 per=2.6e+01 cost=2.8e+02 flops=9.4e+03
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.410e-05 (optmp,oper)=7.451e-09,7.898e-06
rank=0 GPUmem(GB): used=2.412e-05 (optmp,oper,site,rinter)=7.451e-09,7.898e-06,2.235e-08,2.563e-06
rank=0 GPUmem(GB): used=2.436e-05 (optmp,oper,site,rinter,batch)=7.451e-09,7.898e-06,2.235e-08,2.563e-06,2.384e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 7.608e-01 S T(prep/alloc/comp/red/dealloc)=3.740e-02,4.078e-02,6.523e-01,6.724e-02,4.261e-04 -----
----- TIMING FOR oper_renorm_opS : 7.609e-01 S rank=0 -----
qops.to_cpu: size(tot)=34:2.594e-04MB:2.533e-07GB T(to_cpu)=5.770e-05S speed=4.391e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.811 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=3.031e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.912e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-9.686e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.144e+00 S #####
 T(local opt: fetch) = 1.049e-02 S  per = 0.918  per(accum) = 0.918
 T(local opt: hdiag) = 1.336e-01 S  per = 11.7  per(accum) = 12.6
 T(local opt: dvdsn) = 1.857e-01 S  per = 16.2  per(accum) = 28.8
 T(local opt: decim) = 6.228e-04 S  per = 0.0545  per(accum) = 28.9
 T(local opt: guess) = 3.558e-04 S  per = 0.0311  per(accum) = 28.9
 T(local opt: renrm) = 8.125e-01 S  per = 71.1  per(accum) = 100
 T(local opt: save ) = 2.092e-04 S  per = 0.0183  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.857e-01 S  T(sum) = 1.854e-01 S  per = 9.982e+01
 T(local opt: preprocess                  ) = 1.353e-03 S  per = 0.73  per(accum) = 0.73
 T(local opt: symbolic_formulae           ) = 1.921e-03 S  per = 1.04  per(accum) = 1.77
 T(local opt: hintermediate init          ) = 1.684e-04 S  per = 0.0908  per(accum) = 1.86
 T(local opt: preprocess_hformulae_Hxlist ) = 5.359e-03 S  per = 2.89  per(accum) = 4.75
 T(local opt: hmmtasks init               ) = 6.900e-04 S  per = 0.372  per(accum) = 5.12
 T(local opt: initial guess for dvdson    ) = 4.207e-04 S  per = 0.227  per(accum) = 5.35
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.502e-01 S  per =   81  per(accum) = 86.4
 T(local opt: dvdson [cpu-gpu]            ) = 5.751e-03 S  per =  3.1  per(accum) = 89.5
 T(local opt: dvdson [nccl]               ) = 1.923e-02 S  per = 10.4  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 8.400e-07 S  per = 0.000453  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 2.688e-04 S  per = 0.145  per(accum) = 100
Detailed decomposition of T(renrm) = 8.125e-01 S  T(sum) = 8.125e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 8.796e-05 S  per = 0.0108  per(accum) = 0.0108
 T(local opt: qops init                    ) = 3.946e-04 S  per = 0.0486  per(accum) = 0.0594
 T(local opt: symbolic_formulae_renorm     ) = 2.692e-04 S  per = 0.0331  per(accum) = 0.0925
 T(local opt: allocate qops on gpu         ) = 5.866e-05 S  per = 0.00722  per(accum) = 0.0997
 T(local opt: site memcpy cpu2gpu          ) = 2.225e-03 S  per = 0.274  per(accum) = 0.374
 T(local opt: rintermediate init           ) = 2.478e-03 S  per = 0.305  per(accum) = 0.679
 T(local opt: preprocess_formulae_Rlist2   ) = 6.325e-04 S  per = 0.0778  per(accum) = 0.756
 T(local opt: rmmtasks init                ) = 3.881e-04 S  per = 0.0478  per(accum) = 0.804
 T(local opt: qops memset on cpu           ) = 4.600e-08 S  per = 5.66e-06  per(accum) = 0.804
 T(local opt: preprocess_renorm_batchGPU   ) = 4.171e-02 S  per = 5.13  per(accum) = 5.94
 T(local opt: deallocate cpu and gpu memory) = 2.112e-05 S  per = 0.0026  per(accum) = 5.94
 T(local opt: construct opS [ifdists=true] ) = 7.609e-01 S  per = 93.6  per(accum) = 99.6
 T(local opt: reduction of opS & opH [nccl]) = 1.947e-03 S  per = 0.24  per(accum) = 99.8
 T(local opt: qops memcpy gpu2cpu          ) = 6.914e-05 S  per = 0.00851  per(accum) = 99.8
 T(local opt: reduction of opS & opH [mpi] ) = 2.443e-05 S  per = 0.00301  per(accum) = 99.8
 T(local opt: qops_pool join and erase     ) = 1.321e-03 S  per = 0.163  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 3.498e-06 S  per = 0.000431  per(accum) = 100
##### sweep opt: 3.072e+00 S #####
 T(sweep opt: fetch) = 5.222e-02 S  per =  1.7  per(accum) = 1.7
 T(sweep opt: hdiag) = 2.626e-01 S  per = 8.55  per(accum) = 10.2
 T(sweep opt: dvdsn) = 5.270e-01 S  per = 17.2  per(accum) = 27.4
 T(sweep opt: decim) = 2.229e-03 S  per = 0.0726  per(accum) = 27.5
 T(sweep opt: guess) = 1.259e-03 S  per = 0.041  per(accum) = 27.5
 T(sweep opt: renrm) = 2.226e+00 S  per = 72.5  per(accum) = 100
 T(sweep opt: save ) = 5.434e-04 S  per = 0.0177  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.270e-01 S  T(sum) = 5.263e-01 S  per = 9.986e+01
 T(sweep opt: preprocess                  ) = 5.827e-03 S  per = 1.11  per(accum) = 1.11
 T(sweep opt: symbolic_formulae           ) = 4.449e-03 S  per = 0.845  per(accum) = 1.95
 T(sweep opt: hintermediate init          ) = 3.535e-04 S  per = 0.0672  per(accum) = 2.02
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.188e-02 S  per = 2.26  per(accum) = 4.28
 T(sweep opt: hmmtasks init               ) = 1.463e-03 S  per = 0.278  per(accum) = 4.56
 T(sweep opt: initial guess for dvdson    ) = 1.623e-03 S  per = 0.308  per(accum) = 4.86
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.265e-01 S  per =   81  per(accum) = 85.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.611e-02 S  per = 3.06  per(accum) = 89
 T(sweep opt: dvdson [nccl]               ) = 5.706e-02 S  per = 10.8  per(accum) = 99.8
 T(sweep opt: dvdson [mpi]                ) = 2.650e-06 S  per = 0.000504  per(accum) = 99.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.035e-03 S  per = 0.197  per(accum) = 100
Detailed decomposition of T(renrm) = 2.226e+00 S  T(sum) = 2.226e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.960e-04 S  per = 0.0133  per(accum) = 0.0133
 T(sweep opt: qops init                    ) = 1.040e-03 S  per = 0.0467  per(accum) = 0.06
 T(sweep opt: symbolic_formulae_renorm     ) = 5.746e-04 S  per = 0.0258  per(accum) = 0.0858
 T(sweep opt: allocate qops on gpu         ) = 1.677e-04 S  per = 0.00753  per(accum) = 0.0934
 T(sweep opt: site memcpy cpu2gpu          ) = 4.602e-03 S  per = 0.207  per(accum) = 0.3
 T(sweep opt: rintermediate init           ) = 5.031e-03 S  per = 0.226  per(accum) = 0.526
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.456e-03 S  per = 0.0654  per(accum) = 0.591
 T(sweep opt: rmmtasks init                ) = 9.168e-04 S  per = 0.0412  per(accum) = 0.633
 T(sweep opt: qops memset on cpu           ) = 1.210e-07 S  per = 5.43e-06  per(accum) = 0.633
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.179e-01 S  per =  5.3  per(accum) = 5.93
 T(sweep opt: deallocate cpu and gpu memory) = 6.222e-05 S  per = 0.00279  per(accum) = 5.93
 T(sweep opt: construct opS [ifdists=true] ) = 2.083e+00 S  per = 93.5  per(accum) = 99.5
 T(sweep opt: reduction of opS & opH [nccl]) = 6.618e-03 S  per = 0.297  per(accum) = 99.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.872e-04 S  per = 0.00841  per(accum) = 99.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 7.208e-05 S  per = 0.00324  per(accum) = 99.8
 T(sweep opt: qops_pool join and erase     ) = 4.799e-03 S  per = 0.216  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 8.815e-06 S  per = 0.000396  per(accum) = 100
##### global opt: 3.072e+00 S #####
 T(global opt: fetch) = 5.222e-02 S  per =  1.7  per(accum) = 1.7
 T(global opt: hdiag) = 2.626e-01 S  per = 8.55  per(accum) = 10.2
 T(global opt: dvdsn) = 5.270e-01 S  per = 17.2  per(accum) = 27.4
 T(global opt: decim) = 2.229e-03 S  per = 0.0726  per(accum) = 27.5
 T(global opt: guess) = 1.259e-03 S  per = 0.041  per(accum) = 27.5
 T(global opt: renrm) = 2.226e+00 S  per = 72.5  per(accum) = 100
 T(global opt: save ) = 5.434e-04 S  per = 0.0177  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.270e-01 S  T(sum) = 5.263e-01 S  per = 9.986e+01
 T(global opt: preprocess                  ) = 5.827e-03 S  per = 1.11  per(accum) = 1.11
 T(global opt: symbolic_formulae           ) = 4.449e-03 S  per = 0.845  per(accum) = 1.95
 T(global opt: hintermediate init          ) = 3.535e-04 S  per = 0.0672  per(accum) = 2.02
 T(global opt: preprocess_hformulae_Hxlist ) = 1.188e-02 S  per = 2.26  per(accum) = 4.28
 T(global opt: hmmtasks init               ) = 1.463e-03 S  per = 0.278  per(accum) = 4.56
 T(global opt: initial guess for dvdson    ) = 1.623e-03 S  per = 0.308  per(accum) = 4.86
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.265e-01 S  per =   81  per(accum) = 85.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.611e-02 S  per = 3.06  per(accum) = 89
 T(global opt: dvdson [nccl]               ) = 5.706e-02 S  per = 10.8  per(accum) = 99.8
 T(global opt: dvdson [mpi]                ) = 2.650e-06 S  per = 0.000504  per(accum) = 99.8
 T(global opt: dvdson [rest part(linalg)]  ) = 1.035e-03 S  per = 0.197  per(accum) = 100
Detailed decomposition of T(renrm) = 2.226e+00 S  T(sum) = 2.226e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.960e-04 S  per = 0.0133  per(accum) = 0.0133
 T(global opt: qops init                    ) = 1.040e-03 S  per = 0.0467  per(accum) = 0.06
 T(global opt: symbolic_formulae_renorm     ) = 5.746e-04 S  per = 0.0258  per(accum) = 0.0858
 T(global opt: allocate qops on gpu         ) = 1.677e-04 S  per = 0.00753  per(accum) = 0.0934
 T(global opt: site memcpy cpu2gpu          ) = 4.602e-03 S  per = 0.207  per(accum) = 0.3
 T(global opt: rintermediate init           ) = 5.031e-03 S  per = 0.226  per(accum) = 0.526
 T(global opt: preprocess_formulae_Rlist2   ) = 1.456e-03 S  per = 0.0654  per(accum) = 0.591
 T(global opt: rmmtasks init                ) = 9.168e-04 S  per = 0.0412  per(accum) = 0.633
 T(global opt: qops memset on cpu           ) = 1.210e-07 S  per = 5.43e-06  per(accum) = 0.633
 T(global opt: preprocess_renorm_batchGPU   ) = 1.179e-01 S  per =  5.3  per(accum) = 5.93
 T(global opt: deallocate cpu and gpu memory) = 6.222e-05 S  per = 0.00279  per(accum) = 5.93
 T(global opt: construct opS [ifdists=true] ) = 2.083e+00 S  per = 93.5  per(accum) = 99.5
 T(global opt: reduction of opS & opH [nccl]) = 6.618e-03 S  per = 0.297  per(accum) = 99.8
 T(global opt: qops memcpy gpu2cpu          ) = 1.872e-04 S  per = 0.00841  per(accum) = 99.8
 T(global opt: reduction of opS & opH [mpi] ) = 7.208e-05 S  per = 0.00324  per(accum) = 99.8
 T(global opt: qops_pool join and erase     ) = 4.799e-03 S  per = 0.216  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 8.815e-06 S  per = 0.000396  per(accum) = 100
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=-2.221e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=3/seqsize=34 dots=2 dbond=(4,0)-(5,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=84:6.409e-04MB:6.258e-07GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=2:1.526e-05MB:1.490e-08GB
total mem of comb=87:6.638e-04MB:6.482e-07GB
rank=0 CPUmem(GB): used=1.004e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=4,14,1,1
 suppl= 0 1 2 3
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 4
 suppc2= 16
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:4 S:8 A:8 B:10 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=34:2.594e-04MB:2.533e-07GB
        per(mem): H:5.88 C:11.8 S:23.5 A:0 B:58.8 
 rqops: oplist=HCSPQ nops=H:1 C:14 S:2 P:18 Q:20 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=103:0.000786MB:7.67e-07GB
        per(mem): H:2.91 C:0 S:0 P:0 Q:97.1 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2133:0.0163MB:1.59e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.548e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(4,0) fdel=./scratch/sweep/rop(5,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-4.172e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(2,3,3,3) nnz=9:6.866e-05MB
qtensor4: wf4 own=1 _data=0x3b1cad20
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=2 dimAll=2
 (6,2):1 (5,3):1
 qbond: qcol nsym=3 dimAll=3
 (22,2):1 (22,4):1 (22,6):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=9 nblocks=96 size=9:6.866e-05MB
### DIAG TIMING: total=1.828e-01 t1=2.870e-05, t2=1.814e-03, t3=2.471e-03, t4=1.761e-01, t5=3.130e-06, t6=2.467e-03, t7=4.604e-06
duration_diagGPU:1.829e-01
duration_diagreduce:6.600e-08
duration_diagtransform:2.460e-07
----- TIMING FOR symbolic_formulae_twodot with size=191 : 2.600e-03 S -----
rank=0 GPUmem(GB): used=1.589e-05 (oper)=1.589e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=191
 no. of hintermediate operators=91
 no. of coefficients=1173:8.949e-03MB:8.740e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.197e-04 S -----
rank=0 GPUmem(GB): used=2.463e-05 (oper,hinter)=1.589e-05,8.740e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.020e-02 S size(H_formulae)=191 size(Hxlst2)=9 T(Hmu/Hxlist)=4.836e-04,1.972e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.035e-02 S size(H_formulae)=191 size(Hxlst)=812 -----
rank=0 GPUmem(GB): used=2.463e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=1.341e-07 batch[need]=2.420e-05 blksize=1 blksize0=1 batchsize=812
rank=0 GPUmem(GB): used=4.897e-05 (oper,hinter,dvdson,batch)=1.589e-05,8.740e-06,1.341e-07,2.420e-05
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=9 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.785e-03,7.478e-03,3.012e-02,1.282e-02,5.720e-02
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=1.370e-03 speed=9.787e-05GB/S T(nccl)=5.415e-03 speed=2.477e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=10 t=7.5e-03 per=1.5e+01 cost=1.0e+03 flops=1.3e+05
 sigma[gemm] counter=10 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=4 t=7.6e-03 per=1.5e+01 cost=4.3e+02 flops=5.7e+04
 sigma[gemm] counter=10 i=5 t=7.5e-03 per=1.5e+01 cost=4.3e+02 flops=5.7e+04
 sigma[gemm] counter=10 i=6 t=7.6e-03 per=1.5e+01 cost=6.8e+02 flops=8.9e+04
 sigma[gemm] counter=10 i=7 t=7.5e-03 per=1.5e+01 cost=6.8e+02 flops=9.1e+04
 sigma[gemm] counter=10 total t=3.0e-02 per=6.0e+01 cost=2.2e+03 flops=7.4e+04
 sigma[red] counter=10 t=1.3e-02 per=2.5e+01 cost=1.6e+03 flops=1.3e+05
----- TIMING FOR sigma_tot : t_inter=5.3e-02 t_gemm=3.0e-01 t_reduction=1.3e-01 tot=4.8e-01 -----
 sigma_tot[inter] counter=10 t=5.3e-02 per=1.1e+01 cost=1.9e+03 flops=3.7e+04
 sigma_tot[gemm] counter=10 i=0 t=1.4e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=1 t=1.2e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=2 t=1.2e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=3 t=1.2e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=4 t=7.3e-02 per=1.5e+01 cost=8.7e+02 flops=1.2e+04
 sigma_tot[gemm] counter=10 i=5 t=7.5e-02 per=1.6e+01 cost=8.7e+02 flops=1.2e+04
 sigma_tot[gemm] counter=10 i=6 t=7.5e-02 per=1.6e+01 cost=1.5e+03 flops=1.9e+04
 sigma_tot[gemm] counter=10 i=7 t=7.5e-02 per=1.6e+01 cost=1.5e+03 flops=1.9e+04
 sigma_tot[gemm] counter=10 total t=3.0e-01 per=6.3e+01 cost=4.6e+03 flops=1.6e+04
 sigma_tot[red] counter=10 t=1.3e-01 per=2.6e+01 cost=3.8e+03 flops=3.0e+04
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,4.4e-06,2.2e-06,7.1e-07,2.1e-07
settings: ndim=9 neig=1 maxcycle=30 nbuff=4 memory=1e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.120806705492 -1.116e+03  1.952e-03    1     1  5.744e-02 5.744e-02 5.740e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.618e-03,7.429e-03,2.982e-02,1.269e-02,5.856e-02
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=2.201e-03 speed=6.093e-05GB/S T(nccl)=6.417e-03 speed=2.090e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=11 t=7.4e-03 per=1.5e+01 cost=1.0e+03 flops=1.3e+05
 sigma[gemm] counter=11 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=4 t=7.4e-03 per=1.5e+01 cost=4.3e+02 flops=5.8e+04
 sigma[gemm] counter=11 i=5 t=7.4e-03 per=1.5e+01 cost=4.3e+02 flops=5.8e+04
 sigma[gemm] counter=11 i=6 t=7.5e-03 per=1.5e+01 cost=6.8e+02 flops=9.0e+04
 sigma[gemm] counter=11 i=7 t=7.5e-03 per=1.5e+01 cost=6.8e+02 flops=9.1e+04
 sigma[gemm] counter=11 total t=3.0e-02 per=6.0e+01 cost=2.2e+03 flops=7.4e+04
 sigma[red] counter=11 t=1.3e-02 per=2.5e+01 cost=1.6e+03 flops=1.3e+05
----- TIMING FOR sigma_tot : t_inter=6.0e-02 t_gemm=3.3e-01 t_reduction=1.4e-01 tot=5.3e-01 -----
 sigma_tot[inter] counter=11 t=6.0e-02 per=1.1e+01 cost=2.9e+03 flops=4.9e+04
 sigma_tot[gemm] counter=11 i=0 t=1.5e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=1 t=1.3e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=2 t=1.3e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=3 t=1.3e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=4 t=8.0e-02 per=1.5e+01 cost=1.3e+03 flops=1.6e+04
 sigma_tot[gemm] counter=11 i=5 t=8.2e-02 per=1.6e+01 cost=1.3e+03 flops=1.6e+04
 sigma_tot[gemm] counter=11 i=6 t=8.2e-02 per=1.6e+01 cost=2.1e+03 flops=2.6e+04
 sigma_tot[gemm] counter=11 i=7 t=8.2e-02 per=1.6e+01 cost=2.1e+03 flops=2.6e+04
 sigma_tot[gemm] counter=11 total t=3.3e-01 per=6.2e+01 cost=6.9e+03 flops=2.1e+04
 sigma_tot[red] counter=11 t=1.4e-01 per=2.6e+01 cost=5.4e+03 flops=3.9e+04
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.3e-05,3.7e-06,9.4e-07,2.2e-07
    2   0 -    -116.120811668350 -4.963e-06  1.390e-04    2     2  1.163e-01 5.813e-02 5.807e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.645e-03,7.580e-03,2.967e-02,1.272e-02,5.862e-02
 analyze_tgpu[Hx]: ndim=9:6.706e-08GB T(cpu-gpu)=2.235e-03 speed=6.000e-05GB/S T(nccl)=6.410e-03 speed=2.092e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=12 t=7.6e-03 per=1.5e+01 cost=1.0e+03 flops=1.3e+05
 sigma[gemm] counter=12 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=4 t=7.4e-03 per=1.5e+01 cost=4.3e+02 flops=5.8e+04
 sigma[gemm] counter=12 i=5 t=7.4e-03 per=1.5e+01 cost=4.3e+02 flops=5.8e+04
 sigma[gemm] counter=12 i=6 t=7.4e-03 per=1.5e+01 cost=6.8e+02 flops=9.2e+04
 sigma[gemm] counter=12 i=7 t=7.5e-03 per=1.5e+01 cost=6.8e+02 flops=9.1e+04
 sigma[gemm] counter=12 total t=3.0e-02 per=5.9e+01 cost=2.2e+03 flops=7.5e+04
 sigma[red] counter=12 t=1.3e-02 per=2.5e+01 cost=1.6e+03 flops=1.3e+05
----- TIMING FOR sigma_tot : t_inter=6.8e-02 t_gemm=3.6e-01 t_reduction=1.5e-01 tot=5.8e-01 -----
 sigma_tot[inter] counter=12 t=6.8e-02 per=1.2e+01 cost=3.9e+03 flops=5.8e+04
 sigma_tot[gemm] counter=12 i=0 t=1.7e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=1 t=1.5e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=2 t=1.4e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=3 t=1.4e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=4 t=8.8e-02 per=1.5e+01 cost=1.7e+03 flops=2.0e+04
 sigma_tot[gemm] counter=12 i=5 t=9.0e-02 per=1.6e+01 cost=1.7e+03 flops=1.9e+04
 sigma_tot[gemm] counter=12 i=6 t=9.0e-02 per=1.6e+01 cost=2.8e+03 flops=3.1e+04
 sigma_tot[gemm] counter=12 i=7 t=9.0e-02 per=1.6e+01 cost=2.8e+03 flops=3.1e+04
 sigma_tot[gemm] counter=12 total t=3.6e-01 per=6.2e+01 cost=9.1e+03 flops=2.5e+04
 sigma_tot[red] counter=12 t=1.5e-01 per=2.6e+01 cost=7.0e+03 flops=4.7e+04
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.5e-05,3.0e-06,1.0e-06,1.7e-07
    3   0 +    -116.120811732020 -6.367e-08  2.232e-05    3     3  1.753e-01 5.842e-02 5.834e-02
TIMING FOR Davidson : 1.753e-01  T(cal/comm/rest)=1.750e-01,9.930e-07,2.326e-04
decomposed t_rest=2.326e-04
 T(sub)    =5.593e-05 per=2.405e+01
 T(precond)=1.809e-05 per=7.780e+00
 T(ortho)  =4.773e-06 per=2.052e+00
 T(xcopy)  =6.090e-07 per=2.619e-01
 T(xnrm2)  =1.234e-06 per=5.306e-01
 T(other)  =1.519e-04 per=6.532e+01
optimized energies: isweep=0 ibond=3 dots=2 e[0]=-116.120811732020 nmvp=3
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=4.011e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=6 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=6 dimAll=8
 (6,2):2 (8,2):1 (7,1):1 (7,3):2 (5,3):1 (6,4):1
timing for divide=5.1e-05
timing for compute=5.3e-05
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(su2): 1.2e-04 S T(divide/compute[cpu/gpu/rest]/collect)=5.1e-05,4.3e-05,0.0e+00,9.2e-06,1.5e-05 -----
decimation summary: 8->6 dwt=+2.220e-16 SvN=9.650e-05
 qbond: qkept nsym=5 dimAll=6
 (7,3):2 (6,2):1 (8,2):1 (7,1):1 (6,4):1
----- TIMING for decimation_row(nkr): 3.768e-04 S T(decim/select/formRot)=1.648e-04,1.573e-04,5.472e-05 -----
----- TIMING FOR twodot_decimation: 6.729e-04 S T(wf/decim)=2.793e-04,3.936e-04 -----
ctns::oper_renorm coord=(4,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:5 S:8 A:12 B:16 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=305:2.327e-03MB:2.272e-06GB
        per(mem): H:2.62 C:13.1 S:21 A:5.57 B:57.7 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.983e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=34 : 3.090e-04 S -----
rank=0 GPUmem(GB): used=2.614e-05 (oper)=9.961e-06
rank=0 GPUmem(GB): used=2.620e-05 (oper,site)=9.961e-06,6.706e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=34
 no. of rintermediate operators=5
 no. of coefficients=25:1.907e-04MB:1.863e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.475e-03 S -----
rank=0 GPUmem(GB): used=2.639e-05 (oper,site,rinter)=9.961e-06,6.706e-08,1.863e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 2.219e-03 S size(rtasks)=34 size(Rlst2)=25 T(Rmu/Rlist)=8.532e-05,2.134e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.264e-03 S size(rtasks)=34 size(Rlst)=218 -----
rank=0 GPUmem(GB): used=2.639e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.624e-05 blksize=4 blksize0=1 batchsize=218
rank=0 GPUmem(GB): used=4.263e-05 (oper,site,rinter,batch)=9.961e-06,6.706e-08,1.863e-07,1.624e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.608e-03,2.254e-02,9.973e-03
----- TIMING FOR renorm : t_inter=6.6e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=55 t=6.6e-03 per=1.7e+01 cost=4.0e+02 flops=6.1e+04
 renorm[gemm] counter=55 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=55 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=55 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=55 i=3 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=55 i=4 t=7.4e-03 per=1.9e+01 cost=8.2e+01 flops=1.1e+04
 renorm[gemm] counter=55 i=5 t=7.5e-03 per=1.9e+01 cost=4.0e+02 flops=5.3e+04
 renorm[gemm] counter=55 i=6 t=7.6e-03 per=1.9e+01 cost=8.0e+02 flops=1.1e+05
 renorm[gemm] counter=55 total t=2.3e-02 per=5.8e+01 cost=1.3e+03 flops=5.7e+04
 renorm[red] counter=55 t=1.0e-02 per=2.5e+01 cost=8.0e+02 flops=8.0e+04
----- TIMING FOR renorm_tot : t_inter=2.7e-02 t_gemm=9.0e-02 t_reduction=4.0e-02 tot=1.6e-01 -----
 renorm_tot[inter] counter=55 t=2.7e-02 per=1.7e+01 cost=6.1e+02 flops=2.3e+04
 renorm_tot[gemm] counter=55 i=0 t=5.6e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=55 i=1 t=4.6e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=55 i=2 t=4.5e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=55 i=3 t=4.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=55 i=4 t=3.0e-02 per=1.9e+01 cost=1.5e+02 flops=5.0e+03
 renorm_tot[gemm] counter=55 i=5 t=3.0e-02 per=1.9e+01 cost=5.6e+02 flops=1.9e+04
 renorm_tot[gemm] counter=55 i=6 t=3.0e-02 per=1.9e+01 cost=1.1e+03 flops=3.6e+04
 renorm_tot[gemm] counter=55 total t=9.0e-02 per=5.7e+01 cost=1.8e+03 flops=2.0e+04
 renorm_tot[red] counter=55 t=4.0e-02 per=2.6e+01 cost=1.1e+03 flops=2.7e+04
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.023e-05 (optmp,oper)=5.960e-08,9.961e-06
rank=0 GPUmem(GB): used=3.029e-05 (optmp,oper,site,rinter)=5.960e-08,9.961e-06,6.706e-08,3.844e-06
rank=0 GPUmem(GB): used=3.217e-05 (optmp,oper,site,rinter,batch)=5.960e-08,9.961e-06,6.706e-08,3.844e-06,1.878e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 7.183e-01 S T(prep/alloc/comp/red/dealloc)=3.522e-02,4.035e-02,5.975e-01,7.785e-02,2.588e-03 -----
----- TIMING FOR oper_renorm_opS : 7.185e-01 S rank=0 -----
qops.to_cpu: size(tot)=305:2.327e-03MB:2.272e-06GB T(to_cpu)=6.831e-05S speed=3.327e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.769 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.757e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-9.494e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.101e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.171e+00 S #####
 T(local opt: fetch) = 1.144e-02 S  per = 0.977  per(accum) = 0.977
 T(local opt: hdiag) = 1.831e-01 S  per = 15.6  per(accum) = 16.6
 T(local opt: dvdsn) = 2.041e-01 S  per = 17.4  per(accum) = 34.1
 T(local opt: decim) = 7.500e-04 S  per = 0.0641  per(accum) = 34.1
 T(local opt: guess) = 5.053e-04 S  per = 0.0432  per(accum) = 34.2
 T(local opt: renrm) = 7.705e-01 S  per = 65.8  per(accum) = 100
 T(local opt: save ) = 1.893e-04 S  per = 0.0162  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.041e-01 S  T(sum) = 2.039e-01 S  per = 9.991e+01
 T(local opt: preprocess                  ) = 1.359e-03 S  per = 0.667  per(accum) = 0.667
 T(local opt: symbolic_formulae           ) = 2.615e-03 S  per = 1.28  per(accum) = 1.95
 T(local opt: hintermediate init          ) = 1.914e-04 S  per = 0.0939  per(accum) = 2.04
 T(local opt: preprocess_hformulae_Hxlist ) = 2.037e-02 S  per = 9.99  per(accum) = 12
 T(local opt: hmmtasks init               ) = 3.696e-03 S  per = 1.81  per(accum) = 13.8
 T(local opt: initial guess for dvdson    ) = 4.455e-04 S  per = 0.218  per(accum) = 14.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.510e-01 S  per =   74  per(accum) = 88.1
 T(local opt: dvdson [cpu-gpu]            ) = 5.806e-03 S  per = 2.85  per(accum) = 90.9
 T(local opt: dvdson [nccl]               ) = 1.824e-02 S  per = 8.94  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 9.930e-07 S  per = 0.000487  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 2.326e-04 S  per = 0.114  per(accum) = 100
Detailed decomposition of T(renrm) = 7.705e-01 S  T(sum) = 7.705e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.335e-04 S  per = 0.0173  per(accum) = 0.0173
 T(local opt: qops init                    ) = 1.305e-03 S  per = 0.169  per(accum) = 0.187
 T(local opt: symbolic_formulae_renorm     ) = 3.211e-04 S  per = 0.0417  per(accum) = 0.228
 T(local opt: allocate qops on gpu         ) = 5.510e-05 S  per = 0.00715  per(accum) = 0.235
 T(local opt: site memcpy cpu2gpu          ) = 1.078e-03 S  per = 0.14  per(accum) = 0.375
 T(local opt: rintermediate init           ) = 2.490e-03 S  per = 0.323  per(accum) = 0.699
 T(local opt: preprocess_formulae_Rlist2   ) = 2.276e-03 S  per = 0.295  per(accum) = 0.994
 T(local opt: rmmtasks init                ) = 1.161e-03 S  per = 0.151  per(accum) = 1.14
 T(local opt: qops memset on cpu           ) = 3.700e-08 S  per = 4.8e-06  per(accum) = 1.14
 T(local opt: preprocess_renorm_batchGPU   ) = 3.929e-02 S  per =  5.1  per(accum) = 6.24
 T(local opt: deallocate cpu and gpu memory) = 2.725e-05 S  per = 0.00354  per(accum) = 6.25
 T(local opt: construct opS [ifdists=true] ) = 7.185e-01 S  per = 93.3  per(accum) = 99.5
 T(local opt: reduction of opS & opH [nccl]) = 2.346e-03 S  per = 0.305  per(accum) = 99.8
 T(local opt: qops memcpy gpu2cpu          ) = 8.050e-05 S  per = 0.0104  per(accum) = 99.8
 T(local opt: reduction of opS & opH [mpi] ) = 5.154e-05 S  per = 0.00669  per(accum) = 99.8
 T(local opt: qops_pool join and erase     ) = 1.357e-03 S  per = 0.176  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 4.880e-06 S  per = 0.000633  per(accum) = 100
##### sweep opt: 4.243e+00 S #####
 T(sweep opt: fetch) = 6.365e-02 S  per =  1.5  per(accum) = 1.5
 T(sweep opt: hdiag) = 4.458e-01 S  per = 10.5  per(accum) = 12
 T(sweep opt: dvdsn) = 7.311e-01 S  per = 17.2  per(accum) = 29.2
 T(sweep opt: decim) = 2.979e-03 S  per = 0.0702  per(accum) = 29.3
 T(sweep opt: guess) = 1.764e-03 S  per = 0.0416  per(accum) = 29.4
 T(sweep opt: renrm) = 2.997e+00 S  per = 70.6  per(accum) = 100
 T(sweep opt: save ) = 7.326e-04 S  per = 0.0173  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.311e-01 S  T(sum) = 7.302e-01 S  per = 9.987e+01
 T(sweep opt: preprocess                  ) = 7.186e-03 S  per = 0.984  per(accum) = 0.984
 T(sweep opt: symbolic_formulae           ) = 7.064e-03 S  per = 0.967  per(accum) = 1.95
 T(sweep opt: hintermediate init          ) = 5.449e-04 S  per = 0.0746  per(accum) = 2.03
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.226e-02 S  per = 4.42  per(accum) = 6.44
 T(sweep opt: hmmtasks init               ) = 5.159e-03 S  per = 0.707  per(accum) = 7.15
 T(sweep opt: initial guess for dvdson    ) = 2.068e-03 S  per = 0.283  per(accum) = 7.43
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.775e-01 S  per = 79.1  per(accum) = 86.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.192e-02 S  per =    3  per(accum) = 89.5
 T(sweep opt: dvdson [nccl]               ) = 7.530e-02 S  per = 10.3  per(accum) = 99.8
 T(sweep opt: dvdson [mpi]                ) = 3.643e-06 S  per = 0.000499  per(accum) = 99.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.268e-03 S  per = 0.174  per(accum) = 100
Detailed decomposition of T(renrm) = 2.997e+00 S  T(sum) = 2.997e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.295e-04 S  per = 0.0143  per(accum) = 0.0143
 T(sweep opt: qops init                    ) = 2.345e-03 S  per = 0.0782  per(accum) = 0.0926
 T(sweep opt: symbolic_formulae_renorm     ) = 8.957e-04 S  per = 0.0299  per(accum) = 0.122
 T(sweep opt: allocate qops on gpu         ) = 2.228e-04 S  per = 0.00743  per(accum) = 0.13
 T(sweep opt: site memcpy cpu2gpu          ) = 5.680e-03 S  per = 0.19  per(accum) = 0.319
 T(sweep opt: rintermediate init           ) = 7.521e-03 S  per = 0.251  per(accum) = 0.57
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.733e-03 S  per = 0.125  per(accum) = 0.695
 T(sweep opt: rmmtasks init                ) = 2.078e-03 S  per = 0.0693  per(accum) = 0.764
 T(sweep opt: qops memset on cpu           ) = 1.580e-07 S  per = 5.27e-06  per(accum) = 0.764
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.572e-01 S  per = 5.25  per(accum) = 6.01
 T(sweep opt: deallocate cpu and gpu memory) = 8.947e-05 S  per = 0.00299  per(accum) = 6.01
 T(sweep opt: construct opS [ifdists=true] ) = 2.801e+00 S  per = 93.5  per(accum) = 99.5
 T(sweep opt: reduction of opS & opH [nccl]) = 8.964e-03 S  per = 0.299  per(accum) = 99.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.677e-04 S  per = 0.00893  per(accum) = 99.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.236e-04 S  per = 0.00412  per(accum) = 99.8
 T(sweep opt: qops_pool join and erase     ) = 6.156e-03 S  per = 0.205  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.370e-05 S  per = 0.000457  per(accum) = 100
##### global opt: 4.243e+00 S #####
 T(global opt: fetch) = 6.365e-02 S  per =  1.5  per(accum) = 1.5
 T(global opt: hdiag) = 4.458e-01 S  per = 10.5  per(accum) = 12
 T(global opt: dvdsn) = 7.311e-01 S  per = 17.2  per(accum) = 29.2
 T(global opt: decim) = 2.979e-03 S  per = 0.0702  per(accum) = 29.3
 T(global opt: guess) = 1.764e-03 S  per = 0.0416  per(accum) = 29.4
 T(global opt: renrm) = 2.997e+00 S  per = 70.6  per(accum) = 100
 T(global opt: save ) = 7.326e-04 S  per = 0.0173  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.311e-01 S  T(sum) = 7.302e-01 S  per = 9.987e+01
 T(global opt: preprocess                  ) = 7.186e-03 S  per = 0.984  per(accum) = 0.984
 T(global opt: symbolic_formulae           ) = 7.064e-03 S  per = 0.967  per(accum) = 1.95
 T(global opt: hintermediate init          ) = 5.449e-04 S  per = 0.0746  per(accum) = 2.03
 T(global opt: preprocess_hformulae_Hxlist ) = 3.226e-02 S  per = 4.42  per(accum) = 6.44
 T(global opt: hmmtasks init               ) = 5.159e-03 S  per = 0.707  per(accum) = 7.15
 T(global opt: initial guess for dvdson    ) = 2.068e-03 S  per = 0.283  per(accum) = 7.43
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.775e-01 S  per = 79.1  per(accum) = 86.5
 T(global opt: dvdson [cpu-gpu]            ) = 2.192e-02 S  per =    3  per(accum) = 89.5
 T(global opt: dvdson [nccl]               ) = 7.530e-02 S  per = 10.3  per(accum) = 99.8
 T(global opt: dvdson [mpi]                ) = 3.643e-06 S  per = 0.000499  per(accum) = 99.8
 T(global opt: dvdson [rest part(linalg)]  ) = 1.268e-03 S  per = 0.174  per(accum) = 100
Detailed decomposition of T(renrm) = 2.997e+00 S  T(sum) = 2.997e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.295e-04 S  per = 0.0143  per(accum) = 0.0143
 T(global opt: qops init                    ) = 2.345e-03 S  per = 0.0782  per(accum) = 0.0926
 T(global opt: symbolic_formulae_renorm     ) = 8.957e-04 S  per = 0.0299  per(accum) = 0.122
 T(global opt: allocate qops on gpu         ) = 2.228e-04 S  per = 0.00743  per(accum) = 0.13
 T(global opt: site memcpy cpu2gpu          ) = 5.680e-03 S  per = 0.19  per(accum) = 0.319
 T(global opt: rintermediate init           ) = 7.521e-03 S  per = 0.251  per(accum) = 0.57
 T(global opt: preprocess_formulae_Rlist2   ) = 3.733e-03 S  per = 0.125  per(accum) = 0.695
 T(global opt: rmmtasks init                ) = 2.078e-03 S  per = 0.0693  per(accum) = 0.764
 T(global opt: qops memset on cpu           ) = 1.580e-07 S  per = 5.27e-06  per(accum) = 0.764
 T(global opt: preprocess_renorm_batchGPU   ) = 1.572e-01 S  per = 5.25  per(accum) = 6.01
 T(global opt: deallocate cpu and gpu memory) = 8.947e-05 S  per = 0.00299  per(accum) = 6.01
 T(global opt: construct opS [ifdists=true] ) = 2.801e+00 S  per = 93.5  per(accum) = 99.5
 T(global opt: reduction of opS & opH [nccl]) = 8.964e-03 S  per = 0.299  per(accum) = 99.8
 T(global opt: qops memcpy gpu2cpu          ) = 2.677e-04 S  per = 0.00893  per(accum) = 99.8
 T(global opt: reduction of opS & opH [mpi] ) = 1.236e-04 S  per = 0.00412  per(accum) = 99.8
 T(global opt: qops_pool join and erase     ) = 6.156e-03 S  per = 0.205  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.370e-05 S  per = 0.000457  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-3.981e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=4/seqsize=34 dots=2 dbond=(5,0)-(6,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=87:6.638e-04MB:6.482e-07GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=8:6.104e-05MB:5.960e-08GB
total mem of comb=96:7.324e-04MB:7.153e-07GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=5,13,1,1
 suppl= 0 1 2 3 4
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 16
 suppc2= 17
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:5 S:8 A:12 B:16 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=305:2.327e-03MB:2.272e-06GB
        per(mem): H:2.62 C:13.1 S:21 A:5.57 B:57.7 
 rqops: oplist=HCSPQ nops=H:1 C:13 S:3 P:27 Q:26 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=133:0.00101MB:9.91e-07GB
        per(mem): H:2.26 C:0 S:0 P:0 Q:97.7 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2434:0.0186MB:1.81e-05GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=8.709e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(5,0) fdel=./scratch/sweep/rop(6,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-6.557e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(6,3,3,3) nnz=29:2.213e-04MB
qtensor4: wf4 own=1 _data=0x46dfa690
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=6
 (7,3):2 (6,2):1 (8,2):1 (7,1):1 (6,4):1
 qbond: qcol nsym=3 dimAll=3
 (21,1):1 (21,3):1 (21,5):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=23 nblocks=240 size=29:2.213e-04MB
### DIAG TIMING: total=1.929e-01 t1=3.276e-05, t2=1.490e-03, t3=2.447e-03, t4=1.865e-01, t5=3.342e-06, t6=2.457e-03, t7=6.185e-06
duration_diagGPU:1.929e-01
duration_diagreduce:8.300e-08
duration_diagtransform:3.170e-07
----- TIMING FOR symbolic_formulae_twodot with size=247 : 3.352e-03 S -----
rank=0 GPUmem(GB): used=1.813e-05 (oper)=1.813e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=247
 no. of hintermediate operators=122
 no. of coefficients=1502:1.146e-02MB:1.119e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.409e-04 S -----
rank=0 GPUmem(GB): used=2.933e-05 (oper,hinter)=1.813e-05,1.119e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 8.568e-02 S size(H_formulae)=247 size(Hxlst2)=23 T(Hmu/Hxlist)=6.479e-04,8.503e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 8.603e-02 S size(H_formulae)=247 size(Hxlst)=3916 -----
rank=0 GPUmem(GB): used=2.933e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=4.321e-07 batch[need]=2.626e-04 blksize=2 blksize0=4 batchsize=3916
rank=0 GPUmem(GB): used=2.923e-04 (oper,hinter,dvdson,batch)=1.813e-05,1.119e-05,4.321e-07,2.626e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=29 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.474e-03,7.676e-03,3.036e-02,1.276e-02,5.828e-02
 analyze_tgpu[Hx]: ndim=29:2.161e-07GB T(cpu-gpu)=1.297e-03 speed=3.331e-04GB/S T(nccl)=6.177e-03 speed=6.996e-05GB/S
----- TIMING FOR sigma : t_inter=7.7e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=13 t=7.7e-03 per=1.5e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=13 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=4 t=7.7e-03 per=1.5e+01 cost=3.1e+03 flops=4.0e+05
 sigma[gemm] counter=13 i=5 t=7.5e-03 per=1.5e+01 cost=3.0e+03 flops=4.0e+05
 sigma[gemm] counter=13 i=6 t=7.6e-03 per=1.5e+01 cost=6.5e+03 flops=8.5e+05
 sigma[gemm] counter=13 i=7 t=7.6e-03 per=1.5e+01 cost=6.5e+03 flops=8.5e+05
 sigma[gemm] counter=13 total t=3.0e-02 per=6.0e+01 cost=1.9e+04 flops=6.3e+05
 sigma[red] counter=13 t=1.3e-02 per=2.5e+01 cost=1.0e+04 flops=8.0e+05
----- TIMING FOR sigma_tot : t_inter=7.5e-02 t_gemm=3.9e-01 t_reduction=1.6e-01 tot=6.3e-01 -----
 sigma_tot[inter] counter=13 t=7.5e-02 per=1.2e+01 cost=1.4e+04 flops=1.8e+05
 sigma_tot[gemm] counter=13 i=0 t=1.8e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=1 t=1.6e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=2 t=1.5e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=3 t=1.5e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=4 t=9.5e-02 per=1.5e+01 cost=4.8e+03 flops=5.1e+04
 sigma_tot[gemm] counter=13 i=5 t=9.7e-02 per=1.6e+01 cost=4.7e+03 flops=4.9e+04
 sigma_tot[gemm] counter=13 i=6 t=9.7e-02 per=1.6e+01 cost=9.3e+03 flops=9.5e+04
 sigma_tot[gemm] counter=13 i=7 t=9.7e-02 per=1.6e+01 cost=9.3e+03 flops=9.6e+04
 sigma_tot[gemm] counter=13 total t=3.9e-01 per=6.2e+01 cost=2.8e+04 flops=7.3e+04
 sigma_tot[red] counter=13 t=1.6e-01 per=2.6e+01 cost=1.7e+04 flops=1.1e+05
T(sub)=9.7e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,4.2e-06,2.0e-06,7.5e-07,1.9e-07
settings: ndim=29 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.120811732020 -1.116e+03  1.405e-03    1     1  5.850e-02 5.850e-02 5.847e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.862e-03,7.457e-03,3.003e-02,1.299e-02,5.934e-02
 analyze_tgpu[Hx]: ndim=29:2.161e-07GB T(cpu-gpu)=2.214e-03 speed=1.952e-04GB/S T(nccl)=6.648e-03 speed=6.500e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=14 t=7.5e-03 per=1.5e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=14 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=4 t=7.4e-03 per=1.5e+01 cost=3.1e+03 flops=4.1e+05
 sigma[gemm] counter=14 i=5 t=7.5e-03 per=1.5e+01 cost=3.0e+03 flops=4.0e+05
 sigma[gemm] counter=14 i=6 t=7.6e-03 per=1.5e+01 cost=6.5e+03 flops=8.5e+05
 sigma[gemm] counter=14 i=7 t=7.5e-03 per=1.5e+01 cost=6.5e+03 flops=8.6e+05
 sigma[gemm] counter=14 total t=3.0e-02 per=5.9e+01 cost=1.9e+04 flops=6.3e+05
 sigma[red] counter=14 t=1.3e-02 per=2.6e+01 cost=1.0e+04 flops=7.9e+05
----- TIMING FOR sigma_tot : t_inter=8.3e-02 t_gemm=4.2e-01 t_reduction=1.8e-01 tot=6.8e-01 -----
 sigma_tot[inter] counter=14 t=8.3e-02 per=1.2e+01 cost=2.4e+04 flops=2.9e+05
 sigma_tot[gemm] counter=14 i=0 t=1.9e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=1 t=1.7e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=2 t=1.6e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=3 t=1.6e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=4 t=1.0e-01 per=1.5e+01 cost=7.9e+03 flops=7.7e+04
 sigma_tot[gemm] counter=14 i=5 t=1.0e-01 per=1.5e+01 cost=7.7e+03 flops=7.4e+04
 sigma_tot[gemm] counter=14 i=6 t=1.0e-01 per=1.6e+01 cost=1.6e+04 flops=1.5e+05
 sigma_tot[gemm] counter=14 i=7 t=1.0e-01 per=1.5e+01 cost=1.6e+04 flops=1.5e+05
 sigma_tot[gemm] counter=14 total t=4.2e-01 per=6.2e+01 cost=4.7e+04 flops=1.1e+05
 sigma_tot[red] counter=14 t=1.8e-01 per=2.6e+01 cost=2.8e+04 flops=1.6e+05
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.5e-05,3.7e-06,9.7e-07,2.1e-07
    2   0 -    -116.120814547741 -2.816e-06  2.160e-04    2     2  1.181e-01 5.906e-02 5.900e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.844e-03,7.433e-03,2.998e-02,1.291e-02,5.918e-02
 analyze_tgpu[Hx]: ndim=29:2.161e-07GB T(cpu-gpu)=2.208e-03 speed=1.957e-04GB/S T(nccl)=6.636e-03 speed=6.512e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=15 t=7.4e-03 per=1.5e+01 cost=9.9e+03 flops=1.3e+06
 sigma[gemm] counter=15 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=4 t=7.4e-03 per=1.5e+01 cost=3.1e+03 flops=4.2e+05
 sigma[gemm] counter=15 i=5 t=7.5e-03 per=1.5e+01 cost=3.0e+03 flops=4.0e+05
 sigma[gemm] counter=15 i=6 t=7.6e-03 per=1.5e+01 cost=6.5e+03 flops=8.5e+05
 sigma[gemm] counter=15 i=7 t=7.5e-03 per=1.5e+01 cost=6.5e+03 flops=8.7e+05
 sigma[gemm] counter=15 total t=3.0e-02 per=6.0e+01 cost=1.9e+04 flops=6.3e+05
 sigma[red] counter=15 t=1.3e-02 per=2.6e+01 cost=1.0e+04 flops=7.9e+05
----- TIMING FOR sigma_tot : t_inter=9.0e-02 t_gemm=4.5e-01 t_reduction=1.9e-01 tot=7.3e-01 -----
 sigma_tot[inter] counter=15 t=9.0e-02 per=1.2e+01 cost=3.4e+04 flops=3.7e+05
 sigma_tot[gemm] counter=15 i=0 t=2.1e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=1 t=1.8e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=2 t=1.8e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=3 t=1.8e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=4 t=1.1e-01 per=1.5e+01 cost=1.1e+04 flops=1.0e+05
 sigma_tot[gemm] counter=15 i=5 t=1.1e-01 per=1.5e+01 cost=1.1e+04 flops=9.5e+04
 sigma_tot[gemm] counter=15 i=6 t=1.1e-01 per=1.5e+01 cost=2.2e+04 flops=2.0e+05
 sigma_tot[gemm] counter=15 i=7 t=1.1e-01 per=1.5e+01 cost=2.2e+04 flops=2.0e+05
 sigma_tot[gemm] counter=15 total t=4.5e-01 per=6.2e+01 cost=6.6e+04 flops=1.5e+05
 sigma_tot[red] counter=15 t=1.9e-01 per=2.6e+01 cost=3.8e+04 flops=2.0e+05
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,3.2e-06,1.2e-06,2.0e-07
    3   0 +    -116.120814666334 -1.186e-07  4.720e-05    3     3  1.775e-01 5.917e-02 5.911e-02
TIMING FOR Davidson : 1.775e-01  T(cal/comm/rest)=1.773e-01,1.495e-06,2.134e-04
decomposed t_rest=2.134e-04
 T(sub)    =5.818e-05 per=2.727e+01
 T(precond)=1.768e-05 per=8.284e+00
 T(ortho)  =4.540e-06 per=2.128e+00
 T(xcopy)  =5.420e-07 per=2.540e-01
 T(xnrm2)  =1.369e-06 per=6.416e-01
 T(other)  =1.311e-04 per=6.143e+01
optimized energies: isweep=0 ibond=4 dots=2 e[0]=-116.120814666334 nmvp=3
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=3.586e-04 change=1.213e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond4.txt
 qbond: qsuper nsym=11 dimAll=24
 (7,3):4 (9,3):3 (8,2):5 (8,4):3 (6,2):1 (7,1):2 (10,2):1 (9,1):2 (8,0):1 (6,4):1 (7,5):1
timing for divide=9.3e-05
timing for compute=1.9e-04
timing for collect=2.5e-05
----- TMING FOR decimation_genbasis(su2): 3.1e-04 S T(divide/compute[cpu/gpu/rest]/collect)=9.3e-05,1.8e-04,0.0e+00,1.1e-05,2.5e-05 -----
decimation summary: 24->10 dwt=-2.220e-16 SvN=3.261e-01
 qbond: qkept nsym=8 dimAll=10
 (8,2):2 (8,4):2 (7,3):1 (9,3):1 (7,1):1 (9,1):1 (8,0):1 (7,5):1
----- TIMING for decimation_row(nkr): 7.289e-04 S T(decim/select/formRot)=3.667e-04,2.312e-04,1.310e-04 -----
----- TIMING FOR twodot_decimation: 1.235e-03 S T(wf/decim)=4.916e-04,7.432e-04 -----
ctns::oper_renorm coord=(5,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:6 S:8 A:18 B:20 
        dim(bra,ket)=10,10 size(op)=31:2.365e-04MB size(tot)=748:5.707e-03MB:5.573e-06GB
        per(mem): H:1.87 C:12.8 S:17.1 A:8.02 B:60.2 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=3.204e-04 change=2.448e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=45 : 3.604e-04 S -----
rank=0 GPUmem(GB): used=3.391e-05 (oper)=1.528e-05
rank=0 GPUmem(GB): used=3.412e-05 (oper,site)=1.528e-05,2.161e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=45
 no. of rintermediate operators=5
 no. of coefficients=39:2.975e-04MB:2.906e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.473e-03 S -----
rank=0 GPUmem(GB): used=3.441e-05 (oper,site,rinter)=1.528e-05,2.161e-07,2.906e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.293e-02 S size(rtasks)=45 size(Rlst2)=64 T(Rmu/Rlist)=1.067e-04,1.282e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.344e-02 S size(rtasks)=45 size(Rlst)=971 -----
rank=0 GPUmem(GB): used=3.441e-05 avail=6.231e+00 total=6.231e+00 batch[need]=9.405e-05 blksize=4 blksize0=4 batchsize=971
rank=0 GPUmem(GB): used=1.285e-04 (oper,site,rinter,batch)=1.528e-05,2.161e-07,2.906e-07,9.405e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.786e-03,2.262e-02,1.016e-02
----- TIMING FOR renorm : t_inter=5.8e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=71 t=5.8e-03 per=1.5e+01 cost=2.9e+03 flops=5.0e+05
 renorm[gemm] counter=71 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=71 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=71 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=71 i=3 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=71 i=4 t=7.5e-03 per=1.9e+01 cost=4.6e+02 flops=6.1e+04
 renorm[gemm] counter=71 i=5 t=7.5e-03 per=2.0e+01 cost=3.7e+03 flops=4.9e+05
 renorm[gemm] counter=71 i=6 t=7.6e-03 per=2.0e+01 cost=5.1e+03 flops=6.7e+05
 renorm[gemm] counter=71 total t=2.3e-02 per=5.9e+01 cost=9.2e+03 flops=4.1e+05
 renorm[red] counter=71 t=1.0e-02 per=2.6e+01 cost=3.8e+03 flops=3.8e+05
----- TIMING FOR renorm_tot : t_inter=3.2e-02 t_gemm=1.1e-01 t_reduction=5.0e-02 tot=2.0e-01 -----
 renorm_tot[inter] counter=71 t=3.2e-02 per=1.7e+01 cost=3.5e+03 flops=1.1e+05
 renorm_tot[gemm] counter=71 i=0 t=6.9e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=71 i=1 t=5.7e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=71 i=2 t=5.6e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=71 i=3 t=5.6e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=71 i=4 t=3.7e-02 per=1.9e+01 cost=6.1e+02 flops=1.6e+04
 renorm_tot[gemm] counter=71 i=5 t=3.8e-02 per=1.9e+01 cost=4.2e+03 flops=1.1e+05
 renorm_tot[gemm] counter=71 i=6 t=3.8e-02 per=1.9e+01 cost=6.2e+03 flops=1.6e+05
 renorm_tot[gemm] counter=71 total t=1.1e-01 per=5.8e+01 cost=1.1e+04 flops=9.8e+04
 renorm_tot[red] counter=71 t=5.0e-02 per=2.6e+01 cost=4.9e+03 flops=9.8e+04
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.980e-05 (optmp,oper)=1.192e-07,1.528e-05
rank=0 GPUmem(GB): used=4.002e-05 (optmp,oper,site,rinter)=1.192e-07,1.528e-05,2.161e-07,5.484e-06
rank=0 GPUmem(GB): used=5.455e-05 (optmp,oper,site,rinter,batch)=1.192e-07,1.528e-05,2.161e-07,5.484e-06,1.453e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 6.572e-01 S T(prep/alloc/comp/red/dealloc)=3.455e-02,4.457e-02,5.569e-01,5.310e-02,2.542e-03 -----
----- TIMING FOR oper_renorm_opS : 6.573e-01 S rank=0 -----
qops.to_cpu: size(tot)=748:5.707e-03MB:5.573e-06GB T(to_cpu)=8.629e-05S speed=6.459e-02GB/S
check ||H-H.dagger||=8.777e-17 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.726 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=3.357e-04 change=2.803e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=7.248e-04 change=-1.201e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=7.248e-04 change=-5.603e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.227e+00 S #####
 T(local opt: fetch) = 1.092e-02 S  per = 0.89  per(accum) = 0.89
 T(local opt: hdiag) = 1.935e-01 S  per = 15.8  per(accum) = 16.7
 T(local opt: dvdsn) = 2.927e-01 S  per = 23.8  per(accum) = 40.5
 T(local opt: decim) = 1.349e-03 S  per = 0.11  per(accum) = 40.6
 T(local opt: guess) = 9.732e-04 S  per = 0.0793  per(accum) = 40.7
 T(local opt: renrm) = 7.277e-01 S  per = 59.3  per(accum) = 100
 T(local opt: save ) = 2.190e-04 S  per = 0.0178  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.927e-01 S  T(sum) = 2.923e-01 S  per = 9.986e+01
 T(local opt: preprocess                  ) = 3.481e-03 S  per = 1.19  per(accum) = 1.19
 T(local opt: symbolic_formulae           ) = 3.368e-03 S  per = 1.15  per(accum) = 2.34
 T(local opt: hintermediate init          ) = 1.908e-04 S  per = 0.0653  per(accum) = 2.41
 T(local opt: preprocess_hformulae_Hxlist ) = 8.625e-02 S  per = 29.5  per(accum) = 31.9
 T(local opt: hmmtasks init               ) = 2.052e-02 S  per = 7.02  per(accum) = 38.9
 T(local opt: initial guess for dvdson    ) = 9.920e-04 S  per = 0.339  per(accum) = 39.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.521e-01 S  per =   52  per(accum) = 91.3
 T(local opt: dvdson [cpu-gpu]            ) = 5.719e-03 S  per = 1.96  per(accum) = 93.3
 T(local opt: dvdson [nccl]               ) = 1.946e-02 S  per = 6.66  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 1.495e-06 S  per = 0.000511  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 2.134e-04 S  per = 0.073  per(accum) = 100
Detailed decomposition of T(renrm) = 7.277e-01 S  T(sum) = 7.277e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.604e-04 S  per = 0.0495  per(accum) = 0.0495
 T(local opt: qops init                    ) = 3.697e-03 S  per = 0.508  per(accum) = 0.558
 T(local opt: symbolic_formulae_renorm     ) = 3.720e-04 S  per = 0.0511  per(accum) = 0.609
 T(local opt: allocate qops on gpu         ) = 8.595e-05 S  per = 0.0118  per(accum) = 0.621
 T(local opt: site memcpy cpu2gpu          ) = 1.352e-03 S  per = 0.186  per(accum) = 0.806
 T(local opt: rintermediate init           ) = 2.488e-03 S  per = 0.342  per(accum) = 1.15
 T(local opt: preprocess_formulae_Rlist2   ) = 1.348e-02 S  per = 1.85  per(accum) = 3
 T(local opt: rmmtasks init                ) = 5.400e-03 S  per = 0.742  per(accum) = 3.74
 T(local opt: qops memset on cpu           ) = 4.600e-08 S  per = 6.32e-06  per(accum) = 3.74
 T(local opt: preprocess_renorm_batchGPU   ) = 3.878e-02 S  per = 5.33  per(accum) = 9.07
 T(local opt: deallocate cpu and gpu memory) = 5.337e-05 S  per = 0.00733  per(accum) = 9.08
 T(local opt: construct opS [ifdists=true] ) = 6.574e-01 S  per = 90.3  per(accum) = 99.4
 T(local opt: reduction of opS & opH [nccl]) = 2.227e-03 S  per = 0.306  per(accum) = 99.7
 T(local opt: qops memcpy gpu2cpu          ) = 9.926e-05 S  per = 0.0136  per(accum) = 99.7
 T(local opt: reduction of opS & opH [mpi] ) = 1.565e-04 S  per = 0.0215  per(accum) = 99.8
 T(local opt: qops_pool join and erase     ) = 1.733e-03 S  per = 0.238  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.011e-05 S  per = 0.00139  per(accum) = 100
##### sweep opt: 5.470e+00 S #####
 T(sweep opt: fetch) = 7.458e-02 S  per = 1.36  per(accum) = 1.36
 T(sweep opt: hdiag) = 6.393e-01 S  per = 11.7  per(accum) = 13.1
 T(sweep opt: dvdsn) = 1.024e+00 S  per = 18.7  per(accum) = 31.8
 T(sweep opt: decim) = 4.329e-03 S  per = 0.0791  per(accum) = 31.8
 T(sweep opt: guess) = 2.738e-03 S  per = 0.05  per(accum) = 31.9
 T(sweep opt: renrm) = 3.724e+00 S  per = 68.1  per(accum) = 100
 T(sweep opt: save ) = 9.516e-04 S  per = 0.0174  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.024e+00 S  T(sum) = 1.023e+00 S  per = 9.987e+01
 T(sweep opt: preprocess                  ) = 1.067e-02 S  per = 1.04  per(accum) = 1.04
 T(sweep opt: symbolic_formulae           ) = 1.043e-02 S  per = 1.02  per(accum) = 2.06
 T(sweep opt: hintermediate init          ) = 7.357e-04 S  per = 0.072  per(accum) = 2.14
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.185e-01 S  per = 11.6  per(accum) = 13.7
 T(sweep opt: hmmtasks init               ) = 2.568e-02 S  per = 2.51  per(accum) = 16.2
 T(sweep opt: initial guess for dvdson    ) = 3.060e-03 S  per = 0.299  per(accum) = 16.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 7.296e-01 S  per = 71.3  per(accum) = 87.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.764e-02 S  per =  2.7  per(accum) = 90.6
 T(sweep opt: dvdson [nccl]               ) = 9.476e-02 S  per = 9.27  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 5.138e-06 S  per = 0.000502  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.481e-03 S  per = 0.145  per(accum) = 100
Detailed decomposition of T(renrm) = 3.724e+00 S  T(sum) = 3.724e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.899e-04 S  per = 0.0212  per(accum) = 0.0212
 T(sweep opt: qops init                    ) = 6.042e-03 S  per = 0.162  per(accum) = 0.183
 T(sweep opt: symbolic_formulae_renorm     ) = 1.268e-03 S  per = 0.034  per(accum) = 0.217
 T(sweep opt: allocate qops on gpu         ) = 3.088e-04 S  per = 0.00829  per(accum) = 0.226
 T(sweep opt: site memcpy cpu2gpu          ) = 7.032e-03 S  per = 0.189  per(accum) = 0.415
 T(sweep opt: rintermediate init           ) = 1.001e-02 S  per = 0.269  per(accum) = 0.683
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.722e-02 S  per = 0.462  per(accum) = 1.15
 T(sweep opt: rmmtasks init                ) = 7.478e-03 S  per = 0.201  per(accum) = 1.35
 T(sweep opt: qops memset on cpu           ) = 2.040e-07 S  per = 5.48e-06  per(accum) = 1.35
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.960e-01 S  per = 5.26  per(accum) = 6.61
 T(sweep opt: deallocate cpu and gpu memory) = 1.428e-04 S  per = 0.00384  per(accum) = 6.61
 T(sweep opt: construct opS [ifdists=true] ) = 3.458e+00 S  per = 92.9  per(accum) = 99.5
 T(sweep opt: reduction of opS & opH [nccl]) = 1.119e-02 S  per =  0.3  per(accum) = 99.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.670e-04 S  per = 0.00985  per(accum) = 99.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.801e-04 S  per = 0.00752  per(accum) = 99.8
 T(sweep opt: qops_pool join and erase     ) = 7.889e-03 S  per = 0.212  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 2.380e-05 S  per = 0.000639  per(accum) = 100
##### global opt: 5.470e+00 S #####
 T(global opt: fetch) = 7.458e-02 S  per = 1.36  per(accum) = 1.36
 T(global opt: hdiag) = 6.393e-01 S  per = 11.7  per(accum) = 13.1
 T(global opt: dvdsn) = 1.024e+00 S  per = 18.7  per(accum) = 31.8
 T(global opt: decim) = 4.329e-03 S  per = 0.0791  per(accum) = 31.8
 T(global opt: guess) = 2.738e-03 S  per = 0.05  per(accum) = 31.9
 T(global opt: renrm) = 3.724e+00 S  per = 68.1  per(accum) = 100
 T(global opt: save ) = 9.516e-04 S  per = 0.0174  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.024e+00 S  T(sum) = 1.023e+00 S  per = 9.987e+01
 T(global opt: preprocess                  ) = 1.067e-02 S  per = 1.04  per(accum) = 1.04
 T(global opt: symbolic_formulae           ) = 1.043e-02 S  per = 1.02  per(accum) = 2.06
 T(global opt: hintermediate init          ) = 7.357e-04 S  per = 0.072  per(accum) = 2.14
 T(global opt: preprocess_hformulae_Hxlist ) = 1.185e-01 S  per = 11.6  per(accum) = 13.7
 T(global opt: hmmtasks init               ) = 2.568e-02 S  per = 2.51  per(accum) = 16.2
 T(global opt: initial guess for dvdson    ) = 3.060e-03 S  per = 0.299  per(accum) = 16.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 7.296e-01 S  per = 71.3  per(accum) = 87.9
 T(global opt: dvdson [cpu-gpu]            ) = 2.764e-02 S  per =  2.7  per(accum) = 90.6
 T(global opt: dvdson [nccl]               ) = 9.476e-02 S  per = 9.27  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 5.138e-06 S  per = 0.000502  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.481e-03 S  per = 0.145  per(accum) = 100
Detailed decomposition of T(renrm) = 3.724e+00 S  T(sum) = 3.724e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.899e-04 S  per = 0.0212  per(accum) = 0.0212
 T(global opt: qops init                    ) = 6.042e-03 S  per = 0.162  per(accum) = 0.183
 T(global opt: symbolic_formulae_renorm     ) = 1.268e-03 S  per = 0.034  per(accum) = 0.217
 T(global opt: allocate qops on gpu         ) = 3.088e-04 S  per = 0.00829  per(accum) = 0.226
 T(global opt: site memcpy cpu2gpu          ) = 7.032e-03 S  per = 0.189  per(accum) = 0.415
 T(global opt: rintermediate init           ) = 1.001e-02 S  per = 0.269  per(accum) = 0.683
 T(global opt: preprocess_formulae_Rlist2   ) = 1.722e-02 S  per = 0.462  per(accum) = 1.15
 T(global opt: rmmtasks init                ) = 7.478e-03 S  per = 0.201  per(accum) = 1.35
 T(global opt: qops memset on cpu           ) = 2.040e-07 S  per = 5.48e-06  per(accum) = 1.35
 T(global opt: preprocess_renorm_batchGPU   ) = 1.960e-01 S  per = 5.26  per(accum) = 6.61
 T(global opt: deallocate cpu and gpu memory) = 1.428e-04 S  per = 0.00384  per(accum) = 6.61
 T(global opt: construct opS [ifdists=true] ) = 3.458e+00 S  per = 92.9  per(accum) = 99.5
 T(global opt: reduction of opS & opH [nccl]) = 1.119e-02 S  per =  0.3  per(accum) = 99.8
 T(global opt: qops memcpy gpu2cpu          ) = 3.670e-04 S  per = 0.00985  per(accum) = 99.8
 T(global opt: reduction of opS & opH [mpi] ) = 2.801e-04 S  per = 0.00752  per(accum) = 99.8
 T(global opt: qops_pool join and erase     ) = 7.889e-03 S  per = 0.212  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 2.380e-05 S  per = 0.000639  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.199e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=5/seqsize=34 dots=2 dbond=(6,0)-(7,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=111:8.469e-04MB:8.270e-07GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=14:1.068e-04MB:1.043e-07GB
total mem of comb=126:9.613e-04MB:9.388e-07GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=6,12,1,1
 suppl= 0 1 2 3 4 16
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 17
 suppc2= 18
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:6 S:8 A:18 B:20 
        dim(bra,ket)=10,10 size(op)=31:2.365e-04MB size(tot)=748:5.707e-03MB:5.573e-06GB
        per(mem): H:1.87 C:12.8 S:17.1 A:8.02 B:60.2 
 rqops: oplist=HCSPQ nops=H:1 C:12 S:3 P:31 Q:36 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=183:0.0014MB:1.36e-06GB
        per(mem): H:1.64 C:0 S:0 P:0 Q:98.4 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2927:0.0223MB:2.18e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.849e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(6,0) fdel=./scratch/sweep/rop(7,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.013e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=32:2.441e-04MB
qtensor4: wf4 own=1 _data=0x3b1a4200
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=8 dimAll=10
 (8,2):2 (8,4):2 (7,3):1 (9,3):1 (7,1):1 (9,1):1 (8,0):1 (7,5):1
 qbond: qcol nsym=3 dimAll=3
 (19,1):1 (19,3):1 (19,5):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=24 nblocks=372 size=32:2.441e-04MB
### DIAG TIMING: total=2.754e-01 t1=3.066e-05, t2=1.263e-03, t3=2.421e-03, t4=2.692e-01, t5=4.900e-06, t6=2.516e-03, t7=5.022e-06
duration_diagGPU:2.754e-01
duration_diagreduce:7.000e-08
duration_diagtransform:3.630e-07
----- TIMING FOR symbolic_formulae_twodot with size=310 : 4.374e-03 S -----
rank=0 GPUmem(GB): used=2.181e-05 (oper)=2.181e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=310
 no. of hintermediate operators=156
 no. of coefficients=1848:1.410e-02MB:1.377e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.766e-04 S -----
rank=0 GPUmem(GB): used=3.558e-05 (oper,hinter)=2.181e-05,1.377e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.110e-01 S size(H_formulae)=310 size(Hxlst2)=24 T(Hmu/Hxlist)=8.478e-04,1.102e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.115e-01 S size(H_formulae)=310 size(Hxlst)=5064 -----
rank=0 GPUmem(GB): used=3.558e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=4.768e-07 batch[need]=3.396e-04 blksize=2 blksize0=4 batchsize=5064
rank=0 GPUmem(GB): used=3.756e-04 (oper,hinter,dvdson,batch)=2.181e-05,1.377e-05,4.768e-07,3.396e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=32 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.422e-03,7.648e-03,3.015e-02,1.307e-02,5.630e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=3.578e-04 speed=1.333e-03GB/S T(nccl)=5.064e-03 speed=9.416e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=16 t=7.6e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=16 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=4 t=7.5e-03 per=1.5e+01 cost=4.2e+03 flops=5.6e+05
 sigma[gemm] counter=16 i=5 t=7.5e-03 per=1.5e+01 cost=4.5e+03 flops=6.0e+05
 sigma[gemm] counter=16 i=6 t=7.5e-03 per=1.5e+01 cost=9.2e+03 flops=1.2e+06
 sigma[gemm] counter=16 i=7 t=7.6e-03 per=1.5e+01 cost=9.2e+03 flops=1.2e+06
 sigma[gemm] counter=16 total t=3.0e-02 per=5.9e+01 cost=2.7e+04 flops=9.0e+05
 sigma[red] counter=16 t=1.3e-02 per=2.6e+01 cost=1.4e+04 flops=1.0e+06
----- TIMING FOR sigma_tot : t_inter=9.8e-02 t_gemm=4.8e-01 t_reduction=2.0e-01 tot=7.8e-01 -----
 sigma_tot[inter] counter=16 t=9.8e-02 per=1.3e+01 cost=4.6e+04 flops=4.7e+05
 sigma_tot[gemm] counter=16 i=0 t=2.2e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=1 t=1.9e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=2 t=1.9e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=3 t=1.9e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=4 t=1.2e-01 per=1.5e+01 cost=1.5e+04 flops=1.3e+05
 sigma_tot[gemm] counter=16 i=5 t=1.2e-01 per=1.5e+01 cost=1.5e+04 flops=1.3e+05
 sigma_tot[gemm] counter=16 i=6 t=1.2e-01 per=1.5e+01 cost=3.1e+04 flops=2.6e+05
 sigma_tot[gemm] counter=16 i=7 t=1.2e-01 per=1.5e+01 cost=3.1e+04 flops=2.6e+05
 sigma_tot[gemm] counter=16 total t=4.8e-01 per=6.1e+01 cost=9.3e+04 flops=2.0e+05
 sigma_tot[red] counter=16 t=2.0e-01 per=2.6e+01 cost=5.1e+04 flops=2.5e+05
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,6.8e-06,2.4e-06,7.4e-07,2.0e-07
settings: ndim=32 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.120814666334 -1.116e+03  4.076e-02    1     1  5.654e-02 5.654e-02 5.650e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.844e-03,7.523e-03,3.015e-02,1.282e-02,5.834e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=2.233e-03 speed=2.136e-04GB/S T(nccl)=5.611e-03 speed=8.498e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=17 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.7e+06
 sigma[gemm] counter=17 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=4 t=7.5e-03 per=1.5e+01 cost=4.2e+03 flops=5.6e+05
 sigma[gemm] counter=17 i=5 t=7.5e-03 per=1.5e+01 cost=4.5e+03 flops=6.1e+05
 sigma[gemm] counter=17 i=6 t=7.6e-03 per=1.5e+01 cost=9.2e+03 flops=1.2e+06
 sigma[gemm] counter=17 i=7 t=7.6e-03 per=1.5e+01 cost=9.2e+03 flops=1.2e+06
 sigma[gemm] counter=17 total t=3.0e-02 per=6.0e+01 cost=2.7e+04 flops=9.0e+05
 sigma[red] counter=17 t=1.3e-02 per=2.5e+01 cost=1.4e+04 flops=1.1e+06
----- TIMING FOR sigma_tot : t_inter=1.1e-01 t_gemm=5.1e-01 t_reduction=2.2e-01 tot=8.3e-01 -----
 sigma_tot[inter] counter=17 t=1.1e-01 per=1.3e+01 cost=5.9e+04 flops=5.6e+05
 sigma_tot[gemm] counter=17 i=0 t=2.3e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=1 t=2.1e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=2 t=2.0e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=3 t=2.0e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=4 t=1.3e-01 per=1.5e+01 cost=1.9e+04 flops=1.6e+05
 sigma_tot[gemm] counter=17 i=5 t=1.3e-01 per=1.5e+01 cost=2.0e+04 flops=1.6e+05
 sigma_tot[gemm] counter=17 i=6 t=1.3e-01 per=1.5e+01 cost=4.1e+04 flops=3.2e+05
 sigma_tot[gemm] counter=17 i=7 t=1.3e-01 per=1.5e+01 cost=4.1e+04 flops=3.2e+05
 sigma_tot[gemm] counter=17 total t=5.1e-01 per=6.1e+01 cost=1.2e+05 flops=2.4e+05
 sigma_tot[red] counter=17 t=2.2e-01 per=2.6e+01 cost=6.5e+04 flops=3.0e+05
T(sub)=4.9e-05 T(gemm/eig/ortho/gemm/axpy)=9.1e-06,3.4e-05,3.7e-06,1.4e-06,1.8e-07
    2   0 -    -116.134270189387 -1.346e-02  2.109e-02    2     2  1.153e-01 5.767e-02 5.755e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.215e-02,7.458e-03,1.768e-02,2.715e-03,6.001e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=2.086e-03 speed=2.285e-04GB/S T(nccl)=3.007e-02 speed=1.586e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=1.8e-02 t_reduction=2.7e-03 tot=2.8e-02 -----
 sigma[inter] counter=18 t=7.5e-03 per=2.7e+01 cost=1.2e+04 flops=1.7e+06
 sigma[gemm] counter=18 i=0 t=1.3e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=1 t=1.1e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=2 t=1.1e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=3 t=1.1e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=4 t=7.6e-03 per=2.7e+01 cost=4.2e+03 flops=5.5e+05
 sigma[gemm] counter=18 i=5 t=6.5e-03 per=2.3e+01 cost=4.5e+03 flops=7.0e+05
 sigma[gemm] counter=18 i=6 t=1.1e-03 per=4.0e+00 cost=9.2e+03 flops=8.3e+06
 sigma[gemm] counter=18 i=7 t=2.5e-03 per=9.0e+00 cost=9.2e+03 flops=3.7e+06
 sigma[gemm] counter=18 total t=1.8e-02 per=6.3e+01 cost=2.7e+04 flops=1.5e+06
 sigma[red] counter=18 t=2.7e-03 per=9.7e+00 cost=1.4e+04 flops=5.0e+06
----- TIMING FOR sigma_tot : t_inter=1.1e-01 t_gemm=5.2e-01 t_reduction=2.2e-01 tot=8.6e-01 -----
 sigma_tot[inter] counter=18 t=1.1e-01 per=1.3e+01 cost=7.1e+04 flops=6.3e+05
 sigma_tot[gemm] counter=18 i=0 t=2.4e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=1 t=2.2e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=2 t=2.1e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=3 t=2.1e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=4 t=1.3e-01 per=1.6e+01 cost=2.4e+04 flops=1.8e+05
 sigma_tot[gemm] counter=18 i=5 t=1.3e-01 per=1.6e+01 cost=2.4e+04 flops=1.8e+05
 sigma_tot[gemm] counter=18 i=6 t=1.3e-01 per=1.5e+01 cost=5.0e+04 flops=3.9e+05
 sigma_tot[gemm] counter=18 i=7 t=1.3e-01 per=1.5e+01 cost=5.0e+04 flops=3.8e+05
 sigma_tot[gemm] counter=18 total t=5.2e-01 per=6.1e+01 cost=1.5e+05 flops=2.8e+05
 sigma_tot[red] counter=18 t=2.2e-01 per=2.5e+01 cost=7.9e+04 flops=3.6e+05
T(sub)=3.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,2.0e-05,3.1e-06,1.1e-05,1.8e-07
    3   0 -    -116.135647735291 -1.378e-03  4.889e-03    3     3  1.756e-01 5.854e-02 5.844e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.993e-03,7.461e-03,2.969e-02,1.270e-02,5.885e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=2.186e-03 speed=2.181e-04GB/S T(nccl)=6.807e-03 speed=7.005e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=19 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.7e+06
 sigma[gemm] counter=19 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=4 t=7.4e-03 per=1.5e+01 cost=4.2e+03 flops=5.7e+05
 sigma[gemm] counter=19 i=5 t=7.5e-03 per=1.5e+01 cost=4.5e+03 flops=6.0e+05
 sigma[gemm] counter=19 i=6 t=7.4e-03 per=1.5e+01 cost=9.2e+03 flops=1.2e+06
 sigma[gemm] counter=19 i=7 t=7.3e-03 per=1.5e+01 cost=9.2e+03 flops=1.3e+06
 sigma[gemm] counter=19 total t=3.0e-02 per=6.0e+01 cost=2.7e+04 flops=9.1e+05
 sigma[red] counter=19 t=1.3e-02 per=2.5e+01 cost=1.4e+04 flops=1.1e+06
----- TIMING FOR sigma_tot : t_inter=1.2e-01 t_gemm=5.5e-01 t_reduction=2.3e-01 tot=9.1e-01 -----
 sigma_tot[inter] counter=19 t=1.2e-01 per=1.3e+01 cost=8.3e+04 flops=6.9e+05
 sigma_tot[gemm] counter=19 i=0 t=2.6e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=1 t=2.3e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=2 t=2.2e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=3 t=2.2e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=4 t=1.4e-01 per=1.5e+01 cost=2.8e+04 flops=2.0e+05
 sigma_tot[gemm] counter=19 i=5 t=1.4e-01 per=1.6e+01 cost=2.9e+04 flops=2.0e+05
 sigma_tot[gemm] counter=19 i=6 t=1.4e-01 per=1.5e+01 cost=5.9e+04 flops=4.3e+05
 sigma_tot[gemm] counter=19 i=7 t=1.4e-01 per=1.5e+01 cost=5.9e+04 flops=4.3e+05
 sigma_tot[gemm] counter=19 total t=5.5e-01 per=6.1e+01 cost=1.7e+05 flops=3.2e+05
 sigma_tot[red] counter=19 t=2.3e-01 per=2.5e+01 cost=9.3e+04 flops=4.0e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.3e-05,3.1e-06,1.1e-06,2.0e-07
    4   0 -    -116.135717818154 -7.008e-05  1.417e-03    3     4  2.347e-01 5.869e-02 5.859e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.180e-02,7.463e-03,2.968e-02,1.262e-02,6.157e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=2.200e-03 speed=2.168e-04GB/S T(nccl)=9.596e-03 speed=4.969e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=20 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.7e+06
 sigma[gemm] counter=20 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=4 t=7.4e-03 per=1.5e+01 cost=4.2e+03 flops=5.7e+05
 sigma[gemm] counter=20 i=5 t=7.5e-03 per=1.5e+01 cost=4.5e+03 flops=6.1e+05
 sigma[gemm] counter=20 i=6 t=7.4e-03 per=1.5e+01 cost=9.2e+03 flops=1.2e+06
 sigma[gemm] counter=20 i=7 t=7.3e-03 per=1.5e+01 cost=9.2e+03 flops=1.3e+06
 sigma[gemm] counter=20 total t=3.0e-02 per=6.0e+01 cost=2.7e+04 flops=9.1e+05
 sigma[red] counter=20 t=1.3e-02 per=2.5e+01 cost=1.4e+04 flops=1.1e+06
----- TIMING FOR sigma_tot : t_inter=1.3e-01 t_gemm=5.8e-01 t_reduction=2.4e-01 tot=9.6e-01 -----
 sigma_tot[inter] counter=20 t=1.3e-01 per=1.3e+01 cost=9.6e+04 flops=7.5e+05
 sigma_tot[gemm] counter=20 i=0 t=2.7e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=1 t=2.4e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=2 t=2.3e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=3 t=2.3e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=4 t=1.5e-01 per=1.5e+01 cost=3.2e+04 flops=2.2e+05
 sigma_tot[gemm] counter=20 i=5 t=1.5e-01 per=1.6e+01 cost=3.3e+04 flops=2.2e+05
 sigma_tot[gemm] counter=20 i=6 t=1.4e-01 per=1.5e+01 cost=6.8e+04 flops=4.8e+05
 sigma_tot[gemm] counter=20 i=7 t=1.4e-01 per=1.5e+01 cost=6.8e+04 flops=4.7e+05
 sigma_tot[gemm] counter=20 total t=5.8e-01 per=6.1e+01 cost=2.0e+05 flops=3.5e+05
 sigma_tot[red] counter=20 t=2.4e-01 per=2.5e+01 cost=1.1e+05 flops=4.4e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,3.1e-06,1.0e-06,2.3e-07
    5   0 -    -116.135723873968 -6.056e-06  2.751e-04    3     5  2.966e-01 5.931e-02 5.923e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.232e-03,7.491e-03,3.005e-02,1.293e-02,5.971e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=2.249e-03 speed=2.120e-04GB/S T(nccl)=6.983e-03 speed=6.828e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=21 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.7e+06
 sigma[gemm] counter=21 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=4 t=7.5e-03 per=1.5e+01 cost=4.2e+03 flops=5.6e+05
 sigma[gemm] counter=21 i=5 t=7.5e-03 per=1.5e+01 cost=4.5e+03 flops=6.1e+05
 sigma[gemm] counter=21 i=6 t=7.5e-03 per=1.5e+01 cost=9.2e+03 flops=1.2e+06
 sigma[gemm] counter=21 i=7 t=7.5e-03 per=1.5e+01 cost=9.2e+03 flops=1.2e+06
 sigma[gemm] counter=21 total t=3.0e-02 per=6.0e+01 cost=2.7e+04 flops=9.0e+05
 sigma[red] counter=21 t=1.3e-02 per=2.6e+01 cost=1.4e+04 flops=1.1e+06
----- TIMING FOR sigma_tot : t_inter=1.4e-01 t_gemm=6.1e-01 t_reduction=2.6e-01 tot=1.0e+00 -----
 sigma_tot[inter] counter=21 t=1.4e-01 per=1.3e+01 cost=1.1e+05 flops=8.0e+05
 sigma_tot[gemm] counter=21 i=0 t=2.8e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=1 t=2.5e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=2 t=2.4e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=3 t=2.4e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=4 t=1.6e-01 per=1.5e+01 cost=3.6e+04 flops=2.3e+05
 sigma_tot[gemm] counter=21 i=5 t=1.6e-01 per=1.6e+01 cost=3.8e+04 flops=2.4e+05
 sigma_tot[gemm] counter=21 i=6 t=1.5e-01 per=1.5e+01 cost=7.7e+04 flops=5.1e+05
 sigma_tot[gemm] counter=21 i=7 t=1.5e-01 per=1.5e+01 cost=7.7e+04 flops=5.1e+05
 sigma_tot[gemm] counter=21 total t=6.1e-01 per=6.1e+01 cost=2.3e+05 flops=3.7e+05
 sigma_tot[red] counter=21 t=2.6e-01 per=2.5e+01 cost=1.2e+05 flops=4.7e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.3e-05,3.2e-06,9.9e-07,2.0e-07
    6   0 +    -116.135724112613 -2.386e-07  7.165e-05    3     6  3.566e-01 5.944e-02 5.934e-02
TIMING FOR Davidson : 3.567e-01  T(cal/comm/rest)=3.561e-01,1.428e-06,5.941e-04
decomposed t_rest=5.941e-04
 T(sub)    =1.679e-04 per=2.826e+01
 T(precond)=4.515e-05 per=7.600e+00
 T(ortho)  =1.158e-05 per=1.949e+00
 T(xcopy)  =7.970e-07 per=1.341e-01
 T(xnrm2)  =2.526e-06 per=4.252e-01
 T(other)  =3.662e-04 per=6.163e+01
optimized energies: isweep=0 ibond=5 dots=2 e[0]=-116.135724112613 nmvp=6
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=4.044e-04 change=1.597e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=15 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond5.txt
 qbond: qsuper nsym=15 dimAll=39
 (8,2):4 (10,2):4 (9,1):5 (9,3):6 (8,4):4 (10,4):3 (9,5):3 (7,3):1 (11,3):1 (7,1):1 (8,0):2 (11,1):1 (10,0):2 (7,5):1 (8,6):1
timing for divide=1.2e-04
timing for compute=9.1e-05
timing for collect=1.9e-05
----- TMING FOR decimation_genbasis(su2): 2.3e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.2e-04,8.1e-05,0.0e+00,9.9e-06,1.9e-05 -----
decimation summary: 39->10 dwt=+0.000e+00 SvN=9.371e-01
 qbond: qkept nsym=8 dimAll=10
 (10,2):2 (10,4):2 (9,1):1 (9,3):1 (9,5):1 (11,3):1 (11,1):1 (10,0):1
----- TIMING for decimation_row(nkr): 7.616e-04 S T(decim/select/formRot)=3.612e-04,2.333e-04,1.670e-04 -----
----- TIMING FOR twodot_decimation: 1.407e-03 S T(wf/decim)=6.310e-04,7.763e-04 -----
ctns::oper_renorm coord=(6,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:7 S:7 A:27 B:26 
        dim(bra,ket)=10,10 size(op)=31:2.365e-04MB size(tot)=913:6.966e-03MB:6.802e-06GB
        per(mem): H:1.53 C:12.3 S:12.3 A:9.86 B:64.1 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.594e-04 change=3.133e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=61 : 4.551e-04 S -----
rank=0 GPUmem(GB): used=4.102e-05 (oper)=1.981e-05
rank=0 GPUmem(GB): used=4.125e-05 (oper,site)=1.981e-05,2.384e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=61
 no. of rintermediate operators=5
 no. of coefficients=50:3.815e-04MB:3.725e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.448e-03 S -----
rank=0 GPUmem(GB): used=4.163e-05 (oper,site,rinter)=1.981e-05,2.384e-07,3.725e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.746e-02 S size(rtasks)=61 size(Rlst2)=64 T(Rmu/Rlist)=1.450e-04,1.732e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.760e-02 S size(rtasks)=61 size(Rlst)=1339 -----
rank=0 GPUmem(GB): used=4.163e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.297e-04 blksize=4 blksize0=4 batchsize=1339
rank=0 GPUmem(GB): used=1.713e-04 (oper,site,rinter,batch)=1.981e-05,2.384e-07,3.725e-07,1.297e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.800e-03,2.270e-02,1.017e-02
----- TIMING FOR renorm : t_inter=5.8e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=86 t=5.8e-03 per=1.5e+01 cost=5.6e+03 flops=9.7e+05
 renorm[gemm] counter=86 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=86 i=1 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=86 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=86 i=3 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=86 i=4 t=7.5e-03 per=1.9e+01 cost=6.1e+02 flops=8.2e+04
 renorm[gemm] counter=86 i=5 t=7.5e-03 per=2.0e+01 cost=5.6e+03 flops=7.5e+05
 renorm[gemm] counter=86 i=6 t=7.7e-03 per=2.0e+01 cost=6.2e+03 flops=8.1e+05
 renorm[gemm] counter=86 total t=2.3e-02 per=5.9e+01 cost=1.2e+04 flops=5.5e+05
 renorm[red] counter=86 t=1.0e-02 per=2.6e+01 cost=4.7e+03 flops=4.6e+05
----- TIMING FOR renorm_tot : t_inter=3.8e-02 t_gemm=1.4e-01 t_reduction=6.0e-02 tot=2.3e-01 -----
 renorm_tot[inter] counter=86 t=3.8e-02 per=1.6e+01 cost=9.1e+03 flops=2.4e+05
 renorm_tot[gemm] counter=86 i=0 t=8.2e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=86 i=1 t=6.9e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=86 i=2 t=6.7e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=86 i=3 t=6.7e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=86 i=4 t=4.5e-02 per=1.9e+01 cost=1.2e+03 flops=2.7e+04
 renorm_tot[gemm] counter=86 i=5 t=4.5e-02 per=1.9e+01 cost=9.9e+03 flops=2.2e+05
 renorm_tot[gemm] counter=86 i=6 t=4.5e-02 per=1.9e+01 cost=1.2e+04 flops=2.7e+05
 renorm_tot[gemm] counter=86 total t=1.4e-01 per=5.8e+01 cost=2.3e+04 flops=1.7e+05
 renorm_tot[red] counter=86 t=6.0e-02 per=2.6e+01 cost=9.6e+03 flops=1.6e+05
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.806e-05 (optmp,oper)=1.192e-07,1.981e-05
rank=0 GPUmem(GB): used=4.830e-05 (optmp,oper,site,rinter)=1.192e-07,1.981e-05,2.384e-07,6.557e-06
rank=0 GPUmem(GB): used=6.235e-05 (optmp,oper,site,rinter,batch)=1.192e-07,1.981e-05,2.384e-07,6.557e-06,1.404e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 6.279e-01 S T(prep/alloc/comp/red/dealloc)=3.231e-02,4.100e-02,5.197e-01,6.461e-02,2.584e-03 -----
----- TIMING FOR oper_renorm_opS : 6.282e-01 S rank=0 -----
qops.to_cpu: size(tot)=913:6.966e-03MB:6.802e-06GB T(to_cpu)=1.576e-04S speed=4.317e-02GB/S
check ||H-H.dagger||=2.995e-16 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.704 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.312e-03 change=3.629e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.602e-03 change=-1.445e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.602e-03 change=-7.480e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.506e+00 S #####
 T(local opt: fetch) = 1.177e-02 S  per = 0.781  per(accum) = 0.781
 T(local opt: hdiag) = 2.762e-01 S  per = 18.3  per(accum) = 19.1
 T(local opt: dvdsn) = 5.085e-01 S  per = 33.8  per(accum) = 52.9
 T(local opt: decim) = 1.557e-03 S  per = 0.103  per(accum) = 53
 T(local opt: guess) = 1.156e-03 S  per = 0.0767  per(accum) = 53.1
 T(local opt: renrm) = 7.069e-01 S  per = 46.9  per(accum) = 100
 T(local opt: save ) = 2.216e-04 S  per = 0.0147  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.085e-01 S  T(sum) = 5.082e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 5.519e-03 S  per = 1.09  per(accum) = 1.09
 T(local opt: symbolic_formulae           ) = 4.391e-03 S  per = 0.864  per(accum) = 1.95
 T(local opt: hintermediate init          ) = 2.001e-04 S  per = 0.0394  per(accum) = 1.99
 T(local opt: preprocess_hformulae_Hxlist ) = 1.118e-01 S  per =   22  per(accum) = 24
 T(local opt: hmmtasks init               ) = 2.817e-02 S  per = 5.54  per(accum) = 29.5
 T(local opt: initial guess for dvdson    ) = 1.452e-03 S  per = 0.286  per(accum) = 29.8
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.806e-01 S  per = 55.2  per(accum) = 85
 T(local opt: dvdson [cpu-gpu]            ) = 1.131e-02 S  per = 2.23  per(accum) = 87.3
 T(local opt: dvdson [nccl]               ) = 6.413e-02 S  per = 12.6  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 1.428e-06 S  per = 0.000281  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 5.941e-04 S  per = 0.117  per(accum) = 100
Detailed decomposition of T(renrm) = 7.069e-01 S  T(sum) = 7.069e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.473e-04 S  per = 0.0774  per(accum) = 0.0774
 T(local opt: qops init                    ) = 4.600e-03 S  per = 0.651  per(accum) = 0.728
 T(local opt: symbolic_formulae_renorm     ) = 4.669e-04 S  per = 0.066  per(accum) = 0.794
 T(local opt: allocate qops on gpu         ) = 8.553e-05 S  per = 0.0121  per(accum) = 0.806
 T(local opt: site memcpy cpu2gpu          ) = 1.738e-03 S  per = 0.246  per(accum) = 1.05
 T(local opt: rintermediate init           ) = 2.462e-03 S  per = 0.348  per(accum) = 1.4
 T(local opt: preprocess_formulae_Rlist2   ) = 1.765e-02 S  per =  2.5  per(accum) = 3.9
 T(local opt: rmmtasks init                ) = 7.496e-03 S  per = 1.06  per(accum) = 4.96
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 4.95e-06  per(accum) = 4.96
 T(local opt: preprocess_renorm_batchGPU   ) = 3.888e-02 S  per =  5.5  per(accum) = 10.5
 T(local opt: deallocate cpu and gpu memory) = 6.773e-05 S  per = 0.00958  per(accum) = 10.5
 T(local opt: construct opS [ifdists=true] ) = 6.282e-01 S  per = 88.9  per(accum) = 99.3
 T(local opt: reduction of opS & opH [nccl]) = 2.126e-03 S  per = 0.301  per(accum) = 99.6
 T(local opt: qops memcpy gpu2cpu          ) = 1.696e-04 S  per = 0.024  per(accum) = 99.7
 T(local opt: reduction of opS & opH [mpi] ) = 1.108e-04 S  per = 0.0157  per(accum) = 99.7
 T(local opt: qops_pool join and erase     ) = 2.308e-03 S  per = 0.327  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.380e-05 S  per = 0.00195  per(accum) = 100
##### sweep opt: 6.977e+00 S #####
 T(sweep opt: fetch) = 8.635e-02 S  per = 1.24  per(accum) = 1.24
 T(sweep opt: hdiag) = 9.156e-01 S  per = 13.1  per(accum) = 14.4
 T(sweep opt: dvdsn) = 1.532e+00 S  per =   22  per(accum) = 36.3
 T(sweep opt: decim) = 5.885e-03 S  per = 0.0844  per(accum) = 36.4
 T(sweep opt: guess) = 3.893e-03 S  per = 0.0558  per(accum) = 36.5
 T(sweep opt: renrm) = 4.431e+00 S  per = 63.5  per(accum) = 100
 T(sweep opt: save ) = 1.173e-03 S  per = 0.0168  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.532e+00 S  T(sum) = 1.531e+00 S  per = 9.989e+01
 T(sweep opt: preprocess                  ) = 1.619e-02 S  per = 1.06  per(accum) = 1.06
 T(sweep opt: symbolic_formulae           ) = 1.482e-02 S  per = 0.968  per(accum) = 2.03
 T(sweep opt: hintermediate init          ) = 9.359e-04 S  per = 0.0611  per(accum) = 2.09
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.303e-01 S  per =   15  per(accum) = 17.1
 T(sweep opt: hmmtasks init               ) = 5.384e-02 S  per = 3.52  per(accum) = 20.6
 T(sweep opt: initial guess for dvdson    ) = 4.513e-03 S  per = 0.295  per(accum) = 20.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.010e+00 S  per =   66  per(accum) = 86.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.895e-02 S  per = 2.54  per(accum) = 89.5
 T(sweep opt: dvdson [nccl]               ) = 1.589e-01 S  per = 10.4  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 6.566e-06 S  per = 0.000429  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.076e-03 S  per = 0.136  per(accum) = 100
Detailed decomposition of T(renrm) = 4.431e+00 S  T(sum) = 4.431e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.337e-03 S  per = 0.0302  per(accum) = 0.0302
 T(sweep opt: qops init                    ) = 1.064e-02 S  per = 0.24  per(accum) = 0.27
 T(sweep opt: symbolic_formulae_renorm     ) = 1.734e-03 S  per = 0.0391  per(accum) = 0.309
 T(sweep opt: allocate qops on gpu         ) = 3.943e-04 S  per = 0.0089  per(accum) = 0.318
 T(sweep opt: site memcpy cpu2gpu          ) = 8.770e-03 S  per = 0.198  per(accum) = 0.516
 T(sweep opt: rintermediate init           ) = 1.247e-02 S  per = 0.281  per(accum) = 0.798
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.487e-02 S  per = 0.787  per(accum) = 1.58
 T(sweep opt: rmmtasks init                ) = 1.497e-02 S  per = 0.338  per(accum) = 1.92
 T(sweep opt: qops memset on cpu           ) = 2.390e-07 S  per = 5.39e-06  per(accum) = 1.92
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.349e-01 S  per =  5.3  per(accum) = 7.22
 T(sweep opt: deallocate cpu and gpu memory) = 2.106e-04 S  per = 0.00475  per(accum) = 7.23
 T(sweep opt: construct opS [ifdists=true] ) = 4.087e+00 S  per = 92.2  per(accum) = 99.4
 T(sweep opt: reduction of opS & opH [nccl]) = 1.332e-02 S  per = 0.301  per(accum) = 99.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.366e-04 S  per = 0.0121  per(accum) = 99.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.909e-04 S  per = 0.00882  per(accum) = 99.8
 T(sweep opt: qops_pool join and erase     ) = 1.020e-02 S  per = 0.23  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 3.760e-05 S  per = 0.000848  per(accum) = 100
##### global opt: 6.977e+00 S #####
 T(global opt: fetch) = 8.635e-02 S  per = 1.24  per(accum) = 1.24
 T(global opt: hdiag) = 9.156e-01 S  per = 13.1  per(accum) = 14.4
 T(global opt: dvdsn) = 1.532e+00 S  per =   22  per(accum) = 36.3
 T(global opt: decim) = 5.885e-03 S  per = 0.0844  per(accum) = 36.4
 T(global opt: guess) = 3.893e-03 S  per = 0.0558  per(accum) = 36.5
 T(global opt: renrm) = 4.431e+00 S  per = 63.5  per(accum) = 100
 T(global opt: save ) = 1.173e-03 S  per = 0.0168  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.532e+00 S  T(sum) = 1.531e+00 S  per = 9.989e+01
 T(global opt: preprocess                  ) = 1.619e-02 S  per = 1.06  per(accum) = 1.06
 T(global opt: symbolic_formulae           ) = 1.482e-02 S  per = 0.968  per(accum) = 2.03
 T(global opt: hintermediate init          ) = 9.359e-04 S  per = 0.0611  per(accum) = 2.09
 T(global opt: preprocess_hformulae_Hxlist ) = 2.303e-01 S  per =   15  per(accum) = 17.1
 T(global opt: hmmtasks init               ) = 5.384e-02 S  per = 3.52  per(accum) = 20.6
 T(global opt: initial guess for dvdson    ) = 4.513e-03 S  per = 0.295  per(accum) = 20.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.010e+00 S  per =   66  per(accum) = 86.9
 T(global opt: dvdson [cpu-gpu]            ) = 3.895e-02 S  per = 2.54  per(accum) = 89.5
 T(global opt: dvdson [nccl]               ) = 1.589e-01 S  per = 10.4  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 6.566e-06 S  per = 0.000429  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 2.076e-03 S  per = 0.136  per(accum) = 100
Detailed decomposition of T(renrm) = 4.431e+00 S  T(sum) = 4.431e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.337e-03 S  per = 0.0302  per(accum) = 0.0302
 T(global opt: qops init                    ) = 1.064e-02 S  per = 0.24  per(accum) = 0.27
 T(global opt: symbolic_formulae_renorm     ) = 1.734e-03 S  per = 0.0391  per(accum) = 0.309
 T(global opt: allocate qops on gpu         ) = 3.943e-04 S  per = 0.0089  per(accum) = 0.318
 T(global opt: site memcpy cpu2gpu          ) = 8.770e-03 S  per = 0.198  per(accum) = 0.516
 T(global opt: rintermediate init           ) = 1.247e-02 S  per = 0.281  per(accum) = 0.798
 T(global opt: preprocess_formulae_Rlist2   ) = 3.487e-02 S  per = 0.787  per(accum) = 1.58
 T(global opt: rmmtasks init                ) = 1.497e-02 S  per = 0.338  per(accum) = 1.92
 T(global opt: qops memset on cpu           ) = 2.390e-07 S  per = 5.39e-06  per(accum) = 1.92
 T(global opt: preprocess_renorm_batchGPU   ) = 2.349e-01 S  per =  5.3  per(accum) = 7.22
 T(global opt: deallocate cpu and gpu memory) = 2.106e-04 S  per = 0.00475  per(accum) = 7.23
 T(global opt: construct opS [ifdists=true] ) = 4.087e+00 S  per = 92.2  per(accum) = 99.4
 T(global opt: reduction of opS & opH [nccl]) = 1.332e-02 S  per = 0.301  per(accum) = 99.7
 T(global opt: qops memcpy gpu2cpu          ) = 5.366e-04 S  per = 0.0121  per(accum) = 99.8
 T(global opt: reduction of opS & opH [mpi] ) = 3.909e-04 S  per = 0.00882  per(accum) = 99.8
 T(global opt: qops_pool join and erase     ) = 1.020e-02 S  per = 0.23  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 3.760e-05 S  per = 0.000848  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.581e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=6/seqsize=34 dots=2 dbond=(7,0)-(8,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=138:1.053e-03MB:1.028e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=14:1.068e-04MB:1.043e-07GB
total mem of comb=153:1.167e-03MB:1.140e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=7,11,1,1
 suppl= 0 1 2 3 4 16 17
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 18
 suppc2= 19
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:7 S:7 A:27 B:26 
        dim(bra,ket)=10,10 size(op)=31:2.365e-04MB size(tot)=913:6.966e-03MB:6.802e-06GB
        per(mem): H:1.53 C:12.3 S:12.3 A:9.86 B:64.1 
 rqops: oplist=HCSPQ nops=H:1 C:11 S:4 P:40 Q:46 
        dim(bra,ket)=3,3 size(op)=7:5.34e-05MB size(tot)=233:0.00178MB:1.74e-06GB
        per(mem): H:1.29 C:0 S:0 P:0 Q:98.7 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3142:0.024MB:2.34e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.049e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(7,0) fdel=./scratch/sweep/rop(8,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.490e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=32:2.441e-04MB
qtensor4: wf4 own=1 _data=0x3b276200
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=8 dimAll=10
 (10,2):2 (10,4):2 (9,1):1 (9,3):1 (9,5):1 (11,3):1 (11,1):1 (10,0):1
 qbond: qcol nsym=3 dimAll=3
 (17,1):1 (17,3):1 (17,5):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=24 nblocks=372 size=32:2.441e-04MB
### DIAG TIMING: total=4.707e-01 t1=2.541e-05, t2=1.265e-03, t3=2.496e-03, t4=3.547e-01, t5=3.789e-06, t6=1.122e-01, t7=5.305e-06
duration_diagGPU:4.707e-01
duration_diagreduce:6.900e-08
duration_diagtransform:3.530e-07
----- TIMING FOR symbolic_formulae_twodot with size=388 : 5.243e-03 S -----
rank=0 GPUmem(GB): used=2.341e-05 (oper)=2.341e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=388
 no. of hintermediate operators=201
 no. of coefficients=2367:1.806e-02MB:1.764e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.043e-04 S -----
rank=0 GPUmem(GB): used=4.105e-05 (oper,hinter)=2.341e-05,1.764e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.418e-01 S size(H_formulae)=388 size(Hxlst2)=24 T(Hmu/Hxlist)=1.033e-03,1.408e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.428e-01 S size(H_formulae)=388 size(Hxlst)=6464 -----
rank=0 GPUmem(GB): used=4.105e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=4.768e-07 batch[need]=4.334e-04 blksize=2 blksize0=4 batchsize=6464
rank=0 GPUmem(GB): used=4.750e-04 (oper,hinter,dvdson,batch)=2.341e-05,1.764e-05,4.768e-07,4.334e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=32 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.121e-03,7.538e-03,3.021e-02,1.297e-02,5.785e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=1.015e-03 speed=4.696e-04GB/S T(nccl)=6.106e-03 speed=7.810e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=22 t=7.5e-03 per=1.5e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=22 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=4 t=7.6e-03 per=1.5e+01 cost=5.4e+03 flops=7.1e+05
 sigma[gemm] counter=22 i=5 t=7.5e-03 per=1.5e+01 cost=5.7e+03 flops=7.7e+05
 sigma[gemm] counter=22 i=6 t=7.6e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=22 i=7 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=22 total t=3.0e-02 per=6.0e+01 cost=3.5e+04 flops=1.2e+06
 sigma[red] counter=22 t=1.3e-02 per=2.6e+01 cost=1.7e+04 flops=1.3e+06
----- TIMING FOR sigma_tot : t_inter=1.4e-01 t_gemm=6.4e-01 t_reduction=2.7e-01 tot=1.1e+00 -----
 sigma_tot[inter] counter=22 t=1.4e-01 per=1.4e+01 cost=1.3e+05 flops=8.9e+05
 sigma_tot[gemm] counter=22 i=0 t=3.0e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=1 t=2.6e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=2 t=2.6e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=3 t=2.5e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=4 t=1.6e-01 per=1.5e+01 cost=4.2e+04 flops=2.6e+05
 sigma_tot[gemm] counter=22 i=5 t=1.6e-01 per=1.5e+01 cost=4.4e+04 flops=2.7e+05
 sigma_tot[gemm] counter=22 i=6 t=1.6e-01 per=1.5e+01 cost=8.9e+04 flops=5.6e+05
 sigma_tot[gemm] counter=22 i=7 t=1.6e-01 per=1.5e+01 cost=8.9e+04 flops=5.6e+05
 sigma_tot[gemm] counter=22 total t=6.4e-01 per=6.1e+01 cost=2.6e+05 flops=4.1e+05
 sigma_tot[red] counter=22 t=2.7e-01 per=2.5e+01 cost=1.4e+05 flops=5.1e+05
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,5.8e-06,2.2e-06,9.0e-07,2.1e-07
settings: ndim=32 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.135724112613 -1.116e+03  5.207e-02    1     1  5.840e-02 5.840e-02 5.804e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.708e-03,7.602e-03,2.988e-02,1.294e-02,5.914e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=2.222e-03 speed=2.146e-04GB/S T(nccl)=6.487e-03 speed=7.351e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=23 t=7.6e-03 per=1.5e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=23 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=4 t=7.5e-03 per=1.5e+01 cost=5.4e+03 flops=7.1e+05
 sigma[gemm] counter=23 i=5 t=7.4e-03 per=1.5e+01 cost=5.7e+03 flops=7.7e+05
 sigma[gemm] counter=23 i=6 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=23 i=7 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=23 total t=3.0e-02 per=5.9e+01 cost=3.5e+04 flops=1.2e+06
 sigma[red] counter=23 t=1.3e-02 per=2.6e+01 cost=1.7e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=1.5e-01 t_gemm=6.7e-01 t_reduction=2.8e-01 tot=1.1e+00 -----
 sigma_tot[inter] counter=23 t=1.5e-01 per=1.4e+01 cost=1.4e+05 flops=9.6e+05
 sigma_tot[gemm] counter=23 i=0 t=3.1e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=1 t=2.7e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=2 t=2.7e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=3 t=2.7e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=4 t=1.7e-01 per=1.5e+01 cost=4.7e+04 flops=2.8e+05
 sigma_tot[gemm] counter=23 i=5 t=1.7e-01 per=1.5e+01 cost=4.9e+04 flops=2.9e+05
 sigma_tot[gemm] counter=23 i=6 t=1.7e-01 per=1.5e+01 cost=1.0e+05 flops=6.1e+05
 sigma_tot[gemm] counter=23 i=7 t=1.7e-01 per=1.5e+01 cost=1.0e+05 flops=6.1e+05
 sigma_tot[gemm] counter=23 total t=6.7e-01 per=6.1e+01 cost=3.0e+05 flops=4.4e+05
 sigma_tot[red] counter=23 t=2.8e-01 per=2.5e+01 cost=1.5e+05 flops=5.5e+05
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=7.7e-06,2.1e-05,1.3e-05,1.2e-06,2.1e-07
    2   0 -    -116.153831810652 -1.811e-02  2.310e-02    2     2  1.178e-01 5.889e-02 5.866e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.888e-03,7.594e-03,3.008e-02,1.287e-02,5.944e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=2.257e-03 speed=2.113e-04GB/S T(nccl)=6.631e-03 speed=7.191e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=24 t=7.6e-03 per=1.5e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=24 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=4 t=7.5e-03 per=1.5e+01 cost=5.4e+03 flops=7.2e+05
 sigma[gemm] counter=24 i=5 t=7.5e-03 per=1.5e+01 cost=5.7e+03 flops=7.7e+05
 sigma[gemm] counter=24 i=6 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=24 i=7 t=7.6e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=24 total t=3.0e-02 per=6.0e+01 cost=3.5e+04 flops=1.2e+06
 sigma[red] counter=24 t=1.3e-02 per=2.5e+01 cost=1.7e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=1.6e-01 t_gemm=7.0e-01 t_reduction=3.0e-01 tot=1.2e+00 -----
 sigma_tot[inter] counter=24 t=1.6e-01 per=1.4e+01 cost=1.6e+05 flops=1.0e+06
 sigma_tot[gemm] counter=24 i=0 t=3.2e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=1 t=2.9e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=2 t=2.8e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=3 t=2.8e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=4 t=1.8e-01 per=1.5e+01 cost=5.2e+04 flops=3.0e+05
 sigma_tot[gemm] counter=24 i=5 t=1.8e-01 per=1.5e+01 cost=5.5e+04 flops=3.1e+05
 sigma_tot[gemm] counter=24 i=6 t=1.7e-01 per=1.5e+01 cost=1.1e+05 flops=6.5e+05
 sigma_tot[gemm] counter=24 i=7 t=1.7e-01 per=1.5e+01 cost=1.1e+05 flops=6.5e+05
 sigma_tot[gemm] counter=24 total t=7.0e-01 per=6.1e+01 cost=3.3e+05 flops=4.7e+05
 sigma_tot[red] counter=24 t=3.0e-01 per=2.5e+01 cost=1.7e+05 flops=5.8e+05
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,3.5e-05,3.1e-06,1.1e-06,2.1e-07
    3   0 -    -116.155450899929 -1.619e-03  5.845e-03    3     3  1.775e-01 5.916e-02 5.898e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.840e-02,7.459e-03,1.982e-02,3.529e-03,5.921e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=2.163e-03 speed=2.205e-04GB/S T(nccl)=2.624e-02 speed=1.818e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=2.0e-02 t_reduction=3.5e-03 tot=3.1e-02 -----
 sigma[inter] counter=25 t=7.5e-03 per=2.4e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=25 i=0 t=1.2e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=1 t=1.1e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=2 t=1.1e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=3 t=1.1e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=4 t=7.5e-03 per=2.4e+01 cost=5.4e+03 flops=7.2e+05
 sigma[gemm] counter=25 i=5 t=7.6e-03 per=2.5e+01 cost=5.7e+03 flops=7.6e+05
 sigma[gemm] counter=25 i=6 t=3.7e-03 per=1.2e+01 cost=1.2e+04 flops=3.2e+06
 sigma[gemm] counter=25 i=7 t=1.1e-03 per=3.5e+00 cost=1.2e+04 flops=1.1e+07
 sigma[gemm] counter=25 total t=2.0e-02 per=6.4e+01 cost=3.5e+04 flops=1.8e+06
 sigma[red] counter=25 t=3.5e-03 per=1.1e+01 cost=1.7e+04 flops=5.0e+06
----- TIMING FOR sigma_tot : t_inter=1.7e-01 t_gemm=7.2e-01 t_reduction=3.0e-01 tot=1.2e+00 -----
 sigma_tot[inter] counter=25 t=1.7e-01 per=1.4e+01 cost=1.8e+05 flops=1.1e+06
 sigma_tot[gemm] counter=25 i=0 t=3.4e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=1 t=3.0e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=2 t=2.9e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=3 t=2.9e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=4 t=1.9e-01 per=1.6e+01 cost=5.8e+04 flops=3.1e+05
 sigma_tot[gemm] counter=25 i=5 t=1.9e-01 per=1.6e+01 cost=6.1e+04 flops=3.3e+05
 sigma_tot[gemm] counter=25 i=6 t=1.8e-01 per=1.5e+01 cost=1.2e+05 flops=7.0e+05
 sigma_tot[gemm] counter=25 i=7 t=1.8e-01 per=1.5e+01 cost=1.2e+05 flops=7.1e+05
 sigma_tot[gemm] counter=25 total t=7.2e-01 per=6.1e+01 cost=3.7e+05 flops=5.1e+05
 sigma_tot[red] counter=25 t=3.0e-01 per=2.5e+01 cost=1.9e+05 flops=6.4e+05
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=7.2e-06,1.5e-05,3.1e-06,1.0e-06,1.9e-07
    4   0 -    -116.155563726269 -1.128e-04  1.791e-03    3     4  2.370e-01 5.925e-02 5.909e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.170e-02,7.509e-03,2.977e-02,1.268e-02,6.167e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=2.202e-03 speed=2.165e-04GB/S T(nccl)=9.495e-03 speed=5.022e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=26 t=7.5e-03 per=1.5e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=26 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=4 t=7.4e-03 per=1.5e+01 cost=5.4e+03 flops=7.2e+05
 sigma[gemm] counter=26 i=5 t=7.4e-03 per=1.5e+01 cost=5.7e+03 flops=7.7e+05
 sigma[gemm] counter=26 i=6 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=26 i=7 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=26 total t=3.0e-02 per=6.0e+01 cost=3.5e+04 flops=1.2e+06
 sigma[red] counter=26 t=1.3e-02 per=2.5e+01 cost=1.7e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=1.7e-01 t_gemm=7.5e-01 t_reduction=3.1e-01 tot=1.2e+00 -----
 sigma_tot[inter] counter=26 t=1.7e-01 per=1.4e+01 cost=2.0e+05 flops=1.1e+06
 sigma_tot[gemm] counter=26 i=0 t=3.5e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=1 t=3.1e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=2 t=3.0e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=3 t=3.0e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=4 t=1.9e-01 per=1.6e+01 cost=6.3e+04 flops=3.3e+05
 sigma_tot[gemm] counter=26 i=5 t=1.9e-01 per=1.6e+01 cost=6.7e+04 flops=3.4e+05
 sigma_tot[gemm] counter=26 i=6 t=1.8e-01 per=1.5e+01 cost=1.4e+05 flops=7.4e+05
 sigma_tot[gemm] counter=26 i=7 t=1.8e-01 per=1.5e+01 cost=1.4e+05 flops=7.5e+05
 sigma_tot[gemm] counter=26 total t=7.5e-01 per=6.1e+01 cost=4.0e+05 flops=5.4e+05
 sigma_tot[red] counter=26 t=3.1e-01 per=2.5e+01 cost=2.1e+05 flops=6.7e+05
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.3e-05,3.1e-06,1.0e-06,2.2e-07
    5   0 -    -116.155573518720 -9.792e-06  6.035e-04    3     5  2.989e-01 5.977e-02 5.963e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.192e-03,7.458e-03,2.970e-02,1.262e-02,5.698e-02
 analyze_tgpu[Hx]: ndim=32:2.384e-07GB T(cpu-gpu)=2.246e-03 speed=2.123e-04GB/S T(nccl)=4.946e-03 speed=9.641e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=27 t=7.5e-03 per=1.5e+01 cost=1.8e+04 flops=2.4e+06
 sigma[gemm] counter=27 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=4 t=7.4e-03 per=1.5e+01 cost=5.4e+03 flops=7.2e+05
 sigma[gemm] counter=27 i=5 t=7.5e-03 per=1.5e+01 cost=5.7e+03 flops=7.7e+05
 sigma[gemm] counter=27 i=6 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=27 i=7 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=27 total t=3.0e-02 per=6.0e+01 cost=3.5e+04 flops=1.2e+06
 sigma[red] counter=27 t=1.3e-02 per=2.5e+01 cost=1.7e+04 flops=1.4e+06
----- TIMING FOR sigma_tot : t_inter=1.8e-01 t_gemm=7.8e-01 t_reduction=3.2e-01 tot=1.3e+00 -----
 sigma_tot[inter] counter=27 t=1.8e-01 per=1.4e+01 cost=2.2e+05 flops=1.2e+06
 sigma_tot[gemm] counter=27 i=0 t=3.6e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=1 t=3.2e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=2 t=3.1e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=3 t=3.1e-05 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=4 t=2.0e-01 per=1.6e+01 cost=6.9e+04 flops=3.4e+05
 sigma_tot[gemm] counter=27 i=5 t=2.0e-01 per=1.6e+01 cost=7.2e+04 flops=3.6e+05
 sigma_tot[gemm] counter=27 i=6 t=1.9e-01 per=1.5e+01 cost=1.5e+05 flops=7.7e+05
 sigma_tot[gemm] counter=27 i=7 t=1.9e-01 per=1.5e+01 cost=1.5e+05 flops=7.8e+05
 sigma_tot[gemm] counter=27 total t=7.8e-01 per=6.1e+01 cost=4.4e+05 flops=5.6e+05
 sigma_tot[red] counter=27 t=3.2e-01 per=2.5e+01 cost=2.2e+05 flops=6.9e+05
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.3e-05,3.2e-06,1.0e-06,1.9e-07
    6   0 +    -116.155574600124 -1.081e-06  9.376e-05    3     6  3.561e-01 5.935e-02 5.922e-02
TIMING FOR Davidson : 3.561e-01  T(cal/comm/rest)=3.553e-01,1.492e-06,8.060e-04
decomposed t_rest=8.060e-04
 T(sub)    =1.700e-04 per=2.109e+01
 T(precond)=4.300e-05 per=5.335e+00
 T(ortho)  =1.120e-05 per=1.389e+00
 T(xcopy)  =7.800e-07 per=9.677e-02
 T(xnrm2)  =2.395e-06 per=2.971e-01
 T(other)  =5.787e-04 per=7.180e+01
optimized energies: isweep=0 ibond=6 dots=2 e[0]=-116.155574600124 nmvp=6
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.114e-03 change=1.966e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=15 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond6.txt
 qbond: qsuper nsym=15 dimAll=39
 (10,2):4 (12,2):4 (11,1):5 (11,3):6 (10,4):4 (12,4):3 (11,5):3 (9,1):1 (10,0):2 (9,3):1 (9,5):1 (10,6):1 (13,3):1 (13,1):1 (12,0):2
timing for divide=1.2e-04
timing for compute=8.8e-05
timing for collect=2.0e-05
----- TMING FOR decimation_genbasis(su2): 2.3e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.2e-04,7.8e-05,0.0e+00,1.0e-05,2.0e-05 -----
decimation summary: 39->10 dwt=+0.000e+00 SvN=9.510e-01
 qbond: qkept nsym=8 dimAll=10
 (12,2):2 (12,4):2 (11,1):1 (11,3):1 (11,5):1 (13,3):1 (13,1):1 (12,0):1
----- TIMING for decimation_row(nkr): 7.619e-04 S T(decim/select/formRot)=3.526e-04,2.450e-04,1.643e-04 -----
----- TIMING FOR twodot_decimation: 1.419e-03 S T(wf/decim)=6.356e-04,7.837e-04 -----
ctns::oper_renorm coord=(7,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:8 S:7 A:31 B:36 
        dim(bra,ket)=10,10 size(op)=31:2.365e-04MB size(tot)=1168:8.911e-03MB:8.702e-06GB
        per(mem): H:1.2 C:11 S:9.59 A:8.9 B:69.3 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.045e-03 change=3.774e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=76 : 5.623e-04 S -----
rank=0 GPUmem(GB): used=4.801e-05 (oper)=2.294e-05
rank=0 GPUmem(GB): used=4.825e-05 (oper,site)=2.294e-05,2.384e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=76
 no. of rintermediate operators=5
 no. of coefficients=67:5.112e-04MB:4.992e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.483e-03 S -----
rank=0 GPUmem(GB): used=4.875e-05 (oper,site,rinter)=2.294e-05,2.384e-07,4.992e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 2.127e-02 S size(rtasks)=76 size(Rlst2)=64 T(Rmu/Rlist)=1.740e-04,2.110e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.144e-02 S size(rtasks)=76 size(Rlst)=1644 -----
rank=0 GPUmem(GB): used=4.875e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.592e-04 blksize=4 blksize0=4 batchsize=1644
rank=0 GPUmem(GB): used=2.080e-04 (oper,site,rinter,batch)=2.294e-05,2.384e-07,4.992e-07,1.592e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.515e-03,2.216e-02,9.914e-03
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=100 t=6.5e-03 per=1.7e+01 cost=7.3e+03 flops=1.1e+06
 renorm[gemm] counter=100 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=100 i=1 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=100 i=2 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=100 i=3 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=100 i=4 t=7.4e-03 per=1.9e+01 cost=6.1e+02 flops=8.3e+04
 renorm[gemm] counter=100 i=5 t=7.4e-03 per=1.9e+01 cost=7.2e+03 flops=9.8e+05
 renorm[gemm] counter=100 i=6 t=7.4e-03 per=1.9e+01 cost=7.6e+03 flops=1.0e+06
 renorm[gemm] counter=100 total t=2.2e-02 per=5.7e+01 cost=1.5e+04 flops=7.0e+05
 renorm[red] counter=100 t=9.9e-03 per=2.6e+01 cost=5.8e+03 flops=5.9e+05
----- TIMING FOR renorm_tot : t_inter=4.5e-02 t_gemm=1.6e-01 t_reduction=7.0e-02 tot=2.7e-01 -----
 renorm_tot[inter] counter=100 t=4.5e-02 per=1.6e+01 cost=1.6e+04 flops=3.7e+05
 renorm_tot[gemm] counter=100 i=0 t=9.5e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=100 i=1 t=8.0e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=100 i=2 t=7.8e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=100 i=3 t=7.8e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=100 i=4 t=5.2e-02 per=1.9e+01 cost=1.8e+03 flops=3.5e+04
 renorm_tot[gemm] counter=100 i=5 t=5.2e-02 per=1.9e+01 cost=1.7e+04 flops=3.3e+05
 renorm_tot[gemm] counter=100 i=6 t=5.3e-02 per=1.9e+01 cost=2.0e+04 flops=3.8e+05
 renorm_tot[gemm] counter=100 total t=1.6e-01 per=5.8e+01 cost=3.9e+04 flops=2.5e+05
 renorm_tot[red] counter=100 t=7.0e-02 per=2.6e+01 cost=1.5e+04 flops=2.2e+05
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=5.679e-05 (optmp,oper)=1.192e-07,2.294e-05
rank=0 GPUmem(GB): used=5.703e-05 (optmp,oper,site,rinter)=1.192e-07,2.294e-05,2.384e-07,8.158e-06
rank=0 GPUmem(GB): used=7.107e-05 (optmp,oper,site,rinter,batch)=1.192e-07,2.294e-05,2.384e-07,8.158e-06,1.404e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 5.791e-01 S T(prep/alloc/comp/red/dealloc)=2.951e-02,3.844e-02,4.788e-01,5.923e-02,2.518e-03 -----
----- TIMING FOR oper_renorm_opS : 5.792e-01 S rank=0 -----
qops.to_cpu: size(tot)=1168:8.911e-03MB:8.702e-06GB T(to_cpu)=1.289e-04S speed=6.750e-02GB/S
check ||H-H.dagger||=1.271e-16 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.661 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=1.045e-03 change=4.295e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.984e-03 change=-1.606e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.984e-03 change=-7.480e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.698e+00 S #####
 T(local opt: fetch) = 1.085e-02 S  per = 0.639  per(accum) = 0.639
 T(local opt: hdiag) = 4.716e-01 S  per = 27.8  per(accum) = 28.4
 T(local opt: dvdsn) = 5.490e-01 S  per = 32.3  per(accum) = 60.7
 T(local opt: decim) = 1.566e-03 S  per = 0.0922  per(accum) = 60.8
 T(local opt: guess) = 1.128e-03 S  per = 0.0665  per(accum) = 60.9
 T(local opt: renrm) = 6.638e-01 S  per = 39.1  per(accum) = 100
 T(local opt: save ) = 2.482e-04 S  per = 0.0146  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.490e-01 S  T(sum) = 5.485e-01 S  per = 9.992e+01
 T(local opt: preprocess                  ) = 5.511e-03 S  per =    1  per(accum) = 1
 T(local opt: symbolic_formulae           ) = 5.260e-03 S  per = 0.959  per(accum) = 1.96
 T(local opt: hintermediate init          ) = 2.271e-04 S  per = 0.0414  per(accum) = 2.01
 T(local opt: preprocess_hformulae_Hxlist ) = 1.431e-01 S  per = 26.1  per(accum) = 28.1
 T(local opt: hmmtasks init               ) = 3.686e-02 S  per = 6.72  per(accum) = 34.8
 T(local opt: initial guess for dvdson    ) = 1.448e-03 S  per = 0.264  per(accum) = 35.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.833e-01 S  per = 51.7  per(accum) = 86.7
 T(local opt: dvdson [cpu-gpu]            ) = 1.211e-02 S  per = 2.21  per(accum) = 88.9
 T(local opt: dvdson [nccl]               ) = 5.990e-02 S  per = 10.9  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 1.492e-06 S  per = 0.000272  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 8.060e-04 S  per = 0.147  per(accum) = 100
Detailed decomposition of T(renrm) = 6.638e-01 S  T(sum) = 6.638e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.175e-04 S  per = 0.0779  per(accum) = 0.0779
 T(local opt: qops init                    ) = 5.682e-03 S  per = 0.856  per(accum) = 0.934
 T(local opt: symbolic_formulae_renorm     ) = 5.745e-04 S  per = 0.0865  per(accum) = 1.02
 T(local opt: allocate qops on gpu         ) = 8.859e-05 S  per = 0.0133  per(accum) = 1.03
 T(local opt: site memcpy cpu2gpu          ) = 6.520e-04 S  per = 0.0982  per(accum) = 1.13
 T(local opt: rintermediate init           ) = 2.497e-03 S  per = 0.376  per(accum) = 1.51
 T(local opt: preprocess_formulae_Rlist2   ) = 2.150e-02 S  per = 3.24  per(accum) = 4.75
 T(local opt: rmmtasks init                ) = 9.313e-03 S  per =  1.4  per(accum) = 6.15
 T(local opt: qops memset on cpu           ) = 4.600e-08 S  per = 6.93e-06  per(accum) = 6.15
 T(local opt: preprocess_renorm_batchGPU   ) = 3.876e-02 S  per = 5.84  per(accum) = 12
 T(local opt: deallocate cpu and gpu memory) = 9.835e-05 S  per = 0.0148  per(accum) = 12
 T(local opt: construct opS [ifdists=true] ) = 5.793e-01 S  per = 87.3  per(accum) = 99.3
 T(local opt: reduction of opS & opH [nccl]) = 2.200e-03 S  per = 0.331  per(accum) = 99.6
 T(local opt: qops memcpy gpu2cpu          ) = 1.414e-04 S  per = 0.0213  per(accum) = 99.6
 T(local opt: reduction of opS & opH [mpi] ) = 1.198e-04 S  per = 0.018  per(accum) = 99.6
 T(local opt: qops_pool join and erase     ) = 2.404e-03 S  per = 0.362  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.460e-05 S  per = 0.0022  per(accum) = 100
##### sweep opt: 8.675e+00 S #####
 T(sweep opt: fetch) = 9.719e-02 S  per = 1.12  per(accum) = 1.12
 T(sweep opt: hdiag) = 1.387e+00 S  per =   16  per(accum) = 17.1
 T(sweep opt: dvdsn) = 2.081e+00 S  per =   24  per(accum) = 41.1
 T(sweep opt: decim) = 7.451e-03 S  per = 0.0859  per(accum) = 41.2
 T(sweep opt: guess) = 5.022e-03 S  per = 0.0579  per(accum) = 41.2
 T(sweep opt: renrm) = 5.095e+00 S  per = 58.7  per(accum) = 100
 T(sweep opt: save ) = 1.421e-03 S  per = 0.0164  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.081e+00 S  T(sum) = 2.079e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 2.170e-02 S  per = 1.04  per(accum) = 1.04
 T(sweep opt: symbolic_formulae           ) = 2.008e-02 S  per = 0.966  per(accum) = 2.01
 T(sweep opt: hintermediate init          ) = 1.163e-03 S  per = 0.0559  per(accum) = 2.07
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.734e-01 S  per =   18  per(accum) = 20
 T(sweep opt: hmmtasks init               ) = 9.070e-02 S  per = 4.36  per(accum) = 24.4
 T(sweep opt: initial guess for dvdson    ) = 5.961e-03 S  per = 0.287  per(accum) = 24.7
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.294e+00 S  per = 62.2  per(accum) = 86.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 5.105e-02 S  per = 2.46  per(accum) = 89.3
 T(sweep opt: dvdson [nccl]               ) = 2.188e-01 S  per = 10.5  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 8.058e-06 S  per = 0.000388  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.882e-03 S  per = 0.139  per(accum) = 100
Detailed decomposition of T(renrm) = 5.095e+00 S  T(sum) = 5.095e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.855e-03 S  per = 0.0364  per(accum) = 0.0364
 T(sweep opt: qops init                    ) = 1.632e-02 S  per = 0.32  per(accum) = 0.357
 T(sweep opt: symbolic_formulae_renorm     ) = 2.309e-03 S  per = 0.0453  per(accum) = 0.402
 T(sweep opt: allocate qops on gpu         ) = 4.829e-04 S  per = 0.00948  per(accum) = 0.412
 T(sweep opt: site memcpy cpu2gpu          ) = 9.422e-03 S  per = 0.185  per(accum) = 0.596
 T(sweep opt: rintermediate init           ) = 1.497e-02 S  per = 0.294  per(accum) = 0.89
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.637e-02 S  per = 1.11  per(accum) = 2
 T(sweep opt: rmmtasks init                ) = 2.429e-02 S  per = 0.477  per(accum) = 2.47
 T(sweep opt: qops memset on cpu           ) = 2.850e-07 S  per = 5.59e-06  per(accum) = 2.47
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.736e-01 S  per = 5.37  per(accum) = 7.84
 T(sweep opt: deallocate cpu and gpu memory) = 3.089e-04 S  per = 0.00606  per(accum) = 7.85
 T(sweep opt: construct opS [ifdists=true] ) = 4.666e+00 S  per = 91.6  per(accum) = 99.4
 T(sweep opt: reduction of opS & opH [nccl]) = 1.552e-02 S  per = 0.305  per(accum) = 99.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.780e-04 S  per = 0.0133  per(accum) = 99.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.107e-04 S  per = 0.01  per(accum) = 99.8
 T(sweep opt: qops_pool join and erase     ) = 1.260e-02 S  per = 0.247  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 5.220e-05 S  per = 0.00102  per(accum) = 100
##### global opt: 8.675e+00 S #####
 T(global opt: fetch) = 9.719e-02 S  per = 1.12  per(accum) = 1.12
 T(global opt: hdiag) = 1.387e+00 S  per =   16  per(accum) = 17.1
 T(global opt: dvdsn) = 2.081e+00 S  per =   24  per(accum) = 41.1
 T(global opt: decim) = 7.451e-03 S  per = 0.0859  per(accum) = 41.2
 T(global opt: guess) = 5.022e-03 S  per = 0.0579  per(accum) = 41.2
 T(global opt: renrm) = 5.095e+00 S  per = 58.7  per(accum) = 100
 T(global opt: save ) = 1.421e-03 S  per = 0.0164  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.081e+00 S  T(sum) = 2.079e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 2.170e-02 S  per = 1.04  per(accum) = 1.04
 T(global opt: symbolic_formulae           ) = 2.008e-02 S  per = 0.966  per(accum) = 2.01
 T(global opt: hintermediate init          ) = 1.163e-03 S  per = 0.0559  per(accum) = 2.07
 T(global opt: preprocess_hformulae_Hxlist ) = 3.734e-01 S  per =   18  per(accum) = 20
 T(global opt: hmmtasks init               ) = 9.070e-02 S  per = 4.36  per(accum) = 24.4
 T(global opt: initial guess for dvdson    ) = 5.961e-03 S  per = 0.287  per(accum) = 24.7
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.294e+00 S  per = 62.2  per(accum) = 86.9
 T(global opt: dvdson [cpu-gpu]            ) = 5.105e-02 S  per = 2.46  per(accum) = 89.3
 T(global opt: dvdson [nccl]               ) = 2.188e-01 S  per = 10.5  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 8.058e-06 S  per = 0.000388  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 2.882e-03 S  per = 0.139  per(accum) = 100
Detailed decomposition of T(renrm) = 5.095e+00 S  T(sum) = 5.095e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.855e-03 S  per = 0.0364  per(accum) = 0.0364
 T(global opt: qops init                    ) = 1.632e-02 S  per = 0.32  per(accum) = 0.357
 T(global opt: symbolic_formulae_renorm     ) = 2.309e-03 S  per = 0.0453  per(accum) = 0.402
 T(global opt: allocate qops on gpu         ) = 4.829e-04 S  per = 0.00948  per(accum) = 0.412
 T(global opt: site memcpy cpu2gpu          ) = 9.422e-03 S  per = 0.185  per(accum) = 0.596
 T(global opt: rintermediate init           ) = 1.497e-02 S  per = 0.294  per(accum) = 0.89
 T(global opt: preprocess_formulae_Rlist2   ) = 5.637e-02 S  per = 1.11  per(accum) = 2
 T(global opt: rmmtasks init                ) = 2.429e-02 S  per = 0.477  per(accum) = 2.47
 T(global opt: qops memset on cpu           ) = 2.850e-07 S  per = 5.59e-06  per(accum) = 2.47
 T(global opt: preprocess_renorm_batchGPU   ) = 2.736e-01 S  per = 5.37  per(accum) = 7.84
 T(global opt: deallocate cpu and gpu memory) = 3.089e-04 S  per = 0.00606  per(accum) = 7.85
 T(global opt: construct opS [ifdists=true] ) = 4.666e+00 S  per = 91.6  per(accum) = 99.4
 T(global opt: reduction of opS & opH [nccl]) = 1.552e-02 S  per = 0.305  per(accum) = 99.7
 T(global opt: qops memcpy gpu2cpu          ) = 6.780e-04 S  per = 0.0133  per(accum) = 99.7
 T(global opt: reduction of opS & opH [mpi] ) = 5.107e-04 S  per = 0.01  per(accum) = 99.8
 T(global opt: qops_pool join and erase     ) = 1.260e-02 S  per = 0.247  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 5.220e-05 S  per = 0.00102  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.951e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=7/seqsize=34 dots=2 dbond=(8,0)-(9,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=167:1.274e-03MB:1.244e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=14:1.068e-04MB:1.043e-07GB
total mem of comb=182:1.389e-03MB:1.356e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=8,10,1,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc1= 19
 suppc2= 5
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:8 S:7 A:31 B:36 
        dim(bra,ket)=10,10 size(op)=31:2.365e-04MB size(tot)=1168:8.911e-03MB:8.702e-06GB
        per(mem): H:1.2 C:11 S:9.59 A:8.9 B:69.3 
 rqops: oplist=HCSPQ nops=H:1 C:10 S:5 P:49 Q:56 
        dim(bra,ket)=5,5 size(op)=11:8.39e-05MB size(tot)=513:0.00391MB:3.82e-06GB
        per(mem): H:0.975 C:7.8 S:3.9 P:0 Q:87.3 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3677:0.0281MB:2.74e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.044e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(8,0) fdel=./scratch/sweep/rop(9,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-3.874e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,5,3,3) nnz=67:5.112e-04MB
qtensor4: wf4 own=1 _data=0x46c69b00
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=8 dimAll=10
 (12,2):2 (12,4):2 (11,1):1 (11,3):1 (11,5):1 (13,3):1 (13,1):1 (12,0):1
 qbond: qcol nsym=5 dimAll=5
 (15,1):1 (15,3):1 (15,5):1 (16,2):1 (16,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=49 nblocks=620 size=67:5.112e-04MB
### DIAG TIMING: total=5.303e-01 t1=2.694e-05, t2=6.749e-04, t3=2.506e-03, t4=5.245e-01, t5=4.330e-06, t6=2.516e-03, t7=4.345e-06
duration_diagGPU:5.303e-01
duration_diagreduce:7.100e-08
duration_diagtransform:5.170e-07
----- TIMING FOR symbolic_formulae_twodot with size=452 : 6.157e-03 S -----
rank=0 GPUmem(GB): used=2.740e-05 (oper)=2.740e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=452
 no. of hintermediate operators=227
 no. of coefficients=2776:2.118e-02MB:2.068e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.662e-04 S -----
rank=0 GPUmem(GB): used=4.808e-05 (oper,hinter)=2.740e-05,2.068e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.547e-01 S size(H_formulae)=452 size(Hxlst2)=49 T(Hmu/Hxlist)=1.222e-03,5.535e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.591e-01 S size(H_formulae)=452 size(Hxlst)=32486 -----
rank=0 GPUmem(GB): used=4.808e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=9.984e-07 batch[need]=2.178e-03 blksize=2 blksize0=4 batchsize=32486
rank=0 GPUmem(GB): used=2.227e-03 (oper,hinter,dvdson,batch)=2.740e-05,2.068e-05,9.984e-07,2.178e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=67 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.226e-02,2.540e-03,1.033e-02,6.456e-03,3.162e-02
 analyze_tgpu[Hx]: ndim=67:4.992e-07GB T(cpu-gpu)=1.841e-03 speed=5.422e-04GB/S T(nccl)=1.042e-02 speed=9.581e-05GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=6.5e-03 tot=1.9e-02 -----
 sigma[inter] counter=28 t=2.5e-03 per=1.3e+01 cost=5.5e+05 flops=2.2e+08
 sigma[gemm] counter=28 i=0 t=1.6e-06 per=8.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=1 t=1.3e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=2 t=1.1e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=3 t=1.1e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=4 t=2.5e-03 per=1.3e+01 cost=3.7e+04 flops=1.4e+07
 sigma[gemm] counter=28 i=5 t=2.6e-03 per=1.3e+01 cost=3.6e+04 flops=1.4e+07
 sigma[gemm] counter=28 i=6 t=2.6e-03 per=1.3e+01 cost=6.4e+04 flops=2.5e+07
 sigma[gemm] counter=28 i=7 t=2.6e-03 per=1.3e+01 cost=6.4e+04 flops=2.5e+07
 sigma[gemm] counter=28 total t=1.0e-02 per=5.3e+01 cost=2.0e+05 flops=2.0e+07
 sigma[red] counter=28 t=6.5e-03 per=3.3e+01 cost=9.1e+04 flops=1.4e+07
----- TIMING FOR sigma_tot : t_inter=1.8e-01 t_gemm=7.9e-01 t_reduction=3.3e-01 tot=1.3e+00 -----
 sigma_tot[inter] counter=28 t=1.8e-01 per=1.4e+01 cost=7.7e+05 flops=4.2e+06
 sigma_tot[gemm] counter=28 i=0 t=3.8e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=1 t=3.3e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=2 t=3.2e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=3 t=3.2e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=4 t=2.0e-01 per=1.5e+01 cost=1.1e+05 flops=5.2e+05
 sigma_tot[gemm] counter=28 i=5 t=2.0e-01 per=1.6e+01 cost=1.1e+05 flops=5.3e+05
 sigma_tot[gemm] counter=28 i=6 t=1.9e-01 per=1.5e+01 cost=2.1e+05 flops=1.1e+06
 sigma_tot[gemm] counter=28 i=7 t=1.9e-01 per=1.5e+01 cost=2.1e+05 flops=1.1e+06
 sigma_tot[gemm] counter=28 total t=7.9e-01 per=6.1e+01 cost=6.4e+05 flops=8.1e+05
 sigma_tot[red] counter=28 t=3.3e-01 per=2.5e+01 cost=3.2e+05 flops=9.6e+05
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=9.1e-06,1.3e-05,2.7e-06,9.3e-07,2.3e-07
settings: ndim=67 neig=1 maxcycle=30 nbuff=4 memory=7e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.155574600123 -1.116e+03  1.837e-02    1     1  3.185e-02 3.185e-02 3.178e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.594e-02,2.748e-03,5.929e-03,3.018e-03,2.765e-02
 analyze_tgpu[Hx]: ndim=67:4.992e-07GB T(cpu-gpu)=2.512e-04 speed=3.974e-03GB/S T(nccl)=1.569e-02 speed=6.362e-05GB/S
----- TIMING FOR sigma : t_inter=2.7e-03 t_gemm=5.9e-03 t_reduction=3.0e-03 tot=1.2e-02 -----
 sigma[inter] counter=29 t=2.7e-03 per=2.3e+01 cost=5.5e+05 flops=2.0e+08
 sigma[gemm] counter=29 i=0 t=1.6e-06 per=1.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=1 t=1.4e-06 per=1.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=2 t=1.3e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=3 t=1.3e-06 per=1.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=4 t=1.9e-03 per=1.6e+01 cost=3.7e+04 flops=1.9e+07
 sigma[gemm] counter=29 i=5 t=6.0e-04 per=5.1e+00 cost=3.6e+04 flops=6.1e+07
 sigma[gemm] counter=29 i=6 t=9.1e-04 per=7.8e+00 cost=6.4e+04 flops=7.1e+07
 sigma[gemm] counter=29 i=7 t=2.5e-03 per=2.2e+01 cost=6.4e+04 flops=2.5e+07
 sigma[gemm] counter=29 total t=5.9e-03 per=5.1e+01 cost=2.0e+05 flops=3.4e+07
 sigma[red] counter=29 t=3.0e-03 per=2.6e+01 cost=9.1e+04 flops=3.0e+07
----- TIMING FOR sigma_tot : t_inter=1.9e-01 t_gemm=8.0e-01 t_reduction=3.3e-01 tot=1.3e+00 -----
 sigma_tot[inter] counter=29 t=1.9e-01 per=1.4e+01 cost=1.3e+06 flops=7.1e+06
 sigma_tot[gemm] counter=29 i=0 t=3.9e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=1 t=3.5e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=2 t=3.4e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=3 t=3.4e-05 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=4 t=2.0e-01 per=1.5e+01 cost=1.4e+05 flops=6.9e+05
 sigma_tot[gemm] counter=29 i=5 t=2.0e-01 per=1.5e+01 cost=1.5e+05 flops=7.1e+05
 sigma_tot[gemm] counter=29 i=6 t=2.0e-01 per=1.5e+01 cost=2.8e+05 flops=1.4e+06
 sigma_tot[gemm] counter=29 i=7 t=2.0e-01 per=1.5e+01 cost=2.8e+05 flops=1.4e+06
 sigma_tot[gemm] counter=29 total t=8.0e-01 per=6.1e+01 cost=8.4e+05 flops=1.1e+06
 sigma_tot[red] counter=29 t=3.3e-01 per=2.5e+01 cost=4.1e+05 flops=1.2e+06
T(sub)=7.9e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,5.3e-05,4.1e-06,1.7e-06,2.2e-07
    2   0 -    -116.157037746981 -1.463e-03  9.746e-03    2     2  5.992e-02 2.996e-02 2.981e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.852e-03,7.545e-04,8.161e-03,1.101e-02,2.879e-02
 analyze_tgpu[Hx]: ndim=67:4.992e-07GB T(cpu-gpu)=4.886e-04 speed=2.043e-03GB/S T(nccl)=8.364e-03 speed=1.194e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-04 t_gemm=8.2e-03 t_reduction=1.1e-02 tot=2.0e-02 -----
 sigma[inter] counter=30 t=7.5e-04 per=3.8e+00 cost=5.5e+05 flops=7.3e+08
 sigma[gemm] counter=30 i=0 t=1.6e-06 per=7.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=1 t=1.4e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=2 t=1.3e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=3 t=1.3e-06 per=6.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=4 t=6.7e-04 per=3.4e+00 cost=3.7e+04 flops=5.5e+07
 sigma[gemm] counter=30 i=5 t=2.5e-03 per=1.2e+01 cost=3.6e+04 flops=1.5e+07
 sigma[gemm] counter=30 i=6 t=2.5e-03 per=1.2e+01 cost=6.4e+04 flops=2.6e+07
 sigma[gemm] counter=30 i=7 t=2.5e-03 per=1.3e+01 cost=6.4e+04 flops=2.5e+07
 sigma[gemm] counter=30 total t=8.2e-03 per=4.1e+01 cost=2.0e+05 flops=2.5e+07
 sigma[red] counter=30 t=1.1e-02 per=5.5e+01 cost=9.1e+04 flops=8.3e+06
----- TIMING FOR sigma_tot : t_inter=1.9e-01 t_gemm=8.1e-01 t_reduction=3.4e-01 tot=1.3e+00 -----
 sigma_tot[inter] counter=30 t=1.9e-01 per=1.4e+01 cost=1.9e+06 flops=1.0e+07
 sigma_tot[gemm] counter=30 i=0 t=4.1e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=1 t=3.6e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=2 t=3.5e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=3 t=3.5e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=4 t=2.1e-01 per=1.5e+01 cost=1.8e+05 flops=8.7e+05
 sigma_tot[gemm] counter=30 i=5 t=2.1e-01 per=1.5e+01 cost=1.8e+05 flops=8.8e+05
 sigma_tot[gemm] counter=30 i=6 t=2.0e-01 per=1.5e+01 cost=3.4e+05 flops=1.7e+06
 sigma_tot[gemm] counter=30 i=7 t=2.0e-01 per=1.5e+01 cost=3.4e+05 flops=1.7e+06
 sigma_tot[gemm] counter=30 total t=8.1e-01 per=6.0e+01 cost=1.0e+06 flops=1.3e+06
 sigma_tot[red] counter=30 t=3.4e-01 per=2.6e+01 cost=5.0e+05 flops=1.4e+06
T(sub)=5.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.5e-06,4.2e-05,3.2e-06,1.4e-06,2.0e-07
    3   0 -    -116.157351288886 -3.135e-04  4.519e-03    3     3  8.905e-02 2.968e-02 2.955e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.080e-03,2.491e-03,9.972e-03,1.093e-02,3.048e-02
 analyze_tgpu[Hx]: ndim=67:4.992e-07GB T(cpu-gpu)=2.147e-03 speed=4.651e-04GB/S T(nccl)=4.933e-03 speed=2.024e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=31 t=2.5e-03 per=1.1e+01 cost=5.5e+05 flops=2.2e+08
 sigma[gemm] counter=31 i=0 t=1.3e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=1 t=1.2e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=2 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=3 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=4 t=2.5e-03 per=1.1e+01 cost=3.7e+04 flops=1.5e+07
 sigma[gemm] counter=31 i=5 t=2.5e-03 per=1.1e+01 cost=3.6e+04 flops=1.5e+07
 sigma[gemm] counter=31 i=6 t=2.5e-03 per=1.1e+01 cost=6.4e+04 flops=2.6e+07
 sigma[gemm] counter=31 i=7 t=2.5e-03 per=1.1e+01 cost=6.4e+04 flops=2.6e+07
 sigma[gemm] counter=31 total t=1.0e-02 per=4.3e+01 cost=2.0e+05 flops=2.0e+07
 sigma[red] counter=31 t=1.1e-02 per=4.7e+01 cost=9.1e+04 flops=8.4e+06
----- TIMING FOR sigma_tot : t_inter=1.9e-01 t_gemm=8.2e-01 t_reduction=3.6e-01 tot=1.4e+00 -----
 sigma_tot[inter] counter=31 t=1.9e-01 per=1.4e+01 cost=2.4e+06 flops=1.3e+07
 sigma_tot[gemm] counter=31 i=0 t=4.2e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=1 t=3.7e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=2 t=3.6e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=3 t=3.6e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=4 t=2.1e-01 per=1.5e+01 cost=2.1e+05 flops=1.0e+06
 sigma_tot[gemm] counter=31 i=5 t=2.1e-01 per=1.5e+01 cost=2.2e+05 flops=1.0e+06
 sigma_tot[gemm] counter=31 i=6 t=2.0e-01 per=1.5e+01 cost=4.1e+05 flops=2.0e+06
 sigma_tot[gemm] counter=31 i=7 t=2.0e-01 per=1.5e+01 cost=4.1e+05 flops=2.0e+06
 sigma_tot[gemm] counter=31 total t=8.2e-01 per=6.0e+01 cost=1.2e+06 flops=1.5e+06
 sigma_tot[red] counter=31 t=3.6e-01 per=2.6e+01 cost=5.9e+05 flops=1.7e+06
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.7e-05,3.2e-06,1.2e-06,2.0e-07
    4   0 -    -116.157409910164 -5.862e-05  1.245e-03    3     4  1.198e-01 2.995e-02 2.983e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.385e-03,2.527e-03,9.908e-03,1.092e-02,3.075e-02
 analyze_tgpu[Hx]: ndim=67:4.992e-07GB T(cpu-gpu)=2.182e-03 speed=4.576e-04GB/S T(nccl)=5.203e-03 speed=1.919e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=9.9e-03 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=32 t=2.5e-03 per=1.1e+01 cost=5.5e+05 flops=2.2e+08
 sigma[gemm] counter=32 i=0 t=1.3e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=1 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=2 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=3 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=4 t=2.5e-03 per=1.1e+01 cost=3.7e+04 flops=1.5e+07
 sigma[gemm] counter=32 i=5 t=2.5e-03 per=1.1e+01 cost=3.6e+04 flops=1.5e+07
 sigma[gemm] counter=32 i=6 t=2.5e-03 per=1.1e+01 cost=6.4e+04 flops=2.6e+07
 sigma[gemm] counter=32 i=7 t=2.5e-03 per=1.1e+01 cost=6.4e+04 flops=2.6e+07
 sigma[gemm] counter=32 total t=9.9e-03 per=4.2e+01 cost=2.0e+05 flops=2.0e+07
 sigma[red] counter=32 t=1.1e-02 per=4.7e+01 cost=9.1e+04 flops=8.4e+06
----- TIMING FOR sigma_tot : t_inter=1.9e-01 t_gemm=8.3e-01 t_reduction=3.7e-01 tot=1.4e+00 -----
 sigma_tot[inter] counter=32 t=1.9e-01 per=1.4e+01 cost=3.0e+06 flops=1.6e+07
 sigma_tot[gemm] counter=32 i=0 t=4.4e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=1 t=3.8e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=2 t=3.7e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=3 t=3.7e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=4 t=2.1e-01 per=1.5e+01 cost=2.5e+05 flops=1.2e+06
 sigma_tot[gemm] counter=32 i=5 t=2.1e-01 per=1.5e+01 cost=2.5e+05 flops=1.2e+06
 sigma_tot[gemm] counter=32 i=6 t=2.0e-01 per=1.5e+01 cost=4.7e+05 flops=2.3e+06
 sigma_tot[gemm] counter=32 i=7 t=2.0e-01 per=1.5e+01 cost=4.7e+05 flops=2.3e+06
 sigma_tot[gemm] counter=32 total t=8.3e-01 per=6.0e+01 cost=1.4e+06 flops=1.7e+06
 sigma_tot[red] counter=32 t=3.7e-01 per=2.6e+01 cost=6.8e+05 flops=1.9e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.5e-05,3.3e-06,1.2e-06,2.5e-07
    5   0 -    -116.157413575181 -3.665e-06  2.957e-04    3     5  1.509e-01 3.017e-02 3.005e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.404e-03,2.536e-03,9.996e-03,1.090e-02,3.185e-02
 analyze_tgpu[Hx]: ndim=67:4.992e-07GB T(cpu-gpu)=2.230e-03 speed=4.478e-04GB/S T(nccl)=6.174e-03 speed=1.617e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=33 t=2.5e-03 per=1.1e+01 cost=5.5e+05 flops=2.2e+08
 sigma[gemm] counter=33 i=0 t=1.3e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=1 t=1.2e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=2 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=3 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=4 t=2.5e-03 per=1.1e+01 cost=3.7e+04 flops=1.5e+07
 sigma[gemm] counter=33 i=5 t=2.5e-03 per=1.1e+01 cost=3.6e+04 flops=1.4e+07
 sigma[gemm] counter=33 i=6 t=2.5e-03 per=1.1e+01 cost=6.4e+04 flops=2.6e+07
 sigma[gemm] counter=33 i=7 t=2.5e-03 per=1.1e+01 cost=6.4e+04 flops=2.6e+07
 sigma[gemm] counter=33 total t=1.0e-02 per=4.3e+01 cost=2.0e+05 flops=2.0e+07
 sigma[red] counter=33 t=1.1e-02 per=4.7e+01 cost=9.1e+04 flops=8.4e+06
----- TIMING FOR sigma_tot : t_inter=1.9e-01 t_gemm=8.4e-01 t_reduction=3.8e-01 tot=1.4e+00 -----
 sigma_tot[inter] counter=33 t=1.9e-01 per=1.4e+01 cost=3.5e+06 flops=1.8e+07
 sigma_tot[gemm] counter=33 i=0 t=4.5e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=1 t=4.0e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=2 t=3.8e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=3 t=3.8e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=4 t=2.1e-01 per=1.5e+01 cost=2.9e+05 flops=1.4e+06
 sigma_tot[gemm] counter=33 i=5 t=2.1e-01 per=1.5e+01 cost=2.9e+05 flops=1.4e+06
 sigma_tot[gemm] counter=33 i=6 t=2.1e-01 per=1.5e+01 cost=5.3e+05 flops=2.6e+06
 sigma_tot[gemm] counter=33 i=7 t=2.1e-01 per=1.5e+01 cost=5.3e+05 flops=2.6e+06
 sigma_tot[gemm] counter=33 total t=8.4e-01 per=5.9e+01 cost=1.6e+06 flops=2.0e+06
 sigma_tot[red] counter=33 t=3.8e-01 per=2.7e+01 cost=7.7e+05 flops=2.0e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.6e-05,3.0e-06,1.2e-06,2.1e-07
    6   0 +    -116.157413770085 -1.949e-07  5.235e-05    3     6  1.830e-01 3.049e-02 3.038e-02
TIMING FOR Davidson : 1.830e-01  T(cal/comm/rest)=1.823e-01,8.072e-06,6.866e-04
decomposed t_rest=6.866e-04
 T(sub)    =2.341e-04 per=3.410e+01
 T(precond)=6.789e-05 per=9.887e+00
 T(ortho)  =1.290e-05 per=1.879e+00
 T(xcopy)  =9.450e-07 per=1.376e-01
 T(xnrm2)  =2.889e-06 per=4.207e-01
 T(other)  =3.679e-04 per=5.358e+01
optimized energies: isweep=0 ibond=7 dots=2 e[0]=-116.157413770085 nmvp=6
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.419e-02 change=7.787e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=15 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond7.txt
 qbond: qsuper nsym=15 dimAll=39
 (12,2):4 (14,2):4 (13,1):5 (13,3):6 (12,4):4 (14,4):3 (13,5):3 (11,1):1 (12,0):2 (11,3):1 (11,5):1 (12,6):1 (15,3):1 (15,1):1 (14,0):2
timing for divide=1.8e-04
timing for compute=2.2e-04
timing for collect=2.8e-05
----- TMING FOR decimation_genbasis(su2): 4.3e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.8e-04,2.1e-04,0.0e+00,1.3e-05,2.8e-05 -----
decimation summary: 39->10 dwt=+2.342e-05 SvN=6.599e-01
 qbond: qkept nsym=7 dimAll=10
 (14,2):2 (13,1):2 (13,3):2 (12,2):1 (14,4):1 (13,5):1 (14,0):1
----- TIMING for decimation_row(nkr): 9.848e-04 S T(decim/select/formRot)=5.095e-04,3.186e-04,1.567e-04 -----
----- TIMING FOR twodot_decimation: 2.066e-03 S T(wf/decim)=1.060e-03,1.006e-03 -----
ctns::oper_renorm coord=(8,0) superblock=lc oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:9 S:6 A:40 B:46 
        dim(bra,ket)=10,10 size(op)=35:2.670e-04MB size(tot)=1560:1.190e-02MB:1.162e-05GB
        per(mem): H:1.03 C:9.81 S:6.54 A:7.44 B:75.2 
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.401e-02 change=3.763e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=96 : 7.128e-04 S -----
rank=0 GPUmem(GB): used=5.588e-05 (oper)=2.776e-05
rank=0 GPUmem(GB): used=5.619e-05 (oper,site)=2.776e-05,3.129e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=96
 no. of rintermediate operators=5
 no. of coefficients=89:6.790e-04MB:6.631e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.450e-03 S -----
rank=0 GPUmem(GB): used=5.686e-05 (oper,site,rinter)=2.776e-05,3.129e-07,6.631e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 2.796e-02 S size(rtasks)=96 size(Rlst2)=49 T(Rmu/Rlist)=2.413e-04,2.772e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.817e-02 S size(rtasks)=96 size(Rlst)=2250 -----
rank=0 GPUmem(GB): used=5.686e-05 avail=6.231e+00 total=6.231e+00 batch[need]=2.179e-04 blksize=4 blksize0=4 batchsize=2250
rank=0 GPUmem(GB): used=2.748e-04 (oper,site,rinter,batch)=2.776e-05,3.129e-07,6.631e-07,2.179e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.290e-03,2.226e-02,9.952e-03
----- TIMING FOR renorm : t_inter=6.3e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=113 t=6.3e-03 per=1.6e+01 cost=1.1e+04 flops=1.7e+06
 renorm[gemm] counter=113 i=0 t=1.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=113 i=1 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=113 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=113 i=3 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=113 i=4 t=7.4e-03 per=1.9e+01 cost=9.8e+02 flops=1.3e+05
 renorm[gemm] counter=113 i=5 t=7.4e-03 per=1.9e+01 cost=1.3e+04 flops=1.7e+06
 renorm[gemm] counter=113 i=6 t=7.4e-03 per=1.9e+01 cost=1.7e+04 flops=2.2e+06
 renorm[gemm] counter=113 total t=2.2e-02 per=5.8e+01 cost=3.1e+04 flops=1.4e+06
 renorm[red] counter=113 t=1.0e-02 per=2.6e+01 cost=1.2e+04 flops=1.2e+06
----- TIMING FOR renorm_tot : t_inter=5.1e-02 t_gemm=1.8e-01 t_reduction=8.0e-02 tot=3.1e-01 -----
 renorm_tot[inter] counter=113 t=5.1e-02 per=1.6e+01 cost=2.7e+04 flops=5.3e+05
 renorm_tot[gemm] counter=113 i=0 t=1.1e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=113 i=1 t=9.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=113 i=2 t=8.9e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=113 i=3 t=8.9e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=113 i=4 t=6.0e-02 per=1.9e+01 cost=2.8e+03 flops=4.7e+04
 renorm_tot[gemm] counter=113 i=5 t=6.0e-02 per=1.9e+01 cost=3.0e+04 flops=5.0e+05
 renorm_tot[gemm] counter=113 i=6 t=6.0e-02 per=1.9e+01 cost=3.7e+04 flops=6.1e+05
 renorm_tot[gemm] counter=113 total t=1.8e-01 per=5.8e+01 cost=6.9e+04 flops=3.9e+05
 renorm_tot[red] counter=113 t=8.0e-02 per=2.6e+01 cost=2.7e+04 flops=3.4e+05
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=6.618e-05 (optmp,oper)=1.267e-07,2.776e-05
rank=0 GPUmem(GB): used=6.650e-05 (optmp,oper,site,rinter)=1.267e-07,2.776e-05,3.129e-07,9.514e-06
rank=0 GPUmem(GB): used=8.287e-05 (optmp,oper,site,rinter,batch)=1.267e-07,2.776e-05,3.129e-07,9.514e-06,1.637e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.824e-01 S T(prep/alloc/comp/red/dealloc)=2.707e-02,3.547e-02,4.124e-01,3.194e-02,2.496e-03 -----
----- TIMING FOR oper_renorm_opS : 4.825e-01 S rank=0 -----
----- TIMING FOR oper_renorm : 5.738e-01 S rank=0 -----
rank=0 CPUmem(GB): used=1.015e+00 pageheap_free=1.573e-02 change=5.760e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.767e-02 change=-1.952e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::oper_ab2pq coord=(8,0) superblock=lc alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=HCSPQ nops=H:1 C:9 S:6 P:59 Q:66 
        dim(bra,ket)=10,10 size(op)=35:2.670e-04MB size(tot)=2126:1.622e-02MB:1.584e-05GB
        per(mem): H:0.753 C:7.2 S:4.8 P:8.09 Q:79.2 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.759e-02 change=4.881e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.759e-02 change=7.600e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=5.558e-05 avail=6.231e+00 after qops2.allocate_gpu
ctns::oper_a2p ifab=0 ifkr=1 maxsize=118:8.792e-07GB
iproc=0
 qops_tmp: oplist=M nops=M:40 
        dim(bra,ket)=10,10 size(op)=4:3.052e-05MB size(tot)=116:8.850e-04MB:8.643e-07GB
        per(mem): M:100 
   init qops_tmp: dt=0.00185 tinit=0.00185
   from opA to opA.H(): dt=0.00661 tadjt=0.00661
   bcast: size(opM)=116:8.64e-07GB dt=0.00249 speed=0.000347GB/s tcomm=0.00249
   compute opP from opA: dt=0.00495 tcomp=0.00495
iproc=1
 qops_tmp: oplist=M nops=M:41 
        dim(bra,ket)=10,10 size(op)=4:3.05e-05MB size(tot)=118:0.0009MB:8.79e-07GB
        per(mem): M:100 
   init qops_tmp: dt=0.00186 tinit=0.00371
   from opA to opA.H(): dt=0.00746 tadjt=0.00746
   bcast: size(opM)=118:8.79e-07GB dt=0.00242 speed=0.000363GB/s tcomm=0.0129
   compute opP from opA: dt=0.00495 tcomp=0.00985
----- TIMING FOR oper_a2pGPU : 0.0345 S T(init/adjt+bcast/comp/rest)=0.0037,0.0203,0.01,0.000502 -----
ctns::oper_b2q ifab=0 ifkr=1 maxsize=1173:8.74e-06GB
rank=1 size=1173 iproc=0
iproc=0
 qops_tmp: oplist=B nops=B:46 
        dim(bra,ket)=10,10 size(op)=35:0.000267MB size(tot)=1173:0.00895MB:8.74e-06GB
        per(mem): B:100 
   init qops_tmp: dt=0.00228 tinit=0.00228
   copy opB to qops_tmps: dt=0.00208 tcopy=0.00208
rank=0 size=1173 iproc=0
   bcast: size(opB)=1173:8.74e-06GB dt=0.0025 speed=0.00349GB/s tcomm=0.0025
   compute opQ from opB: dt=0.00501 tcomp=0.00501
iproc=0
 qops_tmp: oplist=N nops=N:46 
        dim(bra,ket)=10,10 size(op)=35:0.000267MB size(tot)=1173:0.00895MB:8.74e-06GB
        per(mem): N:100 
   init qops_tmp: dt=0.00225 tinit=0.00452
   from opB to opB.H(): dt=0.00718 tadjt=0.00718
   bcast: size(opN)=1173:8.74e-06GB dt=0.00248 speed=0.00352GB/s tcomm=0.00499
   compute opQ from opB.H(): dt=0.00495 tcomp=0.00995
iproc=1
 qops_tmp: oplist=B nops=B:44 
        dim(bra,ket)=10,10 size(op)=35:0.000267MB size(tot)=1122:0.00856MB:8.36e-06GB
        per(mem): B:100 
   init qops_tmp: dt=0.00209 tinit=0.00655
rank=0 size=1122 iproc=1
   copy opB to qops_tmps: dt=0.00223 tcopy=0.00223
rank=1 size=1122 iproc=1
   bcast: size(opB)=1122:8.36e-06GB dt=0.00243 speed=0.00344GB/s tcomm=0.0169
   compute opQ from opB: dt=0.00487 tcomp=0.0148
iproc=1
 qops_tmp: oplist=N nops=N:44 
        dim(bra,ket)=10,10 size(op)=35:0.000267MB size(tot)=1122:0.00856MB:8.36e-06GB
        per(mem): N:100 
   init qops_tmp: dt=0.0021 tinit=0.00864
   from opB to opB.H(): dt=0.00712 tadjt=0.00712
   bcast: size(opN)=1122:8.36e-06GB dt=0.00242 speed=0.00346GB/s tcomm=0.0193
   compute opQ from opB.H(): dt=0.00497 tcomp=0.0198
----- TIMING FOR oper_b2qGPU : 0.0598 S T(init/copy/adjt+bcast/comp/rest)=0.00871,0.00208,0.0284,0.0198,0.00081 -----
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.756e-02 change=2.295e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=5.558e-05 avail=6.231e+00 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.756e-02 change=1.907e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=5.558e-05 avail=6.231e+00 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.756e-02 change=-5.960e-08 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 before move
rank=0 GPUmem(GB): used=5.558e-05 avail=6.231e+00 before move
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.756e-02 change=-3.554e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after move
rank=0 GPUmem(GB): used=4.396e-05 avail=6.231e+00 after move
check ||H-H.dagger||=5.595e-15 coord=(8,0) rank=0
----- TIMING FOR oper_ab2pq : 0.102 S T(init/copyHCS/opP/opQ/to_gpu/to_cpu/move)=0.00696,1.99e-05,0.0345,0.0598,0,0.000374,0.000679 -----
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.756e-02 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.756e-02 change=-6.750e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 2.260e+00 S #####
 T(local opt: fetch) = 1.277e-02 S  per = 0.565  per(accum) = 0.565
 T(local opt: hdiag) = 5.317e-01 S  per = 23.5  per(accum) = 24.1
 T(local opt: dvdsn) = 1.031e+00 S  per = 45.6  per(accum) = 69.7
 T(local opt: decim) = 2.411e-03 S  per = 0.107  per(accum) = 69.8
 T(local opt: guess) = 1.601e-03 S  per = 0.0709  per(accum) = 69.9
 T(local opt: renrm) = 6.797e-01 S  per = 30.1  per(accum) = 100
 T(local opt: save ) = 2.569e-04 S  per = 0.0114  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.031e+00 S  T(sum) = 1.029e+00 S  per = 9.981e+01
 T(local opt: preprocess                  ) = 9.722e-03 S  per = 0.945  per(accum) = 0.945
 T(local opt: symbolic_formulae           ) = 6.175e-03 S  per =  0.6  per(accum) = 1.54
 T(local opt: hintermediate init          ) = 2.900e-04 S  per = 0.0282  per(accum) = 1.57
 T(local opt: preprocess_hformulae_Hxlist ) = 5.602e-01 S  per = 54.4  per(accum) = 56
 T(local opt: hmmtasks init               ) = 2.675e-01 S  per =   26  per(accum) = 82
 T(local opt: initial guess for dvdson    ) = 2.359e-03 S  per = 0.229  per(accum) = 82.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.224e-01 S  per = 11.9  per(accum) = 94.1
 T(local opt: dvdson [cpu-gpu]            ) = 9.139e-03 S  per = 0.888  per(accum) = 95
 T(local opt: dvdson [nccl]               ) = 5.079e-02 S  per = 4.93  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 8.072e-06 S  per = 0.000784  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 6.866e-04 S  per = 0.0667  per(accum) = 100
Detailed decomposition of T(renrm) = 6.797e-01 S  T(sum) = 6.797e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.807e-04 S  per = 0.0707  per(accum) = 0.0707
 T(local opt: qops init                    ) = 5.251e-03 S  per = 0.773  per(accum) = 0.843
 T(local opt: symbolic_formulae_renorm     ) = 7.252e-04 S  per = 0.107  per(accum) = 0.95
 T(local opt: allocate qops on gpu         ) = 7.898e-05 S  per = 0.0116  per(accum) = 0.962
 T(local opt: site memcpy cpu2gpu          ) = 2.889e-04 S  per = 0.0425  per(accum) = 1
 T(local opt: rintermediate init           ) = 2.464e-03 S  per = 0.363  per(accum) = 1.37
 T(local opt: preprocess_formulae_Rlist2   ) = 2.825e-02 S  per = 4.16  per(accum) = 5.52
 T(local opt: rmmtasks init                ) = 1.319e-02 S  per = 1.94  per(accum) = 7.46
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 5.15e-06  per(accum) = 7.46
 T(local opt: preprocess_renorm_batchGPU   ) = 3.867e-02 S  per = 5.69  per(accum) = 13.2
 T(local opt: deallocate cpu and gpu memory) = 1.201e-04 S  per = 0.0177  per(accum) = 13.2
 T(local opt: construct opS [ifdists=true] ) = 4.826e-01 S  per =   71  per(accum) = 84.2
 T(local opt: reduction of opS & opH [nccl]) = 2.190e-03 S  per = 0.322  per(accum) = 84.5
 T(local opt: qops memcpy gpu2cpu          ) = 2.700e-08 S  per = 3.97e-06  per(accum) = 84.5
 T(local opt: reduction of opS & opH [mpi] ) = 8.600e-08 S  per = 1.27e-05  per(accum) = 84.5
 T(local opt: qops_pool join and erase     ) = 2.817e-03 S  per = 0.414  per(accum) = 84.9
 T(local opt: conversion from opAB to opPQ ) = 1.026e-01 S  per = 15.1  per(accum) = 100
##### sweep opt: 1.093e+01 S #####
 T(sweep opt: fetch) = 1.100e-01 S  per = 1.01  per(accum) = 1.01
 T(sweep opt: hdiag) = 1.919e+00 S  per = 17.5  per(accum) = 18.6
 T(sweep opt: dvdsn) = 3.112e+00 S  per = 28.5  per(accum) = 47
 T(sweep opt: decim) = 9.862e-03 S  per = 0.0902  per(accum) = 47.1
 T(sweep opt: guess) = 6.623e-03 S  per = 0.0606  per(accum) = 47.2
 T(sweep opt: renrm) = 5.775e+00 S  per = 52.8  per(accum) = 100
 T(sweep opt: save ) = 1.678e-03 S  per = 0.0154  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.112e+00 S  T(sum) = 3.108e+00 S  per = 9.987e+01
 T(sweep opt: preprocess                  ) = 3.142e-02 S  per = 1.01  per(accum) = 1.01
 T(sweep opt: symbolic_formulae           ) = 2.626e-02 S  per = 0.845  per(accum) = 1.86
 T(sweep opt: hintermediate init          ) = 1.453e-03 S  per = 0.0467  per(accum) = 1.9
 T(sweep opt: preprocess_hformulae_Hxlist ) = 9.335e-01 S  per =   30  per(accum) = 31.9
 T(sweep opt: hmmtasks init               ) = 3.582e-01 S  per = 11.5  per(accum) = 43.5
 T(sweep opt: initial guess for dvdson    ) = 8.320e-03 S  per = 0.268  per(accum) = 43.7
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.416e+00 S  per = 45.6  per(accum) = 89.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 6.019e-02 S  per = 1.94  per(accum) = 91.2
 T(sweep opt: dvdson [nccl]               ) = 2.696e-01 S  per = 8.67  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 1.613e-05 S  per = 0.000519  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 3.568e-03 S  per = 0.115  per(accum) = 100
Detailed decomposition of T(renrm) = 5.775e+00 S  T(sum) = 5.775e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.335e-03 S  per = 0.0404  per(accum) = 0.0404
 T(sweep opt: qops init                    ) = 2.157e-02 S  per = 0.374  per(accum) = 0.414
 T(sweep opt: symbolic_formulae_renorm     ) = 3.034e-03 S  per = 0.0525  per(accum) = 0.467
 T(sweep opt: allocate qops on gpu         ) = 5.619e-04 S  per = 0.00973  per(accum) = 0.476
 T(sweep opt: site memcpy cpu2gpu          ) = 9.710e-03 S  per = 0.168  per(accum) = 0.644
 T(sweep opt: rintermediate init           ) = 1.743e-02 S  per = 0.302  per(accum) = 0.946
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.462e-02 S  per = 1.47  per(accum) = 2.41
 T(sweep opt: rmmtasks init                ) = 3.747e-02 S  per = 0.649  per(accum) = 3.06
 T(sweep opt: qops memset on cpu           ) = 3.200e-07 S  per = 5.54e-06  per(accum) = 3.06
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.123e-01 S  per = 5.41  per(accum) = 8.47
 T(sweep opt: deallocate cpu and gpu memory) = 4.290e-04 S  per = 0.00743  per(accum) = 8.48
 T(sweep opt: construct opS [ifdists=true] ) = 5.149e+00 S  per = 89.2  per(accum) = 97.6
 T(sweep opt: reduction of opS & opH [nccl]) = 1.771e-02 S  per = 0.307  per(accum) = 97.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.781e-04 S  per = 0.0117  per(accum) = 97.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.108e-04 S  per = 0.00884  per(accum) = 98
 T(sweep opt: qops_pool join and erase     ) = 1.542e-02 S  per = 0.267  per(accum) = 98.2
 T(sweep opt: conversion from opAB to opPQ ) = 1.026e-01 S  per = 1.78  per(accum) = 100
##### global opt: 1.093e+01 S #####
 T(global opt: fetch) = 1.100e-01 S  per = 1.01  per(accum) = 1.01
 T(global opt: hdiag) = 1.919e+00 S  per = 17.5  per(accum) = 18.6
 T(global opt: dvdsn) = 3.112e+00 S  per = 28.5  per(accum) = 47
 T(global opt: decim) = 9.862e-03 S  per = 0.0902  per(accum) = 47.1
 T(global opt: guess) = 6.623e-03 S  per = 0.0606  per(accum) = 47.2
 T(global opt: renrm) = 5.775e+00 S  per = 52.8  per(accum) = 100
 T(global opt: save ) = 1.678e-03 S  per = 0.0154  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.112e+00 S  T(sum) = 3.108e+00 S  per = 9.987e+01
 T(global opt: preprocess                  ) = 3.142e-02 S  per = 1.01  per(accum) = 1.01
 T(global opt: symbolic_formulae           ) = 2.626e-02 S  per = 0.845  per(accum) = 1.86
 T(global opt: hintermediate init          ) = 1.453e-03 S  per = 0.0467  per(accum) = 1.9
 T(global opt: preprocess_hformulae_Hxlist ) = 9.335e-01 S  per =   30  per(accum) = 31.9
 T(global opt: hmmtasks init               ) = 3.582e-01 S  per = 11.5  per(accum) = 43.5
 T(global opt: initial guess for dvdson    ) = 8.320e-03 S  per = 0.268  per(accum) = 43.7
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.416e+00 S  per = 45.6  per(accum) = 89.3
 T(global opt: dvdson [cpu-gpu]            ) = 6.019e-02 S  per = 1.94  per(accum) = 91.2
 T(global opt: dvdson [nccl]               ) = 2.696e-01 S  per = 8.67  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 1.613e-05 S  per = 0.000519  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 3.568e-03 S  per = 0.115  per(accum) = 100
Detailed decomposition of T(renrm) = 5.775e+00 S  T(sum) = 5.775e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.335e-03 S  per = 0.0404  per(accum) = 0.0404
 T(global opt: qops init                    ) = 2.157e-02 S  per = 0.374  per(accum) = 0.414
 T(global opt: symbolic_formulae_renorm     ) = 3.034e-03 S  per = 0.0525  per(accum) = 0.467
 T(global opt: allocate qops on gpu         ) = 5.619e-04 S  per = 0.00973  per(accum) = 0.476
 T(global opt: site memcpy cpu2gpu          ) = 9.710e-03 S  per = 0.168  per(accum) = 0.644
 T(global opt: rintermediate init           ) = 1.743e-02 S  per = 0.302  per(accum) = 0.946
 T(global opt: preprocess_formulae_Rlist2   ) = 8.462e-02 S  per = 1.47  per(accum) = 2.41
 T(global opt: rmmtasks init                ) = 3.747e-02 S  per = 0.649  per(accum) = 3.06
 T(global opt: qops memset on cpu           ) = 3.200e-07 S  per = 5.54e-06  per(accum) = 3.06
 T(global opt: preprocess_renorm_batchGPU   ) = 3.123e-01 S  per = 5.41  per(accum) = 8.47
 T(global opt: deallocate cpu and gpu memory) = 4.290e-04 S  per = 0.00743  per(accum) = 8.48
 T(global opt: construct opS [ifdists=true] ) = 5.149e+00 S  per = 89.2  per(accum) = 97.6
 T(global opt: reduction of opS & opH [nccl]) = 1.771e-02 S  per = 0.307  per(accum) = 97.9
 T(global opt: qops memcpy gpu2cpu          ) = 6.781e-04 S  per = 0.0117  per(accum) = 97.9
 T(global opt: reduction of opS & opH [mpi] ) = 5.108e-04 S  per = 0.00884  per(accum) = 98
 T(global opt: qops_pool join and erase     ) = 1.542e-02 S  per = 0.267  per(accum) = 98.2
 T(global opt: conversion from opAB to opPQ ) = 1.026e-01 S  per = 1.78  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-7.762e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=8/seqsize=34 dots=2 dbond=(9,0)-(10,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=206:1.572e-03MB:1.535e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=23:1.755e-04MB:1.714e-07GB
total mem of comb=230:1.755e-03MB:1.714e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=9,9,1,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc1= 5
 suppc2= 6
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:9 S:6 P:59 Q:66 
        dim(bra,ket)=10,10 size(op)=35:2.670e-04MB size(tot)=2126:1.622e-02MB:1.584e-05GB
        per(mem): H:0.753 C:7.2 S:4.8 P:8.09 Q:79.2 
 rqops: oplist=HCSAB nops=H:1 C:9 S:5 A:40 B:44 
        dim(bra,ket)=3,3 size(op)=5:3.81e-05MB size(tot)=207:0.00158MB:1.54e-06GB
        per(mem): H:1.45 C:8.7 S:4.83 A:0 B:85 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4329:0.033MB:3.23e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.016e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(9,0) fdel=./scratch/sweep/rop(10,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.252e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=50:3.815e-04MB
qtensor4: wf4 own=1 _data=0x3ac09520
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=7 dimAll=10
 (14,2):2 (13,1):2 (13,3):2 (12,2):1 (14,4):1 (13,5):1 (14,0):1
 qbond: qcol nsym=3 dimAll=3
 (14,2):1 (14,4):1 (15,3):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=32 nblocks=324 size=50:3.815e-04MB
### DIAG TIMING: total=6.719e-01 t1=2.720e-05, t2=1.268e-03, t3=2.468e-03, t4=6.233e-01, t5=3.981e-06, t6=4.479e-02, t7=6.781e-06
duration_diagGPU:6.719e-01
duration_diagreduce:7.000e-08
duration_diagtransform:4.370e-07
----- TIMING FOR symbolic_formulae_twodot with size=523 : 6.974e-03 S -----
rank=0 GPUmem(GB): used=3.225e-05 (oper)=3.225e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=523
 no. of hintermediate operators=259
 no. of coefficients=3136:2.393e-02MB:2.337e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.689e-04 S -----
rank=0 GPUmem(GB): used=5.562e-05 (oper,hinter)=3.225e-05,2.337e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.708e-01 S size(H_formulae)=523 size(Hxlst2)=32 T(Hmu/Hxlist)=1.442e-03,3.693e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.739e-01 S size(H_formulae)=523 size(Hxlst)=22042 -----
rank=0 GPUmem(GB): used=5.562e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=7.451e-07 batch[need]=1.478e-03 blksize=2 blksize0=4 batchsize=22042
rank=0 GPUmem(GB): used=1.534e-03 (oper,hinter,dvdson,batch)=3.225e-05,2.337e-05,7.451e-07,1.478e-03
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=50 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.629e-03,2.561e-03,1.023e-02,1.071e-02,3.116e-02
 analyze_tgpu[Hx]: ndim=50:3.725e-07GB T(cpu-gpu)=2.162e-03 speed=3.446e-04GB/S T(nccl)=5.467e-03 speed=1.363e-04GB/S
----- TIMING FOR sigma : t_inter=2.6e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.4e-02 -----
 sigma[inter] counter=34 t=2.6e-03 per=1.1e+01 cost=4.7e+05 flops=1.9e+08
 sigma[gemm] counter=34 i=0 t=1.6e-06 per=6.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=1 t=1.2e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=2 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=3 t=1.2e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=4 t=2.6e-03 per=1.1e+01 cost=3.4e+04 flops=1.3e+07
 sigma[gemm] counter=34 i=5 t=2.6e-03 per=1.1e+01 cost=3.4e+04 flops=1.3e+07
 sigma[gemm] counter=34 i=6 t=2.5e-03 per=1.1e+01 cost=4.8e+04 flops=1.9e+07
 sigma[gemm] counter=34 i=7 t=2.5e-03 per=1.1e+01 cost=4.8e+04 flops=1.9e+07
 sigma[gemm] counter=34 total t=1.0e-02 per=4.4e+01 cost=1.6e+05 flops=1.6e+07
 sigma[red] counter=34 t=1.1e-02 per=4.6e+01 cost=7.1e+04 flops=6.6e+06
----- TIMING FOR sigma_tot : t_inter=2.0e-01 t_gemm=8.5e-01 t_reduction=3.9e-01 tot=1.4e+00 -----
 sigma_tot[inter] counter=34 t=2.0e-01 per=1.4e+01 cost=4.0e+06 flops=2.0e+07
 sigma_tot[gemm] counter=34 i=0 t=4.6e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=1 t=4.1e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=2 t=3.9e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=3 t=3.9e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=4 t=2.2e-01 per=1.5e+01 cost=3.2e+05 flops=1.5e+06
 sigma_tot[gemm] counter=34 i=5 t=2.2e-01 per=1.5e+01 cost=3.2e+05 flops=1.5e+06
 sigma_tot[gemm] counter=34 i=6 t=2.1e-01 per=1.5e+01 cost=5.8e+05 flops=2.8e+06
 sigma_tot[gemm] counter=34 i=7 t=2.1e-01 per=1.5e+01 cost=5.8e+05 flops=2.8e+06
 sigma_tot[gemm] counter=34 total t=8.5e-01 per=5.9e+01 cost=1.8e+06 flops=2.1e+06
 sigma_tot[red] counter=34 t=3.9e-01 per=2.7e+01 cost=8.4e+05 flops=2.2e+06
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=6.4e-06,9.5e-06,2.3e-06,9.8e-07,2.4e-07
settings: ndim=50 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.157402573649 -1.116e+03  1.474e-02    1     1  3.142e-02 3.142e-02 3.137e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.326e-03,2.593e-03,1.028e-02,1.067e-02,3.187e-02
 analyze_tgpu[Hx]: ndim=50:3.725e-07GB T(cpu-gpu)=2.162e-03 speed=3.447e-04GB/S T(nccl)=6.165e-03 speed=1.209e-04GB/S
----- TIMING FOR sigma : t_inter=2.6e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.4e-02 -----
 sigma[inter] counter=35 t=2.6e-03 per=1.1e+01 cost=4.7e+05 flops=1.8e+08
 sigma[gemm] counter=35 i=0 t=1.3e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=1 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=2 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=3 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=4 t=2.6e-03 per=1.1e+01 cost=3.4e+04 flops=1.3e+07
 sigma[gemm] counter=35 i=5 t=2.6e-03 per=1.1e+01 cost=3.4e+04 flops=1.3e+07
 sigma[gemm] counter=35 i=6 t=2.6e-03 per=1.1e+01 cost=4.8e+04 flops=1.9e+07
 sigma[gemm] counter=35 i=7 t=2.6e-03 per=1.1e+01 cost=4.8e+04 flops=1.9e+07
 sigma[gemm] counter=35 total t=1.0e-02 per=4.4e+01 cost=1.6e+05 flops=1.6e+07
 sigma[red] counter=35 t=1.1e-02 per=4.5e+01 cost=7.1e+04 flops=6.7e+06
----- TIMING FOR sigma_tot : t_inter=2.0e-01 t_gemm=8.6e-01 t_reduction=4.0e-01 tot=1.5e+00 -----
 sigma_tot[inter] counter=35 t=2.0e-01 per=1.4e+01 cost=4.5e+06 flops=2.2e+07
 sigma_tot[gemm] counter=35 i=0 t=4.8e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=1 t=4.2e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=2 t=4.1e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=3 t=4.1e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=4 t=2.2e-01 per=1.5e+01 cost=3.6e+05 flops=1.6e+06
 sigma_tot[gemm] counter=35 i=5 t=2.2e-01 per=1.5e+01 cost=3.6e+05 flops=1.6e+06
 sigma_tot[gemm] counter=35 i=6 t=2.1e-01 per=1.4e+01 cost=6.3e+05 flops=3.0e+06
 sigma_tot[gemm] counter=35 i=7 t=2.1e-01 per=1.4e+01 cost=6.3e+05 flops=3.0e+06
 sigma_tot[gemm] counter=35 total t=8.6e-01 per=5.9e+01 cost=2.0e+06 flops=2.3e+06
 sigma_tot[red] counter=35 t=4.0e-01 per=2.7e+01 cost=9.1e+05 flops=2.3e+06
T(sub)=5.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.0e-05,3.7e-05,3.9e-06,1.7e-06,2.4e-07
    2   0 -    -116.158429516627 -1.027e-03  5.141e-03    2     2  6.364e-02 3.182e-02 3.169e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.049e-03,2.520e-03,1.004e-02,1.065e-02,3.226e-02
 analyze_tgpu[Hx]: ndim=50:3.725e-07GB T(cpu-gpu)=2.175e-03 speed=3.426e-04GB/S T(nccl)=6.875e-03 speed=1.084e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=36 t=2.5e-03 per=1.1e+01 cost=4.7e+05 flops=1.9e+08
 sigma[gemm] counter=36 i=0 t=1.3e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=1 t=1.2e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=2 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=3 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=4 t=2.5e-03 per=1.1e+01 cost=3.4e+04 flops=1.4e+07
 sigma[gemm] counter=36 i=5 t=2.5e-03 per=1.1e+01 cost=3.4e+04 flops=1.4e+07
 sigma[gemm] counter=36 i=6 t=2.5e-03 per=1.1e+01 cost=4.8e+04 flops=1.9e+07
 sigma[gemm] counter=36 i=7 t=2.5e-03 per=1.1e+01 cost=4.8e+04 flops=1.9e+07
 sigma[gemm] counter=36 total t=1.0e-02 per=4.3e+01 cost=1.6e+05 flops=1.6e+07
 sigma[red] counter=36 t=1.1e-02 per=4.6e+01 cost=7.1e+04 flops=6.7e+06
----- TIMING FOR sigma_tot : t_inter=2.0e-01 t_gemm=8.7e-01 t_reduction=4.1e-01 tot=1.5e+00 -----
 sigma_tot[inter] counter=36 t=2.0e-01 per=1.4e+01 cost=5.0e+06 flops=2.5e+07
 sigma_tot[gemm] counter=36 i=0 t=4.9e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=1 t=4.3e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=2 t=4.2e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=3 t=4.2e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=4 t=2.2e-01 per=1.5e+01 cost=3.9e+05 flops=1.8e+06
 sigma_tot[gemm] counter=36 i=5 t=2.2e-01 per=1.5e+01 cost=3.9e+05 flops=1.8e+06
 sigma_tot[gemm] counter=36 i=6 t=2.1e-01 per=1.4e+01 cost=6.8e+05 flops=3.2e+06
 sigma_tot[gemm] counter=36 i=7 t=2.1e-01 per=1.4e+01 cost=6.8e+05 flops=3.2e+06
 sigma_tot[gemm] counter=36 total t=8.7e-01 per=5.9e+01 cost=2.1e+06 flops=2.5e+06
 sigma_tot[red] counter=36 t=4.1e-01 per=2.8e+01 cost=9.9e+05 flops=2.4e+06
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,2.4e-05,1.3e-05,1.2e-06,2.0e-07
    3   0 -    -116.158499428248 -6.991e-05  1.246e-03    3     3  9.617e-02 3.206e-02 3.193e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.683e-03,2.539e-03,1.016e-02,1.064e-02,3.203e-02
 analyze_tgpu[Hx]: ndim=50:3.725e-07GB T(cpu-gpu)=2.273e-03 speed=3.277e-04GB/S T(nccl)=6.410e-03 speed=1.162e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=37 t=2.5e-03 per=1.1e+01 cost=4.7e+05 flops=1.9e+08
 sigma[gemm] counter=37 i=0 t=1.4e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=1 t=1.2e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=2 t=1.2e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=3 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=4 t=2.6e-03 per=1.1e+01 cost=3.4e+04 flops=1.3e+07
 sigma[gemm] counter=37 i=5 t=2.6e-03 per=1.1e+01 cost=3.4e+04 flops=1.3e+07
 sigma[gemm] counter=37 i=6 t=2.5e-03 per=1.1e+01 cost=4.8e+04 flops=1.9e+07
 sigma[gemm] counter=37 i=7 t=2.5e-03 per=1.1e+01 cost=4.8e+04 flops=1.9e+07
 sigma[gemm] counter=37 total t=1.0e-02 per=4.4e+01 cost=1.6e+05 flops=1.6e+07
 sigma[red] counter=37 t=1.1e-02 per=4.6e+01 cost=7.1e+04 flops=6.7e+06
----- TIMING FOR sigma_tot : t_inter=2.0e-01 t_gemm=8.8e-01 t_reduction=4.2e-01 tot=1.5e+00 -----
 sigma_tot[inter] counter=37 t=2.0e-01 per=1.4e+01 cost=5.4e+06 flops=2.7e+07
 sigma_tot[gemm] counter=37 i=0 t=5.0e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=1 t=4.4e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=2 t=4.3e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=3 t=4.3e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=4 t=2.2e-01 per=1.5e+01 cost=4.2e+05 flops=1.9e+06
 sigma_tot[gemm] counter=37 i=5 t=2.2e-01 per=1.5e+01 cost=4.3e+05 flops=1.9e+06
 sigma_tot[gemm] counter=37 i=6 t=2.2e-01 per=1.4e+01 cost=7.3e+05 flops=3.4e+06
 sigma_tot[gemm] counter=37 i=7 t=2.2e-01 per=1.4e+01 cost=7.3e+05 flops=3.4e+06
 sigma_tot[gemm] counter=37 total t=8.8e-01 per=5.8e+01 cost=2.3e+06 flops=2.6e+06
 sigma_tot[red] counter=37 t=4.2e-01 per=2.8e+01 cost=1.1e+06 flops=2.5e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.4e-05,3.1e-06,1.1e-06,2.1e-07
    4   0 -    -116.158503161732 -3.733e-06  3.790e-04    3     4  1.285e-01 3.213e-02 3.201e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.733e-03,2.510e-03,1.019e-02,1.055e-02,3.199e-02
 analyze_tgpu[Hx]: ndim=50:3.725e-07GB T(cpu-gpu)=2.110e-03 speed=3.531e-04GB/S T(nccl)=6.623e-03 speed=1.125e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=38 t=2.5e-03 per=1.1e+01 cost=4.7e+05 flops=1.9e+08
 sigma[gemm] counter=38 i=0 t=1.3e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=1 t=1.2e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=2 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=3 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=4 t=2.5e-03 per=1.1e+01 cost=3.4e+04 flops=1.3e+07
 sigma[gemm] counter=38 i=5 t=2.6e-03 per=1.1e+01 cost=3.4e+04 flops=1.3e+07
 sigma[gemm] counter=38 i=6 t=2.5e-03 per=1.1e+01 cost=4.8e+04 flops=1.9e+07
 sigma[gemm] counter=38 i=7 t=2.5e-03 per=1.1e+01 cost=4.8e+04 flops=1.9e+07
 sigma[gemm] counter=38 total t=1.0e-02 per=4.4e+01 cost=1.6e+05 flops=1.6e+07
 sigma[red] counter=38 t=1.1e-02 per=4.5e+01 cost=7.1e+04 flops=6.7e+06
----- TIMING FOR sigma_tot : t_inter=2.1e-01 t_gemm=8.9e-01 t_reduction=4.3e-01 tot=1.5e+00 -----
 sigma_tot[inter] counter=38 t=2.1e-01 per=1.4e+01 cost=5.9e+06 flops=2.9e+07
 sigma_tot[gemm] counter=38 i=0 t=5.2e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=1 t=4.6e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=2 t=4.4e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=3 t=4.4e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=4 t=2.3e-01 per=1.5e+01 cost=4.6e+05 flops=2.0e+06
 sigma_tot[gemm] counter=38 i=5 t=2.3e-01 per=1.5e+01 cost=4.6e+05 flops=2.0e+06
 sigma_tot[gemm] counter=38 i=6 t=2.2e-01 per=1.4e+01 cost=7.7e+05 flops=3.5e+06
 sigma_tot[gemm] counter=38 i=7 t=2.2e-01 per=1.4e+01 cost=7.7e+05 flops=3.5e+06
 sigma_tot[gemm] counter=38 total t=8.9e-01 per=5.8e+01 cost=2.5e+06 flops=2.8e+06
 sigma_tot[red] counter=38 t=4.3e-01 per=2.8e+01 cost=1.1e+06 flops=2.6e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.4e-05,3.0e-06,1.2e-06,2.2e-07
    5   0 -    -116.158503517399 -3.557e-07  1.096e-04    3     5  1.608e-01 3.216e-02 3.205e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.002e-03,2.512e-03,9.988e-03,1.061e-02,3.212e-02
 analyze_tgpu[Hx]: ndim=50:3.725e-07GB T(cpu-gpu)=2.217e-03 speed=3.361e-04GB/S T(nccl)=6.786e-03 speed=1.098e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=39 t=2.5e-03 per=1.1e+01 cost=4.7e+05 flops=1.9e+08
 sigma[gemm] counter=39 i=0 t=1.3e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=1 t=1.2e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=2 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=3 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=4 t=2.5e-03 per=1.1e+01 cost=3.4e+04 flops=1.4e+07
 sigma[gemm] counter=39 i=5 t=2.5e-03 per=1.1e+01 cost=3.4e+04 flops=1.4e+07
 sigma[gemm] counter=39 i=6 t=2.5e-03 per=1.1e+01 cost=4.8e+04 flops=1.9e+07
 sigma[gemm] counter=39 i=7 t=2.5e-03 per=1.1e+01 cost=4.8e+04 flops=1.9e+07
 sigma[gemm] counter=39 total t=1.0e-02 per=4.3e+01 cost=1.6e+05 flops=1.6e+07
 sigma[red] counter=39 t=1.1e-02 per=4.6e+01 cost=7.1e+04 flops=6.7e+06
----- TIMING FOR sigma_tot : t_inter=2.1e-01 t_gemm=9.0e-01 t_reduction=4.4e-01 tot=1.5e+00 -----
 sigma_tot[inter] counter=39 t=2.1e-01 per=1.4e+01 cost=6.4e+06 flops=3.0e+07
 sigma_tot[gemm] counter=39 i=0 t=5.3e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=1 t=4.7e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=2 t=4.5e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=3 t=4.5e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=4 t=2.3e-01 per=1.5e+01 cost=4.9e+05 flops=2.2e+06
 sigma_tot[gemm] counter=39 i=5 t=2.3e-01 per=1.5e+01 cost=4.9e+05 flops=2.2e+06
 sigma_tot[gemm] counter=39 i=6 t=2.2e-01 per=1.4e+01 cost=8.2e+05 flops=3.7e+06
 sigma_tot[gemm] counter=39 i=7 t=2.2e-01 per=1.4e+01 cost=8.2e+05 flops=3.7e+06
 sigma_tot[gemm] counter=39 total t=9.0e-01 per=5.8e+01 cost=2.6e+06 flops=2.9e+06
 sigma_tot[red] counter=39 t=4.4e-01 per=2.8e+01 cost=1.2e+06 flops=2.7e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.3e-05,3.0e-06,1.0e-06,2.0e-07
    6   0 +    -116.158503554984 -3.758e-08  3.703e-05    3     6  1.932e-01 3.221e-02 3.210e-02
TIMING FOR Davidson : 1.933e-01  T(cal/comm/rest)=1.926e-01,9.199e-06,6.611e-04
decomposed t_rest=6.611e-04
 T(sub)    =1.819e-04 per=2.751e+01
 T(precond)=4.855e-05 per=7.343e+00
 T(ortho)  =1.274e-05 per=1.926e+00
 T(xcopy)  =1.106e-06 per=1.673e-01
 T(xnrm2)  =2.642e-06 per=3.996e-01
 T(other)  =4.142e-04 per=6.265e+01
optimized energies: isweep=0 ibond=8 dots=2 e[0]=-116.158503554984 nmvp=6
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=1.122e-02 change=5.424e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=14 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond8.txt
 qbond: qsuper nsym=14 dimAll=39
 (14,2):7 (16,2):2 (15,1):5 (15,3):5 (13,1):3 (14,0):3 (13,3):3 (14,4):4 (12,2):1 (16,4):1 (15,5):2 (13,5):1 (14,6):1 (16,0):1
timing for divide=9.5e-05
timing for compute=1.2e-04
timing for collect=2.1e-05
----- TMING FOR decimation_genbasis(su2): 2.4e-04 S T(divide/compute[cpu/gpu/rest]/collect)=9.5e-05,1.1e-04,0.0e+00,1.1e-05,2.1e-05 -----
decimation summary: 39->10 dwt=+3.050e-07 SvN=7.303e-01
 qbond: qkept nsym=6 dimAll=10
 (15,3):3 (14,2):2 (14,4):2 (15,1):1 (13,3):1 (15,5):1
----- TIMING for decimation_row(nkr): 7.708e-04 S T(decim/select/formRot)=3.517e-04,2.944e-04,1.247e-04 -----
----- TIMING FOR twodot_decimation: 1.403e-03 S T(wf/decim)=6.165e-04,7.868e-04 -----
ctns::oper_renorm coord=(9,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:10 S:5 P:49 Q:56 
        dim(bra,ket)=10,10 size(op)=40:3.052e-04MB size(tot)=2191:1.672e-02MB:1.632e-05GB
        per(mem): H:0.913 C:9.13 S:4.56 P:8.72 Q:76.7 
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=1.117e-02 change=3.302e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=116 : 3.432e-03 S -----
rank=0 GPUmem(GB): used=7.040e-05 (oper)=3.960e-05
rank=0 GPUmem(GB): used=7.075e-05 (oper,site)=3.960e-05,3.502e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=116
 no. of rintermediate operators=161
 no. of coefficients=1449:1.105e-02MB:1.080e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.518e-03 S -----
rank=0 GPUmem(GB): used=8.155e-05 (oper,site,rinter)=3.960e-05,3.502e-07,1.080e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 6.112e-02 S size(rtasks)=116 size(Rlst2)=36 T(Rmu/Rlist)=9.860e-04,6.014e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.172e-02 S size(rtasks)=116 size(Rlst)=5074 -----
rank=0 GPUmem(GB): used=8.155e-05 avail=6.231e+00 total=6.231e+00 batch[need]=8.695e-04 blksize=9 blksize0=4 batchsize=5074
rank=0 GPUmem(GB): used=9.510e-04 (oper,site,rinter,batch)=3.960e-05,3.502e-07,1.080e-05,8.695e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.052e-03,2.260e-02,1.011e-02
----- TIMING FOR renorm : t_inter=7.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=125 t=7.1e-03 per=1.8e+01 cost=9.0e+04 flops=1.3e+07
 renorm[gemm] counter=125 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=125 i=1 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=125 i=2 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=125 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=125 i=4 t=7.5e-03 per=1.9e+01 cost=1.2e+04 flops=1.6e+06
 renorm[gemm] counter=125 i=5 t=7.5e-03 per=1.9e+01 cost=2.9e+04 flops=3.9e+06
 renorm[gemm] counter=125 i=6 t=7.5e-03 per=1.9e+01 cost=5.9e+04 flops=7.9e+06
 renorm[gemm] counter=125 total t=2.3e-02 per=5.7e+01 cost=1.0e+05 flops=4.5e+06
 renorm[red] counter=125 t=1.0e-02 per=2.5e+01 cost=3.7e+04 flops=3.6e+06
----- TIMING FOR renorm_tot : t_inter=5.8e-02 t_gemm=2.0e-01 t_reduction=9.0e-02 tot=3.5e-01 -----
 renorm_tot[inter] counter=125 t=5.8e-02 per=1.7e+01 cost=1.2e+05 flops=2.0e+06
 renorm_tot[gemm] counter=125 i=0 t=1.2e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=125 i=1 t=1.0e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=125 i=2 t=1.0e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=125 i=3 t=1.0e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=125 i=4 t=6.7e-02 per=1.9e+01 cost=1.5e+04 flops=2.2e+05
 renorm_tot[gemm] counter=125 i=5 t=6.7e-02 per=1.9e+01 cost=5.9e+04 flops=8.8e+05
 renorm_tot[gemm] counter=125 i=6 t=6.8e-02 per=1.9e+01 cost=9.6e+04 flops=1.4e+06
 renorm_tot[gemm] counter=125 total t=2.0e-01 per=5.8e+01 cost=1.7e+05 flops=8.4e+05
 renorm_tot[red] counter=125 t=9.0e-02 per=2.6e+01 cost=6.4e+04 flops=7.1e+05
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=8.235e-05 (optmp,oper)=1.490e-07,3.960e-05
rank=0 GPUmem(GB): used=8.270e-05 (optmp,oper,site,rinter)=1.490e-07,3.960e-05,3.502e-07,1.006e-06
rank=0 GPUmem(GB): used=9.473e-05 (optmp,oper,site,rinter,batch)=1.490e-07,3.960e-05,3.502e-07,1.006e-06,1.203e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 3.918e-01 S T(prep/alloc/comp/red/dealloc)=1.092e-02,1.480e-02,3.495e-01,2.501e-02,2.516e-03 -----
----- TIMING FOR oper_renorm_opS : 3.919e-01 S rank=0 -----
qops.to_cpu: size(tot)=2191:1.672e-02MB:1.632e-05GB T(to_cpu)=1.713e-04S speed=9.528e-02GB/S
check ||H-H.dagger||=6.957e-15 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.542 S rank=0 -----
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.092e-02 change=1.399e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=1.337e-02 change=-2.734e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=1.337e-02 change=-5.558e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.993e+00 S #####
 T(local opt: fetch) = 1.089e-02 S  per = 0.546  per(accum) = 0.546
 T(local opt: hdiag) = 6.726e-01 S  per = 33.7  per(accum) = 34.3
 T(local opt: dvdsn) = 7.617e-01 S  per = 38.2  per(accum) = 72.5
 T(local opt: decim) = 1.563e-03 S  per = 0.0784  per(accum) = 72.6
 T(local opt: guess) = 9.736e-04 S  per = 0.0489  per(accum) = 72.6
 T(local opt: renrm) = 5.450e-01 S  per = 27.3  per(accum) = 100
 T(local opt: save ) = 2.571e-04 S  per = 0.0129  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.617e-01 S  T(sum) = 7.607e-01 S  per = 9.986e+01
 T(local opt: preprocess                  ) = 4.795e-03 S  per = 0.63  per(accum) = 0.63
 T(local opt: symbolic_formulae           ) = 6.992e-03 S  per = 0.919  per(accum) = 1.55
 T(local opt: hintermediate init          ) = 2.972e-04 S  per = 0.0391  per(accum) = 1.59
 T(local opt: preprocess_hformulae_Hxlist ) = 3.748e-01 S  per = 49.3  per(accum) = 50.9
 T(local opt: hmmtasks init               ) = 1.790e-01 S  per = 23.5  per(accum) = 74.4
 T(local opt: initial guess for dvdson    ) = 1.587e-03 S  per = 0.209  per(accum) = 74.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.412e-01 S  per = 18.6  per(accum) = 93.2
 T(local opt: dvdson [cpu-gpu]            ) = 1.310e-02 S  per = 1.72  per(accum) = 94.9
 T(local opt: dvdson [nccl]               ) = 3.832e-02 S  per = 5.04  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 9.199e-06 S  per = 0.00121  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 6.611e-04 S  per = 0.0869  per(accum) = 100
Detailed decomposition of T(renrm) = 5.450e-01 S  T(sum) = 5.450e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.708e-04 S  per = 0.068  per(accum) = 0.068
 T(local opt: qops init                    ) = 4.778e-03 S  per = 0.877  per(accum) = 0.945
 T(local opt: symbolic_formulae_renorm     ) = 3.446e-03 S  per = 0.632  per(accum) = 1.58
 T(local opt: allocate qops on gpu         ) = 5.342e-05 S  per = 0.0098  per(accum) = 1.59
 T(local opt: site memcpy cpu2gpu          ) = 9.575e-04 S  per = 0.176  per(accum) = 1.76
 T(local opt: rintermediate init           ) = 2.532e-03 S  per = 0.465  per(accum) = 2.23
 T(local opt: preprocess_formulae_Rlist2   ) = 6.190e-02 S  per = 11.4  per(accum) = 13.6
 T(local opt: rmmtasks init                ) = 3.334e-02 S  per = 6.12  per(accum) = 19.7
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 6.42e-06  per(accum) = 19.7
 T(local opt: preprocess_renorm_batchGPU   ) = 3.987e-02 S  per = 7.32  per(accum) = 27
 T(local opt: deallocate cpu and gpu memory) = 2.148e-04 S  per = 0.0394  per(accum) = 27.1
 T(local opt: construct opS [ifdists=true] ) = 3.919e-01 S  per = 71.9  per(accum) = 99
 T(local opt: reduction of opS & opH [nccl]) = 2.371e-03 S  per = 0.435  per(accum) = 99.4
 T(local opt: qops memcpy gpu2cpu          ) = 1.829e-04 S  per = 0.0336  per(accum) = 99.4
 T(local opt: reduction of opS & opH [mpi] ) = 6.797e-05 S  per = 0.0125  per(accum) = 99.5
 T(local opt: qops_pool join and erase     ) = 2.920e-03 S  per = 0.536  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.273e-05 S  per = 0.00234  per(accum) = 100
##### sweep opt: 1.293e+01 S #####
 T(sweep opt: fetch) = 1.208e-01 S  per = 0.935  per(accum) = 0.935
 T(sweep opt: hdiag) = 2.591e+00 S  per =   20  per(accum) = 21
 T(sweep opt: dvdsn) = 3.874e+00 S  per =   30  per(accum) = 50.9
 T(sweep opt: decim) = 1.143e-02 S  per = 0.0884  per(accum) = 51
 T(sweep opt: guess) = 7.597e-03 S  per = 0.0588  per(accum) = 51.1
 T(sweep opt: renrm) = 6.320e+00 S  per = 48.9  per(accum) = 100
 T(sweep opt: save ) = 1.936e-03 S  per = 0.015  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.874e+00 S  T(sum) = 3.869e+00 S  per = 9.987e+01
 T(sweep opt: preprocess                  ) = 3.621e-02 S  per = 0.936  per(accum) = 0.936
 T(sweep opt: symbolic_formulae           ) = 3.325e-02 S  per = 0.859  per(accum) = 1.8
 T(sweep opt: hintermediate init          ) = 1.750e-03 S  per = 0.0452  per(accum) = 1.84
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.308e+00 S  per = 33.8  per(accum) = 35.7
 T(sweep opt: hmmtasks init               ) = 5.372e-01 S  per = 13.9  per(accum) = 49.5
 T(sweep opt: initial guess for dvdson    ) = 9.907e-03 S  per = 0.256  per(accum) = 49.8
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.557e+00 S  per = 40.2  per(accum) = 90
 T(sweep opt: dvdson [cpu-gpu]            ) = 7.329e-02 S  per = 1.89  per(accum) = 91.9
 T(sweep opt: dvdson [nccl]               ) = 3.079e-01 S  per = 7.96  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 2.533e-05 S  per = 0.000655  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 4.229e-03 S  per = 0.109  per(accum) = 100
Detailed decomposition of T(renrm) = 6.320e+00 S  T(sum) = 6.320e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.706e-03 S  per = 0.0428  per(accum) = 0.0428
 T(sweep opt: qops init                    ) = 2.635e-02 S  per = 0.417  per(accum) = 0.46
 T(sweep opt: symbolic_formulae_renorm     ) = 6.480e-03 S  per = 0.103  per(accum) = 0.562
 T(sweep opt: allocate qops on gpu         ) = 6.153e-04 S  per = 0.00974  per(accum) = 0.572
 T(sweep opt: site memcpy cpu2gpu          ) = 1.067e-02 S  per = 0.169  per(accum) = 0.741
 T(sweep opt: rintermediate init           ) = 1.996e-02 S  per = 0.316  per(accum) = 1.06
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.465e-01 S  per = 2.32  per(accum) = 3.38
 T(sweep opt: rmmtasks init                ) = 7.082e-02 S  per = 1.12  per(accum) = 4.5
 T(sweep opt: qops memset on cpu           ) = 3.550e-07 S  per = 5.62e-06  per(accum) = 4.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.522e-01 S  per = 5.57  per(accum) = 10.1
 T(sweep opt: deallocate cpu and gpu memory) = 6.439e-04 S  per = 0.0102  per(accum) = 10.1
 T(sweep opt: construct opS [ifdists=true] ) = 5.541e+00 S  per = 87.7  per(accum) = 97.7
 T(sweep opt: reduction of opS & opH [nccl]) = 2.008e-02 S  per = 0.318  per(accum) = 98.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 8.610e-04 S  per = 0.0136  per(accum) = 98.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.788e-04 S  per = 0.00916  per(accum) = 98.1
 T(sweep opt: qops_pool join and erase     ) = 1.834e-02 S  per = 0.29  per(accum) = 98.4
 T(sweep opt: conversion from opAB to opPQ ) = 1.026e-01 S  per = 1.62  per(accum) = 100
##### global opt: 1.293e+01 S #####
 T(global opt: fetch) = 1.208e-01 S  per = 0.935  per(accum) = 0.935
 T(global opt: hdiag) = 2.591e+00 S  per =   20  per(accum) = 21
 T(global opt: dvdsn) = 3.874e+00 S  per =   30  per(accum) = 50.9
 T(global opt: decim) = 1.143e-02 S  per = 0.0884  per(accum) = 51
 T(global opt: guess) = 7.597e-03 S  per = 0.0588  per(accum) = 51.1
 T(global opt: renrm) = 6.320e+00 S  per = 48.9  per(accum) = 100
 T(global opt: save ) = 1.936e-03 S  per = 0.015  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.874e+00 S  T(sum) = 3.869e+00 S  per = 9.987e+01
 T(global opt: preprocess                  ) = 3.621e-02 S  per = 0.936  per(accum) = 0.936
 T(global opt: symbolic_formulae           ) = 3.325e-02 S  per = 0.859  per(accum) = 1.8
 T(global opt: hintermediate init          ) = 1.750e-03 S  per = 0.0452  per(accum) = 1.84
 T(global opt: preprocess_hformulae_Hxlist ) = 1.308e+00 S  per = 33.8  per(accum) = 35.7
 T(global opt: hmmtasks init               ) = 5.372e-01 S  per = 13.9  per(accum) = 49.5
 T(global opt: initial guess for dvdson    ) = 9.907e-03 S  per = 0.256  per(accum) = 49.8
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.557e+00 S  per = 40.2  per(accum) = 90
 T(global opt: dvdson [cpu-gpu]            ) = 7.329e-02 S  per = 1.89  per(accum) = 91.9
 T(global opt: dvdson [nccl]               ) = 3.079e-01 S  per = 7.96  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 2.533e-05 S  per = 0.000655  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 4.229e-03 S  per = 0.109  per(accum) = 100
Detailed decomposition of T(renrm) = 6.320e+00 S  T(sum) = 6.320e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.706e-03 S  per = 0.0428  per(accum) = 0.0428
 T(global opt: qops init                    ) = 2.635e-02 S  per = 0.417  per(accum) = 0.46
 T(global opt: symbolic_formulae_renorm     ) = 6.480e-03 S  per = 0.103  per(accum) = 0.562
 T(global opt: allocate qops on gpu         ) = 6.153e-04 S  per = 0.00974  per(accum) = 0.572
 T(global opt: site memcpy cpu2gpu          ) = 1.067e-02 S  per = 0.169  per(accum) = 0.741
 T(global opt: rintermediate init           ) = 1.996e-02 S  per = 0.316  per(accum) = 1.06
 T(global opt: preprocess_formulae_Rlist2   ) = 1.465e-01 S  per = 2.32  per(accum) = 3.38
 T(global opt: rmmtasks init                ) = 7.082e-02 S  per = 1.12  per(accum) = 4.5
 T(global opt: qops memset on cpu           ) = 3.550e-07 S  per = 5.62e-06  per(accum) = 4.5
 T(global opt: preprocess_renorm_batchGPU   ) = 3.522e-01 S  per = 5.57  per(accum) = 10.1
 T(global opt: deallocate cpu and gpu memory) = 6.439e-04 S  per = 0.0102  per(accum) = 10.1
 T(global opt: construct opS [ifdists=true] ) = 5.541e+00 S  per = 87.7  per(accum) = 97.7
 T(global opt: reduction of opS & opH [nccl]) = 2.008e-02 S  per = 0.318  per(accum) = 98.1
 T(global opt: qops memcpy gpu2cpu          ) = 8.610e-04 S  per = 0.0136  per(accum) = 98.1
 T(global opt: reduction of opS & opH [mpi] ) = 5.788e-04 S  per = 0.00916  per(accum) = 98.1
 T(global opt: qops_pool join and erase     ) = 1.834e-02 S  per = 0.29  per(accum) = 98.4
 T(global opt: conversion from opAB to opPQ ) = 1.026e-01 S  per = 1.62  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-5.407e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=9/seqsize=34 dots=2 dbond=(10,0)-(11,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=246:1.877e-03MB:1.833e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=20:1.526e-04MB:1.490e-07GB
total mem of comb=267:2.037e-03MB:1.989e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=10,8,1,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc1= 6
 suppc2= 7
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:10 S:5 P:49 Q:56 
        dim(bra,ket)=10,10 size(op)=40:3.052e-04MB size(tot)=2191:1.672e-02MB:1.632e-05GB
        per(mem): H:0.913 C:9.13 S:4.56 P:8.72 Q:76.7 
 rqops: oplist=HCSAB nops=H:1 C:8 S:6 A:28 B:40 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=164:0.00125MB:1.22e-06GB
        per(mem): H:2.44 C:0 S:0 A:0 B:97.6 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4351:0.0332MB:3.24e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.357e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(10,0) fdel=./scratch/sweep/rop(11,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-8.941e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,2,3,3) nnz=46:3.510e-04MB
qtensor4: wf4 own=1 _data=0x3a463080
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (15,3):3 (14,2):2 (14,4):2 (15,1):1 (13,3):1 (15,5):1
 qbond: qcol nsym=1 dimAll=2
 (13,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=11 nblocks=96 size=46:3.510e-04MB
### DIAG TIMING: total=5.778e-01 t1=2.540e-05, t2=3.624e-04, t3=1.540e-03, t4=5.733e-01, t5=7.736e-06, t6=2.516e-03, t7=7.604e-06
duration_diagGPU:5.778e-01
duration_diagreduce:6.600e-08
duration_diagtransform:4.690e-07
----- TIMING FOR symbolic_formulae_twodot with size=449 : 6.037e-03 S -----
rank=0 GPUmem(GB): used=3.242e-05 (oper)=3.242e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=449
 no. of hintermediate operators=226
 no. of coefficients=2834:2.162e-02MB:2.111e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.633e-04 S -----
rank=0 GPUmem(GB): used=5.353e-05 (oper,hinter)=3.242e-05,2.111e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 8.065e-02 S size(H_formulae)=449 size(Hxlst2)=11 T(Hmu/Hxlist)=1.206e-03,7.944e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 8.149e-02 S size(H_formulae)=449 size(Hxlst)=4950 -----
rank=0 GPUmem(GB): used=5.353e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=6.855e-07 batch[need]=7.007e-04 blksize=6 blksize0=6 batchsize=4950
rank=0 GPUmem(GB): used=7.549e-04 (oper,hinter,dvdson,batch)=3.242e-05,2.111e-05,6.855e-07,7.007e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=46 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.364e-03,7.480e-03,3.029e-02,1.269e-02,5.882e-02
 analyze_tgpu[Hx]: ndim=46:3.427e-07GB T(cpu-gpu)=2.016e-03 speed=3.401e-04GB/S T(nccl)=6.349e-03 speed=1.080e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=40 t=7.5e-03 per=1.5e+01 cost=2.7e+05 flops=3.7e+07
 sigma[gemm] counter=40 i=0 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=4 t=7.4e-03 per=1.5e+01 cost=3.8e+04 flops=5.1e+06
 sigma[gemm] counter=40 i=5 t=7.7e-03 per=1.5e+01 cost=3.8e+04 flops=5.0e+06
 sigma[gemm] counter=40 i=6 t=7.6e-03 per=1.5e+01 cost=3.6e+04 flops=4.7e+06
 sigma[gemm] counter=40 i=7 t=7.6e-03 per=1.5e+01 cost=3.6e+04 flops=4.7e+06
 sigma[gemm] counter=40 total t=3.0e-02 per=6.0e+01 cost=1.5e+05 flops=4.9e+06
 sigma[red] counter=40 t=1.3e-02 per=2.5e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=2.2e-01 t_gemm=9.3e-01 t_reduction=4.5e-01 tot=1.6e+00 -----
 sigma_tot[inter] counter=40 t=2.2e-01 per=1.4e+01 cost=6.7e+06 flops=3.1e+07
 sigma_tot[gemm] counter=40 i=0 t=5.5e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=1 t=4.8e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=2 t=4.6e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=3 t=4.6e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=4 t=2.4e-01 per=1.5e+01 cost=5.3e+05 flops=2.3e+06
 sigma_tot[gemm] counter=40 i=5 t=2.4e-01 per=1.5e+01 cost=5.3e+05 flops=2.2e+06
 sigma_tot[gemm] counter=40 i=6 t=2.3e-01 per=1.4e+01 cost=8.6e+05 flops=3.7e+06
 sigma_tot[gemm] counter=40 i=7 t=2.3e-01 per=1.4e+01 cost=8.6e+05 flops=3.7e+06
 sigma_tot[gemm] counter=40 total t=9.3e-01 per=5.8e+01 cost=2.8e+06 flops=3.0e+06
 sigma_tot[red] counter=40 t=4.5e-01 per=2.8e+01 cost=1.2e+06 flops=2.7e+06
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.9e-06,6.0e-06,2.2e-06,1.3e-06,1.9e-07
settings: ndim=46 neig=1 maxcycle=30 nbuff=4 memory=5e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.158503434347 -1.116e+03  7.014e-02    1     1  5.901e-02 5.901e-02 5.897e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.170e-03,7.393e-03,2.971e-02,1.257e-02,5.885e-02
 analyze_tgpu[Hx]: ndim=46:3.427e-07GB T(cpu-gpu)=2.183e-03 speed=3.139e-04GB/S T(nccl)=6.986e-03 speed=9.811e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=41 t=7.4e-03 per=1.5e+01 cost=2.7e+05 flops=3.7e+07
 sigma[gemm] counter=41 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=4 t=7.4e-03 per=1.5e+01 cost=3.8e+04 flops=5.1e+06
 sigma[gemm] counter=41 i=5 t=7.4e-03 per=1.5e+01 cost=3.8e+04 flops=5.1e+06
 sigma[gemm] counter=41 i=6 t=7.4e-03 per=1.5e+01 cost=3.6e+04 flops=4.8e+06
 sigma[gemm] counter=41 i=7 t=7.4e-03 per=1.5e+01 cost=3.6e+04 flops=4.8e+06
 sigma[gemm] counter=41 total t=3.0e-02 per=6.0e+01 cost=1.5e+05 flops=5.0e+06
 sigma[red] counter=41 t=1.3e-02 per=2.5e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=2.2e-01 t_gemm=9.6e-01 t_reduction=4.7e-01 tot=1.6e+00 -----
 sigma_tot[inter] counter=41 t=2.2e-01 per=1.4e+01 cost=6.9e+06 flops=3.1e+07
 sigma_tot[gemm] counter=41 i=0 t=5.6e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=1 t=4.9e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=2 t=4.7e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=3 t=4.7e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=4 t=2.4e-01 per=1.5e+01 cost=5.7e+05 flops=2.3e+06
 sigma_tot[gemm] counter=41 i=5 t=2.4e-01 per=1.5e+01 cost=5.7e+05 flops=2.3e+06
 sigma_tot[gemm] counter=41 i=6 t=2.4e-01 per=1.4e+01 cost=8.9e+05 flops=3.8e+06
 sigma_tot[gemm] counter=41 i=7 t=2.4e-01 per=1.4e+01 cost=8.9e+05 flops=3.8e+06
 sigma_tot[gemm] counter=41 total t=9.6e-01 per=5.8e+01 cost=2.9e+06 flops=3.0e+06
 sigma_tot[red] counter=41 t=4.7e-01 per=2.8e+01 cost=1.3e+06 flops=2.7e+06
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=7.0e-06,2.2e-05,1.3e-05,1.5e-06,2.2e-07
    2   0 -    -116.173143414127 -1.464e-02  2.184e-02    2     2  1.182e-01 5.911e-02 5.901e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.179e-02,7.538e-03,3.010e-02,1.249e-02,6.192e-02
 analyze_tgpu[Hx]: ndim=46:3.427e-07GB T(cpu-gpu)=2.209e-03 speed=3.103e-04GB/S T(nccl)=9.582e-03 speed=7.154e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.0e-02 -----
 sigma[inter] counter=42 t=7.5e-03 per=1.5e+01 cost=2.7e+05 flops=3.6e+07
 sigma[gemm] counter=42 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=4 t=7.5e-03 per=1.5e+01 cost=3.8e+04 flops=5.1e+06
 sigma[gemm] counter=42 i=5 t=7.5e-03 per=1.5e+01 cost=3.8e+04 flops=5.1e+06
 sigma[gemm] counter=42 i=6 t=7.6e-03 per=1.5e+01 cost=3.6e+04 flops=4.7e+06
 sigma[gemm] counter=42 i=7 t=7.6e-03 per=1.5e+01 cost=3.6e+04 flops=4.7e+06
 sigma[gemm] counter=42 total t=3.0e-02 per=6.0e+01 cost=1.5e+05 flops=4.9e+06
 sigma[red] counter=42 t=1.2e-02 per=2.5e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=2.3e-01 t_gemm=9.9e-01 t_reduction=4.8e-01 tot=1.7e+00 -----
 sigma_tot[inter] counter=42 t=2.3e-01 per=1.4e+01 cost=7.2e+06 flops=3.1e+07
 sigma_tot[gemm] counter=42 i=0 t=5.7e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=1 t=5.0e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=2 t=4.9e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=3 t=4.8e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=4 t=2.5e-01 per=1.5e+01 cost=6.1e+05 flops=2.4e+06
 sigma_tot[gemm] counter=42 i=5 t=2.5e-01 per=1.5e+01 cost=6.1e+05 flops=2.4e+06
 sigma_tot[gemm] counter=42 i=6 t=2.4e-01 per=1.4e+01 cost=9.3e+05 flops=3.8e+06
 sigma_tot[gemm] counter=42 i=7 t=2.4e-01 per=1.4e+01 cost=9.3e+05 flops=3.8e+06
 sigma_tot[gemm] counter=42 total t=9.9e-01 per=5.8e+01 cost=3.1e+06 flops=3.1e+06
 sigma_tot[red] counter=42 t=4.8e-01 per=2.8e+01 cost=1.3e+06 flops=2.8e+06
T(sub)=4.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,2.1e-05,3.1e-06,1.1e-05,1.9e-07
    3   0 -    -116.175079841582 -1.936e-03  8.976e-03    3     3  1.804e-01 6.014e-02 6.004e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.600e-03,7.449e-03,3.008e-02,1.276e-02,5.889e-02
 analyze_tgpu[Hx]: ndim=46:3.427e-07GB T(cpu-gpu)=2.142e-03 speed=3.200e-04GB/S T(nccl)=6.458e-03 speed=1.061e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=43 t=7.4e-03 per=1.5e+01 cost=2.7e+05 flops=3.7e+07
 sigma[gemm] counter=43 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=4 t=7.5e-03 per=1.5e+01 cost=3.8e+04 flops=5.1e+06
 sigma[gemm] counter=43 i=5 t=7.7e-03 per=1.5e+01 cost=3.8e+04 flops=5.0e+06
 sigma[gemm] counter=43 i=6 t=7.4e-03 per=1.5e+01 cost=3.6e+04 flops=4.8e+06
 sigma[gemm] counter=43 i=7 t=7.5e-03 per=1.5e+01 cost=3.6e+04 flops=4.8e+06
 sigma[gemm] counter=43 total t=3.0e-02 per=6.0e+01 cost=1.5e+05 flops=4.9e+06
 sigma[red] counter=43 t=1.3e-02 per=2.5e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=2.4e-01 t_gemm=1.0e+00 t_reduction=4.9e-01 tot=1.7e+00 -----
 sigma_tot[inter] counter=43 t=2.4e-01 per=1.4e+01 cost=7.5e+06 flops=3.1e+07
 sigma_tot[gemm] counter=43 i=0 t=5.8e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=1 t=5.2e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=2 t=5.0e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=3 t=5.0e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=4 t=2.6e-01 per=1.5e+01 cost=6.4e+05 flops=2.5e+06
 sigma_tot[gemm] counter=43 i=5 t=2.6e-01 per=1.5e+01 cost=6.5e+05 flops=2.5e+06
 sigma_tot[gemm] counter=43 i=6 t=2.5e-01 per=1.4e+01 cost=9.6e+05 flops=3.8e+06
 sigma_tot[gemm] counter=43 i=7 t=2.5e-01 per=1.4e+01 cost=9.6e+05 flops=3.8e+06
 sigma_tot[gemm] counter=43 total t=1.0e+00 per=5.8e+01 cost=3.2e+06 flops=3.2e+06
 sigma_tot[red] counter=43 t=4.9e-01 per=2.8e+01 cost=1.4e+06 flops=2.8e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.4e-05,3.0e-06,1.0e-06,2.3e-07
    4   0 -    -116.175347345860 -2.675e-04  2.873e-03    3     4  2.396e-01 5.990e-02 5.980e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.257e-03,7.436e-03,3.009e-02,1.270e-02,5.948e-02
 analyze_tgpu[Hx]: ndim=46:3.427e-07GB T(cpu-gpu)=2.207e-03 speed=3.105e-04GB/S T(nccl)=7.050e-03 speed=9.723e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=44 t=7.4e-03 per=1.5e+01 cost=2.7e+05 flops=3.7e+07
 sigma[gemm] counter=44 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=4 t=7.4e-03 per=1.5e+01 cost=3.8e+04 flops=5.1e+06
 sigma[gemm] counter=44 i=5 t=7.5e-03 per=1.5e+01 cost=3.8e+04 flops=5.0e+06
 sigma[gemm] counter=44 i=6 t=7.5e-03 per=1.5e+01 cost=3.6e+04 flops=4.8e+06
 sigma[gemm] counter=44 i=7 t=7.6e-03 per=1.5e+01 cost=3.6e+04 flops=4.7e+06
 sigma[gemm] counter=44 total t=3.0e-02 per=6.0e+01 cost=1.5e+05 flops=4.9e+06
 sigma[red] counter=44 t=1.3e-02 per=2.5e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=2.5e-01 t_gemm=1.0e+00 t_reduction=5.0e-01 tot=1.8e+00 -----
 sigma_tot[inter] counter=44 t=2.5e-01 per=1.4e+01 cost=7.7e+06 flops=3.1e+07
 sigma_tot[gemm] counter=44 i=0 t=6.0e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=1 t=5.3e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=2 t=5.1e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=3 t=5.1e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=4 t=2.7e-01 per=1.5e+01 cost=6.8e+05 flops=2.6e+06
 sigma_tot[gemm] counter=44 i=5 t=2.7e-01 per=1.5e+01 cost=6.8e+05 flops=2.6e+06
 sigma_tot[gemm] counter=44 i=6 t=2.6e-01 per=1.4e+01 cost=1.0e+06 flops=3.9e+06
 sigma_tot[gemm] counter=44 i=7 t=2.6e-01 per=1.4e+01 cost=1.0e+06 flops=3.9e+06
 sigma_tot[gemm] counter=44 total t=1.0e+00 per=5.8e+01 cost=3.4e+06 flops=3.2e+06
 sigma_tot[red] counter=44 t=5.0e-01 per=2.8e+01 cost=1.4e+06 flops=2.8e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.3e-05,3.0e-06,9.7e-07,2.3e-07
    5   0 -    -116.175371242913 -2.390e-05  1.005e-03    3     5  2.993e-01 5.986e-02 5.977e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.202e-02,7.450e-03,3.003e-02,1.257e-02,6.208e-02
 analyze_tgpu[Hx]: ndim=46:3.427e-07GB T(cpu-gpu)=2.323e-03 speed=2.951e-04GB/S T(nccl)=9.701e-03 speed=7.066e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=45 t=7.4e-03 per=1.5e+01 cost=2.7e+05 flops=3.7e+07
 sigma[gemm] counter=45 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=4 t=7.6e-03 per=1.5e+01 cost=3.8e+04 flops=5.0e+06
 sigma[gemm] counter=45 i=5 t=7.6e-03 per=1.5e+01 cost=3.8e+04 flops=5.0e+06
 sigma[gemm] counter=45 i=6 t=7.4e-03 per=1.5e+01 cost=3.6e+04 flops=4.8e+06
 sigma[gemm] counter=45 i=7 t=7.4e-03 per=1.5e+01 cost=3.6e+04 flops=4.8e+06
 sigma[gemm] counter=45 total t=3.0e-02 per=6.0e+01 cost=1.5e+05 flops=4.9e+06
 sigma[red] counter=45 t=1.3e-02 per=2.5e+01 cost=4.1e+04 flops=3.3e+06
----- TIMING FOR sigma_tot : t_inter=2.5e-01 t_gemm=1.1e+00 t_reduction=5.2e-01 tot=1.9e+00 -----
 sigma_tot[inter] counter=45 t=2.5e-01 per=1.4e+01 cost=8.0e+06 flops=3.2e+07
 sigma_tot[gemm] counter=45 i=0 t=6.1e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=1 t=5.4e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=2 t=5.2e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=3 t=5.2e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=4 t=2.7e-01 per=1.5e+01 cost=7.2e+05 flops=2.6e+06
 sigma_tot[gemm] counter=45 i=5 t=2.7e-01 per=1.5e+01 cost=7.2e+05 flops=2.6e+06
 sigma_tot[gemm] counter=45 i=6 t=2.7e-01 per=1.4e+01 cost=1.0e+06 flops=3.9e+06
 sigma_tot[gemm] counter=45 i=7 t=2.7e-01 per=1.4e+01 cost=1.0e+06 flops=3.9e+06
 sigma_tot[gemm] counter=45 total t=1.1e+00 per=5.8e+01 cost=3.5e+06 flops=3.3e+06
 sigma_tot[red] counter=45 t=5.2e-01 per=2.8e+01 cost=1.4e+06 flops=2.8e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.3e-05,3.1e-06,1.1e-06,2.1e-07
    6   0 -    -116.175373629902 -2.387e-06  2.493e-04    3     6  3.616e-01 6.027e-02 6.018e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.851e-03,7.583e-03,3.030e-02,1.281e-02,5.955e-02
 analyze_tgpu[Hx]: ndim=46:3.427e-07GB T(cpu-gpu)=2.241e-03 speed=3.059e-04GB/S T(nccl)=6.611e-03 speed=1.037e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=46 t=7.6e-03 per=1.5e+01 cost=2.7e+05 flops=3.6e+07
 sigma[gemm] counter=46 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=4 t=7.5e-03 per=1.5e+01 cost=3.8e+04 flops=5.0e+06
 sigma[gemm] counter=46 i=5 t=7.6e-03 per=1.5e+01 cost=3.8e+04 flops=5.0e+06
 sigma[gemm] counter=46 i=6 t=7.6e-03 per=1.5e+01 cost=3.6e+04 flops=4.7e+06
 sigma[gemm] counter=46 i=7 t=7.6e-03 per=1.5e+01 cost=3.6e+04 flops=4.7e+06
 sigma[gemm] counter=46 total t=3.0e-02 per=6.0e+01 cost=1.5e+05 flops=4.9e+06
 sigma[red] counter=46 t=1.3e-02 per=2.5e+01 cost=4.1e+04 flops=3.2e+06
----- TIMING FOR sigma_tot : t_inter=2.6e-01 t_gemm=1.1e+00 t_reduction=5.3e-01 tot=1.9e+00 -----
 sigma_tot[inter] counter=46 t=2.6e-01 per=1.4e+01 cost=8.3e+06 flops=3.2e+07
 sigma_tot[gemm] counter=46 i=0 t=6.2e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=1 t=5.5e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=2 t=5.3e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=3 t=5.3e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=4 t=2.8e-01 per=1.5e+01 cost=7.6e+05 flops=2.7e+06
 sigma_tot[gemm] counter=46 i=5 t=2.8e-01 per=1.5e+01 cost=7.6e+05 flops=2.7e+06
 sigma_tot[gemm] counter=46 i=6 t=2.7e-01 per=1.4e+01 cost=1.1e+06 flops=3.9e+06
 sigma_tot[gemm] counter=46 i=7 t=2.7e-01 per=1.4e+01 cost=1.1e+06 flops=3.9e+06
 sigma_tot[gemm] counter=46 total t=1.1e+00 per=5.8e+01 cost=3.7e+06 flops=3.3e+06
 sigma_tot[red] counter=46 t=5.3e-01 per=2.8e+01 cost=1.5e+06 flops=2.8e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.3e-05,3.0e-06,9.9e-07,2.0e-07
    7   0 +    -116.175373766822 -1.369e-07  4.969e-05    3     7  4.214e-01 6.021e-02 6.012e-02
TIMING FOR Davidson : 4.215e-01  T(cal/comm/rest)=4.208e-01,6.646e-06,6.113e-04
decomposed t_rest=6.113e-04
 T(sub)    =1.870e-04 per=3.058e+01
 T(precond)=5.126e-05 per=8.386e+00
 T(ortho)  =1.415e-05 per=2.315e+00
 T(xcopy)  =9.150e-07 per=1.497e-01
 T(xnrm2)  =3.069e-06 per=5.020e-01
 T(other)  =3.549e-04 per=5.806e+01
optimized energies: isweep=0 ibond=9 dots=2 e[0]=-116.175373766822 nmvp=7
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=7.553e-04 change=1.526e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=13 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond9.txt
 qbond: qsuper nsym=13 dimAll=40
 (15,3):8 (17,3):3 (16,2):6 (16,4):6 (14,2):3 (15,1):3 (14,4):3 (15,5):3 (17,1):1 (16,0):1 (13,3):1 (17,5):1 (16,6):1
timing for divide=6.5e-05
timing for compute=6.6e-05
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(su2): 1.5e-04 S T(divide/compute[cpu/gpu/rest]/collect)=6.5e-05,5.9e-05,0.0e+00,7.1e-06,1.5e-05 -----
decimation summary: 40->8 dwt=+4.441e-16 SvN=5.409e-01
 qbond: qkept nsym=4 dimAll=8
 (15,3):2 (17,3):2 (16,2):2 (16,4):2
----- TIMING for decimation_row(nkr): 5.818e-04 S T(decim/select/formRot)=2.817e-04,2.219e-04,7.823e-05 -----
----- TIMING FOR twodot_decimation: 8.351e-04 S T(wf/decim)=2.373e-04,5.979e-04 -----
ctns::oper_renorm coord=(10,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:11 S:5 P:40 Q:44 
        dim(bra,ket)=8,8 size(op)=24:1.831e-04MB size(tot)=1312:1.001e-02MB:9.775e-06GB
        per(mem): H:1.22 C:13.4 S:6.1 P:12.2 Q:67.1 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=7.553e-04 change=1.485e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=96 : 3.051e-03 S -----
rank=0 GPUmem(GB): used=6.209e-05 (oper)=3.354e-05
rank=0 GPUmem(GB): used=6.243e-05 (oper,site)=3.354e-05,3.427e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=96
 no. of rintermediate operators=128
 no. of coefficients=1280:9.766e-03MB:9.537e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.476e-03 S -----
rank=0 GPUmem(GB): used=7.197e-05 (oper,site,rinter)=3.354e-05,3.427e-07,9.537e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.514e-02 S size(rtasks)=96 size(Rlst2)=16 T(Rmu/Rlist)=7.587e-04,2.438e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.557e-02 S size(rtasks)=96 size(Rlst)=2372 -----
rank=0 GPUmem(GB): used=7.197e-05 avail=6.231e+00 total=6.231e+00 batch[need]=3.358e-04 blksize=6 blksize0=6 batchsize=2372
rank=0 GPUmem(GB): used=4.077e-04 (oper,site,rinter,batch)=3.354e-05,3.427e-07,9.537e-06,3.358e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.687e-03,2.260e-02,9.992e-03
----- TIMING FOR renorm : t_inter=5.7e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=136 t=5.7e-03 per=1.5e+01 cost=7.6e+04 flops=1.3e+07
 renorm[gemm] counter=136 i=0 t=1.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=136 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=136 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=136 i=3 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=136 i=4 t=7.5e-03 per=2.0e+01 cost=9.7e+03 flops=1.3e+06
 renorm[gemm] counter=136 i=5 t=7.6e-03 per=2.0e+01 cost=2.5e+04 flops=3.3e+06
 renorm[gemm] counter=136 i=6 t=7.5e-03 per=2.0e+01 cost=4.0e+04 flops=5.3e+06
 renorm[gemm] counter=136 total t=2.3e-02 per=5.9e+01 cost=7.4e+04 flops=3.3e+06
 renorm[red] counter=136 t=1.0e-02 per=2.6e+01 cost=1.9e+04 flops=1.9e+06
----- TIMING FOR renorm_tot : t_inter=6.4e-02 t_gemm=2.2e-01 t_reduction=1.0e-01 tot=3.9e-01 -----
 renorm_tot[inter] counter=136 t=6.4e-02 per=1.6e+01 cost=1.9e+05 flops=3.0e+06
 renorm_tot[gemm] counter=136 i=0 t=1.4e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=136 i=1 t=1.2e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=136 i=2 t=1.1e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=136 i=3 t=1.1e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=136 i=4 t=7.5e-02 per=1.9e+01 cost=2.4e+04 flops=3.3e+05
 renorm_tot[gemm] counter=136 i=5 t=7.5e-02 per=1.9e+01 cost=8.4e+04 flops=1.1e+06
 renorm_tot[gemm] counter=136 i=6 t=7.5e-02 per=1.9e+01 cost=1.4e+05 flops=1.8e+06
 renorm_tot[gemm] counter=136 total t=2.2e-01 per=5.8e+01 cost=2.4e+05 flops=1.1e+06
 renorm_tot[red] counter=136 t=1.0e-01 per=2.6e+01 cost=8.3e+04 flops=8.3e+05
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=7.286e-05 (optmp,oper)=1.192e-07,3.354e-05
rank=0 GPUmem(GB): used=7.320e-05 (optmp,oper,site,rinter)=1.192e-07,3.354e-05,3.427e-07,1.118e-06
rank=0 GPUmem(GB): used=8.056e-05 (optmp,oper,site,rinter,batch)=1.192e-07,3.354e-05,3.427e-07,1.118e-06,7.361e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 3.582e-01 S T(prep/alloc/comp/red/dealloc)=1.015e-02,1.374e-02,3.195e-01,2.247e-02,2.513e-03 -----
----- TIMING FOR oper_renorm_opS : 3.583e-01 S rank=0 -----
qops.to_cpu: size(tot)=1312:1.001e-02MB:9.775e-06GB T(to_cpu)=1.483e-04S speed=6.593e-02GB/S
check ||H-H.dagger||=6.111e-15 coord=(10,0) rank=0
----- TIMING FOR oper_renorm : 0.449 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.518e-04 change=7.306e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.869e-03 change=-1.876e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.869e-03 change=-3.710e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.586e+00 S #####
 T(local opt: fetch) = 9.978e-03 S  per = 0.629  per(accum) = 0.629
 T(local opt: hdiag) = 5.781e-01 S  per = 36.4  per(accum) = 37.1
 T(local opt: dvdsn) = 5.453e-01 S  per = 34.4  per(accum) = 71.4
 T(local opt: decim) = 9.557e-04 S  per = 0.0602  per(accum) = 71.5
 T(local opt: guess) = 3.931e-04 S  per = 0.0248  per(accum) = 71.5
 T(local opt: renrm) = 4.514e-01 S  per = 28.5  per(accum) = 100
 T(local opt: save ) = 2.549e-04 S  per = 0.0161  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.453e-01 S  T(sum) = 5.447e-01 S  per = 9.990e+01
 T(local opt: preprocess                  ) = 1.318e-03 S  per = 0.242  per(accum) = 0.242
 T(local opt: symbolic_formulae           ) = 6.055e-03 S  per = 1.11  per(accum) = 1.35
 T(local opt: hintermediate init          ) = 2.859e-04 S  per = 0.0525  per(accum) = 1.41
 T(local opt: preprocess_hformulae_Hxlist ) = 8.174e-02 S  per =   15  per(accum) = 16.4
 T(local opt: hmmtasks init               ) = 3.322e-02 S  per =  6.1  per(accum) = 22.5
 T(local opt: initial guess for dvdson    ) = 6.071e-04 S  per = 0.111  per(accum) = 22.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.528e-01 S  per = 64.8  per(accum) = 87.4
 T(local opt: dvdson [cpu-gpu]            ) = 1.532e-02 S  per = 2.81  per(accum) = 90.2
 T(local opt: dvdson [nccl]               ) = 5.274e-02 S  per = 9.68  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 6.646e-06 S  per = 0.00122  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 6.113e-04 S  per = 0.112  per(accum) = 100
Detailed decomposition of T(renrm) = 4.514e-01 S  T(sum) = 4.514e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.559e-04 S  per = 0.0567  per(accum) = 0.0567
 T(local opt: qops init                    ) = 2.006e-03 S  per = 0.444  per(accum) = 0.501
 T(local opt: symbolic_formulae_renorm     ) = 3.065e-03 S  per = 0.679  per(accum) = 1.18
 T(local opt: allocate qops on gpu         ) = 6.450e-05 S  per = 0.0143  per(accum) = 1.19
 T(local opt: site memcpy cpu2gpu          ) = 1.240e-03 S  per = 0.275  per(accum) = 1.47
 T(local opt: rintermediate init           ) = 2.491e-03 S  per = 0.552  per(accum) = 2.02
 T(local opt: preprocess_formulae_Rlist2   ) = 2.566e-02 S  per = 5.68  per(accum) = 7.7
 T(local opt: rmmtasks init                ) = 1.481e-02 S  per = 3.28  per(accum) = 11
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 7.75e-06  per(accum) = 11
 T(local opt: preprocess_renorm_batchGPU   ) = 3.847e-02 S  per = 8.52  per(accum) = 19.5
 T(local opt: deallocate cpu and gpu memory) = 9.562e-05 S  per = 0.0212  per(accum) = 19.5
 T(local opt: construct opS [ifdists=true] ) = 3.584e-01 S  per = 79.4  per(accum) = 98.9
 T(local opt: reduction of opS & opH [nccl]) = 2.322e-03 S  per = 0.514  per(accum) = 99.4
 T(local opt: qops memcpy gpu2cpu          ) = 1.602e-04 S  per = 0.0355  per(accum) = 99.5
 T(local opt: reduction of opS & opH [mpi] ) = 4.160e-05 S  per = 0.00921  per(accum) = 99.5
 T(local opt: qops_pool join and erase     ) = 2.381e-03 S  per = 0.527  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.955e-06 S  per = 0.00198  per(accum) = 100
##### sweep opt: 1.451e+01 S #####
 T(sweep opt: fetch) = 1.308e-01 S  per = 0.901  per(accum) = 0.901
 T(sweep opt: hdiag) = 3.169e+00 S  per = 21.8  per(accum) = 22.7
 T(sweep opt: dvdsn) = 4.419e+00 S  per = 30.5  per(accum) = 53.2
 T(sweep opt: decim) = 1.238e-02 S  per = 0.0853  per(accum) = 53.3
 T(sweep opt: guess) = 7.990e-03 S  per = 0.055  per(accum) = 53.3
 T(sweep opt: renrm) = 6.771e+00 S  per = 46.7  per(accum) = 100
 T(sweep opt: save ) = 2.190e-03 S  per = 0.0151  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.419e+00 S  T(sum) = 4.414e+00 S  per = 9.987e+01
 T(sweep opt: preprocess                  ) = 3.753e-02 S  per = 0.85  per(accum) = 0.85
 T(sweep opt: symbolic_formulae           ) = 3.931e-02 S  per = 0.891  per(accum) = 1.74
 T(sweep opt: hintermediate init          ) = 2.036e-03 S  per = 0.0461  per(accum) = 1.79
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.390e+00 S  per = 31.5  per(accum) = 33.3
 T(sweep opt: hmmtasks init               ) = 5.704e-01 S  per = 12.9  per(accum) = 46.2
 T(sweep opt: initial guess for dvdson    ) = 1.051e-02 S  per = 0.238  per(accum) = 46.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.910e+00 S  per = 43.3  per(accum) = 89.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 8.861e-02 S  per = 2.01  per(accum) = 91.7
 T(sweep opt: dvdson [nccl]               ) = 3.606e-01 S  per = 8.17  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 3.198e-05 S  per = 0.000724  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 4.841e-03 S  per = 0.11  per(accum) = 100
Detailed decomposition of T(renrm) = 6.771e+00 S  T(sum) = 6.771e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.962e-03 S  per = 0.0437  per(accum) = 0.0437
 T(sweep opt: qops init                    ) = 2.836e-02 S  per = 0.419  per(accum) = 0.463
 T(sweep opt: symbolic_formulae_renorm     ) = 9.545e-03 S  per = 0.141  per(accum) = 0.603
 T(sweep opt: allocate qops on gpu         ) = 6.798e-04 S  per = 0.01  per(accum) = 0.614
 T(sweep opt: site memcpy cpu2gpu          ) = 1.191e-02 S  per = 0.176  per(accum) = 0.789
 T(sweep opt: rintermediate init           ) = 2.246e-02 S  per = 0.332  per(accum) = 1.12
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.722e-01 S  per = 2.54  per(accum) = 3.66
 T(sweep opt: rmmtasks init                ) = 8.563e-02 S  per = 1.26  per(accum) = 4.93
 T(sweep opt: qops memset on cpu           ) = 3.900e-07 S  per = 5.76e-06  per(accum) = 4.93
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.906e-01 S  per = 5.77  per(accum) = 10.7
 T(sweep opt: deallocate cpu and gpu memory) = 7.395e-04 S  per = 0.0109  per(accum) = 10.7
 T(sweep opt: construct opS [ifdists=true] ) = 5.899e+00 S  per = 87.1  per(accum) = 97.8
 T(sweep opt: reduction of opS & opH [nccl]) = 2.240e-02 S  per = 0.331  per(accum) = 98.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.021e-03 S  per = 0.0151  per(accum) = 98.2
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.203e-04 S  per = 0.00916  per(accum) = 98.2
 T(sweep opt: qops_pool join and erase     ) = 2.072e-02 S  per = 0.306  per(accum) = 98.5
 T(sweep opt: conversion from opAB to opPQ ) = 1.026e-01 S  per = 1.52  per(accum) = 100
##### global opt: 1.451e+01 S #####
 T(global opt: fetch) = 1.308e-01 S  per = 0.901  per(accum) = 0.901
 T(global opt: hdiag) = 3.169e+00 S  per = 21.8  per(accum) = 22.7
 T(global opt: dvdsn) = 4.419e+00 S  per = 30.5  per(accum) = 53.2
 T(global opt: decim) = 1.238e-02 S  per = 0.0853  per(accum) = 53.3
 T(global opt: guess) = 7.990e-03 S  per = 0.055  per(accum) = 53.3
 T(global opt: renrm) = 6.771e+00 S  per = 46.7  per(accum) = 100
 T(global opt: save ) = 2.190e-03 S  per = 0.0151  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.419e+00 S  T(sum) = 4.414e+00 S  per = 9.987e+01
 T(global opt: preprocess                  ) = 3.753e-02 S  per = 0.85  per(accum) = 0.85
 T(global opt: symbolic_formulae           ) = 3.931e-02 S  per = 0.891  per(accum) = 1.74
 T(global opt: hintermediate init          ) = 2.036e-03 S  per = 0.0461  per(accum) = 1.79
 T(global opt: preprocess_hformulae_Hxlist ) = 1.390e+00 S  per = 31.5  per(accum) = 33.3
 T(global opt: hmmtasks init               ) = 5.704e-01 S  per = 12.9  per(accum) = 46.2
 T(global opt: initial guess for dvdson    ) = 1.051e-02 S  per = 0.238  per(accum) = 46.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.910e+00 S  per = 43.3  per(accum) = 89.7
 T(global opt: dvdson [cpu-gpu]            ) = 8.861e-02 S  per = 2.01  per(accum) = 91.7
 T(global opt: dvdson [nccl]               ) = 3.606e-01 S  per = 8.17  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 3.198e-05 S  per = 0.000724  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 4.841e-03 S  per = 0.11  per(accum) = 100
Detailed decomposition of T(renrm) = 6.771e+00 S  T(sum) = 6.771e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.962e-03 S  per = 0.0437  per(accum) = 0.0437
 T(global opt: qops init                    ) = 2.836e-02 S  per = 0.419  per(accum) = 0.463
 T(global opt: symbolic_formulae_renorm     ) = 9.545e-03 S  per = 0.141  per(accum) = 0.603
 T(global opt: allocate qops on gpu         ) = 6.798e-04 S  per = 0.01  per(accum) = 0.614
 T(global opt: site memcpy cpu2gpu          ) = 1.191e-02 S  per = 0.176  per(accum) = 0.789
 T(global opt: rintermediate init           ) = 2.246e-02 S  per = 0.332  per(accum) = 1.12
 T(global opt: preprocess_formulae_Rlist2   ) = 1.722e-01 S  per = 2.54  per(accum) = 3.66
 T(global opt: rmmtasks init                ) = 8.563e-02 S  per = 1.26  per(accum) = 4.93
 T(global opt: qops memset on cpu           ) = 3.900e-07 S  per = 5.76e-06  per(accum) = 4.93
 T(global opt: preprocess_renorm_batchGPU   ) = 3.906e-01 S  per = 5.77  per(accum) = 10.7
 T(global opt: deallocate cpu and gpu memory) = 7.395e-04 S  per = 0.0109  per(accum) = 10.7
 T(global opt: construct opS [ifdists=true] ) = 5.899e+00 S  per = 87.1  per(accum) = 97.8
 T(global opt: reduction of opS & opH [nccl]) = 2.240e-02 S  per = 0.331  per(accum) = 98.2
 T(global opt: qops memcpy gpu2cpu          ) = 1.021e-03 S  per = 0.0151  per(accum) = 98.2
 T(global opt: reduction of opS & opH [mpi] ) = 6.203e-04 S  per = 0.00916  per(accum) = 98.2
 T(global opt: qops_pool join and erase     ) = 2.072e-02 S  per = 0.306  per(accum) = 98.5
 T(global opt: conversion from opAB to opPQ ) = 1.026e-01 S  per = 1.52  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.515e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=10/seqsize=34 dots=2 dbond=(11,0)-(12,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=283:2.159e-03MB:2.109e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=16:1.221e-04MB:1.192e-07GB
total mem of comb=300:2.289e-03MB:2.235e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=11,7,1,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc1= 7
 suppc2= 8
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:11 S:5 P:40 Q:44 
        dim(bra,ket)=8,8 size(op)=24:1.831e-04MB size(tot)=1312:1.001e-02MB:9.775e-06GB
        per(mem): H:1.22 C:13.4 S:6.1 P:12.2 Q:67.1 
 rqops: oplist=HCSAB nops=H:1 C:7 S:6 A:23 B:28 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=116:0.000885MB:8.64e-07GB
        per(mem): H:3.45 C:0 S:0 A:0 B:96.6 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3424:0.0261MB:2.55e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.274e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(11,0) fdel=./scratch/sweep/rop(12,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-5.364e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(8,2,3,3) nnz=36:2.747e-04MB
qtensor4: wf4 own=1 _data=0x46812000
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=8
 (15,3):2 (17,3):2 (16,2):2 (16,4):2
 qbond: qcol nsym=1 dimAll=2
 (11,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=9 nblocks=64 size=36:2.747e-04MB
### DIAG TIMING: total=3.452e-01 t1=2.528e-05, t2=1.816e-03, t3=2.539e-03, t4=3.367e-01, t5=3.611e-06, t6=4.105e-03, t7=4.435e-06
duration_diagGPU:3.452e-01
duration_diagreduce:6.600e-08
duration_diagtransform:3.850e-07
----- TIMING FOR symbolic_formulae_twodot with size=398 : 5.325e-03 S -----
rank=0 GPUmem(GB): used=2.551e-05 (oper)=2.551e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=398
 no. of hintermediate operators=212
 no. of coefficients=2490:1.900e-02MB:1.855e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.523e-04 S -----
rank=0 GPUmem(GB): used=4.406e-05 (oper,hinter)=2.551e-05,1.855e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.862e-02 S size(H_formulae)=398 size(Hxlst2)=9 T(Hmu/Hxlist)=1.065e-03,4.755e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.912e-02 S size(H_formulae)=398 size(Hxlst)=2994 -----
rank=0 GPUmem(GB): used=4.406e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=5.364e-07 batch[need]=2.900e-04 blksize=4 blksize0=4 batchsize=2994
rank=0 GPUmem(GB): used=3.346e-04 (oper,hinter,dvdson,batch)=2.551e-05,1.855e-05,5.364e-07,2.900e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=36 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.009e-03,7.424e-03,2.991e-02,1.271e-02,5.907e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=1.985e-03 speed=2.703e-04GB/S T(nccl)=7.024e-03 speed=7.637e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=47 t=7.4e-03 per=1.5e+01 cost=1.6e+05 flops=2.2e+07
 sigma[gemm] counter=47 i=0 t=1.5e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=4 t=7.4e-03 per=1.5e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=47 i=5 t=7.5e-03 per=1.5e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=47 i=6 t=7.5e-03 per=1.5e+01 cost=1.9e+04 flops=2.6e+06
 sigma[gemm] counter=47 i=7 t=7.5e-03 per=1.5e+01 cost=1.9e+04 flops=2.6e+06
 sigma[gemm] counter=47 total t=3.0e-02 per=6.0e+01 cost=8.1e+04 flops=2.7e+06
 sigma[red] counter=47 t=1.3e-02 per=2.5e+01 cost=2.4e+04 flops=1.9e+06
----- TIMING FOR sigma_tot : t_inter=2.7e-01 t_gemm=1.1e+00 t_reduction=5.4e-01 tot=2.0e+00 -----
 sigma_tot[inter] counter=47 t=2.7e-01 per=1.4e+01 cost=8.5e+06 flops=3.1e+07
 sigma_tot[gemm] counter=47 i=0 t=6.4e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=1 t=5.6e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=2 t=5.4e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=3 t=5.4e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=4 t=2.9e-01 per=1.5e+01 cost=7.8e+05 flops=2.7e+06
 sigma_tot[gemm] counter=47 i=5 t=2.9e-01 per=1.5e+01 cost=7.8e+05 flops=2.7e+06
 sigma_tot[gemm] counter=47 i=6 t=2.8e-01 per=1.4e+01 cost=1.1e+06 flops=3.9e+06
 sigma_tot[gemm] counter=47 i=7 t=2.8e-01 per=1.4e+01 cost=1.1e+06 flops=3.9e+06
 sigma_tot[gemm] counter=47 total t=1.1e+00 per=5.8e+01 cost=3.7e+06 flops=3.3e+06
 sigma_tot[red] counter=47 t=5.4e-01 per=2.8e+01 cost=1.5e+06 flops=2.8e+06
T(sub)=1.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.1e-06,6.4e-06,2.2e-06,9.5e-07,2.2e-07
settings: ndim=36 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.175373766822 -1.116e+03  5.099e-02    1     1  5.930e-02 5.930e-02 5.926e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.059e-03,7.510e-03,2.998e-02,1.250e-02,5.906e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.220e-03 speed=2.416e-04GB/S T(nccl)=6.839e-03 speed=7.844e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=48 t=7.5e-03 per=1.5e+01 cost=1.6e+05 flops=2.2e+07
 sigma[gemm] counter=48 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=4 t=7.4e-03 per=1.5e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=48 i=5 t=7.6e-03 per=1.5e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=48 i=6 t=7.5e-03 per=1.5e+01 cost=1.9e+04 flops=2.6e+06
 sigma[gemm] counter=48 i=7 t=7.4e-03 per=1.5e+01 cost=1.9e+04 flops=2.6e+06
 sigma[gemm] counter=48 total t=3.0e-02 per=6.0e+01 cost=8.1e+04 flops=2.7e+06
 sigma[red] counter=48 t=1.3e-02 per=2.5e+01 cost=2.4e+04 flops=1.9e+06
----- TIMING FOR sigma_tot : t_inter=2.8e-01 t_gemm=1.2e+00 t_reduction=5.5e-01 tot=2.0e+00 -----
 sigma_tot[inter] counter=48 t=2.8e-01 per=1.4e+01 cost=8.6e+06 flops=3.1e+07
 sigma_tot[gemm] counter=48 i=0 t=6.5e-05 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=1 t=5.7e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=2 t=5.5e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=3 t=5.5e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=4 t=2.9e-01 per=1.5e+01 cost=8.0e+05 flops=2.7e+06
 sigma_tot[gemm] counter=48 i=5 t=3.0e-01 per=1.5e+01 cost=8.0e+05 flops=2.7e+06
 sigma_tot[gemm] counter=48 i=6 t=2.9e-01 per=1.4e+01 cost=1.1e+06 flops=3.8e+06
 sigma_tot[gemm] counter=48 i=7 t=2.9e-01 per=1.4e+01 cost=1.1e+06 flops=3.8e+06
 sigma_tot[gemm] counter=48 total t=1.2e+00 per=5.8e+01 cost=3.8e+06 flops=3.3e+06
 sigma_tot[red] counter=48 t=5.5e-01 per=2.8e+01 cost=1.5e+06 flops=2.8e+06
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.7e-05,3.9e-06,1.0e-06,2.1e-07
    2   0 -    -116.190279545552 -1.491e-02  1.917e-02    2     2  1.187e-01 5.934e-02 5.926e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.000e-03,7.610e-03,3.015e-02,1.266e-02,5.943e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.217e-03 speed=2.419e-04GB/S T(nccl)=6.783e-03 speed=7.909e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=49 t=7.6e-03 per=1.5e+01 cost=1.6e+05 flops=2.1e+07
 sigma[gemm] counter=49 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=4 t=7.5e-03 per=1.5e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=49 i=5 t=7.6e-03 per=1.5e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=49 i=6 t=7.5e-03 per=1.5e+01 cost=1.9e+04 flops=2.6e+06
 sigma[gemm] counter=49 i=7 t=7.6e-03 per=1.5e+01 cost=1.9e+04 flops=2.6e+06
 sigma[gemm] counter=49 total t=3.0e-02 per=6.0e+01 cost=8.1e+04 flops=2.7e+06
 sigma[red] counter=49 t=1.3e-02 per=2.5e+01 cost=2.4e+04 flops=1.9e+06
----- TIMING FOR sigma_tot : t_inter=2.8e-01 t_gemm=1.2e+00 t_reduction=5.7e-01 tot=2.1e+00 -----
 sigma_tot[inter] counter=49 t=2.8e-01 per=1.4e+01 cost=8.8e+06 flops=3.1e+07
 sigma_tot[gemm] counter=49 i=0 t=6.7e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=1 t=5.9e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=2 t=5.7e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=3 t=5.6e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=4 t=3.0e-01 per=1.5e+01 cost=8.2e+05 flops=2.7e+06
 sigma_tot[gemm] counter=49 i=5 t=3.1e-01 per=1.5e+01 cost=8.2e+05 flops=2.7e+06
 sigma_tot[gemm] counter=49 i=6 t=3.0e-01 per=1.4e+01 cost=1.1e+06 flops=3.8e+06
 sigma_tot[gemm] counter=49 i=7 t=3.0e-01 per=1.4e+01 cost=1.1e+06 flops=3.8e+06
 sigma_tot[gemm] counter=49 total t=1.2e+00 per=5.8e+01 cost=3.9e+06 flops=3.3e+06
 sigma_tot[red] counter=49 t=5.7e-01 per=2.8e+01 cost=1.6e+06 flops=2.8e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.7e-05,3.2e-06,1.1e-06,2.3e-07
    3   0 -    -116.191627678608 -1.348e-03  5.984e-03    3     3  1.784e-01 5.947e-02 5.939e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.859e-03,7.426e-03,3.018e-02,1.261e-02,5.909e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.160e-03 speed=2.483e-04GB/S T(nccl)=6.699e-03 speed=8.008e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=50 t=7.4e-03 per=1.5e+01 cost=1.6e+05 flops=2.2e+07
 sigma[gemm] counter=50 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=4 t=7.4e-03 per=1.5e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=50 i=5 t=7.7e-03 per=1.5e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=50 i=6 t=7.5e-03 per=1.5e+01 cost=1.9e+04 flops=2.6e+06
 sigma[gemm] counter=50 i=7 t=7.6e-03 per=1.5e+01 cost=1.9e+04 flops=2.6e+06
 sigma[gemm] counter=50 total t=3.0e-02 per=6.0e+01 cost=8.1e+04 flops=2.7e+06
 sigma[red] counter=50 t=1.3e-02 per=2.5e+01 cost=2.4e+04 flops=1.9e+06
----- TIMING FOR sigma_tot : t_inter=2.9e-01 t_gemm=1.2e+00 t_reduction=5.8e-01 tot=2.1e+00 -----
 sigma_tot[inter] counter=50 t=2.9e-01 per=1.4e+01 cost=8.9e+06 flops=3.1e+07
 sigma_tot[gemm] counter=50 i=0 t=6.8e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=1 t=6.0e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=2 t=5.8e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=3 t=5.8e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=4 t=3.1e-01 per=1.5e+01 cost=8.4e+05 flops=2.7e+06
 sigma_tot[gemm] counter=50 i=5 t=3.1e-01 per=1.5e+01 cost=8.5e+05 flops=2.7e+06
 sigma_tot[gemm] counter=50 i=6 t=3.0e-01 per=1.4e+01 cost=1.1e+06 flops=3.8e+06
 sigma_tot[gemm] counter=50 i=7 t=3.0e-01 per=1.4e+01 cost=1.1e+06 flops=3.8e+06
 sigma_tot[gemm] counter=50 total t=1.2e+00 per=5.9e+01 cost=4.0e+06 flops=3.2e+06
 sigma_tot[red] counter=50 t=5.8e-01 per=2.8e+01 cost=1.6e+06 flops=2.7e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.4e-05,3.0e-06,1.0e-06,2.1e-07
    4   0 -    -116.191734079180 -1.064e-04  1.785e-03    3     4  2.377e-01 5.943e-02 5.935e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.233e-03,7.606e-03,2.992e-02,1.275e-02,5.951e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.254e-03 speed=2.380e-04GB/S T(nccl)=6.978e-03 speed=7.687e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=51 t=7.6e-03 per=1.5e+01 cost=1.6e+05 flops=2.1e+07
 sigma[gemm] counter=51 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=4 t=7.6e-03 per=1.5e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=51 i=5 t=7.5e-03 per=1.5e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=51 i=6 t=7.4e-03 per=1.5e+01 cost=1.9e+04 flops=2.6e+06
 sigma[gemm] counter=51 i=7 t=7.4e-03 per=1.5e+01 cost=1.9e+04 flops=2.6e+06
 sigma[gemm] counter=51 total t=3.0e-02 per=6.0e+01 cost=8.1e+04 flops=2.7e+06
 sigma[red] counter=51 t=1.3e-02 per=2.5e+01 cost=2.4e+04 flops=1.9e+06
----- TIMING FOR sigma_tot : t_inter=3.0e-01 t_gemm=1.3e+00 t_reduction=5.9e-01 tot=2.2e+00 -----
 sigma_tot[inter] counter=51 t=3.0e-01 per=1.4e+01 cost=9.1e+06 flops=3.0e+07
 sigma_tot[gemm] counter=51 i=0 t=6.9e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=1 t=6.1e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=2 t=5.9e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=3 t=5.9e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=4 t=3.2e-01 per=1.5e+01 cost=8.6e+05 flops=2.7e+06
 sigma_tot[gemm] counter=51 i=5 t=3.2e-01 per=1.5e+01 cost=8.7e+05 flops=2.7e+06
 sigma_tot[gemm] counter=51 i=6 t=3.1e-01 per=1.4e+01 cost=1.2e+06 flops=3.8e+06
 sigma_tot[gemm] counter=51 i=7 t=3.1e-01 per=1.4e+01 cost=1.2e+06 flops=3.8e+06
 sigma_tot[gemm] counter=51 total t=1.3e+00 per=5.9e+01 cost=4.1e+06 flops=3.2e+06
 sigma_tot[red] counter=51 t=5.9e-01 per=2.8e+01 cost=1.6e+06 flops=2.7e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.3e-05,3.1e-06,9.5e-07,2.0e-07
    5   0 -    -116.191744355101 -1.028e-05  6.638e-04    3     5  2.975e-01 5.951e-02 5.942e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.134e-03,7.574e-03,3.014e-02,1.281e-02,5.766e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.159e-03 speed=2.485e-04GB/S T(nccl)=4.975e-03 speed=1.078e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=52 t=7.6e-03 per=1.5e+01 cost=1.6e+05 flops=2.1e+07
 sigma[gemm] counter=52 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=4 t=7.5e-03 per=1.5e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=52 i=5 t=7.6e-03 per=1.5e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=52 i=6 t=7.5e-03 per=1.5e+01 cost=1.9e+04 flops=2.6e+06
 sigma[gemm] counter=52 i=7 t=7.6e-03 per=1.5e+01 cost=1.9e+04 flops=2.5e+06
 sigma[gemm] counter=52 total t=3.0e-02 per=6.0e+01 cost=8.1e+04 flops=2.7e+06
 sigma[red] counter=52 t=1.3e-02 per=2.5e+01 cost=2.4e+04 flops=1.9e+06
----- TIMING FOR sigma_tot : t_inter=3.1e-01 t_gemm=1.3e+00 t_reduction=6.1e-01 tot=2.2e+00 -----
 sigma_tot[inter] counter=52 t=3.1e-01 per=1.4e+01 cost=9.3e+06 flops=3.0e+07
 sigma_tot[gemm] counter=52 i=0 t=7.0e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=1 t=6.2e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=2 t=6.0e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=3 t=6.0e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=4 t=3.2e-01 per=1.5e+01 cost=8.9e+05 flops=2.7e+06
 sigma_tot[gemm] counter=52 i=5 t=3.3e-01 per=1.5e+01 cost=8.9e+05 flops=2.7e+06
 sigma_tot[gemm] counter=52 i=6 t=3.2e-01 per=1.4e+01 cost=1.2e+06 flops=3.7e+06
 sigma_tot[gemm] counter=52 i=7 t=3.2e-01 per=1.4e+01 cost=1.2e+06 flops=3.7e+06
 sigma_tot[gemm] counter=52 total t=1.3e+00 per=5.9e+01 cost=4.1e+06 flops=3.2e+06
 sigma_tot[red] counter=52 t=6.1e-01 per=2.8e+01 cost=1.6e+06 flops=2.7e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.3e-05,3.2e-06,9.5e-07,2.0e-07
    6   0 -    -116.191745402467 -1.047e-06  1.379e-04    3     6  3.556e-01 5.926e-02 5.917e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.248e-02,7.452e-03,2.371e-02,3.451e-03,5.709e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.105e-03 speed=2.548e-04GB/S T(nccl)=2.037e-02 speed=2.633e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=2.4e-02 t_reduction=3.5e-03 tot=3.5e-02 -----
 sigma[inter] counter=53 t=7.5e-03 per=2.2e+01 cost=1.6e+05 flops=2.2e+07
 sigma[gemm] counter=53 i=0 t=1.3e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=1 t=1.2e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=2 t=1.1e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=3 t=1.1e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=4 t=7.4e-03 per=2.1e+01 cost=2.1e+04 flops=2.9e+06
 sigma[gemm] counter=53 i=5 t=7.6e-03 per=2.2e+01 cost=2.1e+04 flops=2.8e+06
 sigma[gemm] counter=53 i=6 t=7.5e-03 per=2.2e+01 cost=1.9e+04 flops=2.6e+06
 sigma[gemm] counter=53 i=7 t=1.2e-03 per=3.3e+00 cost=1.9e+04 flops=1.7e+07
 sigma[gemm] counter=53 total t=2.4e-02 per=6.8e+01 cost=8.1e+04 flops=3.4e+06
 sigma[red] counter=53 t=3.5e-03 per=1.0e+01 cost=2.4e+04 flops=6.9e+06
----- TIMING FOR sigma_tot : t_inter=3.1e-01 t_gemm=1.3e+00 t_reduction=6.1e-01 tot=2.2e+00 -----
 sigma_tot[inter] counter=53 t=3.1e-01 per=1.4e+01 cost=9.4e+06 flops=3.0e+07
 sigma_tot[gemm] counter=53 i=0 t=7.2e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=1 t=6.3e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=2 t=6.1e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=3 t=6.1e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=4 t=3.3e-01 per=1.5e+01 cost=9.1e+05 flops=2.7e+06
 sigma_tot[gemm] counter=53 i=5 t=3.4e-01 per=1.5e+01 cost=9.1e+05 flops=2.7e+06
 sigma_tot[gemm] counter=53 i=6 t=3.3e-01 per=1.5e+01 cost=1.2e+06 flops=3.7e+06
 sigma_tot[gemm] counter=53 i=7 t=3.2e-01 per=1.4e+01 cost=1.2e+06 flops=3.8e+06
 sigma_tot[gemm] counter=53 total t=1.3e+00 per=5.9e+01 cost=4.2e+06 flops=3.2e+06
 sigma_tot[red] counter=53 t=6.1e-01 per=2.7e+01 cost=1.7e+06 flops=2.7e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,1.3e-05,3.0e-06,9.8e-07,2.3e-07
    7   0 +    -116.191745448369 -4.590e-08  3.429e-05    3     7  4.129e-01 5.899e-02 5.889e-02
TIMING FOR Davidson : 4.129e-01  T(cal/comm/rest)=4.122e-01,6.525e-06,6.696e-04
decomposed t_rest=6.696e-04
 T(sub)    =1.500e-04 per=2.240e+01
 T(precond)=5.209e-05 per=7.779e+00
 T(ortho)  =1.366e-05 per=2.040e+00
 T(xcopy)  =9.360e-07 per=1.398e-01
 T(xnrm2)  =3.066e-06 per=4.579e-01
 T(other)  =4.498e-04 per=6.718e+01
optimized energies: isweep=0 ibond=10 dots=2 e[0]=-116.191745448369 nmvp=7
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=8.545e-04 change=1.033e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond10.txt
 qbond: qsuper nsym=9 dimAll=32
 (15,3):2 (17,3):8 (16,2):4 (16,4):4 (19,3):2 (18,2):4 (18,4):4 (17,1):2 (17,5):2
timing for divide=3.3e-05
timing for compute=9.4e-05
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(su2): 1.4e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.3e-05,5.7e-05,0.0e+00,3.7e-05,1.6e-05 -----
decimation summary: 32->8 dwt=+0.000e+00 SvN=4.106e-01
 qbond: qkept nsym=4 dimAll=8
 (17,3):2 (19,3):2 (18,2):2 (18,4):2
----- TIMING for decimation_row(nkr): 4.788e-04 S T(decim/select/formRot)=2.003e-04,2.013e-04,7.715e-05 -----
----- TIMING FOR twodot_decimation: 6.758e-04 S T(wf/decim)=1.829e-04,4.929e-04 -----
ctns::oper_renorm coord=(11,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:12 S:4 P:28 Q:40 
        dim(bra,ket)=8,8 size(op)=24:1.831e-04MB size(tot)=1184:9.033e-03MB:8.821e-06GB
        per(mem): H:1.35 C:16.2 S:5.41 P:9.46 Q:67.6 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=8.545e-04 change=1.300e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=81 : 2.728e-03 S -----
rank=0 GPUmem(GB): used=5.202e-05 (oper)=2.603e-05
rank=0 GPUmem(GB): used=5.229e-05 (oper,site)=2.603e-05,2.682e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=81
 no. of rintermediate operators=108
 no. of coefficients=1188:9.064e-03MB:8.851e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.496e-03 S -----
rank=0 GPUmem(GB): used=6.114e-05 (oper,site,rinter)=2.603e-05,2.682e-07,8.851e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.653e-02 S size(rtasks)=81 size(Rlst2)=16 T(Rmu/Rlist)=6.283e-04,1.590e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.681e-02 S size(rtasks)=81 size(Rlst)=1632 -----
rank=0 GPUmem(GB): used=6.114e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.581e-04 blksize=4 blksize0=4 batchsize=1632
rank=0 GPUmem(GB): used=2.192e-04 (oper,site,rinter,batch)=2.603e-05,2.682e-07,8.851e-06,1.581e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.728e-03,2.223e-02,9.845e-03
----- TIMING FOR renorm : t_inter=5.7e-03 t_gemm=2.2e-02 t_reduction=9.8e-03 tot=3.8e-02 -----
 renorm[inter] counter=146 t=5.7e-03 per=1.5e+01 cost=5.4e+04 flops=9.5e+06
 renorm[gemm] counter=146 i=0 t=1.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=146 i=1 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=146 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=146 i=3 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=146 i=4 t=7.4e-03 per=2.0e+01 cost=6.2e+03 flops=8.3e+05
 renorm[gemm] counter=146 i=5 t=7.4e-03 per=2.0e+01 cost=1.5e+04 flops=2.0e+06
 renorm[gemm] counter=146 i=6 t=7.4e-03 per=1.9e+01 cost=2.6e+04 flops=3.5e+06
 renorm[gemm] counter=146 total t=2.2e-02 per=5.9e+01 cost=4.7e+04 flops=2.1e+06
 renorm[red] counter=146 t=9.8e-03 per=2.6e+01 cost=1.3e+04 flops=1.3e+06
----- TIMING FOR renorm_tot : t_inter=6.9e-02 t_gemm=2.5e-01 t_reduction=1.1e-01 tot=4.3e-01 -----
 renorm_tot[inter] counter=146 t=6.9e-02 per=1.6e+01 cost=2.5e+05 flops=3.6e+06
 renorm_tot[gemm] counter=146 i=0 t=1.5e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=146 i=1 t=1.3e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=146 i=2 t=1.2e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=146 i=3 t=1.2e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=146 i=4 t=8.2e-02 per=1.9e+01 cost=3.1e+04 flops=3.7e+05
 renorm_tot[gemm] counter=146 i=5 t=8.2e-02 per=1.9e+01 cost=9.9e+04 flops=1.2e+06
 renorm_tot[gemm] counter=146 i=6 t=8.3e-02 per=1.9e+01 cost=1.6e+05 flops=2.0e+06
 renorm_tot[gemm] counter=146 total t=2.5e-01 per=5.8e+01 cost=2.9e+05 flops=1.2e+06
 renorm_tot[red] counter=146 t=1.1e-01 per=2.6e+01 cost=9.6e+04 flops=8.7e+05
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=6.197e-05 (optmp,oper)=1.192e-07,2.603e-05
rank=0 GPUmem(GB): used=6.224e-05 (optmp,oper,site,rinter)=1.192e-07,2.603e-05,2.682e-07,9.835e-07
rank=0 GPUmem(GB): used=6.534e-05 (optmp,oper,site,rinter,batch)=1.192e-07,2.603e-05,2.682e-07,9.835e-07,3.099e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 3.099e-01 S T(prep/alloc/comp/red/dealloc)=7.574e-03,1.070e-02,2.768e-01,1.992e-02,2.508e-03 -----
----- TIMING FOR oper_renorm_opS : 3.100e-01 S rank=0 -----
qops.to_cpu: size(tot)=1184:9.033e-03MB:8.821e-06GB T(to_cpu)=1.189e-04S speed=7.418e-02GB/S
check ||H-H.dagger||=1.205e-14 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.387 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=6.866e-04 change=5.326e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.793e-03 change=-1.499e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=1.793e-03 change=-2.652e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.236e+00 S #####
 T(local opt: fetch) = 1.091e-02 S  per = 0.883  per(accum) = 0.883
 T(local opt: hdiag) = 3.454e-01 S  per = 27.9  per(accum) = 28.8
 T(local opt: dvdsn) = 4.896e-01 S  per = 39.6  per(accum) = 68.4
 T(local opt: decim) = 8.462e-04 S  per = 0.0685  per(accum) = 68.5
 T(local opt: guess) = 2.982e-04 S  per = 0.0241  per(accum) = 68.5
 T(local opt: renrm) = 3.887e-01 S  per = 31.4  per(accum) = 100
 T(local opt: save ) = 2.090e-04 S  per = 0.0169  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.896e-01 S  T(sum) = 4.892e-01 S  per = 9.992e+01
 T(local opt: preprocess                  ) = 8.613e-04 S  per = 0.176  per(accum) = 0.176
 T(local opt: symbolic_formulae           ) = 5.342e-03 S  per = 1.09  per(accum) = 1.27
 T(local opt: hintermediate init          ) = 2.754e-04 S  per = 0.0563  per(accum) = 1.32
 T(local opt: preprocess_hformulae_Hxlist ) = 4.922e-02 S  per = 10.1  per(accum) = 11.4
 T(local opt: hmmtasks init               ) = 2.025e-02 S  per = 4.14  per(accum) = 15.5
 T(local opt: initial guess for dvdson    ) = 3.477e-04 S  per = 0.0711  per(accum) = 15.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.375e-01 S  per =   69  per(accum) = 84.6
 T(local opt: dvdson [cpu-gpu]            ) = 1.510e-02 S  per = 3.09  per(accum) = 87.7
 T(local opt: dvdson [nccl]               ) = 5.967e-02 S  per = 12.2  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 6.525e-06 S  per = 0.00133  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 6.696e-04 S  per = 0.137  per(accum) = 100
Detailed decomposition of T(renrm) = 3.887e-01 S  T(sum) = 3.887e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.804e-04 S  per = 0.0464  per(accum) = 0.0464
 T(local opt: qops init                    ) = 1.745e-03 S  per = 0.449  per(accum) = 0.495
 T(local opt: symbolic_formulae_renorm     ) = 2.741e-03 S  per = 0.705  per(accum) = 1.2
 T(local opt: allocate qops on gpu         ) = 5.050e-05 S  per = 0.013  per(accum) = 1.21
 T(local opt: site memcpy cpu2gpu          ) = 1.686e-03 S  per = 0.434  per(accum) = 1.65
 T(local opt: rintermediate init           ) = 2.511e-03 S  per = 0.646  per(accum) = 2.29
 T(local opt: preprocess_formulae_Rlist2   ) = 1.687e-02 S  per = 4.34  per(accum) = 6.63
 T(local opt: rmmtasks init                ) = 1.043e-02 S  per = 2.68  per(accum) = 9.32
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 9e-06  per(accum) = 9.32
 T(local opt: preprocess_renorm_batchGPU   ) = 3.792e-02 S  per = 9.76  per(accum) = 19.1
 T(local opt: deallocate cpu and gpu memory) = 6.995e-05 S  per = 0.018  per(accum) = 19.1
 T(local opt: construct opS [ifdists=true] ) = 3.101e-01 S  per = 79.8  per(accum) = 98.9
 T(local opt: reduction of opS & opH [nccl]) = 2.387e-03 S  per = 0.614  per(accum) = 99.5
 T(local opt: qops memcpy gpu2cpu          ) = 1.309e-04 S  per = 0.0337  per(accum) = 99.5
 T(local opt: reduction of opS & opH [mpi] ) = 4.033e-05 S  per = 0.0104  per(accum) = 99.5
 T(local opt: qops_pool join and erase     ) = 1.874e-03 S  per = 0.482  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 4.892e-06 S  per = 0.00126  per(accum) = 100
##### sweep opt: 1.575e+01 S #####
 T(sweep opt: fetch) = 1.417e-01 S  per =  0.9  per(accum) = 0.9
 T(sweep opt: hdiag) = 3.515e+00 S  per = 22.3  per(accum) = 23.2
 T(sweep opt: dvdsn) = 4.909e+00 S  per = 31.2  per(accum) = 54.4
 T(sweep opt: decim) = 1.323e-02 S  per = 0.084  per(accum) = 54.5
 T(sweep opt: guess) = 8.288e-03 S  per = 0.0526  per(accum) = 54.5
 T(sweep opt: renrm) = 7.160e+00 S  per = 45.5  per(accum) = 100
 T(sweep opt: save ) = 2.399e-03 S  per = 0.0152  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.909e+00 S  T(sum) = 4.903e+00 S  per = 9.988e+01
 T(sweep opt: preprocess                  ) = 3.839e-02 S  per = 0.783  per(accum) = 0.783
 T(sweep opt: symbolic_formulae           ) = 4.465e-02 S  per = 0.911  per(accum) = 1.69
 T(sweep opt: hintermediate init          ) = 2.312e-03 S  per = 0.0471  per(accum) = 1.74
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.439e+00 S  per = 29.4  per(accum) = 31.1
 T(sweep opt: hmmtasks init               ) = 5.906e-01 S  per =   12  per(accum) = 43.1
 T(sweep opt: initial guess for dvdson    ) = 1.086e-02 S  per = 0.222  per(accum) = 43.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.247e+00 S  per = 45.8  per(accum) = 89.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.037e-01 S  per = 2.12  per(accum) = 91.3
 T(sweep opt: dvdson [nccl]               ) = 4.203e-01 S  per = 8.57  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 3.850e-05 S  per = 0.000785  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 5.510e-03 S  per = 0.112  per(accum) = 100
Detailed decomposition of T(renrm) = 7.160e+00 S  T(sum) = 7.160e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.142e-03 S  per = 0.0439  per(accum) = 0.0439
 T(sweep opt: qops init                    ) = 3.010e-02 S  per = 0.42  per(accum) = 0.464
 T(sweep opt: symbolic_formulae_renorm     ) = 1.229e-02 S  per = 0.172  per(accum) = 0.636
 T(sweep opt: allocate qops on gpu         ) = 7.303e-04 S  per = 0.0102  per(accum) = 0.646
 T(sweep opt: site memcpy cpu2gpu          ) = 1.359e-02 S  per = 0.19  per(accum) = 0.836
 T(sweep opt: rintermediate init           ) = 2.497e-02 S  per = 0.349  per(accum) = 1.18
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.890e-01 S  per = 2.64  per(accum) = 3.82
 T(sweep opt: rmmtasks init                ) = 9.606e-02 S  per = 1.34  per(accum) = 5.17
 T(sweep opt: qops memset on cpu           ) = 4.250e-07 S  per = 5.94e-06  per(accum) = 5.17
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.286e-01 S  per = 5.99  per(accum) = 11.2
 T(sweep opt: deallocate cpu and gpu memory) = 8.094e-04 S  per = 0.0113  per(accum) = 11.2
 T(sweep opt: construct opS [ifdists=true] ) = 6.209e+00 S  per = 86.7  per(accum) = 97.9
 T(sweep opt: reduction of opS & opH [nccl]) = 2.479e-02 S  per = 0.346  per(accum) = 98.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.152e-03 S  per = 0.0161  per(accum) = 98.2
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.607e-04 S  per = 0.00923  per(accum) = 98.3
 T(sweep opt: qops_pool join and erase     ) = 2.259e-02 S  per = 0.316  per(accum) = 98.6
 T(sweep opt: conversion from opAB to opPQ ) = 1.026e-01 S  per = 1.43  per(accum) = 100
##### global opt: 1.575e+01 S #####
 T(global opt: fetch) = 1.417e-01 S  per =  0.9  per(accum) = 0.9
 T(global opt: hdiag) = 3.515e+00 S  per = 22.3  per(accum) = 23.2
 T(global opt: dvdsn) = 4.909e+00 S  per = 31.2  per(accum) = 54.4
 T(global opt: decim) = 1.323e-02 S  per = 0.084  per(accum) = 54.5
 T(global opt: guess) = 8.288e-03 S  per = 0.0526  per(accum) = 54.5
 T(global opt: renrm) = 7.160e+00 S  per = 45.5  per(accum) = 100
 T(global opt: save ) = 2.399e-03 S  per = 0.0152  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.909e+00 S  T(sum) = 4.903e+00 S  per = 9.988e+01
 T(global opt: preprocess                  ) = 3.839e-02 S  per = 0.783  per(accum) = 0.783
 T(global opt: symbolic_formulae           ) = 4.465e-02 S  per = 0.911  per(accum) = 1.69
 T(global opt: hintermediate init          ) = 2.312e-03 S  per = 0.0471  per(accum) = 1.74
 T(global opt: preprocess_hformulae_Hxlist ) = 1.439e+00 S  per = 29.4  per(accum) = 31.1
 T(global opt: hmmtasks init               ) = 5.906e-01 S  per =   12  per(accum) = 43.1
 T(global opt: initial guess for dvdson    ) = 1.086e-02 S  per = 0.222  per(accum) = 43.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.247e+00 S  per = 45.8  per(accum) = 89.2
 T(global opt: dvdson [cpu-gpu]            ) = 1.037e-01 S  per = 2.12  per(accum) = 91.3
 T(global opt: dvdson [nccl]               ) = 4.203e-01 S  per = 8.57  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 3.850e-05 S  per = 0.000785  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 5.510e-03 S  per = 0.112  per(accum) = 100
Detailed decomposition of T(renrm) = 7.160e+00 S  T(sum) = 7.160e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.142e-03 S  per = 0.0439  per(accum) = 0.0439
 T(global opt: qops init                    ) = 3.010e-02 S  per = 0.42  per(accum) = 0.464
 T(global opt: symbolic_formulae_renorm     ) = 1.229e-02 S  per = 0.172  per(accum) = 0.636
 T(global opt: allocate qops on gpu         ) = 7.303e-04 S  per = 0.0102  per(accum) = 0.646
 T(global opt: site memcpy cpu2gpu          ) = 1.359e-02 S  per = 0.19  per(accum) = 0.836
 T(global opt: rintermediate init           ) = 2.497e-02 S  per = 0.349  per(accum) = 1.18
 T(global opt: preprocess_formulae_Rlist2   ) = 1.890e-01 S  per = 2.64  per(accum) = 3.82
 T(global opt: rmmtasks init                ) = 9.606e-02 S  per = 1.34  per(accum) = 5.17
 T(global opt: qops memset on cpu           ) = 4.250e-07 S  per = 5.94e-06  per(accum) = 5.17
 T(global opt: preprocess_renorm_batchGPU   ) = 4.286e-01 S  per = 5.99  per(accum) = 11.2
 T(global opt: deallocate cpu and gpu memory) = 8.094e-04 S  per = 0.0113  per(accum) = 11.2
 T(global opt: construct opS [ifdists=true] ) = 6.209e+00 S  per = 86.7  per(accum) = 97.9
 T(global opt: reduction of opS & opH [nccl]) = 2.479e-02 S  per = 0.346  per(accum) = 98.2
 T(global opt: qops memcpy gpu2cpu          ) = 1.152e-03 S  per = 0.0161  per(accum) = 98.2
 T(global opt: reduction of opS & opH [mpi] ) = 6.607e-04 S  per = 0.00923  per(accum) = 98.3
 T(global opt: qops_pool join and erase     ) = 2.259e-02 S  per = 0.316  per(accum) = 98.6
 T(global opt: conversion from opAB to opPQ ) = 1.026e-01 S  per = 1.43  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.029e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=11/seqsize=34 dots=2 dbond=(12,0)-(13,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=313:2.388e-03MB:2.332e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=16:1.221e-04MB:1.192e-07GB
total mem of comb=330:2.518e-03MB:2.459e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=12,6,1,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc1= 8
 suppc2= 9
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:12 S:4 P:28 Q:40 
        dim(bra,ket)=8,8 size(op)=24:1.831e-04MB size(tot)=1184:9.033e-03MB:8.821e-06GB
        per(mem): H:1.35 C:16.2 S:5.41 P:9.46 Q:67.6 
 rqops: oplist=HCSAB nops=H:1 C:6 S:7 A:17 B:22 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=92:0.000702MB:6.85e-07GB
        per(mem): H:4.35 C:0 S:0 A:0 B:95.7 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3272:0.025MB:2.44e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.214e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(12,0) fdel=./scratch/sweep/rop(13,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-2.980e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(8,2,3,3) nnz=36:2.747e-04MB
qtensor4: wf4 own=1 _data=0x46812000
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=8
 (17,3):2 (19,3):2 (18,2):2 (18,4):2
 qbond: qcol nsym=1 dimAll=2
 (9,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=9 nblocks=64 size=36:2.747e-04MB
### DIAG TIMING: total=3.193e-01 t1=2.518e-05, t2=1.823e-03, t3=2.534e-03, t4=3.125e-01, t5=6.662e-06, t6=2.464e-03, t7=6.600e-06
duration_diagGPU:3.194e-01
duration_diagreduce:5.200e-08
duration_diagtransform:3.540e-07
----- TIMING FOR symbolic_formulae_twodot with size=319 : 4.412e-03 S -----
rank=0 GPUmem(GB): used=2.438e-05 (oper)=2.438e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=319
 no. of hintermediate operators=166
 no. of coefficients=1975:1.507e-02MB:1.471e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.729e-04 S -----
rank=0 GPUmem(GB): used=3.909e-05 (oper,hinter)=2.438e-05,1.471e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.983e-02 S size(H_formulae)=319 size(Hxlst2)=9 T(Hmu/Hxlist)=8.602e-04,3.897e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.022e-02 S size(H_formulae)=319 size(Hxlst)=2512 -----
rank=0 GPUmem(GB): used=3.909e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=5.364e-07 batch[need]=2.433e-04 blksize=4 blksize0=4 batchsize=2512
rank=0 GPUmem(GB): used=2.829e-04 (oper,hinter,dvdson,batch)=2.438e-05,1.471e-05,5.364e-07,2.433e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=36 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.429e-03,7.514e-03,3.015e-02,1.270e-02,5.580e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=4.075e-04 speed=1.316e-03GB/S T(nccl)=5.021e-03 speed=1.068e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=54 t=7.5e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=54 i=0 t=1.4e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=4 t=7.5e-03 per=1.5e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=54 i=5 t=7.6e-03 per=1.5e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=54 i=6 t=7.6e-03 per=1.5e+01 cost=1.6e+04 flops=2.2e+06
 sigma[gemm] counter=54 i=7 t=7.5e-03 per=1.5e+01 cost=1.6e+04 flops=2.2e+06
 sigma[gemm] counter=54 total t=3.0e-02 per=6.0e+01 cost=6.7e+04 flops=2.2e+06
 sigma[red] counter=54 t=1.3e-02 per=2.5e+01 cost=2.0e+04 flops=1.6e+06
----- TIMING FOR sigma_tot : t_inter=3.2e-01 t_gemm=1.3e+00 t_reduction=6.2e-01 tot=2.3e+00 -----
 sigma_tot[inter] counter=54 t=3.2e-01 per=1.4e+01 cost=9.6e+06 flops=3.0e+07
 sigma_tot[gemm] counter=54 i=0 t=7.3e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=1 t=6.5e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=2 t=6.2e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=3 t=6.2e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=4 t=3.4e-01 per=1.5e+01 cost=9.2e+05 flops=2.7e+06
 sigma_tot[gemm] counter=54 i=5 t=3.4e-01 per=1.5e+01 cost=9.3e+05 flops=2.7e+06
 sigma_tot[gemm] counter=54 i=6 t=3.3e-01 per=1.5e+01 cost=1.2e+06 flops=3.7e+06
 sigma_tot[gemm] counter=54 i=7 t=3.3e-01 per=1.4e+01 cost=1.2e+06 flops=3.7e+06
 sigma_tot[gemm] counter=54 total t=1.3e+00 per=5.9e+01 cost=4.3e+06 flops=3.2e+06
 sigma_tot[red] counter=54 t=6.2e-01 per=2.7e+01 cost=1.7e+06 flops=2.7e+06
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,5.2e-06,2.0e-06,1.2e-06,2.2e-07
settings: ndim=36 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.191745448368 -1.116e+03  1.190e-02    1     1  5.607e-02 5.607e-02 5.603e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.649e-03,7.541e-03,2.973e-02,1.269e-02,5.762e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.208e-03 speed=2.429e-04GB/S T(nccl)=5.441e-03 speed=9.860e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=55 t=7.5e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=55 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=4 t=7.4e-03 per=1.5e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=55 i=5 t=7.4e-03 per=1.5e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=55 i=6 t=7.4e-03 per=1.5e+01 cost=1.6e+04 flops=2.2e+06
 sigma[gemm] counter=55 i=7 t=7.5e-03 per=1.5e+01 cost=1.6e+04 flops=2.2e+06
 sigma[gemm] counter=55 total t=3.0e-02 per=5.9e+01 cost=6.7e+04 flops=2.3e+06
 sigma[red] counter=55 t=1.3e-02 per=2.5e+01 cost=2.0e+04 flops=1.6e+06
----- TIMING FOR sigma_tot : t_inter=3.3e-01 t_gemm=1.4e+00 t_reduction=6.3e-01 tot=2.3e+00 -----
 sigma_tot[inter] counter=55 t=3.3e-01 per=1.4e+01 cost=9.7e+06 flops=2.9e+07
 sigma_tot[gemm] counter=55 i=0 t=7.5e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=1 t=6.6e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=2 t=6.3e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=3 t=6.3e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=4 t=3.5e-01 per=1.5e+01 cost=9.4e+05 flops=2.7e+06
 sigma_tot[gemm] counter=55 i=5 t=3.5e-01 per=1.5e+01 cost=9.4e+05 flops=2.7e+06
 sigma_tot[gemm] counter=55 i=6 t=3.4e-01 per=1.5e+01 cost=1.2e+06 flops=3.6e+06
 sigma_tot[gemm] counter=55 i=7 t=3.3e-01 per=1.4e+01 cost=1.2e+06 flops=3.7e+06
 sigma_tot[gemm] counter=55 total t=1.4e+00 per=5.9e+01 cost=4.4e+06 flops=3.2e+06
 sigma_tot[red] counter=55 t=6.3e-01 per=2.7e+01 cost=1.7e+06 flops=2.7e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.2e-05,3.6e-06,1.0e-06,1.7e-07
    2   0 -    -116.192623316417 -8.779e-04  3.475e-03    2     2  1.140e-01 5.698e-02 5.692e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.535e-03,7.566e-03,2.999e-02,1.263e-02,5.873e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.224e-03 speed=2.412e-04GB/S T(nccl)=6.311e-03 speed=8.500e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=56 t=7.6e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=56 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=4 t=7.6e-03 per=1.5e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=56 i=5 t=7.5e-03 per=1.5e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=56 i=6 t=7.4e-03 per=1.5e+01 cost=1.6e+04 flops=2.2e+06
 sigma[gemm] counter=56 i=7 t=7.4e-03 per=1.5e+01 cost=1.6e+04 flops=2.2e+06
 sigma[gemm] counter=56 total t=3.0e-02 per=6.0e+01 cost=6.7e+04 flops=2.3e+06
 sigma[red] counter=56 t=1.3e-02 per=2.5e+01 cost=2.0e+04 flops=1.6e+06
----- TIMING FOR sigma_tot : t_inter=3.4e-01 t_gemm=1.4e+00 t_reduction=6.5e-01 tot=2.4e+00 -----
 sigma_tot[inter] counter=56 t=3.4e-01 per=1.4e+01 cost=9.8e+06 flops=2.9e+07
 sigma_tot[gemm] counter=56 i=0 t=7.6e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=1 t=6.7e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=2 t=6.5e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=3 t=6.4e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=4 t=3.5e-01 per=1.5e+01 cost=9.6e+05 flops=2.7e+06
 sigma_tot[gemm] counter=56 i=5 t=3.6e-01 per=1.5e+01 cost=9.6e+05 flops=2.7e+06
 sigma_tot[gemm] counter=56 i=6 t=3.5e-01 per=1.5e+01 cost=1.3e+06 flops=3.6e+06
 sigma_tot[gemm] counter=56 i=7 t=3.4e-01 per=1.4e+01 cost=1.3e+06 flops=3.7e+06
 sigma_tot[gemm] counter=56 total t=1.4e+00 per=5.9e+01 cost=4.4e+06 flops=3.2e+06
 sigma_tot[red] counter=56 t=6.5e-01 per=2.7e+01 cost=1.7e+06 flops=2.7e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.4e-05,3.2e-06,9.9e-07,1.8e-07
    3   0 -    -116.192665289443 -4.197e-05  9.505e-04    3     3  1.730e-01 5.766e-02 5.760e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.348e-03,7.546e-03,3.009e-02,1.275e-02,5.875e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.192e-03 speed=2.447e-04GB/S T(nccl)=6.156e-03 speed=8.715e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=57 t=7.5e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=57 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=4 t=7.5e-03 per=1.5e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=57 i=5 t=7.5e-03 per=1.5e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=57 i=6 t=7.5e-03 per=1.5e+01 cost=1.6e+04 flops=2.2e+06
 sigma[gemm] counter=57 i=7 t=7.5e-03 per=1.5e+01 cost=1.6e+04 flops=2.2e+06
 sigma[gemm] counter=57 total t=3.0e-02 per=6.0e+01 cost=6.7e+04 flops=2.2e+06
 sigma[red] counter=57 t=1.3e-02 per=2.5e+01 cost=2.0e+04 flops=1.6e+06
----- TIMING FOR sigma_tot : t_inter=3.4e-01 t_gemm=1.4e+00 t_reduction=6.6e-01 tot=2.4e+00 -----
 sigma_tot[inter] counter=57 t=3.4e-01 per=1.4e+01 cost=9.9e+06 flops=2.9e+07
 sigma_tot[gemm] counter=57 i=0 t=7.7e-05 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=1 t=6.8e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=2 t=6.6e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=3 t=6.6e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=4 t=3.6e-01 per=1.5e+01 cost=9.8e+05 flops=2.7e+06
 sigma_tot[gemm] counter=57 i=5 t=3.7e-01 per=1.5e+01 cost=9.8e+05 flops=2.7e+06
 sigma_tot[gemm] counter=57 i=6 t=3.6e-01 per=1.5e+01 cost=1.3e+06 flops=3.6e+06
 sigma_tot[gemm] counter=57 i=7 t=3.5e-01 per=1.4e+01 cost=1.3e+06 flops=3.6e+06
 sigma_tot[gemm] counter=57 total t=1.4e+00 per=5.9e+01 cost=4.5e+06 flops=3.1e+06
 sigma_tot[red] counter=57 t=6.6e-01 per=2.7e+01 cost=1.7e+06 flops=2.6e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.3e-05,3.1e-06,1.0e-06,2.3e-07
    4   0 -    -116.192667746819 -2.457e-06  3.798e-04    3     4  2.320e-01 5.801e-02 5.793e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.056e-03,7.428e-03,3.018e-02,1.275e-02,5.941e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.145e-03 speed=2.501e-04GB/S T(nccl)=6.911e-03 speed=7.762e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=58 t=7.4e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=58 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=4 t=7.4e-03 per=1.5e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=58 i=5 t=7.5e-03 per=1.5e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=58 i=6 t=7.6e-03 per=1.5e+01 cost=1.6e+04 flops=2.1e+06
 sigma[gemm] counter=58 i=7 t=7.6e-03 per=1.5e+01 cost=1.6e+04 flops=2.1e+06
 sigma[gemm] counter=58 total t=3.0e-02 per=6.0e+01 cost=6.7e+04 flops=2.2e+06
 sigma[red] counter=58 t=1.3e-02 per=2.5e+01 cost=2.0e+04 flops=1.6e+06
----- TIMING FOR sigma_tot : t_inter=3.5e-01 t_gemm=1.5e+00 t_reduction=6.7e-01 tot=2.5e+00 -----
 sigma_tot[inter] counter=58 t=3.5e-01 per=1.4e+01 cost=1.0e+07 flops=2.9e+07
 sigma_tot[gemm] counter=58 i=0 t=7.8e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=1 t=6.9e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=2 t=6.7e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=3 t=6.7e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=4 t=3.7e-01 per=1.5e+01 cost=9.9e+05 flops=2.7e+06
 sigma_tot[gemm] counter=58 i=5 t=3.7e-01 per=1.5e+01 cost=1.0e+06 flops=2.7e+06
 sigma_tot[gemm] counter=58 i=6 t=3.6e-01 per=1.5e+01 cost=1.3e+06 flops=3.5e+06
 sigma_tot[gemm] counter=58 i=7 t=3.6e-01 per=1.4e+01 cost=1.3e+06 flops=3.6e+06
 sigma_tot[gemm] counter=58 total t=1.5e+00 per=5.9e+01 cost=4.6e+06 flops=3.1e+06
 sigma_tot[red] counter=58 t=6.7e-01 per=2.7e+01 cost=1.8e+06 flops=2.6e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.3e-05,3.2e-06,1.0e-06,2.2e-07
    5   0 -    -116.192668178768 -4.319e-07  1.597e-04    3     5  2.918e-01 5.836e-02 5.828e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.137e-03,7.467e-03,3.001e-02,1.263e-02,5.925e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.185e-03 speed=2.455e-04GB/S T(nccl)=6.951e-03 speed=7.717e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=59 t=7.5e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=59 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=4 t=7.5e-03 per=1.5e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=59 i=5 t=7.6e-03 per=1.5e+01 cost=1.7e+04 flops=2.3e+06
 sigma[gemm] counter=59 i=6 t=7.5e-03 per=1.5e+01 cost=1.6e+04 flops=2.2e+06
 sigma[gemm] counter=59 i=7 t=7.4e-03 per=1.5e+01 cost=1.6e+04 flops=2.2e+06
 sigma[gemm] counter=59 total t=3.0e-02 per=6.0e+01 cost=6.7e+04 flops=2.2e+06
 sigma[red] counter=59 t=1.3e-02 per=2.5e+01 cost=2.0e+04 flops=1.6e+06
----- TIMING FOR sigma_tot : t_inter=3.6e-01 t_gemm=1.5e+00 t_reduction=6.9e-01 tot=2.5e+00 -----
 sigma_tot[inter] counter=59 t=3.6e-01 per=1.4e+01 cost=1.0e+07 flops=2.8e+07
 sigma_tot[gemm] counter=59 i=0 t=8.0e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=1 t=7.0e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=2 t=6.8e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=3 t=6.8e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=4 t=3.8e-01 per=1.5e+01 cost=1.0e+06 flops=2.7e+06
 sigma_tot[gemm] counter=59 i=5 t=3.8e-01 per=1.5e+01 cost=1.0e+06 flops=2.7e+06
 sigma_tot[gemm] counter=59 i=6 t=3.7e-01 per=1.5e+01 cost=1.3e+06 flops=3.5e+06
 sigma_tot[gemm] counter=59 i=7 t=3.6e-01 per=1.4e+01 cost=1.3e+06 flops=3.6e+06
 sigma_tot[gemm] counter=59 total t=1.5e+00 per=5.9e+01 cost=4.6e+06 flops=3.1e+06
 sigma_tot[red] counter=59 t=6.9e-01 per=2.7e+01 cost=1.8e+06 flops=2.6e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.3e-05,3.1e-06,9.6e-07,2.1e-07
    6   0 +    -116.192668235368 -5.660e-08  3.815e-05    3     6  3.514e-01 5.856e-02 5.848e-02
TIMING FOR Davidson : 3.514e-01  T(cal/comm/rest)=3.509e-01,5.794e-06,5.392e-04
decomposed t_rest=5.392e-04
 T(sub)    =1.191e-04 per=2.209e+01
 T(precond)=4.289e-05 per=7.955e+00
 T(ortho)  =1.160e-05 per=2.152e+00
 T(xcopy)  =7.930e-07 per=1.471e-01
 T(xnrm2)  =2.634e-06 per=4.885e-01
 T(other)  =3.621e-04 per=6.716e+01
optimized energies: isweep=0 ibond=11 dots=2 e[0]=-116.192668235368 nmvp=6
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=8.709e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond11.txt
 qbond: qsuper nsym=9 dimAll=32
 (17,3):2 (19,3):8 (18,2):4 (18,4):4 (21,3):2 (20,2):4 (20,4):4 (19,1):2 (19,5):2
timing for divide=3.2e-05
timing for compute=9.1e-05
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(su2): 1.4e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.2e-05,5.1e-05,0.0e+00,4.0e-05,1.5e-05 -----
decimation summary: 32->8 dwt=+0.000e+00 SvN=9.620e-02
 qbond: qkept nsym=4 dimAll=8
 (19,3):2 (21,3):2 (20,2):2 (20,4):2
----- TIMING for decimation_row(nkr): 4.352e-04 S T(decim/select/formRot)=2.028e-04,1.724e-04,6.004e-05 -----
----- TIMING FOR twodot_decimation: 6.333e-04 S T(wf/decim)=1.802e-04,4.531e-04 -----
ctns::oper_renorm coord=(12,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:13 S:4 P:23 Q:28 
        dim(bra,ket)=8,8 size(op)=24:1.831e-04MB size(tot)=940:7.172e-03MB:7.004e-06GB
        per(mem): H:1.7 C:22.1 S:6.81 P:9.79 Q:59.6 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.076e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=65 : 2.206e-03 S -----
rank=0 GPUmem(GB): used=4.541e-05 (oper)=2.326e-05
rank=0 GPUmem(GB): used=4.568e-05 (oper,site)=2.326e-05,2.682e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=65
 no. of rintermediate operators=79
 no. of coefficients=948:7.233e-03MB:7.063e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.545e-03 S -----
rank=0 GPUmem(GB): used=5.274e-05 (oper,site,rinter)=2.326e-05,2.682e-07,7.063e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.265e-02 S size(rtasks)=65 size(Rlst2)=16 T(Rmu/Rlist)=4.682e-04,1.219e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.287e-02 S size(rtasks)=65 size(Rlst)=1242 -----
rank=0 GPUmem(GB): used=5.274e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.203e-04 blksize=4 blksize0=4 batchsize=1242
rank=0 GPUmem(GB): used=1.730e-04 (oper,site,rinter,batch)=2.326e-05,2.682e-07,7.063e-06,1.203e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.098e-03,2.237e-02,9.892e-03
----- TIMING FOR renorm : t_inter=6.1e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.8e-02 -----
 renorm[inter] counter=155 t=6.1e-03 per=1.6e+01 cost=4.2e+04 flops=6.9e+06
 renorm[gemm] counter=155 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=155 i=1 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=155 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=155 i=3 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=155 i=4 t=7.4e-03 per=1.9e+01 cost=4.8e+03 flops=6.5e+05
 renorm[gemm] counter=155 i=5 t=7.5e-03 per=1.9e+01 cost=1.1e+04 flops=1.5e+06
 renorm[gemm] counter=155 i=6 t=7.5e-03 per=2.0e+01 cost=2.0e+04 flops=2.6e+06
 renorm[gemm] counter=155 total t=2.2e-02 per=5.8e+01 cost=3.6e+04 flops=1.6e+06
 renorm[red] counter=155 t=9.9e-03 per=2.6e+01 cost=9.9e+03 flops=1.0e+06
----- TIMING FOR renorm_tot : t_inter=7.6e-02 t_gemm=2.7e-01 t_reduction=1.2e-01 tot=4.7e-01 -----
 renorm_tot[inter] counter=155 t=7.6e-02 per=1.6e+01 cost=2.9e+05 flops=3.8e+06
 renorm_tot[gemm] counter=155 i=0 t=1.6e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=155 i=1 t=1.4e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=155 i=2 t=1.3e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=155 i=3 t=1.3e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=155 i=4 t=9.0e-02 per=1.9e+01 cost=3.5e+04 flops=4.0e+05
 renorm_tot[gemm] counter=155 i=5 t=9.0e-02 per=1.9e+01 cost=1.1e+05 flops=1.2e+06
 renorm_tot[gemm] counter=155 i=6 t=9.0e-02 per=1.9e+01 cost=1.8e+05 flops=2.0e+06
 renorm_tot[gemm] counter=155 total t=2.7e-01 per=5.8e+01 cost=3.3e+05 flops=1.2e+06
 renorm_tot[red] counter=155 t=1.2e-01 per=2.6e+01 cost=1.1e+05 flops=8.8e+05
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=5.367e-05 (optmp,oper)=1.192e-07,2.326e-05
rank=0 GPUmem(GB): used=5.393e-05 (optmp,oper,site,rinter)=1.192e-07,2.326e-05,2.682e-07,1.073e-06
rank=0 GPUmem(GB): used=5.820e-05 (optmp,oper,site,rinter,batch)=1.192e-07,2.326e-05,2.682e-07,1.073e-06,4.262e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.808e-01 S T(prep/alloc/comp/red/dealloc)=7.636e-03,1.076e-02,2.501e-01,1.746e-02,2.465e-03 -----
----- TIMING FOR oper_renorm_opS : 2.809e-01 S rank=0 -----
qops.to_cpu: size(tot)=940:7.172e-03MB:7.004e-06GB T(to_cpu)=1.045e-04S speed=6.701e-02GB/S
check ||H-H.dagger||=1.075e-14 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.35 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=4.132e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=8.621e-04 change=-1.354e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=8.621e-04 change=-2.652e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.097e+00 S #####
 T(local opt: fetch) = 9.548e-03 S  per = 0.87  per(accum) = 0.87
 T(local opt: hdiag) = 3.196e-01 S  per = 29.1  per(accum) = 30
 T(local opt: dvdsn) = 4.149e-01 S  per = 37.8  per(accum) = 67.8
 T(local opt: decim) = 7.242e-04 S  per = 0.066  per(accum) = 67.9
 T(local opt: guess) = 3.291e-04 S  per = 0.03  per(accum) = 67.9
 T(local opt: renrm) = 3.521e-01 S  per = 32.1  per(accum) = 100
 T(local opt: save ) = 2.041e-04 S  per = 0.0186  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.149e-01 S  T(sum) = 4.147e-01 S  per = 9.994e+01
 T(local opt: preprocess                  ) = 8.651e-04 S  per = 0.209  per(accum) = 0.209
 T(local opt: symbolic_formulae           ) = 4.428e-03 S  per = 1.07  per(accum) = 1.28
 T(local opt: hintermediate init          ) = 2.158e-04 S  per = 0.052  per(accum) = 1.33
 T(local opt: preprocess_hformulae_Hxlist ) = 4.030e-02 S  per = 9.72  per(accum) = 11
 T(local opt: hmmtasks init               ) = 1.713e-02 S  per = 4.13  per(accum) = 15.2
 T(local opt: initial guess for dvdson    ) = 3.362e-04 S  per = 0.0811  per(accum) = 15.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.027e-01 S  per =   73  per(accum) = 88.3
 T(local opt: dvdson [cpu-gpu]            ) = 1.136e-02 S  per = 2.74  per(accum) = 91
 T(local opt: dvdson [nccl]               ) = 3.679e-02 S  per = 8.87  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 5.794e-06 S  per = 0.0014  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 5.392e-04 S  per = 0.13  per(accum) = 100
Detailed decomposition of T(renrm) = 3.521e-01 S  T(sum) = 3.521e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.820e-04 S  per = 0.0517  per(accum) = 0.0517
 T(local opt: qops init                    ) = 1.447e-03 S  per = 0.411  per(accum) = 0.463
 T(local opt: symbolic_formulae_renorm     ) = 2.219e-03 S  per = 0.63  per(accum) = 1.09
 T(local opt: allocate qops on gpu         ) = 5.089e-05 S  per = 0.0145  per(accum) = 1.11
 T(local opt: site memcpy cpu2gpu          ) = 1.173e-03 S  per = 0.333  per(accum) = 1.44
 T(local opt: rintermediate init           ) = 2.560e-03 S  per = 0.727  per(accum) = 2.17
 T(local opt: preprocess_formulae_Rlist2   ) = 1.291e-02 S  per = 3.67  per(accum) = 5.84
 T(local opt: rmmtasks init                ) = 7.771e-03 S  per = 2.21  per(accum) = 8.04
 T(local opt: qops memset on cpu           ) = 3.000e-08 S  per = 8.52e-06  per(accum) = 8.04
 T(local opt: preprocess_renorm_batchGPU   ) = 3.853e-02 S  per = 10.9  per(accum) = 19
 T(local opt: deallocate cpu and gpu memory) = 5.897e-05 S  per = 0.0167  per(accum) = 19
 T(local opt: construct opS [ifdists=true] ) = 2.809e-01 S  per = 79.8  per(accum) = 98.8
 T(local opt: reduction of opS & opH [nccl]) = 2.390e-03 S  per = 0.679  per(accum) = 99.5
 T(local opt: qops memcpy gpu2cpu          ) = 1.160e-04 S  per = 0.0329  per(accum) = 99.5
 T(local opt: reduction of opS & opH [mpi] ) = 4.054e-05 S  per = 0.0115  per(accum) = 99.5
 T(local opt: qops_pool join and erase     ) = 1.717e-03 S  per = 0.488  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 5.962e-06 S  per = 0.00169  per(accum) = 100
##### sweep opt: 1.685e+01 S #####
 T(sweep opt: fetch) = 1.513e-01 S  per = 0.898  per(accum) = 0.898
 T(sweep opt: hdiag) = 3.834e+00 S  per = 22.8  per(accum) = 23.7
 T(sweep opt: dvdsn) = 5.324e+00 S  per = 31.6  per(accum) = 55.3
 T(sweep opt: decim) = 1.395e-02 S  per = 0.0828  per(accum) = 55.3
 T(sweep opt: guess) = 8.617e-03 S  per = 0.0511  per(accum) = 55.4
 T(sweep opt: renrm) = 7.512e+00 S  per = 44.6  per(accum) = 100
 T(sweep opt: save ) = 2.604e-03 S  per = 0.0155  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.324e+00 S  T(sum) = 5.318e+00 S  per = 9.988e+01
 T(sweep opt: preprocess                  ) = 3.926e-02 S  per = 0.738  per(accum) = 0.738
 T(sweep opt: symbolic_formulae           ) = 4.908e-02 S  per = 0.923  per(accum) = 1.66
 T(sweep opt: hintermediate init          ) = 2.527e-03 S  per = 0.0475  per(accum) = 1.71
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.480e+00 S  per = 27.8  per(accum) = 29.5
 T(sweep opt: hmmtasks init               ) = 6.078e-01 S  per = 11.4  per(accum) = 41
 T(sweep opt: initial guess for dvdson    ) = 1.120e-02 S  per = 0.211  per(accum) = 41.2
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.550e+00 S  per =   48  per(accum) = 89.1
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.151e-01 S  per = 2.16  per(accum) = 91.3
 T(sweep opt: dvdson [nccl]               ) = 4.571e-01 S  per =  8.6  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 4.429e-05 S  per = 0.000833  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.049e-03 S  per = 0.114  per(accum) = 100
Detailed decomposition of T(renrm) = 7.512e+00 S  T(sum) = 7.512e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.324e-03 S  per = 0.0443  per(accum) = 0.0443
 T(sweep opt: qops init                    ) = 3.155e-02 S  per = 0.42  per(accum) = 0.464
 T(sweep opt: symbolic_formulae_renorm     ) = 1.451e-02 S  per = 0.193  per(accum) = 0.657
 T(sweep opt: allocate qops on gpu         ) = 7.812e-04 S  per = 0.0104  per(accum) = 0.668
 T(sweep opt: site memcpy cpu2gpu          ) = 1.477e-02 S  per = 0.197  per(accum) = 0.864
 T(sweep opt: rintermediate init           ) = 2.753e-02 S  per = 0.366  per(accum) = 1.23
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.020e-01 S  per = 2.69  per(accum) = 3.92
 T(sweep opt: rmmtasks init                ) = 1.038e-01 S  per = 1.38  per(accum) = 5.3
 T(sweep opt: qops memset on cpu           ) = 4.550e-07 S  per = 6.06e-06  per(accum) = 5.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.671e-01 S  per = 6.22  per(accum) = 11.5
 T(sweep opt: deallocate cpu and gpu memory) = 8.684e-04 S  per = 0.0116  per(accum) = 11.5
 T(sweep opt: construct opS [ifdists=true] ) = 6.490e+00 S  per = 86.4  per(accum) = 97.9
 T(sweep opt: reduction of opS & opH [nccl]) = 2.718e-02 S  per = 0.362  per(accum) = 98.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.268e-03 S  per = 0.0169  per(accum) = 98.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 7.012e-04 S  per = 0.00933  per(accum) = 98.3
 T(sweep opt: qops_pool join and erase     ) = 2.431e-02 S  per = 0.324  per(accum) = 98.6
 T(sweep opt: conversion from opAB to opPQ ) = 1.026e-01 S  per = 1.37  per(accum) = 100
##### global opt: 1.685e+01 S #####
 T(global opt: fetch) = 1.513e-01 S  per = 0.898  per(accum) = 0.898
 T(global opt: hdiag) = 3.834e+00 S  per = 22.8  per(accum) = 23.7
 T(global opt: dvdsn) = 5.324e+00 S  per = 31.6  per(accum) = 55.3
 T(global opt: decim) = 1.395e-02 S  per = 0.0828  per(accum) = 55.3
 T(global opt: guess) = 8.617e-03 S  per = 0.0511  per(accum) = 55.4
 T(global opt: renrm) = 7.512e+00 S  per = 44.6  per(accum) = 100
 T(global opt: save ) = 2.604e-03 S  per = 0.0155  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.324e+00 S  T(sum) = 5.318e+00 S  per = 9.988e+01
 T(global opt: preprocess                  ) = 3.926e-02 S  per = 0.738  per(accum) = 0.738
 T(global opt: symbolic_formulae           ) = 4.908e-02 S  per = 0.923  per(accum) = 1.66
 T(global opt: hintermediate init          ) = 2.527e-03 S  per = 0.0475  per(accum) = 1.71
 T(global opt: preprocess_hformulae_Hxlist ) = 1.480e+00 S  per = 27.8  per(accum) = 29.5
 T(global opt: hmmtasks init               ) = 6.078e-01 S  per = 11.4  per(accum) = 41
 T(global opt: initial guess for dvdson    ) = 1.120e-02 S  per = 0.211  per(accum) = 41.2
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.550e+00 S  per =   48  per(accum) = 89.1
 T(global opt: dvdson [cpu-gpu]            ) = 1.151e-01 S  per = 2.16  per(accum) = 91.3
 T(global opt: dvdson [nccl]               ) = 4.571e-01 S  per =  8.6  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 4.429e-05 S  per = 0.000833  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 6.049e-03 S  per = 0.114  per(accum) = 100
Detailed decomposition of T(renrm) = 7.512e+00 S  T(sum) = 7.512e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.324e-03 S  per = 0.0443  per(accum) = 0.0443
 T(global opt: qops init                    ) = 3.155e-02 S  per = 0.42  per(accum) = 0.464
 T(global opt: symbolic_formulae_renorm     ) = 1.451e-02 S  per = 0.193  per(accum) = 0.657
 T(global opt: allocate qops on gpu         ) = 7.812e-04 S  per = 0.0104  per(accum) = 0.668
 T(global opt: site memcpy cpu2gpu          ) = 1.477e-02 S  per = 0.197  per(accum) = 0.864
 T(global opt: rintermediate init           ) = 2.753e-02 S  per = 0.366  per(accum) = 1.23
 T(global opt: preprocess_formulae_Rlist2   ) = 2.020e-01 S  per = 2.69  per(accum) = 3.92
 T(global opt: rmmtasks init                ) = 1.038e-01 S  per = 1.38  per(accum) = 5.3
 T(global opt: qops memset on cpu           ) = 4.550e-07 S  per = 6.06e-06  per(accum) = 5.3
 T(global opt: preprocess_renorm_batchGPU   ) = 4.671e-01 S  per = 6.22  per(accum) = 11.5
 T(global opt: deallocate cpu and gpu memory) = 8.684e-04 S  per = 0.0116  per(accum) = 11.5
 T(global opt: construct opS [ifdists=true] ) = 6.490e+00 S  per = 86.4  per(accum) = 97.9
 T(global opt: reduction of opS & opH [nccl]) = 2.718e-02 S  per = 0.362  per(accum) = 98.3
 T(global opt: qops memcpy gpu2cpu          ) = 1.268e-03 S  per = 0.0169  per(accum) = 98.3
 T(global opt: reduction of opS & opH [mpi] ) = 7.012e-04 S  per = 0.00933  per(accum) = 98.3
 T(global opt: qops_pool join and erase     ) = 2.431e-02 S  per = 0.324  per(accum) = 98.6
 T(global opt: conversion from opAB to opPQ ) = 1.026e-01 S  per = 1.37  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.667e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=12/seqsize=34 dots=2 dbond=(13,0)-(14,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=345:2.632e-03MB:2.570e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=16:1.221e-04MB:1.192e-07GB
total mem of comb=362:2.762e-03MB:2.697e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=13,5,1,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 11 12 13 14 15
 suppc1= 9
 suppc2= 10
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:13 S:4 P:23 Q:28 
        dim(bra,ket)=8,8 size(op)=24:1.831e-04MB size(tot)=940:7.172e-03MB:7.004e-06GB
        per(mem): H:1.7 C:22.1 S:6.81 P:9.79 Q:59.6 
 rqops: oplist=HCSAB nops=H:1 C:5 S:7 A:12 B:16 
        dim(bra,ket)=2,2 size(op)=4:3.05e-05MB size(tot)=68:0.000519MB:5.07e-07GB
        per(mem): H:5.88 C:0 S:0 A:0 B:94.1 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3004:0.0229MB:2.24e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.164e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(13,0) fdel=./scratch/sweep/rop(14,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.192e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(8,2,3,3) nnz=36:2.747e-04MB
qtensor4: wf4 own=1 _data=0x46812000
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=8
 (19,3):2 (21,3):2 (20,2):2 (20,4):2
 qbond: qcol nsym=1 dimAll=2
 (7,3):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=9 nblocks=64 size=36:2.747e-04MB
### DIAG TIMING: total=2.299e-01 t1=2.502e-05, t2=1.848e-03, t3=2.537e-03, t4=2.252e-01, t5=3.545e-06, t6=3.676e-04, t7=4.343e-06
duration_diagGPU:2.300e-01
duration_diagreduce:6.800e-08
duration_diagtransform:4.680e-07
----- TIMING FOR symbolic_formulae_twodot with size=255 : 3.513e-03 S -----
rank=0 GPUmem(GB): used=2.238e-05 (oper)=2.238e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=255
 no. of hintermediate operators=131
 no. of coefficients=1619:1.235e-02MB:1.206e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.538e-04 S -----
rank=0 GPUmem(GB): used=3.444e-05 (oper,hinter)=2.238e-05,1.206e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.035e-02 S size(H_formulae)=255 size(Hxlst2)=9 T(Hmu/Hxlist)=6.575e-04,2.969e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.065e-02 S size(H_formulae)=255 size(Hxlst)=1842 -----
rank=0 GPUmem(GB): used=3.444e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=5.364e-07 batch[need]=1.784e-04 blksize=4 blksize0=4 batchsize=1842
rank=0 GPUmem(GB): used=2.134e-04 (oper,hinter,dvdson,batch)=2.238e-05,1.206e-05,5.364e-07,1.784e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=36 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.026e-03,7.481e-03,2.993e-02,1.250e-02,5.694e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=1.417e-03 speed=3.786e-04GB/S T(nccl)=5.609e-03 speed=9.564e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.2e-02 tot=5.0e-02 -----
 sigma[inter] counter=60 t=7.5e-03 per=1.5e+01 cost=9.6e+04 flops=1.3e+07
 sigma[gemm] counter=60 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=4 t=7.4e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=60 i=5 t=7.5e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=60 i=6 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=60 i=7 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=60 total t=3.0e-02 per=6.0e+01 cost=4.9e+04 flops=1.6e+06
 sigma[red] counter=60 t=1.2e-02 per=2.5e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=3.7e-01 t_gemm=1.5e+00 t_reduction=7.0e-01 tot=2.6e+00 -----
 sigma_tot[inter] counter=60 t=3.7e-01 per=1.4e+01 cost=1.0e+07 flops=2.8e+07
 sigma_tot[gemm] counter=60 i=0 t=8.1e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=1 t=7.2e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=2 t=6.9e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=3 t=6.9e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=4 t=3.8e-01 per=1.5e+01 cost=1.0e+06 flops=2.7e+06
 sigma_tot[gemm] counter=60 i=5 t=3.9e-01 per=1.5e+01 cost=1.0e+06 flops=2.6e+06
 sigma_tot[gemm] counter=60 i=6 t=3.8e-01 per=1.5e+01 cost=1.3e+06 flops=3.5e+06
 sigma_tot[gemm] counter=60 i=7 t=3.7e-01 per=1.4e+01 cost=1.3e+06 flops=3.5e+06
 sigma_tot[gemm] counter=60 total t=1.5e+00 per=5.9e+01 cost=4.7e+06 flops=3.1e+06
 sigma_tot[red] counter=60 t=7.0e-01 per=2.7e+01 cost=1.8e+06 flops=2.6e+06
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,4.3e-06,2.0e-06,9.5e-07,2.1e-07
settings: ndim=36 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.192668235368 -1.116e+03  2.652e-02    1     1  5.721e-02 5.721e-02 5.717e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.175e-02,7.364e-03,2.993e-02,1.259e-02,6.164e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.147e-03 speed=2.498e-04GB/S T(nccl)=9.606e-03 speed=5.584e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=61 t=7.4e-03 per=1.5e+01 cost=9.6e+04 flops=1.3e+07
 sigma[gemm] counter=61 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=4 t=7.4e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=61 i=5 t=7.5e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=61 i=6 t=7.6e-03 per=1.5e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=61 i=7 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=61 total t=3.0e-02 per=6.0e+01 cost=4.9e+04 flops=1.6e+06
 sigma[red] counter=61 t=1.3e-02 per=2.5e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=3.7e-01 t_gemm=1.6e+00 t_reduction=7.1e-01 tot=2.6e+00 -----
 sigma_tot[inter] counter=61 t=3.7e-01 per=1.4e+01 cost=1.0e+07 flops=2.8e+07
 sigma_tot[gemm] counter=61 i=0 t=8.2e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=1 t=7.3e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=2 t=7.0e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=3 t=7.0e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=4 t=3.9e-01 per=1.5e+01 cost=1.0e+06 flops=2.6e+06
 sigma_tot[gemm] counter=61 i=5 t=4.0e-01 per=1.5e+01 cost=1.0e+06 flops=2.6e+06
 sigma_tot[gemm] counter=61 i=6 t=3.9e-01 per=1.5e+01 cost=1.3e+06 flops=3.4e+06
 sigma_tot[gemm] counter=61 i=7 t=3.8e-01 per=1.4e+01 cost=1.3e+06 flops=3.5e+06
 sigma_tot[gemm] counter=61 total t=1.6e+00 per=5.9e+01 cost=4.7e+06 flops=3.0e+06
 sigma_tot[red] counter=61 t=7.1e-01 per=2.7e+01 cost=1.8e+06 flops=2.5e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.2e-05,3.6e-06,9.9e-07,2.3e-07
    2   0 -    -116.196073911632 -3.406e-03  5.948e-03    2     2  1.191e-01 5.956e-02 5.950e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.189e-02,7.538e-03,2.958e-02,1.251e-02,6.152e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.249e-03 speed=2.385e-04GB/S T(nccl)=9.640e-03 speed=5.565e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=62 t=7.5e-03 per=1.5e+01 cost=9.6e+04 flops=1.3e+07
 sigma[gemm] counter=62 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=4 t=7.4e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=62 i=5 t=7.4e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=62 i=6 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=62 i=7 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=62 total t=3.0e-02 per=6.0e+01 cost=4.9e+04 flops=1.6e+06
 sigma[red] counter=62 t=1.3e-02 per=2.5e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=3.8e-01 t_gemm=1.6e+00 t_reduction=7.2e-01 tot=2.7e+00 -----
 sigma_tot[inter] counter=62 t=3.8e-01 per=1.4e+01 cost=1.0e+07 flops=2.7e+07
 sigma_tot[gemm] counter=62 i=0 t=8.4e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=1 t=7.4e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=2 t=7.1e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=3 t=7.1e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=4 t=4.0e-01 per=1.5e+01 cost=1.0e+06 flops=2.6e+06
 sigma_tot[gemm] counter=62 i=5 t=4.0e-01 per=1.5e+01 cost=1.1e+06 flops=2.6e+06
 sigma_tot[gemm] counter=62 i=6 t=3.9e-01 per=1.5e+01 cost=1.3e+06 flops=3.4e+06
 sigma_tot[gemm] counter=62 i=7 t=3.9e-01 per=1.4e+01 cost=1.3e+06 flops=3.5e+06
 sigma_tot[gemm] counter=62 total t=1.6e+00 per=5.9e+01 cost=4.8e+06 flops=3.0e+06
 sigma_tot[red] counter=62 t=7.2e-01 per=2.7e+01 cost=1.8e+06 flops=2.5e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.5e-05,3.1e-06,1.0e-06,2.2e-07
    3   0 -    -116.196220890260 -1.470e-04  2.694e-03    3     3  1.809e-01 6.031e-02 6.024e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.201e-03,7.494e-03,3.008e-02,1.261e-02,5.739e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.193e-03 speed=2.446e-04GB/S T(nccl)=5.008e-03 speed=1.071e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=63 t=7.5e-03 per=1.5e+01 cost=9.6e+04 flops=1.3e+07
 sigma[gemm] counter=63 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=4 t=7.5e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=63 i=5 t=7.6e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=63 i=6 t=7.6e-03 per=1.5e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=63 i=7 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=63 total t=3.0e-02 per=6.0e+01 cost=4.9e+04 flops=1.6e+06
 sigma[red] counter=63 t=1.3e-02 per=2.5e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=3.9e-01 t_gemm=1.6e+00 t_reduction=7.4e-01 tot=2.7e+00 -----
 sigma_tot[inter] counter=63 t=3.9e-01 per=1.4e+01 cost=1.1e+07 flops=2.7e+07
 sigma_tot[gemm] counter=63 i=0 t=8.5e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=1 t=7.5e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=2 t=7.3e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=3 t=7.2e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=4 t=4.1e-01 per=1.5e+01 cost=1.1e+06 flops=2.6e+06
 sigma_tot[gemm] counter=63 i=5 t=4.1e-01 per=1.5e+01 cost=1.1e+06 flops=2.6e+06
 sigma_tot[gemm] counter=63 i=6 t=4.0e-01 per=1.5e+01 cost=1.4e+06 flops=3.4e+06
 sigma_tot[gemm] counter=63 i=7 t=3.9e-01 per=1.4e+01 cost=1.4e+06 flops=3.4e+06
 sigma_tot[gemm] counter=63 total t=1.6e+00 per=5.9e+01 cost=4.8e+06 flops=3.0e+06
 sigma_tot[red] counter=63 t=7.4e-01 per=2.7e+01 cost=1.8e+06 flops=2.5e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,1.3e-05,3.0e-06,9.9e-07,2.0e-07
    4   0 -    -116.196247315039 -2.642e-05  8.516e-04    3     4  2.386e-01 5.965e-02 5.957e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.271e-03,7.426e-03,2.987e-02,1.275e-02,5.732e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.259e-03 speed=2.374e-04GB/S T(nccl)=5.012e-03 speed=1.070e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=64 t=7.4e-03 per=1.5e+01 cost=9.6e+04 flops=1.3e+07
 sigma[gemm] counter=64 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=2 t=4.7e-06 per=9.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=4 t=7.4e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=64 i=5 t=7.5e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=64 i=6 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=64 i=7 t=7.6e-03 per=1.5e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=64 total t=3.0e-02 per=6.0e+01 cost=4.9e+04 flops=1.6e+06
 sigma[red] counter=64 t=1.3e-02 per=2.5e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=4.0e-01 t_gemm=1.6e+00 t_reduction=7.5e-01 tot=2.8e+00 -----
 sigma_tot[inter] counter=64 t=4.0e-01 per=1.4e+01 cost=1.1e+07 flops=2.7e+07
 sigma_tot[gemm] counter=64 i=0 t=8.6e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=1 t=7.6e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=2 t=7.7e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=3 t=7.4e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=4 t=4.1e-01 per=1.5e+01 cost=1.1e+06 flops=2.6e+06
 sigma_tot[gemm] counter=64 i=5 t=4.2e-01 per=1.5e+01 cost=1.1e+06 flops=2.6e+06
 sigma_tot[gemm] counter=64 i=6 t=4.1e-01 per=1.5e+01 cost=1.4e+06 flops=3.3e+06
 sigma_tot[gemm] counter=64 i=7 t=4.0e-01 per=1.4e+01 cost=1.4e+06 flops=3.4e+06
 sigma_tot[gemm] counter=64 total t=1.6e+00 per=5.9e+01 cost=4.9e+06 flops=3.0e+06
 sigma_tot[red] counter=64 t=7.5e-01 per=2.7e+01 cost=1.9e+06 flops=2.5e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,1.3e-05,3.0e-06,1.0e-06,2.2e-07
    5   0 -    -116.196249992944 -2.678e-06  4.241e-04    3     5  2.961e-01 5.922e-02 5.915e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.220e-03,7.605e-03,2.988e-02,1.280e-02,5.852e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.274e-03 speed=2.359e-04GB/S T(nccl)=5.946e-03 speed=9.022e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=65 t=7.6e-03 per=1.5e+01 cost=9.6e+04 flops=1.3e+07
 sigma[gemm] counter=65 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=4 t=7.5e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=65 i=5 t=7.5e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=65 i=6 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=65 i=7 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=65 total t=3.0e-02 per=5.9e+01 cost=4.9e+04 flops=1.6e+06
 sigma[red] counter=65 t=1.3e-02 per=2.5e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=4.0e-01 t_gemm=1.7e+00 t_reduction=7.6e-01 tot=2.8e+00 -----
 sigma_tot[inter] counter=65 t=4.0e-01 per=1.4e+01 cost=1.1e+07 flops=2.7e+07
 sigma_tot[gemm] counter=65 i=0 t=8.8e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=1 t=7.7e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=2 t=7.8e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=3 t=7.5e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=4 t=4.2e-01 per=1.5e+01 cost=1.1e+06 flops=2.6e+06
 sigma_tot[gemm] counter=65 i=5 t=4.3e-01 per=1.5e+01 cost=1.1e+06 flops=2.6e+06
 sigma_tot[gemm] counter=65 i=6 t=4.2e-01 per=1.5e+01 cost=1.4e+06 flops=3.3e+06
 sigma_tot[gemm] counter=65 i=7 t=4.1e-01 per=1.4e+01 cost=1.4e+06 flops=3.4e+06
 sigma_tot[gemm] counter=65 total t=1.7e+00 per=5.9e+01 cost=4.9e+06 flops=2.9e+06
 sigma_tot[red] counter=65 t=7.6e-01 per=2.7e+01 cost=1.9e+06 flops=2.5e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.3e-05,3.1e-06,1.0e-06,2.1e-07
    6   0 -    -116.196250779063 -7.861e-07  3.062e-04    3     6  3.549e-01 5.915e-02 5.908e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.356e-03,7.608e-03,3.020e-02,1.271e-02,5.888e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.241e-03 speed=2.394e-04GB/S T(nccl)=6.115e-03 speed=8.772e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=66 t=7.6e-03 per=1.5e+01 cost=9.6e+04 flops=1.3e+07
 sigma[gemm] counter=66 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=4 t=7.5e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=66 i=5 t=7.6e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=66 i=6 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=66 i=7 t=7.6e-03 per=1.5e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=66 total t=3.0e-02 per=6.0e+01 cost=4.9e+04 flops=1.6e+06
 sigma[red] counter=66 t=1.3e-02 per=2.5e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=4.1e-01 t_gemm=1.7e+00 t_reduction=7.7e-01 tot=2.9e+00 -----
 sigma_tot[inter] counter=66 t=4.1e-01 per=1.4e+01 cost=1.1e+07 flops=2.6e+07
 sigma_tot[gemm] counter=66 i=0 t=8.9e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=1 t=7.8e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=2 t=7.9e-05 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=3 t=7.6e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=4 t=4.3e-01 per=1.5e+01 cost=1.1e+06 flops=2.6e+06
 sigma_tot[gemm] counter=66 i=5 t=4.3e-01 per=1.5e+01 cost=1.1e+06 flops=2.5e+06
 sigma_tot[gemm] counter=66 i=6 t=4.2e-01 per=1.5e+01 cost=1.4e+06 flops=3.3e+06
 sigma_tot[gemm] counter=66 i=7 t=4.2e-01 per=1.4e+01 cost=1.4e+06 flops=3.3e+06
 sigma_tot[gemm] counter=66 total t=1.7e+00 per=5.9e+01 cost=5.0e+06 flops=2.9e+06
 sigma_tot[red] counter=66 t=7.7e-01 per=2.7e+01 cost=1.9e+06 flops=2.4e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,1.3e-05,3.0e-06,9.8e-07,2.1e-07
    7   0 -    -116.196251724030 -9.450e-07  3.386e-04    3     7  4.140e-01 5.915e-02 5.907e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.596e-03,7.462e-03,3.025e-02,1.272e-02,5.902e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.223e-03 speed=2.414e-04GB/S T(nccl)=6.373e-03 speed=8.417e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=67 t=7.5e-03 per=1.5e+01 cost=9.6e+04 flops=1.3e+07
 sigma[gemm] counter=67 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=4 t=7.4e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=67 i=5 t=7.6e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=67 i=6 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=67 i=7 t=7.6e-03 per=1.5e+01 cost=1.2e+04 flops=1.5e+06
 sigma[gemm] counter=67 total t=3.0e-02 per=6.0e+01 cost=4.9e+04 flops=1.6e+06
 sigma[red] counter=67 t=1.3e-02 per=2.5e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=4.2e-01 t_gemm=1.7e+00 t_reduction=7.9e-01 tot=2.9e+00 -----
 sigma_tot[inter] counter=67 t=4.2e-01 per=1.4e+01 cost=1.1e+07 flops=2.6e+07
 sigma_tot[gemm] counter=67 i=0 t=9.0e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=1 t=8.0e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=2 t=8.1e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=3 t=7.7e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=4 t=4.4e-01 per=1.5e+01 cost=1.1e+06 flops=2.5e+06
 sigma_tot[gemm] counter=67 i=5 t=4.4e-01 per=1.5e+01 cost=1.1e+06 flops=2.5e+06
 sigma_tot[gemm] counter=67 i=6 t=4.3e-01 per=1.5e+01 cost=1.4e+06 flops=3.2e+06
 sigma_tot[gemm] counter=67 i=7 t=4.2e-01 per=1.4e+01 cost=1.4e+06 flops=3.3e+06
 sigma_tot[gemm] counter=67 total t=1.7e+00 per=5.9e+01 cost=5.0e+06 flops=2.9e+06
 sigma_tot[red] counter=67 t=7.9e-01 per=2.7e+01 cost=1.9e+06 flops=2.4e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.3e-05,3.2e-06,8.9e-07,1.7e-07
    8   0 -    -116.196252146716 -4.227e-07  1.797e-04    3     8  4.733e-01 5.916e-02 5.908e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.879e-03,7.557e-03,2.999e-02,1.266e-02,5.909e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.240e-03 speed=2.395e-04GB/S T(nccl)=6.639e-03 speed=8.080e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=68 t=7.6e-03 per=1.5e+01 cost=9.6e+04 flops=1.3e+07
 sigma[gemm] counter=68 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=4 t=7.6e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=68 i=5 t=7.5e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=68 i=6 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=68 i=7 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=68 total t=3.0e-02 per=6.0e+01 cost=4.9e+04 flops=1.6e+06
 sigma[red] counter=68 t=1.3e-02 per=2.5e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=4.3e-01 t_gemm=1.8e+00 t_reduction=8.0e-01 tot=3.0e+00 -----
 sigma_tot[inter] counter=68 t=4.3e-01 per=1.4e+01 cost=1.1e+07 flops=2.6e+07
 sigma_tot[gemm] counter=68 i=0 t=9.1e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=1 t=8.1e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=2 t=8.2e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=3 t=7.8e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=4 t=4.4e-01 per=1.5e+01 cost=1.1e+06 flops=2.5e+06
 sigma_tot[gemm] counter=68 i=5 t=4.5e-01 per=1.5e+01 cost=1.1e+06 flops=2.5e+06
 sigma_tot[gemm] counter=68 i=6 t=4.4e-01 per=1.5e+01 cost=1.4e+06 flops=3.2e+06
 sigma_tot[gemm] counter=68 i=7 t=4.3e-01 per=1.4e+01 cost=1.4e+06 flops=3.3e+06
 sigma_tot[gemm] counter=68 total t=1.8e+00 per=5.9e+01 cost=5.1e+06 flops=2.9e+06
 sigma_tot[red] counter=68 t=8.0e-01 per=2.7e+01 cost=1.9e+06 flops=2.4e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,1.3e-05,3.1e-06,9.2e-07,2.3e-07
    9   0 +    -116.196252217360 -7.064e-08  5.696e-05    3     9  5.327e-01 5.919e-02 5.911e-02
TIMING FOR Davidson : 5.328e-01  T(cal/comm/rest)=5.320e-01,6.397e-06,7.448e-04
decomposed t_rest=7.448e-04
 T(sub)    =1.777e-04 per=2.386e+01
 T(precond)=6.567e-05 per=8.817e+00
 T(ortho)  =1.732e-05 per=2.325e+00
 T(xcopy)  =1.112e-06 per=1.493e-01
 T(xnrm2)  =3.986e-06 per=5.352e-01
 T(other)  =4.790e-04 per=6.431e+01
optimized energies: isweep=0 ibond=12 dots=2 e[0]=-116.196252217360 nmvp=9
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=6.701e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond12.txt
 qbond: qsuper nsym=9 dimAll=32
 (19,3):2 (21,3):8 (20,2):4 (20,4):4 (23,3):2 (22,2):4 (22,4):4 (21,1):2 (21,5):2
timing for divide=3.2e-05
timing for compute=6.1e-05
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(su2): 1.1e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.2e-05,5.1e-05,0.0e+00,1.0e-05,1.6e-05 -----
decimation summary: 32->8 dwt=-2.220e-16 SvN=1.676e-01
 qbond: qkept nsym=4 dimAll=8
 (21,3):2 (23,3):2 (22,2):2 (22,4):2
----- TIMING for decimation_row(nkr): 4.130e-04 S T(decim/select/formRot)=1.726e-04,1.824e-04,5.793e-05 -----
----- TIMING FOR twodot_decimation: 6.119e-04 S T(wf/decim)=1.814e-04,4.305e-04 -----
ctns::oper_renorm coord=(13,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:14 S:3 P:17 Q:22 
        dim(bra,ket)=8,8 size(op)=24:1.831e-04MB size(tot)=796:6.073e-03MB:5.931e-06GB
        per(mem): H:2.01 C:28.1 S:6.03 P:8.54 Q:55.3 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=9.049e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=54 : 1.821e-03 S -----
rank=0 GPUmem(GB): used=3.987e-05 (oper)=2.037e-05
rank=0 GPUmem(GB): used=4.014e-05 (oper,site)=2.037e-05,2.682e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=54
 no. of rintermediate operators=61
 no. of coefficients=793:6.050e-03MB:5.908e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.463e-04 S -----
rank=0 GPUmem(GB): used=4.604e-05 (oper,site,rinter)=2.037e-05,2.682e-07,5.908e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.035e-02 S size(rtasks)=54 size(Rlst2)=16 T(Rmu/Rlist)=3.673e-04,9.985e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.050e-02 S size(rtasks)=54 size(Rlst)=1017 -----
rank=0 GPUmem(GB): used=4.604e-05 avail=6.231e+00 total=6.231e+00 batch[need]=9.850e-05 blksize=4 blksize0=4 batchsize=1017
rank=0 GPUmem(GB): used=1.445e-04 (oper,site,rinter,batch)=2.037e-05,2.682e-07,5.908e-06,9.850e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.128e-03,2.236e-02,9.945e-03
----- TIMING FOR renorm : t_inter=7.1e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=163 t=7.1e-03 per=1.8e+01 cost=3.6e+04 flops=5.0e+06
 renorm[gemm] counter=163 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=163 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=163 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=163 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=163 i=4 t=7.4e-03 per=1.9e+01 cost=3.8e+03 flops=5.2e+05
 renorm[gemm] counter=163 i=5 t=7.5e-03 per=1.9e+01 cost=9.5e+03 flops=1.3e+06
 renorm[gemm] counter=163 i=6 t=7.5e-03 per=1.9e+01 cost=1.6e+04 flops=2.2e+06
 renorm[gemm] counter=163 total t=2.2e-02 per=5.7e+01 cost=3.0e+04 flops=1.3e+06
 renorm[red] counter=163 t=9.9e-03 per=2.5e+01 cost=8.1e+03 flops=8.2e+05
----- TIMING FOR renorm_tot : t_inter=8.3e-02 t_gemm=2.9e-01 t_reduction=1.3e-01 tot=5.0e-01 -----
 renorm_tot[inter] counter=163 t=8.3e-02 per=1.6e+01 cost=3.3e+05 flops=3.9e+06
 renorm_tot[gemm] counter=163 i=0 t=1.7e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=163 i=1 t=1.5e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=163 i=2 t=1.4e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=163 i=3 t=1.4e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=163 i=4 t=9.7e-02 per=1.9e+01 cost=3.9e+04 flops=4.0e+05
 renorm_tot[gemm] counter=163 i=5 t=9.7e-02 per=1.9e+01 cost=1.2e+05 flops=1.2e+06
 renorm_tot[gemm] counter=163 i=6 t=9.8e-02 per=1.9e+01 cost=2.0e+05 flops=2.0e+06
 renorm_tot[gemm] counter=163 total t=2.9e-01 per=5.8e+01 cost=3.6e+05 flops=1.2e+06
 renorm_tot[red] counter=163 t=1.3e-01 per=2.6e+01 cost=1.1e+05 flops=8.8e+05
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.677e-05 (optmp,oper)=1.192e-07,2.037e-05
rank=0 GPUmem(GB): used=4.704e-05 (optmp,oper,site,rinter)=1.192e-07,2.037e-05,2.682e-07,8.717e-07
rank=0 GPUmem(GB): used=5.110e-05 (optmp,oper,site,rinter,batch)=1.192e-07,2.037e-05,2.682e-07,8.717e-07,4.068e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.357e-01 S T(prep/alloc/comp/red/dealloc)=5.179e-03,8.046e-03,2.076e-01,1.744e-02,2.536e-03 -----
----- TIMING FOR oper_renorm_opS : 2.357e-01 S rank=0 -----
qops.to_cpu: size(tot)=796:6.073e-03MB:5.931e-06GB T(to_cpu)=8.532e-05S speed=6.951e-02GB/S
check ||H-H.dagger||=5.863e-15 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.3 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=3.364e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.249e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-2.652e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.123e+00 S #####
 T(local opt: fetch) = 9.972e-03 S  per = 0.888  per(accum) = 0.888
 T(local opt: hdiag) = 2.302e-01 S  per = 20.5  per(accum) = 21.4
 T(local opt: dvdsn) = 5.801e-01 S  per = 51.7  per(accum) = 73
 T(local opt: decim) = 7.049e-04 S  per = 0.0628  per(accum) = 73.1
 T(local opt: guess) = 2.980e-04 S  per = 0.0265  per(accum) = 73.1
 T(local opt: renrm) = 3.016e-01 S  per = 26.9  per(accum) = 100
 T(local opt: save ) = 2.165e-04 S  per = 0.0193  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.801e-01 S  T(sum) = 5.798e-01 S  per = 9.996e+01
 T(local opt: preprocess                  ) = 8.557e-04 S  per = 0.148  per(accum) = 0.148
 T(local opt: symbolic_formulae           ) = 3.529e-03 S  per = 0.609  per(accum) = 0.756
 T(local opt: hintermediate init          ) = 2.010e-04 S  per = 0.0347  per(accum) = 0.791
 T(local opt: preprocess_hformulae_Hxlist ) = 3.071e-02 S  per =  5.3  per(accum) = 6.09
 T(local opt: hmmtasks init               ) = 1.141e-02 S  per = 1.97  per(accum) = 8.06
 T(local opt: initial guess for dvdson    ) = 3.477e-04 S  per = 0.06  per(accum) = 8.12
 T(local opt: dvdson [Hx_batchGPU]        ) = 4.528e-01 S  per = 78.1  per(accum) = 86.2
 T(local opt: dvdson [cpu-gpu]            ) = 1.924e-02 S  per = 3.32  per(accum) = 89.5
 T(local opt: dvdson [nccl]               ) = 5.995e-02 S  per = 10.3  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 6.397e-06 S  per = 0.0011  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 7.448e-04 S  per = 0.128  per(accum) = 100
Detailed decomposition of T(renrm) = 3.016e-01 S  T(sum) = 3.016e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.729e-04 S  per = 0.0573  per(accum) = 0.0573
 T(local opt: qops init                    ) = 1.218e-03 S  per = 0.404  per(accum) = 0.461
 T(local opt: symbolic_formulae_renorm     ) = 1.834e-03 S  per = 0.608  per(accum) = 1.07
 T(local opt: allocate qops on gpu         ) = 5.481e-05 S  per = 0.0182  per(accum) = 1.09
 T(local opt: site memcpy cpu2gpu          ) = 1.245e-03 S  per = 0.413  per(accum) = 1.5
 T(local opt: rintermediate init           ) = 3.616e-04 S  per = 0.12  per(accum) = 1.62
 T(local opt: preprocess_formulae_Rlist2   ) = 1.057e-02 S  per =  3.5  per(accum) = 5.12
 T(local opt: rmmtasks init                ) = 6.400e-03 S  per = 2.12  per(accum) = 7.25
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 1.16e-05  per(accum) = 7.25
 T(local opt: preprocess_renorm_batchGPU   ) = 3.961e-02 S  per = 13.1  per(accum) = 20.4
 T(local opt: deallocate cpu and gpu memory) = 5.541e-05 S  per = 0.0184  per(accum) = 20.4
 T(local opt: construct opS [ifdists=true] ) = 2.357e-01 S  per = 78.2  per(accum) = 98.6
 T(local opt: reduction of opS & opH [nccl]) = 2.443e-03 S  per = 0.81  per(accum) = 99.4
 T(local opt: qops memcpy gpu2cpu          ) = 9.702e-05 S  per = 0.0322  per(accum) = 99.4
 T(local opt: reduction of opS & opH [mpi] ) = 4.498e-05 S  per = 0.0149  per(accum) = 99.4
 T(local opt: qops_pool join and erase     ) = 1.756e-03 S  per = 0.582  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 4.777e-06 S  per = 0.00158  per(accum) = 100
##### sweep opt: 1.797e+01 S #####
 T(sweep opt: fetch) = 1.613e-01 S  per = 0.897  per(accum) = 0.897
 T(sweep opt: hdiag) = 4.065e+00 S  per = 22.6  per(accum) = 23.5
 T(sweep opt: dvdsn) = 5.904e+00 S  per = 32.9  per(accum) = 56.4
 T(sweep opt: decim) = 1.466e-02 S  per = 0.0816  per(accum) = 56.5
 T(sweep opt: guess) = 8.915e-03 S  per = 0.0496  per(accum) = 56.5
 T(sweep opt: renrm) = 7.814e+00 S  per = 43.5  per(accum) = 100
 T(sweep opt: save ) = 2.820e-03 S  per = 0.0157  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.904e+00 S  T(sum) = 5.898e+00 S  per = 9.989e+01
 T(sweep opt: preprocess                  ) = 4.011e-02 S  per = 0.68  per(accum) = 0.68
 T(sweep opt: symbolic_formulae           ) = 5.260e-02 S  per = 0.892  per(accum) = 1.57
 T(sweep opt: hintermediate init          ) = 2.728e-03 S  per = 0.0463  per(accum) = 1.62
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.510e+00 S  per = 25.6  per(accum) = 27.2
 T(sweep opt: hmmtasks init               ) = 6.192e-01 S  per = 10.5  per(accum) = 37.7
 T(sweep opt: initial guess for dvdson    ) = 1.155e-02 S  per = 0.196  per(accum) = 37.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.003e+00 S  per = 50.9  per(accum) = 88.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.343e-01 S  per = 2.28  per(accum) = 91.1
 T(sweep opt: dvdson [nccl]               ) = 5.170e-01 S  per = 8.77  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 5.069e-05 S  per = 0.00086  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.794e-03 S  per = 0.115  per(accum) = 100
Detailed decomposition of T(renrm) = 7.814e+00 S  T(sum) = 7.814e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.497e-03 S  per = 0.0448  per(accum) = 0.0448
 T(sweep opt: qops init                    ) = 3.277e-02 S  per = 0.419  per(accum) = 0.464
 T(sweep opt: symbolic_formulae_renorm     ) = 1.634e-02 S  per = 0.209  per(accum) = 0.673
 T(sweep opt: allocate qops on gpu         ) = 8.360e-04 S  per = 0.0107  per(accum) = 0.684
 T(sweep opt: site memcpy cpu2gpu          ) = 1.601e-02 S  per = 0.205  per(accum) = 0.889
 T(sweep opt: rintermediate init           ) = 2.789e-02 S  per = 0.357  per(accum) = 1.25
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.125e-01 S  per = 2.72  per(accum) = 3.97
 T(sweep opt: rmmtasks init                ) = 1.102e-01 S  per = 1.41  per(accum) = 5.38
 T(sweep opt: qops memset on cpu           ) = 4.900e-07 S  per = 6.27e-06  per(accum) = 5.38
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.067e-01 S  per = 6.48  per(accum) = 11.9
 T(sweep opt: deallocate cpu and gpu memory) = 9.238e-04 S  per = 0.0118  per(accum) = 11.9
 T(sweep opt: construct opS [ifdists=true] ) = 6.726e+00 S  per = 86.1  per(accum) = 97.9
 T(sweep opt: reduction of opS & opH [nccl]) = 2.962e-02 S  per = 0.379  per(accum) = 98.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.365e-03 S  per = 0.0175  per(accum) = 98.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 7.462e-04 S  per = 0.00955  per(accum) = 98.4
 T(sweep opt: qops_pool join and erase     ) = 2.607e-02 S  per = 0.334  per(accum) = 98.7
 T(sweep opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 1.31  per(accum) = 100
##### global opt: 1.797e+01 S #####
 T(global opt: fetch) = 1.613e-01 S  per = 0.897  per(accum) = 0.897
 T(global opt: hdiag) = 4.065e+00 S  per = 22.6  per(accum) = 23.5
 T(global opt: dvdsn) = 5.904e+00 S  per = 32.9  per(accum) = 56.4
 T(global opt: decim) = 1.466e-02 S  per = 0.0816  per(accum) = 56.5
 T(global opt: guess) = 8.915e-03 S  per = 0.0496  per(accum) = 56.5
 T(global opt: renrm) = 7.814e+00 S  per = 43.5  per(accum) = 100
 T(global opt: save ) = 2.820e-03 S  per = 0.0157  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.904e+00 S  T(sum) = 5.898e+00 S  per = 9.989e+01
 T(global opt: preprocess                  ) = 4.011e-02 S  per = 0.68  per(accum) = 0.68
 T(global opt: symbolic_formulae           ) = 5.260e-02 S  per = 0.892  per(accum) = 1.57
 T(global opt: hintermediate init          ) = 2.728e-03 S  per = 0.0463  per(accum) = 1.62
 T(global opt: preprocess_hformulae_Hxlist ) = 1.510e+00 S  per = 25.6  per(accum) = 27.2
 T(global opt: hmmtasks init               ) = 6.192e-01 S  per = 10.5  per(accum) = 37.7
 T(global opt: initial guess for dvdson    ) = 1.155e-02 S  per = 0.196  per(accum) = 37.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.003e+00 S  per = 50.9  per(accum) = 88.8
 T(global opt: dvdson [cpu-gpu]            ) = 1.343e-01 S  per = 2.28  per(accum) = 91.1
 T(global opt: dvdson [nccl]               ) = 5.170e-01 S  per = 8.77  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 5.069e-05 S  per = 0.00086  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 6.794e-03 S  per = 0.115  per(accum) = 100
Detailed decomposition of T(renrm) = 7.814e+00 S  T(sum) = 7.814e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.497e-03 S  per = 0.0448  per(accum) = 0.0448
 T(global opt: qops init                    ) = 3.277e-02 S  per = 0.419  per(accum) = 0.464
 T(global opt: symbolic_formulae_renorm     ) = 1.634e-02 S  per = 0.209  per(accum) = 0.673
 T(global opt: allocate qops on gpu         ) = 8.360e-04 S  per = 0.0107  per(accum) = 0.684
 T(global opt: site memcpy cpu2gpu          ) = 1.601e-02 S  per = 0.205  per(accum) = 0.889
 T(global opt: rintermediate init           ) = 2.789e-02 S  per = 0.357  per(accum) = 1.25
 T(global opt: preprocess_formulae_Rlist2   ) = 2.125e-01 S  per = 2.72  per(accum) = 3.97
 T(global opt: rmmtasks init                ) = 1.102e-01 S  per = 1.41  per(accum) = 5.38
 T(global opt: qops memset on cpu           ) = 4.900e-07 S  per = 6.27e-06  per(accum) = 5.38
 T(global opt: preprocess_renorm_batchGPU   ) = 5.067e-01 S  per = 6.48  per(accum) = 11.9
 T(global opt: deallocate cpu and gpu memory) = 9.238e-04 S  per = 0.0118  per(accum) = 11.9
 T(global opt: construct opS [ifdists=true] ) = 6.726e+00 S  per = 86.1  per(accum) = 97.9
 T(global opt: reduction of opS & opH [nccl]) = 2.962e-02 S  per = 0.379  per(accum) = 98.3
 T(global opt: qops memcpy gpu2cpu          ) = 1.365e-03 S  per = 0.0175  per(accum) = 98.3
 T(global opt: reduction of opS & opH [mpi] ) = 7.462e-04 S  per = 0.00955  per(accum) = 98.4
 T(global opt: qops_pool join and erase     ) = 2.607e-02 S  per = 0.334  per(accum) = 98.7
 T(global opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 1.31  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-6.681e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=13/seqsize=34 dots=2 dbond=(14,0)-(15,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=377:2.876e-03MB:2.809e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=16:1.221e-04MB:1.192e-07GB
total mem of comb=394:3.006e-03MB:2.936e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=14,4,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 12 13 14 15
 suppc1= 10
 suppc2= 11
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:14 S:3 P:17 Q:22 
        dim(bra,ket)=8,8 size(op)=24:1.831e-04MB size(tot)=796:6.073e-03MB:5.931e-06GB
        per(mem): H:2.01 C:28.1 S:6.03 P:8.54 Q:55.3 
 rqops: oplist=HCSAB nops=H:1 C:4 S:8 A:8 B:10 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=34:0.000259MB:2.53e-07GB
        per(mem): H:5.88 C:11.8 S:23.5 A:0 B:58.8 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2826:0.0216MB:2.11e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.185e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(14,0) fdel=./scratch/sweep/rop(15,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.490e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(8,2,3,3) nnz=36:2.747e-04MB
qtensor4: wf4 own=1 _data=0x46812000
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=8
 (21,3):2 (23,3):2 (22,2):2 (22,4):2
 qbond: qcol nsym=2 dimAll=2
 (5,3):1 (6,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=18 nblocks=128 size=36:2.747e-04MB
### DIAG TIMING: total=1.695e-01 t1=2.587e-05, t2=1.679e-03, t3=2.479e-03, t4=1.628e-01, t5=3.300e-06, t6=2.499e-03, t7=5.406e-06
duration_diagGPU:1.695e-01
duration_diagreduce:7.300e-08
duration_diagtransform:3.790e-07
----- TIMING FOR symbolic_formulae_twodot with size=195 : 2.670e-03 S -----
rank=0 GPUmem(GB): used=2.106e-05 (oper)=2.106e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=195
 no. of hintermediate operators=94
 no. of coefficients=1215:9.270e-03MB:9.052e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.180e-04 S -----
rank=0 GPUmem(GB): used=3.011e-05 (oper,hinter)=2.106e-05,9.052e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.087e-02 S size(H_formulae)=195 size(Hxlst2)=18 T(Hmu/Hxlist)=4.981e-04,6.037e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.148e-02 S size(H_formulae)=195 size(Hxlst)=3722 -----
rank=0 GPUmem(GB): used=3.011e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=5.364e-07 batch[need]=2.496e-04 blksize=2 blksize0=4 batchsize=3722
rank=0 GPUmem(GB): used=2.802e-04 (oper,hinter,dvdson,batch)=2.106e-05,9.052e-06,5.364e-07,2.496e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=36 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.227e-03,7.612e-03,3.025e-02,1.279e-02,5.589e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.103e-04 speed=2.551e-03GB/S T(nccl)=5.017e-03 speed=1.069e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=69 t=7.6e-03 per=1.5e+01 cost=1.7e+05 flops=2.3e+07
 sigma[gemm] counter=69 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=4 t=7.6e-03 per=1.5e+01 cost=5.7e+03 flops=7.6e+05
 sigma[gemm] counter=69 i=5 t=7.6e-03 per=1.5e+01 cost=5.7e+03 flops=7.5e+05
 sigma[gemm] counter=69 i=6 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=69 i=7 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=69 total t=3.0e-02 per=6.0e+01 cost=3.5e+04 flops=1.2e+06
 sigma[red] counter=69 t=1.3e-02 per=2.5e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=4.3e-01 t_gemm=1.8e+00 t_reduction=8.1e-01 tot=3.0e+00 -----
 sigma_tot[inter] counter=69 t=4.3e-01 per=1.4e+01 cost=1.1e+07 flops=2.6e+07
 sigma_tot[gemm] counter=69 i=0 t=9.3e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=1 t=8.2e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=2 t=8.3e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=3 t=7.9e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=4 t=4.5e-01 per=1.5e+01 cost=1.1e+06 flops=2.5e+06
 sigma_tot[gemm] counter=69 i=5 t=4.6e-01 per=1.5e+01 cost=1.1e+06 flops=2.5e+06
 sigma_tot[gemm] counter=69 i=6 t=4.5e-01 per=1.5e+01 cost=1.4e+06 flops=3.2e+06
 sigma_tot[gemm] counter=69 i=7 t=4.4e-01 per=1.4e+01 cost=1.4e+06 flops=3.2e+06
 sigma_tot[gemm] counter=69 total t=1.8e+00 per=5.9e+01 cost=5.1e+06 flops=2.8e+06
 sigma_tot[red] counter=69 t=8.1e-01 per=2.7e+01 cost=1.9e+06 flops=2.4e+06
T(sub)=9.9e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.3e-06,2.1e-06,8.8e-07,2.1e-07
settings: ndim=36 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.196252217360 -1.116e+03  4.094e-02    1     1  5.606e-02 5.606e-02 5.603e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.462e-03,7.433e-03,2.988e-02,1.267e-02,5.845e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.242e-03 speed=2.393e-04GB/S T(nccl)=6.220e-03 speed=8.625e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=70 t=7.4e-03 per=1.5e+01 cost=1.7e+05 flops=2.3e+07
 sigma[gemm] counter=70 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=3 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=4 t=7.5e-03 per=1.5e+01 cost=5.7e+03 flops=7.7e+05
 sigma[gemm] counter=70 i=5 t=7.4e-03 per=1.5e+01 cost=5.7e+03 flops=7.7e+05
 sigma[gemm] counter=70 i=6 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=70 i=7 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=70 total t=3.0e-02 per=6.0e+01 cost=3.5e+04 flops=1.2e+06
 sigma[red] counter=70 t=1.3e-02 per=2.5e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=4.4e-01 t_gemm=1.8e+00 t_reduction=8.2e-01 tot=3.1e+00 -----
 sigma_tot[inter] counter=70 t=4.4e-01 per=1.4e+01 cost=1.1e+07 flops=2.6e+07
 sigma_tot[gemm] counter=70 i=0 t=9.4e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=1 t=8.3e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=2 t=8.4e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=3 t=8.0e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=4 t=4.6e-01 per=1.5e+01 cost=1.1e+06 flops=2.5e+06
 sigma_tot[gemm] counter=70 i=5 t=4.6e-01 per=1.5e+01 cost=1.1e+06 flops=2.5e+06
 sigma_tot[gemm] counter=70 i=6 t=4.5e-01 per=1.5e+01 cost=1.4e+06 flops=3.2e+06
 sigma_tot[gemm] counter=70 i=7 t=4.5e-01 per=1.4e+01 cost=1.4e+06 flops=3.2e+06
 sigma_tot[gemm] counter=70 total t=1.8e+00 per=5.9e+01 cost=5.1e+06 flops=2.8e+06
 sigma_tot[red] counter=70 t=8.2e-01 per=2.7e+01 cost=1.9e+06 flops=2.4e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.3e-05,3.6e-06,1.0e-06,2.0e-07
    2   0 -    -116.202249810006 -5.998e-03  1.488e-02    2     2  1.148e-01 5.738e-02 5.732e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.181e-02,7.407e-03,2.986e-02,1.286e-02,6.195e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.221e-03 speed=2.415e-04GB/S T(nccl)=9.594e-03 speed=5.592e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=71 t=7.4e-03 per=1.5e+01 cost=1.7e+05 flops=2.3e+07
 sigma[gemm] counter=71 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=4 t=7.5e-03 per=1.5e+01 cost=5.7e+03 flops=7.7e+05
 sigma[gemm] counter=71 i=5 t=7.5e-03 per=1.5e+01 cost=5.7e+03 flops=7.6e+05
 sigma[gemm] counter=71 i=6 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=71 i=7 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=71 total t=3.0e-02 per=6.0e+01 cost=3.5e+04 flops=1.2e+06
 sigma[red] counter=71 t=1.3e-02 per=2.6e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=4.5e-01 t_gemm=1.9e+00 t_reduction=8.4e-01 tot=3.1e+00 -----
 sigma_tot[inter] counter=71 t=4.5e-01 per=1.4e+01 cost=1.2e+07 flops=2.6e+07
 sigma_tot[gemm] counter=71 i=0 t=9.5e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=1 t=8.4e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=2 t=8.5e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=3 t=8.2e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=4 t=4.7e-01 per=1.5e+01 cost=1.1e+06 flops=2.4e+06
 sigma_tot[gemm] counter=71 i=5 t=4.7e-01 per=1.5e+01 cost=1.1e+06 flops=2.4e+06
 sigma_tot[gemm] counter=71 i=6 t=4.6e-01 per=1.5e+01 cost=1.4e+06 flops=3.1e+06
 sigma_tot[gemm] counter=71 i=7 t=4.5e-01 per=1.4e+01 cost=1.4e+06 flops=3.2e+06
 sigma_tot[gemm] counter=71 total t=1.9e+00 per=5.9e+01 cost=5.2e+06 flops=2.8e+06
 sigma_tot[red] counter=71 t=8.4e-01 per=2.7e+01 cost=2.0e+06 flops=2.3e+06
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.7e-05,3.8e-06,1.8e-06,2.0e-07
    3   0 -    -116.202875211260 -6.254e-04  3.960e-03    3     3  1.770e-01 5.899e-02 5.892e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.218e-03,7.518e-03,2.945e-02,1.276e-02,5.696e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.240e-03 speed=2.395e-04GB/S T(nccl)=4.977e-03 speed=1.078e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=2.9e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=72 t=7.5e-03 per=1.5e+01 cost=1.7e+05 flops=2.3e+07
 sigma[gemm] counter=72 i=0 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=4 t=7.4e-03 per=1.5e+01 cost=5.7e+03 flops=7.8e+05
 sigma[gemm] counter=72 i=5 t=7.4e-03 per=1.5e+01 cost=5.7e+03 flops=7.8e+05
 sigma[gemm] counter=72 i=6 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=72 i=7 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=72 total t=2.9e-02 per=5.9e+01 cost=3.5e+04 flops=1.2e+06
 sigma[red] counter=72 t=1.3e-02 per=2.6e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=4.6e-01 t_gemm=1.9e+00 t_reduction=8.5e-01 tot=3.2e+00 -----
 sigma_tot[inter] counter=72 t=4.6e-01 per=1.4e+01 cost=1.2e+07 flops=2.6e+07
 sigma_tot[gemm] counter=72 i=0 t=9.7e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=1 t=8.5e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=2 t=8.6e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=3 t=8.3e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=4 t=4.7e-01 per=1.5e+01 cost=1.1e+06 flops=2.4e+06
 sigma_tot[gemm] counter=72 i=5 t=4.8e-01 per=1.5e+01 cost=1.2e+06 flops=2.4e+06
 sigma_tot[gemm] counter=72 i=6 t=4.7e-01 per=1.5e+01 cost=1.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=72 i=7 t=4.6e-01 per=1.4e+01 cost=1.5e+06 flops=3.2e+06
 sigma_tot[gemm] counter=72 total t=1.9e+00 per=5.9e+01 cost=5.2e+06 flops=2.8e+06
 sigma_tot[red] counter=72 t=8.5e-01 per=2.7e+01 cost=2.0e+06 flops=2.3e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.4e-05,3.1e-06,1.0e-06,2.3e-07
    4   0 -    -116.202932669107 -5.746e-05  1.915e-03    3     4  2.342e-01 5.855e-02 5.848e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.190e-03,7.475e-03,3.008e-02,1.293e-02,5.768e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.203e-03 speed=2.435e-04GB/S T(nccl)=4.987e-03 speed=1.076e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=73 t=7.5e-03 per=1.5e+01 cost=1.7e+05 flops=2.3e+07
 sigma[gemm] counter=73 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=4 t=7.5e-03 per=1.5e+01 cost=5.7e+03 flops=7.7e+05
 sigma[gemm] counter=73 i=5 t=7.6e-03 per=1.5e+01 cost=5.7e+03 flops=7.6e+05
 sigma[gemm] counter=73 i=6 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=73 i=7 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=73 total t=3.0e-02 per=6.0e+01 cost=3.5e+04 flops=1.2e+06
 sigma[red] counter=73 t=1.3e-02 per=2.6e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=4.6e-01 t_gemm=1.9e+00 t_reduction=8.6e-01 tot=3.2e+00 -----
 sigma_tot[inter] counter=73 t=4.6e-01 per=1.4e+01 cost=1.2e+07 flops=2.6e+07
 sigma_tot[gemm] counter=73 i=0 t=9.8e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=1 t=8.7e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=2 t=8.7e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=3 t=8.4e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=4 t=4.8e-01 per=1.5e+01 cost=1.2e+06 flops=2.4e+06
 sigma_tot[gemm] counter=73 i=5 t=4.9e-01 per=1.5e+01 cost=1.2e+06 flops=2.4e+06
 sigma_tot[gemm] counter=73 i=6 t=4.8e-01 per=1.5e+01 cost=1.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=73 i=7 t=4.7e-01 per=1.4e+01 cost=1.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=73 total t=1.9e+00 per=5.9e+01 cost=5.2e+06 flops=2.7e+06
 sigma_tot[red] counter=73 t=8.6e-01 per=2.7e+01 cost=2.0e+06 flops=2.3e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.3e-05,2.9e-06,1.1e-06,1.9e-07
    5   0 -    -116.202943937305 -1.127e-05  6.161e-04    3     5  2.921e-01 5.843e-02 5.836e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.134e-03,7.428e-03,2.983e-02,1.293e-02,5.832e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.264e-03 speed=2.369e-04GB/S T(nccl)=5.870e-03 speed=9.139e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=74 t=7.4e-03 per=1.5e+01 cost=1.7e+05 flops=2.3e+07
 sigma[gemm] counter=74 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=4 t=7.4e-03 per=1.5e+01 cost=5.7e+03 flops=7.8e+05
 sigma[gemm] counter=74 i=5 t=7.4e-03 per=1.5e+01 cost=5.7e+03 flops=7.8e+05
 sigma[gemm] counter=74 i=6 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=74 i=7 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=74 total t=3.0e-02 per=5.9e+01 cost=3.5e+04 flops=1.2e+06
 sigma[red] counter=74 t=1.3e-02 per=2.6e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=4.7e-01 t_gemm=1.9e+00 t_reduction=8.8e-01 tot=3.3e+00 -----
 sigma_tot[inter] counter=74 t=4.7e-01 per=1.4e+01 cost=1.2e+07 flops=2.6e+07
 sigma_tot[gemm] counter=74 i=0 t=9.9e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=1 t=8.8e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=2 t=8.9e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=3 t=8.5e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=4 t=4.9e-01 per=1.5e+01 cost=1.2e+06 flops=2.4e+06
 sigma_tot[gemm] counter=74 i=5 t=4.9e-01 per=1.5e+01 cost=1.2e+06 flops=2.4e+06
 sigma_tot[gemm] counter=74 i=6 t=4.8e-01 per=1.5e+01 cost=1.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=74 i=7 t=4.8e-01 per=1.4e+01 cost=1.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=74 total t=1.9e+00 per=5.9e+01 cost=5.3e+06 flops=2.7e+06
 sigma_tot[red] counter=74 t=8.8e-01 per=2.7e+01 cost=2.0e+06 flops=2.3e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.3e-05,3.1e-06,1.0e-06,2.5e-07
    6   0 -    -116.202945021282 -1.084e-06  2.034e-04    3     6  3.507e-01 5.845e-02 5.839e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.551e-03,7.602e-03,2.987e-02,1.287e-02,5.890e-02
 analyze_tgpu[Hx]: ndim=36:2.682e-07GB T(cpu-gpu)=2.173e-03 speed=2.469e-04GB/S T(nccl)=6.378e-03 speed=8.411e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=75 t=7.6e-03 per=1.5e+01 cost=1.7e+05 flops=2.3e+07
 sigma[gemm] counter=75 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=4 t=7.5e-03 per=1.5e+01 cost=5.7e+03 flops=7.6e+05
 sigma[gemm] counter=75 i=5 t=7.4e-03 per=1.5e+01 cost=5.7e+03 flops=7.7e+05
 sigma[gemm] counter=75 i=6 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=75 i=7 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=75 total t=3.0e-02 per=5.9e+01 cost=3.5e+04 flops=1.2e+06
 sigma[red] counter=75 t=1.3e-02 per=2.6e+01 cost=1.5e+04 flops=1.2e+06
----- TIMING FOR sigma_tot : t_inter=4.8e-01 t_gemm=2.0e+00 t_reduction=8.9e-01 tot=3.3e+00 -----
 sigma_tot[inter] counter=75 t=4.8e-01 per=1.4e+01 cost=1.2e+07 flops=2.6e+07
 sigma_tot[gemm] counter=75 i=0 t=1.0e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=1 t=8.9e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=2 t=9.0e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=3 t=8.6e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=4 t=5.0e-01 per=1.5e+01 cost=1.2e+06 flops=2.3e+06
 sigma_tot[gemm] counter=75 i=5 t=5.0e-01 per=1.5e+01 cost=1.2e+06 flops=2.3e+06
 sigma_tot[gemm] counter=75 i=6 t=4.9e-01 per=1.5e+01 cost=1.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=75 i=7 t=4.8e-01 per=1.5e+01 cost=1.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=75 total t=2.0e+00 per=5.9e+01 cost=5.3e+06 flops=2.7e+06
 sigma_tot[red] counter=75 t=8.9e-01 per=2.7e+01 cost=2.0e+06 flops=2.3e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.3e-05,3.1e-06,9.9e-07,2.3e-07
    7   0 +    -116.202945188390 -1.671e-07  6.969e-05    3     7  4.100e-01 5.856e-02 5.849e-02
TIMING FOR Davidson : 4.100e-01  T(cal/comm/rest)=4.094e-01,5.856e-06,5.594e-04
decomposed t_rest=5.594e-04
 T(sub)    =1.452e-04 per=2.596e+01
 T(precond)=5.167e-05 per=9.237e+00
 T(ortho)  =1.377e-05 per=2.462e+00
 T(xcopy)  =9.170e-07 per=1.639e-01
 T(xnrm2)  =2.314e-05 per=4.136e+00
 T(other)  =3.247e-04 per=5.804e+01
optimized energies: isweep=0 ibond=13 dots=2 e[0]=-116.202945188390 nmvp=7
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.061e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond13.txt
 qbond: qsuper nsym=9 dimAll=32
 (21,3):2 (23,3):8 (22,2):4 (22,4):4 (25,3):2 (24,2):4 (24,4):4 (23,1):2 (23,5):2
timing for divide=6.7e-05
timing for compute=6.8e-05
timing for collect=1.9e-05
----- TMING FOR decimation_genbasis(su2): 1.5e-04 S T(divide/compute[cpu/gpu/rest]/collect)=6.7e-05,5.7e-05,0.0e+00,1.1e-05,1.9e-05 -----
decimation summary: 32->8 dwt=-2.220e-16 SvN=2.755e-01
 qbond: qkept nsym=6 dimAll=8
 (23,3):2 (24,2):2 (22,2):1 (25,3):1 (24,4):1 (23,1):1
----- TIMING for decimation_row(nkr): 5.223e-04 S T(decim/select/formRot)=2.407e-04,1.890e-04,9.265e-05 -----
----- TIMING FOR twodot_decimation: 8.757e-04 S T(wf/decim)=3.392e-04,5.365e-04 -----
ctns::oper_renorm coord=(14,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:15 S:3 P:12 Q:16 
        dim(bra,ket)=8,8 size(op)=20:1.526e-04MB size(tot)=578:4.410e-03MB:4.306e-06GB
        per(mem): H:2.08 C:36.3 S:7.27 P:10 Q:44.3 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.386e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=44 : 1.554e-03 S -----
rank=0 GPUmem(GB): used=3.416e-05 (oper)=1.767e-05
rank=0 GPUmem(GB): used=3.443e-05 (oper,site)=1.767e-05,2.682e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=44
 no. of rintermediate operators=44
 no. of coefficients=616:4.700e-03MB:4.590e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.525e-03 S -----
rank=0 GPUmem(GB): used=3.902e-05 (oper,site,rinter)=1.767e-05,2.682e-07,4.590e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.361e-02 S size(rtasks)=44 size(Rlst2)=36 T(Rmu/Rlist)=3.843e-04,1.322e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.383e-02 S size(rtasks)=44 size(Rlst)=1162 -----
rank=0 GPUmem(GB): used=3.902e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.125e-04 blksize=4 blksize0=4 batchsize=1162
rank=0 GPUmem(GB): used=1.516e-04 (oper,site,rinter,batch)=1.767e-05,2.682e-07,4.590e-06,1.125e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.872e-03,2.262e-02,9.994e-03
----- TIMING FOR renorm : t_inter=5.9e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=170 t=5.9e-03 per=1.5e+01 cost=3.9e+04 flops=6.7e+06
 renorm[gemm] counter=170 i=0 t=1.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=170 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=170 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=170 i=3 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=170 i=4 t=7.6e-03 per=2.0e+01 cost=3.4e+03 flops=4.5e+05
 renorm[gemm] counter=170 i=5 t=7.5e-03 per=1.9e+01 cost=8.6e+03 flops=1.2e+06
 renorm[gemm] counter=170 i=6 t=7.5e-03 per=1.9e+01 cost=1.2e+04 flops=1.6e+06
 renorm[gemm] counter=170 total t=2.3e-02 per=5.9e+01 cost=2.4e+04 flops=1.1e+06
 renorm[red] counter=170 t=1.0e-02 per=2.6e+01 cost=5.9e+03 flops=5.9e+05
----- TIMING FOR renorm_tot : t_inter=8.9e-02 t_gemm=3.1e-01 t_reduction=1.4e-01 tot=5.4e-01 -----
 renorm_tot[inter] counter=170 t=8.9e-02 per=1.6e+01 cost=3.6e+05 flops=4.1e+06
 renorm_tot[gemm] counter=170 i=0 t=1.9e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=170 i=1 t=1.6e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=170 i=2 t=1.6e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=170 i=3 t=1.6e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=170 i=4 t=1.0e-01 per=1.9e+01 cost=4.3e+04 flops=4.1e+05
 renorm_tot[gemm] counter=170 i=5 t=1.0e-01 per=1.9e+01 cost=1.3e+05 flops=1.2e+06
 renorm_tot[gemm] counter=170 i=6 t=1.1e-01 per=1.9e+01 cost=2.1e+05 flops=2.0e+06
 renorm_tot[gemm] counter=170 total t=3.1e-01 per=5.8e+01 cost=3.8e+05 flops=1.2e+06
 renorm_tot[red] counter=170 t=1.4e-01 per=2.6e+01 cost=1.2e+05 flops=8.6e+05
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.979e-05 (optmp,oper)=1.043e-07,1.767e-05
rank=0 GPUmem(GB): used=4.006e-05 (optmp,oper,site,rinter)=1.043e-07,1.767e-05,2.682e-07,9.388e-07
rank=0 GPUmem(GB): used=4.674e-05 (optmp,oper,site,rinter,batch)=1.043e-07,1.767e-05,2.682e-07,9.388e-07,6.683e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.909e-01 S T(prep/alloc/comp/red/dealloc)=5.528e-03,8.427e-03,1.437e-01,3.631e-02,2.498e-03 -----
----- TIMING FOR oper_renorm_opS : 1.910e-01 S rank=0 -----
qops.to_cpu: size(tot)=578:4.410e-03MB:4.306e-06GB T(to_cpu)=7.123e-05S speed=6.046e-02GB/S
check ||H-H.dagger||=2.355e-15 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.26 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=3.531e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=9.079e-04 change=-1.243e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=9.079e-04 change=-3.710e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 9.461e-01 S #####
 T(local opt: fetch) = 9.831e-03 S  per = 1.04  per(accum) = 1.04
 T(local opt: hdiag) = 1.699e-01 S  per =   18  per(accum) = 19
 T(local opt: dvdsn) = 5.025e-01 S  per = 53.1  per(accum) = 72.1
 T(local opt: decim) = 9.784e-04 S  per = 0.103  per(accum) = 72.2
 T(local opt: guess) = 5.638e-04 S  per = 0.0596  per(accum) = 72.3
 T(local opt: renrm) = 2.621e-01 S  per = 27.7  per(accum) = 100
 T(local opt: save ) = 2.122e-04 S  per = 0.0224  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.025e-01 S  T(sum) = 5.020e-01 S  per = 9.991e+01
 T(local opt: preprocess                  ) = 1.794e-03 S  per = 0.357  per(accum) = 0.357
 T(local opt: symbolic_formulae           ) = 2.685e-03 S  per = 0.535  per(accum) = 0.892
 T(local opt: hintermediate init          ) = 1.856e-04 S  per = 0.037  per(accum) = 0.929
 T(local opt: preprocess_hformulae_Hxlist ) = 6.161e-02 S  per = 12.3  per(accum) = 13.2
 T(local opt: hmmtasks init               ) = 2.517e-02 S  per = 5.01  per(accum) = 18.2
 T(local opt: initial guess for dvdson    ) = 5.592e-04 S  per = 0.111  per(accum) = 18.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.528e-01 S  per = 70.3  per(accum) = 88.6
 T(local opt: dvdson [cpu-gpu]            ) = 1.355e-02 S  per =  2.7  per(accum) = 91.3
 T(local opt: dvdson [nccl]               ) = 4.304e-02 S  per = 8.57  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 5.856e-06 S  per = 0.00117  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 5.594e-04 S  per = 0.111  per(accum) = 100
Detailed decomposition of T(renrm) = 2.621e-01 S  T(sum) = 2.621e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.579e-04 S  per = 0.0984  per(accum) = 0.0984
 T(local opt: qops init                    ) = 2.111e-03 S  per = 0.805  per(accum) = 0.904
 T(local opt: symbolic_formulae_renorm     ) = 1.567e-03 S  per = 0.598  per(accum) = 1.5
 T(local opt: allocate qops on gpu         ) = 5.041e-05 S  per = 0.0192  per(accum) = 1.52
 T(local opt: site memcpy cpu2gpu          ) = 4.542e-04 S  per = 0.173  per(accum) = 1.69
 T(local opt: rintermediate init           ) = 2.540e-03 S  per = 0.969  per(accum) = 2.66
 T(local opt: preprocess_formulae_Rlist2   ) = 1.388e-02 S  per = 5.29  per(accum) = 7.96
 T(local opt: rmmtasks init                ) = 7.102e-03 S  per = 2.71  per(accum) = 10.7
 T(local opt: qops memset on cpu           ) = 3.000e-08 S  per = 1.14e-05  per(accum) = 10.7
 T(local opt: preprocess_renorm_batchGPU   ) = 3.866e-02 S  per = 14.7  per(accum) = 25.4
 T(local opt: deallocate cpu and gpu memory) = 6.463e-05 S  per = 0.0247  per(accum) = 25.4
 T(local opt: construct opS [ifdists=true] ) = 1.911e-01 S  per = 72.9  per(accum) = 98.3
 T(local opt: reduction of opS & opH [nccl]) = 2.356e-03 S  per = 0.899  per(accum) = 99.2
 T(local opt: qops memcpy gpu2cpu          ) = 8.382e-05 S  per = 0.032  per(accum) = 99.3
 T(local opt: reduction of opS & opH [mpi] ) = 6.648e-05 S  per = 0.0254  per(accum) = 99.3
 T(local opt: qops_pool join and erase     ) = 1.858e-03 S  per = 0.709  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 6.132e-06 S  per = 0.00234  per(accum) = 100
##### sweep opt: 1.892e+01 S #####
 T(sweep opt: fetch) = 1.711e-01 S  per = 0.904  per(accum) = 0.904
 T(sweep opt: hdiag) = 4.235e+00 S  per = 22.4  per(accum) = 23.3
 T(sweep opt: dvdsn) = 6.407e+00 S  per = 33.9  per(accum) = 57.2
 T(sweep opt: decim) = 1.563e-02 S  per = 0.0827  per(accum) = 57.2
 T(sweep opt: guess) = 9.479e-03 S  per = 0.0501  per(accum) = 57.3
 T(sweep opt: renrm) = 8.076e+00 S  per = 42.7  per(accum) = 100
 T(sweep opt: save ) = 3.032e-03 S  per = 0.016  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.407e+00 S  T(sum) = 6.400e+00 S  per = 9.989e+01
 T(sweep opt: preprocess                  ) = 4.191e-02 S  per = 0.655  per(accum) = 0.655
 T(sweep opt: symbolic_formulae           ) = 5.529e-02 S  per = 0.864  per(accum) = 1.52
 T(sweep opt: hintermediate init          ) = 2.914e-03 S  per = 0.0455  per(accum) = 1.56
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.572e+00 S  per = 24.6  per(accum) = 26.1
 T(sweep opt: hmmtasks init               ) = 6.443e-01 S  per = 10.1  per(accum) = 36.2
 T(sweep opt: initial guess for dvdson    ) = 1.210e-02 S  per = 0.189  per(accum) = 36.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.356e+00 S  per = 52.4  per(accum) = 88.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.479e-01 S  per = 2.31  per(accum) = 91.1
 T(sweep opt: dvdson [nccl]               ) = 5.601e-01 S  per = 8.75  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 5.655e-05 S  per = 0.000884  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.354e-03 S  per = 0.115  per(accum) = 100
Detailed decomposition of T(renrm) = 8.076e+00 S  T(sum) = 8.076e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.755e-03 S  per = 0.0465  per(accum) = 0.0465
 T(sweep opt: qops init                    ) = 3.488e-02 S  per = 0.432  per(accum) = 0.478
 T(sweep opt: symbolic_formulae_renorm     ) = 1.791e-02 S  per = 0.222  per(accum) = 0.7
 T(sweep opt: allocate qops on gpu         ) = 8.864e-04 S  per = 0.011  per(accum) = 0.711
 T(sweep opt: site memcpy cpu2gpu          ) = 1.647e-02 S  per = 0.204  per(accum) = 0.915
 T(sweep opt: rintermediate init           ) = 3.043e-02 S  per = 0.377  per(accum) = 1.29
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.264e-01 S  per =  2.8  per(accum) = 4.1
 T(sweep opt: rmmtasks init                ) = 1.173e-01 S  per = 1.45  per(accum) = 5.55
 T(sweep opt: qops memset on cpu           ) = 5.200e-07 S  per = 6.44e-06  per(accum) = 5.55
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.454e-01 S  per = 6.75  per(accum) = 12.3
 T(sweep opt: deallocate cpu and gpu memory) = 9.884e-04 S  per = 0.0122  per(accum) = 12.3
 T(sweep opt: construct opS [ifdists=true] ) = 6.917e+00 S  per = 85.6  per(accum) = 98
 T(sweep opt: reduction of opS & opH [nccl]) = 3.198e-02 S  per = 0.396  per(accum) = 98.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.449e-03 S  per = 0.0179  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 8.127e-04 S  per = 0.0101  per(accum) = 98.4
 T(sweep opt: qops_pool join and erase     ) = 2.793e-02 S  per = 0.346  per(accum) = 98.7
 T(sweep opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 1.27  per(accum) = 100
##### global opt: 1.892e+01 S #####
 T(global opt: fetch) = 1.711e-01 S  per = 0.904  per(accum) = 0.904
 T(global opt: hdiag) = 4.235e+00 S  per = 22.4  per(accum) = 23.3
 T(global opt: dvdsn) = 6.407e+00 S  per = 33.9  per(accum) = 57.2
 T(global opt: decim) = 1.563e-02 S  per = 0.0827  per(accum) = 57.2
 T(global opt: guess) = 9.479e-03 S  per = 0.0501  per(accum) = 57.3
 T(global opt: renrm) = 8.076e+00 S  per = 42.7  per(accum) = 100
 T(global opt: save ) = 3.032e-03 S  per = 0.016  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.407e+00 S  T(sum) = 6.400e+00 S  per = 9.989e+01
 T(global opt: preprocess                  ) = 4.191e-02 S  per = 0.655  per(accum) = 0.655
 T(global opt: symbolic_formulae           ) = 5.529e-02 S  per = 0.864  per(accum) = 1.52
 T(global opt: hintermediate init          ) = 2.914e-03 S  per = 0.0455  per(accum) = 1.56
 T(global opt: preprocess_hformulae_Hxlist ) = 1.572e+00 S  per = 24.6  per(accum) = 26.1
 T(global opt: hmmtasks init               ) = 6.443e-01 S  per = 10.1  per(accum) = 36.2
 T(global opt: initial guess for dvdson    ) = 1.210e-02 S  per = 0.189  per(accum) = 36.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.356e+00 S  per = 52.4  per(accum) = 88.8
 T(global opt: dvdson [cpu-gpu]            ) = 1.479e-01 S  per = 2.31  per(accum) = 91.1
 T(global opt: dvdson [nccl]               ) = 5.601e-01 S  per = 8.75  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 5.655e-05 S  per = 0.000884  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 7.354e-03 S  per = 0.115  per(accum) = 100
Detailed decomposition of T(renrm) = 8.076e+00 S  T(sum) = 8.076e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.755e-03 S  per = 0.0465  per(accum) = 0.0465
 T(global opt: qops init                    ) = 3.488e-02 S  per = 0.432  per(accum) = 0.478
 T(global opt: symbolic_formulae_renorm     ) = 1.791e-02 S  per = 0.222  per(accum) = 0.7
 T(global opt: allocate qops on gpu         ) = 8.864e-04 S  per = 0.011  per(accum) = 0.711
 T(global opt: site memcpy cpu2gpu          ) = 1.647e-02 S  per = 0.204  per(accum) = 0.915
 T(global opt: rintermediate init           ) = 3.043e-02 S  per = 0.377  per(accum) = 1.29
 T(global opt: preprocess_formulae_Rlist2   ) = 2.264e-01 S  per =  2.8  per(accum) = 4.1
 T(global opt: rmmtasks init                ) = 1.173e-01 S  per = 1.45  per(accum) = 5.55
 T(global opt: qops memset on cpu           ) = 5.200e-07 S  per = 6.44e-06  per(accum) = 5.55
 T(global opt: preprocess_renorm_batchGPU   ) = 5.454e-01 S  per = 6.75  per(accum) = 12.3
 T(global opt: deallocate cpu and gpu memory) = 9.884e-04 S  per = 0.0122  per(accum) = 12.3
 T(global opt: construct opS [ifdists=true] ) = 6.917e+00 S  per = 85.6  per(accum) = 98
 T(global opt: reduction of opS & opH [nccl]) = 3.198e-02 S  per = 0.396  per(accum) = 98.4
 T(global opt: qops memcpy gpu2cpu          ) = 1.449e-03 S  per = 0.0179  per(accum) = 98.4
 T(global opt: reduction of opS & opH [mpi] ) = 8.127e-04 S  per = 0.0101  per(accum) = 98.4
 T(global opt: qops_pool join and erase     ) = 2.793e-02 S  per = 0.346  per(accum) = 98.7
 T(global opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 1.27  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.054e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=14/seqsize=34 dots=2 dbond=(15,0)-(16,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=409:3.120e-03MB:3.047e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=12:9.155e-05MB:8.941e-08GB
total mem of comb=422:3.220e-03MB:3.144e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=15,3,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 13 14 15
 suppc1= 11
 suppc2= 12
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:15 S:3 P:12 Q:16 
        dim(bra,ket)=8,8 size(op)=20:1.526e-04MB size(tot)=578:4.410e-03MB:4.306e-06GB
        per(mem): H:2.08 C:36.3 S:7.27 P:10 Q:44.3 
 rqops: oplist=HCSAB nops=H:1 C:3 S:8 A:4 B:7 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=27:0.000206MB:2.01e-07GB
        per(mem): H:7.41 C:11.1 S:29.6 A:0 B:51.9 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2601:0.0198MB:1.94e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.136e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(15,0) fdel=./scratch/sweep/rop(16,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.086e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(8,2,3,3) nnz=30:2.289e-04MB
qtensor4: wf4 own=1 _data=0x46dfad20
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=8
 (23,3):2 (24,2):2 (22,2):1 (25,3):1 (24,4):1 (23,1):1
 qbond: qcol nsym=2 dimAll=2
 (3,3):1 (4,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=192 size=30:2.289e-04MB
### DIAG TIMING: total=1.380e-01 t1=2.680e-05, t2=1.536e-03, t3=2.497e-03, t4=1.315e-01, t5=3.257e-06, t6=2.482e-03, t7=5.339e-06
duration_diagGPU:1.380e-01
duration_diagreduce:4.900e-08
duration_diagtransform:3.540e-07
----- TIMING FOR symbolic_formulae_twodot with size=149 : 2.018e-03 S -----
rank=0 GPUmem(GB): used=1.938e-05 (oper)=1.938e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=149
 no. of hintermediate operators=68
 no. of coefficients=868:6.622e-03MB:6.467e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 9.980e-05 S -----
rank=0 GPUmem(GB): used=2.585e-05 (oper,hinter)=1.938e-05,6.467e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.689e-02 S size(H_formulae)=149 size(Hxlst2)=21 T(Hmu/Hxlist)=3.724e-04,5.651e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.742e-02 S size(H_formulae)=149 size(Hxlst)=3602 -----
rank=0 GPUmem(GB): used=2.585e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=4.470e-07 batch[need]=2.415e-04 blksize=2 blksize0=4 batchsize=3602
rank=0 GPUmem(GB): used=2.678e-04 (oper,hinter,dvdson,batch)=1.938e-05,6.467e-06,4.470e-07,2.415e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=30 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.087e-03,7.660e-03,3.034e-02,1.275e-02,5.885e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=1.132e-03 speed=3.950e-04GB/S T(nccl)=6.955e-03 speed=6.428e-05GB/S
----- TIMING FOR sigma : t_inter=7.7e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=76 t=7.7e-03 per=1.5e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=76 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=1 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=4 t=7.6e-03 per=1.5e+01 cost=4.0e+03 flops=5.2e+05
 sigma[gemm] counter=76 i=5 t=7.5e-03 per=1.5e+01 cost=4.0e+03 flops=5.3e+05
 sigma[gemm] counter=76 i=6 t=7.7e-03 per=1.5e+01 cost=6.2e+03 flops=8.1e+05
 sigma[gemm] counter=76 i=7 t=7.6e-03 per=1.5e+01 cost=6.2e+03 flops=8.2e+05
 sigma[gemm] counter=76 total t=3.0e-02 per=6.0e+01 cost=2.0e+04 flops=6.7e+05
 sigma[red] counter=76 t=1.3e-02 per=2.5e+01 cost=1.1e+04 flops=8.3e+05
----- TIMING FOR sigma_tot : t_inter=4.9e-01 t_gemm=2.0e+00 t_reduction=9.0e-01 tot=3.4e+00 -----
 sigma_tot[inter] counter=76 t=4.9e-01 per=1.4e+01 cost=1.2e+07 flops=2.5e+07
 sigma_tot[gemm] counter=76 i=0 t=1.0e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=1 t=9.0e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=2 t=9.1e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=3 t=8.7e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=4 t=5.0e-01 per=1.5e+01 cost=1.2e+06 flops=2.3e+06
 sigma_tot[gemm] counter=76 i=5 t=5.1e-01 per=1.5e+01 cost=1.2e+06 flops=2.3e+06
 sigma_tot[gemm] counter=76 i=6 t=5.0e-01 per=1.5e+01 cost=1.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=76 i=7 t=4.9e-01 per=1.5e+01 cost=1.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=76 total t=2.0e+00 per=5.9e+01 cost=5.3e+06 flops=2.7e+06
 sigma_tot[red] counter=76 t=9.0e-01 per=2.7e+01 cost=2.0e+06 flops=2.2e+06
T(sub)=9.7e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,4.1e-06,2.2e-06,7.5e-07,2.1e-07
settings: ndim=30 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.202945188390 -1.116e+03  6.357e-02    1     1  5.912e-02 5.912e-02 5.908e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.209e-03,7.511e-03,3.014e-02,1.284e-02,5.871e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.180e-03 speed=2.050e-04GB/S T(nccl)=6.028e-03 speed=7.415e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=77 t=7.5e-03 per=1.5e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=77 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=4 t=7.6e-03 per=1.5e+01 cost=4.0e+03 flops=5.2e+05
 sigma[gemm] counter=77 i=5 t=7.5e-03 per=1.5e+01 cost=4.0e+03 flops=5.3e+05
 sigma[gemm] counter=77 i=6 t=7.6e-03 per=1.5e+01 cost=6.2e+03 flops=8.2e+05
 sigma[gemm] counter=77 i=7 t=7.5e-03 per=1.5e+01 cost=6.2e+03 flops=8.3e+05
 sigma[gemm] counter=77 total t=3.0e-02 per=6.0e+01 cost=2.0e+04 flops=6.7e+05
 sigma[red] counter=77 t=1.3e-02 per=2.5e+01 cost=1.1e+04 flops=8.2e+05
----- TIMING FOR sigma_tot : t_inter=4.9e-01 t_gemm=2.0e+00 t_reduction=9.1e-01 tot=3.4e+00 -----
 sigma_tot[inter] counter=77 t=4.9e-01 per=1.4e+01 cost=1.2e+07 flops=2.5e+07
 sigma_tot[gemm] counter=77 i=0 t=1.0e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=1 t=9.1e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=2 t=9.2e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=3 t=8.8e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=4 t=5.1e-01 per=1.5e+01 cost=1.2e+06 flops=2.3e+06
 sigma_tot[gemm] counter=77 i=5 t=5.2e-01 per=1.5e+01 cost=1.2e+06 flops=2.3e+06
 sigma_tot[gemm] counter=77 i=6 t=5.1e-01 per=1.5e+01 cost=1.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=77 i=7 t=5.0e-01 per=1.5e+01 cost=1.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=77 total t=2.0e+00 per=5.9e+01 cost=5.4e+06 flops=2.6e+06
 sigma_tot[red] counter=77 t=9.1e-01 per=2.7e+01 cost=2.0e+06 flops=2.2e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.1e-05,3.6e-06,9.5e-07,2.4e-07
    2   0 -    -116.230168957200 -2.722e-02  2.186e-02    2     2  1.181e-01 5.907e-02 5.901e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.008e-03,7.586e-03,2.973e-02,1.292e-02,5.924e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.228e-03 speed=2.006e-04GB/S T(nccl)=6.780e-03 speed=6.593e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=78 t=7.6e-03 per=1.5e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=78 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=4 t=7.4e-03 per=1.5e+01 cost=4.0e+03 flops=5.4e+05
 sigma[gemm] counter=78 i=5 t=7.4e-03 per=1.5e+01 cost=4.0e+03 flops=5.3e+05
 sigma[gemm] counter=78 i=6 t=7.4e-03 per=1.5e+01 cost=6.2e+03 flops=8.3e+05
 sigma[gemm] counter=78 i=7 t=7.4e-03 per=1.5e+01 cost=6.2e+03 flops=8.3e+05
 sigma[gemm] counter=78 total t=3.0e-02 per=5.9e+01 cost=2.0e+04 flops=6.8e+05
 sigma[red] counter=78 t=1.3e-02 per=2.6e+01 cost=1.1e+04 flops=8.2e+05
----- TIMING FOR sigma_tot : t_inter=5.0e-01 t_gemm=2.1e+00 t_reduction=9.3e-01 tot=3.5e+00 -----
 sigma_tot[inter] counter=78 t=5.0e-01 per=1.4e+01 cost=1.3e+07 flops=2.5e+07
 sigma_tot[gemm] counter=78 i=0 t=1.0e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=1 t=9.2e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=2 t=9.3e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=3 t=9.0e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=4 t=5.2e-01 per=1.5e+01 cost=1.2e+06 flops=2.3e+06
 sigma_tot[gemm] counter=78 i=5 t=5.2e-01 per=1.5e+01 cost=1.2e+06 flops=2.3e+06
 sigma_tot[gemm] counter=78 i=6 t=5.1e-01 per=1.5e+01 cost=1.5e+06 flops=2.9e+06
 sigma_tot[gemm] counter=78 i=7 t=5.1e-01 per=1.5e+01 cost=1.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=78 total t=2.1e+00 per=5.9e+01 cost=5.4e+06 flops=2.6e+06
 sigma_tot[red] counter=78 t=9.3e-01 per=2.7e+01 cost=2.0e+06 flops=2.2e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.5e-05,3.2e-06,9.3e-07,2.1e-07
    3   0 -    -116.231742752540 -1.574e-03  1.100e-02    3     3  1.777e-01 5.923e-02 5.915e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.083e-03,7.499e-03,3.023e-02,1.275e-02,5.956e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.226e-03 speed=2.008e-04GB/S T(nccl)=6.858e-03 speed=6.519e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=79 t=7.5e-03 per=1.5e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=79 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=4 t=7.6e-03 per=1.5e+01 cost=4.0e+03 flops=5.3e+05
 sigma[gemm] counter=79 i=5 t=7.5e-03 per=1.5e+01 cost=4.0e+03 flops=5.3e+05
 sigma[gemm] counter=79 i=6 t=7.6e-03 per=1.5e+01 cost=6.2e+03 flops=8.1e+05
 sigma[gemm] counter=79 i=7 t=7.6e-03 per=1.5e+01 cost=6.2e+03 flops=8.1e+05
 sigma[gemm] counter=79 total t=3.0e-02 per=6.0e+01 cost=2.0e+04 flops=6.7e+05
 sigma[red] counter=79 t=1.3e-02 per=2.5e+01 cost=1.1e+04 flops=8.3e+05
----- TIMING FOR sigma_tot : t_inter=5.1e-01 t_gemm=2.1e+00 t_reduction=9.4e-01 tot=3.5e+00 -----
 sigma_tot[inter] counter=79 t=5.1e-01 per=1.4e+01 cost=1.3e+07 flops=2.5e+07
 sigma_tot[gemm] counter=79 i=0 t=1.1e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=1 t=9.4e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=2 t=9.4e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=3 t=9.1e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=4 t=5.3e-01 per=1.5e+01 cost=1.2e+06 flops=2.2e+06
 sigma_tot[gemm] counter=79 i=5 t=5.3e-01 per=1.5e+01 cost=1.2e+06 flops=2.2e+06
 sigma_tot[gemm] counter=79 i=6 t=5.2e-01 per=1.5e+01 cost=1.5e+06 flops=2.9e+06
 sigma_tot[gemm] counter=79 i=7 t=5.1e-01 per=1.5e+01 cost=1.5e+06 flops=2.9e+06
 sigma_tot[gemm] counter=79 total t=2.1e+00 per=5.9e+01 cost=5.4e+06 flops=2.6e+06
 sigma_tot[red] counter=79 t=9.4e-01 per=2.7e+01 cost=2.1e+06 flops=2.2e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.3e-05,3.1e-06,9.3e-07,2.2e-07
    4   0 -    -116.232119979665 -3.772e-04  4.215e-03    3     4  2.375e-01 5.937e-02 5.929e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.200e-02,7.480e-03,1.795e-02,2.536e-03,5.997e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.259e-03 speed=1.979e-04GB/S T(nccl)=2.974e-02 speed=1.503e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=1.8e-02 t_reduction=2.5e-03 tot=2.8e-02 -----
 sigma[inter] counter=80 t=7.5e-03 per=2.7e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=80 i=0 t=1.3e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=1 t=1.1e-06 per=4.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=2 t=1.1e-06 per=4.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=3 t=1.2e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=4 t=7.5e-03 per=2.7e+01 cost=4.0e+03 flops=5.3e+05
 sigma[gemm] counter=80 i=5 t=7.0e-03 per=2.5e+01 cost=4.0e+03 flops=5.7e+05
 sigma[gemm] counter=80 i=6 t=1.1e-03 per=3.9e+00 cost=6.2e+03 flops=5.7e+06
 sigma[gemm] counter=80 i=7 t=2.4e-03 per=8.7e+00 cost=6.2e+03 flops=2.6e+06
 sigma[gemm] counter=80 total t=1.8e-02 per=6.4e+01 cost=2.0e+04 flops=1.1e+06
 sigma[red] counter=80 t=2.5e-03 per=9.1e+00 cost=1.1e+04 flops=4.2e+06
----- TIMING FOR sigma_tot : t_inter=5.2e-01 t_gemm=2.1e+00 t_reduction=9.4e-01 tot=3.6e+00 -----
 sigma_tot[inter] counter=80 t=5.2e-01 per=1.4e+01 cost=1.3e+07 flops=2.5e+07
 sigma_tot[gemm] counter=80 i=0 t=1.1e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=1 t=9.5e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=2 t=9.5e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=3 t=9.2e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=4 t=5.3e-01 per=1.5e+01 cost=1.2e+06 flops=2.2e+06
 sigma_tot[gemm] counter=80 i=5 t=5.4e-01 per=1.5e+01 cost=1.2e+06 flops=2.2e+06
 sigma_tot[gemm] counter=80 i=6 t=5.2e-01 per=1.5e+01 cost=1.5e+06 flops=2.9e+06
 sigma_tot[gemm] counter=80 i=7 t=5.2e-01 per=1.4e+01 cost=1.5e+06 flops=2.9e+06
 sigma_tot[gemm] counter=80 total t=2.1e+00 per=5.9e+01 cost=5.4e+06 flops=2.6e+06
 sigma_tot[red] counter=80 t=9.4e-01 per=2.6e+01 cost=2.1e+06 flops=2.2e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.3e-05,3.1e-06,9.0e-07,1.9e-07
    5   0 -    -116.232170411937 -5.043e-05  1.470e-03    3     5  2.977e-01 5.954e-02 5.945e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.159e-03,7.398e-03,2.962e-02,1.271e-02,5.889e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.213e-03 speed=2.020e-04GB/S T(nccl)=6.946e-03 speed=6.436e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=81 t=7.4e-03 per=1.5e+01 cost=8.6e+04 flops=1.2e+07
 sigma[gemm] counter=81 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=4 t=7.3e-03 per=1.5e+01 cost=4.0e+03 flops=5.4e+05
 sigma[gemm] counter=81 i=5 t=7.4e-03 per=1.5e+01 cost=4.0e+03 flops=5.3e+05
 sigma[gemm] counter=81 i=6 t=7.4e-03 per=1.5e+01 cost=6.2e+03 flops=8.3e+05
 sigma[gemm] counter=81 i=7 t=7.4e-03 per=1.5e+01 cost=6.2e+03 flops=8.4e+05
 sigma[gemm] counter=81 total t=3.0e-02 per=6.0e+01 cost=2.0e+04 flops=6.9e+05
 sigma[red] counter=81 t=1.3e-02 per=2.6e+01 cost=1.1e+04 flops=8.3e+05
----- TIMING FOR sigma_tot : t_inter=5.2e-01 t_gemm=2.1e+00 t_reduction=9.6e-01 tot=3.6e+00 -----
 sigma_tot[inter] counter=81 t=5.2e-01 per=1.4e+01 cost=1.3e+07 flops=2.4e+07
 sigma_tot[gemm] counter=81 i=0 t=1.1e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=1 t=9.6e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=2 t=9.6e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=3 t=9.3e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=4 t=5.4e-01 per=1.5e+01 cost=1.2e+06 flops=2.2e+06
 sigma_tot[gemm] counter=81 i=5 t=5.4e-01 per=1.5e+01 cost=1.2e+06 flops=2.2e+06
 sigma_tot[gemm] counter=81 i=6 t=5.3e-01 per=1.5e+01 cost=1.5e+06 flops=2.9e+06
 sigma_tot[gemm] counter=81 i=7 t=5.2e-01 per=1.4e+01 cost=1.5e+06 flops=2.9e+06
 sigma_tot[gemm] counter=81 total t=2.1e+00 per=5.9e+01 cost=5.4e+06 flops=2.5e+06
 sigma_tot[red] counter=81 t=9.6e-01 per=2.6e+01 cost=2.1e+06 flops=2.2e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.3e-05,3.2e-06,9.7e-07,2.4e-07
    6   0 -    -116.232176303667 -5.892e-06  3.935e-04    3     6  3.569e-01 5.948e-02 5.939e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.180e-02,7.404e-03,2.957e-02,1.260e-02,6.138e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.190e-03 speed=2.042e-04GB/S T(nccl)=9.611e-03 speed=4.651e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=82 t=7.4e-03 per=1.5e+01 cost=8.6e+04 flops=1.2e+07
 sigma[gemm] counter=82 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=4 t=7.3e-03 per=1.5e+01 cost=4.0e+03 flops=5.4e+05
 sigma[gemm] counter=82 i=5 t=7.5e-03 per=1.5e+01 cost=4.0e+03 flops=5.3e+05
 sigma[gemm] counter=82 i=6 t=7.4e-03 per=1.5e+01 cost=6.2e+03 flops=8.4e+05
 sigma[gemm] counter=82 i=7 t=7.4e-03 per=1.5e+01 cost=6.2e+03 flops=8.4e+05
 sigma[gemm] counter=82 total t=3.0e-02 per=6.0e+01 cost=2.0e+04 flops=6.9e+05
 sigma[red] counter=82 t=1.3e-02 per=2.5e+01 cost=1.1e+04 flops=8.4e+05
----- TIMING FOR sigma_tot : t_inter=5.3e-01 t_gemm=2.2e+00 t_reduction=9.7e-01 tot=3.7e+00 -----
 sigma_tot[inter] counter=82 t=5.3e-01 per=1.4e+01 cost=1.3e+07 flops=2.4e+07
 sigma_tot[gemm] counter=82 i=0 t=1.1e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=1 t=9.7e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=2 t=9.8e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=3 t=9.4e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=4 t=5.5e-01 per=1.5e+01 cost=1.2e+06 flops=2.2e+06
 sigma_tot[gemm] counter=82 i=5 t=5.5e-01 per=1.5e+01 cost=1.2e+06 flops=2.2e+06
 sigma_tot[gemm] counter=82 i=6 t=5.4e-01 per=1.5e+01 cost=1.5e+06 flops=2.9e+06
 sigma_tot[gemm] counter=82 i=7 t=5.3e-01 per=1.4e+01 cost=1.5e+06 flops=2.9e+06
 sigma_tot[gemm] counter=82 total t=2.2e+00 per=5.9e+01 cost=5.5e+06 flops=2.5e+06
 sigma_tot[red] counter=82 t=9.7e-01 per=2.6e+01 cost=2.1e+06 flops=2.2e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.3e-05,3.1e-06,8.8e-07,2.3e-07
    7   0 +    -116.232176644205 -3.405e-07  8.813e-05    3     7  4.185e-01 5.979e-02 5.970e-02
TIMING FOR Davidson : 4.185e-01  T(cal/comm/rest)=4.179e-01,1.575e-06,5.850e-04
decomposed t_rest=5.850e-04
 T(sub)    =1.380e-04 per=2.358e+01
 T(precond)=4.990e-05 per=8.530e+00
 T(ortho)  =1.406e-05 per=2.403e+00
 T(xcopy)  =8.640e-07 per=1.477e-01
 T(xnrm2)  =2.898e-06 per=4.954e-01
 T(other)  =3.793e-04 per=6.484e+01
optimized energies: isweep=0 ibond=14 dots=2 e[0]=-116.232176644205 nmvp=7
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.043e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond14.txt
 qbond: qsuper nsym=12 dimAll=32
 (23,3):3 (25,3):6 (24,2):6 (24,4):3 (26,2):3 (25,1):3 (22,2):1 (23,1):2 (27,3):1 (26,4):2 (25,5):1 (24,0):1
timing for divide=6.0e-05
timing for compute=7.9e-05
timing for collect=1.7e-05
----- TMING FOR decimation_genbasis(su2): 1.6e-04 S T(divide/compute[cpu/gpu/rest]/collect)=6.0e-05,5.7e-05,0.0e+00,2.2e-05,1.7e-05 -----
decimation summary: 32->8 dwt=+1.110e-16 SvN=6.939e-01
 qbond: qkept nsym=6 dimAll=8
 (25,3):2 (26,2):2 (24,2):1 (25,1):1 (27,3):1 (26,4):1
----- TIMING for decimation_row(nkr): 5.220e-04 S T(decim/select/formRot)=2.375e-04,1.831e-04,1.014e-04 -----
----- TIMING FOR twodot_decimation: 9.060e-04 S T(wf/decim)=3.697e-04,5.362e-04 -----
ctns::oper_renorm coord=(15,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:16 S:2 P:8 Q:10 
        dim(bra,ket)=8,8 size(op)=20:1.526e-04MB size(tot)=462:3.525e-03MB:3.442e-06GB
        per(mem): H:2.6 C:48.5 S:6.06 P:8.23 Q:34.6 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.146e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=35 : 1.021e-03 S -----
rank=0 GPUmem(GB): used=2.909e-05 (oper)=1.518e-05
rank=0 GPUmem(GB): used=2.931e-05 (oper,site)=1.518e-05,2.235e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=35
 no. of rintermediate operators=28
 no. of coefficients=420:3.204e-03MB:3.129e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.479e-03 S -----
rank=0 GPUmem(GB): used=3.244e-05 (oper,site,rinter)=1.518e-05,2.235e-07,3.129e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.491e-02 S size(rtasks)=35 size(Rlst2)=36 T(Rmu/Rlist)=1.990e-04,1.471e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.513e-02 S size(rtasks)=35 size(Rlst)=1269 -----
rank=0 GPUmem(GB): used=3.244e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.229e-04 blksize=4 blksize0=4 batchsize=1269
rank=0 GPUmem(GB): used=1.554e-04 (oper,site,rinter,batch)=1.518e-05,2.235e-07,3.129e-06,1.229e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.513e-03,2.252e-02,9.904e-03
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=2.3e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=176 t=6.5e-03 per=1.7e+01 cost=2.0e+04 flops=3.1e+06
 renorm[gemm] counter=176 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=176 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=176 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=176 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=176 i=4 t=7.6e-03 per=1.9e+01 cost=2.0e+03 flops=2.6e+05
 renorm[gemm] counter=176 i=5 t=7.5e-03 per=1.9e+01 cost=4.8e+03 flops=6.4e+05
 renorm[gemm] counter=176 i=6 t=7.4e-03 per=1.9e+01 cost=8.1e+03 flops=1.1e+06
 renorm[gemm] counter=176 total t=2.3e-02 per=5.8e+01 cost=1.5e+04 flops=6.6e+05
 renorm[red] counter=176 t=9.9e-03 per=2.5e+01 cost=5.5e+03 flops=5.6e+05
----- TIMING FOR renorm_tot : t_inter=9.5e-02 t_gemm=3.4e-01 t_reduction=1.5e-01 tot=5.8e-01 -----
 renorm_tot[inter] counter=176 t=9.5e-02 per=1.6e+01 cost=3.8e+05 flops=4.0e+06
 renorm_tot[gemm] counter=176 i=0 t=2.0e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=176 i=1 t=1.7e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=176 i=2 t=1.7e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=176 i=3 t=1.7e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=176 i=4 t=1.1e-01 per=1.9e+01 cost=4.5e+04 flops=4.0e+05
 renorm_tot[gemm] counter=176 i=5 t=1.1e-01 per=1.9e+01 cost=1.3e+05 flops=1.2e+06
 renorm_tot[gemm] counter=176 i=6 t=1.1e-01 per=1.9e+01 cost=2.2e+05 flops=1.9e+06
 renorm_tot[gemm] counter=176 total t=3.4e-01 per=5.8e+01 cost=4.0e+05 flops=1.2e+06
 renorm_tot[red] counter=176 t=1.5e-01 per=2.6e+01 cost=1.3e+05 flops=8.4e+05
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.299e-05 (optmp,oper)=1.043e-07,1.518e-05
rank=0 GPUmem(GB): used=3.321e-05 (optmp,oper,site,rinter)=1.043e-07,1.518e-05,2.235e-07,6.706e-07
rank=0 GPUmem(GB): used=4.164e-05 (optmp,oper,site,rinter,batch)=1.043e-07,1.518e-05,2.235e-07,6.706e-07,8.427e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.575e-01 S T(prep/alloc/comp/red/dealloc)=3.260e-03,5.665e-03,1.392e-01,1.002e-02,2.545e-03 -----
----- TIMING FOR oper_renorm_opS : 1.575e-01 S rank=0 -----
qops.to_cpu: size(tot)=462:3.525e-03MB:3.442e-06GB T(to_cpu)=6.133e-05S speed=5.612e-02GB/S
check ||H-H.dagger||=1.105e-14 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.228 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=3.645e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=8.240e-04 change=-1.284e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=8.240e-04 change=-4.679e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 8.848e-01 S #####
 T(local opt: fetch) = 9.598e-03 S  per = 1.08  per(accum) = 1.08
 T(local opt: hdiag) = 1.385e-01 S  per = 15.7  per(accum) = 16.7
 T(local opt: dvdsn) = 5.045e-01 S  per =   57  per(accum) = 73.8
 T(local opt: decim) = 1.016e-03 S  per = 0.115  per(accum) = 73.9
 T(local opt: guess) = 6.293e-04 S  per = 0.0711  per(accum) = 73.9
 T(local opt: renrm) = 2.304e-01 S  per =   26  per(accum) = 100
 T(local opt: save ) = 1.998e-04 S  per = 0.0226  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.045e-01 S  T(sum) = 5.042e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 2.732e-03 S  per = 0.542  per(accum) = 0.542
 T(local opt: symbolic_formulae           ) = 2.033e-03 S  per = 0.403  per(accum) = 0.945
 T(local opt: hintermediate init          ) = 1.189e-04 S  per = 0.0236  per(accum) = 0.969
 T(local opt: preprocess_hformulae_Hxlist ) = 5.754e-02 S  per = 11.4  per(accum) = 12.4
 T(local opt: hmmtasks init               ) = 2.240e-02 S  per = 4.44  per(accum) = 16.8
 T(local opt: initial guess for dvdson    ) = 8.274e-04 S  per = 0.164  per(accum) = 17
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.306e-01 S  per = 65.6  per(accum) = 82.6
 T(local opt: dvdson [cpu-gpu]            ) = 1.443e-02 S  per = 2.86  per(accum) = 85.4
 T(local opt: dvdson [nccl]               ) = 7.292e-02 S  per = 14.5  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 1.575e-06 S  per = 0.000312  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 5.850e-04 S  per = 0.116  per(accum) = 100
Detailed decomposition of T(renrm) = 2.304e-01 S  T(sum) = 2.304e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.175e-04 S  per = 0.138  per(accum) = 0.138
 T(local opt: qops init                    ) = 1.620e-03 S  per = 0.703  per(accum) = 0.841
 T(local opt: symbolic_formulae_renorm     ) = 1.034e-03 S  per = 0.449  per(accum) = 1.29
 T(local opt: allocate qops on gpu         ) = 8.664e-05 S  per = 0.0376  per(accum) = 1.33
 T(local opt: site memcpy cpu2gpu          ) = 1.398e-03 S  per = 0.607  per(accum) = 1.93
 T(local opt: rintermediate init           ) = 2.494e-03 S  per = 1.08  per(accum) = 3.02
 T(local opt: preprocess_formulae_Rlist2   ) = 1.518e-02 S  per = 6.59  per(accum) = 9.61
 T(local opt: rmmtasks init                ) = 7.274e-03 S  per = 3.16  per(accum) = 12.8
 T(local opt: qops memset on cpu           ) = 2.900e-08 S  per = 1.26e-05  per(accum) = 12.8
 T(local opt: preprocess_renorm_batchGPU   ) = 3.915e-02 S  per =   17  per(accum) = 29.8
 T(local opt: deallocate cpu and gpu memory) = 5.952e-05 S  per = 0.0258  per(accum) = 29.8
 T(local opt: construct opS [ifdists=true] ) = 1.576e-01 S  per = 68.4  per(accum) = 98.2
 T(local opt: reduction of opS & opH [nccl]) = 2.401e-03 S  per = 1.04  per(accum) = 99.2
 T(local opt: qops memcpy gpu2cpu          ) = 7.252e-05 S  per = 0.0315  per(accum) = 99.3
 T(local opt: reduction of opS & opH [mpi] ) = 6.762e-05 S  per = 0.0294  per(accum) = 99.3
 T(local opt: qops_pool join and erase     ) = 1.645e-03 S  per = 0.714  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.450e-06 S  per = 0.00367  per(accum) = 100
##### sweep opt: 1.980e+01 S #####
 T(sweep opt: fetch) = 1.807e-01 S  per = 0.913  per(accum) = 0.913
 T(sweep opt: hdiag) = 4.373e+00 S  per = 22.1  per(accum) = 23
 T(sweep opt: dvdsn) = 6.911e+00 S  per = 34.9  per(accum) = 57.9
 T(sweep opt: decim) = 1.665e-02 S  per = 0.0841  per(accum) = 58
 T(sweep opt: guess) = 1.011e-02 S  per = 0.051  per(accum) = 58
 T(sweep opt: renrm) = 8.306e+00 S  per = 41.9  per(accum) = 100
 T(sweep opt: save ) = 3.232e-03 S  per = 0.0163  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.911e+00 S  T(sum) = 6.904e+00 S  per = 9.989e+01
 T(sweep opt: preprocess                  ) = 4.464e-02 S  per = 0.647  per(accum) = 0.647
 T(sweep opt: symbolic_formulae           ) = 5.732e-02 S  per = 0.83  per(accum) = 1.48
 T(sweep opt: hintermediate init          ) = 3.033e-03 S  per = 0.0439  per(accum) = 1.52
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.629e+00 S  per = 23.6  per(accum) = 25.1
 T(sweep opt: hmmtasks init               ) = 6.668e-01 S  per = 9.66  per(accum) = 34.8
 T(sweep opt: initial guess for dvdson    ) = 1.293e-02 S  per = 0.187  per(accum) = 35
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.686e+00 S  per = 53.4  per(accum) = 88.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.623e-01 S  per = 2.35  per(accum) = 90.7
 T(sweep opt: dvdson [nccl]               ) = 6.330e-01 S  per = 9.17  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 5.812e-05 S  per = 0.000842  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.939e-03 S  per = 0.115  per(accum) = 100
Detailed decomposition of T(renrm) = 8.306e+00 S  T(sum) = 8.306e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.073e-03 S  per = 0.049  per(accum) = 0.049
 T(sweep opt: qops init                    ) = 3.650e-02 S  per = 0.439  per(accum) = 0.488
 T(sweep opt: symbolic_formulae_renorm     ) = 1.894e-02 S  per = 0.228  per(accum) = 0.716
 T(sweep opt: allocate qops on gpu         ) = 9.730e-04 S  per = 0.0117  per(accum) = 0.728
 T(sweep opt: site memcpy cpu2gpu          ) = 1.786e-02 S  per = 0.215  per(accum) = 0.943
 T(sweep opt: rintermediate init           ) = 3.292e-02 S  per = 0.396  per(accum) = 1.34
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.416e-01 S  per = 2.91  per(accum) = 4.25
 T(sweep opt: rmmtasks init                ) = 1.246e-01 S  per =  1.5  per(accum) = 5.75
 T(sweep opt: qops memset on cpu           ) = 5.490e-07 S  per = 6.61e-06  per(accum) = 5.75
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.845e-01 S  per = 7.04  per(accum) = 12.8
 T(sweep opt: deallocate cpu and gpu memory) = 1.048e-03 S  per = 0.0126  per(accum) = 12.8
 T(sweep opt: construct opS [ifdists=true] ) = 7.074e+00 S  per = 85.2  per(accum) = 98
 T(sweep opt: reduction of opS & opH [nccl]) = 3.438e-02 S  per = 0.414  per(accum) = 98.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.521e-03 S  per = 0.0183  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 8.803e-04 S  per = 0.0106  per(accum) = 98.4
 T(sweep opt: qops_pool join and erase     ) = 2.957e-02 S  per = 0.356  per(accum) = 98.8
 T(sweep opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 1.24  per(accum) = 100
##### global opt: 1.980e+01 S #####
 T(global opt: fetch) = 1.807e-01 S  per = 0.913  per(accum) = 0.913
 T(global opt: hdiag) = 4.373e+00 S  per = 22.1  per(accum) = 23
 T(global opt: dvdsn) = 6.911e+00 S  per = 34.9  per(accum) = 57.9
 T(global opt: decim) = 1.665e-02 S  per = 0.0841  per(accum) = 58
 T(global opt: guess) = 1.011e-02 S  per = 0.051  per(accum) = 58
 T(global opt: renrm) = 8.306e+00 S  per = 41.9  per(accum) = 100
 T(global opt: save ) = 3.232e-03 S  per = 0.0163  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.911e+00 S  T(sum) = 6.904e+00 S  per = 9.989e+01
 T(global opt: preprocess                  ) = 4.464e-02 S  per = 0.647  per(accum) = 0.647
 T(global opt: symbolic_formulae           ) = 5.732e-02 S  per = 0.83  per(accum) = 1.48
 T(global opt: hintermediate init          ) = 3.033e-03 S  per = 0.0439  per(accum) = 1.52
 T(global opt: preprocess_hformulae_Hxlist ) = 1.629e+00 S  per = 23.6  per(accum) = 25.1
 T(global opt: hmmtasks init               ) = 6.668e-01 S  per = 9.66  per(accum) = 34.8
 T(global opt: initial guess for dvdson    ) = 1.293e-02 S  per = 0.187  per(accum) = 35
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.686e+00 S  per = 53.4  per(accum) = 88.4
 T(global opt: dvdson [cpu-gpu]            ) = 1.623e-01 S  per = 2.35  per(accum) = 90.7
 T(global opt: dvdson [nccl]               ) = 6.330e-01 S  per = 9.17  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 5.812e-05 S  per = 0.000842  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 7.939e-03 S  per = 0.115  per(accum) = 100
Detailed decomposition of T(renrm) = 8.306e+00 S  T(sum) = 8.306e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.073e-03 S  per = 0.049  per(accum) = 0.049
 T(global opt: qops init                    ) = 3.650e-02 S  per = 0.439  per(accum) = 0.488
 T(global opt: symbolic_formulae_renorm     ) = 1.894e-02 S  per = 0.228  per(accum) = 0.716
 T(global opt: allocate qops on gpu         ) = 9.730e-04 S  per = 0.0117  per(accum) = 0.728
 T(global opt: site memcpy cpu2gpu          ) = 1.786e-02 S  per = 0.215  per(accum) = 0.943
 T(global opt: rintermediate init           ) = 3.292e-02 S  per = 0.396  per(accum) = 1.34
 T(global opt: preprocess_formulae_Rlist2   ) = 2.416e-01 S  per = 2.91  per(accum) = 4.25
 T(global opt: rmmtasks init                ) = 1.246e-01 S  per =  1.5  per(accum) = 5.75
 T(global opt: qops memset on cpu           ) = 5.490e-07 S  per = 6.61e-06  per(accum) = 5.75
 T(global opt: preprocess_renorm_batchGPU   ) = 5.845e-01 S  per = 7.04  per(accum) = 12.8
 T(global opt: deallocate cpu and gpu memory) = 1.048e-03 S  per = 0.0126  per(accum) = 12.8
 T(global opt: construct opS [ifdists=true] ) = 7.074e+00 S  per = 85.2  per(accum) = 98
 T(global opt: reduction of opS & opH [nccl]) = 3.438e-02 S  per = 0.414  per(accum) = 98.4
 T(global opt: qops memcpy gpu2cpu          ) = 1.521e-03 S  per = 0.0183  per(accum) = 98.4
 T(global opt: reduction of opS & opH [mpi] ) = 8.803e-04 S  per = 0.0106  per(accum) = 98.4
 T(global opt: qops_pool join and erase     ) = 2.957e-02 S  per = 0.356  per(accum) = 98.8
 T(global opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 1.24  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.033e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=15/seqsize=34 dots=2 dbond=(16,0)-(17,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=435:3.319e-03MB:3.241e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=12:9.155e-05MB:8.941e-08GB
total mem of comb=448:3.418e-03MB:3.338e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=16,2,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 14 15
 suppc1= 12
 suppc2= 13
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:16 S:2 P:8 Q:10 
        dim(bra,ket)=8,8 size(op)=20:1.526e-04MB size(tot)=462:3.525e-03MB:3.442e-06GB
        per(mem): H:2.6 C:48.5 S:6.06 P:8.23 Q:34.6 
 rqops: oplist=HCSAB nops=H:1 C:2 S:9 A:1 B:4 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=21:0.00016MB:1.56e-07GB
        per(mem): H:9.52 C:9.52 S:42.9 A:0 B:38.1 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2479:0.0189MB:1.85e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.090e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(16,0) fdel=./scratch/sweep/rop(17,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.533e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(8,2,3,3) nnz=30:2.289e-04MB
qtensor4: wf4 own=1 _data=0x46dfad20
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=8
 (25,3):2 (26,2):2 (24,2):1 (25,1):1 (27,3):1 (26,4):1
 qbond: qcol nsym=2 dimAll=2
 (2,2):1 (3,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=192 size=30:2.289e-04MB
### DIAG TIMING: total=8.487e-02 t1=2.525e-05, t2=1.621e-03, t3=2.475e-03, t4=7.825e-02, t5=3.166e-06, t6=2.493e-03, t7=4.624e-06
duration_diagGPU:8.489e-02
duration_diagreduce:7.100e-08
duration_diagtransform:3.320e-07
----- TIMING FOR symbolic_formulae_twodot with size=107 : 1.379e-03 S -----
rank=0 GPUmem(GB): used=1.847e-05 (oper)=1.847e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=107
 no. of hintermediate operators=42
 no. of coefficients=560:4.272e-03MB:4.172e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.909e-05 S -----
rank=0 GPUmem(GB): used=2.264e-05 (oper,hinter)=1.847e-05,4.172e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.497e-02 S size(H_formulae)=107 size(Hxlst2)=21 T(Hmu/Hxlist)=2.567e-04,4.471e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.540e-02 S size(H_formulae)=107 size(Hxlst)=2814 -----
rank=0 GPUmem(GB): used=2.264e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=4.470e-07 batch[need]=1.887e-04 blksize=2 blksize0=4 batchsize=2814
rank=0 GPUmem(GB): used=2.118e-04 (oper,hinter,dvdson,batch)=1.847e-05,4.172e-06,4.470e-07,1.887e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=30 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.065e-02,7.577e-03,3.033e-02,8.048e-03,5.662e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=1.081e-03 speed=4.136e-04GB/S T(nccl)=9.573e-03 speed=4.670e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=8.0e-03 tot=4.6e-02 -----
 sigma[inter] counter=83 t=7.6e-03 per=1.6e+01 cost=6.0e+04 flops=8.0e+06
 sigma[gemm] counter=83 i=0 t=1.3e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=1 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=2 t=1.1e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=3 t=1.1e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=4 t=7.5e-03 per=1.6e+01 cost=2.6e+03 flops=3.5e+05
 sigma[gemm] counter=83 i=5 t=7.5e-03 per=1.6e+01 cost=2.6e+03 flops=3.4e+05
 sigma[gemm] counter=83 i=6 t=7.6e-03 per=1.7e+01 cost=4.8e+03 flops=6.4e+05
 sigma[gemm] counter=83 i=7 t=7.6e-03 per=1.7e+01 cost=4.8e+03 flops=6.4e+05
 sigma[gemm] counter=83 total t=3.0e-02 per=6.6e+01 cost=1.5e+04 flops=4.9e+05
 sigma[red] counter=83 t=8.0e-03 per=1.8e+01 cost=8.3e+03 flops=1.0e+06
----- TIMING FOR sigma_tot : t_inter=5.4e-01 t_gemm=2.2e+00 t_reduction=9.8e-01 tot=3.7e+00 -----
 sigma_tot[inter] counter=83 t=5.4e-01 per=1.5e+01 cost=1.3e+07 flops=2.4e+07
 sigma_tot[gemm] counter=83 i=0 t=1.1e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=1 t=9.8e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=2 t=9.9e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=3 t=9.5e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=4 t=5.6e-01 per=1.5e+01 cost=1.2e+06 flops=2.1e+06
 sigma_tot[gemm] counter=83 i=5 t=5.6e-01 per=1.5e+01 cost=1.2e+06 flops=2.1e+06
 sigma_tot[gemm] counter=83 i=6 t=5.4e-01 per=1.5e+01 cost=1.5e+06 flops=2.8e+06
 sigma_tot[gemm] counter=83 i=7 t=5.4e-01 per=1.5e+01 cost=1.5e+06 flops=2.9e+06
 sigma_tot[gemm] counter=83 total t=2.2e+00 per=5.9e+01 cost=5.5e+06 flops=2.5e+06
 sigma_tot[red] counter=83 t=9.8e-01 per=2.6e+01 cost=2.1e+06 flops=2.1e+06
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,4.6e-06,2.2e-06,7.5e-07,2.0e-07
settings: ndim=30 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.232176644205 -1.116e+03  3.170e-02    1     1  5.691e-02 5.691e-02 5.688e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.930e-02,3.256e-03,9.318e-03,2.990e-03,5.487e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=3.426e-04 speed=1.305e-03GB/S T(nccl)=3.895e-02 speed=1.148e-05GB/S
----- TIMING FOR sigma : t_inter=3.3e-03 t_gemm=9.3e-03 t_reduction=3.0e-03 tot=1.6e-02 -----
 sigma[inter] counter=84 t=3.3e-03 per=2.1e+01 cost=6.0e+04 flops=1.9e+07
 sigma[gemm] counter=84 i=0 t=1.6e-06 per=1.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=1 t=1.4e-06 per=8.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=2 t=1.4e-06 per=8.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=3 t=1.4e-06 per=8.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=4 t=2.7e-03 per=1.7e+01 cost=2.6e+03 flops=9.7e+05
 sigma[gemm] counter=84 i=5 t=3.6e-03 per=2.3e+01 cost=2.6e+03 flops=7.2e+05
 sigma[gemm] counter=84 i=6 t=1.7e-03 per=1.1e+01 cost=4.8e+03 flops=2.9e+06
 sigma[gemm] counter=84 i=7 t=1.3e-03 per=8.5e+00 cost=4.8e+03 flops=3.7e+06
 sigma[gemm] counter=84 total t=9.3e-03 per=6.0e+01 cost=1.5e+04 flops=1.6e+06
 sigma[red] counter=84 t=3.0e-03 per=1.9e+01 cost=8.3e+03 flops=2.8e+06
----- TIMING FOR sigma_tot : t_inter=5.4e-01 t_gemm=2.2e+00 t_reduction=9.8e-01 tot=3.7e+00 -----
 sigma_tot[inter] counter=84 t=5.4e-01 per=1.5e+01 cost=1.3e+07 flops=2.4e+07
 sigma_tot[gemm] counter=84 i=0 t=1.1e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=1 t=9.9e-05 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=2 t=1.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=3 t=9.7e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=4 t=5.6e-01 per=1.5e+01 cost=1.2e+06 flops=2.1e+06
 sigma_tot[gemm] counter=84 i=5 t=5.6e-01 per=1.5e+01 cost=1.2e+06 flops=2.1e+06
 sigma_tot[gemm] counter=84 i=6 t=5.5e-01 per=1.5e+01 cost=1.5e+06 flops=2.8e+06
 sigma_tot[gemm] counter=84 i=7 t=5.4e-01 per=1.4e+01 cost=1.5e+06 flops=2.9e+06
 sigma_tot[gemm] counter=84 total t=2.2e+00 per=5.9e+01 cost=5.5e+06 flops=2.5e+06
 sigma_tot[red] counter=84 t=9.8e-01 per=2.6e+01 cost=2.1e+06 flops=2.1e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.3e-05,3.6e-06,9.6e-07,2.0e-07
    2   0 -    -116.236141371350 -3.965e-03  1.269e-02    2     2  1.121e-01 5.607e-02 5.599e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.169e-02,7.391e-03,2.963e-02,1.261e-02,6.132e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.146e-03 speed=2.083e-04GB/S T(nccl)=9.540e-03 speed=4.686e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=85 t=7.4e-03 per=1.5e+01 cost=6.0e+04 flops=8.2e+06
 sigma[gemm] counter=85 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=4 t=7.4e-03 per=1.5e+01 cost=2.6e+03 flops=3.5e+05
 sigma[gemm] counter=85 i=5 t=7.4e-03 per=1.5e+01 cost=2.6e+03 flops=3.5e+05
 sigma[gemm] counter=85 i=6 t=7.4e-03 per=1.5e+01 cost=4.8e+03 flops=6.5e+05
 sigma[gemm] counter=85 i=7 t=7.4e-03 per=1.5e+01 cost=4.8e+03 flops=6.5e+05
 sigma[gemm] counter=85 total t=3.0e-02 per=6.0e+01 cost=1.5e+04 flops=5.0e+05
 sigma[red] counter=85 t=1.3e-02 per=2.5e+01 cost=8.3e+03 flops=6.6e+05
----- TIMING FOR sigma_tot : t_inter=5.5e-01 t_gemm=2.2e+00 t_reduction=9.9e-01 tot=3.8e+00 -----
 sigma_tot[inter] counter=85 t=5.5e-01 per=1.5e+01 cost=1.3e+07 flops=2.4e+07
 sigma_tot[gemm] counter=85 i=0 t=1.1e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=1 t=1.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=2 t=1.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=3 t=9.8e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=4 t=5.7e-01 per=1.5e+01 cost=1.2e+06 flops=2.1e+06
 sigma_tot[gemm] counter=85 i=5 t=5.7e-01 per=1.5e+01 cost=1.2e+06 flops=2.1e+06
 sigma_tot[gemm] counter=85 i=6 t=5.5e-01 per=1.5e+01 cost=1.5e+06 flops=2.8e+06
 sigma_tot[gemm] counter=85 i=7 t=5.5e-01 per=1.4e+01 cost=1.5e+06 flops=2.8e+06
 sigma_tot[gemm] counter=85 total t=2.2e+00 per=5.9e+01 cost=5.5e+06 flops=2.5e+06
 sigma_tot[red] counter=85 t=9.9e-01 per=2.6e+01 cost=2.1e+06 flops=2.1e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.6e-05,3.1e-06,1.1e-06,1.9e-07
    3   0 -    -116.236436258851 -2.949e-04  1.855e-03    3     3  1.737e-01 5.791e-02 5.783e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.096e-03,7.447e-03,2.955e-02,1.266e-02,5.676e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.179e-03 speed=2.051e-04GB/S T(nccl)=4.917e-03 speed=9.092e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=86 t=7.4e-03 per=1.5e+01 cost=6.0e+04 flops=8.1e+06
 sigma[gemm] counter=86 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=4 t=7.5e-03 per=1.5e+01 cost=2.6e+03 flops=3.5e+05
 sigma[gemm] counter=86 i=5 t=7.4e-03 per=1.5e+01 cost=2.6e+03 flops=3.5e+05
 sigma[gemm] counter=86 i=6 t=7.3e-03 per=1.5e+01 cost=4.8e+03 flops=6.6e+05
 sigma[gemm] counter=86 i=7 t=7.3e-03 per=1.5e+01 cost=4.8e+03 flops=6.6e+05
 sigma[gemm] counter=86 total t=3.0e-02 per=6.0e+01 cost=1.5e+04 flops=5.0e+05
 sigma[red] counter=86 t=1.3e-02 per=2.6e+01 cost=8.3e+03 flops=6.5e+05
----- TIMING FOR sigma_tot : t_inter=5.6e-01 t_gemm=2.3e+00 t_reduction=1.0e+00 tot=3.8e+00 -----
 sigma_tot[inter] counter=86 t=5.6e-01 per=1.5e+01 cost=1.3e+07 flops=2.4e+07
 sigma_tot[gemm] counter=86 i=0 t=1.2e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=1 t=1.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=2 t=1.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=3 t=9.9e-05 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=4 t=5.7e-01 per=1.5e+01 cost=1.2e+06 flops=2.1e+06
 sigma_tot[gemm] counter=86 i=5 t=5.8e-01 per=1.5e+01 cost=1.2e+06 flops=2.1e+06
 sigma_tot[gemm] counter=86 i=6 t=5.6e-01 per=1.5e+01 cost=1.6e+06 flops=2.8e+06
 sigma_tot[gemm] counter=86 i=7 t=5.6e-01 per=1.5e+01 cost=1.6e+06 flops=2.8e+06
 sigma_tot[gemm] counter=86 total t=2.3e+00 per=5.9e+01 cost=5.5e+06 flops=2.4e+06
 sigma_tot[red] counter=86 t=1.0e+00 per=2.6e+01 cost=2.1e+06 flops=2.1e+06
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.8e-05,3.1e-06,1.0e-06,2.2e-07
    4   0 -    -116.236449051558 -1.279e-05  5.654e-04    3     4  2.307e-01 5.768e-02 5.760e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.240e-03,7.443e-03,3.002e-02,1.281e-02,5.752e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.212e-03 speed=2.021e-04GB/S T(nccl)=5.027e-03 speed=8.892e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=87 t=7.4e-03 per=1.5e+01 cost=6.0e+04 flops=8.1e+06
 sigma[gemm] counter=87 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=4 t=7.4e-03 per=1.5e+01 cost=2.6e+03 flops=3.5e+05
 sigma[gemm] counter=87 i=5 t=7.5e-03 per=1.5e+01 cost=2.6e+03 flops=3.4e+05
 sigma[gemm] counter=87 i=6 t=7.5e-03 per=1.5e+01 cost=4.8e+03 flops=6.4e+05
 sigma[gemm] counter=87 i=7 t=7.5e-03 per=1.5e+01 cost=4.8e+03 flops=6.4e+05
 sigma[gemm] counter=87 total t=3.0e-02 per=6.0e+01 cost=1.5e+04 flops=5.0e+05
 sigma[red] counter=87 t=1.3e-02 per=2.5e+01 cost=8.3e+03 flops=6.5e+05
----- TIMING FOR sigma_tot : t_inter=5.6e-01 t_gemm=2.3e+00 t_reduction=1.0e+00 tot=3.9e+00 -----
 sigma_tot[inter] counter=87 t=5.6e-01 per=1.5e+01 cost=1.3e+07 flops=2.3e+07
 sigma_tot[gemm] counter=87 i=0 t=1.2e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=1 t=1.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=2 t=1.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=3 t=1.0e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=4 t=5.8e-01 per=1.5e+01 cost=1.2e+06 flops=2.1e+06
 sigma_tot[gemm] counter=87 i=5 t=5.9e-01 per=1.5e+01 cost=1.2e+06 flops=2.1e+06
 sigma_tot[gemm] counter=87 i=6 t=5.7e-01 per=1.5e+01 cost=1.6e+06 flops=2.7e+06
 sigma_tot[gemm] counter=87 i=7 t=5.6e-01 per=1.5e+01 cost=1.6e+06 flops=2.8e+06
 sigma_tot[gemm] counter=87 total t=2.3e+00 per=5.9e+01 cost=5.5e+06 flops=2.4e+06
 sigma_tot[red] counter=87 t=1.0e+00 per=2.6e+01 cost=2.1e+06 flops=2.1e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.3e-05,3.2e-06,9.9e-07,1.9e-07
    5   0 -    -116.236450698164 -1.647e-06  1.685e-04    3     5  2.885e-01 5.770e-02 5.761e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.762e-03,7.382e-03,2.962e-02,1.273e-02,5.850e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.189e-03 speed=2.042e-04GB/S T(nccl)=6.573e-03 speed=6.802e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=88 t=7.4e-03 per=1.5e+01 cost=6.0e+04 flops=8.2e+06
 sigma[gemm] counter=88 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=4 t=7.4e-03 per=1.5e+01 cost=2.6e+03 flops=3.5e+05
 sigma[gemm] counter=88 i=5 t=7.4e-03 per=1.5e+01 cost=2.6e+03 flops=3.5e+05
 sigma[gemm] counter=88 i=6 t=7.4e-03 per=1.5e+01 cost=4.8e+03 flops=6.5e+05
 sigma[gemm] counter=88 i=7 t=7.4e-03 per=1.5e+01 cost=4.8e+03 flops=6.5e+05
 sigma[gemm] counter=88 total t=3.0e-02 per=6.0e+01 cost=1.5e+04 flops=5.0e+05
 sigma[red] counter=88 t=1.3e-02 per=2.6e+01 cost=8.3e+03 flops=6.5e+05
----- TIMING FOR sigma_tot : t_inter=5.7e-01 t_gemm=2.3e+00 t_reduction=1.0e+00 tot=3.9e+00 -----
 sigma_tot[inter] counter=88 t=5.7e-01 per=1.5e+01 cost=1.3e+07 flops=2.3e+07
 sigma_tot[gemm] counter=88 i=0 t=1.2e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=1 t=1.0e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=2 t=1.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=3 t=1.0e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=4 t=5.9e-01 per=1.5e+01 cost=1.2e+06 flops=2.1e+06
 sigma_tot[gemm] counter=88 i=5 t=5.9e-01 per=1.5e+01 cost=1.2e+06 flops=2.0e+06
 sigma_tot[gemm] counter=88 i=6 t=5.8e-01 per=1.5e+01 cost=1.6e+06 flops=2.7e+06
 sigma_tot[gemm] counter=88 i=7 t=5.7e-01 per=1.5e+01 cost=1.6e+06 flops=2.7e+06
 sigma_tot[gemm] counter=88 total t=2.3e+00 per=5.9e+01 cost=5.5e+06 flops=2.4e+06
 sigma_tot[red] counter=88 t=1.0e+00 per=2.6e+01 cost=2.1e+06 flops=2.1e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.3e-05,3.3e-06,8.8e-07,2.0e-07
    6   0 +    -116.236450789429 -9.126e-08  4.221e-05    3     6  3.473e-01 5.788e-02 5.779e-02
TIMING FOR Davidson : 3.473e-01  T(cal/comm/rest)=3.467e-01,1.493e-06,5.467e-04
decomposed t_rest=5.467e-04
 T(sub)    =1.256e-04 per=2.298e+01
 T(precond)=4.277e-05 per=7.825e+00
 T(ortho)  =1.155e-05 per=2.112e+00
 T(xcopy)  =8.010e-07 per=1.465e-01
 T(xnrm2)  =2.657e-06 per=4.860e-01
 T(other)  =3.633e-04 per=6.645e+01
optimized energies: isweep=0 ibond=15 dots=2 e[0]=-116.236450789429 nmvp=6
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=8.217e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond15.txt
 qbond: qsuper nsym=12 dimAll=32
 (25,3):3 (27,3):6 (26,2):6 (26,4):3 (28,2):3 (27,1):3 (24,2):1 (25,1):2 (26,0):1 (29,3):1 (28,4):2 (27,5):1
timing for divide=6.1e-05
timing for compute=6.6e-05
timing for collect=1.7e-05
----- TMING FOR decimation_genbasis(su2): 1.4e-04 S T(divide/compute[cpu/gpu/rest]/collect)=6.1e-05,5.6e-05,0.0e+00,1.1e-05,1.7e-05 -----
decimation summary: 32->8 dwt=+0.000e+00 SvN=7.875e-01
 qbond: qkept nsym=6 dimAll=8
 (26,2):2 (27,1):2 (27,3):1 (28,2):1 (25,1):1 (26,0):1
----- TIMING for decimation_row(nkr): 5.018e-04 S T(decim/select/formRot)=2.157e-04,1.840e-04,1.021e-04 -----
----- TIMING FOR twodot_decimation: 8.949e-04 S T(wf/decim)=3.787e-04,5.162e-04 -----
ctns::oper_renorm coord=(16,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:17 S:2 P:4 Q:7 
        dim(bra,ket)=8,8 size(op)=19:1.450e-04MB size(tot)=401:3.059e-03MB:2.988e-06GB
        per(mem): H:2.99 C:59.4 S:6.98 P:4.49 Q:26.2 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=9.818e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=29 : 7.322e-04 S -----
rank=0 GPUmem(GB): used=2.547e-05 (oper)=1.387e-05
rank=0 GPUmem(GB): used=2.570e-05 (oper,site)=1.387e-05,2.235e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=29
 no. of rintermediate operators=18
 no. of coefficients=288:2.197e-03MB:2.146e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.473e-03 S -----
rank=0 GPUmem(GB): used=2.784e-05 (oper,site,rinter)=1.387e-05,2.235e-07,2.146e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.195e-02 S size(rtasks)=29 size(Rlst2)=36 T(Rmu/Rlist)=1.443e-04,1.181e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.213e-02 S size(rtasks)=29 size(Rlst)=1008 -----
rank=0 GPUmem(GB): used=2.784e-05 avail=6.231e+00 total=6.231e+00 batch[need]=9.763e-05 blksize=4 blksize0=4 batchsize=1008
rank=0 GPUmem(GB): used=1.255e-04 (oper,site,rinter,batch)=1.387e-05,2.235e-07,2.146e-06,9.763e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.039e-03,2.231e-02,9.958e-03
----- TIMING FOR renorm : t_inter=7.0e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=181 t=7.0e-03 per=1.8e+01 cost=1.4e+04 flops=2.0e+06
 renorm[gemm] counter=181 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=181 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=181 i=2 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=181 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=181 i=4 t=7.5e-03 per=1.9e+01 cost=1.4e+03 flops=1.9e+05
 renorm[gemm] counter=181 i=5 t=7.4e-03 per=1.9e+01 cost=4.3e+03 flops=5.7e+05
 renorm[gemm] counter=181 i=6 t=7.4e-03 per=1.9e+01 cost=6.7e+03 flops=9.0e+05
 renorm[gemm] counter=181 total t=2.2e-02 per=5.7e+01 cost=1.2e+04 flops=5.5e+05
 renorm[red] counter=181 t=1.0e-02 per=2.5e+01 cost=4.5e+03 flops=4.5e+05
----- TIMING FOR renorm_tot : t_inter=1.0e-01 t_gemm=3.6e-01 t_reduction=1.6e-01 tot=6.2e-01 -----
 renorm_tot[inter] counter=181 t=1.0e-01 per=1.6e+01 cost=4.0e+05 flops=3.9e+06
 renorm_tot[gemm] counter=181 i=0 t=2.1e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=181 i=1 t=1.8e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=181 i=2 t=1.8e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=181 i=3 t=1.8e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=181 i=4 t=1.2e-01 per=1.9e+01 cost=4.6e+04 flops=3.9e+05
 renorm_tot[gemm] counter=181 i=5 t=1.2e-01 per=1.9e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=181 i=6 t=1.2e-01 per=1.9e+01 cost=2.2e+05 flops=1.9e+06
 renorm_tot[gemm] counter=181 total t=3.6e-01 per=5.8e+01 cost=4.1e+05 flops=1.1e+06
 renorm_tot[red] counter=181 t=1.6e-01 per=2.6e+01 cost=1.3e+05 flops=8.1e+05
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.844e-05 (optmp,oper)=1.043e-07,1.387e-05
rank=0 GPUmem(GB): used=2.866e-05 (optmp,oper,site,rinter)=1.043e-07,1.387e-05,2.235e-07,7.153e-07
rank=0 GPUmem(GB): used=3.583e-05 (optmp,oper,site,rinter,batch)=1.043e-07,1.387e-05,2.235e-07,7.153e-07,7.167e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.275e-01 S T(prep/alloc/comp/red/dealloc)=3.153e-03,5.685e-03,1.118e-01,7.516e-03,2.543e-03 -----
----- TIMING FOR oper_renorm_opS : 1.276e-01 S rank=0 -----
qops.to_cpu: size(tot)=401:3.059e-03MB:2.988e-06GB T(to_cpu)=5.221e-05S speed=5.723e-02GB/S
check ||H-H.dagger||=2.836e-15 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.194 S rank=0 -----
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=2.901e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=7.095e-04 change=-1.181e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=7.095e-04 change=-4.679e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 7.076e-01 S #####
 T(local opt: fetch) = 9.919e-03 S  per =  1.4  per(accum) = 1.4
 T(local opt: hdiag) = 8.538e-02 S  per = 12.1  per(accum) = 13.5
 T(local opt: dvdsn) = 4.144e-01 S  per = 58.6  per(accum) = 72
 T(local opt: decim) = 1.007e-03 S  per = 0.142  per(accum) = 72.2
 T(local opt: guess) = 6.581e-04 S  per = 0.093  per(accum) = 72.3
 T(local opt: renrm) = 1.961e-01 S  per = 27.7  per(accum) = 100
 T(local opt: save ) = 1.949e-04 S  per = 0.0275  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.144e-01 S  T(sum) = 4.141e-01 S  per = 9.992e+01
 T(local opt: preprocess                  ) = 2.728e-03 S  per = 0.659  per(accum) = 0.659
 T(local opt: symbolic_formulae           ) = 1.393e-03 S  per = 0.336  per(accum) = 0.995
 T(local opt: hintermediate init          ) = 1.490e-04 S  per = 0.036  per(accum) = 1.03
 T(local opt: preprocess_hformulae_Hxlist ) = 4.549e-02 S  per =   11  per(accum) = 12
 T(local opt: hmmtasks init               ) = 1.623e-02 S  per = 3.92  per(accum) = 15.9
 T(local opt: initial guess for dvdson    ) = 8.223e-04 S  per = 0.199  per(accum) = 16.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.620e-01 S  per = 63.3  per(accum) = 79.4
 T(local opt: dvdson [cpu-gpu]            ) = 1.015e-02 S  per = 2.45  per(accum) = 81.9
 T(local opt: dvdson [nccl]               ) = 7.458e-02 S  per =   18  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 1.493e-06 S  per = 0.000361  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 5.467e-04 S  per = 0.132  per(accum) = 100
Detailed decomposition of T(renrm) = 1.961e-01 S  T(sum) = 1.961e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.204e-04 S  per = 0.163  per(accum) = 0.163
 T(local opt: qops init                    ) = 1.368e-03 S  per = 0.698  per(accum) = 0.861
 T(local opt: symbolic_formulae_renorm     ) = 7.462e-04 S  per = 0.381  per(accum) = 1.24
 T(local opt: allocate qops on gpu         ) = 9.615e-05 S  per = 0.049  per(accum) = 1.29
 T(local opt: site memcpy cpu2gpu          ) = 1.900e-03 S  per = 0.969  per(accum) = 2.26
 T(local opt: rintermediate init           ) = 2.488e-03 S  per = 1.27  per(accum) = 3.53
 T(local opt: preprocess_formulae_Rlist2   ) = 1.219e-02 S  per = 6.21  per(accum) = 9.74
 T(local opt: rmmtasks init                ) = 5.548e-03 S  per = 2.83  per(accum) = 12.6
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 1.79e-05  per(accum) = 12.6
 T(local opt: preprocess_renorm_batchGPU   ) = 3.951e-02 S  per = 20.2  per(accum) = 32.7
 T(local opt: deallocate cpu and gpu memory) = 5.068e-05 S  per = 0.0259  per(accum) = 32.7
 T(local opt: construct opS [ifdists=true] ) = 1.276e-01 S  per = 65.1  per(accum) = 97.8
 T(local opt: reduction of opS & opH [nccl]) = 2.464e-03 S  per = 1.26  per(accum) = 99.1
 T(local opt: qops memcpy gpu2cpu          ) = 6.345e-05 S  per = 0.0324  per(accum) = 99.1
 T(local opt: reduction of opS & opH [mpi] ) = 7.596e-05 S  per = 0.0387  per(accum) = 99.2
 T(local opt: qops_pool join and erase     ) = 1.636e-03 S  per = 0.834  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.081e-06 S  per = 0.00361  per(accum) = 100
##### sweep opt: 2.051e+01 S #####
 T(sweep opt: fetch) = 1.906e-01 S  per = 0.929  per(accum) = 0.929
 T(sweep opt: hdiag) = 4.458e+00 S  per = 21.7  per(accum) = 22.7
 T(sweep opt: dvdsn) = 7.325e+00 S  per = 35.7  per(accum) = 58.4
 T(sweep opt: decim) = 1.766e-02 S  per = 0.0861  per(accum) = 58.5
 T(sweep opt: guess) = 1.077e-02 S  per = 0.0525  per(accum) = 58.5
 T(sweep opt: renrm) = 8.502e+00 S  per = 41.5  per(accum) = 100
 T(sweep opt: save ) = 3.427e-03 S  per = 0.0167  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.325e+00 S  T(sum) = 7.318e+00 S  per = 9.989e+01
 T(sweep opt: preprocess                  ) = 4.737e-02 S  per = 0.647  per(accum) = 0.647
 T(sweep opt: symbolic_formulae           ) = 5.872e-02 S  per = 0.802  per(accum) = 1.45
 T(sweep opt: hintermediate init          ) = 3.182e-03 S  per = 0.0435  per(accum) = 1.49
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.675e+00 S  per = 22.9  per(accum) = 24.4
 T(sweep opt: hmmtasks init               ) = 6.830e-01 S  per = 9.33  per(accum) = 33.7
 T(sweep opt: initial guess for dvdson    ) = 1.375e-02 S  per = 0.188  per(accum) = 33.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.948e+00 S  per =   54  per(accum) = 87.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.725e-01 S  per = 2.36  per(accum) = 90.2
 T(sweep opt: dvdson [nccl]               ) = 7.076e-01 S  per = 9.67  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 5.962e-05 S  per = 0.000815  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.485e-03 S  per = 0.116  per(accum) = 100
Detailed decomposition of T(renrm) = 8.502e+00 S  T(sum) = 8.502e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.393e-03 S  per = 0.0517  per(accum) = 0.0517
 T(sweep opt: qops init                    ) = 3.787e-02 S  per = 0.445  per(accum) = 0.497
 T(sweep opt: symbolic_formulae_renorm     ) = 1.969e-02 S  per = 0.232  per(accum) = 0.729
 T(sweep opt: allocate qops on gpu         ) = 1.069e-03 S  per = 0.0126  per(accum) = 0.741
 T(sweep opt: site memcpy cpu2gpu          ) = 1.976e-02 S  per = 0.232  per(accum) = 0.974
 T(sweep opt: rintermediate init           ) = 3.541e-02 S  per = 0.416  per(accum) = 1.39
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.538e-01 S  per = 2.98  per(accum) = 4.37
 T(sweep opt: rmmtasks init                ) = 1.302e-01 S  per = 1.53  per(accum) = 5.91
 T(sweep opt: qops memset on cpu           ) = 5.840e-07 S  per = 6.87e-06  per(accum) = 5.91
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.240e-01 S  per = 7.34  per(accum) = 13.2
 T(sweep opt: deallocate cpu and gpu memory) = 1.099e-03 S  per = 0.0129  per(accum) = 13.3
 T(sweep opt: construct opS [ifdists=true] ) = 7.202e+00 S  per = 84.7  per(accum) = 98
 T(sweep opt: reduction of opS & opH [nccl]) = 3.684e-02 S  per = 0.433  per(accum) = 98.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.585e-03 S  per = 0.0186  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 9.563e-04 S  per = 0.0112  per(accum) = 98.4
 T(sweep opt: qops_pool join and erase     ) = 3.121e-02 S  per = 0.367  per(accum) = 98.8
 T(sweep opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 1.21  per(accum) = 100
##### global opt: 2.051e+01 S #####
 T(global opt: fetch) = 1.906e-01 S  per = 0.929  per(accum) = 0.929
 T(global opt: hdiag) = 4.458e+00 S  per = 21.7  per(accum) = 22.7
 T(global opt: dvdsn) = 7.325e+00 S  per = 35.7  per(accum) = 58.4
 T(global opt: decim) = 1.766e-02 S  per = 0.0861  per(accum) = 58.5
 T(global opt: guess) = 1.077e-02 S  per = 0.0525  per(accum) = 58.5
 T(global opt: renrm) = 8.502e+00 S  per = 41.5  per(accum) = 100
 T(global opt: save ) = 3.427e-03 S  per = 0.0167  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.325e+00 S  T(sum) = 7.318e+00 S  per = 9.989e+01
 T(global opt: preprocess                  ) = 4.737e-02 S  per = 0.647  per(accum) = 0.647
 T(global opt: symbolic_formulae           ) = 5.872e-02 S  per = 0.802  per(accum) = 1.45
 T(global opt: hintermediate init          ) = 3.182e-03 S  per = 0.0435  per(accum) = 1.49
 T(global opt: preprocess_hformulae_Hxlist ) = 1.675e+00 S  per = 22.9  per(accum) = 24.4
 T(global opt: hmmtasks init               ) = 6.830e-01 S  per = 9.33  per(accum) = 33.7
 T(global opt: initial guess for dvdson    ) = 1.375e-02 S  per = 0.188  per(accum) = 33.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.948e+00 S  per =   54  per(accum) = 87.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.725e-01 S  per = 2.36  per(accum) = 90.2
 T(global opt: dvdson [nccl]               ) = 7.076e-01 S  per = 9.67  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 5.962e-05 S  per = 0.000815  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 8.485e-03 S  per = 0.116  per(accum) = 100
Detailed decomposition of T(renrm) = 8.502e+00 S  T(sum) = 8.502e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.393e-03 S  per = 0.0517  per(accum) = 0.0517
 T(global opt: qops init                    ) = 3.787e-02 S  per = 0.445  per(accum) = 0.497
 T(global opt: symbolic_formulae_renorm     ) = 1.969e-02 S  per = 0.232  per(accum) = 0.729
 T(global opt: allocate qops on gpu         ) = 1.069e-03 S  per = 0.0126  per(accum) = 0.741
 T(global opt: site memcpy cpu2gpu          ) = 1.976e-02 S  per = 0.232  per(accum) = 0.974
 T(global opt: rintermediate init           ) = 3.541e-02 S  per = 0.416  per(accum) = 1.39
 T(global opt: preprocess_formulae_Rlist2   ) = 2.538e-01 S  per = 2.98  per(accum) = 4.37
 T(global opt: rmmtasks init                ) = 1.302e-01 S  per = 1.53  per(accum) = 5.91
 T(global opt: qops memset on cpu           ) = 5.840e-07 S  per = 6.87e-06  per(accum) = 5.91
 T(global opt: preprocess_renorm_batchGPU   ) = 6.240e-01 S  per = 7.34  per(accum) = 13.2
 T(global opt: deallocate cpu and gpu memory) = 1.099e-03 S  per = 0.0129  per(accum) = 13.3
 T(global opt: construct opS [ifdists=true] ) = 7.202e+00 S  per = 84.7  per(accum) = 98
 T(global opt: reduction of opS & opH [nccl]) = 3.684e-02 S  per = 0.433  per(accum) = 98.4
 T(global opt: qops memcpy gpu2cpu          ) = 1.585e-03 S  per = 0.0186  per(accum) = 98.4
 T(global opt: reduction of opS & opH [mpi] ) = 9.563e-04 S  per = 0.0112  per(accum) = 98.4
 T(global opt: qops_pool join and erase     ) = 3.121e-02 S  per = 0.367  per(accum) = 98.8
 T(global opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 1.21  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.106e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=16/seqsize=34 dots=2 dbond=(17,0)-(18,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=462:3.525e-03MB:3.442e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=12:9.155e-05MB:8.941e-08GB
total mem of comb=475:3.624e-03MB:3.539e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=17,1,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 15
 suppc1= 13
 suppc2= 14
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:17 S:2 P:4 Q:7 
        dim(bra,ket)=8,8 size(op)=19:1.450e-04MB size(tot)=401:3.059e-03MB:2.988e-06GB
        per(mem): H:2.99 C:59.4 S:6.98 P:4.49 Q:26.2 
 rqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3395:0.0259MB:2.53e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.589e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(17,0) fdel=./scratch/sweep/rop(18,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=4.172e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(8,3,3,3) nnz=35:2.670e-04MB
qtensor4: wf4 own=1 _data=0x465e0ea0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=8
 (26,2):2 (27,1):2 (27,3):1 (28,2):1 (25,1):1 (26,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=24 nblocks=230 size=35:2.670e-04MB
### DIAG TIMING: total=3.456e-02 t1=3.171e-05, t2=1.534e-03, t3=2.573e-03, t4=2.786e-02, t5=3.382e-06, t6=2.550e-03, t7=5.356e-06
duration_diagGPU:3.457e-02
duration_diagreduce:6.800e-08
duration_diagtransform:5.180e-07
----- TIMING FOR symbolic_formulae_twodot with size=110 : 1.145e-03 S -----
rank=0 GPUmem(GB): used=2.529e-05 (oper)=2.529e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=110
 no. of hintermediate operators=12
 no. of coefficients=204:1.556e-03MB:1.520e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.952e-05 S -----
rank=0 GPUmem(GB): used=2.681e-05 (oper,hinter)=2.529e-05,1.520e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.863e-02 S size(H_formulae)=110 size(Hxlst2)=24 T(Hmu/Hxlist)=2.668e-04,4.836e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.914e-02 S size(H_formulae)=110 size(Hxlst)=3238 -----
rank=0 GPUmem(GB): used=2.681e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=5.215e-07 batch[need]=2.171e-04 blksize=2 blksize0=4 batchsize=3238
rank=0 GPUmem(GB): used=2.445e-04 (oper,hinter,dvdson,batch)=2.529e-05,1.520e-06,5.215e-07,2.171e-04
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=35 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.166e-02,7.630e-03,2.994e-02,1.278e-02,6.202e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=2.056e-03 speed=2.537e-04GB/S T(nccl)=9.604e-03 speed=5.431e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=89 t=7.6e-03 per=1.5e+01 cost=2.0e+04 flops=2.6e+06
 sigma[gemm] counter=89 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=4 t=7.5e-03 per=1.5e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=89 i=5 t=7.5e-03 per=1.5e+01 cost=3.5e+03 flops=4.6e+05
 sigma[gemm] counter=89 i=6 t=7.5e-03 per=1.5e+01 cost=6.4e+03 flops=8.6e+05
 sigma[gemm] counter=89 i=7 t=7.5e-03 per=1.5e+01 cost=6.4e+03 flops=8.6e+05
 sigma[gemm] counter=89 total t=3.0e-02 per=5.9e+01 cost=2.0e+04 flops=6.6e+05
 sigma[red] counter=89 t=1.3e-02 per=2.5e+01 cost=9.8e+03 flops=7.6e+05
----- TIMING FOR sigma_tot : t_inter=5.8e-01 t_gemm=2.4e+00 t_reduction=1.0e+00 tot=4.0e+00 -----
 sigma_tot[inter] counter=89 t=5.8e-01 per=1.5e+01 cost=1.3e+07 flops=2.3e+07
 sigma_tot[gemm] counter=89 i=0 t=1.2e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=1 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=2 t=1.1e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=3 t=1.0e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=4 t=6.0e-01 per=1.5e+01 cost=1.2e+06 flops=2.0e+06
 sigma_tot[gemm] counter=89 i=5 t=6.0e-01 per=1.5e+01 cost=1.2e+06 flops=2.0e+06
 sigma_tot[gemm] counter=89 i=6 t=5.8e-01 per=1.5e+01 cost=1.6e+06 flops=2.7e+06
 sigma_tot[gemm] counter=89 i=7 t=5.8e-01 per=1.5e+01 cost=1.6e+06 flops=2.7e+06
 sigma_tot[gemm] counter=89 total t=2.4e+00 per=5.9e+01 cost=5.6e+06 flops=2.4e+06
 sigma_tot[red] counter=89 t=1.0e+00 per=2.6e+01 cost=2.1e+06 flops=2.1e+06
T(sub)=9.7e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.0e-06,2.1e-06,7.7e-07,2.1e-07
settings: ndim=35 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.236450789429 -1.116e+03  5.205e-02    1     1  6.225e-02 6.225e-02 6.222e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.167e-03,7.422e-03,2.959e-02,1.262e-02,5.681e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=2.193e-03 speed=2.379e-04GB/S T(nccl)=4.974e-03 speed=1.048e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=90 t=7.4e-03 per=1.5e+01 cost=2.0e+04 flops=2.7e+06
 sigma[gemm] counter=90 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=4 t=7.5e-03 per=1.5e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=90 i=5 t=7.4e-03 per=1.5e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=90 i=6 t=7.3e-03 per=1.5e+01 cost=6.4e+03 flops=8.8e+05
 sigma[gemm] counter=90 i=7 t=7.3e-03 per=1.5e+01 cost=6.4e+03 flops=8.8e+05
 sigma[gemm] counter=90 total t=3.0e-02 per=6.0e+01 cost=2.0e+04 flops=6.7e+05
 sigma[red] counter=90 t=1.3e-02 per=2.5e+01 cost=9.8e+03 flops=7.7e+05
----- TIMING FOR sigma_tot : t_inter=5.9e-01 t_gemm=2.4e+00 t_reduction=1.1e+00 tot=4.0e+00 -----
 sigma_tot[inter] counter=90 t=5.9e-01 per=1.5e+01 cost=1.3e+07 flops=2.3e+07
 sigma_tot[gemm] counter=90 i=0 t=1.2e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=1 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=2 t=1.1e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=3 t=1.0e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=4 t=6.0e-01 per=1.5e+01 cost=1.2e+06 flops=2.0e+06
 sigma_tot[gemm] counter=90 i=5 t=6.1e-01 per=1.5e+01 cost=1.2e+06 flops=2.0e+06
 sigma_tot[gemm] counter=90 i=6 t=5.9e-01 per=1.5e+01 cost=1.6e+06 flops=2.7e+06
 sigma_tot[gemm] counter=90 i=7 t=5.9e-01 per=1.5e+01 cost=1.6e+06 flops=2.7e+06
 sigma_tot[gemm] counter=90 total t=2.4e+00 per=5.9e+01 cost=5.6e+06 flops=2.3e+06
 sigma_tot[red] counter=90 t=1.1e+00 per=2.6e+01 cost=2.2e+06 flops=2.0e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.3e-05,3.5e-06,1.1e-06,2.1e-07
    2   0 -    -116.251685201368 -1.523e-02  1.988e-02    2     2  1.194e-01 5.971e-02 5.961e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.778e-03,7.529e-03,2.989e-02,1.287e-02,5.907e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=2.127e-03 speed=2.452e-04GB/S T(nccl)=6.651e-03 speed=7.841e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=91 t=7.5e-03 per=1.5e+01 cost=2.0e+04 flops=2.7e+06
 sigma[gemm] counter=91 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=4 t=7.4e-03 per=1.5e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=91 i=5 t=7.4e-03 per=1.5e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=91 i=6 t=7.5e-03 per=1.5e+01 cost=6.4e+03 flops=8.5e+05
 sigma[gemm] counter=91 i=7 t=7.5e-03 per=1.5e+01 cost=6.4e+03 flops=8.5e+05
 sigma[gemm] counter=91 total t=3.0e-02 per=5.9e+01 cost=2.0e+04 flops=6.6e+05
 sigma[red] counter=91 t=1.3e-02 per=2.6e+01 cost=9.8e+03 flops=7.6e+05
----- TIMING FOR sigma_tot : t_inter=5.9e-01 t_gemm=2.4e+00 t_reduction=1.1e+00 tot=4.1e+00 -----
 sigma_tot[inter] counter=91 t=5.9e-01 per=1.5e+01 cost=1.3e+07 flops=2.2e+07
 sigma_tot[gemm] counter=91 i=0 t=1.2e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=1 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=2 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=3 t=1.0e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=4 t=6.1e-01 per=1.5e+01 cost=1.2e+06 flops=2.0e+06
 sigma_tot[gemm] counter=91 i=5 t=6.2e-01 per=1.5e+01 cost=1.2e+06 flops=2.0e+06
 sigma_tot[gemm] counter=91 i=6 t=6.0e-01 per=1.5e+01 cost=1.6e+06 flops=2.6e+06
 sigma_tot[gemm] counter=91 i=7 t=5.9e-01 per=1.5e+01 cost=1.6e+06 flops=2.7e+06
 sigma_tot[gemm] counter=91 total t=2.4e+00 per=5.9e+01 cost=5.6e+06 flops=2.3e+06
 sigma_tot[red] counter=91 t=1.1e+00 per=2.6e+01 cost=2.2e+06 flops=2.0e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.6e-05,3.1e-06,1.0e-06,2.1e-07
    3   0 -    -116.252906104312 -1.221e-03  7.090e-03    3     3  1.788e-01 5.961e-02 5.949e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.169e-02,7.376e-03,2.970e-02,1.279e-02,6.157e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=2.119e-03 speed=2.461e-04GB/S T(nccl)=9.575e-03 speed=5.447e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=92 t=7.4e-03 per=1.5e+01 cost=2.0e+04 flops=2.7e+06
 sigma[gemm] counter=92 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=4 t=7.4e-03 per=1.5e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=92 i=5 t=7.4e-03 per=1.5e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=92 i=6 t=7.4e-03 per=1.5e+01 cost=6.4e+03 flops=8.7e+05
 sigma[gemm] counter=92 i=7 t=7.5e-03 per=1.5e+01 cost=6.4e+03 flops=8.6e+05
 sigma[gemm] counter=92 total t=3.0e-02 per=6.0e+01 cost=2.0e+04 flops=6.7e+05
 sigma[red] counter=92 t=1.3e-02 per=2.6e+01 cost=9.8e+03 flops=7.6e+05
----- TIMING FOR sigma_tot : t_inter=6.0e-01 t_gemm=2.4e+00 t_reduction=1.1e+00 tot=4.1e+00 -----
 sigma_tot[inter] counter=92 t=6.0e-01 per=1.5e+01 cost=1.3e+07 flops=2.2e+07
 sigma_tot[gemm] counter=92 i=0 t=1.2e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=1 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=2 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=3 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=4 t=6.2e-01 per=1.5e+01 cost=1.2e+06 flops=2.0e+06
 sigma_tot[gemm] counter=92 i=5 t=6.2e-01 per=1.5e+01 cost=1.2e+06 flops=2.0e+06
 sigma_tot[gemm] counter=92 i=6 t=6.1e-01 per=1.5e+01 cost=1.6e+06 flops=2.6e+06
 sigma_tot[gemm] counter=92 i=7 t=6.0e-01 per=1.5e+01 cost=1.6e+06 flops=2.6e+06
 sigma_tot[gemm] counter=92 total t=2.4e+00 per=5.9e+01 cost=5.6e+06 flops=2.3e+06
 sigma_tot[red] counter=92 t=1.1e+00 per=2.6e+01 cost=2.2e+06 flops=2.0e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,3.1e-06,9.7e-07,2.0e-07
    4   0 -    -116.253076062309 -1.700e-04  1.291e-03    3     4  2.407e-01 6.017e-02 6.006e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.940e-03,7.540e-03,2.998e-02,1.265e-02,5.912e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=2.235e-03 speed=2.334e-04GB/S T(nccl)=6.705e-03 speed=7.779e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=93 t=7.5e-03 per=1.5e+01 cost=2.0e+04 flops=2.7e+06
 sigma[gemm] counter=93 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=4 t=7.5e-03 per=1.5e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=93 i=5 t=7.4e-03 per=1.5e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=93 i=6 t=7.5e-03 per=1.5e+01 cost=6.4e+03 flops=8.6e+05
 sigma[gemm] counter=93 i=7 t=7.6e-03 per=1.5e+01 cost=6.4e+03 flops=8.5e+05
 sigma[gemm] counter=93 total t=3.0e-02 per=6.0e+01 cost=2.0e+04 flops=6.6e+05
 sigma[red] counter=93 t=1.3e-02 per=2.5e+01 cost=9.8e+03 flops=7.7e+05
----- TIMING FOR sigma_tot : t_inter=6.1e-01 t_gemm=2.5e+00 t_reduction=1.1e+00 tot=4.2e+00 -----
 sigma_tot[inter] counter=93 t=6.1e-01 per=1.5e+01 cost=1.3e+07 flops=2.2e+07
 sigma_tot[gemm] counter=93 i=0 t=1.2e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=1 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=2 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=3 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=4 t=6.3e-01 per=1.5e+01 cost=1.2e+06 flops=2.0e+06
 sigma_tot[gemm] counter=93 i=5 t=6.3e-01 per=1.5e+01 cost=1.2e+06 flops=1.9e+06
 sigma_tot[gemm] counter=93 i=6 t=6.1e-01 per=1.5e+01 cost=1.6e+06 flops=2.6e+06
 sigma_tot[gemm] counter=93 i=7 t=6.1e-01 per=1.5e+01 cost=1.6e+06 flops=2.6e+06
 sigma_tot[gemm] counter=93 total t=2.5e+00 per=5.9e+01 cost=5.6e+06 flops=2.3e+06
 sigma_tot[red] counter=93 t=1.1e+00 per=2.6e+01 cost=2.2e+06 flops=2.0e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.3e-05,3.0e-06,9.7e-07,2.0e-07
    5   0 -    -116.253081253895 -5.192e-06  2.711e-04    3     5  3.001e-01 6.002e-02 5.991e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.852e-03,7.420e-03,3.012e-02,1.302e-02,5.942e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=2.170e-03 speed=2.404e-04GB/S T(nccl)=6.683e-03 speed=7.804e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=94 t=7.4e-03 per=1.5e+01 cost=2.0e+04 flops=2.7e+06
 sigma[gemm] counter=94 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=4 t=7.5e-03 per=1.5e+01 cost=3.5e+03 flops=4.6e+05
 sigma[gemm] counter=94 i=5 t=7.6e-03 per=1.5e+01 cost=3.5e+03 flops=4.6e+05
 sigma[gemm] counter=94 i=6 t=7.5e-03 per=1.5e+01 cost=6.4e+03 flops=8.5e+05
 sigma[gemm] counter=94 i=7 t=7.4e-03 per=1.5e+01 cost=6.4e+03 flops=8.7e+05
 sigma[gemm] counter=94 total t=3.0e-02 per=6.0e+01 cost=2.0e+04 flops=6.6e+05
 sigma[red] counter=94 t=1.3e-02 per=2.6e+01 cost=9.8e+03 flops=7.5e+05
----- TIMING FOR sigma_tot : t_inter=6.2e-01 t_gemm=2.5e+00 t_reduction=1.1e+00 tot=4.2e+00 -----
 sigma_tot[inter] counter=94 t=6.2e-01 per=1.5e+01 cost=1.3e+07 flops=2.2e+07
 sigma_tot[gemm] counter=94 i=0 t=1.3e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=1 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=2 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=3 t=1.1e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=4 t=6.3e-01 per=1.5e+01 cost=1.2e+06 flops=1.9e+06
 sigma_tot[gemm] counter=94 i=5 t=6.4e-01 per=1.5e+01 cost=1.2e+06 flops=1.9e+06
 sigma_tot[gemm] counter=94 i=6 t=6.2e-01 per=1.5e+01 cost=1.6e+06 flops=2.6e+06
 sigma_tot[gemm] counter=94 i=7 t=6.2e-01 per=1.5e+01 cost=1.6e+06 flops=2.6e+06
 sigma_tot[gemm] counter=94 total t=2.5e+00 per=5.9e+01 cost=5.7e+06 flops=2.3e+06
 sigma_tot[red] counter=94 t=1.1e+00 per=2.6e+01 cost=2.2e+06 flops=2.0e+06
T(sub)=7.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-05,4.8e-05,6.2e-06,1.0e-06,2.4e-07
    6   0 +    -116.253081474980 -2.211e-07  4.867e-05    3     6  3.598e-01 5.997e-02 5.985e-02
TIMING FOR Davidson : 3.599e-01  T(cal/comm/rest)=3.591e-01,9.109e-06,7.241e-04
decomposed t_rest=7.241e-04
 T(sub)    =1.714e-04 per=2.367e+01
 T(precond)=4.270e-05 per=5.898e+00
 T(ortho)  =1.142e-05 per=1.577e+00
 T(xcopy)  =2.474e-06 per=3.417e-01
 T(xnrm2)  =2.473e-06 per=3.415e-01
 T(other)  =4.936e-04 per=6.817e+01
optimized energies: isweep=0 ibond=16 dots=2 e[0]=-116.253081474980 nmvp=6
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=9.172e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=lc1 (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond16.txt
 qbond: qsuper nsym=11 dimAll=31
 (26,2):3 (28,2):6 (27,1):6 (27,3):3 (29,1):3 (28,0):3 (29,3):2 (28,4):1 (30,2):1 (25,1):1 (26,0):2
timing for divide=5.5e-05
timing for compute=9.1e-05
timing for collect=1.9e-05
----- TMING FOR decimation_genbasis(su2): 1.7e-04 S T(divide/compute[cpu/gpu/rest]/collect)=5.5e-05,8.1e-05,0.0e+00,1.1e-05,1.9e-05 -----
decimation summary: 31->9 dwt=+0.000e+00 SvN=9.029e-01
 qbond: qkept nsym=5 dimAll=9
 (28,0):3 (27,1):2 (29,1):2 (28,2):1 (26,0):1
----- TIMING for decimation_row(nkr): 5.252e-04 S T(decim/select/formRot)=2.428e-04,1.996e-04,8.284e-05 -----
----- TIMING FOR twodot_decimation: 9.531e-04 S T(wf/decim)=4.135e-04,5.396e-04 -----
ctns::oper_renorm coord=(17,0) superblock=lc oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:18 S:1 P:1 Q:4 
        dim(bra,ket)=9,9 size(op)=19:1.450e-04MB size(tot)=436:3.326e-03MB:3.248e-06GB
        per(mem): H:4.36 C:74.3 S:4.13 P:1.61 Q:15.6 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=6.428e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=24 : 5.004e-04 S -----
rank=0 GPUmem(GB): used=3.006e-05 (oper)=1.367e-05
rank=0 GPUmem(GB): used=3.032e-05 (oper,site)=1.367e-05,2.608e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=24
 no. of rintermediate operators=9
 no. of coefficients=153:1.167e-03MB:1.140e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.466e-03 S -----
rank=0 GPUmem(GB): used=3.146e-05 (oper,site,rinter)=1.367e-05,2.608e-07,1.140e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 8.251e-03 S size(rtasks)=24 size(Rlst2)=25 T(Rmu/Rlist)=1.126e-04,8.139e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.403e-03 S size(rtasks)=24 size(Rlst)=759 -----
rank=0 GPUmem(GB): used=3.146e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.301e-04 blksize=9 blksize0=4 batchsize=759
rank=0 GPUmem(GB): used=1.615e-04 (oper,site,rinter,batch)=1.367e-05,2.608e-07,1.140e-06,1.301e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.071e-03,2.261e-02,1.006e-02
----- TIMING FOR renorm : t_inter=6.1e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=185 t=6.1e-03 per=1.6e+01 cost=7.3e+03 flops=1.2e+06
 renorm[gemm] counter=185 i=0 t=1.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=185 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=185 i=2 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=185 i=3 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=185 i=4 t=7.6e-03 per=1.9e+01 cost=1.3e+03 flops=1.7e+05
 renorm[gemm] counter=185 i=5 t=7.5e-03 per=1.9e+01 cost=3.9e+03 flops=5.3e+05
 renorm[gemm] counter=185 i=6 t=7.6e-03 per=2.0e+01 cost=7.4e+03 flops=9.8e+05
 renorm[gemm] counter=185 total t=2.3e-02 per=5.8e+01 cost=1.3e+04 flops=5.6e+05
 renorm[red] counter=185 t=1.0e-02 per=2.6e+01 cost=4.9e+03 flops=4.8e+05
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=3.8e-01 t_reduction=1.7e-01 tot=6.6e-01 -----
 renorm_tot[inter] counter=185 t=1.1e-01 per=1.6e+01 cost=4.1e+05 flops=3.8e+06
 renorm_tot[gemm] counter=185 i=0 t=2.3e-05 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=185 i=1 t=1.9e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=185 i=2 t=1.9e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=185 i=3 t=1.9e-05 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=185 i=4 t=1.3e-01 per=1.9e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=185 i=5 t=1.3e-01 per=1.9e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=185 i=6 t=1.3e-01 per=1.9e+01 cost=2.3e+05 flops=1.8e+06
 renorm_tot[gemm] counter=185 total t=3.8e-01 per=5.8e+01 cost=4.2e+05 flops=1.1e+06
 renorm_tot[red] counter=185 t=1.7e-01 per=2.6e+01 cost=1.3e+05 flops=7.9e+05
ctns::oper_renorm_opS superblock=lc ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.172e-05 (optmp,oper)=1.341e-07,1.367e-05
rank=0 GPUmem(GB): used=3.198e-05 (optmp,oper,site,rinter)=1.341e-07,1.367e-05,2.608e-07,3.800e-07
rank=0 GPUmem(GB): used=4.034e-05 (optmp,oper,site,rinter,batch)=1.341e-07,1.367e-05,2.608e-07,3.800e-07,8.360e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 8.020e-02 S T(prep/alloc/comp/red/dealloc)=1.244e-03,2.751e-03,6.989e-02,5.035e-03,2.517e-03 -----
----- TIMING FOR oper_renorm_opS : 8.024e-02 S rank=0 -----
qops.to_cpu: size(tot)=436:3.326e-03MB:3.248e-06GB T(to_cpu)=4.276e-05S speed=7.597e-02GB/S
check ||H-H.dagger||=1.333e-14 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.138 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=2.317e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=-1.992e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=-3.800e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 6.289e-01 S #####
 T(local opt: fetch) = 1.844e-02 S  per = 2.93  per(accum) = 2.93
 T(local opt: hdiag) = 3.516e-02 S  per = 5.59  per(accum) = 8.52
 T(local opt: dvdsn) = 4.344e-01 S  per = 69.1  per(accum) = 77.6
 T(local opt: decim) = 1.067e-03 S  per = 0.17  per(accum) = 77.8
 T(local opt: guess) = 6.306e-04 S  per =  0.1  per(accum) = 77.9
 T(local opt: renrm) = 1.390e-01 S  per = 22.1  per(accum) = 100
 T(local opt: save ) = 2.252e-04 S  per = 0.0358  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.344e-01 S  T(sum) = 4.340e-01 S  per = 9.991e+01
 T(local opt: preprocess                  ) = 3.229e-03 S  per = 0.744  per(accum) = 0.744
 T(local opt: symbolic_formulae           ) = 1.158e-03 S  per = 0.267  per(accum) = 1.01
 T(local opt: hintermediate init          ) = 7.801e-05 S  per = 0.018  per(accum) = 1.03
 T(local opt: preprocess_hformulae_Hxlist ) = 4.924e-02 S  per = 11.3  per(accum) = 12.4
 T(local opt: hmmtasks init               ) = 1.948e-02 S  per = 4.49  per(accum) = 16.9
 T(local opt: initial guess for dvdson    ) = 9.059e-04 S  per = 0.209  per(accum) = 17.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.020e-01 S  per = 69.6  per(accum) = 86.7
 T(local opt: dvdson [cpu-gpu]            ) = 1.290e-02 S  per = 2.97  per(accum) = 89.6
 T(local opt: dvdson [nccl]               ) = 4.419e-02 S  per = 10.2  per(accum) = 99.8
 T(local opt: dvdson [mpi]                ) = 9.109e-06 S  per = 0.0021  per(accum) = 99.8
 T(local opt: dvdson [rest part(linalg)]  ) = 7.241e-04 S  per = 0.167  per(accum) = 100
Detailed decomposition of T(renrm) = 1.390e-01 S  T(sum) = 1.390e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.630e-04 S  per = 0.189  per(accum) = 0.189
 T(local opt: qops init                    ) = 8.641e-04 S  per = 0.622  per(accum) = 0.811
 T(local opt: symbolic_formulae_renorm     ) = 5.145e-04 S  per = 0.37  per(accum) = 1.18
 T(local opt: allocate qops on gpu         ) = 5.551e-05 S  per = 0.0399  per(accum) = 1.22
 T(local opt: site memcpy cpu2gpu          ) = 4.983e-04 S  per = 0.359  per(accum) = 1.58
 T(local opt: rintermediate init           ) = 2.480e-03 S  per = 1.78  per(accum) = 3.36
 T(local opt: preprocess_formulae_Rlist2   ) = 8.477e-03 S  per =  6.1  per(accum) = 9.46
 T(local opt: rmmtasks init                ) = 3.801e-03 S  per = 2.73  per(accum) = 12.2
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 2.52e-05  per(accum) = 12.2
 T(local opt: preprocess_renorm_batchGPU   ) = 3.891e-02 S  per =   28  per(accum) = 40.2
 T(local opt: deallocate cpu and gpu memory) = 4.896e-05 S  per = 0.0352  per(accum) = 40.2
 T(local opt: construct opS [ifdists=true] ) = 8.029e-02 S  per = 57.8  per(accum) = 98
 T(local opt: reduction of opS & opH [nccl]) = 2.440e-03 S  per = 1.76  per(accum) = 99.8
 T(local opt: qops memcpy gpu2cpu          ) = 5.479e-05 S  per = 0.0394  per(accum) = 99.8
 T(local opt: reduction of opS & opH [mpi] ) = 5.194e-05 S  per = 0.0374  per(accum) = 99.8
 T(local opt: qops_pool join and erase     ) = 2.321e-04 S  per = 0.167  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 6.185e-06 S  per = 0.00445  per(accum) = 100
##### sweep opt: 2.114e+01 S #####
 T(sweep opt: fetch) = 2.090e-01 S  per = 0.989  per(accum) = 0.989
 T(sweep opt: hdiag) = 4.494e+00 S  per = 21.3  per(accum) = 22.2
 T(sweep opt: dvdsn) = 7.760e+00 S  per = 36.7  per(accum) = 59
 T(sweep opt: decim) = 1.873e-02 S  per = 0.0886  per(accum) = 59
 T(sweep opt: guess) = 1.140e-02 S  per = 0.0539  per(accum) = 59.1
 T(sweep opt: renrm) = 8.641e+00 S  per = 40.9  per(accum) = 100
 T(sweep opt: save ) = 3.652e-03 S  per = 0.0173  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.760e+00 S  T(sum) = 7.752e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 5.060e-02 S  per = 0.653  per(accum) = 0.653
 T(sweep opt: symbolic_formulae           ) = 5.987e-02 S  per = 0.772  per(accum) = 1.43
 T(sweep opt: hintermediate init          ) = 3.260e-03 S  per = 0.0421  per(accum) = 1.47
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.724e+00 S  per = 22.2  per(accum) = 23.7
 T(sweep opt: hmmtasks init               ) = 7.025e-01 S  per = 9.06  per(accum) = 32.8
 T(sweep opt: initial guess for dvdson    ) = 1.466e-02 S  per = 0.189  per(accum) = 33
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.250e+00 S  per = 54.8  per(accum) = 87.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.853e-01 S  per = 2.39  per(accum) = 90.2
 T(sweep opt: dvdson [nccl]               ) = 7.518e-01 S  per =  9.7  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 6.872e-05 S  per = 0.000887  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 9.209e-03 S  per = 0.119  per(accum) = 100
Detailed decomposition of T(renrm) = 8.641e+00 S  T(sum) = 8.641e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.656e-03 S  per = 0.0539  per(accum) = 0.0539
 T(sweep opt: qops init                    ) = 3.873e-02 S  per = 0.448  per(accum) = 0.502
 T(sweep opt: symbolic_formulae_renorm     ) = 2.020e-02 S  per = 0.234  per(accum) = 0.736
 T(sweep opt: allocate qops on gpu         ) = 1.125e-03 S  per = 0.013  per(accum) = 0.749
 T(sweep opt: site memcpy cpu2gpu          ) = 2.026e-02 S  per = 0.234  per(accum) = 0.983
 T(sweep opt: rintermediate init           ) = 3.789e-02 S  per = 0.438  per(accum) = 1.42
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.622e-01 S  per = 3.03  per(accum) = 4.46
 T(sweep opt: rmmtasks init                ) = 1.340e-01 S  per = 1.55  per(accum) = 6.01
 T(sweep opt: qops memset on cpu           ) = 6.190e-07 S  per = 7.16e-06  per(accum) = 6.01
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.629e-01 S  per = 7.67  per(accum) = 13.7
 T(sweep opt: deallocate cpu and gpu memory) = 1.148e-03 S  per = 0.0133  per(accum) = 13.7
 T(sweep opt: construct opS [ifdists=true] ) = 7.282e+00 S  per = 84.3  per(accum) = 98
 T(sweep opt: reduction of opS & opH [nccl]) = 3.928e-02 S  per = 0.455  per(accum) = 98.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.640e-03 S  per = 0.019  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.008e-03 S  per = 0.0117  per(accum) = 98.4
 T(sweep opt: qops_pool join and erase     ) = 3.144e-02 S  per = 0.364  per(accum) = 98.8
 T(sweep opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 1.19  per(accum) = 100
##### global opt: 2.114e+01 S #####
 T(global opt: fetch) = 2.090e-01 S  per = 0.989  per(accum) = 0.989
 T(global opt: hdiag) = 4.494e+00 S  per = 21.3  per(accum) = 22.2
 T(global opt: dvdsn) = 7.760e+00 S  per = 36.7  per(accum) = 59
 T(global opt: decim) = 1.873e-02 S  per = 0.0886  per(accum) = 59
 T(global opt: guess) = 1.140e-02 S  per = 0.0539  per(accum) = 59.1
 T(global opt: renrm) = 8.641e+00 S  per = 40.9  per(accum) = 100
 T(global opt: save ) = 3.652e-03 S  per = 0.0173  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.760e+00 S  T(sum) = 7.752e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 5.060e-02 S  per = 0.653  per(accum) = 0.653
 T(global opt: symbolic_formulae           ) = 5.987e-02 S  per = 0.772  per(accum) = 1.43
 T(global opt: hintermediate init          ) = 3.260e-03 S  per = 0.0421  per(accum) = 1.47
 T(global opt: preprocess_hformulae_Hxlist ) = 1.724e+00 S  per = 22.2  per(accum) = 23.7
 T(global opt: hmmtasks init               ) = 7.025e-01 S  per = 9.06  per(accum) = 32.8
 T(global opt: initial guess for dvdson    ) = 1.466e-02 S  per = 0.189  per(accum) = 33
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.250e+00 S  per = 54.8  per(accum) = 87.8
 T(global opt: dvdson [cpu-gpu]            ) = 1.853e-01 S  per = 2.39  per(accum) = 90.2
 T(global opt: dvdson [nccl]               ) = 7.518e-01 S  per =  9.7  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 6.872e-05 S  per = 0.000887  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 9.209e-03 S  per = 0.119  per(accum) = 100
Detailed decomposition of T(renrm) = 8.641e+00 S  T(sum) = 8.641e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.656e-03 S  per = 0.0539  per(accum) = 0.0539
 T(global opt: qops init                    ) = 3.873e-02 S  per = 0.448  per(accum) = 0.502
 T(global opt: symbolic_formulae_renorm     ) = 2.020e-02 S  per = 0.234  per(accum) = 0.736
 T(global opt: allocate qops on gpu         ) = 1.125e-03 S  per = 0.013  per(accum) = 0.749
 T(global opt: site memcpy cpu2gpu          ) = 2.026e-02 S  per = 0.234  per(accum) = 0.983
 T(global opt: rintermediate init           ) = 3.789e-02 S  per = 0.438  per(accum) = 1.42
 T(global opt: preprocess_formulae_Rlist2   ) = 2.622e-01 S  per = 3.03  per(accum) = 4.46
 T(global opt: rmmtasks init                ) = 1.340e-01 S  per = 1.55  per(accum) = 6.01
 T(global opt: qops memset on cpu           ) = 6.190e-07 S  per = 7.16e-06  per(accum) = 6.01
 T(global opt: preprocess_renorm_batchGPU   ) = 6.629e-01 S  per = 7.67  per(accum) = 13.7
 T(global opt: deallocate cpu and gpu memory) = 1.148e-03 S  per = 0.0133  per(accum) = 13.7
 T(global opt: construct opS [ifdists=true] ) = 7.282e+00 S  per = 84.3  per(accum) = 98
 T(global opt: reduction of opS & opH [nccl]) = 3.928e-02 S  per = 0.455  per(accum) = 98.4
 T(global opt: qops memcpy gpu2cpu          ) = 1.640e-03 S  per = 0.019  per(accum) = 98.4
 T(global opt: reduction of opS & opH [mpi] ) = 1.008e-03 S  per = 0.0117  per(accum) = 98.4
 T(global opt: qops_pool join and erase     ) = 3.144e-02 S  per = 0.364  per(accum) = 98.8
 T(global opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 1.19  per(accum) = 100
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-9.059e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=17/seqsize=34 dots=2 dbond=(17,0)-(18,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=494:3.769e-03MB:3.681e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=19:1.450e-04MB:1.416e-07GB
total mem of comb=514:3.922e-03MB:3.830e-06GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=17,1,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 15
 suppc1= 13
 suppc2= 14
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(17,0)
 fqop[3]=./scratch/sweep/cop(18,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:17 S:2 P:4 Q:7 
        dim(bra,ket)=8,8 size(op)=19:1.450e-04MB size(tot)=401:3.059e-03MB:2.988e-06GB
        per(mem): H:2.99 C:59.4 S:6.98 P:4.49 Q:26.2 
 rqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3395:0.0259MB:2.53e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=5.364e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(18,0) fdel=./scratch/sweep/lop(17,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.031e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(8,3,3,3) nnz=35:2.670e-04MB
qtensor4: wf4 own=1 _data=0x465e0ea0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=8
 (26,2):2 (27,1):2 (27,3):1 (28,2):1 (25,1):1 (26,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=24 nblocks=230 size=35:2.670e-04MB
### DIAG TIMING: total=3.471e-02 t1=3.563e-05, t2=1.866e-03, t3=2.557e-03, t4=2.775e-02, t5=3.212e-06, t6=2.490e-03, t7=4.868e-06
duration_diagGPU:3.473e-02
duration_diagreduce:6.900e-08
duration_diagtransform:3.540e-07
----- TIMING FOR symbolic_formulae_twodot with size=110 : 1.129e-03 S -----
rank=0 GPUmem(GB): used=2.854e-05 (oper)=2.529e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=110
 no. of hintermediate operators=12
 no. of coefficients=204:1.556e-03MB:1.520e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.965e-05 S -----
rank=0 GPUmem(GB): used=3.006e-05 (oper,hinter)=2.529e-05,1.520e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.801e-02 S size(H_formulae)=110 size(Hxlst2)=24 T(Hmu/Hxlist)=2.835e-04,4.772e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.850e-02 S size(H_formulae)=110 size(Hxlst)=3238 -----
rank=0 GPUmem(GB): used=3.006e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=5.215e-07 batch[need]=2.171e-04 blksize=2 blksize0=4 batchsize=3238
rank=0 GPUmem(GB): used=2.477e-04 (oper,hinter,dvdson,batch)=2.529e-05,1.520e-06,5.215e-07,2.171e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=35 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.414e-03,7.424e-03,2.972e-02,1.283e-02,5.539e-02
 analyze_tgpu[Hx]: ndim=35:2.608e-07GB T(cpu-gpu)=4.329e-04 speed=1.205e-03GB/S T(nccl)=4.981e-03 speed=1.047e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=95 t=7.4e-03 per=1.5e+01 cost=2.0e+04 flops=2.7e+06
 sigma[gemm] counter=95 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=3 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=4 t=7.5e-03 per=1.5e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=95 i=5 t=7.5e-03 per=1.5e+01 cost=3.5e+03 flops=4.7e+05
 sigma[gemm] counter=95 i=6 t=7.4e-03 per=1.5e+01 cost=6.4e+03 flops=8.7e+05
 sigma[gemm] counter=95 i=7 t=7.4e-03 per=1.5e+01 cost=6.4e+03 flops=8.7e+05
 sigma[gemm] counter=95 total t=3.0e-02 per=5.9e+01 cost=2.0e+04 flops=6.7e+05
 sigma[red] counter=95 t=1.3e-02 per=2.6e+01 cost=9.8e+03 flops=7.6e+05
----- TIMING FOR sigma_tot : t_inter=6.2e-01 t_gemm=2.5e+00 t_reduction=1.1e+00 tot=4.3e+00 -----
 sigma_tot[inter] counter=95 t=6.2e-01 per=1.5e+01 cost=1.3e+07 flops=2.1e+07
 sigma_tot[gemm] counter=95 i=0 t=1.3e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=1 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=2 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=3 t=1.1e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=4 t=6.4e-01 per=1.5e+01 cost=1.2e+06 flops=1.9e+06
 sigma_tot[gemm] counter=95 i=5 t=6.5e-01 per=1.5e+01 cost=1.2e+06 flops=1.9e+06
 sigma_tot[gemm] counter=95 i=6 t=6.3e-01 per=1.5e+01 cost=1.6e+06 flops=2.6e+06
 sigma_tot[gemm] counter=95 i=7 t=6.2e-01 per=1.5e+01 cost=1.6e+06 flops=2.6e+06
 sigma_tot[gemm] counter=95 total t=2.5e+00 per=5.9e+01 cost=5.7e+06 flops=2.2e+06
 sigma_tot[red] counter=95 t=1.1e+00 per=2.6e+01 cost=2.2e+06 flops=2.0e+06
T(sub)=9.4e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.0e-06,2.1e-06,6.8e-07,2.0e-07
settings: ndim=35 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.253081474980 -1.116e+03  4.867e-05    1     1  5.566e-02 5.566e-02 5.562e-02
TIMING FOR Davidson : 5.576e-02  T(cal/comm/rest)=5.562e-02,5.057e-06,1.345e-04
decomposed t_rest=1.345e-04
 T(sub)    =9.372e-06 per=6.966e+00
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =3.350e-07 per=2.490e-01
 T(xnrm2)  =4.270e-07 per=3.174e-01
 T(other)  =1.244e-04 per=9.247e+01
optimized energies: isweep=0 ibond=17 dots=2 e[0]=-116.253081474980 nmvp=1
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=9.052e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=6 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond17.txt
 qbond: qsuper nsym=6 dimAll=10
 (0,0):1 (2,0):3 (1,1):2 (4,0):1 (3,1):2 (2,2):1
timing for divide=5.5e-05
timing for compute=5.8e-05
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(su2): 1.3e-04 S T(divide/compute[cpu/gpu/rest]/collect)=5.5e-05,4.9e-05,0.0e+00,9.4e-06,1.6e-05 -----
decimation summary: 10->9 dwt=+0.000e+00 SvN=9.029e-01
 qbond: qkept nsym=5 dimAll=9
 (2,0):3 (1,1):2 (3,1):2 (4,0):1 (2,2):1
----- TIMING for decimation_row(nkr): 4.182e-04 S T(decim/select/formRot)=1.780e-04,1.717e-04,6.847e-05 -----
----- TIMING FOR twodot_decimation: 9.430e-04 S T(wf/decim)=4.706e-04,4.723e-04 -----
ctns::oper_renorm coord=(18,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:2 S:9 A:1 B:4 
        dim(bra,ket)=9,9 size(op)=19:1.450e-04MB size(tot)=292:2.228e-03MB:2.176e-06GB
        per(mem): H:6.51 C:12.3 S:55.5 A:2.4 B:23.3 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=4.461e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=8 : 8.985e-05 S -----
rank=0 GPUmem(GB): used=2.925e-05 (oper)=1.705e-05
rank=0 GPUmem(GB): used=2.939e-05 (oper,site)=1.705e-05,1.416e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=8
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=2.939e-05 (oper,site,rinter)=1.705e-05,1.416e-07,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 9.029e-04 S size(rtasks)=8 size(Rlst2)=25 T(Rmu/Rlist)=2.744e-05,8.754e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.295e-04 S size(rtasks)=8 size(Rlst)=80 -----
rank=0 GPUmem(GB): used=2.939e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.132e-05 blksize=9 blksize0=0 batchsize=80
rank=0 GPUmem(GB): used=4.072e-05 (oper,site,rinter,batch)=1.705e-05,1.416e-07,0.000e+00,1.132e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.073e-03,2.228e-02,9.968e-03
----- TIMING FOR renorm : t_inter=1.1e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.3e-02 -----
 renorm[inter] counter=188 t=1.1e-03 per=3.2e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=188 i=0 t=1.8e-06 per=5.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=188 i=1 t=1.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=188 i=2 t=7.4e-03 per=2.2e+01 cost=1.0e+02 flops=1.4e+04
 renorm[gemm] counter=188 i=3 t=7.4e-03 per=2.2e+01 cost=1.5e+02 flops=2.0e+04
 renorm[gemm] counter=188 i=4 t=1.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=188 i=5 t=1.1e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=188 i=6 t=7.5e-03 per=2.3e+01 cost=7.8e+02 flops=1.0e+05
 renorm[gemm] counter=188 total t=2.2e-02 per=6.7e+01 cost=1.0e+03 flops=4.6e+04
 renorm[red] counter=188 t=1.0e-02 per=3.0e+01 cost=7.8e+02 flops=7.8e+04
----- TIMING FOR renorm_tot : t_inter=1.1e-01 t_gemm=4.0e-01 t_reduction=1.8e-01 tot=6.9e-01 -----
 renorm_tot[inter] counter=188 t=1.1e-01 per=1.6e+01 cost=4.1e+05 flops=3.7e+06
 renorm_tot[gemm] counter=188 i=0 t=2.5e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=188 i=1 t=2.1e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=188 i=2 t=7.4e-03 per=1.1e+00 cost=1.0e+02 flops=1.4e+04
 renorm_tot[gemm] counter=188 i=3 t=7.4e-03 per=1.1e+00 cost=1.5e+02 flops=2.0e+04
 renorm_tot[gemm] counter=188 i=4 t=1.3e-01 per=1.8e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=188 i=5 t=1.3e-01 per=1.8e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=188 i=6 t=1.3e-01 per=1.9e+01 cost=2.3e+05 flops=1.7e+06
 renorm_tot[gemm] counter=188 total t=4.0e-01 per=5.8e+01 cost=4.2e+05 flops=1.0e+06
 renorm_tot[red] counter=188 t=1.8e-01 per=2.6e+01 cost=1.4e+05 flops=7.5e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.939e-05 (optmp,oper)=1.341e-07,1.705e-05
rank=0 GPUmem(GB): used=2.953e-05 (optmp,oper,site,rinter)=1.341e-07,1.705e-05,1.416e-07,0.000e+00
rank=0 GPUmem(GB): used=3.311e-05 (optmp,oper,site,rinter,batch)=1.341e-07,1.705e-05,1.416e-07,0.000e+00,3.584e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 6.435e-01 S T(prep/alloc/comp/red/dealloc)=4.595e-03,6.431e-03,4.567e-01,1.779e-01,2.460e-03 -----
----- TIMING FOR oper_renorm_opS : 6.437e-01 S rank=0 -----
qops.to_cpu: size(tot)=292:2.228e-03MB:2.176e-06GB T(to_cpu)=4.060e-05S speed=5.358e-02GB/S
check ||H-H.dagger||=6.379e-16 coord=(18,0) rank=0
----- TIMING FOR oper_renorm : 0.683 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=4.777e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=7.553e-04 change=-1.749e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=7.553e-04 change=-2.176e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 8.529e-01 S #####
 T(local opt: fetch) = 3.513e-04 S  per = 0.0412  per(accum) = 0.0412
 T(local opt: hdiag) = 3.523e-02 S  per = 4.13  per(accum) = 4.17
 T(local opt: dvdsn) = 1.291e-01 S  per = 15.1  per(accum) = 19.3
 T(local opt: decim) = 1.048e-03 S  per = 0.123  per(accum) = 19.4
 T(local opt: guess) = 7.628e-04 S  per = 0.0894  per(accum) = 19.5
 T(local opt: renrm) = 6.862e-01 S  per = 80.5  per(accum) = 100
 T(local opt: save ) = 1.947e-04 S  per = 0.0228  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.291e-01 S  T(sum) = 1.289e-01 S  per = 9.978e+01
 T(local opt: preprocess                  ) = 3.256e-03 S  per = 2.53  per(accum) = 2.53
 T(local opt: symbolic_formulae           ) = 1.142e-03 S  per = 0.886  per(accum) = 3.41
 T(local opt: hintermediate init          ) = 1.302e-04 S  per = 0.101  per(accum) = 3.51
 T(local opt: preprocess_hformulae_Hxlist ) = 4.861e-02 S  per = 37.7  per(accum) = 41.2
 T(local opt: hmmtasks init               ) = 1.902e-02 S  per = 14.8  per(accum) = 56
 T(local opt: initial guess for dvdson    ) = 9.468e-04 S  per = 0.735  per(accum) = 56.7
 T(local opt: dvdson [Hx_batchGPU]        ) = 5.021e-02 S  per =   39  per(accum) = 95.7
 T(local opt: dvdson [cpu-gpu]            ) = 4.329e-04 S  per = 0.336  per(accum) = 96
 T(local opt: dvdson [nccl]               ) = 4.981e-03 S  per = 3.87  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 5.057e-06 S  per = 0.00392  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 1.345e-04 S  per = 0.104  per(accum) = 100
Detailed decomposition of T(renrm) = 6.862e-01 S  T(sum) = 6.862e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.515e-04 S  per = 0.0221  per(accum) = 0.0221
 T(local opt: qops init                    ) = 6.612e-04 S  per = 0.0964  per(accum) = 0.118
 T(local opt: symbolic_formulae_renorm     ) = 1.017e-04 S  per = 0.0148  per(accum) = 0.133
 T(local opt: allocate qops on gpu         ) = 5.263e-05 S  per = 0.00767  per(accum) = 0.141
 T(local opt: site memcpy cpu2gpu          ) = 1.145e-03 S  per = 0.167  per(accum) = 0.308
 T(local opt: rintermediate init           ) = 3.102e-05 S  per = 0.00452  per(accum) = 0.312
 T(local opt: preprocess_formulae_Rlist2   ) = 9.398e-04 S  per = 0.137  per(accum) = 0.449
 T(local opt: rmmtasks init                ) = 3.952e-04 S  per = 0.0576  per(accum) = 0.507
 T(local opt: qops memset on cpu           ) = 2.600e-08 S  per = 3.79e-06  per(accum) = 0.507
 T(local opt: preprocess_renorm_batchGPU   ) = 3.344e-02 S  per = 4.87  per(accum) = 5.38
 T(local opt: deallocate cpu and gpu memory) = 2.260e-05 S  per = 0.00329  per(accum) = 5.38
 T(local opt: construct opS [ifdists=true] ) = 6.437e-01 S  per = 93.8  per(accum) = 99.2
 T(local opt: reduction of opS & opH [nccl]) = 2.323e-03 S  per = 0.339  per(accum) = 99.5
 T(local opt: qops memcpy gpu2cpu          ) = 5.318e-05 S  per = 0.00775  per(accum) = 99.5
 T(local opt: reduction of opS & opH [mpi] ) = 5.232e-05 S  per = 0.00762  per(accum) = 99.5
 T(local opt: qops_pool join and erase     ) = 3.117e-03 S  per = 0.454  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 4.739e-06 S  per = 0.000691  per(accum) = 100
##### sweep opt: 2.199e+01 S #####
 T(sweep opt: fetch) = 2.094e-01 S  per = 0.952  per(accum) = 0.952
 T(sweep opt: hdiag) = 4.529e+00 S  per = 20.6  per(accum) = 21.5
 T(sweep opt: dvdsn) = 7.889e+00 S  per = 35.9  per(accum) = 57.4
 T(sweep opt: decim) = 1.977e-02 S  per = 0.0899  per(accum) = 57.5
 T(sweep opt: guess) = 1.216e-02 S  per = 0.0553  per(accum) = 57.6
 T(sweep opt: renrm) = 9.327e+00 S  per = 42.4  per(accum) = 100
 T(sweep opt: save ) = 3.847e-03 S  per = 0.0175  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.889e+00 S  T(sum) = 7.881e+00 S  per = 9.989e+01
 T(sweep opt: preprocess                  ) = 5.385e-02 S  per = 0.683  per(accum) = 0.683
 T(sweep opt: symbolic_formulae           ) = 6.101e-02 S  per = 0.774  per(accum) = 1.46
 T(sweep opt: hintermediate init          ) = 3.390e-03 S  per = 0.043  per(accum) = 1.5
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.773e+00 S  per = 22.5  per(accum) = 24
 T(sweep opt: hmmtasks init               ) = 7.215e-01 S  per = 9.16  per(accum) = 33.2
 T(sweep opt: initial guess for dvdson    ) = 1.561e-02 S  per = 0.198  per(accum) = 33.3
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.301e+00 S  per = 54.6  per(accum) = 87.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.858e-01 S  per = 2.36  per(accum) = 90.3
 T(sweep opt: dvdson [nccl]               ) = 7.568e-01 S  per =  9.6  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 7.378e-05 S  per = 0.000936  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 9.344e-03 S  per = 0.119  per(accum) = 100
Detailed decomposition of T(renrm) = 9.327e+00 S  T(sum) = 9.327e+00 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.808e-03 S  per = 0.0515  per(accum) = 0.0515
 T(sweep opt: qops init                    ) = 3.939e-02 S  per = 0.422  per(accum) = 0.474
 T(sweep opt: symbolic_formulae_renorm     ) = 2.030e-02 S  per = 0.218  per(accum) = 0.692
 T(sweep opt: allocate qops on gpu         ) = 1.177e-03 S  per = 0.0126  per(accum) = 0.704
 T(sweep opt: site memcpy cpu2gpu          ) = 2.141e-02 S  per = 0.23  per(accum) = 0.934
 T(sweep opt: rintermediate init           ) = 3.792e-02 S  per = 0.407  per(accum) = 1.34
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.632e-01 S  per = 2.82  per(accum) = 4.16
 T(sweep opt: rmmtasks init                ) = 1.343e-01 S  per = 1.44  per(accum) = 5.6
 T(sweep opt: qops memset on cpu           ) = 6.450e-07 S  per = 6.92e-06  per(accum) = 5.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.964e-01 S  per = 7.47  per(accum) = 13.1
 T(sweep opt: deallocate cpu and gpu memory) = 1.170e-03 S  per = 0.0125  per(accum) = 13.1
 T(sweep opt: construct opS [ifdists=true] ) = 7.926e+00 S  per =   85  per(accum) = 98.1
 T(sweep opt: reduction of opS & opH [nccl]) = 4.160e-02 S  per = 0.446  per(accum) = 98.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.693e-03 S  per = 0.0181  per(accum) = 98.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.061e-03 S  per = 0.0114  per(accum) = 98.5
 T(sweep opt: qops_pool join and erase     ) = 3.455e-02 S  per = 0.37  per(accum) = 98.9
 T(sweep opt: conversion from opAB to opPQ ) = 1.027e-01 S  per =  1.1  per(accum) = 100
##### global opt: 2.199e+01 S #####
 T(global opt: fetch) = 2.094e-01 S  per = 0.952  per(accum) = 0.952
 T(global opt: hdiag) = 4.529e+00 S  per = 20.6  per(accum) = 21.5
 T(global opt: dvdsn) = 7.889e+00 S  per = 35.9  per(accum) = 57.4
 T(global opt: decim) = 1.977e-02 S  per = 0.0899  per(accum) = 57.5
 T(global opt: guess) = 1.216e-02 S  per = 0.0553  per(accum) = 57.6
 T(global opt: renrm) = 9.327e+00 S  per = 42.4  per(accum) = 100
 T(global opt: save ) = 3.847e-03 S  per = 0.0175  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.889e+00 S  T(sum) = 7.881e+00 S  per = 9.989e+01
 T(global opt: preprocess                  ) = 5.385e-02 S  per = 0.683  per(accum) = 0.683
 T(global opt: symbolic_formulae           ) = 6.101e-02 S  per = 0.774  per(accum) = 1.46
 T(global opt: hintermediate init          ) = 3.390e-03 S  per = 0.043  per(accum) = 1.5
 T(global opt: preprocess_hformulae_Hxlist ) = 1.773e+00 S  per = 22.5  per(accum) = 24
 T(global opt: hmmtasks init               ) = 7.215e-01 S  per = 9.16  per(accum) = 33.2
 T(global opt: initial guess for dvdson    ) = 1.561e-02 S  per = 0.198  per(accum) = 33.3
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.301e+00 S  per = 54.6  per(accum) = 87.9
 T(global opt: dvdson [cpu-gpu]            ) = 1.858e-01 S  per = 2.36  per(accum) = 90.3
 T(global opt: dvdson [nccl]               ) = 7.568e-01 S  per =  9.6  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 7.378e-05 S  per = 0.000936  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 9.344e-03 S  per = 0.119  per(accum) = 100
Detailed decomposition of T(renrm) = 9.327e+00 S  T(sum) = 9.327e+00 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.808e-03 S  per = 0.0515  per(accum) = 0.0515
 T(global opt: qops init                    ) = 3.939e-02 S  per = 0.422  per(accum) = 0.474
 T(global opt: symbolic_formulae_renorm     ) = 2.030e-02 S  per = 0.218  per(accum) = 0.692
 T(global opt: allocate qops on gpu         ) = 1.177e-03 S  per = 0.0126  per(accum) = 0.704
 T(global opt: site memcpy cpu2gpu          ) = 2.141e-02 S  per = 0.23  per(accum) = 0.934
 T(global opt: rintermediate init           ) = 3.792e-02 S  per = 0.407  per(accum) = 1.34
 T(global opt: preprocess_formulae_Rlist2   ) = 2.632e-01 S  per = 2.82  per(accum) = 4.16
 T(global opt: rmmtasks init                ) = 1.343e-01 S  per = 1.44  per(accum) = 5.6
 T(global opt: qops memset on cpu           ) = 6.450e-07 S  per = 6.92e-06  per(accum) = 5.6
 T(global opt: preprocess_renorm_batchGPU   ) = 6.964e-01 S  per = 7.47  per(accum) = 13.1
 T(global opt: deallocate cpu and gpu memory) = 1.170e-03 S  per = 0.0125  per(accum) = 13.1
 T(global opt: construct opS [ifdists=true] ) = 7.926e+00 S  per =   85  per(accum) = 98.1
 T(global opt: reduction of opS & opH [nccl]) = 4.160e-02 S  per = 0.446  per(accum) = 98.5
 T(global opt: qops memcpy gpu2cpu          ) = 1.693e-03 S  per = 0.0181  per(accum) = 98.5
 T(global opt: reduction of opS & opH [mpi] ) = 1.061e-03 S  per = 0.0114  per(accum) = 98.5
 T(global opt: qops_pool join and erase     ) = 3.455e-02 S  per = 0.37  per(accum) = 98.9
 T(global opt: conversion from opAB to opPQ ) = 1.027e-01 S  per =  1.1  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-9.053e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=18/seqsize=34 dots=2 dbond=(16,0)-(17,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=510:3.891e-03MB:3.800e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=35:2.670e-04MB:2.608e-07GB
total mem of comb=546:4.166e-03MB:4.068e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=16,2,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 14 15
 suppc1= 12
 suppc2= 13
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(16,0)
 fqop[3]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:16 S:2 P:8 Q:10 
        dim(bra,ket)=8,8 size(op)=20:1.526e-04MB size(tot)=462:3.525e-03MB:3.442e-06GB
        per(mem): H:2.6 C:48.5 S:6.06 P:8.23 Q:34.6 
 rqops: oplist=HCSAB nops=H:1 C:2 S:9 A:1 B:4 
        dim(bra,ket)=9,9 size(op)=19:0.000145MB size(tot)=292:0.00223MB:2.18e-06GB
        per(mem): H:6.51 C:12.3 S:55.5 A:2.4 B:23.3 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2750:0.021MB:2.05e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.998e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(17,0) fdel=./scratch/sweep/lop(16,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-3.397e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(8,9,3,3) nnz=69:5.264e-04MB
qtensor4: wf4 own=1 _data=0x3b196d80
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=8
 (25,3):2 (26,2):2 (24,2):1 (25,1):1 (27,3):1 (26,4):1
 qbond: qcol nsym=5 dimAll=9
 (2,0):3 (1,1):2 (3,1):2 (4,0):1 (2,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=31 nblocks=432 size=69:5.264e-04MB
### DIAG TIMING: total=8.299e-02 t1=2.788e-05, t2=1.069e-03, t3=2.509e-03, t4=7.690e-02, t5=3.373e-06, t6=2.484e-03, t7=4.904e-06
duration_diagGPU:8.301e-02
duration_diagreduce:5.500e-08
duration_diagtransform:5.820e-07
----- TIMING FOR symbolic_formulae_twodot with size=107 : 1.377e-03 S -----
rank=0 GPUmem(GB): used=2.049e-05 (oper)=2.049e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=107
 no. of hintermediate operators=42
 no. of coefficients=560:4.272e-03MB:4.172e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 8.224e-05 S -----
rank=0 GPUmem(GB): used=2.466e-05 (oper,hinter)=2.049e-05,4.172e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.635e-02 S size(H_formulae)=107 size(Hxlst2)=31 T(Hmu/Hxlist)=2.538e-04,7.610e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.707e-02 S size(H_formulae)=107 size(Hxlst)=4526 -----
rank=0 GPUmem(GB): used=2.466e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=1.028e-06 batch[need]=7.419e-04 blksize=6 blksize0=9 batchsize=4526
rank=0 GPUmem(GB): used=7.676e-04 (oper,hinter,dvdson,batch)=2.049e-05,4.172e-06,1.028e-06,7.419e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=69 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.762e-03,7.597e-03,3.036e-02,1.309e-02,5.781e-02
 analyze_tgpu[Hx]: ndim=69:5.141e-07GB T(cpu-gpu)=1.753e-03 speed=5.865e-04GB/S T(nccl)=5.009e-03 speed=2.053e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=96 t=7.6e-03 per=1.5e+01 cost=9.3e+04 flops=1.2e+07
 sigma[gemm] counter=96 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=4 t=7.6e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=96 i=5 t=7.6e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=96 i=6 t=7.6e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=96 i=7 t=7.6e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=96 total t=3.0e-02 per=5.9e+01 cost=4.9e+04 flops=1.6e+06
 sigma[red] counter=96 t=1.3e-02 per=2.6e+01 cost=2.1e+04 flops=1.6e+06
----- TIMING FOR sigma_tot : t_inter=6.3e-01 t_gemm=2.6e+00 t_reduction=1.1e+00 tot=4.3e+00 -----
 sigma_tot[inter] counter=96 t=6.3e-01 per=1.5e+01 cost=1.3e+07 flops=2.1e+07
 sigma_tot[gemm] counter=96 i=0 t=1.3e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=1 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=2 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=3 t=1.1e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=4 t=6.5e-01 per=1.5e+01 cost=1.2e+06 flops=1.9e+06
 sigma_tot[gemm] counter=96 i=5 t=6.5e-01 per=1.5e+01 cost=1.2e+06 flops=1.9e+06
 sigma_tot[gemm] counter=96 i=6 t=6.4e-01 per=1.5e+01 cost=1.6e+06 flops=2.6e+06
 sigma_tot[gemm] counter=96 i=7 t=6.3e-01 per=1.5e+01 cost=1.6e+06 flops=2.6e+06
 sigma_tot[gemm] counter=96 total t=2.6e+00 per=5.9e+01 cost=5.7e+06 flops=2.2e+06
 sigma_tot[red] counter=96 t=1.1e+00 per=2.6e+01 cost=2.2e+06 flops=2.0e+06
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,4.5e-06,2.3e-06,7.9e-07,2.5e-07
settings: ndim=69 neig=1 maxcycle=30 nbuff=4 memory=8e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.253081474980 -1.116e+03  1.133e-02    1     1  5.799e-02 5.799e-02 5.796e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.325e-03,7.607e-03,2.982e-02,1.313e-02,5.788e-02
 analyze_tgpu[Hx]: ndim=69:5.141e-07GB T(cpu-gpu)=2.281e-03 speed=4.508e-04GB/S T(nccl)=5.045e-03 speed=2.038e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=97 t=7.6e-03 per=1.5e+01 cost=9.3e+04 flops=1.2e+07
 sigma[gemm] counter=97 i=0 t=1.4e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=4 t=7.4e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=97 i=5 t=7.4e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=97 i=6 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=97 i=7 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=97 total t=3.0e-02 per=5.9e+01 cost=4.9e+04 flops=1.7e+06
 sigma[red] counter=97 t=1.3e-02 per=2.6e+01 cost=2.1e+04 flops=1.6e+06
----- TIMING FOR sigma_tot : t_inter=6.4e-01 t_gemm=2.6e+00 t_reduction=1.1e+00 tot=4.4e+00 -----
 sigma_tot[inter] counter=97 t=6.4e-01 per=1.5e+01 cost=1.4e+07 flops=2.1e+07
 sigma_tot[gemm] counter=97 i=0 t=1.3e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=1 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=2 t=1.1e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=3 t=1.1e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=4 t=6.6e-01 per=1.5e+01 cost=1.3e+06 flops=1.9e+06
 sigma_tot[gemm] counter=97 i=5 t=6.6e-01 per=1.5e+01 cost=1.3e+06 flops=1.9e+06
 sigma_tot[gemm] counter=97 i=6 t=6.4e-01 per=1.5e+01 cost=1.6e+06 flops=2.5e+06
 sigma_tot[gemm] counter=97 i=7 t=6.4e-01 per=1.5e+01 cost=1.6e+06 flops=2.6e+06
 sigma_tot[gemm] counter=97 total t=2.6e+00 per=5.9e+01 cost=5.8e+06 flops=2.2e+06
 sigma_tot[red] counter=97 t=1.1e+00 per=2.6e+01 cost=2.2e+06 flops=2.0e+06
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.3e-05,3.8e-06,4.7e-06,2.5e-07
    2   0 -    -116.253279731768 -1.983e-04  2.637e-03    2     2  1.162e-01 5.812e-02 5.804e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.924e-03,7.503e-03,3.014e-02,1.297e-02,5.854e-02
 analyze_tgpu[Hx]: ndim=69:5.141e-07GB T(cpu-gpu)=2.187e-03 speed=4.702e-04GB/S T(nccl)=5.737e-03 speed=1.792e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=98 t=7.5e-03 per=1.5e+01 cost=9.3e+04 flops=1.2e+07
 sigma[gemm] counter=98 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=4 t=7.5e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=98 i=5 t=7.5e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=98 i=6 t=7.6e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=98 i=7 t=7.6e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=98 total t=3.0e-02 per=6.0e+01 cost=4.9e+04 flops=1.6e+06
 sigma[red] counter=98 t=1.3e-02 per=2.6e+01 cost=2.1e+04 flops=1.6e+06
----- TIMING FOR sigma_tot : t_inter=6.5e-01 t_gemm=2.6e+00 t_reduction=1.2e+00 tot=4.4e+00 -----
 sigma_tot[inter] counter=98 t=6.5e-01 per=1.5e+01 cost=1.4e+07 flops=2.1e+07
 sigma_tot[gemm] counter=98 i=0 t=1.3e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=1 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=2 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=3 t=1.1e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=4 t=6.6e-01 per=1.5e+01 cost=1.3e+06 flops=1.9e+06
 sigma_tot[gemm] counter=98 i=5 t=6.7e-01 per=1.5e+01 cost=1.3e+06 flops=1.9e+06
 sigma_tot[gemm] counter=98 i=6 t=6.5e-01 per=1.5e+01 cost=1.6e+06 flops=2.5e+06
 sigma_tot[gemm] counter=98 i=7 t=6.5e-01 per=1.5e+01 cost=1.6e+06 flops=2.5e+06
 sigma_tot[gemm] counter=98 total t=2.6e+00 per=5.9e+01 cost=5.8e+06 flops=2.2e+06
 sigma_tot[red] counter=98 t=1.2e+00 per=2.6e+01 cost=2.3e+06 flops=2.0e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.6e-05,3.2e-06,1.1e-06,2.5e-07
    3   0 -    -116.253298797483 -1.907e-05  8.896e-04    3     3  1.751e-01 5.837e-02 5.828e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.424e-02,7.442e-03,1.630e-02,2.990e-03,6.098e-02
 analyze_tgpu[Hx]: ndim=69:5.141e-07GB T(cpu-gpu)=2.141e-03 speed=4.803e-04GB/S T(nccl)=3.210e-02 speed=3.203e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=1.6e-02 t_reduction=3.0e-03 tot=2.7e-02 -----
 sigma[inter] counter=99 t=7.4e-03 per=2.8e+01 cost=9.3e+04 flops=1.2e+07
 sigma[gemm] counter=99 i=0 t=1.3e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=1 t=1.2e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=2 t=1.1e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=3 t=1.1e-06 per=4.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=4 t=7.6e-03 per=2.8e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=99 i=5 t=5.1e-03 per=1.9e+01 cost=1.3e+04 flops=2.5e+06
 sigma[gemm] counter=99 i=6 t=1.1e-03 per=4.1e+00 cost=1.2e+04 flops=1.1e+07
 sigma[gemm] counter=99 i=7 t=2.5e-03 per=9.3e+00 cost=1.2e+04 flops=4.8e+06
 sigma[gemm] counter=99 total t=1.6e-02 per=6.1e+01 cost=4.9e+04 flops=3.0e+06
 sigma[red] counter=99 t=3.0e-03 per=1.1e+01 cost=2.1e+04 flops=7.0e+06
----- TIMING FOR sigma_tot : t_inter=6.5e-01 t_gemm=2.6e+00 t_reduction=1.2e+00 tot=4.5e+00 -----
 sigma_tot[inter] counter=99 t=6.5e-01 per=1.5e+01 cost=1.4e+07 flops=2.1e+07
 sigma_tot[gemm] counter=99 i=0 t=1.3e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=1 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=2 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=3 t=1.1e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=4 t=6.7e-01 per=1.5e+01 cost=1.3e+06 flops=1.9e+06
 sigma_tot[gemm] counter=99 i=5 t=6.7e-01 per=1.5e+01 cost=1.3e+06 flops=1.9e+06
 sigma_tot[gemm] counter=99 i=6 t=6.5e-01 per=1.5e+01 cost=1.7e+06 flops=2.5e+06
 sigma_tot[gemm] counter=99 i=7 t=6.5e-01 per=1.5e+01 cost=1.7e+06 flops=2.6e+06
 sigma_tot[gemm] counter=99 total t=2.6e+00 per=5.9e+01 cost=5.9e+06 flops=2.2e+06
 sigma_tot[red] counter=99 t=1.2e+00 per=2.6e+01 cost=2.3e+06 flops=2.0e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,3.3e-06,1.2e-06,2.6e-07
    4   0 -    -116.253300374249 -1.577e-06  2.792e-04    3     4  2.364e-01 5.911e-02 5.901e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.166e-02,7.423e-03,2.976e-02,1.280e-02,6.165e-02
 analyze_tgpu[Hx]: ndim=69:5.141e-07GB T(cpu-gpu)=2.187e-03 speed=4.700e-04GB/S T(nccl)=9.474e-03 speed=1.085e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=100 t=7.4e-03 per=1.5e+01 cost=9.3e+04 flops=1.3e+07
 sigma[gemm] counter=100 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=4 t=7.4e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=100 i=5 t=7.4e-03 per=1.5e+01 cost=1.3e+04 flops=1.7e+06
 sigma[gemm] counter=100 i=6 t=7.5e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=100 i=7 t=7.4e-03 per=1.5e+01 cost=1.2e+04 flops=1.6e+06
 sigma[gemm] counter=100 total t=3.0e-02 per=6.0e+01 cost=4.9e+04 flops=1.7e+06
 sigma[red] counter=100 t=1.3e-02 per=2.6e+01 cost=2.1e+04 flops=1.6e+06
----- TIMING FOR sigma_tot : t_inter=6.6e-01 t_gemm=2.7e+00 t_reduction=1.2e+00 tot=4.5e+00 -----
 sigma_tot[inter] counter=100 t=6.6e-01 per=1.5e+01 cost=1.4e+07 flops=2.1e+07
 sigma_tot[gemm] counter=100 i=0 t=1.3e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=1 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=2 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=3 t=1.1e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=4 t=6.8e-01 per=1.5e+01 cost=1.3e+06 flops=1.9e+06
 sigma_tot[gemm] counter=100 i=5 t=6.8e-01 per=1.5e+01 cost=1.3e+06 flops=1.9e+06
 sigma_tot[gemm] counter=100 i=6 t=6.6e-01 per=1.5e+01 cost=1.7e+06 flops=2.5e+06
 sigma_tot[gemm] counter=100 i=7 t=6.6e-01 per=1.5e+01 cost=1.7e+06 flops=2.5e+06
 sigma_tot[gemm] counter=100 total t=2.7e+00 per=5.9e+01 cost=5.9e+06 flops=2.2e+06
 sigma_tot[red] counter=100 t=1.2e+00 per=2.6e+01 cost=2.3e+06 flops=2.0e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.3e-05,3.2e-06,1.2e-06,2.1e-07
    5   0 +    -116.253300539751 -1.655e-07  8.987e-05    3     5  2.983e-01 5.967e-02 5.957e-02
TIMING FOR Davidson : 2.984e-01  T(cal/comm/rest)=2.978e-01,6.028e-06,5.427e-04
decomposed t_rest=5.427e-04
 T(sub)    =1.056e-04 per=1.946e+01
 T(precond)=3.485e-05 per=6.422e+00
 T(ortho)  =1.001e-05 per=1.844e+00
 T(xcopy)  =7.620e-07 per=1.404e-01
 T(xnrm2)  =2.343e-06 per=4.317e-01
 T(other)  =3.891e-04 per=7.170e+01
optimized energies: isweep=0 ibond=18 dots=2 e[0]=-116.253300539751 nmvp=5
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=5.722e-04 change=1.354e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond18.txt
 qbond: qsuper nsym=9 dimAll=32
 (2,0):5 (1,1):2 (3,1):8 (4,0):6 (2,2):3 (5,1):3 (6,0):1 (4,2):3 (3,3):1
timing for divide=8.6e-05
timing for compute=1.0e-04
timing for collect=1.8e-05
----- TMING FOR decimation_genbasis(su2): 2.1e-04 S T(divide/compute[cpu/gpu/rest]/collect)=8.6e-05,9.2e-05,0.0e+00,1.0e-05,1.8e-05 -----
decimation summary: 32->10 dwt=+1.680e-06 SvN=9.503e-01
 qbond: qkept nsym=6 dimAll=10
 (3,1):3 (2,2):2 (4,2):2 (4,0):1 (5,1):1 (3,3):1
----- TIMING for decimation_row(nkr): 5.345e-04 S T(decim/select/formRot)=2.608e-04,1.926e-04,8.103e-05 -----
----- TIMING FOR twodot_decimation: 1.445e-03 S T(wf/decim)=8.137e-04,6.314e-04 -----
ctns::oper_renorm coord=(17,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:3 S:8 A:4 B:7 
        dim(bra,ket)=10,10 size(op)=29:2.213e-04MB size(tot)=460:3.510e-03MB:3.427e-06GB
        per(mem): H:4.35 C:14.3 S:38.3 A:6.74 B:36.3 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=5.722e-04 change=6.789e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=15 : 1.722e-04 S -----
rank=0 GPUmem(GB): used=2.465e-05 (oper)=1.304e-05
rank=0 GPUmem(GB): used=2.499e-05 (oper,site)=1.304e-05,3.427e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=15
 no. of rintermediate operators=4
 no. of coefficients=8:6.104e-05MB:5.960e-08GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.427e-03 S -----
rank=0 GPUmem(GB): used=2.505e-05 (oper,site,rinter)=1.304e-05,3.427e-07,5.960e-08
----- TIMING FOR preprocess_formulae_Rlist2 : 3.788e-03 S size(rtasks)=15 size(Rlst2)=36 T(Rmu/Rlist)=6.146e-05,3.727e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.832e-03 S size(rtasks)=15 size(Rlst)=321 -----
rank=0 GPUmem(GB): used=2.505e-05 avail=6.231e+00 total=6.231e+00 batch[need]=6.697e-05 blksize=9 blksize0=9 batchsize=321
rank=0 GPUmem(GB): used=9.201e-05 (oper,site,rinter,batch)=1.304e-05,3.427e-07,5.960e-08,6.697e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.685e-03,2.209e-02,9.858e-03
----- TIMING FOR renorm : t_inter=6.7e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=205 t=6.7e-03 per=1.7e+01 cost=9.9e+02 flops=1.5e+05
 renorm[gemm] counter=205 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=205 i=1 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=205 i=2 t=7.4e-03 per=1.9e+01 cost=1.3e+03 flops=1.7e+05
 renorm[gemm] counter=205 i=3 t=7.3e-03 per=1.9e+01 cost=2.5e+03 flops=3.4e+05
 renorm[gemm] counter=205 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=205 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=205 i=6 t=7.3e-03 per=1.9e+01 cost=5.0e+03 flops=6.8e+05
 renorm[gemm] counter=205 total t=2.2e-02 per=5.7e+01 cost=8.8e+03 flops=4.0e+05
 renorm[red] counter=205 t=9.9e-03 per=2.6e+01 cost=2.8e+03 flops=2.8e+05
----- TIMING FOR renorm_tot : t_inter=1.2e-01 t_gemm=4.3e-01 t_reduction=1.9e-01 tot=7.3e-01 -----
 renorm_tot[inter] counter=205 t=1.2e-01 per=1.6e+01 cost=4.1e+05 flops=3.5e+06
 renorm_tot[gemm] counter=205 i=0 t=2.6e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=205 i=1 t=2.2e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=205 i=2 t=1.5e-02 per=2.0e+00 cost=1.4e+03 flops=9.2e+04
 renorm_tot[gemm] counter=205 i=3 t=1.5e-02 per=2.0e+00 cost=2.6e+03 flops=1.8e+05
 renorm_tot[gemm] counter=205 i=4 t=1.3e-01 per=1.7e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=205 i=5 t=1.3e-01 per=1.7e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=205 i=6 t=1.4e-01 per=1.9e+01 cost=2.4e+05 flops=1.7e+06
 renorm_tot[gemm] counter=205 total t=4.3e-01 per=5.8e+01 cost=4.3e+05 flops=1.0e+06
 renorm_tot[red] counter=205 t=1.9e-01 per=2.6e+01 cost=1.4e+05 flops=7.3e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.624e-05 (optmp,oper)=1.639e-07,1.304e-05
rank=0 GPUmem(GB): used=2.658e-05 (optmp,oper,site,rinter)=1.639e-07,1.304e-05,3.427e-07,1.371e-06
rank=0 GPUmem(GB): used=4.870e-05 (optmp,oper,site,rinter,batch)=1.639e-07,1.304e-05,3.427e-07,1.371e-06,2.211e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 8.147e-01 S T(prep/alloc/comp/red/dealloc)=4.079e-02,4.871e-02,6.850e-01,7.833e-02,2.549e-03 -----
----- TIMING FOR oper_renorm_opS : 8.149e-01 S rank=0 -----
qops.to_cpu: size(tot)=460:3.510e-03MB:3.427e-06GB T(to_cpu)=5.014e-05S speed=6.835e-02GB/S
check ||H-H.dagger||=3.280e-15 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.867 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.670e-04 change=1.499e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.022e-03 change=-1.024e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.022e-03 change=-3.800e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.380e+00 S #####
 T(local opt: fetch) = 1.074e-02 S  per = 0.778  per(accum) = 0.778
 T(local opt: hdiag) = 8.395e-02 S  per = 6.08  per(accum) = 6.86
 T(local opt: dvdsn) = 4.132e-01 S  per = 29.9  per(accum) = 36.8
 T(local opt: decim) = 1.561e-03 S  per = 0.113  per(accum) = 36.9
 T(local opt: guess) = 1.200e-03 S  per = 0.0869  per(accum) = 37
 T(local opt: renrm) = 8.689e-01 S  per =   63  per(accum) = 100
 T(local opt: save ) = 2.248e-04 S  per = 0.0163  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.132e-01 S  T(sum) = 4.128e-01 S  per = 9.989e+01
 T(local opt: preprocess                  ) = 6.648e-03 S  per = 1.61  per(accum) = 1.61
 T(local opt: symbolic_formulae           ) = 1.393e-03 S  per = 0.338  per(accum) = 1.95
 T(local opt: hintermediate init          ) = 1.023e-04 S  per = 0.0248  per(accum) = 1.97
 T(local opt: preprocess_hformulae_Hxlist ) = 7.721e-02 S  per = 18.7  per(accum) = 20.7
 T(local opt: hmmtasks init               ) = 2.717e-02 S  per = 6.58  per(accum) = 27.3
 T(local opt: initial guess for dvdson    ) = 1.861e-03 S  per = 0.451  per(accum) = 27.7
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.299e-01 S  per = 55.7  per(accum) = 83.4
 T(local opt: dvdson [cpu-gpu]            ) = 1.055e-02 S  per = 2.56  per(accum) = 86
 T(local opt: dvdson [nccl]               ) = 5.737e-02 S  per = 13.9  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 6.028e-06 S  per = 0.00146  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 5.427e-04 S  per = 0.131  per(accum) = 100
Detailed decomposition of T(renrm) = 8.689e-01 S  T(sum) = 8.689e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.559e-04 S  per = 0.0294  per(accum) = 0.0294
 T(local opt: qops init                    ) = 1.058e-03 S  per = 0.122  per(accum) = 0.151
 T(local opt: symbolic_formulae_renorm     ) = 1.845e-04 S  per = 0.0212  per(accum) = 0.172
 T(local opt: allocate qops on gpu         ) = 5.286e-05 S  per = 0.00608  per(accum) = 0.179
 T(local opt: site memcpy cpu2gpu          ) = 1.634e-03 S  per = 0.188  per(accum) = 0.367
 T(local opt: rintermediate init           ) = 2.441e-03 S  per = 0.281  per(accum) = 0.647
 T(local opt: preprocess_formulae_Rlist2   ) = 3.848e-03 S  per = 0.443  per(accum) = 1.09
 T(local opt: rmmtasks init                ) = 1.531e-03 S  per = 0.176  per(accum) = 1.27
 T(local opt: qops memset on cpu           ) = 2.800e-08 S  per = 3.22e-06  per(accum) = 1.27
 T(local opt: preprocess_renorm_batchGPU   ) = 3.877e-02 S  per = 4.46  per(accum) = 5.73
 T(local opt: deallocate cpu and gpu memory) = 3.240e-05 S  per = 0.00373  per(accum) = 5.73
 T(local opt: construct opS [ifdists=true] ) = 8.149e-01 S  per = 93.8  per(accum) = 99.5
 T(local opt: reduction of opS & opH [nccl]) = 2.229e-03 S  per = 0.257  per(accum) = 99.8
 T(local opt: qops memcpy gpu2cpu          ) = 6.059e-05 S  per = 0.00697  per(accum) = 99.8
 T(local opt: reduction of opS & opH [mpi] ) = 6.838e-05 S  per = 0.00787  per(accum) = 99.8
 T(local opt: qops_pool join and erase     ) = 1.849e-03 S  per = 0.213  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 6.053e-06 S  per = 0.000697  per(accum) = 100
##### sweep opt: 2.337e+01 S #####
 T(sweep opt: fetch) = 2.201e-01 S  per = 0.942  per(accum) = 0.942
 T(sweep opt: hdiag) = 4.613e+00 S  per = 19.7  per(accum) = 20.7
 T(sweep opt: dvdsn) = 8.302e+00 S  per = 35.5  per(accum) = 56.2
 T(sweep opt: decim) = 2.133e-02 S  per = 0.0913  per(accum) = 56.3
 T(sweep opt: guess) = 1.336e-02 S  per = 0.0572  per(accum) = 56.4
 T(sweep opt: renrm) = 1.020e+01 S  per = 43.6  per(accum) = 100
 T(sweep opt: save ) = 4.072e-03 S  per = 0.0174  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.302e+00 S  T(sum) = 8.293e+00 S  per = 9.989e+01
 T(sweep opt: preprocess                  ) = 6.050e-02 S  per = 0.73  per(accum) = 0.73
 T(sweep opt: symbolic_formulae           ) = 6.241e-02 S  per = 0.753  per(accum) = 1.48
 T(sweep opt: hintermediate init          ) = 3.492e-03 S  per = 0.0421  per(accum) = 1.52
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.850e+00 S  per = 22.3  per(accum) = 23.8
 T(sweep opt: hmmtasks init               ) = 7.487e-01 S  per = 9.03  per(accum) = 32.9
 T(sweep opt: initial guess for dvdson    ) = 1.747e-02 S  per = 0.211  per(accum) = 33.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.530e+00 S  per = 54.6  per(accum) = 87.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.963e-01 S  per = 2.37  per(accum) = 90.1
 T(sweep opt: dvdson [nccl]               ) = 8.141e-01 S  per = 9.82  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 7.981e-05 S  per = 0.000962  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 9.887e-03 S  per = 0.119  per(accum) = 100
Detailed decomposition of T(renrm) = 1.020e+01 S  T(sum) = 1.020e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.063e-03 S  per = 0.0497  per(accum) = 0.0497
 T(sweep opt: qops init                    ) = 4.045e-02 S  per = 0.397  per(accum) = 0.446
 T(sweep opt: symbolic_formulae_renorm     ) = 2.049e-02 S  per = 0.201  per(accum) = 0.647
 T(sweep opt: allocate qops on gpu         ) = 1.230e-03 S  per = 0.0121  per(accum) = 0.659
 T(sweep opt: site memcpy cpu2gpu          ) = 2.304e-02 S  per = 0.226  per(accum) = 0.885
 T(sweep opt: rintermediate init           ) = 4.036e-02 S  per = 0.396  per(accum) = 1.28
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.670e-01 S  per = 2.62  per(accum) = 3.9
 T(sweep opt: rmmtasks init                ) = 1.359e-01 S  per = 1.33  per(accum) = 5.23
 T(sweep opt: qops memset on cpu           ) = 6.730e-07 S  per = 6.6e-06  per(accum) = 5.23
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.351e-01 S  per = 7.21  per(accum) = 12.4
 T(sweep opt: deallocate cpu and gpu memory) = 1.203e-03 S  per = 0.0118  per(accum) = 12.5
 T(sweep opt: construct opS [ifdists=true] ) = 8.741e+00 S  per = 85.7  per(accum) = 98.2
 T(sweep opt: reduction of opS & opH [nccl]) = 4.383e-02 S  per = 0.43  per(accum) = 98.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.753e-03 S  per = 0.0172  per(accum) = 98.6
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.129e-03 S  per = 0.0111  per(accum) = 98.6
 T(sweep opt: qops_pool join and erase     ) = 3.640e-02 S  per = 0.357  per(accum) = 99
 T(sweep opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 1.01  per(accum) = 100
##### global opt: 2.337e+01 S #####
 T(global opt: fetch) = 2.201e-01 S  per = 0.942  per(accum) = 0.942
 T(global opt: hdiag) = 4.613e+00 S  per = 19.7  per(accum) = 20.7
 T(global opt: dvdsn) = 8.302e+00 S  per = 35.5  per(accum) = 56.2
 T(global opt: decim) = 2.133e-02 S  per = 0.0913  per(accum) = 56.3
 T(global opt: guess) = 1.336e-02 S  per = 0.0572  per(accum) = 56.4
 T(global opt: renrm) = 1.020e+01 S  per = 43.6  per(accum) = 100
 T(global opt: save ) = 4.072e-03 S  per = 0.0174  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.302e+00 S  T(sum) = 8.293e+00 S  per = 9.989e+01
 T(global opt: preprocess                  ) = 6.050e-02 S  per = 0.73  per(accum) = 0.73
 T(global opt: symbolic_formulae           ) = 6.241e-02 S  per = 0.753  per(accum) = 1.48
 T(global opt: hintermediate init          ) = 3.492e-03 S  per = 0.0421  per(accum) = 1.52
 T(global opt: preprocess_hformulae_Hxlist ) = 1.850e+00 S  per = 22.3  per(accum) = 23.8
 T(global opt: hmmtasks init               ) = 7.487e-01 S  per = 9.03  per(accum) = 32.9
 T(global opt: initial guess for dvdson    ) = 1.747e-02 S  per = 0.211  per(accum) = 33.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.530e+00 S  per = 54.6  per(accum) = 87.7
 T(global opt: dvdson [cpu-gpu]            ) = 1.963e-01 S  per = 2.37  per(accum) = 90.1
 T(global opt: dvdson [nccl]               ) = 8.141e-01 S  per = 9.82  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 7.981e-05 S  per = 0.000962  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 9.887e-03 S  per = 0.119  per(accum) = 100
Detailed decomposition of T(renrm) = 1.020e+01 S  T(sum) = 1.020e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.063e-03 S  per = 0.0497  per(accum) = 0.0497
 T(global opt: qops init                    ) = 4.045e-02 S  per = 0.397  per(accum) = 0.446
 T(global opt: symbolic_formulae_renorm     ) = 2.049e-02 S  per = 0.201  per(accum) = 0.647
 T(global opt: allocate qops on gpu         ) = 1.230e-03 S  per = 0.0121  per(accum) = 0.659
 T(global opt: site memcpy cpu2gpu          ) = 2.304e-02 S  per = 0.226  per(accum) = 0.885
 T(global opt: rintermediate init           ) = 4.036e-02 S  per = 0.396  per(accum) = 1.28
 T(global opt: preprocess_formulae_Rlist2   ) = 2.670e-01 S  per = 2.62  per(accum) = 3.9
 T(global opt: rmmtasks init                ) = 1.359e-01 S  per = 1.33  per(accum) = 5.23
 T(global opt: qops memset on cpu           ) = 6.730e-07 S  per = 6.6e-06  per(accum) = 5.23
 T(global opt: preprocess_renorm_batchGPU   ) = 7.351e-01 S  per = 7.21  per(accum) = 12.4
 T(global opt: deallocate cpu and gpu memory) = 1.203e-03 S  per = 0.0118  per(accum) = 12.5
 T(global opt: construct opS [ifdists=true] ) = 8.741e+00 S  per = 85.7  per(accum) = 98.2
 T(global opt: reduction of opS & opH [nccl]) = 4.383e-02 S  per = 0.43  per(accum) = 98.6
 T(global opt: qops memcpy gpu2cpu          ) = 1.753e-03 S  per = 0.0172  per(accum) = 98.6
 T(global opt: reduction of opS & opH [mpi] ) = 1.129e-03 S  per = 0.0111  per(accum) = 98.6
 T(global opt: qops_pool join and erase     ) = 3.640e-02 S  per = 0.357  per(accum) = 99
 T(global opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 1.01  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.321e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=19/seqsize=34 dots=2 dbond=(15,0)-(16,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=521:3.975e-03MB:3.882e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=36:2.747e-04MB:2.682e-07GB
total mem of comb=558:4.257e-03MB:4.157e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=15,3,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 13 14 15
 suppc1= 11
 suppc2= 12
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(15,0)
 fqop[3]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:15 S:3 P:12 Q:16 
        dim(bra,ket)=8,8 size(op)=20:1.526e-04MB size(tot)=578:4.410e-03MB:4.306e-06GB
        per(mem): H:2.08 C:36.3 S:7.27 P:10 Q:44.3 
 rqops: oplist=HCSAB nops=H:1 C:3 S:8 A:4 B:7 
        dim(bra,ket)=10,10 size(op)=29:0.000221MB size(tot)=460:0.00351MB:3.43e-06GB
        per(mem): H:4.35 C:14.3 S:38.3 A:6.74 B:36.3 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3034:0.0231MB:2.26e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.277e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(16,0) fdel=./scratch/sweep/lop(15,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-4.351e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(8,10,3,3) nnz=90:6.866e-04MB
qtensor4: wf4 own=1 _data=0x3b2e0600
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=8
 (23,3):2 (24,2):2 (22,2):1 (25,3):1 (24,4):1 (23,1):1
 qbond: qcol nsym=6 dimAll=10
 (3,1):3 (2,2):2 (4,2):2 (4,0):1 (5,1):1 (3,3):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=40 nblocks=552 size=90:6.866e-04MB
### DIAG TIMING: total=1.389e-01 t1=2.727e-05, t2=7.778e-04, t3=2.491e-03, t4=1.330e-01, t5=3.568e-06, t6=2.555e-03, t7=4.562e-06
duration_diagGPU:1.389e-01
duration_diagreduce:5.000e-08
duration_diagtransform:5.940e-07
----- TIMING FOR symbolic_formulae_twodot with size=149 : 1.994e-03 S -----
rank=0 GPUmem(GB): used=2.261e-05 (oper)=2.261e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=149
 no. of hintermediate operators=68
 no. of coefficients=868:6.622e-03MB:6.467e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.009e-04 S -----
rank=0 GPUmem(GB): used=2.907e-05 (oper,hinter)=2.261e-05,6.467e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.438e-01 S size(H_formulae)=149 size(Hxlst2)=40 T(Hmu/Hxlist)=3.692e-04,1.435e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.451e-01 S size(H_formulae)=149 size(Hxlst)=8696 -----
rank=0 GPUmem(GB): used=2.907e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=1.341e-06 batch[need]=1.425e-03 blksize=6 blksize0=9 batchsize=8696
rank=0 GPUmem(GB): used=1.456e-03 (oper,hinter,dvdson,batch)=2.261e-05,6.467e-06,1.341e-06,1.425e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=90 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.177e-02,7.518e-03,2.978e-02,1.059e-02,5.967e-02
 analyze_tgpu[Hx]: ndim=90:6.706e-07GB T(cpu-gpu)=2.151e-03 speed=6.236e-04GB/S T(nccl)=9.621e-03 speed=1.394e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=101 t=7.5e-03 per=1.6e+01 cost=2.1e+05 flops=2.8e+07
 sigma[gemm] counter=101 i=0 t=1.6e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=1 t=1.2e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=3 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=4 t=7.4e-03 per=1.6e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=101 i=5 t=7.5e-03 per=1.6e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=101 i=6 t=7.4e-03 per=1.6e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=101 i=7 t=7.4e-03 per=1.6e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=101 total t=3.0e-02 per=6.2e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=101 t=1.1e-02 per=2.2e+01 cost=4.2e+04 flops=4.0e+06
----- TIMING FOR sigma_tot : t_inter=6.7e-01 t_gemm=2.7e+00 t_reduction=1.2e+00 tot=4.6e+00 -----
 sigma_tot[inter] counter=101 t=6.7e-01 per=1.5e+01 cost=1.4e+07 flops=2.1e+07
 sigma_tot[gemm] counter=101 i=0 t=1.4e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=1 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=2 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=3 t=1.2e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=4 t=6.9e-01 per=1.5e+01 cost=1.3e+06 flops=1.9e+06
 sigma_tot[gemm] counter=101 i=5 t=6.9e-01 per=1.5e+01 cost=1.3e+06 flops=1.9e+06
 sigma_tot[gemm] counter=101 i=6 t=6.7e-01 per=1.5e+01 cost=1.7e+06 flops=2.5e+06
 sigma_tot[gemm] counter=101 i=7 t=6.6e-01 per=1.5e+01 cost=1.7e+06 flops=2.6e+06
 sigma_tot[gemm] counter=101 total t=2.7e+00 per=5.9e+01 cost=6.0e+06 flops=2.2e+06
 sigma_tot[red] counter=101 t=1.2e+00 per=2.6e+01 cost=2.4e+06 flops=2.0e+06
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=7.4e-06,7.2e-06,2.3e-06,8.3e-07,2.6e-07
settings: ndim=90 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.253299442459 -1.116e+03  1.543e-02    1     1  5.991e-02 5.991e-02 5.987e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.180e-02,7.482e-03,3.010e-02,1.071e-02,6.011e-02
 analyze_tgpu[Hx]: ndim=90:6.706e-07GB T(cpu-gpu)=2.169e-03 speed=6.182e-04GB/S T(nccl)=9.635e-03 speed=1.392e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=102 t=7.5e-03 per=1.5e+01 cost=2.1e+05 flops=2.8e+07
 sigma[gemm] counter=102 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=4 t=7.5e-03 per=1.6e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=102 i=5 t=7.6e-03 per=1.6e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=102 i=6 t=7.5e-03 per=1.6e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=102 i=7 t=7.5e-03 per=1.6e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=102 total t=3.0e-02 per=6.2e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=102 t=1.1e-02 per=2.2e+01 cost=4.2e+04 flops=3.9e+06
----- TIMING FOR sigma_tot : t_inter=6.8e-01 t_gemm=2.7e+00 t_reduction=1.2e+00 tot=4.6e+00 -----
 sigma_tot[inter] counter=102 t=6.8e-01 per=1.5e+01 cost=1.4e+07 flops=2.1e+07
 sigma_tot[gemm] counter=102 i=0 t=1.4e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=1 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=2 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=3 t=1.2e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=4 t=6.9e-01 per=1.5e+01 cost=1.4e+06 flops=2.0e+06
 sigma_tot[gemm] counter=102 i=5 t=7.0e-01 per=1.5e+01 cost=1.4e+06 flops=2.0e+06
 sigma_tot[gemm] counter=102 i=6 t=6.7e-01 per=1.5e+01 cost=1.7e+06 flops=2.5e+06
 sigma_tot[gemm] counter=102 i=7 t=6.7e-01 per=1.5e+01 cost=1.7e+06 flops=2.6e+06
 sigma_tot[gemm] counter=102 total t=2.7e+00 per=5.9e+01 cost=6.2e+06 flops=2.2e+06
 sigma_tot[red] counter=102 t=1.2e+00 per=2.6e+01 cost=2.4e+06 flops=2.0e+06
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=7.0e-06,2.2e-05,1.7e-05,1.5e-06,2.1e-07
    2   0 -    -116.254086841301 -7.874e-04  5.566e-03    2     2  1.204e-01 6.019e-02 6.010e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.131e-03,7.403e-03,2.996e-02,1.061e-02,5.510e-02
 analyze_tgpu[Hx]: ndim=90:6.706e-07GB T(cpu-gpu)=2.140e-03 speed=6.267e-04GB/S T(nccl)=4.991e-03 speed=2.687e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=103 t=7.4e-03 per=1.5e+01 cost=2.1e+05 flops=2.8e+07
 sigma[gemm] counter=103 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=3 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=4 t=7.4e-03 per=1.5e+01 cost=3.0e+04 flops=4.1e+06
 sigma[gemm] counter=103 i=5 t=7.4e-03 per=1.5e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=103 i=6 t=7.6e-03 per=1.6e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=103 i=7 t=7.6e-03 per=1.6e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=103 total t=3.0e-02 per=6.2e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=103 t=1.1e-02 per=2.2e+01 cost=4.2e+04 flops=4.0e+06
----- TIMING FOR sigma_tot : t_inter=6.8e-01 t_gemm=2.8e+00 t_reduction=1.2e+00 tot=4.7e+00 -----
 sigma_tot[inter] counter=103 t=6.8e-01 per=1.5e+01 cost=1.4e+07 flops=2.1e+07
 sigma_tot[gemm] counter=103 i=0 t=1.4e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=1 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=2 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=3 t=1.2e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=4 t=7.0e-01 per=1.5e+01 cost=1.4e+06 flops=2.0e+06
 sigma_tot[gemm] counter=103 i=5 t=7.0e-01 per=1.5e+01 cost=1.4e+06 flops=2.0e+06
 sigma_tot[gemm] counter=103 i=6 t=6.8e-01 per=1.5e+01 cost=1.7e+06 flops=2.6e+06
 sigma_tot[gemm] counter=103 i=7 t=6.8e-01 per=1.5e+01 cost=1.7e+06 flops=2.6e+06
 sigma_tot[gemm] counter=103 total t=2.8e+00 per=5.9e+01 cost=6.3e+06 flops=2.3e+06
 sigma_tot[red] counter=103 t=1.2e+00 per=2.6e+01 cost=2.4e+06 flops=2.0e+06
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=6.0e-06,2.3e-05,1.3e-05,1.5e-06,2.4e-07
    3   0 -    -116.254180987838 -9.415e-05  2.485e-03    3     3  1.758e-01 5.860e-02 5.851e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.188e-02,7.633e-03,2.988e-02,1.072e-02,6.012e-02
 analyze_tgpu[Hx]: ndim=90:6.706e-07GB T(cpu-gpu)=2.223e-03 speed=6.033e-04GB/S T(nccl)=9.658e-03 speed=1.389e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=104 t=7.6e-03 per=1.6e+01 cost=2.1e+05 flops=2.8e+07
 sigma[gemm] counter=104 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=4 t=7.5e-03 per=1.5e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=104 i=5 t=7.5e-03 per=1.6e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=104 i=6 t=7.5e-03 per=1.5e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=104 i=7 t=7.5e-03 per=1.6e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=104 total t=3.0e-02 per=6.2e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=104 t=1.1e-02 per=2.2e+01 cost=4.2e+04 flops=3.9e+06
----- TIMING FOR sigma_tot : t_inter=6.9e-01 t_gemm=2.8e+00 t_reduction=1.2e+00 tot=4.7e+00 -----
 sigma_tot[inter] counter=104 t=6.9e-01 per=1.5e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=104 i=0 t=1.4e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=1 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=2 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=3 t=1.2e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=4 t=7.1e-01 per=1.5e+01 cost=1.4e+06 flops=2.0e+06
 sigma_tot[gemm] counter=104 i=5 t=7.1e-01 per=1.5e+01 cost=1.4e+06 flops=2.0e+06
 sigma_tot[gemm] counter=104 i=6 t=6.9e-01 per=1.5e+01 cost=1.8e+06 flops=2.6e+06
 sigma_tot[gemm] counter=104 i=7 t=6.9e-01 per=1.5e+01 cost=1.8e+06 flops=2.6e+06
 sigma_tot[gemm] counter=104 total t=2.8e+00 per=5.9e+01 cost=6.4e+06 flops=2.3e+06
 sigma_tot[red] counter=104 t=1.2e+00 per=2.6e+01 cost=2.5e+06 flops=2.0e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.4e-05,3.2e-06,1.3e-06,2.4e-07
    4   0 -    -116.254195921430 -1.493e-05  1.052e-03    3     4  2.362e-01 5.906e-02 5.897e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.182e-02,7.519e-03,3.017e-02,1.060e-02,6.011e-02
 analyze_tgpu[Hx]: ndim=90:6.706e-07GB T(cpu-gpu)=2.217e-03 speed=6.049e-04GB/S T(nccl)=9.603e-03 speed=1.397e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=105 t=7.5e-03 per=1.6e+01 cost=2.1e+05 flops=2.8e+07
 sigma[gemm] counter=105 i=0 t=1.2e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=1 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=4 t=7.5e-03 per=1.6e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=105 i=5 t=7.5e-03 per=1.5e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=105 i=6 t=7.6e-03 per=1.6e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=105 i=7 t=7.6e-03 per=1.6e+01 cost=2.5e+04 flops=3.2e+06
 sigma[gemm] counter=105 total t=3.0e-02 per=6.2e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=105 t=1.1e-02 per=2.2e+01 cost=4.2e+04 flops=4.0e+06
----- TIMING FOR sigma_tot : t_inter=7.0e-01 t_gemm=2.8e+00 t_reduction=1.2e+00 tot=4.8e+00 -----
 sigma_tot[inter] counter=105 t=7.0e-01 per=1.5e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=105 i=0 t=1.4e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=1 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=2 t=1.2e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=3 t=1.2e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=4 t=7.2e-01 per=1.5e+01 cost=1.4e+06 flops=2.0e+06
 sigma_tot[gemm] counter=105 i=5 t=7.2e-01 per=1.5e+01 cost=1.4e+06 flops=2.0e+06
 sigma_tot[gemm] counter=105 i=6 t=7.0e-01 per=1.5e+01 cost=1.8e+06 flops=2.6e+06
 sigma_tot[gemm] counter=105 i=7 t=6.9e-01 per=1.5e+01 cost=1.8e+06 flops=2.6e+06
 sigma_tot[gemm] counter=105 total t=2.8e+00 per=5.9e+01 cost=6.5e+06 flops=2.3e+06
 sigma_tot[red] counter=105 t=1.2e+00 per=2.6e+01 cost=2.5e+06 flops=2.1e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.4e-05,3.3e-06,1.4e-06,2.6e-07
    5   0 -    -116.254198881104 -2.960e-06  4.230e-04    3     5  2.967e-01 5.934e-02 5.924e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.172e-02,7.460e-03,3.031e-02,1.073e-02,6.021e-02
 analyze_tgpu[Hx]: ndim=90:6.706e-07GB T(cpu-gpu)=2.148e-03 speed=6.245e-04GB/S T(nccl)=9.568e-03 speed=1.402e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=106 t=7.5e-03 per=1.5e+01 cost=2.1e+05 flops=2.8e+07
 sigma[gemm] counter=106 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=3 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=4 t=7.6e-03 per=1.6e+01 cost=3.0e+04 flops=3.9e+06
 sigma[gemm] counter=106 i=5 t=7.6e-03 per=1.6e+01 cost=3.0e+04 flops=3.9e+06
 sigma[gemm] counter=106 i=6 t=7.6e-03 per=1.6e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=106 i=7 t=7.5e-03 per=1.5e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=106 total t=3.0e-02 per=6.2e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=106 t=1.1e-02 per=2.2e+01 cost=4.2e+04 flops=3.9e+06
----- TIMING FOR sigma_tot : t_inter=7.1e-01 t_gemm=2.9e+00 t_reduction=1.2e+00 tot=4.8e+00 -----
 sigma_tot[inter] counter=106 t=7.1e-01 per=1.5e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=106 i=0 t=1.4e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=1 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=2 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=3 t=1.2e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=4 t=7.2e-01 per=1.5e+01 cost=1.5e+06 flops=2.0e+06
 sigma_tot[gemm] counter=106 i=5 t=7.3e-01 per=1.5e+01 cost=1.5e+06 flops=2.0e+06
 sigma_tot[gemm] counter=106 i=6 t=7.0e-01 per=1.5e+01 cost=1.8e+06 flops=2.6e+06
 sigma_tot[gemm] counter=106 i=7 t=7.0e-01 per=1.5e+01 cost=1.8e+06 flops=2.6e+06
 sigma_tot[gemm] counter=106 total t=2.9e+00 per=5.9e+01 cost=6.6e+06 flops=2.3e+06
 sigma_tot[red] counter=106 t=1.2e+00 per=2.6e+01 cost=2.6e+06 flops=2.1e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.4e-05,3.3e-06,1.2e-06,2.1e-07
    6   0 -    -116.254199272889 -3.918e-07  1.249e-04    3     6  3.571e-01 5.952e-02 5.943e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.164e-02,7.635e-03,2.999e-02,1.074e-02,6.001e-02
 analyze_tgpu[Hx]: ndim=90:6.706e-07GB T(cpu-gpu)=2.286e-03 speed=5.868e-04GB/S T(nccl)=9.353e-03 speed=1.434e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=107 t=7.6e-03 per=1.6e+01 cost=2.1e+05 flops=2.7e+07
 sigma[gemm] counter=107 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=4 t=7.6e-03 per=1.6e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=107 i=5 t=7.5e-03 per=1.5e+01 cost=3.0e+04 flops=4.0e+06
 sigma[gemm] counter=107 i=6 t=7.5e-03 per=1.5e+01 cost=2.3e+04 flops=3.1e+06
 sigma[gemm] counter=107 i=7 t=7.5e-03 per=1.5e+01 cost=2.5e+04 flops=3.3e+06
 sigma[gemm] counter=107 total t=3.0e-02 per=6.2e+01 cost=1.1e+05 flops=3.6e+06
 sigma[red] counter=107 t=1.1e-02 per=2.2e+01 cost=4.2e+04 flops=3.9e+06
----- TIMING FOR sigma_tot : t_inter=7.1e-01 t_gemm=2.9e+00 t_reduction=1.2e+00 tot=4.8e+00 -----
 sigma_tot[inter] counter=107 t=7.1e-01 per=1.5e+01 cost=1.5e+07 flops=2.1e+07
 sigma_tot[gemm] counter=107 i=0 t=1.4e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=1 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=2 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=3 t=1.2e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=4 t=7.3e-01 per=1.5e+01 cost=1.5e+06 flops=2.1e+06
 sigma_tot[gemm] counter=107 i=5 t=7.3e-01 per=1.5e+01 cost=1.5e+06 flops=2.1e+06
 sigma_tot[gemm] counter=107 i=6 t=7.1e-01 per=1.5e+01 cost=1.8e+06 flops=2.6e+06
 sigma_tot[gemm] counter=107 i=7 t=7.1e-01 per=1.5e+01 cost=1.8e+06 flops=2.6e+06
 sigma_tot[gemm] counter=107 total t=2.9e+00 per=5.9e+01 cost=6.7e+06 flops=2.3e+06
 sigma_tot[red] counter=107 t=1.2e+00 per=2.6e+01 cost=2.6e+06 flops=2.1e+06
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=7.8e-06,1.4e-05,3.3e-06,1.2e-06,2.5e-07
    7   0 +    -116.254199308306 -3.542e-08  4.528e-05    3     7  4.174e-01 5.963e-02 5.954e-02
TIMING FOR Davidson : 4.174e-01  T(cal/comm/rest)=4.168e-01,1.687e-05,6.150e-04
decomposed t_rest=6.150e-04
 T(sub)    =2.054e-04 per=3.339e+01
 T(precond)=5.150e-05 per=8.373e+00
 T(ortho)  =3.061e-05 per=4.977e+00
 T(xcopy)  =1.027e-06 per=1.670e-01
 T(xnrm2)  =3.278e-06 per=5.330e-01
 T(other)  =3.232e-04 per=5.256e+01
optimized energies: isweep=0 ibond=19 dots=2 e[0]=-116.254199308306 nmvp=7
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.106e-03 change=2.374e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond19.txt
 qbond: qsuper nsym=11 dimAll=39
 (3,1):5 (2,2):2 (4,2):8 (4,0):4 (5,1):7 (3,3):3 (6,2):3 (6,0):2 (7,1):1 (5,3):3 (4,4):1
timing for divide=1.1e-04
timing for compute=1.2e-04
timing for collect=2.0e-05
----- TMING FOR decimation_genbasis(su2): 2.5e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.1e-04,1.1e-04,0.0e+00,1.1e-05,2.0e-05 -----
decimation summary: 39->10 dwt=+2.690e-04 SvN=7.214e-01
 qbond: qkept nsym=6 dimAll=10
 (4,2):2 (5,1):2 (6,2):2 (5,3):2 (7,1):1 (4,4):1
----- TIMING for decimation_row(nkr): 6.861e-04 S T(decim/select/formRot)=3.484e-04,2.452e-04,9.241e-05 -----
----- TIMING FOR twodot_decimation: 1.825e-03 S T(wf/decim)=1.038e-03,7.870e-04 -----
ctns::oper_renorm coord=(16,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:4 S:8 A:8 B:10 
        dim(bra,ket)=10,10 size(op)=30:2.289e-04MB size(tot)=558:4.257e-03MB:4.157e-06GB
        per(mem): H:3.23 C:14.3 S:28.7 A:10.8 B:43 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=2.106e-03 change=8.761e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=23 : 2.430e-04 S -----
rank=0 GPUmem(GB): used=2.892e-05 (oper)=1.502e-05
rank=0 GPUmem(GB): used=2.925e-05 (oper,site)=1.502e-05,3.278e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=23
 no. of rintermediate operators=5
 no. of coefficients=17:1.297e-04MB:1.267e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.493e-03 S -----
rank=0 GPUmem(GB): used=2.938e-05 (oper,site,rinter)=1.502e-05,3.278e-07,1.267e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 5.220e-03 S size(rtasks)=23 size(Rlst2)=36 T(Rmu/Rlist)=7.789e-05,5.143e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.296e-03 S size(rtasks)=23 size(Rlst)=450 -----
rank=0 GPUmem(GB): used=2.938e-05 avail=6.231e+00 total=6.231e+00 batch[need]=7.376e-05 blksize=6 blksize0=9 batchsize=450
rank=0 GPUmem(GB): used=1.031e-04 (oper,site,rinter,batch)=1.502e-05,3.278e-07,1.267e-07,7.376e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.605e-03,2.233e-02,9.918e-03
----- TIMING FOR renorm : t_inter=6.6e-03 t_gemm=2.2e-02 t_reduction=9.9e-03 tot=3.9e-02 -----
 renorm[inter] counter=223 t=6.6e-03 per=1.7e+01 cost=2.1e+03 flops=3.2e+05
 renorm[gemm] counter=223 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=223 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=223 i=2 t=7.5e-03 per=1.9e+01 cost=1.3e+03 flops=1.8e+05
 renorm[gemm] counter=223 i=3 t=7.5e-03 per=1.9e+01 cost=3.6e+03 flops=4.8e+05
 renorm[gemm] counter=223 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=223 i=5 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=223 i=6 t=7.4e-03 per=1.9e+01 cost=5.6e+03 flops=7.5e+05
 renorm[gemm] counter=223 total t=2.2e-02 per=5.7e+01 cost=1.0e+04 flops=4.7e+05
 renorm[red] counter=223 t=9.9e-03 per=2.6e+01 cost=3.2e+03 flops=3.2e+05
----- TIMING FOR renorm_tot : t_inter=1.2e-01 t_gemm=4.5e-01 t_reduction=2.0e-01 tot=7.7e-01 -----
 renorm_tot[inter] counter=223 t=1.2e-01 per=1.6e+01 cost=4.1e+05 flops=3.3e+06
 renorm_tot[gemm] counter=223 i=0 t=2.7e-05 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=223 i=1 t=2.3e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=223 i=2 t=2.2e-02 per=2.9e+00 cost=2.7e+03 flops=1.2e+05
 renorm_tot[gemm] counter=223 i=3 t=2.2e-02 per=2.9e+00 cost=6.2e+03 flops=2.8e+05
 renorm_tot[gemm] counter=223 i=4 t=1.3e-01 per=1.6e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=223 i=5 t=1.3e-01 per=1.7e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=223 i=6 t=1.5e-01 per=1.9e+01 cost=2.4e+05 flops=1.6e+06
 renorm_tot[gemm] counter=223 total t=4.5e-01 per=5.8e+01 cost=4.4e+05 flops=9.8e+05
 renorm_tot[red] counter=223 t=2.0e-01 per=2.6e+01 cost=1.4e+05 flops=7.1e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.176e-05 (optmp,oper)=1.490e-07,1.502e-05
rank=0 GPUmem(GB): used=3.209e-05 (optmp,oper,site,rinter)=1.490e-07,1.502e-05,3.278e-07,2.563e-06
rank=0 GPUmem(GB): used=4.930e-05 (optmp,oper,site,rinter,batch)=1.490e-07,1.502e-05,3.278e-07,2.563e-06,1.721e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 7.725e-01 S T(prep/alloc/comp/red/dealloc)=3.804e-02,4.564e-02,6.182e-01,1.060e-01,2.528e-03 -----
----- TIMING FOR oper_renorm_opS : 7.726e-01 S rank=0 -----
qops.to_cpu: size(tot)=558:4.257e-03MB:4.157e-06GB T(to_cpu)=6.346e-05S speed=6.552e-02GB/S
check ||H-H.dagger||=5.414e-15 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.828 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=1.984e-03 change=1.490e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.984e-03 change=-1.105e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.984e-03 change=-4.515e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.622e+00 S #####
 T(local opt: fetch) = 1.176e-02 S  per = 0.725  per(accum) = 0.725
 T(local opt: hdiag) = 1.402e-01 S  per = 8.64  per(accum) = 9.36
 T(local opt: dvdsn) = 6.366e-01 S  per = 39.2  per(accum) = 48.6
 T(local opt: decim) = 1.958e-03 S  per = 0.121  per(accum) = 48.7
 T(local opt: guess) = 1.377e-03 S  per = 0.0848  per(accum) = 48.8
 T(local opt: renrm) = 8.303e-01 S  per = 51.2  per(accum) = 100
 T(local opt: save ) = 2.405e-04 S  per = 0.0148  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.366e-01 S  T(sum) = 6.361e-01 S  per = 9.992e+01
 T(local opt: preprocess                  ) = 8.743e-03 S  per = 1.37  per(accum) = 1.37
 T(local opt: symbolic_formulae           ) = 2.009e-03 S  per = 0.316  per(accum) = 1.69
 T(local opt: hintermediate init          ) = 1.189e-04 S  per = 0.0187  per(accum) = 1.71
 T(local opt: preprocess_hformulae_Hxlist ) = 1.455e-01 S  per = 22.9  per(accum) = 24.6
 T(local opt: hmmtasks init               ) = 5.993e-02 S  per = 9.42  per(accum) = 34
 T(local opt: initial guess for dvdson    ) = 2.358e-03 S  per = 0.371  per(accum) = 34.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.390e-01 S  per = 53.3  per(accum) = 87.7
 T(local opt: dvdson [cpu-gpu]            ) = 1.533e-02 S  per = 2.41  per(accum) = 90.1
 T(local opt: dvdson [nccl]               ) = 6.243e-02 S  per = 9.81  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 1.687e-05 S  per = 0.00265  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 6.150e-04 S  per = 0.0967  per(accum) = 100
Detailed decomposition of T(renrm) = 8.303e-01 S  T(sum) = 8.303e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.297e-04 S  per = 0.0397  per(accum) = 0.0397
 T(local opt: qops init                    ) = 1.418e-03 S  per = 0.171  per(accum) = 0.21
 T(local opt: symbolic_formulae_renorm     ) = 2.547e-04 S  per = 0.0307  per(accum) = 0.241
 T(local opt: allocate qops on gpu         ) = 5.668e-05 S  per = 0.00683  per(accum) = 0.248
 T(local opt: site memcpy cpu2gpu          ) = 1.889e-03 S  per = 0.227  per(accum) = 0.475
 T(local opt: rintermediate init           ) = 2.506e-03 S  per = 0.302  per(accum) = 0.777
 T(local opt: preprocess_formulae_Rlist2   ) = 5.316e-03 S  per = 0.64  per(accum) = 1.42
 T(local opt: rmmtasks init                ) = 2.293e-03 S  per = 0.276  per(accum) = 1.69
 T(local opt: qops memset on cpu           ) = 3.100e-08 S  per = 3.73e-06  per(accum) = 1.69
 T(local opt: preprocess_renorm_batchGPU   ) = 3.909e-02 S  per = 4.71  per(accum) = 6.4
 T(local opt: deallocate cpu and gpu memory) = 4.597e-05 S  per = 0.00554  per(accum) = 6.41
 T(local opt: construct opS [ifdists=true] ) = 7.727e-01 S  per = 93.1  per(accum) = 99.5
 T(local opt: reduction of opS & opH [nccl]) = 2.212e-03 S  per = 0.266  per(accum) = 99.7
 T(local opt: qops memcpy gpu2cpu          ) = 7.365e-05 S  per = 0.00887  per(accum) = 99.7
 T(local opt: reduction of opS & opH [mpi] ) = 6.914e-05 S  per = 0.00833  per(accum) = 99.7
 T(local opt: qops_pool join and erase     ) = 2.083e-03 S  per = 0.251  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.170e-06 S  per = 0.000984  per(accum) = 100
##### sweep opt: 2.499e+01 S #####
 T(sweep opt: fetch) = 2.319e-01 S  per = 0.928  per(accum) = 0.928
 T(sweep opt: hdiag) = 4.753e+00 S  per =   19  per(accum) = 19.9
 T(sweep opt: dvdsn) = 8.939e+00 S  per = 35.8  per(accum) = 55.7
 T(sweep opt: decim) = 2.329e-02 S  per = 0.0932  per(accum) = 55.8
 T(sweep opt: guess) = 1.474e-02 S  per = 0.059  per(accum) = 55.9
 T(sweep opt: renrm) = 1.103e+01 S  per = 44.1  per(accum) = 100
 T(sweep opt: save ) = 4.312e-03 S  per = 0.0173  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.939e+00 S  T(sum) = 8.929e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 6.925e-02 S  per = 0.775  per(accum) = 0.775
 T(sweep opt: symbolic_formulae           ) = 6.442e-02 S  per = 0.721  per(accum) = 1.5
 T(sweep opt: hintermediate init          ) = 3.611e-03 S  per = 0.0404  per(accum) = 1.54
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.995e+00 S  per = 22.3  per(accum) = 23.9
 T(sweep opt: hmmtasks init               ) = 8.086e-01 S  per = 9.06  per(accum) = 32.9
 T(sweep opt: initial guess for dvdson    ) = 1.983e-02 S  per = 0.222  per(accum) = 33.2
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.869e+00 S  per = 54.5  per(accum) = 87.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.117e-01 S  per = 2.37  per(accum) = 90.1
 T(sweep opt: dvdson [nccl]               ) = 8.766e-01 S  per = 9.82  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 9.668e-05 S  per = 0.00108  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.050e-02 S  per = 0.118  per(accum) = 100
Detailed decomposition of T(renrm) = 1.103e+01 S  T(sum) = 1.103e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.393e-03 S  per = 0.0489  per(accum) = 0.0489
 T(sweep opt: qops init                    ) = 4.187e-02 S  per = 0.38  per(accum) = 0.429
 T(sweep opt: symbolic_formulae_renorm     ) = 2.074e-02 S  per = 0.188  per(accum) = 0.617
 T(sweep opt: allocate qops on gpu         ) = 1.287e-03 S  per = 0.0117  per(accum) = 0.628
 T(sweep opt: site memcpy cpu2gpu          ) = 2.493e-02 S  per = 0.226  per(accum) = 0.854
 T(sweep opt: rintermediate init           ) = 4.287e-02 S  per = 0.389  per(accum) = 1.24
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.723e-01 S  per = 2.47  per(accum) = 3.71
 T(sweep opt: rmmtasks init                ) = 1.382e-01 S  per = 1.25  per(accum) = 4.97
 T(sweep opt: qops memset on cpu           ) = 7.040e-07 S  per = 6.38e-06  per(accum) = 4.97
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.742e-01 S  per = 7.02  per(accum) = 12
 T(sweep opt: deallocate cpu and gpu memory) = 1.249e-03 S  per = 0.0113  per(accum) = 12
 T(sweep opt: construct opS [ifdists=true] ) = 9.513e+00 S  per = 86.3  per(accum) = 98.3
 T(sweep opt: reduction of opS & opH [nccl]) = 4.604e-02 S  per = 0.418  per(accum) = 98.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.827e-03 S  per = 0.0166  per(accum) = 98.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.198e-03 S  per = 0.0109  per(accum) = 98.7
 T(sweep opt: qops_pool join and erase     ) = 3.849e-02 S  per = 0.349  per(accum) = 99.1
 T(sweep opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 0.931  per(accum) = 100
##### global opt: 2.499e+01 S #####
 T(global opt: fetch) = 2.319e-01 S  per = 0.928  per(accum) = 0.928
 T(global opt: hdiag) = 4.753e+00 S  per =   19  per(accum) = 19.9
 T(global opt: dvdsn) = 8.939e+00 S  per = 35.8  per(accum) = 55.7
 T(global opt: decim) = 2.329e-02 S  per = 0.0932  per(accum) = 55.8
 T(global opt: guess) = 1.474e-02 S  per = 0.059  per(accum) = 55.9
 T(global opt: renrm) = 1.103e+01 S  per = 44.1  per(accum) = 100
 T(global opt: save ) = 4.312e-03 S  per = 0.0173  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.939e+00 S  T(sum) = 8.929e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 6.925e-02 S  per = 0.775  per(accum) = 0.775
 T(global opt: symbolic_formulae           ) = 6.442e-02 S  per = 0.721  per(accum) = 1.5
 T(global opt: hintermediate init          ) = 3.611e-03 S  per = 0.0404  per(accum) = 1.54
 T(global opt: preprocess_hformulae_Hxlist ) = 1.995e+00 S  per = 22.3  per(accum) = 23.9
 T(global opt: hmmtasks init               ) = 8.086e-01 S  per = 9.06  per(accum) = 32.9
 T(global opt: initial guess for dvdson    ) = 1.983e-02 S  per = 0.222  per(accum) = 33.2
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.869e+00 S  per = 54.5  per(accum) = 87.7
 T(global opt: dvdson [cpu-gpu]            ) = 2.117e-01 S  per = 2.37  per(accum) = 90.1
 T(global opt: dvdson [nccl]               ) = 8.766e-01 S  per = 9.82  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 9.668e-05 S  per = 0.00108  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.050e-02 S  per = 0.118  per(accum) = 100
Detailed decomposition of T(renrm) = 1.103e+01 S  T(sum) = 1.103e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.393e-03 S  per = 0.0489  per(accum) = 0.0489
 T(global opt: qops init                    ) = 4.187e-02 S  per = 0.38  per(accum) = 0.429
 T(global opt: symbolic_formulae_renorm     ) = 2.074e-02 S  per = 0.188  per(accum) = 0.617
 T(global opt: allocate qops on gpu         ) = 1.287e-03 S  per = 0.0117  per(accum) = 0.628
 T(global opt: site memcpy cpu2gpu          ) = 2.493e-02 S  per = 0.226  per(accum) = 0.854
 T(global opt: rintermediate init           ) = 4.287e-02 S  per = 0.389  per(accum) = 1.24
 T(global opt: preprocess_formulae_Rlist2   ) = 2.723e-01 S  per = 2.47  per(accum) = 3.71
 T(global opt: rmmtasks init                ) = 1.382e-01 S  per = 1.25  per(accum) = 4.97
 T(global opt: qops memset on cpu           ) = 7.040e-07 S  per = 6.38e-06  per(accum) = 4.97
 T(global opt: preprocess_renorm_batchGPU   ) = 7.742e-01 S  per = 7.02  per(accum) = 12
 T(global opt: deallocate cpu and gpu memory) = 1.249e-03 S  per = 0.0113  per(accum) = 12
 T(global opt: construct opS [ifdists=true] ) = 9.513e+00 S  per = 86.3  per(accum) = 98.3
 T(global opt: reduction of opS & opH [nccl]) = 4.604e-02 S  per = 0.418  per(accum) = 98.7
 T(global opt: qops memcpy gpu2cpu          ) = 1.827e-03 S  per = 0.0166  per(accum) = 98.7
 T(global opt: reduction of opS & opH [mpi] ) = 1.198e-03 S  per = 0.0109  per(accum) = 98.7
 T(global opt: qops_pool join and erase     ) = 3.849e-02 S  per = 0.349  per(accum) = 99.1
 T(global opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 0.931  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.336e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=20/seqsize=34 dots=2 dbond=(14,0)-(15,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=535:4.082e-03MB:3.986e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=40:3.052e-04MB:2.980e-07GB
total mem of comb=576:4.395e-03MB:4.292e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=14,4,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 12 13 14 15
 suppc1= 10
 suppc2= 11
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(14,0)
 fqop[3]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:14 S:3 P:17 Q:22 
        dim(bra,ket)=8,8 size(op)=24:1.831e-04MB size(tot)=796:6.073e-03MB:5.931e-06GB
        per(mem): H:2.01 C:28.1 S:6.03 P:8.54 Q:55.3 
 rqops: oplist=HCSAB nops=H:1 C:4 S:8 A:8 B:10 
        dim(bra,ket)=10,10 size(op)=30:0.000229MB size(tot)=558:0.00426MB:4.16e-06GB
        per(mem): H:3.23 C:14.3 S:28.7 A:10.8 B:43 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3350:0.0256MB:2.5e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.861e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(15,0) fdel=./scratch/sweep/lop(14,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-5.782e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(8,10,3,3) nnz=108:8.240e-04MB
qtensor4: wf4 own=1 _data=0x3b3cd180
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=8
 (21,3):2 (23,3):2 (22,2):2 (22,4):2
 qbond: qcol nsym=6 dimAll=10
 (4,2):2 (5,1):2 (6,2):2 (5,3):2 (7,1):1 (4,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=30 nblocks=384 size=108:8.240e-04MB
### DIAG TIMING: total=1.694e-01 t1=2.596e-05, t2=1.269e-03, t3=2.540e-03, t4=1.631e-01, t5=1.132e-05, t6=2.471e-03, t7=6.695e-06
duration_diagGPU:1.694e-01
duration_diagreduce:6.600e-08
duration_diagtransform:6.710e-07
----- TIMING FOR symbolic_formulae_twodot with size=195 : 2.710e-03 S -----
rank=0 GPUmem(GB): used=2.496e-05 (oper)=2.496e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=195
 no. of hintermediate operators=94
 no. of coefficients=1215:9.270e-03MB:9.052e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.845e-04 S -----
rank=0 GPUmem(GB): used=3.401e-05 (oper,hinter)=2.496e-05,9.052e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.259e-01 S size(H_formulae)=195 size(Hxlst2)=30 T(Hmu/Hxlist)=5.135e-04,1.254e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.270e-01 S size(H_formulae)=195 size(Hxlst)=7412 -----
rank=0 GPUmem(GB): used=3.401e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=1.609e-06 batch[need]=7.179e-04 blksize=4 blksize0=4 batchsize=7412
rank=0 GPUmem(GB): used=7.535e-04 (oper,hinter,dvdson,batch)=2.496e-05,9.052e-06,1.609e-06,7.179e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=108 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.366e-03,7.570e-03,3.019e-02,1.307e-02,5.921e-02
 analyze_tgpu[Hx]: ndim=108:8.047e-07GB T(cpu-gpu)=1.743e-03 speed=9.232e-04GB/S T(nccl)=6.622e-03 speed=2.430e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=108 t=7.6e-03 per=1.5e+01 cost=3.4e+05 flops=4.5e+07
 sigma[gemm] counter=108 i=0 t=1.5e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=4 t=7.4e-03 per=1.5e+01 cost=4.3e+04 flops=5.8e+06
 sigma[gemm] counter=108 i=5 t=7.6e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=108 i=6 t=7.6e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=108 i=7 t=7.6e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=108 total t=3.0e-02 per=5.9e+01 cost=1.7e+05 flops=5.7e+06
 sigma[red] counter=108 t=1.3e-02 per=2.6e+01 cost=5.5e+04 flops=4.2e+06
----- TIMING FOR sigma_tot : t_inter=7.2e-01 t_gemm=2.9e+00 t_reduction=1.3e+00 tot=4.9e+00 -----
 sigma_tot[inter] counter=108 t=7.2e-01 per=1.5e+01 cost=1.6e+07 flops=2.2e+07
 sigma_tot[gemm] counter=108 i=0 t=1.4e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=1 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=2 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=3 t=1.2e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=4 t=7.4e-01 per=1.5e+01 cost=1.6e+06 flops=2.1e+06
 sigma_tot[gemm] counter=108 i=5 t=7.4e-01 per=1.5e+01 cost=1.6e+06 flops=2.1e+06
 sigma_tot[gemm] counter=108 i=6 t=7.2e-01 per=1.5e+01 cost=1.9e+06 flops=2.6e+06
 sigma_tot[gemm] counter=108 i=7 t=7.2e-01 per=1.5e+01 cost=1.9e+06 flops=2.6e+06
 sigma_tot[gemm] counter=108 total t=2.9e+00 per=5.9e+01 cost=6.9e+06 flops=2.4e+06
 sigma_tot[red] counter=108 t=1.3e+00 per=2.6e+01 cost=2.7e+06 flops=2.1e+06
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.0e-06,5.2e-06,2.0e-06,1.4e-06,2.3e-07
settings: ndim=108 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.254067120540 -1.116e+03  2.456e-02    1     1  5.947e-02 5.947e-02 5.944e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.171e-02,7.398e-03,2.975e-02,1.296e-02,6.183e-02
 analyze_tgpu[Hx]: ndim=108:8.047e-07GB T(cpu-gpu)=2.154e-03 speed=7.471e-04GB/S T(nccl)=9.555e-03 speed=1.684e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=109 t=7.4e-03 per=1.5e+01 cost=3.4e+05 flops=4.6e+07
 sigma[gemm] counter=109 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=4 t=7.4e-03 per=1.5e+01 cost=4.3e+04 flops=5.9e+06
 sigma[gemm] counter=109 i=5 t=7.5e-03 per=1.5e+01 cost=4.3e+04 flops=5.8e+06
 sigma[gemm] counter=109 i=6 t=7.4e-03 per=1.5e+01 cost=4.3e+04 flops=5.8e+06
 sigma[gemm] counter=109 i=7 t=7.4e-03 per=1.5e+01 cost=4.3e+04 flops=5.8e+06
 sigma[gemm] counter=109 total t=3.0e-02 per=5.9e+01 cost=1.7e+05 flops=5.8e+06
 sigma[red] counter=109 t=1.3e-02 per=2.6e+01 cost=5.5e+04 flops=4.2e+06
----- TIMING FOR sigma_tot : t_inter=7.3e-01 t_gemm=2.9e+00 t_reduction=1.3e+00 tot=4.9e+00 -----
 sigma_tot[inter] counter=109 t=7.3e-01 per=1.5e+01 cost=1.6e+07 flops=2.2e+07
 sigma_tot[gemm] counter=109 i=0 t=1.5e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=1 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=2 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=3 t=1.2e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=4 t=7.5e-01 per=1.5e+01 cost=1.6e+06 flops=2.1e+06
 sigma_tot[gemm] counter=109 i=5 t=7.5e-01 per=1.5e+01 cost=1.6e+06 flops=2.1e+06
 sigma_tot[gemm] counter=109 i=6 t=7.3e-01 per=1.5e+01 cost=1.9e+06 flops=2.6e+06
 sigma_tot[gemm] counter=109 i=7 t=7.2e-01 per=1.5e+01 cost=1.9e+06 flops=2.7e+06
 sigma_tot[gemm] counter=109 total t=2.9e+00 per=5.9e+01 cost=7.0e+06 flops=2.4e+06
 sigma_tot[red] counter=109 t=1.3e+00 per=2.6e+01 cost=2.7e+06 flops=2.1e+06
T(sub)=3.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.8e-05,3.8e-06,1.1e-05,2.0e-07
    2   0 -    -116.255215136571 -1.148e-03  6.386e-03    2     2  1.216e-01 6.082e-02 6.075e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.141e-03,7.473e-03,3.019e-02,1.283e-02,5.764e-02
 analyze_tgpu[Hx]: ndim=108:8.047e-07GB T(cpu-gpu)=2.190e-03 speed=7.349e-04GB/S T(nccl)=4.951e-03 speed=3.250e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=110 t=7.5e-03 per=1.5e+01 cost=3.4e+05 flops=4.5e+07
 sigma[gemm] counter=110 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=4 t=7.6e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=110 i=5 t=7.5e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=110 i=6 t=7.6e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=110 i=7 t=7.5e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=110 total t=3.0e-02 per=6.0e+01 cost=1.7e+05 flops=5.7e+06
 sigma[red] counter=110 t=1.3e-02 per=2.5e+01 cost=5.5e+04 flops=4.3e+06
----- TIMING FOR sigma_tot : t_inter=7.4e-01 t_gemm=3.0e+00 t_reduction=1.3e+00 tot=5.0e+00 -----
 sigma_tot[inter] counter=110 t=7.4e-01 per=1.5e+01 cost=1.6e+07 flops=2.2e+07
 sigma_tot[gemm] counter=110 i=0 t=1.5e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=1 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=2 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=3 t=1.3e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=4 t=7.5e-01 per=1.5e+01 cost=1.6e+06 flops=2.2e+06
 sigma_tot[gemm] counter=110 i=5 t=7.6e-01 per=1.5e+01 cost=1.6e+06 flops=2.2e+06
 sigma_tot[gemm] counter=110 i=6 t=7.3e-01 per=1.5e+01 cost=2.0e+06 flops=2.7e+06
 sigma_tot[gemm] counter=110 i=7 t=7.3e-01 per=1.5e+01 cost=2.0e+06 flops=2.7e+06
 sigma_tot[gemm] counter=110 total t=3.0e+00 per=5.9e+01 cost=7.2e+06 flops=2.4e+06
 sigma_tot[red] counter=110 t=1.3e+00 per=2.6e+01 cost=2.8e+06 flops=2.2e+06
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.8e-05,3.2e-06,1.3e-06,2.6e-07
    3   0 -    -116.255308783961 -9.365e-05  2.410e-03    3     3  1.795e-01 5.983e-02 5.976e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.164e-03,7.487e-03,3.020e-02,1.314e-02,5.800e-02
 analyze_tgpu[Hx]: ndim=108:8.047e-07GB T(cpu-gpu)=2.249e-03 speed=7.156e-04GB/S T(nccl)=4.915e-03 speed=3.275e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=111 t=7.5e-03 per=1.5e+01 cost=3.4e+05 flops=4.5e+07
 sigma[gemm] counter=111 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=4 t=7.6e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=111 i=5 t=7.6e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=111 i=6 t=7.5e-03 per=1.5e+01 cost=4.3e+04 flops=5.8e+06
 sigma[gemm] counter=111 i=7 t=7.6e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=111 total t=3.0e-02 per=5.9e+01 cost=1.7e+05 flops=5.7e+06
 sigma[red] counter=111 t=1.3e-02 per=2.6e+01 cost=5.5e+04 flops=4.2e+06
----- TIMING FOR sigma_tot : t_inter=7.4e-01 t_gemm=3.0e+00 t_reduction=1.3e+00 tot=5.1e+00 -----
 sigma_tot[inter] counter=111 t=7.4e-01 per=1.5e+01 cost=1.7e+07 flops=2.2e+07
 sigma_tot[gemm] counter=111 i=0 t=1.5e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=1 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=2 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=3 t=1.3e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=4 t=7.6e-01 per=1.5e+01 cost=1.7e+06 flops=2.2e+06
 sigma_tot[gemm] counter=111 i=5 t=7.6e-01 per=1.5e+01 cost=1.7e+06 flops=2.2e+06
 sigma_tot[gemm] counter=111 i=6 t=7.4e-01 per=1.5e+01 cost=2.0e+06 flops=2.7e+06
 sigma_tot[gemm] counter=111 i=7 t=7.4e-01 per=1.5e+01 cost=2.0e+06 flops=2.7e+06
 sigma_tot[gemm] counter=111 total t=3.0e+00 per=5.9e+01 cost=7.4e+06 flops=2.5e+06
 sigma_tot[red] counter=111 t=1.3e+00 per=2.6e+01 cost=2.8e+06 flops=2.2e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.4e-05,3.1e-06,1.3e-06,2.5e-07
    4   0 -    -116.255323235713 -1.445e-05  9.984e-04    3     4  2.377e-01 5.942e-02 5.935e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.265e-03,7.471e-03,3.027e-02,1.317e-02,5.818e-02
 analyze_tgpu[Hx]: ndim=108:8.047e-07GB T(cpu-gpu)=2.270e-03 speed=7.089e-04GB/S T(nccl)=4.994e-03 speed=3.222e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=112 t=7.5e-03 per=1.5e+01 cost=3.4e+05 flops=4.5e+07
 sigma[gemm] counter=112 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=4 t=7.4e-03 per=1.5e+01 cost=4.3e+04 flops=5.8e+06
 sigma[gemm] counter=112 i=5 t=7.6e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=112 i=6 t=7.6e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=112 i=7 t=7.6e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=112 total t=3.0e-02 per=5.9e+01 cost=1.7e+05 flops=5.7e+06
 sigma[red] counter=112 t=1.3e-02 per=2.6e+01 cost=5.5e+04 flops=4.2e+06
----- TIMING FOR sigma_tot : t_inter=7.5e-01 t_gemm=3.0e+00 t_reduction=1.3e+00 tot=5.1e+00 -----
 sigma_tot[inter] counter=112 t=7.5e-01 per=1.5e+01 cost=1.7e+07 flops=2.3e+07
 sigma_tot[gemm] counter=112 i=0 t=1.5e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=1 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=2 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=3 t=1.3e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=4 t=7.7e-01 per=1.5e+01 cost=1.7e+06 flops=2.2e+06
 sigma_tot[gemm] counter=112 i=5 t=7.7e-01 per=1.5e+01 cost=1.7e+06 flops=2.2e+06
 sigma_tot[gemm] counter=112 i=6 t=7.5e-01 per=1.5e+01 cost=2.0e+06 flops=2.7e+06
 sigma_tot[gemm] counter=112 i=7 t=7.5e-01 per=1.5e+01 cost=2.1e+06 flops=2.8e+06
 sigma_tot[gemm] counter=112 total t=3.0e+00 per=5.9e+01 cost=7.6e+06 flops=2.5e+06
 sigma_tot[red] counter=112 t=1.3e+00 per=2.6e+01 cost=2.9e+06 flops=2.2e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.3e-05,3.1e-06,1.3e-06,2.1e-07
    5   0 -    -116.255325852816 -2.617e-06  3.904e-04    3     5  2.961e-01 5.922e-02 5.915e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.244e-03,7.495e-03,3.009e-02,1.292e-02,5.875e-02
 analyze_tgpu[Hx]: ndim=108:8.047e-07GB T(cpu-gpu)=2.286e-03 speed=7.041e-04GB/S T(nccl)=5.958e-03 speed=2.701e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=113 t=7.5e-03 per=1.5e+01 cost=3.4e+05 flops=4.5e+07
 sigma[gemm] counter=113 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=4 t=7.5e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=113 i=5 t=7.7e-03 per=1.5e+01 cost=4.3e+04 flops=5.6e+06
 sigma[gemm] counter=113 i=6 t=7.4e-03 per=1.5e+01 cost=4.3e+04 flops=5.8e+06
 sigma[gemm] counter=113 i=7 t=7.4e-03 per=1.5e+01 cost=4.3e+04 flops=5.8e+06
 sigma[gemm] counter=113 total t=3.0e-02 per=6.0e+01 cost=1.7e+05 flops=5.7e+06
 sigma[red] counter=113 t=1.3e-02 per=2.6e+01 cost=5.5e+04 flops=4.3e+06
----- TIMING FOR sigma_tot : t_inter=7.6e-01 t_gemm=3.1e+00 t_reduction=1.3e+00 tot=5.2e+00 -----
 sigma_tot[inter] counter=113 t=7.6e-01 per=1.5e+01 cost=1.7e+07 flops=2.3e+07
 sigma_tot[gemm] counter=113 i=0 t=1.5e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=1 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=2 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=3 t=1.3e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=4 t=7.8e-01 per=1.5e+01 cost=1.8e+06 flops=2.3e+06
 sigma_tot[gemm] counter=113 i=5 t=7.8e-01 per=1.5e+01 cost=1.8e+06 flops=2.3e+06
 sigma_tot[gemm] counter=113 i=6 t=7.6e-01 per=1.5e+01 cost=2.1e+06 flops=2.8e+06
 sigma_tot[gemm] counter=113 i=7 t=7.5e-01 per=1.5e+01 cost=2.1e+06 flops=2.8e+06
 sigma_tot[gemm] counter=113 total t=3.1e+00 per=5.9e+01 cost=7.7e+06 flops=2.5e+06
 sigma_tot[red] counter=113 t=1.3e+00 per=2.6e+01 cost=2.9e+06 flops=2.2e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.3e-05,3.1e-06,1.3e-06,2.5e-07
    6   0 -    -116.255326267175 -4.144e-07  1.852e-04    3     6  3.551e-01 5.918e-02 5.911e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.933e-03,7.562e-03,3.021e-02,1.320e-02,5.890e-02
 analyze_tgpu[Hx]: ndim=108:8.047e-07GB T(cpu-gpu)=2.303e-03 speed=6.988e-04GB/S T(nccl)=5.630e-03 speed=2.858e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=114 t=7.6e-03 per=1.5e+01 cost=3.4e+05 flops=4.5e+07
 sigma[gemm] counter=114 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=4 t=7.6e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=114 i=5 t=7.6e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=114 i=6 t=7.6e-03 per=1.5e+01 cost=4.3e+04 flops=5.7e+06
 sigma[gemm] counter=114 i=7 t=7.5e-03 per=1.5e+01 cost=4.3e+04 flops=5.8e+06
 sigma[gemm] counter=114 total t=3.0e-02 per=5.9e+01 cost=1.7e+05 flops=5.7e+06
 sigma[red] counter=114 t=1.3e-02 per=2.6e+01 cost=5.5e+04 flops=4.2e+06
----- TIMING FOR sigma_tot : t_inter=7.7e-01 t_gemm=3.1e+00 t_reduction=1.3e+00 tot=5.2e+00 -----
 sigma_tot[inter] counter=114 t=7.7e-01 per=1.5e+01 cost=1.8e+07 flops=2.3e+07
 sigma_tot[gemm] counter=114 i=0 t=1.5e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=1 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=2 t=1.3e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=3 t=1.3e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=4 t=7.8e-01 per=1.5e+01 cost=1.8e+06 flops=2.3e+06
 sigma_tot[gemm] counter=114 i=5 t=7.9e-01 per=1.5e+01 cost=1.8e+06 flops=2.3e+06
 sigma_tot[gemm] counter=114 i=6 t=7.6e-01 per=1.5e+01 cost=2.1e+06 flops=2.8e+06
 sigma_tot[gemm] counter=114 i=7 t=7.6e-01 per=1.5e+01 cost=2.1e+06 flops=2.8e+06
 sigma_tot[gemm] counter=114 total t=3.1e+00 per=5.9e+01 cost=7.9e+06 flops=2.6e+06
 sigma_tot[red] counter=114 t=1.3e+00 per=2.6e+01 cost=3.0e+06 flops=2.2e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.3e-05,3.0e-06,1.3e-06,2.4e-07
    7   0 +    -116.255326334471 -6.730e-08  6.304e-05    3     7  4.143e-01 5.918e-02 5.912e-02
TIMING FOR Davidson : 4.143e-01  T(cal/comm/rest)=4.138e-01,9.614e-06,4.955e-04
decomposed t_rest=4.955e-04
 T(sub)    =1.667e-04 per=3.364e+01
 T(precond)=5.066e-05 per=1.022e+01
 T(ortho)  =1.499e-05 per=3.025e+00
 T(xcopy)  =9.610e-07 per=1.940e-01
 T(xnrm2)  =3.485e-06 per=7.033e-01
 T(other)  =2.587e-04 per=5.222e+01
optimized energies: isweep=0 ibond=20 dots=2 e[0]=-116.255326334471 nmvp=7
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.091e-03 change=2.011e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=13 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond20.txt
 qbond: qsuper nsym=13 dimAll=40
 (4,2):2 (5,1):4 (6,2):8 (5,3):5 (7,1):5 (4,4):1 (8,2):3 (7,3):4 (9,1):1 (6,4):3 (6,0):2 (8,0):1 (5,5):1
timing for divide=9.5e-05
timing for compute=1.1e-04
timing for collect=1.8e-05
----- TMING FOR decimation_genbasis(su2): 2.2e-04 S T(divide/compute[cpu/gpu/rest]/collect)=9.5e-05,1.0e-04,0.0e+00,8.1e-06,1.8e-05 -----
decimation summary: 40->10 dwt=+2.062e-04 SvN=3.170e-01
 qbond: qkept nsym=6 dimAll=10
 (7,3):3 (6,2):2 (6,4):2 (5,3):1 (7,1):1 (8,2):1
----- TIMING for decimation_row(nkr): 6.369e-04 S T(decim/select/formRot)=2.879e-04,2.393e-04,1.097e-04 -----
----- TIMING FOR twodot_decimation: 1.648e-03 S T(wf/decim)=8.887e-04,7.591e-04 -----
ctns::oper_renorm coord=(15,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:5 S:7 A:12 B:16 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=791:6.035e-03MB:5.893e-06GB
        per(mem): H:2.53 C:13.9 S:19.5 A:9.48 B:54.6 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.091e-03 change=1.120e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=34 : 3.437e-04 S -----
rank=0 GPUmem(GB): used=3.397e-05 (oper)=1.749e-05
rank=0 GPUmem(GB): used=3.432e-05 (oper,site)=1.749e-05,3.502e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=34
 no. of rintermediate operators=5
 no. of coefficients=25:1.907e-04MB:1.863e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.475e-03 S -----
rank=0 GPUmem(GB): used=3.451e-05 (oper,site,rinter)=1.749e-05,3.502e-07,1.863e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 8.103e-03 S size(rtasks)=34 size(Rlst2)=36 T(Rmu/Rlist)=9.522e-05,8.008e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.181e-03 S size(rtasks)=34 size(Rlst)=702 -----
rank=0 GPUmem(GB): used=3.451e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.203e-04 blksize=9 blksize0=4 batchsize=702
rank=0 GPUmem(GB): used=1.548e-04 (oper,site,rinter,batch)=1.749e-05,3.502e-07,1.863e-07,1.203e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.591e-03,1.163e-02,2.110e-03
----- TIMING FOR renorm : t_inter=6.6e-03 t_gemm=1.2e-02 t_reduction=2.1e-03 tot=2.0e-02 -----
 renorm[inter] counter=240 t=6.6e-03 per=3.2e+01 cost=3.4e+03 flops=5.1e+05
 renorm[gemm] counter=240 i=0 t=1.3e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=240 i=1 t=1.1e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=240 i=2 t=7.5e-03 per=3.7e+01 cost=1.8e+03 flops=2.4e+05
 renorm[gemm] counter=240 i=3 t=2.2e-03 per=1.1e+01 cost=5.4e+03 flops=2.5e+06
 renorm[gemm] counter=240 i=4 t=1.2e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=240 i=5 t=1.1e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=240 i=6 t=2.0e-03 per=9.6e+00 cost=8.0e+03 flops=4.1e+06
 renorm[gemm] counter=240 total t=1.2e-02 per=5.7e+01 cost=1.5e+04 flops=1.3e+06
 renorm[red] counter=240 t=2.1e-03 per=1.0e+01 cost=4.3e+03 flops=2.0e+06
----- TIMING FOR renorm_tot : t_inter=1.3e-01 t_gemm=4.6e-01 t_reduction=2.0e-01 tot=7.9e-01 -----
 renorm_tot[inter] counter=240 t=1.3e-01 per=1.6e+01 cost=4.1e+05 flops=3.2e+06
 renorm_tot[gemm] counter=240 i=0 t=2.8e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=240 i=1 t=2.4e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=240 i=2 t=3.0e-02 per=3.8e+00 cost=4.5e+03 flops=1.5e+05
 renorm_tot[gemm] counter=240 i=3 t=2.4e-02 per=3.1e+00 cost=1.2e+04 flops=4.8e+05
 renorm_tot[gemm] counter=240 i=4 t=1.3e-01 per=1.6e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=240 i=5 t=1.3e-01 per=1.6e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=240 i=6 t=1.5e-01 per=1.9e+01 cost=2.5e+05 flops=1.7e+06
 renorm_tot[gemm] counter=240 total t=4.6e-01 per=5.8e+01 cost=4.6e+05 flops=9.9e+05
 renorm_tot[red] counter=240 t=2.0e-01 per=2.5e+01 cost=1.5e+05 flops=7.2e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.808e-05 (optmp,oper)=1.639e-07,1.749e-05
rank=0 GPUmem(GB): used=3.843e-05 (optmp,oper,site,rinter)=1.639e-07,1.749e-05,3.502e-07,3.755e-06
rank=0 GPUmem(GB): used=5.578e-05 (optmp,oper,site,rinter,batch)=1.639e-07,1.749e-05,3.502e-07,3.755e-06,1.735e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 7.442e-01 S T(prep/alloc/comp/red/dealloc)=3.316e-02,4.278e-02,5.923e-01,1.065e-01,2.569e-03 -----
----- TIMING FOR oper_renorm_opS : 7.444e-01 S rank=0 -----
qops.to_cpu: size(tot)=791:6.035e-03MB:5.893e-06GB T(to_cpu)=7.342e-05S speed=8.027e-02GB/S
check ||H-H.dagger||=5.233e-15 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.786 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=1.831e-03 change=2.172e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.831e-03 change=-1.145e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=1.831e-03 change=-5.186e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.578e+00 S #####
 T(local opt: fetch) = 1.102e-02 S  per = 0.698  per(accum) = 0.698
 T(local opt: hdiag) = 1.703e-01 S  per = 10.8  per(accum) = 11.5
 T(local opt: dvdsn) = 6.051e-01 S  per = 38.3  per(accum) = 49.8
 T(local opt: decim) = 1.916e-03 S  per = 0.121  per(accum) = 49.9
 T(local opt: guess) = 1.148e-03 S  per = 0.0727  per(accum) = 50
 T(local opt: renrm) = 7.886e-01 S  per =   50  per(accum) = 100
 T(local opt: save ) = 2.412e-04 S  per = 0.0153  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.051e-01 S  T(sum) = 6.045e-01 S  per = 9.991e+01
 T(local opt: preprocess                  ) = 6.047e-03 S  per =    1  per(accum) = 1
 T(local opt: symbolic_formulae           ) = 2.725e-03 S  per = 0.451  per(accum) = 1.45
 T(local opt: hintermediate init          ) = 2.281e-04 S  per = 0.0377  per(accum) = 1.49
 T(local opt: preprocess_hformulae_Hxlist ) = 1.274e-01 S  per = 21.1  per(accum) = 22.6
 T(local opt: hmmtasks init               ) = 5.194e-02 S  per = 8.59  per(accum) = 31.2
 T(local opt: initial guess for dvdson    ) = 1.897e-03 S  per = 0.314  per(accum) = 31.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.560e-01 S  per = 58.9  per(accum) = 90.4
 T(local opt: dvdson [cpu-gpu]            ) = 1.519e-02 S  per = 2.51  per(accum) = 92.9
 T(local opt: dvdson [nccl]               ) = 4.263e-02 S  per = 7.05  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 9.614e-06 S  per = 0.00159  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.955e-04 S  per = 0.082  per(accum) = 100
Detailed decomposition of T(renrm) = 7.886e-01 S  T(sum) = 7.886e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.412e-04 S  per = 0.0433  per(accum) = 0.0433
 T(local opt: qops init                    ) = 1.827e-03 S  per = 0.232  per(accum) = 0.275
 T(local opt: symbolic_formulae_renorm     ) = 3.552e-04 S  per = 0.045  per(accum) = 0.32
 T(local opt: allocate qops on gpu         ) = 6.868e-05 S  per = 0.00871  per(accum) = 0.329
 T(local opt: site memcpy cpu2gpu          ) = 2.306e-03 S  per = 0.292  per(accum) = 0.621
 T(local opt: rintermediate init           ) = 2.488e-03 S  per = 0.315  per(accum) = 0.937
 T(local opt: preprocess_formulae_Rlist2   ) = 8.208e-03 S  per = 1.04  per(accum) = 1.98
 T(local opt: rmmtasks init                ) = 3.634e-03 S  per = 0.461  per(accum) = 2.44
 T(local opt: qops memset on cpu           ) = 3.000e-08 S  per = 3.8e-06  per(accum) = 2.44
 T(local opt: preprocess_renorm_batchGPU   ) = 2.050e-02 S  per =  2.6  per(accum) = 5.04
 T(local opt: deallocate cpu and gpu memory) = 4.184e-05 S  per = 0.00531  per(accum) = 5.04
 T(local opt: construct opS [ifdists=true] ) = 7.444e-01 S  per = 94.4  per(accum) = 99.4
 T(local opt: reduction of opS & opH [nccl]) = 2.214e-03 S  per = 0.281  per(accum) = 99.7
 T(local opt: qops memcpy gpu2cpu          ) = 8.462e-05 S  per = 0.0107  per(accum) = 99.7
 T(local opt: reduction of opS & opH [mpi] ) = 6.982e-05 S  per = 0.00885  per(accum) = 99.7
 T(local opt: qops_pool join and erase     ) = 2.072e-03 S  per = 0.263  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.812e-06 S  per = 0.00112  per(accum) = 100
##### sweep opt: 2.657e+01 S #####
 T(sweep opt: fetch) = 2.429e-01 S  per = 0.914  per(accum) = 0.914
 T(sweep opt: hdiag) = 4.923e+00 S  per = 18.5  per(accum) = 19.4
 T(sweep opt: dvdsn) = 9.544e+00 S  per = 35.9  per(accum) = 55.4
 T(sweep opt: decim) = 2.521e-02 S  per = 0.0949  per(accum) = 55.5
 T(sweep opt: guess) = 1.588e-02 S  per = 0.0598  per(accum) = 55.5
 T(sweep opt: renrm) = 1.182e+01 S  per = 44.5  per(accum) = 100
 T(sweep opt: save ) = 4.553e-03 S  per = 0.0171  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.544e+00 S  T(sum) = 9.534e+00 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 7.529e-02 S  per = 0.79  per(accum) = 0.79
 T(sweep opt: symbolic_formulae           ) = 6.714e-02 S  per = 0.704  per(accum) = 1.49
 T(sweep opt: hintermediate init          ) = 3.839e-03 S  per = 0.0403  per(accum) = 1.53
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.123e+00 S  per = 22.3  per(accum) = 23.8
 T(sweep opt: hmmtasks init               ) = 8.605e-01 S  per = 9.03  per(accum) = 32.8
 T(sweep opt: initial guess for dvdson    ) = 2.172e-02 S  per = 0.228  per(accum) = 33.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.225e+00 S  per = 54.8  per(accum) = 87.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.269e-01 S  per = 2.38  per(accum) = 90.2
 T(sweep opt: dvdson [nccl]               ) = 9.192e-01 S  per = 9.64  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 1.063e-04 S  per = 0.00111  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.100e-02 S  per = 0.115  per(accum) = 100
Detailed decomposition of T(renrm) = 1.182e+01 S  T(sum) = 1.182e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.734e-03 S  per = 0.0485  per(accum) = 0.0485
 T(sweep opt: qops init                    ) = 4.370e-02 S  per = 0.37  per(accum) = 0.418
 T(sweep opt: symbolic_formulae_renorm     ) = 2.110e-02 S  per = 0.179  per(accum) = 0.597
 T(sweep opt: allocate qops on gpu         ) = 1.356e-03 S  per = 0.0115  per(accum) = 0.608
 T(sweep opt: site memcpy cpu2gpu          ) = 2.724e-02 S  per = 0.231  per(accum) = 0.839
 T(sweep opt: rintermediate init           ) = 4.536e-02 S  per = 0.384  per(accum) = 1.22
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.806e-01 S  per = 2.37  per(accum) = 3.6
 T(sweep opt: rmmtasks init                ) = 1.418e-01 S  per =  1.2  per(accum) = 4.8
 T(sweep opt: qops memset on cpu           ) = 7.340e-07 S  per = 6.21e-06  per(accum) = 4.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.947e-01 S  per = 6.73  per(accum) = 11.5
 T(sweep opt: deallocate cpu and gpu memory) = 1.290e-03 S  per = 0.0109  per(accum) = 11.5
 T(sweep opt: construct opS [ifdists=true] ) = 1.026e+01 S  per = 86.8  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [nccl]) = 4.826e-02 S  per = 0.408  per(accum) = 98.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.912e-03 S  per = 0.0162  per(accum) = 98.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.268e-03 S  per = 0.0107  per(accum) = 98.8
 T(sweep opt: qops_pool join and erase     ) = 4.056e-02 S  per = 0.343  per(accum) = 99.1
 T(sweep opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 0.869  per(accum) = 100
##### global opt: 2.657e+01 S #####
 T(global opt: fetch) = 2.429e-01 S  per = 0.914  per(accum) = 0.914
 T(global opt: hdiag) = 4.923e+00 S  per = 18.5  per(accum) = 19.4
 T(global opt: dvdsn) = 9.544e+00 S  per = 35.9  per(accum) = 55.4
 T(global opt: decim) = 2.521e-02 S  per = 0.0949  per(accum) = 55.5
 T(global opt: guess) = 1.588e-02 S  per = 0.0598  per(accum) = 55.5
 T(global opt: renrm) = 1.182e+01 S  per = 44.5  per(accum) = 100
 T(global opt: save ) = 4.553e-03 S  per = 0.0171  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.544e+00 S  T(sum) = 9.534e+00 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 7.529e-02 S  per = 0.79  per(accum) = 0.79
 T(global opt: symbolic_formulae           ) = 6.714e-02 S  per = 0.704  per(accum) = 1.49
 T(global opt: hintermediate init          ) = 3.839e-03 S  per = 0.0403  per(accum) = 1.53
 T(global opt: preprocess_hformulae_Hxlist ) = 2.123e+00 S  per = 22.3  per(accum) = 23.8
 T(global opt: hmmtasks init               ) = 8.605e-01 S  per = 9.03  per(accum) = 32.8
 T(global opt: initial guess for dvdson    ) = 2.172e-02 S  per = 0.228  per(accum) = 33.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.225e+00 S  per = 54.8  per(accum) = 87.9
 T(global opt: dvdson [cpu-gpu]            ) = 2.269e-01 S  per = 2.38  per(accum) = 90.2
 T(global opt: dvdson [nccl]               ) = 9.192e-01 S  per = 9.64  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 1.063e-04 S  per = 0.00111  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.100e-02 S  per = 0.115  per(accum) = 100
Detailed decomposition of T(renrm) = 1.182e+01 S  T(sum) = 1.182e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.734e-03 S  per = 0.0485  per(accum) = 0.0485
 T(global opt: qops init                    ) = 4.370e-02 S  per = 0.37  per(accum) = 0.418
 T(global opt: symbolic_formulae_renorm     ) = 2.110e-02 S  per = 0.179  per(accum) = 0.597
 T(global opt: allocate qops on gpu         ) = 1.356e-03 S  per = 0.0115  per(accum) = 0.608
 T(global opt: site memcpy cpu2gpu          ) = 2.724e-02 S  per = 0.231  per(accum) = 0.839
 T(global opt: rintermediate init           ) = 4.536e-02 S  per = 0.384  per(accum) = 1.22
 T(global opt: preprocess_formulae_Rlist2   ) = 2.806e-01 S  per = 2.37  per(accum) = 3.6
 T(global opt: rmmtasks init                ) = 1.418e-01 S  per =  1.2  per(accum) = 4.8
 T(global opt: qops memset on cpu           ) = 7.340e-07 S  per = 6.21e-06  per(accum) = 4.8
 T(global opt: preprocess_renorm_batchGPU   ) = 7.947e-01 S  per = 6.73  per(accum) = 11.5
 T(global opt: deallocate cpu and gpu memory) = 1.290e-03 S  per = 0.0109  per(accum) = 11.5
 T(global opt: construct opS [ifdists=true] ) = 1.026e+01 S  per = 86.8  per(accum) = 98.4
 T(global opt: reduction of opS & opH [nccl]) = 4.826e-02 S  per = 0.408  per(accum) = 98.8
 T(global opt: qops memcpy gpu2cpu          ) = 1.912e-03 S  per = 0.0162  per(accum) = 98.8
 T(global opt: reduction of opS & opH [mpi] ) = 1.268e-03 S  per = 0.0107  per(accum) = 98.8
 T(global opt: qops_pool join and erase     ) = 4.056e-02 S  per = 0.343  per(accum) = 99.1
 T(global opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 0.869  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-1.995e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=21/seqsize=34 dots=2 dbond=(13,0)-(14,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=552:4.211e-03MB:4.113e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=48:3.662e-04MB:3.576e-07GB
total mem of comb=601:4.585e-03MB:4.478e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=13,5,1,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 11 12 13 14 15
 suppc1= 9
 suppc2= 10
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(13,0)
 fqop[3]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:13 S:4 P:23 Q:28 
        dim(bra,ket)=8,8 size(op)=24:1.831e-04MB size(tot)=940:7.172e-03MB:7.004e-06GB
        per(mem): H:1.7 C:22.1 S:6.81 P:9.79 Q:59.6 
 rqops: oplist=HCSAB nops=H:1 C:5 S:7 A:12 B:16 
        dim(bra,ket)=10,10 size(op)=34:0.000259MB size(tot)=791:0.00603MB:5.89e-06GB
        per(mem): H:2.53 C:13.9 S:19.5 A:9.48 B:54.6 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3727:0.0284MB:2.78e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.046e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(14,0) fdel=./scratch/sweep/lop(13,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-7.212e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(8,10,3,3) nnz=104:7.935e-04MB
qtensor4: wf4 own=1 _data=0x3b3cd180
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=8
 (19,3):2 (21,3):2 (20,2):2 (20,4):2
 qbond: qcol nsym=6 dimAll=10
 (7,3):3 (6,2):2 (6,4):2 (5,3):1 (7,1):1 (8,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=28 nblocks=384 size=104:7.935e-04MB
### DIAG TIMING: total=2.482e-01 t1=2.788e-05, t2=1.204e-03, t3=2.476e-03, t4=2.420e-01, t5=4.296e-06, t6=2.500e-03, t7=4.679e-06
duration_diagGPU:2.482e-01
duration_diagreduce:6.700e-08
duration_diagtransform:7.300e-07
----- TIMING FOR symbolic_formulae_twodot with size=255 : 3.550e-03 S -----
rank=0 GPUmem(GB): used=2.777e-05 (oper)=2.777e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=255
 no. of hintermediate operators=131
 no. of coefficients=1619:1.235e-02MB:1.206e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.489e-04 S -----
rank=0 GPUmem(GB): used=3.983e-05 (oper,hinter)=2.777e-05,1.206e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.503e-01 S size(H_formulae)=255 size(Hxlst2)=28 T(Hmu/Hxlist)=6.627e-04,1.497e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.520e-01 S size(H_formulae)=255 size(Hxlst)=9156 -----
rank=0 GPUmem(GB): used=3.983e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=1.550e-06 batch[need]=1.501e-03 blksize=6 blksize0=9 batchsize=9156
rank=0 GPUmem(GB): used=1.542e-03 (oper,hinter,dvdson,batch)=2.777e-05,1.206e-05,1.550e-06,1.501e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=104 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.138e-02,7.509e-03,2.990e-02,1.031e-02,5.911e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=1.836e-03 speed=8.439e-04GB/S T(nccl)=9.544e-03 speed=1.624e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=115 t=7.5e-03 per=1.6e+01 cost=4.3e+05 flops=5.8e+07
 sigma[gemm] counter=115 i=0 t=1.6e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=1 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=3 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=4 t=7.4e-03 per=1.6e+01 cost=6.6e+04 flops=8.9e+06
 sigma[gemm] counter=115 i=5 t=7.5e-03 per=1.6e+01 cost=6.6e+04 flops=8.8e+06
 sigma[gemm] counter=115 i=6 t=7.4e-03 per=1.6e+01 cost=5.4e+04 flops=7.2e+06
 sigma[gemm] counter=115 i=7 t=7.5e-03 per=1.6e+01 cost=5.6e+04 flops=7.4e+06
 sigma[gemm] counter=115 total t=3.0e-02 per=6.3e+01 cost=2.4e+05 flops=8.1e+06
 sigma[red] counter=115 t=1.0e-02 per=2.2e+01 cost=7.0e+04 flops=6.8e+06
----- TIMING FOR sigma_tot : t_inter=7.7e-01 t_gemm=3.1e+00 t_reduction=1.4e+00 tot=5.3e+00 -----
 sigma_tot[inter] counter=115 t=7.7e-01 per=1.5e+01 cost=1.8e+07 flops=2.3e+07
 sigma_tot[gemm] counter=115 i=0 t=1.5e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=1 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=2 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=3 t=1.3e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=4 t=7.9e-01 per=1.5e+01 cost=1.9e+06 flops=2.4e+06
 sigma_tot[gemm] counter=115 i=5 t=7.9e-01 per=1.5e+01 cost=1.9e+06 flops=2.4e+06
 sigma_tot[gemm] counter=115 i=6 t=7.7e-01 per=1.5e+01 cost=2.2e+06 flops=2.8e+06
 sigma_tot[gemm] counter=115 i=7 t=7.7e-01 per=1.5e+01 cost=2.2e+06 flops=2.9e+06
 sigma_tot[gemm] counter=115 total t=3.1e+00 per=6.0e+01 cost=8.1e+06 flops=2.6e+06
 sigma_tot[red] counter=115 t=1.4e+00 per=2.6e+01 cost=3.1e+06 flops=2.3e+06
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=6.3e-06,8.4e-06,2.2e-06,1.4e-06,2.2e-07
settings: ndim=104 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.255197936571 -1.116e+03  2.786e-02    1     1  5.932e-02 5.932e-02 5.927e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.008e-03,7.520e-03,3.000e-02,1.020e-02,5.674e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.159e-03 speed=7.177e-04GB/S T(nccl)=6.849e-03 speed=2.263e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=116 t=7.5e-03 per=1.6e+01 cost=4.3e+05 flops=5.8e+07
 sigma[gemm] counter=116 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=3 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=4 t=7.5e-03 per=1.6e+01 cost=6.6e+04 flops=8.8e+06
 sigma[gemm] counter=116 i=5 t=7.6e-03 per=1.6e+01 cost=6.6e+04 flops=8.7e+06
 sigma[gemm] counter=116 i=6 t=7.5e-03 per=1.6e+01 cost=5.4e+04 flops=7.2e+06
 sigma[gemm] counter=116 i=7 t=7.4e-03 per=1.6e+01 cost=5.6e+04 flops=7.5e+06
 sigma[gemm] counter=116 total t=3.0e-02 per=6.3e+01 cost=2.4e+05 flops=8.0e+06
 sigma[red] counter=116 t=1.0e-02 per=2.1e+01 cost=7.0e+04 flops=6.8e+06
----- TIMING FOR sigma_tot : t_inter=7.8e-01 t_gemm=3.2e+00 t_reduction=1.4e+00 tot=5.3e+00 -----
 sigma_tot[inter] counter=116 t=7.8e-01 per=1.5e+01 cost=1.9e+07 flops=2.4e+07
 sigma_tot[gemm] counter=116 i=0 t=1.6e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=1 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=2 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=3 t=1.3e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=4 t=8.0e-01 per=1.5e+01 cost=1.9e+06 flops=2.4e+06
 sigma_tot[gemm] counter=116 i=5 t=8.0e-01 per=1.5e+01 cost=1.9e+06 flops=2.4e+06
 sigma_tot[gemm] counter=116 i=6 t=7.8e-01 per=1.5e+01 cost=2.2e+06 flops=2.9e+06
 sigma_tot[gemm] counter=116 i=7 t=7.8e-01 per=1.5e+01 cost=2.3e+06 flops=2.9e+06
 sigma_tot[gemm] counter=116 total t=3.2e+00 per=6.0e+01 cost=8.4e+06 flops=2.7e+06
 sigma_tot[red] counter=116 t=1.4e+00 per=2.6e+01 cost=3.1e+06 flops=2.3e+06
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=7.2e-06,3.5e-05,3.8e-06,1.8e-06,1.9e-07
    2   0 -    -116.257610226041 -2.412e-03  1.152e-02    2     2  1.165e-01 5.824e-02 5.812e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.161e-02,7.410e-03,2.977e-02,1.046e-02,5.926e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.072e-03 speed=7.478e-04GB/S T(nccl)=9.538e-03 speed=1.625e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=117 t=7.4e-03 per=1.6e+01 cost=4.3e+05 flops=5.9e+07
 sigma[gemm] counter=117 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=3 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=4 t=7.4e-03 per=1.6e+01 cost=6.6e+04 flops=8.9e+06
 sigma[gemm] counter=117 i=5 t=7.5e-03 per=1.6e+01 cost=6.6e+04 flops=8.8e+06
 sigma[gemm] counter=117 i=6 t=7.4e-03 per=1.6e+01 cost=5.4e+04 flops=7.2e+06
 sigma[gemm] counter=117 i=7 t=7.5e-03 per=1.6e+01 cost=5.6e+04 flops=7.5e+06
 sigma[gemm] counter=117 total t=3.0e-02 per=6.2e+01 cost=2.4e+05 flops=8.1e+06
 sigma[red] counter=117 t=1.0e-02 per=2.2e+01 cost=7.0e+04 flops=6.7e+06
----- TIMING FOR sigma_tot : t_inter=7.9e-01 t_gemm=3.2e+00 t_reduction=1.4e+00 tot=5.3e+00 -----
 sigma_tot[inter] counter=117 t=7.9e-01 per=1.5e+01 cost=1.9e+07 flops=2.4e+07
 sigma_tot[gemm] counter=117 i=0 t=1.6e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=1 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=2 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=3 t=1.3e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=4 t=8.1e-01 per=1.5e+01 cost=2.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=117 i=5 t=8.1e-01 per=1.5e+01 cost=2.0e+06 flops=2.5e+06
 sigma_tot[gemm] counter=117 i=6 t=7.9e-01 per=1.5e+01 cost=2.3e+06 flops=2.9e+06
 sigma_tot[gemm] counter=117 i=7 t=7.8e-01 per=1.5e+01 cost=2.3e+06 flops=3.0e+06
 sigma_tot[gemm] counter=117 total t=3.2e+00 per=6.0e+01 cost=8.6e+06 flops=2.7e+06
 sigma_tot[red] counter=117 t=1.4e+00 per=2.6e+01 cost=3.2e+06 flops=2.3e+06
T(sub)=4.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,2.1e-05,3.2e-06,1.1e-05,2.4e-07
    3   0 -    -116.257880864156 -2.706e-04  4.702e-03    3     3  1.761e-01 5.869e-02 5.858e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.170e-03,7.474e-03,2.991e-02,1.024e-02,5.480e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.202e-03 speed=7.037e-04GB/S T(nccl)=4.967e-03 speed=3.120e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=118 t=7.5e-03 per=1.6e+01 cost=4.3e+05 flops=5.8e+07
 sigma[gemm] counter=118 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=3 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=4 t=7.5e-03 per=1.6e+01 cost=6.6e+04 flops=8.8e+06
 sigma[gemm] counter=118 i=5 t=7.6e-03 per=1.6e+01 cost=6.6e+04 flops=8.6e+06
 sigma[gemm] counter=118 i=6 t=7.4e-03 per=1.6e+01 cost=5.4e+04 flops=7.3e+06
 sigma[gemm] counter=118 i=7 t=7.4e-03 per=1.6e+01 cost=5.6e+04 flops=7.6e+06
 sigma[gemm] counter=118 total t=3.0e-02 per=6.3e+01 cost=2.4e+05 flops=8.1e+06
 sigma[red] counter=118 t=1.0e-02 per=2.1e+01 cost=7.0e+04 flops=6.8e+06
----- TIMING FOR sigma_tot : t_inter=8.0e-01 t_gemm=3.2e+00 t_reduction=1.4e+00 tot=5.4e+00 -----
 sigma_tot[inter] counter=118 t=8.0e-01 per=1.5e+01 cost=1.9e+07 flops=2.4e+07
 sigma_tot[gemm] counter=118 i=0 t=1.6e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=1 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=2 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=3 t=1.4e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=4 t=8.1e-01 per=1.5e+01 cost=2.1e+06 flops=2.5e+06
 sigma_tot[gemm] counter=118 i=5 t=8.2e-01 per=1.5e+01 cost=2.1e+06 flops=2.5e+06
 sigma_tot[gemm] counter=118 i=6 t=7.9e-01 per=1.5e+01 cost=2.3e+06 flops=3.0e+06
 sigma_tot[gemm] counter=118 i=7 t=7.9e-01 per=1.5e+01 cost=2.4e+06 flops=3.0e+06
 sigma_tot[gemm] counter=118 total t=3.2e+00 per=6.0e+01 cost=8.9e+06 flops=2.8e+06
 sigma_tot[red] counter=118 t=1.4e+00 per=2.6e+01 cost=3.3e+06 flops=2.4e+06
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.7e-05,3.2e-06,1.2e-06,2.0e-07
    4   0 -    -116.257944036227 -6.317e-05  1.631e-03    3     4  2.312e-01 5.780e-02 5.769e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.068e-03,7.589e-03,3.033e-02,1.035e-02,5.634e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.170e-03 speed=7.143e-04GB/S T(nccl)=5.899e-03 speed=2.627e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=119 t=7.6e-03 per=1.6e+01 cost=4.3e+05 flops=5.7e+07
 sigma[gemm] counter=119 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=1 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=4 t=7.6e-03 per=1.6e+01 cost=6.6e+04 flops=8.6e+06
 sigma[gemm] counter=119 i=5 t=7.5e-03 per=1.6e+01 cost=6.6e+04 flops=8.7e+06
 sigma[gemm] counter=119 i=6 t=7.6e-03 per=1.6e+01 cost=5.4e+04 flops=7.1e+06
 sigma[gemm] counter=119 i=7 t=7.6e-03 per=1.6e+01 cost=5.6e+04 flops=7.4e+06
 sigma[gemm] counter=119 total t=3.0e-02 per=6.3e+01 cost=2.4e+05 flops=8.0e+06
 sigma[red] counter=119 t=1.0e-02 per=2.1e+01 cost=7.0e+04 flops=6.7e+06
----- TIMING FOR sigma_tot : t_inter=8.0e-01 t_gemm=3.2e+00 t_reduction=1.4e+00 tot=5.4e+00 -----
 sigma_tot[inter] counter=119 t=8.0e-01 per=1.5e+01 cost=2.0e+07 flops=2.5e+07
 sigma_tot[gemm] counter=119 i=0 t=1.6e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=1 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=2 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=3 t=1.4e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=4 t=8.2e-01 per=1.5e+01 cost=2.1e+06 flops=2.6e+06
 sigma_tot[gemm] counter=119 i=5 t=8.2e-01 per=1.5e+01 cost=2.1e+06 flops=2.6e+06
 sigma_tot[gemm] counter=119 i=6 t=8.0e-01 per=1.5e+01 cost=2.4e+06 flops=3.0e+06
 sigma_tot[gemm] counter=119 i=7 t=8.0e-01 per=1.5e+01 cost=2.4e+06 flops=3.0e+06
 sigma_tot[gemm] counter=119 total t=3.2e+00 per=6.0e+01 cost=9.1e+06 flops=2.8e+06
 sigma_tot[red] counter=119 t=1.4e+00 per=2.6e+01 cost=3.3e+06 flops=2.4e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.4e-05,3.2e-06,1.2e-06,2.3e-07
    5   0 -    -116.257950440731 -6.405e-06  7.230e-04    3     5  2.878e-01 5.756e-02 5.745e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.212e-03,7.511e-03,3.032e-02,1.049e-02,5.653e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.215e-03 speed=6.996e-04GB/S T(nccl)=5.997e-03 speed=2.584e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=120 t=7.5e-03 per=1.6e+01 cost=4.3e+05 flops=5.8e+07
 sigma[gemm] counter=120 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=4 t=7.5e-03 per=1.6e+01 cost=6.6e+04 flops=8.7e+06
 sigma[gemm] counter=120 i=5 t=7.7e-03 per=1.6e+01 cost=6.6e+04 flops=8.6e+06
 sigma[gemm] counter=120 i=6 t=7.6e-03 per=1.6e+01 cost=5.4e+04 flops=7.1e+06
 sigma[gemm] counter=120 i=7 t=7.6e-03 per=1.6e+01 cost=5.6e+04 flops=7.4e+06
 sigma[gemm] counter=120 total t=3.0e-02 per=6.3e+01 cost=2.4e+05 flops=8.0e+06
 sigma[red] counter=120 t=1.0e-02 per=2.2e+01 cost=7.0e+04 flops=6.7e+06
----- TIMING FOR sigma_tot : t_inter=8.1e-01 t_gemm=3.3e+00 t_reduction=1.4e+00 tot=5.5e+00 -----
 sigma_tot[inter] counter=120 t=8.1e-01 per=1.5e+01 cost=2.0e+07 flops=2.5e+07
 sigma_tot[gemm] counter=120 i=0 t=1.6e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=1 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=2 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=3 t=1.4e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=4 t=8.3e-01 per=1.5e+01 cost=2.2e+06 flops=2.7e+06
 sigma_tot[gemm] counter=120 i=5 t=8.3e-01 per=1.5e+01 cost=2.2e+06 flops=2.7e+06
 sigma_tot[gemm] counter=120 i=6 t=8.1e-01 per=1.5e+01 cost=2.5e+06 flops=3.0e+06
 sigma_tot[gemm] counter=120 i=7 t=8.1e-01 per=1.5e+01 cost=2.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=120 total t=3.3e+00 per=6.0e+01 cost=9.3e+06 flops=2.9e+06
 sigma_tot[red] counter=120 t=1.4e+00 per=2.6e+01 cost=3.4e+06 flops=2.4e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.3e-05,3.2e-06,1.2e-06,2.1e-07
    6   0 -    -116.257951998557 -1.558e-06  3.409e-04    3     6  3.446e-01 5.744e-02 5.733e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.599e-03,7.638e-03,2.997e-02,1.039e-02,5.661e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.195e-03 speed=7.062e-04GB/S T(nccl)=6.405e-03 speed=2.420e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=121 t=7.6e-03 per=1.6e+01 cost=4.3e+05 flops=5.7e+07
 sigma[gemm] counter=121 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=4 t=7.6e-03 per=1.6e+01 cost=6.6e+04 flops=8.7e+06
 sigma[gemm] counter=121 i=5 t=7.5e-03 per=1.6e+01 cost=6.6e+04 flops=8.7e+06
 sigma[gemm] counter=121 i=6 t=7.4e-03 per=1.5e+01 cost=5.4e+04 flops=7.2e+06
 sigma[gemm] counter=121 i=7 t=7.4e-03 per=1.5e+01 cost=5.6e+04 flops=7.5e+06
 sigma[gemm] counter=121 total t=3.0e-02 per=6.2e+01 cost=2.4e+05 flops=8.0e+06
 sigma[red] counter=121 t=1.0e-02 per=2.2e+01 cost=7.0e+04 flops=6.7e+06
----- TIMING FOR sigma_tot : t_inter=8.2e-01 t_gemm=3.3e+00 t_reduction=1.4e+00 tot=5.5e+00 -----
 sigma_tot[inter] counter=121 t=8.2e-01 per=1.5e+01 cost=2.1e+07 flops=2.5e+07
 sigma_tot[gemm] counter=121 i=0 t=1.6e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=1 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=2 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=3 t=1.4e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=4 t=8.4e-01 per=1.5e+01 cost=2.3e+06 flops=2.7e+06
 sigma_tot[gemm] counter=121 i=5 t=8.4e-01 per=1.5e+01 cost=2.3e+06 flops=2.7e+06
 sigma_tot[gemm] counter=121 i=6 t=8.2e-01 per=1.5e+01 cost=2.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=121 i=7 t=8.1e-01 per=1.5e+01 cost=2.5e+06 flops=3.1e+06
 sigma_tot[gemm] counter=121 total t=3.3e+00 per=6.0e+01 cost=9.6e+06 flops=2.9e+06
 sigma_tot[red] counter=121 t=1.4e+00 per=2.6e+01 cost=3.5e+06 flops=2.5e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.3e-05,3.0e-06,1.2e-06,2.1e-07
    7   0 -    -116.257952393951 -3.954e-07  2.265e-04    3     7  4.015e-01 5.736e-02 5.726e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.267e-03,7.635e-03,3.024e-02,1.054e-02,5.670e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.263e-03 speed=6.849e-04GB/S T(nccl)=6.004e-03 speed=2.581e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=122 t=7.6e-03 per=1.6e+01 cost=4.3e+05 flops=5.7e+07
 sigma[gemm] counter=122 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=3 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=4 t=7.6e-03 per=1.6e+01 cost=6.6e+04 flops=8.7e+06
 sigma[gemm] counter=122 i=5 t=7.6e-03 per=1.6e+01 cost=6.6e+04 flops=8.7e+06
 sigma[gemm] counter=122 i=6 t=7.6e-03 per=1.6e+01 cost=5.4e+04 flops=7.1e+06
 sigma[gemm] counter=122 i=7 t=7.5e-03 per=1.5e+01 cost=5.6e+04 flops=7.5e+06
 sigma[gemm] counter=122 total t=3.0e-02 per=6.2e+01 cost=2.4e+05 flops=8.0e+06
 sigma[red] counter=122 t=1.1e-02 per=2.2e+01 cost=7.0e+04 flops=6.6e+06
----- TIMING FOR sigma_tot : t_inter=8.3e-01 t_gemm=3.3e+00 t_reduction=1.4e+00 tot=5.6e+00 -----
 sigma_tot[inter] counter=122 t=8.3e-01 per=1.5e+01 cost=2.1e+07 flops=2.6e+07
 sigma_tot[gemm] counter=122 i=0 t=1.6e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=1 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=2 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=3 t=1.4e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=4 t=8.4e-01 per=1.5e+01 cost=2.3e+06 flops=2.8e+06
 sigma_tot[gemm] counter=122 i=5 t=8.5e-01 per=1.5e+01 cost=2.3e+06 flops=2.8e+06
 sigma_tot[gemm] counter=122 i=6 t=8.2e-01 per=1.5e+01 cost=2.6e+06 flops=3.1e+06
 sigma_tot[gemm] counter=122 i=7 t=8.2e-01 per=1.5e+01 cost=2.6e+06 flops=3.2e+06
 sigma_tot[gemm] counter=122 total t=3.3e+00 per=6.0e+01 cost=9.8e+06 flops=2.9e+06
 sigma_tot[red] counter=122 t=1.4e+00 per=2.5e+01 cost=3.5e+06 flops=2.5e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.3e-05,3.2e-06,1.2e-06,2.2e-07
    8   0 -    -116.257952575644 -1.817e-07  1.399e-04    3     8  4.584e-01 5.730e-02 5.721e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.837e-02,7.497e-03,2.895e-02,1.929e-03,5.675e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.278e-03 speed=6.802e-04GB/S T(nccl)=1.609e-02 speed=9.632e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=2.9e-02 t_reduction=1.9e-03 tot=3.8e-02 -----
 sigma[inter] counter=123 t=7.5e-03 per=2.0e+01 cost=4.3e+05 flops=5.8e+07
 sigma[gemm] counter=123 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=1 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=2 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=3 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=4 t=7.5e-03 per=1.9e+01 cost=6.6e+04 flops=8.8e+06
 sigma[gemm] counter=123 i=5 t=7.6e-03 per=2.0e+01 cost=6.6e+04 flops=8.7e+06
 sigma[gemm] counter=123 i=6 t=7.6e-03 per=2.0e+01 cost=5.4e+04 flops=7.0e+06
 sigma[gemm] counter=123 i=7 t=6.3e-03 per=1.6e+01 cost=5.6e+04 flops=8.9e+06
 sigma[gemm] counter=123 total t=2.9e-02 per=7.5e+01 cost=2.4e+05 flops=8.3e+06
 sigma[red] counter=123 t=1.9e-03 per=5.0e+00 cost=7.0e+04 flops=3.6e+07
----- TIMING FOR sigma_tot : t_inter=8.4e-01 t_gemm=3.4e+00 t_reduction=1.4e+00 tot=5.6e+00 -----
 sigma_tot[inter] counter=123 t=8.4e-01 per=1.5e+01 cost=2.2e+07 flops=2.6e+07
 sigma_tot[gemm] counter=123 i=0 t=1.6e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=1 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=2 t=1.4e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=3 t=1.4e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=4 t=8.5e-01 per=1.5e+01 cost=2.4e+06 flops=2.8e+06
 sigma_tot[gemm] counter=123 i=5 t=8.5e-01 per=1.5e+01 cost=2.4e+06 flops=2.8e+06
 sigma_tot[gemm] counter=123 i=6 t=8.3e-01 per=1.5e+01 cost=2.6e+06 flops=3.1e+06
 sigma_tot[gemm] counter=123 i=7 t=8.3e-01 per=1.5e+01 cost=2.6e+06 flops=3.2e+06
 sigma_tot[gemm] counter=123 total t=3.4e+00 per=6.0e+01 cost=1.0e+07 flops=3.0e+06
 sigma_tot[red] counter=123 t=1.4e+00 per=2.5e+01 cost=3.6e+06 flops=2.5e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.3e-05,3.1e-06,1.2e-06,2.3e-07
    9   0 +    -116.257952651408 -7.576e-08  9.680e-05    3     9  5.155e-01 5.727e-02 5.718e-02
TIMING FOR Davidson : 5.155e-01  T(cal/comm/rest)=5.146e-01,7.362e-06,8.314e-04
decomposed t_rest=8.314e-04
 T(sub)    =2.428e-04 per=2.920e+01
 T(precond)=7.271e-05 per=8.746e+00
 T(ortho)  =2.057e-05 per=2.475e+00
 T(xcopy)  =1.129e-06 per=1.358e-01
 T(xnrm2)  =4.368e-06 per=5.254e-01
 T(other)  =4.898e-04 per=5.892e+01
optimized energies: isweep=0 ibond=21 dots=2 e[0]=-116.257952651408 nmvp=9
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=1.266e-03 change=2.453e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond21.txt
 qbond: qsuper nsym=12 dimAll=40
 (7,3):8 (6,2):3 (6,4):3 (5,3):1 (7,1):3 (8,2):7 (9,3):4 (8,4):5 (9,1):2 (10,2):1 (7,5):2 (8,0):1
timing for divide=9.0e-05
timing for compute=1.1e-04
timing for collect=1.9e-05
----- TMING FOR decimation_genbasis(su2): 2.2e-04 S T(divide/compute[cpu/gpu/rest]/collect)=9.0e-05,1.0e-04,0.0e+00,8.1e-06,1.9e-05 -----
decimation summary: 40->10 dwt=+1.275e-04 SvN=3.877e-01
 qbond: qkept nsym=6 dimAll=10
 (9,3):3 (8,2):2 (8,4):2 (7,3):1 (9,1):1 (10,2):1
----- TIMING for decimation_row(nkr): 6.346e-04 S T(decim/select/formRot)=2.835e-04,2.482e-04,1.030e-04 -----
----- TIMING FOR twodot_decimation: 1.607e-03 S T(wf/decim)=8.501e-04,7.567e-04 -----
ctns::oper_renorm coord=(14,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:6 S:7 A:17 B:22 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=1006:7.675e-03MB:7.495e-06GB
        per(mem): H:1.99 C:13.1 S:15.3 A:10.5 B:59 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=1.266e-03 change=1.503e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=46 : 4.058e-04 S -----
rank=0 GPUmem(GB): used=4.032e-05 (oper)=2.082e-05
rank=0 GPUmem(GB): used=4.067e-05 (oper,site)=2.082e-05,3.502e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=46
 no. of rintermediate operators=5
 no. of coefficients=39:2.975e-04MB:2.906e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.507e-03 S -----
rank=0 GPUmem(GB): used=4.096e-05 (oper,site,rinter)=2.082e-05,3.502e-07,2.906e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 9.451e-03 S size(rtasks)=46 size(Rlst2)=36 T(Rmu/Rlist)=1.235e-04,9.327e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.540e-03 S size(rtasks)=46 size(Rlst)=845 -----
rank=0 GPUmem(GB): used=4.096e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.763e-04 blksize=9 blksize0=9 batchsize=845
rank=0 GPUmem(GB): used=2.172e-04 (oper,site,rinter,batch)=2.082e-05,3.502e-07,2.906e-07,1.763e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.676e-03,2.226e-02,9.958e-03
----- TIMING FOR renorm : t_inter=6.7e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=256 t=6.7e-03 per=1.7e+01 cost=6.0e+03 flops=9.0e+05
 renorm[gemm] counter=256 i=0 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=256 i=1 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=256 i=2 t=7.4e-03 per=1.9e+01 cost=2.2e+03 flops=3.0e+05
 renorm[gemm] counter=256 i=3 t=7.5e-03 per=1.9e+01 cost=7.8e+03 flops=1.0e+06
 renorm[gemm] counter=256 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=256 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=256 i=6 t=7.4e-03 per=1.9e+01 cost=1.0e+04 flops=1.4e+06
 renorm[gemm] counter=256 total t=2.2e-02 per=5.7e+01 cost=2.0e+04 flops=9.1e+05
 renorm[red] counter=256 t=1.0e-02 per=2.6e+01 cost=5.3e+03 flops=5.3e+05
----- TIMING FOR renorm_tot : t_inter=1.4e-01 t_gemm=4.8e-01 t_reduction=2.1e-01 tot=8.3e-01 -----
 renorm_tot[inter] counter=256 t=1.4e-01 per=1.6e+01 cost=4.2e+05 flops=3.1e+06
 renorm_tot[gemm] counter=256 i=0 t=3.0e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=256 i=1 t=2.5e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=256 i=2 t=3.7e-02 per=4.5e+00 cost=6.7e+03 flops=1.8e+05
 renorm_tot[gemm] counter=256 i=3 t=3.2e-02 per=3.8e+00 cost=1.9e+04 flops=6.1e+05
 renorm_tot[gemm] counter=256 i=4 t=1.3e-01 per=1.5e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=256 i=5 t=1.3e-01 per=1.5e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=256 i=6 t=1.6e-01 per=1.9e+01 cost=2.6e+05 flops=1.6e+06
 renorm_tot[gemm] counter=256 total t=4.8e-01 per=5.8e+01 cost=4.8e+05 flops=9.9e+05
 renorm_tot[red] counter=256 t=2.1e-01 per=2.6e+01 cost=1.5e+05 flops=7.1e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.615e-05 (optmp,oper)=1.639e-07,2.082e-05
rank=0 GPUmem(GB): used=4.650e-05 (optmp,oper,site,rinter)=1.639e-07,2.082e-05,3.502e-07,5.372e-06
rank=0 GPUmem(GB): used=7.299e-05 (optmp,oper,site,rinter,batch)=1.639e-07,2.082e-05,3.502e-07,5.372e-06,2.649e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 6.733e-01 S T(prep/alloc/comp/red/dealloc)=3.339e-02,4.116e-02,5.459e-01,8.366e-02,2.539e-03 -----
----- TIMING FOR oper_renorm_opS : 6.735e-01 S rank=0 -----
qops.to_cpu: size(tot)=1006:7.675e-03MB:7.495e-06GB T(to_cpu)=8.422e-05S speed=8.899e-02GB/S
check ||H-H.dagger||=4.994e-15 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.736 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=2.869e-03 change=2.616e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.869e-03 change=-1.226e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=2.869e-03 change=-4.813e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.749e+00 S #####
 T(local opt: fetch) = 1.120e-02 S  per = 0.64  per(accum) = 0.64
 T(local opt: hdiag) = 2.491e-01 S  per = 14.2  per(accum) = 14.9
 T(local opt: dvdsn) = 7.476e-01 S  per = 42.7  per(accum) = 57.6
 T(local opt: decim) = 1.744e-03 S  per = 0.0997  per(accum) = 57.7
 T(local opt: guess) = 1.094e-03 S  per = 0.0626  per(accum) = 57.8
 T(local opt: renrm) = 7.383e-01 S  per = 42.2  per(accum) = 100
 T(local opt: save ) = 2.409e-04 S  per = 0.0138  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.476e-01 S  T(sum) = 7.471e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 6.000e-03 S  per = 0.803  per(accum) = 0.803
 T(local opt: symbolic_formulae           ) = 3.566e-03 S  per = 0.477  per(accum) = 1.28
 T(local opt: hintermediate init          ) = 1.856e-04 S  per = 0.0248  per(accum) = 1.31
 T(local opt: preprocess_hformulae_Hxlist ) = 1.524e-01 S  per = 20.4  per(accum) = 21.7
 T(local opt: hmmtasks init               ) = 6.777e-02 S  per = 9.07  per(accum) = 30.8
 T(local opt: initial guess for dvdson    ) = 1.677e-03 S  per = 0.225  per(accum) = 31
 T(local opt: dvdson [Hx_batchGPU]        ) = 4.240e-01 S  per = 56.7  per(accum) = 87.7
 T(local opt: dvdson [cpu-gpu]            ) = 1.939e-02 S  per =  2.6  per(accum) = 90.3
 T(local opt: dvdson [nccl]               ) = 7.129e-02 S  per = 9.54  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 7.362e-06 S  per = 0.000985  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 8.314e-04 S  per = 0.111  per(accum) = 100
Detailed decomposition of T(renrm) = 7.383e-01 S  T(sum) = 7.383e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.312e-04 S  per = 0.0449  per(accum) = 0.0449
 T(local opt: qops init                    ) = 2.258e-03 S  per = 0.306  per(accum) = 0.351
 T(local opt: symbolic_formulae_renorm     ) = 4.174e-04 S  per = 0.0565  per(accum) = 0.407
 T(local opt: allocate qops on gpu         ) = 7.802e-05 S  per = 0.0106  per(accum) = 0.418
 T(local opt: site memcpy cpu2gpu          ) = 1.821e-03 S  per = 0.247  per(accum) = 0.664
 T(local opt: rintermediate init           ) = 2.520e-03 S  per = 0.341  per(accum) = 1.01
 T(local opt: preprocess_formulae_Rlist2   ) = 9.572e-03 S  per =  1.3  per(accum) = 2.3
 T(local opt: rmmtasks init                ) = 4.100e-03 S  per = 0.555  per(accum) = 2.86
 T(local opt: qops memset on cpu           ) = 2.900e-08 S  per = 3.93e-06  per(accum) = 2.86
 T(local opt: preprocess_renorm_batchGPU   ) = 3.906e-02 S  per = 5.29  per(accum) = 8.15
 T(local opt: deallocate cpu and gpu memory) = 6.849e-05 S  per = 0.00928  per(accum) = 8.16
 T(local opt: construct opS [ifdists=true] ) = 6.735e-01 S  per = 91.2  per(accum) = 99.4
 T(local opt: reduction of opS & opH [nccl]) = 2.255e-03 S  per = 0.305  per(accum) = 99.7
 T(local opt: qops memcpy gpu2cpu          ) = 9.737e-05 S  per = 0.0132  per(accum) = 99.7
 T(local opt: reduction of opS & opH [mpi] ) = 6.922e-05 S  per = 0.00938  per(accum) = 99.7
 T(local opt: qops_pool join and erase     ) = 2.120e-03 S  per = 0.287  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 9.265e-06 S  per = 0.00125  per(accum) = 100
##### sweep opt: 2.832e+01 S #####
 T(sweep opt: fetch) = 2.541e-01 S  per = 0.897  per(accum) = 0.897
 T(sweep opt: hdiag) = 5.172e+00 S  per = 18.3  per(accum) = 19.2
 T(sweep opt: dvdsn) = 1.029e+01 S  per = 36.3  per(accum) = 55.5
 T(sweep opt: decim) = 2.695e-02 S  per = 0.0952  per(accum) = 55.6
 T(sweep opt: guess) = 1.698e-02 S  per = 0.06  per(accum) = 55.7
 T(sweep opt: renrm) = 1.255e+01 S  per = 44.3  per(accum) = 100
 T(sweep opt: save ) = 4.794e-03 S  per = 0.0169  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.029e+01 S  T(sum) = 1.028e+01 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 8.129e-02 S  per = 0.791  per(accum) = 0.791
 T(sweep opt: symbolic_formulae           ) = 7.071e-02 S  per = 0.688  per(accum) = 1.48
 T(sweep opt: hintermediate init          ) = 4.025e-03 S  per = 0.0392  per(accum) = 1.52
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.275e+00 S  per = 22.1  per(accum) = 23.6
 T(sweep opt: hmmtasks init               ) = 9.283e-01 S  per = 9.03  per(accum) = 32.7
 T(sweep opt: initial guess for dvdson    ) = 2.340e-02 S  per = 0.228  per(accum) = 32.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.649e+00 S  per = 54.9  per(accum) = 87.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.462e-01 S  per =  2.4  per(accum) = 90.2
 T(sweep opt: dvdson [nccl]               ) = 9.905e-01 S  per = 9.63  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 1.137e-04 S  per = 0.00111  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.183e-02 S  per = 0.115  per(accum) = 100
Detailed decomposition of T(renrm) = 1.255e+01 S  T(sum) = 1.255e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.066e-03 S  per = 0.0483  per(accum) = 0.0483
 T(sweep opt: qops init                    ) = 4.595e-02 S  per = 0.366  per(accum) = 0.414
 T(sweep opt: symbolic_formulae_renorm     ) = 2.151e-02 S  per = 0.171  per(accum) = 0.586
 T(sweep opt: allocate qops on gpu         ) = 1.434e-03 S  per = 0.0114  per(accum) = 0.597
 T(sweep opt: site memcpy cpu2gpu          ) = 2.906e-02 S  per = 0.231  per(accum) = 0.829
 T(sweep opt: rintermediate init           ) = 4.788e-02 S  per = 0.381  per(accum) = 1.21
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.901e-01 S  per = 2.31  per(accum) = 3.52
 T(sweep opt: rmmtasks init                ) = 1.459e-01 S  per = 1.16  per(accum) = 4.68
 T(sweep opt: qops memset on cpu           ) = 7.630e-07 S  per = 6.08e-06  per(accum) = 4.68
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.338e-01 S  per = 6.64  per(accum) = 11.3
 T(sweep opt: deallocate cpu and gpu memory) = 1.359e-03 S  per = 0.0108  per(accum) = 11.3
 T(sweep opt: construct opS [ifdists=true] ) = 1.093e+01 S  per = 87.1  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [nccl]) = 5.051e-02 S  per = 0.402  per(accum) = 98.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.009e-03 S  per = 0.016  per(accum) = 98.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.337e-03 S  per = 0.0107  per(accum) = 98.8
 T(sweep opt: qops_pool join and erase     ) = 4.268e-02 S  per = 0.34  per(accum) = 99.2
 T(sweep opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 0.818  per(accum) = 100
##### global opt: 2.832e+01 S #####
 T(global opt: fetch) = 2.541e-01 S  per = 0.897  per(accum) = 0.897
 T(global opt: hdiag) = 5.172e+00 S  per = 18.3  per(accum) = 19.2
 T(global opt: dvdsn) = 1.029e+01 S  per = 36.3  per(accum) = 55.5
 T(global opt: decim) = 2.695e-02 S  per = 0.0952  per(accum) = 55.6
 T(global opt: guess) = 1.698e-02 S  per = 0.06  per(accum) = 55.7
 T(global opt: renrm) = 1.255e+01 S  per = 44.3  per(accum) = 100
 T(global opt: save ) = 4.794e-03 S  per = 0.0169  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.029e+01 S  T(sum) = 1.028e+01 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 8.129e-02 S  per = 0.791  per(accum) = 0.791
 T(global opt: symbolic_formulae           ) = 7.071e-02 S  per = 0.688  per(accum) = 1.48
 T(global opt: hintermediate init          ) = 4.025e-03 S  per = 0.0392  per(accum) = 1.52
 T(global opt: preprocess_hformulae_Hxlist ) = 2.275e+00 S  per = 22.1  per(accum) = 23.6
 T(global opt: hmmtasks init               ) = 9.283e-01 S  per = 9.03  per(accum) = 32.7
 T(global opt: initial guess for dvdson    ) = 2.340e-02 S  per = 0.228  per(accum) = 32.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.649e+00 S  per = 54.9  per(accum) = 87.9
 T(global opt: dvdson [cpu-gpu]            ) = 2.462e-01 S  per =  2.4  per(accum) = 90.2
 T(global opt: dvdson [nccl]               ) = 9.905e-01 S  per = 9.63  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 1.137e-04 S  per = 0.00111  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.183e-02 S  per = 0.115  per(accum) = 100
Detailed decomposition of T(renrm) = 1.255e+01 S  T(sum) = 1.255e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.066e-03 S  per = 0.0483  per(accum) = 0.0483
 T(global opt: qops init                    ) = 4.595e-02 S  per = 0.366  per(accum) = 0.414
 T(global opt: symbolic_formulae_renorm     ) = 2.151e-02 S  per = 0.171  per(accum) = 0.586
 T(global opt: allocate qops on gpu         ) = 1.434e-03 S  per = 0.0114  per(accum) = 0.597
 T(global opt: site memcpy cpu2gpu          ) = 2.906e-02 S  per = 0.231  per(accum) = 0.829
 T(global opt: rintermediate init           ) = 4.788e-02 S  per = 0.381  per(accum) = 1.21
 T(global opt: preprocess_formulae_Rlist2   ) = 2.901e-01 S  per = 2.31  per(accum) = 3.52
 T(global opt: rmmtasks init                ) = 1.459e-01 S  per = 1.16  per(accum) = 4.68
 T(global opt: qops memset on cpu           ) = 7.630e-07 S  per = 6.08e-06  per(accum) = 4.68
 T(global opt: preprocess_renorm_batchGPU   ) = 8.338e-01 S  per = 6.64  per(accum) = 11.3
 T(global opt: deallocate cpu and gpu memory) = 1.359e-03 S  per = 0.0108  per(accum) = 11.3
 T(global opt: construct opS [ifdists=true] ) = 1.093e+01 S  per = 87.1  per(accum) = 98.4
 T(global opt: reduction of opS & opH [nccl]) = 5.051e-02 S  per = 0.402  per(accum) = 98.8
 T(global opt: qops memcpy gpu2cpu          ) = 2.009e-03 S  per = 0.016  per(accum) = 98.8
 T(global opt: reduction of opS & opH [mpi] ) = 1.337e-03 S  per = 0.0107  per(accum) = 98.8
 T(global opt: qops_pool join and erase     ) = 4.268e-02 S  per = 0.34  per(accum) = 99.2
 T(global opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 0.818  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-2.430e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=22/seqsize=34 dots=2 dbond=(12,0)-(13,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=563:4.295e-03MB:4.195e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=48:3.662e-04MB:3.576e-07GB
total mem of comb=612:4.669e-03MB:4.560e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=12,6,1,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc1= 8
 suppc2= 9
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(12,0)
 fqop[3]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:12 S:4 P:28 Q:40 
        dim(bra,ket)=8,8 size(op)=24:1.831e-04MB size(tot)=1184:9.033e-03MB:8.821e-06GB
        per(mem): H:1.35 C:16.2 S:5.41 P:9.46 Q:67.6 
 rqops: oplist=HCSAB nops=H:1 C:6 S:7 A:17 B:22 
        dim(bra,ket)=10,10 size(op)=34:0.000259MB size(tot)=1006:0.00768MB:7.5e-06GB
        per(mem): H:1.99 C:13.1 S:15.3 A:10.5 B:59 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4186:0.0319MB:3.12e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.295e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(13,0) fdel=./scratch/sweep/lop(12,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-9.120e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(8,10,3,3) nnz=104:7.935e-04MB
qtensor4: wf4 own=1 _data=0x3b3cd180
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=8
 (17,3):2 (19,3):2 (18,2):2 (18,4):2
 qbond: qcol nsym=6 dimAll=10
 (9,3):3 (8,2):2 (8,4):2 (7,3):1 (9,1):1 (10,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=28 nblocks=384 size=104:7.935e-04MB
### DIAG TIMING: total=3.591e-01 t1=2.629e-05, t2=1.166e-03, t3=2.518e-03, t4=3.529e-01, t5=3.424e-06, t6=2.564e-03, t7=4.823e-06
duration_diagGPU:3.592e-01
duration_diagreduce:6.700e-08
duration_diagtransform:6.510e-07
----- TIMING FOR symbolic_formulae_twodot with size=319 : 4.441e-03 S -----
rank=0 GPUmem(GB): used=3.119e-05 (oper)=3.119e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=319
 no. of hintermediate operators=166
 no. of coefficients=1975:1.507e-02MB:1.471e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.807e-04 S -----
rank=0 GPUmem(GB): used=4.590e-05 (oper,hinter)=3.119e-05,1.471e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.885e-01 S size(H_formulae)=319 size(Hxlst2)=28 T(Hmu/Hxlist)=8.341e-04,1.876e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.903e-01 S size(H_formulae)=319 size(Hxlst)=11532 -----
rank=0 GPUmem(GB): used=4.590e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=1.550e-06 batch[need]=1.890e-03 blksize=6 blksize0=9 batchsize=11532
rank=0 GPUmem(GB): used=1.938e-03 (oper,hinter,dvdson,batch)=3.119e-05,1.471e-05,1.550e-06,1.890e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=104 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.847e-02,1.144e-03,2.151e-02,1.039e-02,5.153e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=5.947e-04 speed=2.606e-03GB/S T(nccl)=1.787e-02 speed=8.670e-05GB/S
----- TIMING FOR sigma : t_inter=1.1e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.3e-02 -----
 sigma[inter] counter=124 t=1.1e-03 per=3.5e+00 cost=5.4e+05 flops=4.7e+08
 sigma[gemm] counter=124 i=0 t=1.6e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=1 t=1.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=2 t=1.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=3 t=1.2e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=4 t=8.1e-04 per=2.4e+00 cost=8.3e+04 flops=1.0e+08
 sigma[gemm] counter=124 i=5 t=5.6e-03 per=1.7e+01 cost=8.3e+04 flops=1.5e+07
 sigma[gemm] counter=124 i=6 t=7.6e-03 per=2.3e+01 cost=7.0e+04 flops=9.2e+06
 sigma[gemm] counter=124 i=7 t=7.5e-03 per=2.3e+01 cost=7.2e+04 flops=9.6e+06
 sigma[gemm] counter=124 total t=2.2e-02 per=6.5e+01 cost=3.1e+05 flops=1.4e+07
 sigma[red] counter=124 t=1.0e-02 per=3.1e+01 cost=8.8e+04 flops=8.4e+06
----- TIMING FOR sigma_tot : t_inter=8.4e-01 t_gemm=3.4e+00 t_reduction=1.4e+00 tot=5.7e+00 -----
 sigma_tot[inter] counter=124 t=8.4e-01 per=1.5e+01 cost=2.2e+07 flops=2.6e+07
 sigma_tot[gemm] counter=124 i=0 t=1.7e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=1 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=2 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=3 t=1.4e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=4 t=8.5e-01 per=1.5e+01 cost=2.5e+06 flops=2.9e+06
 sigma_tot[gemm] counter=124 i=5 t=8.6e-01 per=1.5e+01 cost=2.5e+06 flops=2.9e+06
 sigma_tot[gemm] counter=124 i=6 t=8.4e-01 per=1.5e+01 cost=2.7e+06 flops=3.2e+06
 sigma_tot[gemm] counter=124 i=7 t=8.3e-01 per=1.5e+01 cost=2.7e+06 flops=3.3e+06
 sigma_tot[gemm] counter=124 total t=3.4e+00 per=6.0e+01 cost=1.0e+07 flops=3.1e+06
 sigma_tot[red] counter=124 t=1.4e+00 per=2.5e+01 cost=3.7e+06 flops=2.6e+06
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,8.6e-06,2.3e-06,1.3e-06,2.1e-07
settings: ndim=104 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.257891623402 -1.116e+03  4.510e-02    1     1  5.183e-02 5.183e-02 5.178e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.084e-03,7.438e-03,2.962e-02,1.038e-02,5.653e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.097e-03 speed=7.392e-04GB/S T(nccl)=6.987e-03 speed=2.218e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.7e-02 -----
 sigma[inter] counter=125 t=7.4e-03 per=1.6e+01 cost=5.4e+05 flops=7.2e+07
 sigma[gemm] counter=125 i=0 t=1.3e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=1 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=3 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=4 t=7.5e-03 per=1.6e+01 cost=8.3e+04 flops=1.1e+07
 sigma[gemm] counter=125 i=5 t=7.4e-03 per=1.6e+01 cost=8.3e+04 flops=1.1e+07
 sigma[gemm] counter=125 i=6 t=7.4e-03 per=1.6e+01 cost=7.0e+04 flops=9.5e+06
 sigma[gemm] counter=125 i=7 t=7.3e-03 per=1.5e+01 cost=7.2e+04 flops=9.9e+06
 sigma[gemm] counter=125 total t=3.0e-02 per=6.2e+01 cost=3.1e+05 flops=1.0e+07
 sigma[red] counter=125 t=1.0e-02 per=2.2e+01 cost=8.8e+04 flops=8.5e+06
----- TIMING FOR sigma_tot : t_inter=8.4e-01 t_gemm=3.4e+00 t_reduction=1.4e+00 tot=5.7e+00 -----
 sigma_tot[inter] counter=125 t=8.4e-01 per=1.5e+01 cost=2.3e+07 flops=2.7e+07
 sigma_tot[gemm] counter=125 i=0 t=1.7e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=1 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=2 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=3 t=1.4e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=4 t=8.6e-01 per=1.5e+01 cost=2.6e+06 flops=3.0e+06
 sigma_tot[gemm] counter=125 i=5 t=8.7e-01 per=1.5e+01 cost=2.6e+06 flops=3.0e+06
 sigma_tot[gemm] counter=125 i=6 t=8.5e-01 per=1.5e+01 cost=2.8e+06 flops=3.3e+06
 sigma_tot[gemm] counter=125 i=7 t=8.4e-01 per=1.5e+01 cost=2.8e+06 flops=3.3e+06
 sigma_tot[gemm] counter=125 total t=3.4e+00 per=6.0e+01 cost=1.1e+07 flops=3.1e+06
 sigma_tot[red] counter=125 t=1.4e+00 per=2.5e+01 cost=3.8e+06 flops=2.6e+06
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=6.1e-06,2.4e-05,1.3e-05,1.7e-06,2.0e-07
    2   0 -    -116.263054791586 -5.163e-03  1.475e-02    2     2  1.087e-01 5.436e-02 5.425e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.094e-03,7.382e-03,2.982e-02,1.035e-02,5.665e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.151e-03 speed=7.205e-04GB/S T(nccl)=6.943e-03 speed=2.232e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=126 t=7.4e-03 per=1.6e+01 cost=5.4e+05 flops=7.3e+07
 sigma[gemm] counter=126 i=0 t=1.3e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=1 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=3 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=4 t=7.3e-03 per=1.5e+01 cost=8.3e+04 flops=1.1e+07
 sigma[gemm] counter=126 i=5 t=7.4e-03 per=1.6e+01 cost=8.3e+04 flops=1.1e+07
 sigma[gemm] counter=126 i=6 t=7.5e-03 per=1.6e+01 cost=7.0e+04 flops=9.3e+06
 sigma[gemm] counter=126 i=7 t=7.5e-03 per=1.6e+01 cost=7.2e+04 flops=9.7e+06
 sigma[gemm] counter=126 total t=3.0e-02 per=6.3e+01 cost=3.1e+05 flops=1.0e+07
 sigma[red] counter=126 t=1.0e-02 per=2.2e+01 cost=8.8e+04 flops=8.5e+06
----- TIMING FOR sigma_tot : t_inter=8.5e-01 t_gemm=3.4e+00 t_reduction=1.5e+00 tot=5.8e+00 -----
 sigma_tot[inter] counter=126 t=8.5e-01 per=1.5e+01 cost=2.3e+07 flops=2.7e+07
 sigma_tot[gemm] counter=126 i=0 t=1.7e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=1 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=2 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=3 t=1.4e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=4 t=8.7e-01 per=1.5e+01 cost=2.7e+06 flops=3.1e+06
 sigma_tot[gemm] counter=126 i=5 t=8.7e-01 per=1.5e+01 cost=2.7e+06 flops=3.0e+06
 sigma_tot[gemm] counter=126 i=6 t=8.5e-01 per=1.5e+01 cost=2.8e+06 flops=3.3e+06
 sigma_tot[gemm] counter=126 i=7 t=8.5e-01 per=1.5e+01 cost=2.9e+06 flops=3.4e+06
 sigma_tot[gemm] counter=126 total t=3.4e+00 per=6.0e+01 cost=1.1e+07 flops=3.2e+06
 sigma_tot[red] counter=126 t=1.5e+00 per=2.5e+01 cost=3.9e+06 flops=2.7e+06
T(sub)=3.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,2.7e-05,3.2e-06,1.6e-06,2.3e-07
    3   0 -    -116.263745767633 -6.910e-04  6.778e-03    3     3  1.657e-01 5.523e-02 5.512e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.011e-03,7.557e-03,3.003e-02,1.019e-02,5.679e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.226e-03 speed=6.963e-04GB/S T(nccl)=6.785e-03 speed=2.284e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=127 t=7.6e-03 per=1.6e+01 cost=5.4e+05 flops=7.1e+07
 sigma[gemm] counter=127 i=0 t=1.3e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=1 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=3 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=4 t=7.5e-03 per=1.6e+01 cost=8.3e+04 flops=1.1e+07
 sigma[gemm] counter=127 i=5 t=7.6e-03 per=1.6e+01 cost=8.3e+04 flops=1.1e+07
 sigma[gemm] counter=127 i=6 t=7.5e-03 per=1.6e+01 cost=7.0e+04 flops=9.4e+06
 sigma[gemm] counter=127 i=7 t=7.4e-03 per=1.5e+01 cost=7.2e+04 flops=9.8e+06
 sigma[gemm] counter=127 total t=3.0e-02 per=6.3e+01 cost=3.1e+05 flops=1.0e+07
 sigma[red] counter=127 t=1.0e-02 per=2.1e+01 cost=8.8e+04 flops=8.6e+06
----- TIMING FOR sigma_tot : t_inter=8.6e-01 t_gemm=3.5e+00 t_reduction=1.5e+00 tot=5.8e+00 -----
 sigma_tot[inter] counter=127 t=8.6e-01 per=1.5e+01 cost=2.4e+07 flops=2.8e+07
 sigma_tot[gemm] counter=127 i=0 t=1.7e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=1 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=2 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=3 t=1.5e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=4 t=8.7e-01 per=1.5e+01 cost=2.7e+06 flops=3.1e+06
 sigma_tot[gemm] counter=127 i=5 t=8.8e-01 per=1.5e+01 cost=2.7e+06 flops=3.1e+06
 sigma_tot[gemm] counter=127 i=6 t=8.6e-01 per=1.5e+01 cost=2.9e+06 flops=3.4e+06
 sigma_tot[gemm] counter=127 i=7 t=8.6e-01 per=1.5e+01 cost=2.9e+06 flops=3.4e+06
 sigma_tot[gemm] counter=127 total t=3.5e+00 per=6.0e+01 cost=1.1e+07 flops=3.3e+06
 sigma_tot[red] counter=127 t=1.5e+00 per=2.5e+01 cost=4.0e+06 flops=2.7e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.5e-05,3.2e-06,1.2e-06,2.3e-07
    4   0 -    -116.263872087930 -1.263e-04  2.410e-03    3     4  2.227e-01 5.567e-02 5.557e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.087e-03,7.444e-03,2.993e-02,1.050e-02,5.697e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.255e-03 speed=6.874e-04GB/S T(nccl)=6.833e-03 speed=2.268e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=128 t=7.4e-03 per=1.6e+01 cost=5.4e+05 flops=7.2e+07
 sigma[gemm] counter=128 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=4 t=7.4e-03 per=1.6e+01 cost=8.3e+04 flops=1.1e+07
 sigma[gemm] counter=128 i=5 t=7.5e-03 per=1.6e+01 cost=8.3e+04 flops=1.1e+07
 sigma[gemm] counter=128 i=6 t=7.5e-03 per=1.6e+01 cost=7.0e+04 flops=9.4e+06
 sigma[gemm] counter=128 i=7 t=7.5e-03 per=1.6e+01 cost=7.2e+04 flops=9.7e+06
 sigma[gemm] counter=128 total t=3.0e-02 per=6.3e+01 cost=3.1e+05 flops=1.0e+07
 sigma[red] counter=128 t=1.1e-02 per=2.2e+01 cost=8.8e+04 flops=8.4e+06
----- TIMING FOR sigma_tot : t_inter=8.7e-01 t_gemm=3.5e+00 t_reduction=1.5e+00 tot=5.8e+00 -----
 sigma_tot[inter] counter=128 t=8.7e-01 per=1.5e+01 cost=2.4e+07 flops=2.8e+07
 sigma_tot[gemm] counter=128 i=0 t=1.7e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=1 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=2 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=3 t=1.5e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=4 t=8.8e-01 per=1.5e+01 cost=2.8e+06 flops=3.2e+06
 sigma_tot[gemm] counter=128 i=5 t=8.9e-01 per=1.5e+01 cost=2.8e+06 flops=3.2e+06
 sigma_tot[gemm] counter=128 i=6 t=8.7e-01 per=1.5e+01 cost=3.0e+06 flops=3.4e+06
 sigma_tot[gemm] counter=128 i=7 t=8.6e-01 per=1.5e+01 cost=3.0e+06 flops=3.5e+06
 sigma_tot[gemm] counter=128 total t=3.5e+00 per=6.0e+01 cost=1.2e+07 flops=3.3e+06
 sigma_tot[red] counter=128 t=1.5e+00 per=2.5e+01 cost=4.1e+06 flops=2.7e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.3e-05,3.2e-06,1.3e-06,2.4e-07
    5   0 -    -116.263886131454 -1.404e-05  6.660e-04    3     5  2.799e-01 5.599e-02 5.590e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.232e-03,7.462e-03,2.996e-02,1.028e-02,5.695e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.216e-03 speed=6.993e-04GB/S T(nccl)=7.016e-03 speed=2.209e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=129 t=7.5e-03 per=1.6e+01 cost=5.4e+05 flops=7.2e+07
 sigma[gemm] counter=129 i=0 t=1.3e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=1 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=3 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=4 t=7.5e-03 per=1.6e+01 cost=8.3e+04 flops=1.1e+07
 sigma[gemm] counter=129 i=5 t=7.6e-03 per=1.6e+01 cost=8.3e+04 flops=1.1e+07
 sigma[gemm] counter=129 i=6 t=7.4e-03 per=1.6e+01 cost=7.0e+04 flops=9.4e+06
 sigma[gemm] counter=129 i=7 t=7.4e-03 per=1.6e+01 cost=7.2e+04 flops=9.8e+06
 sigma[gemm] counter=129 total t=3.0e-02 per=6.3e+01 cost=3.1e+05 flops=1.0e+07
 sigma[red] counter=129 t=1.0e-02 per=2.2e+01 cost=8.8e+04 flops=8.5e+06
----- TIMING FOR sigma_tot : t_inter=8.7e-01 t_gemm=3.5e+00 t_reduction=1.5e+00 tot=5.9e+00 -----
 sigma_tot[inter] counter=129 t=8.7e-01 per=1.5e+01 cost=2.5e+07 flops=2.8e+07
 sigma_tot[gemm] counter=129 i=0 t=1.7e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=1 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=2 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=3 t=1.5e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=4 t=8.9e-01 per=1.5e+01 cost=2.9e+06 flops=3.3e+06
 sigma_tot[gemm] counter=129 i=5 t=9.0e-01 per=1.5e+01 cost=2.9e+06 flops=3.2e+06
 sigma_tot[gemm] counter=129 i=6 t=8.8e-01 per=1.5e+01 cost=3.0e+06 flops=3.5e+06
 sigma_tot[gemm] counter=129 i=7 t=8.7e-01 per=1.5e+01 cost=3.1e+06 flops=3.5e+06
 sigma_tot[gemm] counter=129 total t=3.5e+00 per=6.0e+01 cost=1.2e+07 flops=3.4e+06
 sigma_tot[red] counter=129 t=1.5e+00 per=2.5e+01 cost=4.1e+06 flops=2.8e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.3e-05,3.1e-06,1.2e-06,2.3e-07
    6   0 -    -116.263887359888 -1.228e-06  2.268e-04    3     6  3.372e-01 5.620e-02 5.610e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.960e-03,7.606e-03,3.028e-02,1.031e-02,5.717e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.194e-03 speed=7.062e-04GB/S T(nccl)=6.765e-03 speed=2.291e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=130 t=7.6e-03 per=1.6e+01 cost=5.4e+05 flops=7.0e+07
 sigma[gemm] counter=130 i=0 t=1.3e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=4 t=7.6e-03 per=1.6e+01 cost=8.3e+04 flops=1.1e+07
 sigma[gemm] counter=130 i=5 t=7.5e-03 per=1.6e+01 cost=8.3e+04 flops=1.1e+07
 sigma[gemm] counter=130 i=6 t=7.5e-03 per=1.6e+01 cost=7.0e+04 flops=9.3e+06
 sigma[gemm] counter=130 i=7 t=7.6e-03 per=1.6e+01 cost=7.2e+04 flops=9.5e+06
 sigma[gemm] counter=130 total t=3.0e-02 per=6.3e+01 cost=3.1e+05 flops=1.0e+07
 sigma[red] counter=130 t=1.0e-02 per=2.1e+01 cost=8.8e+04 flops=8.5e+06
----- TIMING FOR sigma_tot : t_inter=8.8e-01 t_gemm=3.6e+00 t_reduction=1.5e+00 tot=5.9e+00 -----
 sigma_tot[inter] counter=130 t=8.8e-01 per=1.5e+01 cost=2.5e+07 flops=2.9e+07
 sigma_tot[gemm] counter=130 i=0 t=1.7e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=1 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=2 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=3 t=1.5e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=4 t=9.0e-01 per=1.5e+01 cost=3.0e+06 flops=3.3e+06
 sigma_tot[gemm] counter=130 i=5 t=9.0e-01 per=1.5e+01 cost=3.0e+06 flops=3.3e+06
 sigma_tot[gemm] counter=130 i=6 t=8.8e-01 per=1.5e+01 cost=3.1e+06 flops=3.5e+06
 sigma_tot[gemm] counter=130 i=7 t=8.8e-01 per=1.5e+01 cost=3.2e+06 flops=3.6e+06
 sigma_tot[gemm] counter=130 total t=3.6e+00 per=6.0e+01 cost=1.2e+07 flops=3.4e+06
 sigma_tot[red] counter=130 t=1.5e+00 per=2.5e+01 cost=4.2e+06 flops=2.8e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.3e-05,3.2e-06,1.2e-06,2.4e-07
    7   0 +    -116.263887503498 -1.436e-07  9.865e-05    3     7  3.946e-01 5.638e-02 5.629e-02
TIMING FOR Davidson : 3.947e-01  T(cal/comm/rest)=3.940e-01,7.505e-06,6.280e-04
decomposed t_rest=6.280e-04
 T(sub)    =1.902e-04 per=3.029e+01
 T(precond)=5.275e-05 per=8.399e+00
 T(ortho)  =1.517e-05 per=2.415e+00
 T(xcopy)  =9.350e-07 per=1.489e-01
 T(xnrm2)  =3.205e-06 per=5.103e-01
 T(other)  =3.657e-04 per=5.824e+01
optimized energies: isweep=0 ibond=22 dots=2 e[0]=-116.263887503498 nmvp=7
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=4.791e-03 change=3.017e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond22.txt
 qbond: qsuper nsym=12 dimAll=40
 (9,3):8 (8,2):3 (8,4):3 (7,3):1 (9,1):3 (10,2):7 (11,3):4 (10,4):5 (11,1):2 (12,2):1 (9,5):2 (10,0):1
timing for divide=9.1e-05
timing for compute=1.1e-04
timing for collect=1.8e-05
----- TMING FOR decimation_genbasis(su2): 2.2e-04 S T(divide/compute[cpu/gpu/rest]/collect)=9.1e-05,9.9e-05,0.0e+00,8.5e-06,1.8e-05 -----
decimation summary: 40->10 dwt=+6.920e-05 SvN=4.564e-01
 qbond: qkept nsym=6 dimAll=10
 (11,3):3 (10,2):2 (10,4):2 (9,3):1 (11,1):1 (12,2):1
----- TIMING for decimation_row(nkr): 6.531e-04 S T(decim/select/formRot)=2.869e-04,2.618e-04,1.045e-04 -----
----- TIMING FOR twodot_decimation: 1.632e-03 S T(wf/decim)=8.630e-04,7.692e-04 -----
ctns::oper_renorm coord=(13,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:7 S:6 A:23 B:28 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=1207:9.209e-03MB:8.993e-06GB
        per(mem): H:1.66 C:12.8 S:10.9 A:12 B:62.6 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=4.791e-03 change=1.840e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=59 : 4.790e-04 S -----
rank=0 GPUmem(GB): used=4.607e-05 (oper)=2.392e-05
rank=0 GPUmem(GB): used=4.642e-05 (oper,site)=2.392e-05,3.502e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=59
 no. of rintermediate operators=5
 no. of coefficients=54:4.120e-04MB:4.023e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.463e-03 S -----
rank=0 GPUmem(GB): used=4.683e-05 (oper,site,rinter)=2.392e-05,3.502e-07,4.023e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.176e-02 S size(rtasks)=59 size(Rlst2)=36 T(Rmu/Rlist)=1.812e-04,1.157e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.187e-02 S size(rtasks)=59 size(Rlst)=1050 -----
rank=0 GPUmem(GB): used=4.683e-05 avail=6.231e+00 total=6.231e+00 batch[need]=2.190e-04 blksize=9 blksize0=9 batchsize=1050
rank=0 GPUmem(GB): used=2.659e-04 (oper,site,rinter,batch)=2.392e-05,3.502e-07,4.023e-07,2.190e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.595e-03,2.249e-02,1.016e-02
----- TIMING FOR renorm : t_inter=5.6e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=271 t=5.6e-03 per=1.5e+01 cost=8.3e+03 flops=1.5e+06
 renorm[gemm] counter=271 i=0 t=1.3e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=271 i=1 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=271 i=2 t=7.5e-03 per=2.0e+01 cost=2.3e+03 flops=3.1e+05
 renorm[gemm] counter=271 i=3 t=7.5e-03 per=2.0e+01 cost=1.0e+04 flops=1.4e+06
 renorm[gemm] counter=271 i=4 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=271 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=271 i=6 t=7.5e-03 per=2.0e+01 cost=1.3e+04 flops=1.7e+06
 renorm[gemm] counter=271 total t=2.2e-02 per=5.9e+01 cost=2.5e+04 flops=1.1e+06
 renorm[red] counter=271 t=1.0e-02 per=2.7e+01 cost=6.5e+03 flops=6.4e+05
----- TIMING FOR renorm_tot : t_inter=1.4e-01 t_gemm=5.1e-01 t_reduction=2.2e-01 tot=8.7e-01 -----
 renorm_tot[inter] counter=271 t=1.4e-01 per=1.6e+01 cost=4.3e+05 flops=3.0e+06
 renorm_tot[gemm] counter=271 i=0 t=3.1e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=271 i=1 t=2.6e-05 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=271 i=2 t=4.5e-02 per=5.1e+00 cost=9.0e+03 flops=2.0e+05
 renorm_tot[gemm] counter=271 i=3 t=3.9e-02 per=4.5e+00 cost=3.0e+04 flops=7.5e+05
 renorm_tot[gemm] counter=271 i=4 t=1.3e-01 per=1.5e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=271 i=5 t=1.3e-01 per=1.5e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=271 i=6 t=1.7e-01 per=1.9e+01 cost=2.7e+05 flops=1.6e+06
 renorm_tot[gemm] counter=271 total t=5.1e-01 per=5.8e+01 cost=5.0e+05 flops=9.9e+05
 renorm_tot[red] counter=271 t=2.2e-01 per=2.6e+01 cost=1.6e+05 flops=7.1e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=5.335e-05 (optmp,oper)=1.639e-07,2.392e-05
rank=0 GPUmem(GB): used=5.370e-05 (optmp,oper,site,rinter)=1.639e-07,2.392e-05,3.502e-07,6.713e-06
rank=0 GPUmem(GB): used=8.020e-05 (optmp,oper,site,rinter,batch)=1.639e-07,2.392e-05,3.502e-07,6.713e-06,2.649e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 5.930e-01 S T(prep/alloc/comp/red/dealloc)=3.120e-02,3.835e-02,5.048e-01,4.727e-02,2.587e-03 -----
----- TIMING FOR oper_renorm_opS : 5.932e-01 S rank=0 -----
qops.to_cpu: size(tot)=1207:9.209e-03MB:8.993e-06GB T(to_cpu)=1.011e-04S speed=8.896e-02GB/S
check ||H-H.dagger||=8.166e-16 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.658 S rank=0 -----
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=4.356e-03 change=3.008e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=5.646e-03 change=-1.334e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=5.646e-03 change=-4.813e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.720e+00 S #####
 T(local opt: fetch) = 1.100e-02 S  per = 0.64  per(accum) = 0.64
 T(local opt: hdiag) = 3.600e-01 S  per = 20.9  per(accum) = 21.6
 T(local opt: dvdsn) = 6.854e-01 S  per = 39.8  per(accum) = 61.4
 T(local opt: decim) = 1.772e-03 S  per = 0.103  per(accum) = 61.5
 T(local opt: guess) = 1.113e-03 S  per = 0.0647  per(accum) = 61.6
 T(local opt: renrm) = 6.606e-01 S  per = 38.4  per(accum) = 100
 T(local opt: save ) = 2.630e-04 S  per = 0.0153  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.854e-01 S  T(sum) = 6.844e-01 S  per = 9.986e+01
 T(local opt: preprocess                  ) = 6.060e-03 S  per = 0.885  per(accum) = 0.885
 T(local opt: symbolic_formulae           ) = 4.458e-03 S  per = 0.651  per(accum) = 1.54
 T(local opt: hintermediate init          ) = 2.076e-04 S  per = 0.0303  per(accum) = 1.57
 T(local opt: preprocess_hformulae_Hxlist ) = 1.908e-01 S  per = 27.9  per(accum) = 29.4
 T(local opt: hmmtasks init               ) = 8.656e-02 S  per = 12.6  per(accum) = 42.1
 T(local opt: initial guess for dvdson    ) = 1.703e-03 S  per = 0.249  per(accum) = 42.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.211e-01 S  per = 46.9  per(accum) = 89.3
 T(local opt: dvdson [cpu-gpu]            ) = 1.373e-02 S  per = 2.01  per(accum) = 91.3
 T(local opt: dvdson [nccl]               ) = 5.920e-02 S  per = 8.65  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 7.505e-06 S  per = 0.0011  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 6.280e-04 S  per = 0.0918  per(accum) = 100
Detailed decomposition of T(renrm) = 6.606e-01 S  T(sum) = 6.606e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.381e-04 S  per = 0.0512  per(accum) = 0.0512
 T(local opt: qops init                    ) = 2.724e-03 S  per = 0.412  per(accum) = 0.463
 T(local opt: symbolic_formulae_renorm     ) = 4.895e-04 S  per = 0.0741  per(accum) = 0.538
 T(local opt: allocate qops on gpu         ) = 7.971e-05 S  per = 0.0121  per(accum) = 0.55
 T(local opt: site memcpy cpu2gpu          ) = 1.030e-03 S  per = 0.156  per(accum) = 0.706
 T(local opt: rintermediate init           ) = 2.477e-03 S  per = 0.375  per(accum) = 1.08
 T(local opt: preprocess_formulae_Rlist2   ) = 1.190e-02 S  per =  1.8  per(accum) = 2.88
 T(local opt: rmmtasks init                ) = 5.117e-03 S  per = 0.775  per(accum) = 3.66
 T(local opt: qops memset on cpu           ) = 3.900e-08 S  per = 5.9e-06  per(accum) = 3.66
 T(local opt: preprocess_renorm_batchGPU   ) = 3.836e-02 S  per = 5.81  per(accum) = 9.46
 T(local opt: deallocate cpu and gpu memory) = 5.724e-05 S  per = 0.00866  per(accum) = 9.47
 T(local opt: construct opS [ifdists=true] ) = 5.933e-01 S  per = 89.8  per(accum) = 99.3
 T(local opt: reduction of opS & opH [nccl]) = 2.267e-03 S  per = 0.343  per(accum) = 99.6
 T(local opt: qops memcpy gpu2cpu          ) = 1.121e-04 S  per = 0.017  per(accum) = 99.6
 T(local opt: reduction of opS & opH [mpi] ) = 8.584e-05 S  per = 0.013  per(accum) = 99.7
 T(local opt: qops_pool join and erase     ) = 2.291e-03 S  per = 0.347  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 9.838e-06 S  per = 0.00149  per(accum) = 100
##### sweep opt: 3.004e+01 S #####
 T(sweep opt: fetch) = 2.651e-01 S  per = 0.883  per(accum) = 0.883
 T(sweep opt: hdiag) = 5.532e+00 S  per = 18.4  per(accum) = 19.3
 T(sweep opt: dvdsn) = 1.098e+01 S  per = 36.5  per(accum) = 55.8
 T(sweep opt: decim) = 2.872e-02 S  per = 0.0956  per(accum) = 55.9
 T(sweep opt: guess) = 1.809e-02 S  per = 0.0602  per(accum) = 56
 T(sweep opt: renrm) = 1.321e+01 S  per =   44  per(accum) = 100
 T(sweep opt: save ) = 5.057e-03 S  per = 0.0168  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.098e+01 S  T(sum) = 1.097e+01 S  per = 9.990e+01
 T(sweep opt: preprocess                  ) = 8.735e-02 S  per = 0.797  per(accum) = 0.797
 T(sweep opt: symbolic_formulae           ) = 7.517e-02 S  per = 0.685  per(accum) = 1.48
 T(sweep opt: hintermediate init          ) = 4.233e-03 S  per = 0.0386  per(accum) = 1.52
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.466e+00 S  per = 22.5  per(accum) = 24
 T(sweep opt: hmmtasks init               ) = 1.015e+00 S  per = 9.26  per(accum) = 33.3
 T(sweep opt: initial guess for dvdson    ) = 2.510e-02 S  per = 0.229  per(accum) = 33.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.970e+00 S  per = 54.4  per(accum) = 87.9
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.600e-01 S  per = 2.37  per(accum) = 90.3
 T(sweep opt: dvdson [nccl]               ) = 1.050e+00 S  per = 9.57  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 1.212e-04 S  per = 0.0011  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.246e-02 S  per = 0.114  per(accum) = 100
Detailed decomposition of T(renrm) = 1.321e+01 S  T(sum) = 1.321e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.404e-03 S  per = 0.0485  per(accum) = 0.0485
 T(sweep opt: qops init                    ) = 4.868e-02 S  per = 0.368  per(accum) = 0.417
 T(sweep opt: symbolic_formulae_renorm     ) = 2.200e-02 S  per = 0.167  per(accum) = 0.583
 T(sweep opt: allocate qops on gpu         ) = 1.513e-03 S  per = 0.0115  per(accum) = 0.595
 T(sweep opt: site memcpy cpu2gpu          ) = 3.009e-02 S  per = 0.228  per(accum) = 0.822
 T(sweep opt: rintermediate init           ) = 5.035e-02 S  per = 0.381  per(accum) = 1.2
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.020e-01 S  per = 2.29  per(accum) = 3.49
 T(sweep opt: rmmtasks init                ) = 1.510e-01 S  per = 1.14  per(accum) = 4.63
 T(sweep opt: qops memset on cpu           ) = 8.020e-07 S  per = 6.07e-06  per(accum) = 4.63
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.721e-01 S  per =  6.6  per(accum) = 11.2
 T(sweep opt: deallocate cpu and gpu memory) = 1.416e-03 S  per = 0.0107  per(accum) = 11.2
 T(sweep opt: construct opS [ifdists=true] ) = 1.152e+01 S  per = 87.2  per(accum) = 98.5
 T(sweep opt: reduction of opS & opH [nccl]) = 5.278e-02 S  per = 0.399  per(accum) = 98.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.121e-03 S  per = 0.0161  per(accum) = 98.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.423e-03 S  per = 0.0108  per(accum) = 98.9
 T(sweep opt: qops_pool join and erase     ) = 4.497e-02 S  per = 0.34  per(accum) = 99.2
 T(sweep opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 0.777  per(accum) = 100
##### global opt: 3.004e+01 S #####
 T(global opt: fetch) = 2.651e-01 S  per = 0.883  per(accum) = 0.883
 T(global opt: hdiag) = 5.532e+00 S  per = 18.4  per(accum) = 19.3
 T(global opt: dvdsn) = 1.098e+01 S  per = 36.5  per(accum) = 55.8
 T(global opt: decim) = 2.872e-02 S  per = 0.0956  per(accum) = 55.9
 T(global opt: guess) = 1.809e-02 S  per = 0.0602  per(accum) = 56
 T(global opt: renrm) = 1.321e+01 S  per =   44  per(accum) = 100
 T(global opt: save ) = 5.057e-03 S  per = 0.0168  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.098e+01 S  T(sum) = 1.097e+01 S  per = 9.990e+01
 T(global opt: preprocess                  ) = 8.735e-02 S  per = 0.797  per(accum) = 0.797
 T(global opt: symbolic_formulae           ) = 7.517e-02 S  per = 0.685  per(accum) = 1.48
 T(global opt: hintermediate init          ) = 4.233e-03 S  per = 0.0386  per(accum) = 1.52
 T(global opt: preprocess_hformulae_Hxlist ) = 2.466e+00 S  per = 22.5  per(accum) = 24
 T(global opt: hmmtasks init               ) = 1.015e+00 S  per = 9.26  per(accum) = 33.3
 T(global opt: initial guess for dvdson    ) = 2.510e-02 S  per = 0.229  per(accum) = 33.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.970e+00 S  per = 54.4  per(accum) = 87.9
 T(global opt: dvdson [cpu-gpu]            ) = 2.600e-01 S  per = 2.37  per(accum) = 90.3
 T(global opt: dvdson [nccl]               ) = 1.050e+00 S  per = 9.57  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 1.212e-04 S  per = 0.0011  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.246e-02 S  per = 0.114  per(accum) = 100
Detailed decomposition of T(renrm) = 1.321e+01 S  T(sum) = 1.321e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.404e-03 S  per = 0.0485  per(accum) = 0.0485
 T(global opt: qops init                    ) = 4.868e-02 S  per = 0.368  per(accum) = 0.417
 T(global opt: symbolic_formulae_renorm     ) = 2.200e-02 S  per = 0.167  per(accum) = 0.583
 T(global opt: allocate qops on gpu         ) = 1.513e-03 S  per = 0.0115  per(accum) = 0.595
 T(global opt: site memcpy cpu2gpu          ) = 3.009e-02 S  per = 0.228  per(accum) = 0.822
 T(global opt: rintermediate init           ) = 5.035e-02 S  per = 0.381  per(accum) = 1.2
 T(global opt: preprocess_formulae_Rlist2   ) = 3.020e-01 S  per = 2.29  per(accum) = 3.49
 T(global opt: rmmtasks init                ) = 1.510e-01 S  per = 1.14  per(accum) = 4.63
 T(global opt: qops memset on cpu           ) = 8.020e-07 S  per = 6.07e-06  per(accum) = 4.63
 T(global opt: preprocess_renorm_batchGPU   ) = 8.721e-01 S  per =  6.6  per(accum) = 11.2
 T(global opt: deallocate cpu and gpu memory) = 1.416e-03 S  per = 0.0107  per(accum) = 11.2
 T(global opt: construct opS [ifdists=true] ) = 1.152e+01 S  per = 87.2  per(accum) = 98.5
 T(global opt: reduction of opS & opH [nccl]) = 5.278e-02 S  per = 0.399  per(accum) = 98.9
 T(global opt: qops memcpy gpu2cpu          ) = 2.121e-03 S  per = 0.0161  per(accum) = 98.9
 T(global opt: reduction of opS & opH [mpi] ) = 1.423e-03 S  per = 0.0108  per(accum) = 98.9
 T(global opt: qops_pool join and erase     ) = 4.497e-02 S  per = 0.34  per(accum) = 99.2
 T(global opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 0.777  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-2.997e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=23/seqsize=34 dots=2 dbond=(11,0)-(12,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=574:4.379e-03MB:4.277e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=48:3.662e-04MB:3.576e-07GB
total mem of comb=623:4.753e-03MB:4.642e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=11,7,1,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc1= 7
 suppc2= 8
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(11,0)
 fqop[3]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:11 S:5 P:40 Q:44 
        dim(bra,ket)=8,8 size(op)=24:1.831e-04MB size(tot)=1312:1.001e-02MB:9.775e-06GB
        per(mem): H:1.22 C:13.4 S:6.1 P:12.2 Q:67.1 
 rqops: oplist=HCSAB nops=H:1 C:7 S:6 A:23 B:28 
        dim(bra,ket)=10,10 size(op)=34:0.000259MB size(tot)=1207:0.00921MB:8.99e-06GB
        per(mem): H:1.66 C:12.8 S:10.9 A:12 B:62.6 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4515:0.0344MB:3.36e-05GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=9.537e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(12,0) fdel=./scratch/sweep/lop(11,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.103e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(8,10,3,3) nnz=104:7.935e-04MB
qtensor4: wf4 own=1 _data=0x3b3cd180
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=4 dimAll=8
 (15,3):2 (17,3):2 (16,2):2 (16,4):2
 qbond: qcol nsym=6 dimAll=10
 (11,3):3 (10,2):2 (10,4):2 (9,3):1 (11,1):1 (12,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=28 nblocks=384 size=104:7.935e-04MB
### DIAG TIMING: total=4.093e-01 t1=2.656e-05, t2=1.201e-03, t3=2.503e-03, t4=4.031e-01, t5=4.043e-06, t6=2.472e-03, t7=4.872e-06
duration_diagGPU:4.093e-01
duration_diagreduce:6.900e-08
duration_diagtransform:8.590e-07
----- TIMING FOR symbolic_formulae_twodot with size=398 : 5.377e-03 S -----
rank=0 GPUmem(GB): used=3.364e-05 (oper)=3.364e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=398
 no. of hintermediate operators=212
 no. of coefficients=2490:1.900e-02MB:1.855e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.614e-04 S -----
rank=0 GPUmem(GB): used=5.219e-05 (oper,hinter)=3.364e-05,1.855e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.335e-01 S size(H_formulae)=398 size(Hxlst2)=28 T(Hmu/Hxlist)=1.074e-03,2.324e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.358e-01 S size(H_formulae)=398 size(Hxlst)=14086 -----
rank=0 GPUmem(GB): used=5.219e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=1.550e-06 batch[need]=2.309e-03 blksize=6 blksize0=9 batchsize=14086
rank=0 GPUmem(GB): used=2.363e-03 (oper,hinter,dvdson,batch)=3.364e-05,1.855e-05,1.550e-06,2.309e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=104 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.687e-03,7.598e-03,3.025e-02,1.060e-02,5.514e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=1.483e-03 speed=1.045e-03GB/S T(nccl)=5.204e-03 speed=2.978e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=131 t=7.6e-03 per=1.6e+01 cost=6.9e+05 flops=9.0e+07
 sigma[gemm] counter=131 i=0 t=1.8e-06 per=3.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=4 t=7.4e-03 per=1.5e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=131 i=5 t=7.6e-03 per=1.6e+01 cost=1.0e+05 flops=1.3e+07
 sigma[gemm] counter=131 i=6 t=7.6e-03 per=1.6e+01 cost=8.4e+04 flops=1.1e+07
 sigma[gemm] counter=131 i=7 t=7.6e-03 per=1.6e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=131 total t=3.0e-02 per=6.2e+01 cost=3.8e+05 flops=1.2e+07
 sigma[red] counter=131 t=1.1e-02 per=2.2e+01 cost=1.1e+05 flops=1.0e+07
----- TIMING FOR sigma_tot : t_inter=8.9e-01 t_gemm=3.6e+00 t_reduction=1.5e+00 tot=6.0e+00 -----
 sigma_tot[inter] counter=131 t=8.9e-01 per=1.5e+01 cost=2.6e+07 flops=2.9e+07
 sigma_tot[gemm] counter=131 i=0 t=1.8e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=1 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=2 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=3 t=1.5e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=4 t=9.0e-01 per=1.5e+01 cost=3.1e+06 flops=3.4e+06
 sigma_tot[gemm] counter=131 i=5 t=9.1e-01 per=1.5e+01 cost=3.1e+06 flops=3.4e+06
 sigma_tot[gemm] counter=131 i=6 t=8.9e-01 per=1.5e+01 cost=3.2e+06 flops=3.6e+06
 sigma_tot[gemm] counter=131 i=7 t=8.9e-01 per=1.5e+01 cost=3.2e+06 flops=3.7e+06
 sigma_tot[gemm] counter=131 total t=3.6e+00 per=6.0e+01 cost=1.3e+07 flops=3.5e+06
 sigma_tot[red] counter=131 t=1.5e+00 per=2.5e+01 cost=4.3e+06 flops=2.9e+06
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,7.8e-06,2.3e-06,1.5e-06,2.1e-07
settings: ndim=104 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.263855031882 -1.116e+03  4.051e-02    1     1  5.541e-02 5.541e-02 5.537e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.168e-02,7.425e-03,2.976e-02,1.050e-02,5.937e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.141e-03 speed=7.238e-04GB/S T(nccl)=9.539e-03 speed=1.625e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=132 t=7.4e-03 per=1.6e+01 cost=6.9e+05 flops=9.2e+07
 sigma[gemm] counter=132 i=0 t=1.3e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=1 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=3 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=4 t=7.4e-03 per=1.5e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=132 i=5 t=7.5e-03 per=1.6e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=132 i=6 t=7.4e-03 per=1.6e+01 cost=8.4e+04 flops=1.1e+07
 sigma[gemm] counter=132 i=7 t=7.4e-03 per=1.6e+01 cost=8.6e+04 flops=1.2e+07
 sigma[gemm] counter=132 total t=3.0e-02 per=6.2e+01 cost=3.8e+05 flops=1.3e+07
 sigma[red] counter=132 t=1.0e-02 per=2.2e+01 cost=1.1e+05 flops=1.0e+07
----- TIMING FOR sigma_tot : t_inter=9.0e-01 t_gemm=3.6e+00 t_reduction=1.5e+00 tot=6.0e+00 -----
 sigma_tot[inter] counter=132 t=9.0e-01 per=1.5e+01 cost=2.7e+07 flops=3.0e+07
 sigma_tot[gemm] counter=132 i=0 t=1.8e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=1 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=2 t=1.5e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=3 t=1.5e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=4 t=9.1e-01 per=1.5e+01 cost=3.2e+06 flops=3.5e+06
 sigma_tot[gemm] counter=132 i=5 t=9.2e-01 per=1.5e+01 cost=3.2e+06 flops=3.5e+06
 sigma_tot[gemm] counter=132 i=6 t=9.0e-01 per=1.5e+01 cost=3.3e+06 flops=3.6e+06
 sigma_tot[gemm] counter=132 i=7 t=8.9e-01 per=1.5e+01 cost=3.3e+06 flops=3.7e+06
 sigma_tot[gemm] counter=132 total t=3.6e+00 per=6.0e+01 cost=1.3e+07 flops=3.6e+06
 sigma_tot[red] counter=132 t=1.5e+00 per=2.5e+01 cost=4.4e+06 flops=2.9e+06
T(sub)=3.8e-05 T(gemm/eig/ortho/gemm/axpy)=5.8e-06,2.7e-05,3.8e-06,1.8e-06,2.4e-07
    2   0 -    -116.268586055428 -4.731e-03  1.829e-02    2     2  1.151e-01 5.756e-02 5.748e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.411e-03,7.548e-03,3.016e-02,1.042e-02,5.654e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.183e-03 speed=7.100e-04GB/S T(nccl)=6.229e-03 speed=2.488e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=133 t=7.5e-03 per=1.6e+01 cost=6.9e+05 flops=9.1e+07
 sigma[gemm] counter=133 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=1 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=4 t=7.5e-03 per=1.6e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=133 i=5 t=7.5e-03 per=1.6e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=133 i=6 t=7.5e-03 per=1.6e+01 cost=8.4e+04 flops=1.1e+07
 sigma[gemm] counter=133 i=7 t=7.6e-03 per=1.6e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=133 total t=3.0e-02 per=6.3e+01 cost=3.8e+05 flops=1.2e+07
 sigma[red] counter=133 t=1.0e-02 per=2.2e+01 cost=1.1e+05 flops=1.0e+07
----- TIMING FOR sigma_tot : t_inter=9.0e-01 t_gemm=3.7e+00 t_reduction=1.5e+00 tot=6.1e+00 -----
 sigma_tot[inter] counter=133 t=9.0e-01 per=1.5e+01 cost=2.7e+07 flops=3.0e+07
 sigma_tot[gemm] counter=133 i=0 t=1.8e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=1 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=2 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=3 t=1.5e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=4 t=9.2e-01 per=1.5e+01 cost=3.3e+06 flops=3.6e+06
 sigma_tot[gemm] counter=133 i=5 t=9.3e-01 per=1.5e+01 cost=3.3e+06 flops=3.6e+06
 sigma_tot[gemm] counter=133 i=6 t=9.1e-01 per=1.5e+01 cost=3.4e+06 flops=3.7e+06
 sigma_tot[gemm] counter=133 i=7 t=9.0e-01 per=1.5e+01 cost=3.4e+06 flops=3.8e+06
 sigma_tot[gemm] counter=133 total t=3.7e+00 per=6.0e+01 cost=1.3e+07 flops=3.7e+06
 sigma_tot[red] counter=133 t=1.5e+00 per=2.5e+01 cost=4.6e+06 flops=3.0e+06
T(sub)=3.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,2.0e-05,3.2e-06,1.1e-05,2.2e-07
    3   0 -    -116.269530688753 -9.446e-04  7.177e-03    3     3  1.720e-01 5.733e-02 5.725e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.841e-03,7.438e-03,3.014e-02,1.062e-02,5.705e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.113e-03 speed=7.336e-04GB/S T(nccl)=6.729e-03 speed=2.303e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=134 t=7.4e-03 per=1.5e+01 cost=6.9e+05 flops=9.2e+07
 sigma[gemm] counter=134 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=3 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=4 t=7.5e-03 per=1.5e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=134 i=5 t=7.6e-03 per=1.6e+01 cost=1.0e+05 flops=1.3e+07
 sigma[gemm] counter=134 i=6 t=7.6e-03 per=1.6e+01 cost=8.4e+04 flops=1.1e+07
 sigma[gemm] counter=134 i=7 t=7.4e-03 per=1.5e+01 cost=8.6e+04 flops=1.2e+07
 sigma[gemm] counter=134 total t=3.0e-02 per=6.3e+01 cost=3.8e+05 flops=1.2e+07
 sigma[red] counter=134 t=1.1e-02 per=2.2e+01 cost=1.1e+05 flops=1.0e+07
----- TIMING FOR sigma_tot : t_inter=9.1e-01 t_gemm=3.7e+00 t_reduction=1.5e+00 tot=6.1e+00 -----
 sigma_tot[inter] counter=134 t=9.1e-01 per=1.5e+01 cost=2.8e+07 flops=3.1e+07
 sigma_tot[gemm] counter=134 i=0 t=1.8e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=1 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=2 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=3 t=1.5e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=4 t=9.3e-01 per=1.5e+01 cost=3.4e+06 flops=3.7e+06
 sigma_tot[gemm] counter=134 i=5 t=9.4e-01 per=1.5e+01 cost=3.4e+06 flops=3.6e+06
 sigma_tot[gemm] counter=134 i=6 t=9.1e-01 per=1.5e+01 cost=3.4e+06 flops=3.8e+06
 sigma_tot[gemm] counter=134 i=7 t=9.1e-01 per=1.5e+01 cost=3.5e+06 flops=3.9e+06
 sigma_tot[gemm] counter=134 total t=3.7e+00 per=6.0e+01 cost=1.4e+07 flops=3.7e+06
 sigma_tot[red] counter=134 t=1.5e+00 per=2.5e+01 cost=4.7e+06 flops=3.0e+06
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.6e-05,3.2e-06,1.4e-06,2.2e-07
    4   0 -    -116.269658610978 -1.279e-04  2.220e-03    3     4  2.293e-01 5.732e-02 5.723e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.928e-03,7.454e-03,2.999e-02,1.067e-02,5.705e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.253e-03 speed=6.877e-04GB/S T(nccl)=6.675e-03 speed=2.322e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=135 t=7.5e-03 per=1.5e+01 cost=6.9e+05 flops=9.2e+07
 sigma[gemm] counter=135 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=3 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=4 t=7.4e-03 per=1.5e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=135 i=5 t=7.5e-03 per=1.6e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=135 i=6 t=7.5e-03 per=1.6e+01 cost=8.4e+04 flops=1.1e+07
 sigma[gemm] counter=135 i=7 t=7.5e-03 per=1.6e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=135 total t=3.0e-02 per=6.2e+01 cost=3.8e+05 flops=1.3e+07
 sigma[red] counter=135 t=1.1e-02 per=2.2e+01 cost=1.1e+05 flops=1.0e+07
----- TIMING FOR sigma_tot : t_inter=9.2e-01 t_gemm=3.7e+00 t_reduction=1.6e+00 tot=6.2e+00 -----
 sigma_tot[inter] counter=135 t=9.2e-01 per=1.5e+01 cost=2.9e+07 flops=3.1e+07
 sigma_tot[gemm] counter=135 i=0 t=1.8e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=1 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=2 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=3 t=1.5e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=4 t=9.3e-01 per=1.5e+01 cost=3.5e+06 flops=3.7e+06
 sigma_tot[gemm] counter=135 i=5 t=9.4e-01 per=1.5e+01 cost=3.5e+06 flops=3.7e+06
 sigma_tot[gemm] counter=135 i=6 t=9.2e-01 per=1.5e+01 cost=3.5e+06 flops=3.8e+06
 sigma_tot[gemm] counter=135 i=7 t=9.2e-01 per=1.5e+01 cost=3.6e+06 flops=3.9e+06
 sigma_tot[gemm] counter=135 total t=3.7e+00 per=6.0e+01 cost=1.4e+07 flops=3.8e+06
 sigma_tot[red] counter=135 t=1.6e+00 per=2.5e+01 cost=4.8e+06 flops=3.1e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.5e-05,3.1e-06,1.2e-06,2.1e-07
    5   0 -    -116.269669887506 -1.128e-05  6.224e-04    3     5  2.867e-01 5.734e-02 5.724e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.172e-02,7.550e-03,3.021e-02,1.045e-02,5.993e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.159e-03 speed=7.179e-04GB/S T(nccl)=9.560e-03 speed=1.621e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=136 t=7.5e-03 per=1.6e+01 cost=6.9e+05 flops=9.1e+07
 sigma[gemm] counter=136 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=1 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=2 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=3 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=4 t=7.5e-03 per=1.6e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=136 i=5 t=7.7e-03 per=1.6e+01 cost=1.0e+05 flops=1.3e+07
 sigma[gemm] counter=136 i=6 t=7.6e-03 per=1.6e+01 cost=8.4e+04 flops=1.1e+07
 sigma[gemm] counter=136 i=7 t=7.4e-03 per=1.5e+01 cost=8.6e+04 flops=1.2e+07
 sigma[gemm] counter=136 total t=3.0e-02 per=6.3e+01 cost=3.8e+05 flops=1.2e+07
 sigma[red] counter=136 t=1.0e-02 per=2.2e+01 cost=1.1e+05 flops=1.0e+07
----- TIMING FOR sigma_tot : t_inter=9.3e-01 t_gemm=3.7e+00 t_reduction=1.6e+00 tot=6.2e+00 -----
 sigma_tot[inter] counter=136 t=9.3e-01 per=1.5e+01 cost=2.9e+07 flops=3.2e+07
 sigma_tot[gemm] counter=136 i=0 t=1.8e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=1 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=2 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=3 t=1.6e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=4 t=9.4e-01 per=1.5e+01 cost=3.6e+06 flops=3.8e+06
 sigma_tot[gemm] counter=136 i=5 t=9.5e-01 per=1.5e+01 cost=3.6e+06 flops=3.8e+06
 sigma_tot[gemm] counter=136 i=6 t=9.3e-01 per=1.5e+01 cost=3.6e+06 flops=3.9e+06
 sigma_tot[gemm] counter=136 i=7 t=9.2e-01 per=1.5e+01 cost=3.7e+06 flops=4.0e+06
 sigma_tot[gemm] counter=136 total t=3.7e+00 per=6.0e+01 cost=1.4e+07 flops=3.9e+06
 sigma_tot[red] counter=136 t=1.6e+00 per=2.5e+01 cost=4.9e+06 flops=3.1e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.6e-05,3.1e-06,1.2e-06,2.5e-07
    6   0 -    -116.269670775721 -8.882e-07  2.311e-04    3     6  3.469e-01 5.782e-02 5.772e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.235e-03,7.703e-03,3.021e-02,1.068e-02,5.584e-02
 analyze_tgpu[Hx]: ndim=104:7.749e-07GB T(cpu-gpu)=2.208e-03 speed=7.020e-04GB/S T(nccl)=5.027e-03 speed=3.083e-04GB/S
----- TIMING FOR sigma : t_inter=7.7e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.9e-02 -----
 sigma[inter] counter=137 t=7.7e-03 per=1.6e+01 cost=6.9e+05 flops=8.9e+07
 sigma[gemm] counter=137 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=4 t=7.5e-03 per=1.5e+01 cost=1.0e+05 flops=1.4e+07
 sigma[gemm] counter=137 i=5 t=7.7e-03 per=1.6e+01 cost=1.0e+05 flops=1.3e+07
 sigma[gemm] counter=137 i=6 t=7.5e-03 per=1.5e+01 cost=8.4e+04 flops=1.1e+07
 sigma[gemm] counter=137 i=7 t=7.5e-03 per=1.5e+01 cost=8.6e+04 flops=1.1e+07
 sigma[gemm] counter=137 total t=3.0e-02 per=6.2e+01 cost=3.8e+05 flops=1.2e+07
 sigma[red] counter=137 t=1.1e-02 per=2.2e+01 cost=1.1e+05 flops=1.0e+07
----- TIMING FOR sigma_tot : t_inter=9.3e-01 t_gemm=3.8e+00 t_reduction=1.6e+00 tot=6.3e+00 -----
 sigma_tot[inter] counter=137 t=9.3e-01 per=1.5e+01 cost=3.0e+07 flops=3.2e+07
 sigma_tot[gemm] counter=137 i=0 t=1.8e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=1 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=2 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=3 t=1.6e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=4 t=9.5e-01 per=1.5e+01 cost=3.7e+06 flops=3.9e+06
 sigma_tot[gemm] counter=137 i=5 t=9.6e-01 per=1.5e+01 cost=3.7e+06 flops=3.9e+06
 sigma_tot[gemm] counter=137 i=6 t=9.4e-01 per=1.5e+01 cost=3.7e+06 flops=3.9e+06
 sigma_tot[gemm] counter=137 i=7 t=9.3e-01 per=1.5e+01 cost=3.8e+06 flops=4.0e+06
 sigma_tot[gemm] counter=137 total t=3.8e+00 per=6.0e+01 cost=1.5e+07 flops=3.9e+06
 sigma_tot[red] counter=137 t=1.6e+00 per=2.5e+01 cost=5.0e+06 flops=3.2e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.5e-05,3.2e-06,1.2e-06,2.4e-07
    7   0 +    -116.269670916126 -1.404e-07  9.280e-05    3     7  4.030e-01 5.757e-02 5.747e-02
TIMING FOR Davidson : 4.030e-01  T(cal/comm/rest)=4.023e-01,7.694e-06,6.490e-04
decomposed t_rest=6.490e-04
 T(sub)    =1.929e-04 per=2.973e+01
 T(precond)=5.488e-05 per=8.456e+00
 T(ortho)  =1.489e-05 per=2.294e+00
 T(xcopy)  =9.220e-07 per=1.421e-01
 T(xnrm2)  =3.449e-06 per=5.315e-01
 T(other)  =3.819e-04 per=5.885e+01
optimized energies: isweep=0 ibond=23 dots=2 e[0]=-116.269670916126 nmvp=7
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=6.439e-03 change=3.630e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond23.txt
 qbond: qsuper nsym=12 dimAll=40
 (11,3):8 (10,2):3 (10,4):3 (9,3):1 (11,1):3 (12,2):7 (13,3):4 (12,4):5 (13,1):2 (14,2):1 (11,5):2 (12,0):1
timing for divide=1.2e-04
timing for compute=1.1e-04
timing for collect=2.7e-05
----- TMING FOR decimation_genbasis(su2): 2.6e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.2e-04,1.0e-04,0.0e+00,9.4e-06,2.7e-05 -----
decimation summary: 40->10 dwt=+3.842e-04 SvN=6.680e-01
 qbond: qkept nsym=6 dimAll=10
 (13,3):3 (12,2):2 (12,4):2 (11,3):1 (13,1):1 (14,2):1
----- TIMING for decimation_row(nkr): 7.717e-04 S T(decim/select/formRot)=3.934e-04,2.754e-04,1.028e-04 -----
----- TIMING FOR twodot_decimation: 1.719e-03 S T(wf/decim)=8.297e-04,8.890e-04 -----
ctns::oper_renorm coord=(12,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:8 S:6 A:28 B:40 
        dim(bra,ket)=10,10 size(op)=34:2.594e-04MB size(tot)=1584:1.208e-02MB:1.180e-05GB
        per(mem): H:1.26 C:11.1 S:8.33 A:11.1 B:68.2 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=6.439e-03 change=2.313e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=77 : 5.868e-04 S -----
rank=0 GPUmem(GB): used=5.422e-05 (oper)=2.823e-05
rank=0 GPUmem(GB): used=5.457e-05 (oper,site)=2.823e-05,3.502e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=77
 no. of rintermediate operators=5
 no. of coefficients=69:5.264e-04MB:5.141e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.472e-03 S -----
rank=0 GPUmem(GB): used=5.508e-05 (oper,site,rinter)=2.823e-05,3.502e-07,5.141e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.455e-02 S size(rtasks)=77 size(Rlst2)=36 T(Rmu/Rlist)=2.187e-04,1.433e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.470e-02 S size(rtasks)=77 size(Rlst)=1306 -----
rank=0 GPUmem(GB): used=5.508e-05 avail=6.231e+00 total=6.231e+00 batch[need]=2.725e-04 blksize=9 blksize0=9 batchsize=1306
rank=0 GPUmem(GB): used=3.275e-04 (oper,site,rinter,batch)=2.823e-05,3.502e-07,5.141e-07,2.725e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.425e-03,1.071e-02,1.521e-03
----- TIMING FOR renorm : t_inter=5.4e-03 t_gemm=1.1e-02 t_reduction=1.5e-03 tot=1.8e-02 -----
 renorm[inter] counter=285 t=5.4e-03 per=3.1e+01 cost=1.1e+04 flops=1.9e+06
 renorm[gemm] counter=285 i=0 t=1.3e-06 per=7.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=285 i=1 t=1.2e-06 per=6.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=285 i=2 t=7.0e-03 per=4.0e+01 cost=3.0e+03 flops=4.3e+05
 renorm[gemm] counter=285 i=3 t=1.2e-03 per=6.5e+00 cost=1.2e+04 flops=1.1e+07
 renorm[gemm] counter=285 i=4 t=1.2e-06 per=6.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=285 i=5 t=1.1e-06 per=6.3e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=285 i=6 t=2.5e-03 per=1.4e+01 cost=1.6e+04 flops=6.2e+06
 renorm[gemm] counter=285 total t=1.1e-02 per=6.1e+01 cost=3.1e+04 flops=2.9e+06
 renorm[red] counter=285 t=1.5e-03 per=8.6e+00 cost=8.1e+03 flops=5.4e+06
----- TIMING FOR renorm_tot : t_inter=1.5e-01 t_gemm=5.2e-01 t_reduction=2.2e-01 tot=8.9e-01 -----
 renorm_tot[inter] counter=285 t=1.5e-01 per=1.7e+01 cost=4.4e+05 flops=3.0e+06
 renorm_tot[gemm] counter=285 i=0 t=3.2e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=285 i=1 t=2.8e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=285 i=2 t=5.2e-02 per=5.8e+00 cost=1.2e+04 flops=2.3e+05
 renorm_tot[gemm] counter=285 i=3 t=4.0e-02 per=4.6e+00 cost=4.2e+04 flops=1.0e+06
 renorm_tot[gemm] counter=285 i=4 t=1.3e-01 per=1.4e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=285 i=5 t=1.3e-01 per=1.4e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=285 i=6 t=1.7e-01 per=1.9e+01 cost=2.9e+05 flops=1.7e+06
 renorm_tot[gemm] counter=285 total t=5.2e-01 per=5.8e+01 cost=5.3e+05 flops=1.0e+06
 renorm_tot[red] counter=285 t=2.2e-01 per=2.5e+01 cost=1.7e+05 flops=7.4e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=6.290e-05 (optmp,oper)=1.639e-07,2.823e-05
rank=0 GPUmem(GB): used=6.325e-05 (optmp,oper,site,rinter)=1.639e-07,2.823e-05,3.502e-07,8.002e-06
rank=0 GPUmem(GB): used=8.974e-05 (optmp,oper,site,rinter,batch)=1.639e-07,2.823e-05,3.502e-07,8.002e-06,2.649e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 5.921e-01 S T(prep/alloc/comp/red/dealloc)=2.520e-02,3.202e-02,5.072e-01,5.240e-02,4.154e-04 -----
----- TIMING FOR oper_renorm_opS : 5.922e-01 S rank=0 -----
qops.to_cpu: size(tot)=1584:1.208e-02MB:1.180e-05GB T(to_cpu)=1.212e-04S speed=9.741e-02GB/S
check ||H-H.dagger||=6.086e-15 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.64 S rank=0 -----
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=6.081e-03 change=3.683e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=7.919e-03 change=-1.454e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=7.919e-03 change=-4.813e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.830e+00 S #####
 T(local opt: fetch) = 1.245e-02 S  per = 0.68  per(accum) = 0.68
 T(local opt: hdiag) = 4.102e-01 S  per = 22.4  per(accum) = 23.1
 T(local opt: dvdsn) = 7.611e-01 S  per = 41.6  per(accum) = 64.7
 T(local opt: decim) = 1.859e-03 S  per = 0.102  per(accum) = 64.8
 T(local opt: guess) = 1.115e-03 S  per = 0.0609  per(accum) = 64.8
 T(local opt: renrm) = 6.432e-01 S  per = 35.1  per(accum) = 100
 T(local opt: save ) = 3.073e-04 S  per = 0.0168  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.611e-01 S  T(sum) = 7.601e-01 S  per = 9.987e+01
 T(local opt: preprocess                  ) = 6.089e-03 S  per = 0.801  per(accum) = 0.801
 T(local opt: symbolic_formulae           ) = 5.394e-03 S  per = 0.71  per(accum) = 1.51
 T(local opt: hintermediate init          ) = 2.835e-04 S  per = 0.0373  per(accum) = 1.55
 T(local opt: preprocess_hformulae_Hxlist ) = 2.364e-01 S  per = 31.1  per(accum) = 32.6
 T(local opt: hmmtasks init               ) = 1.073e-01 S  per = 14.1  per(accum) = 46.8
 T(local opt: initial guess for dvdson    ) = 1.720e-03 S  per = 0.226  per(accum) = 47
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.388e-01 S  per = 44.6  per(accum) = 91.6
 T(local opt: dvdson [cpu-gpu]            ) = 1.454e-02 S  per = 1.91  per(accum) = 93.5
 T(local opt: dvdson [nccl]               ) = 4.896e-02 S  per = 6.44  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 7.694e-06 S  per = 0.00101  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 6.490e-04 S  per = 0.0854  per(accum) = 100
Detailed decomposition of T(renrm) = 6.432e-01 S  T(sum) = 6.432e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.342e-04 S  per = 0.052  per(accum) = 0.052
 T(local opt: qops init                    ) = 3.402e-03 S  per = 0.529  per(accum) = 0.581
 T(local opt: symbolic_formulae_renorm     ) = 5.986e-04 S  per = 0.0931  per(accum) = 0.674
 T(local opt: allocate qops on gpu         ) = 8.328e-05 S  per = 0.0129  per(accum) = 0.687
 T(local opt: site memcpy cpu2gpu          ) = 2.329e-04 S  per = 0.0362  per(accum) = 0.723
 T(local opt: rintermediate init           ) = 2.485e-03 S  per = 0.386  per(accum) = 1.11
 T(local opt: preprocess_formulae_Rlist2   ) = 1.479e-02 S  per =  2.3  per(accum) = 3.41
 T(local opt: rmmtasks init                ) = 6.634e-03 S  per = 1.03  per(accum) = 4.44
 T(local opt: qops memset on cpu           ) = 3.600e-08 S  per = 5.6e-06  per(accum) = 4.44
 T(local opt: preprocess_renorm_batchGPU   ) = 1.787e-02 S  per = 2.78  per(accum) = 7.22
 T(local opt: deallocate cpu and gpu memory) = 6.556e-05 S  per = 0.0102  per(accum) = 7.23
 T(local opt: construct opS [ifdists=true] ) = 5.922e-01 S  per = 92.1  per(accum) = 99.3
 T(local opt: reduction of opS & opH [nccl]) = 1.900e-03 S  per = 0.295  per(accum) = 99.6
 T(local opt: qops memcpy gpu2cpu          ) = 1.320e-04 S  per = 0.0205  per(accum) = 99.6
 T(local opt: reduction of opS & opH [mpi] ) = 7.114e-05 S  per = 0.0111  per(accum) = 99.6
 T(local opt: qops_pool join and erase     ) = 2.365e-03 S  per = 0.368  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.019e-05 S  per = 0.00158  per(accum) = 100
##### sweep opt: 3.187e+01 S #####
 T(sweep opt: fetch) = 2.776e-01 S  per = 0.871  per(accum) = 0.871
 T(sweep opt: hdiag) = 5.943e+00 S  per = 18.6  per(accum) = 19.5
 T(sweep opt: dvdsn) = 1.174e+01 S  per = 36.8  per(accum) = 56.3
 T(sweep opt: decim) = 3.058e-02 S  per = 0.096  per(accum) = 56.4
 T(sweep opt: guess) = 1.921e-02 S  per = 0.0603  per(accum) = 56.5
 T(sweep opt: renrm) = 1.386e+01 S  per = 43.5  per(accum) = 100
 T(sweep opt: save ) = 5.365e-03 S  per = 0.0168  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.174e+01 S  T(sum) = 1.173e+01 S  per = 9.989e+01
 T(sweep opt: preprocess                  ) = 9.344e-02 S  per = 0.797  per(accum) = 0.797
 T(sweep opt: symbolic_formulae           ) = 8.056e-02 S  per = 0.687  per(accum) = 1.48
 T(sweep opt: hintermediate init          ) = 4.516e-03 S  per = 0.0385  per(accum) = 1.52
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.702e+00 S  per =   23  per(accum) = 24.6
 T(sweep opt: hmmtasks init               ) = 1.122e+00 S  per = 9.57  per(accum) = 34.1
 T(sweep opt: initial guess for dvdson    ) = 2.682e-02 S  per = 0.229  per(accum) = 34.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.309e+00 S  per = 53.8  per(accum) = 88.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.745e-01 S  per = 2.34  per(accum) = 90.5
 T(sweep opt: dvdson [nccl]               ) = 1.099e+00 S  per = 9.37  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 1.289e-04 S  per = 0.0011  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.311e-02 S  per = 0.112  per(accum) = 100
Detailed decomposition of T(renrm) = 1.386e+01 S  T(sum) = 1.386e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.738e-03 S  per = 0.0486  per(accum) = 0.0486
 T(sweep opt: qops init                    ) = 5.208e-02 S  per = 0.376  per(accum) = 0.424
 T(sweep opt: symbolic_formulae_renorm     ) = 2.260e-02 S  per = 0.163  per(accum) = 0.588
 T(sweep opt: allocate qops on gpu         ) = 1.597e-03 S  per = 0.0115  per(accum) = 0.599
 T(sweep opt: site memcpy cpu2gpu          ) = 3.032e-02 S  per = 0.219  per(accum) = 0.818
 T(sweep opt: rintermediate init           ) = 5.284e-02 S  per = 0.381  per(accum) = 1.2
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.168e-01 S  per = 2.29  per(accum) = 3.49
 T(sweep opt: rmmtasks init                ) = 1.577e-01 S  per = 1.14  per(accum) = 4.62
 T(sweep opt: qops memset on cpu           ) = 8.380e-07 S  per = 6.05e-06  per(accum) = 4.62
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.900e-01 S  per = 6.42  per(accum) = 11
 T(sweep opt: deallocate cpu and gpu memory) = 1.482e-03 S  per = 0.0107  per(accum) = 11.1
 T(sweep opt: construct opS [ifdists=true] ) = 1.212e+01 S  per = 87.4  per(accum) = 98.5
 T(sweep opt: reduction of opS & opH [nccl]) = 5.468e-02 S  per = 0.395  per(accum) = 98.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.253e-03 S  per = 0.0163  per(accum) = 98.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.494e-03 S  per = 0.0108  per(accum) = 98.9
 T(sweep opt: qops_pool join and erase     ) = 4.733e-02 S  per = 0.342  per(accum) = 99.3
 T(sweep opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 0.741  per(accum) = 100
##### global opt: 3.187e+01 S #####
 T(global opt: fetch) = 2.776e-01 S  per = 0.871  per(accum) = 0.871
 T(global opt: hdiag) = 5.943e+00 S  per = 18.6  per(accum) = 19.5
 T(global opt: dvdsn) = 1.174e+01 S  per = 36.8  per(accum) = 56.3
 T(global opt: decim) = 3.058e-02 S  per = 0.096  per(accum) = 56.4
 T(global opt: guess) = 1.921e-02 S  per = 0.0603  per(accum) = 56.5
 T(global opt: renrm) = 1.386e+01 S  per = 43.5  per(accum) = 100
 T(global opt: save ) = 5.365e-03 S  per = 0.0168  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.174e+01 S  T(sum) = 1.173e+01 S  per = 9.989e+01
 T(global opt: preprocess                  ) = 9.344e-02 S  per = 0.797  per(accum) = 0.797
 T(global opt: symbolic_formulae           ) = 8.056e-02 S  per = 0.687  per(accum) = 1.48
 T(global opt: hintermediate init          ) = 4.516e-03 S  per = 0.0385  per(accum) = 1.52
 T(global opt: preprocess_hformulae_Hxlist ) = 2.702e+00 S  per =   23  per(accum) = 24.6
 T(global opt: hmmtasks init               ) = 1.122e+00 S  per = 9.57  per(accum) = 34.1
 T(global opt: initial guess for dvdson    ) = 2.682e-02 S  per = 0.229  per(accum) = 34.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.309e+00 S  per = 53.8  per(accum) = 88.2
 T(global opt: dvdson [cpu-gpu]            ) = 2.745e-01 S  per = 2.34  per(accum) = 90.5
 T(global opt: dvdson [nccl]               ) = 1.099e+00 S  per = 9.37  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 1.289e-04 S  per = 0.0011  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.311e-02 S  per = 0.112  per(accum) = 100
Detailed decomposition of T(renrm) = 1.386e+01 S  T(sum) = 1.386e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.738e-03 S  per = 0.0486  per(accum) = 0.0486
 T(global opt: qops init                    ) = 5.208e-02 S  per = 0.376  per(accum) = 0.424
 T(global opt: symbolic_formulae_renorm     ) = 2.260e-02 S  per = 0.163  per(accum) = 0.588
 T(global opt: allocate qops on gpu         ) = 1.597e-03 S  per = 0.0115  per(accum) = 0.599
 T(global opt: site memcpy cpu2gpu          ) = 3.032e-02 S  per = 0.219  per(accum) = 0.818
 T(global opt: rintermediate init           ) = 5.284e-02 S  per = 0.381  per(accum) = 1.2
 T(global opt: preprocess_formulae_Rlist2   ) = 3.168e-01 S  per = 2.29  per(accum) = 3.49
 T(global opt: rmmtasks init                ) = 1.577e-01 S  per = 1.14  per(accum) = 4.62
 T(global opt: qops memset on cpu           ) = 8.380e-07 S  per = 6.05e-06  per(accum) = 4.62
 T(global opt: preprocess_renorm_batchGPU   ) = 8.900e-01 S  per = 6.42  per(accum) = 11
 T(global opt: deallocate cpu and gpu memory) = 1.482e-03 S  per = 0.0107  per(accum) = 11.1
 T(global opt: construct opS [ifdists=true] ) = 1.212e+01 S  per = 87.4  per(accum) = 98.5
 T(global opt: reduction of opS & opH [nccl]) = 5.468e-02 S  per = 0.395  per(accum) = 98.9
 T(global opt: qops memcpy gpu2cpu          ) = 2.253e-03 S  per = 0.0163  per(accum) = 98.9
 T(global opt: reduction of opS & opH [mpi] ) = 1.494e-03 S  per = 0.0108  per(accum) = 98.9
 T(global opt: qops_pool join and erase     ) = 4.733e-02 S  per = 0.342  per(accum) = 99.3
 T(global opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 0.741  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-3.608e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=24/seqsize=34 dots=2 dbond=(10,0)-(11,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=585:4.463e-03MB:4.359e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=48:3.662e-04MB:3.576e-07GB
total mem of comb=634:4.837e-03MB:4.724e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=10,8,1,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc1= 6
 suppc2= 7
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(10,0)
 fqop[3]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:10 S:5 P:49 Q:56 
        dim(bra,ket)=10,10 size(op)=40:3.052e-04MB size(tot)=2191:1.672e-02MB:1.632e-05GB
        per(mem): H:0.913 C:9.13 S:4.56 P:8.72 Q:76.7 
 rqops: oplist=HCSAB nops=H:1 C:8 S:6 A:28 B:40 
        dim(bra,ket)=10,10 size(op)=34:0.000259MB size(tot)=1584:0.0121MB:1.18e-05GB
        per(mem): H:1.26 C:11.1 S:8.33 A:11.1 B:68.2 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=5771:0.044MB:4.3e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.137e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(11,0) fdel=./scratch/sweep/lop(10,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.866e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=143:1.091e-03MB
qtensor4: wf4 own=1 _data=0x3b2f5f80
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (15,3):3 (14,2):2 (14,4):2 (15,1):1 (13,3):1 (15,5):1
 qbond: qcol nsym=6 dimAll=10
 (13,3):3 (12,2):2 (12,4):2 (11,3):1 (13,1):1 (14,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=40 nblocks=576 size=143:1.091e-03MB
### DIAG TIMING: total=5.763e-01 t1=3.199e-05, t2=7.788e-04, t3=2.489e-03, t4=5.705e-01, t5=4.367e-06, t6=2.515e-03, t7=4.512e-06
duration_diagGPU:5.763e-01
duration_diagreduce:6.700e-08
duration_diagtransform:8.600e-07
----- TIMING FOR symbolic_formulae_twodot with size=449 : 6.080e-03 S -----
rank=0 GPUmem(GB): used=4.300e-05 (oper)=4.300e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=449
 no. of hintermediate operators=226
 no. of coefficients=2834:2.162e-02MB:2.111e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.547e-04 S -----
rank=0 GPUmem(GB): used=6.411e-05 (oper,hinter)=4.300e-05,2.111e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.308e-01 S size(H_formulae)=449 size(Hxlst2)=40 T(Hmu/Hxlist)=1.219e-03,4.295e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.348e-01 S size(H_formulae)=449 size(Hxlst)=25596 -----
rank=0 GPUmem(GB): used=6.411e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=2.131e-06 batch[need]=5.340e-03 blksize=9 blksize0=9 batchsize=25596
rank=0 GPUmem(GB): used=5.406e-03 (oper,hinter,dvdson,batch)=4.300e-05,2.111e-05,2.131e-06,5.340e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=143 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.500e-03,2.636e-03,1.041e-02,1.081e-02,2.938e-02
 analyze_tgpu[Hx]: ndim=143:1.065e-06GB T(cpu-gpu)=4.519e-04 speed=4.715e-03GB/S T(nccl)=5.048e-03 speed=4.221e-04GB/S
----- TIMING FOR sigma : t_inter=2.6e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.4e-02 -----
 sigma[inter] counter=138 t=2.6e-03 per=1.1e+01 cost=1.2e+06 flops=4.4e+08
 sigma[gemm] counter=138 i=0 t=1.5e-06 per=6.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=1 t=1.2e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=2 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=3 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=4 t=2.6e-03 per=1.1e+01 cost=1.8e+05 flops=7.2e+07
 sigma[gemm] counter=138 i=5 t=2.7e-03 per=1.1e+01 cost=1.9e+05 flops=7.0e+07
 sigma[gemm] counter=138 i=6 t=2.6e-03 per=1.1e+01 cost=1.6e+05 flops=6.3e+07
 sigma[gemm] counter=138 i=7 t=2.6e-03 per=1.1e+01 cost=1.6e+05 flops=6.4e+07
 sigma[gemm] counter=138 total t=1.0e-02 per=4.4e+01 cost=7.0e+05 flops=6.7e+07
 sigma[red] counter=138 t=1.1e-02 per=4.5e+01 cost=1.9e+05 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=9.4e-01 t_gemm=3.8e+00 t_reduction=1.6e+00 tot=6.3e+00 -----
 sigma_tot[inter] counter=138 t=9.4e-01 per=1.5e+01 cost=3.1e+07 flops=3.3e+07
 sigma_tot[gemm] counter=138 i=0 t=1.8e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=1 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=2 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=3 t=1.6e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=4 t=9.5e-01 per=1.5e+01 cost=3.9e+06 flops=4.1e+06
 sigma_tot[gemm] counter=138 i=5 t=9.6e-01 per=1.5e+01 cost=3.9e+06 flops=4.1e+06
 sigma_tot[gemm] counter=138 i=6 t=9.4e-01 per=1.5e+01 cost=3.9e+06 flops=4.1e+06
 sigma_tot[gemm] counter=138 i=7 t=9.3e-01 per=1.5e+01 cost=3.9e+06 flops=4.2e+06
 sigma_tot[gemm] counter=138 total t=3.8e+00 per=6.0e+01 cost=1.6e+07 flops=4.1e+06
 sigma_tot[red] counter=138 t=1.6e+00 per=2.5e+01 cost=5.2e+06 flops=3.3e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,8.7e-06,2.8e-06,2.7e-06,2.3e-07
settings: ndim=143 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.269449192275 -1.116e+03  8.457e-02    1     1  2.969e-02 2.969e-02 2.964e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.118e-03,2.555e-03,1.037e-02,1.072e-02,3.176e-02
 analyze_tgpu[Hx]: ndim=143:1.065e-06GB T(cpu-gpu)=2.082e-03 speed=1.024e-03GB/S T(nccl)=6.036e-03 speed=3.530e-04GB/S
----- TIMING FOR sigma : t_inter=2.6e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.4e-02 -----
 sigma[inter] counter=139 t=2.6e-03 per=1.1e+01 cost=1.2e+06 flops=4.6e+08
 sigma[gemm] counter=139 i=0 t=1.4e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=1 t=1.2e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=2 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=3 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=4 t=2.6e-03 per=1.1e+01 cost=1.8e+05 flops=7.2e+07
 sigma[gemm] counter=139 i=5 t=2.7e-03 per=1.1e+01 cost=1.9e+05 flops=7.1e+07
 sigma[gemm] counter=139 i=6 t=2.6e-03 per=1.1e+01 cost=1.6e+05 flops=6.2e+07
 sigma[gemm] counter=139 i=7 t=2.5e-03 per=1.1e+01 cost=1.6e+05 flops=6.4e+07
 sigma[gemm] counter=139 total t=1.0e-02 per=4.4e+01 cost=7.0e+05 flops=6.7e+07
 sigma[red] counter=139 t=1.1e-02 per=4.5e+01 cost=1.9e+05 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=9.4e-01 t_gemm=3.8e+00 t_reduction=1.6e+00 tot=6.3e+00 -----
 sigma_tot[inter] counter=139 t=9.4e-01 per=1.5e+01 cost=3.2e+07 flops=3.5e+07
 sigma_tot[gemm] counter=139 i=0 t=1.9e-04 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=1 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=2 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=3 t=1.6e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=4 t=9.5e-01 per=1.5e+01 cost=4.1e+06 flops=4.3e+06
 sigma_tot[gemm] counter=139 i=5 t=9.6e-01 per=1.5e+01 cost=4.1e+06 flops=4.2e+06
 sigma_tot[gemm] counter=139 i=6 t=9.4e-01 per=1.5e+01 cost=4.0e+06 flops=4.3e+06
 sigma_tot[gemm] counter=139 i=7 t=9.4e-01 per=1.5e+01 cost=4.1e+06 flops=4.4e+06
 sigma_tot[gemm] counter=139 total t=3.8e+00 per=6.0e+01 cost=1.6e+07 flops=4.3e+06
 sigma_tot[red] counter=139 t=1.6e+00 per=2.5e+01 cost=5.4e+06 flops=3.4e+06
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=9.0e-06,3.7e-05,4.2e-06,1.8e-06,2.4e-07
    2   0 -    -116.288839921523 -1.939e-02  2.359e-02    2     2  6.191e-02 3.095e-02 3.082e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.934e-03,2.592e-03,1.030e-02,1.062e-02,3.246e-02
 analyze_tgpu[Hx]: ndim=143:1.065e-06GB T(cpu-gpu)=2.089e-03 speed=1.020e-03GB/S T(nccl)=6.845e-03 speed=3.113e-04GB/S
----- TIMING FOR sigma : t_inter=2.6e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.4e-02 -----
 sigma[inter] counter=140 t=2.6e-03 per=1.1e+01 cost=1.2e+06 flops=4.5e+08
 sigma[gemm] counter=140 i=0 t=1.3e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=1 t=1.2e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=2 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=3 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=4 t=2.6e-03 per=1.1e+01 cost=1.8e+05 flops=7.2e+07
 sigma[gemm] counter=140 i=5 t=2.7e-03 per=1.1e+01 cost=1.9e+05 flops=7.2e+07
 sigma[gemm] counter=140 i=6 t=2.5e-03 per=1.1e+01 cost=1.6e+05 flops=6.3e+07
 sigma[gemm] counter=140 i=7 t=2.5e-03 per=1.1e+01 cost=1.6e+05 flops=6.5e+07
 sigma[gemm] counter=140 total t=1.0e-02 per=4.4e+01 cost=7.0e+05 flops=6.8e+07
 sigma[red] counter=140 t=1.1e-02 per=4.5e+01 cost=1.9e+05 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=9.4e-01 t_gemm=3.8e+00 t_reduction=1.6e+00 tot=6.4e+00 -----
 sigma_tot[inter] counter=140 t=9.4e-01 per=1.5e+01 cost=3.4e+07 flops=3.6e+07
 sigma_tot[gemm] counter=140 i=0 t=1.9e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=1 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=2 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=3 t=1.6e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=4 t=9.6e-01 per=1.5e+01 cost=4.3e+06 flops=4.4e+06
 sigma_tot[gemm] counter=140 i=5 t=9.7e-01 per=1.5e+01 cost=4.3e+06 flops=4.4e+06
 sigma_tot[gemm] counter=140 i=6 t=9.4e-01 per=1.5e+01 cost=4.2e+06 flops=4.4e+06
 sigma_tot[gemm] counter=140 i=7 t=9.4e-01 per=1.5e+01 cost=4.3e+06 flops=4.5e+06
 sigma_tot[gemm] counter=140 total t=3.8e+00 per=6.0e+01 cost=1.7e+07 flops=4.5e+06
 sigma_tot[red] counter=140 t=1.6e+00 per=2.5e+01 cost=5.6e+06 flops=3.5e+06
T(sub)=5.1e-05 T(gemm/eig/ortho/gemm/axpy)=7.1e-06,3.9e-05,3.2e-06,1.6e-06,2.2e-07
    3   0 -    -116.290047775218 -1.208e-03  9.336e-03    3     3  9.479e-02 3.160e-02 3.146e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.746e-02,2.432e-03,6.787e-03,5.626e-03,3.232e-02
 analyze_tgpu[Hx]: ndim=143:1.065e-06GB T(cpu-gpu)=2.107e-03 speed=1.012e-03GB/S T(nccl)=1.536e-02 speed=1.388e-04GB/S
----- TIMING FOR sigma : t_inter=2.4e-03 t_gemm=6.8e-03 t_reduction=5.6e-03 tot=1.5e-02 -----
 sigma[inter] counter=141 t=2.4e-03 per=1.6e+01 cost=1.2e+06 flops=4.8e+08
 sigma[gemm] counter=141 i=0 t=1.3e-06 per=8.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=1 t=1.1e-06 per=7.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=2 t=1.1e-06 per=7.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=3 t=1.1e-06 per=7.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=4 t=6.4e-04 per=4.3e+00 cost=1.8e+05 flops=2.9e+08
 sigma[gemm] counter=141 i=5 t=1.0e-03 per=7.0e+00 cost=1.9e+05 flops=1.8e+08
 sigma[gemm] counter=141 i=6 t=2.5e-03 per=1.7e+01 cost=1.6e+05 flops=6.3e+07
 sigma[gemm] counter=141 i=7 t=2.6e-03 per=1.7e+01 cost=1.6e+05 flops=6.4e+07
 sigma[gemm] counter=141 total t=6.8e-03 per=4.6e+01 cost=7.0e+05 flops=1.0e+08
 sigma[red] counter=141 t=5.6e-03 per=3.8e+01 cost=1.9e+05 flops=3.4e+07
----- TIMING FOR sigma_tot : t_inter=9.4e-01 t_gemm=3.8e+00 t_reduction=1.6e+00 tot=6.4e+00 -----
 sigma_tot[inter] counter=141 t=9.4e-01 per=1.5e+01 cost=3.5e+07 flops=3.7e+07
 sigma_tot[gemm] counter=141 i=0 t=1.9e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=1 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=2 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=3 t=1.6e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=4 t=9.6e-01 per=1.5e+01 cost=4.4e+06 flops=4.6e+06
 sigma_tot[gemm] counter=141 i=5 t=9.7e-01 per=1.5e+01 cost=4.5e+06 flops=4.6e+06
 sigma_tot[gemm] counter=141 i=6 t=9.5e-01 per=1.5e+01 cost=4.3e+06 flops=4.6e+06
 sigma_tot[gemm] counter=141 i=7 t=9.4e-01 per=1.5e+01 cost=4.4e+06 flops=4.7e+06
 sigma_tot[gemm] counter=141 total t=3.8e+00 per=6.0e+01 cost=1.8e+07 flops=4.6e+06
 sigma_tot[red] counter=141 t=1.6e+00 per=2.5e+01 cost=5.8e+06 flops=3.6e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.4e-05,3.2e-06,1.5e-06,2.2e-07
    4   0 -    -116.290256963435 -2.092e-04  3.482e-03    3     4  1.274e-01 3.185e-02 3.172e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.951e-02,7.370e-04,5.060e-03,2.422e-03,2.774e-02
 analyze_tgpu[Hx]: ndim=143:1.065e-06GB T(cpu-gpu)=2.227e-04 speed=9.568e-03GB/S T(nccl)=1.929e-02 speed=1.105e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-04 t_gemm=5.1e-03 t_reduction=2.4e-03 tot=8.2e-03 -----
 sigma[inter] counter=142 t=7.4e-04 per=9.0e+00 cost=1.2e+06 flops=1.6e+09
 sigma[gemm] counter=142 i=0 t=1.6e-06 per=1.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=1 t=1.3e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=2 t=1.3e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=3 t=1.3e-06 per=1.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=4 t=2.5e-03 per=3.0e+01 cost=1.8e+05 flops=7.5e+07
 sigma[gemm] counter=142 i=5 t=1.0e-03 per=1.2e+01 cost=1.9e+05 flops=1.9e+08
 sigma[gemm] counter=142 i=6 t=6.3e-04 per=7.7e+00 cost=1.6e+05 flops=2.5e+08
 sigma[gemm] counter=142 i=7 t=9.5e-04 per=1.2e+01 cost=1.6e+05 flops=1.7e+08
 sigma[gemm] counter=142 total t=5.1e-03 per=6.2e+01 cost=7.0e+05 flops=1.4e+08
 sigma[red] counter=142 t=2.4e-03 per=2.9e+01 cost=1.9e+05 flops=8.0e+07
----- TIMING FOR sigma_tot : t_inter=9.4e-01 t_gemm=3.8e+00 t_reduction=1.6e+00 tot=6.4e+00 -----
 sigma_tot[inter] counter=142 t=9.4e-01 per=1.5e+01 cost=3.6e+07 flops=3.8e+07
 sigma_tot[gemm] counter=142 i=0 t=1.9e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=1 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=2 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=3 t=1.6e-04 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=4 t=9.6e-01 per=1.5e+01 cost=4.6e+06 flops=4.8e+06
 sigma_tot[gemm] counter=142 i=5 t=9.7e-01 per=1.5e+01 cost=4.7e+06 flops=4.8e+06
 sigma_tot[gemm] counter=142 i=6 t=9.5e-01 per=1.5e+01 cost=4.5e+06 flops=4.7e+06
 sigma_tot[gemm] counter=142 i=7 t=9.4e-01 per=1.5e+01 cost=4.6e+06 flops=4.9e+06
 sigma_tot[gemm] counter=142 total t=3.8e+00 per=6.0e+01 cost=1.8e+07 flops=4.8e+06
 sigma_tot[red] counter=142 t=1.6e+00 per=2.5e+01 cost=5.9e+06 flops=3.7e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.4e-05,3.3e-06,1.4e-06,2.0e-07
    5   0 -    -116.290284547794 -2.758e-05  1.128e-03    3     5  1.555e-01 3.110e-02 3.097e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.156e-02,2.550e-03,1.008e-02,1.037e-02,3.457e-02
 analyze_tgpu[Hx]: ndim=143:1.065e-06GB T(cpu-gpu)=2.092e-03 speed=1.019e-03GB/S T(nccl)=9.472e-03 speed=2.250e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.0e-02 tot=2.3e-02 -----
 sigma[inter] counter=143 t=2.5e-03 per=1.1e+01 cost=1.2e+06 flops=4.6e+08
 sigma[gemm] counter=143 i=0 t=1.3e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=1 t=1.1e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=2 t=1.1e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=3 t=1.2e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=4 t=2.5e-03 per=1.1e+01 cost=1.8e+05 flops=7.3e+07
 sigma[gemm] counter=143 i=5 t=2.6e-03 per=1.1e+01 cost=1.9e+05 flops=7.3e+07
 sigma[gemm] counter=143 i=6 t=2.5e-03 per=1.1e+01 cost=1.6e+05 flops=6.4e+07
 sigma[gemm] counter=143 i=7 t=2.5e-03 per=1.1e+01 cost=1.6e+05 flops=6.6e+07
 sigma[gemm] counter=143 total t=1.0e-02 per=4.4e+01 cost=7.0e+05 flops=6.9e+07
 sigma[red] counter=143 t=1.0e-02 per=4.5e+01 cost=1.9e+05 flops=1.9e+07
----- TIMING FOR sigma_tot : t_inter=9.5e-01 t_gemm=3.8e+00 t_reduction=1.6e+00 tot=6.4e+00 -----
 sigma_tot[inter] counter=143 t=9.5e-01 per=1.5e+01 cost=3.7e+07 flops=3.9e+07
 sigma_tot[gemm] counter=143 i=0 t=1.9e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=1 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=2 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=3 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=4 t=9.6e-01 per=1.5e+01 cost=4.8e+06 flops=5.0e+06
 sigma_tot[gemm] counter=143 i=5 t=9.7e-01 per=1.5e+01 cost=4.8e+06 flops=5.0e+06
 sigma_tot[gemm] counter=143 i=6 t=9.5e-01 per=1.5e+01 cost=4.7e+06 flops=4.9e+06
 sigma_tot[gemm] counter=143 i=7 t=9.4e-01 per=1.5e+01 cost=4.7e+06 flops=5.0e+06
 sigma_tot[gemm] counter=143 total t=3.8e+00 per=6.0e+01 cost=1.9e+07 flops=5.0e+06
 sigma_tot[red] counter=143 t=1.6e+00 per=2.5e+01 cost=6.1e+06 flops=3.8e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.4e-05,3.1e-06,1.4e-06,2.3e-07
    6   0 -    -116.290287541022 -2.993e-06  3.687e-04    3     6  1.904e-01 3.173e-02 3.161e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.161e-02,2.514e-03,1.012e-02,1.045e-02,3.470e-02
 analyze_tgpu[Hx]: ndim=143:1.065e-06GB T(cpu-gpu)=2.116e-03 speed=1.007e-03GB/S T(nccl)=9.495e-03 speed=2.244e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.0e-02 tot=2.3e-02 -----
 sigma[inter] counter=144 t=2.5e-03 per=1.1e+01 cost=1.2e+06 flops=4.6e+08
 sigma[gemm] counter=144 i=0 t=1.4e-06 per=5.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=1 t=1.2e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=2 t=1.2e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=3 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=4 t=2.5e-03 per=1.1e+01 cost=1.8e+05 flops=7.3e+07
 sigma[gemm] counter=144 i=5 t=2.6e-03 per=1.1e+01 cost=1.9e+05 flops=7.3e+07
 sigma[gemm] counter=144 i=6 t=2.5e-03 per=1.1e+01 cost=1.6e+05 flops=6.5e+07
 sigma[gemm] counter=144 i=7 t=2.5e-03 per=1.1e+01 cost=1.6e+05 flops=6.5e+07
 sigma[gemm] counter=144 total t=1.0e-02 per=4.4e+01 cost=7.0e+05 flops=6.9e+07
 sigma[red] counter=144 t=1.0e-02 per=4.5e+01 cost=1.9e+05 flops=1.9e+07
----- TIMING FOR sigma_tot : t_inter=9.5e-01 t_gemm=3.8e+00 t_reduction=1.6e+00 tot=6.4e+00 -----
 sigma_tot[inter] counter=144 t=9.5e-01 per=1.5e+01 cost=3.8e+07 flops=4.0e+07
 sigma_tot[gemm] counter=144 i=0 t=1.9e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=1 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=2 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=3 t=1.6e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=4 t=9.7e-01 per=1.5e+01 cost=5.0e+06 flops=5.2e+06
 sigma_tot[gemm] counter=144 i=5 t=9.7e-01 per=1.5e+01 cost=5.0e+06 flops=5.2e+06
 sigma_tot[gemm] counter=144 i=6 t=9.5e-01 per=1.5e+01 cost=4.8e+06 flops=5.1e+06
 sigma_tot[gemm] counter=144 i=7 t=9.5e-01 per=1.5e+01 cost=4.9e+06 flops=5.2e+06
 sigma_tot[gemm] counter=144 total t=3.8e+00 per=6.0e+01 cost=2.0e+07 flops=5.1e+06
 sigma_tot[red] counter=144 t=1.6e+00 per=2.5e+01 cost=6.3e+06 flops=3.9e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.3e-05,3.2e-06,1.4e-06,2.5e-07
    7   0 -    -116.290287851784 -3.108e-07  1.176e-04    3     7  2.254e-01 3.220e-02 3.208e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.888e-03,2.499e-03,1.016e-02,1.057e-02,3.212e-02
 analyze_tgpu[Hx]: ndim=143:1.065e-06GB T(cpu-gpu)=2.203e-03 speed=9.673e-04GB/S T(nccl)=6.685e-03 speed=3.188e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=145 t=2.5e-03 per=1.1e+01 cost=1.2e+06 flops=4.7e+08
 sigma[gemm] counter=145 i=0 t=1.3e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=1 t=1.2e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=2 t=1.2e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=3 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=4 t=2.5e-03 per=1.1e+01 cost=1.8e+05 flops=7.4e+07
 sigma[gemm] counter=145 i=5 t=2.6e-03 per=1.1e+01 cost=1.9e+05 flops=7.3e+07
 sigma[gemm] counter=145 i=6 t=2.5e-03 per=1.1e+01 cost=1.6e+05 flops=6.3e+07
 sigma[gemm] counter=145 i=7 t=2.5e-03 per=1.1e+01 cost=1.6e+05 flops=6.4e+07
 sigma[gemm] counter=145 total t=1.0e-02 per=4.4e+01 cost=7.0e+05 flops=6.9e+07
 sigma[red] counter=145 t=1.1e-02 per=4.6e+01 cost=1.9e+05 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=9.5e-01 t_gemm=3.8e+00 t_reduction=1.6e+00 tot=6.4e+00 -----
 sigma_tot[inter] counter=145 t=9.5e-01 per=1.5e+01 cost=3.9e+07 flops=4.1e+07
 sigma_tot[gemm] counter=145 i=0 t=1.9e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=1 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=2 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=3 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=4 t=9.7e-01 per=1.5e+01 cost=5.2e+06 flops=5.4e+06
 sigma_tot[gemm] counter=145 i=5 t=9.8e-01 per=1.5e+01 cost=5.2e+06 flops=5.4e+06
 sigma_tot[gemm] counter=145 i=6 t=9.6e-01 per=1.5e+01 cost=5.0e+06 flops=5.2e+06
 sigma_tot[gemm] counter=145 i=7 t=9.5e-01 per=1.5e+01 cost=5.1e+06 flops=5.3e+06
 sigma_tot[gemm] counter=145 total t=3.8e+00 per=6.0e+01 cost=2.0e+07 flops=5.3e+06
 sigma_tot[red] counter=145 t=1.6e+00 per=2.5e+01 cost=6.5e+06 flops=4.0e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.4e-05,3.2e-06,1.3e-06,2.6e-07
    8   0 +    -116.290287880175 -2.839e-08  4.285e-05    3     8  2.578e-01 3.223e-02 3.211e-02
TIMING FOR Davidson : 2.578e-01  T(cal/comm/rest)=2.569e-01,7.745e-06,9.251e-04
decomposed t_rest=9.251e-04
 T(sub)    =2.383e-04 per=2.576e+01
 T(precond)=6.714e-05 per=7.257e+00
 T(ortho)  =1.904e-05 per=2.058e+00
 T(xcopy)  =1.212e-06 per=1.310e-01
 T(xnrm2)  =3.872e-06 per=4.185e-01
 T(other)  =5.956e-04 per=6.438e+01
optimized energies: isweep=0 ibond=24 dots=2 e[0]=-116.290287880175 nmvp=8
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.258e-02 change=6.297e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond24.txt
 qbond: qsuper nsym=12 dimAll=40
 (13,3):8 (12,2):3 (12,4):3 (11,3):1 (13,1):3 (14,2):7 (15,3):4 (14,4):5 (15,1):2 (16,2):1 (13,5):2 (14,0):1
timing for divide=1.7e-04
timing for compute=1.3e-04
timing for collect=2.3e-05
----- TMING FOR decimation_genbasis(su2): 3.2e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.7e-04,1.1e-04,0.0e+00,1.8e-05,2.3e-05 -----
decimation summary: 40->10 dwt=+1.097e-03 SvN=1.133e+00
 qbond: qkept nsym=5 dimAll=10
 (14,2):3 (14,4):3 (15,3):2 (13,3):1 (13,1):1
----- TIMING for decimation_row(nkr): 8.156e-04 S T(decim/select/formRot)=4.235e-04,2.810e-04,1.110e-04 -----
----- TIMING FOR twodot_decimation: 2.162e-03 S T(wf/decim)=1.231e-03,9.313e-04 -----
ctns::oper_renorm coord=(11,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:9 S:5 A:40 B:44 
        dim(bra,ket)=10,10 size(op)=44:3.357e-04MB size(tot)=1930:1.472e-02MB:1.438e-05GB
        per(mem): H:1.24 C:9.79 S:5.44 A:6.01 B:77.5 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.257e-02 change=2.092e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=94 : 7.010e-04 S -----
rank=0 GPUmem(GB): used=6.217e-05 (oper)=3.362e-05
rank=0 GPUmem(GB): used=6.258e-05 (oper,site)=3.362e-05,4.098e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=94
 no. of rintermediate operators=5
 no. of coefficients=96:7.324e-04MB:7.153e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.432e-03 S -----
rank=0 GPUmem(GB): used=6.329e-05 (oper,site,rinter)=3.362e-05,4.098e-07,7.153e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.559e-02 S size(rtasks)=94 size(Rlst2)=25 T(Rmu/Rlist)=2.368e-04,1.536e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.574e-02 S size(rtasks)=94 size(Rlst)=1447 -----
rank=0 GPUmem(GB): used=6.329e-05 avail=6.231e+00 total=6.231e+00 batch[need]=3.019e-04 blksize=9 blksize0=9 batchsize=1447
rank=0 GPUmem(GB): used=3.652e-04 (oper,site,rinter,batch)=3.362e-05,4.098e-07,7.153e-07,3.019e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.769e-03,2.265e-02,1.009e-02
----- TIMING FOR renorm : t_inter=5.8e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=298 t=5.8e-03 per=1.5e+01 cost=1.6e+04 flops=2.7e+06
 renorm[gemm] counter=298 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=298 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=298 i=2 t=7.4e-03 per=1.9e+01 cost=2.5e+03 flops=3.3e+05
 renorm[gemm] counter=298 i=3 t=7.6e-03 per=2.0e+01 cost=2.0e+04 flops=2.7e+06
 renorm[gemm] counter=298 i=4 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=298 i=5 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=298 i=6 t=7.6e-03 per=2.0e+01 cost=2.7e+04 flops=3.6e+06
 renorm[gemm] counter=298 total t=2.3e-02 per=5.9e+01 cost=5.0e+04 flops=2.2e+06
 renorm[red] counter=298 t=1.0e-02 per=2.6e+01 cost=1.3e+04 flops=1.3e+06
----- TIMING FOR renorm_tot : t_inter=1.5e-01 t_gemm=5.4e-01 t_reduction=2.3e-01 tot=9.2e-01 -----
 renorm_tot[inter] counter=298 t=1.5e-01 per=1.7e+01 cost=4.5e+05 flops=3.0e+06
 renorm_tot[gemm] counter=298 i=0 t=3.4e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=298 i=1 t=2.9e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=298 i=2 t=5.9e-02 per=6.4e+00 cost=1.4e+04 flops=2.5e+05
 renorm_tot[gemm] counter=298 i=3 t=4.8e-02 per=5.2e+00 cost=6.2e+04 flops=1.3e+06
 renorm_tot[gemm] counter=298 i=4 t=1.3e-01 per=1.4e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=298 i=5 t=1.3e-01 per=1.4e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=298 i=6 t=1.8e-01 per=1.9e+01 cost=3.2e+05 flops=1.8e+06
 renorm_tot[gemm] counter=298 total t=5.4e-01 per=5.8e+01 cost=5.8e+05 flops=1.1e+06
 renorm_tot[red] counter=298 t=2.3e-01 per=2.5e+01 cost=1.8e+05 flops=7.7e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=7.278e-05 (optmp,oper)=1.565e-07,3.362e-05
rank=0 GPUmem(GB): used=7.319e-05 (optmp,oper,site,rinter)=1.565e-07,3.362e-05,4.098e-07,9.745e-06
rank=0 GPUmem(GB): used=9.656e-05 (optmp,oper,site,rinter,batch)=1.565e-07,3.362e-05,4.098e-07,9.745e-06,2.337e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 5.297e-01 S T(prep/alloc/comp/red/dealloc)=2.575e-02,3.179e-02,4.356e-01,5.978e-02,2.504e-03 -----
----- TIMING FOR oper_renorm_opS : 5.298e-01 S rank=0 -----
qops.to_cpu: size(tot)=1930:1.472e-02MB:1.438e-05GB T(to_cpu)=1.421e-04S speed=1.012e-01GB/S
check ||H-H.dagger||=1.083e-14 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.602 S rank=0 -----
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.199e-02 change=4.163e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=1.488e-02 change=-1.717e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=1.488e-02 change=-4.202e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 2.110e+00 S #####
 T(local opt: fetch) = 1.353e-02 S  per = 0.641  per(accum) = 0.641
 T(local opt: hdiag) = 5.776e-01 S  per = 27.4  per(accum) = 28
 T(local opt: dvdsn) = 9.097e-01 S  per = 43.1  per(accum) = 71.1
 T(local opt: decim) = 2.308e-03 S  per = 0.109  per(accum) = 71.3
 T(local opt: guess) = 1.447e-03 S  per = 0.0686  per(accum) = 71.3
 T(local opt: renrm) = 6.047e-01 S  per = 28.7  per(accum) = 100
 T(local opt: save ) = 2.776e-04 S  per = 0.0132  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.097e-01 S  T(sum) = 9.082e-01 S  per = 9.984e+01
 T(local opt: preprocess                  ) = 9.187e-03 S  per = 1.01  per(accum) = 1.01
 T(local opt: symbolic_formulae           ) = 6.098e-03 S  per = 0.671  per(accum) = 1.68
 T(local opt: hintermediate init          ) = 2.765e-04 S  per = 0.0304  per(accum) = 1.71
 T(local opt: preprocess_hformulae_Hxlist ) = 4.360e-01 S  per =   48  per(accum) = 49.7
 T(local opt: hmmtasks init               ) = 1.965e-01 S  per = 21.6  per(accum) = 71.4
 T(local opt: initial guess for dvdson    ) = 2.329e-03 S  per = 0.256  per(accum) = 71.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.653e-01 S  per = 18.2  per(accum) = 89.8
 T(local opt: dvdson [cpu-gpu]            ) = 1.336e-02 S  per = 1.47  per(accum) = 91.3
 T(local opt: dvdson [nccl]               ) = 7.822e-02 S  per = 8.61  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 7.745e-06 S  per = 0.000853  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 9.251e-04 S  per = 0.102  per(accum) = 100
Detailed decomposition of T(renrm) = 6.047e-01 S  T(sum) = 6.047e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.020e-04 S  per = 0.0499  per(accum) = 0.0499
 T(local opt: qops init                    ) = 2.855e-03 S  per = 0.472  per(accum) = 0.522
 T(local opt: symbolic_formulae_renorm     ) = 7.132e-04 S  per = 0.118  per(accum) = 0.64
 T(local opt: allocate qops on gpu         ) = 8.932e-05 S  per = 0.0148  per(accum) = 0.655
 T(local opt: site memcpy cpu2gpu          ) = 1.346e-03 S  per = 0.223  per(accum) = 0.877
 T(local opt: rintermediate init           ) = 2.445e-03 S  per = 0.404  per(accum) = 1.28
 T(local opt: preprocess_formulae_Rlist2   ) = 1.584e-02 S  per = 2.62  per(accum) = 3.9
 T(local opt: rmmtasks init                ) = 7.198e-03 S  per = 1.19  per(accum) = 5.09
 T(local opt: qops memset on cpu           ) = 4.000e-08 S  per = 6.61e-06  per(accum) = 5.09
 T(local opt: preprocess_renorm_batchGPU   ) = 3.862e-02 S  per = 6.39  per(accum) = 11.5
 T(local opt: deallocate cpu and gpu memory) = 7.018e-05 S  per = 0.0116  per(accum) = 11.5
 T(local opt: construct opS [ifdists=true] ) = 5.299e-01 S  per = 87.6  per(accum) = 99.1
 T(local opt: reduction of opS & opH [nccl]) = 2.237e-03 S  per = 0.37  per(accum) = 99.5
 T(local opt: qops memcpy gpu2cpu          ) = 1.534e-04 S  per = 0.0254  per(accum) = 99.5
 T(local opt: reduction of opS & opH [mpi] ) = 5.441e-05 S  per = 0.009  per(accum) = 99.5
 T(local opt: qops_pool join and erase     ) = 2.866e-03 S  per = 0.474  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.195e-06 S  per = 0.00136  per(accum) = 100
##### sweep opt: 3.398e+01 S #####
 T(sweep opt: fetch) = 2.911e-01 S  per = 0.857  per(accum) = 0.857
 T(sweep opt: hdiag) = 6.520e+00 S  per = 19.2  per(accum) = 20
 T(sweep opt: dvdsn) = 1.265e+01 S  per = 37.2  per(accum) = 57.3
 T(sweep opt: decim) = 3.289e-02 S  per = 0.0968  per(accum) = 57.4
 T(sweep opt: guess) = 2.065e-02 S  per = 0.0608  per(accum) = 57.4
 T(sweep opt: renrm) = 1.446e+01 S  per = 42.6  per(accum) = 100
 T(sweep opt: save ) = 5.642e-03 S  per = 0.0166  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.265e+01 S  T(sum) = 1.263e+01 S  per = 9.989e+01
 T(sweep opt: preprocess                  ) = 1.026e-01 S  per = 0.812  per(accum) = 0.812
 T(sweep opt: symbolic_formulae           ) = 8.666e-02 S  per = 0.686  per(accum) = 1.5
 T(sweep opt: hintermediate init          ) = 4.793e-03 S  per = 0.0379  per(accum) = 1.54
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.138e+00 S  per = 24.8  per(accum) = 26.4
 T(sweep opt: hmmtasks init               ) = 1.319e+00 S  per = 10.4  per(accum) = 36.8
 T(sweep opt: initial guess for dvdson    ) = 2.915e-02 S  per = 0.231  per(accum) = 37
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.475e+00 S  per = 51.2  per(accum) = 88.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.879e-01 S  per = 2.28  per(accum) = 90.6
 T(sweep opt: dvdson [nccl]               ) = 1.177e+00 S  per = 9.32  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 1.366e-04 S  per = 0.00108  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.403e-02 S  per = 0.111  per(accum) = 100
Detailed decomposition of T(renrm) = 1.446e+01 S  T(sum) = 1.446e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.040e-03 S  per = 0.0487  per(accum) = 0.0487
 T(sweep opt: qops init                    ) = 5.493e-02 S  per = 0.38  per(accum) = 0.429
 T(sweep opt: symbolic_formulae_renorm     ) = 2.332e-02 S  per = 0.161  per(accum) = 0.59
 T(sweep opt: allocate qops on gpu         ) = 1.686e-03 S  per = 0.0117  per(accum) = 0.601
 T(sweep opt: site memcpy cpu2gpu          ) = 3.166e-02 S  per = 0.219  per(accum) = 0.82
 T(sweep opt: rintermediate init           ) = 5.528e-02 S  per = 0.382  per(accum) = 1.2
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.327e-01 S  per =  2.3  per(accum) = 3.5
 T(sweep opt: rmmtasks init                ) = 1.649e-01 S  per = 1.14  per(accum) = 4.64
 T(sweep opt: qops memset on cpu           ) = 8.780e-07 S  per = 6.07e-06  per(accum) = 4.64
 T(sweep opt: preprocess_renorm_batchGPU   ) = 9.286e-01 S  per = 6.42  per(accum) = 11.1
 T(sweep opt: deallocate cpu and gpu memory) = 1.552e-03 S  per = 0.0107  per(accum) = 11.1
 T(sweep opt: construct opS [ifdists=true] ) = 1.265e+01 S  per = 87.4  per(accum) = 98.5
 T(sweep opt: reduction of opS & opH [nccl]) = 5.692e-02 S  per = 0.394  per(accum) = 98.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.407e-03 S  per = 0.0166  per(accum) = 98.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.548e-03 S  per = 0.0107  per(accum) = 98.9
 T(sweep opt: qops_pool join and erase     ) = 5.020e-02 S  per = 0.347  per(accum) = 99.3
 T(sweep opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 0.71  per(accum) = 100
##### global opt: 3.398e+01 S #####
 T(global opt: fetch) = 2.911e-01 S  per = 0.857  per(accum) = 0.857
 T(global opt: hdiag) = 6.520e+00 S  per = 19.2  per(accum) = 20
 T(global opt: dvdsn) = 1.265e+01 S  per = 37.2  per(accum) = 57.3
 T(global opt: decim) = 3.289e-02 S  per = 0.0968  per(accum) = 57.4
 T(global opt: guess) = 2.065e-02 S  per = 0.0608  per(accum) = 57.4
 T(global opt: renrm) = 1.446e+01 S  per = 42.6  per(accum) = 100
 T(global opt: save ) = 5.642e-03 S  per = 0.0166  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.265e+01 S  T(sum) = 1.263e+01 S  per = 9.989e+01
 T(global opt: preprocess                  ) = 1.026e-01 S  per = 0.812  per(accum) = 0.812
 T(global opt: symbolic_formulae           ) = 8.666e-02 S  per = 0.686  per(accum) = 1.5
 T(global opt: hintermediate init          ) = 4.793e-03 S  per = 0.0379  per(accum) = 1.54
 T(global opt: preprocess_hformulae_Hxlist ) = 3.138e+00 S  per = 24.8  per(accum) = 26.4
 T(global opt: hmmtasks init               ) = 1.319e+00 S  per = 10.4  per(accum) = 36.8
 T(global opt: initial guess for dvdson    ) = 2.915e-02 S  per = 0.231  per(accum) = 37
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.475e+00 S  per = 51.2  per(accum) = 88.3
 T(global opt: dvdson [cpu-gpu]            ) = 2.879e-01 S  per = 2.28  per(accum) = 90.6
 T(global opt: dvdson [nccl]               ) = 1.177e+00 S  per = 9.32  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 1.366e-04 S  per = 0.00108  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.403e-02 S  per = 0.111  per(accum) = 100
Detailed decomposition of T(renrm) = 1.446e+01 S  T(sum) = 1.446e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.040e-03 S  per = 0.0487  per(accum) = 0.0487
 T(global opt: qops init                    ) = 5.493e-02 S  per = 0.38  per(accum) = 0.429
 T(global opt: symbolic_formulae_renorm     ) = 2.332e-02 S  per = 0.161  per(accum) = 0.59
 T(global opt: allocate qops on gpu         ) = 1.686e-03 S  per = 0.0117  per(accum) = 0.601
 T(global opt: site memcpy cpu2gpu          ) = 3.166e-02 S  per = 0.219  per(accum) = 0.82
 T(global opt: rintermediate init           ) = 5.528e-02 S  per = 0.382  per(accum) = 1.2
 T(global opt: preprocess_formulae_Rlist2   ) = 3.327e-01 S  per =  2.3  per(accum) = 3.5
 T(global opt: rmmtasks init                ) = 1.649e-01 S  per = 1.14  per(accum) = 4.64
 T(global opt: qops memset on cpu           ) = 8.780e-07 S  per = 6.07e-06  per(accum) = 4.64
 T(global opt: preprocess_renorm_batchGPU   ) = 9.286e-01 S  per = 6.42  per(accum) = 11.1
 T(global opt: deallocate cpu and gpu memory) = 1.552e-03 S  per = 0.0107  per(accum) = 11.1
 T(global opt: construct opS [ifdists=true] ) = 1.265e+01 S  per = 87.4  per(accum) = 98.5
 T(global opt: reduction of opS & opH [nccl]) = 5.692e-02 S  per = 0.394  per(accum) = 98.9
 T(global opt: qops memcpy gpu2cpu          ) = 2.407e-03 S  per = 0.0166  per(accum) = 98.9
 T(global opt: reduction of opS & opH [mpi] ) = 1.548e-03 S  per = 0.0107  per(accum) = 98.9
 T(global opt: qops_pool join and erase     ) = 5.020e-02 S  per = 0.347  per(accum) = 99.3
 T(global opt: conversion from opAB to opPQ ) = 1.027e-01 S  per = 0.71  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-6.244e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=25/seqsize=34 dots=2 dbond=(9,0)-(10,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=604:4.608e-03MB:4.500e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=56:4.272e-04MB:4.172e-07GB
total mem of comb=661:5.043e-03MB:4.925e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=9,9,1,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc1= 5
 suppc2= 6
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(9,0)
 fqop[3]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=HCSPQ nops=H:1 C:9 S:6 P:59 Q:66 
        dim(bra,ket)=10,10 size(op)=35:2.670e-04MB size(tot)=2126:1.622e-02MB:1.584e-05GB
        per(mem): H:0.753 C:7.2 S:4.8 P:8.09 Q:79.2 
 rqops: oplist=HCSAB nops=H:1 C:9 S:5 A:40 B:44 
        dim(bra,ket)=10,10 size(op)=44:0.000336MB size(tot)=1930:0.0147MB:1.44e-05GB
        per(mem): H:1.24 C:9.79 S:5.44 A:6.01 B:77.5 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=6052:0.0462MB:4.51e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.303e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(10,0) fdel=./scratch/sweep/lop(9,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.866e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=147:1.122e-03MB
qtensor4: wf4 own=1 _data=0x3b659e00
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=7 dimAll=10
 (14,2):2 (13,1):2 (13,3):2 (12,2):1 (14,4):1 (13,5):1 (14,0):1
 qbond: qcol nsym=5 dimAll=10
 (14,2):3 (14,4):3 (15,3):2 (13,3):1 (13,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=42 nblocks=540 size=147:1.122e-03MB
### DIAG TIMING: total=6.622e-01 t1=2.822e-05, t2=8.156e-04, t3=2.512e-03, t4=6.277e-01, t5=3.852e-06, t6=3.115e-02, t7=6.312e-06
duration_diagGPU:6.623e-01
duration_diagreduce:6.800e-08
duration_diagtransform:7.190e-07
----- TIMING FOR symbolic_formulae_twodot with size=523 : 6.985e-03 S -----
rank=0 GPUmem(GB): used=4.509e-05 (oper)=4.509e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=523
 no. of hintermediate operators=259
 no. of coefficients=3136:2.393e-02MB:2.337e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.580e-04 S -----
rank=0 GPUmem(GB): used=6.846e-05 (oper,hinter)=4.509e-05,2.337e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.180e-01 S size(H_formulae)=523 size(Hxlst2)=42 T(Hmu/Hxlist)=1.389e-03,5.166e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.222e-01 S size(H_formulae)=523 size(Hxlst)=30896 -----
rank=0 GPUmem(GB): used=6.846e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=2.190e-06 batch[need]=5.064e-03 blksize=6 blksize0=9 batchsize=30896
rank=0 GPUmem(GB): used=5.135e-03 (oper,hinter,dvdson,batch)=4.509e-05,2.337e-05,2.190e-06,5.064e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=147 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.206e-02,2.636e-03,9.950e-03,4.368e-03,2.903e-02
 analyze_tgpu[Hx]: ndim=147:1.095e-06GB T(cpu-gpu)=5.177e-04 speed=4.231e-03GB/S T(nccl)=1.154e-02 speed=1.898e-04GB/S
----- TIMING FOR sigma : t_inter=2.6e-03 t_gemm=9.9e-03 t_reduction=4.4e-03 tot=1.7e-02 -----
 sigma[inter] counter=146 t=2.6e-03 per=1.6e+01 cost=1.5e+06 flops=5.5e+08
 sigma[gemm] counter=146 i=0 t=1.5e-06 per=9.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=1 t=1.2e-06 per=7.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=2 t=1.2e-06 per=6.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=3 t=1.1e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=4 t=2.6e-03 per=1.5e+01 cost=2.7e+05 flops=1.0e+08
 sigma[gemm] counter=146 i=5 t=2.9e-03 per=1.7e+01 cost=2.7e+05 flops=9.2e+07
 sigma[gemm] counter=146 i=6 t=2.5e-03 per=1.5e+01 cost=1.6e+05 flops=6.3e+07
 sigma[gemm] counter=146 i=7 t=1.9e-03 per=1.1e+01 cost=1.5e+05 flops=8.1e+07
 sigma[gemm] counter=146 total t=9.9e-03 per=5.9e+01 cost=8.5e+05 flops=8.5e+07
 sigma[red] counter=146 t=4.4e-03 per=2.6e+01 cost=2.3e+05 flops=5.3e+07
----- TIMING FOR sigma_tot : t_inter=9.5e-01 t_gemm=3.9e+00 t_reduction=1.6e+00 tot=6.5e+00 -----
 sigma_tot[inter] counter=146 t=9.5e-01 per=1.5e+01 cost=4.1e+07 flops=4.3e+07
 sigma_tot[gemm] counter=146 i=0 t=2.0e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=1 t=1.7e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=2 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=3 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=4 t=9.7e-01 per=1.5e+01 cost=5.4e+06 flops=5.6e+06
 sigma_tot[gemm] counter=146 i=5 t=9.8e-01 per=1.5e+01 cost=5.5e+06 flops=5.6e+06
 sigma_tot[gemm] counter=146 i=6 t=9.6e-01 per=1.5e+01 cost=5.1e+06 flops=5.4e+06
 sigma_tot[gemm] counter=146 i=7 t=9.5e-01 per=1.5e+01 cost=5.2e+06 flops=5.5e+06
 sigma_tot[gemm] counter=146 total t=3.9e+00 per=6.0e+01 cost=2.1e+07 flops=5.5e+06
 sigma_tot[red] counter=146 t=1.6e+00 per=2.5e+01 cost=6.8e+06 flops=4.1e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=7.1e-06,9.9e-06,2.5e-06,3.0e-06,4.2e-07
settings: ndim=147 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.289362467359 -1.116e+03  4.972e-02    1     1  2.930e-02 2.930e-02 2.924e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.084e-03,8.153e-04,8.591e-03,1.078e-02,2.528e-02
 analyze_tgpu[Hx]: ndim=147:1.095e-06GB T(cpu-gpu)=1.615e-03 speed=1.356e-03GB/S T(nccl)=3.469e-03 speed=6.314e-04GB/S
----- TIMING FOR sigma : t_inter=8.1e-04 t_gemm=8.6e-03 t_reduction=1.1e-02 tot=2.0e-02 -----
 sigma[inter] counter=147 t=8.1e-04 per=4.0e+00 cost=1.5e+06 flops=1.8e+09
 sigma[gemm] counter=147 i=0 t=1.6e-06 per=8.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=1 t=1.4e-06 per=6.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=2 t=1.3e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=3 t=1.3e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=4 t=7.8e-04 per=3.9e+00 cost=2.7e+05 flops=3.5e+08
 sigma[gemm] counter=147 i=5 t=2.8e-03 per=1.4e+01 cost=2.7e+05 flops=9.7e+07
 sigma[gemm] counter=147 i=6 t=2.5e-03 per=1.2e+01 cost=1.6e+05 flops=6.3e+07
 sigma[gemm] counter=147 i=7 t=2.5e-03 per=1.3e+01 cost=1.5e+05 flops=6.0e+07
 sigma[gemm] counter=147 total t=8.6e-03 per=4.3e+01 cost=8.5e+05 flops=9.9e+07
 sigma[red] counter=147 t=1.1e-02 per=5.3e+01 cost=2.3e+05 flops=2.1e+07
----- TIMING FOR sigma_tot : t_inter=9.6e-01 t_gemm=3.9e+00 t_reduction=1.7e+00 tot=6.5e+00 -----
 sigma_tot[inter] counter=147 t=9.6e-01 per=1.5e+01 cost=4.2e+07 flops=4.4e+07
 sigma_tot[gemm] counter=147 i=0 t=2.0e-04 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=1 t=1.7e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=2 t=1.7e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=3 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=4 t=9.7e-01 per=1.5e+01 cost=5.7e+06 flops=5.9e+06
 sigma_tot[gemm] counter=147 i=5 t=9.8e-01 per=1.5e+01 cost=5.8e+06 flops=5.9e+06
 sigma_tot[gemm] counter=147 i=6 t=9.6e-01 per=1.5e+01 cost=5.3e+06 flops=5.5e+06
 sigma_tot[gemm] counter=147 i=7 t=9.5e-01 per=1.5e+01 cost=5.4e+06 flops=5.6e+06
 sigma_tot[gemm] counter=147 total t=3.9e+00 per=6.0e+01 cost=2.2e+07 flops=5.7e+06
 sigma_tot[red] counter=147 t=1.7e+00 per=2.6e+01 cost=7.0e+06 flops=4.2e+06
T(sub)=5.4e-05 T(gemm/eig/ortho/gemm/axpy)=9.6e-06,3.8e-05,4.1e-06,2.2e-06,3.1e-07
    2   0 -    -116.296236421543 -6.874e-03  1.583e-02    2     2  5.492e-02 2.746e-02 2.733e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.073e-03,2.505e-03,1.022e-02,1.073e-02,3.054e-02
 analyze_tgpu[Hx]: ndim=147:1.095e-06GB T(cpu-gpu)=2.179e-03 speed=1.005e-03GB/S T(nccl)=4.895e-03 speed=4.475e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=148 t=2.5e-03 per=1.1e+01 cost=1.5e+06 flops=5.8e+08
 sigma[gemm] counter=148 i=0 t=1.4e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=1 t=1.2e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=2 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=3 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=4 t=2.5e-03 per=1.1e+01 cost=2.7e+05 flops=1.1e+08
 sigma[gemm] counter=148 i=5 t=2.7e-03 per=1.2e+01 cost=2.7e+05 flops=9.8e+07
 sigma[gemm] counter=148 i=6 t=2.4e-03 per=1.0e+01 cost=1.6e+05 flops=6.5e+07
 sigma[gemm] counter=148 i=7 t=2.5e-03 per=1.1e+01 cost=1.5e+05 flops=6.1e+07
 sigma[gemm] counter=148 total t=1.0e-02 per=4.4e+01 cost=8.5e+05 flops=8.3e+07
 sigma[red] counter=148 t=1.1e-02 per=4.6e+01 cost=2.3e+05 flops=2.1e+07
----- TIMING FOR sigma_tot : t_inter=9.6e-01 t_gemm=3.9e+00 t_reduction=1.7e+00 tot=6.5e+00 -----
 sigma_tot[inter] counter=148 t=9.6e-01 per=1.5e+01 cost=4.4e+07 flops=4.6e+07
 sigma_tot[gemm] counter=148 i=0 t=2.0e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=1 t=1.7e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=2 t=1.7e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=3 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=4 t=9.7e-01 per=1.5e+01 cost=6.0e+06 flops=6.2e+06
 sigma_tot[gemm] counter=148 i=5 t=9.8e-01 per=1.5e+01 cost=6.0e+06 flops=6.1e+06
 sigma_tot[gemm] counter=148 i=6 t=9.6e-01 per=1.5e+01 cost=5.4e+06 flops=5.7e+06
 sigma_tot[gemm] counter=148 i=7 t=9.6e-01 per=1.5e+01 cost=5.5e+06 flops=5.8e+06
 sigma_tot[gemm] counter=148 total t=3.9e+00 per=6.0e+01 cost=2.3e+07 flops=5.9e+06
 sigma_tot[red] counter=148 t=1.7e+00 per=2.6e+01 cost=7.2e+06 flops=4.3e+06
T(sub)=5.0e-05 T(gemm/eig/ortho/gemm/axpy)=6.4e-06,3.8e-05,3.5e-06,1.6e-06,2.2e-07
    3   0 -    -116.296829050075 -5.926e-04  5.577e-03    3     3  8.581e-02 2.860e-02 2.846e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.990e-03,2.549e-03,1.019e-02,1.069e-02,3.043e-02
 analyze_tgpu[Hx]: ndim=147:1.095e-06GB T(cpu-gpu)=2.126e-03 speed=1.030e-03GB/S T(nccl)=4.863e-03 speed=4.504e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=149 t=2.5e-03 per=1.1e+01 cost=1.5e+06 flops=5.7e+08
 sigma[gemm] counter=149 i=0 t=1.3e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=1 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=2 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=3 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=4 t=2.5e-03 per=1.1e+01 cost=2.7e+05 flops=1.1e+08
 sigma[gemm] counter=149 i=5 t=2.7e-03 per=1.1e+01 cost=2.7e+05 flops=1.0e+08
 sigma[gemm] counter=149 i=6 t=2.5e-03 per=1.1e+01 cost=1.6e+05 flops=6.4e+07
 sigma[gemm] counter=149 i=7 t=2.5e-03 per=1.1e+01 cost=1.5e+05 flops=6.1e+07
 sigma[gemm] counter=149 total t=1.0e-02 per=4.4e+01 cost=8.5e+05 flops=8.3e+07
 sigma[red] counter=149 t=1.1e-02 per=4.6e+01 cost=2.3e+05 flops=2.2e+07
----- TIMING FOR sigma_tot : t_inter=9.6e-01 t_gemm=3.9e+00 t_reduction=1.7e+00 tot=6.5e+00 -----
 sigma_tot[inter] counter=149 t=9.6e-01 per=1.5e+01 cost=4.5e+07 flops=4.7e+07
 sigma_tot[gemm] counter=149 i=0 t=2.0e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=1 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=2 t=1.7e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=3 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=4 t=9.8e-01 per=1.5e+01 cost=6.3e+06 flops=6.4e+06
 sigma_tot[gemm] counter=149 i=5 t=9.9e-01 per=1.5e+01 cost=6.3e+06 flops=6.4e+06
 sigma_tot[gemm] counter=149 i=6 t=9.6e-01 per=1.5e+01 cost=5.6e+06 flops=5.8e+06
 sigma_tot[gemm] counter=149 i=7 t=9.6e-01 per=1.5e+01 cost=5.7e+06 flops=5.9e+06
 sigma_tot[gemm] counter=149 total t=3.9e+00 per=6.0e+01 cost=2.4e+07 flops=6.1e+06
 sigma_tot[red] counter=149 t=1.7e+00 per=2.6e+01 cost=7.4e+06 flops=4.4e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.4e-05,3.3e-06,1.4e-06,2.4e-07
    4   0 -    -116.296895689656 -6.664e-05  2.184e-03    3     4  1.164e-01 2.911e-02 2.899e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.581e-03,2.547e-03,1.030e-02,1.056e-02,3.199e-02
 analyze_tgpu[Hx]: ndim=147:1.095e-06GB T(cpu-gpu)=2.284e-03 speed=9.589e-04GB/S T(nccl)=6.296e-03 speed=3.479e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=150 t=2.5e-03 per=1.1e+01 cost=1.5e+06 flops=5.7e+08
 sigma[gemm] counter=150 i=0 t=1.4e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=1 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=2 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=3 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=4 t=2.5e-03 per=1.1e+01 cost=2.7e+05 flops=1.1e+08
 sigma[gemm] counter=150 i=5 t=2.7e-03 per=1.2e+01 cost=2.7e+05 flops=9.8e+07
 sigma[gemm] counter=150 i=6 t=2.5e-03 per=1.1e+01 cost=1.6e+05 flops=6.3e+07
 sigma[gemm] counter=150 i=7 t=2.5e-03 per=1.1e+01 cost=1.5e+05 flops=6.1e+07
 sigma[gemm] counter=150 total t=1.0e-02 per=4.4e+01 cost=8.5e+05 flops=8.2e+07
 sigma[red] counter=150 t=1.1e-02 per=4.5e+01 cost=2.3e+05 flops=2.2e+07
----- TIMING FOR sigma_tot : t_inter=9.6e-01 t_gemm=3.9e+00 t_reduction=1.7e+00 tot=6.6e+00 -----
 sigma_tot[inter] counter=150 t=9.6e-01 per=1.5e+01 cost=4.7e+07 flops=4.9e+07
 sigma_tot[gemm] counter=150 i=0 t=2.0e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=1 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=2 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=3 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=4 t=9.8e-01 per=1.5e+01 cost=6.5e+06 flops=6.7e+06
 sigma_tot[gemm] counter=150 i=5 t=9.9e-01 per=1.5e+01 cost=6.6e+06 flops=6.6e+06
 sigma_tot[gemm] counter=150 i=6 t=9.7e-01 per=1.5e+01 cost=5.8e+06 flops=6.0e+06
 sigma_tot[gemm] counter=150 i=7 t=9.6e-01 per=1.5e+01 cost=5.8e+06 flops=6.1e+06
 sigma_tot[gemm] counter=150 total t=3.9e+00 per=6.0e+01 cost=2.5e+07 flops=6.3e+06
 sigma_tot[red] counter=150 t=1.7e+00 per=2.6e+01 cost=7.7e+06 flops=4.5e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.4e-05,3.3e-06,1.4e-06,2.5e-07
    5   0 -    -116.296904555737 -8.866e-06  7.114e-04    3     5  1.488e-01 2.975e-02 2.963e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.439e-03,2.509e-03,1.026e-02,1.073e-02,3.195e-02
 analyze_tgpu[Hx]: ndim=147:1.095e-06GB T(cpu-gpu)=2.118e-03 speed=1.034e-03GB/S T(nccl)=6.321e-03 speed=3.465e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=151 t=2.5e-03 per=1.1e+01 cost=1.5e+06 flops=5.8e+08
 sigma[gemm] counter=151 i=0 t=1.2e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=1 t=1.2e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=2 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=3 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=4 t=2.5e-03 per=1.1e+01 cost=2.7e+05 flops=1.1e+08
 sigma[gemm] counter=151 i=5 t=2.7e-03 per=1.2e+01 cost=2.7e+05 flops=9.8e+07
 sigma[gemm] counter=151 i=6 t=2.5e-03 per=1.1e+01 cost=1.6e+05 flops=6.4e+07
 sigma[gemm] counter=151 i=7 t=2.5e-03 per=1.1e+01 cost=1.5e+05 flops=6.0e+07
 sigma[gemm] counter=151 total t=1.0e-02 per=4.4e+01 cost=8.5e+05 flops=8.3e+07
 sigma[red] counter=151 t=1.1e-02 per=4.6e+01 cost=2.3e+05 flops=2.1e+07
----- TIMING FOR sigma_tot : t_inter=9.7e-01 t_gemm=3.9e+00 t_reduction=1.7e+00 tot=6.6e+00 -----
 sigma_tot[inter] counter=151 t=9.7e-01 per=1.5e+01 cost=4.8e+07 flops=5.0e+07
 sigma_tot[gemm] counter=151 i=0 t=2.0e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=1 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=2 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=3 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=4 t=9.8e-01 per=1.5e+01 cost=6.8e+06 flops=6.9e+06
 sigma_tot[gemm] counter=151 i=5 t=9.9e-01 per=1.5e+01 cost=6.8e+06 flops=6.9e+06
 sigma_tot[gemm] counter=151 i=6 t=9.7e-01 per=1.5e+01 cost=5.9e+06 flops=6.1e+06
 sigma_tot[gemm] counter=151 i=7 t=9.6e-01 per=1.5e+01 cost=6.0e+06 flops=6.2e+06
 sigma_tot[gemm] counter=151 total t=3.9e+00 per=5.9e+01 cost=2.6e+07 flops=6.5e+06
 sigma_tot[red] counter=151 t=1.7e+00 per=2.6e+01 cost=7.9e+06 flops=4.6e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.4e-05,3.2e-06,1.3e-06,2.5e-07
    6   0 -    -116.296905634181 -1.078e-06  2.168e-04    3     6  1.810e-01 3.016e-02 3.005e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.573e-03,2.511e-03,1.034e-02,1.080e-02,3.223e-02
 analyze_tgpu[Hx]: ndim=147:1.095e-06GB T(cpu-gpu)=2.151e-03 speed=1.018e-03GB/S T(nccl)=6.422e-03 speed=3.411e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.4e-02 -----
 sigma[inter] counter=152 t=2.5e-03 per=1.1e+01 cost=1.5e+06 flops=5.8e+08
 sigma[gemm] counter=152 i=0 t=1.3e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=1 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=2 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=3 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=4 t=2.5e-03 per=1.1e+01 cost=2.7e+05 flops=1.1e+08
 sigma[gemm] counter=152 i=5 t=2.8e-03 per=1.2e+01 cost=2.7e+05 flops=9.8e+07
 sigma[gemm] counter=152 i=6 t=2.5e-03 per=1.1e+01 cost=1.6e+05 flops=6.3e+07
 sigma[gemm] counter=152 i=7 t=2.5e-03 per=1.1e+01 cost=1.5e+05 flops=6.0e+07
 sigma[gemm] counter=152 total t=1.0e-02 per=4.4e+01 cost=8.5e+05 flops=8.2e+07
 sigma[red] counter=152 t=1.1e-02 per=4.6e+01 cost=2.3e+05 flops=2.1e+07
----- TIMING FOR sigma_tot : t_inter=9.7e-01 t_gemm=3.9e+00 t_reduction=1.7e+00 tot=6.6e+00 -----
 sigma_tot[inter] counter=152 t=9.7e-01 per=1.5e+01 cost=5.0e+07 flops=5.1e+07
 sigma_tot[gemm] counter=152 i=0 t=2.0e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=1 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=2 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=3 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=4 t=9.8e-01 per=1.5e+01 cost=7.1e+06 flops=7.2e+06
 sigma_tot[gemm] counter=152 i=5 t=1.0e+00 per=1.5e+01 cost=7.1e+06 flops=7.1e+06
 sigma_tot[gemm] counter=152 i=6 t=9.7e-01 per=1.5e+01 cost=6.1e+06 flops=6.2e+06
 sigma_tot[gemm] counter=152 i=7 t=9.7e-01 per=1.5e+01 cost=6.1e+06 flops=6.3e+06
 sigma_tot[gemm] counter=152 total t=3.9e+00 per=5.9e+01 cost=2.6e+07 flops=6.7e+06
 sigma_tot[red] counter=152 t=1.7e+00 per=2.6e+01 cost=8.1e+06 flops=4.8e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.4e-05,3.3e-06,1.5e-06,2.0e-07
    7   0 +    -116.296905733366 -9.918e-08  6.439e-05    3     7  2.135e-01 3.050e-02 3.040e-02
TIMING FOR Davidson : 2.135e-01  T(cal/comm/rest)=2.128e-01,7.871e-06,7.663e-04
decomposed t_rest=7.663e-04
 T(sub)    =2.208e-04 per=2.881e+01
 T(precond)=5.782e-05 per=7.546e+00
 T(ortho)  =1.718e-05 per=2.242e+00
 T(xcopy)  =1.002e-06 per=1.308e-01
 T(xnrm2)  =3.452e-06 per=4.505e-01
 T(other)  =4.660e-04 per=6.082e+01
optimized energies: isweep=0 ibond=25 dots=2 e[0]=-116.296905733366 nmvp=7
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.480e-02 change=7.475e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond25.txt
 qbond: qsuper nsym=11 dimAll=40
 (14,2):5 (14,4):4 (15,3):9 (13,3):1 (13,1):1 (16,2):5 (16,4):5 (17,3):2 (15,1):4 (15,5):3 (14,0):1
timing for divide=1.6e-04
timing for compute=1.8e-04
timing for collect=2.3e-05
----- TMING FOR decimation_genbasis(su2): 3.6e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.6e-04,1.3e-04,0.0e+00,5.3e-05,2.3e-05 -----
decimation summary: 40->10 dwt=+5.421e-04 SvN=1.118e+00
 qbond: qkept nsym=6 dimAll=10
 (15,3):3 (16,2):2 (15,1):2 (16,4):1 (17,3):1 (15,5):1
----- TIMING for decimation_row(nkr): 8.239e-04 S T(decim/select/formRot)=4.286e-04,3.019e-04,9.340e-05 -----
----- TIMING FOR twodot_decimation: 2.130e-03 S T(wf/decim)=1.202e-03,9.284e-04 -----
ctns::oper_renorm coord=(10,0) superblock=cr oplist=HCSAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSAB nops=H:1 C:10 S:5 A:49 B:56 
        dim(bra,ket)=10,10 size(op)=42:3.204e-04MB size(tot)=2224:1.697e-02MB:1.657e-05GB
        per(mem): H:0.899 C:7.64 S:3.82 A:9.58 B:78.1 
rank=0 CPUmem(GB): used=1.015e+00 pageheap_free=1.475e-02 change=3.306e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=116 : 8.673e-04 S -----
rank=0 GPUmem(GB): used=6.919e-05 (oper)=3.839e-05
rank=0 GPUmem(GB): used=6.960e-05 (oper,site)=3.839e-05,4.098e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=116
 no. of rintermediate operators=5
 no. of coefficients=110:8.392e-04MB:8.196e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.440e-03 S -----
rank=0 GPUmem(GB): used=7.042e-05 (oper,site,rinter)=3.839e-05,4.098e-07,8.196e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.536e-02 S size(rtasks)=116 size(Rlst2)=36 T(Rmu/Rlist)=3.065e-04,1.505e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.551e-02 S size(rtasks)=116 size(Rlst)=1394 -----
rank=0 GPUmem(GB): used=7.042e-05 avail=6.231e+00 total=6.231e+00 batch[need]=2.908e-04 blksize=9 blksize0=9 batchsize=1394
rank=0 GPUmem(GB): used=3.612e-04 (oper,site,rinter,batch)=3.839e-05,4.098e-07,8.196e-07,2.908e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.962e-03,2.249e-02,1.000e-02
----- TIMING FOR renorm : t_inter=6.0e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=310 t=6.0e-03 per=1.6e+01 cost=2.3e+04 flops=3.9e+06
 renorm[gemm] counter=310 i=0 t=1.4e-06 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=310 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=310 i=2 t=7.5e-03 per=1.9e+01 cost=4.8e+03 flops=6.4e+05
 renorm[gemm] counter=310 i=3 t=7.5e-03 per=1.9e+01 cost=3.0e+04 flops=4.0e+06
 renorm[gemm] counter=310 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=310 i=5 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=310 i=6 t=7.5e-03 per=2.0e+01 cost=3.0e+04 flops=4.0e+06
 renorm[gemm] counter=310 total t=2.2e-02 per=5.8e+01 cost=6.5e+04 flops=2.9e+06
 renorm[red] counter=310 t=1.0e-02 per=2.6e+01 cost=1.3e+04 flops=1.3e+06
----- TIMING FOR renorm_tot : t_inter=1.6e-01 t_gemm=5.6e-01 t_reduction=2.4e-01 tot=9.6e-01 -----
 renorm_tot[inter] counter=310 t=1.6e-01 per=1.6e+01 cost=4.8e+05 flops=3.0e+06
 renorm_tot[gemm] counter=310 i=0 t=3.5e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=310 i=1 t=3.0e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=310 i=2 t=6.7e-02 per=6.9e+00 cost=1.9e+04 flops=2.9e+05
 renorm_tot[gemm] counter=310 i=3 t=5.6e-02 per=5.8e+00 cost=9.2e+04 flops=1.7e+06
 renorm_tot[gemm] counter=310 i=4 t=1.3e-01 per=1.3e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=310 i=5 t=1.3e-01 per=1.3e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=310 i=6 t=1.8e-01 per=1.9e+01 cost=3.5e+05 flops=1.9e+06
 renorm_tot[gemm] counter=310 total t=5.6e-01 per=5.8e+01 cost=6.5e+05 flops=1.2e+06
 renorm_tot[red] counter=310 t=2.4e-01 per=2.5e+01 cost=1.9e+05 flops=7.9e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=8.067e-05 (optmp,oper)=1.267e-07,3.839e-05
rank=0 GPUmem(GB): used=8.108e-05 (optmp,oper,site,rinter)=1.267e-07,3.839e-05,4.098e-07,1.054e-05
rank=0 GPUmem(GB): used=9.403e-05 (optmp,oper,site,rinter,batch)=1.267e-07,3.839e-05,4.098e-07,1.054e-05,1.295e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.478e-01 S T(prep/alloc/comp/red/dealloc)=2.337e-02,2.796e-02,3.827e-01,3.469e-02,2.489e-03 -----
----- TIMING FOR oper_renorm_opS : 4.480e-01 S rank=0 -----
----- TIMING FOR oper_renorm : 5.211e-01 S rank=0 -----
rank=0 CPUmem(GB): used=1.015e+00 pageheap_free=1.662e-02 change=3.929e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.693e-02 change=-1.865e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::oper_ab2pq coord=(10,0) superblock=cr alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=HCSPQ nops=H:1 C:10 S:5 P:49 Q:56 
        dim(bra,ket)=10,10 size(op)=42:3.204e-04MB size(tot)=2224:1.697e-02MB:1.657e-05GB
        per(mem): H:0.899 C:7.64 S:3.82 P:9.58 Q:78.1 
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.693e-02 change=3.221e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.693e-02 change=7.600e-07 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=6.394e-05 avail=6.231e+00 after qops2.allocate_gpu
ctns::oper_a2p ifab=0 ifkr=1 maxsize=222:1.654e-06GB
iproc=0
 qops_tmp: oplist=M nops=M:49 
        dim(bra,ket)=10,10 size(op)=6:4.578e-05MB size(tot)=213:1.625e-03MB:1.587e-06GB
        per(mem): M:100 
   init qops_tmp: dt=0.00169 tinit=0.00169
   from opA to opA.H(): dt=0.00652 tadjt=0.00652
   bcast: size(opM)=213:1.59e-06GB dt=0.00245 speed=0.000647GB/s tcomm=0.00245
   compute opP from opA: dt=0.00504 tcomp=0.00504
iproc=1
 qops_tmp: oplist=M nops=M:51 
        dim(bra,ket)=10,10 size(op)=6:4.58e-05MB size(tot)=222:0.00169MB:1.65e-06GB
        per(mem): M:100 
   init qops_tmp: dt=0.00167 tinit=0.00336
   from opA to opA.H(): dt=0.00544 tadjt=0.00544
   bcast: size(opM)=222:1.65e-06GB dt=0.00245 speed=0.000674GB/s tcomm=0.0132
   compute opP from opA: dt=0.00496 tcomp=0.00985
----- TIMING FOR oper_a2pGPU : 0.0327 S T(init/adjt+bcast/comp/rest)=0.00339,0.0188,0.00997,0.000498 -----
ctns::oper_b2q ifab=0 ifkr=1 maxsize=1736:1.29e-05GB
rank=1 size=1736 iproc=0
iproc=0
 qops_tmp: oplist=B nops=B:56 
        dim(bra,ket)=10,10 size(op)=42:0.00032MB size(tot)=1736:0.0132MB:1.29e-05GB
        per(mem): B:100 
   init qops_tmp: dt=0.002 tinit=0.002
   copy opB to qops_tmps: dt=0.00232 tcopy=0.00232
rank=0 size=1736 iproc=0
   bcast: size(opB)=1736:1.29e-05GB dt=0.0025 speed=0.00517GB/s tcomm=0.0025
   compute opQ from opB: dt=0.005 tcomp=0.005
iproc=0
 qops_tmp: oplist=N nops=N:56 
        dim(bra,ket)=10,10 size(op)=42:0.00032MB size(tot)=1736:0.0132MB:1.29e-05GB
        per(mem): N:100 
   init qops_tmp: dt=0.00198 tinit=0.00398
   from opB to opB.H(): dt=0.00742 tadjt=0.00742
   bcast: size(opN)=1736:1.29e-05GB dt=0.00248 speed=0.00521GB/s tcomm=0.00498
   compute opQ from opB.H(): dt=0.005 tcomp=0.01
rank=0 size=1674 iproc=1
iproc=1
 qops_tmp: oplist=B nops=B:54 
        dim(bra,ket)=10,10 size(op)=42:0.00032MB size(tot)=1674:0.0128MB:1.25e-05GB
        per(mem): B:100 
   init qops_tmp: dt=0.00191 tinit=0.00591
   copy opB to qops_tmps: dt=0.000302 tcopy=0.000302
rank=1 size=1674 iproc=1
   bcast: size(opB)=1674:1.25e-05GB dt=0.00249 speed=0.00501GB/s tcomm=0.0186
   compute opQ from opB: dt=0.00497 tcomp=0.0149
iproc=1
 qops_tmp: oplist=N nops=N:54 
        dim(bra,ket)=10,10 size(op)=42:0.00032MB size(tot)=1674:0.0128MB:1.25e-05GB
        per(mem): N:100 
   init qops_tmp: dt=0.00191 tinit=0.00782
   from opB to opB.H(): dt=0.00745 tadjt=0.00745
   bcast: size(opN)=1674:1.25e-05GB dt=0.00246 speed=0.00507GB/s tcomm=0.0211
   compute opQ from opB.H(): dt=0.00491 tcomp=0.0198
----- TIMING FOR oper_b2qGPU : 0.0577 S T(init/copy/adjt+bcast/comp/rest)=0.00777,0.00232,0.027,0.0198,0.000829 -----
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.691e-02 change=3.055e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=6.394e-05 avail=6.231e+00 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.691e-02 change=1.907e-05 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=6.394e-05 avail=6.231e+00 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.691e-02 change=-5.960e-08 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 before move
rank=0 GPUmem(GB): used=6.394e-05 avail=6.231e+00 before move
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.691e-02 change=-3.230e-04 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after move
rank=0 GPUmem(GB): used=4.737e-05 avail=6.231e+00 after move
check ||H-H.dagger||=9.312e-15 coord=(10,0) rank=0
----- TIMING FOR oper_ab2pq : 0.0961 S T(init/copyHCS/opP/opQ/to_gpu/to_cpu/move)=0.00461,1.83e-05,0.0327,0.0577,0,0.000408,0.000546 -----
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.691e-02 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.691e-02 change=-4.604e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 2.313e+00 S #####
 T(local opt: fetch) = 1.699e-02 S  per = 0.735  per(accum) = 0.735
 T(local opt: hdiag) = 6.635e-01 S  per = 28.7  per(accum) = 29.4
 T(local opt: dvdsn) = 1.008e+00 S  per = 43.6  per(accum) = 73
 T(local opt: decim) = 2.276e-03 S  per = 0.0984  per(accum) = 73.1
 T(local opt: guess) = 1.479e-03 S  per = 0.0639  per(accum) = 73.1
 T(local opt: renrm) = 6.208e-01 S  per = 26.8  per(accum) = 100
 T(local opt: save ) = 2.768e-04 S  per = 0.012  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.008e+00 S  T(sum) = 1.006e+00 S  per = 9.982e+01
 T(local opt: preprocess                  ) = 8.495e-03 S  per = 0.845  per(accum) = 0.845
 T(local opt: symbolic_formulae           ) = 7.004e-03 S  per = 0.696  per(accum) = 1.54
 T(local opt: hintermediate init          ) = 2.795e-04 S  per = 0.0278  per(accum) = 1.57
 T(local opt: preprocess_hformulae_Hxlist ) = 5.234e-01 S  per =   52  per(accum) = 53.6
 T(local opt: hmmtasks init               ) = 2.507e-01 S  per = 24.9  per(accum) = 78.5
 T(local opt: initial guess for dvdson    ) = 2.416e-03 S  per = 0.24  per(accum) = 78.8
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.560e-01 S  per = 15.5  per(accum) = 94.3
 T(local opt: dvdson [cpu-gpu]            ) = 1.299e-02 S  per = 1.29  per(accum) = 95.6
 T(local opt: dvdson [nccl]               ) = 4.381e-02 S  per = 4.35  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 7.871e-06 S  per = 0.000783  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 7.663e-04 S  per = 0.0762  per(accum) = 100
Detailed decomposition of T(renrm) = 6.208e-01 S  T(sum) = 6.208e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.938e-04 S  per = 0.0473  per(accum) = 0.0473
 T(local opt: qops init                    ) = 4.722e-03 S  per = 0.761  per(accum) = 0.808
 T(local opt: symbolic_formulae_renorm     ) = 8.790e-04 S  per = 0.142  per(accum) = 0.95
 T(local opt: allocate qops on gpu         ) = 8.062e-05 S  per = 0.013  per(accum) = 0.963
 T(local opt: site memcpy cpu2gpu          ) = 1.106e-03 S  per = 0.178  per(accum) = 1.14
 T(local opt: rintermediate init           ) = 2.454e-03 S  per = 0.395  per(accum) = 1.54
 T(local opt: preprocess_formulae_Rlist2   ) = 1.561e-02 S  per = 2.51  per(accum) = 4.05
 T(local opt: rmmtasks init                ) = 7.213e-03 S  per = 1.16  per(accum) = 5.21
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 5.64e-06  per(accum) = 5.21
 T(local opt: preprocess_renorm_batchGPU   ) = 3.864e-02 S  per = 6.23  per(accum) = 11.4
 T(local opt: deallocate cpu and gpu memory) = 8.347e-05 S  per = 0.0134  per(accum) = 11.5
 T(local opt: construct opS [ifdists=true] ) = 4.480e-01 S  per = 72.2  per(accum) = 83.6
 T(local opt: reduction of opS & opH [nccl]) = 2.294e-03 S  per = 0.37  per(accum) = 84
 T(local opt: qops memcpy gpu2cpu          ) = 2.800e-08 S  per = 4.51e-06  per(accum) = 84
 T(local opt: reduction of opS & opH [mpi] ) = 6.900e-08 S  per = 1.11e-05  per(accum) = 84
 T(local opt: qops_pool join and erase     ) = 3.258e-03 S  per = 0.525  per(accum) = 84.5
 T(local opt: conversion from opAB to opPQ ) = 9.616e-02 S  per = 15.5  per(accum) = 100
##### sweep opt: 3.629e+01 S #####
 T(sweep opt: fetch) = 3.081e-01 S  per = 0.849  per(accum) = 0.849
 T(sweep opt: hdiag) = 7.184e+00 S  per = 19.8  per(accum) = 20.6
 T(sweep opt: dvdsn) = 1.366e+01 S  per = 37.6  per(accum) = 58.3
 T(sweep opt: decim) = 3.517e-02 S  per = 0.0969  per(accum) = 58.4
 T(sweep opt: guess) = 2.213e-02 S  per = 0.061  per(accum) = 58.4
 T(sweep opt: renrm) = 1.508e+01 S  per = 41.6  per(accum) = 100
 T(sweep opt: save ) = 5.919e-03 S  per = 0.0163  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.366e+01 S  T(sum) = 1.364e+01 S  per = 9.989e+01
 T(sweep opt: preprocess                  ) = 1.111e-01 S  per = 0.815  per(accum) = 0.815
 T(sweep opt: symbolic_formulae           ) = 9.366e-02 S  per = 0.687  per(accum) = 1.5
 T(sweep opt: hintermediate init          ) = 5.072e-03 S  per = 0.0372  per(accum) = 1.54
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.662e+00 S  per = 26.8  per(accum) = 28.4
 T(sweep opt: hmmtasks init               ) = 1.569e+00 S  per = 11.5  per(accum) = 39.9
 T(sweep opt: initial guess for dvdson    ) = 3.157e-02 S  per = 0.231  per(accum) = 40.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.631e+00 S  per = 48.6  per(accum) = 88.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.009e-01 S  per = 2.21  per(accum) = 90.9
 T(sweep opt: dvdson [nccl]               ) = 1.221e+00 S  per = 8.95  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 1.445e-04 S  per = 0.00106  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.480e-02 S  per = 0.108  per(accum) = 100
Detailed decomposition of T(renrm) = 1.508e+01 S  T(sum) = 1.508e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.334e-03 S  per = 0.0486  per(accum) = 0.0486
 T(sweep opt: qops init                    ) = 5.966e-02 S  per = 0.396  per(accum) = 0.444
 T(sweep opt: symbolic_formulae_renorm     ) = 2.419e-02 S  per = 0.16  per(accum) = 0.605
 T(sweep opt: allocate qops on gpu         ) = 1.766e-03 S  per = 0.0117  per(accum) = 0.616
 T(sweep opt: site memcpy cpu2gpu          ) = 3.277e-02 S  per = 0.217  per(accum) = 0.834
 T(sweep opt: rintermediate init           ) = 5.774e-02 S  per = 0.383  per(accum) = 1.22
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.483e-01 S  per = 2.31  per(accum) = 3.53
 T(sweep opt: rmmtasks init                ) = 1.721e-01 S  per = 1.14  per(accum) = 4.67
 T(sweep opt: qops memset on cpu           ) = 9.130e-07 S  per = 6.05e-06  per(accum) = 4.67
 T(sweep opt: preprocess_renorm_batchGPU   ) = 9.673e-01 S  per = 6.41  per(accum) = 11.1
 T(sweep opt: deallocate cpu and gpu memory) = 1.635e-03 S  per = 0.0108  per(accum) = 11.1
 T(sweep opt: construct opS [ifdists=true] ) = 1.309e+01 S  per = 86.8  per(accum) = 97.9
 T(sweep opt: reduction of opS & opH [nccl]) = 5.921e-02 S  per = 0.393  per(accum) = 98.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.407e-03 S  per = 0.016  per(accum) = 98.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.549e-03 S  per = 0.0103  per(accum) = 98.3
 T(sweep opt: qops_pool join and erase     ) = 5.346e-02 S  per = 0.354  per(accum) = 98.7
 T(sweep opt: conversion from opAB to opPQ ) = 1.989e-01 S  per = 1.32  per(accum) = 100
##### global opt: 3.629e+01 S #####
 T(global opt: fetch) = 3.081e-01 S  per = 0.849  per(accum) = 0.849
 T(global opt: hdiag) = 7.184e+00 S  per = 19.8  per(accum) = 20.6
 T(global opt: dvdsn) = 1.366e+01 S  per = 37.6  per(accum) = 58.3
 T(global opt: decim) = 3.517e-02 S  per = 0.0969  per(accum) = 58.4
 T(global opt: guess) = 2.213e-02 S  per = 0.061  per(accum) = 58.4
 T(global opt: renrm) = 1.508e+01 S  per = 41.6  per(accum) = 100
 T(global opt: save ) = 5.919e-03 S  per = 0.0163  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.366e+01 S  T(sum) = 1.364e+01 S  per = 9.989e+01
 T(global opt: preprocess                  ) = 1.111e-01 S  per = 0.815  per(accum) = 0.815
 T(global opt: symbolic_formulae           ) = 9.366e-02 S  per = 0.687  per(accum) = 1.5
 T(global opt: hintermediate init          ) = 5.072e-03 S  per = 0.0372  per(accum) = 1.54
 T(global opt: preprocess_hformulae_Hxlist ) = 3.662e+00 S  per = 26.8  per(accum) = 28.4
 T(global opt: hmmtasks init               ) = 1.569e+00 S  per = 11.5  per(accum) = 39.9
 T(global opt: initial guess for dvdson    ) = 3.157e-02 S  per = 0.231  per(accum) = 40.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.631e+00 S  per = 48.6  per(accum) = 88.7
 T(global opt: dvdson [cpu-gpu]            ) = 3.009e-01 S  per = 2.21  per(accum) = 90.9
 T(global opt: dvdson [nccl]               ) = 1.221e+00 S  per = 8.95  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 1.445e-04 S  per = 0.00106  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.480e-02 S  per = 0.108  per(accum) = 100
Detailed decomposition of T(renrm) = 1.508e+01 S  T(sum) = 1.508e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.334e-03 S  per = 0.0486  per(accum) = 0.0486
 T(global opt: qops init                    ) = 5.966e-02 S  per = 0.396  per(accum) = 0.444
 T(global opt: symbolic_formulae_renorm     ) = 2.419e-02 S  per = 0.16  per(accum) = 0.605
 T(global opt: allocate qops on gpu         ) = 1.766e-03 S  per = 0.0117  per(accum) = 0.616
 T(global opt: site memcpy cpu2gpu          ) = 3.277e-02 S  per = 0.217  per(accum) = 0.834
 T(global opt: rintermediate init           ) = 5.774e-02 S  per = 0.383  per(accum) = 1.22
 T(global opt: preprocess_formulae_Rlist2   ) = 3.483e-01 S  per = 2.31  per(accum) = 3.53
 T(global opt: rmmtasks init                ) = 1.721e-01 S  per = 1.14  per(accum) = 4.67
 T(global opt: qops memset on cpu           ) = 9.130e-07 S  per = 6.05e-06  per(accum) = 4.67
 T(global opt: preprocess_renorm_batchGPU   ) = 9.673e-01 S  per = 6.41  per(accum) = 11.1
 T(global opt: deallocate cpu and gpu memory) = 1.635e-03 S  per = 0.0108  per(accum) = 11.1
 T(global opt: construct opS [ifdists=true] ) = 1.309e+01 S  per = 86.8  per(accum) = 97.9
 T(global opt: reduction of opS & opH [nccl]) = 5.921e-02 S  per = 0.393  per(accum) = 98.3
 T(global opt: qops memcpy gpu2cpu          ) = 2.407e-03 S  per = 0.016  per(accum) = 98.3
 T(global opt: reduction of opS & opH [mpi] ) = 1.549e-03 S  per = 0.0103  per(accum) = 98.3
 T(global opt: qops_pool join and erase     ) = 5.346e-02 S  per = 0.354  per(accum) = 98.7
 T(global opt: conversion from opAB to opPQ ) = 1.989e-01 S  per = 1.32  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-7.439e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=26/seqsize=34 dots=2 dbond=(8,0)-(9,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=613:4.677e-03MB:4.567e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=48:3.662e-04MB:3.576e-07GB
total mem of comb=662:5.051e-03MB:4.932e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=8,10,1,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc1= 19
 suppc2= 5
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(8,0)
 fqop[3]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:8 S:7 A:31 B:36 
        dim(bra,ket)=10,10 size(op)=31:2.365e-04MB size(tot)=1168:8.911e-03MB:8.702e-06GB
        per(mem): H:1.2 C:11 S:9.59 A:8.9 B:69.3 
 rqops: oplist=HCSPQ nops=H:1 C:10 S:5 P:49 Q:56 
        dim(bra,ket)=10,10 size(op)=42:0.00032MB size(tot)=2224:0.017MB:1.66e-05GB
        per(mem): H:0.899 C:7.64 S:3.82 P:9.58 Q:78.1 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=5388:0.0411MB:4.01e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.161e-03 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(9,0) fdel=./scratch/sweep/lop(8,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-9.120e-06 heap=1.068e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=141:1.076e-03MB
qtensor4: wf4 own=1 _data=0x3b2f7180
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=8 dimAll=10
 (12,2):2 (12,4):2 (11,1):1 (11,3):1 (11,5):1 (13,3):1 (13,1):1 (12,0):1
 qbond: qcol nsym=6 dimAll=10
 (15,3):3 (16,2):2 (15,1):2 (16,4):1 (17,3):1 (15,5):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=60 nblocks=744 size=141:1.076e-03MB
### DIAG TIMING: total=5.248e-01 t1=3.051e-05, t2=4.075e-04, t3=2.452e-03, t4=5.194e-01, t5=2.930e-06, t6=2.513e-03, t7=5.383e-06
duration_diagGPU:5.248e-01
duration_diagreduce:7.100e-08
duration_diagtransform:1.274e-06
----- TIMING FOR symbolic_formulae_twodot with size=452 : 6.029e-03 S -----
rank=0 GPUmem(GB): used=4.014e-05 (oper)=4.014e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=452
 no. of hintermediate operators=227
 no. of coefficients=2776:2.118e-02MB:2.068e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.714e-04 S -----
rank=0 GPUmem(GB): used=6.083e-05 (oper,hinter)=4.014e-05,2.068e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 7.780e-01 S size(H_formulae)=452 size(Hxlst2)=60 T(Hmu/Hxlist)=1.242e-03,7.768e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.848e-01 S size(H_formulae)=452 size(Hxlst)=46468 -----
rank=0 GPUmem(GB): used=6.083e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=2.101e-06 batch[need]=6.578e-03 blksize=6 blksize0=6 batchsize=46468
rank=0 GPUmem(GB): used=6.641e-03 (oper,hinter,dvdson,batch)=4.014e-05,2.068e-05,2.101e-06,6.578e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=141 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.819e-03,2.597e-03,1.040e-02,1.172e-02,3.155e-02
 analyze_tgpu[Hx]: ndim=141:1.051e-06GB T(cpu-gpu)=1.873e-03 speed=1.122e-03GB/S T(nccl)=4.946e-03 speed=4.248e-04GB/S
----- TIMING FOR sigma : t_inter=2.6e-03 t_gemm=1.0e-02 t_reduction=1.2e-02 tot=2.5e-02 -----
 sigma[inter] counter=153 t=2.6e-03 per=1.1e+01 cost=1.5e+06 flops=5.8e+08
 sigma[gemm] counter=153 i=0 t=1.6e-06 per=6.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=1 t=1.2e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=2 t=1.1e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=3 t=1.1e-06 per=4.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=4 t=2.6e-03 per=1.0e+01 cost=1.7e+05 flops=6.6e+07
 sigma[gemm] counter=153 i=5 t=2.6e-03 per=1.1e+01 cost=1.7e+05 flops=6.5e+07
 sigma[gemm] counter=153 i=6 t=2.6e-03 per=1.0e+01 cost=1.5e+05 flops=6.0e+07
 sigma[gemm] counter=153 i=7 t=2.6e-03 per=1.1e+01 cost=1.6e+05 flops=6.1e+07
 sigma[gemm] counter=153 total t=1.0e-02 per=4.2e+01 cost=6.5e+05 flops=6.3e+07
 sigma[red] counter=153 t=1.2e-02 per=4.7e+01 cost=2.3e+05 flops=1.9e+07
----- TIMING FOR sigma_tot : t_inter=9.7e-01 t_gemm=3.9e+00 t_reduction=1.7e+00 tot=6.6e+00 -----
 sigma_tot[inter] counter=153 t=9.7e-01 per=1.5e+01 cost=5.1e+07 flops=5.3e+07
 sigma_tot[gemm] counter=153 i=0 t=2.1e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=1 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=2 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=3 t=1.7e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=4 t=9.9e-01 per=1.5e+01 cost=7.2e+06 flops=7.3e+06
 sigma_tot[gemm] counter=153 i=5 t=1.0e+00 per=1.5e+01 cost=7.3e+06 flops=7.3e+06
 sigma_tot[gemm] counter=153 i=6 t=9.8e-01 per=1.5e+01 cost=6.2e+06 flops=6.4e+06
 sigma_tot[gemm] counter=153 i=7 t=9.7e-01 per=1.5e+01 cost=6.3e+06 flops=6.5e+06
 sigma_tot[gemm] counter=153 total t=3.9e+00 per=5.9e+01 cost=2.7e+07 flops=6.9e+06
 sigma_tot[red] counter=153 t=1.7e+00 per=2.6e+01 cost=8.4e+06 flops=4.9e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=6.4e-06,1.0e-05,3.0e-06,2.5e-06,2.7e-07
settings: ndim=141 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.296589770489 -1.116e+03  2.851e-02    1     1  3.189e-02 3.189e-02 3.184e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.088e-03,2.594e-03,1.043e-02,1.132e-02,3.143e-02
 analyze_tgpu[Hx]: ndim=141:1.051e-06GB T(cpu-gpu)=2.067e-03 speed=1.017e-03GB/S T(nccl)=5.021e-03 speed=4.185e-04GB/S
----- TIMING FOR sigma : t_inter=2.6e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.4e-02 -----
 sigma[inter] counter=154 t=2.6e-03 per=1.1e+01 cost=1.5e+06 flops=5.8e+08
 sigma[gemm] counter=154 i=0 t=1.3e-06 per=5.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=1 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=2 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=3 t=1.1e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=4 t=2.6e-03 per=1.1e+01 cost=1.7e+05 flops=6.6e+07
 sigma[gemm] counter=154 i=5 t=2.7e-03 per=1.1e+01 cost=1.7e+05 flops=6.4e+07
 sigma[gemm] counter=154 i=6 t=2.6e-03 per=1.1e+01 cost=1.5e+05 flops=5.9e+07
 sigma[gemm] counter=154 i=7 t=2.6e-03 per=1.1e+01 cost=1.6e+05 flops=6.2e+07
 sigma[gemm] counter=154 total t=1.0e-02 per=4.3e+01 cost=6.5e+05 flops=6.3e+07
 sigma[red] counter=154 t=1.1e-02 per=4.7e+01 cost=2.3e+05 flops=2.0e+07
----- TIMING FOR sigma_tot : t_inter=9.7e-01 t_gemm=3.9e+00 t_reduction=1.7e+00 tot=6.6e+00 -----
 sigma_tot[inter] counter=154 t=9.7e-01 per=1.5e+01 cost=5.3e+07 flops=5.4e+07
 sigma_tot[gemm] counter=154 i=0 t=2.1e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=1 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=2 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=3 t=1.8e-04 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=4 t=9.9e-01 per=1.5e+01 cost=7.4e+06 flops=7.5e+06
 sigma_tot[gemm] counter=154 i=5 t=1.0e+00 per=1.5e+01 cost=7.5e+06 flops=7.4e+06
 sigma_tot[gemm] counter=154 i=6 t=9.8e-01 per=1.5e+01 cost=6.4e+06 flops=6.5e+06
 sigma_tot[gemm] counter=154 i=7 t=9.7e-01 per=1.5e+01 cost=6.5e+06 flops=6.6e+06
 sigma_tot[gemm] counter=154 total t=3.9e+00 per=5.9e+01 cost=2.8e+07 flops=7.0e+06
 sigma_tot[red] counter=154 t=1.7e+00 per=2.6e+01 cost=8.6e+06 flops=5.0e+06
T(sub)=5.1e-05 T(gemm/eig/ortho/gemm/axpy)=8.0e-06,3.7e-05,4.4e-06,1.8e-06,2.2e-07
    2   0 -    -116.298609713074 -2.020e-03  5.603e-03    2     2  6.364e-02 3.182e-02 3.172e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.886e-03,2.540e-03,1.024e-02,1.143e-02,3.210e-02
 analyze_tgpu[Hx]: ndim=141:1.051e-06GB T(cpu-gpu)=2.201e-03 speed=9.547e-04GB/S T(nccl)=5.685e-03 speed=3.696e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.4e-02 -----
 sigma[inter] counter=155 t=2.5e-03 per=1.0e+01 cost=1.5e+06 flops=5.9e+08
 sigma[gemm] counter=155 i=0 t=1.4e-06 per=5.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=1 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=2 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=3 t=1.2e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=4 t=2.5e-03 per=1.0e+01 cost=1.7e+05 flops=6.7e+07
 sigma[gemm] counter=155 i=5 t=2.6e-03 per=1.1e+01 cost=1.7e+05 flops=6.5e+07
 sigma[gemm] counter=155 i=6 t=2.5e-03 per=1.0e+01 cost=1.5e+05 flops=6.1e+07
 sigma[gemm] counter=155 i=7 t=2.6e-03 per=1.1e+01 cost=1.6e+05 flops=6.3e+07
 sigma[gemm] counter=155 total t=1.0e-02 per=4.2e+01 cost=6.5e+05 flops=6.4e+07
 sigma[red] counter=155 t=1.1e-02 per=4.7e+01 cost=2.3e+05 flops=2.0e+07
----- TIMING FOR sigma_tot : t_inter=9.8e-01 t_gemm=4.0e+00 t_reduction=1.7e+00 tot=6.7e+00 -----
 sigma_tot[inter] counter=155 t=9.8e-01 per=1.5e+01 cost=5.4e+07 flops=5.5e+07
 sigma_tot[gemm] counter=155 i=0 t=2.1e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=1 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=2 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=3 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=4 t=9.9e-01 per=1.5e+01 cost=7.6e+06 flops=7.6e+06
 sigma_tot[gemm] counter=155 i=5 t=1.0e+00 per=1.5e+01 cost=7.6e+06 flops=7.6e+06
 sigma_tot[gemm] counter=155 i=6 t=9.8e-01 per=1.5e+01 cost=6.5e+06 flops=6.7e+06
 sigma_tot[gemm] counter=155 i=7 t=9.7e-01 per=1.5e+01 cost=6.6e+06 flops=6.8e+06
 sigma_tot[gemm] counter=155 total t=4.0e+00 per=5.9e+01 cost=2.8e+07 flops=7.2e+06
 sigma_tot[red] counter=155 t=1.7e+00 per=2.6e+01 cost=8.8e+06 flops=5.1e+06
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,3.3e-05,3.2e-06,1.4e-06,2.4e-07
    3   0 -    -116.298696882630 -8.717e-05  2.134e-03    3     3  9.597e-02 3.199e-02 3.189e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.224e-03,2.598e-03,1.026e-02,1.140e-02,3.149e-02
 analyze_tgpu[Hx]: ndim=141:1.051e-06GB T(cpu-gpu)=2.252e-03 speed=9.332e-04GB/S T(nccl)=4.972e-03 speed=4.226e-04GB/S
----- TIMING FOR sigma : t_inter=2.6e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.4e-02 -----
 sigma[inter] counter=156 t=2.6e-03 per=1.1e+01 cost=1.5e+06 flops=5.8e+08
 sigma[gemm] counter=156 i=0 t=1.3e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=1 t=1.1e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=2 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=3 t=1.1e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=4 t=2.5e-03 per=1.0e+01 cost=1.7e+05 flops=6.7e+07
 sigma[gemm] counter=156 i=5 t=2.6e-03 per=1.1e+01 cost=1.7e+05 flops=6.5e+07
 sigma[gemm] counter=156 i=6 t=2.5e-03 per=1.0e+01 cost=1.5e+05 flops=6.1e+07
 sigma[gemm] counter=156 i=7 t=2.6e-03 per=1.1e+01 cost=1.6e+05 flops=6.3e+07
 sigma[gemm] counter=156 total t=1.0e-02 per=4.2e+01 cost=6.5e+05 flops=6.4e+07
 sigma[red] counter=156 t=1.1e-02 per=4.7e+01 cost=2.3e+05 flops=2.0e+07
----- TIMING FOR sigma_tot : t_inter=9.8e-01 t_gemm=4.0e+00 t_reduction=1.8e+00 tot=6.7e+00 -----
 sigma_tot[inter] counter=156 t=9.8e-01 per=1.5e+01 cost=5.6e+07 flops=5.7e+07
 sigma_tot[gemm] counter=156 i=0 t=2.1e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=1 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=2 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=3 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=4 t=9.9e-01 per=1.5e+01 cost=7.7e+06 flops=7.8e+06
 sigma_tot[gemm] counter=156 i=5 t=1.0e+00 per=1.5e+01 cost=7.8e+06 flops=7.7e+06
 sigma_tot[gemm] counter=156 i=6 t=9.8e-01 per=1.5e+01 cost=6.7e+06 flops=6.8e+06
 sigma_tot[gemm] counter=156 i=7 t=9.8e-01 per=1.5e+01 cost=6.8e+06 flops=6.9e+06
 sigma_tot[gemm] counter=156 total t=4.0e+00 per=5.9e+01 cost=2.9e+07 flops=7.3e+06
 sigma_tot[red] counter=156 t=1.8e+00 per=2.6e+01 cost=9.0e+06 flops=5.1e+06
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.8e-05,3.4e-06,1.8e-06,2.4e-07
    4   0 -    -116.298708135399 -1.125e-05  8.437e-04    3     4  1.278e-01 3.195e-02 3.184e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.094e-03,2.579e-03,1.031e-02,1.122e-02,3.121e-02
 analyze_tgpu[Hx]: ndim=141:1.051e-06GB T(cpu-gpu)=2.150e-03 speed=9.770e-04GB/S T(nccl)=4.944e-03 speed=4.250e-04GB/S
----- TIMING FOR sigma : t_inter=2.6e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.4e-02 -----
 sigma[inter] counter=157 t=2.6e-03 per=1.1e+01 cost=1.5e+06 flops=5.8e+08
 sigma[gemm] counter=157 i=0 t=1.3e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=1 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=2 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=3 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=4 t=2.6e-03 per=1.1e+01 cost=1.7e+05 flops=6.6e+07
 sigma[gemm] counter=157 i=5 t=2.7e-03 per=1.1e+01 cost=1.7e+05 flops=6.4e+07
 sigma[gemm] counter=157 i=6 t=2.6e-03 per=1.1e+01 cost=1.5e+05 flops=6.0e+07
 sigma[gemm] counter=157 i=7 t=2.5e-03 per=1.0e+01 cost=1.6e+05 flops=6.4e+07
 sigma[gemm] counter=157 total t=1.0e-02 per=4.3e+01 cost=6.5e+05 flops=6.4e+07
 sigma[red] counter=157 t=1.1e-02 per=4.7e+01 cost=2.3e+05 flops=2.0e+07
----- TIMING FOR sigma_tot : t_inter=9.8e-01 t_gemm=4.0e+00 t_reduction=1.8e+00 tot=6.7e+00 -----
 sigma_tot[inter] counter=157 t=9.8e-01 per=1.5e+01 cost=5.7e+07 flops=5.8e+07
 sigma_tot[gemm] counter=157 i=0 t=2.1e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=1 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=2 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=3 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=4 t=1.0e+00 per=1.5e+01 cost=7.9e+06 flops=7.9e+06
 sigma_tot[gemm] counter=157 i=5 t=1.0e+00 per=1.5e+01 cost=8.0e+06 flops=7.9e+06
 sigma_tot[gemm] counter=157 i=6 t=9.9e-01 per=1.5e+01 cost=6.8e+06 flops=6.9e+06
 sigma_tot[gemm] counter=157 i=7 t=9.8e-01 per=1.5e+01 cost=6.9e+06 flops=7.1e+06
 sigma_tot[gemm] counter=157 total t=4.0e+00 per=5.9e+01 cost=3.0e+07 flops=7.5e+06
 sigma_tot[red] counter=157 t=1.8e+00 per=2.6e+01 cost=9.3e+06 flops=5.2e+06
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.7e-05,3.4e-06,1.4e-06,2.5e-07
    5   0 -    -116.298709647401 -1.512e-06  3.012e-04    3     5  1.592e-01 3.185e-02 3.175e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.210e-03,2.526e-03,1.028e-02,1.162e-02,3.165e-02
 analyze_tgpu[Hx]: ndim=141:1.051e-06GB T(cpu-gpu)=2.246e-03 speed=9.356e-04GB/S T(nccl)=4.964e-03 speed=4.233e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.2e-02 tot=2.4e-02 -----
 sigma[inter] counter=158 t=2.5e-03 per=1.0e+01 cost=1.5e+06 flops=5.9e+08
 sigma[gemm] counter=158 i=0 t=1.3e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=1 t=1.1e-06 per=4.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=2 t=1.1e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=3 t=1.1e-06 per=4.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=4 t=2.5e-03 per=1.0e+01 cost=1.7e+05 flops=6.8e+07
 sigma[gemm] counter=158 i=5 t=2.6e-03 per=1.1e+01 cost=1.7e+05 flops=6.5e+07
 sigma[gemm] counter=158 i=6 t=2.5e-03 per=1.0e+01 cost=1.5e+05 flops=6.0e+07
 sigma[gemm] counter=158 i=7 t=2.6e-03 per=1.1e+01 cost=1.6e+05 flops=6.2e+07
 sigma[gemm] counter=158 total t=1.0e-02 per=4.2e+01 cost=6.5e+05 flops=6.4e+07
 sigma[red] counter=158 t=1.2e-02 per=4.8e+01 cost=2.3e+05 flops=1.9e+07
----- TIMING FOR sigma_tot : t_inter=9.8e-01 t_gemm=4.0e+00 t_reduction=1.8e+00 tot=6.7e+00 -----
 sigma_tot[inter] counter=158 t=9.8e-01 per=1.5e+01 cost=5.9e+07 flops=6.0e+07
 sigma_tot[gemm] counter=158 i=0 t=2.1e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=1 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=2 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=3 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=4 t=1.0e+00 per=1.5e+01 cost=8.1e+06 flops=8.1e+06
 sigma_tot[gemm] counter=158 i=5 t=1.0e+00 per=1.5e+01 cost=8.1e+06 flops=8.0e+06
 sigma_tot[gemm] counter=158 i=6 t=9.9e-01 per=1.5e+01 cost=7.0e+06 flops=7.1e+06
 sigma_tot[gemm] counter=158 i=7 t=9.8e-01 per=1.5e+01 cost=7.1e+06 flops=7.2e+06
 sigma_tot[gemm] counter=158 total t=4.0e+00 per=5.9e+01 cost=3.0e+07 flops=7.6e+06
 sigma_tot[red] counter=158 t=1.8e+00 per=2.6e+01 cost=9.5e+06 flops=5.3e+06
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.5e-05,3.3e-06,1.6e-06,2.6e-07
    6   0 +    -116.298709867538 -2.201e-07  8.707e-05    3     6  1.911e-01 3.185e-02 3.175e-02
TIMING FOR Davidson : 1.911e-01  T(cal/comm/rest)=1.905e-01,7.742e-06,5.934e-04
decomposed t_rest=5.934e-04
 T(sub)    =1.970e-04 per=3.320e+01
 T(precond)=6.061e-05 per=1.021e+01
 T(ortho)  =1.452e-05 per=2.447e+00
 T(xcopy)  =1.099e-06 per=1.852e-01
 T(xnrm2)  =2.944e-06 per=4.961e-01
 T(other)  =3.172e-04 per=5.346e+01
optimized energies: isweep=0 ibond=26 dots=2 e[0]=-116.298709867538 nmvp=6
rank=0 CPUmem(GB): used=1.018e+00 pageheap_free=2.621e-02 change=1.089e-02 heap=1.076e+00 avail=4.761e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=13 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond26.txt
 qbond: qsuper nsym=13 dimAll=40
 (15,3):3 (16,2):7 (15,1):2 (16,4):5 (17,3):7 (15,5):1 (18,2):3 (17,1):4 (18,4):2 (19,3):1 (17,5):2 (16,0):2 (16,6):1
timing for divide=1.7e-04
timing for compute=1.4e-04
timing for collect=2.4e-05
----- TMING FOR decimation_genbasis(su2): 3.3e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.7e-04,1.3e-04,0.0e+00,8.3e-06,2.4e-05 -----
decimation summary: 40->10 dwt=+6.052e-04 SvN=1.039e+00
 qbond: qkept nsym=7 dimAll=10
 (16,2):2 (16,4):2 (17,1):2 (17,3):1 (18,2):1 (17,5):1 (16,0):1
----- TIMING for decimation_row(nkr): 8.814e-04 S T(decim/select/formRot)=3.988e-04,3.266e-04,1.560e-04 -----
----- TIMING FOR twodot_decimation: 2.548e-03 S T(wf/decim)=1.522e-03,1.025e-03 -----
ctns::oper_renorm coord=(9,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:11 S:4 P:40 Q:46 
        dim(bra,ket)=10,10 size(op)=33:2.518e-04MB size(tot)=1502:1.146e-02MB:1.119e-05GB
        per(mem): H:1.07 C:11 S:3.99 P:8.92 Q:75 
rank=0 CPUmem(GB): used=1.018e+00 pageheap_free=2.619e-02 change=3.628e-04 heap=1.076e+00 avail=4.761e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=98 : 3.306e-03 S -----
rank=0 GPUmem(GB): used=6.332e-05 (oper)=3.520e-05
rank=0 GPUmem(GB): used=6.366e-05 (oper,site)=3.520e-05,3.427e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=98
 no. of rintermediate operators=132
 no. of coefficients=1320:1.007e-02MB:9.835e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.469e-03 S -----
rank=0 GPUmem(GB): used=7.349e-05 (oper,site,rinter)=3.520e-05,3.427e-07,9.835e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 5.648e-02 S size(rtasks)=98 size(Rlst2)=49 T(Rmu/Rlist)=9.144e-04,5.556e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.688e-02 S size(rtasks)=98 size(Rlst)=4284 -----
rank=0 GPUmem(GB): used=7.349e-05 avail=6.231e+00 total=6.231e+00 batch[need]=6.064e-04 blksize=6 blksize0=6 batchsize=4284
rank=0 GPUmem(GB): used=6.799e-04 (oper,site,rinter,batch)=3.520e-05,3.427e-07,9.835e-06,6.064e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.282e-03,2.262e-02,9.965e-03
----- TIMING FOR renorm : t_inter=6.3e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=321 t=6.3e-03 per=1.6e+01 cost=1.0e+05 flops=1.6e+07
 renorm[gemm] counter=321 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=321 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=321 i=2 t=7.5e-03 per=1.9e+01 cost=9.1e+03 flops=1.2e+06
 renorm[gemm] counter=321 i=3 t=7.6e-03 per=1.9e+01 cost=2.8e+04 flops=3.7e+06
 renorm[gemm] counter=321 i=4 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=321 i=5 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=321 i=6 t=7.6e-03 per=1.9e+01 cost=4.0e+04 flops=5.2e+06
 renorm[gemm] counter=321 total t=2.3e-02 per=5.8e+01 cost=7.7e+04 flops=3.4e+06
 renorm[red] counter=321 t=1.0e-02 per=2.6e+01 cost=2.0e+04 flops=2.0e+06
----- TIMING FOR renorm_tot : t_inter=1.6e-01 t_gemm=5.8e-01 t_reduction=2.5e-01 tot=1.0e+00 -----
 renorm_tot[inter] counter=321 t=1.6e-01 per=1.6e+01 cost=5.8e+05 flops=3.5e+06
 renorm_tot[gemm] counter=321 i=0 t=3.6e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=321 i=1 t=3.1e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=321 i=2 t=7.4e-02 per=7.4e+00 cost=2.8e+04 flops=3.8e+05
 renorm_tot[gemm] counter=321 i=3 t=6.3e-02 per=6.3e+00 cost=1.2e+05 flops=1.9e+06
 renorm_tot[gemm] counter=321 i=4 t=1.3e-01 per=1.3e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=321 i=5 t=1.3e-01 per=1.3e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=321 i=6 t=1.9e-01 per=1.9e+01 cost=3.9e+05 flops=2.0e+06
 renorm_tot[gemm] counter=321 total t=5.8e-01 per=5.8e+01 cost=7.2e+05 flops=1.2e+06
 renorm_tot[red] counter=321 t=2.5e-01 per=2.5e+01 cost=2.1e+05 flops=8.4e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=7.416e-05 (optmp,oper)=1.118e-07,3.520e-05
rank=0 GPUmem(GB): used=7.450e-05 (optmp,oper,site,rinter)=1.118e-07,3.520e-05,3.427e-07,8.941e-07
rank=0 GPUmem(GB): used=8.809e-05 (optmp,oper,site,rinter,batch)=1.118e-07,3.520e-05,3.427e-07,8.941e-07,1.359e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 3.514e-01 S T(prep/alloc/comp/red/dealloc)=8.249e-03,1.165e-02,3.036e-01,3.363e-02,2.525e-03 -----
----- TIMING FOR oper_renorm_opS : 3.515e-01 S rank=0 -----
qops.to_cpu: size(tot)=1502:1.146e-02MB:1.119e-05GB T(to_cpu)=1.511e-04S speed=7.406e-02GB/S
check ||H-H.dagger||=5.260e-15 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.491 S rank=0 -----
rank=0 CPUmem(GB): used=1.019e+00 pageheap_free=3.045e-02 change=1.180e-03 heap=1.076e+00 avail=4.761e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.017e+00 pageheap_free=3.138e-02 change=-2.627e-03 heap=1.076e+00 avail=4.761e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.017e+00 pageheap_free=3.138e-02 change=-5.946e-06 heap=1.076e+00 avail=4.761e+02 total=5.033e+02 
##### local opt: 2.448e+00 S #####
 T(local opt: fetch) = 1.470e-02 S  per = 0.601  per(accum) = 0.601
 T(local opt: hdiag) = 5.265e-01 S  per = 21.5  per(accum) = 22.1
 T(local opt: dvdsn) = 1.407e+00 S  per = 57.5  per(accum) = 79.6
 T(local opt: decim) = 2.712e-03 S  per = 0.111  per(accum) = 79.7
 T(local opt: guess) = 1.961e-03 S  per = 0.0801  per(accum) = 79.8
 T(local opt: renrm) = 4.950e-01 S  per = 20.2  per(accum) = 100
 T(local opt: save ) = 2.465e-04 S  per = 0.0101  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.407e+00 S  T(sum) = 1.404e+00 S  per = 9.980e+01
 T(local opt: preprocess                  ) = 1.200e-02 S  per = 0.854  per(accum) = 0.854
 T(local opt: symbolic_formulae           ) = 6.047e-03 S  per = 0.431  per(accum) = 1.29
 T(local opt: hintermediate init          ) = 2.929e-04 S  per = 0.0209  per(accum) = 1.31
 T(local opt: preprocess_hformulae_Hxlist ) = 7.870e-01 S  per =   56  per(accum) = 57.4
 T(local opt: hmmtasks init               ) = 4.044e-01 S  per = 28.8  per(accum) = 86.2
 T(local opt: initial guess for dvdson    ) = 3.340e-03 S  per = 0.238  per(accum) = 86.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.472e-01 S  per = 10.5  per(accum) = 96.9
 T(local opt: dvdson [cpu-gpu]            ) = 1.279e-02 S  per = 0.911  per(accum) = 97.8
 T(local opt: dvdson [nccl]               ) = 3.053e-02 S  per = 2.17  per(accum) = 100
 T(local opt: dvdson [mpi]                ) = 7.742e-06 S  per = 0.000551  per(accum) = 100
 T(local opt: dvdson [rest part(linalg)]  ) = 5.934e-04 S  per = 0.0423  per(accum) = 100
Detailed decomposition of T(renrm) = 4.950e-01 S  T(sum) = 4.950e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.029e-04 S  per = 0.0814  per(accum) = 0.0814
 T(local opt: qops init                    ) = 5.501e-03 S  per = 1.11  per(accum) = 1.19
 T(local opt: symbolic_formulae_renorm     ) = 3.320e-03 S  per = 0.671  per(accum) = 1.86
 T(local opt: allocate qops on gpu         ) = 6.974e-05 S  per = 0.0141  per(accum) = 1.88
 T(local opt: site memcpy cpu2gpu          ) = 2.327e-03 S  per = 0.47  per(accum) = 2.35
 T(local opt: rintermediate init           ) = 2.484e-03 S  per = 0.502  per(accum) = 2.85
 T(local opt: preprocess_formulae_Rlist2   ) = 5.704e-02 S  per = 11.5  per(accum) = 14.4
 T(local opt: rmmtasks init                ) = 2.720e-02 S  per =  5.5  per(accum) = 19.9
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 6.87e-06  per(accum) = 19.9
 T(local opt: preprocess_renorm_batchGPU   ) = 3.906e-02 S  per = 7.89  per(accum) = 27.8
 T(local opt: deallocate cpu and gpu memory) = 2.128e-04 S  per = 0.043  per(accum) = 27.8
 T(local opt: construct opS [ifdists=true] ) = 3.516e-01 S  per =   71  per(accum) = 98.8
 T(local opt: reduction of opS & opH [nccl]) = 2.353e-03 S  per = 0.475  per(accum) = 99.3
 T(local opt: qops memcpy gpu2cpu          ) = 1.623e-04 S  per = 0.0328  per(accum) = 99.3
 T(local opt: reduction of opS & opH [mpi] ) = 8.901e-05 S  per = 0.018  per(accum) = 99.4
 T(local opt: qops_pool join and erase     ) = 3.175e-03 S  per = 0.641  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.149e-05 S  per = 0.00232  per(accum) = 100
##### sweep opt: 3.874e+01 S #####
 T(sweep opt: fetch) = 3.228e-01 S  per = 0.833  per(accum) = 0.833
 T(sweep opt: hdiag) = 7.710e+00 S  per = 19.9  per(accum) = 20.7
 T(sweep opt: dvdsn) = 1.506e+01 S  per = 38.9  per(accum) = 59.6
 T(sweep opt: decim) = 3.788e-02 S  per = 0.0978  per(accum) = 59.7
 T(sweep opt: guess) = 2.409e-02 S  per = 0.0622  per(accum) = 59.8
 T(sweep opt: renrm) = 1.558e+01 S  per = 40.2  per(accum) = 100
 T(sweep opt: save ) = 6.166e-03 S  per = 0.0159  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.506e+01 S  T(sum) = 1.504e+01 S  per = 9.988e+01
 T(sweep opt: preprocess                  ) = 1.231e-01 S  per = 0.818  per(accum) = 0.818
 T(sweep opt: symbolic_formulae           ) = 9.971e-02 S  per = 0.663  per(accum) = 1.48
 T(sweep opt: hintermediate init          ) = 5.365e-03 S  per = 0.0357  per(accum) = 1.52
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.449e+00 S  per = 29.6  per(accum) = 31.1
 T(sweep opt: hmmtasks init               ) = 1.974e+00 S  per = 13.1  per(accum) = 44.2
 T(sweep opt: initial guess for dvdson    ) = 3.491e-02 S  per = 0.232  per(accum) = 44.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.778e+00 S  per = 45.1  per(accum) = 89.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.137e-01 S  per = 2.08  per(accum) = 91.6
 T(sweep opt: dvdson [nccl]               ) = 1.251e+00 S  per = 8.32  per(accum) = 99.9
 T(sweep opt: dvdson [mpi]                ) = 1.522e-04 S  per = 0.00101  per(accum) = 99.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.539e-02 S  per = 0.102  per(accum) = 100
Detailed decomposition of T(renrm) = 1.558e+01 S  T(sum) = 1.558e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.737e-03 S  per = 0.0497  per(accum) = 0.0497
 T(sweep opt: qops init                    ) = 6.516e-02 S  per = 0.418  per(accum) = 0.468
 T(sweep opt: symbolic_formulae_renorm     ) = 2.752e-02 S  per = 0.177  per(accum) = 0.645
 T(sweep opt: allocate qops on gpu         ) = 1.836e-03 S  per = 0.0118  per(accum) = 0.656
 T(sweep opt: site memcpy cpu2gpu          ) = 3.510e-02 S  per = 0.225  per(accum) = 0.882
 T(sweep opt: rintermediate init           ) = 6.022e-02 S  per = 0.387  per(accum) = 1.27
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.053e-01 S  per =  2.6  per(accum) = 3.87
 T(sweep opt: rmmtasks init                ) = 1.993e-01 S  per = 1.28  per(accum) = 5.15
 T(sweep opt: qops memset on cpu           ) = 9.470e-07 S  per = 6.08e-06  per(accum) = 5.15
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.006e+00 S  per = 6.46  per(accum) = 11.6
 T(sweep opt: deallocate cpu and gpu memory) = 1.848e-03 S  per = 0.0119  per(accum) = 11.6
 T(sweep opt: construct opS [ifdists=true] ) = 1.345e+01 S  per = 86.3  per(accum) = 97.9
 T(sweep opt: reduction of opS & opH [nccl]) = 6.156e-02 S  per = 0.395  per(accum) = 98.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.569e-03 S  per = 0.0165  per(accum) = 98.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.638e-03 S  per = 0.0105  per(accum) = 98.4
 T(sweep opt: qops_pool join and erase     ) = 5.663e-02 S  per = 0.364  per(accum) = 98.7
 T(sweep opt: conversion from opAB to opPQ ) = 1.989e-01 S  per = 1.28  per(accum) = 100
##### global opt: 3.874e+01 S #####
 T(global opt: fetch) = 3.228e-01 S  per = 0.833  per(accum) = 0.833
 T(global opt: hdiag) = 7.710e+00 S  per = 19.9  per(accum) = 20.7
 T(global opt: dvdsn) = 1.506e+01 S  per = 38.9  per(accum) = 59.6
 T(global opt: decim) = 3.788e-02 S  per = 0.0978  per(accum) = 59.7
 T(global opt: guess) = 2.409e-02 S  per = 0.0622  per(accum) = 59.8
 T(global opt: renrm) = 1.558e+01 S  per = 40.2  per(accum) = 100
 T(global opt: save ) = 6.166e-03 S  per = 0.0159  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.506e+01 S  T(sum) = 1.504e+01 S  per = 9.988e+01
 T(global opt: preprocess                  ) = 1.231e-01 S  per = 0.818  per(accum) = 0.818
 T(global opt: symbolic_formulae           ) = 9.971e-02 S  per = 0.663  per(accum) = 1.48
 T(global opt: hintermediate init          ) = 5.365e-03 S  per = 0.0357  per(accum) = 1.52
 T(global opt: preprocess_hformulae_Hxlist ) = 4.449e+00 S  per = 29.6  per(accum) = 31.1
 T(global opt: hmmtasks init               ) = 1.974e+00 S  per = 13.1  per(accum) = 44.2
 T(global opt: initial guess for dvdson    ) = 3.491e-02 S  per = 0.232  per(accum) = 44.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.778e+00 S  per = 45.1  per(accum) = 89.5
 T(global opt: dvdson [cpu-gpu]            ) = 3.137e-01 S  per = 2.08  per(accum) = 91.6
 T(global opt: dvdson [nccl]               ) = 1.251e+00 S  per = 8.32  per(accum) = 99.9
 T(global opt: dvdson [mpi]                ) = 1.522e-04 S  per = 0.00101  per(accum) = 99.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.539e-02 S  per = 0.102  per(accum) = 100
Detailed decomposition of T(renrm) = 1.558e+01 S  T(sum) = 1.558e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.737e-03 S  per = 0.0497  per(accum) = 0.0497
 T(global opt: qops init                    ) = 6.516e-02 S  per = 0.418  per(accum) = 0.468
 T(global opt: symbolic_formulae_renorm     ) = 2.752e-02 S  per = 0.177  per(accum) = 0.645
 T(global opt: allocate qops on gpu         ) = 1.836e-03 S  per = 0.0118  per(accum) = 0.656
 T(global opt: site memcpy cpu2gpu          ) = 3.510e-02 S  per = 0.225  per(accum) = 0.882
 T(global opt: rintermediate init           ) = 6.022e-02 S  per = 0.387  per(accum) = 1.27
 T(global opt: preprocess_formulae_Rlist2   ) = 4.053e-01 S  per =  2.6  per(accum) = 3.87
 T(global opt: rmmtasks init                ) = 1.993e-01 S  per = 1.28  per(accum) = 5.15
 T(global opt: qops memset on cpu           ) = 9.470e-07 S  per = 6.08e-06  per(accum) = 5.15
 T(global opt: preprocess_renorm_batchGPU   ) = 1.006e+00 S  per = 6.46  per(accum) = 11.6
 T(global opt: deallocate cpu and gpu memory) = 1.848e-03 S  per = 0.0119  per(accum) = 11.6
 T(global opt: construct opS [ifdists=true] ) = 1.345e+01 S  per = 86.3  per(accum) = 97.9
 T(global opt: reduction of opS & opH [nccl]) = 6.156e-02 S  per = 0.395  per(accum) = 98.3
 T(global opt: qops memcpy gpu2cpu          ) = 2.569e-03 S  per = 0.0165  per(accum) = 98.3
 T(global opt: reduction of opS & opH [mpi] ) = 1.638e-03 S  per = 0.0105  per(accum) = 98.4
 T(global opt: qops_pool join and erase     ) = 5.663e-02 S  per = 0.364  per(accum) = 98.7
 T(global opt: conversion from opAB to opPQ ) = 1.989e-01 S  per = 1.28  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.085e-02 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=27/seqsize=34 dots=2 dbond=(7,0)-(8,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=612:4.669e-03MB:4.560e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=39:2.975e-04MB:2.906e-07GB
total mem of comb=652:4.974e-03MB:4.858e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=7,11,1,1
 suppl= 0 1 2 3 4 16 17
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 18
 suppc2= 19
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(7,0)
 fqop[3]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:7 S:7 A:27 B:26 
        dim(bra,ket)=10,10 size(op)=31:2.365e-04MB size(tot)=913:6.966e-03MB:6.802e-06GB
        per(mem): H:1.53 C:12.3 S:12.3 A:9.86 B:64.1 
 rqops: oplist=HCSPQ nops=H:1 C:11 S:4 P:40 Q:46 
        dim(bra,ket)=10,10 size(op)=33:0.000252MB size(tot)=1502:0.0115MB:1.12e-05GB
        per(mem): H:1.07 C:11 S:3.99 P:8.92 Q:75 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=4411:0.0337MB:3.29e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.095e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(8,0) fdel=./scratch/sweep/lop(7,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-7.212e-06 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=86:6.561e-04MB
qtensor4: wf4 own=1 _data=0x3b376dc0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=8 dimAll=10
 (10,2):2 (10,4):2 (9,1):1 (9,3):1 (9,5):1 (11,3):1 (11,1):1 (10,0):1
 qbond: qcol nsym=7 dimAll=10
 (16,2):2 (16,4):2 (17,1):2 (17,3):1 (18,2):1 (17,5):1 (16,0):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=49 nblocks=837 size=86:6.561e-04MB
### DIAG TIMING: total=4.714e-01 t1=2.698e-05, t2=3.350e-04, t3=2.397e-03, t4=3.598e-01, t5=3.946e-06, t6=1.088e-01, t7=8.844e-06
duration_diagGPU:4.714e-01
duration_diagreduce:5.300e-08
duration_diagtransform:6.130e-07
----- TIMING FOR symbolic_formulae_twodot with size=388 : 5.195e-03 S -----
rank=0 GPUmem(GB): used=3.286e-05 (oper)=3.286e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=388
 no. of hintermediate operators=201
 no. of coefficients=2367:1.806e-02MB:1.764e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.662e-04 S -----
rank=0 GPUmem(GB): used=5.050e-05 (oper,hinter)=3.286e-05,1.764e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.806e-01 S size(H_formulae)=388 size(Hxlst2)=49 T(Hmu/Hxlist)=1.072e-03,4.796e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.853e-01 S size(H_formulae)=388 size(Hxlst)=28342 -----
rank=0 GPUmem(GB): used=5.050e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=1.281e-06 batch[need]=2.745e-03 blksize=4 blksize0=4 batchsize=28342
rank=0 GPUmem(GB): used=2.797e-03 (oper,hinter,dvdson,batch)=3.286e-05,1.764e-05,1.281e-06,2.745e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=86 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.319e-03,2.583e-03,1.001e-02,1.056e-02,3.049e-02
 analyze_tgpu[Hx]: ndim=86:6.407e-07GB T(cpu-gpu)=1.987e-03 speed=6.449e-04GB/S T(nccl)=5.332e-03 speed=2.404e-04GB/S
----- TIMING FOR sigma : t_inter=2.6e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=159 t=2.6e-03 per=1.1e+01 cost=6.4e+05 flops=2.5e+08
 sigma[gemm] counter=159 i=0 t=1.6e-06 per=7.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=1 t=1.2e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=2 t=1.2e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=3 t=1.2e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=4 t=2.5e-03 per=1.1e+01 cost=6.0e+04 flops=2.4e+07
 sigma[gemm] counter=159 i=5 t=2.5e-03 per=1.1e+01 cost=6.0e+04 flops=2.4e+07
 sigma[gemm] counter=159 i=6 t=2.5e-03 per=1.1e+01 cost=6.5e+04 flops=2.6e+07
 sigma[gemm] counter=159 i=7 t=2.5e-03 per=1.1e+01 cost=6.7e+04 flops=2.7e+07
 sigma[gemm] counter=159 total t=1.0e-02 per=4.3e+01 cost=2.5e+05 flops=2.5e+07
 sigma[red] counter=159 t=1.1e-02 per=4.6e+01 cost=1.0e+05 flops=9.7e+06
----- TIMING FOR sigma_tot : t_inter=9.9e-01 t_gemm=4.0e+00 t_reduction=1.8e+00 tot=6.8e+00 -----
 sigma_tot[inter] counter=159 t=9.9e-01 per=1.5e+01 cost=5.9e+07 flops=6.0e+07
 sigma_tot[gemm] counter=159 i=0 t=2.1e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=1 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=2 t=1.9e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=3 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=4 t=1.0e+00 per=1.5e+01 cost=8.1e+06 flops=8.1e+06
 sigma_tot[gemm] counter=159 i=5 t=1.0e+00 per=1.5e+01 cost=8.2e+06 flops=8.1e+06
 sigma_tot[gemm] counter=159 i=6 t=9.9e-01 per=1.5e+01 cost=7.1e+06 flops=7.1e+06
 sigma_tot[gemm] counter=159 i=7 t=9.8e-01 per=1.5e+01 cost=7.2e+06 flops=7.3e+06
 sigma_tot[gemm] counter=159 total t=4.0e+00 per=5.9e+01 cost=3.1e+07 flops=7.7e+06
 sigma_tot[red] counter=159 t=1.8e+00 per=2.6e+01 cost=9.6e+06 flops=5.4e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=7.3e-06,1.0e-05,2.6e-06,1.2e-06,2.6e-07
settings: ndim=86 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.298332771619 -1.116e+03  6.972e-02    1     1  5.641e-02 5.641e-02 3.075e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.811e-03,2.559e-03,1.009e-02,1.044e-02,3.190e-02
 analyze_tgpu[Hx]: ndim=86:6.407e-07GB T(cpu-gpu)=2.102e-03 speed=6.095e-04GB/S T(nccl)=6.709e-03 speed=1.910e-04GB/S
----- TIMING FOR sigma : t_inter=2.6e-03 t_gemm=1.0e-02 t_reduction=1.0e-02 tot=2.3e-02 -----
 sigma[inter] counter=160 t=2.6e-03 per=1.1e+01 cost=6.4e+05 flops=2.5e+08
 sigma[gemm] counter=160 i=0 t=1.4e-06 per=6.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=1 t=1.2e-06 per=5.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=2 t=1.2e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=3 t=1.2e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=4 t=2.5e-03 per=1.1e+01 cost=6.0e+04 flops=2.4e+07
 sigma[gemm] counter=160 i=5 t=2.5e-03 per=1.1e+01 cost=6.0e+04 flops=2.4e+07
 sigma[gemm] counter=160 i=6 t=2.5e-03 per=1.1e+01 cost=6.5e+04 flops=2.6e+07
 sigma[gemm] counter=160 i=7 t=2.5e-03 per=1.1e+01 cost=6.7e+04 flops=2.7e+07
 sigma[gemm] counter=160 total t=1.0e-02 per=4.4e+01 cost=2.5e+05 flops=2.5e+07
 sigma[red] counter=160 t=1.0e-02 per=4.5e+01 cost=1.0e+05 flops=9.8e+06
----- TIMING FOR sigma_tot : t_inter=9.9e-01 t_gemm=4.0e+00 t_reduction=1.8e+00 tot=6.8e+00 -----
 sigma_tot[inter] counter=160 t=9.9e-01 per=1.5e+01 cost=6.0e+07 flops=6.1e+07
 sigma_tot[gemm] counter=160 i=0 t=2.2e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=1 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=2 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=3 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=4 t=1.0e+00 per=1.5e+01 cost=8.2e+06 flops=8.2e+06
 sigma_tot[gemm] counter=160 i=5 t=1.0e+00 per=1.5e+01 cost=8.3e+06 flops=8.1e+06
 sigma_tot[gemm] counter=160 i=6 t=9.9e-01 per=1.5e+01 cost=7.1e+06 flops=7.2e+06
 sigma_tot[gemm] counter=160 i=7 t=9.9e-01 per=1.5e+01 cost=7.2e+06 flops=7.3e+06
 sigma_tot[gemm] counter=160 total t=4.0e+00 per=5.9e+01 cost=3.1e+07 flops=7.7e+06
 sigma_tot[red] counter=160 t=1.8e+00 per=2.7e+01 cost=9.7e+06 flops=5.4e+06
T(sub)=5.0e-05 T(gemm/eig/ortho/gemm/axpy)=8.2e-06,3.6e-05,4.2e-06,1.7e-06,2.3e-07
    2   0 -    -116.310501515203 -1.217e-02  2.402e-02    2     2  8.871e-02 4.436e-02 3.144e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.933e-03,2.502e-03,1.005e-02,1.057e-02,3.206e-02
 analyze_tgpu[Hx]: ndim=86:6.407e-07GB T(cpu-gpu)=2.110e-03 speed=6.073e-04GB/S T(nccl)=6.823e-03 speed=1.878e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=161 t=2.5e-03 per=1.1e+01 cost=6.4e+05 flops=2.5e+08
 sigma[gemm] counter=161 i=0 t=1.3e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=1 t=1.2e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=2 t=1.2e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=3 t=1.1e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=4 t=2.5e-03 per=1.1e+01 cost=6.0e+04 flops=2.4e+07
 sigma[gemm] counter=161 i=5 t=2.5e-03 per=1.1e+01 cost=6.0e+04 flops=2.4e+07
 sigma[gemm] counter=161 i=6 t=2.5e-03 per=1.1e+01 cost=6.5e+04 flops=2.6e+07
 sigma[gemm] counter=161 i=7 t=2.5e-03 per=1.1e+01 cost=6.7e+04 flops=2.7e+07
 sigma[gemm] counter=161 total t=1.0e-02 per=4.3e+01 cost=2.5e+05 flops=2.5e+07
 sigma[red] counter=161 t=1.1e-02 per=4.6e+01 cost=1.0e+05 flops=9.7e+06
----- TIMING FOR sigma_tot : t_inter=9.9e-01 t_gemm=4.0e+00 t_reduction=1.8e+00 tot=6.8e+00 -----
 sigma_tot[inter] counter=161 t=9.9e-01 per=1.5e+01 cost=6.1e+07 flops=6.1e+07
 sigma_tot[gemm] counter=161 i=0 t=2.2e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=1 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=2 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=3 t=1.8e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=4 t=1.0e+00 per=1.5e+01 cost=8.3e+06 flops=8.2e+06
 sigma_tot[gemm] counter=161 i=5 t=1.0e+00 per=1.5e+01 cost=8.3e+06 flops=8.2e+06
 sigma_tot[gemm] counter=161 i=6 t=1.0e+00 per=1.5e+01 cost=7.2e+06 flops=7.2e+06
 sigma_tot[gemm] counter=161 i=7 t=9.9e-01 per=1.5e+01 cost=7.3e+06 flops=7.4e+06
 sigma_tot[gemm] counter=161 total t=4.0e+00 per=5.9e+01 cost=3.1e+07 flops=7.7e+06
 sigma_tot[red] counter=161 t=1.8e+00 per=2.7e+01 cost=9.8e+06 flops=5.4e+06
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,2.4e-05,1.3e-05,1.3e-06,2.1e-07
    3   0 -    -116.311884052254 -1.383e-03  9.447e-03    3     3  1.212e-01 4.038e-02 3.173e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.044e-03,2.508e-03,1.007e-02,1.062e-02,3.226e-02
 analyze_tgpu[Hx]: ndim=86:6.407e-07GB T(cpu-gpu)=2.053e-03 speed=6.241e-04GB/S T(nccl)=6.990e-03 speed=1.833e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=162 t=2.5e-03 per=1.1e+01 cost=6.4e+05 flops=2.5e+08
 sigma[gemm] counter=162 i=0 t=1.4e-06 per=6.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=1 t=1.2e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=2 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=3 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=4 t=2.5e-03 per=1.1e+01 cost=6.0e+04 flops=2.4e+07
 sigma[gemm] counter=162 i=5 t=2.5e-03 per=1.1e+01 cost=6.0e+04 flops=2.4e+07
 sigma[gemm] counter=162 i=6 t=2.5e-03 per=1.1e+01 cost=6.5e+04 flops=2.5e+07
 sigma[gemm] counter=162 i=7 t=2.5e-03 per=1.1e+01 cost=6.7e+04 flops=2.6e+07
 sigma[gemm] counter=162 total t=1.0e-02 per=4.3e+01 cost=2.5e+05 flops=2.5e+07
 sigma[red] counter=162 t=1.1e-02 per=4.6e+01 cost=1.0e+05 flops=9.6e+06
----- TIMING FOR sigma_tot : t_inter=9.9e-01 t_gemm=4.0e+00 t_reduction=1.8e+00 tot=6.8e+00 -----
 sigma_tot[inter] counter=162 t=9.9e-01 per=1.5e+01 cost=6.1e+07 flops=6.2e+07
 sigma_tot[gemm] counter=162 i=0 t=2.2e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=1 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=2 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=3 t=1.9e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=4 t=1.0e+00 per=1.5e+01 cost=8.3e+06 flops=8.3e+06
 sigma_tot[gemm] counter=162 i=5 t=1.0e+00 per=1.5e+01 cost=8.4e+06 flops=8.2e+06
 sigma_tot[gemm] counter=162 i=6 t=1.0e+00 per=1.5e+01 cost=7.3e+06 flops=7.3e+06
 sigma_tot[gemm] counter=162 i=7 t=9.9e-01 per=1.5e+01 cost=7.4e+06 flops=7.4e+06
 sigma_tot[gemm] counter=162 total t=4.0e+00 per=5.9e+01 cost=3.1e+07 flops=7.8e+06
 sigma_tot[red] counter=162 t=1.8e+00 per=2.7e+01 cost=9.9e+06 flops=5.4e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,3.2e-06,1.2e-06,1.9e-07
    4   0 -    -116.312110425422 -2.264e-04  3.195e-03    3     4  1.537e-01 3.843e-02 3.192e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.999e-03,2.549e-03,1.001e-02,1.039e-02,3.195e-02
 analyze_tgpu[Hx]: ndim=86:6.407e-07GB T(cpu-gpu)=2.216e-03 speed=5.783e-04GB/S T(nccl)=6.783e-03 speed=1.889e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.0e-02 tot=2.3e-02 -----
 sigma[inter] counter=163 t=2.5e-03 per=1.1e+01 cost=6.4e+05 flops=2.5e+08
 sigma[gemm] counter=163 i=0 t=1.3e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=1 t=1.2e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=2 t=1.1e-06 per=5.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=3 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=4 t=2.5e-03 per=1.1e+01 cost=6.0e+04 flops=2.4e+07
 sigma[gemm] counter=163 i=5 t=2.5e-03 per=1.1e+01 cost=6.0e+04 flops=2.4e+07
 sigma[gemm] counter=163 i=6 t=2.5e-03 per=1.1e+01 cost=6.5e+04 flops=2.6e+07
 sigma[gemm] counter=163 i=7 t=2.5e-03 per=1.1e+01 cost=6.7e+04 flops=2.7e+07
 sigma[gemm] counter=163 total t=1.0e-02 per=4.4e+01 cost=2.5e+05 flops=2.5e+07
 sigma[red] counter=163 t=1.0e-02 per=4.5e+01 cost=1.0e+05 flops=9.8e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=4.0e+00 t_reduction=1.8e+00 tot=6.9e+00 -----
 sigma_tot[inter] counter=163 t=1.0e+00 per=1.5e+01 cost=6.2e+07 flops=6.2e+07
 sigma_tot[gemm] counter=163 i=0 t=2.2e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=1 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=2 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=3 t=1.9e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=4 t=1.0e+00 per=1.5e+01 cost=8.4e+06 flops=8.3e+06
 sigma_tot[gemm] counter=163 i=5 t=1.0e+00 per=1.5e+01 cost=8.4e+06 flops=8.2e+06
 sigma_tot[gemm] counter=163 i=6 t=1.0e+00 per=1.5e+01 cost=7.3e+06 flops=7.3e+06
 sigma_tot[gemm] counter=163 i=7 t=1.0e+00 per=1.5e+01 cost=7.4e+06 flops=7.5e+06
 sigma_tot[gemm] counter=163 total t=4.0e+00 per=5.9e+01 cost=3.2e+07 flops=7.8e+06
 sigma_tot[red] counter=163 t=1.8e+00 per=2.7e+01 cost=1.0e+07 flops=5.5e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.4e-05,3.3e-06,1.2e-06,2.3e-07
    5   0 -    -116.312137751682 -2.733e-05  1.022e-03    3     5  1.860e-01 3.719e-02 3.197e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.859e-03,2.510e-03,1.000e-02,1.059e-02,3.197e-02
 analyze_tgpu[Hx]: ndim=86:6.407e-07GB T(cpu-gpu)=2.149e-03 speed=5.962e-04GB/S T(nccl)=6.710e-03 speed=1.910e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=164 t=2.5e-03 per=1.1e+01 cost=6.4e+05 flops=2.5e+08
 sigma[gemm] counter=164 i=0 t=1.3e-06 per=5.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=1 t=1.2e-06 per=5.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=2 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=3 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=4 t=2.5e-03 per=1.1e+01 cost=6.0e+04 flops=2.4e+07
 sigma[gemm] counter=164 i=5 t=2.5e-03 per=1.1e+01 cost=6.0e+04 flops=2.4e+07
 sigma[gemm] counter=164 i=6 t=2.5e-03 per=1.1e+01 cost=6.5e+04 flops=2.6e+07
 sigma[gemm] counter=164 i=7 t=2.5e-03 per=1.1e+01 cost=6.7e+04 flops=2.7e+07
 sigma[gemm] counter=164 total t=1.0e-02 per=4.3e+01 cost=2.5e+05 flops=2.5e+07
 sigma[red] counter=164 t=1.1e-02 per=4.6e+01 cost=1.0e+05 flops=9.6e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=4.0e+00 t_reduction=1.8e+00 tot=6.9e+00 -----
 sigma_tot[inter] counter=164 t=1.0e+00 per=1.5e+01 cost=6.2e+07 flops=6.3e+07
 sigma_tot[gemm] counter=164 i=0 t=2.2e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=1 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=2 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=3 t=1.9e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=4 t=1.0e+00 per=1.5e+01 cost=8.4e+06 flops=8.3e+06
 sigma_tot[gemm] counter=164 i=5 t=1.0e+00 per=1.5e+01 cost=8.5e+06 flops=8.3e+06
 sigma_tot[gemm] counter=164 i=6 t=1.0e+00 per=1.5e+01 cost=7.4e+06 flops=7.4e+06
 sigma_tot[gemm] counter=164 i=7 t=1.0e+00 per=1.4e+01 cost=7.5e+06 flops=7.5e+06
 sigma_tot[gemm] counter=164 total t=4.0e+00 per=5.9e+01 cost=3.2e+07 flops=7.9e+06
 sigma_tot[red] counter=164 t=1.8e+00 per=2.7e+01 cost=1.0e+07 flops=5.5e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.4e-05,3.3e-06,1.2e-06,2.2e-07
    6   0 -    -116.312140071379 -2.320e-06  2.735e-04    3     6  2.183e-01 3.638e-02 3.201e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.931e-03,2.544e-03,1.010e-02,1.072e-02,3.230e-02
 analyze_tgpu[Hx]: ndim=86:6.407e-07GB T(cpu-gpu)=2.135e-03 speed=6.003e-04GB/S T(nccl)=6.796e-03 speed=1.886e-04GB/S
----- TIMING FOR sigma : t_inter=2.5e-03 t_gemm=1.0e-02 t_reduction=1.1e-02 tot=2.3e-02 -----
 sigma[inter] counter=165 t=2.5e-03 per=1.1e+01 cost=6.4e+05 flops=2.5e+08
 sigma[gemm] counter=165 i=0 t=1.3e-06 per=5.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=1 t=1.2e-06 per=5.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=2 t=1.1e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=3 t=1.1e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=4 t=2.5e-03 per=1.1e+01 cost=6.0e+04 flops=2.4e+07
 sigma[gemm] counter=165 i=5 t=2.5e-03 per=1.1e+01 cost=6.0e+04 flops=2.4e+07
 sigma[gemm] counter=165 i=6 t=2.5e-03 per=1.1e+01 cost=6.5e+04 flops=2.6e+07
 sigma[gemm] counter=165 i=7 t=2.5e-03 per=1.1e+01 cost=6.7e+04 flops=2.6e+07
 sigma[gemm] counter=165 total t=1.0e-02 per=4.3e+01 cost=2.5e+05 flops=2.5e+07
 sigma[red] counter=165 t=1.1e-02 per=4.6e+01 cost=1.0e+05 flops=9.5e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=4.1e+00 t_reduction=1.9e+00 tot=6.9e+00 -----
 sigma_tot[inter] counter=165 t=1.0e+00 per=1.5e+01 cost=6.3e+07 flops=6.3e+07
 sigma_tot[gemm] counter=165 i=0 t=2.2e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=1 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=2 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=3 t=1.9e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=4 t=1.0e+00 per=1.5e+01 cost=8.5e+06 flops=8.4e+06
 sigma_tot[gemm] counter=165 i=5 t=1.0e+00 per=1.5e+01 cost=8.6e+06 flops=8.3e+06
 sigma_tot[gemm] counter=165 i=6 t=1.0e+00 per=1.5e+01 cost=7.5e+06 flops=7.4e+06
 sigma_tot[gemm] counter=165 i=7 t=1.0e+00 per=1.4e+01 cost=7.6e+06 flops=7.6e+06
 sigma_tot[gemm] counter=165 total t=4.1e+00 per=5.9e+01 cost=3.2e+07 flops=7.9e+06
 sigma_tot[red] counter=165 t=1.9e+00 per=2.7e+01 cost=1.0e+07 flops=5.5e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.4e-05,3.2e-06,1.2e-06,2.5e-07
    7   0 +    -116.312140236756 -1.654e-07  9.571e-05    3     7  2.508e-01 3.584e-02 3.207e-02
TIMING FOR Davidson : 2.509e-01  T(cal/comm/rest)=2.245e-01,8.811e-06,2.639e-02
decomposed t_rest=2.639e-02
 T(sub)    =2.071e-04 per=7.849e-01
 T(precond)=5.713e-05 per=2.165e-01
 T(ortho)  =1.576e-05 per=5.973e-02
 T(xcopy)  =1.109e-06 per=4.203e-03
 T(xnrm2)  =3.506e-06 per=1.329e-02
 T(other)  =2.610e-02 per=9.892e+01
optimized energies: isweep=0 ibond=27 dots=2 e[0]=-116.312140236756 nmvp=7
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.348e-02 change=6.964e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=14 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond27.txt
 qbond: qsuper nsym=14 dimAll=39
 (16,2):2 (16,4):2 (17,1):5 (17,3):5 (18,2):6 (17,5):3 (16,0):1 (18,4):4 (19,1):3 (19,3):2 (20,2):1 (19,5):1 (18,0):3 (18,6):1
timing for divide=1.8e-04
timing for compute=1.2e-04
timing for collect=2.4e-05
----- TMING FOR decimation_genbasis(su2): 3.2e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.8e-04,1.1e-04,0.0e+00,8.7e-06,2.4e-05 -----
decimation summary: 39->10 dwt=+1.716e-03 SvN=1.198e+00
 qbond: qkept nsym=7 dimAll=10
 (18,2):2 (18,4):2 (19,1):2 (17,1):1 (19,3):1 (19,5):1 (18,0):1
----- TIMING for decimation_row(nkr): 8.345e-04 S T(decim/select/formRot)=3.938e-04,2.995e-04,1.412e-04 -----
----- TIMING FOR twodot_decimation: 2.545e-03 S T(wf/decim)=1.556e-03,9.898e-04 -----
ctns::oper_renorm coord=(8,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:12 S:3 P:31 Q:36 
        dim(bra,ket)=10,10 size(op)=33:2.518e-04MB size(tot)=1199:9.148e-03MB:8.933e-06GB
        per(mem): H:1.33 C:15 S:3.75 P:6.34 Q:73.6 
rank=0 CPUmem(GB): used=1.014e+00 pageheap_free=1.347e-02 change=2.916e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=80 : 2.544e-03 S -----
rank=0 GPUmem(GB): used=5.263e-05 (oper)=2.756e-05
rank=0 GPUmem(GB): used=5.291e-05 (oper,site)=2.756e-05,2.757e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=80
 no. of rintermediate operators=103
 no. of coefficients=1133:8.644e-03MB:8.442e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.508e-03 S -----
rank=0 GPUmem(GB): used=6.135e-05 (oper,site,rinter)=2.756e-05,2.757e-07,8.442e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 4.397e-02 S size(rtasks)=80 size(Rlst2)=49 T(Rmu/Rlist)=6.745e-04,4.329e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.429e-02 S size(rtasks)=80 size(Rlst)=3277 -----
rank=0 GPUmem(GB): used=6.135e-05 avail=6.231e+00 total=6.231e+00 batch[need]=3.174e-04 blksize=4 blksize0=4 batchsize=3277
rank=0 GPUmem(GB): used=3.788e-04 (oper,site,rinter,batch)=2.756e-05,2.757e-07,8.442e-06,3.174e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.507e-03,2.264e-02,1.016e-02
----- TIMING FOR renorm : t_inter=5.5e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=331 t=5.5e-03 per=1.4e+01 cost=5.6e+04 flops=1.0e+07
 renorm[gemm] counter=331 i=0 t=1.4e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=331 i=1 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=331 i=2 t=7.5e-03 per=2.0e+01 cost=5.6e+03 flops=7.5e+05
 renorm[gemm] counter=331 i=3 t=7.5e-03 per=2.0e+01 cost=1.3e+04 flops=1.7e+06
 renorm[gemm] counter=331 i=4 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=331 i=5 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=331 i=6 t=7.6e-03 per=2.0e+01 cost=2.5e+04 flops=3.4e+06
 renorm[gemm] counter=331 total t=2.3e-02 per=5.9e+01 cost=4.4e+04 flops=2.0e+06
 renorm[red] counter=331 t=1.0e-02 per=2.7e+01 cost=1.8e+04 flops=1.7e+06
----- TIMING FOR renorm_tot : t_inter=1.7e-01 t_gemm=6.1e-01 t_reduction=2.6e-01 tot=1.0e+00 -----
 renorm_tot[inter] counter=331 t=1.7e-01 per=1.6e+01 cost=6.3e+05 flops=3.7e+06
 renorm_tot[gemm] counter=331 i=0 t=3.8e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=331 i=1 t=3.2e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=331 i=2 t=8.2e-02 per=7.8e+00 cost=3.4e+04 flops=4.2e+05
 renorm_tot[gemm] counter=331 i=3 t=7.1e-02 per=6.8e+00 cost=1.3e+05 flops=1.9e+06
 renorm_tot[gemm] counter=331 i=4 t=1.3e-01 per=1.2e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=331 i=5 t=1.3e-01 per=1.2e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=331 i=6 t=2.0e-01 per=1.9e+01 cost=4.1e+05 flops=2.1e+06
 renorm_tot[gemm] counter=331 total t=6.1e-01 per=5.8e+01 cost=7.7e+05 flops=1.3e+06
 renorm_tot[red] counter=331 t=2.6e-01 per=2.5e+01 cost=2.3e+05 flops=8.7e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=6.192e-05 (optmp,oper)=1.118e-07,2.756e-05
rank=0 GPUmem(GB): used=6.220e-05 (optmp,oper,site,rinter)=1.118e-07,2.756e-05,2.757e-07,7.376e-07
rank=0 GPUmem(GB): used=7.062e-05 (optmp,oper,site,rinter,batch)=1.118e-07,2.756e-05,2.757e-07,7.376e-07,8.427e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.713e-01 S T(prep/alloc/comp/red/dealloc)=6.227e-03,8.936e-03,2.087e-01,5.360e-02,2.588e-05 -----
----- TIMING FOR oper_renorm_opS : 2.714e-01 S rank=0 -----
qops.to_cpu: size(tot)=1199:9.148e-03MB:8.933e-06GB T(to_cpu)=1.220e-04S speed=7.323e-02GB/S
check ||H-H.dagger||=1.831e-15 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.407 S rank=0 -----
rank=0 CPUmem(GB): used=1.015e+00 pageheap_free=1.413e-02 change=9.078e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.484e-02 change=-2.327e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.013e+00 pageheap_free=1.484e-02 change=-6.363e-06 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.905e+00 S #####
 T(local opt: fetch) = 1.531e-02 S  per = 0.804  per(accum) = 0.804
 T(local opt: hdiag) = 4.733e-01 S  per = 24.8  per(accum) = 25.6
 T(local opt: dvdsn) = 1.001e+00 S  per = 52.6  per(accum) = 78.2
 T(local opt: decim) = 2.706e-03 S  per = 0.142  per(accum) = 78.3
 T(local opt: guess) = 2.030e-03 S  per = 0.107  per(accum) = 78.4
 T(local opt: renrm) = 4.103e-01 S  per = 21.5  per(accum) = 100
 T(local opt: save ) = 3.477e-04 S  per = 0.0183  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.001e+00 S  T(sum) = 9.994e-01 S  per = 9.983e+01
 T(local opt: preprocess                  ) = 1.361e-02 S  per = 1.36  per(accum) = 1.36
 T(local opt: symbolic_formulae           ) = 5.212e-03 S  per = 0.522  per(accum) = 1.88
 T(local opt: hintermediate init          ) = 2.873e-04 S  per = 0.0288  per(accum) = 1.91
 T(local opt: preprocess_hformulae_Hxlist ) = 4.864e-01 S  per = 48.7  per(accum) = 50.6
 T(local opt: hmmtasks init               ) = 2.393e-01 S  per = 23.9  per(accum) = 74.5
 T(local opt: initial guess for dvdson    ) = 3.712e-03 S  per = 0.371  per(accum) = 74.9
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.636e-01 S  per = 16.4  per(accum) = 91.3
 T(local opt: dvdson [cpu-gpu]            ) = 1.475e-02 S  per = 1.48  per(accum) = 92.7
 T(local opt: dvdson [nccl]               ) = 4.614e-02 S  per = 4.62  per(accum) = 97.4
 T(local opt: dvdson [mpi]                ) = 8.811e-06 S  per = 0.000882  per(accum) = 97.4
 T(local opt: dvdson [rest part(linalg)]  ) = 2.639e-02 S  per = 2.64  per(accum) = 100
Detailed decomposition of T(renrm) = 4.103e-01 S  T(sum) = 4.103e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.277e-04 S  per = 0.104  per(accum) = 0.104
 T(local opt: qops init                    ) = 4.344e-03 S  per = 1.06  per(accum) = 1.16
 T(local opt: symbolic_formulae_renorm     ) = 2.556e-03 S  per = 0.623  per(accum) = 1.79
 T(local opt: allocate qops on gpu         ) = 1.314e-04 S  per = 0.032  per(accum) = 1.82
 T(local opt: site memcpy cpu2gpu          ) = 9.566e-04 S  per = 0.233  per(accum) = 2.05
 T(local opt: rintermediate init           ) = 2.522e-03 S  per = 0.615  per(accum) = 2.67
 T(local opt: preprocess_formulae_Rlist2   ) = 4.440e-02 S  per = 10.8  per(accum) = 13.5
 T(local opt: rmmtasks init                ) = 2.097e-02 S  per = 5.11  per(accum) = 18.6
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 8.53e-06  per(accum) = 18.6
 T(local opt: preprocess_renorm_batchGPU   ) = 3.851e-02 S  per = 9.39  per(accum) = 28
 T(local opt: deallocate cpu and gpu memory) = 1.224e-04 S  per = 0.0298  per(accum) = 28
 T(local opt: construct opS [ifdists=true] ) = 2.714e-01 S  per = 66.2  per(accum) = 94.2
 T(local opt: reduction of opS & opH [nccl]) = 2.064e-02 S  per = 5.03  per(accum) = 99.2
 T(local opt: qops memcpy gpu2cpu          ) = 1.333e-04 S  per = 0.0325  per(accum) = 99.2
 T(local opt: reduction of opS & opH [mpi] ) = 1.153e-04 S  per = 0.0281  per(accum) = 99.3
 T(local opt: qops_pool join and erase     ) = 3.018e-03 S  per = 0.736  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.007e-05 S  per = 0.00245  per(accum) = 100
##### sweep opt: 4.065e+01 S #####
 T(sweep opt: fetch) = 3.381e-01 S  per = 0.832  per(accum) = 0.832
 T(sweep opt: hdiag) = 8.184e+00 S  per = 20.1  per(accum) = 21
 T(sweep opt: dvdsn) = 1.606e+01 S  per = 39.5  per(accum) = 60.5
 T(sweep opt: decim) = 4.059e-02 S  per = 0.0999  per(accum) = 60.6
 T(sweep opt: guess) = 2.612e-02 S  per = 0.0643  per(accum) = 60.6
 T(sweep opt: renrm) = 1.599e+01 S  per = 39.3  per(accum) = 100
 T(sweep opt: save ) = 6.513e-03 S  per = 0.016  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.606e+01 S  T(sum) = 1.604e+01 S  per = 9.987e+01
 T(sweep opt: preprocess                  ) = 1.367e-01 S  per = 0.852  per(accum) = 0.852
 T(sweep opt: symbolic_formulae           ) = 1.049e-01 S  per = 0.654  per(accum) = 1.51
 T(sweep opt: hintermediate init          ) = 5.652e-03 S  per = 0.0352  per(accum) = 1.54
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.935e+00 S  per = 30.8  per(accum) = 32.3
 T(sweep opt: hmmtasks init               ) = 2.213e+00 S  per = 13.8  per(accum) = 46.1
 T(sweep opt: initial guess for dvdson    ) = 3.862e-02 S  per = 0.241  per(accum) = 46.3
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.941e+00 S  per = 43.3  per(accum) = 89.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.284e-01 S  per = 2.05  per(accum) = 91.7
 T(sweep opt: dvdson [nccl]               ) = 1.297e+00 S  per = 8.09  per(accum) = 99.7
 T(sweep opt: dvdson [mpi]                ) = 1.610e-04 S  per = 0.001  per(accum) = 99.7
 T(sweep opt: dvdson [rest part(linalg)]  ) = 4.178e-02 S  per = 0.26  per(accum) = 100
Detailed decomposition of T(renrm) = 1.599e+01 S  T(sum) = 1.599e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.164e-03 S  per = 0.0511  per(accum) = 0.0511
 T(sweep opt: qops init                    ) = 6.950e-02 S  per = 0.435  per(accum) = 0.486
 T(sweep opt: symbolic_formulae_renorm     ) = 3.007e-02 S  per = 0.188  per(accum) = 0.674
 T(sweep opt: allocate qops on gpu         ) = 1.968e-03 S  per = 0.0123  per(accum) = 0.686
 T(sweep opt: site memcpy cpu2gpu          ) = 3.605e-02 S  per = 0.226  per(accum) = 0.912
 T(sweep opt: rintermediate init           ) = 6.274e-02 S  per = 0.392  per(accum) = 1.3
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.497e-01 S  per = 2.81  per(accum) = 4.12
 T(sweep opt: rmmtasks init                ) = 2.202e-01 S  per = 1.38  per(accum) = 5.49
 T(sweep opt: qops memset on cpu           ) = 9.820e-07 S  per = 6.14e-06  per(accum) = 5.49
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.045e+00 S  per = 6.54  per(accum) = 12
 T(sweep opt: deallocate cpu and gpu memory) = 1.971e-03 S  per = 0.0123  per(accum) = 12
 T(sweep opt: construct opS [ifdists=true] ) = 1.372e+01 S  per = 85.8  per(accum) = 97.8
 T(sweep opt: reduction of opS & opH [nccl]) = 8.220e-02 S  per = 0.514  per(accum) = 98.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.702e-03 S  per = 0.0169  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.753e-03 S  per = 0.011  per(accum) = 98.4
 T(sweep opt: qops_pool join and erase     ) = 5.965e-02 S  per = 0.373  per(accum) = 98.8
 T(sweep opt: conversion from opAB to opPQ ) = 1.989e-01 S  per = 1.24  per(accum) = 100
##### global opt: 4.065e+01 S #####
 T(global opt: fetch) = 3.381e-01 S  per = 0.832  per(accum) = 0.832
 T(global opt: hdiag) = 8.184e+00 S  per = 20.1  per(accum) = 21
 T(global opt: dvdsn) = 1.606e+01 S  per = 39.5  per(accum) = 60.5
 T(global opt: decim) = 4.059e-02 S  per = 0.0999  per(accum) = 60.6
 T(global opt: guess) = 2.612e-02 S  per = 0.0643  per(accum) = 60.6
 T(global opt: renrm) = 1.599e+01 S  per = 39.3  per(accum) = 100
 T(global opt: save ) = 6.513e-03 S  per = 0.016  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.606e+01 S  T(sum) = 1.604e+01 S  per = 9.987e+01
 T(global opt: preprocess                  ) = 1.367e-01 S  per = 0.852  per(accum) = 0.852
 T(global opt: symbolic_formulae           ) = 1.049e-01 S  per = 0.654  per(accum) = 1.51
 T(global opt: hintermediate init          ) = 5.652e-03 S  per = 0.0352  per(accum) = 1.54
 T(global opt: preprocess_hformulae_Hxlist ) = 4.935e+00 S  per = 30.8  per(accum) = 32.3
 T(global opt: hmmtasks init               ) = 2.213e+00 S  per = 13.8  per(accum) = 46.1
 T(global opt: initial guess for dvdson    ) = 3.862e-02 S  per = 0.241  per(accum) = 46.3
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.941e+00 S  per = 43.3  per(accum) = 89.6
 T(global opt: dvdson [cpu-gpu]            ) = 3.284e-01 S  per = 2.05  per(accum) = 91.7
 T(global opt: dvdson [nccl]               ) = 1.297e+00 S  per = 8.09  per(accum) = 99.7
 T(global opt: dvdson [mpi]                ) = 1.610e-04 S  per = 0.001  per(accum) = 99.7
 T(global opt: dvdson [rest part(linalg)]  ) = 4.178e-02 S  per = 0.26  per(accum) = 100
Detailed decomposition of T(renrm) = 1.599e+01 S  T(sum) = 1.599e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.164e-03 S  per = 0.0511  per(accum) = 0.0511
 T(global opt: qops init                    ) = 6.950e-02 S  per = 0.435  per(accum) = 0.486
 T(global opt: symbolic_formulae_renorm     ) = 3.007e-02 S  per = 0.188  per(accum) = 0.674
 T(global opt: allocate qops on gpu         ) = 1.968e-03 S  per = 0.0123  per(accum) = 0.686
 T(global opt: site memcpy cpu2gpu          ) = 3.605e-02 S  per = 0.226  per(accum) = 0.912
 T(global opt: rintermediate init           ) = 6.274e-02 S  per = 0.392  per(accum) = 1.3
 T(global opt: preprocess_formulae_Rlist2   ) = 4.497e-01 S  per = 2.81  per(accum) = 4.12
 T(global opt: rmmtasks init                ) = 2.202e-01 S  per = 1.38  per(accum) = 5.49
 T(global opt: qops memset on cpu           ) = 9.820e-07 S  per = 6.14e-06  per(accum) = 5.49
 T(global opt: preprocess_renorm_batchGPU   ) = 1.045e+00 S  per = 6.54  per(accum) = 12
 T(global opt: deallocate cpu and gpu memory) = 1.971e-03 S  per = 0.0123  per(accum) = 12
 T(global opt: construct opS [ifdists=true] ) = 1.372e+01 S  per = 85.8  per(accum) = 97.8
 T(global opt: reduction of opS & opH [nccl]) = 8.220e-02 S  per = 0.514  per(accum) = 98.4
 T(global opt: qops memcpy gpu2cpu          ) = 2.702e-03 S  per = 0.0169  per(accum) = 98.4
 T(global opt: reduction of opS & opH [mpi] ) = 1.753e-03 S  per = 0.011  per(accum) = 98.4
 T(global opt: qops_pool join and erase     ) = 5.965e-02 S  per = 0.373  per(accum) = 98.8
 T(global opt: conversion from opAB to opPQ ) = 1.989e-01 S  per = 1.24  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-6.937e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=28/seqsize=34 dots=2 dbond=(6,0)-(7,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=607:4.631e-03MB:4.523e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=36:2.747e-04MB:2.682e-07GB
total mem of comb=644:4.913e-03MB:4.798e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=6,12,1,1
 suppl= 0 1 2 3 4 16
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 17
 suppc2= 18
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(6,0)
 fqop[3]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:6 S:8 A:18 B:20 
        dim(bra,ket)=10,10 size(op)=31:2.365e-04MB size(tot)=748:5.707e-03MB:5.573e-06GB
        per(mem): H:1.87 C:12.8 S:17.1 A:8.02 B:60.2 
 rqops: oplist=HCSPQ nops=H:1 C:12 S:3 P:31 Q:36 
        dim(bra,ket)=10,10 size(op)=33:0.000252MB size(tot)=1199:0.00915MB:8.93e-06GB
        per(mem): H:1.33 C:15 S:3.75 P:6.34 Q:73.6 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3943:0.0301MB:2.94e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.029e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(7,0) fdel=./scratch/sweep/lop(6,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-5.305e-06 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=68:5.188e-04MB
qtensor4: wf4 own=1 _data=0x45711d40
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=8 dimAll=10
 (8,2):2 (8,4):2 (7,3):1 (9,3):1 (7,1):1 (9,1):1 (8,0):1 (7,5):1
 qbond: qcol nsym=7 dimAll=10
 (18,2):2 (18,4):2 (19,1):2 (17,1):1 (19,3):1 (19,5):1 (18,0):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=36 nblocks=837 size=68:5.188e-04MB
### DIAG TIMING: total=3.542e-01 t1=2.902e-05, t2=2.413e-04, t3=2.271e-03, t4=3.121e-01, t5=4.301e-06, t6=3.952e-02, t7=5.203e-06
duration_diagGPU:3.542e-01
duration_diagreduce:4.600e-08
duration_diagtransform:5.470e-07
----- TIMING FOR symbolic_formulae_twodot with size=310 : 4.326e-03 S -----
rank=0 GPUmem(GB): used=2.938e-05 (oper)=2.938e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=310
 no. of hintermediate operators=156
 no. of coefficients=1848:1.410e-02MB:1.377e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.690e-04 S -----
rank=0 GPUmem(GB): used=4.315e-05 (oper,hinter)=2.938e-05,1.377e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.353e-01 S size(H_formulae)=310 size(Hxlst2)=36 T(Hmu/Hxlist)=8.413e-04,2.345e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.377e-01 S size(H_formulae)=310 size(Hxlst)=13224 -----
rank=0 GPUmem(GB): used=4.315e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=1.013e-06 batch[need]=1.281e-03 blksize=4 blksize0=4 batchsize=13224
rank=0 GPUmem(GB): used=1.325e-03 (oper,hinter,dvdson,batch)=2.938e-05,1.377e-05,1.013e-06,1.281e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=68 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=3.041e-02,2.572e-03,1.727e-02,5.593e-03,5.586e-02
 analyze_tgpu[Hx]: ndim=68:5.066e-07GB T(cpu-gpu)=1.246e-03 speed=8.134e-04GB/S T(nccl)=2.917e-02 speed=3.474e-05GB/S
----- TIMING FOR sigma : t_inter=2.6e-03 t_gemm=1.7e-02 t_reduction=5.6e-03 tot=2.5e-02 -----
 sigma[inter] counter=166 t=2.6e-03 per=1.0e+01 cost=3.2e+05 flops=1.3e+08
 sigma[gemm] counter=166 i=0 t=1.7e-06 per=6.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=1 t=1.2e-06 per=4.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=2 t=1.1e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=3 t=1.1e-06 per=4.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=4 t=6.0e-03 per=2.4e+01 cost=3.2e+04 flops=5.3e+06
 sigma[gemm] counter=166 i=5 t=4.8e-03 per=1.9e+01 cost=3.2e+04 flops=6.8e+06
 sigma[gemm] counter=166 i=6 t=3.4e-03 per=1.3e+01 cost=3.1e+04 flops=9.1e+06
 sigma[gemm] counter=166 i=7 t=3.0e-03 per=1.2e+01 cost=3.1e+04 flops=1.0e+07
 sigma[gemm] counter=166 total t=1.7e-02 per=6.8e+01 cost=1.3e+05 flops=7.3e+06
 sigma[red] counter=166 t=5.6e-03 per=2.2e+01 cost=5.1e+04 flops=9.2e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=4.1e+00 t_reduction=1.9e+00 tot=6.9e+00 -----
 sigma_tot[inter] counter=166 t=1.0e+00 per=1.4e+01 cost=6.3e+07 flops=6.3e+07
 sigma_tot[gemm] counter=166 i=0 t=2.2e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=1 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=2 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=3 t=1.9e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=4 t=1.0e+00 per=1.5e+01 cost=8.5e+06 flops=8.3e+06
 sigma_tot[gemm] counter=166 i=5 t=1.0e+00 per=1.5e+01 cost=8.6e+06 flops=8.3e+06
 sigma_tot[gemm] counter=166 i=6 t=1.0e+00 per=1.5e+01 cost=7.5e+06 flops=7.4e+06
 sigma_tot[gemm] counter=166 i=7 t=1.0e+00 per=1.4e+01 cost=7.6e+06 flops=7.6e+06
 sigma_tot[gemm] counter=166 total t=4.1e+00 per=5.9e+01 cost=3.2e+07 flops=7.9e+06
 sigma_tot[red] counter=166 t=1.9e+00 per=2.7e+01 cost=1.0e+07 flops=5.5e+06
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,8.7e-06,2.3e-06,1.0e-06,2.2e-07
settings: ndim=68 neig=1 maxcycle=30 nbuff=4 memory=8e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.311332476513 -1.116e+03  1.018e-02    1     1  7.840e-02 7.840e-02 5.607e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.731e-03,5.331e-03,2.982e-02,1.054e-02,5.342e-02
 analyze_tgpu[Hx]: ndim=68:5.066e-07GB T(cpu-gpu)=3.280e-04 speed=3.089e-03GB/S T(nccl)=7.403e-03 speed=1.369e-04GB/S
----- TIMING FOR sigma : t_inter=5.3e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.6e-02 -----
 sigma[inter] counter=167 t=5.3e-03 per=1.2e+01 cost=3.2e+05 flops=6.1e+07
 sigma[gemm] counter=167 i=0 t=1.4e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=1 t=1.2e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=2 t=1.1e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=3 t=1.1e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=4 t=7.5e-03 per=1.6e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=167 i=5 t=7.4e-03 per=1.6e+01 cost=3.2e+04 flops=4.4e+06
 sigma[gemm] counter=167 i=6 t=7.5e-03 per=1.6e+01 cost=3.1e+04 flops=4.2e+06
 sigma[gemm] counter=167 i=7 t=7.4e-03 per=1.6e+01 cost=3.1e+04 flops=4.2e+06
 sigma[gemm] counter=167 total t=3.0e-02 per=6.5e+01 cost=1.3e+05 flops=4.2e+06
 sigma[red] counter=167 t=1.1e-02 per=2.3e+01 cost=5.1e+04 flops=4.9e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=4.1e+00 t_reduction=1.9e+00 tot=7.0e+00 -----
 sigma_tot[inter] counter=167 t=1.0e+00 per=1.4e+01 cost=6.4e+07 flops=6.3e+07
 sigma_tot[gemm] counter=167 i=0 t=2.3e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=1 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=2 t=1.9e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=3 t=1.9e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=4 t=1.0e+00 per=1.5e+01 cost=8.6e+06 flops=8.3e+06
 sigma_tot[gemm] counter=167 i=5 t=1.0e+00 per=1.5e+01 cost=8.6e+06 flops=8.3e+06
 sigma_tot[gemm] counter=167 i=6 t=1.0e+00 per=1.5e+01 cost=7.5e+06 flops=7.4e+06
 sigma_tot[gemm] counter=167 i=7 t=1.0e+00 per=1.4e+01 cost=7.6e+06 flops=7.6e+06
 sigma_tot[gemm] counter=167 total t=4.1e+00 per=5.9e+01 cost=3.2e+07 flops=7.9e+06
 sigma_tot[red] counter=167 t=1.9e+00 per=2.7e+01 cost=1.0e+07 flops=5.5e+06
T(sub)=8.6e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,5.5e-05,8.1e-06,1.7e-06,2.3e-07
    2   0 -    -116.311584298543 -2.518e-04  1.584e-03    2     2  1.321e-01 6.607e-02 5.482e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.794e-03,7.452e-03,2.976e-02,1.041e-02,5.643e-02
 analyze_tgpu[Hx]: ndim=68:5.066e-07GB T(cpu-gpu)=2.177e-03 speed=4.655e-04GB/S T(nccl)=6.618e-03 speed=1.531e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=168 t=7.5e-03 per=1.6e+01 cost=3.2e+05 flops=4.3e+07
 sigma[gemm] counter=168 i=0 t=1.3e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=3 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=4 t=7.4e-03 per=1.6e+01 cost=3.2e+04 flops=4.4e+06
 sigma[gemm] counter=168 i=5 t=7.4e-03 per=1.6e+01 cost=3.2e+04 flops=4.4e+06
 sigma[gemm] counter=168 i=6 t=7.5e-03 per=1.6e+01 cost=3.1e+04 flops=4.2e+06
 sigma[gemm] counter=168 i=7 t=7.5e-03 per=1.6e+01 cost=3.1e+04 flops=4.1e+06
 sigma[gemm] counter=168 total t=3.0e-02 per=6.2e+01 cost=1.3e+05 flops=4.2e+06
 sigma[red] counter=168 t=1.0e-02 per=2.2e+01 cost=5.1e+04 flops=4.9e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=4.1e+00 t_reduction=1.9e+00 tot=7.0e+00 -----
 sigma_tot[inter] counter=168 t=1.0e+00 per=1.4e+01 cost=6.4e+07 flops=6.3e+07
 sigma_tot[gemm] counter=168 i=0 t=2.3e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=1 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=2 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=3 t=1.9e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=4 t=1.0e+00 per=1.5e+01 cost=8.6e+06 flops=8.3e+06
 sigma_tot[gemm] counter=168 i=5 t=1.0e+00 per=1.5e+01 cost=8.7e+06 flops=8.3e+06
 sigma_tot[gemm] counter=168 i=6 t=1.0e+00 per=1.5e+01 cost=7.5e+06 flops=7.4e+06
 sigma_tot[gemm] counter=168 i=7 t=1.0e+00 per=1.4e+01 cost=7.7e+06 flops=7.5e+06
 sigma_tot[gemm] counter=168 total t=4.1e+00 per=5.9e+01 cost=3.2e+07 flops=7.9e+06
 sigma_tot[red] counter=168 t=1.9e+00 per=2.7e+01 cost=1.0e+07 flops=5.5e+06
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,3.8e-05,3.0e-06,1.3e-06,2.1e-07
    3   0 -    -116.311589083969 -4.785e-06  3.700e-04    3     3  1.889e-01 6.297e-02 5.543e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.071e-03,7.390e-03,2.980e-02,1.055e-02,5.482e-02
 analyze_tgpu[Hx]: ndim=68:5.066e-07GB T(cpu-gpu)=2.129e-03 speed=4.760e-04GB/S T(nccl)=4.942e-03 speed=2.050e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=169 t=7.4e-03 per=1.5e+01 cost=3.2e+05 flops=4.4e+07
 sigma[gemm] counter=169 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=1 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=3 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=4 t=7.5e-03 per=1.6e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=169 i=5 t=7.5e-03 per=1.6e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=169 i=6 t=7.4e-03 per=1.6e+01 cost=3.1e+04 flops=4.2e+06
 sigma[gemm] counter=169 i=7 t=7.4e-03 per=1.6e+01 cost=3.1e+04 flops=4.2e+06
 sigma[gemm] counter=169 total t=3.0e-02 per=6.2e+01 cost=1.3e+05 flops=4.2e+06
 sigma[red] counter=169 t=1.1e-02 per=2.2e+01 cost=5.1e+04 flops=4.9e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=4.2e+00 t_reduction=1.9e+00 tot=7.1e+00 -----
 sigma_tot[inter] counter=169 t=1.0e+00 per=1.4e+01 cost=6.4e+07 flops=6.3e+07
 sigma_tot[gemm] counter=169 i=0 t=2.3e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=1 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=2 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=3 t=1.9e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=4 t=1.0e+00 per=1.5e+01 cost=8.6e+06 flops=8.3e+06
 sigma_tot[gemm] counter=169 i=5 t=1.1e+00 per=1.5e+01 cost=8.7e+06 flops=8.2e+06
 sigma_tot[gemm] counter=169 i=6 t=1.0e+00 per=1.5e+01 cost=7.6e+06 flops=7.3e+06
 sigma_tot[gemm] counter=169 i=7 t=1.0e+00 per=1.4e+01 cost=7.7e+06 flops=7.5e+06
 sigma_tot[gemm] counter=169 total t=4.2e+00 per=5.9e+01 cost=3.3e+07 flops=7.8e+06
 sigma_tot[red] counter=169 t=1.9e+00 per=2.7e+01 cost=1.0e+07 flops=5.5e+06
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.7e-05,3.3e-06,1.1e-06,2.6e-07
    4   0 -    -116.311589385662 -3.017e-07  1.345e-04    3     4  2.439e-01 6.098e-02 5.531e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.858e-03,7.550e-03,2.970e-02,1.046e-02,5.658e-02
 analyze_tgpu[Hx]: ndim=68:5.066e-07GB T(cpu-gpu)=2.296e-03 speed=4.414e-04GB/S T(nccl)=6.562e-03 speed=1.544e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.0e-02 tot=4.8e-02 -----
 sigma[inter] counter=170 t=7.5e-03 per=1.6e+01 cost=3.2e+05 flops=4.3e+07
 sigma[gemm] counter=170 i=0 t=1.3e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=1 t=1.2e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=3 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=4 t=7.5e-03 per=1.6e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=170 i=5 t=7.4e-03 per=1.6e+01 cost=3.2e+04 flops=4.4e+06
 sigma[gemm] counter=170 i=6 t=7.4e-03 per=1.5e+01 cost=3.1e+04 flops=4.2e+06
 sigma[gemm] counter=170 i=7 t=7.4e-03 per=1.5e+01 cost=3.1e+04 flops=4.2e+06
 sigma[gemm] counter=170 total t=3.0e-02 per=6.2e+01 cost=1.3e+05 flops=4.3e+06
 sigma[red] counter=170 t=1.0e-02 per=2.2e+01 cost=5.1e+04 flops=4.9e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=4.2e+00 t_reduction=1.9e+00 tot=7.1e+00 -----
 sigma_tot[inter] counter=170 t=1.0e+00 per=1.4e+01 cost=6.5e+07 flops=6.3e+07
 sigma_tot[gemm] counter=170 i=0 t=2.3e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=1 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=2 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=3 t=1.9e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=4 t=1.1e+00 per=1.5e+01 cost=8.7e+06 flops=8.2e+06
 sigma_tot[gemm] counter=170 i=5 t=1.1e+00 per=1.5e+01 cost=8.7e+06 flops=8.2e+06
 sigma_tot[gemm] counter=170 i=6 t=1.0e+00 per=1.5e+01 cost=7.6e+06 flops=7.3e+06
 sigma_tot[gemm] counter=170 i=7 t=1.0e+00 per=1.5e+01 cost=7.7e+06 flops=7.5e+06
 sigma_tot[gemm] counter=170 total t=4.2e+00 per=5.9e+01 cost=3.3e+07 flops=7.8e+06
 sigma_tot[red] counter=170 t=1.9e+00 per=2.7e+01 cost=1.0e+07 flops=5.5e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.5e-05,3.3e-06,1.1e-06,2.1e-07
    5   0 +    -116.311589429488 -4.383e-08  3.711e-05    3     5  3.008e-01 6.017e-02 5.561e-02
TIMING FOR Davidson : 3.009e-01  T(cal/comm/rest)=2.780e-01,8.001e-06,2.280e-02
decomposed t_rest=2.280e-02
 T(sub)    =2.016e-04 per=8.845e-01
 T(precond)=4.231e-05 per=1.856e-01
 T(ortho)  =1.035e-05 per=4.540e-02
 T(xcopy)  =3.494e-06 per=1.533e-02
 T(xnrm2)  =2.358e-06 per=1.034e-02
 T(other)  =2.254e-02 per=9.886e+01
optimized energies: isweep=0 ibond=28 dots=2 e[0]=-116.311589429488 nmvp=5
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=5.478e-03 change=3.628e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=14 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond28.txt
 qbond: qsuper nsym=14 dimAll=39
 (18,2):3 (18,4):2 (19,1):6 (17,1):1 (19,3):5 (19,5):3 (18,0):2 (20,2):5 (20,4):4 (21,1):2 (21,3):1 (21,5):1 (20,0):3 (20,6):1
timing for divide=1.7e-04
timing for compute=1.2e-04
timing for collect=2.0e-05
----- TMING FOR decimation_genbasis(su2): 3.1e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.7e-04,1.1e-04,0.0e+00,8.6e-06,2.0e-05 -----
decimation summary: 39->10 dwt=+2.011e-06 SvN=1.269e+00
 qbond: qkept nsym=8 dimAll=10
 (20,2):2 (20,4):2 (19,1):1 (19,3):1 (21,1):1 (21,3):1 (21,5):1 (20,0):1
----- TIMING for decimation_row(nkr): 8.447e-04 S T(decim/select/formRot)=3.763e-04,3.159e-04,1.525e-04 -----
----- TIMING FOR twodot_decimation: 2.525e-03 S T(wf/decim)=1.516e-03,1.009e-03 -----
ctns::oper_renorm coord=(7,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:13 S:3 P:27 Q:26 
        dim(bra,ket)=10,10 size(op)=31:2.365e-04MB size(tot)=945:7.210e-03MB:7.041e-06GB
        per(mem): H:1.48 C:22 S:5.08 P:9.52 Q:61.9 
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=5.440e-03 change=3.056e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=67 : 2.038e-03 S -----
rank=0 GPUmem(GB): used=4.461e-05 (oper)=2.341e-05
rank=0 GPUmem(GB): used=4.488e-05 (oper,site)=2.341e-05,2.682e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=67
 no. of rintermediate operators=79
 no. of coefficients=948:7.233e-03MB:7.063e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.469e-03 S -----
rank=0 GPUmem(GB): used=5.195e-05 (oper,site,rinter)=2.341e-05,2.682e-07,7.063e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 3.850e-02 S size(rtasks)=67 size(Rlst2)=64 T(Rmu/Rlist)=5.479e-04,3.795e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.900e-02 S size(rtasks)=67 size(Rlst)=2655 -----
rank=0 GPUmem(GB): used=5.195e-05 avail=6.231e+00 total=6.231e+00 batch[need]=2.572e-04 blksize=4 blksize0=4 batchsize=2655
rank=0 GPUmem(GB): used=3.091e-04 (oper,site,rinter,batch)=2.341e-05,2.682e-07,7.063e-06,2.572e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.629e-03,2.274e-02,1.001e-02
----- TIMING FOR renorm : t_inter=6.6e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=340 t=6.6e-03 per=1.7e+01 cost=5.0e+04 flops=7.5e+06
 renorm[gemm] counter=340 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=340 i=1 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=340 i=2 t=7.5e-03 per=1.9e+01 cost=3.7e+03 flops=5.0e+05
 renorm[gemm] counter=340 i=3 t=7.6e-03 per=1.9e+01 cost=1.0e+04 flops=1.4e+06
 renorm[gemm] counter=340 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=340 i=5 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=340 i=6 t=7.7e-03 per=2.0e+01 cost=1.6e+04 flops=2.1e+06
 renorm[gemm] counter=340 total t=2.3e-02 per=5.8e+01 cost=3.0e+04 flops=1.3e+06
 renorm[red] counter=340 t=1.0e-02 per=2.5e+01 cost=1.1e+04 flops=1.1e+06
----- TIMING FOR renorm_tot : t_inter=1.8e-01 t_gemm=6.3e-01 t_reduction=2.7e-01 tot=1.1e+00 -----
 renorm_tot[inter] counter=340 t=1.8e-01 per=1.6e+01 cost=6.8e+05 flops=3.9e+06
 renorm_tot[gemm] counter=340 i=0 t=3.9e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=340 i=1 t=3.3e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=340 i=2 t=8.9e-02 per=8.2e+00 cost=3.8e+04 flops=4.2e+05
 renorm_tot[gemm] counter=340 i=3 t=7.8e-02 per=7.3e+00 cost=1.4e+05 flops=1.8e+06
 renorm_tot[gemm] counter=340 i=4 t=1.3e-01 per=1.2e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=340 i=5 t=1.3e-01 per=1.2e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=340 i=6 t=2.1e-01 per=1.9e+01 cost=4.3e+05 flops=2.1e+06
 renorm_tot[gemm] counter=340 total t=6.3e-01 per=5.8e+01 cost=8.0e+05 flops=1.3e+06
 renorm_tot[red] counter=340 t=2.7e-01 per=2.5e+01 cost=2.4e+05 flops=8.8e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=5.260e-05 (optmp,oper)=1.192e-07,2.341e-05
rank=0 GPUmem(GB): used=5.287e-05 (optmp,oper,site,rinter)=1.192e-07,2.341e-05,2.682e-07,8.047e-07
rank=0 GPUmem(GB): used=6.256e-05 (optmp,oper,site,rinter,batch)=1.192e-07,2.341e-05,2.682e-07,8.047e-07,9.686e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.858e-01 S T(prep/alloc/comp/red/dealloc)=6.884e-03,9.300e-03,2.129e-01,6.104e-02,2.470e-03 -----
----- TIMING FOR oper_renorm_opS : 2.859e-01 S rank=0 -----
qops.to_cpu: size(tot)=945:7.210e-03MB:7.041e-06GB T(to_cpu)=1.018e-04S speed=6.915e-02GB/S
check ||H-H.dagger||=1.714e-16 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.395 S rank=0 -----
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=5.066e-03 change=7.480e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=5.684e-03 change=-2.040e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=5.684e-03 change=-6.989e-06 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.434e+00 S #####
 T(local opt: fetch) = 1.403e-02 S  per = 0.978  per(accum) = 0.978
 T(local opt: hdiag) = 3.560e-01 S  per = 24.8  per(accum) = 25.8
 T(local opt: dvdsn) = 6.612e-01 S  per = 46.1  per(accum) = 71.9
 T(local opt: decim) = 2.851e-03 S  per = 0.199  per(accum) = 72.1
 T(local opt: guess) = 2.006e-03 S  per = 0.14  per(accum) = 72.2
 T(local opt: renrm) = 3.979e-01 S  per = 27.7  per(accum) = 100
 T(local opt: save ) = 2.942e-04 S  per = 0.0205  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.612e-01 S  T(sum) = 6.603e-01 S  per = 9.985e+01
 T(local opt: preprocess                  ) = 1.371e-02 S  per = 2.08  per(accum) = 2.08
 T(local opt: symbolic_formulae           ) = 4.343e-03 S  per = 0.658  per(accum) = 2.73
 T(local opt: hintermediate init          ) = 2.038e-04 S  per = 0.0309  per(accum) = 2.76
 T(local opt: preprocess_hformulae_Hxlist ) = 2.382e-01 S  per = 36.1  per(accum) = 38.8
 T(local opt: hmmtasks init               ) = 9.934e-02 S  per =   15  per(accum) = 53.9
 T(local opt: initial guess for dvdson    ) = 3.620e-03 S  per = 0.548  per(accum) = 54.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.152e-01 S  per = 32.6  per(accum) = 87
 T(local opt: dvdson [cpu-gpu]            ) = 8.175e-03 S  per = 1.24  per(accum) = 88.3
 T(local opt: dvdson [nccl]               ) = 5.469e-02 S  per = 8.28  per(accum) = 96.5
 T(local opt: dvdson [mpi]                ) = 8.001e-06 S  per = 0.00121  per(accum) = 96.5
 T(local opt: dvdson [rest part(linalg)]  ) = 2.280e-02 S  per = 3.45  per(accum) = 100
Detailed decomposition of T(renrm) = 3.979e-01 S  T(sum) = 3.979e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.834e-04 S  per = 0.121  per(accum) = 0.121
 T(local opt: qops init                    ) = 4.861e-03 S  per = 1.22  per(accum) = 1.34
 T(local opt: symbolic_formulae_renorm     ) = 2.050e-03 S  per = 0.515  per(accum) = 1.86
 T(local opt: allocate qops on gpu         ) = 7.699e-05 S  per = 0.0193  per(accum) = 1.88
 T(local opt: site memcpy cpu2gpu          ) = 1.457e-03 S  per = 0.366  per(accum) = 2.24
 T(local opt: rintermediate init           ) = 2.483e-03 S  per = 0.624  per(accum) = 2.87
 T(local opt: preprocess_formulae_Rlist2   ) = 3.909e-02 S  per = 9.82  per(accum) = 12.7
 T(local opt: rmmtasks init                ) = 1.666e-02 S  per = 4.19  per(accum) = 16.9
 T(local opt: qops memset on cpu           ) = 3.000e-08 S  per = 7.54e-06  per(accum) = 16.9
 T(local opt: preprocess_renorm_batchGPU   ) = 3.950e-02 S  per = 9.93  per(accum) = 26.8
 T(local opt: deallocate cpu and gpu memory) = 1.065e-04 S  per = 0.0268  per(accum) = 26.8
 T(local opt: construct opS [ifdists=true] ) = 2.859e-01 S  per = 71.8  per(accum) = 98.7
 T(local opt: reduction of opS & opH [nccl]) = 2.359e-03 S  per = 0.593  per(accum) = 99.3
 T(local opt: qops memcpy gpu2cpu          ) = 1.127e-04 S  per = 0.0283  per(accum) = 99.3
 T(local opt: reduction of opS & opH [mpi] ) = 1.139e-04 S  per = 0.0286  per(accum) = 99.3
 T(local opt: qops_pool join and erase     ) = 2.667e-03 S  per = 0.67  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.161e-05 S  per = 0.00292  per(accum) = 100
##### sweep opt: 4.208e+01 S #####
 T(sweep opt: fetch) = 3.521e-01 S  per = 0.837  per(accum) = 0.837
 T(sweep opt: hdiag) = 8.540e+00 S  per = 20.3  per(accum) = 21.1
 T(sweep opt: dvdsn) = 1.672e+01 S  per = 39.7  per(accum) = 60.9
 T(sweep opt: decim) = 4.344e-02 S  per = 0.103  per(accum) = 61
 T(sweep opt: guess) = 2.813e-02 S  per = 0.0668  per(accum) = 61
 T(sweep opt: renrm) = 1.639e+01 S  per = 38.9  per(accum) = 100
 T(sweep opt: save ) = 6.807e-03 S  per = 0.0162  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.672e+01 S  T(sum) = 1.670e+01 S  per = 9.987e+01
 T(sweep opt: preprocess                  ) = 1.504e-01 S  per = 0.901  per(accum) = 0.901
 T(sweep opt: symbolic_formulae           ) = 1.093e-01 S  per = 0.654  per(accum) = 1.55
 T(sweep opt: hintermediate init          ) = 5.856e-03 S  per = 0.0351  per(accum) = 1.59
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.173e+00 S  per =   31  per(accum) = 32.6
 T(sweep opt: hmmtasks init               ) = 2.312e+00 S  per = 13.8  per(accum) = 46.4
 T(sweep opt: initial guess for dvdson    ) = 4.224e-02 S  per = 0.253  per(accum) = 46.7
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 7.157e+00 S  per = 42.8  per(accum) = 89.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.366e-01 S  per = 2.02  per(accum) = 91.5
 T(sweep opt: dvdson [nccl]               ) = 1.352e+00 S  per = 8.09  per(accum) = 99.6
 T(sweep opt: dvdson [mpi]                ) = 1.690e-04 S  per = 0.00101  per(accum) = 99.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.458e-02 S  per = 0.387  per(accum) = 100
Detailed decomposition of T(renrm) = 1.639e+01 S  T(sum) = 1.639e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.648e-03 S  per = 0.0528  per(accum) = 0.0528
 T(sweep opt: qops init                    ) = 7.436e-02 S  per = 0.454  per(accum) = 0.507
 T(sweep opt: symbolic_formulae_renorm     ) = 3.212e-02 S  per = 0.196  per(accum) = 0.703
 T(sweep opt: allocate qops on gpu         ) = 2.045e-03 S  per = 0.0125  per(accum) = 0.715
 T(sweep opt: site memcpy cpu2gpu          ) = 3.751e-02 S  per = 0.229  per(accum) = 0.944
 T(sweep opt: rintermediate init           ) = 6.523e-02 S  per = 0.398  per(accum) = 1.34
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.888e-01 S  per = 2.98  per(accum) = 4.33
 T(sweep opt: rmmtasks init                ) = 2.369e-01 S  per = 1.45  per(accum) = 5.77
 T(sweep opt: qops memset on cpu           ) = 1.012e-06 S  per = 6.18e-06  per(accum) = 5.77
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.084e+00 S  per = 6.62  per(accum) = 12.4
 T(sweep opt: deallocate cpu and gpu memory) = 2.077e-03 S  per = 0.0127  per(accum) = 12.4
 T(sweep opt: construct opS [ifdists=true] ) = 1.400e+01 S  per = 85.5  per(accum) = 97.9
 T(sweep opt: reduction of opS & opH [nccl]) = 8.456e-02 S  per = 0.516  per(accum) = 98.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.815e-03 S  per = 0.0172  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.867e-03 S  per = 0.0114  per(accum) = 98.4
 T(sweep opt: qops_pool join and erase     ) = 6.232e-02 S  per = 0.38  per(accum) = 98.8
 T(sweep opt: conversion from opAB to opPQ ) = 1.989e-01 S  per = 1.21  per(accum) = 100
##### global opt: 4.208e+01 S #####
 T(global opt: fetch) = 3.521e-01 S  per = 0.837  per(accum) = 0.837
 T(global opt: hdiag) = 8.540e+00 S  per = 20.3  per(accum) = 21.1
 T(global opt: dvdsn) = 1.672e+01 S  per = 39.7  per(accum) = 60.9
 T(global opt: decim) = 4.344e-02 S  per = 0.103  per(accum) = 61
 T(global opt: guess) = 2.813e-02 S  per = 0.0668  per(accum) = 61
 T(global opt: renrm) = 1.639e+01 S  per = 38.9  per(accum) = 100
 T(global opt: save ) = 6.807e-03 S  per = 0.0162  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.672e+01 S  T(sum) = 1.670e+01 S  per = 9.987e+01
 T(global opt: preprocess                  ) = 1.504e-01 S  per = 0.901  per(accum) = 0.901
 T(global opt: symbolic_formulae           ) = 1.093e-01 S  per = 0.654  per(accum) = 1.55
 T(global opt: hintermediate init          ) = 5.856e-03 S  per = 0.0351  per(accum) = 1.59
 T(global opt: preprocess_hformulae_Hxlist ) = 5.173e+00 S  per =   31  per(accum) = 32.6
 T(global opt: hmmtasks init               ) = 2.312e+00 S  per = 13.8  per(accum) = 46.4
 T(global opt: initial guess for dvdson    ) = 4.224e-02 S  per = 0.253  per(accum) = 46.7
 T(global opt: dvdson [Hx_batchGPU]        ) = 7.157e+00 S  per = 42.8  per(accum) = 89.5
 T(global opt: dvdson [cpu-gpu]            ) = 3.366e-01 S  per = 2.02  per(accum) = 91.5
 T(global opt: dvdson [nccl]               ) = 1.352e+00 S  per = 8.09  per(accum) = 99.6
 T(global opt: dvdson [mpi]                ) = 1.690e-04 S  per = 0.00101  per(accum) = 99.6
 T(global opt: dvdson [rest part(linalg)]  ) = 6.458e-02 S  per = 0.387  per(accum) = 100
Detailed decomposition of T(renrm) = 1.639e+01 S  T(sum) = 1.639e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.648e-03 S  per = 0.0528  per(accum) = 0.0528
 T(global opt: qops init                    ) = 7.436e-02 S  per = 0.454  per(accum) = 0.507
 T(global opt: symbolic_formulae_renorm     ) = 3.212e-02 S  per = 0.196  per(accum) = 0.703
 T(global opt: allocate qops on gpu         ) = 2.045e-03 S  per = 0.0125  per(accum) = 0.715
 T(global opt: site memcpy cpu2gpu          ) = 3.751e-02 S  per = 0.229  per(accum) = 0.944
 T(global opt: rintermediate init           ) = 6.523e-02 S  per = 0.398  per(accum) = 1.34
 T(global opt: preprocess_formulae_Rlist2   ) = 4.888e-01 S  per = 2.98  per(accum) = 4.33
 T(global opt: rmmtasks init                ) = 2.369e-01 S  per = 1.45  per(accum) = 5.77
 T(global opt: qops memset on cpu           ) = 1.012e-06 S  per = 6.18e-06  per(accum) = 5.77
 T(global opt: preprocess_renorm_batchGPU   ) = 1.084e+00 S  per = 6.62  per(accum) = 12.4
 T(global opt: deallocate cpu and gpu memory) = 2.077e-03 S  per = 0.0127  per(accum) = 12.4
 T(global opt: construct opS [ifdists=true] ) = 1.400e+01 S  per = 85.5  per(accum) = 97.9
 T(global opt: reduction of opS & opH [nccl]) = 8.456e-02 S  per = 0.516  per(accum) = 98.4
 T(global opt: qops memcpy gpu2cpu          ) = 2.815e-03 S  per = 0.0172  per(accum) = 98.4
 T(global opt: reduction of opS & opH [mpi] ) = 1.867e-03 S  per = 0.0114  per(accum) = 98.4
 T(global opt: qops_pool join and erase     ) = 6.232e-02 S  per = 0.38  per(accum) = 98.8
 T(global opt: conversion from opAB to opPQ ) = 1.989e-01 S  per = 1.21  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-3.604e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=29/seqsize=34 dots=2 dbond=(5,0)-(6,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=611:4.662e-03MB:4.552e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=32:2.441e-04MB:2.384e-07GB
total mem of comb=644:4.913e-03MB:4.798e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=5,13,1,1
 suppl= 0 1 2 3 4
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 16
 suppc2= 17
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(5,0)
 fqop[3]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:5 S:8 A:12 B:16 
        dim(bra,ket)=6,6 size(op)=14:1.068e-04MB size(tot)=305:2.327e-03MB:2.272e-06GB
        per(mem): H:2.62 C:13.1 S:21 A:5.57 B:57.7 
 rqops: oplist=HCSPQ nops=H:1 C:13 S:3 P:27 Q:26 
        dim(bra,ket)=10,10 size(op)=31:0.000237MB size(tot)=945:0.00721MB:7.04e-06GB
        per(mem): H:1.48 C:22 S:5.08 P:9.52 Q:61.9 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3246:0.0248MB:2.42e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=8.845e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(6,0) fdel=./scratch/sweep/lop(5,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.967e-06 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(6,10,3,3) nnz=73:5.569e-04MB
qtensor4: wf4 own=1 _data=0x3db5ac80
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=5 dimAll=6
 (7,3):2 (6,2):1 (8,2):1 (7,1):1 (6,4):1
 qbond: qcol nsym=8 dimAll=10
 (20,2):2 (20,4):2 (19,1):1 (19,3):1 (21,1):1 (21,3):1 (21,5):1 (20,0):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=45 nblocks=620 size=73:5.569e-04MB
### DIAG TIMING: total=2.618e-01 t1=2.745e-05, t2=6.805e-04, t3=2.508e-03, t4=2.561e-01, t5=3.981e-06, t6=2.467e-03, t7=5.327e-06
duration_diagGPU:2.618e-01
duration_diagreduce:8.300e-08
duration_diagtransform:6.930e-07
----- TIMING FOR symbolic_formulae_twodot with size=247 : 3.460e-03 S -----
rank=0 GPUmem(GB): used=2.418e-05 (oper)=2.418e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=247
 no. of hintermediate operators=122
 no. of coefficients=1502:1.146e-02MB:1.119e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.665e-04 S -----
rank=0 GPUmem(GB): used=3.538e-05 (oper,hinter)=2.418e-05,1.119e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.733e-01 S size(H_formulae)=247 size(Hxlst2)=45 T(Hmu/Hxlist)=6.791e-04,2.726e-01 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.763e-01 S size(H_formulae)=247 size(Hxlst)=16388 -----
rank=0 GPUmem(GB): used=3.538e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=1.088e-06 batch[need]=1.587e-03 blksize=4 blksize0=4 batchsize=16388
rank=0 GPUmem(GB): used=1.624e-03 (oper,hinter,dvdson,batch)=2.418e-05,1.119e-05,1.088e-06,1.587e-03
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=73 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.119e-03,7.534e-03,3.024e-02,1.082e-02,5.673e-02
 analyze_tgpu[Hx]: ndim=73:5.439e-07GB T(cpu-gpu)=1.966e-03 speed=5.533e-04GB/S T(nccl)=6.153e-03 speed=1.768e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.9e-02 -----
 sigma[inter] counter=171 t=7.5e-03 per=1.6e+01 cost=3.5e+05 flops=4.7e+07
 sigma[gemm] counter=171 i=0 t=1.6e-06 per=3.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=2 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=4 t=7.5e-03 per=1.5e+01 cost=3.2e+04 flops=4.2e+06
 sigma[gemm] counter=171 i=5 t=7.6e-03 per=1.6e+01 cost=3.2e+04 flops=4.2e+06
 sigma[gemm] counter=171 i=6 t=7.6e-03 per=1.6e+01 cost=3.4e+04 flops=4.4e+06
 sigma[gemm] counter=171 i=7 t=7.5e-03 per=1.5e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=171 total t=3.0e-02 per=6.2e+01 cost=1.3e+05 flops=4.3e+06
 sigma[red] counter=171 t=1.1e-02 per=2.2e+01 cost=5.7e+04 flops=5.3e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=4.2e+00 t_reduction=1.9e+00 tot=7.2e+00 -----
 sigma_tot[inter] counter=171 t=1.0e+00 per=1.4e+01 cost=6.5e+07 flops=6.3e+07
 sigma_tot[gemm] counter=171 i=0 t=2.3e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=1 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=2 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=3 t=2.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=4 t=1.1e+00 per=1.5e+01 cost=8.7e+06 flops=8.2e+06
 sigma_tot[gemm] counter=171 i=5 t=1.1e+00 per=1.5e+01 cost=8.7e+06 flops=8.2e+06
 sigma_tot[gemm] counter=171 i=6 t=1.0e+00 per=1.5e+01 cost=7.6e+06 flops=7.3e+06
 sigma_tot[gemm] counter=171 i=7 t=1.0e+00 per=1.5e+01 cost=7.8e+06 flops=7.5e+06
 sigma_tot[gemm] counter=171 total t=4.2e+00 per=5.9e+01 cost=3.3e+07 flops=7.8e+06
 sigma_tot[red] counter=171 t=1.9e+00 per=2.7e+01 cost=1.1e+07 flops=5.5e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=7.4e-06,8.6e-06,2.3e-06,9.7e-07,2.1e-07
settings: ndim=73 neig=1 maxcycle=30 nbuff=4 memory=8e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.311588118003 -1.116e+03  5.505e-02    1     1  5.704e-02 5.704e-02 5.699e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.554e-03,7.446e-03,2.988e-02,1.068e-02,5.656e-02
 analyze_tgpu[Hx]: ndim=73:5.439e-07GB T(cpu-gpu)=2.126e-03 speed=5.117e-04GB/S T(nccl)=6.428e-03 speed=1.692e-04GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=172 t=7.4e-03 per=1.6e+01 cost=3.5e+05 flops=4.7e+07
 sigma[gemm] counter=172 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=1 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=3 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=4 t=7.4e-03 per=1.5e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=172 i=5 t=7.5e-03 per=1.6e+01 cost=3.2e+04 flops=4.2e+06
 sigma[gemm] counter=172 i=6 t=7.5e-03 per=1.6e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=172 i=7 t=7.5e-03 per=1.6e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=172 total t=3.0e-02 per=6.2e+01 cost=1.3e+05 flops=4.4e+06
 sigma[red] counter=172 t=1.1e-02 per=2.2e+01 cost=5.7e+04 flops=5.3e+06
----- TIMING FOR sigma_tot : t_inter=1.0e+00 t_gemm=4.2e+00 t_reduction=1.9e+00 tot=7.2e+00 -----
 sigma_tot[inter] counter=172 t=1.0e+00 per=1.5e+01 cost=6.5e+07 flops=6.3e+07
 sigma_tot[gemm] counter=172 i=0 t=2.3e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=1 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=2 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=3 t=2.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=4 t=1.1e+00 per=1.5e+01 cost=8.7e+06 flops=8.2e+06
 sigma_tot[gemm] counter=172 i=5 t=1.1e+00 per=1.5e+01 cost=8.8e+06 flops=8.1e+06
 sigma_tot[gemm] counter=172 i=6 t=1.1e+00 per=1.5e+01 cost=7.7e+06 flops=7.3e+06
 sigma_tot[gemm] counter=172 i=7 t=1.0e+00 per=1.5e+01 cost=7.8e+06 flops=7.4e+06
 sigma_tot[gemm] counter=172 total t=4.2e+00 per=5.9e+01 cost=3.3e+07 flops=7.8e+06
 sigma_tot[red] counter=172 t=1.9e+00 per=2.7e+01 cost=1.1e+07 flops=5.5e+06
T(sub)=4.9e-05 T(gemm/eig/ortho/gemm/axpy)=7.2e-06,3.6e-05,3.8e-06,1.7e-06,2.1e-07
    2   0 -    -116.325091721104 -1.350e-02  1.730e-02    2     2  1.139e-01 5.697e-02 5.688e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.089e-03,7.591e-03,2.977e-02,1.083e-02,5.728e-02
 analyze_tgpu[Hx]: ndim=73:5.439e-07GB T(cpu-gpu)=2.182e-03 speed=4.984e-04GB/S T(nccl)=6.907e-03 speed=1.575e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=173 t=7.6e-03 per=1.6e+01 cost=3.5e+05 flops=4.7e+07
 sigma[gemm] counter=173 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=4 t=7.5e-03 per=1.6e+01 cost=3.2e+04 flops=4.2e+06
 sigma[gemm] counter=173 i=5 t=7.4e-03 per=1.5e+01 cost=3.2e+04 flops=4.3e+06
 sigma[gemm] counter=173 i=6 t=7.4e-03 per=1.5e+01 cost=3.4e+04 flops=4.6e+06
 sigma[gemm] counter=173 i=7 t=7.4e-03 per=1.5e+01 cost=3.4e+04 flops=4.6e+06
 sigma[gemm] counter=173 total t=3.0e-02 per=6.2e+01 cost=1.3e+05 flops=4.4e+06
 sigma[red] counter=173 t=1.1e-02 per=2.2e+01 cost=5.7e+04 flops=5.3e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=4.3e+00 t_reduction=1.9e+00 tot=7.3e+00 -----
 sigma_tot[inter] counter=173 t=1.1e+00 per=1.5e+01 cost=6.6e+07 flops=6.2e+07
 sigma_tot[gemm] counter=173 i=0 t=2.3e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=1 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=2 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=3 t=2.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=4 t=1.1e+00 per=1.5e+01 cost=8.8e+06 flops=8.2e+06
 sigma_tot[gemm] counter=173 i=5 t=1.1e+00 per=1.5e+01 cost=8.8e+06 flops=8.1e+06
 sigma_tot[gemm] counter=173 i=6 t=1.1e+00 per=1.5e+01 cost=7.7e+06 flops=7.3e+06
 sigma_tot[gemm] counter=173 i=7 t=1.1e+00 per=1.5e+01 cost=7.8e+06 flops=7.4e+06
 sigma_tot[gemm] counter=173 total t=4.3e+00 per=5.9e+01 cost=3.3e+07 flops=7.7e+06
 sigma_tot[red] counter=173 t=1.9e+00 per=2.7e+01 cost=1.1e+07 flops=5.5e+06
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,2.2e-05,1.3e-05,1.2e-06,1.8e-07
    3   0 -    -116.325828627259 -7.369e-04  4.475e-03    3     3  1.715e-01 5.717e-02 5.708e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.409e-03,7.634e-03,3.008e-02,1.086e-02,5.699e-02
 analyze_tgpu[Hx]: ndim=73:5.439e-07GB T(cpu-gpu)=2.211e-03 speed=4.920e-04GB/S T(nccl)=6.198e-03 speed=1.755e-04GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.9e-02 -----
 sigma[inter] counter=174 t=7.6e-03 per=1.6e+01 cost=3.5e+05 flops=4.6e+07
 sigma[gemm] counter=174 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=4 t=7.5e-03 per=1.5e+01 cost=3.2e+04 flops=4.2e+06
 sigma[gemm] counter=174 i=5 t=7.6e-03 per=1.6e+01 cost=3.2e+04 flops=4.2e+06
 sigma[gemm] counter=174 i=6 t=7.5e-03 per=1.5e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=174 i=7 t=7.6e-03 per=1.6e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=174 total t=3.0e-02 per=6.2e+01 cost=1.3e+05 flops=4.4e+06
 sigma[red] counter=174 t=1.1e-02 per=2.2e+01 cost=5.7e+04 flops=5.2e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=4.3e+00 t_reduction=1.9e+00 tot=7.3e+00 -----
 sigma_tot[inter] counter=174 t=1.1e+00 per=1.5e+01 cost=6.6e+07 flops=6.2e+07
 sigma_tot[gemm] counter=174 i=0 t=2.3e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=1 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=2 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=3 t=2.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=4 t=1.1e+00 per=1.5e+01 cost=8.8e+06 flops=8.1e+06
 sigma_tot[gemm] counter=174 i=5 t=1.1e+00 per=1.5e+01 cost=8.8e+06 flops=8.1e+06
 sigma_tot[gemm] counter=174 i=6 t=1.1e+00 per=1.5e+01 cost=7.7e+06 flops=7.2e+06
 sigma_tot[gemm] counter=174 i=7 t=1.1e+00 per=1.5e+01 cost=7.9e+06 flops=7.4e+06
 sigma_tot[gemm] counter=174 total t=4.3e+00 per=5.9e+01 cost=3.3e+07 flops=7.7e+06
 sigma_tot[red] counter=174 t=1.9e+00 per=2.7e+01 cost=1.1e+07 flops=5.5e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.4e-05,3.3e-06,1.2e-06,2.1e-07
    4   0 -    -116.325888095167 -5.947e-05  1.680e-03    3     4  2.288e-01 5.719e-02 5.711e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.527e-03,7.467e-03,3.013e-02,1.088e-02,5.702e-02
 analyze_tgpu[Hx]: ndim=73:5.439e-07GB T(cpu-gpu)=2.140e-03 speed=5.084e-04GB/S T(nccl)=6.388e-03 speed=1.703e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=175 t=7.5e-03 per=1.5e+01 cost=3.5e+05 flops=4.7e+07
 sigma[gemm] counter=175 i=0 t=1.3e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=1 t=1.1e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=4 t=7.5e-03 per=1.5e+01 cost=3.2e+04 flops=4.2e+06
 sigma[gemm] counter=175 i=5 t=7.6e-03 per=1.6e+01 cost=3.2e+04 flops=4.2e+06
 sigma[gemm] counter=175 i=6 t=7.5e-03 per=1.5e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=175 i=7 t=7.7e-03 per=1.6e+01 cost=3.4e+04 flops=4.4e+06
 sigma[gemm] counter=175 total t=3.0e-02 per=6.2e+01 cost=1.3e+05 flops=4.3e+06
 sigma[red] counter=175 t=1.1e-02 per=2.2e+01 cost=5.7e+04 flops=5.2e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=4.3e+00 t_reduction=2.0e+00 tot=7.4e+00 -----
 sigma_tot[inter] counter=175 t=1.1e+00 per=1.5e+01 cost=6.6e+07 flops=6.2e+07
 sigma_tot[gemm] counter=175 i=0 t=2.4e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=1 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=2 t=2.0e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=3 t=2.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=4 t=1.1e+00 per=1.5e+01 cost=8.8e+06 flops=8.1e+06
 sigma_tot[gemm] counter=175 i=5 t=1.1e+00 per=1.5e+01 cost=8.9e+06 flops=8.1e+06
 sigma_tot[gemm] counter=175 i=6 t=1.1e+00 per=1.5e+01 cost=7.8e+06 flops=7.2e+06
 sigma_tot[gemm] counter=175 i=7 t=1.1e+00 per=1.5e+01 cost=7.9e+06 flops=7.4e+06
 sigma_tot[gemm] counter=175 total t=4.3e+00 per=5.9e+01 cost=3.3e+07 flops=7.7e+06
 sigma_tot[red] counter=175 t=2.0e+00 per=2.7e+01 cost=1.1e+07 flops=5.5e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.3e-05,3.3e-06,1.1e-06,1.9e-07
    5   0 -    -116.325897656425 -9.561e-06  7.015e-04    3     5  2.861e-01 5.722e-02 5.714e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.753e-03,7.497e-03,3.016e-02,1.074e-02,5.716e-02
 analyze_tgpu[Hx]: ndim=73:5.439e-07GB T(cpu-gpu)=2.249e-03 speed=4.837e-04GB/S T(nccl)=6.504e-03 speed=1.673e-04GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.1e-02 tot=4.8e-02 -----
 sigma[inter] counter=176 t=7.5e-03 per=1.5e+01 cost=3.5e+05 flops=4.7e+07
 sigma[gemm] counter=176 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=1 t=1.2e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=4 t=7.6e-03 per=1.6e+01 cost=3.2e+04 flops=4.2e+06
 sigma[gemm] counter=176 i=5 t=7.6e-03 per=1.6e+01 cost=3.2e+04 flops=4.1e+06
 sigma[gemm] counter=176 i=6 t=7.5e-03 per=1.5e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=176 i=7 t=7.5e-03 per=1.5e+01 cost=3.4e+04 flops=4.5e+06
 sigma[gemm] counter=176 total t=3.0e-02 per=6.2e+01 cost=1.3e+05 flops=4.3e+06
 sigma[red] counter=176 t=1.1e-02 per=2.2e+01 cost=5.7e+04 flops=5.3e+06
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=4.4e+00 t_reduction=2.0e+00 tot=7.4e+00 -----
 sigma_tot[inter] counter=176 t=1.1e+00 per=1.5e+01 cost=6.7e+07 flops=6.2e+07
 sigma_tot[gemm] counter=176 i=0 t=2.4e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=1 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=2 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=3 t=2.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=4 t=1.1e+00 per=1.5e+01 cost=8.9e+06 flops=8.1e+06
 sigma_tot[gemm] counter=176 i=5 t=1.1e+00 per=1.5e+01 cost=8.9e+06 flops=8.0e+06
 sigma_tot[gemm] counter=176 i=6 t=1.1e+00 per=1.5e+01 cost=7.8e+06 flops=7.2e+06
 sigma_tot[gemm] counter=176 i=7 t=1.1e+00 per=1.5e+01 cost=7.9e+06 flops=7.4e+06
 sigma_tot[gemm] counter=176 total t=4.4e+00 per=5.9e+01 cost=3.3e+07 flops=7.7e+06
 sigma_tot[red] counter=176 t=2.0e+00 per=2.7e+01 cost=1.1e+07 flops=5.5e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.3e-05,3.3e-06,1.1e-06,2.2e-07
    6   0 -    -116.325899124570 -1.468e-06  2.135e-04    3     6  3.435e-01 5.726e-02 5.717e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=4.203e-02,7.586e-03,7.018e-03,3.295e-03,5.994e-02
 analyze_tgpu[Hx]: ndim=73:5.439e-07GB T(cpu-gpu)=2.269e-03 speed=4.794e-04GB/S T(nccl)=3.977e-02 speed=2.735e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=7.0e-03 t_reduction=3.3e-03 tot=1.8e-02 -----
 sigma[inter] counter=177 t=7.6e-03 per=4.2e+01 cost=3.5e+05 flops=4.7e+07
 sigma[gemm] counter=177 i=0 t=1.4e-06 per=7.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=1 t=1.1e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=2 t=1.1e-06 per=6.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=3 t=1.1e-06 per=6.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=4 t=1.6e-03 per=9.1e+00 cost=3.2e+04 flops=1.9e+07
 sigma[gemm] counter=177 i=5 t=2.6e-03 per=1.4e+01 cost=3.2e+04 flops=1.2e+07
 sigma[gemm] counter=177 i=6 t=1.2e-03 per=6.5e+00 cost=3.4e+04 flops=2.9e+07
 sigma[gemm] counter=177 i=7 t=1.6e-03 per=9.2e+00 cost=3.4e+04 flops=2.1e+07
 sigma[gemm] counter=177 total t=7.0e-03 per=3.9e+01 cost=1.3e+05 flops=1.9e+07
 sigma[red] counter=177 t=3.3e-03 per=1.8e+01 cost=5.7e+04 flops=1.7e+07
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=4.4e+00 t_reduction=2.0e+00 tot=7.4e+00 -----
 sigma_tot[inter] counter=177 t=1.1e+00 per=1.5e+01 cost=6.7e+07 flops=6.2e+07
 sigma_tot[gemm] counter=177 i=0 t=2.4e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=1 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=2 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=3 t=2.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=4 t=1.1e+00 per=1.5e+01 cost=8.9e+06 flops=8.1e+06
 sigma_tot[gemm] counter=177 i=5 t=1.1e+00 per=1.5e+01 cost=8.9e+06 flops=8.0e+06
 sigma_tot[gemm] counter=177 i=6 t=1.1e+00 per=1.5e+01 cost=7.8e+06 flops=7.2e+06
 sigma_tot[gemm] counter=177 i=7 t=1.1e+00 per=1.5e+01 cost=8.0e+06 flops=7.4e+06
 sigma_tot[gemm] counter=177 total t=4.4e+00 per=5.9e+01 cost=3.4e+07 flops=7.7e+06
 sigma_tot[red] counter=177 t=2.0e+00 per=2.7e+01 cost=1.1e+07 flops=5.5e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.4e-05,3.2e-06,1.0e-06,2.3e-07
    7   0 +    -116.325899261059 -1.365e-07  6.821e-05    3     7  4.037e-01 5.767e-02 5.759e-02
TIMING FOR Davidson : 4.038e-01  T(cal/comm/rest)=4.031e-01,7.998e-06,6.417e-04
decomposed t_rest=6.417e-04
 T(sub)    =1.976e-04 per=3.079e+01
 T(precond)=5.616e-05 per=8.752e+00
 T(ortho)  =1.502e-05 per=2.341e+00
 T(xcopy)  =9.780e-07 per=1.524e-01
 T(xnrm2)  =3.162e-06 per=4.928e-01
 T(other)  =3.688e-04 per=5.747e+01
optimized energies: isweep=0 ibond=29 dots=2 e[0]=-116.325899261059 nmvp=7
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=7.927e-03 change=4.146e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=15 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond29.txt
 qbond: qsuper nsym=15 dimAll=39
 (20,2):4 (20,4):3 (19,1):1 (19,3):1 (21,1):5 (21,3):6 (21,5):3 (20,0):2 (22,2):4 (22,4):4 (23,1):1 (23,3):1 (23,5):1 (22,0):2 (22,6):1
timing for divide=1.4e-04
timing for compute=1.3e-04
timing for collect=2.0e-05
----- TMING FOR decimation_genbasis(su2): 2.8e-04 S T(divide/compute[cpu/gpu/rest]/collect)=1.4e-04,1.0e-04,0.0e+00,2.5e-05,2.0e-05 -----
decimation summary: 39->10 dwt=+1.085e-05 SvN=8.563e-01
 qbond: qkept nsym=6 dimAll=10
 (22,2):3 (21,1):2 (21,3):2 (20,2):1 (22,4):1 (22,0):1
----- TIMING for decimation_row(nkr): 7.410e-04 S T(decim/select/formRot)=3.542e-04,2.665e-04,1.203e-04 -----
----- TIMING FOR twodot_decimation: 2.251e-03 S T(wf/decim)=1.350e-03,9.018e-04 -----
ctns::oper_renorm coord=(6,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:14 S:2 P:18 Q:20 
        dim(bra,ket)=10,10 size(op)=39:2.975e-04MB size(tot)=1000:7.629e-03MB:7.451e-06GB
        per(mem): H:2 C:28 S:4 P:7 Q:59 
rank=0 CPUmem(GB): used=1.011e+00 pageheap_free=7.927e-03 change=1.387e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=53 : 1.613e-03 S -----
rank=0 GPUmem(GB): used=4.055e-05 (oper)=2.193e-05
rank=0 GPUmem(GB): used=4.088e-05 (oper,site)=2.193e-05,3.278e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=53
 no. of rintermediate operators=58
 no. of coefficients=754:5.753e-03MB:5.618e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.485e-03 S -----
rank=0 GPUmem(GB): used=4.650e-05 (oper,site,rinter)=2.193e-05,3.278e-07,5.618e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 3.213e-02 S size(rtasks)=53 size(Rlst2)=36 T(Rmu/Rlist)=4.116e-04,3.172e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.261e-02 S size(rtasks)=53 size(Rlst)=2613 -----
rank=0 GPUmem(GB): used=4.650e-05 avail=6.231e+00 total=6.231e+00 batch[need]=4.088e-04 blksize=9 blksize0=2 batchsize=2613
rank=0 GPUmem(GB): used=4.553e-04 (oper,site,rinter,batch)=2.193e-05,3.278e-07,5.618e-06,4.088e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.947e-03,2.227e-02,1.001e-02
----- TIMING FOR renorm : t_inter=5.9e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=3.8e-02 -----
 renorm[inter] counter=348 t=5.9e-03 per=1.6e+01 cost=4.1e+04 flops=6.8e+06
 renorm[gemm] counter=348 i=0 t=1.4e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=348 i=1 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=348 i=2 t=7.4e-03 per=1.9e+01 cost=4.5e+03 flops=6.1e+05
 renorm[gemm] counter=348 i=3 t=7.4e-03 per=1.9e+01 cost=1.1e+04 flops=1.5e+06
 renorm[gemm] counter=348 i=4 t=1.2e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=348 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=348 i=6 t=7.4e-03 per=1.9e+01 cost=2.5e+04 flops=3.4e+06
 renorm[gemm] counter=348 total t=2.2e-02 per=5.8e+01 cost=4.1e+04 flops=1.8e+06
 renorm[red] counter=348 t=1.0e-02 per=2.6e+01 cost=1.8e+04 flops=1.8e+06
----- TIMING FOR renorm_tot : t_inter=1.8e-01 t_gemm=6.5e-01 t_reduction=2.8e-01 tot=1.1e+00 -----
 renorm_tot[inter] counter=348 t=1.8e-01 per=1.6e+01 cost=7.2e+05 flops=4.0e+06
 renorm_tot[gemm] counter=348 i=0 t=4.0e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=348 i=1 t=3.4e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=348 i=2 t=9.6e-02 per=8.6e+00 cost=4.2e+04 flops=4.4e+05
 renorm_tot[gemm] counter=348 i=3 t=8.6e-02 per=7.7e+00 cost=1.5e+05 flops=1.8e+06
 renorm_tot[gemm] counter=348 i=4 t=1.3e-01 per=1.1e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=348 i=5 t=1.3e-01 per=1.1e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=348 i=6 t=2.1e-01 per=1.9e+01 cost=4.5e+05 flops=2.1e+06
 renorm_tot[gemm] counter=348 total t=6.5e-01 per=5.8e+01 cost=8.4e+05 flops=1.3e+06
 renorm_tot[red] counter=348 t=2.8e-01 per=2.5e+01 cost=2.6e+05 flops=9.1e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.690e-05 (optmp,oper)=1.490e-07,2.193e-05
rank=0 GPUmem(GB): used=4.723e-05 (optmp,oper,site,rinter)=1.490e-07,2.193e-05,3.278e-07,5.811e-07
rank=0 GPUmem(GB): used=5.986e-05 (optmp,oper,site,rinter,batch)=1.490e-07,2.193e-05,3.278e-07,5.811e-07,1.263e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.196e-01 S T(prep/alloc/comp/red/dealloc)=4.749e-03,6.476e-03,1.920e-01,2.099e-02,2.030e-05 -----
----- TIMING FOR oper_renorm_opS : 2.196e-01 S rank=0 -----
qops.to_cpu: size(tot)=1000:7.629e-03MB:7.451e-06GB T(to_cpu)=9.401e-05S speed=7.925e-02GB/S
check ||H-H.dagger||=7.931e-15 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.349 S rank=0 -----
rank=0 CPUmem(GB): used=1.012e+00 pageheap_free=7.523e-03 change=7.529e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=8.125e-03 change=-1.878e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.010e+00 pageheap_free=8.133e-03 change=-5.901e-06 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 1.458e+00 S #####
 T(local opt: fetch) = 1.146e-02 S  per = 0.786  per(accum) = 0.786
 T(local opt: hdiag) = 2.632e-01 S  per = 18.1  per(accum) = 18.8
 T(local opt: dvdsn) = 8.273e-01 S  per = 56.7  per(accum) = 75.6
 T(local opt: decim) = 2.406e-03 S  per = 0.165  per(accum) = 75.7
 T(local opt: guess) = 1.604e-03 S  per = 0.11  per(accum) = 75.9
 T(local opt: renrm) = 3.517e-01 S  per = 24.1  per(accum) = 100
 T(local opt: save ) = 2.965e-04 S  per = 0.0203  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.273e-01 S  T(sum) = 8.264e-01 S  per = 9.988e+01
 T(local opt: preprocess                  ) = 1.016e-02 S  per = 1.23  per(accum) = 1.23
 T(local opt: symbolic_formulae           ) = 3.476e-03 S  per = 0.421  per(accum) = 1.65
 T(local opt: hintermediate init          ) = 2.202e-04 S  per = 0.0267  per(accum) = 1.68
 T(local opt: preprocess_hformulae_Hxlist ) = 2.770e-01 S  per = 33.5  per(accum) = 35.2
 T(local opt: hmmtasks init               ) = 1.287e-01 S  per = 15.6  per(accum) = 50.8
 T(local opt: initial guess for dvdson    ) = 3.026e-03 S  per = 0.366  per(accum) = 51.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.096e-01 S  per = 37.5  per(accum) = 88.6
 T(local opt: dvdson [cpu-gpu]            ) = 1.514e-02 S  per = 1.83  per(accum) = 90.4
 T(local opt: dvdson [nccl]               ) = 7.834e-02 S  per = 9.48  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 7.998e-06 S  per = 0.000968  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 6.417e-04 S  per = 0.0777  per(accum) = 100
Detailed decomposition of T(renrm) = 3.517e-01 S  T(sum) = 3.517e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.479e-04 S  per = 0.127  per(accum) = 0.127
 T(local opt: qops init                    ) = 2.369e-03 S  per = 0.673  per(accum) = 0.801
 T(local opt: symbolic_formulae_renorm     ) = 1.624e-03 S  per = 0.462  per(accum) = 1.26
 T(local opt: allocate qops on gpu         ) = 6.894e-05 S  per = 0.0196  per(accum) = 1.28
 T(local opt: site memcpy cpu2gpu          ) = 1.177e-03 S  per = 0.335  per(accum) = 1.62
 T(local opt: rintermediate init           ) = 2.498e-03 S  per = 0.71  per(accum) = 2.33
 T(local opt: preprocess_formulae_Rlist2   ) = 3.270e-02 S  per =  9.3  per(accum) = 11.6
 T(local opt: rmmtasks init                ) = 1.534e-02 S  per = 4.36  per(accum) = 16
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 9.38e-06  per(accum) = 16
 T(local opt: preprocess_renorm_batchGPU   ) = 3.842e-02 S  per = 10.9  per(accum) = 26.9
 T(local opt: deallocate cpu and gpu memory) = 1.048e-04 S  per = 0.0298  per(accum) = 26.9
 T(local opt: construct opS [ifdists=true] ) = 2.196e-01 S  per = 62.5  per(accum) = 89.4
 T(local opt: reduction of opS & opH [nccl]) = 3.467e-02 S  per = 9.86  per(accum) = 99.3
 T(local opt: qops memcpy gpu2cpu          ) = 1.055e-04 S  per = 0.03  per(accum) = 99.3
 T(local opt: reduction of opS & opH [mpi] ) = 7.030e-05 S  per = 0.02  per(accum) = 99.3
 T(local opt: qops_pool join and erase     ) = 2.434e-03 S  per = 0.692  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.109e-05 S  per = 0.00315  per(accum) = 100
##### sweep opt: 4.354e+01 S #####
 T(sweep opt: fetch) = 3.636e-01 S  per = 0.835  per(accum) = 0.835
 T(sweep opt: hdiag) = 8.803e+00 S  per = 20.2  per(accum) = 21.1
 T(sweep opt: dvdsn) = 1.755e+01 S  per = 40.3  per(accum) = 61.4
 T(sweep opt: decim) = 4.584e-02 S  per = 0.105  per(accum) = 61.5
 T(sweep opt: guess) = 2.973e-02 S  per = 0.0683  per(accum) = 61.5
 T(sweep opt: renrm) = 1.674e+01 S  per = 38.4  per(accum) = 100
 T(sweep opt: save ) = 7.104e-03 S  per = 0.0163  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.755e+01 S  T(sum) = 1.753e+01 S  per = 9.987e+01
 T(sweep opt: preprocess                  ) = 1.606e-01 S  per = 0.916  per(accum) = 0.916
 T(sweep opt: symbolic_formulae           ) = 1.127e-01 S  per = 0.643  per(accum) = 1.56
 T(sweep opt: hintermediate init          ) = 6.076e-03 S  per = 0.0347  per(accum) = 1.59
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.450e+00 S  per = 31.1  per(accum) = 32.7
 T(sweep opt: hmmtasks init               ) = 2.441e+00 S  per = 13.9  per(accum) = 46.6
 T(sweep opt: initial guess for dvdson    ) = 4.527e-02 S  per = 0.258  per(accum) = 46.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 7.466e+00 S  per = 42.6  per(accum) = 89.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.517e-01 S  per = 2.01  per(accum) = 91.5
 T(sweep opt: dvdson [nccl]               ) = 1.430e+00 S  per = 8.16  per(accum) = 99.6
 T(sweep opt: dvdson [mpi]                ) = 1.770e-04 S  per = 0.00101  per(accum) = 99.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.522e-02 S  per = 0.372  per(accum) = 100
Detailed decomposition of T(renrm) = 1.674e+01 S  T(sum) = 1.674e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.096e-03 S  per = 0.0543  per(accum) = 0.0543
 T(sweep opt: qops init                    ) = 7.673e-02 S  per = 0.458  per(accum) = 0.513
 T(sweep opt: symbolic_formulae_renorm     ) = 3.374e-02 S  per = 0.202  per(accum) = 0.714
 T(sweep opt: allocate qops on gpu         ) = 2.114e-03 S  per = 0.0126  per(accum) = 0.727
 T(sweep opt: site memcpy cpu2gpu          ) = 3.869e-02 S  per = 0.231  per(accum) = 0.958
 T(sweep opt: rintermediate init           ) = 6.772e-02 S  per = 0.405  per(accum) = 1.36
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.215e-01 S  per = 3.12  per(accum) = 4.48
 T(sweep opt: rmmtasks init                ) = 2.522e-01 S  per = 1.51  per(accum) = 5.99
 T(sweep opt: qops memset on cpu           ) = 1.045e-06 S  per = 6.24e-06  per(accum) = 5.99
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.123e+00 S  per = 6.71  per(accum) = 12.7
 T(sweep opt: deallocate cpu and gpu memory) = 2.182e-03 S  per = 0.013  per(accum) = 12.7
 T(sweep opt: construct opS [ifdists=true] ) = 1.422e+01 S  per =   85  per(accum) = 97.7
 T(sweep opt: reduction of opS & opH [nccl]) = 1.192e-01 S  per = 0.712  per(accum) = 98.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.920e-03 S  per = 0.0174  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.937e-03 S  per = 0.0116  per(accum) = 98.4
 T(sweep opt: qops_pool join and erase     ) = 6.475e-02 S  per = 0.387  per(accum) = 98.8
 T(sweep opt: conversion from opAB to opPQ ) = 1.990e-01 S  per = 1.19  per(accum) = 100
##### global opt: 4.354e+01 S #####
 T(global opt: fetch) = 3.636e-01 S  per = 0.835  per(accum) = 0.835
 T(global opt: hdiag) = 8.803e+00 S  per = 20.2  per(accum) = 21.1
 T(global opt: dvdsn) = 1.755e+01 S  per = 40.3  per(accum) = 61.4
 T(global opt: decim) = 4.584e-02 S  per = 0.105  per(accum) = 61.5
 T(global opt: guess) = 2.973e-02 S  per = 0.0683  per(accum) = 61.5
 T(global opt: renrm) = 1.674e+01 S  per = 38.4  per(accum) = 100
 T(global opt: save ) = 7.104e-03 S  per = 0.0163  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.755e+01 S  T(sum) = 1.753e+01 S  per = 9.987e+01
 T(global opt: preprocess                  ) = 1.606e-01 S  per = 0.916  per(accum) = 0.916
 T(global opt: symbolic_formulae           ) = 1.127e-01 S  per = 0.643  per(accum) = 1.56
 T(global opt: hintermediate init          ) = 6.076e-03 S  per = 0.0347  per(accum) = 1.59
 T(global opt: preprocess_hformulae_Hxlist ) = 5.450e+00 S  per = 31.1  per(accum) = 32.7
 T(global opt: hmmtasks init               ) = 2.441e+00 S  per = 13.9  per(accum) = 46.6
 T(global opt: initial guess for dvdson    ) = 4.527e-02 S  per = 0.258  per(accum) = 46.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 7.466e+00 S  per = 42.6  per(accum) = 89.5
 T(global opt: dvdson [cpu-gpu]            ) = 3.517e-01 S  per = 2.01  per(accum) = 91.5
 T(global opt: dvdson [nccl]               ) = 1.430e+00 S  per = 8.16  per(accum) = 99.6
 T(global opt: dvdson [mpi]                ) = 1.770e-04 S  per = 0.00101  per(accum) = 99.6
 T(global opt: dvdson [rest part(linalg)]  ) = 6.522e-02 S  per = 0.372  per(accum) = 100
Detailed decomposition of T(renrm) = 1.674e+01 S  T(sum) = 1.674e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.096e-03 S  per = 0.0543  per(accum) = 0.0543
 T(global opt: qops init                    ) = 7.673e-02 S  per = 0.458  per(accum) = 0.513
 T(global opt: symbolic_formulae_renorm     ) = 3.374e-02 S  per = 0.202  per(accum) = 0.714
 T(global opt: allocate qops on gpu         ) = 2.114e-03 S  per = 0.0126  per(accum) = 0.727
 T(global opt: site memcpy cpu2gpu          ) = 3.869e-02 S  per = 0.231  per(accum) = 0.958
 T(global opt: rintermediate init           ) = 6.772e-02 S  per = 0.405  per(accum) = 1.36
 T(global opt: preprocess_formulae_Rlist2   ) = 5.215e-01 S  per = 3.12  per(accum) = 4.48
 T(global opt: rmmtasks init                ) = 2.522e-01 S  per = 1.51  per(accum) = 5.99
 T(global opt: qops memset on cpu           ) = 1.045e-06 S  per = 6.24e-06  per(accum) = 5.99
 T(global opt: preprocess_renorm_batchGPU   ) = 1.123e+00 S  per = 6.71  per(accum) = 12.7
 T(global opt: deallocate cpu and gpu memory) = 2.182e-03 S  per = 0.013  per(accum) = 12.7
 T(global opt: construct opS [ifdists=true] ) = 1.422e+01 S  per =   85  per(accum) = 97.7
 T(global opt: reduction of opS & opH [nccl]) = 1.192e-01 S  per = 0.712  per(accum) = 98.4
 T(global opt: qops memcpy gpu2cpu          ) = 2.920e-03 S  per = 0.0174  per(accum) = 98.4
 T(global opt: reduction of opS & opH [mpi] ) = 1.937e-03 S  per = 0.0116  per(accum) = 98.4
 T(global opt: qops_pool join and erase     ) = 6.475e-02 S  per = 0.387  per(accum) = 98.8
 T(global opt: conversion from opAB to opPQ ) = 1.990e-01 S  per = 1.19  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-4.117e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=30/seqsize=34 dots=2 dbond=(4,0)-(5,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=623:4.753e-03MB:4.642e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=30:2.289e-04MB:2.235e-07GB
total mem of comb=654:4.990e-03MB:4.873e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=4,14,1,1
 suppl= 0 1 2 3
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 4
 suppc2= 16
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(4,0)
 fqop[3]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:4 S:8 A:8 B:10 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=34:2.594e-04MB:2.533e-07GB
        per(mem): H:5.88 C:11.8 S:23.5 A:0 B:58.8 
 rqops: oplist=HCSPQ nops=H:1 C:14 S:2 P:18 Q:20 
        dim(bra,ket)=10,10 size(op)=39:0.000298MB size(tot)=1000:0.00763MB:7.45e-06GB
        per(mem): H:2 C:28 S:4 P:7 Q:59 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3030:0.0231MB:2.26e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=8.189e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(5,0) fdel=./scratch/sweep/lop(4,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=1.490e-07 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(2,10,3,3) nnz=33:2.518e-04MB
qtensor4: wf4 own=1 _data=0x3aefc5a0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=2 dimAll=2
 (6,2):1 (5,3):1
 qbond: qcol nsym=6 dimAll=10
 (22,2):3 (21,1):2 (21,3):2 (20,2):1 (22,4):1 (22,0):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=16 nblocks=184 size=33:2.518e-04MB
### DIAG TIMING: total=1.845e-01 t1=3.134e-05, t2=1.535e-03, t3=2.519e-03, t4=1.779e-01, t5=5.115e-06, t6=2.470e-03, t7=5.243e-06
duration_diagGPU:1.845e-01
duration_diagreduce:5.200e-08
duration_diagtransform:3.580e-07
----- TIMING FOR symbolic_formulae_twodot with size=191 : 2.675e-03 S -----
rank=0 GPUmem(GB): used=2.258e-05 (oper)=2.258e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=191
 no. of hintermediate operators=91
 no. of coefficients=1173:8.949e-03MB:8.740e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.211e-04 S -----
rank=0 GPUmem(GB): used=3.131e-05 (oper,hinter)=2.258e-05,8.740e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.941e-02 S size(H_formulae)=191 size(Hxlst2)=16 T(Hmu/Hxlist)=4.972e-04,4.891e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.997e-02 S size(H_formulae)=191 size(Hxlst)=2894 -----
rank=0 GPUmem(GB): used=3.131e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=4.917e-07 batch[need]=2.803e-04 blksize=3 blksize0=6 batchsize=2894
rank=0 GPUmem(GB): used=3.121e-04 (oper,hinter,dvdson,batch)=2.258e-05,8.740e-06,4.917e-07,2.803e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=33 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.013e-02,7.553e-03,2.963e-02,1.277e-02,6.010e-02
 analyze_tgpu[Hx]: ndim=33:2.459e-07GB T(cpu-gpu)=5.929e-04 speed=8.293e-04GB/S T(nccl)=9.537e-03 speed=5.156e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=178 t=7.6e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=178 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=4 t=7.5e-03 per=1.5e+01 cost=1.0e+04 flops=1.3e+06
 sigma[gemm] counter=178 i=5 t=7.4e-03 per=1.5e+01 cost=1.0e+04 flops=1.4e+06
 sigma[gemm] counter=178 i=6 t=7.4e-03 per=1.5e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=178 i=7 t=7.4e-03 per=1.5e+01 cost=4.7e+03 flops=6.4e+05
 sigma[gemm] counter=178 total t=3.0e-02 per=5.9e+01 cost=2.9e+04 flops=9.9e+05
 sigma[red] counter=178 t=1.3e-02 per=2.6e+01 cost=1.2e+04 flops=9.5e+05
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=4.4e+00 t_reduction=2.0e+00 tot=7.5e+00 -----
 sigma_tot[inter] counter=178 t=1.1e+00 per=1.5e+01 cost=6.7e+07 flops=6.2e+07
 sigma_tot[gemm] counter=178 i=0 t=2.4e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=1 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=2 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=3 t=2.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=4 t=1.1e+00 per=1.5e+01 cost=8.9e+06 flops=8.0e+06
 sigma_tot[gemm] counter=178 i=5 t=1.1e+00 per=1.5e+01 cost=8.9e+06 flops=8.0e+06
 sigma_tot[gemm] counter=178 i=6 t=1.1e+00 per=1.5e+01 cost=7.8e+06 flops=7.2e+06
 sigma_tot[gemm] counter=178 i=7 t=1.1e+00 per=1.5e+01 cost=8.0e+06 flops=7.3e+06
 sigma_tot[gemm] counter=178 total t=4.4e+00 per=5.9e+01 cost=3.4e+07 flops=7.6e+06
 sigma_tot[red] counter=178 t=2.0e+00 per=2.7e+01 cost=1.1e+07 flops=5.5e+06
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,5.8e-06,2.0e-06,8.3e-07,3.2e-07
settings: ndim=33 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.325894472811 -1.116e+03  3.494e-03    1     1  6.033e-02 6.033e-02 6.029e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.409e-03,7.407e-03,3.012e-02,1.261e-02,5.855e-02
 analyze_tgpu[Hx]: ndim=33:2.459e-07GB T(cpu-gpu)=2.239e-03 speed=2.196e-04GB/S T(nccl)=6.170e-03 speed=7.970e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=179 t=7.4e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=179 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=4 t=7.5e-03 per=1.5e+01 cost=1.0e+04 flops=1.3e+06
 sigma[gemm] counter=179 i=5 t=7.5e-03 per=1.5e+01 cost=1.0e+04 flops=1.3e+06
 sigma[gemm] counter=179 i=6 t=7.5e-03 per=1.5e+01 cost=4.7e+03 flops=6.2e+05
 sigma[gemm] counter=179 i=7 t=7.5e-03 per=1.5e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=179 total t=3.0e-02 per=6.0e+01 cost=2.9e+04 flops=9.8e+05
 sigma[red] counter=179 t=1.3e-02 per=2.5e+01 cost=1.2e+04 flops=9.6e+05
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=4.4e+00 t_reduction=2.0e+00 tot=7.5e+00 -----
 sigma_tot[inter] counter=179 t=1.1e+00 per=1.5e+01 cost=6.7e+07 flops=6.1e+07
 sigma_tot[gemm] counter=179 i=0 t=2.4e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=1 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=2 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=3 t=2.0e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=4 t=1.1e+00 per=1.5e+01 cost=8.9e+06 flops=8.0e+06
 sigma_tot[gemm] counter=179 i=5 t=1.1e+00 per=1.5e+01 cost=9.0e+06 flops=8.0e+06
 sigma_tot[gemm] counter=179 i=6 t=1.1e+00 per=1.5e+01 cost=7.9e+06 flops=7.1e+06
 sigma_tot[gemm] counter=179 i=7 t=1.1e+00 per=1.5e+01 cost=8.0e+06 flops=7.3e+06
 sigma_tot[gemm] counter=179 total t=4.4e+00 per=5.9e+01 cost=3.4e+07 flops=7.6e+06
 sigma_tot[red] counter=179 t=2.0e+00 per=2.7e+01 cost=1.1e+07 flops=5.5e+06
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.7e-05,3.6e-06,1.0e-06,2.1e-07
    2   0 -    -116.325910208406 -1.574e-05  4.809e-04    2     2  1.192e-01 5.960e-02 5.953e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.174e-02,7.393e-03,2.969e-02,1.276e-02,6.159e-02
 analyze_tgpu[Hx]: ndim=33:2.459e-07GB T(cpu-gpu)=2.153e-03 speed=2.284e-04GB/S T(nccl)=9.590e-03 speed=5.128e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=180 t=7.4e-03 per=1.5e+01 cost=1.3e+05 flops=1.7e+07
 sigma[gemm] counter=180 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=4 t=7.4e-03 per=1.5e+01 cost=1.0e+04 flops=1.4e+06
 sigma[gemm] counter=180 i=5 t=7.4e-03 per=1.5e+01 cost=1.0e+04 flops=1.3e+06
 sigma[gemm] counter=180 i=6 t=7.4e-03 per=1.5e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=180 i=7 t=7.4e-03 per=1.5e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=180 total t=3.0e-02 per=6.0e+01 cost=2.9e+04 flops=9.9e+05
 sigma[red] counter=180 t=1.3e-02 per=2.6e+01 cost=1.2e+04 flops=9.5e+05
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=4.5e+00 t_reduction=2.0e+00 tot=7.6e+00 -----
 sigma_tot[inter] counter=180 t=1.1e+00 per=1.5e+01 cost=6.8e+07 flops=6.1e+07
 sigma_tot[gemm] counter=180 i=0 t=2.4e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=1 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=2 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=3 t=2.1e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=4 t=1.1e+00 per=1.5e+01 cost=8.9e+06 flops=8.0e+06
 sigma_tot[gemm] counter=180 i=5 t=1.1e+00 per=1.5e+01 cost=9.0e+06 flops=7.9e+06
 sigma_tot[gemm] counter=180 i=6 t=1.1e+00 per=1.5e+01 cost=7.9e+06 flops=7.1e+06
 sigma_tot[gemm] counter=180 i=7 t=1.1e+00 per=1.5e+01 cost=8.0e+06 flops=7.2e+06
 sigma_tot[gemm] counter=180 total t=4.5e+00 per=5.9e+01 cost=3.4e+07 flops=7.6e+06
 sigma_tot[red] counter=180 t=2.0e+00 per=2.6e+01 cost=1.1e+07 flops=5.4e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.6e-05,3.3e-06,9.7e-07,2.3e-07
    3   0 +    -116.325910527615 -3.192e-07  4.538e-05    3     3  1.810e-01 6.034e-02 6.027e-02
TIMING FOR Davidson : 1.810e-01  T(cal/comm/rest)=1.808e-01,5.830e-06,2.205e-04
decomposed t_rest=2.205e-04
 T(sub)    =6.441e-05 per=2.921e+01
 T(precond)=2.490e-05 per=1.129e+01
 T(ortho)  =4.991e-06 per=2.263e+00
 T(xcopy)  =5.030e-07 per=2.281e-01
 T(xnrm2)  =1.356e-06 per=6.149e-01
 T(other)  =1.244e-04 per=5.640e+01
optimized energies: isweep=0 ibond=30 dots=2 e[0]=-116.325910527615 nmvp=3
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=9.116e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=12 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond30.txt
 qbond: qsuper nsym=12 dimAll=39
 (22,2):8 (21,1):3 (21,3):3 (20,2):1 (22,4):3 (22,0):3 (24,2):3 (23,1):6 (23,3):6 (24,4):1 (24,0):1 (23,5):1
timing for divide=6.1e-05
timing for compute=9.0e-05
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(su2): 1.7e-04 S T(divide/compute[cpu/gpu/rest]/collect)=6.1e-05,8.2e-05,0.0e+00,8.1e-06,1.6e-05 -----
decimation summary: 39->7 dwt=+0.000e+00 SvN=3.383e-01
 qbond: qkept nsym=5 dimAll=7
 (24,2):2 (23,3):2 (22,2):1 (23,1):1 (24,4):1
----- TIMING for decimation_row(nkr): 5.143e-04 S T(decim/select/formRot)=2.346e-04,1.939e-04,8.577e-05 -----
----- TIMING FOR twodot_decimation: 1.155e-03 S T(wf/decim)=5.456e-04,6.091e-04 -----
ctns::oper_renorm coord=(5,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:15 S:2 P:12 Q:16 
        dim(bra,ket)=7,7 size(op)=19:1.450e-04MB size(tot)=467:3.563e-03MB:3.479e-06GB
        per(mem): H:2.36 C:35.3 S:4.71 P:6.21 Q:51.4 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=8.896e-05 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=44 : 1.474e-03 S -----
rank=0 GPUmem(GB): used=3.454e-05 (oper)=1.837e-05
rank=0 GPUmem(GB): used=3.479e-05 (oper,site)=1.837e-05,2.459e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=44
 no. of rintermediate operators=44
 no. of coefficients=616:4.700e-03MB:4.590e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.518e-03 S -----
rank=0 GPUmem(GB): used=3.938e-05 (oper,site,rinter)=1.837e-05,2.459e-07,4.590e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.313e-02 S size(rtasks)=44 size(Rlst2)=25 T(Rmu/Rlist)=3.083e-04,1.282e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.336e-02 S size(rtasks)=44 size(Rlst)=1162 -----
rank=0 GPUmem(GB): used=3.938e-05 avail=6.231e+00 total=6.231e+00 batch[need]=1.645e-04 blksize=6 blksize0=6 batchsize=1162
rank=0 GPUmem(GB): used=2.039e-04 (oper,site,rinter,batch)=1.837e-05,2.459e-07,4.590e-06,1.645e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.987e-03,2.243e-02,1.014e-02
----- TIMING FOR renorm : t_inter=7.0e-03 t_gemm=2.2e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=355 t=7.0e-03 per=1.8e+01 cost=3.8e+04 flops=5.5e+06
 renorm[gemm] counter=355 i=0 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=355 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=355 i=2 t=7.4e-03 per=1.9e+01 cost=3.1e+03 flops=4.2e+05
 renorm[gemm] counter=355 i=3 t=7.5e-03 per=1.9e+01 cost=8.1e+03 flops=1.1e+06
 renorm[gemm] counter=355 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=355 i=5 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=355 i=6 t=7.5e-03 per=1.9e+01 cost=9.4e+03 flops=1.3e+06
 renorm[gemm] counter=355 total t=2.2e-02 per=5.7e+01 cost=2.1e+04 flops=9.2e+05
 renorm[red] counter=355 t=1.0e-02 per=2.6e+01 cost=4.4e+03 flops=4.4e+05
----- TIMING FOR renorm_tot : t_inter=1.9e-01 t_gemm=6.7e-01 t_reduction=2.9e-01 tot=1.2e+00 -----
 renorm_tot[inter] counter=355 t=1.9e-01 per=1.6e+01 cost=7.6e+05 flops=4.0e+06
 renorm_tot[gemm] counter=355 i=0 t=4.2e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=355 i=1 t=3.6e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=355 i=2 t=1.0e-01 per=9.0e+00 cost=4.5e+04 flops=4.4e+05
 renorm_tot[gemm] counter=355 i=3 t=9.3e-02 per=8.1e+00 cost=1.6e+05 flops=1.7e+06
 renorm_tot[gemm] counter=355 i=4 t=1.3e-01 per=1.1e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=355 i=5 t=1.3e-01 per=1.1e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=355 i=6 t=2.2e-01 per=1.9e+01 cost=4.6e+05 flops=2.1e+06
 renorm_tot[gemm] counter=355 total t=6.7e-01 per=5.8e+01 cost=8.6e+05 flops=1.3e+06
 renorm_tot[red] counter=355 t=2.9e-01 per=2.5e+01 cost=2.6e+05 flops=9.0e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.984e-05 (optmp,oper)=8.196e-08,1.837e-05
rank=0 GPUmem(GB): used=4.008e-05 (optmp,oper,site,rinter)=8.196e-08,1.837e-05,2.459e-07,6.258e-07
rank=0 GPUmem(GB): used=4.829e-05 (optmp,oper,site,rinter,batch)=8.196e-08,1.837e-05,2.459e-07,6.258e-07,8.211e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.849e-01 S T(prep/alloc/comp/red/dealloc)=2.915e-03,5.440e-03,1.669e-01,1.254e-02,2.187e-05 -----
----- TIMING FOR oper_renorm_opS : 1.849e-01 S rank=0 -----
qops.to_cpu: size(tot)=467:3.563e-03MB:3.479e-06GB T(to_cpu)=7.071e-05S speed=4.921e-02GB/S
check ||H-H.dagger||=9.472e-16 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.272 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=3.587e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=2.899e-04 change=-1.309e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=2.899e-04 change=-4.053e-06 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 7.265e-01 S #####
 T(local opt: fetch) = 9.533e-03 S  per = 1.31  per(accum) = 1.31
 T(local opt: hdiag) = 1.849e-01 S  per = 25.5  per(accum) = 26.8
 T(local opt: dvdsn) = 2.556e-01 S  per = 35.2  per(accum) = 61.9
 T(local opt: decim) = 1.287e-03 S  per = 0.177  per(accum) = 62.1
 T(local opt: guess) = 6.670e-04 S  per = 0.0918  per(accum) = 62.2
 T(local opt: renrm) = 2.743e-01 S  per = 37.8  per(accum) = 100
 T(local opt: save ) = 2.365e-04 S  per = 0.0326  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.556e-01 S  T(sum) = 2.552e-01 S  per = 9.988e+01
 T(local opt: preprocess                  ) = 2.833e-03 S  per = 1.11  per(accum) = 1.11
 T(local opt: symbolic_formulae           ) = 2.690e-03 S  per = 1.05  per(accum) = 2.16
 T(local opt: hintermediate init          ) = 1.872e-04 S  per = 0.0733  per(accum) = 2.24
 T(local opt: preprocess_hformulae_Hxlist ) = 5.007e-02 S  per = 19.6  per(accum) = 21.9
 T(local opt: hmmtasks init               ) = 1.735e-02 S  per =  6.8  per(accum) = 28.6
 T(local opt: initial guess for dvdson    ) = 1.094e-03 S  per = 0.428  per(accum) = 29.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.505e-01 S  per =   59  per(accum) = 88
 T(local opt: dvdson [cpu-gpu]            ) = 4.985e-03 S  per = 1.95  per(accum) = 90
 T(local opt: dvdson [nccl]               ) = 2.530e-02 S  per = 9.91  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 5.830e-06 S  per = 0.00228  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 2.205e-04 S  per = 0.0864  per(accum) = 100
Detailed decomposition of T(renrm) = 2.743e-01 S  T(sum) = 2.743e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.872e-04 S  per = 0.105  per(accum) = 0.105
 T(local opt: qops init                    ) = 1.427e-03 S  per = 0.52  per(accum) = 0.625
 T(local opt: symbolic_formulae_renorm     ) = 1.486e-03 S  per = 0.542  per(accum) = 1.17
 T(local opt: allocate qops on gpu         ) = 6.966e-05 S  per = 0.0254  per(accum) = 1.19
 T(local opt: site memcpy cpu2gpu          ) = 1.002e-03 S  per = 0.365  per(accum) = 1.56
 T(local opt: rintermediate init           ) = 2.531e-03 S  per = 0.923  per(accum) = 2.48
 T(local opt: preprocess_formulae_Rlist2   ) = 1.340e-02 S  per = 4.88  per(accum) = 7.36
 T(local opt: rmmtasks init                ) = 6.288e-03 S  per = 2.29  per(accum) = 9.66
 T(local opt: qops memset on cpu           ) = 3.000e-08 S  per = 1.09e-05  per(accum) = 9.66
 T(local opt: preprocess_renorm_batchGPU   ) = 3.974e-02 S  per = 14.5  per(accum) = 24.1
 T(local opt: deallocate cpu and gpu memory) = 5.620e-05 S  per = 0.0205  per(accum) = 24.2
 T(local opt: construct opS [ifdists=true] ) = 1.850e-01 S  per = 67.4  per(accum) = 91.6
 T(local opt: reduction of opS & opH [nccl]) = 2.099e-02 S  per = 7.65  per(accum) = 99.3
 T(local opt: qops memcpy gpu2cpu          ) = 8.134e-05 S  per = 0.0297  per(accum) = 99.3
 T(local opt: reduction of opS & opH [mpi] ) = 5.172e-05 S  per = 0.0189  per(accum) = 99.3
 T(local opt: qops_pool join and erase     ) = 1.898e-03 S  per = 0.692  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.867e-06 S  per = 0.00287  per(accum) = 100
##### sweep opt: 4.427e+01 S #####
 T(sweep opt: fetch) = 3.731e-01 S  per = 0.843  per(accum) = 0.843
 T(sweep opt: hdiag) = 8.988e+00 S  per = 20.3  per(accum) = 21.1
 T(sweep opt: dvdsn) = 1.781e+01 S  per = 40.2  per(accum) = 61.4
 T(sweep opt: decim) = 4.713e-02 S  per = 0.106  per(accum) = 61.5
 T(sweep opt: guess) = 3.040e-02 S  per = 0.0687  per(accum) = 61.6
 T(sweep opt: renrm) = 1.701e+01 S  per = 38.4  per(accum) = 100
 T(sweep opt: save ) = 7.340e-03 S  per = 0.0166  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.781e+01 S  T(sum) = 1.779e+01 S  per = 9.987e+01
 T(sweep opt: preprocess                  ) = 1.634e-01 S  per = 0.919  per(accum) = 0.919
 T(sweep opt: symbolic_formulae           ) = 1.154e-01 S  per = 0.649  per(accum) = 1.57
 T(sweep opt: hintermediate init          ) = 6.264e-03 S  per = 0.0352  per(accum) = 1.6
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.501e+00 S  per = 30.9  per(accum) = 32.5
 T(sweep opt: hmmtasks init               ) = 2.458e+00 S  per = 13.8  per(accum) = 46.4
 T(sweep opt: initial guess for dvdson    ) = 4.636e-02 S  per = 0.261  per(accum) = 46.6
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 7.617e+00 S  per = 42.8  per(accum) = 89.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.567e-01 S  per = 2.01  per(accum) = 91.4
 T(sweep opt: dvdson [nccl]               ) = 1.456e+00 S  per = 8.18  per(accum) = 99.6
 T(sweep opt: dvdson [mpi]                ) = 1.829e-04 S  per = 0.00103  per(accum) = 99.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.544e-02 S  per = 0.368  per(accum) = 100
Detailed decomposition of T(renrm) = 1.701e+01 S  T(sum) = 1.701e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.383e-03 S  per = 0.0552  per(accum) = 0.0552
 T(sweep opt: qops init                    ) = 7.816e-02 S  per = 0.459  per(accum) = 0.515
 T(sweep opt: symbolic_formulae_renorm     ) = 3.523e-02 S  per = 0.207  per(accum) = 0.722
 T(sweep opt: allocate qops on gpu         ) = 2.183e-03 S  per = 0.0128  per(accum) = 0.735
 T(sweep opt: site memcpy cpu2gpu          ) = 3.969e-02 S  per = 0.233  per(accum) = 0.968
 T(sweep opt: rintermediate init           ) = 7.025e-02 S  per = 0.413  per(accum) = 1.38
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.349e-01 S  per = 3.14  per(accum) = 4.53
 T(sweep opt: rmmtasks init                ) = 2.585e-01 S  per = 1.52  per(accum) = 6.04
 T(sweep opt: qops memset on cpu           ) = 1.075e-06 S  per = 6.32e-06  per(accum) = 6.04
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.162e+00 S  per = 6.83  per(accum) = 12.9
 T(sweep opt: deallocate cpu and gpu memory) = 2.238e-03 S  per = 0.0132  per(accum) = 12.9
 T(sweep opt: construct opS [ifdists=true] ) = 1.441e+01 S  per = 84.7  per(accum) = 97.6
 T(sweep opt: reduction of opS & opH [nccl]) = 1.402e-01 S  per = 0.824  per(accum) = 98.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.002e-03 S  per = 0.0176  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.989e-03 S  per = 0.0117  per(accum) = 98.4
 T(sweep opt: qops_pool join and erase     ) = 6.665e-02 S  per = 0.392  per(accum) = 98.8
 T(sweep opt: conversion from opAB to opPQ ) = 1.990e-01 S  per = 1.17  per(accum) = 100
##### global opt: 4.427e+01 S #####
 T(global opt: fetch) = 3.731e-01 S  per = 0.843  per(accum) = 0.843
 T(global opt: hdiag) = 8.988e+00 S  per = 20.3  per(accum) = 21.1
 T(global opt: dvdsn) = 1.781e+01 S  per = 40.2  per(accum) = 61.4
 T(global opt: decim) = 4.713e-02 S  per = 0.106  per(accum) = 61.5
 T(global opt: guess) = 3.040e-02 S  per = 0.0687  per(accum) = 61.6
 T(global opt: renrm) = 1.701e+01 S  per = 38.4  per(accum) = 100
 T(global opt: save ) = 7.340e-03 S  per = 0.0166  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.781e+01 S  T(sum) = 1.779e+01 S  per = 9.987e+01
 T(global opt: preprocess                  ) = 1.634e-01 S  per = 0.919  per(accum) = 0.919
 T(global opt: symbolic_formulae           ) = 1.154e-01 S  per = 0.649  per(accum) = 1.57
 T(global opt: hintermediate init          ) = 6.264e-03 S  per = 0.0352  per(accum) = 1.6
 T(global opt: preprocess_hformulae_Hxlist ) = 5.501e+00 S  per = 30.9  per(accum) = 32.5
 T(global opt: hmmtasks init               ) = 2.458e+00 S  per = 13.8  per(accum) = 46.4
 T(global opt: initial guess for dvdson    ) = 4.636e-02 S  per = 0.261  per(accum) = 46.6
 T(global opt: dvdson [Hx_batchGPU]        ) = 7.617e+00 S  per = 42.8  per(accum) = 89.4
 T(global opt: dvdson [cpu-gpu]            ) = 3.567e-01 S  per = 2.01  per(accum) = 91.4
 T(global opt: dvdson [nccl]               ) = 1.456e+00 S  per = 8.18  per(accum) = 99.6
 T(global opt: dvdson [mpi]                ) = 1.829e-04 S  per = 0.00103  per(accum) = 99.6
 T(global opt: dvdson [rest part(linalg)]  ) = 6.544e-02 S  per = 0.368  per(accum) = 100
Detailed decomposition of T(renrm) = 1.701e+01 S  T(sum) = 1.701e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.383e-03 S  per = 0.0552  per(accum) = 0.0552
 T(global opt: qops init                    ) = 7.816e-02 S  per = 0.459  per(accum) = 0.515
 T(global opt: symbolic_formulae_renorm     ) = 3.523e-02 S  per = 0.207  per(accum) = 0.722
 T(global opt: allocate qops on gpu         ) = 2.183e-03 S  per = 0.0128  per(accum) = 0.735
 T(global opt: site memcpy cpu2gpu          ) = 3.969e-02 S  per = 0.233  per(accum) = 0.968
 T(global opt: rintermediate init           ) = 7.025e-02 S  per = 0.413  per(accum) = 1.38
 T(global opt: preprocess_formulae_Rlist2   ) = 5.349e-01 S  per = 3.14  per(accum) = 4.53
 T(global opt: rmmtasks init                ) = 2.585e-01 S  per = 1.52  per(accum) = 6.04
 T(global opt: qops memset on cpu           ) = 1.075e-06 S  per = 6.32e-06  per(accum) = 6.04
 T(global opt: preprocess_renorm_batchGPU   ) = 1.162e+00 S  per = 6.83  per(accum) = 12.9
 T(global opt: deallocate cpu and gpu memory) = 2.238e-03 S  per = 0.0132  per(accum) = 12.9
 T(global opt: construct opS [ifdists=true] ) = 1.441e+01 S  per = 84.7  per(accum) = 97.6
 T(global opt: reduction of opS & opH [nccl]) = 1.402e-01 S  per = 0.824  per(accum) = 98.4
 T(global opt: qops memcpy gpu2cpu          ) = 3.002e-03 S  per = 0.0176  per(accum) = 98.4
 T(global opt: reduction of opS & opH [mpi] ) = 1.989e-03 S  per = 0.0117  per(accum) = 98.4
 T(global opt: qops_pool join and erase     ) = 6.665e-02 S  per = 0.392  per(accum) = 98.8
 T(global opt: conversion from opAB to opPQ ) = 1.990e-01 S  per = 1.17  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-8.983e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=31/seqsize=34 dots=2 dbond=(3,0)-(4,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=627:4.784e-03MB:4.672e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=11:8.392e-05MB:8.196e-08GB
total mem of comb=639:4.875e-03MB:4.761e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=3,15,1,1
 suppl= 0 1 2
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 3
 suppc2= 4
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:3 S:9 A:4 B:7 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=28:2.136e-04MB:2.086e-07GB
        per(mem): H:7.14 C:10.7 S:32.1 A:0 B:50 
 rqops: oplist=HCSPQ nops=H:1 C:15 S:2 P:12 Q:16 
        dim(bra,ket)=7,7 size(op)=19:0.000145MB size(tot)=467:0.00356MB:3.48e-06GB
        per(mem): H:2.36 C:35.3 S:4.71 P:6.21 Q:51.4 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2491:0.019MB:1.86e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=8.143e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(4,0) fdel=./scratch/sweep/lop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=2.086e-07 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(2,7,3,3) nnz=28:2.136e-04MB
qtensor4: wf4 own=1 _data=0x3b9fb260
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=2 dimAll=2
 (5,1):1 (4,2):1
 qbond: qcol nsym=5 dimAll=7
 (24,2):2 (23,3):2 (22,2):1 (23,1):1 (24,4):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=19 nblocks=160 size=28:2.136e-04MB
### DIAG TIMING: total=9.010e-02 t1=2.790e-05, t2=1.594e-03, t3=2.469e-03, t4=8.358e-02, t5=3.409e-06, t6=2.419e-03, t7=5.901e-06
duration_diagGPU:9.011e-02
duration_diagreduce:4.800e-08
duration_diagtransform:4.360e-07
----- TIMING FOR symbolic_formulae_twodot with size=143 : 1.952e-03 S -----
rank=0 GPUmem(GB): used=1.856e-05 (oper)=1.856e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=143
 no. of hintermediate operators=62
 no. of coefficients=814:6.210e-03MB:6.065e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.682e-04 S -----
rank=0 GPUmem(GB): used=2.462e-05 (oper,hinter)=1.856e-05,6.065e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.178e-02 S size(H_formulae)=143 size(Hxlst2)=19 T(Hmu/Hxlist)=3.677e-04,5.141e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.226e-02 S size(H_formulae)=143 size(Hxlst)=3098 -----
rank=0 GPUmem(GB): used=2.462e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=4.172e-07 batch[need]=2.077e-04 blksize=2 blksize0=4 batchsize=3098
rank=0 GPUmem(GB): used=2.328e-04 (oper,hinter,dvdson,batch)=1.856e-05,6.065e-06,4.172e-07,2.077e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=28 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.833e-03,7.479e-03,3.024e-02,1.267e-02,5.823e-02
 analyze_tgpu[Hx]: ndim=28:2.086e-07GB T(cpu-gpu)=2.183e-03 speed=1.911e-04GB/S T(nccl)=5.650e-03 speed=7.385e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=181 t=7.5e-03 per=1.5e+01 cost=7.4e+04 flops=9.8e+06
 sigma[gemm] counter=181 i=0 t=1.4e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=4 t=7.5e-03 per=1.5e+01 cost=5.6e+03 flops=7.4e+05
 sigma[gemm] counter=181 i=5 t=7.6e-03 per=1.5e+01 cost=5.6e+03 flops=7.4e+05
 sigma[gemm] counter=181 i=6 t=7.6e-03 per=1.5e+01 cost=3.3e+03 flops=4.3e+05
 sigma[gemm] counter=181 i=7 t=7.6e-03 per=1.5e+01 cost=3.3e+03 flops=4.4e+05
 sigma[gemm] counter=181 total t=3.0e-02 per=6.0e+01 cost=1.8e+04 flops=5.9e+05
 sigma[red] counter=181 t=1.3e-02 per=2.5e+01 cost=9.3e+03 flops=7.3e+05
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=4.5e+00 t_reduction=2.0e+00 tot=7.6e+00 -----
 sigma_tot[inter] counter=181 t=1.1e+00 per=1.5e+01 cost=6.8e+07 flops=6.1e+07
 sigma_tot[gemm] counter=181 i=0 t=2.4e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=1 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=2 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=3 t=2.1e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=4 t=1.1e+00 per=1.5e+01 cost=8.9e+06 flops=7.9e+06
 sigma_tot[gemm] counter=181 i=5 t=1.1e+00 per=1.5e+01 cost=9.0e+06 flops=7.9e+06
 sigma_tot[gemm] counter=181 i=6 t=1.1e+00 per=1.5e+01 cost=7.9e+06 flops=7.1e+06
 sigma_tot[gemm] counter=181 i=7 t=1.1e+00 per=1.5e+01 cost=8.0e+06 flops=7.2e+06
 sigma_tot[gemm] counter=181 total t=4.5e+00 per=5.9e+01 cost=3.4e+07 flops=7.5e+06
 sigma_tot[red] counter=181 t=2.0e+00 per=2.6e+01 cost=1.1e+07 flops=5.4e+06
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.5e-06,2.0e-06,8.3e-07,2.2e-07
settings: ndim=28 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.325910527615 -1.116e+03  3.369e-02    1     1  5.846e-02 5.846e-02 5.843e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.030e-03,7.409e-03,2.973e-02,1.278e-02,5.896e-02
 analyze_tgpu[Hx]: ndim=28:2.086e-07GB T(cpu-gpu)=2.166e-03 speed=1.926e-04GB/S T(nccl)=6.863e-03 speed=6.079e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=182 t=7.4e-03 per=1.5e+01 cost=7.4e+04 flops=9.9e+06
 sigma[gemm] counter=182 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=4 t=7.4e-03 per=1.5e+01 cost=5.6e+03 flops=7.6e+05
 sigma[gemm] counter=182 i=5 t=7.4e-03 per=1.5e+01 cost=5.6e+03 flops=7.5e+05
 sigma[gemm] counter=182 i=6 t=7.4e-03 per=1.5e+01 cost=3.3e+03 flops=4.4e+05
 sigma[gemm] counter=182 i=7 t=7.4e-03 per=1.5e+01 cost=3.3e+03 flops=4.4e+05
 sigma[gemm] counter=182 total t=3.0e-02 per=6.0e+01 cost=1.8e+04 flops=6.0e+05
 sigma[red] counter=182 t=1.3e-02 per=2.6e+01 cost=9.3e+03 flops=7.2e+05
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=4.5e+00 t_reduction=2.0e+00 tot=7.7e+00 -----
 sigma_tot[inter] counter=182 t=1.1e+00 per=1.5e+01 cost=6.8e+07 flops=6.0e+07
 sigma_tot[gemm] counter=182 i=0 t=2.5e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=1 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=2 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=3 t=2.1e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=4 t=1.1e+00 per=1.5e+01 cost=8.9e+06 flops=7.9e+06
 sigma_tot[gemm] counter=182 i=5 t=1.1e+00 per=1.5e+01 cost=9.0e+06 flops=7.8e+06
 sigma_tot[gemm] counter=182 i=6 t=1.1e+00 per=1.5e+01 cost=7.9e+06 flops=7.0e+06
 sigma_tot[gemm] counter=182 i=7 t=1.1e+00 per=1.5e+01 cost=8.0e+06 flops=7.1e+06
 sigma_tot[gemm] counter=182 total t=4.5e+00 per=5.9e+01 cost=3.4e+07 flops=7.5e+06
 sigma_tot[red] counter=182 t=2.0e+00 per=2.6e+01 cost=1.1e+07 flops=5.4e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.3e-05,3.7e-06,1.0e-06,2.3e-07
    2   0 -    -116.331005855949 -5.095e-03  4.307e-03    2     2  1.177e-01 5.887e-02 5.879e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.077e-03,7.492e-03,2.993e-02,1.261e-02,5.911e-02
 analyze_tgpu[Hx]: ndim=28:2.086e-07GB T(cpu-gpu)=2.224e-03 speed=1.876e-04GB/S T(nccl)=6.853e-03 speed=6.088e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=183 t=7.5e-03 per=1.5e+01 cost=7.4e+04 flops=9.8e+06
 sigma[gemm] counter=183 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=4 t=7.4e-03 per=1.5e+01 cost=5.6e+03 flops=7.5e+05
 sigma[gemm] counter=183 i=5 t=7.5e-03 per=1.5e+01 cost=5.6e+03 flops=7.4e+05
 sigma[gemm] counter=183 i=6 t=7.5e-03 per=1.5e+01 cost=3.3e+03 flops=4.3e+05
 sigma[gemm] counter=183 i=7 t=7.4e-03 per=1.5e+01 cost=3.3e+03 flops=4.5e+05
 sigma[gemm] counter=183 total t=3.0e-02 per=6.0e+01 cost=1.8e+04 flops=5.9e+05
 sigma[red] counter=183 t=1.3e-02 per=2.5e+01 cost=9.3e+03 flops=7.3e+05
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=4.6e+00 t_reduction=2.0e+00 tot=7.7e+00 -----
 sigma_tot[inter] counter=183 t=1.1e+00 per=1.5e+01 cost=6.8e+07 flops=6.0e+07
 sigma_tot[gemm] counter=183 i=0 t=2.5e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=1 t=2.2e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=2 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=3 t=2.1e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=4 t=1.1e+00 per=1.5e+01 cost=8.9e+06 flops=7.8e+06
 sigma_tot[gemm] counter=183 i=5 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.8e+06
 sigma_tot[gemm] counter=183 i=6 t=1.1e+00 per=1.5e+01 cost=7.9e+06 flops=7.0e+06
 sigma_tot[gemm] counter=183 i=7 t=1.1e+00 per=1.5e+01 cost=8.0e+06 flops=7.1e+06
 sigma_tot[gemm] counter=183 total t=4.6e+00 per=5.9e+01 cost=3.4e+07 flops=7.4e+06
 sigma_tot[red] counter=183 t=2.0e+00 per=2.6e+01 cost=1.1e+07 flops=5.3e+06
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.5e-05,3.2e-06,9.4e-07,2.2e-07
    3   0 -    -116.331064426371 -5.857e-05  1.265e-03    3     3  1.772e-01 5.905e-02 5.898e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.592e-03,7.570e-03,3.007e-02,1.275e-02,5.899e-02
 analyze_tgpu[Hx]: ndim=28:2.086e-07GB T(cpu-gpu)=2.164e-03 speed=1.928e-04GB/S T(nccl)=6.428e-03 speed=6.491e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=184 t=7.6e-03 per=1.5e+01 cost=7.4e+04 flops=9.7e+06
 sigma[gemm] counter=184 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=4 t=7.5e-03 per=1.5e+01 cost=5.6e+03 flops=7.4e+05
 sigma[gemm] counter=184 i=5 t=7.5e-03 per=1.5e+01 cost=5.6e+03 flops=7.4e+05
 sigma[gemm] counter=184 i=6 t=7.4e-03 per=1.5e+01 cost=3.3e+03 flops=4.4e+05
 sigma[gemm] counter=184 i=7 t=7.6e-03 per=1.5e+01 cost=3.3e+03 flops=4.4e+05
 sigma[gemm] counter=184 total t=3.0e-02 per=6.0e+01 cost=1.8e+04 flops=5.9e+05
 sigma[red] counter=184 t=1.3e-02 per=2.5e+01 cost=9.3e+03 flops=7.3e+05
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=4.6e+00 t_reduction=2.1e+00 tot=7.8e+00 -----
 sigma_tot[inter] counter=184 t=1.1e+00 per=1.5e+01 cost=6.8e+07 flops=6.0e+07
 sigma_tot[gemm] counter=184 i=0 t=2.5e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=1 t=2.2e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=2 t=2.1e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=3 t=2.1e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=4 t=1.2e+00 per=1.5e+01 cost=8.9e+06 flops=7.8e+06
 sigma_tot[gemm] counter=184 i=5 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.7e+06
 sigma_tot[gemm] counter=184 i=6 t=1.1e+00 per=1.5e+01 cost=7.9e+06 flops=6.9e+06
 sigma_tot[gemm] counter=184 i=7 t=1.1e+00 per=1.5e+01 cost=8.0e+06 flops=7.1e+06
 sigma_tot[gemm] counter=184 total t=4.6e+00 per=5.9e+01 cost=3.4e+07 flops=7.4e+06
 sigma_tot[red] counter=184 t=2.1e+00 per=2.6e+01 cost=1.1e+07 flops=5.3e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.4e-05,3.1e-06,9.6e-07,2.0e-07
    4   0 -    -116.331068860674 -4.434e-06  1.710e-04    3     4  2.364e-01 5.910e-02 5.903e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.927e-03,7.461e-03,3.006e-02,1.290e-02,5.935e-02
 analyze_tgpu[Hx]: ndim=28:2.086e-07GB T(cpu-gpu)=2.215e-03 speed=1.883e-04GB/S T(nccl)=6.711e-03 speed=6.217e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=185 t=7.5e-03 per=1.5e+01 cost=7.4e+04 flops=9.9e+06
 sigma[gemm] counter=185 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=4 t=7.4e-03 per=1.5e+01 cost=5.6e+03 flops=7.5e+05
 sigma[gemm] counter=185 i=5 t=7.5e-03 per=1.5e+01 cost=5.6e+03 flops=7.5e+05
 sigma[gemm] counter=185 i=6 t=7.6e-03 per=1.5e+01 cost=3.3e+03 flops=4.3e+05
 sigma[gemm] counter=185 i=7 t=7.6e-03 per=1.5e+01 cost=3.3e+03 flops=4.4e+05
 sigma[gemm] counter=185 total t=3.0e-02 per=6.0e+01 cost=1.8e+04 flops=5.9e+05
 sigma[red] counter=185 t=1.3e-02 per=2.6e+01 cost=9.3e+03 flops=7.2e+05
----- TIMING FOR sigma_tot : t_inter=1.1e+00 t_gemm=4.6e+00 t_reduction=2.1e+00 tot=7.8e+00 -----
 sigma_tot[inter] counter=185 t=1.1e+00 per=1.5e+01 cost=6.8e+07 flops=5.9e+07
 sigma_tot[gemm] counter=185 i=0 t=2.5e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=1 t=2.2e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=2 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=3 t=2.1e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=4 t=1.2e+00 per=1.5e+01 cost=8.9e+06 flops=7.7e+06
 sigma_tot[gemm] counter=185 i=5 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.7e+06
 sigma_tot[gemm] counter=185 i=6 t=1.1e+00 per=1.5e+01 cost=7.9e+06 flops=6.9e+06
 sigma_tot[gemm] counter=185 i=7 t=1.1e+00 per=1.5e+01 cost=8.0e+06 flops=7.0e+06
 sigma_tot[gemm] counter=185 total t=4.6e+00 per=5.9e+01 cost=3.4e+07 flops=7.3e+06
 sigma_tot[red] counter=185 t=2.1e+00 per=2.6e+01 cost=1.1e+07 flops=5.3e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.4e-05,3.2e-06,9.7e-07,2.1e-07
    5   0 +    -116.331068947934 -8.726e-08  2.138e-05    3     5  2.960e-01 5.920e-02 5.914e-02
TIMING FOR Davidson : 2.960e-01  T(cal/comm/rest)=2.957e-01,1.421e-06,3.632e-04
decomposed t_rest=3.632e-04
 T(sub)    =9.883e-05 per=2.721e+01
 T(precond)=3.233e-05 per=8.901e+00
 T(ortho)  =9.379e-06 per=2.582e+00
 T(xcopy)  =7.020e-07 per=1.933e-01
 T(xnrm2)  =2.233e-06 per=6.148e-01
 T(other)  =2.197e-04 per=6.050e+01
optimized energies: isweep=0 ibond=31 dots=2 e[0]=-116.331068947934 nmvp=5
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=9.024e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond31.txt
 qbond: qsuper nsym=11 dimAll=28
 (24,2):6 (23,3):3 (22,2):1 (23,1):2 (24,4):3 (26,2):2 (25,3):5 (25,1):3 (26,4):1 (24,0):1 (25,5):1
timing for divide=5.8e-05
timing for compute=7.0e-05
timing for collect=1.7e-05
----- TMING FOR decimation_genbasis(su2): 1.4e-04 S T(divide/compute[cpu/gpu/rest]/collect)=5.8e-05,6.1e-05,0.0e+00,8.3e-06,1.7e-05 -----
decimation summary: 28->8 dwt=+0.000e+00 SvN=2.941e-01
 qbond: qkept nsym=6 dimAll=8
 (24,2):2 (25,1):2 (23,1):1 (26,2):1 (25,3):1 (24,0):1
----- TIMING for decimation_row(nkr): 5.000e-04 S T(decim/select/formRot)=2.073e-04,1.977e-04,9.510e-05 -----
----- TIMING FOR twodot_decimation: 1.128e-03 S T(wf/decim)=5.231e-04,6.051e-04 -----
ctns::oper_renorm coord=(4,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:16 S:2 P:8 Q:10 
        dim(bra,ket)=8,8 size(op)=19:1.450e-04MB size(tot)=457:3.487e-03MB:3.405e-06GB
        per(mem): H:2.63 C:49 S:6.13 P:8.32 Q:33.9 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=1.108e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=35 : 1.053e-03 S -----
rank=0 GPUmem(GB): used=2.782e-05 (oper)=1.432e-05
rank=0 GPUmem(GB): used=2.803e-05 (oper,site)=1.432e-05,2.086e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=35
 no. of rintermediate operators=28
 no. of coefficients=420:3.204e-03MB:3.129e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.518e-03 S -----
rank=0 GPUmem(GB): used=3.116e-05 (oper,site,rinter)=1.432e-05,2.086e-07,3.129e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.218e-02 S size(rtasks)=35 size(Rlst2)=36 T(Rmu/Rlist)=2.178e-04,1.196e-02 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.231e-02 S size(rtasks)=35 size(Rlst)=1013 -----
rank=0 GPUmem(GB): used=3.116e-05 avail=6.231e+00 total=6.231e+00 batch[need]=9.812e-05 blksize=4 blksize0=4 batchsize=1013
rank=0 GPUmem(GB): used=1.293e-04 (oper,site,rinter,batch)=1.432e-05,2.086e-07,3.129e-06,9.812e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.539e-03,2.259e-02,1.023e-02
----- TIMING FOR renorm : t_inter=6.5e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=3.9e-02 -----
 renorm[inter] counter=361 t=6.5e-03 per=1.7e+01 cost=1.6e+04 flops=2.5e+06
 renorm[gemm] counter=361 i=0 t=1.3e-06 per=3.4e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=361 i=1 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=361 i=2 t=7.4e-03 per=1.9e+01 cost=1.7e+03 flops=2.2e+05
 renorm[gemm] counter=361 i=3 t=7.6e-03 per=1.9e+01 cost=4.4e+03 flops=5.8e+05
 renorm[gemm] counter=361 i=4 t=1.2e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=361 i=5 t=1.1e-06 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=361 i=6 t=7.6e-03 per=1.9e+01 cost=7.5e+03 flops=9.9e+05
 renorm[gemm] counter=361 total t=2.3e-02 per=5.7e+01 cost=1.4e+04 flops=6.0e+05
 renorm[red] counter=361 t=1.0e-02 per=2.6e+01 cost=4.9e+03 flops=4.8e+05
----- TIMING FOR renorm_tot : t_inter=2.0e-01 t_gemm=7.0e-01 t_reduction=3.0e-01 tot=1.2e+00 -----
 renorm_tot[inter] counter=361 t=2.0e-01 per=1.6e+01 cost=7.8e+05 flops=4.0e+06
 renorm_tot[gemm] counter=361 i=0 t=4.3e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=361 i=1 t=3.7e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=361 i=2 t=1.1e-01 per=9.3e+00 cost=4.7e+04 flops=4.2e+05
 renorm_tot[gemm] counter=361 i=3 t=1.0e-01 per=8.4e+00 cost=1.7e+05 flops=1.7e+06
 renorm_tot[gemm] counter=361 i=4 t=1.3e-01 per=1.1e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=361 i=5 t=1.3e-01 per=1.1e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=361 i=6 t=2.3e-01 per=1.9e+01 cost=4.7e+05 flops=2.0e+06
 renorm_tot[gemm] counter=361 total t=7.0e-01 per=5.8e+01 cost=8.7e+05 flops=1.3e+06
 renorm_tot[red] counter=361 t=3.0e-01 per=2.5e+01 cost=2.7e+05 flops=8.8e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.172e-05 (optmp,oper)=1.043e-07,1.432e-05
rank=0 GPUmem(GB): used=3.193e-05 (optmp,oper,site,rinter)=1.043e-07,1.432e-05,2.086e-07,6.706e-07
rank=0 GPUmem(GB): used=3.736e-05 (optmp,oper,site,rinter,batch)=1.043e-07,1.432e-05,2.086e-07,6.706e-07,5.424e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.267e-01 S T(prep/alloc/comp/red/dealloc)=2.905e-03,5.557e-03,8.242e-02,3.627e-02,2.493e-03 -----
----- TIMING FOR oper_renorm_opS : 1.268e-01 S rank=0 -----
qops.to_cpu: size(tot)=457:3.487e-03MB:3.405e-06GB T(to_cpu)=6.036e-05S speed=5.641e-02GB/S
check ||H-H.dagger||=4.799e-15 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.194 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=3.013e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.196e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-4.396e-06 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 6.704e-01 S #####
 T(local opt: fetch) = 9.766e-03 S  per = 1.46  per(accum) = 1.46
 T(local opt: hdiag) = 9.051e-02 S  per = 13.5  per(accum) = 15
 T(local opt: dvdsn) = 3.725e-01 S  per = 55.6  per(accum) = 70.5
 T(local opt: decim) = 1.242e-03 S  per = 0.185  per(accum) = 70.7
 T(local opt: guess) = 6.962e-04 S  per = 0.104  per(accum) = 70.8
 T(local opt: renrm) = 1.955e-01 S  per = 29.2  per(accum) = 100
 T(local opt: save ) = 2.186e-04 S  per = 0.0326  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.725e-01 S  T(sum) = 3.722e-01 S  per = 9.992e+01
 T(local opt: preprocess                  ) = 2.499e-03 S  per = 0.671  per(accum) = 0.671
 T(local opt: symbolic_formulae           ) = 1.965e-03 S  per = 0.528  per(accum) = 1.2
 T(local opt: hintermediate init          ) = 1.864e-04 S  per = 0.0501  per(accum) = 1.25
 T(local opt: preprocess_hformulae_Hxlist ) = 5.236e-02 S  per = 14.1  per(accum) = 15.3
 T(local opt: hmmtasks init               ) = 1.838e-02 S  per = 4.94  per(accum) = 20.3
 T(local opt: initial guess for dvdson    ) = 7.807e-04 S  per = 0.21  per(accum) = 20.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.522e-01 S  per = 67.8  per(accum) = 88.2
 T(local opt: dvdson [cpu-gpu]            ) = 1.095e-02 S  per = 2.94  per(accum) = 91.2
 T(local opt: dvdson [nccl]               ) = 3.251e-02 S  per = 8.73  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 1.421e-06 S  per = 0.000382  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 3.632e-04 S  per = 0.0976  per(accum) = 100
Detailed decomposition of T(renrm) = 1.955e-01 S  T(sum) = 1.955e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.818e-04 S  per = 0.144  per(accum) = 0.144
 T(local opt: qops init                    ) = 1.651e-03 S  per = 0.845  per(accum) = 0.989
 T(local opt: symbolic_formulae_renorm     ) = 1.065e-03 S  per = 0.545  per(accum) = 1.53
 T(local opt: allocate qops on gpu         ) = 7.858e-05 S  per = 0.0402  per(accum) = 1.57
 T(local opt: site memcpy cpu2gpu          ) = 1.120e-03 S  per = 0.573  per(accum) = 2.15
 T(local opt: rintermediate init           ) = 2.531e-03 S  per = 1.29  per(accum) = 3.44
 T(local opt: preprocess_formulae_Rlist2   ) = 1.240e-02 S  per = 6.34  per(accum) = 9.79
 T(local opt: rmmtasks init                ) = 5.700e-03 S  per = 2.92  per(accum) = 12.7
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 2.2e-05  per(accum) = 12.7
 T(local opt: preprocess_renorm_batchGPU   ) = 3.952e-02 S  per = 20.2  per(accum) = 32.9
 T(local opt: deallocate cpu and gpu memory) = 6.352e-05 S  per = 0.0325  per(accum) = 33
 T(local opt: construct opS [ifdists=true] ) = 1.269e-01 S  per = 64.9  per(accum) = 97.9
 T(local opt: reduction of opS & opH [nccl]) = 2.422e-03 S  per = 1.24  per(accum) = 99.1
 T(local opt: qops memcpy gpu2cpu          ) = 7.065e-05 S  per = 0.0361  per(accum) = 99.1
 T(local opt: reduction of opS & opH [mpi] ) = 6.751e-05 S  per = 0.0345  per(accum) = 99.2
 T(local opt: qops_pool join and erase     ) = 1.626e-03 S  per = 0.832  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.242e-06 S  per = 0.00371  per(accum) = 100
##### sweep opt: 4.494e+01 S #####
 T(sweep opt: fetch) = 3.829e-01 S  per = 0.852  per(accum) = 0.852
 T(sweep opt: hdiag) = 9.078e+00 S  per = 20.2  per(accum) = 21.1
 T(sweep opt: dvdsn) = 1.818e+01 S  per = 40.5  per(accum) = 61.5
 T(sweep opt: decim) = 4.837e-02 S  per = 0.108  per(accum) = 61.6
 T(sweep opt: guess) = 3.110e-02 S  per = 0.0692  per(accum) = 61.7
 T(sweep opt: renrm) = 1.721e+01 S  per = 38.3  per(accum) = 100
 T(sweep opt: save ) = 7.559e-03 S  per = 0.0168  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.818e+01 S  T(sum) = 1.816e+01 S  per = 9.988e+01
 T(sweep opt: preprocess                  ) = 1.659e-01 S  per = 0.914  per(accum) = 0.914
 T(sweep opt: symbolic_formulae           ) = 1.174e-01 S  per = 0.647  per(accum) = 1.56
 T(sweep opt: hintermediate init          ) = 6.450e-03 S  per = 0.0355  per(accum) = 1.6
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.553e+00 S  per = 30.6  per(accum) = 32.2
 T(sweep opt: hmmtasks init               ) = 2.477e+00 S  per = 13.6  per(accum) = 45.8
 T(sweep opt: initial guess for dvdson    ) = 4.714e-02 S  per = 0.26  per(accum) = 46.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 7.869e+00 S  per = 43.3  per(accum) = 89.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.677e-01 S  per = 2.02  per(accum) = 91.4
 T(sweep opt: dvdson [nccl]               ) = 1.488e+00 S  per =  8.2  per(accum) = 99.6
 T(sweep opt: dvdson [mpi]                ) = 1.843e-04 S  per = 0.00101  per(accum) = 99.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.580e-02 S  per = 0.362  per(accum) = 100
Detailed decomposition of T(renrm) = 1.721e+01 S  T(sum) = 1.721e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.665e-03 S  per = 0.0562  per(accum) = 0.0562
 T(sweep opt: qops init                    ) = 7.981e-02 S  per = 0.464  per(accum) = 0.52
 T(sweep opt: symbolic_formulae_renorm     ) = 3.630e-02 S  per = 0.211  per(accum) = 0.731
 T(sweep opt: allocate qops on gpu         ) = 2.262e-03 S  per = 0.0131  per(accum) = 0.744
 T(sweep opt: site memcpy cpu2gpu          ) = 4.081e-02 S  per = 0.237  per(accum) = 0.981
 T(sweep opt: rintermediate init           ) = 7.279e-02 S  per = 0.423  per(accum) = 1.4
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.473e-01 S  per = 3.18  per(accum) = 4.58
 T(sweep opt: rmmtasks init                ) = 2.642e-01 S  per = 1.54  per(accum) = 6.12
 T(sweep opt: qops memset on cpu           ) = 1.118e-06 S  per = 6.5e-06  per(accum) = 6.12
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.202e+00 S  per = 6.99  per(accum) = 13.1
 T(sweep opt: deallocate cpu and gpu memory) = 2.302e-03 S  per = 0.0134  per(accum) = 13.1
 T(sweep opt: construct opS [ifdists=true] ) = 1.453e+01 S  per = 84.5  per(accum) = 97.6
 T(sweep opt: reduction of opS & opH [nccl]) = 1.426e-01 S  per = 0.829  per(accum) = 98.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.072e-03 S  per = 0.0179  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.056e-03 S  per = 0.0119  per(accum) = 98.4
 T(sweep opt: qops_pool join and erase     ) = 6.828e-02 S  per = 0.397  per(accum) = 98.8
 T(sweep opt: conversion from opAB to opPQ ) = 1.990e-01 S  per = 1.16  per(accum) = 100
##### global opt: 4.494e+01 S #####
 T(global opt: fetch) = 3.829e-01 S  per = 0.852  per(accum) = 0.852
 T(global opt: hdiag) = 9.078e+00 S  per = 20.2  per(accum) = 21.1
 T(global opt: dvdsn) = 1.818e+01 S  per = 40.5  per(accum) = 61.5
 T(global opt: decim) = 4.837e-02 S  per = 0.108  per(accum) = 61.6
 T(global opt: guess) = 3.110e-02 S  per = 0.0692  per(accum) = 61.7
 T(global opt: renrm) = 1.721e+01 S  per = 38.3  per(accum) = 100
 T(global opt: save ) = 7.559e-03 S  per = 0.0168  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.818e+01 S  T(sum) = 1.816e+01 S  per = 9.988e+01
 T(global opt: preprocess                  ) = 1.659e-01 S  per = 0.914  per(accum) = 0.914
 T(global opt: symbolic_formulae           ) = 1.174e-01 S  per = 0.647  per(accum) = 1.56
 T(global opt: hintermediate init          ) = 6.450e-03 S  per = 0.0355  per(accum) = 1.6
 T(global opt: preprocess_hformulae_Hxlist ) = 5.553e+00 S  per = 30.6  per(accum) = 32.2
 T(global opt: hmmtasks init               ) = 2.477e+00 S  per = 13.6  per(accum) = 45.8
 T(global opt: initial guess for dvdson    ) = 4.714e-02 S  per = 0.26  per(accum) = 46.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 7.869e+00 S  per = 43.3  per(accum) = 89.4
 T(global opt: dvdson [cpu-gpu]            ) = 3.677e-01 S  per = 2.02  per(accum) = 91.4
 T(global opt: dvdson [nccl]               ) = 1.488e+00 S  per =  8.2  per(accum) = 99.6
 T(global opt: dvdson [mpi]                ) = 1.843e-04 S  per = 0.00101  per(accum) = 99.6
 T(global opt: dvdson [rest part(linalg)]  ) = 6.580e-02 S  per = 0.362  per(accum) = 100
Detailed decomposition of T(renrm) = 1.721e+01 S  T(sum) = 1.721e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.665e-03 S  per = 0.0562  per(accum) = 0.0562
 T(global opt: qops init                    ) = 7.981e-02 S  per = 0.464  per(accum) = 0.52
 T(global opt: symbolic_formulae_renorm     ) = 3.630e-02 S  per = 0.211  per(accum) = 0.731
 T(global opt: allocate qops on gpu         ) = 2.262e-03 S  per = 0.0131  per(accum) = 0.744
 T(global opt: site memcpy cpu2gpu          ) = 4.081e-02 S  per = 0.237  per(accum) = 0.981
 T(global opt: rintermediate init           ) = 7.279e-02 S  per = 0.423  per(accum) = 1.4
 T(global opt: preprocess_formulae_Rlist2   ) = 5.473e-01 S  per = 3.18  per(accum) = 4.58
 T(global opt: rmmtasks init                ) = 2.642e-01 S  per = 1.54  per(accum) = 6.12
 T(global opt: qops memset on cpu           ) = 1.118e-06 S  per = 6.5e-06  per(accum) = 6.12
 T(global opt: preprocess_renorm_batchGPU   ) = 1.202e+00 S  per = 6.99  per(accum) = 13.1
 T(global opt: deallocate cpu and gpu memory) = 2.302e-03 S  per = 0.0134  per(accum) = 13.1
 T(global opt: construct opS [ifdists=true] ) = 1.453e+01 S  per = 84.5  per(accum) = 97.6
 T(global opt: reduction of opS & opH [nccl]) = 1.426e-01 S  per = 0.829  per(accum) = 98.4
 T(global opt: qops memcpy gpu2cpu          ) = 3.072e-03 S  per = 0.0179  per(accum) = 98.4
 T(global opt: reduction of opS & opH [mpi] ) = 2.056e-03 S  per = 0.0119  per(accum) = 98.4
 T(global opt: qops_pool join and erase     ) = 6.828e-02 S  per = 0.397  per(accum) = 98.8
 T(global opt: conversion from opAB to opPQ ) = 1.990e-01 S  per = 1.16  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-8.937e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=32/seqsize=34 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=646:4.929e-03MB:4.813e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=12:9.155e-05MB:8.941e-08GB
total mem of comb=659:5.028e-03MB:4.910e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,16,1,1
 suppl= 0 1
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=HCSAB nops=H:1 C:2 S:9 A:1 B:4 
        dim(bra,ket)=2,2 size(op)=2:1.526e-05MB size(tot)=19:1.450e-04MB:1.416e-07GB
        per(mem): H:10.5 C:10.5 S:47.4 A:0 B:31.6 
 rqops: oplist=HCSPQ nops=H:1 C:16 S:2 P:8 Q:10 
        dim(bra,ket)=8,8 size(op)=19:0.000145MB size(tot)=457:0.00349MB:3.4e-06GB
        per(mem): H:2.63 C:49 S:6.13 P:8.32 Q:33.9 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=2472:0.0189MB:1.84e-05GB
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=8.094e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=2.682e-07 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(2,8,3,3) nnz=29:2.213e-04MB
qtensor4: wf4 own=1 _data=0x46dfa3c0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=2 dimAll=2
 (4,0):1 (3,1):1
 qbond: qcol nsym=6 dimAll=8
 (24,2):2 (25,1):2 (23,1):1 (26,2):1 (25,3):1 (24,0):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=20 nblocks=161 size=29:2.213e-04MB
### DIAG TIMING: total=8.322e-02 t1=3.181e-05, t2=1.608e-03, t3=2.507e-03, t4=7.657e-02, t5=2.973e-06, t6=2.490e-03, t7=5.020e-06
duration_diagGPU:8.324e-02
duration_diagreduce:6.500e-08
duration_diagtransform:4.210e-07
----- TIMING FOR symbolic_formulae_twodot with size=107 : 1.358e-03 S -----
rank=0 GPUmem(GB): used=1.842e-05 (oper)=1.842e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=107
 no. of hintermediate operators=42
 no. of coefficients=518:3.952e-03MB:3.859e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.813e-05 S -----
rank=0 GPUmem(GB): used=2.228e-05 (oper,hinter)=1.842e-05,3.859e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.570e-02 S size(H_formulae)=107 size(Hxlst2)=20 T(Hmu/Hxlist)=2.553e-04,3.544e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.611e-02 S size(H_formulae)=107 size(Hxlst)=2340 -----
rank=0 GPUmem(GB): used=2.228e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=4.321e-07 batch[need]=1.569e-04 blksize=2 blksize0=4 batchsize=2340
rank=0 GPUmem(GB): used=1.796e-04 (oper,hinter,dvdson,batch)=1.842e-05,3.859e-06,4.321e-07,1.569e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=29 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.562e-03,7.430e-03,2.965e-02,1.271e-02,5.636e-02
 analyze_tgpu[Hx]: ndim=29:2.161e-07GB T(cpu-gpu)=1.169e-03 speed=3.697e-04GB/S T(nccl)=5.393e-03 speed=8.013e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=186 t=7.4e-03 per=1.5e+01 cost=4.6e+04 flops=6.2e+06
 sigma[gemm] counter=186 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=4 t=7.4e-03 per=1.5e+01 cost=4.1e+03 flops=5.6e+05
 sigma[gemm] counter=186 i=5 t=7.4e-03 per=1.5e+01 cost=4.1e+03 flops=5.6e+05
 sigma[gemm] counter=186 i=6 t=7.4e-03 per=1.5e+01 cost=2.2e+03 flops=2.9e+05
 sigma[gemm] counter=186 i=7 t=7.4e-03 per=1.5e+01 cost=2.2e+03 flops=2.9e+05
 sigma[gemm] counter=186 total t=3.0e-02 per=6.0e+01 cost=1.3e+04 flops=4.2e+05
 sigma[red] counter=186 t=1.3e-02 per=2.6e+01 cost=7.0e+03 flops=5.5e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=4.6e+00 t_reduction=2.1e+00 tot=7.9e+00 -----
 sigma_tot[inter] counter=186 t=1.2e+00 per=1.5e+01 cost=6.8e+07 flops=5.9e+07
 sigma_tot[gemm] counter=186 i=0 t=2.5e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=1 t=2.2e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=2 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=3 t=2.1e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=4 t=1.2e+00 per=1.5e+01 cost=8.9e+06 flops=7.7e+06
 sigma_tot[gemm] counter=186 i=5 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.6e+06
 sigma_tot[gemm] counter=186 i=6 t=1.2e+00 per=1.5e+01 cost=7.9e+06 flops=6.8e+06
 sigma_tot[gemm] counter=186 i=7 t=1.1e+00 per=1.5e+01 cost=8.0e+06 flops=7.0e+06
 sigma_tot[gemm] counter=186 total t=4.6e+00 per=5.9e+01 cost=3.4e+07 flops=7.3e+06
 sigma_tot[red] counter=186 t=2.1e+00 per=2.6e+01 cost=1.1e+07 flops=5.3e+06
T(sub)=9.6e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,4.2e-06,2.1e-06,6.5e-07,1.9e-07
settings: ndim=29 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.331068947934 -1.116e+03  4.745e-02    1     1  5.664e-02 5.664e-02 5.656e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.281e-03,7.480e-03,2.999e-02,1.259e-02,5.935e-02
 analyze_tgpu[Hx]: ndim=29:2.161e-07GB T(cpu-gpu)=2.204e-03 speed=1.961e-04GB/S T(nccl)=7.077e-03 speed=6.106e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=187 t=7.5e-03 per=1.5e+01 cost=4.6e+04 flops=6.1e+06
 sigma[gemm] counter=187 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=4 t=7.5e-03 per=1.5e+01 cost=4.1e+03 flops=5.5e+05
 sigma[gemm] counter=187 i=5 t=7.4e-03 per=1.5e+01 cost=4.1e+03 flops=5.5e+05
 sigma[gemm] counter=187 i=6 t=7.5e-03 per=1.5e+01 cost=2.2e+03 flops=2.9e+05
 sigma[gemm] counter=187 i=7 t=7.5e-03 per=1.5e+01 cost=2.2e+03 flops=2.9e+05
 sigma[gemm] counter=187 total t=3.0e-02 per=6.0e+01 cost=1.3e+04 flops=4.2e+05
 sigma[red] counter=187 t=1.3e-02 per=2.5e+01 cost=7.0e+03 flops=5.6e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=4.7e+00 t_reduction=2.1e+00 tot=7.9e+00 -----
 sigma_tot[inter] counter=187 t=1.2e+00 per=1.5e+01 cost=6.8e+07 flops=5.9e+07
 sigma_tot[gemm] counter=187 i=0 t=2.5e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=1 t=2.2e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=2 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=3 t=2.1e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=4 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.6e+06
 sigma_tot[gemm] counter=187 i=5 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.6e+06
 sigma_tot[gemm] counter=187 i=6 t=1.2e+00 per=1.5e+01 cost=7.9e+06 flops=6.8e+06
 sigma_tot[gemm] counter=187 i=7 t=1.2e+00 per=1.5e+01 cost=8.0e+06 flops=6.9e+06
 sigma_tot[gemm] counter=187 total t=4.7e+00 per=5.9e+01 cost=3.4e+07 flops=7.2e+06
 sigma_tot[red] counter=187 t=2.1e+00 per=2.6e+01 cost=1.1e+07 flops=5.2e+06
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.1e-05,3.8e-06,9.6e-07,2.1e-07
    2   0 -    -116.338507641420 -7.439e-03  1.615e-02    2     2  1.162e-01 5.809e-02 5.802e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.167e-03,7.426e-03,2.997e-02,1.278e-02,5.735e-02
 analyze_tgpu[Hx]: ndim=29:2.161e-07GB T(cpu-gpu)=2.254e-03 speed=1.917e-04GB/S T(nccl)=4.913e-03 speed=8.795e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=188 t=7.4e-03 per=1.5e+01 cost=4.6e+04 flops=6.2e+06
 sigma[gemm] counter=188 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=4 t=7.5e-03 per=1.5e+01 cost=4.1e+03 flops=5.5e+05
 sigma[gemm] counter=188 i=5 t=7.5e-03 per=1.5e+01 cost=4.1e+03 flops=5.5e+05
 sigma[gemm] counter=188 i=6 t=7.4e-03 per=1.5e+01 cost=2.2e+03 flops=2.9e+05
 sigma[gemm] counter=188 i=7 t=7.5e-03 per=1.5e+01 cost=2.2e+03 flops=2.9e+05
 sigma[gemm] counter=188 total t=3.0e-02 per=6.0e+01 cost=1.3e+04 flops=4.2e+05
 sigma[red] counter=188 t=1.3e-02 per=2.5e+01 cost=7.0e+03 flops=5.5e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=4.7e+00 t_reduction=2.1e+00 tot=8.0e+00 -----
 sigma_tot[inter] counter=188 t=1.2e+00 per=1.5e+01 cost=6.8e+07 flops=5.8e+07
 sigma_tot[gemm] counter=188 i=0 t=2.5e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=1 t=2.2e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=2 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=3 t=2.1e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=4 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.6e+06
 sigma_tot[gemm] counter=188 i=5 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.5e+06
 sigma_tot[gemm] counter=188 i=6 t=1.2e+00 per=1.5e+01 cost=7.9e+06 flops=6.8e+06
 sigma_tot[gemm] counter=188 i=7 t=1.2e+00 per=1.5e+01 cost=8.0e+06 flops=6.9e+06
 sigma_tot[gemm] counter=188 total t=4.7e+00 per=5.9e+01 cost=3.4e+07 flops=7.2e+06
 sigma_tot[red] counter=188 t=2.1e+00 per=2.6e+01 cost=1.1e+07 flops=5.2e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.4e-05,3.3e-06,9.7e-07,1.8e-07
    3   0 -    -116.339500330058 -9.927e-04  5.527e-03    3     3  1.738e-01 5.795e-02 5.787e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.706e-03,7.455e-03,3.013e-02,1.280e-02,5.810e-02
 analyze_tgpu[Hx]: ndim=29:2.161e-07GB T(cpu-gpu)=2.170e-03 speed=1.991e-04GB/S T(nccl)=5.536e-03 speed=7.806e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=189 t=7.5e-03 per=1.5e+01 cost=4.6e+04 flops=6.2e+06
 sigma[gemm] counter=189 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=1 t=1.2e-06 per=2.4e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=4 t=7.5e-03 per=1.5e+01 cost=4.1e+03 flops=5.5e+05
 sigma[gemm] counter=189 i=5 t=7.6e-03 per=1.5e+01 cost=4.1e+03 flops=5.4e+05
 sigma[gemm] counter=189 i=6 t=7.5e-03 per=1.5e+01 cost=2.2e+03 flops=2.9e+05
 sigma[gemm] counter=189 i=7 t=7.6e-03 per=1.5e+01 cost=2.2e+03 flops=2.9e+05
 sigma[gemm] counter=189 total t=3.0e-02 per=6.0e+01 cost=1.3e+04 flops=4.2e+05
 sigma[red] counter=189 t=1.3e-02 per=2.5e+01 cost=7.0e+03 flops=5.5e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=4.7e+00 t_reduction=2.1e+00 tot=8.0e+00 -----
 sigma_tot[inter] counter=189 t=1.2e+00 per=1.5e+01 cost=6.8e+07 flops=5.8e+07
 sigma_tot[gemm] counter=189 i=0 t=2.5e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=1 t=2.2e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=2 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=3 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=4 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.5e+06
 sigma_tot[gemm] counter=189 i=5 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.5e+06
 sigma_tot[gemm] counter=189 i=6 t=1.2e+00 per=1.5e+01 cost=7.9e+06 flops=6.7e+06
 sigma_tot[gemm] counter=189 i=7 t=1.2e+00 per=1.5e+01 cost=8.0e+06 flops=6.8e+06
 sigma_tot[gemm] counter=189 total t=4.7e+00 per=5.9e+01 cost=3.4e+07 flops=7.2e+06
 sigma_tot[red] counter=189 t=2.1e+00 per=2.6e+01 cost=1.1e+07 flops=5.2e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.3e-05,3.1e-06,9.2e-07,1.7e-07
    4   0 -    -116.339579459561 -7.913e-05  1.111e-03    3     4  2.322e-01 5.805e-02 5.798e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.391e-03,7.564e-03,2.992e-02,1.271e-02,5.859e-02
 analyze_tgpu[Hx]: ndim=29:2.161e-07GB T(cpu-gpu)=2.196e-03 speed=1.968e-04GB/S T(nccl)=6.195e-03 speed=6.976e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=190 t=7.6e-03 per=1.5e+01 cost=4.6e+04 flops=6.1e+06
 sigma[gemm] counter=190 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=4 t=7.6e-03 per=1.5e+01 cost=4.1e+03 flops=5.4e+05
 sigma[gemm] counter=190 i=5 t=7.5e-03 per=1.5e+01 cost=4.1e+03 flops=5.5e+05
 sigma[gemm] counter=190 i=6 t=7.4e-03 per=1.5e+01 cost=2.2e+03 flops=2.9e+05
 sigma[gemm] counter=190 i=7 t=7.4e-03 per=1.5e+01 cost=2.2e+03 flops=2.9e+05
 sigma[gemm] counter=190 total t=3.0e-02 per=6.0e+01 cost=1.3e+04 flops=4.2e+05
 sigma[red] counter=190 t=1.3e-02 per=2.5e+01 cost=7.0e+03 flops=5.5e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=4.8e+00 t_reduction=2.1e+00 tot=8.1e+00 -----
 sigma_tot[inter] counter=190 t=1.2e+00 per=1.5e+01 cost=6.8e+07 flops=5.8e+07
 sigma_tot[gemm] counter=190 i=0 t=2.6e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=1 t=2.2e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=2 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=3 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=4 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.5e+06
 sigma_tot[gemm] counter=190 i=5 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.5e+06
 sigma_tot[gemm] counter=190 i=6 t=1.2e+00 per=1.5e+01 cost=7.9e+06 flops=6.7e+06
 sigma_tot[gemm] counter=190 i=7 t=1.2e+00 per=1.5e+01 cost=8.0e+06 flops=6.8e+06
 sigma_tot[gemm] counter=190 total t=4.8e+00 per=5.9e+01 cost=3.4e+07 flops=7.1e+06
 sigma_tot[red] counter=190 t=2.1e+00 per=2.6e+01 cost=1.1e+07 flops=5.1e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,1.3e-05,3.1e-06,9.7e-07,2.3e-07
    5   0 -    -116.339584693187 -5.234e-06  2.364e-04    3     5  2.911e-01 5.823e-02 5.816e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.409e-03,7.605e-03,3.020e-02,1.297e-02,5.919e-02
 analyze_tgpu[Hx]: ndim=29:2.161e-07GB T(cpu-gpu)=2.222e-03 speed=1.945e-04GB/S T(nccl)=6.187e-03 speed=6.984e-05GB/S
----- TIMING FOR sigma : t_inter=7.6e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.1e-02 -----
 sigma[inter] counter=191 t=7.6e-03 per=1.5e+01 cost=4.6e+04 flops=6.0e+06
 sigma[gemm] counter=191 i=0 t=1.3e-06 per=2.5e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=1 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=4 t=7.6e-03 per=1.5e+01 cost=4.1e+03 flops=5.4e+05
 sigma[gemm] counter=191 i=5 t=7.6e-03 per=1.5e+01 cost=4.1e+03 flops=5.4e+05
 sigma[gemm] counter=191 i=6 t=7.6e-03 per=1.5e+01 cost=2.2e+03 flops=2.8e+05
 sigma[gemm] counter=191 i=7 t=7.5e-03 per=1.5e+01 cost=2.2e+03 flops=2.9e+05
 sigma[gemm] counter=191 total t=3.0e-02 per=5.9e+01 cost=1.3e+04 flops=4.2e+05
 sigma[red] counter=191 t=1.3e-02 per=2.6e+01 cost=7.0e+03 flops=5.4e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=4.8e+00 t_reduction=2.1e+00 tot=8.1e+00 -----
 sigma_tot[inter] counter=191 t=1.2e+00 per=1.5e+01 cost=6.8e+07 flops=5.7e+07
 sigma_tot[gemm] counter=191 i=0 t=2.6e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=1 t=2.2e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=2 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=3 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=4 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.5e+06
 sigma_tot[gemm] counter=191 i=5 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.4e+06
 sigma_tot[gemm] counter=191 i=6 t=1.2e+00 per=1.5e+01 cost=7.9e+06 flops=6.6e+06
 sigma_tot[gemm] counter=191 i=7 t=1.2e+00 per=1.5e+01 cost=8.0e+06 flops=6.8e+06
 sigma_tot[gemm] counter=191 total t=4.8e+00 per=5.9e+01 cost=3.4e+07 flops=7.1e+06
 sigma_tot[red] counter=191 t=2.1e+00 per=2.6e+01 cost=1.1e+07 flops=5.1e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.3e-05,3.2e-06,9.8e-07,2.1e-07
    6   0 +    -116.339584904797 -2.116e-07  8.052e-05    3     6  3.506e-01 5.843e-02 5.836e-02
TIMING FOR Davidson : 3.506e-01  T(cal/comm/rest)=3.502e-01,1.648e-06,4.334e-04
decomposed t_rest=4.334e-04
 T(sub)    =1.150e-04 per=2.653e+01
 T(precond)=4.262e-05 per=9.832e+00
 T(ortho)  =1.130e-05 per=2.607e+00
 T(xcopy)  =8.730e-07 per=2.014e-01
 T(xnrm2)  =2.652e-06 per=6.119e-01
 T(other)  =2.610e-04 per=6.021e+01
optimized energies: isweep=0 ibond=32 dots=2 e[0]=-116.339584904797 nmvp=6
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=7.015e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond32.txt
 qbond: qsuper nsym=11 dimAll=31
 (24,2):3 (25,1):6 (23,1):1 (26,2):6 (25,3):3 (24,0):2 (27,1):3 (28,2):1 (27,3):2 (26,0):3 (26,4):1
timing for divide=4.6e-05
timing for compute=6.9e-05
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(su2): 1.3e-04 S T(divide/compute[cpu/gpu/rest]/collect)=4.6e-05,5.7e-05,0.0e+00,1.1e-05,1.6e-05 -----
decimation summary: 31->7 dwt=+0.000e+00 SvN=4.692e-01
 qbond: qkept nsym=5 dimAll=7
 (25,1):2 (26,0):2 (26,2):1 (24,0):1 (27,1):1
----- TIMING for decimation_row(nkr): 4.911e-04 S T(decim/select/formRot)=1.935e-04,2.173e-04,8.027e-05 -----
----- TIMING FOR twodot_decimation: 1.057e-03 S T(wf/decim)=4.761e-04,5.811e-04 -----
ctns::oper_renorm coord=(3,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:17 S:1 P:4 Q:7 
        dim(bra,ket)=7,7 size(op)=11:8.392e-05MB size(tot)=298:2.274e-03MB:2.220e-06GB
        per(mem): H:3.69 C:62.8 S:3.69 P:5.03 Q:24.8 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=7.244e-05 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=29 : 7.473e-04 S -----
rank=0 GPUmem(GB): used=2.436e-05 (oper)=1.306e-05
rank=0 GPUmem(GB): used=2.457e-05 (oper,site)=1.306e-05,2.161e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=29
 no. of rintermediate operators=18
 no. of coefficients=288:2.197e-03MB:2.146e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.468e-03 S -----
rank=0 GPUmem(GB): used=2.672e-05 (oper,site,rinter)=1.306e-05,2.161e-07,2.146e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 9.949e-03 S size(rtasks)=29 size(Rlst2)=25 T(Rmu/Rlist)=1.516e-04,9.797e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.016e-02 S size(rtasks)=29 size(Rlst)=912 -----
rank=0 GPUmem(GB): used=2.672e-05 avail=6.231e+00 total=6.231e+00 batch[need]=8.833e-05 blksize=4 blksize0=4 batchsize=912
rank=0 GPUmem(GB): used=1.151e-04 (oper,site,rinter,batch)=1.306e-05,2.161e-07,2.146e-06,8.833e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.388e-03,7.248e-03,1.802e-03
----- TIMING FOR renorm : t_inter=7.4e-03 t_gemm=7.2e-03 t_reduction=1.8e-03 tot=1.6e-02 -----
 renorm[inter] counter=366 t=7.4e-03 per=4.5e+01 cost=1.3e+04 flops=1.7e+06
 renorm[gemm] counter=366 i=0 t=1.3e-06 per=7.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=366 i=1 t=1.1e-06 per=6.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=366 i=2 t=4.3e-03 per=2.6e+01 cost=1.4e+03 flops=3.3e+05
 renorm[gemm] counter=366 i=3 t=1.1e-03 per=6.7e+00 cost=4.0e+03 flops=3.6e+06
 renorm[gemm] counter=366 i=4 t=1.3e-06 per=7.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=366 i=5 t=1.4e-06 per=8.8e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=366 i=6 t=1.8e-03 per=1.1e+01 cost=6.2e+03 flops=3.4e+06
 renorm[gemm] counter=366 total t=7.2e-03 per=4.4e+01 cost=1.2e+04 flops=1.6e+06
 renorm[red] counter=366 t=1.8e-03 per=1.1e+01 cost=4.1e+03 flops=2.3e+06
----- TIMING FOR renorm_tot : t_inter=2.0e-01 t_gemm=7.0e-01 t_reduction=3.1e-01 tot=1.2e+00 -----
 renorm_tot[inter] counter=366 t=2.0e-01 per=1.7e+01 cost=7.9e+05 flops=3.9e+06
 renorm_tot[gemm] counter=366 i=0 t=4.4e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=366 i=1 t=3.8e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=366 i=2 t=1.2e-01 per=9.5e+00 cost=4.8e+04 flops=4.2e+05
 renorm_tot[gemm] counter=366 i=3 t=1.0e-01 per=8.4e+00 cost=1.7e+05 flops=1.7e+06
 renorm_tot[gemm] counter=366 i=4 t=1.3e-01 per=1.0e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=366 i=5 t=1.3e-01 per=1.0e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=366 i=6 t=2.3e-01 per=1.9e+01 cost=4.8e+05 flops=2.1e+06
 renorm_tot[gemm] counter=366 total t=7.0e-01 per=5.8e+01 cost=8.8e+05 flops=1.3e+06
 renorm_tot[red] counter=366 t=3.1e-01 per=2.5e+01 cost=2.7e+05 flops=8.9e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.694e-05 (optmp,oper)=8.196e-08,1.306e-05
rank=0 GPUmem(GB): used=2.716e-05 (optmp,oper,site,rinter)=8.196e-08,1.306e-05,2.161e-07,3.576e-07
rank=0 GPUmem(GB): used=3.432e-05 (optmp,oper,site,rinter,batch)=8.196e-08,1.306e-05,2.161e-07,3.576e-07,7.167e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.281e-01 S T(prep/alloc/comp/red/dealloc)=1.417e-03,2.032e-03,9.531e-02,3.069e-02,1.811e-05 -----
----- TIMING FOR oper_renorm_opS : 1.281e-01 S rank=0 -----
qops.to_cpu: size(tot)=298:2.274e-03MB:2.220e-06GB T(to_cpu)=5.194e-05S speed=4.275e-02GB/S
check ||H-H.dagger||=3.202e-15 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.186 S rank=0 -----
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=2.575e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=0.000e+00 change=-1.158e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.007e+00 pageheap_free=7.629e-06 change=-3.755e-06 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 6.880e-01 S #####
 T(local opt: fetch) = 9.907e-03 S  per = 1.44  per(accum) = 1.44
 T(local opt: hdiag) = 8.365e-02 S  per = 12.2  per(accum) = 13.6
 T(local opt: dvdsn) = 4.049e-01 S  per = 58.9  per(accum) = 72.5
 T(local opt: decim) = 1.156e-03 S  per = 0.168  per(accum) = 72.6
 T(local opt: guess) = 6.275e-04 S  per = 0.0912  per(accum) = 72.7
 T(local opt: renrm) = 1.875e-01 S  per = 27.3  per(accum) = 100
 T(local opt: save ) = 2.140e-04 S  per = 0.0311  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.049e-01 S  T(sum) = 4.047e-01 S  per = 9.994e+01
 T(local opt: preprocess                  ) = 2.412e-03 S  per = 0.596  per(accum) = 0.596
 T(local opt: symbolic_formulae           ) = 1.370e-03 S  per = 0.339  per(accum) = 0.935
 T(local opt: hintermediate init          ) = 9.556e-05 S  per = 0.0236  per(accum) = 0.958
 T(local opt: preprocess_hformulae_Hxlist ) = 3.618e-02 S  per = 8.94  per(accum) = 9.9
 T(local opt: hmmtasks init               ) = 1.323e-02 S  per = 3.27  per(accum) = 13.2
 T(local opt: initial guess for dvdson    ) = 7.725e-04 S  per = 0.191  per(accum) = 13.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.027e-01 S  per = 74.8  per(accum) = 88.2
 T(local opt: dvdson [cpu-gpu]            ) = 1.221e-02 S  per = 3.02  per(accum) = 91.2
 T(local opt: dvdson [nccl]               ) = 3.530e-02 S  per = 8.72  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 1.648e-06 S  per = 0.000407  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.334e-04 S  per = 0.107  per(accum) = 100
Detailed decomposition of T(renrm) = 1.875e-01 S  T(sum) = 1.875e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.852e-04 S  per = 0.152  per(accum) = 0.152
 T(local opt: qops init                    ) = 9.997e-04 S  per = 0.533  per(accum) = 0.685
 T(local opt: symbolic_formulae_renorm     ) = 7.591e-04 S  per = 0.405  per(accum) = 1.09
 T(local opt: allocate qops on gpu         ) = 5.275e-05 S  per = 0.0281  per(accum) = 1.12
 T(local opt: site memcpy cpu2gpu          ) = 2.265e-04 S  per = 0.121  per(accum) = 1.24
 T(local opt: rintermediate init           ) = 2.482e-03 S  per = 1.32  per(accum) = 2.56
 T(local opt: preprocess_formulae_Rlist2   ) = 1.019e-02 S  per = 5.44  per(accum) = 8
 T(local opt: rmmtasks init                ) = 5.066e-03 S  per =  2.7  per(accum) = 10.7
 T(local opt: qops memset on cpu           ) = 2.900e-08 S  per = 1.55e-05  per(accum) = 10.7
 T(local opt: preprocess_renorm_batchGPU   ) = 1.661e-02 S  per = 8.86  per(accum) = 19.6
 T(local opt: deallocate cpu and gpu memory) = 5.160e-05 S  per = 0.0275  per(accum) = 19.6
 T(local opt: construct opS [ifdists=true] ) = 1.281e-01 S  per = 68.3  per(accum) = 87.9
 T(local opt: reduction of opS & opH [nccl]) = 2.087e-02 S  per = 11.1  per(accum) = 99
 T(local opt: qops memcpy gpu2cpu          ) = 6.368e-05 S  per = 0.034  per(accum) = 99.1
 T(local opt: reduction of opS & opH [mpi] ) = 5.197e-05 S  per = 0.0277  per(accum) = 99.1
 T(local opt: qops_pool join and erase     ) = 1.683e-03 S  per = 0.898  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.625e-06 S  per = 0.00407  per(accum) = 100
##### sweep opt: 4.562e+01 S #####
 T(sweep opt: fetch) = 3.928e-01 S  per = 0.861  per(accum) = 0.861
 T(sweep opt: hdiag) = 9.162e+00 S  per = 20.1  per(accum) = 20.9
 T(sweep opt: dvdsn) = 1.858e+01 S  per = 40.7  per(accum) = 61.7
 T(sweep opt: decim) = 4.953e-02 S  per = 0.109  per(accum) = 61.8
 T(sweep opt: guess) = 3.172e-02 S  per = 0.0695  per(accum) = 61.9
 T(sweep opt: renrm) = 1.740e+01 S  per = 38.1  per(accum) = 100
 T(sweep opt: save ) = 7.773e-03 S  per = 0.017  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.858e+01 S  T(sum) = 1.856e+01 S  per = 9.988e+01
 T(sweep opt: preprocess                  ) = 1.683e-01 S  per = 0.907  per(accum) = 0.907
 T(sweep opt: symbolic_formulae           ) = 1.188e-01 S  per = 0.64  per(accum) = 1.55
 T(sweep opt: hintermediate init          ) = 6.545e-03 S  per = 0.0353  per(accum) = 1.58
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.589e+00 S  per = 30.1  per(accum) = 31.7
 T(sweep opt: hmmtasks init               ) = 2.490e+00 S  per = 13.4  per(accum) = 45.1
 T(sweep opt: initial guess for dvdson    ) = 4.791e-02 S  per = 0.258  per(accum) = 45.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 8.172e+00 S  per =   44  per(accum) = 89.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.799e-01 S  per = 2.05  per(accum) = 91.4
 T(sweep opt: dvdson [nccl]               ) = 1.523e+00 S  per = 8.21  per(accum) = 99.6
 T(sweep opt: dvdson [mpi]                ) = 1.859e-04 S  per = 0.001  per(accum) = 99.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.623e-02 S  per = 0.357  per(accum) = 100
Detailed decomposition of T(renrm) = 1.740e+01 S  T(sum) = 1.740e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.950e-03 S  per = 0.0572  per(accum) = 0.0572
 T(sweep opt: qops init                    ) = 8.081e-02 S  per = 0.465  per(accum) = 0.522
 T(sweep opt: symbolic_formulae_renorm     ) = 3.706e-02 S  per = 0.213  per(accum) = 0.735
 T(sweep opt: allocate qops on gpu         ) = 2.315e-03 S  per = 0.0133  per(accum) = 0.748
 T(sweep opt: site memcpy cpu2gpu          ) = 4.104e-02 S  per = 0.236  per(accum) = 0.984
 T(sweep opt: rintermediate init           ) = 7.527e-02 S  per = 0.433  per(accum) = 1.42
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.575e-01 S  per =  3.2  per(accum) = 4.62
 T(sweep opt: rmmtasks init                ) = 2.693e-01 S  per = 1.55  per(accum) = 6.17
 T(sweep opt: qops memset on cpu           ) = 1.147e-06 S  per = 6.59e-06  per(accum) = 6.17
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.219e+00 S  per = 7.01  per(accum) = 13.2
 T(sweep opt: deallocate cpu and gpu memory) = 2.353e-03 S  per = 0.0135  per(accum) = 13.2
 T(sweep opt: construct opS [ifdists=true] ) = 1.466e+01 S  per = 84.3  per(accum) = 97.5
 T(sweep opt: reduction of opS & opH [nccl]) = 1.635e-01 S  per = 0.94  per(accum) = 98.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.136e-03 S  per = 0.018  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.108e-03 S  per = 0.0121  per(accum) = 98.5
 T(sweep opt: qops_pool join and erase     ) = 6.996e-02 S  per = 0.402  per(accum) = 98.9
 T(sweep opt: conversion from opAB to opPQ ) = 1.990e-01 S  per = 1.14  per(accum) = 100
##### global opt: 4.562e+01 S #####
 T(global opt: fetch) = 3.928e-01 S  per = 0.861  per(accum) = 0.861
 T(global opt: hdiag) = 9.162e+00 S  per = 20.1  per(accum) = 20.9
 T(global opt: dvdsn) = 1.858e+01 S  per = 40.7  per(accum) = 61.7
 T(global opt: decim) = 4.953e-02 S  per = 0.109  per(accum) = 61.8
 T(global opt: guess) = 3.172e-02 S  per = 0.0695  per(accum) = 61.9
 T(global opt: renrm) = 1.740e+01 S  per = 38.1  per(accum) = 100
 T(global opt: save ) = 7.773e-03 S  per = 0.017  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.858e+01 S  T(sum) = 1.856e+01 S  per = 9.988e+01
 T(global opt: preprocess                  ) = 1.683e-01 S  per = 0.907  per(accum) = 0.907
 T(global opt: symbolic_formulae           ) = 1.188e-01 S  per = 0.64  per(accum) = 1.55
 T(global opt: hintermediate init          ) = 6.545e-03 S  per = 0.0353  per(accum) = 1.58
 T(global opt: preprocess_hformulae_Hxlist ) = 5.589e+00 S  per = 30.1  per(accum) = 31.7
 T(global opt: hmmtasks init               ) = 2.490e+00 S  per = 13.4  per(accum) = 45.1
 T(global opt: initial guess for dvdson    ) = 4.791e-02 S  per = 0.258  per(accum) = 45.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 8.172e+00 S  per =   44  per(accum) = 89.4
 T(global opt: dvdson [cpu-gpu]            ) = 3.799e-01 S  per = 2.05  per(accum) = 91.4
 T(global opt: dvdson [nccl]               ) = 1.523e+00 S  per = 8.21  per(accum) = 99.6
 T(global opt: dvdson [mpi]                ) = 1.859e-04 S  per = 0.001  per(accum) = 99.6
 T(global opt: dvdson [rest part(linalg)]  ) = 6.623e-02 S  per = 0.357  per(accum) = 100
Detailed decomposition of T(renrm) = 1.740e+01 S  T(sum) = 1.740e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.950e-03 S  per = 0.0572  per(accum) = 0.0572
 T(global opt: qops init                    ) = 8.081e-02 S  per = 0.465  per(accum) = 0.522
 T(global opt: symbolic_formulae_renorm     ) = 3.706e-02 S  per = 0.213  per(accum) = 0.735
 T(global opt: allocate qops on gpu         ) = 2.315e-03 S  per = 0.0133  per(accum) = 0.748
 T(global opt: site memcpy cpu2gpu          ) = 4.104e-02 S  per = 0.236  per(accum) = 0.984
 T(global opt: rintermediate init           ) = 7.527e-02 S  per = 0.433  per(accum) = 1.42
 T(global opt: preprocess_formulae_Rlist2   ) = 5.575e-01 S  per =  3.2  per(accum) = 4.62
 T(global opt: rmmtasks init                ) = 2.693e-01 S  per = 1.55  per(accum) = 6.17
 T(global opt: qops memset on cpu           ) = 1.147e-06 S  per = 6.59e-06  per(accum) = 6.17
 T(global opt: preprocess_renorm_batchGPU   ) = 1.219e+00 S  per = 7.01  per(accum) = 13.2
 T(global opt: deallocate cpu and gpu memory) = 2.353e-03 S  per = 0.0135  per(accum) = 13.2
 T(global opt: construct opS [ifdists=true] ) = 1.466e+01 S  per = 84.3  per(accum) = 97.5
 T(global opt: reduction of opS & opH [nccl]) = 1.635e-01 S  per = 0.94  per(accum) = 98.4
 T(global opt: qops memcpy gpu2cpu          ) = 3.136e-03 S  per = 0.018  per(accum) = 98.4
 T(global opt: reduction of opS & opH [mpi] ) = 2.108e-03 S  per = 0.0121  per(accum) = 98.5
 T(global opt: qops_pool join and erase     ) = 6.996e-02 S  per = 0.402  per(accum) = 98.9
 T(global opt: conversion from opAB to opPQ ) = 1.990e-01 S  per = 1.14  per(accum) = 100
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-6.915e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 

isweep=0 ibond=33/seqsize=34 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=20 mem=672:5.127e-03MB:5.007e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=11:8.392e-05MB:8.196e-08GB
total mem of comb=684:5.219e-03MB:5.096e-06GB
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,17,1,1
 suppl= 0
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:17 S:1 P:4 Q:7 
        dim(bra,ket)=7,7 size(op)=11:8.39e-05MB size(tot)=298:0.00227MB:2.22e-06GB
        per(mem): H:3.69 C:62.8 S:3.69 P:5.03 Q:24.8 
 c1qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 c2qops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=998:0.00761MB:7.44e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 qops(tot)=3292:0.0251MB:2.45e-05GB
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=1.589e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=-7.451e-06 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 after clear_from_cpumem
wf4(diml,dimr,dimc1,dimc2)=(3,7,3,3) nnz=30:2.289e-04MB
qtensor4: wf4 own=1 _data=0x46dfa3c0
qinfo4su2: wf4 sym=(30,0) couple=0
 qbond: qrow nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qcol nsym=5 dimAll=7
 (25,1):2 (26,0):2 (26,2):1 (24,0):1 (27,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=21 nblocks=180 size=30:2.289e-04MB
### DIAG TIMING: total=3.141e-02 t1=2.676e-05, t2=7.797e-04, t3=5.349e-04, t4=9.596e-03, t5=3.524e-06, t6=2.046e-02, t7=4.740e-06
duration_diagGPU:3.143e-02
duration_diagreduce:4.900e-08
duration_diagtransform:3.810e-07
----- TIMING FOR symbolic_formulae_twodot with size=111 : 1.158e-03 S -----
rank=0 GPUmem(GB): used=2.453e-05 (oper)=2.453e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=111
 no. of hintermediate operators=12
 no. of coefficients=204:1.556e-03MB:1.520e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.052e-05 S -----
rank=0 GPUmem(GB): used=2.605e-05 (oper,hinter)=2.453e-05,1.520e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.640e-02 S size(H_formulae)=111 size(Hxlst2)=21 T(Hmu/Hxlist)=2.786e-04,3.612e-02 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.679e-02 S size(H_formulae)=111 size(Hxlst)=2536 -----
rank=0 GPUmem(GB): used=2.605e-05 avail=6.231e+00 total=6.231e+00 dvdson[need]=4.470e-07 batch[need]=1.701e-04 blksize=2 blksize0=4 batchsize=2536
rank=0 GPUmem(GB): used=1.965e-04 (oper,hinter,dvdson,batch)=2.453e-05,1.520e-06,4.470e-07,1.701e-04
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=30 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.176e-02,7.416e-03,2.986e-02,1.258e-02,6.162e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.085e-03 speed=2.144e-04GB/S T(nccl)=9.673e-03 speed=4.622e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=192 t=7.4e-03 per=1.5e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=192 i=0 t=1.3e-06 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=2 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=4 t=7.5e-03 per=1.5e+01 cost=4.7e+03 flops=6.2e+05
 sigma[gemm] counter=192 i=5 t=7.5e-03 per=1.5e+01 cost=4.7e+03 flops=6.2e+05
 sigma[gemm] counter=192 i=6 t=7.4e-03 per=1.5e+01 cost=2.3e+03 flops=3.1e+05
 sigma[gemm] counter=192 i=7 t=7.4e-03 per=1.5e+01 cost=2.5e+03 flops=3.4e+05
 sigma[gemm] counter=192 total t=3.0e-02 per=6.0e+01 cost=1.4e+04 flops=4.7e+05
 sigma[red] counter=192 t=1.3e-02 per=2.5e+01 cost=7.3e+03 flops=5.8e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=4.8e+00 t_reduction=2.2e+00 tot=8.2e+00 -----
 sigma_tot[inter] counter=192 t=1.2e+00 per=1.5e+01 cost=6.8e+07 flops=5.7e+07
 sigma_tot[gemm] counter=192 i=0 t=2.6e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=1 t=2.3e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=2 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=3 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=4 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.4e+06
 sigma_tot[gemm] counter=192 i=5 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.4e+06
 sigma_tot[gemm] counter=192 i=6 t=1.2e+00 per=1.5e+01 cost=7.9e+06 flops=6.6e+06
 sigma_tot[gemm] counter=192 i=7 t=1.2e+00 per=1.5e+01 cost=8.0e+06 flops=6.7e+06
 sigma_tot[gemm] counter=192 total t=4.8e+00 per=5.9e+01 cost=3.4e+07 flops=7.0e+06
 sigma_tot[red] counter=192 t=2.2e+00 per=2.6e+01 cost=1.1e+07 flops=5.1e+06
T(sub)=9.9e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,4.1e-06,2.2e-06,8.6e-07,2.4e-07
settings: ndim=30 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.339584904797 -1.116e+03  1.897e-02    1     1  6.187e-02 6.187e-02 6.184e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.069e-03,7.399e-03,2.979e-02,1.270e-02,5.696e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.157e-03 speed=2.072e-04GB/S T(nccl)=4.912e-03 speed=9.102e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=193 t=7.4e-03 per=1.5e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=193 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=4 t=7.4e-03 per=1.5e+01 cost=4.7e+03 flops=6.4e+05
 sigma[gemm] counter=193 i=5 t=7.4e-03 per=1.5e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=193 i=6 t=7.5e-03 per=1.5e+01 cost=2.3e+03 flops=3.0e+05
 sigma[gemm] counter=193 i=7 t=7.5e-03 per=1.5e+01 cost=2.5e+03 flops=3.3e+05
 sigma[gemm] counter=193 total t=3.0e-02 per=6.0e+01 cost=1.4e+04 flops=4.7e+05
 sigma[red] counter=193 t=1.3e-02 per=2.5e+01 cost=7.3e+03 flops=5.8e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=4.9e+00 t_reduction=2.2e+00 tot=8.2e+00 -----
 sigma_tot[inter] counter=193 t=1.2e+00 per=1.5e+01 cost=6.8e+07 flops=5.7e+07
 sigma_tot[gemm] counter=193 i=0 t=2.6e-04 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=1 t=2.3e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=2 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=3 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=4 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.4e+06
 sigma_tot[gemm] counter=193 i=5 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.3e+06
 sigma_tot[gemm] counter=193 i=6 t=1.2e+00 per=1.5e+01 cost=7.9e+06 flops=6.6e+06
 sigma_tot[gemm] counter=193 i=7 t=1.2e+00 per=1.5e+01 cost=8.0e+06 flops=6.7e+06
 sigma_tot[gemm] counter=193 total t=4.9e+00 per=5.9e+01 cost=3.4e+07 flops=7.0e+06
 sigma_tot[red] counter=193 t=2.2e+00 per=2.6e+01 cost=1.1e+07 flops=5.1e+06
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.0e-05,3.7e-06,9.7e-07,2.4e-07
    2   0 -    -116.341091618675 -1.507e-03  6.253e-03    2     2  1.191e-01 5.956e-02 5.949e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.149e-03,7.385e-03,2.969e-02,1.269e-02,5.892e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.192e-03 speed=2.039e-04GB/S T(nccl)=6.957e-03 speed=6.426e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=194 t=7.4e-03 per=1.5e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=194 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=3 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=4 t=7.4e-03 per=1.5e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=194 i=5 t=7.4e-03 per=1.5e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=194 i=6 t=7.5e-03 per=1.5e+01 cost=2.3e+03 flops=3.1e+05
 sigma[gemm] counter=194 i=7 t=7.5e-03 per=1.5e+01 cost=2.5e+03 flops=3.4e+05
 sigma[gemm] counter=194 total t=3.0e-02 per=6.0e+01 cost=1.4e+04 flops=4.8e+05
 sigma[red] counter=194 t=1.3e-02 per=2.6e+01 cost=7.3e+03 flops=5.8e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=4.9e+00 t_reduction=2.2e+00 tot=8.3e+00 -----
 sigma_tot[inter] counter=194 t=1.2e+00 per=1.5e+01 cost=6.8e+07 flops=5.6e+07
 sigma_tot[gemm] counter=194 i=0 t=2.6e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=1 t=2.3e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=2 t=2.3e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=3 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=4 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.3e+06
 sigma_tot[gemm] counter=194 i=5 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.3e+06
 sigma_tot[gemm] counter=194 i=6 t=1.2e+00 per=1.5e+01 cost=7.9e+06 flops=6.5e+06
 sigma_tot[gemm] counter=194 i=7 t=1.2e+00 per=1.5e+01 cost=8.0e+06 flops=6.6e+06
 sigma_tot[gemm] counter=194 total t=4.9e+00 per=5.9e+01 cost=3.4e+07 flops=6.9e+06
 sigma_tot[red] counter=194 t=2.2e+00 per=2.6e+01 cost=1.1e+07 flops=5.0e+06
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,1.4e-05,3.3e-06,9.4e-07,2.2e-07
    3   0 -    -116.341149150258 -5.753e-05  7.802e-04    3     3  1.784e-01 5.946e-02 5.939e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.715e-03,7.462e-03,3.001e-02,1.264e-02,5.883e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.131e-03 speed=2.098e-04GB/S T(nccl)=6.584e-03 speed=6.790e-05GB/S
----- TIMING FOR sigma : t_inter=7.5e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=195 t=7.5e-03 per=1.5e+01 cost=1.4e+04 flops=1.8e+06
 sigma[gemm] counter=195 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=2 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=3 t=1.2e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=4 t=7.5e-03 per=1.5e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=195 i=5 t=7.4e-03 per=1.5e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=195 i=6 t=7.6e-03 per=1.5e+01 cost=2.3e+03 flops=3.0e+05
 sigma[gemm] counter=195 i=7 t=7.5e-03 per=1.5e+01 cost=2.5e+03 flops=3.3e+05
 sigma[gemm] counter=195 total t=3.0e-02 per=6.0e+01 cost=1.4e+04 flops=4.7e+05
 sigma[red] counter=195 t=1.3e-02 per=2.5e+01 cost=7.3e+03 flops=5.8e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=4.9e+00 t_reduction=2.2e+00 tot=8.3e+00 -----
 sigma_tot[inter] counter=195 t=1.2e+00 per=1.5e+01 cost=6.8e+07 flops=5.6e+07
 sigma_tot[gemm] counter=195 i=0 t=2.6e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=1 t=2.3e-04 per=2.8e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=2 t=2.3e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=3 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=4 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.3e+06
 sigma_tot[gemm] counter=195 i=5 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.3e+06
 sigma_tot[gemm] counter=195 i=6 t=1.2e+00 per=1.5e+01 cost=7.9e+06 flops=6.5e+06
 sigma_tot[gemm] counter=195 i=7 t=1.2e+00 per=1.5e+01 cost=8.0e+06 flops=6.6e+06
 sigma_tot[gemm] counter=195 total t=4.9e+00 per=5.9e+01 cost=3.4e+07 flops=6.9e+06
 sigma_tot[red] counter=195 t=2.2e+00 per=2.6e+01 cost=1.1e+07 flops=5.0e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=6.8e-06,1.3e-05,3.3e-06,9.8e-07,2.3e-07
    4   0 -    -116.341151725357 -2.575e-06  2.883e-04    3     4  2.375e-01 5.938e-02 5.930e-02
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.710e-03,7.397e-03,2.996e-02,1.291e-02,5.898e-02
 analyze_tgpu[Hx]: ndim=30:2.235e-07GB T(cpu-gpu)=2.170e-03 speed=2.060e-04GB/S T(nccl)=6.541e-03 speed=6.835e-05GB/S
----- TIMING FOR sigma : t_inter=7.4e-03 t_gemm=3.0e-02 t_reduction=1.3e-02 tot=5.0e-02 -----
 sigma[inter] counter=196 t=7.4e-03 per=1.5e+01 cost=1.4e+04 flops=1.9e+06
 sigma[gemm] counter=196 i=0 t=1.3e-06 per=2.6e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=1 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=2 t=1.1e-06 per=2.3e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=3 t=1.1e-06 per=2.2e-03 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=4 t=7.6e-03 per=1.5e+01 cost=4.7e+03 flops=6.2e+05
 sigma[gemm] counter=196 i=5 t=7.5e-03 per=1.5e+01 cost=4.7e+03 flops=6.3e+05
 sigma[gemm] counter=196 i=6 t=7.4e-03 per=1.5e+01 cost=2.3e+03 flops=3.1e+05
 sigma[gemm] counter=196 i=7 t=7.5e-03 per=1.5e+01 cost=2.5e+03 flops=3.4e+05
 sigma[gemm] counter=196 total t=3.0e-02 per=6.0e+01 cost=1.4e+04 flops=4.7e+05
 sigma[red] counter=196 t=1.3e-02 per=2.6e+01 cost=7.3e+03 flops=5.7e+05
----- TIMING FOR sigma_tot : t_inter=1.2e+00 t_gemm=4.9e+00 t_reduction=2.2e+00 tot=8.4e+00 -----
 sigma_tot[inter] counter=196 t=1.2e+00 per=1.5e+01 cost=6.8e+07 flops=5.6e+07
 sigma_tot[gemm] counter=196 i=0 t=2.6e-04 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=1 t=2.3e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=2 t=2.3e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=3 t=2.2e-04 per=2.7e-03 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=4 t=1.2e+00 per=1.5e+01 cost=9.0e+06 flops=7.2e+06
 sigma_tot[gemm] counter=196 i=5 t=1.3e+00 per=1.5e+01 cost=9.0e+06 flops=7.2e+06
 sigma_tot[gemm] counter=196 i=6 t=1.2e+00 per=1.5e+01 cost=7.9e+06 flops=6.4e+06
 sigma_tot[gemm] counter=196 i=7 t=1.2e+00 per=1.5e+01 cost=8.0e+06 flops=6.6e+06
 sigma_tot[gemm] counter=196 total t=4.9e+00 per=5.9e+01 cost=3.4e+07 flops=6.9e+06
 sigma_tot[red] counter=196 t=2.2e+00 per=2.6e+01 cost=1.1e+07 flops=5.0e+06
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.3e-05,3.2e-06,9.6e-07,2.0e-07
    5   0 +    -116.341151977225 -2.519e-07  6.663e-05    3     5  2.968e-01 5.935e-02 5.927e-02
TIMING FOR Davidson : 2.968e-01  T(cal/comm/rest)=2.964e-01,1.422e-06,4.174e-04
decomposed t_rest=4.174e-04
 T(sub)    =9.707e-05 per=2.326e+01
 T(precond)=3.334e-05 per=7.989e+00
 T(ortho)  =9.204e-06 per=2.205e+00
 T(xcopy)  =7.380e-07 per=1.768e-01
 T(xnrm2)  =2.161e-06 per=5.177e-01
 T(other)  =2.749e-04 per=6.586e+01
optimized energies: isweep=0 ibond=33 dots=2 e[0]=-116.341151977225 nmvp=5
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=7.346e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
ctns::twodot_renorm superblock=c2r (rdm_svd,svd_iop,dbranch,dcut,iftrunc,noise)=1.5e+00,13,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond33.txt
 qbond: qsuper nsym=9 dimAll=25
 (25,1):3 (26,0):5 (26,2):3 (24,0):1 (27,1):6 (28,0):3 (28,2):2 (29,1):1 (27,3):1
timing for divide=4.6e-05
timing for compute=6.5e-05
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(su2): 1.3e-04 S T(divide/compute[cpu/gpu/rest]/collect)=4.6e-05,5.7e-05,0.0e+00,8.7e-06,1.5e-05 -----
decimation summary: 25->8 dwt=+0.000e+00 SvN=5.630e-01
 qbond: qkept nsym=5 dimAll=8
 (28,0):3 (27,1):2 (26,0):1 (28,2):1 (29,1):1
----- TIMING for decimation_row(nkr): 4.703e-04 S T(decim/select/formRot)=2.171e-04,1.842e-04,6.901e-05 -----
----- TIMING FOR twodot_decimation: 1.009e-03 S T(wf/decim)=4.624e-04,5.470e-04 -----
ctns::oper_renorm coord=(2,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:18 S:1 P:1 Q:4 
        dim(bra,ket)=8,8 size(op)=16:1.221e-04MB size(tot)=343:2.617e-03MB:2.556e-06GB
        per(mem): H:4.66 C:73.5 S:4.08 P:1.46 Q:16.3 
rank=0 CPUmem(GB): used=1.008e+00 pageheap_free=0.000e+00 change=5.293e-05 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=24 : 5.080e-04 S -----
rank=0 GPUmem(GB): used=1.373e-05 (oper)=1.221e-05
rank=0 GPUmem(GB): used=1.395e-05 (oper,site)=1.221e-05,2.161e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=24
 no. of rintermediate operators=9
 no. of coefficients=153:1.167e-03MB:1.140e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.457e-03 S -----
rank=0 GPUmem(GB): used=1.509e-05 (oper,site,rinter)=1.221e-05,2.161e-07,1.140e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 5.947e-03 S size(rtasks)=24 size(Rlst2)=25 T(Rmu/Rlist)=1.190e-04,5.828e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.070e-03 S size(rtasks)=24 size(Rlst)=571 -----
rank=0 GPUmem(GB): used=1.509e-05 avail=6.231e+00 total=6.231e+00 batch[need]=9.785e-05 blksize=9 blksize0=4 batchsize=571
rank=0 GPUmem(GB): used=1.129e-04 (oper,site,rinter,batch)=1.221e-05,2.161e-07,1.140e-06,9.785e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.192e-03,2.259e-02,1.002e-02
----- TIMING FOR renorm : t_inter=7.2e-03 t_gemm=2.3e-02 t_reduction=1.0e-02 tot=4.0e-02 -----
 renorm[inter] counter=370 t=7.2e-03 per=1.8e+01 cost=4.5e+03 flops=6.3e+05
 renorm[gemm] counter=370 i=0 t=1.3e-06 per=3.2e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=370 i=1 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=370 i=2 t=7.5e-03 per=1.9e+01 cost=1.0e+03 flops=1.3e+05
 renorm[gemm] counter=370 i=3 t=7.5e-03 per=1.9e+01 cost=2.7e+03 flops=3.6e+05
 renorm[gemm] counter=370 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=370 i=5 t=1.2e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=370 i=6 t=7.6e-03 per=1.9e+01 cost=5.2e+03 flops=6.9e+05
 renorm[gemm] counter=370 total t=2.3e-02 per=5.7e+01 cost=8.9e+03 flops=4.0e+05
 renorm[red] counter=370 t=1.0e-02 per=2.5e+01 cost=3.7e+03 flops=3.7e+05
----- TIMING FOR renorm_tot : t_inter=2.1e-01 t_gemm=7.3e-01 t_reduction=3.2e-01 tot=1.3e+00 -----
 renorm_tot[inter] counter=370 t=2.1e-01 per=1.7e+01 cost=8.0e+05 flops=3.8e+06
 renorm_tot[gemm] counter=370 i=0 t=4.6e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=370 i=1 t=3.9e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=370 i=2 t=1.2e-01 per=9.8e+00 cost=4.9e+04 flops=4.0e+05
 renorm_tot[gemm] counter=370 i=3 t=1.1e-01 per=8.7e+00 cost=1.7e+05 flops=1.6e+06
 renorm_tot[gemm] counter=370 i=4 t=1.3e-01 per=1.0e+01 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=370 i=5 t=1.3e-01 per=1.0e+01 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=370 i=6 t=2.4e-01 per=1.9e+01 cost=4.8e+05 flops=2.0e+06
 renorm_tot[gemm] counter=370 total t=7.3e-01 per=5.8e+01 cost=8.9e+05 flops=1.2e+06
 renorm_tot[red] counter=370 t=3.2e-01 per=2.5e+01 cost=2.8e+05 flops=8.7e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.536e-05 (optmp,oper)=1.043e-07,1.221e-05
rank=0 GPUmem(GB): used=1.557e-05 (optmp,oper,site,rinter)=1.043e-07,1.221e-05,2.161e-07,3.800e-07
rank=0 GPUmem(GB): used=2.279e-05 (optmp,oper,site,rinter,batch)=1.043e-07,1.221e-05,2.161e-07,3.800e-07,7.220e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 7.995e-02 S T(prep/alloc/comp/red/dealloc)=9.662e-04,2.606e-03,6.981e-02,5.028e-03,2.507e-03 -----
----- TIMING FOR oper_renorm_opS : 7.999e-02 S rank=0 -----
qops.to_cpu: size(tot)=343:2.617e-03MB:2.556e-06GB T(to_cpu)=4.259e-05S speed=6.000e-02GB/S
check ||H-H.dagger||=2.606e-14 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.136 S rank=0 -----
rank=0 CPUmem(GB): used=1.009e+00 pageheap_free=0.000e+00 change=1.757e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=7.629e-05 change=-2.593e-03 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=7.629e-05 change=-3.159e-06 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
##### local opt: 5.453e-01 S #####
 T(local opt: fetch) = 1.900e-02 S  per = 3.48  per(accum) = 3.48
 T(local opt: hdiag) = 3.194e-02 S  per = 5.86  per(accum) = 9.34
 T(local opt: dvdsn) = 3.523e-01 S  per = 64.6  per(accum) = 73.9
 T(local opt: decim) = 1.098e-03 S  per = 0.201  per(accum) = 74.1
 T(local opt: guess) = 6.193e-04 S  per = 0.114  per(accum) = 74.3
 T(local opt: renrm) = 1.401e-01 S  per = 25.7  per(accum) = 100
 T(local opt: save ) = 2.128e-04 S  per = 0.039  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.523e-01 S  T(sum) = 3.520e-01 S  per = 9.993e+01
 T(local opt: preprocess                  ) = 2.579e-03 S  per = 0.733  per(accum) = 0.733
 T(local opt: symbolic_formulae           ) = 1.170e-03 S  per = 0.332  per(accum) = 1.07
 T(local opt: hintermediate init          ) = 7.768e-05 S  per = 0.0221  per(accum) = 1.09
 T(local opt: preprocess_hformulae_Hxlist ) = 3.688e-02 S  per = 10.5  per(accum) = 11.6
 T(local opt: hmmtasks init               ) = 1.376e-02 S  per = 3.91  per(accum) = 15.5
 T(local opt: initial guess for dvdson    ) = 7.898e-04 S  per = 0.224  per(accum) = 15.7
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.510e-01 S  per = 71.3  per(accum) = 87
 T(local opt: dvdson [cpu-gpu]            ) = 1.074e-02 S  per = 3.05  per(accum) = 90
 T(local opt: dvdson [nccl]               ) = 3.467e-02 S  per = 9.85  per(accum) = 99.9
 T(local opt: dvdson [mpi]                ) = 1.422e-06 S  per = 0.000404  per(accum) = 99.9
 T(local opt: dvdson [rest part(linalg)]  ) = 4.174e-04 S  per = 0.119  per(accum) = 100
Detailed decomposition of T(renrm) = 1.401e-01 S  T(sum) = 1.401e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.340e-04 S  per = 0.167  per(accum) = 0.167
 T(local opt: qops init                    ) = 8.748e-04 S  per = 0.624  per(accum) = 0.791
 T(local opt: symbolic_formulae_renorm     ) = 5.205e-04 S  per = 0.371  per(accum) = 1.16
 T(local opt: allocate qops on gpu         ) = 5.178e-05 S  per = 0.0369  per(accum) = 1.2
 T(local opt: site memcpy cpu2gpu          ) = 6.857e-04 S  per = 0.489  per(accum) = 1.69
 T(local opt: rintermediate init           ) = 2.472e-03 S  per = 1.76  per(accum) = 3.45
 T(local opt: preprocess_formulae_Rlist2   ) = 6.092e-03 S  per = 4.35  per(accum) = 7.8
 T(local opt: rmmtasks init                ) = 2.907e-03 S  per = 2.07  per(accum) = 9.87
 T(local opt: qops memset on cpu           ) = 3.000e-08 S  per = 2.14e-05  per(accum) = 9.87
 T(local opt: preprocess_renorm_batchGPU   ) = 4.001e-02 S  per = 28.5  per(accum) = 38.4
 T(local opt: deallocate cpu and gpu memory) = 3.893e-05 S  per = 0.0278  per(accum) = 38.4
 T(local opt: construct opS [ifdists=true] ) = 8.002e-02 S  per = 57.1  per(accum) = 95.5
 T(local opt: reduction of opS & opH [nccl]) = 2.428e-03 S  per = 1.73  per(accum) = 97.3
 T(local opt: qops memcpy gpu2cpu          ) = 5.231e-05 S  per = 0.0373  per(accum) = 97.3
 T(local opt: reduction of opS & opH [mpi] ) = 5.340e-05 S  per = 0.0381  per(accum) = 97.4
 T(local opt: qops_pool join and erase     ) = 3.706e-03 S  per = 2.64  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 5.593e-06 S  per = 0.00399  per(accum) = 100
##### sweep opt: 4.617e+01 S #####
 T(sweep opt: fetch) = 4.118e-01 S  per = 0.892  per(accum) = 0.892
 T(sweep opt: hdiag) = 9.194e+00 S  per = 19.9  per(accum) = 20.8
 T(sweep opt: dvdsn) = 1.894e+01 S  per =   41  per(accum) = 61.8
 T(sweep opt: decim) = 5.062e-02 S  per = 0.11  per(accum) = 61.9
 T(sweep opt: guess) = 3.234e-02 S  per = 0.0701  per(accum) = 62
 T(sweep opt: renrm) = 1.754e+01 S  per =   38  per(accum) = 100
 T(sweep opt: save ) = 7.986e-03 S  per = 0.0173  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.894e+01 S  T(sum) = 1.891e+01 S  per = 9.988e+01
 T(sweep opt: preprocess                  ) = 1.709e-01 S  per = 0.904  per(accum) = 0.904
 T(sweep opt: symbolic_formulae           ) = 1.199e-01 S  per = 0.634  per(accum) = 1.54
 T(sweep opt: hintermediate init          ) = 6.623e-03 S  per = 0.035  per(accum) = 1.57
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.626e+00 S  per = 29.7  per(accum) = 31.3
 T(sweep opt: hmmtasks init               ) = 2.504e+00 S  per = 13.2  per(accum) = 44.6
 T(sweep opt: initial guess for dvdson    ) = 4.870e-02 S  per = 0.257  per(accum) = 44.8
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 8.423e+00 S  per = 44.5  per(accum) = 89.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.906e-01 S  per = 2.07  per(accum) = 91.4
 T(sweep opt: dvdson [nccl]               ) = 1.558e+00 S  per = 8.24  per(accum) = 99.6
 T(sweep opt: dvdson [mpi]                ) = 1.873e-04 S  per = 0.00099  per(accum) = 99.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.665e-02 S  per = 0.352  per(accum) = 100
Detailed decomposition of T(renrm) = 1.754e+01 S  T(sum) = 1.754e+01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.018e-02 S  per = 0.0581  per(accum) = 0.0581
 T(sweep opt: qops init                    ) = 8.168e-02 S  per = 0.466  per(accum) = 0.524
 T(sweep opt: symbolic_formulae_renorm     ) = 3.758e-02 S  per = 0.214  per(accum) = 0.738
 T(sweep opt: allocate qops on gpu         ) = 2.366e-03 S  per = 0.0135  per(accum) = 0.752
 T(sweep opt: site memcpy cpu2gpu          ) = 4.172e-02 S  per = 0.238  per(accum) = 0.99
 T(sweep opt: rintermediate init           ) = 7.774e-02 S  per = 0.443  per(accum) = 1.43
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.636e-01 S  per = 3.21  per(accum) = 4.65
 T(sweep opt: rmmtasks init                ) = 2.722e-01 S  per = 1.55  per(accum) = 6.2
 T(sweep opt: qops memset on cpu           ) = 1.177e-06 S  per = 6.71e-06  per(accum) = 6.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.259e+00 S  per = 7.18  per(accum) = 13.4
 T(sweep opt: deallocate cpu and gpu memory) = 2.392e-03 S  per = 0.0136  per(accum) = 13.4
 T(sweep opt: construct opS [ifdists=true] ) = 1.474e+01 S  per = 84.1  per(accum) = 97.5
 T(sweep opt: reduction of opS & opH [nccl]) = 1.659e-01 S  per = 0.946  per(accum) = 98.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.188e-03 S  per = 0.0182  per(accum) = 98.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.162e-03 S  per = 0.0123  per(accum) = 98.4
 T(sweep opt: qops_pool join and erase     ) = 7.366e-02 S  per = 0.42  per(accum) = 98.9
 T(sweep opt: conversion from opAB to opPQ ) = 1.990e-01 S  per = 1.13  per(accum) = 100
##### global opt: 4.617e+01 S #####
 T(global opt: fetch) = 4.118e-01 S  per = 0.892  per(accum) = 0.892
 T(global opt: hdiag) = 9.194e+00 S  per = 19.9  per(accum) = 20.8
 T(global opt: dvdsn) = 1.894e+01 S  per =   41  per(accum) = 61.8
 T(global opt: decim) = 5.062e-02 S  per = 0.11  per(accum) = 61.9
 T(global opt: guess) = 3.234e-02 S  per = 0.0701  per(accum) = 62
 T(global opt: renrm) = 1.754e+01 S  per =   38  per(accum) = 100
 T(global opt: save ) = 7.986e-03 S  per = 0.0173  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.894e+01 S  T(sum) = 1.891e+01 S  per = 9.988e+01
 T(global opt: preprocess                  ) = 1.709e-01 S  per = 0.904  per(accum) = 0.904
 T(global opt: symbolic_formulae           ) = 1.199e-01 S  per = 0.634  per(accum) = 1.54
 T(global opt: hintermediate init          ) = 6.623e-03 S  per = 0.035  per(accum) = 1.57
 T(global opt: preprocess_hformulae_Hxlist ) = 5.626e+00 S  per = 29.7  per(accum) = 31.3
 T(global opt: hmmtasks init               ) = 2.504e+00 S  per = 13.2  per(accum) = 44.6
 T(global opt: initial guess for dvdson    ) = 4.870e-02 S  per = 0.257  per(accum) = 44.8
 T(global opt: dvdson [Hx_batchGPU]        ) = 8.423e+00 S  per = 44.5  per(accum) = 89.3
 T(global opt: dvdson [cpu-gpu]            ) = 3.906e-01 S  per = 2.07  per(accum) = 91.4
 T(global opt: dvdson [nccl]               ) = 1.558e+00 S  per = 8.24  per(accum) = 99.6
 T(global opt: dvdson [mpi]                ) = 1.873e-04 S  per = 0.00099  per(accum) = 99.6
 T(global opt: dvdson [rest part(linalg)]  ) = 6.665e-02 S  per = 0.352  per(accum) = 100
Detailed decomposition of T(renrm) = 1.754e+01 S  T(sum) = 1.754e+01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.018e-02 S  per = 0.0581  per(accum) = 0.0581
 T(global opt: qops init                    ) = 8.168e-02 S  per = 0.466  per(accum) = 0.524
 T(global opt: symbolic_formulae_renorm     ) = 3.758e-02 S  per = 0.214  per(accum) = 0.738
 T(global opt: allocate qops on gpu         ) = 2.366e-03 S  per = 0.0135  per(accum) = 0.752
 T(global opt: site memcpy cpu2gpu          ) = 4.172e-02 S  per = 0.238  per(accum) = 0.99
 T(global opt: rintermediate init           ) = 7.774e-02 S  per = 0.443  per(accum) = 1.43
 T(global opt: preprocess_formulae_Rlist2   ) = 5.636e-01 S  per = 3.21  per(accum) = 4.65
 T(global opt: rmmtasks init                ) = 2.722e-01 S  per = 1.55  per(accum) = 6.2
 T(global opt: qops memset on cpu           ) = 1.177e-06 S  per = 6.71e-06  per(accum) = 6.2
 T(global opt: preprocess_renorm_batchGPU   ) = 1.259e+00 S  per = 7.18  per(accum) = 13.4
 T(global opt: deallocate cpu and gpu memory) = 2.392e-03 S  per = 0.0136  per(accum) = 13.4
 T(global opt: construct opS [ifdists=true] ) = 1.474e+01 S  per = 84.1  per(accum) = 97.5
 T(global opt: reduction of opS & opH [nccl]) = 1.659e-01 S  per = 0.946  per(accum) = 98.4
 T(global opt: qops memcpy gpu2cpu          ) = 3.188e-03 S  per = 0.0182  per(accum) = 98.4
 T(global opt: reduction of opS & opH [mpi] ) = 2.162e-03 S  per = 0.0123  per(accum) = 98.4
 T(global opt: qops_pool join and erase     ) = 7.366e-02 S  per = 0.42  per(accum) = 98.9
 T(global opt: conversion from opAB to opPQ ) = 1.990e-01 S  per = 1.13  per(accum) = 100
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-7.247e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 

======================================================================
sweep_data::summary isweep=0 mpisize=2 maxthreads=2
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=2 dcut=10 eps=1.000e-04 noise=0.000e+00
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=2 dwt=+0.000e+00 nmvp=3 e[0]=-116.091268021088 t=0.851
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=2 dwt=+0.000e+00 nmvp=3 e[0]=-116.113157849033 t=1.077
 ibond=2 bond=(3,0)-(4,0) forward=1 deff=2 dwt=+0.000e+00 nmvp=3 e[0]=-116.120806705492 t=1.144
 ibond=3 bond=(4,0)-(5,0) forward=1 deff=6 dwt=+2.220e-16 nmvp=3 e[0]=-116.120811732020 t=1.171
 ibond=4 bond=(5,0)-(6,0) forward=1 deff=10 dwt=-2.220e-16 nmvp=3 e[0]=-116.120814666334 t=1.227
 ibond=5 bond=(6,0)-(7,0) forward=1 deff=10 dwt=+0.000e+00 nmvp=6 e[0]=-116.135724112613 t=1.506
 ibond=6 bond=(7,0)-(8,0) forward=1 deff=10 dwt=+0.000e+00 nmvp=6 e[0]=-116.155574600124 t=1.698
 ibond=7 bond=(8,0)-(9,0) forward=1 deff=10 dwt=+2.342e-05 nmvp=6 e[0]=-116.157413770085 t=2.260
 ibond=8 bond=(9,0)-(10,0) forward=1 deff=10 dwt=+3.050e-07 nmvp=6 e[0]=-116.158503554984 t=1.993
 ibond=9 bond=(10,0)-(11,0) forward=1 deff=8 dwt=+4.441e-16 nmvp=7 e[0]=-116.175373766822 t=1.586
 ibond=10 bond=(11,0)-(12,0) forward=1 deff=8 dwt=+0.000e+00 nmvp=7 e[0]=-116.191745448369 t=1.236
 ibond=11 bond=(12,0)-(13,0) forward=1 deff=8 dwt=+0.000e+00 nmvp=6 e[0]=-116.192668235368 t=1.097
 ibond=12 bond=(13,0)-(14,0) forward=1 deff=8 dwt=-2.220e-16 nmvp=9 e[0]=-116.196252217360 t=1.123
 ibond=13 bond=(14,0)-(15,0) forward=1 deff=8 dwt=-2.220e-16 nmvp=7 e[0]=-116.202945188390 t=0.946
 ibond=14 bond=(15,0)-(16,0) forward=1 deff=8 dwt=+1.110e-16 nmvp=7 e[0]=-116.232176644205 t=0.885
 ibond=15 bond=(16,0)-(17,0) forward=1 deff=8 dwt=+0.000e+00 nmvp=6 e[0]=-116.236450789429 t=0.708
 ibond=16 bond=(17,0)-(18,0) forward=1 deff=9 dwt=+0.000e+00 nmvp=6 e[0]=-116.253081474980 t=0.629
 ibond=17 bond=(17,0)-(18,0) forward=0 deff=9 dwt=+0.000e+00 nmvp=1 e[0]=-116.253081474980 t=0.853
 ibond=18 bond=(16,0)-(17,0) forward=0 deff=10 dwt=+1.680e-06 nmvp=5 e[0]=-116.253300539751 t=1.380
 ibond=19 bond=(15,0)-(16,0) forward=0 deff=10 dwt=+2.690e-04 nmvp=7 e[0]=-116.254199308306 t=1.622
 ibond=20 bond=(14,0)-(15,0) forward=0 deff=10 dwt=+2.062e-04 nmvp=7 e[0]=-116.255326334471 t=1.578
 ibond=21 bond=(13,0)-(14,0) forward=0 deff=10 dwt=+1.275e-04 nmvp=9 e[0]=-116.257952651408 t=1.749
 ibond=22 bond=(12,0)-(13,0) forward=0 deff=10 dwt=+6.920e-05 nmvp=7 e[0]=-116.263887503498 t=1.720
 ibond=23 bond=(11,0)-(12,0) forward=0 deff=10 dwt=+3.842e-04 nmvp=7 e[0]=-116.269670916126 t=1.830
 ibond=24 bond=(10,0)-(11,0) forward=0 deff=10 dwt=+1.097e-03 nmvp=8 e[0]=-116.290287880175 t=2.110
 ibond=25 bond=(9,0)-(10,0) forward=0 deff=10 dwt=+5.421e-04 nmvp=7 e[0]=-116.296905733366 t=2.313
 ibond=26 bond=(8,0)-(9,0) forward=0 deff=10 dwt=+6.052e-04 nmvp=6 e[0]=-116.298709867538 t=2.448
 ibond=27 bond=(7,0)-(8,0) forward=0 deff=10 dwt=+1.716e-03 nmvp=7 e[0]=-116.312140236756 t=1.905
 ibond=28 bond=(6,0)-(7,0) forward=0 deff=10 dwt=+2.011e-06 nmvp=5 e[0]=-116.311589429488 t=1.434
 ibond=29 bond=(5,0)-(6,0) forward=0 deff=10 dwt=+1.085e-05 nmvp=7 e[0]=-116.325899261059 t=1.458
 ibond=30 bond=(4,0)-(5,0) forward=0 deff=7 dwt=+0.000e+00 nmvp=3 e[0]=-116.325910527615 t=0.727
 ibond=31 bond=(3,0)-(4,0) forward=0 deff=8 dwt=+0.000e+00 nmvp=5 e[0]=-116.331068947934 t=0.670
 ibond=32 bond=(2,0)-(3,0) forward=0 deff=7 dwt=+0.000e+00 nmvp=6 e[0]=-116.339584904797 t=0.688
 ibond=33 bond=(1,0)-(2,0) forward=0 deff=8 dwt=+0.000e+00 nmvp=5 e[0]=-116.341151977225 t=0.545
 eav_max=-116.091268021088 [ibond=0]  dwt_min=-2.220e-16 [ibond=4]
 eav_min=-116.341151977225 [ibond=33]  dwt_max=1.716e-03 [ibond=27]
 eav_diff=0.249883956137
 sweep energies: isweep=0 dots=2 dcut=10 deff=8 dwt=+0.000e+00 e[0]=-116.341151977225
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0 mpisize=2 maxthreads=2
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.000e-04 0.000e+00 | 196 | 4.624e+01 | 4.624e+01 | 1.437e+00 5.670e+00 2.528e+00 9.635e+00 20.8
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +0.000e+00 e[0]=-116.341151977225 (0.000e+00)
======================================================================
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=7.451e-09 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep0_su2
----------------------------------------------------------------------

ctns::sweep_final_LCR2CRR: convert [LC]R => [CR]R
ctns::decimation_row ifab=0 iftrunc=1 dcut=4 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_C0R1.txt
 qbond: qsuper nsym=9 dimAll=28
 (28,0):6 (27,1):3 (26,0):1 (28,2):3 (29,1):7 (30,0):4 (30,2):2 (31,1):1 (29,3):1
timing for divide=2.489e-05
timing for compute=4.473e-05
timing for collect=1.174e-05
----- TMING FOR decimation_genbasis(su2): 8.136e-05 S T(divide/compute[cpu/gpu/rest]/collect)=2.489e-05,3.674e-05,0.000e+00,7.986e-06,1.174e-05 -----
decimation summary: 28->3 dwt=+0.000e+00 SvN=4.070e-01
 qbond: qkept nsym=3 dimAll=3
 (28,0):1 (29,1):1 (30,0):1
----- TIMING for decimation_row(nkr): 3.339e-04 S T(decim/select/formRot)=1.420e-04,1.371e-04,5.481e-05 -----

ctns::sweep_final_CR2cRR: convert [C]R => [cR]R
ctns::decimation_row ifab=0 iftrunc=1 dcut=1 nqr=6 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_cR0.txt
 qbond: qsuper nsym=6 dimAll=10
 (28,0):1 (29,1):2 (30,0):3 (31,1):2 (32,0):1 (30,2):1
timing for divide=8.566e-06
timing for compute=2.115e-05
timing for collect=7.088e-06
----- TMING FOR decimation_genbasis(su2): 3.681e-05 S T(divide/compute[cpu/gpu/rest]/collect)=8.566e-06,1.489e-05,0.000e+00,6.261e-06,7.088e-06 -----
decimation summary: 10->1 dwt=+0.000e+00 SvN=0.000e+00
 qbond: qkept nsym=1 dimAll=1
 (30,0):1
----- TIMING for decimation_row(nkr): 2.085e-04 S T(decim/select/formRot)=9.157e-05,9.754e-05,1.934e-05 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep0_su2 T(save)=7.39e-04S

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=9 maxdiff=7.077e-16 deviate=0
 idx=2 node=(17,0) Drow=10 maxdiff=8.348e-16 deviate=0
 idx=3 node=(16,0) Drow=10 maxdiff=1.112e-15 deviate=0
 idx=4 node=(15,0) Drow=10 maxdiff=1.332e-15 deviate=0
 idx=5 node=(14,0) Drow=10 maxdiff=4.644e-16 deviate=0
 idx=6 node=(13,0) Drow=10 maxdiff=9.403e-16 deviate=0
 idx=7 node=(12,0) Drow=10 maxdiff=2.036e-15 deviate=0
 idx=8 node=(11,0) Drow=10 maxdiff=1.551e-15 deviate=0
 idx=9 node=(10,0) Drow=10 maxdiff=1.532e-15 deviate=0
 idx=10 node=(9,0) Drow=10 maxdiff=7.346e-16 deviate=0
 idx=11 node=(8,0) Drow=10 maxdiff=4.966e-16 deviate=0
 idx=12 node=(7,0) Drow=10 maxdiff=6.711e-16 deviate=0
 idx=13 node=(6,0) Drow=10 maxdiff=1.301e-15 deviate=0
 idx=14 node=(5,0) Drow=7 maxdiff=4.965e-16 deviate=0
 idx=15 node=(4,0) Drow=8 maxdiff=5.043e-16 deviate=0
 idx=16 node=(3,0) Drow=7 maxdiff=4.441e-16 deviate=0
 idx=17 node=(2,0) Drow=8 maxdiff=8.188e-16 deviate=0
 idx=18 node=(1,0) Drow=3 maxdiff=2.220e-16 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=2.220e-16 deviate=0
qtensor2: wf2 own=1 _data=0x3a99a360
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x3a99a360
      1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 6.228e-03 S -----
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=20 mem=712:0.00543MB:5.3e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=716:0.00546MB:5.33e-06GB
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.270e-07 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 

ctns::oper_final - build Hmat for RCF at isweep=0

coord=(1,0)
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:18 S:1 P:1 Q:4 
        dim(bra,ket)=8,8 size(op)=16:0.000122MB size(tot)=343:0.00262MB:2.56e-06GB
        per(mem): H:4.66 C:73.5 S:4.08 P:1.46 Q:16.3 
ctns::oper_renorm coord=(1,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:19 S:0 P:0 Q:2 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=45:0.000343MB:3.35e-07GB
        per(mem): H:6.67 C:84.4 Q:8.89 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=8.189e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=22 : 2.982e-04 S -----
rank=0 GPUmem(GB): used=1.033e-05 (oper)=1.033e-05
rank=0 GPUmem(GB): used=1.045e-05 (oper,site)=1.033e-05,1.267e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=22
 no. of rintermediate operators=4
 no. of coefficients=72:5.493e-04MB:5.364e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.527e-03 S -----
rank=0 GPUmem(GB): used=1.099e-05 (oper,site,rinter)=1.033e-05,1.267e-07,5.364e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 3.232e-03 S size(rtasks)=22 size(Rlst2)=9 T(Rmu/Rlist)=7.785e-05,3.154e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.279e-03 S size(rtasks)=22 size(Rlst)=351 -----
rank=0 GPUmem(GB): used=1.099e-05 avail=6.231e+00 total=6.231e+00 batch[need]=3.400e-05 blksize=3 blksize0=6 batchsize=351
rank=0 GPUmem(GB): used=4.499e-05 (oper,site,rinter,batch)=1.033e-05,1.267e-07,5.364e-07,3.400e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.038e-03,2.243e-02,9.277e-03
----- TIMING FOR renorm : t_inter=7.0e-03 t_gemm=2.2e-02 t_reduction=9.3e-03 tot=3.9e-02 -----
 renorm[inter] counter=373 t=7.0e-03 per=1.8e+01 cost=2.5e+03 flops=3.6e+05
 renorm[gemm] counter=373 i=0 t=1.3e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=373 i=1 t=1.1e-06 per=3.0e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=373 i=2 t=7.5e-03 per=1.9e+01 cost=6.2e+02 flops=8.3e+04
 renorm[gemm] counter=373 i=3 t=7.5e-03 per=1.9e+01 cost=1.5e+03 flops=2.1e+05
 renorm[gemm] counter=373 i=4 t=1.2e-06 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=373 i=5 t=1.1e-06 per=2.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=373 i=6 t=7.5e-03 per=1.9e+01 cost=1.3e+03 flops=1.7e+05
 renorm[gemm] counter=373 total t=2.2e-02 per=5.8e+01 cost=3.4e+03 flops=1.5e+05
 renorm[red] counter=373 t=9.3e-03 per=2.4e+01 cost=7.0e+02 flops=7.6e+04
----- TIMING FOR renorm_tot : t_inter=2.2e-01 t_gemm=7.5e-01 t_reduction=3.3e-01 tot=1.3e+00 -----
 renorm_tot[inter] counter=373 t=2.2e-01 per=1.7e+01 cost=8.0e+05 flops=3.7e+06
 renorm_tot[gemm] counter=373 i=0 t=4.7e-05 per=3.6e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=373 i=1 t=4.0e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=373 i=2 t=1.3e-01 per=1.0e+01 cost=5.0e+04 flops=3.8e+05
 renorm_tot[gemm] counter=373 i=3 t=1.2e-01 per=9.0e+00 cost=1.8e+05 flops=1.5e+06
 renorm_tot[gemm] counter=373 i=4 t=1.3e-01 per=9.8e+00 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=373 i=5 t=1.3e-01 per=9.9e+00 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=373 i=6 t=2.5e-01 per=1.9e+01 cost=4.8e+05 flops=2.0e+06
 renorm_tot[gemm] counter=373 total t=7.5e-01 per=5.8e+01 cost=9.0e+05 flops=1.2e+06
 renorm_tot[red] counter=373 t=3.3e-01 per=2.5e+01 cost=2.8e+05 flops=8.5e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.088e-05 (optmp,oper)=1.490e-08,1.033e-05
rank=0 GPUmem(GB): used=1.100e-05 (optmp,oper,site,rinter)=1.490e-08,1.033e-05,1.267e-07,0.000e+00
rank=0 GPUmem(GB): used=1.142e-05 (optmp,oper,site,rinter,batch)=1.490e-08,1.033e-05,1.267e-07,0.000e+00,4.172e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.266e-03 S T(prep/alloc/comp/red/dealloc)=1.575e-04,3.345e-04,3.893e-03,2.270e-05,1.186e-05 -----
----- TIMING FOR oper_renorm_opS : 4.293e-03 S rank=0 -----
qops.to_cpu: size(tot)=45:3.433e-04MB:3.353e-07GB T(to_cpu)=3.542e-05S speed=9.465e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.103 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=1.077e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 

coord=(0,0)
 cqops: oplist=HCSABPQ nops=H:1 C:1 S:19 A:1 B:2 P:361 Q:380 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=998:7.614e-03MB:7.436e-06GB
        per(mem): H:0.301 C:0.2 S:3.81 A:0.1 B:0.401 P:19 Q:76.2 
 rqops: oplist=HCSPQ nops=H:1 C:19 S:0 P:0 Q:2 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=45:0.000343MB:3.35e-07GB
        per(mem): H:6.67 C:84.4 Q:8.89 
ctns::oper_renorm coord=(0,0) superblock=cr oplist=HCSPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=HCSPQ nops=H:1 C:20 S:0 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
        per(mem): H:100 C:0 
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=-1.442e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 
----- TIMING FOR symbolic_formulae_renorm with size=21 : 1.944e-04 S -----
rank=0 GPUmem(GB): used=7.778e-06 (oper)=7.778e-06
rank=0 GPUmem(GB): used=7.801e-06 (oper,site)=7.778e-06,2.235e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=21
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=7.801e-06 (oper,site,rinter)=7.778e-06,2.235e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 5.315e-04 S size(rtasks)=21 size(Rlst2)=1 T(Rmu/Rlist)=6.222e-05,4.693e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.473e-04 S size(rtasks)=21 size(Rlst)=56 -----
rank=0 GPUmem(GB): used=7.801e-06 avail=6.231e+00 total=6.231e+00 batch[need]=1.252e-06 blksize=1 blksize0=0 batchsize=56
rank=0 GPUmem(GB): used=9.052e-06 (oper,site,rinter,batch)=7.778e-06,2.235e-08,0.000e+00,1.252e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.573e-03,2.220e-02,9.818e-03
----- TIMING FOR renorm : t_inter=1.6e-03 t_gemm=2.2e-02 t_reduction=9.8e-03 tot=3.4e-02 -----
 renorm[inter] counter=375 t=1.6e-03 per=4.7e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=375 i=0 t=1.7e-06 per=4.9e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=375 i=1 t=1.2e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=375 i=2 t=7.4e-03 per=2.2e+01 cost=5.2e+01 flops=7.0e+03
 renorm[gemm] counter=375 i=3 t=7.4e-03 per=2.2e+01 cost=5.2e+01 flops=7.0e+03
 renorm[gemm] counter=375 i=4 t=1.2e-06 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=375 i=5 t=1.2e-06 per=3.5e-03 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=375 i=6 t=7.4e-03 per=2.2e+01 cost=1.1e+02 flops=1.5e+04
 renorm[gemm] counter=375 total t=2.2e-02 per=6.6e+01 cost=2.2e+02 flops=9.7e+03
 renorm[red] counter=375 t=9.8e-03 per=2.9e+01 cost=1.1e+02 flops=1.1e+04
----- TIMING FOR renorm_tot : t_inter=2.2e-01 t_gemm=7.7e-01 t_reduction=3.3e-01 tot=1.3e+00 -----
 renorm_tot[inter] counter=375 t=2.2e-01 per=1.7e+01 cost=8.0e+05 flops=3.6e+06
 renorm_tot[gemm] counter=375 i=0 t=4.9e-05 per=3.7e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=375 i=1 t=4.1e-05 per=3.1e-03 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=375 i=2 t=1.4e-01 per=1.0e+01 cost=5.0e+04 flops=3.6e+05
 renorm_tot[gemm] counter=375 i=3 t=1.2e-01 per=9.4e+00 cost=1.8e+05 flops=1.4e+06
 renorm_tot[gemm] counter=375 i=4 t=1.3e-01 per=9.6e+00 cost=4.7e+04 flops=3.7e+05
 renorm_tot[gemm] counter=375 i=5 t=1.3e-01 per=9.6e+00 cost=1.4e+05 flops=1.1e+06
 renorm_tot[gemm] counter=375 i=6 t=2.5e-01 per=1.9e+01 cost=4.8e+05 flops=1.9e+06
 renorm_tot[gemm] counter=375 total t=7.7e-01 per=5.8e+01 cost=9.0e+05 flops=1.2e+06
 renorm_tot[red] counter=375 t=3.3e-01 per=2.5e+01 cost=2.8e+05 flops=8.3e+05
ctns::oper_renorm_opS superblock=cr ifab=0 isym=3 ifkr=1 ifdist1=1 ifdists=1 ifnccl=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 7.7e-06 S rank=0 -----
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB T(to_cpu)=2.8e-05S speed=2.7e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.0392 S rank=0 -----
rank=0 CPUmem(GB): used=1.006e+00 pageheap_free=0.000e+00 change=2.573e-05 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 

matrix: Hmat_isweep0 size=(1,1)
     -1.163411519772e+02 

----- TIMING FOR sweep_opt: isweep=0 : 4.641e+01 S -----

----- TIMING FOR ctns::sweep_opt : 4.642e+01 S -----
rank=0 CPUmem(GB): used=1.005e+00 pageheap_free=0.000e+00 change=-8.566e-04 heap=1.076e+00 avail=4.762e+02 total=5.033e+02 

Congrats! SADMRG calculation finishes successfully. Sun Jan 12 11:08:06 2025

