
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Wed Jan  1 12:10:24 2025

GIT_HASH = 9a97ae153aaa5405988fe420a5df66f11e16fed2

mpisize = 2 maxthreads = 2

input file = input.dat

schedule::read fname = input.dat
----------------------------------------------------------------------
dtype 0
sorb 40
nelec 30
twom 0
twos 0 
integral_file moleinfo/fmole.info
scratch ./scratch

$ci
dets
0 2 4 6 8 10 12 14 16 18 20 22 24 36 38   1 3 15 17 19 21 23 25 27 29 31 33 35 37 39
end
checkms
nroots 1 
schedule
0 1.e-3
end
maxiter 1
$end

$ctns
verbose 1
qkind rNSz
maxdets 1000 #0 # keep dets as much as possible
topology_file topology/topo4
thresh_proj 1.e-10
thresh_ortho 1.e-8 #1.e-10
nroots 1 
schedule
0  1 100 1.e-4 0.0
end
maxsweep 1
alg_hvec 19
alg_hinter 2
alg_hcoper 2
alg_renorm 19
alg_rinter 2
alg_rcoper 1
task_dmrg
ifab2pq
ifdist1
ifdistc
ifnccl
#save_formulae
batchhvec 4 4 4
batchrenorm 4 4 4
alg_a2p 3
alg_b2q 3
ifoutcore
ifdists
$end

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
sorb  = 40
nelec = 30
twom  = 0
twos  = 0
integral_file = moleinfo/fmole.info
perfcomm = 0

===== params_ci::print =====
nroots = 1
no. of unique seeds = 1
0-th det: 0 1 2 3 4 6 8 10 12 14 15 16 17 18 19 20 21 22 23 24 25 27 29 31 33 35 36 37 38 39 
flip = 0
eps0 = 0.01
miniter = 0
maxiter = 1
schedule: iter eps1
0 0.001
convergence parameters
deltaE = 1e-10
checkms = 1
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 0
jroot = 0
load = 0
ci_file = ci.info
cthrd = 0.1
ifanalysis = 0
rdm = 0
init_aufbau = 0
init_seniority = 0

===== params_ctns::print =====
qkind = rNSz
topology_file = topology/topo4
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
task_oodmrg = 0
task_vmc = 0
task_expand = 0
task_tononsu2 = 0
task_prop = 
task_schmidt = 0
schmidt_file = svalues
restart_sweep = 0
ciroots = 
maxdets = 1000
thresh_proj = 1.000000e-10
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
outprec = 12
nroots = 1
guess = 1
dbranch = 0
maxsweep = 1
maxbond = -1
maxidx = -1
schedule: isweep, dots, dcut, eps, noise
0 1 100 1.000000e-04 0.000000e+00
rcfprefix = 
alg_hvec = 19
alg_hinter = 2
alg_hcoper = 2
alg_renorm = 19
alg_rinter = 2
alg_rcoper = 1
alg_rdm = 1
alg_decim = 0
alg_a2p = 3
alg_b2q = 3
notrunc = 0
ifoutcore = 1
ifab2pq = 1
ifdist1 = 1
ifdistc = 1
ifdists = 1
save_formulae = 0
sort_formulae = 0
save_mmtask = 0
batchhvec = 4 4 4
batchrenorm = 4 4 4
batchmem = 1.000000e+01
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
precond = 1
rcanon_file = 
rcanon2_file = 
iomode = 0
async_fetch = 0
async_save = 0
async_remove = 0
ifnccl = 1
iroot = 0
jroot = 0
nsample = 5000
nprt = 10
pthrd = -1.000000e-02
thresh_cabs = 1.100000e+00
detbasis = 0
tosu2 = 0
thresh_tosu2 = 1.000000e-08
singlet = 0
diagcheck = 0
savebin = 0
fromnosym = 0
oodmrg parameters:
 iprt=1
 maxiter=10
 dfac=2
 macroiter=5
 microiter=50
 alpha=5.000000e-01
 thrdopt=1.000000e-04
 thrdloc=1.000000e-06
 thrddwt=1.000000e+00
 thrdeps=1.000000e-08
 nptloc=2.000000e+01
 acceptall=0
 unrestricted=0
 urot=
inputconf = 
saveconfs = 
loadconfs = 
debug_rdm = 0
alg_mrpt2 = 0
nv2 = 0
nc2 = 0
mpisize_debug = 1

io::create_scratch scratch=./scratch

gpu_init
rank=0 deviceCount=8
CUDA Runtime version: 11070
CUBLAS version: 111003
nccl init: rank=0 size=2
nccl init: rank=1 size=2

mem_check: ifgpu=1
rank=0 CPUmem(GB): avail=4.806e+02 total=5.034e+02
rank=1 CPUmem(GB): avail=4.806e+02 total=5.034e+02
min=4.806e+02 max=4.806e+02 diff=0.000e+00
rank=0 GPUmem(GB): avail=3.842e+01 total=3.959e+01
rank=0 GPUmem(GB): avail=3.842e+01 total=3.959e+01
min=3.842e+01 max=3.842e+01 diff=0.000e+00
rank=0 CPUmem(GB): used=1.334e+00 pageheap_free=4.649e-02 change=1.334e+00 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 

ctns::topology::read fname=topology/topo4
0
1
2
3
4
16
17
18
19
5
6
7
8
9
10
11
12
13
14
15

ctns::topology::print ifmps=1 ntotal=20 nphysical=20 nbackbone=20
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
 i=5 : 16 
 i=6 : 17 
 i=7 : 18 
 i=8 : 19 
 i=9 : 5 
 i=10 : 6 
 i=11 : 7 
 i=12 : 8 
 i=13 : 9 
 i=14 : 10 
 i=15 : 11 
 i=16 : 12 
 i=17 : 13 
 i=18 : 14 
 i=19 : 15 
rcoord:
 idx=0 coord=(19,0) rindex=0 node: lindex=19 porb=15 type=0 center=(-1,-1) left=(18,0) right=(-2,-2)
 idx=1 coord=(18,0) rindex=1 node: lindex=18 porb=14 type=1 center=(-1,-1) left=(17,0) right=(19,0)
 idx=2 coord=(17,0) rindex=2 node: lindex=17 porb=13 type=1 center=(-1,-1) left=(16,0) right=(18,0)
 idx=3 coord=(16,0) rindex=3 node: lindex=16 porb=12 type=1 center=(-1,-1) left=(15,0) right=(17,0)
 idx=4 coord=(15,0) rindex=4 node: lindex=15 porb=11 type=1 center=(-1,-1) left=(14,0) right=(16,0)
 idx=5 coord=(14,0) rindex=5 node: lindex=14 porb=10 type=1 center=(-1,-1) left=(13,0) right=(15,0)
 idx=6 coord=(13,0) rindex=6 node: lindex=13 porb=9 type=1 center=(-1,-1) left=(12,0) right=(14,0)
 idx=7 coord=(12,0) rindex=7 node: lindex=12 porb=8 type=1 center=(-1,-1) left=(11,0) right=(13,0)
 idx=8 coord=(11,0) rindex=8 node: lindex=11 porb=7 type=1 center=(-1,-1) left=(10,0) right=(12,0)
 idx=9 coord=(10,0) rindex=9 node: lindex=10 porb=6 type=1 center=(-1,-1) left=(9,0) right=(11,0)
 idx=10 coord=(9,0) rindex=10 node: lindex=9 porb=5 type=1 center=(-1,-1) left=(8,0) right=(10,0)
 idx=11 coord=(8,0) rindex=11 node: lindex=8 porb=19 type=1 center=(-1,-1) left=(7,0) right=(9,0)
 idx=12 coord=(7,0) rindex=12 node: lindex=7 porb=18 type=1 center=(-1,-1) left=(6,0) right=(8,0)
 idx=13 coord=(6,0) rindex=13 node: lindex=6 porb=17 type=1 center=(-1,-1) left=(5,0) right=(7,0)
 idx=14 coord=(5,0) rindex=14 node: lindex=5 porb=16 type=1 center=(-1,-1) left=(4,0) right=(6,0)
 idx=15 coord=(4,0) rindex=15 node: lindex=4 porb=4 type=1 center=(-1,-1) left=(3,0) right=(5,0)
 idx=16 coord=(3,0) rindex=16 node: lindex=3 porb=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=17 coord=(2,0) rindex=17 node: lindex=2 porb=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=18 coord=(1,0) rindex=18 node: lindex=1 porb=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=19 coord=(0,0) rindex=19 node: lindex=0 porb=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(19,0) rsupport: 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) rsupport: 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) rsupport: 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) rsupport: 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) rsupport: 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) rsupport: 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) rsupport: 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) rsupport: 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) rsupport: 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) rsupport: 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) rsupport: 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) rsupport: 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) rsupport: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) rsupport: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 16 
 idx=14 coord=(5,0) rsupport: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 4 
 idx=15 coord=(4,0) rsupport: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 3 
 idx=16 coord=(3,0) rsupport: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 2 
 idx=17 coord=(2,0) rsupport: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 1 
 idx=18 coord=(1,0) rsupport: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 0 
 idx=19 coord=(0,0) rsupport: 0 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(19,0) corbs: 15 ; rorbs: ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 16 17 18 19 
 idx=1 coord=(18,0) corbs: 14 ; rorbs: 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19 
 idx=2 coord=(17,0) corbs: 13 ; rorbs: 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19 
 idx=3 coord=(16,0) corbs: 12 ; rorbs: 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19 
 idx=4 coord=(15,0) corbs: 11 ; rorbs: 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19 
 idx=5 coord=(14,0) corbs: 10 ; rorbs: 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 9 16 17 18 19 
 idx=6 coord=(13,0) corbs: 9 ; rorbs: 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 8 16 17 18 19 
 idx=7 coord=(12,0) corbs: 8 ; rorbs: 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 7 16 17 18 19 
 idx=8 coord=(11,0) corbs: 7 ; rorbs: 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 6 16 17 18 19 
 idx=9 coord=(10,0) corbs: 6 ; rorbs: 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 5 16 17 18 19 
 idx=10 coord=(9,0) corbs: 5 ; rorbs: 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 19 
 idx=11 coord=(8,0) corbs: 19 ; rorbs: 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 18 
 idx=12 coord=(7,0) corbs: 18 ; rorbs: 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 17 
 idx=13 coord=(6,0) corbs: 17 ; rorbs: 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 16 
 idx=14 coord=(5,0) corbs: 16 ; rorbs: 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 4 
 idx=15 coord=(4,0) corbs: 4 ; rorbs: 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 3 
 idx=16 coord=(3,0) corbs: 3 ; rorbs: 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 2 
 idx=17 coord=(2,0) corbs: 2 ; rorbs: 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 1 
 idx=18 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 0 
 idx=19 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9 32 33 34 35 36 37 38 39 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31

fci::ci_load fname=./scratch/ci.info

ctns::rcanon_init qkind=qNSz

fci::ci_truncate ciconfs=1641 maxdets=1000 ifortho=1
 iroot=0 <CI[trunc]|CI>=9.972497175295e-01

ctns::init_rbases rdm_svd=1.500e+00 thresh_proj=1.000e-10

idx=0 node=(19,0) type=
idx=1 node=(18,0) type=10 rsupport=14 rsupport= 1515  


idx=2 node=(17,0) type=1 rsupport=13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=1000,932,4 dimBc=4 1-popBc=0.000e+00 SvN=6.821e-01
----- TIMING FOR ctns::right_projection<Qm,Tm> : 4.153e-03 S -----
 dim(space,lspace,rspace)=1000,735,10 dimBc=10 1-popBc=0 SvN=1.04
----- TIMING FOR ctns::right_projection<Qm,Tm> : 4.168e-03 S -----

idx=3 node=(16,0) type=1 rsupport=12 13 14 15 

idx=4 node=(15,0) type=1 rsupport=11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=1000,684,26 dimBc=24 1-popBc=1.110e-16 SvN=1.199e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.204e-03 S -----

idx=5 node=(14,0) type=1 rsupport=10 11 12 13 14 15 
 dim(space,lspace,rspace)=1000,566,54 dimBc=42 1-popBc=-4.44e-16 SvN=1.25
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.266e-03 S -----

idx=6 node=(13,0) type=1 rsupport=9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=1000,495,82 dimBc=58 1-popBc=-4.441e-16 SvN=1.620e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.422e-03 S -----

idx=7 node=(12,0) type=1 rsupport=8 9 10 11 12 13 14 15 
 dim(space,lspace,rspace)=1000,412,123 dimBc=68 1-popBc=-2.22e-16 SvN=1.93
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.493e-03 S -----

idx=8 node=(11,0) type=1 rsupport=7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=1000,296,171 dimBc=77 1-popBc=2.220e-16 SvN=2.146e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.869e-03 S -----

idx=9 node=(10,0) type=1 rsupport=6 7 8 9 10 11 12 13 14 15 
 dim(space,lspace,rspace)=1000,186,234 dimBc=74 1-popBc=1.11e-16 SvN=2.31
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.387e-03 S -----

idx=10 node=(9,0) type=1 rsupport=5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=1000,161,345 dimBc=73 1-popBc=-2.220e-16 SvN=2.232e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.467e-03 S -----

idx=11 node=(8,0) type=1 rsupport=19 5 6 7 8 9 10 11 12 13 14 15 
 dim(space,lspace,rspace)=1000,128,435 dimBc=65 1-popBc=2.22e-16 SvN=2.08
----- TIMING FOR ctns::right_projection<Qm,Tm> : 2.250e-03 S -----

idx=12 node=(7,0) type=1 rsupport=18 19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=1000,90,503 dimBc=57 1-popBc=-6.661e-16 SvN=1.978e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.775e-03 S -----

idx=13 node=(6,0) type=1 rsupport=17 18 19 5 6 7 8 9 10 11 12 13 14 15 
 dim(space,lspace,rspace)=1000,55,541 dimBc=47 1-popBc=-2.22e-16 SvN=1.82
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.517e-03 S -----

idx=14 node=(5,0) type=1 rsupport=16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=1000,43,623 dimBc=38 1-popBc=1.110e-16 SvN=1.517e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.441e-03 S -----

idx=15 node=(4,0) type=1 rsupport=4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
 dim(space,lspace,rspace)=1000,31,624 dimBc=27 1-popBc=5.55e-16 SvN=1.18
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.347e-03 S -----

idx=16 node=(3,0) type=1 rsupport=3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=1000,17,760 dimBc=17 1-popBc=1.110e-16 SvN=9.521e-01
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.311e-03 S -----

idx=17 node=(2,0) type=1 rsupport=2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
 dim(space,lspace,rspace)=1000,10,849 dimBc=10 1-popBc=5.55e-16 SvN=0.765
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.281e-03 S -----

idx=18 node=(1,0) type=1 rsupport=1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=1000,6,893 dimBc=6 1-popBc=-4.441e-16 SvN=5.467e-01
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.281e-03 S -----

idx=19 node=(0,0) type=0 rsupport=0 1 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15 
 dim(space,lspace,rspace)=1000,3,1000 dimBc=3 1-popBc=-2.22e-16 SvN=0.274
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.292e-03 S -----
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-10
 dim(space,lspace,rspace)=1000,1,1000 dimBc=1 1-popBc=-4.441e-16 SvN=-4.441e-16
----- TIMING FOR ctns::right_projection<Qm,Tm> : 6.457e-04 S -----

generated rbases with thresh_proj=1e-10
 idx=0 node=(19,0) type=0 shape=4,4 1-popBc=0.000e+00
 idx=1 node=(18,0) type=1 shape=4,4 1-popBc=0.000e+00
 idx=2 node=(17,0) type=1 shape=10,10 1-popBc=0.000e+00
 idx=3 node=(16,0) type=1 shape=26,24 1-popBc=1.110e-16
 idx=4 node=(15,0) type=1 shape=54,42 1-popBc=-4.441e-16
 idx=5 node=(14,0) type=1 shape=82,58 1-popBc=-4.441e-16
 idx=6 node=(13,0) type=1 shape=123,68 1-popBc=-2.220e-16
 idx=7 node=(12,0) type=1 shape=171,77 1-popBc=2.220e-16
 idx=8 node=(11,0) type=1 shape=234,74 1-popBc=1.110e-16
 idx=9 node=(10,0) type=1 shape=345,73 1-popBc=-2.220e-16
 idx=10 node=(9,0) type=1 shape=435,65 1-popBc=2.220e-16
 idx=11 node=(8,0) type=1 shape=503,57 1-popBc=-6.661e-16
 idx=12 node=(7,0) type=1 shape=541,47 1-popBc=-2.220e-16
 idx=13 node=(6,0) type=1 shape=623,38 1-popBc=1.110e-16
 idx=14 node=(5,0) type=1 shape=624,27 1-popBc=5.551e-16
 idx=15 node=(4,0) type=1 shape=760,17 1-popBc=1.110e-16
 idx=16 node=(3,0) type=1 shape=849,10 1-popBc=5.551e-16
 idx=17 node=(2,0) type=1 shape=893,6 1-popBc=-4.441e-16
 idx=18 node=(1,0) type=1 shape=1000,3 1-popBc=-2.220e-16
 idx=19 node=(0,0) type=0 shape=1000,1 1-popBc=-4.441e-16
maximum bond dimension = 77
----- TIMING FOR ctns::init_rbases : 2.899e-02 S -----

ctns::init_rsites qkind=qNSz thresh_ortho=1e-08
 idx=0 node=(19,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 deviate=0 TIMING=8.000e-06 S
 idx=1 node=(18,0)[1] shape(l,r,c)=(4,4,4) maxdiff=1.219e-17 deviate=0 TIMING=2.650e-05 S
 idx=2 node=(17,0)[1] shape(l,r,c)=(10,4,4) maxdiff=5.254e-16 deviate=0 TIMING=1.233e-05 S
 idx=3 node=(16,0)[1] shape(l,r,c)=(24,10,4) maxdiff=1.690e-15 deviate=0 TIMING=2.162e-05 S
 idx=4 node=(15,0)[1] shape(l,r,c)=(42,24,4) maxdiff=3.169e-15 deviate=0 TIMING=6.808e-05 S
 idx=5 node=(14,0)[1] shape(l,r,c)=(58,42,4) maxdiff=4.869e-15 deviate=0 TIMING=5.488e-05 S
 idx=6 node=(13,0)[1] shape(l,r,c)=(68,58,4) maxdiff=4.741e-15 deviate=0 TIMING=6.766e-05 S
 idx=7 node=(12,0)[1] shape(l,r,c)=(77,68,4) maxdiff=5.676e-15 deviate=0 TIMING=8.547e-05 S
 idx=8 node=(11,0)[1] shape(l,r,c)=(74,77,4) maxdiff=5.582e-15 deviate=0 TIMING=1.099e-04 S
 idx=9 node=(10,0)[1] shape(l,r,c)=(73,74,4) maxdiff=5.516e-15 deviate=0 TIMING=1.729e-04 S
 idx=10 node=(9,0)[1] shape(l,r,c)=(65,73,4) maxdiff=4.483e-15 deviate=0 TIMING=2.399e-04 S
 idx=11 node=(8,0)[1] shape(l,r,c)=(57,65,4) maxdiff=4.748e-15 deviate=0 TIMING=2.859e-04 S
 idx=12 node=(7,0)[1] shape(l,r,c)=(47,57,4) maxdiff=4.406e-15 deviate=0 TIMING=3.213e-04 S
 idx=13 node=(6,0)[1] shape(l,r,c)=(38,47,4) maxdiff=3.430e-15 deviate=0 TIMING=3.627e-04 S
 idx=14 node=(5,0)[1] shape(l,r,c)=(27,38,4) maxdiff=3.940e-15 deviate=0 TIMING=3.761e-04 S
 idx=15 node=(4,0)[1] shape(l,r,c)=(17,27,4) maxdiff=2.997e-15 deviate=0 TIMING=3.096e-04 S
 idx=16 node=(3,0)[1] shape(l,r,c)=(10,17,4) maxdiff=2.411e-15 deviate=0 TIMING=3.246e-04 S
 idx=17 node=(2,0)[1] shape(l,r,c)=(6,10,4) maxdiff=1.492e-15 deviate=0 TIMING=3.497e-04 S
 idx=18 node=(1,0)[1] shape(l,r,c)=(3,6,4) maxdiff=6.661e-16 deviate=0 TIMING=2.664e-04 S
 idx=19 node=(0,0)[0] shape(l,r,c)=(1,3,4) maxdiff=0.000e+00 deviate=0 TIMING=2.684e-04 S
----- TIMING FOR ctns::init_rsites : 4.201e-03 S -----

ctns::init_rwfuns qkind=qNSz thresh_ortho=1e-08
qtensor2: wf2 own=1 _data=0x55b2c51de460
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.63e-06MB

check state overlaps ...
matrix: ova_rwfuns size=(1,1)
      1.0000e+00 
matrix: ova0_vs size=(1,1)
      1.0000e+00 
diff of ova matrices = 0
----- TIMING FOR ctns::init_rwfuns : 1.190e-03 S -----

ctns::init_rcanon thresh_ortho=1e-08

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=1000
matrix: <CI|CTNS[0]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[0]> size=(1,1)
      1.0000e+00 

rcanon::rcanon_canonicalize ifortho=1 ifab=1 nroots=1 dmax=77
----- TIMING FOR ctns::rcanon_canonicalize : 1.369e-02 S -----

matrix: <CTNS[new]|CTNS[new]> size=(1,1)
      1.0000e+00 

matrix: <CTNS[0]|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=1 ciconfs=1000
matrix: <CI|CTNS[new]> size=(1,1)
      1.0000e+00 

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=4 maxdiff=1.137e-16 deviate=0
 idx=2 node=(17,0) Drow=10 maxdiff=1.202e-15 deviate=0
 idx=3 node=(16,0) Drow=24 maxdiff=1.169e-15 deviate=0
 idx=4 node=(15,0) Drow=42 maxdiff=2.514e-15 deviate=0
 idx=5 node=(14,0) Drow=58 maxdiff=2.808e-15 deviate=0
 idx=6 node=(13,0) Drow=68 maxdiff=3.769e-15 deviate=0
 idx=7 node=(12,0) Drow=77 maxdiff=5.026e-15 deviate=0
 idx=8 node=(11,0) Drow=74 maxdiff=4.085e-15 deviate=0
 idx=9 node=(10,0) Drow=73 maxdiff=3.263e-15 deviate=0
 idx=10 node=(9,0) Drow=65 maxdiff=2.689e-15 deviate=0
 idx=11 node=(8,0) Drow=57 maxdiff=2.246e-15 deviate=0
 idx=12 node=(7,0) Drow=47 maxdiff=3.055e-15 deviate=0
 idx=13 node=(6,0) Drow=38 maxdiff=1.706e-15 deviate=0
 idx=14 node=(5,0) Drow=27 maxdiff=1.947e-15 deviate=0
 idx=15 node=(4,0) Drow=17 maxdiff=1.316e-15 deviate=0
 idx=16 node=(3,0) Drow=10 maxdiff=5.879e-16 deviate=0
 idx=17 node=(2,0) Drow=6 maxdiff=4.808e-16 deviate=0
 idx=18 node=(1,0) Drow=3 maxdiff=3.331e-16 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=2.220e-16 deviate=0
qtensor2: wf2 own=1 _data=0x55b2c5b90008
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x55b2c5b90008
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 5.499e-04 S -----
----- TIMING FOR ctns::rcanon_init : 1.092e-01 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci T(save)=0.0012S

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=4 maxdiff=1.137e-16 deviate=0
 idx=2 node=(17,0) Drow=10 maxdiff=1.202e-15 deviate=0
 idx=3 node=(16,0) Drow=24 maxdiff=1.169e-15 deviate=0
 idx=4 node=(15,0) Drow=42 maxdiff=2.514e-15 deviate=0
 idx=5 node=(14,0) Drow=58 maxdiff=2.808e-15 deviate=0
 idx=6 node=(13,0) Drow=68 maxdiff=3.769e-15 deviate=0
 idx=7 node=(12,0) Drow=77 maxdiff=5.026e-15 deviate=0
 idx=8 node=(11,0) Drow=74 maxdiff=4.085e-15 deviate=0
 idx=9 node=(10,0) Drow=73 maxdiff=3.263e-15 deviate=0
 idx=10 node=(9,0) Drow=65 maxdiff=2.689e-15 deviate=0
 idx=11 node=(8,0) Drow=57 maxdiff=2.246e-15 deviate=0
 idx=12 node=(7,0) Drow=47 maxdiff=3.055e-15 deviate=0
 idx=13 node=(6,0) Drow=38 maxdiff=1.706e-15 deviate=0
 idx=14 node=(5,0) Drow=27 maxdiff=1.947e-15 deviate=0
 idx=15 node=(4,0) Drow=17 maxdiff=1.316e-15 deviate=0
 idx=16 node=(3,0) Drow=10 maxdiff=5.879e-16 deviate=0
 idx=17 node=(2,0) Drow=6 maxdiff=4.808e-16 deviate=0
 idx=18 node=(1,0) Drow=3 maxdiff=3.331e-16 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=2.220e-16 deviate=0
qtensor2: wf2 own=1 _data=0x55b2c5111b90
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x55b2c5111b90
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 4.052e-04 S -----
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=14590:0.111MB:0.000109GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=14741:0.112MB:0.00011GB
rank=0 CPUmem(GB): used=1.343e+00 pageheap_free=3.532e-02 change=8.807e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 

integral::load fname = moleinfo/fmole.info
 sorb = 40
 size(int1e) = 1600:1.221e-02MB:1.192e-05GB
 size(int2e) = 305370:2.330e+00MB:2.275e-03GB
 ecore = 0.000000000000
----- TIMING FOR integral::load : 8.241e-02 S -----

io::remove_scratch scratch=./scratch/sweep
successfully removed ./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=qNSz
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=3.268e-02 change=2.294e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_save_sites scratch=./scratch/sweep T(save)=1.65e-02S
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(19,0) size=1.78e-02MB:1.74e-05GB
fname=./scratch/sweep/cop(19,0) size=1.74e-05GB T[save](info/data/tot)=0.000968,0.000807,0.00178 speed=0.0098GB/S disk[used]=0.000132GB
ctns::oper_save iomode=0 fname=./scratch/sweep/rop(19,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/rop(19,0) size=1.74e-05GB T[save](info/data/tot)=0.000932,0.000837,0.00177 speed=0.00983GB/S disk[used]=0.00015GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(18,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(18,0) size=1.74e-05GB T[save](info/data/tot)=0.000902,0.000802,0.0017 speed=0.0102GB/S disk[used]=0.000167GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(17,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(17,0) size=1.74e-05GB T[save](info/data/tot)=0.000841,0.000731,0.00157 speed=0.0111GB/S disk[used]=0.000185GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(16,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(16,0) size=1.74e-05GB T[save](info/data/tot)=0.00087,0.000745,0.00161 speed=0.0108GB/S disk[used]=0.000203GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(15,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(15,0) size=1.74e-05GB T[save](info/data/tot)=0.000811,0.000731,0.00154 speed=0.0113GB/S disk[used]=0.00022GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(14,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(14,0) size=1.74e-05GB T[save](info/data/tot)=0.00158,0.000787,0.00236 speed=0.00737GB/S disk[used]=0.000238GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(13,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(13,0) size=1.74e-05GB T[save](info/data/tot)=0.000767,0.000712,0.00148 speed=0.0118GB/S disk[used]=0.000256GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(12,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(12,0) size=1.74e-05GB T[save](info/data/tot)=0.000778,0.000742,0.00152 speed=0.0114GB/S disk[used]=0.000274GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(11,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(11,0) size=1.74e-05GB T[save](info/data/tot)=0.00076,0.000673,0.00143 speed=0.0121GB/S disk[used]=0.000291GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(10,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(10,0) size=1.74e-05GB T[save](info/data/tot)=0.000775,0.000709,0.00148 speed=0.0117GB/S disk[used]=0.000309GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(9,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(9,0) size=1.74e-05GB T[save](info/data/tot)=0.000796,0.0007,0.0015 speed=0.0116GB/S disk[used]=0.000327GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(8,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(8,0) size=1.74e-05GB T[save](info/data/tot)=0.000772,0.000653,0.00142 speed=0.0122GB/S disk[used]=0.000344GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(7,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(7,0) size=1.74e-05GB T[save](info/data/tot)=0.000782,0.000682,0.00146 speed=0.0119GB/S disk[used]=0.000362GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(6,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(6,0) size=1.74e-05GB T[save](info/data/tot)=0.000814,0.000686,0.0015 speed=0.0116GB/S disk[used]=0.00038GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(5,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(5,0) size=1.74e-05GB T[save](info/data/tot)=0.000754,0.000703,0.00146 speed=0.0119GB/S disk[used]=0.000397GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(4,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(4,0) size=1.74e-05GB T[save](info/data/tot)=0.000713,0.00064,0.00135 speed=0.0129GB/S disk[used]=0.000415GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(3,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(3,0) size=1.74e-05GB T[save](info/data/tot)=0.000725,0.000657,0.00138 speed=0.0126GB/S disk[used]=0.000433GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(2,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(2,0) size=1.74e-05GB T[save](info/data/tot)=0.000705,0.000654,0.00136 speed=0.0128GB/S disk[used]=0.00045GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(1,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(1,0) size=1.74e-05GB T[save](info/data/tot)=0.00073,0.000643,0.00137 speed=0.0127GB/S disk[used]=0.000468GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(0,0) size=0.0178MB:1.74e-05GB
fname=./scratch/sweep/cop(0,0) size=1.74e-05GB T[save](info/data/tot)=0.000724,0.000657,0.00138 speed=0.0126GB/S disk[used]=0.000486GB
----- TIMING FOR ctns::oper_init_dotCR : 1.250e-01 S -----
T[ctns::oper_init_dotCR](comp/save/tot)=0.0479,0.0731,0.121

idx=1 coord=(18,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=6.180e-04 change=-1.802e-04 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=1 scratch=./scratch/sweep size=6:4.47e-08GB T(load)=3.36e-04S speed=1.33e-04GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
ctns::oper_renorm coord=(18,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:4 S:18 H:1 A:3 B:5 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=32:0.000244MB:2.38e-07GB
        per(mem): C:25 S:0 H:18.8 A:0 B:56.2 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.769e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=13 : 4.451e-05 S -----
rank=0 GPUmem(GB): used=3.505e-05 (oper)=3.505e-05
rank=0 GPUmem(GB): used=3.509e-05 (oper,site)=3.505e-05,4.470e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=13
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=3.509e-05 (oper,site,rinter)=3.505e-05,4.470e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 3.616e-05 S size(rtasks)=13 size(Rlst2)=9 T(Rmu/Rlist)=1.926e-05,1.687e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.333e-05 S size(rtasks)=13 size(Rlst)=37 -----
rank=0 GPUmem(GB): used=3.509e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.481e-06 blksize=4 blksize0=0 batchsize=37
rank=0 GPUmem(GB): used=3.757e-05 (oper,site,rinter,batch)=3.505e-05,4.470e-08,0.000e+00,2.481e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.581e-05,4.117e-04,1.200e-04
----- TIMING FOR renorm : t_inter=1.6e-05 t_gemm=4.1e-04 t_reduction=1.2e-04 tot=5.5e-04 -----
 renorm[inter] counter=1 t=1.6e-05 per=2.9e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=4.4e-06 per=8.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=2.0e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=2.6e-04 per=4.7e+01 cost=2.8e+01 flops=1.1e+05
 renorm[gemm] counter=1 i=3 t=6.9e-05 per=1.3e+01 cost=4.2e+01 flops=6.1e+05
 renorm[gemm] counter=1 i=4 t=2.1e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=5 t=1.9e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=6 t=7.6e-05 per=1.4e+01 cost=1.8e+02 flops=2.4e+06
 renorm[gemm] counter=1 total t=4.1e-04 per=7.5e+01 cost=2.5e+02 flops=6.2e+05
 renorm[red] counter=1 t=1.2e-04 per=2.2e+01 cost=1.8e+02 flops=1.5e+06
----- TIMING FOR renorm_tot : t_inter=1.6e-05 t_gemm=4.1e-04 t_reduction=1.2e-04 tot=5.5e-04 -----
 renorm_tot[inter] counter=1 t=1.6e-05 per=2.9e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=4.4e-06 per=8.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=2.0e-06 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=2.6e-04 per=4.7e+01 cost=2.8e+01 flops=1.1e+05
 renorm_tot[gemm] counter=1 i=3 t=6.9e-05 per=1.3e+01 cost=4.2e+01 flops=6.1e+05
 renorm_tot[gemm] counter=1 i=4 t=2.1e-06 per=3.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=5 t=1.9e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=6 t=7.6e-05 per=1.4e+01 cost=1.8e+02 flops=2.4e+06
 renorm_tot[gemm] counter=1 total t=4.1e-04 per=7.5e+01 cost=2.5e+02 flops=6.2e+05
 renorm_tot[red] counter=1 t=1.2e-04 per=2.2e+01 cost=1.8e+02 flops=1.5e+06
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.508e-05 (oper)=3.508e-05
rank=0 GPUmem(GB): used=3.512e-05 (oper,site,rinter)=3.508e-05,4.470e-08,0.000e+00
rank=0 GPUmem(GB): used=3.527e-05 (oper,site,rinter,batch)=3.508e-05,4.470e-08,0.000e+00,1.490e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 3.758e-03 S T(preprocess/alloc/comp/red/dealloc)=4.068e-04,4.732e-04,2.576e-03,6.504e-04,2.465e-05 -----
----- TIMING FOR oper_renorm_opS : 3.789e-03 S rank=0 -----
qops.to_cpu: size(tot)=32:2.441e-04MB:2.384e-07GB T(to_cpu)=3.256e-05S speed=7.323e-03GB/S
check ||H-H.dagger||=1.884e-15 coord=(18,0) rank=0
----- TIMING FOR oper_renorm : 0.00594 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=7.942e-05 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.764e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-6.855e-07 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 1.358e-02 S #####
 T(local oper_env: fetch) = 5.489e-03 S  per = 40.4  per(accum) = 40.4
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 40.4
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 40.4
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 40.4
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 40.4
 T(local oper_env: renrm) = 6.685e-03 S  per = 49.2  per(accum) = 89.6
 T(local oper_env: save ) = 1.406e-03 S  per = 10.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.685e-03 S  T(sum) = 6.685e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 6.165e-05 S  per = 0.922  per(accum) = 0.922
 T(local oper_env: qops init                    ) = 2.866e-04 S  per = 4.29  per(accum) = 5.21
 T(local oper_env: symbolic_formulae_renorm     ) = 5.878e-05 S  per = 0.879  per(accum) = 6.09
 T(local oper_env: allocate qops on gpu         ) = 6.769e-05 S  per = 1.01  per(accum) = 7.1
 T(local oper_env: site memcpy cpu2gpu          ) = 3.015e-05 S  per = 0.451  per(accum) = 7.55
 T(local oper_env: rintermediate init           ) = 3.679e-05 S  per = 0.55  per(accum) = 8.1
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.648e-05 S  per = 0.994  per(accum) = 9.1
 T(local oper_env: rmmtasks init                ) = 1.042e-04 S  per = 1.56  per(accum) = 10.7
 T(local oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 0.000509  per(accum) = 10.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 7.300e-04 S  per = 10.9  per(accum) = 21.6
 T(local oper_env: deallocate cpu and gpu memory) = 3.029e-05 S  per = 0.453  per(accum) = 22
 T(local oper_env: construct opS [ifdists=true] ) = 3.809e-03 S  per =   57  per(accum) = 79
 T(local oper_env: reduction of opS & opH [nccl]) = 6.307e-04 S  per = 9.44  per(accum) = 88.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.545e-05 S  per = 0.68  per(accum) = 89.1
 T(local oper_env: reduction of opS & opH [mpi] ) = 4.728e-05 S  per = 0.707  per(accum) = 89.8
 T(local oper_env: qops_pool join and erase     ) = 6.787e-04 S  per = 10.2  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 5.680e-07 S  per = 0.0085  per(accum) = 100
##### sweep oper_env: 1.358e-02 S #####
 T(sweep oper_env: fetch) = 5.489e-03 S  per = 40.4  per(accum) = 40.4
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 40.4
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 40.4
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 40.4
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 40.4
 T(sweep oper_env: renrm) = 6.685e-03 S  per = 49.2  per(accum) = 89.6
 T(sweep oper_env: save ) = 1.406e-03 S  per = 10.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(sweep oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.685e-03 S  T(sum) = 6.685e-03 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 6.165e-05 S  per = 0.922  per(accum) = 0.922
 T(sweep oper_env: qops init                    ) = 2.866e-04 S  per = 4.29  per(accum) = 5.21
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.878e-05 S  per = 0.879  per(accum) = 6.09
 T(sweep oper_env: allocate qops on gpu         ) = 6.769e-05 S  per = 1.01  per(accum) = 7.1
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.015e-05 S  per = 0.451  per(accum) = 7.55
 T(sweep oper_env: rintermediate init           ) = 3.679e-05 S  per = 0.55  per(accum) = 8.1
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 6.648e-05 S  per = 0.994  per(accum) = 9.1
 T(sweep oper_env: rmmtasks init                ) = 1.042e-04 S  per = 1.56  per(accum) = 10.7
 T(sweep oper_env: qops memset on cpu           ) = 3.400e-08 S  per = 0.000509  per(accum) = 10.7
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 7.300e-04 S  per = 10.9  per(accum) = 21.6
 T(sweep oper_env: deallocate cpu and gpu memory) = 3.029e-05 S  per = 0.453  per(accum) = 22
 T(sweep oper_env: construct opS [ifdists=true] ) = 3.809e-03 S  per =   57  per(accum) = 79
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.307e-04 S  per = 9.44  per(accum) = 88.5
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 4.545e-05 S  per = 0.68  per(accum) = 89.1
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 4.728e-05 S  per = 0.707  per(accum) = 89.8
 T(sweep oper_env: qops_pool join and erase     ) = 6.787e-04 S  per = 10.2  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.680e-07 S  per = 0.0085  per(accum) = 100

idx=2 coord=(17,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=2 scratch=./scratch/sweep size=26:1.94e-07GB T(load)=2.97e-04S speed=6.52e-04GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHAB nops=C:4 S:18 H:1 A:3 B:5 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=32:0.000244MB:2.38e-07GB
        per(mem): C:25 S:0 H:18.8 A:0 B:56.2 
ctns::oper_renorm coord=(17,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:6 S:17 H:1 A:7 B:11 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=402:0.00307MB:3e-06GB
        per(mem): C:15.7 S:29.6 H:5.97 A:10.4 B:38.3 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.098e-04 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=25 : 3.465e-05 S -----
rank=0 GPUmem(GB): used=2.064e-05 (oper)=2.064e-05
rank=0 GPUmem(GB): used=2.083e-05 (oper,site)=2.064e-05,1.937e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=25
 no. of rintermediate operators=5
 no. of coefficients=14:1.068e-04MB:1.043e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.701e-05 S -----
rank=0 GPUmem(GB): used=2.094e-05 (oper,site,rinter)=2.064e-05,1.937e-07,1.043e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 4.690e-05 S size(rtasks)=25 size(Rlst2)=25 T(Rmu/Rlist)=1.517e-05,3.171e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.058e-05 S size(rtasks)=25 size(Rlst)=112 -----
rank=0 GPUmem(GB): used=2.094e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.919e-05 blksize=9 blksize0=4 batchsize=112
rank=0 GPUmem(GB): used=4.013e-05 (oper,site,rinter,batch)=2.064e-05,1.937e-07,1.043e-07,1.919e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.704e-05,3.274e-04,1.066e-04
----- TIMING FOR renorm : t_inter=7.7e-05 t_gemm=3.3e-04 t_reduction=1.1e-04 tot=5.1e-04 -----
 renorm[inter] counter=16 t=7.7e-05 per=1.5e+01 cost=4.1e+02 flops=5.3e+06
 renorm[gemm] counter=16 i=0 t=1.9e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=1 t=1.7e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=2 t=1.0e-04 per=2.0e+01 cost=2.8e+02 flops=2.7e+06
 renorm[gemm] counter=16 i=3 t=1.2e-04 per=2.4e+01 cost=6.4e+02 flops=5.1e+06
 renorm[gemm] counter=16 i=4 t=1.6e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=5 t=1.6e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=16 i=6 t=9.3e-05 per=1.8e+01 cost=2.1e+03 flops=2.2e+07
 renorm[gemm] counter=16 total t=3.3e-04 per=6.4e+01 cost=3.0e+03 flops=9.1e+06
 renorm[red] counter=16 t=1.1e-04 per=2.1e+01 cost=1.4e+03 flops=1.3e+07
----- TIMING FOR renorm_tot : t_inter=9.3e-05 t_gemm=7.4e-04 t_reduction=2.3e-04 tot=1.1e-03 -----
 renorm_tot[inter] counter=16 t=9.3e-05 per=8.8e+00 cost=4.1e+02 flops=4.4e+06
 renorm_tot[gemm] counter=16 i=0 t=6.3e-06 per=6.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=1 t=3.7e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=2 t=3.6e-04 per=3.4e+01 cost=3.0e+02 flops=8.5e+05
 renorm_tot[gemm] counter=16 i=3 t=1.9e-04 per=1.8e+01 cost=6.8e+02 flops=3.5e+06
 renorm_tot[gemm] counter=16 i=4 t=3.7e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=5 t=3.5e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=16 i=6 t=1.7e-04 per=1.6e+01 cost=2.3e+03 flops=1.3e+07
 renorm_tot[gemm] counter=16 total t=7.4e-04 per=7.0e+01 cost=3.2e+03 flops=4.4e+06
 renorm_tot[red] counter=16 t=2.3e-04 per=2.1e+01 cost=1.6e+03 flops=7.0e+06
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.313e-05 (oper)=2.074e-05
rank=0 GPUmem(GB): used=2.332e-05 (oper,site,rinter)=2.074e-05,1.937e-07,2.280e-06
rank=0 GPUmem(GB): used=2.538e-05 (oper,site,rinter,batch)=2.074e-05,1.937e-07,2.280e-06,2.056e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.141e-02 S T(preprocess/alloc/comp/red/dealloc)=1.175e-03,1.228e-03,8.951e-03,9.890e-04,1.920e-04 -----
----- TIMING FOR oper_renorm_opS : 1.145e-02 S rank=0 -----
qops.to_cpu: size(tot)=402:3.067e-03MB:2.995e-06GB T(to_cpu)=2.679e-05S speed=1.118e-01GB/S
check ||H-H.dagger||=1.265e-15 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.0128 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=4.421e-05 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=2.823e-04 change=-9.341e-04 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.013e-06 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 1.674e-02 S #####
 T(local oper_env: fetch) = 2.098e-03 S  per = 12.5  per(accum) = 12.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 12.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 12.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 12.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 12.5
 T(local oper_env: renrm) = 1.331e-02 S  per = 79.5  per(accum) = 92
 T(local oper_env: save ) = 1.335e-03 S  per = 7.98  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.331e-02 S  T(sum) = 1.331e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.327e-05 S  per = 0.0997  per(accum) = 0.0997
 T(local oper_env: qops init                    ) = 2.203e-04 S  per = 1.65  per(accum) = 1.75
 T(local oper_env: symbolic_formulae_renorm     ) = 4.474e-05 S  per = 0.336  per(accum) = 2.09
 T(local oper_env: allocate qops on gpu         ) = 4.910e-05 S  per = 0.369  per(accum) = 2.46
 T(local oper_env: site memcpy cpu2gpu          ) = 2.812e-05 S  per = 0.211  per(accum) = 2.67
 T(local oper_env: rintermediate init           ) = 5.342e-05 S  per = 0.401  per(accum) = 3.07
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.530e-05 S  per = 0.491  per(accum) = 3.56
 T(local oper_env: rmmtasks init                ) = 8.860e-05 S  per = 0.666  per(accum) = 4.23
 T(local oper_env: qops memset on cpu           ) = 3.000e-08 S  per = 0.000225  per(accum) = 4.23
 T(local oper_env: preprocess_renorm_batchGPU   ) = 6.842e-04 S  per = 5.14  per(accum) = 9.37
 T(local oper_env: deallocate cpu and gpu memory) = 2.209e-05 S  per = 0.166  per(accum) = 9.54
 T(local oper_env: construct opS [ifdists=true] ) = 1.150e-02 S  per = 86.4  per(accum) = 95.9
 T(local oper_env: reduction of opS & opH [nccl]) = 1.991e-05 S  per = 0.15  per(accum) = 96.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.736e-05 S  per = 0.281  per(accum) = 96.3
 T(local oper_env: reduction of opS & opH [mpi] ) = 9.685e-06 S  per = 0.0728  per(accum) = 96.4
 T(local oper_env: qops_pool join and erase     ) = 4.763e-04 S  per = 3.58  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.590e-07 S  per = 0.00345  per(accum) = 100
##### sweep oper_env: 3.032e-02 S #####
 T(sweep oper_env: fetch) = 7.587e-03 S  per =   25  per(accum) = 25
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 25
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 25
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 25
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 25
 T(sweep oper_env: renrm) = 1.999e-02 S  per = 65.9  per(accum) = 91
 T(sweep oper_env: save ) = 2.742e-03 S  per = 9.04  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.471e+09 S  per = -3.471e+31
 T(sweep oper_env: preprocess                  ) = -3.471e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.999e-02 S  T(sum) = 1.999e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 7.491e-05 S  per = 0.375  per(accum) = 0.375
 T(sweep oper_env: qops init                    ) = 5.069e-04 S  per = 2.54  per(accum) = 2.91
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.035e-04 S  per = 0.518  per(accum) = 3.43
 T(sweep oper_env: allocate qops on gpu         ) = 1.168e-04 S  per = 0.584  per(accum) = 4.01
 T(sweep oper_env: site memcpy cpu2gpu          ) = 5.827e-05 S  per = 0.291  per(accum) = 4.3
 T(sweep oper_env: rintermediate init           ) = 9.021e-05 S  per = 0.451  per(accum) = 4.75
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.318e-04 S  per = 0.659  per(accum) = 5.41
 T(sweep oper_env: rmmtasks init                ) = 1.928e-04 S  per = 0.964  per(accum) = 6.38
 T(sweep oper_env: qops memset on cpu           ) = 6.400e-08 S  per = 0.00032  per(accum) = 6.38
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.414e-03 S  per = 7.07  per(accum) = 13.5
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.239e-05 S  per = 0.262  per(accum) = 13.7
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.531e-02 S  per = 76.6  per(accum) = 90.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.506e-04 S  per = 3.25  per(accum) = 93.5
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 8.281e-05 S  per = 0.414  per(accum) = 93.9
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 5.696e-05 S  per = 0.285  per(accum) = 94.2
 T(sweep oper_env: qops_pool join and erase     ) = 1.155e-03 S  per = 5.78  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.027e-06 S  per = 0.00514  per(accum) = 100

idx=3 coord=(16,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=3 scratch=./scratch/sweep size=131:9.76e-07GB T(load)=3.04e-04S speed=3.21e-03GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHAB nops=C:6 S:17 H:1 A:7 B:11 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=402:0.00307MB:3e-06GB
        per(mem): C:15.7 S:29.6 H:5.97 A:10.4 B:38.3 
ctns::oper_renorm coord=(16,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:8 S:16 H:1 A:14 B:18 
        dim(bra,ket)=24,24 size(op)=104:0.000793MB size(tot)=2908:0.0222MB:2.17e-05GB
        per(mem): C:16 S:24.8 H:3.58 A:14.2 B:41.5 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.421e-04 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=41 : 4.509e-05 S -----
rank=0 GPUmem(GB): used=4.207e-05 (oper)=4.207e-05
rank=0 GPUmem(GB): used=4.304e-05 (oper,site)=4.207e-05,9.760e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=41
 no. of rintermediate operators=6
 no. of coefficients=32:2.441e-04MB:2.384e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.058e-05 S -----
rank=0 GPUmem(GB): used=4.328e-05 (oper,site,rinter)=4.207e-05,9.760e-07,2.384e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.169e-04 S size(rtasks)=41 size(Rlst2)=49 T(Rmu/Rlist)=2.242e-05,9.440e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.368e-04 S size(rtasks)=41 size(Rlst)=378 -----
rank=0 GPUmem(GB): used=4.328e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.309e-04 blksize=36 blksize0=9 batchsize=378
rank=0 GPUmem(GB): used=2.742e-04 (oper,site,rinter,batch)=4.207e-05,9.760e-07,2.384e-07,2.309e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.021e-05,4.709e-04,1.889e-04
----- TIMING FOR renorm : t_inter=9.0e-05 t_gemm=4.7e-04 t_reduction=1.9e-04 tot=7.5e-04 -----
 renorm[inter] counter=51 t=9.0e-05 per=1.2e+01 cost=4.1e+03 flops=4.6e+07
 renorm[gemm] counter=51 i=0 t=1.9e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=51 i=1 t=1.6e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=51 i=2 t=1.4e-04 per=1.8e+01 cost=3.9e+03 flops=2.8e+07
 renorm[gemm] counter=51 i=3 t=1.6e-04 per=2.1e+01 cost=9.2e+03 flops=5.9e+07
 renorm[gemm] counter=51 i=4 t=1.7e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=51 i=5 t=1.6e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=51 i=6 t=1.7e-04 per=2.3e+01 cost=3.0e+04 flops=1.8e+08
 renorm[gemm] counter=51 total t=4.7e-04 per=6.3e+01 cost=4.3e+04 flops=9.2e+07
 renorm[red] counter=51 t=1.9e-04 per=2.5e+01 cost=1.3e+04 flops=7.0e+07
----- TIMING FOR renorm_tot : t_inter=1.8e-04 t_gemm=1.2e-03 t_reduction=4.2e-04 tot=1.8e-03 -----
 renorm_tot[inter] counter=51 t=1.8e-04 per=1.0e+01 cost=4.5e+03 flops=2.5e+07
 renorm_tot[gemm] counter=51 i=0 t=8.2e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=51 i=1 t=5.3e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=51 i=2 t=5.0e-04 per=2.7e+01 cost=4.2e+03 flops=8.5e+06
 renorm_tot[gemm] counter=51 i=3 t=3.5e-04 per=1.9e+01 cost=9.9e+03 flops=2.8e+07
 renorm_tot[gemm] counter=51 i=4 t=5.4e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=51 i=5 t=5.1e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=51 i=6 t=3.4e-04 per=1.9e+01 cost=3.2e+04 flops=9.6e+07
 renorm_tot[gemm] counter=51 total t=1.2e-03 per=6.7e+01 cost=4.6e+04 flops=3.8e+07
 renorm_tot[red] counter=51 t=4.2e-04 per=2.3e+01 cost=1.5e+04 flops=3.6e+07
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.927e-05 (oper)=4.259e-05
rank=0 GPUmem(GB): used=5.025e-05 (oper,site,rinter)=4.259e-05,9.760e-07,6.437e-06
rank=0 GPUmem(GB): used=6.451e-05 (oper,site,rinter,batch)=4.259e-05,9.760e-07,6.437e-06,1.426e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.451e-02 S T(preprocess/alloc/comp/red/dealloc)=1.526e-03,1.575e-03,1.103e-02,1.671e-03,1.883e-04 -----
----- TIMING FOR oper_renorm_opS : 1.456e-02 S rank=0 -----
qops.to_cpu: size(tot)=2908:2.219e-02MB:2.167e-05GB T(to_cpu)=3.139e-05S speed=6.903e-01GB/S
check ||H-H.dagger||=5.340e-15 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.0163 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.310e-04 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.020e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-2.876e-06 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 2.027e-02 S #####
 T(local oper_env: fetch) = 2.132e-03 S  per = 10.5  per(accum) = 10.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 10.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 10.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 10.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 10.5
 T(local oper_env: renrm) = 1.679e-02 S  per = 82.8  per(accum) = 93.3
 T(local oper_env: save ) = 1.351e-03 S  per = 6.67  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.679e-02 S  T(sum) = 1.679e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.340e-05 S  per = 0.0798  per(accum) = 0.0798
 T(local oper_env: qops init                    ) = 2.425e-04 S  per = 1.44  per(accum) = 1.52
 T(local oper_env: symbolic_formulae_renorm     ) = 5.489e-05 S  per = 0.327  per(accum) = 1.85
 T(local oper_env: allocate qops on gpu         ) = 5.175e-05 S  per = 0.308  per(accum) = 2.16
 T(local oper_env: site memcpy cpu2gpu          ) = 2.153e-05 S  per = 0.128  per(accum) = 2.29
 T(local oper_env: rintermediate init           ) = 4.413e-05 S  per = 0.263  per(accum) = 2.55
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.491e-04 S  per = 0.888  per(accum) = 3.44
 T(local oper_env: rmmtasks init                ) = 1.611e-04 S  per = 0.959  per(accum) = 4.4
 T(local oper_env: qops memset on cpu           ) = 3.100e-08 S  per = 0.000185  per(accum) = 4.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 9.086e-04 S  per = 5.41  per(accum) = 9.81
 T(local oper_env: deallocate cpu and gpu memory) = 2.452e-05 S  per = 0.146  per(accum) = 9.96
 T(local oper_env: construct opS [ifdists=true] ) = 1.461e-02 S  per =   87  per(accum) = 97
 T(local oper_env: reduction of opS & opH [nccl]) = 2.107e-05 S  per = 0.125  per(accum) = 97.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.223e-05 S  per = 0.252  per(accum) = 97.3
 T(local oper_env: reduction of opS & opH [mpi] ) = 9.120e-06 S  per = 0.0543  per(accum) = 97.4
 T(local oper_env: qops_pool join and erase     ) = 4.367e-04 S  per =  2.6  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.130e-07 S  per = 0.00246  per(accum) = 100
##### sweep oper_env: 5.060e-02 S #####
 T(sweep oper_env: fetch) = 9.719e-03 S  per = 19.2  per(accum) = 19.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 19.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 19.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 19.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 19.2
 T(sweep oper_env: renrm) = 3.678e-02 S  per = 72.7  per(accum) = 91.9
 T(sweep oper_env: save ) = 4.093e-03 S  per = 8.09  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -5.207e+09 S  per = -5.207e+31
 T(sweep oper_env: preprocess                  ) = -5.207e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.678e-02 S  T(sum) = 3.678e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 8.831e-05 S  per = 0.24  per(accum) = 0.24
 T(sweep oper_env: qops init                    ) = 7.494e-04 S  per = 2.04  per(accum) = 2.28
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.584e-04 S  per = 0.431  per(accum) = 2.71
 T(sweep oper_env: allocate qops on gpu         ) = 1.685e-04 S  per = 0.458  per(accum) = 3.17
 T(sweep oper_env: site memcpy cpu2gpu          ) = 7.980e-05 S  per = 0.217  per(accum) = 3.38
 T(sweep oper_env: rintermediate init           ) = 1.343e-04 S  per = 0.365  per(accum) = 3.75
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.809e-04 S  per = 0.764  per(accum) = 4.51
 T(sweep oper_env: rmmtasks init                ) = 3.539e-04 S  per = 0.962  per(accum) = 5.47
 T(sweep oper_env: qops memset on cpu           ) = 9.500e-08 S  per = 0.000258  per(accum) = 5.47
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.323e-03 S  per = 6.31  per(accum) = 11.8
 T(sweep oper_env: deallocate cpu and gpu memory) = 7.690e-05 S  per = 0.209  per(accum) = 12
 T(sweep oper_env: construct opS [ifdists=true] ) = 2.992e-02 S  per = 81.3  per(accum) = 93.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.717e-04 S  per = 1.83  per(accum) = 95.1
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.250e-04 S  per = 0.34  per(accum) = 95.5
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 6.608e-05 S  per = 0.18  per(accum) = 95.7
 T(sweep oper_env: qops_pool join and erase     ) = 1.592e-03 S  per = 4.33  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.440e-06 S  per = 0.00391  per(accum) = 100

idx=4 coord=(15,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=4 scratch=./scratch/sweep size=464:3.46e-06GB T(load)=3.11e-04S speed=1.11e-02GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHAB nops=C:8 S:16 H:1 A:14 B:18 
        dim(bra,ket)=24,24 size(op)=104:0.000793MB size(tot)=2908:0.0222MB:2.17e-05GB
        per(mem): C:16 S:24.8 H:3.58 A:14.2 B:41.5 
ctns::oper_renorm coord=(15,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:10 S:15 H:1 A:22 B:28 
        dim(bra,ket)=42,42 size(op)=270:0.00206MB size(tot)=11084:0.0846MB:8.26e-05GB
        per(mem): C:15.2 S:18.4 H:2.44 A:17.6 B:46.4 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.770e-04 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=61 : 5.249e-05 S -----
rank=0 GPUmem(GB): used=1.217e-04 (oper)=1.217e-04
rank=0 GPUmem(GB): used=1.251e-04 (oper,site)=1.217e-04,3.457e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=61
 no. of rintermediate operators=7
 no. of coefficients=56:4.272e-04MB:4.172e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.564e-05 S -----
rank=0 GPUmem(GB): used=1.255e-04 (oper,site,rinter)=1.217e-04,3.457e-06,4.172e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.909e-04 S size(rtasks)=61 size(Rlst2)=64 T(Rmu/Rlist)=3.172e-05,1.591e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.185e-04 S size(rtasks)=61 size(Rlst)=714 -----
rank=0 GPUmem(GB): used=1.255e-04 avail=3.829e+01 total=3.829e+01 batch[need]=8.778e-04 blksize=64 blksize0=36 batchsize=714
rank=0 GPUmem(GB): used=1.003e-03 (oper,site,rinter,batch)=1.217e-04,3.457e-06,4.172e-07,8.778e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.219e-04,7.780e-04,1.821e-04
----- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=7.8e-04 t_reduction=1.8e-04 tot=1.1e-03 -----
 renorm[inter] counter=84 t=1.2e-04 per=1.1e+01 cost=3.3e+04 flops=2.7e+08
 renorm[gemm] counter=84 i=0 t=1.8e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=84 i=1 t=1.7e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=84 i=2 t=1.9e-04 per=1.8e+01 cost=2.9e+04 flops=1.5e+08
 renorm[gemm] counter=84 i=3 t=2.8e-04 per=2.6e+01 cost=1.0e+05 flops=3.7e+08
 renorm[gemm] counter=84 i=4 t=1.7e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=84 i=5 t=1.7e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=84 i=6 t=2.9e-04 per=2.7e+01 cost=2.2e+05 flops=7.6e+08
 renorm[gemm] counter=84 total t=7.8e-04 per=7.2e+01 cost=3.6e+05 flops=4.6e+08
 renorm[red] counter=84 t=1.8e-04 per=1.7e+01 cost=5.1e+04 flops=2.8e+08
----- TIMING FOR renorm_tot : t_inter=3.0e-04 t_gemm=2.0e-03 t_reduction=6.0e-04 tot=2.9e-03 -----
 renorm_tot[inter] counter=84 t=3.0e-04 per=1.1e+01 cost=3.8e+04 flops=1.2e+08
 renorm_tot[gemm] counter=84 i=0 t=1.0e-05 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=84 i=1 t=7.0e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=84 i=2 t=6.9e-04 per=2.4e+01 cost=3.3e+04 flops=4.8e+07
 renorm_tot[gemm] counter=84 i=3 t=6.4e-04 per=2.2e+01 cost=1.1e+05 flops=1.8e+08
 renorm_tot[gemm] counter=84 i=4 t=7.1e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=84 i=5 t=6.8e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=84 i=6 t=6.3e-04 per=2.2e+01 cost=2.6e+05 flops=4.0e+08
 renorm_tot[gemm] counter=84 total t=2.0e-03 per=6.9e+01 cost=4.0e+05 flops=2.0e+08
 renorm_tot[red] counter=84 t=6.0e-04 per=2.1e+01 cost=6.6e+04 flops=1.1e+08
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.341e-04 (oper)=1.231e-04
rank=0 GPUmem(GB): used=1.375e-04 (oper,site,rinter)=1.231e-04,3.457e-06,1.051e-05
rank=0 GPUmem(GB): used=2.088e-04 (oper,site,rinter,batch)=1.231e-04,3.457e-06,1.051e-05,7.130e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.731e-02 S T(preprocess/alloc/comp/red/dealloc)=1.676e-03,1.731e-03,1.297e-02,2.368e-03,1.837e-04 -----
----- TIMING FOR oper_renorm_opS : 1.735e-02 S rank=0 -----
qops.to_cpu: size(tot)=11084:8.456e-02MB:8.258e-05GB T(to_cpu)=4.671e-05S speed=1.768e+00GB/S
check ||H-H.dagger||=2.737e-14 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.0197 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=2.778e-04 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=4.349e-04 change=-1.156e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-6.542e-06 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 2.378e-02 S #####
 T(local oper_env: fetch) = 2.135e-03 S  per = 8.98  per(accum) = 8.98
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.98
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.98
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.98
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.98
 T(local oper_env: renrm) = 2.027e-02 S  per = 85.3  per(accum) = 94.2
 T(local oper_env: save ) = 1.371e-03 S  per = 5.77  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.027e-02 S  T(sum) = 2.027e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.224e-05 S  per = 0.0604  per(accum) = 0.0604
 T(local oper_env: qops init                    ) = 2.607e-04 S  per = 1.29  per(accum) = 1.35
 T(local oper_env: symbolic_formulae_renorm     ) = 6.211e-05 S  per = 0.306  per(accum) = 1.65
 T(local oper_env: allocate qops on gpu         ) = 4.666e-05 S  per = 0.23  per(accum) = 1.88
 T(local oper_env: site memcpy cpu2gpu          ) = 2.364e-05 S  per = 0.117  per(accum) = 2
 T(local oper_env: rintermediate init           ) = 3.833e-05 S  per = 0.189  per(accum) = 2.19
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.358e-04 S  per = 1.16  per(accum) = 3.35
 T(local oper_env: rmmtasks init                ) = 2.492e-04 S  per = 1.23  per(accum) = 4.58
 T(local oper_env: qops memset on cpu           ) = 3.000e-08 S  per = 0.000148  per(accum) = 4.58
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.238e-03 S  per = 6.11  per(accum) = 10.7
 T(local oper_env: deallocate cpu and gpu memory) = 2.476e-05 S  per = 0.122  per(accum) = 10.8
 T(local oper_env: construct opS [ifdists=true] ) = 1.737e-02 S  per = 85.7  per(accum) = 96.5
 T(local oper_env: reduction of opS & opH [nccl]) = 2.197e-05 S  per = 0.108  per(accum) = 96.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 5.799e-05 S  per = 0.286  per(accum) = 96.9
 T(local oper_env: reduction of opS & opH [mpi] ) = 4.987e-05 S  per = 0.246  per(accum) = 97.1
 T(local oper_env: qops_pool join and erase     ) = 5.815e-04 S  per = 2.87  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.580e-07 S  per = 0.00226  per(accum) = 100
##### sweep oper_env: 7.437e-02 S #####
 T(sweep oper_env: fetch) = 1.185e-02 S  per = 15.9  per(accum) = 15.9
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 15.9
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 15.9
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 15.9
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 15.9
 T(sweep oper_env: renrm) = 5.706e-02 S  per = 76.7  per(accum) = 92.7
 T(sweep oper_env: save ) = 5.464e-03 S  per = 7.35  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -6.943e+09 S  per = -6.943e+31
 T(sweep oper_env: preprocess                  ) = -6.943e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 5.706e-02 S  T(sum) = 5.706e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.005e-04 S  per = 0.176  per(accum) = 0.176
 T(sweep oper_env: qops init                    ) = 1.010e-03 S  per = 1.77  per(accum) = 1.95
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.205e-04 S  per = 0.386  per(accum) = 2.33
 T(sweep oper_env: allocate qops on gpu         ) = 2.152e-04 S  per = 0.377  per(accum) = 2.71
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.034e-04 S  per = 0.181  per(accum) = 2.89
 T(sweep oper_env: rintermediate init           ) = 1.727e-04 S  per = 0.303  per(accum) = 3.19
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.167e-04 S  per = 0.906  per(accum) = 4.1
 T(sweep oper_env: rmmtasks init                ) = 6.031e-04 S  per = 1.06  per(accum) = 5.16
 T(sweep oper_env: qops memset on cpu           ) = 1.250e-07 S  per = 0.000219  per(accum) = 5.16
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.561e-03 S  per = 6.24  per(accum) = 11.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.017e-04 S  per = 0.178  per(accum) = 11.6
 T(sweep oper_env: construct opS [ifdists=true] ) = 4.728e-02 S  per = 82.9  per(accum) = 94.4
 T(sweep oper_env: reduction of opS & opH [nccl]) = 6.937e-04 S  per = 1.22  per(accum) = 95.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.830e-04 S  per = 0.321  per(accum) = 96
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.160e-04 S  per = 0.203  per(accum) = 96.2
 T(sweep oper_env: qops_pool join and erase     ) = 2.173e-03 S  per = 3.81  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.898e-06 S  per = 0.00333  per(accum) = 100

idx=5 coord=(14,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=5 scratch=./scratch/sweep size=1021:7.61e-06GB T(load)=2.91e-04S speed=2.62e-02GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHAB nops=C:10 S:15 H:1 A:22 B:28 
        dim(bra,ket)=42,42 size(op)=270:0.00206MB size(tot)=11084:0.0846MB:8.26e-05GB
        per(mem): C:15.2 S:18.4 H:2.44 A:17.6 B:46.4 
ctns::oper_renorm coord=(14,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:12 S:14 H:1 A:33 B:39 
        dim(bra,ket)=58,58 size(op)=472:0.0036MB size(tot)=25825:0.197MB:0.000192GB
        per(mem): C:13.4 S:13.2 H:1.83 A:20.7 B:50.9 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.042e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=85 : 7.087e-05 S -----
rank=0 GPUmem(GB): used=2.924e-04 (oper)=2.924e-04
rank=0 GPUmem(GB): used=3.000e-04 (oper,site)=2.924e-04,7.607e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=85
 no. of rintermediate operators=7
 no. of coefficients=85:6.485e-04MB:6.333e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.127e-05 S -----
rank=0 GPUmem(GB): used=3.006e-04 (oper,site,rinter)=2.924e-04,7.607e-06,6.333e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 2.736e-04 S size(rtasks)=85 size(Rlst2)=81 T(Rmu/Rlist)=4.519e-05,2.284e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.191e-04 S size(rtasks)=85 size(Rlst)=1079 -----
rank=0 GPUmem(GB): used=3.006e-04 avail=3.829e+01 total=3.829e+01 batch[need]=2.468e-03 blksize=121 blksize0=64 batchsize=1079
rank=0 GPUmem(GB): used=2.769e-03 (oper,site,rinter,batch)=2.924e-04,7.607e-06,6.333e-07,2.468e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.287e-04,8.186e-04,2.262e-04
----- TIMING FOR renorm : t_inter=1.3e-04 t_gemm=8.2e-04 t_reduction=2.3e-04 tot=1.2e-03 -----
 renorm[inter] counter=115 t=1.3e-04 per=1.1e+01 cost=1.3e+05 flops=1.0e+09
 renorm[gemm] counter=115 i=0 t=1.9e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=115 i=1 t=1.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=115 i=2 t=1.8e-04 per=1.5e+01 cost=1.3e+05 flops=7.2e+08
 renorm[gemm] counter=115 i=3 t=3.0e-04 per=2.6e+01 cost=4.9e+05 flops=1.6e+09
 renorm[gemm] counter=115 i=4 t=1.6e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=115 i=5 t=1.6e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=115 i=6 t=3.3e-04 per=2.8e+01 cost=8.4e+05 flops=2.6e+09
 renorm[gemm] counter=115 total t=8.2e-04 per=7.0e+01 cost=1.5e+06 flops=1.8e+09
 renorm[red] counter=115 t=2.3e-04 per=1.9e+01 cost=1.3e+05 flops=5.6e+08
----- TIMING FOR renorm_tot : t_inter=4.3e-04 t_gemm=2.8e-03 t_reduction=8.2e-04 tot=4.1e-03 -----
 renorm_tot[inter] counter=115 t=4.3e-04 per=1.1e+01 cost=1.7e+05 flops=3.9e+08
 renorm_tot[gemm] counter=115 i=0 t=1.2e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=115 i=1 t=8.7e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=115 i=2 t=8.7e-04 per=2.1e+01 cost=1.6e+05 flops=1.9e+08
 renorm_tot[gemm] counter=115 i=3 t=9.4e-04 per=2.3e+01 cost=6.0e+05 flops=6.4e+08
 renorm_tot[gemm] counter=115 i=4 t=8.7e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=115 i=5 t=8.4e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=115 i=6 t=9.6e-04 per=2.4e+01 cost=1.1e+06 flops=1.1e+09
 renorm_tot[gemm] counter=115 total t=2.8e-03 per=6.9e+01 cost=1.9e+06 flops=6.6e+08
 renorm_tot[red] counter=115 t=8.2e-04 per=2.0e+01 cost=1.9e+05 flops=2.3e+08
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.101e-04 (oper)=2.949e-04
rank=0 GPUmem(GB): used=3.177e-04 (oper,site,rinter)=2.949e-04,7.607e-06,1.460e-05
rank=0 GPUmem(GB): used=4.412e-04 (oper,site,rinter,batch)=2.949e-04,7.607e-06,1.460e-05,1.234e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.631e-02 S T(preprocess/alloc/comp/red/dealloc)=1.799e-03,1.867e-03,1.273e-02,1.470e-03,1.904e-04 -----
----- TIMING FOR oper_renorm_opS : 1.636e-02 S rank=0 -----
qops.to_cpu: size(tot)=25825:1.970e-01MB:1.924e-04GB T(to_cpu)=7.122e-05S speed=2.702e+00GB/S
check ||H-H.dagger||=3.531e-14 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.0194 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=4.823e-04 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=1.755e-04 change=-1.338e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.109e-05 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 2.391e-02 S #####
 T(local oper_env: fetch) = 2.177e-03 S  per = 9.11  per(accum) = 9.11
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 9.11
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 9.11
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 9.11
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 9.11
 T(local oper_env: renrm) = 1.990e-02 S  per = 83.3  per(accum) = 92.4
 T(local oper_env: save ) = 1.826e-03 S  per = 7.64  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.990e-02 S  T(sum) = 1.990e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 6.992e-06 S  per = 0.0351  per(accum) = 0.0351
 T(local oper_env: qops init                    ) = 3.238e-04 S  per = 1.63  per(accum) = 1.66
 T(local oper_env: symbolic_formulae_renorm     ) = 8.167e-05 S  per = 0.41  per(accum) = 2.07
 T(local oper_env: allocate qops on gpu         ) = 4.987e-05 S  per = 0.251  per(accum) = 2.32
 T(local oper_env: site memcpy cpu2gpu          ) = 2.212e-05 S  per = 0.111  per(accum) = 2.43
 T(local oper_env: rintermediate init           ) = 5.514e-05 S  per = 0.277  per(accum) = 2.71
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.295e-04 S  per = 1.66  per(accum) = 4.37
 T(local oper_env: rmmtasks init                ) = 5.391e-04 S  per = 2.71  per(accum) = 7.08
 T(local oper_env: qops memset on cpu           ) = 2.600e-08 S  per = 0.000131  per(accum) = 7.08
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.328e-03 S  per = 6.67  per(accum) = 13.7
 T(local oper_env: deallocate cpu and gpu memory) = 1.682e-04 S  per = 0.845  per(accum) = 14.6
 T(local oper_env: construct opS [ifdists=true] ) = 1.638e-02 S  per = 82.3  per(accum) = 96.9
 T(local oper_env: reduction of opS & opH [nccl]) = 2.257e-05 S  per = 0.113  per(accum) = 97
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.234e-05 S  per = 0.414  per(accum) = 97.4
 T(local oper_env: reduction of opS & opH [mpi] ) = 4.463e-05 S  per = 0.224  per(accum) = 97.6
 T(local oper_env: qops_pool join and erase     ) = 4.700e-04 S  per = 2.36  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.430e-07 S  per = 0.00223  per(accum) = 100
##### sweep oper_env: 9.828e-02 S #####
 T(sweep oper_env: fetch) = 1.403e-02 S  per = 14.3  per(accum) = 14.3
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 14.3
 T(sweep oper_env: renrm) = 7.696e-02 S  per = 78.3  per(accum) = 92.6
 T(sweep oper_env: save ) = 7.290e-03 S  per = 7.42  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -8.679e+09 S  per = -8.679e+31
 T(sweep oper_env: preprocess                  ) = -8.679e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 7.696e-02 S  T(sum) = 7.696e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.075e-04 S  per = 0.14  per(accum) = 0.14
 T(sweep oper_env: qops init                    ) = 1.334e-03 S  per = 1.73  per(accum) = 1.87
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.022e-04 S  per = 0.393  per(accum) = 2.27
 T(sweep oper_env: allocate qops on gpu         ) = 2.651e-04 S  per = 0.344  per(accum) = 2.61
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.256e-04 S  per = 0.163  per(accum) = 2.77
 T(sweep oper_env: rintermediate init           ) = 2.278e-04 S  per = 0.296  per(accum) = 3.07
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 8.462e-04 S  per =  1.1  per(accum) = 4.17
 T(sweep oper_env: rmmtasks init                ) = 1.142e-03 S  per = 1.48  per(accum) = 5.65
 T(sweep oper_env: qops memset on cpu           ) = 1.510e-07 S  per = 0.000196  per(accum) = 5.65
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 4.888e-03 S  per = 6.35  per(accum) = 12
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.699e-04 S  per = 0.351  per(accum) = 12.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 6.366e-02 S  per = 82.7  per(accum) = 95.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 7.162e-04 S  per = 0.931  per(accum) = 96
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.654e-04 S  per = 0.345  per(accum) = 96.4
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 1.606e-04 S  per = 0.209  per(accum) = 96.6
 T(sweep oper_env: qops_pool join and erase     ) = 2.643e-03 S  per = 3.43  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.341e-06 S  per = 0.00304  per(accum) = 100

idx=6 coord=(13,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=6 scratch=./scratch/sweep size=1493:1.11e-05GB T(load)=2.77e-04S speed=4.02e-02GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHAB nops=C:12 S:14 H:1 A:33 B:39 
        dim(bra,ket)=58,58 size(op)=472:0.0036MB size(tot)=25825:0.197MB:0.000192GB
        per(mem): C:13.4 S:13.2 H:1.83 A:20.7 B:50.9 
ctns::oper_renorm coord=(13,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:14 S:13 H:1 A:47 B:51 
        dim(bra,ket)=68,68 size(op)=652:0.00497MB size(tot)=45154:0.344MB:0.000336GB
        per(mem): C:11.3 S:9.33 H:1.44 A:23.4 B:54.5 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.089e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=113 : 8.607e-05 S -----
rank=0 GPUmem(GB): used=5.462e-04 (oper)=5.462e-04
rank=0 GPUmem(GB): used=5.574e-04 (oper,site)=5.462e-04,1.112e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=113
 no. of rintermediate operators=7
 no. of coefficients=120:9.155e-04MB:8.941e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.155e-05 S -----
rank=0 GPUmem(GB): used=5.583e-04 (oper,site,rinter)=5.462e-04,1.112e-05,8.941e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 3.469e-04 S size(rtasks)=113 size(Rlst2)=81 T(Rmu/Rlist)=5.776e-05,2.891e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.452e-04 S size(rtasks)=113 size(Rlst)=1419 -----
rank=0 GPUmem(GB): used=5.583e-04 avail=3.829e+01 total=3.829e+01 batch[need]=5.434e-03 blksize=196 blksize0=121 batchsize=1419
rank=0 GPUmem(GB): used=5.992e-03 (oper,site,rinter,batch)=5.462e-04,1.112e-05,8.941e-07,5.434e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.200e-04,1.338e-03,3.500e-04
----- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=1.3e-03 t_reduction=3.5e-04 tot=1.8e-03 -----
 renorm[inter] counter=144 t=1.2e-04 per=6.6e+00 cost=3.0e+05 flops=2.5e+09
 renorm[gemm] counter=144 i=0 t=1.8e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=144 i=1 t=1.6e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=144 i=2 t=3.0e-04 per=1.7e+01 cost=2.6e+05 flops=8.6e+08
 renorm[gemm] counter=144 i=3 t=5.1e-04 per=2.8e+01 cost=1.2e+06 flops=2.4e+09
 renorm[gemm] counter=144 i=4 t=1.7e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=144 i=5 t=1.6e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=144 i=6 t=5.2e-04 per=2.9e+01 cost=1.8e+06 flops=3.4e+09
 renorm[gemm] counter=144 total t=1.3e-03 per=7.4e+01 cost=3.3e+06 flops=2.4e+09
 renorm[red] counter=144 t=3.5e-04 per=1.9e+01 cost=2.2e+05 flops=6.3e+08
----- TIMING FOR renorm_tot : t_inter=5.5e-04 t_gemm=4.1e-03 t_reduction=1.2e-03 tot=5.9e-03 -----
 renorm_tot[inter] counter=144 t=5.5e-04 per=9.4e+00 cost=4.7e+05 flops=8.4e+08
 renorm_tot[gemm] counter=144 i=0 t=1.4e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=144 i=1 t=1.0e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=144 i=2 t=1.2e-03 per=2.0e+01 cost=4.2e+05 flops=3.6e+08
 renorm_tot[gemm] counter=144 i=3 t=1.4e-03 per=2.5e+01 cost=1.8e+06 flops=1.3e+09
 renorm_tot[gemm] counter=144 i=4 t=1.0e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=144 i=5 t=1.0e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=144 i=6 t=1.5e-03 per=2.5e+01 cost=2.9e+06 flops=2.0e+09
 renorm_tot[gemm] counter=144 total t=4.1e-03 per=7.1e+01 cost=5.1e+06 flops=1.2e+09
 renorm_tot[red] counter=144 t=1.2e-03 per=2.0e+01 cost=4.1e+05 flops=3.5e+08
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=5.691e-04 (oper)=5.493e-04
rank=0 GPUmem(GB): used=5.802e-04 (oper,site,rinter)=5.493e-04,1.112e-05,1.889e-05
rank=0 GPUmem(GB): used=7.820e-04 (oper,site,rinter,batch)=5.493e-04,1.112e-05,1.889e-05,2.018e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.785e-02 S T(preprocess/alloc/comp/red/dealloc)=1.766e-03,1.833e-03,1.312e-02,2.678e-03,1.754e-04 -----
----- TIMING FOR oper_renorm_opS : 1.789e-02 S rank=0 -----
qops.to_cpu: size(tot)=45154:3.445e-01MB:3.364e-04GB T(to_cpu)=9.439e-05S speed=3.564e+00GB/S
check ||H-H.dagger||=5.289e-14 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.0221 S rank=0 -----
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=7.153e-04 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=1.343e-03 change=-1.602e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.563e-05 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 2.635e-02 S #####
 T(local oper_env: fetch) = 2.185e-03 S  per = 8.29  per(accum) = 8.29
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.29
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.29
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.29
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.29
 T(local oper_env: renrm) = 2.268e-02 S  per = 86.1  per(accum) = 94.4
 T(local oper_env: save ) = 1.485e-03 S  per = 5.64  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.268e-02 S  T(sum) = 2.268e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.175e-05 S  per = 0.0518  per(accum) = 0.0518
 T(local oper_env: qops init                    ) = 3.702e-04 S  per = 1.63  per(accum) = 1.68
 T(local oper_env: symbolic_formulae_renorm     ) = 9.626e-05 S  per = 0.424  per(accum) = 2.11
 T(local oper_env: allocate qops on gpu         ) = 5.009e-05 S  per = 0.221  per(accum) = 2.33
 T(local oper_env: site memcpy cpu2gpu          ) = 2.173e-05 S  per = 0.0958  per(accum) = 2.43
 T(local oper_env: rintermediate init           ) = 4.388e-05 S  per = 0.193  per(accum) = 2.62
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.621e-04 S  per = 2.92  per(accum) = 5.54
 T(local oper_env: rmmtasks init                ) = 6.187e-04 S  per = 2.73  per(accum) = 8.27
 T(local oper_env: qops memset on cpu           ) = 3.000e-08 S  per = 0.000132  per(accum) = 8.27
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.966e-03 S  per = 8.67  per(accum) = 16.9
 T(local oper_env: deallocate cpu and gpu memory) = 1.588e-04 S  per =  0.7  per(accum) = 17.6
 T(local oper_env: construct opS [ifdists=true] ) = 1.795e-02 S  per = 79.1  per(accum) = 96.8
 T(local oper_env: reduction of opS & opH [nccl]) = 2.252e-05 S  per = 0.0993  per(accum) = 96.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.061e-04 S  per = 0.468  per(accum) = 97.3
 T(local oper_env: reduction of opS & opH [mpi] ) = 4.324e-05 S  per = 0.191  per(accum) = 97.5
 T(local oper_env: qops_pool join and erase     ) = 5.579e-04 S  per = 2.46  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.930e-07 S  per = 0.00217  per(accum) = 100
##### sweep oper_env: 1.246e-01 S #####
 T(sweep oper_env: fetch) = 1.622e-02 S  per =   13  per(accum) = 13
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 13
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 13
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 13
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 13
 T(sweep oper_env: renrm) = 9.964e-02 S  per = 79.9  per(accum) = 93
 T(sweep oper_env: save ) = 8.775e-03 S  per = 7.04  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.041e+10 S  per = -1.041e+32
 T(sweep oper_env: preprocess                  ) = -1.041e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.964e-02 S  T(sum) = 9.964e-02 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.193e-04 S  per = 0.12  per(accum) = 0.12
 T(sweep oper_env: qops init                    ) = 1.704e-03 S  per = 1.71  per(accum) = 1.83
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.984e-04 S  per =  0.4  per(accum) = 2.23
 T(sweep oper_env: allocate qops on gpu         ) = 3.152e-04 S  per = 0.316  per(accum) = 2.55
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.473e-04 S  per = 0.148  per(accum) = 2.69
 T(sweep oper_env: rintermediate init           ) = 2.717e-04 S  per = 0.273  per(accum) = 2.97
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.508e-03 S  per = 1.51  per(accum) = 4.48
 T(sweep oper_env: rmmtasks init                ) = 1.761e-03 S  per = 1.77  per(accum) = 6.25
 T(sweep oper_env: qops memset on cpu           ) = 1.810e-07 S  per = 0.000182  per(accum) = 6.25
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.855e-03 S  per = 6.88  per(accum) = 13.1
 T(sweep oper_env: deallocate cpu and gpu memory) = 4.287e-04 S  per = 0.43  per(accum) = 13.6
 T(sweep oper_env: construct opS [ifdists=true] ) = 8.161e-02 S  per = 81.9  per(accum) = 95.5
 T(sweep oper_env: reduction of opS & opH [nccl]) = 7.388e-04 S  per = 0.741  per(accum) = 96.2
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 3.714e-04 S  per = 0.373  per(accum) = 96.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.038e-04 S  per = 0.205  per(accum) = 96.8
 T(sweep oper_env: qops_pool join and erase     ) = 3.201e-03 S  per = 3.21  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 2.834e-06 S  per = 0.00284  per(accum) = 100

idx=7 coord=(12,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=7 scratch=./scratch/sweep size=1941:1.45e-05GB T(load)=2.91e-04S speed=4.98e-02GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHAB nops=C:14 S:13 H:1 A:47 B:51 
        dim(bra,ket)=68,68 size(op)=652:0.00497MB size(tot)=45154:0.344MB:0.000336GB
        per(mem): C:11.3 S:9.33 H:1.44 A:23.4 B:54.5 
ctns::oper_renorm coord=(12,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:16 S:12 H:1 A:60 B:68 
        dim(bra,ket)=77,77 size(op)=845:0.00645MB size(tot)=74671:0.57MB:0.000556GB
        per(mem): C:9.43 S:6.59 H:1.13 A:24.8 B:58.1 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.141e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=145 : 1.108e-04 S -----
rank=0 GPUmem(GB): used=9.102e-04 (oper)=9.102e-04
rank=0 GPUmem(GB): used=9.246e-04 (oper,site)=9.102e-04,1.446e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=145
 no. of rintermediate operators=7
 no. of coefficients=157:1.198e-03MB:1.170e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.808e-05 S -----
rank=0 GPUmem(GB): used=9.258e-04 (oper,site,rinter)=9.102e-04,1.446e-05,1.170e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 4.428e-04 S size(rtasks)=145 size(Rlst2)=81 T(Rmu/Rlist)=7.507e-05,3.677e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.710e-04 S size(rtasks)=145 size(Rlst)=1735 -----
rank=0 GPUmem(GB): used=9.258e-04 avail=3.829e+01 total=3.829e+01 batch[need]=8.364e-03 blksize=225 blksize0=196 batchsize=1735
rank=0 GPUmem(GB): used=9.289e-03 (oper,site,rinter,batch)=9.102e-04,1.446e-05,1.170e-06,8.364e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.518e-04,1.090e-03,2.421e-04
----- TIMING FOR renorm : t_inter=1.5e-04 t_gemm=1.1e-03 t_reduction=2.4e-04 tot=1.5e-03 -----
 renorm[inter] counter=171 t=1.5e-04 per=1.0e+01 cost=5.2e+05 flops=3.4e+09
 renorm[gemm] counter=171 i=0 t=2.4e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=171 i=1 t=1.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=171 i=2 t=2.8e-04 per=1.9e+01 cost=4.1e+05 flops=1.5e+09
 renorm[gemm] counter=171 i=3 t=4.6e-04 per=3.1e+01 cost=2.4e+06 flops=5.1e+09
 renorm[gemm] counter=171 i=4 t=1.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=171 i=5 t=1.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=171 i=6 t=3.4e-04 per=2.3e+01 cost=3.3e+06 flops=9.6e+09
 renorm[gemm] counter=171 total t=1.1e-03 per=7.3e+01 cost=6.1e+06 flops=5.6e+09
 renorm[red] counter=171 t=2.4e-04 per=1.6e+01 cost=3.6e+05 flops=1.5e+09
----- TIMING FOR renorm_tot : t_inter=7.1e-04 t_gemm=5.2e-03 t_reduction=1.4e-03 tot=7.4e-03 -----
 renorm_tot[inter] counter=171 t=7.1e-04 per=9.6e+00 cost=9.9e+05 flops=1.4e+09
 renorm_tot[gemm] counter=171 i=0 t=1.6e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=171 i=1 t=1.2e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=171 i=2 t=1.4e-03 per=2.0e+01 cost=8.2e+05 flops=5.7e+08
 renorm_tot[gemm] counter=171 i=3 t=1.9e-03 per=2.6e+01 cost=4.2e+06 flops=2.2e+09
 renorm_tot[gemm] counter=171 i=4 t=1.2e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=171 i=5 t=1.2e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=171 i=6 t=1.8e-03 per=2.5e+01 cost=6.2e+06 flops=3.4e+09
 renorm_tot[gemm] counter=171 total t=5.2e-03 per=7.1e+01 cost=1.1e+07 flops=2.1e+09
 renorm_tot[red] counter=171 t=1.4e-03 per=1.9e+01 cost=7.7e+05 flops=5.4e+08
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=9.377e-04 (oper)=9.137e-04
rank=0 GPUmem(GB): used=9.522e-04 (oper,site,rinter)=9.137e-04,1.446e-05,2.289e-05
rank=0 GPUmem(GB): used=1.242e-03 (oper,site,rinter,batch)=9.137e-04,1.446e-05,2.289e-05,2.896e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.835e-02 S T(preprocess/alloc/comp/red/dealloc)=1.791e-03,1.860e-03,1.371e-02,2.574e-03,1.715e-04 -----
----- TIMING FOR oper_renorm_opS : 1.839e-02 S rank=0 -----
qops.to_cpu: size(tot)=74671:5.697e-01MB:5.563e-04GB T(to_cpu)=1.351e-04S speed=4.117e+00GB/S
check ||H-H.dagger||=5.884e-14 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.0224 S rank=0 -----
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.017e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=1.503e-03 change=-1.876e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-1.945e-05 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 2.679e-02 S #####
 T(local oper_env: fetch) = 2.176e-03 S  per = 8.12  per(accum) = 8.12
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.12
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.12
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.12
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.12
 T(local oper_env: renrm) = 2.298e-02 S  per = 85.8  per(accum) = 93.9
 T(local oper_env: save ) = 1.629e-03 S  per = 6.08  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.298e-02 S  T(sum) = 2.298e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.665e-05 S  per = 0.0724  per(accum) = 0.0724
 T(local oper_env: qops init                    ) = 3.953e-04 S  per = 1.72  per(accum) = 1.79
 T(local oper_env: symbolic_formulae_renorm     ) = 1.220e-04 S  per = 0.531  per(accum) = 2.32
 T(local oper_env: allocate qops on gpu         ) = 5.186e-05 S  per = 0.226  per(accum) = 2.55
 T(local oper_env: site memcpy cpu2gpu          ) = 2.373e-05 S  per = 0.103  per(accum) = 2.65
 T(local oper_env: rintermediate init           ) = 5.473e-05 S  per = 0.238  per(accum) = 2.89
 T(local oper_env: preprocess_formulae_Rlist2   ) = 5.836e-04 S  per = 2.54  per(accum) = 5.43
 T(local oper_env: rmmtasks init                ) = 7.860e-04 S  per = 3.42  per(accum) = 8.85
 T(local oper_env: qops memset on cpu           ) = 5.800e-08 S  per = 0.000252  per(accum) = 8.85
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.649e-03 S  per = 7.18  per(accum) = 16
 T(local oper_env: deallocate cpu and gpu memory) = 1.683e-04 S  per = 0.732  per(accum) = 16.8
 T(local oper_env: construct opS [ifdists=true] ) = 1.841e-02 S  per = 80.1  per(accum) = 96.9
 T(local oper_env: reduction of opS & opH [nccl]) = 2.261e-05 S  per = 0.0984  per(accum) = 97
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.475e-04 S  per = 0.642  per(accum) = 97.6
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.313e-05 S  per = 0.0571  per(accum) = 97.7
 T(local oper_env: qops_pool join and erase     ) = 5.343e-04 S  per = 2.33  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.380e-07 S  per = 0.00191  per(accum) = 100
##### sweep oper_env: 1.514e-01 S #####
 T(sweep oper_env: fetch) = 1.839e-02 S  per = 12.1  per(accum) = 12.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 12.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 12.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 12.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 12.1
 T(sweep oper_env: renrm) = 1.226e-01 S  per =   81  per(accum) = 93.1
 T(sweep oper_env: save ) = 1.040e-02 S  per = 6.87  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.215e+10 S  per = -1.215e+32
 T(sweep oper_env: preprocess                  ) = -1.215e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.226e-01 S  T(sum) = 1.226e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.359e-04 S  per = 0.111  per(accum) = 0.111
 T(sweep oper_env: qops init                    ) = 2.099e-03 S  per = 1.71  per(accum) = 1.82
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.204e-04 S  per = 0.424  per(accum) = 2.25
 T(sweep oper_env: allocate qops on gpu         ) = 3.670e-04 S  per = 0.299  per(accum) = 2.55
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.710e-04 S  per = 0.139  per(accum) = 2.69
 T(sweep oper_env: rintermediate init           ) = 3.264e-04 S  per = 0.266  per(accum) = 2.95
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.092e-03 S  per = 1.71  per(accum) = 4.66
 T(sweep oper_env: rmmtasks init                ) = 2.547e-03 S  per = 2.08  per(accum) = 6.74
 T(sweep oper_env: qops memset on cpu           ) = 2.390e-07 S  per = 0.000195  per(accum) = 6.74
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 8.504e-03 S  per = 6.94  per(accum) = 13.7
 T(sweep oper_env: deallocate cpu and gpu memory) = 5.970e-04 S  per = 0.487  per(accum) = 14.2
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.000e-01 S  per = 81.6  per(accum) = 95.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 7.614e-04 S  per = 0.621  per(accum) = 96.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 5.190e-04 S  per = 0.423  per(accum) = 96.8
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.170e-04 S  per = 0.177  per(accum) = 97
 T(sweep oper_env: qops_pool join and erase     ) = 3.735e-03 S  per = 3.05  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.272e-06 S  per = 0.00267  per(accum) = 100

idx=8 coord=(11,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=8 scratch=./scratch/sweep size=2137:1.59e-05GB T(load)=2.92e-04S speed=5.46e-02GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHAB nops=C:16 S:12 H:1 A:60 B:68 
        dim(bra,ket)=77,77 size(op)=845:0.00645MB size(tot)=74671:0.57MB:0.000556GB
        per(mem): C:9.43 S:6.59 H:1.13 A:24.8 B:58.1 
ctns::oper_renorm coord=(11,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:18 S:11 H:1 A:78 B:84 
        dim(bra,ket)=74,74 size(op)=818:0.00624MB size(tot)=86243:0.658MB:0.000643GB
        per(mem): C:9.09 S:5.29 H:0.948 A:24.5 B:60.1 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.199e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=181 : 1.335e-04 S -----
rank=0 GPUmem(GB): used=1.216e-03 (oper)=1.216e-03
rank=0 GPUmem(GB): used=1.232e-03 (oper,site)=1.216e-03,1.592e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=181
 no. of rintermediate operators=7
 no. of coefficients=208:1.587e-03MB:1.550e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.136e-05 S -----
rank=0 GPUmem(GB): used=1.234e-03 (oper,site,rinter)=1.216e-03,1.592e-05,1.550e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 5.127e-04 S size(rtasks)=181 size(Rlst2)=81 T(Rmu/Rlist)=9.332e-05,4.194e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.028e-04 S size(rtasks)=181 size(Rlst)=2162 -----
rank=0 GPUmem(GB): used=1.234e-03 avail=3.829e+01 total=3.829e+01 batch[need]=1.089e-02 blksize=225 blksize0=225 batchsize=2162
rank=0 GPUmem(GB): used=1.212e-02 (oper,site,rinter,batch)=1.216e-03,1.592e-05,1.550e-06,1.089e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.214e-04,1.100e-03,3.417e-04
----- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=1.1e-03 t_reduction=3.4e-04 tot=1.6e-03 -----
 renorm[inter] counter=196 t=1.2e-04 per=7.8e+00 cost=8.8e+05 flops=7.3e+09
 renorm[gemm] counter=196 i=0 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=196 i=1 t=1.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=196 i=2 t=2.4e-04 per=1.6e+01 cost=5.4e+05 flops=2.2e+09
 renorm[gemm] counter=196 i=3 t=4.1e-04 per=2.6e+01 cost=3.8e+06 flops=9.3e+09
 renorm[gemm] counter=196 i=4 t=1.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=196 i=5 t=1.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=196 i=6 t=4.4e-04 per=2.8e+01 cost=4.4e+06 flops=1.0e+10
 renorm[gemm] counter=196 total t=1.1e-03 per=7.0e+01 cost=8.7e+06 flops=8.0e+09
 renorm[red] counter=196 t=3.4e-04 per=2.2e+01 cost=4.3e+05 flops=1.3e+09
----- TIMING FOR renorm_tot : t_inter=8.3e-04 t_gemm=6.3e-03 t_reduction=1.8e-03 tot=8.9e-03 -----
 renorm_tot[inter] counter=196 t=8.3e-04 per=9.3e+00 cost=1.9e+06 flops=2.3e+09
 renorm_tot[gemm] counter=196 i=0 t=1.8e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=196 i=1 t=1.4e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=196 i=2 t=1.7e-03 per=1.9e+01 cost=1.4e+06 flops=8.1e+08
 renorm_tot[gemm] counter=196 i=3 t=2.3e-03 per=2.6e+01 cost=8.0e+06 flops=3.4e+09
 renorm_tot[gemm] counter=196 i=4 t=1.4e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=196 i=5 t=1.3e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=196 i=6 t=2.3e-03 per=2.5e+01 cost=1.1e+07 flops=4.7e+09
 renorm_tot[gemm] counter=196 total t=6.3e-03 per=7.1e+01 cost=2.0e+07 flops=3.2e+09
 renorm_tot[red] counter=196 t=1.8e-03 per=2.0e+01 cost=1.2e+06 flops=6.8e+08
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.248e-03 (oper)=1.220e-03
rank=0 GPUmem(GB): used=1.264e-03 (oper,site,rinter)=1.220e-03,1.592e-05,2.721e-05
rank=0 GPUmem(GB): used=1.582e-03 (oper,site,rinter,batch)=1.220e-03,1.592e-05,2.721e-05,3.173e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.551e-02 S T(preprocess/alloc/comp/red/dealloc)=1.819e-03,1.881e-03,1.121e-02,2.219e-03,1.606e-04 -----
----- TIMING FOR oper_renorm_opS : 1.555e-02 S rank=0 -----
qops.to_cpu: size(tot)=86243:6.580e-01MB:6.426e-04GB T(to_cpu)=3.821e-04S speed=1.682e+00GB/S
check ||H-H.dagger||=6.932e-14 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.0202 S rank=0 -----
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=0.000e+00 change=1.214e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=1.709e-03 change=-2.245e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-2.326e-05 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 2.470e-02 S #####
 T(local oper_env: fetch) = 2.216e-03 S  per = 8.97  per(accum) = 8.97
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.97
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.97
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.97
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.97
 T(local oper_env: renrm) = 2.080e-02 S  per = 84.2  per(accum) = 93.2
 T(local oper_env: save ) = 1.682e-03 S  per = 6.81  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.080e-02 S  T(sum) = 2.080e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.652e-06 S  per = 0.0368  per(accum) = 0.0368
 T(local oper_env: qops init                    ) = 4.318e-04 S  per = 2.08  per(accum) = 2.11
 T(local oper_env: symbolic_formulae_renorm     ) = 1.448e-04 S  per = 0.696  per(accum) = 2.81
 T(local oper_env: allocate qops on gpu         ) = 5.004e-05 S  per = 0.241  per(accum) = 3.05
 T(local oper_env: site memcpy cpu2gpu          ) = 2.392e-05 S  per = 0.115  per(accum) = 3.16
 T(local oper_env: rintermediate init           ) = 4.826e-05 S  per = 0.232  per(accum) = 3.4
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.172e-04 S  per = 2.97  per(accum) = 6.36
 T(local oper_env: rmmtasks init                ) = 1.001e-03 S  per = 4.81  per(accum) = 11.2
 T(local oper_env: qops memset on cpu           ) = 4.400e-08 S  per = 0.000212  per(accum) = 11.2
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.715e-03 S  per = 8.25  per(accum) = 19.4
 T(local oper_env: deallocate cpu and gpu memory) = 1.693e-04 S  per = 0.814  per(accum) = 20.2
 T(local oper_env: construct opS [ifdists=true] ) = 1.557e-02 S  per = 74.8  per(accum) = 95.1
 T(local oper_env: reduction of opS & opH [nccl]) = 2.142e-05 S  per = 0.103  per(accum) = 95.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.985e-04 S  per = 1.92  per(accum) = 97.1
 T(local oper_env: reduction of opS & opH [mpi] ) = 5.167e-05 S  per = 0.248  per(accum) = 97.4
 T(local oper_env: qops_pool join and erase     ) = 5.503e-04 S  per = 2.65  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 5.250e-07 S  per = 0.00252  per(accum) = 100
##### sweep oper_env: 1.761e-01 S #####
 T(sweep oper_env: fetch) = 2.061e-02 S  per = 11.7  per(accum) = 11.7
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 11.7
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 11.7
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 11.7
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 11.7
 T(sweep oper_env: renrm) = 1.434e-01 S  per = 81.4  per(accum) = 93.1
 T(sweep oper_env: save ) = 1.209e-02 S  per = 6.86  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.389e+10 S  per = -1.389e+32
 T(sweep oper_env: preprocess                  ) = -1.389e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.434e-01 S  T(sum) = 1.434e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.436e-04 S  per =  0.1  per(accum) = 0.1
 T(sweep oper_env: qops init                    ) = 2.531e-03 S  per = 1.76  per(accum) = 1.87
 T(sweep oper_env: symbolic_formulae_renorm     ) = 6.652e-04 S  per = 0.464  per(accum) = 2.33
 T(sweep oper_env: allocate qops on gpu         ) = 4.170e-04 S  per = 0.291  per(accum) = 2.62
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.949e-04 S  per = 0.136  per(accum) = 2.76
 T(sweep oper_env: rintermediate init           ) = 3.747e-04 S  per = 0.261  per(accum) = 3.02
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.709e-03 S  per = 1.89  per(accum) = 4.91
 T(sweep oper_env: rmmtasks init                ) = 3.548e-03 S  per = 2.47  per(accum) = 7.38
 T(sweep oper_env: qops memset on cpu           ) = 2.830e-07 S  per = 0.000197  per(accum) = 7.38
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.022e-02 S  per = 7.13  per(accum) = 14.5
 T(sweep oper_env: deallocate cpu and gpu memory) = 7.662e-04 S  per = 0.534  per(accum) = 15
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.156e-01 S  per = 80.6  per(accum) = 95.6
 T(sweep oper_env: reduction of opS & opH [nccl]) = 7.828e-04 S  per = 0.546  per(accum) = 96.2
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 9.175e-04 S  per = 0.64  per(accum) = 96.8
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.686e-04 S  per = 0.187  per(accum) = 97
 T(sweep oper_env: qops_pool join and erase     ) = 4.286e-03 S  per = 2.99  per(accum) = 100
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.797e-06 S  per = 0.00265  per(accum) = 100

idx=9 coord=(10,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=9 scratch=./scratch/sweep size=2034:1.52e-05GB T(load)=2.91e-04S speed=5.21e-02GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHAB nops=C:18 S:11 H:1 A:78 B:84 
        dim(bra,ket)=74,74 size(op)=818:0.00624MB size(tot)=86243:0.658MB:0.000643GB
        per(mem): C:9.09 S:5.29 H:0.948 A:24.5 B:60.1 
ctns::oper_renorm coord=(10,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:20 S:10 H:1 A:95 B:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=86546:0.66MB:0.000645GB
        per(mem): C:9.16 S:4.68 H:0.708 A:26.6 B:58.9 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.416e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=221 : 1.571e-04 S -----
rank=0 GPUmem(GB): used=1.305e-03 (oper)=1.305e-03
rank=0 GPUmem(GB): used=1.320e-03 (oper,site)=1.305e-03,1.515e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=221
 no. of rintermediate operators=7
 no. of coefficients=257:1.961e-03MB:1.915e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.705e-05 S -----
rank=0 GPUmem(GB): used=1.322e-03 (oper,site,rinter)=1.305e-03,1.515e-05,1.915e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 8.184e-04 S size(rtasks)=221 size(Rlst2)=144 T(Rmu/Rlist)=1.103e-04,7.081e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.174e-03 S size(rtasks)=221 size(Rlst)=3486 -----
rank=0 GPUmem(GB): used=1.322e-03 avail=3.829e+01 total=3.829e+01 batch[need]=1.678e-02 blksize=210 blksize0=225 batchsize=3486
rank=0 GPUmem(GB): used=1.810e-02 (oper,site,rinter,batch)=1.305e-03,1.515e-05,1.915e-06,1.678e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.717e-04,1.876e-03,4.302e-04
----- TIMING FOR renorm : t_inter=1.7e-04 t_gemm=1.9e-03 t_reduction=4.3e-04 tot=2.5e-03 -----
 renorm[inter] counter=219 t=1.7e-04 per=6.9e+00 cost=1.3e+06 flops=7.3e+09
 renorm[gemm] counter=219 i=0 t=1.8e-06 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=219 i=1 t=1.7e-06 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=219 i=2 t=3.8e-04 per=1.6e+01 cost=5.8e+05 flops=1.5e+09
 renorm[gemm] counter=219 i=3 t=7.1e-04 per=2.9e+01 cost=4.9e+06 flops=6.8e+09
 renorm[gemm] counter=219 i=4 t=1.7e-06 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=219 i=5 t=1.6e-06 per=6.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=219 i=6 t=7.7e-04 per=3.1e+01 cost=4.3e+06 flops=5.6e+09
 renorm[gemm] counter=219 total t=1.9e-03 per=7.6e+01 cost=9.8e+06 flops=5.2e+09
 renorm[red] counter=219 t=4.3e-04 per=1.7e+01 cost=4.0e+05 flops=9.3e+08
----- TIMING FOR renorm_tot : t_inter=1.0e-03 t_gemm=8.2e-03 t_reduction=2.2e-03 tot=1.1e-02 -----
 renorm_tot[inter] counter=219 t=1.0e-03 per=8.8e+00 cost=3.1e+06 flops=3.1e+09
 renorm_tot[gemm] counter=219 i=0 t=2.0e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=219 i=1 t=1.5e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=219 i=2 t=2.1e-03 per=1.8e+01 cost=1.9e+06 flops=9.4e+08
 renorm_tot[gemm] counter=219 i=3 t=3.0e-03 per=2.7e+01 cost=1.3e+07 flops=4.2e+09
 renorm_tot[gemm] counter=219 i=4 t=1.6e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=219 i=5 t=1.5e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=219 i=6 t=3.0e-03 per=2.7e+01 cost=1.5e+07 flops=4.9e+09
 renorm_tot[gemm] counter=219 total t=8.2e-03 per=7.2e+01 cost=3.0e+07 flops=3.6e+09
 renorm_tot[red] counter=219 t=2.2e-03 per=1.9e+01 cost=1.6e+06 flops=7.3e+08
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.340e-03 (oper)=1.308e-03
rank=0 GPUmem(GB): used=1.355e-03 (oper,site,rinter)=1.308e-03,1.515e-05,3.062e-05
rank=0 GPUmem(GB): used=1.808e-03 (oper,site,rinter,batch)=1.308e-03,1.515e-05,3.062e-05,4.524e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.943e-02 S T(preprocess/alloc/comp/red/dealloc)=2.144e-03,2.391e-03,1.433e-02,2.404e-03,2.754e-04 -----
----- TIMING FOR oper_renorm_opS : 1.947e-02 S rank=0 -----
----- TIMING FOR oper_renorm : 2.599e-02 S rank=0 -----
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=7.019e-04 change=8.734e-04 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=2.663e-03 change=-2.697e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
ctns::oper_ab2pq coord=(10,0) superblock=cr alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=CSHPQ nops=C:20 S:10 H:1 P:95 Q:105 
        dim(bra,ket)=73,73 size(op)=613:4.677e-03MB size(tot)=86515:6.601e-01MB:6.446e-04GB
        per(mem): C:9.17 S:4.68 H:0.709 P:26.5 Q:58.9 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=2.380e-03 change=5.198e-04 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=2.380e-03 change=1.073e-06 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=1.289e-03 avail=3.829e+01 after qops2.allocate_gpu
ctns::oper_a2p ifab=1 ifkr=0 maxsize=22988:1.713e-04GB
iproc=0
 qops_tmp: oplist=M nops=M:95 
        dim(bra,ket)=73,73 size(op)=306:2.335e-03MB size(tot)=22988:1.754e-01MB:1.713e-04GB
        per(mem): M:100 
   init qops_tmp: dt=0.000166 tinit=0.000166
   from opA to opA.H(): dt=0.000212 tadjt=0.000212
   bcast: size(opM)=22988:0.000171GB dt=3.91e-05 speed=4.38GB/s tcomm=3.91e-05
   compute opP from opA: dt=0.000137 tcomp=0.000137
iproc=1
 qops_tmp: oplist=M nops=M:95 
        dim(bra,ket)=73,73 size(op)=306:0.00233459MB size(tot)=22957:0.175148MB:0.000171043GB
        per(mem): M:100 
   init qops_tmp: dt=0.000151 tinit=0.000357
   from opA to opA.H(): dt=0.000208 tadjt=0.000208
   bcast: size(opM)=22957:0.000171GB dt=3.06e-05 speed=5.59GB/s tcomm=0.000318
   compute opP from opA: dt=0.000115 tcomp=0.000319
----- TIMING FOR oper_a2pGPU : 0.00137 S T(init/adjt+bcast/comp/rest)=0.000318,0.000626,0.000241,0.00019 -----
ctns::oper_b2q ifab=1 ifkr=0 maxsize=50965:0.00038GB
iproc=0
 qops_tmp: oplist=B nops=B:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=50965:0.389MB:0.00038GB
        per(mem): B:100 
   init qops_tmp: dt=0.000167 tinit=0.000167
   copy opB to qops_tmps: dt=5.15e-06 tcopy=5.15e-06
   bcast: size(opB)=50965:0.00038GB dt=3.28e-05 speed=11.6GB/s tcomm=3.28e-05
   compute opQ from opB: dt=0.000152 tcomp=0.000152
iproc=0
 qops_tmp: oplist=N nops=N:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=50965:0.389MB:0.00038GB
        per(mem): N:100 
   init qops_tmp: dt=0.00016 tinit=0.000327
   from opB to opB.H(): dt=0.000278 tadjt=0.000278
   bcast: size(opN)=50965:0.00038GB dt=3.28e-05 speed=11.6GB/s tcomm=6.56e-05
   compute opQ from opB.H(): dt=0.000133 tcomp=0.000286
iproc=1
 qops_tmp: oplist=B nops=B:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=50965:0.389MB:0.00038GB
        per(mem): B:100 
   init qops_tmp: dt=0.000162 tinit=0.0005
   copy opB to qops_tmps: dt=4.82e-06 tcopy=4.85e-06
   bcast: size(opB)=50965:0.00038GB dt=2.8e-05 speed=13.6GB/s tcomm=0.000463
   compute opQ from opB: dt=0.000136 tcomp=0.000438
iproc=1
 qops_tmp: oplist=N nops=N:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=50965:0.389MB:0.00038GB
        per(mem): N:100 
   init qops_tmp: dt=0.000161 tinit=0.000661
   from opB to opB.H(): dt=0.000257 tadjt=0.000257
   bcast: size(opN)=50965:0.00038GB dt=2.85e-05 speed=13.3GB/s tcomm=0.000491
   compute opQ from opB.H(): dt=0.000129 tcomp=0.000567
----- TIMING FOR oper_b2qGPU : 0.00218 S T(init/copy/adjt+bcast/comp/rest)=0.000661,5.18e-06,0.000747,0.000552,0.000218 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=2.167e-03 change=4.321e-07 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=1.289e-03 avail=3.829e+01 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=1.518e-03 change=6.485e-04 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=1.289e-03 avail=3.829e+01 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=1.518e-03 change=-5.960e-08 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 before move
rank=0 GPUmem(GB): used=1.289e-03 avail=3.829e+01 before move
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=1.518e-03 change=-5.222e-04 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 after move
rank=0 GPUmem(GB): used=6.446e-04 avail=3.829e+01 after move
----- TIMING FOR oper_ab2pq : 5.174e-03 S T(init/copyCSH/opP/opQ/to_gpu/to_cpu/move)=7.852e-04,1.803e-05,1.390e-03,2.199e-03,0.000e+00,4.876e-04,2.937e-04 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=1.518e-03 change=0.000e+00 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-2.103e-05 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
##### local oper_env: 3.573e-02 S #####
 T(local oper_env: fetch) = 2.211e-03 S  per = 6.19  per(accum) = 6.19
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 6.19
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 6.19
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 6.19
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 6.19
 T(local oper_env: renrm) = 3.178e-02 S  per =   89  per(accum) = 95.1
 T(local oper_env: save ) = 1.735e-03 S  per = 4.86  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.178e-02 S  T(sum) = 3.178e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.868e-05 S  per = 0.0588  per(accum) = 0.0588
 T(local oper_env: qops init                    ) = 6.872e-04 S  per = 2.16  per(accum) = 2.22
 T(local oper_env: symbolic_formulae_renorm     ) = 1.672e-04 S  per = 0.526  per(accum) = 2.75
 T(local oper_env: allocate qops on gpu         ) = 5.133e-05 S  per = 0.162  per(accum) = 2.91
 T(local oper_env: site memcpy cpu2gpu          ) = 2.819e-05 S  per = 0.0887  per(accum) = 3
 T(local oper_env: rintermediate init           ) = 5.819e-05 S  per = 0.183  per(accum) = 3.18
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.195e-03 S  per = 3.76  per(accum) = 6.94
 T(local oper_env: rmmtasks init                ) = 1.351e-03 S  per = 4.25  per(accum) = 11.2
 T(local oper_env: qops memset on cpu           ) = 2.600e-08 S  per = 8.18e-05  per(accum) = 11.2
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.699e-03 S  per = 8.49  per(accum) = 19.7
 T(local oper_env: deallocate cpu and gpu memory) = 2.322e-04 S  per = 0.731  per(accum) = 20.4
 T(local oper_env: construct opS [ifdists=true] ) = 1.949e-02 S  per = 61.3  per(accum) = 81.8
 T(local oper_env: reduction of opS & opH [nccl]) = 2.605e-05 S  per = 0.082  per(accum) = 81.8
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.600e-08 S  per = 8.18e-05  per(accum) = 81.8
 T(local oper_env: reduction of opS & opH [mpi] ) = 5.400e-08 S  per = 0.00017  per(accum) = 81.8
 T(local oper_env: qops_pool join and erase     ) = 4.806e-04 S  per = 1.51  per(accum) = 83.4
 T(local oper_env: conversion from opAB to opPQ ) = 5.291e-03 S  per = 16.6  per(accum) = 100
##### sweep oper_env: 2.118e-01 S #####
 T(sweep oper_env: fetch) = 2.282e-02 S  per = 10.8  per(accum) = 10.8
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 10.8
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 10.8
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 10.8
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 10.8
 T(sweep oper_env: renrm) = 1.752e-01 S  per = 82.7  per(accum) = 93.5
 T(sweep oper_env: save ) = 1.382e-02 S  per = 6.52  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.562e+10 S  per = -1.562e+32
 T(sweep oper_env: preprocess                  ) = -1.562e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.752e-01 S  T(sum) = 1.752e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.623e-04 S  per = 0.0926  per(accum) = 0.0926
 T(sweep oper_env: qops init                    ) = 3.218e-03 S  per = 1.84  per(accum) = 1.93
 T(sweep oper_env: symbolic_formulae_renorm     ) = 8.323e-04 S  per = 0.475  per(accum) = 2.4
 T(sweep oper_env: allocate qops on gpu         ) = 4.684e-04 S  per = 0.267  per(accum) = 2.67
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.231e-04 S  per = 0.127  per(accum) = 2.8
 T(sweep oper_env: rintermediate init           ) = 4.329e-04 S  per = 0.247  per(accum) = 3.05
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.904e-03 S  per = 2.23  per(accum) = 5.27
 T(sweep oper_env: rmmtasks init                ) = 4.899e-03 S  per =  2.8  per(accum) = 8.07
 T(sweep oper_env: qops memset on cpu           ) = 3.090e-07 S  per = 0.000176  per(accum) = 8.07
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.292e-02 S  per = 7.37  per(accum) = 15.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 9.985e-04 S  per = 0.57  per(accum) = 16
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.351e-01 S  per = 77.1  per(accum) = 93.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 8.088e-04 S  per = 0.462  per(accum) = 93.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 9.175e-04 S  per = 0.524  per(accum) = 94.1
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 2.687e-04 S  per = 0.153  per(accum) = 94.3
 T(sweep oper_env: qops_pool join and erase     ) = 4.766e-03 S  per = 2.72  per(accum) = 97
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.294e-03 S  per = 3.02  per(accum) = 100

idx=10 coord=(9,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
ctns::rcanon_load_site idx=10 scratch=./scratch/sweep size=1583:1.18e-05GB T(load)=2.77e-04S speed=4.26e-02GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHPQ nops=C:20 S:10 H:1 P:95 Q:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=86515:0.66MB:0.000645GB
        per(mem): C:9.17 S:4.68 H:0.709 P:26.5 Q:58.9 
ctns::oper_renorm coord=(9,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:22 S:9 H:1 P:76 Q:86 
        dim(bra,ket)=65,65 size(op)=447:0.00341MB size(tot)=54987:0.42MB:0.00041GB
        per(mem): C:12.7 S:5.25 H:0.813 P:26 Q:55.2 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.413e-03 heap=1.386e+00 avail=4.807e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 1.231e-03 S -----
rank=0 GPUmem(GB): used=1.072e-03 (oper)=1.072e-03
rank=0 GPUmem(GB): used=1.083e-03 (oper,site)=1.072e-03,1.179e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=185
 no. of rintermediate operators=378
 no. of coefficients=3780:2.884e-02MB:2.816e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 7.537e-05 S -----
rank=0 GPUmem(GB): used=1.112e-03 (oper,site,rinter)=1.072e-03,1.179e-05,2.816e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.769e-03 S size(rtasks)=185 size(Rlst2)=169 T(Rmu/Rlist)=2.995e-04,2.470e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.531e-03 S size(rtasks)=185 size(Rlst)=10646 -----
rank=0 GPUmem(GB): used=1.112e-03 avail=3.829e+01 total=3.829e+01 batch[need]=3.784e-02 blksize=168 blksize0=140 batchsize=10646
rank=0 GPUmem(GB): used=3.895e-02 (oper,site,rinter,batch)=1.072e-03,1.179e-05,2.816e-05,3.784e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.831e-04,2.579e-03,3.972e-04
----- TIMING FOR renorm : t_inter=1.8e-04 t_gemm=2.6e-03 t_reduction=4.0e-04 tot=3.2e-03 -----
 renorm[inter] counter=240 t=1.8e-04 per=5.8e+00 cost=5.2e+06 flops=2.9e+10
 renorm[gemm] counter=240 i=0 t=1.9e-06 per=6.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=240 i=1 t=1.7e-06 per=5.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=240 i=2 t=5.2e-04 per=1.7e+01 cost=2.5e+06 flops=4.7e+09
 renorm[gemm] counter=240 i=3 t=1.1e-03 per=3.4e+01 cost=4.6e+06 flops=4.2e+09
 renorm[gemm] counter=240 i=4 t=1.7e-06 per=5.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=240 i=5 t=1.7e-06 per=5.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=240 i=6 t=9.7e-04 per=3.1e+01 cost=7.3e+06 flops=7.6e+09
 renorm[gemm] counter=240 total t=2.6e-03 per=8.2e+01 cost=1.4e+07 flops=5.6e+09
 renorm[red] counter=240 t=4.0e-04 per=1.3e+01 cost=8.3e+05 flops=2.1e+09
----- TIMING FOR renorm_tot : t_inter=1.2e-03 t_gemm=1.1e-02 t_reduction=2.6e-03 tot=1.5e-02 -----
 renorm_tot[inter] counter=240 t=1.2e-03 per=8.1e+00 cost=8.4e+06 flops=7.1e+09
 renorm_tot[gemm] counter=240 i=0 t=2.2e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=240 i=1 t=1.7e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=240 i=2 t=2.6e-03 per=1.8e+01 cost=4.4e+06 flops=1.7e+09
 renorm_tot[gemm] counter=240 i=3 t=4.1e-03 per=2.8e+01 cost=1.7e+07 flops=4.2e+09
 renorm_tot[gemm] counter=240 i=4 t=1.7e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=240 i=5 t=1.7e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=240 i=6 t=4.0e-03 per=2.8e+01 cost=2.2e+07 flops=5.6e+09
 renorm_tot[gemm] counter=240 total t=1.1e-02 per=7.4e+01 cost=4.4e+07 flops=4.1e+09
 renorm_tot[red] counter=240 t=2.6e-03 per=1.8e+01 cost=2.4e+06 flops=9.4e+08
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.105e-03 (oper)=1.074e-03
rank=0 GPUmem(GB): used=1.117e-03 (oper,site,rinter)=1.074e-03,1.179e-05,2.682e-06
rank=0 GPUmem(GB): used=1.437e-03 (oper,site,rinter,batch)=1.074e-03,1.179e-05,2.682e-06,3.199e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.361e-02 S T(preprocess/alloc/comp/red/dealloc)=9.813e-04,1.036e-03,9.259e-03,3.203e-03,8.011e-05 -----
----- TIMING FOR oper_renorm_opS : 1.365e-02 S rank=0 -----
qops.to_cpu: size(tot)=54987:4.195e-01MB:4.097e-04GB T(to_cpu)=1.276e-04S speed=3.210e+00GB/S
check ||H-H.dagger||=5.531e-14 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.0271 S rank=0 -----
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=3.075e-03 change=3.213e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=6.546e-03 change=-4.843e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-1.988e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local oper_env: 3.151e-02 S #####
 T(local oper_env: fetch) = 2.167e-03 S  per = 6.88  per(accum) = 6.88
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 6.88
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 6.88
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 6.88
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 6.88
 T(local oper_env: renrm) = 2.777e-02 S  per = 88.1  per(accum) = 95
 T(local oper_env: save ) = 1.575e-03 S  per =    5  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.777e-02 S  T(sum) = 2.777e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.115e-06 S  per = 0.0256  per(accum) = 0.0256
 T(local oper_env: qops init                    ) = 6.151e-04 S  per = 2.21  per(accum) = 2.24
 T(local oper_env: symbolic_formulae_renorm     ) = 1.245e-03 S  per = 4.48  per(accum) = 6.72
 T(local oper_env: allocate qops on gpu         ) = 7.038e-05 S  per = 0.253  per(accum) = 6.98
 T(local oper_env: site memcpy cpu2gpu          ) = 2.157e-05 S  per = 0.0777  per(accum) = 7.06
 T(local oper_env: rintermediate init           ) = 1.090e-04 S  per = 0.392  per(accum) = 7.45
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.689e-03 S  per = 13.3  per(accum) = 20.7
 T(local oper_env: rmmtasks init                ) = 3.626e-03 S  per = 13.1  per(accum) = 33.8
 T(local oper_env: qops memset on cpu           ) = 5.200e-08 S  per = 0.000187  per(accum) = 33.8
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.491e-03 S  per = 12.6  per(accum) = 46.4
 T(local oper_env: deallocate cpu and gpu memory) = 2.806e-04 S  per = 1.01  per(accum) = 47.4
 T(local oper_env: construct opS [ifdists=true] ) = 1.371e-02 S  per = 49.4  per(accum) = 96.7
 T(local oper_env: reduction of opS & opH [nccl]) = 2.153e-05 S  per = 0.0775  per(accum) = 96.8
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.399e-04 S  per = 0.504  per(accum) = 97.3
 T(local oper_env: reduction of opS & opH [mpi] ) = 5.017e-05 S  per = 0.181  per(accum) = 97.5
 T(local oper_env: qops_pool join and erase     ) = 6.984e-04 S  per = 2.51  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 5.140e-07 S  per = 0.00185  per(accum) = 100
##### sweep oper_env: 2.434e-01 S #####
 T(sweep oper_env: fetch) = 2.499e-02 S  per = 10.3  per(accum) = 10.3
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 10.3
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 10.3
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 10.3
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 10.3
 T(sweep oper_env: renrm) = 2.030e-01 S  per = 83.4  per(accum) = 93.7
 T(sweep oper_env: save ) = 1.540e-02 S  per = 6.33  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+10 S  per = -1.736e+32
 T(sweep oper_env: preprocess                  ) = -1.736e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.030e-01 S  T(sum) = 2.030e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.694e-04 S  per = 0.0835  per(accum) = 0.0835
 T(sweep oper_env: qops init                    ) = 3.834e-03 S  per = 1.89  per(accum) = 1.97
 T(sweep oper_env: symbolic_formulae_renorm     ) = 2.078e-03 S  per = 1.02  per(accum) = 3
 T(sweep oper_env: allocate qops on gpu         ) = 5.388e-04 S  per = 0.265  per(accum) = 3.26
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.447e-04 S  per = 0.121  per(accum) = 3.38
 T(sweep oper_env: rintermediate init           ) = 5.419e-04 S  per = 0.267  per(accum) = 3.65
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 7.593e-03 S  per = 3.74  per(accum) = 7.39
 T(sweep oper_env: rmmtasks init                ) = 8.526e-03 S  per =  4.2  per(accum) = 11.6
 T(sweep oper_env: qops memset on cpu           ) = 3.610e-07 S  per = 0.000178  per(accum) = 11.6
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.641e-02 S  per = 8.08  per(accum) = 19.7
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.279e-03 S  per = 0.63  per(accum) = 20.3
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.488e-01 S  per = 73.3  per(accum) = 93.6
 T(sweep oper_env: reduction of opS & opH [nccl]) = 8.304e-04 S  per = 0.409  per(accum) = 94
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.057e-03 S  per = 0.521  per(accum) = 94.5
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 3.189e-04 S  per = 0.157  per(accum) = 94.7
 T(sweep oper_env: qops_pool join and erase     ) = 5.465e-03 S  per = 2.69  per(accum) = 97.4
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.295e-03 S  per = 2.61  per(accum) = 100

idx=11 coord=(8,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=11 scratch=./scratch/sweep size=1232:9.18e-06GB T(load)=2.89e-04S speed=3.17e-02GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHPQ nops=C:22 S:9 H:1 P:76 Q:86 
        dim(bra,ket)=65,65 size(op)=447:0.00341MB size(tot)=54987:0.42MB:0.00041GB
        per(mem): C:12.7 S:5.25 H:0.813 P:26 Q:55.2 
ctns::oper_renorm coord=(8,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:24 S:8 H:1 P:61 Q:67 
        dim(bra,ket)=57,57 size(op)=361:0.00275MB size(tot)=36150:0.276MB:0.000269GB
        per(mem): C:17.2 S:5.95 H:0.999 P:23.7 Q:52.2 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.255e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=153 : 1.015e-03 S -----
rank=0 GPUmem(GB): used=6.964e-04 (oper)=6.964e-04
rank=0 GPUmem(GB): used=7.056e-04 (oper,site)=6.964e-04,9.179e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=153
 no. of rintermediate operators=297
 no. of coefficients=3267:2.493e-02MB:2.434e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 6.290e-05 S -----
rank=0 GPUmem(GB): used=7.299e-04 (oper,site,rinter)=6.964e-04,9.179e-06,2.434e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.389e-03 S size(rtasks)=153 size(Rlst2)=144 T(Rmu/Rlist)=2.370e-04,2.152e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.042e-03 S size(rtasks)=153 size(Rlst)=8659 -----
rank=0 GPUmem(GB): used=7.299e-04 avail=3.829e+01 total=3.829e+01 batch[need]=2.174e-02 blksize=120 blksize0=96 batchsize=8659
rank=0 GPUmem(GB): used=2.247e-02 (oper,site,rinter,batch)=6.964e-04,9.179e-06,2.434e-05,2.174e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.656e-04,2.481e-03,2.903e-04
----- TIMING FOR renorm : t_inter=1.7e-04 t_gemm=2.5e-03 t_reduction=2.9e-04 tot=2.9e-03 -----
 renorm[inter] counter=259 t=1.7e-04 per=5.6e+00 cost=3.2e+06 flops=1.9e+10
 renorm[gemm] counter=259 i=0 t=1.8e-06 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=259 i=1 t=1.6e-06 per=5.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=259 i=2 t=5.4e-04 per=1.9e+01 cost=1.3e+06 flops=2.4e+09
 renorm[gemm] counter=259 i=3 t=1.0e-03 per=3.4e+01 cost=2.4e+06 flops=2.4e+09
 renorm[gemm] counter=259 i=4 t=1.7e-06 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=259 i=5 t=1.6e-06 per=5.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=259 i=6 t=9.2e-04 per=3.1e+01 cost=4.5e+06 flops=4.8e+09
 renorm[gemm] counter=259 total t=2.5e-03 per=8.4e+01 cost=8.2e+06 flops=3.3e+09
 renorm[red] counter=259 t=2.9e-04 per=9.9e+00 cost=6.4e+05 flops=2.2e+09
----- TIMING FOR renorm_tot : t_inter=1.3e-03 t_gemm=1.3e-02 t_reduction=2.9e-03 tot=1.7e-02 -----
 renorm_tot[inter] counter=259 t=1.3e-03 per=7.7e+00 cost=1.2e+07 flops=8.6e+09
 renorm_tot[gemm] counter=259 i=0 t=2.3e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=259 i=1 t=1.9e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=259 i=2 t=3.1e-03 per=1.8e+01 cost=5.7e+06 flops=1.8e+09
 renorm_tot[gemm] counter=259 i=3 t=5.1e-03 per=2.9e+01 cost=2.0e+07 flops=3.9e+09
 renorm_tot[gemm] counter=259 i=4 t=1.9e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=259 i=5 t=1.8e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=259 i=6 t=4.9e-03 per=2.8e+01 cost=2.7e+07 flops=5.4e+09
 renorm_tot[gemm] counter=259 total t=1.3e-02 per=7.6e+01 cost=5.2e+07 flops=3.9e+09
 renorm_tot[red] counter=259 t=2.9e-03 per=1.6e+01 cost=3.1e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=7.254e-04 (oper)=6.984e-04
rank=0 GPUmem(GB): used=7.346e-04 (oper,site,rinter)=6.984e-04,9.179e-06,2.623e-06
rank=0 GPUmem(GB): used=9.756e-04 (oper,site,rinter,batch)=6.984e-04,9.179e-06,2.623e-06,2.410e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.247e-02 S T(preprocess/alloc/comp/red/dealloc)=8.982e-04,9.565e-04,8.614e-03,2.789e-03,7.908e-05 -----
----- TIMING FOR oper_renorm_opS : 1.251e-02 S rank=0 -----
qops.to_cpu: size(tot)=36150:2.758e-01MB:2.693e-04GB T(to_cpu)=9.598e-05S speed=2.806e+00GB/S
check ||H-H.dagger||=3.305e-14 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.0241 S rank=0 -----
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=3.036e-03 change=2.568e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=5.714e-03 change=-4.098e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.702e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local oper_env: 2.851e-02 S #####
 T(local oper_env: fetch) = 2.377e-03 S  per = 8.34  per(accum) = 8.34
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 8.34
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 8.34
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 8.34
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 8.34
 T(local oper_env: renrm) = 2.469e-02 S  per = 86.6  per(accum) = 94.9
 T(local oper_env: save ) = 1.445e-03 S  per = 5.07  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.469e-02 S  T(sum) = 2.469e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.465e-06 S  per = 0.0343  per(accum) = 0.0343
 T(local oper_env: qops init                    ) = 4.858e-04 S  per = 1.97  per(accum) = 2
 T(local oper_env: symbolic_formulae_renorm     ) = 1.028e-03 S  per = 4.16  per(accum) = 6.17
 T(local oper_env: allocate qops on gpu         ) = 5.466e-05 S  per = 0.221  per(accum) = 6.39
 T(local oper_env: site memcpy cpu2gpu          ) = 2.257e-05 S  per = 0.0914  per(accum) = 6.48
 T(local oper_env: rintermediate init           ) = 7.547e-05 S  per = 0.306  per(accum) = 6.78
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.183e-03 S  per = 12.9  per(accum) = 19.7
 T(local oper_env: rmmtasks init                ) = 2.984e-03 S  per = 12.1  per(accum) = 31.8
 T(local oper_env: qops memset on cpu           ) = 4.100e-08 S  per = 0.000166  per(accum) = 31.8
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.225e-03 S  per = 13.1  per(accum) = 44.8
 T(local oper_env: deallocate cpu and gpu memory) = 2.863e-04 S  per = 1.16  per(accum) = 46
 T(local oper_env: construct opS [ifdists=true] ) = 1.256e-02 S  per = 50.9  per(accum) = 96.9
 T(local oper_env: reduction of opS & opH [nccl]) = 2.094e-05 S  per = 0.0848  per(accum) = 97
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.073e-04 S  per = 0.435  per(accum) = 97.4
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.348e-05 S  per = 0.0546  per(accum) = 97.4
 T(local oper_env: qops_pool join and erase     ) = 6.313e-04 S  per = 2.56  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.830e-07 S  per = 0.00196  per(accum) = 100
##### sweep oper_env: 2.719e-01 S #####
 T(sweep oper_env: fetch) = 2.736e-02 S  per = 10.1  per(accum) = 10.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 10.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 10.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 10.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 10.1
 T(sweep oper_env: renrm) = 2.277e-01 S  per = 83.7  per(accum) = 93.8
 T(sweep oper_env: save ) = 1.684e-02 S  per = 6.19  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.909e+10 S  per = -1.909e+32
 T(sweep oper_env: preprocess                  ) = -1.909e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.277e-01 S  T(sum) = 2.277e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.778e-04 S  per = 0.0781  per(accum) = 0.0781
 T(sweep oper_env: qops init                    ) = 4.319e-03 S  per =  1.9  per(accum) = 1.98
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.106e-03 S  per = 1.36  per(accum) = 3.34
 T(sweep oper_env: allocate qops on gpu         ) = 5.934e-04 S  per = 0.261  per(accum) = 3.6
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.673e-04 S  per = 0.117  per(accum) = 3.72
 T(sweep oper_env: rintermediate init           ) = 6.173e-04 S  per = 0.271  per(accum) = 3.99
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.078e-02 S  per = 4.73  per(accum) = 8.72
 T(sweep oper_env: rmmtasks init                ) = 1.151e-02 S  per = 5.06  per(accum) = 13.8
 T(sweep oper_env: qops memset on cpu           ) = 4.020e-07 S  per = 0.000177  per(accum) = 13.8
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.963e-02 S  per = 8.62  per(accum) = 22.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.565e-03 S  per = 0.688  per(accum) = 23.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.614e-01 S  per = 70.9  per(accum) = 94
 T(sweep oper_env: reduction of opS & opH [nccl]) = 8.513e-04 S  per = 0.374  per(accum) = 94.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.165e-03 S  per = 0.512  per(accum) = 94.9
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 3.323e-04 S  per = 0.146  per(accum) = 95
 T(sweep oper_env: qops_pool join and erase     ) = 6.096e-03 S  per = 2.68  per(accum) = 97.7
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.295e-03 S  per = 2.33  per(accum) = 100

idx=12 coord=(7,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=12 scratch=./scratch/sweep size=981:7.31e-06GB T(load)=3.34e-04S speed=2.19e-02GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHPQ nops=C:24 S:8 H:1 P:61 Q:67 
        dim(bra,ket)=57,57 size(op)=361:0.00275MB size(tot)=36150:0.276MB:0.000269GB
        per(mem): C:17.2 S:5.95 H:0.999 P:23.7 Q:52.2 
ctns::oper_renorm coord=(7,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:26 S:7 H:1 P:45 Q:53 
        dim(bra,ket)=47,47 size(op)=293:0.00224MB size(tot)=22566:0.172MB:0.000168GB
        per(mem): C:22.2 S:6.7 H:1.3 P:17.5 Q:52.3 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.164e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=125 : 8.646e-04 S -----
rank=0 GPUmem(GB): used=4.549e-04 (oper)=4.549e-04
rank=0 GPUmem(GB): used=4.622e-04 (oper,site)=4.549e-04,7.309e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=125
 no. of rintermediate operators=231
 no. of coefficients=2772:2.115e-02MB:2.065e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.990e-05 S -----
rank=0 GPUmem(GB): used=4.828e-04 (oper,site,rinter)=4.549e-04,7.309e-06,2.065e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.415e-03 S size(rtasks)=125 size(Rlst2)=121 T(Rmu/Rlist)=1.868e-04,1.228e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.030e-03 S size(rtasks)=125 size(Rlst)=6413 -----
rank=0 GPUmem(GB): used=4.828e-04 avail=3.829e+01 total=3.829e+01 batch[need]=1.247e-02 blksize=90 blksize0=80 batchsize=6413
rank=0 GPUmem(GB): used=1.295e-02 (oper,site,rinter,batch)=4.549e-04,7.309e-06,2.065e-05,1.247e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.419e-04,2.035e-03,3.009e-04
----- TIMING FOR renorm : t_inter=1.4e-04 t_gemm=2.0e-03 t_reduction=3.0e-04 tot=2.5e-03 -----
 renorm[inter] counter=276 t=1.4e-04 per=5.7e+00 cost=2.1e+06 flops=1.5e+10
 renorm[gemm] counter=276 i=0 t=1.8e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=276 i=1 t=1.7e-06 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=276 i=2 t=4.2e-04 per=1.7e+01 cost=7.4e+05 flops=1.7e+09
 renorm[gemm] counter=276 i=3 t=7.3e-04 per=3.0e+01 cost=1.4e+06 flops=2.0e+09
 renorm[gemm] counter=276 i=4 t=1.7e-06 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=276 i=5 t=1.6e-06 per=6.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=276 i=6 t=8.7e-04 per=3.5e+01 cost=2.7e+06 flops=3.1e+09
 renorm[gemm] counter=276 total t=2.0e-03 per=8.2e+01 cost=4.9e+06 flops=2.4e+09
 renorm[red] counter=276 t=3.0e-04 per=1.2e+01 cost=4.2e+05 flops=1.4e+09
----- TIMING FOR renorm_tot : t_inter=1.5e-03 t_gemm=1.5e-02 t_reduction=3.2e-03 tot=2.0e-02 -----
 renorm_tot[inter] counter=276 t=1.5e-03 per=7.5e+00 cost=1.4e+07 flops=9.2e+09
 renorm_tot[gemm] counter=276 i=0 t=2.5e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=276 i=1 t=2.0e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=276 i=2 t=3.6e-03 per=1.8e+01 cost=6.5e+06 flops=1.8e+09
 renorm_tot[gemm] counter=276 i=3 t=5.8e-03 per=2.9e+01 cost=2.1e+07 flops=3.6e+09
 renorm_tot[gemm] counter=276 i=4 t=2.1e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=276 i=5 t=2.0e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=276 i=6 t=5.8e-03 per=2.9e+01 cost=2.9e+07 flops=5.1e+09
 renorm_tot[gemm] counter=276 total t=1.5e-02 per=7.7e+01 cost=5.7e+07 flops=3.7e+09
 renorm_tot[red] counter=276 t=3.2e-03 per=1.6e+01 cost=3.5e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.796e-04 (oper)=4.565e-04
rank=0 GPUmem(GB): used=4.869e-04 (oper,site,rinter)=4.565e-04,7.309e-06,2.503e-06
rank=0 GPUmem(GB): used=6.542e-04 (oper,site,rinter,batch)=4.565e-04,7.309e-06,2.503e-06,1.672e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 9.149e-03 S T(preprocess/alloc/comp/red/dealloc)=7.900e-04,8.465e-04,6.389e-03,1.815e-03,7.267e-05 -----
----- TIMING FOR oper_renorm_opS : 9.184e-03 S rank=0 -----
qops.to_cpu: size(tot)=22566:1.722e-01MB:1.681e-04GB T(to_cpu)=7.115e-05S speed=2.363e+00GB/S
check ||H-H.dagger||=3.777e-14 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.0187 S rank=0 -----
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=1.480e-03 change=1.902e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=3.914e-03 change=-3.239e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.438e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local oper_env: 2.302e-02 S #####
 T(local oper_env: fetch) = 2.364e-03 S  per = 10.3  per(accum) = 10.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 10.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 10.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 10.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 10.3
 T(local oper_env: renrm) = 1.927e-02 S  per = 83.7  per(accum) = 94
 T(local oper_env: save ) = 1.392e-03 S  per = 6.05  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.927e-02 S  T(sum) = 1.927e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.120e-06 S  per = 0.0421  per(accum) = 0.0421
 T(local oper_env: qops init                    ) = 4.533e-04 S  per = 2.35  per(accum) = 2.39
 T(local oper_env: symbolic_formulae_renorm     ) = 8.775e-04 S  per = 4.55  per(accum) = 6.95
 T(local oper_env: allocate qops on gpu         ) = 5.205e-05 S  per = 0.27  per(accum) = 7.22
 T(local oper_env: site memcpy cpu2gpu          ) = 2.304e-05 S  per = 0.12  per(accum) = 7.34
 T(local oper_env: rintermediate init           ) = 6.276e-05 S  per = 0.326  per(accum) = 7.66
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.064e-03 S  per = 10.7  per(accum) = 18.4
 T(local oper_env: rmmtasks init                ) = 2.818e-03 S  per = 14.6  per(accum) = 33
 T(local oper_env: qops memset on cpu           ) = 4.500e-08 S  per = 0.000234  per(accum) = 33
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.801e-03 S  per = 14.5  per(accum) = 47.5
 T(local oper_env: deallocate cpu and gpu memory) = 2.470e-04 S  per = 1.28  per(accum) = 48.8
 T(local oper_env: construct opS [ifdists=true] ) = 9.215e-03 S  per = 47.8  per(accum) = 96.7
 T(local oper_env: reduction of opS & opH [nccl]) = 2.042e-05 S  per = 0.106  per(accum) = 96.8
 T(local oper_env: qops memcpy gpu2cpu          ) = 8.213e-05 S  per = 0.426  per(accum) = 97.2
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.317e-05 S  per = 0.0684  per(accum) = 97.3
 T(local oper_env: qops_pool join and erase     ) = 5.288e-04 S  per = 2.74  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.490e-07 S  per = 0.00233  per(accum) = 100
##### sweep oper_env: 2.949e-01 S #####
 T(sweep oper_env: fetch) = 2.973e-02 S  per = 10.1  per(accum) = 10.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 10.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 10.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 10.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 10.1
 T(sweep oper_env: renrm) = 2.469e-01 S  per = 83.7  per(accum) = 93.8
 T(sweep oper_env: save ) = 1.823e-02 S  per = 6.18  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.083e+10 S  per = -2.083e+32
 T(sweep oper_env: preprocess                  ) = -2.083e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.469e-01 S  T(sum) = 2.469e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.860e-04 S  per = 0.0753  per(accum) = 0.0753
 T(sweep oper_env: qops init                    ) = 4.773e-03 S  per = 1.93  per(accum) = 2.01
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.983e-03 S  per = 1.61  per(accum) = 3.62
 T(sweep oper_env: allocate qops on gpu         ) = 6.455e-04 S  per = 0.261  per(accum) = 3.88
 T(sweep oper_env: site memcpy cpu2gpu          ) = 2.903e-04 S  per = 0.118  per(accum) = 4
 T(sweep oper_env: rintermediate init           ) = 6.801e-04 S  per = 0.275  per(accum) = 4.28
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.284e-02 S  per =  5.2  per(accum) = 9.48
 T(sweep oper_env: rmmtasks init                ) = 1.433e-02 S  per =  5.8  per(accum) = 15.3
 T(sweep oper_env: qops memset on cpu           ) = 4.470e-07 S  per = 0.000181  per(accum) = 15.3
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.244e-02 S  per = 9.09  per(accum) = 24.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 1.812e-03 S  per = 0.734  per(accum) = 25.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.706e-01 S  per = 69.1  per(accum) = 94.2
 T(sweep oper_env: reduction of opS & opH [nccl]) = 8.717e-04 S  per = 0.353  per(accum) = 94.5
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.247e-03 S  per = 0.505  per(accum) = 95
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 3.455e-04 S  per = 0.14  per(accum) = 95.2
 T(sweep oper_env: qops_pool join and erase     ) = 6.625e-03 S  per = 2.68  per(accum) = 97.9
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.296e-03 S  per = 2.14  per(accum) = 100

idx=13 coord=(6,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=13 scratch=./scratch/sweep size=723:5.39e-06GB T(load)=3.12e-04S speed=1.72e-02GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHPQ nops=C:26 S:7 H:1 P:45 Q:53 
        dim(bra,ket)=47,47 size(op)=293:0.00224MB size(tot)=22566:0.172MB:0.000168GB
        per(mem): C:22.2 S:6.7 H:1.3 P:17.5 Q:52.3 
ctns::oper_renorm coord=(6,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:28 S:6 H:1 P:34 Q:38 
        dim(bra,ket)=38,38 size(op)=208:0.00159MB size(tot)=12413:0.0947MB:9.25e-05GB
        per(mem): C:29.3 S:7.54 H:1.68 P:15 Q:46.4 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.084e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=101 : 7.095e-04 S -----
rank=0 GPUmem(GB): used=2.780e-04 (oper)=2.780e-04
rank=0 GPUmem(GB): used=2.834e-04 (oper,site)=2.780e-04,5.387e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=101
 no. of rintermediate operators=168
 no. of coefficients=2184:1.666e-02MB:1.627e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.323e-05 S -----
rank=0 GPUmem(GB): used=2.997e-04 (oper,site,rinter)=2.780e-04,5.387e-06,1.627e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 9.355e-04 S size(rtasks)=101 size(Rlst2)=100 T(Rmu/Rlist)=1.331e-04,8.023e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.317e-03 S size(rtasks)=101 size(Rlst)=4109 -----
rank=0 GPUmem(GB): used=2.997e-04 avail=3.829e+01 total=3.829e+01 batch[need]=6.643e-03 blksize=72 blksize0=72 batchsize=4109
rank=0 GPUmem(GB): used=6.943e-03 (oper,site,rinter,batch)=2.780e-04,5.387e-06,1.627e-05,6.643e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.394e-04,1.517e-03,2.742e-04
----- TIMING FOR renorm : t_inter=1.4e-04 t_gemm=1.5e-03 t_reduction=2.7e-04 tot=1.9e-03 -----
 renorm[inter] counter=291 t=1.4e-04 per=7.2e+00 cost=1.4e+06 flops=9.8e+09
 renorm[gemm] counter=291 i=0 t=1.8e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=291 i=1 t=1.6e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=291 i=2 t=3.6e-04 per=1.9e+01 cost=3.9e+05 flops=1.1e+09
 renorm[gemm] counter=291 i=3 t=6.0e-04 per=3.1e+01 cost=7.7e+05 flops=1.3e+09
 renorm[gemm] counter=291 i=4 t=1.7e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=291 i=5 t=1.6e-06 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=291 i=6 t=5.5e-04 per=2.9e+01 cost=1.3e+06 flops=2.3e+09
 renorm[gemm] counter=291 total t=1.5e-03 per=7.9e+01 cost=2.4e+06 flops=1.6e+09
 renorm[red] counter=291 t=2.7e-04 per=1.4e+01 cost=2.0e+05 flops=7.2e+08
----- TIMING FOR renorm_tot : t_inter=1.6e-03 t_gemm=1.7e-02 t_reduction=3.4e-03 tot=2.2e-02 -----
 renorm_tot[inter] counter=291 t=1.6e-03 per=7.4e+00 cost=1.5e+07 flops=9.3e+09
 renorm_tot[gemm] counter=291 i=0 t=2.7e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=291 i=1 t=2.2e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=291 i=2 t=3.9e-03 per=1.8e+01 cost=6.9e+06 flops=1.7e+09
 renorm_tot[gemm] counter=291 i=3 t=6.4e-03 per=2.9e+01 cost=2.2e+07 flops=3.4e+09
 renorm_tot[gemm] counter=291 i=4 t=2.2e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=291 i=5 t=2.2e-05 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=291 i=6 t=6.4e-03 per=2.9e+01 cost=3.1e+07 flops=4.8e+09
 renorm_tot[gemm] counter=291 total t=1.7e-02 per=7.7e+01 cost=6.0e+07 flops=3.5e+09
 renorm_tot[red] counter=291 t=3.4e-03 per=1.6e+01 cost=3.7e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.978e-04 (oper)=2.792e-04
rank=0 GPUmem(GB): used=3.032e-04 (oper,site,rinter)=2.792e-04,5.387e-06,2.325e-06
rank=0 GPUmem(GB): used=4.260e-04 (oper,site,rinter,batch)=2.792e-04,5.387e-06,2.325e-06,1.229e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 8.188e-03 S T(preprocess/alloc/comp/red/dealloc)=6.310e-04,6.862e-04,6.310e-03,1.100e-03,6.845e-05 -----
----- TIMING FOR oper_renorm_opS : 8.252e-03 S rank=0 -----
qops.to_cpu: size(tot)=12413:9.470e-02MB:9.248e-05GB T(to_cpu)=1.011e-04S speed=9.147e-01GB/S
check ||H-H.dagger||=1.528e-14 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.015 S rank=0 -----
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=1.114e-03 change=1.264e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=2.007e-03 change=-2.489e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.150e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local oper_env: 1.925e-02 S #####
 T(local oper_env: fetch) = 2.241e-03 S  per = 11.6  per(accum) = 11.6
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 11.6
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 11.6
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 11.6
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 11.6
 T(local oper_env: renrm) = 1.560e-02 S  per =   81  per(accum) = 92.7
 T(local oper_env: save ) = 1.409e-03 S  per = 7.32  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.560e-02 S  T(sum) = 1.560e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.309e-05 S  per = 0.0839  per(accum) = 0.0839
 T(local oper_env: qops init                    ) = 3.722e-04 S  per = 2.39  per(accum) = 2.47
 T(local oper_env: symbolic_formulae_renorm     ) = 7.222e-04 S  per = 4.63  per(accum) = 7.1
 T(local oper_env: allocate qops on gpu         ) = 5.768e-05 S  per = 0.37  per(accum) = 7.47
 T(local oper_env: site memcpy cpu2gpu          ) = 2.266e-05 S  per = 0.145  per(accum) = 7.62
 T(local oper_env: rintermediate init           ) = 6.532e-05 S  per = 0.419  per(accum) = 8.03
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.340e-03 S  per = 8.59  per(accum) = 16.6
 T(local oper_env: rmmtasks init                ) = 1.688e-03 S  per = 10.8  per(accum) = 27.4
 T(local oper_env: qops memset on cpu           ) = 3.800e-08 S  per = 0.000244  per(accum) = 27.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.129e-03 S  per = 13.7  per(accum) = 41.1
 T(local oper_env: deallocate cpu and gpu memory) = 2.163e-04 S  per = 1.39  per(accum) = 42.5
 T(local oper_env: construct opS [ifdists=true] ) = 8.275e-03 S  per =   53  per(accum) = 95.5
 T(local oper_env: reduction of opS & opH [nccl]) = 2.039e-05 S  per = 0.131  per(accum) = 95.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.126e-04 S  per = 0.722  per(accum) = 96.4
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.271e-05 S  per = 0.0815  per(accum) = 96.5
 T(local oper_env: qops_pool join and erase     ) = 5.505e-04 S  per = 3.53  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.360e-07 S  per = 0.0028  per(accum) = 100
##### sweep oper_env: 3.141e-01 S #####
 T(sweep oper_env: fetch) = 3.197e-02 S  per = 10.2  per(accum) = 10.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 10.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 10.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 10.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 10.2
 T(sweep oper_env: renrm) = 2.625e-01 S  per = 83.6  per(accum) = 93.7
 T(sweep oper_env: save ) = 1.964e-02 S  per = 6.25  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.256e+10 S  per = -2.256e+32
 T(sweep oper_env: preprocess                  ) = -2.256e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.625e-01 S  T(sum) = 2.625e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.991e-04 S  per = 0.0758  per(accum) = 0.0758
 T(sweep oper_env: qops init                    ) = 5.145e-03 S  per = 1.96  per(accum) = 2.04
 T(sweep oper_env: symbolic_formulae_renorm     ) = 4.706e-03 S  per = 1.79  per(accum) = 3.83
 T(sweep oper_env: allocate qops on gpu         ) = 7.031e-04 S  per = 0.268  per(accum) = 4.1
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.130e-04 S  per = 0.119  per(accum) = 4.22
 T(sweep oper_env: rintermediate init           ) = 7.454e-04 S  per = 0.284  per(accum) = 4.5
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.418e-02 S  per =  5.4  per(accum) = 9.9
 T(sweep oper_env: rmmtasks init                ) = 1.602e-02 S  per =  6.1  per(accum) = 16
 T(sweep oper_env: qops memset on cpu           ) = 4.850e-07 S  per = 0.000185  per(accum) = 16
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.456e-02 S  per = 9.36  per(accum) = 25.4
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.029e-03 S  per = 0.773  per(accum) = 26.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.788e-01 S  per = 68.1  per(accum) = 94.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 8.921e-04 S  per = 0.34  per(accum) = 94.6
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.359e-03 S  per = 0.518  per(accum) = 95.1
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 3.582e-04 S  per = 0.136  per(accum) = 95.2
 T(sweep oper_env: qops_pool join and erase     ) = 7.175e-03 S  per = 2.73  per(accum) = 98
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.296e-03 S  per = 2.02  per(accum) = 100

idx=14 coord=(5,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=14 scratch=./scratch/sweep size=478:3.56e-06GB T(load)=3.12e-04S speed=1.14e-02GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHPQ nops=C:28 S:6 H:1 P:34 Q:38 
        dim(bra,ket)=38,38 size(op)=208:0.00159MB size(tot)=12413:0.0947MB:9.25e-05GB
        per(mem): C:29.3 S:7.54 H:1.68 P:15 Q:46.4 
ctns::oper_renorm coord=(5,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:30 S:5 H:1 P:22 Q:28 
        dim(bra,ket)=27,27 size(op)=159:0.00121MB size(tot)=6244:0.0476MB:4.65e-05GB
        per(mem): C:36 S:10.1 H:2.55 P:9.8 Q:41.5 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.783e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=81 : 5.027e-04 S -----
rank=0 GPUmem(GB): used=1.564e-04 (oper)=1.564e-04
rank=0 GPUmem(GB): used=1.600e-04 (oper,site)=1.564e-04,3.561e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=81
 no. of rintermediate operators=120
 no. of coefficients=1680:1.282e-02MB:1.252e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.033e-05 S -----
rank=0 GPUmem(GB): used=1.725e-04 (oper,site,rinter)=1.564e-04,3.561e-06,1.252e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 5.510e-04 S size(rtasks)=81 size(Rlst2)=49 T(Rmu/Rlist)=9.880e-05,4.521e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 7.266e-04 S size(rtasks)=81 size(Rlst)=2271 -----
rank=0 GPUmem(GB): used=1.725e-04 avail=3.829e+01 total=3.829e+01 batch[need]=3.266e-03 blksize=64 blksize0=64 batchsize=2271
rank=0 GPUmem(GB): used=3.438e-03 (oper,site,rinter,batch)=1.564e-04,3.561e-06,1.252e-05,3.266e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.193e-04,1.104e-03,1.879e-04
----- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=1.1e-03 t_reduction=1.9e-04 tot=1.4e-03 -----
 renorm[inter] counter=304 t=1.2e-04 per=8.4e+00 cost=5.7e+05 flops=4.8e+09
 renorm[gemm] counter=304 i=0 t=1.9e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=304 i=1 t=1.6e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=304 i=2 t=2.9e-04 per=2.1e+01 cost=1.5e+05 flops=5.1e+08
 renorm[gemm] counter=304 i=3 t=4.4e-04 per=3.1e+01 cost=3.3e+05 flops=7.4e+08
 renorm[gemm] counter=304 i=4 t=1.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=304 i=5 t=1.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=304 i=6 t=3.7e-04 per=2.6e+01 cost=6.1e+05 flops=1.7e+09
 renorm[gemm] counter=304 total t=1.1e-03 per=7.8e+01 cost=1.1e+06 flops=9.8e+08
 renorm[red] counter=304 t=1.9e-04 per=1.3e+01 cost=1.1e+05 flops=6.1e+08
----- TIMING FOR renorm_tot : t_inter=1.7e-03 t_gemm=1.8e-02 t_reduction=3.6e-03 tot=2.3e-02 -----
 renorm_tot[inter] counter=304 t=1.7e-03 per=7.5e+00 cost=1.6e+07 flops=9.0e+09
 renorm_tot[gemm] counter=304 i=0 t=2.9e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=304 i=1 t=2.4e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=304 i=2 t=4.2e-03 per=1.8e+01 cost=7.0e+06 flops=1.7e+09
 renorm_tot[gemm] counter=304 i=3 t=6.9e-03 per=3.0e+01 cost=2.2e+07 flops=3.2e+09
 renorm_tot[gemm] counter=304 i=4 t=2.4e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=304 i=5 t=2.3e-05 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=304 i=6 t=6.7e-03 per=2.9e+01 cost=3.1e+07 flops=4.7e+09
 renorm_tot[gemm] counter=304 total t=1.8e-02 per=7.7e+01 cost=6.1e+07 flops=3.4e+09
 renorm_tot[red] counter=304 t=3.6e-03 per=1.6e+01 cost=3.8e+06 flops=1.0e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.720e-04 (oper)=1.573e-04
rank=0 GPUmem(GB): used=1.755e-04 (oper,site,rinter)=1.573e-04,3.561e-06,2.086e-06
rank=0 GPUmem(GB): used=2.632e-04 (oper,site,rinter,batch)=1.573e-04,3.561e-06,2.086e-06,8.772e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.608e-03 S T(preprocess/alloc/comp/red/dealloc)=4.560e-04,5.082e-04,3.491e-03,5.206e-04,5.944e-05 -----
----- TIMING FOR oper_renorm_opS : 4.639e-03 S rank=0 -----
qops.to_cpu: size(tot)=6244:4.764e-02MB:4.652e-05GB T(to_cpu)=4.006e-05S speed=1.161e+00GB/S
check ||H-H.dagger||=1.806e-14 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.00904 S rank=0 -----
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=7.409e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=1.694e-03 change=-1.859e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-7.287e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local oper_env: 1.336e-02 S #####
 T(local oper_env: fetch) = 2.413e-03 S  per = 18.1  per(accum) = 18.1
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 18.1
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 18.1
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 18.1
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 18.1
 T(local oper_env: renrm) = 9.593e-03 S  per = 71.8  per(accum) = 89.8
 T(local oper_env: save ) = 1.357e-03 S  per = 10.2  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 9.593e-03 S  T(sum) = 9.593e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.111e-06 S  per = 0.0845  per(accum) = 0.0845
 T(local oper_env: qops init                    ) = 2.715e-04 S  per = 2.83  per(accum) = 2.91
 T(local oper_env: symbolic_formulae_renorm     ) = 5.146e-04 S  per = 5.36  per(accum) = 8.28
 T(local oper_env: allocate qops on gpu         ) = 5.079e-05 S  per = 0.529  per(accum) = 8.81
 T(local oper_env: site memcpy cpu2gpu          ) = 2.747e-05 S  per = 0.286  per(accum) = 9.09
 T(local oper_env: rintermediate init           ) = 6.591e-05 S  per = 0.687  per(accum) = 9.78
 T(local oper_env: preprocess_formulae_Rlist2   ) = 7.413e-04 S  per = 7.73  per(accum) = 17.5
 T(local oper_env: rmmtasks init                ) = 8.804e-04 S  per = 9.18  per(accum) = 26.7
 T(local oper_env: qops memset on cpu           ) = 5.500e-08 S  per = 0.000573  per(accum) = 26.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.555e-03 S  per = 16.2  per(accum) = 42.9
 T(local oper_env: deallocate cpu and gpu memory) = 1.566e-04 S  per = 1.63  per(accum) = 44.5
 T(local oper_env: construct opS [ifdists=true] ) = 4.658e-03 S  per = 48.6  per(accum) = 93.1
 T(local oper_env: reduction of opS & opH [nccl]) = 1.999e-05 S  per = 0.208  per(accum) = 93.3
 T(local oper_env: qops memcpy gpu2cpu          ) = 5.075e-05 S  per = 0.529  per(accum) = 93.8
 T(local oper_env: reduction of opS & opH [mpi] ) = 4.477e-05 S  per = 0.467  per(accum) = 94.3
 T(local oper_env: qops_pool join and erase     ) = 5.476e-04 S  per = 5.71  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.490e-07 S  per = 0.00468  per(accum) = 100
##### sweep oper_env: 3.275e-01 S #####
 T(sweep oper_env: fetch) = 3.438e-02 S  per = 10.5  per(accum) = 10.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 10.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 10.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 10.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 10.5
 T(sweep oper_env: renrm) = 2.721e-01 S  per = 83.1  per(accum) = 93.6
 T(sweep oper_env: save ) = 2.100e-02 S  per = 6.41  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.430e+10 S  per = -2.430e+32
 T(sweep oper_env: preprocess                  ) = -2.430e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.721e-01 S  T(sum) = 2.721e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.072e-04 S  per = 0.0761  per(accum) = 0.0761
 T(sweep oper_env: qops init                    ) = 5.416e-03 S  per = 1.99  per(accum) = 2.07
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.220e-03 S  per = 1.92  per(accum) = 3.98
 T(sweep oper_env: allocate qops on gpu         ) = 7.539e-04 S  per = 0.277  per(accum) = 4.26
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.404e-04 S  per = 0.125  per(accum) = 4.39
 T(sweep oper_env: rintermediate init           ) = 8.113e-04 S  per = 0.298  per(accum) = 4.69
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.492e-02 S  per = 5.48  per(accum) = 10.2
 T(sweep oper_env: rmmtasks init                ) = 1.690e-02 S  per = 6.21  per(accum) = 16.4
 T(sweep oper_env: qops memset on cpu           ) = 5.400e-07 S  per = 0.000198  per(accum) = 16.4
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.612e-02 S  per =  9.6  per(accum) = 26
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.185e-03 S  per = 0.803  per(accum) = 26.8
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.835e-01 S  per = 67.4  per(accum) = 94.2
 T(sweep oper_env: reduction of opS & opH [nccl]) = 9.121e-04 S  per = 0.335  per(accum) = 94.5
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.410e-03 S  per = 0.518  per(accum) = 95.1
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 4.030e-04 S  per = 0.148  per(accum) = 95.2
 T(sweep oper_env: qops_pool join and erase     ) = 7.723e-03 S  per = 2.84  per(accum) = 98.1
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.297e-03 S  per = 1.95  per(accum) = 100

idx=15 coord=(4,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=15 scratch=./scratch/sweep size=213:1.59e-06GB T(load)=3.03e-04S speed=5.23e-03GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHPQ nops=C:30 S:5 H:1 P:22 Q:28 
        dim(bra,ket)=27,27 size(op)=159:0.00121MB size(tot)=6244:0.0476MB:4.65e-05GB
        per(mem): C:36 S:10.1 H:2.55 P:9.8 Q:41.5 
ctns::oper_renorm coord=(4,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:32 S:4 H:1 P:14 Q:18 
        dim(bra,ket)=17,17 size(op)=63:0.000481MB size(tot)=1993:0.0152MB:1.48e-05GB
        per(mem): C:46.6 S:9.63 H:3.16 P:5.82 Q:34.8 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.421e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=65 : 3.834e-04 S -----
rank=0 GPUmem(GB): used=7.877e-05 (oper)=7.877e-05
rank=0 GPUmem(GB): used=8.036e-05 (oper,site)=7.877e-05,1.587e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=65
 no. of rintermediate operators=78
 no. of coefficients=1170:8.926e-03MB:8.717e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.696e-05 S -----
rank=0 GPUmem(GB): used=8.908e-05 (oper,site,rinter)=7.877e-05,1.587e-06,8.717e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 3.090e-04 S size(rtasks)=65 size(Rlst2)=36 T(Rmu/Rlist)=7.326e-05,2.357e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.921e-04 S size(rtasks)=65 size(Rlst)=1025 -----
rank=0 GPUmem(GB): used=8.908e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.107e-03 blksize=40 blksize0=64 batchsize=1025
rank=0 GPUmem(GB): used=1.196e-03 (oper,site,rinter,batch)=7.877e-05,1.587e-06,8.717e-06,1.107e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.649e-05,7.311e-04,1.300e-04
----- TIMING FOR renorm : t_inter=9.6e-05 t_gemm=7.3e-04 t_reduction=1.3e-04 tot=9.6e-04 -----
 renorm[inter] counter=315 t=9.6e-05 per=1.0e+01 cost=1.2e+05 flops=1.2e+09
 renorm[gemm] counter=315 i=0 t=1.8e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=315 i=1 t=1.7e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=315 i=2 t=2.1e-04 per=2.2e+01 cost=4.1e+04 flops=2.0e+08
 renorm[gemm] counter=315 i=3 t=2.8e-04 per=2.9e+01 cost=1.0e+05 flops=3.7e+08
 renorm[gemm] counter=315 i=4 t=1.7e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=315 i=5 t=1.6e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=315 i=6 t=2.4e-04 per=2.5e+01 cost=1.4e+05 flops=5.8e+08
 renorm[gemm] counter=315 total t=7.3e-04 per=7.6e+01 cost=2.8e+05 flops=3.8e+08
 renorm[red] counter=315 t=1.3e-04 per=1.4e+01 cost=2.8e+04 flops=2.2e+08
----- TIMING FOR renorm_tot : t_inter=1.8e-03 t_gemm=1.9e-02 t_reduction=3.8e-03 tot=2.4e-02 -----
 renorm_tot[inter] counter=315 t=1.8e-03 per=7.6e+00 cost=1.6e+07 flops=8.6e+09
 renorm_tot[gemm] counter=315 i=0 t=3.1e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=315 i=1 t=2.5e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=315 i=2 t=4.4e-03 per=1.8e+01 cost=7.1e+06 flops=1.6e+09
 renorm_tot[gemm] counter=315 i=3 t=7.2e-03 per=3.0e+01 cost=2.2e+07 flops=3.1e+09
 renorm_tot[gemm] counter=315 i=4 t=2.6e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=315 i=5 t=2.5e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=315 i=6 t=7.0e-03 per=2.9e+01 cost=3.1e+07 flops=4.5e+09
 renorm_tot[gemm] counter=315 total t=1.9e-02 per=7.7e+01 cost=6.1e+07 flops=3.3e+09
 renorm_tot[red] counter=315 t=3.8e-03 per=1.6e+01 cost=3.8e+06 flops=1.0e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=8.964e-05 (oper)=7.913e-05
rank=0 GPUmem(GB): used=9.122e-05 (oper,site,rinter)=7.913e-05,1.587e-06,1.788e-06
rank=0 GPUmem(GB): used=1.312e-04 (oper,site,rinter,batch)=7.913e-05,1.587e-06,1.788e-06,3.997e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.905e-03 S T(preprocess/alloc/comp/red/dealloc)=3.405e-04,3.944e-04,2.206e-03,2.371e-04,5.211e-05 -----
----- TIMING FOR oper_renorm_opS : 2.928e-03 S rank=0 -----
qops.to_cpu: size(tot)=1993:1.521e-02MB:1.485e-05GB T(to_cpu)=3.117e-05S speed=4.765e-01GB/S
check ||H-H.dagger||=1.643e-14 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.00565 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=3.822e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.392e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-3.844e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local oper_env: 9.674e-03 S #####
 T(local oper_env: fetch) = 2.208e-03 S  per = 22.8  per(accum) = 22.8
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 22.8
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 22.8
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 22.8
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 22.8
 T(local oper_env: renrm) = 6.127e-03 S  per = 63.3  per(accum) = 86.2
 T(local oper_env: save ) = 1.338e-03 S  per = 13.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 6.127e-03 S  T(sum) = 6.127e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.118e-05 S  per = 0.182  per(accum) = 0.182
 T(local oper_env: qops init                    ) = 2.454e-04 S  per =    4  per(accum) = 4.19
 T(local oper_env: symbolic_formulae_renorm     ) = 3.949e-04 S  per = 6.44  per(accum) = 10.6
 T(local oper_env: allocate qops on gpu         ) = 4.990e-05 S  per = 0.814  per(accum) = 11.4
 T(local oper_env: site memcpy cpu2gpu          ) = 2.100e-05 S  per = 0.343  per(accum) = 11.8
 T(local oper_env: rintermediate init           ) = 5.893e-05 S  per = 0.962  per(accum) = 12.8
 T(local oper_env: preprocess_formulae_Rlist2   ) = 4.023e-04 S  per = 6.57  per(accum) = 19.3
 T(local oper_env: rmmtasks init                ) = 3.348e-04 S  per = 5.46  per(accum) = 24.8
 T(local oper_env: qops memset on cpu           ) = 2.900e-08 S  per = 0.000473  per(accum) = 24.8
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.096e-03 S  per = 17.9  per(accum) = 42.7
 T(local oper_env: deallocate cpu and gpu memory) = 2.799e-05 S  per = 0.457  per(accum) = 43.1
 T(local oper_env: construct opS [ifdists=true] ) = 2.943e-03 S  per =   48  per(accum) = 91.2
 T(local oper_env: reduction of opS & opH [nccl]) = 1.811e-05 S  per = 0.296  per(accum) = 91.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.189e-05 S  per = 0.684  per(accum) = 92.1
 T(local oper_env: reduction of opS & opH [mpi] ) = 1.509e-05 S  per = 0.246  per(accum) = 92.4
 T(local oper_env: qops_pool join and erase     ) = 4.664e-04 S  per = 7.61  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.310e-07 S  per = 0.00703  per(accum) = 100
##### sweep oper_env: 3.372e-01 S #####
 T(sweep oper_env: fetch) = 3.659e-02 S  per = 10.9  per(accum) = 10.9
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 10.9
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 10.9
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 10.9
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 10.9
 T(sweep oper_env: renrm) = 2.782e-01 S  per = 82.5  per(accum) = 93.4
 T(sweep oper_env: save ) = 2.234e-02 S  per = 6.63  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.604e+10 S  per = -2.604e+32
 T(sweep oper_env: preprocess                  ) = -2.604e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.782e-01 S  T(sum) = 2.782e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.183e-04 S  per = 0.0785  per(accum) = 0.0785
 T(sweep oper_env: qops init                    ) = 5.662e-03 S  per = 2.03  per(accum) = 2.11
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.615e-03 S  per = 2.02  per(accum) = 4.13
 T(sweep oper_env: allocate qops on gpu         ) = 8.038e-04 S  per = 0.289  per(accum) = 4.42
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.614e-04 S  per = 0.13  per(accum) = 4.55
 T(sweep oper_env: rintermediate init           ) = 8.702e-04 S  per = 0.313  per(accum) = 4.86
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.532e-02 S  per = 5.51  per(accum) = 10.4
 T(sweep oper_env: rmmtasks init                ) = 1.723e-02 S  per = 6.19  per(accum) = 16.6
 T(sweep oper_env: qops memset on cpu           ) = 5.690e-07 S  per = 0.000204  per(accum) = 16.6
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.722e-02 S  per = 9.78  per(accum) = 26.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.213e-03 S  per = 0.795  per(accum) = 27.1
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.864e-01 S  per =   67  per(accum) = 94.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 9.302e-04 S  per = 0.334  per(accum) = 94.5
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.452e-03 S  per = 0.522  per(accum) = 95
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 4.181e-04 S  per = 0.15  per(accum) = 95.2
 T(sweep oper_env: qops_pool join and erase     ) = 8.189e-03 S  per = 2.94  per(accum) = 98.1
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.297e-03 S  per =  1.9  per(accum) = 100

idx=16 coord=(3,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=16 scratch=./scratch/sweep size=80:5.96e-07GB T(load)=2.96e-04S speed=2.02e-03GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHPQ nops=C:32 S:4 H:1 P:14 Q:18 
        dim(bra,ket)=17,17 size(op)=63:0.000481MB size(tot)=1993:0.0152MB:1.48e-05GB
        per(mem): C:46.6 S:9.63 H:3.16 P:5.82 Q:34.8 
ctns::oper_renorm coord=(3,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:34 S:3 H:1 P:7 Q:11 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=620:0.00473MB:4.62e-06GB
        per(mem): C:57.6 S:7.26 H:3.87 P:3.23 Q:28.1 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.213e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=53 : 2.476e-04 S -----
rank=0 GPUmem(GB): used=3.687e-05 (oper)=3.687e-05
rank=0 GPUmem(GB): used=3.747e-05 (oper,site)=3.687e-05,5.960e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=53
 no. of rintermediate operators=45
 no. of coefficients=720:5.493e-03MB:5.364e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.053e-05 S -----
rank=0 GPUmem(GB): used=4.283e-05 (oper,site,rinter)=3.687e-05,5.960e-07,5.364e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.818e-04 S size(rtasks)=53 size(Rlst2)=25 T(Rmu/Rlist)=4.934e-05,1.324e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.319e-04 S size(rtasks)=53 size(Rlst)=544 -----
rank=0 GPUmem(GB): used=4.283e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.067e-04 blksize=15 blksize0=20 batchsize=544
rank=0 GPUmem(GB): used=2.495e-04 (oper,site,rinter,batch)=3.687e-05,5.960e-07,5.364e-06,2.067e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.753e-05,3.855e-04,1.002e-04
----- TIMING FOR renorm : t_inter=7.7e-05 t_gemm=3.9e-04 t_reduction=1.0e-04 tot=5.6e-04 -----
 renorm[inter] counter=324 t=7.7e-05 per=1.4e+01 cost=3.0e+04 flops=3.9e+08
 renorm[gemm] counter=324 i=0 t=1.8e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=324 i=1 t=1.6e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=324 i=2 t=1.1e-04 per=2.0e+01 cost=8.3e+03 flops=7.4e+07
 renorm[gemm] counter=324 i=3 t=1.4e-04 per=2.5e+01 cost=2.0e+04 flops=1.4e+08
 renorm[gemm] counter=324 i=4 t=1.6e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=324 i=5 t=1.6e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=324 i=6 t=1.2e-04 per=2.2e+01 cost=2.2e+04 flops=1.8e+08
 renorm[gemm] counter=324 total t=3.9e-04 per=6.8e+01 cost=5.1e+04 flops=1.3e+08
 renorm[red] counter=324 t=1.0e-04 per=1.8e+01 cost=5.8e+03 flops=5.8e+07
----- TIMING FOR renorm_tot : t_inter=1.9e-03 t_gemm=1.9e-02 t_reduction=3.9e-03 tot=2.5e-02 -----
 renorm_tot[inter] counter=324 t=1.9e-03 per=7.7e+00 cost=1.6e+07 flops=8.2e+09
 renorm_tot[gemm] counter=324 i=0 t=3.3e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=324 i=1 t=2.7e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=324 i=2 t=4.5e-03 per=1.8e+01 cost=7.1e+06 flops=1.6e+09
 renorm_tot[gemm] counter=324 i=3 t=7.3e-03 per=2.9e+01 cost=2.2e+07 flops=3.1e+09
 renorm_tot[gemm] counter=324 i=4 t=2.7e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=324 i=5 t=2.6e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=324 i=6 t=7.1e-03 per=2.9e+01 cost=3.1e+07 flops=4.4e+09
 renorm_tot[gemm] counter=324 total t=1.9e-02 per=7.7e+01 cost=6.1e+07 flops=3.2e+09
 renorm_tot[red] counter=324 t=3.9e-03 per=1.6e+01 cost=3.8e+06 flops=9.9e+08
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.378e-05 (oper)=3.698e-05
rank=0 GPUmem(GB): used=4.438e-05 (oper,site,rinter)=3.698e-05,5.960e-07,1.431e-06
rank=0 GPUmem(GB): used=5.464e-05 (oper,site,rinter,batch)=3.698e-05,5.960e-07,1.431e-06,1.026e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.892e-03 S T(preprocess/alloc/comp/red/dealloc)=2.271e-04,2.729e-04,1.449e-03,1.199e-04,3.840e-05 -----
----- TIMING FOR oper_renorm_opS : 1.912e-03 S rank=0 -----
qops.to_cpu: size(tot)=620:4.730e-03MB:4.619e-06GB T(to_cpu)=2.690e-05S speed=1.718e-01GB/S
check ||H-H.dagger||=1.003e-14 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.00376 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=2.129e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.161e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-2.176e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local oper_env: 7.748e-03 S #####
 T(local oper_env: fetch) = 2.192e-03 S  per = 28.3  per(accum) = 28.3
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 28.3
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 28.3
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 28.3
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 28.3
 T(local oper_env: renrm) = 4.220e-03 S  per = 54.5  per(accum) = 82.8
 T(local oper_env: save ) = 1.335e-03 S  per = 17.2  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.220e-03 S  T(sum) = 4.220e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.252e-05 S  per = 0.297  per(accum) = 0.297
 T(local oper_env: qops init                    ) = 2.163e-04 S  per = 5.13  per(accum) = 5.42
 T(local oper_env: symbolic_formulae_renorm     ) = 2.583e-04 S  per = 6.12  per(accum) = 11.5
 T(local oper_env: allocate qops on gpu         ) = 4.927e-05 S  per = 1.17  per(accum) = 12.7
 T(local oper_env: site memcpy cpu2gpu          ) = 2.517e-05 S  per = 0.596  per(accum) = 13.3
 T(local oper_env: rintermediate init           ) = 4.622e-05 S  per =  1.1  per(accum) = 14.4
 T(local oper_env: preprocess_formulae_Rlist2   ) = 2.410e-04 S  per = 5.71  per(accum) = 20.1
 T(local oper_env: rmmtasks init                ) = 1.900e-04 S  per =  4.5  per(accum) = 24.6
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 0.000782  per(accum) = 24.6
 T(local oper_env: preprocess_renorm_batchGPU   ) = 7.020e-04 S  per = 16.6  per(accum) = 41.3
 T(local oper_env: deallocate cpu and gpu memory) = 2.746e-05 S  per = 0.651  per(accum) = 41.9
 T(local oper_env: construct opS [ifdists=true] ) = 1.934e-03 S  per = 45.8  per(accum) = 87.7
 T(local oper_env: reduction of opS & opH [nccl]) = 1.816e-05 S  per = 0.43  per(accum) = 88.2
 T(local oper_env: qops memcpy gpu2cpu          ) = 4.143e-05 S  per = 0.982  per(accum) = 89.1
 T(local oper_env: reduction of opS & opH [mpi] ) = 9.377e-06 S  per = 0.222  per(accum) = 89.4
 T(local oper_env: qops_pool join and erase     ) = 4.481e-04 S  per = 10.6  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 5.130e-07 S  per = 0.0122  per(accum) = 100
##### sweep oper_env: 3.449e-01 S #####
 T(sweep oper_env: fetch) = 3.878e-02 S  per = 11.2  per(accum) = 11.2
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 11.2
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 11.2
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 11.2
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 11.2
 T(sweep oper_env: renrm) = 2.825e-01 S  per = 81.9  per(accum) = 93.1
 T(sweep oper_env: save ) = 2.367e-02 S  per = 6.86  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.777e+10 S  per = -2.777e+32
 T(sweep oper_env: preprocess                  ) = -2.777e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.825e-01 S  T(sum) = 2.825e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.309e-04 S  per = 0.0817  per(accum) = 0.0817
 T(sweep oper_env: qops init                    ) = 5.878e-03 S  per = 2.08  per(accum) = 2.16
 T(sweep oper_env: symbolic_formulae_renorm     ) = 5.873e-03 S  per = 2.08  per(accum) = 4.24
 T(sweep oper_env: allocate qops on gpu         ) = 8.531e-04 S  per = 0.302  per(accum) = 4.54
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.866e-04 S  per = 0.137  per(accum) = 4.68
 T(sweep oper_env: rintermediate init           ) = 9.165e-04 S  per = 0.324  per(accum) = 5.01
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.557e-02 S  per = 5.51  per(accum) = 10.5
 T(sweep oper_env: rmmtasks init                ) = 1.742e-02 S  per = 6.17  per(accum) = 16.7
 T(sweep oper_env: qops memset on cpu           ) = 6.020e-07 S  per = 0.000213  per(accum) = 16.7
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.792e-02 S  per = 9.88  per(accum) = 26.6
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.241e-03 S  per = 0.793  per(accum) = 27.4
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.884e-01 S  per = 66.7  per(accum) = 94.1
 T(sweep oper_env: reduction of opS & opH [nccl]) = 9.484e-04 S  per = 0.336  per(accum) = 94.4
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.494e-03 S  per = 0.529  per(accum) = 94.9
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 4.275e-04 S  per = 0.151  per(accum) = 95.1
 T(sweep oper_env: qops_pool join and erase     ) = 8.637e-03 S  per = 3.06  per(accum) = 98.1
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.298e-03 S  per = 1.88  per(accum) = 100

idx=17 coord=(2,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=17 scratch=./scratch/sweep size=30:2.24e-07GB T(load)=2.75e-04S speed=8.12e-04GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHPQ nops=C:34 S:3 H:1 P:7 Q:11 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=620:0.00473MB:4.62e-06GB
        per(mem): C:57.6 S:7.26 H:3.87 P:3.23 Q:28.1 
ctns::oper_renorm coord=(2,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:36 S:2 H:1 P:3 Q:5 
        dim(bra,ket)=6,6 size(op)=10:7.63e-05MB size(tot)=164:0.00125MB:1.22e-06GB
        per(mem): C:65.9 S:4.88 H:6.1 P:0 Q:23.2 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.053e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=45 : 1.585e-04 S -----
rank=0 GPUmem(GB): used=2.325e-05 (oper)=2.325e-05
rank=0 GPUmem(GB): used=2.347e-05 (oper,site)=2.325e-05,2.235e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=45
 no. of rintermediate operators=21
 no. of coefficients=357:2.724e-03MB:2.660e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.282e-05 S -----
rank=0 GPUmem(GB): used=2.613e-05 (oper,site,rinter)=2.325e-05,2.235e-07,2.660e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.211e-04 S size(rtasks)=45 size(Rlst2)=16 T(Rmu/Rlist)=3.941e-05,8.164e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.563e-04 S size(rtasks)=45 size(Rlst)=334 -----
rank=0 GPUmem(GB): used=2.613e-05 avail=3.829e+01 total=3.829e+01 batch[need]=5.475e-05 blksize=6 blksize0=9 batchsize=334
rank=0 GPUmem(GB): used=8.088e-05 (oper,site,rinter,batch)=2.325e-05,2.235e-07,2.660e-06,5.475e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=7.601e-05,2.763e-04,9.845e-05
----- TIMING FOR renorm : t_inter=7.6e-05 t_gemm=2.8e-04 t_reduction=9.8e-05 tot=4.5e-04 -----
 renorm[inter] counter=331 t=7.6e-05 per=1.7e+01 cost=5.9e+03 flops=7.8e+07
 renorm[gemm] counter=331 i=0 t=1.9e-06 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=331 i=1 t=1.6e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=331 i=2 t=9.0e-05 per=2.0e+01 cost=1.4e+03 flops=1.6e+07
 renorm[gemm] counter=331 i=3 t=1.0e-04 per=2.2e+01 cost=3.4e+03 flops=3.4e+07
 renorm[gemm] counter=331 i=4 t=1.6e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=331 i=5 t=1.6e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=331 i=6 t=7.8e-05 per=1.7e+01 cost=3.6e+03 flops=4.7e+07
 renorm[gemm] counter=331 total t=2.8e-04 per=6.1e+01 cost=8.5e+03 flops=3.1e+07
 renorm[red] counter=331 t=9.8e-05 per=2.2e+01 cost=1.5e+03 flops=1.5e+07
----- TIMING FOR renorm_tot : t_inter=2.0e-03 t_gemm=1.9e-02 t_reduction=4.0e-03 tot=2.5e-02 -----
 renorm_tot[inter] counter=331 t=2.0e-03 per=7.9e+00 cost=1.6e+07 flops=7.9e+09
 renorm_tot[gemm] counter=331 i=0 t=3.5e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=331 i=1 t=2.8e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=331 i=2 t=4.6e-03 per=1.8e+01 cost=7.1e+06 flops=1.5e+09
 renorm_tot[gemm] counter=331 i=3 t=7.4e-03 per=2.9e+01 cost=2.2e+07 flops=3.0e+09
 renorm_tot[gemm] counter=331 i=4 t=2.9e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=331 i=5 t=2.8e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=331 i=6 t=7.2e-03 per=2.8e+01 cost=3.1e+07 flops=4.4e+09
 renorm_tot[gemm] counter=331 total t=1.9e-02 per=7.6e+01 cost=6.1e+07 flops=3.2e+09
 renorm_tot[red] counter=331 t=4.0e-03 per=1.6e+01 cost=3.8e+06 flops=9.7e+08
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.695e-05 (oper)=2.328e-05
rank=0 GPUmem(GB): used=2.717e-05 (oper,site,rinter)=2.328e-05,2.235e-07,1.013e-06
rank=0 GPUmem(GB): used=3.012e-05 (oper,site,rinter,batch)=2.328e-05,2.235e-07,1.013e-06,2.950e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.189e-03 S T(preprocess/alloc/comp/red/dealloc)=1.779e-04,2.248e-04,8.377e-04,8.176e-05,3.715e-05 -----
----- TIMING FOR oper_renorm_opS : 1.206e-03 S rank=0 -----
qops.to_cpu: size(tot)=164:1.251e-03MB:1.222e-06GB T(to_cpu)=2.327e-05S speed=5.251e-02GB/S
check ||H-H.dagger||=3.297e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00268 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.324e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.055e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.267e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local oper_env: 6.675e-03 S #####
 T(local oper_env: fetch) = 2.183e-03 S  per = 32.7  per(accum) = 32.7
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 32.7
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 32.7
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 32.7
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 32.7
 T(local oper_env: renrm) = 3.142e-03 S  per = 47.1  per(accum) = 79.8
 T(local oper_env: save ) = 1.350e-03 S  per = 20.2  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.142e-03 S  T(sum) = 3.142e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.347e-05 S  per = 0.429  per(accum) = 0.429
 T(local oper_env: qops init                    ) = 2.022e-04 S  per = 6.44  per(accum) = 6.87
 T(local oper_env: symbolic_formulae_renorm     ) = 1.686e-04 S  per = 5.37  per(accum) = 12.2
 T(local oper_env: allocate qops on gpu         ) = 4.353e-05 S  per = 1.39  per(accum) = 13.6
 T(local oper_env: site memcpy cpu2gpu          ) = 2.119e-05 S  per = 0.674  per(accum) = 14.3
 T(local oper_env: rintermediate init           ) = 5.782e-05 S  per = 1.84  per(accum) = 16.1
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.644e-04 S  per = 5.23  per(accum) = 21.4
 T(local oper_env: rmmtasks init                ) = 1.269e-04 S  per = 4.04  per(accum) = 25.4
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 0.00105  per(accum) = 25.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 6.019e-04 S  per = 19.2  per(accum) = 44.6
 T(local oper_env: deallocate cpu and gpu memory) = 2.229e-05 S  per = 0.709  per(accum) = 45.3
 T(local oper_env: construct opS [ifdists=true] ) = 1.217e-03 S  per = 38.7  per(accum) = 84
 T(local oper_env: reduction of opS & opH [nccl]) = 1.811e-05 S  per = 0.576  per(accum) = 84.6
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.341e-05 S  per = 1.06  per(accum) = 85.6
 T(local oper_env: reduction of opS & opH [mpi] ) = 7.773e-06 S  per = 0.247  per(accum) = 85.9
 T(local oper_env: qops_pool join and erase     ) = 4.435e-04 S  per = 14.1  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.200e-07 S  per = 0.0134  per(accum) = 100
##### sweep oper_env: 3.516e-01 S #####
 T(sweep oper_env: fetch) = 4.096e-02 S  per = 11.7  per(accum) = 11.7
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 11.7
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 11.7
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 11.7
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 11.7
 T(sweep oper_env: renrm) = 2.856e-01 S  per = 81.2  per(accum) = 92.9
 T(sweep oper_env: save ) = 2.502e-02 S  per = 7.12  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -2.951e+10 S  per = -2.951e+32
 T(sweep oper_env: preprocess                  ) = -2.951e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.856e-01 S  T(sum) = 2.856e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.443e-04 S  per = 0.0856  per(accum) = 0.0856
 T(sweep oper_env: qops init                    ) = 6.080e-03 S  per = 2.13  per(accum) = 2.21
 T(sweep oper_env: symbolic_formulae_renorm     ) = 6.042e-03 S  per = 2.12  per(accum) = 4.33
 T(sweep oper_env: allocate qops on gpu         ) = 8.966e-04 S  per = 0.314  per(accum) = 4.64
 T(sweep oper_env: site memcpy cpu2gpu          ) = 4.078e-04 S  per = 0.143  per(accum) = 4.79
 T(sweep oper_env: rintermediate init           ) = 9.743e-04 S  per = 0.341  per(accum) = 5.13
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.573e-02 S  per = 5.51  per(accum) = 10.6
 T(sweep oper_env: rmmtasks init                ) = 1.755e-02 S  per = 6.14  per(accum) = 16.8
 T(sweep oper_env: qops memset on cpu           ) = 6.350e-07 S  per = 0.000222  per(accum) = 16.8
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.852e-02 S  per = 9.99  per(accum) = 26.8
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.263e-03 S  per = 0.792  per(accum) = 27.6
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.896e-01 S  per = 66.4  per(accum) = 93.9
 T(sweep oper_env: reduction of opS & opH [nccl]) = 9.665e-04 S  per = 0.338  per(accum) = 94.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.527e-03 S  per = 0.535  per(accum) = 94.8
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 4.352e-04 S  per = 0.152  per(accum) = 95
 T(sweep oper_env: qops_pool join and erase     ) = 9.081e-03 S  per = 3.18  per(accum) = 98.1
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.298e-03 S  per = 1.86  per(accum) = 100

idx=18 coord=(1,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=18 scratch=./scratch/sweep size=10:7.45e-08GB T(load)=2.92e-04S speed=2.55e-04GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHPQ nops=C:36 S:2 H:1 P:3 Q:5 
        dim(bra,ket)=6,6 size(op)=10:7.63e-05MB size(tot)=164:0.00125MB:1.22e-06GB
        per(mem): C:65.9 S:4.88 H:6.1 P:0 Q:23.2 
ctns::oper_renorm coord=(1,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:38 S:1 H:1 P:0 Q:2 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=46:0.000351MB:3.43e-07GB
        per(mem): C:82.6 S:2.17 H:6.52 Q:8.7 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=8.989e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=41 : 8.454e-05 S -----
rank=0 GPUmem(GB): used=1.897e-05 (oper)=1.897e-05
rank=0 GPUmem(GB): used=1.904e-05 (oper,site)=1.897e-05,7.451e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=41
 no. of rintermediate operators=6
 no. of coefficients=108:8.240e-04MB:8.047e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.312e-05 S -----
rank=0 GPUmem(GB): used=1.985e-05 (oper,site,rinter)=1.897e-05,7.451e-08,8.047e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 7.820e-05 S size(rtasks)=41 size(Rlst2)=9 T(Rmu/Rlist)=2.959e-05,4.857e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.515e-05 S size(rtasks)=41 size(Rlst)=185 -----
rank=0 GPUmem(GB): used=1.985e-05 avail=3.829e+01 total=3.829e+01 batch[need]=9.649e-06 blksize=2 blksize0=2 batchsize=185
rank=0 GPUmem(GB): used=2.950e-05 (oper,site,rinter,batch)=1.897e-05,7.451e-08,8.047e-07,9.649e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.469e-05,1.691e-04,7.793e-05
----- TIMING FOR renorm : t_inter=6.5e-05 t_gemm=1.7e-04 t_reduction=7.8e-05 tot=3.1e-04 -----
 renorm[inter] counter=336 t=6.5e-05 per=2.1e+01 cost=4.3e+02 flops=6.7e+06
 renorm[gemm] counter=336 i=0 t=1.9e-06 per=6.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=336 i=1 t=1.6e-06 per=5.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=336 i=2 t=5.9e-05 per=1.9e+01 cost=2.3e+02 flops=3.9e+06
 renorm[gemm] counter=336 i=3 t=5.5e-05 per=1.8e+01 cost=4.9e+02 flops=8.9e+06
 renorm[gemm] counter=336 i=4 t=1.6e-06 per=5.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=336 i=5 t=1.6e-06 per=5.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=336 i=6 t=4.8e-05 per=1.6e+01 cost=5.9e+02 flops=1.2e+07
 renorm[gemm] counter=336 total t=1.7e-04 per=5.4e+01 cost=1.3e+03 flops=7.7e+06
 renorm[red] counter=336 t=7.8e-05 per=2.5e+01 cost=3.7e+02 flops=4.8e+06
----- TIMING FOR renorm_tot : t_inter=2.1e-03 t_gemm=1.9e-02 t_reduction=4.0e-03 tot=2.6e-02 -----
 renorm_tot[inter] counter=336 t=2.1e-03 per=8.1e+00 cost=1.6e+07 flops=7.7e+09
 renorm_tot[gemm] counter=336 i=0 t=3.6e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=336 i=1 t=3.0e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=336 i=2 t=4.7e-03 per=1.8e+01 cost=7.1e+06 flops=1.5e+09
 renorm_tot[gemm] counter=336 i=3 t=7.5e-03 per=2.9e+01 cost=2.2e+07 flops=3.0e+09
 renorm_tot[gemm] counter=336 i=4 t=3.0e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=336 i=5 t=3.0e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=336 i=6 t=7.2e-03 per=2.8e+01 cost=3.1e+07 flops=4.4e+09
 renorm_tot[gemm] counter=336 total t=1.9e-02 per=7.6e+01 cost=6.1e+07 flops=3.1e+09
 renorm_tot[red] counter=336 t=4.0e-03 per=1.6e+01 cost=3.8e+06 flops=9.5e+08
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.032e-05 (oper)=1.898e-05
rank=0 GPUmem(GB): used=2.039e-05 (oper,site,rinter)=1.898e-05,7.451e-08,5.364e-07
rank=0 GPUmem(GB): used=2.081e-05 (oper,site,rinter,batch)=1.898e-05,7.451e-08,5.364e-07,4.172e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.501e-04 S T(preprocess/alloc/comp/red/dealloc)=7.432e-05,1.146e-04,2.490e-04,5.304e-05,2.906e-05 -----
----- TIMING FOR oper_renorm_opS : 4.648e-04 S rank=0 -----
qops.to_cpu: size(tot)=46:3.510e-04MB:3.427e-07GB T(to_cpu)=2.045e-05S speed=1.676e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.00162 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=7.756e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-9.822e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-7.451e-07 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local oper_env: 5.548e-03 S #####
 T(local oper_env: fetch) = 2.197e-03 S  per = 39.6  per(accum) = 39.6
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 39.6
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 39.6
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 39.6
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 39.6
 T(local oper_env: renrm) = 2.074e-03 S  per = 37.4  per(accum) = 77
 T(local oper_env: save ) = 1.278e-03 S  per =   23  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.074e-03 S  T(sum) = 2.074e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.357e-05 S  per = 0.654  per(accum) = 0.654
 T(local oper_env: qops init                    ) = 1.972e-04 S  per = 9.51  per(accum) = 10.2
 T(local oper_env: symbolic_formulae_renorm     ) = 9.569e-05 S  per = 4.61  per(accum) = 14.8
 T(local oper_env: allocate qops on gpu         ) = 4.352e-05 S  per =  2.1  per(accum) = 16.9
 T(local oper_env: site memcpy cpu2gpu          ) = 2.915e-05 S  per = 1.41  per(accum) = 18.3
 T(local oper_env: rintermediate init           ) = 4.729e-05 S  per = 2.28  per(accum) = 20.6
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.006e-04 S  per = 4.85  per(accum) = 25.4
 T(local oper_env: rmmtasks init                ) = 8.963e-05 S  per = 4.32  per(accum) = 29.7
 T(local oper_env: qops memset on cpu           ) = 3.300e-08 S  per = 0.00159  per(accum) = 29.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.662e-04 S  per = 22.5  per(accum) = 52.2
 T(local oper_env: deallocate cpu and gpu memory) = 1.867e-05 S  per =  0.9  per(accum) = 53.1
 T(local oper_env: construct opS [ifdists=true] ) = 4.747e-04 S  per = 22.9  per(accum) = 76
 T(local oper_env: reduction of opS & opH [nccl]) = 1.793e-05 S  per = 0.864  per(accum) = 76.9
 T(local oper_env: qops memcpy gpu2cpu          ) = 3.023e-05 S  per = 1.46  per(accum) = 78.3
 T(local oper_env: reduction of opS & opH [mpi] ) = 6.896e-06 S  per = 0.332  per(accum) = 78.7
 T(local oper_env: qops_pool join and erase     ) = 4.423e-04 S  per = 21.3  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.140e-07 S  per = 0.02  per(accum) = 100
##### sweep oper_env: 3.571e-01 S #####
 T(sweep oper_env: fetch) = 4.316e-02 S  per = 12.1  per(accum) = 12.1
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 12.1
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 12.1
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 12.1
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 12.1
 T(sweep oper_env: renrm) = 2.877e-01 S  per = 80.6  per(accum) = 92.6
 T(sweep oper_env: save ) = 2.630e-02 S  per = 7.36  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.124e+10 S  per = -3.124e+32
 T(sweep oper_env: preprocess                  ) = -3.124e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.877e-01 S  T(sum) = 2.877e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.579e-04 S  per = 0.0897  per(accum) = 0.0897
 T(sweep oper_env: qops init                    ) = 6.277e-03 S  per = 2.18  per(accum) = 2.27
 T(sweep oper_env: symbolic_formulae_renorm     ) = 6.138e-03 S  per = 2.13  per(accum) = 4.41
 T(sweep oper_env: allocate qops on gpu         ) = 9.401e-04 S  per = 0.327  per(accum) = 4.73
 T(sweep oper_env: site memcpy cpu2gpu          ) = 4.369e-04 S  per = 0.152  per(accum) = 4.88
 T(sweep oper_env: rintermediate init           ) = 1.022e-03 S  per = 0.355  per(accum) = 5.24
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.583e-02 S  per =  5.5  per(accum) = 10.7
 T(sweep oper_env: rmmtasks init                ) = 1.764e-02 S  per = 6.13  per(accum) = 16.9
 T(sweep oper_env: qops memset on cpu           ) = 6.680e-07 S  per = 0.000232  per(accum) = 16.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.899e-02 S  per = 10.1  per(accum) = 26.9
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.282e-03 S  per = 0.793  per(accum) = 27.7
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.901e-01 S  per = 66.1  per(accum) = 93.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 9.844e-04 S  per = 0.342  per(accum) = 94.2
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.557e-03 S  per = 0.541  per(accum) = 94.7
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 4.421e-04 S  per = 0.154  per(accum) = 94.8
 T(sweep oper_env: qops_pool join and erase     ) = 9.523e-03 S  per = 3.31  per(accum) = 98.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.299e-03 S  per = 1.84  per(accum) = 100

idx=19 coord=(0,0)
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=0:0MB:0GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=3:2.29e-05MB:2.24e-08GB
total mem of comb=151:0.00115MB:1.13e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.490e-07 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=19 scratch=./scratch/sweep size=3:2.24e-08GB T(load)=2.83e-04S speed=7.90e-05GB/S
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:1.78e-02MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHPQ nops=C:38 S:1 H:1 P:0 Q:2 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=46:0.000351MB:3.43e-07GB
        per(mem): C:82.6 S:2.17 H:6.52 Q:8.7 
ctns::oper_renorm coord=(0,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:40 S:0 H:1 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
        per(mem): C:0 H:100 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=8.902e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=41 : 4.056e-05 S -----
rank=0 GPUmem(GB): used=1.775e-05 (oper)=1.775e-05
rank=0 GPUmem(GB): used=1.778e-05 (oper,site)=1.775e-05,2.235e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=41
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=1.778e-05 (oper,site,rinter)=1.775e-05,2.235e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 5.383e-05 S size(rtasks)=41 size(Rlst2)=1 T(Rmu/Rlist)=2.935e-05,2.445e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.468e-05 S size(rtasks)=41 size(Rlst)=58 -----
rank=0 GPUmem(GB): used=1.778e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.296e-06 blksize=1 blksize0=0 batchsize=58
rank=0 GPUmem(GB): used=1.907e-05 (oper,site,rinter,batch)=1.775e-05,2.235e-08,0.000e+00,1.296e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.760e-06,1.540e-04,5.674e-05
----- TIMING FOR renorm : t_inter=5.7e-06 t_gemm=1.5e-04 t_reduction=5.7e-05 tot=2.2e-04 -----
 renorm[inter] counter=338 t=5.7e-06 per=2.6e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=338 i=0 t=2.1e-06 per=9.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=338 i=1 t=1.7e-06 per=7.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=338 i=2 t=6.0e-05 per=2.8e+01 cost=5.2e+01 flops=8.6e+05
 renorm[gemm] counter=338 i=3 t=4.4e-05 per=2.0e+01 cost=5.2e+01 flops=1.2e+06
 renorm[gemm] counter=338 i=4 t=1.7e-06 per=7.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=338 i=5 t=1.6e-06 per=7.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=338 i=6 t=4.3e-05 per=2.0e+01 cost=1.2e+02 flops=2.7e+06
 renorm[gemm] counter=338 total t=1.5e-04 per=7.1e+01 cost=2.2e+02 flops=1.4e+06
 renorm[red] counter=338 t=5.7e-05 per=2.6e+01 cost=1.2e+02 flops=2.0e+06
----- TIMING FOR renorm_tot : t_inter=2.1e-03 t_gemm=2.0e-02 t_reduction=4.1e-03 tot=2.6e-02 -----
 renorm_tot[inter] counter=338 t=2.1e-03 per=8.0e+00 cost=1.6e+07 flops=7.6e+09
 renorm_tot[gemm] counter=338 i=0 t=3.9e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=338 i=1 t=3.2e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=338 i=2 t=4.7e-03 per=1.8e+01 cost=7.1e+06 flops=1.5e+09
 renorm_tot[gemm] counter=338 i=3 t=7.5e-03 per=2.9e+01 cost=2.2e+07 flops=3.0e+09
 renorm_tot[gemm] counter=338 i=4 t=3.2e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=338 i=5 t=3.1e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=338 i=6 t=7.3e-03 per=2.8e+01 cost=3.1e+07 flops=4.3e+09
 renorm_tot[gemm] counter=338 total t=2.0e-02 per=7.6e+01 cost=6.1e+07 flops=3.1e+09
 renorm_tot[red] counter=338 t=4.1e-03 per=1.6e+01 cost=3.8e+06 flops=9.3e+08
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 2.4e-06 S rank=0 -----
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB T(to_cpu)=1.8e-05S speed=4.1e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.000904 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=3.619e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-9.347e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-2.682e-07 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local oper_env: 4.781e-03 S #####
 T(local oper_env: fetch) = 2.149e-03 S  per = 44.9  per(accum) = 44.9
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 44.9
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 44.9
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 44.9
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 44.9
 T(local oper_env: renrm) = 1.348e-03 S  per = 28.2  per(accum) = 73.1
 T(local oper_env: save ) = 1.284e-03 S  per = 26.9  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.736e+09 S  per = -1.736e+31
 T(local oper_env: preprocess                  ) = -1.736e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.348e-03 S  T(sum) = 1.348e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.275e-05 S  per = 0.946  per(accum) = 0.946
 T(local oper_env: qops init                    ) = 1.838e-04 S  per = 13.6  per(accum) = 14.6
 T(local oper_env: symbolic_formulae_renorm     ) = 5.059e-05 S  per = 3.75  per(accum) = 18.3
 T(local oper_env: allocate qops on gpu         ) = 4.362e-05 S  per = 3.24  per(accum) = 21.6
 T(local oper_env: site memcpy cpu2gpu          ) = 2.289e-05 S  per =  1.7  per(accum) = 23.3
 T(local oper_env: rintermediate init           ) = 2.163e-05 S  per =  1.6  per(accum) = 24.9
 T(local oper_env: preprocess_formulae_Rlist2   ) = 6.852e-05 S  per = 5.08  per(accum) = 30
 T(local oper_env: rmmtasks init                ) = 5.167e-05 S  per = 3.83  per(accum) = 33.8
 T(local oper_env: qops memset on cpu           ) = 2.600e-08 S  per = 0.00193  per(accum) = 33.8
 T(local oper_env: preprocess_renorm_batchGPU   ) = 3.702e-04 S  per = 27.5  per(accum) = 61.3
 T(local oper_env: deallocate cpu and gpu memory) = 1.556e-05 S  per = 1.15  per(accum) = 62.4
 T(local oper_env: construct opS [ifdists=true] ) = 1.764e-05 S  per = 1.31  per(accum) = 63.7
 T(local oper_env: reduction of opS & opH [nccl]) = 2.396e-05 S  per = 1.78  per(accum) = 65.5
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.654e-05 S  per = 1.97  per(accum) = 67.5
 T(local oper_env: reduction of opS & opH [mpi] ) = 7.006e-06 S  per = 0.52  per(accum) = 68
 T(local oper_env: qops_pool join and erase     ) = 4.312e-04 S  per =   32  per(accum) = 100
 T(local oper_env: conversion from opAB to opPQ ) = 4.410e-07 S  per = 0.0327  per(accum) = 100
##### sweep oper_env: 3.619e-01 S #####
 T(sweep oper_env: fetch) = 4.531e-02 S  per = 12.5  per(accum) = 12.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 12.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 12.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 12.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 12.5
 T(sweep oper_env: renrm) = 2.890e-01 S  per = 79.9  per(accum) = 92.4
 T(sweep oper_env: save ) = 2.759e-02 S  per = 7.62  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.298e+10 S  per = -3.298e+32
 T(sweep oper_env: preprocess                  ) = -3.298e+10 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [Hx_batchGPU]        ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [cpu-gpu]            ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [nccl]               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [mpi]                ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson [rest part(linalg)]  ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.890e-01 S  T(sum) = 2.890e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.707e-04 S  per = 0.0936  per(accum) = 0.0936
 T(sweep oper_env: qops init                    ) = 6.461e-03 S  per = 2.24  per(accum) = 2.33
 T(sweep oper_env: symbolic_formulae_renorm     ) = 6.188e-03 S  per = 2.14  per(accum) = 4.47
 T(sweep oper_env: allocate qops on gpu         ) = 9.838e-04 S  per = 0.34  per(accum) = 4.81
 T(sweep oper_env: site memcpy cpu2gpu          ) = 4.598e-04 S  per = 0.159  per(accum) = 4.97
 T(sweep oper_env: rintermediate init           ) = 1.043e-03 S  per = 0.361  per(accum) = 5.33
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 1.590e-02 S  per =  5.5  per(accum) = 10.8
 T(sweep oper_env: rmmtasks init                ) = 1.769e-02 S  per = 6.12  per(accum) = 17
 T(sweep oper_env: qops memset on cpu           ) = 6.940e-07 S  per = 0.00024  per(accum) = 17
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 2.936e-02 S  per = 10.2  per(accum) = 27.1
 T(sweep oper_env: deallocate cpu and gpu memory) = 2.297e-03 S  per = 0.795  per(accum) = 27.9
 T(sweep oper_env: construct opS [ifdists=true] ) = 1.901e-01 S  per = 65.8  per(accum) = 93.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.008e-03 S  per = 0.349  per(accum) = 94
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.584e-03 S  per = 0.548  per(accum) = 94.6
 T(sweep oper_env: reduction of opS & opH [mpi] ) = 4.491e-04 S  per = 0.155  per(accum) = 94.7
 T(sweep oper_env: qops_pool join and erase     ) = 9.954e-03 S  per = 3.44  per(accum) = 98.2
 T(sweep oper_env: conversion from opAB to opPQ ) = 5.299e-03 S  per = 1.83  per(accum) = 100
ctns::rcanon_load_sites scratch=./scratch/sweep T(load)=0.0049S
----- TIMING FOR ctns::oper_env_right : 5.065e-01 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.125,0.0453,0.277,0.0392,0.487
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=1.626e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::oper_load iomode=0 fname=./scratch/sweep/rop(0,0)
fname=./scratch/sweep/rop(0,0) size=7.451e-09GB T[load](info/setup/data/tot)=2.719e-04,2.200e-05,2.523e-04,5.462e-04 speed=1.364e-05GB/S
matrix: Hij size=(1,1)
     -1.164465409846e+02 
matrix: Sij size=(1,1)
      1.000000000000e+00 

ctns::sweep_opt maxsweep=1
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-2.980e-08 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 

ctns::oper_init_dotL isym=2 ifkr=0 singlet=0
ctns::oper_save iomode=0 fname=./scratch/sweep/lop(0,0) size=1.782e-02MB:1.740e-05GB
fname=./scratch/sweep/lop(0,0) size=1.74e-05GB T[save](info/data/tot)=0.000674,0.000611,0.00128 speed=0.0135GB/S disk[used]=0.004GB
----- TIMING FOR ctns::oper_init_dotL : 5.594e-03 S -----

ctns::topology::get_sweeps ifboundary=0
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(3,0)-(4,0) forward=1 cturn=0
 ibond=3 bond=(4,0)-(5,0) forward=1 cturn=0
 ibond=4 bond=(5,0)-(6,0) forward=1 cturn=0
 ibond=5 bond=(6,0)-(7,0) forward=1 cturn=0
 ibond=6 bond=(7,0)-(8,0) forward=1 cturn=0
 ibond=7 bond=(8,0)-(9,0) forward=1 cturn=0
 ibond=8 bond=(9,0)-(10,0) forward=1 cturn=0
 ibond=9 bond=(10,0)-(11,0) forward=1 cturn=0
 ibond=10 bond=(11,0)-(12,0) forward=1 cturn=0
 ibond=11 bond=(12,0)-(13,0) forward=1 cturn=0
 ibond=12 bond=(13,0)-(14,0) forward=1 cturn=0
 ibond=13 bond=(14,0)-(15,0) forward=1 cturn=0
 ibond=14 bond=(15,0)-(16,0) forward=1 cturn=0
 ibond=15 bond=(16,0)-(17,0) forward=1 cturn=0
 ibond=16 bond=(17,0)-(18,0) forward=1 cturn=0
 ibond=17 bond=(17,0)-(18,0) forward=0 cturn=0
 ibond=18 bond=(16,0)-(17,0) forward=0 cturn=0
 ibond=19 bond=(15,0)-(16,0) forward=0 cturn=0
 ibond=20 bond=(14,0)-(15,0) forward=0 cturn=0
 ibond=21 bond=(13,0)-(14,0) forward=0 cturn=0
 ibond=22 bond=(12,0)-(13,0) forward=0 cturn=0
 ibond=23 bond=(11,0)-(12,0) forward=0 cturn=0
 ibond=24 bond=(10,0)-(11,0) forward=0 cturn=0
 ibond=25 bond=(9,0)-(10,0) forward=0 cturn=0
 ibond=26 bond=(8,0)-(9,0) forward=0 cturn=0
 ibond=27 bond=(7,0)-(8,0) forward=0 cturn=0
 ibond=28 bond=(6,0)-(7,0) forward=0 cturn=0
 ibond=29 bond=(5,0)-(6,0) forward=0 cturn=0
 ibond=30 bond=(4,0)-(5,0) forward=0 cturn=0
 ibond=31 bond=(3,0)-(4,0) forward=0 cturn=0
 ibond=32 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=33 bond=(1,0)-(2,0) forward=0 cturn=0
..... end of get_sweeps .....

======================================================================
sweep parameters: isweep=0 dots=1 dcut=100 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=1 sym_state=(30,0) singlet=0
qtensor3: site0new own=1 _data=0x55b2c60393c0
qinfo3: site0new sym=(0,0) dir=1,0,1
 qbond: qrow nsym=1 dimAll=1
 (0,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=4 nblocks=16 size=4:3.05e-05MB
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=14591:0.111MB:0.000109GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=10:7.63e-05MB:7.45e-08GB
total mem of comb=14749:0.113MB:0.00011GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=2.404e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_save_sites scratch=./scratch/sweep T(save)=1.06e-02S

isweep=0 ibond=0/seqsize=34 dots=1 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.804e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=17 scratch=./scratch/sweep size=30:2.24e-07GB T(load)=3.22e-04S speed=6.93e-04GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=30:2.29e-04MB:2.24e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=10:7.63e-05MB:7.45e-08GB
total mem of comb=188:1.43e-03MB:1.40e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=1.267e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=1,18,1
 suppl= 0
 suppr= 2 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 1
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(2,0)
 fqop[2]=./scratch/sweep/cop(1,0)
qops info: rank=0
 lqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHPQ nops=C:36 S:2 H:1 P:3 Q:5 
        dim(bra,ket)=6,6 size(op)=10:7.63e-05MB size(tot)=164:0.00125MB:1.22e-06GB
        per(mem): C:65.9 S:4.88 H:6.1 P:0 Q:23.2 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=4836:0.0369MB:3.6e-05GB
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.782e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=-2.003e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(4,6,4) nnz=10:7.629e-05MB
qtensor3: wf3 own=1 _data=0x55b2c51a4460
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qcol nsym=4 dimAll=6
 (27,-1):2 (27,1):2 (26,0):1 (28,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=6 nblocks=64 size=10:7.629e-05MB
### DIAG TIMING: total=1.675e-04 t1=1.905e-05, t2=1.376e-05, t3=1.960e-05, t4=5.308e-05, t5=1.249e-05, t6=4.109e-05, t7=8.433e-06
duration_diagGPU:1.874e-04
duration_diagreduce:3.700e-08
duration_diagtransform:1.590e-07
----- TIMING FOR symbolic_formulae_onedot with size=63 : 1.557e-04 S -----
rank=0 GPUmem(GB): used=3.603e-05 (oper)=3.603e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=63
 no. of hintermediate operators=10
 no. of coefficients=180:1.373e-03MB:1.341e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.756e-05 S -----
rank=0 GPUmem(GB): used=3.737e-05 (oper,hinter)=3.603e-05,1.341e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.224e-04 S size(H_formulae)=63 size(Hxlst2)=6 T(Hmu/Hxlist)=4.241e-05,7.994e-05 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.428e-04 S size(H_formulae)=63 size(Hxlst)=250 -----
rank=0 GPUmem(GB): used=3.737e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.490e-07 batch[need]=1.304e-05 blksize=2 blksize0=2 batchsize=250
rank=0 GPUmem(GB): used=5.056e-05 (oper,hinter,dvdson,batch)=3.603e-05,1.341e-06,1.490e-07,1.304e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=10 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.134e-05,7.101e-05,2.568e-04,1.327e-04,5.393e-04
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=2.082e-05 speed=7.157e-03GB/S T(nccl)=5.052e-05 speed=2.950e-03GB/S
----- TIMING FOR sigma : t_inter=7.1e-05 t_gemm=2.6e-04 t_reduction=1.3e-04 tot=4.6e-04 -----
 sigma[inter] counter=1 t=7.1e-05 per=1.5e+01 cost=1.3e+03 flops=1.8e+07
 sigma[gemm] counter=1 i=0 t=2.6e-06 per=5.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=1 t=2.0e-06 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=1 i=2 t=8.0e-05 per=1.8e+01 cost=4.6e+02 flops=5.8e+06
 sigma[gemm] counter=1 i=3 t=6.5e-05 per=1.4e+01 cost=4.6e+02 flops=7.2e+06
 sigma[gemm] counter=1 i=4 t=5.4e-05 per=1.2e+01 cost=2.2e+02 flops=4.1e+06
 sigma[gemm] counter=1 i=5 t=5.2e-05 per=1.1e+01 cost=2.2e+02 flops=4.2e+06
 sigma[gemm] counter=1 total t=2.6e-04 per=5.6e+01 cost=1.4e+03 flops=5.3e+06
 sigma[red] counter=1 t=1.3e-04 per=2.9e+01 cost=7.8e+02 flops=5.9e+06
----- TIMING FOR sigma_tot : t_inter=7.1e-05 t_gemm=2.6e-04 t_reduction=1.3e-04 tot=4.6e-04 -----
 sigma_tot[inter] counter=1 t=7.1e-05 per=1.5e+01 cost=1.3e+03 flops=1.8e+07
 sigma_tot[gemm] counter=1 i=0 t=2.6e-06 per=5.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=1 t=2.0e-06 per=4.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=1 i=2 t=8.0e-05 per=1.8e+01 cost=4.6e+02 flops=5.8e+06
 sigma_tot[gemm] counter=1 i=3 t=6.5e-05 per=1.4e+01 cost=4.6e+02 flops=7.2e+06
 sigma_tot[gemm] counter=1 i=4 t=5.4e-05 per=1.2e+01 cost=2.2e+02 flops=4.1e+06
 sigma_tot[gemm] counter=1 i=5 t=5.2e-05 per=1.1e+01 cost=2.2e+02 flops=4.2e+06
 sigma_tot[gemm] counter=1 total t=2.6e-04 per=5.6e+01 cost=1.4e+03 flops=5.3e+06
 sigma_tot[red] counter=1 t=1.3e-04 per=2.9e+01 cost=7.8e+02 flops=5.9e+06
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,4.9e-06,1.4e-06,4.4e-06,2.4e-07
settings: ndim=10 neig=1 maxcycle=30 nbuff=4 memory=1e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.446540984635 -1.116e+03  1.854e-03    1     1  7.866e-04 7.866e-04 7.351e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.824e-05,6.125e-05,2.782e-04,1.397e-04,5.520e-04
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=2.385e-05 speed=6.249e-03GB/S T(nccl)=4.439e-05 speed=3.357e-03GB/S
----- TIMING FOR sigma : t_inter=6.1e-05 t_gemm=2.8e-04 t_reduction=1.4e-04 tot=4.8e-04 -----
 sigma[inter] counter=2 t=6.1e-05 per=1.3e+01 cost=1.3e+03 flops=2.1e+07
 sigma[gemm] counter=2 i=0 t=2.6e-06 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=1 t=2.3e-06 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=2 i=2 t=7.6e-05 per=1.6e+01 cost=4.6e+02 flops=6.1e+06
 sigma[gemm] counter=2 i=3 t=7.4e-05 per=1.5e+01 cost=4.6e+02 flops=6.3e+06
 sigma[gemm] counter=2 i=4 t=6.0e-05 per=1.2e+01 cost=2.2e+02 flops=3.7e+06
 sigma[gemm] counter=2 i=5 t=6.4e-05 per=1.3e+01 cost=2.2e+02 flops=3.5e+06
 sigma[gemm] counter=2 total t=2.8e-04 per=5.8e+01 cost=1.4e+03 flops=4.9e+06
 sigma[red] counter=2 t=1.4e-04 per=2.9e+01 cost=7.8e+02 flops=5.6e+06
----- TIMING FOR sigma_tot : t_inter=1.3e-04 t_gemm=5.3e-04 t_reduction=2.7e-04 tot=9.4e-04 -----
 sigma_tot[inter] counter=2 t=1.3e-04 per=1.4e+01 cost=2.6e+03 flops=2.0e+07
 sigma_tot[gemm] counter=2 i=0 t=5.2e-06 per=5.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=1 t=4.4e-06 per=4.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=2 i=2 t=1.6e-04 per=1.7e+01 cost=9.3e+02 flops=5.9e+06
 sigma_tot[gemm] counter=2 i=3 t=1.4e-04 per=1.5e+01 cost=9.3e+02 flops=6.7e+06
 sigma_tot[gemm] counter=2 i=4 t=1.1e-04 per=1.2e+01 cost=4.4e+02 flops=3.9e+06
 sigma_tot[gemm] counter=2 i=5 t=1.2e-04 per=1.2e+01 cost=4.4e+02 flops=3.8e+06
 sigma_tot[gemm] counter=2 total t=5.3e-04 per=5.7e+01 cost=2.7e+03 flops=5.1e+06
 sigma_tot[red] counter=2 t=2.7e-04 per=2.9e+01 cost=1.6e+03 flops=5.7e+06
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=6.7e-06,2.5e-05,2.6e-06,2.0e-06,2.6e-07
    2   0 -    -116.446552892441 -1.191e-05  5.374e-04    2     2  1.684e-03 8.418e-04 7.630e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.507e-05,5.816e-05,2.709e-04,1.454e-04,5.434e-04
 analyze_tgpu[Hx]: ndim=10:7.451e-08GB T(cpu-gpu)=2.249e-05 speed=6.625e-03GB/S T(nccl)=4.258e-05 speed=3.500e-03GB/S
----- TIMING FOR sigma : t_inter=5.8e-05 t_gemm=2.7e-04 t_reduction=1.5e-04 tot=4.7e-04 -----
 sigma[inter] counter=3 t=5.8e-05 per=1.2e+01 cost=1.3e+03 flops=2.2e+07
 sigma[gemm] counter=3 i=0 t=2.4e-06 per=5.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=1 t=2.3e-06 per=4.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=3 i=2 t=7.4e-05 per=1.6e+01 cost=4.6e+02 flops=6.3e+06
 sigma[gemm] counter=3 i=3 t=7.3e-05 per=1.5e+01 cost=4.6e+02 flops=6.3e+06
 sigma[gemm] counter=3 i=4 t=6.0e-05 per=1.3e+01 cost=2.2e+02 flops=3.7e+06
 sigma[gemm] counter=3 i=5 t=5.9e-05 per=1.2e+01 cost=2.2e+02 flops=3.7e+06
 sigma[gemm] counter=3 total t=2.7e-04 per=5.7e+01 cost=1.4e+03 flops=5.1e+06
 sigma[red] counter=3 t=1.5e-04 per=3.1e+01 cost=7.8e+02 flops=5.4e+06
----- TIMING FOR sigma_tot : t_inter=1.9e-04 t_gemm=8.0e-04 t_reduction=4.2e-04 tot=1.4e-03 -----
 sigma_tot[inter] counter=3 t=1.9e-04 per=1.3e+01 cost=3.9e+03 flops=2.0e+07
 sigma_tot[gemm] counter=3 i=0 t=7.6e-06 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=1 t=6.6e-06 per=4.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=3 i=2 t=2.3e-04 per=1.6e+01 cost=1.4e+03 flops=6.1e+06
 sigma_tot[gemm] counter=3 i=3 t=2.1e-04 per=1.5e+01 cost=1.4e+03 flops=6.6e+06
 sigma_tot[gemm] counter=3 i=4 t=1.7e-04 per=1.2e+01 cost=6.7e+02 flops=3.8e+06
 sigma_tot[gemm] counter=3 i=5 t=1.8e-04 per=1.2e+01 cost=6.6e+02 flops=3.8e+06
 sigma_tot[gemm] counter=3 total t=8.0e-04 per=5.7e+01 cost=4.1e+03 flops=5.1e+06
 sigma_tot[red] counter=3 t=4.2e-04 per=3.0e+01 cost=2.3e+03 flops=5.6e+06
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,1.8e-05,1.9e-06,1.2e-06,2.1e-07
    3   0 +    -116.446553669725 -7.773e-07  3.049e-05    3     3  2.492e-03 8.308e-04 7.597e-04
TIMING FOR Davidson : 2.516e-03  T(cal/comm/rest)=2.279e-03,4.088e-06,2.332e-04
decomposed t_rest=2.332e-04
 T(sub)    =7.480e-05 per=3.208e+01
 T(precond)=1.959e-05 per=8.402e+00
 T(ortho)  =4.440e-06 per=1.904e+00
 T(xcopy)  =6.440e-07 per=2.762e-01
 T(xnrm2)  =2.121e-06 per=9.097e-01
 T(other)  =1.316e-04 per=5.643e+01
optimized energies: isweep=0 ibond=0 dots=1 e[0]=-116.446553669725 nmvp=3
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.071e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=9 alg_decim=0 mpisize=2
 qbond: qsuper nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
----- TIMING FOR onedot_decimation: 8.2e-05 S T(wf/decim)=3.4e-05,4.9e-05 -----
ctns::oper_renorm coord=(1,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:4 S:18 H:1 A:3 B:5 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=742:5.7e-03MB:5.5e-06GB
        per(mem): C:12.9 S:58.2 H:4.85 A:5.12 B:18.9 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=5.541e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=13 : 2.596e-05 S -----
rank=0 GPUmem(GB): used=4.168e-05 (oper)=4.034e-05
rank=0 GPUmem(GB): used=4.195e-05 (oper,site)=4.034e-05,2.682e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=13
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=4.195e-05 (oper,site,rinter)=4.034e-05,2.682e-07,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 7.122e-05 S size(rtasks)=13 size(Rlst2)=81 T(Rmu/Rlist)=1.460e-05,5.659e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.213e-05 S size(rtasks)=13 size(Rlst)=178 -----
rank=0 GPUmem(GB): used=4.195e-05 avail=3.829e+01 total=3.829e+01 batch[need]=4.376e-05 blksize=16 blksize0=0 batchsize=178
rank=0 GPUmem(GB): used=8.571e-05 (oper,site,rinter,batch)=4.034e-05,2.682e-07,0.000e+00,4.376e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=6.696e-06,2.634e-04,1.428e-04
----- TIMING FOR renorm : t_inter=6.6e-06 t_gemm=2.6e-04 t_reduction=1.4e-04 tot=4.1e-04 -----
 renorm[inter] counter=1 t=6.6e-06 per=1.6e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=2.9e-06 per=7.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=1 t=2.2e-06 per=5.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=2 t=2.1e-06 per=5.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=3 t=2.1e-06 per=5.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=4 t=8.6e-05 per=2.1e+01 cost=1.8e+02 flops=2.1e+06
 renorm[gemm] counter=1 i=5 t=6.5e-05 per=1.6e+01 cost=4.2e+02 flops=6.4e+06
 renorm[gemm] counter=1 i=6 t=1.0e-04 per=2.5e+01 cost=2.2e+03 flops=2.2e+07
 renorm[gemm] counter=1 total t=2.6e-04 per=6.4e+01 cost=2.8e+03 flops=1.1e+07
 renorm[red] counter=1 t=1.4e-04 per=3.5e+01 cost=2.2e+03 flops=1.6e+07
----- TIMING FOR renorm_tot : t_inter=6.6e-06 t_gemm=2.6e-04 t_reduction=1.4e-04 tot=4.1e-04 -----
 renorm_tot[inter] counter=1 t=6.6e-06 per=1.6e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=2.9e-06 per=7.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=1 t=2.2e-06 per=5.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=2 t=2.1e-06 per=5.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=3 t=2.1e-06 per=5.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=4 t=8.6e-05 per=2.1e+01 cost=1.8e+02 flops=2.1e+06
 renorm_tot[gemm] counter=1 i=5 t=6.5e-05 per=1.6e+01 cost=4.2e+02 flops=6.4e+06
 renorm_tot[gemm] counter=1 i=6 t=1.0e-04 per=2.5e+01 cost=2.2e+03 flops=2.2e+07
 renorm_tot[gemm] counter=1 total t=2.6e-04 per=6.4e+01 cost=2.8e+03 flops=1.1e+07
 renorm_tot[red] counter=1 t=1.4e-04 per=3.5e+01 cost=2.2e+03 flops=1.6e+07
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.186e-05 (oper)=4.052e-05
rank=0 GPUmem(GB): used=4.213e-05 (oper,site,rinter)=4.052e-05,2.682e-07,0.000e+00
rank=0 GPUmem(GB): used=4.618e-05 (oper,site,rinter,batch)=4.052e-05,2.682e-07,0.000e+00,4.053e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 9.891e-03 S T(preprocess/alloc/comp/red/dealloc)=1.251e-03,1.332e-03,7.289e-03,1.177e-03,2.506e-05 -----
----- TIMING FOR oper_renorm_opS : 9.929e-03 S rank=0 -----
qops.to_cpu: size(tot)=742:5.661e-03MB:5.528e-06GB T(to_cpu)=2.231e-05S speed=2.478e-01GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.0114 S rank=0 -----
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=6.044e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=5.341e-04 change=-1.813e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=5.341e-04 change=-1.520e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 2.361e-02 S #####
 T(local opt: fetch) = 5.785e-03 S  per = 24.5  per(accum) = 24.5
 T(local opt: hdiag) = 3.268e-04 S  per = 1.38  per(accum) = 25.9
 T(local opt: dvdsn) = 3.403e-03 S  per = 14.4  per(accum) = 40.3
 T(local opt: decim) = 1.114e-04 S  per = 0.472  per(accum) = 40.8
 T(local opt: guess) = 3.111e-05 S  per = 0.132  per(accum) = 40.9
 T(local opt: renrm) = 1.213e-02 S  per = 51.4  per(accum) = 92.3
 T(local opt: save ) = 1.829e-03 S  per = 7.75  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.403e-03 S  T(sum) = 3.110e-03 S  per = 9.137e+01
 T(local opt: preprocess                  ) = 5.045e-05 S  per = 1.62  per(accum) = 1.62
 T(local opt: symbolic_formulae           ) = 1.709e-04 S  per =  5.5  per(accum) = 7.12
 T(local opt: hintermediate init          ) = 7.170e-05 S  per = 2.31  per(accum) = 9.42
 T(local opt: preprocess_hformulae_Hxlist ) = 1.557e-04 S  per = 5.01  per(accum) = 14.4
 T(local opt: hmmtasks init               ) = 1.406e-04 S  per = 4.52  per(accum) = 19
 T(local opt: initial guess for dvdson    ) = 4.286e-06 S  per = 0.138  per(accum) = 19.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.074e-03 S  per = 66.7  per(accum) = 85.8
 T(local opt: dvdson [cpu-gpu]            ) = 6.716e-05 S  per = 2.16  per(accum) = 88
 T(local opt: dvdson [nccl]               ) = 1.375e-04 S  per = 4.42  per(accum) = 92.4
 T(local opt: dvdson [mpi]                ) = 4.088e-06 S  per = 0.131  per(accum) = 92.5
 T(local opt: dvdson [rest part(linalg)]  ) = 2.332e-04 S  per =  7.5  per(accum) = 100
Detailed decomposition of T(renrm) = 1.213e-02 S  T(sum) = 1.213e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.178e-05 S  per = 0.345  per(accum) = 0.345
 T(local opt: qops init                    ) = 3.054e-04 S  per = 2.52  per(accum) = 2.86
 T(local opt: symbolic_formulae_renorm     ) = 3.772e-05 S  per = 0.311  per(accum) = 3.17
 T(local opt: allocate qops on gpu         ) = 5.869e-05 S  per = 0.484  per(accum) = 3.66
 T(local opt: site memcpy cpu2gpu          ) = 2.907e-05 S  per = 0.24  per(accum) = 3.9
 T(local opt: rintermediate init           ) = 3.141e-05 S  per = 0.259  per(accum) = 4.16
 T(local opt: preprocess_formulae_Rlist2   ) = 1.050e-04 S  per = 0.865  per(accum) = 5.02
 T(local opt: rmmtasks init                ) = 1.471e-04 S  per = 1.21  per(accum) = 6.23
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 0.00028  per(accum) = 6.23
 T(local opt: preprocess_renorm_batchGPU   ) = 6.299e-04 S  per = 5.19  per(accum) = 11.4
 T(local opt: deallocate cpu and gpu memory) = 2.446e-05 S  per = 0.202  per(accum) = 11.6
 T(local opt: construct opS [ifdists=true] ) = 9.980e-03 S  per = 82.3  per(accum) = 93.9
 T(local opt: reduction of opS & opH [nccl]) = 1.875e-05 S  per = 0.155  per(accum) = 94.1
 T(local opt: qops memcpy gpu2cpu          ) = 3.225e-05 S  per = 0.266  per(accum) = 94.3
 T(local opt: reduction of opS & opH [mpi] ) = 4.308e-05 S  per = 0.355  per(accum) = 94.7
 T(local opt: qops_pool join and erase     ) = 6.414e-04 S  per = 5.29  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.820e-07 S  per = 0.00727  per(accum) = 100
ctns::rcanon_save_site idx=18 scratch=./scratch/sweep size=36:2.7e-07GB T(load)=0.00057S speed=0.00047GB/S
##### sweep opt: 2.361e-02 S #####
 T(sweep opt: fetch) = 5.785e-03 S  per = 24.5  per(accum) = 24.5
 T(sweep opt: hdiag) = 3.268e-04 S  per = 1.38  per(accum) = 25.9
 T(sweep opt: dvdsn) = 3.403e-03 S  per = 14.4  per(accum) = 40.3
 T(sweep opt: decim) = 1.114e-04 S  per = 0.472  per(accum) = 40.8
 T(sweep opt: guess) = 3.111e-05 S  per = 0.132  per(accum) = 40.9
 T(sweep opt: renrm) = 1.213e-02 S  per = 51.4  per(accum) = 92.3
 T(sweep opt: save ) = 1.829e-03 S  per = 7.75  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.403e-03 S  T(sum) = 3.110e-03 S  per = 9.137e+01
 T(sweep opt: preprocess                  ) = 5.045e-05 S  per = 1.62  per(accum) = 1.62
 T(sweep opt: symbolic_formulae           ) = 1.709e-04 S  per =  5.5  per(accum) = 7.12
 T(sweep opt: hintermediate init          ) = 7.170e-05 S  per = 2.31  per(accum) = 9.42
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.557e-04 S  per = 5.01  per(accum) = 14.4
 T(sweep opt: hmmtasks init               ) = 1.406e-04 S  per = 4.52  per(accum) = 19
 T(sweep opt: initial guess for dvdson    ) = 4.286e-06 S  per = 0.138  per(accum) = 19.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.074e-03 S  per = 66.7  per(accum) = 85.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 6.716e-05 S  per = 2.16  per(accum) = 88
 T(sweep opt: dvdson [nccl]               ) = 1.375e-04 S  per = 4.42  per(accum) = 92.4
 T(sweep opt: dvdson [mpi]                ) = 4.088e-06 S  per = 0.131  per(accum) = 92.5
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.332e-04 S  per =  7.5  per(accum) = 100
Detailed decomposition of T(renrm) = 1.213e-02 S  T(sum) = 1.213e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.178e-05 S  per = 0.345  per(accum) = 0.345
 T(sweep opt: qops init                    ) = 3.054e-04 S  per = 2.52  per(accum) = 2.86
 T(sweep opt: symbolic_formulae_renorm     ) = 3.772e-05 S  per = 0.311  per(accum) = 3.17
 T(sweep opt: allocate qops on gpu         ) = 5.869e-05 S  per = 0.484  per(accum) = 3.66
 T(sweep opt: site memcpy cpu2gpu          ) = 2.907e-05 S  per = 0.24  per(accum) = 3.9
 T(sweep opt: rintermediate init           ) = 3.141e-05 S  per = 0.259  per(accum) = 4.16
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.050e-04 S  per = 0.865  per(accum) = 5.02
 T(sweep opt: rmmtasks init                ) = 1.471e-04 S  per = 1.21  per(accum) = 6.23
 T(sweep opt: qops memset on cpu           ) = 3.400e-08 S  per = 0.00028  per(accum) = 6.23
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.299e-04 S  per = 5.19  per(accum) = 11.4
 T(sweep opt: deallocate cpu and gpu memory) = 2.446e-05 S  per = 0.202  per(accum) = 11.6
 T(sweep opt: construct opS [ifdists=true] ) = 9.980e-03 S  per = 82.3  per(accum) = 93.9
 T(sweep opt: reduction of opS & opH [nccl]) = 1.875e-05 S  per = 0.155  per(accum) = 94.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.225e-05 S  per = 0.266  per(accum) = 94.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.308e-05 S  per = 0.355  per(accum) = 94.7
 T(sweep opt: qops_pool join and erase     ) = 6.414e-04 S  per = 5.29  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 8.820e-07 S  per = 0.00727  per(accum) = 100
##### global opt: 2.361e-02 S #####
 T(global opt: fetch) = 5.785e-03 S  per = 24.5  per(accum) = 24.5
 T(global opt: hdiag) = 3.268e-04 S  per = 1.38  per(accum) = 25.9
 T(global opt: dvdsn) = 3.403e-03 S  per = 14.4  per(accum) = 40.3
 T(global opt: decim) = 1.114e-04 S  per = 0.472  per(accum) = 40.8
 T(global opt: guess) = 3.111e-05 S  per = 0.132  per(accum) = 40.9
 T(global opt: renrm) = 1.213e-02 S  per = 51.4  per(accum) = 92.3
 T(global opt: save ) = 1.829e-03 S  per = 7.75  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.403e-03 S  T(sum) = 3.110e-03 S  per = 9.137e+01
 T(global opt: preprocess                  ) = 5.045e-05 S  per = 1.62  per(accum) = 1.62
 T(global opt: symbolic_formulae           ) = 1.709e-04 S  per =  5.5  per(accum) = 7.12
 T(global opt: hintermediate init          ) = 7.170e-05 S  per = 2.31  per(accum) = 9.42
 T(global opt: preprocess_hformulae_Hxlist ) = 1.557e-04 S  per = 5.01  per(accum) = 14.4
 T(global opt: hmmtasks init               ) = 1.406e-04 S  per = 4.52  per(accum) = 19
 T(global opt: initial guess for dvdson    ) = 4.286e-06 S  per = 0.138  per(accum) = 19.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.074e-03 S  per = 66.7  per(accum) = 85.8
 T(global opt: dvdson [cpu-gpu]            ) = 6.716e-05 S  per = 2.16  per(accum) = 88
 T(global opt: dvdson [nccl]               ) = 1.375e-04 S  per = 4.42  per(accum) = 92.4
 T(global opt: dvdson [mpi]                ) = 4.088e-06 S  per = 0.131  per(accum) = 92.5
 T(global opt: dvdson [rest part(linalg)]  ) = 2.332e-04 S  per =  7.5  per(accum) = 100
Detailed decomposition of T(renrm) = 1.213e-02 S  T(sum) = 1.213e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.178e-05 S  per = 0.345  per(accum) = 0.345
 T(global opt: qops init                    ) = 3.054e-04 S  per = 2.52  per(accum) = 2.86
 T(global opt: symbolic_formulae_renorm     ) = 3.772e-05 S  per = 0.311  per(accum) = 3.17
 T(global opt: allocate qops on gpu         ) = 5.869e-05 S  per = 0.484  per(accum) = 3.66
 T(global opt: site memcpy cpu2gpu          ) = 2.907e-05 S  per = 0.24  per(accum) = 3.9
 T(global opt: rintermediate init           ) = 3.141e-05 S  per = 0.259  per(accum) = 4.16
 T(global opt: preprocess_formulae_Rlist2   ) = 1.050e-04 S  per = 0.865  per(accum) = 5.02
 T(global opt: rmmtasks init                ) = 1.471e-04 S  per = 1.21  per(accum) = 6.23
 T(global opt: qops memset on cpu           ) = 3.400e-08 S  per = 0.00028  per(accum) = 6.23
 T(global opt: preprocess_renorm_batchGPU   ) = 6.299e-04 S  per = 5.19  per(accum) = 11.4
 T(global opt: deallocate cpu and gpu memory) = 2.446e-05 S  per = 0.202  per(accum) = 11.6
 T(global opt: construct opS [ifdists=true] ) = 9.980e-03 S  per = 82.3  per(accum) = 93.9
 T(global opt: reduction of opS & opH [nccl]) = 1.875e-05 S  per = 0.155  per(accum) = 94.1
 T(global opt: qops memcpy gpu2cpu          ) = 3.225e-05 S  per = 0.266  per(accum) = 94.3
 T(global opt: reduction of opS & opH [mpi] ) = 4.308e-05 S  per = 0.355  per(accum) = 94.7
 T(global opt: qops_pool join and erase     ) = 6.414e-04 S  per = 5.29  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 8.820e-07 S  per = 0.00727  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.093e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=1/seqsize=34 dots=1 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=16 scratch=./scratch/sweep size=80:5.96e-07GB T(load)=3.06e-04S speed=1.95e-03GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=110:8.39e-04MB:8.20e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=38:2.90e-04MB:2.83e-07GB
total mem of comb=296:2.26e-03MB:2.21e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=2.176e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=2,17,1
 suppl= 0 1
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 2
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:4 S:18 H:1 A:3 B:5 
        dim(bra,ket)=16,16 size(op)=36:2.747e-04MB size(tot)=742:5.661e-03MB:5.528e-06GB
        per(mem): C:12.9 S:58.2 H:4.85 A:5.12 B:18.9 
 rqops: oplist=CSHPQ nops=C:34 S:3 H:1 P:7 Q:11 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=620:0.00473MB:4.62e-06GB
        per(mem): C:57.6 S:7.26 H:3.87 P:3.23 Q:28.1 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3698:0.0282MB:2.76e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.258e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-4.411e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(16,10,4) nnz=38:2.899e-04MB
qtensor3: wf3 own=1 _data=0x55b2c61ce140
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
 qbond: qcol nsym=5 dimAll=10
 (25,-1):3 (26,-2):3 (26,0):2 (27,-3):1 (24,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=10 nblocks=180 size=38:2.899e-04MB
### DIAG TIMING: total=2.085e-04 t1=1.417e-05, t2=1.205e-05, t3=1.435e-05, t4=1.076e-04, t5=9.533e-06, t6=4.434e-05, t7=6.394e-06
duration_diagGPU:2.160e-04
duration_diagreduce:6.400e-08
duration_diagtransform:1.620e-07
----- TIMING FOR symbolic_formulae_onedot with size=98 : 1.990e-04 S -----
rank=0 GPUmem(GB): used=2.755e-05 (oper)=2.755e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=98
 no. of hintermediate operators=29
 no. of coefficients=493:3.761e-03MB:3.673e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.123e-05 S -----
rank=0 GPUmem(GB): used=3.123e-05 (oper,hinter)=2.755e-05,3.673e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.693e-04 S size(H_formulae)=98 size(Hxlst2)=10 T(Hmu/Hxlist)=3.737e-05,1.318e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.185e-04 S size(H_formulae)=98 size(Hxlst)=618 -----
rank=0 GPUmem(GB): used=3.123e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=5.662e-07 batch[need]=1.566e-04 blksize=12 blksize0=9 batchsize=618
rank=0 GPUmem(GB): used=1.883e-04 (oper,hinter,dvdson,batch)=2.755e-05,3.673e-06,5.662e-07,1.566e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=38 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.825e-05,6.998e-05,4.941e-04,1.579e-04,7.952e-04
 analyze_tgpu[Hx]: ndim=38:2.831e-07GB T(cpu-gpu)=2.125e-05 speed=2.664e-02GB/S T(nccl)=4.699e-05 speed=1.205e-02GB/S
----- TIMING FOR sigma : t_inter=7.0e-05 t_gemm=4.9e-04 t_reduction=1.6e-04 tot=7.2e-04 -----
 sigma[inter] counter=4 t=7.0e-05 per=9.7e+00 cost=1.9e+04 flops=2.7e+08
 sigma[gemm] counter=4 i=0 t=1.9e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=1 t=1.6e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=4 i=2 t=1.2e-04 per=1.7e+01 cost=4.3e+03 flops=3.6e+07
 sigma[gemm] counter=4 i=3 t=1.3e-04 per=1.9e+01 cost=4.4e+03 flops=3.3e+07
 sigma[gemm] counter=4 i=4 t=1.2e-04 per=1.6e+01 cost=3.0e+03 flops=2.6e+07
 sigma[gemm] counter=4 i=5 t=1.2e-04 per=1.7e+01 cost=3.0e+03 flops=2.5e+07
 sigma[gemm] counter=4 total t=4.9e-04 per=6.8e+01 cost=1.5e+04 flops=3.0e+07
 sigma[red] counter=4 t=1.6e-04 per=2.2e+01 cost=4.8e+03 flops=3.0e+07
----- TIMING FOR sigma_tot : t_inter=2.6e-04 t_gemm=1.3e-03 t_reduction=5.8e-04 tot=2.1e-03 -----
 sigma_tot[inter] counter=4 t=2.6e-04 per=1.2e+01 cost=2.3e+04 flops=8.9e+07
 sigma_tot[gemm] counter=4 i=0 t=9.5e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=1 t=8.3e-06 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=4 i=2 t=3.5e-04 per=1.6e+01 cost=5.7e+03 flops=1.6e+07
 sigma_tot[gemm] counter=4 i=3 t=3.5e-04 per=1.6e+01 cost=5.8e+03 flops=1.7e+07
 sigma_tot[gemm] counter=4 i=4 t=2.9e-04 per=1.4e+01 cost=3.7e+03 flops=1.3e+07
 sigma_tot[gemm] counter=4 i=5 t=3.0e-04 per=1.4e+01 cost=3.7e+03 flops=1.3e+07
 sigma_tot[gemm] counter=4 total t=1.3e-03 per=6.1e+01 cost=1.9e+04 flops=1.5e+07
 sigma_tot[red] counter=4 t=5.8e-04 per=2.7e+01 cost=7.1e+03 flops=1.2e+07
T(sub)=8.2e-06 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,3.1e-06,9.6e-07,9.0e-07,1.7e-07
settings: ndim=38 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.446553669725 -1.116e+03  7.304e-02    1     1  8.849e-04 8.849e-04 8.673e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.172e-05,6.092e-05,5.569e-04,1.691e-04,8.526e-04
 analyze_tgpu[Hx]: ndim=38:2.831e-07GB T(cpu-gpu)=2.151e-05 speed=2.632e-02GB/S T(nccl)=4.021e-05 speed=1.408e-02GB/S
----- TIMING FOR sigma : t_inter=6.1e-05 t_gemm=5.6e-04 t_reduction=1.7e-04 tot=7.9e-04 -----
 sigma[inter] counter=5 t=6.1e-05 per=7.7e+00 cost=1.9e+04 flops=3.2e+08
 sigma[gemm] counter=5 i=0 t=1.9e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=1 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=5 i=2 t=1.3e-04 per=1.7e+01 cost=4.3e+03 flops=3.3e+07
 sigma[gemm] counter=5 i=3 t=1.5e-04 per=2.0e+01 cost=4.4e+03 flops=2.9e+07
 sigma[gemm] counter=5 i=4 t=1.3e-04 per=1.6e+01 cost=3.0e+03 flops=2.4e+07
 sigma[gemm] counter=5 i=5 t=1.4e-04 per=1.8e+01 cost=3.0e+03 flops=2.2e+07
 sigma[gemm] counter=5 total t=5.6e-04 per=7.1e+01 cost=1.5e+04 flops=2.7e+07
 sigma[red] counter=5 t=1.7e-04 per=2.1e+01 cost=4.8e+03 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=3.2e-04 t_gemm=1.9e-03 t_reduction=7.4e-04 tot=2.9e-03 -----
 sigma_tot[inter] counter=5 t=3.2e-04 per=1.1e+01 cost=4.2e+04 flops=1.3e+08
 sigma_tot[gemm] counter=5 i=0 t=1.1e-05 per=3.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=1 t=1.0e-05 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=5 i=2 t=4.8e-04 per=1.6e+01 cost=1.0e+04 flops=2.1e+07
 sigma_tot[gemm] counter=5 i=3 t=5.0e-04 per=1.7e+01 cost=1.0e+04 flops=2.0e+07
 sigma_tot[gemm] counter=5 i=4 t=4.2e-04 per=1.4e+01 cost=6.7e+03 flops=1.6e+07
 sigma_tot[gemm] counter=5 i=5 t=4.4e-04 per=1.5e+01 cost=6.8e+03 flops=1.5e+07
 sigma_tot[gemm] counter=5 total t=1.9e-03 per=6.4e+01 cost=3.4e+04 flops=1.8e+07
 sigma_tot[red] counter=5 t=7.4e-04 per=2.5e+01 cost=1.2e+04 flops=1.6e+07
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.2e-05,2.2e-06,1.2e-06,2.1e-07
    2   0 -    -116.456269522721 -9.716e-03  1.427e-02    2     2  1.878e-03 9.391e-04 9.014e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.054e-05,5.930e-05,5.545e-04,1.684e-04,8.462e-04
 analyze_tgpu[Hx]: ndim=38:2.831e-07GB T(cpu-gpu)=2.153e-05 speed=2.630e-02GB/S T(nccl)=3.901e-05 speed=1.452e-02GB/S
----- TIMING FOR sigma : t_inter=5.9e-05 t_gemm=5.5e-04 t_reduction=1.7e-04 tot=7.8e-04 -----
 sigma[inter] counter=6 t=5.9e-05 per=7.6e+00 cost=1.9e+04 flops=3.2e+08
 sigma[gemm] counter=6 i=0 t=1.9e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=1 t=1.8e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=6 i=2 t=1.3e-04 per=1.7e+01 cost=4.3e+03 flops=3.4e+07
 sigma[gemm] counter=6 i=3 t=1.5e-04 per=1.9e+01 cost=4.4e+03 flops=2.9e+07
 sigma[gemm] counter=6 i=4 t=1.3e-04 per=1.6e+01 cost=3.0e+03 flops=2.4e+07
 sigma[gemm] counter=6 i=5 t=1.4e-04 per=1.8e+01 cost=3.0e+03 flops=2.1e+07
 sigma[gemm] counter=6 total t=5.5e-04 per=7.1e+01 cost=1.5e+04 flops=2.7e+07
 sigma[red] counter=6 t=1.7e-04 per=2.2e+01 cost=4.8e+03 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=3.8e-04 t_gemm=2.4e-03 t_reduction=9.1e-04 tot=3.7e-03 -----
 sigma_tot[inter] counter=6 t=3.8e-04 per=1.0e+01 cost=6.1e+04 flops=1.6e+08
 sigma_tot[gemm] counter=6 i=0 t=1.3e-05 per=3.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=1 t=1.2e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=6 i=2 t=6.1e-04 per=1.6e+01 cost=1.4e+04 flops=2.4e+07
 sigma_tot[gemm] counter=6 i=3 t=6.5e-04 per=1.8e+01 cost=1.5e+04 flops=2.2e+07
 sigma_tot[gemm] counter=6 i=4 t=5.4e-04 per=1.5e+01 cost=9.8e+03 flops=1.8e+07
 sigma_tot[gemm] counter=6 i=5 t=5.8e-04 per=1.6e+01 cost=9.8e+03 flops=1.7e+07
 sigma_tot[gemm] counter=6 total t=2.4e-03 per=6.5e+01 cost=4.9e+04 flops=2.0e+07
 sigma_tot[red] counter=6 t=9.1e-04 per=2.5e+01 cost=1.7e+04 flops=1.8e+07
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.1e-06,1.3e-05,1.9e-06,1.2e-06,2.2e-07
    3   0 -    -116.456593866436 -3.243e-04  2.612e-03    3     3  2.909e-03 9.697e-04 9.303e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.978e-05,6.737e-05,5.639e-04,1.704e-04,8.651e-04
 analyze_tgpu[Hx]: ndim=38:2.831e-07GB T(cpu-gpu)=2.077e-05 speed=2.727e-02GB/S T(nccl)=3.901e-05 speed=1.451e-02GB/S
----- TIMING FOR sigma : t_inter=6.7e-05 t_gemm=5.6e-04 t_reduction=1.7e-04 tot=8.0e-04 -----
 sigma[inter] counter=7 t=6.7e-05 per=8.4e+00 cost=1.9e+04 flops=2.8e+08
 sigma[gemm] counter=7 i=0 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=1 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=7 i=2 t=1.3e-04 per=1.7e+01 cost=4.3e+03 flops=3.3e+07
 sigma[gemm] counter=7 i=3 t=1.6e-04 per=2.0e+01 cost=4.4e+03 flops=2.8e+07
 sigma[gemm] counter=7 i=4 t=1.3e-04 per=1.6e+01 cost=3.0e+03 flops=2.4e+07
 sigma[gemm] counter=7 i=5 t=1.4e-04 per=1.8e+01 cost=3.0e+03 flops=2.1e+07
 sigma[gemm] counter=7 total t=5.6e-04 per=7.0e+01 cost=1.5e+04 flops=2.6e+07
 sigma[red] counter=7 t=1.7e-04 per=2.1e+01 cost=4.8e+03 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=4.5e-04 t_gemm=3.0e-03 t_reduction=1.1e-03 tot=4.5e-03 -----
 sigma_tot[inter] counter=7 t=4.5e-04 per=9.9e+00 cost=8.1e+04 flops=1.8e+08
 sigma_tot[gemm] counter=7 i=0 t=1.5e-05 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=1 t=1.4e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=7 i=2 t=7.4e-04 per=1.6e+01 cost=1.9e+04 flops=2.5e+07
 sigma_tot[gemm] counter=7 i=3 t=8.1e-04 per=1.8e+01 cost=1.9e+04 flops=2.4e+07
 sigma_tot[gemm] counter=7 i=4 t=6.7e-04 per=1.5e+01 cost=1.3e+04 flops=1.9e+07
 sigma_tot[gemm] counter=7 i=5 t=7.2e-04 per=1.6e+01 cost=1.3e+04 flops=1.8e+07
 sigma_tot[gemm] counter=7 total t=3.0e-03 per=6.6e+01 cost=6.3e+04 flops=2.1e+07
 sigma_tot[red] counter=7 t=1.1e-03 per=2.4e+01 cost=2.1e+04 flops=2.0e+07
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=2.8e-06,1.1e-05,1.6e-06,1.1e-06,1.7e-07
    4   0 -    -116.456606829843 -1.296e-05  9.429e-04    3     4  3.963e-03 9.907e-04 9.521e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.979e-05,5.941e-05,5.541e-04,1.699e-04,8.465e-04
 analyze_tgpu[Hx]: ndim=38:2.831e-07GB T(cpu-gpu)=2.091e-05 speed=2.708e-02GB/S T(nccl)=3.888e-05 speed=1.456e-02GB/S
----- TIMING FOR sigma : t_inter=5.9e-05 t_gemm=5.5e-04 t_reduction=1.7e-04 tot=7.8e-04 -----
 sigma[inter] counter=8 t=5.9e-05 per=7.6e+00 cost=1.9e+04 flops=3.2e+08
 sigma[gemm] counter=8 i=0 t=2.0e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=1 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=8 i=2 t=1.3e-04 per=1.6e+01 cost=4.3e+03 flops=3.4e+07
 sigma[gemm] counter=8 i=3 t=1.5e-04 per=2.0e+01 cost=4.4e+03 flops=2.9e+07
 sigma[gemm] counter=8 i=4 t=1.3e-04 per=1.6e+01 cost=3.0e+03 flops=2.4e+07
 sigma[gemm] counter=8 i=5 t=1.4e-04 per=1.8e+01 cost=3.0e+03 flops=2.1e+07
 sigma[gemm] counter=8 total t=5.5e-04 per=7.1e+01 cost=1.5e+04 flops=2.7e+07
 sigma[red] counter=8 t=1.7e-04 per=2.2e+01 cost=4.8e+03 flops=2.8e+07
----- TIMING FOR sigma_tot : t_inter=5.1e-04 t_gemm=3.5e-03 t_reduction=1.3e-03 tot=5.3e-03 -----
 sigma_tot[inter] counter=8 t=5.1e-04 per=9.6e+00 cost=1.0e+05 flops=2.0e+08
 sigma_tot[gemm] counter=8 i=0 t=1.7e-05 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=1 t=1.6e-05 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=8 i=2 t=8.7e-04 per=1.6e+01 cost=2.3e+04 flops=2.7e+07
 sigma_tot[gemm] counter=8 i=3 t=9.6e-04 per=1.8e+01 cost=2.3e+04 flops=2.4e+07
 sigma_tot[gemm] counter=8 i=4 t=8.0e-04 per=1.5e+01 cost=1.6e+04 flops=2.0e+07
 sigma_tot[gemm] counter=8 i=5 t=8.7e-04 per=1.6e+01 cost=1.6e+04 flops=1.8e+07
 sigma_tot[gemm] counter=8 total t=3.5e-03 per=6.7e+01 cost=7.8e+04 flops=2.2e+07
 sigma_tot[red] counter=8 t=1.3e-03 per=2.4e+01 cost=2.6e+04 flops=2.1e+07
T(sub)=1.4e-05 T(gemm/eig/ortho/gemm/axpy)=2.3e-06,9.4e-06,1.5e-06,9.5e-07,1.6e-07
    5   0 -    -116.456608621459 -1.792e-06  2.000e-04    3     5  4.931e-03 9.862e-04 9.486e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.862e-05,5.922e-05,5.529e-04,1.663e-04,8.399e-04
 analyze_tgpu[Hx]: ndim=38:2.831e-07GB T(cpu-gpu)=2.039e-05 speed=2.777e-02GB/S T(nccl)=3.823e-05 speed=1.481e-02GB/S
----- TIMING FOR sigma : t_inter=5.9e-05 t_gemm=5.5e-04 t_reduction=1.7e-04 tot=7.8e-04 -----
 sigma[inter] counter=9 t=5.9e-05 per=7.6e+00 cost=1.9e+04 flops=3.2e+08
 sigma[gemm] counter=9 i=0 t=1.9e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=1 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=9 i=2 t=1.3e-04 per=1.7e+01 cost=4.3e+03 flops=3.4e+07
 sigma[gemm] counter=9 i=3 t=1.5e-04 per=2.0e+01 cost=4.4e+03 flops=2.9e+07
 sigma[gemm] counter=9 i=4 t=1.3e-04 per=1.6e+01 cost=3.0e+03 flops=2.4e+07
 sigma[gemm] counter=9 i=5 t=1.4e-04 per=1.8e+01 cost=3.0e+03 flops=2.2e+07
 sigma[gemm] counter=9 total t=5.5e-04 per=7.1e+01 cost=1.5e+04 flops=2.7e+07
 sigma[red] counter=9 t=1.7e-04 per=2.1e+01 cost=4.8e+03 flops=2.9e+07
----- TIMING FOR sigma_tot : t_inter=5.7e-04 t_gemm=4.1e-03 t_reduction=1.4e-03 tot=6.1e-03 -----
 sigma_tot[inter] counter=9 t=5.7e-04 per=9.3e+00 cost=1.2e+05 flops=2.1e+08
 sigma_tot[gemm] counter=9 i=0 t=1.9e-05 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=1 t=1.8e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=9 i=2 t=1.0e-03 per=1.6e+01 cost=2.7e+04 flops=2.7e+07
 sigma_tot[gemm] counter=9 i=3 t=1.1e-03 per=1.8e+01 cost=2.8e+04 flops=2.5e+07
 sigma_tot[gemm] counter=9 i=4 t=9.2e-04 per=1.5e+01 cost=1.9e+04 flops=2.0e+07
 sigma_tot[gemm] counter=9 i=5 t=1.0e-03 per=1.7e+01 cost=1.9e+04 flops=1.9e+07
 sigma_tot[gemm] counter=9 total t=4.1e-03 per=6.7e+01 cost=9.3e+04 flops=2.3e+07
 sigma_tot[red] counter=9 t=1.4e-03 per=2.3e+01 cost=3.1e+04 flops=2.2e+07
T(sub)=1.3e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-06,8.2e-06,1.5e-06,9.9e-07,1.7e-07
    6   0 +    -116.456608738602 -1.171e-07  3.463e-05    3     6  5.879e-03 9.799e-04 9.434e-04
TIMING FOR Davidson : 5.895e-03  T(cal/comm/rest)=5.660e-03,1.769e-06,2.333e-04
decomposed t_rest=2.333e-04
 T(sub)    =9.121e-05 per=3.910e+01
 T(precond)=1.716e-05 per=7.355e+00
 T(ortho)  =7.402e-06 per=3.173e+00
 T(xcopy)  =7.970e-07 per=3.417e-01
 T(xnrm2)  =7.690e-07 per=3.297e-01
 T(other)  =1.159e-04 per=4.970e+01
optimized energies: isweep=0 ibond=1 dots=1 e[0]=-116.456608738602 nmvp=6
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=2.322e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=16 alg_decim=0 mpisize=2
 qbond: qsuper nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
decimation summary: keep all 64 states
----- TIMING FOR onedot_decimation: 4.4e-05 S T(wf/decim)=2.0e-05,2.4e-05 -----
ctns::oper_renorm coord=(2,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:6 S:17 H:1 A:7 B:11 
        dim(bra,ket)=64,64 size(op)=400:3.1e-03MB size(tot)=12085:9.2e-02MB:9.0e-05GB
        per(mem): C:14.9 S:42.2 H:3.31 A:10.4 B:29.2 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.713e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=25 : 4.186e-05 S -----
rank=0 GPUmem(GB): used=1.166e-04 (oper)=1.130e-04
rank=0 GPUmem(GB): used=1.196e-04 (oper,site)=1.130e-04,2.980e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=25
 no. of rintermediate operators=5
 no. of coefficients=14:1.068e-04MB:1.043e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 9.810e-05 S -----
rank=0 GPUmem(GB): used=1.197e-04 (oper,site,rinter)=1.130e-04,2.980e-06,1.043e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 2.530e-04 S size(rtasks)=25 size(Rlst2)=256 T(Rmu/Rlist)=1.929e-05,2.337e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.418e-04 S size(rtasks)=25 size(Rlst)=805 -----
rank=0 GPUmem(GB): used=1.197e-04 avail=3.829e+01 total=3.829e+01 batch[need]=1.074e-03 blksize=81 blksize0=16 batchsize=805
rank=0 GPUmem(GB): used=1.193e-03 (oper,site,rinter,batch)=1.130e-04,2.980e-06,1.043e-07,1.074e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.706e-05,4.368e-04,1.562e-04
----- TIMING FOR renorm : t_inter=9.7e-05 t_gemm=4.4e-04 t_reduction=1.6e-04 tot=6.9e-04 -----
 renorm[inter] counter=38 t=9.7e-05 per=1.4e+01 cost=3.6e+03 flops=3.7e+07
 renorm[gemm] counter=38 i=0 t=2.1e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=38 i=1 t=1.9e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=38 i=2 t=1.9e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=38 i=3 t=1.9e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=38 i=4 t=1.3e-04 per=1.9e+01 cost=9.3e+03 flops=7.2e+07
 renorm[gemm] counter=38 i=5 t=1.5e-04 per=2.2e+01 cost=2.9e+04 flops=1.9e+08
 renorm[gemm] counter=38 i=6 t=1.5e-04 per=2.2e+01 cost=1.4e+05 flops=9.7e+08
 renorm[gemm] counter=38 total t=4.4e-04 per=6.3e+01 cost=1.8e+05 flops=4.2e+08
 renorm[red] counter=38 t=1.6e-04 per=2.3e+01 cost=6.5e+04 flops=4.2e+08
----- TIMING FOR renorm_tot : t_inter=1.0e-04 t_gemm=7.0e-04 t_reduction=3.0e-04 tot=1.1e-03 -----
 renorm_tot[inter] counter=38 t=1.0e-04 per=9.4e+00 cost=3.6e+03 flops=3.5e+07
 renorm_tot[gemm] counter=38 i=0 t=5.0e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=38 i=1 t=4.1e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=38 i=2 t=4.0e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=38 i=3 t=4.0e-06 per=3.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=38 i=4 t=2.2e-04 per=2.0e+01 cost=9.5e+03 flops=4.4e+07
 renorm_tot[gemm] counter=38 i=5 t=2.2e-04 per=2.0e+01 cost=3.0e+04 flops=1.4e+08
 renorm_tot[gemm] counter=38 i=6 t=2.5e-04 per=2.3e+01 cost=1.5e+05 flops=5.8e+08
 renorm_tot[gemm] counter=38 total t=7.0e-04 per=6.3e+01 cost=1.9e+05 flops=2.7e+08
 renorm_tot[red] counter=38 t=3.0e-04 per=2.7e+01 cost=6.8e+04 flops=2.3e+08
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.213e-04 (oper)=1.152e-04
rank=0 GPUmem(GB): used=1.242e-04 (oper,site,rinter)=1.152e-04,2.980e-06,2.280e-06
rank=0 GPUmem(GB): used=3.163e-04 (oper,site,rinter,batch)=1.152e-04,2.980e-06,2.280e-06,1.920e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.854e-02 S T(preprocess/alloc/comp/red/dealloc)=3.279e-03,3.377e-03,1.375e-02,1.149e-03,1.983e-04 -----
----- TIMING FOR oper_renorm_opS : 1.859e-02 S rank=0 -----
qops.to_cpu: size(tot)=12085:9.220e-02MB:9.004e-05GB T(to_cpu)=8.755e-05S speed=1.028e+00GB/S
check ||H-H.dagger||=0.000e+00 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.0209 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=2.884e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=9.232e-04 change=-1.173e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=9.232e-04 change=-6.437e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 3.330e-02 S #####
 T(local opt: fetch) = 2.764e-03 S  per =  8.3  per(accum) = 8.3
 T(local opt: hdiag) = 2.393e-04 S  per = 0.719  per(accum) = 9.02
 T(local opt: dvdsn) = 6.760e-03 S  per = 20.3  per(accum) = 29.3
 T(local opt: decim) = 6.599e-05 S  per = 0.198  per(accum) = 29.5
 T(local opt: guess) = 3.147e-05 S  per = 0.0945  per(accum) = 29.6
 T(local opt: renrm) = 2.162e-02 S  per = 64.9  per(accum) = 94.5
 T(local opt: save ) = 1.822e-03 S  per = 5.47  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.760e-03 S  T(sum) = 6.562e-03 S  per = 9.708e+01
 T(local opt: preprocess                  ) = 3.761e-05 S  per = 0.573  per(accum) = 0.573
 T(local opt: symbolic_formulae           ) = 2.033e-04 S  per =  3.1  per(accum) = 3.67
 T(local opt: hintermediate init          ) = 2.853e-05 S  per = 0.435  per(accum) = 4.11
 T(local opt: preprocess_hformulae_Hxlist ) = 2.221e-04 S  per = 3.38  per(accum) = 7.49
 T(local opt: hmmtasks init               ) = 1.734e-04 S  per = 2.64  per(accum) = 10.1
 T(local opt: initial guess for dvdson    ) = 2.234e-06 S  per = 0.034  per(accum) = 10.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 5.291e-03 S  per = 80.6  per(accum) = 90.8
 T(local opt: dvdson [cpu-gpu]            ) = 1.264e-04 S  per = 1.93  per(accum) = 92.7
 T(local opt: dvdson [nccl]               ) = 2.423e-04 S  per = 3.69  per(accum) = 96.4
 T(local opt: dvdson [mpi]                ) = 1.769e-06 S  per = 0.027  per(accum) = 96.4
 T(local opt: dvdson [rest part(linalg)]  ) = 2.333e-04 S  per = 3.55  per(accum) = 100
Detailed decomposition of T(renrm) = 2.162e-02 S  T(sum) = 2.162e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.970e-05 S  per = 0.23  per(accum) = 0.23
 T(local opt: qops init                    ) = 3.382e-04 S  per = 1.56  per(accum) = 1.79
 T(local opt: symbolic_formulae_renorm     ) = 4.598e-05 S  per = 0.213  per(accum) = 2.01
 T(local opt: allocate qops on gpu         ) = 4.661e-05 S  per = 0.216  per(accum) = 2.22
 T(local opt: site memcpy cpu2gpu          ) = 1.894e-05 S  per = 0.0876  per(accum) = 2.31
 T(local opt: rintermediate init           ) = 1.087e-04 S  per = 0.503  per(accum) = 2.81
 T(local opt: preprocess_formulae_Rlist2   ) = 3.569e-04 S  per = 1.65  per(accum) = 4.46
 T(local opt: rmmtasks init                ) = 4.144e-04 S  per = 1.92  per(accum) = 6.38
 T(local opt: qops memset on cpu           ) = 2.900e-08 S  per = 0.000134  per(accum) = 6.38
 T(local opt: preprocess_renorm_batchGPU   ) = 7.927e-04 S  per = 3.67  per(accum) = 10
 T(local opt: deallocate cpu and gpu memory) = 3.007e-05 S  per = 0.139  per(accum) = 10.2
 T(local opt: construct opS [ifdists=true] ) = 1.863e-02 S  per = 86.2  per(accum) = 96.3
 T(local opt: reduction of opS & opH [nccl]) = 2.227e-05 S  per = 0.103  per(accum) = 96.4
 T(local opt: qops memcpy gpu2cpu          ) = 9.930e-05 S  per = 0.459  per(accum) = 96.9
 T(local opt: reduction of opS & opH [mpi] ) = 1.365e-05 S  per = 0.0631  per(accum) = 97
 T(local opt: qops_pool join and erase     ) = 6.546e-04 S  per = 3.03  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.970e-07 S  per = 0.00415  per(accum) = 100
ctns::rcanon_save_site idx=17 scratch=./scratch/sweep size=400:3e-06GB T(load)=0.00053S speed=0.0056GB/S
##### sweep opt: 5.692e-02 S #####
 T(sweep opt: fetch) = 8.548e-03 S  per =   15  per(accum) = 15
 T(sweep opt: hdiag) = 5.661e-04 S  per = 0.995  per(accum) = 16
 T(sweep opt: dvdsn) = 1.016e-02 S  per = 17.9  per(accum) = 33.9
 T(sweep opt: decim) = 1.774e-04 S  per = 0.312  per(accum) = 34.2
 T(sweep opt: guess) = 6.258e-05 S  per = 0.11  per(accum) = 34.3
 T(sweep opt: renrm) = 3.375e-02 S  per = 59.3  per(accum) = 93.6
 T(sweep opt: save ) = 3.651e-03 S  per = 6.41  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.016e-02 S  T(sum) = 9.672e-03 S  per = 9.517e+01
 T(sweep opt: preprocess                  ) = 8.806e-05 S  per = 0.91  per(accum) = 0.91
 T(sweep opt: symbolic_formulae           ) = 3.743e-04 S  per = 3.87  per(accum) = 4.78
 T(sweep opt: hintermediate init          ) = 1.002e-04 S  per = 1.04  per(accum) = 5.82
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.778e-04 S  per = 3.91  per(accum) = 9.72
 T(sweep opt: hmmtasks init               ) = 3.140e-04 S  per = 3.25  per(accum) = 13
 T(sweep opt: initial guess for dvdson    ) = 6.520e-06 S  per = 0.0674  per(accum) = 13
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 7.366e-03 S  per = 76.2  per(accum) = 89.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.935e-04 S  per =    2  per(accum) = 91.2
 T(sweep opt: dvdson [nccl]               ) = 3.798e-04 S  per = 3.93  per(accum) = 95.1
 T(sweep opt: dvdson [mpi]                ) = 5.857e-06 S  per = 0.0606  per(accum) = 95.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 4.664e-04 S  per = 4.82  per(accum) = 100
Detailed decomposition of T(renrm) = 3.375e-02 S  T(sum) = 3.375e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.148e-05 S  per = 0.271  per(accum) = 0.271
 T(sweep opt: qops init                    ) = 6.436e-04 S  per = 1.91  per(accum) = 2.18
 T(sweep opt: symbolic_formulae_renorm     ) = 8.370e-05 S  per = 0.248  per(accum) = 2.43
 T(sweep opt: allocate qops on gpu         ) = 1.053e-04 S  per = 0.312  per(accum) = 2.74
 T(sweep opt: site memcpy cpu2gpu          ) = 4.801e-05 S  per = 0.142  per(accum) = 2.88
 T(sweep opt: rintermediate init           ) = 1.401e-04 S  per = 0.415  per(accum) = 3.3
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.619e-04 S  per = 1.37  per(accum) = 4.66
 T(sweep opt: rmmtasks init                ) = 5.615e-04 S  per = 1.66  per(accum) = 6.33
 T(sweep opt: qops memset on cpu           ) = 6.300e-08 S  per = 0.000187  per(accum) = 6.33
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.423e-03 S  per = 4.22  per(accum) = 10.5
 T(sweep opt: deallocate cpu and gpu memory) = 5.453e-05 S  per = 0.162  per(accum) = 10.7
 T(sweep opt: construct opS [ifdists=true] ) = 2.861e-02 S  per = 84.8  per(accum) = 95.5
 T(sweep opt: reduction of opS & opH [nccl]) = 4.103e-05 S  per = 0.122  per(accum) = 95.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.316e-04 S  per = 0.39  per(accum) = 96
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.673e-05 S  per = 0.168  per(accum) = 96.2
 T(sweep opt: qops_pool join and erase     ) = 1.296e-03 S  per = 3.84  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.779e-06 S  per = 0.00527  per(accum) = 100
##### global opt: 5.692e-02 S #####
 T(global opt: fetch) = 8.548e-03 S  per =   15  per(accum) = 15
 T(global opt: hdiag) = 5.661e-04 S  per = 0.995  per(accum) = 16
 T(global opt: dvdsn) = 1.016e-02 S  per = 17.9  per(accum) = 33.9
 T(global opt: decim) = 1.774e-04 S  per = 0.312  per(accum) = 34.2
 T(global opt: guess) = 6.258e-05 S  per = 0.11  per(accum) = 34.3
 T(global opt: renrm) = 3.375e-02 S  per = 59.3  per(accum) = 93.6
 T(global opt: save ) = 3.651e-03 S  per = 6.41  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.016e-02 S  T(sum) = 9.672e-03 S  per = 9.517e+01
 T(global opt: preprocess                  ) = 8.806e-05 S  per = 0.91  per(accum) = 0.91
 T(global opt: symbolic_formulae           ) = 3.743e-04 S  per = 3.87  per(accum) = 4.78
 T(global opt: hintermediate init          ) = 1.002e-04 S  per = 1.04  per(accum) = 5.82
 T(global opt: preprocess_hformulae_Hxlist ) = 3.778e-04 S  per = 3.91  per(accum) = 9.72
 T(global opt: hmmtasks init               ) = 3.140e-04 S  per = 3.25  per(accum) = 13
 T(global opt: initial guess for dvdson    ) = 6.520e-06 S  per = 0.0674  per(accum) = 13
 T(global opt: dvdson [Hx_batchGPU]        ) = 7.366e-03 S  per = 76.2  per(accum) = 89.2
 T(global opt: dvdson [cpu-gpu]            ) = 1.935e-04 S  per =    2  per(accum) = 91.2
 T(global opt: dvdson [nccl]               ) = 3.798e-04 S  per = 3.93  per(accum) = 95.1
 T(global opt: dvdson [mpi]                ) = 5.857e-06 S  per = 0.0606  per(accum) = 95.2
 T(global opt: dvdson [rest part(linalg)]  ) = 4.664e-04 S  per = 4.82  per(accum) = 100
Detailed decomposition of T(renrm) = 3.375e-02 S  T(sum) = 3.375e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.148e-05 S  per = 0.271  per(accum) = 0.271
 T(global opt: qops init                    ) = 6.436e-04 S  per = 1.91  per(accum) = 2.18
 T(global opt: symbolic_formulae_renorm     ) = 8.370e-05 S  per = 0.248  per(accum) = 2.43
 T(global opt: allocate qops on gpu         ) = 1.053e-04 S  per = 0.312  per(accum) = 2.74
 T(global opt: site memcpy cpu2gpu          ) = 4.801e-05 S  per = 0.142  per(accum) = 2.88
 T(global opt: rintermediate init           ) = 1.401e-04 S  per = 0.415  per(accum) = 3.3
 T(global opt: preprocess_formulae_Rlist2   ) = 4.619e-04 S  per = 1.37  per(accum) = 4.66
 T(global opt: rmmtasks init                ) = 5.615e-04 S  per = 1.66  per(accum) = 6.33
 T(global opt: qops memset on cpu           ) = 6.300e-08 S  per = 0.000187  per(accum) = 6.33
 T(global opt: preprocess_renorm_batchGPU   ) = 1.423e-03 S  per = 4.22  per(accum) = 10.5
 T(global opt: deallocate cpu and gpu memory) = 5.453e-05 S  per = 0.162  per(accum) = 10.7
 T(global opt: construct opS [ifdists=true] ) = 2.861e-02 S  per = 84.8  per(accum) = 95.5
 T(global opt: reduction of opS & opH [nccl]) = 4.103e-05 S  per = 0.122  per(accum) = 95.6
 T(global opt: qops memcpy gpu2cpu          ) = 1.316e-04 S  per = 0.39  per(accum) = 96
 T(global opt: reduction of opS & opH [mpi] ) = 5.673e-05 S  per = 0.168  per(accum) = 96.2
 T(global opt: qops_pool join and erase     ) = 1.296e-03 S  per = 3.84  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.779e-06 S  per = 0.00527  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-2.428e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=2/seqsize=34 dots=1 dbond=(3,0)-(4,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=15 scratch=./scratch/sweep size=213:1.59e-06GB T(load)=3.07e-04S speed=5.17e-03GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=293:2.24e-03MB:2.18e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=112:8.54e-04MB:8.34e-07GB
total mem of comb=553:4.22e-03MB:4.12e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=3.844e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=3,16,1
 suppl= 0 1 2
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 3
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:6 S:17 H:1 A:7 B:11 
        dim(bra,ket)=64,64 size(op)=400:3.052e-03MB size(tot)=12085:9.220e-02MB:9.004e-05GB
        per(mem): C:14.9 S:42.2 H:3.31 A:10.4 B:29.2 
 rqops: oplist=CSHPQ nops=C:32 S:4 H:1 P:14 Q:18 
        dim(bra,ket)=17,17 size(op)=63:0.000481MB size(tot)=1993:0.0152MB:1.48e-05GB
        per(mem): C:46.6 S:9.63 H:3.16 P:5.82 Q:34.8 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=16414:0.125MB:0.000122GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.552e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(3,0) fdel=./scratch/sweep/rop(4,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-1.490e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(64,17,4) nnz=112:8.545e-04MB
qtensor3: wf3 own=1 _data=0x55b2c62e7c00
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
 qbond: qcol nsym=6 dimAll=17
 (24,-2):5 (23,-1):4 (25,-3):4 (25,-1):2 (26,-4):1 (22,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=12 nblocks=384 size=112:8.545e-04MB
### DIAG TIMING: total=2.946e-04 t1=1.527e-05, t2=1.253e-05, t3=1.458e-05, t4=1.971e-04, t5=1.018e-05, t6=3.791e-05, t7=6.987e-06
duration_diagGPU:3.014e-04
duration_diagreduce:2.700e-08
duration_diagtransform:2.820e-07
----- TIMING FOR symbolic_formulae_onedot with size=150 : 3.043e-04 S -----
rank=0 GPUmem(GB): used=1.223e-04 (oper)=1.223e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=150
 no. of hintermediate operators=57
 no. of coefficients=912:6.958e-03MB:6.795e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.476e-05 S -----
rank=0 GPUmem(GB): used=1.291e-04 (oper,hinter)=1.223e-04,6.795e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.014e-04 S size(H_formulae)=150 size(Hxlst2)=12 T(Hmu/Hxlist)=5.996e-05,2.414e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.862e-04 S size(H_formulae)=150 size(Hxlst)=1126 -----
rank=0 GPUmem(GB): used=1.291e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.669e-06 batch[need]=9.312e-04 blksize=45 blksize0=20 batchsize=1126
rank=0 GPUmem(GB): used=1.062e-03 (oper,hinter,dvdson,batch)=1.223e-04,6.795e-06,1.669e-06,9.312e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=112 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.972e-05,7.497e-05,5.451e-04,1.776e-04,8.730e-04
 analyze_tgpu[Hx]: ndim=112:8.345e-07GB T(cpu-gpu)=2.162e-05 speed=7.720e-02GB/S T(nccl)=4.810e-05 speed=3.469e-02GB/S
----- TIMING FOR sigma : t_inter=7.5e-05 t_gemm=5.4e-04 t_reduction=1.8e-04 tot=8.0e-04 -----
 sigma[inter] counter=10 t=7.5e-05 per=9.4e+00 cost=9.2e+04 flops=1.2e+09
 sigma[gemm] counter=10 i=0 t=1.9e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=1 t=1.6e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=10 i=2 t=1.4e-04 per=1.8e+01 cost=3.0e+04 flops=2.1e+08
 sigma[gemm] counter=10 i=3 t=1.5e-04 per=1.9e+01 cost=3.1e+04 flops=2.0e+08
 sigma[gemm] counter=10 i=4 t=1.3e-04 per=1.6e+01 cost=3.1e+04 flops=2.5e+08
 sigma[gemm] counter=10 i=5 t=1.2e-04 per=1.5e+01 cost=3.4e+04 flops=2.9e+08
 sigma[gemm] counter=10 total t=5.4e-04 per=6.8e+01 cost=1.3e+05 flops=2.3e+08
 sigma[red] counter=10 t=1.8e-04 per=2.2e+01 cost=2.2e+04 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=6.4e-04 t_gemm=4.6e-03 t_reduction=1.6e-03 tot=6.9e-03 -----
 sigma_tot[inter] counter=10 t=6.4e-04 per=9.3e+00 cost=2.1e+05 flops=3.3e+08
 sigma_tot[gemm] counter=10 i=0 t=2.1e-05 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=1 t=1.9e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=10 i=2 t=1.1e-03 per=1.7e+01 cost=5.7e+04 flops=5.0e+07
 sigma_tot[gemm] counter=10 i=3 t=1.3e-03 per=1.8e+01 cost=5.9e+04 flops=4.6e+07
 sigma_tot[gemm] counter=10 i=4 t=1.0e-03 per=1.5e+01 cost=5.0e+04 flops=4.8e+07
 sigma_tot[gemm] counter=10 i=5 t=1.1e-03 per=1.6e+01 cost=5.2e+04 flops=4.7e+07
 sigma_tot[gemm] counter=10 total t=4.6e-03 per=6.7e+01 cost=2.2e+05 flops=4.7e+07
 sigma_tot[red] counter=10 t=1.6e-03 per=2.3e+01 cost=5.3e+04 flops=3.3e+07
T(sub)=7.7e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,2.7e-06,9.7e-07,8.8e-07,2.0e-07
settings: ndim=112 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.456608738602 -1.116e+03  7.348e-02    1     1  9.601e-04 9.601e-04 9.431e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.252e-05,6.407e-05,6.740e-04,2.015e-04,1.006e-03
 analyze_tgpu[Hx]: ndim=112:8.345e-07GB T(cpu-gpu)=2.155e-05 speed=7.746e-02GB/S T(nccl)=4.097e-05 speed=4.073e-02GB/S
----- TIMING FOR sigma : t_inter=6.4e-05 t_gemm=6.7e-04 t_reduction=2.0e-04 tot=9.4e-04 -----
 sigma[inter] counter=11 t=6.4e-05 per=6.8e+00 cost=9.2e+04 flops=1.4e+09
 sigma[gemm] counter=11 i=0 t=2.0e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=1 t=1.9e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=11 i=2 t=1.8e-04 per=1.9e+01 cost=3.0e+04 flops=1.7e+08
 sigma[gemm] counter=11 i=3 t=1.9e-04 per=2.0e+01 cost=3.1e+04 flops=1.6e+08
 sigma[gemm] counter=11 i=4 t=1.5e-04 per=1.6e+01 cost=3.1e+04 flops=2.1e+08
 sigma[gemm] counter=11 i=5 t=1.5e-04 per=1.6e+01 cost=3.4e+04 flops=2.2e+08
 sigma[gemm] counter=11 total t=6.7e-04 per=7.2e+01 cost=1.3e+05 flops=1.9e+08
 sigma[red] counter=11 t=2.0e-04 per=2.1e+01 cost=2.2e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=7.0e-04 t_gemm=5.3e-03 t_reduction=1.8e-03 tot=7.8e-03 -----
 sigma_tot[inter] counter=11 t=7.0e-04 per=9.0e+00 cost=3.0e+05 flops=4.3e+08
 sigma_tot[gemm] counter=11 i=0 t=2.3e-05 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=1 t=2.1e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=11 i=2 t=1.3e-03 per=1.7e+01 cost=8.7e+04 flops=6.6e+07
 sigma_tot[gemm] counter=11 i=3 t=1.5e-03 per=1.9e+01 cost=8.9e+04 flops=6.1e+07
 sigma_tot[gemm] counter=11 i=4 t=1.2e-03 per=1.5e+01 cost=8.2e+04 flops=6.8e+07
 sigma_tot[gemm] counter=11 i=5 t=1.3e-03 per=1.6e+01 cost=8.6e+04 flops=6.7e+07
 sigma_tot[gemm] counter=11 total t=5.3e-03 per=6.8e+01 cost=3.4e+05 flops=6.5e+07
 sigma_tot[red] counter=11 t=1.8e-03 per=2.3e+01 cost=7.5e+04 flops=4.2e+07
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.0e-05,2.4e-06,1.2e-06,2.2e-07
    2   0 -    -116.465996468063 -9.388e-03  1.417e-02    2     2  2.101e-03 1.051e-03 1.015e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.305e-05,6.306e-05,6.501e-04,1.902e-04,9.700e-04
 analyze_tgpu[Hx]: ndim=112:8.345e-07GB T(cpu-gpu)=2.187e-05 speed=7.631e-02GB/S T(nccl)=4.118e-05 speed=4.053e-02GB/S
----- TIMING FOR sigma : t_inter=6.3e-05 t_gemm=6.5e-04 t_reduction=1.9e-04 tot=9.0e-04 -----
 sigma[inter] counter=12 t=6.3e-05 per=7.0e+00 cost=9.2e+04 flops=1.5e+09
 sigma[gemm] counter=12 i=0 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=1 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=12 i=2 t=1.7e-04 per=1.8e+01 cost=3.0e+04 flops=1.8e+08
 sigma[gemm] counter=12 i=3 t=2.0e-04 per=2.2e+01 cost=3.1e+04 flops=1.6e+08
 sigma[gemm] counter=12 i=4 t=1.4e-04 per=1.5e+01 cost=3.1e+04 flops=2.2e+08
 sigma[gemm] counter=12 i=5 t=1.4e-04 per=1.6e+01 cost=3.4e+04 flops=2.4e+08
 sigma[gemm] counter=12 total t=6.5e-04 per=7.2e+01 cost=1.3e+05 flops=1.9e+08
 sigma[red] counter=12 t=1.9e-04 per=2.1e+01 cost=2.2e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=7.7e-04 t_gemm=5.9e-03 t_reduction=2.0e-03 tot=8.7e-03 -----
 sigma_tot[inter] counter=12 t=7.7e-04 per=8.8e+00 cost=4.0e+05 flops=5.2e+08
 sigma_tot[gemm] counter=12 i=0 t=2.5e-05 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=1 t=2.3e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=12 i=2 t=1.5e-03 per=1.7e+01 cost=1.2e+05 flops=7.9e+07
 sigma_tot[gemm] counter=12 i=3 t=1.7e-03 per=1.9e+01 cost=1.2e+05 flops=7.3e+07
 sigma_tot[gemm] counter=12 i=4 t=1.3e-03 per=1.5e+01 cost=1.1e+05 flops=8.4e+07
 sigma_tot[gemm] counter=12 i=5 t=1.4e-03 per=1.6e+01 cost=1.2e+05 flops=8.4e+07
 sigma_tot[gemm] counter=12 total t=5.9e-03 per=6.8e+01 cost=4.7e+05 flops=7.9e+07
 sigma_tot[red] counter=12 t=2.0e-03 per=2.3e+01 cost=9.6e+04 flops=4.8e+07
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.3e-05,2.0e-06,1.5e-06,2.4e-07
    3   0 -    -116.466337546790 -3.411e-04  3.701e-03    3     3  3.381e-03 1.127e-03 1.090e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.322e-05,6.393e-05,6.443e-04,1.914e-04,9.665e-04
 analyze_tgpu[Hx]: ndim=112:8.345e-07GB T(cpu-gpu)=2.133e-05 speed=7.824e-02GB/S T(nccl)=4.188e-05 speed=3.985e-02GB/S
----- TIMING FOR sigma : t_inter=6.4e-05 t_gemm=6.4e-04 t_reduction=1.9e-04 tot=9.0e-04 -----
 sigma[inter] counter=13 t=6.4e-05 per=7.1e+00 cost=9.2e+04 flops=1.4e+09
 sigma[gemm] counter=13 i=0 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=1 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=13 i=2 t=1.7e-04 per=1.9e+01 cost=3.0e+04 flops=1.7e+08
 sigma[gemm] counter=13 i=3 t=1.9e-04 per=2.1e+01 cost=3.1e+04 flops=1.6e+08
 sigma[gemm] counter=13 i=4 t=1.4e-04 per=1.5e+01 cost=3.1e+04 flops=2.3e+08
 sigma[gemm] counter=13 i=5 t=1.4e-04 per=1.6e+01 cost=3.4e+04 flops=2.4e+08
 sigma[gemm] counter=13 total t=6.4e-04 per=7.2e+01 cost=1.3e+05 flops=2.0e+08
 sigma[red] counter=13 t=1.9e-04 per=2.1e+01 cost=2.2e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=8.3e-04 t_gemm=6.6e-03 t_reduction=2.2e-03 tot=9.6e-03 -----
 sigma_tot[inter] counter=13 t=8.3e-04 per=8.7e+00 cost=4.9e+05 flops=5.9e+08
 sigma_tot[gemm] counter=13 i=0 t=2.7e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=1 t=2.5e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=13 i=2 t=1.7e-03 per=1.7e+01 cost=1.5e+05 flops=8.9e+07
 sigma_tot[gemm] counter=13 i=3 t=1.8e-03 per=1.9e+01 cost=1.5e+05 flops=8.2e+07
 sigma_tot[gemm] counter=13 i=4 t=1.5e-03 per=1.5e+01 cost=1.4e+05 flops=9.8e+07
 sigma_tot[gemm] counter=13 i=5 t=1.6e-03 per=1.6e+01 cost=1.5e+05 flops=9.8e+07
 sigma_tot[gemm] counter=13 total t=6.6e-03 per=6.9e+01 cost=6.0e+05 flops=9.0e+07
 sigma_tot[red] counter=13 t=2.2e-03 per=2.3e+01 cost=1.2e+05 flops=5.4e+07
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,1.0e-05,1.8e-06,1.2e-06,1.8e-07
    4   0 -    -116.466362065220 -2.452e-05  1.052e-03    3     4  4.472e-03 1.118e-03 1.082e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.200e-05,6.331e-05,6.351e-04,1.871e-04,9.509e-04
 analyze_tgpu[Hx]: ndim=112:8.345e-07GB T(cpu-gpu)=2.097e-05 speed=7.961e-02GB/S T(nccl)=4.103e-05 speed=4.067e-02GB/S
----- TIMING FOR sigma : t_inter=6.3e-05 t_gemm=6.3e-04 t_reduction=1.9e-04 tot=8.9e-04 -----
 sigma[inter] counter=14 t=6.3e-05 per=7.1e+00 cost=9.2e+04 flops=1.5e+09
 sigma[gemm] counter=14 i=0 t=2.0e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=1 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=14 i=2 t=1.7e-04 per=1.9e+01 cost=3.0e+04 flops=1.8e+08
 sigma[gemm] counter=14 i=3 t=1.9e-04 per=2.1e+01 cost=3.1e+04 flops=1.6e+08
 sigma[gemm] counter=14 i=4 t=1.4e-04 per=1.5e+01 cost=3.1e+04 flops=2.3e+08
 sigma[gemm] counter=14 i=5 t=1.4e-04 per=1.6e+01 cost=3.4e+04 flops=2.4e+08
 sigma[gemm] counter=14 total t=6.3e-04 per=7.2e+01 cost=1.3e+05 flops=2.0e+08
 sigma[red] counter=14 t=1.9e-04 per=2.1e+01 cost=2.2e+04 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=8.9e-04 t_gemm=7.2e-03 t_reduction=2.4e-03 tot=1.0e-02 -----
 sigma_tot[inter] counter=14 t=8.9e-04 per=8.5e+00 cost=5.8e+05 flops=6.5e+08
 sigma_tot[gemm] counter=14 i=0 t=2.9e-05 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=1 t=2.7e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=14 i=2 t=1.8e-03 per=1.7e+01 cost=1.8e+05 flops=9.7e+07
 sigma_tot[gemm] counter=14 i=3 t=2.0e-03 per=1.9e+01 cost=1.8e+05 flops=8.9e+07
 sigma_tot[gemm] counter=14 i=4 t=1.6e-03 per=1.5e+01 cost=1.8e+05 flops=1.1e+08
 sigma_tot[gemm] counter=14 i=5 t=1.7e-03 per=1.6e+01 cost=1.9e+05 flops=1.1e+08
 sigma_tot[gemm] counter=14 total t=7.2e-03 per=6.9e+01 cost=7.2e+05 flops=1.0e+08
 sigma_tot[red] counter=14 t=2.4e-03 per=2.3e+01 cost=1.4e+05 flops=5.9e+07
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=3.1e-06,9.1e-06,1.7e-06,1.2e-06,1.8e-07
    5   0 -    -116.466364589023 -2.524e-06  2.799e-04    3     5  5.544e-03 1.109e-03 1.072e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.045e-05,6.104e-05,6.314e-04,1.893e-04,9.456e-04
 analyze_tgpu[Hx]: ndim=112:8.345e-07GB T(cpu-gpu)=2.092e-05 speed=7.978e-02GB/S T(nccl)=3.953e-05 speed=4.222e-02GB/S
----- TIMING FOR sigma : t_inter=6.1e-05 t_gemm=6.3e-04 t_reduction=1.9e-04 tot=8.8e-04 -----
 sigma[inter] counter=15 t=6.1e-05 per=6.9e+00 cost=9.2e+04 flops=1.5e+09
 sigma[gemm] counter=15 i=0 t=2.0e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=1 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=15 i=2 t=1.6e-04 per=1.9e+01 cost=3.0e+04 flops=1.8e+08
 sigma[gemm] counter=15 i=3 t=1.9e-04 per=2.2e+01 cost=3.1e+04 flops=1.6e+08
 sigma[gemm] counter=15 i=4 t=1.3e-04 per=1.5e+01 cost=3.1e+04 flops=2.3e+08
 sigma[gemm] counter=15 i=5 t=1.4e-04 per=1.6e+01 cost=3.4e+04 flops=2.4e+08
 sigma[gemm] counter=15 total t=6.3e-04 per=7.2e+01 cost=1.3e+05 flops=2.0e+08
 sigma[red] counter=15 t=1.9e-04 per=2.1e+01 cost=2.2e+04 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=9.6e-04 t_gemm=7.9e-03 t_reduction=2.6e-03 tot=1.1e-02 -----
 sigma_tot[inter] counter=15 t=9.6e-04 per=8.4e+00 cost=6.7e+05 flops=7.0e+08
 sigma_tot[gemm] counter=15 i=0 t=3.1e-05 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=1 t=2.9e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=15 i=2 t=2.0e-03 per=1.7e+01 cost=2.1e+05 flops=1.0e+08
 sigma_tot[gemm] counter=15 i=3 t=2.2e-03 per=2.0e+01 cost=2.1e+05 flops=9.6e+07
 sigma_tot[gemm] counter=15 i=4 t=1.7e-03 per=1.5e+01 cost=2.1e+05 flops=1.2e+08
 sigma_tot[gemm] counter=15 i=5 t=1.8e-03 per=1.6e+01 cost=2.2e+05 flops=1.2e+08
 sigma_tot[gemm] counter=15 total t=7.9e-03 per=6.9e+01 cost=8.5e+05 flops=1.1e+08
 sigma_tot[red] counter=15 t=2.6e-03 per=2.2e+01 cost=1.6e+05 flops=6.3e+07
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,9.8e-06,1.7e-06,1.2e-06,1.6e-07
    6   0 +    -116.466364795540 -2.065e-07  8.366e-05    3     6  6.749e-03 1.125e-03 1.081e-03
TIMING FOR Davidson : 6.760e-03  T(cal/comm/rest)=6.485e-03,1.388e-06,2.730e-04
decomposed t_rest=2.730e-04
 T(sub)    =9.533e-05 per=3.492e+01
 T(precond)=1.632e-05 per=5.976e+00
 T(ortho)  =8.336e-06 per=3.053e+00
 T(xcopy)  =6.550e-07 per=2.399e-01
 T(xnrm2)  =1.030e-06 per=3.773e-01
 T(other)  =1.513e-04 per=5.544e+01
optimized energies: isweep=0 ibond=2 dots=1 e[0]=-116.466364795540 nmvp=6
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=4.066e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=25 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=25 dimAll=256
 (0,0):1 (2,0):16 (1,1):4 (1,-1):4 (4,0):36 (3,1):24 (3,-1):24 (2,2):6 (2,-2):6 (6,0):16 (5,1):24 (5,-1):24 (4,2):16 (4,-2):16 (3,3):4 (3,-3):4 (8,0):1 (7,1):4 (7,-1):4 (6,2):6 (6,-2):6 (5,3):4 (5,-3):4 (4,4):1 (4,-4):1
timing for divide=3.3e-06
timing for compute=4.2e-05
timing for collect=4.6e-06
----- TMING FOR decimation_genbasis(nkr): 5.0e-05 S T(divide/compute[cpu/gpu/rest]/collect)=3.3e-06,4.0e-05,0.0e+00,2.1e-06,4.6e-06 -----
decimation summary: 256->17 dwt=+1.110e-16 SvN=8.387e-01
 qbond: qkept nsym=6 dimAll=17
 (6,2):5 (7,1):4 (5,3):4 (5,1):2 (8,0):1 (4,4):1
----- TIMING for decimation_row(nkr): 8.903e-04 S T(decim/select/formRot)=8.285e-05,7.961e-04,1.138e-05 -----
----- TIMING FOR onedot_decimation: 9.237e-04 S T(wf/decim)=2.634e-05,8.973e-04 -----
ctns::oper_renorm coord=(3,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:8 S:16 H:1 A:14 B:18 
        dim(bra,ket)=17,17 size(op)=63:4.807e-04MB size(tot)=1873:1.429e-02MB:1.395e-05GB
        per(mem): C:12.4 S:41 H:3.36 A:6.19 B:37.1 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=5.624e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=41 : 5.248e-05 S -----
rank=0 GPUmem(GB): used=1.282e-04 (oper)=1.214e-04
rank=0 GPUmem(GB): used=1.290e-04 (oper,site)=1.214e-04,8.345e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=41
 no. of rintermediate operators=6
 no. of coefficients=32:2.441e-04MB:2.384e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.843e-05 S -----
rank=0 GPUmem(GB): used=1.293e-04 (oper,site,rinter)=1.214e-04,8.345e-07,2.384e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.098e-04 S size(rtasks)=41 size(Rlst2)=36 T(Rmu/Rlist)=2.565e-05,8.409e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.489e-04 S size(rtasks)=41 size(Rlst)=319 -----
rank=0 GPUmem(GB): used=1.293e-04 avail=3.829e+01 total=3.829e+01 batch[need]=3.660e-04 blksize=36 blksize0=81 batchsize=319
rank=0 GPUmem(GB): used=4.953e-04 (oper,site,rinter,batch)=1.214e-04,8.345e-07,2.384e-07,3.660e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.658e-05,3.942e-04,1.636e-04
----- TIMING FOR renorm : t_inter=8.7e-05 t_gemm=3.9e-04 t_reduction=1.6e-04 tot=6.4e-04 -----
 renorm[inter] counter=73 t=8.7e-05 per=1.3e+01 cost=1.6e+04 flops=1.8e+08
 renorm[gemm] counter=73 i=0 t=2.0e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=73 i=1 t=1.9e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=73 i=2 t=1.8e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=73 i=3 t=1.9e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=73 i=4 t=1.0e-04 per=1.6e+01 cost=6.4e+03 flops=6.3e+07
 renorm[gemm] counter=73 i=5 t=1.3e-04 per=2.1e+01 cost=1.8e+04 flops=1.3e+08
 renorm[gemm] counter=73 i=6 t=1.5e-04 per=2.3e+01 cost=2.1e+04 flops=1.4e+08
 renorm[gemm] counter=73 total t=3.9e-04 per=6.1e+01 cost=4.5e+04 flops=1.1e+08
 renorm[red] counter=73 t=1.6e-04 per=2.5e+01 cost=7.3e+03 flops=4.4e+07
----- TIMING FOR renorm_tot : t_inter=1.9e-04 t_gemm=1.1e-03 t_reduction=4.6e-04 tot=1.7e-03 -----
 renorm_tot[inter] counter=73 t=1.9e-04 per=1.1e+01 cost=1.9e+04 flops=1.0e+08
 renorm_tot[gemm] counter=73 i=0 t=7.0e-06 per=4.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=73 i=1 t=5.9e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=73 i=2 t=5.9e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=73 i=3 t=5.9e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=73 i=4 t=3.2e-04 per=1.8e+01 cost=1.6e+04 flops=5.0e+07
 renorm_tot[gemm] counter=73 i=5 t=3.5e-04 per=2.0e+01 cost=4.7e+04 flops=1.4e+08
 renorm_tot[gemm] counter=73 i=6 t=4.0e-04 per=2.3e+01 cost=1.7e+05 flops=4.2e+08
 renorm_tot[gemm] counter=73 total t=1.1e-03 per=6.3e+01 cost=2.3e+05 flops=2.1e+08
 renorm_tot[red] counter=73 t=4.6e-04 per=2.6e+01 cost=7.5e+04 flops=1.6e+08
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.352e-04 (oper)=1.218e-04
rank=0 GPUmem(GB): used=1.361e-04 (oper,site,rinter)=1.218e-04,8.345e-07,6.437e-06
rank=0 GPUmem(GB): used=1.469e-04 (oper,site,rinter,batch)=1.218e-04,8.345e-07,6.437e-06,1.080e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.147e-02 S T(preprocess/alloc/comp/red/dealloc)=1.718e-03,1.807e-03,8.798e-03,6.170e-04,1.910e-04 -----
----- TIMING FOR oper_renorm_opS : 1.152e-02 S rank=0 -----
qops.to_cpu: size(tot)=1873:1.429e-02MB:1.395e-05GB T(to_cpu)=2.993e-05S speed=4.663e-01GB/S
check ||H-H.dagger||=8.221e-15 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.0131 S rank=0 -----
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.146e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=4.272e-04 change=-1.285e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=4.272e-04 change=-3.129e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 2.753e-02 S #####
 T(local opt: fetch) = 2.636e-03 S  per = 9.58  per(accum) = 9.58
 T(local opt: hdiag) = 3.296e-04 S  per =  1.2  per(accum) = 10.8
 T(local opt: dvdsn) = 8.065e-03 S  per = 29.3  per(accum) = 40.1
 T(local opt: decim) = 9.493e-04 S  per = 3.45  per(accum) = 43.5
 T(local opt: guess) = 3.787e-05 S  per = 0.138  per(accum) = 43.7
 T(local opt: renrm) = 1.373e-02 S  per = 49.9  per(accum) = 93.5
 T(local opt: save ) = 1.781e-03 S  per = 6.47  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.065e-03 S  T(sum) = 7.859e-03 S  per = 9.745e+01
 T(local opt: preprocess                  ) = 7.519e-05 S  per = 0.957  per(accum) = 0.957
 T(local opt: symbolic_formulae           ) = 3.089e-04 S  per = 3.93  per(accum) = 4.89
 T(local opt: hintermediate init          ) = 3.177e-05 S  per = 0.404  per(accum) = 5.29
 T(local opt: preprocess_hformulae_Hxlist ) = 3.910e-04 S  per = 4.98  per(accum) = 10.3
 T(local opt: hmmtasks init               ) = 2.903e-04 S  per = 3.69  per(accum) = 14
 T(local opt: initial guess for dvdson    ) = 2.409e-06 S  per = 0.0307  per(accum) = 14
 T(local opt: dvdson [Hx_batchGPU]        ) = 6.104e-03 S  per = 77.7  per(accum) = 91.7
 T(local opt: dvdson [cpu-gpu]            ) = 1.282e-04 S  per = 1.63  per(accum) = 93.3
 T(local opt: dvdson [nccl]               ) = 2.527e-04 S  per = 3.22  per(accum) = 96.5
 T(local opt: dvdson [mpi]                ) = 1.388e-06 S  per = 0.0177  per(accum) = 96.5
 T(local opt: dvdson [rest part(linalg)]  ) = 2.730e-04 S  per = 3.47  per(accum) = 100
Detailed decomposition of T(renrm) = 1.373e-02 S  T(sum) = 1.373e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.284e-05 S  per = 0.312  per(accum) = 0.312
 T(local opt: qops init                    ) = 2.421e-04 S  per = 1.76  per(accum) = 2.08
 T(local opt: symbolic_formulae_renorm     ) = 5.648e-05 S  per = 0.411  per(accum) = 2.49
 T(local opt: allocate qops on gpu         ) = 4.892e-05 S  per = 0.356  per(accum) = 2.84
 T(local opt: site memcpy cpu2gpu          ) = 1.996e-05 S  per = 0.145  per(accum) = 2.99
 T(local opt: rintermediate init           ) = 2.476e-05 S  per = 0.18  per(accum) = 3.17
 T(local opt: preprocess_formulae_Rlist2   ) = 1.532e-04 S  per = 1.12  per(accum) = 4.29
 T(local opt: rmmtasks init                ) = 1.846e-04 S  per = 1.34  per(accum) = 5.63
 T(local opt: qops memset on cpu           ) = 3.100e-08 S  per = 0.000226  per(accum) = 5.63
 T(local opt: preprocess_renorm_batchGPU   ) = 7.288e-04 S  per = 5.31  per(accum) = 10.9
 T(local opt: deallocate cpu and gpu memory) = 2.524e-05 S  per = 0.184  per(accum) = 11.1
 T(local opt: construct opS [ifdists=true] ) = 1.155e-02 S  per = 84.2  per(accum) = 95.3
 T(local opt: reduction of opS & opH [nccl]) = 2.029e-05 S  per = 0.148  per(accum) = 95.4
 T(local opt: qops memcpy gpu2cpu          ) = 4.053e-05 S  per = 0.295  per(accum) = 95.7
 T(local opt: reduction of opS & opH [mpi] ) = 4.511e-05 S  per = 0.329  per(accum) = 96.1
 T(local opt: qops_pool join and erase     ) = 5.402e-04 S  per = 3.94  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.900e-07 S  per = 0.00576  per(accum) = 100
ctns::rcanon_save_site idx=16 scratch=./scratch/sweep size=112:8.3e-07GB T(load)=0.00054S speed=0.0015GB/S
##### sweep opt: 8.444e-02 S #####
 T(sweep opt: fetch) = 1.118e-02 S  per = 13.2  per(accum) = 13.2
 T(sweep opt: hdiag) = 8.957e-04 S  per = 1.06  per(accum) = 14.3
 T(sweep opt: dvdsn) = 1.823e-02 S  per = 21.6  per(accum) = 35.9
 T(sweep opt: decim) = 1.127e-03 S  per = 1.33  per(accum) = 37.2
 T(sweep opt: guess) = 1.005e-04 S  per = 0.119  per(accum) = 37.3
 T(sweep opt: renrm) = 4.748e-02 S  per = 56.2  per(accum) = 93.6
 T(sweep opt: save ) = 5.432e-03 S  per = 6.43  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.823e-02 S  T(sum) = 1.753e-02 S  per = 9.618e+01
 T(sweep opt: preprocess                  ) = 1.632e-04 S  per = 0.931  per(accum) = 0.931
 T(sweep opt: symbolic_formulae           ) = 6.831e-04 S  per =  3.9  per(accum) = 4.83
 T(sweep opt: hintermediate init          ) = 1.320e-04 S  per = 0.753  per(accum) = 5.58
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.688e-04 S  per = 4.39  per(accum) = 9.97
 T(sweep opt: hmmtasks init               ) = 6.043e-04 S  per = 3.45  per(accum) = 13.4
 T(sweep opt: initial guess for dvdson    ) = 8.929e-06 S  per = 0.0509  per(accum) = 13.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.347e-02 S  per = 76.8  per(accum) = 90.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.218e-04 S  per = 1.84  per(accum) = 92.1
 T(sweep opt: dvdson [nccl]               ) = 6.325e-04 S  per = 3.61  per(accum) = 95.7
 T(sweep opt: dvdson [mpi]                ) = 7.245e-06 S  per = 0.0413  per(accum) = 95.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.394e-04 S  per = 4.22  per(accum) = 100
Detailed decomposition of T(renrm) = 4.748e-02 S  T(sum) = 4.748e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.343e-04 S  per = 0.283  per(accum) = 0.283
 T(sweep opt: qops init                    ) = 8.857e-04 S  per = 1.87  per(accum) = 2.15
 T(sweep opt: symbolic_formulae_renorm     ) = 1.402e-04 S  per = 0.295  per(accum) = 2.44
 T(sweep opt: allocate qops on gpu         ) = 1.542e-04 S  per = 0.325  per(accum) = 2.77
 T(sweep opt: site memcpy cpu2gpu          ) = 6.796e-05 S  per = 0.143  per(accum) = 2.91
 T(sweep opt: rintermediate init           ) = 1.649e-04 S  per = 0.347  per(accum) = 3.26
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.151e-04 S  per =  1.3  per(accum) = 4.55
 T(sweep opt: rmmtasks init                ) = 7.461e-04 S  per = 1.57  per(accum) = 6.13
 T(sweep opt: qops memset on cpu           ) = 9.400e-08 S  per = 0.000198  per(accum) = 6.13
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.151e-03 S  per = 4.53  per(accum) = 10.7
 T(sweep opt: deallocate cpu and gpu memory) = 7.977e-05 S  per = 0.168  per(accum) = 10.8
 T(sweep opt: construct opS [ifdists=true] ) = 4.016e-02 S  per = 84.6  per(accum) = 95.4
 T(sweep opt: reduction of opS & opH [nccl]) = 6.132e-05 S  per = 0.129  per(accum) = 95.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.721e-04 S  per = 0.362  per(accum) = 95.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.018e-04 S  per = 0.215  per(accum) = 96.1
 T(sweep opt: qops_pool join and erase     ) = 1.836e-03 S  per = 3.87  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 2.569e-06 S  per = 0.00541  per(accum) = 100
##### global opt: 8.444e-02 S #####
 T(global opt: fetch) = 1.118e-02 S  per = 13.2  per(accum) = 13.2
 T(global opt: hdiag) = 8.957e-04 S  per = 1.06  per(accum) = 14.3
 T(global opt: dvdsn) = 1.823e-02 S  per = 21.6  per(accum) = 35.9
 T(global opt: decim) = 1.127e-03 S  per = 1.33  per(accum) = 37.2
 T(global opt: guess) = 1.005e-04 S  per = 0.119  per(accum) = 37.3
 T(global opt: renrm) = 4.748e-02 S  per = 56.2  per(accum) = 93.6
 T(global opt: save ) = 5.432e-03 S  per = 6.43  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.823e-02 S  T(sum) = 1.753e-02 S  per = 9.618e+01
 T(global opt: preprocess                  ) = 1.632e-04 S  per = 0.931  per(accum) = 0.931
 T(global opt: symbolic_formulae           ) = 6.831e-04 S  per =  3.9  per(accum) = 4.83
 T(global opt: hintermediate init          ) = 1.320e-04 S  per = 0.753  per(accum) = 5.58
 T(global opt: preprocess_hformulae_Hxlist ) = 7.688e-04 S  per = 4.39  per(accum) = 9.97
 T(global opt: hmmtasks init               ) = 6.043e-04 S  per = 3.45  per(accum) = 13.4
 T(global opt: initial guess for dvdson    ) = 8.929e-06 S  per = 0.0509  per(accum) = 13.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.347e-02 S  per = 76.8  per(accum) = 90.3
 T(global opt: dvdson [cpu-gpu]            ) = 3.218e-04 S  per = 1.84  per(accum) = 92.1
 T(global opt: dvdson [nccl]               ) = 6.325e-04 S  per = 3.61  per(accum) = 95.7
 T(global opt: dvdson [mpi]                ) = 7.245e-06 S  per = 0.0413  per(accum) = 95.8
 T(global opt: dvdson [rest part(linalg)]  ) = 7.394e-04 S  per = 4.22  per(accum) = 100
Detailed decomposition of T(renrm) = 4.748e-02 S  T(sum) = 4.748e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.343e-04 S  per = 0.283  per(accum) = 0.283
 T(global opt: qops init                    ) = 8.857e-04 S  per = 1.87  per(accum) = 2.15
 T(global opt: symbolic_formulae_renorm     ) = 1.402e-04 S  per = 0.295  per(accum) = 2.44
 T(global opt: allocate qops on gpu         ) = 1.542e-04 S  per = 0.325  per(accum) = 2.77
 T(global opt: site memcpy cpu2gpu          ) = 6.796e-05 S  per = 0.143  per(accum) = 2.91
 T(global opt: rintermediate init           ) = 1.649e-04 S  per = 0.347  per(accum) = 3.26
 T(global opt: preprocess_formulae_Rlist2   ) = 6.151e-04 S  per =  1.3  per(accum) = 4.55
 T(global opt: rmmtasks init                ) = 7.461e-04 S  per = 1.57  per(accum) = 6.13
 T(global opt: qops memset on cpu           ) = 9.400e-08 S  per = 0.000198  per(accum) = 6.13
 T(global opt: preprocess_renorm_batchGPU   ) = 2.151e-03 S  per = 4.53  per(accum) = 10.7
 T(global opt: deallocate cpu and gpu memory) = 7.977e-05 S  per = 0.168  per(accum) = 10.8
 T(global opt: construct opS [ifdists=true] ) = 4.016e-02 S  per = 84.6  per(accum) = 95.4
 T(global opt: reduction of opS & opH [nccl]) = 6.132e-05 S  per = 0.129  per(accum) = 95.6
 T(global opt: qops memcpy gpu2cpu          ) = 1.721e-04 S  per = 0.362  per(accum) = 95.9
 T(global opt: reduction of opS & opH [mpi] ) = 1.018e-04 S  per = 0.215  per(accum) = 96.1
 T(global opt: qops_pool join and erase     ) = 1.836e-03 S  per = 3.87  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 2.569e-06 S  per = 0.00541  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-4.122e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=3/seqsize=34 dots=1 dbond=(4,0)-(5,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=14 scratch=./scratch/sweep size=478:3.56e-06GB T(load)=3.22e-04S speed=1.11e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=691:5.27e-03MB:5.15e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=213:1.63e-03MB:1.59e-06GB
total mem of comb=1052:8.03e-03MB:7.84e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=7.287e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=4,15,1
 suppl= 0 1 2 3
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 4
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:8 S:16 H:1 A:14 B:18 
        dim(bra,ket)=17,17 size(op)=63:4.807e-04MB size(tot)=1873:1.429e-02MB:1.395e-05GB
        per(mem): C:12.4 S:41 H:3.36 A:6.19 B:37.1 
 rqops: oplist=CSHPQ nops=C:30 S:5 H:1 P:22 Q:28 
        dim(bra,ket)=27,27 size(op)=159:0.00121MB size(tot)=6244:0.0476MB:4.65e-05GB
        per(mem): C:36 S:10.1 H:2.55 P:9.8 Q:41.5 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=10453:0.0798MB:7.79e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.027e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(4,0) fdel=./scratch/sweep/rop(5,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-5.305e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(17,27,4) nnz=213:1.625e-03MB
qtensor3: wf3 own=1 _data=0x55b2cdae9c00
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=6 dimAll=17
 (6,2):5 (7,1):4 (5,3):4 (5,1):2 (8,0):1 (4,4):1
 qbond: qcol nsym=7 dimAll=27
 (22,-2):8 (23,-3):8 (24,-4):4 (21,-1):3 (24,-2):2 (23,-1):1 (25,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=15 nblocks=168 size=213:1.625e-03MB
### DIAG TIMING: total=4.422e-04 t1=1.902e-05, t2=1.433e-05, t3=1.571e-05, t4=3.295e-04, t5=1.257e-05, t6=4.168e-05, t7=9.348e-06
duration_diagGPU:4.510e-04
duration_diagreduce:5.400e-08
duration_diagtransform:5.950e-07
----- TIMING FOR symbolic_formulae_onedot with size=219 : 6.163e-04 S -----
rank=0 GPUmem(GB): used=7.788e-05 (oper)=7.788e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=219
 no. of hintermediate operators=94
 no. of coefficients=1410:1.076e-02MB:1.051e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.764e-05 S -----
rank=0 GPUmem(GB): used=8.839e-05 (oper,hinter)=7.788e-05,1.051e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.582e-04 S size(H_formulae)=219 size(Hxlst2)=15 T(Hmu/Hxlist)=1.182e-04,5.400e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 8.781e-04 S size(H_formulae)=219 size(Hxlst)=2062 -----
rank=0 GPUmem(GB): used=8.839e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=3.174e-06 batch[need]=2.228e-03 blksize=40 blksize0=64 batchsize=2062
rank=0 GPUmem(GB): used=2.319e-03 (oper,hinter,dvdson,batch)=7.788e-05,1.051e-05,3.174e-06,2.228e-03
ctns::pdvdsonSolver_nkr::solve_iter ndim=213 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.639e-05,1.154e-04,1.266e-03,2.245e-04,1.701e-03
 analyze_tgpu[Hx]: ndim=213:1.587e-06GB T(cpu-gpu)=2.506e-05 speed=1.267e-01GB/S T(nccl)=6.134e-05 speed=5.175e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=1.3e-03 t_reduction=2.2e-04 tot=1.6e-03 -----
 sigma[inter] counter=16 t=1.2e-04 per=7.2e+00 cost=3.4e+05 flops=2.9e+09
 sigma[gemm] counter=16 i=0 t=2.5e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=1 t=2.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=16 i=2 t=3.3e-04 per=2.1e+01 cost=1.4e+05 flops=4.3e+08
 sigma[gemm] counter=16 i=3 t=3.9e-04 per=2.5e+01 cost=1.4e+05 flops=3.6e+08
 sigma[gemm] counter=16 i=4 t=2.6e-04 per=1.6e+01 cost=1.2e+05 flops=4.5e+08
 sigma[gemm] counter=16 i=5 t=2.7e-04 per=1.7e+01 cost=1.2e+05 flops=4.5e+08
 sigma[gemm] counter=16 total t=1.3e-03 per=7.9e+01 cost=5.3e+05 flops=4.2e+08
 sigma[red] counter=16 t=2.2e-04 per=1.4e+01 cost=7.0e+04 flops=3.1e+08
----- TIMING FOR sigma_tot : t_inter=1.1e-03 t_gemm=9.1e-03 t_reduction=2.8e-03 tot=1.3e-02 -----
 sigma_tot[inter] counter=16 t=1.1e-03 per=8.3e+00 cost=1.0e+06 flops=9.4e+08
 sigma_tot[gemm] counter=16 i=0 t=3.4e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=1 t=3.1e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=16 i=2 t=2.3e-03 per=1.8e+01 cost=3.5e+05 flops=1.5e+08
 sigma_tot[gemm] counter=16 i=3 t=2.6e-03 per=2.0e+01 cost=3.6e+05 flops=1.4e+08
 sigma_tot[gemm] counter=16 i=4 t=2.0e-03 per=1.5e+01 cost=3.2e+05 flops=1.6e+08
 sigma_tot[gemm] counter=16 i=5 t=2.1e-03 per=1.6e+01 cost=3.4e+05 flops=1.6e+08
 sigma_tot[gemm] counter=16 total t=9.1e-03 per=7.0e+01 cost=1.4e+06 flops=1.5e+08
 sigma_tot[red] counter=16 t=2.8e-03 per=2.1e+01 cost=2.3e+05 flops=8.3e+07
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,3.5e-06,1.4e-06,1.4e-06,3.4e-07
settings: ndim=213 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.466364795540 -1.116e+03  5.586e-02    1     1  1.811e-03 1.811e-03 1.788e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.167e-05,1.127e-04,1.565e-03,2.522e-04,2.008e-03
 analyze_tgpu[Hx]: ndim=213:1.587e-06GB T(cpu-gpu)=2.316e-05 speed=1.371e-01GB/S T(nccl)=4.851e-05 speed=6.543e-02GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.6e-03 t_reduction=2.5e-04 tot=1.9e-03 -----
 sigma[inter] counter=17 t=1.1e-04 per=5.8e+00 cost=3.4e+05 flops=3.0e+09
 sigma[gemm] counter=17 i=0 t=2.7e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=1 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=17 i=2 t=4.0e-04 per=2.0e+01 cost=1.4e+05 flops=3.6e+08
 sigma[gemm] counter=17 i=3 t=5.0e-04 per=2.6e+01 cost=1.4e+05 flops=2.9e+08
 sigma[gemm] counter=17 i=4 t=3.2e-04 per=1.7e+01 cost=1.2e+05 flops=3.6e+08
 sigma[gemm] counter=17 i=5 t=3.4e-04 per=1.8e+01 cost=1.2e+05 flops=3.6e+08
 sigma[gemm] counter=17 total t=1.6e-03 per=8.1e+01 cost=5.3e+05 flops=3.4e+08
 sigma[red] counter=17 t=2.5e-04 per=1.3e+01 cost=7.0e+04 flops=2.8e+08
----- TIMING FOR sigma_tot : t_inter=1.2e-03 t_gemm=1.1e-02 t_reduction=3.0e-03 tot=1.5e-02 -----
 sigma_tot[inter] counter=17 t=1.2e-03 per=7.9e+00 cost=1.3e+06 flops=1.1e+09
 sigma_tot[gemm] counter=17 i=0 t=3.6e-05 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=1 t=3.3e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=17 i=2 t=2.7e-03 per=1.8e+01 cost=4.9e+05 flops=1.8e+08
 sigma_tot[gemm] counter=17 i=3 t=3.1e-03 per=2.1e+01 cost=5.0e+05 flops=1.6e+08
 sigma_tot[gemm] counter=17 i=4 t=2.3e-03 per=1.6e+01 cost=4.4e+05 flops=1.9e+08
 sigma_tot[gemm] counter=17 i=5 t=2.5e-03 per=1.6e+01 cost=4.6e+05 flops=1.9e+08
 sigma_tot[gemm] counter=17 total t=1.1e-02 per=7.2e+01 cost=1.9e+06 flops=1.8e+08
 sigma_tot[red] counter=17 t=3.0e-03 per=2.0e+01 cost=3.0e+05 flops=9.9e+07
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=7.9e-06,1.2e-05,3.4e-06,2.0e-06,3.5e-07
    2   0 -    -116.471321348636 -4.957e-03  1.556e-02    2     2  4.077e-03 2.039e-03 1.990e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.485e-05,1.006e-04,1.561e-03,2.538e-04,1.995e-03
 analyze_tgpu[Hx]: ndim=213:1.587e-06GB T(cpu-gpu)=2.504e-05 speed=1.267e-01GB/S T(nccl)=4.980e-05 speed=6.373e-02GB/S
----- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=1.6e-03 t_reduction=2.5e-04 tot=1.9e-03 -----
 sigma[inter] counter=18 t=1.0e-04 per=5.3e+00 cost=3.4e+05 flops=3.4e+09
 sigma[gemm] counter=18 i=0 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=1 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=18 i=2 t=3.9e-04 per=2.0e+01 cost=1.4e+05 flops=3.6e+08
 sigma[gemm] counter=18 i=3 t=5.0e-04 per=2.6e+01 cost=1.4e+05 flops=2.9e+08
 sigma[gemm] counter=18 i=4 t=3.2e-04 per=1.7e+01 cost=1.2e+05 flops=3.6e+08
 sigma[gemm] counter=18 i=5 t=3.4e-04 per=1.8e+01 cost=1.2e+05 flops=3.6e+08
 sigma[gemm] counter=18 total t=1.6e-03 per=8.2e+01 cost=5.3e+05 flops=3.4e+08
 sigma[red] counter=18 t=2.5e-04 per=1.3e+01 cost=7.0e+04 flops=2.8e+08
----- TIMING FOR sigma_tot : t_inter=1.3e-03 t_gemm=1.2e-02 t_reduction=3.3e-03 tot=1.7e-02 -----
 sigma_tot[inter] counter=18 t=1.3e-03 per=7.6e+00 cost=1.7e+06 flops=1.3e+09
 sigma_tot[gemm] counter=18 i=0 t=3.9e-05 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=1 t=3.6e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=18 i=2 t=3.1e-03 per=1.8e+01 cost=6.3e+05 flops=2.0e+08
 sigma_tot[gemm] counter=18 i=3 t=3.6e-03 per=2.2e+01 cost=6.4e+05 flops=1.8e+08
 sigma_tot[gemm] counter=18 i=4 t=2.7e-03 per=1.6e+01 cost=5.6e+05 flops=2.1e+08
 sigma_tot[gemm] counter=18 i=5 t=2.8e-03 per=1.7e+01 cost=5.9e+05 flops=2.1e+08
 sigma_tot[gemm] counter=18 total t=1.2e-02 per=7.3e+01 cost=2.4e+06 flops=2.0e+08
 sigma_tot[red] counter=18 t=3.3e-03 per=2.0e+01 cost=3.7e+05 flops=1.1e+08
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=7.6e-06,1.8e-05,3.2e-06,2.8e-06,3.6e-07
    3   0 -    -116.471714220384 -3.929e-04  5.641e-03    3     3  6.275e-03 2.092e-03 2.039e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.559e-05,1.148e-04,1.887e-03,2.878e-04,2.371e-03
 analyze_tgpu[Hx]: ndim=213:1.587e-06GB T(cpu-gpu)=2.463e-05 speed=1.289e-01GB/S T(nccl)=5.097e-05 speed=6.227e-02GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.9e-03 t_reduction=2.9e-04 tot=2.3e-03 -----
 sigma[inter] counter=19 t=1.1e-04 per=5.0e+00 cost=3.4e+05 flops=3.0e+09
 sigma[gemm] counter=19 i=0 t=3.1e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=1 t=2.9e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=19 i=2 t=4.7e-04 per=2.1e+01 cost=1.4e+05 flops=3.0e+08
 sigma[gemm] counter=19 i=3 t=5.9e-04 per=2.6e+01 cost=1.4e+05 flops=2.4e+08
 sigma[gemm] counter=19 i=4 t=4.1e-04 per=1.8e+01 cost=1.2e+05 flops=2.9e+08
 sigma[gemm] counter=19 i=5 t=4.1e-04 per=1.8e+01 cost=1.2e+05 flops=3.0e+08
 sigma[gemm] counter=19 total t=1.9e-03 per=8.2e+01 cost=5.3e+05 flops=2.8e+08
 sigma[red] counter=19 t=2.9e-04 per=1.3e+01 cost=7.0e+04 flops=2.4e+08
----- TIMING FOR sigma_tot : t_inter=1.4e-03 t_gemm=1.4e-02 t_reduction=3.6e-03 tot=1.9e-02 -----
 sigma_tot[inter] counter=19 t=1.4e-03 per=7.3e+00 cost=2.0e+06 flops=1.4e+09
 sigma_tot[gemm] counter=19 i=0 t=4.2e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=1 t=3.8e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=19 i=2 t=3.6e-03 per=1.9e+01 cost=7.7e+05 flops=2.2e+08
 sigma_tot[gemm] counter=19 i=3 t=4.2e-03 per=2.2e+01 cost=7.9e+05 flops=1.9e+08
 sigma_tot[gemm] counter=19 i=4 t=3.1e-03 per=1.6e+01 cost=6.8e+05 flops=2.2e+08
 sigma_tot[gemm] counter=19 i=5 t=3.2e-03 per=1.7e+01 cost=7.1e+05 flops=2.2e+08
 sigma_tot[gemm] counter=19 total t=1.4e-02 per=7.4e+01 cost=2.9e+06 flops=2.1e+08
 sigma_tot[red] counter=19 t=3.6e-03 per=1.9e+01 cost=4.4e+05 flops=1.2e+08
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=7.3e-06,1.7e-05,2.9e-06,2.6e-06,2.9e-07
    4   0 -    -116.471776920961 -6.270e-05  2.313e-03    3     4  8.848e-03 2.212e-03 2.157e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.235e-05,1.156e-04,1.886e-03,2.909e-04,2.380e-03
 analyze_tgpu[Hx]: ndim=213:1.587e-06GB T(cpu-gpu)=2.432e-05 speed=1.305e-01GB/S T(nccl)=5.803e-05 speed=5.470e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=1.9e-03 t_reduction=2.9e-04 tot=2.3e-03 -----
 sigma[inter] counter=20 t=1.2e-04 per=5.0e+00 cost=3.4e+05 flops=2.9e+09
 sigma[gemm] counter=20 i=0 t=3.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=1 t=2.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=20 i=2 t=4.7e-04 per=2.0e+01 cost=1.4e+05 flops=3.0e+08
 sigma[gemm] counter=20 i=3 t=6.1e-04 per=2.7e+01 cost=1.4e+05 flops=2.4e+08
 sigma[gemm] counter=20 i=4 t=3.9e-04 per=1.7e+01 cost=1.2e+05 flops=3.0e+08
 sigma[gemm] counter=20 i=5 t=4.1e-04 per=1.8e+01 cost=1.2e+05 flops=3.0e+08
 sigma[gemm] counter=20 total t=1.9e-03 per=8.2e+01 cost=5.3e+05 flops=2.8e+08
 sigma[red] counter=20 t=2.9e-04 per=1.3e+01 cost=7.0e+04 flops=2.4e+08
----- TIMING FOR sigma_tot : t_inter=1.5e-03 t_gemm=1.6e-02 t_reduction=3.9e-03 tot=2.1e-02 -----
 sigma_tot[inter] counter=20 t=1.5e-03 per=7.1e+00 cost=2.4e+06 flops=1.6e+09
 sigma_tot[gemm] counter=20 i=0 t=4.5e-05 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=1 t=4.1e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=20 i=2 t=4.0e-03 per=1.9e+01 cost=9.2e+05 flops=2.3e+08
 sigma_tot[gemm] counter=20 i=3 t=4.8e-03 per=2.3e+01 cost=9.3e+05 flops=1.9e+08
 sigma_tot[gemm] counter=20 i=4 t=3.5e-03 per=1.6e+01 cost=7.9e+05 flops=2.3e+08
 sigma_tot[gemm] counter=20 i=5 t=3.6e-03 per=1.7e+01 cost=8.3e+05 flops=2.3e+08
 sigma_tot[gemm] counter=20 total t=1.6e-02 per=7.5e+01 cost=3.5e+06 flops=2.2e+08
 sigma_tot[red] counter=20 t=3.9e-03 per=1.8e+01 cost=5.1e+05 flops=1.3e+08
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=6.8e-06,1.6e-05,2.9e-06,2.5e-06,2.8e-07
    5   0 -    -116.471786686258 -9.765e-06  8.436e-04    3     5  1.143e-02 2.286e-03 2.229e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.363e-05,1.137e-04,1.870e-03,2.896e-04,2.352e-03
 analyze_tgpu[Hx]: ndim=213:1.587e-06GB T(cpu-gpu)=2.457e-05 speed=1.292e-01GB/S T(nccl)=4.906e-05 speed=6.469e-02GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.9e-03 t_reduction=2.9e-04 tot=2.3e-03 -----
 sigma[inter] counter=21 t=1.1e-04 per=5.0e+00 cost=3.4e+05 flops=3.0e+09
 sigma[gemm] counter=21 i=0 t=3.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=1 t=2.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=21 i=2 t=4.7e-04 per=2.1e+01 cost=1.4e+05 flops=3.0e+08
 sigma[gemm] counter=21 i=3 t=5.9e-04 per=2.6e+01 cost=1.4e+05 flops=2.4e+08
 sigma[gemm] counter=21 i=4 t=3.9e-04 per=1.7e+01 cost=1.2e+05 flops=3.0e+08
 sigma[gemm] counter=21 i=5 t=4.0e-04 per=1.8e+01 cost=1.2e+05 flops=3.0e+08
 sigma[gemm] counter=21 total t=1.9e-03 per=8.2e+01 cost=5.3e+05 flops=2.8e+08
 sigma[red] counter=21 t=2.9e-04 per=1.3e+01 cost=7.0e+04 flops=2.4e+08
----- TIMING FOR sigma_tot : t_inter=1.6e-03 t_gemm=1.8e-02 t_reduction=4.2e-03 tot=2.4e-02 -----
 sigma_tot[inter] counter=21 t=1.6e-03 per=6.9e+00 cost=2.7e+06 flops=1.7e+09
 sigma_tot[gemm] counter=21 i=0 t=4.8e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=1 t=4.4e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=21 i=2 t=4.5e-03 per=1.9e+01 cost=1.1e+06 flops=2.3e+08
 sigma_tot[gemm] counter=21 i=3 t=5.4e-03 per=2.3e+01 cost=1.1e+06 flops=2.0e+08
 sigma_tot[gemm] counter=21 i=4 t=3.8e-03 per=1.6e+01 cost=9.1e+05 flops=2.4e+08
 sigma_tot[gemm] counter=21 i=5 t=4.0e-03 per=1.7e+01 cost=9.5e+05 flops=2.4e+08
 sigma_tot[gemm] counter=21 total t=1.8e-02 per=7.6e+01 cost=4.0e+06 flops=2.2e+08
 sigma_tot[red] counter=21 t=4.2e-03 per=1.8e+01 cost=5.8e+05 flops=1.4e+08
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=7.1e-06,1.6e-05,2.7e-06,2.5e-06,3.1e-07
    6   0 -    -116.471788050986 -1.365e-06  2.527e-04    3     6  1.406e-02 2.343e-03 2.286e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.605e-05,1.166e-04,1.872e-03,2.845e-04,2.354e-03
 analyze_tgpu[Hx]: ndim=213:1.587e-06GB T(cpu-gpu)=2.429e-05 speed=1.307e-01GB/S T(nccl)=5.176e-05 speed=6.132e-02GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=1.9e-03 t_reduction=2.8e-04 tot=2.3e-03 -----
 sigma[inter] counter=22 t=1.2e-04 per=5.1e+00 cost=3.4e+05 flops=2.9e+09
 sigma[gemm] counter=22 i=0 t=3.1e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=1 t=3.0e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=22 i=2 t=4.7e-04 per=2.1e+01 cost=1.4e+05 flops=3.0e+08
 sigma[gemm] counter=22 i=3 t=6.0e-04 per=2.6e+01 cost=1.4e+05 flops=2.4e+08
 sigma[gemm] counter=22 i=4 t=3.9e-04 per=1.7e+01 cost=1.2e+05 flops=3.0e+08
 sigma[gemm] counter=22 i=5 t=4.1e-04 per=1.8e+01 cost=1.2e+05 flops=3.0e+08
 sigma[gemm] counter=22 total t=1.9e-03 per=8.2e+01 cost=5.3e+05 flops=2.8e+08
 sigma[red] counter=22 t=2.8e-04 per=1.3e+01 cost=7.0e+04 flops=2.5e+08
----- TIMING FOR sigma_tot : t_inter=1.7e-03 t_gemm=2.0e-02 t_reduction=4.4e-03 tot=2.6e-02 -----
 sigma_tot[inter] counter=22 t=1.7e-03 per=6.7e+00 cost=3.0e+06 flops=1.7e+09
 sigma_tot[gemm] counter=22 i=0 t=5.1e-05 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=1 t=4.7e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=22 i=2 t=5.0e-03 per=1.9e+01 cost=1.2e+06 flops=2.4e+08
 sigma_tot[gemm] counter=22 i=3 t=6.0e-03 per=2.3e+01 cost=1.2e+06 flops=2.0e+08
 sigma_tot[gemm] counter=22 i=4 t=4.2e-03 per=1.6e+01 cost=1.0e+06 flops=2.4e+08
 sigma_tot[gemm] counter=22 i=5 t=4.4e-03 per=1.7e+01 cost=1.1e+06 flops=2.4e+08
 sigma_tot[gemm] counter=22 total t=2.0e-02 per=7.6e+01 cost=4.5e+06 flops=2.3e+08
 sigma_tot[red] counter=22 t=4.4e-03 per=1.7e+01 cost=6.5e+05 flops=1.5e+08
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=6.5e-06,1.5e-05,2.9e-06,2.5e-06,2.7e-07
    7   0 +    -116.471788147632 -9.665e-08  6.699e-05    3     7  1.661e-02 2.373e-03 2.315e-03
TIMING FOR Davidson : 1.663e-02  T(cal/comm/rest)=1.621e-02,2.678e-06,4.174e-04
decomposed t_rest=4.174e-04
 T(sub)    =1.826e-04 per=4.375e+01
 T(precond)=2.726e-05 per=6.530e+00
 T(ortho)  =1.762e-05 per=4.222e+00
 T(xcopy)  =1.480e-06 per=3.546e-01
 T(xnrm2)  =2.212e-06 per=5.299e-01
 T(other)  =1.862e-04 per=4.461e+01
optimized energies: isweep=0 ibond=3 dots=1 e[0]=-116.471788147632 nmvp=7
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=6.437e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=14 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=14 dimAll=68
 (6,2):11 (8,2):9 (7,3):9 (7,1):11 (9,1):5 (8,0):5 (5,3):5 (6,4):5 (5,1):2 (6,0):2 (10,0):1 (9,-1):1 (4,4):1 (5,5):1
timing for divide=3.8e-06
timing for compute=8.8e-05
timing for collect=7.9e-06
----- TMING FOR decimation_genbasis(nkr): 1.0e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.8e-06,8.5e-05,0.0e+00,3.3e-06,7.9e-06 -----
decimation summary: 68->27 dwt=+1.110e-16 SvN=1.038e+00
 qbond: qkept nsym=7 dimAll=27
 (8,2):8 (7,3):8 (6,4):4 (9,1):3 (6,2):2 (7,1):1 (5,5):1
----- TIMING for decimation_row(nkr): 1.054e-03 S T(decim/select/formRot)=1.383e-04,9.028e-04,1.264e-05 -----
----- TIMING FOR onedot_decimation: 1.092e-03 S T(wf/decim)=3.074e-05,1.061e-03 -----
ctns::oper_renorm coord=(4,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:10 S:15 H:1 A:22 B:28 
        dim(bra,ket)=27,27 size(op)=159:1.213e-03MB size(tot)=6004:4.581e-02MB:4.473e-05GB
        per(mem): C:12.5 S:31.5 H:2.65 A:10.2 B:43.2 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=9.001e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=61 : 7.572e-05 S -----
rank=0 GPUmem(GB): used=8.660e-05 (oper)=7.609e-05
rank=0 GPUmem(GB): used=8.819e-05 (oper,site)=7.609e-05,1.587e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=61
 no. of rintermediate operators=7
 no. of coefficients=56:4.272e-04MB:4.172e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.912e-05 S -----
rank=0 GPUmem(GB): used=8.860e-05 (oper,site,rinter)=7.609e-05,1.587e-06,4.172e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.867e-04 S size(rtasks)=61 size(Rlst2)=49 T(Rmu/Rlist)=4.017e-05,1.465e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.574e-04 S size(rtasks)=61 size(Rlst)=493 -----
rank=0 GPUmem(GB): used=8.860e-05 avail=3.829e+01 total=3.829e+01 batch[need]=5.657e-04 blksize=64 blksize0=25 batchsize=493
rank=0 GPUmem(GB): used=6.543e-04 (oper,site,rinter,batch)=7.609e-05,1.587e-06,4.172e-07,5.657e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.066e-04,7.588e-04,2.088e-04
----- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=7.6e-04 t_reduction=2.1e-04 tot=1.1e-03 -----
 renorm[inter] counter=106 t=1.1e-04 per=9.9e+00 cost=1.9e+04 flops=1.8e+08
 renorm[gemm] counter=106 i=0 t=2.2e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=106 i=1 t=2.1e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=106 i=2 t=2.1e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=106 i=3 t=2.1e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=106 i=4 t=2.2e-04 per=2.0e+01 cost=1.1e+04 flops=5.0e+07
 renorm[gemm] counter=106 i=5 t=2.9e-04 per=2.7e+01 cost=4.0e+04 flops=1.4e+08
 renorm[gemm] counter=106 i=6 t=2.4e-04 per=2.2e+01 cost=8.7e+04 flops=3.7e+08
 renorm[gemm] counter=106 total t=7.6e-04 per=7.1e+01 cost=1.4e+05 flops=1.8e+08
 renorm[red] counter=106 t=2.1e-04 per=1.9e+01 cost=2.1e+04 flops=1.0e+08
----- TIMING FOR renorm_tot : t_inter=3.0e-04 t_gemm=1.9e-03 t_reduction=6.7e-04 tot=2.8e-03 -----
 renorm_tot[inter] counter=106 t=3.0e-04 per=1.1e+01 cost=3.8e+04 flops=1.3e+08
 renorm_tot[gemm] counter=106 i=0 t=9.1e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=106 i=1 t=8.0e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=106 i=2 t=8.0e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=106 i=3 t=8.0e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=106 i=4 t=5.3e-04 per=1.9e+01 cost=2.7e+04 flops=5.0e+07
 renorm_tot[gemm] counter=106 i=5 t=6.4e-04 per=2.3e+01 cost=8.8e+04 flops=1.4e+08
 renorm_tot[gemm] counter=106 i=6 t=6.4e-04 per=2.3e+01 cost=2.5e+05 flops=4.0e+08
 renorm_tot[gemm] counter=106 total t=1.9e-03 per=6.6e+01 cost=3.7e+05 flops=2.0e+08
 renorm_tot[red] counter=106 t=6.7e-04 per=2.4e+01 cost=9.6e+04 flops=1.4e+08
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=9.846e-05 (oper)=7.703e-05
rank=0 GPUmem(GB): used=1.000e-04 (oper,site,rinter)=7.703e-05,1.587e-06,1.051e-05
rank=0 GPUmem(GB): used=1.540e-04 (oper,site,rinter,batch)=7.703e-05,1.587e-06,1.051e-05,5.393e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.399e-02 S T(preprocess/alloc/comp/red/dealloc)=2.192e-03,2.237e-03,1.092e-02,5.868e-04,1.934e-04 -----
----- TIMING FOR oper_renorm_opS : 1.404e-02 S rank=0 -----
qops.to_cpu: size(tot)=6004:4.581e-02MB:4.473e-05GB T(to_cpu)=3.798e-05S speed=1.178e+00GB/S
check ||H-H.dagger||=1.852e-14 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.0164 S rank=0 -----
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.839e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=3.891e-04 change=-1.177e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=3.891e-04 change=-3.234e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 4.306e-02 S #####
 T(local opt: fetch) = 2.818e-03 S  per = 6.54  per(accum) = 6.54
 T(local opt: hdiag) = 4.829e-04 S  per = 1.12  per(accum) = 7.67
 T(local opt: dvdsn) = 1.981e-02 S  per =   46  per(accum) = 53.7
 T(local opt: decim) = 1.119e-03 S  per =  2.6  per(accum) = 56.3
 T(local opt: guess) = 4.313e-05 S  per =  0.1  per(accum) = 56.4
 T(local opt: renrm) = 1.692e-02 S  per = 39.3  per(accum) = 95.7
 T(local opt: save ) = 1.863e-03 S  per = 4.33  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.981e-02 S  T(sum) = 1.922e-02 S  per = 9.700e+01
 T(local opt: preprocess                  ) = 5.200e-05 S  per = 0.271  per(accum) = 0.271
 T(local opt: symbolic_formulae           ) = 6.228e-04 S  per = 3.24  per(accum) = 3.51
 T(local opt: hintermediate init          ) = 4.698e-05 S  per = 0.244  per(accum) = 3.76
 T(local opt: preprocess_hformulae_Hxlist ) = 8.880e-04 S  per = 4.62  per(accum) = 8.38
 T(local opt: hmmtasks init               ) = 9.774e-04 S  per = 5.09  per(accum) = 13.5
 T(local opt: initial guess for dvdson    ) = 3.777e-06 S  per = 0.0197  per(accum) = 13.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.567e-02 S  per = 81.5  per(accum) = 95
 T(local opt: dvdson [cpu-gpu]            ) = 1.711e-04 S  per = 0.89  per(accum) = 95.9
 T(local opt: dvdson [nccl]               ) = 3.695e-04 S  per = 1.92  per(accum) = 97.8
 T(local opt: dvdson [mpi]                ) = 2.678e-06 S  per = 0.0139  per(accum) = 97.8
 T(local opt: dvdson [rest part(linalg)]  ) = 4.174e-04 S  per = 2.17  per(accum) = 100
Detailed decomposition of T(renrm) = 1.692e-02 S  T(sum) = 1.692e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.306e-05 S  per = 0.255  per(accum) = 0.255
 T(local opt: qops init                    ) = 3.002e-04 S  per = 1.77  per(accum) = 2.03
 T(local opt: symbolic_formulae_renorm     ) = 8.033e-05 S  per = 0.475  per(accum) = 2.5
 T(local opt: allocate qops on gpu         ) = 5.444e-05 S  per = 0.322  per(accum) = 2.82
 T(local opt: site memcpy cpu2gpu          ) = 2.321e-05 S  per = 0.137  per(accum) = 2.96
 T(local opt: rintermediate init           ) = 3.640e-05 S  per = 0.215  per(accum) = 3.18
 T(local opt: preprocess_formulae_Rlist2   ) = 2.630e-04 S  per = 1.55  per(accum) = 4.73
 T(local opt: rmmtasks init                ) = 2.325e-04 S  per = 1.37  per(accum) = 6.11
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 0.000207  per(accum) = 6.11
 T(local opt: preprocess_renorm_batchGPU   ) = 1.168e-03 S  per =  6.9  per(accum) = 13
 T(local opt: deallocate cpu and gpu memory) = 3.099e-05 S  per = 0.183  per(accum) = 13.2
 T(local opt: construct opS [ifdists=true] ) = 1.405e-02 S  per =   83  per(accum) = 96.2
 T(local opt: reduction of opS & opH [nccl]) = 2.134e-05 S  per = 0.126  per(accum) = 96.4
 T(local opt: qops memcpy gpu2cpu          ) = 4.915e-05 S  per = 0.29  per(accum) = 96.7
 T(local opt: reduction of opS & opH [mpi] ) = 4.572e-05 S  per = 0.27  per(accum) = 96.9
 T(local opt: qops_pool join and erase     ) = 5.194e-04 S  per = 3.07  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.010e-07 S  per = 0.00473  per(accum) = 100
ctns::rcanon_save_site idx=15 scratch=./scratch/sweep size=213:1.6e-06GB T(load)=0.00055S speed=0.0029GB/S
##### sweep opt: 1.275e-01 S #####
 T(sweep opt: fetch) = 1.400e-02 S  per =   11  per(accum) = 11
 T(sweep opt: hdiag) = 1.379e-03 S  per = 1.08  per(accum) = 12.1
 T(sweep opt: dvdsn) = 3.804e-02 S  per = 29.8  per(accum) = 41.9
 T(sweep opt: decim) = 2.246e-03 S  per = 1.76  per(accum) = 43.7
 T(sweep opt: guess) = 1.436e-04 S  per = 0.113  per(accum) = 43.8
 T(sweep opt: renrm) = 6.440e-02 S  per = 50.5  per(accum) = 94.3
 T(sweep opt: save ) = 7.295e-03 S  per = 5.72  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.804e-02 S  T(sum) = 3.675e-02 S  per = 9.661e+01
 T(sweep opt: preprocess                  ) = 2.152e-04 S  per = 0.586  per(accum) = 0.586
 T(sweep opt: symbolic_formulae           ) = 1.306e-03 S  per = 3.55  per(accum) = 4.14
 T(sweep opt: hintermediate init          ) = 1.790e-04 S  per = 0.487  per(accum) = 4.63
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.657e-03 S  per = 4.51  per(accum) = 9.13
 T(sweep opt: hmmtasks init               ) = 1.582e-03 S  per =  4.3  per(accum) = 13.4
 T(sweep opt: initial guess for dvdson    ) = 1.271e-05 S  per = 0.0346  per(accum) = 13.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.914e-02 S  per = 79.3  per(accum) = 92.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.928e-04 S  per = 1.34  per(accum) = 94.1
 T(sweep opt: dvdson [nccl]               ) = 1.002e-03 S  per = 2.73  per(accum) = 96.8
 T(sweep opt: dvdson [mpi]                ) = 9.923e-06 S  per = 0.027  per(accum) = 96.9
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.157e-03 S  per = 3.15  per(accum) = 100
Detailed decomposition of T(renrm) = 6.440e-02 S  T(sum) = 6.440e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.774e-04 S  per = 0.275  per(accum) = 0.275
 T(sweep opt: qops init                    ) = 1.186e-03 S  per = 1.84  per(accum) = 2.12
 T(sweep opt: symbolic_formulae_renorm     ) = 2.205e-04 S  per = 0.342  per(accum) = 2.46
 T(sweep opt: allocate qops on gpu         ) = 2.087e-04 S  per = 0.324  per(accum) = 2.78
 T(sweep opt: site memcpy cpu2gpu          ) = 9.117e-05 S  per = 0.142  per(accum) = 2.92
 T(sweep opt: rintermediate init           ) = 2.013e-04 S  per = 0.313  per(accum) = 3.24
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.781e-04 S  per = 1.36  per(accum) = 4.6
 T(sweep opt: rmmtasks init                ) = 9.786e-04 S  per = 1.52  per(accum) = 6.12
 T(sweep opt: qops memset on cpu           ) = 1.290e-07 S  per = 0.0002  per(accum) = 6.12
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.319e-03 S  per = 5.15  per(accum) = 11.3
 T(sweep opt: deallocate cpu and gpu memory) = 1.108e-04 S  per = 0.172  per(accum) = 11.4
 T(sweep opt: construct opS [ifdists=true] ) = 5.422e-02 S  per = 84.2  per(accum) = 95.6
 T(sweep opt: reduction of opS & opH [nccl]) = 8.266e-05 S  per = 0.128  per(accum) = 95.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.212e-04 S  per = 0.344  per(accum) = 96.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.476e-04 S  per = 0.229  per(accum) = 96.3
 T(sweep opt: qops_pool join and erase     ) = 2.356e-03 S  per = 3.66  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 3.370e-06 S  per = 0.00523  per(accum) = 100
##### global opt: 1.275e-01 S #####
 T(global opt: fetch) = 1.400e-02 S  per =   11  per(accum) = 11
 T(global opt: hdiag) = 1.379e-03 S  per = 1.08  per(accum) = 12.1
 T(global opt: dvdsn) = 3.804e-02 S  per = 29.8  per(accum) = 41.9
 T(global opt: decim) = 2.246e-03 S  per = 1.76  per(accum) = 43.7
 T(global opt: guess) = 1.436e-04 S  per = 0.113  per(accum) = 43.8
 T(global opt: renrm) = 6.440e-02 S  per = 50.5  per(accum) = 94.3
 T(global opt: save ) = 7.295e-03 S  per = 5.72  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.804e-02 S  T(sum) = 3.675e-02 S  per = 9.661e+01
 T(global opt: preprocess                  ) = 2.152e-04 S  per = 0.586  per(accum) = 0.586
 T(global opt: symbolic_formulae           ) = 1.306e-03 S  per = 3.55  per(accum) = 4.14
 T(global opt: hintermediate init          ) = 1.790e-04 S  per = 0.487  per(accum) = 4.63
 T(global opt: preprocess_hformulae_Hxlist ) = 1.657e-03 S  per = 4.51  per(accum) = 9.13
 T(global opt: hmmtasks init               ) = 1.582e-03 S  per =  4.3  per(accum) = 13.4
 T(global opt: initial guess for dvdson    ) = 1.271e-05 S  per = 0.0346  per(accum) = 13.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.914e-02 S  per = 79.3  per(accum) = 92.8
 T(global opt: dvdson [cpu-gpu]            ) = 4.928e-04 S  per = 1.34  per(accum) = 94.1
 T(global opt: dvdson [nccl]               ) = 1.002e-03 S  per = 2.73  per(accum) = 96.8
 T(global opt: dvdson [mpi]                ) = 9.923e-06 S  per = 0.027  per(accum) = 96.9
 T(global opt: dvdson [rest part(linalg)]  ) = 1.157e-03 S  per = 3.15  per(accum) = 100
Detailed decomposition of T(renrm) = 6.440e-02 S  T(sum) = 6.440e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.774e-04 S  per = 0.275  per(accum) = 0.275
 T(global opt: qops init                    ) = 1.186e-03 S  per = 1.84  per(accum) = 2.12
 T(global opt: symbolic_formulae_renorm     ) = 2.205e-04 S  per = 0.342  per(accum) = 2.46
 T(global opt: allocate qops on gpu         ) = 2.087e-04 S  per = 0.324  per(accum) = 2.78
 T(global opt: site memcpy cpu2gpu          ) = 9.117e-05 S  per = 0.142  per(accum) = 2.92
 T(global opt: rintermediate init           ) = 2.013e-04 S  per = 0.313  per(accum) = 3.24
 T(global opt: preprocess_formulae_Rlist2   ) = 8.781e-04 S  per = 1.36  per(accum) = 4.6
 T(global opt: rmmtasks init                ) = 9.786e-04 S  per = 1.52  per(accum) = 6.12
 T(global opt: qops memset on cpu           ) = 1.290e-07 S  per = 0.0002  per(accum) = 6.12
 T(global opt: preprocess_renorm_batchGPU   ) = 3.319e-03 S  per = 5.15  per(accum) = 11.3
 T(global opt: deallocate cpu and gpu memory) = 1.108e-04 S  per = 0.172  per(accum) = 11.4
 T(global opt: construct opS [ifdists=true] ) = 5.422e-02 S  per = 84.2  per(accum) = 95.6
 T(global opt: reduction of opS & opH [nccl]) = 8.266e-05 S  per = 0.128  per(accum) = 95.8
 T(global opt: qops memcpy gpu2cpu          ) = 2.212e-04 S  per = 0.344  per(accum) = 96.1
 T(global opt: reduction of opS & opH [mpi] ) = 1.476e-04 S  per = 0.229  per(accum) = 96.3
 T(global opt: qops_pool join and erase     ) = 2.356e-03 S  per = 3.66  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 3.370e-06 S  per = 0.00523  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-6.469e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=4/seqsize=34 dots=1 dbond=(5,0)-(6,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=13 scratch=./scratch/sweep size=723:5.39e-06GB T(load)=3.25e-04S speed=1.66e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=1201:9.16e-03MB:8.95e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=478:3.65e-03MB:3.56e-06GB
total mem of comb=1827:1.39e-02MB:1.36e-05GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=1.150e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=5,14,1
 suppl= 0 1 2 3 4
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 16
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:10 S:15 H:1 A:22 B:28 
        dim(bra,ket)=27,27 size(op)=159:1.213e-03MB size(tot)=6004:4.581e-02MB:4.473e-05GB
        per(mem): C:12.5 S:31.5 H:2.65 A:10.2 B:43.2 
 rqops: oplist=CSHPQ nops=C:28 S:6 H:1 P:34 Q:38 
        dim(bra,ket)=38,38 size(op)=208:0.00159MB size(tot)=12413:0.0947MB:9.25e-05GB
        per(mem): C:29.3 S:7.54 H:1.68 P:15 Q:46.4 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=20753:0.158MB:0.000155GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.173e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(5,0) fdel=./scratch/sweep/rop(6,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-9.882e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(27,38,4) nnz=478:3.647e-03MB
qtensor3: wf3 own=1 _data=0x55b2c65e9000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=7 dimAll=27
 (8,2):8 (7,3):8 (6,4):4 (9,1):3 (6,2):2 (7,1):1 (5,5):1
 qbond: qcol nsym=10 dimAll=38
 (21,-1):8 (22,-2):8 (21,-3):6 (23,-3):4 (20,-2):3 (20,0):3 (23,-1):2 (22,-4):2 (22,0):1 (24,-4):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=22 nblocks=280 size=478:3.647e-03MB
### DIAG TIMING: total=6.419e-04 t1=1.603e-05, t2=1.256e-05, t3=1.485e-05, t4=5.406e-04, t5=1.091e-05, t6=3.865e-05, t7=8.334e-06
duration_diagGPU:6.627e-04
duration_diagreduce:6.500e-08
duration_diagtransform:6.600e-07
----- TIMING FOR symbolic_formulae_onedot with size=305 : 6.115e-04 S -----
rank=0 GPUmem(GB): used=1.546e-04 (oper)=1.546e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=305
 no. of hintermediate operators=140
 no. of coefficients=1960:1.495e-02MB:1.460e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.992e-05 S -----
rank=0 GPUmem(GB): used=1.692e-04 (oper,hinter)=1.546e-04,1.460e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.179e-03 S size(H_formulae)=305 size(Hxlst2)=22 T(Hmu/Hxlist)=1.198e-04,1.059e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.635e-03 S size(H_formulae)=305 size(Hxlst)=4660 -----
rank=0 GPUmem(GB): used=1.692e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=7.123e-06 batch[need]=6.701e-03 blksize=64 blksize0=64 batchsize=4660
rank=0 GPUmem(GB): used=6.877e-03 (oper,hinter,dvdson,batch)=1.546e-04,1.460e-05,7.123e-06,6.701e-03
ctns::pdvdsonSolver_nkr::solve_iter ndim=478 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.499e-05,1.197e-04,1.587e-03,2.862e-04,2.076e-03
 analyze_tgpu[Hx]: ndim=478:3.561e-06GB T(cpu-gpu)=2.267e-05 speed=3.143e-01GB/S T(nccl)=5.232e-05 speed=1.361e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=1.6e-03 t_reduction=2.9e-04 tot=2.0e-03 -----
 sigma[inter] counter=23 t=1.2e-04 per=6.0e+00 cost=1.3e+06 flops=1.1e+10
 sigma[gemm] counter=23 i=0 t=1.8e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=1 t=1.6e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=23 i=2 t=4.0e-04 per=2.0e+01 cost=5.0e+05 flops=1.3e+09
 sigma[gemm] counter=23 i=3 t=5.2e-04 per=2.6e+01 cost=4.9e+05 flops=9.5e+08
 sigma[gemm] counter=23 i=4 t=3.2e-04 per=1.6e+01 cost=5.8e+05 flops=1.8e+09
 sigma[gemm] counter=23 i=5 t=3.4e-04 per=1.7e+01 cost=5.8e+05 flops=1.7e+09
 sigma[gemm] counter=23 total t=1.6e-03 per=8.0e+01 cost=2.2e+06 flops=1.4e+09
 sigma[red] counter=23 t=2.9e-04 per=1.4e+01 cost=2.2e+05 flops=7.9e+08
----- TIMING FOR sigma_tot : t_inter=1.9e-03 t_gemm=2.1e-02 t_reduction=4.7e-03 tot=2.8e-02 -----
 sigma_tot[inter] counter=23 t=1.9e-03 per=6.7e+00 cost=4.3e+06 flops=2.3e+09
 sigma_tot[gemm] counter=23 i=0 t=5.3e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=1 t=4.8e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=23 i=2 t=5.4e-03 per=1.9e+01 cost=1.7e+06 flops=3.2e+08
 sigma_tot[gemm] counter=23 i=3 t=6.5e-03 per=2.3e+01 cost=1.7e+06 flops=2.6e+08
 sigma_tot[gemm] counter=23 i=4 t=4.6e-03 per=1.6e+01 cost=1.6e+06 flops=3.5e+08
 sigma_tot[gemm] counter=23 i=5 t=4.8e-03 per=1.7e+01 cost=1.7e+06 flops=3.5e+08
 sigma_tot[gemm] counter=23 total t=2.1e-02 per=7.6e+01 cost=6.7e+06 flops=3.1e+08
 sigma_tot[red] counter=23 t=4.7e-03 per=1.7e+01 cost=8.8e+05 flops=1.9e+08
T(sub)=8.5e-06 T(gemm/eig/ortho/gemm/axpy)=3.1e-06,2.8e-06,1.1e-06,1.2e-06,2.8e-07
settings: ndim=478 neig=1 maxcycle=30 nbuff=4 memory=5e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.471788147632 -1.116e+03  1.672e-02    1     1  2.350e-03 2.350e-03 2.319e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.922e-05,1.181e-04,2.019e-03,3.105e-04,2.522e-03
 analyze_tgpu[Hx]: ndim=478:3.561e-06GB T(cpu-gpu)=2.288e-05 speed=3.113e-01GB/S T(nccl)=4.634e-05 speed=1.537e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.0e-03 t_reduction=3.1e-04 tot=2.4e-03 -----
 sigma[inter] counter=24 t=1.2e-04 per=4.8e+00 cost=1.3e+06 flops=1.1e+10
 sigma[gemm] counter=24 i=0 t=1.9e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=1 t=1.9e-06 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=24 i=2 t=5.0e-04 per=2.0e+01 cost=5.0e+05 flops=1.0e+09
 sigma[gemm] counter=24 i=3 t=6.9e-04 per=2.8e+01 cost=4.9e+05 flops=7.2e+08
 sigma[gemm] counter=24 i=4 t=4.1e-04 per=1.7e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=24 i=5 t=4.2e-04 per=1.7e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=24 total t=2.0e-03 per=8.2e+01 cost=2.2e+06 flops=1.1e+09
 sigma[red] counter=24 t=3.1e-04 per=1.3e+01 cost=2.2e+05 flops=7.2e+08
----- TIMING FOR sigma_tot : t_inter=2.0e-03 t_gemm=2.3e-02 t_reduction=5.0e-03 tot=3.0e-02 -----
 sigma_tot[inter] counter=24 t=2.0e-03 per=6.5e+00 cost=5.6e+06 flops=2.8e+09
 sigma_tot[gemm] counter=24 i=0 t=5.5e-05 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=1 t=5.0e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=24 i=2 t=5.9e-03 per=1.9e+01 cost=2.2e+06 flops=3.7e+08
 sigma_tot[gemm] counter=24 i=3 t=7.2e-03 per=2.4e+01 cost=2.2e+06 flops=3.1e+08
 sigma_tot[gemm] counter=24 i=4 t=5.0e-03 per=1.6e+01 cost=2.2e+06 flops=4.4e+08
 sigma_tot[gemm] counter=24 i=5 t=5.2e-03 per=1.7e+01 cost=2.2e+06 flops=4.3e+08
 sigma_tot[gemm] counter=24 total t=2.3e-02 per=7.7e+01 cost=8.8e+06 flops=3.8e+08
 sigma_tot[red] counter=24 t=5.0e-03 per=1.7e+01 cost=1.1e+06 flops=2.2e+08
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=7.7e-06,1.0e-05,2.8e-06,1.8e-06,3.0e-07
    2   0 -    -116.472250342787 -4.622e-04  5.157e-03    2     2  5.210e-03 2.605e-03 2.548e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.955e-05,1.148e-04,1.976e-03,3.167e-04,2.481e-03
 analyze_tgpu[Hx]: ndim=478:3.561e-06GB T(cpu-gpu)=2.208e-05 speed=3.227e-01GB/S T(nccl)=4.747e-05 speed=1.500e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=2.0e-03 t_reduction=3.2e-04 tot=2.4e-03 -----
 sigma[inter] counter=25 t=1.1e-04 per=4.8e+00 cost=1.3e+06 flops=1.1e+10
 sigma[gemm] counter=25 i=0 t=1.9e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=1 t=2.0e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=25 i=2 t=4.9e-04 per=2.1e+01 cost=5.0e+05 flops=1.0e+09
 sigma[gemm] counter=25 i=3 t=6.6e-04 per=2.7e+01 cost=4.9e+05 flops=7.5e+08
 sigma[gemm] counter=25 i=4 t=4.1e-04 per=1.7e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=25 i=5 t=4.2e-04 per=1.7e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=25 total t=2.0e-03 per=8.2e+01 cost=2.2e+06 flops=1.1e+09
 sigma[red] counter=25 t=3.2e-04 per=1.3e+01 cost=2.2e+05 flops=7.1e+08
----- TIMING FOR sigma_tot : t_inter=2.1e-03 t_gemm=2.5e-02 t_reduction=5.3e-03 tot=3.3e-02 -----
 sigma_tot[inter] counter=25 t=2.1e-03 per=6.4e+00 cost=6.9e+06 flops=3.3e+09
 sigma_tot[gemm] counter=25 i=0 t=5.7e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=1 t=5.2e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=25 i=2 t=6.4e-03 per=1.9e+01 cost=2.7e+06 flops=4.2e+08
 sigma_tot[gemm] counter=25 i=3 t=7.9e-03 per=2.4e+01 cost=2.7e+06 flops=3.4e+08
 sigma_tot[gemm] counter=25 i=4 t=5.4e-03 per=1.6e+01 cost=2.8e+06 flops=5.1e+08
 sigma_tot[gemm] counter=25 i=5 t=5.6e-03 per=1.7e+01 cost=2.8e+06 flops=5.0e+08
 sigma_tot[gemm] counter=25 total t=2.5e-02 per=7.7e+01 cost=1.1e+07 flops=4.3e+08
 sigma_tot[red] counter=25 t=5.3e-03 per=1.6e+01 cost=1.3e+06 flops=2.5e+08
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.4e-05,2.1e-06,2.4e-06,2.8e-07
    3   0 -    -116.472292117614 -4.177e-05  2.266e-03    3     3  7.946e-03 2.649e-03 2.588e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.964e-05,1.236e-04,2.033e-03,3.081e-04,2.539e-03
 analyze_tgpu[Hx]: ndim=478:3.561e-06GB T(cpu-gpu)=2.276e-05 speed=3.130e-01GB/S T(nccl)=4.688e-05 speed=1.519e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.0e-03 t_reduction=3.1e-04 tot=2.5e-03 -----
 sigma[inter] counter=26 t=1.2e-04 per=5.0e+00 cost=1.3e+06 flops=1.1e+10
 sigma[gemm] counter=26 i=0 t=2.2e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=1 t=2.1e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=26 i=2 t=5.2e-04 per=2.1e+01 cost=5.0e+05 flops=9.7e+08
 sigma[gemm] counter=26 i=3 t=6.9e-04 per=2.8e+01 cost=4.9e+05 flops=7.1e+08
 sigma[gemm] counter=26 i=4 t=4.1e-04 per=1.7e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=26 i=5 t=4.1e-04 per=1.7e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=26 total t=2.0e-03 per=8.2e+01 cost=2.2e+06 flops=1.1e+09
 sigma[red] counter=26 t=3.1e-04 per=1.2e+01 cost=2.2e+05 flops=7.3e+08
----- TIMING FOR sigma_tot : t_inter=2.2e-03 t_gemm=2.7e-02 t_reduction=5.7e-03 tot=3.5e-02 -----
 sigma_tot[inter] counter=26 t=2.2e-03 per=6.3e+00 cost=8.2e+06 flops=3.7e+09
 sigma_tot[gemm] counter=26 i=0 t=5.9e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=1 t=5.4e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=26 i=2 t=6.9e-03 per=2.0e+01 cost=3.2e+06 flops=4.6e+08
 sigma_tot[gemm] counter=26 i=3 t=8.6e-03 per=2.4e+01 cost=3.2e+06 flops=3.7e+08
 sigma_tot[gemm] counter=26 i=4 t=5.8e-03 per=1.6e+01 cost=3.3e+06 flops=5.8e+08
 sigma_tot[gemm] counter=26 i=5 t=6.0e-03 per=1.7e+01 cost=3.4e+06 flops=5.7e+08
 sigma_tot[gemm] counter=26 total t=2.7e-02 per=7.8e+01 cost=1.3e+07 flops=4.8e+08
 sigma_tot[red] counter=26 t=5.7e-03 per=1.6e+01 cost=1.6e+06 flops=2.7e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=7.2e-06,1.3e-05,2.0e-06,2.3e-06,2.7e-07
    4   0 -    -116.472301020553 -8.903e-06  8.708e-04    3     4  1.073e-02 2.684e-03 2.624e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.883e-05,1.152e-04,1.948e-03,3.093e-04,2.446e-03
 analyze_tgpu[Hx]: ndim=478:3.561e-06GB T(cpu-gpu)=2.209e-05 speed=3.225e-01GB/S T(nccl)=4.675e-05 speed=1.524e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=1.9e-03 t_reduction=3.1e-04 tot=2.4e-03 -----
 sigma[inter] counter=27 t=1.2e-04 per=4.9e+00 cost=1.3e+06 flops=1.1e+10
 sigma[gemm] counter=27 i=0 t=2.0e-06 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=1 t=1.9e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=27 i=2 t=4.8e-04 per=2.0e+01 cost=5.0e+05 flops=1.1e+09
 sigma[gemm] counter=27 i=3 t=6.6e-04 per=2.8e+01 cost=4.9e+05 flops=7.5e+08
 sigma[gemm] counter=27 i=4 t=3.9e-04 per=1.7e+01 cost=5.8e+05 flops=1.5e+09
 sigma[gemm] counter=27 i=5 t=4.1e-04 per=1.7e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=27 total t=1.9e-03 per=8.2e+01 cost=2.2e+06 flops=1.1e+09
 sigma[red] counter=27 t=3.1e-04 per=1.3e+01 cost=2.2e+05 flops=7.3e+08
----- TIMING FOR sigma_tot : t_inter=2.3e-03 t_gemm=2.9e-02 t_reduction=6.0e-03 tot=3.8e-02 -----
 sigma_tot[inter] counter=27 t=2.3e-03 per=6.2e+00 cost=9.5e+06 flops=4.1e+09
 sigma_tot[gemm] counter=27 i=0 t=6.1e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=1 t=5.6e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=27 i=2 t=7.4e-03 per=2.0e+01 cost=3.7e+06 flops=5.0e+08
 sigma_tot[gemm] counter=27 i=3 t=9.2e-03 per=2.5e+01 cost=3.7e+06 flops=4.0e+08
 sigma_tot[gemm] counter=27 i=4 t=6.2e-03 per=1.6e+01 cost=3.9e+06 flops=6.3e+08
 sigma_tot[gemm] counter=27 i=5 t=6.4e-03 per=1.7e+01 cost=4.0e+06 flops=6.2e+08
 sigma_tot[gemm] counter=27 total t=2.9e-02 per=7.8e+01 cost=1.5e+07 flops=5.2e+08
 sigma_tot[red] counter=27 t=6.0e-03 per=1.6e+01 cost=1.8e+06 flops=3.0e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=7.2e-06,1.2e-05,2.0e-06,2.3e-06,2.9e-07
    5   0 -    -116.472302205819 -1.185e-06  2.513e-04    3     5  1.342e-02 2.684e-03 2.625e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.874e-05,1.119e-04,1.944e-03,3.125e-04,2.442e-03
 analyze_tgpu[Hx]: ndim=478:3.561e-06GB T(cpu-gpu)=2.261e-05 speed=3.150e-01GB/S T(nccl)=4.613e-05 speed=1.544e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.9e-03 t_reduction=3.1e-04 tot=2.4e-03 -----
 sigma[inter] counter=28 t=1.1e-04 per=4.7e+00 cost=1.3e+06 flops=1.2e+10
 sigma[gemm] counter=28 i=0 t=2.0e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=1 t=1.9e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=28 i=2 t=4.8e-04 per=2.0e+01 cost=5.0e+05 flops=1.0e+09
 sigma[gemm] counter=28 i=3 t=6.6e-04 per=2.8e+01 cost=4.9e+05 flops=7.5e+08
 sigma[gemm] counter=28 i=4 t=3.9e-04 per=1.7e+01 cost=5.8e+05 flops=1.5e+09
 sigma[gemm] counter=28 i=5 t=4.1e-04 per=1.7e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=28 total t=1.9e-03 per=8.2e+01 cost=2.2e+06 flops=1.1e+09
 sigma[red] counter=28 t=3.1e-04 per=1.3e+01 cost=2.2e+05 flops=7.2e+08
----- TIMING FOR sigma_tot : t_inter=2.4e-03 t_gemm=3.1e-02 t_reduction=6.3e-03 tot=4.0e-02 -----
 sigma_tot[inter] counter=28 t=2.4e-03 per=6.1e+00 cost=1.1e+07 flops=4.4e+09
 sigma_tot[gemm] counter=28 i=0 t=6.3e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=1 t=5.8e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=28 i=2 t=7.9e-03 per=2.0e+01 cost=4.2e+06 flops=5.4e+08
 sigma_tot[gemm] counter=28 i=3 t=9.9e-03 per=2.5e+01 cost=4.2e+06 flops=4.2e+08
 sigma_tot[gemm] counter=28 i=4 t=6.6e-03 per=1.6e+01 cost=4.5e+06 flops=6.8e+08
 sigma_tot[gemm] counter=28 i=5 t=6.8e-03 per=1.7e+01 cost=4.6e+06 flops=6.7e+08
 sigma_tot[gemm] counter=28 total t=3.1e-02 per=7.8e+01 cost=1.7e+07 flops=5.6e+08
 sigma_tot[red] counter=28 t=6.3e-03 per=1.6e+01 cost=2.0e+06 flops=3.2e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=6.9e-06,1.2e-05,2.0e-06,2.3e-06,3.0e-07
    6   0 +    -116.472302317891 -1.121e-07  7.497e-05    3     6  1.609e-02 2.682e-03 2.624e-03
TIMING FOR Davidson : 1.610e-02  T(cal/comm/rest)=1.575e-02,1.725e-06,3.541e-04
decomposed t_rest=3.541e-04
 T(sub)    =1.362e-04 per=3.847e+01
 T(precond)=2.045e-05 per=5.775e+00
 T(ortho)  =1.230e-05 per=3.475e+00
 T(xcopy)  =1.081e-06 per=3.053e-01
 T(xnrm2)  =2.144e-06 per=6.056e-01
 T(other)  =1.819e-04 per=5.137e+01
optimized energies: isweep=0 ibond=4 dots=1 e[0]=-116.472302317891 nmvp=6
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=4.807e-04 change=1.283e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=15 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond4.txt
 qbond: qsuper nsym=15 dimAll=108
 (8,2):19 (10,2):11 (9,3):16 (9,1):12 (7,3):14 (8,4):12 (6,4):5 (7,5):5 (11,1):3 (10,0):3 (6,2):2 (7,1):3 (8,0):1 (5,5):1 (6,6):1
timing for divide=2.7e-06
timing for compute=9.7e-05
timing for collect=5.3e-06
----- TMING FOR decimation_genbasis(nkr): 1.0e-04 S T(divide/compute[cpu/gpu/rest]/collect)=2.7e-06,9.5e-05,0.0e+00,2.1e-06,5.3e-06 -----
decimation summary: 108->38 dwt=+2.220e-16 SvN=1.421e+00
 qbond: qkept nsym=10 dimAll=38
 (8,2):8 (9,1):8 (9,3):6 (7,3):4 (10,2):3 (10,0):3 (8,4):2 (7,1):2 (6,4):1 (8,0):1
----- TIMING for decimation_row(nkr): 1.085e-03 S T(decim/select/formRot)=1.351e-04,9.334e-04,1.621e-05 -----
----- TIMING FOR onedot_decimation: 1.114e-03 S T(wf/decim)=2.174e-05,1.092e-03 -----
ctns::oper_renorm coord=(5,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:12 S:14 H:1 A:34 B:38 
        dim(bra,ket)=38,38 size(op)=208:1.587e-03MB size(tot)=11581:8.836e-02MB:8.629e-05GB
        per(mem): C:13.5 S:18.9 H:1.8 A:16.1 B:49.8 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=4.120e-04 change=1.890e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=85 : 9.090e-05 S -----
rank=0 GPUmem(GB): used=1.630e-04 (oper)=1.484e-04
rank=0 GPUmem(GB): used=1.666e-04 (oper,site)=1.484e-04,3.561e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=85
 no. of rintermediate operators=7
 no. of coefficients=85:6.485e-04MB:6.333e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.100e-05 S -----
rank=0 GPUmem(GB): used=1.672e-04 (oper,site,rinter)=1.484e-04,3.561e-06,6.333e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 3.582e-04 S size(rtasks)=85 size(Rlst2)=100 T(Rmu/Rlist)=5.111e-05,3.070e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.859e-04 S size(rtasks)=85 size(Rlst)=1051 -----
rank=0 GPUmem(GB): used=1.672e-04 avail=3.829e+01 total=3.829e+01 batch[need]=1.511e-03 blksize=64 blksize0=64 batchsize=1051
rank=0 GPUmem(GB): used=1.679e-03 (oper,site,rinter,batch)=1.484e-04,3.561e-06,6.333e-07,1.511e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.229e-04,1.014e-03,2.955e-04
----- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=1.0e-03 t_reduction=3.0e-04 tot=1.4e-03 -----
 renorm[inter] counter=137 t=1.2e-04 per=8.6e+00 cost=7.4e+04 flops=6.0e+08
 renorm[gemm] counter=137 i=0 t=2.0e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=137 i=1 t=1.9e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=137 i=2 t=1.9e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=137 i=3 t=1.9e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=137 i=4 t=2.7e-04 per=1.9e+01 cost=3.6e+04 flops=1.3e+08
 renorm[gemm] counter=137 i=5 t=3.8e-04 per=2.6e+01 cost=2.0e+05 flops=5.2e+08
 renorm[gemm] counter=137 i=6 t=3.6e-04 per=2.5e+01 cost=2.7e+05 flops=7.6e+08
 renorm[gemm] counter=137 total t=1.0e-03 per=7.1e+01 cost=5.1e+05 flops=5.0e+08
 renorm[red] counter=137 t=3.0e-04 per=2.1e+01 cost=5.4e+04 flops=1.8e+08
----- TIMING FOR renorm_tot : t_inter=4.2e-04 t_gemm=2.9e-03 t_reduction=9.7e-04 tot=4.3e-03 -----
 renorm_tot[inter] counter=137 t=4.2e-04 per=9.9e+00 cost=1.1e+05 flops=2.7e+08
 renorm_tot[gemm] counter=137 i=0 t=1.1e-05 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=137 i=1 t=9.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=137 i=2 t=9.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=137 i=3 t=9.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=137 i=4 t=8.1e-04 per=1.9e+01 cost=6.2e+04 flops=7.7e+07
 renorm_tot[gemm] counter=137 i=5 t=1.0e-03 per=2.4e+01 cost=2.8e+05 flops=2.8e+08
 renorm_tot[gemm] counter=137 i=6 t=1.0e-03 per=2.4e+01 cost=5.3e+05 flops=5.3e+08
 renorm_tot[gemm] counter=137 total t=2.9e-03 per=6.7e+01 cost=8.8e+05 flops=3.1e+08
 renorm_tot[red] counter=137 t=9.7e-04 per=2.3e+01 cost=1.5e+05 flops=1.6e+08
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.794e-04 (oper)=1.496e-04
rank=0 GPUmem(GB): used=1.830e-04 (oper,site,rinter)=1.496e-04,3.561e-06,1.460e-05
rank=0 GPUmem(GB): used=2.923e-04 (oper,site,rinter,batch)=1.496e-04,3.561e-06,1.460e-05,1.093e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.729e-02 S T(preprocess/alloc/comp/red/dealloc)=2.191e-03,2.289e-03,1.331e-02,1.450e-03,1.931e-04 -----
----- TIMING FOR oper_renorm_opS : 1.735e-02 S rank=0 -----
qops.to_cpu: size(tot)=11581:8.836e-02MB:8.629e-05GB T(to_cpu)=5.235e-05S speed=1.648e+00GB/S
check ||H-H.dagger||=1.135e-14 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.0206 S rank=0 -----
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=7.706e-04 change=3.673e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=1.717e-03 change=-1.480e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=1.717e-03 change=-6.005e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 4.874e-02 S #####
 T(local opt: fetch) = 2.791e-03 S  per = 5.73  per(accum) = 5.73
 T(local opt: hdiag) = 7.274e-04 S  per = 1.49  per(accum) = 7.22
 T(local opt: dvdsn) = 2.095e-02 S  per =   43  per(accum) = 50.2
 T(local opt: decim) = 1.140e-03 S  per = 2.34  per(accum) = 52.5
 T(local opt: guess) = 4.988e-05 S  per = 0.102  per(accum) = 52.6
 T(local opt: renrm) = 2.116e-02 S  per = 43.4  per(accum) = 96
 T(local opt: save ) = 1.928e-03 S  per = 3.96  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.095e-02 S  T(sum) = 2.041e-02 S  per = 9.746e+01
 T(local opt: preprocess                  ) = 6.317e-05 S  per = 0.309  per(accum) = 0.309
 T(local opt: symbolic_formulae           ) = 6.228e-04 S  per = 3.05  per(accum) = 3.36
 T(local opt: hintermediate init          ) = 6.599e-05 S  per = 0.323  per(accum) = 3.68
 T(local opt: preprocess_hformulae_Hxlist ) = 1.751e-03 S  per = 8.58  per(accum) = 12.3
 T(local opt: hmmtasks init               ) = 1.807e-03 S  per = 8.85  per(accum) = 21.1
 T(local opt: initial guess for dvdson    ) = 3.046e-06 S  per = 0.0149  per(accum) = 21.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.532e-02 S  per = 75.1  per(accum) = 96.2
 T(local opt: dvdson [cpu-gpu]            ) = 1.351e-04 S  per = 0.662  per(accum) = 96.9
 T(local opt: dvdson [nccl]               ) = 2.859e-04 S  per =  1.4  per(accum) = 98.3
 T(local opt: dvdson [mpi]                ) = 1.725e-06 S  per = 0.00845  per(accum) = 98.3
 T(local opt: dvdson [rest part(linalg)]  ) = 3.541e-04 S  per = 1.73  per(accum) = 100
Detailed decomposition of T(renrm) = 2.116e-02 S  T(sum) = 2.116e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.300e-05 S  per = 0.203  per(accum) = 0.203
 T(local opt: qops init                    ) = 3.816e-04 S  per =  1.8  per(accum) = 2.01
 T(local opt: symbolic_formulae_renorm     ) = 9.503e-05 S  per = 0.449  per(accum) = 2.46
 T(local opt: allocate qops on gpu         ) = 5.098e-05 S  per = 0.241  per(accum) = 2.7
 T(local opt: site memcpy cpu2gpu          ) = 2.002e-05 S  per = 0.0946  per(accum) = 2.79
 T(local opt: rintermediate init           ) = 2.773e-05 S  per = 0.131  per(accum) = 2.92
 T(local opt: preprocess_formulae_Rlist2   ) = 4.930e-04 S  per = 2.33  per(accum) = 5.25
 T(local opt: rmmtasks init                ) = 4.071e-04 S  per = 1.92  per(accum) = 7.18
 T(local opt: qops memset on cpu           ) = 2.800e-08 S  per = 0.000132  per(accum) = 7.18
 T(local opt: preprocess_renorm_batchGPU   ) = 1.519e-03 S  per = 7.18  per(accum) = 14.4
 T(local opt: deallocate cpu and gpu memory) = 3.741e-05 S  per = 0.177  per(accum) = 14.5
 T(local opt: construct opS [ifdists=true] ) = 1.739e-02 S  per = 82.2  per(accum) = 96.7
 T(local opt: reduction of opS & opH [nccl]) = 2.254e-05 S  per = 0.107  per(accum) = 96.8
 T(local opt: qops memcpy gpu2cpu          ) = 6.317e-05 S  per = 0.299  per(accum) = 97.1
 T(local opt: reduction of opS & opH [mpi] ) = 4.518e-05 S  per = 0.214  per(accum) = 97.3
 T(local opt: qops_pool join and erase     ) = 5.638e-04 S  per = 2.66  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.820e-07 S  per = 0.00417  per(accum) = 100
ctns::rcanon_save_site idx=14 scratch=./scratch/sweep size=478:3.6e-06GB T(load)=0.00052S speed=0.0068GB/S
##### sweep opt: 1.762e-01 S #####
 T(sweep opt: fetch) = 1.679e-02 S  per = 9.53  per(accum) = 9.53
 T(sweep opt: hdiag) = 2.106e-03 S  per = 1.19  per(accum) = 10.7
 T(sweep opt: dvdsn) = 5.899e-02 S  per = 33.5  per(accum) = 44.2
 T(sweep opt: decim) = 3.385e-03 S  per = 1.92  per(accum) = 46.1
 T(sweep opt: guess) = 1.935e-04 S  per = 0.11  per(accum) = 46.2
 T(sweep opt: renrm) = 8.556e-02 S  per = 48.5  per(accum) = 94.8
 T(sweep opt: save ) = 9.223e-03 S  per = 5.23  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.899e-02 S  T(sum) = 5.716e-02 S  per = 9.691e+01
 T(sweep opt: preprocess                  ) = 2.784e-04 S  per = 0.487  per(accum) = 0.487
 T(sweep opt: symbolic_formulae           ) = 1.929e-03 S  per = 3.37  per(accum) = 3.86
 T(sweep opt: hintermediate init          ) = 2.450e-04 S  per = 0.429  per(accum) = 4.29
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.408e-03 S  per = 5.96  per(accum) = 10.3
 T(sweep opt: hmmtasks init               ) = 3.389e-03 S  per = 5.93  per(accum) = 16.2
 T(sweep opt: initial guess for dvdson    ) = 1.575e-05 S  per = 0.0276  per(accum) = 16.2
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.446e-02 S  per = 77.8  per(accum) = 94
 T(sweep opt: dvdson [cpu-gpu]            ) = 6.279e-04 S  per =  1.1  per(accum) = 95.1
 T(sweep opt: dvdson [nccl]               ) = 1.288e-03 S  per = 2.25  per(accum) = 97.3
 T(sweep opt: dvdson [mpi]                ) = 1.165e-05 S  per = 0.0204  per(accum) = 97.4
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.511e-03 S  per = 2.64  per(accum) = 100
Detailed decomposition of T(renrm) = 8.556e-02 S  T(sum) = 8.556e-02 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.204e-04 S  per = 0.258  per(accum) = 0.258
 T(sweep opt: qops init                    ) = 1.567e-03 S  per = 1.83  per(accum) = 2.09
 T(sweep opt: symbolic_formulae_renorm     ) = 3.155e-04 S  per = 0.369  per(accum) = 2.46
 T(sweep opt: allocate qops on gpu         ) = 2.596e-04 S  per = 0.303  per(accum) = 2.76
 T(sweep opt: site memcpy cpu2gpu          ) = 1.112e-04 S  per = 0.13  per(accum) = 2.89
 T(sweep opt: rintermediate init           ) = 2.290e-04 S  per = 0.268  per(accum) = 3.16
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.371e-03 S  per =  1.6  per(accum) = 4.76
 T(sweep opt: rmmtasks init                ) = 1.386e-03 S  per = 1.62  per(accum) = 6.38
 T(sweep opt: qops memset on cpu           ) = 1.570e-07 S  per = 0.000184  per(accum) = 6.38
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.838e-03 S  per = 5.65  per(accum) = 12
 T(sweep opt: deallocate cpu and gpu memory) = 1.482e-04 S  per = 0.173  per(accum) = 12.2
 T(sweep opt: construct opS [ifdists=true] ) = 7.161e-02 S  per = 83.7  per(accum) = 95.9
 T(sweep opt: reduction of opS & opH [nccl]) = 1.052e-04 S  per = 0.123  per(accum) = 96
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.844e-04 S  per = 0.332  per(accum) = 96.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 1.927e-04 S  per = 0.225  per(accum) = 96.6
 T(sweep opt: qops_pool join and erase     ) = 2.919e-03 S  per = 3.41  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 4.252e-06 S  per = 0.00497  per(accum) = 100
##### global opt: 1.762e-01 S #####
 T(global opt: fetch) = 1.679e-02 S  per = 9.53  per(accum) = 9.53
 T(global opt: hdiag) = 2.106e-03 S  per = 1.19  per(accum) = 10.7
 T(global opt: dvdsn) = 5.899e-02 S  per = 33.5  per(accum) = 44.2
 T(global opt: decim) = 3.385e-03 S  per = 1.92  per(accum) = 46.1
 T(global opt: guess) = 1.935e-04 S  per = 0.11  per(accum) = 46.2
 T(global opt: renrm) = 8.556e-02 S  per = 48.5  per(accum) = 94.8
 T(global opt: save ) = 9.223e-03 S  per = 5.23  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.899e-02 S  T(sum) = 5.716e-02 S  per = 9.691e+01
 T(global opt: preprocess                  ) = 2.784e-04 S  per = 0.487  per(accum) = 0.487
 T(global opt: symbolic_formulae           ) = 1.929e-03 S  per = 3.37  per(accum) = 3.86
 T(global opt: hintermediate init          ) = 2.450e-04 S  per = 0.429  per(accum) = 4.29
 T(global opt: preprocess_hformulae_Hxlist ) = 3.408e-03 S  per = 5.96  per(accum) = 10.3
 T(global opt: hmmtasks init               ) = 3.389e-03 S  per = 5.93  per(accum) = 16.2
 T(global opt: initial guess for dvdson    ) = 1.575e-05 S  per = 0.0276  per(accum) = 16.2
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.446e-02 S  per = 77.8  per(accum) = 94
 T(global opt: dvdson [cpu-gpu]            ) = 6.279e-04 S  per =  1.1  per(accum) = 95.1
 T(global opt: dvdson [nccl]               ) = 1.288e-03 S  per = 2.25  per(accum) = 97.3
 T(global opt: dvdson [mpi]                ) = 1.165e-05 S  per = 0.0204  per(accum) = 97.4
 T(global opt: dvdson [rest part(linalg)]  ) = 1.511e-03 S  per = 2.64  per(accum) = 100
Detailed decomposition of T(renrm) = 8.556e-02 S  T(sum) = 8.556e-02 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.204e-04 S  per = 0.258  per(accum) = 0.258
 T(global opt: qops init                    ) = 1.567e-03 S  per = 1.83  per(accum) = 2.09
 T(global opt: symbolic_formulae_renorm     ) = 3.155e-04 S  per = 0.369  per(accum) = 2.46
 T(global opt: allocate qops on gpu         ) = 2.596e-04 S  per = 0.303  per(accum) = 2.76
 T(global opt: site memcpy cpu2gpu          ) = 1.112e-04 S  per = 0.13  per(accum) = 2.89
 T(global opt: rintermediate init           ) = 2.290e-04 S  per = 0.268  per(accum) = 3.16
 T(global opt: preprocess_formulae_Rlist2   ) = 1.371e-03 S  per =  1.6  per(accum) = 4.76
 T(global opt: rmmtasks init                ) = 1.386e-03 S  per = 1.62  per(accum) = 6.38
 T(global opt: qops memset on cpu           ) = 1.570e-07 S  per = 0.000184  per(accum) = 6.38
 T(global opt: preprocess_renorm_batchGPU   ) = 4.838e-03 S  per = 5.65  per(accum) = 12
 T(global opt: deallocate cpu and gpu memory) = 1.482e-04 S  per = 0.173  per(accum) = 12.2
 T(global opt: construct opS [ifdists=true] ) = 7.161e-02 S  per = 83.7  per(accum) = 95.9
 T(global opt: reduction of opS & opH [nccl]) = 1.052e-04 S  per = 0.123  per(accum) = 96
 T(global opt: qops memcpy gpu2cpu          ) = 2.844e-04 S  per = 0.332  per(accum) = 96.4
 T(global opt: reduction of opS & opH [mpi] ) = 1.927e-04 S  per = 0.225  per(accum) = 96.6
 T(global opt: qops_pool join and erase     ) = 2.919e-03 S  per = 3.41  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 4.252e-06 S  per = 0.00497  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.287e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=5/seqsize=34 dots=1 dbond=(6,0)-(7,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=12 scratch=./scratch/sweep size=981:7.31e-06GB T(load)=3.28e-04S speed=2.23e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=1704:1.30e-02MB:1.27e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=723:5.52e-03MB:5.39e-06GB
total mem of comb=2575:1.96e-02MB:1.92e-05GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=1.438e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=6,13,1
 suppl= 0 1 2 3 4 16
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 17
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:12 S:14 H:1 A:34 B:38 
        dim(bra,ket)=38,38 size(op)=208:1.587e-03MB size(tot)=11581:8.836e-02MB:8.629e-05GB
        per(mem): C:13.5 S:18.9 H:1.8 A:16.1 B:49.8 
 rqops: oplist=CSHPQ nops=C:26 S:7 H:1 P:45 Q:53 
        dim(bra,ket)=47,47 size(op)=293:0.00224MB size(tot)=22566:0.172MB:0.000168GB
        per(mem): C:22.2 S:6.7 H:1.3 P:17.5 Q:52.3 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=36483:0.278MB:0.000272GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.326e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(6,0) fdel=./scratch/sweep/rop(7,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-1.751e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(38,47,4) nnz=723:5.516e-03MB
qtensor3: wf3 own=1 _data=0x55b2c5ad6800
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=10 dimAll=38
 (8,2):8 (9,1):8 (9,3):6 (7,3):4 (10,2):3 (10,0):3 (8,4):2 (7,1):2 (6,4):1 (8,0):1
 qbond: qcol nsym=11 dimAll=47
 (20,-2):9 (20,0):8 (21,-1):8 (19,-1):6 (21,-3):4 (22,-2):4 (19,1):3 (22,0):2 (19,-3):1 (21,1):1 (23,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=29 nblocks=440 size=723:5.516e-03MB
### DIAG TIMING: total=8.780e-04 t1=1.925e-05, t2=1.226e-05, t3=1.288e-05, t4=7.753e-04, t5=1.040e-05, t6=3.938e-05, t7=8.471e-06
duration_diagGPU:8.854e-04
duration_diagreduce:5.000e-08
duration_diagtransform:1.070e-06
----- TIMING FOR symbolic_formulae_onedot with size=405 : 8.086e-04 S -----
rank=0 GPUmem(GB): used=2.718e-04 (oper)=2.718e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=405
 no. of hintermediate operators=192
 no. of coefficients=2496:1.904e-02MB:1.860e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.726e-05 S -----
rank=0 GPUmem(GB): used=2.904e-04 (oper,hinter)=2.718e-04,1.860e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.423e-03 S size(H_formulae)=405 size(Hxlst2)=29 T(Hmu/Hxlist)=1.694e-04,2.253e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.998e-03 S size(H_formulae)=405 size(Hxlst)=8480 -----
rank=0 GPUmem(GB): used=2.904e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.077e-05 batch[need]=1.371e-02 blksize=72 blksize0=72 batchsize=8480
rank=0 GPUmem(GB): used=1.401e-02 (oper,hinter,dvdson,batch)=2.718e-04,1.860e-05,1.077e-05,1.371e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=723 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.395e-05,1.481e-04,2.197e-03,3.754e-04,2.807e-03
 analyze_tgpu[Hx]: ndim=723:5.387e-06GB T(cpu-gpu)=2.390e-05 speed=4.508e-01GB/S T(nccl)=5.005e-05 speed=2.152e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=2.2e-03 t_reduction=3.8e-04 tot=2.7e-03 -----
 sigma[inter] counter=29 t=1.5e-04 per=5.4e+00 cost=3.0e+06 flops=2.1e+10
 sigma[gemm] counter=29 i=0 t=2.0e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=1 t=1.7e-06 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=29 i=2 t=6.0e-04 per=2.2e+01 cost=1.2e+06 flops=2.0e+09
 sigma[gemm] counter=29 i=3 t=6.7e-04 per=2.5e+01 cost=1.2e+06 flops=1.8e+09
 sigma[gemm] counter=29 i=4 t=4.5e-04 per=1.7e+01 cost=1.2e+06 flops=2.7e+09
 sigma[gemm] counter=29 i=5 t=4.7e-04 per=1.7e+01 cost=1.2e+06 flops=2.6e+09
 sigma[gemm] counter=29 total t=2.2e-03 per=8.1e+01 cost=4.9e+06 flops=2.2e+09
 sigma[red] counter=29 t=3.8e-04 per=1.4e+01 cost=4.8e+05 flops=1.3e+09
----- TIMING FOR sigma_tot : t_inter=2.6e-03 t_gemm=3.3e-02 t_reduction=6.7e-03 tot=4.3e-02 -----
 sigma_tot[inter] counter=29 t=2.6e-03 per=6.1e+00 cost=1.4e+07 flops=5.3e+09
 sigma_tot[gemm] counter=29 i=0 t=6.5e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=1 t=6.0e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=29 i=2 t=8.5e-03 per=2.0e+01 cost=5.4e+06 flops=6.4e+08
 sigma_tot[gemm] counter=29 i=3 t=1.1e-02 per=2.5e+01 cost=5.4e+06 flops=5.1e+08
 sigma_tot[gemm] counter=29 i=4 t=7.0e-03 per=1.6e+01 cost=5.7e+06 flops=8.1e+08
 sigma_tot[gemm] counter=29 i=5 t=7.3e-03 per=1.7e+01 cost=5.8e+06 flops=8.0e+08
 sigma_tot[gemm] counter=29 total t=3.3e-02 per=7.8e+01 cost=2.2e+07 flops=6.7e+08
 sigma_tot[red] counter=29 t=6.7e-03 per=1.6e+01 cost=2.5e+06 flops=3.7e+08
T(sub)=1.4e-05 T(gemm/eig/ortho/gemm/axpy)=6.2e-06,4.3e-06,1.1e-06,2.4e-06,3.6e-07
settings: ndim=723 neig=1 maxcycle=30 nbuff=4 memory=8e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.472302317891 -1.116e+03  1.824e-02    1     1  2.905e-03 2.905e-03 2.872e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.069e-05,1.434e-04,2.711e-03,4.078e-04,3.339e-03
 analyze_tgpu[Hx]: ndim=723:5.387e-06GB T(cpu-gpu)=2.444e-05 speed=4.409e-01GB/S T(nccl)=4.626e-05 speed=2.329e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=2.7e-03 t_reduction=4.1e-04 tot=3.3e-03 -----
 sigma[inter] counter=30 t=1.4e-04 per=4.4e+00 cost=3.0e+06 flops=2.1e+10
 sigma[gemm] counter=30 i=0 t=2.0e-06 per=6.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=1 t=1.9e-06 per=5.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=30 i=2 t=6.9e-04 per=2.1e+01 cost=1.2e+06 flops=1.8e+09
 sigma[gemm] counter=30 i=3 t=8.6e-04 per=2.6e+01 cost=1.2e+06 flops=1.4e+09
 sigma[gemm] counter=30 i=4 t=5.6e-04 per=1.7e+01 cost=1.2e+06 flops=2.2e+09
 sigma[gemm] counter=30 i=5 t=6.0e-04 per=1.8e+01 cost=1.2e+06 flops=2.1e+09
 sigma[gemm] counter=30 total t=2.7e-03 per=8.3e+01 cost=4.9e+06 flops=1.8e+09
 sigma[red] counter=30 t=4.1e-04 per=1.2e+01 cost=4.8e+05 flops=1.2e+09
----- TIMING FOR sigma_tot : t_inter=2.7e-03 t_gemm=3.6e-02 t_reduction=7.1e-03 tot=4.6e-02 -----
 sigma_tot[inter] counter=30 t=2.7e-03 per=6.0e+00 cost=1.7e+07 flops=6.2e+09
 sigma_tot[gemm] counter=30 i=0 t=6.7e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=1 t=6.2e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=30 i=2 t=9.1e-03 per=2.0e+01 cost=6.6e+06 flops=7.3e+08
 sigma_tot[gemm] counter=30 i=3 t=1.1e-02 per=2.5e+01 cost=6.6e+06 flops=5.8e+08
 sigma_tot[gemm] counter=30 i=4 t=7.6e-03 per=1.6e+01 cost=6.9e+06 flops=9.1e+08
 sigma_tot[gemm] counter=30 i=5 t=7.9e-03 per=1.7e+01 cost=7.1e+06 flops=8.9e+08
 sigma_tot[gemm] counter=30 total t=3.6e-02 per=7.9e+01 cost=2.7e+07 flops=7.5e+08
 sigma_tot[red] counter=30 t=7.1e-03 per=1.5e+01 cost=3.0e+06 flops=4.2e+08
T(sub)=3.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.7e-05,3.0e-06,3.0e-06,3.9e-07
    2   0 -    -116.472847467251 -5.451e-04  5.309e-03    2     2  6.417e-03 3.208e-03 3.151e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.875e-05,1.385e-04,2.756e-03,4.073e-04,3.377e-03
 analyze_tgpu[Hx]: ndim=723:5.387e-06GB T(cpu-gpu)=2.344e-05 speed=4.597e-01GB/S T(nccl)=4.531e-05 speed=2.378e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=2.8e-03 t_reduction=4.1e-04 tot=3.3e-03 -----
 sigma[inter] counter=31 t=1.4e-04 per=4.2e+00 cost=3.0e+06 flops=2.2e+10
 sigma[gemm] counter=31 i=0 t=2.1e-06 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=1 t=1.9e-06 per=5.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=31 i=2 t=6.8e-04 per=2.1e+01 cost=1.2e+06 flops=1.8e+09
 sigma[gemm] counter=31 i=3 t=8.7e-04 per=2.6e+01 cost=1.2e+06 flops=1.4e+09
 sigma[gemm] counter=31 i=4 t=5.7e-04 per=1.7e+01 cost=1.2e+06 flops=2.1e+09
 sigma[gemm] counter=31 i=5 t=6.4e-04 per=1.9e+01 cost=1.2e+06 flops=1.9e+09
 sigma[gemm] counter=31 total t=2.8e-03 per=8.3e+01 cost=4.9e+06 flops=1.8e+09
 sigma[red] counter=31 t=4.1e-04 per=1.2e+01 cost=4.8e+05 flops=1.2e+09
----- TIMING FOR sigma_tot : t_inter=2.9e-03 t_gemm=3.9e-02 t_reduction=7.5e-03 tot=4.9e-02 -----
 sigma_tot[inter] counter=31 t=2.9e-03 per=5.8e+00 cost=2.0e+07 flops=6.9e+09
 sigma_tot[gemm] counter=31 i=0 t=6.9e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=1 t=6.3e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=31 i=2 t=9.8e-03 per=2.0e+01 cost=7.9e+06 flops=8.0e+08
 sigma_tot[gemm] counter=31 i=3 t=1.2e-02 per=2.5e+01 cost=7.8e+06 flops=6.4e+08
 sigma_tot[gemm] counter=31 i=4 t=8.1e-03 per=1.7e+01 cost=8.1e+06 flops=1.0e+09
 sigma_tot[gemm] counter=31 i=5 t=8.5e-03 per=1.7e+01 cost=8.3e+06 flops=9.7e+08
 sigma_tot[gemm] counter=31 total t=3.9e-02 per=7.9e+01 cost=3.2e+07 flops=8.2e+08
 sigma_tot[red] counter=31 t=7.5e-03 per=1.5e+01 cost=3.4e+06 flops=4.6e+08
T(sub)=3.3e-05 T(gemm/eig/ortho/gemm/axpy)=9.6e-06,1.7e-05,2.4e-06,4.2e-06,3.7e-07
    3   0 -    -116.472895976776 -4.851e-05  2.113e-03    3     3  9.948e-03 3.316e-03 3.256e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.894e-05,1.384e-04,2.690e-03,4.049e-04,3.309e-03
 analyze_tgpu[Hx]: ndim=723:5.387e-06GB T(cpu-gpu)=2.354e-05 speed=4.577e-01GB/S T(nccl)=4.540e-05 speed=2.373e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=2.7e-03 t_reduction=4.0e-04 tot=3.2e-03 -----
 sigma[inter] counter=32 t=1.4e-04 per=4.3e+00 cost=3.0e+06 flops=2.2e+10
 sigma[gemm] counter=32 i=0 t=2.0e-06 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=1 t=1.9e-06 per=5.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=32 i=2 t=6.8e-04 per=2.1e+01 cost=1.2e+06 flops=1.8e+09
 sigma[gemm] counter=32 i=3 t=8.5e-04 per=2.6e+01 cost=1.2e+06 flops=1.4e+09
 sigma[gemm] counter=32 i=4 t=5.5e-04 per=1.7e+01 cost=1.2e+06 flops=2.2e+09
 sigma[gemm] counter=32 i=5 t=6.0e-04 per=1.8e+01 cost=1.2e+06 flops=2.1e+09
 sigma[gemm] counter=32 total t=2.7e-03 per=8.3e+01 cost=4.9e+06 flops=1.8e+09
 sigma[red] counter=32 t=4.0e-04 per=1.3e+01 cost=4.8e+05 flops=1.2e+09
----- TIMING FOR sigma_tot : t_inter=3.0e-03 t_gemm=4.2e-02 t_reduction=7.9e-03 tot=5.3e-02 -----
 sigma_tot[inter] counter=32 t=3.0e-03 per=5.7e+00 cost=2.3e+07 flops=7.6e+09
 sigma_tot[gemm] counter=32 i=0 t=7.1e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=1 t=6.5e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=32 i=2 t=1.1e-02 per=2.0e+01 cost=9.1e+06 flops=8.6e+08
 sigma_tot[gemm] counter=32 i=3 t=1.3e-02 per=2.5e+01 cost=9.0e+06 flops=6.9e+08
 sigma_tot[gemm] counter=32 i=4 t=8.7e-03 per=1.7e+01 cost=9.3e+06 flops=1.1e+09
 sigma_tot[gemm] counter=32 i=5 t=9.1e-03 per=1.7e+01 cost=9.5e+06 flops=1.0e+09
 sigma_tot[gemm] counter=32 total t=4.2e-02 per=7.9e+01 cost=3.7e+07 flops=8.9e+08
 sigma_tot[red] counter=32 t=7.9e-03 per=1.5e+01 cost=3.9e+06 flops=5.0e+08
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.0e-05,1.4e-05,2.1e-06,3.9e-06,3.6e-07
    4   0 -    -116.472904145427 -8.169e-06  8.780e-04    3     4  1.349e-02 3.372e-03 3.313e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.973e-05,1.462e-04,2.682e-03,4.060e-04,3.310e-03
 analyze_tgpu[Hx]: ndim=723:5.387e-06GB T(cpu-gpu)=2.401e-05 speed=4.487e-01GB/S T(nccl)=4.572e-05 speed=2.356e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=2.7e-03 t_reduction=4.1e-04 tot=3.2e-03 -----
 sigma[inter] counter=33 t=1.5e-04 per=4.5e+00 cost=3.0e+06 flops=2.1e+10
 sigma[gemm] counter=33 i=0 t=2.0e-06 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=1 t=1.9e-06 per=6.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=33 i=2 t=6.8e-04 per=2.1e+01 cost=1.2e+06 flops=1.8e+09
 sigma[gemm] counter=33 i=3 t=8.5e-04 per=2.6e+01 cost=1.2e+06 flops=1.4e+09
 sigma[gemm] counter=33 i=4 t=5.6e-04 per=1.7e+01 cost=1.2e+06 flops=2.2e+09
 sigma[gemm] counter=33 i=5 t=5.9e-04 per=1.8e+01 cost=1.2e+06 flops=2.1e+09
 sigma[gemm] counter=33 total t=2.7e-03 per=8.3e+01 cost=4.9e+06 flops=1.8e+09
 sigma[red] counter=33 t=4.1e-04 per=1.3e+01 cost=4.8e+05 flops=1.2e+09
----- TIMING FOR sigma_tot : t_inter=3.2e-03 t_gemm=4.4e-02 t_reduction=8.3e-03 tot=5.6e-02 -----
 sigma_tot[inter] counter=33 t=3.2e-03 per=5.7e+00 cost=2.6e+07 flops=8.2e+09
 sigma_tot[gemm] counter=33 i=0 t=7.3e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=1 t=6.7e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=33 i=2 t=1.1e-02 per=2.0e+01 cost=1.0e+07 flops=9.2e+08
 sigma_tot[gemm] counter=33 i=3 t=1.4e-02 per=2.5e+01 cost=1.0e+07 flops=7.3e+08
 sigma_tot[gemm] counter=33 i=4 t=9.3e-03 per=1.7e+01 cost=1.1e+07 flops=1.1e+09
 sigma_tot[gemm] counter=33 i=5 t=9.7e-03 per=1.7e+01 cost=1.1e+07 flops=1.1e+09
 sigma_tot[gemm] counter=33 total t=4.4e-02 per=7.9e+01 cost=4.2e+07 flops=9.5e+08
 sigma_tot[red] counter=33 t=8.3e-03 per=1.5e+01 cost=4.4e+06 flops=5.3e+08
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=8.8e-06,1.3e-05,2.1e-06,3.4e-06,3.7e-07
    5   0 -    -116.472905534313 -1.389e-06  3.140e-04    3     5  1.694e-02 3.388e-03 3.331e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.836e-05,1.350e-04,2.695e-03,3.994e-04,3.303e-03
 analyze_tgpu[Hx]: ndim=723:5.387e-06GB T(cpu-gpu)=2.303e-05 speed=4.679e-01GB/S T(nccl)=4.533e-05 speed=2.377e-01GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=2.7e-03 t_reduction=4.0e-04 tot=3.2e-03 -----
 sigma[inter] counter=34 t=1.3e-04 per=4.2e+00 cost=3.0e+06 flops=2.3e+10
 sigma[gemm] counter=34 i=0 t=2.0e-06 per=6.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=1 t=1.9e-06 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=34 i=2 t=6.9e-04 per=2.1e+01 cost=1.2e+06 flops=1.8e+09
 sigma[gemm] counter=34 i=3 t=8.5e-04 per=2.6e+01 cost=1.2e+06 flops=1.4e+09
 sigma[gemm] counter=34 i=4 t=5.5e-04 per=1.7e+01 cost=1.2e+06 flops=2.2e+09
 sigma[gemm] counter=34 i=5 t=6.0e-04 per=1.9e+01 cost=1.2e+06 flops=2.1e+09
 sigma[gemm] counter=34 total t=2.7e-03 per=8.3e+01 cost=4.9e+06 flops=1.8e+09
 sigma[red] counter=34 t=4.0e-04 per=1.2e+01 cost=4.8e+05 flops=1.2e+09
----- TIMING FOR sigma_tot : t_inter=3.3e-03 t_gemm=4.7e-02 t_reduction=8.7e-03 tot=5.9e-02 -----
 sigma_tot[inter] counter=34 t=3.3e-03 per=5.6e+00 cost=2.9e+07 flops=8.8e+09
 sigma_tot[gemm] counter=34 i=0 t=7.5e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=1 t=6.9e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=34 i=2 t=1.2e-02 per=2.0e+01 cost=1.2e+07 flops=9.7e+08
 sigma_tot[gemm] counter=34 i=3 t=1.5e-02 per=2.5e+01 cost=1.1e+07 flops=7.7e+08
 sigma_tot[gemm] counter=34 i=4 t=9.8e-03 per=1.7e+01 cost=1.2e+07 flops=1.2e+09
 sigma_tot[gemm] counter=34 i=5 t=1.0e-02 per=1.8e+01 cost=1.2e+07 flops=1.2e+09
 sigma_tot[gemm] counter=34 total t=4.7e-02 per=8.0e+01 cost=4.7e+07 flops=9.9e+08
 sigma_tot[red] counter=34 t=8.7e-03 per=1.5e+01 cost=4.9e+06 flops=5.6e+08
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=8.7e-06,1.2e-05,2.2e-06,3.4e-06,3.7e-07
    6   0 -    -116.472905718433 -1.841e-07  1.011e-04    3     6  2.038e-02 3.396e-03 3.340e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.511e-05,1.334e-04,2.676e-03,4.044e-04,3.295e-03
 analyze_tgpu[Hx]: ndim=723:5.387e-06GB T(cpu-gpu)=2.354e-05 speed=4.578e-01GB/S T(nccl)=5.158e-05 speed=2.089e-01GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=2.7e-03 t_reduction=4.0e-04 tot=3.2e-03 -----
 sigma[inter] counter=35 t=1.3e-04 per=4.1e+00 cost=3.0e+06 flops=2.3e+10
 sigma[gemm] counter=35 i=0 t=2.0e-06 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=1 t=1.9e-06 per=5.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=35 i=2 t=6.7e-04 per=2.1e+01 cost=1.2e+06 flops=1.8e+09
 sigma[gemm] counter=35 i=3 t=8.5e-04 per=2.7e+01 cost=1.2e+06 flops=1.4e+09
 sigma[gemm] counter=35 i=4 t=5.6e-04 per=1.7e+01 cost=1.2e+06 flops=2.2e+09
 sigma[gemm] counter=35 i=5 t=5.9e-04 per=1.8e+01 cost=1.2e+06 flops=2.1e+09
 sigma[gemm] counter=35 total t=2.7e-03 per=8.3e+01 cost=4.9e+06 flops=1.8e+09
 sigma[red] counter=35 t=4.0e-04 per=1.3e+01 cost=4.8e+05 flops=1.2e+09
----- TIMING FOR sigma_tot : t_inter=3.4e-03 t_gemm=5.0e-02 t_reduction=9.1e-03 tot=6.2e-02 -----
 sigma_tot[inter] counter=35 t=3.4e-03 per=5.5e+00 cost=3.2e+07 flops=9.4e+09
 sigma_tot[gemm] counter=35 i=0 t=7.7e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=1 t=7.1e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=35 i=2 t=1.3e-02 per=2.0e+01 cost=1.3e+07 flops=1.0e+09
 sigma_tot[gemm] counter=35 i=3 t=1.6e-02 per=2.5e+01 cost=1.3e+07 flops=8.1e+08
 sigma_tot[gemm] counter=35 i=4 t=1.0e-02 per=1.7e+01 cost=1.3e+07 flops=1.3e+09
 sigma_tot[gemm] counter=35 i=5 t=1.1e-02 per=1.8e+01 cost=1.3e+07 flops=1.2e+09
 sigma_tot[gemm] counter=35 total t=5.0e-02 per=8.0e+01 cost=5.2e+07 flops=1.0e+09
 sigma_tot[red] counter=35 t=9.1e-03 per=1.5e+01 cost=5.4e+06 flops=5.9e+08
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=9.2e-06,1.2e-05,2.0e-06,3.3e-06,3.4e-07
    7   0 +    -116.472905736041 -1.761e-08  2.892e-05    3     7  2.388e-02 3.411e-03 3.356e-03
TIMING FOR Davidson : 2.389e-02  T(cal/comm/rest)=2.349e-02,3.379e-06,3.965e-04
decomposed t_rest=3.965e-04
 T(sub)    =1.934e-04 per=4.876e+01
 T(precond)=3.305e-05 per=8.336e+00
 T(ortho)  =1.909e-05 per=4.815e+00
 T(xcopy)  =2.739e-06 per=6.908e-01
 T(xnrm2)  =3.138e-06 per=7.914e-01
 T(other)  =1.451e-04 per=3.660e+01
optimized energies: isweep=0 ibond=5 dots=1 e[0]=-116.472905736041 nmvp=7
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=2.426e-03 change=2.213e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=19 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond5.txt
 qbond: qsuper nsym=19 dimAll=152
 (8,2):14 (10,2):25 (9,3):20 (9,1):19 (11,1):14 (10,0):12 (11,3):9 (10,4):8 (7,3):5 (8,4):7 (12,2):3 (12,0):3 (11,-1):3 (9,5):2 (7,1):2 (8,0):3 (6,4):1 (7,5):1 (9,-1):1
timing for divide=3.3e-06
timing for compute=1.2e-04
timing for collect=6.3e-06
----- TMING FOR decimation_genbasis(nkr): 1.3e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.3e-06,1.1e-04,0.0e+00,2.3e-06,6.3e-06 -----
decimation summary: 152->47 dwt=-2.220e-16 SvN=1.761e+00
 qbond: qkept nsym=11 dimAll=47
 (10,2):9 (9,1):8 (10,0):8 (11,1):6 (8,2):4 (9,3):4 (11,-1):3 (8,0):2 (11,3):1 (7,3):1 (9,-1):1
----- TIMING for decimation_row(nkr): 1.234e-03 S T(decim/select/formRot)=1.549e-04,1.063e-03,1.620e-05 -----
----- TIMING FOR onedot_decimation: 1.272e-03 S T(wf/decim)=2.989e-05,1.242e-03 -----
ctns::oper_renorm coord=(6,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:14 S:13 H:1 A:45 B:53 
        dim(bra,ket)=47,47 size(op)=293:2.235e-03MB size(tot)=21552:1.644e-01MB:1.606e-04GB
        per(mem): C:12.5 S:13 H:1.36 A:18.3 B:54.8 
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=2.365e-03 change=2.668e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=113 : 1.385e-04 S -----
rank=0 GPUmem(GB): used=2.829e-04 (oper)=2.643e-04
rank=0 GPUmem(GB): used=2.882e-04 (oper,site)=2.643e-04,5.387e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=113
 no. of rintermediate operators=7
 no. of coefficients=116:8.850e-04MB:8.643e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.488e-05 S -----
rank=0 GPUmem(GB): used=2.891e-04 (oper,site,rinter)=2.643e-04,5.387e-06,8.643e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 5.520e-04 S size(rtasks)=113 size(Rlst2)=121 T(Rmu/Rlist)=7.987e-05,4.721e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.704e-04 S size(rtasks)=113 size(Rlst)=1979 -----
rank=0 GPUmem(GB): used=2.891e-04 avail=3.829e+01 total=3.829e+01 batch[need]=3.347e-03 blksize=81 blksize0=64 batchsize=1979
rank=0 GPUmem(GB): used=3.636e-03 (oper,site,rinter,batch)=2.643e-04,5.387e-06,8.643e-07,3.347e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.851e-04,1.394e-03,2.923e-04
----- TIMING FOR renorm : t_inter=1.9e-04 t_gemm=1.4e-03 t_reduction=2.9e-04 tot=1.9e-03 -----
 renorm[inter] counter=166 t=1.9e-04 per=9.9e+00 cost=1.3e+05 flops=6.9e+08
 renorm[gemm] counter=166 i=0 t=2.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=166 i=1 t=1.9e-06 per=9.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=166 i=2 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=166 i=3 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=166 i=4 t=3.6e-04 per=1.9e+01 cost=5.8e+04 flops=1.6e+08
 renorm[gemm] counter=166 i=5 t=5.3e-04 per=2.8e+01 cost=4.5e+05 flops=8.5e+08
 renorm[gemm] counter=166 i=6 t=5.0e-04 per=2.7e+01 cost=6.7e+05 flops=1.3e+09
 renorm[gemm] counter=166 total t=1.4e-03 per=7.4e+01 cost=1.2e+06 flops=8.4e+08
 renorm[red] counter=166 t=2.9e-04 per=1.6e+01 cost=1.3e+05 flops=4.4e+08
----- TIMING FOR renorm_tot : t_inter=6.0e-04 t_gemm=4.3e-03 t_reduction=1.3e-03 tot=6.1e-03 -----
 renorm_tot[inter] counter=166 t=6.0e-04 per=9.9e+00 cost=2.4e+05 flops=4.0e+08
 renorm_tot[gemm] counter=166 i=0 t=1.3e-05 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=166 i=1 t=1.2e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=166 i=2 t=1.2e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=166 i=3 t=1.2e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=166 i=4 t=1.2e-03 per=1.9e+01 cost=1.2e+05 flops=1.0e+08
 renorm_tot[gemm] counter=166 i=5 t=1.5e-03 per=2.5e+01 cost=7.3e+05 flops=4.7e+08
 renorm_tot[gemm] counter=166 i=6 t=1.5e-03 per=2.5e+01 cost=1.2e+06 flops=7.9e+08
 renorm_tot[gemm] counter=166 total t=4.3e-03 per=7.0e+01 cost=2.0e+06 flops=4.8e+08
 renorm_tot[red] counter=166 t=1.3e-03 per=2.1e+01 cost=2.8e+05 flops=2.2e+08
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.039e-04 (oper)=2.659e-04
rank=0 GPUmem(GB): used=3.093e-04 (oper,site,rinter)=2.659e-04,5.387e-06,1.860e-05
rank=0 GPUmem(GB): used=4.697e-04 (oper,site,rinter,batch)=2.659e-04,5.387e-06,1.860e-05,1.604e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.191e-02 S T(preprocess/alloc/comp/red/dealloc)=2.383e-03,2.420e-03,1.638e-02,2.881e-03,1.835e-04 -----
----- TIMING FOR oper_renorm_opS : 2.196e-02 S rank=0 -----
qops.to_cpu: size(tot)=21552:1.644e-01MB:1.606e-04GB T(to_cpu)=1.078e-04S speed=1.490e+00GB/S
check ||H-H.dagger||=2.965e-14 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.0269 S rank=0 -----
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=2.869e-03 change=6.648e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=5.096e-03 change=-1.921e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=5.096e-03 change=-8.702e-06 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 6.679e-02 S #####
 T(local opt: fetch) = 3.029e-03 S  per = 4.53  per(accum) = 4.53
 T(local opt: hdiag) = 9.152e-04 S  per = 1.37  per(accum) = 5.9
 T(local opt: dvdsn) = 3.156e-02 S  per = 47.2  per(accum) = 53.2
 T(local opt: decim) = 1.301e-03 S  per = 1.95  per(accum) = 55.1
 T(local opt: guess) = 6.682e-05 S  per =  0.1  per(accum) = 55.2
 T(local opt: renrm) = 2.760e-02 S  per = 41.3  per(accum) = 96.5
 T(local opt: save ) = 2.322e-03 S  per = 3.48  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.156e-02 S  T(sum) = 3.097e-02 S  per = 9.815e+01
 T(local opt: preprocess                  ) = 7.189e-05 S  per = 0.232  per(accum) = 0.232
 T(local opt: symbolic_formulae           ) = 8.134e-04 S  per = 2.63  per(accum) = 2.86
 T(local opt: hintermediate init          ) = 4.428e-05 S  per = 0.143  per(accum) = 3
 T(local opt: preprocess_hformulae_Hxlist ) = 3.120e-03 S  per = 10.1  per(accum) = 13.1
 T(local opt: hmmtasks init               ) = 3.028e-03 S  per = 9.78  per(accum) = 22.8
 T(local opt: initial guess for dvdson    ) = 5.414e-06 S  per = 0.0175  per(accum) = 22.9
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.300e-02 S  per = 74.2  per(accum) = 97.1
 T(local opt: dvdson [cpu-gpu]            ) = 1.659e-04 S  per = 0.536  per(accum) = 97.6
 T(local opt: dvdson [nccl]               ) = 3.297e-04 S  per = 1.06  per(accum) = 98.7
 T(local opt: dvdson [mpi]                ) = 3.379e-06 S  per = 0.0109  per(accum) = 98.7
 T(local opt: dvdson [rest part(linalg)]  ) = 3.965e-04 S  per = 1.28  per(accum) = 100
Detailed decomposition of T(renrm) = 2.760e-02 S  T(sum) = 2.760e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.936e-05 S  per = 0.179  per(accum) = 0.179
 T(local opt: qops init                    ) = 5.752e-04 S  per = 2.08  per(accum) = 2.26
 T(local opt: symbolic_formulae_renorm     ) = 1.435e-04 S  per = 0.52  per(accum) = 2.78
 T(local opt: allocate qops on gpu         ) = 5.544e-05 S  per = 0.201  per(accum) = 2.98
 T(local opt: site memcpy cpu2gpu          ) = 2.025e-05 S  per = 0.0733  per(accum) = 3.06
 T(local opt: rintermediate init           ) = 3.284e-05 S  per = 0.119  per(accum) = 3.18
 T(local opt: preprocess_formulae_Rlist2   ) = 8.830e-04 S  per =  3.2  per(accum) = 6.37
 T(local opt: rmmtasks init                ) = 9.142e-04 S  per = 3.31  per(accum) = 9.69
 T(local opt: qops memset on cpu           ) = 2.700e-08 S  per = 9.78e-05  per(accum) = 9.69
 T(local opt: preprocess_renorm_batchGPU   ) = 1.953e-03 S  per = 7.08  per(accum) = 16.8
 T(local opt: deallocate cpu and gpu memory) = 1.836e-04 S  per = 0.665  per(accum) = 17.4
 T(local opt: construct opS [ifdists=true] ) = 2.201e-02 S  per = 79.7  per(accum) = 97.2
 T(local opt: reduction of opS & opH [nccl]) = 2.355e-05 S  per = 0.0853  per(accum) = 97.3
 T(local opt: qops memcpy gpu2cpu          ) = 1.196e-04 S  per = 0.433  per(accum) = 97.7
 T(local opt: reduction of opS & opH [mpi] ) = 1.309e-05 S  per = 0.0474  per(accum) = 97.7
 T(local opt: qops_pool join and erase     ) = 6.238e-04 S  per = 2.26  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.130e-07 S  per = 0.00295  per(accum) = 100
ctns::rcanon_save_site idx=13 scratch=./scratch/sweep size=723:5.4e-06GB T(load)=0.00059S speed=0.0092GB/S
##### sweep opt: 2.430e-01 S #####
 T(sweep opt: fetch) = 1.982e-02 S  per = 8.16  per(accum) = 8.16
 T(sweep opt: hdiag) = 3.021e-03 S  per = 1.24  per(accum) = 9.4
 T(sweep opt: dvdsn) = 9.055e-02 S  per = 37.3  per(accum) = 46.7
 T(sweep opt: decim) = 4.686e-03 S  per = 1.93  per(accum) = 48.6
 T(sweep opt: guess) = 2.603e-04 S  per = 0.107  per(accum) = 48.7
 T(sweep opt: renrm) = 1.132e-01 S  per = 46.6  per(accum) = 95.2
 T(sweep opt: save ) = 1.154e-02 S  per = 4.75  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.055e-02 S  T(sum) = 8.814e-02 S  per = 9.734e+01
 T(sweep opt: preprocess                  ) = 3.503e-04 S  per = 0.397  per(accum) = 0.397
 T(sweep opt: symbolic_formulae           ) = 2.742e-03 S  per = 3.11  per(accum) = 3.51
 T(sweep opt: hintermediate init          ) = 2.892e-04 S  per = 0.328  per(accum) = 3.84
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.528e-03 S  per = 7.41  per(accum) = 11.2
 T(sweep opt: hmmtasks init               ) = 6.416e-03 S  per = 7.28  per(accum) = 18.5
 T(sweep opt: initial guess for dvdson    ) = 2.117e-05 S  per = 0.024  per(accum) = 18.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.746e-02 S  per = 76.5  per(accum) = 95.1
 T(sweep opt: dvdson [cpu-gpu]            ) = 7.938e-04 S  per = 0.901  per(accum) = 96
 T(sweep opt: dvdson [nccl]               ) = 1.618e-03 S  per = 1.84  per(accum) = 97.8
 T(sweep opt: dvdson [mpi]                ) = 1.503e-05 S  per = 0.017  per(accum) = 97.8
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.907e-03 S  per = 2.16  per(accum) = 100
Detailed decomposition of T(renrm) = 1.132e-01 S  T(sum) = 1.132e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.697e-04 S  per = 0.238  per(accum) = 0.238
 T(sweep opt: qops init                    ) = 2.143e-03 S  per = 1.89  per(accum) = 2.13
 T(sweep opt: symbolic_formulae_renorm     ) = 4.591e-04 S  per = 0.406  per(accum) = 2.54
 T(sweep opt: allocate qops on gpu         ) = 3.151e-04 S  per = 0.278  per(accum) = 2.82
 T(sweep opt: site memcpy cpu2gpu          ) = 1.314e-04 S  per = 0.116  per(accum) = 2.93
 T(sweep opt: rintermediate init           ) = 2.619e-04 S  per = 0.231  per(accum) = 3.16
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.254e-03 S  per = 1.99  per(accum) = 5.16
 T(sweep opt: rmmtasks init                ) = 2.300e-03 S  per = 2.03  per(accum) = 7.19
 T(sweep opt: qops memset on cpu           ) = 1.840e-07 S  per = 0.000163  per(accum) = 7.19
 T(sweep opt: preprocess_renorm_batchGPU   ) = 6.792e-03 S  per =    6  per(accum) = 13.2
 T(sweep opt: deallocate cpu and gpu memory) = 3.318e-04 S  per = 0.293  per(accum) = 13.5
 T(sweep opt: construct opS [ifdists=true] ) = 9.362e-02 S  per = 82.7  per(accum) = 96.2
 T(sweep opt: reduction of opS & opH [nccl]) = 1.287e-04 S  per = 0.114  per(accum) = 96.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.040e-04 S  per = 0.357  per(accum) = 96.7
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.058e-04 S  per = 0.182  per(accum) = 96.9
 T(sweep opt: qops_pool join and erase     ) = 3.543e-03 S  per = 3.13  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 5.065e-06 S  per = 0.00448  per(accum) = 100
##### global opt: 2.430e-01 S #####
 T(global opt: fetch) = 1.982e-02 S  per = 8.16  per(accum) = 8.16
 T(global opt: hdiag) = 3.021e-03 S  per = 1.24  per(accum) = 9.4
 T(global opt: dvdsn) = 9.055e-02 S  per = 37.3  per(accum) = 46.7
 T(global opt: decim) = 4.686e-03 S  per = 1.93  per(accum) = 48.6
 T(global opt: guess) = 2.603e-04 S  per = 0.107  per(accum) = 48.7
 T(global opt: renrm) = 1.132e-01 S  per = 46.6  per(accum) = 95.2
 T(global opt: save ) = 1.154e-02 S  per = 4.75  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.055e-02 S  T(sum) = 8.814e-02 S  per = 9.734e+01
 T(global opt: preprocess                  ) = 3.503e-04 S  per = 0.397  per(accum) = 0.397
 T(global opt: symbolic_formulae           ) = 2.742e-03 S  per = 3.11  per(accum) = 3.51
 T(global opt: hintermediate init          ) = 2.892e-04 S  per = 0.328  per(accum) = 3.84
 T(global opt: preprocess_hformulae_Hxlist ) = 6.528e-03 S  per = 7.41  per(accum) = 11.2
 T(global opt: hmmtasks init               ) = 6.416e-03 S  per = 7.28  per(accum) = 18.5
 T(global opt: initial guess for dvdson    ) = 2.117e-05 S  per = 0.024  per(accum) = 18.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.746e-02 S  per = 76.5  per(accum) = 95.1
 T(global opt: dvdson [cpu-gpu]            ) = 7.938e-04 S  per = 0.901  per(accum) = 96
 T(global opt: dvdson [nccl]               ) = 1.618e-03 S  per = 1.84  per(accum) = 97.8
 T(global opt: dvdson [mpi]                ) = 1.503e-05 S  per = 0.017  per(accum) = 97.8
 T(global opt: dvdson [rest part(linalg)]  ) = 1.907e-03 S  per = 2.16  per(accum) = 100
Detailed decomposition of T(renrm) = 1.132e-01 S  T(sum) = 1.132e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.697e-04 S  per = 0.238  per(accum) = 0.238
 T(global opt: qops init                    ) = 2.143e-03 S  per = 1.89  per(accum) = 2.13
 T(global opt: symbolic_formulae_renorm     ) = 4.591e-04 S  per = 0.406  per(accum) = 2.54
 T(global opt: allocate qops on gpu         ) = 3.151e-04 S  per = 0.278  per(accum) = 2.82
 T(global opt: site memcpy cpu2gpu          ) = 1.314e-04 S  per = 0.116  per(accum) = 2.93
 T(global opt: rintermediate init           ) = 2.619e-04 S  per = 0.231  per(accum) = 3.16
 T(global opt: preprocess_formulae_Rlist2   ) = 2.254e-03 S  per = 1.99  per(accum) = 5.16
 T(global opt: rmmtasks init                ) = 2.300e-03 S  per = 2.03  per(accum) = 7.19
 T(global opt: qops memset on cpu           ) = 1.840e-07 S  per = 0.000163  per(accum) = 7.19
 T(global opt: preprocess_renorm_batchGPU   ) = 6.792e-03 S  per =    6  per(accum) = 13.2
 T(global opt: deallocate cpu and gpu memory) = 3.318e-04 S  per = 0.293  per(accum) = 13.5
 T(global opt: construct opS [ifdists=true] ) = 9.362e-02 S  per = 82.7  per(accum) = 96.2
 T(global opt: reduction of opS & opH [nccl]) = 1.287e-04 S  per = 0.114  per(accum) = 96.3
 T(global opt: qops memcpy gpu2cpu          ) = 4.040e-04 S  per = 0.357  per(accum) = 96.7
 T(global opt: reduction of opS & opH [mpi] ) = 2.058e-04 S  per = 0.182  per(accum) = 96.9
 T(global opt: qops_pool join and erase     ) = 3.543e-03 S  per = 3.13  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 5.065e-06 S  per = 0.00448  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-2.219e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=6/seqsize=34 dots=1 dbond=(7,0)-(8,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=11 scratch=./scratch/sweep size=1232:9.18e-06GB T(load)=3.15e-04S speed=2.92e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=2213:1.69e-02MB:1.65e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=981:7.48e-03MB:7.31e-06GB
total mem of comb=3342:2.55e-02MB:2.49e-05GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=1.702e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=7,12,1
 suppl= 0 1 2 3 4 16 17
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 18
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:14 S:13 H:1 A:45 B:53 
        dim(bra,ket)=47,47 size(op)=293:2.235e-03MB size(tot)=21552:1.644e-01MB:1.606e-04GB
        per(mem): C:12.5 S:13 H:1.36 A:18.3 B:54.8 
 rqops: oplist=CSHPQ nops=C:24 S:8 H:1 P:61 Q:67 
        dim(bra,ket)=57,57 size(op)=361:0.00275MB size(tot)=36150:0.276MB:0.000269GB
        per(mem): C:17.2 S:5.95 H:0.999 P:23.7 Q:52.2 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=60038:0.458MB:0.000447GB
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.514e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(7,0) fdel=./scratch/sweep/rop(8,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=2.747e-04 change=-2.743e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(47,57,4) nnz=981:7.484e-03MB
qtensor3: wf3 own=1 _data=0x55b2c6236000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=11 dimAll=47
 (10,2):9 (9,1):8 (10,0):8 (11,1):6 (8,2):4 (9,3):4 (11,-1):3 (8,0):2 (11,3):1 (7,3):1 (9,-1):1
 qbond: qcol nsym=12 dimAll=57
 (19,-1):10 (18,0):8 (18,-2):8 (17,-1):6 (20,0):5 (20,-2):5 (19,-3):4 (19,1):4 (17,1):3 (21,-1):2 (17,-3):1 (21,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=33 nblocks=528 size=981:7.484e-03MB
### DIAG TIMING: total=1.314e-03 t1=1.971e-05, t2=1.323e-05, t3=1.303e-05, t4=1.208e-03, t5=1.117e-05, t6=4.040e-05, t7=8.440e-06
duration_diagGPU:1.331e-03
duration_diagreduce:6.500e-08
duration_diagtransform:1.114e-06
----- TIMING FOR symbolic_formulae_onedot with size=528 : 1.085e-03 S -----
rank=0 GPUmem(GB): used=4.473e-04 (oper)=4.473e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=528
 no. of hintermediate operators=259
 no. of coefficients=3108:2.371e-02MB:2.316e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.459e-05 S -----
rank=0 GPUmem(GB): used=4.705e-04 (oper,hinter)=4.473e-04,2.316e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.725e-03 S size(H_formulae)=528 size(Hxlst2)=33 T(Hmu/Hxlist)=2.323e-04,3.493e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.598e-03 S size(H_formulae)=528 size(Hxlst)=13334 -----
rank=0 GPUmem(GB): used=4.705e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.462e-05 batch[need]=2.593e-02 blksize=90 blksize0=80 batchsize=13334
rank=0 GPUmem(GB): used=2.641e-02 (oper,hinter,dvdson,batch)=4.473e-04,2.316e-05,1.462e-05,2.593e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=981 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.855e-05,1.704e-04,2.899e-03,4.183e-04,3.581e-03
 analyze_tgpu[Hx]: ndim=981:7.309e-06GB T(cpu-gpu)=2.533e-05 speed=5.772e-01GB/S T(nccl)=5.322e-05 speed=2.747e-01GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=2.9e-03 t_reduction=4.2e-04 tot=3.5e-03 -----
 sigma[inter] counter=36 t=1.7e-04 per=4.9e+00 cost=4.7e+06 flops=2.7e+10
 sigma[gemm] counter=36 i=0 t=2.0e-06 per=5.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=1 t=1.7e-06 per=4.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=36 i=2 t=7.0e-04 per=2.0e+01 cost=2.3e+06 flops=3.3e+09
 sigma[gemm] counter=36 i=3 t=8.9e-04 per=2.6e+01 cost=2.3e+06 flops=2.6e+09
 sigma[gemm] counter=36 i=4 t=6.3e-04 per=1.8e+01 cost=2.6e+06 flops=4.1e+09
 sigma[gemm] counter=36 i=5 t=6.7e-04 per=1.9e+01 cost=2.7e+06 flops=4.1e+09
 sigma[gemm] counter=36 total t=2.9e-03 per=8.3e+01 cost=9.9e+06 flops=3.4e+09
 sigma[red] counter=36 t=4.2e-04 per=1.2e+01 cost=8.9e+05 flops=2.1e+09
----- TIMING FOR sigma_tot : t_inter=3.6e-03 t_gemm=5.3e-02 t_reduction=9.5e-03 tot=6.6e-02 -----
 sigma_tot[inter] counter=36 t=3.6e-03 per=5.5e+00 cost=3.7e+07 flops=1.0e+10
 sigma_tot[gemm] counter=36 i=0 t=7.9e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=1 t=7.3e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=36 i=2 t=1.3e-02 per=2.0e+01 cost=1.5e+07 flops=1.1e+09
 sigma_tot[gemm] counter=36 i=3 t=1.7e-02 per=2.5e+01 cost=1.5e+07 flops=9.0e+08
 sigma_tot[gemm] counter=36 i=4 t=1.1e-02 per=1.7e+01 cost=1.6e+07 flops=1.4e+09
 sigma_tot[gemm] counter=36 i=5 t=1.2e-02 per=1.8e+01 cost=1.6e+07 flops=1.4e+09
 sigma_tot[gemm] counter=36 total t=5.3e-02 per=8.0e+01 cost=6.2e+07 flops=1.2e+09
 sigma_tot[red] counter=36 t=9.5e-03 per=1.4e+01 cost=6.3e+06 flops=6.6e+08
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=7.9e-06,4.0e-06,1.2e-06,3.0e-06,4.1e-07
settings: ndim=981 neig=1 maxcycle=30 nbuff=4 memory=0.0001GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.472905736041 -1.116e+03  7.257e-02    1     1  3.871e-03 3.871e-03 3.830e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.303e-05,1.721e-04,3.666e-03,4.699e-04,4.388e-03
 analyze_tgpu[Hx]: ndim=981:7.309e-06GB T(cpu-gpu)=2.530e-05 speed=5.778e-01GB/S T(nccl)=4.773e-05 speed=3.063e-01GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=3.7e-03 t_reduction=4.7e-04 tot=4.3e-03 -----
 sigma[inter] counter=37 t=1.7e-04 per=4.0e+00 cost=4.7e+06 flops=2.7e+10
 sigma[gemm] counter=37 i=0 t=2.2e-06 per=5.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=1 t=2.1e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=37 i=2 t=9.1e-04 per=2.1e+01 cost=2.3e+06 flops=2.5e+09
 sigma[gemm] counter=37 i=3 t=1.1e-03 per=2.6e+01 cost=2.3e+06 flops=2.0e+09
 sigma[gemm] counter=37 i=4 t=7.8e-04 per=1.8e+01 cost=2.6e+06 flops=3.3e+09
 sigma[gemm] counter=37 i=5 t=8.4e-04 per=2.0e+01 cost=2.7e+06 flops=3.3e+09
 sigma[gemm] counter=37 total t=3.7e-03 per=8.5e+01 cost=9.9e+06 flops=2.7e+09
 sigma[red] counter=37 t=4.7e-04 per=1.1e+01 cost=8.9e+05 flops=1.9e+09
----- TIMING FOR sigma_tot : t_inter=3.8e-03 t_gemm=5.6e-02 t_reduction=1.0e-02 tot=7.0e-02 -----
 sigma_tot[inter] counter=37 t=3.8e-03 per=5.4e+00 cost=4.1e+07 flops=1.1e+10
 sigma_tot[gemm] counter=37 i=0 t=8.1e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=1 t=7.5e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=37 i=2 t=1.4e-02 per=2.0e+01 cost=1.7e+07 flops=1.2e+09
 sigma_tot[gemm] counter=37 i=3 t=1.8e-02 per=2.5e+01 cost=1.7e+07 flops=9.7e+08
 sigma_tot[gemm] counter=37 i=4 t=1.2e-02 per=1.7e+01 cost=1.8e+07 flops=1.5e+09
 sigma_tot[gemm] counter=37 i=5 t=1.2e-02 per=1.8e+01 cost=1.9e+07 flops=1.5e+09
 sigma_tot[gemm] counter=37 total t=5.6e-02 per=8.0e+01 cost=7.1e+07 flops=1.3e+09
 sigma_tot[red] counter=37 t=1.0e-02 per=1.4e+01 cost=7.2e+06 flops=7.2e+08
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,2.0e-05,3.0e-06,7.5e-06,4.8e-07
    2   0 -    -116.480768071891 -7.862e-03  1.906e-02    2     2  8.642e-03 4.321e-03 4.248e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.284e-05,1.553e-04,3.660e-03,4.668e-04,4.362e-03
 analyze_tgpu[Hx]: ndim=981:7.309e-06GB T(cpu-gpu)=2.521e-05 speed=5.799e-01GB/S T(nccl)=4.764e-05 speed=3.069e-01GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=3.7e-03 t_reduction=4.7e-04 tot=4.3e-03 -----
 sigma[inter] counter=38 t=1.6e-04 per=3.6e+00 cost=4.7e+06 flops=3.0e+10
 sigma[gemm] counter=38 i=0 t=2.2e-06 per=5.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=1 t=2.1e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=38 i=2 t=9.1e-04 per=2.1e+01 cost=2.3e+06 flops=2.5e+09
 sigma[gemm] counter=38 i=3 t=1.1e-03 per=2.6e+01 cost=2.3e+06 flops=2.0e+09
 sigma[gemm] counter=38 i=4 t=7.8e-04 per=1.8e+01 cost=2.6e+06 flops=3.3e+09
 sigma[gemm] counter=38 i=5 t=8.4e-04 per=2.0e+01 cost=2.7e+06 flops=3.2e+09
 sigma[gemm] counter=38 total t=3.7e-03 per=8.5e+01 cost=9.9e+06 flops=2.7e+09
 sigma[red] counter=38 t=4.7e-04 per=1.1e+01 cost=8.9e+05 flops=1.9e+09
----- TIMING FOR sigma_tot : t_inter=3.9e-03 t_gemm=6.0e-02 t_reduction=1.0e-02 tot=7.4e-02 -----
 sigma_tot[inter] counter=38 t=3.9e-03 per=5.3e+00 cost=4.6e+07 flops=1.2e+10
 sigma_tot[gemm] counter=38 i=0 t=8.3e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=1 t=7.7e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=38 i=2 t=1.5e-02 per=2.0e+01 cost=2.0e+07 flops=1.3e+09
 sigma_tot[gemm] counter=38 i=3 t=1.9e-02 per=2.5e+01 cost=2.0e+07 flops=1.0e+09
 sigma_tot[gemm] counter=38 i=4 t=1.3e-02 per=1.7e+01 cost=2.1e+07 flops=1.7e+09
 sigma_tot[gemm] counter=38 i=5 t=1.3e-02 per=1.8e+01 cost=2.1e+07 flops=1.6e+09
 sigma_tot[gemm] counter=38 total t=6.0e-02 per=8.1e+01 cost=8.1e+07 flops=1.4e+09
 sigma_tot[red] counter=38 t=1.0e-02 per=1.4e+01 cost=8.0e+06 flops=7.7e+08
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.3e-05,2.0e-05,2.2e-06,9.5e-06,5.1e-07
    3   0 -    -116.481359404629 -5.913e-04  6.739e-03    3     3  1.342e-02 4.474e-03 4.400e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.014e-05,1.517e-04,3.672e-03,4.632e-04,4.363e-03
 analyze_tgpu[Hx]: ndim=981:7.309e-06GB T(cpu-gpu)=2.317e-05 speed=6.310e-01GB/S T(nccl)=4.698e-05 speed=3.112e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=3.7e-03 t_reduction=4.6e-04 tot=4.3e-03 -----
 sigma[inter] counter=39 t=1.5e-04 per=3.5e+00 cost=4.7e+06 flops=3.1e+10
 sigma[gemm] counter=39 i=0 t=2.1e-06 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=1 t=2.1e-06 per=4.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=39 i=2 t=9.0e-04 per=2.1e+01 cost=2.3e+06 flops=2.5e+09
 sigma[gemm] counter=39 i=3 t=1.2e-03 per=2.7e+01 cost=2.3e+06 flops=2.0e+09
 sigma[gemm] counter=39 i=4 t=7.8e-04 per=1.8e+01 cost=2.6e+06 flops=3.3e+09
 sigma[gemm] counter=39 i=5 t=8.4e-04 per=2.0e+01 cost=2.7e+06 flops=3.2e+09
 sigma[gemm] counter=39 total t=3.7e-03 per=8.6e+01 cost=9.9e+06 flops=2.7e+09
 sigma[red] counter=39 t=4.6e-04 per=1.1e+01 cost=8.9e+05 flops=1.9e+09
----- TIMING FOR sigma_tot : t_inter=4.1e-03 t_gemm=6.4e-02 t_reduction=1.1e-02 tot=7.9e-02 -----
 sigma_tot[inter] counter=39 t=4.1e-03 per=5.2e+00 cost=5.1e+07 flops=1.2e+10
 sigma_tot[gemm] counter=39 i=0 t=8.5e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=1 t=7.9e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=39 i=2 t=1.6e-02 per=2.0e+01 cost=2.2e+07 flops=1.4e+09
 sigma_tot[gemm] counter=39 i=3 t=2.0e-02 per=2.5e+01 cost=2.2e+07 flops=1.1e+09
 sigma_tot[gemm] counter=39 i=4 t=1.3e-02 per=1.7e+01 cost=2.3e+07 flops=1.8e+09
 sigma_tot[gemm] counter=39 i=5 t=1.4e-02 per=1.8e+01 cost=2.4e+07 flops=1.7e+09
 sigma_tot[gemm] counter=39 total t=6.4e-02 per=8.1e+01 cost=9.1e+07 flops=1.4e+09
 sigma_tot[red] counter=39 t=1.1e-02 per=1.4e+01 cost=8.9e+06 flops=8.2e+08
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.3e-05,2.2e-06,4.5e-06,4.3e-07
    4   0 -    -116.481441657423 -8.225e-05  2.446e-03    3     4  1.824e-02 4.559e-03 4.488e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.042e-05,1.484e-04,3.620e-03,4.665e-04,4.312e-03
 analyze_tgpu[Hx]: ndim=981:7.309e-06GB T(cpu-gpu)=2.332e-05 speed=6.268e-01GB/S T(nccl)=4.710e-05 speed=3.104e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=3.6e-03 t_reduction=4.7e-04 tot=4.2e-03 -----
 sigma[inter] counter=40 t=1.5e-04 per=3.5e+00 cost=4.7e+06 flops=3.1e+10
 sigma[gemm] counter=40 i=0 t=2.0e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=1 t=1.9e-06 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=40 i=2 t=8.3e-04 per=2.0e+01 cost=2.3e+06 flops=2.7e+09
 sigma[gemm] counter=40 i=3 t=1.2e-03 per=2.8e+01 cost=2.3e+06 flops=2.0e+09
 sigma[gemm] counter=40 i=4 t=7.8e-04 per=1.8e+01 cost=2.6e+06 flops=3.3e+09
 sigma[gemm] counter=40 i=5 t=8.3e-04 per=2.0e+01 cost=2.7e+06 flops=3.3e+09
 sigma[gemm] counter=40 total t=3.6e-03 per=8.5e+01 cost=9.9e+06 flops=2.7e+09
 sigma[red] counter=40 t=4.7e-04 per=1.1e+01 cost=8.9e+05 flops=1.9e+09
----- TIMING FOR sigma_tot : t_inter=4.2e-03 t_gemm=6.7e-02 t_reduction=1.1e-02 tot=8.3e-02 -----
 sigma_tot[inter] counter=40 t=4.2e-03 per=5.1e+00 cost=5.5e+07 flops=1.3e+10
 sigma_tot[gemm] counter=40 i=0 t=8.7e-05 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=1 t=8.1e-05 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=40 i=2 t=1.7e-02 per=2.0e+01 cost=2.4e+07 flops=1.4e+09
 sigma_tot[gemm] counter=40 i=3 t=2.1e-02 per=2.6e+01 cost=2.4e+07 flops=1.1e+09
 sigma_tot[gemm] counter=40 i=4 t=1.4e-02 per=1.7e+01 cost=2.6e+07 flops=1.8e+09
 sigma_tot[gemm] counter=40 i=5 t=1.5e-02 per=1.8e+01 cost=2.7e+07 flops=1.8e+09
 sigma_tot[gemm] counter=40 total t=6.7e-02 per=8.1e+01 cost=1.0e+08 flops=1.5e+09
 sigma_tot[red] counter=40 t=1.1e-02 per=1.4e+01 cost=9.8e+06 flops=8.6e+08
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.2e-05,2.1e-06,4.4e-06,4.3e-07
    5   0 -    -116.481450771150 -9.114e-06  8.482e-04    3     5  2.293e-02 4.586e-03 4.517e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.153e-05,1.427e-04,3.563e-03,4.681e-04,4.252e-03
 analyze_tgpu[Hx]: ndim=981:7.309e-06GB T(cpu-gpu)=2.308e-05 speed=6.335e-01GB/S T(nccl)=4.845e-05 speed=3.017e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=3.6e-03 t_reduction=4.7e-04 tot=4.2e-03 -----
 sigma[inter] counter=41 t=1.4e-04 per=3.4e+00 cost=4.7e+06 flops=3.3e+10
 sigma[gemm] counter=41 i=0 t=2.1e-06 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=1 t=1.9e-06 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=41 i=2 t=8.2e-04 per=2.0e+01 cost=2.3e+06 flops=2.8e+09
 sigma[gemm] counter=41 i=3 t=1.1e-03 per=2.7e+01 cost=2.3e+06 flops=2.0e+09
 sigma[gemm] counter=41 i=4 t=7.8e-04 per=1.9e+01 cost=2.6e+06 flops=3.3e+09
 sigma[gemm] counter=41 i=5 t=8.4e-04 per=2.0e+01 cost=2.7e+06 flops=3.3e+09
 sigma[gemm] counter=41 total t=3.6e-03 per=8.5e+01 cost=9.9e+06 flops=2.8e+09
 sigma[red] counter=41 t=4.7e-04 per=1.1e+01 cost=8.9e+05 flops=1.9e+09
----- TIMING FOR sigma_tot : t_inter=4.4e-03 t_gemm=7.1e-02 t_reduction=1.2e-02 tot=8.7e-02 -----
 sigma_tot[inter] counter=41 t=4.4e-03 per=5.0e+00 cost=6.0e+07 flops=1.4e+10
 sigma_tot[gemm] counter=41 i=0 t=8.9e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=1 t=8.3e-05 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=41 i=2 t=1.8e-02 per=2.0e+01 cost=2.6e+07 flops=1.5e+09
 sigma_tot[gemm] counter=41 i=3 t=2.2e-02 per=2.6e+01 cost=2.6e+07 flops=1.2e+09
 sigma_tot[gemm] counter=41 i=4 t=1.5e-02 per=1.7e+01 cost=2.9e+07 flops=1.9e+09
 sigma_tot[gemm] counter=41 i=5 t=1.6e-02 per=1.8e+01 cost=3.0e+07 flops=1.9e+09
 sigma_tot[gemm] counter=41 total t=7.1e-02 per=8.1e+01 cost=1.1e+08 flops=1.6e+09
 sigma_tot[red] counter=41 t=1.2e-02 per=1.4e+01 cost=1.1e+07 flops=9.1e+08
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.0e-05,1.3e-05,2.1e-06,4.3e-06,3.9e-07
    6   0 -    -116.481452149214 -1.378e-06  3.905e-04    3     6  2.732e-02 4.553e-03 4.487e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.883e-05,1.498e-04,3.640e-03,4.625e-04,4.327e-03
 analyze_tgpu[Hx]: ndim=981:7.309e-06GB T(cpu-gpu)=2.268e-05 speed=6.445e-01GB/S T(nccl)=4.615e-05 speed=3.167e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=3.6e-03 t_reduction=4.6e-04 tot=4.3e-03 -----
 sigma[inter] counter=42 t=1.5e-04 per=3.5e+00 cost=4.7e+06 flops=3.1e+10
 sigma[gemm] counter=42 i=0 t=2.1e-06 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=1 t=2.0e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=42 i=2 t=8.9e-04 per=2.1e+01 cost=2.3e+06 flops=2.6e+09
 sigma[gemm] counter=42 i=3 t=1.1e-03 per=2.6e+01 cost=2.3e+06 flops=2.0e+09
 sigma[gemm] counter=42 i=4 t=7.7e-04 per=1.8e+01 cost=2.6e+06 flops=3.3e+09
 sigma[gemm] counter=42 i=5 t=8.4e-04 per=2.0e+01 cost=2.7e+06 flops=3.2e+09
 sigma[gemm] counter=42 total t=3.6e-03 per=8.6e+01 cost=9.9e+06 flops=2.7e+09
 sigma[red] counter=42 t=4.6e-04 per=1.1e+01 cost=8.9e+05 flops=1.9e+09
----- TIMING FOR sigma_tot : t_inter=4.5e-03 t_gemm=7.4e-02 t_reduction=1.2e-02 tot=9.1e-02 -----
 sigma_tot[inter] counter=42 t=4.5e-03 per=5.0e+00 cost=6.5e+07 flops=1.4e+10
 sigma_tot[gemm] counter=42 i=0 t=9.1e-05 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=1 t=8.5e-05 per=9.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=42 i=2 t=1.9e-02 per=2.0e+01 cost=2.9e+07 flops=1.6e+09
 sigma_tot[gemm] counter=42 i=3 t=2.3e-02 per=2.6e+01 cost=2.9e+07 flops=1.2e+09
 sigma_tot[gemm] counter=42 i=4 t=1.6e-02 per=1.7e+01 cost=3.1e+07 flops=2.0e+09
 sigma_tot[gemm] counter=42 i=5 t=1.7e-02 per=1.8e+01 cost=3.2e+07 flops=1.9e+09
 sigma_tot[gemm] counter=42 total t=7.4e-02 per=8.2e+01 cost=1.2e+08 flops=1.6e+09
 sigma_tot[red] counter=42 t=1.2e-02 per=1.3e+01 cost=1.2e+07 flops=9.4e+08
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.2e-05,2.3e-06,4.2e-06,4.3e-07
    7   0 -    -116.481452424417 -2.752e-07  1.285e-04    3     7  3.180e-02 4.542e-03 4.477e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.403e-05,1.422e-04,3.605e-03,4.607e-04,4.287e-03
 analyze_tgpu[Hx]: ndim=981:7.309e-06GB T(cpu-gpu)=2.781e-05 speed=5.257e-01GB/S T(nccl)=4.623e-05 speed=3.162e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=3.6e-03 t_reduction=4.6e-04 tot=4.2e-03 -----
 sigma[inter] counter=43 t=1.4e-04 per=3.4e+00 cost=4.7e+06 flops=3.3e+10
 sigma[gemm] counter=43 i=0 t=2.0e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=1 t=1.9e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=43 i=2 t=8.3e-04 per=2.0e+01 cost=2.3e+06 flops=2.7e+09
 sigma[gemm] counter=43 i=3 t=1.1e-03 per=2.7e+01 cost=2.3e+06 flops=2.0e+09
 sigma[gemm] counter=43 i=4 t=7.8e-04 per=1.8e+01 cost=2.6e+06 flops=3.3e+09
 sigma[gemm] counter=43 i=5 t=8.7e-04 per=2.1e+01 cost=2.7e+06 flops=3.2e+09
 sigma[gemm] counter=43 total t=3.6e-03 per=8.6e+01 cost=9.9e+06 flops=2.7e+09
 sigma[red] counter=43 t=4.6e-04 per=1.1e+01 cost=8.9e+05 flops=1.9e+09
----- TIMING FOR sigma_tot : t_inter=4.7e-03 t_gemm=7.8e-02 t_reduction=1.3e-02 tot=9.5e-02 -----
 sigma_tot[inter] counter=43 t=4.7e-03 per=4.9e+00 cost=7.0e+07 flops=1.5e+10
 sigma_tot[gemm] counter=43 i=0 t=9.3e-05 per=9.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=1 t=8.7e-05 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=43 i=2 t=1.9e-02 per=2.0e+01 cost=3.1e+07 flops=1.6e+09
 sigma_tot[gemm] counter=43 i=3 t=2.5e-02 per=2.6e+01 cost=3.1e+07 flops=1.3e+09
 sigma_tot[gemm] counter=43 i=4 t=1.6e-02 per=1.7e+01 cost=3.4e+07 flops=2.0e+09
 sigma_tot[gemm] counter=43 i=5 t=1.7e-02 per=1.8e+01 cost=3.5e+07 flops=2.0e+09
 sigma_tot[gemm] counter=43 total t=7.8e-02 per=8.2e+01 cost=1.3e+08 flops=1.7e+09
 sigma_tot[red] counter=43 t=1.3e-02 per=1.3e+01 cost=1.3e+07 flops=9.8e+08
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.0e-05,1.2e-05,2.0e-06,4.2e-06,4.2e-07
    8   0 +    -116.481452453825 -2.941e-08  4.235e-05    3     8  3.622e-02 4.528e-03 4.464e-03
TIMING FOR Davidson : 3.623e-02  T(cal/comm/rest)=3.571e-02,2.610e-06,5.227e-04
decomposed t_rest=5.227e-04
 T(sub)    =2.582e-04 per=4.941e+01
 T(precond)=3.160e-05 per=6.046e+00
 T(ortho)  =2.621e-05 per=5.014e+00
 T(xcopy)  =2.907e-06 per=5.562e-01
 T(xnrm2)  =4.484e-06 per=8.579e-01
 T(other)  =1.993e-04 per=3.812e+01
optimized energies: isweep=0 ibond=6 dots=1 e[0]=-116.481452453825 nmvp=8
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=4.974e-03 change=3.349e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=21 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond6.txt
 qbond: qsuper nsym=21 dimAll=188
 (10,2):25 (12,2):16 (11,3):14 (11,1):31 (9,1):14 (10,0):19 (12,0):17 (11,-1):12 (13,1):6 (8,2):5 (9,3):9 (10,4):4 (13,-1):3 (12,-2):3 (8,0):2 (9,-1):3 (13,3):1 (12,4):1 (7,3):1 (8,4):1 (10,-2):1
timing for divide=3.7e-06
timing for compute=1.5e-04
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(nkr): 1.7e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.7e-06,1.5e-04,0.0e+00,4.3e-06,1.6e-05 -----
decimation summary: 188->57 dwt=+1.110e-16 SvN=1.888e+00
 qbond: qkept nsym=12 dimAll=57
 (11,1):10 (12,2):8 (12,0):8 (13,1):6 (10,2):5 (10,0):5 (11,3):4 (11,-1):4 (13,-1):3 (9,1):2 (9,3):1 (13,3):1
----- TIMING for decimation_row(nkr): 1.405e-03 S T(decim/select/formRot)=2.591e-04,1.119e-03,2.656e-05 -----
----- TIMING FOR onedot_decimation: 1.536e-03 S T(wf/decim)=7.847e-05,1.457e-03 -----
ctns::oper_renorm coord=(7,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:16 S:12 H:1 A:61 B:67 
        dim(bra,ket)=57,57 size(op)=361:2.754e-03MB size(tot)=35158:2.682e-01MB:2.619e-04GB
        per(mem): C:11.8 S:9.18 H:1.03 A:24.3 B:53.7 
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=4.974e-03 change=3.590e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=145 : 1.737e-04 S -----
rank=0 GPUmem(GB): used=4.631e-04 (oper)=4.399e-04
rank=0 GPUmem(GB): used=4.704e-04 (oper,site)=4.399e-04,7.309e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=145
 no. of rintermediate operators=7
 no. of coefficients=161:1.228e-03MB:1.200e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.015e-05 S -----
rank=0 GPUmem(GB): used=4.716e-04 (oper,site,rinter)=4.399e-04,7.309e-06,1.200e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 8.269e-04 S size(rtasks)=145 size(Rlst2)=144 T(Rmu/Rlist)=9.468e-05,7.322e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.283e-04 S size(rtasks)=145 size(Rlst)=2941 -----
rank=0 GPUmem(GB): used=4.716e-04 avail=3.829e+01 total=3.829e+01 batch[need]=6.179e-03 blksize=100 blksize0=81 batchsize=2941
rank=0 GPUmem(GB): used=6.651e-03 (oper,site,rinter,batch)=4.399e-04,7.309e-06,1.200e-06,6.179e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=2.038e-04,1.462e-03,2.998e-04
----- TIMING FOR renorm : t_inter=2.0e-04 t_gemm=1.5e-03 t_reduction=3.0e-04 tot=2.0e-03 -----
 renorm[inter] counter=193 t=2.0e-04 per=1.0e+01 cost=2.8e+05 flops=1.4e+09
 renorm[gemm] counter=193 i=0 t=2.1e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=193 i=1 t=1.9e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=193 i=2 t=1.9e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=193 i=3 t=1.9e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=193 i=4 t=3.8e-04 per=2.0e+01 cost=9.6e+04 flops=2.5e+08
 renorm[gemm] counter=193 i=5 t=5.8e-04 per=3.0e+01 cost=9.4e+05 flops=1.6e+09
 renorm[gemm] counter=193 i=6 t=4.9e-04 per=2.5e+01 cost=1.2e+06 flops=2.4e+09
 renorm[gemm] counter=193 total t=1.5e-03 per=7.4e+01 cost=2.2e+06 flops=1.5e+09
 renorm[red] counter=193 t=3.0e-04 per=1.5e+01 cost=1.9e+05 flops=6.4e+08
----- TIMING FOR renorm_tot : t_inter=8.1e-04 t_gemm=5.7e-03 t_reduction=1.6e-03 tot=8.1e-03 -----
 renorm_tot[inter] counter=193 t=8.1e-04 per=1.0e+01 cost=5.2e+05 flops=6.4e+08
 renorm_tot[gemm] counter=193 i=0 t=1.5e-05 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=193 i=1 t=1.4e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=193 i=2 t=1.4e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=193 i=3 t=1.4e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=193 i=4 t=1.5e-03 per=1.9e+01 cost=2.2e+05 flops=1.4e+08
 renorm_tot[gemm] counter=193 i=5 t=2.1e-03 per=2.6e+01 cost=1.7e+06 flops=7.9e+08
 renorm_tot[gemm] counter=193 i=6 t=2.0e-03 per=2.5e+01 cost=2.4e+06 flops=1.2e+09
 renorm_tot[gemm] counter=193 total t=5.7e-03 per=7.1e+01 cost=4.3e+06 flops=7.4e+08
 renorm_tot[red] counter=193 t=1.6e-03 per=1.9e+01 cost=4.7e+05 flops=3.0e+08
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.894e-04 (oper)=4.419e-04
rank=0 GPUmem(GB): used=4.968e-04 (oper,site,rinter)=4.419e-04,7.309e-06,2.316e-05
rank=0 GPUmem(GB): used=7.603e-04 (oper,site,rinter,batch)=4.419e-04,7.309e-06,2.316e-05,2.635e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.276e-02 S T(preprocess/alloc/comp/red/dealloc)=2.529e-03,2.624e-03,1.799e-02,1.933e-03,1.715e-04 -----
----- TIMING FOR oper_renorm_opS : 2.282e-02 S rank=0 -----
qops.to_cpu: size(tot)=35158:2.682e-01MB:2.619e-04GB T(to_cpu)=9.499e-05S speed=2.758e+00GB/S
check ||H-H.dagger||=3.664e-14 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.0287 S rank=0 -----
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=6.554e-03 change=9.930e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=7.195e-03 change=-2.394e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=7.195e-03 change=-1.100e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 8.686e-02 S #####
 T(local opt: fetch) = 3.282e-03 S  per = 3.78  per(accum) = 3.78
 T(local opt: hdiag) = 1.410e-03 S  per = 1.62  per(accum) = 5.4
 T(local opt: dvdsn) = 4.803e-02 S  per = 55.3  per(accum) = 60.7
 T(local opt: decim) = 1.573e-03 S  per = 1.81  per(accum) = 62.5
 T(local opt: guess) = 8.002e-05 S  per = 0.0921  per(accum) = 62.6
 T(local opt: renrm) = 3.036e-02 S  per =   35  per(accum) = 97.6
 T(local opt: save ) = 2.128e-03 S  per = 2.45  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.803e-02 S  T(sum) = 4.718e-02 S  per = 9.824e+01
 T(local opt: preprocess                  ) = 1.181e-04 S  per = 0.25  per(accum) = 0.25
 T(local opt: symbolic_formulae           ) = 1.097e-03 S  per = 2.33  per(accum) = 2.58
 T(local opt: hintermediate init          ) = 8.129e-05 S  per = 0.172  per(accum) = 2.75
 T(local opt: preprocess_hformulae_Hxlist ) = 4.841e-03 S  per = 10.3  per(accum) = 13
 T(local opt: hmmtasks init               ) = 4.802e-03 S  per = 10.2  per(accum) = 23.2
 T(local opt: initial guess for dvdson    ) = 6.082e-06 S  per = 0.0129  per(accum) = 23.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.513e-02 S  per = 74.5  per(accum) = 97.7
 T(local opt: dvdson [cpu-gpu]            ) = 1.959e-04 S  per = 0.415  per(accum) = 98.1
 T(local opt: dvdson [nccl]               ) = 3.835e-04 S  per = 0.813  per(accum) = 98.9
 T(local opt: dvdson [mpi]                ) = 2.610e-06 S  per = 0.00553  per(accum) = 98.9
 T(local opt: dvdson [rest part(linalg)]  ) = 5.227e-04 S  per = 1.11  per(accum) = 100
Detailed decomposition of T(renrm) = 3.036e-02 S  T(sum) = 3.036e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.251e-05 S  per = 0.206  per(accum) = 0.206
 T(local opt: qops init                    ) = 7.549e-04 S  per = 2.49  per(accum) = 2.69
 T(local opt: symbolic_formulae_renorm     ) = 1.857e-04 S  per = 0.612  per(accum) = 3.3
 T(local opt: allocate qops on gpu         ) = 6.083e-05 S  per =  0.2  per(accum) = 3.5
 T(local opt: site memcpy cpu2gpu          ) = 2.870e-05 S  per = 0.0945  per(accum) = 3.6
 T(local opt: rintermediate init           ) = 5.530e-05 S  per = 0.182  per(accum) = 3.78
 T(local opt: preprocess_formulae_Rlist2   ) = 9.512e-04 S  per = 3.13  per(accum) = 6.91
 T(local opt: rmmtasks init                ) = 1.380e-03 S  per = 4.55  per(accum) = 11.5
 T(local opt: qops memset on cpu           ) = 7.900e-08 S  per = 0.00026  per(accum) = 11.5
 T(local opt: preprocess_renorm_batchGPU   ) = 2.145e-03 S  per = 7.07  per(accum) = 18.5
 T(local opt: deallocate cpu and gpu memory) = 1.681e-04 S  per = 0.554  per(accum) = 19.1
 T(local opt: construct opS [ifdists=true] ) = 2.284e-02 S  per = 75.2  per(accum) = 94.3
 T(local opt: reduction of opS & opH [nccl]) = 2.208e-05 S  per = 0.0727  per(accum) = 94.4
 T(local opt: qops memcpy gpu2cpu          ) = 1.070e-04 S  per = 0.352  per(accum) = 94.7
 T(local opt: reduction of opS & opH [mpi] ) = 1.336e-05 S  per = 0.044  per(accum) = 94.8
 T(local opt: qops_pool join and erase     ) = 1.584e-03 S  per = 5.22  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 6.099e-06 S  per = 0.0201  per(accum) = 100
ctns::rcanon_save_site idx=12 scratch=./scratch/sweep size=981:7.3e-06GB T(load)=0.00058S speed=0.013GB/S
##### sweep opt: 3.299e-01 S #####
 T(sweep opt: fetch) = 2.310e-02 S  per =    7  per(accum) = 7
 T(sweep opt: hdiag) = 4.431e-03 S  per = 1.34  per(accum) = 8.35
 T(sweep opt: dvdsn) = 1.386e-01 S  per =   42  per(accum) = 50.4
 T(sweep opt: decim) = 6.259e-03 S  per =  1.9  per(accum) = 52.2
 T(sweep opt: guess) = 3.403e-04 S  per = 0.103  per(accum) = 52.4
 T(sweep opt: renrm) = 1.435e-01 S  per = 43.5  per(accum) = 95.9
 T(sweep opt: save ) = 1.367e-02 S  per = 4.14  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.386e-01 S  T(sum) = 1.353e-01 S  per = 9.765e+01
 T(sweep opt: preprocess                  ) = 4.684e-04 S  per = 0.346  per(accum) = 0.346
 T(sweep opt: symbolic_formulae           ) = 3.839e-03 S  per = 2.84  per(accum) = 3.18
 T(sweep opt: hintermediate init          ) = 3.705e-04 S  per = 0.274  per(accum) = 3.46
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.137e-02 S  per =  8.4  per(accum) = 11.9
 T(sweep opt: hmmtasks init               ) = 1.122e-02 S  per = 8.29  per(accum) = 20.1
 T(sweep opt: initial guess for dvdson    ) = 2.725e-05 S  per = 0.0201  per(accum) = 20.2
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.026e-01 S  per = 75.8  per(accum) = 96
 T(sweep opt: dvdson [cpu-gpu]            ) = 9.897e-04 S  per = 0.731  per(accum) = 96.7
 T(sweep opt: dvdson [nccl]               ) = 2.001e-03 S  per = 1.48  per(accum) = 98.2
 T(sweep opt: dvdson [mpi]                ) = 1.764e-05 S  per = 0.013  per(accum) = 98.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 2.430e-03 S  per =  1.8  per(accum) = 100
Detailed decomposition of T(renrm) = 1.435e-01 S  T(sum) = 1.435e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.323e-04 S  per = 0.231  per(accum) = 0.231
 T(sweep opt: qops init                    ) = 2.898e-03 S  per = 2.02  per(accum) = 2.25
 T(sweep opt: symbolic_formulae_renorm     ) = 6.448e-04 S  per = 0.449  per(accum) = 2.7
 T(sweep opt: allocate qops on gpu         ) = 3.759e-04 S  per = 0.262  per(accum) = 2.96
 T(sweep opt: site memcpy cpu2gpu          ) = 1.601e-04 S  per = 0.112  per(accum) = 3.07
 T(sweep opt: rintermediate init           ) = 3.172e-04 S  per = 0.221  per(accum) = 3.29
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.205e-03 S  per = 2.23  per(accum) = 5.53
 T(sweep opt: rmmtasks init                ) = 3.680e-03 S  per = 2.56  per(accum) = 8.09
 T(sweep opt: qops memset on cpu           ) = 2.630e-07 S  per = 0.000183  per(accum) = 8.09
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.937e-03 S  per = 6.23  per(accum) = 14.3
 T(sweep opt: deallocate cpu and gpu memory) = 4.999e-04 S  per = 0.348  per(accum) = 14.7
 T(sweep opt: construct opS [ifdists=true] ) = 1.165e-01 S  per = 81.1  per(accum) = 95.8
 T(sweep opt: reduction of opS & opH [nccl]) = 1.508e-04 S  per = 0.105  per(accum) = 95.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.110e-04 S  per = 0.356  per(accum) = 96.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.192e-04 S  per = 0.153  per(accum) = 96.4
 T(sweep opt: qops_pool join and erase     ) = 5.127e-03 S  per = 3.57  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.116e-05 S  per = 0.00778  per(accum) = 100
##### global opt: 3.299e-01 S #####
 T(global opt: fetch) = 2.310e-02 S  per =    7  per(accum) = 7
 T(global opt: hdiag) = 4.431e-03 S  per = 1.34  per(accum) = 8.35
 T(global opt: dvdsn) = 1.386e-01 S  per =   42  per(accum) = 50.4
 T(global opt: decim) = 6.259e-03 S  per =  1.9  per(accum) = 52.2
 T(global opt: guess) = 3.403e-04 S  per = 0.103  per(accum) = 52.4
 T(global opt: renrm) = 1.435e-01 S  per = 43.5  per(accum) = 95.9
 T(global opt: save ) = 1.367e-02 S  per = 4.14  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.386e-01 S  T(sum) = 1.353e-01 S  per = 9.765e+01
 T(global opt: preprocess                  ) = 4.684e-04 S  per = 0.346  per(accum) = 0.346
 T(global opt: symbolic_formulae           ) = 3.839e-03 S  per = 2.84  per(accum) = 3.18
 T(global opt: hintermediate init          ) = 3.705e-04 S  per = 0.274  per(accum) = 3.46
 T(global opt: preprocess_hformulae_Hxlist ) = 1.137e-02 S  per =  8.4  per(accum) = 11.9
 T(global opt: hmmtasks init               ) = 1.122e-02 S  per = 8.29  per(accum) = 20.1
 T(global opt: initial guess for dvdson    ) = 2.725e-05 S  per = 0.0201  per(accum) = 20.2
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.026e-01 S  per = 75.8  per(accum) = 96
 T(global opt: dvdson [cpu-gpu]            ) = 9.897e-04 S  per = 0.731  per(accum) = 96.7
 T(global opt: dvdson [nccl]               ) = 2.001e-03 S  per = 1.48  per(accum) = 98.2
 T(global opt: dvdson [mpi]                ) = 1.764e-05 S  per = 0.013  per(accum) = 98.2
 T(global opt: dvdson [rest part(linalg)]  ) = 2.430e-03 S  per =  1.8  per(accum) = 100
Detailed decomposition of T(renrm) = 1.435e-01 S  T(sum) = 1.435e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.323e-04 S  per = 0.231  per(accum) = 0.231
 T(global opt: qops init                    ) = 2.898e-03 S  per = 2.02  per(accum) = 2.25
 T(global opt: symbolic_formulae_renorm     ) = 6.448e-04 S  per = 0.449  per(accum) = 2.7
 T(global opt: allocate qops on gpu         ) = 3.759e-04 S  per = 0.262  per(accum) = 2.96
 T(global opt: site memcpy cpu2gpu          ) = 1.601e-04 S  per = 0.112  per(accum) = 3.07
 T(global opt: rintermediate init           ) = 3.172e-04 S  per = 0.221  per(accum) = 3.29
 T(global opt: preprocess_formulae_Rlist2   ) = 3.205e-03 S  per = 2.23  per(accum) = 5.53
 T(global opt: rmmtasks init                ) = 3.680e-03 S  per = 2.56  per(accum) = 8.09
 T(global opt: qops memset on cpu           ) = 2.630e-07 S  per = 0.000183  per(accum) = 8.09
 T(global opt: preprocess_renorm_batchGPU   ) = 8.937e-03 S  per = 6.23  per(accum) = 14.3
 T(global opt: deallocate cpu and gpu memory) = 4.999e-04 S  per = 0.348  per(accum) = 14.7
 T(global opt: construct opS [ifdists=true] ) = 1.165e-01 S  per = 81.1  per(accum) = 95.8
 T(global opt: reduction of opS & opH [nccl]) = 1.508e-04 S  per = 0.105  per(accum) = 95.9
 T(global opt: qops memcpy gpu2cpu          ) = 5.110e-04 S  per = 0.356  per(accum) = 96.3
 T(global opt: reduction of opS & opH [mpi] ) = 2.192e-04 S  per = 0.153  per(accum) = 96.4
 T(global opt: qops_pool join and erase     ) = 5.127e-03 S  per = 3.57  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.116e-05 S  per = 0.00778  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-3.357e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=7/seqsize=34 dots=1 dbond=(8,0)-(9,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=10 scratch=./scratch/sweep size=1583:1.18e-05GB T(load)=3.11e-04S speed=3.79e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=2815:2.15e-02MB:2.10e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1232:9.40e-03MB:9.18e-06GB
total mem of comb=4195:3.20e-02MB:3.13e-05GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=1.988e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=8,11,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc= 19
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:16 S:12 H:1 A:61 B:67 
        dim(bra,ket)=57,57 size(op)=361:2.754e-03MB size(tot)=35158:2.682e-01MB:2.619e-04GB
        per(mem): C:11.8 S:9.18 H:1.03 A:24.3 B:53.7 
 rqops: oplist=CSHPQ nops=C:22 S:9 H:1 P:76 Q:86 
        dim(bra,ket)=65,65 size(op)=447:0.00341MB size(tot)=54987:0.42MB:0.00041GB
        per(mem): C:12.7 S:5.25 H:0.813 P:26 Q:55.2 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=92481:0.706MB:0.000689GB
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.807e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(8,0) fdel=./scratch/sweep/rop(9,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=4.120e-04 change=-4.116e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(57,65,4) nnz=1232:9.399e-03MB
qtensor3: wf3 own=1 _data=0x55b2cd982000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=12 dimAll=57
 (11,1):10 (12,2):8 (12,0):8 (13,1):6 (10,2):5 (10,0):5 (11,3):4 (11,-1):4 (13,-1):3 (9,1):2 (9,3):1 (13,3):1
 qbond: qcol nsym=13 dimAll=65
 (17,-1):12 (16,0):8 (16,-2):7 (17,1):7 (15,-1):6 (18,0):6 (18,-2):5 (17,-3):4 (19,-1):4 (15,1):3 (15,-3):1 (19,-3):1 (19,1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=36 nblocks=624 size=1232:9.399e-03MB
### DIAG TIMING: total=1.643e-03 t1=3.442e-05, t2=1.975e-05, t3=1.798e-05, t4=1.498e-03, t5=1.087e-05, t6=5.368e-05, t7=8.889e-06
duration_diagGPU:1.653e-03
duration_diagreduce:4.500e-08
duration_diagtransform:1.621e-06
----- TIMING FOR symbolic_formulae_onedot with size=662 : 1.339e-03 S -----
rank=0 GPUmem(GB): used=6.890e-04 (oper)=6.890e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=662
 no. of hintermediate operators=329
 no. of coefficients=3619:2.761e-02MB:2.696e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.864e-05 S -----
rank=0 GPUmem(GB): used=7.160e-04 (oper,hinter)=6.890e-04,2.696e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.535e-03 S size(H_formulae)=662 size(Hxlst2)=36 T(Hmu/Hxlist)=3.088e-04,6.226e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.835e-03 S size(H_formulae)=662 size(Hxlst)=18242 -----
rank=0 GPUmem(GB): used=7.160e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.836e-05 batch[need]=4.580e-02 blksize=120 blksize0=96 batchsize=18242
rank=0 GPUmem(GB): used=4.654e-02 (oper,hinter,dvdson,batch)=6.890e-04,2.696e-05,1.836e-05,4.580e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=1232 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.812e-05,2.288e-04,3.930e-03,4.832e-04,4.747e-03
 analyze_tgpu[Hx]: ndim=1232:9.179e-06GB T(cpu-gpu)=2.940e-05 speed=6.245e-01GB/S T(nccl)=5.872e-05 speed=3.126e-01GB/S
----- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=3.9e-03 t_reduction=4.8e-04 tot=4.6e-03 -----
 sigma[inter] counter=44 t=2.3e-04 per=4.9e+00 cost=7.0e+06 flops=3.1e+10
 sigma[gemm] counter=44 i=0 t=1.9e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=1 t=1.7e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=44 i=2 t=9.6e-04 per=2.1e+01 cost=3.9e+06 flops=4.1e+09
 sigma[gemm] counter=44 i=3 t=1.2e-03 per=2.6e+01 cost=3.9e+06 flops=3.3e+09
 sigma[gemm] counter=44 i=4 t=8.5e-04 per=1.8e+01 cost=4.3e+06 flops=5.1e+09
 sigma[gemm] counter=44 i=5 t=9.3e-04 per=2.0e+01 cost=4.6e+06 flops=5.0e+09
 sigma[gemm] counter=44 total t=3.9e-03 per=8.5e+01 cost=1.7e+07 flops=4.3e+09
 sigma[red] counter=44 t=4.8e-04 per=1.0e+01 cost=1.4e+06 flops=2.9e+09
----- TIMING FOR sigma_tot : t_inter=4.9e-03 t_gemm=8.2e-02 t_reduction=1.3e-02 tot=1.0e-01 -----
 sigma_tot[inter] counter=44 t=4.9e-03 per=4.9e+00 cost=7.6e+07 flops=1.6e+10
 sigma_tot[gemm] counter=44 i=0 t=9.5e-05 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=1 t=8.8e-05 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=44 i=2 t=2.0e-02 per=2.0e+01 cost=3.5e+07 flops=1.7e+09
 sigma_tot[gemm] counter=44 i=3 t=2.6e-02 per=2.6e+01 cost=3.5e+07 flops=1.4e+09
 sigma_tot[gemm] counter=44 i=4 t=1.7e-02 per=1.7e+01 cost=3.8e+07 flops=2.2e+09
 sigma_tot[gemm] counter=44 i=5 t=1.8e-02 per=1.8e+01 cost=4.0e+07 flops=2.2e+09
 sigma_tot[gemm] counter=44 total t=8.2e-02 per=8.2e+01 cost=1.5e+08 flops=1.8e+09
 sigma_tot[red] counter=44 t=1.3e-02 per=1.3e+01 cost=1.4e+07 flops=1.1e+09
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,5.6e-06,1.3e-06,3.7e-06,5.5e-07
settings: ndim=1232 neig=1 maxcycle=30 nbuff=4 memory=0.0001GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.481452453825 -1.116e+03  7.748e-02    1     1  5.136e-03 5.136e-03 5.068e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.198e-05,1.976e-04,5.144e-03,5.400e-04,5.962e-03
 analyze_tgpu[Hx]: ndim=1232:9.179e-06GB T(cpu-gpu)=2.425e-05 speed=7.571e-01GB/S T(nccl)=4.773e-05 speed=3.846e-01GB/S
----- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=5.1e-03 t_reduction=5.4e-04 tot=5.9e-03 -----
 sigma[inter] counter=45 t=2.0e-04 per=3.4e+00 cost=7.0e+06 flops=3.5e+10
 sigma[gemm] counter=45 i=0 t=2.2e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=1 t=2.0e-06 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=45 i=2 t=1.2e-03 per=2.0e+01 cost=3.9e+06 flops=3.3e+09
 sigma[gemm] counter=45 i=3 t=1.7e-03 per=2.9e+01 cost=3.9e+06 flops=2.3e+09
 sigma[gemm] counter=45 i=4 t=1.1e-03 per=1.8e+01 cost=4.3e+06 flops=4.0e+09
 sigma[gemm] counter=45 i=5 t=1.2e-03 per=2.0e+01 cost=4.6e+06 flops=3.9e+09
 sigma[gemm] counter=45 total t=5.1e-03 per=8.7e+01 cost=1.7e+07 flops=3.2e+09
 sigma[red] counter=45 t=5.4e-04 per=9.2e+00 cost=1.4e+06 flops=2.6e+09
----- TIMING FOR sigma_tot : t_inter=5.1e-03 t_gemm=8.7e-02 t_reduction=1.4e-02 tot=1.1e-01 -----
 sigma_tot[inter] counter=45 t=5.1e-03 per=4.8e+00 cost=8.3e+07 flops=1.6e+10
 sigma_tot[gemm] counter=45 i=0 t=9.8e-05 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=1 t=9.0e-05 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=45 i=2 t=2.2e-02 per=2.0e+01 cost=3.9e+07 flops=1.8e+09
 sigma_tot[gemm] counter=45 i=3 t=2.7e-02 per=2.6e+01 cost=3.9e+07 flops=1.4e+09
 sigma_tot[gemm] counter=45 i=4 t=1.8e-02 per=1.7e+01 cost=4.2e+07 flops=2.3e+09
 sigma_tot[gemm] counter=45 i=5 t=2.0e-02 per=1.8e+01 cost=4.4e+07 flops=2.3e+09
 sigma_tot[gemm] counter=45 total t=8.7e-02 per=8.2e+01 cost=1.6e+08 flops=1.9e+09
 sigma_tot[red] counter=45 t=1.4e-02 per=1.3e+01 cost=1.5e+07 flops=1.1e+09
T(sub)=5.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,2.5e-05,2.9e-06,3.7e-06,5.7e-07
    2   0 -    -116.490078606450 -8.626e-03  2.069e-02    2     2  1.149e-02 5.744e-03 5.653e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.760e-05,2.004e-04,4.926e-03,4.819e-04,5.689e-03
 analyze_tgpu[Hx]: ndim=1232:9.179e-06GB T(cpu-gpu)=2.061e-05 speed=8.907e-01GB/S T(nccl)=4.699e-05 speed=3.907e-01GB/S
----- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=4.9e-03 t_reduction=4.8e-04 tot=5.6e-03 -----
 sigma[inter] counter=46 t=2.0e-04 per=3.6e+00 cost=7.0e+06 flops=3.5e+10
 sigma[gemm] counter=46 i=0 t=2.6e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=1 t=2.1e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=46 i=2 t=1.2e-03 per=2.1e+01 cost=3.9e+06 flops=3.3e+09
 sigma[gemm] counter=46 i=3 t=1.7e-03 per=3.0e+01 cost=3.9e+06 flops=2.3e+09
 sigma[gemm] counter=46 i=4 t=9.9e-04 per=1.8e+01 cost=4.3e+06 flops=4.3e+09
 sigma[gemm] counter=46 i=5 t=1.1e-03 per=1.9e+01 cost=4.6e+06 flops=4.3e+09
 sigma[gemm] counter=46 total t=4.9e-03 per=8.8e+01 cost=1.7e+07 flops=3.4e+09
 sigma[red] counter=46 t=4.8e-04 per=8.6e+00 cost=1.4e+06 flops=2.9e+09
----- TIMING FOR sigma_tot : t_inter=5.3e-03 t_gemm=9.2e-02 t_reduction=1.4e-02 tot=1.1e-01 -----
 sigma_tot[inter] counter=46 t=5.3e-03 per=4.7e+00 cost=9.0e+07 flops=1.7e+10
 sigma_tot[gemm] counter=46 i=0 t=1.0e-04 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=1 t=9.2e-05 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=46 i=2 t=2.3e-02 per=2.0e+01 cost=4.3e+07 flops=1.9e+09
 sigma_tot[gemm] counter=46 i=3 t=2.9e-02 per=2.6e+01 cost=4.3e+07 flops=1.5e+09
 sigma_tot[gemm] counter=46 i=4 t=1.9e-02 per=1.7e+01 cost=4.7e+07 flops=2.4e+09
 sigma_tot[gemm] counter=46 i=5 t=2.1e-02 per=1.9e+01 cost=4.9e+07 flops=2.4e+09
 sigma_tot[gemm] counter=46 total t=9.2e-02 per=8.2e+01 cost=1.8e+08 flops=2.0e+09
 sigma_tot[red] counter=46 t=1.4e-02 per=1.3e+01 cost=1.7e+07 flops=1.2e+09
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,2.2e-05,2.1e-06,4.7e-06,4.4e-07
    3   0 -    -116.490750378392 -6.718e-04  7.787e-03    3     3  1.732e-02 5.772e-03 5.686e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.774e-05,1.923e-04,4.749e-03,4.528e-04,5.468e-03
 analyze_tgpu[Hx]: ndim=1232:9.179e-06GB T(cpu-gpu)=2.244e-05 speed=8.180e-01GB/S T(nccl)=4.530e-05 speed=4.053e-01GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=4.7e-03 t_reduction=4.5e-04 tot=5.4e-03 -----
 sigma[inter] counter=47 t=1.9e-04 per=3.6e+00 cost=7.0e+06 flops=3.6e+10
 sigma[gemm] counter=47 i=0 t=2.5e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=1 t=2.0e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=47 i=2 t=1.1e-03 per=2.1e+01 cost=3.9e+06 flops=3.4e+09
 sigma[gemm] counter=47 i=3 t=1.6e-03 per=2.9e+01 cost=3.9e+06 flops=2.5e+09
 sigma[gemm] counter=47 i=4 t=9.8e-04 per=1.8e+01 cost=4.3e+06 flops=4.4e+09
 sigma[gemm] counter=47 i=5 t=1.1e-03 per=2.0e+01 cost=4.6e+06 flops=4.3e+09
 sigma[gemm] counter=47 total t=4.7e-03 per=8.8e+01 cost=1.7e+07 flops=3.5e+09
 sigma[red] counter=47 t=4.5e-04 per=8.4e+00 cost=1.4e+06 flops=3.1e+09
----- TIMING FOR sigma_tot : t_inter=5.5e-03 t_gemm=9.7e-02 t_reduction=1.5e-02 tot=1.2e-01 -----
 sigma_tot[inter] counter=47 t=5.5e-03 per=4.7e+00 cost=9.7e+07 flops=1.8e+10
 sigma_tot[gemm] counter=47 i=0 t=1.0e-04 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=1 t=9.4e-05 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=47 i=2 t=2.4e-02 per=2.0e+01 cost=4.7e+07 flops=2.0e+09
 sigma_tot[gemm] counter=47 i=3 t=3.1e-02 per=2.6e+01 cost=4.7e+07 flops=1.5e+09
 sigma_tot[gemm] counter=47 i=4 t=2.0e-02 per=1.7e+01 cost=5.1e+07 flops=2.5e+09
 sigma_tot[gemm] counter=47 i=5 t=2.2e-02 per=1.9e+01 cost=5.4e+07 flops=2.5e+09
 sigma_tot[gemm] counter=47 total t=9.7e-02 per=8.3e+01 cost=2.0e+08 flops=2.0e+09
 sigma_tot[red] counter=47 t=1.5e-02 per=1.3e+01 cost=1.8e+07 flops=1.2e+09
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.3e-05,1.8e-06,4.5e-06,4.8e-07
    4   0 -    -116.490853229432 -1.029e-04  3.317e-03    3     4  2.291e-02 5.728e-03 5.648e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.943e-05,2.006e-04,4.746e-03,4.481e-04,5.470e-03
 analyze_tgpu[Hx]: ndim=1232:9.179e-06GB T(cpu-gpu)=2.336e-05 speed=7.858e-01GB/S T(nccl)=4.607e-05 speed=3.985e-01GB/S
----- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=4.7e-03 t_reduction=4.5e-04 tot=5.4e-03 -----
 sigma[inter] counter=48 t=2.0e-04 per=3.7e+00 cost=7.0e+06 flops=3.5e+10
 sigma[gemm] counter=48 i=0 t=2.1e-06 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=1 t=2.0e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=48 i=2 t=1.2e-03 per=2.2e+01 cost=3.9e+06 flops=3.3e+09
 sigma[gemm] counter=48 i=3 t=1.5e-03 per=2.8e+01 cost=3.9e+06 flops=2.6e+09
 sigma[gemm] counter=48 i=4 t=9.8e-04 per=1.8e+01 cost=4.3e+06 flops=4.4e+09
 sigma[gemm] counter=48 i=5 t=1.1e-03 per=2.0e+01 cost=4.6e+06 flops=4.3e+09
 sigma[gemm] counter=48 total t=4.7e-03 per=8.8e+01 cost=1.7e+07 flops=3.5e+09
 sigma[red] counter=48 t=4.5e-04 per=8.3e+00 cost=1.4e+06 flops=3.2e+09
----- TIMING FOR sigma_tot : t_inter=5.7e-03 t_gemm=1.0e-01 t_reduction=1.5e-02 tot=1.2e-01 -----
 sigma_tot[inter] counter=48 t=5.7e-03 per=4.6e+00 cost=1.0e+08 flops=1.8e+10
 sigma_tot[gemm] counter=48 i=0 t=1.0e-04 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=1 t=9.6e-05 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=48 i=2 t=2.5e-02 per=2.0e+01 cost=5.1e+07 flops=2.0e+09
 sigma_tot[gemm] counter=48 i=3 t=3.2e-02 per=2.6e+01 cost=5.0e+07 flops=1.6e+09
 sigma_tot[gemm] counter=48 i=4 t=2.1e-02 per=1.7e+01 cost=5.5e+07 flops=2.6e+09
 sigma_tot[gemm] counter=48 i=5 t=2.3e-02 per=1.9e+01 cost=5.8e+07 flops=2.6e+09
 sigma_tot[gemm] counter=48 total t=1.0e-01 per=8.3e+01 cost=2.1e+08 flops=2.1e+09
 sigma_tot[red] counter=48 t=1.5e-02 per=1.2e+01 cost=2.0e+07 flops=1.3e+09
T(sub)=3.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.2e-05,1.8e-06,4.6e-06,4.8e-07
    5   0 -    -116.490869026221 -1.580e-05  1.203e-03    3     5  2.851e-02 5.701e-03 5.626e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.779e-05,1.905e-04,4.705e-03,4.654e-04,5.435e-03
 analyze_tgpu[Hx]: ndim=1232:9.179e-06GB T(cpu-gpu)=2.259e-05 speed=8.128e-01GB/S T(nccl)=4.520e-05 speed=4.061e-01GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=4.7e-03 t_reduction=4.7e-04 tot=5.4e-03 -----
 sigma[inter] counter=49 t=1.9e-04 per=3.6e+00 cost=7.0e+06 flops=3.7e+10
 sigma[gemm] counter=49 i=0 t=2.1e-06 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=1 t=2.0e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=49 i=2 t=1.1e-03 per=2.1e+01 cost=3.9e+06 flops=3.4e+09
 sigma[gemm] counter=49 i=3 t=1.5e-03 per=2.8e+01 cost=3.9e+06 flops=2.6e+09
 sigma[gemm] counter=49 i=4 t=9.7e-04 per=1.8e+01 cost=4.3e+06 flops=4.4e+09
 sigma[gemm] counter=49 i=5 t=1.1e-03 per=2.0e+01 cost=4.6e+06 flops=4.3e+09
 sigma[gemm] counter=49 total t=4.7e-03 per=8.8e+01 cost=1.7e+07 flops=3.6e+09
 sigma[red] counter=49 t=4.7e-04 per=8.7e+00 cost=1.4e+06 flops=3.1e+09
----- TIMING FOR sigma_tot : t_inter=5.9e-03 t_gemm=1.1e-01 t_reduction=1.6e-02 tot=1.3e-01 -----
 sigma_tot[inter] counter=49 t=5.9e-03 per=4.6e+00 cost=1.1e+08 flops=1.9e+10
 sigma_tot[gemm] counter=49 i=0 t=1.1e-04 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=1 t=9.8e-05 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=49 i=2 t=2.6e-02 per=2.0e+01 cost=5.4e+07 flops=2.1e+09
 sigma_tot[gemm] counter=49 i=3 t=3.4e-02 per=2.6e+01 cost=5.4e+07 flops=1.6e+09
 sigma_tot[gemm] counter=49 i=4 t=2.2e-02 per=1.7e+01 cost=5.9e+07 flops=2.7e+09
 sigma_tot[gemm] counter=49 i=5 t=2.4e-02 per=1.9e+01 cost=6.3e+07 flops=2.6e+09
 sigma_tot[gemm] counter=49 total t=1.1e-01 per=8.3e+01 cost=2.3e+08 flops=2.2e+09
 sigma_tot[red] counter=49 t=1.6e-02 per=1.2e+01 cost=2.1e+07 flops=1.3e+09
T(sub)=3.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.3e-05,1.2e-05,1.9e-06,4.4e-06,4.7e-07
    6   0 -    -116.490871733578 -2.707e-06  4.587e-04    3     6  3.437e-02 5.728e-03 5.653e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.796e-05,1.948e-04,4.758e-03,4.515e-04,5.479e-03
 analyze_tgpu[Hx]: ndim=1232:9.179e-06GB T(cpu-gpu)=2.239e-05 speed=8.200e-01GB/S T(nccl)=4.557e-05 speed=4.028e-01GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=4.8e-03 t_reduction=4.5e-04 tot=5.4e-03 -----
 sigma[inter] counter=50 t=1.9e-04 per=3.6e+00 cost=7.0e+06 flops=3.6e+10
 sigma[gemm] counter=50 i=0 t=2.5e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=1 t=2.0e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=50 i=2 t=1.1e-03 per=2.1e+01 cost=3.9e+06 flops=3.4e+09
 sigma[gemm] counter=50 i=3 t=1.5e-03 per=2.8e+01 cost=3.9e+06 flops=2.6e+09
 sigma[gemm] counter=50 i=4 t=9.7e-04 per=1.8e+01 cost=4.3e+06 flops=4.4e+09
 sigma[gemm] counter=50 i=5 t=1.1e-03 per=2.1e+01 cost=4.6e+06 flops=4.1e+09
 sigma[gemm] counter=50 total t=4.8e-03 per=8.8e+01 cost=1.7e+07 flops=3.5e+09
 sigma[red] counter=50 t=4.5e-04 per=8.4e+00 cost=1.4e+06 flops=3.1e+09
----- TIMING FOR sigma_tot : t_inter=6.1e-03 t_gemm=1.1e-01 t_reduction=1.6e-02 tot=1.3e-01 -----
 sigma_tot[inter] counter=50 t=6.1e-03 per=4.6e+00 cost=1.2e+08 flops=2.0e+10
 sigma_tot[gemm] counter=50 i=0 t=1.1e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=1 t=1.0e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=50 i=2 t=2.7e-02 per=2.1e+01 cost=5.8e+07 flops=2.1e+09
 sigma_tot[gemm] counter=50 i=3 t=3.5e-02 per=2.6e+01 cost=5.8e+07 flops=1.7e+09
 sigma_tot[gemm] counter=50 i=4 t=2.3e-02 per=1.7e+01 cost=6.4e+07 flops=2.7e+09
 sigma_tot[gemm] counter=50 i=5 t=2.5e-02 per=1.9e+01 cost=6.7e+07 flops=2.7e+09
 sigma_tot[gemm] counter=50 total t=1.1e-01 per=8.3e+01 cost=2.5e+08 flops=2.2e+09
 sigma_tot[red] counter=50 t=1.6e-02 per=1.2e+01 cost=2.2e+07 flops=1.4e+09
T(sub)=3.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.2e-05,1.8e-06,4.5e-06,4.7e-07
    7   0 -    -116.490872106885 -3.733e-07  1.592e-04    3     7  4.021e-02 5.744e-03 5.671e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.869e-05,1.993e-04,4.699e-03,4.643e-04,5.438e-03
 analyze_tgpu[Hx]: ndim=1232:9.179e-06GB T(cpu-gpu)=2.303e-05 speed=7.972e-01GB/S T(nccl)=4.566e-05 speed=4.020e-01GB/S
----- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=4.7e-03 t_reduction=4.6e-04 tot=5.4e-03 -----
 sigma[inter] counter=51 t=2.0e-04 per=3.7e+00 cost=7.0e+06 flops=3.5e+10
 sigma[gemm] counter=51 i=0 t=2.6e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=1 t=2.1e-06 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=51 i=2 t=1.1e-03 per=2.1e+01 cost=3.9e+06 flops=3.4e+09
 sigma[gemm] counter=51 i=3 t=1.5e-03 per=2.8e+01 cost=3.9e+06 flops=2.6e+09
 sigma[gemm] counter=51 i=4 t=9.8e-04 per=1.8e+01 cost=4.3e+06 flops=4.4e+09
 sigma[gemm] counter=51 i=5 t=1.1e-03 per=2.0e+01 cost=4.6e+06 flops=4.3e+09
 sigma[gemm] counter=51 total t=4.7e-03 per=8.8e+01 cost=1.7e+07 flops=3.6e+09
 sigma[red] counter=51 t=4.6e-04 per=8.7e+00 cost=1.4e+06 flops=3.1e+09
----- TIMING FOR sigma_tot : t_inter=6.3e-03 t_gemm=1.2e-01 t_reduction=1.7e-02 tot=1.4e-01 -----
 sigma_tot[inter] counter=51 t=6.3e-03 per=4.5e+00 cost=1.3e+08 flops=2.0e+10
 sigma_tot[gemm] counter=51 i=0 t=1.1e-04 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=1 t=1.0e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=51 i=2 t=2.8e-02 per=2.1e+01 cost=6.2e+07 flops=2.2e+09
 sigma_tot[gemm] counter=51 i=3 t=3.7e-02 per=2.7e+01 cost=6.2e+07 flops=1.7e+09
 sigma_tot[gemm] counter=51 i=4 t=2.4e-02 per=1.8e+01 cost=6.8e+07 flops=2.8e+09
 sigma_tot[gemm] counter=51 i=5 t=2.6e-02 per=1.9e+01 cost=7.2e+07 flops=2.8e+09
 sigma_tot[gemm] counter=51 total t=1.2e-01 per=8.4e+01 cost=2.6e+08 flops=2.3e+09
 sigma_tot[red] counter=51 t=1.7e-02 per=1.2e+01 cost=2.4e+07 flops=1.4e+09
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.1e-05,1.9e-06,4.5e-06,4.5e-07
    8   0 +    -116.490872151426 -4.454e-08  5.148e-05    3     8  4.602e-02 5.753e-03 5.681e-03
TIMING FOR Davidson : 4.604e-02  T(cal/comm/rest)=4.544e-02,3.019e-06,5.878e-04
decomposed t_rest=5.878e-04
 T(sub)    =2.701e-04 per=4.595e+01
 T(precond)=6.860e-05 per=1.167e+01
 T(ortho)  =2.827e-05 per=4.810e+00
 T(xcopy)  =2.857e-06 per=4.860e-01
 T(xnrm2)  =4.217e-06 per=7.174e-01
 T(other)  =2.138e-04 per=3.637e+01
optimized energies: isweep=0 ibond=7 dots=1 e[0]=-116.490872151426 nmvp=8
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=7.584e-03 change=4.486e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=22 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond7.txt
 qbond: qsuper nsym=22 dimAll=228
 (11,1):22 (13,1):32 (12,2):27 (12,0):27 (14,2):15 (13,3):13 (14,0):17 (13,-1):15 (15,1):6 (10,2):8 (11,3):10 (10,0):7 (11,-1):9 (12,4):4 (12,-2):4 (15,-1):3 (14,-2):3 (9,1):2 (9,3):1 (10,4):1 (15,3):1 (14,4):1
timing for divide=3.6e-06
timing for compute=2.6e-04
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(nkr): 2.8e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.6e-06,2.5e-04,0.0e+00,1.3e-05,1.5e-05 -----
decimation summary: 228->65 dwt=+0.000e+00 SvN=1.967e+00
 qbond: qkept nsym=13 dimAll=65
 (13,1):12 (14,0):8 (14,2):7 (13,-1):7 (12,0):6 (15,1):6 (12,2):5 (11,1):4 (13,3):4 (15,-1):3 (11,3):1 (11,-1):1 (15,3):1
----- TIMING for decimation_row(nkr): 1.462e-03 S T(decim/select/formRot)=3.200e-04,1.121e-03,2.133e-05 -----
----- TIMING FOR onedot_decimation: 1.518e-03 S T(wf/decim)=4.733e-05,1.471e-03 -----
ctns::oper_renorm coord=(8,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:18 S:11 H:1 A:76 B:86 
        dim(bra,ket)=65,65 size(op)=447:3.410e-03MB size(tot)=54361:4.147e-01MB:4.050e-04GB
        per(mem): C:10.5 S:6.5 H:0.822 A:26.3 B:55.9 
rank=0 CPUmem(GB): used=1.352e+00 pageheap_free=7.233e-03 change=5.186e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=181 : 2.374e-04 S -----
rank=0 GPUmem(GB): used=7.113e-04 (oper)=6.844e-04
rank=0 GPUmem(GB): used=7.205e-04 (oper,site)=6.844e-04,9.179e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=181
 no. of rintermediate operators=7
 no. of coefficients=204:1.556e-03MB:1.520e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.929e-05 S -----
rank=0 GPUmem(GB): used=7.220e-04 (oper,site,rinter)=6.844e-04,9.179e-06,1.520e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.173e-03 S size(rtasks)=181 size(Rlst2)=169 T(Rmu/Rlist)=1.376e-04,1.036e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.339e-03 S size(rtasks)=181 size(Rlst)=4081 -----
rank=0 GPUmem(GB): used=7.220e-04 avail=3.829e+01 total=3.829e+01 batch[need]=1.183e-02 blksize=144 blksize0=100 batchsize=4081
rank=0 GPUmem(GB): used=1.255e-02 (oper,site,rinter,batch)=6.844e-04,9.179e-06,1.520e-06,1.183e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.803e-04,1.788e-03,4.395e-04
----- TIMING FOR renorm : t_inter=1.8e-04 t_gemm=1.8e-03 t_reduction=4.4e-04 tot=2.4e-03 -----
 renorm[inter] counter=218 t=1.8e-04 per=7.5e+00 cost=4.4e+05 flops=2.4e+09
 renorm[gemm] counter=218 i=0 t=1.8e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=218 i=1 t=1.7e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=218 i=2 t=1.7e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=218 i=3 t=1.7e-06 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=218 i=4 t=3.9e-04 per=1.6e+01 cost=1.3e+05 flops=3.4e+08
 renorm[gemm] counter=218 i=5 t=7.0e-04 per=2.9e+01 cost=1.6e+06 flops=2.3e+09
 renorm[gemm] counter=218 i=6 t=6.9e-04 per=2.9e+01 cost=2.0e+06 flops=2.9e+09
 renorm[gemm] counter=218 total t=1.8e-03 per=7.4e+01 cost=3.7e+06 flops=2.1e+09
 renorm[red] counter=218 t=4.4e-04 per=1.8e+01 cost=3.1e+05 flops=7.1e+08
----- TIMING FOR renorm_tot : t_inter=9.9e-04 t_gemm=7.5e-03 t_reduction=2.0e-03 tot=1.0e-02 -----
 renorm_tot[inter] counter=218 t=9.9e-04 per=9.4e+00 cost=9.6e+05 flops=9.7e+08
 renorm_tot[gemm] counter=218 i=0 t=1.7e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=218 i=1 t=1.5e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=218 i=2 t=1.5e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=218 i=3 t=1.5e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=218 i=4 t=1.9e-03 per=1.8e+01 cost=3.5e+05 flops=1.8e+08
 renorm_tot[gemm] counter=218 i=5 t=2.8e-03 per=2.7e+01 cost=3.3e+06 flops=1.2e+09
 renorm_tot[gemm] counter=218 i=6 t=2.7e-03 per=2.6e+01 cost=4.4e+06 flops=1.6e+09
 renorm_tot[gemm] counter=218 total t=7.5e-03 per=7.2e+01 cost=8.0e+06 flops=1.1e+09
 renorm_tot[red] counter=218 t=2.0e-03 per=1.9e+01 cost=7.8e+05 flops=3.9e+08
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=7.422e-04 (oper)=6.868e-04
rank=0 GPUmem(GB): used=7.514e-04 (oper,site,rinter)=6.868e-04,9.179e-06,2.696e-05
rank=0 GPUmem(GB): used=1.107e-03 (oper,site,rinter,batch)=6.868e-04,9.179e-06,2.696e-05,3.557e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.437e-02 S T(preprocess/alloc/comp/red/dealloc)=2.676e-03,2.718e-03,1.902e-02,2.419e-03,1.692e-04 -----
----- TIMING FOR oper_renorm_opS : 2.442e-02 S rank=0 -----
qops.to_cpu: size(tot)=54361:4.147e-01MB:4.050e-04GB T(to_cpu)=1.771e-04S speed=2.287e+00GB/S
check ||H-H.dagger||=5.420e-14 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.0319 S rank=0 -----
rank=0 CPUmem(GB): used=1.353e+00 pageheap_free=8.682e-03 change=1.402e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=1.157e-02 change=-3.004e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=1.157e-02 change=-1.332e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 1.049e-01 S #####
 T(local opt: fetch) = 3.967e-03 S  per = 3.78  per(accum) = 3.78
 T(local opt: hdiag) = 1.697e-03 S  per = 1.62  per(accum) = 5.4
 T(local opt: dvdsn) = 6.260e-02 S  per = 59.7  per(accum) = 65.1
 T(local opt: decim) = 1.578e-03 S  per =  1.5  per(accum) = 66.6
 T(local opt: guess) = 9.276e-05 S  per = 0.0884  per(accum) = 66.7
 T(local opt: renrm) = 3.272e-02 S  per = 31.2  per(accum) = 97.9
 T(local opt: save ) = 2.236e-03 S  per = 2.13  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.260e-02 S  T(sum) = 6.186e-02 S  per = 9.883e+01
 T(local opt: preprocess                  ) = 1.252e-04 S  per = 0.202  per(accum) = 0.202
 T(local opt: symbolic_formulae           ) = 1.347e-03 S  per = 2.18  per(accum) = 2.38
 T(local opt: hintermediate init          ) = 6.684e-05 S  per = 0.108  per(accum) = 2.49
 T(local opt: preprocess_hformulae_Hxlist ) = 8.124e-03 S  per = 13.1  per(accum) = 15.6
 T(local opt: hmmtasks init               ) = 6.156e-03 S  per = 9.95  per(accum) = 25.6
 T(local opt: initial guess for dvdson    ) = 1.090e-05 S  per = 0.0176  per(accum) = 25.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 4.488e-02 S  per = 72.5  per(accum) = 98.1
 T(local opt: dvdson [cpu-gpu]            ) = 1.881e-04 S  per = 0.304  per(accum) = 98.4
 T(local opt: dvdson [nccl]               ) = 3.813e-04 S  per = 0.616  per(accum) = 99
 T(local opt: dvdson [mpi]                ) = 3.019e-06 S  per = 0.00488  per(accum) = 99
 T(local opt: dvdson [rest part(linalg)]  ) = 5.878e-04 S  per = 0.95  per(accum) = 100
Detailed decomposition of T(renrm) = 3.272e-02 S  T(sum) = 3.272e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.855e-05 S  per = 0.209  per(accum) = 0.209
 T(local opt: qops init                    ) = 9.725e-04 S  per = 2.97  per(accum) = 3.18
 T(local opt: symbolic_formulae_renorm     ) = 2.424e-04 S  per = 0.741  per(accum) = 3.92
 T(local opt: allocate qops on gpu         ) = 5.577e-05 S  per = 0.17  per(accum) = 4.09
 T(local opt: site memcpy cpu2gpu          ) = 2.747e-05 S  per = 0.084  per(accum) = 4.18
 T(local opt: rintermediate init           ) = 3.608e-05 S  per = 0.11  per(accum) = 4.29
 T(local opt: preprocess_formulae_Rlist2   ) = 1.374e-03 S  per =  4.2  per(accum) = 8.49
 T(local opt: rmmtasks init                ) = 1.723e-03 S  per = 5.27  per(accum) = 13.8
 T(local opt: qops memset on cpu           ) = 4.500e-08 S  per = 0.000138  per(accum) = 13.8
 T(local opt: preprocess_renorm_batchGPU   ) = 2.477e-03 S  per = 7.57  per(accum) = 21.3
 T(local opt: deallocate cpu and gpu memory) = 2.516e-04 S  per = 0.769  per(accum) = 22.1
 T(local opt: construct opS [ifdists=true] ) = 2.447e-02 S  per = 74.8  per(accum) = 96.9
 T(local opt: reduction of opS & opH [nccl]) = 2.122e-05 S  per = 0.0649  per(accum) = 96.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.890e-04 S  per = 0.578  per(accum) = 97.5
 T(local opt: reduction of opS & opH [mpi] ) = 1.349e-05 S  per = 0.0412  per(accum) = 97.6
 T(local opt: qops_pool join and erase     ) = 7.975e-04 S  per = 2.44  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.325e-06 S  per = 0.00405  per(accum) = 100
ctns::rcanon_save_site idx=11 scratch=./scratch/sweep size=1232:9.2e-06GB T(load)=0.00057S speed=0.016GB/S
##### sweep opt: 4.348e-01 S #####
 T(sweep opt: fetch) = 2.707e-02 S  per = 6.23  per(accum) = 6.23
 T(sweep opt: hdiag) = 6.128e-03 S  per = 1.41  per(accum) = 7.64
 T(sweep opt: dvdsn) = 2.012e-01 S  per = 46.3  per(accum) = 53.9
 T(sweep opt: decim) = 7.837e-03 S  per =  1.8  per(accum) = 55.7
 T(sweep opt: guess) = 4.331e-04 S  per = 0.0996  per(accum) = 55.8
 T(sweep opt: renrm) = 1.762e-01 S  per = 40.5  per(accum) = 96.3
 T(sweep opt: save ) = 1.591e-02 S  per = 3.66  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.012e-01 S  T(sum) = 1.972e-01 S  per = 9.802e+01
 T(sweep opt: preprocess                  ) = 5.935e-04 S  per = 0.301  per(accum) = 0.301
 T(sweep opt: symbolic_formulae           ) = 5.186e-03 S  per = 2.63  per(accum) = 2.93
 T(sweep opt: hintermediate init          ) = 4.374e-04 S  per = 0.222  per(accum) = 3.15
 T(sweep opt: preprocess_hformulae_Hxlist ) = 1.949e-02 S  per = 9.89  per(accum) = 13
 T(sweep opt: hmmtasks init               ) = 1.737e-02 S  per = 8.81  per(accum) = 21.8
 T(sweep opt: initial guess for dvdson    ) = 3.814e-05 S  per = 0.0193  per(accum) = 21.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.475e-01 S  per = 74.8  per(accum) = 96.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.178e-03 S  per = 0.597  per(accum) = 97.3
 T(sweep opt: dvdson [nccl]               ) = 2.382e-03 S  per = 1.21  per(accum) = 98.5
 T(sweep opt: dvdson [mpi]                ) = 2.066e-05 S  per = 0.0105  per(accum) = 98.5
 T(sweep opt: dvdson [rest part(linalg)]  ) = 3.018e-03 S  per = 1.53  per(accum) = 100
Detailed decomposition of T(renrm) = 1.762e-01 S  T(sum) = 1.762e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.008e-04 S  per = 0.227  per(accum) = 0.227
 T(sweep opt: qops init                    ) = 3.870e-03 S  per =  2.2  per(accum) = 2.42
 T(sweep opt: symbolic_formulae_renorm     ) = 8.871e-04 S  per = 0.503  per(accum) = 2.93
 T(sweep opt: allocate qops on gpu         ) = 4.317e-04 S  per = 0.245  per(accum) = 3.17
 T(sweep opt: site memcpy cpu2gpu          ) = 1.876e-04 S  per = 0.106  per(accum) = 3.28
 T(sweep opt: rintermediate init           ) = 3.532e-04 S  per =  0.2  per(accum) = 3.48
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.579e-03 S  per =  2.6  per(accum) = 6.08
 T(sweep opt: rmmtasks init                ) = 5.403e-03 S  per = 3.07  per(accum) = 9.14
 T(sweep opt: qops memset on cpu           ) = 3.080e-07 S  per = 0.000175  per(accum) = 9.14
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.141e-02 S  per = 6.48  per(accum) = 15.6
 T(sweep opt: deallocate cpu and gpu memory) = 7.515e-04 S  per = 0.426  per(accum) = 16
 T(sweep opt: construct opS [ifdists=true] ) = 1.409e-01 S  per =   80  per(accum) = 96
 T(sweep opt: reduction of opS & opH [nccl]) = 1.720e-04 S  per = 0.0976  per(accum) = 96.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.001e-04 S  per = 0.397  per(accum) = 96.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.327e-04 S  per = 0.132  per(accum) = 96.6
 T(sweep opt: qops_pool join and erase     ) = 5.925e-03 S  per = 3.36  per(accum) = 100
 T(sweep opt: conversion from opAB to opPQ ) = 1.249e-05 S  per = 0.00709  per(accum) = 100
##### global opt: 4.348e-01 S #####
 T(global opt: fetch) = 2.707e-02 S  per = 6.23  per(accum) = 6.23
 T(global opt: hdiag) = 6.128e-03 S  per = 1.41  per(accum) = 7.64
 T(global opt: dvdsn) = 2.012e-01 S  per = 46.3  per(accum) = 53.9
 T(global opt: decim) = 7.837e-03 S  per =  1.8  per(accum) = 55.7
 T(global opt: guess) = 4.331e-04 S  per = 0.0996  per(accum) = 55.8
 T(global opt: renrm) = 1.762e-01 S  per = 40.5  per(accum) = 96.3
 T(global opt: save ) = 1.591e-02 S  per = 3.66  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.012e-01 S  T(sum) = 1.972e-01 S  per = 9.802e+01
 T(global opt: preprocess                  ) = 5.935e-04 S  per = 0.301  per(accum) = 0.301
 T(global opt: symbolic_formulae           ) = 5.186e-03 S  per = 2.63  per(accum) = 2.93
 T(global opt: hintermediate init          ) = 4.374e-04 S  per = 0.222  per(accum) = 3.15
 T(global opt: preprocess_hformulae_Hxlist ) = 1.949e-02 S  per = 9.89  per(accum) = 13
 T(global opt: hmmtasks init               ) = 1.737e-02 S  per = 8.81  per(accum) = 21.8
 T(global opt: initial guess for dvdson    ) = 3.814e-05 S  per = 0.0193  per(accum) = 21.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.475e-01 S  per = 74.8  per(accum) = 96.7
 T(global opt: dvdson [cpu-gpu]            ) = 1.178e-03 S  per = 0.597  per(accum) = 97.3
 T(global opt: dvdson [nccl]               ) = 2.382e-03 S  per = 1.21  per(accum) = 98.5
 T(global opt: dvdson [mpi]                ) = 2.066e-05 S  per = 0.0105  per(accum) = 98.5
 T(global opt: dvdson [rest part(linalg)]  ) = 3.018e-03 S  per = 1.53  per(accum) = 100
Detailed decomposition of T(renrm) = 1.762e-01 S  T(sum) = 1.762e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.008e-04 S  per = 0.227  per(accum) = 0.227
 T(global opt: qops init                    ) = 3.870e-03 S  per =  2.2  per(accum) = 2.42
 T(global opt: symbolic_formulae_renorm     ) = 8.871e-04 S  per = 0.503  per(accum) = 2.93
 T(global opt: allocate qops on gpu         ) = 4.317e-04 S  per = 0.245  per(accum) = 3.17
 T(global opt: site memcpy cpu2gpu          ) = 1.876e-04 S  per = 0.106  per(accum) = 3.28
 T(global opt: rintermediate init           ) = 3.532e-04 S  per =  0.2  per(accum) = 3.48
 T(global opt: preprocess_formulae_Rlist2   ) = 4.579e-03 S  per =  2.6  per(accum) = 6.08
 T(global opt: rmmtasks init                ) = 5.403e-03 S  per = 3.07  per(accum) = 9.14
 T(global opt: qops memset on cpu           ) = 3.080e-07 S  per = 0.000175  per(accum) = 9.14
 T(global opt: preprocess_renorm_batchGPU   ) = 1.141e-02 S  per = 6.48  per(accum) = 15.6
 T(global opt: deallocate cpu and gpu memory) = 7.515e-04 S  per = 0.426  per(accum) = 16
 T(global opt: construct opS [ifdists=true] ) = 1.409e-01 S  per =   80  per(accum) = 96
 T(global opt: reduction of opS & opH [nccl]) = 1.720e-04 S  per = 0.0976  per(accum) = 96.1
 T(global opt: qops memcpy gpu2cpu          ) = 7.001e-04 S  per = 0.397  per(accum) = 96.5
 T(global opt: reduction of opS & opH [mpi] ) = 2.327e-04 S  per = 0.132  per(accum) = 96.6
 T(global opt: qops_pool join and erase     ) = 5.925e-03 S  per = 3.36  per(accum) = 100
 T(global opt: conversion from opAB to opPQ ) = 1.249e-05 S  per = 0.00709  per(accum) = 100
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-4.494e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=8/seqsize=34 dots=1 dbond=(9,0)-(10,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=9 scratch=./scratch/sweep size=2034:1.52e-05GB T(load)=3.22e-04S speed=4.70e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=3617:2.76e-02MB:2.69e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1583:1.21e-02MB:1.18e-05GB
total mem of comb=5348:4.08e-02MB:3.98e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=2.103e-05 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=9,10,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc= 5
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:18 S:11 H:1 A:76 B:86 
        dim(bra,ket)=65,65 size(op)=447:3.410e-03MB size(tot)=54361:4.147e-01MB:4.050e-04GB
        per(mem): C:10.5 S:6.5 H:0.822 A:26.3 B:55.9 
 rqops: oplist=CSHPQ nops=C:20 S:10 H:1 P:95 Q:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=86515:0.66MB:0.000645GB
        per(mem): C:9.17 S:4.68 H:0.709 P:26.5 Q:58.9 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=143212:1.09MB:0.00107GB
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=0.000e+00 change=2.045e-03 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(9,0) fdel=./scratch/sweep/rop(10,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=6.485e-04 change=-6.481e-04 heap=1.386e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(65,73,4) nnz=1583:1.208e-02MB
qtensor3: wf3 own=1 _data=0x55b2c5ae2000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=13 dimAll=65
 (13,1):12 (14,0):8 (14,2):7 (13,-1):7 (12,0):6 (15,1):6 (12,2):5 (11,1):4 (13,3):4 (15,-1):3 (11,3):1 (11,-1):1 (15,3):1
 qbond: qcol nsym=12 dimAll=73
 (16,-2):14 (15,-1):10 (16,0):10 (14,-2):8 (15,-3):7 (14,0):6 (17,-1):5 (17,-3):4 (16,-4):4 (18,-2):3 (14,-4):1 (18,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=36 nblocks=624 size=1583:1.208e-02MB
### DIAG TIMING: total=1.839e-03 t1=2.195e-05, t2=1.589e-05, t3=1.270e-05, t4=1.720e-03, t5=1.849e-05, t6=4.188e-05, t7=8.639e-06
duration_diagGPU:1.851e-03
duration_diagreduce:4.600e-08
duration_diagtransform:2.128e-06
----- TIMING FOR symbolic_formulae_onedot with size=819 : 1.730e-03 S -----
rank=0 GPUmem(GB): used=1.067e-03 (oper)=1.067e-03
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=819
 no. of hintermediate operators=414
 no. of coefficients=4140:3.159e-02MB:3.085e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.063e-05 S -----
rank=0 GPUmem(GB): used=1.098e-03 (oper,hinter)=1.067e-03,3.085e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.962e-03 S size(H_formulae)=819 size(Hxlst2)=36 T(Hmu/Hxlist)=4.127e-04,6.549e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 8.692e-03 S size(H_formulae)=819 size(Hxlst)=22412 -----
rank=0 GPUmem(GB): used=1.098e-03 avail=3.829e+01 total=3.829e+01 dvdson[need]=2.359e-05 batch[need]=7.965e-02 blksize=168 blksize0=140 batchsize=22412
rank=0 GPUmem(GB): used=8.077e-02 (oper,hinter,dvdson,batch)=1.067e-03,3.085e-05,2.359e-05,7.965e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=1583 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.070e-04,2.707e-04,4.675e-03,4.836e-04,5.560e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=4.546e-05 speed=5.189e-01GB/S T(nccl)=6.159e-05 speed=3.830e-01GB/S
----- TIMING FOR sigma : t_inter=2.7e-04 t_gemm=4.7e-03 t_reduction=4.8e-04 tot=5.4e-03 -----
 sigma[inter] counter=52 t=2.7e-04 per=5.0e+00 cost=1.1e+07 flops=4.2e+10
 sigma[gemm] counter=52 i=0 t=2.5e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=1 t=2.2e-06 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=52 i=2 t=1.1e-03 per=2.1e+01 cost=7.3e+06 flops=6.4e+09
 sigma[gemm] counter=52 i=3 t=1.4e-03 per=2.6e+01 cost=7.4e+06 flops=5.3e+09
 sigma[gemm] counter=52 i=4 t=1.1e-03 per=1.9e+01 cost=7.3e+06 flops=6.9e+09
 sigma[gemm] counter=52 i=5 t=1.1e-03 per=2.0e+01 cost=7.6e+06 flops=7.1e+09
 sigma[gemm] counter=52 total t=4.7e-03 per=8.6e+01 cost=3.0e+07 flops=6.3e+09
 sigma[red] counter=52 t=4.8e-04 per=8.9e+00 cost=2.2e+06 flops=4.6e+09
----- TIMING FOR sigma_tot : t_inter=6.5e-03 t_gemm=1.2e-01 t_reduction=1.7e-02 tot=1.4e-01 -----
 sigma_tot[inter] counter=52 t=6.5e-03 per=4.5e+00 cost=1.4e+08 flops=2.1e+10
 sigma_tot[gemm] counter=52 i=0 t=1.1e-04 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=1 t=1.0e-04 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=52 i=2 t=3.0e-02 per=2.1e+01 cost=7.0e+07 flops=2.4e+09
 sigma_tot[gemm] counter=52 i=3 t=3.8e-02 per=2.6e+01 cost=7.0e+07 flops=1.8e+09
 sigma_tot[gemm] counter=52 i=4 t=2.5e-02 per=1.8e+01 cost=7.5e+07 flops=3.0e+09
 sigma_tot[gemm] counter=52 i=5 t=2.7e-02 per=1.9e+01 cost=8.0e+07 flops=2.9e+09
 sigma_tot[gemm] counter=52 total t=1.2e-01 per=8.4e+01 cost=2.9e+08 flops=2.4e+09
 sigma_tot[red] counter=52 t=1.7e-02 per=1.2e+01 cost=2.6e+07 flops=1.5e+09
T(sub)=3.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,5.8e-06,1.4e-06,1.3e-05,7.6e-07
settings: ndim=1583 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.490872151426 -1.116e+03  5.160e-02    1     1  6.026e-03 6.026e-03 5.950e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.861e-05,2.326e-04,5.026e-03,4.341e-04,5.780e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=3.130e-05 speed=7.536e-01GB/S T(nccl)=4.730e-05 speed=4.987e-01GB/S
----- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=5.0e-03 t_reduction=4.3e-04 tot=5.7e-03 -----
 sigma[inter] counter=53 t=2.3e-04 per=4.1e+00 cost=1.1e+07 flops=4.8e+10
 sigma[gemm] counter=53 i=0 t=2.7e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=1 t=2.2e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=53 i=2 t=1.3e-03 per=2.3e+01 cost=7.3e+06 flops=5.6e+09
 sigma[gemm] counter=53 i=3 t=1.5e-03 per=2.6e+01 cost=7.4e+06 flops=4.9e+09
 sigma[gemm] counter=53 i=4 t=1.1e-03 per=1.9e+01 cost=7.3e+06 flops=6.6e+09
 sigma[gemm] counter=53 i=5 t=1.1e-03 per=1.9e+01 cost=7.6e+06 flops=6.8e+09
 sigma[gemm] counter=53 total t=5.0e-03 per=8.8e+01 cost=3.0e+07 flops=5.9e+09
 sigma[red] counter=53 t=4.3e-04 per=7.6e+00 cost=2.2e+06 flops=5.1e+09
----- TIMING FOR sigma_tot : t_inter=6.8e-03 t_gemm=1.3e-01 t_reduction=1.7e-02 tot=1.5e-01 -----
 sigma_tot[inter] counter=53 t=6.8e-03 per=4.5e+00 cost=1.5e+08 flops=2.2e+10
 sigma_tot[gemm] counter=53 i=0 t=1.2e-04 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=1 t=1.1e-04 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=53 i=2 t=3.1e-02 per=2.1e+01 cost=7.7e+07 flops=2.5e+09
 sigma_tot[gemm] counter=53 i=3 t=4.0e-02 per=2.6e+01 cost=7.7e+07 flops=1.9e+09
 sigma_tot[gemm] counter=53 i=4 t=2.6e-02 per=1.8e+01 cost=8.3e+07 flops=3.1e+09
 sigma_tot[gemm] counter=53 i=5 t=2.8e-02 per=1.9e+01 cost=8.7e+07 flops=3.1e+09
 sigma_tot[gemm] counter=53 total t=1.3e-01 per=8.4e+01 cost=3.2e+08 flops=2.6e+09
 sigma_tot[red] counter=53 t=1.7e-02 per=1.2e+01 cost=2.8e+07 flops=1.6e+09
T(sub)=5.5e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,2.2e-05,2.7e-06,9.8e-06,6.8e-07
    2   0 -    -116.494545876311 -3.674e-03  1.335e-02    2     2  1.222e-02 6.109e-03 6.005e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.746e-05,2.198e-04,4.823e-03,4.263e-04,5.553e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=3.100e-05 speed=7.609e-01GB/S T(nccl)=4.646e-05 speed=5.078e-01GB/S
----- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=4.8e-03 t_reduction=4.3e-04 tot=5.5e-03 -----
 sigma[inter] counter=54 t=2.2e-04 per=4.0e+00 cost=1.1e+07 flops=5.1e+10
 sigma[gemm] counter=54 i=0 t=2.7e-06 per=4.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=1 t=2.0e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=54 i=2 t=1.1e-03 per=2.1e+01 cost=7.3e+06 flops=6.5e+09
 sigma[gemm] counter=54 i=3 t=1.5e-03 per=2.7e+01 cost=7.4e+06 flops=5.0e+09
 sigma[gemm] counter=54 i=4 t=1.1e-03 per=2.0e+01 cost=7.3e+06 flops=6.6e+09
 sigma[gemm] counter=54 i=5 t=1.1e-03 per=2.0e+01 cost=7.6e+06 flops=6.9e+09
 sigma[gemm] counter=54 total t=4.8e-03 per=8.8e+01 cost=3.0e+07 flops=6.1e+09
 sigma[red] counter=54 t=4.3e-04 per=7.8e+00 cost=2.2e+06 flops=5.2e+09
----- TIMING FOR sigma_tot : t_inter=7.0e-03 t_gemm=1.3e-01 t_reduction=1.8e-02 tot=1.6e-01 -----
 sigma_tot[inter] counter=54 t=7.0e-03 per=4.5e+00 cost=1.6e+08 flops=2.3e+10
 sigma_tot[gemm] counter=54 i=0 t=1.2e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=1 t=1.1e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=54 i=2 t=3.2e-02 per=2.1e+01 cost=8.4e+07 flops=2.6e+09
 sigma_tot[gemm] counter=54 i=3 t=4.1e-02 per=2.7e+01 cost=8.4e+07 flops=2.1e+09
 sigma_tot[gemm] counter=54 i=4 t=2.7e-02 per=1.8e+01 cost=9.0e+07 flops=3.3e+09
 sigma_tot[gemm] counter=54 i=5 t=2.9e-02 per=1.9e+01 cost=9.5e+07 flops=3.2e+09
 sigma_tot[gemm] counter=54 total t=1.3e-01 per=8.4e+01 cost=3.5e+08 flops=2.7e+09
 sigma_tot[red] counter=54 t=1.8e-02 per=1.2e+01 cost=3.0e+07 flops=1.7e+09
T(sub)=5.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.6e-05,2.2e-05,1.9e-06,1.2e-05,6.1e-07
    3   0 -    -116.494898262827 -3.524e-04  6.125e-03    3     3  1.808e-02 6.025e-03 5.925e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.765e-05,1.972e-04,4.816e-03,4.269e-04,5.514e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=2.283e-05 speed=1.033e+00GB/S T(nccl)=4.482e-05 speed=5.263e-01GB/S
----- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=4.8e-03 t_reduction=4.3e-04 tot=5.4e-03 -----
 sigma[inter] counter=55 t=2.0e-04 per=3.6e+00 cost=1.1e+07 flops=5.7e+10
 sigma[gemm] counter=55 i=0 t=1.9e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=1 t=1.9e-06 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=55 i=2 t=1.1e-03 per=2.1e+01 cost=7.3e+06 flops=6.5e+09
 sigma[gemm] counter=55 i=3 t=1.5e-03 per=2.7e+01 cost=7.4e+06 flops=5.0e+09
 sigma[gemm] counter=55 i=4 t=1.1e-03 per=2.0e+01 cost=7.3e+06 flops=6.7e+09
 sigma[gemm] counter=55 i=5 t=1.1e-03 per=2.0e+01 cost=7.6e+06 flops=6.9e+09
 sigma[gemm] counter=55 total t=4.8e-03 per=8.9e+01 cost=3.0e+07 flops=6.1e+09
 sigma[red] counter=55 t=4.3e-04 per=7.8e+00 cost=2.2e+06 flops=5.2e+09
----- TIMING FOR sigma_tot : t_inter=7.2e-03 t_gemm=1.3e-01 t_reduction=1.8e-02 tot=1.6e-01 -----
 sigma_tot[inter] counter=55 t=7.2e-03 per=4.5e+00 cost=1.7e+08 flops=2.4e+10
 sigma_tot[gemm] counter=55 i=0 t=1.2e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=1 t=1.1e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=55 i=2 t=3.3e-02 per=2.1e+01 cost=9.2e+07 flops=2.8e+09
 sigma_tot[gemm] counter=55 i=3 t=4.3e-02 per=2.7e+01 cost=9.2e+07 flops=2.2e+09
 sigma_tot[gemm] counter=55 i=4 t=2.9e-02 per=1.8e+01 cost=9.7e+07 flops=3.4e+09
 sigma_tot[gemm] counter=55 i=5 t=3.0e-02 per=1.9e+01 cost=1.0e+08 flops=3.4e+09
 sigma_tot[gemm] counter=55 total t=1.3e-01 per=8.4e+01 cost=3.8e+08 flops=2.8e+09
 sigma_tot[red] counter=55 t=1.8e-02 per=1.1e+01 cost=3.3e+07 flops=1.8e+09
T(sub)=3.8e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.4e-05,1.8e-06,6.6e-06,6.2e-07
    4   0 -    -116.494961229754 -6.297e-05  2.624e-03    3     4  2.372e-02 5.931e-03 5.839e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.651e-05,2.281e-04,4.951e-03,4.146e-04,5.666e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=2.273e-05 speed=1.038e+00GB/S T(nccl)=4.379e-05 speed=5.387e-01GB/S
----- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=5.0e-03 t_reduction=4.1e-04 tot=5.6e-03 -----
 sigma[inter] counter=56 t=2.3e-04 per=4.1e+00 cost=1.1e+07 flops=4.9e+10
 sigma[gemm] counter=56 i=0 t=2.2e-06 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=1 t=2.0e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=56 i=2 t=1.2e-03 per=2.1e+01 cost=7.3e+06 flops=6.2e+09
 sigma[gemm] counter=56 i=3 t=1.5e-03 per=2.7e+01 cost=7.4e+06 flops=5.0e+09
 sigma[gemm] counter=56 i=4 t=1.2e-03 per=2.1e+01 cost=7.3e+06 flops=6.2e+09
 sigma[gemm] counter=56 i=5 t=1.1e-03 per=2.0e+01 cost=7.6e+06 flops=6.9e+09
 sigma[gemm] counter=56 total t=5.0e-03 per=8.9e+01 cost=3.0e+07 flops=6.0e+09
 sigma[red] counter=56 t=4.1e-04 per=7.4e+00 cost=2.2e+06 flops=5.3e+09
----- TIMING FOR sigma_tot : t_inter=7.4e-03 t_gemm=1.4e-01 t_reduction=1.9e-02 tot=1.7e-01 -----
 sigma_tot[inter] counter=56 t=7.4e-03 per=4.5e+00 cost=1.8e+08 flops=2.5e+10
 sigma_tot[gemm] counter=56 i=0 t=1.2e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=1 t=1.1e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=56 i=2 t=3.4e-02 per=2.1e+01 cost=9.9e+07 flops=2.9e+09
 sigma_tot[gemm] counter=56 i=3 t=4.4e-02 per=2.7e+01 cost=9.9e+07 flops=2.3e+09
 sigma_tot[gemm] counter=56 i=4 t=3.0e-02 per=1.8e+01 cost=1.0e+08 flops=3.5e+09
 sigma_tot[gemm] counter=56 i=5 t=3.2e-02 per=1.9e+01 cost=1.1e+08 flops=3.5e+09
 sigma_tot[gemm] counter=56 total t=1.4e-01 per=8.4e+01 cost=4.1e+08 flops=2.9e+09
 sigma_tot[red] counter=56 t=1.9e-02 per=1.1e+01 cost=3.5e+07 flops=1.9e+09
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.2e-05,1.8e-06,6.1e-06,6.0e-07
    5   0 -    -116.494972770475 -1.154e-05  1.071e-03    3     5  2.952e-02 5.904e-03 5.818e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.619e-05,2.223e-04,4.862e-03,4.362e-04,5.593e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=2.281e-05 speed=1.034e+00GB/S T(nccl)=4.338e-05 speed=5.437e-01GB/S
----- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=4.9e-03 t_reduction=4.4e-04 tot=5.5e-03 -----
 sigma[inter] counter=57 t=2.2e-04 per=4.0e+00 cost=1.1e+07 flops=5.1e+10
 sigma[gemm] counter=57 i=0 t=2.1e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=1 t=2.0e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=57 i=2 t=1.2e-03 per=2.1e+01 cost=7.3e+06 flops=6.2e+09
 sigma[gemm] counter=57 i=3 t=1.5e-03 per=2.7e+01 cost=7.4e+06 flops=5.0e+09
 sigma[gemm] counter=57 i=4 t=1.1e-03 per=2.0e+01 cost=7.3e+06 flops=6.7e+09
 sigma[gemm] counter=57 i=5 t=1.1e-03 per=2.0e+01 cost=7.6e+06 flops=6.9e+09
 sigma[gemm] counter=57 total t=4.9e-03 per=8.8e+01 cost=3.0e+07 flops=6.1e+09
 sigma[red] counter=57 t=4.4e-04 per=7.9e+00 cost=2.2e+06 flops=5.1e+09
----- TIMING FOR sigma_tot : t_inter=7.6e-03 t_gemm=1.4e-01 t_reduction=1.9e-02 tot=1.7e-01 -----
 sigma_tot[inter] counter=57 t=7.6e-03 per=4.4e+00 cost=1.9e+08 flops=2.5e+10
 sigma_tot[gemm] counter=57 i=0 t=1.3e-04 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=1 t=1.1e-04 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=57 i=2 t=3.5e-02 per=2.1e+01 cost=1.1e+08 flops=3.0e+09
 sigma_tot[gemm] counter=57 i=3 t=4.6e-02 per=2.7e+01 cost=1.1e+08 flops=2.3e+09
 sigma_tot[gemm] counter=57 i=4 t=3.1e-02 per=1.8e+01 cost=1.1e+08 flops=3.6e+09
 sigma_tot[gemm] counter=57 i=5 t=3.3e-02 per=1.9e+01 cost=1.2e+08 flops=3.6e+09
 sigma_tot[gemm] counter=57 total t=1.4e-01 per=8.4e+01 cost=4.4e+08 flops=3.1e+09
 sigma_tot[red] counter=57 t=1.9e-02 per=1.1e+01 cost=3.7e+07 flops=1.9e+09
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.2e-05,1.8e-06,6.1e-06,5.8e-07
    6   0 -    -116.494974648739 -1.878e-06  4.831e-04    3     6  3.540e-02 5.900e-03 5.811e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.729e-05,2.033e-04,4.881e-03,4.409e-04,5.599e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=2.255e-05 speed=1.046e+00GB/S T(nccl)=4.474e-05 speed=5.273e-01GB/S
----- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=4.9e-03 t_reduction=4.4e-04 tot=5.5e-03 -----
 sigma[inter] counter=58 t=2.0e-04 per=3.7e+00 cost=1.1e+07 flops=5.5e+10
 sigma[gemm] counter=58 i=0 t=2.1e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=1 t=2.0e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=58 i=2 t=1.2e-03 per=2.2e+01 cost=7.3e+06 flops=6.2e+09
 sigma[gemm] counter=58 i=3 t=1.5e-03 per=2.7e+01 cost=7.4e+06 flops=5.0e+09
 sigma[gemm] counter=58 i=4 t=1.1e-03 per=2.0e+01 cost=7.3e+06 flops=6.6e+09
 sigma[gemm] counter=58 i=5 t=1.1e-03 per=2.0e+01 cost=7.6e+06 flops=6.9e+09
 sigma[gemm] counter=58 total t=4.9e-03 per=8.8e+01 cost=3.0e+07 flops=6.1e+09
 sigma[red] counter=58 t=4.4e-04 per=8.0e+00 cost=2.2e+06 flops=5.0e+09
----- TIMING FOR sigma_tot : t_inter=7.8e-03 t_gemm=1.5e-01 t_reduction=2.0e-02 tot=1.8e-01 -----
 sigma_tot[inter] counter=58 t=7.8e-03 per=4.4e+00 cost=2.0e+08 flops=2.6e+10
 sigma_tot[gemm] counter=58 i=0 t=1.3e-04 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=1 t=1.2e-04 per=6.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=58 i=2 t=3.7e-02 per=2.1e+01 cost=1.1e+08 flops=3.1e+09
 sigma_tot[gemm] counter=58 i=3 t=4.7e-02 per=2.7e+01 cost=1.1e+08 flops=2.4e+09
 sigma_tot[gemm] counter=58 i=4 t=3.2e-02 per=1.8e+01 cost=1.2e+08 flops=3.7e+09
 sigma_tot[gemm] counter=58 i=5 t=3.4e-02 per=1.9e+01 cost=1.2e+08 flops=3.7e+09
 sigma_tot[gemm] counter=58 total t=1.5e-01 per=8.5e+01 cost=4.7e+08 flops=3.2e+09
 sigma_tot[red] counter=58 t=2.0e-02 per=1.1e+01 cost=3.9e+07 flops=2.0e+09
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.2e-05,1.8e-06,6.1e-06,5.7e-07
    7   0 -    -116.494975034656 -3.859e-07  1.944e-04    3     7  4.134e-02 5.905e-03 5.818e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.790e-05,2.093e-04,4.875e-03,4.397e-04,5.598e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=2.288e-05 speed=1.031e+00GB/S T(nccl)=4.502e-05 speed=5.240e-01GB/S
----- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=4.9e-03 t_reduction=4.4e-04 tot=5.5e-03 -----
 sigma[inter] counter=59 t=2.1e-04 per=3.8e+00 cost=1.1e+07 flops=5.4e+10
 sigma[gemm] counter=59 i=0 t=2.1e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=1 t=2.0e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=59 i=2 t=1.2e-03 per=2.2e+01 cost=7.3e+06 flops=6.2e+09
 sigma[gemm] counter=59 i=3 t=1.5e-03 per=2.7e+01 cost=7.4e+06 flops=5.0e+09
 sigma[gemm] counter=59 i=4 t=1.1e-03 per=2.0e+01 cost=7.3e+06 flops=6.7e+09
 sigma[gemm] counter=59 i=5 t=1.1e-03 per=2.0e+01 cost=7.6e+06 flops=6.9e+09
 sigma[gemm] counter=59 total t=4.9e-03 per=8.8e+01 cost=3.0e+07 flops=6.1e+09
 sigma[red] counter=59 t=4.4e-04 per=8.0e+00 cost=2.2e+06 flops=5.0e+09
----- TIMING FOR sigma_tot : t_inter=8.0e-03 t_gemm=1.5e-01 t_reduction=2.0e-02 tot=1.8e-01 -----
 sigma_tot[inter] counter=59 t=8.0e-03 per=4.4e+00 cost=2.2e+08 flops=2.7e+10
 sigma_tot[gemm] counter=59 i=0 t=1.3e-04 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=1 t=1.2e-04 per=6.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=59 i=2 t=3.8e-02 per=2.1e+01 cost=1.2e+08 flops=3.2e+09
 sigma_tot[gemm] counter=59 i=3 t=4.9e-02 per=2.7e+01 cost=1.2e+08 flops=2.5e+09
 sigma_tot[gemm] counter=59 i=4 t=3.3e-02 per=1.8e+01 cost=1.3e+08 flops=3.8e+09
 sigma_tot[gemm] counter=59 i=5 t=3.5e-02 per=1.9e+01 cost=1.3e+08 flops=3.8e+09
 sigma_tot[gemm] counter=59 total t=1.5e-01 per=8.5e+01 cost=5.0e+08 flops=3.2e+09
 sigma_tot[red] counter=59 t=2.0e-02 per=1.1e+01 cost=4.2e+07 flops=2.1e+09
T(sub)=3.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.1e-05,1.7e-06,6.1e-06,5.8e-07
    8   0 +    -116.494975102556 -6.790e-08  7.678e-05    3     8  4.726e-02 5.907e-03 5.819e-03
TIMING FOR Davidson : 4.728e-02  T(cal/comm/rest)=4.655e-02,3.338e-06,7.230e-04
decomposed t_rest=7.230e-04
 T(sub)    =3.172e-04 per=4.387e+01
 T(precond)=6.435e-05 per=8.900e+00
 T(ortho)  =3.778e-05 per=5.226e+00
 T(xcopy)  =2.039e-05 per=2.821e+00
 T(xnrm2)  =5.078e-06 per=7.023e-01
 T(other)  =2.783e-04 per=3.848e+01
optimized energies: isweep=0 ibond=8 dots=1 e[0]=-116.494975102556 nmvp=8
rank=0 CPUmem(GB): used=1.353e+00 pageheap_free=1.221e-02 change=5.464e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=24 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond8.txt
 qbond: qsuper nsym=24 dimAll=260
 (13,1):27 (15,1):33 (14,2):28 (14,0):33 (16,0):17 (15,-1):18 (16,2):14 (15,3):12 (13,-1):14 (14,-2):7 (12,0):11 (17,1):6 (12,2):10 (13,3):10 (11,1):4 (14,4):4 (17,-1):3 (16,-2):3 (11,3):1 (12,4):1 (11,-1):1 (12,-2):1 (17,3):1 (16,4):1
timing for divide=4.1e-06
timing for compute=3.0e-04
timing for collect=1.9e-05
----- TMING FOR decimation_genbasis(nkr): 3.3e-04 S T(divide/compute[cpu/gpu/rest]/collect)=4.1e-06,3.0e-04,0.0e+00,3.5e-06,1.9e-05 -----
decimation summary: 260->73 dwt=-2.220e-16 SvN=2.129e+00
 qbond: qkept nsym=12 dimAll=73
 (14,2):14 (15,1):10 (14,0):10 (16,2):8 (15,3):7 (16,0):6 (13,1):5 (13,3):4 (14,4):4 (12,2):3 (12,0):1 (16,4):1
----- TIMING for decimation_row(nkr): 1.613e-03 S T(decim/select/formRot)=3.794e-04,1.207e-03,2.666e-05 -----
----- TIMING FOR onedot_decimation: 1.681e-03 S T(wf/decim)=4.407e-05,1.636e-03 -----
ctns::oper_renorm coord=(9,0) superblock=lc oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:20 S:10 H:1 A:95 B:105 
        dim(bra,ket)=73,73 size(op)=613:4.677e-03MB size(tot)=86515:6.601e-01MB:6.446e-04GB
        per(mem): C:9.17 S:4.68 H:0.709 A:26.5 B:58.9 
rank=0 CPUmem(GB): used=1.353e+00 pageheap_free=1.221e-02 change=5.245e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=221 : 2.436e-04 S -----
rank=0 GPUmem(GB): used=1.098e-03 (oper)=1.067e-03
rank=0 GPUmem(GB): used=1.110e-03 (oper,site)=1.067e-03,1.179e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=221
 no. of rintermediate operators=7
 no. of coefficients=261:1.991e-03MB:1.945e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.483e-05 S -----
rank=0 GPUmem(GB): used=1.112e-03 (oper,site,rinter)=1.067e-03,1.179e-05,1.945e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.406e-03 S size(rtasks)=221 size(Rlst2)=144 T(Rmu/Rlist)=1.612e-04,1.245e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.586e-03 S size(rtasks)=221 size(Rlst)=4932 -----
rank=0 GPUmem(GB): used=1.112e-03 avail=3.829e+01 total=3.829e+01 batch[need]=1.973e-02 blksize=196 blksize0=144 batchsize=4932
rank=0 GPUmem(GB): used=2.084e-02 (oper,site,rinter,batch)=1.067e-03,1.179e-05,1.945e-06,1.973e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=2.042e-04,2.020e-03,4.743e-04
----- TIMING FOR renorm : t_inter=2.0e-04 t_gemm=2.0e-03 t_reduction=4.7e-04 tot=2.7e-03 -----
 renorm[inter] counter=241 t=2.0e-04 per=7.6e+00 cost=5.9e+05 flops=2.9e+09
 renorm[gemm] counter=241 i=0 t=1.9e-06 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=241 i=1 t=1.6e-06 per=6.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=241 i=2 t=1.6e-06 per=6.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=241 i=3 t=1.6e-06 per=5.9e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=241 i=4 t=4.8e-04 per=1.8e+01 cost=2.6e+05 flops=5.5e+08
 renorm[gemm] counter=241 i=5 t=8.0e-04 per=3.0e+01 cost=2.7e+06 flops=3.3e+09
 renorm[gemm] counter=241 i=6 t=7.4e-04 per=2.7e+01 cost=3.9e+06 flops=5.2e+09
 renorm[gemm] counter=241 total t=2.0e-03 per=7.5e+01 cost=6.8e+06 flops=3.4e+09
 renorm[red] counter=241 t=4.7e-04 per=1.8e+01 cost=5.7e+05 flops=1.2e+09
----- TIMING FOR renorm_tot : t_inter=1.2e-03 t_gemm=9.5e-03 t_reduction=2.5e-03 tot=1.3e-02 -----
 renorm_tot[inter] counter=241 t=1.2e-03 per=9.0e+00 cost=1.5e+06 flops=1.3e+09
 renorm_tot[gemm] counter=241 i=0 t=1.9e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=241 i=1 t=1.7e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=241 i=2 t=1.7e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=241 i=3 t=1.7e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=241 i=4 t=2.4e-03 per=1.8e+01 cost=6.1e+05 flops=2.5e+08
 renorm_tot[gemm] counter=241 i=5 t=3.6e-03 per=2.8e+01 cost=5.9e+06 flops=1.6e+09
 renorm_tot[gemm] counter=241 i=6 t=3.4e-03 per=2.6e+01 cost=8.2e+06 flops=2.4e+09
 renorm_tot[gemm] counter=241 total t=9.5e-03 per=7.2e+01 cost=1.5e+07 flops=1.5e+09
 renorm_tot[red] counter=241 t=2.5e-03 per=1.9e+01 cost=1.4e+06 flops=5.5e+08
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.134e-03 (oper)=1.070e-03
rank=0 GPUmem(GB): used=1.145e-03 (oper,site,rinter)=1.070e-03,1.179e-05,3.085e-05
rank=0 GPUmem(GB): used=1.611e-03 (oper,site,rinter,batch)=1.070e-03,1.179e-05,3.085e-05,4.659e-04
iproc=1
 qops_tmp: oplist=M nops=M:95 
        dim(bra,ket)=73,73 size(op)=306:0.00233MB size(tot)=22988:0.175MB:0.000171GB
        per(mem): M:100 
   init qops_tmp: dt=0.000152 tinit=0.000348
   from opA to opA.H(): dt=0.000189 tadjt=0.000189
   bcast: size(opM)=22988:0.000171GB dt=2.93e-05 speed=5.84GB/s tcomm=0.000392
   compute opP from opA: dt=0.000124 tcomp=0.000267
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.254e-02 S T(preprocess/alloc/comp/red/dealloc)=2.620e-03,2.663e-03,1.713e-02,2.520e-03,1.898e-04 -----
----- TIMING FOR oper_renorm_opS : 2.260e-02 S rank=0 -----
----- TIMING FOR oper_renorm : 3.093e-02 S rank=0 -----
rank=0 CPUmem(GB): used=1.354e+00 pageheap_free=1.317e-02 change=1.193e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=1.583e-02 change=-3.514e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::oper_ab2pq coord=(9,0) superblock=lc alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=CSHPQ nops=C:20 S:10 H:1 P:95 Q:105 
        dim(bra,ket)=73,73 size(op)=613:4.677e-03MB size(tot)=86546:6.603e-01MB:6.448e-04GB
        per(mem): C:9.16 S:4.68 H:0.708 P:26.6 Q:58.9 
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=1.583e-02 change=5.198e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=1.583e-02 change=1.207e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=1.320e-03 avail=3.829e+01 after qops2.allocate_gpu
ctns::oper_a2p ifab=1 ifkr=0 maxsize=22988:1.713e-04GB
iproc=0
 qops_tmp: oplist=M nops=M:95 
        dim(bra,ket)=73,73 size(op)=306:2.335e-03MB size(tot)=22957:1.751e-01MB:1.710e-04GB
        per(mem): M:100 
   init qops_tmp: dt=0.000254 tinit=0.000254
   from opA to opA.H(): dt=0.000222 tadjt=0.000222
   bcast: size(opM)=22957:0.000171GB dt=4.64e-05 speed=3.69GB/s tcomm=4.64e-05
   compute opP from opA: dt=0.000211 tcomp=0.000211
----- TIMING FOR oper_a2pGPU : 0.00139 S T(init/adjt+bcast/comp/rest)=0.000454,0.00047,0.000359,0.000106 -----
ctns::oper_b2q ifab=1 ifkr=0 maxsize=50965:0.00038GB
iproc=1
 qops_tmp: oplist=B nops=B:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=50965:0.389MB:0.00038GB
        per(mem): B:100 
   init qops_tmp: dt=0.000162 tinit=0.000505
   copy opB to qops_tmps: dt=5.23e-06 tcopy=5.26e-06
   bcast: size(opB)=50965:0.00038GB dt=2.77e-05 speed=13.7GB/s tcomm=0.000708
   compute opQ from opB: dt=0.000142 tcomp=0.000451
iproc=1
 qops_tmp: oplist=N nops=N:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=50965:0.389MB:0.00038GB
        per(mem): N:100 
   init qops_tmp: dt=0.000159 tinit=0.000664
   from opB to opB.H(): dt=0.000267 tadjt=0.000267
   bcast: size(opN)=50965:0.00038GB dt=2.87e-05 speed=13.2GB/s tcomm=0.000737
iproc=0
 qops_tmp: oplist=B nops=B:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=50965:0.389MB:0.00038GB
        per(mem): B:100 
   init qops_tmp: dt=0.00023 tinit=0.00023
   copy opB to qops_tmps: dt=9.55e-06 tcopy=9.55e-06
   bcast: size(opB)=50965:0.00038GB dt=4.97e-05 speed=7.63GB/s tcomm=4.97e-05
   compute opQ from opB: dt=0.000238 tcomp=0.000238
iproc=0
 qops_tmp: oplist=N nops=N:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=50965:0.389MB:0.00038GB
        per(mem): N:100 
   init qops_tmp: dt=0.000214 tinit=0.000444
   from opB to opB.H(): dt=0.000304 tadjt=0.000304
   bcast: size(opN)=50965:0.00038GB dt=4.46e-05 speed=8.51GB/s tcomm=9.44e-05
   compute opQ from opB.H(): dt=0.000184 tcomp=0.000422
   compute opQ from opB.H(): dt=0.000138 tcomp=0.000589
----- TIMING FOR oper_b2qGPU : 0.00312 S T(init/copy/adjt+bcast/comp/rest)=0.000876,9.59e-06,0.000745,0.000762,0.000728 -----
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=1.583e-02 change=4.321e-07 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=1.320e-03 avail=3.829e+01 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.352e+00 pageheap_free=1.518e-02 change=6.485e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=1.320e-03 avail=3.829e+01 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.352e+00 pageheap_free=1.518e-02 change=-5.960e-08 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 before move
rank=0 GPUmem(GB): used=1.320e-03 avail=3.829e+01 before move
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=1.518e-02 change=-5.221e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after move
rank=0 GPUmem(GB): used=6.757e-04 avail=3.829e+01 after move
----- TIMING FOR oper_ab2pq : 6.666e-03 S T(init/copyCSH/opP/opQ/to_gpu/to_cpu/move)=9.824e-04,1.620e-05,1.397e-03,3.144e-03,0.000e+00,7.581e-04,3.684e-04 -----
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=1.518e-02 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=1.518e-02 change=-1.615e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 1.172e-01 S #####
 T(local opt: fetch) = 3.953e-03 S  per = 3.37  per(accum) = 3.37
 T(local opt: hdiag) = 1.929e-03 S  per = 1.65  per(accum) = 5.02
 T(local opt: dvdsn) = 6.818e-02 S  per = 58.1  per(accum) = 63.2
 T(local opt: decim) = 1.721e-03 S  per = 1.47  per(accum) = 64.6
 T(local opt: guess) = 8.616e-05 S  per = 0.0735  per(accum) = 64.7
 T(local opt: renrm) = 3.867e-02 S  per =   33  per(accum) = 97.7
 T(local opt: save ) = 2.710e-03 S  per = 2.31  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.818e-02 S  T(sum) = 6.730e-02 S  per = 9.871e+01
 T(local opt: preprocess                  ) = 1.005e-04 S  per = 0.149  per(accum) = 0.149
 T(local opt: symbolic_formulae           ) = 1.738e-03 S  per = 2.58  per(accum) = 2.73
 T(local opt: hintermediate init          ) = 7.907e-05 S  per = 0.117  per(accum) = 2.85
 T(local opt: preprocess_hformulae_Hxlist ) = 8.877e-03 S  per = 13.2  per(accum) = 16
 T(local opt: hmmtasks init               ) = 9.220e-03 S  per = 13.7  per(accum) = 29.7
 T(local opt: initial guess for dvdson    ) = 1.256e-05 S  per = 0.0187  per(accum) = 29.8
 T(local opt: dvdson [Hx_batchGPU]        ) = 4.595e-02 S  per = 68.3  per(accum) = 98
 T(local opt: dvdson [cpu-gpu]            ) = 2.216e-04 S  per = 0.329  per(accum) = 98.4
 T(local opt: dvdson [nccl]               ) = 3.771e-04 S  per = 0.56  per(accum) = 98.9
 T(local opt: dvdson [mpi]                ) = 3.338e-06 S  per = 0.00496  per(accum) = 98.9
 T(local opt: dvdson [rest part(linalg)]  ) = 7.230e-04 S  per = 1.07  per(accum) = 100
Detailed decomposition of T(renrm) = 3.867e-02 S  T(sum) = 3.867e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.337e-05 S  per = 0.19  per(accum) = 0.19
 T(local opt: qops init                    ) = 1.041e-03 S  per = 2.69  per(accum) = 2.88
 T(local opt: symbolic_formulae_renorm     ) = 2.561e-04 S  per = 0.662  per(accum) = 3.54
 T(local opt: allocate qops on gpu         ) = 6.485e-05 S  per = 0.168  per(accum) = 3.71
 T(local opt: site memcpy cpu2gpu          ) = 2.921e-05 S  per = 0.0755  per(accum) = 3.79
 T(local opt: rintermediate init           ) = 5.787e-05 S  per = 0.15  per(accum) = 3.94
 T(local opt: preprocess_formulae_Rlist2   ) = 1.629e-03 S  per = 4.21  per(accum) = 8.15
 T(local opt: rmmtasks init                ) = 2.020e-03 S  per = 5.22  per(accum) = 13.4
 T(local opt: qops memset on cpu           ) = 6.000e-08 S  per = 0.000155  per(accum) = 13.4
 T(local opt: preprocess_renorm_batchGPU   ) = 2.926e-03 S  per = 7.57  per(accum) = 20.9
 T(local opt: deallocate cpu and gpu memory) = 2.712e-04 S  per = 0.701  per(accum) = 21.6
 T(local opt: construct opS [ifdists=true] ) = 2.261e-02 S  per = 58.5  per(accum) = 80.1
 T(local opt: reduction of opS & opH [nccl]) = 2.536e-05 S  per = 0.0656  per(accum) = 80.2
 T(local opt: qops memcpy gpu2cpu          ) = 5.200e-08 S  per = 0.000134  per(accum) = 80.2
 T(local opt: reduction of opS & opH [mpi] ) = 8.500e-08 S  per = 0.00022  per(accum) = 80.2
 T(local opt: qops_pool join and erase     ) = 8.590e-04 S  per = 2.22  per(accum) = 82.4
 T(local opt: conversion from opAB to opPQ ) = 6.808e-03 S  per = 17.6  per(accum) = 100
ctns::rcanon_save_site idx=10 scratch=./scratch/sweep size=1583:1.2e-05GB T(load)=0.00064S speed=0.018GB/S
##### sweep opt: 5.520e-01 S #####
 T(sweep opt: fetch) = 3.102e-02 S  per = 5.62  per(accum) = 5.62
 T(sweep opt: hdiag) = 8.057e-03 S  per = 1.46  per(accum) = 7.08
 T(sweep opt: dvdsn) = 2.693e-01 S  per = 48.8  per(accum) = 55.9
 T(sweep opt: decim) = 9.558e-03 S  per = 1.73  per(accum) = 57.6
 T(sweep opt: guess) = 5.192e-04 S  per = 0.0941  per(accum) = 57.7
 T(sweep opt: renrm) = 2.149e-01 S  per = 38.9  per(accum) = 96.6
 T(sweep opt: save ) = 1.862e-02 S  per = 3.37  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.693e-01 S  T(sum) = 2.645e-01 S  per = 9.820e+01
 T(sweep opt: preprocess                  ) = 6.940e-04 S  per = 0.262  per(accum) = 0.262
 T(sweep opt: symbolic_formulae           ) = 6.924e-03 S  per = 2.62  per(accum) = 2.88
 T(sweep opt: hintermediate init          ) = 5.164e-04 S  per = 0.195  per(accum) = 3.08
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.837e-02 S  per = 10.7  per(accum) = 13.8
 T(sweep opt: hmmtasks init               ) = 2.659e-02 S  per = 10.1  per(accum) = 23.9
 T(sweep opt: initial guess for dvdson    ) = 5.071e-05 S  per = 0.0192  per(accum) = 23.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 1.934e-01 S  per = 73.1  per(accum) = 97
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.399e-03 S  per = 0.529  per(accum) = 97.5
 T(sweep opt: dvdson [nccl]               ) = 2.759e-03 S  per = 1.04  per(accum) = 98.6
 T(sweep opt: dvdson [mpi]                ) = 2.399e-05 S  per = 0.00907  per(accum) = 98.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 3.741e-03 S  per = 1.41  per(accum) = 100
Detailed decomposition of T(renrm) = 2.149e-01 S  T(sum) = 2.149e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 4.742e-04 S  per = 0.221  per(accum) = 0.221
 T(sweep opt: qops init                    ) = 4.911e-03 S  per = 2.29  per(accum) = 2.51
 T(sweep opt: symbolic_formulae_renorm     ) = 1.143e-03 S  per = 0.532  per(accum) = 3.04
 T(sweep opt: allocate qops on gpu         ) = 4.965e-04 S  per = 0.231  per(accum) = 3.27
 T(sweep opt: site memcpy cpu2gpu          ) = 2.168e-04 S  per = 0.101  per(accum) = 3.37
 T(sweep opt: rintermediate init           ) = 4.111e-04 S  per = 0.191  per(accum) = 3.56
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.208e-03 S  per = 2.89  per(accum) = 6.45
 T(sweep opt: rmmtasks init                ) = 7.423e-03 S  per = 3.45  per(accum) = 9.9
 T(sweep opt: qops memset on cpu           ) = 3.680e-07 S  per = 0.000171  per(accum) = 9.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.434e-02 S  per = 6.67  per(accum) = 16.6
 T(sweep opt: deallocate cpu and gpu memory) = 1.023e-03 S  per = 0.476  per(accum) = 17.1
 T(sweep opt: construct opS [ifdists=true] ) = 1.635e-01 S  per = 76.1  per(accum) = 93.1
 T(sweep opt: reduction of opS & opH [nccl]) = 1.974e-04 S  per = 0.0919  per(accum) = 93.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.001e-04 S  per = 0.326  per(accum) = 93.6
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.328e-04 S  per = 0.108  per(accum) = 93.7
 T(sweep opt: qops_pool join and erase     ) = 6.784e-03 S  per = 3.16  per(accum) = 96.8
 T(sweep opt: conversion from opAB to opPQ ) = 6.820e-03 S  per = 3.17  per(accum) = 100
##### global opt: 5.520e-01 S #####
 T(global opt: fetch) = 3.102e-02 S  per = 5.62  per(accum) = 5.62
 T(global opt: hdiag) = 8.057e-03 S  per = 1.46  per(accum) = 7.08
 T(global opt: dvdsn) = 2.693e-01 S  per = 48.8  per(accum) = 55.9
 T(global opt: decim) = 9.558e-03 S  per = 1.73  per(accum) = 57.6
 T(global opt: guess) = 5.192e-04 S  per = 0.0941  per(accum) = 57.7
 T(global opt: renrm) = 2.149e-01 S  per = 38.9  per(accum) = 96.6
 T(global opt: save ) = 1.862e-02 S  per = 3.37  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.693e-01 S  T(sum) = 2.645e-01 S  per = 9.820e+01
 T(global opt: preprocess                  ) = 6.940e-04 S  per = 0.262  per(accum) = 0.262
 T(global opt: symbolic_formulae           ) = 6.924e-03 S  per = 2.62  per(accum) = 2.88
 T(global opt: hintermediate init          ) = 5.164e-04 S  per = 0.195  per(accum) = 3.08
 T(global opt: preprocess_hformulae_Hxlist ) = 2.837e-02 S  per = 10.7  per(accum) = 13.8
 T(global opt: hmmtasks init               ) = 2.659e-02 S  per = 10.1  per(accum) = 23.9
 T(global opt: initial guess for dvdson    ) = 5.071e-05 S  per = 0.0192  per(accum) = 23.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 1.934e-01 S  per = 73.1  per(accum) = 97
 T(global opt: dvdson [cpu-gpu]            ) = 1.399e-03 S  per = 0.529  per(accum) = 97.5
 T(global opt: dvdson [nccl]               ) = 2.759e-03 S  per = 1.04  per(accum) = 98.6
 T(global opt: dvdson [mpi]                ) = 2.399e-05 S  per = 0.00907  per(accum) = 98.6
 T(global opt: dvdson [rest part(linalg)]  ) = 3.741e-03 S  per = 1.41  per(accum) = 100
Detailed decomposition of T(renrm) = 2.149e-01 S  T(sum) = 2.149e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.742e-04 S  per = 0.221  per(accum) = 0.221
 T(global opt: qops init                    ) = 4.911e-03 S  per = 2.29  per(accum) = 2.51
 T(global opt: symbolic_formulae_renorm     ) = 1.143e-03 S  per = 0.532  per(accum) = 3.04
 T(global opt: allocate qops on gpu         ) = 4.965e-04 S  per = 0.231  per(accum) = 3.27
 T(global opt: site memcpy cpu2gpu          ) = 2.168e-04 S  per = 0.101  per(accum) = 3.37
 T(global opt: rintermediate init           ) = 4.111e-04 S  per = 0.191  per(accum) = 3.56
 T(global opt: preprocess_formulae_Rlist2   ) = 6.208e-03 S  per = 2.89  per(accum) = 6.45
 T(global opt: rmmtasks init                ) = 7.423e-03 S  per = 3.45  per(accum) = 9.9
 T(global opt: qops memset on cpu           ) = 3.680e-07 S  per = 0.000171  per(accum) = 9.9
 T(global opt: preprocess_renorm_batchGPU   ) = 1.434e-02 S  per = 6.67  per(accum) = 16.6
 T(global opt: deallocate cpu and gpu memory) = 1.023e-03 S  per = 0.476  per(accum) = 17.1
 T(global opt: construct opS [ifdists=true] ) = 1.635e-01 S  per = 76.1  per(accum) = 93.1
 T(global opt: reduction of opS & opH [nccl]) = 1.974e-04 S  per = 0.0919  per(accum) = 93.2
 T(global opt: qops memcpy gpu2cpu          ) = 7.001e-04 S  per = 0.326  per(accum) = 93.6
 T(global opt: reduction of opS & opH [mpi] ) = 2.328e-04 S  per = 0.108  per(accum) = 93.7
 T(global opt: qops_pool join and erase     ) = 6.784e-03 S  per = 3.16  per(accum) = 96.8
 T(global opt: conversion from opAB to opPQ ) = 6.820e-03 S  per = 3.17  per(accum) = 100
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-5.473e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=9/seqsize=34 dots=1 dbond=(10,0)-(11,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=8 scratch=./scratch/sweep size=2137:1.59e-05GB T(load)=3.36e-04S speed=4.74e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=4171:3.18e-02MB:3.11e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=2034:1.55e-02MB:1.52e-05GB
total mem of comb=6353:4.85e-02MB:4.73e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=2.326e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=10,9,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc= 6
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:20 S:10 H:1 P:95 Q:105 
        dim(bra,ket)=73,73 size(op)=613:4.677e-03MB size(tot)=86546:6.603e-01MB:6.448e-04GB
        per(mem): C:9.16 S:4.68 H:0.708 P:26.6 Q:58.9 
 rqops: oplist=CSHAB nops=C:18 S:11 H:1 A:78 B:84 
        dim(bra,ket)=74,74 size(op)=818:0.00624MB size(tot)=86243:0.658MB:0.000643GB
        per(mem): C:9.09 S:5.29 H:0.948 A:24.5 B:60.1 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=175125:1.34MB:0.0013GB
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=0.000e+00 change=1.826e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(10,0) fdel=./scratch/sweep/rop(11,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=6.485e-04 change=-6.481e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(73,74,4) nnz=2034:1.552e-02MB
qtensor3: wf3 own=1 _data=0x55b2c61c6000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=12 dimAll=73
 (14,2):14 (15,1):10 (14,0):10 (16,2):8 (15,3):7 (16,0):6 (13,1):5 (13,3):4 (14,4):4 (12,2):3 (12,0):1 (16,4):1
 qbond: qcol nsym=9 dimAll=74
 (15,-3):15 (15,-1):14 (14,-2):11 (13,-1):10 (13,-3):10 (14,-4):7 (16,-2):5 (17,-1):1 (13,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=29 nblocks=432 size=2034:1.552e-02MB
### DIAG TIMING: total=1.704e-03 t1=2.473e-05, t2=1.745e-05, t3=1.538e-05, t4=1.574e-03, t5=1.407e-05, t6=4.641e-05, t7=1.164e-05
duration_diagGPU:1.715e-03
duration_diagreduce:4.400e-08
duration_diagtransform:2.684e-06
----- TIMING FOR symbolic_formulae_onedot with size=816 : 2.085e-03 S -----
rank=0 GPUmem(GB): used=1.305e-03 (oper)=1.305e-03
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=816
 no. of hintermediate operators=411
 no. of coefficients=4110:3.136e-02MB:3.062e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 8.763e-05 S -----
rank=0 GPUmem(GB): used=1.335e-03 (oper,hinter)=1.305e-03,3.062e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.925e-03 S size(H_formulae)=816 size(Hxlst2)=29 T(Hmu/Hxlist)=5.700e-04,6.355e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 9.093e-03 S size(H_formulae)=816 size(Hxlst)=16440 -----
rank=0 GPUmem(GB): used=1.335e-03 avail=3.829e+01 total=3.829e+01 dvdson[need]=3.031e-05 batch[need]=6.872e-02 blksize=210 blksize0=140 batchsize=16440
rank=0 GPUmem(GB): used=7.008e-02 (oper,hinter,dvdson,batch)=1.305e-03,3.062e-05,3.031e-05,6.872e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=2034 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.290e-04,3.090e-04,5.498e-03,5.828e-04,6.543e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=5.697e-05 speed=5.320e-01GB/S T(nccl)=7.201e-05 speed=4.209e-01GB/S
----- TIMING FOR sigma : t_inter=3.1e-04 t_gemm=5.5e-03 t_reduction=5.8e-04 tot=6.4e-03 -----
 sigma[inter] counter=60 t=3.1e-04 per=4.8e+00 cost=8.5e+06 flops=2.8e+10
 sigma[gemm] counter=60 i=0 t=3.5e-06 per=5.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=1 t=3.0e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=60 i=2 t=1.2e-03 per=1.9e+01 cost=1.4e+07 flops=1.2e+10
 sigma[gemm] counter=60 i=3 t=1.6e-03 per=2.5e+01 cost=1.4e+07 flops=8.6e+09
 sigma[gemm] counter=60 i=4 t=1.3e-03 per=2.1e+01 cost=8.6e+06 flops=6.5e+09
 sigma[gemm] counter=60 i=5 t=1.3e-03 per=2.1e+01 cost=8.7e+06 flops=6.5e+09
 sigma[gemm] counter=60 total t=5.5e-03 per=8.6e+01 cost=4.5e+07 flops=8.2e+09
 sigma[red] counter=60 t=5.8e-04 per=9.1e+00 cost=2.6e+06 flops=4.5e+09
----- TIMING FOR sigma_tot : t_inter=8.4e-03 t_gemm=1.6e-01 t_reduction=2.1e-02 tot=1.9e-01 -----
 sigma_tot[inter] counter=60 t=8.4e-03 per=4.4e+00 cost=2.2e+08 flops=2.7e+10
 sigma_tot[gemm] counter=60 i=0 t=1.3e-04 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=1 t=1.2e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=60 i=2 t=3.9e-02 per=2.1e+01 cost=1.4e+08 flops=3.5e+09
 sigma_tot[gemm] counter=60 i=3 t=5.0e-02 per=2.7e+01 cost=1.4e+08 flops=2.7e+09
 sigma_tot[gemm] counter=60 i=4 t=3.4e-02 per=1.8e+01 cost=1.3e+08 flops=3.9e+09
 sigma_tot[gemm] counter=60 i=5 t=3.6e-02 per=1.9e+01 cost=1.4e+08 flops=3.9e+09
 sigma_tot[gemm] counter=60 total t=1.6e-01 per=8.5e+01 cost=5.5e+08 flops=3.4e+09
 sigma_tot[red] counter=60 t=2.1e-02 per=1.1e+01 cost=4.4e+07 flops=2.1e+09
T(sub)=5.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,7.8e-06,2.2e-06,2.6e-05,1.7e-06
settings: ndim=2034 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.494975102556 -1.116e+03  7.506e-02    1     1  7.158e-03 7.158e-03 7.038e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.072e-04,3.220e-04,6.219e-03,6.528e-04,7.315e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=4.701e-05 speed=6.447e-01GB/S T(nccl)=6.021e-05 speed=5.034e-01GB/S
----- TIMING FOR sigma : t_inter=3.2e-04 t_gemm=6.2e-03 t_reduction=6.5e-04 tot=7.2e-03 -----
 sigma[inter] counter=61 t=3.2e-04 per=4.5e+00 cost=8.5e+06 flops=2.6e+10
 sigma[gemm] counter=61 i=0 t=4.1e-06 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=1 t=3.6e-06 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=61 i=2 t=1.4e-03 per=1.9e+01 cost=1.4e+07 flops=1.0e+10
 sigma[gemm] counter=61 i=3 t=1.8e-03 per=2.6e+01 cost=1.4e+07 flops=7.5e+09
 sigma[gemm] counter=61 i=4 t=1.5e-03 per=2.1e+01 cost=8.6e+06 flops=5.8e+09
 sigma[gemm] counter=61 i=5 t=1.5e-03 per=2.1e+01 cost=8.7e+06 flops=5.8e+09
 sigma[gemm] counter=61 total t=6.2e-03 per=8.6e+01 cost=4.5e+07 flops=7.3e+09
 sigma[red] counter=61 t=6.5e-04 per=9.1e+00 cost=2.6e+06 flops=4.0e+09
----- TIMING FOR sigma_tot : t_inter=8.7e-03 t_gemm=1.7e-01 t_reduction=2.1e-02 tot=2.0e-01 -----
 sigma_tot[inter] counter=61 t=8.7e-03 per=4.4e+00 cost=2.3e+08 flops=2.7e+10
 sigma_tot[gemm] counter=61 i=0 t=1.4e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=1 t=1.3e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=61 i=2 t=4.0e-02 per=2.1e+01 cost=1.5e+08 flops=3.7e+09
 sigma_tot[gemm] counter=61 i=3 t=5.2e-02 per=2.7e+01 cost=1.5e+08 flops=2.9e+09
 sigma_tot[gemm] counter=61 i=4 t=3.6e-02 per=1.8e+01 cost=1.4e+08 flops=4.0e+09
 sigma_tot[gemm] counter=61 i=5 t=3.8e-02 per=1.9e+01 cost=1.5e+08 flops=4.0e+09
 sigma_tot[gemm] counter=61 total t=1.7e-01 per=8.5e+01 cost=5.9e+08 flops=3.6e+09
 sigma_tot[red] counter=61 t=2.1e-02 per=1.1e+01 cost=4.7e+07 flops=2.2e+09
T(sub)=1.0e-04 T(gemm/eig/ortho/gemm/axpy)=3.7e-05,2.8e-05,4.9e-06,3.2e-05,1.7e-06
    2   0 -    -116.501698136720 -6.723e-03  2.069e-02    2     2  1.506e-02 7.531e-03 7.356e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.490e-05,2.675e-04,5.300e-03,4.856e-04,6.159e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=4.103e-05 speed=7.386e-01GB/S T(nccl)=5.387e-05 speed=5.626e-01GB/S
----- TIMING FOR sigma : t_inter=2.7e-04 t_gemm=5.3e-03 t_reduction=4.9e-04 tot=6.1e-03 -----
 sigma[inter] counter=62 t=2.7e-04 per=4.4e+00 cost=8.5e+06 flops=3.2e+10
 sigma[gemm] counter=62 i=0 t=3.2e-06 per=5.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=1 t=3.2e-06 per=5.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=62 i=2 t=1.3e-03 per=2.2e+01 cost=1.4e+07 flops=1.1e+10
 sigma[gemm] counter=62 i=3 t=1.8e-03 per=2.9e+01 cost=1.4e+07 flops=7.8e+09
 sigma[gemm] counter=62 i=4 t=1.1e-03 per=1.8e+01 cost=8.6e+06 flops=7.8e+09
 sigma[gemm] counter=62 i=5 t=1.1e-03 per=1.8e+01 cost=8.7e+06 flops=7.9e+09
 sigma[gemm] counter=62 total t=5.3e-03 per=8.8e+01 cost=4.5e+07 flops=8.6e+09
 sigma[red] counter=62 t=4.9e-04 per=8.0e+00 cost=2.6e+06 flops=5.4e+09
----- TIMING FOR sigma_tot : t_inter=8.9e-03 t_gemm=1.7e-01 t_reduction=2.2e-02 tot=2.0e-01 -----
 sigma_tot[inter] counter=62 t=8.9e-03 per=4.4e+00 cost=2.4e+08 flops=2.7e+10
 sigma_tot[gemm] counter=62 i=0 t=1.4e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=1 t=1.3e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=62 i=2 t=4.2e-02 per=2.1e+01 cost=1.6e+08 flops=3.9e+09
 sigma_tot[gemm] counter=62 i=3 t=5.4e-02 per=2.7e+01 cost=1.6e+08 flops=3.0e+09
 sigma_tot[gemm] counter=62 i=4 t=3.7e-02 per=1.8e+01 cost=1.5e+08 flops=4.1e+09
 sigma_tot[gemm] counter=62 i=5 t=3.9e-02 per=1.9e+01 cost=1.6e+08 flops=4.1e+09
 sigma_tot[gemm] counter=62 total t=1.7e-01 per=8.5e+01 cost=6.4e+08 flops=3.7e+09
 sigma_tot[red] counter=62 t=2.2e-02 per=1.1e+01 cost=4.9e+07 flops=2.3e+09
T(sub)=7.6e-05 T(gemm/eig/ortho/gemm/axpy)=2.6e-05,2.5e-05,2.7e-06,2.1e-05,1.1e-06
    3   0 -    -116.502414485529 -7.163e-04  8.700e-03    3     3  2.147e-02 7.157e-03 6.994e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.578e-05,2.084e-04,4.568e-03,4.769e-04,5.337e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=2.779e-05 speed=1.091e+00GB/S T(nccl)=4.799e-05 speed=6.316e-01GB/S
----- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=4.6e-03 t_reduction=4.8e-04 tot=5.3e-03 -----
 sigma[inter] counter=63 t=2.1e-04 per=4.0e+00 cost=8.5e+06 flops=4.1e+10
 sigma[gemm] counter=63 i=0 t=2.6e-06 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=1 t=2.2e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=63 i=2 t=1.0e-03 per=1.9e+01 cost=1.4e+07 flops=1.4e+10
 sigma[gemm] counter=63 i=3 t=1.4e-03 per=2.6e+01 cost=1.4e+07 flops=1.0e+10
 sigma[gemm] counter=63 i=4 t=1.1e-03 per=2.1e+01 cost=8.6e+06 flops=7.9e+09
 sigma[gemm] counter=63 i=5 t=1.1e-03 per=2.1e+01 cost=8.7e+06 flops=7.9e+09
 sigma[gemm] counter=63 total t=4.6e-03 per=8.7e+01 cost=4.5e+07 flops=9.9e+09
 sigma[red] counter=63 t=4.8e-04 per=9.1e+00 cost=2.6e+06 flops=5.5e+09
----- TIMING FOR sigma_tot : t_inter=9.2e-03 t_gemm=1.8e-01 t_reduction=2.2e-02 tot=2.1e-01 -----
 sigma_tot[inter] counter=63 t=9.2e-03 per=4.4e+00 cost=2.5e+08 flops=2.7e+10
 sigma_tot[gemm] counter=63 i=0 t=1.4e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=1 t=1.3e-04 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=63 i=2 t=4.3e-02 per=2.1e+01 cost=1.8e+08 flops=4.2e+09
 sigma_tot[gemm] counter=63 i=3 t=5.5e-02 per=2.7e+01 cost=1.8e+08 flops=3.2e+09
 sigma_tot[gemm] counter=63 i=4 t=3.8e-02 per=1.8e+01 cost=1.6e+08 flops=4.2e+09
 sigma_tot[gemm] counter=63 i=5 t=4.0e-02 per=1.9e+01 cost=1.7e+08 flops=4.2e+09
 sigma_tot[gemm] counter=63 total t=1.8e-01 per=8.5e+01 cost=6.8e+08 flops=3.9e+09
 sigma_tot[red] counter=63 t=2.2e-02 per=1.1e+01 cost=5.2e+07 flops=2.3e+09
T(sub)=5.6e-05 T(gemm/eig/ortho/gemm/axpy)=2.5e-05,1.5e-05,2.7e-06,1.3e-05,1.0e-06
    4   0 -    -116.502547877959 -1.334e-04  3.898e-03    3     4  2.701e-02 6.754e-03 6.608e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.509e-05,2.144e-04,3.924e-03,3.993e-04,4.619e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=2.580e-05 speed=1.175e+00GB/S T(nccl)=4.929e-05 speed=6.149e-01GB/S
----- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=3.9e-03 t_reduction=4.0e-04 tot=4.5e-03 -----
 sigma[inter] counter=64 t=2.1e-04 per=4.7e+00 cost=8.5e+06 flops=4.0e+10
 sigma[gemm] counter=64 i=0 t=2.6e-06 per=5.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=1 t=2.3e-06 per=5.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=64 i=2 t=9.7e-04 per=2.1e+01 cost=1.4e+07 flops=1.5e+10
 sigma[gemm] counter=64 i=3 t=1.1e-03 per=2.5e+01 cost=1.4e+07 flops=1.2e+10
 sigma[gemm] counter=64 i=4 t=9.1e-04 per=2.0e+01 cost=8.6e+06 flops=9.5e+09
 sigma[gemm] counter=64 i=5 t=9.1e-04 per=2.0e+01 cost=8.7e+06 flops=9.5e+09
 sigma[gemm] counter=64 total t=3.9e-03 per=8.6e+01 cost=4.5e+07 flops=1.2e+10
 sigma[red] counter=64 t=4.0e-04 per=8.8e+00 cost=2.6e+06 flops=6.6e+09
----- TIMING FOR sigma_tot : t_inter=9.4e-03 t_gemm=1.8e-01 t_reduction=2.3e-02 tot=2.1e-01 -----
 sigma_tot[inter] counter=64 t=9.4e-03 per=4.4e+00 cost=2.6e+08 flops=2.8e+10
 sigma_tot[gemm] counter=64 i=0 t=1.5e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=1 t=1.3e-04 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=64 i=2 t=4.4e-02 per=2.1e+01 cost=1.9e+08 flops=4.4e+09
 sigma_tot[gemm] counter=64 i=3 t=5.6e-02 per=2.7e+01 cost=1.9e+08 flops=3.4e+09
 sigma_tot[gemm] counter=64 i=4 t=3.9e-02 per=1.8e+01 cost=1.7e+08 flops=4.3e+09
 sigma_tot[gemm] counter=64 i=5 t=4.1e-02 per=1.9e+01 cost=1.8e+08 flops=4.3e+09
 sigma_tot[gemm] counter=64 total t=1.8e-01 per=8.5e+01 cost=7.3e+08 flops=4.0e+09
 sigma_tot[red] counter=64 t=2.3e-02 per=1.1e+01 cost=5.5e+07 flops=2.4e+09
T(sub)=5.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,1.3e-05,2.1e-06,1.5e-05,8.8e-07
    5   0 -    -116.502572230261 -2.435e-05  1.750e-03    3     5  3.205e-02 6.410e-03 6.273e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.272e-05,1.949e-04,3.741e-03,3.976e-04,4.413e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=2.543e-05 speed=1.192e+00GB/S T(nccl)=4.729e-05 speed=6.409e-01GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=3.7e-03 t_reduction=4.0e-04 tot=4.3e-03 -----
 sigma[inter] counter=65 t=1.9e-04 per=4.5e+00 cost=8.5e+06 flops=4.4e+10
 sigma[gemm] counter=65 i=0 t=2.1e-06 per=4.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=1 t=2.0e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=65 i=2 t=8.6e-04 per=2.0e+01 cost=1.4e+07 flops=1.6e+10
 sigma[gemm] counter=65 i=3 t=1.1e-03 per=2.4e+01 cost=1.4e+07 flops=1.3e+10
 sigma[gemm] counter=65 i=4 t=9.1e-04 per=2.1e+01 cost=8.6e+06 flops=9.5e+09
 sigma[gemm] counter=65 i=5 t=9.1e-04 per=2.1e+01 cost=8.7e+06 flops=9.6e+09
 sigma[gemm] counter=65 total t=3.7e-03 per=8.6e+01 cost=4.5e+07 flops=1.2e+10
 sigma[red] counter=65 t=4.0e-04 per=9.2e+00 cost=2.6e+06 flops=6.6e+09
----- TIMING FOR sigma_tot : t_inter=9.6e-03 t_gemm=1.8e-01 t_reduction=2.3e-02 tot=2.2e-01 -----
 sigma_tot[inter] counter=65 t=9.6e-03 per=4.4e+00 cost=2.7e+08 flops=2.8e+10
 sigma_tot[gemm] counter=65 i=0 t=1.5e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=1 t=1.4e-04 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=65 i=2 t=4.5e-02 per=2.1e+01 cost=2.1e+08 flops=4.6e+09
 sigma_tot[gemm] counter=65 i=3 t=5.7e-02 per=2.6e+01 cost=2.0e+08 flops=3.6e+09
 sigma_tot[gemm] counter=65 i=4 t=4.0e-02 per=1.8e+01 cost=1.8e+08 flops=4.5e+09
 sigma_tot[gemm] counter=65 i=5 t=4.2e-02 per=1.9e+01 cost=1.8e+08 flops=4.4e+09
 sigma_tot[gemm] counter=65 total t=1.8e-01 per=8.5e+01 cost=7.7e+08 flops=4.2e+09
 sigma_tot[red] counter=65 t=2.3e-02 per=1.1e+01 cost=5.7e+07 flops=2.5e+09
T(sub)=4.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.3e-05,2.1e-06,9.5e-06,7.3e-07
    6   0 -    -116.502577160404 -4.930e-06  8.021e-04    3     6  3.689e-02 6.149e-03 6.013e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.308e-05,1.907e-04,3.740e-03,4.031e-04,4.413e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=2.759e-05 speed=1.098e+00GB/S T(nccl)=4.549e-05 speed=6.663e-01GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=3.7e-03 t_reduction=4.0e-04 tot=4.3e-03 -----
 sigma[inter] counter=66 t=1.9e-04 per=4.4e+00 cost=8.5e+06 flops=4.5e+10
 sigma[gemm] counter=66 i=0 t=2.1e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=1 t=2.0e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=66 i=2 t=8.6e-04 per=2.0e+01 cost=1.4e+07 flops=1.6e+10
 sigma[gemm] counter=66 i=3 t=1.1e-03 per=2.4e+01 cost=1.4e+07 flops=1.3e+10
 sigma[gemm] counter=66 i=4 t=9.1e-04 per=2.1e+01 cost=8.6e+06 flops=9.5e+09
 sigma[gemm] counter=66 i=5 t=9.1e-04 per=2.1e+01 cost=8.7e+06 flops=9.5e+09
 sigma[gemm] counter=66 total t=3.7e-03 per=8.6e+01 cost=4.5e+07 flops=1.2e+10
 sigma[red] counter=66 t=4.0e-04 per=9.3e+00 cost=2.6e+06 flops=6.5e+09
----- TIMING FOR sigma_tot : t_inter=9.8e-03 t_gemm=1.9e-01 t_reduction=2.3e-02 tot=2.2e-01 -----
 sigma_tot[inter] counter=66 t=9.8e-03 per=4.4e+00 cost=2.8e+08 flops=2.8e+10
 sigma_tot[gemm] counter=66 i=0 t=1.5e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=1 t=1.4e-04 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=66 i=2 t=4.5e-02 per=2.1e+01 cost=2.2e+08 flops=4.8e+09
 sigma_tot[gemm] counter=66 i=3 t=5.8e-02 per=2.6e+01 cost=2.2e+08 flops=3.7e+09
 sigma_tot[gemm] counter=66 i=4 t=4.1e-02 per=1.8e+01 cost=1.9e+08 flops=4.6e+09
 sigma_tot[gemm] counter=66 i=5 t=4.3e-02 per=1.9e+01 cost=1.9e+08 flops=4.5e+09
 sigma_tot[gemm] counter=66 total t=1.9e-01 per=8.5e+01 cost=8.2e+08 flops=4.4e+09
 sigma_tot[red] counter=66 t=2.3e-02 per=1.1e+01 cost=6.0e+07 flops=2.6e+09
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.2e-05,2.2e-06,8.4e-06,7.3e-07
    7   0 -    -116.502578102955 -9.426e-07  3.212e-04    3     7  4.165e-02 5.949e-03 5.818e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.263e-05,1.913e-04,3.813e-03,4.036e-04,4.486e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=2.693e-05 speed=1.125e+00GB/S T(nccl)=4.570e-05 speed=6.632e-01GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=3.8e-03 t_reduction=4.0e-04 tot=4.4e-03 -----
 sigma[inter] counter=67 t=1.9e-04 per=4.3e+00 cost=8.5e+06 flops=4.5e+10
 sigma[gemm] counter=67 i=0 t=2.1e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=1 t=2.1e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=67 i=2 t=8.5e-04 per=1.9e+01 cost=1.4e+07 flops=1.7e+10
 sigma[gemm] counter=67 i=3 t=1.1e-03 per=2.6e+01 cost=1.4e+07 flops=1.2e+10
 sigma[gemm] counter=67 i=4 t=9.2e-04 per=2.1e+01 cost=8.6e+06 flops=9.4e+09
 sigma[gemm] counter=67 i=5 t=9.2e-04 per=2.1e+01 cost=8.7e+06 flops=9.5e+09
 sigma[gemm] counter=67 total t=3.8e-03 per=8.7e+01 cost=4.5e+07 flops=1.2e+10
 sigma[red] counter=67 t=4.0e-04 per=9.2e+00 cost=2.6e+06 flops=6.5e+09
----- TIMING FOR sigma_tot : t_inter=9.9e-03 t_gemm=1.9e-01 t_reduction=2.4e-02 tot=2.3e-01 -----
 sigma_tot[inter] counter=67 t=9.9e-03 per=4.4e+00 cost=2.8e+08 flops=2.9e+10
 sigma_tot[gemm] counter=67 i=0 t=1.5e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=1 t=1.4e-04 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=67 i=2 t=4.6e-02 per=2.1e+01 cost=2.3e+08 flops=5.1e+09
 sigma_tot[gemm] counter=67 i=3 t=6.0e-02 per=2.6e+01 cost=2.3e+08 flops=3.9e+09
 sigma_tot[gemm] counter=67 i=4 t=4.2e-02 per=1.9e+01 cost=2.0e+08 flops=4.7e+09
 sigma_tot[gemm] counter=67 i=5 t=4.4e-02 per=1.9e+01 cost=2.0e+08 flops=4.6e+09
 sigma_tot[gemm] counter=67 total t=1.9e-01 per=8.5e+01 cost=8.6e+08 flops=4.5e+09
 sigma_tot[red] counter=67 t=2.4e-02 per=1.1e+01 cost=6.3e+07 flops=2.6e+09
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.2e-05,2.2e-06,8.3e-06,7.4e-07
    8   0 -    -116.502578238721 -1.358e-07  1.127e-04    3     8  4.629e-02 5.787e-03 5.662e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.073e-05,1.925e-04,3.760e-03,3.952e-04,4.424e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=2.569e-05 speed=1.180e+00GB/S T(nccl)=4.504e-05 speed=6.729e-01GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=3.8e-03 t_reduction=4.0e-04 tot=4.3e-03 -----
 sigma[inter] counter=68 t=1.9e-04 per=4.4e+00 cost=8.5e+06 flops=4.4e+10
 sigma[gemm] counter=68 i=0 t=2.1e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=1 t=2.1e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=68 i=2 t=8.7e-04 per=2.0e+01 cost=1.4e+07 flops=1.6e+10
 sigma[gemm] counter=68 i=3 t=1.1e-03 per=2.5e+01 cost=1.4e+07 flops=1.3e+10
 sigma[gemm] counter=68 i=4 t=9.1e-04 per=2.1e+01 cost=8.6e+06 flops=9.5e+09
 sigma[gemm] counter=68 i=5 t=9.1e-04 per=2.1e+01 cost=8.7e+06 flops=9.5e+09
 sigma[gemm] counter=68 total t=3.8e-03 per=8.6e+01 cost=4.5e+07 flops=1.2e+10
 sigma[red] counter=68 t=4.0e-04 per=9.1e+00 cost=2.6e+06 flops=6.7e+09
----- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=2.0e-01 t_reduction=2.4e-02 tot=2.3e-01 -----
 sigma_tot[inter] counter=68 t=1.0e-02 per=4.4e+00 cost=2.9e+08 flops=2.9e+10
 sigma_tot[gemm] counter=68 i=0 t=1.5e-04 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=1 t=1.4e-04 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=68 i=2 t=4.7e-02 per=2.1e+01 cost=2.5e+08 flops=5.3e+09
 sigma_tot[gemm] counter=68 i=3 t=6.1e-02 per=2.6e+01 cost=2.5e+08 flops=4.1e+09
 sigma_tot[gemm] counter=68 i=4 t=4.3e-02 per=1.9e+01 cost=2.0e+08 flops=4.8e+09
 sigma_tot[gemm] counter=68 i=5 t=4.4e-02 per=1.9e+01 cost=2.1e+08 flops=4.7e+09
 sigma_tot[gemm] counter=68 total t=2.0e-01 per=8.5e+01 cost=9.1e+08 flops=4.7e+09
 sigma_tot[red] counter=68 t=2.4e-02 per=1.1e+01 cost=6.5e+07 flops=2.7e+09
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.2e-05,2.3e-06,8.5e-06,7.2e-07
    9   0 +    -116.502578257621 -1.890e-08  4.041e-05    3     9  5.087e-02 5.652e-03 5.534e-03
TIMING FOR Davidson : 5.088e-02  T(cal/comm/rest)=4.981e-02,4.552e-06,1.075e-03
decomposed t_rest=1.075e-03
 T(sub)    =5.058e-04 per=4.707e+01
 T(precond)=5.655e-05 per=5.262e+00
 T(ortho)  =7.796e-05 per=7.254e+00
 T(xcopy)  =4.065e-05 per=3.783e+00
 T(xnrm2)  =1.185e-05 per=1.102e+00
 T(other)  =3.819e-04 per=3.553e+01
optimized energies: isweep=0 ibond=9 dots=1 e[0]=-116.502578257621 nmvp=9
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=8.446e-03 change=4.163e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=22 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond9.txt
 qbond: qsuper nsym=22 dimAll=292
 (14,2):26 (16,2):39 (15,3):29 (15,1):39 (17,1):24 (16,0):26 (14,0):16 (15,-1):10 (18,2):8 (17,3):16 (16,4):12 (18,0):6 (17,-1):6 (13,1):9 (13,3):7 (14,4):8 (15,5):4 (12,2):3 (12,0):1 (13,-1):1 (18,4):1 (17,5):1
timing for divide=3.6e-06
timing for compute=2.6e-04
timing for collect=1.9e-05
----- TMING FOR decimation_genbasis(nkr): 2.8e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.6e-06,2.5e-04,0.0e+00,4.0e-06,1.9e-05 -----
decimation summary: 292->74 dwt=+0.000e+00 SvN=2.222e+00
 qbond: qkept nsym=9 dimAll=74
 (15,3):15 (15,1):14 (16,2):11 (17,1):10 (17,3):10 (16,4):7 (14,2):5 (13,1):1 (17,5):1
----- TIMING for decimation_row(nkr): 1.579e-03 S T(decim/select/formRot)=3.656e-04,1.185e-03,2.834e-05 -----
----- TIMING FOR onedot_decimation: 1.662e-03 S T(wf/decim)=7.220e-05,1.590e-03 -----
ctns::oper_renorm coord=(10,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:22 S:9 H:1 P:78 Q:84 
        dim(bra,ket)=74,74 size(op)=818:6.241e-03MB size(tot)=87155:6.649e-01MB:6.494e-04GB
        per(mem): C:11 S:4.29 H:0.939 P:24.3 Q:59.5 
rank=0 CPUmem(GB): used=1.352e+00 pageheap_free=8.408e-03 change=3.090e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 1.866e-03 S -----
rank=0 GPUmem(GB): used=1.342e-03 (oper)=1.312e-03
rank=0 GPUmem(GB): used=1.357e-03 (oper,site)=1.312e-03,1.515e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=185
 no. of rintermediate operators=375
 no. of coefficients=3750:2.861e-02MB:2.794e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.031e-04 S -----
rank=0 GPUmem(GB): used=1.385e-03 (oper,site,rinter)=1.312e-03,1.515e-05,2.794e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.089e-03 S size(rtasks)=185 size(Rlst2)=81 T(Rmu/Rlist)=4.039e-04,1.685e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.382e-03 S size(rtasks)=185 size(Rlst)=7913 -----
rank=0 GPUmem(GB): used=1.385e-03 avail=3.829e+01 total=3.829e+01 batch[need]=3.484e-02 blksize=225 blksize0=140 batchsize=7913
rank=0 GPUmem(GB): used=3.623e-02 (oper,site,rinter,batch)=1.312e-03,1.515e-05,2.794e-05,3.484e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.665e-04,1.647e-03,3.126e-04
----- TIMING FOR renorm : t_inter=1.7e-04 t_gemm=1.6e-03 t_reduction=3.1e-04 tot=2.1e-03 -----
 renorm[inter] counter=262 t=1.7e-04 per=7.8e+00 cost=4.0e+06 flops=2.4e+10
 renorm[gemm] counter=262 i=0 t=1.7e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=262 i=1 t=1.6e-06 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=262 i=2 t=1.6e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=262 i=3 t=1.6e-06 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=262 i=4 t=4.3e-04 per=2.0e+01 cost=3.1e+06 flops=7.2e+09
 renorm[gemm] counter=262 i=5 t=6.5e-04 per=3.0e+01 cost=5.3e+06 flops=8.2e+09
 renorm[gemm] counter=262 i=6 t=5.7e-04 per=2.7e+01 cost=1.4e+07 flops=2.5e+10
 renorm[gemm] counter=262 total t=1.6e-03 per=7.7e+01 cost=2.2e+07 flops=1.4e+10
 renorm[red] counter=262 t=3.1e-04 per=1.5e+01 cost=1.7e+06 flops=5.4e+09
----- TIMING FOR renorm_tot : t_inter=1.4e-03 t_gemm=1.1e-02 t_reduction=2.8e-03 tot=1.5e-02 -----
 renorm_tot[inter] counter=262 t=1.4e-03 per=8.9e+00 cost=5.6e+06 flops=4.1e+09
 renorm_tot[gemm] counter=262 i=0 t=2.1e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=262 i=1 t=1.9e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=262 i=2 t=1.9e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=262 i=3 t=1.8e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=262 i=4 t=2.8e-03 per=1.9e+01 cost=3.7e+06 flops=1.3e+09
 renorm_tot[gemm] counter=262 i=5 t=4.3e-03 per=2.8e+01 cost=1.1e+07 flops=2.6e+09
 renorm_tot[gemm] counter=262 i=6 t=4.0e-03 per=2.6e+01 cost=2.2e+07 flops=5.6e+09
 renorm_tot[gemm] counter=262 total t=1.1e-02 per=7.3e+01 cost=3.7e+07 flops=3.3e+09
 renorm_tot[red] counter=262 t=2.8e-03 per=1.8e+01 cost=3.0e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.376e-03 (oper)=1.315e-03
rank=0 GPUmem(GB): used=1.391e-03 (oper,site,rinter)=1.315e-03,1.515e-05,2.682e-06
rank=0 GPUmem(GB): used=1.649e-03 (oper,site,rinter,batch)=1.315e-03,1.515e-05,2.682e-06,2.581e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.106e-02 S T(preprocess/alloc/comp/red/dealloc)=9.127e-04,9.509e-04,7.187e-03,2.805e-03,8.165e-05 -----
----- TIMING FOR oper_renorm_opS : 1.109e-02 S rank=0 -----
qops.to_cpu: size(tot)=87155:6.649e-01MB:6.494e-04GB T(to_cpu)=2.539e-04S speed=2.558e+00GB/S
check ||H-H.dagger||=5.737e-14 coord=(10,0) rank=0
----- TIMING FOR oper_renorm : 0.0222 S rank=0 -----
rank=0 CPUmem(GB): used=1.354e+00 pageheap_free=7.210e-03 change=2.845e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=9.575e-03 change=-4.532e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=9.575e-03 change=-1.827e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 1.085e-01 S #####
 T(local opt: fetch) = 4.453e-03 S  per = 4.11  per(accum) = 4.11
 T(local opt: hdiag) = 1.759e-03 S  per = 1.62  per(accum) = 5.73
 T(local opt: dvdsn) = 7.487e-02 S  per =   69  per(accum) = 74.7
 T(local opt: decim) = 1.708e-03 S  per = 1.58  per(accum) = 76.3
 T(local opt: guess) = 8.411e-05 S  per = 0.0775  per(accum) = 76.4
 T(local opt: renrm) = 2.312e-02 S  per = 21.3  per(accum) = 97.7
 T(local opt: save ) = 2.478e-03 S  per = 2.28  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.487e-02 S  T(sum) = 7.404e-02 S  per = 9.889e+01
 T(local opt: preprocess                  ) = 1.093e-04 S  per = 0.148  per(accum) = 0.148
 T(local opt: symbolic_formulae           ) = 2.099e-03 S  per = 2.84  per(accum) = 2.98
 T(local opt: hintermediate init          ) = 9.940e-05 S  per = 0.134  per(accum) = 3.12
 T(local opt: preprocess_hformulae_Hxlist ) = 9.410e-03 S  per = 12.7  per(accum) = 15.8
 T(local opt: hmmtasks init               ) = 1.142e-02 S  per = 15.4  per(accum) = 31.2
 T(local opt: initial guess for dvdson    ) = 1.584e-05 S  per = 0.0214  per(accum) = 31.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 4.903e-02 S  per = 66.2  per(accum) = 97.5
 T(local opt: dvdson [cpu-gpu]            ) = 3.042e-04 S  per = 0.411  per(accum) = 97.9
 T(local opt: dvdson [nccl]               ) = 4.669e-04 S  per = 0.631  per(accum) = 98.5
 T(local opt: dvdson [mpi]                ) = 4.552e-06 S  per = 0.00615  per(accum) = 98.5
 T(local opt: dvdson [rest part(linalg)]  ) = 1.075e-03 S  per = 1.45  per(accum) = 100
Detailed decomposition of T(renrm) = 2.312e-02 S  T(sum) = 2.312e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.426e-05 S  per = 0.278  per(accum) = 0.278
 T(local opt: qops init                    ) = 7.018e-04 S  per = 3.04  per(accum) = 3.31
 T(local opt: symbolic_formulae_renorm     ) = 1.881e-03 S  per = 8.14  per(accum) = 11.4
 T(local opt: allocate qops on gpu         ) = 2.863e-04 S  per = 1.24  per(accum) = 12.7
 T(local opt: site memcpy cpu2gpu          ) = 3.186e-05 S  per = 0.138  per(accum) = 12.8
 T(local opt: rintermediate init           ) = 1.182e-04 S  per = 0.511  per(accum) = 13.3
 T(local opt: preprocess_formulae_Rlist2   ) = 2.419e-03 S  per = 10.5  per(accum) = 23.8
 T(local opt: rmmtasks init                ) = 2.594e-03 S  per = 11.2  per(accum) = 35
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 0.000186  per(accum) = 35
 T(local opt: preprocess_renorm_batchGPU   ) = 2.409e-03 S  per = 10.4  per(accum) = 45.4
 T(local opt: deallocate cpu and gpu memory) = 4.116e-04 S  per = 1.78  per(accum) = 47.2
 T(local opt: construct opS [ifdists=true] ) = 1.110e-02 S  per =   48  per(accum) = 95.3
 T(local opt: reduction of opS & opH [nccl]) = 1.974e-05 S  per = 0.0854  per(accum) = 95.3
 T(local opt: qops memcpy gpu2cpu          ) = 2.600e-04 S  per = 1.12  per(accum) = 96.5
 T(local opt: reduction of opS & opH [mpi] ) = 1.268e-05 S  per = 0.0549  per(accum) = 96.5
 T(local opt: qops_pool join and erase     ) = 8.018e-04 S  per = 3.47  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.041e-06 S  per = 0.0045  per(accum) = 100
ctns::rcanon_save_site idx=9 scratch=./scratch/sweep size=2034:1.5e-05GB T(load)=0.00057S speed=0.027GB/S
##### sweep opt: 6.605e-01 S #####
 T(sweep opt: fetch) = 3.548e-02 S  per = 5.37  per(accum) = 5.37
 T(sweep opt: hdiag) = 9.816e-03 S  per = 1.49  per(accum) = 6.86
 T(sweep opt: dvdsn) = 3.442e-01 S  per = 52.1  per(accum) = 59
 T(sweep opt: decim) = 1.127e-02 S  per = 1.71  per(accum) = 60.7
 T(sweep opt: guess) = 6.033e-04 S  per = 0.0913  per(accum) = 60.8
 T(sweep opt: renrm) = 2.380e-01 S  per =   36  per(accum) = 96.8
 T(sweep opt: save ) = 2.110e-02 S  per = 3.19  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.442e-01 S  T(sum) = 3.385e-01 S  per = 9.835e+01
 T(sweep opt: preprocess                  ) = 8.033e-04 S  per = 0.237  per(accum) = 0.237
 T(sweep opt: symbolic_formulae           ) = 9.023e-03 S  per = 2.67  per(accum) = 2.9
 T(sweep opt: hintermediate init          ) = 6.158e-04 S  per = 0.182  per(accum) = 3.08
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.778e-02 S  per = 11.2  per(accum) = 14.2
 T(sweep opt: hmmtasks init               ) = 3.801e-02 S  per = 11.2  per(accum) = 25.5
 T(sweep opt: initial guess for dvdson    ) = 6.654e-05 S  per = 0.0197  per(accum) = 25.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.424e-01 S  per = 71.6  per(accum) = 97.1
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.704e-03 S  per = 0.503  per(accum) = 97.6
 T(sweep opt: dvdson [nccl]               ) = 3.226e-03 S  per = 0.953  per(accum) = 98.6
 T(sweep opt: dvdson [mpi]                ) = 2.855e-05 S  per = 0.00843  per(accum) = 98.6
 T(sweep opt: dvdson [rest part(linalg)]  ) = 4.816e-03 S  per = 1.42  per(accum) = 100
Detailed decomposition of T(renrm) = 2.380e-01 S  T(sum) = 2.380e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.384e-04 S  per = 0.226  per(accum) = 0.226
 T(sweep opt: qops init                    ) = 5.613e-03 S  per = 2.36  per(accum) = 2.58
 T(sweep opt: symbolic_formulae_renorm     ) = 3.024e-03 S  per = 1.27  per(accum) = 3.85
 T(sweep opt: allocate qops on gpu         ) = 7.828e-04 S  per = 0.329  per(accum) = 4.18
 T(sweep opt: site memcpy cpu2gpu          ) = 2.487e-04 S  per = 0.104  per(accum) = 4.29
 T(sweep opt: rintermediate init           ) = 5.293e-04 S  per = 0.222  per(accum) = 4.51
 T(sweep opt: preprocess_formulae_Rlist2   ) = 8.628e-03 S  per = 3.62  per(accum) = 8.13
 T(sweep opt: rmmtasks init                ) = 1.002e-02 S  per = 4.21  per(accum) = 12.3
 T(sweep opt: qops memset on cpu           ) = 4.110e-07 S  per = 0.000173  per(accum) = 12.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.675e-02 S  per = 7.04  per(accum) = 19.4
 T(sweep opt: deallocate cpu and gpu memory) = 1.434e-03 S  per = 0.603  per(accum) = 20
 T(sweep opt: construct opS [ifdists=true] ) = 1.746e-01 S  per = 73.4  per(accum) = 93.3
 T(sweep opt: reduction of opS & opH [nccl]) = 2.171e-04 S  per = 0.0912  per(accum) = 93.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 9.601e-04 S  per = 0.403  per(accum) = 93.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.454e-04 S  per = 0.103  per(accum) = 93.9
 T(sweep opt: qops_pool join and erase     ) = 7.585e-03 S  per = 3.19  per(accum) = 97.1
 T(sweep opt: conversion from opAB to opPQ ) = 6.821e-03 S  per = 2.87  per(accum) = 100
##### global opt: 6.605e-01 S #####
 T(global opt: fetch) = 3.548e-02 S  per = 5.37  per(accum) = 5.37
 T(global opt: hdiag) = 9.816e-03 S  per = 1.49  per(accum) = 6.86
 T(global opt: dvdsn) = 3.442e-01 S  per = 52.1  per(accum) = 59
 T(global opt: decim) = 1.127e-02 S  per = 1.71  per(accum) = 60.7
 T(global opt: guess) = 6.033e-04 S  per = 0.0913  per(accum) = 60.8
 T(global opt: renrm) = 2.380e-01 S  per =   36  per(accum) = 96.8
 T(global opt: save ) = 2.110e-02 S  per = 3.19  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.442e-01 S  T(sum) = 3.385e-01 S  per = 9.835e+01
 T(global opt: preprocess                  ) = 8.033e-04 S  per = 0.237  per(accum) = 0.237
 T(global opt: symbolic_formulae           ) = 9.023e-03 S  per = 2.67  per(accum) = 2.9
 T(global opt: hintermediate init          ) = 6.158e-04 S  per = 0.182  per(accum) = 3.08
 T(global opt: preprocess_hformulae_Hxlist ) = 3.778e-02 S  per = 11.2  per(accum) = 14.2
 T(global opt: hmmtasks init               ) = 3.801e-02 S  per = 11.2  per(accum) = 25.5
 T(global opt: initial guess for dvdson    ) = 6.654e-05 S  per = 0.0197  per(accum) = 25.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.424e-01 S  per = 71.6  per(accum) = 97.1
 T(global opt: dvdson [cpu-gpu]            ) = 1.704e-03 S  per = 0.503  per(accum) = 97.6
 T(global opt: dvdson [nccl]               ) = 3.226e-03 S  per = 0.953  per(accum) = 98.6
 T(global opt: dvdson [mpi]                ) = 2.855e-05 S  per = 0.00843  per(accum) = 98.6
 T(global opt: dvdson [rest part(linalg)]  ) = 4.816e-03 S  per = 1.42  per(accum) = 100
Detailed decomposition of T(renrm) = 2.380e-01 S  T(sum) = 2.380e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.384e-04 S  per = 0.226  per(accum) = 0.226
 T(global opt: qops init                    ) = 5.613e-03 S  per = 2.36  per(accum) = 2.58
 T(global opt: symbolic_formulae_renorm     ) = 3.024e-03 S  per = 1.27  per(accum) = 3.85
 T(global opt: allocate qops on gpu         ) = 7.828e-04 S  per = 0.329  per(accum) = 4.18
 T(global opt: site memcpy cpu2gpu          ) = 2.487e-04 S  per = 0.104  per(accum) = 4.29
 T(global opt: rintermediate init           ) = 5.293e-04 S  per = 0.222  per(accum) = 4.51
 T(global opt: preprocess_formulae_Rlist2   ) = 8.628e-03 S  per = 3.62  per(accum) = 8.13
 T(global opt: rmmtasks init                ) = 1.002e-02 S  per = 4.21  per(accum) = 12.3
 T(global opt: qops memset on cpu           ) = 4.110e-07 S  per = 0.000173  per(accum) = 12.3
 T(global opt: preprocess_renorm_batchGPU   ) = 1.675e-02 S  per = 7.04  per(accum) = 19.4
 T(global opt: deallocate cpu and gpu memory) = 1.434e-03 S  per = 0.603  per(accum) = 20
 T(global opt: construct opS [ifdists=true] ) = 1.746e-01 S  per = 73.4  per(accum) = 93.3
 T(global opt: reduction of opS & opH [nccl]) = 2.171e-04 S  per = 0.0912  per(accum) = 93.4
 T(global opt: qops memcpy gpu2cpu          ) = 9.601e-04 S  per = 0.403  per(accum) = 93.8
 T(global opt: reduction of opS & opH [mpi] ) = 2.454e-04 S  per = 0.103  per(accum) = 93.9
 T(global opt: qops_pool join and erase     ) = 7.585e-03 S  per = 3.19  per(accum) = 97.1
 T(global opt: conversion from opAB to opPQ ) = 6.821e-03 S  per = 2.87  per(accum) = 100
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-4.170e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=10/seqsize=34 dots=1 dbond=(11,0)-(12,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=7 scratch=./scratch/sweep size=1941:1.45e-05GB T(load)=3.31e-04S speed=4.36e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=4078:3.11e-02MB:3.04e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=2137:1.63e-02MB:1.59e-05GB
total mem of comb=6363:4.85e-02MB:4.74e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.945e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=11,8,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc= 7
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:22 S:9 H:1 P:78 Q:84 
        dim(bra,ket)=74,74 size(op)=818:6.241e-03MB size(tot)=87155:6.649e-01MB:6.494e-04GB
        per(mem): C:11 S:4.29 H:0.939 P:24.3 Q:59.5 
 rqops: oplist=CSHAB nops=C:16 S:12 H:1 A:60 B:68 
        dim(bra,ket)=77,77 size(op)=845:0.00645MB size(tot)=74671:0.57MB:0.000556GB
        per(mem): C:9.43 S:6.59 H:1.13 A:24.8 B:58.1 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=164162:1.25MB:0.00122GB
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.681e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(11,0) fdel=./scratch/sweep/rop(12,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=5.569e-04 change=-5.566e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(74,77,4) nnz=2137:1.630e-02MB
qtensor3: wf3 own=1 _data=0x55b2c6c31000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=74
 (15,3):15 (15,1):14 (16,2):11 (17,1):10 (17,3):10 (16,4):7 (14,2):5 (13,1):1 (17,5):1
 qbond: qcol nsym=9 dimAll=77
 (13,-1):15 (13,-3):15 (11,-3):10 (11,-1):10 (12,-2):10 (12,-4):7 (14,-2):6 (15,-1):3 (11,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=23 nblocks=324 size=2137:1.630e-02MB
### DIAG TIMING: total=1.307e-03 t1=2.631e-05, t2=1.468e-05, t3=1.413e-05, t4=1.187e-03, t5=1.223e-05, t6=4.302e-05, t7=1.007e-05
duration_diagGPU:1.318e-03
duration_diagreduce:3.100e-08
duration_diagtransform:3.163e-06
----- TIMING FOR symbolic_formulae_onedot with size=665 : 1.647e-03 S -----
rank=0 GPUmem(GB): used=1.223e-03 (oper)=1.223e-03
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=665
 no. of hintermediate operators=332
 no. of coefficients=3652:2.786e-02MB:2.721e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.285e-05 S -----
rank=0 GPUmem(GB): used=1.250e-03 (oper,hinter)=1.223e-03,2.721e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.991e-03 S size(H_formulae)=665 size(Hxlst2)=23 T(Hmu/Hxlist)=3.173e-04,2.674e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.882e-03 S size(H_formulae)=665 size(Hxlst)=9476 -----
rank=0 GPUmem(GB): used=1.250e-03 avail=3.829e+01 total=3.829e+01 dvdson[need]=3.184e-05 batch[need]=4.349e-02 blksize=225 blksize0=165 batchsize=9476
rank=0 GPUmem(GB): used=4.477e-02 (oper,hinter,dvdson,batch)=1.223e-03,2.721e-05,3.184e-05,4.349e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=2137 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.683e-04,1.723e-04,1.817e-03,2.901e-04,2.461e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.767e-05 speed=1.151e+00GB/S T(nccl)=1.406e-04 speed=2.265e-01GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=1.8e-03 t_reduction=2.9e-04 tot=2.3e-03 -----
 sigma[inter] counter=69 t=1.7e-04 per=7.6e+00 cost=8.4e+06 flops=4.9e+10
 sigma[gemm] counter=69 i=0 t=1.9e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=1 t=1.7e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=69 i=2 t=4.3e-04 per=1.9e+01 cost=1.0e+07 flops=2.4e+10
 sigma[gemm] counter=69 i=3 t=5.0e-04 per=2.2e+01 cost=1.0e+07 flops=2.1e+10
 sigma[gemm] counter=69 i=4 t=4.5e-04 per=2.0e+01 cost=8.0e+06 flops=1.8e+10
 sigma[gemm] counter=69 i=5 t=4.3e-04 per=1.9e+01 cost=8.2e+06 flops=1.9e+10
 sigma[gemm] counter=69 total t=1.8e-03 per=8.0e+01 cost=3.7e+07 flops=2.0e+10
 sigma[red] counter=69 t=2.9e-04 per=1.3e+01 cost=1.9e+06 flops=6.7e+09
----- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=2.0e-01 t_reduction=2.5e-02 tot=2.3e-01 -----
 sigma_tot[inter] counter=69 t=1.0e-02 per=4.4e+00 cost=3.0e+08 flops=2.9e+10
 sigma_tot[gemm] counter=69 i=0 t=1.6e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=1 t=1.4e-04 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=69 i=2 t=4.8e-02 per=2.1e+01 cost=2.6e+08 flops=5.4e+09
 sigma_tot[gemm] counter=69 i=3 t=6.1e-02 per=2.6e+01 cost=2.6e+08 flops=4.2e+09
 sigma_tot[gemm] counter=69 i=4 t=4.3e-02 per=1.9e+01 cost=2.1e+08 flops=4.9e+09
 sigma_tot[gemm] counter=69 i=5 t=4.5e-02 per=1.9e+01 cost=2.2e+08 flops=4.9e+09
 sigma_tot[gemm] counter=69 total t=2.0e-01 per=8.5e+01 cost=9.5e+08 flops=4.8e+09
 sigma_tot[red] counter=69 t=2.5e-02 per=1.1e+01 cost=6.7e+07 flops=2.7e+09
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.6e-05,5.0e-06,1.3e-06,3.0e-06,7.5e-07
settings: ndim=2137 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.502578257621 -1.117e+03  9.975e-02    1     1  2.833e-03 2.833e-03 2.778e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.019e-05,1.503e-04,2.239e-03,3.781e-04,2.854e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=3.004e-05 speed=1.060e+00GB/S T(nccl)=5.015e-05 speed=6.349e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=2.2e-03 t_reduction=3.8e-04 tot=2.8e-03 -----
 sigma[inter] counter=70 t=1.5e-04 per=5.4e+00 cost=8.4e+06 flops=5.6e+10
 sigma[gemm] counter=70 i=0 t=2.1e-06 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=1 t=1.9e-06 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=70 i=2 t=5.0e-04 per=1.8e+01 cost=1.0e+07 flops=2.1e+10
 sigma[gemm] counter=70 i=3 t=6.2e-04 per=2.2e+01 cost=1.0e+07 flops=1.7e+10
 sigma[gemm] counter=70 i=4 t=5.8e-04 per=2.1e+01 cost=8.0e+06 flops=1.4e+10
 sigma[gemm] counter=70 i=5 t=5.4e-04 per=2.0e+01 cost=8.2e+06 flops=1.5e+10
 sigma[gemm] counter=70 total t=2.2e-03 per=8.1e+01 cost=3.7e+07 flops=1.7e+10
 sigma[red] counter=70 t=3.8e-04 per=1.4e+01 cost=1.9e+06 flops=5.1e+09
----- TIMING FOR sigma_tot : t_inter=1.0e-02 t_gemm=2.0e-01 t_reduction=2.5e-02 tot=2.3e-01 -----
 sigma_tot[inter] counter=70 t=1.0e-02 per=4.5e+00 cost=3.1e+08 flops=3.0e+10
 sigma_tot[gemm] counter=70 i=0 t=1.6e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=1 t=1.4e-04 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=70 i=2 t=4.8e-02 per=2.1e+01 cost=2.7e+08 flops=5.6e+09
 sigma_tot[gemm] counter=70 i=3 t=6.2e-02 per=2.6e+01 cost=2.7e+08 flops=4.3e+09
 sigma_tot[gemm] counter=70 i=4 t=4.4e-02 per=1.9e+01 cost=2.2e+08 flops=5.0e+09
 sigma_tot[gemm] counter=70 i=5 t=4.5e-02 per=1.9e+01 cost=2.3e+08 flops=5.0e+09
 sigma_tot[gemm] counter=70 total t=2.0e-01 per=8.5e+01 cost=9.8e+08 flops=4.9e+09
 sigma_tot[red] counter=70 t=2.5e-02 per=1.1e+01 cost=6.9e+07 flops=2.8e+09
T(sub)=8.0e-05 T(gemm/eig/ortho/gemm/axpy)=3.2e-05,3.5e-05,3.5e-06,7.9e-06,1.2e-06
    2   0 -    -116.514048981084 -1.147e-02  3.546e-02    2     2  6.115e-03 3.058e-03 2.945e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.698e-05,1.582e-04,2.697e-03,3.765e-04,3.316e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.701e-05 speed=1.179e+00GB/S T(nccl)=4.997e-05 speed=6.373e-01GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=2.7e-03 t_reduction=3.8e-04 tot=3.2e-03 -----
 sigma[inter] counter=71 t=1.6e-04 per=4.9e+00 cost=8.4e+06 flops=5.3e+10
 sigma[gemm] counter=71 i=0 t=2.7e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=1 t=2.2e-06 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=71 i=2 t=6.1e-04 per=1.9e+01 cost=1.0e+07 flops=1.7e+10
 sigma[gemm] counter=71 i=3 t=7.5e-04 per=2.3e+01 cost=1.0e+07 flops=1.4e+10
 sigma[gemm] counter=71 i=4 t=6.8e-04 per=2.1e+01 cost=8.0e+06 flops=1.2e+10
 sigma[gemm] counter=71 i=5 t=6.5e-04 per=2.0e+01 cost=8.2e+06 flops=1.3e+10
 sigma[gemm] counter=71 total t=2.7e-03 per=8.3e+01 cost=3.7e+07 flops=1.4e+10
 sigma[red] counter=71 t=3.8e-04 per=1.2e+01 cost=1.9e+06 flops=5.2e+09
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=2.0e-01 t_reduction=2.5e-02 tot=2.4e-01 -----
 sigma_tot[inter] counter=71 t=1.1e-02 per=4.5e+00 cost=3.2e+08 flops=3.0e+10
 sigma_tot[gemm] counter=71 i=0 t=1.6e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=1 t=1.5e-04 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=71 i=2 t=4.9e-02 per=2.0e+01 cost=2.8e+08 flops=5.7e+09
 sigma_tot[gemm] counter=71 i=3 t=6.2e-02 per=2.6e+01 cost=2.8e+08 flops=4.4e+09
 sigma_tot[gemm] counter=71 i=4 t=4.4e-02 per=1.9e+01 cost=2.3e+08 flops=5.1e+09
 sigma_tot[gemm] counter=71 i=5 t=4.6e-02 per=1.9e+01 cost=2.4e+08 flops=5.1e+09
 sigma_tot[gemm] counter=71 total t=2.0e-01 per=8.5e+01 cost=1.0e+09 flops=5.1e+09
 sigma_tot[red] counter=71 t=2.5e-02 per=1.1e+01 cost=7.1e+07 flops=2.8e+09
T(sub)=6.8e-05 T(gemm/eig/ortho/gemm/axpy)=2.5e-05,2.8e-05,2.6e-06,1.2e-05,1.1e-06
    3   0 -    -116.516202199009 -2.153e-03  1.829e-02    3     3  9.651e-03 3.217e-03 3.106e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.654e-05,1.514e-04,2.670e-03,3.794e-04,3.284e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.668e-05 speed=1.193e+00GB/S T(nccl)=4.986e-05 speed=6.387e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=2.7e-03 t_reduction=3.8e-04 tot=3.2e-03 -----
 sigma[inter] counter=72 t=1.5e-04 per=4.7e+00 cost=8.4e+06 flops=5.6e+10
 sigma[gemm] counter=72 i=0 t=2.6e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=1 t=2.3e-06 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=72 i=2 t=5.9e-04 per=1.8e+01 cost=1.0e+07 flops=1.8e+10
 sigma[gemm] counter=72 i=3 t=7.6e-04 per=2.4e+01 cost=1.0e+07 flops=1.4e+10
 sigma[gemm] counter=72 i=4 t=6.8e-04 per=2.1e+01 cost=8.0e+06 flops=1.2e+10
 sigma[gemm] counter=72 i=5 t=6.4e-04 per=2.0e+01 cost=8.2e+06 flops=1.3e+10
 sigma[gemm] counter=72 total t=2.7e-03 per=8.3e+01 cost=3.7e+07 flops=1.4e+10
 sigma[red] counter=72 t=3.8e-04 per=1.2e+01 cost=1.9e+06 flops=5.1e+09
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=2.0e-01 t_reduction=2.6e-02 tot=2.4e-01 -----
 sigma_tot[inter] counter=72 t=1.1e-02 per=4.5e+00 cost=3.3e+08 flops=3.0e+10
 sigma_tot[gemm] counter=72 i=0 t=1.6e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=1 t=1.5e-04 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=72 i=2 t=4.9e-02 per=2.0e+01 cost=2.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=72 i=3 t=6.3e-02 per=2.6e+01 cost=2.9e+08 flops=4.5e+09
 sigma_tot[gemm] counter=72 i=4 t=4.5e-02 per=1.9e+01 cost=2.4e+08 flops=5.2e+09
 sigma_tot[gemm] counter=72 i=5 t=4.7e-02 per=1.9e+01 cost=2.4e+08 flops=5.2e+09
 sigma_tot[gemm] counter=72 total t=2.0e-01 per=8.5e+01 cost=1.1e+09 flops=5.2e+09
 sigma_tot[red] counter=72 t=2.6e-02 per=1.1e+01 cost=7.3e+07 flops=2.8e+09
T(sub)=5.5e-05 T(gemm/eig/ortho/gemm/axpy)=2.4e-05,1.6e-05,2.7e-06,1.1e-05,1.0e-06
    4   0 -    -116.516820532728 -6.183e-04  9.616e-03    3     4  1.314e-02 3.284e-03 3.177e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.034e-05,1.493e-04,2.686e-03,3.325e-04,3.244e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.343e-05 speed=1.359e+00GB/S T(nccl)=4.690e-05 speed=6.790e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=2.7e-03 t_reduction=3.3e-04 tot=3.2e-03 -----
 sigma[inter] counter=73 t=1.5e-04 per=4.7e+00 cost=8.4e+06 flops=5.6e+10
 sigma[gemm] counter=73 i=0 t=2.7e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=1 t=2.2e-06 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=73 i=2 t=6.1e-04 per=1.9e+01 cost=1.0e+07 flops=1.7e+10
 sigma[gemm] counter=73 i=3 t=7.4e-04 per=2.3e+01 cost=1.0e+07 flops=1.4e+10
 sigma[gemm] counter=73 i=4 t=6.8e-04 per=2.2e+01 cost=8.0e+06 flops=1.2e+10
 sigma[gemm] counter=73 i=5 t=6.5e-04 per=2.0e+01 cost=8.2e+06 flops=1.3e+10
 sigma[gemm] counter=73 total t=2.7e-03 per=8.5e+01 cost=3.7e+07 flops=1.4e+10
 sigma[red] counter=73 t=3.3e-04 per=1.0e+01 cost=1.9e+06 flops=5.8e+09
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=2.1e-01 t_reduction=2.6e-02 tot=2.4e-01 -----
 sigma_tot[inter] counter=73 t=1.1e-02 per=4.5e+00 cost=3.3e+08 flops=3.1e+10
 sigma_tot[gemm] counter=73 i=0 t=1.7e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=1 t=1.5e-04 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=73 i=2 t=5.0e-02 per=2.0e+01 cost=3.0e+08 flops=6.0e+09
 sigma_tot[gemm] counter=73 i=3 t=6.4e-02 per=2.6e+01 cost=3.0e+08 flops=4.7e+09
 sigma_tot[gemm] counter=73 i=4 t=4.6e-02 per=1.9e+01 cost=2.4e+08 flops=5.3e+09
 sigma_tot[gemm] counter=73 i=5 t=4.7e-02 per=1.9e+01 cost=2.5e+08 flops=5.3e+09
 sigma_tot[gemm] counter=73 total t=2.1e-01 per=8.5e+01 cost=1.1e+09 flops=5.3e+09
 sigma_tot[red] counter=73 t=2.6e-02 per=1.1e+01 cost=7.5e+07 flops=2.9e+09
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.2e-05,2.1e-06,8.4e-06,7.3e-07
    5   0 -    -116.516973806603 -1.533e-04  4.306e-03    3     5  1.669e-02 3.338e-03 3.235e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.162e-05,1.484e-04,2.280e-03,3.130e-04,2.820e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.439e-05 speed=1.306e+00GB/S T(nccl)=4.723e-05 speed=6.743e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=2.3e-03 t_reduction=3.1e-04 tot=2.7e-03 -----
 sigma[inter] counter=74 t=1.5e-04 per=5.4e+00 cost=8.4e+06 flops=5.7e+10
 sigma[gemm] counter=74 i=0 t=2.2e-06 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=1 t=2.0e-06 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=74 i=2 t=5.4e-04 per=2.0e+01 cost=1.0e+07 flops=2.0e+10
 sigma[gemm] counter=74 i=3 t=6.4e-04 per=2.3e+01 cost=1.0e+07 flops=1.6e+10
 sigma[gemm] counter=74 i=4 t=5.6e-04 per=2.0e+01 cost=8.0e+06 flops=1.4e+10
 sigma[gemm] counter=74 i=5 t=5.4e-04 per=2.0e+01 cost=8.2e+06 flops=1.5e+10
 sigma[gemm] counter=74 total t=2.3e-03 per=8.3e+01 cost=3.7e+07 flops=1.6e+10
 sigma[red] counter=74 t=3.1e-04 per=1.1e+01 cost=1.9e+06 flops=6.2e+09
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=2.1e-01 t_reduction=2.6e-02 tot=2.5e-01 -----
 sigma_tot[inter] counter=74 t=1.1e-02 per=4.5e+00 cost=3.4e+08 flops=3.1e+10
 sigma_tot[gemm] counter=74 i=0 t=1.7e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=1 t=1.5e-04 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=74 i=2 t=5.0e-02 per=2.0e+01 cost=3.1e+08 flops=6.2e+09
 sigma_tot[gemm] counter=74 i=3 t=6.5e-02 per=2.6e+01 cost=3.1e+08 flops=4.8e+09
 sigma_tot[gemm] counter=74 i=4 t=4.6e-02 per=1.9e+01 cost=2.5e+08 flops=5.5e+09
 sigma_tot[gemm] counter=74 i=5 t=4.8e-02 per=1.9e+01 cost=2.6e+08 flops=5.4e+09
 sigma_tot[gemm] counter=74 total t=2.1e-01 per=8.5e+01 cost=1.1e+09 flops=5.4e+09
 sigma_tot[red] counter=74 t=2.6e-02 per=1.1e+01 cost=7.7e+07 flops=2.9e+09
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.3e-05,2.1e-06,8.4e-06,7.3e-07
    6   0 -    -116.516999924279 -2.612e-05  1.557e-03    3     6  1.991e-02 3.318e-03 3.213e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.009e-05,1.401e-04,2.204e-03,3.145e-04,2.735e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.354e-05 speed=1.353e+00GB/S T(nccl)=4.655e-05 speed=6.841e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=2.2e-03 t_reduction=3.1e-04 tot=2.7e-03 -----
 sigma[inter] counter=75 t=1.4e-04 per=5.3e+00 cost=8.4e+06 flops=6.0e+10
 sigma[gemm] counter=75 i=0 t=1.9e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=1 t=1.8e-06 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=75 i=2 t=5.0e-04 per=1.9e+01 cost=1.0e+07 flops=2.1e+10
 sigma[gemm] counter=75 i=3 t=6.1e-04 per=2.3e+01 cost=1.0e+07 flops=1.7e+10
 sigma[gemm] counter=75 i=4 t=5.6e-04 per=2.1e+01 cost=8.0e+06 flops=1.4e+10
 sigma[gemm] counter=75 i=5 t=5.3e-04 per=2.0e+01 cost=8.2e+06 flops=1.5e+10
 sigma[gemm] counter=75 total t=2.2e-03 per=8.3e+01 cost=3.7e+07 flops=1.7e+10
 sigma[red] counter=75 t=3.1e-04 per=1.2e+01 cost=1.9e+06 flops=6.2e+09
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=2.1e-01 t_reduction=2.7e-02 tot=2.5e-01 -----
 sigma_tot[inter] counter=75 t=1.1e-02 per=4.5e+00 cost=3.5e+08 flops=3.1e+10
 sigma_tot[gemm] counter=75 i=0 t=1.7e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=1 t=1.6e-04 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=75 i=2 t=5.1e-02 per=2.0e+01 cost=3.2e+08 flops=6.3e+09
 sigma_tot[gemm] counter=75 i=3 t=6.5e-02 per=2.6e+01 cost=3.2e+08 flops=4.9e+09
 sigma_tot[gemm] counter=75 i=4 t=4.7e-02 per=1.9e+01 cost=2.6e+08 flops=5.6e+09
 sigma_tot[gemm] counter=75 i=5 t=4.8e-02 per=1.9e+01 cost=2.7e+08 flops=5.5e+09
 sigma_tot[gemm] counter=75 total t=2.1e-01 per=8.5e+01 cost=1.2e+09 flops=5.5e+09
 sigma_tot[red] counter=75 t=2.7e-02 per=1.1e+01 cost=7.9e+07 flops=3.0e+09
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.2e-05,2.2e-06,8.5e-06,7.5e-07
    7   0 -    -116.517003493527 -3.569e-06  6.832e-04    3     7  2.281e-02 3.258e-03 3.158e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.205e-05,1.256e-04,2.270e-03,3.098e-04,2.783e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.501e-05 speed=1.273e+00GB/S T(nccl)=4.704e-05 speed=6.769e-01GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=2.3e-03 t_reduction=3.1e-04 tot=2.7e-03 -----
 sigma[inter] counter=76 t=1.3e-04 per=4.6e+00 cost=8.4e+06 flops=6.7e+10
 sigma[gemm] counter=76 i=0 t=2.1e-06 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=1 t=2.0e-06 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=76 i=2 t=5.3e-04 per=2.0e+01 cost=1.0e+07 flops=2.0e+10
 sigma[gemm] counter=76 i=3 t=6.5e-04 per=2.4e+01 cost=1.0e+07 flops=1.6e+10
 sigma[gemm] counter=76 i=4 t=5.6e-04 per=2.1e+01 cost=8.0e+06 flops=1.4e+10
 sigma[gemm] counter=76 i=5 t=5.3e-04 per=1.9e+01 cost=8.2e+06 flops=1.6e+10
 sigma[gemm] counter=76 total t=2.3e-03 per=8.4e+01 cost=3.7e+07 flops=1.6e+10
 sigma[red] counter=76 t=3.1e-04 per=1.1e+01 cost=1.9e+06 flops=6.3e+09
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=2.1e-01 t_reduction=2.7e-02 tot=2.5e-01 -----
 sigma_tot[inter] counter=76 t=1.1e-02 per=4.5e+00 cost=3.6e+08 flops=3.2e+10
 sigma_tot[gemm] counter=76 i=0 t=1.7e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=1 t=1.6e-04 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=76 i=2 t=5.1e-02 per=2.0e+01 cost=3.3e+08 flops=6.4e+09
 sigma_tot[gemm] counter=76 i=3 t=6.6e-02 per=2.6e+01 cost=3.3e+08 flops=5.0e+09
 sigma_tot[gemm] counter=76 i=4 t=4.7e-02 per=1.9e+01 cost=2.7e+08 flops=5.7e+09
 sigma_tot[gemm] counter=76 i=5 t=4.9e-02 per=1.9e+01 cost=2.8e+08 flops=5.6e+09
 sigma_tot[gemm] counter=76 total t=2.1e-01 per=8.5e+01 cost=1.2e+09 flops=5.6e+09
 sigma_tot[red] counter=76 t=2.7e-02 per=1.1e+01 cost=8.1e+07 flops=3.0e+09
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=2.5e-05,1.2e-05,2.2e-06,8.5e-06,7.5e-07
    8   0 -    -116.517004212978 -7.195e-07  3.438e-04    3     8  2.575e-02 3.219e-03 3.122e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.023e-05,1.358e-04,2.192e-03,3.141e-04,2.718e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.367e-05 speed=1.345e+00GB/S T(nccl)=4.656e-05 speed=6.839e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=2.2e-03 t_reduction=3.1e-04 tot=2.6e-03 -----
 sigma[inter] counter=77 t=1.4e-04 per=5.1e+00 cost=8.4e+06 flops=6.2e+10
 sigma[gemm] counter=77 i=0 t=2.4e-06 per=9.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=1 t=2.0e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=77 i=2 t=5.0e-04 per=1.9e+01 cost=1.0e+07 flops=2.1e+10
 sigma[gemm] counter=77 i=3 t=6.1e-04 per=2.3e+01 cost=1.0e+07 flops=1.7e+10
 sigma[gemm] counter=77 i=4 t=5.5e-04 per=2.1e+01 cost=8.0e+06 flops=1.5e+10
 sigma[gemm] counter=77 i=5 t=5.3e-04 per=2.0e+01 cost=8.2e+06 flops=1.5e+10
 sigma[gemm] counter=77 total t=2.2e-03 per=8.3e+01 cost=3.7e+07 flops=1.7e+10
 sigma[red] counter=77 t=3.1e-04 per=1.2e+01 cost=1.9e+06 flops=6.2e+09
----- TIMING FOR sigma_tot : t_inter=1.1e-02 t_gemm=2.2e-01 t_reduction=2.7e-02 tot=2.5e-01 -----
 sigma_tot[inter] counter=77 t=1.1e-02 per=4.5e+00 cost=3.7e+08 flops=3.2e+10
 sigma_tot[gemm] counter=77 i=0 t=1.8e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=1 t=1.6e-04 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=77 i=2 t=5.2e-02 per=2.0e+01 cost=3.4e+08 flops=6.6e+09
 sigma_tot[gemm] counter=77 i=3 t=6.6e-02 per=2.6e+01 cost=3.4e+08 flops=5.1e+09
 sigma_tot[gemm] counter=77 i=4 t=4.8e-02 per=1.9e+01 cost=2.8e+08 flops=5.8e+09
 sigma_tot[gemm] counter=77 i=5 t=4.9e-02 per=1.9e+01 cost=2.8e+08 flops=5.7e+09
 sigma_tot[gemm] counter=77 total t=2.2e-01 per=8.5e+01 cost=1.2e+09 flops=5.7e+09
 sigma_tot[red] counter=77 t=2.7e-02 per=1.1e+01 cost=8.3e+07 flops=3.0e+09
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.2e-05,2.0e-06,8.5e-06,7.2e-07
    9   0 -    -116.517004407076 -1.941e-07  1.563e-04    3     9  2.864e-02 3.182e-03 3.086e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.984e-05,1.559e-04,2.265e-03,3.114e-04,2.807e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.354e-05 speed=1.353e+00GB/S T(nccl)=4.630e-05 speed=6.877e-01GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=2.3e-03 t_reduction=3.1e-04 tot=2.7e-03 -----
 sigma[inter] counter=78 t=1.6e-04 per=5.7e+00 cost=8.4e+06 flops=5.4e+10
 sigma[gemm] counter=78 i=0 t=2.1e-06 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=1 t=2.0e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=78 i=2 t=5.4e-04 per=2.0e+01 cost=1.0e+07 flops=1.9e+10
 sigma[gemm] counter=78 i=3 t=6.4e-04 per=2.3e+01 cost=1.0e+07 flops=1.6e+10
 sigma[gemm] counter=78 i=4 t=5.5e-04 per=2.0e+01 cost=8.0e+06 flops=1.5e+10
 sigma[gemm] counter=78 i=5 t=5.3e-04 per=1.9e+01 cost=8.2e+06 flops=1.5e+10
 sigma[gemm] counter=78 total t=2.3e-03 per=8.3e+01 cost=3.7e+07 flops=1.6e+10
 sigma[red] counter=78 t=3.1e-04 per=1.1e+01 cost=1.9e+06 flops=6.2e+09
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=2.2e-01 t_reduction=2.8e-02 tot=2.6e-01 -----
 sigma_tot[inter] counter=78 t=1.2e-02 per=4.5e+00 cost=3.8e+08 flops=3.2e+10
 sigma_tot[gemm] counter=78 i=0 t=1.8e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=1 t=1.6e-04 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=78 i=2 t=5.3e-02 per=2.0e+01 cost=3.5e+08 flops=6.7e+09
 sigma_tot[gemm] counter=78 i=3 t=6.7e-02 per=2.6e+01 cost=3.5e+08 flops=5.2e+09
 sigma_tot[gemm] counter=78 i=4 t=4.8e-02 per=1.9e+01 cost=2.8e+08 flops=5.9e+09
 sigma_tot[gemm] counter=78 i=5 t=5.0e-02 per=1.9e+01 cost=2.9e+08 flops=5.8e+09
 sigma_tot[gemm] counter=78 total t=2.2e-01 per=8.5e+01 cost=1.3e+09 flops=5.9e+09
 sigma_tot[red] counter=78 t=2.8e-02 per=1.1e+01 cost=8.5e+07 flops=3.1e+09
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.2e-05,2.2e-06,8.3e-06,7.3e-07
   10   0 +    -116.517004448238 -4.116e-08  6.686e-05    3    10  3.195e-02 3.195e-03 3.101e-03
TIMING FOR Davidson : 3.196e-02  T(cal/comm/rest)=3.101e-02,3.968e-06,9.434e-04
decomposed t_rest=9.434e-04
 T(sub)    =4.913e-04 per=5.208e+01
 T(precond)=5.235e-05 per=5.549e+00
 T(ortho)  =6.981e-05 per=7.400e+00
 T(xcopy)  =5.198e-06 per=5.510e-01
 T(xnrm2)  =1.155e-05 per=1.224e+00
 T(other)  =3.132e-04 per=3.319e+01
optimized energies: isweep=0 ibond=10 dots=1 e[0]=-116.517004448238 nmvp=10
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=2.388e-03 change=2.583e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond10.txt
 qbond: qsuper nsym=18 dimAll=296
 (15,3):20 (17,3):43 (16,4):22 (16,2):45 (15,1):20 (17,1):35 (16,0):14 (18,2):31 (19,1):10 (18,0):10 (19,3):10 (18,4):18 (17,5):8 (14,2):6 (13,1):1 (14,0):1 (19,5):1 (18,6):1
timing for divide=3.5e-06
timing for compute=3.4e-04
timing for collect=7.6e-06
----- TMING FOR decimation_genbasis(nkr): 3.5e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.5e-06,3.3e-04,0.0e+00,2.3e-06,7.6e-06 -----
decimation summary: 296->77 dwt=+6.661e-16 SvN=2.016e+00
 qbond: qkept nsym=9 dimAll=77
 (17,3):15 (17,1):15 (18,2):10 (19,1):10 (19,3):10 (18,4):7 (16,2):6 (15,1):3 (19,5):1
----- TIMING for decimation_row(nkr): 1.508e-03 S T(decim/select/formRot)=3.746e-04,1.118e-03,1.573e-05 -----
----- TIMING FOR onedot_decimation: 1.548e-03 S T(wf/decim)=3.028e-05,1.518e-03 -----
ctns::oper_renorm coord=(11,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:24 S:8 H:1 P:60 Q:68 
        dim(bra,ket)=77,77 size(op)=845:6.447e-03MB size(tot)=76551:5.840e-01MB:5.703e-04GB
        per(mem): C:13.8 S:4.28 H:1.1 P:24.1 Q:56.7 
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=2.335e-03 change=2.509e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=153 : 1.575e-03 S -----
rank=0 GPUmem(GB): used=1.264e-03 (oper)=1.237e-03
rank=0 GPUmem(GB): used=1.280e-03 (oper,site)=1.237e-03,1.592e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=153
 no. of rintermediate operators=300
 no. of coefficients=3300:2.518e-02MB:2.459e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 6.975e-05 S -----
rank=0 GPUmem(GB): used=1.305e-03 (oper,site,rinter)=1.237e-03,1.592e-05,2.459e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.481e-03 S size(rtasks)=153 size(Rlst2)=81 T(Rmu/Rlist)=2.799e-04,1.201e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.949e-03 S size(rtasks)=153 size(Rlst)=4628 -----
rank=0 GPUmem(GB): used=1.305e-03 avail=3.829e+01 total=3.829e+01 batch[need]=2.124e-02 blksize=225 blksize0=165 batchsize=4628
rank=0 GPUmem(GB): used=2.255e-02 (oper,site,rinter,batch)=1.237e-03,1.592e-05,2.459e-05,2.124e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.272e-04,1.057e-03,2.347e-04
----- TIMING FOR renorm : t_inter=1.3e-04 t_gemm=1.1e-03 t_reduction=2.3e-04 tot=1.4e-03 -----
 renorm[inter] counter=281 t=1.3e-04 per=9.0e+00 cost=3.9e+06 flops=3.1e+10
 renorm[gemm] counter=281 i=0 t=1.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=281 i=1 t=1.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=281 i=2 t=1.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=281 i=3 t=1.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=281 i=4 t=3.0e-04 per=2.1e+01 cost=2.7e+06 flops=9.0e+09
 renorm[gemm] counter=281 i=5 t=3.9e-04 per=2.8e+01 cost=5.3e+06 flops=1.4e+10
 renorm[gemm] counter=281 i=6 t=3.6e-04 per=2.5e+01 cost=1.0e+07 flops=2.9e+10
 renorm[gemm] counter=281 total t=1.1e-03 per=7.5e+01 cost=1.8e+07 flops=1.8e+10
 renorm[red] counter=281 t=2.3e-04 per=1.7e+01 cost=9.8e+05 flops=4.2e+09
----- TIMING FOR renorm_tot : t_inter=1.5e-03 t_gemm=1.2e-02 t_reduction=3.0e-03 tot=1.7e-02 -----
 renorm_tot[inter] counter=281 t=1.5e-03 per=8.9e+00 cost=9.5e+06 flops=6.4e+09
 renorm_tot[gemm] counter=281 i=0 t=2.3e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=281 i=1 t=2.0e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=281 i=2 t=2.0e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=281 i=3 t=2.0e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=281 i=4 t=3.1e-03 per=1.9e+01 cost=6.4e+06 flops=2.0e+09
 renorm_tot[gemm] counter=281 i=5 t=4.7e-03 per=2.8e+01 cost=1.7e+07 flops=3.5e+09
 renorm_tot[gemm] counter=281 i=6 t=4.3e-03 per=2.6e+01 cost=3.3e+07 flops=7.5e+09
 renorm_tot[gemm] counter=281 total t=1.2e-02 per=7.3e+01 cost=5.6e+07 flops=4.5e+09
 renorm_tot[red] counter=281 t=3.0e-03 per=1.8e+01 cost=4.0e+06 flops=1.3e+09
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.295e-03 (oper)=1.241e-03
rank=0 GPUmem(GB): used=1.311e-03 (oper,site,rinter)=1.241e-03,1.592e-05,2.623e-06
rank=0 GPUmem(GB): used=1.490e-03 (oper,site,rinter,batch)=1.241e-03,1.592e-05,2.623e-06,1.790e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 8.071e-03 S T(preprocess/alloc/comp/red/dealloc)=7.279e-04,8.519e-04,5.077e-03,2.031e-03,8.070e-05 -----
----- TIMING FOR oper_renorm_opS : 8.106e-03 S rank=0 -----
qops.to_cpu: size(tot)=76551:5.840e-01MB:5.703e-04GB T(to_cpu)=3.998e-04S speed=1.427e+00GB/S
check ||H-H.dagger||=8.564e-14 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.0164 S rank=0 -----
rank=0 CPUmem(GB): used=1.352e+00 pageheap_free=3.563e-03 change=1.967e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=7.339e-03 change=-3.477e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=7.339e-03 change=-2.147e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 6.868e-02 S #####
 T(local opt: fetch) = 3.861e-03 S  per = 5.62  per(accum) = 5.62
 T(local opt: hdiag) = 1.353e-03 S  per = 1.97  per(accum) = 7.59
 T(local opt: dvdsn) = 4.233e-02 S  per = 61.6  per(accum) = 69.2
 T(local opt: decim) = 1.582e-03 S  per =  2.3  per(accum) = 71.5
 T(local opt: guess) = 6.899e-05 S  per =  0.1  per(accum) = 71.6
 T(local opt: renrm) = 1.713e-02 S  per = 24.9  per(accum) = 96.6
 T(local opt: save ) = 2.354e-03 S  per = 3.43  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.233e-02 S  T(sum) = 4.163e-02 S  per = 9.833e+01
 T(local opt: preprocess                  ) = 8.318e-05 S  per =  0.2  per(accum) = 0.2
 T(local opt: symbolic_formulae           ) = 1.665e-03 S  per =    4  per(accum) = 4.2
 T(local opt: hintermediate init          ) = 8.275e-05 S  per = 0.199  per(accum) = 4.4
 T(local opt: preprocess_hformulae_Hxlist ) = 3.933e-03 S  per = 9.45  per(accum) = 13.8
 T(local opt: hmmtasks init               ) = 3.889e-03 S  per = 9.34  per(accum) = 23.2
 T(local opt: initial guess for dvdson    ) = 1.492e-05 S  per = 0.0358  per(accum) = 23.2
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.019e-02 S  per = 72.5  per(accum) = 95.7
 T(local opt: dvdson [cpu-gpu]            ) = 2.550e-04 S  per = 0.613  per(accum) = 96.4
 T(local opt: dvdson [nccl]               ) = 5.712e-04 S  per = 1.37  per(accum) = 97.7
 T(local opt: dvdson [mpi]                ) = 3.968e-06 S  per = 0.00953  per(accum) = 97.7
 T(local opt: dvdson [rest part(linalg)]  ) = 9.434e-04 S  per = 2.27  per(accum) = 100
Detailed decomposition of T(renrm) = 1.713e-02 S  T(sum) = 1.713e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.327e-05 S  per = 0.311  per(accum) = 0.311
 T(local opt: qops init                    ) = 6.016e-04 S  per = 3.51  per(accum) = 3.82
 T(local opt: symbolic_formulae_renorm     ) = 1.582e-03 S  per = 9.23  per(accum) = 13.1
 T(local opt: allocate qops on gpu         ) = 5.426e-05 S  per = 0.317  per(accum) = 13.4
 T(local opt: site memcpy cpu2gpu          ) = 2.320e-05 S  per = 0.135  per(accum) = 13.5
 T(local opt: rintermediate init           ) = 7.665e-05 S  per = 0.448  per(accum) = 14
 T(local opt: preprocess_formulae_Rlist2   ) = 1.968e-03 S  per = 11.5  per(accum) = 25.5
 T(local opt: rmmtasks init                ) = 1.730e-03 S  per = 10.1  per(accum) = 35.6
 T(local opt: qops memset on cpu           ) = 6.800e-08 S  per = 0.000397  per(accum) = 35.6
 T(local opt: preprocess_renorm_batchGPU   ) = 1.488e-03 S  per = 8.69  per(accum) = 44.2
 T(local opt: deallocate cpu and gpu memory) = 2.462e-04 S  per = 1.44  per(accum) = 45.7
 T(local opt: construct opS [ifdists=true] ) = 8.155e-03 S  per = 47.6  per(accum) = 93.3
 T(local opt: reduction of opS & opH [nccl]) = 1.996e-05 S  per = 0.117  per(accum) = 93.4
 T(local opt: qops memcpy gpu2cpu          ) = 4.178e-04 S  per = 2.44  per(accum) = 95.8
 T(local opt: reduction of opS & opH [mpi] ) = 1.399e-05 S  per = 0.0817  per(accum) = 95.9
 T(local opt: qops_pool join and erase     ) = 6.965e-04 S  per = 4.07  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 9.630e-07 S  per = 0.00562  per(accum) = 100
ctns::rcanon_save_site idx=8 scratch=./scratch/sweep size=2137:1.6e-05GB T(load)=0.0006S speed=0.026GB/S
##### sweep opt: 7.292e-01 S #####
 T(sweep opt: fetch) = 3.934e-02 S  per = 5.39  per(accum) = 5.39
 T(sweep opt: hdiag) = 1.117e-02 S  per = 1.53  per(accum) = 6.93
 T(sweep opt: dvdsn) = 3.865e-01 S  per =   53  per(accum) = 59.9
 T(sweep opt: decim) = 1.285e-02 S  per = 1.76  per(accum) = 61.7
 T(sweep opt: guess) = 6.723e-04 S  per = 0.0922  per(accum) = 61.8
 T(sweep opt: renrm) = 2.552e-01 S  per =   35  per(accum) = 96.8
 T(sweep opt: save ) = 2.345e-02 S  per = 3.22  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.865e-01 S  T(sum) = 3.802e-01 S  per = 9.835e+01
 T(sweep opt: preprocess                  ) = 8.865e-04 S  per = 0.233  per(accum) = 0.233
 T(sweep opt: symbolic_formulae           ) = 1.069e-02 S  per = 2.81  per(accum) = 3.04
 T(sweep opt: hintermediate init          ) = 6.986e-04 S  per = 0.184  per(accum) = 3.23
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.171e-02 S  per =   11  per(accum) = 14.2
 T(sweep opt: hmmtasks init               ) = 4.190e-02 S  per =   11  per(accum) = 25.2
 T(sweep opt: initial guess for dvdson    ) = 8.147e-05 S  per = 0.0214  per(accum) = 25.2
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.726e-01 S  per = 71.7  per(accum) = 97
 T(sweep opt: dvdson [cpu-gpu]            ) = 1.959e-03 S  per = 0.515  per(accum) = 97.5
 T(sweep opt: dvdson [nccl]               ) = 3.797e-03 S  per = 0.999  per(accum) = 98.5
 T(sweep opt: dvdson [mpi]                ) = 3.251e-05 S  per = 0.00855  per(accum) = 98.5
 T(sweep opt: dvdson [rest part(linalg)]  ) = 5.759e-03 S  per = 1.51  per(accum) = 100
Detailed decomposition of T(renrm) = 2.552e-01 S  T(sum) = 2.552e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.917e-04 S  per = 0.232  per(accum) = 0.232
 T(sweep opt: qops init                    ) = 6.214e-03 S  per = 2.44  per(accum) = 2.67
 T(sweep opt: symbolic_formulae_renorm     ) = 4.606e-03 S  per = 1.81  per(accum) = 4.47
 T(sweep opt: allocate qops on gpu         ) = 8.371e-04 S  per = 0.328  per(accum) = 4.8
 T(sweep opt: site memcpy cpu2gpu          ) = 2.719e-04 S  per = 0.107  per(accum) = 4.91
 T(sweep opt: rintermediate init           ) = 6.060e-04 S  per = 0.237  per(accum) = 5.14
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.060e-02 S  per = 4.15  per(accum) = 9.3
 T(sweep opt: rmmtasks init                ) = 1.175e-02 S  per =  4.6  per(accum) = 13.9
 T(sweep opt: qops memset on cpu           ) = 4.790e-07 S  per = 0.000188  per(accum) = 13.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.824e-02 S  per = 7.15  per(accum) = 21
 T(sweep opt: deallocate cpu and gpu memory) = 1.680e-03 S  per = 0.659  per(accum) = 21.7
 T(sweep opt: construct opS [ifdists=true] ) = 1.828e-01 S  per = 71.6  per(accum) = 93.3
 T(sweep opt: reduction of opS & opH [nccl]) = 2.371e-04 S  per = 0.0929  per(accum) = 93.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.378e-03 S  per = 0.54  per(accum) = 94
 T(sweep opt: reduction of opS & opH [mpi] ) = 2.594e-04 S  per = 0.102  per(accum) = 94.1
 T(sweep opt: qops_pool join and erase     ) = 8.282e-03 S  per = 3.25  per(accum) = 97.3
 T(sweep opt: conversion from opAB to opPQ ) = 6.822e-03 S  per = 2.67  per(accum) = 100
##### global opt: 7.292e-01 S #####
 T(global opt: fetch) = 3.934e-02 S  per = 5.39  per(accum) = 5.39
 T(global opt: hdiag) = 1.117e-02 S  per = 1.53  per(accum) = 6.93
 T(global opt: dvdsn) = 3.865e-01 S  per =   53  per(accum) = 59.9
 T(global opt: decim) = 1.285e-02 S  per = 1.76  per(accum) = 61.7
 T(global opt: guess) = 6.723e-04 S  per = 0.0922  per(accum) = 61.8
 T(global opt: renrm) = 2.552e-01 S  per =   35  per(accum) = 96.8
 T(global opt: save ) = 2.345e-02 S  per = 3.22  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.865e-01 S  T(sum) = 3.802e-01 S  per = 9.835e+01
 T(global opt: preprocess                  ) = 8.865e-04 S  per = 0.233  per(accum) = 0.233
 T(global opt: symbolic_formulae           ) = 1.069e-02 S  per = 2.81  per(accum) = 3.04
 T(global opt: hintermediate init          ) = 6.986e-04 S  per = 0.184  per(accum) = 3.23
 T(global opt: preprocess_hformulae_Hxlist ) = 4.171e-02 S  per =   11  per(accum) = 14.2
 T(global opt: hmmtasks init               ) = 4.190e-02 S  per =   11  per(accum) = 25.2
 T(global opt: initial guess for dvdson    ) = 8.147e-05 S  per = 0.0214  per(accum) = 25.2
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.726e-01 S  per = 71.7  per(accum) = 97
 T(global opt: dvdson [cpu-gpu]            ) = 1.959e-03 S  per = 0.515  per(accum) = 97.5
 T(global opt: dvdson [nccl]               ) = 3.797e-03 S  per = 0.999  per(accum) = 98.5
 T(global opt: dvdson [mpi]                ) = 3.251e-05 S  per = 0.00855  per(accum) = 98.5
 T(global opt: dvdson [rest part(linalg)]  ) = 5.759e-03 S  per = 1.51  per(accum) = 100
Detailed decomposition of T(renrm) = 2.552e-01 S  T(sum) = 2.552e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.917e-04 S  per = 0.232  per(accum) = 0.232
 T(global opt: qops init                    ) = 6.214e-03 S  per = 2.44  per(accum) = 2.67
 T(global opt: symbolic_formulae_renorm     ) = 4.606e-03 S  per = 1.81  per(accum) = 4.47
 T(global opt: allocate qops on gpu         ) = 8.371e-04 S  per = 0.328  per(accum) = 4.8
 T(global opt: site memcpy cpu2gpu          ) = 2.719e-04 S  per = 0.107  per(accum) = 4.91
 T(global opt: rintermediate init           ) = 6.060e-04 S  per = 0.237  per(accum) = 5.14
 T(global opt: preprocess_formulae_Rlist2   ) = 1.060e-02 S  per = 4.15  per(accum) = 9.3
 T(global opt: rmmtasks init                ) = 1.175e-02 S  per =  4.6  per(accum) = 13.9
 T(global opt: qops memset on cpu           ) = 4.790e-07 S  per = 0.000188  per(accum) = 13.9
 T(global opt: preprocess_renorm_batchGPU   ) = 1.824e-02 S  per = 7.15  per(accum) = 21
 T(global opt: deallocate cpu and gpu memory) = 1.680e-03 S  per = 0.659  per(accum) = 21.7
 T(global opt: construct opS [ifdists=true] ) = 1.828e-01 S  per = 71.6  per(accum) = 93.3
 T(global opt: reduction of opS & opH [nccl]) = 2.371e-04 S  per = 0.0929  per(accum) = 93.4
 T(global opt: qops memcpy gpu2cpu          ) = 1.378e-03 S  per = 0.54  per(accum) = 94
 T(global opt: reduction of opS & opH [mpi] ) = 2.594e-04 S  per = 0.102  per(accum) = 94.1
 T(global opt: qops_pool join and erase     ) = 8.282e-03 S  per = 3.25  per(accum) = 97.3
 T(global opt: conversion from opAB to opPQ ) = 6.822e-03 S  per = 2.67  per(accum) = 100
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-2.588e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=11/seqsize=34 dots=1 dbond=(12,0)-(13,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=6 scratch=./scratch/sweep size=1493:1.11e-05GB T(load)=3.08e-04S speed=3.61e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=3434:2.62e-02MB:2.56e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1941:1.48e-02MB:1.45e-05GB
total mem of comb=5523:4.21e-02MB:4.11e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.563e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=12,7,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc= 8
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:24 S:8 H:1 P:60 Q:68 
        dim(bra,ket)=77,77 size(op)=845:6.447e-03MB size(tot)=76551:5.840e-01MB:5.703e-04GB
        per(mem): C:13.8 S:4.28 H:1.1 P:24.1 Q:56.7 
 rqops: oplist=CSHAB nops=C:14 S:13 H:1 A:47 B:51 
        dim(bra,ket)=68,68 size(op)=652:0.00497MB size(tot)=45154:0.344MB:0.000336GB
        per(mem): C:11.3 S:9.33 H:1.44 A:23.4 B:54.5 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=124041:0.946MB:0.000924GB
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.418e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(12,0) fdel=./scratch/sweep/rop(13,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=3.433e-04 change=-3.430e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(77,68,4) nnz=1941:1.481e-02MB
qtensor3: wf3 own=1 _data=0x55b2c5bf0000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=77
 (17,3):15 (17,1):15 (18,2):10 (19,1):10 (19,3):10 (18,4):7 (16,2):6 (15,1):3 (19,5):1
 qbond: qcol nsym=9 dimAll=68
 (11,-3):14 (11,-1):12 (9,-3):10 (10,-2):9 (12,-2):7 (9,-1):6 (10,-4):6 (13,-1):3 (9,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=23 nblocks=324 size=1941:1.481e-02MB
### DIAG TIMING: total=9.733e-04 t1=1.987e-05, t2=1.232e-05, t3=1.386e-05, t4=8.680e-04, t5=1.024e-05, t6=4.088e-05, t7=8.153e-06
duration_diagGPU:9.819e-04
duration_diagreduce:6.700e-08
duration_diagtransform:1.967e-06
----- TIMING FOR symbolic_formulae_onedot with size=525 : 1.103e-03 S -----
rank=0 GPUmem(GB): used=9.242e-04 (oper)=9.242e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=525
 no. of hintermediate operators=256
 no. of coefficients=3072:2.344e-02MB:2.289e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.929e-05 S -----
rank=0 GPUmem(GB): used=9.471e-04 (oper,hinter)=9.242e-04,2.289e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.868e-03 S size(H_formulae)=525 size(Hxlst2)=23 T(Hmu/Hxlist)=2.292e-04,1.638e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.483e-03 S size(H_formulae)=525 size(Hxlst)=7364 -----
rank=0 GPUmem(GB): used=9.471e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=2.892e-05 batch[need]=3.133e-02 blksize=210 blksize0=150 batchsize=7364
rank=0 GPUmem(GB): used=3.230e-02 (oper,hinter,dvdson,batch)=9.242e-04,2.289e-05,2.892e-05,3.133e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=1941 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.577e-04,1.369e-04,1.670e-03,2.934e-04,2.269e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=2.782e-05 speed=1.040e+00GB/S T(nccl)=1.299e-04 speed=2.226e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=1.7e-03 t_reduction=2.9e-04 tot=2.1e-03 -----
 sigma[inter] counter=79 t=1.4e-04 per=6.5e+00 cost=6.8e+06 flops=5.0e+10
 sigma[gemm] counter=79 i=0 t=1.8e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=1 t=1.6e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=79 i=2 t=4.7e-04 per=2.2e+01 cost=6.5e+06 flops=1.4e+10
 sigma[gemm] counter=79 i=3 t=5.2e-04 per=2.5e+01 cost=6.4e+06 flops=1.2e+10
 sigma[gemm] counter=79 i=4 t=3.6e-04 per=1.7e+01 cost=5.7e+06 flops=1.6e+10
 sigma[gemm] counter=79 i=5 t=3.2e-04 per=1.5e+01 cost=5.7e+06 flops=1.8e+10
 sigma[gemm] counter=79 total t=1.7e-03 per=8.0e+01 cost=2.4e+07 flops=1.5e+10
 sigma[red] counter=79 t=2.9e-04 per=1.4e+01 cost=1.4e+06 flops=4.7e+09
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=2.2e-01 t_reduction=2.8e-02 tot=2.6e-01 -----
 sigma_tot[inter] counter=79 t=1.2e-02 per=4.5e+00 cost=3.8e+08 flops=3.3e+10
 sigma_tot[gemm] counter=79 i=0 t=1.8e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=1 t=1.6e-04 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=79 i=2 t=5.3e-02 per=2.0e+01 cost=3.6e+08 flops=6.8e+09
 sigma_tot[gemm] counter=79 i=3 t=6.8e-02 per=2.6e+01 cost=3.6e+08 flops=5.3e+09
 sigma_tot[gemm] counter=79 i=4 t=4.9e-02 per=1.9e+01 cost=2.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=79 i=5 t=5.0e-02 per=1.9e+01 cost=3.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=79 total t=2.2e-01 per=8.5e+01 cost=1.3e+09 flops=5.9e+09
 sigma_tot[red] counter=79 t=2.8e-02 per=1.1e+01 cost=8.6e+07 flops=3.1e+09
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=6.5e-06,3.2e-06,9.6e-07,3.5e-06,7.1e-07
settings: ndim=1941 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.517004448238 -1.117e+03  8.831e-02    1     1  2.369e-03 2.369e-03 2.336e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.221e-05,1.181e-04,2.101e-03,3.133e-04,2.610e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=2.733e-05 speed=1.058e+00GB/S T(nccl)=4.489e-05 speed=6.443e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.1e-03 t_reduction=3.1e-04 tot=2.5e-03 -----
 sigma[inter] counter=80 t=1.2e-04 per=4.7e+00 cost=6.8e+06 flops=5.7e+10
 sigma[gemm] counter=80 i=0 t=2.0e-06 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=1 t=1.8e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=80 i=2 t=5.8e-04 per=2.3e+01 cost=6.5e+06 flops=1.1e+10
 sigma[gemm] counter=80 i=3 t=6.7e-04 per=2.6e+01 cost=6.4e+06 flops=9.5e+09
 sigma[gemm] counter=80 i=4 t=4.5e-04 per=1.8e+01 cost=5.7e+06 flops=1.3e+10
 sigma[gemm] counter=80 i=5 t=4.0e-04 per=1.6e+01 cost=5.7e+06 flops=1.4e+10
 sigma[gemm] counter=80 total t=2.1e-03 per=8.3e+01 cost=2.4e+07 flops=1.2e+10
 sigma[red] counter=80 t=3.1e-04 per=1.2e+01 cost=1.4e+06 flops=4.4e+09
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=2.2e-01 t_reduction=2.8e-02 tot=2.6e-01 -----
 sigma_tot[inter] counter=80 t=1.2e-02 per=4.5e+00 cost=3.9e+08 flops=3.3e+10
 sigma_tot[gemm] counter=80 i=0 t=1.8e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=1 t=1.6e-04 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=80 i=2 t=5.4e-02 per=2.0e+01 cost=3.7e+08 flops=6.8e+09
 sigma_tot[gemm] counter=80 i=3 t=6.8e-02 per=2.6e+01 cost=3.6e+08 flops=5.3e+09
 sigma_tot[gemm] counter=80 i=4 t=4.9e-02 per=1.9e+01 cost=3.0e+08 flops=6.0e+09
 sigma_tot[gemm] counter=80 i=5 t=5.1e-02 per=1.9e+01 cost=3.0e+08 flops=6.0e+09
 sigma_tot[gemm] counter=80 total t=2.2e-01 per=8.5e+01 cost=1.3e+09 flops=6.0e+09
 sigma_tot[red] counter=80 t=2.8e-02 per=1.1e+01 cost=8.7e+07 flops=3.1e+09
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.5e-05,2.9e-06,9.5e-06,7.8e-07
    2   0 -    -116.525903713730 -8.899e-03  2.943e-02    2     2  5.163e-03 2.581e-03 2.518e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.207e-05,1.261e-04,2.156e-03,3.061e-04,2.667e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=2.661e-05 speed=1.087e+00GB/S T(nccl)=4.546e-05 speed=6.362e-01GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=2.2e-03 t_reduction=3.1e-04 tot=2.6e-03 -----
 sigma[inter] counter=81 t=1.3e-04 per=4.9e+00 cost=6.8e+06 flops=5.4e+10
 sigma[gemm] counter=81 i=0 t=2.1e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=1 t=2.0e-06 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=81 i=2 t=6.1e-04 per=2.4e+01 cost=6.5e+06 flops=1.1e+10
 sigma[gemm] counter=81 i=3 t=6.9e-04 per=2.7e+01 cost=6.4e+06 flops=9.2e+09
 sigma[gemm] counter=81 i=4 t=4.4e-04 per=1.7e+01 cost=5.7e+06 flops=1.3e+10
 sigma[gemm] counter=81 i=5 t=4.1e-04 per=1.6e+01 cost=5.7e+06 flops=1.4e+10
 sigma[gemm] counter=81 total t=2.2e-03 per=8.3e+01 cost=2.4e+07 flops=1.1e+10
 sigma[red] counter=81 t=3.1e-04 per=1.2e+01 cost=1.4e+06 flops=4.5e+09
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=2.2e-01 t_reduction=2.8e-02 tot=2.6e-01 -----
 sigma_tot[inter] counter=81 t=1.2e-02 per=4.5e+00 cost=4.0e+08 flops=3.3e+10
 sigma_tot[gemm] counter=81 i=0 t=1.8e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=1 t=1.7e-04 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=81 i=2 t=5.4e-02 per=2.0e+01 cost=3.7e+08 flops=6.9e+09
 sigma_tot[gemm] counter=81 i=3 t=6.9e-02 per=2.6e+01 cost=3.7e+08 flops=5.3e+09
 sigma_tot[gemm] counter=81 i=4 t=5.0e-02 per=1.9e+01 cost=3.0e+08 flops=6.1e+09
 sigma_tot[gemm] counter=81 i=5 t=5.1e-02 per=1.9e+01 cost=3.1e+08 flops=6.1e+09
 sigma_tot[gemm] counter=81 total t=2.2e-01 per=8.5e+01 cost=1.4e+09 flops=6.0e+09
 sigma_tot[red] counter=81 t=2.8e-02 per=1.1e+01 cost=8.9e+07 flops=3.1e+09
T(sub)=5.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.6e-05,2.3e-06,1.9e-05,7.8e-07
    3   0 -    -116.527313178930 -1.409e-03  1.561e-02    3     3  8.001e-03 2.667e-03 2.596e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.144e-05,1.192e-04,2.146e-03,3.139e-04,2.656e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=2.610e-05 speed=1.108e+00GB/S T(nccl)=4.534e-05 speed=6.379e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.1e-03 t_reduction=3.1e-04 tot=2.6e-03 -----
 sigma[inter] counter=82 t=1.2e-04 per=4.6e+00 cost=6.8e+06 flops=5.7e+10
 sigma[gemm] counter=82 i=0 t=2.0e-06 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=1 t=2.1e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=82 i=2 t=6.1e-04 per=2.4e+01 cost=6.5e+06 flops=1.1e+10
 sigma[gemm] counter=82 i=3 t=6.9e-04 per=2.7e+01 cost=6.4e+06 flops=9.3e+09
 sigma[gemm] counter=82 i=4 t=4.4e-04 per=1.7e+01 cost=5.7e+06 flops=1.3e+10
 sigma[gemm] counter=82 i=5 t=4.0e-04 per=1.6e+01 cost=5.7e+06 flops=1.4e+10
 sigma[gemm] counter=82 total t=2.1e-03 per=8.3e+01 cost=2.4e+07 flops=1.1e+10
 sigma[red] counter=82 t=3.1e-04 per=1.2e+01 cost=1.4e+06 flops=4.4e+09
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=2.3e-01 t_reduction=2.9e-02 tot=2.7e-01 -----
 sigma_tot[inter] counter=82 t=1.2e-02 per=4.5e+00 cost=4.0e+08 flops=3.3e+10
 sigma_tot[gemm] counter=82 i=0 t=1.9e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=1 t=1.7e-04 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=82 i=2 t=5.5e-02 per=2.0e+01 cost=3.8e+08 flops=6.9e+09
 sigma_tot[gemm] counter=82 i=3 t=7.0e-02 per=2.6e+01 cost=3.7e+08 flops=5.4e+09
 sigma_tot[gemm] counter=82 i=4 t=5.0e-02 per=1.9e+01 cost=3.1e+08 flops=6.1e+09
 sigma_tot[gemm] counter=82 i=5 t=5.2e-02 per=1.9e+01 cost=3.2e+08 flops=6.1e+09
 sigma_tot[gemm] counter=82 total t=2.3e-01 per=8.5e+01 cost=1.4e+09 flops=6.1e+09
 sigma_tot[red] counter=82 t=2.9e-02 per=1.1e+01 cost=9.0e+07 flops=3.1e+09
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.4e-05,2.3e-06,8.7e-06,6.9e-07
    4   0 -    -116.527714130611 -4.010e-04  7.993e-03    3     4  1.089e-02 2.723e-03 2.650e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.023e-05,1.209e-04,2.161e-03,3.098e-04,2.668e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=2.449e-05 speed=1.181e+00GB/S T(nccl)=4.574e-05 speed=6.323e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.2e-03 t_reduction=3.1e-04 tot=2.6e-03 -----
 sigma[inter] counter=83 t=1.2e-04 per=4.7e+00 cost=6.8e+06 flops=5.6e+10
 sigma[gemm] counter=83 i=0 t=2.1e-06 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=1 t=2.0e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=83 i=2 t=6.2e-04 per=2.4e+01 cost=6.5e+06 flops=1.0e+10
 sigma[gemm] counter=83 i=3 t=6.9e-04 per=2.7e+01 cost=6.4e+06 flops=9.2e+09
 sigma[gemm] counter=83 i=4 t=4.4e-04 per=1.7e+01 cost=5.7e+06 flops=1.3e+10
 sigma[gemm] counter=83 i=5 t=4.1e-04 per=1.6e+01 cost=5.7e+06 flops=1.4e+10
 sigma[gemm] counter=83 total t=2.2e-03 per=8.3e+01 cost=2.4e+07 flops=1.1e+10
 sigma[red] counter=83 t=3.1e-04 per=1.2e+01 cost=1.4e+06 flops=4.4e+09
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=2.3e-01 t_reduction=2.9e-02 tot=2.7e-01 -----
 sigma_tot[inter] counter=83 t=1.2e-02 per=4.5e+00 cost=4.1e+08 flops=3.3e+10
 sigma_tot[gemm] counter=83 i=0 t=1.9e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=1 t=1.7e-04 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=83 i=2 t=5.5e-02 per=2.1e+01 cost=3.9e+08 flops=7.0e+09
 sigma_tot[gemm] counter=83 i=3 t=7.0e-02 per=2.6e+01 cost=3.8e+08 flops=5.4e+09
 sigma_tot[gemm] counter=83 i=4 t=5.1e-02 per=1.9e+01 cost=3.1e+08 flops=6.2e+09
 sigma_tot[gemm] counter=83 i=5 t=5.2e-02 per=1.9e+01 cost=3.2e+08 flops=6.2e+09
 sigma_tot[gemm] counter=83 total t=2.3e-01 per=8.5e+01 cost=1.4e+09 flops=6.1e+09
 sigma_tot[red] counter=83 t=2.9e-02 per=1.1e+01 cost=9.1e+07 flops=3.1e+09
T(sub)=4.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-05,1.2e-05,2.0e-06,8.0e-06,6.7e-07
    5   0 -    -116.527816810989 -1.027e-04  3.718e-03    3     5  1.372e-02 2.743e-03 2.671e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.785e-05,1.180e-04,2.155e-03,3.124e-04,2.658e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=2.355e-05 speed=1.228e+00GB/S T(nccl)=4.430e-05 speed=6.528e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.2e-03 t_reduction=3.1e-04 tot=2.6e-03 -----
 sigma[inter] counter=84 t=1.2e-04 per=4.6e+00 cost=6.8e+06 flops=5.8e+10
 sigma[gemm] counter=84 i=0 t=2.1e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=1 t=2.0e-06 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=84 i=2 t=6.3e-04 per=2.4e+01 cost=6.5e+06 flops=1.0e+10
 sigma[gemm] counter=84 i=3 t=6.8e-04 per=2.6e+01 cost=6.4e+06 flops=9.3e+09
 sigma[gemm] counter=84 i=4 t=4.4e-04 per=1.7e+01 cost=5.7e+06 flops=1.3e+10
 sigma[gemm] counter=84 i=5 t=4.0e-04 per=1.6e+01 cost=5.7e+06 flops=1.4e+10
 sigma[gemm] counter=84 total t=2.2e-03 per=8.3e+01 cost=2.4e+07 flops=1.1e+10
 sigma[red] counter=84 t=3.1e-04 per=1.2e+01 cost=1.4e+06 flops=4.4e+09
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=2.3e-01 t_reduction=2.9e-02 tot=2.7e-01 -----
 sigma_tot[inter] counter=84 t=1.2e-02 per=4.5e+00 cost=4.2e+08 flops=3.4e+10
 sigma_tot[gemm] counter=84 i=0 t=1.9e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=1 t=1.7e-04 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=84 i=2 t=5.6e-02 per=2.1e+01 cost=3.9e+08 flops=7.0e+09
 sigma_tot[gemm] counter=84 i=3 t=7.1e-02 per=2.6e+01 cost=3.9e+08 flops=5.5e+09
 sigma_tot[gemm] counter=84 i=4 t=5.1e-02 per=1.9e+01 cost=3.2e+08 flops=6.2e+09
 sigma_tot[gemm] counter=84 i=5 t=5.2e-02 per=1.9e+01 cost=3.3e+08 flops=6.2e+09
 sigma_tot[gemm] counter=84 total t=2.3e-01 per=8.5e+01 cost=1.4e+09 flops=6.2e+09
 sigma_tot[red] counter=84 t=2.9e-02 per=1.1e+01 cost=9.3e+07 flops=3.2e+09
T(sub)=4.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-05,1.2e-05,2.1e-06,7.8e-06,6.3e-07
    6   0 -    -116.527836080091 -1.927e-05  1.449e-03    3     6  1.653e-02 2.755e-03 2.683e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.021e-05,1.130e-04,2.176e-03,3.330e-04,2.698e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=2.562e-05 speed=1.129e+00GB/S T(nccl)=4.459e-05 speed=6.487e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=2.2e-03 t_reduction=3.3e-04 tot=2.6e-03 -----
 sigma[inter] counter=85 t=1.1e-04 per=4.3e+00 cost=6.8e+06 flops=6.0e+10
 sigma[gemm] counter=85 i=0 t=2.0e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=1 t=2.0e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=85 i=2 t=6.2e-04 per=2.4e+01 cost=6.5e+06 flops=1.0e+10
 sigma[gemm] counter=85 i=3 t=6.9e-04 per=2.6e+01 cost=6.4e+06 flops=9.3e+09
 sigma[gemm] counter=85 i=4 t=4.6e-04 per=1.8e+01 cost=5.7e+06 flops=1.2e+10
 sigma[gemm] counter=85 i=5 t=4.0e-04 per=1.5e+01 cost=5.7e+06 flops=1.4e+10
 sigma[gemm] counter=85 total t=2.2e-03 per=8.3e+01 cost=2.4e+07 flops=1.1e+10
 sigma[red] counter=85 t=3.3e-04 per=1.3e+01 cost=1.4e+06 flops=4.1e+09
----- TIMING FOR sigma_tot : t_inter=1.2e-02 t_gemm=2.3e-01 t_reduction=3.0e-02 tot=2.8e-01 -----
 sigma_tot[inter] counter=85 t=1.2e-02 per=4.5e+00 cost=4.2e+08 flops=3.4e+10
 sigma_tot[gemm] counter=85 i=0 t=1.9e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=1 t=1.8e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=85 i=2 t=5.7e-02 per=2.1e+01 cost=4.0e+08 flops=7.0e+09
 sigma_tot[gemm] counter=85 i=3 t=7.2e-02 per=2.6e+01 cost=3.9e+08 flops=5.5e+09
 sigma_tot[gemm] counter=85 i=4 t=5.1e-02 per=1.9e+01 cost=3.2e+08 flops=6.3e+09
 sigma_tot[gemm] counter=85 i=5 t=5.3e-02 per=1.9e+01 cost=3.3e+08 flops=6.3e+09
 sigma_tot[gemm] counter=85 total t=2.3e-01 per=8.5e+01 cost=1.4e+09 flops=6.2e+09
 sigma_tot[red] counter=85 t=3.0e-02 per=1.1e+01 cost=9.4e+07 flops=3.2e+09
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.2e-05,2.0e-06,8.0e-06,6.6e-07
    7   0 -    -116.527839159455 -3.079e-06  6.323e-04    3     7  1.945e-02 2.778e-03 2.707e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.965e-05,1.142e-04,2.089e-03,3.076e-04,2.586e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=2.435e-05 speed=1.188e+00GB/S T(nccl)=4.530e-05 speed=6.384e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=2.1e-03 t_reduction=3.1e-04 tot=2.5e-03 -----
 sigma[inter] counter=86 t=1.1e-04 per=4.5e+00 cost=6.8e+06 flops=5.9e+10
 sigma[gemm] counter=86 i=0 t=1.9e-06 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=1 t=1.9e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=86 i=2 t=5.7e-04 per=2.3e+01 cost=6.5e+06 flops=1.1e+10
 sigma[gemm] counter=86 i=3 t=6.7e-04 per=2.7e+01 cost=6.4e+06 flops=9.5e+09
 sigma[gemm] counter=86 i=4 t=4.4e-04 per=1.8e+01 cost=5.7e+06 flops=1.3e+10
 sigma[gemm] counter=86 i=5 t=4.0e-04 per=1.6e+01 cost=5.7e+06 flops=1.4e+10
 sigma[gemm] counter=86 total t=2.1e-03 per=8.3e+01 cost=2.4e+07 flops=1.2e+10
 sigma[red] counter=86 t=3.1e-04 per=1.2e+01 cost=1.4e+06 flops=4.4e+09
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=2.4e-01 t_reduction=3.0e-02 tot=2.8e-01 -----
 sigma_tot[inter] counter=86 t=1.3e-02 per=4.5e+00 cost=4.3e+08 flops=3.4e+10
 sigma_tot[gemm] counter=86 i=0 t=1.9e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=1 t=1.8e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=86 i=2 t=5.7e-02 per=2.1e+01 cost=4.0e+08 flops=7.1e+09
 sigma_tot[gemm] counter=86 i=3 t=7.2e-02 per=2.6e+01 cost=4.0e+08 flops=5.5e+09
 sigma_tot[gemm] counter=86 i=4 t=5.2e-02 per=1.9e+01 cost=3.3e+08 flops=6.4e+09
 sigma_tot[gemm] counter=86 i=5 t=5.3e-02 per=1.9e+01 cost=3.4e+08 flops=6.4e+09
 sigma_tot[gemm] counter=86 total t=2.4e-01 per=8.5e+01 cost=1.5e+09 flops=6.3e+09
 sigma_tot[red] counter=86 t=3.0e-02 per=1.1e+01 cost=9.6e+07 flops=3.2e+09
T(sub)=4.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-05,1.2e-05,2.1e-06,7.7e-06,6.8e-07
    8   0 -    -116.527839729231 -5.698e-07  2.804e-04    3     8  2.220e-02 2.775e-03 2.704e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.796e-05,1.169e-04,2.258e-03,3.152e-04,2.763e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=2.342e-05 speed=1.235e+00GB/S T(nccl)=4.454e-05 speed=6.494e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.3e-03 t_reduction=3.2e-04 tot=2.7e-03 -----
 sigma[inter] counter=87 t=1.2e-04 per=4.3e+00 cost=6.8e+06 flops=5.8e+10
 sigma[gemm] counter=87 i=0 t=2.0e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=1 t=2.0e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=87 i=2 t=6.6e-04 per=2.5e+01 cost=6.5e+06 flops=9.8e+09
 sigma[gemm] counter=87 i=3 t=7.1e-04 per=2.7e+01 cost=6.4e+06 flops=8.9e+09
 sigma[gemm] counter=87 i=4 t=4.8e-04 per=1.8e+01 cost=5.7e+06 flops=1.2e+10
 sigma[gemm] counter=87 i=5 t=4.0e-04 per=1.5e+01 cost=5.7e+06 flops=1.4e+10
 sigma[gemm] counter=87 total t=2.3e-03 per=8.4e+01 cost=2.4e+07 flops=1.1e+10
 sigma[red] counter=87 t=3.2e-04 per=1.2e+01 cost=1.4e+06 flops=4.3e+09
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=2.4e-01 t_reduction=3.0e-02 tot=2.8e-01 -----
 sigma_tot[inter] counter=87 t=1.3e-02 per=4.5e+00 cost=4.4e+08 flops=3.4e+10
 sigma_tot[gemm] counter=87 i=0 t=2.0e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=1 t=1.8e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=87 i=2 t=5.8e-02 per=2.1e+01 cost=4.1e+08 flops=7.1e+09
 sigma_tot[gemm] counter=87 i=3 t=7.3e-02 per=2.6e+01 cost=4.1e+08 flops=5.6e+09
 sigma_tot[gemm] counter=87 i=4 t=5.2e-02 per=1.9e+01 cost=3.4e+08 flops=6.4e+09
 sigma_tot[gemm] counter=87 i=5 t=5.4e-02 per=1.9e+01 cost=3.4e+08 flops=6.4e+09
 sigma_tot[gemm] counter=87 total t=2.4e-01 per=8.5e+01 cost=1.5e+09 flops=6.3e+09
 sigma_tot[red] counter=87 t=3.0e-02 per=1.1e+01 cost=9.7e+07 flops=3.2e+09
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-05,1.2e-05,2.1e-06,1.4e-05,6.3e-07
    9   0 -    -116.527839847502 -1.183e-07  1.225e-04    3     9  2.512e-02 2.791e-03 2.720e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.874e-05,1.143e-04,2.156e-03,3.104e-04,2.655e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=2.437e-05 speed=1.187e+00GB/S T(nccl)=4.436e-05 speed=6.519e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=2.2e-03 t_reduction=3.1e-04 tot=2.6e-03 -----
 sigma[inter] counter=88 t=1.1e-04 per=4.4e+00 cost=6.8e+06 flops=5.9e+10
 sigma[gemm] counter=88 i=0 t=2.0e-06 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=1 t=2.0e-06 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=88 i=2 t=6.2e-04 per=2.4e+01 cost=6.5e+06 flops=1.0e+10
 sigma[gemm] counter=88 i=3 t=6.9e-04 per=2.7e+01 cost=6.4e+06 flops=9.2e+09
 sigma[gemm] counter=88 i=4 t=4.4e-04 per=1.7e+01 cost=5.7e+06 flops=1.3e+10
 sigma[gemm] counter=88 i=5 t=4.1e-04 per=1.6e+01 cost=5.7e+06 flops=1.4e+10
 sigma[gemm] counter=88 total t=2.2e-03 per=8.4e+01 cost=2.4e+07 flops=1.1e+10
 sigma[red] counter=88 t=3.1e-04 per=1.2e+01 cost=1.4e+06 flops=4.4e+09
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=2.4e-01 t_reduction=3.1e-02 tot=2.8e-01 -----
 sigma_tot[inter] counter=88 t=1.3e-02 per=4.5e+00 cost=4.4e+08 flops=3.5e+10
 sigma_tot[gemm] counter=88 i=0 t=2.0e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=1 t=1.8e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=88 i=2 t=5.9e-02 per=2.1e+01 cost=4.2e+08 flops=7.1e+09
 sigma_tot[gemm] counter=88 i=3 t=7.4e-02 per=2.6e+01 cost=4.1e+08 flops=5.6e+09
 sigma_tot[gemm] counter=88 i=4 t=5.3e-02 per=1.9e+01 cost=3.4e+08 flops=6.5e+09
 sigma_tot[gemm] counter=88 i=5 t=5.4e-02 per=1.9e+01 cost=3.5e+08 flops=6.5e+09
 sigma_tot[gemm] counter=88 total t=2.4e-01 per=8.5e+01 cost=1.5e+09 flops=6.4e+09
 sigma_tot[red] counter=88 t=3.1e-02 per=1.1e+01 cost=9.8e+07 flops=3.2e+09
T(sub)=3.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-05,1.2e-05,2.1e-06,7.6e-06,6.3e-07
   10   0 +    -116.527839869804 -2.230e-08  5.451e-05    3    10  2.792e-02 2.792e-03 2.721e-03
TIMING FOR Davidson : 2.794e-02  T(cal/comm/rest)=2.721e-02,9.921e-06,7.208e-04
decomposed t_rest=7.208e-04
 T(sub)    =4.074e-04 per=5.651e+01
 T(precond)=4.451e-05 per=6.175e+00
 T(ortho)  =5.814e-05 per=8.065e+00
 T(xcopy)  =4.830e-06 per=6.701e-01
 T(xnrm2)  =9.772e-06 per=1.356e+00
 T(other)  =1.962e-04 per=2.722e+01
optimized energies: isweep=0 ibond=11 dots=1 e[0]=-116.527839869804 nmvp=10
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=2.174e-03 change=2.046e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond11.txt
 qbond: qsuper nsym=18 dimAll=308
 (17,3):21 (19,3):42 (18,4):22 (18,2):46 (17,1):24 (19,1):35 (18,0):15 (20,2):30 (21,1):10 (20,0):10 (21,3):10 (20,4):18 (19,5):8 (16,2):9 (15,1):3 (16,0):3 (21,5):1 (20,6):1
timing for divide=3.2e-06
timing for compute=2.9e-04
timing for collect=8.7e-06
----- TMING FOR decimation_genbasis(nkr): 3.1e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.2e-06,2.9e-04,0.0e+00,3.1e-06,8.7e-06 -----
decimation summary: 308->68 dwt=+0.000e+00 SvN=1.873e+00
 qbond: qkept nsym=9 dimAll=68
 (19,3):14 (19,1):12 (21,3):10 (20,2):9 (18,2):7 (21,1):6 (20,4):6 (17,1):3 (21,5):1
----- TIMING for decimation_row(nkr): 1.464e-03 S T(decim/select/formRot)=3.840e-04,1.064e-03,1.582e-05 -----
----- TIMING FOR onedot_decimation: 1.539e-03 S T(wf/decim)=6.722e-05,1.472e-03 -----
ctns::oper_renorm coord=(12,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:26 S:7 H:1 P:47 Q:51 
        dim(bra,ket)=68,68 size(op)=652:4.974e-03MB size(tot)=47596:3.631e-01MB:3.546e-04GB
        per(mem): C:20 S:4.77 H:1.37 P:22.2 Q:51.7 
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=2.174e-03 change=2.056e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=125 : 1.268e-03 S -----
rank=0 GPUmem(GB): used=9.653e-04 (oper)=9.424e-04
rank=0 GPUmem(GB): used=9.797e-04 (oper,site)=9.424e-04,1.446e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=125
 no. of rintermediate operators=228
 no. of coefficients=2736:2.087e-02MB:2.038e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.209e-05 S -----
rank=0 GPUmem(GB): used=1.000e-03 (oper,site,rinter)=9.424e-04,1.446e-05,2.038e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.135e-03 S size(rtasks)=125 size(Rlst2)=81 T(Rmu/Rlist)=2.131e-04,9.222e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.527e-03 S size(rtasks)=125 size(Rlst)=3641 -----
rank=0 GPUmem(GB): used=1.000e-03 avail=3.829e+01 total=3.829e+01 batch[need]=1.549e-02 blksize=210 blksize0=150 batchsize=3641
rank=0 GPUmem(GB): used=1.649e-02 (oper,site,rinter,batch)=9.424e-04,1.446e-05,2.038e-05,1.549e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.357e-04,9.958e-04,2.574e-04
----- TIMING FOR renorm : t_inter=1.4e-04 t_gemm=1.0e-03 t_reduction=2.6e-04 tot=1.4e-03 -----
 renorm[inter] counter=298 t=1.4e-04 per=9.8e+00 cost=3.1e+06 flops=2.3e+10
 renorm[gemm] counter=298 i=0 t=2.4e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=298 i=1 t=2.0e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=298 i=2 t=1.9e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=298 i=3 t=1.9e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=298 i=4 t=2.8e-04 per=2.0e+01 cost=1.8e+06 flops=6.6e+09
 renorm[gemm] counter=298 i=5 t=3.1e-04 per=2.2e+01 cost=3.8e+06 flops=1.2e+10
 renorm[gemm] counter=298 i=6 t=4.0e-04 per=2.9e+01 cost=6.6e+06 flops=1.7e+10
 renorm[gemm] counter=298 total t=1.0e-03 per=7.2e+01 cost=1.2e+07 flops=1.2e+10
 renorm[red] counter=298 t=2.6e-04 per=1.9e+01 cost=6.3e+05 flops=2.4e+09
----- TIMING FOR renorm_tot : t_inter=1.6e-03 t_gemm=1.3e-02 t_reduction=3.3e-03 tot=1.8e-02 -----
 renorm_tot[inter] counter=298 t=1.6e-03 per=8.9e+00 cost=1.3e+07 flops=7.8e+09
 renorm_tot[gemm] counter=298 i=0 t=2.5e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=298 i=1 t=2.2e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=298 i=2 t=2.2e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=298 i=3 t=2.2e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=298 i=4 t=3.4e-03 per=1.9e+01 cost=8.2e+06 flops=2.4e+09
 renorm_tot[gemm] counter=298 i=5 t=5.0e-03 per=2.7e+01 cost=2.0e+07 flops=4.1e+09
 renorm_tot[gemm] counter=298 i=6 t=4.7e-03 per=2.6e+01 cost=3.9e+07 flops=8.3e+09
 renorm_tot[gemm] counter=298 total t=1.3e-02 per=7.3e+01 cost=6.8e+07 flops=5.1e+09
 renorm_tot[red] counter=298 t=3.3e-03 per=1.8e+01 cost=4.6e+06 flops=1.4e+09
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=9.912e-04 (oper)=9.454e-04
rank=0 GPUmem(GB): used=1.006e-03 (oper,site,rinter)=9.454e-04,1.446e-05,2.503e-06
rank=0 GPUmem(GB): used=1.169e-03 (oper,site,rinter,batch)=9.454e-04,1.446e-05,2.503e-06,1.637e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 6.604e-03 S T(preprocess/alloc/comp/red/dealloc)=6.193e-04,7.177e-04,3.950e-03,1.830e-03,7.542e-05 -----
----- TIMING FOR oper_renorm_opS : 6.636e-03 S rank=0 -----
qops.to_cpu: size(tot)=47596:3.631e-01MB:3.546e-04GB T(to_cpu)=2.604e-04S speed=1.362e+00GB/S
check ||H-H.dagger||=8.415e-14 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.0136 S rank=0 -----
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=1.534e-03 change=1.464e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=4.021e-03 change=-3.004e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=4.021e-03 change=-1.766e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 5.751e-02 S #####
 T(local opt: fetch) = 3.230e-03 S  per = 5.62  per(accum) = 5.62
 T(local opt: hdiag) = 1.011e-03 S  per = 1.76  per(accum) = 7.37
 T(local opt: dvdsn) = 3.523e-02 S  per = 61.2  per(accum) = 68.6
 T(local opt: decim) = 1.571e-03 S  per = 2.73  per(accum) = 71.4
 T(local opt: guess) = 6.238e-05 S  per = 0.108  per(accum) = 71.5
 T(local opt: renrm) = 1.429e-02 S  per = 24.9  per(accum) = 96.3
 T(local opt: save ) = 2.118e-03 S  per = 3.68  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.523e-02 S  T(sum) = 3.456e-02 S  per = 9.810e+01
 T(local opt: preprocess                  ) = 6.414e-05 S  per = 0.186  per(accum) = 0.186
 T(local opt: symbolic_formulae           ) = 1.109e-03 S  per = 3.21  per(accum) = 3.4
 T(local opt: hintermediate init          ) = 5.671e-05 S  per = 0.164  per(accum) = 3.56
 T(local opt: preprocess_hformulae_Hxlist ) = 2.518e-03 S  per = 7.29  per(accum) = 10.8
 T(local opt: hmmtasks init               ) = 2.859e-03 S  per = 8.27  per(accum) = 19.1
 T(local opt: initial guess for dvdson    ) = 6.348e-06 S  per = 0.0184  per(accum) = 19.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.642e-02 S  per = 76.5  per(accum) = 95.6
 T(local opt: dvdson [cpu-gpu]            ) = 2.537e-04 S  per = 0.734  per(accum) = 96.3
 T(local opt: dvdson [nccl]               ) = 5.345e-04 S  per = 1.55  per(accum) = 97.9
 T(local opt: dvdson [mpi]                ) = 9.921e-06 S  per = 0.0287  per(accum) = 97.9
 T(local opt: dvdson [rest part(linalg)]  ) = 7.208e-04 S  per = 2.09  per(accum) = 100
Detailed decomposition of T(renrm) = 1.429e-02 S  T(sum) = 1.429e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.308e-05 S  per = 0.301  per(accum) = 0.301
 T(local opt: qops init                    ) = 4.788e-04 S  per = 3.35  per(accum) = 3.65
 T(local opt: symbolic_formulae_renorm     ) = 1.275e-03 S  per = 8.92  per(accum) = 12.6
 T(local opt: allocate qops on gpu         ) = 5.132e-05 S  per = 0.359  per(accum) = 12.9
 T(local opt: site memcpy cpu2gpu          ) = 2.560e-05 S  per = 0.179  per(accum) = 13.1
 T(local opt: rintermediate init           ) = 5.899e-05 S  per = 0.413  per(accum) = 13.5
 T(local opt: preprocess_formulae_Rlist2   ) = 1.546e-03 S  per = 10.8  per(accum) = 24.3
 T(local opt: rmmtasks init                ) = 1.328e-03 S  per = 9.29  per(accum) = 33.6
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 0.000301  per(accum) = 33.6
 T(local opt: preprocess_renorm_batchGPU   ) = 1.675e-03 S  per = 11.7  per(accum) = 45.3
 T(local opt: deallocate cpu and gpu memory) = 2.039e-04 S  per = 1.43  per(accum) = 46.8
 T(local opt: construct opS [ifdists=true] ) = 6.654e-03 S  per = 46.5  per(accum) = 93.3
 T(local opt: reduction of opS & opH [nccl]) = 1.877e-05 S  per = 0.131  per(accum) = 93.4
 T(local opt: qops memcpy gpu2cpu          ) = 2.729e-04 S  per = 1.91  per(accum) = 95.4
 T(local opt: reduction of opS & opH [mpi] ) = 4.473e-05 S  per = 0.313  per(accum) = 95.7
 T(local opt: qops_pool join and erase     ) = 6.185e-04 S  per = 4.33  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.540e-07 S  per = 0.00597  per(accum) = 100
ctns::rcanon_save_site idx=7 scratch=./scratch/sweep size=1941:1.4e-05GB T(load)=0.00056S speed=0.026GB/S
##### sweep opt: 7.867e-01 S #####
 T(sweep opt: fetch) = 4.257e-02 S  per = 5.41  per(accum) = 5.41
 T(sweep opt: hdiag) = 1.218e-02 S  per = 1.55  per(accum) = 6.96
 T(sweep opt: dvdsn) = 4.218e-01 S  per = 53.6  per(accum) = 60.6
 T(sweep opt: decim) = 1.442e-02 S  per = 1.83  per(accum) = 62.4
 T(sweep opt: guess) = 7.347e-04 S  per = 0.0934  per(accum) = 62.5
 T(sweep opt: renrm) = 2.695e-01 S  per = 34.3  per(accum) = 96.7
 T(sweep opt: save ) = 2.557e-02 S  per = 3.25  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.218e-01 S  T(sum) = 4.147e-01 S  per = 9.832e+01
 T(sweep opt: preprocess                  ) = 9.507e-04 S  per = 0.229  per(accum) = 0.229
 T(sweep opt: symbolic_formulae           ) = 1.180e-02 S  per = 2.84  per(accum) = 3.07
 T(sweep opt: hintermediate init          ) = 7.553e-04 S  per = 0.182  per(accum) = 3.26
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.423e-02 S  per = 10.7  per(accum) = 13.9
 T(sweep opt: hmmtasks init               ) = 4.476e-02 S  per = 10.8  per(accum) = 24.7
 T(sweep opt: initial guess for dvdson    ) = 8.781e-05 S  per = 0.0212  per(accum) = 24.7
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 2.991e-01 S  per = 72.1  per(accum) = 96.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.212e-03 S  per = 0.533  per(accum) = 97.4
 T(sweep opt: dvdson [nccl]               ) = 4.332e-03 S  per = 1.04  per(accum) = 98.4
 T(sweep opt: dvdson [mpi]                ) = 4.244e-05 S  per = 0.0102  per(accum) = 98.4
 T(sweep opt: dvdson [rest part(linalg)]  ) = 6.480e-03 S  per = 1.56  per(accum) = 100
Detailed decomposition of T(renrm) = 2.695e-01 S  T(sum) = 2.695e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.348e-04 S  per = 0.236  per(accum) = 0.236
 T(sweep opt: qops init                    ) = 6.693e-03 S  per = 2.48  per(accum) = 2.72
 T(sweep opt: symbolic_formulae_renorm     ) = 5.881e-03 S  per = 2.18  per(accum) = 4.9
 T(sweep opt: allocate qops on gpu         ) = 8.884e-04 S  per = 0.33  per(accum) = 5.23
 T(sweep opt: site memcpy cpu2gpu          ) = 2.975e-04 S  per = 0.11  per(accum) = 5.34
 T(sweep opt: rintermediate init           ) = 6.650e-04 S  per = 0.247  per(accum) = 5.59
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.214e-02 S  per = 4.51  per(accum) = 10.1
 T(sweep opt: rmmtasks init                ) = 1.308e-02 S  per = 4.85  per(accum) = 14.9
 T(sweep opt: qops memset on cpu           ) = 5.220e-07 S  per = 0.000194  per(accum) = 14.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.991e-02 S  per = 7.39  per(accum) = 22.3
 T(sweep opt: deallocate cpu and gpu memory) = 1.884e-03 S  per = 0.699  per(accum) = 23
 T(sweep opt: construct opS [ifdists=true] ) = 1.894e-01 S  per = 70.3  per(accum) = 93.3
 T(sweep opt: reduction of opS & opH [nccl]) = 2.559e-04 S  per = 0.095  per(accum) = 93.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.651e-03 S  per = 0.613  per(accum) = 94.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.042e-04 S  per = 0.113  per(accum) = 94.2
 T(sweep opt: qops_pool join and erase     ) = 8.900e-03 S  per =  3.3  per(accum) = 97.5
 T(sweep opt: conversion from opAB to opPQ ) = 6.823e-03 S  per = 2.53  per(accum) = 100
##### global opt: 7.867e-01 S #####
 T(global opt: fetch) = 4.257e-02 S  per = 5.41  per(accum) = 5.41
 T(global opt: hdiag) = 1.218e-02 S  per = 1.55  per(accum) = 6.96
 T(global opt: dvdsn) = 4.218e-01 S  per = 53.6  per(accum) = 60.6
 T(global opt: decim) = 1.442e-02 S  per = 1.83  per(accum) = 62.4
 T(global opt: guess) = 7.347e-04 S  per = 0.0934  per(accum) = 62.5
 T(global opt: renrm) = 2.695e-01 S  per = 34.3  per(accum) = 96.7
 T(global opt: save ) = 2.557e-02 S  per = 3.25  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.218e-01 S  T(sum) = 4.147e-01 S  per = 9.832e+01
 T(global opt: preprocess                  ) = 9.507e-04 S  per = 0.229  per(accum) = 0.229
 T(global opt: symbolic_formulae           ) = 1.180e-02 S  per = 2.84  per(accum) = 3.07
 T(global opt: hintermediate init          ) = 7.553e-04 S  per = 0.182  per(accum) = 3.26
 T(global opt: preprocess_hformulae_Hxlist ) = 4.423e-02 S  per = 10.7  per(accum) = 13.9
 T(global opt: hmmtasks init               ) = 4.476e-02 S  per = 10.8  per(accum) = 24.7
 T(global opt: initial guess for dvdson    ) = 8.781e-05 S  per = 0.0212  per(accum) = 24.7
 T(global opt: dvdson [Hx_batchGPU]        ) = 2.991e-01 S  per = 72.1  per(accum) = 96.8
 T(global opt: dvdson [cpu-gpu]            ) = 2.212e-03 S  per = 0.533  per(accum) = 97.4
 T(global opt: dvdson [nccl]               ) = 4.332e-03 S  per = 1.04  per(accum) = 98.4
 T(global opt: dvdson [mpi]                ) = 4.244e-05 S  per = 0.0102  per(accum) = 98.4
 T(global opt: dvdson [rest part(linalg)]  ) = 6.480e-03 S  per = 1.56  per(accum) = 100
Detailed decomposition of T(renrm) = 2.695e-01 S  T(sum) = 2.695e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.348e-04 S  per = 0.236  per(accum) = 0.236
 T(global opt: qops init                    ) = 6.693e-03 S  per = 2.48  per(accum) = 2.72
 T(global opt: symbolic_formulae_renorm     ) = 5.881e-03 S  per = 2.18  per(accum) = 4.9
 T(global opt: allocate qops on gpu         ) = 8.884e-04 S  per = 0.33  per(accum) = 5.23
 T(global opt: site memcpy cpu2gpu          ) = 2.975e-04 S  per = 0.11  per(accum) = 5.34
 T(global opt: rintermediate init           ) = 6.650e-04 S  per = 0.247  per(accum) = 5.59
 T(global opt: preprocess_formulae_Rlist2   ) = 1.214e-02 S  per = 4.51  per(accum) = 10.1
 T(global opt: rmmtasks init                ) = 1.308e-02 S  per = 4.85  per(accum) = 14.9
 T(global opt: qops memset on cpu           ) = 5.220e-07 S  per = 0.000194  per(accum) = 14.9
 T(global opt: preprocess_renorm_batchGPU   ) = 1.991e-02 S  per = 7.39  per(accum) = 22.3
 T(global opt: deallocate cpu and gpu memory) = 1.884e-03 S  per = 0.699  per(accum) = 23
 T(global opt: construct opS [ifdists=true] ) = 1.894e-01 S  per = 70.3  per(accum) = 93.3
 T(global opt: reduction of opS & opH [nccl]) = 2.559e-04 S  per = 0.095  per(accum) = 93.4
 T(global opt: qops memcpy gpu2cpu          ) = 1.651e-03 S  per = 0.613  per(accum) = 94.1
 T(global opt: reduction of opS & opH [mpi] ) = 3.042e-04 S  per = 0.113  per(accum) = 94.2
 T(global opt: qops_pool join and erase     ) = 8.900e-03 S  per =  3.3  per(accum) = 97.5
 T(global opt: conversion from opAB to opPQ ) = 6.823e-03 S  per = 2.53  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-2.052e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=12/seqsize=34 dots=1 dbond=(13,0)-(14,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=5 scratch=./scratch/sweep size=1021:7.61e-06GB T(load)=3.36e-04S speed=2.26e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=2514:1.92e-02MB:1.87e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1493:1.14e-02MB:1.11e-05GB
total mem of comb=4155:3.17e-02MB:3.10e-05GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=1.109e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=13,6,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc= 9
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:26 S:7 H:1 P:47 Q:51 
        dim(bra,ket)=68,68 size(op)=652:4.974e-03MB size(tot)=47596:3.631e-01MB:3.546e-04GB
        per(mem): C:20 S:4.77 H:1.37 P:22.2 Q:51.7 
 rqops: oplist=CSHAB nops=C:12 S:14 H:1 A:33 B:39 
        dim(bra,ket)=58,58 size(op)=472:0.0036MB size(tot)=25825:0.197MB:0.000192GB
        per(mem): C:13.4 S:13.2 H:1.83 A:20.7 B:50.9 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=75757:0.578MB:0.000564GB
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.232e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(13,0) fdel=./scratch/sweep/rop(14,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-1.980e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(68,58,4) nnz=1493:1.139e-02MB
qtensor3: wf3 own=1 _data=0x55b2cd56e000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=68
 (19,3):14 (19,1):12 (21,3):10 (20,2):9 (18,2):7 (21,1):6 (20,4):6 (17,1):3 (21,5):1
 qbond: qcol nsym=9 dimAll=58
 (9,-3):11 (8,-2):9 (7,-3):9 (9,-1):9 (10,-2):8 (8,-4):5 (7,-1):3 (11,-1):3 (7,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=23 nblocks=324 size=1493:1.139e-02MB
### DIAG TIMING: total=8.174e-04 t1=1.990e-05, t2=1.189e-05, t3=1.333e-05, t4=7.155e-04, t5=9.789e-06, t6=3.897e-05, t7=8.018e-06
duration_diagGPU:8.324e-04
duration_diagreduce:8.600e-08
duration_diagtransform:1.526e-06
----- TIMING FOR symbolic_formulae_onedot with size=408 : 8.804e-04 S -----
rank=0 GPUmem(GB): used=5.644e-04 (oper)=5.644e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=408
 no. of hintermediate operators=195
 no. of coefficients=2535:1.934e-02MB:1.889e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.718e-05 S -----
rank=0 GPUmem(GB): used=5.833e-04 (oper,hinter)=5.644e-04,1.889e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.364e-03 S size(H_formulae)=408 size(Hxlst2)=23 T(Hmu/Hxlist)=1.659e-04,1.198e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.846e-03 S size(H_formulae)=408 size(Hxlst)=5860 -----
rank=0 GPUmem(GB): used=5.833e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=2.225e-05 batch[need]=1.899e-02 blksize=154 blksize0=126 batchsize=5860
rank=0 GPUmem(GB): used=1.960e-02 (oper,hinter,dvdson,batch)=5.644e-04,1.889e-05,2.225e-05,1.899e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=1493 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.903e-04,1.223e-04,1.897e-03,2.815e-04,2.503e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.439e-05 speed=9.120e-01GB/S T(nccl)=1.660e-04 speed=1.341e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=1.9e-03 t_reduction=2.8e-04 tot=2.3e-03 -----
 sigma[inter] counter=89 t=1.2e-04 per=5.3e+00 cost=4.5e+06 flops=3.7e+10
 sigma[gemm] counter=89 i=0 t=1.7e-06 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=1 t=1.6e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=89 i=2 t=4.6e-04 per=2.0e+01 cost=3.4e+06 flops=7.3e+09
 sigma[gemm] counter=89 i=3 t=5.3e-04 per=2.3e+01 cost=3.3e+06 flops=6.2e+09
 sigma[gemm] counter=89 i=4 t=4.6e-04 per=2.0e+01 cost=3.1e+06 flops=6.6e+09
 sigma[gemm] counter=89 i=5 t=4.5e-04 per=1.9e+01 cost=3.1e+06 flops=6.9e+09
 sigma[gemm] counter=89 total t=1.9e-03 per=8.2e+01 cost=1.3e+07 flops=6.7e+09
 sigma[red] counter=89 t=2.8e-04 per=1.2e+01 cost=8.4e+05 flops=3.0e+09
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=2.4e-01 t_reduction=3.1e-02 tot=2.9e-01 -----
 sigma_tot[inter] counter=89 t=1.3e-02 per=4.5e+00 cost=4.5e+08 flops=3.5e+10
 sigma_tot[gemm] counter=89 i=0 t=2.0e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=1 t=1.8e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=89 i=2 t=5.9e-02 per=2.1e+01 cost=4.2e+08 flops=7.1e+09
 sigma_tot[gemm] counter=89 i=3 t=7.4e-02 per=2.6e+01 cost=4.2e+08 flops=5.6e+09
 sigma_tot[gemm] counter=89 i=4 t=5.3e-02 per=1.9e+01 cost=3.4e+08 flops=6.5e+09
 sigma_tot[gemm] counter=89 i=5 t=5.4e-02 per=1.9e+01 cost=3.5e+08 flops=6.5e+09
 sigma_tot[gemm] counter=89 total t=2.4e-01 per=8.5e+01 cost=1.5e+09 flops=6.4e+09
 sigma_tot[red] counter=89 t=3.1e-02 per=1.1e+01 cost=9.9e+07 flops=3.2e+09
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,3.2e-06,9.4e-07,2.1e-06,5.6e-07
settings: ndim=1493 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.527839869804 -1.117e+03  6.284e-02    1     1  2.823e-03 2.823e-03 2.784e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.114e-05,1.282e-04,2.469e-03,3.136e-04,2.989e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.648e-05 speed=8.400e-01GB/S T(nccl)=4.466e-05 speed=4.982e-01GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=2.5e-03 t_reduction=3.1e-04 tot=2.9e-03 -----
 sigma[inter] counter=90 t=1.3e-04 per=4.4e+00 cost=4.5e+06 flops=3.5e+10
 sigma[gemm] counter=90 i=0 t=2.1e-06 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=1 t=2.1e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=90 i=2 t=6.1e-04 per=2.1e+01 cost=3.4e+06 flops=5.5e+09
 sigma[gemm] counter=90 i=3 t=7.1e-04 per=2.5e+01 cost=3.3e+06 flops=4.6e+09
 sigma[gemm] counter=90 i=4 t=5.8e-04 per=2.0e+01 cost=3.1e+06 flops=5.3e+09
 sigma[gemm] counter=90 i=5 t=5.6e-04 per=1.9e+01 cost=3.1e+06 flops=5.5e+09
 sigma[gemm] counter=90 total t=2.5e-03 per=8.5e+01 cost=1.3e+07 flops=5.2e+09
 sigma[red] counter=90 t=3.1e-04 per=1.1e+01 cost=8.4e+05 flops=2.7e+09
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=2.4e-01 t_reduction=3.1e-02 tot=2.9e-01 -----
 sigma_tot[inter] counter=90 t=1.3e-02 per=4.5e+00 cost=4.5e+08 flops=3.5e+10
 sigma_tot[gemm] counter=90 i=0 t=2.0e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=1 t=1.8e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=90 i=2 t=6.0e-02 per=2.1e+01 cost=4.2e+08 flops=7.1e+09
 sigma_tot[gemm] counter=90 i=3 t=7.5e-02 per=2.6e+01 cost=4.2e+08 flops=5.6e+09
 sigma_tot[gemm] counter=90 i=4 t=5.4e-02 per=1.9e+01 cost=3.5e+08 flops=6.4e+09
 sigma_tot[gemm] counter=90 i=5 t=5.5e-02 per=1.9e+01 cost=3.6e+08 flops=6.5e+09
 sigma_tot[gemm] counter=90 total t=2.4e-01 per=8.5e+01 cost=1.5e+09 flops=6.3e+09
 sigma_tot[red] counter=90 t=3.1e-02 per=1.1e+01 cost=1.0e+08 flops=3.2e+09
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.3e-05,3.0e-06,4.1e-06,7.4e-07
    2   0 -    -116.531980292074 -4.140e-03  2.206e-02    2     2  6.184e-03 3.092e-03 3.023e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.855e-05,1.221e-04,2.467e-03,3.145e-04,2.978e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.454e-05 speed=9.065e-01GB/S T(nccl)=4.401e-05 speed=5.055e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.5e-03 t_reduction=3.1e-04 tot=2.9e-03 -----
 sigma[inter] counter=91 t=1.2e-04 per=4.2e+00 cost=4.5e+06 flops=3.7e+10
 sigma[gemm] counter=91 i=0 t=2.2e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=1 t=1.9e-06 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=91 i=2 t=6.0e-04 per=2.1e+01 cost=3.4e+06 flops=5.6e+09
 sigma[gemm] counter=91 i=3 t=7.2e-04 per=2.5e+01 cost=3.3e+06 flops=4.5e+09
 sigma[gemm] counter=91 i=4 t=5.7e-04 per=2.0e+01 cost=3.1e+06 flops=5.4e+09
 sigma[gemm] counter=91 i=5 t=5.7e-04 per=2.0e+01 cost=3.1e+06 flops=5.4e+09
 sigma[gemm] counter=91 total t=2.5e-03 per=8.5e+01 cost=1.3e+07 flops=5.2e+09
 sigma[red] counter=91 t=3.1e-04 per=1.1e+01 cost=8.4e+05 flops=2.7e+09
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=2.5e-01 t_reduction=3.2e-02 tot=2.9e-01 -----
 sigma_tot[inter] counter=91 t=1.3e-02 per=4.5e+00 cost=4.6e+08 flops=3.5e+10
 sigma_tot[gemm] counter=91 i=0 t=2.0e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=1 t=1.9e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=91 i=2 t=6.0e-02 per=2.1e+01 cost=4.3e+08 flops=7.1e+09
 sigma_tot[gemm] counter=91 i=3 t=7.6e-02 per=2.6e+01 cost=4.2e+08 flops=5.6e+09
 sigma_tot[gemm] counter=91 i=4 t=5.4e-02 per=1.9e+01 cost=3.5e+08 flops=6.4e+09
 sigma_tot[gemm] counter=91 i=5 t=5.6e-02 per=1.9e+01 cost=3.6e+08 flops=6.5e+09
 sigma_tot[gemm] counter=91 total t=2.5e-01 per=8.5e+01 cost=1.6e+09 flops=6.3e+09
 sigma_tot[red] counter=91 t=3.2e-02 per=1.1e+01 cost=1.0e+08 flops=3.2e+09
T(sub)=3.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.5e-05,2.1e-06,6.3e-06,6.4e-07
    3   0 -    -116.532689562333 -7.093e-04  9.976e-03    3     3  9.472e-03 3.157e-03 3.087e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.731e-05,1.198e-04,2.382e-03,3.105e-04,2.886e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.389e-05 speed=9.314e-01GB/S T(nccl)=4.342e-05 speed=5.123e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.4e-03 t_reduction=3.1e-04 tot=2.8e-03 -----
 sigma[inter] counter=92 t=1.2e-04 per=4.3e+00 cost=4.5e+06 flops=3.8e+10
 sigma[gemm] counter=92 i=0 t=2.0e-06 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=1 t=1.9e-06 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=92 i=2 t=5.4e-04 per=1.9e+01 cost=3.4e+06 flops=6.2e+09
 sigma[gemm] counter=92 i=3 t=7.0e-04 per=2.5e+01 cost=3.3e+06 flops=4.7e+09
 sigma[gemm] counter=92 i=4 t=5.7e-04 per=2.0e+01 cost=3.1e+06 flops=5.4e+09
 sigma[gemm] counter=92 i=5 t=5.7e-04 per=2.0e+01 cost=3.1e+06 flops=5.4e+09
 sigma[gemm] counter=92 total t=2.4e-03 per=8.5e+01 cost=1.3e+07 flops=5.4e+09
 sigma[red] counter=92 t=3.1e-04 per=1.1e+01 cost=8.4e+05 flops=2.7e+09
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=2.5e-01 t_reduction=3.2e-02 tot=2.9e-01 -----
 sigma_tot[inter] counter=92 t=1.3e-02 per=4.5e+00 cost=4.6e+08 flops=3.5e+10
 sigma_tot[gemm] counter=92 i=0 t=2.1e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=1 t=1.9e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=92 i=2 t=6.1e-02 per=2.1e+01 cost=4.3e+08 flops=7.1e+09
 sigma_tot[gemm] counter=92 i=3 t=7.6e-02 per=2.6e+01 cost=4.3e+08 flops=5.6e+09
 sigma_tot[gemm] counter=92 i=4 t=5.5e-02 per=1.9e+01 cost=3.5e+08 flops=6.4e+09
 sigma_tot[gemm] counter=92 i=5 t=5.6e-02 per=1.9e+01 cost=3.6e+08 flops=6.4e+09
 sigma_tot[gemm] counter=92 total t=2.5e-01 per=8.5e+01 cost=1.6e+09 flops=6.3e+09
 sigma_tot[red] counter=92 t=3.2e-02 per=1.1e+01 cost=1.0e+08 flops=3.2e+09
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.2e-05,2.1e-06,6.2e-06,6.1e-07
    4   0 -    -116.532886571404 -1.970e-04  5.657e-03    3     4  1.251e-02 3.127e-03 3.059e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.543e-05,1.187e-04,2.364e-03,3.112e-04,2.865e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.253e-05 speed=9.876e-01GB/S T(nccl)=4.290e-05 speed=5.186e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.4e-03 t_reduction=3.1e-04 tot=2.8e-03 -----
 sigma[inter] counter=93 t=1.2e-04 per=4.2e+00 cost=4.5e+06 flops=3.8e+10
 sigma[gemm] counter=93 i=0 t=1.9e-06 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=1 t=1.8e-06 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=93 i=2 t=5.4e-04 per=1.9e+01 cost=3.4e+06 flops=6.2e+09
 sigma[gemm] counter=93 i=3 t=6.9e-04 per=2.5e+01 cost=3.3e+06 flops=4.7e+09
 sigma[gemm] counter=93 i=4 t=5.7e-04 per=2.0e+01 cost=3.1e+06 flops=5.4e+09
 sigma[gemm] counter=93 i=5 t=5.6e-04 per=2.0e+01 cost=3.1e+06 flops=5.5e+09
 sigma[gemm] counter=93 total t=2.4e-03 per=8.5e+01 cost=1.3e+07 flops=5.4e+09
 sigma[red] counter=93 t=3.1e-04 per=1.1e+01 cost=8.4e+05 flops=2.7e+09
----- TIMING FOR sigma_tot : t_inter=1.3e-02 t_gemm=2.5e-01 t_reduction=3.2e-02 tot=3.0e-01 -----
 sigma_tot[inter] counter=93 t=1.3e-02 per=4.5e+00 cost=4.7e+08 flops=3.5e+10
 sigma_tot[gemm] counter=93 i=0 t=2.1e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=1 t=1.9e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=93 i=2 t=6.1e-02 per=2.1e+01 cost=4.3e+08 flops=7.1e+09
 sigma_tot[gemm] counter=93 i=3 t=7.7e-02 per=2.6e+01 cost=4.3e+08 flops=5.6e+09
 sigma_tot[gemm] counter=93 i=4 t=5.6e-02 per=1.9e+01 cost=3.6e+08 flops=6.4e+09
 sigma_tot[gemm] counter=93 i=5 t=5.7e-02 per=1.9e+01 cost=3.6e+08 flops=6.4e+09
 sigma_tot[gemm] counter=93 total t=2.5e-01 per=8.5e+01 cost=1.6e+09 flops=6.3e+09
 sigma_tot[red] counter=93 t=3.2e-02 per=1.1e+01 cost=1.0e+08 flops=3.2e+09
T(sub)=3.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.2e-05,1.9e-06,6.2e-06,5.8e-07
    5   0 -    -116.532935598249 -4.903e-05  2.564e-03    3     5  1.552e-02 3.105e-03 3.037e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.579e-05,1.137e-04,2.368e-03,3.061e-04,2.859e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.304e-05 speed=9.656e-01GB/S T(nccl)=4.275e-05 speed=5.204e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=2.4e-03 t_reduction=3.1e-04 tot=2.8e-03 -----
 sigma[inter] counter=94 t=1.1e-04 per=4.1e+00 cost=4.5e+06 flops=4.0e+10
 sigma[gemm] counter=94 i=0 t=1.9e-06 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=1 t=1.9e-06 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=94 i=2 t=5.4e-04 per=1.9e+01 cost=3.4e+06 flops=6.2e+09
 sigma[gemm] counter=94 i=3 t=6.9e-04 per=2.5e+01 cost=3.3e+06 flops=4.7e+09
 sigma[gemm] counter=94 i=4 t=5.7e-04 per=2.0e+01 cost=3.1e+06 flops=5.4e+09
 sigma[gemm] counter=94 i=5 t=5.7e-04 per=2.0e+01 cost=3.1e+06 flops=5.5e+09
 sigma[gemm] counter=94 total t=2.4e-03 per=8.5e+01 cost=1.3e+07 flops=5.4e+09
 sigma[red] counter=94 t=3.1e-04 per=1.1e+01 cost=8.4e+05 flops=2.7e+09
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=2.5e-01 t_reduction=3.3e-02 tot=3.0e-01 -----
 sigma_tot[inter] counter=94 t=1.4e-02 per=4.5e+00 cost=4.7e+08 flops=3.5e+10
 sigma_tot[gemm] counter=94 i=0 t=2.1e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=1 t=1.9e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=94 i=2 t=6.2e-02 per=2.1e+01 cost=4.4e+08 flops=7.1e+09
 sigma_tot[gemm] counter=94 i=3 t=7.8e-02 per=2.6e+01 cost=4.3e+08 flops=5.6e+09
 sigma_tot[gemm] counter=94 i=4 t=5.6e-02 per=1.9e+01 cost=3.6e+08 flops=6.4e+09
 sigma_tot[gemm] counter=94 i=5 t=5.7e-02 per=1.9e+01 cost=3.7e+08 flops=6.4e+09
 sigma_tot[gemm] counter=94 total t=2.5e-01 per=8.5e+01 cost=1.6e+09 flops=6.3e+09
 sigma_tot[red] counter=94 t=3.3e-02 per=1.1e+01 cost=1.0e+08 flops=3.2e+09
T(sub)=3.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.1e-05,2.0e-06,6.1e-06,5.9e-07
    6   0 -    -116.532944609616 -9.011e-06  1.015e-03    3     6  1.853e-02 3.089e-03 3.022e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.605e-05,1.180e-04,2.430e-03,3.137e-04,2.933e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.303e-05 speed=9.661e-01GB/S T(nccl)=4.302e-05 speed=5.172e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.4e-03 t_reduction=3.1e-04 tot=2.9e-03 -----
 sigma[inter] counter=95 t=1.2e-04 per=4.1e+00 cost=4.5e+06 flops=3.8e+10
 sigma[gemm] counter=95 i=0 t=1.9e-06 per=6.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=1 t=1.8e-06 per=6.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=95 i=2 t=5.5e-04 per=1.9e+01 cost=3.4e+06 flops=6.1e+09
 sigma[gemm] counter=95 i=3 t=6.9e-04 per=2.4e+01 cost=3.3e+06 flops=4.7e+09
 sigma[gemm] counter=95 i=4 t=5.9e-04 per=2.0e+01 cost=3.1e+06 flops=5.2e+09
 sigma[gemm] counter=95 i=5 t=6.0e-04 per=2.1e+01 cost=3.1e+06 flops=5.1e+09
 sigma[gemm] counter=95 total t=2.4e-03 per=8.5e+01 cost=1.3e+07 flops=5.3e+09
 sigma[red] counter=95 t=3.1e-04 per=1.1e+01 cost=8.4e+05 flops=2.7e+09
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=2.6e-01 t_reduction=3.3e-02 tot=3.0e-01 -----
 sigma_tot[inter] counter=95 t=1.4e-02 per=4.5e+00 cost=4.8e+08 flops=3.5e+10
 sigma_tot[gemm] counter=95 i=0 t=2.1e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=1 t=1.9e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=95 i=2 t=6.2e-02 per=2.1e+01 cost=4.4e+08 flops=7.1e+09
 sigma_tot[gemm] counter=95 i=3 t=7.9e-02 per=2.6e+01 cost=4.4e+08 flops=5.6e+09
 sigma_tot[gemm] counter=95 i=4 t=5.7e-02 per=1.9e+01 cost=3.6e+08 flops=6.4e+09
 sigma_tot[gemm] counter=95 i=5 t=5.8e-02 per=1.9e+01 cost=3.7e+08 flops=6.4e+09
 sigma_tot[gemm] counter=95 total t=2.6e-01 per=8.5e+01 cost=1.6e+09 flops=6.3e+09
 sigma_tot[red] counter=95 t=3.3e-02 per=1.1e+01 cost=1.0e+08 flops=3.2e+09
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.2e-05,2.0e-06,6.1e-06,6.0e-07
    7   0 -    -116.532946093325 -1.484e-06  4.720e-04    3     7  2.189e-02 3.127e-03 3.060e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.792e-05,1.207e-04,2.459e-03,3.125e-04,2.966e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.406e-05 speed=9.246e-01GB/S T(nccl)=4.386e-05 speed=5.072e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.5e-03 t_reduction=3.1e-04 tot=2.9e-03 -----
 sigma[inter] counter=96 t=1.2e-04 per=4.2e+00 cost=4.5e+06 flops=3.8e+10
 sigma[gemm] counter=96 i=0 t=2.1e-06 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=1 t=2.0e-06 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=96 i=2 t=6.0e-04 per=2.1e+01 cost=3.4e+06 flops=5.6e+09
 sigma[gemm] counter=96 i=3 t=7.2e-04 per=2.5e+01 cost=3.3e+06 flops=4.6e+09
 sigma[gemm] counter=96 i=4 t=5.7e-04 per=2.0e+01 cost=3.1e+06 flops=5.3e+09
 sigma[gemm] counter=96 i=5 t=5.6e-04 per=1.9e+01 cost=3.1e+06 flops=5.5e+09
 sigma[gemm] counter=96 total t=2.5e-03 per=8.5e+01 cost=1.3e+07 flops=5.2e+09
 sigma[red] counter=96 t=3.1e-04 per=1.1e+01 cost=8.4e+05 flops=2.7e+09
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=2.6e-01 t_reduction=3.3e-02 tot=3.1e-01 -----
 sigma_tot[inter] counter=96 t=1.4e-02 per=4.5e+00 cost=4.8e+08 flops=3.5e+10
 sigma_tot[gemm] counter=96 i=0 t=2.1e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=1 t=2.0e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=96 i=2 t=6.3e-02 per=2.1e+01 cost=4.4e+08 flops=7.1e+09
 sigma_tot[gemm] counter=96 i=3 t=7.9e-02 per=2.6e+01 cost=4.4e+08 flops=5.5e+09
 sigma_tot[gemm] counter=96 i=4 t=5.7e-02 per=1.9e+01 cost=3.7e+08 flops=6.4e+09
 sigma_tot[gemm] counter=96 i=5 t=5.8e-02 per=1.9e+01 cost=3.7e+08 flops=6.4e+09
 sigma_tot[gemm] counter=96 total t=2.6e-01 per=8.5e+01 cost=1.6e+09 flops=6.3e+09
 sigma_tot[red] counter=96 t=3.3e-02 per=1.1e+01 cost=1.0e+08 flops=3.2e+09
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.2e-05,2.1e-06,6.0e-06,6.2e-07
    8   0 -    -116.532946450627 -3.573e-07  2.425e-04    3     8  2.518e-02 3.148e-03 3.077e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.672e-05,1.198e-04,2.470e-03,3.096e-04,2.972e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.350e-05 speed=9.465e-01GB/S T(nccl)=4.322e-05 speed=5.148e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.5e-03 t_reduction=3.1e-04 tot=2.9e-03 -----
 sigma[inter] counter=97 t=1.2e-04 per=4.1e+00 cost=4.5e+06 flops=3.8e+10
 sigma[gemm] counter=97 i=0 t=2.0e-06 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=1 t=2.0e-06 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=97 i=2 t=6.0e-04 per=2.1e+01 cost=3.4e+06 flops=5.6e+09
 sigma[gemm] counter=97 i=3 t=7.1e-04 per=2.5e+01 cost=3.3e+06 flops=4.6e+09
 sigma[gemm] counter=97 i=4 t=5.8e-04 per=2.0e+01 cost=3.1e+06 flops=5.2e+09
 sigma[gemm] counter=97 i=5 t=5.7e-04 per=2.0e+01 cost=3.1e+06 flops=5.4e+09
 sigma[gemm] counter=97 total t=2.5e-03 per=8.5e+01 cost=1.3e+07 flops=5.2e+09
 sigma[red] counter=97 t=3.1e-04 per=1.1e+01 cost=8.4e+05 flops=2.7e+09
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=2.6e-01 t_reduction=3.3e-02 tot=3.1e-01 -----
 sigma_tot[inter] counter=97 t=1.4e-02 per=4.5e+00 cost=4.8e+08 flops=3.5e+10
 sigma_tot[gemm] counter=97 i=0 t=2.2e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=1 t=2.0e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=97 i=2 t=6.4e-02 per=2.1e+01 cost=4.5e+08 flops=7.0e+09
 sigma_tot[gemm] counter=97 i=3 t=8.0e-02 per=2.6e+01 cost=4.4e+08 flops=5.5e+09
 sigma_tot[gemm] counter=97 i=4 t=5.8e-02 per=1.9e+01 cost=3.7e+08 flops=6.4e+09
 sigma_tot[gemm] counter=97 i=5 t=5.9e-02 per=1.9e+01 cost=3.8e+08 flops=6.4e+09
 sigma_tot[gemm] counter=97 total t=2.6e-01 per=8.5e+01 cost=1.6e+09 flops=6.3e+09
 sigma_tot[red] counter=97 t=3.3e-02 per=1.1e+01 cost=1.1e+08 flops=3.2e+09
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.2e-05,2.2e-06,6.2e-06,6.2e-07
    9   0 -    -116.532946540732 -9.011e-08  1.022e-04    3     9  2.831e-02 3.145e-03 3.075e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.642e-05,1.120e-04,2.386e-03,3.121e-04,2.882e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.368e-05 speed=9.397e-01GB/S T(nccl)=4.275e-05 speed=5.204e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=2.4e-03 t_reduction=3.1e-04 tot=2.8e-03 -----
 sigma[inter] counter=98 t=1.1e-04 per=4.0e+00 cost=4.5e+06 flops=4.0e+10
 sigma[gemm] counter=98 i=0 t=1.9e-06 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=1 t=1.9e-06 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=98 i=2 t=5.5e-04 per=2.0e+01 cost=3.4e+06 flops=6.1e+09
 sigma[gemm] counter=98 i=3 t=7.0e-04 per=2.5e+01 cost=3.3e+06 flops=4.7e+09
 sigma[gemm] counter=98 i=4 t=5.7e-04 per=2.0e+01 cost=3.1e+06 flops=5.4e+09
 sigma[gemm] counter=98 i=5 t=5.7e-04 per=2.0e+01 cost=3.1e+06 flops=5.4e+09
 sigma[gemm] counter=98 total t=2.4e-03 per=8.5e+01 cost=1.3e+07 flops=5.4e+09
 sigma[red] counter=98 t=3.1e-04 per=1.1e+01 cost=8.4e+05 flops=2.7e+09
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=2.6e-01 t_reduction=3.4e-02 tot=3.1e-01 -----
 sigma_tot[inter] counter=98 t=1.4e-02 per=4.5e+00 cost=4.9e+08 flops=3.5e+10
 sigma_tot[gemm] counter=98 i=0 t=2.2e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=1 t=2.0e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=98 i=2 t=6.4e-02 per=2.1e+01 cost=4.5e+08 flops=7.0e+09
 sigma_tot[gemm] counter=98 i=3 t=8.1e-02 per=2.6e+01 cost=4.5e+08 flops=5.5e+09
 sigma_tot[gemm] counter=98 i=4 t=5.8e-02 per=1.9e+01 cost=3.7e+08 flops=6.4e+09
 sigma_tot[gemm] counter=98 i=5 t=6.0e-02 per=1.9e+01 cost=3.8e+08 flops=6.4e+09
 sigma_tot[gemm] counter=98 total t=2.6e-01 per=8.5e+01 cost=1.6e+09 flops=6.3e+09
 sigma_tot[red] counter=98 t=3.4e-02 per=1.1e+01 cost=1.1e+08 flops=3.2e+09
T(sub)=3.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.1e-05,2.1e-06,6.1e-06,5.4e-07
   10   0 +    -116.532946558375 -1.764e-08  4.350e-05    3    10  3.134e-02 3.134e-03 3.065e-03
TIMING FOR Davidson : 3.135e-02  T(cal/comm/rest)=3.065e-02,3.264e-06,7.031e-04
decomposed t_rest=7.031e-04
 T(sub)    =3.295e-04 per=4.686e+01
 T(precond)=3.951e-05 per=5.619e+00
 T(ortho)  =4.552e-05 per=6.474e+00
 T(xcopy)  =3.793e-06 per=5.395e-01
 T(xnrm2)  =7.641e-06 per=1.087e+00
 T(other)  =2.771e-04 per=3.942e+01
optimized energies: isweep=0 ibond=12 dots=1 e[0]=-116.532946558375 nmvp=10
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=1.114e-03 change=1.637e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond12.txt
 qbond: qsuper nsym=18 dimAll=272
 (19,3):21 (21,3):39 (20,4):20 (20,2):42 (19,1):22 (21,1):27 (20,0):12 (23,3):10 (22,4):17 (22,2):25 (18,2):10 (23,1):6 (22,0):6 (21,5):7 (17,1):3 (18,0):3 (23,5):1 (22,6):1
timing for divide=3.3e-06
timing for compute=2.4e-04
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 2.6e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.3e-06,2.4e-04,0.0e+00,5.8e-06,1.4e-05 -----
decimation summary: 272->58 dwt=+2.220e-16 SvN=1.632e+00
 qbond: qkept nsym=9 dimAll=58
 (21,3):11 (21,1):9 (23,3):9 (22,2):9 (20,2):8 (22,4):5 (19,1):3 (23,1):3 (23,5):1
----- TIMING for decimation_row(nkr): 1.425e-03 S T(decim/select/formRot)=3.791e-04,1.031e-03,1.468e-05 -----
----- TIMING FOR onedot_decimation: 1.498e-03 S T(wf/decim)=6.539e-05,1.432e-03 -----
ctns::oper_renorm coord=(13,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:28 S:6 H:1 P:33 Q:39 
        dim(bra,ket)=58,58 size(op)=472:3.601e-03MB size(tot)=28497:2.174e-01MB:2.123e-04GB
        per(mem): C:28.3 S:5.12 H:1.66 P:18.7 Q:46.2 
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=1.099e-03 change=1.664e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=101 : 1.022e-03 S -----
rank=0 GPUmem(GB): used=6.032e-04 (oper)=5.843e-04
rank=0 GPUmem(GB): used=6.144e-04 (oper,site)=5.843e-04,1.112e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=101
 no. of rintermediate operators=171
 no. of coefficients=2223:1.696e-02MB:1.656e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.321e-05 S -----
rank=0 GPUmem(GB): used=6.309e-04 (oper,site,rinter)=5.843e-04,1.112e-05,1.656e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 8.867e-04 S size(rtasks)=101 size(Rlst2)=81 T(Rmu/Rlist)=1.645e-04,7.221e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.155e-03 S size(rtasks)=101 size(Rlst)=2966 -----
rank=0 GPUmem(GB): used=6.309e-04 avail=3.829e+01 total=3.829e+01 batch[need]=9.613e-03 blksize=154 blksize0=126 batchsize=2966
rank=0 GPUmem(GB): used=1.024e-02 (oper,site,rinter,batch)=5.843e-04,1.112e-05,1.656e-05,9.613e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.189e-04,1.117e-03,2.431e-04
----- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=1.1e-03 t_reduction=2.4e-04 tot=1.5e-03 -----
 renorm[inter] counter=313 t=1.2e-04 per=8.0e+00 cost=2.1e+06 flops=1.7e+10
 renorm[gemm] counter=313 i=0 t=1.8e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=313 i=1 t=1.7e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=313 i=2 t=1.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=313 i=3 t=1.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=313 i=4 t=3.0e-04 per=2.0e+01 cost=1.0e+06 flops=3.4e+09
 renorm[gemm] counter=313 i=5 t=4.2e-04 per=2.8e+01 cost=2.1e+06 flops=5.1e+09
 renorm[gemm] counter=313 i=6 t=3.9e-04 per=2.7e+01 cost=3.5e+06 flops=9.0e+09
 renorm[gemm] counter=313 total t=1.1e-03 per=7.6e+01 cost=6.7e+06 flops=6.0e+09
 renorm[red] counter=313 t=2.4e-04 per=1.6e+01 cost=3.8e+05 flops=1.6e+09
----- TIMING FOR renorm_tot : t_inter=1.7e-03 t_gemm=1.4e-02 t_reduction=3.5e-03 tot=2.0e-02 -----
 renorm_tot[inter] counter=313 t=1.7e-03 per=8.9e+00 cost=1.5e+07 flops=8.4e+09
 renorm_tot[gemm] counter=313 i=0 t=2.7e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=313 i=1 t=2.4e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=313 i=2 t=2.4e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=313 i=3 t=2.4e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=313 i=4 t=3.7e-03 per=1.9e+01 cost=9.3e+06 flops=2.5e+09
 renorm_tot[gemm] counter=313 i=5 t=5.4e-03 per=2.8e+01 cost=2.2e+07 flops=4.2e+09
 renorm_tot[gemm] counter=313 i=6 t=5.1e-03 per=2.6e+01 cost=4.3e+07 flops=8.3e+09
 renorm_tot[gemm] counter=313 total t=1.4e-02 per=7.3e+01 cost=7.5e+07 flops=5.2e+09
 renorm_tot[red] counter=313 t=3.5e-03 per=1.8e+01 cost=5.0e+06 flops=1.4e+09
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=6.246e-04 (oper)=5.868e-04
rank=0 GPUmem(GB): used=6.357e-04 (oper,site,rinter)=5.868e-04,1.112e-05,2.325e-06
rank=0 GPUmem(GB): used=7.459e-04 (oper,site,rinter,batch)=5.868e-04,1.112e-05,2.325e-06,1.101e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 5.579e-03 S T(preprocess/alloc/comp/red/dealloc)=5.202e-04,6.070e-04,3.681e-03,1.197e-03,7.145e-05 -----
----- TIMING FOR oper_renorm_opS : 5.607e-03 S rank=0 -----
qops.to_cpu: size(tot)=28497:2.174e-01MB:2.123e-04GB T(to_cpu)=1.084e-04S speed=1.959e+00GB/S
check ||H-H.dagger||=5.840e-14 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.0117 S rank=0 -----
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=1.595e-03 change=1.113e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=2.594e-03 change=-2.498e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=2.594e-03 change=-1.384e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 5.692e-02 S #####
 T(local opt: fetch) = 3.132e-03 S  per =  5.5  per(accum) = 5.5
 T(local opt: hdiag) = 8.958e-04 S  per = 1.57  per(accum) = 7.08
 T(local opt: dvdsn) = 3.697e-02 S  per = 64.9  per(accum) = 72
 T(local opt: decim) = 1.530e-03 S  per = 2.69  per(accum) = 74.7
 T(local opt: guess) = 5.859e-05 S  per = 0.103  per(accum) = 74.8
 T(local opt: renrm) = 1.238e-02 S  per = 21.8  per(accum) = 96.6
 T(local opt: save ) = 1.954e-03 S  per = 3.43  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.697e-02 S  T(sum) = 3.633e-02 S  per = 9.827e+01
 T(local opt: preprocess                  ) = 7.095e-05 S  per = 0.195  per(accum) = 0.195
 T(local opt: symbolic_formulae           ) = 8.925e-04 S  per = 2.46  per(accum) = 2.65
 T(local opt: hintermediate init          ) = 7.369e-05 S  per = 0.203  per(accum) = 2.85
 T(local opt: preprocess_hformulae_Hxlist ) = 1.878e-03 S  per = 5.17  per(accum) = 8.02
 T(local opt: hmmtasks init               ) = 2.053e-03 S  per = 5.65  per(accum) = 13.7
 T(local opt: initial guess for dvdson    ) = 5.768e-06 S  per = 0.0159  per(accum) = 13.7
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.985e-02 S  per = 82.2  per(accum) = 95.9
 T(local opt: dvdson [cpu-gpu]            ) = 2.391e-04 S  per = 0.658  per(accum) = 96.5
 T(local opt: dvdson [nccl]               ) = 5.565e-04 S  per = 1.53  per(accum) = 98.1
 T(local opt: dvdson [mpi]                ) = 3.264e-06 S  per = 0.00899  per(accum) = 98.1
 T(local opt: dvdson [rest part(linalg)]  ) = 7.031e-04 S  per = 1.94  per(accum) = 100
Detailed decomposition of T(renrm) = 1.238e-02 S  T(sum) = 1.238e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.073e-05 S  per = 0.41  per(accum) = 0.41
 T(local opt: qops init                    ) = 4.181e-04 S  per = 3.38  per(accum) = 3.79
 T(local opt: symbolic_formulae_renorm     ) = 1.028e-03 S  per =  8.3  per(accum) = 12.1
 T(local opt: allocate qops on gpu         ) = 5.291e-05 S  per = 0.427  per(accum) = 12.5
 T(local opt: site memcpy cpu2gpu          ) = 2.060e-05 S  per = 0.166  per(accum) = 12.7
 T(local opt: rintermediate init           ) = 4.991e-05 S  per = 0.403  per(accum) = 13.1
 T(local opt: preprocess_formulae_Rlist2   ) = 1.170e-03 S  per = 9.45  per(accum) = 22.5
 T(local opt: rmmtasks init                ) = 1.387e-03 S  per = 11.2  per(accum) = 33.7
 T(local opt: qops memset on cpu           ) = 3.900e-08 S  per = 0.000315  per(accum) = 33.7
 T(local opt: preprocess_renorm_batchGPU   ) = 1.545e-03 S  per = 12.5  per(accum) = 46.2
 T(local opt: deallocate cpu and gpu memory) = 2.324e-04 S  per = 1.88  per(accum) = 48.1
 T(local opt: construct opS [ifdists=true] ) = 5.689e-03 S  per = 45.9  per(accum) = 94
 T(local opt: reduction of opS & opH [nccl]) = 1.949e-05 S  per = 0.157  per(accum) = 94.2
 T(local opt: qops memcpy gpu2cpu          ) = 1.196e-04 S  per = 0.966  per(accum) = 95.1
 T(local opt: reduction of opS & opH [mpi] ) = 1.353e-05 S  per = 0.109  per(accum) = 95.3
 T(local opt: qops_pool join and erase     ) = 5.868e-04 S  per = 4.74  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.640e-07 S  per = 0.00698  per(accum) = 100
ctns::rcanon_save_site idx=6 scratch=./scratch/sweep size=1493:1.1e-05GB T(load)=0.00058S speed=0.019GB/S
##### sweep opt: 8.436e-01 S #####
 T(sweep opt: fetch) = 4.570e-02 S  per = 5.42  per(accum) = 5.42
 T(sweep opt: hdiag) = 1.308e-02 S  per = 1.55  per(accum) = 6.97
 T(sweep opt: dvdsn) = 4.587e-01 S  per = 54.4  per(accum) = 61.3
 T(sweep opt: decim) = 1.595e-02 S  per = 1.89  per(accum) = 63.2
 T(sweep opt: guess) = 7.933e-04 S  per = 0.094  per(accum) = 63.3
 T(sweep opt: renrm) = 2.818e-01 S  per = 33.4  per(accum) = 96.7
 T(sweep opt: save ) = 2.752e-02 S  per = 3.26  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.587e-01 S  T(sum) = 4.510e-01 S  per = 9.832e+01
 T(sweep opt: preprocess                  ) = 1.022e-03 S  per = 0.227  per(accum) = 0.227
 T(sweep opt: symbolic_formulae           ) = 1.269e-02 S  per = 2.81  per(accum) = 3.04
 T(sweep opt: hintermediate init          ) = 8.290e-04 S  per = 0.184  per(accum) = 3.22
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.611e-02 S  per = 10.2  per(accum) = 13.4
 T(sweep opt: hmmtasks init               ) = 4.681e-02 S  per = 10.4  per(accum) = 23.8
 T(sweep opt: initial guess for dvdson    ) = 9.358e-05 S  per = 0.0207  per(accum) = 23.8
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.289e-01 S  per = 72.9  per(accum) = 96.8
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.451e-03 S  per = 0.543  per(accum) = 97.3
 T(sweep opt: dvdson [nccl]               ) = 4.888e-03 S  per = 1.08  per(accum) = 98.4
 T(sweep opt: dvdson [mpi]                ) = 4.570e-05 S  per = 0.0101  per(accum) = 98.4
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.183e-03 S  per = 1.59  per(accum) = 100
Detailed decomposition of T(renrm) = 2.818e-01 S  T(sum) = 2.818e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 6.855e-04 S  per = 0.243  per(accum) = 0.243
 T(sweep opt: qops init                    ) = 7.111e-03 S  per = 2.52  per(accum) = 2.77
 T(sweep opt: symbolic_formulae_renorm     ) = 6.909e-03 S  per = 2.45  per(accum) = 5.22
 T(sweep opt: allocate qops on gpu         ) = 9.413e-04 S  per = 0.334  per(accum) = 5.55
 T(sweep opt: site memcpy cpu2gpu          ) = 3.181e-04 S  per = 0.113  per(accum) = 5.66
 T(sweep opt: rintermediate init           ) = 7.149e-04 S  per = 0.254  per(accum) = 5.92
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.331e-02 S  per = 4.72  per(accum) = 10.6
 T(sweep opt: rmmtasks init                ) = 1.446e-02 S  per = 5.13  per(accum) = 15.8
 T(sweep opt: qops memset on cpu           ) = 5.610e-07 S  per = 0.000199  per(accum) = 15.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.146e-02 S  per = 7.61  per(accum) = 23.4
 T(sweep opt: deallocate cpu and gpu memory) = 2.117e-03 S  per = 0.751  per(accum) = 24.1
 T(sweep opt: construct opS [ifdists=true] ) = 1.951e-01 S  per = 69.2  per(accum) = 93.4
 T(sweep opt: reduction of opS & opH [nccl]) = 2.754e-04 S  per = 0.0977  per(accum) = 93.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.770e-03 S  per = 0.628  per(accum) = 94.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.177e-04 S  per = 0.113  per(accum) = 94.2
 T(sweep opt: qops_pool join and erase     ) = 9.487e-03 S  per = 3.37  per(accum) = 97.6
 T(sweep opt: conversion from opAB to opPQ ) = 6.824e-03 S  per = 2.42  per(accum) = 100
##### global opt: 8.436e-01 S #####
 T(global opt: fetch) = 4.570e-02 S  per = 5.42  per(accum) = 5.42
 T(global opt: hdiag) = 1.308e-02 S  per = 1.55  per(accum) = 6.97
 T(global opt: dvdsn) = 4.587e-01 S  per = 54.4  per(accum) = 61.3
 T(global opt: decim) = 1.595e-02 S  per = 1.89  per(accum) = 63.2
 T(global opt: guess) = 7.933e-04 S  per = 0.094  per(accum) = 63.3
 T(global opt: renrm) = 2.818e-01 S  per = 33.4  per(accum) = 96.7
 T(global opt: save ) = 2.752e-02 S  per = 3.26  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.587e-01 S  T(sum) = 4.510e-01 S  per = 9.832e+01
 T(global opt: preprocess                  ) = 1.022e-03 S  per = 0.227  per(accum) = 0.227
 T(global opt: symbolic_formulae           ) = 1.269e-02 S  per = 2.81  per(accum) = 3.04
 T(global opt: hintermediate init          ) = 8.290e-04 S  per = 0.184  per(accum) = 3.22
 T(global opt: preprocess_hformulae_Hxlist ) = 4.611e-02 S  per = 10.2  per(accum) = 13.4
 T(global opt: hmmtasks init               ) = 4.681e-02 S  per = 10.4  per(accum) = 23.8
 T(global opt: initial guess for dvdson    ) = 9.358e-05 S  per = 0.0207  per(accum) = 23.8
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.289e-01 S  per = 72.9  per(accum) = 96.8
 T(global opt: dvdson [cpu-gpu]            ) = 2.451e-03 S  per = 0.543  per(accum) = 97.3
 T(global opt: dvdson [nccl]               ) = 4.888e-03 S  per = 1.08  per(accum) = 98.4
 T(global opt: dvdson [mpi]                ) = 4.570e-05 S  per = 0.0101  per(accum) = 98.4
 T(global opt: dvdson [rest part(linalg)]  ) = 7.183e-03 S  per = 1.59  per(accum) = 100
Detailed decomposition of T(renrm) = 2.818e-01 S  T(sum) = 2.818e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 6.855e-04 S  per = 0.243  per(accum) = 0.243
 T(global opt: qops init                    ) = 7.111e-03 S  per = 2.52  per(accum) = 2.77
 T(global opt: symbolic_formulae_renorm     ) = 6.909e-03 S  per = 2.45  per(accum) = 5.22
 T(global opt: allocate qops on gpu         ) = 9.413e-04 S  per = 0.334  per(accum) = 5.55
 T(global opt: site memcpy cpu2gpu          ) = 3.181e-04 S  per = 0.113  per(accum) = 5.66
 T(global opt: rintermediate init           ) = 7.149e-04 S  per = 0.254  per(accum) = 5.92
 T(global opt: preprocess_formulae_Rlist2   ) = 1.331e-02 S  per = 4.72  per(accum) = 10.6
 T(global opt: rmmtasks init                ) = 1.446e-02 S  per = 5.13  per(accum) = 15.8
 T(global opt: qops memset on cpu           ) = 5.610e-07 S  per = 0.000199  per(accum) = 15.8
 T(global opt: preprocess_renorm_batchGPU   ) = 2.146e-02 S  per = 7.61  per(accum) = 23.4
 T(global opt: deallocate cpu and gpu memory) = 2.117e-03 S  per = 0.751  per(accum) = 24.1
 T(global opt: construct opS [ifdists=true] ) = 1.951e-01 S  per = 69.2  per(accum) = 93.4
 T(global opt: reduction of opS & opH [nccl]) = 2.754e-04 S  per = 0.0977  per(accum) = 93.5
 T(global opt: qops memcpy gpu2cpu          ) = 1.770e-03 S  per = 0.628  per(accum) = 94.1
 T(global opt: reduction of opS & opH [mpi] ) = 3.177e-04 S  per = 0.113  per(accum) = 94.2
 T(global opt: qops_pool join and erase     ) = 9.487e-03 S  per = 3.37  per(accum) = 97.6
 T(global opt: conversion from opAB to opPQ ) = 6.824e-03 S  per = 2.42  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.642e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=13/seqsize=34 dots=1 dbond=(14,0)-(15,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=4 scratch=./scratch/sweep size=464:3.46e-06GB T(load)=3.27e-04S speed=1.06e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=1485:1.13e-02MB:1.11e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1021:7.79e-03MB:7.61e-06GB
total mem of comb=2654:2.02e-02MB:1.98e-05GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=6.542e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=14,5,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 11 12 13 14 15
 suppc= 10
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:28 S:6 H:1 P:33 Q:39 
        dim(bra,ket)=58,58 size(op)=472:3.601e-03MB size(tot)=28497:2.174e-01MB:2.123e-04GB
        per(mem): C:28.3 S:5.12 H:1.66 P:18.7 Q:46.2 
 rqops: oplist=CSHAB nops=C:10 S:15 H:1 A:22 B:28 
        dim(bra,ket)=42,42 size(op)=270:0.00206MB size(tot)=11084:0.0846MB:8.26e-05GB
        per(mem): C:15.2 S:18.4 H:2.44 A:17.6 B:46.4 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=41917:0.32MB:0.000312GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.056e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(14,0) fdel=./scratch/sweep/rop(15,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-8.357e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(58,42,4) nnz=1021:7.790e-03MB
qtensor3: wf3 own=1 _data=0x55b2c3a6c000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=58
 (21,3):11 (21,1):9 (23,3):9 (22,2):9 (20,2):8 (22,4):5 (19,1):3 (23,1):3 (23,5):1
 qbond: qcol nsym=8 dimAll=42
 (6,-2):8 (8,-2):8 (7,-3):8 (7,-1):6 (5,-3):4 (6,-4):4 (9,-1):3 (5,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=22 nblocks=288 size=1021:7.790e-03MB
### DIAG TIMING: total=5.987e-04 t1=1.854e-05, t2=1.446e-05, t3=1.303e-05, t4=4.853e-04, t5=1.075e-05, t6=4.733e-05, t7=9.311e-06
duration_diagGPU:6.068e-04
duration_diagreduce:4.000e-08
duration_diagtransform:1.052e-06
----- TIMING FOR symbolic_formulae_onedot with size=305 : 6.504e-04 S -----
rank=0 GPUmem(GB): used=3.123e-04 (oper)=3.123e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=305
 no. of hintermediate operators=140
 no. of coefficients=1960:1.495e-02MB:1.460e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.166e-05 S -----
rank=0 GPUmem(GB): used=3.269e-04 (oper,hinter)=3.123e-04,1.460e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 9.704e-04 S size(H_formulae)=305 size(Hxlst2)=22 T(Hmu/Hxlist)=1.192e-04,8.511e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.306e-03 S size(H_formulae)=305 size(Hxlst)=4350 -----
rank=0 GPUmem(GB): used=3.269e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.521e-05 batch[need]=8.945e-03 blksize=88 blksize0=99 batchsize=4350
rank=0 GPUmem(GB): used=9.287e-03 (oper,hinter,dvdson,batch)=3.123e-04,1.460e-05,1.521e-05,8.945e-03
ctns::pdvdsonSolver_nkr::solve_iter ndim=1021 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.345e-05,1.099e-04,1.160e-03,2.478e-04,1.612e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.429e-05 speed=6.264e-01GB/S T(nccl)=5.916e-05 speed=2.572e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.2e-03 t_reduction=2.5e-04 tot=1.5e-03 -----
 sigma[inter] counter=99 t=1.1e-04 per=7.2e+00 cost=2.8e+06 flops=2.5e+10
 sigma[gemm] counter=99 i=0 t=1.8e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=1 t=1.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=99 i=2 t=2.8e-04 per=1.8e+01 cost=1.4e+06 flops=4.9e+09
 sigma[gemm] counter=99 i=3 t=3.1e-04 per=2.1e+01 cost=1.3e+06 flops=4.3e+09
 sigma[gemm] counter=99 i=4 t=2.8e-04 per=1.9e+01 cost=1.4e+06 flops=5.0e+09
 sigma[gemm] counter=99 i=5 t=2.8e-04 per=1.9e+01 cost=1.4e+06 flops=5.0e+09
 sigma[gemm] counter=99 total t=1.2e-03 per=7.6e+01 cost=5.5e+06 flops=4.8e+09
 sigma[red] counter=99 t=2.5e-04 per=1.6e+01 cost=4.4e+05 flops=1.8e+09
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=2.6e-01 t_reduction=3.4e-02 tot=3.1e-01 -----
 sigma_tot[inter] counter=99 t=1.4e-02 per=4.5e+00 cost=4.9e+08 flops=3.5e+10
 sigma_tot[gemm] counter=99 i=0 t=2.2e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=1 t=2.0e-04 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=99 i=2 t=6.4e-02 per=2.1e+01 cost=4.5e+08 flops=7.0e+09
 sigma_tot[gemm] counter=99 i=3 t=8.1e-02 per=2.6e+01 cost=4.5e+08 flops=5.5e+09
 sigma_tot[gemm] counter=99 i=4 t=5.9e-02 per=1.9e+01 cost=3.7e+08 flops=6.4e+09
 sigma_tot[gemm] counter=99 i=5 t=6.0e-02 per=1.9e+01 cost=3.8e+08 flops=6.4e+09
 sigma_tot[gemm] counter=99 total t=2.6e-01 per=8.5e+01 cost=1.7e+09 flops=6.3e+09
 sigma_tot[red] counter=99 t=3.4e-02 per=1.1e+01 cost=1.1e+08 flops=3.1e+09
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,2.8e-06,1.1e-06,2.8e-06,4.2e-07
settings: ndim=1021 neig=1 maxcycle=30 nbuff=4 memory=0.0001GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.532946558375 -1.117e+03  5.477e-02    1     1  1.699e-03 1.699e-03 1.677e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.756e-05,1.055e-04,1.466e-03,2.805e-04,1.926e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.355e-05 speed=6.461e-01GB/S T(nccl)=4.401e-05 speed=3.457e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.5e-03 t_reduction=2.8e-04 tot=1.9e-03 -----
 sigma[inter] counter=100 t=1.1e-04 per=5.7e+00 cost=2.8e+06 flops=2.6e+10
 sigma[gemm] counter=100 i=0 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=1 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=100 i=2 t=3.3e-04 per=1.8e+01 cost=1.4e+06 flops=4.2e+09
 sigma[gemm] counter=100 i=3 t=4.0e-04 per=2.2e+01 cost=1.3e+06 flops=3.3e+09
 sigma[gemm] counter=100 i=4 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=4.0e+09
 sigma[gemm] counter=100 i=5 t=3.8e-04 per=2.1e+01 cost=1.4e+06 flops=3.7e+09
 sigma[gemm] counter=100 total t=1.5e-03 per=7.9e+01 cost=5.5e+06 flops=3.8e+09
 sigma[red] counter=100 t=2.8e-04 per=1.5e+01 cost=4.4e+05 flops=1.6e+09
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=2.7e-01 t_reduction=3.4e-02 tot=3.1e-01 -----
 sigma_tot[inter] counter=100 t=1.4e-02 per=4.5e+00 cost=4.9e+08 flops=3.5e+10
 sigma_tot[gemm] counter=100 i=0 t=2.2e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=1 t=2.0e-04 per=6.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=100 i=2 t=6.5e-02 per=2.1e+01 cost=4.5e+08 flops=7.0e+09
 sigma_tot[gemm] counter=100 i=3 t=8.1e-02 per=2.6e+01 cost=4.5e+08 flops=5.5e+09
 sigma_tot[gemm] counter=100 i=4 t=5.9e-02 per=1.9e+01 cost=3.7e+08 flops=6.3e+09
 sigma_tot[gemm] counter=100 i=5 t=6.0e-02 per=1.9e+01 cost=3.8e+08 flops=6.4e+09
 sigma_tot[gemm] counter=100 total t=2.7e-01 per=8.5e+01 cost=1.7e+09 flops=6.2e+09
 sigma_tot[red] counter=100 t=3.4e-02 per=1.1e+01 cost=1.1e+08 flops=3.1e+09
T(sub)=3.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.1e-05,3.0e-06,7.6e-06,5.0e-07
    2   0 -    -116.536216808262 -3.270e-03  1.579e-02    2     2  3.789e-03 1.895e-03 1.844e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.589e-05,1.076e-04,1.450e-03,2.745e-04,1.904e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.241e-05 speed=6.788e-01GB/S T(nccl)=4.347e-05 speed=3.500e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.4e-03 t_reduction=2.7e-04 tot=1.8e-03 -----
 sigma[inter] counter=101 t=1.1e-04 per=5.9e+00 cost=2.8e+06 flops=2.6e+10
 sigma[gemm] counter=101 i=0 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=1 t=2.3e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=101 i=2 t=3.4e-04 per=1.8e+01 cost=1.4e+06 flops=4.1e+09
 sigma[gemm] counter=101 i=3 t=4.0e-04 per=2.2e+01 cost=1.3e+06 flops=3.3e+09
 sigma[gemm] counter=101 i=4 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=4.0e+09
 sigma[gemm] counter=101 i=5 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=4.0e+09
 sigma[gemm] counter=101 total t=1.4e-03 per=7.9e+01 cost=5.5e+06 flops=3.8e+09
 sigma[red] counter=101 t=2.7e-04 per=1.5e+01 cost=4.4e+05 flops=1.6e+09
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=2.7e-01 t_reduction=3.5e-02 tot=3.2e-01 -----
 sigma_tot[inter] counter=101 t=1.4e-02 per=4.5e+00 cost=5.0e+08 flops=3.5e+10
 sigma_tot[gemm] counter=101 i=0 t=2.2e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=1 t=2.1e-04 per=6.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=101 i=2 t=6.5e-02 per=2.1e+01 cost=4.6e+08 flops=7.0e+09
 sigma_tot[gemm] counter=101 i=3 t=8.2e-02 per=2.6e+01 cost=4.5e+08 flops=5.5e+09
 sigma_tot[gemm] counter=101 i=4 t=5.9e-02 per=1.9e+01 cost=3.8e+08 flops=6.3e+09
 sigma_tot[gemm] counter=101 i=5 t=6.1e-02 per=1.9e+01 cost=3.8e+08 flops=6.3e+09
 sigma_tot[gemm] counter=101 total t=2.7e-01 per=8.5e+01 cost=1.7e+09 flops=6.2e+09
 sigma_tot[red] counter=101 t=3.5e-02 per=1.1e+01 cost=1.1e+08 flops=3.1e+09
T(sub)=3.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.4e-05,2.2e-06,8.6e-06,4.8e-07
    3   0 -    -116.536743874006 -5.271e-04  8.289e-03    3     3  6.140e-03 2.047e-03 1.992e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.667e-05,1.168e-04,1.527e-03,2.919e-04,2.008e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.357e-05 speed=6.454e-01GB/S T(nccl)=4.310e-05 speed=3.530e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=1.5e-03 t_reduction=2.9e-04 tot=1.9e-03 -----
 sigma[inter] counter=102 t=1.2e-04 per=6.0e+00 cost=2.8e+06 flops=2.4e+10
 sigma[gemm] counter=102 i=0 t=2.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=1 t=2.0e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=102 i=2 t=3.5e-04 per=1.8e+01 cost=1.4e+06 flops=3.9e+09
 sigma[gemm] counter=102 i=3 t=4.4e-04 per=2.3e+01 cost=1.3e+06 flops=3.0e+09
 sigma[gemm] counter=102 i=4 t=3.7e-04 per=1.9e+01 cost=1.4e+06 flops=3.8e+09
 sigma[gemm] counter=102 i=5 t=3.5e-04 per=1.8e+01 cost=1.4e+06 flops=4.0e+09
 sigma[gemm] counter=102 total t=1.5e-03 per=7.9e+01 cost=5.5e+06 flops=3.6e+09
 sigma[red] counter=102 t=2.9e-04 per=1.5e+01 cost=4.4e+05 flops=1.5e+09
----- TIMING FOR sigma_tot : t_inter=1.4e-02 t_gemm=2.7e-01 t_reduction=3.5e-02 tot=3.2e-01 -----
 sigma_tot[inter] counter=102 t=1.4e-02 per=4.5e+00 cost=5.0e+08 flops=3.5e+10
 sigma_tot[gemm] counter=102 i=0 t=2.2e-04 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=1 t=2.1e-04 per=6.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=102 i=2 t=6.5e-02 per=2.1e+01 cost=4.6e+08 flops=7.0e+09
 sigma_tot[gemm] counter=102 i=3 t=8.2e-02 per=2.6e+01 cost=4.5e+08 flops=5.5e+09
 sigma_tot[gemm] counter=102 i=4 t=6.0e-02 per=1.9e+01 cost=3.8e+08 flops=6.3e+09
 sigma_tot[gemm] counter=102 i=5 t=6.1e-02 per=1.9e+01 cost=3.9e+08 flops=6.3e+09
 sigma_tot[gemm] counter=102 total t=2.7e-01 per=8.5e+01 cost=1.7e+09 flops=6.2e+09
 sigma_tot[red] counter=102 t=3.5e-02 per=1.1e+01 cost=1.1e+08 flops=3.1e+09
T(sub)=3.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.2e-05,2.1e-06,4.4e-06,4.3e-07
    4   0 -    -116.536890979458 -1.471e-04  4.640e-03    3     4  8.295e-03 2.074e-03 2.019e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.441e-05,1.034e-04,1.456e-03,2.762e-04,1.905e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.202e-05 speed=6.909e-01GB/S T(nccl)=4.239e-05 speed=3.589e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=1.5e-03 t_reduction=2.8e-04 tot=1.8e-03 -----
 sigma[inter] counter=103 t=1.0e-04 per=5.6e+00 cost=2.8e+06 flops=2.7e+10
 sigma[gemm] counter=103 i=0 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=1 t=2.4e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=103 i=2 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=3.9e+09
 sigma[gemm] counter=103 i=3 t=4.0e-04 per=2.2e+01 cost=1.3e+06 flops=3.3e+09
 sigma[gemm] counter=103 i=4 t=3.6e-04 per=1.9e+01 cost=1.4e+06 flops=4.0e+09
 sigma[gemm] counter=103 i=5 t=3.4e-04 per=1.9e+01 cost=1.4e+06 flops=4.1e+09
 sigma[gemm] counter=103 total t=1.5e-03 per=7.9e+01 cost=5.5e+06 flops=3.8e+09
 sigma[red] counter=103 t=2.8e-04 per=1.5e+01 cost=4.4e+05 flops=1.6e+09
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=2.7e-01 t_reduction=3.5e-02 tot=3.2e-01 -----
 sigma_tot[inter] counter=103 t=1.5e-02 per=4.6e+00 cost=5.0e+08 flops=3.5e+10
 sigma_tot[gemm] counter=103 i=0 t=2.3e-04 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=1 t=2.1e-04 per=6.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=103 i=2 t=6.6e-02 per=2.1e+01 cost=4.6e+08 flops=7.0e+09
 sigma_tot[gemm] counter=103 i=3 t=8.3e-02 per=2.6e+01 cost=4.5e+08 flops=5.5e+09
 sigma_tot[gemm] counter=103 i=4 t=6.0e-02 per=1.9e+01 cost=3.8e+08 flops=6.3e+09
 sigma_tot[gemm] counter=103 i=5 t=6.1e-02 per=1.9e+01 cost=3.9e+08 flops=6.3e+09
 sigma_tot[gemm] counter=103 total t=2.7e-01 per=8.4e+01 cost=1.7e+09 flops=6.2e+09
 sigma_tot[red] counter=103 t=3.5e-02 per=1.1e+01 cost=1.1e+08 flops=3.1e+09
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.2e-05,2.2e-06,4.5e-06,4.8e-07
    5   0 -    -116.536926688963 -3.571e-05  1.988e-03    3     5  1.034e-02 2.069e-03 2.014e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.538e-05,1.106e-04,1.504e-03,2.833e-04,1.968e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.197e-05 speed=6.926e-01GB/S T(nccl)=4.341e-05 speed=3.505e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.5e-03 t_reduction=2.8e-04 tot=1.9e-03 -----
 sigma[inter] counter=104 t=1.1e-04 per=5.8e+00 cost=2.8e+06 flops=2.5e+10
 sigma[gemm] counter=104 i=0 t=2.1e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=1 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=104 i=2 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=3.9e+09
 sigma[gemm] counter=104 i=3 t=4.5e-04 per=2.4e+01 cost=1.3e+06 flops=3.0e+09
 sigma[gemm] counter=104 i=4 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=4.0e+09
 sigma[gemm] counter=104 i=5 t=3.4e-04 per=1.8e+01 cost=1.4e+06 flops=4.1e+09
 sigma[gemm] counter=104 total t=1.5e-03 per=7.9e+01 cost=5.5e+06 flops=3.7e+09
 sigma[red] counter=104 t=2.8e-04 per=1.5e+01 cost=4.4e+05 flops=1.5e+09
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=2.7e-01 t_reduction=3.5e-02 tot=3.2e-01 -----
 sigma_tot[inter] counter=104 t=1.5e-02 per=4.6e+00 cost=5.1e+08 flops=3.4e+10
 sigma_tot[gemm] counter=104 i=0 t=2.3e-04 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=1 t=2.1e-04 per=6.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=104 i=2 t=6.6e-02 per=2.1e+01 cost=4.6e+08 flops=7.0e+09
 sigma_tot[gemm] counter=104 i=3 t=8.3e-02 per=2.6e+01 cost=4.5e+08 flops=5.5e+09
 sigma_tot[gemm] counter=104 i=4 t=6.1e-02 per=1.9e+01 cost=3.8e+08 flops=6.3e+09
 sigma_tot[gemm] counter=104 i=5 t=6.2e-02 per=1.9e+01 cost=3.9e+08 flops=6.3e+09
 sigma_tot[gemm] counter=104 total t=2.7e-01 per=8.4e+01 cost=1.7e+09 flops=6.2e+09
 sigma_tot[red] counter=104 t=3.5e-02 per=1.1e+01 cost=1.1e+08 flops=3.1e+09
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.1e-05,2.1e-06,4.3e-06,4.6e-07
    6   0 -    -116.536934366683 -7.678e-06  9.642e-04    3     6  1.245e-02 2.074e-03 2.020e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.495e-05,1.015e-04,1.435e-03,2.843e-04,1.891e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.207e-05 speed=6.892e-01GB/S T(nccl)=4.287e-05 speed=3.549e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=1.4e-03 t_reduction=2.8e-04 tot=1.8e-03 -----
 sigma[inter] counter=105 t=1.0e-04 per=5.6e+00 cost=2.8e+06 flops=2.7e+10
 sigma[gemm] counter=105 i=0 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=1 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=105 i=2 t=3.3e-04 per=1.8e+01 cost=1.4e+06 flops=4.2e+09
 sigma[gemm] counter=105 i=3 t=4.1e-04 per=2.2e+01 cost=1.3e+06 flops=3.3e+09
 sigma[gemm] counter=105 i=4 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=4.0e+09
 sigma[gemm] counter=105 i=5 t=3.4e-04 per=1.9e+01 cost=1.4e+06 flops=4.1e+09
 sigma[gemm] counter=105 total t=1.4e-03 per=7.9e+01 cost=5.5e+06 flops=3.9e+09
 sigma[red] counter=105 t=2.8e-04 per=1.6e+01 cost=4.4e+05 flops=1.5e+09
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=2.7e-01 t_reduction=3.6e-02 tot=3.2e-01 -----
 sigma_tot[inter] counter=105 t=1.5e-02 per=4.6e+00 cost=5.1e+08 flops=3.4e+10
 sigma_tot[gemm] counter=105 i=0 t=2.3e-04 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=1 t=2.1e-04 per=6.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=105 i=2 t=6.6e-02 per=2.1e+01 cost=4.6e+08 flops=6.9e+09
 sigma_tot[gemm] counter=105 i=3 t=8.3e-02 per=2.6e+01 cost=4.6e+08 flops=5.5e+09
 sigma_tot[gemm] counter=105 i=4 t=6.1e-02 per=1.9e+01 cost=3.8e+08 flops=6.3e+09
 sigma_tot[gemm] counter=105 i=5 t=6.2e-02 per=1.9e+01 cost=3.9e+08 flops=6.3e+09
 sigma_tot[gemm] counter=105 total t=2.7e-01 per=8.4e+01 cost=1.7e+09 flops=6.2e+09
 sigma_tot[red] counter=105 t=3.6e-02 per=1.1e+01 cost=1.1e+08 flops=3.1e+09
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.2e-05,1.9e-06,4.3e-06,4.5e-07
    7   0 -    -116.536936279705 -1.913e-06  4.824e-04    3     7  1.473e-02 2.105e-03 2.051e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.627e-05,1.052e-04,1.438e-03,2.737e-04,1.889e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.261e-05 speed=6.728e-01GB/S T(nccl)=4.365e-05 speed=3.485e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.4e-03 t_reduction=2.7e-04 tot=1.8e-03 -----
 sigma[inter] counter=106 t=1.1e-04 per=5.8e+00 cost=2.8e+06 flops=2.6e+10
 sigma[gemm] counter=106 i=0 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=1 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=106 i=2 t=3.3e-04 per=1.8e+01 cost=1.4e+06 flops=4.2e+09
 sigma[gemm] counter=106 i=3 t=4.1e-04 per=2.2e+01 cost=1.3e+06 flops=3.3e+09
 sigma[gemm] counter=106 i=4 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=4.1e+09
 sigma[gemm] counter=106 i=5 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=4.1e+09
 sigma[gemm] counter=106 total t=1.4e-03 per=7.9e+01 cost=5.5e+06 flops=3.9e+09
 sigma[red] counter=106 t=2.7e-04 per=1.5e+01 cost=4.4e+05 flops=1.6e+09
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=2.7e-01 t_reduction=3.6e-02 tot=3.3e-01 -----
 sigma_tot[inter] counter=106 t=1.5e-02 per=4.6e+00 cost=5.1e+08 flops=3.4e+10
 sigma_tot[gemm] counter=106 i=0 t=2.3e-04 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=1 t=2.2e-04 per=6.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=106 i=2 t=6.7e-02 per=2.1e+01 cost=4.6e+08 flops=6.9e+09
 sigma_tot[gemm] counter=106 i=3 t=8.4e-02 per=2.6e+01 cost=4.6e+08 flops=5.4e+09
 sigma_tot[gemm] counter=106 i=4 t=6.1e-02 per=1.9e+01 cost=3.8e+08 flops=6.3e+09
 sigma_tot[gemm] counter=106 i=5 t=6.2e-02 per=1.9e+01 cost=3.9e+08 flops=6.3e+09
 sigma_tot[gemm] counter=106 total t=2.7e-01 per=8.4e+01 cost=1.7e+09 flops=6.2e+09
 sigma_tot[red] counter=106 t=3.6e-02 per=1.1e+01 cost=1.1e+08 flops=3.1e+09
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.2e-05,2.0e-06,4.3e-06,3.8e-07
    8   0 -    -116.536936722776 -4.431e-07  2.129e-04    3     8  1.676e-02 2.095e-03 2.041e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.472e-05,1.002e-04,1.427e-03,2.743e-04,1.871e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.189e-05 speed=6.950e-01GB/S T(nccl)=4.283e-05 speed=3.552e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=1.4e-03 t_reduction=2.7e-04 tot=1.8e-03 -----
 sigma[inter] counter=107 t=1.0e-04 per=5.6e+00 cost=2.8e+06 flops=2.8e+10
 sigma[gemm] counter=107 i=0 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=1 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=107 i=2 t=3.3e-04 per=1.8e+01 cost=1.4e+06 flops=4.2e+09
 sigma[gemm] counter=107 i=3 t=4.0e-04 per=2.2e+01 cost=1.3e+06 flops=3.4e+09
 sigma[gemm] counter=107 i=4 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=4.1e+09
 sigma[gemm] counter=107 i=5 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=4.1e+09
 sigma[gemm] counter=107 total t=1.4e-03 per=7.9e+01 cost=5.5e+06 flops=3.9e+09
 sigma[red] counter=107 t=2.7e-04 per=1.5e+01 cost=4.4e+05 flops=1.6e+09
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=2.8e-01 t_reduction=3.6e-02 tot=3.3e-01 -----
 sigma_tot[inter] counter=107 t=1.5e-02 per=4.6e+00 cost=5.1e+08 flops=3.4e+10
 sigma_tot[gemm] counter=107 i=0 t=2.3e-04 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=1 t=2.2e-04 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=107 i=2 t=6.7e-02 per=2.0e+01 cost=4.6e+08 flops=6.9e+09
 sigma_tot[gemm] counter=107 i=3 t=8.4e-02 per=2.6e+01 cost=4.6e+08 flops=5.4e+09
 sigma_tot[gemm] counter=107 i=4 t=6.2e-02 per=1.9e+01 cost=3.8e+08 flops=6.2e+09
 sigma_tot[gemm] counter=107 i=5 t=6.3e-02 per=1.9e+01 cost=3.9e+08 flops=6.3e+09
 sigma_tot[gemm] counter=107 total t=2.8e-01 per=8.4e+01 cost=1.7e+09 flops=6.2e+09
 sigma_tot[red] counter=107 t=3.6e-02 per=1.1e+01 cost=1.1e+08 flops=3.1e+09
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.1e-05,1.9e-06,4.3e-06,4.0e-07
    9   0 +    -116.536936803243 -8.047e-08  9.281e-05    3     9  1.877e-02 2.086e-03 2.032e-03
TIMING FOR Davidson : 1.878e-02  T(cal/comm/rest)=1.828e-02,2.729e-06,4.965e-04
decomposed t_rest=4.965e-04
 T(sub)    =2.584e-04 per=5.205e+01
 T(precond)=3.228e-05 per=6.502e+00
 T(ortho)  =3.116e-05 per=6.276e+00
 T(xcopy)  =3.182e-06 per=6.409e-01
 T(xnrm2)  =4.911e-06 per=9.892e-01
 T(other)  =1.665e-04 per=3.354e+01
optimized energies: isweep=0 ibond=13 dots=1 e[0]=-116.536936803243 nmvp=9
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=1.137e-03 change=1.229e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond13.txt
 qbond: qsuper nsym=18 dimAll=232
 (21,3):19 (23,3):34 (22,4):16 (22,2):37 (21,1):20 (23,1):21 (22,0):9 (25,3):9 (24,4):15 (24,2):21 (20,2):11 (23,5):6 (19,1):3 (20,0):3 (25,1):3 (24,0):3 (25,5):1 (24,6):1
timing for divide=2.8e-06
timing for compute=2.0e-04
timing for collect=7.1e-06
----- TMING FOR decimation_genbasis(nkr): 2.1e-04 S T(divide/compute[cpu/gpu/rest]/collect)=2.8e-06,1.6e-04,0.0e+00,4.3e-05,7.1e-06 -----
decimation summary: 232->42 dwt=+0.000e+00 SvN=1.332e+00
 qbond: qkept nsym=8 dimAll=42
 (23,3):8 (22,2):8 (24,2):8 (23,1):6 (25,3):4 (24,4):4 (21,1):3 (25,1):1
----- TIMING for decimation_row(nkr): 1.199e-03 S T(decim/select/formRot)=2.516e-04,9.344e-04,1.351e-05 -----
----- TIMING FOR onedot_decimation: 1.270e-03 S T(wf/decim)=6.345e-05,1.207e-03 -----
ctns::oper_renorm coord=(14,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:30 S:5 H:1 P:22 Q:28 
        dim(bra,ket)=42,42 size(op)=270:2.060e-03MB size(tot)=13084:9.982e-02MB:9.748e-05GB
        per(mem): C:38.5 S:5.2 H:2.06 P:14.9 Q:39.3 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=1.137e-03 change=1.053e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=81 : 7.298e-04 S -----
rank=0 GPUmem(GB): used=3.418e-04 (oper)=3.272e-04
rank=0 GPUmem(GB): used=3.494e-04 (oper,site)=3.272e-04,7.607e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=81
 no. of rintermediate operators=120
 no. of coefficients=1680:1.282e-02MB:1.252e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.498e-05 S -----
rank=0 GPUmem(GB): used=3.619e-04 (oper,site,rinter)=3.272e-04,7.607e-06,1.252e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 6.663e-04 S size(rtasks)=81 size(Rlst2)=64 T(Rmu/Rlist)=1.205e-04,5.458e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.619e-04 S size(rtasks)=81 size(Rlst)=2272 -----
rank=0 GPUmem(GB): used=3.619e-04 avail=3.829e+01 total=3.829e+01 batch[need]=4.672e-03 blksize=88 blksize0=99 batchsize=2272
rank=0 GPUmem(GB): used=5.034e-03 (oper,site,rinter,batch)=3.272e-04,7.607e-06,1.252e-05,4.672e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.384e-04,9.814e-04,2.121e-04
----- TIMING FOR renorm : t_inter=1.4e-04 t_gemm=9.8e-04 t_reduction=2.1e-04 tot=1.3e-03 -----
 renorm[inter] counter=326 t=1.4e-04 per=1.0e+01 cost=1.2e+06 flops=9.0e+09
 renorm[gemm] counter=326 i=0 t=2.7e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=326 i=1 t=2.0e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=326 i=2 t=2.1e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=326 i=3 t=1.9e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=326 i=4 t=2.9e-04 per=2.2e+01 cost=4.9e+05 flops=1.7e+09
 renorm[gemm] counter=326 i=5 t=3.6e-04 per=2.7e+01 cost=1.0e+06 flops=2.8e+09
 renorm[gemm] counter=326 i=6 t=3.2e-04 per=2.4e+01 cost=1.6e+06 flops=4.9e+09
 renorm[gemm] counter=326 total t=9.8e-04 per=7.4e+01 cost=3.1e+06 flops=3.1e+09
 renorm[red] counter=326 t=2.1e-04 per=1.6e+01 cost=1.9e+05 flops=9.0e+08
----- TIMING FOR renorm_tot : t_inter=1.9e-03 t_gemm=1.5e-02 t_reduction=3.7e-03 tot=2.1e-02 -----
 renorm_tot[inter] counter=326 t=1.9e-03 per=9.0e+00 cost=1.6e+07 flops=8.5e+09
 renorm_tot[gemm] counter=326 i=0 t=3.0e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=326 i=1 t=2.6e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=326 i=2 t=2.6e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=326 i=3 t=2.5e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=326 i=4 t=4.0e-03 per=1.9e+01 cost=9.8e+06 flops=2.4e+09
 renorm_tot[gemm] counter=326 i=5 t=5.8e-03 per=2.8e+01 cost=2.3e+07 flops=4.1e+09
 renorm_tot[gemm] counter=326 i=6 t=5.4e-03 per=2.6e+01 cost=4.4e+07 flops=8.1e+09
 renorm_tot[gemm] counter=326 total t=1.5e-02 per=7.3e+01 cost=7.8e+07 flops=5.1e+09
 renorm_tot[red] counter=326 t=3.7e-03 per=1.8e+01 cost=5.2e+06 flops=1.4e+09
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.579e-04 (oper)=3.287e-04
rank=0 GPUmem(GB): used=3.655e-04 (oper,site,rinter)=3.287e-04,7.607e-06,2.086e-06
rank=0 GPUmem(GB): used=4.354e-04 (oper,site,rinter,batch)=3.287e-04,7.607e-06,2.086e-06,6.992e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.279e-03 S T(preprocess/alloc/comp/red/dealloc)=4.198e-04,5.061e-04,2.893e-03,8.002e-04,6.140e-05 -----
----- TIMING FOR oper_renorm_opS : 4.305e-03 S rank=0 -----
qops.to_cpu: size(tot)=13084:9.982e-02MB:9.748e-05GB T(to_cpu)=6.757e-05S speed=1.443e+00GB/S
check ||H-H.dagger||=4.942e-14 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.00907 S rank=0 -----
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=8.011e-04 change=7.867e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=2.518e-03 change=-2.042e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=2.518e-03 change=-9.641e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 3.947e-02 S #####
 T(local opt: fetch) = 2.871e-03 S  per = 7.27  per(accum) = 7.27
 T(local opt: hdiag) = 6.332e-04 S  per =  1.6  per(accum) = 8.88
 T(local opt: dvdsn) = 2.301e-02 S  per = 58.3  per(accum) = 67.2
 T(local opt: decim) = 1.298e-03 S  per = 3.29  per(accum) = 70.5
 T(local opt: guess) = 4.751e-05 S  per = 0.12  per(accum) = 70.6
 T(local opt: renrm) = 9.688e-03 S  per = 24.5  per(accum) = 95.1
 T(local opt: save ) = 1.925e-03 S  per = 4.88  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.301e-02 S  T(sum) = 2.250e-02 S  per = 9.780e+01
 T(local opt: preprocess                  ) = 5.529e-05 S  per = 0.246  per(accum) = 0.246
 T(local opt: symbolic_formulae           ) = 6.553e-04 S  per = 2.91  per(accum) = 3.16
 T(local opt: hintermediate init          ) = 3.923e-05 S  per = 0.174  per(accum) = 3.33
 T(local opt: preprocess_hformulae_Hxlist ) = 1.322e-03 S  per = 5.88  per(accum) = 9.21
 T(local opt: hmmtasks init               ) = 1.645e-03 S  per = 7.31  per(accum) = 16.5
 T(local opt: initial guess for dvdson    ) = 4.212e-06 S  per = 0.0187  per(accum) = 16.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.767e-02 S  per = 78.5  per(accum) = 95.1
 T(local opt: dvdson [cpu-gpu]            ) = 2.044e-04 S  per = 0.908  per(accum) = 96
 T(local opt: dvdson [nccl]               ) = 4.049e-04 S  per =  1.8  per(accum) = 97.8
 T(local opt: dvdson [mpi]                ) = 2.729e-06 S  per = 0.0121  per(accum) = 97.8
 T(local opt: dvdson [rest part(linalg)]  ) = 4.965e-04 S  per = 2.21  per(accum) = 100
Detailed decomposition of T(renrm) = 9.688e-03 S  T(sum) = 9.688e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.193e-05 S  per = 0.433  per(accum) = 0.433
 T(local opt: qops init                    ) = 3.257e-04 S  per = 3.36  per(accum) = 3.79
 T(local opt: symbolic_formulae_renorm     ) = 7.352e-04 S  per = 7.59  per(accum) = 11.4
 T(local opt: allocate qops on gpu         ) = 5.265e-05 S  per = 0.543  per(accum) = 11.9
 T(local opt: site memcpy cpu2gpu          ) = 1.855e-05 S  per = 0.191  per(accum) = 12.1
 T(local opt: rintermediate init           ) = 4.119e-05 S  per = 0.425  per(accum) = 12.5
 T(local opt: preprocess_formulae_Rlist2   ) = 8.733e-04 S  per = 9.01  per(accum) = 21.6
 T(local opt: rmmtasks init                ) = 9.772e-04 S  per = 10.1  per(accum) = 31.6
 T(local opt: qops memset on cpu           ) = 9.200e-08 S  per = 0.00095  per(accum) = 31.6
 T(local opt: preprocess_renorm_batchGPU   ) = 1.397e-03 S  per = 14.4  per(accum) = 46.1
 T(local opt: deallocate cpu and gpu memory) = 1.835e-04 S  per = 1.89  per(accum) = 48
 T(local opt: construct opS [ifdists=true] ) = 4.319e-03 S  per = 44.6  per(accum) = 92.5
 T(local opt: reduction of opS & opH [nccl]) = 1.816e-05 S  per = 0.187  per(accum) = 92.7
 T(local opt: qops memcpy gpu2cpu          ) = 7.825e-05 S  per = 0.808  per(accum) = 93.5
 T(local opt: reduction of opS & opH [mpi] ) = 4.572e-05 S  per = 0.472  per(accum) = 94
 T(local opt: qops_pool join and erase     ) = 5.781e-04 S  per = 5.97  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.037e-06 S  per = 0.021  per(accum) = 100
ctns::rcanon_save_site idx=5 scratch=./scratch/sweep size=1021:7.6e-06GB T(load)=0.00058S speed=0.013GB/S
##### sweep opt: 8.831e-01 S #####
 T(sweep opt: fetch) = 4.857e-02 S  per =  5.5  per(accum) = 5.5
 T(sweep opt: hdiag) = 1.371e-02 S  per = 1.55  per(accum) = 7.05
 T(sweep opt: dvdsn) = 4.817e-01 S  per = 54.6  per(accum) = 61.6
 T(sweep opt: decim) = 1.725e-02 S  per = 1.95  per(accum) = 63.6
 T(sweep opt: guess) = 8.408e-04 S  per = 0.0952  per(accum) = 63.7
 T(sweep opt: renrm) = 2.915e-01 S  per =   33  per(accum) = 96.7
 T(sweep opt: save ) = 2.945e-02 S  per = 3.33  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.817e-01 S  T(sum) = 4.735e-01 S  per = 9.830e+01
 T(sweep opt: preprocess                  ) = 1.077e-03 S  per = 0.227  per(accum) = 0.227
 T(sweep opt: symbolic_formulae           ) = 1.334e-02 S  per = 2.82  per(accum) = 3.05
 T(sweep opt: hintermediate init          ) = 8.682e-04 S  per = 0.183  per(accum) = 3.23
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.743e-02 S  per =   10  per(accum) = 13.2
 T(sweep opt: hmmtasks init               ) = 4.846e-02 S  per = 10.2  per(accum) = 23.5
 T(sweep opt: initial guess for dvdson    ) = 9.779e-05 S  per = 0.0207  per(accum) = 23.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.466e-01 S  per = 73.2  per(accum) = 96.7
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.656e-03 S  per = 0.561  per(accum) = 97.3
 T(sweep opt: dvdson [nccl]               ) = 5.293e-03 S  per = 1.12  per(accum) = 98.4
 T(sweep opt: dvdson [mpi]                ) = 4.843e-05 S  per = 0.0102  per(accum) = 98.4
 T(sweep opt: dvdson [rest part(linalg)]  ) = 7.679e-03 S  per = 1.62  per(accum) = 100
Detailed decomposition of T(renrm) = 2.915e-01 S  T(sum) = 2.915e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.274e-04 S  per = 0.25  per(accum) = 0.25
 T(sweep opt: qops init                    ) = 7.437e-03 S  per = 2.55  per(accum) = 2.8
 T(sweep opt: symbolic_formulae_renorm     ) = 7.644e-03 S  per = 2.62  per(accum) = 5.42
 T(sweep opt: allocate qops on gpu         ) = 9.940e-04 S  per = 0.341  per(accum) = 5.76
 T(sweep opt: site memcpy cpu2gpu          ) = 3.366e-04 S  per = 0.115  per(accum) = 5.88
 T(sweep opt: rintermediate init           ) = 7.561e-04 S  per = 0.259  per(accum) = 6.14
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.418e-02 S  per = 4.87  per(accum) = 11
 T(sweep opt: rmmtasks init                ) = 1.544e-02 S  per =  5.3  per(accum) = 16.3
 T(sweep opt: qops memset on cpu           ) = 6.530e-07 S  per = 0.000224  per(accum) = 16.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.285e-02 S  per = 7.84  per(accum) = 24.1
 T(sweep opt: deallocate cpu and gpu memory) = 2.300e-03 S  per = 0.789  per(accum) = 24.9
 T(sweep opt: construct opS [ifdists=true] ) = 1.995e-01 S  per = 68.4  per(accum) = 93.3
 T(sweep opt: reduction of opS & opH [nccl]) = 2.935e-04 S  per = 0.101  per(accum) = 93.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.849e-03 S  per = 0.634  per(accum) = 94.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 3.634e-04 S  per = 0.125  per(accum) = 94.2
 T(sweep opt: qops_pool join and erase     ) = 1.007e-02 S  per = 3.45  per(accum) = 97.7
 T(sweep opt: conversion from opAB to opPQ ) = 6.826e-03 S  per = 2.34  per(accum) = 100
##### global opt: 8.831e-01 S #####
 T(global opt: fetch) = 4.857e-02 S  per =  5.5  per(accum) = 5.5
 T(global opt: hdiag) = 1.371e-02 S  per = 1.55  per(accum) = 7.05
 T(global opt: dvdsn) = 4.817e-01 S  per = 54.6  per(accum) = 61.6
 T(global opt: decim) = 1.725e-02 S  per = 1.95  per(accum) = 63.6
 T(global opt: guess) = 8.408e-04 S  per = 0.0952  per(accum) = 63.7
 T(global opt: renrm) = 2.915e-01 S  per =   33  per(accum) = 96.7
 T(global opt: save ) = 2.945e-02 S  per = 3.33  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.817e-01 S  T(sum) = 4.735e-01 S  per = 9.830e+01
 T(global opt: preprocess                  ) = 1.077e-03 S  per = 0.227  per(accum) = 0.227
 T(global opt: symbolic_formulae           ) = 1.334e-02 S  per = 2.82  per(accum) = 3.05
 T(global opt: hintermediate init          ) = 8.682e-04 S  per = 0.183  per(accum) = 3.23
 T(global opt: preprocess_hformulae_Hxlist ) = 4.743e-02 S  per =   10  per(accum) = 13.2
 T(global opt: hmmtasks init               ) = 4.846e-02 S  per = 10.2  per(accum) = 23.5
 T(global opt: initial guess for dvdson    ) = 9.779e-05 S  per = 0.0207  per(accum) = 23.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.466e-01 S  per = 73.2  per(accum) = 96.7
 T(global opt: dvdson [cpu-gpu]            ) = 2.656e-03 S  per = 0.561  per(accum) = 97.3
 T(global opt: dvdson [nccl]               ) = 5.293e-03 S  per = 1.12  per(accum) = 98.4
 T(global opt: dvdson [mpi]                ) = 4.843e-05 S  per = 0.0102  per(accum) = 98.4
 T(global opt: dvdson [rest part(linalg)]  ) = 7.679e-03 S  per = 1.62  per(accum) = 100
Detailed decomposition of T(renrm) = 2.915e-01 S  T(sum) = 2.915e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.274e-04 S  per = 0.25  per(accum) = 0.25
 T(global opt: qops init                    ) = 7.437e-03 S  per = 2.55  per(accum) = 2.8
 T(global opt: symbolic_formulae_renorm     ) = 7.644e-03 S  per = 2.62  per(accum) = 5.42
 T(global opt: allocate qops on gpu         ) = 9.940e-04 S  per = 0.341  per(accum) = 5.76
 T(global opt: site memcpy cpu2gpu          ) = 3.366e-04 S  per = 0.115  per(accum) = 5.88
 T(global opt: rintermediate init           ) = 7.561e-04 S  per = 0.259  per(accum) = 6.14
 T(global opt: preprocess_formulae_Rlist2   ) = 1.418e-02 S  per = 4.87  per(accum) = 11
 T(global opt: rmmtasks init                ) = 1.544e-02 S  per =  5.3  per(accum) = 16.3
 T(global opt: qops memset on cpu           ) = 6.530e-07 S  per = 0.000224  per(accum) = 16.3
 T(global opt: preprocess_renorm_batchGPU   ) = 2.285e-02 S  per = 7.84  per(accum) = 24.1
 T(global opt: deallocate cpu and gpu memory) = 2.300e-03 S  per = 0.789  per(accum) = 24.9
 T(global opt: construct opS [ifdists=true] ) = 1.995e-01 S  per = 68.4  per(accum) = 93.3
 T(global opt: reduction of opS & opH [nccl]) = 2.935e-04 S  per = 0.101  per(accum) = 93.4
 T(global opt: qops memcpy gpu2cpu          ) = 1.849e-03 S  per = 0.634  per(accum) = 94.1
 T(global opt: reduction of opS & opH [mpi] ) = 3.634e-04 S  per = 0.125  per(accum) = 94.2
 T(global opt: qops_pool join and erase     ) = 1.007e-02 S  per = 3.45  per(accum) = 97.7
 T(global opt: conversion from opAB to opPQ ) = 6.826e-03 S  per = 2.34  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.233e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=14/seqsize=34 dots=1 dbond=(15,0)-(16,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=3 scratch=./scratch/sweep size=131:9.76e-07GB T(load)=3.15e-04S speed=3.10e-03GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=595:4.54e-03MB:4.43e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=464:3.54e-03MB:3.46e-06GB
total mem of comb=1207:9.21e-03MB:8.99e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=2.876e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=15,4,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 12 13 14 15
 suppc= 11
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:30 S:5 H:1 P:22 Q:28 
        dim(bra,ket)=42,42 size(op)=270:2.060e-03MB size(tot)=13084:9.982e-02MB:9.748e-05GB
        per(mem): C:38.5 S:5.2 H:2.06 P:14.9 Q:39.3 
 rqops: oplist=CSHAB nops=C:8 S:16 H:1 A:14 B:18 
        dim(bra,ket)=24,24 size(op)=104:0.000793MB size(tot)=2908:0.0222MB:2.17e-05GB
        per(mem): C:16 S:24.8 H:3.58 A:14.2 B:41.5 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=18328:0.14MB:0.000137GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.639e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(15,0) fdel=./scratch/sweep/rop(16,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-2.253e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(42,24,4) nnz=464:3.540e-03MB
qtensor3: wf3 own=1 _data=0x55b2c5b3f000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=8 dimAll=42
 (23,3):8 (22,2):8 (24,2):8 (23,1):6 (25,3):4 (24,4):4 (21,1):3 (25,1):1
 qbond: qcol nsym=7 dimAll=24
 (6,-2):6 (4,-2):5 (5,-1):4 (5,-3):4 (7,-1):3 (3,-3):1 (4,-4):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=20 nblocks=224 size=464:3.540e-03MB
### DIAG TIMING: total=4.239e-04 t1=1.454e-05, t2=2.078e-05, t3=1.457e-05, t4=3.187e-04, t5=1.009e-05, t6=3.736e-05, t7=7.844e-06
duration_diagGPU:4.320e-04
duration_diagreduce:4.600e-08
duration_diagtransform:5.450e-07
----- TIMING FOR symbolic_formulae_onedot with size=219 : 4.857e-04 S -----
rank=0 GPUmem(GB): used=1.366e-04 (oper)=1.366e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=219
 no. of hintermediate operators=94
 no. of coefficients=1410:1.076e-02MB:1.051e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.843e-05 S -----
rank=0 GPUmem(GB): used=1.471e-04 (oper,hinter)=1.366e-04,1.051e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.408e-04 S size(H_formulae)=219 size(Hxlst2)=20 T(Hmu/Hxlist)=8.978e-05,5.509e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 8.585e-04 S size(H_formulae)=219 size(Hxlst)=2822 -----
rank=0 GPUmem(GB): used=1.471e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=6.914e-06 batch[need]=3.385e-03 blksize=48 blksize0=64 batchsize=2822
rank=0 GPUmem(GB): used=3.539e-03 (oper,hinter,dvdson,batch)=1.366e-04,1.051e-05,6.914e-06,3.385e-03
ctns::pdvdsonSolver_nkr::solve_iter ndim=464 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.761e-05,9.366e-05,1.055e-03,2.197e-04,1.453e-03
 analyze_tgpu[Hx]: ndim=464:3.457e-06GB T(cpu-gpu)=2.149e-05 speed=3.218e-01GB/S T(nccl)=5.613e-05 speed=1.232e-01GB/S
----- TIMING FOR sigma : t_inter=9.4e-05 t_gemm=1.1e-03 t_reduction=2.2e-04 tot=1.4e-03 -----
 sigma[inter] counter=108 t=9.4e-05 per=6.8e+00 cost=1.0e+06 flops=1.1e+10
 sigma[gemm] counter=108 i=0 t=1.8e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=1 t=1.6e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=108 i=2 t=2.5e-04 per=1.8e+01 cost=2.8e+05 flops=1.1e+09
 sigma[gemm] counter=108 i=3 t=2.9e-04 per=2.1e+01 cost=2.8e+05 flops=9.6e+08
 sigma[gemm] counter=108 i=4 t=2.5e-04 per=1.8e+01 cost=3.6e+05 flops=1.4e+09
 sigma[gemm] counter=108 i=5 t=2.6e-04 per=1.9e+01 cost=3.5e+05 flops=1.3e+09
 sigma[gemm] counter=108 total t=1.1e-03 per=7.7e+01 cost=1.3e+06 flops=1.2e+09
 sigma[red] counter=108 t=2.2e-04 per=1.6e+01 cost=1.4e+05 flops=6.4e+08
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=2.8e-01 t_reduction=3.6e-02 tot=3.3e-01 -----
 sigma_tot[inter] counter=108 t=1.5e-02 per=4.6e+00 cost=5.2e+08 flops=3.4e+10
 sigma_tot[gemm] counter=108 i=0 t=2.4e-04 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=1 t=2.2e-04 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=108 i=2 t=6.7e-02 per=2.0e+01 cost=4.6e+08 flops=6.9e+09
 sigma_tot[gemm] counter=108 i=3 t=8.5e-02 per=2.6e+01 cost=4.6e+08 flops=5.4e+09
 sigma_tot[gemm] counter=108 i=4 t=6.2e-02 per=1.9e+01 cost=3.8e+08 flops=6.2e+09
 sigma_tot[gemm] counter=108 i=5 t=6.3e-02 per=1.9e+01 cost=3.9e+08 flops=6.3e+09
 sigma_tot[gemm] counter=108 total t=2.8e-01 per=8.4e+01 cost=1.7e+09 flops=6.1e+09
 sigma_tot[red] counter=108 t=3.6e-02 per=1.1e+01 cost=1.1e+08 flops=3.0e+09
T(sub)=8.7e-06 T(gemm/eig/ortho/gemm/axpy)=3.4e-06,2.9e-06,9.7e-07,1.3e-06,2.8e-07
settings: ndim=464 neig=1 maxcycle=30 nbuff=4 memory=5e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.536936803243 -1.117e+03  4.290e-02    1     1  1.537e-03 1.537e-03 1.518e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.603e-05,8.377e-05,1.349e-03,2.629e-04,1.766e-03
 analyze_tgpu[Hx]: ndim=464:3.457e-06GB T(cpu-gpu)=2.160e-05 speed=3.201e-01GB/S T(nccl)=4.443e-05 speed=1.556e-01GB/S
----- TIMING FOR sigma : t_inter=8.4e-05 t_gemm=1.3e-03 t_reduction=2.6e-04 tot=1.7e-03 -----
 sigma[inter] counter=109 t=8.4e-05 per=4.9e+00 cost=1.0e+06 flops=1.3e+10
 sigma[gemm] counter=109 i=0 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=1 t=1.8e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=109 i=2 t=2.9e-04 per=1.7e+01 cost=2.8e+05 flops=9.6e+08
 sigma[gemm] counter=109 i=3 t=3.9e-04 per=2.3e+01 cost=2.8e+05 flops=7.1e+08
 sigma[gemm] counter=109 i=4 t=3.1e-04 per=1.9e+01 cost=3.6e+05 flops=1.1e+09
 sigma[gemm] counter=109 i=5 t=3.5e-04 per=2.0e+01 cost=3.5e+05 flops=1.0e+09
 sigma[gemm] counter=109 total t=1.3e-03 per=8.0e+01 cost=1.3e+06 flops=9.4e+08
 sigma[red] counter=109 t=2.6e-04 per=1.5e+01 cost=1.4e+05 flops=5.4e+08
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=2.8e-01 t_reduction=3.7e-02 tot=3.3e-01 -----
 sigma_tot[inter] counter=109 t=1.5e-02 per=4.6e+00 cost=5.2e+08 flops=3.4e+10
 sigma_tot[gemm] counter=109 i=0 t=2.4e-04 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=1 t=2.2e-04 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=109 i=2 t=6.8e-02 per=2.0e+01 cost=4.6e+08 flops=6.9e+09
 sigma_tot[gemm] counter=109 i=3 t=8.5e-02 per=2.6e+01 cost=4.6e+08 flops=5.4e+09
 sigma_tot[gemm] counter=109 i=4 t=6.2e-02 per=1.9e+01 cost=3.9e+08 flops=6.2e+09
 sigma_tot[gemm] counter=109 i=5 t=6.3e-02 per=1.9e+01 cost=3.9e+08 flops=6.2e+09
 sigma_tot[gemm] counter=109 total t=2.8e-01 per=8.4e+01 cost=1.7e+09 flops=6.1e+09
 sigma_tot[red] counter=109 t=3.7e-02 per=1.1e+01 cost=1.1e+08 flops=3.0e+09
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=7.8e-06,1.0e-05,2.9e-06,1.9e-06,3.0e-07
    2   0 -    -116.539032428493 -2.096e-03  1.232e-02    2     2  3.449e-03 1.724e-03 1.684e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.789e-05,8.539e-05,1.311e-03,2.410e-04,1.710e-03
 analyze_tgpu[Hx]: ndim=464:3.457e-06GB T(cpu-gpu)=2.160e-05 speed=3.201e-01GB/S T(nccl)=4.629e-05 speed=1.494e-01GB/S
----- TIMING FOR sigma : t_inter=8.5e-05 t_gemm=1.3e-03 t_reduction=2.4e-04 tot=1.6e-03 -----
 sigma[inter] counter=110 t=8.5e-05 per=5.2e+00 cost=1.0e+06 flops=1.2e+10
 sigma[gemm] counter=110 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=1 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=110 i=2 t=3.0e-04 per=1.8e+01 cost=2.8e+05 flops=9.6e+08
 sigma[gemm] counter=110 i=3 t=3.8e-04 per=2.3e+01 cost=2.8e+05 flops=7.2e+08
 sigma[gemm] counter=110 i=4 t=3.1e-04 per=1.9e+01 cost=3.6e+05 flops=1.2e+09
 sigma[gemm] counter=110 i=5 t=3.2e-04 per=1.9e+01 cost=3.5e+05 flops=1.1e+09
 sigma[gemm] counter=110 total t=1.3e-03 per=8.0e+01 cost=1.3e+06 flops=9.7e+08
 sigma[red] counter=110 t=2.4e-04 per=1.5e+01 cost=1.4e+05 flops=5.9e+08
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=2.8e-01 t_reduction=3.7e-02 tot=3.3e-01 -----
 sigma_tot[inter] counter=110 t=1.5e-02 per=4.6e+00 cost=5.2e+08 flops=3.4e+10
 sigma_tot[gemm] counter=110 i=0 t=2.4e-04 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=1 t=2.2e-04 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=110 i=2 t=6.8e-02 per=2.0e+01 cost=4.6e+08 flops=6.8e+09
 sigma_tot[gemm] counter=110 i=3 t=8.5e-02 per=2.6e+01 cost=4.6e+08 flops=5.4e+09
 sigma_tot[gemm] counter=110 i=4 t=6.2e-02 per=1.9e+01 cost=3.9e+08 flops=6.2e+09
 sigma_tot[gemm] counter=110 i=5 t=6.4e-02 per=1.9e+01 cost=3.9e+08 flops=6.2e+09
 sigma_tot[gemm] counter=110 total t=2.8e-01 per=8.4e+01 cost=1.7e+09 flops=6.1e+09
 sigma_tot[red] counter=110 t=3.7e-02 per=1.1e+01 cost=1.1e+08 flops=3.0e+09
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=6.9e-06,1.3e-05,2.2e-06,2.4e-06,2.9e-07
    3   0 -    -116.539285680072 -2.533e-04  5.039e-03    3     3  5.553e-03 1.851e-03 1.809e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.608e-05,8.704e-05,1.307e-03,2.489e-04,1.713e-03
 analyze_tgpu[Hx]: ndim=464:3.457e-06GB T(cpu-gpu)=2.192e-05 speed=3.155e-01GB/S T(nccl)=4.416e-05 speed=1.566e-01GB/S
----- TIMING FOR sigma : t_inter=8.7e-05 t_gemm=1.3e-03 t_reduction=2.5e-04 tot=1.6e-03 -----
 sigma[inter] counter=111 t=8.7e-05 per=5.3e+00 cost=1.0e+06 flops=1.2e+10
 sigma[gemm] counter=111 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=111 i=2 t=2.9e-04 per=1.8e+01 cost=2.8e+05 flops=9.6e+08
 sigma[gemm] counter=111 i=3 t=3.8e-04 per=2.3e+01 cost=2.8e+05 flops=7.3e+08
 sigma[gemm] counter=111 i=4 t=3.1e-04 per=1.9e+01 cost=3.6e+05 flops=1.2e+09
 sigma[gemm] counter=111 i=5 t=3.2e-04 per=1.9e+01 cost=3.5e+05 flops=1.1e+09
 sigma[gemm] counter=111 total t=1.3e-03 per=8.0e+01 cost=1.3e+06 flops=9.7e+08
 sigma[red] counter=111 t=2.5e-04 per=1.5e+01 cost=1.4e+05 flops=5.7e+08
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=2.8e-01 t_reduction=3.7e-02 tot=3.3e-01 -----
 sigma_tot[inter] counter=111 t=1.5e-02 per=4.6e+00 cost=5.2e+08 flops=3.4e+10
 sigma_tot[gemm] counter=111 i=0 t=2.4e-04 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=1 t=2.3e-04 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=111 i=2 t=6.8e-02 per=2.0e+01 cost=4.6e+08 flops=6.8e+09
 sigma_tot[gemm] counter=111 i=3 t=8.6e-02 per=2.6e+01 cost=4.6e+08 flops=5.4e+09
 sigma_tot[gemm] counter=111 i=4 t=6.3e-02 per=1.9e+01 cost=3.9e+08 flops=6.1e+09
 sigma_tot[gemm] counter=111 i=5 t=6.4e-02 per=1.9e+01 cost=3.9e+08 flops=6.2e+09
 sigma_tot[gemm] counter=111 total t=2.8e-01 per=8.4e+01 cost=1.7e+09 flops=6.1e+09
 sigma_tot[red] counter=111 t=3.7e-02 per=1.1e+01 cost=1.1e+08 flops=3.0e+09
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=6.4e-06,1.2e-05,2.0e-06,2.3e-06,2.7e-07
    4   0 -    -116.539333934466 -4.825e-05  2.161e-03    3     4  7.397e-03 1.849e-03 1.806e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.376e-05,8.366e-05,1.307e-03,2.416e-04,1.700e-03
 analyze_tgpu[Hx]: ndim=464:3.457e-06GB T(cpu-gpu)=2.123e-05 speed=3.258e-01GB/S T(nccl)=4.254e-05 speed=1.625e-01GB/S
----- TIMING FOR sigma : t_inter=8.4e-05 t_gemm=1.3e-03 t_reduction=2.4e-04 tot=1.6e-03 -----
 sigma[inter] counter=112 t=8.4e-05 per=5.1e+00 cost=1.0e+06 flops=1.3e+10
 sigma[gemm] counter=112 i=0 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=1 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=112 i=2 t=2.9e-04 per=1.8e+01 cost=2.8e+05 flops=9.6e+08
 sigma[gemm] counter=112 i=3 t=3.8e-04 per=2.3e+01 cost=2.8e+05 flops=7.3e+08
 sigma[gemm] counter=112 i=4 t=3.1e-04 per=1.9e+01 cost=3.6e+05 flops=1.2e+09
 sigma[gemm] counter=112 i=5 t=3.2e-04 per=1.9e+01 cost=3.5e+05 flops=1.1e+09
 sigma[gemm] counter=112 total t=1.3e-03 per=8.0e+01 cost=1.3e+06 flops=9.7e+08
 sigma[red] counter=112 t=2.4e-04 per=1.5e+01 cost=1.4e+05 flops=5.9e+08
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=2.8e-01 t_reduction=3.7e-02 tot=3.4e-01 -----
 sigma_tot[inter] counter=112 t=1.5e-02 per=4.6e+00 cost=5.2e+08 flops=3.4e+10
 sigma_tot[gemm] counter=112 i=0 t=2.4e-04 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=1 t=2.3e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=112 i=2 t=6.8e-02 per=2.0e+01 cost=4.6e+08 flops=6.8e+09
 sigma_tot[gemm] counter=112 i=3 t=8.6e-02 per=2.6e+01 cost=4.6e+08 flops=5.3e+09
 sigma_tot[gemm] counter=112 i=4 t=6.3e-02 per=1.9e+01 cost=3.9e+08 flops=6.1e+09
 sigma_tot[gemm] counter=112 i=5 t=6.4e-02 per=1.9e+01 cost=3.9e+08 flops=6.1e+09
 sigma_tot[gemm] counter=112 total t=2.8e-01 per=8.4e+01 cost=1.7e+09 flops=6.0e+09
 sigma_tot[red] counter=112 t=3.7e-02 per=1.1e+01 cost=1.1e+08 flops=3.0e+09
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=6.8e-06,1.2e-05,2.1e-06,2.3e-06,2.8e-07
    5   0 -    -116.539343390333 -9.456e-06  8.305e-04    3     5  9.232e-03 1.846e-03 1.802e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.325e-05,8.126e-05,1.304e-03,2.406e-04,1.692e-03
 analyze_tgpu[Hx]: ndim=464:3.457e-06GB T(cpu-gpu)=2.080e-05 speed=3.325e-01GB/S T(nccl)=4.245e-05 speed=1.629e-01GB/S
----- TIMING FOR sigma : t_inter=8.1e-05 t_gemm=1.3e-03 t_reduction=2.4e-04 tot=1.6e-03 -----
 sigma[inter] counter=113 t=8.1e-05 per=5.0e+00 cost=1.0e+06 flops=1.3e+10
 sigma[gemm] counter=113 i=0 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=113 i=2 t=2.9e-04 per=1.8e+01 cost=2.8e+05 flops=9.7e+08
 sigma[gemm] counter=113 i=3 t=3.7e-04 per=2.3e+01 cost=2.8e+05 flops=7.4e+08
 sigma[gemm] counter=113 i=4 t=3.2e-04 per=2.0e+01 cost=3.6e+05 flops=1.1e+09
 sigma[gemm] counter=113 i=5 t=3.2e-04 per=1.9e+01 cost=3.5e+05 flops=1.1e+09
 sigma[gemm] counter=113 total t=1.3e-03 per=8.0e+01 cost=1.3e+06 flops=9.8e+08
 sigma[red] counter=113 t=2.4e-04 per=1.5e+01 cost=1.4e+05 flops=5.9e+08
----- TIMING FOR sigma_tot : t_inter=1.5e-02 t_gemm=2.8e-01 t_reduction=3.8e-02 tot=3.4e-01 -----
 sigma_tot[inter] counter=113 t=1.5e-02 per=4.6e+00 cost=5.2e+08 flops=3.4e+10
 sigma_tot[gemm] counter=113 i=0 t=2.5e-04 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=1 t=2.3e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=113 i=2 t=6.9e-02 per=2.0e+01 cost=4.7e+08 flops=6.8e+09
 sigma_tot[gemm] counter=113 i=3 t=8.6e-02 per=2.6e+01 cost=4.6e+08 flops=5.3e+09
 sigma_tot[gemm] counter=113 i=4 t=6.3e-02 per=1.9e+01 cost=3.9e+08 flops=6.1e+09
 sigma_tot[gemm] counter=113 i=5 t=6.4e-02 per=1.9e+01 cost=3.9e+08 flops=6.1e+09
 sigma_tot[gemm] counter=113 total t=2.8e-01 per=8.4e+01 cost=1.7e+09 flops=6.0e+09
 sigma_tot[red] counter=113 t=3.8e-02 per=1.1e+01 cost=1.1e+08 flops=3.0e+09
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=6.6e-06,1.2e-05,1.9e-06,6.6e-06,3.0e-07
    6   0 -    -116.539344612303 -1.222e-06  3.005e-04    3     6  1.117e-02 1.862e-03 1.816e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.409e-05,8.862e-05,1.382e-03,2.409e-04,1.780e-03
 analyze_tgpu[Hx]: ndim=464:3.457e-06GB T(cpu-gpu)=2.090e-05 speed=3.309e-01GB/S T(nccl)=4.320e-05 speed=1.601e-01GB/S
----- TIMING FOR sigma : t_inter=8.9e-05 t_gemm=1.4e-03 t_reduction=2.4e-04 tot=1.7e-03 -----
 sigma[inter] counter=114 t=8.9e-05 per=5.2e+00 cost=1.0e+06 flops=1.2e+10
 sigma[gemm] counter=114 i=0 t=2.1e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=1 t=2.1e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=114 i=2 t=3.2e-04 per=1.9e+01 cost=2.8e+05 flops=8.8e+08
 sigma[gemm] counter=114 i=3 t=4.1e-04 per=2.4e+01 cost=2.8e+05 flops=6.7e+08
 sigma[gemm] counter=114 i=4 t=3.3e-04 per=1.9e+01 cost=3.6e+05 flops=1.1e+09
 sigma[gemm] counter=114 i=5 t=3.2e-04 per=1.9e+01 cost=3.5e+05 flops=1.1e+09
 sigma[gemm] counter=114 total t=1.4e-03 per=8.1e+01 cost=1.3e+06 flops=9.2e+08
 sigma[red] counter=114 t=2.4e-04 per=1.4e+01 cost=1.4e+05 flops=5.9e+08
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=2.9e-01 t_reduction=3.8e-02 tot=3.4e-01 -----
 sigma_tot[inter] counter=114 t=1.6e-02 per=4.6e+00 cost=5.2e+08 flops=3.3e+10
 sigma_tot[gemm] counter=114 i=0 t=2.5e-04 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=1 t=2.3e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=114 i=2 t=6.9e-02 per=2.0e+01 cost=4.7e+08 flops=6.7e+09
 sigma_tot[gemm] counter=114 i=3 t=8.7e-02 per=2.6e+01 cost=4.6e+08 flops=5.3e+09
 sigma_tot[gemm] counter=114 i=4 t=6.4e-02 per=1.9e+01 cost=3.9e+08 flops=6.1e+09
 sigma_tot[gemm] counter=114 i=5 t=6.5e-02 per=1.9e+01 cost=4.0e+08 flops=6.1e+09
 sigma_tot[gemm] counter=114 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=6.0e+09
 sigma_tot[red] counter=114 t=3.8e-02 per=1.1e+01 cost=1.1e+08 flops=2.9e+09
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=6.5e-06,1.2e-05,1.9e-06,2.3e-06,3.0e-07
    7   0 -    -116.539344781104 -1.688e-07  1.341e-04    3     7  1.324e-02 1.891e-03 1.845e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.326e-05,8.287e-05,1.302e-03,2.423e-04,1.695e-03
 analyze_tgpu[Hx]: ndim=464:3.457e-06GB T(cpu-gpu)=2.090e-05 speed=3.309e-01GB/S T(nccl)=4.237e-05 speed=1.632e-01GB/S
----- TIMING FOR sigma : t_inter=8.3e-05 t_gemm=1.3e-03 t_reduction=2.4e-04 tot=1.6e-03 -----
 sigma[inter] counter=115 t=8.3e-05 per=5.1e+00 cost=1.0e+06 flops=1.3e+10
 sigma[gemm] counter=115 i=0 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=1 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=115 i=2 t=2.9e-04 per=1.8e+01 cost=2.8e+05 flops=9.6e+08
 sigma[gemm] counter=115 i=3 t=3.7e-04 per=2.3e+01 cost=2.8e+05 flops=7.5e+08
 sigma[gemm] counter=115 i=4 t=3.2e-04 per=1.9e+01 cost=3.6e+05 flops=1.1e+09
 sigma[gemm] counter=115 i=5 t=3.2e-04 per=2.0e+01 cost=3.5e+05 flops=1.1e+09
 sigma[gemm] counter=115 total t=1.3e-03 per=8.0e+01 cost=1.3e+06 flops=9.8e+08
 sigma[red] counter=115 t=2.4e-04 per=1.5e+01 cost=1.4e+05 flops=5.8e+08
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=2.9e-01 t_reduction=3.8e-02 tot=3.4e-01 -----
 sigma_tot[inter] counter=115 t=1.6e-02 per=4.6e+00 cost=5.2e+08 flops=3.3e+10
 sigma_tot[gemm] counter=115 i=0 t=2.5e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=1 t=2.3e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=115 i=2 t=6.9e-02 per=2.0e+01 cost=4.7e+08 flops=6.7e+09
 sigma_tot[gemm] counter=115 i=3 t=8.7e-02 per=2.6e+01 cost=4.6e+08 flops=5.3e+09
 sigma_tot[gemm] counter=115 i=4 t=6.4e-02 per=1.9e+01 cost=3.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=115 i=5 t=6.5e-02 per=1.9e+01 cost=4.0e+08 flops=6.1e+09
 sigma_tot[gemm] counter=115 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=6.0e+09
 sigma_tot[red] counter=115 t=3.8e-02 per=1.1e+01 cost=1.1e+08 flops=2.9e+09
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=6.2e-06,1.1e-05,1.9e-06,2.1e-06,2.8e-07
    8   0 +    -116.539344816793 -3.569e-08  6.451e-05    3     8  1.506e-02 1.883e-03 1.837e-03
TIMING FOR Davidson : 1.507e-02  T(cal/comm/rest)=1.469e-02,1.645e-06,3.758e-04
decomposed t_rest=3.758e-04
 T(sub)    =1.741e-04 per=4.633e+01
 T(precond)=2.505e-05 per=6.665e+00
 T(ortho)  =1.725e-05 per=4.589e+00
 T(xcopy)  =1.486e-06 per=3.954e-01
 T(xnrm2)  =2.542e-06 per=6.764e-01
 T(other)  =1.554e-04 per=4.134e+01
optimized energies: isweep=0 ibond=14 dots=1 e[0]=-116.539344816793 nmvp=8
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=8.138e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=16 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond14.txt
 qbond: qsuper nsym=16 dimAll=168
 (23,3):16 (25,3):24 (24,4):12 (24,2):30 (22,2):11 (23,1):17 (26,2):13 (25,1):15 (24,0):6 (27,3):4 (26,4):8 (25,5):4 (21,1):3 (22,0):3 (27,1):1 (26,0):1
timing for divide=2.5e-06
timing for compute=7.1e-05
timing for collect=4.8e-06
----- TMING FOR decimation_genbasis(nkr): 7.9e-05 S T(divide/compute[cpu/gpu/rest]/collect)=2.5e-06,6.9e-05,0.0e+00,2.2e-06,4.8e-06 -----
decimation summary: 168->24 dwt=+0.000e+00 SvN=1.397e+00
 qbond: qkept nsym=7 dimAll=24
 (24,2):6 (26,2):5 (25,3):4 (25,1):4 (23,1):3 (27,3):1 (26,4):1
----- TIMING for decimation_row(nkr): 1.020e-03 S T(decim/select/formRot)=1.054e-04,9.030e-04,1.168e-05 -----
----- TIMING FOR onedot_decimation: 1.088e-03 S T(wf/decim)=6.161e-05,1.027e-03 -----
ctns::oper_renorm coord=(15,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:32 S:4 H:1 P:14 Q:18 
        dim(bra,ket)=24,24 size(op)=104:7.935e-04MB size(tot)=3760:2.869e-02MB:2.801e-05GB
        per(mem): C:49.4 S:4.79 H:2.77 P:11 Q:32.1 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=7.567e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=65 : 5.352e-04 S -----
rank=0 GPUmem(GB): used=1.534e-04 (oper)=1.429e-04
rank=0 GPUmem(GB): used=1.569e-04 (oper,site)=1.429e-04,3.457e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=65
 no. of rintermediate operators=78
 no. of coefficients=1170:8.926e-03MB:8.717e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.870e-05 S -----
rank=0 GPUmem(GB): used=1.656e-04 (oper,site,rinter)=1.429e-04,3.457e-06,8.717e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 4.572e-04 S size(rtasks)=65 size(Rlst2)=49 T(Rmu/Rlist)=8.976e-05,3.674e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.128e-04 S size(rtasks)=65 size(Rlst)=1587 -----
rank=0 GPUmem(GB): used=1.656e-04 avail=3.829e+01 total=3.829e+01 batch[need]=1.904e-03 blksize=48 blksize0=64 batchsize=1587
rank=0 GPUmem(GB): used=2.069e-03 (oper,site,rinter,batch)=1.429e-04,3.457e-06,8.717e-06,1.904e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.165e-04,8.024e-04,2.332e-04
----- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=8.0e-04 t_reduction=2.3e-04 tot=1.2e-03 -----
 renorm[inter] counter=337 t=1.2e-04 per=1.0e+01 cost=4.6e+05 flops=4.0e+09
 renorm[gemm] counter=337 i=0 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=337 i=1 t=1.8e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=337 i=2 t=1.9e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=337 i=3 t=1.9e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=337 i=4 t=2.3e-04 per=2.0e+01 cost=1.3e+05 flops=5.7e+08
 renorm[gemm] counter=337 i=5 t=3.0e-04 per=2.6e+01 cost=2.9e+05 flops=9.8e+08
 renorm[gemm] counter=337 i=6 t=2.7e-04 per=2.3e+01 cost=3.6e+05 flops=1.4e+09
 renorm[gemm] counter=337 total t=8.0e-04 per=7.0e+01 cost=7.8e+05 flops=9.8e+08
 renorm[red] counter=337 t=2.3e-04 per=2.0e+01 cost=5.7e+04 flops=2.5e+08
----- TIMING FOR renorm_tot : t_inter=2.0e-03 t_gemm=1.6e-02 t_reduction=4.0e-03 tot=2.2e-02 -----
 renorm_tot[inter] counter=337 t=2.0e-03 per=9.0e+00 cost=1.6e+07 flops=8.2e+09
 renorm_tot[gemm] counter=337 i=0 t=3.2e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=337 i=1 t=2.8e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=337 i=2 t=2.8e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=337 i=3 t=2.7e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=337 i=4 t=4.2e-03 per=1.9e+01 cost=9.9e+06 flops=2.3e+09
 renorm_tot[gemm] counter=337 i=5 t=6.1e-03 per=2.7e+01 cost=2.4e+07 flops=3.9e+09
 renorm_tot[gemm] counter=337 i=6 t=5.7e-03 per=2.6e+01 cost=4.5e+07 flops=7.8e+09
 renorm_tot[gemm] counter=337 total t=1.6e-02 per=7.3e+01 cost=7.8e+07 flops=4.9e+09
 renorm_tot[red] counter=337 t=4.0e-03 per=1.8e+01 cost=5.3e+06 flops=1.3e+09
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.644e-04 (oper)=1.434e-04
rank=0 GPUmem(GB): used=1.679e-04 (oper,site,rinter)=1.434e-04,3.457e-06,1.788e-06
rank=0 GPUmem(GB): used=2.035e-04 (oper,site,rinter,batch)=1.434e-04,3.457e-06,1.788e-06,3.565e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.063e-03 S T(preprocess/alloc/comp/red/dealloc)=3.896e-04,4.254e-04,2.147e-03,1.419e-03,5.648e-05 -----
----- TIMING FOR oper_renorm_opS : 4.091e-03 S rank=0 -----
qops.to_cpu: size(tot)=3760:2.869e-02MB:2.801e-05GB T(to_cpu)=3.502e-05S speed=8.000e-01GB/S
check ||H-H.dagger||=3.674e-14 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.00797 S rank=0 -----
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=5.153e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=1.625e-03 change=-1.633e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=1.625e-03 change=-5.424e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 3.270e-02 S #####
 T(local opt: fetch) = 2.739e-03 S  per = 8.38  per(accum) = 8.38
 T(local opt: hdiag) = 4.565e-04 S  per =  1.4  per(accum) = 9.77
 T(local opt: dvdsn) = 1.796e-02 S  per = 54.9  per(accum) = 64.7
 T(local opt: decim) = 1.114e-03 S  per = 3.41  per(accum) = 68.1
 T(local opt: guess) = 3.484e-05 S  per = 0.107  per(accum) = 68.2
 T(local opt: renrm) = 8.562e-03 S  per = 26.2  per(accum) = 94.4
 T(local opt: save ) = 1.837e-03 S  per = 5.62  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.796e-02 S  T(sum) = 1.749e-02 S  per = 9.739e+01
 T(local opt: preprocess                  ) = 4.869e-05 S  per = 0.278  per(accum) = 0.278
 T(local opt: symbolic_formulae           ) = 4.905e-04 S  per =  2.8  per(accum) = 3.08
 T(local opt: hintermediate init          ) = 3.603e-05 S  per = 0.206  per(accum) = 3.29
 T(local opt: preprocess_hformulae_Hxlist ) = 8.684e-04 S  per = 4.96  per(accum) = 8.25
 T(local opt: hmmtasks init               ) = 9.744e-04 S  per = 5.57  per(accum) = 13.8
 T(local opt: initial guess for dvdson    ) = 3.283e-06 S  per = 0.0188  per(accum) = 13.8
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.416e-02 S  per =   81  per(accum) = 94.8
 T(local opt: dvdson [cpu-gpu]            ) = 1.704e-04 S  per = 0.974  per(accum) = 95.8
 T(local opt: dvdson [nccl]               ) = 3.616e-04 S  per = 2.07  per(accum) = 97.8
 T(local opt: dvdson [mpi]                ) = 1.645e-06 S  per = 0.0094  per(accum) = 97.9
 T(local opt: dvdson [rest part(linalg)]  ) = 3.758e-04 S  per = 2.15  per(accum) = 100
Detailed decomposition of T(renrm) = 8.562e-03 S  T(sum) = 8.562e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.776e-05 S  per = 0.441  per(accum) = 0.441
 T(local opt: qops init                    ) = 2.798e-04 S  per = 3.27  per(accum) = 3.71
 T(local opt: symbolic_formulae_renorm     ) = 5.407e-04 S  per = 6.31  per(accum) = 10
 T(local opt: allocate qops on gpu         ) = 5.074e-05 S  per = 0.593  per(accum) = 10.6
 T(local opt: site memcpy cpu2gpu          ) = 1.745e-05 S  per = 0.204  per(accum) = 10.8
 T(local opt: rintermediate init           ) = 3.515e-05 S  per = 0.41  per(accum) = 11.2
 T(local opt: preprocess_formulae_Rlist2   ) = 6.211e-04 S  per = 7.25  per(accum) = 18.5
 T(local opt: rmmtasks init                ) = 8.028e-04 S  per = 9.38  per(accum) = 27.9
 T(local opt: qops memset on cpu           ) = 3.000e-08 S  per = 0.00035  per(accum) = 27.9
 T(local opt: preprocess_renorm_batchGPU   ) = 1.239e-03 S  per = 14.5  per(accum) = 42.3
 T(local opt: deallocate cpu and gpu memory) = 1.716e-04 S  per =    2  per(accum) = 44.3
 T(local opt: construct opS [ifdists=true] ) = 4.102e-03 S  per = 47.9  per(accum) = 92.2
 T(local opt: reduction of opS & opH [nccl]) = 1.806e-05 S  per = 0.211  per(accum) = 92.5
 T(local opt: qops memcpy gpu2cpu          ) = 4.546e-05 S  per = 0.531  per(accum) = 93
 T(local opt: reduction of opS & opH [mpi] ) = 4.807e-05 S  per = 0.561  per(accum) = 93.5
 T(local opt: qops_pool join and erase     ) = 5.517e-04 S  per = 6.44  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.810e-07 S  per = 0.00912  per(accum) = 100
ctns::rcanon_save_site idx=4 scratch=./scratch/sweep size=464:3.5e-06GB T(load)=0.00056S speed=0.0062GB/S
##### sweep opt: 9.158e-01 S #####
 T(sweep opt: fetch) = 5.131e-02 S  per =  5.6  per(accum) = 5.6
 T(sweep opt: hdiag) = 1.417e-02 S  per = 1.55  per(accum) = 7.15
 T(sweep opt: dvdsn) = 4.997e-01 S  per = 54.6  per(accum) = 61.7
 T(sweep opt: decim) = 1.836e-02 S  per =    2  per(accum) = 63.7
 T(sweep opt: guess) = 8.757e-04 S  per = 0.0956  per(accum) = 63.8
 T(sweep opt: renrm) = 3.001e-01 S  per = 32.8  per(accum) = 96.6
 T(sweep opt: save ) = 3.128e-02 S  per = 3.42  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.997e-01 S  T(sum) = 4.910e-01 S  per = 9.826e+01
 T(sweep opt: preprocess                  ) = 1.126e-03 S  per = 0.229  per(accum) = 0.229
 T(sweep opt: symbolic_formulae           ) = 1.384e-02 S  per = 2.82  per(accum) = 3.05
 T(sweep opt: hintermediate init          ) = 9.042e-04 S  per = 0.184  per(accum) = 3.23
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.830e-02 S  per = 9.84  per(accum) = 13.1
 T(sweep opt: hmmtasks init               ) = 4.943e-02 S  per = 10.1  per(accum) = 23.1
 T(sweep opt: initial guess for dvdson    ) = 1.011e-04 S  per = 0.0206  per(accum) = 23.2
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.607e-01 S  per = 73.5  per(accum) = 96.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.826e-03 S  per = 0.576  per(accum) = 97.2
 T(sweep opt: dvdson [nccl]               ) = 5.655e-03 S  per = 1.15  per(accum) = 98.3
 T(sweep opt: dvdson [mpi]                ) = 5.007e-05 S  per = 0.0102  per(accum) = 98.4
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.055e-03 S  per = 1.64  per(accum) = 100
Detailed decomposition of T(renrm) = 3.001e-01 S  T(sum) = 3.001e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 7.652e-04 S  per = 0.255  per(accum) = 0.255
 T(sweep opt: qops init                    ) = 7.717e-03 S  per = 2.57  per(accum) = 2.83
 T(sweep opt: symbolic_formulae_renorm     ) = 8.185e-03 S  per = 2.73  per(accum) = 5.55
 T(sweep opt: allocate qops on gpu         ) = 1.045e-03 S  per = 0.348  per(accum) = 5.9
 T(sweep opt: site memcpy cpu2gpu          ) = 3.541e-04 S  per = 0.118  per(accum) = 6.02
 T(sweep opt: rintermediate init           ) = 7.912e-04 S  per = 0.264  per(accum) = 6.28
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.481e-02 S  per = 4.93  per(accum) = 11.2
 T(sweep opt: rmmtasks init                ) = 1.624e-02 S  per = 5.41  per(accum) = 16.6
 T(sweep opt: qops memset on cpu           ) = 6.830e-07 S  per = 0.000228  per(accum) = 16.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.409e-02 S  per = 8.03  per(accum) = 24.7
 T(sweep opt: deallocate cpu and gpu memory) = 2.472e-03 S  per = 0.824  per(accum) = 25.5
 T(sweep opt: construct opS [ifdists=true] ) = 2.036e-01 S  per = 67.8  per(accum) = 93.3
 T(sweep opt: reduction of opS & opH [nccl]) = 3.116e-04 S  per = 0.104  per(accum) = 93.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.894e-03 S  per = 0.631  per(accum) = 94.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.115e-04 S  per = 0.137  per(accum) = 94.2
 T(sweep opt: qops_pool join and erase     ) = 1.062e-02 S  per = 3.54  per(accum) = 97.7
 T(sweep opt: conversion from opAB to opPQ ) = 6.827e-03 S  per = 2.27  per(accum) = 100
##### global opt: 9.158e-01 S #####
 T(global opt: fetch) = 5.131e-02 S  per =  5.6  per(accum) = 5.6
 T(global opt: hdiag) = 1.417e-02 S  per = 1.55  per(accum) = 7.15
 T(global opt: dvdsn) = 4.997e-01 S  per = 54.6  per(accum) = 61.7
 T(global opt: decim) = 1.836e-02 S  per =    2  per(accum) = 63.7
 T(global opt: guess) = 8.757e-04 S  per = 0.0956  per(accum) = 63.8
 T(global opt: renrm) = 3.001e-01 S  per = 32.8  per(accum) = 96.6
 T(global opt: save ) = 3.128e-02 S  per = 3.42  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.997e-01 S  T(sum) = 4.910e-01 S  per = 9.826e+01
 T(global opt: preprocess                  ) = 1.126e-03 S  per = 0.229  per(accum) = 0.229
 T(global opt: symbolic_formulae           ) = 1.384e-02 S  per = 2.82  per(accum) = 3.05
 T(global opt: hintermediate init          ) = 9.042e-04 S  per = 0.184  per(accum) = 3.23
 T(global opt: preprocess_hformulae_Hxlist ) = 4.830e-02 S  per = 9.84  per(accum) = 13.1
 T(global opt: hmmtasks init               ) = 4.943e-02 S  per = 10.1  per(accum) = 23.1
 T(global opt: initial guess for dvdson    ) = 1.011e-04 S  per = 0.0206  per(accum) = 23.2
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.607e-01 S  per = 73.5  per(accum) = 96.6
 T(global opt: dvdson [cpu-gpu]            ) = 2.826e-03 S  per = 0.576  per(accum) = 97.2
 T(global opt: dvdson [nccl]               ) = 5.655e-03 S  per = 1.15  per(accum) = 98.3
 T(global opt: dvdson [mpi]                ) = 5.007e-05 S  per = 0.0102  per(accum) = 98.4
 T(global opt: dvdson [rest part(linalg)]  ) = 8.055e-03 S  per = 1.64  per(accum) = 100
Detailed decomposition of T(renrm) = 3.001e-01 S  T(sum) = 3.001e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 7.652e-04 S  per = 0.255  per(accum) = 0.255
 T(global opt: qops init                    ) = 7.717e-03 S  per = 2.57  per(accum) = 2.83
 T(global opt: symbolic_formulae_renorm     ) = 8.185e-03 S  per = 2.73  per(accum) = 5.55
 T(global opt: allocate qops on gpu         ) = 1.045e-03 S  per = 0.348  per(accum) = 5.9
 T(global opt: site memcpy cpu2gpu          ) = 3.541e-04 S  per = 0.118  per(accum) = 6.02
 T(global opt: rintermediate init           ) = 7.912e-04 S  per = 0.264  per(accum) = 6.28
 T(global opt: preprocess_formulae_Rlist2   ) = 1.481e-02 S  per = 4.93  per(accum) = 11.2
 T(global opt: rmmtasks init                ) = 1.624e-02 S  per = 5.41  per(accum) = 16.6
 T(global opt: qops memset on cpu           ) = 6.830e-07 S  per = 0.000228  per(accum) = 16.6
 T(global opt: preprocess_renorm_batchGPU   ) = 2.409e-02 S  per = 8.03  per(accum) = 24.7
 T(global opt: deallocate cpu and gpu memory) = 2.472e-03 S  per = 0.824  per(accum) = 25.5
 T(global opt: construct opS [ifdists=true] ) = 2.036e-01 S  per = 67.8  per(accum) = 93.3
 T(global opt: reduction of opS & opH [nccl]) = 3.116e-04 S  per = 0.104  per(accum) = 93.4
 T(global opt: qops memcpy gpu2cpu          ) = 1.894e-03 S  per = 0.631  per(accum) = 94.1
 T(global opt: reduction of opS & opH [mpi] ) = 4.115e-04 S  per = 0.137  per(accum) = 94.2
 T(global opt: qops_pool join and erase     ) = 1.062e-02 S  per = 3.54  per(accum) = 97.7
 T(global opt: conversion from opAB to opPQ ) = 6.827e-03 S  per = 2.27  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-8.169e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=15/seqsize=34 dots=1 dbond=(16,0)-(17,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=2 scratch=./scratch/sweep size=26:1.94e-07GB T(load)=3.25e-04S speed=5.96e-04GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=157:1.20e-03MB:1.17e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=131:9.99e-04MB:9.76e-07GB
total mem of comb=436:3.33e-03MB:3.25e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=1.013e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=16,3,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 13 14 15
 suppc= 12
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:32 S:4 H:1 P:14 Q:18 
        dim(bra,ket)=24,24 size(op)=104:7.935e-04MB size(tot)=3760:2.869e-02MB:2.801e-05GB
        per(mem): C:49.4 S:4.79 H:2.77 P:11 Q:32.1 
 rqops: oplist=CSHAB nops=C:6 S:17 H:1 A:7 B:11 
        dim(bra,ket)=10,10 size(op)=24:0.000183MB size(tot)=402:0.00307MB:3e-06GB
        per(mem): C:15.7 S:29.6 H:5.97 A:10.4 B:38.3 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=6498:0.0496MB:4.84e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.133e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(16,0) fdel=./scratch/sweep/rop(17,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-2.742e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(24,10,4) nnz=131:9.995e-04MB
qtensor3: wf3 own=1 _data=0x55b2c61e0480
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=7 dimAll=24
 (24,2):6 (26,2):5 (25,3):4 (25,1):4 (23,1):3 (27,3):1 (26,4):1
 qbond: qcol nsym=5 dimAll=10
 (5,-1):3 (4,-2):3 (3,-1):2 (2,-2):1 (3,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=15 nblocks=140 size=131:9.995e-04MB
### DIAG TIMING: total=2.775e-04 t1=1.595e-05, t2=1.186e-05, t3=1.354e-05, t4=1.840e-04, t5=1.008e-05, t6=3.561e-05, t7=6.404e-06
duration_diagGPU:2.917e-04
duration_diagreduce:3.300e-08
duration_diagtransform:7.350e-07
----- TIMING FOR symbolic_formulae_onedot with size=150 : 3.253e-04 S -----
rank=0 GPUmem(GB): used=4.841e-05 (oper)=4.841e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=150
 no. of hintermediate operators=57
 no. of coefficients=912:6.958e-03MB:6.795e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.814e-05 S -----
rank=0 GPUmem(GB): used=5.521e-05 (oper,hinter)=4.841e-05,6.795e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.372e-04 S size(H_formulae)=150 size(Hxlst2)=15 T(Hmu/Hxlist)=5.813e-05,2.790e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.428e-04 S size(H_formulae)=150 size(Hxlst)=1364 -----
rank=0 GPUmem(GB): used=5.521e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.952e-06 batch[need]=6.199e-04 blksize=18 blksize0=24 batchsize=1364
rank=0 GPUmem(GB): used=6.771e-04 (oper,hinter,dvdson,batch)=4.841e-05,6.795e-06,1.952e-06,6.199e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=131 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.901e-05,8.994e-05,7.492e-04,1.930e-04,1.107e-03
 analyze_tgpu[Hx]: ndim=131:9.760e-07GB T(cpu-gpu)=2.235e-05 speed=8.736e-02GB/S T(nccl)=4.666e-05 speed=4.183e-02GB/S
----- TIMING FOR sigma : t_inter=9.0e-05 t_gemm=7.5e-04 t_reduction=1.9e-04 tot=1.0e-03 -----
 sigma[inter] counter=116 t=9.0e-05 per=8.7e+00 cost=2.2e+05 flops=2.4e+09
 sigma[gemm] counter=116 i=0 t=1.8e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=1 t=1.6e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=116 i=2 t=1.7e-04 per=1.6e+01 cost=2.3e+04 flops=1.4e+08
 sigma[gemm] counter=116 i=3 t=1.8e-04 per=1.7e+01 cost=2.2e+04 flops=1.2e+08
 sigma[gemm] counter=116 i=4 t=2.2e-04 per=2.2e+01 cost=4.4e+04 flops=2.0e+08
 sigma[gemm] counter=116 i=5 t=1.8e-04 per=1.8e+01 cost=4.1e+04 flops=2.3e+08
 sigma[gemm] counter=116 total t=7.5e-04 per=7.3e+01 cost=1.3e+05 flops=1.7e+08
 sigma[red] counter=116 t=1.9e-04 per=1.9e+01 cost=2.4e+04 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=2.9e-01 t_reduction=3.8e-02 tot=3.4e-01 -----
 sigma_tot[inter] counter=116 t=1.6e-02 per=4.6e+00 cost=5.2e+08 flops=3.3e+10
 sigma_tot[gemm] counter=116 i=0 t=2.5e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=1 t=2.3e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=116 i=2 t=7.0e-02 per=2.0e+01 cost=4.7e+08 flops=6.7e+09
 sigma_tot[gemm] counter=116 i=3 t=8.7e-02 per=2.6e+01 cost=4.6e+08 flops=5.3e+09
 sigma_tot[gemm] counter=116 i=4 t=6.4e-02 per=1.9e+01 cost=3.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=116 i=5 t=6.5e-02 per=1.9e+01 cost=4.0e+08 flops=6.1e+09
 sigma_tot[gemm] counter=116 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=6.0e+09
 sigma_tot[red] counter=116 t=3.8e-02 per=1.1e+01 cost=1.1e+08 flops=2.9e+09
T(sub)=1.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.0e-06,3.0e-06,6.5e-06,1.5e-06,3.2e-07
settings: ndim=131 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.539344816793 -1.117e+03  2.869e-02    1     1  1.322e-03 1.322e-03 1.281e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.452e-05,8.999e-05,9.163e-04,2.230e-04,1.299e-03
 analyze_tgpu[Hx]: ndim=131:9.760e-07GB T(cpu-gpu)=2.198e-05 speed=8.879e-02GB/S T(nccl)=4.253e-05 speed=4.590e-02GB/S
----- TIMING FOR sigma : t_inter=9.0e-05 t_gemm=9.2e-04 t_reduction=2.2e-04 tot=1.2e-03 -----
 sigma[inter] counter=117 t=9.0e-05 per=7.3e+00 cost=2.2e+05 flops=2.4e+09
 sigma[gemm] counter=117 i=0 t=2.1e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=1 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=117 i=2 t=2.0e-04 per=1.7e+01 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=117 i=3 t=2.3e-04 per=1.9e+01 cost=2.2e+04 flops=9.5e+07
 sigma[gemm] counter=117 i=4 t=2.5e-04 per=2.0e+01 cost=4.4e+04 flops=1.7e+08
 sigma[gemm] counter=117 i=5 t=2.3e-04 per=1.8e+01 cost=4.1e+04 flops=1.8e+08
 sigma[gemm] counter=117 total t=9.2e-04 per=7.5e+01 cost=1.3e+05 flops=1.4e+08
 sigma[red] counter=117 t=2.2e-04 per=1.8e+01 cost=2.4e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=2.9e-01 t_reduction=3.9e-02 tot=3.4e-01 -----
 sigma_tot[inter] counter=117 t=1.6e-02 per=4.6e+00 cost=5.2e+08 flops=3.3e+10
 sigma_tot[gemm] counter=117 i=0 t=2.5e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=1 t=2.4e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=117 i=2 t=7.0e-02 per=2.0e+01 cost=4.7e+08 flops=6.7e+09
 sigma_tot[gemm] counter=117 i=3 t=8.8e-02 per=2.6e+01 cost=4.6e+08 flops=5.2e+09
 sigma_tot[gemm] counter=117 i=4 t=6.5e-02 per=1.9e+01 cost=3.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=117 i=5 t=6.6e-02 per=1.9e+01 cost=4.0e+08 flops=6.0e+09
 sigma_tot[gemm] counter=117 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=5.9e+09
 sigma_tot[red] counter=117 t=3.9e-02 per=1.1e+01 cost=1.1e+08 flops=2.9e+09
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.0e-05,2.7e-06,1.5e-06,2.5e-07
    2   0 -    -116.540333365021 -9.885e-04  6.062e-03    2     2  2.888e-03 1.444e-03 1.384e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.175e-05,8.468e-05,9.089e-04,2.201e-04,1.280e-03
 analyze_tgpu[Hx]: ndim=131:9.760e-07GB T(cpu-gpu)=2.170e-05 speed=8.994e-02GB/S T(nccl)=4.005e-05 speed=4.874e-02GB/S
----- TIMING FOR sigma : t_inter=8.5e-05 t_gemm=9.1e-04 t_reduction=2.2e-04 tot=1.2e-03 -----
 sigma[inter] counter=118 t=8.5e-05 per=7.0e+00 cost=2.2e+05 flops=2.5e+09
 sigma[gemm] counter=118 i=0 t=2.1e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=1 t=2.0e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=118 i=2 t=2.0e-04 per=1.7e+01 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=118 i=3 t=2.4e-04 per=1.9e+01 cost=2.2e+04 flops=9.4e+07
 sigma[gemm] counter=118 i=4 t=2.5e-04 per=2.0e+01 cost=4.4e+04 flops=1.8e+08
 sigma[gemm] counter=118 i=5 t=2.2e-04 per=1.8e+01 cost=4.1e+04 flops=1.9e+08
 sigma[gemm] counter=118 total t=9.1e-04 per=7.5e+01 cost=1.3e+05 flops=1.4e+08
 sigma[red] counter=118 t=2.2e-04 per=1.8e+01 cost=2.4e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=2.9e-01 t_reduction=3.9e-02 tot=3.4e-01 -----
 sigma_tot[inter] counter=118 t=1.6e-02 per=4.6e+00 cost=5.2e+08 flops=3.3e+10
 sigma_tot[gemm] counter=118 i=0 t=2.6e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=1 t=2.4e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=118 i=2 t=7.0e-02 per=2.0e+01 cost=4.7e+08 flops=6.7e+09
 sigma_tot[gemm] counter=118 i=3 t=8.8e-02 per=2.6e+01 cost=4.6e+08 flops=5.2e+09
 sigma_tot[gemm] counter=118 i=4 t=6.5e-02 per=1.9e+01 cost=3.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=118 i=5 t=6.6e-02 per=1.9e+01 cost=4.0e+08 flops=6.0e+09
 sigma_tot[gemm] counter=118 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=5.9e+09
 sigma_tot[red] counter=118 t=3.9e-02 per=1.1e+01 cost=1.1e+08 flops=2.9e+09
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.5e-06,1.3e-05,2.0e-06,1.7e-06,2.3e-07
    3   0 -    -116.540397077555 -6.371e-05  1.725e-03    3     3  4.434e-03 1.478e-03 1.419e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.191e-05,8.505e-05,9.077e-04,2.205e-04,1.279e-03
 analyze_tgpu[Hx]: ndim=131:9.760e-07GB T(cpu-gpu)=2.133e-05 speed=9.153e-02GB/S T(nccl)=4.058e-05 speed=4.810e-02GB/S
----- TIMING FOR sigma : t_inter=8.5e-05 t_gemm=9.1e-04 t_reduction=2.2e-04 tot=1.2e-03 -----
 sigma[inter] counter=119 t=8.5e-05 per=7.0e+00 cost=2.2e+05 flops=2.5e+09
 sigma[gemm] counter=119 i=0 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=1 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=119 i=2 t=2.0e-04 per=1.7e+01 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=119 i=3 t=2.3e-04 per=1.9e+01 cost=2.2e+04 flops=9.7e+07
 sigma[gemm] counter=119 i=4 t=2.5e-04 per=2.1e+01 cost=4.4e+04 flops=1.8e+08
 sigma[gemm] counter=119 i=5 t=2.3e-04 per=1.9e+01 cost=4.1e+04 flops=1.8e+08
 sigma[gemm] counter=119 total t=9.1e-04 per=7.5e+01 cost=1.3e+05 flops=1.4e+08
 sigma[red] counter=119 t=2.2e-04 per=1.8e+01 cost=2.4e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=2.9e-01 t_reduction=3.9e-02 tot=3.4e-01 -----
 sigma_tot[inter] counter=119 t=1.6e-02 per=4.6e+00 cost=5.2e+08 flops=3.3e+10
 sigma_tot[gemm] counter=119 i=0 t=2.6e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=1 t=2.4e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=119 i=2 t=7.0e-02 per=2.0e+01 cost=4.7e+08 flops=6.6e+09
 sigma_tot[gemm] counter=119 i=3 t=8.8e-02 per=2.6e+01 cost=4.6e+08 flops=5.2e+09
 sigma_tot[gemm] counter=119 i=4 t=6.5e-02 per=1.9e+01 cost=3.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=119 i=5 t=6.6e-02 per=1.9e+01 cost=4.0e+08 flops=6.0e+09
 sigma_tot[gemm] counter=119 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=5.9e+09
 sigma_tot[red] counter=119 t=3.9e-02 per=1.1e+01 cost=1.1e+08 flops=2.9e+09
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.2e-05,1.9e-06,1.5e-06,2.2e-07
    4   0 -    -116.540402953551 -5.876e-06  6.454e-04    3     4  5.945e-03 1.486e-03 1.428e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.996e-05,8.441e-05,9.093e-04,2.195e-04,1.277e-03
 analyze_tgpu[Hx]: ndim=131:9.760e-07GB T(cpu-gpu)=2.074e-05 speed=9.411e-02GB/S T(nccl)=3.922e-05 speed=4.977e-02GB/S
----- TIMING FOR sigma : t_inter=8.4e-05 t_gemm=9.1e-04 t_reduction=2.2e-04 tot=1.2e-03 -----
 sigma[inter] counter=120 t=8.4e-05 per=7.0e+00 cost=2.2e+05 flops=2.6e+09
 sigma[gemm] counter=120 i=0 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=1 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=120 i=2 t=2.0e-04 per=1.7e+01 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=120 i=3 t=2.3e-04 per=1.9e+01 cost=2.2e+04 flops=9.4e+07
 sigma[gemm] counter=120 i=4 t=2.5e-04 per=2.1e+01 cost=4.4e+04 flops=1.8e+08
 sigma[gemm] counter=120 i=5 t=2.2e-04 per=1.8e+01 cost=4.1e+04 flops=1.9e+08
 sigma[gemm] counter=120 total t=9.1e-04 per=7.5e+01 cost=1.3e+05 flops=1.4e+08
 sigma[red] counter=120 t=2.2e-04 per=1.8e+01 cost=2.4e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=2.9e-01 t_reduction=3.9e-02 tot=3.5e-01 -----
 sigma_tot[inter] counter=120 t=1.6e-02 per=4.7e+00 cost=5.2e+08 flops=3.3e+10
 sigma_tot[gemm] counter=120 i=0 t=2.6e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=1 t=2.4e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=120 i=2 t=7.0e-02 per=2.0e+01 cost=4.7e+08 flops=6.6e+09
 sigma_tot[gemm] counter=120 i=3 t=8.8e-02 per=2.6e+01 cost=4.6e+08 flops=5.2e+09
 sigma_tot[gemm] counter=120 i=4 t=6.5e-02 per=1.9e+01 cost=3.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=120 i=5 t=6.6e-02 per=1.9e+01 cost=4.0e+08 flops=6.0e+09
 sigma_tot[gemm] counter=120 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=5.9e+09
 sigma_tot[red] counter=120 t=3.9e-02 per=1.1e+01 cost=1.1e+08 flops=2.8e+09
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.2e-05,1.9e-06,1.3e-06,1.7e-07
    5   0 -    -116.540403809546 -8.560e-07  2.549e-04    3     5  7.481e-03 1.496e-03 1.439e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.051e-05,8.474e-05,9.110e-04,2.219e-04,1.282e-03
 analyze_tgpu[Hx]: ndim=131:9.760e-07GB T(cpu-gpu)=2.103e-05 speed=9.284e-02GB/S T(nccl)=3.948e-05 speed=4.944e-02GB/S
----- TIMING FOR sigma : t_inter=8.5e-05 t_gemm=9.1e-04 t_reduction=2.2e-04 tot=1.2e-03 -----
 sigma[inter] counter=121 t=8.5e-05 per=7.0e+00 cost=2.2e+05 flops=2.5e+09
 sigma[gemm] counter=121 i=0 t=2.1e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=1 t=2.0e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=121 i=2 t=2.0e-04 per=1.7e+01 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=121 i=3 t=2.3e-04 per=1.9e+01 cost=2.2e+04 flops=9.7e+07
 sigma[gemm] counter=121 i=4 t=2.6e-04 per=2.1e+01 cost=4.4e+04 flops=1.7e+08
 sigma[gemm] counter=121 i=5 t=2.2e-04 per=1.8e+01 cost=4.1e+04 flops=1.9e+08
 sigma[gemm] counter=121 total t=9.1e-04 per=7.5e+01 cost=1.3e+05 flops=1.4e+08
 sigma[red] counter=121 t=2.2e-04 per=1.8e+01 cost=2.4e+04 flops=1.1e+08
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=2.9e-01 t_reduction=3.9e-02 tot=3.5e-01 -----
 sigma_tot[inter] counter=121 t=1.6e-02 per=4.7e+00 cost=5.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=121 i=0 t=2.6e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=1 t=2.4e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=121 i=2 t=7.1e-02 per=2.0e+01 cost=4.7e+08 flops=6.6e+09
 sigma_tot[gemm] counter=121 i=3 t=8.9e-02 per=2.6e+01 cost=4.6e+08 flops=5.2e+09
 sigma_tot[gemm] counter=121 i=4 t=6.6e-02 per=1.9e+01 cost=3.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=121 i=5 t=6.6e-02 per=1.9e+01 cost=4.0e+08 flops=6.0e+09
 sigma_tot[gemm] counter=121 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=5.9e+09
 sigma_tot[red] counter=121 t=3.9e-02 per=1.1e+01 cost=1.1e+08 flops=2.8e+09
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.7e-06,1.1e-05,1.8e-06,1.4e-06,2.3e-07
    6   0 +    -116.540403924337 -1.148e-07  8.093e-05    3     6  9.007e-03 1.501e-03 1.445e-03
TIMING FOR Davidson : 9.021e-03  T(cal/comm/rest)=8.668e-03,1.591e-06,3.520e-04
decomposed t_rest=3.520e-04
 T(sub)    =1.128e-04 per=3.204e+01
 T(precond)=1.551e-05 per=4.406e+00
 T(ortho)  =8.695e-06 per=2.470e+00
 T(xcopy)  =8.540e-07 per=2.426e-01
 T(xnrm2)  =1.155e-06 per=3.281e-01
 T(other)  =2.130e-04 per=6.052e+01
optimized energies: isweep=0 ibond=15 dots=1 e[0]=-116.540403924337 nmvp=6
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=4.331e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=14 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond15.txt
 qbond: qsuper nsym=14 dimAll=96
 (24,2):9 (26,2):19 (25,3):10 (25,1):13 (28,2):6 (27,3):11 (27,1):9 (26,4):5 (26,0):4 (23,1):3 (24,0):3 (29,3):1 (28,4):2 (27,5):1
timing for divide=2.3e-06
timing for compute=4.7e-05
timing for collect=1.1e-05
----- TMING FOR decimation_genbasis(nkr): 6.0e-05 S T(divide/compute[cpu/gpu/rest]/collect)=2.3e-06,4.2e-05,0.0e+00,4.5e-06,1.1e-05 -----
decimation summary: 96->10 dwt=-2.220e-16 SvN=1.359e+00
 qbond: qkept nsym=5 dimAll=10
 (26,2):3 (25,1):3 (27,1):2 (28,2):1 (27,3):1
----- TIMING for decimation_row(nkr): 9.640e-04 S T(decim/select/formRot)=1.181e-04,8.242e-04,2.161e-05 -----
----- TIMING FOR onedot_decimation: 1.018e-03 S T(wf/decim)=3.028e-05,9.873e-04 -----
ctns::oper_renorm coord=(16,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:34 S:3 H:1 P:7 Q:11 
        dim(bra,ket)=10,10 size(op)=24:1.831e-04MB size(tot)=598:4.562e-03MB:4.455e-06GB
        per(mem): C:59.7 S:3.51 H:4.01 P:7.02 Q:25.8 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=4.366e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=53 : 3.363e-04 S -----
rank=0 GPUmem(GB): used=5.667e-05 (oper)=4.987e-05
rank=0 GPUmem(GB): used=5.765e-05 (oper,site)=4.987e-05,9.760e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=53
 no. of rintermediate operators=45
 no. of coefficients=720:5.493e-03MB:5.364e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.977e-05 S -----
rank=0 GPUmem(GB): used=6.301e-05 (oper,site,rinter)=4.987e-05,9.760e-07,5.364e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.782e-04 S size(rtasks)=53 size(Rlst2)=25 T(Rmu/Rlist)=6.233e-05,2.159e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.719e-04 S size(rtasks)=53 size(Rlst)=857 -----
rank=0 GPUmem(GB): used=6.301e-05 avail=3.829e+01 total=3.829e+01 batch[need]=3.895e-04 blksize=18 blksize0=24 batchsize=857
rank=0 GPUmem(GB): used=4.525e-04 (oper,site,rinter,batch)=4.987e-05,9.760e-07,5.364e-06,3.895e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.029e-04,6.364e-04,1.760e-04
----- TIMING FOR renorm : t_inter=1.0e-04 t_gemm=6.4e-04 t_reduction=1.8e-04 tot=9.1e-04 -----
 renorm[inter] counter=346 t=1.0e-04 per=1.1e+01 cost=9.2e+04 flops=9.0e+08
 renorm[gemm] counter=346 i=0 t=2.0e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=346 i=1 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=346 i=2 t=1.9e-06 per=2.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=346 i=3 t=1.9e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=346 i=4 t=2.0e-04 per=2.2e+01 cost=1.7e+04 flops=8.6e+07
 renorm[gemm] counter=346 i=5 t=2.3e-04 per=2.6e+01 cost=4.2e+04 flops=1.8e+08
 renorm[gemm] counter=346 i=6 t=2.0e-04 per=2.1e+01 cost=3.8e+04 flops=1.9e+08
 renorm[gemm] counter=346 total t=6.4e-04 per=7.0e+01 cost=9.7e+04 flops=1.5e+08
 renorm[red] counter=346 t=1.8e-04 per=1.9e+01 cost=8.4e+03 flops=4.8e+07
----- TIMING FOR renorm_tot : t_inter=2.1e-03 t_gemm=1.7e-02 t_reduction=4.1e-03 tot=2.3e-02 -----
 renorm_tot[inter] counter=346 t=2.1e-03 per=9.1e+00 cost=1.6e+07 flops=7.8e+09
 renorm_tot[gemm] counter=346 i=0 t=3.4e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=346 i=1 t=3.0e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=346 i=2 t=2.9e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=346 i=3 t=2.9e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=346 i=4 t=4.4e-03 per=1.9e+01 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=346 i=5 t=6.3e-03 per=2.7e+01 cost=2.4e+07 flops=3.8e+09
 renorm_tot[gemm] counter=346 i=6 t=5.9e-03 per=2.6e+01 cost=4.5e+07 flops=7.6e+09
 renorm_tot[gemm] counter=346 total t=1.7e-02 per=7.3e+01 cost=7.9e+07 flops=4.7e+09
 renorm_tot[red] counter=346 t=4.1e-03 per=1.8e+01 cost=5.3e+06 flops=1.3e+09
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=6.357e-05 (oper)=4.998e-05
rank=0 GPUmem(GB): used=6.454e-05 (oper,site,rinter)=4.998e-05,9.760e-07,1.431e-06
rank=0 GPUmem(GB): used=7.185e-05 (oper,site,rinter,batch)=4.998e-05,9.760e-07,1.431e-06,7.302e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.291e-03 S T(preprocess/alloc/comp/red/dealloc)=2.852e-04,3.466e-04,1.560e-03,3.272e-04,4.445e-05 -----
----- TIMING FOR oper_renorm_opS : 2.311e-03 S rank=0 -----
qops.to_cpu: size(tot)=598:4.562e-03MB:4.455e-06GB T(to_cpu)=2.713e-05S speed=1.642e-01GB/S
check ||H-H.dagger||=4.083e-14 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.00501 S rank=0 -----
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=2.844e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.298e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-2.190e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 2.202e-02 S #####
 T(local opt: fetch) = 2.695e-03 S  per = 12.2  per(accum) = 12.2
 T(local opt: hdiag) = 3.492e-04 S  per = 1.59  per(accum) = 13.8
 T(local opt: dvdsn) = 1.060e-02 S  per = 48.1  per(accum) = 62
 T(local opt: decim) = 1.052e-03 S  per = 4.78  per(accum) = 66.7
 T(local opt: guess) = 2.785e-05 S  per = 0.126  per(accum) = 66.9
 T(local opt: renrm) = 5.513e-03 S  per =   25  per(accum) = 91.9
 T(local opt: save ) = 1.786e-03 S  per = 8.11  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.060e-02 S  T(sum) = 1.032e-02 S  per = 9.737e+01
 T(local opt: preprocess                  ) = 4.536e-05 S  per = 0.44  per(accum) = 0.44
 T(local opt: symbolic_formulae           ) = 3.370e-04 S  per = 3.27  per(accum) = 3.71
 T(local opt: hintermediate init          ) = 5.434e-05 S  per = 0.527  per(accum) = 4.23
 T(local opt: preprocess_hformulae_Hxlist ) = 4.537e-04 S  per =  4.4  per(accum) = 8.63
 T(local opt: hmmtasks init               ) = 4.054e-04 S  per = 3.93  per(accum) = 12.6
 T(local opt: initial guess for dvdson    ) = 2.553e-06 S  per = 0.0247  per(accum) = 12.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 8.290e-03 S  per = 80.3  per(accum) = 92.9
 T(local opt: dvdson [cpu-gpu]            ) = 1.291e-04 S  per = 1.25  per(accum) = 94.2
 T(local opt: dvdson [nccl]               ) = 2.485e-04 S  per = 2.41  per(accum) = 96.6
 T(local opt: dvdson [mpi]                ) = 1.591e-06 S  per = 0.0154  per(accum) = 96.6
 T(local opt: dvdson [rest part(linalg)]  ) = 3.520e-04 S  per = 3.41  per(accum) = 100
Detailed decomposition of T(renrm) = 5.513e-03 S  T(sum) = 5.513e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.518e-05 S  per = 0.819  per(accum) = 0.819
 T(local opt: qops init                    ) = 2.690e-04 S  per = 4.88  per(accum) = 5.7
 T(local opt: symbolic_formulae_renorm     ) = 3.494e-04 S  per = 6.34  per(accum) = 12
 T(local opt: allocate qops on gpu         ) = 5.778e-05 S  per = 1.05  per(accum) = 13.1
 T(local opt: site memcpy cpu2gpu          ) = 2.240e-05 S  per = 0.406  per(accum) = 13.5
 T(local opt: rintermediate init           ) = 5.448e-05 S  per = 0.988  per(accum) = 14.5
 T(local opt: preprocess_formulae_Rlist2   ) = 3.840e-04 S  per = 6.96  per(accum) = 21.4
 T(local opt: rmmtasks init                ) = 3.312e-04 S  per = 6.01  per(accum) = 27.4
 T(local opt: qops memset on cpu           ) = 7.600e-08 S  per = 0.00138  per(accum) = 27.5
 T(local opt: preprocess_renorm_batchGPU   ) = 1.112e-03 S  per = 20.2  per(accum) = 47.6
 T(local opt: deallocate cpu and gpu memory) = 2.864e-05 S  per = 0.519  per(accum) = 48.1
 T(local opt: construct opS [ifdists=true] ) = 2.332e-03 S  per = 42.3  per(accum) = 90.4
 T(local opt: reduction of opS & opH [nccl]) = 1.798e-05 S  per = 0.326  per(accum) = 90.8
 T(local opt: qops memcpy gpu2cpu          ) = 4.030e-05 S  per = 0.731  per(accum) = 91.5
 T(local opt: reduction of opS & opH [mpi] ) = 9.978e-06 S  per = 0.181  per(accum) = 91.7
 T(local opt: qops_pool join and erase     ) = 4.586e-04 S  per = 8.32  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.230e-07 S  per = 0.0149  per(accum) = 100
ctns::rcanon_save_site idx=3 scratch=./scratch/sweep size=131:9.8e-07GB T(load)=0.00056S speed=0.0017GB/S
##### sweep opt: 9.378e-01 S #####
 T(sweep opt: fetch) = 5.400e-02 S  per = 5.76  per(accum) = 5.76
 T(sweep opt: hdiag) = 1.451e-02 S  per = 1.55  per(accum) = 7.31
 T(sweep opt: dvdsn) = 5.103e-01 S  per = 54.4  per(accum) = 61.7
 T(sweep opt: decim) = 1.941e-02 S  per = 2.07  per(accum) = 63.8
 T(sweep opt: guess) = 9.035e-04 S  per = 0.0963  per(accum) = 63.9
 T(sweep opt: renrm) = 3.056e-01 S  per = 32.6  per(accum) = 96.5
 T(sweep opt: save ) = 3.307e-02 S  per = 3.53  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.103e-01 S  T(sum) = 5.014e-01 S  per = 9.824e+01
 T(sweep opt: preprocess                  ) = 1.171e-03 S  per = 0.234  per(accum) = 0.234
 T(sweep opt: symbolic_formulae           ) = 1.417e-02 S  per = 2.83  per(accum) = 3.06
 T(sweep opt: hintermediate init          ) = 9.586e-04 S  per = 0.191  per(accum) = 3.25
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.875e-02 S  per = 9.72  per(accum) = 13
 T(sweep opt: hmmtasks init               ) = 4.984e-02 S  per = 9.94  per(accum) = 22.9
 T(sweep opt: initial guess for dvdson    ) = 1.036e-04 S  per = 0.0207  per(accum) = 22.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.690e-01 S  per = 73.6  per(accum) = 96.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 2.955e-03 S  per = 0.589  per(accum) = 97.1
 T(sweep opt: dvdson [nccl]               ) = 5.903e-03 S  per = 1.18  per(accum) = 98.3
 T(sweep opt: dvdson [mpi]                ) = 5.166e-05 S  per = 0.0103  per(accum) = 98.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.407e-03 S  per = 1.68  per(accum) = 100
Detailed decomposition of T(renrm) = 3.056e-01 S  T(sum) = 3.056e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.104e-04 S  per = 0.265  per(accum) = 0.265
 T(sweep opt: qops init                    ) = 7.986e-03 S  per = 2.61  per(accum) = 2.88
 T(sweep opt: symbolic_formulae_renorm     ) = 8.534e-03 S  per = 2.79  per(accum) = 5.67
 T(sweep opt: allocate qops on gpu         ) = 1.103e-03 S  per = 0.361  per(accum) = 6.03
 T(sweep opt: site memcpy cpu2gpu          ) = 3.765e-04 S  per = 0.123  per(accum) = 6.15
 T(sweep opt: rintermediate init           ) = 8.457e-04 S  per = 0.277  per(accum) = 6.43
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.519e-02 S  per = 4.97  per(accum) = 11.4
 T(sweep opt: rmmtasks init                ) = 1.657e-02 S  per = 5.42  per(accum) = 16.8
 T(sweep opt: qops memset on cpu           ) = 7.590e-07 S  per = 0.000248  per(accum) = 16.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.520e-02 S  per = 8.25  per(accum) = 25.1
 T(sweep opt: deallocate cpu and gpu memory) = 2.500e-03 S  per = 0.818  per(accum) = 25.9
 T(sweep opt: construct opS [ifdists=true] ) = 2.059e-01 S  per = 67.4  per(accum) = 93.3
 T(sweep opt: reduction of opS & opH [nccl]) = 3.295e-04 S  per = 0.108  per(accum) = 93.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.934e-03 S  per = 0.633  per(accum) = 94
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.215e-04 S  per = 0.138  per(accum) = 94.1
 T(sweep opt: qops_pool join and erase     ) = 1.108e-02 S  per = 3.62  per(accum) = 97.8
 T(sweep opt: conversion from opAB to opPQ ) = 6.828e-03 S  per = 2.23  per(accum) = 100
##### global opt: 9.378e-01 S #####
 T(global opt: fetch) = 5.400e-02 S  per = 5.76  per(accum) = 5.76
 T(global opt: hdiag) = 1.451e-02 S  per = 1.55  per(accum) = 7.31
 T(global opt: dvdsn) = 5.103e-01 S  per = 54.4  per(accum) = 61.7
 T(global opt: decim) = 1.941e-02 S  per = 2.07  per(accum) = 63.8
 T(global opt: guess) = 9.035e-04 S  per = 0.0963  per(accum) = 63.9
 T(global opt: renrm) = 3.056e-01 S  per = 32.6  per(accum) = 96.5
 T(global opt: save ) = 3.307e-02 S  per = 3.53  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.103e-01 S  T(sum) = 5.014e-01 S  per = 9.824e+01
 T(global opt: preprocess                  ) = 1.171e-03 S  per = 0.234  per(accum) = 0.234
 T(global opt: symbolic_formulae           ) = 1.417e-02 S  per = 2.83  per(accum) = 3.06
 T(global opt: hintermediate init          ) = 9.586e-04 S  per = 0.191  per(accum) = 3.25
 T(global opt: preprocess_hformulae_Hxlist ) = 4.875e-02 S  per = 9.72  per(accum) = 13
 T(global opt: hmmtasks init               ) = 4.984e-02 S  per = 9.94  per(accum) = 22.9
 T(global opt: initial guess for dvdson    ) = 1.036e-04 S  per = 0.0207  per(accum) = 22.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.690e-01 S  per = 73.6  per(accum) = 96.5
 T(global opt: dvdson [cpu-gpu]            ) = 2.955e-03 S  per = 0.589  per(accum) = 97.1
 T(global opt: dvdson [nccl]               ) = 5.903e-03 S  per = 1.18  per(accum) = 98.3
 T(global opt: dvdson [mpi]                ) = 5.166e-05 S  per = 0.0103  per(accum) = 98.3
 T(global opt: dvdson [rest part(linalg)]  ) = 8.407e-03 S  per = 1.68  per(accum) = 100
Detailed decomposition of T(renrm) = 3.056e-01 S  T(sum) = 3.056e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.104e-04 S  per = 0.265  per(accum) = 0.265
 T(global opt: qops init                    ) = 7.986e-03 S  per = 2.61  per(accum) = 2.88
 T(global opt: symbolic_formulae_renorm     ) = 8.534e-03 S  per = 2.79  per(accum) = 5.67
 T(global opt: allocate qops on gpu         ) = 1.103e-03 S  per = 0.361  per(accum) = 6.03
 T(global opt: site memcpy cpu2gpu          ) = 3.765e-04 S  per = 0.123  per(accum) = 6.15
 T(global opt: rintermediate init           ) = 8.457e-04 S  per = 0.277  per(accum) = 6.43
 T(global opt: preprocess_formulae_Rlist2   ) = 1.519e-02 S  per = 4.97  per(accum) = 11.4
 T(global opt: rmmtasks init                ) = 1.657e-02 S  per = 5.42  per(accum) = 16.8
 T(global opt: qops memset on cpu           ) = 7.590e-07 S  per = 0.000248  per(accum) = 16.8
 T(global opt: preprocess_renorm_batchGPU   ) = 2.520e-02 S  per = 8.25  per(accum) = 25.1
 T(global opt: deallocate cpu and gpu memory) = 2.500e-03 S  per = 0.818  per(accum) = 25.9
 T(global opt: construct opS [ifdists=true] ) = 2.059e-01 S  per = 67.4  per(accum) = 93.3
 T(global opt: reduction of opS & opH [nccl]) = 3.295e-04 S  per = 0.108  per(accum) = 93.4
 T(global opt: qops memcpy gpu2cpu          ) = 1.934e-03 S  per = 0.633  per(accum) = 94
 T(global opt: reduction of opS & opH [mpi] ) = 4.215e-04 S  per = 0.138  per(accum) = 94.1
 T(global opt: qops_pool join and erase     ) = 1.108e-02 S  per = 3.62  per(accum) = 97.8
 T(global opt: conversion from opAB to opPQ ) = 6.828e-03 S  per = 2.23  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-4.352e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=16/seqsize=34 dots=1 dbond=(17,0)-(18,0) forward=1 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=1 scratch=./scratch/sweep size=6:4.47e-08GB T(load)=3.29e-04S speed=1.36e-04GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=32:2.44e-04MB:2.38e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=26:1.98e-04MB:1.94e-07GB
total mem of comb=206:1.57e-03MB:1.53e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=7.153e-07 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=17,2,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 14 15
 suppc= 13
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:34 S:3 H:1 P:7 Q:11 
        dim(bra,ket)=10,10 size(op)=24:1.831e-04MB size(tot)=598:4.562e-03MB:4.455e-06GB
        per(mem): C:59.7 S:3.51 H:4.01 P:7.02 Q:25.8 
 rqops: oplist=CSHAB nops=C:4 S:18 H:1 A:3 B:5 
        dim(bra,ket)=4,4 size(op)=6:4.58e-05MB size(tot)=32:0.000244MB:2.38e-07GB
        per(mem): C:25 S:0 H:18.8 A:0 B:56.2 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=2966:0.0226MB:2.21e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=8.945e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/lop(17,0) fdel=./scratch/sweep/rop(18,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(17,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(18,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.192e-07 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(10,4,4) nnz=26:1.984e-04MB
qtensor3: wf3 own=1 _data=0x55b2c5c508f0
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=5 dimAll=10
 (26,2):3 (25,1):3 (27,1):2 (28,2):1 (27,3):1
 qbond: qcol nsym=3 dimAll=4
 (3,-1):2 (4,0):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=8 nblocks=60 size=26:1.984e-04MB
### DIAG TIMING: total=1.889e-04 t1=1.615e-05, t2=1.160e-05, t3=1.424e-05, t4=9.552e-05, t5=9.942e-06, t6=3.460e-05, t7=6.874e-06
duration_diagGPU:2.031e-04
duration_diagreduce:6.300e-08
duration_diagtransform:1.450e-07
----- TIMING FOR symbolic_formulae_onedot with size=98 : 2.047e-04 S -----
rank=0 GPUmem(GB): used=2.210e-05 (oper)=2.210e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=98
 no. of hintermediate operators=29
 no. of coefficients=493:3.761e-03MB:3.673e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.765e-05 S -----
rank=0 GPUmem(GB): used=2.577e-05 (oper,hinter)=2.210e-05,3.673e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.293e-04 S size(H_formulae)=98 size(Hxlst2)=8 T(Hmu/Hxlist)=3.980e-05,8.943e-05 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.489e-04 S size(H_formulae)=98 size(Hxlst)=336 -----
rank=0 GPUmem(GB): used=2.577e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=3.874e-07 batch[need]=5.507e-05 blksize=6 blksize0=9 batchsize=336
rank=0 GPUmem(GB): used=8.123e-05 (oper,hinter,dvdson,batch)=2.210e-05,3.673e-06,3.874e-07,5.507e-05
ctns::pdvdsonSolver_nkr::solve_iter ndim=26 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.656e-05,8.065e-05,3.508e-04,1.175e-04,6.210e-04
 analyze_tgpu[Hx]: ndim=26:1.937e-07GB T(cpu-gpu)=2.062e-05 speed=1.879e-02GB/S T(nccl)=4.595e-05 speed=8.432e-03GB/S
----- TIMING FOR sigma : t_inter=8.1e-05 t_gemm=3.5e-04 t_reduction=1.2e-04 tot=5.5e-04 -----
 sigma[inter] counter=122 t=8.1e-05 per=1.5e+01 cost=1.1e+04 flops=1.4e+08
 sigma[gemm] counter=122 i=0 t=1.8e-06 per=3.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=1 t=1.6e-06 per=2.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=122 i=2 t=7.1e-05 per=1.3e+01 cost=9.8e+02 flops=1.4e+07
 sigma[gemm] counter=122 i=3 t=7.9e-05 per=1.4e+01 cost=9.3e+02 flops=1.2e+07
 sigma[gemm] counter=122 i=4 t=1.0e-04 per=1.9e+01 cost=1.9e+03 flops=1.9e+07
 sigma[gemm] counter=122 i=5 t=9.5e-05 per=1.7e+01 cost=2.0e+03 flops=2.1e+07
 sigma[gemm] counter=122 total t=3.5e-04 per=6.4e+01 cost=5.8e+03 flops=1.7e+07
 sigma[red] counter=122 t=1.2e-04 per=2.1e+01 cost=2.1e+03 flops=1.8e+07
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=2.9e-01 t_reduction=4.0e-02 tot=3.5e-01 -----
 sigma_tot[inter] counter=122 t=1.6e-02 per=4.7e+00 cost=5.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=122 i=0 t=2.6e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=1 t=2.5e-04 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=122 i=2 t=7.1e-02 per=2.0e+01 cost=4.7e+08 flops=6.6e+09
 sigma_tot[gemm] counter=122 i=3 t=8.9e-02 per=2.5e+01 cost=4.6e+08 flops=5.2e+09
 sigma_tot[gemm] counter=122 i=4 t=6.6e-02 per=1.9e+01 cost=3.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=122 i=5 t=6.7e-02 per=1.9e+01 cost=4.0e+08 flops=6.0e+09
 sigma_tot[gemm] counter=122 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=5.9e+09
 sigma_tot[red] counter=122 t=4.0e-02 per=1.1e+01 cost=1.1e+08 flops=2.8e+09
T(sub)=7.2e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,2.7e-06,9.0e-07,7.9e-07,1.6e-07
settings: ndim=26 neig=1 maxcycle=30 nbuff=4 memory=3e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.540403924337 -1.117e+03  9.465e-03    1     1  8.017e-04 8.017e-04 7.754e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.802e-05,7.510e-05,4.125e-04,1.290e-04,6.785e-04
 analyze_tgpu[Hx]: ndim=26:1.937e-07GB T(cpu-gpu)=2.004e-05 speed=1.934e-02GB/S T(nccl)=3.798e-05 speed=1.020e-02GB/S
----- TIMING FOR sigma : t_inter=7.5e-05 t_gemm=4.1e-04 t_reduction=1.3e-04 tot=6.2e-04 -----
 sigma[inter] counter=123 t=7.5e-05 per=1.2e+01 cost=1.1e+04 flops=1.5e+08
 sigma[gemm] counter=123 i=0 t=2.0e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=1 t=1.8e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=123 i=2 t=7.8e-05 per=1.3e+01 cost=9.8e+02 flops=1.3e+07
 sigma[gemm] counter=123 i=3 t=9.0e-05 per=1.5e+01 cost=9.3e+02 flops=1.0e+07
 sigma[gemm] counter=123 i=4 t=1.2e-04 per=1.9e+01 cost=1.9e+03 flops=1.7e+07
 sigma[gemm] counter=123 i=5 t=1.2e-04 per=2.0e+01 cost=2.0e+03 flops=1.6e+07
 sigma[gemm] counter=123 total t=4.1e-04 per=6.7e+01 cost=5.8e+03 flops=1.4e+07
 sigma[red] counter=123 t=1.3e-04 per=2.1e+01 cost=2.1e+03 flops=1.6e+07
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=2.9e-01 t_reduction=4.0e-02 tot=3.5e-01 -----
 sigma_tot[inter] counter=123 t=1.6e-02 per=4.7e+00 cost=5.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=123 i=0 t=2.7e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=1 t=2.5e-04 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=123 i=2 t=7.1e-02 per=2.0e+01 cost=4.7e+08 flops=6.6e+09
 sigma_tot[gemm] counter=123 i=3 t=8.9e-02 per=2.5e+01 cost=4.6e+08 flops=5.2e+09
 sigma_tot[gemm] counter=123 i=4 t=6.6e-02 per=1.9e+01 cost=3.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=123 i=5 t=6.7e-02 per=1.9e+01 cost=4.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=123 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=5.8e+09
 sigma_tot[red] counter=123 t=4.0e-02 per=1.1e+01 cost=1.1e+08 flops=2.8e+09
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=3.6e-06,8.9e-06,2.1e-06,1.1e-06,2.4e-07
    2   0 -    -116.540555881003 -1.520e-04  7.658e-04    2     2  1.746e-03 8.731e-04 8.206e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.642e-05,6.691e-05,4.072e-04,1.282e-04,6.622e-04
 analyze_tgpu[Hx]: ndim=26:1.937e-07GB T(cpu-gpu)=1.984e-05 speed=1.953e-02GB/S T(nccl)=3.658e-05 speed=1.059e-02GB/S
----- TIMING FOR sigma : t_inter=6.7e-05 t_gemm=4.1e-04 t_reduction=1.3e-04 tot=6.0e-04 -----
 sigma[inter] counter=124 t=6.7e-05 per=1.1e+01 cost=1.1e+04 flops=1.6e+08
 sigma[gemm] counter=124 i=0 t=1.9e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=1 t=1.8e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=124 i=2 t=8.2e-05 per=1.4e+01 cost=9.8e+02 flops=1.2e+07
 sigma[gemm] counter=124 i=3 t=9.0e-05 per=1.5e+01 cost=9.3e+02 flops=1.0e+07
 sigma[gemm] counter=124 i=4 t=1.2e-04 per=2.0e+01 cost=1.9e+03 flops=1.6e+07
 sigma[gemm] counter=124 i=5 t=1.1e-04 per=1.9e+01 cost=2.0e+03 flops=1.7e+07
 sigma[gemm] counter=124 total t=4.1e-04 per=6.8e+01 cost=5.8e+03 flops=1.4e+07
 sigma[red] counter=124 t=1.3e-04 per=2.1e+01 cost=2.1e+03 flops=1.6e+07
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=2.9e-01 t_reduction=4.0e-02 tot=3.5e-01 -----
 sigma_tot[inter] counter=124 t=1.6e-02 per=4.7e+00 cost=5.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=124 i=0 t=2.7e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=1 t=2.5e-04 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=124 i=2 t=7.1e-02 per=2.0e+01 cost=4.7e+08 flops=6.6e+09
 sigma_tot[gemm] counter=124 i=3 t=8.9e-02 per=2.5e+01 cost=4.6e+08 flops=5.2e+09
 sigma_tot[gemm] counter=124 i=4 t=6.6e-02 per=1.9e+01 cost=3.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=124 i=5 t=6.7e-02 per=1.9e+01 cost=4.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=124 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=5.8e+09
 sigma_tot[red] counter=124 t=4.0e-02 per=1.1e+01 cost=1.1e+08 flops=2.8e+09
T(sub)=1.6e-05 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,1.1e-05,1.7e-06,1.1e-06,1.9e-07
    3   0 -    -116.540557770063 -1.889e-06  3.249e-04    3     3  2.633e-03 8.775e-04 8.282e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.672e-05,6.599e-05,4.021e-04,1.265e-04,6.548e-04
 analyze_tgpu[Hx]: ndim=26:1.937e-07GB T(cpu-gpu)=1.956e-05 speed=1.980e-02GB/S T(nccl)=3.715e-05 speed=1.043e-02GB/S
----- TIMING FOR sigma : t_inter=6.6e-05 t_gemm=4.0e-04 t_reduction=1.3e-04 tot=5.9e-04 -----
 sigma[inter] counter=125 t=6.6e-05 per=1.1e+01 cost=1.1e+04 flops=1.7e+08
 sigma[gemm] counter=125 i=0 t=1.9e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=1 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=125 i=2 t=7.7e-05 per=1.3e+01 cost=9.8e+02 flops=1.3e+07
 sigma[gemm] counter=125 i=3 t=9.5e-05 per=1.6e+01 cost=9.3e+02 flops=9.8e+06
 sigma[gemm] counter=125 i=4 t=1.2e-04 per=1.9e+01 cost=1.9e+03 flops=1.7e+07
 sigma[gemm] counter=125 i=5 t=1.1e-04 per=1.9e+01 cost=2.0e+03 flops=1.8e+07
 sigma[gemm] counter=125 total t=4.0e-04 per=6.8e+01 cost=5.8e+03 flops=1.4e+07
 sigma[red] counter=125 t=1.3e-04 per=2.1e+01 cost=2.1e+03 flops=1.7e+07
----- TIMING FOR sigma_tot : t_inter=1.6e-02 t_gemm=2.9e-01 t_reduction=4.0e-02 tot=3.5e-01 -----
 sigma_tot[inter] counter=125 t=1.6e-02 per=4.7e+00 cost=5.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=125 i=0 t=2.7e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=1 t=2.5e-04 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=125 i=2 t=7.1e-02 per=2.0e+01 cost=4.7e+08 flops=6.6e+09
 sigma_tot[gemm] counter=125 i=3 t=8.9e-02 per=2.5e+01 cost=4.6e+08 flops=5.2e+09
 sigma_tot[gemm] counter=125 i=4 t=6.6e-02 per=1.9e+01 cost=3.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=125 i=5 t=6.7e-02 per=1.9e+01 cost=4.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=125 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=5.8e+09
 sigma_tot[red] counter=125 t=4.0e-02 per=1.1e+01 cost=1.1e+08 flops=2.8e+09
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=6.6e-06,9.3e-06,1.5e-06,1.0e-06,1.6e-07
    4   0 -    -116.540557981695 -2.116e-07  1.258e-04    3     4  3.509e-03 8.774e-04 8.282e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.536e-05,6.622e-05,3.999e-04,1.265e-04,6.515e-04
 analyze_tgpu[Hx]: ndim=26:1.937e-07GB T(cpu-gpu)=1.926e-05 speed=2.012e-02GB/S T(nccl)=3.610e-05 speed=1.073e-02GB/S
----- TIMING FOR sigma : t_inter=6.6e-05 t_gemm=4.0e-04 t_reduction=1.3e-04 tot=5.9e-04 -----
 sigma[inter] counter=126 t=6.6e-05 per=1.1e+01 cost=1.1e+04 flops=1.7e+08
 sigma[gemm] counter=126 i=0 t=1.9e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=1 t=1.9e-06 per=3.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=126 i=2 t=7.7e-05 per=1.3e+01 cost=9.8e+02 flops=1.3e+07
 sigma[gemm] counter=126 i=3 t=8.8e-05 per=1.5e+01 cost=9.3e+02 flops=1.1e+07
 sigma[gemm] counter=126 i=4 t=1.2e-04 per=2.0e+01 cost=1.9e+03 flops=1.6e+07
 sigma[gemm] counter=126 i=5 t=1.1e-04 per=1.9e+01 cost=2.0e+03 flops=1.8e+07
 sigma[gemm] counter=126 total t=4.0e-04 per=6.7e+01 cost=5.8e+03 flops=1.5e+07
 sigma[red] counter=126 t=1.3e-04 per=2.1e+01 cost=2.1e+03 flops=1.7e+07
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=2.9e-01 t_reduction=4.0e-02 tot=3.5e-01 -----
 sigma_tot[inter] counter=126 t=1.7e-02 per=4.7e+00 cost=5.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=126 i=0 t=2.7e-04 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=1 t=2.5e-04 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=126 i=2 t=7.1e-02 per=2.0e+01 cost=4.7e+08 flops=6.6e+09
 sigma_tot[gemm] counter=126 i=3 t=8.9e-02 per=2.5e+01 cost=4.6e+08 flops=5.2e+09
 sigma_tot[gemm] counter=126 i=4 t=6.6e-02 per=1.9e+01 cost=3.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=126 i=5 t=6.7e-02 per=1.9e+01 cost=4.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=126 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=5.8e+09
 sigma_tot[red] counter=126 t=4.0e-02 per=1.1e+01 cost=1.1e+08 flops=2.8e+09
T(sub)=1.3e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-06,8.2e-06,1.5e-06,9.3e-07,1.4e-07
    5   0 +    -116.540558010161 -2.847e-08  2.835e-05    3     5  4.378e-03 8.757e-04 8.293e-04
TIMING FOR Davidson : 4.397e-03  T(cal/comm/rest)=4.147e-03,1.296e-06,2.494e-04
decomposed t_rest=2.494e-04
 T(sub)    =7.095e-05 per=2.845e+01
 T(precond)=1.388e-05 per=5.567e+00
 T(ortho)  =5.975e-06 per=2.396e+00
 T(xcopy)  =6.930e-07 per=2.779e-01
 T(xnrm2)  =6.270e-07 per=2.514e-01
 T(other)  =1.573e-04 per=6.306e+01
optimized energies: isweep=0 ibond=16 dots=1 e[0]=-116.540558010161 nmvp=5
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.557e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=11 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond16.txt
 qbond: qsuper nsym=11 dimAll=40
 (26,2):6 (28,2):7 (27,3):4 (27,1):8 (25,1):3 (26,0):3 (29,1):3 (28,0):2 (30,2):1 (29,3):2 (28,4):1
timing for divide=1.7e-06
timing for compute=2.4e-05
timing for collect=1.0e-05
----- TMING FOR decimation_genbasis(nkr): 3.7e-05 S T(divide/compute[cpu/gpu/rest]/collect)=1.7e-06,2.1e-05,0.0e+00,3.9e-06,1.0e-05 -----
decimation summary: 40->4 dwt=+0.000e+00 SvN=8.987e-01
 qbond: qkept nsym=3 dimAll=4
 (27,1):2 (28,2):1 (26,0):1
----- TIMING for decimation_row(nkr): 8.446e-04 S T(decim/select/formRot)=8.023e-05,7.513e-04,1.310e-05 -----
----- TIMING FOR onedot_decimation: 8.795e-04 S T(wf/decim)=2.378e-05,8.557e-04 -----
ctns::oper_renorm coord=(17,0) superblock=lc oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:36 S:2 H:1 P:3 Q:5 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=96:7.324e-04MB:7.153e-07GB
        per(mem): C:75 S:0 H:6.25 P:0 Q:18.8 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=2.686e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=45 : 2.102e-04 S -----
rank=0 GPUmem(GB): used=2.625e-05 (oper)=2.258e-05
rank=0 GPUmem(GB): used=2.644e-05 (oper,site)=2.258e-05,1.937e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=45
 no. of rintermediate operators=21
 no. of coefficients=357:2.724e-03MB:2.660e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.177e-05 S -----
rank=0 GPUmem(GB): used=2.910e-05 (oper,site,rinter)=2.258e-05,1.937e-07,2.660e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.476e-04 S size(rtasks)=45 size(Rlst2)=9 T(Rmu/Rlist)=4.446e-05,1.031e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.674e-04 S size(rtasks)=45 size(Rlst)=297 -----
rank=0 GPUmem(GB): used=2.910e-05 avail=3.829e+01 total=3.829e+01 batch[need]=4.868e-05 blksize=6 blksize0=9 batchsize=297
rank=0 GPUmem(GB): used=7.778e-05 (oper,site,rinter,batch)=2.258e-05,1.937e-07,2.660e-06,4.868e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.151e-05,3.718e-04,1.018e-04
----- TIMING FOR renorm : t_inter=9.1e-05 t_gemm=3.7e-04 t_reduction=1.0e-04 tot=5.6e-04 -----
 renorm[inter] counter=353 t=9.1e-05 per=1.6e+01 cost=5.5e+03 flops=6.0e+07
 renorm[gemm] counter=353 i=0 t=2.6e-06 per=4.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=353 i=1 t=2.6e-06 per=4.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=353 i=2 t=1.9e-06 per=3.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=353 i=3 t=2.0e-06 per=3.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=353 i=4 t=1.3e-04 per=2.3e+01 cost=1.2e+03 flops=9.3e+06
 renorm[gemm] counter=353 i=5 t=1.4e-04 per=2.5e+01 cost=2.9e+03 flops=2.0e+07
 renorm[gemm] counter=353 i=6 t=9.4e-05 per=1.7e+01 cost=2.8e+03 flops=2.9e+07
 renorm[gemm] counter=353 total t=3.7e-04 per=6.6e+01 cost=6.8e+03 flops=1.8e+07
 renorm[red] counter=353 t=1.0e-04 per=1.8e+01 cost=1.2e+03 flops=1.2e+07
----- TIMING FOR renorm_tot : t_inter=2.2e-03 t_gemm=1.7e-02 t_reduction=4.2e-03 tot=2.4e-02 -----
 renorm_tot[inter] counter=353 t=2.2e-03 per=9.3e+00 cost=1.6e+07 flops=7.5e+09
 renorm_tot[gemm] counter=353 i=0 t=3.6e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=353 i=1 t=3.2e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=353 i=2 t=3.1e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=353 i=3 t=3.1e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=353 i=4 t=4.6e-03 per=1.9e+01 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=353 i=5 t=6.4e-03 per=2.7e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=353 i=6 t=6.0e-03 per=2.5e+01 cost=4.5e+07 flops=7.5e+09
 renorm_tot[gemm] counter=353 total t=1.7e-02 per=7.3e+01 cost=7.9e+07 flops=4.6e+09
 renorm_tot[red] counter=353 t=4.2e-03 per=1.8e+01 cost=5.3e+06 flops=1.2e+09
ctns::oper_renorm_opS superblock=lc ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.995e-05 (oper)=2.261e-05
rank=0 GPUmem(GB): used=3.015e-05 (oper,site,rinter)=2.261e-05,1.937e-07,1.013e-06
rank=0 GPUmem(GB): used=3.053e-05 (oper,site,rinter,batch)=2.261e-05,1.937e-07,1.013e-06,3.874e-07
----- TIMING FOR preprocess_renorm_batchGPU_opS : 6.636e-04 S T(preprocess/alloc/comp/red/dealloc)=1.379e-04,1.980e-04,3.543e-04,7.184e-05,3.418e-05 -----
----- TIMING FOR oper_renorm_opS : 6.801e-04 S rank=0 -----
qops.to_cpu: size(tot)=96:7.324e-04MB:7.153e-07GB T(to_cpu)=2.425e-05S speed=2.949e-02GB/S
check ||H-H.dagger||=1.521e-16 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.00261 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.228e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.066e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-8.345e-07 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 1.403e-02 S #####
 T(local opt: fetch) = 2.663e-03 S  per =   19  per(accum) = 19
 T(local opt: hdiag) = 2.575e-04 S  per = 1.84  per(accum) = 20.8
 T(local opt: dvdsn) = 5.258e-03 S  per = 37.5  per(accum) = 58.3
 T(local opt: decim) = 9.134e-04 S  per = 6.51  per(accum) = 64.8
 T(local opt: guess) = 1.672e-05 S  per = 0.119  per(accum) = 64.9
 T(local opt: renrm) = 3.164e-03 S  per = 22.6  per(accum) = 87.5
 T(local opt: save ) = 1.758e-03 S  per = 12.5  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.258e-03 S  T(sum) = 5.011e-03 S  per = 9.530e+01
 T(local opt: preprocess                  ) = 3.165e-05 S  per = 0.631  per(accum) = 0.631
 T(local opt: symbolic_formulae           ) = 2.157e-04 S  per =  4.3  per(accum) = 4.94
 T(local opt: hintermediate init          ) = 5.559e-05 S  per = 1.11  per(accum) = 6.04
 T(local opt: preprocess_hformulae_Hxlist ) = 1.618e-04 S  per = 3.23  per(accum) = 9.27
 T(local opt: hmmtasks init               ) = 1.469e-04 S  per = 2.93  per(accum) = 12.2
 T(local opt: initial guess for dvdson    ) = 2.361e-06 S  per = 0.0471  per(accum) = 12.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.854e-03 S  per = 76.9  per(accum) = 89.1
 T(local opt: dvdson [cpu-gpu]            ) = 9.932e-05 S  per = 1.98  per(accum) = 91.1
 T(local opt: dvdson [nccl]               ) = 1.938e-04 S  per = 3.87  per(accum) = 95
 T(local opt: dvdson [mpi]                ) = 1.296e-06 S  per = 0.0259  per(accum) = 95
 T(local opt: dvdson [rest part(linalg)]  ) = 2.494e-04 S  per = 4.98  per(accum) = 100
Detailed decomposition of T(renrm) = 3.164e-03 S  T(sum) = 3.164e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.605e-05 S  per = 1.14  per(accum) = 1.14
 T(local opt: qops init                    ) = 2.312e-04 S  per = 7.31  per(accum) = 8.45
 T(local opt: symbolic_formulae_renorm     ) = 2.225e-04 S  per = 7.03  per(accum) = 15.5
 T(local opt: allocate qops on gpu         ) = 5.241e-05 S  per = 1.66  per(accum) = 17.1
 T(local opt: site memcpy cpu2gpu          ) = 2.243e-05 S  per = 0.709  per(accum) = 17.8
 T(local opt: rintermediate init           ) = 6.084e-05 S  per = 1.92  per(accum) = 19.8
 T(local opt: preprocess_formulae_Rlist2   ) = 1.794e-04 S  per = 5.67  per(accum) = 25.4
 T(local opt: rmmtasks init                ) = 1.740e-04 S  per =  5.5  per(accum) = 30.9
 T(local opt: qops memset on cpu           ) = 4.500e-08 S  per = 0.00142  per(accum) = 30.9
 T(local opt: preprocess_renorm_batchGPU   ) = 7.711e-04 S  per = 24.4  per(accum) = 55.3
 T(local opt: deallocate cpu and gpu memory) = 2.276e-05 S  per = 0.719  per(accum) = 56
 T(local opt: construct opS [ifdists=true] ) = 6.949e-04 S  per =   22  per(accum) = 78
 T(local opt: reduction of opS & opH [nccl]) = 1.343e-04 S  per = 4.24  per(accum) = 82.2
 T(local opt: qops memcpy gpu2cpu          ) = 3.541e-05 S  per = 1.12  per(accum) = 83.3
 T(local opt: reduction of opS & opH [mpi] ) = 8.204e-06 S  per = 0.259  per(accum) = 83.6
 T(local opt: qops_pool join and erase     ) = 5.180e-04 S  per = 16.4  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.140e-07 S  per = 0.0257  per(accum) = 100
ctns::rcanon_save_site idx=2 scratch=./scratch/sweep size=26:1.9e-07GB T(load)=0.00056S speed=0.00034GB/S
##### sweep opt: 9.518e-01 S #####
 T(sweep opt: fetch) = 5.667e-02 S  per = 5.95  per(accum) = 5.95
 T(sweep opt: hdiag) = 1.477e-02 S  per = 1.55  per(accum) = 7.51
 T(sweep opt: dvdsn) = 5.156e-01 S  per = 54.2  per(accum) = 61.7
 T(sweep opt: decim) = 2.033e-02 S  per = 2.14  per(accum) = 63.8
 T(sweep opt: guess) = 9.202e-04 S  per = 0.0967  per(accum) = 63.9
 T(sweep opt: renrm) = 3.088e-01 S  per = 32.4  per(accum) = 96.3
 T(sweep opt: save ) = 3.483e-02 S  per = 3.66  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.156e-01 S  T(sum) = 5.064e-01 S  per = 9.821e+01
 T(sweep opt: preprocess                  ) = 1.203e-03 S  per = 0.237  per(accum) = 0.237
 T(sweep opt: symbolic_formulae           ) = 1.439e-02 S  per = 2.84  per(accum) = 3.08
 T(sweep opt: hintermediate init          ) = 1.014e-03 S  per =  0.2  per(accum) = 3.28
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.892e-02 S  per = 9.66  per(accum) = 12.9
 T(sweep opt: hmmtasks init               ) = 4.998e-02 S  per = 9.87  per(accum) = 22.8
 T(sweep opt: initial guess for dvdson    ) = 1.060e-04 S  per = 0.0209  per(accum) = 22.8
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.729e-01 S  per = 73.6  per(accum) = 96.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.055e-03 S  per = 0.603  per(accum) = 97.1
 T(sweep opt: dvdson [nccl]               ) = 6.097e-03 S  per =  1.2  per(accum) = 98.3
 T(sweep opt: dvdson [mpi]                ) = 5.296e-05 S  per = 0.0105  per(accum) = 98.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.657e-03 S  per = 1.71  per(accum) = 100
Detailed decomposition of T(renrm) = 3.088e-01 S  T(sum) = 3.088e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.464e-04 S  per = 0.274  per(accum) = 0.274
 T(sweep opt: qops init                    ) = 8.217e-03 S  per = 2.66  per(accum) = 2.94
 T(sweep opt: symbolic_formulae_renorm     ) = 8.757e-03 S  per = 2.84  per(accum) = 5.77
 T(sweep opt: allocate qops on gpu         ) = 1.155e-03 S  per = 0.374  per(accum) = 6.15
 T(sweep opt: site memcpy cpu2gpu          ) = 3.989e-04 S  per = 0.129  per(accum) = 6.27
 T(sweep opt: rintermediate init           ) = 9.065e-04 S  per = 0.294  per(accum) = 6.57
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.537e-02 S  per = 4.98  per(accum) = 11.5
 T(sweep opt: rmmtasks init                ) = 1.675e-02 S  per = 5.42  per(accum) = 17
 T(sweep opt: qops memset on cpu           ) = 8.040e-07 S  per = 0.00026  per(accum) = 17
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.597e-02 S  per = 8.41  per(accum) = 25.4
 T(sweep opt: deallocate cpu and gpu memory) = 2.523e-03 S  per = 0.817  per(accum) = 26.2
 T(sweep opt: construct opS [ifdists=true] ) = 2.066e-01 S  per = 66.9  per(accum) = 93.1
 T(sweep opt: reduction of opS & opH [nccl]) = 4.638e-04 S  per = 0.15  per(accum) = 93.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.970e-03 S  per = 0.638  per(accum) = 93.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.297e-04 S  per = 0.139  per(accum) = 94
 T(sweep opt: qops_pool join and erase     ) = 1.159e-02 S  per = 3.75  per(accum) = 97.8
 T(sweep opt: conversion from opAB to opPQ ) = 6.828e-03 S  per = 2.21  per(accum) = 100
##### global opt: 9.518e-01 S #####
 T(global opt: fetch) = 5.667e-02 S  per = 5.95  per(accum) = 5.95
 T(global opt: hdiag) = 1.477e-02 S  per = 1.55  per(accum) = 7.51
 T(global opt: dvdsn) = 5.156e-01 S  per = 54.2  per(accum) = 61.7
 T(global opt: decim) = 2.033e-02 S  per = 2.14  per(accum) = 63.8
 T(global opt: guess) = 9.202e-04 S  per = 0.0967  per(accum) = 63.9
 T(global opt: renrm) = 3.088e-01 S  per = 32.4  per(accum) = 96.3
 T(global opt: save ) = 3.483e-02 S  per = 3.66  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.156e-01 S  T(sum) = 5.064e-01 S  per = 9.821e+01
 T(global opt: preprocess                  ) = 1.203e-03 S  per = 0.237  per(accum) = 0.237
 T(global opt: symbolic_formulae           ) = 1.439e-02 S  per = 2.84  per(accum) = 3.08
 T(global opt: hintermediate init          ) = 1.014e-03 S  per =  0.2  per(accum) = 3.28
 T(global opt: preprocess_hformulae_Hxlist ) = 4.892e-02 S  per = 9.66  per(accum) = 12.9
 T(global opt: hmmtasks init               ) = 4.998e-02 S  per = 9.87  per(accum) = 22.8
 T(global opt: initial guess for dvdson    ) = 1.060e-04 S  per = 0.0209  per(accum) = 22.8
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.729e-01 S  per = 73.6  per(accum) = 96.5
 T(global opt: dvdson [cpu-gpu]            ) = 3.055e-03 S  per = 0.603  per(accum) = 97.1
 T(global opt: dvdson [nccl]               ) = 6.097e-03 S  per =  1.2  per(accum) = 98.3
 T(global opt: dvdson [mpi]                ) = 5.296e-05 S  per = 0.0105  per(accum) = 98.3
 T(global opt: dvdson [rest part(linalg)]  ) = 8.657e-03 S  per = 1.71  per(accum) = 100
Detailed decomposition of T(renrm) = 3.088e-01 S  T(sum) = 3.088e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.464e-04 S  per = 0.274  per(accum) = 0.274
 T(global opt: qops init                    ) = 8.217e-03 S  per = 2.66  per(accum) = 2.94
 T(global opt: symbolic_formulae_renorm     ) = 8.757e-03 S  per = 2.84  per(accum) = 5.77
 T(global opt: allocate qops on gpu         ) = 1.155e-03 S  per = 0.374  per(accum) = 6.15
 T(global opt: site memcpy cpu2gpu          ) = 3.989e-04 S  per = 0.129  per(accum) = 6.27
 T(global opt: rintermediate init           ) = 9.065e-04 S  per = 0.294  per(accum) = 6.57
 T(global opt: preprocess_formulae_Rlist2   ) = 1.537e-02 S  per = 4.98  per(accum) = 11.5
 T(global opt: rmmtasks init                ) = 1.675e-02 S  per = 5.42  per(accum) = 17
 T(global opt: qops memset on cpu           ) = 8.040e-07 S  per = 0.00026  per(accum) = 17
 T(global opt: preprocess_renorm_batchGPU   ) = 2.597e-02 S  per = 8.41  per(accum) = 25.4
 T(global opt: deallocate cpu and gpu memory) = 2.523e-03 S  per = 0.817  per(accum) = 26.2
 T(global opt: construct opS [ifdists=true] ) = 2.066e-01 S  per = 66.9  per(accum) = 93.1
 T(global opt: reduction of opS & opH [nccl]) = 4.638e-04 S  per = 0.15  per(accum) = 93.3
 T(global opt: qops memcpy gpu2cpu          ) = 1.970e-03 S  per = 0.638  per(accum) = 93.9
 T(global opt: reduction of opS & opH [mpi] ) = 4.297e-04 S  per = 0.139  per(accum) = 94
 T(global opt: qops_pool join and erase     ) = 1.159e-02 S  per = 3.75  per(accum) = 97.8
 T(global opt: conversion from opAB to opPQ ) = 6.828e-03 S  per = 2.21  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.569e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=17/seqsize=34 dots=1 dbond=(17,0)-(18,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=2 scratch=./scratch/sweep size=26:1.94e-07GB T(load)=2.82e-04S speed=6.87e-04GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=32:2.44e-04MB:2.38e-07GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=6:4.58e-05MB:4.47e-08GB
total mem of comb=186:1.42e-03MB:1.39e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=1.013e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=18,1,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 13 16 17 18 19
 suppr= 15
 suppc= 14
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(17,0)
 fqop[1]=./scratch/sweep/rop(19,0)
 fqop[2]=./scratch/sweep/cop(18,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:36 S:2 H:1 P:3 Q:5 
        dim(bra,ket)=4,4 size(op)=6:4.578e-05MB size(tot)=96:7.324e-04MB:7.153e-07GB
        per(mem): C:75 S:0 H:6.25 P:0 Q:18.8 
 rqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=4768:0.0364MB:3.55e-05GB
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.749e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(18,0) fdel=./scratch/sweep/lop(17,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=-1.872e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(4,4,4) nnz=6:4.578e-05MB
qtensor3: wf3 own=1 _data=0x55b2c5f47a70
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=3 dimAll=4
 (27,1):2 (28,2):1 (26,0):1
 qbond: qcol nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=4 nblocks=48 size=6:4.578e-05MB
### DIAG TIMING: total=1.356e-04 t1=1.544e-05, t2=1.171e-05, t3=1.420e-05, t4=4.231e-05, t5=9.995e-06, t6=3.574e-05, t7=6.182e-06
duration_diagGPU:1.424e-04
duration_diagreduce:5.200e-08
duration_diagtransform:1.430e-07
----- TIMING FOR symbolic_formulae_onedot with size=63 : 1.130e-04 S -----
rank=0 GPUmem(GB): used=3.552e-05 (oper)=3.552e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=63
 no. of hintermediate operators=10
 no. of coefficients=180:1.373e-03MB:1.341e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 1.916e-05 S -----
rank=0 GPUmem(GB): used=3.687e-05 (oper,hinter)=3.552e-05,1.341e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.740e-05 S size(H_formulae)=63 size(Hxlst2)=4 T(Hmu/Hxlist)=2.810e-05,2.926e-05 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.187e-05 S size(H_formulae)=63 size(Hxlst)=58 -----
rank=0 GPUmem(GB): used=3.687e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=8.941e-08 batch[need]=3.025e-06 blksize=2 blksize0=2 batchsize=58
rank=0 GPUmem(GB): used=3.998e-05 (oper,hinter,dvdson,batch)=3.552e-05,1.341e-06,8.941e-08,3.025e-06
ctns::pdvdsonSolver_nkr::solve_iter ndim=6 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.991e-05,5.881e-05,1.933e-04,7.586e-05,4.015e-04
 analyze_tgpu[Hx]: ndim=6:4.470e-08GB T(cpu-gpu)=2.000e-05 speed=4.470e-03GB/S T(nccl)=4.991e-05 speed=1.791e-03GB/S
----- TIMING FOR sigma : t_inter=5.9e-05 t_gemm=1.9e-04 t_reduction=7.6e-05 tot=3.3e-04 -----
 sigma[inter] counter=127 t=5.9e-05 per=1.8e+01 cost=5.8e+02 flops=9.8e+06
 sigma[gemm] counter=127 i=0 t=1.8e-06 per=5.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=1 t=1.6e-06 per=4.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=127 i=2 t=4.7e-05 per=1.4e+01 cost=5.2e+01 flops=1.1e+06
 sigma[gemm] counter=127 i=3 t=4.4e-05 per=1.3e+01 cost=5.2e+01 flops=1.2e+06
 sigma[gemm] counter=127 i=4 t=5.0e-05 per=1.5e+01 cost=8.4e+01 flops=1.7e+06
 sigma[gemm] counter=127 i=5 t=4.9e-05 per=1.5e+01 cost=8.4e+01 flops=1.7e+06
 sigma[gemm] counter=127 total t=1.9e-04 per=5.9e+01 cost=2.7e+02 flops=1.4e+06
 sigma[red] counter=127 t=7.6e-05 per=2.3e+01 cost=1.8e+02 flops=2.3e+06
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=2.9e-01 t_reduction=4.0e-02 tot=3.5e-01 -----
 sigma_tot[inter] counter=127 t=1.7e-02 per=4.7e+00 cost=5.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=127 i=0 t=2.7e-04 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=1 t=2.6e-04 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=127 i=2 t=7.1e-02 per=2.0e+01 cost=4.7e+08 flops=6.6e+09
 sigma_tot[gemm] counter=127 i=3 t=8.9e-02 per=2.5e+01 cost=4.6e+08 flops=5.2e+09
 sigma_tot[gemm] counter=127 i=4 t=6.6e-02 per=1.9e+01 cost=3.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=127 i=5 t=6.7e-02 per=1.9e+01 cost=4.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=127 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=5.8e+09
 sigma_tot[red] counter=127 t=4.0e-02 per=1.1e+01 cost=1.1e+08 flops=2.8e+09
T(sub)=6.6e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,2.3e-06,7.9e-07,7.5e-07,1.5e-07
settings: ndim=6 neig=1 maxcycle=30 nbuff=4 memory=7e-07GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.540558010161 -1.117e+03  8.182e-06    1     1  4.749e-04 4.749e-04 4.605e-04
TIMING FOR Davidson : 4.898e-04  T(cal/comm/rest)=4.605e-04,7.100e-07,2.857e-05
decomposed t_rest=2.857e-05
 T(sub)    =6.633e-06 per=2.322e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =2.230e-07 per=7.806e-01
 T(xnrm2)  =8.300e-08 per=2.906e-01
 T(other)  =2.163e-05 per=7.571e+01
optimized energies: isweep=0 ibond=17 dots=1 e[0]=-116.540558010161 nmvp=1
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=5.980e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=9 alg_decim=0 mpisize=2
 qbond: qsuper nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
decimation summary: keep all 16 states
----- TIMING FOR onedot_decimation: 2.8e-05 S T(wf/decim)=1.4e-05,1.4e-05 -----
ctns::oper_renorm coord=(18,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:4 S:18 H:1 A:3 B:5 
        dim(bra,ket)=16,16 size(op)=36:2.7e-04MB size(tot)=742:5.7e-03MB:5.5e-06GB
        per(mem): C:12.9 S:58.2 H:4.85 A:5.12 B:18.9 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=5.314e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=13 : 1.835e-05 S -----
rank=0 GPUmem(GB): used=4.168e-05 (oper)=4.034e-05
rank=0 GPUmem(GB): used=4.195e-05 (oper,site)=4.034e-05,2.682e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=13
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=4.195e-05 (oper,site,rinter)=4.034e-05,2.682e-07,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 7.134e-05 S size(rtasks)=13 size(Rlst2)=81 T(Rmu/Rlist)=2.075e-05,5.056e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 8.102e-05 S size(rtasks)=13 size(Rlst)=170 -----
rank=0 GPUmem(GB): used=4.195e-05 avail=3.829e+01 total=3.829e+01 batch[need]=4.180e-05 blksize=16 blksize0=0 batchsize=170
rank=0 GPUmem(GB): used=8.374e-05 (oper,site,rinter,batch)=4.034e-05,2.682e-07,0.000e+00,4.180e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=5.523e-06,1.978e-04,1.126e-04
----- TIMING FOR renorm : t_inter=5.5e-06 t_gemm=2.0e-04 t_reduction=1.1e-04 tot=3.2e-04 -----
 renorm[inter] counter=356 t=5.5e-06 per=1.7e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=356 i=0 t=1.9e-06 per=6.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=356 i=1 t=1.7e-06 per=5.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=356 i=2 t=6.7e-05 per=2.1e+01 cost=2.1e+02 flops=3.1e+06
 renorm[gemm] counter=356 i=3 t=4.9e-05 per=1.6e+01 cost=3.6e+02 flops=7.2e+06
 renorm[gemm] counter=356 i=4 t=1.7e-06 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=356 i=5 t=1.7e-06 per=5.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=356 i=6 t=7.4e-05 per=2.4e+01 cost=2.1e+03 flops=2.9e+07
 renorm[gemm] counter=356 total t=2.0e-04 per=6.3e+01 cost=2.7e+03 flops=1.4e+07
 renorm[red] counter=356 t=1.1e-04 per=3.6e+01 cost=2.1e+03 flops=1.9e+07
----- TIMING FOR renorm_tot : t_inter=2.2e-03 t_gemm=1.7e-02 t_reduction=4.4e-03 tot=2.4e-02 -----
 renorm_tot[inter] counter=356 t=2.2e-03 per=9.2e+00 cost=1.6e+07 flops=7.5e+09
 renorm_tot[gemm] counter=356 i=0 t=3.8e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=356 i=1 t=3.4e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=356 i=2 t=9.9e-05 per=4.1e-01 cost=2.1e+02 flops=2.1e+06
 renorm_tot[gemm] counter=356 i=3 t=8.0e-05 per=3.4e-01 cost=3.6e+02 flops=4.4e+06
 renorm_tot[gemm] counter=356 i=4 t=4.6e-03 per=1.9e+01 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=356 i=5 t=6.4e-03 per=2.7e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=356 i=6 t=6.1e-03 per=2.5e+01 cost=4.5e+07 flops=7.4e+09
 renorm_tot[gemm] counter=356 total t=1.7e-02 per=7.3e+01 cost=7.9e+07 flops=4.5e+09
 renorm_tot[red] counter=356 t=4.4e-03 per=1.8e+01 cost=5.3e+06 flops=1.2e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=4.186e-05 (oper)=4.052e-05
rank=0 GPUmem(GB): used=4.213e-05 (oper,site,rinter)=4.052e-05,2.682e-07,0.000e+00
rank=0 GPUmem(GB): used=4.643e-05 (oper,site,rinter,batch)=4.052e-05,2.682e-07,0.000e+00,4.306e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 8.742e-03 S T(preprocess/alloc/comp/red/dealloc)=9.101e-04,9.551e-04,6.645e-03,1.060e-03,2.318e-05 -----
----- TIMING FOR oper_renorm_opS : 8.787e-03 S rank=0 -----
qops.to_cpu: size(tot)=742:5.661e-03MB:5.528e-06GB T(to_cpu)=2.270e-05S speed=2.435e-01GB/S
check ||H-H.dagger||=0.000e+00 coord=(18,0) rank=0
----- TIMING FOR oper_renorm : 0.00987 S rank=0 -----
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=5.269e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=1.427e-03 change=-1.801e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=1.427e-03 change=-1.550e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 1.750e-02 S #####
 T(local opt: fetch) = 4.011e-03 S  per = 22.9  per(accum) = 22.9
 T(local opt: hdiag) = 1.622e-04 S  per = 0.926  per(accum) = 23.8
 T(local opt: dvdsn) = 9.544e-04 S  per = 5.45  per(accum) = 29.3
 T(local opt: decim) = 4.428e-05 S  per = 0.253  per(accum) = 29.5
 T(local opt: guess) = 1.718e-05 S  per = 0.0981  per(accum) = 29.6
 T(local opt: renrm) = 1.058e-02 S  per = 60.5  per(accum) = 90.1
 T(local opt: save ) = 1.732e-03 S  per =  9.9  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.544e-04 S  T(sum) = 7.784e-04 S  per = 8.156e+01
 T(local opt: preprocess                  ) = 2.198e-05 S  per = 2.82  per(accum) = 2.82
 T(local opt: symbolic_formulae           ) = 1.170e-04 S  per =   15  per(accum) = 17.9
 T(local opt: hintermediate init          ) = 2.601e-05 S  per = 3.34  per(accum) = 21.2
 T(local opt: preprocess_hformulae_Hxlist ) = 6.449e-05 S  per = 8.28  per(accum) = 29.5
 T(local opt: hmmtasks init               ) = 5.697e-05 S  per = 7.32  per(accum) = 36.8
 T(local opt: initial guess for dvdson    ) = 2.127e-06 S  per = 0.273  per(accum) = 37.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.906e-04 S  per = 50.2  per(accum) = 87.3
 T(local opt: dvdson [cpu-gpu]            ) = 2.000e-05 S  per = 2.57  per(accum) = 89.8
 T(local opt: dvdson [nccl]               ) = 4.991e-05 S  per = 6.41  per(accum) = 96.2
 T(local opt: dvdson [mpi]                ) = 7.100e-07 S  per = 0.0912  per(accum) = 96.3
 T(local opt: dvdson [rest part(linalg)]  ) = 2.857e-05 S  per = 3.67  per(accum) = 100
Detailed decomposition of T(renrm) = 1.058e-02 S  T(sum) = 1.058e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.386e-05 S  per = 0.225  per(accum) = 0.225
 T(local opt: qops init                    ) = 1.786e-04 S  per = 1.69  per(accum) = 1.91
 T(local opt: symbolic_formulae_renorm     ) = 2.175e-05 S  per = 0.206  per(accum) = 2.12
 T(local opt: allocate qops on gpu         ) = 4.114e-05 S  per = 0.389  per(accum) = 2.51
 T(local opt: site memcpy cpu2gpu          ) = 1.469e-05 S  per = 0.139  per(accum) = 2.65
 T(local opt: rintermediate init           ) = 7.858e-06 S  per = 0.0742  per(accum) = 2.72
 T(local opt: preprocess_formulae_Rlist2   ) = 8.458e-05 S  per = 0.799  per(accum) = 3.52
 T(local opt: rmmtasks init                ) = 1.489e-04 S  per = 1.41  per(accum) = 4.93
 T(local opt: qops memset on cpu           ) = 3.200e-08 S  per = 0.000302  per(accum) = 4.93
 T(local opt: preprocess_renorm_batchGPU   ) = 4.356e-04 S  per = 4.12  per(accum) = 9.04
 T(local opt: deallocate cpu and gpu memory) = 1.923e-05 S  per = 0.182  per(accum) = 9.22
 T(local opt: construct opS [ifdists=true] ) = 8.828e-03 S  per = 83.4  per(accum) = 92.6
 T(local opt: reduction of opS & opH [nccl]) = 1.799e-05 S  per = 0.17  per(accum) = 92.8
 T(local opt: qops memcpy gpu2cpu          ) = 3.297e-05 S  per = 0.312  per(accum) = 93.1
 T(local opt: reduction of opS & opH [mpi] ) = 4.112e-05 S  per = 0.389  per(accum) = 93.5
 T(local opt: qops_pool join and erase     ) = 6.841e-04 S  per = 6.46  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 2.549e-06 S  per = 0.0241  per(accum) = 100
ctns::rcanon_save_site idx=1 scratch=./scratch/sweep size=36:2.7e-07GB T(load)=0.00055S speed=0.00049GB/S
##### sweep opt: 9.693e-01 S #####
 T(sweep opt: fetch) = 6.068e-02 S  per = 6.26  per(accum) = 6.26
 T(sweep opt: hdiag) = 1.493e-02 S  per = 1.54  per(accum) = 7.8
 T(sweep opt: dvdsn) = 5.165e-01 S  per = 53.3  per(accum) = 61.1
 T(sweep opt: decim) = 2.037e-02 S  per =  2.1  per(accum) = 63.2
 T(sweep opt: guess) = 9.374e-04 S  per = 0.0967  per(accum) = 63.3
 T(sweep opt: renrm) = 3.193e-01 S  per = 32.9  per(accum) = 96.2
 T(sweep opt: save ) = 3.656e-02 S  per = 3.77  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.165e-01 S  T(sum) = 5.071e-01 S  per = 9.818e+01
 T(sweep opt: preprocess                  ) = 1.225e-03 S  per = 0.241  per(accum) = 0.241
 T(sweep opt: symbolic_formulae           ) = 1.450e-02 S  per = 2.86  per(accum) = 3.1
 T(sweep opt: hintermediate init          ) = 1.040e-03 S  per = 0.205  per(accum) = 3.31
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.898e-02 S  per = 9.66  per(accum) = 13
 T(sweep opt: hmmtasks init               ) = 5.004e-02 S  per = 9.87  per(accum) = 22.8
 T(sweep opt: initial guess for dvdson    ) = 1.081e-04 S  per = 0.0213  per(accum) = 22.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.733e-01 S  per = 73.6  per(accum) = 96.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.075e-03 S  per = 0.606  per(accum) = 97.1
 T(sweep opt: dvdson [nccl]               ) = 6.147e-03 S  per = 1.21  per(accum) = 98.3
 T(sweep opt: dvdson [mpi]                ) = 5.367e-05 S  per = 0.0106  per(accum) = 98.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.685e-03 S  per = 1.71  per(accum) = 100
Detailed decomposition of T(renrm) = 3.193e-01 S  T(sum) = 3.193e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 8.703e-04 S  per = 0.273  per(accum) = 0.273
 T(sweep opt: qops init                    ) = 8.395e-03 S  per = 2.63  per(accum) = 2.9
 T(sweep opt: symbolic_formulae_renorm     ) = 8.778e-03 S  per = 2.75  per(accum) = 5.65
 T(sweep opt: allocate qops on gpu         ) = 1.196e-03 S  per = 0.375  per(accum) = 6.02
 T(sweep opt: site memcpy cpu2gpu          ) = 4.136e-04 S  per = 0.13  per(accum) = 6.15
 T(sweep opt: rintermediate init           ) = 9.144e-04 S  per = 0.286  per(accum) = 6.44
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.545e-02 S  per = 4.84  per(accum) = 11.3
 T(sweep opt: rmmtasks init                ) = 1.690e-02 S  per = 5.29  per(accum) = 16.6
 T(sweep opt: qops memset on cpu           ) = 8.360e-07 S  per = 0.000262  per(accum) = 16.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.641e-02 S  per = 8.27  per(accum) = 24.8
 T(sweep opt: deallocate cpu and gpu memory) = 2.542e-03 S  per = 0.796  per(accum) = 25.6
 T(sweep opt: construct opS [ifdists=true] ) = 2.154e-01 S  per = 67.5  per(accum) = 93.1
 T(sweep opt: reduction of opS & opH [nccl]) = 4.818e-04 S  per = 0.151  per(accum) = 93.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.003e-03 S  per = 0.627  per(accum) = 93.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.708e-04 S  per = 0.147  per(accum) = 94
 T(sweep opt: qops_pool join and erase     ) = 1.228e-02 S  per = 3.84  per(accum) = 97.9
 T(sweep opt: conversion from opAB to opPQ ) = 6.831e-03 S  per = 2.14  per(accum) = 100
##### global opt: 9.693e-01 S #####
 T(global opt: fetch) = 6.068e-02 S  per = 6.26  per(accum) = 6.26
 T(global opt: hdiag) = 1.493e-02 S  per = 1.54  per(accum) = 7.8
 T(global opt: dvdsn) = 5.165e-01 S  per = 53.3  per(accum) = 61.1
 T(global opt: decim) = 2.037e-02 S  per =  2.1  per(accum) = 63.2
 T(global opt: guess) = 9.374e-04 S  per = 0.0967  per(accum) = 63.3
 T(global opt: renrm) = 3.193e-01 S  per = 32.9  per(accum) = 96.2
 T(global opt: save ) = 3.656e-02 S  per = 3.77  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.165e-01 S  T(sum) = 5.071e-01 S  per = 9.818e+01
 T(global opt: preprocess                  ) = 1.225e-03 S  per = 0.241  per(accum) = 0.241
 T(global opt: symbolic_formulae           ) = 1.450e-02 S  per = 2.86  per(accum) = 3.1
 T(global opt: hintermediate init          ) = 1.040e-03 S  per = 0.205  per(accum) = 3.31
 T(global opt: preprocess_hformulae_Hxlist ) = 4.898e-02 S  per = 9.66  per(accum) = 13
 T(global opt: hmmtasks init               ) = 5.004e-02 S  per = 9.87  per(accum) = 22.8
 T(global opt: initial guess for dvdson    ) = 1.081e-04 S  per = 0.0213  per(accum) = 22.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.733e-01 S  per = 73.6  per(accum) = 96.5
 T(global opt: dvdson [cpu-gpu]            ) = 3.075e-03 S  per = 0.606  per(accum) = 97.1
 T(global opt: dvdson [nccl]               ) = 6.147e-03 S  per = 1.21  per(accum) = 98.3
 T(global opt: dvdson [mpi]                ) = 5.367e-05 S  per = 0.0106  per(accum) = 98.3
 T(global opt: dvdson [rest part(linalg)]  ) = 8.685e-03 S  per = 1.71  per(accum) = 100
Detailed decomposition of T(renrm) = 3.193e-01 S  T(sum) = 3.193e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 8.703e-04 S  per = 0.273  per(accum) = 0.273
 T(global opt: qops init                    ) = 8.395e-03 S  per = 2.63  per(accum) = 2.9
 T(global opt: symbolic_formulae_renorm     ) = 8.778e-03 S  per = 2.75  per(accum) = 5.65
 T(global opt: allocate qops on gpu         ) = 1.196e-03 S  per = 0.375  per(accum) = 6.02
 T(global opt: site memcpy cpu2gpu          ) = 4.136e-04 S  per = 0.13  per(accum) = 6.15
 T(global opt: rintermediate init           ) = 9.144e-04 S  per = 0.286  per(accum) = 6.44
 T(global opt: preprocess_formulae_Rlist2   ) = 1.545e-02 S  per = 4.84  per(accum) = 11.3
 T(global opt: rmmtasks init                ) = 1.690e-02 S  per = 5.29  per(accum) = 16.6
 T(global opt: qops memset on cpu           ) = 8.360e-07 S  per = 0.000262  per(accum) = 16.6
 T(global opt: preprocess_renorm_batchGPU   ) = 2.641e-02 S  per = 8.27  per(accum) = 24.8
 T(global opt: deallocate cpu and gpu memory) = 2.542e-03 S  per = 0.796  per(accum) = 25.6
 T(global opt: construct opS [ifdists=true] ) = 2.154e-01 S  per = 67.5  per(accum) = 93.1
 T(global opt: reduction of opS & opH [nccl]) = 4.818e-04 S  per = 0.151  per(accum) = 93.2
 T(global opt: qops memcpy gpu2cpu          ) = 2.003e-03 S  per = 0.627  per(accum) = 93.9
 T(global opt: reduction of opS & opH [mpi] ) = 4.708e-04 S  per = 0.147  per(accum) = 94
 T(global opt: qops_pool join and erase     ) = 1.228e-02 S  per = 3.84  per(accum) = 97.9
 T(global opt: conversion from opAB to opPQ ) = 6.831e-03 S  per = 2.14  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-6.503e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=18/seqsize=34 dots=1 dbond=(16,0)-(17,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=3 scratch=./scratch/sweep size=131:9.76e-07GB T(load)=2.93e-04S speed=3.33e-03GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=157:1.20e-03MB:1.17e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=40:3.05e-04MB:2.98e-07GB
total mem of comb=345:2.63e-03MB:2.57e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=2.876e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=17,2,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 12 16 17 18 19
 suppr= 14 15
 suppc= 13
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(16,0)
 fqop[1]=./scratch/sweep/rop(18,0)
 fqop[2]=./scratch/sweep/cop(17,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:34 S:3 H:1 P:7 Q:11 
        dim(bra,ket)=10,10 size(op)=24:1.831e-04MB size(tot)=598:4.562e-03MB:4.455e-06GB
        per(mem): C:59.7 S:3.51 H:4.01 P:7.02 Q:25.8 
 rqops: oplist=CSHAB nops=C:4 S:18 H:1 A:3 B:5 
        dim(bra,ket)=16,16 size(op)=36:0.000275MB size(tot)=742:0.00566MB:5.53e-06GB
        per(mem): C:12.9 S:58.2 H:4.85 A:5.12 B:18.9 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3676:0.028MB:2.74e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.254e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(17,0) fdel=./scratch/sweep/lop(16,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-4.411e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(10,16,4) nnz=40:3.052e-04MB
qtensor3: wf3 own=1 _data=0x55b2c6533400
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=5 dimAll=10
 (26,2):3 (25,1):3 (27,1):2 (28,2):1 (27,3):1
 qbond: qcol nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=11 nblocks=180 size=40:3.052e-04MB
### DIAG TIMING: total=1.939e-04 t1=1.541e-05, t2=1.257e-05, t3=1.436e-05, t4=1.002e-04, t5=1.003e-05, t6=3.520e-05, t7=6.064e-06
duration_diagGPU:2.076e-04
duration_diagreduce:7.400e-08
duration_diagtransform:1.670e-07
----- TIMING FOR symbolic_formulae_onedot with size=98 : 2.024e-04 S -----
rank=0 GPUmem(GB): used=2.739e-05 (oper)=2.739e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=98
 no. of hintermediate operators=29
 no. of coefficients=493:3.761e-03MB:3.673e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.443e-05 S -----
rank=0 GPUmem(GB): used=3.106e-05 (oper,hinter)=2.739e-05,3.673e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.880e-04 S size(H_formulae)=98 size(Hxlst2)=11 T(Hmu/Hxlist)=4.159e-05,1.464e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.545e-04 S size(H_formulae)=98 size(Hxlst)=620 -----
rank=0 GPUmem(GB): used=3.106e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=5.960e-07 batch[need]=1.571e-04 blksize=12 blksize0=9 batchsize=620
rank=0 GPUmem(GB): used=1.887e-04 (oper,hinter,dvdson,batch)=2.739e-05,3.673e-06,5.960e-07,1.571e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=40 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.534e-05,7.840e-05,5.193e-04,1.505e-04,8.190e-04
 analyze_tgpu[Hx]: ndim=40:2.980e-07GB T(cpu-gpu)=2.074e-05 speed=2.874e-02GB/S T(nccl)=4.460e-05 speed=1.336e-02GB/S
----- TIMING FOR sigma : t_inter=7.8e-05 t_gemm=5.2e-04 t_reduction=1.5e-04 tot=7.5e-04 -----
 sigma[inter] counter=128 t=7.8e-05 per=1.0e+01 cost=1.7e+04 flops=2.2e+08
 sigma[gemm] counter=128 i=0 t=1.8e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=1 t=1.6e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=128 i=2 t=1.4e-04 per=1.8e+01 cost=3.3e+03 flops=2.5e+07
 sigma[gemm] counter=128 i=3 t=1.4e-04 per=1.9e+01 cost=3.4e+03 flops=2.5e+07
 sigma[gemm] counter=128 i=4 t=1.2e-04 per=1.6e+01 cost=3.5e+03 flops=2.9e+07
 sigma[gemm] counter=128 i=5 t=1.2e-04 per=1.6e+01 cost=4.3e+03 flops=3.5e+07
 sigma[gemm] counter=128 total t=5.2e-04 per=6.9e+01 cost=1.5e+04 flops=2.8e+07
 sigma[red] counter=128 t=1.5e-04 per=2.0e+01 cost=4.4e+03 flops=2.9e+07
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=2.9e-01 t_reduction=4.0e-02 tot=3.5e-01 -----
 sigma_tot[inter] counter=128 t=1.7e-02 per=4.7e+00 cost=5.2e+08 flops=3.1e+10
 sigma_tot[gemm] counter=128 i=0 t=2.8e-04 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=1 t=2.6e-04 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=128 i=2 t=7.1e-02 per=2.0e+01 cost=4.7e+08 flops=6.5e+09
 sigma_tot[gemm] counter=128 i=3 t=8.9e-02 per=2.5e+01 cost=4.6e+08 flops=5.2e+09
 sigma_tot[gemm] counter=128 i=4 t=6.6e-02 per=1.9e+01 cost=3.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=128 i=5 t=6.7e-02 per=1.9e+01 cost=4.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=128 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=5.8e+09
 sigma_tot[red] counter=128 t=4.0e-02 per=1.1e+01 cost=1.1e+08 flops=2.8e+09
T(sub)=7.5e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,2.6e-06,9.4e-07,8.6e-07,1.8e-07
settings: ndim=40 neig=1 maxcycle=30 nbuff=4 memory=4e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.540558010161 -1.117e+03  6.796e-03    1     1  1.003e-03 1.003e-03 9.776e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.859e-05,7.117e-05,6.224e-04,1.662e-04,9.228e-04
 analyze_tgpu[Hx]: ndim=40:2.980e-07GB T(cpu-gpu)=2.042e-05 speed=2.919e-02GB/S T(nccl)=3.817e-05 speed=1.562e-02GB/S
----- TIMING FOR sigma : t_inter=7.1e-05 t_gemm=6.2e-04 t_reduction=1.7e-04 tot=8.6e-04 -----
 sigma[inter] counter=129 t=7.1e-05 per=8.3e+00 cost=1.7e+04 flops=2.4e+08
 sigma[gemm] counter=129 i=0 t=1.9e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=1 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=129 i=2 t=1.6e-04 per=1.8e+01 cost=3.3e+03 flops=2.1e+07
 sigma[gemm] counter=129 i=3 t=1.7e-04 per=2.0e+01 cost=3.4e+03 flops=2.1e+07
 sigma[gemm] counter=129 i=4 t=1.4e-04 per=1.7e+01 cost=3.5e+03 flops=2.5e+07
 sigma[gemm] counter=129 i=5 t=1.5e-04 per=1.8e+01 cost=4.3e+03 flops=2.8e+07
 sigma[gemm] counter=129 total t=6.2e-04 per=7.2e+01 cost=1.5e+04 flops=2.3e+07
 sigma[red] counter=129 t=1.7e-04 per=1.9e+01 cost=4.4e+03 flops=2.6e+07
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=2.9e-01 t_reduction=4.0e-02 tot=3.5e-01 -----
 sigma_tot[inter] counter=129 t=1.7e-02 per=4.8e+00 cost=5.2e+08 flops=3.1e+10
 sigma_tot[gemm] counter=129 i=0 t=2.8e-04 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=1 t=2.6e-04 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=129 i=2 t=7.1e-02 per=2.0e+01 cost=4.7e+08 flops=6.5e+09
 sigma_tot[gemm] counter=129 i=3 t=8.9e-02 per=2.5e+01 cost=4.6e+08 flops=5.1e+09
 sigma_tot[gemm] counter=129 i=4 t=6.6e-02 per=1.9e+01 cost=3.9e+08 flops=5.8e+09
 sigma_tot[gemm] counter=129 i=5 t=6.7e-02 per=1.9e+01 cost=4.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=129 total t=2.9e-01 per=8.4e+01 cost=1.7e+09 flops=5.8e+09
 sigma_tot[red] counter=129 t=4.0e-02 per=1.1e+01 cost=1.1e+08 flops=2.8e+09
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=3.8e-06,9.2e-06,2.3e-06,1.1e-06,2.5e-07
    2   0 -    -116.540653953323 -9.594e-05  9.327e-04    2     2  2.175e-03 1.087e-03 1.042e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.912e-05,6.851e-05,6.175e-04,1.652e-04,9.138e-04
 analyze_tgpu[Hx]: ndim=40:2.980e-07GB T(cpu-gpu)=2.095e-05 speed=2.846e-02GB/S T(nccl)=3.818e-05 speed=1.561e-02GB/S
----- TIMING FOR sigma : t_inter=6.8e-05 t_gemm=6.2e-04 t_reduction=1.7e-04 tot=8.5e-04 -----
 sigma[inter] counter=130 t=6.8e-05 per=8.0e+00 cost=1.7e+04 flops=2.5e+08
 sigma[gemm] counter=130 i=0 t=2.0e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=1 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=130 i=2 t=1.5e-04 per=1.8e+01 cost=3.3e+03 flops=2.2e+07
 sigma[gemm] counter=130 i=3 t=1.6e-04 per=1.9e+01 cost=3.4e+03 flops=2.1e+07
 sigma[gemm] counter=130 i=4 t=1.5e-04 per=1.8e+01 cost=3.5e+03 flops=2.3e+07
 sigma[gemm] counter=130 i=5 t=1.4e-04 per=1.7e+01 cost=4.3e+03 flops=3.0e+07
 sigma[gemm] counter=130 total t=6.2e-04 per=7.3e+01 cost=1.5e+04 flops=2.4e+07
 sigma[red] counter=130 t=1.7e-04 per=1.9e+01 cost=4.4e+03 flops=2.7e+07
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=3.0e-01 t_reduction=4.1e-02 tot=3.5e-01 -----
 sigma_tot[inter] counter=130 t=1.7e-02 per=4.8e+00 cost=5.2e+08 flops=3.1e+10
 sigma_tot[gemm] counter=130 i=0 t=2.8e-04 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=1 t=2.6e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=130 i=2 t=7.1e-02 per=2.0e+01 cost=4.7e+08 flops=6.5e+09
 sigma_tot[gemm] counter=130 i=3 t=9.0e-02 per=2.5e+01 cost=4.6e+08 flops=5.1e+09
 sigma_tot[gemm] counter=130 i=4 t=6.7e-02 per=1.9e+01 cost=3.9e+08 flops=5.8e+09
 sigma_tot[gemm] counter=130 i=5 t=6.7e-02 per=1.9e+01 cost=4.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=130 total t=3.0e-01 per=8.4e+01 cost=1.7e+09 flops=5.8e+09
 sigma_tot[red] counter=130 t=4.1e-02 per=1.2e+01 cost=1.1e+08 flops=2.8e+09
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,1.4e-05,2.2e-06,1.4e-06,2.8e-07
    3   0 -    -116.540655274198 -1.321e-06  1.023e-04    3     3  3.360e-03 1.120e-03 1.074e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.123e-05,7.897e-05,7.426e-04,1.917e-04,1.078e-03
 analyze_tgpu[Hx]: ndim=40:2.980e-07GB T(cpu-gpu)=2.163e-05 speed=2.756e-02GB/S T(nccl)=3.961e-05 speed=1.505e-02GB/S
----- TIMING FOR sigma : t_inter=7.9e-05 t_gemm=7.4e-04 t_reduction=1.9e-04 tot=1.0e-03 -----
 sigma[inter] counter=131 t=7.9e-05 per=7.8e+00 cost=1.7e+04 flops=2.2e+08
 sigma[gemm] counter=131 i=0 t=2.2e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=1 t=2.3e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=131 i=2 t=1.8e-04 per=1.8e+01 cost=3.3e+03 flops=1.8e+07
 sigma[gemm] counter=131 i=3 t=2.1e-04 per=2.0e+01 cost=3.4e+03 flops=1.7e+07
 sigma[gemm] counter=131 i=4 t=1.7e-04 per=1.7e+01 cost=3.5e+03 flops=2.0e+07
 sigma[gemm] counter=131 i=5 t=1.7e-04 per=1.7e+01 cost=4.3e+03 flops=2.5e+07
 sigma[gemm] counter=131 total t=7.4e-04 per=7.3e+01 cost=1.5e+04 flops=2.0e+07
 sigma[red] counter=131 t=1.9e-04 per=1.9e+01 cost=4.4e+03 flops=2.3e+07
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=3.0e-01 t_reduction=4.1e-02 tot=3.5e-01 -----
 sigma_tot[inter] counter=131 t=1.7e-02 per=4.8e+00 cost=5.2e+08 flops=3.1e+10
 sigma_tot[gemm] counter=131 i=0 t=2.8e-04 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=1 t=2.6e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=131 i=2 t=7.2e-02 per=2.0e+01 cost=4.7e+08 flops=6.5e+09
 sigma_tot[gemm] counter=131 i=3 t=9.0e-02 per=2.5e+01 cost=4.6e+08 flops=5.1e+09
 sigma_tot[gemm] counter=131 i=4 t=6.7e-02 per=1.9e+01 cost=3.9e+08 flops=5.8e+09
 sigma_tot[gemm] counter=131 i=5 t=6.8e-02 per=1.9e+01 cost=4.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=131 total t=3.0e-01 per=8.4e+01 cost=1.7e+09 flops=5.8e+09
 sigma_tot[red] counter=131 t=4.1e-02 per=1.2e+01 cost=1.1e+08 flops=2.7e+09
T(sub)=1.7e-05 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,1.1e-05,2.2e-06,1.1e-06,2.3e-07
    4   0 +    -116.540655294172 -1.997e-08  3.257e-05    3     4  4.584e-03 1.146e-03 1.101e-03
TIMING FOR Davidson : 4.600e-03  T(cal/comm/rest)=4.406e-03,4.831e-06,1.891e-04
decomposed t_rest=1.891e-04
 T(sub)    =6.217e-05 per=3.288e+01
 T(precond)=1.390e-05 per=7.348e+00
 T(ortho)  =5.105e-06 per=2.699e+00
 T(xcopy)  =5.720e-07 per=3.025e-01
 T(xnrm2)  =5.890e-07 per=3.115e-01
 T(other)  =1.068e-04 per=5.646e+01
optimized energies: isweep=0 ibond=18 dots=1 e[0]=-116.540655294172 nmvp=4
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=2.327e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,0,0.0e+00
ctns::decimation_row ifab=1 iftrunc=0 dcut=100 nqr=16 alg_decim=0 mpisize=2
 qbond: qsuper nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
decimation summary: keep all 64 states
----- TIMING FOR onedot_decimation: 6.8e-05 S T(wf/decim)=2.8e-05,4.0e-05 -----
ctns::oper_renorm coord=(17,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:6 S:17 H:1 A:7 B:11 
        dim(bra,ket)=64,64 size(op)=400:3.1e-03MB size(tot)=12085:9.2e-02MB:9.0e-05GB
        per(mem): C:14.9 S:42.2 H:3.31 A:10.4 B:29.2 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.739e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=25 : 4.606e-05 S -----
rank=0 GPUmem(GB): used=1.166e-04 (oper)=1.130e-04
rank=0 GPUmem(GB): used=1.196e-04 (oper,site)=1.130e-04,2.980e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=25
 no. of rintermediate operators=5
 no. of coefficients=14:1.068e-04MB:1.043e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.480e-05 S -----
rank=0 GPUmem(GB): used=1.197e-04 (oper,site,rinter)=1.130e-04,2.980e-06,1.043e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 3.701e-04 S size(rtasks)=25 size(Rlst2)=256 T(Rmu/Rlist)=2.374e-05,3.463e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.711e-04 S size(rtasks)=25 size(Rlst)=805 -----
rank=0 GPUmem(GB): used=1.197e-04 avail=3.829e+01 total=3.829e+01 batch[need]=1.074e-03 blksize=81 blksize0=16 batchsize=805
rank=0 GPUmem(GB): used=1.193e-03 (oper,site,rinter,batch)=1.130e-04,2.980e-06,1.043e-07,1.074e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.044e-04,5.909e-04,1.785e-04
----- TIMING FOR renorm : t_inter=1.0e-04 t_gemm=5.9e-04 t_reduction=1.8e-04 tot=8.7e-04 -----
 renorm[inter] counter=393 t=1.0e-04 per=1.2e+01 cost=3.6e+03 flops=3.4e+07
 renorm[gemm] counter=393 i=0 t=2.6e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=393 i=1 t=2.1e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=393 i=2 t=1.7e-04 per=1.9e+01 cost=1.2e+04 flops=7.2e+07
 renorm[gemm] counter=393 i=3 t=2.1e-04 per=2.4e+01 cost=2.6e+04 flops=1.3e+08
 renorm[gemm] counter=393 i=4 t=2.2e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=393 i=5 t=2.1e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=393 i=6 t=2.0e-04 per=2.3e+01 cost=1.4e+05 flops=7.1e+08
 renorm[gemm] counter=393 total t=5.9e-04 per=6.8e+01 cost=1.8e+05 flops=3.1e+08
 renorm[red] counter=393 t=1.8e-04 per=2.0e+01 cost=6.5e+04 flops=3.7e+08
----- TIMING FOR renorm_tot : t_inter=2.3e-03 t_gemm=1.8e-02 t_reduction=4.5e-03 tot=2.5e-02 -----
 renorm_tot[inter] counter=393 t=2.3e-03 per=9.3e+00 cost=1.6e+07 flops=7.2e+09
 renorm_tot[gemm] counter=393 i=0 t=4.1e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=393 i=1 t=3.6e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=393 i=2 t=2.7e-04 per=1.1e+00 cost=1.2e+04 flops=4.6e+07
 renorm_tot[gemm] counter=393 i=3 t=2.9e-04 per=1.2e+00 cost=2.7e+04 flops=9.2e+07
 renorm_tot[gemm] counter=393 i=4 t=4.6e-03 per=1.8e+01 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=393 i=5 t=6.4e-03 per=2.6e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=393 i=6 t=6.3e-03 per=2.5e+01 cost=4.5e+07 flops=7.2e+09
 renorm_tot[gemm] counter=393 total t=1.8e-02 per=7.2e+01 cost=7.9e+07 flops=4.4e+09
 renorm_tot[red] counter=393 t=4.5e-03 per=1.8e+01 cost=5.3e+06 flops=1.2e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.213e-04 (oper)=1.152e-04
rank=0 GPUmem(GB): used=1.242e-04 (oper,site,rinter)=1.152e-04,2.980e-06,2.280e-06
rank=0 GPUmem(GB): used=3.323e-04 (oper,site,rinter,batch)=1.152e-04,2.980e-06,2.280e-06,2.081e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.128e-02 S T(preprocess/alloc/comp/red/dealloc)=4.313e-03,4.358e-03,1.598e-02,6.665e-04,2.096e-04 -----
----- TIMING FOR oper_renorm_opS : 2.134e-02 S rank=0 -----
qops.to_cpu: size(tot)=12085:9.220e-02MB:9.004e-05GB T(to_cpu)=7.432e-05S speed=1.211e+00GB/S
check ||H-H.dagger||=0.000e+00 coord=(17,0) rank=0
----- TIMING FOR oper_renorm : 0.024 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=2.884e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.173e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-6.437e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 3.519e-02 S #####
 T(local opt: fetch) = 2.740e-03 S  per = 7.79  per(accum) = 7.79
 T(local opt: hdiag) = 2.613e-04 S  per = 0.743  per(accum) = 8.53
 T(local opt: dvdsn) = 5.627e-03 S  per =   16  per(accum) = 24.5
 T(local opt: decim) = 9.522e-05 S  per = 0.271  per(accum) = 24.8
 T(local opt: guess) = 4.490e-05 S  per = 0.128  per(accum) = 24.9
 T(local opt: renrm) = 2.460e-02 S  per = 69.9  per(accum) = 94.8
 T(local opt: save ) = 1.818e-03 S  per = 5.17  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.627e-03 S  T(sum) = 5.377e-03 S  per = 9.556e+01
 T(local opt: preprocess                  ) = 4.548e-05 S  per = 0.846  per(accum) = 0.846
 T(local opt: symbolic_formulae           ) = 2.130e-04 S  per = 3.96  per(accum) = 4.81
 T(local opt: hintermediate init          ) = 5.010e-05 S  per = 0.932  per(accum) = 5.74
 T(local opt: preprocess_hformulae_Hxlist ) = 2.635e-04 S  per =  4.9  per(accum) = 10.6
 T(local opt: hmmtasks init               ) = 2.034e-04 S  per = 3.78  per(accum) = 14.4
 T(local opt: initial guess for dvdson    ) = 2.203e-06 S  per = 0.041  per(accum) = 14.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 4.162e-03 S  per = 77.4  per(accum) = 91.9
 T(local opt: dvdson [cpu-gpu]            ) = 8.373e-05 S  per = 1.56  per(accum) = 93.4
 T(local opt: dvdson [nccl]               ) = 1.606e-04 S  per = 2.99  per(accum) = 96.4
 T(local opt: dvdson [mpi]                ) = 4.831e-06 S  per = 0.0898  per(accum) = 96.5
 T(local opt: dvdson [rest part(linalg)]  ) = 1.891e-04 S  per = 3.52  per(accum) = 100
Detailed decomposition of T(renrm) = 2.460e-02 S  T(sum) = 2.460e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.253e-05 S  per = 0.213  per(accum) = 0.213
 T(local opt: qops init                    ) = 4.208e-04 S  per = 1.71  per(accum) = 1.92
 T(local opt: symbolic_formulae_renorm     ) = 5.104e-05 S  per = 0.207  per(accum) = 2.13
 T(local opt: allocate qops on gpu         ) = 5.714e-05 S  per = 0.232  per(accum) = 2.36
 T(local opt: site memcpy cpu2gpu          ) = 2.326e-05 S  per = 0.0945  per(accum) = 2.46
 T(local opt: rintermediate init           ) = 3.322e-05 S  per = 0.135  per(accum) = 2.59
 T(local opt: preprocess_formulae_Rlist2   ) = 4.802e-04 S  per = 1.95  per(accum) = 4.54
 T(local opt: rmmtasks init                ) = 4.463e-04 S  per = 1.81  per(accum) = 6.36
 T(local opt: qops memset on cpu           ) = 3.900e-08 S  per = 0.000159  per(accum) = 6.36
 T(local opt: preprocess_renorm_batchGPU   ) = 9.841e-04 S  per =    4  per(accum) = 10.4
 T(local opt: deallocate cpu and gpu memory) = 3.526e-05 S  per = 0.143  per(accum) = 10.5
 T(local opt: construct opS [ifdists=true] ) = 2.139e-02 S  per = 86.9  per(accum) = 97.4
 T(local opt: reduction of opS & opH [nccl]) = 2.246e-05 S  per = 0.0913  per(accum) = 97.5
 T(local opt: qops memcpy gpu2cpu          ) = 8.534e-05 S  per = 0.347  per(accum) = 97.9
 T(local opt: reduction of opS & opH [mpi] ) = 1.320e-05 S  per = 0.0536  per(accum) = 97.9
 T(local opt: qops_pool join and erase     ) = 5.096e-04 S  per = 2.07  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 9.070e-07 S  per = 0.00369  per(accum) = 100
ctns::rcanon_save_site idx=2 scratch=./scratch/sweep size=400:3e-06GB T(load)=0.00053S speed=0.0056GB/S
##### sweep opt: 1.005e+00 S #####
 T(sweep opt: fetch) = 6.342e-02 S  per = 6.31  per(accum) = 6.31
 T(sweep opt: hdiag) = 1.520e-02 S  per = 1.51  per(accum) = 7.83
 T(sweep opt: dvdsn) = 5.221e-01 S  per =   52  per(accum) = 59.8
 T(sweep opt: decim) = 2.047e-02 S  per = 2.04  per(accum) = 61.8
 T(sweep opt: guess) = 9.823e-04 S  per = 0.0978  per(accum) = 61.9
 T(sweep opt: renrm) = 3.440e-01 S  per = 34.2  per(accum) = 96.2
 T(sweep opt: save ) = 3.838e-02 S  per = 3.82  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.221e-01 S  T(sum) = 5.125e-01 S  per = 9.816e+01
 T(sweep opt: preprocess                  ) = 1.270e-03 S  per = 0.248  per(accum) = 0.248
 T(sweep opt: symbolic_formulae           ) = 1.472e-02 S  per = 2.87  per(accum) = 3.12
 T(sweep opt: hintermediate init          ) = 1.090e-03 S  per = 0.213  per(accum) = 3.33
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.924e-02 S  per = 9.61  per(accum) = 12.9
 T(sweep opt: hmmtasks init               ) = 5.024e-02 S  per =  9.8  per(accum) = 22.7
 T(sweep opt: initial guess for dvdson    ) = 1.103e-04 S  per = 0.0215  per(accum) = 22.8
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.774e-01 S  per = 73.6  per(accum) = 96.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.158e-03 S  per = 0.616  per(accum) = 97
 T(sweep opt: dvdson [nccl]               ) = 6.308e-03 S  per = 1.23  per(accum) = 98.3
 T(sweep opt: dvdson [mpi]                ) = 5.850e-05 S  per = 0.0114  per(accum) = 98.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 8.874e-03 S  per = 1.73  per(accum) = 100
Detailed decomposition of T(renrm) = 3.440e-01 S  T(sum) = 3.440e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.228e-04 S  per = 0.268  per(accum) = 0.268
 T(sweep opt: qops init                    ) = 8.816e-03 S  per = 2.56  per(accum) = 2.83
 T(sweep opt: symbolic_formulae_renorm     ) = 8.829e-03 S  per = 2.57  per(accum) = 5.4
 T(sweep opt: allocate qops on gpu         ) = 1.253e-03 S  per = 0.364  per(accum) = 5.76
 T(sweep opt: site memcpy cpu2gpu          ) = 4.368e-04 S  per = 0.127  per(accum) = 5.89
 T(sweep opt: rintermediate init           ) = 9.476e-04 S  per = 0.276  per(accum) = 6.17
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.593e-02 S  per = 4.63  per(accum) = 10.8
 T(sweep opt: rmmtasks init                ) = 1.734e-02 S  per = 5.04  per(accum) = 15.8
 T(sweep opt: qops memset on cpu           ) = 8.750e-07 S  per = 0.000254  per(accum) = 15.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.739e-02 S  per = 7.96  per(accum) = 23.8
 T(sweep opt: deallocate cpu and gpu memory) = 2.578e-03 S  per = 0.749  per(accum) = 24.6
 T(sweep opt: construct opS [ifdists=true] ) = 2.368e-01 S  per = 68.8  per(accum) = 93.4
 T(sweep opt: reduction of opS & opH [nccl]) = 5.043e-04 S  per = 0.147  per(accum) = 93.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.088e-03 S  per = 0.607  per(accum) = 94.2
 T(sweep opt: reduction of opS & opH [mpi] ) = 4.840e-04 S  per = 0.141  per(accum) = 94.3
 T(sweep opt: qops_pool join and erase     ) = 1.279e-02 S  per = 3.72  per(accum) = 98
 T(sweep opt: conversion from opAB to opPQ ) = 6.832e-03 S  per = 1.99  per(accum) = 100
##### global opt: 1.005e+00 S #####
 T(global opt: fetch) = 6.342e-02 S  per = 6.31  per(accum) = 6.31
 T(global opt: hdiag) = 1.520e-02 S  per = 1.51  per(accum) = 7.83
 T(global opt: dvdsn) = 5.221e-01 S  per =   52  per(accum) = 59.8
 T(global opt: decim) = 2.047e-02 S  per = 2.04  per(accum) = 61.8
 T(global opt: guess) = 9.823e-04 S  per = 0.0978  per(accum) = 61.9
 T(global opt: renrm) = 3.440e-01 S  per = 34.2  per(accum) = 96.2
 T(global opt: save ) = 3.838e-02 S  per = 3.82  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.221e-01 S  T(sum) = 5.125e-01 S  per = 9.816e+01
 T(global opt: preprocess                  ) = 1.270e-03 S  per = 0.248  per(accum) = 0.248
 T(global opt: symbolic_formulae           ) = 1.472e-02 S  per = 2.87  per(accum) = 3.12
 T(global opt: hintermediate init          ) = 1.090e-03 S  per = 0.213  per(accum) = 3.33
 T(global opt: preprocess_hformulae_Hxlist ) = 4.924e-02 S  per = 9.61  per(accum) = 12.9
 T(global opt: hmmtasks init               ) = 5.024e-02 S  per =  9.8  per(accum) = 22.7
 T(global opt: initial guess for dvdson    ) = 1.103e-04 S  per = 0.0215  per(accum) = 22.8
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.774e-01 S  per = 73.6  per(accum) = 96.4
 T(global opt: dvdson [cpu-gpu]            ) = 3.158e-03 S  per = 0.616  per(accum) = 97
 T(global opt: dvdson [nccl]               ) = 6.308e-03 S  per = 1.23  per(accum) = 98.3
 T(global opt: dvdson [mpi]                ) = 5.850e-05 S  per = 0.0114  per(accum) = 98.3
 T(global opt: dvdson [rest part(linalg)]  ) = 8.874e-03 S  per = 1.73  per(accum) = 100
Detailed decomposition of T(renrm) = 3.440e-01 S  T(sum) = 3.440e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.228e-04 S  per = 0.268  per(accum) = 0.268
 T(global opt: qops init                    ) = 8.816e-03 S  per = 2.56  per(accum) = 2.83
 T(global opt: symbolic_formulae_renorm     ) = 8.829e-03 S  per = 2.57  per(accum) = 5.4
 T(global opt: allocate qops on gpu         ) = 1.253e-03 S  per = 0.364  per(accum) = 5.76
 T(global opt: site memcpy cpu2gpu          ) = 4.368e-04 S  per = 0.127  per(accum) = 5.89
 T(global opt: rintermediate init           ) = 9.476e-04 S  per = 0.276  per(accum) = 6.17
 T(global opt: preprocess_formulae_Rlist2   ) = 1.593e-02 S  per = 4.63  per(accum) = 10.8
 T(global opt: rmmtasks init                ) = 1.734e-02 S  per = 5.04  per(accum) = 15.8
 T(global opt: qops memset on cpu           ) = 8.750e-07 S  per = 0.000254  per(accum) = 15.8
 T(global opt: preprocess_renorm_batchGPU   ) = 2.739e-02 S  per = 7.96  per(accum) = 23.8
 T(global opt: deallocate cpu and gpu memory) = 2.578e-03 S  per = 0.749  per(accum) = 24.6
 T(global opt: construct opS [ifdists=true] ) = 2.368e-01 S  per = 68.8  per(accum) = 93.4
 T(global opt: reduction of opS & opH [nccl]) = 5.043e-04 S  per = 0.147  per(accum) = 93.5
 T(global opt: qops memcpy gpu2cpu          ) = 2.088e-03 S  per = 0.607  per(accum) = 94.2
 T(global opt: reduction of opS & opH [mpi] ) = 4.840e-04 S  per = 0.141  per(accum) = 94.3
 T(global opt: qops_pool join and erase     ) = 1.279e-02 S  per = 3.72  per(accum) = 98
 T(global opt: conversion from opAB to opPQ ) = 6.832e-03 S  per = 1.99  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-2.428e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=19/seqsize=34 dots=1 dbond=(15,0)-(16,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=4 scratch=./scratch/sweep size=464:3.46e-06GB T(load)=2.83e-04S speed=1.22e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=595:4.54e-03MB:4.43e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=245:1.87e-03MB:1.83e-06GB
total mem of comb=988:7.54e-03MB:7.36e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=6.542e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=16,3,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 11 16 17 18 19
 suppr= 13 14 15
 suppc= 12
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(15,0)
 fqop[1]=./scratch/sweep/rop(17,0)
 fqop[2]=./scratch/sweep/cop(16,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:32 S:4 H:1 P:14 Q:18 
        dim(bra,ket)=24,24 size(op)=104:7.935e-04MB size(tot)=3760:2.869e-02MB:2.801e-05GB
        per(mem): C:49.4 S:4.79 H:2.77 P:11 Q:32.1 
 rqops: oplist=CSHAB nops=C:6 S:17 H:1 A:7 B:11 
        dim(bra,ket)=64,64 size(op)=400:0.00305MB size(tot)=12085:0.0922MB:9e-05GB
        per(mem): C:14.9 S:42.2 H:3.31 A:10.4 B:29.2 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=18181:0.139MB:0.000135GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.844e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(16,0) fdel=./scratch/sweep/lop(15,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-3.016e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(24,64,4) nnz=245:1.869e-03MB
qtensor3: wf3 own=1 _data=0x55b2c5c17000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=7 dimAll=24
 (24,2):6 (26,2):5 (25,3):4 (25,1):4 (23,1):3 (27,3):1 (26,4):1
 qbond: qcol nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=17 nblocks=448 size=245:1.869e-03MB
### DIAG TIMING: total=2.887e-04 t1=1.645e-05, t2=1.227e-05, t3=1.351e-05, t4=1.908e-04, t5=1.037e-05, t6=3.793e-05, t7=7.345e-06
duration_diagGPU:3.034e-04
duration_diagreduce:4.300e-08
duration_diagtransform:3.990e-07
----- TIMING FOR symbolic_formulae_onedot with size=150 : 3.102e-04 S -----
rank=0 GPUmem(GB): used=1.355e-04 (oper)=1.355e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=150
 no. of hintermediate operators=57
 no. of coefficients=912:6.958e-03MB:6.795e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.150e-05 S -----
rank=0 GPUmem(GB): used=1.423e-04 (oper,hinter)=1.355e-04,6.795e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.670e-04 S size(H_formulae)=150 size(Hxlst2)=17 T(Hmu/Hxlist)=6.003e-05,3.069e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 5.074e-04 S size(H_formulae)=150 size(Hxlst)=1562 -----
rank=0 GPUmem(GB): used=1.423e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=3.651e-06 batch[need]=1.548e-03 blksize=54 blksize0=24 batchsize=1562
rank=0 GPUmem(GB): used=1.694e-03 (oper,hinter,dvdson,batch)=1.355e-04,6.795e-06,3.651e-06,1.548e-03
ctns::pdvdsonSolver_nkr::solve_iter ndim=245 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.971e-05,8.687e-05,8.659e-04,2.138e-04,1.243e-03
 analyze_tgpu[Hx]: ndim=245:1.825e-06GB T(cpu-gpu)=2.163e-05 speed=1.688e-01GB/S T(nccl)=4.808e-05 speed=7.594e-02GB/S
----- TIMING FOR sigma : t_inter=8.7e-05 t_gemm=8.7e-04 t_reduction=2.1e-04 tot=1.2e-03 -----
 sigma[inter] counter=132 t=8.7e-05 per=7.4e+00 cost=2.4e+05 flops=2.8e+09
 sigma[gemm] counter=132 i=0 t=1.8e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=1 t=1.6e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=132 i=2 t=2.0e-04 per=1.7e+01 cost=9.5e+04 flops=4.8e+08
 sigma[gemm] counter=132 i=3 t=2.1e-04 per=1.8e+01 cost=9.5e+04 flops=4.5e+08
 sigma[gemm] counter=132 i=4 t=2.6e-04 per=2.3e+01 cost=7.6e+04 flops=2.9e+08
 sigma[gemm] counter=132 i=5 t=1.9e-04 per=1.6e+01 cost=8.9e+04 flops=4.7e+08
 sigma[gemm] counter=132 total t=8.7e-04 per=7.4e+01 cost=3.6e+05 flops=4.1e+08
 sigma[red] counter=132 t=2.1e-04 per=1.8e+01 cost=4.8e+04 flops=2.2e+08
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=3.0e-01 t_reduction=4.1e-02 tot=3.6e-01 -----
 sigma_tot[inter] counter=132 t=1.7e-02 per=4.8e+00 cost=5.2e+08 flops=3.1e+10
 sigma_tot[gemm] counter=132 i=0 t=2.8e-04 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=1 t=2.6e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=132 i=2 t=7.2e-02 per=2.0e+01 cost=4.7e+08 flops=6.5e+09
 sigma_tot[gemm] counter=132 i=3 t=9.0e-02 per=2.5e+01 cost=4.6e+08 flops=5.1e+09
 sigma_tot[gemm] counter=132 i=4 t=6.7e-02 per=1.9e+01 cost=3.9e+08 flops=5.8e+09
 sigma_tot[gemm] counter=132 i=5 t=6.8e-02 per=1.9e+01 cost=4.0e+08 flops=5.8e+09
 sigma_tot[gemm] counter=132 total t=3.0e-01 per=8.4e+01 cost=1.7e+09 flops=5.8e+09
 sigma_tot[red] counter=132 t=4.1e-02 per=1.2e+01 cost=1.1e+08 flops=2.7e+09
T(sub)=7.7e-06 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,2.6e-06,1.0e-06,9.9e-07,2.1e-07
settings: ndim=245 neig=1 maxcycle=30 nbuff=4 memory=3e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.540655294172 -1.117e+03  3.376e-02    1     1  1.420e-03 1.420e-03 1.389e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.222e-05,8.171e-05,9.831e-04,2.350e-04,1.366e-03
 analyze_tgpu[Hx]: ndim=245:1.825e-06GB T(cpu-gpu)=2.110e-05 speed=1.730e-01GB/S T(nccl)=4.112e-05 speed=8.879e-02GB/S
----- TIMING FOR sigma : t_inter=8.2e-05 t_gemm=9.8e-04 t_reduction=2.3e-04 tot=1.3e-03 -----
 sigma[inter] counter=133 t=8.2e-05 per=6.3e+00 cost=2.4e+05 flops=2.9e+09
 sigma[gemm] counter=133 i=0 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=1 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=133 i=2 t=2.4e-04 per=1.8e+01 cost=9.5e+04 flops=4.0e+08
 sigma[gemm] counter=133 i=3 t=2.6e-04 per=2.0e+01 cost=9.5e+04 flops=3.6e+08
 sigma[gemm] counter=133 i=4 t=2.5e-04 per=1.9e+01 cost=7.6e+04 flops=3.1e+08
 sigma[gemm] counter=133 i=5 t=2.3e-04 per=1.8e+01 cost=8.9e+04 flops=3.8e+08
 sigma[gemm] counter=133 total t=9.8e-04 per=7.6e+01 cost=3.6e+05 flops=3.6e+08
 sigma[red] counter=133 t=2.3e-04 per=1.8e+01 cost=4.8e+04 flops=2.0e+08
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=3.0e-01 t_reduction=4.1e-02 tot=3.6e-01 -----
 sigma_tot[inter] counter=133 t=1.7e-02 per=4.8e+00 cost=5.2e+08 flops=3.1e+10
 sigma_tot[gemm] counter=133 i=0 t=2.9e-04 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=1 t=2.7e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=133 i=2 t=7.2e-02 per=2.0e+01 cost=4.7e+08 flops=6.5e+09
 sigma_tot[gemm] counter=133 i=3 t=9.0e-02 per=2.5e+01 cost=4.6e+08 flops=5.1e+09
 sigma_tot[gemm] counter=133 i=4 t=6.7e-02 per=1.9e+01 cost=3.9e+08 flops=5.8e+09
 sigma_tot[gemm] counter=133 i=5 t=6.8e-02 per=1.9e+01 cost=4.0e+08 flops=5.8e+09
 sigma_tot[gemm] counter=133 total t=3.0e-01 per=8.4e+01 cost=1.7e+09 flops=5.7e+09
 sigma_tot[red] counter=133 t=4.1e-02 per=1.2e+01 cost=1.1e+08 flops=2.7e+09
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=6.0e-06,9.5e-06,3.2e-06,1.6e-06,2.6e-07
    2   0 -    -116.541822713816 -1.167e-03  6.847e-03    2     2  2.976e-03 1.488e-03 1.439e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.091e-05,7.871e-05,9.828e-04,2.321e-04,1.359e-03
 analyze_tgpu[Hx]: ndim=245:1.825e-06GB T(cpu-gpu)=2.073e-05 speed=1.761e-01GB/S T(nccl)=4.018e-05 speed=9.086e-02GB/S
----- TIMING FOR sigma : t_inter=7.9e-05 t_gemm=9.8e-04 t_reduction=2.3e-04 tot=1.3e-03 -----
 sigma[inter] counter=134 t=7.9e-05 per=6.1e+00 cost=2.4e+05 flops=3.0e+09
 sigma[gemm] counter=134 i=0 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=1 t=1.9e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=134 i=2 t=2.3e-04 per=1.8e+01 cost=9.5e+04 flops=4.1e+08
 sigma[gemm] counter=134 i=3 t=2.6e-04 per=2.0e+01 cost=9.5e+04 flops=3.6e+08
 sigma[gemm] counter=134 i=4 t=2.5e-04 per=2.0e+01 cost=7.6e+04 flops=3.0e+08
 sigma[gemm] counter=134 i=5 t=2.3e-04 per=1.8e+01 cost=8.9e+04 flops=3.9e+08
 sigma[gemm] counter=134 total t=9.8e-04 per=7.6e+01 cost=3.6e+05 flops=3.6e+08
 sigma[red] counter=134 t=2.3e-04 per=1.8e+01 cost=4.8e+04 flops=2.1e+08
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=3.0e-01 t_reduction=4.2e-02 tot=3.6e-01 -----
 sigma_tot[inter] counter=134 t=1.7e-02 per=4.8e+00 cost=5.2e+08 flops=3.1e+10
 sigma_tot[gemm] counter=134 i=0 t=2.9e-04 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=1 t=2.7e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=134 i=2 t=7.2e-02 per=2.0e+01 cost=4.7e+08 flops=6.4e+09
 sigma_tot[gemm] counter=134 i=3 t=9.1e-02 per=2.5e+01 cost=4.6e+08 flops=5.1e+09
 sigma_tot[gemm] counter=134 i=4 t=6.8e-02 per=1.9e+01 cost=3.9e+08 flops=5.7e+09
 sigma_tot[gemm] counter=134 i=5 t=6.8e-02 per=1.9e+01 cost=4.0e+08 flops=5.8e+09
 sigma_tot[gemm] counter=134 total t=3.0e-01 per=8.4e+01 cost=1.7e+09 flops=5.7e+09
 sigma_tot[red] counter=134 t=4.2e-02 per=1.2e+01 cost=1.1e+08 flops=2.7e+09
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.3e-05,2.0e-06,1.8e-06,2.6e-07
    3   0 -    -116.541897155055 -7.444e-05  2.125e-03    3     3  4.461e-03 1.487e-03 1.440e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.071e-05,7.612e-05,9.776e-04,2.334e-04,1.351e-03
 analyze_tgpu[Hx]: ndim=245:1.825e-06GB T(cpu-gpu)=2.034e-05 speed=1.795e-01GB/S T(nccl)=4.037e-05 speed=9.043e-02GB/S
----- TIMING FOR sigma : t_inter=7.6e-05 t_gemm=9.8e-04 t_reduction=2.3e-04 tot=1.3e-03 -----
 sigma[inter] counter=135 t=7.6e-05 per=5.9e+00 cost=2.4e+05 flops=3.1e+09
 sigma[gemm] counter=135 i=0 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=1 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=135 i=2 t=2.4e-04 per=1.8e+01 cost=9.5e+04 flops=4.0e+08
 sigma[gemm] counter=135 i=3 t=2.6e-04 per=2.0e+01 cost=9.5e+04 flops=3.7e+08
 sigma[gemm] counter=135 i=4 t=2.5e-04 per=1.9e+01 cost=7.6e+04 flops=3.1e+08
 sigma[gemm] counter=135 i=5 t=2.3e-04 per=1.8e+01 cost=8.9e+04 flops=3.8e+08
 sigma[gemm] counter=135 total t=9.8e-04 per=7.6e+01 cost=3.6e+05 flops=3.6e+08
 sigma[red] counter=135 t=2.3e-04 per=1.8e+01 cost=4.8e+04 flops=2.0e+08
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=3.0e-01 t_reduction=4.2e-02 tot=3.6e-01 -----
 sigma_tot[inter] counter=135 t=1.7e-02 per=4.8e+00 cost=5.2e+08 flops=3.0e+10
 sigma_tot[gemm] counter=135 i=0 t=2.9e-04 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=1 t=2.7e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=135 i=2 t=7.3e-02 per=2.0e+01 cost=4.7e+08 flops=6.4e+09
 sigma_tot[gemm] counter=135 i=3 t=9.1e-02 per=2.5e+01 cost=4.6e+08 flops=5.1e+09
 sigma_tot[gemm] counter=135 i=4 t=6.8e-02 per=1.9e+01 cost=3.9e+08 flops=5.7e+09
 sigma_tot[gemm] counter=135 i=5 t=6.9e-02 per=1.9e+01 cost=4.0e+08 flops=5.8e+09
 sigma_tot[gemm] counter=135 total t=3.0e-01 per=8.4e+01 cost=1.7e+09 flops=5.7e+09
 sigma_tot[red] counter=135 t=4.2e-02 per=1.2e+01 cost=1.1e+08 flops=2.7e+09
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.1e-05,1.8e-06,1.6e-06,2.3e-07
    4   0 -    -116.541904408816 -7.254e-06  8.321e-04    3     4  5.932e-03 1.483e-03 1.438e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.968e-05,7.645e-05,9.712e-04,2.304e-04,1.341e-03
 analyze_tgpu[Hx]: ndim=245:1.825e-06GB T(cpu-gpu)=1.999e-05 speed=1.826e-01GB/S T(nccl)=3.969e-05 speed=9.198e-02GB/S
----- TIMING FOR sigma : t_inter=7.6e-05 t_gemm=9.7e-04 t_reduction=2.3e-04 tot=1.3e-03 -----
 sigma[inter] counter=136 t=7.6e-05 per=6.0e+00 cost=2.4e+05 flops=3.1e+09
 sigma[gemm] counter=136 i=0 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=1 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=136 i=2 t=2.3e-04 per=1.8e+01 cost=9.5e+04 flops=4.1e+08
 sigma[gemm] counter=136 i=3 t=2.6e-04 per=2.0e+01 cost=9.5e+04 flops=3.7e+08
 sigma[gemm] counter=136 i=4 t=2.5e-04 per=2.0e+01 cost=7.6e+04 flops=3.0e+08
 sigma[gemm] counter=136 i=5 t=2.3e-04 per=1.8e+01 cost=8.9e+04 flops=3.9e+08
 sigma[gemm] counter=136 total t=9.7e-04 per=7.6e+01 cost=3.6e+05 flops=3.7e+08
 sigma[red] counter=136 t=2.3e-04 per=1.8e+01 cost=4.8e+04 flops=2.1e+08
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=3.0e-01 t_reduction=4.2e-02 tot=3.6e-01 -----
 sigma_tot[inter] counter=136 t=1.7e-02 per=4.8e+00 cost=5.3e+08 flops=3.0e+10
 sigma_tot[gemm] counter=136 i=0 t=2.9e-04 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=1 t=2.7e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=136 i=2 t=7.3e-02 per=2.0e+01 cost=4.7e+08 flops=6.4e+09
 sigma_tot[gemm] counter=136 i=3 t=9.1e-02 per=2.5e+01 cost=4.6e+08 flops=5.1e+09
 sigma_tot[gemm] counter=136 i=4 t=6.8e-02 per=1.9e+01 cost=3.9e+08 flops=5.7e+09
 sigma_tot[gemm] counter=136 i=5 t=6.9e-02 per=1.9e+01 cost=4.0e+08 flops=5.8e+09
 sigma_tot[gemm] counter=136 total t=3.0e-01 per=8.4e+01 cost=1.7e+09 flops=5.7e+09
 sigma_tot[red] counter=136 t=4.2e-02 per=1.2e+01 cost=1.1e+08 flops=2.7e+09
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.1e-05,1.9e-06,1.6e-06,2.2e-07
    5   0 -    -116.541905750320 -1.342e-06  3.444e-04    3     5  7.457e-03 1.491e-03 1.446e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.067e-05,7.624e-05,9.777e-04,2.314e-04,1.350e-03
 analyze_tgpu[Hx]: ndim=245:1.825e-06GB T(cpu-gpu)=2.112e-05 speed=1.729e-01GB/S T(nccl)=3.955e-05 speed=9.231e-02GB/S
----- TIMING FOR sigma : t_inter=7.6e-05 t_gemm=9.8e-04 t_reduction=2.3e-04 tot=1.3e-03 -----
 sigma[inter] counter=137 t=7.6e-05 per=5.9e+00 cost=2.4e+05 flops=3.1e+09
 sigma[gemm] counter=137 i=0 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=1 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=137 i=2 t=2.3e-04 per=1.8e+01 cost=9.5e+04 flops=4.0e+08
 sigma[gemm] counter=137 i=3 t=2.6e-04 per=2.0e+01 cost=9.5e+04 flops=3.7e+08
 sigma[gemm] counter=137 i=4 t=2.5e-04 per=1.9e+01 cost=7.6e+04 flops=3.1e+08
 sigma[gemm] counter=137 i=5 t=2.3e-04 per=1.8e+01 cost=8.9e+04 flops=3.8e+08
 sigma[gemm] counter=137 total t=9.8e-04 per=7.6e+01 cost=3.6e+05 flops=3.6e+08
 sigma[red] counter=137 t=2.3e-04 per=1.8e+01 cost=4.8e+04 flops=2.1e+08
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=3.0e-01 t_reduction=4.2e-02 tot=3.6e-01 -----
 sigma_tot[inter] counter=137 t=1.7e-02 per=4.8e+00 cost=5.3e+08 flops=3.0e+10
 sigma_tot[gemm] counter=137 i=0 t=2.9e-04 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=1 t=2.7e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=137 i=2 t=7.3e-02 per=2.0e+01 cost=4.7e+08 flops=6.4e+09
 sigma_tot[gemm] counter=137 i=3 t=9.1e-02 per=2.5e+01 cost=4.6e+08 flops=5.0e+09
 sigma_tot[gemm] counter=137 i=4 t=6.8e-02 per=1.9e+01 cost=3.9e+08 flops=5.7e+09
 sigma_tot[gemm] counter=137 i=5 t=6.9e-02 per=1.9e+01 cost=4.0e+08 flops=5.7e+09
 sigma_tot[gemm] counter=137 total t=3.0e-01 per=8.4e+01 cost=1.7e+09 flops=5.7e+09
 sigma_tot[red] counter=137 t=4.2e-02 per=1.2e+01 cost=1.1e+08 flops=2.7e+09
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.8e-06,1.1e-05,1.9e-06,1.5e-06,2.0e-07
    6   0 -    -116.541906000151 -2.498e-07  1.486e-04    3     6  9.057e-03 1.510e-03 1.464e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.000e-05,7.640e-05,9.755e-04,2.296e-04,1.345e-03
 analyze_tgpu[Hx]: ndim=245:1.825e-06GB T(cpu-gpu)=2.039e-05 speed=1.790e-01GB/S T(nccl)=3.961e-05 speed=9.217e-02GB/S
----- TIMING FOR sigma : t_inter=7.6e-05 t_gemm=9.8e-04 t_reduction=2.3e-04 tot=1.3e-03 -----
 sigma[inter] counter=138 t=7.6e-05 per=6.0e+00 cost=2.4e+05 flops=3.1e+09
 sigma[gemm] counter=138 i=0 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=1 t=1.9e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=138 i=2 t=2.3e-04 per=1.8e+01 cost=9.5e+04 flops=4.1e+08
 sigma[gemm] counter=138 i=3 t=2.6e-04 per=2.0e+01 cost=9.5e+04 flops=3.6e+08
 sigma[gemm] counter=138 i=4 t=2.5e-04 per=1.9e+01 cost=7.6e+04 flops=3.1e+08
 sigma[gemm] counter=138 i=5 t=2.3e-04 per=1.8e+01 cost=8.9e+04 flops=3.9e+08
 sigma[gemm] counter=138 total t=9.8e-04 per=7.6e+01 cost=3.6e+05 flops=3.6e+08
 sigma[red] counter=138 t=2.3e-04 per=1.8e+01 cost=4.8e+04 flops=2.1e+08
----- TIMING FOR sigma_tot : t_inter=1.7e-02 t_gemm=3.0e-01 t_reduction=4.2e-02 tot=3.6e-01 -----
 sigma_tot[inter] counter=138 t=1.7e-02 per=4.8e+00 cost=5.3e+08 flops=3.0e+10
 sigma_tot[gemm] counter=138 i=0 t=2.9e-04 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=1 t=2.8e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=138 i=2 t=7.3e-02 per=2.0e+01 cost=4.7e+08 flops=6.4e+09
 sigma_tot[gemm] counter=138 i=3 t=9.2e-02 per=2.5e+01 cost=4.6e+08 flops=5.0e+09
 sigma_tot[gemm] counter=138 i=4 t=6.9e-02 per=1.9e+01 cost=3.9e+08 flops=5.7e+09
 sigma_tot[gemm] counter=138 i=5 t=6.9e-02 per=1.9e+01 cost=4.0e+08 flops=5.7e+09
 sigma_tot[gemm] counter=138 total t=3.0e-01 per=8.3e+01 cost=1.7e+09 flops=5.7e+09
 sigma_tot[red] counter=138 t=4.2e-02 per=1.2e+01 cost=1.1e+08 flops=2.6e+09
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.1e-05,1.9e-06,1.6e-06,2.0e-07
    7   0 +    -116.541906050312 -5.016e-08  6.885e-05    3     7  1.052e-02 1.504e-03 1.459e-03
TIMING FOR Davidson : 1.053e-02  T(cal/comm/rest)=1.021e-02,1.550e-06,3.192e-04
decomposed t_rest=3.192e-04
 T(sub)    =1.275e-04 per=3.995e+01
 T(precond)=1.940e-05 per=6.079e+00
 T(ortho)  =1.165e-05 per=3.650e+00
 T(xcopy)  =9.890e-07 per=3.099e-01
 T(xnrm2)  =1.446e-06 per=4.530e-01
 T(other)  =1.582e-04 per=4.956e+01
optimized energies: isweep=0 ibond=19 dots=1 e[0]=-116.541906050312 nmvp=7
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=5.224e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=25 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond19.txt
 qbond: qsuper nsym=25 dimAll=256
 (0,0):1 (2,0):16 (1,1):4 (1,-1):4 (4,0):36 (3,1):24 (3,-1):24 (2,2):6 (2,-2):6 (6,0):16 (5,1):24 (5,-1):24 (4,2):16 (4,-2):16 (3,3):4 (3,-3):4 (8,0):1 (7,1):4 (7,-1):4 (6,2):6 (6,-2):6 (5,3):4 (5,-3):4 (4,4):1 (4,-4):1
timing for divide=2.6e-06
timing for compute=5.7e-05
timing for collect=4.7e-06
----- TMING FOR decimation_genbasis(nkr): 6.4e-05 S T(divide/compute[cpu/gpu/rest]/collect)=2.6e-06,5.5e-05,0.0e+00,2.0e-06,4.7e-06 -----
decimation summary: 256->24 dwt=+3.331e-16 SvN=1.431e+00
 qbond: qkept nsym=7 dimAll=24
 (6,-2):6 (4,-2):5 (5,-1):4 (5,-3):4 (7,-1):3 (3,-3):1 (4,-4):1
----- TIMING for decimation_row(nkr): 9.851e-04 S T(decim/select/formRot)=9.586e-05,8.304e-04,5.882e-05 -----
----- TIMING FOR onedot_decimation: 1.028e-03 S T(wf/decim)=3.137e-05,9.967e-04 -----
ctns::oper_renorm coord=(16,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:8 S:16 H:1 A:14 B:18 
        dim(bra,ket)=24,24 size(op)=104:7.935e-04MB size(tot)=2908:2.219e-02MB:2.167e-05GB
        per(mem): C:16 S:24.8 H:3.58 A:14.2 B:41.5 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=7.033e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=41 : 4.990e-05 S -----
rank=0 GPUmem(GB): used=1.359e-04 (oper)=1.291e-04
rank=0 GPUmem(GB): used=1.377e-04 (oper,site)=1.291e-04,1.825e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=41
 no. of rintermediate operators=6
 no. of coefficients=32:2.441e-04MB:2.384e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.971e-05 S -----
rank=0 GPUmem(GB): used=1.380e-04 (oper,site,rinter)=1.291e-04,1.825e-06,2.384e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 1.508e-04 S size(rtasks)=41 size(Rlst2)=49 T(Rmu/Rlist)=2.679e-05,1.240e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.727e-04 S size(rtasks)=41 size(Rlst)=451 -----
rank=0 GPUmem(GB): used=1.380e-04 avail=3.829e+01 total=3.829e+01 batch[need]=5.780e-04 blksize=45 blksize0=81 batchsize=451
rank=0 GPUmem(GB): used=7.159e-04 (oper,site,rinter,batch)=1.291e-04,1.825e-06,2.384e-07,5.780e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=9.371e-05,7.058e-04,2.396e-04
----- TIMING FOR renorm : t_inter=9.4e-05 t_gemm=7.1e-04 t_reduction=2.4e-04 tot=1.0e-03 -----
 renorm[inter] counter=428 t=9.4e-05 per=9.0e+00 cost=2.1e+04 flops=2.3e+08
 renorm[gemm] counter=428 i=0 t=2.7e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=428 i=1 t=2.0e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=428 i=2 t=2.1e-04 per=2.0e+01 cost=1.8e+04 flops=8.6e+07
 renorm[gemm] counter=428 i=3 t=2.5e-04 per=2.4e+01 cost=4.3e+04 flops=1.8e+08
 renorm[gemm] counter=428 i=4 t=1.9e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=428 i=5 t=1.9e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=428 i=6 t=2.4e-04 per=2.4e+01 cost=5.9e+04 flops=2.4e+08
 renorm[gemm] counter=428 total t=7.1e-04 per=6.8e+01 cost=1.2e+05 flops=1.7e+08
 renorm[red] counter=428 t=2.4e-04 per=2.3e+01 cost=1.5e+04 flops=6.4e+07
----- TIMING FOR renorm_tot : t_inter=2.4e-03 t_gemm=1.9e-02 t_reduction=4.8e-03 tot=2.6e-02 -----
 renorm_tot[inter] counter=428 t=2.4e-03 per=9.3e+00 cost=1.6e+07 flops=6.9e+09
 renorm_tot[gemm] counter=428 i=0 t=4.3e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=428 i=1 t=3.8e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=428 i=2 t=4.7e-04 per=1.8e+00 cost=3.0e+04 flops=6.3e+07
 renorm_tot[gemm] counter=428 i=3 t=5.4e-04 per=2.1e+00 cost=7.0e+04 flops=1.3e+08
 renorm_tot[gemm] counter=428 i=4 t=4.6e-03 per=1.8e+01 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=428 i=5 t=6.4e-03 per=2.5e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=428 i=6 t=6.5e-03 per=2.5e+01 cost=4.5e+07 flops=6.9e+09
 renorm_tot[gemm] counter=428 total t=1.9e-02 per=7.2e+01 cost=7.9e+07 flops=4.2e+09
 renorm_tot[red] counter=428 t=4.8e-03 per=1.8e+01 cost=5.4e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.431e-04 (oper)=1.296e-04
rank=0 GPUmem(GB): used=1.449e-04 (oper,site,rinter)=1.296e-04,1.825e-06,6.437e-06
rank=0 GPUmem(GB): used=1.824e-04 (oper,site,rinter,batch)=1.296e-04,1.825e-06,6.437e-06,3.749e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.553e-02 S T(preprocess/alloc/comp/red/dealloc)=2.087e-03,2.216e-03,1.161e-02,1.459e-03,1.967e-04 -----
----- TIMING FOR oper_renorm_opS : 1.558e-02 S rank=0 -----
qops.to_cpu: size(tot)=2908:2.219e-02MB:2.167e-05GB T(to_cpu)=3.081e-05S speed=7.032e-01GB/S
check ||H-H.dagger||=1.184e-14 coord=(16,0) rank=0
----- TIMING FOR oper_renorm : 0.0177 S rank=0 -----
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.473e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.324e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-4.396e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 3.637e-02 S #####
 T(local opt: fetch) = 2.690e-03 S  per =  7.4  per(accum) = 7.4
 T(local opt: hdiag) = 3.679e-04 S  per = 1.01  per(accum) = 8.41
 T(local opt: dvdsn) = 1.223e-02 S  per = 33.6  per(accum) = 42
 T(local opt: decim) = 1.053e-03 S  per = 2.89  per(accum) = 44.9
 T(local opt: guess) = 4.664e-05 S  per = 0.128  per(accum) = 45
 T(local opt: renrm) = 1.819e-02 S  per =   50  per(accum) = 95.1
 T(local opt: save ) = 1.797e-03 S  per = 4.94  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.223e-02 S  T(sum) = 1.201e-02 S  per = 9.825e+01
 T(local opt: preprocess                  ) = 8.196e-05 S  per = 0.682  per(accum) = 0.682
 T(local opt: symbolic_formulae           ) = 3.213e-04 S  per = 2.67  per(accum) = 3.36
 T(local opt: hintermediate init          ) = 5.806e-05 S  per = 0.483  per(accum) = 3.84
 T(local opt: preprocess_hformulae_Hxlist ) = 5.201e-04 S  per = 4.33  per(accum) = 8.17
 T(local opt: hmmtasks init               ) = 4.933e-04 S  per = 4.11  per(accum) = 12.3
 T(local opt: initial guess for dvdson    ) = 2.627e-06 S  per = 0.0219  per(accum) = 12.3
 T(local opt: dvdson [Hx_batchGPU]        ) = 9.780e-03 S  per = 81.4  per(accum) = 93.7
 T(local opt: dvdson [cpu-gpu]            ) = 1.453e-04 S  per = 1.21  per(accum) = 94.9
 T(local opt: dvdson [nccl]               ) = 2.886e-04 S  per =  2.4  per(accum) = 97.3
 T(local opt: dvdson [mpi]                ) = 1.550e-06 S  per = 0.0129  per(accum) = 97.3
 T(local opt: dvdson [rest part(linalg)]  ) = 3.192e-04 S  per = 2.66  per(accum) = 100
Detailed decomposition of T(renrm) = 1.819e-02 S  T(sum) = 1.819e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.749e-05 S  per = 0.261  per(accum) = 0.261
 T(local opt: qops init                    ) = 2.486e-04 S  per = 1.37  per(accum) = 1.63
 T(local opt: symbolic_formulae_renorm     ) = 5.393e-05 S  per = 0.296  per(accum) = 1.92
 T(local opt: allocate qops on gpu         ) = 5.682e-05 S  per = 0.312  per(accum) = 2.24
 T(local opt: site memcpy cpu2gpu          ) = 1.940e-05 S  per = 0.107  per(accum) = 2.34
 T(local opt: rintermediate init           ) = 2.618e-05 S  per = 0.144  per(accum) = 2.49
 T(local opt: preprocess_formulae_Rlist2   ) = 1.771e-04 S  per = 0.974  per(accum) = 3.46
 T(local opt: rmmtasks init                ) = 2.222e-04 S  per = 1.22  per(accum) = 4.68
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 0.000181  per(accum) = 4.68
 T(local opt: preprocess_renorm_batchGPU   ) = 1.121e-03 S  per = 6.16  per(accum) = 10.8
 T(local opt: deallocate cpu and gpu memory) = 2.396e-05 S  per = 0.132  per(accum) = 11
 T(local opt: construct opS [ifdists=true] ) = 1.562e-02 S  per = 85.9  per(accum) = 96.8
 T(local opt: reduction of opS & opH [nccl]) = 2.162e-05 S  per = 0.119  per(accum) = 97
 T(local opt: qops memcpy gpu2cpu          ) = 4.152e-05 S  per = 0.228  per(accum) = 97.2
 T(local opt: reduction of opS & opH [mpi] ) = 4.756e-05 S  per = 0.261  per(accum) = 97.5
 T(local opt: qops_pool join and erase     ) = 4.626e-04 S  per = 2.54  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 9.180e-07 S  per = 0.00505  per(accum) = 100
ctns::rcanon_save_site idx=3 scratch=./scratch/sweep size=245:1.8e-06GB T(load)=0.00053S speed=0.0034GB/S
##### sweep opt: 1.041e+00 S #####
 T(sweep opt: fetch) = 6.611e-02 S  per = 6.35  per(accum) = 6.35
 T(sweep opt: hdiag) = 1.556e-02 S  per =  1.5  per(accum) = 7.85
 T(sweep opt: dvdsn) = 5.344e-01 S  per = 51.3  per(accum) = 59.2
 T(sweep opt: decim) = 2.152e-02 S  per = 2.07  per(accum) = 61.3
 T(sweep opt: guess) = 1.029e-03 S  per = 0.0988  per(accum) = 61.3
 T(sweep opt: renrm) = 3.621e-01 S  per = 34.8  per(accum) = 96.1
 T(sweep opt: save ) = 4.017e-02 S  per = 3.86  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.344e-01 S  T(sum) = 5.245e-01 S  per = 9.816e+01
 T(sweep opt: preprocess                  ) = 1.352e-03 S  per = 0.258  per(accum) = 0.258
 T(sweep opt: symbolic_formulae           ) = 1.504e-02 S  per = 2.87  per(accum) = 3.12
 T(sweep opt: hintermediate init          ) = 1.148e-03 S  per = 0.219  per(accum) = 3.34
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.976e-02 S  per = 9.49  per(accum) = 12.8
 T(sweep opt: hmmtasks init               ) = 5.074e-02 S  per = 9.67  per(accum) = 22.5
 T(sweep opt: initial guess for dvdson    ) = 1.129e-04 S  per = 0.0215  per(accum) = 22.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.872e-01 S  per = 73.8  per(accum) = 96.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.304e-03 S  per = 0.63  per(accum) = 97
 T(sweep opt: dvdson [nccl]               ) = 6.596e-03 S  per = 1.26  per(accum) = 98.2
 T(sweep opt: dvdson [mpi]                ) = 6.005e-05 S  per = 0.0114  per(accum) = 98.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 9.194e-03 S  per = 1.75  per(accum) = 100
Detailed decomposition of T(renrm) = 3.621e-01 S  T(sum) = 3.621e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.703e-04 S  per = 0.268  per(accum) = 0.268
 T(sweep opt: qops init                    ) = 9.065e-03 S  per =  2.5  per(accum) = 2.77
 T(sweep opt: symbolic_formulae_renorm     ) = 8.883e-03 S  per = 2.45  per(accum) = 5.22
 T(sweep opt: allocate qops on gpu         ) = 1.310e-03 S  per = 0.362  per(accum) = 5.59
 T(sweep opt: site memcpy cpu2gpu          ) = 4.562e-04 S  per = 0.126  per(accum) = 5.71
 T(sweep opt: rintermediate init           ) = 9.738e-04 S  per = 0.269  per(accum) = 5.98
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.611e-02 S  per = 4.45  per(accum) = 10.4
 T(sweep opt: rmmtasks init                ) = 1.757e-02 S  per = 4.85  per(accum) = 15.3
 T(sweep opt: qops memset on cpu           ) = 9.080e-07 S  per = 0.000251  per(accum) = 15.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.852e-02 S  per = 7.87  per(accum) = 23.2
 T(sweep opt: deallocate cpu and gpu memory) = 2.602e-03 S  per = 0.718  per(accum) = 23.9
 T(sweep opt: construct opS [ifdists=true] ) = 2.524e-01 S  per = 69.7  per(accum) = 93.6
 T(sweep opt: reduction of opS & opH [nccl]) = 5.259e-04 S  per = 0.145  per(accum) = 93.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.130e-03 S  per = 0.588  per(accum) = 94.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.315e-04 S  per = 0.147  per(accum) = 94.5
 T(sweep opt: qops_pool join and erase     ) = 1.325e-02 S  per = 3.66  per(accum) = 98.1
 T(sweep opt: conversion from opAB to opPQ ) = 6.833e-03 S  per = 1.89  per(accum) = 100
##### global opt: 1.041e+00 S #####
 T(global opt: fetch) = 6.611e-02 S  per = 6.35  per(accum) = 6.35
 T(global opt: hdiag) = 1.556e-02 S  per =  1.5  per(accum) = 7.85
 T(global opt: dvdsn) = 5.344e-01 S  per = 51.3  per(accum) = 59.2
 T(global opt: decim) = 2.152e-02 S  per = 2.07  per(accum) = 61.3
 T(global opt: guess) = 1.029e-03 S  per = 0.0988  per(accum) = 61.3
 T(global opt: renrm) = 3.621e-01 S  per = 34.8  per(accum) = 96.1
 T(global opt: save ) = 4.017e-02 S  per = 3.86  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.344e-01 S  T(sum) = 5.245e-01 S  per = 9.816e+01
 T(global opt: preprocess                  ) = 1.352e-03 S  per = 0.258  per(accum) = 0.258
 T(global opt: symbolic_formulae           ) = 1.504e-02 S  per = 2.87  per(accum) = 3.12
 T(global opt: hintermediate init          ) = 1.148e-03 S  per = 0.219  per(accum) = 3.34
 T(global opt: preprocess_hformulae_Hxlist ) = 4.976e-02 S  per = 9.49  per(accum) = 12.8
 T(global opt: hmmtasks init               ) = 5.074e-02 S  per = 9.67  per(accum) = 22.5
 T(global opt: initial guess for dvdson    ) = 1.129e-04 S  per = 0.0215  per(accum) = 22.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.872e-01 S  per = 73.8  per(accum) = 96.3
 T(global opt: dvdson [cpu-gpu]            ) = 3.304e-03 S  per = 0.63  per(accum) = 97
 T(global opt: dvdson [nccl]               ) = 6.596e-03 S  per = 1.26  per(accum) = 98.2
 T(global opt: dvdson [mpi]                ) = 6.005e-05 S  per = 0.0114  per(accum) = 98.2
 T(global opt: dvdson [rest part(linalg)]  ) = 9.194e-03 S  per = 1.75  per(accum) = 100
Detailed decomposition of T(renrm) = 3.621e-01 S  T(sum) = 3.621e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 9.703e-04 S  per = 0.268  per(accum) = 0.268
 T(global opt: qops init                    ) = 9.065e-03 S  per =  2.5  per(accum) = 2.77
 T(global opt: symbolic_formulae_renorm     ) = 8.883e-03 S  per = 2.45  per(accum) = 5.22
 T(global opt: allocate qops on gpu         ) = 1.310e-03 S  per = 0.362  per(accum) = 5.59
 T(global opt: site memcpy cpu2gpu          ) = 4.562e-04 S  per = 0.126  per(accum) = 5.71
 T(global opt: rintermediate init           ) = 9.738e-04 S  per = 0.269  per(accum) = 5.98
 T(global opt: preprocess_formulae_Rlist2   ) = 1.611e-02 S  per = 4.45  per(accum) = 10.4
 T(global opt: rmmtasks init                ) = 1.757e-02 S  per = 4.85  per(accum) = 15.3
 T(global opt: qops memset on cpu           ) = 9.080e-07 S  per = 0.000251  per(accum) = 15.3
 T(global opt: preprocess_renorm_batchGPU   ) = 2.852e-02 S  per = 7.87  per(accum) = 23.2
 T(global opt: deallocate cpu and gpu memory) = 2.602e-03 S  per = 0.718  per(accum) = 23.9
 T(global opt: construct opS [ifdists=true] ) = 2.524e-01 S  per = 69.7  per(accum) = 93.6
 T(global opt: reduction of opS & opH [nccl]) = 5.259e-04 S  per = 0.145  per(accum) = 93.7
 T(global opt: qops memcpy gpu2cpu          ) = 2.130e-03 S  per = 0.588  per(accum) = 94.3
 T(global opt: reduction of opS & opH [mpi] ) = 5.315e-04 S  per = 0.147  per(accum) = 94.5
 T(global opt: qops_pool join and erase     ) = 1.325e-02 S  per = 3.66  per(accum) = 98.1
 T(global opt: conversion from opAB to opPQ ) = 6.833e-03 S  per = 1.89  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-5.287e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=20/seqsize=34 dots=1 dbond=(14,0)-(15,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=5 scratch=./scratch/sweep size=1021:7.61e-06GB T(load)=3.21e-04S speed=2.37e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=1485:1.13e-02MB:1.11e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=464:3.54e-03MB:3.46e-06GB
total mem of comb=2097:1.60e-02MB:1.56e-05GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=1.109e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=15,4,1
 suppl= 0 1 2 3 4 5 6 7 8 9 10 16 17 18 19
 suppr= 12 13 14 15
 suppc= 11
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(14,0)
 fqop[1]=./scratch/sweep/rop(16,0)
 fqop[2]=./scratch/sweep/cop(15,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:30 S:5 H:1 P:22 Q:28 
        dim(bra,ket)=42,42 size(op)=270:2.060e-03MB size(tot)=13084:9.982e-02MB:9.748e-05GB
        per(mem): C:38.5 S:5.2 H:2.06 P:14.9 Q:39.3 
 rqops: oplist=CSHAB nops=C:8 S:16 H:1 A:14 B:18 
        dim(bra,ket)=24,24 size(op)=104:0.000793MB size(tot)=2908:0.0222MB:2.17e-05GB
        per(mem): C:16 S:24.8 H:3.58 A:14.2 B:41.5 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=18328:0.14MB:0.000137GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.084e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(15,0) fdel=./scratch/sweep/lop(14,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-9.882e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(42,24,4) nnz=464:3.540e-03MB
qtensor3: wf3 own=1 _data=0x55b2c5b3d000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=8 dimAll=42
 (23,3):8 (22,2):8 (24,2):8 (23,1):6 (25,3):4 (24,4):4 (21,1):3 (25,1):1
 qbond: qcol nsym=7 dimAll=24
 (6,-2):6 (4,-2):5 (5,-1):4 (5,-3):4 (7,-1):3 (3,-3):1 (4,-4):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=20 nblocks=224 size=464:3.540e-03MB
### DIAG TIMING: total=4.186e-04 t1=1.771e-05, t2=1.157e-05, t3=1.498e-05, t4=3.188e-04, t5=1.007e-05, t6=3.790e-05, t7=7.621e-06
duration_diagGPU:4.266e-04
duration_diagreduce:2.800e-08
duration_diagtransform:5.640e-07
----- TIMING FOR symbolic_formulae_onedot with size=219 : 4.471e-04 S -----
rank=0 GPUmem(GB): used=1.366e-04 (oper)=1.366e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=219
 no. of hintermediate operators=94
 no. of coefficients=1410:1.076e-02MB:1.051e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.908e-05 S -----
rank=0 GPUmem(GB): used=1.471e-04 (oper,hinter)=1.366e-04,1.051e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.714e-04 S size(H_formulae)=219 size(Hxlst2)=20 T(Hmu/Hxlist)=1.053e-04,5.660e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 8.874e-04 S size(H_formulae)=219 size(Hxlst)=2822 -----
rank=0 GPUmem(GB): used=1.471e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=6.914e-06 batch[need]=3.385e-03 blksize=48 blksize0=64 batchsize=2822
rank=0 GPUmem(GB): used=3.539e-03 (oper,hinter,dvdson,batch)=1.366e-04,1.051e-05,6.914e-06,3.385e-03
ctns::pdvdsonSolver_nkr::solve_iter ndim=464 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.193e-05,9.571e-05,1.068e-03,2.200e-04,1.463e-03
 analyze_tgpu[Hx]: ndim=464:3.457e-06GB T(cpu-gpu)=2.191e-05 speed=3.155e-01GB/S T(nccl)=5.002e-05 speed=1.382e-01GB/S
----- TIMING FOR sigma : t_inter=9.6e-05 t_gemm=1.1e-03 t_reduction=2.2e-04 tot=1.4e-03 -----
 sigma[inter] counter=139 t=9.6e-05 per=6.9e+00 cost=1.0e+06 flops=1.1e+10
 sigma[gemm] counter=139 i=0 t=1.8e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=1 t=1.6e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=139 i=2 t=2.6e-04 per=1.9e+01 cost=2.8e+05 flops=1.1e+09
 sigma[gemm] counter=139 i=3 t=2.9e-04 per=2.1e+01 cost=2.8e+05 flops=9.4e+08
 sigma[gemm] counter=139 i=4 t=2.5e-04 per=1.8e+01 cost=3.6e+05 flops=1.4e+09
 sigma[gemm] counter=139 i=5 t=2.5e-04 per=1.8e+01 cost=3.5e+05 flops=1.4e+09
 sigma[gemm] counter=139 total t=1.1e-03 per=7.7e+01 cost=1.3e+06 flops=1.2e+09
 sigma[red] counter=139 t=2.2e-04 per=1.6e+01 cost=1.4e+05 flops=6.4e+08
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=3.0e-01 t_reduction=4.3e-02 tot=3.6e-01 -----
 sigma_tot[inter] counter=139 t=1.8e-02 per=4.8e+00 cost=5.3e+08 flops=3.0e+10
 sigma_tot[gemm] counter=139 i=0 t=3.0e-04 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=1 t=2.8e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=139 i=2 t=7.3e-02 per=2.0e+01 cost=4.7e+08 flops=6.4e+09
 sigma_tot[gemm] counter=139 i=3 t=9.2e-02 per=2.5e+01 cost=4.6e+08 flops=5.0e+09
 sigma_tot[gemm] counter=139 i=4 t=6.9e-02 per=1.9e+01 cost=3.9e+08 flops=5.7e+09
 sigma_tot[gemm] counter=139 i=5 t=6.9e-02 per=1.9e+01 cost=4.0e+08 flops=5.7e+09
 sigma_tot[gemm] counter=139 total t=3.0e-01 per=8.3e+01 cost=1.7e+09 flops=5.6e+09
 sigma_tot[red] counter=139 t=4.3e-02 per=1.2e+01 cost=1.1e+08 flops=2.6e+09
T(sub)=8.6e-06 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,2.9e-06,9.4e-07,1.2e-06,2.8e-07
settings: ndim=464 neig=1 maxcycle=30 nbuff=4 memory=5e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.541906050312 -1.117e+03  7.549e-03    1     1  1.547e-03 1.547e-03 1.528e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.555e-05,8.427e-05,1.311e-03,2.471e-04,1.712e-03
 analyze_tgpu[Hx]: ndim=464:3.457e-06GB T(cpu-gpu)=2.162e-05 speed=3.198e-01GB/S T(nccl)=4.394e-05 speed=1.574e-01GB/S
----- TIMING FOR sigma : t_inter=8.4e-05 t_gemm=1.3e-03 t_reduction=2.5e-04 tot=1.6e-03 -----
 sigma[inter] counter=140 t=8.4e-05 per=5.1e+00 cost=1.0e+06 flops=1.2e+10
 sigma[gemm] counter=140 i=0 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=1 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=140 i=2 t=3.0e-04 per=1.8e+01 cost=2.8e+05 flops=9.6e+08
 sigma[gemm] counter=140 i=3 t=3.8e-04 per=2.3e+01 cost=2.8e+05 flops=7.2e+08
 sigma[gemm] counter=140 i=4 t=3.1e-04 per=1.9e+01 cost=3.6e+05 flops=1.2e+09
 sigma[gemm] counter=140 i=5 t=3.2e-04 per=1.9e+01 cost=3.5e+05 flops=1.1e+09
 sigma[gemm] counter=140 total t=1.3e-03 per=8.0e+01 cost=1.3e+06 flops=9.7e+08
 sigma[red] counter=140 t=2.5e-04 per=1.5e+01 cost=1.4e+05 flops=5.7e+08
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=3.1e-01 t_reduction=4.3e-02 tot=3.7e-01 -----
 sigma_tot[inter] counter=140 t=1.8e-02 per=4.8e+00 cost=5.3e+08 flops=3.0e+10
 sigma_tot[gemm] counter=140 i=0 t=3.0e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=1 t=2.8e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=140 i=2 t=7.4e-02 per=2.0e+01 cost=4.7e+08 flops=6.3e+09
 sigma_tot[gemm] counter=140 i=3 t=9.2e-02 per=2.5e+01 cost=4.6e+08 flops=5.0e+09
 sigma_tot[gemm] counter=140 i=4 t=6.9e-02 per=1.9e+01 cost=3.9e+08 flops=5.6e+09
 sigma_tot[gemm] counter=140 i=5 t=7.0e-02 per=1.9e+01 cost=4.0e+08 flops=5.7e+09
 sigma_tot[gemm] counter=140 total t=3.1e-01 per=8.3e+01 cost=1.7e+09 flops=5.6e+09
 sigma_tot[red] counter=140 t=4.3e-02 per=1.2e+01 cost=1.1e+08 flops=2.6e+09
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=7.8e-06,1.0e-05,3.0e-06,1.9e-06,3.2e-07
    2   0 -    -116.541995527315 -8.948e-05  2.204e-03    2     2  3.454e-03 1.727e-03 1.685e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.402e-05,8.502e-05,1.304e-03,2.417e-04,1.700e-03
 analyze_tgpu[Hx]: ndim=464:3.457e-06GB T(cpu-gpu)=2.082e-05 speed=3.322e-01GB/S T(nccl)=4.321e-05 speed=1.600e-01GB/S
----- TIMING FOR sigma : t_inter=8.5e-05 t_gemm=1.3e-03 t_reduction=2.4e-04 tot=1.6e-03 -----
 sigma[inter] counter=141 t=8.5e-05 per=5.2e+00 cost=1.0e+06 flops=1.2e+10
 sigma[gemm] counter=141 i=0 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=1 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=141 i=2 t=3.0e-04 per=1.8e+01 cost=2.8e+05 flops=9.5e+08
 sigma[gemm] counter=141 i=3 t=3.8e-04 per=2.3e+01 cost=2.8e+05 flops=7.3e+08
 sigma[gemm] counter=141 i=4 t=3.1e-04 per=1.9e+01 cost=3.6e+05 flops=1.2e+09
 sigma[gemm] counter=141 i=5 t=3.2e-04 per=1.9e+01 cost=3.5e+05 flops=1.1e+09
 sigma[gemm] counter=141 total t=1.3e-03 per=8.0e+01 cost=1.3e+06 flops=9.7e+08
 sigma[red] counter=141 t=2.4e-04 per=1.5e+01 cost=1.4e+05 flops=5.9e+08
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=3.1e-01 t_reduction=4.3e-02 tot=3.7e-01 -----
 sigma_tot[inter] counter=141 t=1.8e-02 per=4.8e+00 cost=5.3e+08 flops=3.0e+10
 sigma_tot[gemm] counter=141 i=0 t=3.0e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=1 t=2.8e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=141 i=2 t=7.4e-02 per=2.0e+01 cost=4.7e+08 flops=6.3e+09
 sigma_tot[gemm] counter=141 i=3 t=9.3e-02 per=2.5e+01 cost=4.6e+08 flops=5.0e+09
 sigma_tot[gemm] counter=141 i=4 t=6.9e-02 per=1.9e+01 cost=3.9e+08 flops=5.6e+09
 sigma_tot[gemm] counter=141 i=5 t=7.0e-02 per=1.9e+01 cost=4.0e+08 flops=5.7e+09
 sigma_tot[gemm] counter=141 total t=3.1e-01 per=8.3e+01 cost=1.7e+09 flops=5.6e+09
 sigma_tot[red] counter=141 t=4.3e-02 per=1.2e+01 cost=1.1e+08 flops=2.6e+09
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=7.3e-06,1.3e-05,2.2e-06,2.5e-06,2.6e-07
    3   0 -    -116.542003443519 -7.916e-06  9.050e-04    3     3  5.449e-03 1.816e-03 1.771e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.505e-05,8.631e-05,1.299e-03,2.426e-04,1.697e-03
 analyze_tgpu[Hx]: ndim=464:3.457e-06GB T(cpu-gpu)=2.141e-05 speed=3.230e-01GB/S T(nccl)=4.364e-05 speed=1.584e-01GB/S
----- TIMING FOR sigma : t_inter=8.6e-05 t_gemm=1.3e-03 t_reduction=2.4e-04 tot=1.6e-03 -----
 sigma[inter] counter=142 t=8.6e-05 per=5.3e+00 cost=1.0e+06 flops=1.2e+10
 sigma[gemm] counter=142 i=0 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=142 i=2 t=2.9e-04 per=1.8e+01 cost=2.8e+05 flops=9.6e+08
 sigma[gemm] counter=142 i=3 t=3.8e-04 per=2.3e+01 cost=2.8e+05 flops=7.3e+08
 sigma[gemm] counter=142 i=4 t=3.1e-04 per=1.9e+01 cost=3.6e+05 flops=1.2e+09
 sigma[gemm] counter=142 i=5 t=3.1e-04 per=1.9e+01 cost=3.5e+05 flops=1.1e+09
 sigma[gemm] counter=142 total t=1.3e-03 per=8.0e+01 cost=1.3e+06 flops=9.8e+08
 sigma[red] counter=142 t=2.4e-04 per=1.5e+01 cost=1.4e+05 flops=5.8e+08
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=3.1e-01 t_reduction=4.3e-02 tot=3.7e-01 -----
 sigma_tot[inter] counter=142 t=1.8e-02 per=4.8e+00 cost=5.3e+08 flops=3.0e+10
 sigma_tot[gemm] counter=142 i=0 t=3.0e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=1 t=2.8e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=142 i=2 t=7.4e-02 per=2.0e+01 cost=4.7e+08 flops=6.3e+09
 sigma_tot[gemm] counter=142 i=3 t=9.3e-02 per=2.5e+01 cost=4.6e+08 flops=5.0e+09
 sigma_tot[gemm] counter=142 i=4 t=7.0e-02 per=1.9e+01 cost=3.9e+08 flops=5.6e+09
 sigma_tot[gemm] counter=142 i=5 t=7.0e-02 per=1.9e+01 cost=4.0e+08 flops=5.7e+09
 sigma_tot[gemm] counter=142 total t=3.1e-01 per=8.3e+01 cost=1.7e+09 flops=5.6e+09
 sigma_tot[red] counter=142 t=4.3e-02 per=1.2e+01 cost=1.1e+08 flops=2.6e+09
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=6.7e-06,1.2e-05,1.9e-06,2.3e-06,2.3e-07
    4   0 -    -116.542004802693 -1.359e-06  3.722e-04    3     4  7.285e-03 1.821e-03 1.775e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.409e-05,8.245e-05,1.307e-03,2.383e-04,1.696e-03
 analyze_tgpu[Hx]: ndim=464:3.457e-06GB T(cpu-gpu)=2.071e-05 speed=3.339e-01GB/S T(nccl)=4.338e-05 speed=1.594e-01GB/S
----- TIMING FOR sigma : t_inter=8.2e-05 t_gemm=1.3e-03 t_reduction=2.4e-04 tot=1.6e-03 -----
 sigma[inter] counter=143 t=8.2e-05 per=5.1e+00 cost=1.0e+06 flops=1.3e+10
 sigma[gemm] counter=143 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=143 i=2 t=2.9e-04 per=1.8e+01 cost=2.8e+05 flops=9.6e+08
 sigma[gemm] counter=143 i=3 t=3.7e-04 per=2.3e+01 cost=2.8e+05 flops=7.4e+08
 sigma[gemm] counter=143 i=4 t=3.2e-04 per=2.0e+01 cost=3.6e+05 flops=1.1e+09
 sigma[gemm] counter=143 i=5 t=3.2e-04 per=2.0e+01 cost=3.5e+05 flops=1.1e+09
 sigma[gemm] counter=143 total t=1.3e-03 per=8.0e+01 cost=1.3e+06 flops=9.7e+08
 sigma[red] counter=143 t=2.4e-04 per=1.5e+01 cost=1.4e+05 flops=5.9e+08
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=3.1e-01 t_reduction=4.4e-02 tot=3.7e-01 -----
 sigma_tot[inter] counter=143 t=1.8e-02 per=4.8e+00 cost=5.3e+08 flops=3.0e+10
 sigma_tot[gemm] counter=143 i=0 t=3.0e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=1 t=2.9e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=143 i=2 t=7.5e-02 per=2.0e+01 cost=4.7e+08 flops=6.3e+09
 sigma_tot[gemm] counter=143 i=3 t=9.3e-02 per=2.5e+01 cost=4.6e+08 flops=5.0e+09
 sigma_tot[gemm] counter=143 i=4 t=7.0e-02 per=1.9e+01 cost=3.9e+08 flops=5.6e+09
 sigma_tot[gemm] counter=143 i=5 t=7.1e-02 per=1.9e+01 cost=4.0e+08 flops=5.6e+09
 sigma_tot[gemm] counter=143 total t=3.1e-01 per=8.3e+01 cost=1.7e+09 flops=5.6e+09
 sigma_tot[red] counter=143 t=4.4e-02 per=1.2e+01 cost=1.1e+08 flops=2.6e+09
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=6.7e-06,1.1e-05,1.9e-06,2.2e-06,2.5e-07
    5   0 -    -116.542005023049 -2.204e-07  1.389e-04    3     5  9.106e-03 1.821e-03 1.775e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.272e-05,8.786e-05,1.296e-03,2.409e-04,1.692e-03
 analyze_tgpu[Hx]: ndim=464:3.457e-06GB T(cpu-gpu)=2.093e-05 speed=3.304e-01GB/S T(nccl)=4.179e-05 speed=1.654e-01GB/S
----- TIMING FOR sigma : t_inter=8.8e-05 t_gemm=1.3e-03 t_reduction=2.4e-04 tot=1.6e-03 -----
 sigma[inter] counter=144 t=8.8e-05 per=5.4e+00 cost=1.0e+06 flops=1.2e+10
 sigma[gemm] counter=144 i=0 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=144 i=2 t=2.9e-04 per=1.8e+01 cost=2.8e+05 flops=9.6e+08
 sigma[gemm] counter=144 i=3 t=3.7e-04 per=2.3e+01 cost=2.8e+05 flops=7.5e+08
 sigma[gemm] counter=144 i=4 t=3.1e-04 per=1.9e+01 cost=3.6e+05 flops=1.2e+09
 sigma[gemm] counter=144 i=5 t=3.2e-04 per=2.0e+01 cost=3.5e+05 flops=1.1e+09
 sigma[gemm] counter=144 total t=1.3e-03 per=8.0e+01 cost=1.3e+06 flops=9.8e+08
 sigma[red] counter=144 t=2.4e-04 per=1.5e+01 cost=1.4e+05 flops=5.9e+08
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=3.1e-01 t_reduction=4.4e-02 tot=3.7e-01 -----
 sigma_tot[inter] counter=144 t=1.8e-02 per=4.8e+00 cost=5.3e+08 flops=3.0e+10
 sigma_tot[gemm] counter=144 i=0 t=3.1e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=1 t=2.9e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=144 i=2 t=7.5e-02 per=2.0e+01 cost=4.7e+08 flops=6.2e+09
 sigma_tot[gemm] counter=144 i=3 t=9.4e-02 per=2.5e+01 cost=4.6e+08 flops=4.9e+09
 sigma_tot[gemm] counter=144 i=4 t=7.0e-02 per=1.9e+01 cost=3.9e+08 flops=5.6e+09
 sigma_tot[gemm] counter=144 i=5 t=7.1e-02 per=1.9e+01 cost=4.0e+08 flops=5.6e+09
 sigma_tot[gemm] counter=144 total t=3.1e-01 per=8.3e+01 cost=1.7e+09 flops=5.5e+09
 sigma_tot[red] counter=144 t=4.4e-02 per=1.2e+01 cost=1.1e+08 flops=2.6e+09
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=6.7e-06,1.1e-05,2.0e-06,2.2e-06,2.6e-07
    6   0 +    -116.542005052968 -2.992e-08  5.258e-05    3     6  1.097e-02 1.829e-03 1.783e-03
TIMING FOR Davidson : 1.099e-02  T(cal/comm/rest)=1.070e-02,1.910e-06,2.911e-04
decomposed t_rest=2.911e-04
 T(sub)    =1.256e-04 per=4.316e+01
 T(precond)=1.909e-05 per=6.557e+00
 T(ortho)  =1.229e-05 per=4.223e+00
 T(xcopy)  =1.154e-06 per=3.965e-01
 T(xnrm2)  =1.914e-06 per=6.576e-01
 T(other)  =1.310e-04 per=4.501e+01
optimized energies: isweep=0 ibond=20 dots=1 e[0]=-116.542005052968 nmvp=6
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=8.138e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=14 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond20.txt
 qbond: qsuper nsym=14 dimAll=96
 (6,-2):19 (4,-2):6 (5,-1):9 (5,-3):11 (7,-1):13 (3,-3):1 (4,-4):2 (8,-2):9 (7,-3):10 (9,-1):3 (6,-4):5 (6,0):4 (8,0):3 (5,-5):1
timing for divide=2.5e-06
timing for compute=8.6e-05
timing for collect=5.0e-06
----- TMING FOR decimation_genbasis(nkr): 9.4e-05 S T(divide/compute[cpu/gpu/rest]/collect)=2.5e-06,8.4e-05,0.0e+00,2.3e-06,5.0e-06 -----
decimation summary: 96->42 dwt=+1.110e-16 SvN=1.399e+00
 qbond: qkept nsym=8 dimAll=42
 (6,-2):8 (8,-2):8 (7,-3):8 (7,-1):6 (5,-3):4 (6,-4):4 (9,-1):3 (5,-1):1
----- TIMING for decimation_row(nkr): 1.041e-03 S T(decim/select/formRot)=1.196e-04,9.079e-04,1.356e-05 -----
----- TIMING FOR onedot_decimation: 1.120e-03 S T(wf/decim)=6.831e-05,1.052e-03 -----
ctns::oper_renorm coord=(15,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:10 S:15 H:1 A:22 B:28 
        dim(bra,ket)=42,42 size(op)=270:2.060e-03MB size(tot)=11084:8.456e-02MB:8.258e-05GB
        per(mem): C:15.2 S:18.4 H:2.44 A:17.6 B:46.4 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.013e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=61 : 7.522e-05 S -----
rank=0 GPUmem(GB): used=1.322e-04 (oper)=1.217e-04
rank=0 GPUmem(GB): used=1.356e-04 (oper,site)=1.217e-04,3.457e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=61
 no. of rintermediate operators=7
 no. of coefficients=56:4.272e-04MB:4.172e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.905e-05 S -----
rank=0 GPUmem(GB): used=1.360e-04 (oper,site,rinter)=1.217e-04,3.457e-06,4.172e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 2.350e-04 S size(rtasks)=61 size(Rlst2)=64 T(Rmu/Rlist)=3.755e-05,1.974e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.098e-04 S size(rtasks)=61 size(Rlst)=714 -----
rank=0 GPUmem(GB): used=1.360e-04 avail=3.829e+01 total=3.829e+01 batch[need]=8.778e-04 blksize=64 blksize0=36 batchsize=714
rank=0 GPUmem(GB): used=1.014e-03 (oper,site,rinter,batch)=1.217e-04,3.457e-06,4.172e-07,8.778e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.231e-04,9.434e-04,2.211e-04
----- TIMING FOR renorm : t_inter=1.2e-04 t_gemm=9.4e-04 t_reduction=2.2e-04 tot=1.3e-03 -----
 renorm[inter] counter=461 t=1.2e-04 per=9.6e+00 cost=3.3e+04 flops=2.7e+08
 renorm[gemm] counter=461 i=0 t=2.0e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=461 i=1 t=1.9e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=461 i=2 t=2.1e-04 per=1.6e+01 cost=2.9e+04 flops=1.4e+08
 renorm[gemm] counter=461 i=3 t=3.7e-04 per=2.8e+01 cost=1.0e+05 flops=2.8e+08
 renorm[gemm] counter=461 i=4 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=461 i=5 t=1.8e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=461 i=6 t=3.6e-04 per=2.8e+01 cost=2.2e+05 flops=6.1e+08
 renorm[gemm] counter=461 total t=9.4e-04 per=7.3e+01 cost=3.6e+05 flops=3.8e+08
 renorm[red] counter=461 t=2.2e-04 per=1.7e+01 cost=5.1e+04 flops=2.3e+08
----- TIMING FOR renorm_tot : t_inter=2.5e-03 t_gemm=2.0e-02 t_reduction=5.0e-03 tot=2.7e-02 -----
 renorm_tot[inter] counter=461 t=2.5e-03 per=9.3e+00 cost=1.6e+07 flops=6.6e+09
 renorm_tot[gemm] counter=461 i=0 t=4.5e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=461 i=1 t=4.0e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=461 i=2 t=6.8e-04 per=2.5e+00 cost=5.9e+04 flops=8.7e+07
 renorm_tot[gemm] counter=461 i=3 t=9.0e-04 per=3.3e+00 cost=1.7e+05 flops=1.9e+08
 renorm_tot[gemm] counter=461 i=4 t=4.6e-03 per=1.7e+01 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=461 i=5 t=6.4e-03 per=2.4e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=461 i=6 t=6.9e-03 per=2.5e+01 cost=4.5e+07 flops=6.6e+09
 renorm_tot[gemm] counter=461 total t=2.0e-02 per=7.2e+01 cost=7.9e+07 flops=4.0e+09
 renorm_tot[red] counter=461 t=5.0e-03 per=1.8e+01 cost=5.4e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.446e-04 (oper)=1.231e-04
rank=0 GPUmem(GB): used=1.480e-04 (oper,site,rinter)=1.231e-04,3.457e-06,1.051e-05
rank=0 GPUmem(GB): used=2.193e-04 (oper,site,rinter,batch)=1.231e-04,3.457e-06,1.051e-05,7.130e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.727e-02 S T(preprocess/alloc/comp/red/dealloc)=2.156e-03,2.220e-03,1.267e-02,2.132e-03,1.898e-04 -----
----- TIMING FOR oper_renorm_opS : 1.731e-02 S rank=0 -----
qops.to_cpu: size(tot)=11084:8.456e-02MB:8.258e-05GB T(to_cpu)=4.208e-05S speed=1.963e+00GB/S
check ||H-H.dagger||=2.742e-14 coord=(15,0) rank=0
----- TIMING FOR oper_renorm : 0.02 S rank=0 -----
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=2.780e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-1.264e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-5.409e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 4.043e-02 S #####
 T(local opt: fetch) = 2.681e-03 S  per = 6.63  per(accum) = 6.63
 T(local opt: hdiag) = 4.659e-04 S  per = 1.15  per(accum) = 7.78
 T(local opt: dvdsn) = 1.377e-02 S  per = 34.1  per(accum) = 41.9
 T(local opt: decim) = 1.145e-03 S  per = 2.83  per(accum) = 44.7
 T(local opt: guess) = 4.555e-05 S  per = 0.113  per(accum) = 44.8
 T(local opt: renrm) = 2.046e-02 S  per = 50.6  per(accum) = 95.4
 T(local opt: save ) = 1.863e-03 S  per = 4.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.377e-02 S  T(sum) = 1.330e-02 S  per = 9.657e+01
 T(local opt: preprocess                  ) = 4.414e-05 S  per = 0.332  per(accum) = 0.332
 T(local opt: symbolic_formulae           ) = 4.519e-04 S  per =  3.4  per(accum) = 3.73
 T(local opt: hintermediate init          ) = 3.680e-05 S  per = 0.277  per(accum) = 4.01
 T(local opt: preprocess_hformulae_Hxlist ) = 8.981e-04 S  per = 6.75  per(accum) = 10.8
 T(local opt: hmmtasks init               ) = 8.797e-04 S  per = 6.61  per(accum) = 17.4
 T(local opt: initial guess for dvdson    ) = 3.081e-06 S  per = 0.0232  per(accum) = 17.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.030e-02 S  per = 77.4  per(accum) = 94.8
 T(local opt: dvdson [cpu-gpu]            ) = 1.274e-04 S  per = 0.958  per(accum) = 95.8
 T(local opt: dvdson [nccl]               ) = 2.660e-04 S  per =    2  per(accum) = 97.8
 T(local opt: dvdson [mpi]                ) = 1.910e-06 S  per = 0.0144  per(accum) = 97.8
 T(local opt: dvdson [rest part(linalg)]  ) = 2.911e-04 S  per = 2.19  per(accum) = 100
Detailed decomposition of T(renrm) = 2.046e-02 S  T(sum) = 2.046e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.064e-05 S  per = 0.199  per(accum) = 0.199
 T(local opt: qops init                    ) = 3.019e-04 S  per = 1.48  per(accum) = 1.67
 T(local opt: symbolic_formulae_renorm     ) = 7.934e-05 S  per = 0.388  per(accum) = 2.06
 T(local opt: allocate qops on gpu         ) = 5.048e-05 S  per = 0.247  per(accum) = 2.31
 T(local opt: site memcpy cpu2gpu          ) = 1.840e-05 S  per = 0.0899  per(accum) = 2.4
 T(local opt: rintermediate init           ) = 2.600e-05 S  per = 0.127  per(accum) = 2.53
 T(local opt: preprocess_formulae_Rlist2   ) = 3.155e-04 S  per = 1.54  per(accum) = 4.07
 T(local opt: rmmtasks init                ) = 2.745e-04 S  per = 1.34  per(accum) = 5.41
 T(local opt: qops memset on cpu           ) = 2.900e-08 S  per = 0.000142  per(accum) = 5.41
 T(local opt: preprocess_renorm_batchGPU   ) = 1.376e-03 S  per = 6.73  per(accum) = 12.1
 T(local opt: deallocate cpu and gpu memory) = 2.957e-05 S  per = 0.145  per(accum) = 12.3
 T(local opt: construct opS [ifdists=true] ) = 1.736e-02 S  per = 84.9  per(accum) = 97.1
 T(local opt: reduction of opS & opH [nccl]) = 2.113e-05 S  per = 0.103  per(accum) = 97.2
 T(local opt: qops memcpy gpu2cpu          ) = 5.292e-05 S  per = 0.259  per(accum) = 97.5
 T(local opt: reduction of opS & opH [mpi] ) = 4.722e-05 S  per = 0.231  per(accum) = 97.7
 T(local opt: qops_pool join and erase     ) = 4.623e-04 S  per = 2.26  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.020e-07 S  per = 0.00392  per(accum) = 100
ctns::rcanon_save_site idx=4 scratch=./scratch/sweep size=464:3.5e-06GB T(load)=0.00054S speed=0.0064GB/S
##### sweep opt: 1.081e+00 S #####
 T(sweep opt: fetch) = 6.879e-02 S  per = 6.36  per(accum) = 6.36
 T(sweep opt: hdiag) = 1.603e-02 S  per = 1.48  per(accum) = 7.84
 T(sweep opt: dvdsn) = 5.481e-01 S  per = 50.7  per(accum) = 58.5
 T(sweep opt: decim) = 2.266e-02 S  per =  2.1  per(accum) = 60.6
 T(sweep opt: guess) = 1.074e-03 S  per = 0.0994  per(accum) = 60.7
 T(sweep opt: renrm) = 3.826e-01 S  per = 35.4  per(accum) = 96.1
 T(sweep opt: save ) = 4.204e-02 S  per = 3.89  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.481e-01 S  T(sum) = 5.378e-01 S  per = 9.812e+01
 T(sweep opt: preprocess                  ) = 1.396e-03 S  per = 0.26  per(accum) = 0.26
 T(sweep opt: symbolic_formulae           ) = 1.549e-02 S  per = 2.88  per(accum) = 3.14
 T(sweep opt: hintermediate init          ) = 1.185e-03 S  per = 0.22  per(accum) = 3.36
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.066e-02 S  per = 9.42  per(accum) = 12.8
 T(sweep opt: hmmtasks init               ) = 5.162e-02 S  per =  9.6  per(accum) = 22.4
 T(sweep opt: initial guess for dvdson    ) = 1.160e-04 S  per = 0.0216  per(accum) = 22.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 3.975e-01 S  per = 73.9  per(accum) = 96.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.431e-03 S  per = 0.638  per(accum) = 96.9
 T(sweep opt: dvdson [nccl]               ) = 6.862e-03 S  per = 1.28  per(accum) = 98.2
 T(sweep opt: dvdson [mpi]                ) = 6.196e-05 S  per = 0.0115  per(accum) = 98.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 9.485e-03 S  per = 1.76  per(accum) = 100
Detailed decomposition of T(renrm) = 3.826e-01 S  T(sum) = 3.826e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.011e-03 S  per = 0.264  per(accum) = 0.264
 T(sweep opt: qops init                    ) = 9.367e-03 S  per = 2.45  per(accum) = 2.71
 T(sweep opt: symbolic_formulae_renorm     ) = 8.963e-03 S  per = 2.34  per(accum) = 5.05
 T(sweep opt: allocate qops on gpu         ) = 1.360e-03 S  per = 0.356  per(accum) = 5.41
 T(sweep opt: site memcpy cpu2gpu          ) = 4.746e-04 S  per = 0.124  per(accum) = 5.53
 T(sweep opt: rintermediate init           ) = 9.998e-04 S  per = 0.261  per(accum) = 5.8
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.643e-02 S  per = 4.29  per(accum) = 10.1
 T(sweep opt: rmmtasks init                ) = 1.784e-02 S  per = 4.66  per(accum) = 14.8
 T(sweep opt: qops memset on cpu           ) = 9.370e-07 S  per = 0.000245  per(accum) = 14.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.989e-02 S  per = 7.81  per(accum) = 22.6
 T(sweep opt: deallocate cpu and gpu memory) = 2.631e-03 S  per = 0.688  per(accum) = 23.3
 T(sweep opt: construct opS [ifdists=true] ) = 2.698e-01 S  per = 70.5  per(accum) = 93.8
 T(sweep opt: reduction of opS & opH [nccl]) = 5.470e-04 S  per = 0.143  per(accum) = 93.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.183e-03 S  per = 0.57  per(accum) = 94.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.788e-04 S  per = 0.151  per(accum) = 94.6
 T(sweep opt: qops_pool join and erase     ) = 1.371e-02 S  per = 3.58  per(accum) = 98.2
 T(sweep opt: conversion from opAB to opPQ ) = 6.834e-03 S  per = 1.79  per(accum) = 100
##### global opt: 1.081e+00 S #####
 T(global opt: fetch) = 6.879e-02 S  per = 6.36  per(accum) = 6.36
 T(global opt: hdiag) = 1.603e-02 S  per = 1.48  per(accum) = 7.84
 T(global opt: dvdsn) = 5.481e-01 S  per = 50.7  per(accum) = 58.5
 T(global opt: decim) = 2.266e-02 S  per =  2.1  per(accum) = 60.6
 T(global opt: guess) = 1.074e-03 S  per = 0.0994  per(accum) = 60.7
 T(global opt: renrm) = 3.826e-01 S  per = 35.4  per(accum) = 96.1
 T(global opt: save ) = 4.204e-02 S  per = 3.89  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.481e-01 S  T(sum) = 5.378e-01 S  per = 9.812e+01
 T(global opt: preprocess                  ) = 1.396e-03 S  per = 0.26  per(accum) = 0.26
 T(global opt: symbolic_formulae           ) = 1.549e-02 S  per = 2.88  per(accum) = 3.14
 T(global opt: hintermediate init          ) = 1.185e-03 S  per = 0.22  per(accum) = 3.36
 T(global opt: preprocess_hformulae_Hxlist ) = 5.066e-02 S  per = 9.42  per(accum) = 12.8
 T(global opt: hmmtasks init               ) = 5.162e-02 S  per =  9.6  per(accum) = 22.4
 T(global opt: initial guess for dvdson    ) = 1.160e-04 S  per = 0.0216  per(accum) = 22.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 3.975e-01 S  per = 73.9  per(accum) = 96.3
 T(global opt: dvdson [cpu-gpu]            ) = 3.431e-03 S  per = 0.638  per(accum) = 96.9
 T(global opt: dvdson [nccl]               ) = 6.862e-03 S  per = 1.28  per(accum) = 98.2
 T(global opt: dvdson [mpi]                ) = 6.196e-05 S  per = 0.0115  per(accum) = 98.2
 T(global opt: dvdson [rest part(linalg)]  ) = 9.485e-03 S  per = 1.76  per(accum) = 100
Detailed decomposition of T(renrm) = 3.826e-01 S  T(sum) = 3.826e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.011e-03 S  per = 0.264  per(accum) = 0.264
 T(global opt: qops init                    ) = 9.367e-03 S  per = 2.45  per(accum) = 2.71
 T(global opt: symbolic_formulae_renorm     ) = 8.963e-03 S  per = 2.34  per(accum) = 5.05
 T(global opt: allocate qops on gpu         ) = 1.360e-03 S  per = 0.356  per(accum) = 5.41
 T(global opt: site memcpy cpu2gpu          ) = 4.746e-04 S  per = 0.124  per(accum) = 5.53
 T(global opt: rintermediate init           ) = 9.998e-04 S  per = 0.261  per(accum) = 5.8
 T(global opt: preprocess_formulae_Rlist2   ) = 1.643e-02 S  per = 4.29  per(accum) = 10.1
 T(global opt: rmmtasks init                ) = 1.784e-02 S  per = 4.66  per(accum) = 14.8
 T(global opt: qops memset on cpu           ) = 9.370e-07 S  per = 0.000245  per(accum) = 14.8
 T(global opt: preprocess_renorm_batchGPU   ) = 2.989e-02 S  per = 7.81  per(accum) = 22.6
 T(global opt: deallocate cpu and gpu memory) = 2.631e-03 S  per = 0.688  per(accum) = 23.3
 T(global opt: construct opS [ifdists=true] ) = 2.698e-01 S  per = 70.5  per(accum) = 93.8
 T(global opt: reduction of opS & opH [nccl]) = 5.470e-04 S  per = 0.143  per(accum) = 93.9
 T(global opt: qops memcpy gpu2cpu          ) = 2.183e-03 S  per = 0.57  per(accum) = 94.5
 T(global opt: reduction of opS & opH [mpi] ) = 5.788e-04 S  per = 0.151  per(accum) = 94.6
 T(global opt: qops_pool join and erase     ) = 1.371e-02 S  per = 3.58  per(accum) = 98.2
 T(global opt: conversion from opAB to opPQ ) = 6.834e-03 S  per = 1.79  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-8.177e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=21/seqsize=34 dots=1 dbond=(13,0)-(14,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=6 scratch=./scratch/sweep size=1493:1.11e-05GB T(load)=2.82e-04S speed=3.94e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=2514:1.92e-02MB:1.87e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1021:7.79e-03MB:7.61e-06GB
total mem of comb=3683:2.81e-02MB:2.74e-05GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=1.563e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=14,5,1
 suppl= 0 1 2 3 4 5 6 7 8 9 16 17 18 19
 suppr= 11 12 13 14 15
 suppc= 10
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(13,0)
 fqop[1]=./scratch/sweep/rop(15,0)
 fqop[2]=./scratch/sweep/cop(14,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:28 S:6 H:1 P:33 Q:39 
        dim(bra,ket)=58,58 size(op)=472:3.601e-03MB size(tot)=28497:2.174e-01MB:2.123e-04GB
        per(mem): C:28.3 S:5.12 H:1.66 P:18.7 Q:46.2 
 rqops: oplist=CSHAB nops=C:10 S:15 H:1 A:22 B:28 
        dim(bra,ket)=42,42 size(op)=270:0.00206MB size(tot)=11084:0.0846MB:8.26e-05GB
        per(mem): C:15.2 S:18.4 H:2.44 A:17.6 B:46.4 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=41917:0.32MB:0.000312GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.259e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(14,0) fdel=./scratch/sweep/lop(13,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-2.133e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(58,42,4) nnz=1021:7.790e-03MB
qtensor3: wf3 own=1 _data=0x55b2c6264000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=58
 (21,3):11 (21,1):9 (23,3):9 (22,2):9 (20,2):8 (22,4):5 (19,1):3 (23,1):3 (23,5):1
 qbond: qcol nsym=8 dimAll=42
 (6,-2):8 (8,-2):8 (7,-3):8 (7,-1):6 (5,-3):4 (6,-4):4 (9,-1):3 (5,-1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=22 nblocks=288 size=1021:7.790e-03MB
### DIAG TIMING: total=6.024e-04 t1=1.949e-05, t2=1.363e-05, t3=1.251e-05, t4=4.990e-04, t5=1.102e-05, t6=3.788e-05, t7=8.935e-06
duration_diagGPU:6.109e-04
duration_diagreduce:4.500e-08
duration_diagtransform:1.080e-06
----- TIMING FOR symbolic_formulae_onedot with size=305 : 6.328e-04 S -----
rank=0 GPUmem(GB): used=3.123e-04 (oper)=3.123e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=305
 no. of hintermediate operators=140
 no. of coefficients=1960:1.495e-02MB:1.460e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.175e-05 S -----
rank=0 GPUmem(GB): used=3.269e-04 (oper,hinter)=3.123e-04,1.460e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 9.714e-04 S size(H_formulae)=305 size(Hxlst2)=22 T(Hmu/Hxlist)=1.323e-04,8.390e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.345e-03 S size(H_formulae)=305 size(Hxlst)=4350 -----
rank=0 GPUmem(GB): used=3.269e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.521e-05 batch[need]=8.945e-03 blksize=88 blksize0=99 batchsize=4350
rank=0 GPUmem(GB): used=9.287e-03 (oper,hinter,dvdson,batch)=3.123e-04,1.460e-05,1.521e-05,8.945e-03
ctns::pdvdsonSolver_nkr::solve_iter ndim=1021 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.183e-05,1.116e-04,1.203e-03,2.493e-04,1.647e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.336e-05 speed=6.514e-01GB/S T(nccl)=4.847e-05 speed=3.139e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.2e-03 t_reduction=2.5e-04 tot=1.6e-03 -----
 sigma[inter] counter=145 t=1.1e-04 per=7.1e+00 cost=2.8e+06 flops=2.5e+10
 sigma[gemm] counter=145 i=0 t=1.8e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=1 t=1.6e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=145 i=2 t=2.7e-04 per=1.7e+01 cost=1.4e+06 flops=5.1e+09
 sigma[gemm] counter=145 i=3 t=3.2e-04 per=2.0e+01 cost=1.3e+06 flops=4.2e+09
 sigma[gemm] counter=145 i=4 t=3.3e-04 per=2.1e+01 cost=1.4e+06 flops=4.3e+09
 sigma[gemm] counter=145 i=5 t=2.8e-04 per=1.8e+01 cost=1.4e+06 flops=5.0e+09
 sigma[gemm] counter=145 total t=1.2e-03 per=7.7e+01 cost=5.5e+06 flops=4.6e+09
 sigma[red] counter=145 t=2.5e-04 per=1.6e+01 cost=4.4e+05 flops=1.8e+09
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=3.1e-01 t_reduction=4.4e-02 tot=3.7e-01 -----
 sigma_tot[inter] counter=145 t=1.8e-02 per=4.8e+00 cost=5.3e+08 flops=3.0e+10
 sigma_tot[gemm] counter=145 i=0 t=3.1e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=1 t=2.9e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=145 i=2 t=7.5e-02 per=2.0e+01 cost=4.7e+08 flops=6.2e+09
 sigma_tot[gemm] counter=145 i=3 t=9.4e-02 per=2.5e+01 cost=4.6e+08 flops=4.9e+09
 sigma_tot[gemm] counter=145 i=4 t=7.1e-02 per=1.9e+01 cost=3.9e+08 flops=5.5e+09
 sigma_tot[gemm] counter=145 i=5 t=7.1e-02 per=1.9e+01 cost=4.0e+08 flops=5.6e+09
 sigma_tot[gemm] counter=145 total t=3.1e-01 per=8.3e+01 cost=1.7e+09 flops=5.5e+09
 sigma_tot[red] counter=145 t=4.4e-02 per=1.2e+01 cost=1.1e+08 flops=2.6e+09
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,3.0e-06,1.1e-06,2.7e-06,4.5e-07
settings: ndim=1021 neig=1 maxcycle=30 nbuff=4 memory=0.0001GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.542005052969 -1.117e+03  4.985e-03    1     1  1.832e-03 1.832e-03 1.804e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.402e-05,1.108e-04,1.474e-03,2.806e-04,1.946e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.439e-05 speed=6.237e-01GB/S T(nccl)=4.962e-05 speed=3.066e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.5e-03 t_reduction=2.8e-04 tot=1.9e-03 -----
 sigma[inter] counter=146 t=1.1e-04 per=5.9e+00 cost=2.8e+06 flops=2.5e+10
 sigma[gemm] counter=146 i=0 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=1 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=146 i=2 t=3.4e-04 per=1.8e+01 cost=1.4e+06 flops=4.0e+09
 sigma[gemm] counter=146 i=3 t=4.2e-04 per=2.3e+01 cost=1.3e+06 flops=3.2e+09
 sigma[gemm] counter=146 i=4 t=3.6e-04 per=1.9e+01 cost=1.4e+06 flops=3.9e+09
 sigma[gemm] counter=146 i=5 t=3.4e-04 per=1.8e+01 cost=1.4e+06 flops=4.1e+09
 sigma[gemm] counter=146 total t=1.5e-03 per=7.9e+01 cost=5.5e+06 flops=3.8e+09
 sigma[red] counter=146 t=2.8e-04 per=1.5e+01 cost=4.4e+05 flops=1.6e+09
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=3.1e-01 t_reduction=4.4e-02 tot=3.8e-01 -----
 sigma_tot[inter] counter=146 t=1.8e-02 per=4.8e+00 cost=5.4e+08 flops=3.0e+10
 sigma_tot[gemm] counter=146 i=0 t=3.1e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=1 t=2.9e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=146 i=2 t=7.6e-02 per=2.0e+01 cost=4.7e+08 flops=6.2e+09
 sigma_tot[gemm] counter=146 i=3 t=9.4e-02 per=2.5e+01 cost=4.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=146 i=4 t=7.1e-02 per=1.9e+01 cost=3.9e+08 flops=5.5e+09
 sigma_tot[gemm] counter=146 i=5 t=7.2e-02 per=1.9e+01 cost=4.0e+08 flops=5.6e+09
 sigma_tot[gemm] counter=146 total t=3.1e-01 per=8.3e+01 cost=1.7e+09 flops=5.5e+09
 sigma_tot[red] counter=146 t=4.4e-02 per=1.2e+01 cost=1.1e+08 flops=2.6e+09
T(sub)=2.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.0e-05,3.1e-06,3.3e-06,4.9e-07
    2   0 -    -116.542037098073 -3.205e-05  1.699e-03    2     2  4.065e-03 2.033e-03 1.974e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.742e-05,1.154e-04,1.500e-03,2.799e-04,1.970e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.327e-05 speed=6.537e-01GB/S T(nccl)=4.415e-05 speed=3.446e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=1.5e-03 t_reduction=2.8e-04 tot=1.9e-03 -----
 sigma[inter] counter=147 t=1.2e-04 per=6.1e+00 cost=2.8e+06 flops=2.4e+10
 sigma[gemm] counter=147 i=0 t=2.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=1 t=2.1e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=147 i=2 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=3.9e+09
 sigma[gemm] counter=147 i=3 t=4.5e-04 per=2.4e+01 cost=1.3e+06 flops=3.0e+09
 sigma[gemm] counter=147 i=4 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=4.0e+09
 sigma[gemm] counter=147 i=5 t=3.4e-04 per=1.8e+01 cost=1.4e+06 flops=4.1e+09
 sigma[gemm] counter=147 total t=1.5e-03 per=7.9e+01 cost=5.5e+06 flops=3.7e+09
 sigma[red] counter=147 t=2.8e-04 per=1.5e+01 cost=4.4e+05 flops=1.6e+09
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=3.1e-01 t_reduction=4.5e-02 tot=3.8e-01 -----
 sigma_tot[inter] counter=147 t=1.8e-02 per=4.8e+00 cost=5.4e+08 flops=3.0e+10
 sigma_tot[gemm] counter=147 i=0 t=3.1e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=1 t=2.9e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=147 i=2 t=7.6e-02 per=2.0e+01 cost=4.7e+08 flops=6.2e+09
 sigma_tot[gemm] counter=147 i=3 t=9.5e-02 per=2.5e+01 cost=4.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=147 i=4 t=7.1e-02 per=1.9e+01 cost=3.9e+08 flops=5.5e+09
 sigma_tot[gemm] counter=147 i=5 t=7.2e-02 per=1.9e+01 cost=4.0e+08 flops=5.6e+09
 sigma_tot[gemm] counter=147 total t=3.1e-01 per=8.3e+01 cost=1.7e+09 flops=5.5e+09
 sigma_tot[red] counter=147 t=4.5e-02 per=1.2e+01 cost=1.1e+08 flops=2.6e+09
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.3e-05,2.3e-06,5.1e-06,4.9e-07
    3   0 -    -116.542041303054 -4.205e-06  7.189e-04    3     3  6.301e-03 2.100e-03 2.037e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.738e-05,1.045e-04,1.426e-03,2.810e-04,1.885e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.312e-05 speed=6.579e-01GB/S T(nccl)=4.426e-05 speed=3.438e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=1.4e-03 t_reduction=2.8e-04 tot=1.8e-03 -----
 sigma[inter] counter=148 t=1.0e-04 per=5.8e+00 cost=2.8e+06 flops=2.6e+10
 sigma[gemm] counter=148 i=0 t=2.1e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=1 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=148 i=2 t=3.2e-04 per=1.8e+01 cost=1.4e+06 flops=4.2e+09
 sigma[gemm] counter=148 i=3 t=4.1e-04 per=2.2e+01 cost=1.3e+06 flops=3.3e+09
 sigma[gemm] counter=148 i=4 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=4.1e+09
 sigma[gemm] counter=148 i=5 t=3.4e-04 per=1.9e+01 cost=1.4e+06 flops=4.1e+09
 sigma[gemm] counter=148 total t=1.4e-03 per=7.9e+01 cost=5.5e+06 flops=3.9e+09
 sigma[red] counter=148 t=2.8e-04 per=1.6e+01 cost=4.4e+05 flops=1.6e+09
----- TIMING FOR sigma_tot : t_inter=1.8e-02 t_gemm=3.2e-01 t_reduction=4.5e-02 tot=3.8e-01 -----
 sigma_tot[inter] counter=148 t=1.8e-02 per=4.8e+00 cost=5.4e+08 flops=2.9e+10
 sigma_tot[gemm] counter=148 i=0 t=3.1e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=1 t=2.9e-04 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=148 i=2 t=7.6e-02 per=2.0e+01 cost=4.7e+08 flops=6.2e+09
 sigma_tot[gemm] counter=148 i=3 t=9.5e-02 per=2.5e+01 cost=4.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=148 i=4 t=7.2e-02 per=1.9e+01 cost=4.0e+08 flops=5.5e+09
 sigma_tot[gemm] counter=148 i=5 t=7.2e-02 per=1.9e+01 cost=4.0e+08 flops=5.6e+09
 sigma_tot[gemm] counter=148 total t=3.2e-01 per=8.3e+01 cost=1.7e+09 flops=5.5e+09
 sigma_tot[red] counter=148 t=4.5e-02 per=1.2e+01 cost=1.1e+08 flops=2.6e+09
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.6e-05,1.2e-05,2.2e-06,5.0e-06,4.6e-07
    4   0 -    -116.542042095995 -7.929e-07  3.248e-04    3     4  8.451e-03 2.113e-03 2.047e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.598e-05,1.036e-04,1.474e-03,2.741e-04,1.923e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.216e-05 speed=6.866e-01GB/S T(nccl)=4.382e-05 speed=3.472e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=1.5e-03 t_reduction=2.7e-04 tot=1.9e-03 -----
 sigma[inter] counter=149 t=1.0e-04 per=5.6e+00 cost=2.8e+06 flops=2.7e+10
 sigma[gemm] counter=149 i=0 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=1 t=1.9e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=149 i=2 t=3.4e-04 per=1.9e+01 cost=1.4e+06 flops=4.0e+09
 sigma[gemm] counter=149 i=3 t=4.0e-04 per=2.2e+01 cost=1.3e+06 flops=3.3e+09
 sigma[gemm] counter=149 i=4 t=3.8e-04 per=2.1e+01 cost=1.4e+06 flops=3.7e+09
 sigma[gemm] counter=149 i=5 t=3.4e-04 per=1.9e+01 cost=1.4e+06 flops=4.1e+09
 sigma[gemm] counter=149 total t=1.5e-03 per=8.0e+01 cost=5.5e+06 flops=3.8e+09
 sigma[red] counter=149 t=2.7e-04 per=1.5e+01 cost=4.4e+05 flops=1.6e+09
----- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=3.2e-01 t_reduction=4.5e-02 tot=3.8e-01 -----
 sigma_tot[inter] counter=149 t=1.9e-02 per=4.9e+00 cost=5.5e+08 flops=2.9e+10
 sigma_tot[gemm] counter=149 i=0 t=3.2e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=1 t=3.0e-04 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=149 i=2 t=7.7e-02 per=2.0e+01 cost=4.8e+08 flops=6.2e+09
 sigma_tot[gemm] counter=149 i=3 t=9.6e-02 per=2.5e+01 cost=4.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=149 i=4 t=7.2e-02 per=1.9e+01 cost=4.0e+08 flops=5.5e+09
 sigma_tot[gemm] counter=149 i=5 t=7.3e-02 per=1.9e+01 cost=4.1e+08 flops=5.6e+09
 sigma_tot[gemm] counter=149 total t=3.2e-01 per=8.3e+01 cost=1.7e+09 flops=5.5e+09
 sigma_tot[red] counter=149 t=4.5e-02 per=1.2e+01 cost=1.2e+08 flops=2.5e+09
T(sub)=3.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.2e-05,2.0e-06,4.5e-06,4.4e-07
    5   0 -    -116.542042261507 -1.655e-07  1.376e-04    3     5  1.063e-02 2.126e-03 2.059e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.513e-05,1.036e-04,1.426e-03,2.784e-04,1.879e-03
 analyze_tgpu[Hx]: ndim=1021:7.607e-06GB T(cpu-gpu)=2.193e-05 speed=6.938e-01GB/S T(nccl)=4.320e-05 speed=3.522e-01GB/S
----- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=1.4e-03 t_reduction=2.8e-04 tot=1.8e-03 -----
 sigma[inter] counter=150 t=1.0e-04 per=5.7e+00 cost=2.8e+06 flops=2.7e+10
 sigma[gemm] counter=150 i=0 t=2.0e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=1 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=150 i=2 t=3.3e-04 per=1.8e+01 cost=1.4e+06 flops=4.2e+09
 sigma[gemm] counter=150 i=3 t=4.0e-04 per=2.2e+01 cost=1.3e+06 flops=3.3e+09
 sigma[gemm] counter=150 i=4 t=3.5e-04 per=1.9e+01 cost=1.4e+06 flops=4.0e+09
 sigma[gemm] counter=150 i=5 t=3.4e-04 per=1.9e+01 cost=1.4e+06 flops=4.1e+09
 sigma[gemm] counter=150 total t=1.4e-03 per=7.9e+01 cost=5.5e+06 flops=3.9e+09
 sigma[red] counter=150 t=2.8e-04 per=1.5e+01 cost=4.4e+05 flops=1.6e+09
----- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=3.2e-01 t_reduction=4.6e-02 tot=3.8e-01 -----
 sigma_tot[inter] counter=150 t=1.9e-02 per=4.9e+00 cost=5.5e+08 flops=2.9e+10
 sigma_tot[gemm] counter=150 i=0 t=3.2e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=1 t=3.0e-04 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=150 i=2 t=7.7e-02 per=2.0e+01 cost=4.8e+08 flops=6.2e+09
 sigma_tot[gemm] counter=150 i=3 t=9.6e-02 per=2.5e+01 cost=4.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=150 i=4 t=7.2e-02 per=1.9e+01 cost=4.0e+08 flops=5.5e+09
 sigma_tot[gemm] counter=150 i=5 t=7.3e-02 per=1.9e+01 cost=4.1e+08 flops=5.6e+09
 sigma_tot[gemm] counter=150 total t=3.2e-01 per=8.3e+01 cost=1.8e+09 flops=5.5e+09
 sigma_tot[red] counter=150 t=4.6e-02 per=1.2e+01 cost=1.2e+08 flops=2.5e+09
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.2e-05,2.1e-06,4.7e-06,4.3e-07
    6   0 +    -116.542042290831 -2.932e-08  5.935e-05    3     6  1.275e-02 2.126e-03 2.058e-03
TIMING FOR Davidson : 1.277e-02  T(cal/comm/rest)=1.235e-02,2.776e-06,4.224e-04
decomposed t_rest=4.224e-04
 T(sub)    =1.716e-04 per=4.063e+01
 T(precond)=2.125e-05 per=5.030e+00
 T(ortho)  =1.867e-05 per=4.421e+00
 T(xcopy)  =2.169e-06 per=5.135e-01
 T(xnrm2)  =3.471e-06 per=8.217e-01
 T(other)  =2.052e-04 per=4.859e+01
optimized energies: isweep=0 ibond=21 dots=1 e[0]=-116.542042290831 nmvp=6
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=6.485e-04 change=1.230e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=16 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond21.txt
 qbond: qsuper nsym=16 dimAll=168
 (6,-2):13 (8,-2):30 (7,-3):24 (7,-1):15 (5,-3):4 (6,-4):8 (9,-1):17 (5,-1):1 (10,-2):11 (9,-3):16 (8,-4):12 (11,-1):3 (8,0):6 (10,0):3 (6,0):1 (7,-5):4
timing for divide=2.8e-06
timing for compute=1.5e-04
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 1.7e-04 S T(divide/compute[cpu/gpu/rest]/collect)=2.8e-06,1.4e-04,0.0e+00,1.3e-05,1.4e-05 -----
decimation summary: 168->58 dwt=-2.220e-16 SvN=1.742e+00
 qbond: qkept nsym=9 dimAll=58
 (9,-3):11 (8,-2):9 (7,-3):9 (9,-1):9 (10,-2):8 (8,-4):5 (7,-1):3 (11,-1):3 (7,-5):1
----- TIMING for decimation_row(nkr): 1.236e-03 S T(decim/select/formRot)=2.174e-04,9.922e-04,2.649e-05 -----
----- TIMING FOR onedot_decimation: 1.285e-03 S T(wf/decim)=3.581e-05,1.249e-03 -----
ctns::oper_renorm coord=(14,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:12 S:14 H:1 A:33 B:39 
        dim(bra,ket)=58,58 size(op)=472:3.601e-03MB size(tot)=25825:1.970e-01MB:1.924e-04GB
        per(mem): C:13.4 S:13.2 H:1.83 A:20.7 B:50.9 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=6.485e-04 change=1.625e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=85 : 1.004e-04 S -----
rank=0 GPUmem(GB): used=3.070e-04 (oper)=2.924e-04
rank=0 GPUmem(GB): used=3.146e-04 (oper,site)=2.924e-04,7.607e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=85
 no. of rintermediate operators=7
 no. of coefficients=85:6.485e-04MB:6.333e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.773e-05 S -----
rank=0 GPUmem(GB): used=3.152e-04 (oper,site,rinter)=2.924e-04,7.607e-06,6.333e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 4.051e-04 S size(rtasks)=85 size(Rlst2)=81 T(Rmu/Rlist)=5.856e-05,3.465e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 5.306e-04 S size(rtasks)=85 size(Rlst)=1079 -----
rank=0 GPUmem(GB): used=3.152e-04 avail=3.829e+01 total=3.829e+01 batch[need]=2.468e-03 blksize=121 blksize0=64 batchsize=1079
rank=0 GPUmem(GB): used=2.783e-03 (oper,site,rinter,batch)=2.924e-04,7.607e-06,6.333e-07,2.468e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.465e-04,1.019e-03,2.796e-04
----- TIMING FOR renorm : t_inter=1.5e-04 t_gemm=1.0e-03 t_reduction=2.8e-04 tot=1.4e-03 -----
 renorm[inter] counter=492 t=1.5e-04 per=1.0e+01 cost=1.3e+05 flops=8.9e+08
 renorm[gemm] counter=492 i=0 t=2.0e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=492 i=1 t=1.8e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=492 i=2 t=2.2e-04 per=1.5e+01 cost=1.3e+05 flops=6.0e+08
 renorm[gemm] counter=492 i=3 t=3.7e-04 per=2.6e+01 cost=4.9e+05 flops=1.3e+09
 renorm[gemm] counter=492 i=4 t=1.8e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=492 i=5 t=1.9e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=492 i=6 t=4.3e-04 per=2.9e+01 cost=8.4e+05 flops=2.0e+09
 renorm[gemm] counter=492 total t=1.0e-03 per=7.1e+01 cost=1.5e+06 flops=1.4e+09
 renorm[red] counter=492 t=2.8e-04 per=1.9e+01 cost=1.3e+05 flops=4.6e+08
----- TIMING FOR renorm_tot : t_inter=2.7e-03 t_gemm=2.1e-02 t_reduction=5.3e-03 tot=2.9e-02 -----
 renorm_tot[inter] counter=492 t=2.7e-03 per=9.3e+00 cost=1.7e+07 flops=6.2e+09
 renorm_tot[gemm] counter=492 i=0 t=4.7e-05 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=492 i=1 t=4.2e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=492 i=2 t=8.9e-04 per=3.1e+00 cost=1.9e+05 flops=2.1e+08
 renorm_tot[gemm] counter=492 i=3 t=1.3e-03 per=4.5e+00 cost=6.6e+05 flops=5.2e+08
 renorm_tot[gemm] counter=492 i=4 t=4.6e-03 per=1.6e+01 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=492 i=5 t=6.4e-03 per=2.3e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=492 i=6 t=7.3e-03 per=2.6e+01 cost=4.6e+07 flops=6.3e+09
 renorm_tot[gemm] counter=492 total t=2.1e-02 per=7.2e+01 cost=8.1e+07 flops=3.9e+09
 renorm_tot[red] counter=492 t=5.3e-03 per=1.8e+01 cost=5.5e+06 flops=1.0e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.247e-04 (oper)=2.949e-04
rank=0 GPUmem(GB): used=3.323e-04 (oper,site,rinter)=2.949e-04,7.607e-06,1.460e-05
rank=0 GPUmem(GB): used=4.558e-04 (oper,site,rinter,batch)=2.949e-04,7.607e-06,1.460e-05,1.234e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.740e-02 S T(preprocess/alloc/comp/red/dealloc)=2.036e-03,2.105e-03,1.356e-02,1.441e-03,2.367e-04 -----
----- TIMING FOR oper_renorm_opS : 1.746e-02 S rank=0 -----
qops.to_cpu: size(tot)=25825:1.970e-01MB:1.924e-04GB T(to_cpu)=1.883e-04S speed=1.022e+00GB/S
check ||H-H.dagger||=3.176e-14 coord=(14,0) rank=0
----- TIMING FOR oper_renorm : 0.0214 S rank=0 -----
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=6.409e-04 change=4.812e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=2.014e-03 change=-1.507e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=2.014e-03 change=-9.626e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 4.614e-02 S #####
 T(local opt: fetch) = 2.869e-03 S  per = 6.22  per(accum) = 6.22
 T(local opt: hdiag) = 6.377e-04 S  per = 1.38  per(accum) = 7.6
 T(local opt: dvdsn) = 1.707e-02 S  per =   37  per(accum) = 44.6
 T(local opt: decim) = 1.320e-03 S  per = 2.86  per(accum) = 47.5
 T(local opt: guess) = 5.341e-05 S  per = 0.116  per(accum) = 47.6
 T(local opt: renrm) = 2.214e-02 S  per =   48  per(accum) = 95.6
 T(local opt: save ) = 2.045e-03 S  per = 4.43  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.707e-02 S  T(sum) = 1.661e-02 S  per = 9.731e+01
 T(local opt: preprocess                  ) = 5.224e-05 S  per = 0.314  per(accum) = 0.314
 T(local opt: symbolic_formulae           ) = 6.376e-04 S  per = 3.84  per(accum) = 4.15
 T(local opt: hintermediate init          ) = 3.975e-05 S  per = 0.239  per(accum) = 4.39
 T(local opt: preprocess_hformulae_Hxlist ) = 1.363e-03 S  per =  8.2  per(accum) = 12.6
 T(local opt: hmmtasks init               ) = 1.741e-03 S  per = 10.5  per(accum) = 23.1
 T(local opt: initial guess for dvdson    ) = 4.381e-06 S  per = 0.0264  per(accum) = 23.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.194e-02 S  per = 71.9  per(accum) = 95
 T(local opt: dvdson [cpu-gpu]            ) = 1.382e-04 S  per = 0.832  per(accum) = 95.8
 T(local opt: dvdson [nccl]               ) = 2.735e-04 S  per = 1.65  per(accum) = 97.4
 T(local opt: dvdson [mpi]                ) = 2.776e-06 S  per = 0.0167  per(accum) = 97.5
 T(local opt: dvdson [rest part(linalg)]  ) = 4.224e-04 S  per = 2.54  per(accum) = 100
Detailed decomposition of T(renrm) = 2.214e-02 S  T(sum) = 2.214e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.977e-05 S  per = 0.225  per(accum) = 0.225
 T(local opt: qops init                    ) = 4.293e-04 S  per = 1.94  per(accum) = 2.16
 T(local opt: symbolic_formulae_renorm     ) = 1.126e-04 S  per = 0.508  per(accum) = 2.67
 T(local opt: allocate qops on gpu         ) = 6.180e-05 S  per = 0.279  per(accum) = 2.95
 T(local opt: site memcpy cpu2gpu          ) = 3.219e-05 S  per = 0.145  per(accum) = 3.1
 T(local opt: rintermediate init           ) = 5.416e-05 S  per = 0.245  per(accum) = 3.34
 T(local opt: preprocess_formulae_Rlist2   ) = 5.435e-04 S  per = 2.45  per(accum) = 5.8
 T(local opt: rmmtasks init                ) = 5.823e-04 S  per = 2.63  per(accum) = 8.43
 T(local opt: qops memset on cpu           ) = 6.500e-08 S  per = 0.000294  per(accum) = 8.43
 T(local opt: preprocess_renorm_batchGPU   ) = 1.649e-03 S  per = 7.45  per(accum) = 15.9
 T(local opt: deallocate cpu and gpu memory) = 1.805e-04 S  per = 0.815  per(accum) = 16.7
 T(local opt: construct opS [ifdists=true] ) = 1.748e-02 S  per = 78.9  per(accum) = 95.6
 T(local opt: reduction of opS & opH [nccl]) = 2.284e-05 S  per = 0.103  per(accum) = 95.7
 T(local opt: qops memcpy gpu2cpu          ) = 2.022e-04 S  per = 0.913  per(accum) = 96.6
 T(local opt: reduction of opS & opH [mpi] ) = 1.461e-05 S  per = 0.066  per(accum) = 96.7
 T(local opt: qops_pool join and erase     ) = 7.262e-04 S  per = 3.28  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.165e-06 S  per = 0.00526  per(accum) = 100
ctns::rcanon_save_site idx=5 scratch=./scratch/sweep size=1021:7.6e-06GB T(load)=0.00062S speed=0.012GB/S
##### sweep opt: 1.127e+00 S #####
 T(sweep opt: fetch) = 7.166e-02 S  per = 6.36  per(accum) = 6.36
 T(sweep opt: hdiag) = 1.667e-02 S  per = 1.48  per(accum) = 7.83
 T(sweep opt: dvdsn) = 5.652e-01 S  per = 50.1  per(accum) = 58
 T(sweep opt: decim) = 2.398e-02 S  per = 2.13  per(accum) = 60.1
 T(sweep opt: guess) = 1.128e-03 S  per =  0.1  per(accum) = 60.2
 T(sweep opt: renrm) = 4.047e-01 S  per = 35.9  per(accum) = 96.1
 T(sweep opt: save ) = 4.408e-02 S  per = 3.91  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.652e-01 S  T(sum) = 5.544e-01 S  per = 9.809e+01
 T(sweep opt: preprocess                  ) = 1.448e-03 S  per = 0.261  per(accum) = 0.261
 T(sweep opt: symbolic_formulae           ) = 1.613e-02 S  per = 2.91  per(accum) = 3.17
 T(sweep opt: hintermediate init          ) = 1.225e-03 S  per = 0.221  per(accum) = 3.39
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.202e-02 S  per = 9.38  per(accum) = 12.8
 T(sweep opt: hmmtasks init               ) = 5.336e-02 S  per = 9.62  per(accum) = 22.4
 T(sweep opt: initial guess for dvdson    ) = 1.204e-04 S  per = 0.0217  per(accum) = 22.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.095e-01 S  per = 73.9  per(accum) = 96.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.569e-03 S  per = 0.644  per(accum) = 96.9
 T(sweep opt: dvdson [nccl]               ) = 7.136e-03 S  per = 1.29  per(accum) = 98.2
 T(sweep opt: dvdson [mpi]                ) = 6.474e-05 S  per = 0.0117  per(accum) = 98.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 9.907e-03 S  per = 1.79  per(accum) = 100
Detailed decomposition of T(renrm) = 4.047e-01 S  T(sum) = 4.047e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.061e-03 S  per = 0.262  per(accum) = 0.262
 T(sweep opt: qops init                    ) = 9.796e-03 S  per = 2.42  per(accum) = 2.68
 T(sweep opt: symbolic_formulae_renorm     ) = 9.075e-03 S  per = 2.24  per(accum) = 4.92
 T(sweep opt: allocate qops on gpu         ) = 1.422e-03 S  per = 0.351  per(accum) = 5.28
 T(sweep opt: site memcpy cpu2gpu          ) = 5.068e-04 S  per = 0.125  per(accum) = 5.4
 T(sweep opt: rintermediate init           ) = 1.054e-03 S  per = 0.26  per(accum) = 5.66
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.697e-02 S  per = 4.19  per(accum) = 9.85
 T(sweep opt: rmmtasks init                ) = 1.842e-02 S  per = 4.55  per(accum) = 14.4
 T(sweep opt: qops memset on cpu           ) = 1.002e-06 S  per = 0.000248  per(accum) = 14.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.154e-02 S  per = 7.79  per(accum) = 22.2
 T(sweep opt: deallocate cpu and gpu memory) = 2.812e-03 S  per = 0.695  per(accum) = 22.9
 T(sweep opt: construct opS [ifdists=true] ) = 2.873e-01 S  per =   71  per(accum) = 93.9
 T(sweep opt: reduction of opS & opH [nccl]) = 5.699e-04 S  per = 0.141  per(accum) = 94
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.385e-03 S  per = 0.589  per(accum) = 94.6
 T(sweep opt: reduction of opS & opH [mpi] ) = 5.934e-04 S  per = 0.147  per(accum) = 94.7
 T(sweep opt: qops_pool join and erase     ) = 1.444e-02 S  per = 3.57  per(accum) = 98.3
 T(sweep opt: conversion from opAB to opPQ ) = 6.835e-03 S  per = 1.69  per(accum) = 100
##### global opt: 1.127e+00 S #####
 T(global opt: fetch) = 7.166e-02 S  per = 6.36  per(accum) = 6.36
 T(global opt: hdiag) = 1.667e-02 S  per = 1.48  per(accum) = 7.83
 T(global opt: dvdsn) = 5.652e-01 S  per = 50.1  per(accum) = 58
 T(global opt: decim) = 2.398e-02 S  per = 2.13  per(accum) = 60.1
 T(global opt: guess) = 1.128e-03 S  per =  0.1  per(accum) = 60.2
 T(global opt: renrm) = 4.047e-01 S  per = 35.9  per(accum) = 96.1
 T(global opt: save ) = 4.408e-02 S  per = 3.91  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.652e-01 S  T(sum) = 5.544e-01 S  per = 9.809e+01
 T(global opt: preprocess                  ) = 1.448e-03 S  per = 0.261  per(accum) = 0.261
 T(global opt: symbolic_formulae           ) = 1.613e-02 S  per = 2.91  per(accum) = 3.17
 T(global opt: hintermediate init          ) = 1.225e-03 S  per = 0.221  per(accum) = 3.39
 T(global opt: preprocess_hformulae_Hxlist ) = 5.202e-02 S  per = 9.38  per(accum) = 12.8
 T(global opt: hmmtasks init               ) = 5.336e-02 S  per = 9.62  per(accum) = 22.4
 T(global opt: initial guess for dvdson    ) = 1.204e-04 S  per = 0.0217  per(accum) = 22.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.095e-01 S  per = 73.9  per(accum) = 96.3
 T(global opt: dvdson [cpu-gpu]            ) = 3.569e-03 S  per = 0.644  per(accum) = 96.9
 T(global opt: dvdson [nccl]               ) = 7.136e-03 S  per = 1.29  per(accum) = 98.2
 T(global opt: dvdson [mpi]                ) = 6.474e-05 S  per = 0.0117  per(accum) = 98.2
 T(global opt: dvdson [rest part(linalg)]  ) = 9.907e-03 S  per = 1.79  per(accum) = 100
Detailed decomposition of T(renrm) = 4.047e-01 S  T(sum) = 4.047e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.061e-03 S  per = 0.262  per(accum) = 0.262
 T(global opt: qops init                    ) = 9.796e-03 S  per = 2.42  per(accum) = 2.68
 T(global opt: symbolic_formulae_renorm     ) = 9.075e-03 S  per = 2.24  per(accum) = 4.92
 T(global opt: allocate qops on gpu         ) = 1.422e-03 S  per = 0.351  per(accum) = 5.28
 T(global opt: site memcpy cpu2gpu          ) = 5.068e-04 S  per = 0.125  per(accum) = 5.4
 T(global opt: rintermediate init           ) = 1.054e-03 S  per = 0.26  per(accum) = 5.66
 T(global opt: preprocess_formulae_Rlist2   ) = 1.697e-02 S  per = 4.19  per(accum) = 9.85
 T(global opt: rmmtasks init                ) = 1.842e-02 S  per = 4.55  per(accum) = 14.4
 T(global opt: qops memset on cpu           ) = 1.002e-06 S  per = 0.000248  per(accum) = 14.4
 T(global opt: preprocess_renorm_batchGPU   ) = 3.154e-02 S  per = 7.79  per(accum) = 22.2
 T(global opt: deallocate cpu and gpu memory) = 2.812e-03 S  per = 0.695  per(accum) = 22.9
 T(global opt: construct opS [ifdists=true] ) = 2.873e-01 S  per =   71  per(accum) = 93.9
 T(global opt: reduction of opS & opH [nccl]) = 5.699e-04 S  per = 0.141  per(accum) = 94
 T(global opt: qops memcpy gpu2cpu          ) = 2.385e-03 S  per = 0.589  per(accum) = 94.6
 T(global opt: reduction of opS & opH [mpi] ) = 5.934e-04 S  per = 0.147  per(accum) = 94.7
 T(global opt: qops_pool join and erase     ) = 1.444e-02 S  per = 3.57  per(accum) = 98.3
 T(global opt: conversion from opAB to opPQ ) = 6.835e-03 S  per = 1.69  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.234e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=22/seqsize=34 dots=1 dbond=(12,0)-(13,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=7 scratch=./scratch/sweep size=1941:1.45e-05GB T(load)=3.07e-04S speed=4.70e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=3434:2.62e-02MB:2.56e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1493:1.14e-02MB:1.11e-05GB
total mem of comb=5075:3.87e-02MB:3.78e-05GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=1.945e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=13,6,1
 suppl= 0 1 2 3 4 5 6 7 8 16 17 18 19
 suppr= 10 11 12 13 14 15
 suppc= 9
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(12,0)
 fqop[1]=./scratch/sweep/rop(14,0)
 fqop[2]=./scratch/sweep/cop(13,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:26 S:7 H:1 P:47 Q:51 
        dim(bra,ket)=68,68 size(op)=652:4.974e-03MB size(tot)=47596:3.631e-01MB:3.546e-04GB
        per(mem): C:20 S:4.77 H:1.37 P:22.2 Q:51.7 
 rqops: oplist=CSHAB nops=C:12 S:14 H:1 A:33 B:39 
        dim(bra,ket)=58,58 size(op)=472:0.0036MB size(tot)=25825:0.197MB:0.000192GB
        per(mem): C:13.4 S:13.2 H:1.83 A:20.7 B:50.9 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=75757:0.578MB:0.000564GB
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.442e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(13,0) fdel=./scratch/sweep/lop(12,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=3.586e-04 change=-3.582e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(68,58,4) nnz=1493:1.139e-02MB
qtensor3: wf3 own=1 _data=0x55b2c6a7d000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=68
 (19,3):14 (19,1):12 (21,3):10 (20,2):9 (18,2):7 (21,1):6 (20,4):6 (17,1):3 (21,5):1
 qbond: qcol nsym=9 dimAll=58
 (9,-3):11 (8,-2):9 (7,-3):9 (9,-1):9 (10,-2):8 (8,-4):5 (7,-1):3 (11,-1):3 (7,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=23 nblocks=324 size=1493:1.139e-02MB
### DIAG TIMING: total=8.783e-04 t1=2.457e-05, t2=2.529e-05, t3=1.436e-05, t4=7.474e-04, t5=1.253e-05, t6=4.282e-05, t7=1.140e-05
duration_diagGPU:8.981e-04
duration_diagreduce:7.100e-08
duration_diagtransform:2.249e-06
----- TIMING FOR symbolic_formulae_onedot with size=408 : 1.124e-03 S -----
rank=0 GPUmem(GB): used=5.644e-04 (oper)=5.644e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=408
 no. of hintermediate operators=195
 no. of coefficients=2535:1.934e-02MB:1.889e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.948e-05 S -----
rank=0 GPUmem(GB): used=5.833e-04 (oper,hinter)=5.644e-04,1.889e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.628e-03 S size(H_formulae)=408 size(Hxlst2)=23 T(Hmu/Hxlist)=2.299e-04,2.398e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.513e-03 S size(H_formulae)=408 size(Hxlst)=5860 -----
rank=0 GPUmem(GB): used=5.833e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=2.225e-05 batch[need]=1.899e-02 blksize=154 blksize0=126 batchsize=5860
rank=0 GPUmem(GB): used=1.960e-02 (oper,hinter,dvdson,batch)=5.644e-04,1.889e-05,2.225e-05,1.899e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=1493 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.891e-05,1.861e-04,3.211e-03,4.015e-04,3.905e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=3.066e-05 speed=7.256e-01GB/S T(nccl)=5.826e-05 speed=3.819e-01GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=3.2e-03 t_reduction=4.0e-04 tot=3.8e-03 -----
 sigma[inter] counter=151 t=1.9e-04 per=4.9e+00 cost=4.5e+06 flops=2.4e+10
 sigma[gemm] counter=151 i=0 t=3.1e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=1 t=2.4e-06 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=151 i=2 t=7.6e-04 per=2.0e+01 cost=3.4e+06 flops=4.4e+09
 sigma[gemm] counter=151 i=3 t=9.2e-04 per=2.4e+01 cost=3.3e+06 flops=3.6e+09
 sigma[gemm] counter=151 i=4 t=7.7e-04 per=2.0e+01 cost=3.1e+06 flops=4.0e+09
 sigma[gemm] counter=151 i=5 t=7.6e-04 per=2.0e+01 cost=3.1e+06 flops=4.1e+09
 sigma[gemm] counter=151 total t=3.2e-03 per=8.5e+01 cost=1.3e+07 flops=4.0e+09
 sigma[red] counter=151 t=4.0e-04 per=1.1e+01 cost=8.4e+05 flops=2.1e+09
----- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=3.2e-01 t_reduction=4.6e-02 tot=3.9e-01 -----
 sigma_tot[inter] counter=151 t=1.9e-02 per=4.9e+00 cost=5.5e+08 flops=2.9e+10
 sigma_tot[gemm] counter=151 i=0 t=3.2e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=1 t=3.0e-04 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=151 i=2 t=7.8e-02 per=2.0e+01 cost=4.8e+08 flops=6.2e+09
 sigma_tot[gemm] counter=151 i=3 t=9.7e-02 per=2.5e+01 cost=4.7e+08 flops=4.9e+09
 sigma_tot[gemm] counter=151 i=4 t=7.3e-02 per=1.9e+01 cost=4.0e+08 flops=5.5e+09
 sigma_tot[gemm] counter=151 i=5 t=7.4e-02 per=1.9e+01 cost=4.1e+08 flops=5.6e+09
 sigma_tot[gemm] counter=151 total t=3.2e-01 per=8.3e+01 cost=1.8e+09 flops=5.5e+09
 sigma_tot[red] counter=151 t=4.6e-02 per=1.2e+01 cost=1.2e+08 flops=2.5e+09
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,4.2e-06,1.5e-06,2.7e-06,8.5e-07
settings: ndim=1493 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.542042290831 -1.117e+03  8.691e-03    1     1  4.358e-03 4.358e-03 4.308e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.515e-05,1.513e-04,3.275e-03,3.997e-04,3.920e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.904e-05 speed=7.661e-01GB/S T(nccl)=5.611e-05 speed=3.965e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=3.3e-03 t_reduction=4.0e-04 tot=3.8e-03 -----
 sigma[inter] counter=152 t=1.5e-04 per=4.0e+00 cost=4.5e+06 flops=3.0e+10
 sigma[gemm] counter=152 i=0 t=2.8e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=1 t=2.4e-06 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=152 i=2 t=7.4e-04 per=1.9e+01 cost=3.4e+06 flops=4.5e+09
 sigma[gemm] counter=152 i=3 t=9.7e-04 per=2.5e+01 cost=3.3e+06 flops=3.4e+09
 sigma[gemm] counter=152 i=4 t=7.8e-04 per=2.0e+01 cost=3.1e+06 flops=3.9e+09
 sigma[gemm] counter=152 i=5 t=7.8e-04 per=2.0e+01 cost=3.1e+06 flops=4.0e+09
 sigma[gemm] counter=152 total t=3.3e-03 per=8.6e+01 cost=1.3e+07 flops=3.9e+09
 sigma[red] counter=152 t=4.0e-04 per=1.0e+01 cost=8.4e+05 flops=2.1e+09
----- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=3.3e-01 t_reduction=4.6e-02 tot=3.9e-01 -----
 sigma_tot[inter] counter=152 t=1.9e-02 per=4.8e+00 cost=5.6e+08 flops=2.9e+10
 sigma_tot[gemm] counter=152 i=0 t=3.2e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=1 t=3.0e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=152 i=2 t=7.8e-02 per=2.0e+01 cost=4.8e+08 flops=6.2e+09
 sigma_tot[gemm] counter=152 i=3 t=9.8e-02 per=2.5e+01 cost=4.8e+08 flops=4.9e+09
 sigma_tot[gemm] counter=152 i=4 t=7.4e-02 per=1.9e+01 cost=4.1e+08 flops=5.5e+09
 sigma_tot[gemm] counter=152 i=5 t=7.5e-02 per=1.9e+01 cost=4.1e+08 flops=5.5e+09
 sigma_tot[gemm] counter=152 total t=3.3e-01 per=8.3e+01 cost=1.8e+09 flops=5.5e+09
 sigma_tot[red] counter=152 t=4.6e-02 per=1.2e+01 cost=1.2e+08 flops=2.5e+09
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,1.4e-05,4.0e-06,5.7e-06,9.8e-07
    2   0 -    -116.542133862595 -9.157e-05  2.551e-03    2     2  8.750e-03 4.375e-03 4.282e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.795e-05,1.532e-04,3.245e-03,4.008e-04,3.885e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.831e-05 speed=7.859e-01GB/S T(nccl)=4.964e-05 speed=4.482e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=3.2e-03 t_reduction=4.0e-04 tot=3.8e-03 -----
 sigma[inter] counter=153 t=1.5e-04 per=4.0e+00 cost=4.5e+06 flops=3.0e+10
 sigma[gemm] counter=153 i=0 t=2.8e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=1 t=2.4e-06 per=6.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=153 i=2 t=7.4e-04 per=1.9e+01 cost=3.4e+06 flops=4.6e+09
 sigma[gemm] counter=153 i=3 t=9.7e-04 per=2.5e+01 cost=3.3e+06 flops=3.4e+09
 sigma[gemm] counter=153 i=4 t=7.7e-04 per=2.0e+01 cost=3.1e+06 flops=4.0e+09
 sigma[gemm] counter=153 i=5 t=7.7e-04 per=2.0e+01 cost=3.1e+06 flops=4.0e+09
 sigma[gemm] counter=153 total t=3.2e-03 per=8.5e+01 cost=1.3e+07 flops=3.9e+09
 sigma[red] counter=153 t=4.0e-04 per=1.1e+01 cost=8.4e+05 flops=2.1e+09
----- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=3.3e-01 t_reduction=4.7e-02 tot=3.9e-01 -----
 sigma_tot[inter] counter=153 t=1.9e-02 per=4.8e+00 cost=5.6e+08 flops=2.9e+10
 sigma_tot[gemm] counter=153 i=0 t=3.3e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=1 t=3.1e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=153 i=2 t=7.9e-02 per=2.0e+01 cost=4.9e+08 flops=6.1e+09
 sigma_tot[gemm] counter=153 i=3 t=9.9e-02 per=2.5e+01 cost=4.8e+08 flops=4.9e+09
 sigma_tot[gemm] counter=153 i=4 t=7.5e-02 per=1.9e+01 cost=4.1e+08 flops=5.5e+09
 sigma_tot[gemm] counter=153 i=5 t=7.5e-02 per=1.9e+01 cost=4.2e+08 flops=5.5e+09
 sigma_tot[gemm] counter=153 total t=3.3e-01 per=8.3e+01 cost=1.8e+09 flops=5.4e+09
 sigma_tot[red] counter=153 t=4.7e-02 per=1.2e+01 cost=1.2e+08 flops=2.5e+09
T(sub)=5.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-05,1.7e-05,2.8e-06,9.0e-06,9.9e-07
    3   0 -    -116.542144321140 -1.046e-05  1.255e-03    3     3  1.305e-02 4.349e-03 4.254e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.027e-05,1.442e-04,2.687e-03,3.138e-04,3.223e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.412e-05 speed=9.223e-01GB/S T(nccl)=4.615e-05 speed=4.821e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=2.7e-03 t_reduction=3.1e-04 tot=3.1e-03 -----
 sigma[inter] counter=154 t=1.4e-04 per=4.6e+00 cost=4.5e+06 flops=3.1e+10
 sigma[gemm] counter=154 i=0 t=2.7e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=1 t=2.4e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=154 i=2 t=7.6e-04 per=2.4e+01 cost=3.4e+06 flops=4.4e+09
 sigma[gemm] counter=154 i=3 t=7.8e-04 per=2.5e+01 cost=3.3e+06 flops=4.2e+09
 sigma[gemm] counter=154 i=4 t=5.7e-04 per=1.8e+01 cost=3.1e+06 flops=5.4e+09
 sigma[gemm] counter=154 i=5 t=5.8e-04 per=1.8e+01 cost=3.1e+06 flops=5.4e+09
 sigma[gemm] counter=154 total t=2.7e-03 per=8.5e+01 cost=1.3e+07 flops=4.8e+09
 sigma[red] counter=154 t=3.1e-04 per=1.0e+01 cost=8.4e+05 flops=2.7e+09
----- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=3.3e-01 t_reduction=4.7e-02 tot=4.0e-01 -----
 sigma_tot[inter] counter=154 t=1.9e-02 per=4.8e+00 cost=5.7e+08 flops=2.9e+10
 sigma_tot[gemm] counter=154 i=0 t=3.3e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=1 t=3.1e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=154 i=2 t=8.0e-02 per=2.0e+01 cost=4.9e+08 flops=6.1e+09
 sigma_tot[gemm] counter=154 i=3 t=1.0e-01 per=2.5e+01 cost=4.8e+08 flops=4.8e+09
 sigma_tot[gemm] counter=154 i=4 t=7.5e-02 per=1.9e+01 cost=4.1e+08 flops=5.5e+09
 sigma_tot[gemm] counter=154 i=5 t=7.6e-02 per=1.9e+01 cost=4.2e+08 flops=5.5e+09
 sigma_tot[gemm] counter=154 total t=3.3e-01 per=8.3e+01 cost=1.8e+09 flops=5.4e+09
 sigma_tot[red] counter=154 t=4.7e-02 per=1.2e+01 cost=1.2e+08 flops=2.5e+09
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.2e-05,2.1e-06,6.3e-06,6.2e-07
    4   0 -    -116.542147146467 -2.825e-06  6.295e-04    3     4  1.643e-02 4.107e-03 4.018e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.132e-05,1.203e-04,2.453e-03,3.090e-04,2.959e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.805e-05 speed=7.932e-01GB/S T(nccl)=4.327e-05 speed=5.142e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.5e-03 t_reduction=3.1e-04 tot=2.9e-03 -----
 sigma[inter] counter=155 t=1.2e-04 per=4.2e+00 cost=4.5e+06 flops=3.8e+10
 sigma[gemm] counter=155 i=0 t=2.0e-06 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=1 t=2.0e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=155 i=2 t=5.9e-04 per=2.0e+01 cost=3.4e+06 flops=5.7e+09
 sigma[gemm] counter=155 i=3 t=7.2e-04 per=2.5e+01 cost=3.3e+06 flops=4.5e+09
 sigma[gemm] counter=155 i=4 t=5.7e-04 per=2.0e+01 cost=3.1e+06 flops=5.4e+09
 sigma[gemm] counter=155 i=5 t=5.6e-04 per=2.0e+01 cost=3.1e+06 flops=5.5e+09
 sigma[gemm] counter=155 total t=2.5e-03 per=8.5e+01 cost=1.3e+07 flops=5.2e+09
 sigma[red] counter=155 t=3.1e-04 per=1.1e+01 cost=8.4e+05 flops=2.7e+09
----- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=3.3e-01 t_reduction=4.7e-02 tot=4.0e-01 -----
 sigma_tot[inter] counter=155 t=1.9e-02 per=4.8e+00 cost=5.7e+08 flops=2.9e+10
 sigma_tot[gemm] counter=155 i=0 t=3.3e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=1 t=3.1e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=155 i=2 t=8.1e-02 per=2.0e+01 cost=4.9e+08 flops=6.1e+09
 sigma_tot[gemm] counter=155 i=3 t=1.0e-01 per=2.5e+01 cost=4.9e+08 flops=4.8e+09
 sigma_tot[gemm] counter=155 i=4 t=7.6e-02 per=1.9e+01 cost=4.1e+08 flops=5.5e+09
 sigma_tot[gemm] counter=155 i=5 t=7.6e-02 per=1.9e+01 cost=4.2e+08 flops=5.5e+09
 sigma_tot[gemm] counter=155 total t=3.3e-01 per=8.3e+01 cost=1.8e+09 flops=5.4e+09
 sigma_tot[red] counter=155 t=4.7e-02 per=1.2e+01 cost=1.2e+08 flops=2.5e+09
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.2e-05,2.0e-06,6.2e-06,6.3e-07
    5   0 -    -116.542147836330 -6.899e-07  3.031e-04    3     5  1.954e-02 3.908e-03 3.825e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.824e-05,1.127e-04,2.379e-03,3.063e-04,2.872e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.496e-05 speed=8.913e-01GB/S T(nccl)=4.328e-05 speed=5.140e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=2.4e-03 t_reduction=3.1e-04 tot=2.8e-03 -----
 sigma[inter] counter=156 t=1.1e-04 per=4.0e+00 cost=4.5e+06 flops=4.0e+10
 sigma[gemm] counter=156 i=0 t=1.9e-06 per=6.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=1 t=1.9e-06 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=156 i=2 t=5.4e-04 per=1.9e+01 cost=3.4e+06 flops=6.2e+09
 sigma[gemm] counter=156 i=3 t=7.0e-04 per=2.5e+01 cost=3.3e+06 flops=4.7e+09
 sigma[gemm] counter=156 i=4 t=5.7e-04 per=2.0e+01 cost=3.1e+06 flops=5.3e+09
 sigma[gemm] counter=156 i=5 t=5.6e-04 per=2.0e+01 cost=3.1e+06 flops=5.5e+09
 sigma[gemm] counter=156 total t=2.4e-03 per=8.5e+01 cost=1.3e+07 flops=5.4e+09
 sigma[red] counter=156 t=3.1e-04 per=1.1e+01 cost=8.4e+05 flops=2.7e+09
----- TIMING FOR sigma_tot : t_inter=1.9e-02 t_gemm=3.4e-01 t_reduction=4.8e-02 tot=4.0e-01 -----
 sigma_tot[inter] counter=156 t=1.9e-02 per=4.8e+00 cost=5.8e+08 flops=3.0e+10
 sigma_tot[gemm] counter=156 i=0 t=3.3e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=1 t=3.1e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=156 i=2 t=8.1e-02 per=2.0e+01 cost=5.0e+08 flops=6.1e+09
 sigma_tot[gemm] counter=156 i=3 t=1.0e-01 per=2.5e+01 cost=4.9e+08 flops=4.8e+09
 sigma_tot[gemm] counter=156 i=4 t=7.6e-02 per=1.9e+01 cost=4.2e+08 flops=5.5e+09
 sigma_tot[gemm] counter=156 i=5 t=7.7e-02 per=1.9e+01 cost=4.3e+08 flops=5.5e+09
 sigma_tot[gemm] counter=156 total t=3.4e-01 per=8.3e+01 cost=1.8e+09 flops=5.4e+09
 sigma_tot[red] counter=156 t=4.8e-02 per=1.2e+01 cost=1.2e+08 flops=2.5e+09
T(sub)=3.4e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.2e-05,2.0e-06,6.2e-06,5.6e-07
    6   0 -    -116.542147994685 -1.584e-07  1.436e-04    3     6  2.257e-02 3.761e-03 3.682e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.630e-05,1.110e-04,2.368e-03,3.120e-04,2.863e-03
 analyze_tgpu[Hx]: ndim=1493:1.112e-05GB T(cpu-gpu)=2.357e-05 speed=9.440e-01GB/S T(nccl)=4.273e-05 speed=5.206e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=2.4e-03 t_reduction=3.1e-04 tot=2.8e-03 -----
 sigma[inter] counter=157 t=1.1e-04 per=4.0e+00 cost=4.5e+06 flops=4.1e+10
 sigma[gemm] counter=157 i=0 t=2.0e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=1 t=1.9e-06 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=157 i=2 t=5.4e-04 per=1.9e+01 cost=3.4e+06 flops=6.2e+09
 sigma[gemm] counter=157 i=3 t=6.9e-04 per=2.5e+01 cost=3.3e+06 flops=4.7e+09
 sigma[gemm] counter=157 i=4 t=5.7e-04 per=2.0e+01 cost=3.1e+06 flops=5.4e+09
 sigma[gemm] counter=157 i=5 t=5.6e-04 per=2.0e+01 cost=3.1e+06 flops=5.5e+09
 sigma[gemm] counter=157 total t=2.4e-03 per=8.5e+01 cost=1.3e+07 flops=5.4e+09
 sigma[red] counter=157 t=3.1e-04 per=1.1e+01 cost=8.4e+05 flops=2.7e+09
----- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=3.4e-01 t_reduction=4.8e-02 tot=4.1e-01 -----
 sigma_tot[inter] counter=157 t=2.0e-02 per=4.8e+00 cost=5.8e+08 flops=3.0e+10
 sigma_tot[gemm] counter=157 i=0 t=3.4e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=1 t=3.1e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=157 i=2 t=8.2e-02 per=2.0e+01 cost=5.0e+08 flops=6.1e+09
 sigma_tot[gemm] counter=157 i=3 t=1.0e-01 per=2.5e+01 cost=4.9e+08 flops=4.8e+09
 sigma_tot[gemm] counter=157 i=4 t=7.7e-02 per=1.9e+01 cost=4.2e+08 flops=5.5e+09
 sigma_tot[gemm] counter=157 i=5 t=7.8e-02 per=1.9e+01 cost=4.3e+08 flops=5.5e+09
 sigma_tot[gemm] counter=157 total t=3.4e-01 per=8.3e+01 cost=1.8e+09 flops=5.4e+09
 sigma_tot[red] counter=157 t=4.8e-02 per=1.2e+01 cost=1.2e+08 flops=2.5e+09
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.4e-05,1.2e-05,2.1e-06,6.2e-06,6.2e-07
    7   0 +    -116.542148034411 -3.973e-08  8.297e-05    3     7  2.582e-02 3.688e-03 3.610e-03
TIMING FOR Davidson : 2.587e-02  T(cal/comm/rest)=2.527e-02,2.780e-06,5.959e-04
decomposed t_rest=5.959e-04
 T(sub)    =2.510e-04 per=4.212e+01
 T(precond)=3.389e-05 per=5.686e+00
 T(ortho)  =3.771e-05 per=6.328e+00
 T(xcopy)  =5.100e-06 per=8.558e-01
 T(xnrm2)  =6.629e-06 per=1.112e+00
 T(other)  =2.616e-04 per=4.389e+01
optimized energies: isweep=0 ibond=22 dots=1 e[0]=-116.542148034411 nmvp=7
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=1.434e-03 change=1.637e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond22.txt
 qbond: qsuper nsym=18 dimAll=232
 (9,-3):34 (8,-2):21 (7,-3):9 (9,-1):21 (10,-2):37 (8,-4):15 (7,-1):3 (11,-1):20 (7,-5):1 (11,-3):19 (12,-2):11 (10,-4):16 (13,-1):3 (9,-5):6 (10,0):9 (8,0):3 (12,0):3 (8,-6):1
timing for divide=2.6e-06
timing for compute=2.3e-04
timing for collect=7.1e-06
----- TMING FOR decimation_genbasis(nkr): 2.4e-04 S T(divide/compute[cpu/gpu/rest]/collect)=2.6e-06,2.3e-04,0.0e+00,2.1e-06,7.1e-06 -----
decimation summary: 232->68 dwt=+0.000e+00 SvN=2.038e+00
 qbond: qkept nsym=9 dimAll=68
 (11,-3):14 (11,-1):12 (9,-3):10 (10,-2):9 (12,-2):7 (9,-1):6 (10,-4):6 (13,-1):3 (9,-5):1
----- TIMING for decimation_row(nkr): 1.366e-03 S T(decim/select/formRot)=2.714e-04,1.080e-03,1.514e-05 -----
----- TIMING FOR onedot_decimation: 1.413e-03 S T(wf/decim)=3.256e-05,1.380e-03 -----
ctns::oper_renorm coord=(13,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:14 S:13 H:1 A:47 B:51 
        dim(bra,ket)=68,68 size(op)=652:4.974e-03MB size(tot)=45154:3.445e-01MB:3.364e-04GB
        per(mem): C:11.3 S:9.33 H:1.44 A:23.4 B:54.5 
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=1.434e-03 change=2.037e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=113 : 1.367e-04 S -----
rank=0 GPUmem(GB): used=5.651e-04 (oper)=5.462e-04
rank=0 GPUmem(GB): used=5.763e-04 (oper,site)=5.462e-04,1.112e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=113
 no. of rintermediate operators=7
 no. of coefficients=120:9.155e-04MB:8.941e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.459e-05 S -----
rank=0 GPUmem(GB): used=5.771e-04 (oper,site,rinter)=5.462e-04,1.112e-05,8.941e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 4.862e-04 S size(rtasks)=113 size(Rlst2)=81 T(Rmu/Rlist)=7.273e-05,4.135e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.499e-04 S size(rtasks)=113 size(Rlst)=1419 -----
rank=0 GPUmem(GB): used=5.771e-04 avail=3.829e+01 total=3.829e+01 batch[need]=5.434e-03 blksize=196 blksize0=121 batchsize=1419
rank=0 GPUmem(GB): used=6.011e-03 (oper,site,rinter,batch)=5.462e-04,1.112e-05,8.941e-07,5.434e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.379e-04,1.701e-03,3.678e-04
----- TIMING FOR renorm : t_inter=1.4e-04 t_gemm=1.7e-03 t_reduction=3.7e-04 tot=2.2e-03 -----
 renorm[inter] counter=521 t=1.4e-04 per=6.2e+00 cost=3.0e+05 flops=2.2e+09
 renorm[gemm] counter=521 i=0 t=1.9e-06 per=8.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=521 i=1 t=1.9e-06 per=8.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=521 i=2 t=3.5e-04 per=1.6e+01 cost=2.6e+05 flops=7.3e+08
 renorm[gemm] counter=521 i=3 t=6.4e-04 per=2.9e+01 cost=1.2e+06 flops=1.9e+09
 renorm[gemm] counter=521 i=4 t=1.9e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=521 i=5 t=1.9e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=521 i=6 t=7.0e-04 per=3.2e+01 cost=1.8e+06 flops=2.6e+09
 renorm[gemm] counter=521 total t=1.7e-03 per=7.7e+01 cost=3.3e+06 flops=1.9e+09
 renorm[red] counter=521 t=3.7e-04 per=1.7e+01 cost=2.2e+05 flops=6.0e+08
----- TIMING FOR renorm_tot : t_inter=2.8e-03 t_gemm=2.2e-02 t_reduction=5.6e-03 tot=3.1e-02 -----
 renorm_tot[inter] counter=521 t=2.8e-03 per=9.1e+00 cost=1.7e+07 flops=6.0e+09
 renorm_tot[gemm] counter=521 i=0 t=4.9e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=521 i=1 t=4.4e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=521 i=2 t=1.2e-03 per=4.1e+00 cost=4.5e+05 flops=3.6e+08
 renorm_tot[gemm] counter=521 i=3 t=1.9e-03 per=6.2e+00 cost=1.9e+06 flops=9.8e+08
 renorm_tot[gemm] counter=521 i=4 t=4.6e-03 per=1.5e+01 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=521 i=5 t=6.4e-03 per=2.1e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=521 i=6 t=8.0e-03 per=2.6e+01 cost=4.8e+07 flops=6.0e+09
 renorm_tot[gemm] counter=521 total t=2.2e-02 per=7.3e+01 cost=8.4e+07 flops=3.8e+09
 renorm_tot[red] counter=521 t=5.6e-03 per=1.8e+01 cost=5.8e+06 flops=1.0e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=5.879e-04 (oper)=5.493e-04
rank=0 GPUmem(GB): used=5.991e-04 (oper,site,rinter)=5.493e-04,1.112e-05,1.889e-05
rank=0 GPUmem(GB): used=8.009e-04 (oper,site,rinter,batch)=5.493e-04,1.112e-05,1.889e-05,2.018e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.757e-02 S T(preprocess/alloc/comp/red/dealloc)=1.908e-03,1.997e-03,1.300e-02,2.344e-03,1.815e-04 -----
----- TIMING FOR oper_renorm_opS : 1.764e-02 S rank=0 -----
qops.to_cpu: size(tot)=45154:3.445e-01MB:3.364e-04GB T(to_cpu)=2.571e-04S speed=1.308e+00GB/S
check ||H-H.dagger||=4.890e-14 coord=(13,0) rank=0
----- TIMING FOR oper_renorm : 0.0226 S rank=0 -----
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=2.182e-03 change=7.149e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=2.495e-03 change=-1.809e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=2.495e-03 change=-1.384e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 6.687e-02 S #####
 T(local opt: fetch) = 3.848e-03 S  per = 5.76  per(accum) = 5.76
 T(local opt: hdiag) = 9.822e-04 S  per = 1.47  per(accum) = 7.22
 T(local opt: dvdsn) = 3.518e-02 S  per = 52.6  per(accum) = 59.8
 T(local opt: decim) = 1.440e-03 S  per = 2.15  per(accum) = 62
 T(local opt: guess) = 6.135e-05 S  per = 0.0918  per(accum) = 62.1
 T(local opt: renrm) = 2.317e-02 S  per = 34.7  per(accum) = 96.7
 T(local opt: save ) = 2.190e-03 S  per = 3.28  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.518e-02 S  T(sum) = 3.453e-02 S  per = 9.816e+01
 T(local opt: preprocess                  ) = 1.050e-04 S  per = 0.304  per(accum) = 0.304
 T(local opt: symbolic_formulae           ) = 1.139e-03 S  per =  3.3  per(accum) = 3.6
 T(local opt: hintermediate init          ) = 1.005e-04 S  per = 0.291  per(accum) = 3.89
 T(local opt: preprocess_hformulae_Hxlist ) = 3.559e-03 S  per = 10.3  per(accum) = 14.2
 T(local opt: hmmtasks init               ) = 3.746e-03 S  per = 10.9  per(accum) = 25.1
 T(local opt: initial guess for dvdson    ) = 9.534e-06 S  per = 0.0276  per(accum) = 25.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.474e-02 S  per = 71.7  per(accum) = 96.7
 T(local opt: dvdson [cpu-gpu]            ) = 1.887e-04 S  per = 0.547  per(accum) = 97.3
 T(local opt: dvdson [nccl]               ) = 3.394e-04 S  per = 0.983  per(accum) = 98.3
 T(local opt: dvdson [mpi]                ) = 2.780e-06 S  per = 0.00805  per(accum) = 98.3
 T(local opt: dvdson [rest part(linalg)]  ) = 5.959e-04 S  per = 1.73  per(accum) = 100
Detailed decomposition of T(renrm) = 2.317e-02 S  T(sum) = 2.317e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.802e-05 S  per = 0.207  per(accum) = 0.207
 T(local opt: qops init                    ) = 4.899e-04 S  per = 2.11  per(accum) = 2.32
 T(local opt: symbolic_formulae_renorm     ) = 1.419e-04 S  per = 0.612  per(accum) = 2.93
 T(local opt: allocate qops on gpu         ) = 5.571e-05 S  per = 0.24  per(accum) = 3.17
 T(local opt: site memcpy cpu2gpu          ) = 2.442e-05 S  per = 0.105  per(accum) = 3.28
 T(local opt: rintermediate init           ) = 3.244e-05 S  per = 0.14  per(accum) = 3.42
 T(local opt: preprocess_formulae_Rlist2   ) = 6.648e-04 S  per = 2.87  per(accum) = 6.29
 T(local opt: rmmtasks init                ) = 7.291e-04 S  per = 3.15  per(accum) = 9.44
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 0.000151  per(accum) = 9.44
 T(local opt: preprocess_renorm_batchGPU   ) = 2.292e-03 S  per = 9.89  per(accum) = 19.3
 T(local opt: deallocate cpu and gpu memory) = 1.854e-04 S  per =  0.8  per(accum) = 20.1
 T(local opt: construct opS [ifdists=true] ) = 1.766e-02 S  per = 76.2  per(accum) = 96.3
 T(local opt: reduction of opS & opH [nccl]) = 2.138e-05 S  per = 0.0922  per(accum) = 96.4
 T(local opt: qops memcpy gpu2cpu          ) = 2.687e-04 S  per = 1.16  per(accum) = 97.6
 T(local opt: reduction of opS & opH [mpi] ) = 4.796e-05 S  per = 0.207  per(accum) = 97.8
 T(local opt: qops_pool join and erase     ) = 5.085e-04 S  per = 2.19  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.530e-07 S  per = 0.00368  per(accum) = 100
ctns::rcanon_save_site idx=6 scratch=./scratch/sweep size=1493:1.1e-05GB T(load)=0.00055S speed=0.02GB/S
##### sweep opt: 1.194e+00 S #####
 T(sweep opt: fetch) = 7.551e-02 S  per = 6.32  per(accum) = 6.32
 T(sweep opt: hdiag) = 1.765e-02 S  per = 1.48  per(accum) = 7.8
 T(sweep opt: dvdsn) = 6.004e-01 S  per = 50.3  per(accum) = 58.1
 T(sweep opt: decim) = 2.542e-02 S  per = 2.13  per(accum) = 60.2
 T(sweep opt: guess) = 1.189e-03 S  per = 0.0996  per(accum) = 60.3
 T(sweep opt: renrm) = 4.279e-01 S  per = 35.8  per(accum) = 96.1
 T(sweep opt: save ) = 4.627e-02 S  per = 3.87  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.004e-01 S  T(sum) = 5.890e-01 S  per = 9.810e+01
 T(sweep opt: preprocess                  ) = 1.553e-03 S  per = 0.264  per(accum) = 0.264
 T(sweep opt: symbolic_formulae           ) = 1.727e-02 S  per = 2.93  per(accum) = 3.2
 T(sweep opt: hintermediate init          ) = 1.325e-03 S  per = 0.225  per(accum) = 3.42
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.558e-02 S  per = 9.44  per(accum) = 12.9
 T(sweep opt: hmmtasks init               ) = 5.710e-02 S  per =  9.7  per(accum) = 22.6
 T(sweep opt: initial guess for dvdson    ) = 1.299e-04 S  per = 0.0221  per(accum) = 22.6
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.342e-01 S  per = 73.7  per(accum) = 96.3
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.758e-03 S  per = 0.638  per(accum) = 96.9
 T(sweep opt: dvdson [nccl]               ) = 7.475e-03 S  per = 1.27  per(accum) = 98.2
 T(sweep opt: dvdson [mpi]                ) = 6.752e-05 S  per = 0.0115  per(accum) = 98.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.050e-02 S  per = 1.78  per(accum) = 100
Detailed decomposition of T(renrm) = 4.279e-01 S  T(sum) = 4.279e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.109e-03 S  per = 0.259  per(accum) = 0.259
 T(sweep opt: qops init                    ) = 1.029e-02 S  per =  2.4  per(accum) = 2.66
 T(sweep opt: symbolic_formulae_renorm     ) = 9.217e-03 S  per = 2.15  per(accum) = 4.82
 T(sweep opt: allocate qops on gpu         ) = 1.478e-03 S  per = 0.345  per(accum) = 5.16
 T(sweep opt: site memcpy cpu2gpu          ) = 5.313e-04 S  per = 0.124  per(accum) = 5.29
 T(sweep opt: rintermediate init           ) = 1.086e-03 S  per = 0.254  per(accum) = 5.54
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.764e-02 S  per = 4.12  per(accum) = 9.66
 T(sweep opt: rmmtasks init                ) = 1.915e-02 S  per = 4.48  per(accum) = 14.1
 T(sweep opt: qops memset on cpu           ) = 1.037e-06 S  per = 0.000242  per(accum) = 14.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.383e-02 S  per = 7.91  per(accum) = 22
 T(sweep opt: deallocate cpu and gpu memory) = 2.997e-03 S  per =  0.7  per(accum) = 22.7
 T(sweep opt: construct opS [ifdists=true] ) = 3.049e-01 S  per = 71.3  per(accum) = 94
 T(sweep opt: reduction of opS & opH [nccl]) = 5.912e-04 S  per = 0.138  per(accum) = 94.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.654e-03 S  per = 0.62  per(accum) = 94.8
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.413e-04 S  per = 0.15  per(accum) = 94.9
 T(sweep opt: qops_pool join and erase     ) = 1.495e-02 S  per = 3.49  per(accum) = 98.4
 T(sweep opt: conversion from opAB to opPQ ) = 6.836e-03 S  per =  1.6  per(accum) = 100
##### global opt: 1.194e+00 S #####
 T(global opt: fetch) = 7.551e-02 S  per = 6.32  per(accum) = 6.32
 T(global opt: hdiag) = 1.765e-02 S  per = 1.48  per(accum) = 7.8
 T(global opt: dvdsn) = 6.004e-01 S  per = 50.3  per(accum) = 58.1
 T(global opt: decim) = 2.542e-02 S  per = 2.13  per(accum) = 60.2
 T(global opt: guess) = 1.189e-03 S  per = 0.0996  per(accum) = 60.3
 T(global opt: renrm) = 4.279e-01 S  per = 35.8  per(accum) = 96.1
 T(global opt: save ) = 4.627e-02 S  per = 3.87  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.004e-01 S  T(sum) = 5.890e-01 S  per = 9.810e+01
 T(global opt: preprocess                  ) = 1.553e-03 S  per = 0.264  per(accum) = 0.264
 T(global opt: symbolic_formulae           ) = 1.727e-02 S  per = 2.93  per(accum) = 3.2
 T(global opt: hintermediate init          ) = 1.325e-03 S  per = 0.225  per(accum) = 3.42
 T(global opt: preprocess_hformulae_Hxlist ) = 5.558e-02 S  per = 9.44  per(accum) = 12.9
 T(global opt: hmmtasks init               ) = 5.710e-02 S  per =  9.7  per(accum) = 22.6
 T(global opt: initial guess for dvdson    ) = 1.299e-04 S  per = 0.0221  per(accum) = 22.6
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.342e-01 S  per = 73.7  per(accum) = 96.3
 T(global opt: dvdson [cpu-gpu]            ) = 3.758e-03 S  per = 0.638  per(accum) = 96.9
 T(global opt: dvdson [nccl]               ) = 7.475e-03 S  per = 1.27  per(accum) = 98.2
 T(global opt: dvdson [mpi]                ) = 6.752e-05 S  per = 0.0115  per(accum) = 98.2
 T(global opt: dvdson [rest part(linalg)]  ) = 1.050e-02 S  per = 1.78  per(accum) = 100
Detailed decomposition of T(renrm) = 4.279e-01 S  T(sum) = 4.279e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.109e-03 S  per = 0.259  per(accum) = 0.259
 T(global opt: qops init                    ) = 1.029e-02 S  per =  2.4  per(accum) = 2.66
 T(global opt: symbolic_formulae_renorm     ) = 9.217e-03 S  per = 2.15  per(accum) = 4.82
 T(global opt: allocate qops on gpu         ) = 1.478e-03 S  per = 0.345  per(accum) = 5.16
 T(global opt: site memcpy cpu2gpu          ) = 5.313e-04 S  per = 0.124  per(accum) = 5.29
 T(global opt: rintermediate init           ) = 1.086e-03 S  per = 0.254  per(accum) = 5.54
 T(global opt: preprocess_formulae_Rlist2   ) = 1.764e-02 S  per = 4.12  per(accum) = 9.66
 T(global opt: rmmtasks init                ) = 1.915e-02 S  per = 4.48  per(accum) = 14.1
 T(global opt: qops memset on cpu           ) = 1.037e-06 S  per = 0.000242  per(accum) = 14.1
 T(global opt: preprocess_renorm_batchGPU   ) = 3.383e-02 S  per = 7.91  per(accum) = 22
 T(global opt: deallocate cpu and gpu memory) = 2.997e-03 S  per =  0.7  per(accum) = 22.7
 T(global opt: construct opS [ifdists=true] ) = 3.049e-01 S  per = 71.3  per(accum) = 94
 T(global opt: reduction of opS & opH [nccl]) = 5.912e-04 S  per = 0.138  per(accum) = 94.1
 T(global opt: qops memcpy gpu2cpu          ) = 2.654e-03 S  per = 0.62  per(accum) = 94.8
 T(global opt: reduction of opS & opH [mpi] ) = 6.413e-04 S  per = 0.15  per(accum) = 94.9
 T(global opt: qops_pool join and erase     ) = 1.495e-02 S  per = 3.49  per(accum) = 98.4
 T(global opt: conversion from opAB to opPQ ) = 6.836e-03 S  per =  1.6  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.642e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=23/seqsize=34 dots=1 dbond=(11,0)-(12,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=8 scratch=./scratch/sweep size=2137:1.59e-05GB T(load)=2.91e-04S speed=5.48e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=4078:3.11e-02MB:3.04e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1941:1.48e-02MB:1.45e-05GB
total mem of comb=6167:4.71e-02MB:4.59e-05GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=2.326e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=12,7,1
 suppl= 0 1 2 3 4 5 6 7 16 17 18 19
 suppr= 9 10 11 12 13 14 15
 suppc= 8
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(11,0)
 fqop[1]=./scratch/sweep/rop(13,0)
 fqop[2]=./scratch/sweep/cop(12,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:24 S:8 H:1 P:60 Q:68 
        dim(bra,ket)=77,77 size(op)=845:6.447e-03MB size(tot)=76551:5.840e-01MB:5.703e-04GB
        per(mem): C:13.8 S:4.28 H:1.1 P:24.1 Q:56.7 
 rqops: oplist=CSHAB nops=C:14 S:13 H:1 A:47 B:51 
        dim(bra,ket)=68,68 size(op)=652:0.00497MB size(tot)=45154:0.344MB:0.000336GB
        per(mem): C:11.3 S:9.33 H:1.44 A:23.4 B:54.5 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=124041:0.946MB:0.000924GB
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.701e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(12,0) fdel=./scratch/sweep/lop(11,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=5.722e-04 change=-5.718e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(77,68,4) nnz=1941:1.481e-02MB
qtensor3: wf3 own=1 _data=0x55b2ccd22000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=77
 (17,3):15 (17,1):15 (18,2):10 (19,1):10 (19,3):10 (18,4):7 (16,2):6 (15,1):3 (19,5):1
 qbond: qcol nsym=9 dimAll=68
 (11,-3):14 (11,-1):12 (9,-3):10 (10,-2):9 (12,-2):7 (9,-1):6 (10,-4):6 (13,-1):3 (9,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=23 nblocks=324 size=1941:1.481e-02MB
### DIAG TIMING: total=9.925e-04 t1=2.054e-05, t2=1.260e-05, t3=1.240e-05, t4=8.871e-04, t5=1.048e-05, t6=4.019e-05, t7=9.211e-06
duration_diagGPU:1.001e-03
duration_diagreduce:4.700e-08
duration_diagtransform:2.253e-06
----- TIMING FOR symbolic_formulae_onedot with size=525 : 1.093e-03 S -----
rank=0 GPUmem(GB): used=9.242e-04 (oper)=9.242e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=525
 no. of hintermediate operators=256
 no. of coefficients=3072:2.344e-02MB:2.289e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.142e-05 S -----
rank=0 GPUmem(GB): used=9.471e-04 (oper,hinter)=9.242e-04,2.289e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.935e-03 S size(H_formulae)=525 size(Hxlst2)=23 T(Hmu/Hxlist)=2.197e-04,1.715e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.666e-03 S size(H_formulae)=525 size(Hxlst)=7364 -----
rank=0 GPUmem(GB): used=9.471e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=2.892e-05 batch[need]=3.133e-02 blksize=210 blksize0=150 batchsize=7364
rank=0 GPUmem(GB): used=3.230e-02 (oper,hinter,dvdson,batch)=9.242e-04,2.289e-05,2.892e-05,3.133e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=1941 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=2.244e-04,1.398e-04,1.681e-03,2.762e-04,2.334e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=3.665e-05 speed=7.892e-01GB/S T(nccl)=1.878e-04 speed=1.540e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=1.7e-03 t_reduction=2.8e-04 tot=2.1e-03 -----
 sigma[inter] counter=158 t=1.4e-04 per=6.7e+00 cost=6.8e+06 flops=4.9e+10
 sigma[gemm] counter=158 i=0 t=1.9e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=1 t=1.6e-06 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=158 i=2 t=4.7e-04 per=2.2e+01 cost=6.5e+06 flops=1.4e+10
 sigma[gemm] counter=158 i=3 t=5.1e-04 per=2.4e+01 cost=6.4e+06 flops=1.2e+10
 sigma[gemm] counter=158 i=4 t=3.6e-04 per=1.7e+01 cost=5.7e+06 flops=1.6e+10
 sigma[gemm] counter=158 i=5 t=3.4e-04 per=1.6e+01 cost=5.7e+06 flops=1.7e+10
 sigma[gemm] counter=158 total t=1.7e-03 per=8.0e+01 cost=2.4e+07 flops=1.4e+10
 sigma[red] counter=158 t=2.8e-04 per=1.3e+01 cost=1.4e+06 flops=4.9e+09
----- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=3.4e-01 t_reduction=4.8e-02 tot=4.1e-01 -----
 sigma_tot[inter] counter=158 t=2.0e-02 per=4.8e+00 cost=5.9e+08 flops=3.0e+10
 sigma_tot[gemm] counter=158 i=0 t=3.4e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=1 t=3.2e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=158 i=2 t=8.2e-02 per=2.0e+01 cost=5.1e+08 flops=6.2e+09
 sigma_tot[gemm] counter=158 i=3 t=1.0e-01 per=2.5e+01 cost=5.0e+08 flops=4.9e+09
 sigma_tot[gemm] counter=158 i=4 t=7.7e-02 per=1.9e+01 cost=4.3e+08 flops=5.5e+09
 sigma_tot[gemm] counter=158 i=5 t=7.8e-02 per=1.9e+01 cost=4.3e+08 flops=5.6e+09
 sigma_tot[gemm] counter=158 total t=3.4e-01 per=8.3e+01 cost=1.9e+09 flops=5.5e+09
 sigma_tot[red] counter=158 t=4.8e-02 per=1.2e+01 cost=1.2e+08 flops=2.5e+09
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=6.1e-06,3.2e-06,1.3e-06,1.2e-05,6.9e-07
settings: ndim=1941 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.542148034411 -1.117e+03  1.381e-02    1     1  2.704e-03 2.704e-03 2.604e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.327e-05,1.323e-04,2.168e-03,3.109e-04,2.702e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=3.713e-05 speed=7.791e-01GB/S T(nccl)=4.615e-05 speed=6.267e-01GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=2.2e-03 t_reduction=3.1e-04 tot=2.6e-03 -----
 sigma[inter] counter=159 t=1.3e-04 per=5.1e+00 cost=6.8e+06 flops=5.1e+10
 sigma[gemm] counter=159 i=0 t=2.1e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=1 t=2.0e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=159 i=2 t=6.2e-04 per=2.4e+01 cost=6.5e+06 flops=1.1e+10
 sigma[gemm] counter=159 i=3 t=6.9e-04 per=2.7e+01 cost=6.4e+06 flops=9.2e+09
 sigma[gemm] counter=159 i=4 t=4.4e-04 per=1.7e+01 cost=5.7e+06 flops=1.3e+10
 sigma[gemm] counter=159 i=5 t=4.1e-04 per=1.6e+01 cost=5.7e+06 flops=1.4e+10
 sigma[gemm] counter=159 total t=2.2e-03 per=8.3e+01 cost=2.4e+07 flops=1.1e+10
 sigma[red] counter=159 t=3.1e-04 per=1.2e+01 cost=1.4e+06 flops=4.4e+09
----- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=3.4e-01 t_reduction=4.9e-02 tot=4.1e-01 -----
 sigma_tot[inter] counter=159 t=2.0e-02 per=4.8e+00 cost=5.9e+08 flops=3.0e+10
 sigma_tot[gemm] counter=159 i=0 t=3.4e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=1 t=3.2e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=159 i=2 t=8.3e-02 per=2.0e+01 cost=5.1e+08 flops=6.2e+09
 sigma_tot[gemm] counter=159 i=3 t=1.0e-01 per=2.5e+01 cost=5.1e+08 flops=4.9e+09
 sigma_tot[gemm] counter=159 i=4 t=7.8e-02 per=1.9e+01 cost=4.3e+08 flops=5.5e+09
 sigma_tot[gemm] counter=159 i=5 t=7.8e-02 per=1.9e+01 cost=4.4e+08 flops=5.6e+09
 sigma_tot[gemm] counter=159 total t=3.4e-01 per=8.3e+01 cost=1.9e+09 flops=5.5e+09
 sigma_tot[red] counter=159 t=4.9e-02 per=1.2e+01 cost=1.2e+08 flops=2.6e+09
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.3e-05,3.2e-06,1.3e-05,7.6e-07
    2   0 -    -116.542371742070 -2.237e-04  4.109e-03    2     2  5.818e-03 2.909e-03 2.798e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.742e-05,1.284e-04,2.130e-03,3.116e-04,2.664e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=4.164e-05 speed=6.946e-01GB/S T(nccl)=4.578e-05 speed=6.318e-01GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=2.1e-03 t_reduction=3.1e-04 tot=2.6e-03 -----
 sigma[inter] counter=160 t=1.3e-04 per=5.0e+00 cost=6.8e+06 flops=5.3e+10
 sigma[gemm] counter=160 i=0 t=1.9e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=1 t=1.9e-06 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=160 i=2 t=5.6e-04 per=2.2e+01 cost=6.5e+06 flops=1.2e+10
 sigma[gemm] counter=160 i=3 t=6.8e-04 per=2.6e+01 cost=6.4e+06 flops=9.4e+09
 sigma[gemm] counter=160 i=4 t=4.5e-04 per=1.8e+01 cost=5.7e+06 flops=1.3e+10
 sigma[gemm] counter=160 i=5 t=4.4e-04 per=1.7e+01 cost=5.7e+06 flops=1.3e+10
 sigma[gemm] counter=160 total t=2.1e-03 per=8.3e+01 cost=2.4e+07 flops=1.1e+10
 sigma[red] counter=160 t=3.1e-04 per=1.2e+01 cost=1.4e+06 flops=4.4e+09
----- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=3.4e-01 t_reduction=4.9e-02 tot=4.1e-01 -----
 sigma_tot[inter] counter=160 t=2.0e-02 per=4.8e+00 cost=6.0e+08 flops=3.0e+10
 sigma_tot[gemm] counter=160 i=0 t=3.4e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=1 t=3.2e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=160 i=2 t=8.3e-02 per=2.0e+01 cost=5.2e+08 flops=6.2e+09
 sigma_tot[gemm] counter=160 i=3 t=1.0e-01 per=2.5e+01 cost=5.1e+08 flops=4.9e+09
 sigma_tot[gemm] counter=160 i=4 t=7.8e-02 per=1.9e+01 cost=4.4e+08 flops=5.6e+09
 sigma_tot[gemm] counter=160 i=5 t=7.9e-02 per=1.9e+01 cost=4.5e+08 flops=5.7e+09
 sigma_tot[gemm] counter=160 total t=3.4e-01 per=8.3e+01 cost=1.9e+09 flops=5.6e+09
 sigma_tot[red] counter=160 t=4.9e-02 per=1.2e+01 cost=1.3e+08 flops=2.6e+09
T(sub)=5.3e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,1.5e-05,2.2e-06,1.6e-05,7.8e-07
    3   0 -    -116.542400006522 -2.826e-05  2.082e-03    3     3  8.794e-03 2.931e-03 2.822e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.215e-05,1.236e-04,2.160e-03,3.134e-04,2.675e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=2.626e-05 speed=1.102e+00GB/S T(nccl)=4.590e-05 speed=6.302e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.2e-03 t_reduction=3.1e-04 tot=2.6e-03 -----
 sigma[inter] counter=161 t=1.2e-04 per=4.8e+00 cost=6.8e+06 flops=5.5e+10
 sigma[gemm] counter=161 i=0 t=2.1e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=1 t=2.1e-06 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=161 i=2 t=6.1e-04 per=2.4e+01 cost=6.5e+06 flops=1.1e+10
 sigma[gemm] counter=161 i=3 t=6.9e-04 per=2.7e+01 cost=6.4e+06 flops=9.2e+09
 sigma[gemm] counter=161 i=4 t=4.5e-04 per=1.7e+01 cost=5.7e+06 flops=1.3e+10
 sigma[gemm] counter=161 i=5 t=4.0e-04 per=1.5e+01 cost=5.7e+06 flops=1.4e+10
 sigma[gemm] counter=161 total t=2.2e-03 per=8.3e+01 cost=2.4e+07 flops=1.1e+10
 sigma[red] counter=161 t=3.1e-04 per=1.2e+01 cost=1.4e+06 flops=4.4e+09
----- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=3.5e-01 t_reduction=4.9e-02 tot=4.2e-01 -----
 sigma_tot[inter] counter=161 t=2.0e-02 per=4.8e+00 cost=6.1e+08 flops=3.0e+10
 sigma_tot[gemm] counter=161 i=0 t=3.4e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=1 t=3.2e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=161 i=2 t=8.4e-02 per=2.0e+01 cost=5.3e+08 flops=6.3e+09
 sigma_tot[gemm] counter=161 i=3 t=1.0e-01 per=2.5e+01 cost=5.2e+08 flops=5.0e+09
 sigma_tot[gemm] counter=161 i=4 t=7.9e-02 per=1.9e+01 cost=4.4e+08 flops=5.6e+09
 sigma_tot[gemm] counter=161 i=5 t=7.9e-02 per=1.9e+01 cost=4.5e+08 flops=5.7e+09
 sigma_tot[gemm] counter=161 total t=3.5e-01 per=8.3e+01 cost=1.9e+09 flops=5.6e+09
 sigma_tot[red] counter=161 t=4.9e-02 per=1.2e+01 cost=1.3e+08 flops=2.6e+09
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.3e-05,2.2e-06,9.0e-06,6.5e-07
    4   0 -    -116.542407937503 -7.931e-06  1.079e-03    3     4  1.181e-02 2.952e-03 2.848e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.090e-05,1.250e-04,2.156e-03,3.123e-04,2.671e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=2.546e-05 speed=1.136e+00GB/S T(nccl)=4.543e-05 speed=6.366e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.2e-03 t_reduction=3.1e-04 tot=2.6e-03 -----
 sigma[inter] counter=162 t=1.2e-04 per=4.8e+00 cost=6.8e+06 flops=5.4e+10
 sigma[gemm] counter=162 i=0 t=2.1e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=1 t=2.1e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=162 i=2 t=6.1e-04 per=2.4e+01 cost=6.5e+06 flops=1.1e+10
 sigma[gemm] counter=162 i=3 t=7.0e-04 per=2.7e+01 cost=6.4e+06 flops=9.2e+09
 sigma[gemm] counter=162 i=4 t=4.4e-04 per=1.7e+01 cost=5.7e+06 flops=1.3e+10
 sigma[gemm] counter=162 i=5 t=4.0e-04 per=1.6e+01 cost=5.7e+06 flops=1.4e+10
 sigma[gemm] counter=162 total t=2.2e-03 per=8.3e+01 cost=2.4e+07 flops=1.1e+10
 sigma[red] counter=162 t=3.1e-04 per=1.2e+01 cost=1.4e+06 flops=4.4e+09
----- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=3.5e-01 t_reduction=4.9e-02 tot=4.2e-01 -----
 sigma_tot[inter] counter=162 t=2.0e-02 per=4.8e+00 cost=6.1e+08 flops=3.0e+10
 sigma_tot[gemm] counter=162 i=0 t=3.5e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=1 t=3.2e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=162 i=2 t=8.4e-02 per=2.0e+01 cost=5.3e+08 flops=6.3e+09
 sigma_tot[gemm] counter=162 i=3 t=1.1e-01 per=2.5e+01 cost=5.3e+08 flops=5.0e+09
 sigma_tot[gemm] counter=162 i=4 t=7.9e-02 per=1.9e+01 cost=4.5e+08 flops=5.7e+09
 sigma_tot[gemm] counter=162 i=5 t=8.0e-02 per=1.9e+01 cost=4.6e+08 flops=5.7e+09
 sigma_tot[gemm] counter=162 total t=3.5e-01 per=8.3e+01 cost=2.0e+09 flops=5.6e+09
 sigma_tot[red] counter=162 t=4.9e-02 per=1.2e+01 cost=1.3e+08 flops=2.6e+09
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.2e-05,2.0e-06,8.9e-06,6.5e-07
    5   0 -    -116.542409908908 -1.971e-06  4.414e-04    3     5  1.478e-02 2.957e-03 2.856e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.841e-05,1.182e-04,2.081e-03,3.046e-04,2.579e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=2.415e-05 speed=1.198e+00GB/S T(nccl)=4.426e-05 speed=6.535e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=2.1e-03 t_reduction=3.0e-04 tot=2.5e-03 -----
 sigma[inter] counter=163 t=1.2e-04 per=4.7e+00 cost=6.8e+06 flops=5.7e+10
 sigma[gemm] counter=163 i=0 t=1.9e-06 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=1 t=1.9e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=163 i=2 t=5.6e-04 per=2.2e+01 cost=6.5e+06 flops=1.2e+10
 sigma[gemm] counter=163 i=3 t=6.7e-04 per=2.7e+01 cost=6.4e+06 flops=9.5e+09
 sigma[gemm] counter=163 i=4 t=4.4e-04 per=1.7e+01 cost=5.7e+06 flops=1.3e+10
 sigma[gemm] counter=163 i=5 t=4.1e-04 per=1.6e+01 cost=5.7e+06 flops=1.4e+10
 sigma[gemm] counter=163 total t=2.1e-03 per=8.3e+01 cost=2.4e+07 flops=1.2e+10
 sigma[red] counter=163 t=3.0e-04 per=1.2e+01 cost=1.4e+06 flops=4.5e+09
----- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=3.5e-01 t_reduction=5.0e-02 tot=4.2e-01 -----
 sigma_tot[inter] counter=163 t=2.0e-02 per=4.8e+00 cost=6.2e+08 flops=3.0e+10
 sigma_tot[gemm] counter=163 i=0 t=3.5e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=1 t=3.2e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=163 i=2 t=8.5e-02 per=2.0e+01 cost=5.4e+08 flops=6.3e+09
 sigma_tot[gemm] counter=163 i=3 t=1.1e-01 per=2.5e+01 cost=5.3e+08 flops=5.0e+09
 sigma_tot[gemm] counter=163 i=4 t=8.0e-02 per=1.9e+01 cost=4.5e+08 flops=5.7e+09
 sigma_tot[gemm] counter=163 i=5 t=8.0e-02 per=1.9e+01 cost=4.6e+08 flops=5.8e+09
 sigma_tot[gemm] counter=163 total t=3.5e-01 per=8.3e+01 cost=2.0e+09 flops=5.7e+09
 sigma_tot[red] counter=163 t=5.0e-02 per=1.2e+01 cost=1.3e+08 flops=2.6e+09
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.2e-05,2.0e-06,8.8e-06,6.6e-07
    6   0 -    -116.542410194992 -2.861e-07  1.597e-04    3     6  1.767e-02 2.946e-03 2.848e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.568e-05,1.258e-04,2.146e-03,3.121e-04,2.666e-03
 analyze_tgpu[Hx]: ndim=1941:1.446e-05GB T(cpu-gpu)=2.517e-05 speed=1.149e+00GB/S T(nccl)=5.052e-05 speed=5.725e-01GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=2.1e-03 t_reduction=3.1e-04 tot=2.6e-03 -----
 sigma[inter] counter=164 t=1.3e-04 per=4.9e+00 cost=6.8e+06 flops=5.4e+10
 sigma[gemm] counter=164 i=0 t=2.1e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=1 t=2.0e-06 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=164 i=2 t=6.1e-04 per=2.4e+01 cost=6.5e+06 flops=1.1e+10
 sigma[gemm] counter=164 i=3 t=6.9e-04 per=2.7e+01 cost=6.4e+06 flops=9.3e+09
 sigma[gemm] counter=164 i=4 t=4.4e-04 per=1.7e+01 cost=5.7e+06 flops=1.3e+10
 sigma[gemm] counter=164 i=5 t=4.1e-04 per=1.6e+01 cost=5.7e+06 flops=1.4e+10
 sigma[gemm] counter=164 total t=2.1e-03 per=8.3e+01 cost=2.4e+07 flops=1.1e+10
 sigma[red] counter=164 t=3.1e-04 per=1.2e+01 cost=1.4e+06 flops=4.4e+09
----- TIMING FOR sigma_tot : t_inter=2.0e-02 t_gemm=3.5e-01 t_reduction=5.0e-02 tot=4.2e-01 -----
 sigma_tot[inter] counter=164 t=2.0e-02 per=4.8e+00 cost=6.3e+08 flops=3.1e+10
 sigma_tot[gemm] counter=164 i=0 t=3.5e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=1 t=3.3e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=164 i=2 t=8.6e-02 per=2.0e+01 cost=5.5e+08 flops=6.4e+09
 sigma_tot[gemm] counter=164 i=3 t=1.1e-01 per=2.5e+01 cost=5.4e+08 flops=5.1e+09
 sigma_tot[gemm] counter=164 i=4 t=8.0e-02 per=1.9e+01 cost=4.6e+08 flops=5.7e+09
 sigma_tot[gemm] counter=164 i=5 t=8.0e-02 per=1.9e+01 cost=4.7e+08 flops=5.8e+09
 sigma_tot[gemm] counter=164 total t=3.5e-01 per=8.3e+01 cost=2.0e+09 flops=5.7e+09
 sigma_tot[red] counter=164 t=5.0e-02 per=1.2e+01 cost=1.3e+08 flops=2.6e+09
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.2e-05,2.1e-06,8.7e-06,6.5e-07
    7   0 +    -116.542410234795 -3.980e-08  6.298e-05    3     7  2.061e-02 2.944e-03 2.848e-03
TIMING FOR Davidson : 2.073e-02  T(cal/comm/rest)=1.994e-02,3.341e-06,7.902e-04
decomposed t_rest=7.902e-04
 T(sub)    =2.940e-04 per=3.721e+01
 T(precond)=3.024e-05 per=3.827e+00
 T(ortho)  =3.860e-05 per=4.885e+00
 T(xcopy)  =2.269e-05 per=2.871e+00
 T(xnrm2)  =6.647e-06 per=8.412e-01
 T(other)  =3.980e-04 per=5.037e+01
optimized energies: isweep=0 ibond=23 dots=1 e[0]=-116.542410234795 nmvp=7
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=2.838e-03 change=2.046e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond23.txt
 qbond: qsuper nsym=18 dimAll=272
 (11,-3):39 (11,-1):27 (9,-3):10 (10,-2):25 (12,-2):42 (9,-1):6 (10,-4):17 (13,-1):22 (9,-5):1 (13,-3):21 (14,-2):10 (12,-4):20 (15,-1):3 (11,-5):7 (12,0):12 (10,0):6 (14,0):3 (10,-6):1
timing for divide=3.0e-06
timing for compute=3.1e-04
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(nkr): 3.3e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.0e-06,3.0e-04,0.0e+00,4.4e-06,1.6e-05 -----
decimation summary: 272->77 dwt=+1.110e-16 SvN=2.207e+00
 qbond: qkept nsym=9 dimAll=77
 (13,-1):15 (13,-3):15 (11,-3):10 (11,-1):10 (12,-2):10 (12,-4):7 (14,-2):6 (15,-1):3 (11,-5):1
----- TIMING for decimation_row(nkr): 1.539e-03 S T(decim/select/formRot)=3.938e-04,1.123e-03,2.312e-05 -----
----- TIMING FOR onedot_decimation: 1.599e-03 S T(wf/decim)=4.270e-05,1.557e-03 -----
ctns::oper_renorm coord=(12,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:16 S:12 H:1 A:60 B:68 
        dim(bra,ket)=77,77 size(op)=845:6.447e-03MB size(tot)=74671:5.697e-01MB:5.563e-04GB
        per(mem): C:9.43 S:6.59 H:1.13 A:24.8 B:58.1 
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=2.853e-03 change=2.517e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=145 : 1.767e-04 S -----
rank=0 GPUmem(GB): used=9.331e-04 (oper)=9.102e-04
rank=0 GPUmem(GB): used=9.475e-04 (oper,site)=9.102e-04,1.446e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=145
 no. of rintermediate operators=7
 no. of coefficients=157:1.198e-03MB:1.170e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.843e-05 S -----
rank=0 GPUmem(GB): used=9.487e-04 (oper,site,rinter)=9.102e-04,1.446e-05,1.170e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 5.791e-04 S size(rtasks)=145 size(Rlst2)=81 T(Rmu/Rlist)=8.755e-05,4.916e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 6.513e-04 S size(rtasks)=145 size(Rlst)=1735 -----
rank=0 GPUmem(GB): used=9.487e-04 avail=3.829e+01 total=3.829e+01 batch[need]=8.364e-03 blksize=225 blksize0=196 batchsize=1735
rank=0 GPUmem(GB): used=9.312e-03 (oper,site,rinter,batch)=9.102e-04,1.446e-05,1.170e-06,8.364e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=2.297e-04,1.086e-03,2.322e-04
----- TIMING FOR renorm : t_inter=2.3e-04 t_gemm=1.1e-03 t_reduction=2.3e-04 tot=1.5e-03 -----
 renorm[inter] counter=548 t=2.3e-04 per=1.5e+01 cost=5.2e+05 flops=2.3e+09
 renorm[gemm] counter=548 i=0 t=1.8e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=548 i=1 t=1.6e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=548 i=2 t=2.7e-04 per=1.8e+01 cost=4.1e+05 flops=1.5e+09
 renorm[gemm] counter=548 i=3 t=4.6e-04 per=3.0e+01 cost=2.4e+06 flops=5.2e+09
 renorm[gemm] counter=548 i=4 t=2.5e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=548 i=5 t=2.1e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=548 i=6 t=3.5e-04 per=2.2e+01 cost=3.3e+06 flops=9.5e+09
 renorm[gemm] counter=548 total t=1.1e-03 per=7.0e+01 cost=6.1e+06 flops=5.6e+09
 renorm[red] counter=548 t=2.3e-04 per=1.5e+01 cost=3.6e+05 flops=1.5e+09
----- TIMING FOR renorm_tot : t_inter=3.0e-03 t_gemm=2.3e-02 t_reduction=5.9e-03 tot=3.2e-02 -----
 renorm_tot[inter] counter=548 t=3.0e-03 per=9.4e+00 cost=1.7e+07 flops=5.8e+09
 renorm_tot[gemm] counter=548 i=0 t=5.1e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=548 i=1 t=4.5e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=548 i=2 t=1.5e-03 per=4.7e+00 cost=8.5e+05 flops=5.6e+08
 renorm_tot[gemm] counter=548 i=3 t=2.4e-03 per=7.4e+00 cost=4.2e+06 flops=1.8e+09
 renorm_tot[gemm] counter=548 i=4 t=4.6e-03 per=1.4e+01 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=548 i=5 t=6.4e-03 per=2.0e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=548 i=6 t=8.4e-03 per=2.6e+01 cost=5.1e+07 flops=6.1e+09
 renorm_tot[gemm] counter=548 total t=2.3e-02 per=7.2e+01 cost=9.0e+07 flops=3.9e+09
 renorm_tot[red] counter=548 t=5.9e-03 per=1.8e+01 cost=6.1e+06 flops=1.0e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=9.606e-04 (oper)=9.137e-04
rank=0 GPUmem(GB): used=9.751e-04 (oper,site,rinter)=9.137e-04,1.446e-05,2.289e-05
rank=0 GPUmem(GB): used=1.265e-03 (oper,site,rinter,batch)=9.137e-04,1.446e-05,2.289e-05,2.896e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.838e-02 S T(preprocess/alloc/comp/red/dealloc)=1.938e-03,2.073e-03,1.359e-02,2.506e-03,1.740e-04 -----
----- TIMING FOR oper_renorm_opS : 1.843e-02 S rank=0 -----
qops.to_cpu: size(tot)=74671:5.697e-01MB:5.563e-04GB T(to_cpu)=3.986e-04S speed=1.396e+00GB/S
check ||H-H.dagger||=7.084e-14 coord=(12,0) rank=0
----- TIMING FOR oper_renorm : 0.0248 S rank=0 -----
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=2.274e-03 change=1.016e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=2.998e-03 change=-2.128e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=2.998e-03 change=-1.766e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 6.177e-02 S #####
 T(local opt: fetch) = 3.240e-03 S  per = 5.24  per(accum) = 5.24
 T(local opt: hdiag) = 1.030e-03 S  per = 1.67  per(accum) = 6.91
 T(local opt: dvdsn) = 2.800e-02 S  per = 45.3  per(accum) = 52.2
 T(local opt: decim) = 1.634e-03 S  per = 2.65  per(accum) = 54.9
 T(local opt: guess) = 6.059e-05 S  per = 0.0981  per(accum) = 55
 T(local opt: renrm) = 2.543e-02 S  per = 41.2  per(accum) = 96.2
 T(local opt: save ) = 2.378e-03 S  per = 3.85  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.800e-02 S  T(sum) = 2.742e-02 S  per = 9.792e+01
 T(local opt: preprocess                  ) = 5.863e-05 S  per = 0.214  per(accum) = 0.214
 T(local opt: symbolic_formulae           ) = 1.101e-03 S  per = 4.01  per(accum) = 4.23
 T(local opt: hintermediate init          ) = 6.072e-05 S  per = 0.221  per(accum) = 4.45
 T(local opt: preprocess_hformulae_Hxlist ) = 2.697e-03 S  per = 9.83  per(accum) = 14.3
 T(local opt: hmmtasks init               ) = 2.766e-03 S  per = 10.1  per(accum) = 24.4
 T(local opt: initial guess for dvdson    ) = 6.364e-06 S  per = 0.0232  per(accum) = 24.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.926e-02 S  per = 70.2  per(accum) = 94.6
 T(local opt: dvdson [cpu-gpu]            ) = 2.164e-04 S  per = 0.789  per(accum) = 95.4
 T(local opt: dvdson [nccl]               ) = 4.658e-04 S  per =  1.7  per(accum) = 97.1
 T(local opt: dvdson [mpi]                ) = 3.341e-06 S  per = 0.0122  per(accum) = 97.1
 T(local opt: dvdson [rest part(linalg)]  ) = 7.902e-04 S  per = 2.88  per(accum) = 100
Detailed decomposition of T(renrm) = 2.543e-02 S  T(sum) = 2.543e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.434e-05 S  per = 0.214  per(accum) = 0.214
 T(local opt: qops init                    ) = 5.778e-04 S  per = 2.27  per(accum) = 2.49
 T(local opt: symbolic_formulae_renorm     ) = 1.894e-04 S  per = 0.745  per(accum) = 3.23
 T(local opt: allocate qops on gpu         ) = 6.775e-05 S  per = 0.266  per(accum) = 3.5
 T(local opt: site memcpy cpu2gpu          ) = 2.985e-05 S  per = 0.117  per(accum) = 3.62
 T(local opt: rintermediate init           ) = 5.469e-05 S  per = 0.215  per(accum) = 3.83
 T(local opt: preprocess_formulae_Rlist2   ) = 6.672e-04 S  per = 2.62  per(accum) = 6.45
 T(local opt: rmmtasks init                ) = 2.296e-03 S  per = 9.03  per(accum) = 15.5
 T(local opt: qops memset on cpu           ) = 4.400e-08 S  per = 0.000173  per(accum) = 15.5
 T(local opt: preprocess_renorm_batchGPU   ) = 1.759e-03 S  per = 6.92  per(accum) = 22.4
 T(local opt: deallocate cpu and gpu memory) = 1.995e-04 S  per = 0.784  per(accum) = 23.2
 T(local opt: construct opS [ifdists=true] ) = 1.848e-02 S  per = 72.7  per(accum) = 95.9
 T(local opt: reduction of opS & opH [nccl]) = 2.068e-05 S  per = 0.0813  per(accum) = 96
 T(local opt: qops memcpy gpu2cpu          ) = 4.122e-04 S  per = 1.62  per(accum) = 97.6
 T(local opt: reduction of opS & opH [mpi] ) = 5.550e-05 S  per = 0.218  per(accum) = 97.8
 T(local opt: qops_pool join and erase     ) = 5.603e-04 S  per =  2.2  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.540e-07 S  per = 0.00336  per(accum) = 100
ctns::rcanon_save_site idx=7 scratch=./scratch/sweep size=1941:1.4e-05GB T(load)=0.00058S speed=0.025GB/S
##### sweep opt: 1.256e+00 S #####
 T(sweep opt: fetch) = 7.875e-02 S  per = 6.27  per(accum) = 6.27
 T(sweep opt: hdiag) = 1.868e-02 S  per = 1.49  per(accum) = 7.76
 T(sweep opt: dvdsn) = 6.284e-01 S  per =   50  per(accum) = 57.8
 T(sweep opt: decim) = 2.706e-02 S  per = 2.15  per(accum) = 59.9
 T(sweep opt: guess) = 1.250e-03 S  per = 0.0995  per(accum) = 60
 T(sweep opt: renrm) = 4.533e-01 S  per = 36.1  per(accum) = 96.1
 T(sweep opt: save ) = 4.865e-02 S  per = 3.87  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.284e-01 S  T(sum) = 6.164e-01 S  per = 9.809e+01
 T(sweep opt: preprocess                  ) = 1.612e-03 S  per = 0.262  per(accum) = 0.262
 T(sweep opt: symbolic_formulae           ) = 1.837e-02 S  per = 2.98  per(accum) = 3.24
 T(sweep opt: hintermediate init          ) = 1.386e-03 S  per = 0.225  per(accum) = 3.47
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.828e-02 S  per = 9.45  per(accum) = 12.9
 T(sweep opt: hmmtasks init               ) = 5.987e-02 S  per = 9.71  per(accum) = 22.6
 T(sweep opt: initial guess for dvdson    ) = 1.363e-04 S  per = 0.0221  per(accum) = 22.7
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.535e-01 S  per = 73.6  per(accum) = 96.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 3.974e-03 S  per = 0.645  per(accum) = 96.9
 T(sweep opt: dvdson [nccl]               ) = 7.941e-03 S  per = 1.29  per(accum) = 98.2
 T(sweep opt: dvdson [mpi]                ) = 7.086e-05 S  per = 0.0115  per(accum) = 98.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.129e-02 S  per = 1.83  per(accum) = 100
Detailed decomposition of T(renrm) = 4.533e-01 S  T(sum) = 4.533e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.163e-03 S  per = 0.257  per(accum) = 0.257
 T(sweep opt: qops init                    ) = 1.086e-02 S  per =  2.4  per(accum) = 2.65
 T(sweep opt: symbolic_formulae_renorm     ) = 9.407e-03 S  per = 2.07  per(accum) = 4.73
 T(sweep opt: allocate qops on gpu         ) = 1.546e-03 S  per = 0.341  per(accum) = 5.07
 T(sweep opt: site memcpy cpu2gpu          ) = 5.611e-04 S  per = 0.124  per(accum) = 5.19
 T(sweep opt: rintermediate init           ) = 1.141e-03 S  per = 0.252  per(accum) = 5.44
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.830e-02 S  per = 4.04  per(accum) = 9.48
 T(sweep opt: rmmtasks init                ) = 2.145e-02 S  per = 4.73  per(accum) = 14.2
 T(sweep opt: qops memset on cpu           ) = 1.081e-06 S  per = 0.000238  per(accum) = 14.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.559e-02 S  per = 7.85  per(accum) = 22.1
 T(sweep opt: deallocate cpu and gpu memory) = 3.197e-03 S  per = 0.705  per(accum) = 22.8
 T(sweep opt: construct opS [ifdists=true] ) = 3.234e-01 S  per = 71.3  per(accum) = 94.1
 T(sweep opt: reduction of opS & opH [nccl]) = 6.119e-04 S  per = 0.135  per(accum) = 94.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.066e-03 S  per = 0.676  per(accum) = 94.9
 T(sweep opt: reduction of opS & opH [mpi] ) = 6.968e-04 S  per = 0.154  per(accum) = 95.1
 T(sweep opt: qops_pool join and erase     ) = 1.551e-02 S  per = 3.42  per(accum) = 98.5
 T(sweep opt: conversion from opAB to opPQ ) = 6.836e-03 S  per = 1.51  per(accum) = 100
##### global opt: 1.256e+00 S #####
 T(global opt: fetch) = 7.875e-02 S  per = 6.27  per(accum) = 6.27
 T(global opt: hdiag) = 1.868e-02 S  per = 1.49  per(accum) = 7.76
 T(global opt: dvdsn) = 6.284e-01 S  per =   50  per(accum) = 57.8
 T(global opt: decim) = 2.706e-02 S  per = 2.15  per(accum) = 59.9
 T(global opt: guess) = 1.250e-03 S  per = 0.0995  per(accum) = 60
 T(global opt: renrm) = 4.533e-01 S  per = 36.1  per(accum) = 96.1
 T(global opt: save ) = 4.865e-02 S  per = 3.87  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.284e-01 S  T(sum) = 6.164e-01 S  per = 9.809e+01
 T(global opt: preprocess                  ) = 1.612e-03 S  per = 0.262  per(accum) = 0.262
 T(global opt: symbolic_formulae           ) = 1.837e-02 S  per = 2.98  per(accum) = 3.24
 T(global opt: hintermediate init          ) = 1.386e-03 S  per = 0.225  per(accum) = 3.47
 T(global opt: preprocess_hformulae_Hxlist ) = 5.828e-02 S  per = 9.45  per(accum) = 12.9
 T(global opt: hmmtasks init               ) = 5.987e-02 S  per = 9.71  per(accum) = 22.6
 T(global opt: initial guess for dvdson    ) = 1.363e-04 S  per = 0.0221  per(accum) = 22.7
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.535e-01 S  per = 73.6  per(accum) = 96.2
 T(global opt: dvdson [cpu-gpu]            ) = 3.974e-03 S  per = 0.645  per(accum) = 96.9
 T(global opt: dvdson [nccl]               ) = 7.941e-03 S  per = 1.29  per(accum) = 98.2
 T(global opt: dvdson [mpi]                ) = 7.086e-05 S  per = 0.0115  per(accum) = 98.2
 T(global opt: dvdson [rest part(linalg)]  ) = 1.129e-02 S  per = 1.83  per(accum) = 100
Detailed decomposition of T(renrm) = 4.533e-01 S  T(sum) = 4.533e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.163e-03 S  per = 0.257  per(accum) = 0.257
 T(global opt: qops init                    ) = 1.086e-02 S  per =  2.4  per(accum) = 2.65
 T(global opt: symbolic_formulae_renorm     ) = 9.407e-03 S  per = 2.07  per(accum) = 4.73
 T(global opt: allocate qops on gpu         ) = 1.546e-03 S  per = 0.341  per(accum) = 5.07
 T(global opt: site memcpy cpu2gpu          ) = 5.611e-04 S  per = 0.124  per(accum) = 5.19
 T(global opt: rintermediate init           ) = 1.141e-03 S  per = 0.252  per(accum) = 5.44
 T(global opt: preprocess_formulae_Rlist2   ) = 1.830e-02 S  per = 4.04  per(accum) = 9.48
 T(global opt: rmmtasks init                ) = 2.145e-02 S  per = 4.73  per(accum) = 14.2
 T(global opt: qops memset on cpu           ) = 1.081e-06 S  per = 0.000238  per(accum) = 14.2
 T(global opt: preprocess_renorm_batchGPU   ) = 3.559e-02 S  per = 7.85  per(accum) = 22.1
 T(global opt: deallocate cpu and gpu memory) = 3.197e-03 S  per = 0.705  per(accum) = 22.8
 T(global opt: construct opS [ifdists=true] ) = 3.234e-01 S  per = 71.3  per(accum) = 94.1
 T(global opt: reduction of opS & opH [nccl]) = 6.119e-04 S  per = 0.135  per(accum) = 94.2
 T(global opt: qops memcpy gpu2cpu          ) = 3.066e-03 S  per = 0.676  per(accum) = 94.9
 T(global opt: reduction of opS & opH [mpi] ) = 6.968e-04 S  per = 0.154  per(accum) = 95.1
 T(global opt: qops_pool join and erase     ) = 1.551e-02 S  per = 3.42  per(accum) = 98.5
 T(global opt: conversion from opAB to opPQ ) = 6.836e-03 S  per = 1.51  per(accum) = 100
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-2.052e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=24/seqsize=34 dots=1 dbond=(10,0)-(11,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=9 scratch=./scratch/sweep size=2034:1.52e-05GB T(load)=2.62e-04S speed=5.78e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=4171:3.18e-02MB:3.11e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=2137:1.63e-02MB:1.59e-05GB
total mem of comb=6456:4.93e-02MB:4.81e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=2.103e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=11,8,1
 suppl= 0 1 2 3 4 5 6 16 17 18 19
 suppr= 8 9 10 11 12 13 14 15
 suppc= 7
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(10,0)
 fqop[1]=./scratch/sweep/rop(12,0)
 fqop[2]=./scratch/sweep/cop(11,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:22 S:9 H:1 P:78 Q:84 
        dim(bra,ket)=74,74 size(op)=818:6.241e-03MB size(tot)=87155:6.649e-01MB:6.494e-04GB
        per(mem): C:11 S:4.29 H:0.939 P:24.3 Q:59.5 
 rqops: oplist=CSHAB nops=C:16 S:12 H:1 A:60 B:68 
        dim(bra,ket)=77,77 size(op)=845:0.00645MB size(tot)=74671:0.57MB:0.000556GB
        per(mem): C:9.43 S:6.59 H:1.13 A:24.8 B:58.1 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=164162:1.25MB:0.00122GB
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.839e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(11,0) fdel=./scratch/sweep/lop(10,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=6.561e-04 change=-6.558e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(74,77,4) nnz=2137:1.630e-02MB
qtensor3: wf3 own=1 _data=0x55b2c6b29000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=74
 (15,3):15 (15,1):14 (16,2):11 (17,1):10 (17,3):10 (16,4):7 (14,2):5 (13,1):1 (17,5):1
 qbond: qcol nsym=9 dimAll=77
 (13,-1):15 (13,-3):15 (11,-3):10 (11,-1):10 (12,-2):10 (12,-4):7 (14,-2):6 (15,-1):3 (11,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=23 nblocks=324 size=2137:1.630e-02MB
### DIAG TIMING: total=1.239e-03 t1=2.331e-05, t2=1.249e-05, t3=1.450e-05, t4=1.129e-03, t5=1.020e-05, t6=4.065e-05, t7=9.011e-06
duration_diagGPU:1.257e-03
duration_diagreduce:5.100e-08
duration_diagtransform:2.241e-06
----- TIMING FOR symbolic_formulae_onedot with size=665 : 1.291e-03 S -----
rank=0 GPUmem(GB): used=1.223e-03 (oper)=1.223e-03
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=665
 no. of hintermediate operators=332
 no. of coefficients=3652:2.786e-02MB:2.721e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.606e-05 S -----
rank=0 GPUmem(GB): used=1.250e-03 (oper,hinter)=1.223e-03,2.721e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.638e-03 S size(H_formulae)=665 size(Hxlst2)=23 T(Hmu/Hxlist)=2.836e-04,2.355e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.570e-03 S size(H_formulae)=665 size(Hxlst)=9476 -----
rank=0 GPUmem(GB): used=1.250e-03 avail=3.829e+01 total=3.829e+01 dvdson[need]=3.184e-05 batch[need]=4.349e-02 blksize=225 blksize0=165 batchsize=9476
rank=0 GPUmem(GB): used=4.477e-02 (oper,hinter,dvdson,batch)=1.223e-03,2.721e-05,3.184e-05,4.349e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=2137 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.885e-04,1.640e-04,1.822e-03,2.933e-04,2.479e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.749e-05 speed=1.158e+00GB/S T(nccl)=1.610e-04 speed=1.978e-01GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=1.8e-03 t_reduction=2.9e-04 tot=2.3e-03 -----
 sigma[inter] counter=165 t=1.6e-04 per=7.2e+00 cost=8.4e+06 flops=5.1e+10
 sigma[gemm] counter=165 i=0 t=2.7e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=1 t=2.0e-06 per=8.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=165 i=2 t=4.4e-04 per=1.9e+01 cost=1.0e+07 flops=2.4e+10
 sigma[gemm] counter=165 i=3 t=4.7e-04 per=2.1e+01 cost=1.0e+07 flops=2.2e+10
 sigma[gemm] counter=165 i=4 t=4.7e-04 per=2.1e+01 cost=8.0e+06 flops=1.7e+10
 sigma[gemm] counter=165 i=5 t=4.3e-04 per=1.9e+01 cost=8.2e+06 flops=1.9e+10
 sigma[gemm] counter=165 total t=1.8e-03 per=8.0e+01 cost=3.7e+07 flops=2.0e+10
 sigma[red] counter=165 t=2.9e-04 per=1.3e+01 cost=1.9e+06 flops=6.6e+09
----- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=3.6e-01 t_reduction=5.0e-02 tot=4.3e-01 -----
 sigma_tot[inter] counter=165 t=2.1e-02 per=4.8e+00 cost=6.4e+08 flops=3.1e+10
 sigma_tot[gemm] counter=165 i=0 t=3.5e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=1 t=3.3e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=165 i=2 t=8.6e-02 per=2.0e+01 cost=5.6e+08 flops=6.5e+09
 sigma_tot[gemm] counter=165 i=3 t=1.1e-01 per=2.5e+01 cost=5.5e+08 flops=5.1e+09
 sigma_tot[gemm] counter=165 i=4 t=8.1e-02 per=1.9e+01 cost=4.7e+08 flops=5.8e+09
 sigma_tot[gemm] counter=165 i=5 t=8.1e-02 per=1.9e+01 cost=4.8e+08 flops=5.9e+09
 sigma_tot[gemm] counter=165 total t=3.6e-01 per=8.3e+01 cost=2.0e+09 flops=5.8e+09
 sigma_tot[red] counter=165 t=5.0e-02 per=1.2e+01 cost=1.3e+08 flops=2.6e+09
T(sub)=1.5e-05 T(gemm/eig/ortho/gemm/axpy)=6.4e-06,3.6e-06,1.0e-06,3.0e-06,7.6e-07
settings: ndim=2137 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.542410234795 -1.117e+03  1.801e-02    1     1  2.867e-03 2.867e-03 2.787e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.527e-05,1.421e-04,2.249e-03,3.264e-04,2.800e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.781e-05 speed=1.145e+00GB/S T(nccl)=4.746e-05 speed=6.710e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=2.2e-03 t_reduction=3.3e-04 tot=2.7e-03 -----
 sigma[inter] counter=166 t=1.4e-04 per=5.2e+00 cost=8.4e+06 flops=5.9e+10
 sigma[gemm] counter=166 i=0 t=2.0e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=1 t=2.0e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=166 i=2 t=5.1e-04 per=1.9e+01 cost=1.0e+07 flops=2.1e+10
 sigma[gemm] counter=166 i=3 t=6.1e-04 per=2.2e+01 cost=1.0e+07 flops=1.7e+10
 sigma[gemm] counter=166 i=4 t=5.7e-04 per=2.1e+01 cost=8.0e+06 flops=1.4e+10
 sigma[gemm] counter=166 i=5 t=5.5e-04 per=2.0e+01 cost=8.2e+06 flops=1.5e+10
 sigma[gemm] counter=166 total t=2.2e-03 per=8.3e+01 cost=3.7e+07 flops=1.6e+10
 sigma[red] counter=166 t=3.3e-04 per=1.2e+01 cost=1.9e+06 flops=5.9e+09
----- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=3.6e-01 t_reduction=5.1e-02 tot=4.3e-01 -----
 sigma_tot[inter] counter=166 t=2.1e-02 per=4.8e+00 cost=6.4e+08 flops=3.1e+10
 sigma_tot[gemm] counter=166 i=0 t=3.5e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=1 t=3.3e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=166 i=2 t=8.7e-02 per=2.0e+01 cost=5.7e+08 flops=6.5e+09
 sigma_tot[gemm] counter=166 i=3 t=1.1e-01 per=2.5e+01 cost=5.6e+08 flops=5.2e+09
 sigma_tot[gemm] counter=166 i=4 t=8.1e-02 per=1.9e+01 cost=4.8e+08 flops=5.9e+09
 sigma_tot[gemm] counter=166 i=5 t=8.1e-02 per=1.9e+01 cost=4.8e+08 flops=6.0e+09
 sigma_tot[gemm] counter=166 total t=3.6e-01 per=8.3e+01 cost=2.1e+09 flops=5.8e+09
 sigma_tot[red] counter=166 t=5.1e-02 per=1.2e+01 cost=1.3e+08 flops=2.7e+09
T(sub)=4.5e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,1.5e-05,2.9e-06,5.7e-06,8.7e-07
    2   0 -    -116.542816069715 -4.058e-04  5.518e-03    2     2  6.069e-03 3.035e-03 2.934e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.317e-05,1.443e-04,2.206e-03,3.172e-04,2.747e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.560e-05 speed=1.244e+00GB/S T(nccl)=4.757e-05 speed=6.694e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=2.2e-03 t_reduction=3.2e-04 tot=2.7e-03 -----
 sigma[inter] counter=167 t=1.4e-04 per=5.4e+00 cost=8.4e+06 flops=5.8e+10
 sigma[gemm] counter=167 i=0 t=1.9e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=1 t=1.9e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=167 i=2 t=4.9e-04 per=1.8e+01 cost=1.0e+07 flops=2.1e+10
 sigma[gemm] counter=167 i=3 t=6.2e-04 per=2.3e+01 cost=1.0e+07 flops=1.7e+10
 sigma[gemm] counter=167 i=4 t=5.6e-04 per=2.1e+01 cost=8.0e+06 flops=1.4e+10
 sigma[gemm] counter=167 i=5 t=5.4e-04 per=2.0e+01 cost=8.2e+06 flops=1.5e+10
 sigma[gemm] counter=167 total t=2.2e-03 per=8.3e+01 cost=3.7e+07 flops=1.7e+10
 sigma[red] counter=167 t=3.2e-04 per=1.2e+01 cost=1.9e+06 flops=6.1e+09
----- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=3.6e-01 t_reduction=5.1e-02 tot=4.3e-01 -----
 sigma_tot[inter] counter=167 t=2.1e-02 per=4.9e+00 cost=6.5e+08 flops=3.1e+10
 sigma_tot[gemm] counter=167 i=0 t=3.6e-04 per=8.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=1 t=3.3e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=167 i=2 t=8.7e-02 per=2.0e+01 cost=5.8e+08 flops=6.6e+09
 sigma_tot[gemm] counter=167 i=3 t=1.1e-01 per=2.5e+01 cost=5.7e+08 flops=5.3e+09
 sigma_tot[gemm] counter=167 i=4 t=8.2e-02 per=1.9e+01 cost=4.8e+08 flops=5.9e+09
 sigma_tot[gemm] counter=167 i=5 t=8.2e-02 per=1.9e+01 cost=4.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=167 total t=3.6e-01 per=8.3e+01 cost=2.1e+09 flops=5.9e+09
 sigma_tot[red] counter=167 t=5.1e-02 per=1.2e+01 cost=1.4e+08 flops=2.7e+09
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,1.6e-05,2.2e-06,8.4e-06,8.3e-07
    3   0 -    -116.542869819458 -5.375e-05  2.995e-03    3     3  9.169e-03 3.056e-03 2.957e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.149e-05,1.476e-04,2.196e-03,3.133e-04,2.735e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.433e-05 speed=1.309e+00GB/S T(nccl)=4.716e-05 speed=6.752e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=2.2e-03 t_reduction=3.1e-04 tot=2.7e-03 -----
 sigma[inter] counter=168 t=1.5e-04 per=5.6e+00 cost=8.4e+06 flops=5.7e+10
 sigma[gemm] counter=168 i=0 t=1.9e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=1 t=1.9e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=168 i=2 t=4.9e-04 per=1.8e+01 cost=1.0e+07 flops=2.2e+10
 sigma[gemm] counter=168 i=3 t=6.1e-04 per=2.3e+01 cost=1.0e+07 flops=1.7e+10
 sigma[gemm] counter=168 i=4 t=5.6e-04 per=2.1e+01 cost=8.0e+06 flops=1.4e+10
 sigma[gemm] counter=168 i=5 t=5.3e-04 per=2.0e+01 cost=8.2e+06 flops=1.5e+10
 sigma[gemm] counter=168 total t=2.2e-03 per=8.3e+01 cost=3.7e+07 flops=1.7e+10
 sigma[red] counter=168 t=3.1e-04 per=1.2e+01 cost=1.9e+06 flops=6.2e+09
----- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=3.6e-01 t_reduction=5.1e-02 tot=4.3e-01 -----
 sigma_tot[inter] counter=168 t=2.1e-02 per=4.9e+00 cost=6.6e+08 flops=3.1e+10
 sigma_tot[gemm] counter=168 i=0 t=3.6e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=1 t=3.3e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=168 i=2 t=8.8e-02 per=2.0e+01 cost=5.9e+08 flops=6.7e+09
 sigma_tot[gemm] counter=168 i=3 t=1.1e-01 per=2.5e+01 cost=5.8e+08 flops=5.3e+09
 sigma_tot[gemm] counter=168 i=4 t=8.2e-02 per=1.9e+01 cost=4.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=168 i=5 t=8.2e-02 per=1.9e+01 cost=5.0e+08 flops=6.1e+09
 sigma_tot[gemm] counter=168 total t=3.6e-01 per=8.3e+01 cost=2.2e+09 flops=6.0e+09
 sigma_tot[red] counter=168 t=5.1e-02 per=1.2e+01 cost=1.4e+08 flops=2.7e+09
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.3e-05,2.2e-06,8.4e-06,7.6e-07
    4   0 -    -116.542888700432 -1.888e-05  1.674e-03    3     4  1.214e-02 3.035e-03 2.940e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.850e-04,1.556e-04,2.272e-03,3.134e-04,3.532e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.517e-05 speed=1.265e+00GB/S T(nccl)=7.599e-04 speed=4.191e-02GB/S
----- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=2.3e-03 t_reduction=3.1e-04 tot=2.7e-03 -----
 sigma[inter] counter=169 t=1.6e-04 per=5.7e+00 cost=8.4e+06 flops=5.4e+10
 sigma[gemm] counter=169 i=0 t=2.0e-06 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=1 t=2.0e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=169 i=2 t=5.4e-04 per=2.0e+01 cost=1.0e+07 flops=1.9e+10
 sigma[gemm] counter=169 i=3 t=6.3e-04 per=2.3e+01 cost=1.0e+07 flops=1.6e+10
 sigma[gemm] counter=169 i=4 t=5.6e-04 per=2.1e+01 cost=8.0e+06 flops=1.4e+10
 sigma[gemm] counter=169 i=5 t=5.3e-04 per=1.9e+01 cost=8.2e+06 flops=1.5e+10
 sigma[gemm] counter=169 total t=2.3e-03 per=8.3e+01 cost=3.7e+07 flops=1.6e+10
 sigma[red] counter=169 t=3.1e-04 per=1.1e+01 cost=1.9e+06 flops=6.2e+09
----- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=3.6e-01 t_reduction=5.2e-02 tot=4.4e-01 -----
 sigma_tot[inter] counter=169 t=2.1e-02 per=4.9e+00 cost=6.7e+08 flops=3.2e+10
 sigma_tot[gemm] counter=169 i=0 t=3.6e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=1 t=3.4e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=169 i=2 t=8.8e-02 per=2.0e+01 cost=6.0e+08 flops=6.8e+09
 sigma_tot[gemm] counter=169 i=3 t=1.1e-01 per=2.5e+01 cost=5.9e+08 flops=5.4e+09
 sigma_tot[gemm] counter=169 i=4 t=8.3e-02 per=1.9e+01 cost=5.0e+08 flops=6.0e+09
 sigma_tot[gemm] counter=169 i=5 t=8.3e-02 per=1.9e+01 cost=5.1e+08 flops=6.1e+09
 sigma_tot[gemm] counter=169 total t=3.6e-01 per=8.3e+01 cost=2.2e+09 flops=6.0e+09
 sigma_tot[red] counter=169 t=5.2e-02 per=1.2e+01 cost=1.4e+08 flops=2.7e+09
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.2e-05,2.2e-06,8.4e-06,7.7e-07
    5   0 -    -116.542893499287 -4.799e-06  6.533e-04    3     5  1.584e-02 3.167e-03 3.076e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.987e-05,1.309e-04,2.214e-03,3.197e-04,2.740e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.402e-05 speed=1.326e+00GB/S T(nccl)=4.585e-05 speed=6.946e-01GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=2.2e-03 t_reduction=3.2e-04 tot=2.7e-03 -----
 sigma[inter] counter=170 t=1.3e-04 per=4.9e+00 cost=8.4e+06 flops=6.4e+10
 sigma[gemm] counter=170 i=0 t=1.9e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=1 t=1.9e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=170 i=2 t=5.0e-04 per=1.9e+01 cost=1.0e+07 flops=2.1e+10
 sigma[gemm] counter=170 i=3 t=6.1e-04 per=2.3e+01 cost=1.0e+07 flops=1.7e+10
 sigma[gemm] counter=170 i=4 t=5.6e-04 per=2.1e+01 cost=8.0e+06 flops=1.4e+10
 sigma[gemm] counter=170 i=5 t=5.3e-04 per=2.0e+01 cost=8.2e+06 flops=1.5e+10
 sigma[gemm] counter=170 total t=2.2e-03 per=8.3e+01 cost=3.7e+07 flops=1.7e+10
 sigma[red] counter=170 t=3.2e-04 per=1.2e+01 cost=1.9e+06 flops=6.1e+09
----- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=3.7e-01 t_reduction=5.2e-02 tot=4.4e-01 -----
 sigma_tot[inter] counter=170 t=2.1e-02 per=4.9e+00 cost=6.8e+08 flops=3.2e+10
 sigma_tot[gemm] counter=170 i=0 t=3.6e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=1 t=3.4e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=170 i=2 t=8.9e-02 per=2.0e+01 cost=6.1e+08 flops=6.9e+09
 sigma_tot[gemm] counter=170 i=3 t=1.1e-01 per=2.5e+01 cost=6.0e+08 flops=5.5e+09
 sigma_tot[gemm] counter=170 i=4 t=8.3e-02 per=1.9e+01 cost=5.1e+08 flops=6.1e+09
 sigma_tot[gemm] counter=170 i=5 t=8.4e-02 per=1.9e+01 cost=5.2e+08 flops=6.2e+09
 sigma_tot[gemm] counter=170 total t=3.7e-01 per=8.3e+01 cost=2.2e+09 flops=6.1e+09
 sigma_tot[red] counter=170 t=5.2e-02 per=1.2e+01 cost=1.4e+08 flops=2.7e+09
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.2e-05,2.0e-06,8.5e-06,7.6e-07
    6   0 -    -116.542894094603 -5.953e-07  2.244e-04    3     6  1.874e-02 3.124e-03 3.035e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.129e-05,1.265e-04,2.331e-03,3.170e-04,2.851e-03
 analyze_tgpu[Hx]: ndim=2137:1.592e-05GB T(cpu-gpu)=2.486e-05 speed=1.281e+00GB/S T(nccl)=4.644e-05 speed=6.857e-01GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=2.3e-03 t_reduction=3.2e-04 tot=2.8e-03 -----
 sigma[inter] counter=171 t=1.3e-04 per=4.6e+00 cost=8.4e+06 flops=6.6e+10
 sigma[gemm] counter=171 i=0 t=2.1e-06 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=1 t=2.0e-06 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=171 i=2 t=5.5e-04 per=2.0e+01 cost=1.0e+07 flops=1.9e+10
 sigma[gemm] counter=171 i=3 t=6.4e-04 per=2.3e+01 cost=1.0e+07 flops=1.6e+10
 sigma[gemm] counter=171 i=4 t=6.1e-04 per=2.2e+01 cost=8.0e+06 flops=1.3e+10
 sigma[gemm] counter=171 i=5 t=5.3e-04 per=1.9e+01 cost=8.2e+06 flops=1.5e+10
 sigma[gemm] counter=171 total t=2.3e-03 per=8.4e+01 cost=3.7e+07 flops=1.6e+10
 sigma[red] counter=171 t=3.2e-04 per=1.1e+01 cost=1.9e+06 flops=6.1e+09
----- TIMING FOR sigma_tot : t_inter=2.1e-02 t_gemm=3.7e-01 t_reduction=5.2e-02 tot=4.4e-01 -----
 sigma_tot[inter] counter=171 t=2.1e-02 per=4.9e+00 cost=6.9e+08 flops=3.2e+10
 sigma_tot[gemm] counter=171 i=0 t=3.6e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=1 t=3.4e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=171 i=2 t=8.9e-02 per=2.0e+01 cost=6.2e+08 flops=6.9e+09
 sigma_tot[gemm] counter=171 i=3 t=1.1e-01 per=2.5e+01 cost=6.1e+08 flops=5.5e+09
 sigma_tot[gemm] counter=171 i=4 t=8.4e-02 per=1.9e+01 cost=5.2e+08 flops=6.1e+09
 sigma_tot[gemm] counter=171 i=5 t=8.4e-02 per=1.9e+01 cost=5.3e+08 flops=6.3e+09
 sigma_tot[gemm] counter=171 total t=3.7e-01 per=8.3e+01 cost=2.3e+09 flops=6.2e+09
 sigma_tot[red] counter=171 t=5.2e-02 per=1.2e+01 cost=1.4e+08 flops=2.8e+09
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.2e-05,2.1e-06,8.4e-06,7.3e-07
    7   0 +    -116.542894169549 -7.495e-08  8.940e-05    3     7  2.193e-02 3.133e-03 3.045e-03
TIMING FOR Davidson : 2.195e-02  T(cal/comm/rest)=2.132e-02,4.125e-06,6.256e-04
decomposed t_rest=6.256e-04
 T(sub)    =2.783e-04 per=4.448e+01
 T(precond)=3.509e-05 per=5.608e+00
 T(ortho)  =4.179e-05 per=6.680e+00
 T(xcopy)  =4.739e-06 per=7.575e-01
 T(xnrm2)  =7.339e-06 per=1.173e+00
 T(other)  =2.584e-04 per=4.130e+01
optimized energies: isweep=0 ibond=24 dots=1 e[0]=-116.542894169549 nmvp=7
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=2.670e-03 change=2.583e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond24.txt
 qbond: qsuper nsym=18 dimAll=308
 (13,-1):35 (13,-3):42 (11,-3):10 (11,-1):10 (12,-2):30 (12,-4):18 (14,-2):46 (15,-1):24 (11,-5):1 (15,-3):21 (14,-4):22 (16,-2):9 (17,-1):3 (13,-5):8 (14,0):15 (12,0):10 (16,0):3 (12,-6):1
timing for divide=3.1e-06
timing for compute=3.3e-04
timing for collect=6.6e-06
----- TMING FOR decimation_genbasis(nkr): 3.4e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.1e-06,3.2e-04,0.0e+00,2.2e-06,6.6e-06 -----
decimation summary: 308->74 dwt=+1.110e-16 SvN=2.398e+00
 qbond: qkept nsym=9 dimAll=74
 (15,-3):15 (15,-1):14 (14,-2):11 (13,-1):10 (13,-3):10 (14,-4):7 (16,-2):5 (17,-1):1 (13,-5):1
----- TIMING for decimation_row(nkr): 1.519e-03 S T(decim/select/formRot)=3.680e-04,1.136e-03,1.525e-05 -----
----- TIMING FOR onedot_decimation: 1.618e-03 S T(wf/decim)=8.352e-05,1.535e-03 -----
ctns::oper_renorm coord=(11,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:18 S:11 H:1 A:78 B:84 
        dim(bra,ket)=74,74 size(op)=818:6.241e-03MB size(tot)=86243:6.580e-01MB:6.426e-04GB
        per(mem): C:9.09 S:5.29 H:0.948 A:24.5 B:60.1 
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=2.670e-03 change=2.982e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=181 : 2.191e-04 S -----
rank=0 GPUmem(GB): used=1.244e-03 (oper)=1.216e-03
rank=0 GPUmem(GB): used=1.259e-03 (oper,site)=1.216e-03,1.592e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=181
 no. of rintermediate operators=7
 no. of coefficients=208:1.587e-03MB:1.550e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.698e-05 S -----
rank=0 GPUmem(GB): used=1.261e-03 (oper,site,rinter)=1.216e-03,1.592e-05,1.550e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 6.960e-04 S size(rtasks)=181 size(Rlst2)=81 T(Rmu/Rlist)=1.144e-04,5.815e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.501e-04 S size(rtasks)=181 size(Rlst)=2162 -----
rank=0 GPUmem(GB): used=1.261e-03 avail=3.829e+01 total=3.829e+01 batch[need]=1.089e-02 blksize=225 blksize0=225 batchsize=2162
rank=0 GPUmem(GB): used=1.215e-02 (oper,site,rinter,batch)=1.216e-03,1.592e-05,1.550e-06,1.089e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.391e-04,1.215e-03,3.453e-04
----- TIMING FOR renorm : t_inter=1.4e-04 t_gemm=1.2e-03 t_reduction=3.5e-04 tot=1.7e-03 -----
 renorm[inter] counter=573 t=1.4e-04 per=8.2e+00 cost=8.8e+05 flops=6.3e+09
 renorm[gemm] counter=573 i=0 t=2.0e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=573 i=1 t=1.9e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=573 i=2 t=3.0e-04 per=1.8e+01 cost=5.4e+05 flops=1.8e+09
 renorm[gemm] counter=573 i=3 t=4.7e-04 per=2.8e+01 cost=3.8e+06 flops=8.0e+09
 renorm[gemm] counter=573 i=4 t=1.6e-06 per=9.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=573 i=5 t=1.6e-06 per=9.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=573 i=6 t=4.4e-04 per=2.6e+01 cost=4.4e+06 flops=1.0e+10
 renorm[gemm] counter=573 total t=1.2e-03 per=7.1e+01 cost=8.7e+06 flops=7.2e+09
 renorm[red] counter=573 t=3.5e-04 per=2.0e+01 cost=4.3e+05 flops=1.3e+09
----- TIMING FOR renorm_tot : t_inter=3.2e-03 t_gemm=2.5e-02 t_reduction=6.2e-03 tot=3.4e-02 -----
 renorm_tot[inter] counter=573 t=3.2e-03 per=9.3e+00 cost=1.8e+07 flops=5.8e+09
 renorm_tot[gemm] counter=573 i=0 t=5.3e-05 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=573 i=1 t=4.7e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=573 i=2 t=1.8e-03 per=5.3e+00 cost=1.4e+06 flops=7.7e+08
 renorm_tot[gemm] counter=573 i=3 t=2.8e-03 per=8.4e+00 cost=8.0e+06 flops=2.8e+09
 renorm_tot[gemm] counter=573 i=4 t=4.6e-03 per=1.3e+01 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=573 i=5 t=6.4e-03 per=1.9e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=573 i=6 t=8.8e-03 per=2.6e+01 cost=5.6e+07 flops=6.3e+09
 renorm_tot[gemm] counter=573 total t=2.5e-02 per=7.2e+01 cost=9.9e+07 flops=4.0e+09
 renorm_tot[red] counter=573 t=6.2e-03 per=1.8e+01 cost=6.5e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.276e-03 (oper)=1.220e-03
rank=0 GPUmem(GB): used=1.292e-03 (oper,site,rinter)=1.220e-03,1.592e-05,2.721e-05
rank=0 GPUmem(GB): used=1.609e-03 (oper,site,rinter,batch)=1.220e-03,1.592e-05,2.721e-05,3.173e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.578e-02 S T(preprocess/alloc/comp/red/dealloc)=1.964e-03,2.022e-03,1.109e-02,2.457e-03,1.697e-04 -----
----- TIMING FOR oper_renorm_opS : 1.582e-02 S rank=0 -----
qops.to_cpu: size(tot)=86243:6.580e-01MB:6.426e-04GB T(to_cpu)=4.477e-04S speed=1.435e+00GB/S
check ||H-H.dagger||=7.553e-14 coord=(11,0) rank=0
----- TIMING FOR oper_renorm : 0.0215 S rank=0 -----
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=2.655e-03 change=1.216e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=5.409e-03 change=-2.549e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=5.409e-03 change=-2.147e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 6.299e-02 S #####
 T(local opt: fetch) = 3.684e-03 S  per = 5.85  per(accum) = 5.85
 T(local opt: hdiag) = 1.328e-03 S  per = 2.11  per(accum) = 7.96
 T(local opt: dvdsn) = 3.138e-02 S  per = 49.8  per(accum) = 57.8
 T(local opt: decim) = 1.660e-03 S  per = 2.64  per(accum) = 60.4
 T(local opt: guess) = 7.235e-05 S  per = 0.115  per(accum) = 60.5
 T(local opt: renrm) = 2.238e-02 S  per = 35.5  per(accum) = 96.1
 T(local opt: save ) = 2.480e-03 S  per = 3.94  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.138e-02 S  T(sum) = 3.069e-02 S  per = 9.781e+01
 T(local opt: preprocess                  ) = 7.222e-05 S  per = 0.235  per(accum) = 0.235
 T(local opt: symbolic_formulae           ) = 1.304e-03 S  per = 4.25  per(accum) = 4.48
 T(local opt: hintermediate init          ) = 9.242e-05 S  per = 0.301  per(accum) = 4.78
 T(local opt: preprocess_hformulae_Hxlist ) = 3.618e-03 S  per = 11.8  per(accum) = 16.6
 T(local opt: hmmtasks init               ) = 3.647e-03 S  per = 11.9  per(accum) = 28.5
 T(local opt: initial guess for dvdson    ) = 8.847e-06 S  per = 0.0288  per(accum) = 28.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.998e-02 S  per = 65.1  per(accum) = 93.6
 T(local opt: dvdson [cpu-gpu]            ) = 1.793e-04 S  per = 0.584  per(accum) = 94.2
 T(local opt: dvdson [nccl]               ) = 1.155e-03 S  per = 3.76  per(accum) = 97.9
 T(local opt: dvdson [mpi]                ) = 4.125e-06 S  per = 0.0134  per(accum) = 98
 T(local opt: dvdson [rest part(linalg)]  ) = 6.256e-04 S  per = 2.04  per(accum) = 100
Detailed decomposition of T(renrm) = 2.238e-02 S  T(sum) = 2.238e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 2.413e-04 S  per = 1.08  per(accum) = 1.08
 T(local opt: qops init                    ) = 6.460e-04 S  per = 2.89  per(accum) = 3.96
 T(local opt: symbolic_formulae_renorm     ) = 2.242e-04 S  per =    1  per(accum) = 4.97
 T(local opt: allocate qops on gpu         ) = 2.128e-04 S  per = 0.951  per(accum) = 5.92
 T(local opt: site memcpy cpu2gpu          ) = 2.531e-05 S  per = 0.113  per(accum) = 6.03
 T(local opt: rintermediate init           ) = 3.407e-05 S  per = 0.152  per(accum) = 6.18
 T(local opt: preprocess_formulae_Rlist2   ) = 9.609e-04 S  per = 4.29  per(accum) = 10.5
 T(local opt: rmmtasks init                ) = 1.030e-03 S  per =  4.6  per(accum) = 15.1
 T(local opt: qops memset on cpu           ) = 5.000e-08 S  per = 0.000223  per(accum) = 15.1
 T(local opt: preprocess_renorm_batchGPU   ) = 1.767e-03 S  per =  7.9  per(accum) = 23
 T(local opt: deallocate cpu and gpu memory) = 1.899e-04 S  per = 0.848  per(accum) = 23.8
 T(local opt: construct opS [ifdists=true] ) = 1.591e-02 S  per = 71.1  per(accum) = 94.9
 T(local opt: reduction of opS & opH [nccl]) = 2.068e-05 S  per = 0.0924  per(accum) = 95
 T(local opt: qops memcpy gpu2cpu          ) = 4.622e-04 S  per = 2.06  per(accum) = 97.1
 T(local opt: reduction of opS & opH [mpi] ) = 5.183e-05 S  per = 0.232  per(accum) = 97.3
 T(local opt: qops_pool join and erase     ) = 6.061e-04 S  per = 2.71  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.580e-07 S  per = 0.00383  per(accum) = 100
ctns::rcanon_save_site idx=8 scratch=./scratch/sweep size=2137:1.6e-05GB T(load)=0.00056S speed=0.029GB/S
##### sweep opt: 1.319e+00 S #####
 T(sweep opt: fetch) = 8.243e-02 S  per = 6.25  per(accum) = 6.25
 T(sweep opt: hdiag) = 2.001e-02 S  per = 1.52  per(accum) = 7.77
 T(sweep opt: dvdsn) = 6.598e-01 S  per =   50  per(accum) = 57.8
 T(sweep opt: decim) = 2.872e-02 S  per = 2.18  per(accum) = 60
 T(sweep opt: guess) = 1.322e-03 S  per =  0.1  per(accum) = 60.1
 T(sweep opt: renrm) = 4.757e-01 S  per = 36.1  per(accum) = 96.1
 T(sweep opt: save ) = 5.113e-02 S  per = 3.88  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.598e-01 S  T(sum) = 6.471e-01 S  per = 9.808e+01
 T(sweep opt: preprocess                  ) = 1.684e-03 S  per = 0.26  per(accum) = 0.26
 T(sweep opt: symbolic_formulae           ) = 1.967e-02 S  per = 3.04  per(accum) = 3.3
 T(sweep opt: hintermediate init          ) = 1.479e-03 S  per = 0.228  per(accum) = 3.53
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.190e-02 S  per = 9.57  per(accum) = 13.1
 T(sweep opt: hmmtasks init               ) = 6.352e-02 S  per = 9.82  per(accum) = 22.9
 T(sweep opt: initial guess for dvdson    ) = 1.452e-04 S  per = 0.0224  per(accum) = 22.9
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 4.734e-01 S  per = 73.2  per(accum) = 96.1
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.154e-03 S  per = 0.642  per(accum) = 96.7
 T(sweep opt: dvdson [nccl]               ) = 9.096e-03 S  per = 1.41  per(accum) = 98.1
 T(sweep opt: dvdson [mpi]                ) = 7.498e-05 S  per = 0.0116  per(accum) = 98.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.192e-02 S  per = 1.84  per(accum) = 100
Detailed decomposition of T(renrm) = 4.757e-01 S  T(sum) = 4.757e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.404e-03 S  per = 0.295  per(accum) = 0.295
 T(sweep opt: qops init                    ) = 1.151e-02 S  per = 2.42  per(accum) = 2.71
 T(sweep opt: symbolic_formulae_renorm     ) = 9.631e-03 S  per = 2.02  per(accum) = 4.74
 T(sweep opt: allocate qops on gpu         ) = 1.759e-03 S  per = 0.37  per(accum) = 5.11
 T(sweep opt: site memcpy cpu2gpu          ) = 5.864e-04 S  per = 0.123  per(accum) = 5.23
 T(sweep opt: rintermediate init           ) = 1.175e-03 S  per = 0.247  per(accum) = 5.48
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.926e-02 S  per = 4.05  per(accum) = 9.53
 T(sweep opt: rmmtasks init                ) = 2.248e-02 S  per = 4.72  per(accum) = 14.3
 T(sweep opt: qops memset on cpu           ) = 1.131e-06 S  per = 0.000238  per(accum) = 14.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.736e-02 S  per = 7.85  per(accum) = 22.1
 T(sweep opt: deallocate cpu and gpu memory) = 3.386e-03 S  per = 0.712  per(accum) = 22.8
 T(sweep opt: construct opS [ifdists=true] ) = 3.393e-01 S  per = 71.3  per(accum) = 94.1
 T(sweep opt: reduction of opS & opH [nccl]) = 6.326e-04 S  per = 0.133  per(accum) = 94.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.528e-03 S  per = 0.742  per(accum) = 95
 T(sweep opt: reduction of opS & opH [mpi] ) = 7.487e-04 S  per = 0.157  per(accum) = 95.2
 T(sweep opt: qops_pool join and erase     ) = 1.611e-02 S  per = 3.39  per(accum) = 98.6
 T(sweep opt: conversion from opAB to opPQ ) = 6.837e-03 S  per = 1.44  per(accum) = 100
##### global opt: 1.319e+00 S #####
 T(global opt: fetch) = 8.243e-02 S  per = 6.25  per(accum) = 6.25
 T(global opt: hdiag) = 2.001e-02 S  per = 1.52  per(accum) = 7.77
 T(global opt: dvdsn) = 6.598e-01 S  per =   50  per(accum) = 57.8
 T(global opt: decim) = 2.872e-02 S  per = 2.18  per(accum) = 60
 T(global opt: guess) = 1.322e-03 S  per =  0.1  per(accum) = 60.1
 T(global opt: renrm) = 4.757e-01 S  per = 36.1  per(accum) = 96.1
 T(global opt: save ) = 5.113e-02 S  per = 3.88  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.598e-01 S  T(sum) = 6.471e-01 S  per = 9.808e+01
 T(global opt: preprocess                  ) = 1.684e-03 S  per = 0.26  per(accum) = 0.26
 T(global opt: symbolic_formulae           ) = 1.967e-02 S  per = 3.04  per(accum) = 3.3
 T(global opt: hintermediate init          ) = 1.479e-03 S  per = 0.228  per(accum) = 3.53
 T(global opt: preprocess_hformulae_Hxlist ) = 6.190e-02 S  per = 9.57  per(accum) = 13.1
 T(global opt: hmmtasks init               ) = 6.352e-02 S  per = 9.82  per(accum) = 22.9
 T(global opt: initial guess for dvdson    ) = 1.452e-04 S  per = 0.0224  per(accum) = 22.9
 T(global opt: dvdson [Hx_batchGPU]        ) = 4.734e-01 S  per = 73.2  per(accum) = 96.1
 T(global opt: dvdson [cpu-gpu]            ) = 4.154e-03 S  per = 0.642  per(accum) = 96.7
 T(global opt: dvdson [nccl]               ) = 9.096e-03 S  per = 1.41  per(accum) = 98.1
 T(global opt: dvdson [mpi]                ) = 7.498e-05 S  per = 0.0116  per(accum) = 98.2
 T(global opt: dvdson [rest part(linalg)]  ) = 1.192e-02 S  per = 1.84  per(accum) = 100
Detailed decomposition of T(renrm) = 4.757e-01 S  T(sum) = 4.757e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.404e-03 S  per = 0.295  per(accum) = 0.295
 T(global opt: qops init                    ) = 1.151e-02 S  per = 2.42  per(accum) = 2.71
 T(global opt: symbolic_formulae_renorm     ) = 9.631e-03 S  per = 2.02  per(accum) = 4.74
 T(global opt: allocate qops on gpu         ) = 1.759e-03 S  per = 0.37  per(accum) = 5.11
 T(global opt: site memcpy cpu2gpu          ) = 5.864e-04 S  per = 0.123  per(accum) = 5.23
 T(global opt: rintermediate init           ) = 1.175e-03 S  per = 0.247  per(accum) = 5.48
 T(global opt: preprocess_formulae_Rlist2   ) = 1.926e-02 S  per = 4.05  per(accum) = 9.53
 T(global opt: rmmtasks init                ) = 2.248e-02 S  per = 4.72  per(accum) = 14.3
 T(global opt: qops memset on cpu           ) = 1.131e-06 S  per = 0.000238  per(accum) = 14.3
 T(global opt: preprocess_renorm_batchGPU   ) = 3.736e-02 S  per = 7.85  per(accum) = 22.1
 T(global opt: deallocate cpu and gpu memory) = 3.386e-03 S  per = 0.712  per(accum) = 22.8
 T(global opt: construct opS [ifdists=true] ) = 3.393e-01 S  per = 71.3  per(accum) = 94.1
 T(global opt: reduction of opS & opH [nccl]) = 6.326e-04 S  per = 0.133  per(accum) = 94.3
 T(global opt: qops memcpy gpu2cpu          ) = 3.528e-03 S  per = 0.742  per(accum) = 95
 T(global opt: reduction of opS & opH [mpi] ) = 7.487e-04 S  per = 0.157  per(accum) = 95.2
 T(global opt: qops_pool join and erase     ) = 1.611e-02 S  per = 3.39  per(accum) = 98.6
 T(global opt: conversion from opAB to opPQ ) = 6.837e-03 S  per = 1.44  per(accum) = 100
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-2.589e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=25/seqsize=34 dots=1 dbond=(9,0)-(10,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=10 scratch=./scratch/sweep size=1583:1.18e-05GB T(load)=2.99e-04S speed=3.95e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=3617:2.76e-02MB:2.69e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=2034:1.55e-02MB:1.52e-05GB
total mem of comb=5799:4.42e-02MB:4.32e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.988e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=10,9,1
 suppl= 0 1 2 3 4 5 16 17 18 19
 suppr= 7 8 9 10 11 12 13 14 15
 suppc= 6
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(9,0)
 fqop[1]=./scratch/sweep/rop(11,0)
 fqop[2]=./scratch/sweep/cop(10,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:20 S:10 H:1 P:95 Q:105 
        dim(bra,ket)=73,73 size(op)=613:4.677e-03MB size(tot)=86546:6.603e-01MB:6.448e-04GB
        per(mem): C:9.16 S:4.68 H:0.708 P:26.6 Q:58.9 
 rqops: oplist=CSHAB nops=C:18 S:11 H:1 A:78 B:84 
        dim(bra,ket)=74,74 size(op)=818:0.00624MB size(tot)=86243:0.658MB:0.000643GB
        per(mem): C:9.09 S:5.29 H:0.948 A:24.5 B:60.1 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=175125:1.34MB:0.0013GB
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=0.000e+00 change=2.046e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(10,0) fdel=./scratch/sweep/lop(9,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=6.485e-04 change=-6.481e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(73,74,4) nnz=2034:1.552e-02MB
qtensor3: wf3 own=1 _data=0x55b2c6a80000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=12 dimAll=73
 (14,2):14 (15,1):10 (14,0):10 (16,2):8 (15,3):7 (16,0):6 (13,1):5 (13,3):4 (14,4):4 (12,2):3 (12,0):1 (16,4):1
 qbond: qcol nsym=9 dimAll=74
 (15,-3):15 (15,-1):14 (14,-2):11 (13,-1):10 (13,-3):10 (14,-4):7 (16,-2):5 (17,-1):1 (13,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=29 nblocks=432 size=2034:1.552e-02MB
### DIAG TIMING: total=1.652e-03 t1=2.130e-05, t2=1.399e-05, t3=1.316e-05, t4=1.544e-03, t5=1.099e-05, t6=4.023e-05, t7=8.753e-06
duration_diagGPU:1.661e-03
duration_diagreduce:4.400e-08
duration_diagtransform:3.137e-06
----- TIMING FOR symbolic_formulae_onedot with size=816 : 1.464e-03 S -----
rank=0 GPUmem(GB): used=1.305e-03 (oper)=1.305e-03
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=816
 no. of hintermediate operators=411
 no. of coefficients=4110:3.136e-02MB:3.062e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.885e-05 S -----
rank=0 GPUmem(GB): used=1.335e-03 (oper,hinter)=1.305e-03,3.062e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 4.824e-03 S size(H_formulae)=816 size(Hxlst2)=29 T(Hmu/Hxlist)=4.089e-04,4.415e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.469e-03 S size(H_formulae)=816 size(Hxlst)=16440 -----
rank=0 GPUmem(GB): used=1.335e-03 avail=3.829e+01 total=3.829e+01 dvdson[need]=3.031e-05 batch[need]=6.872e-02 blksize=210 blksize0=140 batchsize=16440
rank=0 GPUmem(GB): used=7.008e-02 (oper,hinter,dvdson,batch)=1.305e-03,3.062e-05,3.031e-05,6.872e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=2034 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=8.291e-05,2.105e-04,3.268e-03,3.607e-04,3.938e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=2.753e-05 speed=1.101e+00GB/S T(nccl)=5.539e-05 speed=5.472e-01GB/S
----- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=3.3e-03 t_reduction=3.6e-04 tot=3.8e-03 -----
 sigma[inter] counter=172 t=2.1e-04 per=5.5e+00 cost=8.5e+06 flops=4.1e+10
 sigma[gemm] counter=172 i=0 t=1.9e-06 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=1 t=1.8e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=172 i=2 t=8.1e-04 per=2.1e+01 cost=1.4e+07 flops=1.7e+10
 sigma[gemm] counter=172 i=3 t=8.9e-04 per=2.3e+01 cost=1.4e+07 flops=1.6e+10
 sigma[gemm] counter=172 i=4 t=8.0e-04 per=2.1e+01 cost=8.6e+06 flops=1.1e+10
 sigma[gemm] counter=172 i=5 t=7.7e-04 per=2.0e+01 cost=8.7e+06 flops=1.1e+10
 sigma[gemm] counter=172 total t=3.3e-03 per=8.5e+01 cost=4.5e+07 flops=1.4e+10
 sigma[red] counter=172 t=3.6e-04 per=9.4e+00 cost=2.6e+06 flops=7.3e+09
----- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=3.7e-01 t_reduction=5.3e-02 tot=4.5e-01 -----
 sigma_tot[inter] counter=172 t=2.2e-02 per=4.9e+00 cost=6.9e+08 flops=3.2e+10
 sigma_tot[gemm] counter=172 i=0 t=3.7e-04 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=1 t=3.4e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=172 i=2 t=9.0e-02 per=2.0e+01 cost=6.3e+08 flops=7.0e+09
 sigma_tot[gemm] counter=172 i=3 t=1.1e-01 per=2.5e+01 cost=6.2e+08 flops=5.6e+09
 sigma_tot[gemm] counter=172 i=4 t=8.5e-02 per=1.9e+01 cost=5.2e+08 flops=6.2e+09
 sigma_tot[gemm] counter=172 i=5 t=8.5e-02 per=1.9e+01 cost=5.3e+08 flops=6.3e+09
 sigma_tot[gemm] counter=172 total t=3.7e-01 per=8.3e+01 cost=2.3e+09 flops=6.2e+09
 sigma_tot[red] counter=172 t=5.3e-02 per=1.2e+01 cost=1.5e+08 flops=2.8e+09
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=9.6e-06,4.8e-06,1.2e-06,3.8e-06,7.8e-07
settings: ndim=2034 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.542894169549 -1.117e+03  2.433e-02    1     1  4.318e-03 4.318e-03 4.266e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.755e-05,1.928e-04,4.894e-03,5.440e-04,5.716e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=2.785e-05 speed=1.088e+00GB/S T(nccl)=4.970e-05 speed=6.098e-01GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=4.9e-03 t_reduction=5.4e-04 tot=5.6e-03 -----
 sigma[inter] counter=173 t=1.9e-04 per=3.4e+00 cost=8.5e+06 flops=4.4e+10
 sigma[gemm] counter=173 i=0 t=2.2e-06 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=1 t=2.1e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=173 i=2 t=9.4e-04 per=1.7e+01 cost=1.4e+07 flops=1.5e+10
 sigma[gemm] counter=173 i=3 t=1.5e-03 per=2.6e+01 cost=1.4e+07 flops=9.5e+09
 sigma[gemm] counter=173 i=4 t=1.3e-03 per=2.2e+01 cost=8.6e+06 flops=6.9e+09
 sigma[gemm] counter=173 i=5 t=1.2e-03 per=2.2e+01 cost=8.7e+06 flops=7.1e+09
 sigma[gemm] counter=173 total t=4.9e-03 per=8.7e+01 cost=4.5e+07 flops=9.3e+09
 sigma[red] counter=173 t=5.4e-04 per=9.7e+00 cost=2.6e+06 flops=4.8e+09
----- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=3.8e-01 t_reduction=5.3e-02 tot=4.5e-01 -----
 sigma_tot[inter] counter=173 t=2.2e-02 per=4.8e+00 cost=7.0e+08 flops=3.2e+10
 sigma_tot[gemm] counter=173 i=0 t=3.7e-04 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=1 t=3.4e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=173 i=2 t=9.1e-02 per=2.0e+01 cost=6.5e+08 flops=7.1e+09
 sigma_tot[gemm] counter=173 i=3 t=1.1e-01 per=2.5e+01 cost=6.4e+08 flops=5.6e+09
 sigma_tot[gemm] counter=173 i=4 t=8.6e-02 per=1.9e+01 cost=5.3e+08 flops=6.2e+09
 sigma_tot[gemm] counter=173 i=5 t=8.6e-02 per=1.9e+01 cost=5.4e+08 flops=6.3e+09
 sigma_tot[gemm] counter=173 total t=3.8e-01 per=8.3e+01 cost=2.4e+09 flops=6.3e+09
 sigma_tot[red] counter=173 t=5.3e-02 per=1.2e+01 cost=1.5e+08 flops=2.8e+09
T(sub)=6.7e-05 T(gemm/eig/ortho/gemm/axpy)=2.9e-05,2.4e-05,4.3e-06,8.6e-06,1.4e-06
    2   0 -    -116.543523215824 -6.290e-04  5.373e-03    2     2  1.064e-02 5.321e-03 5.222e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.892e-05,2.226e-04,4.950e-03,4.378e-04,5.698e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=2.895e-05 speed=1.047e+00GB/S T(nccl)=4.996e-05 speed=6.066e-01GB/S
----- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=4.9e-03 t_reduction=4.4e-04 tot=5.6e-03 -----
 sigma[inter] counter=174 t=2.2e-04 per=4.0e+00 cost=8.5e+06 flops=3.8e+10
 sigma[gemm] counter=174 i=0 t=2.8e-06 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=1 t=2.4e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=174 i=2 t=1.1e-03 per=1.9e+01 cost=1.4e+07 flops=1.3e+10
 sigma[gemm] counter=174 i=3 t=1.5e-03 per=2.6e+01 cost=1.4e+07 flops=9.5e+09
 sigma[gemm] counter=174 i=4 t=1.2e-03 per=2.2e+01 cost=8.6e+06 flops=7.1e+09
 sigma[gemm] counter=174 i=5 t=1.2e-03 per=2.1e+01 cost=8.7e+06 flops=7.2e+09
 sigma[gemm] counter=174 total t=4.9e-03 per=8.8e+01 cost=4.5e+07 flops=9.2e+09
 sigma[red] counter=174 t=4.4e-04 per=7.8e+00 cost=2.6e+06 flops=6.0e+09
----- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=3.8e-01 t_reduction=5.4e-02 tot=4.6e-01 -----
 sigma_tot[inter] counter=174 t=2.2e-02 per=4.8e+00 cost=7.1e+08 flops=3.2e+10
 sigma_tot[gemm] counter=174 i=0 t=3.7e-04 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=1 t=3.5e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=174 i=2 t=9.2e-02 per=2.0e+01 cost=6.6e+08 flops=7.2e+09
 sigma_tot[gemm] counter=174 i=3 t=1.1e-01 per=2.5e+01 cost=6.5e+08 flops=5.7e+09
 sigma_tot[gemm] counter=174 i=4 t=8.7e-02 per=1.9e+01 cost=5.4e+08 flops=6.2e+09
 sigma_tot[gemm] counter=174 i=5 t=8.7e-02 per=1.9e+01 cost=5.5e+08 flops=6.3e+09
 sigma_tot[gemm] counter=174 total t=3.8e-01 per=8.3e+01 cost=2.4e+09 flops=6.3e+09
 sigma_tot[red] counter=174 t=5.4e-02 per=1.2e+01 cost=1.5e+08 flops=2.8e+09
T(sub)=5.4e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-05,2.0e-05,2.4e-06,9.7e-06,9.0e-07
    3   0 -    -116.543573392551 -5.018e-05  2.348e-03    3     3  1.687e-02 5.624e-03 5.516e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.993e-05,1.927e-04,4.053e-03,4.386e-04,4.771e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=3.151e-05 speed=9.620e-01GB/S T(nccl)=4.842e-05 speed=6.259e-01GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=4.1e-03 t_reduction=4.4e-04 tot=4.7e-03 -----
 sigma[inter] counter=175 t=1.9e-04 per=4.1e+00 cost=8.5e+06 flops=4.4e+10
 sigma[gemm] counter=175 i=0 t=2.1e-06 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=1 t=2.0e-06 per=4.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=175 i=2 t=8.8e-04 per=1.9e+01 cost=1.4e+07 flops=1.6e+10
 sigma[gemm] counter=175 i=3 t=1.2e-03 per=2.5e+01 cost=1.4e+07 flops=1.2e+10
 sigma[gemm] counter=175 i=4 t=9.9e-04 per=2.1e+01 cost=8.6e+06 flops=8.8e+09
 sigma[gemm] counter=175 i=5 t=1.0e-03 per=2.1e+01 cost=8.7e+06 flops=8.7e+09
 sigma[gemm] counter=175 total t=4.1e-03 per=8.7e+01 cost=4.5e+07 flops=1.1e+10
 sigma[red] counter=175 t=4.4e-04 per=9.4e+00 cost=2.6e+06 flops=6.0e+09
----- TIMING FOR sigma_tot : t_inter=2.2e-02 t_gemm=3.9e-01 t_reduction=5.4e-02 tot=4.6e-01 -----
 sigma_tot[inter] counter=175 t=2.2e-02 per=4.8e+00 cost=7.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=175 i=0 t=3.7e-04 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=1 t=3.5e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=175 i=2 t=9.3e-02 per=2.0e+01 cost=6.8e+08 flops=7.3e+09
 sigma_tot[gemm] counter=175 i=3 t=1.2e-01 per=2.5e+01 cost=6.7e+08 flops=5.8e+09
 sigma_tot[gemm] counter=175 i=4 t=8.8e-02 per=1.9e+01 cost=5.5e+08 flops=6.2e+09
 sigma_tot[gemm] counter=175 i=5 t=8.8e-02 per=1.9e+01 cost=5.6e+08 flops=6.3e+09
 sigma_tot[gemm] counter=175 total t=3.9e-01 per=8.3e+01 cost=2.5e+09 flops=6.4e+09
 sigma_tot[red] counter=175 t=5.4e-02 per=1.2e+01 cost=1.6e+08 flops=2.9e+09
T(sub)=4.7e-05 T(gemm/eig/ortho/gemm/axpy)=2.1e-05,1.4e-05,2.4e-06,9.3e-06,8.9e-07
    4   0 -    -116.543582532993 -9.140e-06  1.027e-03    3     4  2.212e-02 5.531e-03 5.420e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.334e-05,1.905e-04,4.032e-03,4.052e-04,4.707e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=2.704e-05 speed=1.121e+00GB/S T(nccl)=4.630e-05 speed=6.546e-01GB/S
----- TIMING FOR sigma : t_inter=1.9e-04 t_gemm=4.0e-03 t_reduction=4.0e-04 tot=4.6e-03 -----
 sigma[inter] counter=176 t=1.9e-04 per=4.1e+00 cost=8.5e+06 flops=4.5e+10
 sigma[gemm] counter=176 i=0 t=2.1e-06 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=1 t=2.0e-06 per=4.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=176 i=2 t=8.8e-04 per=1.9e+01 cost=1.4e+07 flops=1.6e+10
 sigma[gemm] counter=176 i=3 t=1.2e-03 per=2.5e+01 cost=1.4e+07 flops=1.2e+10
 sigma[gemm] counter=176 i=4 t=9.9e-04 per=2.1e+01 cost=8.6e+06 flops=8.8e+09
 sigma[gemm] counter=176 i=5 t=1.0e-03 per=2.2e+01 cost=8.7e+06 flops=8.7e+09
 sigma[gemm] counter=176 total t=4.0e-03 per=8.7e+01 cost=4.5e+07 flops=1.1e+10
 sigma[red] counter=176 t=4.0e-04 per=8.8e+00 cost=2.6e+06 flops=6.5e+09
----- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=3.9e-01 t_reduction=5.4e-02 tot=4.7e-01 -----
 sigma_tot[inter] counter=176 t=2.3e-02 per=4.8e+00 cost=7.3e+08 flops=3.2e+10
 sigma_tot[gemm] counter=176 i=0 t=3.8e-04 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=1 t=3.5e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=176 i=2 t=9.4e-02 per=2.0e+01 cost=6.9e+08 flops=7.4e+09
 sigma_tot[gemm] counter=176 i=3 t=1.2e-01 per=2.5e+01 cost=6.8e+08 flops=5.8e+09
 sigma_tot[gemm] counter=176 i=4 t=8.9e-02 per=1.9e+01 cost=5.6e+08 flops=6.3e+09
 sigma_tot[gemm] counter=176 i=5 t=8.9e-02 per=1.9e+01 cost=5.7e+08 flops=6.4e+09
 sigma_tot[gemm] counter=176 total t=3.9e-01 per=8.4e+01 cost=2.5e+09 flops=6.4e+09
 sigma_tot[red] counter=176 t=5.4e-02 per=1.2e+01 cost=1.6e+08 flops=2.9e+09
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.3e-05,2.1e-06,8.4e-06,7.7e-07
    5   0 -    -116.543584315609 -1.783e-06  4.122e-04    3     5  2.729e-02 5.458e-03 5.353e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.079e-05,1.840e-04,3.721e-03,4.006e-04,4.382e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=2.473e-05 speed=1.226e+00GB/S T(nccl)=4.606e-05 speed=6.580e-01GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=3.7e-03 t_reduction=4.0e-04 tot=4.3e-03 -----
 sigma[inter] counter=177 t=1.8e-04 per=4.3e+00 cost=8.5e+06 flops=4.6e+10
 sigma[gemm] counter=177 i=0 t=2.1e-06 per=4.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=1 t=1.9e-06 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=177 i=2 t=8.0e-04 per=1.9e+01 cost=1.4e+07 flops=1.8e+10
 sigma[gemm] counter=177 i=3 t=1.1e-03 per=2.5e+01 cost=1.4e+07 flops=1.3e+10
 sigma[gemm] counter=177 i=4 t=9.1e-04 per=2.1e+01 cost=8.6e+06 flops=9.5e+09
 sigma[gemm] counter=177 i=5 t=9.2e-04 per=2.1e+01 cost=8.7e+06 flops=9.4e+09
 sigma[gemm] counter=177 total t=3.7e-03 per=8.6e+01 cost=4.5e+07 flops=1.2e+10
 sigma[red] counter=177 t=4.0e-04 per=9.3e+00 cost=2.6e+06 flops=6.6e+09
----- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=3.9e-01 t_reduction=5.5e-02 tot=4.7e-01 -----
 sigma_tot[inter] counter=177 t=2.3e-02 per=4.8e+00 cost=7.4e+08 flops=3.3e+10
 sigma_tot[gemm] counter=177 i=0 t=3.8e-04 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=1 t=3.5e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=177 i=2 t=9.4e-02 per=2.0e+01 cost=7.0e+08 flops=7.4e+09
 sigma_tot[gemm] counter=177 i=3 t=1.2e-01 per=2.5e+01 cost=6.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=177 i=4 t=9.0e-02 per=1.9e+01 cost=5.7e+08 flops=6.3e+09
 sigma_tot[gemm] counter=177 i=5 t=9.0e-02 per=1.9e+01 cost=5.8e+08 flops=6.4e+09
 sigma_tot[gemm] counter=177 total t=3.9e-01 per=8.4e+01 cost=2.5e+09 flops=6.5e+09
 sigma_tot[red] counter=177 t=5.5e-02 per=1.2e+01 cost=1.6e+08 flops=2.9e+09
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.8e-05,1.3e-05,2.1e-06,8.2e-06,7.6e-07
    6   0 -    -116.543584591525 -2.759e-07  1.711e-04    3     6  3.204e-02 5.341e-03 5.238e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.237e-05,1.825e-04,3.763e-03,3.984e-04,4.422e-03
 analyze_tgpu[Hx]: ndim=2034:1.515e-05GB T(cpu-gpu)=2.663e-05 speed=1.138e+00GB/S T(nccl)=4.574e-05 speed=6.627e-01GB/S
----- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=3.8e-03 t_reduction=4.0e-04 tot=4.3e-03 -----
 sigma[inter] counter=178 t=1.8e-04 per=4.2e+00 cost=8.5e+06 flops=4.7e+10
 sigma[gemm] counter=178 i=0 t=2.2e-06 per=5.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=1 t=2.1e-06 per=4.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=178 i=2 t=8.8e-04 per=2.0e+01 cost=1.4e+07 flops=1.6e+10
 sigma[gemm] counter=178 i=3 t=1.1e-03 per=2.4e+01 cost=1.4e+07 flops=1.3e+10
 sigma[gemm] counter=178 i=4 t=9.1e-04 per=2.1e+01 cost=8.6e+06 flops=9.5e+09
 sigma[gemm] counter=178 i=5 t=9.2e-04 per=2.1e+01 cost=8.7e+06 flops=9.5e+09
 sigma[gemm] counter=178 total t=3.8e-03 per=8.7e+01 cost=4.5e+07 flops=1.2e+10
 sigma[red] counter=178 t=4.0e-04 per=9.2e+00 cost=2.6e+06 flops=6.6e+09
----- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=4.0e-01 t_reduction=5.5e-02 tot=4.8e-01 -----
 sigma_tot[inter] counter=178 t=2.3e-02 per=4.8e+00 cost=7.5e+08 flops=3.3e+10
 sigma_tot[gemm] counter=178 i=0 t=3.8e-04 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=1 t=3.6e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=178 i=2 t=9.5e-02 per=2.0e+01 cost=7.2e+08 flops=7.5e+09
 sigma_tot[gemm] counter=178 i=3 t=1.2e-01 per=2.5e+01 cost=7.1e+08 flops=5.9e+09
 sigma_tot[gemm] counter=178 i=4 t=9.1e-02 per=1.9e+01 cost=5.8e+08 flops=6.3e+09
 sigma_tot[gemm] counter=178 i=5 t=9.1e-02 per=1.9e+01 cost=5.9e+08 flops=6.4e+09
 sigma_tot[gemm] counter=178 total t=4.0e-01 per=8.4e+01 cost=2.6e+09 flops=6.5e+09
 sigma_tot[red] counter=178 t=5.5e-02 per=1.2e+01 cost=1.6e+08 flops=3.0e+09
T(sub)=4.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.9e-05,1.3e-05,2.2e-06,8.2e-06,7.3e-07
    7   0 +    -116.543584635644 -4.412e-08  7.485e-05    3     7  3.688e-02 5.269e-03 5.169e-03
TIMING FOR Davidson : 3.690e-02  T(cal/comm/rest)=3.618e-02,3.989e-06,7.190e-04
decomposed t_rest=7.190e-04
 T(sub)    =3.154e-04 per=4.387e+01
 T(precond)=3.800e-05 per=5.285e+00
 T(ortho)  =5.136e-05 per=7.143e+00
 T(xcopy)  =4.701e-06 per=6.538e-01
 T(xnrm2)  =8.031e-06 per=1.117e+00
 T(other)  =3.015e-04 per=4.193e+01
optimized energies: isweep=0 ibond=25 dots=1 e[0]=-116.543584635644 nmvp=7
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=5.257e-03 change=4.163e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=18 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond25.txt
 qbond: qsuper nsym=18 dimAll=296
 (15,-3):43 (15,-1):35 (14,-2):31 (13,-1):10 (13,-3):10 (14,-4):18 (16,-2):45 (17,-1):20 (13,-5):1 (17,-3):20 (16,-4):22 (18,-2):6 (19,-1):1 (15,-5):8 (16,0):14 (14,0):10 (18,0):1 (14,-6):1
timing for divide=4.2e-06
timing for compute=3.1e-04
timing for collect=1.8e-05
----- TMING FOR decimation_genbasis(nkr): 3.3e-04 S T(divide/compute[cpu/gpu/rest]/collect)=4.2e-06,2.9e-04,0.0e+00,1.6e-05,1.8e-05 -----
decimation summary: 296->73 dwt=+3.331e-16 SvN=2.275e+00
 qbond: qkept nsym=12 dimAll=73
 (16,-2):14 (15,-1):10 (16,0):10 (14,-2):8 (15,-3):7 (14,0):6 (17,-1):5 (17,-3):4 (16,-4):4 (18,-2):3 (14,-4):1 (18,0):1
----- TIMING for decimation_row(nkr): 1.608e-03 S T(decim/select/formRot)=3.865e-04,1.192e-03,3.020e-05 -----
----- TIMING FOR onedot_decimation: 1.681e-03 S T(wf/decim)=4.849e-05,1.633e-03 -----
ctns::oper_renorm coord=(10,0) superblock=cr oplist=CSHAB ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHAB nops=C:20 S:10 H:1 A:95 B:105 
        dim(bra,ket)=73,73 size(op)=613:4.677e-03MB size(tot)=86546:6.603e-01MB:6.448e-04GB
        per(mem): C:9.16 S:4.68 H:0.708 A:26.6 B:58.9 
rank=0 CPUmem(GB): used=1.352e+00 pageheap_free=7.736e-03 change=5.213e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=221 : 2.615e-04 S -----
rank=0 GPUmem(GB): used=1.335e-03 (oper)=1.305e-03
rank=0 GPUmem(GB): used=1.351e-03 (oper,site)=1.305e-03,1.515e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=221
 no. of rintermediate operators=7
 no. of coefficients=257:1.961e-03MB:1.915e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.461e-05 S -----
rank=0 GPUmem(GB): used=1.352e-03 (oper,site,rinter)=1.305e-03,1.515e-05,1.915e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 1.158e-03 S size(rtasks)=221 size(Rlst2)=144 T(Rmu/Rlist)=1.552e-04,1.003e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.570e-03 S size(rtasks)=221 size(Rlst)=3486 -----
rank=0 GPUmem(GB): used=1.352e-03 avail=3.829e+01 total=3.829e+01 batch[need]=1.678e-02 blksize=210 blksize0=225 batchsize=3486
rank=0 GPUmem(GB): used=1.813e-02 (oper,site,rinter,batch)=1.305e-03,1.515e-05,1.915e-06,1.678e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.707e-04,1.911e-03,4.236e-04
----- TIMING FOR renorm : t_inter=1.7e-04 t_gemm=1.9e-03 t_reduction=4.2e-04 tot=2.5e-03 -----
 renorm[inter] counter=596 t=1.7e-04 per=6.8e+00 cost=1.3e+06 flops=7.4e+09
 renorm[gemm] counter=596 i=0 t=1.8e-06 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=596 i=1 t=1.6e-06 per=6.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=596 i=2 t=3.6e-04 per=1.5e+01 cost=5.8e+05 flops=1.6e+09
 renorm[gemm] counter=596 i=3 t=7.2e-04 per=2.9e+01 cost=4.9e+06 flops=6.8e+09
 renorm[gemm] counter=596 i=4 t=1.6e-06 per=6.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=596 i=5 t=1.6e-06 per=6.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=596 i=6 t=8.2e-04 per=3.3e+01 cost=4.3e+06 flops=5.3e+09
 renorm[gemm] counter=596 total t=1.9e-03 per=7.6e+01 cost=9.8e+06 flops=5.1e+09
 renorm[red] counter=596 t=4.2e-04 per=1.7e+01 cost=4.0e+05 flops=9.4e+08
----- TIMING FOR renorm_tot : t_inter=3.3e-03 t_gemm=2.6e-02 t_reduction=6.6e-03 tot=3.6e-02 -----
 renorm_tot[inter] counter=596 t=3.3e-03 per=9.2e+00 cost=2.0e+07 flops=5.9e+09
 renorm_tot[gemm] counter=596 i=0 t=5.5e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=596 i=1 t=4.9e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=596 i=2 t=2.2e-03 per=6.0e+00 cost=2.0e+06 flops=9.0e+08
 renorm_tot[gemm] counter=596 i=3 t=3.6e-03 per=9.8e+00 cost=1.3e+07 flops=3.6e+09
 renorm_tot[gemm] counter=596 i=4 t=4.6e-03 per=1.3e+01 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=596 i=5 t=6.5e-03 per=1.8e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=596 i=6 t=9.6e-03 per=2.6e+01 cost=6.0e+07 flops=6.2e+09
 renorm_tot[gemm] counter=596 total t=2.6e-02 per=7.3e+01 cost=1.1e+08 flops=4.1e+09
 renorm_tot[red] counter=596 t=6.6e-03 per=1.8e+01 cost=6.9e+06 flops=1.0e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.371e-03 (oper)=1.308e-03
rank=0 GPUmem(GB): used=1.386e-03 (oper,site,rinter)=1.308e-03,1.515e-05,3.062e-05
rank=0 GPUmem(GB): used=1.839e-03 (oper,site,rinter,batch)=1.308e-03,1.515e-05,3.062e-05,4.524e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.933e-02 S T(preprocess/alloc/comp/red/dealloc)=2.398e-03,2.487e-03,1.444e-02,2.201e-03,1.619e-04 -----
----- TIMING FOR oper_renorm_opS : 1.939e-02 S rank=0 -----
----- TIMING FOR oper_renorm : 2.683e-02 S rank=0 -----
rank=0 CPUmem(GB): used=1.353e+00 pageheap_free=8.461e-03 change=8.720e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=9.865e-03 change=-3.216e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::oper_ab2pq coord=(10,0) superblock=cr alg_renorm=19 alg_a2p=3 alg_b2q=3 ifab2pq_gpunccl=1
 qops2: oplist=CSHPQ nops=C:20 S:10 H:1 P:95 Q:105 
        dim(bra,ket)=73,73 size(op)=613:4.677e-03MB size(tot)=86515:6.601e-01MB:6.446e-04GB
        per(mem): C:9.17 S:4.68 H:0.709 P:26.5 Q:58.9 
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=9.865e-03 change=5.198e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=9.865e-03 change=1.207e-06 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after qops2.allocate_gpu
rank=0 GPUmem(GB): used=1.320e-03 avail=3.829e+01 after qops2.allocate_gpu
ctns::oper_a2p ifab=1 ifkr=0 maxsize=22988:1.713e-04GB
iproc=0
 qops_tmp: oplist=M nops=M:95 
        dim(bra,ket)=73,73 size(op)=306:2.335e-03MB size(tot)=22988:1.754e-01MB:1.713e-04GB
        per(mem): M:100 
   init qops_tmp: dt=0.000191 tinit=0.000191
   from opA to opA.H(): dt=0.000196 tadjt=0.000196
   bcast: size(opM)=22988:0.000171GB dt=3.39e-05 speed=5.05GB/s tcomm=3.39e-05
   compute opP from opA: dt=0.000141 tcomp=0.000141
iproc=1
 qops_tmp: oplist=M nops=M:95 
        dim(bra,ket)=73,73 size(op)=306:0.00233MB size(tot)=22957:0.175MB:0.000171GB
        per(mem): M:100 
   init qops_tmp: dt=0.000153 tinit=0.000353
   from opA to opA.H(): dt=0.000198 tadjt=0.000198
   bcast: size(opM)=22957:0.000171GB dt=2.88e-05 speed=5.94GB/s tcomm=0.000307
   compute opP from opA: dt=0.000114 tcomp=0.000323
----- TIMING FOR oper_a2pGPU : 0.0013 S T(init/adjt+bcast/comp/rest)=0.000347,0.000573,0.000254,0.000131 -----
ctns::oper_b2q ifab=1 ifkr=0 maxsize=50965:0.00038GB
iproc=0
 qops_tmp: oplist=B nops=B:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=50965:0.389MB:0.00038GB
        per(mem): B:100 
   init qops_tmp: dt=0.000168 tinit=0.000168
   copy opB to qops_tmps: dt=4.75e-06 tcopy=4.75e-06
   bcast: size(opB)=50965:0.00038GB dt=2.95e-05 speed=12.9GB/s tcomm=2.95e-05
   compute opQ from opB: dt=0.000198 tcomp=0.000198
iproc=0
 qops_tmp: oplist=N nops=N:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=50965:0.389MB:0.00038GB
        per(mem): N:100 
   init qops_tmp: dt=0.000165 tinit=0.000334
   from opB to opB.H(): dt=0.00027 tadjt=0.00027
   bcast: size(opN)=50965:0.00038GB dt=3.13e-05 speed=12.1GB/s tcomm=6.08e-05
   compute opQ from opB.H(): dt=0.000145 tcomp=0.000343
iproc=1
 qops_tmp: oplist=B nops=B:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=50965:0.389MB:0.00038GB
        per(mem): B:100 
   init qops_tmp: dt=0.000165 tinit=0.000498
   copy opB to qops_tmps: dt=4.95e-06 tcopy=4.97e-06
   bcast: size(opB)=50965:0.00038GB dt=2.72e-05 speed=14GB/s tcomm=0.000503
   compute opQ from opB: dt=0.00014 tcomp=0.00044
iproc=1
 qops_tmp: oplist=N nops=N:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=50965:0.389MB:0.00038GB
        per(mem): N:100 
   init qops_tmp: dt=0.000161 tinit=0.000659
   from opB to opB.H(): dt=0.000266 tadjt=0.000266
   bcast: size(opN)=50965:0.00038GB dt=2.91e-05 speed=13.1GB/s tcomm=0.000532
   compute opQ from opB.H(): dt=0.000139 tcomp=0.000579
----- TIMING FOR oper_b2qGPU : 0.00221 S T(init/copy/adjt+bcast/comp/rest)=0.000672,4.78e-06,0.000725,0.000616,0.000192 -----
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=9.865e-03 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 before qops2.to_cpu
rank=0 GPUmem(GB): used=1.320e-03 avail=3.829e+01 before qops2.to_cpu
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=9.216e-03 change=6.485e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after qops2.to_cpu
rank=0 GPUmem(GB): used=1.320e-03 avail=3.829e+01 after qops2.to_cpu
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=9.216e-03 change=-5.960e-08 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 before move
rank=0 GPUmem(GB): used=1.320e-03 avail=3.829e+01 before move
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=9.216e-03 change=-5.222e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after move
rank=0 GPUmem(GB): used=6.752e-04 avail=3.829e+01 after move
----- TIMING FOR oper_ab2pq : 5.235e-03 S T(init/copyCSH/opP/opQ/to_gpu/to_cpu/move)=8.653e-04,1.498e-05,1.317e-03,2.226e-03,0.000e+00,5.062e-04,3.053e-04 -----
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=9.216e-03 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=9.216e-03 change=-1.822e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 9.559e-02 S #####
 T(local opt: fetch) = 3.742e-03 S  per = 3.91  per(accum) = 3.91
 T(local opt: hdiag) = 1.694e-03 S  per = 1.77  per(accum) = 5.69
 T(local opt: dvdsn) = 5.283e-02 S  per = 55.3  per(accum) = 61
 T(local opt: decim) = 1.763e-03 S  per = 1.84  per(accum) = 62.8
 T(local opt: guess) = 9.374e-05 S  per = 0.0981  per(accum) = 62.9
 T(local opt: renrm) = 3.297e-02 S  per = 34.5  per(accum) = 97.4
 T(local opt: save ) = 2.491e-03 S  per = 2.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.283e-02 S  T(sum) = 5.200e-02 S  per = 9.842e+01
 T(local opt: preprocess                  ) = 7.263e-05 S  per = 0.14  per(accum) = 0.14
 T(local opt: symbolic_formulae           ) = 1.471e-03 S  per = 2.83  per(accum) = 2.97
 T(local opt: hintermediate init          ) = 7.644e-05 S  per = 0.147  per(accum) = 3.12
 T(local opt: preprocess_hformulae_Hxlist ) = 6.783e-03 S  per =   13  per(accum) = 16.2
 T(local opt: hmmtasks init               ) = 6.682e-03 S  per = 12.9  per(accum) = 29
 T(local opt: initial guess for dvdson    ) = 1.047e-05 S  per = 0.0201  per(accum) = 29
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.564e-02 S  per = 68.5  per(accum) = 97.6
 T(local opt: dvdson [cpu-gpu]            ) = 1.942e-04 S  per = 0.374  per(accum) = 98
 T(local opt: dvdson [nccl]               ) = 3.416e-04 S  per = 0.657  per(accum) = 98.6
 T(local opt: dvdson [mpi]                ) = 3.989e-06 S  per = 0.00767  per(accum) = 98.6
 T(local opt: dvdson [rest part(linalg)]  ) = 7.190e-04 S  per = 1.38  per(accum) = 100
Detailed decomposition of T(renrm) = 3.297e-02 S  T(sum) = 3.297e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.909e-05 S  per = 0.21  per(accum) = 0.21
 T(local opt: qops init                    ) = 1.017e-03 S  per = 3.09  per(accum) = 3.3
 T(local opt: symbolic_formulae_renorm     ) = 2.732e-04 S  per = 0.829  per(accum) = 4.12
 T(local opt: allocate qops on gpu         ) = 6.491e-05 S  per = 0.197  per(accum) = 4.32
 T(local opt: site memcpy cpu2gpu          ) = 3.104e-05 S  per = 0.0941  per(accum) = 4.42
 T(local opt: rintermediate init           ) = 6.329e-05 S  per = 0.192  per(accum) = 4.61
 T(local opt: preprocess_formulae_Rlist2   ) = 1.604e-03 S  per = 4.87  per(accum) = 9.47
 T(local opt: rmmtasks init                ) = 1.383e-03 S  per = 4.19  per(accum) = 13.7
 T(local opt: qops memset on cpu           ) = 1.020e-07 S  per = 0.000309  per(accum) = 13.7
 T(local opt: preprocess_renorm_batchGPU   ) = 2.735e-03 S  per =  8.3  per(accum) = 22
 T(local opt: deallocate cpu and gpu memory) = 2.122e-04 S  per = 0.644  per(accum) = 22.6
 T(local opt: construct opS [ifdists=true] ) = 1.943e-02 S  per = 58.9  per(accum) = 81.5
 T(local opt: reduction of opS & opH [nccl]) = 2.219e-05 S  per = 0.0673  per(accum) = 81.6
 T(local opt: qops memcpy gpu2cpu          ) = 3.000e-08 S  per = 9.1e-05  per(accum) = 81.6
 T(local opt: reduction of opS & opH [mpi] ) = 4.400e-08 S  per = 0.000133  per(accum) = 81.6
 T(local opt: qops_pool join and erase     ) = 7.146e-04 S  per = 2.17  per(accum) = 83.8
 T(local opt: conversion from opAB to opPQ ) = 5.352e-03 S  per = 16.2  per(accum) = 100
ctns::rcanon_save_site idx=9 scratch=./scratch/sweep size=2034:1.5e-05GB T(load)=0.00066S speed=0.023GB/S
##### sweep opt: 1.415e+00 S #####
 T(sweep opt: fetch) = 8.617e-02 S  per = 6.09  per(accum) = 6.09
 T(sweep opt: hdiag) = 2.170e-02 S  per = 1.53  per(accum) = 7.63
 T(sweep opt: dvdsn) = 7.126e-01 S  per = 50.4  per(accum) = 58
 T(sweep opt: decim) = 3.048e-02 S  per = 2.15  per(accum) = 60.2
 T(sweep opt: guess) = 1.416e-03 S  per =  0.1  per(accum) = 60.3
 T(sweep opt: renrm) = 5.087e-01 S  per =   36  per(accum) = 96.2
 T(sweep opt: save ) = 5.362e-02 S  per = 3.79  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.126e-01 S  T(sum) = 6.991e-01 S  per = 9.810e+01
 T(sweep opt: preprocess                  ) = 1.757e-03 S  per = 0.251  per(accum) = 0.251
 T(sweep opt: symbolic_formulae           ) = 2.114e-02 S  per = 3.02  per(accum) = 3.28
 T(sweep opt: hintermediate init          ) = 1.555e-03 S  per = 0.222  per(accum) = 3.5
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.868e-02 S  per = 9.82  per(accum) = 13.3
 T(sweep opt: hmmtasks init               ) = 7.020e-02 S  per =   10  per(accum) = 23.4
 T(sweep opt: initial guess for dvdson    ) = 1.556e-04 S  per = 0.0223  per(accum) = 23.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.091e-01 S  per = 72.8  per(accum) = 96.2
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.348e-03 S  per = 0.622  per(accum) = 96.8
 T(sweep opt: dvdson [nccl]               ) = 9.438e-03 S  per = 1.35  per(accum) = 98.2
 T(sweep opt: dvdson [mpi]                ) = 7.897e-05 S  per = 0.0113  per(accum) = 98.2
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.264e-02 S  per = 1.81  per(accum) = 100
Detailed decomposition of T(renrm) = 5.087e-01 S  T(sum) = 5.087e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.474e-03 S  per = 0.29  per(accum) = 0.29
 T(sweep opt: qops init                    ) = 1.253e-02 S  per = 2.46  per(accum) = 2.75
 T(sweep opt: symbolic_formulae_renorm     ) = 9.904e-03 S  per = 1.95  per(accum) = 4.7
 T(sweep opt: allocate qops on gpu         ) = 1.823e-03 S  per = 0.358  per(accum) = 5.06
 T(sweep opt: site memcpy cpu2gpu          ) = 6.174e-04 S  per = 0.121  per(accum) = 5.18
 T(sweep opt: rintermediate init           ) = 1.238e-03 S  per = 0.243  per(accum) = 5.42
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.087e-02 S  per =  4.1  per(accum) = 9.52
 T(sweep opt: rmmtasks init                ) = 2.386e-02 S  per = 4.69  per(accum) = 14.2
 T(sweep opt: qops memset on cpu           ) = 1.233e-06 S  per = 0.000242  per(accum) = 14.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.009e-02 S  per = 7.88  per(accum) = 22.1
 T(sweep opt: deallocate cpu and gpu memory) = 3.599e-03 S  per = 0.707  per(accum) = 22.8
 T(sweep opt: construct opS [ifdists=true] ) = 3.587e-01 S  per = 70.5  per(accum) = 93.3
 T(sweep opt: reduction of opS & opH [nccl]) = 6.548e-04 S  per = 0.129  per(accum) = 93.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.528e-03 S  per = 0.694  per(accum) = 94.1
 T(sweep opt: reduction of opS & opH [mpi] ) = 7.487e-04 S  per = 0.147  per(accum) = 94.3
 T(sweep opt: qops_pool join and erase     ) = 1.683e-02 S  per = 3.31  per(accum) = 97.6
 T(sweep opt: conversion from opAB to opPQ ) = 1.219e-02 S  per =  2.4  per(accum) = 100
##### global opt: 1.415e+00 S #####
 T(global opt: fetch) = 8.617e-02 S  per = 6.09  per(accum) = 6.09
 T(global opt: hdiag) = 2.170e-02 S  per = 1.53  per(accum) = 7.63
 T(global opt: dvdsn) = 7.126e-01 S  per = 50.4  per(accum) = 58
 T(global opt: decim) = 3.048e-02 S  per = 2.15  per(accum) = 60.2
 T(global opt: guess) = 1.416e-03 S  per =  0.1  per(accum) = 60.3
 T(global opt: renrm) = 5.087e-01 S  per =   36  per(accum) = 96.2
 T(global opt: save ) = 5.362e-02 S  per = 3.79  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.126e-01 S  T(sum) = 6.991e-01 S  per = 9.810e+01
 T(global opt: preprocess                  ) = 1.757e-03 S  per = 0.251  per(accum) = 0.251
 T(global opt: symbolic_formulae           ) = 2.114e-02 S  per = 3.02  per(accum) = 3.28
 T(global opt: hintermediate init          ) = 1.555e-03 S  per = 0.222  per(accum) = 3.5
 T(global opt: preprocess_hformulae_Hxlist ) = 6.868e-02 S  per = 9.82  per(accum) = 13.3
 T(global opt: hmmtasks init               ) = 7.020e-02 S  per =   10  per(accum) = 23.4
 T(global opt: initial guess for dvdson    ) = 1.556e-04 S  per = 0.0223  per(accum) = 23.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.091e-01 S  per = 72.8  per(accum) = 96.2
 T(global opt: dvdson [cpu-gpu]            ) = 4.348e-03 S  per = 0.622  per(accum) = 96.8
 T(global opt: dvdson [nccl]               ) = 9.438e-03 S  per = 1.35  per(accum) = 98.2
 T(global opt: dvdson [mpi]                ) = 7.897e-05 S  per = 0.0113  per(accum) = 98.2
 T(global opt: dvdson [rest part(linalg)]  ) = 1.264e-02 S  per = 1.81  per(accum) = 100
Detailed decomposition of T(renrm) = 5.087e-01 S  T(sum) = 5.087e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.474e-03 S  per = 0.29  per(accum) = 0.29
 T(global opt: qops init                    ) = 1.253e-02 S  per = 2.46  per(accum) = 2.75
 T(global opt: symbolic_formulae_renorm     ) = 9.904e-03 S  per = 1.95  per(accum) = 4.7
 T(global opt: allocate qops on gpu         ) = 1.823e-03 S  per = 0.358  per(accum) = 5.06
 T(global opt: site memcpy cpu2gpu          ) = 6.174e-04 S  per = 0.121  per(accum) = 5.18
 T(global opt: rintermediate init           ) = 1.238e-03 S  per = 0.243  per(accum) = 5.42
 T(global opt: preprocess_formulae_Rlist2   ) = 2.087e-02 S  per =  4.1  per(accum) = 9.52
 T(global opt: rmmtasks init                ) = 2.386e-02 S  per = 4.69  per(accum) = 14.2
 T(global opt: qops memset on cpu           ) = 1.233e-06 S  per = 0.000242  per(accum) = 14.2
 T(global opt: preprocess_renorm_batchGPU   ) = 4.009e-02 S  per = 7.88  per(accum) = 22.1
 T(global opt: deallocate cpu and gpu memory) = 3.599e-03 S  per = 0.707  per(accum) = 22.8
 T(global opt: construct opS [ifdists=true] ) = 3.587e-01 S  per = 70.5  per(accum) = 93.3
 T(global opt: reduction of opS & opH [nccl]) = 6.548e-04 S  per = 0.129  per(accum) = 93.5
 T(global opt: qops memcpy gpu2cpu          ) = 3.528e-03 S  per = 0.694  per(accum) = 94.1
 T(global opt: reduction of opS & opH [mpi] ) = 7.487e-04 S  per = 0.147  per(accum) = 94.3
 T(global opt: qops_pool join and erase     ) = 1.683e-02 S  per = 3.31  per(accum) = 97.6
 T(global opt: conversion from opAB to opPQ ) = 1.219e-02 S  per =  2.4  per(accum) = 100
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-4.172e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=26/seqsize=34 dots=1 dbond=(8,0)-(9,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=11 scratch=./scratch/sweep size=1232:9.18e-06GB T(load)=2.95e-04S speed=3.11e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=2815:2.15e-02MB:2.10e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1583:1.21e-02MB:1.18e-05GB
total mem of comb=4546:3.47e-02MB:3.39e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.702e-05 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=9,10,1
 suppl= 0 1 2 3 4 16 17 18 19
 suppr= 6 7 8 9 10 11 12 13 14 15
 suppc= 5
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(8,0)
 fqop[1]=./scratch/sweep/rop(10,0)
 fqop[2]=./scratch/sweep/cop(9,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:18 S:11 H:1 A:76 B:86 
        dim(bra,ket)=65,65 size(op)=447:3.410e-03MB size(tot)=54361:4.147e-01MB:4.050e-04GB
        per(mem): C:10.5 S:6.5 H:0.822 A:26.3 B:55.9 
 rqops: oplist=CSHPQ nops=C:20 S:10 H:1 P:95 Q:105 
        dim(bra,ket)=73,73 size(op)=613:0.00468MB size(tot)=86515:0.66MB:0.000645GB
        per(mem): C:9.17 S:4.68 H:0.709 P:26.5 Q:58.9 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=143212:1.09MB:0.00107GB
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=0.000e+00 change=1.802e-03 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(9,0) fdel=./scratch/sweep/lop(8,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=4.120e-04 change=-4.116e-04 heap=1.392e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(65,73,4) nnz=1583:1.208e-02MB
qtensor3: wf3 own=1 _data=0x55b2c5115400
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=13 dimAll=65
 (13,1):12 (14,0):8 (14,2):7 (13,-1):7 (12,0):6 (15,1):6 (12,2):5 (11,1):4 (13,3):4 (15,-1):3 (11,3):1 (11,-1):1 (15,3):1
 qbond: qcol nsym=12 dimAll=73
 (16,-2):14 (15,-1):10 (16,0):10 (14,-2):8 (15,-3):7 (14,0):6 (17,-1):5 (17,-3):4 (16,-4):4 (18,-2):3 (14,-4):1 (18,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=36 nblocks=624 size=1583:1.208e-02MB
### DIAG TIMING: total=1.805e-03 t1=2.225e-05, t2=1.601e-05, t3=1.289e-05, t4=1.692e-03, t5=1.266e-05, t6=4.095e-05, t7=8.827e-06
duration_diagGPU:1.823e-03
duration_diagreduce:4.500e-08
duration_diagtransform:2.115e-06
----- TIMING FOR symbolic_formulae_onedot with size=819 : 1.504e-03 S -----
rank=0 GPUmem(GB): used=1.067e-03 (oper)=1.067e-03
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=819
 no. of hintermediate operators=414
 no. of coefficients=4140:3.159e-02MB:3.085e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 8.852e-05 S -----
rank=0 GPUmem(GB): used=1.098e-03 (oper,hinter)=1.067e-03,3.085e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 6.768e-03 S size(H_formulae)=819 size(Hxlst2)=36 T(Hmu/Hxlist)=4.188e-04,6.349e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 8.890e-03 S size(H_formulae)=819 size(Hxlst)=22412 -----
rank=0 GPUmem(GB): used=1.098e-03 avail=3.829e+01 total=3.829e+01 dvdson[need]=2.359e-05 batch[need]=7.965e-02 blksize=168 blksize0=140 batchsize=22412
rank=0 GPUmem(GB): used=8.077e-02 (oper,hinter,dvdson,batch)=1.067e-03,3.085e-05,2.359e-05,7.965e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=1583 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.014e-04,2.468e-04,3.975e-03,4.308e-04,4.776e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=4.232e-05 speed=5.574e-01GB/S T(nccl)=5.912e-05 speed=3.990e-01GB/S
----- TIMING FOR sigma : t_inter=2.5e-04 t_gemm=4.0e-03 t_reduction=4.3e-04 tot=4.7e-03 -----
 sigma[inter] counter=179 t=2.5e-04 per=5.3e+00 cost=1.1e+07 flops=4.6e+10
 sigma[gemm] counter=179 i=0 t=2.0e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=1 t=1.6e-06 per=3.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=179 i=2 t=9.7e-04 per=2.1e+01 cost=7.3e+06 flops=7.5e+09
 sigma[gemm] counter=179 i=3 t=1.2e-03 per=2.5e+01 cost=7.4e+06 flops=6.4e+09
 sigma[gemm] counter=179 i=4 t=9.2e-04 per=2.0e+01 cost=7.3e+06 flops=7.9e+09
 sigma[gemm] counter=179 i=5 t=9.2e-04 per=2.0e+01 cost=7.6e+06 flops=8.2e+09
 sigma[gemm] counter=179 total t=4.0e-03 per=8.5e+01 cost=3.0e+07 flops=7.4e+09
 sigma[red] counter=179 t=4.3e-04 per=9.3e+00 cost=2.2e+06 flops=5.1e+09
----- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=4.0e-01 t_reduction=5.6e-02 tot=4.8e-01 -----
 sigma_tot[inter] counter=179 t=2.3e-02 per=4.8e+00 cost=7.6e+08 flops=3.3e+10
 sigma_tot[gemm] counter=179 i=0 t=3.8e-04 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=1 t=3.6e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=179 i=2 t=9.6e-02 per=2.0e+01 cost=7.2e+08 flops=7.5e+09
 sigma_tot[gemm] counter=179 i=3 t=1.2e-01 per=2.5e+01 cost=7.1e+08 flops=5.9e+09
 sigma_tot[gemm] counter=179 i=4 t=9.2e-02 per=1.9e+01 cost=5.8e+08 flops=6.4e+09
 sigma_tot[gemm] counter=179 i=5 t=9.2e-02 per=1.9e+01 cost=5.9e+08 flops=6.5e+09
 sigma_tot[gemm] counter=179 total t=4.0e-01 per=8.4e+01 cost=2.6e+09 flops=6.5e+09
 sigma_tot[red] counter=179 t=5.6e-02 per=1.2e+01 cost=1.7e+08 flops=3.0e+09
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.0e-05,6.0e-06,1.1e-06,1.4e-05,6.2e-07
settings: ndim=1583 neig=1 maxcycle=30 nbuff=4 memory=0.0002GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.543584635644 -1.117e+03  2.706e-02    1     1  5.118e-03 5.118e-03 5.051e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.958e-05,2.147e-04,4.925e-03,4.306e-04,5.657e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=3.266e-05 speed=7.224e-01GB/S T(nccl)=4.692e-05 speed=5.027e-01GB/S
----- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=4.9e-03 t_reduction=4.3e-04 tot=5.6e-03 -----
 sigma[inter] counter=180 t=2.1e-04 per=3.9e+00 cost=1.1e+07 flops=5.2e+10
 sigma[gemm] counter=180 i=0 t=2.1e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=1 t=2.3e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=180 i=2 t=1.2e-03 per=2.2e+01 cost=7.3e+06 flops=6.1e+09
 sigma[gemm] counter=180 i=3 t=1.5e-03 per=2.7e+01 cost=7.4e+06 flops=4.9e+09
 sigma[gemm] counter=180 i=4 t=1.1e-03 per=2.0e+01 cost=7.3e+06 flops=6.6e+09
 sigma[gemm] counter=180 i=5 t=1.1e-03 per=2.0e+01 cost=7.6e+06 flops=6.8e+09
 sigma[gemm] counter=180 total t=4.9e-03 per=8.8e+01 cost=3.0e+07 flops=6.0e+09
 sigma[red] counter=180 t=4.3e-04 per=7.7e+00 cost=2.2e+06 flops=5.1e+09
----- TIMING FOR sigma_tot : t_inter=2.3e-02 t_gemm=4.1e-01 t_reduction=5.6e-02 tot=4.9e-01 -----
 sigma_tot[inter] counter=180 t=2.3e-02 per=4.8e+00 cost=7.7e+08 flops=3.3e+10
 sigma_tot[gemm] counter=180 i=0 t=3.8e-04 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=1 t=3.6e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=180 i=2 t=9.8e-02 per=2.0e+01 cost=7.3e+08 flops=7.5e+09
 sigma_tot[gemm] counter=180 i=3 t=1.2e-01 per=2.5e+01 cost=7.2e+08 flops=5.9e+09
 sigma_tot[gemm] counter=180 i=4 t=9.3e-02 per=1.9e+01 cost=5.9e+08 flops=6.4e+09
 sigma_tot[gemm] counter=180 i=5 t=9.3e-02 per=1.9e+01 cost=6.0e+08 flops=6.5e+09
 sigma_tot[gemm] counter=180 total t=4.1e-01 per=8.4e+01 cost=2.6e+09 flops=6.5e+09
 sigma_tot[red] counter=180 t=5.6e-02 per=1.2e+01 cost=1.7e+08 flops=3.0e+09
T(sub)=5.5e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,2.0e-05,3.0e-06,1.1e-05,6.3e-07
    2   0 -    -116.544382358972 -7.977e-04  5.789e-03    2     2  1.132e-02 5.659e-03 5.546e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.797e-05,2.168e-04,4.892e-03,4.329e-04,5.627e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=3.150e-05 speed=7.489e-01GB/S T(nccl)=4.648e-05 speed=5.076e-01GB/S
----- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=4.9e-03 t_reduction=4.3e-04 tot=5.5e-03 -----
 sigma[inter] counter=181 t=2.2e-04 per=3.9e+00 cost=1.1e+07 flops=5.2e+10
 sigma[gemm] counter=181 i=0 t=2.0e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=1 t=2.0e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=181 i=2 t=1.2e-03 per=2.2e+01 cost=7.3e+06 flops=6.2e+09
 sigma[gemm] counter=181 i=3 t=1.5e-03 per=2.7e+01 cost=7.4e+06 flops=5.0e+09
 sigma[gemm] counter=181 i=4 t=1.1e-03 per=2.0e+01 cost=7.3e+06 flops=6.6e+09
 sigma[gemm] counter=181 i=5 t=1.1e-03 per=2.0e+01 cost=7.6e+06 flops=6.9e+09
 sigma[gemm] counter=181 total t=4.9e-03 per=8.8e+01 cost=3.0e+07 flops=6.1e+09
 sigma[red] counter=181 t=4.3e-04 per=7.8e+00 cost=2.2e+06 flops=5.1e+09
----- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=4.1e-01 t_reduction=5.7e-02 tot=4.9e-01 -----
 sigma_tot[inter] counter=181 t=2.4e-02 per=4.8e+00 cost=7.8e+08 flops=3.3e+10
 sigma_tot[gemm] counter=181 i=0 t=3.9e-04 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=1 t=3.6e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=181 i=2 t=9.9e-02 per=2.0e+01 cost=7.4e+08 flops=7.5e+09
 sigma_tot[gemm] counter=181 i=3 t=1.2e-01 per=2.5e+01 cost=7.3e+08 flops=5.9e+09
 sigma_tot[gemm] counter=181 i=4 t=9.4e-02 per=1.9e+01 cost=6.0e+08 flops=6.4e+09
 sigma_tot[gemm] counter=181 i=5 t=9.4e-02 per=1.9e+01 cost=6.1e+08 flops=6.5e+09
 sigma_tot[gemm] counter=181 total t=4.1e-01 per=8.4e+01 cost=2.7e+09 flops=6.5e+09
 sigma_tot[red] counter=181 t=5.7e-02 per=1.2e+01 cost=1.7e+08 flops=3.0e+09
T(sub)=4.9e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.9e-05,1.8e-06,1.2e-05,6.0e-07
    3   0 -    -116.544433265713 -5.091e-05  2.136e-03    3     3  1.723e-02 5.745e-03 5.641e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.872e-05,2.205e-04,4.878e-03,4.340e-04,5.608e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=2.309e-05 speed=1.022e+00GB/S T(nccl)=4.563e-05 speed=5.170e-01GB/S
----- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=4.9e-03 t_reduction=4.3e-04 tot=5.5e-03 -----
 sigma[inter] counter=182 t=2.2e-04 per=4.0e+00 cost=1.1e+07 flops=5.1e+10
 sigma[gemm] counter=182 i=0 t=2.1e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=1 t=2.0e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=182 i=2 t=1.2e-03 per=2.2e+01 cost=7.3e+06 flops=6.2e+09
 sigma[gemm] counter=182 i=3 t=1.5e-03 per=2.7e+01 cost=7.4e+06 flops=5.0e+09
 sigma[gemm] counter=182 i=4 t=1.1e-03 per=2.0e+01 cost=7.3e+06 flops=6.6e+09
 sigma[gemm] counter=182 i=5 t=1.1e-03 per=2.0e+01 cost=7.6e+06 flops=6.9e+09
 sigma[gemm] counter=182 total t=4.9e-03 per=8.8e+01 cost=3.0e+07 flops=6.1e+09
 sigma[red] counter=182 t=4.3e-04 per=7.8e+00 cost=2.2e+06 flops=5.1e+09
----- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=4.2e-01 t_reduction=5.7e-02 tot=5.0e-01 -----
 sigma_tot[inter] counter=182 t=2.4e-02 per=4.8e+00 cost=7.9e+08 flops=3.3e+10
 sigma_tot[gemm] counter=182 i=0 t=3.9e-04 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=1 t=3.6e-04 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=182 i=2 t=1.0e-01 per=2.0e+01 cost=7.5e+08 flops=7.5e+09
 sigma_tot[gemm] counter=182 i=3 t=1.2e-01 per=2.5e+01 cost=7.4e+08 flops=5.9e+09
 sigma_tot[gemm] counter=182 i=4 t=9.5e-02 per=1.9e+01 cost=6.1e+08 flops=6.4e+09
 sigma_tot[gemm] counter=182 i=5 t=9.5e-02 per=1.9e+01 cost=6.2e+08 flops=6.5e+09
 sigma_tot[gemm] counter=182 total t=4.2e-01 per=8.4e+01 cost=2.7e+09 flops=6.5e+09
 sigma_tot[red] counter=182 t=5.7e-02 per=1.1e+01 cost=1.7e+08 flops=3.0e+09
T(sub)=5.2e-05 T(gemm/eig/ortho/gemm/axpy)=2.5e-05,1.4e-05,2.6e-06,8.9e-06,9.6e-07
    4   0 -    -116.544441010307 -7.745e-06  9.325e-04    3     4  2.299e-02 5.748e-03 5.649e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.771e-05,2.204e-04,4.940e-03,4.196e-04,5.654e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=2.278e-05 speed=1.035e+00GB/S T(nccl)=4.493e-05 speed=5.251e-01GB/S
----- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=4.9e-03 t_reduction=4.2e-04 tot=5.6e-03 -----
 sigma[inter] counter=183 t=2.2e-04 per=3.9e+00 cost=1.1e+07 flops=5.1e+10
 sigma[gemm] counter=183 i=0 t=2.4e-06 per=4.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=1 t=2.0e-06 per=3.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=183 i=2 t=1.2e-03 per=2.2e+01 cost=7.3e+06 flops=5.9e+09
 sigma[gemm] counter=183 i=3 t=1.5e-03 per=2.7e+01 cost=7.4e+06 flops=5.0e+09
 sigma[gemm] counter=183 i=4 t=1.1e-03 per=2.0e+01 cost=7.3e+06 flops=6.6e+09
 sigma[gemm] counter=183 i=5 t=1.1e-03 per=2.0e+01 cost=7.6e+06 flops=6.8e+09
 sigma[gemm] counter=183 total t=4.9e-03 per=8.9e+01 cost=3.0e+07 flops=6.0e+09
 sigma[red] counter=183 t=4.2e-04 per=7.5e+00 cost=2.2e+06 flops=5.3e+09
----- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=4.2e-01 t_reduction=5.7e-02 tot=5.0e-01 -----
 sigma_tot[inter] counter=183 t=2.4e-02 per=4.8e+00 cost=8.0e+08 flops=3.3e+10
 sigma_tot[gemm] counter=183 i=0 t=3.9e-04 per=7.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=1 t=3.7e-04 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=183 i=2 t=1.0e-01 per=2.0e+01 cost=7.5e+08 flops=7.5e+09
 sigma_tot[gemm] counter=183 i=3 t=1.3e-01 per=2.5e+01 cost=7.4e+08 flops=5.9e+09
 sigma_tot[gemm] counter=183 i=4 t=9.6e-02 per=1.9e+01 cost=6.1e+08 flops=6.4e+09
 sigma_tot[gemm] counter=183 i=5 t=9.6e-02 per=1.9e+01 cost=6.2e+08 flops=6.5e+09
 sigma_tot[gemm] counter=183 total t=4.2e-01 per=8.4e+01 cost=2.7e+09 flops=6.5e+09
 sigma_tot[red] counter=183 t=5.7e-02 per=1.1e+01 cost=1.7e+08 flops=3.0e+09
T(sub)=3.7e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.2e-05,1.9e-06,6.6e-06,5.9e-07
    5   0 -    -116.544442264683 -1.254e-06  3.694e-04    3     5  2.878e-02 5.757e-03 5.664e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.743e-05,2.085e-04,4.877e-03,4.399e-04,5.599e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=2.281e-05 speed=1.034e+00GB/S T(nccl)=4.462e-05 speed=5.287e-01GB/S
----- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=4.9e-03 t_reduction=4.4e-04 tot=5.5e-03 -----
 sigma[inter] counter=184 t=2.1e-04 per=3.8e+00 cost=1.1e+07 flops=5.4e+10
 sigma[gemm] counter=184 i=0 t=2.3e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=1 t=2.0e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=184 i=2 t=1.2e-03 per=2.2e+01 cost=7.3e+06 flops=6.2e+09
 sigma[gemm] counter=184 i=3 t=1.5e-03 per=2.7e+01 cost=7.4e+06 flops=5.0e+09
 sigma[gemm] counter=184 i=4 t=1.1e-03 per=2.0e+01 cost=7.3e+06 flops=6.6e+09
 sigma[gemm] counter=184 i=5 t=1.1e-03 per=2.0e+01 cost=7.6e+06 flops=6.9e+09
 sigma[gemm] counter=184 total t=4.9e-03 per=8.8e+01 cost=3.0e+07 flops=6.1e+09
 sigma[red] counter=184 t=4.4e-04 per=8.0e+00 cost=2.2e+06 flops=5.0e+09
----- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=4.3e-01 t_reduction=5.8e-02 tot=5.1e-01 -----
 sigma_tot[inter] counter=184 t=2.4e-02 per=4.8e+00 cost=8.1e+08 flops=3.4e+10
 sigma_tot[gemm] counter=184 i=0 t=3.9e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=1 t=3.7e-04 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=184 i=2 t=1.0e-01 per=2.0e+01 cost=7.6e+08 flops=7.4e+09
 sigma_tot[gemm] counter=184 i=3 t=1.3e-01 per=2.5e+01 cost=7.5e+08 flops=5.9e+09
 sigma_tot[gemm] counter=184 i=4 t=9.7e-02 per=1.9e+01 cost=6.2e+08 flops=6.4e+09
 sigma_tot[gemm] counter=184 i=5 t=9.8e-02 per=1.9e+01 cost=6.3e+08 flops=6.5e+09
 sigma_tot[gemm] counter=184 total t=4.3e-01 per=8.4e+01 cost=2.8e+09 flops=6.5e+09
 sigma_tot[red] counter=184 t=5.8e-02 per=1.1e+01 cost=1.8e+08 flops=3.0e+09
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.2e-05,1.8e-06,6.5e-06,5.8e-07
    6   0 -    -116.544442466094 -2.014e-07  1.477e-04    3     6  3.456e-02 5.761e-03 5.671e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.838e-05,2.053e-04,4.871e-03,4.592e-04,5.610e-03
 analyze_tgpu[Hx]: ndim=1583:1.179e-05GB T(cpu-gpu)=2.279e-05 speed=1.035e+00GB/S T(nccl)=4.559e-05 speed=5.173e-01GB/S
----- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=4.9e-03 t_reduction=4.6e-04 tot=5.5e-03 -----
 sigma[inter] counter=185 t=2.1e-04 per=3.7e+00 cost=1.1e+07 flops=5.5e+10
 sigma[gemm] counter=185 i=0 t=2.1e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=1 t=2.0e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=185 i=2 t=1.2e-03 per=2.1e+01 cost=7.3e+06 flops=6.2e+09
 sigma[gemm] counter=185 i=3 t=1.5e-03 per=2.7e+01 cost=7.4e+06 flops=5.0e+09
 sigma[gemm] counter=185 i=4 t=1.1e-03 per=2.0e+01 cost=7.3e+06 flops=6.7e+09
 sigma[gemm] counter=185 i=5 t=1.1e-03 per=2.0e+01 cost=7.6e+06 flops=6.8e+09
 sigma[gemm] counter=185 total t=4.9e-03 per=8.8e+01 cost=3.0e+07 flops=6.1e+09
 sigma[red] counter=185 t=4.6e-04 per=8.3e+00 cost=2.2e+06 flops=4.8e+09
----- TIMING FOR sigma_tot : t_inter=2.4e-02 t_gemm=4.3e-01 t_reduction=5.8e-02 tot=5.1e-01 -----
 sigma_tot[inter] counter=185 t=2.4e-02 per=4.8e+00 cost=8.2e+08 flops=3.4e+10
 sigma_tot[gemm] counter=185 i=0 t=3.9e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=1 t=3.7e-04 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=185 i=2 t=1.0e-01 per=2.0e+01 cost=7.7e+08 flops=7.4e+09
 sigma_tot[gemm] counter=185 i=3 t=1.3e-01 per=2.5e+01 cost=7.6e+08 flops=5.9e+09
 sigma_tot[gemm] counter=185 i=4 t=9.9e-02 per=1.9e+01 cost=6.3e+08 flops=6.4e+09
 sigma_tot[gemm] counter=185 i=5 t=9.9e-02 per=1.9e+01 cost=6.4e+08 flops=6.5e+09
 sigma_tot[gemm] counter=185 total t=4.3e-01 per=8.4e+01 cost=2.8e+09 flops=6.5e+09
 sigma_tot[red] counter=185 t=5.8e-02 per=1.1e+01 cost=1.8e+08 flops=3.1e+09
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.5e-05,1.2e-05,1.9e-06,6.9e-06,5.9e-07
    7   0 +    -116.544442499872 -3.378e-08  5.693e-05    3     7  4.042e-02 5.774e-03 5.686e-03
TIMING FOR Davidson : 4.043e-02  T(cal/comm/rest)=3.980e-02,4.325e-06,6.247e-04
decomposed t_rest=6.247e-04
 T(sub)    =2.962e-04 per=4.741e+01
 T(precond)=5.653e-05 per=9.049e+00
 T(ortho)  =3.163e-05 per=5.063e+00
 T(xcopy)  =1.701e-05 per=2.723e+00
 T(xnrm2)  =4.571e-06 per=7.317e-01
 T(other)  =2.188e-04 per=3.502e+01
optimized energies: isweep=0 ibond=26 dots=1 e[0]=-116.544442499872 nmvp=7
rank=0 CPUmem(GB): used=1.353e+00 pageheap_free=1.132e-02 change=5.464e-03 heap=1.395e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=22 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond26.txt
 qbond: qsuper nsym=22 dimAll=292
 (16,-2):39 (15,-1):24 (16,0):26 (14,-2):8 (15,-3):16 (14,0):6 (17,-1):39 (17,-3):29 (16,-4):12 (18,-2):26 (14,-4):1 (18,0):16 (19,-1):9 (19,-3):7 (18,-4):8 (20,-2):3 (20,0):1 (17,1):10 (15,1):6 (19,1):1 (17,-5):4 (15,-5):1
timing for divide=4.4e-06
timing for compute=2.2e-04
timing for collect=1.7e-05
----- TMING FOR decimation_genbasis(nkr): 2.4e-04 S T(divide/compute[cpu/gpu/rest]/collect)=4.4e-06,2.2e-04,0.0e+00,3.8e-06,1.7e-05 -----
decimation summary: 292->65 dwt=-4.441e-16 SvN=2.107e+00
 qbond: qkept nsym=13 dimAll=65
 (17,-1):12 (16,0):8 (16,-2):7 (17,1):7 (15,-1):6 (18,0):6 (18,-2):5 (17,-3):4 (19,-1):4 (15,1):3 (15,-3):1 (19,-3):1 (19,1):1
----- TIMING for decimation_row(nkr): 1.565e-03 S T(decim/select/formRot)=2.960e-04,1.234e-03,3.524e-05 -----
----- TIMING FOR onedot_decimation: 1.675e-03 S T(wf/decim)=8.144e-05,1.594e-03 -----
ctns::oper_renorm coord=(9,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:22 S:9 H:1 P:76 Q:86 
        dim(bra,ket)=65,65 size(op)=447:3.410e-03MB size(tot)=54987:4.195e-01MB:4.097e-04GB
        per(mem): C:12.7 S:5.25 H:0.813 P:26 Q:55.2 
rank=0 CPUmem(GB): used=1.353e+00 pageheap_free=1.106e-02 change=5.187e-04 heap=1.395e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=185 : 1.856e-03 S -----
rank=0 GPUmem(GB): used=1.103e-03 (oper)=1.072e-03
rank=0 GPUmem(GB): used=1.114e-03 (oper,site)=1.072e-03,1.179e-05
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=185
 no. of rintermediate operators=378
 no. of coefficients=3780:2.884e-02MB:2.816e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 1.056e-04 S -----
rank=0 GPUmem(GB): used=1.142e-03 (oper,site,rinter)=1.072e-03,1.179e-05,2.816e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.715e-03 S size(rtasks)=185 size(Rlst2)=169 T(Rmu/Rlist)=4.442e-04,2.271e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.816e-03 S size(rtasks)=185 size(Rlst)=10646 -----
rank=0 GPUmem(GB): used=1.142e-03 avail=3.829e+01 total=3.829e+01 batch[need]=3.784e-02 blksize=168 blksize0=140 batchsize=10646
rank=0 GPUmem(GB): used=3.898e-02 (oper,site,rinter,batch)=1.072e-03,1.179e-05,2.816e-05,3.784e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.826e-04,2.574e-03,3.922e-04
----- TIMING FOR renorm : t_inter=1.8e-04 t_gemm=2.6e-03 t_reduction=3.9e-04 tot=3.1e-03 -----
 renorm[inter] counter=617 t=1.8e-04 per=5.8e+00 cost=5.2e+06 flops=2.9e+10
 renorm[gemm] counter=617 i=0 t=1.9e-06 per=6.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=617 i=1 t=1.6e-06 per=5.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=617 i=2 t=5.0e-04 per=1.6e+01 cost=2.5e+06 flops=5.0e+09
 renorm[gemm] counter=617 i=3 t=1.1e-03 per=3.4e+01 cost=4.6e+06 flops=4.2e+09
 renorm[gemm] counter=617 i=4 t=1.6e-06 per=5.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=617 i=5 t=1.6e-06 per=5.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=617 i=6 t=9.8e-04 per=3.1e+01 cost=7.3e+06 flops=7.4e+09
 renorm[gemm] counter=617 total t=2.6e-03 per=8.2e+01 cost=1.4e+07 flops=5.6e+09
 renorm[red] counter=617 t=3.9e-04 per=1.2e+01 cost=8.3e+05 flops=2.1e+09
----- TIMING FOR renorm_tot : t_inter=3.5e-03 t_gemm=2.9e-02 t_reduction=7.0e-03 tot=4.0e-02 -----
 renorm_tot[inter] counter=617 t=3.5e-03 per=8.9e+00 cost=2.5e+07 flops=7.0e+09
 renorm_tot[gemm] counter=617 i=0 t=5.7e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=617 i=1 t=5.0e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=617 i=2 t=2.7e-03 per=6.8e+00 cost=4.5e+06 flops=1.7e+09
 renorm_tot[gemm] counter=617 i=3 t=4.7e-03 per=1.2e+01 cost=1.7e+07 flops=3.8e+09
 renorm_tot[gemm] counter=617 i=4 t=4.6e-03 per=1.2e+01 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=617 i=5 t=6.5e-03 per=1.6e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=617 i=6 t=1.1e-02 per=2.7e+01 cost=6.7e+07 flops=6.3e+09
 renorm_tot[gemm] counter=617 total t=2.9e-02 per=7.3e+01 cost=1.2e+08 flops=4.2e+09
 renorm_tot[red] counter=617 t=7.0e-03 per=1.8e+01 cost=7.8e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.136e-03 (oper)=1.074e-03
rank=0 GPUmem(GB): used=1.148e-03 (oper,site,rinter)=1.074e-03,1.179e-05,2.682e-06
rank=0 GPUmem(GB): used=1.467e-03 (oper,site,rinter,batch)=1.074e-03,1.179e-05,2.682e-06,3.199e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.358e-02 S T(preprocess/alloc/comp/red/dealloc)=1.082e-03,1.138e-03,9.217e-03,3.111e-03,8.336e-05 -----
----- TIMING FOR oper_renorm_opS : 1.362e-02 S rank=0 -----
qops.to_cpu: size(tot)=54987:4.195e-01MB:4.097e-04GB T(to_cpu)=1.682e-04S speed=2.435e+00GB/S
check ||H-H.dagger||=6.148e-14 coord=(9,0) rank=0
----- TIMING FOR oper_renorm : 0.0283 S rank=0 -----
rank=0 CPUmem(GB): used=1.357e+00 pageheap_free=1.122e-02 change=3.212e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=1.604e-02 change=-5.357e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=1.604e-02 change=-1.618e-05 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 9.998e-02 S #####
 T(local opt: fetch) = 3.911e-03 S  per = 3.91  per(accum) = 3.91
 T(local opt: hdiag) = 1.900e-03 S  per =  1.9  per(accum) = 5.81
 T(local opt: dvdsn) = 6.093e-02 S  per = 60.9  per(accum) = 66.8
 T(local opt: decim) = 1.722e-03 S  per = 1.72  per(accum) = 68.5
 T(local opt: guess) = 8.846e-05 S  per = 0.0885  per(accum) = 68.6
 T(local opt: renrm) = 2.924e-02 S  per = 29.2  per(accum) = 97.8
 T(local opt: save ) = 2.193e-03 S  per = 2.19  per(accum) = 100
Detailed decomposition of T(dvdsn) = 6.093e-02 S  T(sum) = 6.005e-02 S  per = 9.856e+01
 T(local opt: preprocess                  ) = 1.163e-04 S  per = 0.194  per(accum) = 0.194
 T(local opt: symbolic_formulae           ) = 1.519e-03 S  per = 2.53  per(accum) = 2.72
 T(local opt: hintermediate init          ) = 1.062e-04 S  per = 0.177  per(accum) = 2.9
 T(local opt: preprocess_hformulae_Hxlist ) = 9.292e-03 S  per = 15.5  per(accum) = 18.4
 T(local opt: hmmtasks init               ) = 8.575e-03 S  per = 14.3  per(accum) = 32.7
 T(local opt: initial guess for dvdson    ) = 1.013e-05 S  per = 0.0169  per(accum) = 32.7
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.927e-02 S  per = 65.4  per(accum) = 98.1
 T(local opt: dvdson [cpu-gpu]            ) = 1.979e-04 S  per = 0.33  per(accum) = 98.4
 T(local opt: dvdson [nccl]               ) = 3.333e-04 S  per = 0.555  per(accum) = 99
 T(local opt: dvdson [mpi]                ) = 4.325e-06 S  per = 0.0072  per(accum) = 99
 T(local opt: dvdson [rest part(linalg)]  ) = 6.247e-04 S  per = 1.04  per(accum) = 100
Detailed decomposition of T(renrm) = 2.924e-02 S  T(sum) = 2.924e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.601e-05 S  per = 0.26  per(accum) = 0.26
 T(local opt: qops init                    ) = 1.015e-03 S  per = 3.47  per(accum) = 3.73
 T(local opt: symbolic_formulae_renorm     ) = 1.871e-03 S  per =  6.4  per(accum) = 10.1
 T(local opt: allocate qops on gpu         ) = 6.500e-05 S  per = 0.222  per(accum) = 10.4
 T(local opt: site memcpy cpu2gpu          ) = 3.009e-05 S  per = 0.103  per(accum) = 10.5
 T(local opt: rintermediate init           ) = 1.184e-04 S  per = 0.405  per(accum) = 10.9
 T(local opt: preprocess_formulae_Rlist2   ) = 3.884e-03 S  per = 13.3  per(accum) = 24.1
 T(local opt: rmmtasks init                ) = 3.687e-03 S  per = 12.6  per(accum) = 36.8
 T(local opt: qops memset on cpu           ) = 7.100e-08 S  per = 0.000243  per(accum) = 36.8
 T(local opt: preprocess_renorm_batchGPU   ) = 3.466e-03 S  per = 11.9  per(accum) = 48.6
 T(local opt: deallocate cpu and gpu memory) = 2.927e-04 S  per =    1  per(accum) = 49.6
 T(local opt: construct opS [ifdists=true] ) = 1.364e-02 S  per = 46.7  per(accum) = 96.3
 T(local opt: reduction of opS & opH [nccl]) = 2.069e-05 S  per = 0.0708  per(accum) = 96.3
 T(local opt: qops memcpy gpu2cpu          ) = 1.808e-04 S  per = 0.618  per(accum) = 97
 T(local opt: reduction of opS & opH [mpi] ) = 2.103e-05 S  per = 0.0719  per(accum) = 97
 T(local opt: qops_pool join and erase     ) = 8.671e-04 S  per = 2.97  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.063e-06 S  per = 0.00364  per(accum) = 100
ctns::rcanon_save_site idx=10 scratch=./scratch/sweep size=1583:1.2e-05GB T(load)=0.00058S speed=0.02GB/S
##### sweep opt: 1.515e+00 S #####
 T(sweep opt: fetch) = 9.008e-02 S  per = 5.95  per(accum) = 5.95
 T(sweep opt: hdiag) = 2.360e-02 S  per = 1.56  per(accum) = 7.51
 T(sweep opt: dvdsn) = 7.735e-01 S  per = 51.1  per(accum) = 58.6
 T(sweep opt: decim) = 3.220e-02 S  per = 2.13  per(accum) = 60.7
 T(sweep opt: guess) = 1.504e-03 S  per = 0.0993  per(accum) = 60.8
 T(sweep opt: renrm) = 5.379e-01 S  per = 35.5  per(accum) = 96.3
 T(sweep opt: save ) = 5.582e-02 S  per = 3.68  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.735e-01 S  T(sum) = 7.591e-01 S  per = 9.814e+01
 T(sweep opt: preprocess                  ) = 1.873e-03 S  per = 0.247  per(accum) = 0.247
 T(sweep opt: symbolic_formulae           ) = 2.266e-02 S  per = 2.99  per(accum) = 3.23
 T(sweep opt: hintermediate init          ) = 1.661e-03 S  per = 0.219  per(accum) = 3.45
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.797e-02 S  per = 10.3  per(accum) = 13.7
 T(sweep opt: hmmtasks init               ) = 7.878e-02 S  per = 10.4  per(accum) = 24.1
 T(sweep opt: initial guess for dvdson    ) = 1.657e-04 S  per = 0.0218  per(accum) = 24.1
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.484e-01 S  per = 72.2  per(accum) = 96.4
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.546e-03 S  per = 0.599  per(accum) = 97
 T(sweep opt: dvdson [nccl]               ) = 9.771e-03 S  per = 1.29  per(accum) = 98.2
 T(sweep opt: dvdson [mpi]                ) = 8.330e-05 S  per = 0.011  per(accum) = 98.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.326e-02 S  per = 1.75  per(accum) = 100
Detailed decomposition of T(renrm) = 5.379e-01 S  T(sum) = 5.379e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.550e-03 S  per = 0.288  per(accum) = 0.288
 T(sweep opt: qops init                    ) = 1.354e-02 S  per = 2.52  per(accum) = 2.81
 T(sweep opt: symbolic_formulae_renorm     ) = 1.177e-02 S  per = 2.19  per(accum) = 4.99
 T(sweep opt: allocate qops on gpu         ) = 1.888e-03 S  per = 0.351  per(accum) = 5.35
 T(sweep opt: site memcpy cpu2gpu          ) = 6.475e-04 S  per = 0.12  per(accum) = 5.47
 T(sweep opt: rintermediate init           ) = 1.357e-03 S  per = 0.252  per(accum) = 5.72
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.475e-02 S  per =  4.6  per(accum) = 10.3
 T(sweep opt: rmmtasks init                ) = 2.755e-02 S  per = 5.12  per(accum) = 15.4
 T(sweep opt: qops memset on cpu           ) = 1.304e-06 S  per = 0.000242  per(accum) = 15.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.356e-02 S  per =  8.1  per(accum) = 23.5
 T(sweep opt: deallocate cpu and gpu memory) = 3.891e-03 S  per = 0.723  per(accum) = 24.3
 T(sweep opt: construct opS [ifdists=true] ) = 3.724e-01 S  per = 69.2  per(accum) = 93.5
 T(sweep opt: reduction of opS & opH [nccl]) = 6.755e-04 S  per = 0.126  per(accum) = 93.6
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.709e-03 S  per = 0.689  per(accum) = 94.3
 T(sweep opt: reduction of opS & opH [mpi] ) = 7.697e-04 S  per = 0.143  per(accum) = 94.4
 T(sweep opt: qops_pool join and erase     ) = 1.769e-02 S  per = 3.29  per(accum) = 97.7
 T(sweep opt: conversion from opAB to opPQ ) = 1.219e-02 S  per = 2.27  per(accum) = 100
##### global opt: 1.515e+00 S #####
 T(global opt: fetch) = 9.008e-02 S  per = 5.95  per(accum) = 5.95
 T(global opt: hdiag) = 2.360e-02 S  per = 1.56  per(accum) = 7.51
 T(global opt: dvdsn) = 7.735e-01 S  per = 51.1  per(accum) = 58.6
 T(global opt: decim) = 3.220e-02 S  per = 2.13  per(accum) = 60.7
 T(global opt: guess) = 1.504e-03 S  per = 0.0993  per(accum) = 60.8
 T(global opt: renrm) = 5.379e-01 S  per = 35.5  per(accum) = 96.3
 T(global opt: save ) = 5.582e-02 S  per = 3.68  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.735e-01 S  T(sum) = 7.591e-01 S  per = 9.814e+01
 T(global opt: preprocess                  ) = 1.873e-03 S  per = 0.247  per(accum) = 0.247
 T(global opt: symbolic_formulae           ) = 2.266e-02 S  per = 2.99  per(accum) = 3.23
 T(global opt: hintermediate init          ) = 1.661e-03 S  per = 0.219  per(accum) = 3.45
 T(global opt: preprocess_hformulae_Hxlist ) = 7.797e-02 S  per = 10.3  per(accum) = 13.7
 T(global opt: hmmtasks init               ) = 7.878e-02 S  per = 10.4  per(accum) = 24.1
 T(global opt: initial guess for dvdson    ) = 1.657e-04 S  per = 0.0218  per(accum) = 24.1
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.484e-01 S  per = 72.2  per(accum) = 96.4
 T(global opt: dvdson [cpu-gpu]            ) = 4.546e-03 S  per = 0.599  per(accum) = 97
 T(global opt: dvdson [nccl]               ) = 9.771e-03 S  per = 1.29  per(accum) = 98.2
 T(global opt: dvdson [mpi]                ) = 8.330e-05 S  per = 0.011  per(accum) = 98.3
 T(global opt: dvdson [rest part(linalg)]  ) = 1.326e-02 S  per = 1.75  per(accum) = 100
Detailed decomposition of T(renrm) = 5.379e-01 S  T(sum) = 5.379e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.550e-03 S  per = 0.288  per(accum) = 0.288
 T(global opt: qops init                    ) = 1.354e-02 S  per = 2.52  per(accum) = 2.81
 T(global opt: symbolic_formulae_renorm     ) = 1.177e-02 S  per = 2.19  per(accum) = 4.99
 T(global opt: allocate qops on gpu         ) = 1.888e-03 S  per = 0.351  per(accum) = 5.35
 T(global opt: site memcpy cpu2gpu          ) = 6.475e-04 S  per = 0.12  per(accum) = 5.47
 T(global opt: rintermediate init           ) = 1.357e-03 S  per = 0.252  per(accum) = 5.72
 T(global opt: preprocess_formulae_Rlist2   ) = 2.475e-02 S  per =  4.6  per(accum) = 10.3
 T(global opt: rmmtasks init                ) = 2.755e-02 S  per = 5.12  per(accum) = 15.4
 T(global opt: qops memset on cpu           ) = 1.304e-06 S  per = 0.000242  per(accum) = 15.4
 T(global opt: preprocess_renorm_batchGPU   ) = 4.356e-02 S  per =  8.1  per(accum) = 23.5
 T(global opt: deallocate cpu and gpu memory) = 3.891e-03 S  per = 0.723  per(accum) = 24.3
 T(global opt: construct opS [ifdists=true] ) = 3.724e-01 S  per = 69.2  per(accum) = 93.5
 T(global opt: reduction of opS & opH [nccl]) = 6.755e-04 S  per = 0.126  per(accum) = 93.6
 T(global opt: qops memcpy gpu2cpu          ) = 3.709e-03 S  per = 0.689  per(accum) = 94.3
 T(global opt: reduction of opS & opH [mpi] ) = 7.697e-04 S  per = 0.143  per(accum) = 94.4
 T(global opt: qops_pool join and erase     ) = 1.769e-02 S  per = 3.29  per(accum) = 97.7
 T(global opt: conversion from opAB to opPQ ) = 1.219e-02 S  per = 2.27  per(accum) = 100
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-5.472e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=27/seqsize=34 dots=1 dbond=(7,0)-(8,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=12 scratch=./scratch/sweep size=981:7.31e-06GB T(load)=3.15e-04S speed=2.32e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=2213:1.69e-02MB:1.65e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=1232:9.40e-03MB:9.18e-06GB
total mem of comb=3593:2.74e-02MB:2.68e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.438e-05 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=8,11,1
 suppl= 0 1 2 3 4 16 17 18
 suppr= 5 6 7 8 9 10 11 12 13 14 15
 suppc= 19
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(7,0)
 fqop[1]=./scratch/sweep/rop(9,0)
 fqop[2]=./scratch/sweep/cop(8,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:16 S:12 H:1 A:61 B:67 
        dim(bra,ket)=57,57 size(op)=361:2.754e-03MB size(tot)=35158:2.682e-01MB:2.619e-04GB
        per(mem): C:11.8 S:9.18 H:1.03 A:24.3 B:53.7 
 rqops: oplist=CSHPQ nops=C:22 S:9 H:1 P:76 Q:86 
        dim(bra,ket)=65,65 size(op)=447:0.00341MB size(tot)=54987:0.42MB:0.00041GB
        per(mem): C:12.7 S:5.25 H:0.813 P:26 Q:55.2 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=92481:0.706MB:0.000689GB
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.498e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(8,0) fdel=./scratch/sweep/lop(7,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=2.670e-04 change=-2.667e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(57,65,4) nnz=1232:9.399e-03MB
qtensor3: wf3 own=1 _data=0x55b2c6d46800
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=12 dimAll=57
 (11,1):10 (12,2):8 (12,0):8 (13,1):6 (10,2):5 (10,0):5 (11,3):4 (11,-1):4 (13,-1):3 (9,1):2 (9,3):1 (13,3):1
 qbond: qcol nsym=13 dimAll=65
 (17,-1):12 (16,0):8 (16,-2):7 (17,1):7 (15,-1):6 (18,0):6 (18,-2):5 (17,-3):4 (19,-1):4 (15,1):3 (15,-3):1 (19,-3):1 (19,1):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=36 nblocks=624 size=1232:9.399e-03MB
### DIAG TIMING: total=1.480e-03 t1=2.085e-05, t2=1.401e-05, t3=1.305e-05, t4=1.374e-03, t5=1.175e-05, t6=3.866e-05, t7=7.635e-06
duration_diagGPU:1.489e-03
duration_diagreduce:4.500e-08
duration_diagtransform:1.364e-06
----- TIMING FOR symbolic_formulae_onedot with size=662 : 1.357e-03 S -----
rank=0 GPUmem(GB): used=6.890e-04 (oper)=6.890e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=662
 no. of hintermediate operators=329
 no. of coefficients=3619:2.761e-02MB:2.696e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.247e-05 S -----
rank=0 GPUmem(GB): used=7.160e-04 (oper,hinter)=6.890e-04,2.696e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.469e-03 S size(H_formulae)=662 size(Hxlst2)=36 T(Hmu/Hxlist)=3.027e-04,5.167e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 7.252e-03 S size(H_formulae)=662 size(Hxlst)=18242 -----
rank=0 GPUmem(GB): used=7.160e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.836e-05 batch[need]=4.580e-02 blksize=120 blksize0=96 batchsize=18242
rank=0 GPUmem(GB): used=4.654e-02 (oper,hinter,dvdson,batch)=6.890e-04,2.696e-05,1.836e-05,4.580e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=1232 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=9.123e-05,2.257e-04,4.500e-03,4.880e-04,5.324e-03
 analyze_tgpu[Hx]: ndim=1232:9.179e-06GB T(cpu-gpu)=3.297e-05 speed=5.567e-01GB/S T(nccl)=5.826e-05 speed=3.151e-01GB/S
----- TIMING FOR sigma : t_inter=2.3e-04 t_gemm=4.5e-03 t_reduction=4.9e-04 tot=5.2e-03 -----
 sigma[inter] counter=186 t=2.3e-04 per=4.3e+00 cost=7.0e+06 flops=3.1e+10
 sigma[gemm] counter=186 i=0 t=3.0e-06 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=1 t=2.0e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=186 i=2 t=1.1e-03 per=2.1e+01 cost=3.9e+06 flops=3.6e+09
 sigma[gemm] counter=186 i=3 t=1.4e-03 per=2.7e+01 cost=3.9e+06 flops=2.8e+09
 sigma[gemm] counter=186 i=4 t=9.4e-04 per=1.8e+01 cost=4.3e+06 flops=4.6e+09
 sigma[gemm] counter=186 i=5 t=1.1e-03 per=2.1e+01 cost=4.6e+06 flops=4.3e+09
 sigma[gemm] counter=186 total t=4.5e-03 per=8.6e+01 cost=1.7e+07 flops=3.7e+09
 sigma[red] counter=186 t=4.9e-04 per=9.4e+00 cost=1.4e+06 flops=2.9e+09
----- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=4.4e-01 t_reduction=5.9e-02 tot=5.2e-01 -----
 sigma_tot[inter] counter=186 t=2.5e-02 per=4.7e+00 cost=8.3e+08 flops=3.4e+10
 sigma_tot[gemm] counter=186 i=0 t=4.0e-04 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=1 t=3.7e-04 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=186 i=2 t=1.0e-01 per=2.0e+01 cost=7.7e+08 flops=7.4e+09
 sigma_tot[gemm] counter=186 i=3 t=1.3e-01 per=2.5e+01 cost=7.6e+08 flops=5.8e+09
 sigma_tot[gemm] counter=186 i=4 t=9.9e-02 per=1.9e+01 cost=6.3e+08 flops=6.4e+09
 sigma_tot[gemm] counter=186 i=5 t=1.0e-01 per=1.9e+01 cost=6.4e+08 flops=6.5e+09
 sigma_tot[gemm] counter=186 total t=4.4e-01 per=8.4e+01 cost=2.8e+09 flops=6.5e+09
 sigma_tot[red] counter=186 t=5.9e-02 per=1.1e+01 cost=1.8e+08 flops=3.1e+09
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,5.9e-06,1.4e-06,3.0e-06,6.5e-07
settings: ndim=1232 neig=1 maxcycle=30 nbuff=4 memory=0.0001GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.544442499872 -1.117e+03  1.758e-02    1     1  5.762e-03 5.762e-03 5.706e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.899e-05,2.202e-04,6.322e-03,7.450e-04,7.375e-03
 analyze_tgpu[Hx]: ndim=1232:9.179e-06GB T(cpu-gpu)=2.755e-05 speed=6.664e-01GB/S T(nccl)=5.144e-05 speed=3.569e-01GB/S
----- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=6.3e-03 t_reduction=7.4e-04 tot=7.3e-03 -----
 sigma[inter] counter=187 t=2.2e-04 per=3.0e+00 cost=7.0e+06 flops=3.2e+10
 sigma[gemm] counter=187 i=0 t=2.7e-06 per=3.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=1 t=2.2e-06 per=3.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=187 i=2 t=1.3e-03 per=1.8e+01 cost=3.9e+06 flops=3.0e+09
 sigma[gemm] counter=187 i=3 t=1.9e-03 per=2.6e+01 cost=3.9e+06 flops=2.1e+09
 sigma[gemm] counter=187 i=4 t=1.5e-03 per=2.0e+01 cost=4.3e+06 flops=2.9e+09
 sigma[gemm] counter=187 i=5 t=1.6e-03 per=2.2e+01 cost=4.6e+06 flops=2.8e+09
 sigma[gemm] counter=187 total t=6.3e-03 per=8.7e+01 cost=1.7e+07 flops=2.6e+09
 sigma[red] counter=187 t=7.4e-04 per=1.0e+01 cost=1.4e+06 flops=1.9e+09
----- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=4.4e-01 t_reduction=6.0e-02 tot=5.3e-01 -----
 sigma_tot[inter] counter=187 t=2.5e-02 per=4.7e+00 cost=8.4e+08 flops=3.4e+10
 sigma_tot[gemm] counter=187 i=0 t=4.0e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=1 t=3.7e-04 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=187 i=2 t=1.1e-01 per=2.0e+01 cost=7.8e+08 flops=7.3e+09
 sigma_tot[gemm] counter=187 i=3 t=1.3e-01 per=2.5e+01 cost=7.7e+08 flops=5.8e+09
 sigma_tot[gemm] counter=187 i=4 t=1.0e-01 per=1.9e+01 cost=6.4e+08 flops=6.3e+09
 sigma_tot[gemm] counter=187 i=5 t=1.0e-01 per=1.9e+01 cost=6.5e+08 flops=6.4e+09
 sigma_tot[gemm] counter=187 total t=4.4e-01 per=8.4e+01 cost=2.8e+09 flops=6.4e+09
 sigma_tot[red] counter=187 t=6.0e-02 per=1.1e+01 cost=1.8e+08 flops=3.0e+09
T(sub)=6.2e-05 T(gemm/eig/ortho/gemm/axpy)=2.5e-05,2.7e-05,4.1e-06,5.0e-06,8.4e-07
    2   0 -    -116.544797620159 -3.551e-04  3.223e-03    2     2  1.377e-02 6.885e-03 6.784e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.635e-05,2.577e-04,6.733e-03,5.713e-04,7.648e-03
 analyze_tgpu[Hx]: ndim=1232:9.179e-06GB T(cpu-gpu)=2.536e-05 speed=7.240e-01GB/S T(nccl)=5.099e-05 speed=3.601e-01GB/S
----- TIMING FOR sigma : t_inter=2.6e-04 t_gemm=6.7e-03 t_reduction=5.7e-04 tot=7.6e-03 -----
 sigma[inter] counter=188 t=2.6e-04 per=3.4e+00 cost=7.0e+06 flops=2.7e+10
 sigma[gemm] counter=188 i=0 t=3.1e-06 per=4.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=1 t=2.9e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=188 i=2 t=1.6e-03 per=2.1e+01 cost=3.9e+06 flops=2.4e+09
 sigma[gemm] counter=188 i=3 t=2.4e-03 per=3.2e+01 cost=3.9e+06 flops=1.6e+09
 sigma[gemm] counter=188 i=4 t=1.5e-03 per=1.9e+01 cost=4.3e+06 flops=2.9e+09
 sigma[gemm] counter=188 i=5 t=1.3e-03 per=1.7e+01 cost=4.6e+06 flops=3.6e+09
 sigma[gemm] counter=188 total t=6.7e-03 per=8.9e+01 cost=1.7e+07 flops=2.5e+09
 sigma[red] counter=188 t=5.7e-04 per=7.6e+00 cost=1.4e+06 flops=2.5e+09
----- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=4.5e-01 t_reduction=6.0e-02 tot=5.3e-01 -----
 sigma_tot[inter] counter=188 t=2.5e-02 per=4.7e+00 cost=8.5e+08 flops=3.4e+10
 sigma_tot[gemm] counter=188 i=0 t=4.0e-04 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=1 t=3.8e-04 per=7.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=188 i=2 t=1.1e-01 per=2.0e+01 cost=7.8e+08 flops=7.3e+09
 sigma_tot[gemm] counter=188 i=3 t=1.3e-01 per=2.5e+01 cost=7.7e+08 flops=5.7e+09
 sigma_tot[gemm] counter=188 i=4 t=1.0e-01 per=1.9e+01 cost=6.4e+08 flops=6.3e+09
 sigma_tot[gemm] counter=188 i=5 t=1.0e-01 per=1.9e+01 cost=6.5e+08 flops=6.4e+09
 sigma_tot[gemm] counter=188 total t=4.5e-01 per=8.4e+01 cost=2.8e+09 flops=6.3e+09
 sigma_tot[red] counter=188 t=6.0e-02 per=1.1e+01 cost=1.8e+08 flops=3.0e+09
T(sub)=4.8e-05 T(gemm/eig/ortho/gemm/axpy)=1.7e-05,2.1e-05,2.7e-06,6.1e-06,7.1e-07
    3   0 -    -116.544814585472 -1.697e-05  1.210e-03    3     3  2.191e-02 7.302e-03 7.200e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.022e-05,2.139e-04,5.537e-03,5.722e-04,6.400e-03
 analyze_tgpu[Hx]: ndim=1232:9.179e-06GB T(cpu-gpu)=2.358e-05 speed=7.784e-01GB/S T(nccl)=4.663e-05 speed=3.937e-01GB/S
----- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=5.5e-03 t_reduction=5.7e-04 tot=6.3e-03 -----
 sigma[inter] counter=189 t=2.1e-04 per=3.4e+00 cost=7.0e+06 flops=3.3e+10
 sigma[gemm] counter=189 i=0 t=2.5e-06 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=1 t=2.1e-06 per=3.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=189 i=2 t=1.3e-03 per=2.0e+01 cost=3.9e+06 flops=3.1e+09
 sigma[gemm] counter=189 i=3 t=1.9e-03 per=2.9e+01 cost=3.9e+06 flops=2.1e+09
 sigma[gemm] counter=189 i=4 t=1.2e-03 per=1.8e+01 cost=4.3e+06 flops=3.7e+09
 sigma[gemm] counter=189 i=5 t=1.3e-03 per=2.0e+01 cost=4.6e+06 flops=3.7e+09
 sigma[gemm] counter=189 total t=5.5e-03 per=8.8e+01 cost=1.7e+07 flops=3.0e+09
 sigma[red] counter=189 t=5.7e-04 per=9.0e+00 cost=1.4e+06 flops=2.5e+09
----- TIMING FOR sigma_tot : t_inter=2.5e-02 t_gemm=4.5e-01 t_reduction=6.1e-02 tot=5.4e-01 -----
 sigma_tot[inter] counter=189 t=2.5e-02 per=4.7e+00 cost=8.5e+08 flops=3.4e+10
 sigma_tot[gemm] counter=189 i=0 t=4.1e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=1 t=3.8e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=189 i=2 t=1.1e-01 per=2.0e+01 cost=7.8e+08 flops=7.2e+09
 sigma_tot[gemm] counter=189 i=3 t=1.4e-01 per=2.5e+01 cost=7.7e+08 flops=5.7e+09
 sigma_tot[gemm] counter=189 i=4 t=1.0e-01 per=1.9e+01 cost=6.4e+08 flops=6.2e+09
 sigma_tot[gemm] counter=189 i=5 t=1.0e-01 per=1.9e+01 cost=6.6e+08 flops=6.3e+09
 sigma_tot[gemm] counter=189 total t=4.5e-01 per=8.4e+01 cost=2.9e+09 flops=6.3e+09
 sigma_tot[red] counter=189 t=6.1e-02 per=1.1e+01 cost=1.8e+08 flops=3.0e+09
T(sub)=4.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.6e-05,1.5e-05,2.3e-06,5.7e-06,5.9e-07
    4   0 -    -116.544817078405 -2.493e-06  4.934e-04    3     4  2.878e-02 7.196e-03 7.099e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.690e-05,2.082e-04,4.759e-03,4.771e-04,5.519e-03
 analyze_tgpu[Hx]: ndim=1232:9.179e-06GB T(cpu-gpu)=2.166e-05 speed=8.474e-01GB/S T(nccl)=4.523e-05 speed=4.059e-01GB/S
----- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=4.8e-03 t_reduction=4.8e-04 tot=5.4e-03 -----
 sigma[inter] counter=190 t=2.1e-04 per=3.8e+00 cost=7.0e+06 flops=3.4e+10
 sigma[gemm] counter=190 i=0 t=2.6e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=1 t=2.2e-06 per=4.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=190 i=2 t=1.2e-03 per=2.2e+01 cost=3.9e+06 flops=3.3e+09
 sigma[gemm] counter=190 i=3 t=1.5e-03 per=2.8e+01 cost=3.9e+06 flops=2.6e+09
 sigma[gemm] counter=190 i=4 t=9.8e-04 per=1.8e+01 cost=4.3e+06 flops=4.4e+09
 sigma[gemm] counter=190 i=5 t=1.1e-03 per=2.0e+01 cost=4.6e+06 flops=4.3e+09
 sigma[gemm] counter=190 total t=4.8e-03 per=8.7e+01 cost=1.7e+07 flops=3.5e+09
 sigma[red] counter=190 t=4.8e-04 per=8.8e+00 cost=1.4e+06 flops=3.0e+09
----- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=4.6e-01 t_reduction=6.1e-02 tot=5.5e-01 -----
 sigma_tot[inter] counter=190 t=2.6e-02 per=4.7e+00 cost=8.6e+08 flops=3.4e+10
 sigma_tot[gemm] counter=190 i=0 t=4.1e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=1 t=3.8e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=190 i=2 t=1.1e-01 per=2.0e+01 cost=7.9e+08 flops=7.2e+09
 sigma_tot[gemm] counter=190 i=3 t=1.4e-01 per=2.5e+01 cost=7.8e+08 flops=5.6e+09
 sigma_tot[gemm] counter=190 i=4 t=1.0e-01 per=1.9e+01 cost=6.5e+08 flops=6.2e+09
 sigma_tot[gemm] counter=190 i=5 t=1.0e-01 per=1.9e+01 cost=6.6e+08 flops=6.3e+09
 sigma_tot[gemm] counter=190 total t=4.6e-01 per=8.4e+01 cost=2.9e+09 flops=6.3e+09
 sigma_tot[red] counter=190 t=6.1e-02 per=1.1e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=3.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.2e-05,1.8e-06,4.4e-06,4.4e-07
    5   0 -    -116.544817448707 -3.703e-07  1.609e-04    3     5  3.465e-02 6.929e-03 6.837e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.417e-05,1.956e-04,4.691e-03,4.699e-04,5.427e-03
 analyze_tgpu[Hx]: ndim=1232:9.179e-06GB T(cpu-gpu)=2.133e-05 speed=8.608e-01GB/S T(nccl)=4.285e-05 speed=4.285e-01GB/S
----- TIMING FOR sigma : t_inter=2.0e-04 t_gemm=4.7e-03 t_reduction=4.7e-04 tot=5.4e-03 -----
 sigma[inter] counter=191 t=2.0e-04 per=3.6e+00 cost=7.0e+06 flops=3.6e+10
 sigma[gemm] counter=191 i=0 t=2.1e-06 per=3.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=1 t=2.0e-06 per=3.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=191 i=2 t=1.1e-03 per=2.1e+01 cost=3.9e+06 flops=3.4e+09
 sigma[gemm] counter=191 i=3 t=1.5e-03 per=2.8e+01 cost=3.9e+06 flops=2.6e+09
 sigma[gemm] counter=191 i=4 t=9.8e-04 per=1.8e+01 cost=4.3e+06 flops=4.4e+09
 sigma[gemm] counter=191 i=5 t=1.1e-03 per=2.0e+01 cost=4.6e+06 flops=4.3e+09
 sigma[gemm] counter=191 total t=4.7e-03 per=8.8e+01 cost=1.7e+07 flops=3.6e+09
 sigma[red] counter=191 t=4.7e-04 per=8.8e+00 cost=1.4e+06 flops=3.0e+09
----- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=4.6e-01 t_reduction=6.2e-02 tot=5.5e-01 -----
 sigma_tot[inter] counter=191 t=2.6e-02 per=4.7e+00 cost=8.7e+08 flops=3.4e+10
 sigma_tot[gemm] counter=191 i=0 t=4.1e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=1 t=3.8e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=191 i=2 t=1.1e-01 per=2.0e+01 cost=7.9e+08 flops=7.1e+09
 sigma_tot[gemm] counter=191 i=3 t=1.4e-01 per=2.5e+01 cost=7.8e+08 flops=5.6e+09
 sigma_tot[gemm] counter=191 i=4 t=1.1e-01 per=1.9e+01 cost=6.5e+08 flops=6.2e+09
 sigma_tot[gemm] counter=191 i=5 t=1.1e-01 per=1.9e+01 cost=6.7e+08 flops=6.3e+09
 sigma_tot[gemm] counter=191 total t=4.6e-01 per=8.4e+01 cost=2.9e+09 flops=6.3e+09
 sigma_tot[red] counter=191 t=6.2e-02 per=1.1e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=3.1e-05 T(gemm/eig/ortho/gemm/axpy)=1.3e-05,1.2e-05,1.8e-06,4.5e-06,4.5e-07
    6   0 +    -116.544817486309 -3.760e-08  6.278e-05    3     6  4.033e-02 6.722e-03 6.635e-03
TIMING FOR Davidson : 4.035e-02  T(cal/comm/rest)=3.981e-02,2.891e-06,5.356e-04
decomposed t_rest=5.356e-04
 T(sub)    =2.327e-04 per=4.344e+01
 T(precond)=4.130e-05 per=7.711e+00
 T(ortho)  =2.567e-05 per=4.792e+00
 T(xcopy)  =3.328e-06 per=6.213e-01
 T(xnrm2)  =4.362e-06 per=8.144e-01
 T(other)  =2.283e-04 per=4.262e+01
optimized energies: isweep=0 ibond=27 dots=1 e[0]=-116.544817486309 nmvp=6
rank=0 CPUmem(GB): used=1.351e+00 pageheap_free=8.018e-03 change=4.486e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=24 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond27.txt
 qbond: qsuper nsym=24 dimAll=260
 (17,-1):33 (16,0):17 (16,-2):14 (17,1):18 (15,-1):6 (18,0):33 (18,-2):28 (17,-3):12 (19,-1):27 (15,1):3 (15,-3):1 (19,-3):10 (19,1):14 (20,0):11 (20,-2):10 (21,-1):4 (21,-3):1 (21,1):1 (18,2):7 (16,2):3 (20,2):1 (18,-4):4 (16,-4):1 (20,-4):1
timing for divide=4.3e-06
timing for compute=2.2e-04
timing for collect=1.6e-05
----- TMING FOR decimation_genbasis(nkr): 2.4e-04 S T(divide/compute[cpu/gpu/rest]/collect)=4.3e-06,2.0e-04,0.0e+00,1.3e-05,1.6e-05 -----
decimation summary: 260->57 dwt=-2.220e-16 SvN=2.062e+00
 qbond: qkept nsym=12 dimAll=57
 (19,-1):10 (18,0):8 (18,-2):8 (17,-1):6 (20,0):5 (20,-2):5 (19,-3):4 (19,1):4 (17,1):3 (21,-1):2 (17,-3):1 (21,-3):1
----- TIMING for decimation_row(nkr): 1.452e-03 S T(decim/select/formRot)=2.923e-04,1.130e-03,2.969e-05 -----
----- TIMING FOR onedot_decimation: 1.523e-03 S T(wf/decim)=4.725e-05,1.476e-03 -----
ctns::oper_renorm coord=(8,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:24 S:8 H:1 P:61 Q:67 
        dim(bra,ket)=57,57 size(op)=361:2.754e-03MB size(tot)=36150:2.758e-01MB:2.693e-04GB
        per(mem): C:17.2 S:5.95 H:0.999 P:23.7 Q:52.2 
rank=0 CPUmem(GB): used=1.352e+00 pageheap_free=8.018e-03 change=3.635e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=153 : 1.493e-03 S -----
rank=0 GPUmem(GB): used=7.234e-04 (oper)=6.964e-04
rank=0 GPUmem(GB): used=7.326e-04 (oper,site)=6.964e-04,9.179e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=153
 no. of rintermediate operators=297
 no. of coefficients=3267:2.493e-02MB:2.434e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 9.772e-05 S -----
rank=0 GPUmem(GB): used=7.569e-04 (oper,site,rinter)=6.964e-04,9.179e-06,2.434e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 2.341e-03 S size(rtasks)=153 size(Rlst2)=144 T(Rmu/Rlist)=3.158e-04,2.026e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.782e-03 S size(rtasks)=153 size(Rlst)=8659 -----
rank=0 GPUmem(GB): used=7.569e-04 avail=3.829e+01 total=3.829e+01 batch[need]=2.174e-02 blksize=120 blksize0=96 batchsize=8659
rank=0 GPUmem(GB): used=2.250e-02 (oper,site,rinter,batch)=6.964e-04,9.179e-06,2.434e-05,2.174e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.688e-04,2.445e-03,2.901e-04
----- TIMING FOR renorm : t_inter=1.7e-04 t_gemm=2.4e-03 t_reduction=2.9e-04 tot=2.9e-03 -----
 renorm[inter] counter=636 t=1.7e-04 per=5.8e+00 cost=3.2e+06 flops=1.9e+10
 renorm[gemm] counter=636 i=0 t=1.8e-06 per=6.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=636 i=1 t=1.6e-06 per=5.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=636 i=2 t=5.2e-04 per=1.8e+01 cost=1.3e+06 flops=2.5e+09
 renorm[gemm] counter=636 i=3 t=1.0e-03 per=3.5e+01 cost=2.4e+06 flops=2.4e+09
 renorm[gemm] counter=636 i=4 t=1.7e-06 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=636 i=5 t=1.6e-06 per=5.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=636 i=6 t=9.1e-04 per=3.1e+01 cost=4.5e+06 flops=4.9e+09
 renorm[gemm] counter=636 total t=2.4e-03 per=8.4e+01 cost=8.2e+06 flops=3.3e+09
 renorm[red] counter=636 t=2.9e-04 per=1.0e+01 cost=6.4e+05 flops=2.2e+09
----- TIMING FOR renorm_tot : t_inter=3.7e-03 t_gemm=3.2e-02 t_reduction=7.3e-03 tot=4.3e-02 -----
 renorm_tot[inter] counter=636 t=3.7e-03 per=8.7e+00 cost=2.8e+07 flops=7.6e+09
 renorm_tot[gemm] counter=636 i=0 t=5.9e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=636 i=1 t=5.2e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=636 i=2 t=3.2e-03 per=7.5e+00 cost=5.8e+06 flops=1.8e+09
 renorm_tot[gemm] counter=636 i=3 t=5.7e-03 per=1.3e+01 cost=2.0e+07 flops=3.5e+09
 renorm_tot[gemm] counter=636 i=4 t=4.6e-03 per=1.1e+01 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=636 i=5 t=6.5e-03 per=1.5e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=636 i=6 t=1.2e-02 per=2.7e+01 cost=7.2e+07 flops=6.2e+09
 renorm_tot[gemm] counter=636 total t=3.2e-02 per=7.4e+01 cost=1.3e+08 flops=4.2e+09
 renorm_tot[red] counter=636 t=7.3e-03 per=1.7e+01 cost=8.4e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=7.524e-04 (oper)=6.984e-04
rank=0 GPUmem(GB): used=7.615e-04 (oper,site,rinter)=6.984e-04,9.179e-06,2.623e-06
rank=0 GPUmem(GB): used=1.003e-03 (oper,site,rinter,batch)=6.984e-04,9.179e-06,2.623e-06,2.410e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.284e-02 S T(preprocess/alloc/comp/red/dealloc)=9.983e-04,1.092e-03,8.552e-03,3.090e-03,8.035e-05 -----
----- TIMING FOR oper_renorm_opS : 1.288e-02 S rank=0 -----
qops.to_cpu: size(tot)=36150:2.758e-01MB:2.693e-04GB T(to_cpu)=9.486e-05S speed=2.839e+00GB/S
check ||H-H.dagger||=3.056e-14 coord=(8,0) rank=0
----- TIMING FOR oper_renorm : 0.0248 S rank=0 -----
rank=0 CPUmem(GB): used=1.354e+00 pageheap_free=7.553e-03 change=2.567e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=1.299e-02 change=-4.453e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=1.299e-02 change=-1.329e-05 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 9.200e-02 S #####
 T(local opt: fetch) = 3.695e-03 S  per = 4.02  per(accum) = 4.02
 T(local opt: hdiag) = 1.525e-03 S  per = 1.66  per(accum) = 5.67
 T(local opt: dvdsn) = 5.725e-02 S  per = 62.2  per(accum) = 67.9
 T(local opt: decim) = 1.568e-03 S  per =  1.7  per(accum) = 69.6
 T(local opt: guess) = 8.450e-05 S  per = 0.0918  per(accum) = 69.7
 T(local opt: renrm) = 2.578e-02 S  per =   28  per(accum) = 97.7
 T(local opt: save ) = 2.094e-03 S  per = 2.28  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.725e-02 S  T(sum) = 5.639e-02 S  per = 9.850e+01
 T(local opt: preprocess                  ) = 1.086e-04 S  per = 0.193  per(accum) = 0.193
 T(local opt: symbolic_formulae           ) = 1.364e-03 S  per = 2.42  per(accum) = 2.61
 T(local opt: hintermediate init          ) = 7.081e-05 S  per = 0.126  per(accum) = 2.74
 T(local opt: preprocess_hformulae_Hxlist ) = 7.728e-03 S  per = 13.7  per(accum) = 16.4
 T(local opt: hmmtasks init               ) = 6.764e-03 S  per =   12  per(accum) = 28.4
 T(local opt: initial guess for dvdson    ) = 8.303e-06 S  per = 0.0147  per(accum) = 28.5
 T(local opt: dvdson [Hx_batchGPU]        ) = 3.936e-02 S  per = 69.8  per(accum) = 98.3
 T(local opt: dvdson [cpu-gpu]            ) = 1.525e-04 S  per = 0.27  per(accum) = 98.5
 T(local opt: dvdson [nccl]               ) = 2.954e-04 S  per = 0.524  per(accum) = 99
 T(local opt: dvdson [mpi]                ) = 2.891e-06 S  per = 0.00513  per(accum) = 99.1
 T(local opt: dvdson [rest part(linalg)]  ) = 5.356e-04 S  per = 0.95  per(accum) = 100
Detailed decomposition of T(renrm) = 2.578e-02 S  T(sum) = 2.578e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 7.069e-05 S  per = 0.274  per(accum) = 0.274
 T(local opt: qops init                    ) = 8.048e-04 S  per = 3.12  per(accum) = 3.4
 T(local opt: symbolic_formulae_renorm     ) = 1.508e-03 S  per = 5.85  per(accum) = 9.24
 T(local opt: allocate qops on gpu         ) = 6.474e-05 S  per = 0.251  per(accum) = 9.5
 T(local opt: site memcpy cpu2gpu          ) = 2.886e-05 S  per = 0.112  per(accum) = 9.61
 T(local opt: rintermediate init           ) = 1.131e-04 S  per = 0.439  per(accum) = 10
 T(local opt: preprocess_formulae_Rlist2   ) = 2.827e-03 S  per =   11  per(accum) = 21
 T(local opt: rmmtasks init                ) = 2.908e-03 S  per = 11.3  per(accum) = 32.3
 T(local opt: qops memset on cpu           ) = 7.400e-08 S  per = 0.000287  per(accum) = 32.3
 T(local opt: preprocess_renorm_batchGPU   ) = 3.225e-03 S  per = 12.5  per(accum) = 44.8
 T(local opt: deallocate cpu and gpu memory) = 3.241e-04 S  per = 1.26  per(accum) = 46.1
 T(local opt: construct opS [ifdists=true] ) = 1.290e-02 S  per = 50.1  per(accum) = 96.1
 T(local opt: reduction of opS & opH [nccl]) = 2.012e-05 S  per = 0.078  per(accum) = 96.2
 T(local opt: qops memcpy gpu2cpu          ) = 1.060e-04 S  per = 0.411  per(accum) = 96.6
 T(local opt: reduction of opS & opH [mpi] ) = 1.415e-05 S  per = 0.0549  per(accum) = 96.7
 T(local opt: qops_pool join and erase     ) = 8.610e-04 S  per = 3.34  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.050e-06 S  per = 0.00407  per(accum) = 100
ctns::rcanon_save_site idx=11 scratch=./scratch/sweep size=1232:9.2e-06GB T(load)=0.0006S speed=0.015GB/S
##### sweep opt: 1.607e+00 S #####
 T(sweep opt: fetch) = 9.378e-02 S  per = 5.84  per(accum) = 5.84
 T(sweep opt: hdiag) = 2.513e-02 S  per = 1.56  per(accum) = 7.4
 T(sweep opt: dvdsn) = 8.308e-01 S  per = 51.7  per(accum) = 59.1
 T(sweep opt: decim) = 3.377e-02 S  per =  2.1  per(accum) = 61.2
 T(sweep opt: guess) = 1.589e-03 S  per = 0.0989  per(accum) = 61.3
 T(sweep opt: renrm) = 5.637e-01 S  per = 35.1  per(accum) = 96.4
 T(sweep opt: save ) = 5.791e-02 S  per =  3.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.308e-01 S  T(sum) = 8.155e-01 S  per = 9.816e+01
 T(sweep opt: preprocess                  ) = 1.982e-03 S  per = 0.243  per(accum) = 0.243
 T(sweep opt: symbolic_formulae           ) = 2.403e-02 S  per = 2.95  per(accum) = 3.19
 T(sweep opt: hintermediate init          ) = 1.732e-03 S  per = 0.212  per(accum) = 3.4
 T(sweep opt: preprocess_hformulae_Hxlist ) = 8.570e-02 S  per = 10.5  per(accum) = 13.9
 T(sweep opt: hmmtasks init               ) = 8.554e-02 S  per = 10.5  per(accum) = 24.4
 T(sweep opt: initial guess for dvdson    ) = 1.741e-04 S  per = 0.0213  per(accum) = 24.4
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 5.877e-01 S  per = 72.1  per(accum) = 96.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.698e-03 S  per = 0.576  per(accum) = 97.1
 T(sweep opt: dvdson [nccl]               ) = 1.007e-02 S  per = 1.23  per(accum) = 98.3
 T(sweep opt: dvdson [mpi]                ) = 8.619e-05 S  per = 0.0106  per(accum) = 98.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.380e-02 S  per = 1.69  per(accum) = 100
Detailed decomposition of T(renrm) = 5.637e-01 S  T(sum) = 5.637e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.620e-03 S  per = 0.287  per(accum) = 0.287
 T(sweep opt: qops init                    ) = 1.435e-02 S  per = 2.55  per(accum) = 2.83
 T(sweep opt: symbolic_formulae_renorm     ) = 1.328e-02 S  per = 2.36  per(accum) = 5.19
 T(sweep opt: allocate qops on gpu         ) = 1.953e-03 S  per = 0.346  per(accum) = 5.54
 T(sweep opt: site memcpy cpu2gpu          ) = 6.764e-04 S  per = 0.12  per(accum) = 5.66
 T(sweep opt: rintermediate init           ) = 1.470e-03 S  per = 0.261  per(accum) = 5.92
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.758e-02 S  per = 4.89  per(accum) = 10.8
 T(sweep opt: rmmtasks init                ) = 3.046e-02 S  per =  5.4  per(accum) = 16.2
 T(sweep opt: qops memset on cpu           ) = 1.378e-06 S  per = 0.000244  per(accum) = 16.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.678e-02 S  per =  8.3  per(accum) = 24.5
 T(sweep opt: deallocate cpu and gpu memory) = 4.215e-03 S  per = 0.748  per(accum) = 25.3
 T(sweep opt: construct opS [ifdists=true] ) = 3.853e-01 S  per = 68.3  per(accum) = 93.6
 T(sweep opt: reduction of opS & opH [nccl]) = 6.956e-04 S  per = 0.123  per(accum) = 93.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.815e-03 S  per = 0.677  per(accum) = 94.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 7.839e-04 S  per = 0.139  per(accum) = 94.5
 T(sweep opt: qops_pool join and erase     ) = 1.856e-02 S  per = 3.29  per(accum) = 97.8
 T(sweep opt: conversion from opAB to opPQ ) = 1.219e-02 S  per = 2.16  per(accum) = 100
##### global opt: 1.607e+00 S #####
 T(global opt: fetch) = 9.378e-02 S  per = 5.84  per(accum) = 5.84
 T(global opt: hdiag) = 2.513e-02 S  per = 1.56  per(accum) = 7.4
 T(global opt: dvdsn) = 8.308e-01 S  per = 51.7  per(accum) = 59.1
 T(global opt: decim) = 3.377e-02 S  per =  2.1  per(accum) = 61.2
 T(global opt: guess) = 1.589e-03 S  per = 0.0989  per(accum) = 61.3
 T(global opt: renrm) = 5.637e-01 S  per = 35.1  per(accum) = 96.4
 T(global opt: save ) = 5.791e-02 S  per =  3.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.308e-01 S  T(sum) = 8.155e-01 S  per = 9.816e+01
 T(global opt: preprocess                  ) = 1.982e-03 S  per = 0.243  per(accum) = 0.243
 T(global opt: symbolic_formulae           ) = 2.403e-02 S  per = 2.95  per(accum) = 3.19
 T(global opt: hintermediate init          ) = 1.732e-03 S  per = 0.212  per(accum) = 3.4
 T(global opt: preprocess_hformulae_Hxlist ) = 8.570e-02 S  per = 10.5  per(accum) = 13.9
 T(global opt: hmmtasks init               ) = 8.554e-02 S  per = 10.5  per(accum) = 24.4
 T(global opt: initial guess for dvdson    ) = 1.741e-04 S  per = 0.0213  per(accum) = 24.4
 T(global opt: dvdson [Hx_batchGPU]        ) = 5.877e-01 S  per = 72.1  per(accum) = 96.5
 T(global opt: dvdson [cpu-gpu]            ) = 4.698e-03 S  per = 0.576  per(accum) = 97.1
 T(global opt: dvdson [nccl]               ) = 1.007e-02 S  per = 1.23  per(accum) = 98.3
 T(global opt: dvdson [mpi]                ) = 8.619e-05 S  per = 0.0106  per(accum) = 98.3
 T(global opt: dvdson [rest part(linalg)]  ) = 1.380e-02 S  per = 1.69  per(accum) = 100
Detailed decomposition of T(renrm) = 5.637e-01 S  T(sum) = 5.637e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.620e-03 S  per = 0.287  per(accum) = 0.287
 T(global opt: qops init                    ) = 1.435e-02 S  per = 2.55  per(accum) = 2.83
 T(global opt: symbolic_formulae_renorm     ) = 1.328e-02 S  per = 2.36  per(accum) = 5.19
 T(global opt: allocate qops on gpu         ) = 1.953e-03 S  per = 0.346  per(accum) = 5.54
 T(global opt: site memcpy cpu2gpu          ) = 6.764e-04 S  per = 0.12  per(accum) = 5.66
 T(global opt: rintermediate init           ) = 1.470e-03 S  per = 0.261  per(accum) = 5.92
 T(global opt: preprocess_formulae_Rlist2   ) = 2.758e-02 S  per = 4.89  per(accum) = 10.8
 T(global opt: rmmtasks init                ) = 3.046e-02 S  per =  5.4  per(accum) = 16.2
 T(global opt: qops memset on cpu           ) = 1.378e-06 S  per = 0.000244  per(accum) = 16.2
 T(global opt: preprocess_renorm_batchGPU   ) = 4.678e-02 S  per =  8.3  per(accum) = 24.5
 T(global opt: deallocate cpu and gpu memory) = 4.215e-03 S  per = 0.748  per(accum) = 25.3
 T(global opt: construct opS [ifdists=true] ) = 3.853e-01 S  per = 68.3  per(accum) = 93.6
 T(global opt: reduction of opS & opH [nccl]) = 6.956e-04 S  per = 0.123  per(accum) = 93.7
 T(global opt: qops memcpy gpu2cpu          ) = 3.815e-03 S  per = 0.677  per(accum) = 94.4
 T(global opt: reduction of opS & opH [mpi] ) = 7.839e-04 S  per = 0.139  per(accum) = 94.5
 T(global opt: qops_pool join and erase     ) = 1.856e-02 S  per = 3.29  per(accum) = 97.8
 T(global opt: conversion from opAB to opPQ ) = 1.219e-02 S  per = 2.16  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-4.495e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=28/seqsize=34 dots=1 dbond=(6,0)-(7,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=13 scratch=./scratch/sweep size=723:5.39e-06GB T(load)=3.09e-04S speed=1.74e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=1704:1.30e-02MB:1.27e-05GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=981:7.48e-03MB:7.31e-06GB
total mem of comb=2833:2.16e-02MB:2.11e-05GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=1.150e-05 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=7,12,1
 suppl= 0 1 2 3 4 16 17
 suppr= 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 18
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(6,0)
 fqop[1]=./scratch/sweep/rop(8,0)
 fqop[2]=./scratch/sweep/cop(7,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:14 S:13 H:1 A:45 B:53 
        dim(bra,ket)=47,47 size(op)=293:2.235e-03MB size(tot)=21552:1.644e-01MB:1.606e-04GB
        per(mem): C:12.5 S:13 H:1.36 A:18.3 B:54.8 
 rqops: oplist=CSHPQ nops=C:24 S:8 H:1 P:61 Q:67 
        dim(bra,ket)=57,57 size(op)=361:0.00275MB size(tot)=36150:0.276MB:0.000269GB
        per(mem): C:17.2 S:5.95 H:0.999 P:23.7 Q:52.2 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=60038:0.458MB:0.000447GB
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.307e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(7,0) fdel=./scratch/sweep/lop(6,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=-1.675e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(47,57,4) nnz=981:7.484e-03MB
qtensor3: wf3 own=1 _data=0x55b2c521e000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=11 dimAll=47
 (10,2):9 (9,1):8 (10,0):8 (11,1):6 (8,2):4 (9,3):4 (11,-1):3 (8,0):2 (11,3):1 (7,3):1 (9,-1):1
 qbond: qcol nsym=12 dimAll=57
 (19,-1):10 (18,0):8 (18,-2):8 (17,-1):6 (20,0):5 (20,-2):5 (19,-3):4 (19,1):4 (17,1):3 (21,-1):2 (17,-3):1 (21,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=33 nblocks=528 size=981:7.484e-03MB
### DIAG TIMING: total=1.186e-03 t1=2.111e-05, t2=1.383e-05, t3=1.286e-05, t4=1.081e-03, t5=1.021e-05, t6=3.873e-05, t7=7.990e-06
duration_diagGPU:1.202e-03
duration_diagreduce:4.500e-08
duration_diagtransform:1.389e-06
----- TIMING FOR symbolic_formulae_onedot with size=528 : 1.100e-03 S -----
rank=0 GPUmem(GB): used=4.473e-04 (oper)=4.473e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=528
 no. of hintermediate operators=259
 no. of coefficients=3108:2.371e-02MB:2.316e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.072e-05 S -----
rank=0 GPUmem(GB): used=4.705e-04 (oper,hinter)=4.473e-04,2.316e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 3.337e-03 S size(H_formulae)=528 size(Hxlst2)=33 T(Hmu/Hxlist)=2.622e-04,3.074e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 4.564e-03 S size(H_formulae)=528 size(Hxlst)=13334 -----
rank=0 GPUmem(GB): used=4.705e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.462e-05 batch[need]=2.593e-02 blksize=90 blksize0=80 batchsize=13334
rank=0 GPUmem(GB): used=2.641e-02 (oper,hinter,dvdson,batch)=4.473e-04,2.316e-05,1.462e-05,2.593e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=981 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=1.014e-04,1.694e-04,2.961e-03,4.008e-04,3.646e-03
 analyze_tgpu[Hx]: ndim=981:7.309e-06GB T(cpu-gpu)=2.396e-05 speed=6.102e-01GB/S T(nccl)=7.740e-05 speed=1.889e-01GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=3.0e-03 t_reduction=4.0e-04 tot=3.5e-03 -----
 sigma[inter] counter=192 t=1.7e-04 per=4.8e+00 cost=4.7e+06 flops=2.8e+10
 sigma[gemm] counter=192 i=0 t=1.9e-06 per=5.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=1 t=1.6e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=192 i=2 t=6.9e-04 per=2.0e+01 cost=2.3e+06 flops=3.3e+09
 sigma[gemm] counter=192 i=3 t=8.8e-04 per=2.5e+01 cost=2.3e+06 flops=2.6e+09
 sigma[gemm] counter=192 i=4 t=6.8e-04 per=1.9e+01 cost=2.6e+06 flops=3.8e+09
 sigma[gemm] counter=192 i=5 t=7.0e-04 per=2.0e+01 cost=2.7e+06 flops=3.9e+09
 sigma[gemm] counter=192 total t=3.0e-03 per=8.4e+01 cost=9.9e+06 flops=3.3e+09
 sigma[red] counter=192 t=4.0e-04 per=1.1e+01 cost=8.9e+05 flops=2.2e+09
----- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=4.7e-01 t_reduction=6.2e-02 tot=5.5e-01 -----
 sigma_tot[inter] counter=192 t=2.6e-02 per=4.7e+00 cost=8.7e+08 flops=3.4e+10
 sigma_tot[gemm] counter=192 i=0 t=4.1e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=1 t=3.8e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=192 i=2 t=1.1e-01 per=2.0e+01 cost=7.9e+08 flops=7.1e+09
 sigma_tot[gemm] counter=192 i=3 t=1.4e-01 per=2.5e+01 cost=7.8e+08 flops=5.6e+09
 sigma_tot[gemm] counter=192 i=4 t=1.1e-01 per=1.9e+01 cost=6.6e+08 flops=6.2e+09
 sigma_tot[gemm] counter=192 i=5 t=1.1e-01 per=1.9e+01 cost=6.7e+08 flops=6.3e+09
 sigma_tot[gemm] counter=192 total t=4.7e-01 per=8.4e+01 cost=2.9e+09 flops=6.2e+09
 sigma_tot[red] counter=192 t=6.2e-02 per=1.1e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=8.5e-06,4.6e-06,1.2e-06,2.8e-06,4.2e-07
settings: ndim=981 neig=1 maxcycle=30 nbuff=4 memory=0.0001GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.544817486309 -1.117e+03  1.987e-02    1     1  3.916e-03 3.916e-03 3.873e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.398e-05,1.661e-04,3.680e-03,4.673e-04,4.395e-03
 analyze_tgpu[Hx]: ndim=981:7.309e-06GB T(cpu-gpu)=2.396e-05 speed=6.102e-01GB/S T(nccl)=5.003e-05 speed=2.922e-01GB/S
----- TIMING FOR sigma : t_inter=1.7e-04 t_gemm=3.7e-03 t_reduction=4.7e-04 tot=4.3e-03 -----
 sigma[inter] counter=193 t=1.7e-04 per=3.8e+00 cost=4.7e+06 flops=2.8e+10
 sigma[gemm] counter=193 i=0 t=2.4e-06 per=5.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=1 t=2.0e-06 per=4.7e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=193 i=2 t=9.0e-04 per=2.1e+01 cost=2.3e+06 flops=2.5e+09
 sigma[gemm] counter=193 i=3 t=1.2e-03 per=2.7e+01 cost=2.3e+06 flops=2.0e+09
 sigma[gemm] counter=193 i=4 t=7.7e-04 per=1.8e+01 cost=2.6e+06 flops=3.3e+09
 sigma[gemm] counter=193 i=5 t=8.5e-04 per=2.0e+01 cost=2.7e+06 flops=3.2e+09
 sigma[gemm] counter=193 total t=3.7e-03 per=8.5e+01 cost=9.9e+06 flops=2.7e+09
 sigma[red] counter=193 t=4.7e-04 per=1.1e+01 cost=8.9e+05 flops=1.9e+09
----- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=4.7e-01 t_reduction=6.3e-02 tot=5.6e-01 -----
 sigma_tot[inter] counter=193 t=2.6e-02 per=4.7e+00 cost=8.8e+08 flops=3.4e+10
 sigma_tot[gemm] counter=193 i=0 t=4.1e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=1 t=3.9e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=193 i=2 t=1.1e-01 per=2.0e+01 cost=8.0e+08 flops=7.1e+09
 sigma_tot[gemm] counter=193 i=3 t=1.4e-01 per=2.5e+01 cost=7.9e+08 flops=5.6e+09
 sigma_tot[gemm] counter=193 i=4 t=1.1e-01 per=1.9e+01 cost=6.6e+08 flops=6.2e+09
 sigma_tot[gemm] counter=193 i=5 t=1.1e-01 per=1.9e+01 cost=6.7e+08 flops=6.3e+09
 sigma_tot[gemm] counter=193 total t=4.7e-01 per=8.4e+01 cost=2.9e+09 flops=6.2e+09
 sigma_tot[red] counter=193 t=6.3e-02 per=1.1e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=5.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.6e-05,2.3e-05,3.1e-06,7.6e-06,4.8e-07
    2   0 -    -116.545249450334 -4.320e-04  3.401e-03    2     2  8.810e-03 4.405e-03 4.324e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.296e-05,1.435e-04,3.675e-03,4.702e-04,4.368e-03
 analyze_tgpu[Hx]: ndim=981:7.309e-06GB T(cpu-gpu)=2.263e-05 speed=6.459e-01GB/S T(nccl)=5.033e-05 speed=2.904e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=3.7e-03 t_reduction=4.7e-04 tot=4.3e-03 -----
 sigma[inter] counter=194 t=1.4e-04 per=3.3e+00 cost=4.7e+06 flops=3.3e+10
 sigma[gemm] counter=194 i=0 t=2.2e-06 per=5.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=1 t=2.1e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=194 i=2 t=8.9e-04 per=2.1e+01 cost=2.3e+06 flops=2.6e+09
 sigma[gemm] counter=194 i=3 t=1.2e-03 per=2.7e+01 cost=2.3e+06 flops=1.9e+09
 sigma[gemm] counter=194 i=4 t=7.6e-04 per=1.8e+01 cost=2.6e+06 flops=3.4e+09
 sigma[gemm] counter=194 i=5 t=8.4e-04 per=2.0e+01 cost=2.7e+06 flops=3.3e+09
 sigma[gemm] counter=194 total t=3.7e-03 per=8.6e+01 cost=9.9e+06 flops=2.7e+09
 sigma[red] counter=194 t=4.7e-04 per=1.1e+01 cost=8.9e+05 flops=1.9e+09
----- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=4.7e-01 t_reduction=6.3e-02 tot=5.6e-01 -----
 sigma_tot[inter] counter=194 t=2.6e-02 per=4.7e+00 cost=8.8e+08 flops=3.4e+10
 sigma_tot[gemm] counter=194 i=0 t=4.2e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=1 t=3.9e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=194 i=2 t=1.1e-01 per=2.0e+01 cost=8.0e+08 flops=7.0e+09
 sigma_tot[gemm] counter=194 i=3 t=1.4e-01 per=2.5e+01 cost=7.9e+08 flops=5.5e+09
 sigma_tot[gemm] counter=194 i=4 t=1.1e-01 per=1.9e+01 cost=6.6e+08 flops=6.1e+09
 sigma_tot[gemm] counter=194 i=5 t=1.1e-01 per=1.9e+01 cost=6.8e+08 flops=6.2e+09
 sigma_tot[gemm] counter=194 total t=4.7e-01 per=8.4e+01 cost=2.9e+09 flops=6.2e+09
 sigma_tot[red] counter=194 t=6.3e-02 per=1.1e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=4.3e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.9e-05,2.2e-06,9.8e-06,4.5e-07
    3   0 -    -116.545266959384 -1.751e-05  1.309e-03    3     3  1.365e-02 4.550e-03 4.469e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.646e-05,1.398e-04,3.577e-03,4.424e-04,4.232e-03
 analyze_tgpu[Hx]: ndim=981:7.309e-06GB T(cpu-gpu)=2.241e-05 speed=6.523e-01GB/S T(nccl)=4.405e-05 speed=3.319e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=3.6e-03 t_reduction=4.4e-04 tot=4.2e-03 -----
 sigma[inter] counter=195 t=1.4e-04 per=3.4e+00 cost=4.7e+06 flops=3.3e+10
 sigma[gemm] counter=195 i=0 t=2.5e-06 per=6.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=1 t=1.9e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=195 i=2 t=8.5e-04 per=2.1e+01 cost=2.3e+06 flops=2.7e+09
 sigma[gemm] counter=195 i=3 t=1.1e-03 per=2.7e+01 cost=2.3e+06 flops=2.0e+09
 sigma[gemm] counter=195 i=4 t=7.6e-04 per=1.8e+01 cost=2.6e+06 flops=3.4e+09
 sigma[gemm] counter=195 i=5 t=8.4e-04 per=2.0e+01 cost=2.7e+06 flops=3.3e+09
 sigma[gemm] counter=195 total t=3.6e-03 per=8.6e+01 cost=9.9e+06 flops=2.8e+09
 sigma[red] counter=195 t=4.4e-04 per=1.1e+01 cost=8.9e+05 flops=2.0e+09
----- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=4.8e-01 t_reduction=6.3e-02 tot=5.7e-01 -----
 sigma_tot[inter] counter=195 t=2.6e-02 per=4.6e+00 cost=8.9e+08 flops=3.4e+10
 sigma_tot[gemm] counter=195 i=0 t=4.2e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=1 t=3.9e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=195 i=2 t=1.1e-01 per=2.0e+01 cost=8.0e+08 flops=7.0e+09
 sigma_tot[gemm] counter=195 i=3 t=1.4e-01 per=2.5e+01 cost=7.9e+08 flops=5.5e+09
 sigma_tot[gemm] counter=195 i=4 t=1.1e-01 per=1.9e+01 cost=6.6e+08 flops=6.1e+09
 sigma_tot[gemm] counter=195 i=5 t=1.1e-01 per=1.9e+01 cost=6.8e+08 flops=6.2e+09
 sigma_tot[gemm] counter=195 total t=4.8e-01 per=8.4e+01 cost=2.9e+09 flops=6.2e+09
 sigma_tot[red] counter=195 t=6.3e-02 per=1.1e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=3.2e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.3e-05,2.0e-06,4.5e-06,4.6e-07
    4   0 -    -116.545269733663 -2.774e-06  5.059e-04    3     4  1.829e-02 4.573e-03 4.496e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.759e-05,1.462e-04,3.616e-03,4.510e-04,4.286e-03
 analyze_tgpu[Hx]: ndim=981:7.309e-06GB T(cpu-gpu)=2.259e-05 speed=6.470e-01GB/S T(nccl)=4.500e-05 speed=3.249e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=3.6e-03 t_reduction=4.5e-04 tot=4.2e-03 -----
 sigma[inter] counter=196 t=1.5e-04 per=3.5e+00 cost=4.7e+06 flops=3.2e+10
 sigma[gemm] counter=196 i=0 t=2.2e-06 per=5.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=1 t=2.0e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=196 i=2 t=9.0e-04 per=2.1e+01 cost=2.3e+06 flops=2.5e+09
 sigma[gemm] counter=196 i=3 t=1.1e-03 per=2.7e+01 cost=2.3e+06 flops=2.0e+09
 sigma[gemm] counter=196 i=4 t=7.7e-04 per=1.8e+01 cost=2.6e+06 flops=3.4e+09
 sigma[gemm] counter=196 i=5 t=8.2e-04 per=2.0e+01 cost=2.7e+06 flops=3.3e+09
 sigma[gemm] counter=196 total t=3.6e-03 per=8.6e+01 cost=9.9e+06 flops=2.7e+09
 sigma[red] counter=196 t=4.5e-04 per=1.1e+01 cost=8.9e+05 flops=2.0e+09
----- TIMING FOR sigma_tot : t_inter=2.6e-02 t_gemm=4.8e-01 t_reduction=6.4e-02 tot=5.7e-01 -----
 sigma_tot[inter] counter=196 t=2.6e-02 per=4.6e+00 cost=8.9e+08 flops=3.4e+10
 sigma_tot[gemm] counter=196 i=0 t=4.2e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=1 t=3.9e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=196 i=2 t=1.2e-01 per=2.0e+01 cost=8.0e+08 flops=7.0e+09
 sigma_tot[gemm] counter=196 i=3 t=1.5e-01 per=2.5e+01 cost=7.9e+08 flops=5.5e+09
 sigma_tot[gemm] counter=196 i=4 t=1.1e-01 per=1.9e+01 cost=6.7e+08 flops=6.1e+09
 sigma_tot[gemm] counter=196 i=5 t=1.1e-01 per=1.9e+01 cost=6.8e+08 flops=6.2e+09
 sigma_tot[gemm] counter=196 total t=4.8e-01 per=8.4e+01 cost=2.9e+09 flops=6.1e+09
 sigma_tot[red] counter=196 t=6.4e-02 per=1.1e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.2e-05,2.1e-06,4.1e-06,4.4e-07
    5   0 -    -116.545270110519 -3.769e-07  1.617e-04    3     5  2.299e-02 4.597e-03 4.523e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.581e-05,1.539e-04,3.621e-03,4.438e-04,4.291e-03
 analyze_tgpu[Hx]: ndim=981:7.309e-06GB T(cpu-gpu)=2.220e-05 speed=6.585e-01GB/S T(nccl)=4.361e-05 speed=3.352e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=3.6e-03 t_reduction=4.4e-04 tot=4.2e-03 -----
 sigma[inter] counter=197 t=1.5e-04 per=3.6e+00 cost=4.7e+06 flops=3.0e+10
 sigma[gemm] counter=197 i=0 t=2.0e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=1 t=2.0e-06 per=4.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=197 i=2 t=8.8e-04 per=2.1e+01 cost=2.3e+06 flops=2.6e+09
 sigma[gemm] counter=197 i=3 t=1.1e-03 per=2.7e+01 cost=2.3e+06 flops=2.0e+09
 sigma[gemm] counter=197 i=4 t=7.6e-04 per=1.8e+01 cost=2.6e+06 flops=3.4e+09
 sigma[gemm] counter=197 i=5 t=8.4e-04 per=2.0e+01 cost=2.7e+06 flops=3.3e+09
 sigma[gemm] counter=197 total t=3.6e-03 per=8.6e+01 cost=9.9e+06 flops=2.7e+09
 sigma[red] counter=197 t=4.4e-04 per=1.1e+01 cost=8.9e+05 flops=2.0e+09
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=4.8e-01 t_reduction=6.4e-02 tot=5.8e-01 -----
 sigma_tot[inter] counter=197 t=2.7e-02 per=4.6e+00 cost=8.9e+08 flops=3.4e+10
 sigma_tot[gemm] counter=197 i=0 t=4.2e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=1 t=3.9e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=197 i=2 t=1.2e-01 per=2.0e+01 cost=8.1e+08 flops=6.9e+09
 sigma_tot[gemm] counter=197 i=3 t=1.5e-01 per=2.5e+01 cost=8.0e+08 flops=5.4e+09
 sigma_tot[gemm] counter=197 i=4 t=1.1e-01 per=1.9e+01 cost=6.7e+08 flops=6.1e+09
 sigma_tot[gemm] counter=197 i=5 t=1.1e-01 per=1.9e+01 cost=6.8e+08 flops=6.2e+09
 sigma_tot[gemm] counter=197 total t=4.8e-01 per=8.4e+01 cost=3.0e+09 flops=6.1e+09
 sigma_tot[red] counter=197 t=6.4e-02 per=1.1e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=3.0e-05 T(gemm/eig/ortho/gemm/axpy)=1.1e-05,1.2e-05,2.1e-06,4.1e-06,4.5e-07
    6   0 +    -116.545270147744 -3.723e-08  5.186e-05    3     6  2.766e-02 4.610e-03 4.536e-03
TIMING FOR Davidson : 2.768e-02  T(cal/comm/rest)=2.722e-02,3.402e-06,4.543e-04
decomposed t_rest=4.543e-04
 T(sub)    =2.027e-04 per=4.463e+01
 T(precond)=2.595e-05 per=5.713e+00
 T(ortho)  =1.850e-05 per=4.073e+00
 T(xcopy)  =2.637e-06 per=5.805e-01
 T(xnrm2)  =3.584e-06 per=7.890e-01
 T(other)  =2.009e-04 per=4.422e+01
optimized energies: isweep=0 ibond=28 dots=1 e[0]=-116.545270147744 nmvp=6
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=5.692e-03 change=3.349e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=22 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond28.txt
 qbond: qsuper nsym=22 dimAll=228
 (19,-1):32 (18,0):17 (18,-2):15 (17,-1):6 (20,0):27 (20,-2):27 (19,-3):13 (19,1):15 (17,1):3 (21,-1):22 (17,-3):1 (21,-3):10 (22,0):7 (22,-2):8 (21,1):9 (23,-1):2 (23,-3):1 (20,2):4 (18,2):3 (20,-4):4 (18,-4):1 (22,-4):1
timing for divide=3.7e-06
timing for compute=1.9e-04
timing for collect=1.5e-05
----- TMING FOR decimation_genbasis(nkr): 2.1e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.7e-06,1.9e-04,0.0e+00,3.6e-06,1.5e-05 -----
decimation summary: 228->47 dwt=-2.220e-16 SvN=1.967e+00
 qbond: qkept nsym=11 dimAll=47
 (20,-2):9 (20,0):8 (21,-1):8 (19,-1):6 (21,-3):4 (22,-2):4 (19,1):3 (22,0):2 (19,-3):1 (21,1):1 (23,-3):1
----- TIMING for decimation_row(nkr): 1.354e-03 S T(decim/select/formRot)=2.667e-04,1.056e-03,3.151e-05 -----
----- TIMING FOR onedot_decimation: 1.416e-03 S T(wf/decim)=4.143e-05,1.374e-03 -----
ctns::oper_renorm coord=(7,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:26 S:7 H:1 P:45 Q:53 
        dim(bra,ket)=47,47 size(op)=293:2.235e-03MB size(tot)=22566:1.722e-01MB:1.681e-04GB
        per(mem): C:22.2 S:6.7 H:1.3 P:17.5 Q:52.3 
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=5.608e-03 change=2.747e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=125 : 1.316e-03 S -----
rank=0 GPUmem(GB): used=4.780e-04 (oper)=4.549e-04
rank=0 GPUmem(GB): used=4.853e-04 (oper,site)=4.549e-04,7.309e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=125
 no. of rintermediate operators=231
 no. of coefficients=2772:2.115e-02MB:2.065e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 7.767e-05 S -----
rank=0 GPUmem(GB): used=5.060e-04 (oper,site,rinter)=4.549e-04,7.309e-06,2.065e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.872e-03 S size(rtasks)=125 size(Rlst2)=121 T(Rmu/Rlist)=2.539e-04,1.618e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.518e-03 S size(rtasks)=125 size(Rlst)=6413 -----
rank=0 GPUmem(GB): used=5.060e-04 avail=3.829e+01 total=3.829e+01 batch[need]=1.247e-02 blksize=90 blksize0=80 batchsize=6413
rank=0 GPUmem(GB): used=1.298e-02 (oper,site,rinter,batch)=4.549e-04,7.309e-06,2.065e-05,1.247e-02
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.383e-04,1.986e-03,2.976e-04
----- TIMING FOR renorm : t_inter=1.4e-04 t_gemm=2.0e-03 t_reduction=3.0e-04 tot=2.4e-03 -----
 renorm[inter] counter=653 t=1.4e-04 per=5.7e+00 cost=2.1e+06 flops=1.5e+10
 renorm[gemm] counter=653 i=0 t=1.8e-06 per=7.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=653 i=1 t=1.6e-06 per=6.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=653 i=2 t=4.2e-04 per=1.8e+01 cost=7.4e+05 flops=1.7e+09
 renorm[gemm] counter=653 i=3 t=7.1e-04 per=2.9e+01 cost=1.4e+06 flops=2.0e+09
 renorm[gemm] counter=653 i=4 t=1.6e-06 per=6.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=653 i=5 t=1.6e-06 per=6.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=653 i=6 t=8.4e-04 per=3.5e+01 cost=2.7e+06 flops=3.2e+09
 renorm[gemm] counter=653 total t=2.0e-03 per=8.2e+01 cost=4.9e+06 flops=2.5e+09
 renorm[red] counter=653 t=3.0e-04 per=1.2e+01 cost=4.2e+05 flops=1.4e+09
----- TIMING FOR renorm_tot : t_inter=3.8e-03 t_gemm=3.4e-02 t_reduction=7.6e-03 tot=4.5e-02 -----
 renorm_tot[inter] counter=653 t=3.8e-03 per=8.5e+00 cost=3.0e+07 flops=7.9e+09
 renorm_tot[gemm] counter=653 i=0 t=6.0e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=653 i=1 t=5.3e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=653 i=2 t=3.6e-03 per=8.1e+00 cost=6.5e+06 flops=1.8e+09
 renorm_tot[gemm] counter=653 i=3 t=6.4e-03 per=1.4e+01 cost=2.1e+07 flops=3.3e+09
 renorm_tot[gemm] counter=653 i=4 t=4.6e-03 per=1.0e+01 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=653 i=5 t=6.5e-03 per=1.4e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=653 i=6 t=1.2e-02 per=2.7e+01 cost=7.4e+07 flops=6.0e+09
 renorm_tot[gemm] counter=653 total t=3.4e-02 per=7.5e+01 cost=1.4e+08 flops=4.1e+09
 renorm_tot[red] counter=653 t=7.6e-03 per=1.7e+01 cost=8.8e+06 flops=1.2e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=5.028e-04 (oper)=4.565e-04
rank=0 GPUmem(GB): used=5.101e-04 (oper,site,rinter)=4.565e-04,7.309e-06,2.503e-06
rank=0 GPUmem(GB): used=6.773e-04 (oper,site,rinter,batch)=4.565e-04,7.309e-06,2.503e-06,1.672e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 9.242e-03 S T(preprocess/alloc/comp/red/dealloc)=8.410e-04,9.010e-04,6.364e-03,1.877e-03,7.397e-05 -----
----- TIMING FOR oper_renorm_opS : 9.276e-03 S rank=0 -----
qops.to_cpu: size(tot)=22566:1.722e-01MB:1.681e-04GB T(to_cpu)=9.062e-05S speed=1.855e+00GB/S
check ||H-H.dagger||=2.731e-14 coord=(7,0) rank=0
----- TIMING FOR oper_renorm : 0.0192 S rank=0 -----
rank=0 CPUmem(GB): used=1.352e+00 pageheap_free=5.875e-03 change=1.902e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=9.956e-03 change=-3.502e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=9.956e-03 change=-1.103e-05 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 6.824e-02 S #####
 T(local opt: fetch) = 3.462e-03 S  per = 5.07  per(accum) = 5.07
 T(local opt: hdiag) = 1.277e-03 S  per = 1.87  per(accum) = 6.95
 T(local opt: dvdsn) = 3.996e-02 S  per = 58.6  per(accum) = 65.5
 T(local opt: decim) = 1.461e-03 S  per = 2.14  per(accum) = 67.6
 T(local opt: guess) = 6.537e-05 S  per = 0.0958  per(accum) = 67.7
 T(local opt: renrm) = 2.001e-02 S  per = 29.3  per(accum) = 97.1
 T(local opt: save ) = 1.997e-03 S  per = 2.93  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.996e-02 S  T(sum) = 3.920e-02 S  per = 9.809e+01
 T(local opt: preprocess                  ) = 1.024e-04 S  per = 0.261  per(accum) = 0.261
 T(local opt: symbolic_formulae           ) = 1.112e-03 S  per = 2.84  per(accum) = 3.1
 T(local opt: hintermediate init          ) = 8.561e-05 S  per = 0.218  per(accum) = 3.32
 T(local opt: preprocess_hformulae_Hxlist ) = 4.727e-03 S  per = 12.1  per(accum) = 15.4
 T(local opt: hmmtasks init               ) = 5.487e-03 S  per =   14  per(accum) = 29.4
 T(local opt: initial guess for dvdson    ) = 6.382e-06 S  per = 0.0163  per(accum) = 29.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.677e-02 S  per = 68.3  per(accum) = 97.7
 T(local opt: dvdson [cpu-gpu]            ) = 1.377e-04 S  per = 0.351  per(accum) = 98
 T(local opt: dvdson [nccl]               ) = 3.104e-04 S  per = 0.792  per(accum) = 98.8
 T(local opt: dvdson [mpi]                ) = 3.402e-06 S  per = 0.00868  per(accum) = 98.8
 T(local opt: dvdson [rest part(linalg)]  ) = 4.543e-04 S  per = 1.16  per(accum) = 100
Detailed decomposition of T(renrm) = 2.001e-02 S  T(sum) = 2.001e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.259e-05 S  per = 0.313  per(accum) = 0.313
 T(local opt: qops init                    ) = 6.462e-04 S  per = 3.23  per(accum) = 3.54
 T(local opt: symbolic_formulae_renorm     ) = 1.331e-03 S  per = 6.65  per(accum) = 10.2
 T(local opt: allocate qops on gpu         ) = 6.021e-05 S  per = 0.301  per(accum) = 10.5
 T(local opt: site memcpy cpu2gpu          ) = 2.814e-05 S  per = 0.141  per(accum) = 10.6
 T(local opt: rintermediate init           ) = 9.286e-05 S  per = 0.464  per(accum) = 11.1
 T(local opt: preprocess_formulae_Rlist2   ) = 2.554e-03 S  per = 12.8  per(accum) = 23.9
 T(local opt: rmmtasks init                ) = 2.048e-03 S  per = 10.2  per(accum) = 34.1
 T(local opt: qops memset on cpu           ) = 7.900e-08 S  per = 0.000395  per(accum) = 34.1
 T(local opt: preprocess_renorm_batchGPU   ) = 2.693e-03 S  per = 13.5  per(accum) = 47.6
 T(local opt: deallocate cpu and gpu memory) = 2.560e-04 S  per = 1.28  per(accum) = 48.8
 T(local opt: construct opS [ifdists=true] ) = 9.337e-03 S  per = 46.7  per(accum) = 95.5
 T(local opt: reduction of opS & opH [nccl]) = 1.937e-05 S  per = 0.0968  per(accum) = 95.6
 T(local opt: qops memcpy gpu2cpu          ) = 1.020e-04 S  per = 0.51  per(accum) = 96.1
 T(local opt: reduction of opS & opH [mpi] ) = 1.388e-05 S  per = 0.0694  per(accum) = 96.2
 T(local opt: qops_pool join and erase     ) = 7.666e-04 S  per = 3.83  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 9.180e-07 S  per = 0.00459  per(accum) = 100
ctns::rcanon_save_site idx=12 scratch=./scratch/sweep size=981:7.3e-06GB T(load)=0.00059S speed=0.012GB/S
##### sweep opt: 1.675e+00 S #####
 T(sweep opt: fetch) = 9.724e-02 S  per = 5.81  per(accum) = 5.81
 T(sweep opt: hdiag) = 2.640e-02 S  per = 1.58  per(accum) = 7.38
 T(sweep opt: dvdsn) = 8.708e-01 S  per =   52  per(accum) = 59.4
 T(sweep opt: decim) = 3.523e-02 S  per =  2.1  per(accum) = 61.5
 T(sweep opt: guess) = 1.654e-03 S  per = 0.0988  per(accum) = 61.6
 T(sweep opt: renrm) = 5.837e-01 S  per = 34.9  per(accum) = 96.4
 T(sweep opt: save ) = 5.991e-02 S  per = 3.58  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.708e-01 S  T(sum) = 8.547e-01 S  per = 9.816e+01
 T(sweep opt: preprocess                  ) = 2.084e-03 S  per = 0.244  per(accum) = 0.244
 T(sweep opt: symbolic_formulae           ) = 2.514e-02 S  per = 2.94  per(accum) = 3.19
 T(sweep opt: hintermediate init          ) = 1.818e-03 S  per = 0.213  per(accum) = 3.4
 T(sweep opt: preprocess_hformulae_Hxlist ) = 9.043e-02 S  per = 10.6  per(accum) = 14
 T(sweep opt: hmmtasks init               ) = 9.103e-02 S  per = 10.6  per(accum) = 24.6
 T(sweep opt: initial guess for dvdson    ) = 1.804e-04 S  per = 0.0211  per(accum) = 24.6
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.145e-01 S  per = 71.9  per(accum) = 96.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.836e-03 S  per = 0.566  per(accum) = 97.1
 T(sweep opt: dvdson [nccl]               ) = 1.038e-02 S  per = 1.21  per(accum) = 98.3
 T(sweep opt: dvdson [mpi]                ) = 8.959e-05 S  per = 0.0105  per(accum) = 98.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.425e-02 S  per = 1.67  per(accum) = 100
Detailed decomposition of T(renrm) = 5.837e-01 S  T(sum) = 5.837e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.683e-03 S  per = 0.288  per(accum) = 0.288
 T(sweep opt: qops init                    ) = 1.499e-02 S  per = 2.57  per(accum) = 2.86
 T(sweep opt: symbolic_formulae_renorm     ) = 1.461e-02 S  per =  2.5  per(accum) = 5.36
 T(sweep opt: allocate qops on gpu         ) = 2.013e-03 S  per = 0.345  per(accum) = 5.71
 T(sweep opt: site memcpy cpu2gpu          ) = 7.045e-04 S  per = 0.121  per(accum) = 5.83
 T(sweep opt: rintermediate init           ) = 1.563e-03 S  per = 0.268  per(accum) = 6.09
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.013e-02 S  per = 5.16  per(accum) = 11.3
 T(sweep opt: rmmtasks init                ) = 3.250e-02 S  per = 5.57  per(accum) = 16.8
 T(sweep opt: qops memset on cpu           ) = 1.457e-06 S  per = 0.00025  per(accum) = 16.8
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.948e-02 S  per = 8.48  per(accum) = 25.3
 T(sweep opt: deallocate cpu and gpu memory) = 4.472e-03 S  per = 0.766  per(accum) = 26.1
 T(sweep opt: construct opS [ifdists=true] ) = 3.946e-01 S  per = 67.6  per(accum) = 93.7
 T(sweep opt: reduction of opS & opH [nccl]) = 7.150e-04 S  per = 0.122  per(accum) = 93.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.917e-03 S  per = 0.671  per(accum) = 94.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 7.978e-04 S  per = 0.137  per(accum) = 94.6
 T(sweep opt: qops_pool join and erase     ) = 1.932e-02 S  per = 3.31  per(accum) = 97.9
 T(sweep opt: conversion from opAB to opPQ ) = 1.219e-02 S  per = 2.09  per(accum) = 100
##### global opt: 1.675e+00 S #####
 T(global opt: fetch) = 9.724e-02 S  per = 5.81  per(accum) = 5.81
 T(global opt: hdiag) = 2.640e-02 S  per = 1.58  per(accum) = 7.38
 T(global opt: dvdsn) = 8.708e-01 S  per =   52  per(accum) = 59.4
 T(global opt: decim) = 3.523e-02 S  per =  2.1  per(accum) = 61.5
 T(global opt: guess) = 1.654e-03 S  per = 0.0988  per(accum) = 61.6
 T(global opt: renrm) = 5.837e-01 S  per = 34.9  per(accum) = 96.4
 T(global opt: save ) = 5.991e-02 S  per = 3.58  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.708e-01 S  T(sum) = 8.547e-01 S  per = 9.816e+01
 T(global opt: preprocess                  ) = 2.084e-03 S  per = 0.244  per(accum) = 0.244
 T(global opt: symbolic_formulae           ) = 2.514e-02 S  per = 2.94  per(accum) = 3.19
 T(global opt: hintermediate init          ) = 1.818e-03 S  per = 0.213  per(accum) = 3.4
 T(global opt: preprocess_hformulae_Hxlist ) = 9.043e-02 S  per = 10.6  per(accum) = 14
 T(global opt: hmmtasks init               ) = 9.103e-02 S  per = 10.6  per(accum) = 24.6
 T(global opt: initial guess for dvdson    ) = 1.804e-04 S  per = 0.0211  per(accum) = 24.6
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.145e-01 S  per = 71.9  per(accum) = 96.5
 T(global opt: dvdson [cpu-gpu]            ) = 4.836e-03 S  per = 0.566  per(accum) = 97.1
 T(global opt: dvdson [nccl]               ) = 1.038e-02 S  per = 1.21  per(accum) = 98.3
 T(global opt: dvdson [mpi]                ) = 8.959e-05 S  per = 0.0105  per(accum) = 98.3
 T(global opt: dvdson [rest part(linalg)]  ) = 1.425e-02 S  per = 1.67  per(accum) = 100
Detailed decomposition of T(renrm) = 5.837e-01 S  T(sum) = 5.837e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.683e-03 S  per = 0.288  per(accum) = 0.288
 T(global opt: qops init                    ) = 1.499e-02 S  per = 2.57  per(accum) = 2.86
 T(global opt: symbolic_formulae_renorm     ) = 1.461e-02 S  per =  2.5  per(accum) = 5.36
 T(global opt: allocate qops on gpu         ) = 2.013e-03 S  per = 0.345  per(accum) = 5.71
 T(global opt: site memcpy cpu2gpu          ) = 7.045e-04 S  per = 0.121  per(accum) = 5.83
 T(global opt: rintermediate init           ) = 1.563e-03 S  per = 0.268  per(accum) = 6.09
 T(global opt: preprocess_formulae_Rlist2   ) = 3.013e-02 S  per = 5.16  per(accum) = 11.3
 T(global opt: rmmtasks init                ) = 3.250e-02 S  per = 5.57  per(accum) = 16.8
 T(global opt: qops memset on cpu           ) = 1.457e-06 S  per = 0.00025  per(accum) = 16.8
 T(global opt: preprocess_renorm_batchGPU   ) = 4.948e-02 S  per = 8.48  per(accum) = 25.3
 T(global opt: deallocate cpu and gpu memory) = 4.472e-03 S  per = 0.766  per(accum) = 26.1
 T(global opt: construct opS [ifdists=true] ) = 3.946e-01 S  per = 67.6  per(accum) = 93.7
 T(global opt: reduction of opS & opH [nccl]) = 7.150e-04 S  per = 0.122  per(accum) = 93.8
 T(global opt: qops memcpy gpu2cpu          ) = 3.917e-03 S  per = 0.671  per(accum) = 94.5
 T(global opt: reduction of opS & opH [mpi] ) = 7.978e-04 S  per = 0.137  per(accum) = 94.6
 T(global opt: qops_pool join and erase     ) = 1.932e-02 S  per = 3.31  per(accum) = 97.9
 T(global opt: conversion from opAB to opPQ ) = 1.219e-02 S  per = 2.09  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-3.356e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=29/seqsize=34 dots=1 dbond=(5,0)-(6,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=14 scratch=./scratch/sweep size=478:3.56e-06GB T(load)=3.11e-04S speed=1.15e-02GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=1201:9.16e-03MB:8.95e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=723:5.52e-03MB:5.39e-06GB
total mem of comb=2072:1.58e-02MB:1.54e-05GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=7.287e-06 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=6,13,1
 suppl= 0 1 2 3 4 16
 suppr= 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 17
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(5,0)
 fqop[1]=./scratch/sweep/rop(7,0)
 fqop[2]=./scratch/sweep/cop(6,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:12 S:14 H:1 A:34 B:38 
        dim(bra,ket)=38,38 size(op)=208:1.587e-03MB size(tot)=11581:8.836e-02MB:8.629e-05GB
        per(mem): C:13.5 S:18.9 H:1.8 A:16.1 B:49.8 
 rqops: oplist=CSHPQ nops=C:26 S:7 H:1 P:45 Q:53 
        dim(bra,ket)=47,47 size(op)=293:0.00224MB size(tot)=22566:0.172MB:0.000168GB
        per(mem): C:22.2 S:6.7 H:1.3 P:17.5 Q:52.3 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=36483:0.278MB:0.000272GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.151e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(6,0) fdel=./scratch/sweep/lop(5,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-9.120e-05 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(38,47,4) nnz=723:5.516e-03MB
qtensor3: wf3 own=1 _data=0x55b2b887b800
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=10 dimAll=38
 (8,2):8 (9,1):8 (9,3):6 (7,3):4 (10,2):3 (10,0):3 (8,4):2 (7,1):2 (6,4):1 (8,0):1
 qbond: qcol nsym=11 dimAll=47
 (20,-2):9 (20,0):8 (21,-1):8 (19,-1):6 (21,-3):4 (22,-2):4 (19,1):3 (22,0):2 (19,-3):1 (21,1):1 (23,-3):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=29 nblocks=440 size=723:5.516e-03MB
### DIAG TIMING: total=8.441e-04 t1=1.959e-05, t2=1.412e-05, t3=1.275e-05, t4=7.423e-04, t5=1.039e-05, t6=3.753e-05, t7=7.438e-06
duration_diagGPU:8.517e-04
duration_diagreduce:2.800e-08
duration_diagtransform:8.680e-07
----- TIMING FOR symbolic_formulae_onedot with size=405 : 8.940e-04 S -----
rank=0 GPUmem(GB): used=2.718e-04 (oper)=2.718e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=405
 no. of hintermediate operators=192
 no. of coefficients=2496:1.904e-02MB:1.860e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.247e-05 S -----
rank=0 GPUmem(GB): used=2.904e-04 (oper,hinter)=2.718e-04,1.860e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.049e-03 S size(H_formulae)=405 size(Hxlst2)=29 T(Hmu/Hxlist)=1.756e-04,1.873e-03 -----
----- TIMING FOR preprocess_formulae_Hxlist : 2.798e-03 S size(H_formulae)=405 size(Hxlst)=8480 -----
rank=0 GPUmem(GB): used=2.904e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.077e-05 batch[need]=1.371e-02 blksize=72 blksize0=72 batchsize=8480
rank=0 GPUmem(GB): used=1.401e-02 (oper,hinter,dvdson,batch)=2.718e-04,1.860e-05,1.077e-05,1.371e-02
ctns::pdvdsonSolver_nkr::solve_iter ndim=723 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.196e-05,1.517e-04,2.169e-03,3.417e-04,2.746e-03
 analyze_tgpu[Hx]: ndim=723:5.387e-06GB T(cpu-gpu)=2.321e-05 speed=4.643e-01GB/S T(nccl)=4.876e-05 speed=2.210e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=2.2e-03 t_reduction=3.4e-04 tot=2.7e-03 -----
 sigma[inter] counter=198 t=1.5e-04 per=5.7e+00 cost=3.0e+06 flops=2.0e+10
 sigma[gemm] counter=198 i=0 t=2.5e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=1 t=2.0e-06 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=198 i=2 t=5.6e-04 per=2.1e+01 cost=1.2e+06 flops=2.2e+09
 sigma[gemm] counter=198 i=3 t=6.7e-04 per=2.5e+01 cost=1.2e+06 flops=1.8e+09
 sigma[gemm] counter=198 i=4 t=4.5e-04 per=1.7e+01 cost=1.2e+06 flops=2.7e+09
 sigma[gemm] counter=198 i=5 t=4.9e-04 per=1.8e+01 cost=1.2e+06 flops=2.5e+09
 sigma[gemm] counter=198 total t=2.2e-03 per=8.1e+01 cost=4.9e+06 flops=2.3e+09
 sigma[red] counter=198 t=3.4e-04 per=1.3e+01 cost=4.8e+05 flops=1.4e+09
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=4.9e-01 t_reduction=6.5e-02 tot=5.8e-01 -----
 sigma_tot[inter] counter=198 t=2.7e-02 per=4.6e+00 cost=9.0e+08 flops=3.4e+10
 sigma_tot[gemm] counter=198 i=0 t=4.3e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=1 t=4.0e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=198 i=2 t=1.2e-01 per=2.0e+01 cost=8.1e+08 flops=6.9e+09
 sigma_tot[gemm] counter=198 i=3 t=1.5e-01 per=2.5e+01 cost=8.0e+08 flops=5.4e+09
 sigma_tot[gemm] counter=198 i=4 t=1.1e-01 per=1.9e+01 cost=6.7e+08 flops=6.1e+09
 sigma_tot[gemm] counter=198 i=5 t=1.1e-01 per=1.9e+01 cost=6.8e+08 flops=6.1e+09
 sigma_tot[gemm] counter=198 total t=4.9e-01 per=8.4e+01 cost=3.0e+09 flops=6.1e+09
 sigma_tot[red] counter=198 t=6.5e-02 per=1.1e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=1.4e-05 T(gemm/eig/ortho/gemm/axpy)=6.3e-06,4.0e-06,1.1e-06,2.5e-06,3.7e-07
settings: ndim=723 neig=1 maxcycle=30 nbuff=4 memory=8e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.545270147744 -1.117e+03  1.703e-02    1     1  3.154e-03 3.154e-03 3.072e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.425e-05,1.443e-04,2.736e-03,3.913e-04,3.353e-03
 analyze_tgpu[Hx]: ndim=723:5.387e-06GB T(cpu-gpu)=2.219e-05 speed=4.854e-01GB/S T(nccl)=5.206e-05 speed=2.070e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=2.7e-03 t_reduction=3.9e-04 tot=3.3e-03 -----
 sigma[inter] counter=199 t=1.4e-04 per=4.4e+00 cost=3.0e+06 flops=2.1e+10
 sigma[gemm] counter=199 i=0 t=2.0e-06 per=6.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=1 t=1.9e-06 per=5.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=199 i=2 t=6.8e-04 per=2.1e+01 cost=1.2e+06 flops=1.8e+09
 sigma[gemm] counter=199 i=3 t=8.9e-04 per=2.7e+01 cost=1.2e+06 flops=1.4e+09
 sigma[gemm] counter=199 i=4 t=5.6e-04 per=1.7e+01 cost=1.2e+06 flops=2.2e+09
 sigma[gemm] counter=199 i=5 t=6.0e-04 per=1.8e+01 cost=1.2e+06 flops=2.1e+09
 sigma[gemm] counter=199 total t=2.7e-03 per=8.4e+01 cost=4.9e+06 flops=1.8e+09
 sigma[red] counter=199 t=3.9e-04 per=1.2e+01 cost=4.8e+05 flops=1.2e+09
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=4.9e-01 t_reduction=6.5e-02 tot=5.8e-01 -----
 sigma_tot[inter] counter=199 t=2.7e-02 per=4.6e+00 cost=9.0e+08 flops=3.3e+10
 sigma_tot[gemm] counter=199 i=0 t=4.3e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=1 t=4.0e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=199 i=2 t=1.2e-01 per=2.0e+01 cost=8.1e+08 flops=6.9e+09
 sigma_tot[gemm] counter=199 i=3 t=1.5e-01 per=2.5e+01 cost=8.0e+08 flops=5.4e+09
 sigma_tot[gemm] counter=199 i=4 t=1.1e-01 per=1.9e+01 cost=6.7e+08 flops=6.0e+09
 sigma_tot[gemm] counter=199 i=5 t=1.1e-01 per=1.9e+01 cost=6.9e+08 flops=6.1e+09
 sigma_tot[gemm] counter=199 total t=4.9e-01 per=8.4e+01 cost=3.0e+09 flops=6.1e+09
 sigma_tot[red] counter=199 t=6.5e-02 per=1.1e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=3.6e-05 T(gemm/eig/ortho/gemm/axpy)=1.2e-05,1.7e-05,3.1e-06,3.2e-06,4.3e-07
    2   0 -    -116.545595627270 -3.255e-04  3.204e-03    2     2  6.940e-03 3.470e-03 3.384e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.661e-05,1.477e-04,2.740e-03,3.898e-04,3.351e-03
 analyze_tgpu[Hx]: ndim=723:5.387e-06GB T(cpu-gpu)=2.291e-05 speed=4.703e-01GB/S T(nccl)=4.370e-05 speed=2.465e-01GB/S
----- TIMING FOR sigma : t_inter=1.5e-04 t_gemm=2.7e-03 t_reduction=3.9e-04 tot=3.3e-03 -----
 sigma[inter] counter=200 t=1.5e-04 per=4.5e+00 cost=3.0e+06 flops=2.1e+10
 sigma[gemm] counter=200 i=0 t=2.8e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=1 t=2.0e-06 per=6.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=200 i=2 t=7.3e-04 per=2.2e+01 cost=1.2e+06 flops=1.7e+09
 sigma[gemm] counter=200 i=3 t=8.5e-04 per=2.6e+01 cost=1.2e+06 flops=1.4e+09
 sigma[gemm] counter=200 i=4 t=5.7e-04 per=1.7e+01 cost=1.2e+06 flops=2.1e+09
 sigma[gemm] counter=200 i=5 t=5.9e-04 per=1.8e+01 cost=1.2e+06 flops=2.1e+09
 sigma[gemm] counter=200 total t=2.7e-03 per=8.4e+01 cost=4.9e+06 flops=1.8e+09
 sigma[red] counter=200 t=3.9e-04 per=1.2e+01 cost=4.8e+05 flops=1.2e+09
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=4.9e-01 t_reduction=6.5e-02 tot=5.8e-01 -----
 sigma_tot[inter] counter=200 t=2.7e-02 per=4.6e+00 cost=9.0e+08 flops=3.3e+10
 sigma_tot[gemm] counter=200 i=0 t=4.3e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=1 t=4.0e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=200 i=2 t=1.2e-01 per=2.0e+01 cost=8.1e+08 flops=6.8e+09
 sigma_tot[gemm] counter=200 i=3 t=1.5e-01 per=2.5e+01 cost=8.0e+08 flops=5.4e+09
 sigma_tot[gemm] counter=200 i=4 t=1.1e-01 per=1.9e+01 cost=6.7e+08 flops=6.0e+09
 sigma_tot[gemm] counter=200 i=5 t=1.1e-01 per=1.9e+01 cost=6.9e+08 flops=6.1e+09
 sigma_tot[gemm] counter=200 total t=4.9e-01 per=8.4e+01 cost=3.0e+09 flops=6.0e+09
 sigma_tot[red] counter=200 t=6.5e-02 per=1.1e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=3.5e-05 T(gemm/eig/ortho/gemm/axpy)=1.0e-05,1.9e-05,2.2e-06,3.9e-06,3.9e-07
    3   0 -    -116.545611110588 -1.548e-05  1.106e-03    3     3  1.068e-02 3.561e-03 3.480e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.540e-05,1.397e-04,2.686e-03,3.849e-04,3.282e-03
 analyze_tgpu[Hx]: ndim=723:5.387e-06GB T(cpu-gpu)=2.213e-05 speed=4.868e-01GB/S T(nccl)=4.326e-05 speed=2.490e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=2.7e-03 t_reduction=3.8e-04 tot=3.2e-03 -----
 sigma[inter] counter=201 t=1.4e-04 per=4.3e+00 cost=3.0e+06 flops=2.2e+10
 sigma[gemm] counter=201 i=0 t=2.0e-06 per=6.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=1 t=1.9e-06 per=5.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=201 i=2 t=6.8e-04 per=2.1e+01 cost=1.2e+06 flops=1.8e+09
 sigma[gemm] counter=201 i=3 t=8.5e-04 per=2.6e+01 cost=1.2e+06 flops=1.4e+09
 sigma[gemm] counter=201 i=4 t=5.5e-04 per=1.7e+01 cost=1.2e+06 flops=2.2e+09
 sigma[gemm] counter=201 i=5 t=6.0e-04 per=1.9e+01 cost=1.2e+06 flops=2.1e+09
 sigma[gemm] counter=201 total t=2.7e-03 per=8.4e+01 cost=4.9e+06 flops=1.8e+09
 sigma[red] counter=201 t=3.8e-04 per=1.2e+01 cost=4.8e+05 flops=1.3e+09
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=4.9e-01 t_reduction=6.6e-02 tot=5.9e-01 -----
 sigma_tot[inter] counter=201 t=2.7e-02 per=4.6e+00 cost=9.1e+08 flops=3.3e+10
 sigma_tot[gemm] counter=201 i=0 t=4.3e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=1 t=4.0e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=201 i=2 t=1.2e-01 per=2.0e+01 cost=8.1e+08 flops=6.8e+09
 sigma_tot[gemm] counter=201 i=3 t=1.5e-01 per=2.5e+01 cost=8.0e+08 flops=5.4e+09
 sigma_tot[gemm] counter=201 i=4 t=1.1e-01 per=1.9e+01 cost=6.7e+08 flops=6.0e+09
 sigma_tot[gemm] counter=201 i=5 t=1.1e-01 per=1.9e+01 cost=6.9e+08 flops=6.1e+09
 sigma_tot[gemm] counter=201 total t=4.9e-01 per=8.4e+01 cost=3.0e+09 flops=6.0e+09
 sigma_tot[red] counter=201 t=6.6e-02 per=1.1e+01 cost=1.9e+08 flops=3.0e+09
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=9.6e-06,1.2e-05,2.0e-06,3.4e-06,3.9e-07
    4   0 -    -116.545613218798 -2.108e-06  4.795e-04    3     4  1.428e-02 3.571e-03 3.494e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.052e-05,1.311e-04,2.681e-03,3.865e-04,3.276e-03
 analyze_tgpu[Hx]: ndim=723:5.387e-06GB T(cpu-gpu)=2.250e-05 speed=4.789e-01GB/S T(nccl)=4.803e-05 speed=2.243e-01GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=2.7e-03 t_reduction=3.9e-04 tot=3.2e-03 -----
 sigma[inter] counter=202 t=1.3e-04 per=4.1e+00 cost=3.0e+06 flops=2.3e+10
 sigma[gemm] counter=202 i=0 t=1.9e-06 per=6.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=1 t=1.9e-06 per=5.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=202 i=2 t=6.7e-04 per=2.1e+01 cost=1.2e+06 flops=1.8e+09
 sigma[gemm] counter=202 i=3 t=8.6e-04 per=2.7e+01 cost=1.2e+06 flops=1.4e+09
 sigma[gemm] counter=202 i=4 t=5.6e-04 per=1.7e+01 cost=1.2e+06 flops=2.2e+09
 sigma[gemm] counter=202 i=5 t=5.9e-04 per=1.8e+01 cost=1.2e+06 flops=2.1e+09
 sigma[gemm] counter=202 total t=2.7e-03 per=8.4e+01 cost=4.9e+06 flops=1.8e+09
 sigma[red] counter=202 t=3.9e-04 per=1.2e+01 cost=4.8e+05 flops=1.2e+09
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=5.0e-01 t_reduction=6.6e-02 tot=5.9e-01 -----
 sigma_tot[inter] counter=202 t=2.7e-02 per=4.6e+00 cost=9.1e+08 flops=3.3e+10
 sigma_tot[gemm] counter=202 i=0 t=4.3e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=1 t=4.0e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=202 i=2 t=1.2e-01 per=2.0e+01 cost=8.1e+08 flops=6.8e+09
 sigma_tot[gemm] counter=202 i=3 t=1.5e-01 per=2.5e+01 cost=8.0e+08 flops=5.3e+09
 sigma_tot[gemm] counter=202 i=4 t=1.1e-01 per=1.9e+01 cost=6.8e+08 flops=6.0e+09
 sigma_tot[gemm] counter=202 i=5 t=1.1e-01 per=1.9e+01 cost=6.9e+08 flops=6.1e+09
 sigma_tot[gemm] counter=202 total t=5.0e-01 per=8.4e+01 cost=3.0e+09 flops=6.0e+09
 sigma_tot[red] counter=202 t=6.6e-02 per=1.1e+01 cost=1.9e+08 flops=2.9e+09
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=8.9e-06,1.3e-05,1.9e-06,3.2e-06,3.6e-07
    5   0 -    -116.545613599543 -3.807e-07  2.103e-04    3     5  1.791e-02 3.581e-03 3.507e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.619e-05,1.357e-04,2.671e-03,3.825e-04,3.261e-03
 analyze_tgpu[Hx]: ndim=723:5.387e-06GB T(cpu-gpu)=2.181e-05 speed=4.941e-01GB/S T(nccl)=4.439e-05 speed=2.427e-01GB/S
----- TIMING FOR sigma : t_inter=1.4e-04 t_gemm=2.7e-03 t_reduction=3.8e-04 tot=3.2e-03 -----
 sigma[inter] counter=203 t=1.4e-04 per=4.3e+00 cost=3.0e+06 flops=2.2e+10
 sigma[gemm] counter=203 i=0 t=1.9e-06 per=6.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=1 t=1.9e-06 per=6.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=203 i=2 t=6.8e-04 per=2.1e+01 cost=1.2e+06 flops=1.8e+09
 sigma[gemm] counter=203 i=3 t=8.5e-04 per=2.7e+01 cost=1.2e+06 flops=1.4e+09
 sigma[gemm] counter=203 i=4 t=5.5e-04 per=1.7e+01 cost=1.2e+06 flops=2.2e+09
 sigma[gemm] counter=203 i=5 t=5.9e-04 per=1.9e+01 cost=1.2e+06 flops=2.1e+09
 sigma[gemm] counter=203 total t=2.7e-03 per=8.4e+01 cost=4.9e+06 flops=1.8e+09
 sigma[red] counter=203 t=3.8e-04 per=1.2e+01 cost=4.8e+05 flops=1.3e+09
----- TIMING FOR sigma_tot : t_inter=2.7e-02 t_gemm=5.0e-01 t_reduction=6.7e-02 tot=5.9e-01 -----
 sigma_tot[inter] counter=203 t=2.7e-02 per=4.6e+00 cost=9.1e+08 flops=3.3e+10
 sigma_tot[gemm] counter=203 i=0 t=4.4e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=1 t=4.1e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=203 i=2 t=1.2e-01 per=2.0e+01 cost=8.1e+08 flops=6.8e+09
 sigma_tot[gemm] counter=203 i=3 t=1.5e-01 per=2.5e+01 cost=8.0e+08 flops=5.3e+09
 sigma_tot[gemm] counter=203 i=4 t=1.1e-01 per=1.9e+01 cost=6.8e+08 flops=6.0e+09
 sigma_tot[gemm] counter=203 i=5 t=1.1e-01 per=1.9e+01 cost=6.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=203 total t=5.0e-01 per=8.4e+01 cost=3.0e+09 flops=6.0e+09
 sigma_tot[red] counter=203 t=6.7e-02 per=1.1e+01 cost=2.0e+08 flops=2.9e+09
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=9.0e-06,1.2e-05,2.1e-06,3.1e-06,3.4e-07
    6   0 +    -116.545613677065 -7.752e-08  8.469e-05    3     6  2.148e-02 3.580e-03 3.508e-03
TIMING FOR Davidson : 2.149e-02  T(cal/comm/rest)=2.105e-02,2.685e-06,4.431e-04
decomposed t_rest=4.431e-04
 T(sub)    =1.670e-04 per=3.770e+01
 T(precond)=2.240e-05 per=5.054e+00
 T(ortho)  =1.568e-05 per=3.539e+00
 T(xcopy)  =2.775e-06 per=6.262e-01
 T(xnrm2)  =2.782e-06 per=6.278e-01
 T(other)  =2.324e-04 per=5.246e+01
optimized energies: isweep=0 ibond=29 dots=1 e[0]=-116.545613677065 nmvp=6
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=3.189e-03 change=2.213e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=21 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond29.txt
 qbond: qsuper nsym=21 dimAll=188
 (20,-2):16 (20,0):17 (21,-1):31 (19,-1):6 (21,-3):14 (22,-2):25 (19,1):3 (22,0):19 (19,-3):1 (21,1):12 (23,-3):9 (23,-1):14 (24,-2):5 (24,0):2 (23,1):3 (25,-3):1 (20,2):3 (22,2):1 (22,-4):4 (20,-4):1 (24,-4):1
timing for divide=3.8e-06
timing for compute=1.4e-04
timing for collect=1.3e-05
----- TMING FOR decimation_genbasis(nkr): 1.6e-04 S T(divide/compute[cpu/gpu/rest]/collect)=3.8e-06,1.4e-04,0.0e+00,5.3e-06,1.3e-05 -----
decimation summary: 188->38 dwt=+0.000e+00 SvN=1.657e+00
 qbond: qkept nsym=10 dimAll=38
 (21,-1):8 (22,-2):8 (21,-3):6 (23,-3):4 (20,-2):3 (20,0):3 (23,-1):2 (22,-4):2 (22,0):1 (24,-4):1
----- TIMING for decimation_row(nkr): 1.169e-03 S T(decim/select/formRot)=2.190e-04,9.217e-04,2.786e-05 -----
----- TIMING FOR onedot_decimation: 1.231e-03 S T(wf/decim)=4.110e-05,1.190e-03 -----
ctns::oper_renorm coord=(6,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:28 S:6 H:1 P:34 Q:38 
        dim(bra,ket)=38,38 size(op)=208:1.587e-03MB size(tot)=12413:9.470e-02MB:9.248e-05GB
        per(mem): C:29.3 S:7.54 H:1.68 P:15 Q:46.4 
rank=0 CPUmem(GB): used=1.349e+00 pageheap_free=3.128e-03 change=1.959e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=101 : 1.020e-03 S -----
rank=0 GPUmem(GB): used=2.966e-04 (oper)=2.780e-04
rank=0 GPUmem(GB): used=3.020e-04 (oper,site)=2.780e-04,5.387e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=101
 no. of rintermediate operators=168
 no. of coefficients=2184:1.666e-02MB:1.627e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.728e-05 S -----
rank=0 GPUmem(GB): used=3.183e-04 (oper,site,rinter)=2.780e-04,5.387e-06,1.627e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 1.218e-03 S size(rtasks)=101 size(Rlst2)=100 T(Rmu/Rlist)=1.735e-04,1.044e-03 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.671e-03 S size(rtasks)=101 size(Rlst)=4109 -----
rank=0 GPUmem(GB): used=3.183e-04 avail=3.829e+01 total=3.829e+01 batch[need]=6.643e-03 blksize=72 blksize0=72 batchsize=4109
rank=0 GPUmem(GB): used=6.962e-03 (oper,site,rinter,batch)=2.780e-04,5.387e-06,1.627e-05,6.643e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.367e-04,1.536e-03,2.668e-04
----- TIMING FOR renorm : t_inter=1.4e-04 t_gemm=1.5e-03 t_reduction=2.7e-04 tot=1.9e-03 -----
 renorm[inter] counter=668 t=1.4e-04 per=7.0e+00 cost=1.4e+06 flops=1.0e+10
 renorm[gemm] counter=668 i=0 t=1.8e-06 per=9.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=668 i=1 t=1.6e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=668 i=2 t=3.6e-04 per=1.9e+01 cost=3.9e+05 flops=1.1e+09
 renorm[gemm] counter=668 i=3 t=5.9e-04 per=3.0e+01 cost=7.7e+05 flops=1.3e+09
 renorm[gemm] counter=668 i=4 t=1.6e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=668 i=5 t=1.6e-06 per=8.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=668 i=6 t=5.7e-04 per=3.0e+01 cost=1.3e+06 flops=2.2e+09
 renorm[gemm] counter=668 total t=1.5e-03 per=7.9e+01 cost=2.4e+06 flops=1.6e+09
 renorm[red] counter=668 t=2.7e-04 per=1.4e+01 cost=2.0e+05 flops=7.4e+08
----- TIMING FOR renorm_tot : t_inter=4.0e-03 t_gemm=3.5e-02 t_reduction=7.9e-03 tot=4.7e-02 -----
 renorm_tot[inter] counter=668 t=4.0e-03 per=8.5e+00 cost=3.2e+07 flops=8.0e+09
 renorm_tot[gemm] counter=668 i=0 t=6.2e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=668 i=1 t=5.5e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=668 i=2 t=4.0e-03 per=8.5e+00 cost=6.9e+06 flops=1.7e+09
 renorm_tot[gemm] counter=668 i=3 t=7.0e-03 per=1.5e+01 cost=2.2e+07 flops=3.2e+09
 renorm_tot[gemm] counter=668 i=4 t=4.6e-03 per=9.8e+00 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=668 i=5 t=6.5e-03 per=1.4e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=668 i=6 t=1.3e-02 per=2.8e+01 cost=7.6e+07 flops=5.9e+09
 renorm_tot[gemm] counter=668 total t=3.5e-02 per=7.5e+01 cost=1.4e+08 flops=3.9e+09
 renorm_tot[red] counter=668 t=7.9e-03 per=1.7e+01 cost=9.0e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.164e-04 (oper)=2.792e-04
rank=0 GPUmem(GB): used=3.218e-04 (oper,site,rinter)=2.792e-04,5.387e-06,2.325e-06
rank=0 GPUmem(GB): used=4.446e-04 (oper,site,rinter,batch)=2.792e-04,5.387e-06,2.325e-06,1.229e-04
----- TIMING FOR preprocess_renorm_batchGPU_opS : 7.132e-03 S T(preprocess/alloc/comp/red/dealloc)=6.869e-04,7.465e-04,5.206e-03,1.088e-03,6.801e-05 -----
----- TIMING FOR oper_renorm_opS : 7.164e-03 S rank=0 -----
qops.to_cpu: size(tot)=12413:9.470e-02MB:9.248e-05GB T(to_cpu)=1.030e-04S speed=8.977e-01GB/S
check ||H-H.dagger||=2.020e-14 coord=(6,0) rank=0
----- TIMING FOR oper_renorm : 0.0149 S rank=0 -----
rank=0 CPUmem(GB): used=1.350e+00 pageheap_free=3.304e-03 change=1.263e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=5.829e-03 change=-2.673e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=5.829e-03 change=-8.717e-06 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 5.264e-02 S #####
 T(local opt: fetch) = 3.202e-03 S  per = 6.08  per(accum) = 6.08
 T(local opt: hdiag) = 8.821e-04 S  per = 1.68  per(accum) = 7.76
 T(local opt: dvdsn) = 2.969e-02 S  per = 56.4  per(accum) = 64.1
 T(local opt: decim) = 1.270e-03 S  per = 2.41  per(accum) = 66.6
 T(local opt: guess) = 5.997e-05 S  per = 0.114  per(accum) = 66.7
 T(local opt: renrm) = 1.558e-02 S  per = 29.6  per(accum) = 96.3
 T(local opt: save ) = 1.962e-03 S  per = 3.73  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.969e-02 S  T(sum) = 2.881e-02 S  per = 9.706e+01
 T(local opt: preprocess                  ) = 7.517e-05 S  per = 0.261  per(accum) = 0.261
 T(local opt: symbolic_formulae           ) = 8.997e-04 S  per = 3.12  per(accum) = 3.38
 T(local opt: hintermediate init          ) = 5.025e-05 S  per = 0.174  per(accum) = 3.56
 T(local opt: preprocess_hformulae_Hxlist ) = 2.834e-03 S  per = 9.83  per(accum) = 13.4
 T(local opt: hmmtasks init               ) = 3.453e-03 S  per =   12  per(accum) = 25.4
 T(local opt: initial guess for dvdson    ) = 6.701e-06 S  per = 0.0233  per(accum) = 25.4
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.063e-02 S  per = 71.6  per(accum) = 97
 T(local opt: dvdson [cpu-gpu]            ) = 1.347e-04 S  per = 0.468  per(accum) = 97.5
 T(local opt: dvdson [nccl]               ) = 2.802e-04 S  per = 0.972  per(accum) = 98.5
 T(local opt: dvdson [mpi]                ) = 2.685e-06 S  per = 0.00932  per(accum) = 98.5
 T(local opt: dvdson [rest part(linalg)]  ) = 4.431e-04 S  per = 1.54  per(accum) = 100
Detailed decomposition of T(renrm) = 1.558e-02 S  T(sum) = 1.558e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.847e-05 S  per = 0.375  per(accum) = 0.375
 T(local opt: qops init                    ) = 4.812e-04 S  per = 3.09  per(accum) = 3.46
 T(local opt: symbolic_formulae_renorm     ) = 1.035e-03 S  per = 6.64  per(accum) = 10.1
 T(local opt: allocate qops on gpu         ) = 5.941e-05 S  per = 0.381  per(accum) = 10.5
 T(local opt: site memcpy cpu2gpu          ) = 2.840e-05 S  per = 0.182  per(accum) = 10.7
 T(local opt: rintermediate init           ) = 7.222e-05 S  per = 0.464  per(accum) = 11.1
 T(local opt: preprocess_formulae_Rlist2   ) = 1.703e-03 S  per = 10.9  per(accum) = 22.1
 T(local opt: rmmtasks init                ) = 1.713e-03 S  per =   11  per(accum) = 33
 T(local opt: qops memset on cpu           ) = 4.600e-08 S  per = 0.000295  per(accum) = 33
 T(local opt: preprocess_renorm_batchGPU   ) = 2.174e-03 S  per =   14  per(accum) = 47
 T(local opt: deallocate cpu and gpu memory) = 2.124e-04 S  per = 1.36  per(accum) = 48.4
 T(local opt: construct opS [ifdists=true] ) = 7.230e-03 S  per = 46.4  per(accum) = 94.8
 T(local opt: reduction of opS & opH [nccl]) = 1.873e-05 S  per = 0.12  per(accum) = 94.9
 T(local opt: qops memcpy gpu2cpu          ) = 1.144e-04 S  per = 0.734  per(accum) = 95.6
 T(local opt: reduction of opS & opH [mpi] ) = 1.141e-05 S  per = 0.0732  per(accum) = 95.7
 T(local opt: qops_pool join and erase     ) = 6.707e-04 S  per =  4.3  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 1.030e-06 S  per = 0.00661  per(accum) = 100
ctns::rcanon_save_site idx=13 scratch=./scratch/sweep size=723:5.4e-06GB T(load)=0.0006S speed=0.0089GB/S
##### sweep opt: 1.728e+00 S #####
 T(sweep opt: fetch) = 1.004e-01 S  per = 5.81  per(accum) = 5.81
 T(sweep opt: hdiag) = 2.728e-02 S  per = 1.58  per(accum) = 7.39
 T(sweep opt: dvdsn) = 9.004e-01 S  per = 52.1  per(accum) = 59.5
 T(sweep opt: decim) = 3.650e-02 S  per = 2.11  per(accum) = 61.6
 T(sweep opt: guess) = 1.714e-03 S  per = 0.0992  per(accum) = 61.7
 T(sweep opt: renrm) = 5.993e-01 S  per = 34.7  per(accum) = 96.4
 T(sweep opt: save ) = 6.187e-02 S  per = 3.58  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.004e-01 S  T(sum) = 8.835e-01 S  per = 9.812e+01
 T(sweep opt: preprocess                  ) = 2.159e-03 S  per = 0.244  per(accum) = 0.244
 T(sweep opt: symbolic_formulae           ) = 2.604e-02 S  per = 2.95  per(accum) = 3.19
 T(sweep opt: hintermediate init          ) = 1.868e-03 S  per = 0.211  per(accum) = 3.4
 T(sweep opt: preprocess_hformulae_Hxlist ) = 9.326e-02 S  per = 10.6  per(accum) = 14
 T(sweep opt: hmmtasks init               ) = 9.448e-02 S  per = 10.7  per(accum) = 24.7
 T(sweep opt: initial guess for dvdson    ) = 1.871e-04 S  per = 0.0212  per(accum) = 24.7
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.351e-01 S  per = 71.9  per(accum) = 96.6
 T(sweep opt: dvdson [cpu-gpu]            ) = 4.971e-03 S  per = 0.563  per(accum) = 97.1
 T(sweep opt: dvdson [nccl]               ) = 1.066e-02 S  per = 1.21  per(accum) = 98.3
 T(sweep opt: dvdson [mpi]                ) = 9.228e-05 S  per = 0.0104  per(accum) = 98.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.470e-02 S  per = 1.66  per(accum) = 100
Detailed decomposition of T(renrm) = 5.993e-01 S  T(sum) = 5.993e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.741e-03 S  per = 0.291  per(accum) = 0.291
 T(sweep opt: qops init                    ) = 1.547e-02 S  per = 2.58  per(accum) = 2.87
 T(sweep opt: symbolic_formulae_renorm     ) = 1.565e-02 S  per = 2.61  per(accum) = 5.48
 T(sweep opt: allocate qops on gpu         ) = 2.073e-03 S  per = 0.346  per(accum) = 5.83
 T(sweep opt: site memcpy cpu2gpu          ) = 7.329e-04 S  per = 0.122  per(accum) = 5.95
 T(sweep opt: rintermediate init           ) = 1.635e-03 S  per = 0.273  per(accum) = 6.22
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.184e-02 S  per = 5.31  per(accum) = 11.5
 T(sweep opt: rmmtasks init                ) = 3.422e-02 S  per = 5.71  per(accum) = 17.2
 T(sweep opt: qops memset on cpu           ) = 1.503e-06 S  per = 0.000251  per(accum) = 17.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.165e-02 S  per = 8.62  per(accum) = 25.9
 T(sweep opt: deallocate cpu and gpu memory) = 4.684e-03 S  per = 0.782  per(accum) = 26.6
 T(sweep opt: construct opS [ifdists=true] ) = 4.019e-01 S  per = 67.1  per(accum) = 93.7
 T(sweep opt: reduction of opS & opH [nccl]) = 7.337e-04 S  per = 0.122  per(accum) = 93.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.031e-03 S  per = 0.673  per(accum) = 94.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 8.092e-04 S  per = 0.135  per(accum) = 94.6
 T(sweep opt: qops_pool join and erase     ) = 1.999e-02 S  per = 3.34  per(accum) = 98
 T(sweep opt: conversion from opAB to opPQ ) = 1.219e-02 S  per = 2.03  per(accum) = 100
##### global opt: 1.728e+00 S #####
 T(global opt: fetch) = 1.004e-01 S  per = 5.81  per(accum) = 5.81
 T(global opt: hdiag) = 2.728e-02 S  per = 1.58  per(accum) = 7.39
 T(global opt: dvdsn) = 9.004e-01 S  per = 52.1  per(accum) = 59.5
 T(global opt: decim) = 3.650e-02 S  per = 2.11  per(accum) = 61.6
 T(global opt: guess) = 1.714e-03 S  per = 0.0992  per(accum) = 61.7
 T(global opt: renrm) = 5.993e-01 S  per = 34.7  per(accum) = 96.4
 T(global opt: save ) = 6.187e-02 S  per = 3.58  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.004e-01 S  T(sum) = 8.835e-01 S  per = 9.812e+01
 T(global opt: preprocess                  ) = 2.159e-03 S  per = 0.244  per(accum) = 0.244
 T(global opt: symbolic_formulae           ) = 2.604e-02 S  per = 2.95  per(accum) = 3.19
 T(global opt: hintermediate init          ) = 1.868e-03 S  per = 0.211  per(accum) = 3.4
 T(global opt: preprocess_hformulae_Hxlist ) = 9.326e-02 S  per = 10.6  per(accum) = 14
 T(global opt: hmmtasks init               ) = 9.448e-02 S  per = 10.7  per(accum) = 24.7
 T(global opt: initial guess for dvdson    ) = 1.871e-04 S  per = 0.0212  per(accum) = 24.7
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.351e-01 S  per = 71.9  per(accum) = 96.6
 T(global opt: dvdson [cpu-gpu]            ) = 4.971e-03 S  per = 0.563  per(accum) = 97.1
 T(global opt: dvdson [nccl]               ) = 1.066e-02 S  per = 1.21  per(accum) = 98.3
 T(global opt: dvdson [mpi]                ) = 9.228e-05 S  per = 0.0104  per(accum) = 98.3
 T(global opt: dvdson [rest part(linalg)]  ) = 1.470e-02 S  per = 1.66  per(accum) = 100
Detailed decomposition of T(renrm) = 5.993e-01 S  T(sum) = 5.993e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.741e-03 S  per = 0.291  per(accum) = 0.291
 T(global opt: qops init                    ) = 1.547e-02 S  per = 2.58  per(accum) = 2.87
 T(global opt: symbolic_formulae_renorm     ) = 1.565e-02 S  per = 2.61  per(accum) = 5.48
 T(global opt: allocate qops on gpu         ) = 2.073e-03 S  per = 0.346  per(accum) = 5.83
 T(global opt: site memcpy cpu2gpu          ) = 7.329e-04 S  per = 0.122  per(accum) = 5.95
 T(global opt: rintermediate init           ) = 1.635e-03 S  per = 0.273  per(accum) = 6.22
 T(global opt: preprocess_formulae_Rlist2   ) = 3.184e-02 S  per = 5.31  per(accum) = 11.5
 T(global opt: rmmtasks init                ) = 3.422e-02 S  per = 5.71  per(accum) = 17.2
 T(global opt: qops memset on cpu           ) = 1.503e-06 S  per = 0.000251  per(accum) = 17.2
 T(global opt: preprocess_renorm_batchGPU   ) = 5.165e-02 S  per = 8.62  per(accum) = 25.9
 T(global opt: deallocate cpu and gpu memory) = 4.684e-03 S  per = 0.782  per(accum) = 26.6
 T(global opt: construct opS [ifdists=true] ) = 4.019e-01 S  per = 67.1  per(accum) = 93.7
 T(global opt: reduction of opS & opH [nccl]) = 7.337e-04 S  per = 0.122  per(accum) = 93.8
 T(global opt: qops memcpy gpu2cpu          ) = 4.031e-03 S  per = 0.673  per(accum) = 94.5
 T(global opt: reduction of opS & opH [mpi] ) = 8.092e-04 S  per = 0.135  per(accum) = 94.6
 T(global opt: qops_pool join and erase     ) = 1.999e-02 S  per = 3.34  per(accum) = 98
 T(global opt: conversion from opAB to opPQ ) = 1.219e-02 S  per = 2.03  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-2.218e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=30/seqsize=34 dots=1 dbond=(4,0)-(5,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=15 scratch=./scratch/sweep size=213:1.59e-06GB T(load)=3.38e-04S speed=4.69e-03GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=691:5.27e-03MB:5.15e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=478:3.65e-03MB:3.56e-06GB
total mem of comb=1317:1.00e-02MB:9.81e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=3.844e-06 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=5,14,1
 suppl= 0 1 2 3 4
 suppr= 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 16
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(4,0)
 fqop[1]=./scratch/sweep/rop(6,0)
 fqop[2]=./scratch/sweep/cop(5,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:10 S:15 H:1 A:22 B:28 
        dim(bra,ket)=27,27 size(op)=159:1.213e-03MB size(tot)=6004:4.581e-02MB:4.473e-05GB
        per(mem): C:12.5 S:31.5 H:2.65 A:10.2 B:43.2 
 rqops: oplist=CSHPQ nops=C:28 S:6 H:1 P:34 Q:38 
        dim(bra,ket)=38,38 size(op)=208:0.00159MB size(tot)=12413:0.0947MB:9.25e-05GB
        per(mem): C:29.3 S:7.54 H:1.68 P:15 Q:46.4 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=20753:0.158MB:0.000155GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.008e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(5,0) fdel=./scratch/sweep/lop(4,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-4.542e-05 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(27,38,4) nnz=478:3.647e-03MB
qtensor3: wf3 own=1 _data=0x55b2c71fb000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=7 dimAll=27
 (8,2):8 (7,3):8 (6,4):4 (9,1):3 (6,2):2 (7,1):1 (5,5):1
 qbond: qcol nsym=10 dimAll=38
 (21,-1):8 (22,-2):8 (21,-3):6 (23,-3):4 (20,-2):3 (20,0):3 (23,-1):2 (22,-4):2 (22,0):1 (24,-4):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=22 nblocks=280 size=478:3.647e-03MB
### DIAG TIMING: total=6.091e-04 t1=1.794e-05, t2=1.379e-05, t3=1.590e-05, t4=4.997e-04, t5=1.285e-05, t6=3.980e-05, t7=9.074e-06
duration_diagGPU:6.270e-04
duration_diagreduce:4.800e-08
duration_diagtransform:6.130e-07
----- TIMING FOR symbolic_formulae_onedot with size=305 : 7.530e-04 S -----
rank=0 GPUmem(GB): used=1.546e-04 (oper)=1.546e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=305
 no. of hintermediate operators=140
 no. of coefficients=1960:1.495e-02MB:1.460e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.011e-05 S -----
rank=0 GPUmem(GB): used=1.692e-04 (oper,hinter)=1.546e-04,1.460e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 1.087e-03 S size(H_formulae)=305 size(Hxlst2)=22 T(Hmu/Hxlist)=1.509e-04,9.357e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 1.486e-03 S size(H_formulae)=305 size(Hxlst)=4660 -----
rank=0 GPUmem(GB): used=1.692e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=7.123e-06 batch[need]=6.701e-03 blksize=64 blksize0=64 batchsize=4660
rank=0 GPUmem(GB): used=6.877e-03 (oper,hinter,dvdson,batch)=1.546e-04,1.460e-05,7.123e-06,6.701e-03
ctns::pdvdsonSolver_nkr::solve_iter ndim=478 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=7.206e-05,1.221e-04,1.586e-03,2.612e-04,2.050e-03
 analyze_tgpu[Hx]: ndim=478:3.561e-06GB T(cpu-gpu)=2.281e-05 speed=3.123e-01GB/S T(nccl)=4.925e-05 speed=1.446e-01GB/S
----- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=1.6e-03 t_reduction=2.6e-04 tot=2.0e-03 -----
 sigma[inter] counter=204 t=1.2e-04 per=6.2e+00 cost=1.3e+06 flops=1.1e+10
 sigma[gemm] counter=204 i=0 t=1.8e-06 per=9.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=1 t=1.6e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=204 i=2 t=4.1e-04 per=2.1e+01 cost=5.0e+05 flops=1.2e+09
 sigma[gemm] counter=204 i=3 t=5.0e-04 per=2.6e+01 cost=4.9e+05 flops=9.8e+08
 sigma[gemm] counter=204 i=4 t=3.2e-04 per=1.6e+01 cost=5.8e+05 flops=1.8e+09
 sigma[gemm] counter=204 i=5 t=3.5e-04 per=1.8e+01 cost=5.8e+05 flops=1.6e+09
 sigma[gemm] counter=204 total t=1.6e-03 per=8.1e+01 cost=2.2e+06 flops=1.4e+09
 sigma[red] counter=204 t=2.6e-04 per=1.3e+01 cost=2.2e+05 flops=8.6e+08
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=5.0e-01 t_reduction=6.7e-02 tot=6.0e-01 -----
 sigma_tot[inter] counter=204 t=2.8e-02 per=4.6e+00 cost=9.1e+08 flops=3.3e+10
 sigma_tot[gemm] counter=204 i=0 t=4.4e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=1 t=4.1e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=204 i=2 t=1.2e-01 per=2.0e+01 cost=8.1e+08 flops=6.7e+09
 sigma_tot[gemm] counter=204 i=3 t=1.5e-01 per=2.5e+01 cost=8.0e+08 flops=5.3e+09
 sigma_tot[gemm] counter=204 i=4 t=1.1e-01 per=1.9e+01 cost=6.8e+08 flops=6.0e+09
 sigma_tot[gemm] counter=204 i=5 t=1.1e-01 per=1.9e+01 cost=6.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=204 total t=5.0e-01 per=8.4e+01 cost=3.0e+09 flops=6.0e+09
 sigma_tot[red] counter=204 t=6.7e-02 per=1.1e+01 cost=2.0e+08 flops=2.9e+09
T(sub)=1.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,3.0e-06,1.0e-06,1.7e-06,2.8e-07
settings: ndim=478 neig=1 maxcycle=30 nbuff=4 memory=5e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.545613677065 -1.117e+03  1.587e-02    1     1  2.287e-03 2.287e-03 2.248e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.747e-05,1.291e-04,1.962e-03,2.982e-04,2.462e-03
 analyze_tgpu[Hx]: ndim=478:3.561e-06GB T(cpu-gpu)=2.198e-05 speed=3.241e-01GB/S T(nccl)=4.549e-05 speed=1.566e-01GB/S
----- TIMING FOR sigma : t_inter=1.3e-04 t_gemm=2.0e-03 t_reduction=3.0e-04 tot=2.4e-03 -----
 sigma[inter] counter=205 t=1.3e-04 per=5.4e+00 cost=1.3e+06 flops=1.0e+10
 sigma[gemm] counter=205 i=0 t=2.0e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=205 i=1 t=1.9e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=205 i=2 t=4.8e-04 per=2.0e+01 cost=5.0e+05 flops=1.0e+09
 sigma[gemm] counter=205 i=3 t=6.6e-04 per=2.8e+01 cost=4.9e+05 flops=7.4e+08
 sigma[gemm] counter=205 i=4 t=4.0e-04 per=1.7e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=205 i=5 t=4.2e-04 per=1.7e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=205 total t=2.0e-03 per=8.2e+01 cost=2.2e+06 flops=1.1e+09
 sigma[red] counter=205 t=3.0e-04 per=1.2e+01 cost=2.2e+05 flops=7.5e+08
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=5.0e-01 t_reduction=6.7e-02 tot=6.0e-01 -----
 sigma_tot[inter] counter=205 t=2.8e-02 per=4.6e+00 cost=9.2e+08 flops=3.3e+10
 sigma_tot[gemm] counter=205 i=0 t=4.4e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=205 i=1 t=4.1e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=205 i=2 t=1.2e-01 per=2.0e+01 cost=8.1e+08 flops=6.7e+09
 sigma_tot[gemm] counter=205 i=3 t=1.5e-01 per=2.5e+01 cost=8.0e+08 flops=5.3e+09
 sigma_tot[gemm] counter=205 i=4 t=1.1e-01 per=1.9e+01 cost=6.8e+08 flops=5.9e+09
 sigma_tot[gemm] counter=205 i=5 t=1.2e-01 per=1.9e+01 cost=6.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=205 total t=5.0e-01 per=8.4e+01 cost=3.0e+09 flops=5.9e+09
 sigma_tot[red] counter=205 t=6.7e-02 per=1.1e+01 cost=2.0e+08 flops=2.9e+09
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=8.3e-06,1.2e-05,3.1e-06,2.0e-06,3.5e-07
    2   0 -    -116.545913927706 -3.003e-04  3.777e-03    2     2  5.056e-03 2.528e-03 2.465e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.551e-05,1.140e-04,1.963e-03,2.978e-04,2.445e-03
 analyze_tgpu[Hx]: ndim=478:3.561e-06GB T(cpu-gpu)=2.150e-05 speed=3.313e-01GB/S T(nccl)=4.401e-05 speed=1.619e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=2.0e-03 t_reduction=3.0e-04 tot=2.4e-03 -----
 sigma[inter] counter=206 t=1.1e-04 per=4.8e+00 cost=1.3e+06 flops=1.1e+10
 sigma[gemm] counter=206 i=0 t=2.0e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=206 i=1 t=1.9e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=206 i=2 t=4.8e-04 per=2.0e+01 cost=5.0e+05 flops=1.0e+09
 sigma[gemm] counter=206 i=3 t=6.6e-04 per=2.8e+01 cost=4.9e+05 flops=7.5e+08
 sigma[gemm] counter=206 i=4 t=4.0e-04 per=1.7e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=206 i=5 t=4.2e-04 per=1.7e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=206 total t=2.0e-03 per=8.3e+01 cost=2.2e+06 flops=1.1e+09
 sigma[red] counter=206 t=3.0e-04 per=1.3e+01 cost=2.2e+05 flops=7.6e+08
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=5.1e-01 t_reduction=6.7e-02 tot=6.0e-01 -----
 sigma_tot[inter] counter=206 t=2.8e-02 per=4.6e+00 cost=9.2e+08 flops=3.3e+10
 sigma_tot[gemm] counter=206 i=0 t=4.4e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=206 i=1 t=4.1e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=206 i=2 t=1.2e-01 per=2.0e+01 cost=8.1e+08 flops=6.7e+09
 sigma_tot[gemm] counter=206 i=3 t=1.5e-01 per=2.5e+01 cost=8.1e+08 flops=5.3e+09
 sigma_tot[gemm] counter=206 i=4 t=1.1e-01 per=1.9e+01 cost=6.8e+08 flops=5.9e+09
 sigma_tot[gemm] counter=206 i=5 t=1.2e-01 per=1.9e+01 cost=6.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=206 total t=5.1e-01 per=8.4e+01 cost=3.0e+09 flops=5.9e+09
 sigma_tot[red] counter=206 t=6.7e-02 per=1.1e+01 cost=2.0e+08 flops=2.9e+09
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=7.5e-06,1.4e-05,2.3e-06,2.6e-06,3.0e-07
    3   0 -    -116.545935485174 -2.156e-05  1.407e-03    3     3  7.736e-03 2.579e-03 2.515e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.535e-05,1.122e-04,1.951e-03,2.936e-04,2.427e-03
 analyze_tgpu[Hx]: ndim=478:3.561e-06GB T(cpu-gpu)=2.150e-05 speed=3.314e-01GB/S T(nccl)=4.385e-05 speed=1.624e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=2.0e-03 t_reduction=2.9e-04 tot=2.4e-03 -----
 sigma[inter] counter=207 t=1.1e-04 per=4.8e+00 cost=1.3e+06 flops=1.2e+10
 sigma[gemm] counter=207 i=0 t=1.9e-06 per=8.2e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=207 i=1 t=1.9e-06 per=8.1e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=207 i=2 t=4.8e-04 per=2.0e+01 cost=5.0e+05 flops=1.1e+09
 sigma[gemm] counter=207 i=3 t=6.6e-04 per=2.8e+01 cost=4.9e+05 flops=7.5e+08
 sigma[gemm] counter=207 i=4 t=4.0e-04 per=1.7e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=207 i=5 t=4.2e-04 per=1.8e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=207 total t=2.0e-03 per=8.3e+01 cost=2.2e+06 flops=1.1e+09
 sigma[red] counter=207 t=2.9e-04 per=1.2e+01 cost=2.2e+05 flops=7.7e+08
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=5.1e-01 t_reduction=6.8e-02 tot=6.0e-01 -----
 sigma_tot[inter] counter=207 t=2.8e-02 per=4.6e+00 cost=9.2e+08 flops=3.3e+10
 sigma_tot[gemm] counter=207 i=0 t=4.4e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=207 i=1 t=4.1e-04 per=6.8e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=207 i=2 t=1.2e-01 per=2.0e+01 cost=8.2e+08 flops=6.7e+09
 sigma_tot[gemm] counter=207 i=3 t=1.5e-01 per=2.5e+01 cost=8.1e+08 flops=5.2e+09
 sigma_tot[gemm] counter=207 i=4 t=1.1e-01 per=1.9e+01 cost=6.8e+08 flops=5.9e+09
 sigma_tot[gemm] counter=207 i=5 t=1.2e-01 per=1.9e+01 cost=6.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=207 total t=5.1e-01 per=8.4e+01 cost=3.0e+09 flops=5.9e+09
 sigma_tot[red] counter=207 t=6.8e-02 per=1.1e+01 cost=2.0e+08 flops=2.9e+09
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=7.5e-06,1.2e-05,2.0e-06,2.3e-06,3.0e-07
    4   0 -    -116.545938769421 -3.284e-06  4.798e-04    3     4  1.043e-02 2.608e-03 2.543e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.591e-05,1.128e-04,1.946e-03,2.921e-04,2.421e-03
 analyze_tgpu[Hx]: ndim=478:3.561e-06GB T(cpu-gpu)=2.176e-05 speed=3.274e-01GB/S T(nccl)=4.415e-05 speed=1.613e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.9e-03 t_reduction=2.9e-04 tot=2.4e-03 -----
 sigma[inter] counter=208 t=1.1e-04 per=4.8e+00 cost=1.3e+06 flops=1.2e+10
 sigma[gemm] counter=208 i=0 t=1.9e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=208 i=1 t=1.9e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=208 i=2 t=4.7e-04 per=2.0e+01 cost=5.0e+05 flops=1.1e+09
 sigma[gemm] counter=208 i=3 t=6.6e-04 per=2.8e+01 cost=4.9e+05 flops=7.5e+08
 sigma[gemm] counter=208 i=4 t=4.0e-04 per=1.7e+01 cost=5.8e+05 flops=1.5e+09
 sigma[gemm] counter=208 i=5 t=4.2e-04 per=1.8e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=208 total t=1.9e-03 per=8.3e+01 cost=2.2e+06 flops=1.1e+09
 sigma[red] counter=208 t=2.9e-04 per=1.2e+01 cost=2.2e+05 flops=7.7e+08
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=5.1e-01 t_reduction=6.8e-02 tot=6.1e-01 -----
 sigma_tot[inter] counter=208 t=2.8e-02 per=4.6e+00 cost=9.2e+08 flops=3.3e+10
 sigma_tot[gemm] counter=208 i=0 t=4.5e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=208 i=1 t=4.1e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=208 i=2 t=1.2e-01 per=2.0e+01 cost=8.2e+08 flops=6.7e+09
 sigma_tot[gemm] counter=208 i=3 t=1.5e-01 per=2.5e+01 cost=8.1e+08 flops=5.2e+09
 sigma_tot[gemm] counter=208 i=4 t=1.2e-01 per=1.9e+01 cost=6.8e+08 flops=5.9e+09
 sigma_tot[gemm] counter=208 i=5 t=1.2e-01 per=1.9e+01 cost=6.9e+08 flops=6.0e+09
 sigma_tot[gemm] counter=208 total t=5.1e-01 per=8.4e+01 cost=3.0e+09 flops=5.9e+09
 sigma_tot[red] counter=208 t=6.8e-02 per=1.1e+01 cost=2.0e+08 flops=2.9e+09
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=7.4e-06,1.3e-05,2.1e-06,2.2e-06,2.8e-07
    5   0 -    -116.545939094959 -3.255e-07  1.652e-04    3     5  1.308e-02 2.617e-03 2.552e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.511e-05,1.118e-04,1.969e-03,3.082e-04,2.458e-03
 analyze_tgpu[Hx]: ndim=478:3.561e-06GB T(cpu-gpu)=2.105e-05 speed=3.384e-01GB/S T(nccl)=4.406e-05 speed=1.617e-01GB/S
----- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=2.0e-03 t_reduction=3.1e-04 tot=2.4e-03 -----
 sigma[inter] counter=209 t=1.1e-04 per=4.7e+00 cost=1.3e+06 flops=1.2e+10
 sigma[gemm] counter=209 i=0 t=1.9e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=209 i=1 t=1.9e-06 per=7.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=209 i=2 t=4.8e-04 per=2.0e+01 cost=5.0e+05 flops=1.0e+09
 sigma[gemm] counter=209 i=3 t=6.5e-04 per=2.7e+01 cost=4.9e+05 flops=7.5e+08
 sigma[gemm] counter=209 i=4 t=4.0e-04 per=1.7e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=209 i=5 t=4.3e-04 per=1.8e+01 cost=5.8e+05 flops=1.4e+09
 sigma[gemm] counter=209 total t=2.0e-03 per=8.2e+01 cost=2.2e+06 flops=1.1e+09
 sigma[red] counter=209 t=3.1e-04 per=1.3e+01 cost=2.2e+05 flops=7.3e+08
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=5.1e-01 t_reduction=6.8e-02 tot=6.1e-01 -----
 sigma_tot[inter] counter=209 t=2.8e-02 per=4.6e+00 cost=9.2e+08 flops=3.3e+10
 sigma_tot[gemm] counter=209 i=0 t=4.5e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=209 i=1 t=4.2e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=209 i=2 t=1.2e-01 per=2.0e+01 cost=8.2e+08 flops=6.6e+09
 sigma_tot[gemm] counter=209 i=3 t=1.5e-01 per=2.5e+01 cost=8.1e+08 flops=5.2e+09
 sigma_tot[gemm] counter=209 i=4 t=1.2e-01 per=1.9e+01 cost=6.8e+08 flops=5.9e+09
 sigma_tot[gemm] counter=209 i=5 t=1.2e-01 per=1.9e+01 cost=6.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=209 total t=5.1e-01 per=8.4e+01 cost=3.0e+09 flops=5.9e+09
 sigma_tot[red] counter=209 t=6.8e-02 per=1.1e+01 cost=2.0e+08 flops=2.9e+09
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=7.3e-06,1.2e-05,2.2e-06,2.4e-06,2.9e-07
    6   0 +    -116.545939137556 -4.260e-08  7.970e-05    3     6  1.579e-02 2.632e-03 2.568e-03
TIMING FOR Davidson : 1.581e-02  T(cal/comm/rest)=1.541e-02,2.743e-06,3.987e-04
decomposed t_rest=3.987e-04
 T(sub)    =1.368e-04 per=3.432e+01
 T(precond)=1.911e-05 per=4.795e+00
 T(ortho)  =1.224e-05 per=3.071e+00
 T(xcopy)  =1.243e-06 per=3.118e-01
 T(xnrm2)  =2.021e-06 per=5.070e-01
 T(other)  =2.272e-04 per=5.699e+01
optimized energies: isweep=0 ibond=30 dots=1 e[0]=-116.545939137556 nmvp=6
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=1.283e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=19 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond30.txt
 qbond: qsuper nsym=19 dimAll=152
 (21,-1):14 (22,-2):25 (21,-3):9 (23,-3):20 (20,-2):3 (20,0):3 (23,-1):19 (22,-4):8 (22,0):12 (24,-4):7 (24,-2):14 (25,-3):5 (25,-1):2 (24,0):3 (26,-4):1 (21,1):3 (23,1):1 (23,-5):2 (25,-5):1
timing for divide=2.6e-06
timing for compute=8.1e-05
timing for collect=1.2e-05
----- TMING FOR decimation_genbasis(nkr): 9.6e-05 S T(divide/compute[cpu/gpu/rest]/collect)=2.6e-06,7.7e-05,0.0e+00,4.5e-06,1.2e-05 -----
decimation summary: 152->27 dwt=+0.000e+00 SvN=1.302e+00
 qbond: qkept nsym=7 dimAll=27
 (22,-2):8 (23,-3):8 (24,-4):4 (21,-1):3 (24,-2):2 (23,-1):1 (25,-5):1
----- TIMING for decimation_row(nkr): 1.034e-03 S T(decim/select/formRot)=1.540e-04,8.573e-04,2.222e-05 -----
----- TIMING FOR onedot_decimation: 1.086e-03 S T(wf/decim)=3.265e-05,1.054e-03 -----
ctns::oper_renorm coord=(5,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:30 S:5 H:1 P:22 Q:28 
        dim(bra,ket)=27,27 size(op)=159:1.213e-03MB size(tot)=6244:4.764e-02MB:4.652e-05GB
        per(mem): C:36 S:10.1 H:2.55 P:9.8 Q:41.5 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=9.453e-05 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=81 : 7.142e-04 S -----
rank=0 GPUmem(GB): used=1.710e-04 (oper)=1.564e-04
rank=0 GPUmem(GB): used=1.746e-04 (oper,site)=1.564e-04,3.561e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=81
 no. of rintermediate operators=120
 no. of coefficients=1680:1.282e-02MB:1.252e-05GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.534e-05 S -----
rank=0 GPUmem(GB): used=1.871e-04 (oper,site,rinter)=1.564e-04,3.561e-06,1.252e-05
----- TIMING FOR preprocess_formulae_Rlist2 : 7.148e-04 S size(rtasks)=81 size(Rlst2)=49 T(Rmu/Rlist)=1.197e-04,5.951e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 9.368e-04 S size(rtasks)=81 size(Rlst)=2271 -----
rank=0 GPUmem(GB): used=1.871e-04 avail=3.829e+01 total=3.829e+01 batch[need]=3.266e-03 blksize=64 blksize0=64 batchsize=2271
rank=0 GPUmem(GB): used=3.453e-03 (oper,site,rinter,batch)=1.564e-04,3.561e-06,1.252e-05,3.266e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.375e-04,1.262e-03,1.838e-04
----- TIMING FOR renorm : t_inter=1.4e-04 t_gemm=1.3e-03 t_reduction=1.8e-04 tot=1.6e-03 -----
 renorm[inter] counter=681 t=1.4e-04 per=8.7e+00 cost=5.7e+05 flops=4.1e+09
 renorm[gemm] counter=681 i=0 t=2.1e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=681 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=681 i=2 t=3.5e-04 per=2.2e+01 cost=1.5e+05 flops=4.3e+08
 renorm[gemm] counter=681 i=3 t=5.4e-04 per=3.4e+01 cost=3.3e+05 flops=6.0e+08
 renorm[gemm] counter=681 i=4 t=1.6e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=681 i=5 t=1.6e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=681 i=6 t=3.7e-04 per=2.3e+01 cost=6.1e+05 flops=1.7e+09
 renorm[gemm] counter=681 total t=1.3e-03 per=8.0e+01 cost=1.1e+06 flops=8.6e+08
 renorm[red] counter=681 t=1.8e-04 per=1.2e+01 cost=1.1e+05 flops=6.2e+08
----- TIMING FOR renorm_tot : t_inter=4.1e-03 t_gemm=3.6e-02 t_reduction=8.1e-03 tot=4.8e-02 -----
 renorm_tot[inter] counter=681 t=4.1e-03 per=8.5e+00 cost=3.2e+07 flops=7.8e+09
 renorm_tot[gemm] counter=681 i=0 t=6.4e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=681 i=1 t=5.7e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=681 i=2 t=4.3e-03 per=8.9e+00 cost=7.0e+06 flops=1.6e+09
 renorm_tot[gemm] counter=681 i=3 t=7.5e-03 per=1.5e+01 cost=2.2e+07 flops=3.0e+09
 renorm_tot[gemm] counter=681 i=4 t=4.6e-03 per=9.5e+00 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=681 i=5 t=6.5e-03 per=1.3e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=681 i=6 t=1.3e-02 per=2.7e+01 cost=7.6e+07 flops=5.7e+09
 renorm_tot[gemm] counter=681 total t=3.6e-02 per=7.5e+01 cost=1.4e+08 flops=3.8e+09
 renorm_tot[red] counter=681 t=8.1e-03 per=1.7e+01 cost=9.1e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.866e-04 (oper)=1.573e-04
rank=0 GPUmem(GB): used=1.901e-04 (oper,site,rinter)=1.573e-04,3.561e-06,2.086e-06
rank=0 GPUmem(GB): used=2.778e-04 (oper,site,rinter,batch)=1.573e-04,3.561e-06,2.086e-06,8.772e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 4.624e-03 S T(preprocess/alloc/comp/red/dealloc)=4.643e-04,5.228e-04,3.497e-03,5.203e-04,6.425e-05 -----
----- TIMING FOR oper_renorm_opS : 4.653e-03 S rank=0 -----
qops.to_cpu: size(tot)=6244:4.764e-02MB:4.652e-05GB T(to_cpu)=4.039e-05S speed=1.152e+00GB/S
check ||H-H.dagger||=1.888e-14 coord=(5,0) rank=0
----- TIMING FOR oper_renorm : 0.01 S rank=0 -----
rank=0 CPUmem(GB): used=1.348e+00 pageheap_free=0.000e+00 change=7.409e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=1.976e-03 change=-1.945e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=1.976e-03 change=-5.841e-06 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 3.810e-02 S #####
 T(local opt: fetch) = 3.347e-03 S  per = 8.79  per(accum) = 8.79
 T(local opt: hdiag) = 7.018e-04 S  per = 1.84  per(accum) = 10.6
 T(local opt: dvdsn) = 2.039e-02 S  per = 53.5  per(accum) = 64.2
 T(local opt: decim) = 1.119e-03 S  per = 2.94  per(accum) = 67.1
 T(local opt: guess) = 4.112e-05 S  per = 0.108  per(accum) = 67.2
 T(local opt: renrm) = 1.067e-02 S  per =   28  per(accum) = 95.2
 T(local opt: save ) = 1.824e-03 S  per = 4.79  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.039e-02 S  T(sum) = 1.991e-02 S  per = 9.764e+01
 T(local opt: preprocess                  ) = 8.038e-05 S  per = 0.404  per(accum) = 0.404
 T(local opt: symbolic_formulae           ) = 7.658e-04 S  per = 3.85  per(accum) = 4.25
 T(local opt: hintermediate init          ) = 7.853e-05 S  per = 0.394  per(accum) = 4.64
 T(local opt: preprocess_hformulae_Hxlist ) = 1.512e-03 S  per = 7.59  per(accum) = 12.2
 T(local opt: hmmtasks init               ) = 1.662e-03 S  per = 8.35  per(accum) = 20.6
 T(local opt: initial guess for dvdson    ) = 3.324e-06 S  per = 0.0167  per(accum) = 20.6
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.501e-02 S  per = 75.4  per(accum) = 96
 T(local opt: dvdson [cpu-gpu]            ) = 1.306e-04 S  per = 0.656  per(accum) = 96.6
 T(local opt: dvdson [nccl]               ) = 2.708e-04 S  per = 1.36  per(accum) = 98
 T(local opt: dvdson [mpi]                ) = 2.743e-06 S  per = 0.0138  per(accum) = 98
 T(local opt: dvdson [rest part(linalg)]  ) = 3.987e-04 S  per =    2  per(accum) = 100
Detailed decomposition of T(renrm) = 1.067e-02 S  T(sum) = 1.067e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.779e-05 S  per = 0.542  per(accum) = 0.542
 T(local opt: qops init                    ) = 3.339e-04 S  per = 3.13  per(accum) = 3.67
 T(local opt: symbolic_formulae_renorm     ) = 7.265e-04 S  per = 6.81  per(accum) = 10.5
 T(local opt: allocate qops on gpu         ) = 5.921e-05 S  per = 0.555  per(accum) = 11
 T(local opt: site memcpy cpu2gpu          ) = 2.832e-05 S  per = 0.265  per(accum) = 11.3
 T(local opt: rintermediate init           ) = 7.034e-05 S  per = 0.659  per(accum) = 12
 T(local opt: preprocess_formulae_Rlist2   ) = 9.562e-04 S  per = 8.96  per(accum) = 20.9
 T(local opt: rmmtasks init                ) = 1.093e-03 S  per = 10.2  per(accum) = 31.2
 T(local opt: qops memset on cpu           ) = 5.300e-08 S  per = 0.000497  per(accum) = 31.2
 T(local opt: preprocess_renorm_batchGPU   ) = 1.743e-03 S  per = 16.3  per(accum) = 47.5
 T(local opt: deallocate cpu and gpu memory) = 1.574e-04 S  per = 1.48  per(accum) = 49
 T(local opt: construct opS [ifdists=true] ) = 4.713e-03 S  per = 44.2  per(accum) = 93.1
 T(local opt: reduction of opS & opH [nccl]) = 1.806e-05 S  per = 0.169  per(accum) = 93.3
 T(local opt: qops memcpy gpu2cpu          ) = 5.128e-05 S  per = 0.481  per(accum) = 93.8
 T(local opt: reduction of opS & opH [mpi] ) = 4.560e-05 S  per = 0.427  per(accum) = 94.2
 T(local opt: qops_pool join and erase     ) = 6.171e-04 S  per = 5.78  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.810e-07 S  per = 0.00826  per(accum) = 100
ctns::rcanon_save_site idx=14 scratch=./scratch/sweep size=478:3.6e-06GB T(load)=0.00058S speed=0.0062GB/S
##### sweep opt: 1.766e+00 S #####
 T(sweep opt: fetch) = 1.038e-01 S  per = 5.88  per(accum) = 5.88
 T(sweep opt: hdiag) = 2.799e-02 S  per = 1.59  per(accum) = 7.46
 T(sweep opt: dvdsn) = 9.208e-01 S  per = 52.2  per(accum) = 59.6
 T(sweep opt: decim) = 3.762e-02 S  per = 2.13  per(accum) = 61.7
 T(sweep opt: guess) = 1.755e-03 S  per = 0.0994  per(accum) = 61.8
 T(sweep opt: renrm) = 6.100e-01 S  per = 34.5  per(accum) = 96.4
 T(sweep opt: save ) = 6.369e-02 S  per = 3.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.208e-01 S  T(sum) = 9.034e-01 S  per = 9.811e+01
 T(sweep opt: preprocess                  ) = 2.240e-03 S  per = 0.248  per(accum) = 0.248
 T(sweep opt: symbolic_formulae           ) = 2.680e-02 S  per = 2.97  per(accum) = 3.21
 T(sweep opt: hintermediate init          ) = 1.946e-03 S  per = 0.215  per(accum) = 3.43
 T(sweep opt: preprocess_hformulae_Hxlist ) = 9.477e-02 S  per = 10.5  per(accum) = 13.9
 T(sweep opt: hmmtasks init               ) = 9.614e-02 S  per = 10.6  per(accum) = 24.6
 T(sweep opt: initial guess for dvdson    ) = 1.905e-04 S  per = 0.0211  per(accum) = 24.6
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.501e-01 S  per =   72  per(accum) = 96.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 5.101e-03 S  per = 0.565  per(accum) = 97.1
 T(sweep opt: dvdson [nccl]               ) = 1.093e-02 S  per = 1.21  per(accum) = 98.3
 T(sweep opt: dvdson [mpi]                ) = 9.502e-05 S  per = 0.0105  per(accum) = 98.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.509e-02 S  per = 1.67  per(accum) = 100
Detailed decomposition of T(renrm) = 6.100e-01 S  T(sum) = 6.100e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.799e-03 S  per = 0.295  per(accum) = 0.295
 T(sweep opt: qops init                    ) = 1.581e-02 S  per = 2.59  per(accum) = 2.89
 T(sweep opt: symbolic_formulae_renorm     ) = 1.637e-02 S  per = 2.68  per(accum) = 5.57
 T(sweep opt: allocate qops on gpu         ) = 2.132e-03 S  per = 0.35  per(accum) = 5.92
 T(sweep opt: site memcpy cpu2gpu          ) = 7.613e-04 S  per = 0.125  per(accum) = 6.05
 T(sweep opt: rintermediate init           ) = 1.705e-03 S  per = 0.28  per(accum) = 6.32
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.279e-02 S  per = 5.38  per(accum) = 11.7
 T(sweep opt: rmmtasks init                ) = 3.531e-02 S  per = 5.79  per(accum) = 17.5
 T(sweep opt: qops memset on cpu           ) = 1.556e-06 S  per = 0.000255  per(accum) = 17.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.340e-02 S  per = 8.75  per(accum) = 26.2
 T(sweep opt: deallocate cpu and gpu memory) = 4.841e-03 S  per = 0.794  per(accum) = 27
 T(sweep opt: construct opS [ifdists=true] ) = 4.066e-01 S  per = 66.7  per(accum) = 93.7
 T(sweep opt: reduction of opS & opH [nccl]) = 7.517e-04 S  per = 0.123  per(accum) = 93.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.082e-03 S  per = 0.669  per(accum) = 94.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 8.548e-04 S  per = 0.14  per(accum) = 94.6
 T(sweep opt: qops_pool join and erase     ) = 2.061e-02 S  per = 3.38  per(accum) = 98
 T(sweep opt: conversion from opAB to opPQ ) = 1.219e-02 S  per =    2  per(accum) = 100
##### global opt: 1.766e+00 S #####
 T(global opt: fetch) = 1.038e-01 S  per = 5.88  per(accum) = 5.88
 T(global opt: hdiag) = 2.799e-02 S  per = 1.59  per(accum) = 7.46
 T(global opt: dvdsn) = 9.208e-01 S  per = 52.2  per(accum) = 59.6
 T(global opt: decim) = 3.762e-02 S  per = 2.13  per(accum) = 61.7
 T(global opt: guess) = 1.755e-03 S  per = 0.0994  per(accum) = 61.8
 T(global opt: renrm) = 6.100e-01 S  per = 34.5  per(accum) = 96.4
 T(global opt: save ) = 6.369e-02 S  per = 3.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.208e-01 S  T(sum) = 9.034e-01 S  per = 9.811e+01
 T(global opt: preprocess                  ) = 2.240e-03 S  per = 0.248  per(accum) = 0.248
 T(global opt: symbolic_formulae           ) = 2.680e-02 S  per = 2.97  per(accum) = 3.21
 T(global opt: hintermediate init          ) = 1.946e-03 S  per = 0.215  per(accum) = 3.43
 T(global opt: preprocess_hformulae_Hxlist ) = 9.477e-02 S  per = 10.5  per(accum) = 13.9
 T(global opt: hmmtasks init               ) = 9.614e-02 S  per = 10.6  per(accum) = 24.6
 T(global opt: initial guess for dvdson    ) = 1.905e-04 S  per = 0.0211  per(accum) = 24.6
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.501e-01 S  per =   72  per(accum) = 96.5
 T(global opt: dvdson [cpu-gpu]            ) = 5.101e-03 S  per = 0.565  per(accum) = 97.1
 T(global opt: dvdson [nccl]               ) = 1.093e-02 S  per = 1.21  per(accum) = 98.3
 T(global opt: dvdson [mpi]                ) = 9.502e-05 S  per = 0.0105  per(accum) = 98.3
 T(global opt: dvdson [rest part(linalg)]  ) = 1.509e-02 S  per = 1.67  per(accum) = 100
Detailed decomposition of T(renrm) = 6.100e-01 S  T(sum) = 6.100e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.799e-03 S  per = 0.295  per(accum) = 0.295
 T(global opt: qops init                    ) = 1.581e-02 S  per = 2.59  per(accum) = 2.89
 T(global opt: symbolic_formulae_renorm     ) = 1.637e-02 S  per = 2.68  per(accum) = 5.57
 T(global opt: allocate qops on gpu         ) = 2.132e-03 S  per = 0.35  per(accum) = 5.92
 T(global opt: site memcpy cpu2gpu          ) = 7.613e-04 S  per = 0.125  per(accum) = 6.05
 T(global opt: rintermediate init           ) = 1.705e-03 S  per = 0.28  per(accum) = 6.32
 T(global opt: preprocess_formulae_Rlist2   ) = 3.279e-02 S  per = 5.38  per(accum) = 11.7
 T(global opt: rmmtasks init                ) = 3.531e-02 S  per = 5.79  per(accum) = 17.5
 T(global opt: qops memset on cpu           ) = 1.556e-06 S  per = 0.000255  per(accum) = 17.5
 T(global opt: preprocess_renorm_batchGPU   ) = 5.340e-02 S  per = 8.75  per(accum) = 26.2
 T(global opt: deallocate cpu and gpu memory) = 4.841e-03 S  per = 0.794  per(accum) = 27
 T(global opt: construct opS [ifdists=true] ) = 4.066e-01 S  per = 66.7  per(accum) = 93.7
 T(global opt: reduction of opS & opH [nccl]) = 7.517e-04 S  per = 0.123  per(accum) = 93.8
 T(global opt: qops memcpy gpu2cpu          ) = 4.082e-03 S  per = 0.669  per(accum) = 94.5
 T(global opt: reduction of opS & opH [mpi] ) = 8.548e-04 S  per = 0.14  per(accum) = 94.6
 T(global opt: qops_pool join and erase     ) = 2.061e-02 S  per = 3.38  per(accum) = 98
 T(global opt: conversion from opAB to opPQ ) = 1.219e-02 S  per =    2  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.287e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=31/seqsize=34 dots=1 dbond=(3,0)-(4,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=16 scratch=./scratch/sweep size=112:8.34e-07GB T(load)=3.09e-04S speed=2.70e-03GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=325:2.48e-03MB:2.42e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=213:1.63e-03MB:1.59e-06GB
total mem of comb=686:5.23e-03MB:5.11e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=5.424e-06 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=4,15,1
 suppl= 0 1 2 3
 suppr= 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 4
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:8 S:16 H:1 A:14 B:18 
        dim(bra,ket)=17,17 size(op)=63:4.807e-04MB size(tot)=1873:1.429e-02MB:1.395e-05GB
        per(mem): C:12.4 S:41 H:3.36 A:6.19 B:37.1 
 rqops: oplist=CSHPQ nops=C:30 S:5 H:1 P:22 Q:28 
        dim(bra,ket)=27,27 size(op)=159:0.00121MB size(tot)=6244:0.0476MB:4.65e-05GB
        per(mem): C:36 S:10.1 H:2.55 P:9.8 Q:41.5 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=10453:0.0798MB:7.79e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.445e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(4,0) fdel=./scratch/sweep/lop(3,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-1.490e-05 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(17,27,4) nnz=213:1.625e-03MB
qtensor3: wf3 own=1 _data=0x55b2c3eea000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=6 dimAll=17
 (6,2):5 (7,1):4 (5,3):4 (5,1):2 (8,0):1 (4,4):1
 qbond: qcol nsym=7 dimAll=27
 (22,-2):8 (23,-3):8 (24,-4):4 (21,-1):3 (24,-2):2 (23,-1):1 (25,-5):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=15 nblocks=168 size=213:1.625e-03MB
### DIAG TIMING: total=4.221e-04 t1=1.691e-05, t2=1.187e-05, t3=1.499e-05, t4=3.170e-04, t5=1.171e-05, t6=4.057e-05, t7=9.060e-06
duration_diagGPU:4.328e-04
duration_diagreduce:5.400e-08
duration_diagtransform:9.120e-07
----- TIMING FOR symbolic_formulae_onedot with size=219 : 4.786e-04 S -----
rank=0 GPUmem(GB): used=7.788e-05 (oper)=7.788e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=219
 no. of hintermediate operators=94
 no. of coefficients=1410:1.076e-02MB:1.051e-05GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.999e-05 S -----
rank=0 GPUmem(GB): used=8.839e-05 (oper,hinter)=7.788e-05,1.051e-05
----- TIMING FOR preprocess_formulae_Hxlist2 : 5.028e-04 S size(H_formulae)=219 size(Hxlst2)=15 T(Hmu/Hxlist)=8.715e-05,4.156e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 6.495e-04 S size(H_formulae)=219 size(Hxlst)=2062 -----
rank=0 GPUmem(GB): used=8.839e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=3.174e-06 batch[need]=2.228e-03 blksize=40 blksize0=64 batchsize=2062
rank=0 GPUmem(GB): used=2.319e-03 (oper,hinter,dvdson,batch)=7.788e-05,1.051e-05,3.174e-06,2.228e-03
ctns::pdvdsonSolver_nkr::solve_iter ndim=213 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.965e-05,9.223e-05,1.032e-03,1.884e-04,1.390e-03
 analyze_tgpu[Hx]: ndim=213:1.587e-06GB T(cpu-gpu)=2.115e-05 speed=1.501e-01GB/S T(nccl)=4.850e-05 speed=6.544e-02GB/S
----- TIMING FOR sigma : t_inter=9.2e-05 t_gemm=1.0e-03 t_reduction=1.9e-04 tot=1.3e-03 -----
 sigma[inter] counter=210 t=9.2e-05 per=7.0e+00 cost=3.4e+05 flops=3.7e+09
 sigma[gemm] counter=210 i=0 t=1.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=210 i=1 t=1.6e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=210 i=2 t=2.6e-04 per=2.0e+01 cost=1.4e+05 flops=5.4e+08
 sigma[gemm] counter=210 i=3 t=3.1e-04 per=2.3e+01 cost=1.4e+05 flops=4.7e+08
 sigma[gemm] counter=210 i=4 t=2.4e-04 per=1.8e+01 cost=1.2e+05 flops=5.0e+08
 sigma[gemm] counter=210 i=5 t=2.2e-04 per=1.7e+01 cost=1.2e+05 flops=5.5e+08
 sigma[gemm] counter=210 total t=1.0e-03 per=7.9e+01 cost=5.3e+05 flops=5.1e+08
 sigma[red] counter=210 t=1.9e-04 per=1.4e+01 cost=7.0e+04 flops=3.7e+08
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=5.1e-01 t_reduction=6.9e-02 tot=6.1e-01 -----
 sigma_tot[inter] counter=210 t=2.8e-02 per=4.6e+00 cost=9.2e+08 flops=3.3e+10
 sigma_tot[gemm] counter=210 i=0 t=4.5e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=210 i=1 t=4.2e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=210 i=2 t=1.2e-01 per=2.0e+01 cost=8.2e+08 flops=6.6e+09
 sigma_tot[gemm] counter=210 i=3 t=1.6e-01 per=2.5e+01 cost=8.1e+08 flops=5.2e+09
 sigma_tot[gemm] counter=210 i=4 t=1.2e-01 per=1.9e+01 cost=6.8e+08 flops=5.9e+09
 sigma_tot[gemm] counter=210 i=5 t=1.2e-01 per=1.9e+01 cost=6.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=210 total t=5.1e-01 per=8.4e+01 cost=3.0e+09 flops=5.9e+09
 sigma_tot[red] counter=210 t=6.9e-02 per=1.1e+01 cost=2.0e+08 flops=2.9e+09
T(sub)=8.3e-06 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,2.8e-06,1.0e-06,9.5e-07,2.5e-07
settings: ndim=213 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.545939137556 -1.117e+03  7.496e-03    1     1  1.535e-03 1.535e-03 1.508e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.424e-05,8.322e-05,1.257e-03,2.127e-04,1.622e-03
 analyze_tgpu[Hx]: ndim=213:1.587e-06GB T(cpu-gpu)=2.108e-05 speed=1.505e-01GB/S T(nccl)=4.315e-05 speed=7.355e-02GB/S
----- TIMING FOR sigma : t_inter=8.3e-05 t_gemm=1.3e-03 t_reduction=2.1e-04 tot=1.6e-03 -----
 sigma[inter] counter=211 t=8.3e-05 per=5.4e+00 cost=3.4e+05 flops=4.1e+09
 sigma[gemm] counter=211 i=0 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=211 i=1 t=1.8e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=211 i=2 t=3.2e-04 per=2.1e+01 cost=1.4e+05 flops=4.4e+08
 sigma[gemm] counter=211 i=3 t=3.9e-04 per=2.5e+01 cost=1.4e+05 flops=3.7e+08
 sigma[gemm] counter=211 i=4 t=2.6e-04 per=1.7e+01 cost=1.2e+05 flops=4.5e+08
 sigma[gemm] counter=211 i=5 t=2.8e-04 per=1.8e+01 cost=1.2e+05 flops=4.4e+08
 sigma[gemm] counter=211 total t=1.3e-03 per=8.1e+01 cost=5.3e+05 flops=4.2e+08
 sigma[red] counter=211 t=2.1e-04 per=1.4e+01 cost=7.0e+04 flops=3.3e+08
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=5.1e-01 t_reduction=6.9e-02 tot=6.1e-01 -----
 sigma_tot[inter] counter=211 t=2.8e-02 per=4.6e+00 cost=9.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=211 i=0 t=4.5e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=211 i=1 t=4.2e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=211 i=2 t=1.2e-01 per=2.0e+01 cost=8.2e+08 flops=6.6e+09
 sigma_tot[gemm] counter=211 i=3 t=1.6e-01 per=2.5e+01 cost=8.1e+08 flops=5.2e+09
 sigma_tot[gemm] counter=211 i=4 t=1.2e-01 per=1.9e+01 cost=6.8e+08 flops=5.9e+09
 sigma_tot[gemm] counter=211 i=5 t=1.2e-01 per=1.9e+01 cost=6.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=211 total t=5.1e-01 per=8.4e+01 cost=3.0e+09 flops=5.8e+09
 sigma_tot[red] counter=211 t=6.9e-02 per=1.1e+01 cost=2.0e+08 flops=2.9e+09
T(sub)=2.1e-05 T(gemm/eig/ortho/gemm/axpy)=6.1e-06,1.0e-05,2.8e-06,1.4e-06,2.8e-07
    2   0 -    -116.546003788251 -6.465e-05  1.400e-03    2     2  3.298e-03 1.649e-03 1.608e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.117e-05,8.019e-05,1.253e-03,2.148e-04,1.613e-03
 analyze_tgpu[Hx]: ndim=213:1.587e-06GB T(cpu-gpu)=2.004e-05 speed=1.584e-01GB/S T(nccl)=4.113e-05 speed=7.717e-02GB/S
----- TIMING FOR sigma : t_inter=8.0e-05 t_gemm=1.3e-03 t_reduction=2.1e-04 tot=1.5e-03 -----
 sigma[inter] counter=212 t=8.0e-05 per=5.2e+00 cost=3.4e+05 flops=4.2e+09
 sigma[gemm] counter=212 i=0 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=212 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=212 i=2 t=3.1e-04 per=2.0e+01 cost=1.4e+05 flops=4.6e+08
 sigma[gemm] counter=212 i=3 t=4.0e-04 per=2.6e+01 cost=1.4e+05 flops=3.6e+08
 sigma[gemm] counter=212 i=4 t=2.6e-04 per=1.7e+01 cost=1.2e+05 flops=4.5e+08
 sigma[gemm] counter=212 i=5 t=2.7e-04 per=1.8e+01 cost=1.2e+05 flops=4.5e+08
 sigma[gemm] counter=212 total t=1.3e-03 per=8.1e+01 cost=5.3e+05 flops=4.2e+08
 sigma[red] counter=212 t=2.1e-04 per=1.4e+01 cost=7.0e+04 flops=3.3e+08
----- TIMING FOR sigma_tot : t_inter=2.8e-02 t_gemm=5.1e-01 t_reduction=6.9e-02 tot=6.1e-01 -----
 sigma_tot[inter] counter=212 t=2.8e-02 per=4.6e+00 cost=9.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=212 i=0 t=4.5e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=212 i=1 t=4.2e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=212 i=2 t=1.2e-01 per=2.0e+01 cost=8.2e+08 flops=6.6e+09
 sigma_tot[gemm] counter=212 i=3 t=1.6e-01 per=2.5e+01 cost=8.1e+08 flops=5.2e+09
 sigma_tot[gemm] counter=212 i=4 t=1.2e-01 per=1.9e+01 cost=6.8e+08 flops=5.8e+09
 sigma_tot[gemm] counter=212 i=5 t=1.2e-01 per=1.9e+01 cost=6.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=212 total t=5.1e-01 per=8.4e+01 cost=3.0e+09 flops=5.8e+09
 sigma_tot[red] counter=212 t=6.9e-02 per=1.1e+01 cost=2.0e+08 flops=2.9e+09
T(sub)=2.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,1.3e-05,2.0e-06,1.7e-06,2.4e-07
    3   0 -    -116.546006189166 -2.401e-06  3.197e-04    3     3  5.041e-03 1.680e-03 1.638e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.135e-05,8.009e-05,1.240e-03,2.092e-04,1.594e-03
 analyze_tgpu[Hx]: ndim=213:1.587e-06GB T(cpu-gpu)=2.045e-05 speed=1.552e-01GB/S T(nccl)=4.090e-05 speed=7.760e-02GB/S
----- TIMING FOR sigma : t_inter=8.0e-05 t_gemm=1.2e-03 t_reduction=2.1e-04 tot=1.5e-03 -----
 sigma[inter] counter=213 t=8.0e-05 per=5.2e+00 cost=3.4e+05 flops=4.2e+09
 sigma[gemm] counter=213 i=0 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=213 i=1 t=1.9e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=213 i=2 t=3.1e-04 per=2.0e+01 cost=1.4e+05 flops=4.6e+08
 sigma[gemm] counter=213 i=3 t=3.9e-04 per=2.6e+01 cost=1.4e+05 flops=3.7e+08
 sigma[gemm] counter=213 i=4 t=2.6e-04 per=1.7e+01 cost=1.2e+05 flops=4.5e+08
 sigma[gemm] counter=213 i=5 t=2.7e-04 per=1.8e+01 cost=1.2e+05 flops=4.5e+08
 sigma[gemm] counter=213 total t=1.2e-03 per=8.1e+01 cost=5.3e+05 flops=4.2e+08
 sigma[red] counter=213 t=2.1e-04 per=1.4e+01 cost=7.0e+04 flops=3.3e+08
----- TIMING FOR sigma_tot : t_inter=2.9e-02 t_gemm=5.2e-01 t_reduction=6.9e-02 tot=6.1e-01 -----
 sigma_tot[inter] counter=213 t=2.9e-02 per=4.6e+00 cost=9.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=213 i=0 t=4.6e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=213 i=1 t=4.2e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=213 i=2 t=1.2e-01 per=2.0e+01 cost=8.2e+08 flops=6.6e+09
 sigma_tot[gemm] counter=213 i=3 t=1.6e-01 per=2.5e+01 cost=8.1e+08 flops=5.2e+09
 sigma_tot[gemm] counter=213 i=4 t=1.2e-01 per=1.9e+01 cost=6.8e+08 flops=5.8e+09
 sigma_tot[gemm] counter=213 i=5 t=1.2e-01 per=1.9e+01 cost=6.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=213 total t=5.2e-01 per=8.4e+01 cost=3.0e+09 flops=5.8e+09
 sigma_tot[red] counter=213 t=6.9e-02 per=1.1e+01 cost=2.0e+08 flops=2.8e+09
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=5.1e-06,1.2e-05,2.1e-06,1.5e-06,1.8e-07
    4   0 -    -116.546006378586 -1.894e-07  1.335e-04    3     4  6.876e-03 1.719e-03 1.676e-03
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.164e-05,8.295e-05,1.245e-03,2.081e-04,1.602e-03
 analyze_tgpu[Hx]: ndim=213:1.587e-06GB T(cpu-gpu)=2.025e-05 speed=1.567e-01GB/S T(nccl)=4.139e-05 speed=7.668e-02GB/S
----- TIMING FOR sigma : t_inter=8.3e-05 t_gemm=1.2e-03 t_reduction=2.1e-04 tot=1.5e-03 -----
 sigma[inter] counter=214 t=8.3e-05 per=5.4e+00 cost=3.4e+05 flops=4.1e+09
 sigma[gemm] counter=214 i=0 t=1.8e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=214 i=1 t=1.9e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=214 i=2 t=3.1e-04 per=2.0e+01 cost=1.4e+05 flops=4.5e+08
 sigma[gemm] counter=214 i=3 t=3.9e-04 per=2.5e+01 cost=1.4e+05 flops=3.7e+08
 sigma[gemm] counter=214 i=4 t=2.7e-04 per=1.8e+01 cost=1.2e+05 flops=4.4e+08
 sigma[gemm] counter=214 i=5 t=2.7e-04 per=1.8e+01 cost=1.2e+05 flops=4.5e+08
 sigma[gemm] counter=214 total t=1.2e-03 per=8.1e+01 cost=5.3e+05 flops=4.2e+08
 sigma[red] counter=214 t=2.1e-04 per=1.4e+01 cost=7.0e+04 flops=3.4e+08
----- TIMING FOR sigma_tot : t_inter=2.9e-02 t_gemm=5.2e-01 t_reduction=6.9e-02 tot=6.2e-01 -----
 sigma_tot[inter] counter=214 t=2.9e-02 per=4.6e+00 cost=9.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=214 i=0 t=4.6e-04 per=7.4e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=214 i=1 t=4.3e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=214 i=2 t=1.2e-01 per=2.0e+01 cost=8.2e+08 flops=6.6e+09
 sigma_tot[gemm] counter=214 i=3 t=1.6e-01 per=2.5e+01 cost=8.1e+08 flops=5.1e+09
 sigma_tot[gemm] counter=214 i=4 t=1.2e-01 per=1.9e+01 cost=6.8e+08 flops=5.8e+09
 sigma_tot[gemm] counter=214 i=5 t=1.2e-01 per=1.9e+01 cost=6.9e+08 flops=5.9e+09
 sigma_tot[gemm] counter=214 total t=5.2e-01 per=8.4e+01 cost=3.0e+09 flops=5.8e+09
 sigma_tot[red] counter=214 t=6.9e-02 per=1.1e+01 cost=2.0e+08 flops=2.8e+09
T(sub)=2.0e-05 T(gemm/eig/ortho/gemm/axpy)=4.7e-06,1.1e-05,2.1e-06,1.5e-06,1.6e-07
    5   0 +    -116.546006420381 -4.180e-08  7.248e-05    3     5  8.702e-03 1.740e-03 1.697e-03
TIMING FOR Davidson : 8.713e-03  T(cal/comm/rest)=8.486e-03,1.712e-06,2.250e-04
decomposed t_rest=2.250e-04
 T(sub)    =9.134e-05 per=4.060e+01
 T(precond)=1.553e-05 per=6.902e+00
 T(ortho)  =8.041e-06 per=3.574e+00
 T(xcopy)  =1.386e-06 per=6.161e-01
 T(xnrm2)  =1.050e-06 per=4.667e-01
 T(other)  =1.076e-04 per=4.784e+01
optimized energies: isweep=0 ibond=31 dots=1 e[0]=-116.546006420381 nmvp=5
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=6.437e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=15 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond31.txt
 qbond: qsuper nsym=15 dimAll=108
 (22,-2):11 (23,-3):16 (24,-4):12 (21,-1):3 (24,-2):19 (23,-1):12 (25,-5):5 (25,-3):14 (26,-4):5 (26,-2):2 (25,-1):3 (27,-5):1 (22,0):3 (24,0):1 (26,-6):1
timing for divide=2.2e-06
timing for compute=6.1e-05
timing for collect=4.3e-06
----- TMING FOR decimation_genbasis(nkr): 6.7e-05 S T(divide/compute[cpu/gpu/rest]/collect)=2.2e-06,5.9e-05,0.0e+00,2.0e-06,4.3e-06 -----
decimation summary: 108->17 dwt=+1.110e-16 SvN=1.099e+00
 qbond: qkept nsym=6 dimAll=17
 (24,-2):5 (23,-1):4 (25,-3):4 (25,-1):2 (26,-4):1 (22,0):1
----- TIMING for decimation_row(nkr): 9.177e-04 S T(decim/select/formRot)=9.095e-05,8.161e-04,1.073e-05 -----
----- TIMING FOR onedot_decimation: 9.507e-04 S T(wf/decim)=2.351e-05,9.272e-04 -----
ctns::oper_renorm coord=(4,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:32 S:4 H:1 P:14 Q:18 
        dim(bra,ket)=17,17 size(op)=63:4.807e-04MB size(tot)=1993:1.521e-02MB:1.485e-05GB
        per(mem): C:46.6 S:9.63 H:3.16 P:5.82 Q:34.8 
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=6.589e-05 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=65 : 5.094e-04 S -----
rank=0 GPUmem(GB): used=8.928e-05 (oper)=7.877e-05
rank=0 GPUmem(GB): used=9.087e-05 (oper,site)=7.877e-05,1.587e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=65
 no. of rintermediate operators=78
 no. of coefficients=1170:8.926e-03MB:8.717e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.210e-05 S -----
rank=0 GPUmem(GB): used=9.958e-05 (oper,site,rinter)=7.877e-05,1.587e-06,8.717e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 3.842e-04 S size(rtasks)=65 size(Rlst2)=36 T(Rmu/Rlist)=8.951e-05,2.946e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 4.732e-04 S size(rtasks)=65 size(Rlst)=1025 -----
rank=0 GPUmem(GB): used=9.958e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.107e-03 blksize=40 blksize0=64 batchsize=1025
rank=0 GPUmem(GB): used=1.207e-03 (oper,site,rinter,batch)=7.877e-05,1.587e-06,8.717e-06,1.107e-03
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.091e-04,9.232e-04,1.606e-04
----- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=9.2e-04 t_reduction=1.6e-04 tot=1.2e-03 -----
 renorm[inter] counter=692 t=1.1e-04 per=9.1e+00 cost=1.2e+05 flops=1.1e+09
 renorm[gemm] counter=692 i=0 t=2.1e-06 per=1.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=692 i=1 t=1.8e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=692 i=2 t=2.6e-04 per=2.1e+01 cost=4.1e+04 flops=1.6e+08
 renorm[gemm] counter=692 i=3 t=3.5e-04 per=2.9e+01 cost=1.0e+05 flops=3.0e+08
 renorm[gemm] counter=692 i=4 t=1.9e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=692 i=5 t=1.8e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=692 i=6 t=3.1e-04 per=2.6e+01 cost=1.4e+05 flops=4.3e+08
 renorm[gemm] counter=692 total t=9.2e-04 per=7.7e+01 cost=2.8e+05 flops=3.0e+08
 renorm[red] counter=692 t=1.6e-04 per=1.3e+01 cost=2.8e+04 flops=1.8e+08
----- TIMING FOR renorm_tot : t_inter=4.2e-03 t_gemm=3.7e-02 t_reduction=8.2e-03 tot=5.0e-02 -----
 renorm_tot[inter] counter=692 t=4.2e-03 per=8.5e+00 cost=3.2e+07 flops=7.7e+09
 renorm_tot[gemm] counter=692 i=0 t=6.6e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=692 i=1 t=5.9e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=692 i=2 t=4.6e-03 per=9.2e+00 cost=7.1e+06 flops=1.5e+09
 renorm_tot[gemm] counter=692 i=3 t=7.8e-03 per=1.6e+01 cost=2.2e+07 flops=2.9e+09
 renorm_tot[gemm] counter=692 i=4 t=4.6e-03 per=9.2e+00 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=692 i=5 t=6.5e-03 per=1.3e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=692 i=6 t=1.4e-02 per=2.7e+01 cost=7.6e+07 flops=5.6e+09
 renorm_tot[gemm] counter=692 total t=3.7e-02 per=7.5e+01 cost=1.4e+08 flops=3.8e+09
 renorm_tot[red] counter=692 t=8.2e-03 per=1.7e+01 cost=9.2e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=1.001e-04 (oper)=7.913e-05
rank=0 GPUmem(GB): used=1.017e-04 (oper,site,rinter)=7.913e-05,1.587e-06,1.788e-06
rank=0 GPUmem(GB): used=1.417e-04 (oper,site,rinter,batch)=7.913e-05,1.587e-06,1.788e-06,3.997e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 3.035e-03 S T(preprocess/alloc/comp/red/dealloc)=3.965e-04,4.343e-04,2.248e-03,2.797e-04,5.325e-05 -----
----- TIMING FOR oper_renorm_opS : 3.060e-03 S rank=0 -----
qops.to_cpu: size(tot)=1993:1.521e-02MB:1.485e-05GB T(to_cpu)=3.098e-05S speed=4.792e-01GB/S
check ||H-H.dagger||=3.134e-14 coord=(4,0) rank=0
----- TIMING FOR oper_renorm : 0.0062 S rank=0 -----
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=3.819e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.445e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-3.085e-06 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 2.396e-02 S #####
 T(local opt: fetch) = 2.713e-03 S  per = 11.3  per(accum) = 11.3
 T(local opt: hdiag) = 4.598e-04 S  per = 1.92  per(accum) = 13.2
 T(local opt: dvdsn) = 1.121e-02 S  per = 46.8  per(accum) = 60
 T(local opt: decim) = 9.771e-04 S  per = 4.08  per(accum) = 64.1
 T(local opt: guess) = 3.885e-05 S  per = 0.162  per(accum) = 64.3
 T(local opt: renrm) = 6.741e-03 S  per = 28.1  per(accum) = 92.4
 T(local opt: save ) = 1.820e-03 S  per =  7.6  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.121e-02 S  T(sum) = 1.077e-02 S  per = 9.610e+01
 T(local opt: preprocess                  ) = 5.207e-05 S  per = 0.483  per(accum) = 0.483
 T(local opt: symbolic_formulae           ) = 4.833e-04 S  per = 4.49  per(accum) = 4.97
 T(local opt: hintermediate init          ) = 3.748e-05 S  per = 0.348  per(accum) = 5.32
 T(local opt: preprocess_hformulae_Hxlist ) = 6.568e-04 S  per =  6.1  per(accum) = 11.4
 T(local opt: hmmtasks init               ) = 8.273e-04 S  per = 7.68  per(accum) = 19.1
 T(local opt: initial guess for dvdson    ) = 2.685e-06 S  per = 0.0249  per(accum) = 19.1
 T(local opt: dvdson [Hx_batchGPU]        ) = 8.168e-03 S  per = 75.8  per(accum) = 94.9
 T(local opt: dvdson [cpu-gpu]            ) = 1.030e-04 S  per = 0.956  per(accum) = 95.9
 T(local opt: dvdson [nccl]               ) = 2.151e-04 S  per =    2  per(accum) = 97.9
 T(local opt: dvdson [mpi]                ) = 1.712e-06 S  per = 0.0159  per(accum) = 97.9
 T(local opt: dvdson [rest part(linalg)]  ) = 2.250e-04 S  per = 2.09  per(accum) = 100
Detailed decomposition of T(renrm) = 6.741e-03 S  T(sum) = 6.741e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.749e-05 S  per = 0.556  per(accum) = 0.556
 T(local opt: qops init                    ) = 2.678e-04 S  per = 3.97  per(accum) = 4.53
 T(local opt: symbolic_formulae_renorm     ) = 5.144e-04 S  per = 7.63  per(accum) = 12.2
 T(local opt: allocate qops on gpu         ) = 5.049e-05 S  per = 0.749  per(accum) = 12.9
 T(local opt: site memcpy cpu2gpu          ) = 1.915e-05 S  per = 0.284  per(accum) = 13.2
 T(local opt: rintermediate init           ) = 3.839e-05 S  per = 0.57  per(accum) = 13.8
 T(local opt: preprocess_formulae_Rlist2   ) = 4.788e-04 S  per =  7.1  per(accum) = 20.9
 T(local opt: rmmtasks init                ) = 3.737e-04 S  per = 5.54  per(accum) = 26.4
 T(local opt: qops memset on cpu           ) = 3.100e-08 S  per = 0.00046  per(accum) = 26.4
 T(local opt: preprocess_renorm_batchGPU   ) = 1.284e-03 S  per =   19  per(accum) = 45.5
 T(local opt: deallocate cpu and gpu memory) = 3.260e-05 S  per = 0.484  per(accum) = 45.9
 T(local opt: construct opS [ifdists=true] ) = 3.071e-03 S  per = 45.6  per(accum) = 91.5
 T(local opt: reduction of opS & opH [nccl]) = 1.717e-05 S  per = 0.255  per(accum) = 91.8
 T(local opt: qops memcpy gpu2cpu          ) = 4.225e-05 S  per = 0.627  per(accum) = 92.4
 T(local opt: reduction of opS & opH [mpi] ) = 9.973e-06 S  per = 0.148  per(accum) = 92.5
 T(local opt: qops_pool join and erase     ) = 5.026e-04 S  per = 7.46  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 8.620e-07 S  per = 0.0128  per(accum) = 100
ctns::rcanon_save_site idx=15 scratch=./scratch/sweep size=213:1.6e-06GB T(load)=0.00059S speed=0.0027GB/S
##### sweep opt: 1.790e+00 S #####
 T(sweep opt: fetch) = 1.065e-01 S  per = 5.95  per(accum) = 5.95
 T(sweep opt: hdiag) = 2.845e-02 S  per = 1.59  per(accum) = 7.54
 T(sweep opt: dvdsn) = 9.320e-01 S  per = 52.1  per(accum) = 59.6
 T(sweep opt: decim) = 3.860e-02 S  per = 2.16  per(accum) = 61.8
 T(sweep opt: guess) = 1.794e-03 S  per =  0.1  per(accum) = 61.9
 T(sweep opt: renrm) = 6.167e-01 S  per = 34.5  per(accum) = 96.3
 T(sweep opt: save ) = 6.551e-02 S  per = 3.66  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.320e-01 S  T(sum) = 9.142e-01 S  per = 9.809e+01
 T(sweep opt: preprocess                  ) = 2.292e-03 S  per = 0.251  per(accum) = 0.251
 T(sweep opt: symbolic_formulae           ) = 2.729e-02 S  per = 2.98  per(accum) = 3.24
 T(sweep opt: hintermediate init          ) = 1.984e-03 S  per = 0.217  per(accum) = 3.45
 T(sweep opt: preprocess_hformulae_Hxlist ) = 9.543e-02 S  per = 10.4  per(accum) = 13.9
 T(sweep opt: hmmtasks init               ) = 9.697e-02 S  per = 10.6  per(accum) = 24.5
 T(sweep opt: initial guess for dvdson    ) = 1.931e-04 S  per = 0.0211  per(accum) = 24.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.583e-01 S  per =   72  per(accum) = 96.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 5.204e-03 S  per = 0.569  per(accum) = 97.1
 T(sweep opt: dvdson [nccl]               ) = 1.114e-02 S  per = 1.22  per(accum) = 98.3
 T(sweep opt: dvdson [mpi]                ) = 9.673e-05 S  per = 0.0106  per(accum) = 98.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.532e-02 S  per = 1.68  per(accum) = 100
Detailed decomposition of T(renrm) = 6.167e-01 S  T(sum) = 6.167e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.837e-03 S  per = 0.298  per(accum) = 0.298
 T(sweep opt: qops init                    ) = 1.608e-02 S  per = 2.61  per(accum) = 2.9
 T(sweep opt: symbolic_formulae_renorm     ) = 1.689e-02 S  per = 2.74  per(accum) = 5.64
 T(sweep opt: allocate qops on gpu         ) = 2.183e-03 S  per = 0.354  per(accum) = 6
 T(sweep opt: site memcpy cpu2gpu          ) = 7.804e-04 S  per = 0.127  per(accum) = 6.12
 T(sweep opt: rintermediate init           ) = 1.744e-03 S  per = 0.283  per(accum) = 6.41
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.327e-02 S  per = 5.39  per(accum) = 11.8
 T(sweep opt: rmmtasks init                ) = 3.568e-02 S  per = 5.79  per(accum) = 17.6
 T(sweep opt: qops memset on cpu           ) = 1.587e-06 S  per = 0.000257  per(accum) = 17.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.468e-02 S  per = 8.87  per(accum) = 26.5
 T(sweep opt: deallocate cpu and gpu memory) = 4.874e-03 S  per = 0.79  per(accum) = 27.2
 T(sweep opt: construct opS [ifdists=true] ) = 4.096e-01 S  per = 66.4  per(accum) = 93.7
 T(sweep opt: reduction of opS & opH [nccl]) = 7.689e-04 S  per = 0.125  per(accum) = 93.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.125e-03 S  per = 0.669  per(accum) = 94.5
 T(sweep opt: reduction of opS & opH [mpi] ) = 8.647e-04 S  per = 0.14  per(accum) = 94.6
 T(sweep opt: qops_pool join and erase     ) = 2.111e-02 S  per = 3.42  per(accum) = 98
 T(sweep opt: conversion from opAB to opPQ ) = 1.220e-02 S  per = 1.98  per(accum) = 100
##### global opt: 1.790e+00 S #####
 T(global opt: fetch) = 1.065e-01 S  per = 5.95  per(accum) = 5.95
 T(global opt: hdiag) = 2.845e-02 S  per = 1.59  per(accum) = 7.54
 T(global opt: dvdsn) = 9.320e-01 S  per = 52.1  per(accum) = 59.6
 T(global opt: decim) = 3.860e-02 S  per = 2.16  per(accum) = 61.8
 T(global opt: guess) = 1.794e-03 S  per =  0.1  per(accum) = 61.9
 T(global opt: renrm) = 6.167e-01 S  per = 34.5  per(accum) = 96.3
 T(global opt: save ) = 6.551e-02 S  per = 3.66  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.320e-01 S  T(sum) = 9.142e-01 S  per = 9.809e+01
 T(global opt: preprocess                  ) = 2.292e-03 S  per = 0.251  per(accum) = 0.251
 T(global opt: symbolic_formulae           ) = 2.729e-02 S  per = 2.98  per(accum) = 3.24
 T(global opt: hintermediate init          ) = 1.984e-03 S  per = 0.217  per(accum) = 3.45
 T(global opt: preprocess_hformulae_Hxlist ) = 9.543e-02 S  per = 10.4  per(accum) = 13.9
 T(global opt: hmmtasks init               ) = 9.697e-02 S  per = 10.6  per(accum) = 24.5
 T(global opt: initial guess for dvdson    ) = 1.931e-04 S  per = 0.0211  per(accum) = 24.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.583e-01 S  per =   72  per(accum) = 96.5
 T(global opt: dvdson [cpu-gpu]            ) = 5.204e-03 S  per = 0.569  per(accum) = 97.1
 T(global opt: dvdson [nccl]               ) = 1.114e-02 S  per = 1.22  per(accum) = 98.3
 T(global opt: dvdson [mpi]                ) = 9.673e-05 S  per = 0.0106  per(accum) = 98.3
 T(global opt: dvdson [rest part(linalg)]  ) = 1.532e-02 S  per = 1.68  per(accum) = 100
Detailed decomposition of T(renrm) = 6.167e-01 S  T(sum) = 6.167e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.837e-03 S  per = 0.298  per(accum) = 0.298
 T(global opt: qops init                    ) = 1.608e-02 S  per = 2.61  per(accum) = 2.9
 T(global opt: symbolic_formulae_renorm     ) = 1.689e-02 S  per = 2.74  per(accum) = 5.64
 T(global opt: allocate qops on gpu         ) = 2.183e-03 S  per = 0.354  per(accum) = 6
 T(global opt: site memcpy cpu2gpu          ) = 7.804e-04 S  per = 0.127  per(accum) = 6.12
 T(global opt: rintermediate init           ) = 1.744e-03 S  per = 0.283  per(accum) = 6.41
 T(global opt: preprocess_formulae_Rlist2   ) = 3.327e-02 S  per = 5.39  per(accum) = 11.8
 T(global opt: rmmtasks init                ) = 3.568e-02 S  per = 5.79  per(accum) = 17.6
 T(global opt: qops memset on cpu           ) = 1.587e-06 S  per = 0.000257  per(accum) = 17.6
 T(global opt: preprocess_renorm_batchGPU   ) = 5.468e-02 S  per = 8.87  per(accum) = 26.5
 T(global opt: deallocate cpu and gpu memory) = 4.874e-03 S  per = 0.79  per(accum) = 27.2
 T(global opt: construct opS [ifdists=true] ) = 4.096e-01 S  per = 66.4  per(accum) = 93.7
 T(global opt: reduction of opS & opH [nccl]) = 7.689e-04 S  per = 0.125  per(accum) = 93.8
 T(global opt: qops memcpy gpu2cpu          ) = 4.125e-03 S  per = 0.669  per(accum) = 94.5
 T(global opt: reduction of opS & opH [mpi] ) = 8.647e-04 S  per = 0.14  per(accum) = 94.6
 T(global opt: qops_pool join and erase     ) = 2.111e-02 S  per = 3.42  per(accum) = 98
 T(global opt: conversion from opAB to opPQ ) = 1.220e-02 S  per = 1.98  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-6.462e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=32/seqsize=34 dots=1 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=17 scratch=./scratch/sweep size=400:2.98e-06GB T(load)=3.09e-04S speed=9.66e-03GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=512:3.91e-03MB:3.81e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=112:8.54e-04MB:8.34e-07GB
total mem of comb=772:5.89e-03MB:5.75e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=9.865e-06 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=3,16,1
 suppl= 0 1 2
 suppr= 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 3
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:6 S:17 H:1 A:7 B:11 
        dim(bra,ket)=64,64 size(op)=400:3.052e-03MB size(tot)=12085:9.220e-02MB:9.004e-05GB
        per(mem): C:14.9 S:42.2 H:3.31 A:10.4 B:29.2 
 rqops: oplist=CSHPQ nops=C:32 S:4 H:1 P:14 Q:18 
        dim(bra,ket)=17,17 size(op)=63:0.000481MB size(tot)=1993:0.0152MB:1.48e-05GB
        per(mem): C:46.6 S:9.63 H:3.16 P:5.82 Q:34.8 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=16414:0.125MB:0.000122GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.122e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-9.120e-05 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(64,17,4) nnz=112:8.545e-04MB
qtensor3: wf3 own=1 _data=0x55b2c60ea000
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=16 dimAll=64
 (0,0):1 (2,0):9 (1,1):3 (1,-1):3 (4,0):9 (3,1):9 (3,-1):9 (2,2):3 (2,-2):3 (6,0):1 (5,1):3 (5,-1):3 (4,2):3 (4,-2):3 (3,3):1 (3,-3):1
 qbond: qcol nsym=6 dimAll=17
 (24,-2):5 (23,-1):4 (25,-3):4 (25,-1):2 (26,-4):1 (22,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=12 nblocks=384 size=112:8.545e-04MB
### DIAG TIMING: total=2.728e-04 t1=1.529e-05, t2=1.211e-05, t3=1.454e-05, t4=1.784e-04, t5=9.969e-06, t6=3.565e-05, t7=6.829e-06
duration_diagGPU:2.796e-04
duration_diagreduce:7.600e-08
duration_diagtransform:2.740e-07
----- TIMING FOR symbolic_formulae_onedot with size=150 : 3.552e-04 S -----
rank=0 GPUmem(GB): used=1.223e-04 (oper)=1.223e-04
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=150
 no. of hintermediate operators=57
 no. of coefficients=912:6.958e-03MB:6.795e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 2.743e-05 S -----
rank=0 GPUmem(GB): used=1.291e-04 (oper,hinter)=1.223e-04,6.795e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.919e-04 S size(H_formulae)=150 size(Hxlst2)=12 T(Hmu/Hxlist)=5.965e-05,2.322e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.684e-04 S size(H_formulae)=150 size(Hxlst)=1126 -----
rank=0 GPUmem(GB): used=1.291e-04 avail=3.829e+01 total=3.829e+01 dvdson[need]=1.669e-06 batch[need]=9.312e-04 blksize=45 blksize0=20 batchsize=1126
rank=0 GPUmem(GB): used=1.062e-03 (oper,hinter,dvdson,batch)=1.223e-04,6.795e-06,1.669e-06,9.312e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=112 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.608e-05,7.204e-05,5.196e-04,1.648e-04,8.282e-04
 analyze_tgpu[Hx]: ndim=112:8.345e-07GB T(cpu-gpu)=2.033e-05 speed=8.210e-02GB/S T(nccl)=4.575e-05 speed=3.648e-02GB/S
----- TIMING FOR sigma : t_inter=7.2e-05 t_gemm=5.2e-04 t_reduction=1.6e-04 tot=7.6e-04 -----
 sigma[inter] counter=215 t=7.2e-05 per=9.5e+00 cost=9.2e+04 flops=1.3e+09
 sigma[gemm] counter=215 i=0 t=1.8e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=215 i=1 t=1.6e-06 per=2.1e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=215 i=2 t=1.4e-04 per=1.9e+01 cost=3.0e+04 flops=2.1e+08
 sigma[gemm] counter=215 i=3 t=1.5e-04 per=2.0e+01 cost=3.1e+04 flops=2.0e+08
 sigma[gemm] counter=215 i=4 t=1.1e-04 per=1.4e+01 cost=3.1e+04 flops=2.9e+08
 sigma[gemm] counter=215 i=5 t=1.1e-04 per=1.5e+01 cost=3.4e+04 flops=3.0e+08
 sigma[gemm] counter=215 total t=5.2e-04 per=6.9e+01 cost=1.3e+05 flops=2.4e+08
 sigma[red] counter=215 t=1.6e-04 per=2.2e+01 cost=2.2e+04 flops=1.3e+08
----- TIMING FOR sigma_tot : t_inter=2.9e-02 t_gemm=5.2e-01 t_reduction=7.0e-02 tot=6.2e-01 -----
 sigma_tot[inter] counter=215 t=2.9e-02 per=4.7e+00 cost=9.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=215 i=0 t=4.6e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=215 i=1 t=4.3e-04 per=6.9e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=215 i=2 t=1.2e-01 per=2.0e+01 cost=8.2e+08 flops=6.6e+09
 sigma_tot[gemm] counter=215 i=3 t=1.6e-01 per=2.5e+01 cost=8.1e+08 flops=5.1e+09
 sigma_tot[gemm] counter=215 i=4 t=1.2e-01 per=1.9e+01 cost=6.8e+08 flops=5.8e+09
 sigma_tot[gemm] counter=215 i=5 t=1.2e-01 per=1.9e+01 cost=7.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=215 total t=5.2e-01 per=8.4e+01 cost=3.0e+09 flops=5.8e+09
 sigma_tot[red] counter=215 t=7.0e-02 per=1.1e+01 cost=2.0e+08 flops=2.8e+09
T(sub)=7.9e-06 T(gemm/eig/ortho/gemm/axpy)=3.3e-06,2.6e-06,9.5e-07,8.8e-07,1.7e-07
settings: ndim=112 neig=1 maxcycle=30 nbuff=4 memory=1e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -    -116.546006420381 -1.117e+03  5.512e-03    1     1  9.265e-04 9.265e-04 9.098e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.157e-05,6.149e-05,6.156e-04,1.799e-04,9.225e-04
 analyze_tgpu[Hx]: ndim=112:8.345e-07GB T(cpu-gpu)=2.111e-05 speed=7.905e-02GB/S T(nccl)=4.046e-05 speed=4.125e-02GB/S
----- TIMING FOR sigma : t_inter=6.1e-05 t_gemm=6.2e-04 t_reduction=1.8e-04 tot=8.6e-04 -----
 sigma[inter] counter=216 t=6.1e-05 per=7.2e+00 cost=9.2e+04 flops=1.5e+09
 sigma[gemm] counter=216 i=0 t=2.0e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=216 i=1 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=216 i=2 t=1.6e-04 per=1.9e+01 cost=3.0e+04 flops=1.9e+08
 sigma[gemm] counter=216 i=3 t=1.8e-04 per=2.1e+01 cost=3.1e+04 flops=1.7e+08
 sigma[gemm] counter=216 i=4 t=1.3e-04 per=1.5e+01 cost=3.1e+04 flops=2.4e+08
 sigma[gemm] counter=216 i=5 t=1.4e-04 per=1.6e+01 cost=3.4e+04 flops=2.5e+08
 sigma[gemm] counter=216 total t=6.2e-04 per=7.2e+01 cost=1.3e+05 flops=2.0e+08
 sigma[red] counter=216 t=1.8e-04 per=2.1e+01 cost=2.2e+04 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=2.9e-02 t_gemm=5.2e-01 t_reduction=7.0e-02 tot=6.2e-01 -----
 sigma_tot[inter] counter=216 t=2.9e-02 per=4.7e+00 cost=9.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=216 i=0 t=4.6e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=216 i=1 t=4.3e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=216 i=2 t=1.2e-01 per=2.0e+01 cost=8.2e+08 flops=6.5e+09
 sigma_tot[gemm] counter=216 i=3 t=1.6e-01 per=2.5e+01 cost=8.1e+08 flops=5.1e+09
 sigma_tot[gemm] counter=216 i=4 t=1.2e-01 per=1.9e+01 cost=6.8e+08 flops=5.8e+09
 sigma_tot[gemm] counter=216 i=5 t=1.2e-01 per=1.9e+01 cost=7.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=216 total t=5.2e-01 per=8.4e+01 cost=3.0e+09 flops=5.8e+09
 sigma_tot[red] counter=216 t=7.0e-02 per=1.1e+01 cost=2.0e+08 flops=2.8e+09
T(sub)=1.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,9.5e-06,2.3e-06,1.2e-06,2.7e-07
    2   0 -    -116.546037752458 -3.133e-05  5.340e-04    2     2  1.989e-03 9.946e-04 9.601e-04
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=5.983e-05,5.962e-05,6.192e-04,1.858e-04,9.284e-04
 analyze_tgpu[Hx]: ndim=112:8.345e-07GB T(cpu-gpu)=2.041e-05 speed=8.177e-02GB/S T(nccl)=3.942e-05 speed=4.234e-02GB/S
----- TIMING FOR sigma : t_inter=6.0e-05 t_gemm=6.2e-04 t_reduction=1.9e-04 tot=8.6e-04 -----
 sigma[inter] counter=217 t=6.0e-05 per=6.9e+00 cost=9.2e+04 flops=1.5e+09
 sigma[gemm] counter=217 i=0 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=217 i=1 t=1.9e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=217 i=2 t=1.6e-04 per=1.9e+01 cost=3.0e+04 flops=1.9e+08
 sigma[gemm] counter=217 i=3 t=1.9e-04 per=2.2e+01 cost=3.1e+04 flops=1.7e+08
 sigma[gemm] counter=217 i=4 t=1.3e-04 per=1.5e+01 cost=3.1e+04 flops=2.4e+08
 sigma[gemm] counter=217 i=5 t=1.4e-04 per=1.6e+01 cost=3.4e+04 flops=2.4e+08
 sigma[gemm] counter=217 total t=6.2e-04 per=7.2e+01 cost=1.3e+05 flops=2.0e+08
 sigma[red] counter=217 t=1.9e-04 per=2.1e+01 cost=2.2e+04 flops=1.2e+08
----- TIMING FOR sigma_tot : t_inter=2.9e-02 t_gemm=5.2e-01 t_reduction=7.0e-02 tot=6.2e-01 -----
 sigma_tot[inter] counter=217 t=2.9e-02 per=4.7e+00 cost=9.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=217 i=0 t=4.6e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=217 i=1 t=4.3e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=217 i=2 t=1.3e-01 per=2.0e+01 cost=8.2e+08 flops=6.5e+09
 sigma_tot[gemm] counter=217 i=3 t=1.6e-01 per=2.5e+01 cost=8.1e+08 flops=5.1e+09
 sigma_tot[gemm] counter=217 i=4 t=1.2e-01 per=1.9e+01 cost=6.8e+08 flops=5.8e+09
 sigma_tot[gemm] counter=217 i=5 t=1.2e-01 per=1.9e+01 cost=7.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=217 total t=5.2e-01 per=8.4e+01 cost=3.0e+09 flops=5.8e+09
 sigma_tot[red] counter=217 t=7.0e-02 per=1.1e+01 cost=2.0e+08 flops=2.8e+09
T(sub)=1.9e-05 T(gemm/eig/ortho/gemm/axpy)=3.5e-06,1.2e-05,1.8e-06,1.3e-06,2.1e-07
    3   0 +    -116.546038094875 -3.424e-07  7.788e-05    3     3  3.133e-03 1.044e-03 1.006e-03
TIMING FOR Davidson : 3.145e-03  T(cal/comm/rest)=3.018e-03,1.254e-06,1.251e-04
decomposed t_rest=1.251e-04
 T(sub)    =4.421e-05 per=3.535e+01
 T(precond)=1.044e-05 per=8.351e+00
 T(ortho)  =3.608e-06 per=2.885e+00
 T(xcopy)  =5.050e-07 per=4.038e-01
 T(xnrm2)  =5.560e-07 per=4.446e-01
 T(other)  =6.574e-05 per=5.257e+01
optimized energies: isweep=0 ibond=32 dots=1 e[0]=-116.546038094875 nmvp=3
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=4.070e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=14 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond32.txt
 qbond: qsuper nsym=14 dimAll=68
 (24,-2):9 (23,-1):5 (25,-3):9 (25,-1):11 (26,-4):5 (22,0):1 (26,-2):11 (27,-3):5 (27,-1):2 (28,-4):1 (24,0):5 (26,0):2 (23,1):1 (27,-5):1
timing for divide=2.5e-06
timing for compute=4.3e-05
timing for collect=3.8e-06
----- TMING FOR decimation_genbasis(nkr): 4.9e-05 S T(divide/compute[cpu/gpu/rest]/collect)=2.5e-06,4.1e-05,0.0e+00,2.2e-06,3.8e-06 -----
decimation summary: 68->12 dwt=+0.000e+00 SvN=9.607e-01
 qbond: qkept nsym=6 dimAll=12
 (25,-1):3 (26,-2):3 (27,-1):2 (26,0):2 (27,-3):1 (24,0):1
----- TIMING for decimation_row(nkr): 8.803e-04 S T(decim/select/formRot)=7.296e-05,7.968e-04,1.048e-05 -----
----- TIMING FOR onedot_decimation: 9.124e-04 S T(wf/decim)=2.337e-05,8.890e-04 -----
ctns::oper_renorm coord=(3,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:34 S:3 H:1 P:7 Q:11 
        dim(bra,ket)=12,12 size(op)=28:2.136e-04MB size(tot)=864:6.592e-03MB:6.437e-06GB
        per(mem): C:61 S:6.6 H:3.24 P:5.09 Q:24.1 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=4.663e-05 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=53 : 3.319e-04 S -----
rank=0 GPUmem(GB): used=4.549e-05 (oper)=3.869e-05
rank=0 GPUmem(GB): used=4.611e-05 (oper,site)=3.869e-05,6.258e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=53
 no. of rintermediate operators=45
 no. of coefficients=720:5.493e-03MB:5.364e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.463e-05 S -----
rank=0 GPUmem(GB): used=5.148e-05 (oper,site,rinter)=3.869e-05,6.258e-07,5.364e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.355e-04 S size(rtasks)=53 size(Rlst2)=36 T(Rmu/Rlist)=5.900e-05,1.764e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.600e-04 S size(rtasks)=53 size(Rlst)=597 -----
rank=0 GPUmem(GB): used=5.148e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.268e-04 blksize=15 blksize0=20 batchsize=597
rank=0 GPUmem(GB): used=2.783e-04 (oper,site,rinter,batch)=3.869e-05,6.258e-07,5.364e-06,2.268e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.158e-05,5.071e-04,1.246e-04
----- TIMING FOR renorm : t_inter=8.2e-05 t_gemm=5.1e-04 t_reduction=1.2e-04 tot=7.1e-04 -----
 renorm[inter] counter=701 t=8.2e-05 per=1.1e+01 cost=3.2e+04 flops=3.9e+08
 renorm[gemm] counter=701 i=0 t=2.0e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=701 i=1 t=1.9e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=701 i=2 t=1.3e-04 per=1.9e+01 cost=8.5e+03 flops=6.4e+07
 renorm[gemm] counter=701 i=3 t=2.0e-04 per=2.8e+01 cost=2.2e+04 flops=1.1e+08
 renorm[gemm] counter=701 i=4 t=1.9e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=701 i=5 t=1.9e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=701 i=6 t=1.6e-04 per=2.3e+01 cost=2.4e+04 flops=1.5e+08
 renorm[gemm] counter=701 total t=5.1e-04 per=7.1e+01 cost=5.4e+04 flops=1.1e+08
 renorm[red] counter=701 t=1.2e-04 per=1.7e+01 cost=6.3e+03 flops=5.1e+07
----- TIMING FOR renorm_tot : t_inter=4.3e-03 t_gemm=3.8e-02 t_reduction=8.4e-03 tot=5.0e-02 -----
 renorm_tot[inter] counter=701 t=4.3e-03 per=8.5e+00 cost=3.2e+07 flops=7.5e+09
 renorm_tot[gemm] counter=701 i=0 t=6.8e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=701 i=1 t=6.1e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=701 i=2 t=4.7e-03 per=9.4e+00 cost=7.1e+06 flops=1.5e+09
 renorm_tot[gemm] counter=701 i=3 t=8.0e-03 per=1.6e+01 cost=2.3e+07 flops=2.8e+09
 renorm_tot[gemm] counter=701 i=4 t=4.6e-03 per=9.1e+00 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=701 i=5 t=6.5e-03 per=1.3e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=701 i=6 t=1.4e-02 per=2.7e+01 cost=7.6e+07 flops=5.5e+09
 renorm_tot[gemm] counter=701 total t=3.8e-02 per=7.5e+01 cost=1.4e+08 flops=3.7e+09
 renorm_tot[red] counter=701 t=8.4e-03 per=1.7e+01 cost=9.2e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=5.242e-05 (oper)=3.883e-05
rank=0 GPUmem(GB): used=5.305e-05 (oper,site,rinter)=3.883e-05,6.258e-07,1.431e-06
rank=0 GPUmem(GB): used=6.407e-05 (oper,site,rinter,batch)=3.883e-05,6.258e-07,1.431e-06,1.102e-05
----- TIMING FOR preprocess_renorm_batchGPU_opS : 2.209e-03 S T(preprocess/alloc/comp/red/dealloc)=2.704e-04,3.028e-04,1.667e-03,1.864e-04,3.932e-05 -----
----- TIMING FOR oper_renorm_opS : 2.221e-03 S rank=0 -----
qops.to_cpu: size(tot)=864:6.592e-03MB:6.437e-06GB T(to_cpu)=2.685e-05S speed=2.398e-01GB/S
check ||H-H.dagger||=5.389e-15 coord=(3,0) rank=0
----- TIMING FOR oper_renorm : 0.00429 S rank=0 -----
rank=0 CPUmem(GB): used=1.347e+00 pageheap_free=0.000e+00 change=2.238e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=1.587e-03 change=-1.325e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=1.587e-03 change=-1.967e-06 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 1.528e-02 S #####
 T(local opt: fetch) = 2.835e-03 S  per = 18.6  per(accum) = 18.6
 T(local opt: hdiag) = 3.086e-04 S  per = 2.02  per(accum) = 20.6
 T(local opt: dvdsn) = 4.579e-03 S  per =   30  per(accum) = 50.5
 T(local opt: decim) = 9.364e-04 S  per = 6.13  per(accum) = 56.7
 T(local opt: guess) = 3.377e-05 S  per = 0.221  per(accum) = 56.9
 T(local opt: renrm) = 4.836e-03 S  per = 31.6  per(accum) = 88.5
 T(local opt: save ) = 1.753e-03 S  per = 11.5  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.579e-03 S  T(sum) = 4.309e-03 S  per = 9.412e+01
 T(local opt: preprocess                  ) = 9.908e-05 S  per =  2.3  per(accum) = 2.3
 T(local opt: symbolic_formulae           ) = 3.606e-04 S  per = 8.37  per(accum) = 10.7
 T(local opt: hintermediate init          ) = 3.501e-05 S  per = 0.813  per(accum) = 11.5
 T(local opt: preprocess_hformulae_Hxlist ) = 3.731e-04 S  per = 8.66  per(accum) = 20.1
 T(local opt: hmmtasks init               ) = 2.942e-04 S  per = 6.83  per(accum) = 27
 T(local opt: initial guess for dvdson    ) = 2.457e-06 S  per = 0.057  per(accum) = 27
 T(local opt: dvdson [Hx_batchGPU]        ) = 2.831e-03 S  per = 65.7  per(accum) = 92.7
 T(local opt: dvdson [cpu-gpu]            ) = 6.185e-05 S  per = 1.44  per(accum) = 94.2
 T(local opt: dvdson [nccl]               ) = 1.256e-04 S  per = 2.92  per(accum) = 97.1
 T(local opt: dvdson [mpi]                ) = 1.254e-06 S  per = 0.0291  per(accum) = 97.1
 T(local opt: dvdson [rest part(linalg)]  ) = 1.251e-04 S  per =  2.9  per(accum) = 100
Detailed decomposition of T(renrm) = 4.836e-03 S  T(sum) = 4.836e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.635e-05 S  per = 0.752  per(accum) = 0.752
 T(local opt: qops init                    ) = 2.368e-04 S  per =  4.9  per(accum) = 5.65
 T(local opt: symbolic_formulae_renorm     ) = 3.369e-04 S  per = 6.97  per(accum) = 12.6
 T(local opt: allocate qops on gpu         ) = 4.945e-05 S  per = 1.02  per(accum) = 13.6
 T(local opt: site memcpy cpu2gpu          ) = 1.887e-05 S  per = 0.39  per(accum) = 14
 T(local opt: rintermediate init           ) = 3.087e-05 S  per = 0.638  per(accum) = 14.7
 T(local opt: preprocess_formulae_Rlist2   ) = 2.647e-04 S  per = 5.47  per(accum) = 20.1
 T(local opt: rmmtasks init                ) = 2.495e-04 S  per = 5.16  per(accum) = 25.3
 T(local opt: qops memset on cpu           ) = 3.000e-08 S  per = 0.00062  per(accum) = 25.3
 T(local opt: preprocess_renorm_batchGPU   ) = 7.998e-04 S  per = 16.5  per(accum) = 41.8
 T(local opt: deallocate cpu and gpu memory) = 2.675e-05 S  per = 0.553  per(accum) = 42.4
 T(local opt: construct opS [ifdists=true] ) = 2.226e-03 S  per =   46  per(accum) = 88.4
 T(local opt: reduction of opS & opH [nccl]) = 1.730e-05 S  per = 0.358  per(accum) = 88.8
 T(local opt: qops memcpy gpu2cpu          ) = 3.077e-05 S  per = 0.636  per(accum) = 89.4
 T(local opt: reduction of opS & opH [mpi] ) = 6.435e-06 S  per = 0.133  per(accum) = 89.5
 T(local opt: qops_pool join and erase     ) = 5.047e-04 S  per = 10.4  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 7.590e-07 S  per = 0.0157  per(accum) = 100
ctns::rcanon_save_site idx=16 scratch=./scratch/sweep size=84:6.3e-07GB T(load)=0.00059S speed=0.0011GB/S
##### sweep opt: 1.805e+00 S #####
 T(sweep opt: fetch) = 1.093e-01 S  per = 6.06  per(accum) = 6.06
 T(sweep opt: hdiag) = 2.875e-02 S  per = 1.59  per(accum) = 7.65
 T(sweep opt: dvdsn) = 9.366e-01 S  per = 51.9  per(accum) = 59.5
 T(sweep opt: decim) = 3.953e-02 S  per = 2.19  per(accum) = 61.7
 T(sweep opt: guess) = 1.828e-03 S  per = 0.101  per(accum) = 61.8
 T(sweep opt: renrm) = 6.216e-01 S  per = 34.4  per(accum) = 96.3
 T(sweep opt: save ) = 6.727e-02 S  per = 3.73  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.366e-01 S  T(sum) = 9.185e-01 S  per = 9.807e+01
 T(sweep opt: preprocess                  ) = 2.391e-03 S  per = 0.26  per(accum) = 0.26
 T(sweep opt: symbolic_formulae           ) = 2.765e-02 S  per = 3.01  per(accum) = 3.27
 T(sweep opt: hintermediate init          ) = 2.019e-03 S  per = 0.22  per(accum) = 3.49
 T(sweep opt: preprocess_hformulae_Hxlist ) = 9.580e-02 S  per = 10.4  per(accum) = 13.9
 T(sweep opt: hmmtasks init               ) = 9.726e-02 S  per = 10.6  per(accum) = 24.5
 T(sweep opt: initial guess for dvdson    ) = 1.956e-04 S  per = 0.0213  per(accum) = 24.5
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.611e-01 S  per =   72  per(accum) = 96.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 5.266e-03 S  per = 0.573  per(accum) = 97.1
 T(sweep opt: dvdson [nccl]               ) = 1.127e-02 S  per = 1.23  per(accum) = 98.3
 T(sweep opt: dvdson [mpi]                ) = 9.798e-05 S  per = 0.0107  per(accum) = 98.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.544e-02 S  per = 1.68  per(accum) = 100
Detailed decomposition of T(renrm) = 6.216e-01 S  T(sum) = 6.216e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.873e-03 S  per = 0.301  per(accum) = 0.301
 T(sweep opt: qops init                    ) = 1.631e-02 S  per = 2.62  per(accum) = 2.93
 T(sweep opt: symbolic_formulae_renorm     ) = 1.723e-02 S  per = 2.77  per(accum) = 5.7
 T(sweep opt: allocate qops on gpu         ) = 2.232e-03 S  per = 0.359  per(accum) = 6.06
 T(sweep opt: site memcpy cpu2gpu          ) = 7.993e-04 S  per = 0.129  per(accum) = 6.18
 T(sweep opt: rintermediate init           ) = 1.775e-03 S  per = 0.286  per(accum) = 6.47
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.353e-02 S  per =  5.4  per(accum) = 11.9
 T(sweep opt: rmmtasks init                ) = 3.593e-02 S  per = 5.78  per(accum) = 17.6
 T(sweep opt: qops memset on cpu           ) = 1.617e-06 S  per = 0.00026  per(accum) = 17.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.548e-02 S  per = 8.93  per(accum) = 26.6
 T(sweep opt: deallocate cpu and gpu memory) = 4.901e-03 S  per = 0.788  per(accum) = 27.4
 T(sweep opt: construct opS [ifdists=true] ) = 4.119e-01 S  per = 66.3  per(accum) = 93.6
 T(sweep opt: reduction of opS & opH [nccl]) = 7.862e-04 S  per = 0.126  per(accum) = 93.8
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.155e-03 S  per = 0.669  per(accum) = 94.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 8.712e-04 S  per = 0.14  per(accum) = 94.6
 T(sweep opt: qops_pool join and erase     ) = 2.162e-02 S  per = 3.48  per(accum) = 98
 T(sweep opt: conversion from opAB to opPQ ) = 1.220e-02 S  per = 1.96  per(accum) = 100
##### global opt: 1.805e+00 S #####
 T(global opt: fetch) = 1.093e-01 S  per = 6.06  per(accum) = 6.06
 T(global opt: hdiag) = 2.875e-02 S  per = 1.59  per(accum) = 7.65
 T(global opt: dvdsn) = 9.366e-01 S  per = 51.9  per(accum) = 59.5
 T(global opt: decim) = 3.953e-02 S  per = 2.19  per(accum) = 61.7
 T(global opt: guess) = 1.828e-03 S  per = 0.101  per(accum) = 61.8
 T(global opt: renrm) = 6.216e-01 S  per = 34.4  per(accum) = 96.3
 T(global opt: save ) = 6.727e-02 S  per = 3.73  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.366e-01 S  T(sum) = 9.185e-01 S  per = 9.807e+01
 T(global opt: preprocess                  ) = 2.391e-03 S  per = 0.26  per(accum) = 0.26
 T(global opt: symbolic_formulae           ) = 2.765e-02 S  per = 3.01  per(accum) = 3.27
 T(global opt: hintermediate init          ) = 2.019e-03 S  per = 0.22  per(accum) = 3.49
 T(global opt: preprocess_hformulae_Hxlist ) = 9.580e-02 S  per = 10.4  per(accum) = 13.9
 T(global opt: hmmtasks init               ) = 9.726e-02 S  per = 10.6  per(accum) = 24.5
 T(global opt: initial guess for dvdson    ) = 1.956e-04 S  per = 0.0213  per(accum) = 24.5
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.611e-01 S  per =   72  per(accum) = 96.5
 T(global opt: dvdson [cpu-gpu]            ) = 5.266e-03 S  per = 0.573  per(accum) = 97.1
 T(global opt: dvdson [nccl]               ) = 1.127e-02 S  per = 1.23  per(accum) = 98.3
 T(global opt: dvdson [mpi]                ) = 9.798e-05 S  per = 0.0107  per(accum) = 98.3
 T(global opt: dvdson [rest part(linalg)]  ) = 1.544e-02 S  per = 1.68  per(accum) = 100
Detailed decomposition of T(renrm) = 6.216e-01 S  T(sum) = 6.216e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.873e-03 S  per = 0.301  per(accum) = 0.301
 T(global opt: qops init                    ) = 1.631e-02 S  per = 2.62  per(accum) = 2.93
 T(global opt: symbolic_formulae_renorm     ) = 1.723e-02 S  per = 2.77  per(accum) = 5.7
 T(global opt: allocate qops on gpu         ) = 2.232e-03 S  per = 0.359  per(accum) = 6.06
 T(global opt: site memcpy cpu2gpu          ) = 7.993e-04 S  per = 0.129  per(accum) = 6.18
 T(global opt: rintermediate init           ) = 1.775e-03 S  per = 0.286  per(accum) = 6.47
 T(global opt: preprocess_formulae_Rlist2   ) = 3.353e-02 S  per =  5.4  per(accum) = 11.9
 T(global opt: rmmtasks init                ) = 3.593e-02 S  per = 5.78  per(accum) = 17.6
 T(global opt: qops memset on cpu           ) = 1.617e-06 S  per = 0.00026  per(accum) = 17.6
 T(global opt: preprocess_renorm_batchGPU   ) = 5.548e-02 S  per = 8.93  per(accum) = 26.6
 T(global opt: deallocate cpu and gpu memory) = 4.901e-03 S  per = 0.788  per(accum) = 27.4
 T(global opt: construct opS [ifdists=true] ) = 4.119e-01 S  per = 66.3  per(accum) = 93.6
 T(global opt: reduction of opS & opH [nccl]) = 7.862e-04 S  per = 0.126  per(accum) = 93.8
 T(global opt: qops memcpy gpu2cpu          ) = 4.155e-03 S  per = 0.669  per(accum) = 94.4
 T(global opt: reduction of opS & opH [mpi] ) = 8.712e-04 S  per = 0.14  per(accum) = 94.6
 T(global opt: qops_pool join and erase     ) = 2.162e-02 S  per = 3.48  per(accum) = 98
 T(global opt: conversion from opAB to opPQ ) = 1.220e-02 S  per = 1.96  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-4.087e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 

isweep=0 ibond=33/seqsize=34 dots=1 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=0.000e+00 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_site idx=18 scratch=./scratch/sweep size=36:2.68e-07GB T(load)=3.08e-04S speed=8.70e-04GB/S
ctns::sweep_onedot ifabelian=1 alg_hvec=19 alg_renorm=19 mpisize=2 maxthreads=2
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:1.12e-03MB:1.10e-06GB
 sites: len=20 mem=436:3.33e-03MB:3.25e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=56:4.27e-04MB:4.17e-07GB
total mem of comb=640:4.88e-03MB:4.77e-06GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=2.071e-06 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::check_partition: (sl,sr,sc)=2,17,1
 suppl= 0 1
 suppr= 3 4 16 17 18 19 5 6 7 8 9 10 11 12 13 14 15
 suppc= 2
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:4 S:18 H:1 A:3 B:5 
        dim(bra,ket)=16,16 size(op)=36:2.747e-04MB size(tot)=742:5.661e-03MB:5.528e-06GB
        per(mem): C:12.9 S:58.2 H:4.85 A:5.12 B:18.9 
 rqops: oplist=CSHPQ nops=C:34 S:3 H:1 P:7 Q:11 
        dim(bra,ket)=12,12 size(op)=28:0.000214MB size(tot)=864:0.00659MB:6.44e-06GB
        per(mem): C:61 S:6.6 H:3.24 P:5.09 Q:24.1 
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=2336:0.0178MB:1.74e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 qops(tot)=3942:0.0301MB:2.94e-05GB
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.329e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-5.543e-06 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 after clear_from_cpumem
wf3(diml,dimr,dimc)=(16,12,4) nnz=56:4.272e-04MB
qtensor3: wf3 own=1 _data=0x55b2c6cc6e00
qinfo3: wf3 sym=(30,0) dir=1,1,1
 qbond: qrow nsym=9 dimAll=16
 (0,0):1 (2,0):4 (1,1):2 (1,-1):2 (4,0):1 (3,1):2 (3,-1):2 (2,2):1 (2,-2):1
 qbond: qcol nsym=6 dimAll=12
 (25,-1):3 (26,-2):3 (27,-1):2 (26,0):2 (27,-3):1 (24,0):1
 qbond: qmid nsym=4 dimAll=4
 (0,0):1 (2,0):1 (1,1):1 (1,-1):1
total no. of nonzero blocks=14 nblocks=216 size=56:4.272e-04MB
### DIAG TIMING: total=2.058e-04 t1=1.753e-05, t2=1.445e-05, t3=1.458e-05, t4=1.078e-04, t5=9.491e-06, t6=3.438e-05, t7=7.613e-06
duration_diagGPU:2.196e-04
duration_diagreduce:7.000e-08
duration_diagtransform:1.770e-07
----- TIMING FOR symbolic_formulae_onedot with size=98 : 2.227e-04 S -----
rank=0 GPUmem(GB): used=2.937e-05 (oper)=2.937e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of hformulae=98
 no. of hintermediate operators=29
 no. of coefficients=493:3.761e-03MB:3.673e-06GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.802e-05 S -----
rank=0 GPUmem(GB): used=3.304e-05 (oper,hinter)=2.937e-05,3.673e-06
----- TIMING FOR preprocess_formulae_Hxlist2 : 2.452e-04 S size(H_formulae)=98 size(Hxlst2)=14 T(Hmu/Hxlist)=3.949e-05,2.057e-04 -----
----- TIMING FOR preprocess_formulae_Hxlist : 3.440e-04 S size(H_formulae)=98 size(Hxlst)=1060 -----
rank=0 GPUmem(GB): used=3.304e-05 avail=3.829e+01 total=3.829e+01 dvdson[need]=8.345e-07 batch[need]=2.685e-04 blksize=12 blksize0=9 batchsize=1060
rank=0 GPUmem(GB): used=3.024e-04 (oper,hinter,dvdson,batch)=2.937e-05,3.673e-06,8.345e-07,2.685e-04
ctns::pdvdsonSolver_nkr::solve_iter ndim=56 is_complex=0 mpisize=2
preprocess_Hx_batchDirectGPUSingle: T(gpu,inter,gemm,reduction,tot)=6.913e-05,7.751e-05,6.345e-04,2.001e-04,9.871e-04
 analyze_tgpu[Hx]: ndim=56:4.172e-07GB T(cpu-gpu)=2.257e-05 speed=3.697e-02GB/S T(nccl)=4.656e-05 speed=1.792e-02GB/S
----- TIMING FOR sigma : t_inter=7.7e-05 t_gemm=6.3e-04 t_reduction=2.0e-04 tot=9.1e-04 -----
 sigma[inter] counter=218 t=7.7e-05 per=8.5e+00 cost=3.5e+04 flops=4.5e+08
 sigma[gemm] counter=218 i=0 t=1.7e-06 per=1.9e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=218 i=1 t=1.6e-06 per=1.8e-01 cost=0.0e+00 flops=0.0e+00
 sigma[gemm] counter=218 i=2 t=1.5e-04 per=1.7e+01 cost=8.1e+03 flops=5.4e+07
 sigma[gemm] counter=218 i=3 t=1.9e-04 per=2.0e+01 cost=8.3e+03 flops=4.5e+07
 sigma[gemm] counter=218 i=4 t=1.5e-04 per=1.7e+01 cost=6.7e+03 flops=4.4e+07
 sigma[gemm] counter=218 i=5 t=1.4e-04 per=1.6e+01 cost=6.8e+03 flops=4.8e+07
 sigma[gemm] counter=218 total t=6.3e-04 per=7.0e+01 cost=3.0e+04 flops=4.7e+07
 sigma[red] counter=218 t=2.0e-04 per=2.2e+01 cost=9.0e+03 flops=4.5e+07
----- TIMING FOR sigma_tot : t_inter=2.9e-02 t_gemm=5.2e-01 t_reduction=7.0e-02 tot=6.2e-01 -----
 sigma_tot[inter] counter=218 t=2.9e-02 per=4.7e+00 cost=9.2e+08 flops=3.2e+10
 sigma_tot[gemm] counter=218 i=0 t=4.7e-04 per=7.5e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=218 i=1 t=4.3e-04 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 sigma_tot[gemm] counter=218 i=2 t=1.3e-01 per=2.0e+01 cost=8.2e+08 flops=6.5e+09
 sigma_tot[gemm] counter=218 i=3 t=1.6e-01 per=2.5e+01 cost=8.1e+08 flops=5.1e+09
 sigma_tot[gemm] counter=218 i=4 t=1.2e-01 per=1.9e+01 cost=6.8e+08 flops=5.8e+09
 sigma_tot[gemm] counter=218 i=5 t=1.2e-01 per=1.9e+01 cost=7.0e+08 flops=5.9e+09
 sigma_tot[gemm] counter=218 total t=5.2e-01 per=8.4e+01 cost=3.0e+09 flops=5.8e+09
 sigma_tot[red] counter=218 t=7.0e-02 per=1.1e+01 cost=2.0e+08 flops=2.8e+09
T(sub)=9.1e-06 T(gemm/eig/ortho/gemm/axpy)=3.2e-06,3.5e-06,1.2e-06,1.0e-06,2.2e-07
settings: ndim=56 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +    -116.546038094875 -1.117e+03  4.869e-05    1     1  1.209e-03 1.209e-03 1.175e-03
TIMING FOR Davidson : 1.244e-03  T(cal/comm/rest)=1.175e-03,1.063e-06,6.826e-05
decomposed t_rest=6.826e-05
 T(sub)    =9.124e-06 per=1.337e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =2.610e-07 per=3.824e-01
 T(xnrm2)  =1.760e-07 per=2.578e-01
 T(other)  =5.870e-05 per=8.599e+01
optimized energies: isweep=0 ibond=33 dots=1 e[0]=-116.546038094875 nmvp=1
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=3.354e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,100,1,0.0e+00
ctns::decimation_row ifab=1 iftrunc=1 dcut=100 nqr=13 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_ibond33.txt
 qbond: qsuper nsym=13 dimAll=48
 (25,-1):4 (26,-2):6 (27,-1):10 (26,0):6 (27,-3):4 (24,0):1 (28,-2):6 (29,-1):2 (28,0):4 (29,-3):1 (27,1):2 (25,1):1 (28,-4):1
timing for divide=2.5e-06
timing for compute=6.7e-05
timing for collect=1.4e-05
----- TMING FOR decimation_genbasis(nkr): 8.4e-05 S T(divide/compute[cpu/gpu/rest]/collect)=2.5e-06,5.7e-05,0.0e+00,1.0e-05,1.4e-05 -----
decimation summary: 48->12 dwt=+1.110e-16 SvN=7.814e-01
 qbond: qkept nsym=6 dimAll=12
 (28,0):4 (27,-1):2 (29,-1):2 (27,1):2 (26,0):1 (28,-2):1
----- TIMING for decimation_row(nkr): 9.887e-04 S T(decim/select/formRot)=1.258e-04,8.391e-04,2.382e-05 -----
----- TIMING FOR onedot_decimation: 1.042e-03 S T(wf/decim)=3.034e-05,1.012e-03 -----
ctns::oper_renorm coord=(2,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:36 S:2 H:1 P:3 Q:5 
        dim(bra,ket)=12,12 size(op)=30:2.289e-04MB size(tot)=768:5.859e-03MB:5.722e-06GB
        per(mem): C:75 S:5.21 H:3.91 P:2.08 Q:13.8 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=3.526e-05 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=45 : 2.657e-04 S -----
rank=0 GPUmem(GB): used=3.324e-05 (oper)=2.956e-05
rank=0 GPUmem(GB): used=3.365e-05 (oper,site)=2.956e-05,4.172e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=45
 no. of rintermediate operators=21
 no. of coefficients=357:2.724e-03MB:2.660e-06GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.760e-05 S -----
rank=0 GPUmem(GB): used=3.631e-05 (oper,site,rinter)=2.956e-05,4.172e-07,2.660e-06
----- TIMING FOR preprocess_formulae_Rlist2 : 2.813e-04 S size(rtasks)=45 size(Rlst2)=36 T(Rmu/Rlist)=5.361e-05,2.277e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 3.678e-04 S size(rtasks)=45 size(Rlst)=638 -----
rank=0 GPUmem(GB): used=3.631e-05 avail=3.829e+01 total=3.829e+01 batch[need]=1.996e-04 blksize=16 blksize0=9 batchsize=638
rank=0 GPUmem(GB): used=2.360e-04 (oper,site,rinter,batch)=2.956e-05,4.172e-07,2.660e-06,1.996e-04
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.036e-04,5.552e-04,1.732e-04
----- TIMING FOR renorm : t_inter=1.0e-04 t_gemm=5.5e-04 t_reduction=1.7e-04 tot=8.3e-04 -----
 renorm[inter] counter=708 t=1.0e-04 per=1.2e+01 cost=1.2e+04 flops=1.2e+08
 renorm[gemm] counter=708 i=0 t=2.7e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=708 i=1 t=2.2e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=708 i=2 t=1.5e-04 per=1.8e+01 cost=3.1e+03 flops=2.1e+07
 renorm[gemm] counter=708 i=3 t=2.0e-04 per=2.4e+01 cost=7.6e+03 flops=3.8e+07
 renorm[gemm] counter=708 i=4 t=2.2e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=708 i=5 t=2.1e-06 per=2.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=708 i=6 t=2.0e-04 per=2.4e+01 cost=1.2e+04 flops=6.3e+07
 renorm[gemm] counter=708 total t=5.5e-04 per=6.7e+01 cost=2.3e+04 flops=4.1e+07
 renorm[red] counter=708 t=1.7e-04 per=2.1e+01 cost=5.7e+03 flops=3.3e+07
----- TIMING FOR renorm_tot : t_inter=4.4e-03 t_gemm=3.8e-02 t_reduction=8.5e-03 tot=5.1e-02 -----
 renorm_tot[inter] counter=708 t=4.4e-03 per=8.6e+00 cost=3.2e+07 flops=7.3e+09
 renorm_tot[gemm] counter=708 i=0 t=7.1e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=708 i=1 t=6.3e-05 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=708 i=2 t=4.9e-03 per=9.5e+00 cost=7.1e+06 flops=1.5e+09
 renorm_tot[gemm] counter=708 i=3 t=8.2e-03 per=1.6e+01 cost=2.3e+07 flops=2.7e+09
 renorm_tot[gemm] counter=708 i=4 t=4.6e-03 per=9.0e+00 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=708 i=5 t=6.5e-03 per=1.3e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=708 i=6 t=1.4e-02 per=2.7e+01 cost=7.6e+07 flops=5.5e+09
 renorm_tot[gemm] counter=708 total t=3.8e-02 per=7.5e+01 cost=1.4e+08 flops=3.7e+09
 renorm_tot[red] counter=708 t=8.5e-03 per=1.7e+01 cost=9.2e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=3.706e-05 (oper)=2.971e-05
rank=0 GPUmem(GB): used=3.748e-05 (oper,site,rinter)=2.971e-05,4.172e-07,1.013e-06
rank=0 GPUmem(GB): used=4.387e-05 (oper,site,rinter,batch)=2.971e-05,4.172e-07,1.013e-06,6.393e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 1.926e-03 S T(preprocess/alloc/comp/red/dealloc)=2.779e-04,3.436e-04,1.425e-03,9.289e-05,5.174e-05 -----
----- TIMING FOR oper_renorm_opS : 1.952e-03 S rank=0 -----
qops.to_cpu: size(tot)=768:5.859e-03MB:5.722e-06GB T(to_cpu)=2.950e-05S speed=1.940e-01GB/S
check ||H-H.dagger||=7.994e-15 coord=(2,0) rank=0
----- TIMING FOR oper_renorm : 0.00462 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=2.057e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.186e-03 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-1.624e-06 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
##### local opt: 1.367e-02 S #####
 T(local opt: fetch) = 2.646e-03 S  per = 19.4  per(accum) = 19.4
 T(local opt: hdiag) = 2.750e-04 S  per = 2.01  per(accum) = 21.4
 T(local opt: dvdsn) = 2.520e-03 S  per = 18.4  per(accum) = 39.8
 T(local opt: decim) = 1.080e-03 S  per =  7.9  per(accum) = 47.7
 T(local opt: guess) = 4.028e-05 S  per = 0.295  per(accum) = 48
 T(local opt: renrm) = 5.278e-03 S  per = 38.6  per(accum) = 86.6
 T(local opt: save ) = 1.827e-03 S  per = 13.4  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.520e-03 S  T(sum) = 2.253e-03 S  per = 8.940e+01
 T(local opt: preprocess                  ) = 5.127e-05 S  per = 2.28  per(accum) = 2.28
 T(local opt: symbolic_formulae           ) = 2.333e-04 S  per = 10.4  per(accum) = 12.6
 T(local opt: hintermediate init          ) = 5.873e-05 S  per = 2.61  per(accum) = 15.2
 T(local opt: preprocess_hformulae_Hxlist ) = 3.556e-04 S  per = 15.8  per(accum) = 31
 T(local opt: hmmtasks init               ) = 3.076e-04 S  per = 13.7  per(accum) = 44.7
 T(local opt: initial guess for dvdson    ) = 2.276e-06 S  per = 0.101  per(accum) = 44.8
 T(local opt: dvdson [Hx_batchGPU]        ) = 1.106e-03 S  per = 49.1  per(accum) = 93.9
 T(local opt: dvdson [cpu-gpu]            ) = 2.257e-05 S  per =    1  per(accum) = 94.9
 T(local opt: dvdson [nccl]               ) = 4.656e-05 S  per = 2.07  per(accum) = 96.9
 T(local opt: dvdson [mpi]                ) = 1.063e-06 S  per = 0.0472  per(accum) = 97
 T(local opt: dvdson [rest part(linalg)]  ) = 6.826e-05 S  per = 3.03  per(accum) = 100
Detailed decomposition of T(renrm) = 5.278e-03 S  T(sum) = 5.278e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 5.134e-05 S  per = 0.973  per(accum) = 0.973
 T(local opt: qops init                    ) = 3.031e-04 S  per = 5.74  per(accum) = 6.71
 T(local opt: symbolic_formulae_renorm     ) = 2.798e-04 S  per =  5.3  per(accum) = 12
 T(local opt: allocate qops on gpu         ) = 6.382e-05 S  per = 1.21  per(accum) = 13.2
 T(local opt: site memcpy cpu2gpu          ) = 3.212e-05 S  per = 0.608  per(accum) = 13.8
 T(local opt: rintermediate init           ) = 6.563e-05 S  per = 1.24  per(accum) = 15.1
 T(local opt: preprocess_formulae_Rlist2   ) = 3.814e-04 S  per = 7.23  per(accum) = 22.3
 T(local opt: rmmtasks init                ) = 3.228e-04 S  per = 6.12  per(accum) = 28.4
 T(local opt: qops memset on cpu           ) = 4.100e-08 S  per = 0.000777  per(accum) = 28.4
 T(local opt: preprocess_renorm_batchGPU   ) = 1.072e-03 S  per = 20.3  per(accum) = 48.7
 T(local opt: deallocate cpu and gpu memory) = 3.473e-05 S  per = 0.658  per(accum) = 49.4
 T(local opt: construct opS [ifdists=true] ) = 1.977e-03 S  per = 37.5  per(accum) = 86.8
 T(local opt: reduction of opS & opH [nccl]) = 1.940e-05 S  per = 0.367  per(accum) = 87.2
 T(local opt: qops memcpy gpu2cpu          ) = 4.385e-05 S  per = 0.831  per(accum) = 88
 T(local opt: reduction of opS & opH [mpi] ) = 2.006e-05 S  per = 0.38  per(accum) = 88.4
 T(local opt: qops_pool join and erase     ) = 6.104e-04 S  per = 11.6  per(accum) = 100
 T(local opt: conversion from opAB to opPQ ) = 9.430e-07 S  per = 0.0179  per(accum) = 100
ctns::rcanon_save_site idx=17 scratch=./scratch/sweep size=56:4.2e-07GB T(load)=0.00058S speed=0.00072GB/S
##### sweep opt: 1.819e+00 S #####
 T(sweep opt: fetch) = 1.120e-01 S  per = 6.16  per(accum) = 6.16
 T(sweep opt: hdiag) = 2.903e-02 S  per =  1.6  per(accum) = 7.75
 T(sweep opt: dvdsn) = 9.391e-01 S  per = 51.6  per(accum) = 59.4
 T(sweep opt: decim) = 4.061e-02 S  per = 2.23  per(accum) = 61.6
 T(sweep opt: guess) = 1.868e-03 S  per = 0.103  per(accum) = 61.7
 T(sweep opt: renrm) = 6.268e-01 S  per = 34.5  per(accum) = 96.2
 T(sweep opt: save ) = 6.909e-02 S  per =  3.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.391e-01 S  T(sum) = 9.208e-01 S  per = 9.805e+01
 T(sweep opt: preprocess                  ) = 2.442e-03 S  per = 0.265  per(accum) = 0.265
 T(sweep opt: symbolic_formulae           ) = 2.788e-02 S  per = 3.03  per(accum) = 3.29
 T(sweep opt: hintermediate init          ) = 2.078e-03 S  per = 0.226  per(accum) = 3.52
 T(sweep opt: preprocess_hformulae_Hxlist ) = 9.616e-02 S  per = 10.4  per(accum) = 14
 T(sweep opt: hmmtasks init               ) = 9.757e-02 S  per = 10.6  per(accum) = 24.6
 T(sweep opt: initial guess for dvdson    ) = 1.979e-04 S  per = 0.0215  per(accum) = 24.6
 T(sweep opt: dvdson [Hx_batchGPU]        ) = 6.622e-01 S  per = 71.9  per(accum) = 96.5
 T(sweep opt: dvdson [cpu-gpu]            ) = 5.289e-03 S  per = 0.574  per(accum) = 97.1
 T(sweep opt: dvdson [nccl]               ) = 1.132e-02 S  per = 1.23  per(accum) = 98.3
 T(sweep opt: dvdson [mpi]                ) = 9.905e-05 S  per = 0.0108  per(accum) = 98.3
 T(sweep opt: dvdson [rest part(linalg)]  ) = 1.551e-02 S  per = 1.68  per(accum) = 100
Detailed decomposition of T(renrm) = 6.268e-01 S  T(sum) = 6.268e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.924e-03 S  per = 0.307  per(accum) = 0.307
 T(sweep opt: qops init                    ) = 1.662e-02 S  per = 2.65  per(accum) = 2.96
 T(sweep opt: symbolic_formulae_renorm     ) = 1.751e-02 S  per = 2.79  per(accum) = 5.75
 T(sweep opt: allocate qops on gpu         ) = 2.296e-03 S  per = 0.366  per(accum) = 6.12
 T(sweep opt: site memcpy cpu2gpu          ) = 8.314e-04 S  per = 0.133  per(accum) = 6.25
 T(sweep opt: rintermediate init           ) = 1.840e-03 S  per = 0.294  per(accum) = 6.54
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.392e-02 S  per = 5.41  per(accum) = 12
 T(sweep opt: rmmtasks init                ) = 3.626e-02 S  per = 5.78  per(accum) = 17.7
 T(sweep opt: qops memset on cpu           ) = 1.658e-06 S  per = 0.000265  per(accum) = 17.7
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.655e-02 S  per = 9.02  per(accum) = 26.8
 T(sweep opt: deallocate cpu and gpu memory) = 4.935e-03 S  per = 0.787  per(accum) = 27.5
 T(sweep opt: construct opS [ifdists=true] ) = 4.138e-01 S  per =   66  per(accum) = 93.6
 T(sweep opt: reduction of opS & opH [nccl]) = 8.056e-04 S  per = 0.129  per(accum) = 93.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.199e-03 S  per = 0.67  per(accum) = 94.4
 T(sweep opt: reduction of opS & opH [mpi] ) = 8.912e-04 S  per = 0.142  per(accum) = 94.5
 T(sweep opt: qops_pool join and erase     ) = 2.223e-02 S  per = 3.55  per(accum) = 98.1
 T(sweep opt: conversion from opAB to opPQ ) = 1.220e-02 S  per = 1.95  per(accum) = 100
##### global opt: 1.819e+00 S #####
 T(global opt: fetch) = 1.120e-01 S  per = 6.16  per(accum) = 6.16
 T(global opt: hdiag) = 2.903e-02 S  per =  1.6  per(accum) = 7.75
 T(global opt: dvdsn) = 9.391e-01 S  per = 51.6  per(accum) = 59.4
 T(global opt: decim) = 4.061e-02 S  per = 2.23  per(accum) = 61.6
 T(global opt: guess) = 1.868e-03 S  per = 0.103  per(accum) = 61.7
 T(global opt: renrm) = 6.268e-01 S  per = 34.5  per(accum) = 96.2
 T(global opt: save ) = 6.909e-02 S  per =  3.8  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.391e-01 S  T(sum) = 9.208e-01 S  per = 9.805e+01
 T(global opt: preprocess                  ) = 2.442e-03 S  per = 0.265  per(accum) = 0.265
 T(global opt: symbolic_formulae           ) = 2.788e-02 S  per = 3.03  per(accum) = 3.29
 T(global opt: hintermediate init          ) = 2.078e-03 S  per = 0.226  per(accum) = 3.52
 T(global opt: preprocess_hformulae_Hxlist ) = 9.616e-02 S  per = 10.4  per(accum) = 14
 T(global opt: hmmtasks init               ) = 9.757e-02 S  per = 10.6  per(accum) = 24.6
 T(global opt: initial guess for dvdson    ) = 1.979e-04 S  per = 0.0215  per(accum) = 24.6
 T(global opt: dvdson [Hx_batchGPU]        ) = 6.622e-01 S  per = 71.9  per(accum) = 96.5
 T(global opt: dvdson [cpu-gpu]            ) = 5.289e-03 S  per = 0.574  per(accum) = 97.1
 T(global opt: dvdson [nccl]               ) = 1.132e-02 S  per = 1.23  per(accum) = 98.3
 T(global opt: dvdson [mpi]                ) = 9.905e-05 S  per = 0.0108  per(accum) = 98.3
 T(global opt: dvdson [rest part(linalg)]  ) = 1.551e-02 S  per = 1.68  per(accum) = 100
Detailed decomposition of T(renrm) = 6.268e-01 S  T(sum) = 6.268e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.924e-03 S  per = 0.307  per(accum) = 0.307
 T(global opt: qops init                    ) = 1.662e-02 S  per = 2.65  per(accum) = 2.96
 T(global opt: symbolic_formulae_renorm     ) = 1.751e-02 S  per = 2.79  per(accum) = 5.75
 T(global opt: allocate qops on gpu         ) = 2.296e-03 S  per = 0.366  per(accum) = 6.12
 T(global opt: site memcpy cpu2gpu          ) = 8.314e-04 S  per = 0.133  per(accum) = 6.25
 T(global opt: rintermediate init           ) = 1.840e-03 S  per = 0.294  per(accum) = 6.54
 T(global opt: preprocess_formulae_Rlist2   ) = 3.392e-02 S  per = 5.41  per(accum) = 12
 T(global opt: rmmtasks init                ) = 3.626e-02 S  per = 5.78  per(accum) = 17.7
 T(global opt: qops memset on cpu           ) = 1.658e-06 S  per = 0.000265  per(accum) = 17.7
 T(global opt: preprocess_renorm_batchGPU   ) = 5.655e-02 S  per = 9.02  per(accum) = 26.8
 T(global opt: deallocate cpu and gpu memory) = 4.935e-03 S  per = 0.787  per(accum) = 27.5
 T(global opt: construct opS [ifdists=true] ) = 4.138e-01 S  per =   66  per(accum) = 93.6
 T(global opt: reduction of opS & opH [nccl]) = 8.056e-04 S  per = 0.129  per(accum) = 93.7
 T(global opt: qops memcpy gpu2cpu          ) = 4.199e-03 S  per = 0.67  per(accum) = 94.4
 T(global opt: reduction of opS & opH [mpi] ) = 8.912e-04 S  per = 0.142  per(accum) = 94.5
 T(global opt: qops_pool join and erase     ) = 2.223e-02 S  per = 3.55  per(accum) = 98.1
 T(global opt: conversion from opAB to opPQ ) = 1.220e-02 S  per = 1.95  per(accum) = 100
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-3.380e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 

======================================================================
sweep_data::summary isweep=0 mpisize=2 maxthreads=2
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=1 dcut=100 eps=1.000e-04 noise=0.000e+00
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=16 dwt=+0.000e+00 nmvp=3 e[0]=-116.446553669725 t=0.024
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=64 dwt=+0.000e+00 nmvp=6 e[0]=-116.456608738602 t=0.033
 ibond=2 bond=(3,0)-(4,0) forward=1 deff=17 dwt=+1.110e-16 nmvp=6 e[0]=-116.466364795540 t=0.028
 ibond=3 bond=(4,0)-(5,0) forward=1 deff=27 dwt=+1.110e-16 nmvp=7 e[0]=-116.471788147632 t=0.043
 ibond=4 bond=(5,0)-(6,0) forward=1 deff=38 dwt=+2.220e-16 nmvp=6 e[0]=-116.472302317891 t=0.049
 ibond=5 bond=(6,0)-(7,0) forward=1 deff=47 dwt=-2.220e-16 nmvp=7 e[0]=-116.472905736041 t=0.067
 ibond=6 bond=(7,0)-(8,0) forward=1 deff=57 dwt=+1.110e-16 nmvp=8 e[0]=-116.481452453825 t=0.087
 ibond=7 bond=(8,0)-(9,0) forward=1 deff=65 dwt=+0.000e+00 nmvp=8 e[0]=-116.490872151426 t=0.105
 ibond=8 bond=(9,0)-(10,0) forward=1 deff=73 dwt=-2.220e-16 nmvp=8 e[0]=-116.494975102556 t=0.117
 ibond=9 bond=(10,0)-(11,0) forward=1 deff=74 dwt=+0.000e+00 nmvp=9 e[0]=-116.502578257621 t=0.108
 ibond=10 bond=(11,0)-(12,0) forward=1 deff=77 dwt=+6.661e-16 nmvp=10 e[0]=-116.517004448238 t=0.069
 ibond=11 bond=(12,0)-(13,0) forward=1 deff=68 dwt=+0.000e+00 nmvp=10 e[0]=-116.527839869804 t=0.058
 ibond=12 bond=(13,0)-(14,0) forward=1 deff=58 dwt=+2.220e-16 nmvp=10 e[0]=-116.532946558375 t=0.057
 ibond=13 bond=(14,0)-(15,0) forward=1 deff=42 dwt=+0.000e+00 nmvp=9 e[0]=-116.536936803243 t=0.039
 ibond=14 bond=(15,0)-(16,0) forward=1 deff=24 dwt=+0.000e+00 nmvp=8 e[0]=-116.539344816793 t=0.033
 ibond=15 bond=(16,0)-(17,0) forward=1 deff=10 dwt=-2.220e-16 nmvp=6 e[0]=-116.540403924337 t=0.022
 ibond=16 bond=(17,0)-(18,0) forward=1 deff=4 dwt=+0.000e+00 nmvp=5 e[0]=-116.540558010161 t=0.014
 ibond=17 bond=(17,0)-(18,0) forward=0 deff=16 dwt=+0.000e+00 nmvp=1 e[0]=-116.540558010161 t=0.018
 ibond=18 bond=(16,0)-(17,0) forward=0 deff=64 dwt=+0.000e+00 nmvp=4 e[0]=-116.540655294172 t=0.035
 ibond=19 bond=(15,0)-(16,0) forward=0 deff=24 dwt=+3.331e-16 nmvp=7 e[0]=-116.541906050312 t=0.036
 ibond=20 bond=(14,0)-(15,0) forward=0 deff=42 dwt=+1.110e-16 nmvp=6 e[0]=-116.542005052968 t=0.040
 ibond=21 bond=(13,0)-(14,0) forward=0 deff=58 dwt=-2.220e-16 nmvp=6 e[0]=-116.542042290831 t=0.046
 ibond=22 bond=(12,0)-(13,0) forward=0 deff=68 dwt=+0.000e+00 nmvp=7 e[0]=-116.542148034411 t=0.067
 ibond=23 bond=(11,0)-(12,0) forward=0 deff=77 dwt=+1.110e-16 nmvp=7 e[0]=-116.542410234795 t=0.062
 ibond=24 bond=(10,0)-(11,0) forward=0 deff=74 dwt=+1.110e-16 nmvp=7 e[0]=-116.542894169549 t=0.063
 ibond=25 bond=(9,0)-(10,0) forward=0 deff=73 dwt=+3.331e-16 nmvp=7 e[0]=-116.543584635644 t=0.096
 ibond=26 bond=(8,0)-(9,0) forward=0 deff=65 dwt=-4.441e-16 nmvp=7 e[0]=-116.544442499872 t=0.100
 ibond=27 bond=(7,0)-(8,0) forward=0 deff=57 dwt=-2.220e-16 nmvp=6 e[0]=-116.544817486309 t=0.092
 ibond=28 bond=(6,0)-(7,0) forward=0 deff=47 dwt=-2.220e-16 nmvp=6 e[0]=-116.545270147744 t=0.068
 ibond=29 bond=(5,0)-(6,0) forward=0 deff=38 dwt=+0.000e+00 nmvp=6 e[0]=-116.545613677065 t=0.053
 ibond=30 bond=(4,0)-(5,0) forward=0 deff=27 dwt=+0.000e+00 nmvp=6 e[0]=-116.545939137556 t=0.038
 ibond=31 bond=(3,0)-(4,0) forward=0 deff=17 dwt=+1.110e-16 nmvp=5 e[0]=-116.546006420381 t=0.024
 ibond=32 bond=(2,0)-(3,0) forward=0 deff=12 dwt=+0.000e+00 nmvp=3 e[0]=-116.546038094875 t=0.015
 ibond=33 bond=(1,0)-(2,0) forward=0 deff=12 dwt=+1.110e-16 nmvp=1 e[0]=-116.546038094875 t=0.014
 eav_max=-116.446553669725 [ibond=0]  dwt_min=-4.441e-16 [ibond=26]
 eav_min=-116.546038094875 [ibond=33]  dwt_max=6.661e-16 [ibond=10]
 eav_diff=0.099484425150
 sweep energies: isweep=0 dots=1 dcut=100 deff=12 dwt=+1.110e-16 e[0]=-116.546038094875
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0 mpisize=2 maxthreads=2
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  1     100 1.000e-04 0.000e+00 | 218 | 1.913e+00 | 1.913e+00 | 3.328e-02 5.580e-01 7.864e-02 6.699e-01 35
results: isweep, dcut, dwt, energies (delta_e)
            0     100 +1.110e-16 e[0]=-116.546038094875 (0.000e+00)
======================================================================
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=7.451e-09 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
ctns::rcanon_load_sites scratch=./scratch/sweep T(load)=5.30e-03S

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep0
----------------------------------------------------------------------

ctns::sweep_final_LCR2CRR: convert [LC]R => [CR]R
ctns::decimation_row ifab=1 iftrunc=1 dcut=4 nqr=12 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_C0R1.txt
 qbond: qsuper nsym=12 dimAll=48
 (28,0):9 (27,-1):3 (29,-1):9 (27,1):3 (26,0):1 (28,-2):3 (30,0):6 (31,-1):2 (29,1):6 (30,-2):3 (28,2):2 (29,-3):1
timing for divide=2.02e-06
timing for compute=3.59e-05
timing for collect=1.13e-05
----- TMING FOR decimation_genbasis(nkr): 4.91e-05 S T(divide/compute[cpu/gpu/rest]/collect)=2.02e-06,3.15e-05,0.00e+00,4.33e-06,1.13e-05 -----
decimation summary: 48->4 dwt=+0.000e+00 SvN=4.018e-01
 qbond: qkept nsym=4 dimAll=4
 (28,0):1 (29,-1):1 (30,0):1 (29,1):1
----- TIMING for decimation_row(nkr): 8.415e-04 S T(decim/select/formRot)=9.144e-05,7.290e-04,2.097e-05 -----

ctns::sweep_final_CR2cRR: convert [C]R => [cR]R
ctns::decimation_row ifab=1 iftrunc=1 dcut=1 nqr=9 alg_decim=0 mpisize=2 fname=./scratch/sweep/decimation_isweep0_cR0.txt
 qbond: qsuper nsym=9 dimAll=16
 (28,0):1 (29,-1):2 (30,0):4 (29,1):2 (31,-1):2 (32,0):1 (31,1):2 (30,2):1 (30,-2):1
timing for divide=1.282e-06
timing for compute=2.540e-05
timing for collect=1.568e-05
----- TMING FOR decimation_genbasis(nkr): 4.237e-05 S T(divide/compute[cpu/gpu/rest]/collect)=1.282e-06,1.372e-05,0.000e+00,1.168e-05,1.568e-05 -----
decimation summary: 16->1 dwt=+0.000e+00 SvN=0.000e+00
 qbond: qkept nsym=1 dimAll=1
 (30,0):1
----- TIMING for decimation_row(nkr): 8.034e-04 S T(decim/select/formRot)=9.179e-05,6.985e-04,1.316e-05 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep0 T(save)=1.29e-03S

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(19,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(18,0) Drow=16 maxdiff=0.000e+00 deviate=0
 idx=2 node=(17,0) Drow=64 maxdiff=0.000e+00 deviate=0
 idx=3 node=(16,0) Drow=24 maxdiff=1.787e-15 deviate=0
 idx=4 node=(15,0) Drow=42 maxdiff=3.519e-15 deviate=0
 idx=5 node=(14,0) Drow=58 maxdiff=2.998e-15 deviate=0
 idx=6 node=(13,0) Drow=68 maxdiff=3.257e-15 deviate=0
 idx=7 node=(12,0) Drow=77 maxdiff=4.831e-15 deviate=0
 idx=8 node=(11,0) Drow=74 maxdiff=3.510e-15 deviate=0
 idx=9 node=(10,0) Drow=73 maxdiff=3.662e-15 deviate=0
 idx=10 node=(9,0) Drow=65 maxdiff=3.418e-15 deviate=0
 idx=11 node=(8,0) Drow=57 maxdiff=2.864e-15 deviate=0
 idx=12 node=(7,0) Drow=47 maxdiff=2.183e-15 deviate=0
 idx=13 node=(6,0) Drow=38 maxdiff=3.702e-15 deviate=0
 idx=14 node=(5,0) Drow=27 maxdiff=2.145e-15 deviate=0
 idx=15 node=(4,0) Drow=17 maxdiff=1.117e-15 deviate=0
 idx=16 node=(3,0) Drow=12 maxdiff=8.882e-16 deviate=0
 idx=17 node=(2,0) Drow=12 maxdiff=7.313e-16 deviate=0
 idx=18 node=(1,0) Drow=4 maxdiff=2.220e-16 deviate=0
 idx=19 node=(0,0) Drow=1 maxdiff=1.110e-16 deviate=0
qtensor2: wf2 own=1 _data=0x55b2c5153c98
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (30,0):1
 qbond: qcol nsym=1 dimAll=1
 (30,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 idx=0 block[0:(30,0),0:(30,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x55b2c5153c98
      1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 2.017e-03 S -----
comb::display_size qkind=qNSz
 rbases: len=20 mem=147:0.00112MB:1.1e-06GB
 sites: len=20 mem=15159:0.116MB:0.000113GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=4:3.05e-05MB:2.98e-08GB
total mem of comb=15311:0.117MB:0.000114GB
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=1.942e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 

ctns::oper_final - build Hmat for RCF at isweep=0

coord=(1,0)
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHPQ nops=C:36 S:2 H:1 P:3 Q:5 
        dim(bra,ket)=12,12 size(op)=30:0.000229MB size(tot)=768:0.00586MB:5.72e-06GB
        per(mem): C:75 S:5.21 H:3.91 P:2.08 Q:13.8 
ctns::oper_renorm coord=(1,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:38 S:1 H:1 P:0 Q:2 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=87:0.000664MB:6.48e-07GB
        per(mem): C:87.4 S:2.3 H:4.6 Q:5.75 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=9.005e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=41 : 1.344e-04 S -----
rank=0 GPUmem(GB): used=2.377e-05 (oper)=2.377e-05
rank=0 GPUmem(GB): used=2.400e-05 (oper,site)=2.377e-05,2.235e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=41
 no. of rintermediate operators=6
 no. of coefficients=108:8.240e-04MB:8.047e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.067e-05 S -----
rank=0 GPUmem(GB): used=2.480e-05 (oper,site,rinter)=2.377e-05,2.235e-07,8.047e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 2.150e-04 S size(rtasks)=41 size(Rlst2)=16 T(Rmu/Rlist)=4.926e-05,1.657e-04 -----
----- TIMING FOR preprocess_formulae_Rlist : 2.666e-04 S size(rtasks)=41 size(Rlst)=527 -----
rank=0 GPUmem(GB): used=2.480e-05 avail=3.829e+01 total=3.829e+01 batch[need]=6.675e-05 blksize=4 blksize0=8 batchsize=527
rank=0 GPUmem(GB): used=9.155e-05 (oper,site,rinter,batch)=2.377e-05,2.235e-07,8.047e-07,6.675e-05
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=1.072e-04,3.007e-04,1.084e-04
----- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=3.0e-04 t_reduction=1.1e-04 tot=5.2e-04 -----
 renorm[inter] counter=713 t=1.1e-04 per=2.1e+01 cost=4.9e+03 flops=4.6e+07
 renorm[gemm] counter=713 i=0 t=2.8e-06 per=5.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=713 i=1 t=2.2e-06 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=713 i=2 t=1.1e-04 per=2.2e+01 cost=1.8e+03 flops=1.6e+07
 renorm[gemm] counter=713 i=3 t=1.0e-04 per=2.0e+01 cost=4.0e+03 flops=3.9e+07
 renorm[gemm] counter=713 i=4 t=2.3e-06 per=4.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=713 i=5 t=2.2e-06 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=713 i=6 t=7.4e-05 per=1.4e+01 cost=2.7e+03 flops=3.7e+07
 renorm[gemm] counter=713 total t=3.0e-04 per=5.8e+01 cost=8.5e+03 flops=2.8e+07
 renorm[red] counter=713 t=1.1e-04 per=2.1e+01 cost=1.1e+03 flops=9.7e+06
----- TIMING FOR renorm_tot : t_inter=4.5e-03 t_gemm=3.9e-02 t_reduction=8.6e-03 tot=5.2e-02 -----
 renorm_tot[inter] counter=713 t=4.5e-03 per=8.7e+00 cost=3.2e+07 flops=7.2e+09
 renorm_tot[gemm] counter=713 i=0 t=7.4e-05 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=713 i=1 t=6.5e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=713 i=2 t=5.0e-03 per=9.6e+00 cost=7.1e+06 flops=1.4e+09
 renorm_tot[gemm] counter=713 i=3 t=8.4e-03 per=1.6e+01 cost=2.3e+07 flops=2.7e+09
 renorm_tot[gemm] counter=713 i=4 t=4.6e-03 per=8.9e+00 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=713 i=5 t=6.5e-03 per=1.3e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=713 i=6 t=1.4e-02 per=2.7e+01 cost=7.6e+07 flops=5.4e+09
 renorm_tot[gemm] counter=713 total t=3.9e-02 per=7.5e+01 cost=1.4e+08 flops=3.6e+09
 renorm_tot[red] counter=713 t=8.6e-03 per=1.7e+01 cost=9.2e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
rank=0 GPUmem(GB): used=2.513e-05 (oper)=2.379e-05
rank=0 GPUmem(GB): used=2.535e-05 (oper,site,rinter)=2.379e-05,2.235e-07,5.364e-07
rank=0 GPUmem(GB): used=2.827e-05 (oper,site,rinter,batch)=2.379e-05,2.235e-07,5.364e-07,2.913e-06
----- TIMING FOR preprocess_renorm_batchGPU_opS : 9.416e-04 S T(preprocess/alloc/comp/red/dealloc)=1.768e-04,2.492e-04,5.895e-04,5.242e-05,4.398e-05 -----
----- TIMING FOR oper_renorm_opS : 9.663e-04 S rank=0 -----
qops.to_cpu: size(tot)=87:6.638e-04MB:6.482e-07GB T(to_cpu)=2.920e-05S speed=2.220e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
----- TIMING FOR oper_renorm : 0.00318 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=1.500e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 

coord=(0,0)
 cqops: oplist=CSHABPQ nops=C:2 S:38 H:1 A:1 B:3 P:703 Q:741 
        dim(bra,ket)=4,4 size(op)=4:3.052e-05MB size(tot)=2336:1.782e-02MB:1.740e-05GB
        per(mem): C:0.171 S:3.25 H:0.171 A:0.0428 B:0.385 P:15.5 Q:80.5 
 rqops: oplist=CSHPQ nops=C:38 S:1 H:1 P:0 Q:2 
        dim(bra,ket)=4,4 size(op)=4:3.05e-05MB size(tot)=87:0.000664MB:6.48e-07GB
        per(mem): C:87.4 S:2.3 H:4.6 Q:5.75 
ctns::oper_renorm coord=(0,0) superblock=cr oplist=CSHPQ ifab=1 isym=2 ifkr=0 alg_renorm=19 mpisize=2 maxthreads=2
 qops: oplist=CSHPQ nops=C:40 S:0 H:1 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
        per(mem): C:0 H:100 
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=-1.827e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 
----- TIMING FOR symbolic_formulae_renorm with size=41 : 6.009e-05 S -----
rank=0 GPUmem(GB): used=1.806e-05 (oper)=1.806e-05
rank=0 GPUmem(GB): used=1.809e-05 (oper,site)=1.806e-05,2.980e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=2
 no. of rformulae=41
 no. of rintermediate operators=0
 no. of coefficients=0:0.000e+00MB:0.000e+00GB
rank=0 GPUmem(GB): used=1.809e-05 (oper,site,rinter)=1.806e-05,2.980e-08,0.000e+00
----- TIMING FOR preprocess_formulae_Rlist2 : 1.144e-04 S size(rtasks)=41 size(Rlst2)=1 T(Rmu/Rlist)=5.571e-05,5.859e-05 -----
----- TIMING FOR preprocess_formulae_Rlist : 1.328e-04 S size(rtasks)=41 size(Rlst)=100 -----
rank=0 GPUmem(GB): used=1.809e-05 avail=3.829e+01 total=3.829e+01 batch[need]=2.235e-06 blksize=1 blksize0=0 batchsize=100
rank=0 GPUmem(GB): used=2.033e-05 (oper,site,rinter,batch)=1.806e-05,2.980e-08,0.000e+00,2.235e-06
preprocess_renorm_batchDirectGPUDirect: T(inter,gemm,reduction)=8.167e-06,2.239e-04,7.839e-05
----- TIMING FOR renorm : t_inter=8.1e-06 t_gemm=2.2e-04 t_reduction=7.8e-05 tot=3.1e-04 -----
 renorm[inter] counter=716 t=8.1e-06 per=2.6e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=716 i=0 t=3.4e-06 per=1.1e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=716 i=1 t=2.4e-06 per=7.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=716 i=2 t=9.3e-05 per=3.0e+01 cost=9.4e+01 flops=1.0e+06
 renorm[gemm] counter=716 i=3 t=6.0e-05 per=1.9e+01 cost=9.4e+01 flops=1.6e+06
 renorm[gemm] counter=716 i=4 t=3.0e-06 per=9.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=716 i=5 t=3.0e-06 per=9.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=716 i=6 t=5.9e-05 per=1.9e+01 cost=2.0e+02 flops=3.4e+06
 renorm[gemm] counter=716 total t=2.2e-04 per=7.2e+01 cost=3.9e+02 flops=1.7e+06
 renorm[red] counter=716 t=7.8e-05 per=2.5e+01 cost=2.0e+02 flops=2.6e+06
----- TIMING FOR renorm_tot : t_inter=4.5e-03 t_gemm=3.9e-02 t_reduction=8.7e-03 tot=5.2e-02 -----
 renorm_tot[inter] counter=716 t=4.5e-03 per=8.7e+00 cost=3.2e+07 flops=7.2e+09
 renorm_tot[gemm] counter=716 i=0 t=7.7e-05 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=716 i=1 t=6.7e-05 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=716 i=2 t=5.1e-03 per=9.8e+00 cost=7.1e+06 flops=1.4e+09
 renorm_tot[gemm] counter=716 i=3 t=8.4e-03 per=1.6e+01 cost=2.3e+07 flops=2.7e+09
 renorm_tot[gemm] counter=716 i=4 t=4.6e-03 per=8.8e+00 cost=9.9e+06 flops=2.2e+09
 renorm_tot[gemm] counter=716 i=5 t=6.5e-03 per=1.2e+01 cost=2.4e+07 flops=3.7e+09
 renorm_tot[gemm] counter=716 i=6 t=1.4e-02 per=2.7e+01 cost=7.6e+07 flops=5.4e+09
 renorm_tot[gemm] counter=716 total t=3.9e-02 per=7.5e+01 cost=1.4e+08 flops=3.6e+09
 renorm_tot[red] counter=716 t=8.7e-03 per=1.7e+01 cost=9.2e+06 flops=1.1e+09
ctns::oper_renorm_opS superblock=cr ifab=1 isym=2 ifkr=0 ifdist1=1 ifdists=1 alg_renorm=19 mpisize=2
----- TIMING FOR oper_renorm_opS : 4.2e-06 S rank=0 -----
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB T(to_cpu)=2.7e-05S speed=2.7e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
----- TIMING FOR oper_renorm : 0.0016 S rank=0 -----
rank=0 CPUmem(GB): used=1.346e+00 pageheap_free=0.000e+00 change=4.420e-05 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 

matrix: Hmat_isweep0 size=(1,1)
     -1.165460380949e+02 

----- TIMING FOR sweep_opt: isweep=0 : 1.939e+00 S -----

----- TIMING FOR ctns::sweep_opt : 1.956e+00 S -----
rank=0 CPUmem(GB): used=1.345e+00 pageheap_free=0.000e+00 change=-9.633e-04 heap=1.397e+00 avail=4.806e+02 total=5.034e+02 

Congrats! CTNS calculation finishes successfully. Wed Jan  1 12:10:28 2025

