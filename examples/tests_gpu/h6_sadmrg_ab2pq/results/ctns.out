
======================================================================
     FOCUS: a platform for exploring FermiOniC qUantum Simulation     
   							               
       :!!!!!!!!!    ^!!!7!:      :!7!!~~!:!!!!!:  ~!!!. :!!!!7:      
       .^G@P^^~?BJ ~GG!::~Y#P^  ^P#?^:^7G@^:5&#~.  ^J#! 7P:.:?&5      
         5@Y  !J :~&@^     ?&@^^B@?     .?. ?&B     :P  5&J7~^~~      
         5@G!?BB  ?&&:     :B@??&@^         ?&B     :P  .?5GB##P^     
         5@Y  :!  ^B@J     !@#:^B@Y      ^: ?&#     ~P  JJ   .~@5     
       .~G@P^:     ^5#5~^^7GY:  ^5&P7~~!?J: :5&5!~~!Y^  Y&5!^^7G^     
       :~~~~~:       .~!!~^.      .~77!~.     :!7!~^    :::~!!^       
   							               
                    Authors: Zhendong Li @ BNU2019   		       
======================================================================

TIME = Wed Nov 20 16:32:11 2024

GIT_HASH = 2d213c3eca380cf1e2bfebbb49b79fc890ee1cea

mpisize = 1 maxthreads = 112

input file = input.dat

schedule::read fname = input.dat
----------------------------------------------------------------------
dtype 0
sorb 12
nelec 6
twom 0
twos 0
integral_file moleinfo/fmole.info
scratch ./scratch
#perfcomm 27

$ci
dets 
0 1 2 3 4 5 
end
nroots 2
schedule
0 1.e-5
end
maxiter 3
rdm 1 1
$end

$ctns
verbose 1
qkind rNS
tosu2
nroots 1
maxdets 100000
thresh_proj 1.e-15
thresh_ortho 1.e-8
topology_file topology/topo1
schedule
0 2 10 1.e-4 0.0
1 1 10 1.e-4 0.0
end
maxsweep 2
task_ham
task_dmrg
alg_renorm 19
alg_rinter 2
alg_hvec 19
alg_hinter 2
ifab2pq
ifdist1
ifdistc
ioasync
batchhvec 4 4 4
batchrenorm 4 4 4
$end

----------------------------------------------------------------------

===== schedule::print =====
scratch = ./scratch
dtype = 0
sorb  = 12
nelec = 6
twom  = 0
twos  = 0
integral_file = moleinfo/fmole.info
perfcomm = 0

===== params_ci::print =====
nroots = 2
no. of unique seeds = 1
0-th det: 0 1 2 3 4 5 
flip = 0
eps0 = 0.01
miniter = 0
maxiter = 3
schedule: iter eps1
0 1e-05
1 1e-05
2 1e-05
convergence parameters
deltaE = 1e-10
checkms = 0
cisolver = 1
maxcycle = 100
crit_v = 0.0001
ifpt2 = 0
eps2 = 1e-08
iroot = 1
jroot = 1
load = 0
ci_file = ci.info
cthrd = 0.1
ifanalysis = 0
rdm = 1
init_aufbau = 0
init_seniority = 0

===== params_ctns::print =====
qkind = rNS
topology_file = topology/topo1
verbose = 1
task_init = 0
task_sdiag = 0
task_ham = 1
task_opt = 1
task_oodmrg = 0
task_vmc = 0
task_expand = 0
task_tononsu2 = 0
task_prop = 
task_schmidt = 0
schmidt_file = svalues
restart_sweep = 0
restart_bond = 0
timestamp = 0
ciroots = 
maxdets = 100000
thresh_proj = 1.000000e-15
thresh_ortho = 1.000000e-08
rdm_svd = 1.500000e+00
outprec = 12
nroots = 1
guess = 1
dbranch = 0
maxsweep = 2
maxbond = -1
schedule: isweep, dots, dcut, eps, noise
0 2 10 1.000000e-04 0.000000e+00
1 1 10 1.000000e-04 0.000000e+00
rcfprefix = 
alg_hvec = 19
alg_hinter = 2
alg_hcoper = 0
alg_renorm = 19
alg_rinter = 2
alg_rcoper = 0
alg_rdm = 1
alg_decim = 1
notrunc = 0
ifab2pq = 1
ifdist1 = 1
ifdistc = 1
save_formulae = 0
sort_formulae = 0
save_mmtask = 0
batchhvec = 4 4 4
batchrenorm = 4 4 4
batchmem = 1.000000e+01
cisolver = 1
maxcycle = 30
nbuff = 4
damping = 1.000000e-10
precond = 1
rcanon_file = 
rcanon2_file = 
iomode = 0
async_fetch = 1
async_save = 1
async_remove = 1
ifnccl = 0
iroot = 0
jroot = 0
nsample = 5000
nprt = 10
pthrd = -1.000000e-02
thresh_cabs = 1.100000e+00
detbasis = 0
tosu2 = 1
thresh_tosu2 = 1.000000e-08
singlet = 0
diagcheck = 0
savebin = 0
fromnosym = 0
oodmrg parameters:
 iprt=1
 maxiter=10
 dfac=2
 macroiter=5
 microiter=50
 alpha=5.000000e-01
 thrdopt=1.000000e-04
 thrdloc=1.000000e-06
 thrddwt=1.000000e+00
 thrdeps=1.000000e-08
 nptloc=2.000000e+01
 acceptall=0
 unrestricted=0
 urot=
inputconf = 
saveconfs = 
loadconfs = 
debug_rdm = 0
alg_mrpt2 = 0
nv2 = 0
nc2 = 0

io::create_scratch scratch=./scratch

gpu_init
CUDA Runtime version: 11080
CUBLAS version: 111103
rank=0 num_gpus=2 device_id=0 magma_queue=0x1840540

ctns::topology::read fname=topology/topo1
0
1
2
3
4
5

ctns::topology::print ifmps=1 ntotal=6 nphysical=6 nbackbone=6
topo:
 i=0 : 0 
 i=1 : 1 
 i=2 : 2 
 i=3 : 3 
 i=4 : 4 
 i=5 : 5 
rcoord:
 idx=0 coord=(5,0) rindex=0 node: lindex=5 porb=5 type=0 center=(-1,-1) left=(4,0) right=(-2,-2)
 idx=1 coord=(4,0) rindex=1 node: lindex=4 porb=4 type=1 center=(-1,-1) left=(3,0) right=(5,0)
 idx=2 coord=(3,0) rindex=2 node: lindex=3 porb=3 type=1 center=(-1,-1) left=(2,0) right=(4,0)
 idx=3 coord=(2,0) rindex=3 node: lindex=2 porb=2 type=1 center=(-1,-1) left=(1,0) right=(3,0)
 idx=4 coord=(1,0) rindex=4 node: lindex=1 porb=1 type=1 center=(-1,-1) left=(0,0) right=(2,0)
 idx=5 coord=(0,0) rindex=5 node: lindex=0 porb=0 type=0 center=(-1,-1) left=(-2,-2) right=(1,0)
rsupport/lsupport:
 idx=0 coord=(5,0) rsupport: 5 ; lsupport: 0 1 2 3 4 
 idx=1 coord=(4,0) rsupport: 4 5 ; lsupport: 0 1 2 3 
 idx=2 coord=(3,0) rsupport: 3 4 5 ; lsupport: 0 1 2 
 idx=3 coord=(2,0) rsupport: 2 3 4 5 ; lsupport: 0 1 
 idx=4 coord=(1,0) rsupport: 1 2 3 4 5 ; lsupport: 0 
 idx=5 coord=(0,0) rsupport: 0 1 2 3 4 5 ; lsupport: 
corbs/rorbs/lorbs:
 idx=0 coord=(5,0) corbs: 5 ; rorbs: ; lorbs: 0 1 2 3 4 
 idx=1 coord=(4,0) corbs: 4 ; rorbs: 5 ; lorbs: 0 1 2 3 
 idx=2 coord=(3,0) corbs: 3 ; rorbs: 4 5 ; lorbs: 0 1 2 
 idx=3 coord=(2,0) corbs: 2 ; rorbs: 3 4 5 ; lorbs: 0 1 
 idx=4 coord=(1,0) corbs: 1 ; rorbs: 2 3 4 5 ; lorbs: 0 
 idx=5 coord=(0,0) corbs: 0 ; rorbs: 1 2 3 4 5 ; lorbs: 
image2:
 0 1 2 3 4 5 6 7 8 9 10 11

fci::ci_load fname=./scratch/ci.info

ctns::rcanon_init qkind=qNSz

fci::ci_truncate ciconfs=399 maxdets=100000 ifortho=1
 iroot=0 <CI[trunc]|CI>=1.000000000000e+00
 iroot=1 <CI[trunc]|CI>=1.000000000000e+00

ctns::init_rbases rdm_svd=1.500e+00 thresh_proj=1.000e-15

idx=1 node=(4,0) type=1 rsupport=
idx=4 
idx=
idx=55 node=
idx=( 0,0
)3 node=(2,0) type=1 rsupport=2 3 4 5 4
 type=0 rsupport=0 1 2 3 4 5  node=
(1,0) type=1 rsupport=1 2 3 4 5 
0 node=(5,0) type=0 rsupport=5 

idx=2 node=(3,0) type=1 rsupport=3 4 5 
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-15
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-15
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-15
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-15
ctns::right_projection<Qm,Tm> thresh_proj=1.000e-15
 dim(space,lspace,rspace)=399,195,16 dimBc=16 1-popBc=-4.441e-16 SvN=1.347e+00
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.668e-02 S -----
 dim(space,lspace,rspace)=399,1,399 dimBc=2 1-popBc=0 SvN=0.693
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.640e-02 S -----
 dim(space,lspace,rspace)=399,63,63 dimBc=63 1-popBc=-2.22e-16 SvN=1.51
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.762e-02 S -----
 dim(space,lspace,rspace)=399,4,399 dimBc=8 1-popBc=0 SvN=1.76
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.660e-02 S -----
 dim(space,lspace,rspace)=399,16,195 dimBc=32 1-popBc=7.77e-16 SvN=1.61
----- TIMING FOR ctns::right_projection<Qm,Tm> : 1.731e-02 S -----

generated rbases with thresh_proj=1e-15
 idx=0 node=(5,0) type=0 shape=4,4 1-popBc=0.000e+00
 idx=1 node=(4,0) type=1 shape=16,16 1-popBc=-4.441e-16
 idx=2 node=(3,0) type=1 shape=63,63 1-popBc=-2.220e-16
 idx=3 node=(2,0) type=1 shape=195,32 1-popBc=7.772e-16
 idx=4 node=(1,0) type=1 shape=399,8 1-popBc=0.000e+00
 idx=5 node=(0,0) type=0 shape=399,2 1-popBc=0.000e+00
maximum bond dimension = 63
----- TIMING FOR ctns::init_rbases : 4.716e-02 S -----

ctns::init_rsites qkind=qNSz thresh_ortho=1e-08
 idx=0 node=(5,0)[0] shape(l,r,c)=(4,1,4) maxdiff=0.000e+00 deviate=0 TIMING=3.109e-05 S
 idx=1 node=(4,0)[1] shape(l,r,c)=(16,4,4) maxdiff=9.891e-16 deviate=0 TIMING=1.381e-02 S
 idx=2 node=(3,0)[1] shape(l,r,c)=(63,16,4) maxdiff=2.348e-15 deviate=0 TIMING=1.555e-02 S
 idx=3 node=(2,0)[1] shape(l,r,c)=(32,63,4) maxdiff=2.154e-15 deviate=0 TIMING=1.131e-02 S
 idx=4 node=(1,0)[1] shape(l,r,c)=(8,32,4) maxdiff=1.334e-15 deviate=0 TIMING=9.535e-03 S
 idx=5 node=(0,0)[0] shape(l,r,c)=(2,8,4) maxdiff=2.291e-16 deviate=0 TIMING=4.767e-03 S
----- TIMING FOR ctns::init_rsites : 5.542e-02 S -----

ctns::init_rwfuns qkind=qNSz thresh_ortho=1e-08
qtensor2: wf2 own=1 _data=0x4e8c6070
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (6,0):2
 qbond: qcol nsym=1 dimAll=2
 (6,0):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.05e-05MB

check state overlaps ...
matrix: ova_rwfuns size=(2,2)
      1.0000e+00       1.5407e-33 
      1.5407e-33       1.0000e+00 
matrix: ova0_vs size=(2,2)
      1.0000e+00      -2.7756e-17 
     -2.7756e-17       1.0000e+00 
diff of ova matrices = 3.165e-16
----- TIMING FOR ctns::init_rwfuns : 1.569e-03 S -----

ctns::init_rcanon thresh_ortho=1e-08

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=2 ciconfs=399
matrix: <CI|CTNS[0]> size=(2,2)
      1.0000e+00      -9.0745e-17 
     -7.5091e-17       1.0000e+00 

matrix: <CTNS[0]|CTNS[0]> size=(2,2)
      1.0000e+00      -1.6038e-16 
     -3.2691e-16       1.0000e+00 

rcanon::rcanon_canonicalize ifortho=1 ifab=1 nroots=2 dmax=63
----- TIMING FOR ctns::rcanon_canonicalize : 1.157e-01 S -----

matrix: <CTNS[new]|CTNS[new]> size=(2,2)
      1.0000e+00      -4.1260e-16 
     -4.1430e-16       1.0000e+00 

matrix: <CTNS[0]|CTNS[new]> size=(2,2)
      1.0000e+00      -1.0212e-15 
      4.9867e-16       1.0000e+00 

ctns::rcanon_CIovlp ifab=1 reorder=1 cistates=2 ciconfs=399
matrix: <CI|CTNS[new]> size=(2,2)
      1.0000e+00      -9.4104e-16 
      5.8106e-16       1.0000e+00 

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(5,0) Drow=4 maxdiff=0.000e+00 deviate=0
 idx=1 node=(4,0) Drow=16 maxdiff=6.001e-16 deviate=0
 idx=2 node=(3,0) Drow=63 maxdiff=2.911e-15 deviate=0
 idx=3 node=(2,0) Drow=32 maxdiff=2.021e-15 deviate=0
 idx=4 node=(1,0) Drow=8 maxdiff=7.022e-16 deviate=0
 idx=5 node=(0,0) Drow=2 maxdiff=5.097e-16 deviate=0
qtensor2: wf2 own=1 _data=0x4dd1ed40
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (6,0):2
 qbond: qcol nsym=1 dimAll=2
 (6,0):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.052e-05MB
i=0 idx=0 block[0:(6,0),0:(6,0)] dim0,dim1=(2,2) size=4
 dtensor2: blk_0 size=(2,2) _data=0x4dd1ed40
      1.0000e+00      -1.3878e-15 
     -1.3878e-15      -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=2 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 1.970e-04 S -----
----- TIMING FOR ctns::rcanon_init : 3.230e-01 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci

ctns::rcanon_tosu2 twos=0 thresh_tosu2=1e-08
>>> idx=1
 qbond: ys nsym=6 dimAll=10
 (0,0):1 (1,1):2 (2,0):3 (2,2):1 (3,1):2 (4,0):1
 sigs2sum=1 diff(1-sigs2sum)=1.11e-16
>>> idx=2
 qbond: ys nsym=8 dimAll=27
 (1,1):2 (2,0):4 (2,2):3 (3,1):7 (3,3):1 (4,0):5 (4,2):3 (5,1):2
 sigs2sum=1 diff(1-sigs2sum)=8.52e-09
>>> idx=3
 qbond: ys nsym=11 dimAll=26
 (2,0):1 (2,2):1 (3,1):4 (3,3):2 (4,0):4 (4,2):5 (4,4):1 (5,1):4 (5,3):2 (6,0):1 (6,2):1
 sigs2sum=1 diff(1-sigs2sum)=8.52e-09
>>> idx=4
 qbond: ys nsym=6 dimAll=7
 (4,0):1 (4,2):1 (5,1):2 (5,3):1 (6,0):1 (6,2):1
 sigs2sum=1 diff(1-sigs2sum)=8.52e-09
>>> idx=5
 qbond: ys nsym=2 dimAll=2
 (6,0):1 (6,2):1
 sigs2sum=1 diff(1-sigs2sum)=8.52e-09

ctns::updateRWFuns twos=0

### iroot=0 ###
> j=0 sym=(6,0,0) pop[j]=1 target sector!
matrix: rwfunW size=(1,1)
     -1.0000e+00 
> j=2 sym=(6,2,0) pop[j]=2.73e-30
matrix: rwfunW size=(1,1)
     -1.6519e-15 
total pop=0.9999999937 diff(1-pop)=6.341924763e-09

### iroot=1 ###
> j=0 sym=(6,0,0) pop[j]=1.61e-30 target sector!
matrix: rwfunW size=(1,1)
     -1.2671e-15 
> j=2 sym=(6,2,0) pop[j]=1
matrix: rwfunW size=(1,1)
      1.0000e+00 
total pop=0.9999999893 diff(1-pop)=1.069674305e-08

comb::display_shape qkind=qNSz
 idx=0 node=(5,0) shape(l,r,c)=(4,1,4)
 idx=1 node=(4,0) shape(l,r,c)=(16,4,4)
 idx=2 node=(3,0) shape(l,r,c)=(63,16,4)
 idx=3 node=(2,0) shape(l,r,c)=(32,63,4)
 idx=4 node=(1,0) shape(l,r,c)=(8,32,4)
 idx=5 node=(0,0) shape(l,r,c)=(2,8,4)
qtensor2: wf2 own=1 _data=0x4d6f1e20
qinfo2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=2
 (6,0):2
 qbond: qcol nsym=1 dimAll=2
 (6,0):2
total no. of nonzero blocks=1 nblocks=1 size=4:3.051757812e-05MB

comb::display_shape qkind=qNS
 idx=0 node=(5,0) shape(l,r,c)=(3,1,3) shapeU1(l,r,c)=(4,1,4)
 idx=1 node=(4,0) shape(l,r,c)=(10,3,3) shapeU1(l,r,c)=(16,4,4)
 idx=2 node=(3,0) shape(l,r,c)=(27,10,3) shapeU1(l,r,c)=(53,16,4)
 idx=3 node=(2,0) shape(l,r,c)=(26,27,3) shapeU1(l,r,c)=(64,53,4)
 idx=4 node=(1,0) shape(l,r,c)=(7,26,3) shapeU1(l,r,c)=(16,64,4)
 idx=5 node=(0,0) shape(l,r,c)=(2,7,3) shapeU1(l,r,c)=(4,16,4)
qtensor2: wf2 own=1 _data=0x4dece250
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (6,0):1
 qbond: qcol nsym=2 dimAll=2
 (6,0):1 (6,2):1
total no. of nonzero blocks=1 nblocks=2 size=1:7.629394531e-06MB

Summary of sweep projection: nroot[nonsu2]=2 => nstate[su2]=1
Warning: nstate[su2] < nroot[nonsu2]!
----- TIMING FOR ctns::rcanon_tosu2 : 1.963e-02 S -----

ctns::rcanon_save fname=./scratch/rcanon_ci_su2

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(5,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=1 node=(4,0) Drow=10 maxdiff=1.015e-15 deviate=0
 idx=2 node=(3,0) Drow=27 maxdiff=2.115e-15 deviate=0
 idx=3 node=(2,0) Drow=26 maxdiff=1.099e-15 deviate=0
 idx=4 node=(1,0) Drow=7 maxdiff=4.441e-16 deviate=0
 idx=5 node=(0,0) Drow=2 maxdiff=4.441e-16 deviate=0
qtensor2: wf2 own=1 _data=0x4e2e9660
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (6,0):1
 qbond: qcol nsym=2 dimAll=2
 (6,0):1 (6,2):1
total no. of nonzero blocks=1 nblocks=2 size=1:7.629e-06MB
i=0 block[0:(6,0),0:(6,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x4e2e9660
     -1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=0.0000e+00 deviate=0
----- TIMING FOR ctns::rcanon_check : 2.640e-03 S -----

integral::load fname = moleinfo/fmole.info
 sorb = 12
 size(int1e) = 144:0.0011MB:1.07e-06GB
 size(int2e) = 2277:0.0174MB:1.7e-05GB
 ecore = 4.603841735000
----- TIMING FOR integral::load : 9.419e-04 S -----

io::remove_scratch scratch=./scratch/sweep
successfully removed ./scratch/sweep

io::create_scratch scratch=./scratch/sweep
successfully created ./scratch/sweep

ctns::oper_env_right qkind=qNS
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(5,0) size=0.000725MB:7.08e-07GB
fname=./scratch/sweep/cop(5,0) size=7.08e-07GB T[save](info/data/tot)=0.000116,4.9e-05,0.000165 speed=0.00428GB/S disk[used]=9.15e-07GB
ctns::oper_save iomode=0 fname=./scratch/sweep/rop(5,0) size=0.000725MB:7.08e-07GB
fname=./scratch/sweep/rop(5,0) size=7.08e-07GB T[save](info/data/tot)=7.77e-05,4.15e-05,0.000119 speed=0.00594GB/S disk[used]=1.83e-06GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(4,0) size=0.000725MB:7.08e-07GB
fname=./scratch/sweep/cop(4,0) size=7.08e-07GB T[save](info/data/tot)=6.93e-05,7.96e-05,0.000149 speed=0.00475GB/S disk[used]=2.75e-06GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(3,0) size=0.000725MB:7.08e-07GB
fname=./scratch/sweep/cop(3,0) size=7.08e-07GB T[save](info/data/tot)=9.95e-05,6.71e-05,0.000167 speed=0.00425GB/S disk[used]=3.66e-06GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(2,0) size=0.000725MB:7.08e-07GB
fname=./scratch/sweep/cop(2,0) size=7.08e-07GB T[save](info/data/tot)=0.000102,7.27e-05,0.000175 speed=0.00405GB/S disk[used]=4.58e-06GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(1,0) size=0.000725MB:7.08e-07GB
fname=./scratch/sweep/cop(1,0) size=7.08e-07GB T[save](info/data/tot)=9.74e-05,0.000101,0.000198 speed=0.00357GB/S disk[used]=5.49e-06GB
ctns::oper_save iomode=0 fname=./scratch/sweep/cop(0,0) size=0.000725MB:7.08e-07GB
fname=./scratch/sweep/cop(0,0) size=7.08e-07GB T[save](info/data/tot)=0.000101,7.05e-05,0.000171 speed=0.00414GB/S disk[used]=6.41e-06GB
----- TIMING FOR ctns::oper_init_dotCR : 7.470e-03 S -----
T[ctns::oper_init_dotCR](comp/save/tot)=0.00538,0.00149,0.00687

idx=1 coord=(4,0)
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=95:0.000725MB:7.08e-07GB
 rqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=95:0.000725MB:7.08e-07GB
ctns::oper_renorm coord=(4,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:2 S:4 H:1 A:4 B:6 
        dim(bra,ket)=10,10 size(op)=20:0.000153MB size(tot)=281:0.00214MB:2.09e-06GB
CPUmem: VM:1.909e+01GB RSS:1.829e+00GB  Timing: User:2.388e+01S Sys:1.324e+00S Total:2.520e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=17 : 3.606e-04 S -----
rank=0 GPUmem(GB): used=3.51e-06 (oper)=3.51e-06
rank=0 GPUmem(GB): used=3.66e-06 (oper,site)(GB)=3.51e-06,1.49e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=17
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=3.66e-06 (oper,site,rinter)=3.51e-06,1.49e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00368 S size(rtasks)=17 size(Rlst2)=36 T(Rmu/Rlist)=0.000106,0.00357 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00373 S size(rtasks)=17 size(Rlst)=326 -----
rank=0 GPUmem(GB): used=3.66e-06 (oper,site,rinter,batch)=3.51e-06,1.49e-07,0,4.61e-05 blksize=9 blksize0=0 batchsize=326
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=3.93e-05,0.000772,0.00029
--- TIMING FOR renorm : t_inter=3.9e-05 t_gemm=7.7e-04 t_reduction=2.9e-04 tot=1.1e-03 ---
 renorm[inter] counter=1 t=3.9e-05 per=3.5e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=4.5e-04 per=4.1e+01 cost=3.7e+02 flops=8.1e+05
 renorm[gemm] counter=1 i=1 t=7.9e-05 per=7.2e+00 cost=6.6e+02 flops=8.3e+06
 renorm[gemm] counter=1 i=2 t=6.1e-05 per=5.5e+00 cost=4.0e+02 flops=6.6e+06
 renorm[gemm] counter=1 i=3 t=6.4e-05 per=5.8e+00 cost=6.2e+02 flops=9.7e+06
 renorm[gemm] counter=1 i=4 t=1.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=5 t=1.1e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=6 t=1.1e-04 per=1.0e+01 cost=2.8e+03 flops=2.5e+07
 renorm[gemm] counter=1 total t=7.7e-04 per=7.0e+01 cost=4.9e+03 flops=6.4e+06
 renorm[red] counter=1 t=2.9e-04 per=2.6e+01 cost=2.8e+03 flops=9.8e+06
--- TIMING FOR renorm_tot : t_inter=3.9e-05 t_gemm=7.7e-04 t_reduction=2.9e-04 tot=1.1e-03 ---
 renorm_tot[inter] counter=1 t=3.9e-05 per=3.5e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=4.5e-04 per=4.1e+01 cost=3.7e+02 flops=8.1e+05
 renorm_tot[gemm] counter=1 i=1 t=7.9e-05 per=7.2e+00 cost=6.6e+02 flops=8.3e+06
 renorm_tot[gemm] counter=1 i=2 t=6.1e-05 per=5.5e+00 cost=4.0e+02 flops=6.6e+06
 renorm_tot[gemm] counter=1 i=3 t=6.4e-05 per=5.8e+00 cost=6.2e+02 flops=9.7e+06
 renorm_tot[gemm] counter=1 i=4 t=1.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=5 t=1.1e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=6 t=1.1e-04 per=1.0e+01 cost=2.8e+03 flops=2.5e+07
 renorm_tot[gemm] counter=1 total t=7.7e-04 per=7.0e+01 cost=4.9e+03 flops=6.4e+06
 renorm_tot[red] counter=1 t=2.9e-04 per=2.6e+01 cost=2.8e+03 flops=9.8e+06
qops.to_cpu: size(tot)=281:2.1e-03MB:2.1e-06GB t[to_cpu]=2.5e-05S speed=8.5e-02GB/S
check ||H-H.dagger||=3.467e-16 coord=(4,0) rank=0
ctns::oper_ab2pq coord=(4,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00814 S rank=0 -----
##### local oper_env: 1.343e-02 S #####
 T(local oper_env: fetch) = 4.774e-03 S  per = 35.5  per(accum) = 35.5
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 35.5
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 35.5
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 35.5
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 35.5
 T(local oper_env: renrm) = 8.259e-03 S  per = 61.5  per(accum) = 97
 T(local oper_env: save ) = 3.972e-04 S  per = 2.96  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.259e-03 S  T(sum) = 8.259e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 1.301e-05 S  per = 0.158  per(accum) = 0.158
 T(local oper_env: qops init                    ) = 8.252e-04 S  per = 9.99  per(accum) = 10.1
 T(local oper_env: symbolic_formulae_renorm     ) = 3.726e-04 S  per = 4.51  per(accum) = 14.7
 T(local oper_env: allocate qops on gpu         ) = 6.918e-05 S  per = 0.838  per(accum) = 15.5
 T(local oper_env: site memcpy cpu2gpu          ) = 3.450e-05 S  per = 0.418  per(accum) = 15.9
 T(local oper_env: rintermediate init           ) = 2.047e-05 S  per = 0.248  per(accum) = 16.2
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.742e-03 S  per = 45.3  per(accum) = 61.5
 T(local oper_env: rmmtasks init                ) = 1.739e-03 S  per = 21.1  per(accum) = 82.5
 T(local oper_env: qops memset on cpu           ) = 2.900e-08 S  per = 0.000351  per(accum) = 82.5
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.190e-03 S  per = 14.4  per(accum) = 96.9
 T(local oper_env: reduction of opS & opH [nccl]) = 1.143e-06 S  per = 0.0138  per(accum) = 97
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.999e-05 S  per = 0.363  per(accum) = 97.3
 T(local oper_env: deallocate cpu and gpu memory) = 3.441e-05 S  per = 0.417  per(accum) = 97.7
 T(local oper_env: reduction of opS & opH [comm]) = 8.269e-05 S  per =    1  per(accum) = 98.7
 T(local oper_env: conversion from opAB to opPQ ) = 3.479e-06 S  per = 0.0421  per(accum) = 98.8
 T(local oper_env: after oper_renorm            ) = 1.002e-04 S  per = 1.21  per(accum) = 100
##### sweep oper_env: 1.343e-02 S #####
 T(sweep oper_env: fetch) = 4.774e-03 S  per = 35.5  per(accum) = 35.5
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 35.5
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 35.5
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 35.5
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 35.5
 T(sweep oper_env: renrm) = 8.259e-03 S  per = 61.5  per(accum) = 97
 T(sweep oper_env: save ) = 3.972e-04 S  per = 2.96  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(sweep oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 8.259e-03 S  T(sum) = 8.259e-03 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 1.301e-05 S  per = 0.158  per(accum) = 0.158
 T(sweep oper_env: qops init                    ) = 8.252e-04 S  per = 9.99  per(accum) = 10.1
 T(sweep oper_env: symbolic_formulae_renorm     ) = 3.726e-04 S  per = 4.51  per(accum) = 14.7
 T(sweep oper_env: allocate qops on gpu         ) = 6.918e-05 S  per = 0.838  per(accum) = 15.5
 T(sweep oper_env: site memcpy cpu2gpu          ) = 3.450e-05 S  per = 0.418  per(accum) = 15.9
 T(sweep oper_env: rintermediate init           ) = 2.047e-05 S  per = 0.248  per(accum) = 16.2
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 3.742e-03 S  per = 45.3  per(accum) = 61.5
 T(sweep oper_env: rmmtasks init                ) = 1.739e-03 S  per = 21.1  per(accum) = 82.5
 T(sweep oper_env: qops memset on cpu           ) = 2.900e-08 S  per = 0.000351  per(accum) = 82.5
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 1.190e-03 S  per = 14.4  per(accum) = 96.9
 T(sweep oper_env: reduction of opS & opH [nccl]) = 1.143e-06 S  per = 0.0138  per(accum) = 97
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 2.999e-05 S  per = 0.363  per(accum) = 97.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 3.441e-05 S  per = 0.417  per(accum) = 97.7
 T(sweep oper_env: reduction of opS & opH [comm]) = 8.269e-05 S  per =    1  per(accum) = 98.7
 T(sweep oper_env: conversion from opAB to opPQ ) = 3.479e-06 S  per = 0.0421  per(accum) = 98.8
 T(sweep oper_env: after oper_renorm            ) = 1.002e-04 S  per = 1.21  per(accum) = 100

idx=2 coord=(3,0)
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=95:0.000725MB:7.08e-07GB
 rqops: oplist=CSHAB nops=C:2 S:4 H:1 A:4 B:6 
        dim(bra,ket)=10,10 size(op)=20:0.000153MB size(tot)=281:0.00214MB:2.09e-06GB
ctns::oper_renorm coord=(3,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:3 S:3 H:1 A:9 B:12 
        dim(bra,ket)=27,27 size(op)=144:0.0011MB size(tot)=3075:0.0235MB:2.29e-05GB
CPUmem: VM:1.915e+01GB RSS:1.830e+00GB  Timing: User:2.389e+01S Sys:1.325e+00S Total:2.521e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=28 : 5.286e-04 S -----
rank=0 GPUmem(GB): used=2.57e-05 (oper)=2.57e-05
rank=0 GPUmem(GB): used=2.68e-05 (oper,site)(GB)=2.57e-05,1.05e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=28
 no. of rintermediate operators=9
 no. of coefficients=18:0.000137MB:1.34e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.847e-05 S -----
rank=0 GPUmem(GB): used=2.69e-05 (oper,site,rinter)=2.57e-05,1.05e-06,1.34e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0178 S size(rtasks)=28 size(Rlst2)=64 T(Rmu/Rlist)=0.000171,0.0176 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.018 S size(rtasks)=28 size(Rlst)=1428 -----
rank=0 GPUmem(GB): used=2.69e-05 (oper,site,rinter,batch)=2.57e-05,1.05e-06,1.34e-07,0.00112 blksize=49 blksize0=6 batchsize=1428
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000108,0.00209,0.0004
--- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=2.1e-03 t_reduction=4.0e-04 tot=2.6e-03 ---
 renorm[inter] counter=2 t=1.1e-04 per=4.2e+00 cost=1.7e+03 flops=1.6e+07
 renorm[gemm] counter=2 i=0 t=1.5e-04 per=5.9e+00 cost=8.6e+03 flops=5.7e+07
 renorm[gemm] counter=2 i=1 t=1.3e-04 per=5.2e+00 cost=9.3e+03 flops=6.9e+07
 renorm[gemm] counter=2 i=2 t=4.5e-04 per=1.8e+01 cost=1.6e+04 flops=3.5e+07
 renorm[gemm] counter=2 i=3 t=4.9e-04 per=1.9e+01 cost=2.3e+04 flops=4.7e+07
 renorm[gemm] counter=2 i=4 t=1.2e-06 per=4.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=5 t=1.1e-06 per=4.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=6 t=8.5e-04 per=3.3e+01 cost=1.0e+05 flops=1.2e+08
 renorm[gemm] counter=2 total t=2.1e-03 per=8.0e+01 cost=1.6e+05 flops=7.7e+07
 renorm[red] counter=2 t=4.0e-04 per=1.5e+01 cost=5.4e+04 flops=1.4e+08
--- TIMING FOR renorm_tot : t_inter=1.5e-04 t_gemm=2.9e-03 t_reduction=6.9e-04 tot=3.7e-03 ---
 renorm_tot[inter] counter=2 t=1.5e-04 per=4.0e+00 cost=1.7e+03 flops=1.2e+07
 renorm_tot[gemm] counter=2 i=0 t=6.0e-04 per=1.6e+01 cost=9.0e+03 flops=1.5e+07
 renorm_tot[gemm] counter=2 i=1 t=2.1e-04 per=5.8e+00 cost=9.9e+03 flops=4.6e+07
 renorm_tot[gemm] counter=2 i=2 t=5.2e-04 per=1.4e+01 cost=1.6e+04 flops=3.1e+07
 renorm_tot[gemm] counter=2 i=3 t=5.6e-04 per=1.5e+01 cost=2.4e+04 flops=4.3e+07
 renorm_tot[gemm] counter=2 i=4 t=2.4e-06 per=6.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=5 t=2.3e-06 per=6.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=6 t=9.7e-04 per=2.6e+01 cost=1.1e+05 flops=1.1e+08
 renorm_tot[gemm] counter=2 total t=2.9e-03 per=7.7e+01 cost=1.7e+05 flops=5.8e+07
 renorm_tot[red] counter=2 t=6.9e-04 per=1.9e+01 cost=5.7e+04 flops=8.3e+07
qops.to_cpu: size(tot)=3075:2.3e-02MB:2.3e-05GB t[to_cpu]=2.4e-05S speed=9.6e-01GB/S
check ||H-H.dagger||=1.386e-15 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=cr ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 0.192 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.00185,6.05e-06,0.0796,0.111,3.39e-05,0.000188 -----
----- TIMING FOR oper_renorm : 0.0307 S rank=0 -----
##### local oper_env: 2.243e-01 S #####
 T(local oper_env: fetch) = 9.249e-04 S  per = 0.412  per(accum) = 0.412
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 0.412
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 0.412
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 0.412
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 0.412
 T(local oper_env: renrm) = 2.231e-01 S  per = 99.5  per(accum) = 99.9
 T(local oper_env: save ) = 2.827e-04 S  per = 0.126  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.231e-01 S  T(sum) = 2.231e-01 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.215e-06 S  per = 0.00323  per(accum) = 0.00323
 T(local oper_env: qops init                    ) = 2.008e-03 S  per =  0.9  per(accum) = 0.903
 T(local oper_env: symbolic_formulae_renorm     ) = 5.356e-04 S  per = 0.24  per(accum) = 1.14
 T(local oper_env: allocate qops on gpu         ) = 2.914e-05 S  per = 0.0131  per(accum) = 1.16
 T(local oper_env: site memcpy cpu2gpu          ) = 1.912e-05 S  per = 0.00857  per(accum) = 1.16
 T(local oper_env: rintermediate init           ) = 4.630e-05 S  per = 0.0207  per(accum) = 1.19
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.801e-02 S  per = 8.07  per(accum) = 9.26
 T(local oper_env: rmmtasks init                ) = 7.202e-03 S  per = 3.23  per(accum) = 12.5
 T(local oper_env: qops memset on cpu           ) = 3.100e-08 S  per = 1.39e-05  per(accum) = 12.5
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.687e-03 S  per =  1.2  per(accum) = 13.7
 T(local oper_env: reduction of opS & opH [nccl]) = 9.170e-07 S  per = 0.000411  per(accum) = 13.7
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.893e-05 S  per = 0.013  per(accum) = 13.7
 T(local oper_env: deallocate cpu and gpu memory) = 3.073e-05 S  per = 0.0138  per(accum) = 13.7
 T(local oper_env: reduction of opS & opH [comm]) = 1.144e-04 S  per = 0.0513  per(accum) = 13.8
 T(local oper_env: conversion from opAB to opPQ ) = 1.922e-01 S  per = 86.2  per(accum) = 99.9
 T(local oper_env: after oper_renorm            ) = 1.858e-04 S  per = 0.0833  per(accum) = 100
##### sweep oper_env: 2.378e-01 S #####
 T(sweep oper_env: fetch) = 5.698e-03 S  per =  2.4  per(accum) = 2.4
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.4
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.4
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.4
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.4
 T(sweep oper_env: renrm) = 2.314e-01 S  per = 97.3  per(accum) = 99.7
 T(sweep oper_env: save ) = 6.799e-04 S  per = 0.286  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -3.464e+09 S  per = -3.464e+31
 T(sweep oper_env: preprocess                  ) = -3.464e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.314e-01 S  T(sum) = 2.314e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.023e-05 S  per = 0.00874  per(accum) = 0.00874
 T(sweep oper_env: qops init                    ) = 2.833e-03 S  per = 1.22  per(accum) = 1.23
 T(sweep oper_env: symbolic_formulae_renorm     ) = 9.082e-04 S  per = 0.392  per(accum) = 1.63
 T(sweep oper_env: allocate qops on gpu         ) = 9.832e-05 S  per = 0.0425  per(accum) = 1.67
 T(sweep oper_env: site memcpy cpu2gpu          ) = 5.362e-05 S  per = 0.0232  per(accum) = 1.69
 T(sweep oper_env: rintermediate init           ) = 6.677e-05 S  per = 0.0289  per(accum) = 1.72
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 2.175e-02 S  per =  9.4  per(accum) = 11.1
 T(sweep oper_env: rmmtasks init                ) = 8.942e-03 S  per = 3.86  per(accum) = 15
 T(sweep oper_env: qops memset on cpu           ) = 6.000e-08 S  per = 2.59e-05  per(accum) = 15
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 3.877e-03 S  per = 1.68  per(accum) = 16.7
 T(sweep oper_env: reduction of opS & opH [nccl]) = 2.060e-06 S  per = 0.00089  per(accum) = 16.7
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 5.892e-05 S  per = 0.0255  per(accum) = 16.7
 T(sweep oper_env: deallocate cpu and gpu memory) = 6.514e-05 S  per = 0.0282  per(accum) = 16.7
 T(sweep oper_env: reduction of opS & opH [comm]) = 1.971e-04 S  per = 0.0852  per(accum) = 16.8
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.922e-01 S  per = 83.1  per(accum) = 99.9
 T(sweep oper_env: after oper_renorm            ) = 2.860e-04 S  per = 0.124  per(accum) = 100

idx=3 coord=(2,0)
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=95:0.000725MB:7.08e-07GB
 rqops: oplist=CSHPQ nops=C:3 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=27,27 size(op)=144:0.0011MB size(tot)=3075:0.0235MB:2.29e-05GB
ctns::oper_renorm coord=(2,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:4 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=26,26 size(op)=154:0.00117MB size(tot)=1682:0.0128MB:1.25e-05GB
CPUmem: VM:1.915e+01GB RSS:1.830e+00GB  Timing: User:4.488e+01S Sys:1.329e+00S Total:4.621e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=17 : 4.618e-04 S -----
rank=0 GPUmem(GB): used=3.62e-05 (oper)=3.62e-05
rank=0 GPUmem(GB): used=3.84e-05 (oper,site)(GB)=3.62e-05,2.28e-06
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=17
 no. of rintermediate operators=22
 no. of coefficients=66:0.000504MB:4.92e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.627e-05 S -----
rank=0 GPUmem(GB): used=3.89e-05 (oper,site,rinter)=3.62e-05,2.28e-06,4.92e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0327 S size(rtasks)=17 size(Rlst2)=121 T(Rmu/Rlist)=0.000151,0.0325 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0329 S size(rtasks)=17 size(Rlst)=1871 -----
rank=0 GPUmem(GB): used=3.89e-05 (oper,site,rinter,batch)=3.62e-05,2.28e-06,4.92e-07,0.00148 blksize=35 blksize0=35 batchsize=1871
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000145,0.00235,0.000316
--- TIMING FOR renorm : t_inter=1.4e-04 t_gemm=2.3e-03 t_reduction=3.2e-04 tot=2.8e-03 ---
 renorm[inter] counter=3 t=1.4e-04 per=5.2e+00 cost=4.4e+04 flops=3.1e+08
 renorm[gemm] counter=3 i=0 t=1.4e-04 per=5.0e+00 cost=1.3e+04 flops=9.3e+07
 renorm[gemm] counter=3 i=1 t=1.4e-04 per=5.0e+00 cost=1.9e+04 flops=1.3e+08
 renorm[gemm] counter=3 i=2 t=5.6e-04 per=2.0e+01 cost=5.3e+04 flops=9.4e+07
 renorm[gemm] counter=3 i=3 t=9.0e-04 per=3.2e+01 cost=1.0e+05 flops=1.1e+08
 renorm[gemm] counter=3 i=4 t=1.3e-06 per=4.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=5 t=1.2e-06 per=4.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=6 t=6.0e-04 per=2.1e+01 cost=1.6e+05 flops=2.7e+08
 renorm[gemm] counter=3 total t=2.3e-03 per=8.4e+01 cost=3.5e+05 flops=1.5e+08
 renorm[red] counter=3 t=3.2e-04 per=1.1e+01 cost=4.1e+04 flops=1.3e+08
--- TIMING FOR renorm_tot : t_inter=2.9e-04 t_gemm=5.2e-03 t_reduction=1.0e-03 tot=6.5e-03 ---
 renorm_tot[inter] counter=3 t=2.9e-04 per=4.5e+00 cost=4.6e+04 flops=1.6e+08
 renorm_tot[gemm] counter=3 i=0 t=7.4e-04 per=1.1e+01 cost=2.2e+04 flops=3.0e+07
 renorm_tot[gemm] counter=3 i=1 t=3.5e-04 per=5.4e+00 cost=2.9e+04 flops=8.1e+07
 renorm_tot[gemm] counter=3 i=2 t=1.1e-03 per=1.7e+01 cost=6.9e+04 flops=6.4e+07
 renorm_tot[gemm] counter=3 i=3 t=1.5e-03 per=2.2e+01 cost=1.3e+05 flops=8.6e+07
 renorm_tot[gemm] counter=3 i=4 t=3.7e-06 per=5.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=5 t=3.4e-06 per=5.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=6 t=1.6e-03 per=2.4e+01 cost=2.7e+05 flops=1.7e+08
 renorm_tot[gemm] counter=3 total t=5.2e-03 per=8.0e+01 cost=5.2e+05 flops=9.9e+07
 renorm_tot[red] counter=3 t=1.0e-03 per=1.5e+01 cost=9.8e+04 flops=9.8e+07
qops.to_cpu: size(tot)=1682:1.3e-02MB:1.3e-05GB t[to_cpu]=1.6e-05S speed=7.8e-01GB/S
check ||H-H.dagger||=2.371e-15 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0496 S rank=0 -----
##### local oper_env: 5.111e-02 S #####
 T(local oper_env: fetch) = 1.069e-03 S  per = 2.09  per(accum) = 2.09
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.09
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.09
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.09
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.09
 T(local oper_env: renrm) = 4.971e-02 S  per = 97.3  per(accum) = 99.4
 T(local oper_env: save ) = 3.247e-04 S  per = 0.635  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 4.971e-02 S  T(sum) = 4.971e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 8.612e-06 S  per = 0.0173  per(accum) = 0.0173
 T(local oper_env: qops init                    ) = 2.831e-03 S  per = 5.69  per(accum) = 5.71
 T(local oper_env: symbolic_formulae_renorm     ) = 4.703e-04 S  per = 0.946  per(accum) = 6.66
 T(local oper_env: allocate qops on gpu         ) = 2.360e-05 S  per = 0.0475  per(accum) = 6.71
 T(local oper_env: site memcpy cpu2gpu          ) = 1.817e-05 S  per = 0.0365  per(accum) = 6.74
 T(local oper_env: rintermediate init           ) = 5.520e-05 S  per = 0.111  per(accum) = 6.85
 T(local oper_env: preprocess_formulae_Rlist2   ) = 3.292e-02 S  per = 66.2  per(accum) = 73.1
 T(local oper_env: rmmtasks init                ) = 1.011e-02 S  per = 20.3  per(accum) = 93.4
 T(local oper_env: qops memset on cpu           ) = 2.700e-08 S  per = 5.43e-05  per(accum) = 93.4
 T(local oper_env: preprocess_renorm_batchGPU   ) = 2.900e-03 S  per = 5.83  per(accum) = 99.3
 T(local oper_env: reduction of opS & opH [nccl]) = 1.078e-06 S  per = 0.00217  per(accum) = 99.3
 T(local oper_env: qops memcpy gpu2cpu          ) = 2.157e-05 S  per = 0.0434  per(accum) = 99.3
 T(local oper_env: deallocate cpu and gpu memory) = 8.600e-06 S  per = 0.0173  per(accum) = 99.3
 T(local oper_env: reduction of opS & opH [comm]) = 1.951e-04 S  per = 0.392  per(accum) = 99.7
 T(local oper_env: conversion from opAB to opPQ ) = 7.770e-06 S  per = 0.0156  per(accum) = 99.7
 T(local oper_env: after oper_renorm            ) = 1.335e-04 S  per = 0.268  per(accum) = 100
##### sweep oper_env: 2.889e-01 S #####
 T(sweep oper_env: fetch) = 6.767e-03 S  per = 2.34  per(accum) = 2.34
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.34
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.34
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.34
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.34
 T(sweep oper_env: renrm) = 2.811e-01 S  per = 97.3  per(accum) = 99.7
 T(sweep oper_env: save ) = 1.005e-03 S  per = 0.348  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -5.196e+09 S  per = -5.196e+31
 T(sweep oper_env: preprocess                  ) = -5.196e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.811e-01 S  T(sum) = 2.811e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 2.884e-05 S  per = 0.0103  per(accum) = 0.0103
 T(sweep oper_env: qops init                    ) = 5.664e-03 S  per = 2.01  per(accum) = 2.03
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.378e-03 S  per = 0.49  per(accum) = 2.52
 T(sweep oper_env: allocate qops on gpu         ) = 1.219e-04 S  per = 0.0434  per(accum) = 2.56
 T(sweep oper_env: site memcpy cpu2gpu          ) = 7.179e-05 S  per = 0.0255  per(accum) = 2.58
 T(sweep oper_env: rintermediate init           ) = 1.220e-04 S  per = 0.0434  per(accum) = 2.63
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 5.467e-02 S  per = 19.4  per(accum) = 22.1
 T(sweep oper_env: rmmtasks init                ) = 1.906e-02 S  per = 6.78  per(accum) = 28.9
 T(sweep oper_env: qops memset on cpu           ) = 8.700e-08 S  per = 3.09e-05  per(accum) = 28.9
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 6.777e-03 S  per = 2.41  per(accum) = 31.3
 T(sweep oper_env: reduction of opS & opH [nccl]) = 3.138e-06 S  per = 0.00112  per(accum) = 31.3
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 8.049e-05 S  per = 0.0286  per(accum) = 31.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 7.374e-05 S  per = 0.0262  per(accum) = 31.3
 T(sweep oper_env: reduction of opS & opH [comm]) = 3.922e-04 S  per = 0.14  per(accum) = 31.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.922e-01 S  per = 68.4  per(accum) = 99.9
 T(sweep oper_env: after oper_renorm            ) = 4.195e-04 S  per = 0.149  per(accum) = 100

idx=4 coord=(1,0)
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=95:0.000725MB:7.08e-07GB
 rqops: oplist=CSHPQ nops=C:4 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=26,26 size(op)=154:0.00117MB size(tot)=1682:0.0128MB:1.25e-05GB
ctns::oper_renorm coord=(1,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:5 S:1 H:1 P:1 Q:2 
        dim(bra,ket)=7,7 size(op)=15:0.000114MB size(tot)=95:0.000725MB:7.08e-07GB
CPUmem: VM:1.915e+01GB RSS:1.830e+00GB  Timing: User:4.501e+01S Sys:1.335e+00S Total:4.634e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=10 : 2.280e-04 S -----
rank=0 GPUmem(GB): used=1.39e-05 (oper)=1.39e-05
rank=0 GPUmem(GB): used=1.46e-05 (oper,site)(GB)=1.39e-05,6.41e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=10
 no. of rintermediate operators=8
 no. of coefficients=32:0.000244MB:2.38e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 6.712e-05 S -----
rank=0 GPUmem(GB): used=1.48e-05 (oper,site,rinter)=1.39e-05,6.41e-07,2.38e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0107 S size(rtasks)=10 size(Rlst2)=36 T(Rmu/Rlist)=6.94e-05,0.0107 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0108 S size(rtasks)=10 size(Rlst)=874 -----
rank=0 GPUmem(GB): used=1.48e-05 (oper,site,rinter,batch)=1.39e-05,6.41e-07,2.38e-07,0.000267 blksize=10 blksize0=20 batchsize=874
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.87e-05,0.000742,0.000164
--- TIMING FOR renorm : t_inter=9.8e-05 t_gemm=7.4e-04 t_reduction=1.6e-04 tot=1.0e-03 ---
 renorm[inter] counter=4 t=9.8e-05 per=9.8e+00 cost=1.4e+04 flops=1.5e+08
 renorm[gemm] counter=4 i=0 t=8.3e-05 per=8.3e+00 cost=2.2e+03 flops=2.6e+07
 renorm[gemm] counter=4 i=1 t=8.3e-05 per=8.3e+00 cost=3.0e+03 flops=3.7e+07
 renorm[gemm] counter=4 i=2 t=1.9e-04 per=1.9e+01 cost=7.9e+03 flops=4.2e+07
 renorm[gemm] counter=4 i=3 t=2.4e-04 per=2.4e+01 cost=1.5e+04 flops=6.5e+07
 renorm[gemm] counter=4 i=4 t=1.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=5 t=1.1e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=6 t=1.5e-04 per=1.4e+01 cost=1.0e+04 flops=6.9e+07
 renorm[gemm] counter=4 total t=7.4e-04 per=7.4e+01 cost=3.9e+04 flops=5.2e+07
 renorm[red] counter=4 t=1.6e-04 per=1.6e+01 cost=2.8e+03 flops=1.7e+07
--- TIMING FOR renorm_tot : t_inter=3.9e-04 t_gemm=5.9e-03 t_reduction=1.2e-03 tot=7.5e-03 ---
 renorm_tot[inter] counter=4 t=3.9e-04 per=5.2e+00 cost=6.0e+04 flops=1.5e+08
 renorm_tot[gemm] counter=4 i=0 t=8.3e-04 per=1.1e+01 cost=2.4e+04 flops=2.9e+07
 renorm_tot[gemm] counter=4 i=1 t=4.4e-04 per=5.8e+00 cost=3.2e+04 flops=7.3e+07
 renorm_tot[gemm] counter=4 i=2 t=1.3e-03 per=1.7e+01 cost=7.7e+04 flops=6.1e+07
 renorm_tot[gemm] counter=4 i=3 t=1.7e-03 per=2.3e+01 cost=1.4e+05 flops=8.3e+07
 renorm_tot[gemm] counter=4 i=4 t=4.9e-06 per=6.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=5 t=4.6e-06 per=6.1e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=4 i=6 t=1.7e-03 per=2.3e+01 cost=2.8e+05 flops=1.6e+08
 renorm_tot[gemm] counter=4 total t=5.9e-03 per=7.9e+01 cost=5.5e+05 flops=9.3e+07
 renorm_tot[red] counter=4 t=1.2e-03 per=1.6e+01 cost=1.0e+05 flops=8.6e+07
qops.to_cpu: size(tot)=95:7.2e-04MB:7.1e-07GB t[to_cpu]=1.4e-05S speed=5.1e-02GB/S
check ||H-H.dagger||=1.266e-15 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0174 S rank=0 -----
##### local oper_env: 1.865e-02 S #####
 T(local oper_env: fetch) = 8.564e-04 S  per = 4.59  per(accum) = 4.59
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 4.59
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 4.59
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 4.59
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 4.59
 T(local oper_env: renrm) = 1.752e-02 S  per =   94  per(accum) = 98.5
 T(local oper_env: save ) = 2.711e-04 S  per = 1.45  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 1.752e-02 S  T(sum) = 1.752e-02 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 7.235e-06 S  per = 0.0413  per(accum) = 0.0413
 T(local oper_env: qops init                    ) = 4.389e-04 S  per = 2.51  per(accum) = 2.55
 T(local oper_env: symbolic_formulae_renorm     ) = 2.351e-04 S  per = 1.34  per(accum) = 3.89
 T(local oper_env: allocate qops on gpu         ) = 1.701e-05 S  per = 0.0971  per(accum) = 3.99
 T(local oper_env: site memcpy cpu2gpu          ) = 1.442e-05 S  per = 0.0823  per(accum) = 4.07
 T(local oper_env: rintermediate init           ) = 7.577e-05 S  per = 0.432  per(accum) = 4.5
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.084e-02 S  per = 61.9  per(accum) = 66.4
 T(local oper_env: rmmtasks init                ) = 4.617e-03 S  per = 26.4  per(accum) = 92.7
 T(local oper_env: qops memset on cpu           ) = 3.600e-08 S  per = 0.000205  per(accum) = 92.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 1.090e-03 S  per = 6.22  per(accum) = 99
 T(local oper_env: reduction of opS & opH [nccl]) = 1.066e-06 S  per = 0.00608  per(accum) = 99
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.878e-05 S  per = 0.107  per(accum) = 99.1
 T(local oper_env: deallocate cpu and gpu memory) = 8.505e-06 S  per = 0.0485  per(accum) = 99.1
 T(local oper_env: reduction of opS & opH [comm]) = 6.731e-05 S  per = 0.384  per(accum) = 99.5
 T(local oper_env: conversion from opAB to opPQ ) = 1.168e-05 S  per = 0.0667  per(accum) = 99.6
 T(local oper_env: after oper_renorm            ) = 7.619e-05 S  per = 0.435  per(accum) = 100
##### sweep oper_env: 3.075e-01 S #####
 T(sweep oper_env: fetch) = 7.623e-03 S  per = 2.48  per(accum) = 2.48
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.48
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.48
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.48
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.48
 T(sweep oper_env: renrm) = 2.986e-01 S  per = 97.1  per(accum) = 99.6
 T(sweep oper_env: save ) = 1.276e-03 S  per = 0.415  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -6.928e+09 S  per = -6.928e+31
 T(sweep oper_env: preprocess                  ) = -6.928e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.986e-01 S  T(sum) = 2.986e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 3.607e-05 S  per = 0.0121  per(accum) = 0.0121
 T(sweep oper_env: qops init                    ) = 6.103e-03 S  per = 2.04  per(accum) = 2.06
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.614e-03 S  per = 0.54  per(accum) = 2.6
 T(sweep oper_env: allocate qops on gpu         ) = 1.389e-04 S  per = 0.0465  per(accum) = 2.64
 T(sweep oper_env: site memcpy cpu2gpu          ) = 8.621e-05 S  per = 0.0289  per(accum) = 2.67
 T(sweep oper_env: rintermediate init           ) = 1.977e-04 S  per = 0.0662  per(accum) = 2.74
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 6.551e-02 S  per = 21.9  per(accum) = 24.7
 T(sweep oper_env: rmmtasks init                ) = 2.367e-02 S  per = 7.93  per(accum) = 32.6
 T(sweep oper_env: qops memset on cpu           ) = 1.230e-07 S  per = 4.12e-05  per(accum) = 32.6
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 7.867e-03 S  per = 2.63  per(accum) = 35.2
 T(sweep oper_env: reduction of opS & opH [nccl]) = 4.204e-06 S  per = 0.00141  per(accum) = 35.2
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 9.927e-05 S  per = 0.0332  per(accum) = 35.3
 T(sweep oper_env: deallocate cpu and gpu memory) = 8.225e-05 S  per = 0.0275  per(accum) = 35.3
 T(sweep oper_env: reduction of opS & opH [comm]) = 4.595e-04 S  per = 0.154  per(accum) = 35.5
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.923e-01 S  per = 64.4  per(accum) = 99.8
 T(sweep oper_env: after oper_renorm            ) = 4.957e-04 S  per = 0.166  per(accum) = 100

idx=5 coord=(0,0)
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=95:0.000725MB:7.08e-07GB
 rqops: oplist=CSHPQ nops=C:5 S:1 H:1 P:1 Q:2 
        dim(bra,ket)=7,7 size(op)=15:0.000114MB size(tot)=95:0.000725MB:7.08e-07GB
ctns::oper_renorm coord=(0,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:6 S:0 H:1 P:0 Q:0 
        dim(bra,ket)=2,2 size(op)=2:1.53e-05MB size(tot)=2:1.53e-05MB:1.49e-08GB
CPUmem: VM:1.915e+01GB RSS:1.830e+00GB  Timing: User:4.503e+01S Sys:1.336e+00S Total:4.636e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=7 : 9.873e-05 S -----
rank=0 GPUmem(GB): used=1.43e-06 (oper)=1.43e-06
rank=0 GPUmem(GB): used=1.5e-06 (oper,site)(GB)=1.43e-06,6.71e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=7
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=1.5e-06 (oper,site,rinter)=1.43e-06,6.71e-08,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0011 S size(rtasks)=7 size(Rlst2)=4 T(Rmu/Rlist)=3.06e-05,0.00107 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00112 S size(rtasks)=7 size(Rlst)=128 -----
rank=0 GPUmem(GB): used=1.5e-06 (oper,site,rinter,batch)=1.43e-06,6.71e-08,0,4.77e-06 blksize=2 blksize0=0 batchsize=128
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7e-06,0.000288,7.15e-05
--- TIMING FOR renorm : t_inter=6.8e-06 t_gemm=2.9e-04 t_reduction=7.1e-05 tot=3.7e-04 ---
 renorm[inter] counter=5 t=6.8e-06 per=1.9e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=0 t=6.6e-05 per=1.8e+01 cost=1.5e+02 flops=2.3e+06
 renorm[gemm] counter=5 i=1 t=4.8e-05 per=1.3e+01 cost=1.5e+02 flops=3.1e+06
 renorm[gemm] counter=5 i=2 t=6.3e-05 per=1.7e+01 cost=2.0e+02 flops=3.2e+06
 renorm[gemm] counter=5 i=3 t=5.8e-05 per=1.6e+01 cost=2.0e+02 flops=3.5e+06
 renorm[gemm] counter=5 i=4 t=1.2e-06 per=3.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=5 t=1.1e-06 per=3.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=6 t=5.0e-05 per=1.4e+01 cost=3.4e+02 flops=6.8e+06
 renorm[gemm] counter=5 total t=2.9e-04 per=7.9e+01 cost=1.0e+03 flops=3.6e+06
 renorm[red] counter=5 t=7.1e-05 per=2.0e+01 cost=2.6e+02 flops=3.6e+06
--- TIMING FOR renorm_tot : t_inter=4.0e-04 t_gemm=6.2e-03 t_reduction=1.2e-03 tot=7.9e-03 ---
 renorm_tot[inter] counter=5 t=4.0e-04 per=5.0e+00 cost=6.0e+04 flops=1.5e+08
 renorm_tot[gemm] counter=5 i=0 t=8.9e-04 per=1.1e+01 cost=2.4e+04 flops=2.7e+07
 renorm_tot[gemm] counter=5 i=1 t=4.8e-04 per=6.2e+00 cost=3.2e+04 flops=6.6e+07
 renorm_tot[gemm] counter=5 i=2 t=1.3e-03 per=1.7e+01 cost=7.7e+04 flops=5.8e+07
 renorm_tot[gemm] counter=5 i=3 t=1.8e-03 per=2.2e+01 cost=1.4e+05 flops=8.0e+07
 renorm_tot[gemm] counter=5 i=4 t=6.0e-06 per=7.7e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=5 t=5.6e-06 per=7.2e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=5 i=6 t=1.8e-03 per=2.2e+01 cost=2.8e+05 flops=1.6e+08
 renorm_tot[gemm] counter=5 total t=6.2e-03 per=7.9e+01 cost=5.6e+05 flops=8.9e+07
 renorm_tot[red] counter=5 t=1.2e-03 per=1.6e+01 cost=1.0e+05 flops=8.2e+07
qops.to_cpu: size(tot)=2:1.5e-05MB:1.5e-08GB t[to_cpu]=1.3e-05S speed=1.1e-03GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
ctns::oper_ab2pq coord=(0,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00254 S rank=0 -----
##### local oper_env: 3.601e-03 S #####
 T(local oper_env: fetch) = 8.338e-04 S  per = 23.2  per(accum) = 23.2
 T(local oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 23.2
 T(local oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 23.2
 T(local oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 23.2
 T(local oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 23.2
 T(local oper_env: renrm) = 2.598e-03 S  per = 72.2  per(accum) = 95.3
 T(local oper_env: save ) = 1.683e-04 S  per = 4.67  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -1.732e+09 S  per = -1.732e+31
 T(local oper_env: preprocess                  ) = -1.732e+09 S  per =  100  per(accum) = 100
 T(local oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(local oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 2.598e-03 S  T(sum) = 2.598e-03 S  per = 1.000e+02
 T(local oper_env: before oper_renorm           ) = 6.772e-06 S  per = 0.261  per(accum) = 0.261
 T(local oper_env: qops init                    ) = 1.083e-04 S  per = 4.17  per(accum) = 4.43
 T(local oper_env: symbolic_formulae_renorm     ) = 1.049e-04 S  per = 4.04  per(accum) = 8.47
 T(local oper_env: allocate qops on gpu         ) = 1.805e-05 S  per = 0.695  per(accum) = 9.16
 T(local oper_env: site memcpy cpu2gpu          ) = 1.954e-05 S  per = 0.752  per(accum) = 9.91
 T(local oper_env: rintermediate init           ) = 1.252e-05 S  per = 0.482  per(accum) = 10.4
 T(local oper_env: preprocess_formulae_Rlist2   ) = 1.122e-03 S  per = 43.2  per(accum) = 53.6
 T(local oper_env: rmmtasks init                ) = 6.515e-04 S  per = 25.1  per(accum) = 78.7
 T(local oper_env: qops memset on cpu           ) = 2.800e-08 S  per = 0.00108  per(accum) = 78.7
 T(local oper_env: preprocess_renorm_batchGPU   ) = 4.532e-04 S  per = 17.4  per(accum) = 96.1
 T(local oper_env: reduction of opS & opH [nccl]) = 8.880e-07 S  per = 0.0342  per(accum) = 96.1
 T(local oper_env: qops memcpy gpu2cpu          ) = 1.804e-05 S  per = 0.694  per(accum) = 96.8
 T(local oper_env: deallocate cpu and gpu memory) = 1.088e-05 S  per = 0.419  per(accum) = 97.2
 T(local oper_env: reduction of opS & opH [comm]) = 2.345e-05 S  per = 0.902  per(accum) = 98.2
 T(local oper_env: conversion from opAB to opPQ ) = 3.155e-06 S  per = 0.121  per(accum) = 98.3
 T(local oper_env: after oper_renorm            ) = 4.486e-05 S  per = 1.73  per(accum) = 100
##### sweep oper_env: 3.111e-01 S #####
 T(sweep oper_env: fetch) = 8.457e-03 S  per = 2.72  per(accum) = 2.72
 T(sweep oper_env: hdiag) = 0.000e+00 S  per =    0  per(accum) = 2.72
 T(sweep oper_env: dvdsn) = 0.000e+00 S  per =    0  per(accum) = 2.72
 T(sweep oper_env: decim) = 0.000e+00 S  per =    0  per(accum) = 2.72
 T(sweep oper_env: guess) = 0.000e+00 S  per =    0  per(accum) = 2.72
 T(sweep oper_env: renrm) = 3.012e-01 S  per = 96.8  per(accum) = 99.5
 T(sweep oper_env: save ) = 1.444e-03 S  per = 0.464  per(accum) = 100
Detailed decomposition of T(dvdsn) = 0.000e+00 S  T(sum) = -8.660e+09 S  per = -8.660e+31
 T(sweep oper_env: preprocess                  ) = -8.660e+09 S  per =  100  per(accum) = 100
 T(sweep oper_env: symbolic_formulae           ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hintermediate init          ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: preprocess_hformulae_Hxlist ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: hmmtasks init               ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: initial guess for dvdson    ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [Hx_batchGPU] ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(gpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [comm(cpu)]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
 T(sweep oper_env: dvdson solver [rest part]   ) = 0.000e+00 S  per =   -0  per(accum) = 100
Detailed decomposition of T(renrm) = 3.012e-01 S  T(sum) = 3.012e-01 S  per = 1.000e+02
 T(sweep oper_env: before oper_renorm           ) = 4.285e-05 S  per = 0.0142  per(accum) = 0.0142
 T(sweep oper_env: qops init                    ) = 6.211e-03 S  per = 2.06  per(accum) = 2.08
 T(sweep oper_env: symbolic_formulae_renorm     ) = 1.718e-03 S  per = 0.571  per(accum) = 2.65
 T(sweep oper_env: allocate qops on gpu         ) = 1.570e-04 S  per = 0.0521  per(accum) = 2.7
 T(sweep oper_env: site memcpy cpu2gpu          ) = 1.057e-04 S  per = 0.0351  per(accum) = 2.73
 T(sweep oper_env: rintermediate init           ) = 2.103e-04 S  per = 0.0698  per(accum) = 2.8
 T(sweep oper_env: preprocess_formulae_Rlist2   ) = 6.664e-02 S  per = 22.1  per(accum) = 24.9
 T(sweep oper_env: rmmtasks init                ) = 2.433e-02 S  per = 8.08  per(accum) = 33
 T(sweep oper_env: qops memset on cpu           ) = 1.510e-07 S  per = 5.01e-05  per(accum) = 33
 T(sweep oper_env: preprocess_renorm_batchGPU   ) = 8.320e-03 S  per = 2.76  per(accum) = 35.8
 T(sweep oper_env: reduction of opS & opH [nccl]) = 5.092e-06 S  per = 0.00169  per(accum) = 35.8
 T(sweep oper_env: qops memcpy gpu2cpu          ) = 1.173e-04 S  per = 0.0389  per(accum) = 35.8
 T(sweep oper_env: deallocate cpu and gpu memory) = 9.313e-05 S  per = 0.0309  per(accum) = 35.8
 T(sweep oper_env: reduction of opS & opH [comm]) = 4.829e-04 S  per = 0.16  per(accum) = 36
 T(sweep oper_env: conversion from opAB to opPQ ) = 1.923e-01 S  per = 63.8  per(accum) = 99.8
 T(sweep oper_env: after oper_renorm            ) = 5.405e-04 S  per = 0.179  per(accum) = 100
----- TIMING FOR ctns::oper_env_right : 3.200e-01 S -----
T[ctns::oper_env_right](init/load/comp/save/tot)=0.00748,0.00846,0.301,0.00144,0.319
ctns::oper_load iomode=0 fname=./scratch/sweep/rop(0,0)
fname=./scratch/sweep/rop(0,0) size=1.49e-08GB T[load](info/setup/data/tot)=7.3e-05,5.16e-05,8.94e-06,0.000134 speed=0.000112GB/S
matrix: Hij size=(1,1)
     -3.236066249237e+00 
matrix: Sij size=(1,1)
      1.000000000000e+00 

ctns::sweep_opt maxsweep=2

ctns::oper_init_dotL isym=3 ifkr=1 singlet=0
ctns::oper_save iomode=0 fname=./scratch/sweep/lop(0,0) size=0.000724792480469MB:7.07805156708e-07GB
fname=./scratch/sweep/lop(0,0) size=7.08e-07GB T[save](info/data/tot)=0.000151,7.63e-05,0.000228 speed=0.00311GB/S disk[used]=4.69e-05GB
----- TIMING FOR ctns::oper_init_dotL : 1.070e-03 S -----

ctns::topology::get_sweeps ifboundary=0
 ibond=0 bond=(1,0)-(2,0) forward=1 cturn=0
 ibond=1 bond=(2,0)-(3,0) forward=1 cturn=0
 ibond=2 bond=(3,0)-(4,0) forward=1 cturn=0
 ibond=3 bond=(3,0)-(4,0) forward=0 cturn=0
 ibond=4 bond=(2,0)-(3,0) forward=0 cturn=0
 ibond=5 bond=(1,0)-(2,0) forward=0 cturn=0
..... end of get_sweeps .....

======================================================================
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=1 sym_state=(6,0) singlet=0
qtensor3: site0new own=1 _data=0x4e7d9470
qinfo3su2: site0new sym=(0,0) dir=1,0,1 couple=0
 qbond: qrow nsym=1 dimAll=1
 (0,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=3 nblocks=9 size=3:2.29e-05MB
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=6 mem=559:0.00426MB:4.16e-06GB
 rwfuns: len=1 mem=1:7.63e-06MB:7.45e-09GB
 cpsi: len=1 mem=35:0.000267MB:2.61e-07GB
total mem of comb=595:0.00454MB:4.43e-06GB

isweep=0 ibond=0/seqsize=6 dots=2 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.915e+01GB RSS:1.830e+00GB  Timing: User:4.504e+01S Sys:1.336e+00S Total:4.637e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=559:4.265e-03MB:4.165e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=35:2.670e-04MB:2.608e-07GB
total mem of comb=595:4.539e-03MB:4.433e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,3,1,1
 suppl= 0
 suppr= 3 4 5
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 rqops: oplist=CSHPQ nops=C:3 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=27,27 size(op)=144:1.099e-03MB size(tot)=3075:2.346e-02MB:2.291e-05GB
 c1qops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 c2qops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 qops(tot)=3360:2.563e-02MB:2.503e-05GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
wf4(diml,dimr,dimc1,dimc2)=(3,27,3,3) nnz=141:1.076e-03MB
qtensor4: wf4 own=1 _data=0x4c02dc30
qinfo4su2: wf4 sym=(6,0) couple=0
 qbond: qrow nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qcol nsym=8 dimAll=27
 (1,1):2 (2,0):4 (2,2):3 (3,1):7 (3,3):1 (4,0):5 (4,2):3 (5,1):2
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=33 nblocks=300 size=141:1.076e-03MB
### DIAG TIMING: total=1.255e-03 t1=1.037e-05, t2=1.893e-04, t3=1.225e-04, t4=9.137e-04, t5=3.115e-06, t6=1.251e-05, t7=3.154e-06
duration_diagGPU:1.272e-03
duration_diagreduce:5.000e-08
duration_diagtransform:2.796e-06
----- TIMING FOR symbolic_formulae_twodot with size=102 : 8.820e-04 S -----
rank=0 GPUmem(GB): used=2.5e-05 (oper)=2.5e-05
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=102
 no. of hintermediate operators=22
 no. of coefficients=66:0.000504MB:4.92e-07GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.220e-05 S -----
rank=0 GPUmem(GB): used=2.55e-05 (oper,hinter)=2.5e-05,4.92e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0598 S size(H_formulae)=102 size(Hxlst2)=33 T(Hmu/Hxlist)=0.000216,0.0596 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0611 S size(H_formulae)=102 size(Hxlst)=3838 -----
rank=0 GPUmem(GB): used=0.00146 (oper,hinter,dvdson,batch)=2.5e-05,4.92e-07,2.1e-06,0.00143 blksize=7 blksize0=35 batchsize=3838
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=141 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.21e-05,0.000468,0.00177,0.000269,0.00254
 ndim=141:1.05e-06GB t[comm(intra)]=2.21e-05 speed=0.095GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=4.7e-04 t_gemm=1.8e-03 t_reduction=2.7e-04 tot=2.5e-03 ---
 sigma[inter] counter=1 t=4.7e-04 per=1.9e+01 cost=9.0e+04 flops=1.9e+08
 sigma[gemm] counter=1 i=0 t=1.8e-04 per=7.3e+00 cost=8.5e+03 flops=4.7e+07
 sigma[gemm] counter=1 i=1 t=1.4e-04 per=5.7e+00 cost=8.6e+03 flops=6.1e+07
 sigma[gemm] counter=1 i=2 t=1.5e-04 per=5.8e+00 cost=1.0e+04 flops=7.2e+07
 sigma[gemm] counter=1 i=3 t=1.4e-04 per=5.6e+00 cost=1.0e+04 flops=7.4e+07
 sigma[gemm] counter=1 i=4 t=4.6e-04 per=1.9e+01 cost=6.0e+04 flops=1.3e+08
 sigma[gemm] counter=1 i=5 t=4.3e-04 per=1.7e+01 cost=6.0e+04 flops=1.4e+08
 sigma[gemm] counter=1 i=6 t=1.3e-04 per=5.1e+00 cost=1.0e+04 flops=8.3e+07
 sigma[gemm] counter=1 i=7 t=1.3e-04 per=5.3e+00 cost=1.0e+04 flops=7.8e+07
 sigma[gemm] counter=1 total t=1.8e-03 per=7.1e+01 cost=1.8e+05 flops=1.0e+08
 sigma[red] counter=1 t=2.7e-04 per=1.1e+01 cost=3.4e+04 flops=1.3e+08
--- TIMING FOR sigma_tot : t_inter=4.7e-04 t_gemm=1.8e-03 t_reduction=2.7e-04 tot=2.5e-03 ---
 sigma_tot[inter] counter=1 t=4.7e-04 per=1.9e+01 cost=9.0e+04 flops=1.9e+08
 sigma_tot[gemm] counter=1 i=0 t=1.8e-04 per=7.3e+00 cost=8.5e+03 flops=4.7e+07
 sigma_tot[gemm] counter=1 i=1 t=1.4e-04 per=5.7e+00 cost=8.6e+03 flops=6.1e+07
 sigma_tot[gemm] counter=1 i=2 t=1.5e-04 per=5.8e+00 cost=1.0e+04 flops=7.2e+07
 sigma_tot[gemm] counter=1 i=3 t=1.4e-04 per=5.6e+00 cost=1.0e+04 flops=7.4e+07
 sigma_tot[gemm] counter=1 i=4 t=4.6e-04 per=1.9e+01 cost=6.0e+04 flops=1.3e+08
 sigma_tot[gemm] counter=1 i=5 t=4.3e-04 per=1.7e+01 cost=6.0e+04 flops=1.4e+08
 sigma_tot[gemm] counter=1 i=6 t=1.3e-04 per=5.1e+00 cost=1.0e+04 flops=8.3e+07
 sigma_tot[gemm] counter=1 i=7 t=1.3e-04 per=5.3e+00 cost=1.0e+04 flops=7.8e+07
 sigma_tot[gemm] counter=1 total t=1.8e-03 per=7.1e+01 cost=1.8e+05 flops=1.0e+08
 sigma_tot[red] counter=1 t=2.7e-04 per=1.1e+01 cost=3.4e+04 flops=1.3e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=6.1e-06,1.6e-05,2.0e-06,6.4e-07,1.6e-07
settings: ndim=141 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +      -3.236066249237 -1.003e+03  7.918e-05    1     1  2.754e-03 2.754e-03 2.662e-03
TIMING FOR Davidson : 2.784e-03  T(cal/comm/rest)=2.662e-03,1.310e-07,1.219e-04
decomposed t_rest=1.219e-04
 T(sub)    =2.518e-05 per=2.065e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =4.104e-06 per=3.367e+00
 T(xnrm2)  =3.970e-07 per=3.257e-01
 T(other)  =9.222e-05 per=7.565e+01
optimized energies: isweep=0 ibond=0 dots=2 e[0]=-3.236066249237 nmvp=1
CPUmem: VM:1.915e+01GB RSS:1.831e+00GB  Timing: User:4.513e+01S Sys:1.345e+00S Total:4.647e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=6 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond0.txt
 qbond: qsuper nsym=6 dimAll=10
 (0,0):1 (2,0):3 (1,1):2 (4,0):1 (3,1):2 (2,2):1
----- TMING FOR decimation_genbasis(su2): 9.7e-03 S -----
decimation summary: 10->10 dwt=+1.110e-16 SvN=6.996e-01
 qbond: qkept nsym=6 dimAll=10
 (2,0):3 (1,1):2 (3,1):2 (0,0):1 (4,0):1 (2,2):1
----- TIMING for decimation_row(nkr): 1.102e-02 S T(decim/select/formRot)=9.803e-03,8.699e-04,3.456e-04 -----
----- TIMING FOR twodot_decimation: 1.175e-02 S T(wf/decim)=7.097e-04,1.104e-02 -----
ctns::oper_renorm coord=(1,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:2 S:4 H:1 A:4 B:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
CPUmem: VM:1.915e+01GB RSS:1.831e+00GB  Timing: User:4.677e+01S Sys:1.352e+00S Total:4.812e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=17 : 6.331e-04 S -----
rank=0 GPUmem(GB): used=4.71e-06 (oper)=3.51e-06
rank=0 GPUmem(GB): used=4.86e-06 (oper,site)(GB)=3.51e-06,1.49e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=17
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=4.86e-06 (oper,site,rinter)=3.51e-06,1.49e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00585 S size(rtasks)=17 size(Rlst2)=36 T(Rmu/Rlist)=0.00142,0.00442 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00589 S size(rtasks)=17 size(Rlst)=326 -----
rank=0 GPUmem(GB): used=4.86e-06 (oper,site,rinter,batch)=3.51e-06,1.49e-07,0,4.61e-05 blksize=9 blksize0=0 batchsize=326
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.18e-06,0.000432,0.000692
--- TIMING FOR renorm : t_inter=8.0e-06 t_gemm=4.3e-04 t_reduction=6.9e-04 tot=1.1e-03 ---
 renorm[inter] counter=1 t=8.0e-06 per=7.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=1.0e-04 per=9.0e+00 cost=4.0e+02 flops=4.0e+06
 renorm[gemm] counter=1 i=1 t=6.7e-05 per=5.9e+00 cost=6.2e+02 flops=9.3e+06
 renorm[gemm] counter=1 i=2 t=1.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=3 t=1.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=4 t=6.9e-05 per=6.1e+00 cost=5.6e+02 flops=8.1e+06
 renorm[gemm] counter=1 i=5 t=5.8e-05 per=5.2e+00 cost=4.7e+02 flops=8.0e+06
 renorm[gemm] counter=1 i=6 t=1.3e-04 per=1.2e+01 cost=2.8e+03 flops=2.2e+07
 renorm[gemm] counter=1 total t=4.3e-04 per=3.8e+01 cost=4.9e+03 flops=1.1e+07
 renorm[red] counter=1 t=6.9e-04 per=6.1e+01 cost=2.8e+03 flops=4.1e+06
--- TIMING FOR renorm_tot : t_inter=8.0e-06 t_gemm=4.3e-04 t_reduction=6.9e-04 tot=1.1e-03 ---
 renorm_tot[inter] counter=1 t=8.0e-06 per=7.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=1.0e-04 per=9.0e+00 cost=4.0e+02 flops=4.0e+06
 renorm_tot[gemm] counter=1 i=1 t=6.7e-05 per=5.9e+00 cost=6.2e+02 flops=9.3e+06
 renorm_tot[gemm] counter=1 i=2 t=1.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=3 t=1.2e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=4 t=6.9e-05 per=6.1e+00 cost=5.6e+02 flops=8.1e+06
 renorm_tot[gemm] counter=1 i=5 t=5.8e-05 per=5.2e+00 cost=4.7e+02 flops=8.0e+06
 renorm_tot[gemm] counter=1 i=6 t=1.3e-04 per=1.2e+01 cost=2.8e+03 flops=2.2e+07
 renorm_tot[gemm] counter=1 total t=4.3e-04 per=3.8e+01 cost=4.9e+03 flops=1.1e+07
 renorm_tot[red] counter=1 t=6.9e-04 per=6.1e+01 cost=2.8e+03 flops=4.1e+06
qops.to_cpu: size(tot)=281:2.1e-03MB:2.1e-06GB t[to_cpu]=1.5e-05S speed=1.4e-01GB/S
check ||H-H.dagger||=7.333e-16 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=lc ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 0.0919 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.00148,5.19e-06,0.0391,0.0513,2.93e-05,6.95e-05 -----
----- TIMING FOR oper_renorm : 0.0108 S rank=0 -----
CPUmem: VM:1.915e+01GB RSS:1.831e+00GB  Timing: User:5.703e+01S Sys:1.356e+00S Total:5.839e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=493:3.761e-03MB:3.673e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=141:1.076e-03MB:1.051e-06GB
total mem of comb=635:4.845e-03MB:4.731e-06GB
CPUmem: VM:1.922e+01GB RSS:1.831e+00GB  Timing: User:5.781e+01S Sys:1.369e+00S Total:5.918e+01S
##### local opt: 2.275e-01 S #####
 T(local opt: fetch) = 4.045e-03 S  per = 1.78  per(accum) = 1.78
 T(local opt: hdiag) = 2.009e-03 S  per = 0.883  per(accum) = 2.66
 T(local opt: dvdsn) = 9.474e-02 S  per = 41.6  per(accum) = 44.3
 T(local opt: decim) = 1.178e-02 S  per = 5.18  per(accum) = 49.5
 T(local opt: guess) = 2.353e-03 S  per = 1.03  per(accum) = 50.5
 T(local opt: renrm) = 1.044e-01 S  per = 45.9  per(accum) = 96.4
 T(local opt: save ) = 8.223e-03 S  per = 3.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.474e-02 S  T(sum) = 9.461e-02 S  per = 9.986e+01
 T(local opt: preprocess                  ) = 4.520e-03 S  per = 4.78  per(accum) = 4.78
 T(local opt: symbolic_formulae           ) = 8.937e-04 S  per = 0.945  per(accum) = 5.72
 T(local opt: hintermediate init          ) = 6.185e-05 S  per = 0.0654  per(accum) = 5.79
 T(local opt: preprocess_hformulae_Hxlist ) = 6.119e-02 S  per = 64.7  per(accum) = 70.5
 T(local opt: hmmtasks init               ) = 2.322e-02 S  per = 24.5  per(accum) = 95
 T(local opt: initial guess for dvdson    ) = 1.944e-03 S  per = 2.05  per(accum) = 97.1
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.640e-03 S  per = 2.79  per(accum) = 99.8
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.212e-05 S  per = 0.0234  per(accum) = 99.9
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.310e-07 S  per = 0.000138  per(accum) = 99.9
 T(local opt: dvdson solver [rest part]   ) = 1.219e-04 S  per = 0.129  per(accum) = 100
Detailed decomposition of T(renrm) = 1.044e-01 S  T(sum) = 1.044e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.266e-03 S  per = 1.21  per(accum) = 1.21
 T(local opt: qops init                    ) = 1.172e-03 S  per = 1.12  per(accum) = 2.34
 T(local opt: symbolic_formulae_renorm     ) = 6.419e-04 S  per = 0.615  per(accum) = 2.95
 T(local opt: allocate qops on gpu         ) = 4.518e-05 S  per = 0.0433  per(accum) = 2.99
 T(local opt: site memcpy cpu2gpu          ) = 2.042e-05 S  per = 0.0196  per(accum) = 3.01
 T(local opt: rintermediate init           ) = 1.610e-05 S  per = 0.0154  per(accum) = 3.03
 T(local opt: preprocess_formulae_Rlist2   ) = 5.905e-03 S  per = 5.66  per(accum) = 8.69
 T(local opt: rmmtasks init                ) = 1.639e-03 S  per = 1.57  per(accum) = 10.3
 T(local opt: qops memset on cpu           ) = 2.900e-08 S  per = 2.78e-05  per(accum) = 10.3
 T(local opt: preprocess_renorm_batchGPU   ) = 1.224e-03 S  per = 1.17  per(accum) = 11.4
 T(local opt: reduction of opS & opH [nccl]) = 1.206e-06 S  per = 0.00116  per(accum) = 11.4
 T(local opt: qops memcpy gpu2cpu          ) = 2.000e-05 S  per = 0.0192  per(accum) = 11.5
 T(local opt: deallocate cpu and gpu memory) = 9.259e-06 S  per = 0.00887  per(accum) = 11.5
 T(local opt: reduction of opS & opH [comm]) = 7.099e-05 S  per = 0.068  per(accum) = 11.5
 T(local opt: conversion from opAB to opPQ ) = 9.196e-02 S  per = 88.1  per(accum) = 99.6
 T(local opt: after oper_renorm            ) = 3.793e-04 S  per = 0.363  per(accum) = 100
##### sweep opt: 2.275e-01 S #####
 T(sweep opt: fetch) = 4.045e-03 S  per = 1.78  per(accum) = 1.78
 T(sweep opt: hdiag) = 2.009e-03 S  per = 0.883  per(accum) = 2.66
 T(sweep opt: dvdsn) = 9.474e-02 S  per = 41.6  per(accum) = 44.3
 T(sweep opt: decim) = 1.178e-02 S  per = 5.18  per(accum) = 49.5
 T(sweep opt: guess) = 2.353e-03 S  per = 1.03  per(accum) = 50.5
 T(sweep opt: renrm) = 1.044e-01 S  per = 45.9  per(accum) = 96.4
 T(sweep opt: save ) = 8.223e-03 S  per = 3.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.474e-02 S  T(sum) = 9.461e-02 S  per = 9.986e+01
 T(sweep opt: preprocess                  ) = 4.520e-03 S  per = 4.78  per(accum) = 4.78
 T(sweep opt: symbolic_formulae           ) = 8.937e-04 S  per = 0.945  per(accum) = 5.72
 T(sweep opt: hintermediate init          ) = 6.185e-05 S  per = 0.0654  per(accum) = 5.79
 T(sweep opt: preprocess_hformulae_Hxlist ) = 6.119e-02 S  per = 64.7  per(accum) = 70.5
 T(sweep opt: hmmtasks init               ) = 2.322e-02 S  per = 24.5  per(accum) = 95
 T(sweep opt: initial guess for dvdson    ) = 1.944e-03 S  per = 2.05  per(accum) = 97.1
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 2.640e-03 S  per = 2.79  per(accum) = 99.8
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.212e-05 S  per = 0.0234  per(accum) = 99.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.310e-07 S  per = 0.000138  per(accum) = 99.9
 T(sweep opt: dvdson solver [rest part]   ) = 1.219e-04 S  per = 0.129  per(accum) = 100
Detailed decomposition of T(renrm) = 1.044e-01 S  T(sum) = 1.044e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.266e-03 S  per = 1.21  per(accum) = 1.21
 T(sweep opt: qops init                    ) = 1.172e-03 S  per = 1.12  per(accum) = 2.34
 T(sweep opt: symbolic_formulae_renorm     ) = 6.419e-04 S  per = 0.615  per(accum) = 2.95
 T(sweep opt: allocate qops on gpu         ) = 4.518e-05 S  per = 0.0433  per(accum) = 2.99
 T(sweep opt: site memcpy cpu2gpu          ) = 2.042e-05 S  per = 0.0196  per(accum) = 3.01
 T(sweep opt: rintermediate init           ) = 1.610e-05 S  per = 0.0154  per(accum) = 3.03
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.905e-03 S  per = 5.66  per(accum) = 8.69
 T(sweep opt: rmmtasks init                ) = 1.639e-03 S  per = 1.57  per(accum) = 10.3
 T(sweep opt: qops memset on cpu           ) = 2.900e-08 S  per = 2.78e-05  per(accum) = 10.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.224e-03 S  per = 1.17  per(accum) = 11.4
 T(sweep opt: reduction of opS & opH [nccl]) = 1.206e-06 S  per = 0.00116  per(accum) = 11.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 2.000e-05 S  per = 0.0192  per(accum) = 11.5
 T(sweep opt: deallocate cpu and gpu memory) = 9.259e-06 S  per = 0.00887  per(accum) = 11.5
 T(sweep opt: reduction of opS & opH [comm]) = 7.099e-05 S  per = 0.068  per(accum) = 11.5
 T(sweep opt: conversion from opAB to opPQ ) = 9.196e-02 S  per = 88.1  per(accum) = 99.6
 T(sweep opt: after oper_renorm            ) = 3.793e-04 S  per = 0.363  per(accum) = 100
##### global opt: 2.275e-01 S #####
 T(global opt: fetch) = 4.045e-03 S  per = 1.78  per(accum) = 1.78
 T(global opt: hdiag) = 2.009e-03 S  per = 0.883  per(accum) = 2.66
 T(global opt: dvdsn) = 9.474e-02 S  per = 41.6  per(accum) = 44.3
 T(global opt: decim) = 1.178e-02 S  per = 5.18  per(accum) = 49.5
 T(global opt: guess) = 2.353e-03 S  per = 1.03  per(accum) = 50.5
 T(global opt: renrm) = 1.044e-01 S  per = 45.9  per(accum) = 96.4
 T(global opt: save ) = 8.223e-03 S  per = 3.61  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.474e-02 S  T(sum) = 9.461e-02 S  per = 9.986e+01
 T(global opt: preprocess                  ) = 4.520e-03 S  per = 4.78  per(accum) = 4.78
 T(global opt: symbolic_formulae           ) = 8.937e-04 S  per = 0.945  per(accum) = 5.72
 T(global opt: hintermediate init          ) = 6.185e-05 S  per = 0.0654  per(accum) = 5.79
 T(global opt: preprocess_hformulae_Hxlist ) = 6.119e-02 S  per = 64.7  per(accum) = 70.5
 T(global opt: hmmtasks init               ) = 2.322e-02 S  per = 24.5  per(accum) = 95
 T(global opt: initial guess for dvdson    ) = 1.944e-03 S  per = 2.05  per(accum) = 97.1
 T(global opt: dvdson solver [Hx_batchGPU] ) = 2.640e-03 S  per = 2.79  per(accum) = 99.8
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.212e-05 S  per = 0.0234  per(accum) = 99.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.310e-07 S  per = 0.000138  per(accum) = 99.9
 T(global opt: dvdson solver [rest part]   ) = 1.219e-04 S  per = 0.129  per(accum) = 100
Detailed decomposition of T(renrm) = 1.044e-01 S  T(sum) = 1.044e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.266e-03 S  per = 1.21  per(accum) = 1.21
 T(global opt: qops init                    ) = 1.172e-03 S  per = 1.12  per(accum) = 2.34
 T(global opt: symbolic_formulae_renorm     ) = 6.419e-04 S  per = 0.615  per(accum) = 2.95
 T(global opt: allocate qops on gpu         ) = 4.518e-05 S  per = 0.0433  per(accum) = 2.99
 T(global opt: site memcpy cpu2gpu          ) = 2.042e-05 S  per = 0.0196  per(accum) = 3.01
 T(global opt: rintermediate init           ) = 1.610e-05 S  per = 0.0154  per(accum) = 3.03
 T(global opt: preprocess_formulae_Rlist2   ) = 5.905e-03 S  per = 5.66  per(accum) = 8.69
 T(global opt: rmmtasks init                ) = 1.639e-03 S  per = 1.57  per(accum) = 10.3
 T(global opt: qops memset on cpu           ) = 2.900e-08 S  per = 2.78e-05  per(accum) = 10.3
 T(global opt: preprocess_renorm_batchGPU   ) = 1.224e-03 S  per = 1.17  per(accum) = 11.4
 T(global opt: reduction of opS & opH [nccl]) = 1.206e-06 S  per = 0.00116  per(accum) = 11.4
 T(global opt: qops memcpy gpu2cpu          ) = 2.000e-05 S  per = 0.0192  per(accum) = 11.5
 T(global opt: deallocate cpu and gpu memory) = 9.259e-06 S  per = 0.00887  per(accum) = 11.5
 T(global opt: reduction of opS & opH [comm]) = 7.099e-05 S  per = 0.068  per(accum) = 11.5
 T(global opt: conversion from opAB to opPQ ) = 9.196e-02 S  per = 88.1  per(accum) = 99.6
 T(global opt: after oper_renorm            ) = 3.793e-04 S  per = 0.363  per(accum) = 100

isweep=0 ibond=1/seqsize=6 dots=2 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.922e+01GB RSS:1.831e+00GB  Timing: User:5.781e+01S Sys:1.369e+00S Total:5.918e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=493:3.761e-03MB:3.673e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=141:1.076e-03MB:1.051e-06GB
total mem of comb=635:4.845e-03MB:4.731e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,2,1,1
 suppl= 0 1
 suppr= 4 5
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:2 S:4 H:1 P:16 Q:20 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=626:4.776e-03MB:4.664e-06GB
 rqops: oplist=CSHAB nops=C:2 S:4 H:1 A:4 B:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 c2qops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 qops(tot)=1097:8.369e-03MB:8.173e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=175:1.335e-03MB
qtensor4: wf4 own=1 _data=0x4d7dfea0
qinfo4su2: wf4 sym=(6,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (2,0):3 (1,1):2 (3,1):2 (0,0):1 (4,0):1 (2,2):1
 qbond: qcol nsym=6 dimAll=10
 (0,0):1 (1,1):2 (2,0):3 (2,2):1 (3,1):2 (4,0):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=53 nblocks=441 size=175:1.335e-03MB
### DIAG TIMING: total=3.553e-03 t1=1.249e-05, t2=3.407e-04, t3=2.181e-04, t4=2.961e-03, t5=3.610e-06, t6=1.349e-05, t7=3.973e-06
duration_diagGPU:3.568e-03
duration_diagreduce:3.800e-08
duration_diagtransform:1.089e-06
----- TIMING FOR symbolic_formulae_twodot with size=176 : 1.589e-03 S -----
rank=0 GPUmem(GB): used=8.17e-06 (oper)=8.17e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=176
 no. of hintermediate operators=51
 no. of coefficients=102:0.000778MB:7.6e-07GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 6.569e-05 S -----
rank=0 GPUmem(GB): used=8.93e-06 (oper,hinter)=8.17e-06,7.6e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.164 S size(H_formulae)=176 size(Hxlst2)=53 T(Hmu/Hxlist)=0.000531,0.163 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.165 S size(H_formulae)=176 size(Hxlst)=11816 -----
rank=0 GPUmem(GB): used=0.00221 (oper,hinter,dvdson,batch)=8.17e-06,7.6e-07,2.61e-06,0.0022 blksize=9 blksize0=6 batchsize=11816
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=175 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.33e-05,0.000178,0.00223,0.000396,0.00285
 ndim=175:1.3e-06GB t[comm(intra)]=2.33e-05 speed=0.112GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=2.2e-03 t_reduction=4.0e-04 tot=2.8e-03 ---
 sigma[inter] counter=2 t=1.8e-04 per=6.3e+00 cost=4.7e+04 flops=2.7e+08
 sigma[gemm] counter=2 i=0 t=1.7e-04 per=6.1e+00 cost=2.3e+04 flops=1.4e+08
 sigma[gemm] counter=2 i=1 t=1.6e-04 per=5.8e+00 cost=2.3e+04 flops=1.4e+08
 sigma[gemm] counter=2 i=2 t=1.7e-04 per=6.1e+00 cost=2.1e+04 flops=1.2e+08
 sigma[gemm] counter=2 i=3 t=1.5e-04 per=5.3e+00 cost=2.1e+04 flops=1.4e+08
 sigma[gemm] counter=2 i=4 t=3.8e-04 per=1.4e+01 cost=6.4e+04 flops=1.7e+08
 sigma[gemm] counter=2 i=5 t=5.0e-04 per=1.8e+01 cost=6.4e+04 flops=1.3e+08
 sigma[gemm] counter=2 i=6 t=3.7e-04 per=1.3e+01 cost=5.7e+04 flops=1.6e+08
 sigma[gemm] counter=2 i=7 t=3.4e-04 per=1.2e+01 cost=5.7e+04 flops=1.7e+08
 sigma[gemm] counter=2 total t=2.2e-03 per=8.0e+01 cost=3.3e+05 flops=1.5e+08
 sigma[red] counter=2 t=4.0e-04 per=1.4e+01 cost=8.2e+04 flops=2.1e+08
--- TIMING FOR sigma_tot : t_inter=6.5e-04 t_gemm=4.0e-03 t_reduction=6.6e-04 tot=5.3e-03 ---
 sigma_tot[inter] counter=2 t=6.5e-04 per=1.2e+01 cost=1.4e+05 flops=2.1e+08
 sigma_tot[gemm] counter=2 i=0 t=3.5e-04 per=6.6e+00 cost=3.2e+04 flops=9.1e+07
 sigma_tot[gemm] counter=2 i=1 t=3.1e-04 per=5.7e+00 cost=3.2e+04 flops=1.0e+08
 sigma_tot[gemm] counter=2 i=2 t=3.2e-04 per=6.0e+00 cost=3.2e+04 flops=1.0e+08
 sigma_tot[gemm] counter=2 i=3 t=2.9e-04 per=5.4e+00 cost=3.2e+04 flops=1.1e+08
 sigma_tot[gemm] counter=2 i=4 t=8.4e-04 per=1.6e+01 cost=1.2e+05 flops=1.5e+08
 sigma_tot[gemm] counter=2 i=5 t=9.3e-04 per=1.8e+01 cost=1.2e+05 flops=1.3e+08
 sigma_tot[gemm] counter=2 i=6 t=4.9e-04 per=9.3e+00 cost=6.7e+04 flops=1.4e+08
 sigma_tot[gemm] counter=2 i=7 t=4.7e-04 per=8.8e+00 cost=6.7e+04 flops=1.4e+08
 sigma_tot[gemm] counter=2 total t=4.0e-03 per=7.5e+01 cost=5.1e+05 flops=1.3e+08
 sigma_tot[red] counter=2 t=6.6e-04 per=1.3e+01 cost=1.2e+05 flops=1.8e+08
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,5.1e-06,2.1e-06,8.7e-07,1.7e-07
settings: ndim=175 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.236066249237 -1.003e+03  2.626e-04    1     1  3.013e-03 3.013e-03 2.978e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.419e-05,2.198e-04,2.336e-03,2.760e-04,2.865e-03
 ndim=175:1.304e-06GB t[comm(intra)]=2.419e-05 speed=1.078e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=2.3e-03 t_reduction=2.8e-04 tot=2.8e-03 ---
 sigma[inter] counter=3 t=2.2e-04 per=7.8e+00 cost=4.7e+04 flops=2.2e+08
 sigma[gemm] counter=3 i=0 t=2.1e-04 per=7.6e+00 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=3 i=1 t=2.1e-04 per=7.4e+00 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=3 i=2 t=1.9e-04 per=6.7e+00 cost=2.1e+04 flops=1.1e+08
 sigma[gemm] counter=3 i=3 t=2.0e-04 per=7.2e+00 cost=2.1e+04 flops=1.0e+08
 sigma[gemm] counter=3 i=4 t=3.8e-04 per=1.4e+01 cost=6.4e+04 flops=1.7e+08
 sigma[gemm] counter=3 i=5 t=3.9e-04 per=1.4e+01 cost=6.4e+04 flops=1.6e+08
 sigma[gemm] counter=3 i=6 t=3.9e-04 per=1.4e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=3 i=7 t=3.6e-04 per=1.3e+01 cost=5.7e+04 flops=1.6e+08
 sigma[gemm] counter=3 total t=2.3e-03 per=8.2e+01 cost=3.3e+05 flops=1.4e+08
 sigma[red] counter=3 t=2.8e-04 per=9.7e+00 cost=8.2e+04 flops=3.0e+08
--- TIMING FOR sigma_tot : t_inter=8.6e-04 t_gemm=6.3e-03 t_reduction=9.4e-04 tot=8.1e-03 ---
 sigma_tot[inter] counter=3 t=8.6e-04 per=1.1e+01 cost=1.9e+05 flops=2.1e+08
 sigma_tot[gemm] counter=3 i=0 t=5.7e-04 per=7.0e+00 cost=5.5e+04 flops=9.8e+07
 sigma_tot[gemm] counter=3 i=1 t=5.1e-04 per=6.3e+00 cost=5.5e+04 flops=1.1e+08
 sigma_tot[gemm] counter=3 i=2 t=5.1e-04 per=6.2e+00 cost=5.3e+04 flops=1.0e+08
 sigma_tot[gemm] counter=3 i=3 t=4.9e-04 per=6.0e+00 cost=5.3e+04 flops=1.1e+08
 sigma_tot[gemm] counter=3 i=4 t=1.2e-03 per=1.5e+01 cost=1.9e+05 flops=1.5e+08
 sigma_tot[gemm] counter=3 i=5 t=1.3e-03 per=1.6e+01 cost=1.9e+05 flops=1.4e+08
 sigma_tot[gemm] counter=3 i=6 t=8.8e-04 per=1.1e+01 cost=1.2e+05 flops=1.4e+08
 sigma_tot[gemm] counter=3 i=7 t=8.3e-04 per=1.0e+01 cost=1.2e+05 flops=1.5e+08
 sigma_tot[gemm] counter=3 total t=6.3e-03 per=7.8e+01 cost=8.4e+05 flops=1.3e+08
 sigma_tot[red] counter=3 t=9.4e-04 per=1.2e+01 cost=2.0e+05 flops=2.1e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.6e-06,1.5e-05,4.4e-06,1.4e-06,2.6e-07
    2   0 +      -3.236066272912 -2.367e-08  7.804e-05    2     2  1.474e-02 7.370e-03 3.018e-03
TIMING FOR Davidson : 1.475e-02  T(cal/comm/rest)=6.036e-03,3.150e-07,8.714e-03
decomposed t_rest=8.714e-03
 T(sub)    =3.738e-05 per=4.290e-01
 T(precond)=8.610e-03 per=9.881e+01
 T(ortho)  =4.452e-06 per=5.109e-02
 T(xcopy)  =5.010e-07 per=5.749e-03
 T(xnrm2)  =1.018e-06 per=1.168e-02
 T(other)  =6.070e-05 per=6.966e-01
optimized energies: isweep=0 ibond=1 dots=2 e[0]=-3.236066272912 nmvp=2
CPUmem: VM:1.922e+01GB RSS:1.838e+00GB  Timing: User:5.940e+01S Sys:1.373e+00S Total:6.077e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=10 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond1.txt
 qbond: qsuper nsym=10 dimAll=35
 (2,0):6 (4,0):6 (3,1):8 (1,1):3 (2,2):3 (5,1):3 (4,2):3 (0,0):1 (6,0):1 (3,3):1
----- TMING FOR decimation_genbasis(su2): 6.4e-03 S -----
decimation summary: 35->10 dwt=+1.399e-04 SvN=8.900e-01
 qbond: qkept nsym=6 dimAll=10
 (3,1):3 (2,0):2 (4,0):2 (2,2):1 (5,1):1 (4,2):1
----- TIMING for decimation_row(nkr): 6.885e-03 S T(decim/select/formRot)=6.429e-03,3.377e-04,1.184e-04 -----
----- TIMING FOR twodot_decimation: 7.909e-03 S T(wf/decim)=1.002e-03,6.907e-03 -----
ctns::oper_renorm coord=(2,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:3 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=10,10 size(op)=21:1.602e-04MB size(tot)=458:3.494e-03MB:3.412e-06GB
CPUmem: VM:1.922e+01GB RSS:1.838e+00GB  Timing: User:6.063e+01S Sys:1.374e+00S Total:6.201e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=28 : 8.191e-04 S -----
rank=0 GPUmem(GB): used=1.03e-05 (oper)=8.78e-06
rank=0 GPUmem(GB): used=1.07e-05 (oper,site)(GB)=8.78e-06,4.25e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=28
 no. of rintermediate operators=42
 no. of coefficients=84:0.000641MB:6.26e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 2.358e-04 S -----
rank=0 GPUmem(GB): used=1.13e-05 (oper,site,rinter)=8.78e-06,4.25e-07,6.26e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0166 S size(rtasks)=28 size(Rlst2)=36 T(Rmu/Rlist)=0.000279,0.0163 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0167 S size(rtasks)=28 size(Rlst)=1312 -----
rank=0 GPUmem(GB): used=1.13e-05 (oper,site,rinter,batch)=8.78e-06,4.25e-07,6.26e-07,0.000244 blksize=9 blksize0=6 batchsize=1312
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.73e-05,0.00186,0.000255
--- TIMING FOR renorm : t_inter=9.7e-05 t_gemm=1.9e-03 t_reduction=2.5e-04 tot=2.2e-03 ---
 renorm[inter] counter=2 t=9.7e-05 per=4.4e+00 cost=6.2e+03 flops=6.4e+07
 renorm[gemm] counter=2 i=0 t=8.9e-05 per=4.0e+00 cost=2.7e+03 flops=3.0e+07
 renorm[gemm] counter=2 i=1 t=1.1e-03 per=4.8e+01 cost=4.1e+03 flops=3.8e+06
 renorm[gemm] counter=2 i=2 t=1.2e-06 per=5.6e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=3 t=1.2e-06 per=5.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=4 t=2.3e-04 per=1.1e+01 cost=6.1e+03 flops=2.6e+07
 renorm[gemm] counter=2 i=5 t=2.3e-04 per=1.1e+01 cost=8.6e+03 flops=3.7e+07
 renorm[gemm] counter=2 i=6 t=2.4e-04 per=1.1e+01 cost=2.0e+04 flops=8.6e+07
 renorm[gemm] counter=2 total t=1.9e-03 per=8.4e+01 cost=4.2e+04 flops=2.3e+07
 renorm[red] counter=2 t=2.5e-04 per=1.2e+01 cost=1.0e+04 flops=4.1e+07
--- TIMING FOR renorm_tot : t_inter=1.0e-04 t_gemm=2.3e-03 t_reduction=9.5e-04 tot=3.3e-03 ---
 renorm_tot[inter] counter=2 t=1.0e-04 per=3.1e+00 cost=6.2e+03 flops=5.9e+07
 renorm_tot[gemm] counter=2 i=0 t=1.9e-04 per=5.7e+00 cost=3.1e+03 flops=1.6e+07
 renorm_tot[gemm] counter=2 i=1 t=1.1e-03 per=3.4e+01 cost=4.7e+03 flops=4.2e+06
 renorm_tot[gemm] counter=2 i=2 t=2.5e-06 per=7.3e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=3 t=2.4e-06 per=7.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=4 t=3.0e-04 per=9.0e+00 cost=6.7e+03 flops=2.2e+07
 renorm_tot[gemm] counter=2 i=5 t=2.9e-04 per=8.8e+00 cost=9.1e+03 flops=3.1e+07
 renorm_tot[gemm] counter=2 i=6 t=3.7e-04 per=1.1e+01 cost=2.3e+04 flops=6.3e+07
 renorm_tot[gemm] counter=2 total t=2.3e-03 per=6.9e+01 cost=4.7e+04 flops=2.0e+07
 renorm_tot[red] counter=2 t=9.5e-04 per=2.8e+01 cost=1.3e+04 flops=1.4e+07
qops.to_cpu: size(tot)=458:3.5e-03MB:3.4e-06GB t[to_cpu]=1.5e-05S speed=2.3e-01GB/S
check ||H-H.dagger||=3.729e-16 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0295 S rank=0 -----
CPUmem: VM:1.922e+01GB RSS:1.838e+00GB  Timing: User:6.157e+01S Sys:1.377e+00S Total:6.294e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=244:1.862e-03MB:1.818e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=302:2.304e-03MB:2.250e-06GB
CPUmem: VM:1.934e+01GB RSS:1.838e+00GB  Timing: User:6.157e+01S Sys:1.377e+00S Total:6.295e+01S
##### local opt: 3.219e-01 S #####
 T(local opt: fetch) = 2.837e-04 S  per = 0.0881  per(accum) = 0.0881
 T(local opt: hdiag) = 4.751e-03 S  per = 1.48  per(accum) = 1.56
 T(local opt: dvdsn) = 2.765e-01 S  per = 85.9  per(accum) = 87.5
 T(local opt: decim) = 7.943e-03 S  per = 2.47  per(accum) = 89.9
 T(local opt: guess) = 1.502e-03 S  per = 0.467  per(accum) = 90.4
 T(local opt: renrm) = 3.041e-02 S  per = 9.45  per(accum) = 99.8
 T(local opt: save ) = 4.883e-04 S  per = 0.152  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.765e-01 S  T(sum) = 2.756e-01 S  per = 9.964e+01
 T(local opt: preprocess                  ) = 7.462e-03 S  per = 2.71  per(accum) = 2.71
 T(local opt: symbolic_formulae           ) = 1.603e-03 S  per = 0.582  per(accum) = 3.29
 T(local opt: hintermediate init          ) = 8.108e-05 S  per = 0.0294  per(accum) = 3.32
 T(local opt: preprocess_hformulae_Hxlist ) = 1.656e-01 S  per = 60.1  per(accum) = 63.4
 T(local opt: hmmtasks init               ) = 8.395e-02 S  per = 30.5  per(accum) = 93.9
 T(local opt: initial guess for dvdson    ) = 2.125e-03 S  per = 0.771  per(accum) = 94.6
 T(local opt: dvdson solver [Hx_batchGPU] ) = 5.989e-03 S  per = 2.17  per(accum) = 96.8
 T(local opt: dvdson solver [comm(gpu)]   ) = 4.748e-05 S  per = 0.0172  per(accum) = 96.8
 T(local opt: dvdson solver [comm(cpu)]   ) = 3.150e-07 S  per = 0.000114  per(accum) = 96.8
 T(local opt: dvdson solver [rest part]   ) = 8.714e-03 S  per = 3.16  per(accum) = 100
Detailed decomposition of T(renrm) = 3.041e-02 S  T(sum) = 3.041e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 6.739e-04 S  per = 2.22  per(accum) = 2.22
 T(local opt: qops init                    ) = 1.437e-03 S  per = 4.73  per(accum) = 6.94
 T(local opt: symbolic_formulae_renorm     ) = 8.282e-04 S  per = 2.72  per(accum) = 9.67
 T(local opt: allocate qops on gpu         ) = 2.543e-05 S  per = 0.0836  per(accum) = 9.75
 T(local opt: site memcpy cpu2gpu          ) = 2.224e-05 S  per = 0.0732  per(accum) = 9.82
 T(local opt: rintermediate init           ) = 2.470e-04 S  per = 0.813  per(accum) = 10.6
 T(local opt: preprocess_formulae_Rlist2   ) = 1.679e-02 S  per = 55.2  per(accum) = 65.9
 T(local opt: rmmtasks init                ) = 7.771e-03 S  per = 25.6  per(accum) = 91.4
 T(local opt: qops memset on cpu           ) = 3.100e-08 S  per = 0.000102  per(accum) = 91.4
 T(local opt: preprocess_renorm_batchGPU   ) = 2.309e-03 S  per =  7.6  per(accum) = 99
 T(local opt: reduction of opS & opH [nccl]) = 1.213e-06 S  per = 0.00399  per(accum) = 99
 T(local opt: qops memcpy gpu2cpu          ) = 2.025e-05 S  per = 0.0666  per(accum) = 99.1
 T(local opt: deallocate cpu and gpu memory) = 1.075e-05 S  per = 0.0354  per(accum) = 99.1
 T(local opt: reduction of opS & opH [comm]) = 7.413e-05 S  per = 0.244  per(accum) = 99.4
 T(local opt: conversion from opAB to opPQ ) = 3.750e-06 S  per = 0.0123  per(accum) = 99.4
 T(local opt: after oper_renorm            ) = 1.911e-04 S  per = 0.629  per(accum) = 100
##### sweep opt: 5.494e-01 S #####
 T(sweep opt: fetch) = 4.329e-03 S  per = 0.788  per(accum) = 0.788
 T(sweep opt: hdiag) = 6.760e-03 S  per = 1.23  per(accum) = 2.02
 T(sweep opt: dvdsn) = 3.713e-01 S  per = 67.6  per(accum) = 69.6
 T(sweep opt: decim) = 1.972e-02 S  per = 3.59  per(accum) = 73.2
 T(sweep opt: guess) = 3.855e-03 S  per = 0.702  per(accum) = 73.9
 T(sweep opt: renrm) = 1.348e-01 S  per = 24.5  per(accum) = 98.4
 T(sweep opt: save ) = 8.711e-03 S  per = 1.59  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.713e-01 S  T(sum) = 3.702e-01 S  per = 9.970e+01
 T(sweep opt: preprocess                  ) = 1.198e-02 S  per = 3.24  per(accum) = 3.24
 T(sweep opt: symbolic_formulae           ) = 2.497e-03 S  per = 0.674  per(accum) = 3.91
 T(sweep opt: hintermediate init          ) = 1.429e-04 S  per = 0.0386  per(accum) = 3.95
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.268e-01 S  per = 61.3  per(accum) = 65.2
 T(sweep opt: hmmtasks init               ) = 1.072e-01 S  per =   29  per(accum) = 94.2
 T(sweep opt: initial guess for dvdson    ) = 4.069e-03 S  per =  1.1  per(accum) = 95.3
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 8.629e-03 S  per = 2.33  per(accum) = 97.6
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 6.960e-05 S  per = 0.0188  per(accum) = 97.6
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 4.460e-07 S  per = 0.00012  per(accum) = 97.6
 T(sweep opt: dvdson solver [rest part]   ) = 8.836e-03 S  per = 2.39  per(accum) = 100
Detailed decomposition of T(renrm) = 1.348e-01 S  T(sum) = 1.348e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.940e-03 S  per = 1.44  per(accum) = 1.44
 T(sweep opt: qops init                    ) = 2.609e-03 S  per = 1.94  per(accum) = 3.38
 T(sweep opt: symbolic_formulae_renorm     ) = 1.470e-03 S  per = 1.09  per(accum) = 4.47
 T(sweep opt: allocate qops on gpu         ) = 7.062e-05 S  per = 0.0524  per(accum) = 4.52
 T(sweep opt: site memcpy cpu2gpu          ) = 4.266e-05 S  per = 0.0317  per(accum) = 4.55
 T(sweep opt: rintermediate init           ) = 2.631e-04 S  per = 0.195  per(accum) = 4.75
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.270e-02 S  per = 16.8  per(accum) = 21.6
 T(sweep opt: rmmtasks init                ) = 9.410e-03 S  per = 6.98  per(accum) = 28.6
 T(sweep opt: qops memset on cpu           ) = 6.000e-08 S  per = 4.45e-05  per(accum) = 28.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.534e-03 S  per = 2.62  per(accum) = 31.2
 T(sweep opt: reduction of opS & opH [nccl]) = 2.419e-06 S  per = 0.00179  per(accum) = 31.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 4.024e-05 S  per = 0.0299  per(accum) = 31.2
 T(sweep opt: deallocate cpu and gpu memory) = 2.001e-05 S  per = 0.0148  per(accum) = 31.2
 T(sweep opt: reduction of opS & opH [comm]) = 1.451e-04 S  per = 0.108  per(accum) = 31.3
 T(sweep opt: conversion from opAB to opPQ ) = 9.196e-02 S  per = 68.2  per(accum) = 99.6
 T(sweep opt: after oper_renorm            ) = 5.704e-04 S  per = 0.423  per(accum) = 100
##### global opt: 5.494e-01 S #####
 T(global opt: fetch) = 4.329e-03 S  per = 0.788  per(accum) = 0.788
 T(global opt: hdiag) = 6.760e-03 S  per = 1.23  per(accum) = 2.02
 T(global opt: dvdsn) = 3.713e-01 S  per = 67.6  per(accum) = 69.6
 T(global opt: decim) = 1.972e-02 S  per = 3.59  per(accum) = 73.2
 T(global opt: guess) = 3.855e-03 S  per = 0.702  per(accum) = 73.9
 T(global opt: renrm) = 1.348e-01 S  per = 24.5  per(accum) = 98.4
 T(global opt: save ) = 8.711e-03 S  per = 1.59  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.713e-01 S  T(sum) = 3.702e-01 S  per = 9.970e+01
 T(global opt: preprocess                  ) = 1.198e-02 S  per = 3.24  per(accum) = 3.24
 T(global opt: symbolic_formulae           ) = 2.497e-03 S  per = 0.674  per(accum) = 3.91
 T(global opt: hintermediate init          ) = 1.429e-04 S  per = 0.0386  per(accum) = 3.95
 T(global opt: preprocess_hformulae_Hxlist ) = 2.268e-01 S  per = 61.3  per(accum) = 65.2
 T(global opt: hmmtasks init               ) = 1.072e-01 S  per =   29  per(accum) = 94.2
 T(global opt: initial guess for dvdson    ) = 4.069e-03 S  per =  1.1  per(accum) = 95.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 8.629e-03 S  per = 2.33  per(accum) = 97.6
 T(global opt: dvdson solver [comm(gpu)]   ) = 6.960e-05 S  per = 0.0188  per(accum) = 97.6
 T(global opt: dvdson solver [comm(cpu)]   ) = 4.460e-07 S  per = 0.00012  per(accum) = 97.6
 T(global opt: dvdson solver [rest part]   ) = 8.836e-03 S  per = 2.39  per(accum) = 100
Detailed decomposition of T(renrm) = 1.348e-01 S  T(sum) = 1.348e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 1.940e-03 S  per = 1.44  per(accum) = 1.44
 T(global opt: qops init                    ) = 2.609e-03 S  per = 1.94  per(accum) = 3.38
 T(global opt: symbolic_formulae_renorm     ) = 1.470e-03 S  per = 1.09  per(accum) = 4.47
 T(global opt: allocate qops on gpu         ) = 7.062e-05 S  per = 0.0524  per(accum) = 4.52
 T(global opt: site memcpy cpu2gpu          ) = 4.266e-05 S  per = 0.0317  per(accum) = 4.55
 T(global opt: rintermediate init           ) = 2.631e-04 S  per = 0.195  per(accum) = 4.75
 T(global opt: preprocess_formulae_Rlist2   ) = 2.270e-02 S  per = 16.8  per(accum) = 21.6
 T(global opt: rmmtasks init                ) = 9.410e-03 S  per = 6.98  per(accum) = 28.6
 T(global opt: qops memset on cpu           ) = 6.000e-08 S  per = 4.45e-05  per(accum) = 28.6
 T(global opt: preprocess_renorm_batchGPU   ) = 3.534e-03 S  per = 2.62  per(accum) = 31.2
 T(global opt: reduction of opS & opH [nccl]) = 2.419e-06 S  per = 0.00179  per(accum) = 31.2
 T(global opt: qops memcpy gpu2cpu          ) = 4.024e-05 S  per = 0.0299  per(accum) = 31.2
 T(global opt: deallocate cpu and gpu memory) = 2.001e-05 S  per = 0.0148  per(accum) = 31.2
 T(global opt: reduction of opS & opH [comm]) = 1.451e-04 S  per = 0.108  per(accum) = 31.3
 T(global opt: conversion from opAB to opPQ ) = 9.196e-02 S  per = 68.2  per(accum) = 99.6
 T(global opt: after oper_renorm            ) = 5.704e-04 S  per = 0.423  per(accum) = 100

isweep=0 ibond=2/seqsize=6 dots=2 dbond=(3,0)-(4,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.934e+01GB RSS:1.838e+00GB  Timing: User:6.157e+01S Sys:1.378e+00S Total:6.295e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=244:1.862e-03MB:1.818e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=302:2.304e-03MB:2.250e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=3,1,1,1
 suppl= 0 1 2
 suppr= 5
 suppc1= 3
 suppc2= 4
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:3 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=10,10 size(op)=21:1.602e-04MB size(tot)=458:3.494e-03MB:3.412e-06GB
 rqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 c1qops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 c2qops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 qops(tot)=743:5.669e-03MB:5.536e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(3,0) fdel=./scratch/sweep/rop(4,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=57:4.349e-04MB
qtensor4: wf4 own=1 _data=0x4d28f1f0
qinfo4su2: wf4 sym=(6,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (3,1):3 (2,0):2 (4,0):2 (2,2):1 (5,1):1 (4,2):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=29 nblocks=220 size=57:4.349e-04MB
### DIAG TIMING: total=1.185e-03 t1=9.745e-06, t2=1.694e-04, t3=9.467e-05, t4=8.909e-04, t5=3.882e-06, t6=1.245e-05, t7=3.515e-06
duration_diagGPU:1.196e-03
duration_diagreduce:3.000e-08
duration_diagtransform:4.290e-07
----- TIMING FOR symbolic_formulae_twodot with size=102 : 9.074e-04 S -----
rank=0 GPUmem(GB): used=5.54e-06 (oper)=5.54e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=102
 no. of hintermediate operators=22
 no. of coefficients=66:0.000504MB:4.92e-07GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.454e-05 S -----
rank=0 GPUmem(GB): used=6.03e-06 (oper,hinter)=5.54e-06,4.92e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0434 S size(H_formulae)=102 size(Hxlst2)=29 T(Hmu/Hxlist)=0.000226,0.0432 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0437 S size(H_formulae)=102 size(Hxlst)=3138 -----
rank=0 GPUmem(GB): used=0.000311 (oper,hinter,dvdson,batch)=5.54e-06,4.92e-07,8.49e-07,0.000304 blksize=3 blksize0=6 batchsize=3138
ctns::twodot_guess_v0 |lc1>
ctns::pdvdsonSolver_nkr::solve_iter ndim=57 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.22e-05,0.000102,0.000718,0.00018,0.00103
 ndim=57:4.25e-07GB t[comm(intra)]=2.22e-05 speed=0.0383GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=7.2e-04 t_reduction=1.8e-04 tot=1.0e-03 ---
 sigma[inter] counter=4 t=1.0e-04 per=1.0e+01 cost=1.5e+04 flops=1.5e+08
 sigma[gemm] counter=4 i=0 t=8.3e-05 per=8.3e+00 cost=4.0e+03 flops=4.8e+07
 sigma[gemm] counter=4 i=1 t=8.0e-05 per=8.0e+00 cost=3.9e+03 flops=4.9e+07
 sigma[gemm] counter=4 i=2 t=7.4e-05 per=7.4e+00 cost=3.3e+03 flops=4.5e+07
 sigma[gemm] counter=4 i=3 t=7.6e-05 per=7.6e+00 cost=3.2e+03 flops=4.2e+07
 sigma[gemm] counter=4 i=4 t=7.4e-05 per=7.4e+00 cost=4.0e+03 flops=5.4e+07
 sigma[gemm] counter=4 i=5 t=7.4e-05 per=7.4e+00 cost=3.9e+03 flops=5.3e+07
 sigma[gemm] counter=4 i=6 t=1.4e-04 per=1.4e+01 cost=9.8e+03 flops=7.1e+07
 sigma[gemm] counter=4 i=7 t=1.2e-04 per=1.2e+01 cost=9.8e+03 flops=8.4e+07
 sigma[gemm] counter=4 total t=7.2e-04 per=7.2e+01 cost=4.2e+04 flops=5.9e+07
 sigma[red] counter=4 t=1.8e-04 per=1.8e+01 cost=1.3e+04 flops=7.2e+07
--- TIMING FOR sigma_tot : t_inter=9.7e-04 t_gemm=7.0e-03 t_reduction=1.1e-03 tot=9.1e-03 ---
 sigma_tot[inter] counter=4 t=9.7e-04 per=1.1e+01 cost=2.0e+05 flops=2.1e+08
 sigma_tot[gemm] counter=4 i=0 t=6.5e-04 per=7.1e+00 cost=5.9e+04 flops=9.1e+07
 sigma_tot[gemm] counter=4 i=1 t=5.9e-04 per=6.5e+00 cost=5.9e+04 flops=1.0e+08
 sigma_tot[gemm] counter=4 i=2 t=5.8e-04 per=6.4e+00 cost=5.6e+04 flops=9.7e+07
 sigma_tot[gemm] counter=4 i=3 t=5.7e-04 per=6.2e+00 cost=5.6e+04 flops=9.8e+07
 sigma_tot[gemm] counter=4 i=4 t=1.3e-03 per=1.4e+01 cost=1.9e+05 flops=1.5e+08
 sigma_tot[gemm] counter=4 i=5 t=1.4e-03 per=1.5e+01 cost=1.9e+05 flops=1.4e+08
 sigma_tot[gemm] counter=4 i=6 t=1.0e-03 per=1.1e+01 cost=1.3e+05 flops=1.3e+08
 sigma_tot[gemm] counter=4 i=7 t=9.4e-04 per=1.0e+01 cost=1.3e+05 flops=1.4e+08
 sigma_tot[gemm] counter=4 total t=7.0e-03 per=7.7e+01 cost=8.8e+05 flops=1.3e+08
 sigma_tot[red] counter=4 t=1.1e-03 per=1.2e+01 cost=2.1e+05 flops=1.9e+08
T(sub)=9.1e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,4.1e-06,1.8e-06,6.2e-07,1.4e-07
settings: ndim=57 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.235783981702 -1.003e+03  4.044e-03    1     1  1.179e-03 1.179e-03 1.149e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.758e-05,1.803e-04,1.322e-03,3.566e-04,1.913e-03
 ndim=57:4.247e-07GB t[comm(intra)]=3.758e-05 speed=2.260e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.8e-04 t_gemm=1.3e-03 t_reduction=3.6e-04 tot=1.9e-03 ---
 sigma[inter] counter=5 t=1.8e-04 per=9.7e+00 cost=1.5e+04 flops=8.3e+07
 sigma[gemm] counter=5 i=0 t=1.5e-04 per=8.1e+00 cost=4.0e+03 flops=2.6e+07
 sigma[gemm] counter=5 i=1 t=1.4e-04 per=7.7e+00 cost=3.9e+03 flops=2.7e+07
 sigma[gemm] counter=5 i=2 t=1.3e-04 per=7.1e+00 cost=3.3e+03 flops=2.5e+07
 sigma[gemm] counter=5 i=3 t=1.3e-04 per=7.1e+00 cost=3.2e+03 flops=2.4e+07
 sigma[gemm] counter=5 i=4 t=1.7e-04 per=9.3e+00 cost=4.0e+03 flops=2.3e+07
 sigma[gemm] counter=5 i=5 t=1.4e-04 per=7.5e+00 cost=3.9e+03 flops=2.8e+07
 sigma[gemm] counter=5 i=6 t=2.3e-04 per=1.2e+01 cost=9.8e+03 flops=4.3e+07
 sigma[gemm] counter=5 i=7 t=2.2e-04 per=1.2e+01 cost=9.8e+03 flops=4.4e+07
 sigma[gemm] counter=5 total t=1.3e-03 per=7.1e+01 cost=4.2e+04 flops=3.2e+07
 sigma[red] counter=5 t=3.6e-04 per=1.9e+01 cost=1.3e+04 flops=3.6e+07
--- TIMING FOR sigma_tot : t_inter=1.1e-03 t_gemm=8.4e-03 t_reduction=1.5e-03 tot=1.1e-02 ---
 sigma_tot[inter] counter=5 t=1.1e-03 per=1.0e+01 cost=2.2e+05 flops=1.9e+08
 sigma_tot[gemm] counter=5 i=0 t=8.0e-04 per=7.3e+00 cost=6.3e+04 flops=7.9e+07
 sigma_tot[gemm] counter=5 i=1 t=7.4e-04 per=6.7e+00 cost=6.3e+04 flops=8.6e+07
 sigma_tot[gemm] counter=5 i=2 t=7.1e-04 per=6.5e+00 cost=5.9e+04 flops=8.3e+07
 sigma_tot[gemm] counter=5 i=3 t=7.0e-04 per=6.4e+00 cost=5.9e+04 flops=8.5e+07
 sigma_tot[gemm] counter=5 i=4 t=1.5e-03 per=1.3e+01 cost=2.0e+05 flops=1.3e+08
 sigma_tot[gemm] counter=5 i=5 t=1.5e-03 per=1.4e+01 cost=2.0e+05 flops=1.3e+08
 sigma_tot[gemm] counter=5 i=6 t=1.2e-03 per=1.1e+01 cost=1.4e+05 flops=1.2e+08
 sigma_tot[gemm] counter=5 i=7 t=1.2e-03 per=1.1e+01 cost=1.4e+05 flops=1.2e+08
 sigma_tot[gemm] counter=5 total t=8.4e-03 per=7.6e+01 cost=9.2e+05 flops=1.1e+08
 sigma_tot[red] counter=5 t=1.5e-03 per=1.3e+01 cost=2.2e+05 flops=1.5e+08
T(sub)=4.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.0e-05,1.5e-05,4.9e-06,1.4e-06,2.7e-07
    2   0 -      -3.235795535101 -1.155e-05  1.529e-03    2     2  1.312e-02 6.558e-03 1.671e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.436e-05,1.239e-04,9.868e-04,2.527e-04,1.395e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.436e-05 speed=3.487e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=9.9e-04 t_reduction=2.5e-04 tot=1.4e-03 ---
 sigma[inter] counter=6 t=1.2e-04 per=9.1e+00 cost=1.5e+04 flops=1.2e+08
 sigma[gemm] counter=6 i=0 t=1.3e-04 per=9.3e+00 cost=4.0e+03 flops=3.1e+07
 sigma[gemm] counter=6 i=1 t=1.1e-04 per=7.9e+00 cost=3.9e+03 flops=3.6e+07
 sigma[gemm] counter=6 i=2 t=9.9e-05 per=7.3e+00 cost=3.3e+03 flops=3.3e+07
 sigma[gemm] counter=6 i=3 t=9.9e-05 per=7.3e+00 cost=3.2e+03 flops=3.2e+07
 sigma[gemm] counter=6 i=4 t=1.1e-04 per=8.0e+00 cost=4.0e+03 flops=3.6e+07
 sigma[gemm] counter=6 i=5 t=1.1e-04 per=8.4e+00 cost=3.9e+03 flops=3.4e+07
 sigma[gemm] counter=6 i=6 t=1.7e-04 per=1.2e+01 cost=9.8e+03 flops=6.0e+07
 sigma[gemm] counter=6 i=7 t=1.6e-04 per=1.2e+01 cost=9.8e+03 flops=6.0e+07
 sigma[gemm] counter=6 total t=9.9e-04 per=7.2e+01 cost=4.2e+04 flops=4.3e+07
 sigma[red] counter=6 t=2.5e-04 per=1.9e+01 cost=1.3e+04 flops=5.1e+07
--- TIMING FOR sigma_tot : t_inter=1.3e-03 t_gemm=9.4e-03 t_reduction=1.7e-03 tot=1.2e-02 ---
 sigma_tot[inter] counter=6 t=1.3e-03 per=1.0e+01 cost=2.3e+05 flops=1.8e+08
 sigma_tot[gemm] counter=6 i=0 t=9.3e-04 per=7.5e+00 cost=6.7e+04 flops=7.2e+07
 sigma_tot[gemm] counter=6 i=1 t=8.4e-04 per=6.8e+00 cost=6.7e+04 flops=8.0e+07
 sigma_tot[gemm] counter=6 i=2 t=8.1e-04 per=6.6e+00 cost=6.3e+04 flops=7.7e+07
 sigma_tot[gemm] counter=6 i=3 t=8.0e-04 per=6.5e+00 cost=6.2e+04 flops=7.8e+07
 sigma_tot[gemm] counter=6 i=4 t=1.6e-03 per=1.3e+01 cost=2.0e+05 flops=1.3e+08
 sigma_tot[gemm] counter=6 i=5 t=1.6e-03 per=1.3e+01 cost=2.0e+05 flops=1.2e+08
 sigma_tot[gemm] counter=6 i=6 t=1.4e-03 per=1.1e+01 cost=1.5e+05 flops=1.1e+08
 sigma_tot[gemm] counter=6 i=7 t=1.3e-03 per=1.1e+01 cost=1.5e+05 flops=1.2e+08
 sigma_tot[gemm] counter=6 total t=9.4e-03 per=7.6e+01 cost=9.7e+05 flops=1.0e+08
 sigma_tot[red] counter=6 t=1.7e-03 per=1.4e+01 cost=2.4e+05 flops=1.4e+08
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=4.4e-06,1.8e-05,3.8e-06,1.5e-06,2.6e-07
    3   0 -      -3.235797311420 -1.776e-06  7.842e-04    3     3  2.614e-02 8.712e-03 1.646e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.418e-05,1.189e-04,9.660e-04,2.408e-04,1.357e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.418e-05 speed=3.512e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=9.6e-04 t_reduction=2.4e-04 tot=1.3e-03 ---
 sigma[inter] counter=7 t=1.2e-04 per=9.0e+00 cost=1.5e+04 flops=1.3e+08
 sigma[gemm] counter=7 i=0 t=1.3e-04 per=9.7e+00 cost=4.0e+03 flops=3.1e+07
 sigma[gemm] counter=7 i=1 t=1.0e-04 per=7.9e+00 cost=3.9e+03 flops=3.7e+07
 sigma[gemm] counter=7 i=2 t=9.8e-05 per=7.4e+00 cost=3.3e+03 flops=3.4e+07
 sigma[gemm] counter=7 i=3 t=9.7e-05 per=7.3e+00 cost=3.2e+03 flops=3.3e+07
 sigma[gemm] counter=7 i=4 t=1.1e-04 per=8.0e+00 cost=4.0e+03 flops=3.7e+07
 sigma[gemm] counter=7 i=5 t=1.0e-04 per=7.8e+00 cost=3.9e+03 flops=3.8e+07
 sigma[gemm] counter=7 i=6 t=1.7e-04 per=1.3e+01 cost=9.8e+03 flops=5.8e+07
 sigma[gemm] counter=7 i=7 t=1.6e-04 per=1.2e+01 cost=9.8e+03 flops=6.2e+07
 sigma[gemm] counter=7 total t=9.6e-04 per=7.3e+01 cost=4.2e+04 flops=4.4e+07
 sigma[red] counter=7 t=2.4e-04 per=1.8e+01 cost=1.3e+04 flops=5.4e+07
--- TIMING FOR sigma_tot : t_inter=1.4e-03 t_gemm=1.0e-02 t_reduction=2.0e-03 tot=1.4e-02 ---
 sigma_tot[inter] counter=7 t=1.4e-03 per=1.0e+01 cost=2.4e+05 flops=1.8e+08
 sigma_tot[gemm] counter=7 i=0 t=1.1e-03 per=7.7e+00 cost=7.1e+04 flops=6.7e+07
 sigma_tot[gemm] counter=7 i=1 t=9.5e-04 per=6.9e+00 cost=7.1e+04 flops=7.5e+07
 sigma_tot[gemm] counter=7 i=2 t=9.1e-04 per=6.6e+00 cost=6.6e+04 flops=7.3e+07
 sigma_tot[gemm] counter=7 i=3 t=9.0e-04 per=6.5e+00 cost=6.5e+04 flops=7.3e+07
 sigma_tot[gemm] counter=7 i=4 t=1.7e-03 per=1.2e+01 cost=2.0e+05 flops=1.2e+08
 sigma_tot[gemm] counter=7 i=5 t=1.8e-03 per=1.3e+01 cost=2.0e+05 flops=1.2e+08
 sigma_tot[gemm] counter=7 i=6 t=1.6e-03 per=1.2e+01 cost=1.6e+05 flops=1.0e+08
 sigma_tot[gemm] counter=7 i=7 t=1.5e-03 per=1.1e+01 cost=1.6e+05 flops=1.1e+08
 sigma_tot[gemm] counter=7 total t=1.0e-02 per=7.5e+01 cost=1.0e+06 flops=9.8e+07
 sigma_tot[red] counter=7 t=2.0e-03 per=1.4e+01 cost=2.5e+05 flops=1.3e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.7e-05,3.7e-06,1.3e-06,2.2e-07
    4   0 -      -3.235797739339 -4.279e-07  4.557e-04    3     4  3.807e-02 9.518e-03 1.620e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.400e-05,1.157e-04,9.426e-04,2.142e-04,1.303e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.400e-05 speed=3.540e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=9.4e-04 t_reduction=2.1e-04 tot=1.3e-03 ---
 sigma[inter] counter=8 t=1.2e-04 per=9.1e+00 cost=1.5e+04 flops=1.3e+08
 sigma[gemm] counter=8 i=0 t=1.1e-04 per=8.3e+00 cost=4.0e+03 flops=3.8e+07
 sigma[gemm] counter=8 i=1 t=1.0e-04 per=8.0e+00 cost=3.9e+03 flops=3.8e+07
 sigma[gemm] counter=8 i=2 t=9.4e-05 per=7.4e+00 cost=3.3e+03 flops=3.5e+07
 sigma[gemm] counter=8 i=3 t=9.4e-05 per=7.4e+00 cost=3.2e+03 flops=3.4e+07
 sigma[gemm] counter=8 i=4 t=1.0e-04 per=8.1e+00 cost=4.0e+03 flops=3.8e+07
 sigma[gemm] counter=8 i=5 t=1.3e-04 per=1.0e+01 cost=3.9e+03 flops=3.0e+07
 sigma[gemm] counter=8 i=6 t=1.6e-04 per=1.2e+01 cost=9.8e+03 flops=6.3e+07
 sigma[gemm] counter=8 i=7 t=1.5e-04 per=1.2e+01 cost=9.8e+03 flops=6.4e+07
 sigma[gemm] counter=8 total t=9.4e-04 per=7.4e+01 cost=4.2e+04 flops=4.5e+07
 sigma[red] counter=8 t=2.1e-04 per=1.7e+01 cost=1.3e+04 flops=6.0e+07
--- TIMING FOR sigma_tot : t_inter=1.5e-03 t_gemm=1.1e-02 t_reduction=2.2e-03 tot=1.5e-02 ---
 sigma_tot[inter] counter=8 t=1.5e-03 per=1.0e+01 cost=2.6e+05 flops=1.7e+08
 sigma_tot[gemm] counter=8 i=0 t=1.2e-03 per=7.8e+00 cost=7.5e+04 flops=6.5e+07
 sigma_tot[gemm] counter=8 i=1 t=1.0e-03 per=7.0e+00 cost=7.5e+04 flops=7.1e+07
 sigma_tot[gemm] counter=8 i=2 t=1.0e-03 per=6.7e+00 cost=6.9e+04 flops=6.9e+07
 sigma_tot[gemm] counter=8 i=3 t=9.9e-04 per=6.6e+00 cost=6.9e+04 flops=6.9e+07
 sigma_tot[gemm] counter=8 i=4 t=1.8e-03 per=1.2e+01 cost=2.1e+05 flops=1.2e+08
 sigma_tot[gemm] counter=8 i=5 t=1.9e-03 per=1.3e+01 cost=2.1e+05 flops=1.1e+08
 sigma_tot[gemm] counter=8 i=6 t=1.7e-03 per=1.2e+01 cost=1.7e+05 flops=1.0e+08
 sigma_tot[gemm] counter=8 i=7 t=1.6e-03 per=1.1e+01 cost=1.7e+05 flops=1.1e+08
 sigma_tot[gemm] counter=8 total t=1.1e-02 per=7.5e+01 cost=1.1e+06 flops=9.3e+07
 sigma_tot[red] counter=8 t=2.2e-03 per=1.5e+01 cost=2.6e+05 flops=1.2e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.6e-05,3.6e-06,1.2e-06,2.0e-07
    5   0 -      -3.235797868135 -1.288e-07  2.378e-04    3     5  4.953e-02 9.906e-03 1.594e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.386e-05,1.165e-04,9.269e-04,2.152e-04,1.289e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.386e-05 speed=3.559e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=9.3e-04 t_reduction=2.1e-04 tot=1.3e-03 ---
 sigma[inter] counter=9 t=1.2e-04 per=9.3e+00 cost=1.5e+04 flops=1.3e+08
 sigma[gemm] counter=9 i=0 t=1.0e-04 per=8.3e+00 cost=4.0e+03 flops=3.8e+07
 sigma[gemm] counter=9 i=1 t=1.0e-04 per=8.1e+00 cost=3.9e+03 flops=3.8e+07
 sigma[gemm] counter=9 i=2 t=9.5e-05 per=7.6e+00 cost=3.3e+03 flops=3.5e+07
 sigma[gemm] counter=9 i=3 t=9.3e-05 per=7.4e+00 cost=3.2e+03 flops=3.4e+07
 sigma[gemm] counter=9 i=4 t=1.2e-04 per=9.3e+00 cost=4.0e+03 flops=3.4e+07
 sigma[gemm] counter=9 i=5 t=1.1e-04 per=8.5e+00 cost=3.9e+03 flops=3.7e+07
 sigma[gemm] counter=9 i=6 t=1.6e-04 per=1.2e+01 cost=9.8e+03 flops=6.3e+07
 sigma[gemm] counter=9 i=7 t=1.5e-04 per=1.2e+01 cost=9.8e+03 flops=6.4e+07
 sigma[gemm] counter=9 total t=9.3e-04 per=7.4e+01 cost=4.2e+04 flops=4.5e+07
 sigma[red] counter=9 t=2.1e-04 per=1.7e+01 cost=1.3e+04 flops=6.0e+07
--- TIMING FOR sigma_tot : t_inter=1.6e-03 t_gemm=1.2e-02 t_reduction=2.4e-03 tot=1.6e-02 ---
 sigma_tot[inter] counter=9 t=1.6e-03 per=1.0e+01 cost=2.7e+05 flops=1.7e+08
 sigma_tot[gemm] counter=9 i=0 t=1.3e-03 per=7.8e+00 cost=7.9e+04 flops=6.3e+07
 sigma_tot[gemm] counter=9 i=1 t=1.2e-03 per=7.1e+00 cost=7.9e+04 flops=6.8e+07
 sigma_tot[gemm] counter=9 i=2 t=1.1e-03 per=6.8e+00 cost=7.3e+04 flops=6.6e+07
 sigma_tot[gemm] counter=9 i=3 t=1.1e-03 per=6.7e+00 cost=7.2e+04 flops=6.6e+07
 sigma_tot[gemm] counter=9 i=4 t=1.9e-03 per=1.2e+01 cost=2.1e+05 flops=1.1e+08
 sigma_tot[gemm] counter=9 i=5 t=2.0e-03 per=1.2e+01 cost=2.1e+05 flops=1.1e+08
 sigma_tot[gemm] counter=9 i=6 t=1.9e-03 per=1.2e+01 cost=1.8e+05 flops=9.7e+07
 sigma_tot[gemm] counter=9 i=7 t=1.8e-03 per=1.1e+01 cost=1.8e+05 flops=1.0e+08
 sigma_tot[gemm] counter=9 total t=1.2e-02 per=7.5e+01 cost=1.1e+06 flops=9.0e+07
 sigma_tot[red] counter=9 t=2.4e-03 per=1.5e+01 cost=2.8e+05 flops=1.1e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=3.9e-06,1.5e-05,3.6e-06,1.3e-06,1.9e-07
    6   0 +      -3.235797901320 -3.319e-08  8.898e-05    3     6  6.060e-02 1.010e-02 1.573e-03
TIMING FOR Davidson : 6.062e-02  T(cal/comm/rest)=9.439e-03,1.041e-06,5.118e-02
decomposed t_rest=5.118e-02
 T(sub)    =1.538e-04 per=3.005e-01
 T(precond)=5.080e-02 per=9.927e+01
 T(ortho)  =3.391e-05 per=6.626e-02
 T(xcopy)  =1.135e-06 per=2.218e-03
 T(xnrm2)  =3.269e-06 per=6.388e-03
 T(other)  =1.811e-04 per=3.540e-01
optimized energies: isweep=0 ibond=2 dots=2 e[0]=-3.235797901320 nmvp=6
CPUmem: VM:1.934e+01GB RSS:1.838e+00GB  Timing: User:6.799e+01S Sys:1.378e+00S Total:6.937e+01S
ctns::twodot_renorm superblock=lc1 (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond2.txt
 qbond: qsuper nsym=11 dimAll=36
 (3,1):6 (5,1):7 (4,0):7 (4,2):5 (2,0):2 (6,0):3 (2,2):1 (3,3):1 (7,1):1 (6,2):2 (5,3):1
----- TMING FOR decimation_genbasis(su2): 8.2e-03 S -----
decimation summary: 36->10 dwt=-2.220e-16 SvN=6.966e-01
 qbond: qkept nsym=6 dimAll=10
 (4,0):3 (3,1):2 (5,1):2 (4,2):1 (2,0):1 (6,0):1
----- TIMING for decimation_row(nkr): 8.706e-03 S T(decim/select/formRot)=8.285e-03,3.089e-04,1.124e-04 -----
----- TIMING FOR twodot_decimation: 9.353e-03 S T(wf/decim)=6.291e-04,8.724e-03 -----
ctns::oper_renorm coord=(3,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:4 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
CPUmem: VM:1.934e+01GB RSS:1.838e+00GB  Timing: User:6.927e+01S Sys:1.380e+00S Total:7.065e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=17 : 6.345e-04 S -----
rank=0 GPUmem(GB): used=8.12e-06 (oper)=6.21e-06
rank=0 GPUmem(GB): used=8.55e-06 (oper,site)(GB)=6.21e-06,4.25e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=17
 no. of rintermediate operators=22
 no. of coefficients=66:0.000504MB:4.92e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.880e-05 S -----
rank=0 GPUmem(GB): used=9.04e-06 (oper,site,rinter)=6.21e-06,4.25e-07,4.92e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0132 S size(rtasks)=17 size(Rlst2)=36 T(Rmu/Rlist)=0.000212,0.013 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0133 S size(rtasks)=17 size(Rlst)=848 -----
rank=0 GPUmem(GB): used=9.04e-06 (oper,site,rinter,batch)=6.21e-06,4.25e-07,4.92e-07,0.000158 blksize=9 blksize0=6 batchsize=848
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=0.000114,0.000973,0.000322
--- TIMING FOR renorm : t_inter=1.1e-04 t_gemm=9.7e-04 t_reduction=3.2e-04 tot=1.4e-03 ---
 renorm[inter] counter=3 t=1.1e-04 per=8.1e+00 cost=5.4e+03 flops=4.8e+07
 renorm[gemm] counter=3 i=0 t=9.7e-05 per=6.9e+00 cost=1.9e+03 flops=1.9e+07
 renorm[gemm] counter=3 i=1 t=9.4e-05 per=6.7e+00 cost=2.6e+03 flops=2.8e+07
 renorm[gemm] counter=3 i=2 t=1.5e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=3 t=1.4e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=4 t=2.5e-04 per=1.8e+01 cost=4.5e+03 flops=1.8e+07
 renorm[gemm] counter=3 i=5 t=2.6e-04 per=1.8e+01 cost=6.0e+03 flops=2.3e+07
 renorm[gemm] counter=3 i=6 t=2.6e-04 per=1.9e+01 cost=1.3e+04 flops=4.9e+07
 renorm[gemm] counter=3 total t=9.7e-04 per=6.9e+01 cost=2.8e+04 flops=2.9e+07
 renorm[red] counter=3 t=3.2e-04 per=2.3e+01 cost=6.2e+03 flops=1.9e+07
--- TIMING FOR renorm_tot : t_inter=2.2e-04 t_gemm=3.3e-03 t_reduction=1.3e-03 tot=4.7e-03 ---
 renorm_tot[inter] counter=3 t=2.2e-04 per=4.6e+00 cost=1.2e+04 flops=5.3e+07
 renorm_tot[gemm] counter=3 i=0 t=2.9e-04 per=6.1e+00 cost=4.9e+03 flops=1.7e+07
 renorm_tot[gemm] counter=3 i=1 t=1.2e-03 per=2.6e+01 cost=7.3e+03 flops=6.0e+06
 renorm_tot[gemm] counter=3 i=2 t=4.0e-06 per=8.4e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=3 t=3.8e-06 per=8.0e-02 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=4 t=5.5e-04 per=1.2e+01 cost=1.1e+04 flops=2.0e+07
 renorm_tot[gemm] counter=3 i=5 t=5.5e-04 per=1.2e+01 cost=1.5e+04 flops=2.7e+07
 renorm_tot[gemm] counter=3 i=6 t=6.3e-04 per=1.3e+01 cost=3.6e+04 flops=5.7e+07
 renorm_tot[gemm] counter=3 total t=3.3e-03 per=6.9e+01 cost=7.5e+04 flops=2.3e+07
 renorm_tot[red] counter=3 t=1.3e-03 per=2.7e+01 cost=1.9e+04 flops=1.5e+07
qops.to_cpu: size(tot)=281:2.1e-03MB:2.1e-06GB t[to_cpu]=1.5e-05S speed=1.4e-01GB/S
check ||H-H.dagger||=2.175e-15 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0229 S rank=0 -----
CPUmem: VM:1.934e+01GB RSS:1.838e+00GB  Timing: User:6.995e+01S Sys:1.382e+00S Total:7.133e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=20:1.526e-04MB:1.490e-07GB
total mem of comb=181:1.381e-03MB:1.349e-06GB
CPUmem: VM:1.934e+01GB RSS:1.838e+00GB  Timing: User:6.995e+01S Sys:1.382e+00S Total:7.133e+01S
##### local opt: 1.642e-01 S #####
 T(local opt: fetch) = 2.043e-04 S  per = 0.124  per(accum) = 0.124
 T(local opt: hdiag) = 1.691e-03 S  per = 1.03  per(accum) = 1.15
 T(local opt: dvdsn) = 1.284e-01 S  per = 78.2  per(accum) = 79.4
 T(local opt: decim) = 9.381e-03 S  per = 5.71  per(accum) = 85.1
 T(local opt: guess) = 9.064e-04 S  per = 0.552  per(accum) = 85.6
 T(local opt: renrm) = 2.355e-02 S  per = 14.3  per(accum) = 100
 T(local opt: save ) = 5.287e-05 S  per = 0.0322  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.284e-01 S  T(sum) = 1.281e-01 S  per = 9.978e+01
 T(local opt: preprocess                  ) = 3.277e-03 S  per = 2.56  per(accum) = 2.56
 T(local opt: symbolic_formulae           ) = 9.187e-04 S  per = 0.717  per(accum) = 3.28
 T(local opt: hintermediate init          ) = 5.811e-05 S  per = 0.0454  per(accum) = 3.32
 T(local opt: preprocess_hformulae_Hxlist ) = 4.377e-02 S  per = 34.2  per(accum) = 37.5
 T(local opt: hmmtasks init               ) = 1.834e-02 S  per = 14.3  per(accum) = 51.8
 T(local opt: initial guess for dvdson    ) = 1.139e-03 S  per = 0.889  per(accum) = 52.7
 T(local opt: dvdson solver [Hx_batchGPU] ) = 9.283e-03 S  per = 7.25  per(accum) = 59.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.562e-04 S  per = 0.122  per(accum) = 60.1
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.041e-06 S  per = 0.000813  per(accum) = 60.1
 T(local opt: dvdson solver [rest part]   ) = 5.118e-02 S  per = 39.9  per(accum) = 100
Detailed decomposition of T(renrm) = 2.355e-02 S  T(sum) = 2.355e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 4.663e-04 S  per = 1.98  per(accum) = 1.98
 T(local opt: qops init                    ) = 1.216e-03 S  per = 5.16  per(accum) = 7.14
 T(local opt: symbolic_formulae_renorm     ) = 6.452e-04 S  per = 2.74  per(accum) = 9.88
 T(local opt: allocate qops on gpu         ) = 2.884e-05 S  per = 0.122  per(accum) = 10
 T(local opt: site memcpy cpu2gpu          ) = 2.263e-05 S  per = 0.0961  per(accum) = 10.1
 T(local opt: rintermediate init           ) = 7.106e-05 S  per = 0.302  per(accum) = 10.4
 T(local opt: preprocess_formulae_Rlist2   ) = 1.338e-02 S  per = 56.8  per(accum) = 67.2
 T(local opt: rmmtasks init                ) = 5.859e-03 S  per = 24.9  per(accum) = 92.1
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 0.000149  per(accum) = 92.1
 T(local opt: preprocess_renorm_batchGPU   ) = 1.521e-03 S  per = 6.46  per(accum) = 98.5
 T(local opt: reduction of opS & opH [nccl]) = 1.184e-06 S  per = 0.00503  per(accum) = 98.5
 T(local opt: qops memcpy gpu2cpu          ) = 2.147e-05 S  per = 0.0912  per(accum) = 98.6
 T(local opt: deallocate cpu and gpu memory) = 1.208e-05 S  per = 0.0513  per(accum) = 98.7
 T(local opt: reduction of opS & opH [comm]) = 8.845e-05 S  per = 0.376  per(accum) = 99.1
 T(local opt: conversion from opAB to opPQ ) = 4.131e-06 S  per = 0.0175  per(accum) = 99.1
 T(local opt: after oper_renorm            ) = 2.174e-04 S  per = 0.923  per(accum) = 100
##### sweep opt: 7.136e-01 S #####
 T(sweep opt: fetch) = 4.533e-03 S  per = 0.635  per(accum) = 0.635
 T(sweep opt: hdiag) = 8.451e-03 S  per = 1.18  per(accum) = 1.82
 T(sweep opt: dvdsn) = 4.997e-01 S  per =   70  per(accum) = 71.8
 T(sweep opt: decim) = 2.910e-02 S  per = 4.08  per(accum) = 75.9
 T(sweep opt: guess) = 4.762e-03 S  per = 0.667  per(accum) = 76.6
 T(sweep opt: renrm) = 1.583e-01 S  per = 22.2  per(accum) = 98.8
 T(sweep opt: save ) = 8.764e-03 S  per = 1.23  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.997e-01 S  T(sum) = 4.983e-01 S  per = 9.972e+01
 T(sweep opt: preprocess                  ) = 1.526e-02 S  per = 3.06  per(accum) = 3.06
 T(sweep opt: symbolic_formulae           ) = 3.415e-03 S  per = 0.685  per(accum) = 3.75
 T(sweep opt: hintermediate init          ) = 2.010e-04 S  per = 0.0403  per(accum) = 3.79
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.705e-01 S  per = 54.3  per(accum) = 58.1
 T(sweep opt: hmmtasks init               ) = 1.255e-01 S  per = 25.2  per(accum) = 83.3
 T(sweep opt: initial guess for dvdson    ) = 5.207e-03 S  per = 1.05  per(accum) = 84.3
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.791e-02 S  per = 3.59  per(accum) = 87.9
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.258e-04 S  per = 0.0453  per(accum) = 88
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.487e-06 S  per = 0.000298  per(accum) = 88
 T(sweep opt: dvdson solver [rest part]   ) = 6.001e-02 S  per =   12  per(accum) = 100
Detailed decomposition of T(renrm) = 1.583e-01 S  T(sum) = 1.583e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.407e-03 S  per = 1.52  per(accum) = 1.52
 T(sweep opt: qops init                    ) = 3.824e-03 S  per = 2.42  per(accum) = 3.94
 T(sweep opt: symbolic_formulae_renorm     ) = 2.115e-03 S  per = 1.34  per(accum) = 5.27
 T(sweep opt: allocate qops on gpu         ) = 9.945e-05 S  per = 0.0628  per(accum) = 5.33
 T(sweep opt: site memcpy cpu2gpu          ) = 6.530e-05 S  per = 0.0412  per(accum) = 5.38
 T(sweep opt: rintermediate init           ) = 3.342e-04 S  per = 0.211  per(accum) = 5.59
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.607e-02 S  per = 22.8  per(accum) = 28.4
 T(sweep opt: rmmtasks init                ) = 1.527e-02 S  per = 9.64  per(accum) = 38
 T(sweep opt: qops memset on cpu           ) = 9.500e-08 S  per = 6e-05  per(accum) = 38
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.055e-03 S  per = 3.19  per(accum) = 41.2
 T(sweep opt: reduction of opS & opH [nccl]) = 3.603e-06 S  per = 0.00228  per(accum) = 41.2
 T(sweep opt: qops memcpy gpu2cpu          ) = 6.172e-05 S  per = 0.039  per(accum) = 41.2
 T(sweep opt: deallocate cpu and gpu memory) = 3.209e-05 S  per = 0.0203  per(accum) = 41.3
 T(sweep opt: reduction of opS & opH [comm]) = 2.336e-04 S  per = 0.148  per(accum) = 41.4
 T(sweep opt: conversion from opAB to opPQ ) = 9.197e-02 S  per = 58.1  per(accum) = 99.5
 T(sweep opt: after oper_renorm            ) = 7.878e-04 S  per = 0.498  per(accum) = 100
##### global opt: 7.136e-01 S #####
 T(global opt: fetch) = 4.533e-03 S  per = 0.635  per(accum) = 0.635
 T(global opt: hdiag) = 8.451e-03 S  per = 1.18  per(accum) = 1.82
 T(global opt: dvdsn) = 4.997e-01 S  per =   70  per(accum) = 71.8
 T(global opt: decim) = 2.910e-02 S  per = 4.08  per(accum) = 75.9
 T(global opt: guess) = 4.762e-03 S  per = 0.667  per(accum) = 76.6
 T(global opt: renrm) = 1.583e-01 S  per = 22.2  per(accum) = 98.8
 T(global opt: save ) = 8.764e-03 S  per = 1.23  per(accum) = 100
Detailed decomposition of T(dvdsn) = 4.997e-01 S  T(sum) = 4.983e-01 S  per = 9.972e+01
 T(global opt: preprocess                  ) = 1.526e-02 S  per = 3.06  per(accum) = 3.06
 T(global opt: symbolic_formulae           ) = 3.415e-03 S  per = 0.685  per(accum) = 3.75
 T(global opt: hintermediate init          ) = 2.010e-04 S  per = 0.0403  per(accum) = 3.79
 T(global opt: preprocess_hformulae_Hxlist ) = 2.705e-01 S  per = 54.3  per(accum) = 58.1
 T(global opt: hmmtasks init               ) = 1.255e-01 S  per = 25.2  per(accum) = 83.3
 T(global opt: initial guess for dvdson    ) = 5.207e-03 S  per = 1.05  per(accum) = 84.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.791e-02 S  per = 3.59  per(accum) = 87.9
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.258e-04 S  per = 0.0453  per(accum) = 88
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.487e-06 S  per = 0.000298  per(accum) = 88
 T(global opt: dvdson solver [rest part]   ) = 6.001e-02 S  per =   12  per(accum) = 100
Detailed decomposition of T(renrm) = 1.583e-01 S  T(sum) = 1.583e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.407e-03 S  per = 1.52  per(accum) = 1.52
 T(global opt: qops init                    ) = 3.824e-03 S  per = 2.42  per(accum) = 3.94
 T(global opt: symbolic_formulae_renorm     ) = 2.115e-03 S  per = 1.34  per(accum) = 5.27
 T(global opt: allocate qops on gpu         ) = 9.945e-05 S  per = 0.0628  per(accum) = 5.33
 T(global opt: site memcpy cpu2gpu          ) = 6.530e-05 S  per = 0.0412  per(accum) = 5.38
 T(global opt: rintermediate init           ) = 3.342e-04 S  per = 0.211  per(accum) = 5.59
 T(global opt: preprocess_formulae_Rlist2   ) = 3.607e-02 S  per = 22.8  per(accum) = 28.4
 T(global opt: rmmtasks init                ) = 1.527e-02 S  per = 9.64  per(accum) = 38
 T(global opt: qops memset on cpu           ) = 9.500e-08 S  per = 6e-05  per(accum) = 38
 T(global opt: preprocess_renorm_batchGPU   ) = 5.055e-03 S  per = 3.19  per(accum) = 41.2
 T(global opt: reduction of opS & opH [nccl]) = 3.603e-06 S  per = 0.00228  per(accum) = 41.2
 T(global opt: qops memcpy gpu2cpu          ) = 6.172e-05 S  per = 0.039  per(accum) = 41.2
 T(global opt: deallocate cpu and gpu memory) = 3.209e-05 S  per = 0.0203  per(accum) = 41.3
 T(global opt: reduction of opS & opH [comm]) = 2.336e-04 S  per = 0.148  per(accum) = 41.4
 T(global opt: conversion from opAB to opPQ ) = 9.197e-02 S  per = 58.1  per(accum) = 99.5
 T(global opt: after oper_renorm            ) = 7.878e-04 S  per = 0.498  per(accum) = 100

isweep=0 ibond=3/seqsize=6 dots=2 dbond=(3,0)-(4,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.941e+01GB RSS:1.838e+00GB  Timing: User:6.995e+01S Sys:1.383e+00S Total:7.133e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=20:1.526e-04MB:1.490e-07GB
total mem of comb=181:1.381e-03MB:1.349e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=3,1,1,1
 suppl= 0 1 2
 suppr= 5
 suppc1= 3
 suppc2= 4
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(3,0)
 fqop[3]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:3 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=10,10 size(op)=21:1.602e-04MB size(tot)=458:3.494e-03MB:3.412e-06GB
 rqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 c1qops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 c2qops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 qops(tot)=743:5.669e-03MB:5.536e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(4,0) fdel=./scratch/sweep/lop(3,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
wf4(diml,dimr,dimc1,dimc2)=(10,3,3,3) nnz=57:4.349e-04MB
qtensor4: wf4 own=1 _data=0x4e6f4930
qinfo4su2: wf4 sym=(6,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (3,1):3 (2,0):2 (4,0):2 (2,2):1 (5,1):1 (4,2):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=29 nblocks=220 size=57:4.349e-04MB
### DIAG TIMING: total=1.349e-03 t1=2.051e-05, t2=2.139e-04, t3=1.090e-04, t4=9.822e-04, t5=4.881e-06, t6=1.306e-05, t7=5.370e-06
duration_diagGPU:1.363e-03
duration_diagreduce:4.300e-08
duration_diagtransform:5.440e-07
----- TIMING FOR symbolic_formulae_twodot with size=102 : 1.103e-03 S -----
rank=0 GPUmem(GB): used=7.63e-06 (oper)=5.54e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=102
 no. of hintermediate operators=22
 no. of coefficients=66:0.000504MB:4.92e-07GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.069e-05 S -----
rank=0 GPUmem(GB): used=8.12e-06 (oper,hinter)=5.54e-06,4.92e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0516 S size(H_formulae)=102 size(Hxlst2)=29 T(Hmu/Hxlist)=0.000272,0.0513 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0518 S size(H_formulae)=102 size(Hxlst)=3138 -----
rank=0 GPUmem(GB): used=0.000313 (oper,hinter,dvdson,batch)=5.54e-06,4.92e-07,8.49e-07,0.000304 blksize=3 blksize0=6 batchsize=3138
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=57 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.22e-05,9.33e-05,0.00066,0.000158,0.000942
 ndim=57:4.25e-07GB t[comm(intra)]=2.22e-05 speed=0.0382GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.3e-05 t_gemm=6.6e-04 t_reduction=1.6e-04 tot=9.1e-04 ---
 sigma[inter] counter=10 t=9.3e-05 per=1.0e+01 cost=1.5e+04 flops=1.6e+08
 sigma[gemm] counter=10 i=0 t=7.8e-05 per=8.5e+00 cost=4.0e+03 flops=5.1e+07
 sigma[gemm] counter=10 i=1 t=7.5e-05 per=8.2e+00 cost=3.9e+03 flops=5.2e+07
 sigma[gemm] counter=10 i=2 t=7.2e-05 per=7.9e+00 cost=3.3e+03 flops=4.6e+07
 sigma[gemm] counter=10 i=3 t=7.4e-05 per=8.2e+00 cost=3.2e+03 flops=4.3e+07
 sigma[gemm] counter=10 i=4 t=7.4e-05 per=8.1e+00 cost=4.0e+03 flops=5.4e+07
 sigma[gemm] counter=10 i=5 t=7.2e-05 per=8.0e+00 cost=3.9e+03 flops=5.4e+07
 sigma[gemm] counter=10 i=6 t=1.1e-04 per=1.2e+01 cost=9.8e+03 flops=9.1e+07
 sigma[gemm] counter=10 i=7 t=1.1e-04 per=1.2e+01 cost=9.8e+03 flops=9.3e+07
 sigma[gemm] counter=10 total t=6.6e-04 per=7.2e+01 cost=4.2e+04 flops=6.4e+07
 sigma[red] counter=10 t=1.6e-04 per=1.7e+01 cost=1.3e+04 flops=8.2e+07
--- TIMING FOR sigma_tot : t_inter=1.7e-03 t_gemm=1.3e-02 t_reduction=2.6e-03 tot=1.7e-02 ---
 sigma_tot[inter] counter=10 t=1.7e-03 per=1.0e+01 cost=2.9e+05 flops=1.7e+08
 sigma_tot[gemm] counter=10 i=0 t=1.3e-03 per=7.8e+00 cost=8.3e+04 flops=6.2e+07
 sigma_tot[gemm] counter=10 i=1 t=1.2e-03 per=7.2e+00 cost=8.3e+04 flops=6.7e+07
 sigma_tot[gemm] counter=10 i=2 t=1.2e-03 per=6.8e+00 cost=7.6e+04 flops=6.5e+07
 sigma_tot[gemm] counter=10 i=3 t=1.2e-03 per=6.8e+00 cost=7.5e+04 flops=6.5e+07
 sigma_tot[gemm] counter=10 i=4 t=2.0e-03 per=1.2e+01 cost=2.2e+05 flops=1.1e+08
 sigma_tot[gemm] counter=10 i=5 t=2.1e-03 per=1.2e+01 cost=2.2e+05 flops=1.0e+08
 sigma_tot[gemm] counter=10 i=6 t=2.0e-03 per=1.2e+01 cost=1.9e+05 flops=9.6e+07
 sigma_tot[gemm] counter=10 i=7 t=1.9e-03 per=1.1e+01 cost=1.9e+05 flops=1.0e+08
 sigma_tot[gemm] counter=10 total t=1.3e-02 per=7.5e+01 cost=1.1e+06 flops=8.8e+07
 sigma_tot[red] counter=10 t=2.6e-03 per=1.5e+01 cost=2.9e+05 flops=1.1e+08
T(sub)=8.9e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,3.9e-06,1.9e-06,5.7e-07,1.5e-07
settings: ndim=57 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +      -3.235797901320 -1.003e+03  8.898e-05    1     1  1.078e-03 1.078e-03 1.050e-03
TIMING FOR Davidson : 1.094e-03  T(cal/comm/rest)=1.050e-03,1.280e-07,4.378e-05
decomposed t_rest=4.378e-05
 T(sub)    =8.919e-06 per=2.037e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =3.270e-07 per=7.470e-01
 T(xnrm2)  =3.870e-07 per=8.841e-01
 T(other)  =3.414e-05 per=7.799e+01
optimized energies: isweep=0 ibond=3 dots=2 e[0]=-3.235797901320 nmvp=1
CPUmem: VM:1.941e+01GB RSS:1.838e+00GB  Timing: User:7.003e+01S Sys:1.383e+00S Total:7.142e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=6 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond3.txt
 qbond: qsuper nsym=6 dimAll=10
 (0,0):1 (2,0):3 (1,1):2 (4,0):1 (3,1):2 (2,2):1
----- TMING FOR decimation_genbasis(su2): 5.2e-03 S -----
decimation summary: 10->10 dwt=+0.000e+00 SvN=6.966e-01
 qbond: qkept nsym=6 dimAll=10
 (2,0):3 (1,1):2 (3,1):2 (0,0):1 (4,0):1 (2,2):1
----- TIMING for decimation_row(nkr): 5.627e-03 S T(decim/select/formRot)=5.267e-03,2.916e-04,6.847e-05 -----
----- TIMING FOR twodot_decimation: 6.213e-03 S T(wf/decim)=4.981e-04,5.715e-03 -----
ctns::oper_renorm coord=(4,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:2 S:4 H:1 A:4 B:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
CPUmem: VM:1.941e+01GB RSS:1.838e+00GB  Timing: User:7.088e+01S Sys:1.383e+00S Total:7.226e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=17 : 3.621e-04 S -----
rank=0 GPUmem(GB): used=6.8e-06 (oper)=3.51e-06
rank=0 GPUmem(GB): used=6.95e-06 (oper,site)(GB)=3.51e-06,1.49e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=17
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=6.95e-06 (oper,site,rinter)=3.51e-06,1.49e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00411 S size(rtasks)=17 size(Rlst2)=36 T(Rmu/Rlist)=0.000109,0.004 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00415 S size(rtasks)=17 size(Rlst)=326 -----
rank=0 GPUmem(GB): used=6.95e-06 (oper,site,rinter,batch)=3.51e-06,1.49e-07,0,4.61e-05 blksize=9 blksize0=0 batchsize=326
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.51e-06,0.000367,0.000141
--- TIMING FOR renorm : t_inter=8.2e-06 t_gemm=3.7e-04 t_reduction=1.4e-04 tot=5.2e-04 ---
 renorm[inter] counter=4 t=8.2e-06 per=1.6e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=0 t=7.9e-05 per=1.5e+01 cost=3.7e+02 flops=4.6e+06
 renorm[gemm] counter=4 i=1 t=5.9e-05 per=1.1e+01 cost=6.6e+02 flops=1.1e+07
 renorm[gemm] counter=4 i=2 t=5.6e-05 per=1.1e+01 cost=4.0e+02 flops=7.2e+06
 renorm[gemm] counter=4 i=3 t=5.7e-05 per=1.1e+01 cost=6.2e+02 flops=1.1e+07
 renorm[gemm] counter=4 i=4 t=1.4e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=5 t=1.3e-06 per=2.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=6 t=1.1e-04 per=2.2e+01 cost=2.8e+03 flops=2.5e+07
 renorm[gemm] counter=4 total t=3.7e-04 per=7.1e+01 cost=4.9e+03 flops=1.3e+07
 renorm[red] counter=4 t=1.4e-04 per=2.7e+01 cost=2.8e+03 flops=2.0e+07
--- TIMING FOR renorm_tot : t_inter=2.3e-04 t_gemm=3.6e-03 t_reduction=1.4e-03 tot=5.3e-03 ---
 renorm_tot[inter] counter=4 t=2.3e-04 per=4.3e+00 cost=1.2e+04 flops=5.2e+07
 renorm_tot[gemm] counter=4 i=0 t=3.7e-04 per=7.0e+00 cost=5.3e+03 flops=1.4e+07
 renorm_tot[gemm] counter=4 i=1 t=1.3e-03 per=2.4e+01 cost=8.0e+03 flops=6.2e+06
 renorm_tot[gemm] counter=4 i=2 t=6.0e-05 per=1.1e+00 cost=4.0e+02 flops=6.7e+06
 renorm_tot[gemm] counter=4 i=3 t=6.0e-05 per=1.1e+00 cost=6.2e+02 flops=1.0e+07
 renorm_tot[gemm] counter=4 i=4 t=5.6e-04 per=1.1e+01 cost=1.1e+04 flops=2.0e+07
 renorm_tot[gemm] counter=4 i=5 t=5.5e-04 per=1.1e+01 cost=1.5e+04 flops=2.7e+07
 renorm_tot[gemm] counter=4 i=6 t=7.5e-04 per=1.4e+01 cost=3.9e+04 flops=5.2e+07
 renorm_tot[gemm] counter=4 total t=3.6e-03 per=6.9e+01 cost=7.9e+04 flops=2.2e+07
 renorm_tot[red] counter=4 t=1.4e-03 per=2.7e+01 cost=2.2e+04 flops=1.6e+07
qops.to_cpu: size(tot)=281:2.1e-03MB:2.1e-06GB t[to_cpu]=1.4e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=4.304e-16 coord=(4,0) rank=0
ctns::oper_ab2pq coord=(4,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00821 S rank=0 -----
CPUmem: VM:1.941e+01GB RSS:1.838e+00GB  Timing: User:7.169e+01S Sys:1.384e+00S Total:7.308e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=218:1.663e-03MB:1.624e-06GB
CPUmem: VM:1.941e+01GB RSS:1.838e+00GB  Timing: User:7.178e+01S Sys:1.384e+00S Total:7.316e+01S
##### local opt: 9.816e-02 S #####
 T(local opt: fetch) = 1.831e-04 S  per = 0.187  per(accum) = 0.187
 T(local opt: hdiag) = 2.007e-03 S  per = 2.04  per(accum) = 2.23
 T(local opt: dvdsn) = 7.948e-02 S  per =   81  per(accum) = 83.2
 T(local opt: decim) = 6.243e-03 S  per = 6.36  per(accum) = 89.6
 T(local opt: guess) = 1.004e-03 S  per = 1.02  per(accum) = 90.6
 T(local opt: renrm) = 8.649e-03 S  per = 8.81  per(accum) = 99.4
 T(local opt: save ) = 5.877e-04 S  per = 0.599  per(accum) = 100
Detailed decomposition of T(dvdsn) = 7.948e-02 S  T(sum) = 7.940e-02 S  per = 9.989e+01
 T(local opt: preprocess                  ) = 4.329e-03 S  per = 5.45  per(accum) = 5.45
 T(local opt: symbolic_formulae           ) = 1.116e-03 S  per = 1.41  per(accum) = 6.86
 T(local opt: hintermediate init          ) = 7.099e-05 S  per = 0.0894  per(accum) = 6.95
 T(local opt: preprocess_hformulae_Hxlist ) = 5.195e-02 S  per = 65.4  per(accum) = 72.4
 T(local opt: hmmtasks init               ) = 1.989e-02 S  per = 25.1  per(accum) = 97.4
 T(local opt: initial guess for dvdson    ) = 9.513e-04 S  per =  1.2  per(accum) = 98.6
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.028e-03 S  per = 1.29  per(accum) = 99.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.221e-05 S  per = 0.028  per(accum) = 99.9
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.280e-07 S  per = 0.000161  per(accum) = 99.9
 T(local opt: dvdson solver [rest part]   ) = 4.378e-05 S  per = 0.0551  per(accum) = 100
Detailed decomposition of T(renrm) = 8.649e-03 S  T(sum) = 8.649e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.677e-04 S  per = 1.94  per(accum) = 1.94
 T(local opt: qops init                    ) = 1.021e-03 S  per = 11.8  per(accum) = 13.7
 T(local opt: symbolic_formulae_renorm     ) = 3.708e-04 S  per = 4.29  per(accum) = 18
 T(local opt: allocate qops on gpu         ) = 2.326e-05 S  per = 0.269  per(accum) = 18.3
 T(local opt: site memcpy cpu2gpu          ) = 2.144e-05 S  per = 0.248  per(accum) = 18.6
 T(local opt: rintermediate init           ) = 1.920e-05 S  per = 0.222  per(accum) = 18.8
 T(local opt: preprocess_formulae_Rlist2   ) = 4.168e-03 S  per = 48.2  per(accum) = 67
 T(local opt: rmmtasks init                ) = 1.862e-03 S  per = 21.5  per(accum) = 88.5
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 0.000393  per(accum) = 88.5
 T(local opt: preprocess_renorm_batchGPU   ) = 6.137e-04 S  per =  7.1  per(accum) = 95.6
 T(local opt: reduction of opS & opH [nccl]) = 1.035e-06 S  per = 0.012  per(accum) = 95.6
 T(local opt: qops memcpy gpu2cpu          ) = 2.012e-05 S  per = 0.233  per(accum) = 95.8
 T(local opt: deallocate cpu and gpu memory) = 1.050e-05 S  per = 0.121  per(accum) = 96
 T(local opt: reduction of opS & opH [comm]) = 7.746e-05 S  per = 0.896  per(accum) = 96.8
 T(local opt: conversion from opAB to opPQ ) = 3.701e-06 S  per = 0.0428  per(accum) = 96.9
 T(local opt: after oper_renorm            ) = 2.690e-04 S  per = 3.11  per(accum) = 100
##### sweep opt: 8.118e-01 S #####
 T(sweep opt: fetch) = 4.716e-03 S  per = 0.581  per(accum) = 0.581
 T(sweep opt: hdiag) = 1.046e-02 S  per = 1.29  per(accum) = 1.87
 T(sweep opt: dvdsn) = 5.792e-01 S  per = 71.3  per(accum) = 73.2
 T(sweep opt: decim) = 3.535e-02 S  per = 4.35  per(accum) = 77.6
 T(sweep opt: guess) = 5.766e-03 S  per = 0.71  per(accum) = 78.3
 T(sweep opt: renrm) = 1.670e-01 S  per = 20.6  per(accum) = 98.8
 T(sweep opt: save ) = 9.352e-03 S  per = 1.15  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.792e-01 S  T(sum) = 5.777e-01 S  per = 9.975e+01
 T(sweep opt: preprocess                  ) = 1.959e-02 S  per = 3.39  per(accum) = 3.39
 T(sweep opt: symbolic_formulae           ) = 4.531e-03 S  per = 0.784  per(accum) = 4.18
 T(sweep opt: hintermediate init          ) = 2.720e-04 S  per = 0.0471  per(accum) = 4.22
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.225e-01 S  per = 55.8  per(accum) = 60
 T(sweep opt: hmmtasks init               ) = 1.454e-01 S  per = 25.2  per(accum) = 85.2
 T(sweep opt: initial guess for dvdson    ) = 6.159e-03 S  per = 1.07  per(accum) = 86.3
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.894e-02 S  per = 3.28  per(accum) = 89.6
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.480e-04 S  per = 0.0429  per(accum) = 89.6
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.615e-06 S  per = 0.00028  per(accum) = 89.6
 T(sweep opt: dvdson solver [rest part]   ) = 6.005e-02 S  per = 10.4  per(accum) = 100
Detailed decomposition of T(renrm) = 1.670e-01 S  T(sum) = 1.670e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.574e-03 S  per = 1.54  per(accum) = 1.54
 T(sweep opt: qops init                    ) = 4.846e-03 S  per =  2.9  per(accum) = 4.44
 T(sweep opt: symbolic_formulae_renorm     ) = 2.486e-03 S  per = 1.49  per(accum) = 5.93
 T(sweep opt: allocate qops on gpu         ) = 1.227e-04 S  per = 0.0735  per(accum) = 6.01
 T(sweep opt: site memcpy cpu2gpu          ) = 8.673e-05 S  per = 0.0519  per(accum) = 6.06
 T(sweep opt: rintermediate init           ) = 3.534e-04 S  per = 0.212  per(accum) = 6.27
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.024e-02 S  per = 24.1  per(accum) = 30.4
 T(sweep opt: rmmtasks init                ) = 1.713e-02 S  per = 10.3  per(accum) = 40.6
 T(sweep opt: qops memset on cpu           ) = 1.290e-07 S  per = 7.73e-05  per(accum) = 40.6
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.669e-03 S  per = 3.39  per(accum) = 44
 T(sweep opt: reduction of opS & opH [nccl]) = 4.638e-06 S  per = 0.00278  per(accum) = 44
 T(sweep opt: qops memcpy gpu2cpu          ) = 8.184e-05 S  per = 0.049  per(accum) = 44.1
 T(sweep opt: deallocate cpu and gpu memory) = 4.258e-05 S  per = 0.0255  per(accum) = 44.1
 T(sweep opt: reduction of opS & opH [comm]) = 3.110e-04 S  per = 0.186  per(accum) = 44.3
 T(sweep opt: conversion from opAB to opPQ ) = 9.197e-02 S  per = 55.1  per(accum) = 99.4
 T(sweep opt: after oper_renorm            ) = 1.057e-03 S  per = 0.633  per(accum) = 100
##### global opt: 8.118e-01 S #####
 T(global opt: fetch) = 4.716e-03 S  per = 0.581  per(accum) = 0.581
 T(global opt: hdiag) = 1.046e-02 S  per = 1.29  per(accum) = 1.87
 T(global opt: dvdsn) = 5.792e-01 S  per = 71.3  per(accum) = 73.2
 T(global opt: decim) = 3.535e-02 S  per = 4.35  per(accum) = 77.6
 T(global opt: guess) = 5.766e-03 S  per = 0.71  per(accum) = 78.3
 T(global opt: renrm) = 1.670e-01 S  per = 20.6  per(accum) = 98.8
 T(global opt: save ) = 9.352e-03 S  per = 1.15  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.792e-01 S  T(sum) = 5.777e-01 S  per = 9.975e+01
 T(global opt: preprocess                  ) = 1.959e-02 S  per = 3.39  per(accum) = 3.39
 T(global opt: symbolic_formulae           ) = 4.531e-03 S  per = 0.784  per(accum) = 4.18
 T(global opt: hintermediate init          ) = 2.720e-04 S  per = 0.0471  per(accum) = 4.22
 T(global opt: preprocess_hformulae_Hxlist ) = 3.225e-01 S  per = 55.8  per(accum) = 60
 T(global opt: hmmtasks init               ) = 1.454e-01 S  per = 25.2  per(accum) = 85.2
 T(global opt: initial guess for dvdson    ) = 6.159e-03 S  per = 1.07  per(accum) = 86.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 1.894e-02 S  per = 3.28  per(accum) = 89.6
 T(global opt: dvdson solver [comm(gpu)]   ) = 2.480e-04 S  per = 0.0429  per(accum) = 89.6
 T(global opt: dvdson solver [comm(cpu)]   ) = 1.615e-06 S  per = 0.00028  per(accum) = 89.6
 T(global opt: dvdson solver [rest part]   ) = 6.005e-02 S  per = 10.4  per(accum) = 100
Detailed decomposition of T(renrm) = 1.670e-01 S  T(sum) = 1.670e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.574e-03 S  per = 1.54  per(accum) = 1.54
 T(global opt: qops init                    ) = 4.846e-03 S  per =  2.9  per(accum) = 4.44
 T(global opt: symbolic_formulae_renorm     ) = 2.486e-03 S  per = 1.49  per(accum) = 5.93
 T(global opt: allocate qops on gpu         ) = 1.227e-04 S  per = 0.0735  per(accum) = 6.01
 T(global opt: site memcpy cpu2gpu          ) = 8.673e-05 S  per = 0.0519  per(accum) = 6.06
 T(global opt: rintermediate init           ) = 3.534e-04 S  per = 0.212  per(accum) = 6.27
 T(global opt: preprocess_formulae_Rlist2   ) = 4.024e-02 S  per = 24.1  per(accum) = 30.4
 T(global opt: rmmtasks init                ) = 1.713e-02 S  per = 10.3  per(accum) = 40.6
 T(global opt: qops memset on cpu           ) = 1.290e-07 S  per = 7.73e-05  per(accum) = 40.6
 T(global opt: preprocess_renorm_batchGPU   ) = 5.669e-03 S  per = 3.39  per(accum) = 44
 T(global opt: reduction of opS & opH [nccl]) = 4.638e-06 S  per = 0.00278  per(accum) = 44
 T(global opt: qops memcpy gpu2cpu          ) = 8.184e-05 S  per = 0.049  per(accum) = 44.1
 T(global opt: deallocate cpu and gpu memory) = 4.258e-05 S  per = 0.0255  per(accum) = 44.1
 T(global opt: reduction of opS & opH [comm]) = 3.110e-04 S  per = 0.186  per(accum) = 44.3
 T(global opt: conversion from opAB to opPQ ) = 9.197e-02 S  per = 55.1  per(accum) = 99.4
 T(global opt: after oper_renorm            ) = 1.057e-03 S  per = 0.633  per(accum) = 100

isweep=0 ibond=4/seqsize=6 dots=2 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.947e+01GB RSS:1.838e+00GB  Timing: User:7.187e+01S Sys:1.384e+00S Total:7.326e+01S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=218:1.663e-03MB:1.624e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=2,2,1,1
 suppl= 0 1
 suppr= 4 5
 suppc1= 2
 suppc2= 3
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(2,0)
 fqop[3]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:2 S:4 H:1 P:16 Q:20 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=626:4.776e-03MB:4.664e-06GB
 rqops: oplist=CSHAB nops=C:2 S:4 H:1 A:4 B:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 c2qops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 qops(tot)=1097:8.369e-03MB:8.173e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
wf4(diml,dimr,dimc1,dimc2)=(10,10,3,3) nnz=175:1.335e-03MB
qtensor4: wf4 own=1 _data=0x4d7136a0
qinfo4su2: wf4 sym=(6,0) couple=0
 qbond: qrow nsym=6 dimAll=10
 (2,0):3 (1,1):2 (3,1):2 (0,0):1 (4,0):1 (2,2):1
 qbond: qcol nsym=6 dimAll=10
 (2,0):3 (1,1):2 (3,1):2 (0,0):1 (4,0):1 (2,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=53 nblocks=441 size=175:1.335e-03MB
### DIAG TIMING: total=3.531e-03 t1=1.115e-05, t2=3.578e-04, t3=1.717e-04, t4=2.970e-03, t5=3.861e-06, t6=1.268e-05, t7=3.572e-06
duration_diagGPU:3.544e-03
duration_diagreduce:4.100e-08
duration_diagtransform:8.460e-07
----- TIMING FOR symbolic_formulae_twodot with size=176 : 2.020e-03 S -----
rank=0 GPUmem(GB): used=8.17e-06 (oper)=8.17e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=176
 no. of hintermediate operators=51
 no. of coefficients=102:0.000778MB:7.6e-07GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 7.259e-05 S -----
rank=0 GPUmem(GB): used=8.93e-06 (oper,hinter)=8.17e-06,7.6e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.165 S size(H_formulae)=176 size(Hxlst2)=53 T(Hmu/Hxlist)=0.000715,0.164 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.166 S size(H_formulae)=176 size(Hxlst)=11816 -----
rank=0 GPUmem(GB): used=0.00221 (oper,hinter,dvdson,batch)=8.17e-06,7.6e-07,2.61e-06,0.0022 blksize=9 blksize0=6 batchsize=11816
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=175 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.28e-05,0.00016,0.00172,0.000225,0.00214
 ndim=175:1.3e-06GB t[comm(intra)]=2.28e-05 speed=0.114GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.6e-04 t_gemm=1.7e-03 t_reduction=2.3e-04 tot=2.1e-03 ---
 sigma[inter] counter=11 t=1.6e-04 per=7.6e+00 cost=4.7e+04 flops=3.0e+08
 sigma[gemm] counter=11 i=0 t=1.5e-04 per=7.3e+00 cost=2.3e+04 flops=1.5e+08
 sigma[gemm] counter=11 i=1 t=1.4e-04 per=6.8e+00 cost=2.3e+04 flops=1.6e+08
 sigma[gemm] counter=11 i=2 t=1.4e-04 per=6.6e+00 cost=2.1e+04 flops=1.5e+08
 sigma[gemm] counter=11 i=3 t=1.4e-04 per=6.7e+00 cost=2.1e+04 flops=1.5e+08
 sigma[gemm] counter=11 i=4 t=2.9e-04 per=1.4e+01 cost=6.4e+04 flops=2.2e+08
 sigma[gemm] counter=11 i=5 t=3.0e-04 per=1.4e+01 cost=6.4e+04 flops=2.2e+08
 sigma[gemm] counter=11 i=6 t=2.8e-04 per=1.3e+01 cost=5.7e+04 flops=2.0e+08
 sigma[gemm] counter=11 i=7 t=2.7e-04 per=1.3e+01 cost=5.7e+04 flops=2.1e+08
 sigma[gemm] counter=11 total t=1.7e-03 per=8.2e+01 cost=3.3e+05 flops=1.9e+08
 sigma[red] counter=11 t=2.3e-04 per=1.1e+01 cost=8.2e+04 flops=3.7e+08
--- TIMING FOR sigma_tot : t_inter=1.9e-03 t_gemm=1.5e-02 t_reduction=2.8e-03 tot=1.9e-02 ---
 sigma_tot[inter] counter=11 t=1.9e-03 per=9.8e+00 cost=3.4e+05 flops=1.8e+08
 sigma_tot[gemm] counter=11 i=0 t=1.5e-03 per=7.8e+00 cost=1.1e+05 flops=7.1e+07
 sigma_tot[gemm] counter=11 i=1 t=1.4e-03 per=7.1e+00 cost=1.1e+05 flops=7.7e+07
 sigma_tot[gemm] counter=11 i=2 t=1.3e-03 per=6.8e+00 cost=9.7e+04 flops=7.4e+07
 sigma_tot[gemm] counter=11 i=3 t=1.3e-03 per=6.7e+00 cost=9.6e+04 flops=7.4e+07
 sigma_tot[gemm] counter=11 i=4 t=2.3e-03 per=1.2e+01 cost=2.8e+05 flops=1.2e+08
 sigma_tot[gemm] counter=11 i=5 t=2.4e-03 per=1.2e+01 cost=2.8e+05 flops=1.2e+08
 sigma_tot[gemm] counter=11 i=6 t=2.3e-03 per=1.2e+01 cost=2.5e+05 flops=1.1e+08
 sigma_tot[gemm] counter=11 i=7 t=2.2e-03 per=1.1e+01 cost=2.5e+05 flops=1.1e+08
 sigma_tot[gemm] counter=11 total t=1.5e-02 per=7.6e+01 cost=1.5e+06 flops=1.0e+08
 sigma_tot[red] counter=11 t=2.8e-03 per=1.4e+01 cost=3.7e+05 flops=1.3e+08
T(sub)=1.2e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,4.2e-06,1.9e-06,6.8e-07,1.8e-07
settings: ndim=175 neig=1 maxcycle=30 nbuff=4 memory=2e-05GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.235797901320 -1.003e+03  2.352e-02    1     1  2.293e-03 2.293e-03 2.258e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.339e-05,2.214e-04,2.329e-03,2.729e-04,2.856e-03
 ndim=175:1.304e-06GB t[comm(intra)]=2.339e-05 speed=1.115e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=2.3e-03 t_reduction=2.7e-04 tot=2.8e-03 ---
 sigma[inter] counter=12 t=2.2e-04 per=7.8e+00 cost=4.7e+04 flops=2.1e+08
 sigma[gemm] counter=12 i=0 t=2.1e-04 per=7.5e+00 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=12 i=1 t=2.5e-04 per=9.0e+00 cost=2.3e+04 flops=9.2e+07
 sigma[gemm] counter=12 i=2 t=1.7e-04 per=6.1e+00 cost=2.1e+04 flops=1.2e+08
 sigma[gemm] counter=12 i=3 t=1.7e-04 per=6.2e+00 cost=2.1e+04 flops=1.2e+08
 sigma[gemm] counter=12 i=4 t=3.8e-04 per=1.4e+01 cost=6.4e+04 flops=1.7e+08
 sigma[gemm] counter=12 i=5 t=4.0e-04 per=1.4e+01 cost=6.4e+04 flops=1.6e+08
 sigma[gemm] counter=12 i=6 t=3.6e-04 per=1.3e+01 cost=5.7e+04 flops=1.6e+08
 sigma[gemm] counter=12 i=7 t=3.8e-04 per=1.3e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=12 total t=2.3e-03 per=8.2e+01 cost=3.3e+05 flops=1.4e+08
 sigma[red] counter=12 t=2.7e-04 per=9.7e+00 cost=8.2e+04 flops=3.0e+08
--- TIMING FOR sigma_tot : t_inter=2.1e-03 t_gemm=1.7e-02 t_reduction=3.1e-03 tot=2.2e-02 ---
 sigma_tot[inter] counter=12 t=2.1e-03 per=9.5e+00 cost=3.8e+05 flops=1.8e+08
 sigma_tot[gemm] counter=12 i=0 t=1.7e-03 per=7.8e+00 cost=1.3e+05 flops=7.6e+07
 sigma_tot[gemm] counter=12 i=1 t=1.6e-03 per=7.4e+00 cost=1.3e+05 flops=8.0e+07
 sigma_tot[gemm] counter=12 i=2 t=1.5e-03 per=6.7e+00 cost=1.2e+05 flops=8.0e+07
 sigma_tot[gemm] counter=12 i=3 t=1.5e-03 per=6.7e+00 cost=1.2e+05 flops=8.0e+07
 sigma_tot[gemm] counter=12 i=4 t=2.7e-03 per=1.2e+01 cost=3.5e+05 flops=1.3e+08
 sigma_tot[gemm] counter=12 i=5 t=2.8e-03 per=1.3e+01 cost=3.4e+05 flops=1.2e+08
 sigma_tot[gemm] counter=12 i=6 t=2.6e-03 per=1.2e+01 cost=3.1e+05 flops=1.2e+08
 sigma_tot[gemm] counter=12 i=7 t=2.5e-03 per=1.2e+01 cost=3.1e+05 flops=1.2e+08
 sigma_tot[gemm] counter=12 total t=1.7e-02 per=7.7e+01 cost=1.8e+06 flops=1.1e+08
 sigma_tot[red] counter=12 t=3.1e-03 per=1.4e+01 cost=4.5e+05 flops=1.5e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.3e-05,4.3e-06,1.4e-06,2.8e-07
    2   0 -      -3.236039870221 -2.420e-04  6.631e-03    2     2  1.055e-02 5.273e-03 2.645e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.220e-05,2.104e-04,2.316e-03,2.748e-04,2.830e-03
 ndim=175:1.304e-06GB t[comm(intra)]=2.220e-05 speed=1.175e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=2.3e-03 t_reduction=2.7e-04 tot=2.8e-03 ---
 sigma[inter] counter=13 t=2.1e-04 per=7.5e+00 cost=4.7e+04 flops=2.3e+08
 sigma[gemm] counter=13 i=0 t=2.1e-04 per=7.6e+00 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=13 i=1 t=2.1e-04 per=7.4e+00 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=13 i=2 t=1.9e-04 per=6.8e+00 cost=2.1e+04 flops=1.1e+08
 sigma[gemm] counter=13 i=3 t=2.0e-04 per=7.2e+00 cost=2.1e+04 flops=1.0e+08
 sigma[gemm] counter=13 i=4 t=3.8e-04 per=1.4e+01 cost=6.4e+04 flops=1.7e+08
 sigma[gemm] counter=13 i=5 t=3.9e-04 per=1.4e+01 cost=6.4e+04 flops=1.7e+08
 sigma[gemm] counter=13 i=6 t=3.8e-04 per=1.3e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=13 i=7 t=3.6e-04 per=1.3e+01 cost=5.7e+04 flops=1.6e+08
 sigma[gemm] counter=13 total t=2.3e-03 per=8.3e+01 cost=3.3e+05 flops=1.4e+08
 sigma[red] counter=13 t=2.7e-04 per=9.8e+00 cost=8.2e+04 flops=3.0e+08
--- TIMING FOR sigma_tot : t_inter=2.3e-03 t_gemm=1.9e-02 t_reduction=3.3e-03 tot=2.5e-02 ---
 sigma_tot[inter] counter=13 t=2.3e-03 per=9.3e+00 cost=4.3e+05 flops=1.9e+08
 sigma_tot[gemm] counter=13 i=0 t=1.9e-03 per=7.7e+00 cost=1.5e+05 flops=8.0e+07
 sigma_tot[gemm] counter=13 i=1 t=1.8e-03 per=7.4e+00 cost=1.5e+05 flops=8.4e+07
 sigma_tot[gemm] counter=13 i=2 t=1.7e-03 per=6.7e+00 cost=1.4e+05 flops=8.3e+07
 sigma_tot[gemm] counter=13 i=3 t=1.7e-03 per=6.7e+00 cost=1.4e+05 flops=8.3e+07
 sigma_tot[gemm] counter=13 i=4 t=3.0e-03 per=1.2e+01 cost=4.1e+05 flops=1.3e+08
 sigma_tot[gemm] counter=13 i=5 t=3.1e-03 per=1.3e+01 cost=4.1e+05 flops=1.3e+08
 sigma_tot[gemm] counter=13 i=6 t=3.0e-03 per=1.2e+01 cost=3.6e+05 flops=1.2e+08
 sigma_tot[gemm] counter=13 i=7 t=2.9e-03 per=1.2e+01 cost=3.6e+05 flops=1.2e+08
 sigma_tot[gemm] counter=13 total t=1.9e-02 per=7.7e+01 cost=2.1e+06 flops=1.1e+08
 sigma_tot[red] counter=13 t=3.3e-03 per=1.3e+01 cost=5.4e+05 flops=1.6e+08
T(sub)=2.8e-05 T(gemm/eig/ortho/gemm/axpy)=5.5e-06,1.7e-05,3.5e-06,1.7e-06,2.8e-07
    3   0 -      -3.236060193243 -2.032e-05  2.950e-03    3     3  1.511e-02 5.038e-03 2.774e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.385e-05,2.230e-04,2.348e-03,2.897e-04,2.891e-03
 ndim=175:1.304e-06GB t[comm(intra)]=2.385e-05 speed=1.093e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=2.3e-03 t_reduction=2.9e-04 tot=2.9e-03 ---
 sigma[inter] counter=14 t=2.2e-04 per=7.8e+00 cost=4.7e+04 flops=2.1e+08
 sigma[gemm] counter=14 i=0 t=2.4e-04 per=8.2e+00 cost=2.3e+04 flops=9.9e+07
 sigma[gemm] counter=14 i=1 t=2.4e-04 per=8.3e+00 cost=2.3e+04 flops=9.9e+07
 sigma[gemm] counter=14 i=2 t=2.0e-04 per=7.0e+00 cost=2.1e+04 flops=1.1e+08
 sigma[gemm] counter=14 i=3 t=1.7e-04 per=6.1e+00 cost=2.1e+04 flops=1.2e+08
 sigma[gemm] counter=14 i=4 t=3.8e-04 per=1.3e+01 cost=6.4e+04 flops=1.7e+08
 sigma[gemm] counter=14 i=5 t=4.0e-04 per=1.4e+01 cost=6.4e+04 flops=1.6e+08
 sigma[gemm] counter=14 i=6 t=3.6e-04 per=1.3e+01 cost=5.7e+04 flops=1.6e+08
 sigma[gemm] counter=14 i=7 t=3.6e-04 per=1.3e+01 cost=5.7e+04 flops=1.6e+08
 sigma[gemm] counter=14 total t=2.3e-03 per=8.2e+01 cost=3.3e+05 flops=1.4e+08
 sigma[red] counter=14 t=2.9e-04 per=1.0e+01 cost=8.2e+04 flops=2.8e+08
--- TIMING FOR sigma_tot : t_inter=2.5e-03 t_gemm=2.2e-02 t_reduction=3.6e-03 tot=2.8e-02 ---
 sigma_tot[inter] counter=14 t=2.5e-03 per=9.1e+00 cost=4.8e+05 flops=1.9e+08
 sigma_tot[gemm] counter=14 i=0 t=2.2e-03 per=7.8e+00 cost=1.8e+05 flops=8.2e+07
 sigma_tot[gemm] counter=14 i=1 t=2.1e-03 per=7.5e+00 cost=1.8e+05 flops=8.5e+07
 sigma_tot[gemm] counter=14 i=2 t=1.9e-03 per=6.8e+00 cost=1.6e+05 flops=8.6e+07
 sigma_tot[gemm] counter=14 i=3 t=1.8e-03 per=6.7e+00 cost=1.6e+05 flops=8.6e+07
 sigma_tot[gemm] counter=14 i=4 t=3.4e-03 per=1.2e+01 cost=4.7e+05 flops=1.4e+08
 sigma_tot[gemm] counter=14 i=5 t=3.6e-03 per=1.3e+01 cost=4.7e+05 flops=1.3e+08
 sigma_tot[gemm] counter=14 i=6 t=3.4e-03 per=1.2e+01 cost=4.2e+05 flops=1.2e+08
 sigma_tot[gemm] counter=14 i=7 t=3.3e-03 per=1.2e+01 cost=4.2e+05 flops=1.3e+08
 sigma_tot[gemm] counter=14 total t=2.2e-02 per=7.8e+01 cost=2.5e+06 flops=1.1e+08
 sigma_tot[red] counter=14 t=3.6e-03 per=1.3e+01 cost=6.2e+05 flops=1.7e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.6e-05,3.6e-06,1.6e-06,2.5e-07
    4   0 -      -3.236064488706 -4.295e-06  1.427e-03    3     4  1.828e-02 4.571e-03 2.847e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.247e-05,2.221e-04,2.649e-03,2.733e-04,3.175e-03
 ndim=175:1.304e-06GB t[comm(intra)]=2.247e-05 speed=1.160e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=2.6e-03 t_reduction=2.7e-04 tot=3.1e-03 ---
 sigma[inter] counter=15 t=2.2e-04 per=7.1e+00 cost=4.7e+04 flops=2.1e+08
 sigma[gemm] counter=15 i=0 t=2.4e-04 per=7.6e+00 cost=2.3e+04 flops=9.8e+07
 sigma[gemm] counter=15 i=1 t=2.7e-04 per=8.6e+00 cost=2.3e+04 flops=8.6e+07
 sigma[gemm] counter=15 i=2 t=2.2e-04 per=7.0e+00 cost=2.1e+04 flops=9.7e+07
 sigma[gemm] counter=15 i=3 t=2.2e-04 per=6.9e+00 cost=2.1e+04 flops=9.8e+07
 sigma[gemm] counter=15 i=4 t=5.1e-04 per=1.6e+01 cost=6.4e+04 flops=1.3e+08
 sigma[gemm] counter=15 i=5 t=4.6e-04 per=1.5e+01 cost=6.4e+04 flops=1.4e+08
 sigma[gemm] counter=15 i=6 t=3.6e-04 per=1.1e+01 cost=5.7e+04 flops=1.6e+08
 sigma[gemm] counter=15 i=7 t=3.8e-04 per=1.2e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=15 total t=2.6e-03 per=8.4e+01 cost=3.3e+05 flops=1.3e+08
 sigma[red] counter=15 t=2.7e-04 per=8.7e+00 cost=8.2e+04 flops=3.0e+08
--- TIMING FOR sigma_tot : t_inter=2.7e-03 t_gemm=2.4e-02 t_reduction=3.9e-03 tot=3.1e-02 ---
 sigma_tot[inter] counter=15 t=2.7e-03 per=8.9e+00 cost=5.3e+05 flops=1.9e+08
 sigma_tot[gemm] counter=15 i=0 t=2.4e-03 per=7.8e+00 cost=2.0e+05 flops=8.4e+07
 sigma_tot[gemm] counter=15 i=1 t=2.3e-03 per=7.6e+00 cost=2.0e+05 flops=8.5e+07
 sigma_tot[gemm] counter=15 i=2 t=2.1e-03 per=6.8e+00 cost=1.8e+05 flops=8.7e+07
 sigma_tot[gemm] counter=15 i=3 t=2.1e-03 per=6.7e+00 cost=1.8e+05 flops=8.8e+07
 sigma_tot[gemm] counter=15 i=4 t=3.9e-03 per=1.3e+01 cost=5.4e+05 flops=1.4e+08
 sigma_tot[gemm] counter=15 i=5 t=4.0e-03 per=1.3e+01 cost=5.4e+05 flops=1.3e+08
 sigma_tot[gemm] counter=15 i=6 t=3.7e-03 per=1.2e+01 cost=4.8e+05 flops=1.3e+08
 sigma_tot[gemm] counter=15 i=7 t=3.6e-03 per=1.2e+01 cost=4.8e+05 flops=1.3e+08
 sigma_tot[gemm] counter=15 total t=2.4e-02 per=7.8e+01 cost=2.8e+06 flops=1.2e+08
 sigma_tot[red] counter=15 t=3.9e-03 per=1.3e+01 cost=7.0e+05 flops=1.8e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.6e-05,3.5e-06,1.5e-06,2.4e-07
    5   0 -      -3.236065734158 -1.245e-06  7.923e-04    3     5  2.174e-02 4.347e-03 2.946e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.334e-05,2.474e-04,2.332e-03,2.693e-04,2.879e-03
 ndim=175:1.304e-06GB t[comm(intra)]=2.334e-05 speed=1.117e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=2.5e-04 t_gemm=2.3e-03 t_reduction=2.7e-04 tot=2.8e-03 ---
 sigma[inter] counter=16 t=2.5e-04 per=8.7e+00 cost=4.7e+04 flops=1.9e+08
 sigma[gemm] counter=16 i=0 t=2.4e-04 per=8.3e+00 cost=2.3e+04 flops=9.9e+07
 sigma[gemm] counter=16 i=1 t=2.3e-04 per=8.2e+00 cost=2.3e+04 flops=1.0e+08
 sigma[gemm] counter=16 i=2 t=1.8e-04 per=6.2e+00 cost=2.1e+04 flops=1.2e+08
 sigma[gemm] counter=16 i=3 t=1.7e-04 per=6.0e+00 cost=2.1e+04 flops=1.2e+08
 sigma[gemm] counter=16 i=4 t=4.0e-04 per=1.4e+01 cost=6.4e+04 flops=1.6e+08
 sigma[gemm] counter=16 i=5 t=3.8e-04 per=1.3e+01 cost=6.4e+04 flops=1.7e+08
 sigma[gemm] counter=16 i=6 t=3.7e-04 per=1.3e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=16 i=7 t=3.6e-04 per=1.3e+01 cost=5.7e+04 flops=1.6e+08
 sigma[gemm] counter=16 total t=2.3e-03 per=8.2e+01 cost=3.3e+05 flops=1.4e+08
 sigma[red] counter=16 t=2.7e-04 per=9.5e+00 cost=8.2e+04 flops=3.1e+08
--- TIMING FOR sigma_tot : t_inter=3.0e-03 t_gemm=2.7e-02 t_reduction=4.2e-03 tot=3.4e-02 ---
 sigma_tot[inter] counter=16 t=3.0e-03 per=8.9e+00 cost=5.7e+05 flops=1.9e+08
 sigma_tot[gemm] counter=16 i=0 t=2.6e-03 per=7.8e+00 cost=2.2e+05 flops=8.5e+07
 sigma_tot[gemm] counter=16 i=1 t=2.6e-03 per=7.6e+00 cost=2.2e+05 flops=8.7e+07
 sigma_tot[gemm] counter=16 i=2 t=2.3e-03 per=6.7e+00 cost=2.0e+05 flops=8.9e+07
 sigma_tot[gemm] counter=16 i=3 t=2.2e-03 per=6.6e+00 cost=2.0e+05 flops=9.0e+07
 sigma_tot[gemm] counter=16 i=4 t=4.3e-03 per=1.3e+01 cost=6.0e+05 flops=1.4e+08
 sigma_tot[gemm] counter=16 i=5 t=4.4e-03 per=1.3e+01 cost=6.0e+05 flops=1.4e+08
 sigma_tot[gemm] counter=16 i=6 t=4.1e-03 per=1.2e+01 cost=5.3e+05 flops=1.3e+08
 sigma_tot[gemm] counter=16 i=7 t=4.0e-03 per=1.2e+01 cost=5.3e+05 flops=1.3e+08
 sigma_tot[gemm] counter=16 total t=2.7e-02 per=7.9e+01 cost=3.1e+06 flops=1.2e+08
 sigma_tot[red] counter=16 t=4.2e-03 per=1.2e+01 cost=7.8e+05 flops=1.9e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.9e-06,1.6e-05,3.6e-06,1.5e-06,3.0e-07
    6   0 -      -3.236066127596 -3.934e-07  4.181e-04    3     6  2.490e-02 4.150e-03 2.964e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.593e-05,2.204e-04,2.340e-03,2.745e-04,2.883e-03
 ndim=175:1.304e-06GB t[comm(intra)]=2.593e-05 speed=1.006e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=2.2e-04 t_gemm=2.3e-03 t_reduction=2.7e-04 tot=2.8e-03 ---
 sigma[inter] counter=17 t=2.2e-04 per=7.8e+00 cost=4.7e+04 flops=2.2e+08
 sigma[gemm] counter=17 i=0 t=2.4e-04 per=8.4e+00 cost=2.3e+04 flops=9.8e+07
 sigma[gemm] counter=17 i=1 t=2.3e-04 per=8.2e+00 cost=2.3e+04 flops=1.0e+08
 sigma[gemm] counter=17 i=2 t=1.7e-04 per=6.2e+00 cost=2.1e+04 flops=1.2e+08
 sigma[gemm] counter=17 i=3 t=2.0e-04 per=7.0e+00 cost=2.1e+04 flops=1.1e+08
 sigma[gemm] counter=17 i=4 t=3.8e-04 per=1.3e+01 cost=6.4e+04 flops=1.7e+08
 sigma[gemm] counter=17 i=5 t=3.8e-04 per=1.4e+01 cost=6.4e+04 flops=1.7e+08
 sigma[gemm] counter=17 i=6 t=3.7e-04 per=1.3e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=17 i=7 t=3.6e-04 per=1.3e+01 cost=5.7e+04 flops=1.6e+08
 sigma[gemm] counter=17 total t=2.3e-03 per=8.3e+01 cost=3.3e+05 flops=1.4e+08
 sigma[red] counter=17 t=2.7e-04 per=9.7e+00 cost=8.2e+04 flops=3.0e+08
--- TIMING FOR sigma_tot : t_inter=3.2e-03 t_gemm=2.9e-02 t_reduction=4.4e-03 tot=3.7e-02 ---
 sigma_tot[inter] counter=17 t=3.2e-03 per=8.8e+00 cost=6.2e+05 flops=1.9e+08
 sigma_tot[gemm] counter=17 i=0 t=2.9e-03 per=7.8e+00 cost=2.5e+05 flops=8.6e+07
 sigma_tot[gemm] counter=17 i=1 t=2.8e-03 per=7.7e+00 cost=2.5e+05 flops=8.8e+07
 sigma_tot[gemm] counter=17 i=2 t=2.4e-03 per=6.7e+00 cost=2.2e+05 flops=9.2e+07
 sigma_tot[gemm] counter=17 i=3 t=2.4e-03 per=6.7e+00 cost=2.2e+05 flops=9.2e+07
 sigma_tot[gemm] counter=17 i=4 t=4.7e-03 per=1.3e+01 cost=6.7e+05 flops=1.4e+08
 sigma_tot[gemm] counter=17 i=5 t=4.8e-03 per=1.3e+01 cost=6.7e+05 flops=1.4e+08
 sigma_tot[gemm] counter=17 i=6 t=4.5e-03 per=1.2e+01 cost=5.9e+05 flops=1.3e+08
 sigma_tot[gemm] counter=17 i=7 t=4.4e-03 per=1.2e+01 cost=5.9e+05 flops=1.4e+08
 sigma_tot[gemm] counter=17 total t=2.9e-02 per=7.9e+01 cost=3.5e+06 flops=1.2e+08
 sigma_tot[red] counter=17 t=4.4e-03 per=1.2e+01 cost=8.6e+05 flops=1.9e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.6e-05,3.5e-06,1.5e-06,2.3e-07
    7   0 -      -3.236066243660 -1.161e-07  2.245e-04    3     7  2.809e-02 4.013e-03 2.981e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.288e-05,2.124e-04,2.399e-03,2.703e-04,2.912e-03
 ndim=175:1.304e-06GB t[comm(intra)]=2.288e-05 speed=1.140e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=2.4e-03 t_reduction=2.7e-04 tot=2.9e-03 ---
 sigma[inter] counter=18 t=2.1e-04 per=7.4e+00 cost=4.7e+04 flops=2.2e+08
 sigma[gemm] counter=18 i=0 t=2.1e-04 per=7.3e+00 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=18 i=1 t=2.1e-04 per=7.2e+00 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=18 i=2 t=1.9e-04 per=6.6e+00 cost=2.1e+04 flops=1.1e+08
 sigma[gemm] counter=18 i=3 t=1.9e-04 per=6.7e+00 cost=2.1e+04 flops=1.1e+08
 sigma[gemm] counter=18 i=4 t=4.0e-04 per=1.4e+01 cost=6.4e+04 flops=1.6e+08
 sigma[gemm] counter=18 i=5 t=4.3e-04 per=1.5e+01 cost=6.4e+04 flops=1.5e+08
 sigma[gemm] counter=18 i=6 t=4.1e-04 per=1.4e+01 cost=5.7e+04 flops=1.4e+08
 sigma[gemm] counter=18 i=7 t=3.6e-04 per=1.2e+01 cost=5.7e+04 flops=1.6e+08
 sigma[gemm] counter=18 total t=2.4e-03 per=8.3e+01 cost=3.3e+05 flops=1.4e+08
 sigma[red] counter=18 t=2.7e-04 per=9.4e+00 cost=8.2e+04 flops=3.0e+08
--- TIMING FOR sigma_tot : t_inter=3.4e-03 t_gemm=3.1e-02 t_reduction=4.7e-03 tot=3.9e-02 ---
 sigma_tot[inter] counter=18 t=3.4e-03 per=8.7e+00 cost=6.7e+05 flops=2.0e+08
 sigma_tot[gemm] counter=18 i=0 t=3.1e-03 per=7.8e+00 cost=2.7e+05 flops=8.8e+07
 sigma_tot[gemm] counter=18 i=1 t=3.0e-03 per=7.6e+00 cost=2.7e+05 flops=9.0e+07
 sigma_tot[gemm] counter=18 i=2 t=2.6e-03 per=6.7e+00 cost=2.5e+05 flops=9.3e+07
 sigma_tot[gemm] counter=18 i=3 t=2.6e-03 per=6.7e+00 cost=2.4e+05 flops=9.3e+07
 sigma_tot[gemm] counter=18 i=4 t=5.1e-03 per=1.3e+01 cost=7.3e+05 flops=1.4e+08
 sigma_tot[gemm] counter=18 i=5 t=5.2e-03 per=1.3e+01 cost=7.3e+05 flops=1.4e+08
 sigma_tot[gemm] counter=18 i=6 t=4.9e-03 per=1.2e+01 cost=6.5e+05 flops=1.3e+08
 sigma_tot[gemm] counter=18 i=7 t=4.7e-03 per=1.2e+01 cost=6.5e+05 flops=1.4e+08
 sigma_tot[gemm] counter=18 total t=3.1e-02 per=7.9e+01 cost=3.8e+06 flops=1.2e+08
 sigma_tot[red] counter=18 t=4.7e-03 per=1.2e+01 cost=9.5e+05 flops=2.0e+08
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.0e-06,1.6e-05,3.6e-06,1.5e-06,2.7e-07
    8   0 -      -3.236066271247 -2.759e-08  1.102e-04    3     8  3.618e-02 4.523e-03 2.995e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.251e-05,2.133e-04,2.330e-03,2.704e-04,2.844e-03
 ndim=175:1.304e-06GB t[comm(intra)]=2.251e-05 speed=1.159e-01GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=2.1e-04 t_gemm=2.3e-03 t_reduction=2.7e-04 tot=2.8e-03 ---
 sigma[inter] counter=19 t=2.1e-04 per=7.6e+00 cost=4.7e+04 flops=2.2e+08
 sigma[gemm] counter=19 i=0 t=2.3e-04 per=8.2e+00 cost=2.3e+04 flops=1.0e+08
 sigma[gemm] counter=19 i=1 t=2.1e-04 per=7.4e+00 cost=2.3e+04 flops=1.1e+08
 sigma[gemm] counter=19 i=2 t=1.9e-04 per=6.6e+00 cost=2.1e+04 flops=1.1e+08
 sigma[gemm] counter=19 i=3 t=1.7e-04 per=6.2e+00 cost=2.1e+04 flops=1.2e+08
 sigma[gemm] counter=19 i=4 t=4.0e-04 per=1.4e+01 cost=6.4e+04 flops=1.6e+08
 sigma[gemm] counter=19 i=5 t=3.8e-04 per=1.4e+01 cost=6.4e+04 flops=1.7e+08
 sigma[gemm] counter=19 i=6 t=3.6e-04 per=1.3e+01 cost=5.7e+04 flops=1.6e+08
 sigma[gemm] counter=19 i=7 t=3.8e-04 per=1.4e+01 cost=5.7e+04 flops=1.5e+08
 sigma[gemm] counter=19 total t=2.3e-03 per=8.3e+01 cost=3.3e+05 flops=1.4e+08
 sigma[red] counter=19 t=2.7e-04 per=9.6e+00 cost=8.2e+04 flops=3.0e+08
--- TIMING FOR sigma_tot : t_inter=3.6e-03 t_gemm=3.4e-02 t_reduction=5.0e-03 tot=4.2e-02 ---
 sigma_tot[inter] counter=19 t=3.6e-03 per=8.6e+00 cost=7.2e+05 flops=2.0e+08
 sigma_tot[gemm] counter=19 i=0 t=3.3e-03 per=7.8e+00 cost=2.9e+05 flops=8.9e+07
 sigma_tot[gemm] counter=19 i=1 t=3.2e-03 per=7.6e+00 cost=2.9e+05 flops=9.1e+07
 sigma_tot[gemm] counter=19 i=2 t=2.8e-03 per=6.7e+00 cost=2.7e+05 flops=9.5e+07
 sigma_tot[gemm] counter=19 i=3 t=2.8e-03 per=6.6e+00 cost=2.7e+05 flops=9.5e+07
 sigma_tot[gemm] counter=19 i=4 t=5.5e-03 per=1.3e+01 cost=8.0e+05 flops=1.4e+08
 sigma_tot[gemm] counter=19 i=5 t=5.6e-03 per=1.3e+01 cost=8.0e+05 flops=1.4e+08
 sigma_tot[gemm] counter=19 i=6 t=5.2e-03 per=1.2e+01 cost=7.0e+05 flops=1.3e+08
 sigma_tot[gemm] counter=19 i=7 t=5.1e-03 per=1.2e+01 cost=7.0e+05 flops=1.4e+08
 sigma_tot[gemm] counter=19 total t=3.4e-02 per=8.0e+01 cost=4.1e+06 flops=1.2e+08
 sigma_tot[red] counter=19 t=5.0e-03 per=1.2e+01 cost=1.0e+06 flops=2.1e+08
T(sub)=2.7e-05 T(gemm/eig/ortho/gemm/axpy)=5.3e-06,1.6e-05,3.7e-06,1.6e-06,2.4e-07
    9   0 +      -3.236066278078 -6.831e-09  5.257e-05    3     9  4.566e-02 5.073e-03 2.998e-03
TIMING FOR Davidson : 4.567e-02  T(cal/comm/rest)=2.698e-02,1.407e-06,1.868e-02
decomposed t_rest=1.868e-02
 T(sub)    =2.225e-04 per=1.191e+00
 T(precond)=1.811e-02 per=9.693e+01
 T(ortho)  =4.381e-05 per=2.345e-01
 T(xcopy)  =1.271e-06 per=6.803e-03
 T(xnrm2)  =5.279e-06 per=2.826e-02
 T(other)  =3.000e-04 per=1.606e+00
optimized energies: isweep=0 ibond=4 dots=2 e[0]=-3.236066278078 nmvp=9
CPUmem: VM:1.947e+01GB RSS:1.838e+00GB  Timing: User:7.726e+01S Sys:1.389e+00S Total:7.865e+01S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=10 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond4.txt
 qbond: qsuper nsym=10 dimAll=35
 (2,0):6 (1,1):3 (3,1):8 (0,0):1 (4,0):6 (2,2):3 (5,1):3 (6,0):1 (4,2):3 (3,3):1
----- TMING FOR decimation_genbasis(su2): 4.7e-03 S -----
decimation summary: 35->10 dwt=+1.400e-04 SvN=8.900e-01
 qbond: qkept nsym=6 dimAll=10
 (3,1):3 (2,0):2 (4,0):2 (1,1):1 (2,2):1 (4,2):1
----- TIMING for decimation_row(nkr): 5.148e-03 S T(decim/select/formRot)=4.726e-03,3.222e-04,9.992e-05 -----
----- TIMING FOR twodot_decimation: 6.360e-03 S T(wf/decim)=1.092e-03,5.268e-03 -----
ctns::oper_renorm coord=(3,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:3 S:3 H:1 A:9 B:12 
        dim(bra,ket)=10,10 size(op)=21:1.602e-04MB size(tot)=458:3.494e-03MB:3.412e-06GB
CPUmem: VM:1.947e+01GB RSS:1.838e+00GB  Timing: User:7.834e+01S Sys:1.391e+00S Total:7.973e+01S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=28 : 6.353e-04 S -----
rank=0 GPUmem(GB): used=7.68e-06 (oper)=6.21e-06
rank=0 GPUmem(GB): used=8.11e-06 (oper,site)(GB)=6.21e-06,4.25e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=28
 no. of rintermediate operators=9
 no. of coefficients=18:0.000137MB:1.34e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.996e-05 S -----
rank=0 GPUmem(GB): used=8.24e-06 (oper,site,rinter)=6.21e-06,4.25e-07,1.34e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0141 S size(rtasks)=28 size(Rlst2)=36 T(Rmu/Rlist)=0.000203,0.0139 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0142 S size(rtasks)=28 size(Rlst)=1114 -----
rank=0 GPUmem(GB): used=8.24e-06 (oper,site,rinter,batch)=6.21e-06,4.25e-07,1.34e-07,0.000207 blksize=9 blksize0=6 batchsize=1114
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.05e-05,0.000987,0.00021
--- TIMING FOR renorm : t_inter=9.0e-05 t_gemm=9.9e-04 t_reduction=2.1e-04 tot=1.3e-03 ---
 renorm[inter] counter=5 t=9.0e-05 per=7.0e+00 cost=1.4e+03 flops=1.6e+07
 renorm[gemm] counter=5 i=0 t=9.6e-05 per=7.5e+00 cost=3.3e+03 flops=3.4e+07
 renorm[gemm] counter=5 i=1 t=9.0e-05 per=7.0e+00 cost=3.5e+03 flops=3.9e+07
 renorm[gemm] counter=5 i=2 t=2.3e-04 per=1.8e+01 cost=6.3e+03 flops=2.7e+07
 renorm[gemm] counter=5 i=3 t=2.8e-04 per=2.2e+01 cost=8.6e+03 flops=3.1e+07
 renorm[gemm] counter=5 i=4 t=1.3e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=5 t=1.2e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=6 t=2.8e-04 per=2.2e+01 cost=1.8e+04 flops=6.2e+07
 renorm[gemm] counter=5 total t=9.9e-04 per=7.7e+01 cost=3.9e+04 flops=4.0e+07
 renorm[red] counter=5 t=2.1e-04 per=1.6e+01 cost=9.0e+03 flops=4.3e+07
--- TIMING FOR renorm_tot : t_inter=3.2e-04 t_gemm=4.6e-03 t_reduction=1.6e-03 tot=6.5e-03 ---
 renorm_tot[inter] counter=5 t=3.2e-04 per=4.8e+00 cost=1.3e+04 flops=4.1e+07
 renorm_tot[gemm] counter=5 i=0 t=4.6e-04 per=7.1e+00 cost=8.6e+03 flops=1.9e+07
 renorm_tot[gemm] counter=5 i=1 t=1.4e-03 per=2.1e+01 cost=1.2e+04 flops=8.4e+06
 renorm_tot[gemm] counter=5 i=2 t=2.9e-04 per=4.4e+00 cost=6.7e+03 flops=2.3e+07
 renorm_tot[gemm] counter=5 i=3 t=3.4e-04 per=5.2e+00 cost=9.3e+03 flops=2.7e+07
 renorm_tot[gemm] counter=5 i=4 t=5.6e-04 per=8.5e+00 cost=1.1e+04 flops=2.0e+07
 renorm_tot[gemm] counter=5 i=5 t=5.6e-04 per=8.5e+00 cost=1.5e+04 flops=2.7e+07
 renorm_tot[gemm] counter=5 i=6 t=1.0e-03 per=1.6e+01 cost=5.6e+04 flops=5.5e+07
 renorm_tot[gemm] counter=5 total t=4.6e-03 per=7.0e+01 cost=1.2e+05 flops=2.6e+07
 renorm_tot[red] counter=5 t=1.6e-03 per=2.5e+01 cost=3.1e+04 flops=1.9e+07
qops.to_cpu: size(tot)=458:3.5e-03MB:3.4e-06GB t[to_cpu]=1.4e-05S speed=2.4e-01GB/S
check ||H-H.dagger||=4.791e-16 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=cr ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 0.186 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.00106,5.23e-06,0.076,0.109,2.79e-05,0.000106 -----
----- TIMING FOR oper_renorm : 0.0248 S rank=0 -----
CPUmem: VM:1.947e+01GB RSS:1.838e+00GB  Timing: User:9.960e+01S Sys:1.392e+00S Total:1.010e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=218:1.663e-03MB:1.624e-06GB
CPUmem: VM:1.947e+01GB RSS:1.838e+00GB  Timing: User:9.969e+01S Sys:1.392e+00S Total:1.011e+02S
##### local opt: 5.279e-01 S #####
 T(local opt: fetch) = 1.959e-04 S  per = 0.0371  per(accum) = 0.0371
 T(local opt: hdiag) = 4.689e-03 S  per = 0.888  per(accum) = 0.925
 T(local opt: dvdsn) = 3.028e-01 S  per = 57.4  per(accum) = 58.3
 T(local opt: decim) = 6.398e-03 S  per = 1.21  per(accum) = 59.5
 T(local opt: guess) = 1.492e-03 S  per = 0.283  per(accum) = 59.8
 T(local opt: renrm) = 2.116e-01 S  per = 40.1  per(accum) = 99.9
 T(local opt: save ) = 6.615e-04 S  per = 0.125  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.028e-01 S  T(sum) = 3.024e-01 S  per = 9.984e+01
 T(local opt: preprocess                  ) = 7.548e-03 S  per =  2.5  per(accum) = 2.5
 T(local opt: symbolic_formulae           ) = 2.035e-03 S  per = 0.673  per(accum) = 3.17
 T(local opt: hintermediate init          ) = 8.809e-05 S  per = 0.0291  per(accum) = 3.2
 T(local opt: preprocess_hformulae_Hxlist ) = 1.659e-01 S  per = 54.9  per(accum) = 58.1
 T(local opt: hmmtasks init               ) = 7.923e-02 S  per = 26.2  per(accum) = 84.3
 T(local opt: initial guess for dvdson    ) = 1.938e-03 S  per = 0.641  per(accum) = 84.9
 T(local opt: dvdson solver [Hx_batchGPU] ) = 2.677e-02 S  per = 8.86  per(accum) = 93.8
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.094e-04 S  per = 0.0692  per(accum) = 93.8
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.407e-06 S  per = 0.000465  per(accum) = 93.8
 T(local opt: dvdson solver [rest part]   ) = 1.868e-02 S  per = 6.18  per(accum) = 100
Detailed decomposition of T(renrm) = 2.116e-01 S  T(sum) = 2.116e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.715e-04 S  per = 0.176  per(accum) = 0.176
 T(local opt: qops init                    ) = 1.490e-03 S  per = 0.704  per(accum) = 0.879
 T(local opt: symbolic_formulae_renorm     ) = 6.442e-04 S  per = 0.304  per(accum) = 1.18
 T(local opt: allocate qops on gpu         ) = 2.455e-05 S  per = 0.0116  per(accum) = 1.2
 T(local opt: site memcpy cpu2gpu          ) = 1.458e-04 S  per = 0.0689  per(accum) = 1.26
 T(local opt: rintermediate init           ) = 5.030e-05 S  per = 0.0238  per(accum) = 1.29
 T(local opt: preprocess_formulae_Rlist2   ) = 1.423e-02 S  per = 6.72  per(accum) = 8.01
 T(local opt: rmmtasks init                ) = 6.687e-03 S  per = 3.16  per(accum) = 11.2
 T(local opt: qops memset on cpu           ) = 3.100e-08 S  per = 1.46e-05  per(accum) = 11.2
 T(local opt: preprocess_renorm_batchGPU   ) = 1.395e-03 S  per = 0.659  per(accum) = 11.8
 T(local opt: reduction of opS & opH [nccl]) = 1.003e-06 S  per = 0.000474  per(accum) = 11.8
 T(local opt: qops memcpy gpu2cpu          ) = 2.007e-05 S  per = 0.00948  per(accum) = 11.8
 T(local opt: deallocate cpu and gpu memory) = 1.102e-05 S  per = 0.00521  per(accum) = 11.8
 T(local opt: reduction of opS & opH [comm]) = 7.693e-05 S  per = 0.0364  per(accum) = 11.9
 T(local opt: conversion from opAB to opPQ ) = 1.862e-01 S  per =   88  per(accum) = 99.8
 T(local opt: after oper_renorm            ) = 3.311e-04 S  per = 0.156  per(accum) = 100
##### sweep opt: 1.340e+00 S #####
 T(sweep opt: fetch) = 4.912e-03 S  per = 0.367  per(accum) = 0.367
 T(sweep opt: hdiag) = 1.515e-02 S  per = 1.13  per(accum) = 1.5
 T(sweep opt: dvdsn) = 8.820e-01 S  per = 65.8  per(accum) = 67.3
 T(sweep opt: decim) = 4.174e-02 S  per = 3.12  per(accum) = 70.4
 T(sweep opt: guess) = 7.258e-03 S  per = 0.542  per(accum) = 71
 T(sweep opt: renrm) = 3.786e-01 S  per = 28.3  per(accum) = 99.3
 T(sweep opt: save ) = 1.001e-02 S  per = 0.747  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.820e-01 S  T(sum) = 8.800e-01 S  per = 9.978e+01
 T(sweep opt: preprocess                  ) = 2.714e-02 S  per = 3.08  per(accum) = 3.08
 T(sweep opt: symbolic_formulae           ) = 6.566e-03 S  per = 0.746  per(accum) = 3.83
 T(sweep opt: hintermediate init          ) = 3.601e-04 S  per = 0.0409  per(accum) = 3.87
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.883e-01 S  per = 55.5  per(accum) = 59.4
 T(sweep opt: hmmtasks init               ) = 2.246e-01 S  per = 25.5  per(accum) = 84.9
 T(sweep opt: initial guess for dvdson    ) = 8.096e-03 S  per = 0.92  per(accum) = 85.8
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 4.571e-02 S  per = 5.19  per(accum) = 91
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.573e-04 S  per = 0.052  per(accum) = 91.1
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 3.022e-06 S  per = 0.000343  per(accum) = 91.1
 T(sweep opt: dvdson solver [rest part]   ) = 7.874e-02 S  per = 8.95  per(accum) = 100
Detailed decomposition of T(renrm) = 3.786e-01 S  T(sum) = 3.786e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 2.946e-03 S  per = 0.778  per(accum) = 0.778
 T(sweep opt: qops init                    ) = 6.335e-03 S  per = 1.67  per(accum) = 2.45
 T(sweep opt: symbolic_formulae_renorm     ) = 3.130e-03 S  per = 0.827  per(accum) = 3.28
 T(sweep opt: allocate qops on gpu         ) = 1.473e-04 S  per = 0.0389  per(accum) = 3.32
 T(sweep opt: site memcpy cpu2gpu          ) = 2.326e-04 S  per = 0.0614  per(accum) = 3.38
 T(sweep opt: rintermediate init           ) = 4.037e-04 S  per = 0.107  per(accum) = 3.49
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.447e-02 S  per = 14.4  per(accum) = 17.9
 T(sweep opt: rmmtasks init                ) = 2.382e-02 S  per = 6.29  per(accum) = 24.2
 T(sweep opt: qops memset on cpu           ) = 1.600e-07 S  per = 4.23e-05  per(accum) = 24.2
 T(sweep opt: preprocess_renorm_batchGPU   ) = 7.064e-03 S  per = 1.87  per(accum) = 26
 T(sweep opt: reduction of opS & opH [nccl]) = 5.641e-06 S  per = 0.00149  per(accum) = 26
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.019e-04 S  per = 0.0269  per(accum) = 26.1
 T(sweep opt: deallocate cpu and gpu memory) = 5.360e-05 S  per = 0.0142  per(accum) = 26.1
 T(sweep opt: reduction of opS & opH [comm]) = 3.880e-04 S  per = 0.102  per(accum) = 26.2
 T(sweep opt: conversion from opAB to opPQ ) = 2.781e-01 S  per = 73.5  per(accum) = 99.6
 T(sweep opt: after oper_renorm            ) = 1.388e-03 S  per = 0.367  per(accum) = 100
##### global opt: 1.340e+00 S #####
 T(global opt: fetch) = 4.912e-03 S  per = 0.367  per(accum) = 0.367
 T(global opt: hdiag) = 1.515e-02 S  per = 1.13  per(accum) = 1.5
 T(global opt: dvdsn) = 8.820e-01 S  per = 65.8  per(accum) = 67.3
 T(global opt: decim) = 4.174e-02 S  per = 3.12  per(accum) = 70.4
 T(global opt: guess) = 7.258e-03 S  per = 0.542  per(accum) = 71
 T(global opt: renrm) = 3.786e-01 S  per = 28.3  per(accum) = 99.3
 T(global opt: save ) = 1.001e-02 S  per = 0.747  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.820e-01 S  T(sum) = 8.800e-01 S  per = 9.978e+01
 T(global opt: preprocess                  ) = 2.714e-02 S  per = 3.08  per(accum) = 3.08
 T(global opt: symbolic_formulae           ) = 6.566e-03 S  per = 0.746  per(accum) = 3.83
 T(global opt: hintermediate init          ) = 3.601e-04 S  per = 0.0409  per(accum) = 3.87
 T(global opt: preprocess_hformulae_Hxlist ) = 4.883e-01 S  per = 55.5  per(accum) = 59.4
 T(global opt: hmmtasks init               ) = 2.246e-01 S  per = 25.5  per(accum) = 84.9
 T(global opt: initial guess for dvdson    ) = 8.096e-03 S  per = 0.92  per(accum) = 85.8
 T(global opt: dvdson solver [Hx_batchGPU] ) = 4.571e-02 S  per = 5.19  per(accum) = 91
 T(global opt: dvdson solver [comm(gpu)]   ) = 4.573e-04 S  per = 0.052  per(accum) = 91.1
 T(global opt: dvdson solver [comm(cpu)]   ) = 3.022e-06 S  per = 0.000343  per(accum) = 91.1
 T(global opt: dvdson solver [rest part]   ) = 7.874e-02 S  per = 8.95  per(accum) = 100
Detailed decomposition of T(renrm) = 3.786e-01 S  T(sum) = 3.786e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 2.946e-03 S  per = 0.778  per(accum) = 0.778
 T(global opt: qops init                    ) = 6.335e-03 S  per = 1.67  per(accum) = 2.45
 T(global opt: symbolic_formulae_renorm     ) = 3.130e-03 S  per = 0.827  per(accum) = 3.28
 T(global opt: allocate qops on gpu         ) = 1.473e-04 S  per = 0.0389  per(accum) = 3.32
 T(global opt: site memcpy cpu2gpu          ) = 2.326e-04 S  per = 0.0614  per(accum) = 3.38
 T(global opt: rintermediate init           ) = 4.037e-04 S  per = 0.107  per(accum) = 3.49
 T(global opt: preprocess_formulae_Rlist2   ) = 5.447e-02 S  per = 14.4  per(accum) = 17.9
 T(global opt: rmmtasks init                ) = 2.382e-02 S  per = 6.29  per(accum) = 24.2
 T(global opt: qops memset on cpu           ) = 1.600e-07 S  per = 4.23e-05  per(accum) = 24.2
 T(global opt: preprocess_renorm_batchGPU   ) = 7.064e-03 S  per = 1.87  per(accum) = 26
 T(global opt: reduction of opS & opH [nccl]) = 5.641e-06 S  per = 0.00149  per(accum) = 26
 T(global opt: qops memcpy gpu2cpu          ) = 1.019e-04 S  per = 0.0269  per(accum) = 26.1
 T(global opt: deallocate cpu and gpu memory) = 5.360e-05 S  per = 0.0142  per(accum) = 26.1
 T(global opt: reduction of opS & opH [comm]) = 3.880e-04 S  per = 0.102  per(accum) = 26.2
 T(global opt: conversion from opAB to opPQ ) = 2.781e-01 S  per = 73.5  per(accum) = 99.6
 T(global opt: after oper_renorm            ) = 1.388e-03 S  per = 0.367  per(accum) = 100

isweep=0 ibond=5/seqsize=6 dots=2 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_twodot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.947e+01GB RSS:1.838e+00GB  Timing: User:9.987e+01S Sys:1.392e+00S Total:1.013e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=218:1.663e-03MB:1.624e-06GB
ctns::topology::check_partition: (sl,sr,sc1,sc2)=1,3,1,1
 suppl= 0
 suppr= 3 4 5
 suppc1= 1
 suppc2= 2
ctns::topology::get_fqops dots=2
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(1,0)
 fqop[3]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 rqops: oplist=CSHPQ nops=C:3 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=10,10 size(op)=21:1.602e-04MB size(tot)=458:3.494e-03MB:3.412e-06GB
 c1qops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 c2qops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 qops(tot)=743:5.669e-03MB:5.536e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
wf4(diml,dimr,dimc1,dimc2)=(3,10,3,3) nnz=57:4.349e-04MB
qtensor4: wf4 own=1 _data=0x4e8a9c20
qinfo4su2: wf4 sym=(6,0) couple=0
 qbond: qrow nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qcol nsym=6 dimAll=10
 (3,1):3 (2,0):2 (4,0):2 (1,1):1 (2,2):1 (4,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qver nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=29 nblocks=220 size=57:4.349e-04MB
### DIAG TIMING: total=1.308e-03 t1=1.137e-05, t2=1.930e-04, t3=1.052e-04, t4=9.783e-04, t5=4.216e-06, t6=1.265e-05, t7=3.505e-06
duration_diagGPU:1.323e-03
duration_diagreduce:7.200e-08
duration_diagtransform:4.710e-07
----- TIMING FOR symbolic_formulae_twodot with size=102 : 9.842e-04 S -----
rank=0 GPUmem(GB): used=5.54e-06 (oper)=5.54e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=102
 no. of hintermediate operators=22
 no. of coefficients=66:0.000504MB:4.92e-07GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.680e-05 S -----
rank=0 GPUmem(GB): used=6.03e-06 (oper,hinter)=5.54e-06,4.92e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0481 S size(H_formulae)=102 size(Hxlst2)=29 T(Hmu/Hxlist)=0.000251,0.0479 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0484 S size(H_formulae)=102 size(Hxlst)=3138 -----
rank=0 GPUmem(GB): used=0.000311 (oper,hinter,dvdson,batch)=5.54e-06,4.92e-07,8.49e-07,0.000304 blksize=3 blksize0=6 batchsize=3138
ctns::twodot_guess_v0 |c2r>
ctns::pdvdsonSolver_nkr::solve_iter ndim=57 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.21e-05,9.23e-05,0.000704,0.000167,0.000993
 ndim=57:4.25e-07GB t[comm(intra)]=2.21e-05 speed=0.0385GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.2e-05 t_gemm=7.0e-04 t_reduction=1.7e-04 tot=9.6e-04 ---
 sigma[inter] counter=20 t=9.2e-05 per=9.6e+00 cost=1.5e+04 flops=1.6e+08
 sigma[gemm] counter=20 i=0 t=8.0e-05 per=8.3e+00 cost=3.2e+03 flops=4.0e+07
 sigma[gemm] counter=20 i=1 t=7.5e-05 per=7.8e+00 cost=3.3e+03 flops=4.4e+07
 sigma[gemm] counter=20 i=2 t=8.0e-05 per=8.3e+00 cost=3.9e+03 flops=4.9e+07
 sigma[gemm] counter=20 i=3 t=7.6e-05 per=7.9e+00 cost=4.0e+03 flops=5.2e+07
 sigma[gemm] counter=20 i=4 t=1.2e-04 per=1.2e+01 cost=9.8e+03 flops=8.5e+07
 sigma[gemm] counter=20 i=5 t=1.2e-04 per=1.2e+01 cost=9.8e+03 flops=8.5e+07
 sigma[gemm] counter=20 i=6 t=8.3e-05 per=8.7e+00 cost=4.0e+03 flops=4.8e+07
 sigma[gemm] counter=20 i=7 t=7.6e-05 per=7.9e+00 cost=3.9e+03 flops=5.1e+07
 sigma[gemm] counter=20 total t=7.0e-04 per=7.3e+01 cost=4.2e+04 flops=6.0e+07
 sigma[red] counter=20 t=1.7e-04 per=1.7e+01 cost=1.3e+04 flops=7.7e+07
--- TIMING FOR sigma_tot : t_inter=3.7e-03 t_gemm=3.4e-02 t_reduction=5.1e-03 tot=4.3e-02 ---
 sigma_tot[inter] counter=20 t=3.7e-03 per=8.6e+00 cost=7.3e+05 flops=2.0e+08
 sigma_tot[gemm] counter=20 i=0 t=3.4e-03 per=7.8e+00 cost=3.0e+05 flops=8.8e+07
 sigma_tot[gemm] counter=20 i=1 t=3.3e-03 per=7.6e+00 cost=3.0e+05 flops=9.0e+07
 sigma_tot[gemm] counter=20 i=2 t=2.9e-03 per=6.7e+00 cost=2.7e+05 flops=9.3e+07
 sigma_tot[gemm] counter=20 i=3 t=2.9e-03 per=6.7e+00 cost=2.7e+05 flops=9.4e+07
 sigma_tot[gemm] counter=20 i=4 t=5.6e-03 per=1.3e+01 cost=8.1e+05 flops=1.4e+08
 sigma_tot[gemm] counter=20 i=5 t=5.7e-03 per=1.3e+01 cost=8.1e+05 flops=1.4e+08
 sigma_tot[gemm] counter=20 i=6 t=5.3e-03 per=1.2e+01 cost=7.1e+05 flops=1.3e+08
 sigma_tot[gemm] counter=20 i=7 t=5.2e-03 per=1.2e+01 cost=7.1e+05 flops=1.4e+08
 sigma_tot[gemm] counter=20 total t=3.4e-02 per=7.9e+01 cost=4.2e+06 flops=1.2e+08
 sigma_tot[red] counter=20 t=5.1e-03 per=1.2e+01 cost=1.0e+06 flops=2.0e+08
T(sub)=9.3e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.1e-06,1.8e-06,5.8e-07,1.6e-07
settings: ndim=57 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.235783841215 -1.003e+03  4.967e-03    1     1  1.137e-03 1.137e-03 1.109e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.204e-05,1.199e-04,8.725e-04,1.862e-04,1.208e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.204e-05 speed=3.854e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=8.7e-04 t_reduction=1.9e-04 tot=1.2e-03 ---
 sigma[inter] counter=21 t=1.2e-04 per=1.0e+01 cost=1.5e+04 flops=1.2e+08
 sigma[gemm] counter=21 i=0 t=9.5e-05 per=8.1e+00 cost=3.2e+03 flops=3.4e+07
 sigma[gemm] counter=21 i=1 t=9.1e-05 per=7.7e+00 cost=3.3e+03 flops=3.6e+07
 sigma[gemm] counter=21 i=2 t=9.7e-05 per=8.3e+00 cost=3.9e+03 flops=4.0e+07
 sigma[gemm] counter=21 i=3 t=9.5e-05 per=8.1e+00 cost=4.0e+03 flops=4.2e+07
 sigma[gemm] counter=21 i=4 t=1.5e-04 per=1.3e+01 cost=9.8e+03 flops=6.6e+07
 sigma[gemm] counter=21 i=5 t=1.5e-04 per=1.3e+01 cost=9.8e+03 flops=6.6e+07
 sigma[gemm] counter=21 i=6 t=8.8e-05 per=7.5e+00 cost=4.0e+03 flops=4.5e+07
 sigma[gemm] counter=21 i=7 t=1.1e-04 per=9.1e+00 cost=3.9e+03 flops=3.6e+07
 sigma[gemm] counter=21 total t=8.7e-04 per=7.4e+01 cost=4.2e+04 flops=4.8e+07
 sigma[red] counter=21 t=1.9e-04 per=1.6e+01 cost=1.3e+04 flops=6.9e+07
--- TIMING FOR sigma_tot : t_inter=3.9e-03 t_gemm=3.5e-02 t_reduction=5.3e-03 tot=4.4e-02 ---
 sigma_tot[inter] counter=21 t=3.9e-03 per=8.7e+00 cost=7.5e+05 flops=1.9e+08
 sigma_tot[gemm] counter=21 i=0 t=3.5e-03 per=7.8e+00 cost=3.0e+05 flops=8.6e+07
 sigma_tot[gemm] counter=21 i=1 t=3.4e-03 per=7.6e+00 cost=3.0e+05 flops=8.9e+07
 sigma_tot[gemm] counter=21 i=2 t=3.0e-03 per=6.8e+00 cost=2.7e+05 flops=9.2e+07
 sigma_tot[gemm] counter=21 i=3 t=3.0e-03 per=6.7e+00 cost=2.7e+05 flops=9.2e+07
 sigma_tot[gemm] counter=21 i=4 t=5.8e-03 per=1.3e+01 cost=8.2e+05 flops=1.4e+08
 sigma_tot[gemm] counter=21 i=5 t=5.9e-03 per=1.3e+01 cost=8.2e+05 flops=1.4e+08
 sigma_tot[gemm] counter=21 i=6 t=5.4e-03 per=1.2e+01 cost=7.1e+05 flops=1.3e+08
 sigma_tot[gemm] counter=21 i=7 t=5.3e-03 per=1.2e+01 cost=7.1e+05 flops=1.3e+08
 sigma_tot[gemm] counter=21 total t=3.5e-02 per=7.9e+01 cost=4.2e+06 flops=1.2e+08
 sigma_tot[red] counter=21 t=5.3e-03 per=1.2e+01 cost=1.1e+06 flops=2.0e+08
T(sub)=2.4e-05 T(gemm/eig/ortho/gemm/axpy)=5.2e-06,1.3e-05,4.2e-06,1.2e-06,2.9e-07
    2   0 -      -3.235799286157 -1.544e-05  1.816e-03    2     2  7.472e-03 3.736e-03 1.248e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.293e-05,1.182e-04,8.670e-04,1.912e-04,1.207e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.293e-05 speed=3.704e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=8.7e-04 t_reduction=1.9e-04 tot=1.2e-03 ---
 sigma[inter] counter=22 t=1.2e-04 per=1.0e+01 cost=1.5e+04 flops=1.3e+08
 sigma[gemm] counter=22 i=0 t=9.4e-05 per=8.0e+00 cost=3.2e+03 flops=3.4e+07
 sigma[gemm] counter=22 i=1 t=9.2e-05 per=7.8e+00 cost=3.3e+03 flops=3.6e+07
 sigma[gemm] counter=22 i=2 t=9.5e-05 per=8.1e+00 cost=3.9e+03 flops=4.1e+07
 sigma[gemm] counter=22 i=3 t=9.6e-05 per=8.2e+00 cost=4.0e+03 flops=4.1e+07
 sigma[gemm] counter=22 i=4 t=1.5e-04 per=1.3e+01 cost=9.8e+03 flops=6.5e+07
 sigma[gemm] counter=22 i=5 t=1.6e-04 per=1.4e+01 cost=9.8e+03 flops=6.1e+07
 sigma[gemm] counter=22 i=6 t=8.9e-05 per=7.6e+00 cost=4.0e+03 flops=4.5e+07
 sigma[gemm] counter=22 i=7 t=8.7e-05 per=7.4e+00 cost=3.9e+03 flops=4.5e+07
 sigma[gemm] counter=22 total t=8.7e-04 per=7.4e+01 cost=4.2e+04 flops=4.8e+07
 sigma[red] counter=22 t=1.9e-04 per=1.6e+01 cost=1.3e+04 flops=6.7e+07
--- TIMING FOR sigma_tot : t_inter=4.0e-03 t_gemm=3.6e-02 t_reduction=5.5e-03 tot=4.6e-02 ---
 sigma_tot[inter] counter=22 t=4.0e-03 per=8.7e+00 cost=7.6e+05 flops=1.9e+08
 sigma_tot[gemm] counter=22 i=0 t=3.6e-03 per=7.9e+00 cost=3.0e+05 flops=8.5e+07
 sigma_tot[gemm] counter=22 i=1 t=3.5e-03 per=7.6e+00 cost=3.0e+05 flops=8.7e+07
 sigma_tot[gemm] counter=22 i=2 t=3.1e-03 per=6.8e+00 cost=2.8e+05 flops=9.0e+07
 sigma_tot[gemm] counter=22 i=3 t=3.1e-03 per=6.7e+00 cost=2.8e+05 flops=9.0e+07
 sigma_tot[gemm] counter=22 i=4 t=5.9e-03 per=1.3e+01 cost=8.3e+05 flops=1.4e+08
 sigma_tot[gemm] counter=22 i=5 t=6.0e-03 per=1.3e+01 cost=8.3e+05 flops=1.4e+08
 sigma_tot[gemm] counter=22 i=6 t=5.5e-03 per=1.2e+01 cost=7.2e+05 flops=1.3e+08
 sigma_tot[gemm] counter=22 i=7 t=5.4e-03 per=1.2e+01 cost=7.2e+05 flops=1.3e+08
 sigma_tot[gemm] counter=22 total t=3.6e-02 per=7.9e+01 cost=4.2e+06 flops=1.2e+08
 sigma_tot[red] counter=22 t=5.5e-03 per=1.2e+01 cost=1.1e+06 flops=1.9e+08
T(sub)=2.6e-05 T(gemm/eig/ortho/gemm/axpy)=4.3e-06,1.7e-05,3.5e-06,1.3e-06,2.7e-07
    3   0 -      -3.235801725816 -2.440e-06  8.322e-04    3     3  1.661e-02 5.537e-03 1.293e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.200e-05,1.170e-04,8.703e-04,1.872e-04,1.203e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.200e-05 speed=3.861e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=8.7e-04 t_reduction=1.9e-04 tot=1.2e-03 ---
 sigma[inter] counter=23 t=1.2e-04 per=1.0e+01 cost=1.5e+04 flops=1.3e+08
 sigma[gemm] counter=23 i=0 t=9.4e-05 per=8.0e+00 cost=3.2e+03 flops=3.4e+07
 sigma[gemm] counter=23 i=1 t=9.1e-05 per=7.8e+00 cost=3.3e+03 flops=3.6e+07
 sigma[gemm] counter=23 i=2 t=9.7e-05 per=8.2e+00 cost=3.9e+03 flops=4.0e+07
 sigma[gemm] counter=23 i=3 t=9.5e-05 per=8.1e+00 cost=4.0e+03 flops=4.2e+07
 sigma[gemm] counter=23 i=4 t=1.7e-04 per=1.5e+01 cost=9.8e+03 flops=5.7e+07
 sigma[gemm] counter=23 i=5 t=1.4e-04 per=1.2e+01 cost=9.8e+03 flops=6.9e+07
 sigma[gemm] counter=23 i=6 t=8.8e-05 per=7.5e+00 cost=4.0e+03 flops=4.5e+07
 sigma[gemm] counter=23 i=7 t=8.7e-05 per=7.5e+00 cost=3.9e+03 flops=4.4e+07
 sigma[gemm] counter=23 total t=8.7e-04 per=7.4e+01 cost=4.2e+04 flops=4.8e+07
 sigma[red] counter=23 t=1.9e-04 per=1.6e+01 cost=1.3e+04 flops=6.9e+07
--- TIMING FOR sigma_tot : t_inter=4.1e-03 t_gemm=3.7e-02 t_reduction=5.7e-03 tot=4.7e-02 ---
 sigma_tot[inter] counter=23 t=4.1e-03 per=8.8e+00 cost=7.8e+05 flops=1.9e+08
 sigma_tot[gemm] counter=23 i=0 t=3.7e-03 per=7.9e+00 cost=3.1e+05 flops=8.3e+07
 sigma_tot[gemm] counter=23 i=1 t=3.6e-03 per=7.6e+00 cost=3.1e+05 flops=8.6e+07
 sigma_tot[gemm] counter=23 i=2 t=3.2e-03 per=6.8e+00 cost=2.8e+05 flops=8.8e+07
 sigma_tot[gemm] counter=23 i=3 t=3.2e-03 per=6.8e+00 cost=2.8e+05 flops=8.9e+07
 sigma_tot[gemm] counter=23 i=4 t=6.1e-03 per=1.3e+01 cost=8.4e+05 flops=1.4e+08
 sigma_tot[gemm] counter=23 i=5 t=6.2e-03 per=1.3e+01 cost=8.4e+05 flops=1.4e+08
 sigma_tot[gemm] counter=23 i=6 t=5.6e-03 per=1.2e+01 cost=7.2e+05 flops=1.3e+08
 sigma_tot[gemm] counter=23 i=7 t=5.5e-03 per=1.2e+01 cost=7.2e+05 flops=1.3e+08
 sigma_tot[gemm] counter=23 total t=3.7e-02 per=7.9e+01 cost=4.3e+06 flops=1.2e+08
 sigma_tot[red] counter=23 t=5.7e-03 per=1.2e+01 cost=1.1e+06 flops=1.9e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.6e-05,3.5e-06,1.2e-06,2.2e-07
    4   0 -      -3.235802251328 -5.255e-07  4.403e-04    3     4  2.577e-02 6.442e-03 1.313e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.188e-05,1.166e-04,8.739e-04,1.856e-04,1.204e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.188e-05 speed=3.882e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=8.7e-04 t_reduction=1.9e-04 tot=1.2e-03 ---
 sigma[inter] counter=24 t=1.2e-04 per=9.9e+00 cost=1.5e+04 flops=1.3e+08
 sigma[gemm] counter=24 i=0 t=9.4e-05 per=8.0e+00 cost=3.2e+03 flops=3.4e+07
 sigma[gemm] counter=24 i=1 t=9.1e-05 per=7.8e+00 cost=3.3e+03 flops=3.6e+07
 sigma[gemm] counter=24 i=2 t=9.6e-05 per=8.1e+00 cost=3.9e+03 flops=4.1e+07
 sigma[gemm] counter=24 i=3 t=1.1e-04 per=9.5e+00 cost=4.0e+03 flops=3.6e+07
 sigma[gemm] counter=24 i=4 t=1.5e-04 per=1.3e+01 cost=9.8e+03 flops=6.6e+07
 sigma[gemm] counter=24 i=5 t=1.6e-04 per=1.3e+01 cost=9.8e+03 flops=6.4e+07
 sigma[gemm] counter=24 i=6 t=8.8e-05 per=7.5e+00 cost=4.0e+03 flops=4.6e+07
 sigma[gemm] counter=24 i=7 t=8.8e-05 per=7.5e+00 cost=3.9e+03 flops=4.4e+07
 sigma[gemm] counter=24 total t=8.7e-04 per=7.4e+01 cost=4.2e+04 flops=4.8e+07
 sigma[red] counter=24 t=1.9e-04 per=1.6e+01 cost=1.3e+04 flops=6.9e+07
--- TIMING FOR sigma_tot : t_inter=4.2e-03 t_gemm=3.8e-02 t_reduction=5.9e-03 tot=4.8e-02 ---
 sigma_tot[inter] counter=24 t=4.2e-03 per=8.8e+00 cost=7.9e+05 flops=1.9e+08
 sigma_tot[gemm] counter=24 i=0 t=3.8e-03 per=7.9e+00 cost=3.1e+05 flops=8.2e+07
 sigma_tot[gemm] counter=24 i=1 t=3.7e-03 per=7.6e+00 cost=3.1e+05 flops=8.5e+07
 sigma_tot[gemm] counter=24 i=2 t=3.3e-03 per=6.9e+00 cost=2.9e+05 flops=8.7e+07
 sigma_tot[gemm] counter=24 i=3 t=3.3e-03 per=6.8e+00 cost=2.9e+05 flops=8.7e+07
 sigma_tot[gemm] counter=24 i=4 t=6.2e-03 per=1.3e+01 cost=8.5e+05 flops=1.4e+08
 sigma_tot[gemm] counter=24 i=5 t=6.3e-03 per=1.3e+01 cost=8.5e+05 flops=1.3e+08
 sigma_tot[gemm] counter=24 i=6 t=5.7e-03 per=1.2e+01 cost=7.2e+05 flops=1.3e+08
 sigma_tot[gemm] counter=24 i=7 t=5.5e-03 per=1.2e+01 cost=7.2e+05 flops=1.3e+08
 sigma_tot[gemm] counter=24 total t=3.8e-02 per=7.9e+01 cost=4.3e+06 flops=1.1e+08
 sigma_tot[red] counter=24 t=5.9e-03 per=1.2e+01 cost=1.1e+06 flops=1.9e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.6e-05,3.6e-06,1.2e-06,2.5e-07
    5   0 -      -3.235802390189 -1.389e-07  2.066e-04    3     5  3.494e-02 6.988e-03 1.326e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.173e-05,1.157e-04,8.722e-04,1.850e-04,1.201e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.173e-05 speed=3.908e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=8.7e-04 t_reduction=1.8e-04 tot=1.2e-03 ---
 sigma[inter] counter=25 t=1.2e-04 per=9.9e+00 cost=1.5e+04 flops=1.3e+08
 sigma[gemm] counter=25 i=0 t=9.3e-05 per=8.0e+00 cost=3.2e+03 flops=3.4e+07
 sigma[gemm] counter=25 i=1 t=1.0e-04 per=8.7e+00 cost=3.3e+03 flops=3.2e+07
 sigma[gemm] counter=25 i=2 t=9.8e-05 per=8.3e+00 cost=3.9e+03 flops=4.0e+07
 sigma[gemm] counter=25 i=3 t=9.6e-05 per=8.2e+00 cost=4.0e+03 flops=4.2e+07
 sigma[gemm] counter=25 i=4 t=1.5e-04 per=1.3e+01 cost=9.8e+03 flops=6.6e+07
 sigma[gemm] counter=25 i=5 t=1.6e-04 per=1.3e+01 cost=9.8e+03 flops=6.3e+07
 sigma[gemm] counter=25 i=6 t=8.9e-05 per=7.6e+00 cost=4.0e+03 flops=4.5e+07
 sigma[gemm] counter=25 i=7 t=8.8e-05 per=7.5e+00 cost=3.9e+03 flops=4.4e+07
 sigma[gemm] counter=25 total t=8.7e-04 per=7.4e+01 cost=4.2e+04 flops=4.8e+07
 sigma[red] counter=25 t=1.8e-04 per=1.6e+01 cost=1.3e+04 flops=7.0e+07
--- TIMING FOR sigma_tot : t_inter=4.3e-03 t_gemm=3.9e-02 t_reduction=6.1e-03 tot=4.9e-02 ---
 sigma_tot[inter] counter=25 t=4.3e-03 per=8.8e+00 cost=8.1e+05 flops=1.9e+08
 sigma_tot[gemm] counter=25 i=0 t=3.9e-03 per=7.9e+00 cost=3.1e+05 flops=8.1e+07
 sigma_tot[gemm] counter=25 i=1 t=3.8e-03 per=7.7e+00 cost=3.1e+05 flops=8.3e+07
 sigma_tot[gemm] counter=25 i=2 t=3.4e-03 per=6.9e+00 cost=2.9e+05 flops=8.6e+07
 sigma_tot[gemm] counter=25 i=3 t=3.4e-03 per=6.9e+00 cost=2.9e+05 flops=8.6e+07
 sigma_tot[gemm] counter=25 i=4 t=6.4e-03 per=1.3e+01 cost=8.6e+05 flops=1.3e+08
 sigma_tot[gemm] counter=25 i=5 t=6.5e-03 per=1.3e+01 cost=8.6e+05 flops=1.3e+08
 sigma_tot[gemm] counter=25 i=6 t=5.8e-03 per=1.2e+01 cost=7.3e+05 flops=1.3e+08
 sigma_tot[gemm] counter=25 i=7 t=5.6e-03 per=1.1e+01 cost=7.3e+05 flops=1.3e+08
 sigma_tot[gemm] counter=25 total t=3.9e-02 per=7.9e+01 cost=4.4e+06 flops=1.1e+08
 sigma_tot[red] counter=25 t=6.1e-03 per=1.2e+01 cost=1.1e+06 flops=1.8e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.2e-06,1.6e-05,3.5e-06,1.2e-06,2.3e-07
    6   0 -      -3.235802417590 -2.740e-08  1.125e-04    3     6  4.410e-02 7.349e-03 1.336e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.177e-05,1.252e-04,8.454e-04,1.991e-04,1.198e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.177e-05 speed=3.901e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=8.4e-04 t_reduction=2.0e-04 tot=1.2e-03 ---
 sigma[inter] counter=26 t=1.2e-04 per=1.1e+01 cost=1.5e+04 flops=1.2e+08
 sigma[gemm] counter=26 i=0 t=9.4e-05 per=8.0e+00 cost=3.2e+03 flops=3.4e+07
 sigma[gemm] counter=26 i=1 t=9.1e-05 per=7.8e+00 cost=3.3e+03 flops=3.7e+07
 sigma[gemm] counter=26 i=2 t=9.5e-05 per=8.1e+00 cost=3.9e+03 flops=4.1e+07
 sigma[gemm] counter=26 i=3 t=9.7e-05 per=8.3e+00 cost=4.0e+03 flops=4.1e+07
 sigma[gemm] counter=26 i=4 t=1.5e-04 per=1.3e+01 cost=9.8e+03 flops=6.7e+07
 sigma[gemm] counter=26 i=5 t=1.4e-04 per=1.2e+01 cost=9.8e+03 flops=6.8e+07
 sigma[gemm] counter=26 i=6 t=8.8e-05 per=7.6e+00 cost=4.0e+03 flops=4.5e+07
 sigma[gemm] counter=26 i=7 t=8.8e-05 per=7.5e+00 cost=3.9e+03 flops=4.4e+07
 sigma[gemm] counter=26 total t=8.4e-04 per=7.2e+01 cost=4.2e+04 flops=5.0e+07
 sigma[red] counter=26 t=2.0e-04 per=1.7e+01 cost=1.3e+04 flops=6.5e+07
--- TIMING FOR sigma_tot : t_inter=4.4e-03 t_gemm=3.9e-02 t_reduction=6.3e-03 tot=5.0e-02 ---
 sigma_tot[inter] counter=26 t=4.4e-03 per=8.9e+00 cost=8.2e+05 flops=1.8e+08
 sigma_tot[gemm] counter=26 i=0 t=4.0e-03 per=7.9e+00 cost=3.2e+05 flops=8.0e+07
 sigma_tot[gemm] counter=26 i=1 t=3.9e-03 per=7.7e+00 cost=3.2e+05 flops=8.2e+07
 sigma_tot[gemm] counter=26 i=2 t=3.5e-03 per=6.9e+00 cost=2.9e+05 flops=8.5e+07
 sigma_tot[gemm] counter=26 i=3 t=3.5e-03 per=6.9e+00 cost=2.9e+05 flops=8.5e+07
 sigma_tot[gemm] counter=26 i=4 t=6.5e-03 per=1.3e+01 cost=8.7e+05 flops=1.3e+08
 sigma_tot[gemm] counter=26 i=5 t=6.6e-03 per=1.3e+01 cost=8.6e+05 flops=1.3e+08
 sigma_tot[gemm] counter=26 i=6 t=5.9e-03 per=1.2e+01 cost=7.3e+05 flops=1.2e+08
 sigma_tot[gemm] counter=26 i=7 t=5.7e-03 per=1.1e+01 cost=7.3e+05 flops=1.3e+08
 sigma_tot[gemm] counter=26 total t=3.9e-02 per=7.9e+01 cost=4.4e+06 flops=1.1e+08
 sigma_tot[red] counter=26 t=6.3e-03 per=1.2e+01 cost=1.1e+06 flops=1.8e+08
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.6e-05,3.5e-06,1.2e-06,2.8e-07
    7   0 +      -3.235802424524 -6.933e-09  4.929e-05    3     7  5.323e-02 7.605e-03 1.341e-03
TIMING FOR Davidson : 5.324e-02  T(cal/comm/rest)=9.388e-03,9.700e-07,4.386e-02
decomposed t_rest=4.386e-02
 T(sub)    =1.590e-04 per=3.625e-01
 T(precond)=4.352e-02 per=9.923e+01
 T(ortho)  =1.958e-05 per=4.465e-02
 T(xcopy)  =9.480e-07 per=2.162e-03
 T(xnrm2)  =3.296e-06 per=7.516e-03
 T(other)  =1.550e-04 per=3.535e-01
optimized energies: isweep=0 ibond=5 dots=2 e[0]=-3.235802424524 nmvp=7
CPUmem: VM:1.959e+01GB RSS:1.838e+00GB  Timing: User:1.059e+02S Sys:1.394e+00S Total:1.073e+02S
ctns::twodot_renorm superblock=c2r (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep0_ibond5.txt
 qbond: qsuper nsym=11 dimAll=36
 (3,1):7 (2,0):3 (4,0):7 (1,1):1 (2,2):2 (4,2):5 (5,1):6 (6,0):2 (6,2):1 (3,3):1 (5,3):1
----- TMING FOR decimation_genbasis(su2): 6.7e-03 S -----
decimation summary: 36->10 dwt=+0.000e+00 SvN=6.956e-01
 qbond: qkept nsym=6 dimAll=10
 (4,0):3 (3,1):2 (5,1):2 (2,0):1 (4,2):1 (6,0):1
----- TIMING for decimation_row(nkr): 7.175e-03 S T(decim/select/formRot)=6.774e-03,2.935e-04,1.067e-04 -----
----- TIMING FOR twodot_decimation: 8.086e-03 S T(wf/decim)=7.850e-04,7.301e-03 -----
ctns::oper_renorm coord=(2,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:4 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
CPUmem: VM:1.959e+01GB RSS:1.838e+00GB  Timing: User:1.071e+02S Sys:1.396e+00S Total:1.085e+02S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=17 : 5.696e-04 S -----
rank=0 GPUmem(GB): used=8.12e-06 (oper)=6.21e-06
rank=0 GPUmem(GB): used=8.55e-06 (oper,site)(GB)=6.21e-06,4.25e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=17
 no. of rintermediate operators=22
 no. of coefficients=66:0.000504MB:4.92e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.997e-05 S -----
rank=0 GPUmem(GB): used=9.04e-06 (oper,site,rinter)=6.21e-06,4.25e-07,4.92e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0111 S size(rtasks)=17 size(Rlst2)=36 T(Rmu/Rlist)=0.000164,0.011 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0112 S size(rtasks)=17 size(Rlst)=848 -----
rank=0 GPUmem(GB): used=9.04e-06 (oper,site,rinter,batch)=6.21e-06,4.25e-07,4.92e-07,0.000158 blksize=9 blksize0=6 batchsize=848
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.61e-05,0.000964,0.000229
--- TIMING FOR renorm : t_inter=9.6e-05 t_gemm=9.6e-04 t_reduction=2.3e-04 tot=1.3e-03 ---
 renorm[inter] counter=6 t=9.6e-05 per=7.4e+00 cost=5.4e+03 flops=5.7e+07
 renorm[gemm] counter=6 i=0 t=9.1e-05 per=7.1e+00 cost=1.9e+03 flops=2.1e+07
 renorm[gemm] counter=6 i=1 t=8.3e-05 per=6.5e+00 cost=2.8e+03 flops=3.3e+07
 renorm[gemm] counter=6 i=2 t=2.3e-04 per=1.8e+01 cost=3.8e+03 flops=1.7e+07
 renorm[gemm] counter=6 i=3 t=2.7e-04 per=2.1e+01 cost=6.9e+03 flops=2.5e+07
 renorm[gemm] counter=6 i=4 t=1.3e-06 per=1.0e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=5 t=1.2e-06 per=9.5e-02 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=6 t=2.9e-04 per=2.2e+01 cost=1.3e+04 flops=4.4e+07
 renorm[gemm] counter=6 total t=9.6e-04 per=7.5e+01 cost=2.8e+04 flops=2.9e+07
 renorm[red] counter=6 t=2.3e-04 per=1.8e+01 cost=6.2e+03 flops=2.7e+07
--- TIMING FOR renorm_tot : t_inter=4.1e-04 t_gemm=5.6e-03 t_reduction=1.8e-03 tot=7.8e-03 ---
 renorm_tot[inter] counter=6 t=4.1e-04 per=5.3e+00 cost=1.9e+04 flops=4.5e+07
 renorm_tot[gemm] counter=6 i=0 t=5.5e-04 per=7.1e+00 cost=1.0e+04 flops=1.9e+07
 renorm_tot[gemm] counter=6 i=1 t=1.5e-03 per=1.9e+01 cost=1.4e+04 flops=9.8e+06
 renorm_tot[gemm] counter=6 i=2 t=5.2e-04 per=6.6e+00 cost=1.0e+04 flops=2.0e+07
 renorm_tot[gemm] counter=6 i=3 t=6.2e-04 per=7.9e+00 cost=1.6e+04 flops=2.6e+07
 renorm_tot[gemm] counter=6 i=4 t=5.6e-04 per=7.1e+00 cost=1.1e+04 flops=2.0e+07
 renorm_tot[gemm] counter=6 i=5 t=5.6e-04 per=7.1e+00 cost=1.5e+04 flops=2.7e+07
 renorm_tot[gemm] counter=6 i=6 t=1.3e-03 per=1.7e+01 cost=6.9e+04 flops=5.2e+07
 renorm_tot[gemm] counter=6 total t=5.6e-03 per=7.1e+01 cost=1.5e+05 flops=2.6e+07
 renorm_tot[red] counter=6 t=1.8e-03 per=2.4e+01 cost=3.7e+04 flops=2.0e+07
qops.to_cpu: size(tot)=281:2.1e-03MB:2.1e-06GB t[to_cpu]=1.4e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=6.889e-16 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0194 S rank=0 -----
CPUmem: VM:1.959e+01GB RSS:1.838e+00GB  Timing: User:1.076e+02S Sys:1.396e+00S Total:1.090e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=20:1.526e-04MB:1.490e-07GB
total mem of comb=181:1.381e-03MB:1.349e-06GB
CPUmem: VM:1.959e+01GB RSS:1.838e+00GB  Timing: User:1.076e+02S Sys:1.396e+00S Total:1.090e+02S
##### local opt: 1.577e-01 S #####
 T(local opt: fetch) = 2.686e-04 S  per = 0.17  per(accum) = 0.17
 T(local opt: hdiag) = 1.929e-03 S  per = 1.22  per(accum) = 1.39
 T(local opt: dvdsn) = 1.262e-01 S  per =   80  per(accum) = 81.4
 T(local opt: decim) = 8.119e-03 S  per = 5.15  per(accum) = 86.5
 T(local opt: guess) = 9.940e-04 S  per = 0.63  per(accum) = 87.2
 T(local opt: renrm) = 1.997e-02 S  per = 12.7  per(accum) = 99.8
 T(local opt: save ) = 2.470e-04 S  per = 0.157  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.262e-01 S  T(sum) = 1.259e-01 S  per = 9.979e+01
 T(local opt: preprocess                  ) = 3.645e-03 S  per =  2.9  per(accum) = 2.9
 T(local opt: symbolic_formulae           ) = 9.963e-04 S  per = 0.791  per(accum) = 3.69
 T(local opt: hintermediate init          ) = 6.144e-05 S  per = 0.0488  per(accum) = 3.74
 T(local opt: preprocess_hformulae_Hxlist ) = 4.849e-02 S  per = 38.5  per(accum) = 42.3
 T(local opt: hmmtasks init               ) = 1.822e-02 S  per = 14.5  per(accum) = 56.7
 T(local opt: initial guess for dvdson    ) = 1.225e-03 S  per = 0.973  per(accum) = 57.7
 T(local opt: dvdson solver [Hx_batchGPU] ) = 9.233e-03 S  per = 7.33  per(accum) = 65
 T(local opt: dvdson solver [comm(gpu)]   ) = 1.544e-04 S  per = 0.123  per(accum) = 65.2
 T(local opt: dvdson solver [comm(cpu)]   ) = 9.700e-07 S  per = 0.000771  per(accum) = 65.2
 T(local opt: dvdson solver [rest part]   ) = 4.386e-02 S  per = 34.8  per(accum) = 100
Detailed decomposition of T(renrm) = 1.997e-02 S  T(sum) = 1.997e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.704e-04 S  per = 1.85  per(accum) = 1.85
 T(local opt: qops init                    ) = 9.760e-04 S  per = 4.89  per(accum) = 6.74
 T(local opt: symbolic_formulae_renorm     ) = 5.787e-04 S  per =  2.9  per(accum) = 9.64
 T(local opt: allocate qops on gpu         ) = 2.484e-05 S  per = 0.124  per(accum) = 9.76
 T(local opt: site memcpy cpu2gpu          ) = 6.253e-05 S  per = 0.313  per(accum) = 10.1
 T(local opt: rintermediate init           ) = 6.046e-05 S  per = 0.303  per(accum) = 10.4
 T(local opt: preprocess_formulae_Rlist2   ) = 1.124e-02 S  per = 56.3  per(accum) = 66.7
 T(local opt: rmmtasks init                ) = 4.988e-03 S  per =   25  per(accum) = 91.6
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 0.000165  per(accum) = 91.6
 T(local opt: preprocess_renorm_batchGPU   ) = 1.391e-03 S  per = 6.97  per(accum) = 98.6
 T(local opt: reduction of opS & opH [nccl]) = 1.146e-06 S  per = 0.00574  per(accum) = 98.6
 T(local opt: qops memcpy gpu2cpu          ) = 1.994e-05 S  per = 0.0999  per(accum) = 98.7
 T(local opt: deallocate cpu and gpu memory) = 1.042e-05 S  per = 0.0522  per(accum) = 98.8
 T(local opt: reduction of opS & opH [comm]) = 7.679e-05 S  per = 0.385  per(accum) = 99.2
 T(local opt: conversion from opAB to opPQ ) = 3.777e-06 S  per = 0.0189  per(accum) = 99.2
 T(local opt: after oper_renorm            ) = 1.657e-04 S  per = 0.83  per(accum) = 100
##### sweep opt: 1.497e+00 S #####
 T(sweep opt: fetch) = 5.180e-03 S  per = 0.346  per(accum) = 0.346
 T(sweep opt: hdiag) = 1.708e-02 S  per = 1.14  per(accum) = 1.49
 T(sweep opt: dvdsn) = 1.008e+00 S  per = 67.3  per(accum) = 68.8
 T(sweep opt: decim) = 4.986e-02 S  per = 3.33  per(accum) = 72.1
 T(sweep opt: guess) = 8.252e-03 S  per = 0.551  per(accum) = 72.7
 T(sweep opt: renrm) = 3.986e-01 S  per = 26.6  per(accum) = 99.3
 T(sweep opt: save ) = 1.026e-02 S  per = 0.685  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.008e+00 S  T(sum) = 1.006e+00 S  per = 9.978e+01
 T(sweep opt: preprocess                  ) = 3.078e-02 S  per = 3.06  per(accum) = 3.06
 T(sweep opt: symbolic_formulae           ) = 7.563e-03 S  per = 0.752  per(accum) = 3.81
 T(sweep opt: hintermediate init          ) = 4.216e-04 S  per = 0.0419  per(accum) = 3.85
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.368e-01 S  per = 53.4  per(accum) = 57.2
 T(sweep opt: hmmtasks init               ) = 2.429e-01 S  per = 24.1  per(accum) = 81.4
 T(sweep opt: initial guess for dvdson    ) = 9.322e-03 S  per = 0.927  per(accum) = 82.3
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 5.495e-02 S  per = 5.46  per(accum) = 87.8
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 6.117e-04 S  per = 0.0608  per(accum) = 87.8
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 3.992e-06 S  per = 0.000397  per(accum) = 87.8
 T(sweep opt: dvdson solver [rest part]   ) = 1.226e-01 S  per = 12.2  per(accum) = 100
Detailed decomposition of T(renrm) = 3.986e-01 S  T(sum) = 3.986e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 3.316e-03 S  per = 0.832  per(accum) = 0.832
 T(sweep opt: qops init                    ) = 7.311e-03 S  per = 1.83  per(accum) = 2.67
 T(sweep opt: symbolic_formulae_renorm     ) = 3.709e-03 S  per = 0.931  per(accum) = 3.6
 T(sweep opt: allocate qops on gpu         ) = 1.721e-04 S  per = 0.0432  per(accum) = 3.64
 T(sweep opt: site memcpy cpu2gpu          ) = 2.951e-04 S  per = 0.074  per(accum) = 3.71
 T(sweep opt: rintermediate init           ) = 4.642e-04 S  per = 0.116  per(accum) = 3.83
 T(sweep opt: preprocess_formulae_Rlist2   ) = 6.571e-02 S  per = 16.5  per(accum) = 20.3
 T(sweep opt: rmmtasks init                ) = 2.881e-02 S  per = 7.23  per(accum) = 27.5
 T(sweep opt: qops memset on cpu           ) = 1.930e-07 S  per = 4.84e-05  per(accum) = 27.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 8.455e-03 S  per = 2.12  per(accum) = 29.7
 T(sweep opt: reduction of opS & opH [nccl]) = 6.787e-06 S  per = 0.0017  per(accum) = 29.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.219e-04 S  per = 0.0306  per(accum) = 29.7
 T(sweep opt: deallocate cpu and gpu memory) = 6.403e-05 S  per = 0.0161  per(accum) = 29.7
 T(sweep opt: reduction of opS & opH [comm]) = 4.648e-04 S  per = 0.117  per(accum) = 29.8
 T(sweep opt: conversion from opAB to opPQ ) = 2.781e-01 S  per = 69.8  per(accum) = 99.6
 T(sweep opt: after oper_renorm            ) = 1.554e-03 S  per = 0.39  per(accum) = 100
##### global opt: 1.497e+00 S #####
 T(global opt: fetch) = 5.180e-03 S  per = 0.346  per(accum) = 0.346
 T(global opt: hdiag) = 1.708e-02 S  per = 1.14  per(accum) = 1.49
 T(global opt: dvdsn) = 1.008e+00 S  per = 67.3  per(accum) = 68.8
 T(global opt: decim) = 4.986e-02 S  per = 3.33  per(accum) = 72.1
 T(global opt: guess) = 8.252e-03 S  per = 0.551  per(accum) = 72.7
 T(global opt: renrm) = 3.986e-01 S  per = 26.6  per(accum) = 99.3
 T(global opt: save ) = 1.026e-02 S  per = 0.685  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.008e+00 S  T(sum) = 1.006e+00 S  per = 9.978e+01
 T(global opt: preprocess                  ) = 3.078e-02 S  per = 3.06  per(accum) = 3.06
 T(global opt: symbolic_formulae           ) = 7.563e-03 S  per = 0.752  per(accum) = 3.81
 T(global opt: hintermediate init          ) = 4.216e-04 S  per = 0.0419  per(accum) = 3.85
 T(global opt: preprocess_hformulae_Hxlist ) = 5.368e-01 S  per = 53.4  per(accum) = 57.2
 T(global opt: hmmtasks init               ) = 2.429e-01 S  per = 24.1  per(accum) = 81.4
 T(global opt: initial guess for dvdson    ) = 9.322e-03 S  per = 0.927  per(accum) = 82.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 5.495e-02 S  per = 5.46  per(accum) = 87.8
 T(global opt: dvdson solver [comm(gpu)]   ) = 6.117e-04 S  per = 0.0608  per(accum) = 87.8
 T(global opt: dvdson solver [comm(cpu)]   ) = 3.992e-06 S  per = 0.000397  per(accum) = 87.8
 T(global opt: dvdson solver [rest part]   ) = 1.226e-01 S  per = 12.2  per(accum) = 100
Detailed decomposition of T(renrm) = 3.986e-01 S  T(sum) = 3.986e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.316e-03 S  per = 0.832  per(accum) = 0.832
 T(global opt: qops init                    ) = 7.311e-03 S  per = 1.83  per(accum) = 2.67
 T(global opt: symbolic_formulae_renorm     ) = 3.709e-03 S  per = 0.931  per(accum) = 3.6
 T(global opt: allocate qops on gpu         ) = 1.721e-04 S  per = 0.0432  per(accum) = 3.64
 T(global opt: site memcpy cpu2gpu          ) = 2.951e-04 S  per = 0.074  per(accum) = 3.71
 T(global opt: rintermediate init           ) = 4.642e-04 S  per = 0.116  per(accum) = 3.83
 T(global opt: preprocess_formulae_Rlist2   ) = 6.571e-02 S  per = 16.5  per(accum) = 20.3
 T(global opt: rmmtasks init                ) = 2.881e-02 S  per = 7.23  per(accum) = 27.5
 T(global opt: qops memset on cpu           ) = 1.930e-07 S  per = 4.84e-05  per(accum) = 27.5
 T(global opt: preprocess_renorm_batchGPU   ) = 8.455e-03 S  per = 2.12  per(accum) = 29.7
 T(global opt: reduction of opS & opH [nccl]) = 6.787e-06 S  per = 0.0017  per(accum) = 29.7
 T(global opt: qops memcpy gpu2cpu          ) = 1.219e-04 S  per = 0.0306  per(accum) = 29.7
 T(global opt: deallocate cpu and gpu memory) = 6.403e-05 S  per = 0.0161  per(accum) = 29.7
 T(global opt: reduction of opS & opH [comm]) = 4.648e-04 S  per = 0.117  per(accum) = 29.8
 T(global opt: conversion from opAB to opPQ ) = 2.781e-01 S  per = 69.8  per(accum) = 99.6
 T(global opt: after oper_renorm            ) = 1.554e-03 S  per = 0.39  per(accum) = 100

======================================================================
sweep_data::summary isweep=0 mpisize=1 maxthreads=112
----------------------------------------------------------------------
sweep parameters: isweep=0 dots=2 dcut=10 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=10 dwt=+1.110e-16 nmvp=1 e[0]=-3.236066249237 t=0.228
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=10 dwt=+1.399e-04 nmvp=2 e[0]=-3.236066272912 t=0.322
 ibond=2 bond=(3,0)-(4,0) forward=1 deff=10 dwt=-2.220e-16 nmvp=6 e[0]=-3.235797901320 t=0.164
 ibond=3 bond=(3,0)-(4,0) forward=0 deff=10 dwt=+0.000e+00 nmvp=1 e[0]=-3.235797901320 t=0.098
 ibond=4 bond=(2,0)-(3,0) forward=0 deff=10 dwt=+1.400e-04 nmvp=9 e[0]=-3.236066278078 t=0.528
 ibond=5 bond=(1,0)-(2,0) forward=0 deff=10 dwt=+0.000e+00 nmvp=7 e[0]=-3.235802424524 t=0.158
 eav_max=-3.235797901320 [ibond=2]  dwt_min=-2.220e-16 [ibond=2]
 eav_min=-3.236066278078 [ibond=4]  dwt_max=1.400e-04 [ibond=4]
 eav_diff=0.000268376758
 sweep energies: isweep=0 dots=2 dcut=10 deff=10 dwt=+1.400e-04 e[0]=-3.236066278078
----------------------------------------------------------------------
summary of sweep optimization up to isweep=0 mpisize=1 maxthreads=112
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.000e-04 0.000e+00 | 26 | 1.505e+00 | 1.505e+00 | 4.857e-03 4.506e-02 8.121e-03 5.804e-02 3.86
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +1.400e-04 e[0]=-3.236066278078 (0.000e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep0_su2
----------------------------------------------------------------------

ctns::sweep_final_LCR2CRR: convert [LC]R => [CR]R
ctns::decimation_row ifab=0 iftrunc=1 dcut=4 nqr=10 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_C0R1.txt
 qbond: qsuper nsym=10 dimAll=35
 (4,0):6 (3,1):3 (5,1):8 (2,0):1 (4,2):3 (6,0):6 (7,1):3 (6,2):3 (8,0):1 (5,3):1
----- TMING FOR decimation_genbasis(su2): 4.684e-03 S -----
decimation summary: 35->3 dwt=+1.110e-16 SvN=8.551e-01
 qbond: qkept nsym=3 dimAll=3
 (4,0):1 (5,1):1 (6,0):1
----- TIMING for decimation_row(nkr): 5.158e-03 S T(decim/select/formRot)=4.737e-03,3.675e-04,5.387e-05 -----

ctns::sweep_final_CR2cRR: convert [C]R => [cR]R
ctns::decimation_row ifab=0 iftrunc=1 dcut=1 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep0_cR0.txt
 qbond: qsuper nsym=6 dimAll=10
 (4,0):1 (5,1):2 (6,0):3 (7,1):2 (8,0):1 (6,2):1
----- TMING FOR decimation_genbasis(su2): 8.152e-03 S -----
decimation summary: 10->1 dwt=+0.000e+00 SvN=0.000e+00
 qbond: qkept nsym=1 dimAll=1
 (6,0):1
----- TIMING for decimation_row(nkr): 8.441e-03 S T(decim/select/formRot)=8.191e-03,2.299e-04,1.989e-05 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep0_su2

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(5,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=1 node=(4,0) Drow=10 maxdiff=4.541e-16 deviate=0
 idx=2 node=(3,0) Drow=10 maxdiff=1.856e-15 deviate=0
 idx=3 node=(2,0) Drow=10 maxdiff=1.222e-15 deviate=0
 idx=4 node=(1,0) Drow=3 maxdiff=4.441e-16 deviate=0
 idx=5 node=(0,0) Drow=1 maxdiff=0.000e+00 deviate=0
qtensor2: wf2 own=1 _data=0x4e4e77a0
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (6,0):1
 qbond: qcol nsym=1 dimAll=1
 (6,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 block[0:(6,0),0:(6,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x4e4e77a0
      1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=4.4409e-16 deviate=0
----- TIMING FOR ctns::rcanon_check : 1.562e-03 S -----

ctns::oper_final - build Hmat for RCF at isweep=0

coord=(1,0)
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=95:0.000725MB:7.08e-07GB
 rqops: oplist=CSHPQ nops=C:4 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=10,10 size(op)=20:0.000153MB size(tot)=281:0.00214MB:2.09e-06GB
ctns::oper_renorm coord=(1,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:5 S:1 H:1 P:1 Q:2 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=20:0.000153MB:1.49e-07GB
CPUmem: VM:1.972e+01GB RSS:1.838e+00GB  Timing: User:1.094e+02S Sys:1.400e+00S Total:1.108e+02S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=10 : 3.260e-04 S -----
rank=0 GPUmem(GB): used=3.66e-06 (oper)=2.95e-06
rank=0 GPUmem(GB): used=3.81e-06 (oper,site)(GB)=2.95e-06,1.49e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=10
 no. of rintermediate operators=8
 no. of coefficients=32:0.000244MB:2.38e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.341e-05 S -----
rank=0 GPUmem(GB): used=4.05e-06 (oper,site,rinter)=2.95e-06,1.49e-07,2.38e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00317 S size(rtasks)=10 size(Rlst2)=9 T(Rmu/Rlist)=8.48e-05,0.00309 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00321 S size(rtasks)=10 size(Rlst)=291 -----
rank=0 GPUmem(GB): used=4.05e-06 (oper,site,rinter,batch)=2.95e-06,1.49e-07,2.38e-07,2.82e-05 blksize=3 blksize0=6 batchsize=291
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.17e-05,0.0004,0.000126
--- TIMING FOR renorm : t_inter=8.1e-05 t_gemm=4.0e-04 t_reduction=1.3e-04 tot=6.1e-04 ---
 renorm[inter] counter=7 t=8.1e-05 per=1.3e+01 cost=1.3e+03 flops=1.7e+07
 renorm[gemm] counter=7 i=0 t=6.6e-05 per=1.1e+01 cost=3.7e+02 flops=5.7e+06
 renorm[gemm] counter=7 i=1 t=6.7e-05 per=1.1e+01 cost=4.9e+02 flops=7.3e+06
 renorm[gemm] counter=7 i=2 t=9.6e-05 per=1.6e+01 cost=7.7e+02 flops=8.0e+06
 renorm[gemm] counter=7 i=3 t=9.9e-05 per=1.6e+01 cost=1.3e+03 flops=1.3e+07
 renorm[gemm] counter=7 i=4 t=1.3e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=5 t=1.3e-06 per=2.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=6 t=6.8e-05 per=1.1e+01 cost=1.2e+03 flops=1.7e+07
 renorm[gemm] counter=7 total t=4.0e-04 per=6.6e+01 cost=4.1e+03 flops=1.0e+07
 renorm[red] counter=7 t=1.3e-04 per=2.1e+01 cost=5.8e+02 flops=4.6e+06
--- TIMING FOR renorm_tot : t_inter=4.9e-04 t_gemm=6.0e-03 t_reduction=2.0e-03 tot=8.4e-03 ---
 renorm_tot[inter] counter=7 t=4.9e-04 per=5.8e+00 cost=2.0e+04 flops=4.0e+07
 renorm_tot[gemm] counter=7 i=0 t=6.2e-04 per=7.3e+00 cost=1.1e+04 flops=1.8e+07
 renorm_tot[gemm] counter=7 i=1 t=1.5e-03 per=1.8e+01 cost=1.5e+04 flops=9.7e+06
 renorm_tot[gemm] counter=7 i=2 t=6.1e-04 per=7.3e+00 cost=1.1e+04 flops=1.8e+07
 renorm_tot[gemm] counter=7 i=3 t=7.1e-04 per=8.5e+00 cost=1.7e+04 flops=2.4e+07
 renorm_tot[gemm] counter=7 i=4 t=5.6e-04 per=6.6e+00 cost=1.1e+04 flops=2.0e+07
 renorm_tot[gemm] counter=7 i=5 t=5.6e-04 per=6.6e+00 cost=1.5e+04 flops=2.7e+07
 renorm_tot[gemm] counter=7 i=6 t=1.4e-03 per=1.6e+01 cost=7.0e+04 flops=5.1e+07
 renorm_tot[gemm] counter=7 total t=6.0e-03 per=7.1e+01 cost=1.5e+05 flops=2.5e+07
 renorm_tot[red] counter=7 t=2.0e-03 per=2.3e+01 cost=3.8e+04 flops=1.9e+07
qops.to_cpu: size(tot)=20:1.5e-04MB:1.5e-07GB t[to_cpu]=1.4e-05S speed=1.1e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00655 S rank=0 -----

coord=(0,0)
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=95:0.000725MB:7.08e-07GB
 rqops: oplist=CSHPQ nops=C:5 S:1 H:1 P:1 Q:2 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=20:0.000153MB:1.49e-07GB
ctns::oper_renorm coord=(0,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:6 S:0 H:1 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
CPUmem: VM:1.972e+01GB RSS:1.838e+00GB  Timing: User:1.099e+02S Sys:1.400e+00S Total:1.113e+02S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=7 : 1.151e-04 S -----
rank=0 GPUmem(GB): used=1.57e-06 (oper)=8.64e-07
rank=0 GPUmem(GB): used=1.59e-06 (oper,site)(GB)=8.64e-07,2.24e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=7
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=1.59e-06 (oper,site,rinter)=8.64e-07,2.24e-08,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000418 S size(rtasks)=7 size(Rlst2)=1 T(Rmu/Rlist)=3.53e-05,0.000383 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000431 S size(rtasks)=7 size(Rlst)=46 -----
rank=0 GPUmem(GB): used=1.59e-06 (oper,site,rinter,batch)=8.64e-07,2.24e-08,0,1.03e-06 blksize=1 blksize0=0 batchsize=46
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.66e-06,0.000242,6.07e-05
--- TIMING FOR renorm : t_inter=7.4e-06 t_gemm=2.4e-04 t_reduction=6.1e-05 tot=3.1e-04 ---
 renorm[inter] counter=8 t=7.4e-06 per=2.4e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=0 t=5.9e-05 per=1.9e+01 cost=4.0e+01 flops=6.8e+05
 renorm[gemm] counter=8 i=1 t=4.8e-05 per=1.5e+01 cost=4.0e+01 flops=8.4e+05
 renorm[gemm] counter=8 i=2 t=4.4e-05 per=1.4e+01 cost=4.0e+01 flops=9.1e+05
 renorm[gemm] counter=8 i=3 t=4.2e-05 per=1.4e+01 cost=4.0e+01 flops=9.5e+05
 renorm[gemm] counter=8 i=4 t=1.3e-06 per=4.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=5 t=1.3e-06 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=6 t=4.6e-05 per=1.5e+01 cost=9.2e+01 flops=2.0e+06
 renorm[gemm] counter=8 total t=2.4e-04 per=7.8e+01 cost=2.5e+02 flops=1.0e+06
 renorm[red] counter=8 t=6.1e-05 per=2.0e+01 cost=9.2e+01 flops=1.5e+06
--- TIMING FOR renorm_tot : t_inter=5.0e-04 t_gemm=6.2e-03 t_reduction=2.0e-03 tot=8.8e-03 ---
 renorm_tot[inter] counter=8 t=5.0e-04 per=5.7e+00 cost=2.0e+04 flops=4.0e+07
 renorm_tot[gemm] counter=8 i=0 t=6.8e-04 per=7.8e+00 cost=1.1e+04 flops=1.6e+07
 renorm_tot[gemm] counter=8 i=1 t=1.6e-03 per=1.8e+01 cost=1.5e+04 flops=9.4e+06
 renorm_tot[gemm] counter=8 i=2 t=6.6e-04 per=7.5e+00 cost=1.1e+04 flops=1.7e+07
 renorm_tot[gemm] counter=8 i=3 t=7.6e-04 per=8.6e+00 cost=1.7e+04 flops=2.3e+07
 renorm_tot[gemm] counter=8 i=4 t=5.6e-04 per=6.4e+00 cost=1.1e+04 flops=2.0e+07
 renorm_tot[gemm] counter=8 i=5 t=5.6e-04 per=6.4e+00 cost=1.5e+04 flops=2.7e+07
 renorm_tot[gemm] counter=8 i=6 t=1.4e-03 per=1.6e+01 cost=7.0e+04 flops=4.9e+07
 renorm_tot[gemm] counter=8 total t=6.2e-03 per=7.1e+01 cost=1.5e+05 flops=2.4e+07
 renorm_tot[red] counter=8 t=2.0e-03 per=2.3e+01 cost=3.8e+04 flops=1.9e+07
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB t[to_cpu]=1.3e-05S speed=5.7e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
ctns::oper_ab2pq coord=(0,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00151 S rank=0 -----

matrix: Hmat_isweep0 size=(1,1)
     -3.235802424524e+00 

======================================================================
sweep parameters: isweep=1 dots=1 dcut=10 eps=0.0001 noise=0
======================================================================

ctns::sweep_init: nroots=1 sym_state=(6,0) singlet=0
qtensor3: site0new own=1 _data=0x4e8267c0
qinfo3su2: site0new sym=(0,0) dir=1,0,1 couple=0
 qbond: qrow nsym=1 dimAll=1
 (0,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=3 nblocks=9 size=3:2.28881835938e-05MB
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0MB:0GB
 sites: len=6 mem=160:0.001220703125MB:1.19209289551e-06GB
 rwfuns: len=1 mem=1:7.62939453125e-06MB:7.45058059692e-09GB
 cpsi: len=1 mem=20:0.000152587890625MB:1.49011611938e-07GB
total mem of comb=181:0.00138092041016MB:1.34855508804e-06GB

isweep=1 ibond=0/seqsize=6 dots=1 dbond=(1,0)-(2,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.972e+01GB RSS:1.838e+00GB  Timing: User:1.099e+02S Sys:1.401e+00S Total:1.113e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=20:1.526e-04MB:1.490e-07GB
total mem of comb=181:1.381e-03MB:1.349e-06GB
ctns::topology::check_partition: (sl,sr,sc)=1,4,1
 suppl= 0
 suppr= 2 3 4 5
 suppc= 1
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(0,0)
 fqop[1]=./scratch/sweep/rop(2,0)
 fqop[2]=./scratch/sweep/cop(1,0)
qops info: rank=0
 lqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 rqops: oplist=CSHPQ nops=C:4 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 qops(tot)=471:3.593e-03MB:3.509e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(1,0) fdel=./scratch/sweep/rop(2,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
wf3(diml,dimr,dimc)=(3,10,3) nnz=20:1.526e-04MB
qtensor3: wf3 own=1 _data=0x4b6a8ae0
qinfo3su2: wf3 sym=(6,0) dir=1,1,1 couple=1
 qbond: qrow nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qcol nsym=6 dimAll=10
 (4,0):3 (3,1):2 (5,1):2 (2,0):1 (4,2):1 (6,0):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=10 nblocks=63 size=20:1.526e-04MB
### DIAG TIMING: total=3.647e-04 t1=1.280e-05, t2=5.145e-05, t3=4.701e-05, t4=2.323e-04, t5=3.897e-06, t6=1.239e-05, t7=4.911e-06
duration_diagGPU:3.764e-04
duration_diagreduce:4.600e-08
duration_diagtransform:3.260e-07
----- TIMING FOR symbolic_formulae_onedot with size=36 : 4.406e-04 S -----
rank=0 GPUmem(GB): used=3.52e-06 (oper)=3.51e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=36
 no. of hintermediate operators=8
 no. of coefficients=32:0.000244MB:2.38e-07GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.577e-05 S -----
rank=0 GPUmem(GB): used=3.76e-06 (oper,hinter)=3.51e-06,2.38e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00468 S size(H_formulae)=36 size(Hxlst2)=10 T(Hmu/Hxlist)=7.72e-05,0.0046 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00473 S size(H_formulae)=36 size(Hxlst)=446 -----
rank=0 GPUmem(GB): used=4.73e-05 (oper,hinter,dvdson,batch)=3.51e-06,2.38e-07,2.98e-07,4.32e-05 blksize=3 blksize0=6 batchsize=446
ctns::pdvdsonSolver_nkr::solve_iter ndim=20 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.17e-05,7.79e-05,0.000452,0.000723,0.00128
 ndim=20:1.49e-07GB t[comm(intra)]=2.17e-05 speed=0.0137GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=7.8e-05 t_gemm=4.5e-04 t_reduction=7.2e-04 tot=1.3e-03 ---
 sigma[inter] counter=1 t=7.8e-05 per=6.2e+00 cost=2.7e+03 flops=3.5e+07
 sigma[gemm] counter=1 i=0 t=6.7e-05 per=5.4e+00 cost=5.9e+02 flops=8.8e+06
 sigma[gemm] counter=1 i=1 t=6.0e-05 per=4.8e+00 cost=5.9e+02 flops=9.9e+06
 sigma[gemm] counter=1 i=2 t=1.1e-04 per=8.7e+00 cost=1.5e+03 flops=1.4e+07
 sigma[gemm] counter=1 i=3 t=9.4e-05 per=7.5e+00 cost=1.5e+03 flops=1.6e+07
 sigma[gemm] counter=1 i=4 t=6.0e-05 per=4.8e+00 cost=5.9e+02 flops=9.8e+06
 sigma[gemm] counter=1 i=5 t=6.1e-05 per=4.9e+00 cost=5.9e+02 flops=9.6e+06
 sigma[gemm] counter=1 total t=4.5e-04 per=3.6e+01 cost=5.3e+03 flops=1.2e+07
 sigma[red] counter=1 t=7.2e-04 per=5.8e+01 cost=1.8e+03 flops=2.5e+06
--- TIMING FOR sigma_tot : t_inter=7.8e-05 t_gemm=4.5e-04 t_reduction=7.2e-04 tot=1.3e-03 ---
 sigma_tot[inter] counter=1 t=7.8e-05 per=6.2e+00 cost=2.7e+03 flops=3.5e+07
 sigma_tot[gemm] counter=1 i=0 t=6.7e-05 per=5.4e+00 cost=5.9e+02 flops=8.8e+06
 sigma_tot[gemm] counter=1 i=1 t=6.0e-05 per=4.8e+00 cost=5.9e+02 flops=9.9e+06
 sigma_tot[gemm] counter=1 i=2 t=1.1e-04 per=8.7e+00 cost=1.5e+03 flops=1.4e+07
 sigma_tot[gemm] counter=1 i=3 t=9.4e-05 per=7.5e+00 cost=1.5e+03 flops=1.6e+07
 sigma_tot[gemm] counter=1 i=4 t=6.0e-05 per=4.8e+00 cost=5.9e+02 flops=9.8e+06
 sigma_tot[gemm] counter=1 i=5 t=6.1e-05 per=4.9e+00 cost=5.9e+02 flops=9.6e+06
 sigma_tot[gemm] counter=1 total t=4.5e-04 per=3.6e+01 cost=5.3e+03 flops=1.2e+07
 sigma_tot[red] counter=1 t=7.2e-04 per=5.8e+01 cost=1.8e+03 flops=2.5e+06
T(sub)=9.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.7e-06,4.3e-06,2.0e-06,6.4e-07,1.9e-07
settings: ndim=20 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +      -3.235802424524 -1.003e+03  3.691e-05    1     1  1.406e-03 1.406e-03 1.382e-03
TIMING FOR Davidson : 1.423e-03  T(cal/comm/rest)=1.382e-03,1.620e-07,4.084e-05
decomposed t_rest=4.084e-05
 T(sub)    =9.766e-06 per=2.391e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =2.890e-07 per=7.076e-01
 T(xnrm2)  =3.820e-07 per=9.353e-01
 T(other)  =3.040e-05 per=7.444e+01
optimized energies: isweep=1 ibond=0 dots=1 e[0]=-3.235802424524 nmvp=1
CPUmem: VM:1.972e+01GB RSS:1.838e+00GB  Timing: User:1.099e+02S Sys:1.402e+00S Total:1.113e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=6 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep1_ibond0.txt
 qbond: qsuper nsym=6 dimAll=10
 (0,0):1 (2,0):3 (1,1):2 (4,0):1 (3,1):2 (2,2):1
----- TMING FOR decimation_genbasis(su2): 5.0e-03 S -----
decimation summary: 10->10 dwt=+1.110e-16 SvN=6.956e-01
 qbond: qkept nsym=6 dimAll=10
 (2,0):3 (1,1):2 (3,1):2 (0,0):1 (4,0):1 (2,2):1
----- TIMING for decimation_row(nkr): 5.423e-03 S T(decim/select/formRot)=5.065e-03,2.880e-04,7.012e-05 -----
----- TIMING FOR onedot_decimation: 5.690e-03 S T(wf/decim)=2.525e-04,5.437e-03 -----
ctns::oper_renorm coord=(1,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:2 S:4 H:1 A:4 B:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
CPUmem: VM:1.972e+01GB RSS:1.838e+00GB  Timing: User:1.107e+02S Sys:1.402e+00S Total:1.121e+02S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=17 : 3.768e-04 S -----
rank=0 GPUmem(GB): used=3.76e-06 (oper)=3.51e-06
rank=0 GPUmem(GB): used=3.9e-06 (oper,site)(GB)=3.51e-06,1.49e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=17
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=3.9e-06 (oper,site,rinter)=3.51e-06,1.49e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0042 S size(rtasks)=17 size(Rlst2)=36 T(Rmu/Rlist)=0.000112,0.00408 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00424 S size(rtasks)=17 size(Rlst)=326 -----
rank=0 GPUmem(GB): used=3.9e-06 (oper,site,rinter,batch)=3.51e-06,1.49e-07,0,4.61e-05 blksize=9 blksize0=0 batchsize=326
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.42e-06,0.000342,0.000144
--- TIMING FOR renorm : t_inter=8.1e-06 t_gemm=3.4e-04 t_reduction=1.4e-04 tot=4.9e-04 ---
 renorm[inter] counter=1 t=8.1e-06 per=1.6e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=0 t=7.7e-05 per=1.6e+01 cost=4.0e+02 flops=5.2e+06
 renorm[gemm] counter=1 i=1 t=5.8e-05 per=1.2e+01 cost=6.2e+02 flops=1.1e+07
 renorm[gemm] counter=1 i=2 t=1.4e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=3 t=1.3e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=1 i=4 t=5.9e-05 per=1.2e+01 cost=5.6e+02 flops=9.4e+06
 renorm[gemm] counter=1 i=5 t=5.5e-05 per=1.1e+01 cost=4.7e+02 flops=8.5e+06
 renorm[gemm] counter=1 i=6 t=8.9e-05 per=1.8e+01 cost=2.8e+03 flops=3.2e+07
 renorm[gemm] counter=1 total t=3.4e-04 per=6.9e+01 cost=4.9e+03 flops=1.4e+07
 renorm[red] counter=1 t=1.4e-04 per=2.9e+01 cost=2.8e+03 flops=2.0e+07
--- TIMING FOR renorm_tot : t_inter=8.1e-06 t_gemm=3.4e-04 t_reduction=1.4e-04 tot=4.9e-04 ---
 renorm_tot[inter] counter=1 t=8.1e-06 per=1.6e+00 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=0 t=7.7e-05 per=1.6e+01 cost=4.0e+02 flops=5.2e+06
 renorm_tot[gemm] counter=1 i=1 t=5.8e-05 per=1.2e+01 cost=6.2e+02 flops=1.1e+07
 renorm_tot[gemm] counter=1 i=2 t=1.4e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=3 t=1.3e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=1 i=4 t=5.9e-05 per=1.2e+01 cost=5.6e+02 flops=9.4e+06
 renorm_tot[gemm] counter=1 i=5 t=5.5e-05 per=1.1e+01 cost=4.7e+02 flops=8.5e+06
 renorm_tot[gemm] counter=1 i=6 t=8.9e-05 per=1.8e+01 cost=2.8e+03 flops=3.2e+07
 renorm_tot[gemm] counter=1 total t=3.4e-04 per=6.9e+01 cost=4.9e+03 flops=1.4e+07
 renorm_tot[red] counter=1 t=1.4e-04 per=2.9e+01 cost=2.8e+03 flops=2.0e+07
qops.to_cpu: size(tot)=281:2.1e-03MB:2.1e-06GB t[to_cpu]=1.4e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=5.495e-16 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0083 S rank=0 -----
CPUmem: VM:1.972e+01GB RSS:1.838e+00GB  Timing: User:1.111e+02S Sys:1.403e+00S Total:1.125e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=218:1.663e-03MB:1.624e-06GB
CPUmem: VM:1.972e+01GB RSS:1.838e+00GB  Timing: User:1.111e+02S Sys:1.403e+00S Total:1.125e+02S
##### local opt: 2.756e-02 S #####
 T(local opt: fetch) = 1.698e-03 S  per = 6.16  per(accum) = 6.16
 T(local opt: hdiag) = 5.333e-04 S  per = 1.93  per(accum) = 8.1
 T(local opt: dvdsn) = 9.838e-03 S  per = 35.7  per(accum) = 43.8
 T(local opt: decim) = 5.709e-03 S  per = 20.7  per(accum) = 64.5
 T(local opt: guess) = 7.770e-04 S  per = 2.82  per(accum) = 67.3
 T(local opt: renrm) = 8.638e-03 S  per = 31.3  per(accum) = 98.7
 T(local opt: save ) = 3.686e-04 S  per = 1.34  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.838e-03 S  T(sum) = 9.745e-03 S  per = 9.905e+01
 T(local opt: preprocess                  ) = 9.489e-04 S  per = 9.74  per(accum) = 9.74
 T(local opt: symbolic_formulae           ) = 4.542e-04 S  per = 4.66  per(accum) = 14.4
 T(local opt: hintermediate init          ) = 5.410e-05 S  per = 0.555  per(accum) = 15
 T(local opt: preprocess_hformulae_Hxlist ) = 4.745e-03 S  per = 48.7  per(accum) = 63.7
 T(local opt: hmmtasks init               ) = 2.116e-03 S  per = 21.7  per(accum) = 85.4
 T(local opt: initial guess for dvdson    ) = 2.936e-06 S  per = 0.0301  per(accum) = 85.4
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.361e-03 S  per =   14  per(accum) = 99.4
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.171e-05 S  per = 0.223  per(accum) = 99.6
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.620e-07 S  per = 0.00166  per(accum) = 99.6
 T(local opt: dvdson solver [rest part]   ) = 4.084e-05 S  per = 0.419  per(accum) = 100
Detailed decomposition of T(renrm) = 8.638e-03 S  T(sum) = 8.638e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.974e-04 S  per = 2.29  per(accum) = 2.29
 T(local opt: qops init                    ) = 1.039e-03 S  per =   12  per(accum) = 14.3
 T(local opt: symbolic_formulae_renorm     ) = 3.859e-04 S  per = 4.47  per(accum) = 18.8
 T(local opt: allocate qops on gpu         ) = 2.250e-05 S  per = 0.26  per(accum) = 19
 T(local opt: site memcpy cpu2gpu          ) = 2.031e-05 S  per = 0.235  per(accum) = 19.3
 T(local opt: rintermediate init           ) = 1.924e-05 S  per = 0.223  per(accum) = 19.5
 T(local opt: preprocess_formulae_Rlist2   ) = 4.256e-03 S  per = 49.3  per(accum) = 68.8
 T(local opt: rmmtasks init                ) = 1.859e-03 S  per = 21.5  per(accum) = 90.3
 T(local opt: qops memset on cpu           ) = 3.500e-08 S  per = 0.000405  per(accum) = 90.3
 T(local opt: preprocess_renorm_batchGPU   ) = 5.909e-04 S  per = 6.84  per(accum) = 97.1
 T(local opt: reduction of opS & opH [nccl]) = 1.070e-06 S  per = 0.0124  per(accum) = 97.1
 T(local opt: qops memcpy gpu2cpu          ) = 1.971e-05 S  per = 0.228  per(accum) = 97.4
 T(local opt: deallocate cpu and gpu memory) = 1.054e-05 S  per = 0.122  per(accum) = 97.5
 T(local opt: reduction of opS & opH [comm]) = 7.808e-05 S  per = 0.904  per(accum) = 98.4
 T(local opt: conversion from opAB to opPQ ) = 3.765e-06 S  per = 0.0436  per(accum) = 98.4
 T(local opt: after oper_renorm            ) = 1.348e-04 S  per = 1.56  per(accum) = 100
##### sweep opt: 2.756e-02 S #####
 T(sweep opt: fetch) = 1.698e-03 S  per = 6.16  per(accum) = 6.16
 T(sweep opt: hdiag) = 5.333e-04 S  per = 1.93  per(accum) = 8.1
 T(sweep opt: dvdsn) = 9.838e-03 S  per = 35.7  per(accum) = 43.8
 T(sweep opt: decim) = 5.709e-03 S  per = 20.7  per(accum) = 64.5
 T(sweep opt: guess) = 7.770e-04 S  per = 2.82  per(accum) = 67.3
 T(sweep opt: renrm) = 8.638e-03 S  per = 31.3  per(accum) = 98.7
 T(sweep opt: save ) = 3.686e-04 S  per = 1.34  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.838e-03 S  T(sum) = 9.745e-03 S  per = 9.905e+01
 T(sweep opt: preprocess                  ) = 9.489e-04 S  per = 9.74  per(accum) = 9.74
 T(sweep opt: symbolic_formulae           ) = 4.542e-04 S  per = 4.66  per(accum) = 14.4
 T(sweep opt: hintermediate init          ) = 5.410e-05 S  per = 0.555  per(accum) = 15
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.745e-03 S  per = 48.7  per(accum) = 63.7
 T(sweep opt: hmmtasks init               ) = 2.116e-03 S  per = 21.7  per(accum) = 85.4
 T(sweep opt: initial guess for dvdson    ) = 2.936e-06 S  per = 0.0301  per(accum) = 85.4
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.361e-03 S  per =   14  per(accum) = 99.4
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.171e-05 S  per = 0.223  per(accum) = 99.6
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.620e-07 S  per = 0.00166  per(accum) = 99.6
 T(sweep opt: dvdson solver [rest part]   ) = 4.084e-05 S  per = 0.419  per(accum) = 100
Detailed decomposition of T(renrm) = 8.638e-03 S  T(sum) = 8.638e-03 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.974e-04 S  per = 2.29  per(accum) = 2.29
 T(sweep opt: qops init                    ) = 1.039e-03 S  per =   12  per(accum) = 14.3
 T(sweep opt: symbolic_formulae_renorm     ) = 3.859e-04 S  per = 4.47  per(accum) = 18.8
 T(sweep opt: allocate qops on gpu         ) = 2.250e-05 S  per = 0.26  per(accum) = 19
 T(sweep opt: site memcpy cpu2gpu          ) = 2.031e-05 S  per = 0.235  per(accum) = 19.3
 T(sweep opt: rintermediate init           ) = 1.924e-05 S  per = 0.223  per(accum) = 19.5
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.256e-03 S  per = 49.3  per(accum) = 68.8
 T(sweep opt: rmmtasks init                ) = 1.859e-03 S  per = 21.5  per(accum) = 90.3
 T(sweep opt: qops memset on cpu           ) = 3.500e-08 S  per = 0.000405  per(accum) = 90.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.909e-04 S  per = 6.84  per(accum) = 97.1
 T(sweep opt: reduction of opS & opH [nccl]) = 1.070e-06 S  per = 0.0124  per(accum) = 97.1
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.971e-05 S  per = 0.228  per(accum) = 97.4
 T(sweep opt: deallocate cpu and gpu memory) = 1.054e-05 S  per = 0.122  per(accum) = 97.5
 T(sweep opt: reduction of opS & opH [comm]) = 7.808e-05 S  per = 0.904  per(accum) = 98.4
 T(sweep opt: conversion from opAB to opPQ ) = 3.765e-06 S  per = 0.0436  per(accum) = 98.4
 T(sweep opt: after oper_renorm            ) = 1.348e-04 S  per = 1.56  per(accum) = 100
##### global opt: 1.525e+00 S #####
 T(global opt: fetch) = 6.879e-03 S  per = 0.451  per(accum) = 0.451
 T(global opt: hdiag) = 1.761e-02 S  per = 1.15  per(accum) = 1.61
 T(global opt: dvdsn) = 1.018e+00 S  per = 66.8  per(accum) = 68.4
 T(global opt: decim) = 5.557e-02 S  per = 3.64  per(accum) = 72
 T(global opt: guess) = 9.029e-03 S  per = 0.592  per(accum) = 72.6
 T(global opt: renrm) = 4.072e-01 S  per = 26.7  per(accum) = 99.3
 T(global opt: save ) = 1.063e-02 S  per = 0.697  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.018e+00 S  T(sum) = 1.016e+00 S  per = 9.977e+01
 T(global opt: preprocess                  ) = 3.173e-02 S  per = 3.12  per(accum) = 3.12
 T(global opt: symbolic_formulae           ) = 8.017e-03 S  per = 0.789  per(accum) = 3.91
 T(global opt: hintermediate init          ) = 4.756e-04 S  per = 0.0468  per(accum) = 3.96
 T(global opt: preprocess_hformulae_Hxlist ) = 5.416e-01 S  per = 53.3  per(accum) = 57.3
 T(global opt: hmmtasks init               ) = 2.450e-01 S  per = 24.1  per(accum) = 81.4
 T(global opt: initial guess for dvdson    ) = 9.325e-03 S  per = 0.918  per(accum) = 82.3
 T(global opt: dvdson solver [Hx_batchGPU] ) = 5.631e-02 S  per = 5.54  per(accum) = 87.9
 T(global opt: dvdson solver [comm(gpu)]   ) = 6.334e-04 S  per = 0.0624  per(accum) = 87.9
 T(global opt: dvdson solver [comm(cpu)]   ) = 4.154e-06 S  per = 0.000409  per(accum) = 87.9
 T(global opt: dvdson solver [rest part]   ) = 1.226e-01 S  per = 12.1  per(accum) = 100
Detailed decomposition of T(renrm) = 4.072e-01 S  T(sum) = 4.072e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.514e-03 S  per = 0.863  per(accum) = 0.863
 T(global opt: qops init                    ) = 8.350e-03 S  per = 2.05  per(accum) = 2.91
 T(global opt: symbolic_formulae_renorm     ) = 4.095e-03 S  per = 1.01  per(accum) = 3.92
 T(global opt: allocate qops on gpu         ) = 1.946e-04 S  per = 0.0478  per(accum) = 3.97
 T(global opt: site memcpy cpu2gpu          ) = 3.154e-04 S  per = 0.0775  per(accum) = 4.04
 T(global opt: rintermediate init           ) = 4.834e-04 S  per = 0.119  per(accum) = 4.16
 T(global opt: preprocess_formulae_Rlist2   ) = 6.997e-02 S  per = 17.2  per(accum) = 21.3
 T(global opt: rmmtasks init                ) = 3.066e-02 S  per = 7.53  per(accum) = 28.9
 T(global opt: qops memset on cpu           ) = 2.280e-07 S  per = 5.6e-05  per(accum) = 28.9
 T(global opt: preprocess_renorm_batchGPU   ) = 9.046e-03 S  per = 2.22  per(accum) = 31.1
 T(global opt: reduction of opS & opH [nccl]) = 7.857e-06 S  per = 0.00193  per(accum) = 31.1
 T(global opt: qops memcpy gpu2cpu          ) = 1.416e-04 S  per = 0.0348  per(accum) = 31.1
 T(global opt: deallocate cpu and gpu memory) = 7.457e-05 S  per = 0.0183  per(accum) = 31.2
 T(global opt: reduction of opS & opH [comm]) = 5.428e-04 S  per = 0.133  per(accum) = 31.3
 T(global opt: conversion from opAB to opPQ ) = 2.781e-01 S  per = 68.3  per(accum) = 99.6
 T(global opt: after oper_renorm            ) = 1.688e-03 S  per = 0.415  per(accum) = 100

isweep=1 ibond=1/seqsize=6 dots=1 dbond=(2,0)-(3,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.111e+02S Sys:1.403e+00S Total:1.125e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=218:1.663e-03MB:1.624e-06GB
ctns::topology::check_partition: (sl,sr,sc)=2,3,1
 suppl= 0 1
 suppr= 3 4 5
 suppc= 2
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:2 S:4 H:1 A:4 B:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
 rqops: oplist=CSHPQ nops=C:3 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=10,10 size(op)=21:1.602e-04MB size(tot)=458:3.494e-03MB:3.412e-06GB
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 qops(tot)=834:6.363e-03MB:6.214e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(2,0) fdel=./scratch/sweep/rop(3,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
wf3(diml,dimr,dimc)=(10,10,3) nnz=57:4.349e-04MB
qtensor3: wf3 own=1 _data=0x4c5d35d0
qinfo3su2: wf3 sym=(6,0) dir=1,1,1 couple=1
 qbond: qrow nsym=6 dimAll=10
 (2,0):3 (1,1):2 (3,1):2 (0,0):1 (4,0):1 (2,2):1
 qbond: qcol nsym=6 dimAll=10
 (3,1):3 (2,0):2 (4,0):2 (1,1):1 (2,2):1 (4,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=16 nblocks=132 size=57:4.349e-04MB
### DIAG TIMING: total=8.384e-04 t1=1.194e-05, t2=8.320e-05, t3=6.127e-05, t4=6.594e-04, t5=4.776e-06, t6=1.277e-05, t7=5.035e-06
duration_diagGPU:8.520e-04
duration_diagreduce:4.700e-08
duration_diagtransform:5.750e-07
----- TIMING FOR symbolic_formulae_onedot with size=68 : 6.683e-04 S -----
rank=0 GPUmem(GB): used=6.21e-06 (oper)=6.21e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=68
 no. of hintermediate operators=22
 no. of coefficients=66:0.000504MB:4.92e-07GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.375e-05 S -----
rank=0 GPUmem(GB): used=6.71e-06 (oper,hinter)=6.21e-06,4.92e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0157 S size(H_formulae)=68 size(Hxlst2)=16 T(Hmu/Hxlist)=0.000155,0.0155 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0158 S size(H_formulae)=68 size(Hxlst)=1520 -----
rank=0 GPUmem(GB): used=0.000291 (oper,hinter,dvdson,batch)=6.21e-06,4.92e-07,8.49e-07,0.000283 blksize=9 blksize0=6 batchsize=1520
ctns::pdvdsonSolver_nkr::solve_iter ndim=57 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.2e-05,0.000104,0.00108,0.000172,0.00138
 ndim=57:4.25e-07GB t[comm(intra)]=2.2e-05 speed=0.0386GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.0e-04 t_gemm=1.1e-03 t_reduction=1.7e-04 tot=1.4e-03 ---
 sigma[inter] counter=2 t=1.0e-04 per=7.7e+00 cost=1.1e+04 flops=1.0e+08
 sigma[gemm] counter=2 i=0 t=9.2e-05 per=6.8e+00 cost=3.8e+03 flops=4.2e+07
 sigma[gemm] counter=2 i=1 t=8.7e-05 per=6.4e+00 cost=4.0e+03 flops=4.6e+07
 sigma[gemm] counter=2 i=2 t=2.2e-04 per=1.7e+01 cost=9.2e+03 flops=4.1e+07
 sigma[gemm] counter=2 i=3 t=2.4e-04 per=1.8e+01 cost=9.2e+03 flops=3.9e+07
 sigma[gemm] counter=2 i=4 t=2.2e-04 per=1.6e+01 cost=9.7e+03 flops=4.4e+07
 sigma[gemm] counter=2 i=5 t=2.2e-04 per=1.6e+01 cost=9.4e+03 flops=4.3e+07
 sigma[gemm] counter=2 total t=1.1e-03 per=8.0e+01 cost=4.5e+04 flops=4.2e+07
 sigma[red] counter=2 t=1.7e-04 per=1.3e+01 cost=1.2e+04 flops=6.7e+07
--- TIMING FOR sigma_tot : t_inter=1.8e-04 t_gemm=1.5e-03 t_reduction=8.9e-04 tot=2.6e-03 ---
 sigma_tot[inter] counter=2 t=1.8e-04 per=7.0e+00 cost=1.4e+04 flops=7.5e+07
 sigma_tot[gemm] counter=2 i=0 t=1.6e-04 per=6.1e+00 cost=4.4e+03 flops=2.8e+07
 sigma_tot[gemm] counter=2 i=1 t=1.5e-04 per=5.6e+00 cost=4.6e+03 flops=3.1e+07
 sigma_tot[gemm] counter=2 i=2 t=3.3e-04 per=1.3e+01 cost=1.1e+04 flops=3.2e+07
 sigma_tot[gemm] counter=2 i=3 t=3.3e-04 per=1.3e+01 cost=1.1e+04 flops=3.2e+07
 sigma_tot[gemm] counter=2 i=4 t=2.8e-04 per=1.1e+01 cost=1.0e+04 flops=3.7e+07
 sigma_tot[gemm] counter=2 i=5 t=2.8e-04 per=1.1e+01 cost=1.0e+04 flops=3.6e+07
 sigma_tot[gemm] counter=2 total t=1.5e-03 per=5.9e+01 cost=5.1e+04 flops=3.3e+07
 sigma_tot[red] counter=2 t=8.9e-04 per=3.4e+01 cost=1.3e+04 flops=1.5e+07
T(sub)=9.4e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.2e-06,1.9e-06,5.9e-07,1.3e-07
settings: ndim=57 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +      -3.235802424524 -1.003e+03  4.929e-05    1     1  1.511e-03 1.511e-03 1.478e-03
TIMING FOR Davidson : 1.527e-03  T(cal/comm/rest)=1.478e-03,1.030e-07,4.821e-05
decomposed t_rest=4.821e-05
 T(sub)    =9.447e-06 per=1.960e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =2.790e-07 per=5.787e-01
 T(xnrm2)  =3.760e-07 per=7.800e-01
 T(other)  =3.811e-05 per=7.904e+01
optimized energies: isweep=1 ibond=1 dots=1 e[0]=-3.235802424524 nmvp=1
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.112e+02S Sys:1.403e+00S Total:1.126e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=10 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep1_ibond1.txt
 qbond: qsuper nsym=10 dimAll=35
 (2,0):6 (4,0):6 (3,1):8 (1,1):3 (2,2):3 (5,1):3 (4,2):3 (0,0):1 (6,0):1 (3,3):1
----- TMING FOR decimation_genbasis(su2): 4.8e-03 S -----
decimation summary: 35->10 dwt=+0.000e+00 SvN=8.874e-01
 qbond: qkept nsym=6 dimAll=10
 (3,1):3 (2,0):2 (4,0):2 (2,2):1 (5,1):1 (4,2):1
----- TIMING for decimation_row(nkr): 5.286e-03 S T(decim/select/formRot)=4.885e-03,3.000e-04,1.011e-04 -----
----- TIMING FOR onedot_decimation: 5.714e-03 S T(wf/decim)=4.119e-04,5.302e-03 -----
ctns::oper_renorm coord=(2,0) superblock=lc oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:3 S:3 H:1 A:9 B:12 
        dim(bra,ket)=10,10 size(op)=21:1.602e-04MB size(tot)=458:3.494e-03MB:3.412e-06GB
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.120e+02S Sys:1.403e+00S Total:1.134e+02S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=28 : 6.540e-04 S -----
rank=0 GPUmem(GB): used=6.71e-06 (oper)=6.21e-06
rank=0 GPUmem(GB): used=7.13e-06 (oper,site)(GB)=6.21e-06,4.25e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=28
 no. of rintermediate operators=9
 no. of coefficients=18:0.000137MB:1.34e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.271e-05 S -----
rank=0 GPUmem(GB): used=7.26e-06 (oper,site,rinter)=6.21e-06,4.25e-07,1.34e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0142 S size(rtasks)=28 size(Rlst2)=36 T(Rmu/Rlist)=0.000203,0.014 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0143 S size(rtasks)=28 size(Rlst)=1114 -----
rank=0 GPUmem(GB): used=7.26e-06 (oper,site,rinter,batch)=6.21e-06,4.25e-07,1.34e-07,0.000207 blksize=9 blksize0=6 batchsize=1114
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.78e-05,0.000868,0.000183
--- TIMING FOR renorm : t_inter=7.7e-05 t_gemm=8.7e-04 t_reduction=1.8e-04 tot=1.1e-03 ---
 renorm[inter] counter=2 t=7.7e-05 per=6.9e+00 cost=1.4e+03 flops=1.8e+07
 renorm[gemm] counter=2 i=0 t=1.0e-04 per=9.3e+00 cost=3.5e+03 flops=3.4e+07
 renorm[gemm] counter=2 i=1 t=7.8e-05 per=6.9e+00 cost=3.1e+03 flops=4.0e+07
 renorm[gemm] counter=2 i=2 t=1.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=3 t=1.2e-06 per=1.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=2 i=4 t=2.2e-04 per=2.0e+01 cost=5.4e+03 flops=2.4e+07
 renorm[gemm] counter=2 i=5 t=2.3e-04 per=2.0e+01 cost=9.4e+03 flops=4.1e+07
 renorm[gemm] counter=2 i=6 t=2.3e-04 per=2.0e+01 cost=1.8e+04 flops=7.6e+07
 renorm[gemm] counter=2 total t=8.7e-04 per=7.7e+01 cost=3.9e+04 flops=4.5e+07
 renorm[red] counter=2 t=1.8e-04 per=1.6e+01 cost=9.0e+03 flops=4.9e+07
--- TIMING FOR renorm_tot : t_inter=8.5e-05 t_gemm=1.2e-03 t_reduction=3.3e-04 tot=1.6e-03 ---
 renorm_tot[inter] counter=2 t=8.5e-05 per=5.3e+00 cost=1.4e+03 flops=1.7e+07
 renorm_tot[gemm] counter=2 i=0 t=1.8e-04 per=1.1e+01 cost=3.9e+03 flops=2.2e+07
 renorm_tot[gemm] counter=2 i=1 t=1.4e-04 per=8.4e+00 cost=3.7e+03 flops=2.7e+07
 renorm_tot[gemm] counter=2 i=2 t=2.6e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=3 t=2.6e-06 per=1.6e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=2 i=4 t=2.8e-04 per=1.7e+01 cost=6.0e+03 flops=2.1e+07
 renorm_tot[gemm] counter=2 i=5 t=2.8e-04 per=1.7e+01 cost=9.9e+03 flops=3.5e+07
 renorm_tot[gemm] counter=2 i=6 t=3.2e-04 per=2.0e+01 cost=2.0e+04 flops=6.4e+07
 renorm_tot[gemm] counter=2 total t=1.2e-03 per=7.5e+01 cost=4.4e+04 flops=3.6e+07
 renorm_tot[red] counter=2 t=3.3e-04 per=2.0e+01 cost=1.2e+04 flops=3.6e+07
qops.to_cpu: size(tot)=458:3.5e-03MB:3.4e-06GB t[to_cpu]=1.4e-05S speed=2.4e-01GB/S
check ||H-H.dagger||=9.907e-16 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=lc ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 0.19 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.00103,5.08e-06,0.0784,0.11,2.82e-05,0.00011 -----
----- TIMING FOR oper_renorm : 0.0246 S rank=0 -----
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.337e+02S Sys:1.436e+00S Total:1.352e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=218:1.663e-03MB:1.624e-06GB
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.338e+02S Sys:1.436e+00S Total:1.352e+02S
##### local opt: 2.518e-01 S #####
 T(local opt: fetch) = 1.710e-04 S  per = 0.0679  per(accum) = 0.0679
 T(local opt: hdiag) = 1.136e-03 S  per = 0.451  per(accum) = 0.519
 T(local opt: dvdsn) = 2.822e-02 S  per = 11.2  per(accum) = 11.7
 T(local opt: decim) = 5.733e-03 S  per = 2.28  per(accum) = 14
 T(local opt: guess) = 1.064e-03 S  per = 0.423  per(accum) = 14.4
 T(local opt: renrm) = 2.150e-01 S  per = 85.4  per(accum) = 99.8
 T(local opt: save ) = 4.542e-04 S  per = 0.18  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.822e-02 S  T(sum) = 2.813e-02 S  per = 9.970e+01
 T(local opt: preprocess                  ) = 1.872e-03 S  per = 6.65  per(accum) = 6.65
 T(local opt: symbolic_formulae           ) = 6.786e-04 S  per = 2.41  per(accum) = 9.07
 T(local opt: hintermediate init          ) = 5.776e-05 S  per = 0.205  per(accum) = 9.27
 T(local opt: preprocess_hformulae_Hxlist ) = 1.586e-02 S  per = 56.4  per(accum) = 65.7
 T(local opt: hmmtasks init               ) = 8.130e-03 S  per = 28.9  per(accum) = 94.6
 T(local opt: initial guess for dvdson    ) = 2.974e-06 S  per = 0.0106  per(accum) = 94.6
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.456e-03 S  per = 5.18  per(accum) = 99.7
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.203e-05 S  per = 0.0783  per(accum) = 99.8
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.030e-07 S  per = 0.000366  per(accum) = 99.8
 T(local opt: dvdson solver [rest part]   ) = 4.821e-05 S  per = 0.171  per(accum) = 100
Detailed decomposition of T(renrm) = 2.150e-01 S  T(sum) = 2.150e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.722e-04 S  per = 0.173  per(accum) = 0.173
 T(local opt: qops init                    ) = 1.498e-03 S  per = 0.697  per(accum) = 0.87
 T(local opt: symbolic_formulae_renorm     ) = 6.630e-04 S  per = 0.308  per(accum) = 1.18
 T(local opt: allocate qops on gpu         ) = 2.353e-05 S  per = 0.0109  per(accum) = 1.19
 T(local opt: site memcpy cpu2gpu          ) = 2.174e-05 S  per = 0.0101  per(accum) = 1.2
 T(local opt: rintermediate init           ) = 5.327e-05 S  per = 0.0248  per(accum) = 1.22
 T(local opt: preprocess_formulae_Rlist2   ) = 1.439e-02 S  per = 6.69  per(accum) = 7.92
 T(local opt: rmmtasks init                ) = 6.621e-03 S  per = 3.08  per(accum) = 11
 T(local opt: qops memset on cpu           ) = 3.200e-08 S  per = 1.49e-05  per(accum) = 11
 T(local opt: preprocess_renorm_batchGPU   ) = 1.221e-03 S  per = 0.568  per(accum) = 11.6
 T(local opt: reduction of opS & opH [nccl]) = 1.088e-06 S  per = 0.000506  per(accum) = 11.6
 T(local opt: qops memcpy gpu2cpu          ) = 1.986e-05 S  per = 0.00924  per(accum) = 11.6
 T(local opt: deallocate cpu and gpu memory) = 9.160e-06 S  per = 0.00426  per(accum) = 11.6
 T(local opt: reduction of opS & opH [comm]) = 7.365e-05 S  per = 0.0343  per(accum) = 11.6
 T(local opt: conversion from opAB to opPQ ) = 1.897e-01 S  per = 88.2  per(accum) = 99.8
 T(local opt: after oper_renorm            ) = 3.573e-04 S  per = 0.166  per(accum) = 100
##### sweep opt: 2.794e-01 S #####
 T(sweep opt: fetch) = 1.869e-03 S  per = 0.669  per(accum) = 0.669
 T(sweep opt: hdiag) = 1.670e-03 S  per = 0.598  per(accum) = 1.27
 T(sweep opt: dvdsn) = 3.806e-02 S  per = 13.6  per(accum) = 14.9
 T(sweep opt: decim) = 1.144e-02 S  per =  4.1  per(accum) = 19
 T(sweep opt: guess) = 1.841e-03 S  per = 0.659  per(accum) = 19.6
 T(sweep opt: renrm) = 2.237e-01 S  per = 80.1  per(accum) = 99.7
 T(sweep opt: save ) = 8.227e-04 S  per = 0.295  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.806e-02 S  T(sum) = 3.788e-02 S  per = 9.953e+01
 T(sweep opt: preprocess                  ) = 2.821e-03 S  per = 7.45  per(accum) = 7.45
 T(sweep opt: symbolic_formulae           ) = 1.133e-03 S  per = 2.99  per(accum) = 10.4
 T(sweep opt: hintermediate init          ) = 1.119e-04 S  per = 0.295  per(accum) = 10.7
 T(sweep opt: preprocess_hformulae_Hxlist ) = 2.061e-02 S  per = 54.4  per(accum) = 65.1
 T(sweep opt: hmmtasks init               ) = 1.025e-02 S  per =   27  per(accum) = 92.2
 T(sweep opt: initial guess for dvdson    ) = 5.910e-06 S  per = 0.0156  per(accum) = 92.2
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 2.817e-03 S  per = 7.44  per(accum) = 99.6
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 4.374e-05 S  per = 0.115  per(accum) = 99.8
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 2.650e-07 S  per = 0.0007  per(accum) = 99.8
 T(sweep opt: dvdson solver [rest part]   ) = 8.905e-05 S  per = 0.235  per(accum) = 100
Detailed decomposition of T(renrm) = 2.237e-01 S  T(sum) = 2.237e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 5.696e-04 S  per = 0.255  per(accum) = 0.255
 T(sweep opt: qops init                    ) = 2.537e-03 S  per = 1.13  per(accum) = 1.39
 T(sweep opt: symbolic_formulae_renorm     ) = 1.049e-03 S  per = 0.469  per(accum) = 1.86
 T(sweep opt: allocate qops on gpu         ) = 4.603e-05 S  per = 0.0206  per(accum) = 1.88
 T(sweep opt: site memcpy cpu2gpu          ) = 4.205e-05 S  per = 0.0188  per(accum) = 1.9
 T(sweep opt: rintermediate init           ) = 7.251e-05 S  per = 0.0324  per(accum) = 1.93
 T(sweep opt: preprocess_formulae_Rlist2   ) = 1.864e-02 S  per = 8.34  per(accum) = 10.3
 T(sweep opt: rmmtasks init                ) = 8.480e-03 S  per = 3.79  per(accum) = 14.1
 T(sweep opt: qops memset on cpu           ) = 6.700e-08 S  per = 3e-05  per(accum) = 14.1
 T(sweep opt: preprocess_renorm_batchGPU   ) = 1.812e-03 S  per = 0.81  per(accum) = 14.9
 T(sweep opt: reduction of opS & opH [nccl]) = 2.158e-06 S  per = 0.000965  per(accum) = 14.9
 T(sweep opt: qops memcpy gpu2cpu          ) = 3.958e-05 S  per = 0.0177  per(accum) = 14.9
 T(sweep opt: deallocate cpu and gpu memory) = 1.970e-05 S  per = 0.00881  per(accum) = 14.9
 T(sweep opt: reduction of opS & opH [comm]) = 1.517e-04 S  per = 0.0678  per(accum) = 15
 T(sweep opt: conversion from opAB to opPQ ) = 1.897e-01 S  per = 84.8  per(accum) = 99.8
 T(sweep opt: after oper_renorm            ) = 4.921e-04 S  per = 0.22  per(accum) = 100
##### global opt: 1.777e+00 S #####
 T(global opt: fetch) = 7.050e-03 S  per = 0.397  per(accum) = 0.397
 T(global opt: hdiag) = 1.875e-02 S  per = 1.06  per(accum) = 1.45
 T(global opt: dvdsn) = 1.046e+00 S  per = 58.9  per(accum) = 60.3
 T(global opt: decim) = 6.131e-02 S  per = 3.45  per(accum) = 63.8
 T(global opt: guess) = 1.009e-02 S  per = 0.568  per(accum) = 64.4
 T(global opt: renrm) = 6.222e-01 S  per =   35  per(accum) = 99.4
 T(global opt: save ) = 1.108e-02 S  per = 0.624  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.046e+00 S  T(sum) = 1.044e+00 S  per = 9.977e+01
 T(global opt: preprocess                  ) = 3.360e-02 S  per = 3.22  per(accum) = 3.22
 T(global opt: symbolic_formulae           ) = 8.696e-03 S  per = 0.833  per(accum) = 4.05
 T(global opt: hintermediate init          ) = 5.334e-04 S  per = 0.0511  per(accum) = 4.1
 T(global opt: preprocess_hformulae_Hxlist ) = 5.574e-01 S  per = 53.4  per(accum) = 57.5
 T(global opt: hmmtasks init               ) = 2.531e-01 S  per = 24.2  per(accum) = 81.8
 T(global opt: initial guess for dvdson    ) = 9.327e-03 S  per = 0.894  per(accum) = 82.6
 T(global opt: dvdson solver [Hx_batchGPU] ) = 5.776e-02 S  per = 5.53  per(accum) = 88.2
 T(global opt: dvdson solver [comm(gpu)]   ) = 6.555e-04 S  per = 0.0628  per(accum) = 88.2
 T(global opt: dvdson solver [comm(cpu)]   ) = 4.257e-06 S  per = 0.000408  per(accum) = 88.2
 T(global opt: dvdson solver [rest part]   ) = 1.227e-01 S  per = 11.8  per(accum) = 100
Detailed decomposition of T(renrm) = 6.222e-01 S  T(sum) = 6.222e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 3.886e-03 S  per = 0.625  per(accum) = 0.625
 T(global opt: qops init                    ) = 9.848e-03 S  per = 1.58  per(accum) = 2.21
 T(global opt: symbolic_formulae_renorm     ) = 4.758e-03 S  per = 0.765  per(accum) = 2.97
 T(global opt: allocate qops on gpu         ) = 2.181e-04 S  per = 0.0351  per(accum) = 3.01
 T(global opt: site memcpy cpu2gpu          ) = 3.372e-04 S  per = 0.0542  per(accum) = 3.06
 T(global opt: rintermediate init           ) = 5.367e-04 S  per = 0.0862  per(accum) = 3.15
 T(global opt: preprocess_formulae_Rlist2   ) = 8.436e-02 S  per = 13.6  per(accum) = 16.7
 T(global opt: rmmtasks init                ) = 3.729e-02 S  per = 5.99  per(accum) = 22.7
 T(global opt: qops memset on cpu           ) = 2.600e-07 S  per = 4.18e-05  per(accum) = 22.7
 T(global opt: preprocess_renorm_batchGPU   ) = 1.027e-02 S  per = 1.65  per(accum) = 24.3
 T(global opt: reduction of opS & opH [nccl]) = 8.945e-06 S  per = 0.00144  per(accum) = 24.3
 T(global opt: qops memcpy gpu2cpu          ) = 1.614e-04 S  per = 0.0259  per(accum) = 24.4
 T(global opt: deallocate cpu and gpu memory) = 8.373e-05 S  per = 0.0135  per(accum) = 24.4
 T(global opt: reduction of opS & opH [comm]) = 6.165e-04 S  per = 0.0991  per(accum) = 24.5
 T(global opt: conversion from opAB to opPQ ) = 4.678e-01 S  per = 75.2  per(accum) = 99.7
 T(global opt: after oper_renorm            ) = 2.046e-03 S  per = 0.329  per(accum) = 100

isweep=1 ibond=2/seqsize=6 dots=1 dbond=(3,0)-(4,0) forward=1 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.339e+02S Sys:1.436e+00S Total:1.353e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=218:1.663e-03MB:1.624e-06GB
ctns::topology::check_partition: (sl,sr,sc)=3,2,1
 suppl= 0 1 2
 suppr= 4 5
 suppc= 3
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:3 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=10,10 size(op)=21:1.602e-04MB size(tot)=458:3.494e-03MB:3.412e-06GB
 rqops: oplist=CSHAB nops=C:2 S:4 H:1 A:4 B:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 qops(tot)=834:6.363e-03MB:6.214e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/lop(3,0) fdel=./scratch/sweep/rop(4,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
wf3(diml,dimr,dimc)=(10,10,3) nnz=57:4.349e-04MB
qtensor3: wf3 own=1 _data=0x4e56cad0
qinfo3su2: wf3 sym=(6,0) dir=1,1,1 couple=0
 qbond: qrow nsym=6 dimAll=10
 (3,1):3 (2,0):2 (4,0):2 (2,2):1 (5,1):1 (4,2):1
 qbond: qcol nsym=6 dimAll=10
 (2,0):3 (1,1):2 (3,1):2 (0,0):1 (4,0):1 (2,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=16 nblocks=132 size=57:4.349e-04MB
### DIAG TIMING: total=9.189e-04 t1=1.129e-05, t2=8.439e-05, t3=5.604e-05, t4=7.439e-04, t5=4.985e-06, t6=1.360e-05, t7=4.696e-06
duration_diagGPU:9.315e-04
duration_diagreduce:4.800e-08
duration_diagtransform:6.780e-07
----- TIMING FOR symbolic_formulae_onedot with size=68 : 6.490e-04 S -----
rank=0 GPUmem(GB): used=6.21e-06 (oper)=6.21e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=68
 no. of hintermediate operators=22
 no. of coefficients=66:0.000504MB:4.92e-07GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.510e-05 S -----
rank=0 GPUmem(GB): used=6.71e-06 (oper,hinter)=6.21e-06,4.92e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0155 S size(H_formulae)=68 size(Hxlst2)=16 T(Hmu/Hxlist)=0.000156,0.0154 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0157 S size(H_formulae)=68 size(Hxlst)=1520 -----
rank=0 GPUmem(GB): used=0.000291 (oper,hinter,dvdson,batch)=6.21e-06,4.92e-07,8.49e-07,0.000283 blksize=9 blksize0=6 batchsize=1520
ctns::pdvdsonSolver_nkr::solve_iter ndim=57 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.09e-05,9.09e-05,0.00109,0.000164,0.00138
 ndim=57:4.25e-07GB t[comm(intra)]=3.09e-05 speed=0.0275GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.1e-05 t_gemm=1.1e-03 t_reduction=1.6e-04 tot=1.3e-03 ---
 sigma[inter] counter=3 t=9.1e-05 per=6.8e+00 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=3 i=0 t=9.4e-05 per=7.0e+00 cost=4.0e+03 flops=4.3e+07
 sigma[gemm] counter=3 i=1 t=8.7e-05 per=6.5e+00 cost=3.8e+03 flops=4.4e+07
 sigma[gemm] counter=3 i=2 t=2.1e-04 per=1.6e+01 cost=9.7e+03 flops=4.5e+07
 sigma[gemm] counter=3 i=3 t=2.6e-04 per=1.9e+01 cost=9.4e+03 flops=3.7e+07
 sigma[gemm] counter=3 i=4 t=2.3e-04 per=1.7e+01 cost=9.2e+03 flops=4.1e+07
 sigma[gemm] counter=3 i=5 t=2.1e-04 per=1.6e+01 cost=9.2e+03 flops=4.3e+07
 sigma[gemm] counter=3 total t=1.1e-03 per=8.1e+01 cost=4.5e+04 flops=4.2e+07
 sigma[red] counter=3 t=1.6e-04 per=1.2e+01 cost=1.2e+04 flops=7.1e+07
--- TIMING FOR sigma_tot : t_inter=2.7e-04 t_gemm=2.6e-03 t_reduction=1.1e-03 tot=3.9e-03 ---
 sigma_tot[inter] counter=3 t=2.7e-04 per=6.9e+00 cost=2.4e+04 flops=9.0e+07
 sigma_tot[gemm] counter=3 i=0 t=2.5e-04 per=6.4e+00 cost=8.5e+03 flops=3.3e+07
 sigma_tot[gemm] counter=3 i=1 t=2.3e-04 per=5.9e+00 cost=8.5e+03 flops=3.6e+07
 sigma_tot[gemm] counter=3 i=2 t=5.5e-04 per=1.4e+01 cost=2.0e+04 flops=3.7e+07
 sigma_tot[gemm] counter=3 i=3 t=5.9e-04 per=1.5e+01 cost=2.0e+04 flops=3.4e+07
 sigma_tot[gemm] counter=3 i=4 t=5.1e-04 per=1.3e+01 cost=1.9e+04 flops=3.9e+07
 sigma_tot[gemm] counter=3 i=5 t=4.9e-04 per=1.2e+01 cost=1.9e+04 flops=3.9e+07
 sigma_tot[gemm] counter=3 total t=2.6e-03 per=6.6e+01 cost=9.6e+04 flops=3.7e+07
 sigma_tot[red] counter=3 t=1.1e-03 per=2.7e+01 cost=2.5e+04 flops=2.3e+07
T(sub)=9.4e-06 T(gemm/eig/ortho/gemm/axpy)=2.6e-06,4.2e-06,1.9e-06,6.3e-07,1.6e-07
settings: ndim=57 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.235802424524 -1.003e+03  1.615e-03    1     1  1.519e-03 1.519e-03 1.493e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.272e-05,1.157e-04,1.128e-03,1.686e-04,1.442e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.272e-05 speed=3.738e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=1.1e-03 t_reduction=1.7e-04 tot=1.4e-03 ---
 sigma[inter] counter=4 t=1.2e-04 per=8.2e+00 cost=1.1e+04 flops=9.4e+07
 sigma[gemm] counter=4 i=0 t=1.0e-04 per=7.1e+00 cost=4.0e+03 flops=4.0e+07
 sigma[gemm] counter=4 i=1 t=1.0e-04 per=7.1e+00 cost=3.8e+03 flops=3.8e+07
 sigma[gemm] counter=4 i=2 t=2.4e-04 per=1.7e+01 cost=9.7e+03 flops=4.0e+07
 sigma[gemm] counter=4 i=3 t=2.6e-04 per=1.9e+01 cost=9.4e+03 flops=3.6e+07
 sigma[gemm] counter=4 i=4 t=2.1e-04 per=1.5e+01 cost=9.2e+03 flops=4.4e+07
 sigma[gemm] counter=4 i=5 t=2.1e-04 per=1.5e+01 cost=9.2e+03 flops=4.4e+07
 sigma[gemm] counter=4 total t=1.1e-03 per=8.0e+01 cost=4.5e+04 flops=4.0e+07
 sigma[red] counter=4 t=1.7e-04 per=1.2e+01 cost=1.2e+04 flops=6.8e+07
--- TIMING FOR sigma_tot : t_inter=3.9e-04 t_gemm=3.7e-03 t_reduction=1.2e-03 tot=5.4e-03 ---
 sigma_tot[inter] counter=4 t=3.9e-04 per=7.2e+00 cost=3.5e+04 flops=9.1e+07
 sigma_tot[gemm] counter=4 i=0 t=3.5e-04 per=6.6e+00 cost=1.2e+04 flops=3.5e+07
 sigma_tot[gemm] counter=4 i=1 t=3.3e-04 per=6.2e+00 cost=1.2e+04 flops=3.7e+07
 sigma_tot[gemm] counter=4 i=2 t=7.9e-04 per=1.5e+01 cost=3.0e+04 flops=3.8e+07
 sigma_tot[gemm] counter=4 i=3 t=8.5e-04 per=1.6e+01 cost=2.9e+04 flops=3.5e+07
 sigma_tot[gemm] counter=4 i=4 t=7.2e-04 per=1.3e+01 cost=2.9e+04 flops=4.0e+07
 sigma_tot[gemm] counter=4 i=5 t=7.0e-04 per=1.3e+01 cost=2.8e+04 flops=4.0e+07
 sigma_tot[gemm] counter=4 total t=3.7e-03 per=7.0e+01 cost=1.4e+05 flops=3.8e+07
 sigma_tot[red] counter=4 t=1.2e-03 per=2.3e+01 cost=3.6e+04 flops=3.0e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.2e-05,4.3e-06,1.3e-06,2.7e-07
    2   0 -      -3.235803756705 -1.332e-06  3.375e-04    2     2  7.864e-03 3.932e-03 1.541e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.104e-05,1.086e-04,1.121e-03,1.665e-04,1.423e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.104e-05 speed=4.037e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.1e-03 t_reduction=1.7e-04 tot=1.4e-03 ---
 sigma[inter] counter=5 t=1.1e-04 per=7.8e+00 cost=1.1e+04 flops=1.0e+08
 sigma[gemm] counter=5 i=0 t=1.0e-04 per=7.2e+00 cost=4.0e+03 flops=4.0e+07
 sigma[gemm] counter=5 i=1 t=1.0e-04 per=7.3e+00 cost=3.8e+03 flops=3.8e+07
 sigma[gemm] counter=5 i=2 t=2.4e-04 per=1.7e+01 cost=9.7e+03 flops=4.1e+07
 sigma[gemm] counter=5 i=3 t=2.6e-04 per=1.8e+01 cost=9.4e+03 flops=3.7e+07
 sigma[gemm] counter=5 i=4 t=2.1e-04 per=1.5e+01 cost=9.2e+03 flops=4.4e+07
 sigma[gemm] counter=5 i=5 t=2.1e-04 per=1.5e+01 cost=9.2e+03 flops=4.3e+07
 sigma[gemm] counter=5 total t=1.1e-03 per=8.0e+01 cost=4.5e+04 flops=4.0e+07
 sigma[red] counter=5 t=1.7e-04 per=1.2e+01 cost=1.2e+04 flops=6.9e+07
--- TIMING FOR sigma_tot : t_inter=5.0e-04 t_gemm=4.9e-03 t_reduction=1.4e-03 tot=6.7e-03 ---
 sigma_tot[inter] counter=5 t=5.0e-04 per=7.3e+00 cost=4.6e+04 flops=9.3e+07
 sigma_tot[gemm] counter=5 i=0 t=4.5e-04 per=6.7e+00 cost=1.6e+04 flops=3.6e+07
 sigma_tot[gemm] counter=5 i=1 t=4.4e-04 per=6.5e+00 cost=1.6e+04 flops=3.7e+07
 sigma_tot[gemm] counter=5 i=2 t=1.0e-03 per=1.5e+01 cost=4.0e+04 flops=3.9e+07
 sigma_tot[gemm] counter=5 i=3 t=1.1e-03 per=1.6e+01 cost=3.9e+04 flops=3.5e+07
 sigma_tot[gemm] counter=5 i=4 t=9.3e-04 per=1.4e+01 cost=3.8e+04 flops=4.1e+07
 sigma_tot[gemm] counter=5 i=5 t=9.1e-04 per=1.4e+01 cost=3.8e+04 flops=4.1e+07
 sigma_tot[gemm] counter=5 total t=4.9e-03 per=7.2e+01 cost=1.9e+05 flops=3.8e+07
 sigma_tot[red] counter=5 t=1.4e-03 per=2.1e+01 cost=4.8e+04 flops=3.4e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.0e-06,1.6e-05,3.5e-06,1.3e-06,2.7e-07
    3   0 -      -3.235803817241 -6.054e-08  1.391e-04    3     3  1.694e-02 5.645e-03 1.554e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.198e-05,1.120e-04,1.123e-03,1.643e-04,1.427e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.198e-05 speed=3.865e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.1e-03 t_reduction=1.6e-04 tot=1.4e-03 ---
 sigma[inter] counter=6 t=1.1e-04 per=8.0e+00 cost=1.1e+04 flops=9.7e+07
 sigma[gemm] counter=6 i=0 t=1.0e-04 per=7.2e+00 cost=4.0e+03 flops=4.0e+07
 sigma[gemm] counter=6 i=1 t=1.0e-04 per=7.3e+00 cost=3.8e+03 flops=3.7e+07
 sigma[gemm] counter=6 i=2 t=2.5e-04 per=1.8e+01 cost=9.7e+03 flops=3.8e+07
 sigma[gemm] counter=6 i=3 t=2.4e-04 per=1.7e+01 cost=9.4e+03 flops=3.9e+07
 sigma[gemm] counter=6 i=4 t=2.1e-04 per=1.5e+01 cost=9.2e+03 flops=4.4e+07
 sigma[gemm] counter=6 i=5 t=2.1e-04 per=1.5e+01 cost=9.2e+03 flops=4.3e+07
 sigma[gemm] counter=6 total t=1.1e-03 per=8.0e+01 cost=4.5e+04 flops=4.0e+07
 sigma[red] counter=6 t=1.6e-04 per=1.2e+01 cost=1.2e+04 flops=7.0e+07
--- TIMING FOR sigma_tot : t_inter=6.1e-04 t_gemm=6.0e-03 t_reduction=1.6e-03 tot=8.1e-03 ---
 sigma_tot[inter] counter=6 t=6.1e-04 per=7.5e+00 cost=5.7e+04 flops=9.4e+07
 sigma_tot[gemm] counter=6 i=0 t=5.6e-04 per=6.8e+00 cost=2.0e+04 flops=3.7e+07
 sigma_tot[gemm] counter=6 i=1 t=5.4e-04 per=6.6e+00 cost=2.0e+04 flops=3.7e+07
 sigma_tot[gemm] counter=6 i=2 t=1.3e-03 per=1.6e+01 cost=4.9e+04 flops=3.9e+07
 sigma_tot[gemm] counter=6 i=3 t=1.3e-03 per=1.7e+01 cost=4.8e+04 flops=3.6e+07
 sigma_tot[gemm] counter=6 i=4 t=1.1e-03 per=1.4e+01 cost=4.7e+04 flops=4.1e+07
 sigma_tot[gemm] counter=6 i=5 t=1.1e-03 per=1.4e+01 cost=4.7e+04 flops=4.2e+07
 sigma_tot[gemm] counter=6 total t=6.0e-03 per=7.3e+01 cost=2.3e+05 flops=3.9e+07
 sigma_tot[red] counter=6 t=1.6e-03 per=1.9e+01 cost=5.9e+04 flops=3.8e+07
T(sub)=2.5e-05 T(gemm/eig/ortho/gemm/axpy)=4.1e-06,1.5e-05,3.5e-06,1.3e-06,2.5e-07
    4   0 +      -3.235803828577 -1.134e-08  5.011e-05    3     4  2.607e-02 6.519e-03 1.563e-03
TIMING FOR Davidson : 2.609e-02  T(cal/comm/rest)=6.250e-03,6.240e-07,1.983e-02
decomposed t_rest=1.983e-02
 T(sub)    =8.208e-05 per=4.138e-01
 T(precond)=1.964e-02 per=9.900e+01
 T(ortho)  =1.806e-05 per=9.104e-02
 T(xcopy)  =6.410e-07 per=3.232e-03
 T(xnrm2)  =1.874e-06 per=9.448e-03
 T(other)  =9.487e-05 per=4.783e-01
optimized energies: isweep=1 ibond=2 dots=1 e[0]=-3.235803828577 nmvp=4
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.370e+02S Sys:1.436e+00S Total:1.384e+02S
ctns::onedot_renorm superblock=lc (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep1_ibond2.txt
 qbond: qsuper nsym=11 dimAll=36
 (3,1):6 (5,1):7 (4,0):7 (4,2):5 (2,0):2 (6,0):3 (2,2):1 (3,3):1 (7,1):1 (6,2):2 (5,3):1
----- TMING FOR decimation_genbasis(su2): 7.0e-03 S -----
decimation summary: 36->10 dwt=+0.000e+00 SvN=6.967e-01
 qbond: qkept nsym=6 dimAll=10
 (4,0):3 (3,1):2 (5,1):2 (4,2):1 (2,0):1 (6,0):1
----- TIMING for decimation_row(nkr): 7.474e-03 S T(decim/select/formRot)=7.071e-03,2.825e-04,1.207e-04 -----
----- TIMING FOR onedot_decimation: 7.741e-03 S T(wf/decim)=2.504e-04,7.491e-03 -----
ctns::oper_renorm coord=(3,0) superblock=lc oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:4 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.380e+02S Sys:1.437e+00S Total:1.395e+02S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=17 : 5.244e-04 S -----
rank=0 GPUmem(GB): used=6.71e-06 (oper)=6.21e-06
rank=0 GPUmem(GB): used=7.13e-06 (oper,site)(GB)=6.21e-06,4.25e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=17
 no. of rintermediate operators=22
 no. of coefficients=66:0.000504MB:4.92e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.722e-05 S -----
rank=0 GPUmem(GB): used=7.62e-06 (oper,site,rinter)=6.21e-06,4.25e-07,4.92e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0112 S size(rtasks)=17 size(Rlst2)=36 T(Rmu/Rlist)=0.000167,0.011 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0113 S size(rtasks)=17 size(Rlst)=848 -----
rank=0 GPUmem(GB): used=7.62e-06 (oper,site,rinter,batch)=6.21e-06,4.25e-07,4.92e-07,0.000158 blksize=9 blksize0=6 batchsize=848
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=9.42e-05,0.000695,0.000248
--- TIMING FOR renorm : t_inter=9.4e-05 t_gemm=6.9e-04 t_reduction=2.5e-04 tot=1.0e-03 ---
 renorm[inter] counter=3 t=9.4e-05 per=9.1e+00 cost=5.4e+03 flops=5.8e+07
 renorm[gemm] counter=3 i=0 t=7.8e-05 per=7.5e+00 cost=1.9e+03 flops=2.4e+07
 renorm[gemm] counter=3 i=1 t=7.4e-05 per=7.1e+00 cost=2.6e+03 flops=3.5e+07
 renorm[gemm] counter=3 i=2 t=1.3e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=3 t=1.3e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=3 i=4 t=1.8e-04 per=1.7e+01 cost=4.5e+03 flops=2.6e+07
 renorm[gemm] counter=3 i=5 t=1.8e-04 per=1.7e+01 cost=6.0e+03 flops=3.4e+07
 renorm[gemm] counter=3 i=6 t=1.9e-04 per=1.8e+01 cost=1.3e+04 flops=6.9e+07
 renorm[gemm] counter=3 total t=6.9e-04 per=6.7e+01 cost=2.8e+04 flops=4.0e+07
 renorm[red] counter=3 t=2.5e-04 per=2.4e+01 cost=6.2e+03 flops=2.5e+07
--- TIMING FOR renorm_tot : t_inter=1.8e-04 t_gemm=1.9e-03 t_reduction=5.7e-04 tot=2.7e-03 ---
 renorm_tot[inter] counter=3 t=1.8e-04 per=6.7e+00 cost=6.8e+03 flops=3.8e+07
 renorm_tot[gemm] counter=3 i=0 t=2.6e-04 per=9.8e+00 cost=5.8e+03 flops=2.2e+07
 renorm_tot[gemm] counter=3 i=1 t=2.1e-04 per=7.9e+00 cost=6.3e+03 flops=3.0e+07
 renorm_tot[gemm] counter=3 i=2 t=3.9e-06 per=1.5e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=3 t=3.8e-06 per=1.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm_tot[gemm] counter=3 i=4 t=4.6e-04 per=1.7e+01 cost=1.0e+04 flops=2.3e+07
 renorm_tot[gemm] counter=3 i=5 t=4.6e-04 per=1.7e+01 cost=1.6e+04 flops=3.5e+07
 renorm_tot[gemm] counter=3 i=6 t=5.1e-04 per=1.9e+01 cost=3.3e+04 flops=6.6e+07
 renorm_tot[gemm] counter=3 total t=1.9e-03 per=7.2e+01 cost=7.2e+04 flops=3.8e+07
 renorm_tot[red] counter=3 t=5.7e-04 per=2.2e+01 cost=1.8e+04 flops=3.1e+07
qops.to_cpu: size(tot)=281:2.1e-03MB:2.1e-06GB t[to_cpu]=1.4e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=1.886e-15 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=lc ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0193 S rank=0 -----
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.386e+02S Sys:1.437e+00S Total:1.401e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=20:1.526e-04MB:1.490e-07GB
total mem of comb=181:1.381e-03MB:1.349e-06GB
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.386e+02S Sys:1.437e+00S Total:1.401e+02S
##### local opt: 8.265e-02 S #####
 T(local opt: fetch) = 1.806e-04 S  per = 0.218  per(accum) = 0.218
 T(local opt: hdiag) = 1.214e-03 S  per = 1.47  per(accum) = 1.69
 T(local opt: dvdsn) = 5.263e-02 S  per = 63.7  per(accum) = 65.4
 T(local opt: decim) = 7.772e-03 S  per =  9.4  per(accum) = 74.8
 T(local opt: guess) = 5.751e-04 S  per = 0.696  per(accum) = 75.5
 T(local opt: renrm) = 1.992e-02 S  per = 24.1  per(accum) = 99.6
 T(local opt: save ) = 3.662e-04 S  per = 0.443  per(accum) = 100
Detailed decomposition of T(dvdsn) = 5.263e-02 S  T(sum) = 5.240e-02 S  per = 9.956e+01
 T(local opt: preprocess                  ) = 1.751e-03 S  per = 3.34  per(accum) = 3.34
 T(local opt: symbolic_formulae           ) = 6.601e-04 S  per = 1.26  per(accum) = 4.6
 T(local opt: hintermediate init          ) = 5.943e-05 S  per = 0.113  per(accum) = 4.71
 T(local opt: preprocess_hformulae_Hxlist ) = 1.573e-02 S  per =   30  per(accum) = 34.7
 T(local opt: hmmtasks init               ) = 8.110e-03 S  per = 15.5  per(accum) = 50.2
 T(local opt: initial guess for dvdson    ) = 2.958e-06 S  per = 0.00565  per(accum) = 50.2
 T(local opt: dvdson solver [Hx_batchGPU] ) = 6.154e-03 S  per = 11.7  per(accum) = 62
 T(local opt: dvdson solver [comm(gpu)]   ) = 9.659e-05 S  per = 0.184  per(accum) = 62.1
 T(local opt: dvdson solver [comm(cpu)]   ) = 6.240e-07 S  per = 0.00119  per(accum) = 62.1
 T(local opt: dvdson solver [rest part]   ) = 1.983e-02 S  per = 37.9  per(accum) = 100
Detailed decomposition of T(renrm) = 1.992e-02 S  T(sum) = 1.992e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.919e-04 S  per = 1.97  per(accum) = 1.97
 T(local opt: qops init                    ) = 1.073e-03 S  per = 5.39  per(accum) = 7.36
 T(local opt: symbolic_formulae_renorm     ) = 5.334e-04 S  per = 2.68  per(accum) = 10
 T(local opt: allocate qops on gpu         ) = 2.330e-05 S  per = 0.117  per(accum) = 10.2
 T(local opt: site memcpy cpu2gpu          ) = 2.134e-05 S  per = 0.107  per(accum) = 10.3
 T(local opt: rintermediate init           ) = 5.748e-05 S  per = 0.289  per(accum) = 10.5
 T(local opt: preprocess_formulae_Rlist2   ) = 1.130e-02 S  per = 56.7  per(accum) = 67.3
 T(local opt: rmmtasks init                ) = 5.085e-03 S  per = 25.5  per(accum) = 92.8
 T(local opt: qops memset on cpu           ) = 3.300e-08 S  per = 0.000166  per(accum) = 92.8
 T(local opt: preprocess_renorm_batchGPU   ) = 1.137e-03 S  per = 5.71  per(accum) = 98.5
 T(local opt: reduction of opS & opH [nccl]) = 1.069e-06 S  per = 0.00537  per(accum) = 98.5
 T(local opt: qops memcpy gpu2cpu          ) = 1.955e-05 S  per = 0.0981  per(accum) = 98.6
 T(local opt: deallocate cpu and gpu memory) = 1.003e-05 S  per = 0.0504  per(accum) = 98.7
 T(local opt: reduction of opS & opH [comm]) = 7.880e-05 S  per = 0.396  per(accum) = 99.1
 T(local opt: conversion from opAB to opPQ ) = 3.686e-06 S  per = 0.0185  per(accum) = 99.1
 T(local opt: after oper_renorm            ) = 1.797e-04 S  per = 0.902  per(accum) = 100
##### sweep opt: 3.620e-01 S #####
 T(sweep opt: fetch) = 2.050e-03 S  per = 0.566  per(accum) = 0.566
 T(sweep opt: hdiag) = 2.884e-03 S  per = 0.797  per(accum) = 1.36
 T(sweep opt: dvdsn) = 9.069e-02 S  per = 25.1  per(accum) = 26.4
 T(sweep opt: decim) = 1.921e-02 S  per = 5.31  per(accum) = 31.7
 T(sweep opt: guess) = 2.416e-03 S  per = 0.667  per(accum) = 32.4
 T(sweep opt: renrm) = 2.436e-01 S  per = 67.3  per(accum) = 99.7
 T(sweep opt: save ) = 1.189e-03 S  per = 0.328  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.069e-02 S  T(sum) = 9.028e-02 S  per = 9.955e+01
 T(sweep opt: preprocess                  ) = 4.572e-03 S  per = 5.06  per(accum) = 5.06
 T(sweep opt: symbolic_formulae           ) = 1.793e-03 S  per = 1.99  per(accum) = 7.05
 T(sweep opt: hintermediate init          ) = 1.713e-04 S  per = 0.19  per(accum) = 7.24
 T(sweep opt: preprocess_hformulae_Hxlist ) = 3.634e-02 S  per = 40.3  per(accum) = 47.5
 T(sweep opt: hmmtasks init               ) = 1.836e-02 S  per = 20.3  per(accum) = 67.8
 T(sweep opt: initial guess for dvdson    ) = 8.868e-06 S  per = 0.00982  per(accum) = 67.8
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 8.970e-03 S  per = 9.94  per(accum) = 77.8
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 1.403e-04 S  per = 0.155  per(accum) = 77.9
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 8.890e-07 S  per = 0.000985  per(accum) = 77.9
 T(sweep opt: dvdson solver [rest part]   ) = 1.992e-02 S  per = 22.1  per(accum) = 100
Detailed decomposition of T(renrm) = 2.436e-01 S  T(sum) = 2.436e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 9.616e-04 S  per = 0.395  per(accum) = 0.395
 T(sweep opt: qops init                    ) = 3.610e-03 S  per = 1.48  per(accum) = 1.88
 T(sweep opt: symbolic_formulae_renorm     ) = 1.582e-03 S  per = 0.65  per(accum) = 2.53
 T(sweep opt: allocate qops on gpu         ) = 6.933e-05 S  per = 0.0285  per(accum) = 2.56
 T(sweep opt: site memcpy cpu2gpu          ) = 6.339e-05 S  per = 0.026  per(accum) = 2.58
 T(sweep opt: rintermediate init           ) = 1.300e-04 S  per = 0.0534  per(accum) = 2.63
 T(sweep opt: preprocess_formulae_Rlist2   ) = 2.995e-02 S  per = 12.3  per(accum) = 14.9
 T(sweep opt: rmmtasks init                ) = 1.356e-02 S  per = 5.57  per(accum) = 20.5
 T(sweep opt: qops memset on cpu           ) = 1.000e-07 S  per = 4.11e-05  per(accum) = 20.5
 T(sweep opt: preprocess_renorm_batchGPU   ) = 2.948e-03 S  per = 1.21  per(accum) = 21.7
 T(sweep opt: reduction of opS & opH [nccl]) = 3.227e-06 S  per = 0.00132  per(accum) = 21.7
 T(sweep opt: qops memcpy gpu2cpu          ) = 5.912e-05 S  per = 0.0243  per(accum) = 21.7
 T(sweep opt: deallocate cpu and gpu memory) = 2.973e-05 S  per = 0.0122  per(accum) = 21.7
 T(sweep opt: reduction of opS & opH [comm]) = 2.305e-04 S  per = 0.0946  per(accum) = 21.8
 T(sweep opt: conversion from opAB to opPQ ) = 1.897e-01 S  per = 77.9  per(accum) = 99.7
 T(sweep opt: after oper_renorm            ) = 6.718e-04 S  per = 0.276  per(accum) = 100
##### global opt: 1.859e+00 S #####
 T(global opt: fetch) = 7.230e-03 S  per = 0.389  per(accum) = 0.389
 T(global opt: hdiag) = 1.996e-02 S  per = 1.07  per(accum) = 1.46
 T(global opt: dvdsn) = 1.099e+00 S  per = 59.1  per(accum) = 60.6
 T(global opt: decim) = 6.908e-02 S  per = 3.72  per(accum) = 64.3
 T(global opt: guess) = 1.067e-02 S  per = 0.574  per(accum) = 64.8
 T(global opt: renrm) = 6.422e-01 S  per = 34.5  per(accum) = 99.4
 T(global opt: save ) = 1.145e-02 S  per = 0.616  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.099e+00 S  T(sum) = 1.096e+00 S  per = 9.976e+01
 T(global opt: preprocess                  ) = 3.535e-02 S  per = 3.22  per(accum) = 3.22
 T(global opt: symbolic_formulae           ) = 9.356e-03 S  per = 0.853  per(accum) = 4.08
 T(global opt: hintermediate init          ) = 5.928e-04 S  per = 0.0541  per(accum) = 4.13
 T(global opt: preprocess_hformulae_Hxlist ) = 5.732e-01 S  per = 52.3  per(accum) = 56.4
 T(global opt: hmmtasks init               ) = 2.612e-01 S  per = 23.8  per(accum) = 80.2
 T(global opt: initial guess for dvdson    ) = 9.330e-03 S  per = 0.851  per(accum) = 81.1
 T(global opt: dvdson solver [Hx_batchGPU] ) = 6.392e-02 S  per = 5.83  per(accum) = 86.9
 T(global opt: dvdson solver [comm(gpu)]   ) = 7.521e-04 S  per = 0.0686  per(accum) = 87
 T(global opt: dvdson solver [comm(cpu)]   ) = 4.881e-06 S  per = 0.000445  per(accum) = 87
 T(global opt: dvdson solver [rest part]   ) = 1.425e-01 S  per =   13  per(accum) = 100
Detailed decomposition of T(renrm) = 6.422e-01 S  T(sum) = 6.422e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.278e-03 S  per = 0.666  per(accum) = 0.666
 T(global opt: qops init                    ) = 1.092e-02 S  per =  1.7  per(accum) = 2.37
 T(global opt: symbolic_formulae_renorm     ) = 5.291e-03 S  per = 0.824  per(accum) = 3.19
 T(global opt: allocate qops on gpu         ) = 2.414e-04 S  per = 0.0376  per(accum) = 3.23
 T(global opt: site memcpy cpu2gpu          ) = 3.585e-04 S  per = 0.0558  per(accum) = 3.28
 T(global opt: rintermediate init           ) = 5.942e-04 S  per = 0.0925  per(accum) = 3.38
 T(global opt: preprocess_formulae_Rlist2   ) = 9.566e-02 S  per = 14.9  per(accum) = 18.3
 T(global opt: rmmtasks init                ) = 4.237e-02 S  per =  6.6  per(accum) = 24.9
 T(global opt: qops memset on cpu           ) = 2.930e-07 S  per = 4.56e-05  per(accum) = 24.9
 T(global opt: preprocess_renorm_batchGPU   ) = 1.140e-02 S  per = 1.78  per(accum) = 26.6
 T(global opt: reduction of opS & opH [nccl]) = 1.001e-05 S  per = 0.00156  per(accum) = 26.6
 T(global opt: qops memcpy gpu2cpu          ) = 1.810e-04 S  per = 0.0282  per(accum) = 26.7
 T(global opt: deallocate cpu and gpu memory) = 9.376e-05 S  per = 0.0146  per(accum) = 26.7
 T(global opt: reduction of opS & opH [comm]) = 6.953e-04 S  per = 0.108  per(accum) = 26.8
 T(global opt: conversion from opAB to opPQ ) = 4.678e-01 S  per = 72.9  per(accum) = 99.7
 T(global opt: after oper_renorm            ) = 2.225e-03 S  per = 0.347  per(accum) = 100

isweep=1 ibond=3/seqsize=6 dots=1 dbond=(3,0)-(4,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.386e+02S Sys:1.437e+00S Total:1.401e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=20:1.526e-04MB:1.490e-07GB
total mem of comb=181:1.381e-03MB:1.349e-06GB
ctns::topology::check_partition: (sl,sr,sc)=4,1,1
 suppl= 0 1 2 3
 suppr= 5
 suppc= 4
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(3,0)
 fqop[1]=./scratch/sweep/rop(5,0)
 fqop[2]=./scratch/sweep/cop(4,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:4 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
 rqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 qops(tot)=471:3.593e-03MB:3.509e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(4,0) fdel=./scratch/sweep/lop(3,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
wf3(diml,dimr,dimc)=(10,3,3) nnz=20:1.526e-04MB
qtensor3: wf3 own=1 _data=0x4d9eabc0
qinfo3su2: wf3 sym=(6,0) dir=1,1,1 couple=0
 qbond: qrow nsym=6 dimAll=10
 (4,0):3 (3,1):2 (5,1):2 (4,2):1 (2,0):1 (6,0):1
 qbond: qcol nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=10 nblocks=63 size=20:1.526e-04MB
### DIAG TIMING: total=3.377e-04 t1=1.122e-05, t2=4.691e-05, t3=3.721e-05, t4=2.228e-04, t5=3.669e-06, t6=1.222e-05, t7=3.665e-06
duration_diagGPU:3.484e-04
duration_diagreduce:6.600e-08
duration_diagtransform:2.700e-07
----- TIMING FOR symbolic_formulae_onedot with size=36 : 4.228e-04 S -----
rank=0 GPUmem(GB): used=3.51e-06 (oper)=3.51e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=36
 no. of hintermediate operators=8
 no. of coefficients=32:0.000244MB:2.38e-07GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 3.270e-05 S -----
rank=0 GPUmem(GB): used=3.75e-06 (oper,hinter)=3.51e-06,2.38e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.00437 S size(H_formulae)=36 size(Hxlst2)=10 T(Hmu/Hxlist)=7.67e-05,0.0043 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.00442 S size(H_formulae)=36 size(Hxlst)=446 -----
rank=0 GPUmem(GB): used=4.72e-05 (oper,hinter,dvdson,batch)=3.51e-06,2.38e-07,2.98e-07,4.32e-05 blksize=3 blksize0=6 batchsize=446
ctns::pdvdsonSolver_nkr::solve_iter ndim=20 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.12e-05,7.02e-05,0.000423,8.09e-05,0.000602
 ndim=20:1.49e-07GB t[comm(intra)]=2.12e-05 speed=0.0141GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=7.0e-05 t_gemm=4.2e-04 t_reduction=8.1e-05 tot=5.7e-04 ---
 sigma[inter] counter=7 t=7.0e-05 per=1.2e+01 cost=2.7e+03 flops=3.8e+07
 sigma[gemm] counter=7 i=0 t=5.9e-05 per=1.0e+01 cost=5.9e+02 flops=1.0e+07
 sigma[gemm] counter=7 i=1 t=5.6e-05 per=9.8e+00 cost=5.9e+02 flops=1.1e+07
 sigma[gemm] counter=7 i=2 t=5.4e-05 per=9.4e+00 cost=5.9e+02 flops=1.1e+07
 sigma[gemm] counter=7 i=3 t=5.4e-05 per=9.4e+00 cost=5.9e+02 flops=1.1e+07
 sigma[gemm] counter=7 i=4 t=1.1e-04 per=1.9e+01 cost=1.5e+03 flops=1.4e+07
 sigma[gemm] counter=7 i=5 t=9.1e-05 per=1.6e+01 cost=1.5e+03 flops=1.6e+07
 sigma[gemm] counter=7 total t=4.2e-04 per=7.4e+01 cost=5.3e+03 flops=1.3e+07
 sigma[red] counter=7 t=8.1e-05 per=1.4e+01 cost=1.8e+03 flops=2.2e+07
--- TIMING FOR sigma_tot : t_inter=6.8e-04 t_gemm=6.4e-03 t_reduction=1.6e-03 tot=8.7e-03 ---
 sigma_tot[inter] counter=7 t=6.8e-04 per=7.8e+00 cost=6.0e+04 flops=8.8e+07
 sigma_tot[gemm] counter=7 i=0 t=6.1e-04 per=7.0e+00 cost=2.1e+04 flops=3.4e+07
 sigma_tot[gemm] counter=7 i=1 t=5.9e-04 per=6.8e+00 cost=2.1e+04 flops=3.5e+07
 sigma_tot[gemm] counter=7 i=2 t=1.3e-03 per=1.5e+01 cost=5.0e+04 flops=3.7e+07
 sigma_tot[gemm] counter=7 i=3 t=1.4e-03 per=1.6e+01 cost=4.9e+04 flops=3.5e+07
 sigma_tot[gemm] counter=7 i=4 t=1.2e-03 per=1.4e+01 cost=4.9e+04 flops=3.9e+07
 sigma_tot[gemm] counter=7 i=5 t=1.2e-03 per=1.4e+01 cost=4.8e+04 flops=4.0e+07
 sigma_tot[gemm] counter=7 total t=6.4e-03 per=7.3e+01 cost=2.4e+05 flops=3.7e+07
 sigma_tot[red] counter=7 t=1.6e-03 per=1.9e+01 cost=6.1e+04 flops=3.7e+07
T(sub)=8.8e-06 T(gemm/eig/ortho/gemm/axpy)=2.4e-06,3.9e-06,1.7e-06,6.1e-07,1.6e-07
settings: ndim=20 neig=1 maxcycle=30 nbuff=4 memory=2e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +      -3.235803828577 -1.003e+03  3.437e-05    1     1  7.223e-04 7.223e-04 7.001e-04
TIMING FOR Davidson : 7.384e-04  T(cal/comm/rest)=7.001e-04,1.470e-07,3.813e-05
decomposed t_rest=3.813e-05
 T(sub)    =8.780e-06 per=2.303e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =2.940e-07 per=7.711e-01
 T(xnrm2)  =3.630e-07 per=9.521e-01
 T(other)  =2.869e-05 per=7.525e+01
optimized energies: isweep=1 ibond=3 dots=1 e[0]=-3.235803828577 nmvp=1
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.386e+02S Sys:1.437e+00S Total:1.401e+02S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=6 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep1_ibond3.txt
 qbond: qsuper nsym=6 dimAll=10
 (0,0):1 (2,0):3 (1,1):2 (4,0):1 (3,1):2 (2,2):1
----- TMING FOR decimation_genbasis(su2): 4.7e-03 S -----
decimation summary: 10->10 dwt=+1.110e-16 SvN=6.967e-01
 qbond: qkept nsym=6 dimAll=10
 (2,0):3 (1,1):2 (3,1):2 (0,0):1 (4,0):1 (2,2):1
----- TIMING for decimation_row(nkr): 5.138e-03 S T(decim/select/formRot)=4.773e-03,2.960e-04,6.823e-05 -----
----- TIMING FOR onedot_decimation: 5.486e-03 S T(wf/decim)=2.710e-04,5.215e-03 -----
ctns::oper_renorm coord=(4,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:2 S:4 H:1 A:4 B:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.394e+02S Sys:1.437e+00S Total:1.408e+02S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=17 : 3.588e-04 S -----
rank=0 GPUmem(GB): used=5.84e-06 (oper)=3.51e-06
rank=0 GPUmem(GB): used=5.99e-06 (oper,site)(GB)=3.51e-06,1.49e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=17
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=5.99e-06 (oper,site,rinter)=3.51e-06,1.49e-07,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00426 S size(rtasks)=17 size(Rlst2)=36 T(Rmu/Rlist)=0.000111,0.00414 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0043 S size(rtasks)=17 size(Rlst)=326 -----
rank=0 GPUmem(GB): used=5.99e-06 (oper,site,rinter,batch)=3.51e-06,1.49e-07,0,4.61e-05 blksize=9 blksize0=0 batchsize=326
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.24e-06,0.000338,0.000137
--- TIMING FOR renorm : t_inter=8.0e-06 t_gemm=3.4e-04 t_reduction=1.4e-04 tot=4.8e-04 ---
 renorm[inter] counter=4 t=8.0e-06 per=1.7e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=0 t=7.6e-05 per=1.6e+01 cost=3.7e+02 flops=4.8e+06
 renorm[gemm] counter=4 i=1 t=5.8e-05 per=1.2e+01 cost=6.6e+02 flops=1.1e+07
 renorm[gemm] counter=4 i=2 t=5.5e-05 per=1.1e+01 cost=4.0e+02 flops=7.3e+06
 renorm[gemm] counter=4 i=3 t=5.6e-05 per=1.2e+01 cost=6.2e+02 flops=1.1e+07
 renorm[gemm] counter=4 i=4 t=1.4e-06 per=2.8e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=5 t=1.3e-06 per=2.7e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=4 i=6 t=9.0e-05 per=1.9e+01 cost=2.8e+03 flops=3.2e+07
 renorm[gemm] counter=4 total t=3.4e-04 per=7.0e+01 cost=4.9e+03 flops=1.5e+07
 renorm[red] counter=4 t=1.4e-04 per=2.8e+01 cost=2.8e+03 flops=2.1e+07
--- TIMING FOR renorm_tot : t_inter=1.9e-04 t_gemm=2.2e-03 t_reduction=7.1e-04 tot=3.1e-03 ---
 renorm_tot[inter] counter=4 t=1.9e-04 per=6.0e+00 cost=6.8e+03 flops=3.7e+07
 renorm_tot[gemm] counter=4 i=0 t=3.4e-04 per=1.1e+01 cost=6.2e+03 flops=1.8e+07
 renorm_tot[gemm] counter=4 i=1 t=2.7e-04 per=8.6e+00 cost=7.0e+03 flops=2.6e+07
 renorm_tot[gemm] counter=4 i=2 t=5.9e-05 per=1.9e+00 cost=4.0e+02 flops=6.8e+06
 renorm_tot[gemm] counter=4 i=3 t=5.9e-05 per=1.9e+00 cost=6.2e+02 flops=1.1e+07
 renorm_tot[gemm] counter=4 i=4 t=4.6e-04 per=1.5e+01 cost=1.0e+04 flops=2.3e+07
 renorm_tot[gemm] counter=4 i=5 t=4.6e-04 per=1.5e+01 cost=1.6e+04 flops=3.4e+07
 renorm_tot[gemm] counter=4 i=6 t=6.0e-04 per=1.9e+01 cost=3.6e+04 flops=6.1e+07
 renorm_tot[gemm] counter=4 total t=2.2e-03 per=7.1e+01 cost=7.7e+04 flops=3.4e+07
 renorm_tot[red] counter=4 t=7.1e-04 per=2.3e+01 cost=2.1e+04 flops=2.9e+07
qops.to_cpu: size(tot)=281:2.1e-03MB:2.1e-06GB t[to_cpu]=1.4e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=7.811e-16 coord=(4,0) rank=0
ctns::oper_ab2pq coord=(4,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00846 S rank=0 -----
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.402e+02S Sys:1.437e+00S Total:1.416e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=218:1.663e-03MB:1.624e-06GB
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.403e+02S Sys:1.437e+00S Total:1.417e+02S
##### local opt: 2.492e-02 S #####
 T(local opt: fetch) = 1.701e-04 S  per = 0.682  per(accum) = 0.682
 T(local opt: hdiag) = 4.918e-04 S  per = 1.97  per(accum) = 2.66
 T(local opt: dvdsn) = 8.653e-03 S  per = 34.7  per(accum) = 37.4
 T(local opt: decim) = 5.503e-03 S  per = 22.1  per(accum) = 59.5
 T(local opt: guess) = 8.191e-04 S  per = 3.29  per(accum) = 62.7
 T(local opt: renrm) = 8.899e-03 S  per = 35.7  per(accum) = 98.4
 T(local opt: save ) = 3.866e-04 S  per = 1.55  per(accum) = 100
Detailed decomposition of T(dvdsn) = 8.653e-03 S  T(sum) = 8.560e-03 S  per = 9.893e+01
 T(local opt: preprocess                  ) = 8.454e-04 S  per = 9.88  per(accum) = 9.88
 T(local opt: symbolic_formulae           ) = 4.325e-04 S  per = 5.05  per(accum) = 14.9
 T(local opt: hintermediate init          ) = 4.824e-05 S  per = 0.564  per(accum) = 15.5
 T(local opt: preprocess_hformulae_Hxlist ) = 4.439e-03 S  per = 51.9  per(accum) = 67.3
 T(local opt: hmmtasks init               ) = 2.054e-03 S  per =   24  per(accum) = 91.3
 T(local opt: initial guess for dvdson    ) = 2.897e-06 S  per = 0.0338  per(accum) = 91.4
 T(local opt: dvdson solver [Hx_batchGPU] ) = 6.789e-04 S  per = 7.93  per(accum) = 99.3
 T(local opt: dvdson solver [comm(gpu)]   ) = 2.119e-05 S  per = 0.248  per(accum) = 99.6
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.470e-07 S  per = 0.00172  per(accum) = 99.6
 T(local opt: dvdson solver [rest part]   ) = 3.813e-05 S  per = 0.445  per(accum) = 100
Detailed decomposition of T(renrm) = 8.899e-03 S  T(sum) = 8.899e-03 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 1.737e-04 S  per = 1.95  per(accum) = 1.95
 T(local opt: qops init                    ) = 1.049e-03 S  per = 11.8  per(accum) = 13.7
 T(local opt: symbolic_formulae_renorm     ) = 3.675e-04 S  per = 4.13  per(accum) = 17.9
 T(local opt: allocate qops on gpu         ) = 3.605e-05 S  per = 0.405  per(accum) = 18.3
 T(local opt: site memcpy cpu2gpu          ) = 2.123e-05 S  per = 0.239  per(accum) = 18.5
 T(local opt: rintermediate init           ) = 1.941e-05 S  per = 0.218  per(accum) = 18.7
 T(local opt: preprocess_formulae_Rlist2   ) = 4.321e-03 S  per = 48.6  per(accum) = 67.3
 T(local opt: rmmtasks init                ) = 1.939e-03 S  per = 21.8  per(accum) = 89.1
 T(local opt: qops memset on cpu           ) = 3.400e-08 S  per = 0.000382  per(accum) = 89.1
 T(local opt: preprocess_renorm_batchGPU   ) = 5.857e-04 S  per = 6.58  per(accum) = 95.7
 T(local opt: reduction of opS & opH [nccl]) = 1.033e-06 S  per = 0.0116  per(accum) = 95.7
 T(local opt: qops memcpy gpu2cpu          ) = 2.011e-05 S  per = 0.226  per(accum) = 95.9
 T(local opt: deallocate cpu and gpu memory) = 1.043e-05 S  per = 0.117  per(accum) = 96
 T(local opt: reduction of opS & opH [comm]) = 9.208e-05 S  per = 1.03  per(accum) = 97.1
 T(local opt: conversion from opAB to opPQ ) = 3.740e-06 S  per = 0.042  per(accum) = 97.1
 T(local opt: after oper_renorm            ) = 2.582e-04 S  per =  2.9  per(accum) = 100
##### sweep opt: 3.869e-01 S #####
 T(sweep opt: fetch) = 2.220e-03 S  per = 0.574  per(accum) = 0.574
 T(sweep opt: hdiag) = 3.376e-03 S  per = 0.872  per(accum) = 1.45
 T(sweep opt: dvdsn) = 9.934e-02 S  per = 25.7  per(accum) = 27.1
 T(sweep opt: decim) = 2.472e-02 S  per = 6.39  per(accum) = 33.5
 T(sweep opt: guess) = 3.235e-03 S  per = 0.836  per(accum) = 34.3
 T(sweep opt: renrm) = 2.525e-01 S  per = 65.2  per(accum) = 99.6
 T(sweep opt: save ) = 1.576e-03 S  per = 0.407  per(accum) = 100
Detailed decomposition of T(dvdsn) = 9.934e-02 S  T(sum) = 9.884e-02 S  per = 9.949e+01
 T(sweep opt: preprocess                  ) = 5.417e-03 S  per = 5.48  per(accum) = 5.48
 T(sweep opt: symbolic_formulae           ) = 2.225e-03 S  per = 2.25  per(accum) = 7.73
 T(sweep opt: hintermediate init          ) = 2.195e-04 S  per = 0.222  per(accum) = 7.95
 T(sweep opt: preprocess_hformulae_Hxlist ) = 4.078e-02 S  per = 41.3  per(accum) = 49.2
 T(sweep opt: hmmtasks init               ) = 2.041e-02 S  per = 20.7  per(accum) = 69.9
 T(sweep opt: initial guess for dvdson    ) = 1.177e-05 S  per = 0.0119  per(accum) = 69.9
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 9.649e-03 S  per = 9.76  per(accum) = 79.6
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 1.615e-04 S  per = 0.163  per(accum) = 79.8
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.036e-06 S  per = 0.00105  per(accum) = 79.8
 T(sweep opt: dvdson solver [rest part]   ) = 1.996e-02 S  per = 20.2  per(accum) = 100
Detailed decomposition of T(renrm) = 2.525e-01 S  T(sum) = 2.525e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.135e-03 S  per = 0.45  per(accum) = 0.45
 T(sweep opt: qops init                    ) = 4.659e-03 S  per = 1.85  per(accum) = 2.3
 T(sweep opt: symbolic_formulae_renorm     ) = 1.950e-03 S  per = 0.772  per(accum) = 3.07
 T(sweep opt: allocate qops on gpu         ) = 1.054e-04 S  per = 0.0417  per(accum) = 3.11
 T(sweep opt: site memcpy cpu2gpu          ) = 8.462e-05 S  per = 0.0335  per(accum) = 3.14
 T(sweep opt: rintermediate init           ) = 1.494e-04 S  per = 0.0592  per(accum) = 3.2
 T(sweep opt: preprocess_formulae_Rlist2   ) = 3.427e-02 S  per = 13.6  per(accum) = 16.8
 T(sweep opt: rmmtasks init                ) = 1.550e-02 S  per = 6.14  per(accum) = 22.9
 T(sweep opt: qops memset on cpu           ) = 1.340e-07 S  per = 5.31e-05  per(accum) = 22.9
 T(sweep opt: preprocess_renorm_batchGPU   ) = 3.534e-03 S  per =  1.4  per(accum) = 24.3
 T(sweep opt: reduction of opS & opH [nccl]) = 4.260e-06 S  per = 0.00169  per(accum) = 24.3
 T(sweep opt: qops memcpy gpu2cpu          ) = 7.924e-05 S  per = 0.0314  per(accum) = 24.3
 T(sweep opt: deallocate cpu and gpu memory) = 4.016e-05 S  per = 0.0159  per(accum) = 24.4
 T(sweep opt: reduction of opS & opH [comm]) = 3.226e-04 S  per = 0.128  per(accum) = 24.5
 T(sweep opt: conversion from opAB to opPQ ) = 1.897e-01 S  per = 75.1  per(accum) = 99.6
 T(sweep opt: after oper_renorm            ) = 9.301e-04 S  per = 0.368  per(accum) = 100
##### global opt: 1.884e+00 S #####
 T(global opt: fetch) = 7.400e-03 S  per = 0.393  per(accum) = 0.393
 T(global opt: hdiag) = 2.045e-02 S  per = 1.09  per(accum) = 1.48
 T(global opt: dvdsn) = 1.107e+00 S  per = 58.8  per(accum) = 60.3
 T(global opt: decim) = 7.458e-02 S  per = 3.96  per(accum) = 64.2
 T(global opt: guess) = 1.149e-02 S  per = 0.61  per(accum) = 64.8
 T(global opt: renrm) = 6.511e-01 S  per = 34.6  per(accum) = 99.4
 T(global opt: save ) = 1.184e-02 S  per = 0.628  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.107e+00 S  T(sum) = 1.105e+00 S  per = 9.975e+01
 T(global opt: preprocess                  ) = 3.620e-02 S  per = 3.28  per(accum) = 3.28
 T(global opt: symbolic_formulae           ) = 9.788e-03 S  per = 0.886  per(accum) = 4.16
 T(global opt: hintermediate init          ) = 6.411e-04 S  per = 0.058  per(accum) = 4.22
 T(global opt: preprocess_hformulae_Hxlist ) = 5.776e-01 S  per = 52.3  per(accum) = 56.5
 T(global opt: hmmtasks init               ) = 2.633e-01 S  per = 23.8  per(accum) = 80.3
 T(global opt: initial guess for dvdson    ) = 9.333e-03 S  per = 0.845  per(accum) = 81.2
 T(global opt: dvdson solver [Hx_batchGPU] ) = 6.460e-02 S  per = 5.85  per(accum) = 87
 T(global opt: dvdson solver [comm(gpu)]   ) = 7.733e-04 S  per = 0.07  per(accum) = 87.1
 T(global opt: dvdson solver [comm(cpu)]   ) = 5.028e-06 S  per = 0.000455  per(accum) = 87.1
 T(global opt: dvdson solver [rest part]   ) = 1.426e-01 S  per = 12.9  per(accum) = 100
Detailed decomposition of T(renrm) = 6.511e-01 S  T(sum) = 6.511e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.452e-03 S  per = 0.684  per(accum) = 0.684
 T(global opt: qops init                    ) = 1.197e-02 S  per = 1.84  per(accum) = 2.52
 T(global opt: symbolic_formulae_renorm     ) = 5.659e-03 S  per = 0.869  per(accum) = 3.39
 T(global opt: allocate qops on gpu         ) = 2.775e-04 S  per = 0.0426  per(accum) = 3.43
 T(global opt: site memcpy cpu2gpu          ) = 3.797e-04 S  per = 0.0583  per(accum) = 3.49
 T(global opt: rintermediate init           ) = 6.136e-04 S  per = 0.0942  per(accum) = 3.59
 T(global opt: preprocess_formulae_Rlist2   ) = 9.998e-02 S  per = 15.4  per(accum) = 18.9
 T(global opt: rmmtasks init                ) = 4.431e-02 S  per = 6.81  per(accum) = 25.7
 T(global opt: qops memset on cpu           ) = 3.270e-07 S  per = 5.02e-05  per(accum) = 25.7
 T(global opt: preprocess_renorm_batchGPU   ) = 1.199e-02 S  per = 1.84  per(accum) = 27.6
 T(global opt: reduction of opS & opH [nccl]) = 1.105e-05 S  per = 0.0017  per(accum) = 27.6
 T(global opt: qops memcpy gpu2cpu          ) = 2.011e-04 S  per = 0.0309  per(accum) = 27.6
 T(global opt: deallocate cpu and gpu memory) = 1.042e-04 S  per = 0.016  per(accum) = 27.6
 T(global opt: reduction of opS & opH [comm]) = 7.874e-04 S  per = 0.121  per(accum) = 27.8
 T(global opt: conversion from opAB to opPQ ) = 4.678e-01 S  per = 71.9  per(accum) = 99.6
 T(global opt: after oper_renorm            ) = 2.484e-03 S  per = 0.381  per(accum) = 100

isweep=1 ibond=4/seqsize=6 dots=1 dbond=(2,0)-(3,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.403e+02S Sys:1.438e+00S Total:1.418e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=218:1.663e-03MB:1.624e-06GB
ctns::topology::check_partition: (sl,sr,sc)=3,2,1
 suppl= 0 1 2
 suppr= 4 5
 suppc= 3
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(2,0)
 fqop[1]=./scratch/sweep/rop(4,0)
 fqop[2]=./scratch/sweep/cop(3,0)
qops info: rank=0
 lqops: oplist=CSHPQ nops=C:3 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=10,10 size(op)=21:1.602e-04MB size(tot)=458:3.494e-03MB:3.412e-06GB
 rqops: oplist=CSHAB nops=C:2 S:4 H:1 A:4 B:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 qops(tot)=834:6.363e-03MB:6.214e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(3,0) fdel=./scratch/sweep/lop(2,0)
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
wf3(diml,dimr,dimc)=(10,10,3) nnz=57:4.349e-04MB
qtensor3: wf3 own=1 _data=0x4dac59e0
qinfo3su2: wf3 sym=(6,0) dir=1,1,1 couple=0
 qbond: qrow nsym=6 dimAll=10
 (3,1):3 (2,0):2 (4,0):2 (2,2):1 (5,1):1 (4,2):1
 qbond: qcol nsym=6 dimAll=10
 (2,0):3 (1,1):2 (3,1):2 (0,0):1 (4,0):1 (2,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=16 nblocks=132 size=57:4.349e-04MB
### DIAG TIMING: total=8.215e-04 t1=9.344e-06, t2=9.025e-05, t3=5.306e-05, t4=6.493e-04, t5=3.497e-06, t6=1.274e-05, t7=3.307e-06
duration_diagGPU:8.326e-04
duration_diagreduce:4.600e-08
duration_diagtransform:5.650e-07
----- TIMING FOR symbolic_formulae_onedot with size=68 : 6.420e-04 S -----
rank=0 GPUmem(GB): used=6.21e-06 (oper)=6.21e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=68
 no. of hintermediate operators=22
 no. of coefficients=66:0.000504MB:4.92e-07GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 4.230e-05 S -----
rank=0 GPUmem(GB): used=6.71e-06 (oper,hinter)=6.21e-06,4.92e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0156 S size(H_formulae)=68 size(Hxlst2)=16 T(Hmu/Hxlist)=0.000155,0.0154 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.0157 S size(H_formulae)=68 size(Hxlst)=1520 -----
rank=0 GPUmem(GB): used=0.000291 (oper,hinter,dvdson,batch)=6.21e-06,4.92e-07,8.49e-07,0.000283 blksize=9 blksize0=6 batchsize=1520
ctns::pdvdsonSolver_nkr::solve_iter ndim=57 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.03e-05,9.04e-05,0.000876,0.000137,0.00114
 ndim=57:4.25e-07GB t[comm(intra)]=3.03e-05 speed=0.028GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=9.0e-05 t_gemm=8.8e-04 t_reduction=1.4e-04 tot=1.1e-03 ---
 sigma[inter] counter=8 t=9.0e-05 per=8.2e+00 cost=1.1e+04 flops=1.2e+08
 sigma[gemm] counter=8 i=0 t=8.2e-05 per=7.4e+00 cost=4.0e+03 flops=4.9e+07
 sigma[gemm] counter=8 i=1 t=7.7e-05 per=7.0e+00 cost=3.8e+03 flops=5.0e+07
 sigma[gemm] counter=8 i=2 t=1.8e-04 per=1.6e+01 cost=9.7e+03 flops=5.4e+07
 sigma[gemm] counter=8 i=3 t=1.8e-04 per=1.7e+01 cost=9.4e+03 flops=5.1e+07
 sigma[gemm] counter=8 i=4 t=1.8e-04 per=1.6e+01 cost=9.2e+03 flops=5.1e+07
 sigma[gemm] counter=8 i=5 t=1.7e-04 per=1.6e+01 cost=9.2e+03 flops=5.3e+07
 sigma[gemm] counter=8 total t=8.8e-04 per=7.9e+01 cost=4.5e+04 flops=5.2e+07
 sigma[red] counter=8 t=1.4e-04 per=1.2e+01 cost=1.2e+04 flops=8.4e+07
--- TIMING FOR sigma_tot : t_inter=7.7e-04 t_gemm=7.3e-03 t_reduction=1.8e-03 tot=9.8e-03 ---
 sigma_tot[inter] counter=8 t=7.7e-04 per=7.8e+00 cost=7.1e+04 flops=9.2e+07
 sigma_tot[gemm] counter=8 i=0 t=7.0e-04 per=7.1e+00 cost=2.5e+04 flops=3.6e+07
 sigma_tot[gemm] counter=8 i=1 t=6.7e-04 per=6.8e+00 cost=2.4e+04 flops=3.6e+07
 sigma_tot[gemm] counter=8 i=2 t=1.5e-03 per=1.5e+01 cost=6.0e+04 flops=3.9e+07
 sigma_tot[gemm] counter=8 i=3 t=1.6e-03 per=1.6e+01 cost=5.8e+04 flops=3.7e+07
 sigma_tot[gemm] counter=8 i=4 t=1.4e-03 per=1.5e+01 cost=5.8e+04 flops=4.1e+07
 sigma_tot[gemm] counter=8 i=5 t=1.4e-03 per=1.4e+01 cost=5.8e+04 flops=4.1e+07
 sigma_tot[gemm] counter=8 total t=7.3e-03 per=7.4e+01 cost=2.8e+05 flops=3.9e+07
 sigma_tot[red] counter=8 t=1.8e-03 per=1.8e+01 cost=7.3e+04 flops=4.1e+07
T(sub)=9.1e-06 T(gemm/eig/ortho/gemm/axpy)=2.5e-06,3.9e-06,2.0e-06,6.2e-07,1.5e-07
settings: ndim=57 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 +      -3.235803828577 -1.003e+03  5.011e-05    1     1  1.275e-03 1.275e-03 1.250e-03
TIMING FOR Davidson : 1.308e-03  T(cal/comm/rest)=1.250e-03,1.240e-07,5.831e-05
decomposed t_rest=5.831e-05
 T(sub)    =9.118e-06 per=1.564e+01
 T(precond)=0.000e+00 per=0.000e+00
 T(ortho)  =0.000e+00 per=0.000e+00
 T(xcopy)  =1.356e-05 per=2.325e+01
 T(xnrm2)  =3.740e-07 per=6.414e-01
 T(other)  =3.526e-05 per=6.047e+01
optimized energies: isweep=1 ibond=4 dots=1 e[0]=-3.235803828577 nmvp=1
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.406e+02S Sys:1.438e+00S Total:1.421e+02S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=10 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep1_ibond4.txt
 qbond: qsuper nsym=10 dimAll=35
 (2,0):6 (1,1):3 (3,1):8 (0,0):1 (4,0):6 (2,2):3 (5,1):3 (6,0):1 (4,2):3 (3,3):1
----- TMING FOR decimation_genbasis(su2): 5.1e-03 S -----
decimation summary: 35->10 dwt=+0.000e+00 SvN=8.874e-01
 qbond: qkept nsym=6 dimAll=10
 (3,1):3 (2,0):2 (4,0):2 (1,1):1 (2,2):1 (4,2):1
----- TIMING for decimation_row(nkr): 5.586e-03 S T(decim/select/formRot)=5.190e-03,2.934e-04,1.021e-04 -----
----- TIMING FOR onedot_decimation: 6.190e-03 S T(wf/decim)=4.888e-04,5.701e-03 -----
ctns::oper_renorm coord=(3,0) superblock=cr oplist=CSHAB ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHAB nops=C:3 S:3 H:1 A:9 B:12 
        dim(bra,ket)=10,10 size(op)=21:1.602e-04MB size(tot)=458:3.494e-03MB:3.412e-06GB
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.416e+02S Sys:1.439e+00S Total:1.430e+02S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=28 : 6.529e-04 S -----
rank=0 GPUmem(GB): used=6.71e-06 (oper)=6.21e-06
rank=0 GPUmem(GB): used=7.13e-06 (oper,site)(GB)=6.21e-06,4.25e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=28
 no. of rintermediate operators=9
 no. of coefficients=18:0.000137MB:1.34e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 3.825e-05 S -----
rank=0 GPUmem(GB): used=7.26e-06 (oper,site,rinter)=6.21e-06,4.25e-07,1.34e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.014 S size(rtasks)=28 size(Rlst2)=36 T(Rmu/Rlist)=0.000204,0.0138 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0142 S size(rtasks)=28 size(Rlst)=1114 -----
rank=0 GPUmem(GB): used=7.26e-06 (oper,site,rinter,batch)=6.21e-06,4.25e-07,1.34e-07,0.000207 blksize=9 blksize0=6 batchsize=1114
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.94e-05,0.000721,0.000176
--- TIMING FOR renorm : t_inter=7.9e-05 t_gemm=7.2e-04 t_reduction=1.8e-04 tot=9.7e-04 ---
 renorm[inter] counter=5 t=7.9e-05 per=8.1e+00 cost=1.4e+03 flops=1.8e+07
 renorm[gemm] counter=5 i=0 t=9.2e-05 per=9.4e+00 cost=3.3e+03 flops=3.6e+07
 renorm[gemm] counter=5 i=1 t=7.4e-05 per=7.6e+00 cost=3.5e+03 flops=4.7e+07
 renorm[gemm] counter=5 i=2 t=1.8e-04 per=1.8e+01 cost=6.3e+03 flops=3.6e+07
 renorm[gemm] counter=5 i=3 t=1.8e-04 per=1.8e+01 cost=8.6e+03 flops=4.9e+07
 renorm[gemm] counter=5 i=4 t=1.2e-06 per=1.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=5 t=1.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=5 i=6 t=2.0e-04 per=2.0e+01 cost=1.8e+04 flops=8.8e+07
 renorm[gemm] counter=5 total t=7.2e-04 per=7.4e+01 cost=3.9e+04 flops=5.5e+07
 renorm[red] counter=5 t=1.8e-04 per=1.8e+01 cost=9.0e+03 flops=5.1e+07
--- TIMING FOR renorm_tot : t_inter=2.7e-04 t_gemm=3.0e-03 t_reduction=8.9e-04 tot=4.1e-03 ---
 renorm_tot[inter] counter=5 t=2.7e-04 per=6.5e+00 cost=8.3e+03 flops=3.1e+07
 renorm_tot[gemm] counter=5 i=0 t=4.3e-04 per=1.0e+01 cost=9.5e+03 flops=2.2e+07
 renorm_tot[gemm] counter=5 i=1 t=3.4e-04 per=8.3e+00 cost=1.1e+04 flops=3.1e+07
 renorm_tot[gemm] counter=5 i=2 t=2.3e-04 per=5.7e+00 cost=6.7e+03 flops=2.8e+07
 renorm_tot[gemm] counter=5 i=3 t=2.4e-04 per=5.8e+00 cost=9.3e+03 flops=3.9e+07
 renorm_tot[gemm] counter=5 i=4 t=4.6e-04 per=1.1e+01 cost=1.0e+04 flops=2.3e+07
 renorm_tot[gemm] counter=5 i=5 t=4.6e-04 per=1.1e+01 cost=1.6e+04 flops=3.4e+07
 renorm_tot[gemm] counter=5 i=6 t=7.9e-04 per=1.9e+01 cost=5.4e+04 flops=6.8e+07
 renorm_tot[gemm] counter=5 total t=3.0e-03 per=7.2e+01 cost=1.2e+05 flops=3.9e+07
 renorm_tot[red] counter=5 t=8.9e-04 per=2.2e+01 cost=3.0e+04 flops=3.4e+07
qops.to_cpu: size(tot)=458:3.5e-03MB:3.4e-06GB t[to_cpu]=1.4e-05S speed=2.4e-01GB/S
check ||H-H.dagger||=5.389e-16 coord=(3,0) rank=0
ctns::oper_ab2pq coord=(3,0) superblock=cr ab2pq=1 alg_renorm=19
----- TIMING FOR oper_ab2pq : 0.189 S T(init/copyCSH/opP/opQ/to_gpu/move)=0.00106,5.3e-06,0.0782,0.11,0.00016,0.000177 -----
----- TIMING FOR oper_renorm : 0.0243 S rank=0 -----
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.636e+02S Sys:1.443e+00S Total:1.651e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=218:1.663e-03MB:1.624e-06GB
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.637e+02S Sys:1.443e+00S Total:1.651e+02S
##### local opt: 2.513e-01 S #####
 T(local opt: fetch) = 1.649e-04 S  per = 0.0656  per(accum) = 0.0656
 T(local opt: hdiag) = 1.095e-03 S  per = 0.436  per(accum) = 0.502
 T(local opt: dvdsn) = 2.766e-02 S  per =   11  per(accum) = 11.5
 T(local opt: decim) = 6.208e-03 S  per = 2.47  per(accum) = 14
 T(local opt: guess) = 1.113e-03 S  per = 0.443  per(accum) = 14.4
 T(local opt: renrm) = 2.146e-01 S  per = 85.4  per(accum) = 99.8
 T(local opt: save ) = 4.704e-04 S  per = 0.187  per(accum) = 100
Detailed decomposition of T(dvdsn) = 2.766e-02 S  T(sum) = 2.757e-02 S  per = 9.965e+01
 T(local opt: preprocess                  ) = 1.694e-03 S  per = 6.15  per(accum) = 6.15
 T(local opt: symbolic_formulae           ) = 6.524e-04 S  per = 2.37  per(accum) = 8.51
 T(local opt: hintermediate init          ) = 5.643e-05 S  per = 0.205  per(accum) = 8.72
 T(local opt: preprocess_hformulae_Hxlist ) = 1.576e-02 S  per = 57.2  per(accum) = 65.9
 T(local opt: hmmtasks init               ) = 8.095e-03 S  per = 29.4  per(accum) = 95.2
 T(local opt: initial guess for dvdson    ) = 3.039e-06 S  per = 0.011  per(accum) = 95.3
 T(local opt: dvdson solver [Hx_batchGPU] ) = 1.219e-03 S  per = 4.42  per(accum) = 99.7
 T(local opt: dvdson solver [comm(gpu)]   ) = 3.029e-05 S  per = 0.11  per(accum) = 99.8
 T(local opt: dvdson solver [comm(cpu)]   ) = 1.240e-07 S  per = 0.00045  per(accum) = 99.8
 T(local opt: dvdson solver [rest part]   ) = 5.831e-05 S  per = 0.211  per(accum) = 100
Detailed decomposition of T(renrm) = 2.146e-01 S  T(sum) = 2.146e-01 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.680e-04 S  per = 0.171  per(accum) = 0.171
 T(local opt: qops init                    ) = 1.505e-03 S  per = 0.701  per(accum) = 0.873
 T(local opt: symbolic_formulae_renorm     ) = 6.624e-04 S  per = 0.309  per(accum) = 1.18
 T(local opt: allocate qops on gpu         ) = 2.306e-05 S  per = 0.0107  per(accum) = 1.19
 T(local opt: site memcpy cpu2gpu          ) = 1.922e-05 S  per = 0.00896  per(accum) = 1.2
 T(local opt: rintermediate init           ) = 4.844e-05 S  per = 0.0226  per(accum) = 1.22
 T(local opt: preprocess_formulae_Rlist2   ) = 1.419e-02 S  per = 6.61  per(accum) = 7.84
 T(local opt: rmmtasks init                ) = 6.700e-03 S  per = 3.12  per(accum) = 11
 T(local opt: qops memset on cpu           ) = 4.300e-08 S  per = 2e-05  per(accum) = 11
 T(local opt: preprocess_renorm_batchGPU   ) = 1.075e-03 S  per = 0.501  per(accum) = 11.5
 T(local opt: reduction of opS & opH [nccl]) = 9.560e-07 S  per = 0.000445  per(accum) = 11.5
 T(local opt: qops memcpy gpu2cpu          ) = 2.007e-05 S  per = 0.00935  per(accum) = 11.5
 T(local opt: deallocate cpu and gpu memory) = 9.833e-06 S  per = 0.00458  per(accum) = 11.5
 T(local opt: reduction of opS & opH [comm]) = 7.457e-05 S  per = 0.0347  per(accum) = 11.5
 T(local opt: conversion from opAB to opPQ ) = 1.894e-01 S  per = 88.3  per(accum) = 99.8
 T(local opt: after oper_renorm            ) = 4.507e-04 S  per = 0.21  per(accum) = 100
##### sweep opt: 6.382e-01 S #####
 T(sweep opt: fetch) = 2.385e-03 S  per = 0.374  per(accum) = 0.374
 T(sweep opt: hdiag) = 4.471e-03 S  per = 0.701  per(accum) = 1.07
 T(sweep opt: dvdsn) = 1.270e-01 S  per = 19.9  per(accum) = 21
 T(sweep opt: decim) = 3.093e-02 S  per = 4.85  per(accum) = 25.8
 T(sweep opt: guess) = 4.348e-03 S  per = 0.681  per(accum) = 26.5
 T(sweep opt: renrm) = 4.671e-01 S  per = 73.2  per(accum) = 99.7
 T(sweep opt: save ) = 2.046e-03 S  per = 0.321  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.270e-01 S  T(sum) = 1.264e-01 S  per = 9.953e+01
 T(sweep opt: preprocess                  ) = 7.111e-03 S  per = 5.63  per(accum) = 5.63
 T(sweep opt: symbolic_formulae           ) = 2.878e-03 S  per = 2.28  per(accum) = 7.9
 T(sweep opt: hintermediate init          ) = 2.760e-04 S  per = 0.218  per(accum) = 8.12
 T(sweep opt: preprocess_hformulae_Hxlist ) = 5.654e-02 S  per = 44.7  per(accum) = 52.8
 T(sweep opt: hmmtasks init               ) = 2.851e-02 S  per = 22.6  per(accum) = 75.4
 T(sweep opt: initial guess for dvdson    ) = 1.480e-05 S  per = 0.0117  per(accum) = 75.4
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.087e-02 S  per =  8.6  per(accum) = 84
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 1.918e-04 S  per = 0.152  per(accum) = 84.2
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.160e-06 S  per = 0.000918  per(accum) = 84.2
 T(sweep opt: dvdson solver [rest part]   ) = 2.002e-02 S  per = 15.8  per(accum) = 100
Detailed decomposition of T(renrm) = 4.671e-01 S  T(sum) = 4.671e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.503e-03 S  per = 0.322  per(accum) = 0.322
 T(sweep opt: qops init                    ) = 6.164e-03 S  per = 1.32  per(accum) = 1.64
 T(sweep opt: symbolic_formulae_renorm     ) = 2.612e-03 S  per = 0.559  per(accum) = 2.2
 T(sweep opt: allocate qops on gpu         ) = 1.284e-04 S  per = 0.0275  per(accum) = 2.23
 T(sweep opt: site memcpy cpu2gpu          ) = 1.038e-04 S  per = 0.0222  per(accum) = 2.25
 T(sweep opt: rintermediate init           ) = 1.978e-04 S  per = 0.0424  per(accum) = 2.29
 T(sweep opt: preprocess_formulae_Rlist2   ) = 4.846e-02 S  per = 10.4  per(accum) = 12.7
 T(sweep opt: rmmtasks init                ) = 2.220e-02 S  per = 4.75  per(accum) = 17.4
 T(sweep opt: qops memset on cpu           ) = 1.770e-07 S  per = 3.79e-05  per(accum) = 17.4
 T(sweep opt: preprocess_renorm_batchGPU   ) = 4.609e-03 S  per = 0.987  per(accum) = 18.4
 T(sweep opt: reduction of opS & opH [nccl]) = 5.216e-06 S  per = 0.00112  per(accum) = 18.4
 T(sweep opt: qops memcpy gpu2cpu          ) = 9.931e-05 S  per = 0.0213  per(accum) = 18.4
 T(sweep opt: deallocate cpu and gpu memory) = 5.000e-05 S  per = 0.0107  per(accum) = 18.4
 T(sweep opt: reduction of opS & opH [comm]) = 3.972e-04 S  per = 0.085  per(accum) = 18.5
 T(sweep opt: conversion from opAB to opPQ ) = 3.792e-01 S  per = 81.2  per(accum) = 99.7
 T(sweep opt: after oper_renorm            ) = 1.381e-03 S  per = 0.296  per(accum) = 100
##### global opt: 2.136e+00 S #####
 T(global opt: fetch) = 7.565e-03 S  per = 0.354  per(accum) = 0.354
 T(global opt: hdiag) = 2.155e-02 S  per = 1.01  per(accum) = 1.36
 T(global opt: dvdsn) = 1.135e+00 S  per = 53.2  per(accum) = 54.5
 T(global opt: decim) = 8.079e-02 S  per = 3.78  per(accum) = 58.3
 T(global opt: guess) = 1.260e-02 S  per = 0.59  per(accum) = 58.9
 T(global opt: renrm) = 8.657e-01 S  per = 40.5  per(accum) = 99.4
 T(global opt: save ) = 1.231e-02 S  per = 0.576  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.135e+00 S  T(sum) = 1.132e+00 S  per = 9.975e+01
 T(global opt: preprocess                  ) = 3.789e-02 S  per = 3.35  per(accum) = 3.35
 T(global opt: symbolic_formulae           ) = 1.044e-02 S  per = 0.922  per(accum) = 4.27
 T(global opt: hintermediate init          ) = 6.975e-04 S  per = 0.0616  per(accum) = 4.33
 T(global opt: preprocess_hformulae_Hxlist ) = 5.934e-01 S  per = 52.4  per(accum) = 56.7
 T(global opt: hmmtasks init               ) = 2.714e-01 S  per =   24  per(accum) = 80.7
 T(global opt: initial guess for dvdson    ) = 9.336e-03 S  per = 0.825  per(accum) = 81.5
 T(global opt: dvdson solver [Hx_batchGPU] ) = 6.582e-02 S  per = 5.81  per(accum) = 87.3
 T(global opt: dvdson solver [comm(gpu)]   ) = 8.035e-04 S  per = 0.071  per(accum) = 87.4
 T(global opt: dvdson solver [comm(cpu)]   ) = 5.152e-06 S  per = 0.000455  per(accum) = 87.4
 T(global opt: dvdson solver [rest part]   ) = 1.426e-01 S  per = 12.6  per(accum) = 100
Detailed decomposition of T(renrm) = 8.657e-01 S  T(sum) = 8.657e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 4.820e-03 S  per = 0.557  per(accum) = 0.557
 T(global opt: qops init                    ) = 1.348e-02 S  per = 1.56  per(accum) = 2.11
 T(global opt: symbolic_formulae_renorm     ) = 6.321e-03 S  per = 0.73  per(accum) = 2.84
 T(global opt: allocate qops on gpu         ) = 3.005e-04 S  per = 0.0347  per(accum) = 2.88
 T(global opt: site memcpy cpu2gpu          ) = 3.989e-04 S  per = 0.0461  per(accum) = 2.92
 T(global opt: rintermediate init           ) = 6.620e-04 S  per = 0.0765  per(accum) = 3
 T(global opt: preprocess_formulae_Rlist2   ) = 1.142e-01 S  per = 13.2  per(accum) = 16.2
 T(global opt: rmmtasks init                ) = 5.101e-02 S  per = 5.89  per(accum) = 22.1
 T(global opt: qops memset on cpu           ) = 3.700e-07 S  per = 4.27e-05  per(accum) = 22.1
 T(global opt: preprocess_renorm_batchGPU   ) = 1.306e-02 S  per = 1.51  per(accum) = 23.6
 T(global opt: reduction of opS & opH [nccl]) = 1.200e-05 S  per = 0.00139  per(accum) = 23.6
 T(global opt: qops memcpy gpu2cpu          ) = 2.212e-04 S  per = 0.0255  per(accum) = 23.6
 T(global opt: deallocate cpu and gpu memory) = 1.140e-04 S  per = 0.0132  per(accum) = 23.6
 T(global opt: reduction of opS & opH [comm]) = 8.619e-04 S  per = 0.0996  per(accum) = 23.7
 T(global opt: conversion from opAB to opPQ ) = 6.573e-01 S  per = 75.9  per(accum) = 99.7
 T(global opt: after oper_renorm            ) = 2.934e-03 S  per = 0.339  per(accum) = 100

isweep=1 ibond=5/seqsize=6 dots=1 dbond=(1,0)-(2,0) forward=0 cturn=0
----------------------------------------------------------------------
ctns::sweep_onedot ifabelian=0 alg_hvec=19 alg_renorm=19 mpisize=1 maxthreads=112
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.638e+02S Sys:1.443e+00S Total:1.653e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=57:4.349e-04MB:4.247e-07GB
total mem of comb=218:1.663e-03MB:1.624e-06GB
ctns::topology::check_partition: (sl,sr,sc)=2,3,1
 suppl= 0 1
 suppr= 3 4 5
 suppc= 2
ctns::topology::get_fqops dots=1
 fqop[0]=./scratch/sweep/lop(1,0)
 fqop[1]=./scratch/sweep/rop(3,0)
 fqop[2]=./scratch/sweep/cop(2,0)
qops info: rank=0
 lqops: oplist=CSHAB nops=C:2 S:4 H:1 A:4 B:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
 rqops: oplist=CSHPQ nops=C:3 S:3 H:1 P:9 Q:12 
        dim(bra,ket)=10,10 size(op)=21:1.602e-04MB size(tot)=458:3.494e-03MB:3.412e-06GB
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.289e-05MB size(tot)=95:7.248e-04MB:7.078e-07GB
 qops(tot)=834:6.363e-03MB:6.214e-06GB
ctns::topology::get_fbond frop=./scratch/sweep/rop(2,0) fdel=./scratch/sweep/lop(1,0)
wf3(diml,dimr,dimc)=(10,10,3) nnz=57:4.349e-04MB
qtensor3: wf3 own=1 _data=0x4dcab6b0
qinfo3su2: wf3 sym=(6,0) dir=1,1,1 couple=1
 qbond: qrow nsym=6 dimAll=10
 (2,0):3 (1,1):2 (3,1):2 (0,0):1 (4,0):1 (2,2):1
 qbond: qcol nsym=6 dimAll=10
 (3,1):3 (2,0):2 (4,0):2 (1,1):1 (2,2):1 (4,2):1
 qbond: qmid nsym=3 dimAll=3
 (0,0):1 (2,0):1 (1,1):1
total no. of nonzero blocks=16 nblocks=132 size=57:4.349e-04MB
### DIAG TIMING: total=1.085e-03 t1=1.325e-05, t2=1.086e-04, t3=7.804e-05, t4=8.524e-04, t5=4.708e-06, t6=2.358e-05, t7=4.686e-06
duration_diagGPU:1.104e-03
duration_diagreduce:7.800e-08
duration_diagtransform:7.010e-07
----- TIMING FOR symbolic_formulae_onedot with size=68 : 8.119e-04 S -----
rank=0 GPUmem(GB): used=6.21e-06 (oper)=6.21e-06
hintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=68
 no. of hintermediate operators=22
 no. of coefficients=66:0.000504MB:4.92e-07GB
----- TIMING FOR hintermediates<ifab,Tm>::initDirect_batch_gpu : 5.093e-05 S -----
rank=0 GPUmem(GB): used=6.71e-06 (oper,hinter)=6.21e-06,4.92e-07
----- TIMING FOR preprocess_formulae_Hxlist2 : 0.0189 S size(H_formulae)=68 size(Hxlst2)=16 T(Hmu/Hxlist)=0.000182,0.0187 -----
----- TIMING FOR preprocess_formulae_Hxlist : 0.019 S size(H_formulae)=68 size(Hxlst)=1520 -----
rank=0 GPUmem(GB): used=0.000291 (oper,hinter,dvdson,batch)=6.21e-06,4.92e-07,8.49e-07,0.000283 blksize=9 blksize0=6 batchsize=1520
ctns::pdvdsonSolver_nkr::solve_iter ndim=57 is_complex=0 mpisize=1
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=3.28e-05,0.000122,0.000997,0.000154,0.00131
 ndim=57:4.25e-07GB t[comm(intra)]=3.28e-05 speed=0.0259GB/S t[comm(inter)]=0 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.2e-04 t_gemm=1.0e-03 t_reduction=1.5e-04 tot=1.3e-03 ---
 sigma[inter] counter=9 t=1.2e-04 per=9.6e+00 cost=1.1e+04 flops=8.9e+07
 sigma[gemm] counter=9 i=0 t=9.4e-05 per=7.4e+00 cost=3.8e+03 flops=4.1e+07
 sigma[gemm] counter=9 i=1 t=8.6e-05 per=6.8e+00 cost=4.0e+03 flops=4.6e+07
 sigma[gemm] counter=9 i=2 t=2.2e-04 per=1.7e+01 cost=9.2e+03 flops=4.3e+07
 sigma[gemm] counter=9 i=3 t=2.1e-04 per=1.7e+01 cost=9.2e+03 flops=4.4e+07
 sigma[gemm] counter=9 i=4 t=2.0e-04 per=1.5e+01 cost=9.7e+03 flops=4.9e+07
 sigma[gemm] counter=9 i=5 t=1.9e-04 per=1.5e+01 cost=9.4e+03 flops=4.8e+07
 sigma[gemm] counter=9 total t=1.0e-03 per=7.8e+01 cost=4.5e+04 flops=4.6e+07
 sigma[red] counter=9 t=1.5e-04 per=1.2e+01 cost=1.2e+04 flops=7.5e+07
--- TIMING FOR sigma_tot : t_inter=8.9e-04 t_gemm=8.3e-03 t_reduction=1.9e-03 tot=1.1e-02 ---
 sigma_tot[inter] counter=9 t=8.9e-04 per=8.0e+00 cost=8.1e+04 flops=9.1e+07
 sigma_tot[gemm] counter=9 i=0 t=7.9e-04 per=7.1e+00 cost=2.9e+04 flops=3.7e+07
 sigma_tot[gemm] counter=9 i=1 t=7.6e-04 per=6.8e+00 cost=2.8e+04 flops=3.8e+07
 sigma_tot[gemm] counter=9 i=2 t=1.7e-03 per=1.6e+01 cost=6.9e+04 flops=4.0e+07
 sigma_tot[gemm] counter=9 i=3 t=1.8e-03 per=1.6e+01 cost=6.7e+04 flops=3.8e+07
 sigma_tot[gemm] counter=9 i=4 t=1.6e-03 per=1.5e+01 cost=6.7e+04 flops=4.2e+07
 sigma_tot[gemm] counter=9 i=5 t=1.6e-03 per=1.4e+01 cost=6.7e+04 flops=4.2e+07
 sigma_tot[gemm] counter=9 total t=8.3e-03 per=7.5e+01 cost=3.3e+05 flops=4.0e+07
 sigma_tot[red] counter=9 t=1.9e-03 per=1.7e+01 cost=8.4e+04 flops=4.4e+07
T(sub)=1.1e-05 T(gemm/eig/ortho/gemm/axpy)=2.9e-06,4.6e-06,2.2e-06,7.2e-07,1.7e-07
settings: ndim=57 neig=1 maxcycle=30 nbuff=4 memory=6e-06GB
          damping=1e-10 crit_v=1.0e-04 crit_indp=1.0e-12
iter   ieig        eigenvalue        ediff      rnorm   nsub  nmvp   time/s    tav/s   tav[Hx]/s
    1   0 -      -3.235803828577 -1.003e+03  1.625e-04    1     1  1.478e-03 1.478e-03 1.449e-03
preprocess_Hx_batchDirectGPUSingle: t[comm,inter,gemm,reduction,tot]=2.216e-05,1.143e-04,1.149e-03,1.825e-04,1.475e-03
 ndim=57:4.247e-07GB t[comm(intra)]=2.216e-05 speed=3.832e-02GB/S t[comm(inter)]=0.000e+00 speed=infGB/S
--- TIMING FOR sigma : t_inter=1.1e-04 t_gemm=1.1e-03 t_reduction=1.8e-04 tot=1.4e-03 ---
 sigma[inter] counter=10 t=1.1e-04 per=7.9e+00 cost=1.1e+04 flops=9.5e+07
 sigma[gemm] counter=10 i=0 t=1.0e-04 per=7.1e+00 cost=3.8e+03 flops=3.7e+07
 sigma[gemm] counter=10 i=1 t=1.1e-04 per=7.6e+00 cost=4.0e+03 flops=3.6e+07
 sigma[gemm] counter=10 i=2 t=2.4e-04 per=1.7e+01 cost=9.2e+03 flops=3.8e+07
 sigma[gemm] counter=10 i=3 t=2.4e-04 per=1.7e+01 cost=9.2e+03 flops=3.8e+07
 sigma[gemm] counter=10 i=4 t=2.2e-04 per=1.6e+01 cost=9.7e+03 flops=4.3e+07
 sigma[gemm] counter=10 i=5 t=2.3e-04 per=1.6e+01 cost=9.4e+03 flops=4.2e+07
 sigma[gemm] counter=10 total t=1.1e-03 per=7.9e+01 cost=4.5e+04 flops=3.9e+07
 sigma[red] counter=10 t=1.8e-04 per=1.3e+01 cost=1.2e+04 flops=6.3e+07
--- TIMING FOR sigma_tot : t_inter=1.0e-03 t_gemm=9.4e-03 t_reduction=2.1e-03 tot=1.3e-02 ---
 sigma_tot[inter] counter=10 t=1.0e-03 per=8.0e+00 cost=9.2e+04 flops=9.2e+07
 sigma_tot[gemm] counter=10 i=0 t=8.9e-04 per=7.1e+00 cost=3.3e+04 flops=3.7e+07
 sigma_tot[gemm] counter=10 i=1 t=8.7e-04 per=6.9e+00 cost=3.2e+04 flops=3.7e+07
 sigma_tot[gemm] counter=10 i=2 t=2.0e-03 per=1.6e+01 cost=7.8e+04 flops=4.0e+07
 sigma_tot[gemm] counter=10 i=3 t=2.0e-03 per=1.6e+01 cost=7.7e+04 flops=3.8e+07
 sigma_tot[gemm] counter=10 i=4 t=1.8e-03 per=1.5e+01 cost=7.7e+04 flops=4.2e+07
 sigma_tot[gemm] counter=10 i=5 t=1.8e-03 per=1.4e+01 cost=7.6e+04 flops=4.2e+07
 sigma_tot[gemm] counter=10 total t=9.4e-03 per=7.5e+01 cost=3.7e+05 flops=4.0e+07
 sigma_tot[red] counter=10 t=2.1e-03 per=1.7e+01 cost=9.6e+04 flops=4.5e+07
T(sub)=2.3e-05 T(gemm/eig/ortho/gemm/axpy)=4.6e-06,1.3e-05,4.2e-06,1.2e-06,2.6e-07
    2   0 +      -3.235803843151 -1.457e-08  5.059e-05    2     2  7.814e-03 3.907e-03 1.538e-03
TIMING FOR Davidson : 7.826e-03  T(cal/comm/rest)=3.076e-03,3.100e-07,4.750e-03
decomposed t_rest=4.750e-03
 T(sub)    =3.336e-05 per=7.024e-01
 T(precond)=4.653e-03 per=9.797e+01
 T(ortho)  =5.126e-06 per=1.079e-01
 T(xcopy)  =4.750e-07 per=1.000e-02
 T(xnrm2)  =9.380e-07 per=1.975e-02
 T(other)  =5.661e-05 per=1.192e+00
optimized energies: isweep=1 ibond=5 dots=1 e[0]=-3.235803843151 nmvp=2
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.649e+02S Sys:1.444e+00S Total:1.663e+02S
ctns::onedot_renorm superblock=cr (rdm_svd,dbranch,dcut,iftrunc,noise)=1.5e+00,0,10,1,0.0e+00
ctns::decimation_row ifab=0 iftrunc=1 dcut=10 nqr=11 alg_decim=1 mpisize=1 fname=./scratch/sweep/decimation_isweep1_ibond5.txt
 qbond: qsuper nsym=11 dimAll=36
 (3,1):7 (2,0):3 (4,0):7 (1,1):1 (2,2):2 (4,2):5 (5,1):6 (6,0):2 (6,2):1 (3,3):1 (5,3):1
----- TMING FOR decimation_genbasis(su2): 7.0e-03 S -----
decimation summary: 36->10 dwt=-2.220e-16 SvN=6.956e-01
 qbond: qkept nsym=6 dimAll=10
 (4,0):3 (3,1):2 (5,1):2 (2,0):1 (4,2):1 (6,0):1
----- TIMING for decimation_row(nkr): 7.470e-03 S T(decim/select/formRot)=7.068e-03,2.931e-04,1.094e-04 -----
----- TIMING FOR onedot_decimation: 7.958e-03 S T(wf/decim)=3.606e-04,7.597e-03 -----
ctns::oper_renorm coord=(2,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:4 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=10,10 size(op)=20:1.526e-04MB size(tot)=281:2.144e-03MB:2.094e-06GB
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.660e+02S Sys:1.444e+00S Total:1.674e+02S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=17 : 5.342e-04 S -----
rank=0 GPUmem(GB): used=6.71e-06 (oper)=6.21e-06
rank=0 GPUmem(GB): used=7.13e-06 (oper,site)(GB)=6.21e-06,4.25e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=17
 no. of rintermediate operators=22
 no. of coefficients=66:0.000504MB:4.92e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 4.809e-05 S -----
rank=0 GPUmem(GB): used=7.62e-06 (oper,site,rinter)=6.21e-06,4.25e-07,4.92e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.0108 S size(rtasks)=17 size(Rlst2)=36 T(Rmu/Rlist)=0.000164,0.0106 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.0109 S size(rtasks)=17 size(Rlst)=848 -----
rank=0 GPUmem(GB): used=7.62e-06 (oper,site,rinter,batch)=6.21e-06,4.25e-07,4.92e-07,0.000158 blksize=9 blksize0=6 batchsize=848
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=8.8e-05,0.000662,0.000218
--- TIMING FOR renorm : t_inter=8.8e-05 t_gemm=6.6e-04 t_reduction=2.2e-04 tot=9.7e-04 ---
 renorm[inter] counter=6 t=8.8e-05 per=9.1e+00 cost=5.4e+03 flops=6.2e+07
 renorm[gemm] counter=6 i=0 t=7.4e-05 per=7.7e+00 cost=1.9e+03 flops=2.5e+07
 renorm[gemm] counter=6 i=1 t=6.9e-05 per=7.2e+00 cost=2.8e+03 flops=4.0e+07
 renorm[gemm] counter=6 i=2 t=1.7e-04 per=1.8e+01 cost=3.8e+03 flops=2.2e+07
 renorm[gemm] counter=6 i=3 t=1.7e-04 per=1.7e+01 cost=6.9e+03 flops=4.1e+07
 renorm[gemm] counter=6 i=4 t=1.2e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=5 t=1.1e-06 per=1.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=6 i=6 t=1.8e-04 per=1.8e+01 cost=1.3e+04 flops=7.1e+07
 renorm[gemm] counter=6 total t=6.6e-04 per=6.8e+01 cost=2.8e+04 flops=4.2e+07
 renorm[red] counter=6 t=2.2e-04 per=2.3e+01 cost=6.2e+03 flops=2.8e+07
--- TIMING FOR renorm_tot : t_inter=3.5e-04 t_gemm=3.6e-03 t_reduction=1.1e-03 tot=5.1e-03 ---
 renorm_tot[inter] counter=6 t=3.5e-04 per=7.0e+00 cost=1.4e+04 flops=3.9e+07
 renorm_tot[gemm] counter=6 i=0 t=5.0e-04 per=9.9e+00 cost=1.1e+04 flops=2.3e+07
 renorm_tot[gemm] counter=6 i=1 t=4.1e-04 per=8.1e+00 cost=1.3e+04 flops=3.2e+07
 renorm_tot[gemm] counter=6 i=2 t=4.1e-04 per=8.0e+00 cost=1.0e+04 flops=2.6e+07
 renorm_tot[gemm] counter=6 i=3 t=4.0e-04 per=8.0e+00 cost=1.6e+04 flops=4.0e+07
 renorm_tot[gemm] counter=6 i=4 t=4.6e-04 per=9.1e+00 cost=1.0e+04 flops=2.3e+07
 renorm_tot[gemm] counter=6 i=5 t=4.6e-04 per=9.1e+00 cost=1.6e+04 flops=3.4e+07
 renorm_tot[gemm] counter=6 i=6 t=9.7e-04 per=1.9e+01 cost=6.6e+04 flops=6.8e+07
 renorm_tot[gemm] counter=6 total t=3.6e-03 per=7.1e+01 cost=1.4e+05 flops=4.0e+07
 renorm_tot[red] counter=6 t=1.1e-03 per=2.2e+01 cost=3.6e+04 flops=3.3e+07
qops.to_cpu: size(tot)=281:2.1e-03MB:2.1e-06GB t[to_cpu]=1.4e-05S speed=1.5e-01GB/S
check ||H-H.dagger||=7.772e-16 coord=(2,0) rank=0
ctns::oper_ab2pq coord=(2,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.0182 S rank=0 -----
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.667e+02S Sys:1.444e+00S Total:1.682e+02S
comb::display_size qkind=qNS
 rbases: len=0 mem=0:0.000e+00MB:0.000e+00GB
 sites: len=6 mem=160:1.221e-03MB:1.192e-06GB
 rwfuns: len=1 mem=1:7.629e-06MB:7.451e-09GB
 cpsi: len=1 mem=20:1.526e-04MB:1.490e-07GB
total mem of comb=181:1.381e-03MB:1.349e-06GB
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.667e+02S Sys:1.445e+00S Total:1.682e+02S
##### local opt: 6.933e-02 S #####
 T(local opt: fetch) = 2.004e-04 S  per = 0.289  per(accum) = 0.289
 T(local opt: hdiag) = 1.440e-03 S  per = 2.08  per(accum) = 2.37
 T(local opt: dvdsn) = 3.992e-02 S  per = 57.6  per(accum) = 60
 T(local opt: decim) = 7.984e-03 S  per = 11.5  per(accum) = 71.5
 T(local opt: guess) = 6.570e-04 S  per = 0.948  per(accum) = 72.4
 T(local opt: renrm) = 1.881e-02 S  per = 27.1  per(accum) = 99.5
 T(local opt: save ) = 3.173e-04 S  per = 0.458  per(accum) = 100
Detailed decomposition of T(dvdsn) = 3.992e-02 S  T(sum) = 3.968e-02 S  per = 9.940e+01
 T(local opt: preprocess                  ) = 2.205e-03 S  per = 5.56  per(accum) = 5.56
 T(local opt: symbolic_formulae           ) = 8.245e-04 S  per = 2.08  per(accum) = 7.63
 T(local opt: hintermediate init          ) = 6.795e-05 S  per = 0.171  per(accum) = 7.81
 T(local opt: preprocess_hformulae_Hxlist ) = 1.909e-02 S  per = 48.1  per(accum) = 55.9
 T(local opt: hmmtasks init               ) = 9.671e-03 S  per = 24.4  per(accum) = 80.3
 T(local opt: initial guess for dvdson    ) = 3.249e-06 S  per = 0.00819  per(accum) = 80.3
 T(local opt: dvdson solver [Hx_batchGPU] ) = 3.021e-03 S  per = 7.61  per(accum) = 87.9
 T(local opt: dvdson solver [comm(gpu)]   ) = 5.499e-05 S  per = 0.139  per(accum) = 88
 T(local opt: dvdson solver [comm(cpu)]   ) = 3.100e-07 S  per = 0.000781  per(accum) = 88
 T(local opt: dvdson solver [rest part]   ) = 4.750e-03 S  per =   12  per(accum) = 100
Detailed decomposition of T(renrm) = 1.881e-02 S  T(sum) = 1.881e-02 S  per = 1.000e+02
 T(local opt: before oper_renorm           ) = 3.785e-04 S  per = 2.01  per(accum) = 2.01
 T(local opt: qops init                    ) = 1.008e-03 S  per = 5.36  per(accum) = 7.37
 T(local opt: symbolic_formulae_renorm     ) = 5.435e-04 S  per = 2.89  per(accum) = 10.3
 T(local opt: allocate qops on gpu         ) = 2.580e-05 S  per = 0.137  per(accum) = 10.4
 T(local opt: site memcpy cpu2gpu          ) = 1.972e-05 S  per = 0.105  per(accum) = 10.5
 T(local opt: rintermediate init           ) = 5.827e-05 S  per = 0.31  per(accum) = 10.8
 T(local opt: preprocess_formulae_Rlist2   ) = 1.091e-02 S  per =   58  per(accum) = 68.8
 T(local opt: rmmtasks init                ) = 4.521e-03 S  per =   24  per(accum) = 92.9
 T(local opt: qops memset on cpu           ) = 3.100e-08 S  per = 0.000165  per(accum) = 92.9
 T(local opt: preprocess_renorm_batchGPU   ) = 1.060e-03 S  per = 5.64  per(accum) = 98.5
 T(local opt: reduction of opS & opH [nccl]) = 1.088e-06 S  per = 0.00579  per(accum) = 98.5
 T(local opt: qops memcpy gpu2cpu          ) = 1.876e-05 S  per = 0.0998  per(accum) = 98.6
 T(local opt: deallocate cpu and gpu memory) = 9.490e-06 S  per = 0.0505  per(accum) = 98.7
 T(local opt: reduction of opS & opH [comm]) = 7.148e-05 S  per = 0.38  per(accum) = 99
 T(local opt: conversion from opAB to opPQ ) = 3.497e-06 S  per = 0.0186  per(accum) = 99
 T(local opt: after oper_renorm            ) = 1.787e-04 S  per = 0.95  per(accum) = 100
##### sweep opt: 7.076e-01 S #####
 T(sweep opt: fetch) = 2.585e-03 S  per = 0.365  per(accum) = 0.365
 T(sweep opt: hdiag) = 5.912e-03 S  per = 0.835  per(accum) = 1.2
 T(sweep opt: dvdsn) = 1.669e-01 S  per = 23.6  per(accum) = 24.8
 T(sweep opt: decim) = 3.891e-02 S  per =  5.5  per(accum) = 30.3
 T(sweep opt: guess) = 5.005e-03 S  per = 0.707  per(accum) = 31
 T(sweep opt: renrm) = 4.859e-01 S  per = 68.7  per(accum) = 99.7
 T(sweep opt: save ) = 2.363e-03 S  per = 0.334  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.669e-01 S  T(sum) = 1.661e-01 S  per = 9.950e+01
 T(sweep opt: preprocess                  ) = 9.316e-03 S  per = 5.61  per(accum) = 5.61
 T(sweep opt: symbolic_formulae           ) = 3.702e-03 S  per = 2.23  per(accum) = 7.84
 T(sweep opt: hintermediate init          ) = 3.439e-04 S  per = 0.207  per(accum) = 8.05
 T(sweep opt: preprocess_hformulae_Hxlist ) = 7.562e-02 S  per = 45.5  per(accum) = 53.6
 T(sweep opt: hmmtasks init               ) = 3.818e-02 S  per =   23  per(accum) = 76.6
 T(sweep opt: initial guess for dvdson    ) = 1.805e-05 S  per = 0.0109  per(accum) = 76.6
 T(sweep opt: dvdson solver [Hx_batchGPU] ) = 1.389e-02 S  per = 8.36  per(accum) = 84.9
 T(sweep opt: dvdson solver [comm(gpu)]   ) = 2.468e-04 S  per = 0.149  per(accum) = 85.1
 T(sweep opt: dvdson solver [comm(cpu)]   ) = 1.470e-06 S  per = 0.000885  per(accum) = 85.1
 T(sweep opt: dvdson solver [rest part]   ) = 2.477e-02 S  per = 14.9  per(accum) = 100
Detailed decomposition of T(renrm) = 4.859e-01 S  T(sum) = 4.859e-01 S  per = 1.000e+02
 T(sweep opt: before oper_renorm           ) = 1.882e-03 S  per = 0.387  per(accum) = 0.387
 T(sweep opt: qops init                    ) = 7.172e-03 S  per = 1.48  per(accum) = 1.86
 T(sweep opt: symbolic_formulae_renorm     ) = 3.156e-03 S  per = 0.649  per(accum) = 2.51
 T(sweep opt: allocate qops on gpu         ) = 1.542e-04 S  per = 0.0317  per(accum) = 2.54
 T(sweep opt: site memcpy cpu2gpu          ) = 1.236e-04 S  per = 0.0254  per(accum) = 2.57
 T(sweep opt: rintermediate init           ) = 2.561e-04 S  per = 0.0527  per(accum) = 2.62
 T(sweep opt: preprocess_formulae_Rlist2   ) = 5.937e-02 S  per = 12.2  per(accum) = 14.8
 T(sweep opt: rmmtasks init                ) = 2.672e-02 S  per =  5.5  per(accum) = 20.3
 T(sweep opt: qops memset on cpu           ) = 2.080e-07 S  per = 4.28e-05  per(accum) = 20.3
 T(sweep opt: preprocess_renorm_batchGPU   ) = 5.670e-03 S  per = 1.17  per(accum) = 21.5
 T(sweep opt: reduction of opS & opH [nccl]) = 6.304e-06 S  per = 0.0013  per(accum) = 21.5
 T(sweep opt: qops memcpy gpu2cpu          ) = 1.181e-04 S  per = 0.0243  per(accum) = 21.5
 T(sweep opt: deallocate cpu and gpu memory) = 5.949e-05 S  per = 0.0122  per(accum) = 21.5
 T(sweep opt: reduction of opS & opH [comm]) = 4.687e-04 S  per = 0.0965  per(accum) = 21.6
 T(sweep opt: conversion from opAB to opPQ ) = 3.792e-01 S  per =   78  per(accum) = 99.7
 T(sweep opt: after oper_renorm            ) = 1.560e-03 S  per = 0.321  per(accum) = 100
##### global opt: 2.205e+00 S #####
 T(global opt: fetch) = 7.766e-03 S  per = 0.352  per(accum) = 0.352
 T(global opt: hdiag) = 2.299e-02 S  per = 1.04  per(accum) = 1.39
 T(global opt: dvdsn) = 1.175e+00 S  per = 53.3  per(accum) = 54.7
 T(global opt: decim) = 8.877e-02 S  per = 4.03  per(accum) = 58.7
 T(global opt: guess) = 1.326e-02 S  per = 0.601  per(accum) = 59.3
 T(global opt: renrm) = 8.845e-01 S  per = 40.1  per(accum) = 99.4
 T(global opt: save ) = 1.262e-02 S  per = 0.573  per(accum) = 100
Detailed decomposition of T(dvdsn) = 1.175e+00 S  T(sum) = 1.172e+00 S  per = 9.974e+01
 T(global opt: preprocess                  ) = 4.010e-02 S  per = 3.42  per(accum) = 3.42
 T(global opt: symbolic_formulae           ) = 1.127e-02 S  per = 0.961  per(accum) = 4.38
 T(global opt: hintermediate init          ) = 7.655e-04 S  per = 0.0653  per(accum) = 4.45
 T(global opt: preprocess_hformulae_Hxlist ) = 6.125e-01 S  per = 52.3  per(accum) = 56.7
 T(global opt: hmmtasks init               ) = 2.810e-01 S  per =   24  per(accum) = 80.7
 T(global opt: initial guess for dvdson    ) = 9.340e-03 S  per = 0.797  per(accum) = 81.5
 T(global opt: dvdson solver [Hx_batchGPU] ) = 6.884e-02 S  per = 5.87  per(accum) = 87.4
 T(global opt: dvdson solver [comm(gpu)]   ) = 8.585e-04 S  per = 0.0733  per(accum) = 87.4
 T(global opt: dvdson solver [comm(cpu)]   ) = 5.462e-06 S  per = 0.000466  per(accum) = 87.4
 T(global opt: dvdson solver [rest part]   ) = 1.474e-01 S  per = 12.6  per(accum) = 100
Detailed decomposition of T(renrm) = 8.845e-01 S  T(sum) = 8.845e-01 S  per = 1.000e+02
 T(global opt: before oper_renorm           ) = 5.198e-03 S  per = 0.588  per(accum) = 0.588
 T(global opt: qops init                    ) = 1.448e-02 S  per = 1.64  per(accum) = 2.23
 T(global opt: symbolic_formulae_renorm     ) = 6.865e-03 S  per = 0.776  per(accum) = 3
 T(global opt: allocate qops on gpu         ) = 3.263e-04 S  per = 0.0369  per(accum) = 3.04
 T(global opt: site memcpy cpu2gpu          ) = 4.187e-04 S  per = 0.0473  per(accum) = 3.09
 T(global opt: rintermediate init           ) = 7.203e-04 S  per = 0.0814  per(accum) = 3.17
 T(global opt: preprocess_formulae_Rlist2   ) = 1.251e-01 S  per = 14.1  per(accum) = 17.3
 T(global opt: rmmtasks init                ) = 5.553e-02 S  per = 6.28  per(accum) = 23.6
 T(global opt: qops memset on cpu           ) = 4.010e-07 S  per = 4.53e-05  per(accum) = 23.6
 T(global opt: preprocess_renorm_batchGPU   ) = 1.413e-02 S  per =  1.6  per(accum) = 25.2
 T(global opt: reduction of opS & opH [nccl]) = 1.309e-05 S  per = 0.00148  per(accum) = 25.2
 T(global opt: qops memcpy gpu2cpu          ) = 2.399e-04 S  per = 0.0271  per(accum) = 25.2
 T(global opt: deallocate cpu and gpu memory) = 1.235e-04 S  per = 0.014  per(accum) = 25.2
 T(global opt: reduction of opS & opH [comm]) = 9.334e-04 S  per = 0.106  per(accum) = 25.3
 T(global opt: conversion from opAB to opPQ ) = 6.573e-01 S  per = 74.3  per(accum) = 99.6
 T(global opt: after oper_renorm            ) = 3.113e-03 S  per = 0.352  per(accum) = 100

======================================================================
sweep_data::summary isweep=1 mpisize=1 maxthreads=112
----------------------------------------------------------------------
sweep parameters: isweep=1 dots=1 dcut=10 eps=0.0001 noise=0
 ibond=0 bond=(1,0)-(2,0) forward=1 deff=10 dwt=+1.110e-16 nmvp=1 e[0]=-3.235802424524 t=0.028
 ibond=1 bond=(2,0)-(3,0) forward=1 deff=10 dwt=+0.000e+00 nmvp=1 e[0]=-3.235802424524 t=0.252
 ibond=2 bond=(3,0)-(4,0) forward=1 deff=10 dwt=+0.000e+00 nmvp=4 e[0]=-3.235803828577 t=0.083
 ibond=3 bond=(3,0)-(4,0) forward=0 deff=10 dwt=+1.110e-16 nmvp=1 e[0]=-3.235803828577 t=0.025
 ibond=4 bond=(2,0)-(3,0) forward=0 deff=10 dwt=+0.000e+00 nmvp=1 e[0]=-3.235803828577 t=0.251
 ibond=5 bond=(1,0)-(2,0) forward=0 deff=10 dwt=-2.220e-16 nmvp=2 e[0]=-3.235803843151 t=0.069
 eav_max=-3.235802424524 [ibond=1]  dwt_min=-2.220e-16 [ibond=5]
 eav_min=-3.235803843151 [ibond=5]  dwt_max=1.110e-16 [ibond=3]
 eav_diff=0.000001418628
 sweep energies: isweep=1 dots=1 dcut=10 deff=10 dwt=-2.220e-16 e[0]=-3.235803843151
----------------------------------------------------------------------
summary of sweep optimization up to isweep=1 mpisize=1 maxthreads=112
schedule: isweep, dots, dcut, eps, noise | nmvp | Tsweep/S | Taccum/S | t_inter/S t_gemm/S t_red/S t_blas/S per
            0  2      10 1.000e-04 0.000e+00 | 26 | 1.505e+00 | 1.505e+00 | 4.857e-03 4.506e-02 8.121e-03 5.804e-02 3.86
            1  1      10 1.000e-04 0.000e+00 | 10 | 7.130e-01 | 2.218e+00 | 1.358e-03 1.304e-02 3.216e-03 1.761e-02 2.47
results: isweep, dcut, dwt, energies (delta_e)
            0      10 +1.400e-04 e[0]=-3.236066278078 (-2.624e-04)
            1      10 -2.220e-16 e[0]=-3.235803843151 (0.000e+00)
======================================================================

ctns::sweep_final: convert into RCF & save into ./scratch/rcanon_isweep1_su2
----------------------------------------------------------------------

ctns::sweep_final_LCR2CRR: convert [LC]R => [CR]R
ctns::decimation_row ifab=0 iftrunc=1 dcut=4 nqr=10 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep1_C0R1.txt
 qbond: qsuper nsym=10 dimAll=35
 (4,0):6 (3,1):3 (5,1):8 (2,0):1 (4,2):3 (6,0):6 (7,1):3 (6,2):3 (8,0):1 (5,3):1
----- TMING FOR decimation_genbasis(su2): 4.818e-03 S -----
decimation summary: 35->3 dwt=+1.110e-16 SvN=8.551e-01
 qbond: qkept nsym=3 dimAll=3
 (4,0):1 (5,1):1 (6,0):1
----- TIMING for decimation_row(nkr): 5.237e-03 S T(decim/select/formRot)=4.866e-03,3.168e-04,5.423e-05 -----

ctns::sweep_final_CR2cRR: convert [C]R => [cR]R
ctns::decimation_row ifab=0 iftrunc=1 dcut=1 nqr=6 alg_decim=0 mpisize=1 fname=./scratch/sweep/decimation_isweep1_cR0.txt
 qbond: qsuper nsym=6 dimAll=10
 (4,0):1 (5,1):2 (6,0):3 (7,1):2 (8,0):1 (6,2):1
----- TMING FOR decimation_genbasis(su2): 7.413e-03 S -----
decimation summary: 10->1 dwt=+0.000e+00 SvN=0.000e+00
 qbond: qkept nsym=1 dimAll=1
 (6,0):1
----- TIMING for decimation_row(nkr): 7.680e-03 S T(decim/select/formRot)=7.454e-03,2.058e-04,2.019e-05 -----

ctns::rcanon_save fname=./scratch/rcanon_isweep1_su2

ctns::rcanon_check thresh_ortho=1.000e-08
 idx=0 node=(5,0) Drow=3 maxdiff=0.000e+00 deviate=0
 idx=1 node=(4,0) Drow=10 maxdiff=4.333e-16 deviate=0
 idx=2 node=(3,0) Drow=10 maxdiff=9.451e-16 deviate=0
 idx=3 node=(2,0) Drow=10 maxdiff=9.907e-16 deviate=0
 idx=4 node=(1,0) Drow=3 maxdiff=4.441e-16 deviate=0
 idx=5 node=(0,0) Drow=1 maxdiff=2.220e-16 deviate=0
qtensor2: wf2 own=1 _data=0x4e14c800
qinfo2su2: wf2 sym=(0,0) dir=0,1
 qbond: qrow nsym=1 dimAll=1
 (6,0):1
 qbond: qcol nsym=1 dimAll=1
 (6,0):1
total no. of nonzero blocks=1 nblocks=1 size=1:7.629e-06MB
i=0 block[0:(6,0),0:(6,0)] dim0,dim1=(1,1) size=1
 dtensor2: blk_0 size=(1,1) _data=0x4e14c800
      1.0000e+00 
check wf2*wf2.H():
 rwfuns: nroots=1 maxdiff=4.4409e-16 deviate=0
----- TIMING FOR ctns::rcanon_check : 1.526e-03 S -----

ctns::oper_final - build Hmat for RCF at isweep=1

coord=(1,0)
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=95:0.000725MB:7.08e-07GB
 rqops: oplist=CSHPQ nops=C:4 S:2 H:1 P:4 Q:6 
        dim(bra,ket)=10,10 size(op)=20:0.000153MB size(tot)=281:0.00214MB:2.09e-06GB
ctns::oper_renorm coord=(1,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:5 S:1 H:1 P:1 Q:2 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=20:0.000153MB:1.49e-07GB
CPUmem: VM:1.978e+01GB RSS:1.838e+00GB  Timing: User:1.686e+02S Sys:1.446e+00S Total:1.700e+02S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=10 : 2.863e-04 S -----
rank=0 GPUmem(GB): used=2.95e-06 (oper)=2.95e-06
rank=0 GPUmem(GB): used=3.1e-06 (oper,site)(GB)=2.95e-06,1.49e-07
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=10
 no. of rintermediate operators=8
 no. of coefficients=32:0.000244MB:2.38e-07GB
----- TIMING FOR rintermediates<ifab,Tm>::initDirect_batch_gpu : 5.148e-04 S -----
rank=0 GPUmem(GB): used=3.34e-06 (oper,site,rinter)=2.95e-06,1.49e-07,2.38e-07
----- TIMING FOR preprocess_formulae_Rlist2 : 0.00309 S size(rtasks)=10 size(Rlst2)=9 T(Rmu/Rlist)=9.25e-05,0.00299 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.00312 S size(rtasks)=10 size(Rlst)=291 -----
rank=0 GPUmem(GB): used=3.34e-06 (oper,site,rinter,batch)=2.95e-06,1.49e-07,2.38e-07,2.82e-05 blksize=3 blksize0=6 batchsize=291
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.8e-05,0.000346,0.000109
--- TIMING FOR renorm : t_inter=7.8e-05 t_gemm=3.5e-04 t_reduction=1.1e-04 tot=5.3e-04 ---
 renorm[inter] counter=7 t=7.8e-05 per=1.5e+01 cost=1.3e+03 flops=1.7e+07
 renorm[gemm] counter=7 i=0 t=6.1e-05 per=1.2e+01 cost=3.7e+02 flops=6.1e+06
 renorm[gemm] counter=7 i=1 t=5.5e-05 per=1.0e+01 cost=4.9e+02 flops=8.8e+06
 renorm[gemm] counter=7 i=2 t=8.4e-05 per=1.6e+01 cost=7.7e+02 flops=9.1e+06
 renorm[gemm] counter=7 i=3 t=8.2e-05 per=1.5e+01 cost=1.3e+03 flops=1.5e+07
 renorm[gemm] counter=7 i=4 t=1.3e-06 per=2.4e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=5 t=1.2e-06 per=2.3e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=7 i=6 t=6.0e-05 per=1.1e+01 cost=1.2e+03 flops=2.0e+07
 renorm[gemm] counter=7 total t=3.5e-04 per=6.5e+01 cost=4.1e+03 flops=1.2e+07
 renorm[red] counter=7 t=1.1e-04 per=2.1e+01 cost=5.8e+02 flops=5.3e+06
--- TIMING FOR renorm_tot : t_inter=4.3e-04 t_gemm=4.0e-03 t_reduction=1.2e-03 tot=5.6e-03 ---
 renorm_tot[inter] counter=7 t=4.3e-04 per=7.7e+00 cost=1.5e+04 flops=3.5e+07
 renorm_tot[gemm] counter=7 i=0 t=5.6e-04 per=1.0e+01 cost=1.2e+04 flops=2.1e+07
 renorm_tot[gemm] counter=7 i=1 t=4.7e-04 per=8.3e+00 cost=1.4e+04 flops=3.0e+07
 renorm_tot[gemm] counter=7 i=2 t=4.9e-04 per=8.7e+00 cost=1.1e+04 flops=2.3e+07
 renorm_tot[gemm] counter=7 i=3 t=4.9e-04 per=8.7e+00 cost=1.7e+04 flops=3.6e+07
 renorm_tot[gemm] counter=7 i=4 t=4.6e-04 per=8.3e+00 cost=1.0e+04 flops=2.3e+07
 renorm_tot[gemm] counter=7 i=5 t=4.6e-04 per=8.3e+00 cost=1.6e+04 flops=3.4e+07
 renorm_tot[gemm] counter=7 i=6 t=1.0e-03 per=1.8e+01 cost=6.7e+04 flops=6.5e+07
 renorm_tot[gemm] counter=7 total t=4.0e-03 per=7.1e+01 cost=1.5e+05 flops=3.7e+07
 renorm_tot[red] counter=7 t=1.2e-03 per=2.2e+01 cost=3.7e+04 flops=3.0e+07
qops.to_cpu: size(tot)=20:1.5e-04MB:1.5e-07GB t[to_cpu]=1.4e-05S speed=1.1e-02GB/S
check ||H-H.dagger||=0.000e+00 coord=(1,0) rank=0
ctns::oper_ab2pq coord=(1,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00683 S rank=0 -----

coord=(0,0)
 cqops: oplist=CABPQSH nops=C:1 S:5 H:1 A:1 B:2 P:25 Q:30 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=95:0.000725MB:7.08e-07GB
 rqops: oplist=CSHPQ nops=C:5 S:1 H:1 P:1 Q:2 
        dim(bra,ket)=3,3 size(op)=3:2.29e-05MB size(tot)=20:0.000153MB:1.49e-07GB
ctns::oper_renorm coord=(0,0) superblock=cr oplist=CSHPQ ifab=0 isym=3 ifkr=1 alg_renorm=19 mpisize=1 maxthreads=112
 qops: oplist=CSHPQ nops=C:6 S:0 H:1 P:0 Q:0 
        dim(bra,ket)=1,1 size(op)=1:7.63e-06MB size(tot)=1:7.63e-06MB:7.45e-09GB
CPUmem: VM:1.978e+01GB RSS:1.839e+00GB  Timing: User:1.691e+02S Sys:1.448e+00S Total:1.705e+02S
----- TIMING FOR symbolic_formulae_renorm_su2 with size=7 : 1.120e-04 S -----
rank=0 GPUmem(GB): used=8.64e-07 (oper)=8.64e-07
rank=0 GPUmem(GB): used=8.87e-07 (oper,site)(GB)=8.64e-07,2.24e-08
rintermediates<ifab,Tm>::initDirect_batch_gpu maxthreads=112
 no. of formulae=7
 no. of rintermediate operators=0
 no. of coefficients=0:0MB:0GB
rank=0 GPUmem(GB): used=8.87e-07 (oper,site,rinter)=8.64e-07,2.24e-08,0
----- TIMING FOR preprocess_formulae_Rlist2 : 0.000405 S size(rtasks)=7 size(Rlst2)=1 T(Rmu/Rlist)=3.44e-05,0.000371 -----
----- TIMING FOR preprocess_formulae_Rlist : 0.000418 S size(rtasks)=7 size(Rlst)=46 -----
rank=0 GPUmem(GB): used=8.87e-07 (oper,site,rinter,batch)=8.64e-07,2.24e-08,0,1.03e-06 blksize=1 blksize0=0 batchsize=46
preprocess_renorm_batchDirectGPUDirect: t[inter,gemm,reduction]=7.67e-06,0.000242,5.69e-05
--- TIMING FOR renorm : t_inter=7.5e-06 t_gemm=2.4e-04 t_reduction=5.7e-05 tot=3.1e-04 ---
 renorm[inter] counter=8 t=7.5e-06 per=2.4e+00 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=0 t=6.7e-05 per=2.2e+01 cost=4.0e+01 flops=6.0e+05
 renorm[gemm] counter=8 i=1 t=4.6e-05 per=1.5e+01 cost=4.0e+01 flops=8.6e+05
 renorm[gemm] counter=8 i=2 t=4.2e-05 per=1.4e+01 cost=4.0e+01 flops=9.5e+05
 renorm[gemm] counter=8 i=3 t=4.1e-05 per=1.3e+01 cost=4.0e+01 flops=9.8e+05
 renorm[gemm] counter=8 i=4 t=1.3e-06 per=4.2e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=5 t=1.2e-06 per=4.1e-01 cost=0.0e+00 flops=0.0e+00
 renorm[gemm] counter=8 i=6 t=4.3e-05 per=1.4e+01 cost=9.2e+01 flops=2.2e+06
 renorm[gemm] counter=8 total t=2.4e-04 per=7.9e+01 cost=2.5e+02 flops=1.0e+06
 renorm[red] counter=8 t=5.7e-05 per=1.9e+01 cost=9.2e+01 flops=1.6e+06
--- TIMING FOR renorm_tot : t_inter=4.4e-04 t_gemm=4.2e-03 t_reduction=1.3e-03 tot=5.9e-03 ---
 renorm_tot[inter] counter=8 t=4.4e-04 per=7.4e+00 cost=1.5e+04 flops=3.4e+07
 renorm_tot[gemm] counter=8 i=0 t=6.3e-04 per=1.1e+01 cost=1.2e+04 flops=1.9e+07
 renorm_tot[gemm] counter=8 i=1 t=5.1e-04 per=8.7e+00 cost=1.4e+04 flops=2.7e+07
 renorm_tot[gemm] counter=8 i=2 t=5.3e-04 per=9.0e+00 cost=1.1e+04 flops=2.1e+07
 renorm_tot[gemm] counter=8 i=3 t=5.3e-04 per=8.9e+00 cost=1.7e+04 flops=3.3e+07
 renorm_tot[gemm] counter=8 i=4 t=4.7e-04 per=7.9e+00 cost=1.0e+04 flops=2.3e+07
 renorm_tot[gemm] counter=8 i=5 t=4.6e-04 per=7.9e+00 cost=1.6e+04 flops=3.4e+07
 renorm_tot[gemm] counter=8 i=6 t=1.1e-03 per=1.8e+01 cost=6.7e+04 flops=6.3e+07
 renorm_tot[gemm] counter=8 total t=4.2e-03 per=7.1e+01 cost=1.5e+05 flops=3.5e+07
 renorm_tot[red] counter=8 t=1.3e-03 per=2.1e+01 cost=3.7e+04 flops=2.9e+07
qops.to_cpu: size(tot)=1:7.6e-06MB:7.5e-09GB t[to_cpu]=1.3e-05S speed=5.9e-04GB/S
check ||H-H.dagger||=0.000e+00 coord=(0,0) rank=0
ctns::oper_ab2pq coord=(0,0) superblock=cr ab2pq=0 alg_renorm=19
----- TIMING FOR oper_renorm : 0.00148 S rank=0 -----

matrix: Hmat_isweep1 size=(1,1)
     -3.235803843151e+00 

----- TIMING FOR ctns::sweep_opt : 2.273e+00 S -----

Congrats! SADMRG calculation finishes successfully. Wed Nov 20 16:32:16 2024

